# StackOverflow 问答 000412000-000412999

# iphone - UIViewController 的用途

> ID：412007
> 
> 赞同：7
> 
> 时间：2009-01-05T00:43:52.490
> 
> 标签：iphone, cocoa-touch, model-view-controller

我目前正在学习 Objective-C，来自 Java 背景，我在制作 GUI 应用程序时没有任何问题。因此，我对其中一些问题的思考方式可能有点偏离。这是问题（请原谅漫谈）-

**UIViewController 的目的是什么？**

让我举一个具体的例子。假设您正在创建一个使用一堆 GUI 小部件的单视图应用程序。您可以在代码中手动布置它们，也可以使用 InterfaceBuilder。在 Java 和 HTML 等其他语言中，我总是手动编写代码，并且不使用 GUI 工具，因为我发现它们不允许我进行所需的自定义。话虽如此，**我听说 InterfaceBuilder 是最棒的（专家会手工做吗？）**。所以假设我在 XIB 文件中布置了一堆小部件，然后想在代码中加载这个 UIView。

**在我看来（我错了吗？）*需要*使用 UIViewController 才能正确取消 UIView**，但是出于我的应用程序的目的，我对控制器本身没有用处（让我们将 MVC 放在一边一分钟）。那么我必须为这个简单的单视图应用程序创建 UIViewController 吗？

让我们将其扩展到两个 UIView 应用案例。在这种情况下，我有一个具有两个视图的应用程序，其中一个是完全自定义的，没有小部件（我来这里是 drawRect），另一个视图是小部件-tastic（设置等）。我希望能够交换视图，其中一个是我在 IB 中创建的，另一个是纯代码。我正在创建自定义绘制的 UIView，如下所示：

`eyesView = [[EyesView alloc] initWithFrame:[[UIScreen mainScreen] bounds]];")`

在小部件视图的情况下，我正在使用：

`settingsView = (SettingsView *)[[[UIViewController alloc] initWithNibName:@"SettingsView" bundle:nil] view];`

**但是如果不使用这个我没有用的虚拟 UIViewController，我似乎无法找到唤醒 XIB 的方法。** 这让我回到了最初的问题——UIViewController 的目的是什么？Apple 是否只是为了让开发人员可以轻松地使用导航窗格等启动和运行（我不这么认为）？

有没有更好的方法来做这一切？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-01-05T02:00:59.150

UIViewController 是事实上的 Controller 类，是您的业务逻辑*应该*驻留的地方（此处或其他 Controller 样式的类中）。如果您不熟悉 Model-View-Controller 设计模式，您应该阅读它。

无论如何，是的，如果您要从 nib 反序列化内容，则需要一个充当文件所有者的对象，除了 MainMenu.xib 的情况外，该对象几乎可以肯定是 UIViewController 的子类。我想不出你为什么要省略 UIViewController。

从技术上讲，可以使用较低级别的 nib 加载架构手动加载 nib，但是您仍然需要*一些*对象来充当文件的所有者，除非您真的确切地知道自己是什么，否则没有充分的理由这样做正在做。特别是因为 UIViewController 为您提供了很多免费赠品，例如它为您管理 nib 中所有根对象的内存，并且如果不使用它，它可以在内存压力下卸载它的视图（然后在它使用时重新加载它再次被访问）。

# regex - RewriteRule 但保留子域

> ID：412010
> 
> 赞同：2
> 
> 时间：2009-01-05T00:48:55.663
> 
> 标签：regex, mod-rewrite

我想重定向以下示例：

```
A.olddomain.com.au/blah.html  >  A.newdomain.com/blah.html
B.olddomain.com.au/blah.html  >  B.newdomain.com/blah.html 
```

本质上，我有可变数量的子域，我只想在重定向时更改域名本身。

有什么线索或建议可以尝试吗？

谢谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-05T00:56:13.260

这应该适用于 HTTP 案例

```
RewriteCond %{HTTP_HOST} (.*)\.olddomain\.com\.au
RewriteRule (.*) http://%1.newdomain.com/$1 
```

如果同时使用 HTTP 和 HTTPS，则必须使用两组规则，一组用于 HTTP，另一组用于 HTTPS

```
RewriteCond %{HTTPS} on
RewriteCond %{HTTP_HOST} (.*)\.olddomain\.com\.au
RewriteRule (.*) https://%1.newdomain.com/$1

RewriteCond %{HTTPS} off
RewriteCond %{HTTP_HOST} (.*)\.olddomain\.com\.au
RewriteRule (.*) http://%1.newdomain.com/$1 
```

# .net - 构建可热插拔 WCF 服务库的最佳方法

> ID：412011
> 
> 赞同：8
> 
> 时间：2009-01-05T00:50:04.287
> 
> 标签：.net, wcf

我一直在开发一个 WCF 服务库，希望所有的业务逻辑都能在其中运行。我遇到的问题是，有时我必须对服务进行快速修复，为了应用这些修复，我必须停止 Windows 服务，替换服务 dll，然后重新启动 Windows 服务。随着我们开始将越来越多的逻辑迁移到这一层并且必须关闭整个服务以进行任何更改，这将开始引起额外的麻烦。

我想做的是创建一个 Windows 服务的空外壳并动态加载和卸载服务。按需加载和卸载 .Net DLL 的最佳方式是什么？还是依靠 IIS 来提供这种服务更好？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-01-05T02:58:45.353

如果您使用的是 WCF，那么您需要熟悉的一个名称是 Juval Lowy。他是 IDesign 的创始人，也是 WCF 领域最知名的专家之一。强烈推荐他的书*[Programming WCF Services 。](https://rads.stackoverflow.com/amzn/click/com/0596526997)*

IDesign[网站](http://www.idesign.net)提供了一系列与 WCF 相关的免费下载。您所要做的就是提供您的电子邮件地址并遵守 IDesign 的标准许可协议。

您可能特别感兴趣的是 App Domain Host、In-Proc Factory 和此处的 In-Proc Hosting[下载](http://www.idesign.net/idesign/DesktopDefault.aspx?tabindex=5&tabid=11#WCFEssentials)。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-05T01:29:14.643

您可能可以使用反射来动态加载您需要的特定逻辑，但是按照您想要的描述，对您的服务的性能影响将是巨大的。

如果您以前没有使用过反射，这里是我从一个项目中获取的示例。它展示了如何加载程序集并使用一些参数调用方法。

```
Assembly a = GetAssembly();
Type t = ExportModule.GetExportType(a);
if (t == null) throw new Exception("No proper type found.");

object iExportModule = Activator.CreateInstance(t);
object[] arguments = new object[] { _export.ConnectionString, GetFileName() };

t.InvokeMember("ExecuteExport", BindingFlags.Default | BindingFlags.InvokeMethod,
     null, iExportModule, arguments); 
```

显然我不了解您的环境，但总的来说，我会说关闭服务几分钟以更新软件比将整个范例更改为动态要好得多。

如果您确实有需要关闭服务的持续热修复，我认为您不应该拥有一个中央服务。你会一直把它拿下来的。最好让单独的服务处理不同的逻辑功能，这样您的整个应用程序就不会被关闭（单点故障）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-05T02:23:22.117

一旦程序集被加载到[AppDomain](http://blogs.msdn.com/cbrumme/archive/2003/06/01/51466.aspx)中，它将保留在内存中，直到 AppDomain 被卸载和销毁。因此，为了模拟“热插拔”环境，您必须设置和拆除将托管实际业务程序集并运行应用程序逻辑的 AppDomain（来自主进程的 AppDomain）。

不用说，如果您不断地创建/销毁每个 WCF 服务调用的 AppDomain，您应该会预料到性能会下降。它旨在创建一个与您的主 AppDomain 隔离的操作边界，以进行持续较长时间的有意义的工作。AppDomains 的优点是，如果您有很多业务逻辑程序集要随着时间的推移而卸载，您可以[节省内存使用量。](http://www.codeproject.com/KB/dotnet/AppDomainMemImprovement.aspx)

这种类型的动态设置和拆卸的主要示例是 ASP.NET。ASP.NET 运行时为每个 Web 应用程序创建一个 AppDomain。如果网站发生变化，例如 web.config，AppDomain 将被卸载，并为新版本的 Web 应用程序设置新的 AppDomain - 应用程序回收。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-05T21:33:49.363

尝试使用 MEF 来管理依赖项以及使用 MAF (System.AddIn) 来加载/卸载插件。

# c# - 在 C# 中使用计时器

> ID：412014
> 
> 赞同：7
> 
> 时间：2009-01-05T00:53:26.603
> 
> 标签：c#, timer

我正在尝试在 c# 中使表单在 x 时间内不可见。有任何想法吗？

谢谢，乔恩

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2009-01-05T01:04:53.400

BFree 在我测试时发布了类似的代码，但这是我的尝试：

```
this.Hide();
var t = new System.Windows.Forms.Timer
{
    Interval = 3000 // however long you want to hide for
};
t.Tick += (x, y) => { t.Enabled = false; this.Show(); };
t.Enabled = true; 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-01-05T01:40:20.457

利用闭包的快速而肮脏的解决方案。不需要`Timer`！

```
private void Invisibilize(TimeSpan Duration)
    {
        (new System.Threading.Thread(() => { 
            this.Invoke(new MethodInvoker(this.Hide));
            System.Threading.Thread.Sleep(Duration); 
            this.Invoke(new MethodInvoker(this.Show)); 
            })).Start();
    } 
```

例子：

```
// Makes form invisible for 5 seconds.

Invisibilize(new TimeSpan(0, 0, 5)); 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-01-05T01:03:00.127

在班级级别做这样的事情：

```
Timer timer = new Timer();
private int counter = 0; 
```

在构造函数中这样做：

```
 public Form1()
        {
            InitializeComponent();
            timer.Interval = 1000;
            timer.Tick += new EventHandler(timer_Tick);
        } 
```

然后你的事件处理程序：

```
void timer_Tick(object sender, EventArgs e)
        {
            counter++;
            if (counter == 5) //or whatever amount of time you want it to be invisible
            {
                this.Visible = true;
                timer.Stop();
                counter = 0;
            }
        } 
```

然后在任何你想让它不可见的地方（我将在这里通过单击按钮进行演示）：

```
 private void button2_Click(object sender, EventArgs e)
        {
            this.Visible = false;
            timer.Start();
        } 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-05T01:28:20.840

请记住，有几种类型的计时器可用：http: [//msdn.microsoft.com/en-us/magazine/cc164015.aspx](http://msdn.microsoft.com/en-us/magazine/cc164015.aspx)

并且不要忘记在处理程序期间禁用计时器，以免打扰自己。比较尴尬。

# performance - Postgresql.conf 变量

> ID：412016
> 
> 赞同：0
> 
> 时间：2009-01-05T00:54:20.470
> 
> 标签：performance, postgresql, configuration, rdbms

我已经玩了几天 postgresql.conf 文件了。我想知道你们喜欢定制哪些变量，为什么？

这是该文件的示例：

```
# - TCP Keepalives -
# see "man 7 tcp" for details
#tcp_keepalives_idle = 0        # TCP_KEEPIDLE, in seconds;
                    # 0 selects the system default
#tcp_keepalives_interval = 0        # TCP_KEEPINTVL, in seconds;
                    # 0 selects the system default
#tcp_keepalives_count = 0       # TCP_KEEPCNT;
                    # 0 selects the system default

#------------------------------------------------------------------------------
# RESOURCE USAGE (except WAL)
#------------------------------------------------------------------------------

# - Memory -

shared_buffers = 64MB           # min 128kB or max_connections*16kB
                    # (change requires restart)
#temp_buffers = 8MB         # min 800kB
#max_prepared_transactions = 5      # can be 0 or more
                    # (change requires restart)
# Note:  Increasing max_prepared_transactions costs ~600 bytes of shared memory
# per transaction slot, plus lock space (see max_locks_per_transaction).
#work_mem = 1MB             # min 64kB
#maintenance_work_mem = 16MB        # min 1MB
#max_stack_depth = 2MB          # min 100kB

# - Free Space Map -

max_fsm_pages = 204800          # min max_fsm_relations*16, 6 bytes each
                    # (change requires restart)
#max_fsm_relations = 1000       # min 100, ~70 bytes each
                    # (change requires restart)

# - Kernel Resource Usage -

#max_files_per_process = 1000       # min 25
                    # (change requires restart)
shared_preload_libraries = '$libdir/plugins/plugin_debugger.dll'        # (change requires restart)

# - Cost-Based Vacuum Delay -

#vacuum_cost_delay = 0          # 0-1000 milliseconds
#vacuum_cost_page_hit = 1       # 0-10000 credits
#vacuum_cost_page_miss = 10     # 0-10000 credits
#vacuum_cost_page_dirty = 20        # 0-10000 credits
#vacuum_cost_limit = 200        # 1-10000 credits

# - Background Writer -

#bgwriter_delay = 200ms         # 10-10000ms between rounds
#bgwriter_lru_maxpages = 100        # 0-1000 max buffers written/round
#bgwriter_lru_multiplier = 2.0      # 0-10.0 multipler on buffers scanned/round

#------------------------------------------------------------------------------
# WRITE AHEAD LOG
#------------------------------------------------------------------------------

# - Settings -

#fsync = on             # turns forced synchronization on or off
#synchronous_commit = on        # immediate fsync at commit
#wal_sync_method = fsync        # the default is the first option 
                    # supported by the operating system:
                    #   open_datasync
                    #   fdatasync
                    #   fsync
                    #   fsync_writethrough
                    #   open_sync
#full_page_writes = on          # recover from partial page writes
#wal_buffers = 64kB         # min 32kB
                    # (change requires restart)
#wal_writer_delay = 200ms       # 1-10000 milliseconds

#commit_delay = 0           # range 0-100000, in microseconds
#commit_siblings = 5            # range 1-1000

# - Checkpoints -

#checkpoint_segments = 3        # in logfile segments, min 1, 16MB each
#checkpoint_timeout = 5min      # range 30s-1h
#checkpoint_completion_target = 0.5 # checkpoint target duration, 0.0 - 1.0
#checkpoint_warning = 30s       # 0 is off

# - Archiving -

#archive_mode = off     # allows archiving to be done
                # (change requires restart)
#archive_command = ''       # command to use to archive a logfile segment
#archive_timeout = 0        # force a logfile segment switch after this
                # time; 0 is off

#------------------------------------------------------------------------------
# QUERY TUNING
#------------------------------------------------------------------------------

# - Planner Method Configuration -

#enable_bitmapscan = on
#enable_hashagg = on
#enable_hashjoin = on
#enable_indexscan = on
#enable_mergejoin = on
#enable_nestloop = on
#enable_seqscan = on
#enable_sort = on
#enable_tidscan = on

# - Planner Cost Constants -

#seq_page_cost = 1.0            # measured on an arbitrary scale
#random_page_cost = 4.0         # same scale as above
#cpu_tuple_cost = 0.01          # same scale as above
#cpu_index_tuple_cost = 0.005       # same scale as above
#cpu_operator_cost = 0.0025     # same scale as above
effective_cache_size = 32768

# - Genetic Query Optimizer -

#geqo = on
#geqo_threshold = 12
#geqo_effort = 5            # range 1-10
#geqo_pool_size = 0         # selects default based on effort
#geqo_generations = 0           # selects default based on effort
#geqo_selection_bias = 2.0      # range 1.5-2.0

# - Other Planner Options -

#default_statistics_target = 10     # range 1-1000
#constraint_exclusion = off
#from_collapse_limit = 8
#join_collapse_limit = 8        # 1 disables collapsing of explicit 
                    # JOIN clauses

#------------------------------------------------------------------------------
# ERROR REPORTING AND LOGGING
#------------------------------------------------------------------------------

# - Where to Log -

log_destination = 'stderr'      # Valid values are combinations of
                    # stderr, csvlog, syslog and eventlog,
                    # depending on platform.  csvlog
                    # requires logging_collector to be on.

# This is used when logging to stderr:
logging_collector = on      # Enable capturing of stderr and csvlog
                    # into log files. Required to be on for
                    # csvlogs.
                    # (change requires restart)

# These are only used if logging_collector is on:
#log_directory = 'pg_log'       # directory where log files are written,
                    # can be absolute or relative to PGDATA
#log_filename = 'postgresql-%Y-%m-%d_%H%M%S.log'    # log file name pattern,
                    # can include strftime() escapes
#log_truncate_on_rotation = off     # If on, an existing log file of the
                    # same name as the new log file will be
                    # truncated rather than appended to.
                    # But such truncation only occurs on
                    # time-driven rotation, not on restarts
                    # or size-driven rotation.  Default is
                    # off, meaning append to existing files
                    # in all cases.
#log_rotation_age = 1d          # Automatic rotation of logfiles will
                    # happen after that time.  0 to disable.
#log_rotation_size = 10MB       # Automatic rotation of logfiles will 
                    # happen after that much log output.
                    # 0 to disable.

# These are relevant when logging to syslog:
#syslog_facility = 'LOCAL0'
#syslog_ident = 'postgres'

# - When to Log -

#client_min_messages = notice       # values in order of decreasing detail:
                    #   debug5
                    #   debug4
                    #   debug3
                    #   debug2
                    #   debug1
                    #   log
                    #   notice
                    #   warning
                    #   error

#log_min_messages = notice      # values in order of decreasing detail:
                    #   debug5
                    #   debug4
                    #   debug3
                    #   debug2
                    #   debug1
                    #   info
                    #   notice
                    #   warning
                    #   error
                    #   log
                    #   fatal
                    #   panic

#log_error_verbosity = default      # terse, default, or verbose messages

#log_min_error_statement = error    # values in order of decreasing detail:
                    #   debug5
                    #   debug4
                    #   debug3
                    #   debug2
                    #   debug1
                    #   info
                    #   notice
                    #   warning
                    #   error
                    #   log
                    #   fatal
                    #   panic (effectively off)

#log_min_duration_statement = -1    # -1 is disabled, 0 logs all statements
                    # and their durations, > 0 logs only
                    # statements running at least this time.

#silent_mode = off          # DO NOT USE without syslog or
                    # logging_collector
                    # (change requires restart)

# - What to Log -

#debug_print_parse = off
#debug_print_rewritten = off
#debug_print_plan = off
#debug_pretty_print = off
#log_checkpoints = off
#log_connections = off
#log_disconnections = off
#log_duration = off
#log_hostname = off
log_line_prefix = '%t '         # special values:
                    #   %u = user name
                    #   %d = database name
                    #   %r = remote host and port
                    #   %h = remote host
                    #   %p = process ID
                    #   %t = timestamp without milliseconds
                    #   %m = timestamp with milliseconds
                    #   %i = command tag
                    #   %c = session ID
                    #   %l = session line number
                    #   %s = session start timestamp
                    #   %v = virtual transaction ID
                    #   %x = transaction ID (0 if none)
                    #   %q = stop here in non-session
                    #        processes
                    #   %% = '%'
                    # e.g. '<%u%%%d> '
#log_lock_waits = off           # log lock waits >= deadlock_timeout
#log_statement = 'none'         # none, ddl, mod, all
#log_temp_files = -1            # log temporary files equal or larger
                    # than specified size;
                    # -1 disables, 0 logs all temp files
#log_timezone = unknown         # actually, defaults to TZ environment
                    # setting

#------------------------------------------------------------------------------
# RUNTIME STATISTICS
#------------------------------------------------------------------------------

# - Query/Index Statistics Collector -

#track_activities = on
#track_counts = on
#update_process_title = on

# - Statistics Monitoring -

#log_parser_stats = off
#log_planner_stats = off
#log_executor_stats = off
#log_statement_stats = off

#------------------------------------------------------------------------------
# AUTOVACUUM PARAMETERS
#------------------------------------------------------------------------------

#autovacuum = on            # Enable autovacuum subprocess?  'on' 
                    # requires track_counts to also be on.
#log_autovacuum_min_duration = -1   # -1 disables, 0 logs all actions and
                    # their durations, > 0 logs only
                    # actions running at least that time.
#autovacuum_max_workers = 3     # max number of autovacuum subprocesses
#autovacuum_naptime = 1min      # time between autovacuum runs
#autovacuum_vacuum_threshold = 50   # min number of row updates before
                    # vacuum
#autovacuum_analyze_threshold = 50  # min number of row updates before 
                    # analyze
#autovacuum_vacuum_scale_factor = 0.2   # fraction of table size before vacuum
#autovacuum_analyze_scale_factor = 0.1  # fraction of table size before analyze
#autovacuum_freeze_max_age = 200000000  # maximum XID age before forced vacuum
                    # (change requires restart)
#autovacuum_vacuum_cost_delay = 20  # default vacuum cost delay for
                    # autovacuum, -1 means use
                    # vacuum_cost_delay
#autovacuum_vacuum_cost_limit = -1  # default vacuum cost limit for
                    # autovacuum, -1 means use
                    # vacuum_cost_limit

#------------------------------------------------------------------------------
# CLIENT CONNECTION DEFAULTS
#------------------------------------------------------------------------------

# - Statement Behavior -

#search_path = '"$user",public'     # schema names
#default_tablespace = ''        # a tablespace name, '' uses the default
#temp_tablespaces = ''          # a list of tablespace names, '' uses
                    # only default tablespace
#check_function_bodies = on
#default_transaction_isolation = 'read committed'
#default_transaction_read_only = off
#session_replication_role = 'origin'
#statement_timeout = 0          # 0 is disabled
#vacuum_freeze_min_age = 100000000
#xmlbinary = 'base64'
#xmloption = 'content'

# - Locale and Formatting -

datestyle = 'iso, dmy'
#timezone = unknown         # actually, defaults to TZ environment
                    # setting
#timezone_abbreviations = 'Default'     # Select the set of available time zone
                    # abbreviations.  Currently, there are
                    #   Default
                    #   Australia
                    #   India
                    # You can create your own file in
                    # share/timezonesets/.
#extra_float_digits = 0         # min -15, max 2
#client_encoding = sql_ascii        # actually, defaults to database
                    # encoding

# These settings are initialized by initdb, but they can be changed.
lc_messages = 'English_Canada'          # locale for system error message
                    # strings
lc_monetary = 'English_Canada'          # locale for monetary formatting
lc_numeric = 'English_Canada'           # locale for number formatting
lc_time = 'English_Canada'              # locale for time formatting

# default configuration for text search
default_text_search_config = 'pg_catalog.english'

# - Other Defaults -

#explain_pretty_print = on
#dynamic_library_path = '$libdir'
#local_preload_libraries = ''

#------------------------------------------------------------------------------
# LOCK MANAGEMENT
#------------------------------------------------------------------------------

#deadlock_timeout = 1s
#max_locks_per_transaction = 64     # min 10
                    # (change requires restart)
# Note:  Each lock table slot uses ~270 bytes of shared memory, and there are
# max_locks_per_transaction * (max_connections + max_prepared_transactions)
# lock table slots.

#------------------------------------------------------------------------------
# VERSION/PLATFORM COMPATIBILITY
#------------------------------------------------------------------------------

# - Previous PostgreSQL Versions -

add_missing_from = on
#array_nulls = on
#backslash_quote = safe_encoding    # on, off, or safe_encoding
#default_with_oids = off
#escape_string_warning = on
#regex_flavor = advanced        # advanced, extended, or basic
#sql_inheritance = on
#standard_conforming_strings = off
#synchronize_seqscans = on

# - Other Platforms and Clients -

#transform_null_equals = off 
```

我主要是在寻找效率或明智地使用资源。我知道这取决于我打算如何使用它以及其他此类“取决于”答案。我正在寻找的是重要或常见的变量自定义；人们最常改变哪些，为什么？

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-05T02:13:10.873

如果不知道您将如何使用数据库，就*不可能*知道可能适合更改的内容。你会有高交易负载吗？您是否会拥有包含大量查询的大部分静态批量数据？您将主要读取现有数据 (SELECT)、添加新数据 (INSERT) 还是更改现有数据 (UPDATE)？

此外，即使知道您是如何使用它的，您也需要进行基准测试和查询计划分析，以确定您可能需要更改配置的哪个方面来解决您遇到的任何性能问题。这可能需要 PostgreSQL 专家的帮助。

除了最苛刻的应用程序之外，默认设置适用于所有应用程序。

# c# - C# 中的数学优化

> ID：412019
> 
> 赞同：61
> 
> 时间：2009-01-05T00:57:53.617
> 
> 标签：c#, optimization, neural-network, performance

我整天都在分析一个应用程序，并且优化了一些代码，我的待办事项列表中只剩下了这个。它是神经网络的激活函数，被调用超过 1 亿次。根据 dotTrace，它约占整个函数时间的 60%。

你会如何优化这个？

```
public static float Sigmoid(double value) {
    return (float) (1.0 / (1.0 + Math.Pow(Math.E, -value)));
} 
```

* * *

## 回答 #1

> 赞同：61
> 
> 时间：2009-01-05T01:02:24.120

尝试：

```
public static float Sigmoid(double value) {
    return 1.0f / (1.0f + (float) Math.Exp(-value));
} 
```

**编辑：**我做了一个快速的基准测试。在我的机器上，上面的代码比你的方法快大约 43%，这个数学等效的代码是最快的（比原始代码快 46%）：

```
public static float Sigmoid(double value) {
    float k = Math.Exp(value);
    return k / (1.0f + k);
} 
```

**编辑 2：**我不确定 C# 函数有多少开销，但如果你`#include <math.h>`在源代码中，你应该能够使用它，它使用 float-exp 函数。可能会快一点。

```
public static float Sigmoid(double value) {
    float k = expf((float) value);
    return k / (1.0f + k);
} 
```

此外，如果您正在进行数百万次调用，函数调用开销可能是个问题。尝试制作一个内联函数，看看是否有帮助。

* * *

## 回答 #2

> 赞同：30
> 
> 时间：2009-01-05T01:59:38.017

如果是用于激活函数，那么如果 e^x 的计算完全准确，那么重要吗？

例如，如果您使用近似值 (1+x/256)^256，在我用 Java 进行的 Pentium 测试中（我假设 C# 基本上编译为相同的处理器指令），这大约比 e^x 快 7-8 倍(Math.exp())，并且精确到小数点后 2 位，直到大约 +/-1.5 的 x，并且在您声明的范围内的正确数量级内。（显然，要提高到 256，实际上是对数字进行 8 次平方——不要为此使用 Math.Pow！）在 Java 中：

```
double eapprox = (1d + x / 256d);
eapprox *= eapprox;
eapprox *= eapprox;
eapprox *= eapprox;
eapprox *= eapprox;
eapprox *= eapprox;
eapprox *= eapprox;
eapprox *= eapprox;
eapprox *= eapprox; 
```

根据您希望近似值的准确度，将 256 加倍或减半（并添加/删除乘法）。即使 n=4，它仍然为 -0.5 和 0.5 之间的 x 值提供大约 1.5 个小数位的精度（并且看起来比 Math.exp() 快 15 倍）。

PS 我忘了提——你显然不应该*除以*256：乘以常数 1/256。Java 的 JIT 编译器会自动进行这种优化（至少 Hotspot 会），我假设 C# 也必须这样做。

* * *

## 回答 #3

> 赞同：24
> 
> 时间：2009-01-05T12:38:13.280

看看[这个帖子](http://martin.ankerl.com/2007/02/11/optimized-exponential-functions-for-java/)。它有一个用 Java 编写的 e^x 的近似值，这应该是它的 C# 代码（未经测试）：

```
public static double Exp(double val) {  
    long tmp = (long) (1512775 * val + 1072632447);  
    return BitConverter.Int64BitsToDouble(tmp << 32);  
} 
```

在我的基准测试中，这比 Math.exp() （在 Java 中）**快 5 倍以上。**该近似值基于论文“ [A Fast, Compact Approximation of the Exponential Function](http://citeseer.ist.psu.edu/schraudolph98fast.html) ”，该论文被开发用于神经网络。它基本上与 2048 个条目的查找表和条目之间的线性近似相同，但所有这些都使用 IEEE 浮点技巧。

**编辑：**根据[Special Sauce](https://stackoverflow.com/users/1911540/special-sauce)，这比 CLR 实现快约 3.25 倍。谢谢！

* * *

## 回答 #4

> 赞同：14
> 
> 时间：2009-01-05T05:37:30.197

1.  请记住，**此激活函数的任何更改都会以不同的行为为代价**。这甚至包括切换到浮点数（从而降低精度）或使用激活替代品。只有尝试您的用例才能显示正确的方法。
2.  除了简单的代码优化之外，我还建议考虑**计算的并行化**（即：利用机器的多个内核，甚至是 Windows Azure 云上的机器）并改进训练算法。

**更新：** [发布关于 ANN 激活函数的查找表](http://rabdullin.com/journal/2009/1/5/caching-activation-function-is-not-worth-it.html)

**UPDATE2：**我删除了 LUT 上的点，因为我将这些与完整的散列混淆了。感谢[Henrik Gustafsson](https://stackoverflow.com/questions/412019/code-optimizations#414152)让我重回正轨。所以内存不是问题，尽管搜索空间仍然会被局部极值弄乱。

* * *

## 回答 #5

> 赞同：8
> 
> 时间：2009-01-05T01:05:56.267

在 1 亿次调用时，我开始怀疑分析器开销是否不会影响您的结果。将计算替换为no-op，看看是否*仍*报消耗60%的执行时间...

或者更好的是，创建一些测试数据并使用秒表计时器来分析一百万左右的电话。

* * *

## 回答 #6

> 赞同：8
> 
> 时间：2009-01-05T11:15:17.690

如果您能够与 C++ 互操作，则可以考虑将所有值存储在一个数组中，并使用 SSE 循环它们，如下所示：

```
void sigmoid_sse(float *a_Values, float *a_Output, size_t a_Size){
    __m128* l_Output = (__m128*)a_Output;
    __m128* l_Start  = (__m128*)a_Values;
    __m128* l_End    = (__m128*)(a_Values + a_Size);

    const __m128 l_One        = _mm_set_ps1(1.f);
    const __m128 l_Half       = _mm_set_ps1(1.f / 2.f);
    const __m128 l_OneOver6   = _mm_set_ps1(1.f / 6.f);
    const __m128 l_OneOver24  = _mm_set_ps1(1.f / 24.f);
    const __m128 l_OneOver120 = _mm_set_ps1(1.f / 120.f);
    const __m128 l_OneOver720 = _mm_set_ps1(1.f / 720.f);
    const __m128 l_MinOne     = _mm_set_ps1(-1.f);

    for(__m128 *i = l_Start; i < l_End; i++){
        // 1.0 / (1.0 + Math.Pow(Math.E, -value))
        // 1.0 / (1.0 + Math.Exp(-value))

        // value = *i so we need -value
        __m128 value = _mm_mul_ps(l_MinOne, *i);

        // exp expressed as inifite series 1 + x + (x ^ 2 / 2!) + (x ^ 3 / 3!) ...
        __m128 x = value;

        // result in l_Exp
        __m128 l_Exp = l_One; // = 1

        l_Exp = _mm_add_ps(l_Exp, x); // += x

        x = _mm_mul_ps(x, x); // = x ^ 2
        l_Exp = _mm_add_ps(l_Exp, _mm_mul_ps(l_Half, x)); // += (x ^ 2 * (1 / 2))

        x = _mm_mul_ps(value, x); // = x ^ 3
        l_Exp = _mm_add_ps(l_Exp, _mm_mul_ps(l_OneOver6, x)); // += (x ^ 3 * (1 / 6))

        x = _mm_mul_ps(value, x); // = x ^ 4
        l_Exp = _mm_add_ps(l_Exp, _mm_mul_ps(l_OneOver24, x)); // += (x ^ 4 * (1 / 24))

#ifdef MORE_ACCURATE

        x = _mm_mul_ps(value, x); // = x ^ 5
        l_Exp = _mm_add_ps(l_Exp, _mm_mul_ps(l_OneOver120, x)); // += (x ^ 5 * (1 / 120))

        x = _mm_mul_ps(value, x); // = x ^ 6
        l_Exp = _mm_add_ps(l_Exp, _mm_mul_ps(l_OneOver720, x)); // += (x ^ 6 * (1 / 720))

#endif

        // we've calculated exp of -i
        // now we only need to do the '1.0 / (1.0 + ...' part
        *l_Output++ = _mm_rcp_ps(_mm_add_ps(l_One,  l_Exp));
    }
} 
```

但是，请记住，您将使用的数组应使用 _aligned_malloc(some_size * sizeof(float), 16) 分配，因为 SSE 需要与边界对齐的内存。

使用 SSE，我可以在大约半秒内计算出所有 1 亿个元素的结果。但是，一次分配这么多内存将花费您近三分之二的千兆字节，因此我建议一次处理更多但更小的数组。您甚至可能要考虑使用具有 100K 或更多元素的双缓冲方法。

此外，如果元素的数量开始显着增加，您可能希望选择在 GPU 上处理这些东西（只需创建一个 1D float4 纹理并运行一个非常简单的片段着色器）。

* * *

## 回答 #7

> 赞同：8
> 
> 时间：2009-01-06T19:49:26.827

FWIW，这是我已经发布的答案的 C# 基准。（empty是一个只返回0的函数，用来衡量函数调用开销）

```
空函数：79ms 0
原文：1576ms 0.7202294
简化：（女高音）681ms 0.7202294
近似值：（尼尔）441ms 0.7198783
位操作：（martinus）836ms 0.72318
泰勒：（雷克斯洛根）261ms 0.7202305
查找：（亨里克）182ms 0.7204863

```

```
public static object[] Time(Func<double, float> f) {
    var testvalue = 0.9456;
    var sw = new Stopwatch();
    sw.Start();
    for (int i = 0; i < 1e7; i++)
        f(testvalue);
    return new object[] { sw.ElapsedMilliseconds, f(testvalue) };
}
public static void Main(string[] args) {
    Console.WriteLine("Empty:       {0,10}ms {1}", Time(Empty));
    Console.WriteLine("Original:    {0,10}ms {1}", Time(Original));
    Console.WriteLine("Simplified:  {0,10}ms {1}", Time(Simplified));
    Console.WriteLine("Approximate: {0,10}ms {1}", Time(ExpApproximation));
    Console.WriteLine("Bit Manip:   {0,10}ms {1}", Time(BitBashing));
    Console.WriteLine("Taylor:      {0,10}ms {1}", Time(TaylorExpansion));
    Console.WriteLine("Lookup:      {0,10}ms {1}", Time(LUT));
} 
```

* * *

## 回答 #8

> 赞同：5
> 
> 时间：2009-01-05T19:10:05.703

**注意：**这是[这篇](https://stackoverflow.com/questions/412019/code-optimizations#412176)文章的后续。

**编辑：更新以计算与**[this](https://stackoverflow.com/questions/412019/code-optimizations#412176)和[this](https://stackoverflow.com/questions/412019/code-optimizations#416180)相同的东西，从中获取[一些](http://rabdullin.com/journal/2009/1/5/caching-activation-function-is-not-worth-it.html)灵感。

现在看看你让我做什么！你让我安装 Mono！

```
$ gmcs -optimize test.cs && mono test.exe
Max deviation is 0.001663983
10^7 iterations using Sigmoid1() took 1646.613 ms
10^7 iterations using Sigmoid2() took 237.352 ms 
```

C 几乎不值得再努力了，世界正在向前发展 :)

因此，速度快了~~10~~ 6 倍。有 Windows 盒子的人可以使用 MS-stuff 调查内存使用情况和性能 :)

将 LUT 用于激活功能并不少见，尤其是在硬件中实现时。如果您愿意包含这些类型的表格，那么该概念有许多经过充分验证的变体。然而，正如已经指出的那样，混叠可能会成为一个问题，但也有一些方法可以解决这个问题。一些进一步的阅读：

*   [Giorgio Valentini的](http://homes.dsi.unimi.it/%7Evalenti/)[NEURObjects](http://www.disi.unige.it/person/ValentiniG/NEURObjects/documentation.html)（还有一篇关于此的论文）
*   [具有数字 LUT 激活功能的神经网络](http://ieeexplore.ieee.org/Xplore/login.jsp?url=/iel4/5797/15523/00716806.pdf?temp=x)
*   [通过降低精度激活函数来提升神经网络特征提取](http://www.ingentaconnect.com/content/els/00313203/2003/00000036/00000006/art00166)
*   [一种新的具有整数权重和量化非线性激活函数的神经网络学习算法](http://www.springerlink.com/content/x80r28752w4620r8/)
*   [量化对高阶函数神经网络的影响](http://ieeexplore.ieee.org/Xplore/login.jsp?url=/iel5/7505/20420/00943119.pdf?arnumber=943119)

一些问题：

*   当您到达桌子外时，误差会上升（但在极端情况下会收敛到 0）；对于 x 大约 +-7.0。这是由于选择的比例因子。较大的 SCALE 值在中间范围内产生较高的误差，但在边缘处较小。
*   这通常是一个非常愚蠢的测试，我不懂 C#，这只是我的 C 代码的简单转换:)
*   [Rinat Abdullin](https://stackoverflow.com/questions/412019/code-optimizations#412343)非常正确，混叠和精度损失可能会导致问题，但由于我没有看到变量，我只能建议你尝试一下。事实上，我同意他所说的一切，除了查找表的问题。

请原谅复制粘贴编码...

```
using System;
using System.Diagnostics;

class LUTTest {
    private const float SCALE = 320.0f;
    private const int RESOLUTION = 2047;
    private const float MIN = -RESOLUTION / SCALE;
    private const float MAX = RESOLUTION / SCALE;

    private static readonly float[] lut = InitLUT();

    private static float[] InitLUT() {
      var lut = new float[RESOLUTION + 1];

      for (int i = 0; i < RESOLUTION + 1; i++) {
        lut[i] = (float)(1.0 / (1.0 + Math.Exp(-i / SCALE)));
      }
      return lut;
    }

    public static float Sigmoid1(double value) {
        return (float) (1.0 / (1.0 + Math.Exp(-value)));
    }

    public static float Sigmoid2(float value) {
      if (value <= MIN) return 0.0f;
      if (value >= MAX) return 1.0f;
      if (value >= 0) return lut[(int)(value * SCALE + 0.5f)];
      return 1.0f - lut[(int)(-value * SCALE + 0.5f)];
    }

    public static float error(float v0, float v1) {
      return Math.Abs(v1 - v0);
    }

    public static float TestError() {
        float emax = 0.0f;
        for (float x = -10.0f; x < 10.0f; x+= 0.00001f) {
          float v0 = Sigmoid1(x);
          float v1 = Sigmoid2(x);
          float e = error(v0, v1);
          if (e > emax) emax = e;
        }
        return emax;
    }

    public static double TestPerformancePlain() {
        Stopwatch sw = new Stopwatch();
        sw.Start();
        for (int i = 0; i < 10; i++) {
            for (float x = -5.0f; x < 5.0f; x+= 0.00001f) {
                Sigmoid1(x);
            }
        }
        sw.Stop();
        return sw.Elapsed.TotalMilliseconds;
    }    

    public static double TestPerformanceLUT() {
        Stopwatch sw = new Stopwatch();
        sw.Start();
        for (int i = 0; i < 10; i++) {
            for (float x = -5.0f; x < 5.0f; x+= 0.00001f) {
                Sigmoid2(x);
            }
        }
        sw.Stop();
        return sw.Elapsed.TotalMilliseconds;
    }    

    static void Main() {
        Console.WriteLine("Max deviation is {0}", TestError());
        Console.WriteLine("10^7 iterations using Sigmoid1() took {0} ms", TestPerformancePlain());
        Console.WriteLine("10^7 iterations using Sigmoid2() took {0} ms", TestPerformanceLUT());
    }
} 
```

* * *

## 回答 #9

> 赞同：5
> 
> 时间：2009-01-06T11:30:18.533

**F# 在 .NET 数学算法中的性能优于 C#。**因此在 F# 中重写神经网络可能会提高整体性能。

如果我们在 F# 中重新实现[LUT 基准测试片段](https://stackoverflow.com/questions/412019/code-optimizations#414152)（我一直在使用稍微调整过的版本），那么生成的代码：

*   **在588.8 毫秒而不是 3899.2 毫秒内**执行 sigmoid1 基准测试
***   **在156.6 毫秒而不是 411.4 毫秒内**执行 sigmoid2 (LUT) 基准测试**

 ****更多细节可以在[博](http://rabdullin.com/journal/2009/1/6/f-has-better-performance-than-c-in-math.html)文中找到。这是 F# 片段 JIC：

```
#light

let Scale = 320.0f;
let Resolution = 2047;

let Min = -single(Resolution)/Scale;
let Max = single(Resolution)/Scale;

let range step a b =
  let count = int((b-a)/step);
  seq { for i in 0 .. count -> single(i)*step + a };

let lut = [| 
  for x in 0 .. Resolution ->
    single(1.0/(1.0 +  exp(-double(x)/double(Scale))))
  |]

let sigmoid1 value = 1.0f/(1.0f + exp(-value));

let sigmoid2 v = 
  if (v <= Min) then 0.0f;
  elif (v>= Max) then 1.0f;
  else
    let f = v * Scale;
    if (v>0.0f) then lut.[int (f + 0.5f)]
    else 1.0f - lut.[int(0.5f - f)];

let getError f = 
  let test = range 0.00001f -10.0f 10.0f;
  let errors = seq { 
    for v in test -> 
      abs(sigmoid1(single(v)) - f(single(v)))
  }
  Seq.max errors;

open System.Diagnostics;

let test f = 
  let sw = Stopwatch.StartNew(); 
  let mutable m = 0.0f;
  let result = 
    for t in 1 .. 10 do
      for x in 1 .. 1000000 do
        m <- f(single(x)/100000.0f-5.0f);
  sw.Elapsed.TotalMilliseconds;

printf "Max deviation is %f\n" (getError sigmoid2)
printf "10^7 iterations using sigmoid1: %f ms\n" (test sigmoid1)
printf "10^7 iterations using sigmoid2: %f ms\n" (test sigmoid2)

let c = System.Console.ReadKey(true); 
```

以及输出（针对 F# 1.9.6.2 CTP 发布编译，没有调试器）：

```
Max deviation is 0.001664
10^7 iterations using sigmoid1: 588.843700 ms
10^7 iterations using sigmoid2: 156.626700 ms 
```

**更新：**更新了基准测试以使用 10^7 次迭代以使结果与 C 相当

**UPDATE2：以下是来自同一台机器的**[C 实现](https://stackoverflow.com/questions/412019/code-optimizations#412176)的性能结果，用于比较：

```
Max deviation is 0.001664
10^7 iterations using sigmoid1: 628 ms
10^7 iterations using sigmoid2: 157 ms 
```

* * *

## 回答 #10

> 赞同：4
> 
> 时间：2009-01-05T02:05:03.900

第一个想法：关于 values 变量的一些统计信息怎么样？

*   “值”的值通常很小 -10 <= value <= 10？

如果没有，您可能可以通过测试超出范围的值来获得提升

```
if(value < -10)  return 0;
if(value > 10)  return 1; 
```

*   这些值是否经常重复？

如果是这样，您可能会从记忆中获得一些好处[（](http://en.wikipedia.org/wiki/Memoization)可能不会，但检查一下也无妨....）

```
if(sigmoidCache.containsKey(value)) return sigmoidCache.get(value); 
```

如果这些都不能应用，那么正如其他一些人所建议的那样，也许你可以降低 sigmoid 的准确性......

* * *

## 回答 #11

> 赞同：4
> 
> 时间：2009-01-05T03:35:54.967

Soprano 对您的通话进行了一些不错的优化：

```
public static float Sigmoid(double value) 
{
    float k = Math.Exp(value);
    return k / (1.0f + k);
} 
```

如果您尝试查找表并发现它使用了太多内存，您可以始终查看每次连续调用的参数值并采用一些缓存技术。

例如尝试缓存最后一个值和结果。如果下一个调用与前一个调用具有相同的值，则不需要计算它，因为您已经缓存了最后一个结果。如果当前调用与前一次调用相同，即使 100 次中有 1 次，您可能会为自己节省 100 万次计算。

或者，您可能会发现在 10 次连续调用中，value 参数平均有 2 次相同，因此您可以尝试缓存最后 10 个值/答案。

* * *

## 回答 #12

> 赞同：4
> 
> 时间：2009-01-05T11:30:09.797

在我的脑海中，[这篇论文解释了一种通过滥用浮点来逼近指数的方法](http://citeseerx.ist.psu.edu/icons/pdf.gif;jsessionid=EFB25A837B2026808E5BEF018B36521E)，（单击 PDF 右上角的链接），但我不知道它是否对你在 .网。

另外，还有一点：为了快速训练大型网络，您使用的逻辑 sigmoid 非常糟糕。[请参阅LeCun 等人](http://yann.lecun.com/exdb/publis/pdf/lecun-98b.pdf)的 Efficient Backprop 的第 4.4 节，并使用以零为中心的东西（实际上，阅读整篇论文，它非常有用）。

* * *

## 回答 #13

> 赞同：2
> 
> 时间：2009-01-05T01:00:07.777

想法：也许您可以使用预先计算的值制作一个（大）查找表？

* * *

## 回答 #14

> 赞同：2
> 
> 时间：2009-01-06T17:42:48.313

这有点离题，但出于好奇，我做了与Java中的[C](https://stackoverflow.com/questions/412019/code-optimizations#412176)、[C#](https://stackoverflow.com/questions/412019/code-optimizations#414152)和[F#中的实现相同的实现。](https://stackoverflow.com/questions/412019/code-optimizations#416180)我会把这个留在这里，以防其他人好奇。

结果：

```
$ javac LUTTest.java && java LUTTest
Max deviation is 0.001664
10^7 iterations using sigmoid1() took 1398 ms
10^7 iterations using sigmoid2() took 177 ms 
```

我想在我的情况下，对 C# 的改进是由于 Java 比 Mono 对 OS X 进行了更好的优化。在类似的 MS .NET 实现上（如果有人想发布比较数字，则与 Java 6 相比）我想结果会有所不同.

代码：

```
public class LUTTest {
    private static final float SCALE = 320.0f;
    private static final  int RESOLUTION = 2047;
    private static final  float MIN = -RESOLUTION / SCALE;
    private static final  float MAX = RESOLUTION / SCALE;

    private static final float[] lut = initLUT();

    private static float[] initLUT() {
        float[] lut = new float[RESOLUTION + 1];

        for (int i = 0; i < RESOLUTION + 1; i++) {
            lut[i] = (float)(1.0 / (1.0 + Math.exp(-i / SCALE)));
        }
        return lut;
    }

    public static float sigmoid1(double value) {
        return (float) (1.0 / (1.0 + Math.exp(-value)));
    }

    public static float sigmoid2(float value) {
        if (value <= MIN) return 0.0f;
        if (value >= MAX) return 1.0f;
        if (value >= 0) return lut[(int)(value * SCALE + 0.5f)];
        return 1.0f - lut[(int)(-value * SCALE + 0.5f)];
    }

    public static float error(float v0, float v1) {
        return Math.abs(v1 - v0);
    }

    public static float testError() {
        float emax = 0.0f;
        for (float x = -10.0f; x < 10.0f; x+= 0.00001f) {
            float v0 = sigmoid1(x);
            float v1 = sigmoid2(x);
            float e = error(v0, v1);
            if (e > emax) emax = e;
        }
        return emax;
    }

    public static long sigmoid1Perf() {
        float y = 0.0f;
        long t0 = System.currentTimeMillis();
        for (int i = 0; i < 10; i++) {
            for (float x = -5.0f; x < 5.0f; x+= 0.00001f) {
                y = sigmoid1(x);
            }
        }
        long t1 = System.currentTimeMillis();
        System.out.printf("",y);
        return t1 - t0;
    }    

    public static long sigmoid2Perf() {
        float y = 0.0f;
        long t0 = System.currentTimeMillis();
        for (int i = 0; i < 10; i++) {
            for (float x = -5.0f; x < 5.0f; x+= 0.00001f) {
                y = sigmoid2(x);
            }
        }
        long t1 = System.currentTimeMillis();
        System.out.printf("",y);
        return t1 - t0;
    }    

    public static void main(String[] args) {

        System.out.printf("Max deviation is %f\n", testError());
        System.out.printf("10^7 iterations using sigmoid1() took %d ms\n", sigmoid1Perf());
        System.out.printf("10^7 iterations using sigmoid2() took %d ms\n", sigmoid2Perf());
    }
} 
```

* * *

## 回答 #15

> 赞同：2
> 
> 时间：2010-12-31T00:15:51.833

我意识到这个问题出现已经一年了，但由于讨论了 F# 和 C 相对于 C# 的性能，我遇到了它。我使用了来自其他响应者的一些示例，发现委托似乎比常规方法调用执行得更快，但[F# 与 C# 相比没有明显的性能优势](http://thoughtfulcode.wordpress.com/2010/12/30/is-f-math-really-faster-than-c/)。

*   C：166毫秒
*   C#（委托）：275ms
*   C#（方法）：431ms
*   C#（方法，浮点计数器）：2,656ms
*   F#：404 毫秒

带有浮点计数器的 C# 是 C 代码的直接端口。在 for 循环中使用 int 会快得多。

* * *

## 回答 #16

> 赞同：2
> 
> 时间：2016-10-29T17:32:05.563

有一个更快的函数可以做非常相似的事情：

`x / (1 + abs(x))`– 快速替换 TAHN

同样：

`x / (2 + 2 * abs(x)) + 0.5`- 快速替换 SIGMOID

[将绘图与实际 sigmoid 进行比较](http://fooplot.com/#W3sidHlwZSI6MCwiZXEiOiJ4LygyKzJhYnMoeCkpKzAuNSIsImNvbG9yIjoiIzAwMDAwMCJ9LHsidHlwZSI6MCwiZXEiOiIxLygxK01hdGguRV4oLXgpKSIsImNvbG9yIjoiIzAwMDAwMCJ9LHsidHlwZSI6MTAwMH1d)

* * *

## 回答 #17

> 赞同：1
> 
> 时间：2009-01-05T02:56:51.317

（更新了性能测量）（再次更新了真实结果：）

我认为查找表解决方案在性能方面会让您走得更远，而内存和精度成本可以忽略不计。

下面的代码片段是 C 中的一个示例实现（我的 c# 说得不够流利，无法对其进行干式编码）。它运行和性能足够好，但我确信它有一个错误:)

```
#include <math.h>
#include <stdio.h>
#include <time.h>

#define SCALE 320.0f
#define RESOLUTION 2047
#define MIN -RESOLUTION / SCALE
#define MAX RESOLUTION / SCALE

static float sigmoid_lut[RESOLUTION + 1];

void init_sigmoid_lut(void) {
    int i;    
    for (i = 0; i < RESOLUTION + 1; i++) {
        sigmoid_lut[i] =  (1.0 / (1.0 + exp(-i / SCALE)));
    }
}

static float sigmoid1(const float value) {
    return (1.0f / (1.0f + expf(-value)));
}

static float sigmoid2(const float value) {
    if (value <= MIN) return 0.0f;
    if (value >= MAX) return 1.0f;
    if (value >= 0) return sigmoid_lut[(int)(value * SCALE + 0.5f)];
    return 1.0f-sigmoid_lut[(int)(-value * SCALE + 0.5f)];
}

float test_error() {
    float x;
    float emax = 0.0;

    for (x = -10.0f; x < 10.0f; x+=0.00001f) {
        float v0 = sigmoid1(x);
        float v1 = sigmoid2(x);
        float error = fabsf(v1 - v0);
        if (error > emax) { emax = error; }
    } 
    return emax;
}

int sigmoid1_perf() {
    clock_t t0, t1;
    int i;
    float x, y = 0.0f;

    t0 = clock();
    for (i = 0; i < 10; i++) {
        for (x = -5.0f; x <= 5.0f; x+=0.00001f) {
            y = sigmoid1(x);
        }
    }
    t1 = clock();
    printf("", y); /* To avoid sigmoidX() calls being optimized away */
    return (t1 - t0) / (CLOCKS_PER_SEC / 1000);
}

int sigmoid2_perf() {
    clock_t t0, t1;
    int i;
    float x, y = 0.0f;
    t0 = clock();
    for (i = 0; i < 10; i++) {
        for (x = -5.0f; x <= 5.0f; x+=0.00001f) {
            y = sigmoid2(x);
        }
    }
    t1 = clock();
    printf("", y); /* To avoid sigmoidX() calls being optimized away */
    return (t1 - t0) / (CLOCKS_PER_SEC / 1000);
}

int main(void) {
    init_sigmoid_lut();
    printf("Max deviation is %0.6f\n", test_error());
    printf("10^7 iterations using sigmoid1: %d ms\n", sigmoid1_perf());
    printf("10^7 iterations using sigmoid2: %d ms\n", sigmoid2_perf());

    return 0;
} 
```

以前的结果是由于优化器完成了它的工作并优化了计算。让它实际执行代码会产生稍微不同且更有趣的结果（在我的路上慢 MB Air）：

```
$ gcc -O2 test.c -o test && ./test
Max deviation is 0.001664
10^7 iterations using sigmoid1: 571 ms
10^7 iterations using sigmoid2: 113 ms 
```

![轮廓](https://i.stack.imgur.com/b8ICd.png)

* * *

去做：

有需要改进的地方和消除弱点的方法；怎么做留给读者作为练习:)

*   调整函数的范围以避免表格开始和结束的跳转。
*   添加轻微噪声功能以隐藏混叠伪影。
*   正如 Rex 所说，插值可以让你在精度方面更进一步，同时在性能方面相当便宜。

* * *

## 回答 #18

> 赞同：1
> 
> 时间：2009-01-05T04:01:29.767

您也可以考虑尝试评估成本更低的替代激活函数。例如：

```
f(x) = (3x - x**3)/2 
```

（可以考虑为

```
f(x) = x*(3 - x*x)/2 
```

减一乘法）。该函数具有奇对称性，其导数微不足道。将其用于神经网络需要通过除以输入总数来归一化输入总和（将域限制为 [-1..1]，这也是范围）。

* * *

## 回答 #19

> 赞同：1
> 
> 时间：2009-01-05T12:01:11.843

女高音主题的轻微变化：

```
public static float Sigmoid(double value) {
    float v = value;
    float k = Math.Exp(v);
    return k / (1.0f + k);
} 
```

既然你只追求单精度结果，为什么要让 Math.Exp 函数计算双精度？任何使用迭代求和的指数计算器（请参阅e [^x](http://www.math.com/tables/expansion/exp.htm)[的扩展](http://www.math.com/tables/expansion/exp.htm)）每次都需要更长的时间才能获得更高的精度。双倍是单倍的工作量！这样，您首先转换为单一，*然后*执行指数。

但是 expf 函数应该更快。不过，除非 C# 不进行隐式浮点-双精度转换，否则我认为不需要将女高音的 (float) 强制转换为 expf。

否则，只需使用*真正的*语言，例如 FORTRAN ...

* * *

## 回答 #20

> 赞同：1
> 
> 时间：2009-11-29T01:51:02.253

这里有很多很好的答案。我建议通过[这种技术](https://stackoverflow.com/questions/375913/what-can-i-use-to-profile-c-code-in-linux/378024#378024)运行它，只是为了确保

*   你不会比你需要的更多次调用它。
    （有时函数会被调用超过必要，只是因为它们很容易调用。）
*   您不会使用相同的参数重复调用它
    （您可以使用记忆化）

顺便说一句，您拥有的函数是逆 logit 函数，
或 log-odds-ratio 函数的倒数`log(f/(1-f))`。

* * *

## 回答 #21

> 赞同：0
> 
> 时间：2009-01-05T01:18:10.953

通过 Google 搜索，我找到了 Sigmoid 函数的替代实现。

```
public double Sigmoid(double x)
{
   return 2 / (1 + Math.Exp(-2 * x)) - 1;
} 
```

这对您的需求是否正确？它更快吗？

[http://dynamicnotions.blogspot.com/2008/09/sigmoid-function-in-c.html](http://dynamicnotions.blogspot.com/2008/09/sigmoid-function-in-c.html)

* * *

## 回答 #22

> 赞同：0
> 
> 时间：2009-01-05T03:56:10.603

1）你只从一个地方打电话吗？如果是这样，您可以通过将代码移出该函数并将其放在您通常调用 Sigmoid 函数的正确位置来获得少量性能。在代码可读性和组织方面我不喜欢这个想法，但是当你需要获得最后的性能提升时，这可能会有所帮助，因为我认为函数调用需要在堆栈上推送/弹出寄存器，如果你的代码都是内联的。

2）我不知道这是否会有所帮助，但请尝试将您的函数参数设置为 ref 参数。看看是不是更快。我会建议将其设为 const （如果这是在 c++ 中，这将是一种优化）但 c# 不支持 const 参数。

* * *

## 回答 #23

> 赞同：0
> 
> 时间：2009-01-05T17:06:52.257

如果你需要一个巨大的速度提升，你可能会考虑使用 (ge)force 并行化函数。IOW，使用 DirectX 来控制显卡为你做这件事。我不知道该怎么做，但我见过人们使用显卡进行各种计算。

* * *

## 回答 #24

> 赞同：0
> 
> 时间：2017-07-09T16:26:28.303

我看到这里很多人都在尝试使用近似来使 Sigmoid 更快。但是，重要的是要知道 Sigmoid 也可以使用 tanh 来表示，而不仅仅是 exp。以这种方式计算 Sigmoid 比使用指数方式快 5 倍左右，并且通过使用这种方法，您不会逼近任何东西，因此 Sigmoid 的原始行为保持原样。

```
 public static double Sigmoid(double value)
    {
        return 0.5d + 0.5d * Math.Tanh(value/2);
    } 
```

当然，并行化将是性能改进的下一步，但就原始计算而言，使用 Math.Tanh 比 Math.Exp 更快。

* * *

## 回答 #25

> 赞同：0
> 
> 时间：2020-05-11T09:57:48.960

请记住，*Sigmoid*约束的结果范围在 0 和 1 之间。小于约 -10 的值返回一个非常非常接近 0.0 的值。大于 10 的值会返回一个非常非常接近 1 的值。

回到过去，当计算机无法很好地处理算术上溢/下溢时，通常使用 if 条件来限制计算。如果我*真的*关心它的性能（或者基本上是 Math 的性能），我会将您的代码更改为老式的方式（并注意限制），这样它就不会不必要地调用 Math：

```
public double Sigmoid(double value)
{
    if (value < -45.0) return 0.0;
    if (value > 45.0) return 1.0;
    return 1.0 / (1.0 + Math.Exp(-value));
} 
```

我意识到任何阅读此答案的人都可能参与某种 NN 开发。请注意上述内容如何影响训练分数的其他方面。

# sql - 具有距离计算存储过程的 NHibernate 查询

> ID：412022
> 
> 赞同：2
> 
> 时间：2009-01-05T00:59:22.833
> 
> 标签：sql, nhibernate

我的数据库中有一个存储过程，用于计算两个纬度/经度对之间的距离。这个存储过程称为“DistanceBetween”。我有一个 SQL 语句，允许用户搜索 Items 表中的所有项目，这些项目按与提供的纬度/经度坐标的距离排序。SQL语句如下：

```
SELECT Items.*, dbo.DistanceBetween(@lat1, @lat2, Latitude, Longitude) AS Distance
FROM Items
ORDER BY Distance 
```

如何在 NHibernate 中使用此查询？我的域中的 Item 类没有“Distance”属性，因为我的 Items 表中没有“Distance”列。“距离”属性仅在用户执行此搜索时才真正发挥作用。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-10-21T15:16:38.763

基本上可以使用三种方法，其中一些已经讨论过：

1.  使用 HQL 查询或`CreateCriteria`/`ICriteria`查询；*缺点：*它不是实体/DAL 的一部分；*优点：*灵活；
2.  使用带有`formula`;的属性映射 *缺点：*它并不总是可行或可能的，如果不小心，性能可能会下降；*好处：*它的计算是您实体的一个组成部分；
3.  创建一个单独的 XML HBM 映射文件并映射到一个单独的（要创建的）实体；*缺点：*它不是基础实体的一部分；*优点：*您只在需要时调用 SP，完全控制映射/额外属性/扩展，可以使用部分或抽象类与现有实体组合。

我将在这里简要展示选项 2 和 3 的示例，我相信选项 1 已被本主题前面的其他人充分涵盖。

如本例所示，当查询可以创建为 select 语句的子查询并且映射表中所有需要的参数都可用时，选项二特别有用。如果表不可变和/或缓存为只读，这也有帮助，具体取决于存储过程的重量。

```
<class name="..." table="..." lazy="true" mutable="false>
  <cache usage="read-only" />

    <id name="Id" column="id" type="int">
      <generator class="native" />
    </id>
    <property name="Latitude" column="Latitude" type="double" not-null="true" />
    <property name="Longitude" column="Longitude" type="double" not-null="true" />

    <property name="PrijsInstelling"
        formula="(dbo.DistanceBetween(@lat1, @lat2, Latitude, Longitude))"
        type="double" />

    ... etc
</class> 
```

如果由于映射的限制、缓存问题或您当前的缓存设置逐个检索而不是按更大数量检索而无法进行上述操作，并且您无法更改它，则应考虑另一种方法，例如单独映射带有参数的整个查询。这与上面的 CreateSqlQuery 方法非常接近，但会强制结果集为某种类型（并且您可以以声明方式设置每个属性）：

```
<sql-query flush-mode="never" name="select_Distances">
    <return
        class="ResultSetEntityClassHere,Your.Namespace"
        alias="items"
        lock-mode="read" >

        <return-property name="Id" column="items_Id" />
        <return-property name="Latitude" column="items_Latitude" />
        <return-property name="Longitude" column="items_Longitude" />
        <return-property name="Distance" column="items_Distance" />
    </return>

    SELECT 
        Items.*, 
        dbo.DistanceBetween(@lat1, @lat2, Latitude, Longitude) AS Distance
    FROM Items
    WHERE UserId = :userId

</sql-query> 
```

您可以按如下方式调用此查询：

```
List<ResultSetEntityClassHere> distanceList = 
    yourNHibernateSession.GetNamedQuery("select_Distances") 
        .SetInt32("userId", currentUserId)  /* any params go this way */
        .SetCacheable(true)                 /* it's usually good to cache */
        .List<ResultSetEntityClassHere>();  /* must match the class of sql-query HBM */ 
```

根据您的需要，您可以选择一种方法。我个人使用以下经验法则来决定使用哪种方法：

*   计算量轻还是可以缓存？*使用`formula`方法；*
*   是否需要将参数发送到 SP/SQL？*使用`sql-query`+映射的方式；*
*   查询的结构（非常）是否可变？*通过代码使用`ICriteria`或 HQL 方法。*

关于数据的排序：当您选择“公式”或“sql-query 映射”方法时，您必须在检索数据时进行排序。这与通过当前映射检索数据没有什么不同。

**更新：**在 sql-query XML 中更正了可怕的编辑错误。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-08T03:38:28.097

你可以试试：

```
session.CreateSqlQuery(@"SELECT {item.*}, dbo.DistanceBetween(:lat1, :lat2, {item}.Latitude, {item}.Longitude) AS Distance
    FROM Items {item}
    ORDER BY Distance")
        .AddEntity("item", typeof(Item))
        .SetDecimal("lat1", lat1)
        .SetDecimal("lat2", lat2)
        .List<Item>() 
```

NHibernate 对查询中的表和列别名很挑剔，因此您需要让它使用 {} 语法扩展它们。此外，使用 HQL 命名参数语法（:lat1 而不是 @lat1），并将 SetDecimal() 更改为正确的数据类型。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-10-21T06:52:17.857

Ayende 解释了如何在映射文件中执行此操作，而不必求助于将 SQL 传递给您的会话：

[http://ayende.com/Blog/archive/2006/09/18/UsingNHibernateWithStoredProcedures.aspx](http://ayende.com/Blog/archive/2006/09/18/UsingNHibernateWithStoredProcedures.aspx)

另请参阅有关此问题的 Hibernate 文档（也与 NHibernate 相关）：

[http://docs.jboss.org/hibernate/stable/core/reference/en/html/querysql.html](http://docs.jboss.org/hibernate/stable/core/reference/en/html/querysql.html)

# javascript - 在不使用 tabindex 的情况下如何跳过项目？

> ID：412070
> 
> 赞同：15
> 
> 时间：2009-01-05T01:28:54.457
> 
> 标签：javascript, focus, tab-ordering

有没有一种好方法，在 javascript onfocus() 处理程序中，将焦点转移到选项卡顺序中的下一个项目，而无需手动输入应该是下一个项目的 ID？

我在 Django/jQuery 中构建了一个 HTML 日期选择器。这是一个行编辑，后跟一个弹出日历的日历图标。我希望能够从行编辑选项卡到下一个输入，跳过日历图标的链接。我的意思是它是一个通用的小部件，所以我不能硬编码下一个的 id 并调用 .focus()。我知道我可以在所有内容上设置 tabindex 属性，但这比我想要的更手动。此外，iirc 不会阻止它获得焦点，它只会将它放在标签顺序的末尾。

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2009-09-28T21:41:04.000

为该控件设置 tabindex = "-1" ，浏览器将从选项卡中跳过该控件。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-05T01:33:04.107

也许：

```
$("#your-calendar-icon").focus(function() {
  $(this).trigger("blur");
); 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-05T02:30:55.970

或者：

```
$("#your-calendar-icon").focus(function() {
    $(somethingElse).trigger("focus");
}); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-05T02:00:54.953

检查此资源：

*   [使用 JavaScript 获取、设置和删除 tabindex 值](http://fluidproject.org/blog/2008/01/09/getting-setting-and-removing-tabindex-values-with-javascript/)
*   [jQuery Tabindex 插件](http://fluidproject.org/blog/2008/01/11/jquery-tabindex-plugin/)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-02-12T15:36:27.037

正如@thetacom 所说，您可以只使用另一种类型的元素，即不接收焦点的元素。如果您仍想保留某些`tab`功能，可以尝试[SkipOnTab](https://joelpurra.com/projects/skipontab/)。

> [SkipOnTab](https://joelpurra.com/projects/skipontab/) : 一个 jQuery 插件，用于将选定的表单字段从向前的 tab 顺序中排除。

只需添加`data-skip-on-tab="true"`到您要跳过的日期选择器图标（或其他元素/容器）。您仍然可以单击以激活日期选择器或使用`shift`-`tab`并使用回车键返回。

请参阅[简单演示](https://joelpurra.com/projects/skipontab/docs/example/demo.html)和[商业案例演示](https://joelpurra.com/projects/skipontab/docs/example/skip-some-fields-in-order-form.html)。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-05T01:44:49.950

在日历图标周围使用 div 而不是链接。然后将您的日历事件附加到 div。默认情况下，div 不会是制表位。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-01-05T02:48:01.537

如果它总是在日历之后输入，那为什么不呢：

```
$('#your-calendar-icon').focus( function() {
  $(this).next('input').focus();
} ); 
```

就个人而言，我会说如果它要成为一个插件，你应该将下一个元素设置为具有默认值的配置选项，并在文档中指定默认值。

# namespaces - MS Robotics Studio：“合同与命名空间的合同不同”

> ID：412075
> 
> 赞同：2
> 
> 时间：2009-01-05T01:36:17.283
> 
> 标签：namespaces, contract, robotics-studio, dss

我正在尝试使用 MS Robotics Studio 和 VS 2008 构建 DSS 服务，但是在构建时，我从 dssproxy.exe 收到错误消息：

```
 The class MyServiceName has a ContractAttribute but the contract is different from that of the namespace. 
```

并且构建失败，因为 dssproxy 返回代码 10。有谁知道这条消息的含义？

合同标识符在 Types 类文件中声明，并在属性声明中使用，就像 Add New Project > Dss Service 向导构建它们一样。我的理解是标识符只是一个唯一的字符串。这是想告诉我它必须以某种方式匹配我的命名空间吗？

如果我再次构建，错误就会消失，但如果我在构建之前强制重建或清理，它就会回来。

谢谢，安迪

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-05T15:19:13.503

我自己想通了：如果合同标识符包含大写字母，则会发生此错误，即使它与清单完全匹配。类型和清单中的标识符都必须全部小写。不幸的是，“添加新项目”对话框不会阻止您为此输入混合大小写。:(

# iphone - InterfaceBuilder - UIViewController 子类未被识别为子类

> ID：412083
> 
> 赞同：2
> 
> 时间：2009-01-05T01:43:02.463
> 
> 标签：iphone, interface-builder

我正在开发一个简单的 iPhone 应用程序。

我有 1 个 UINavigationController 和 2 个 UIViewController 子类。

我有一个 MainWindow.xib 文件、一个 PersonListView.xib 和一个 PersonDetailView.xib。

MainWindow.xib 具有 UINavigationController，其视图链接到 PersonListView.xib 文件。

PersonListView.xib 将文件的所有者列为 PersonListViewController 类。

我在 PersonListView 上有一些按钮，以及标签和图像。所有显示正确。

当我尝试将 PersonListView 上的按钮链接到我的 PersonListViewController 类时，该按钮没有触发....

结果： ***由于未捕获的异常“NSInvalidArgumentException”而终止应用程序，原因：“*** -[UIViewController viewDetail]：无法识别的选择器发送到实例 0x450d50”

如果我进入调试控制台并打印对象 0x450d50，我会得到：

(gdb) 打印对象 0x450d50 (gdb)

Interface Builder 正确地将文件的所有者显示为 PersonListViewController，那么为什么我的按钮操作（链接到文件的所有者）会以某种方式转到超类？

EDIT1：好的，似乎正在发生的事情是我没有获得子类的实例，除非在我的 MainWindow.xib 中，我明确地将视图控制器的类设置为我的子类。

不过，我仍然缺少一些东西，因为我当然应该能够通过从主窗口换出 NIB 文件名来启动 UIViewController 的任意子类？

EDIT2：（对凯文的回应）这不是我所说的关于 XIB 的内容。

我有 3 个 XIB：

主窗口人员列表视图人员详细信息视图

PeopleListView 和 PeopleDetailView 每个都有一个关联的 File's Owner，它是一个对应的 UIViewController 子类。显然，当我从一个页面移动到另一个页面时，我需要我的事件转到正确的控制器类......但是如果我只能使用默认的 UIViewController 或一个子类，那会更加困难吗？

我可以通过使用正确的根手动设置 UINavigationController 在代码中获得正确的效果，但我觉得应该通过 InterfaceBuilder 有更好的方法。

EDIT3：（对肯德尔）我没有使用标签栏。不过，该模型是相同的，我的导航控制器中的视图必须连接到单个子类，这似乎有点恶心。

EDIT4: (to lostintransit) PersonListViewController 有适当的 - (IBAction) viewDetail; 方法。问题是我在 MainWindow.xib 中找不到将 UINavigationController 中的视图标记为“最初从 PersonListView.xib 加载此视图，以 PersonListViewController 作为视图”的方法将 PersonListView 替换为 PersonDetailView。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-05T06:27:20.673

我认为您正在使用标签栏，对吗？

如果是这样，请这样考虑。MainWindow xib 中定义的每个选项卡都必须定义为自定义视图控制器类型，因为这是加载时选项卡栏将创建的类型。选项卡栏为加载时定义的每个选项卡创建视图控制器。

仅创建任何视图控制器的实例然后加载您的自定义 NIB（这是您定义的选项卡栏现在正在执行的操作）是不够的，因为您的自定义视图中的连线将没有任何附加内容。

因此，确保在 MainWindow.xib 中的每个选项卡下定义的每个视图控制器（使用 IB 中的树视图来检查）设置为正确的自定义 UIViewController 类型，除了指向您的自定义 XIB 还必须设置文件的所有者到正确的类型（尽管这仅在您将任何内容连接到基本视图之外的文件所有者时才重要）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-05T02:05:46.647

更改 xib 的名称对该 xib 的内容绝对没有影响。如果*要*更改正在使用的子类，则必须在“信息”面板中更改类名。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-05T08:27:20.713

从异常看来，绑定没有正确完成。从异常来看，方法签名似乎不正确。按钮操作是否链接到返回类型为 IBAction 的方法？方法的签名应该是

-(IBAction) 方法名；

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2010-07-17T07:23:03.650

我也犯了同样的错误。

问题是，您没有设置 PersonListViewController.m 的目标。

转到 PersonListViewController.m 的信息，选择目标部分并确保选中您的应用程序的目标。

# c++ - C++ 中的引用变量存储什么值？

> ID：412084
> 
> 赞同：4
> 
> 时间：2009-01-05T01:43:28.283
> 
> 标签：c++

一个指针存储/分配一个内存地址；

参考变量呢？

它存储对象的实际值就像堆栈上的任何其他非指针简单变量一样？

谢谢！

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-01-05T01:48:01.173

引用本身不包含任何内容。C++ 标准甚至声明，实现不需要为引用分配任何存储。它实际上只是它引用的对象或函数的别名。尝试获取引用的值将获取对象或函数的值（在这种情况下，您将获得一个函数指针，就像您尝试使用其原始名称从函数中获取值一样）它引用，反而。

当然，当您进入较低级别并查看汇编代码时，引用就像指针一样。但在语言层面，它们是完全不同的野兽。例如，对 const 的引用可以绑定到临时对象，它们需要实现复制构造函数，用于重载运算符，并且它们不能放入数组中（即使你初始化它的所有元素也不行），因为引用不是对象（相对于指针）。尽管听起来很简单，但它们是引用类型。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-01-05T22:07:03.943

在内部，它只是一个指向对象的指针（尽管标准不一定要求它，但所有编译器都以这种方式实现）。在外部，它的行为类似于对象本身。将其视为一个带有隐式“*”运算符的指针，无论在何处使用（当然，声明除外）。它也是一个 const 指针（不要与指向 const 的指针混淆），因为它一旦声明就不能被重定向。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-01-05T02:02:40.147

> 它存储对象的实际值就像堆栈上的任何其他非指针简单变量一样？

不完全是：因为您没有值的**两个**副本（对象中的一个副本，对象引用中的另一个副本）；相反，引用可能实现为指向对象的指针。

指针和对象的区别：

*   参考不能为空
*   引用不能未初始化（必须在定义时初始化）
*   不能更改引用以引用不同的对象

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-01-05T02:04:30.173

我会说它只是一个具有不同语法的指针。

# ruby - 在循环中创建的 proc 访问循环变量的问题

> ID：412089
> 
> 赞同：2
> 
> 时间：2009-01-05T01:46:56.760
> 
> 标签：ruby

我是一个 ruby​​ newb，并且在循环内部创建的 procs 访问循环变量时遇到问题。这是一个演示问题的代码文件。

```
class Route
    def initialize options = {}
    options.each do |k,v| 
            self.instance_variable_set("@#{k}", v)
            self.class.send(:define_method, k, proc{self.instance_variable_get("@#{k}")})
      self.class.send(:define_method, "#{k}=", proc{|v| self.instance_variable_set("@#{k}", v)})
        end
    end
end

routes = []
routes << Route.new({ :url=>'/one', :content=>'html1' })
routes << Route.new({ :url=>'/two', :content=>'html2' })

blocks = []
for route in routes
        blocks << Proc.new { route.content }
end

puts blocks[0].call #=> 'html2'
puts blocks[1].call #=> 'html2' 
```

如何让 blocks[0].call 返回 'html1' 和 blocks[1].call 返回 'html2'

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-05T02:42:22.423

您可以在块内创建 Procs 以为每个 Proc 提供不同的上下文：

```
class Route
  def initialize(options = {})
    options.each do |k,v| 
      self.instance_variable_set("@#{k}", v)
      self.class.send(:define_method, k, proc{self.instance_variable_get("@#{k}")})
      self.class.send(:define_method, "#{k}=", proc{|v| self.instance_variable_set("@#{k}", v)})
    end
  end
end

routes = []
routes << Route.new({ :url=>'/one', :content=>'html1' })
routes << Route.new({ :url=>'/two', :content=>'html2' })

blocks = routes.map { |e| Proc.new { e.content } }

puts blocks[0].call #=> 'html1'
puts blocks[1].call #=> 'html2' 
```

# sql - 是否可以使用单个 UPDATE SQL 语句执行多个更新？

> ID：412101
> 
> 赞同：30
> 
> 时间：2009-01-05T01:59:07.453
> 
> 标签：sql, sql-server, sql-server-2005, tsql, optimization

假设我有一个表*tbl*列*id*和*title*。我需要更改标题列的所有值：

1.  从“a-1”到“a1”，
2.  从“a.1”到“a1”，
3.  从“b-1”到“b1”，
4.  从“b.1”到“b1”。

现在，我正在执行两个 UPDATE 语句：

```
UPDATE tbl SET title='a1' WHERE title IN ('a-1', 'a.1')
UPDATE tbl SET title='b1' WHERE title IN ('b-1', 'b.1') 
```

如果表很小，并且单个语句在不到一秒的时间内完成并且您只需要执行几条语句，这根本不是问题。

您可能已经邀请了它——我有一个巨大的表要处理（一个语句在大约 90 秒内完成），并且我有大量的更新要执行。

那么，是否可以合并更新以便只扫描一次表？或者，在这种情况下，有更好的方法来处理。

编辑：请注意，我正在使用的真实数据以及我必须执行的数据更改并不是那么简单 - 字符串更长并且它们不遵循任何模式（它是用户数据，所以没有假设可以制造——它可以是任何东西）。

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2009-01-05T02:06:06.770

您可以使用一个语句和多个 case 语句

```
update tbl
  set title = 
    case
      when title in ('a-1', 'a.1') then 'a1'
      when title in ('b-1', 'b.1') then 'b1'
      else title
    end 
```

当然，这会导致对每条记录进行写入，并且对于索引，这可能是一个问题，因此您可以只过滤掉您想要更改的行：

```
update tbl
  set title = 
    case
      when title in ('a-1', 'a.1') then 'a1'
      when title in ('b-1', 'b.1') then 'b1'
      else title
    end
where
  title in ('a.1', 'b.1', 'a-1', 'b-1') 
```

这将减少对表的写入次数。

* * *

## 回答 #2

> 赞同：24
> 
> 时间：2009-01-05T05:07:55.483

在更一般的情况下，每个新值可能有数百个映射，您将创建一个包含旧值和新值的单独表，然后在 UPDATE 语句中使用它。在 SQL 的一种方言中：

```
CREATE TEMP TABLE mapper (old_val CHAR(5) NOT NULL, new_val CHAR(5) NOT NULL);
...multiple inserts into mapper...
INSERT INTO mapper(old_val, new_val) VALUES('a.1', 'a1');
INSERT INTO mapper(old_val, new_val) VALUES('a-1', 'a1');
INSERT INTO mapper(old_val, new_val) VALUES('b.1', 'b1');
INSERT INTO mapper(old_val, new_val) VALUES('b-1', 'b1');
...etcetera...

UPDATE tbl
   SET title = (SELECT new_val FROM mapper WHERE old_val = tbl.title)
   WHERE title IN (SELECT old_val FROM mapper); 
```

两个 select 语句都是至关重要的。第一个是相关子查询（不一定要快，但如果映射表有数千行，则比大多数替代查询要快），它将新值从对应于旧值的映射表中拉出。第二个确保仅修改映射表中具有值的那些行；这很重要，否则，对于那些没有映射条目的行，标题将设置为 null（这些是在您开始之前正常的记录）。

对于一些替代方案，CASE 操作是可以的。但是，如果您有成百上千或数百万个映射要执行，那么您很可能会超出 DBMS 中 SQL 语句长度的限制。

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2009-01-05T08:13:49.540

根据乔纳森的回答。

```
UPDATE tbl
   SET title = new_val
FROM mapper
WHERE title IN (SELECT old_val FROM mapper)
     AND mapper.old_val = tbl.title; 
```

他的初始版本需要对映射表进行大量读取。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-01-05T02:05:25.150

如果转换与您的示例一样简单，则可以通过一些字符串操作来进行更新：

```
UPDATE tbl 
SET title = left(title, 1) + right(title, 1) 
WHERE title IN ('a-1', 'a.1', 'b-1', 'b.1') 
```

这样的东西对你有用吗？

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-05T02:15:25.830

或者

```
 Update Table set 
     title = Replace(Replace(title, '.', ''), '-', '')
   Where title Like '[ab][.-]1' 
```

# xcode - 你能在 Xcode 中创建一个“超集”目标吗？

> ID：412103
> 
> 赞同：6
> 
> 时间：2009-01-05T02:00:52.367
> 
> 标签：xcode, dependencies, target

出于单元测试的目的，我想在 Xcode 中创建一个 iPhone 项目目标，其中包括所有发布应用程序文件，以及一些包含对 UI 单元测试有用的代码的附加文件。

我可以通过复制原始应用程序目标来做到这一点；但是，这样做的问题是每次我将新的源文件添加到应用程序目标时，我还需要将其添加到 UnitTestUI 目标。这没什么大不了的，只是不方便总是记住将文件添加到两个目标。

是否有某种方法可以设置依赖项，以便添加到原始应用程序目标的每个文件也自动添加到单元测试目标？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-05T09:59:09.437

在 Xcode 中，您可以创建彼此直接依赖的目标。添加新目标时，有许多非产品构建目标可以在“*其他*”类别中提供帮助，具体取决于您的设置的简单或复杂程度。创建直接依赖于主要项目目标的运行单元测试的特定目标非常常见，Apple 和许多博客都有相关文档。

然而，在您的情况下，您可能需要对新的 UI 测试目标进行大量调整，但是一旦设置好，维护起来就会非常容易。不知道您的确切情况，不可能给您一个逐步的答案，但这里是一般准则（调整以适应您的情况）：

1.  创建原始目标的副本，因为您的大部分设置都是相同的。
2.  选择您的新目标并打开检查器 (⌘I)
3.  在**Direct Dependencies**下，单击 + 按钮并选择您的主要目标。
4.  根据需要设置新目标，使用额外的文档/源/规则或其他内容。

如果您喜欢拖放东西，您也可以将原始目标（从**目标**显示三角形下方）拖到新目标中，它会自动设置依赖关系。

现在，选择您的测试目标作为活动目标，它将始终使用这些规则构建。此外，如果您在主目标中添加/更改源，它将在构建测试目标时正确重建......无需记住也将源文件添加到测试目标。我建议花一些时间阅读各种 Xcode 文档并使用大量可用的目标模板......从长远来看，它确实有助于提高产品的使用效率。如果你知道怎么做，即使是非常大或复杂的项目，在 Xcode 中也可以相当容易地完成很多漂亮的事情。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-05T02:02:49.617

不，没有。您是否有特殊原因需要单元测试目标中的每个文件？这将包括 main.m 和您未测试的所有类（例如您的视图类）。事实上，如果 main.m 包含在您的单元测试中，那么您的单元测试将如何正常运行？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2010-12-09T18:36:41.107

我通过将我的大部分应用程序构建为静态库来解决这个问题，该库链接到应用程序和单元测试目标。

我项目中的目标如下所示：

*   libMyApp
    *   编译 .m 文件
*   我的应用程序
    *   libMyApp（依赖项）
    *   与库链接：libMyApp.a
*   UITest.app
    *   libMyApp（依赖项）
    *   与库链接：libMyApp.a

这样我可以`.m`只将文件添加到“libMyApp”目标，并在应用程序和测试中都可以使用它们，甚至不必重新编译它们。

唯一的问题是静态库似乎不支持 Objective-C 类别，所以我仍然必须将它们分别添加到每个目标中。

# macos - Mac 10.5 上的 lighttpd - 找不到 lighttpd.conf

> ID：412124
> 
> 赞同：0
> 
> 时间：2009-01-05T02:14:30.823
> 
> 标签：macos, lighttpd

我刚刚在 Mac OS X 10.5 上进行了全新构建并重新安装了 lighttpd 1.4.20，但找不到配置文件。

我的目标是将 lighty 安装到单个目录而不是四处传播，所以我成功地使用了以下命令：

```
./configure --prefix="/usr/local/lighttpd"
sudo make clean
sudo make 
```

这成功地将二进制文件和库放在 /usr/local/lighttpd/ 中，就像我想要的那样。但是，配置文件未安装在 /usr/local/lighttpd/doc/lightppd.conf 中，如安装文档中所示。

知道它会在哪里吗？还是我错过了 ./configure 上的选项？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-01-05T02:25:01.147

我读它的方式，[安装文件](http://redmine.lighttpd.net/repositories/entry/lighttpd/tags/lighttpd-1.4.20/INSTALL)似乎说你必须手动创建 lighttpd.conf 文件，通过从 $SOURCEDIR/doc/lighttpd.conf 复制一个文件，而不是 $INSTALLDIR/doc/lighttpd.conf - 你有吗看过那里？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2010-06-10T11:03:17.227

Stobor 的解决方案应该可以帮助您（只需将 $SOURCEDIR/doc/lighttpd.conf 复制到 /usr/local/etc/ 或您想要的任何位置，然后在启动 lig​​httpd 时在命令行上指定文件所在的位置。）

如果你经常安装这种东西，也许你想看看[MacPorts](http://www.macports.org/)。我注意到他们有 lighttpd，1.4.26 和 1.5.0（开发）。我很高兴使用 MacPorts 在装有 Mac OS X 10.5 的 Powerbook G4 上安装 UNIXy 的东西。

# svn - 是否可以使用 TortoiseSVN 获取统计信息？

> ID：412129
> 
> 赞同：38
> 
> 时间：2009-01-05T02:21:35.677
> 
> 标签：svn, statistics

是否可以获得有关每个用户贡献、总行数等的统计信息？

* * *

## 回答 #1

> 赞同：51
> 
> 时间：2009-01-05T02:33:34.640

您可以使用“显示日志...”然后“统计信息”（IIRC 底部的按钮）获取基本统计信息

* * *

## 回答 #2

> 赞同：17
> 
> 时间：2009-01-05T02:28:26.740

TortoiseSVN 无法收集统计数据（我知道）。

我用过[StatSVN](http://www.statsvn.org/)。它可以组合图表并提供各种统计数据；包括用户贡献（占总更改的百分比、代码行数、每次更改的行数）等等。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-05T02:33:16.980

是的，如果您对可以深入研究结果不太挑剔，如[文档中所述](http://tortoisesvn.tigris.org/bigpicture.html)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2016-04-19T23:25:21.683

如果您想要特定日期范围和存储库的统计信息，请右键单击您感兴趣的存储库文件夹并选择“TortoiseSVN”->“显示日志”。

从显示日志窗口应该有一个“统计”按钮。

要更改统计数据的日期范围，请调整“从：”和“到：”日期，然后再次单击“统计”按钮。

# c# - 在文本框的名称中增加一个数字

> ID：412151
> 
> 赞同：0
> 
> 时间：2009-01-05T02:38:59.120
> 
> 标签：c#

```
public void test()
    {
        List<int> list = new List<int>();
        list.Add(1);
        list.Add(2);
        list.Add(3);
        for (int i = 1; i <= list.Count; i++)
        {

            textBx.Text = list[i].ToString();
            // I want it to be textBx1.Text = list[1].ToString();
                               textBx2.Text = list[2].ToString();
                               textBx3.Text = list[3].Tostring();
                               etc.
              // I can't create textbox dynamically as I need the text box to be placed in specific places in the form . How do I do it the best way? 

        }

    } 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-01-05T02:46:24.193

听起来像是 Controls.Find() 的工作。您可以动态构建字符串并使用该名称搜索 TextBox：

```
 var textBox = this.Controls.Find("textBx" + i, true) as TextBox;
 textBox.Text = list[i].ToString(); 
```

这有点难看，因为它取决于您对 TextBoxes 的命名约定。也许更好的解决方案是在循环之前缓存 TextBoxes 列表：

```
var textBoxes = new[] { textBx1, textBx2, textBx3 }; 
```

然后你可以简单地索引到数组中：

```
textBoxes[i].Text = list[i].ToString(); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-05T03:01:33.960

+1 给马特。这是一个有效的完整解决方案：

```
 string TextBoxPrefix = "textBx";
        foreach (Control CurrentControl in this.Controls)
        {
            if (CurrentControl is TextBox)
            {
                if (CurrentControl.Name.StartsWith(TextBoxPrefix)) {

                    int TextBoxNumber = System.Convert.ToInt16(CurrentControl.Name.Substring(TextBoxPrefix.Length));

                    if (TextBoxNumber <= (list.Count - 1))
                    {
                        CurrentControl.Text = list[TextBoxNumber].ToString();
                    }
                }
            }
        } 
```

# c++ - C++ 服务提供者

> ID：412165
> 
> 赞同：1
> 
> 时间：2009-01-05T02:48:25.170
> 
> 标签：c++, dictionary, service

我一直在学习 C++，来自 C#，在那里我习惯了使用服务提供者：基本上是 Dictionary<Type, object>。不幸的是，我不知道如何在 C++ 中做到这一点。所以问题基本上是：

1.  我将如何用 C++ 制作字典。

2.  据我所知，C++ 中没有“类型”，我将如何使用“类型”。

3.  与上面相同，但带有“对象”。

谢谢！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-01-05T03:16:28.063

我假设您正在尝试将类型映射到单个对象实例。您可以尝试以下方法：

```
#include <typeinfo>
#include <map>
#include <string>
using namespace std;

class SomeClass
{
public:
    virtual ~SomeClass() {} // virtual function to get a v-table
};

struct type_info_less
{
    bool operator() (const std::type_info* lhs, const std::type_info* rhs) const
    {
        return lhs->before(*rhs) != 0;
    }
};

class TypeMap
{
    typedef map <type_info *, void *, type_info_less> TypenameToObject;
    TypenameToObject ObjectMap;

public:
    template <typename T> 
    T *Get () const
    {
        TypenameToObject::const_iterator iType = ObjectMap.find(&typeid(T));
        if (iType == ObjectMap.end())
            return NULL;
        return reinterpret_cast<T *>(iType->second);
    }
    template <typename T> 
    void Set(T *value) 
    {
        ObjectMap[&typeid(T)] = reinterpret_cast<void *>(value);
    }
};

int main()
{
    TypeMap Services;
    Services.Set<SomeClass>(new SomeClass());
    SomeClass *x = Services.Get<SomeClass>();
} 
```

在 C++ 中，类型本身并不是一等对象，但至少类型名称将是唯一的，因此您可以以此为关键字。

编辑：名称实际上并不能保证是唯一的，因此请保留 type_info 指针并使用 before 方法来比较它们。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-05T02:52:54.990

您可能想查看[STL 映射模板](http://www.cplusplus.com/reference/stl/map/)。C++ 确实有类型（没有它就很难继承），只是没有具体定义的“类型”类。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-05T03:02:03.663

STL 有两个关联容器： `std::map<K,V> and`std::multimap。还有`std::set<V>`which 应该是 的适配器`std::map<V,void>`，但因此它不是关联容器。multimap 类似于 map，只是它允许在同一个容器内有多个相同的键。map 和 multimap 都包含 type 的元素`std::pair<K,V>`。换句话说，`std::map<K,V>::value_type == std::pair<K,V>`，但是`std::map<K,V>::key_type == K`和`std::map<K,V>::mapped_type == V`。

至于“类型”，我不完全确定您的意思。如果您指的是参数化类，那么 C++ 将其称为“模板编程”或“通用编程”。在上面，`std::map<K,V>`为键的类型和值的类型在 K 和 V 上参数化。C++ 还支持模板函数：

```
template<typename T>
void f(T o); 
```

将声明一个函数，该函数将任何类型作为参数，包括原始类型。C++ 不支持泛型类型解析，因此类型 T 必须具有一定的层次结构。目前，您所能做的只是假设传递的类型确实具有正确的层次结构，如果您尝试在该类型的对象上调用未声明的函数，编译器会报错。

```
template<typename T>
void f(T o) {
    o.do_it();
} 
```

只要 T 定义了方法，上述内容就可以工作`do_it()`。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-05T02:51:12.107

对我来说，字典听起来像是 STL 映射：`std::map<K, T>`. 看看标准模板库——它很棒。一段时间以来，它一直是 ANSI C++ 的一部分。如果我没记错的话，微软从 PJ Plauger 那里得到了一个很好的实现。

# ruby - 如何在数组中找到出现次数最多的项目

> ID：412169
> 
> 赞同：55
> 
> 时间：2009-01-05T02:51:56.163
> 
> 标签：ruby, arrays

如何在数组中找到出现次数最多的项目？

```
[1, 1, 1, 2, 3].mode
=> 1

['cat', 'dog', 'snake', 'dog'].mode
=> dog 
```

* * *

## 回答 #1

> 赞同：85
> 
> 时间：2009-01-05T02:57:55.980

首先建立一个哈希映射数组中的每个值到它的频率……</p>

```
arr = [1, 1, 1, 2, 3]

freq = arr.inject(Hash.new(0)) { |h,v| h[v] += 1; h }
#=> {1=>3, 2=>1, 3=>1} 
```

…然后使用频率表找到频率最高的元素：

```
arr.max_by { |v| freq[v] }
#=> 1 
```

* * *

## 回答 #2

> 赞同：27
> 
> 时间：2009-01-05T10:00:18.560

虽然我喜欢 grep 解决方案的优雅并提醒（或教导）我有关 Enumerable 中我忘记（或完全忽略）的方法，但它很慢，很慢，很慢。我 100% 同意创建`Array#mode`方法是一个好主意，但是 - 这是 Ruby，我们不需要作用于数组的函数库，我们可以创建一个 mixin，将必要的函数添加*到*Array 类本身中。

但是`inject(Hash)`替代方案使用了一种我们也并不真正需要的排序：我们只想要出现次数最多的值。

两种解决方案都没有解决模式可能不止一个值的可能性。也许这不是问题中的问题（无法判断）。不过，我想我想知道是否有平局，无论如何，我认为我们可以在性能上有所提高。

```
require 'benchmark'

class Array
  def mode1
    sort_by {|i| grep(i).length }.last
  end
  def mode2
    freq = inject(Hash.new(0)) { |h,v| h[v] += 1; h }
    sort_by { |v| freq[v] }.last    
  end
  def mode3
    freq = inject(Hash.new(0)) { |h,v| h[v] += 1; h }
    max = freq.values.max                   # we're only interested in the key(s) with the highest frequency
    freq.select { |k, f| f == max }         # extract the keys that have the max frequency
  end
end

arr = Array.new(1_000) { |i| rand(100) }    # something to test with

Benchmark.bm(30) do |r|
  res = {}
  (1..3).each do |i|
    m = "mode#{i}"
    r.report(m) do
      100.times do
        res[m] = arr.send(m).inspect
      end
    end
  end
  res.each { |k, v| puts "%10s = %s" % [k, v] }
end 
```

这是示例运行的输出：

```
 user     system      total        real
mode1                          34.375000   0.000000  34.375000 ( 34.393000)
mode2                           0.359000   0.000000   0.359000 (  0.359000)
mode3                           0.219000   0.000000   0.219000 (  0.219000)
     mode1 = 41
     mode2 = 41
     mode3 = [[41, 17], [80, 17], [72, 17]] 
```

“优化”模式 3 花费了前一个记录保持者的 60% 的时间。还要注意多个最高频率的条目。

* * *

几个月后，我注意到[Nilesh 的回答](https://stackoverflow.com/questions/412169/ruby-how-to-find-item-in-array-which-has-the-most-occurrences/1909239#1909239)，它提供了这个：

```
def mode4
  group_by{|i| i}.max{|x,y| x[1].length <=> y[1].length}[0]
end 
```

它不适用于开箱即用的 1.8.6，因为该版本没有`Array#group_by`. 对于 Rails 开发人员，ActiveSupport 有它，尽管它似乎比`mode3`上面慢 2-3%。但是，使用（优秀的）[反向移植](http://github.com/marcandre/backports)gem 会产生 10-12% 的*增益*，并提供一大堆 1.8.7 和 1.9 的附加功能。

以上仅适用于**1.8.6** - 主要仅适用于安装在 Windows 上。由于我已经安装了它，以下是您从 IronRuby 1.0（在 .NET 4.0 上）获得的内容：

```
==========================   IronRuby   =====================================
(iterations bumped to **1000**)    user     system      total        real
mode1 (I didn't bother :-))
mode2                           4.265625   0.046875   4.312500 (  4.203151)
mode3                           0.828125   0.000000   0.828125 (  0.781255)
mode4                           1.203125   0.000000   1.203125 (  1.062507) 
```

因此，如果性能非常关键，请在您的 Ruby 版本和操作系统上对选项进行基准测试。[YMMV](http://en.wiktionary.org/wiki/your_mileage_may_vary)。

* * *

## 回答 #3

> 赞同：25
> 
> 时间：2015-06-06T22:18:05.960

```
array.max_by { |i| array.count(i) } 
```

* * *

## 回答 #4

> 赞同：13
> 
> 时间：2009-12-15T18:02:05.613

我找到了一个更快的方法。试试这个：

```
 class Array
    def mode4
      group_by{|i| i}.max{|x,y| x[1].length <=> y[1].length}[0]
    end
  end 
```

基准输出：

```
 user     system      total        real
mode1                          24.340000   0.070000  24.410000 ( 24.526991)
mode2                           0.200000   0.000000   0.200000 (  0.195348)
mode3                           0.120000   0.000000   0.120000 (  0.118200)
mode4                           0.050000   0.010000   0.060000 (  0.056315)
     mode1 = 76
     mode2 = 76
     mode3 = [[76, 18]]
     mode4 = 76 
```

* * *

## 回答 #5

> 赞同：10
> 
> 时间：2014-10-08T19:34:02.567

```
arr = [ 1, 3, 44, 3 ]
most_frequent_item = arr.uniq.max_by{ |i| arr.count( i ) }
puts most_frequent_item
#=> 3 
```

甚至不需要考虑频率映射。

* * *

## 回答 #6

> 赞同：8
> 
> 时间：2011-10-16T05:43:14.647

这是这个问题“ [Ruby - Unique elements in Array](https://stackoverflow.com/questions/5857915/ruby-unique-elements-in-array) ”的副本。

这是该问题的解决方案：

```
group_by { |n| n }.values.max_by(&:size).first 
```

该版本似乎比 Nilesh C 的答案还要快。这是我用来对其进行基准测试的代码（OS X 10.6 Core 2 2.4GHz MB）。

感谢 Mike Woodhouse 的（原始）基准测试代码：

```
class Array
   def mode1
     group_by { |n| n }.values.max_by(&:size).first
   end
   def mode2
     freq = inject(Hash.new(0)) { |h,v| h[v] += 1; h }
     max = freq.values.max                   # we're only interested in the key(s) with the highest frequency
     freq.select { |k, f| f == max }         # extract the keys that have the max frequency
   end
end

arr = Array.new(1_0000) { |i| rand(100000) }    # something to test with

Benchmark.bm(30) do |r|
    (1..2).each do |i| r.report("mode#{i}") { 100.times do arr.send("mode#{i}").inspect; end }; end
end 
```

以下是基准测试的结果：

```
 user     system      total        real
mode1                           1.830000   0.010000   1.840000 (  1.876642)
mode2                           2.280000   0.010000   2.290000 (  2.382117)
 mode1 = 70099
 mode2 = [[70099, 3], [70102, 3], [51694, 3], [49685, 3], [38410, 3], [90815, 3], [30551, 3], [34720, 3], [58373, 3]] 
```

如您所见，这个版本的速度大约快了 20%，但需要注意的是忽略了关系。我也喜欢简洁，我个人按原样使用它，而不用到处打补丁。:)

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2013-03-21T09:10:03.810

如果你想避免学习#inject（你不应该这样做......）

```
words = ['cat', 'dog', 'snake', 'dog']
count = Hash.new(0)

words.each {|word| count[word] += 1}
count.sort_by { |k,v| v }.last 
```

但是如果我以前读过这个答案，现在我对#inject 和人一无所知，你需要了解#inject。

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2019-09-04T09:17:41.120

Ruby 版本 >= 2.7 将具有[Enumerable#tally](https://ruby-doc.org/core-2.7.0.preview1/Enumerable.html#method-i-tally)

> 对集合进行计数。返回一个散列，其中键是元素，值是集合中与键对应的元素数。

所以，你可以做

```
[1, 1, 1, 2, 3].tally
# => {1=>3, 2=>1, 3=>1} 
```

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2009-01-05T03:06:10.673

```
idx = {}
[2,2,1,3,1].each { |i| idx.include?(i) ? idx[i] += 1 : idx[i] = 1} 
```

这只是一个简单的索引器。您可以用任何类型的基于符号/字符串的标识符替换 [2,2,1..] 数组，这不适用于对象，您需要引入更多复杂性，但这很简单。

重读你的问题，这个解决方案有点过度设计，因为它会返回所有出现的索引，而不仅仅是出现最多的那个。

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2011-10-16T13:26:02.063

这是另一个版本，它确实为您提供了一种模式应该的关系：

```
def mode
  group_by {|x| x}.group_by {|k,v| v.size}.sort.last.last.map(&:first)
end 
```

换句话说，对值进行分组，然后按值的数量对这些 kv 对进行分组，然后对*这些*kv 对进行排序，取最后一个（最高）大小组，然后展开它的值。我喜欢`group_by`。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2013-12-22T11:34:20.937

```
def mode(array)

    count = []  # Number of times element is repeated in array
    output = [] 
    array.compact!
    unique = array.uniq
    j=0

    unique.each do |i|
        count[j] = array.count(i)
        j+=1
    end
    k=0
    count.each do |i|
        output[k] = unique[k] if i == count.max
        k+=1
    end  

    return output.compact.inspect
end

p mode([3,3,4,5]) #=> [3]

p mode([1,2,3]) #=> [1,2,3]

p mode([0,0,0,0,0,1,2,3,3,3,3,3]) #=> [0,3]

p mode([-1,-1,nil,nil,nil,0]) #=> [-1]

p mode([-2,-2,3,4,5,6,7,8,9,10,1000]) #=> [-2] 
```

# xcode - 在xcode中调试隐藏光标的应用程序时，如何强制它重新出现

> ID：412174
> 
> 赞同：1
> 
> 时间：2009-01-05T02:55:57.433
> 
> 标签：xcode, macos, gdb

在调试全屏游戏（在我的两台显示器之一上）时，当它崩溃并且调试器（在另一台显示器上，未捕获）显示崩溃位置时，光标仍然隐藏。有什么办法可以强制光标重新出现？我可以盲目地四处点击，它可以工作，但它的准确度并不可怕。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-01-21T17:33:01.037

抱歉，我对此无能为力，但我可以请您在[http://bugreport.apple.com/](http://bugreport.apple.com/)上将此作为错误报告给 Apple 那样，也许我们都会从中受益新 XCode 发布的几周或几个月。

顺便说一句，你如何隐藏你的光标？我认为每个进程都有自己的私有游标。因此，一旦您将鼠标移动到其他应用程序，它应该重新设置光标。

也许您可以使用不同的方法在游戏中隐藏光标？例如，与其关闭它，不如让它可见，但给它一个空图像。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2010-03-01T21:52:04.997

你是怎么隐藏光标的？如果你使用了 CGDisplayHideCursor，你应该可以调用 CGDisplayShowCursor(x)，其中 x 是主显示 id？

例如，在 gdb 中，键入：

```
call (unsigned long) CGMainDisplayID() 
```

id 将被返回。

然后输入：

```
call (long) CGDisplayShowCursor(id) 
```

如果您使用了 Cocoa 函数，您应该仍然能够在 gdb 控制台中调用适当的 Cocoa 函数来显示光标。

# c# - C# 集合

> ID：412178
> 
> 赞同：2
> 
> 时间：2009-01-05T02:58:25.400
> 
> 标签：c#, ienumerable

```
int[] mylist = { 2, 4, 5 };
IEnumerable<int> list1 = mylist;
list1.ToList().Add(1);
// why 1 does not get addedto list1?? 
```

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2009-01-05T03:01:33.413

为什么会呢？ToList() 生成一个新列表，并将值“1”添加到其中。由于您不存储退货，因此新列表超出范围时会被丢弃。

ToList() 不会更改原始的 IEnumerable 对象 list1 或提供新的表示形式（如果这样做，它将被称为 AsList() ）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-05T14:34:23.110

你需要 ：

```
int[] mylist = { 2, 4, 5 };
IEnumerable<int> list1 = mylist;
List<int> lst = list1.ToList();
lst.Add(1);
mylist = lst.ToArray(); 
```

# c++ - 在用 C++ 编写 win32 api 包装器时，如何将此指针传递给静态函数

> ID：412183
> 
> 赞同：1
> 
> 时间：2009-01-05T03:00:31.823
> 
> 标签：c++, winapi, function, pointers

我想将函数对象转换为函数。

我写了这段代码，但它不起作用。

```
#include <iostream>

typedef int (*int_to_int)(int);

struct adder {
    int n_;
    adder (int n) : n_(n) {}
    int operator() (int x) { return x + n_; }
    operator int_to_int () {
        return this->*&adder::operator();
    }
};

int main(void) {
    adder add_two(2);
    int_to_int add_fn = add_two;
    std::cout << add_two(3) << std::endl; // expect 5
    std::cout << add_fn(3)  << std::endl; // expect 5
    add_fn = adder(5);
    std::cout << add_fn(3)  << std::endl; // expect 8
    return 0;
} 
```

我收到了来自 g++ 的消息，说`invalid use of non-static member function`。

如何获取指向实例成员函数的指针？

**编辑**：我原来的问题是关于 Win32 API。

我被迫在学校用旧的 Win32 API 编写 Windows 程序。但我不想像文本上的一些示例代码那样编写可怕的 switch 语句。然后，我决定用 C++ 编写包装器。

我想写窗口类...

```
class Window {
public:
    LRESULT update (HWND, UINT, WPARAM, LPARAM);
    void run();
    // below methods are called by update()
    virtual void onclick(int, int);
    virtual void ondraw(); // ... and more methods
}; 
```

我愿意通过派生这个类并重载一些方法来编写我的应用程序类。

最后，我的实际问题是如何在 C++ 中做到这一点。

```
 // on initializing my window object,
 // I must register window class with callback which is 
 // not a C++ function object.
 // I try to explain what I want to do with psudocode mixing C++ and javascript.
 WNDCLASS wndclass;
 Window *self = this;
 wndclass.lpfnWndProc = function () {
     return self.update.apply(self, argunemts);
 }; 
```

换句话说，我必须对函数指针进行闭包。我不知道如何做到这一点，但我不敢相信这不能在 C++ 中做到。

**编辑**：这个问题的原标题是*How to get pointer-to-member-function of instance*。但是这个标题和我的问题并没有充分说明我的实际问题。很抱歉早期回答者和 litb，感谢您的建议和非常有用的答案！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-05T03:16:05.677

**更新**：你告诉我们你想要什么。我在 SO 上发现了这个问题：[Best method for storage this pointer for use in WndProc](https://stackoverflow.com/questions/117792/best-method-for-storing-this-pointer-for-use-in-wndproc)。我不是 Windows 程序员，但 Adam Rosenfield 似乎在使用 SetWindowLongPtr 和 GetWindowLongPtr 方面是正确的。所以，你像这样使用它：

```
LRESULT CALLBACK my_callback(HWND hwnd, UINT ui, WPARAM wp, LPARAM lp) {
    Window * self = reinterpret_cast<Window*>(
        GetWindowLongPtr(hwnd, 0));
    return self->update(hwnd, ui, wp, lp); // handle it.
} 
```

将该函数注册为 wnd-proc 并`this`使用 SetWindowLongPtr 存储 Window 对象的指针。在`WNDCLASSEX`结构中，有一个`cbWndExtra`您分配`sizeof(Window*)`给的字段，它的存储空间足以包含 this 指针。然后你可以打电话

```
SetWindowLongPtr(my_hwnd, 0, reinterpret_cast<LONG_PTR>(this)); 
```

将 this 指针放入该区域。然后像上面一样接收它并委托给真正的成员函数。理论上，您也可以使用静态成员函数。但是你必须小心。从 C 代码调用静态成员函数可能会导致错误，因为 C 代码和 C++ 代码之间的调用约定可能不同。对于 Windows，这可能不是问题 - 我不知道。所以最好另外检查一下自己。

* * *

你尝试的东西是无效的。您尝试返回指向函数调用运算符的指针，但调用时没有提供任何对象，除了您的转换运算符类型错误。转换运算符返回的类型有函数指针类型，但没有成员函数指针类型。您可以得到的最接近的是使用正确的类型：

```
struct adder;
typedef int (adder::*int_to_int)(int);

struct adder {
    int n_;
    adder (int n) : n_(n) {}
    int operator() (int x) { return x + n_; }
    operator int_to_int () {
        return &adder::operator();
    }
}; 
```

现在，甚至不考虑您的转换运算符，因为它必须像这样调用：

```
adder a(10); cout << (a.*(int_to_int)a)(2); // expected: 12 
```

并像这样手动：

```
// note, we just get the member function pointer using the conversion operator.
// Nothing is related to the actual temporary adder object. 
int_to_int i = adder(5);
cout << (adder(10).*i)(2); // expected: 12 
```

通常的函数调用语法不能解决这个问题。简而言之，你所尝试的都是不可能的。

我认为另一个问题是，你为什么要这样做？我认为当我们知道最初的问题是什么时，我们可以更好地帮助您。如果您想让它看起来像函数调用一样工作，则根本不需要任何转换运算符：

```
struct adder {
    int n_;
    adder (int n) : n_(n) {}
    int operator() (int x) { return x + n_; }
};

adder a(10); cout << a(2); // expected: 12 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-05T03:12:51.970

实例方法指针有点棘手，与“普通”函数指针相比​​是完全不同的野兽。

请参阅[C++ FAQ lite 第 33 节](http://www.parashift.com/c++-faq-lite/pointers-to-members.html)对此有何评论。有关具体示例，另请参见[this](http://www.goingware.com/tips/member-pointers.html)和[this](http://www.codeproject.com/KB/cpp/FastDelegate.aspx)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-05T03:13:23.140

指向非静态成员函数的指针不同于指向静态函数（或指向全局因此是静态函数）的指针，因为非静态成员具有隐藏的“this”参数。

全局变量或静态变量的类型类似于 int (*)(int)

但是，非静态的类型类似于 int (ClassName::*)(int)。

话虽如此，您的代码中有更奇怪的东西，因为您似乎试图将构造函数或构造对象分配给函数指针。

# cryptography - 代码高尔夫：Diffie-Hellman 密钥交换

> ID：412184
> 
> 赞同：2
> 
> 时间：2009-01-05T03:00:47.877
> 
> 标签：cryptography, code-golf, public-key

回到 ITAR 时代，有一个[流行的 sig 执行 Diffie-Hellman 密钥交换](http://www.cypherspace.org/adam/rsa/perl-dh.html)：

```
#!/usr/bin/perl -- -export-a-crypto-system-sig Diffie-Hellman-2-lines
($g,$e,$m)=@ARGV,$m||die"$0 gen exp mod\n";print`echo "16dio1[d2%Sa2/d0<X+d
*La1=z\U$m%0]SX$e"[$g*]\EszlXx+p|dc` 
```

使用现代直流，这可以大大减少为：

```
dc -e '16dio???|p' 
```

虽然具有模幂命令的现代 dc 形式（'|' 通过有效的指数加倍计算 g^e % m ）可能除了[APL](https://stackoverflow.com/questions/237496/code-golf-factorials)之外是无与伦比的，但可以改进原始形式吗？请记住，e 和 m 值将非常大；为了加密安全，它们都将是 1024 位的数量级。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-01-05T04:16:42.013

对于那些不熟悉 Diffie-Helman 或`dc`（或 Perl）的人：如果您以 " " 运行它，程序所做的所有事情`program g x m`都是输出 g ^x (mod m)，其中 g、x 和 m 以十六进制给出。例如

```
./dh.pl 10 2 9
4 
```

因为 10 是 16，而 10 ²是 256，即 4 mod 9。

`dc`命令说`16dio???|p`：

*   将**16**压入堆栈，
*   **d**复制它，
*   将输入基数（基数）设置为弹出堆栈的结果（16，十六进制）**，**
*   将输出**基数**设置为弹出堆栈的结果（16），
*   获取三行输入并执行它们（所以如果这三行是三个数字 g、x、m，它们会被压入堆栈），
*   求幂 g ^x (mod m)，
*   **打印**它。

鉴于它`dc`有一个`|`用于计算“g ^x (mod m)”的单字符命令“”，而这正是问题所在，我发现在任何编程语言中都不太可能对其进行改进。`dc`恰好是解决这个问题的工具；将编程语言与正确的工具进行比较并非易事。（例如，任何常见的编程语言都需要两个以上的字符来列出目录中的文件，而“ `ls`”只有 2 个。）

也就是说，我注意到`dc -e '16dio???|p'`似乎希望我在三个不同的行中输入数字（至少在`dc`我这里），所以它***可以改进***为可以在同一行上处理它们的东西:-)

`dc -e '16dio?|p'`

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-05T12:23:27.290

我非常怀疑任何东西都会超越现代直流版本！这是Python：

```
def f(g,x,m):
 def h(n):return int(`n`,16)
 return h(g)**h(x)%h(m) 
```

它在 Python 3.0 中不起作用，因为我们已经[逐步淘汰了反向引号](http://docs.python.org/dev/py3k/whatsnew/3.0.html#removed-syntax)。

# sharepoint-2007 - SharePoint：媒体播放器自定义字段控件

> ID：412187
> 
> 赞同：1
> 
> 时间：2009-01-05T03:01:37.873
> 
> 标签：sharepoint-2007

我正在尝试实现此 MSDN 文章中描述的媒体播放器自定义字段控件：http: [//msdn.microsoft.com/en-us/library/aa981226.aspx](http://msdn.microsoft.com/en-us/library/aa981226.aspx)

我在自定义内容类型中创建了一个自定义网站栏（链接类型），并按照所有说明将解决方案部署到 SharePoint 并将控件添加到页面布局。

但是，当我基于使用此字段控件的页面布局创建页面时，页面的“编辑”或“查看”模式下没有显示任何内容。

我翻遍了 SharePoint 日志，在加载页面时，我在 ULS 中看到以下错误：

控件模板“MediaPlayerFieldControl”不存在。

如果你已经实现了这个控件，除了文章详细介绍的内容之外，你是否还需要实现其他任何东西？很确定我在这里不需要 ASCX，因为控件正在处理渲染媒体播放器。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-05T21:01:05.653

想通了这个...

我一开始是手动将 SafeControl 条目添加到我的 web.config 中，但由于某种原因这不起作用。我现在将它包含在 manifest.xml 中，如下所示：

```
<Assembly DeploymentTarget="GlobalAssemblyCache" Location="MyControlAssembly.dll">
  <SafeControls>
    <SafeControl Assembly="MyControlAssembly, Version=1.0.0.0, Culture=neutral, PublicKeyToken=07085c2a3fb711ee" Namespace="MyControlAssembly" TypeName="*" Safe="True" />
  </SafeControls>
</Assembly> 
```

不知道有什么区别，但这成功了

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-05T21:24:47.680

SharePoint 2007 没有字节范围请求。对大型媒体文件进行查询将从 SQL 中获取整个 blob 并将其存储在 WFE 中。我会小心你如何实现这一点。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-07-30T08:49:21.293

将文件 MediaPlayerFieldControl.ascs 复制到路径：“C:\Program Files\Common Files\Microsoft Shared\web server extensions\12\TEMPLATE\CONTROLTEMPLATES”

# asp.net - ASP.NET 显示错误详细信息

> ID：412207
> 
> 赞同：2
> 
> 时间：2009-01-05T03:28:15.137
> 
> 标签：asp.net, iis

我最近将我的 ASP.NET 3.5 应用程序部署到我的测试服务器上，这是一个新安装的 Windows Server 2003 Standard 副本，上面安装了 IIS 6.0 和 .NET 3.5 SP1。当我查看应用程序（甚至从服务器上的 Web 浏览器）时，我得到：

> “/”应用程序中的服务器错误。
> 
> 运行时错误
> 
> 说明：服务器上发生应用程序错误。此应用程序的当前自定义错误设置可防止远程查看应用程序错误的详细信息（出于安全原因）。但是，它可以被本地服务器机器上运行的浏览器查看。
> 
> 详细信息：要在远程计算机上查看此特定错误消息的详细信息，请在位于当前 Web 应用程序根目录的“web.config”配置文件中创建一个标签。然后，此标记应将其“模式”属性设置为“关闭”。

但是，我在本地服务器计算机上，所以我不确定为什么会看到此错误。我已添加`<customErrors mode="Off"/>`到我的 Web.Config 文件中，但我仍然看不到错误详细信息。有谁知道如何解决这一问题？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-05T04:10:16.037

检查应用程序事件日志。默认情况下，ASP .NET 应该在其中转储未捕获的错误。

另外，您是否已将应用程序部署到子目录中，但尚未将子目录设置为应用程序？如果它不是应用程序，ASP .NET 可能会查看根 web.config 而不是子目录中的那个。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-05T03:31:36.597

检查您的网络配置。我怀疑您的配置中存在错误，导致无法正确解析它——这可能会显示在事件日志中。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-09T18:48:57.750

事实证明，这是在同一个应用程序池上运行的不同 .NET 版本的问题。同一台服务器上的另一个禁用网站被设置为使用 .NET 1.1 作为其应用程序。显然，将其更改为 .NET 2.0 解决了该问题。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-05T04:33:08.563

我在 Elmah ( [http://code.google.com/p/elmah/](http://code.google.com/p/elmah/) ) 方面有很多很好的经验。它确实详细说明了幕后错误记录（电子邮件和/或数据库）。

# python - 如何使用python将程序放在前面

> ID：412214
> 
> 赞同：1
> 
> 时间：2009-01-05T03:36:21.860
> 
> 标签：python, qt

如果出现条件，我想将我的 python 应用程序强制放在前面。我正在使用 Kubuntu 和 QT3.1

我试过 setActiveWindow()，但它只在 KDE 中闪烁任务栏。

我认为 Windows 有一个用于 VB 的函数 Bringwindowtofront()。

KDE有类似的东西吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-05T13:23:31.723

检查 KWin 是否配置为防止焦点窃取。

您的代码可能没有任何问题——但我们 linux 人员不喜欢应用程序在我们工作时干扰我们，因此窃取焦点有点不受欢迎，并且在某些窗口管理器下也很困难。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-06T02:13:16.287

有用！

```
show()
raiseW()
setActiveWindow() #in that sequence 
```

*加上*KWin 配置更改以强制防止焦点窃取。

谢谢您的帮助。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-05T04:46:47.443

您是否尝试过在窗口上使用这 3 个（按此顺序）而不是仅使用`setActiveWindow`？

```
show()
raise() # this might be raiseW() in Python
setActiveWindow() 
```

# mysql - mysql gui 工具 64 位 rpm

> ID：412216
> 
> 赞同：1
> 
> 时间：2009-01-05T03:36:58.943
> 
> 标签：mysql, 64-bit, client

是否有任何 64 位版本的 MySQL GUI 工具 RPM？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-05T04:09:47.347

[SQuirreL](http://squirrel-sql.sourceforge.net/)或任何基于 Java 构建的 GUI 工具都可以使用。您只需要 64 位 JRE。

**[已编辑]**

[MySql Query Browser](http://dev.mysql.com/doc/query-browser/en/index.html)和[MySql Workbench](http://dev.mysql.com/doc/query-browser/en/index.html)都是基于 x86-64 架构开发的。

# apache-flex - 我应该如何组织我的 Flex 应用程序？

> ID：412218
> 
> 赞同：5
> 
> 时间：2009-01-05T03:43:44.983
> 
> 标签：apache-flex

我目前是一名 .NET 开发人员，但我开始使用 Flex 一点点，我发现社区很棒。那里有很多很棒的资源，但我在概念上遇到的问题之一是如何组织一个弹性项目。从“传统”的 ASP.NET Web 应用程序的角度来看，我会创建相关页面、控件、CSS、JavaScript 等的文件夹。

组织 flex 应用程序的最佳模式是什么？我喜欢在我的 MXML 文件中使用模式背后的代码，但它们本身并不是真正的“页面”，那么如何避免将所有内容都转储到 src 文件夹的根目录中呢？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-05T04:47:18.253

使用像 Cairngorm 这样的 MVC 架构和反向域命名结构是很常见的。因此，该项目被拆分为模型、视图、控制器……此处显示了一个 Cairngorm 示例：

```
ProjectName
-assets
--images
-lib
-locale
-src
--com
---company
----project
-----model
-----events
-----view
-----controller
-----business
-----delegates
-----views
------components
-----util
-----vo
-Main.mxml
-Style.css 
```

然后，如果您添加第三方源，它们将变为：

```
com/thirdparty/component 
```

[此处](http://blog.tsclausing.com/post/11)的帖子对每个文件夹进行了进一步的解释。

这是应用程序的客户端，我通常看到应用程序的服务器端拆分为自己的文件夹结构。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-05T04:10:01.043

这是一个粗略的轮廓，但是当我执行 FLEX 应用程序时，结构总是看起来像：

```
  源代码
   | - 组件
   | | - 容器
   | | | - 动作脚本
   | | | -mxml
   | | - 视觉的
   | | - 动作脚本
   | | -mxml
   |
   | - 页面
   | | - 动作脚本
   | | -mxml
   |  
   | - 包括
   | | - 图片
   | | - xml
   | | - 瑞士法郎
   | | -CSS
   |
   | - 万维网
   | | - 包括
   | | | - 图片
   | | | - 瑞士法郎
   | | | -CSS
   | | | - javascript
   | |
   | | - index.html
   |
   | - 实用程序
   | | - 动作脚本
   |
   | - 主要.mxml

```

所有组件都进入组件目录的容器或可视目录。

应用程序的主要部分进入 pages 目录。

包含目录用于所有资产。

www 目录包括将应用程序放到网络上所需的所有内容。

util 目录包含应用程序的所有 actionscript 业务逻辑。

# multithreading - 在嵌套循环中并行化代码

> ID：412227
> 
> 赞同：5
> 
> 时间：2009-01-05T03:52:55.290
> 
> 标签：multithreading, f#, async-workflow

你总是听说函数式代码本质上比非函数式代码更容易并行化，所以我决定编写一个函数来执行以下操作：

给定一个字符串输入，合计每个字符串的唯一字符数。因此，给定输入`[ "aaaaa"; "bbb"; "ccccccc"; "abbbc" ]`，我们的方法将返回`a: 6; b: 6; c: 8`。

这是我写的：

```
(* seq<#seq<char>> -> Map<char,int> *)
let wordFrequency input =
    input
    |> Seq.fold (fun acc text ->
        (* This inner loop can be processed on its own thread *)
        text
        |> Seq.choose (fun char -> if Char.IsLetter char then Some(char) else None)
        |> Seq.fold (fun (acc : Map<_,_>) item ->
            match acc.TryFind(item) with
            | Some(count) -> acc.Add(item, count + 1)
            | None -> acc.Add(item, 1))
            acc
        ) Map.empty 
```

这段代码在理想情况下是可并行化的，因为其中的每个字符串`input`都可以在其自己的线程上处理。它并不像看起来那么简单，因为内部循环将项目添加到所有输入之间共享的 Map 中。

我希望将内部循环分解到自己的线程中，并且我不想使用任何可变状态。**我将如何使用异步工作流重写此函数？**

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2010-02-13T07:18:13.937

你可以这样写：

```
let wordFrequency =
  Seq.concat >> Seq.filter System.Char.IsLetter >> Seq.countBy id >> Map.ofSeq 
```

并仅使用两个额外的字符将其并行化以使用DLL 中的`PSeq`模块`FSharp.PowerPack.Parallel.Seq`而不是普通`Seq`模块：

```
let wordFrequency =
  Seq.concat >> PSeq.filter System.Char.IsLetter >> PSeq.countBy id >> Map.ofSeq 
```

例如，从 5.5Mb King James 圣经中计算频率所需的时间从 4.75s 下降到 0.66s。这是这台 8 核机器的 7.2 倍加速。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-05T19:40:09.747

正如已经指出的那样，如果您尝试让不同的线程处理不同的输入字符串，则会出现更新争用，因为每个线程都可以增加每个字母的计数。您可以让每个线程生成自己的地图，然后“将所有地图相加”，但最后一步可能会很昂贵（并且由于共享数据而不太适合使用线程）。我认为大型输入可能会使用如下算法运行得更快，其中每个线程处理不同的字母计数（对于输入中的所有字符串）。因此，每个线程都有自己独立的计数器，因此没有更新争用，也没有最后一步来组合结果。然而，我们需要预处理来发现“唯一字母集”，并且这一步确实存在相同的争用问题。（在实践中，

```
#light

let input = [| "aaaaa"; "bbb"; "ccccccc"; "abbbc" |]

// first discover all unique letters used
let Letters str = 
    str |> Seq.fold (fun set c -> Set.add c set) Set.empty 
let allLetters = 
    input |> Array.map (fun str -> 
        async { return Letters str })
    |> Async.Parallel 
    |> Async.Run     
    |> Set.union_all // note, this step is single-threaded, 
        // if input has many strings, can improve this

// Now count each letter on a separate thread
let CountLetter letter =
    let mutable count = 0
    for str in input do
        for c in str do
            if letter = c then
                count <- count + 1
    letter, count
let result = 
    allLetters |> Seq.map (fun c ->
        async { return CountLetter c })
    |> Async.Parallel 
    |> Async.Run

// print results
for letter,count in result do
    printfn "%c : %d" letter count 
```

我确实已经“完全改变了算法”，主要是因为我原来的算法由于更新争用而不特别适合直接数据并行化。根据您要学习的具体内容，这个答案可能会或可能不会让您特别满意。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-14T04:36:12.913

[正如Don Syme 解释](http://blogs.msdn.com/dsyme/archive/2007/10/11/introducing-f-asynchronous-workflows.aspx)的那样，并行与异步不同。

因此，IMO 最好使用 PLINQ 进行并行化。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-05T04:29:13.597

我根本不会说 F#，但我可以解决这个问题。考虑使用 map/reduce：

令*n* = *card(Σ)*为字母 Σ 中符号 σ 的数量。

*地图阶段：*

产生*n 个*进程，其中第*i*个进程的分配是统计符号*σ [i]*在整个输入向量中出现的次数。

*减少阶段*：

按顺序收集*n 个*进程中每个进程的总数。该向量是您的结果。

现在，这个版本不会对串行版本产生任何改进；我怀疑这里有一个隐藏的依赖关系，这使得这本质上难以并行化，但我太累了，而且今晚无法证明这一点。

# c# - TDD - 你测试了多少？

> ID：412230
> 
> 赞同：3
> 
> 时间：2009-01-05T03:55:20.810
> 
> 标签：c#, .net, unit-testing, tdd

我正在开发一个新项目并且我正在使用存储库模式，我有一个从数据库中提取数据的存储库和一个使用存储库并执行所有业务逻辑的“服务”类。

类似于以下内容；

```
public class UserRepository : IUserRepository
{
    public IQueryable<User> GetUsers()
    {
    // do stuff
    }
}

public class UserService 
{
    public IList<User> GetUserById
    {
        var rep = new UserRepository();
        var users = rep.GetUsers();
        // do business logic
        return users.ToList();
    }
} 
```

你会同时测试 UserService 和 UserRepository 还是你认为只测试 Service 就足够了？我认为由于该服务正在使用存储库，它应该很有趣，但它确实会杀死代码覆盖率。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-01-05T04:07:01.487

您应该同时测试它们，因为有一天可能会有除 UserService 之外的其他 UserRepository 客户端，并且这些客户端使用 UserRepository 的方式可能与 UserService 不同。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-01-05T04:19:10.387

测试您需要的功能：

*   某些功能可能位于一个类中
*   有些人可能住在另一个班级
*   有些可能需要两个课程

从您的描述看来，您可以定义功能，因此您几乎可以证明测试任何您喜欢的东西是合理的；-)

如果您正在寻找最低的 TDD 效率，请**仅测试当前功能，然后继续**。*代码覆盖率与 TDD 无关*；这是一个单元测试指标（价值有问题）

[让投票开始吧！;-)]

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-01-05T04:04:08.030

如果您已经编写了代码并且现在才考虑测试，那么您已经偏离了测试驱动开发的真正路径 :-) 也就是说，如果是我的代码，我会`UserService`先编写测试，然后检查我的代码覆盖率。

编辑以回应评论：如果您还没有真正编写代码，我会`UserService`先编写测试，因为这是您的应用程序的最终目标。然后，当我编写代码以使`UserService`测试通过时，我会生成存储库的测试。这些测试最终成为存储库的规范，以防您以后想重用它。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-05T04:02:37.657

你应该同时测试它们。测试了存储库，当你去测试服务时，它会更容易和更可靠。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-01-05T06:52:11.903

您在这里有两个选择：

*   单元测试 - 在这种情况下，您在不访问服务、磁盘、数据库、活动目录等的情况下单独测试每个组件。这是通过让您的测试充当驱动程序并存根/模拟您正在测试的类使用的类来实现的.

*   TDD - 这就像单元测试，但在这种情况下，您将编写测试用例，运行它以使其失败，编写足够的代码使其通过，运行它以确认它通过，然后继续下一个。在这种情况下，应涵盖所有代码。

在您的情况下，重要的是要意识到在测试 UserService 时，您将针对实现 IUserRepository 的 DummyRepository 对其进行测试。在这种情况下，您可以完全测试用户服务，而无需访问真正的底层存储库类/数据源。这将在您的两个类中的错误之间产生明显的区别，并使您能够控制模拟存储库的所有可能故障。

您将执行相同的操作来测试 UserRepository 实现。这是通过排除对底层资源的访问。您可以使用使用分析器 API 模拟依赖项的 Mock 框架，或者使用接口/虚拟方法来允许单元测试类覆盖对资源的访问。

除了上面的白盒测试技术，你还需要做你的黑盒/集成测试。这是您有一些端到端测试用例的地方，它们测试整个应用程序场景，其中 UserService 与 UserRepository 交互，然后与数据源交互。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-01-05T08:41:22.337

如果您遵循 TDD 流程 - 正如问题标题所暗示的那样 - 如果没有经过测试，您将不会同时拥有 UserRepository 和 UserService 类。

有一句极限编程说：“**测试所有可能破坏**的东西”，所以你最好对它们都进行测试，这样你就可以对你的代码充满信心。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-01-05T08:50:03.617

正如其他人已经提到的那样，如果 UserService 是您的应用程序的客户端将看到的所有内容，那么我现在只对其进行测试并使您的客户端无法访问 UserRepository（例如，将其设置为内部）。这样，即使不单独测试类，您也应该获得良好的代码覆盖率。

如果您的代码覆盖率不好，这通常意味着您的测试不充分，或者您已经实现了无法通过公共接口调用的东西，因此可能会被删除。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-01-05T20:15:00.050

通过模拟 Repository 编写服务单元测试，以测试 Service 中的业务逻辑，并测试不同的 Repository 场景，如异常、测试返回值等。一些模拟框架（如 EasyMock）需要 Repository 接口，而其他模拟框架（如 Mockito）则不需要。这样您的服务测试将不会访问数据库并且执行速度会更快。

编写存储库测试以测试所有数据库交互。对测试数据使用数据库单元数据集/夹具，以确保您的数据库逻辑正确实施。

此外，您可能希望在无需模拟存储库的情况下访问数据库的服务类上编写集成测试。

# database - Google Gears - 同步支持到什么级别？

> ID：412255
> 
> 赞同：3
> 
> 时间：2009-01-05T04:16:50.767
> 
> 标签：database, synchronization, google-gears, data-synchronization

我有几个关于数据同步的问题。架构似乎并不清楚这一点：

1.  Google Gears 是否提供数据的自动同步（从客户端到服务器以及从服务器到客户端）？

2.  如果它确实提供了自动数据同步，那么我可以编写函数来挂钩同步机制（在服务器上和客户端上）以控制同步哪些数据？

3.  无论如何要对服务器上的数据进行分区？例如，客户端应该只能下载与其相关的表中的那些行（例如，表中有“主机名”列，并且只有那些包含尝试下载数据的客户端主机名的行应该下载到它）

基本上我正在寻找的是：Google Gears Synchronization 是否支持 SQL Server 合并复制等数据同步功能？[ [http://technet.microsoft.com/en-us/library/ms152746.aspx](http://technet.microsoft.com/en-us/library/ms152746.aspx) ]

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-05T05:24:36.043

Gears 不提供任何同步功能。我想我记得在它刚问世时听过一个齿轮开发者的播客采访，他说他们想提供一个框架来帮助同步，但意识到每个人的同步需求都非常不同很难找到一刀切的解决方案。

此外，需要注意的是，由于 Gears 的数据库部分实际上只是一个可通过 javascript 访问的客户端数据库，因此 Gears 中没有任何内容指定特定的服务器端实现，甚至没有指定特定的服务器 API。因此，您描述的数据分区之类的事情取决于开发人员，就像与服务器的一般接口一样。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-05T05:37:18.683

是的，您可以根据需要对服务器上的数据进行分区......因为没有自动同步

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-13T03:33:49.203

如果您查看 Google Gears 文档，您会发现本地 SQLite 数据库对您来说是不可写的。它对 Gears 是可写的，因此它甚至无法帮助您对将发送到服务器的数据进行本地缓存。在这一点上，它用于缓存只读数据。

# iphone - iPhone 能确定你是朝北、朝南、朝东还是朝西吗？

> ID：412256
> 
> 赞同：3
> 
> 时间：2009-01-05T04:18:09.513
> 
> 标签：iphone, cocoa-touch

iPhone 能确定你是朝北、朝南、朝东还是朝西吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-01-05T04:47:03.887

如果您正在为 2.2 开发，您可能希望查看 CoreLocation 的以下新增内容：

CLLocation.course

CLLocation.speed

CLLocationDirection

CLLocationSpeed

CLLocation.course 将为您提供航向，让您确定北/南/东/西。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-05T04:23:11.923

我不太确定，但这里有一些选项：

在 3-10 秒内收集两个或更多数据点。使用 GPS 绘制出运动趋向的位置。那可能是你的方向。

此外，您可以使用加速度计来确定 iPhone 本身正在移动的方向（左、右、前、后）。将其与之前的数据配对，您可能会获得更准确的读数。

这些都不是很好，因为 GPS 并不像你想要的那么敏感，而且加速度计可能比你想要的更敏感，并且都依赖于运动。但它们可能会起作用。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-05T04:31:54.947

iPhone 或 iPhone 3G 中没有指南针。*然而，iPhone 3GS 增加了数字罗盘，因此这个过程变得更加容易。*

在第一代或 3G 上，确定面的唯一方法是 stalepretzel 的建议。但请注意，只有当 GPS 有足够的锁定并且用户实际移动时，它才会起作用。您必须进行大量的平滑处理才能获得任何类型的可用数据，也许还需要指示用户在行走时保持不动。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-25T06:57:32.237

这可能有点骇人听闻，但我正在做的是跟踪纬度/经度，然后确定方向。

在返回 GPS 信息的代码中，我创建了一个委托，该委托将返回纬度和经度

```
[[self delegate] currentDirectionLat:newLocation.coordinate.latitude Long:newLocation.coordinate.longitude]; 
```

然后，使用委托的代码将有一个类似的方法来获取坐标，然后在屏幕上设置一个标签来指示方向。

```
-(void)currentDirectionLat:(float)latitude Long:(float)longitude
{
    prevLongitude = currentLongitude;
    prevLatitude  = currentLatitude;

    currentLongitude = longitude;
    currentLatitude = latitude;

    NSString *latDirection = @"";
    if (currentLatitude > prevLatitude)
        latDirection = @"N";
    else if (currentLatitude < prevLatitude)
        latDirection = @"S";

    NSString *longDirection = @"";
    if (currentLongitude > prevLongitude)
        longDirection = @"E";
    else if (currentLongitude < prevLongitude)
        longDirection = @"W";

    if ([longDirection length] > 0)
        [lblDirection setText:[NSString stringWithFormat:@"%@%@",latDirection,longDirection]];  
} 
```

我还没有 100% 测试过这一点，但似乎已经在我正在编写的一个应用程序上工作。如果您想了解更多信息，请告诉我，我可以将我在上面完成的代码转发给您。

在 iPhone 开始获得经纬度变化之前，你也不会得到很好的阅读。然而，这并不需要太多改变！

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2009-01-05T04:40:22.153

据我所知**，iPhone 3G 中没有指南针**。不幸的是，除非我遗漏了一些东西，否则我认为查看 GPS 和加速度计数据不会帮助您确定 iPhone 面向的方向 - 只有您正在行驶的方向。对不起。

**更新**：请注意，问题和这篇文章是在 iPhone 3G 是当前型号时写的，从那时起，Apple 发布了**iPhone 3GS**，其中**引入了指南针**。

# asp.net - 有没有办法在 ASP.net 的 gmail 中制作这样的进度条？

> ID：412264
> 
> 赞同：4
> 
> 时间：2009-01-05T04:23:31.673
> 
> 标签：asp.net

有没有办法在 ASP.net 的 gmail 中制作这样的进度条？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-05T04:28:03.160

以下是一些基于 ASP .NET 的进度条控件：

*   [ASP.NET AJAX 进度条控件](http://mattberseth.com/blog/2008/05/aspnet_ajax_progress_bar_contr.html)
*   [ASP .NET 进度条](http://www.codeproject.com/KB/user-controls/progressbar.aspx)（ASP .NET 控件库）
*   [ASP .NET 静态进度条控件](http://www.codeproject.com/KB/user-controls/progressbar.aspx)

JavaScript 替代品：

*   [jQuery 进度条](http://t.wits.sg/misc/jQueryProgressBar/demo.php)
*   [jQuery.UI 进度条小部件](http://mattberseth.com/blog/2008/07/jqueryui_progressbar_widget.html)

# java - 带有 Gui Designer 的小程序

> ID：412271
> 
> 赞同：4
> 
> 时间：2009-01-05T04:28:41.350
> 
> 标签：java, user-interface, netbeans, applet

我想问你是否有可能使用 GUI Designer 在 netbeans 6.5 中编写 Java Applet。当我向源添加新文件并选择 Applet 或 JApplet 时，我现在发现 Designer 就像在 JForm 中一样。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-01-05T10:04:16.897

如果您想在 NetBeans 中设计小程序，请执行以下操作：

1.  打开一个新项目
2.  右键单击“源包”
3.  选择“新建”和“其他”
4.  在“类别”下选择“Swing GUI 表单”并在“文件类型”下选择“JApplet 表单”

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-08-19T23:05:03.893

要使 Designer 可用，请按以下方式制作新的小程序：

1.  选择菜单“文件\新文件”。
2.  从“类别”中选择“Swing GUI 表单”
3.  从“文件类型”中选择“JAppletForm”，然后按“下一步”。
4.  输入所需的类名、包名，然后按“完成”。
5.  现在，如果您使用小程序选项卡选择选项卡，您可以看到两个子选项卡“源”和“设计”。通过选择“设计”，您将能够设计您的小程序。

# asp.net - FormsAuthentication.SignOut() 不会将用户注销

> ID：412300
> 
> 赞同：150
> 
> 时间：2009-01-05T04:48:42.387
> 
> 标签：asp.net, forms-authentication

把我的头砸得太久了。如何防止用户在使用 FormsAuthentication.SignOut 注销后浏览网站页面？我希望这样做：

```
FormsAuthentication.SignOut();
Session.Abandon();
FormsAuthentication.RedirectToLoginPage(); 
```

但事实并非如此。如果我直接输入 URL，我仍然可以浏览到该页面。我有一段时间没有使用自己滚动的安全性了，所以我忘记了为什么这不起作用。

* * *

## 回答 #1

> 赞同：217
> 
> 时间：2009-08-20T15:22:50.833

用户仍然可以浏览您的网站，因为在您致电时不会清除 cookie，`FormsAuthentication.SignOut()`并且它们会在每次新请求时进行身份验证。在 MS 文档中说 cookie 将被清除，但它们不会，错误？`Session.Abandon()`它与cookie完全相同。

您应该将代码更改为：

```
FormsAuthentication.SignOut();
Session.Abandon();

// clear authentication cookie
HttpCookie cookie1 = new HttpCookie(FormsAuthentication.FormsCookieName, "");
cookie1.Expires = DateTime.Now.AddYears(-1);
Response.Cookies.Add(cookie1);

// clear session cookie (not necessary for your current problem but i would recommend you do it anyway)
SessionStateSection sessionStateSection = (SessionStateSection)WebConfigurationManager.GetSection("system.web/sessionState");
HttpCookie cookie2 = new HttpCookie(sessionStateSection.CookieName, "");
cookie2.Expires = DateTime.Now.AddYears(-1);
Response.Cookies.Add(cookie2);

FormsAuthentication.RedirectToLoginPage(); 
```

`HttpCookie`位于`System.Web`命名空间中。[MSDN 参考](https://msdn.microsoft.com/en-us/library/system.web.httpcookie(v=vs.110).aspx)。

* * *

## 回答 #2

> 赞同：23
> 
> 时间：2012-02-15T01:35:27.027

使用 x64igor 和 Phil Haselden 的上述两个帖子解决了这个问题：

**1\. x64igor 给出了注销的例子：**

*   您首先需要通过将响应中的空 cookie 传递回注销来**清除身份验证 cookie 和会话 cookie 。**

    ```
    public ActionResult LogOff()
    {
        FormsAuthentication.SignOut();
        Session.Clear();  // This may not be needed -- but can't hurt
        Session.Abandon();

        // Clear authentication cookie
        HttpCookie rFormsCookie = new HttpCookie( FormsAuthentication.FormsCookieName, "" );
        rFormsCookie.Expires = DateTime.Now.AddYears( -1 );
        Response.Cookies.Add( rFormsCookie );

        // Clear session cookie 
        HttpCookie rSessionCookie = new HttpCookie( "ASP.NET_SessionId", "" );
        rSessionCookie.Expires = DateTime.Now.AddYears( -1 );
        Response.Cookies.Add( rSessionCookie ); 
    ```

**2\. Phil Haselden 上面给出了注销后如何防止缓存的例子：**

*   您需要**通过 Response 在客户端使缓存无效**。

    ```
     // Invalidate the Cache on the Client Side
        Response.Cache.SetCacheability( HttpCacheability.NoCache );
        Response.Cache.SetNoStore();

        // Redirect to the Home Page (that should be intercepted and redirected to the Login Page first)
        return RedirectToAction( "Index", "Home" ); 
    } 
    ```

* * *

## 回答 #3

> 赞同：19
> 
> 时间：2009-01-05T05:00:13.033

在我看来，您的 web.config 授权部分没有在 . 请参阅下面的示例。

```
<authentication mode="Forms">
  <forms name="MyCookie" loginUrl="Login.aspx" protection="All" timeout="90" slidingExpiration="true"></forms>
</authentication>
<authorization>
  <deny users="?" />
</authorization> 
```

* * *

## 回答 #4

> 赞同：14
> 
> 时间：2010-03-22T00:26:52.480

这里的关键是你说“如果我直接输入一个 URL……”。

默认情况下，在表单身份验证下，浏览器会为用户缓存页面。因此，直接从浏览器地址框下拉列表中选择一个 URL，或者输入它，可以从浏览器的缓存中获取页面，并且永远不会返回服务器检查身份验证/授权。对此的解决方案是防止在每个页面的 Page_Load 事件或基本页面的 OnLoad() 中进行客户端缓存：

```
Response.Cache.SetCacheability(HttpCacheability.NoCache); 
```

您可能还想致电：

```
Response.Cache.SetNoStore(); 
```

* * *

## 回答 #5

> 赞同：12
> 
> 时间：2010-05-28T19:02:45.203

我以前也为此苦苦挣扎过。

下面是似乎正在发生的事情的一个类比... 新访问者 Joe 来到该站点并使用 FormsAuthentication 通过登录页面登录。ASP.NET 为 Joe 生成了一个新身份，并给了他一个 cookie。那块饼干就像房子的钥匙，只要乔带着那把钥匙回来，他就可以打开锁。每位访客都会获得一把新钥匙和一把新锁以供使用。

当`FormsAuthentication.SignOut()`被调用时，系统会告诉 Joe 丢失密钥。通常，这是可行的，因为乔不再拥有钥匙，他无法进入。

但是，如果乔回来了，并且*确实*有那把丢失的钥匙，他就会被放回去！

据我所知，没有办法告诉 ASP.NET 更改门上的锁！

我可以忍受的方式是在 Session 变量中记住 Joe 的名字。当他注销时，我放弃了会话，所以我不再知道他的名字了。稍后，为了检查他是否被允许进入，我只需将他的 Identity.Name 与当前会话的内容进行比较，如果它们不匹配，则他不是有效的访问者。

简而言之，对于一个网站，如果不`User.Identity.IsAuthenticated`检查您的 Session 变量，请不要依赖！

* * *

## 回答 #6

> 赞同：7
> 
> 时间：2015-08-28T17:51:58.030

经过大量搜索终于这对我有用。我希望它有所帮助。

```
public ActionResult LogOff()
{
    AuthenticationManager.SignOut();
    HttpContext.User = new GenericPrincipal(new GenericIdentity(string.Empty), null);
    return RedirectToAction("Index", "Home");
}

<li class="page-scroll">@Html.ActionLink("Log off", "LogOff", "Account")</li> 
```

* * *

## 回答 #7

> 赞同：6
> 
> 时间：2011-05-26T19:06:09.227

这对我有用

```
public virtual ActionResult LogOff()
    {
        FormsAuthentication.SignOut();
        foreach (var cookie in Request.Cookies.AllKeys)
        {
            Request.Cookies.Remove(cookie);
        }
        foreach (var cookie in Response.Cookies.AllKeys)
        {
            Response.Cookies.Remove(cookie);
        }
        return RedirectToAction(MVC.Home.Index());
    } 
```

* * *

## 回答 #8

> 赞同：5
> 
> 时间：2016-12-27T18:43:03.853

# 这个答案在技术上与 Khosro.Pakmanesh 相同。我发布它是为了澄清他的答案与该线程上的其他答案有何不同，以及在哪种用例中可以使用它。

通常要清除用户会话，执行

```
HttpContext.Session.Abandon();
FormsAuthentication.SignOut(); 
```

将有效地注销用户。*但是*，如果在同一个请求中您需要检查`Request.isAuthenticated`（例如，在授权过滤器中可能经常发生），那么您会发现

```
Request.isAuthenticated == true 
```

甚至 _after 你做了`HttpContext.Session.Abandon()`和`FormsAuthentication.SignOut()`.

唯一有效的就是做

```
AuthenticationManager.SignOut();
HttpContext.User = new GenericPrincipal(new GenericIdentity(string.Empty), null); 
```

这有效地设置了`Request.isAuthenticated = false`.

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2009-01-05T04:58:59.730

您发布的代码看起来应该正确删除表单身份验证令牌，因此有问题的文件夹/页面可能实际上并未受到保护。

您是否确认在登录之前无法访问这些页面？

您可以发布您正在使用的 web.config 设置和登录代码吗？

* * *

## 回答 #10

> 赞同：3
> 
> 时间：2009-05-06T15:47:12.803

我一直在为我的所有页面编写一个基类，我遇到了同样的问题。我有如下代码，但它不起作用。通过跟踪，控制从 RedirectToLoginPage() 语句传递到下一行而不被重定向。

```
if (_requiresAuthentication)
{
    if (!User.Identity.IsAuthenticated)
        FormsAuthentication.RedirectToLoginPage();

    // check authorization for restricted pages only
    if (_isRestrictedPage) AuthorizePageAndButtons();
} 
```

我发现有两种解决方案。要么修改 FormsAuthentication.RedirectToLoginPage(); 成为

```
if (!User.Identity.IsAuthenticated)
    Response.Redirect(FormsAuthentication.LoginUrl); 
```

或通过添加修改 web.config

```
<authorization>
  <deny users="?" />
</authorization> 
```

在第二种情况下，在跟踪时，控制没有到达请求的页面。在到达断点之前，它已被立即重定向到登录 url。因此， SignOut() 方法不是问题，重定向方法是问题。

我希望这可以帮助某人

问候

* * *

## 回答 #11

> 赞同：3
> 
> 时间：2012-01-24T13:07:34.343

我只是在这里尝试了一些建议，虽然我能够使用浏览器后退按钮，但当我单击菜单选择时，该 [ActionResult] 的 [Authorize] 令牌将我立即返回到登录屏幕。

这是我的注销代码：

```
 FormsAuthentication.SignOut();
        Response.Cookies.Remove(FormsAuthentication.FormsCookieName);
        Response.Cache.SetExpires(DateTime.Now.AddSeconds(-1));
        HttpCookie cookie = HttpContext.Request.Cookies[FormsAuthentication.FormsCookieName];
        if (cookie != null)
        {
            cookie.Expires = DateTime.Now.AddDays(-1);
            Response.Cookies.Add(cookie);
        } 
```

尽管浏览器上的后退功能让我返回并显示了安全菜单（我仍在努力），但我无法执行应用程序中的任何安全操作。

希望这可以帮助

* * *

## 回答 #12

> 赞同：3
> 
> 时间：2013-07-10T10:49:35.097

我在这个线程中尝试了大多数答案，没有运气。结束了这个：

```
protected void btnLogout_Click(object sender, EventArgs e)
{
    FormsAuthentication.Initialize();
    var fat = new FormsAuthenticationTicket(1, "", DateTime.Now, DateTime.Now.AddMinutes(-30), false, string.Empty, FormsAuthentication.FormsCookiePath);
    Response.Cookies.Add(new HttpCookie(FormsAuthentication.FormsCookieName, FormsAuthentication.Encrypt(fat)));
    FormsAuthentication.RedirectToLoginPage();
} 
```

在这里找到它：[http ://forums.asp.net/t/1306526.aspx/1](http://forums.asp.net/t/1306526.aspx/1)

* * *

## 回答 #13

> 赞同：2
> 
> 时间：2011-11-30T15:49:36.347

当我设置*authentication > forms > Path 属性*时，这开始发生在我身上`Web.config`。删除它解决了问题，并且`FormsAuthentication.SignOut();`再次简单地删除了 cookie。

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2009-02-20T05:05:21.990

可能是您从一个子域 (sub1.domain.com) 登录，然后尝试从另一个子域 (www.domain.com) 注销。

* * *

## 回答 #15

> 赞同：1
> 
> 时间：2009-08-29T20:26:42.587

我刚刚遇到了同样的问题，SignOut() 似乎无法正确删除票证。但仅在特定情况下，某些其他逻辑导致重定向。在我删除了第二个重定向（用错误消息替换它）后，问题就消失了。

问题一定是页面在错误的时间重定向，因此没有触发身份验证。

* * *

## 回答 #16

> 赞同：1
> 
> 时间：2011-12-09T21:07:05.513

我现在有一个类似的问题，我相信我的问题以及原始海报是因为重定向。默认情况下， Response.Redirect 会导致一个异常立即冒泡，直到它被捕获并立即执行重定向，我猜这会阻止修改后的 cookie 集合被传递给客户端。如果您修改代码以使用：

```
Response.Redirect("url", false); 
```

这可以防止异常，并且似乎允许将 cookie 正确发送回客户端。

* * *

## 回答 #17

> 赞同：1
> 
> 时间：2013-08-23T18:19:35.350

只需在您按下登录时尝试发送会话变量。在欢迎页面上，首先在页面加载或 Init 事件中检查该会话是否为空：

```
if(Session["UserID"] == null || Session["UserID"] == "")
{
    Response.Redirect("Login.aspx");
} 
```

* * *

## 回答 #18

> 赞同：1
> 
> 时间：2015-11-24T14:03:46.363

我想添加一些信息来帮助理解问题。表单身份验证允许将用户数据存储在 cookie 或 URL 的查询字符串中。您的站点支持的方法可以在 web.config 文件中进行配置。

[根据微软](https://msdn.microsoft.com/en-us/library/system.web.security.formsauthentication.signout(v=vs.110).aspx)：

> ***如果 CookiesSupported 为 false*** ，则SignOut 方法会从 cookie 或 URL 中删除表单身份验证票信息。

同时，[他们说](https://msdn.microsoft.com/en-us/library/system.web.security.formsauthentication.cookiemode(v=vs.110).aspx)：

> 指示应用程序是否配置为无 cookie 表单身份验证的 HttpCookieMode 值之一。***默认值为******UseDeviceProfile*** 。

 *最后，关于 UseDeviceProfile，[他们说](https://msdn.microsoft.com/en-us/library/system.web.security.formsauthentication.cookiessupported(v=vs.110).aspx)：

> 如果 CookieMode 属性设置为 UseDeviceProfile， 如果***当前请求的浏览器同时支持 cookie 和使用 cookie 进行重定向，则******CookiesSupported 属性将返回 true*** ；否则，CookiesSupported 属性将返回 false。

 *综上所述，根据用户的浏览器，默认配置可能会导致 CookiesSupported 为**true**，这意味着 SignOut 方法不会从 cookie 中清除票证。这似乎违反直觉，我不知道它为什么会这样工作——我希望 SignOut 在任何情况下都能真正让用户退出。

让 SignOut 自行工作的一种方法是在 web.config 文件中将 cookie 模式更改为“UseCookies”（即需要 cookie）：

```
<authentication mode="Forms">
  <forms loginUrl="~/Account/SignIn" cookieless="UseCookies"/>
</authentication> 
```

根据我的测试，这样做会使 SignOut 自行工作，但您的网站现在需要 cookie 才能正常运行。

* * *

## 回答 #19

> 赞同：1
> 
> 时间：2016-07-12T12:08:12.220

对我来说，以下方法有效。我认为如果在“FormsAuthentication.SignOut()”语句之后有任何错误，SingOut 不起作用。

```
public ActionResult SignOut()
    {
        if (Request.IsAuthenticated)
        {
            FormsAuthentication.SignOut();

            return Redirect("~/");
        }
        return View();
     } 
```

* * *

## 回答 #20

> 赞同：0
> 
> 时间：2009-01-05T05:40:40.737

您是否正在使用 IE 测试/查看此行为？IE 可能正在从缓存中提供这些页面。众所周知，让 IE 刷新它的缓存非常困难，因此在很多情况下，即使在您注销后，键入“安全”页面之一的 url 也会显示之前的缓存内容。

（即使您以其他用户身份登录，我也看到过这种行为，并且 IE 在您的页面顶部显示“欢迎”栏，并带有旧用户的用户名。现在，通常重新加载会更新它，但如果它是持久的，它仍然可能是一个缓存问题。）

* * *

## 回答 #21

> 赞同：0
> 
> 时间：2011-06-24T13:52:55.010

执行 Session.abandon() 并销毁 cookie 效果很好。我正在使用 mvc3，如果您转到受保护的页面、注销并通过浏览器历史记录，似乎会出现问题。没什么大不了的，但还是有点烦人。

尝试通过我的网络应用程序上的链接以正确的方式工作。

将其设置为不进行浏览器缓存可能是可行的方法。

* * *

## 回答 #22

> 赞同：0
> 
> 时间：2015-08-20T15:49:14.093

对于 MVC，这对我有用：

```
 public ActionResult LogOff()
        {
            FormsAuthentication.SignOut();
            return Redirect(FormsAuthentication.GetRedirectUrl(User.Identity.Name, true));
        } 
```

* * *

## 回答 #23

> 赞同：-2
> 
> 时间：2013-05-31T10:32:07.030

请注意，如果来自 STS 的 wsignoutcleanup 消息与来自 IIS 的应用程序名称不匹配，WIF**拒绝告诉浏览器清理 cookie，我的意思是****CASE SENSITIVE**。WIF 以绿色的 OK 检查作为响应，但**不会**向浏览器发送删除 cookie 的命令。

所以，你需要注意你的网址的大小写敏感。

例如，ThinkTecture Identity Server 将访问的 RP 的 url 保存在一个 cookie 中，但它使它们全部小写。WIF 将收到小写的 wsignoutcleanup 消息，并将其与 IIS 中的应用程序名称进行比较。如果不匹配，它不会删除任何 cookie，但会向浏览器报告 OK。因此，对于这个 Identity Server，我需要将 web.config 中的所有 url 和 IIS 中的所有应用程序名称都写成小写，以避免出现此类问题。

如果您有 STS 子域之外的应用程序，也不要忘记在浏览器中允许第三方 cookie，否则即使 WIF 告诉他，浏览器也不会删除 cookie。

# .net - 如何找到 .Net Remoting 分配的端口号？

> ID：412305
> 
> 赞同：3
> 
> 时间：2009-01-05T04:53:54.043
> 
> 标签：.net, remoting, port

如果我使用端口零创建一个 TcpChannel，即允许 .Net Remoting 分配一个可用端口，那么无论如何确定分配了哪个端口号？

我知道我可以在创建通道时指定端口号，但是我不想这样做，因为我想在同一个 Citrix 服务器上运行多个侦听应用程序实例——每个实例侦听不同的端口。

理想情况下，我不想费心保留一堆端口，然后跟踪已分配的端口。我只想让端口自动分配 - 但我需要能够知道已分配的端口号。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-01-05T05:05:07.517

我对此了解不多，但是在 MSDN 上浏览它指出零使用后返回 a `TcpServerChannel`，并且 a`TcpServerChannel`有一个`GetChannelUri()`方法；这包括端口号吗？（您可能需要通过 解析`new Uri(s).Port`）。

再次，完成猜测工作。如果没有，就说;-p

*由 AakashM 编辑添加*这是正确的方法。下列的

```
var channel = new TcpChannel(0); 
```

可以使用以下命令检索包含的服务器通道的动态分配的帖子

```
var channelData = (ChannelDataStore)channel.ChannelData;
var port = new System.Uri(channelData.ChannelUris[0]).Port; 
```

丑陋的演员表是必要的，因为该`TcpChannel.ChannelData`属性的类型为`object`...

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-08T21:27:32.213

我的解决方案如下：

*   使用以下代码为客户端应用程序的每个实例识别未使用的端口：

    ```
    IPEndPoint endPoint = new IPEndPoint(IPAddress.Any, 0);

    using (Socket socket = new Socket(
                 AddressFamily.InterNetwork, 
                 SocketType.Stream, 
                 ProtocolType.Tcp))
    {
        socket.Bind(endPoint);
        IPEndPoint local = (IPEndPoint)socket.LocalEndPoint;
        return local.Port;
    } 
    ```

*   将未使用的端口号存储在客户端应用程序中。

*   通过命令行参数将存储的端口号传递给主机应用程序，以便在设置 TcpChannel 和调用 Activator.GetObject 时使用。

*   在传递给 Activator.GetObject 的 URL 中使用客户端应用程序中存储的端口号。

# deployment - ASDF 或其他独立于家庭和站点配置的模块系统

> ID：412314
> 
> 赞同：3
> 
> 时间：2009-01-05T05:01:24.530
> 
> 标签：deployment, lisp, asdf

我正在尝试找出实际应用程序开发的最佳实践。我无法理解如何正确配置第三方库以部署为独立包。似乎 ASDF-INSTALL 和 ASDF 旨在将库安装到家庭或站点，从而改变开发平台的状态。如果我正在开发一个服务器端应用程序并且我想为盒子上的整个 CL 安装管理这些依赖关系，那很好。

但是，如果我想创建一个独立的应用程序，通过安装脚本进行部署，并在它自己的 CL 实例中单独运行呢？我希望避免更改任何其他应用程序的 CL 实例或目标系统配置（即覆盖其他应用程序所依赖的库的其他副本）。在 Java 中，我所要做的就是创建一个包含这些库的包含目录并设置我的 CLASSPATH。假设我没有安装自己的 CL 运行时，而是使用系统上的东西，我如何在 CL 中获得相同级别的隔离？

我突然想到这是所有动态编译/解释语言的常见问题，因为运行时的生命周期将比运行时运行的任何特定应用程序（即 Ruby 或 Python）长，并且应用程序将共享相同的库加载状态. 我对这种语言没有任何经验，所以最好的做法可能是盯着我的脸。

IDK 如果这将是特定于实现的，但我正在运行 Clozure CL。

编辑：

拉马伦：

我去看看泥球。谢谢你。

安装库与我想要的相反，因为安装意味着修改主机系统状态。我认为关键必须在你的最后一段。您如何创建启动脚本以将*中央注册表*设置为隔离目录？是否可以使用 ASDF-INSTALL 将内容提取到所述目录中？如果您的 CL 实现的基本映像不包含 ASDF（Clozure 默认具有 ASDF，但 CLISP 将如何做），您如何引导整个事情？

我也在考虑开发团队。在我创建一个新的 CL 项目存根并对 CVS 或 SVN 进行初始提交后，其他开发人员如何将其签出到他们的本地环境并使用它？即使假设每个人的个人资料/网站启动中都有 ASDF，其他开发人员也可能在他们的*central-registry*中有一组不同的库。我们不应该仅仅为了一起工作而同步。必须有一种干净的方式来从 Emacs/SLIME 启动项目特定的 CL 运行时实例，并准确地加载项目中指定的内容，不多也不少。

如果在线上有任何最佳实践资源，使用 CL 或任何其他语言，我将很高兴推出自己的解决方案并将其开源。

路易斯：

SAVE-APPLICATION 适用于部署，但不适用于我概述的多开发项目存根。

编辑2：

面包车：

版本依赖性正是这个问题的原因。如果我正在开发 Perl 或 Ruby Web 应用程序，那么我可以依靠 Web 管理员的存在来管理这些依赖项。为 Lisp 是外来技术的零售或中小型企业开发应用程序（我无法说服他们“提高”他们的 IT 组织来管理它），这种方法是不可接受的。

昨晚我能够通过创建一个项目级 .lisp 文件来获得我想要的东西，该文件加载它自己的项目特定的 ASDF 实例，设置一个项目本地*中央注册表*，并手动下载依赖库（没有 ASDF-INSTALL ，这对于 CLSQL 和 Weblocks 来说是痛苦的级联依赖）。从开发工具的角度来看，它仍然不理想，因为我不得不从我的家和网站上删除所有对 SLIME 和 Clozure 本身的自定义。此外，共享依赖项也没有解决（CLSQL 和 Weblocks 都使用 MD5）。

Java 具有类加载器隔离，这就是它解决版本依赖问题的方式。然后是如何将所需的库放入项目中的单独问题（a la Maven）。前者是核心语言问题；后者与工具有关。我将编写一个 SLIME 扩展，它执行 ASDF-INSTALL 对项目包含目录（a la Maven）所做的工作，并修改 lib 源代码以拦截 defpackage 调用，以某种方式预先添加一个 gensym 字符串以强制隔离。我知道，这种方法有很多漏洞，而且我对封装规范的了解还不够，不知道我能把它埋到多深。

我对 Python 一无所知，但我知道存在零售级应用程序；我一直在使用 MusicBrainz Picard。我将研究 Python 是如何做到的。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-06T12:52:58.040

一般来说，我会说作为 3rd-party 库安装的任何东西都应该修改主机系统状态（因为它是）。本地开发的东西可以通过多种方法处理，我使用的是自己的符号链接农场（在需要时使用附带的 shellscript 来重建农场）。Lisp 项目被检出到它们自己的目录中。相互依赖的项目同样以这种方式检查，在它们的 ASDF 系统定义中相互引用，并通过符号链接农场获取。

我在这个模型中看到的一个可能的问题是，如果你突然发现你的支持库的一部分依赖于库 BLAHONGA，在 2008 年 12 月 1 日之前签出 CVS，而你的支持库的其他部分也依赖于 BLAHONGA，但需要从 2008 年 12 月 29 日起，该功能仅在 CVS 中可用。我猜版本依赖也可能是一种可能性。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-05T17:31:49.053

你想要[CCL:SAVE-APPLICATION](http://ccl.clozure.com/manual/chapter4.7.html)。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-09T04:18:47.593

对于您的开发环境，您始终可以在某处签入外部库，并让每个开发人员将其签入`asdf:*central-registry*`.

另一种选择是拥有一个单独的开发盒，并让每个开发人员在那里运行 Lisp + Swank。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-05T14:04:09.347

首先，ASDF 与安装库无关。它只是一个按照它们之间的依赖关系定义的顺序编译和加载一组文件的工具。ASDF-INSTALL 安装东西，它使用 ASDF 来确定依赖关系（我认为），但是还有其他安装机制，比如[clbuild](http://common-lisp.net/project/clbuild/)，手动提取和符号链接，或者最近开发[的 Mudballs](http://mudballs.com/)，它也取代了 ASDF。

特殊变量`asdf:*central-registry*`保存搜索 asdf 系统的目录列表。它通常包含一个带有指向实际系统定义文件的符号链接的目录的补丁，但这不是必需的，因为它可以只包含带有系统定义文件的每个目录。

此变量大部分时间将由具有系统/站点库注册表的启动脚本填充，但您可以将其更改为您喜欢的任何内容，包括隔离的本地目录。关于上一段之前的一段，请注意在同一个 CL 运行时上运行多个应用程序并不是特别常见。通常会启动一些默认的裸核，然后加载并运行库和应用程序，然后在完成后关闭。

编辑：

ASDF 只是一个库，它的变量就像任何其他 lisp 变量一样。在您描述的情况下，您可能希望抑制系统/用户启动脚本，这是特定于实现的（在 CCL 中，它显然是 -n 或 --no-init 命令行参数），然后手动加载 asdf.lisp, `(setf asdf:*central-registry* (list #p"pathtoprojectcentralregistry"))`. 或者可能创建一个函数来递归扫描项目目录并将所有带有 .asd 文件的子目录推送到那里。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2011-09-07T18:59:53.677

我以前遇到过这样的问题。我通常解决它的方式如下：

1.  *将整个系统*的结构，包括所需的库，放入一个修订控制系统。（像 svn externals 和 git 等价的技术可以帮助解决这个问题）
2.  在您的 cl 初始化文件中进行适当配置`asdf:*central-registry*`，以指向工作副本中包含`.asd`文件的目录。

*实际上，因为我同时处理多个项目，所以我通常使用上述多个*配置填充我的 cl init 文件。例如，

```
(defun project1 ()
  (push "/home/rpg/project1/src/" asdf:*central-registry*)
  (push "/home/rpg/project1/extlib/" asdf:*central-registry*)) 
```

然后，当我启动我的开发环境时，我可以简单地键入`(project1)`，ASDF 将被配置好让我在项目 1 上下文中工作。

一种变体是为每个项目制作一个加载文件，并将其检入源库的根目录中。此加载文件将配置 ASDF 的中央注册表并加载系统。中央注册表的配置可以独立于工作副本的放置，通过使用`*load-truename*`.

另一种变体是自动搜索工作目录树以查找包含`.asd`文件的所有目录，并相应地填充您的目录`asdf:*central-registry*`。

# design-patterns - 这是装饰器模式吗？

> ID：412319
> 
> 赞同：3
> 
> 时间：2009-01-05T05:04:23.710
> 
> 标签：design-patterns

我正在使用内置系统类在 .NET 中发送电子邮件。它在 System.Mail 命名空间或类似的东西中。

我需要为这个类添加一个接口，以便我可以将其换出以进行测试或其他实现。

为此，我只需定义一个包装这个内置类的类？

这是装饰器模式的一个例子吗？我只是有点困惑，因为装饰器模式的描述通常表明它是用来添加功能的，我不会添加任何东西。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-05T05:12:29.280

嗯，这听起来就像封装（包装类）和抽象（接口）。

但是，一旦*有了*接口，就可以*使用*装饰器模式。

严格来说，在装饰器的使用中，每一层都有**相同**的接口；装饰本质上是不同具体类的菊花链（在实现接口时），它们要么将方法传递给链中的*下一个*链接，要么做一些定制的事情。

（**更新**：我不是说你*应该*这样做——这只是装饰器模式如何工作的一个例子，在原始电子邮件问题的上下文中）

例如，您可能有一个 interface `IEmail`、一个基本实现`BasicEmail`（使用内置的 .NET 代码）、一个`LoggingEmail`接受 an`IEmail`并只是传递事物（但在执行过程中记录事物）以及一个`ForwardingEmail`接受 an`IEmail`并进行更改的 a等（可能用于`To`开发/测试/实时目的）。

然后你可以有：

```
`ForwardingEmail` => `LoggingEmail` => `BasicEmail` => (regular .NET classes) 
```

（其中前三个仅称为`IEmail`）

这允许您在不更改 API 的情况下扩展功能。在工厂/IoC 设置中非常常见，在 AOP 中更是如此。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-05T05:08:48.383

不，这不是装饰器模式，它是代理模式，注意：我认为微软希望你让你的测试类继承自 SmtpClient 类，并自己实现 Send、AsynchSend 等（以他们只是写的方式一个文本文件或其他任何东西——如果你想插入一个测试版本）。但是，如果您想以*正确*的方式而不是微软的方式进行操作，请按照 Marc 所说的方式进行。您会在 .NET 中找到越来越多的接口示例，这些示例在本应存在的情况下却不存在。

# c# - 将 XML 解析列表从控制器传递到 ASP.NET MVC 中的视图

> ID：412331
> 
> 赞同：4
> 
> 时间：2009-01-05T05:17:14.090
> 
> 标签：c#, asp.net-mvc, xml

我正在尝试将 XML 列表传递给视图，但是一旦进入视图就遇到了麻烦。

我的控制器：

```
 public ActionResult Search(int isbdn)
    {
        ViewData["ISBN"] = isbdn;
        string pathToXml= "http://isbndb.com/api/books.xml?access_key=DWD3TC34&index1=isbn&value1=";
        pathToXml += isbdn;
        var doc = XDocument.Load(pathToXml);
        IEnumerable<XElement> items = from m in doc.Elements()
                    select m; 
```

我的观点会是什么样子？我是否需要合并某种类型的 XML 数据控制器？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-05T05:24:03.530

我不知道你是否故意在方法中途切断你的代码。但是您应该能够执行以下操作以将您的元素从控制器操作获取到视图：

```
ViewData["XmlItems"] = items; 
```

然后在你看来你打电话

```
<% foreach(XElement e in ViewData["XmlItems"] as IEnumerable<XElement>) { %>
    <!-- do work here -->
<% } %> 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-05T05:25:02.530

首先..您必须将数据返回到视图模式...

```
public ActionResult Search(int isbdn)
    {
        ViewData["ISBN"] = isbdn;
        string pathToXml= "http://isbndb.com/api/books.xml?access_key=DWD3TC34&index1=isbn&value1=";
        pathToXml += isbdn;
        var doc = XDocument.Load(pathToXml);
        IEnumerable<XElement> items = from m in doc.Elements()
                    select m;
return view(m);
} 
```

在你后面的代码中你必须继承

```
ViewPage < IEnumerable<XElement>> 
```

and than your ViewData.Modal will be a strongly typed `IEnumerable<XElement>`. and you will be able to work with data as in the controller.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-05T05:23:40.007

我猜你错过了一些代码，因为你没有在这段代码的任何时候将项目分配给 ViewData。

当您尝试访问视图中的项目时发生了什么，您可以从视图中添加代码以显示您正在尝试做什么吗？

# mysql - 我应该如何在 MySQL 表中存储 GUID？

> ID：412341
> 
> 赞同：158
> 
> 时间：2009-01-05T05:37:12.663
> 
> 标签：mysql, guid, uuid

我使用 varchar(36) 还是有更好的方法来做到这一点？

* * *

## 回答 #1

> 赞同：115
> 
> 时间：2009-01-05T05:44:13.943

当我询问为我的对象存储 GUID 的最佳方法时，我的 DBA 问我为什么我需要存储 16 个字节，而我可以用一个整数在 4 个字节中做同样的事情。自从他向我提出了这个挑战，我认为现在是提及它的好时机。话虽如此...

如果您想最优化地利用存储空间，您可以将 guid 存储为 CHAR(16) 二进制文件。

* * *

## 回答 #2

> 赞同：53
> 
> 时间：2009-01-05T05:41:27.227

我会将其存储为 char(36)。

* * *

## 回答 #3

> 赞同：33
> 
> 时间：2011-08-23T23:56:28.597

添加到 ThaBadDawg 的答案，使用这些方便的函数（感谢我的一位更聪明的同事）从 36 长度的字符串返回到 16 的字节数组。

```
DELIMITER $$

CREATE FUNCTION `GuidToBinary`(
    $Data VARCHAR(36)
) RETURNS binary(16)
DETERMINISTIC
NO SQL
BEGIN
    DECLARE $Result BINARY(16) DEFAULT NULL;
    IF $Data IS NOT NULL THEN
        SET $Data = REPLACE($Data,'-','');
        SET $Result =
            CONCAT( UNHEX(SUBSTRING($Data,7,2)), UNHEX(SUBSTRING($Data,5,2)),
                    UNHEX(SUBSTRING($Data,3,2)), UNHEX(SUBSTRING($Data,1,2)),
                    UNHEX(SUBSTRING($Data,11,2)),UNHEX(SUBSTRING($Data,9,2)),
                    UNHEX(SUBSTRING($Data,15,2)),UNHEX(SUBSTRING($Data,13,2)),
                    UNHEX(SUBSTRING($Data,17,16)));
    END IF;
    RETURN $Result;
END

$$

CREATE FUNCTION `ToGuid`(
    $Data BINARY(16)
) RETURNS char(36) CHARSET utf8
DETERMINISTIC
NO SQL
BEGIN
    DECLARE $Result CHAR(36) DEFAULT NULL;
    IF $Data IS NOT NULL THEN
        SET $Result =
            CONCAT(
                HEX(SUBSTRING($Data,4,1)), HEX(SUBSTRING($Data,3,1)),
                HEX(SUBSTRING($Data,2,1)), HEX(SUBSTRING($Data,1,1)), '-', 
                HEX(SUBSTRING($Data,6,1)), HEX(SUBSTRING($Data,5,1)), '-',
                HEX(SUBSTRING($Data,8,1)), HEX(SUBSTRING($Data,7,1)), '-',
                HEX(SUBSTRING($Data,9,2)), '-', HEX(SUBSTRING($Data,11,6)));
    END IF;
    RETURN $Result;
END
$$ 
```

`CHAR(16)`其实是一种`BINARY(16)`，选择你喜欢的口味

为了更好地遵循代码，请以下面给出的数字顺序 GUID 为例。（非法字符用于说明目的 - 每个地方都有一个唯一字符。）这些函数将转换字节顺序以实现高级索引聚类的位顺序。重新排序的 guid 显示在示例下方。

```
12345678-9ABC-DEFG-HIJK-LMNOPQRSTUVW
78563412-BC9A-FGDE-HIJK-LMNOPQRSTUVW 
```

已删除破折号：

```
123456789ABCDEFGHIJKLMNOPQRSTUVW
78563412BC9AFGDEHIJKLMNOPQRSTUVW 
```

* * *

## 回答 #4

> 赞同：28
> 
> 时间：2009-01-05T05:47:58.647

char(36) 将是一个不错的选择。还可以使用 MySQL 的 UUID() 函数，它返回 36 个字符的文本格式（带连字符的十六进制），可用于从 db 中检索此类 ID。

* * *

## 回答 #5

> 赞同：24
> 
> 时间：2014-02-28T16:26:30.760

“更好”取决于您优化的目标。

您有多关心存储大小/性能与开发的难易程度？更重要的是 - 您是否生成了足够多的 GUID，或者是否足够频繁地获取它们，这很重要？

如果答案是“否”，`char(36)`那就足够了，它使存储/获取 GUID 变得非常简单。否则，`binary(16)`这是合理的，但您必须依靠 MySQL 和/或您选择的编程语言来从通常的字符串表示形式来回转换。

* * *

## 回答 #6

> 赞同：8
> 
> 时间：2012-05-31T12:00:16.160

Binary(16) 会很好，比使用 varchar(32) 更好。

* * *

## 回答 #7

> 赞同：7
> 
> 时间：2015-01-08T16:56:31.960

应调整 KCD 发布的 GuidToBinary 例程以考虑 GUID 字符串中时间戳的位布局。如果字符串表示版本 1 UUID，如 uuid() mysql 例程返回的那些，则时间组件嵌入在字母 1-G 中，不包括 D。

```
12345678-9ABC-DEFG-HIJK-LMNOPQRSTUVW
12345678 = least significant 4 bytes of the timestamp in big endian order
9ABC     = middle 2 timestamp bytes in big endian
D        = 1 to signify a version 1 UUID
EFG      = most significant 12 bits of the timestamp in big endian 
```

当您转换为二进制时，索引的最佳顺序是：EFG9ABC12345678D + 其余的。

您不想将 12345678 交换为 78563412，因为大端已经产生了最佳的二进制索引字节顺序。但是，您确实希望将最重要的字节移到较低字节的前面。因此，EFG 先行，然后是中间位和低位。在一分钟内使用 uuid() 生成十几个 UUID，您应该会看到此顺序如何产生正确的排名。

```
select uuid(), 0
union 
select uuid(), sleep(.001)
union 
select uuid(), sleep(.010)
union 
select uuid(), sleep(.100)
union 
select uuid(), sleep(1)
union 
select uuid(), sleep(10)
union
select uuid(), 0;

/* output */
6eec5eb6-9755-11e4-b981-feb7b39d48d6
6eec5f10-9755-11e4-b981-feb7b39d48d6
6eec8ddc-9755-11e4-b981-feb7b39d48d6
6eee30d0-9755-11e4-b981-feb7b39d48d6
6efda038-9755-11e4-b981-feb7b39d48d6
6f9641bf-9755-11e4-b981-feb7b39d48d6
758c3e3e-9755-11e4-b981-feb7b39d48d6 
```

前两个 UUID 的生成时间最接近。它们仅在第一个块的最后 3 个半字节中有所不同。这些是时间戳的最低有效位，这意味着当我们将其转换为可索引字节数组时，我们希望将它们推到右侧。作为一个反例，最后一个 ID 是最新的，但 KCD 的交换算法会将其放在第三个 ID 之前（3e 在 dc 之前，第一个块的最后一个字节）。

索引的正确顺序是：

```
1e497556eec5eb6... 
1e497556eec5f10... 
1e497556eec8ddc... 
1e497556eee30d0... 
1e497556efda038... 
1e497556f9641bf... 
1e49755758c3e3e... 
```

有关支持信息，请参阅本文：http: [//mysql.rjweb.org/doc.php/uuid](http://mysql.rjweb.org/doc.php/uuid)

*** 请注意，我不会将版本半字节与时间戳的高 12 位分开。这是您示例中的 D 半字节。我只是把它扔在前面。所以我的二进制序列最终是 DEFG9ABC 等等。这意味着我所有的索引 UUID 都以相同的半字节开头。文章做同样的事情。

* * *

## 回答 #8

> 赞同：5
> 
> 时间：2015-06-26T14:24:21.047

根据 Percona 的研究，对于那些刚刚遇到这个问题的人来说，现在有一个更好的选择。

它包括重新组织 UUID 块以获得最佳索引，然后转换为二进制以减少存储。

[在此处](https://www.percona.com/blog/2014/12/19/store-uuid-optimized-way/)阅读全文

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2015-12-17T15:22:12.667

我建议使用下面的函数，因为@bigh_29 提到的函数将我的 guid 转换为新的（出于我不明白的原因）。此外，在我在桌子上进行的测试中，这些速度要快一些。[https://gist.github.com/damienb/159151](https://gist.github.com/damienb/159151)

```
DELIMITER |

CREATE FUNCTION uuid_from_bin(b BINARY(16))
RETURNS CHAR(36) DETERMINISTIC
BEGIN
  DECLARE hex CHAR(32);
  SET hex = HEX(b);
  RETURN LOWER(CONCAT(LEFT(hex, 8), '-', MID(hex, 9,4), '-', MID(hex, 13,4), '-', MID(hex, 17,4), '-', RIGHT(hex, 12)));
END
|

CREATE FUNCTION uuid_to_bin(s CHAR(36))
RETURNS BINARY(16) DETERMINISTIC
RETURN UNHEX(CONCAT(LEFT(s, 8), MID(s, 10, 4), MID(s, 15, 4), MID(s, 20, 4), RIGHT(s, 12)))
|

DELIMITER ; 
```

* * *

## 回答 #10

> 赞同：-4
> 
> 时间：2014-11-04T21:13:14.327

如果您有一个格式化为标准 GUID 的 char/varchar 值，则可以使用简单的 CAST(MyString AS BINARY16) 将其简单地存储为 BINARY(16)，而无需使用所有令人难以置信的 CONCAT + SUBSTR 序列。

BINARY(16) 字段的比较/排序/索引比字符串快得多，并且在数据库中占用的空间也少两倍

# c++ - 比从基类转换为派生类更好的方法

> ID：412344
> 
> 赞同：1
> 
> 时间：2009-01-05T05:38:34.687
> 
> 标签：c++, class-design

我知道这样的垂头丧气是行不通的。我需要一种可行的方法。这是我的问题：我有几个不同的派生类都来自一个基类。我的第一次尝试是创建一个基类数组。该程序必须选择（或多或少随机）不同的派生类。我曾尝试从基类转换为派生类，将其放入基类的数组中，但显然这不起作用。我真诚地希望有另一种方法，而不是简单地粘贴所有派生类的数组，因为可能有相当多的派生类。有没有更好的方法来做到这一点，我只是在胡思乱想？

如果你们都需要代码示例或更多信息，请告诉我。这对我来说很有意义，但是已经很晚了，对其他人来说可能没有意义，呵呵。

任何帮助都非常感谢，伙计们。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-01-05T05:47:56.090

不明白你的意思。听起来您按值存储对象，并且您有一个`Base`. 那是行不通的，因为一旦您分配了 Derived，该对象就会被转换为 Base，并且对象的 Derived 部分会被切掉。但我认为你想要一个指向基础的指针数组：

```
Base * bases[NUM_ITEMS];
for(int i=0; i<NUM_ITEMS; i++) {
    int r = get_random_integer();
    if(r == 0)
        bases[i] = new Derived1;
    else if(r == 1)
        bases[i] = new Derived2;
    // ...
} 
```

如果你曾经使用过指针，你就会知道管理它们是一件很痛苦的事情，尤其是传递而不丢失它们，因为你需要对它们调用 delete 以释放内存并调用对象的析构函数。您可以使用 shared_ptr，它会为您管理：

```
shared_ptr<Base> bases[NUM_ITEMS];
for(int i=0; i<NUM_ITEMS; i++) {
    int r = get_random_integer();
    if(r == 0)
        bases[i].reset(new Derived1);
    else if(r == 1)
        bases[i].reset(new Derived2);
    // ...
} 
```

现在，您可以传递`bases[x]`给另一个 shared_ptr，它会注意到您有多个引用 - 如果对对象的最后一个引用超出范围，它将自动调用 delete。理想情况下，您还可以用 std::vector 替换原始数组：

```
std::vector< shared_ptr<Base> > bases;
for(int i=0; i<NUM_ITEMS; i++) {
    int r = get_random_integer();
    if(r == 0)
        bases.push_back(shared_ptr<Base>(new Derived1));
    else if(r == 1)
        bases.push_back(shared_ptr<Base>(new Derived2));
    // ...
} 
```

然后您可以传递向量，并且不会丢失它的大小，并且您可以根据需要动态添加项目。使用 获取向量的大小`bases.size()`。`shared_ptr` [在这里](http://www.boost.org/doc/libs/1_37_0/libs/smart_ptr/shared_ptr.htm)阅读。

从基类到派生类的转换*只应在绝对必要时进行*。通常，您想使用一种称为 的技术`polymorphism`，这意味着您在基指针上调用一个函数，但它实际上会调用一个在派生类中定义的函数，具有相同的签名（名称和参数是相同的类型）并且据说给`override`它。阅读维基百科上关于它的[文章。](http://en.wikipedia.org/wiki/Polymorphism_in_object-oriented_programming)如果你真的需要强制转换，你可以对原始指针这样做：

```
Derived1 * d = &dynamic_cast<Derived1&>(*bases[x]); 
```

使用 dynamic_cast 可确保当您转换为错误的类型（即，您转换的类型不是创建并分配给基指针的类型）时，您会得到运算符抛出的异常。对于 shared_ptr 情况，也有一些方法：

```
shared_ptr<Derived1> d = dynamic_pointer_cast<Derived1>(bases[x]);
if(d) {
    // conversion successful, it pointed to a derived. d and bases[x] point still 
    // to the same object, thus share it. 
} 
```

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2009-01-05T05:44:29.200

在大多数情况下，从基类转换为派生类是一种不好的代码气味。

**多态性**，通过使用虚方法，是一种更好的方法。

调用代码应使用基类指针调用方法，允许将其分派到派生类中的适当实现。

我知道这是一个相当通用的答案，但是如果没有一些代码片段作为示例，很难在您的情况下推荐更具体的答案。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-05T05:42:27.380

使用 的数组`BaseClass*`，而不是 的数组`BaseClass`。（或者选择一个智能指针库来为你管理内存。）

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-05T05:50:30.967

我认为需要更多信息。你为什么垂头丧气？你对每个派生类都做同样的事情吗？如果是这样，您应该使用接口，或将代码放在基类中（或两者兼而有之）。

例如，如果您有一组形状（基础），并且想要计算它们的面积，您可以执行以下操作：

```
 interface IShape
    {
       double GetArea();
    }

    class Square : IShape
    {
       double GetArea()
       {
          return sideLengh*sideLength;
       }
       ...
    }

    class FunnyShape : IShape
    {
       //do funny stuff
       ...
    } 

    ...

void calcTotalArea(List<IShape> shapes)
{
   double total = 0.0;
   foreach (IShape s in shapes)
   {
      total += s.GetArea();
   }
   return total;
} 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-01-05T15:52:33.450

我仍然不知道你想做什么。一般来说，您不能向下转换对象，而是指向对象的指针。执行此操作的常用方法类似于 dynamic_cast(foo)，其中 foo 的类型为 bankAccount *。这将为您提供指向 MoneyMarket 对象的指针或空指针。

但是，向下转换以对对象进行操作通常是错误的。这通常通过虚拟继承和多态性更好地完成。这是一种将对象分类为不同类型的方法。

如果你想知道利息是多少，在bankAccount中将利息定义为一个虚函数，不支付利息的账户类型可以只返回零。如果你想知道哪些账户类型是 MoneyMarket，向下转换可能是要走的路。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-05T15:05:37.383

好吧，我很抱歉，我本可以发布一些代码和更多关于我想要的最终结果的信息。

这是我的例子：

```
class bankAccount
{
   int money;
   bankAccount() {};

   int MoneyInAccount() {return money;};
}

class savingsAccount : public bankAccount
{
   int SavingsInterest();
}

class MoneyMarket : public bankAccount
{
    int CalculateAllPastReturns();
} 
```

然后在我的程序中，我有一个 bankAccount[40] 数组（它不是指针）。我希望能够将 BankAccount 转换为 SavingsAccount 或 MoneyMarket 或 CheckingAccount 等。每个都有自己独特的类。从那里，该程序可以收集不同的银行账户及其独特信息。

当然，我知道尝试那样投射是不好的，但我不知道该怎么做。

我希望我只是公然遗漏了指针等的东西。无论如何，我希望这更具体一点。非常感谢您的帮助！

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-01-05T15:27:08.027

如果您有一个 bankAccount[40] 对象数组，那么您永远不会使用派生类。

转换为派生类是非常 Java 风格的，因为你有 instanceof 运算符，这一切都非常自然。在 C++ 中，您可以使用 reinterpret_cast() 来模拟它，但它被认为是不好的风格。

你一开始想做什么？把所有东西都扔到一个容器里？

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-01-05T15:46:10.233

这里的问题是您将真实的 BankAccount 对象存储在数组中，而不是 SavingsAccount 或 MoneyMarket 对象。你会发现在这些情况下向上投射是行不通的。显然，您可以尝试使用 reinterpret_cast，但它很可能会中断。（想象如果 SavingAccount 有一个额外的成员变量——利率——这将使它比基类大几个字节）

您应该做的是存储指向 BankAccount 对象的指针，然后这些指针可以是您喜欢的任何派生类 - 您分配一个 SavingAccount，并将指向它的指针放入您的数组中。这很好用，编译器很高兴地跟踪对象类型，并且您已经分配了这些派生类型之一所需的所有内存。

现在，一旦您正确构建了储蓄或货币市场账户并将其存储在某个地方，并在数组中引用了它们，您就可以使用 dynamic_cast 将数组中保存的指针转换为真实类型 - 如果您尝试转换其中一个指针到错误类型的对象，你会得到一个异常。（显然，您不想存储一个 SavingAccount 对象，然后像访问 moneyMarket 对象一样访问它！），如果类型正确，您将只获得指向该对象的有效指针。您需要打开 RTTI 才能使其工作（即编译器将跟踪每个对象的类型）。

除了使用良好的旧 C 风格联合之外，实现您想要的另一种方法是将您将访问的所有方法放入基类中，并直接在您存储在数组中的基指针上调用它们。

在输入所有内容之后 - litb 说的几乎相同，只是比我的要好得多 - 给他打勾！

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-01-05T16:00:50.313

试图向上/向下转换继承链通常是完全错误的。如果您这样做，那么您很可能没有正确使用继承和多态性。如果你发现你需要向上或向下转型，那么很有可能你的职业设计有缺陷。

正如其他答案所提到的，解决这类事情的方法是在基类中定义所有需要的方法。如果派生类不支持该方法，则让它成为空操作或让它返回错误。

# flash - 动作脚本的皮棉工具？

> ID：412345
> 
> 赞同：16
> 
> 时间：2009-01-05T05:39:02.177
> 
> 标签：flash, actionscript-3, actionscript, code-analysis, lint

是否有可用于 actionscript 的 lint 工具？一个来源是理想的，但任何东西都是受欢迎的。

我的团队开始采用更严格的样式指南（其中“更严格”意味着“存在”），我认为 linter 将帮助我们所有人更容易地遵守我们已经同意的样式规则。我不会写我自己的，但我想先看看还有什么。

在 Google 上快速搜索一无所获（至少到目前为止）。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-11-10T21:38:44.363

如果您正在处理 Flex，请查看[FlexPMD](http://opensource.adobe.com/wiki/display/flexpmd/FlexPMD)。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-11-19T07:40:53.897

FlexPMD 实际上应该被命名为 As3PMD。我的意思是您可以针对纯 AS3 项目运行 FlexPMD，而不必针对 Flex 项目。

也就是说，大约有 10 条针对 Flex 的规则。

泽维尔

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-01T14:32:19.393

不完全是 Lint，尽管 Adob​​e 的 Flex`mxmlc`编译器针对混乱的 ActionScript 提供了大量有用的严格警告，例如未声明的变量、缺少函数返回类型以及对象/哈希中的额外逗号。

`mxmlc`资源：

*   [http://livedocs.adobe.com/flex/3/html/help.html?content=compilers_15.html#153435](http://livedocs.adobe.com/flex/3/html/help.html?content=compilers_15.html#153435)
*   [http://www.senocular.com/flash/tutorials/as3withmxmlc/](http://www.senocular.com/flash/tutorials/as3withmxmlc/)

一些相关的代码分析工具是[Yasca](http://www.yasca.org/)（用于 JavaScript、Java、PHP 等的分析工具）和[asDox](http://code.google.com/p/asdox/)（用 Python 编写的 AS3 解析器），这可能是您自己编写的不错的开始。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-03-31T06:28:39.063

这不是 Lint，但我发现免费的 FlashDevelop 可以让我编写更好的代码，因为它抱怨许多可能的问题，例如未声明的变量。

[http://www.flashdevelop.org](http://www.flashdevelop.org)

你可以检查一下。

然后还有可以用来编写 AS 的 flex builder。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-02T20:42:56.883

我过去曾将[jslint](http://www.jslint.com/lint.html)用于 jscript。由于是用 JavaScript 编写的，并且可以使用完整的源代码，因此您应该能够使用 actionscript 使其工作。我没有使用答案中提到的任何其他工具，所以我不知道它们如何比较。

（jslint 对什么是好的 jscript 有非常强烈的看法，你可能同意也可能不同意。）

* * *

## 回答 #6

> 赞同：-2
> 
> 时间：2009-01-05T05:51:24.367

Actionscript 2.0 和 3.0 是符合 ECMA 的脚本语言。由于 ECMA 脚本本质上是 Javascript，因此您通常可以使用[JSure](http://aurochs.fr/jsure.html)（似乎仅适用于 Linux）或[Javascript Lint](http://www.javascriptlint.com/)之类的东西。

# unix - 您最常使用的 linux（电源）命令是什么？

> ID：412362
> 
> 赞同：2
> 
> 时间：2009-01-05T05:50:51.230
> 
> 标签：unix, shell, command-line

要查找包含特定字符串的文件，我经常使用它

寻找 。-名称 * | xargs grep -iH "字符串"

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-05T06:27:18.490

我的是

```
awk - 用于过滤和提取字段
find - 用于查找文件/目录
xargs - 构建命令列表，我经常将它与 find 一起使用
less - 用于快速浏览/阅读文件
man/info - 用于查看手册页和信息页
emacs - 用于编辑源代码
irssi - 与其他开发人员取得联系
cd - 切换到主目录和其他目录
killall - 杀死不行为的命令（是的，你得到了力量！）
ps - 列出进程（哦不，我讨厌挂 mplayers 阻塞我的声音！）
<CTRL>+<R> - 通过在历史文件中搜索来完成命令
<TAB> - 用于完成目录和文件名

```

最后但并非最不重要的一点是，最常用的*power*命令是`shutdown`，不是吗？:)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-05T06:21:53.650

要查找哪些目录占用最多空间（用于潜在的清理），请从所需的级别开始，例如`/home`并执行：

```
cd /home
du -s * | sort -k1 -n 
```

这会根据使用的空间给出一个排序（最常用在底部，因此如果滚动，您仍然可以看到主要违规者）列表，例如：

```
 16  lost+found
     84  daniel
   4284  george
   6308  alice
4413700  bob 
```

然后，您可以从内部运行相同的命令`/home/bob`：

```
cd /home/bob
du -s * | sort -k1 -n 
```

要得到：

```
 100  src
4413600  p0rn 
```

因此，您现在知道是什么占用了文件系统上的大部分空间`/home`，并且 Bob 很快就会寻找其他工作:-)。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-05T06:01:57.527

我的主要命令：

*   **vi**（我选择的编辑器几乎可以完成所有配置任务）
*   **top**（列出正在运行的任务，并显示性能统计信息）
*   **tar/gzip**（压缩/解压缩档案）
*   **grep**（使用正则表达式查找文件中的文本）
*   **man**（命令手册参考）
*   **kill**（杀死正在运行的进程）
*   **chmod**（更改和管理权限）

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-01-05T06:12:06.133

我经常使用 find 的 -exec 选项。例如，我经常想更改整个目录树的权限，赋予目录执行权限，而不是文件。我分两步执行此操作：

```
find root_dir -type d -exec chmod 555 {} \;
find root_dir -type f -exec chmod 444 {} \; 
```

以上将使整个树对每个人都是只读的，但仍然允许任何人 cd 进入任何目录。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-01-05T07:55:38.763

我在命令行中使用最多的是`grep`各种`zsh`好东西，例如

```
# count number of lines in all .java and .py files
wc -l **/*.{java,py} 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-01-05T06:04:40.907

```
#!/bin/sh
ps axxw | grep $1 | grep -v grep | grep -v boost 
sudo renice -20 `ps axww | grep $1 | grep -v grep | grep -v boost | awk '{print $1}'` 
```

调用脚本`boost`，我使用它为命名应用程序提供最高优先级。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-01-05T06:07:52.443

不完全是常规命令，而是用于自动完成 bash 命令的快捷方式“Ctrl + r”。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-01-05T07:33:26.140

原始问题中的命令可以更好地写为，

```
grep -RHi "string" 
```

我经常使用 grep -R 。当然，find 命令可用于微调要搜索的文件。

我经常使用 -00 标志来 perl 打印“段落”模式。

```
perl -wnl -00 -e '/something:/ and print;' 
```

将字符串更改为其他内容，内联，同时制作原始文件的备份副本（来自 Minimal Perl）：

```
perl -s -i.bak -wpl 's/old_string/new_string/g;' *.txt 
```

我喜欢并排的差异：

```
sdiff -s file1 file2 
```

或语法突出显示的差异：

```
diff file1 file2 | vim - # or mate - on my Mac 
```

我浏览了我的历史，看看是否还有其他命令，但遗憾的是（？？）我的大部分系统维护、管理和编程都是通过自动化工具完成的，最近都是用 Ruby 编写的（puppet、capistrano、一些 home-滚动工具等），或与 SCM（git、svn）相关。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-01-06T01:33:05.137

我在 linux 中最喜欢的命令是：

```
ps -ax
kill [n] 
```

也鲜为人知（和危险）不要在家里尝试这个孩子：

```
hack [targetPC]
nuke [targetPC]
sol    <--this is solitaire
/.     <--opens up slash dot in IE
quote  <--quotes a /. meme from the following list so you can use it to post on /.
       1 Yes but does it run linux?
       2 Can you imagine a Beowulf cluster of those
       3 In Soviet Russia ...
       4 ...
       5 Profit. 
```

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-01-06T01:44:01.650

查找进程是否正在运行并在树视图中获取 pid：

```
ps afx | grep 'foo' 
```

递归查找文件目录中的字符串：

```
grep -r 'foo' * 
```

递归地使目录中的所有文件可执行：

```
chmod -R +x * 
```

擦除文件但保留其存在和权限：

```
cat /dev/null > file 
```

纯娱乐：

```
rm -rf / 
```

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-01-05T06:26:54.247

我`who -T | sort`用来获取登录用户的排序列表。此外，为了获得组的排序列表（而不是正常的未排序列表），我使用`groups | tr ' ' '\n' | sort | tr '\n' ' ' && echo`.

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2009-01-05T06:03:15.200

我经常发现自己需要找到一个包含特定字符串的文件。为此，我使用：

```
grep -ri 'string' 
```

我需要定期做的事情范围很广，以至于很难挑选出特定的命令。主要是 sed、awk、grep 和 find 的许多组合，其中一些是随机的，直到被投入处理。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2009-01-15T11:42:55.203

我最常用的命令是 ps、lsof（列出打开的文件）、grep / awk / sed / cut（和其他各种行编辑器）以及 netstat。

Lsof 是最有用但经常被遗忘的一种。例如：

```
# umount /foo
umount: /foo busy

lsof | grep /foo

1339 /bin/bash ... ... ... cwd ... ... ... 
```

好的，所以现在我知道 /foo 很忙，因为有人打开了一个 shell 并坐在 /foo :) 这真的只是冰山一角。知道任何给定进程打开了什么 fds 也很方便。

很多人*一直*使用 find ，当 slocate 可能更好时，所以不要忘记 slocate :) 如果你发现自己（请原谅双关语）这样做：

```
find / -name foo.txt 
```

...你最好先使用 slocate 。

最后，valrgind 通常与编程工具相关联……但它对于检测其他程序中的泄漏和其他不稳定行为非常有用。例如，如果您通过某种疯狂的方式设法使 sed 段错误...... valgrind 很适合偷看。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2009-01-15T10:30:06.850

两个强大的命令：
**wget**：下载文件
**curl**：操作 http 标头

顺便说一句，您的 find 和 grep 组合不安全，如果文件名包含空格怎么办？安全的方法是这样做：

```
find . -name * -print0  | xargs -0 grep -iH "String" 
```

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2009-01-15T10:51:02.733

# [#关机](http://linux.about.com/library/cmd/blcmdl8_poweroff.htm)

你在谈论权力命令，对吧？;-P

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2009-01-15T11:28:10.757

我发现

```
sed -i "regexp" $file 
```

sed 在文件上非常有用，但不需要将输出放在某个地方然后将其移动到源的顶部。

```
grep --color -Rne "regexp" file list 
```

执行递归 grep 并突出显示找到的匹配项也很方便。实际上，我编写了一个名为 'svngrep' 的小 shell 函数来跳过我们工作副本中的 .svn 文件，只查看活动代码并提供高亮显示。Git 和其他人也可以这样做。

我有一个 .bashrc 包含以下内容：

```
alias ls="/bin/ls --color"
alias ll="ls -l" 
```

pgrep 和 pkill 总是派上用场。awk 是你的朋友。学习它的语法，因为它可以做很多很棒的事情并为您节省很多时间。

```
du -shc * 
```

将为您列出您列出的所有文件的大小细分，并显示总数。如果当前目录很大并且它下面的内容可能很大，这对于快速计算非常有用。

```
vim 
```

不言自明。

```
screen
screen -DR 
```

屏幕是 Unix 之神的产物。如果您曾经在机器上使用 SSH 工作，请考虑使用 Screen。它为您提供了一个持久会话，能够创建多个“选项卡”并分离，在您注销后让屏幕继续运行。您可以稍后返回并使用“screen -r”重新连接。如果您的远程会话由于网络问题而启动，您可以重新登录并使用分离-重新连接方法来恢复您的工作，而不会丢失最后一个耗时半小时且您尚未保存的关键编辑。屏幕无数次地拯救了我的屁股。

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2009-01-05T08:10:40.513

我觉得`nohup`非常方便，对于通过不可靠的连接或花费大量时间完成的事情，即`nohup python build_big_db_on_this_remote_server.py`

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2011-03-07T22:32:48.707

对于我的 grep-ing，我为这个迷你脚本定义了一个别名。

它执行 grep，使用行号递归，忽略二进制文件和大小写。它使用 -v 从我一直存在的 .svn 目录中过滤掉结果。然后，它会在结果中为搜索到的关键字着色。

```
egrep -rniI --color "$1" * | egrep -v "\.svn" | egrep --color -iE "$1|"\044 
```

* * *

## 回答 #19

> 赞同：0
> 
> 时间：2009-01-06T01:11:30.623

我喜欢的 dos2unix perl 一个衬里：

```
perl -pi -e 's!\r\n!\n!g' << filename >> 
```

通过颠倒替换顺序，可以很容易地在 unix2dos 中转换。

# c++ - 读取键盘字符以确定快捷键

> ID：412366
> 
> 赞同：0
> 
> 时间：2009-01-05T05:54:49.960
> 
> 标签：c++, text, keyboard-shortcuts, keyboard-events

我正在开发一个文档应用程序和该应用程序的一部分，如果该键盘条目与预定义的短格式/单词匹配，我必须添加支持以读取键盘按下事件并替换预定义的字符集。实际应用程序已用 C++ 实现。

请向我提供您对如何实现这一点的想法。是否有任何示例 C++ 程序可供参考？算法/概念？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-08T00:52:43.187

了解如何使用 wxWidgets api 捕获 keydown 事件，也许在这里： [http](http://docs.wxwidgets.org/stable/wx_eventhandlingoverview.html#eventhandlingoverview) ://docs.wxwidgets.org/stable/wx_eventhandlingoverview.html#eventhandlingoverview 注意[关键事件](http://docs.wxwidgets.org/stable/wx_wxkeyevent.html#wxkeyevent)。在 C++ 中实现一个开关以查看按下了哪个组合键，并相应地将文本设置为编辑。我在这里考虑的是将 CTRL-SHIFT-A 按键转换为编辑框中的 Ctrl-Shift-a 之类的文本。

如果您正在考虑将字符组合转换为其他字符，例如汉字或平假名，则该算法可能会更长并且需要更多的数据结构。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-05T09:26:12.670

标准 C++ 不支持按键事件，因此您必须查看操作系统函数或框架函数。wxWidgets 或 Qt 等便携式 C++ 框架支持 Windows、Mac 和 Linux 上的按键事件。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-28T00:40:03.317

如果您在 Windows 下，您可以使用 GetAsyncKeystate API 调用并观察更改，或者使用低级键盘挂钩（稍微复杂一些）（CreateHookEx + 相关函数）。

在 DOS（或可能是 Linux）下，您可以在控制台模式下使用 conio.h 中的 _kbhit，我通常将其放入循环中（while(!_kbhit());) 用于“按任意键继续”，但使用 _getch 可以检索被按下的键

# python - 如何（简单地）将 Python 连接到我的网站？

> ID：412368
> 
> 赞同：4
> 
> 时间：2009-01-05T05:57:25.617
> 
> 标签：python, web

我一直在使用 Python 并编写了一个小程序来创建一个数据库来跟踪一些信息（它非常基本，并且是手写的）。我想添加从数据创建网站的功能，然后将其传递到我在互联网上的特殊小地方。我应该用什么来建立网站？在涉足 Django 之后，我发现它有点矫枉过正，而且超出了我的想象，但如果这是唯一的选择，我将学会使用它。

有谁知道将任意格式的数据库输出到一个或多个 HTML（或不同格式）文件的简单方法？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-01-05T06:00:41.897

[我会使用模板引擎（ Jinja](http://jinja.pocoo.org/2/)是我个人的选择）生成一两个 HTML 页面，然后将它们粘贴到您的`public_html`目录或网络服务器的根目录中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-06T08:08:27.660

生成静态 HTML 很棒，如果这对你有用的话。

如果您想要一个动态网站并具有更新的能力，[web.py](http://webpy.org/)可能适合您。比 Django 更简单且独立（尽管我在 web.py 中开始的几乎所有内容最终都被重写为 Django 应用程序......）

# c# - 人们如何在 C# 中获得 mixin 风格的重用？

> ID：412378
> 
> 赞同：4
> 
> 时间：2009-01-05T06:04:47.850
> 
> 标签：c#, c++, generics, code-reuse, template-mixins

我来自 C++ 背景，我可以使用模板混合来编写引用 FinalClass 的代码，这是一个传入的模板参数。这允许可重用​​函数“混合”到任何派生类，只需从 ReusableMixin 继承使用 MyFinalClass 的模板参数。这一切都被内联到类中，所以就好像我刚刚编写了一个完成所有事情的大类——即非常快！由于 mixins 可以链接，我可以将各种行为（和状态）混合到一个对象中。

如果有人想澄清该技术，请询问。我的问题是，我怎样才能在 C# 中获得这样的重用？注意：C# 泛型不允许从泛型参数继承。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-01-05T09:29:48.793

您可以使用接口和扩展方法。例如：

```
public interface MDoSomething // Where M is akin to I
{
     // Don't really need any implementation
}

public static class MDoSomethingImplementation
{
     public static string DoSomething(this MDoSomething @this, string bar) { /* TODO */ }
} 
```

现在您可以通过从 MDoSomething 继承来使用 mixins。请记住，在 (this) 类中使用扩展方法需要 this 限定符。例如：

```
public class MixedIn : MDoSomething
{
    public string DoSomethingGreat(string greatness)
    {
         // NB: this is used here.
         return this.DoSomething(greatness) + " is great.";
    }
}

public class Program
{
    public static void Main()
    {
        MixedIn m = new MixedIn();
        Console.WriteLine(m.DoSomething("SO"));
        Console.WriteLine(m.DoSomethingGreat("SO"));
        Console.ReadLine();
    }
} 
```

HTH。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-01-05T08:12:00.667

在 C# 中，最接近 C++ 风格的 mixins 是将 mixins 添加为类的字段并向类添加一堆转发方法：

```
public class MyClass
{
    private readonly Mixin1 mixin1 = new Mixin1();
    private readonly Mixin2 mixin2 = new Mixin2();

    public int Property1
    {
        get { return this.mixin1.Property1; }
        set { this.mixin1.Property1 = value; }
    }

    public void Do1()
    {
        this.mixin2.Do2();
    }
} 
```

如果您只想导入 mixins 的功能和状态，这通常就足够了。mixin 当然可以随心所欲地实现，包括（私有）字段、属性、方法等。

如果您的班级还需要表达与 mixins 的“is-a”关系，那么您需要执行以下操作：

```
interface IMixin1
{
    int Property1 { get; set; }
}

interface IMixin2
{
    void Do2();
}

class MyClass : IMixin1, IMixin2
{
    // implementation same as before
} 
```

（这也是 C# 中模拟多重继承的标准方式。）

当然，mixin 接口和mixin 类可以是泛型的，例如具有最派生类参数或其他。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2010-01-10T13:23:39.393

在 C# 中，您可以使用“partial”关键字来指示您的类在多个源文件中实现。然后，您可以使用一个小模板工具来自动生成其他源代码文件，其中包含您要在类中注入的方法。

Visual Studio 中包含的 T4 模板工具可用于执行此操作，但可以使用更简单的方法。查看我自己的模板引擎： http: [//myxin.codeplex.com/](http://myxin.codeplex.com/)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2011-04-26T06:06:40.447

[在http://remix.codeplex.com](http://remix.codeplex.com)上查看 .net 的混音库

这个库为 .NET 带来了 mixins

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-05T06:19:47.880

扩展方法对您的场景有帮助吗？

# java - 如何在Java中组合路径？

> ID：412380
> 
> 赞同：411
> 
> 时间：2009-01-05T06:06:08.300
> 
> 标签：java, path

[`System.IO.Path.Combine()`](http://msdn.microsoft.com/en-us/library/system.io.path.combine.aspx)在 C#/.NET 中是否有 Java 等价物？或者任何代码来完成这个？

这种静态方法将一个或多个字符串组合成一个路径。

* * *

## 回答 #1

> 赞同：470
> 
> 时间：2009-01-05T07:29:27.477

您应该使用旨在表示文件系统路径的类，而不是让所有内容都基于字符串。

如果您使用的是 Java 7 或 Java 8，您应该强烈考虑使用[`java.nio.file.Path`](http://docs.oracle.com/javase/8/docs/api/java/nio/file/Path.html); `Path.resolve`可用于将一条路径与另一条路径或与字符串组合。[`Paths`](http://docs.oracle.com/javase/8/docs/api/java/nio/file/Paths.html)助手类也很有用。例如：

```
Path path = Paths.get("foo", "bar", "baz.txt"); 
```

如果您需要满足 Java-7 之前的环境，您可以使用[`java.io.File`](http://java.sun.com/javase/6/docs/api/java/io/File.html)，如下所示：

```
File baseDirectory = new File("foo");
File subDirectory = new File(baseDirectory, "bar");
File fileInDirectory = new File(subDirectory, "baz.txt"); 
```

如果您希望稍后将其作为字符串返回，您可以调用`getPath()`. 事实上，如果你真的想模仿`Path.Combine`，你可以写这样的东西：

```
public static String combine(String path1, String path2)
{
    File file1 = new File(path1);
    File file2 = new File(file1, path2);
    return file2.getPath();
} 
```

* * *

## 回答 #2

> 赞同：159
> 
> 时间：2013-11-19T10:50:54.410

在 Java 7 中，您应该使用[`resolve`](https://docs.oracle.com/javase/7/docs/api/java/nio/file/Path.html#resolve(java.nio.file.Path))：

```
Path newPath = path.resolve(childPath); 
```

虽然 NIO2 Path 类对于具有不必要不同 API 的 File 来说似乎有点多余，但实际上它更加优雅和健壮。

请注意，`Paths.get()`（正如其他人所建议的那样）没有过载 a `Path`，并且做`Paths.get(path.toString(), childPath)`与. 不同`resolve()`。从[`Paths.get()`文档](http://docs.oracle.com/javase/7/docs/api/java/nio/file/Paths.html#get(java.lang.String,%20java.lang.String...))：

> 请注意，虽然此方法非常方便，但使用它意味着对默认 FileSystem 的假定引用并限制调用代码的实用程序。因此，不应在旨在灵活重用的库代码中使用它。更灵活的替代方法是使用现有的 Path 实例作为锚点，例如：
> 
> ```
> Path dir = ...
> Path path = dir.resolve("file"); 
> ```

to 的姊妹功能`resolve`非常出色[`relativize`](https://docs.oracle.com/javase/7/docs/api/java/nio/file/Path.html#relativize(java.nio.file.Path))：

```
Path childPath = path.relativize(newPath); 
```

* * *

## 回答 #3

> 赞同：46
> 
> 时间：2009-01-05T13:05:10.480

主要答案是使用 File 对象。但是[Commons IO](http://commons.apache.org/io/)确实有一个类[FilenameUtils](http://commons.apache.org/proper/commons-io/apidocs/org/apache/commons/io/FilenameUtils.html)可以做这种事情，例如[concat()](http://commons.apache.org/proper/commons-io/apidocs/org/apache/commons/io/FilenameUtils.html#concat%28java.lang.String,%20java.lang.String%29)方法。

* * *

## 回答 #4

> 赞同：19
> 
> 时间：2017-08-09T14:43:22.263

平台无关的方法（使用 File.separator，即工作取决于运行代码的操作系统：

```
java.nio.file.Paths.get(".", "path", "to", "file.txt")
// relative unix path: ./path/to/file.txt
// relative windows path: .\path\to\filee.txt

java.nio.file.Paths.get("/", "path", "to", "file.txt")
// absolute unix path: /path/to/filee.txt
// windows network drive path: \\path\to\file.txt

java.nio.file.Paths.get("C:", "path", "to", "file.txt")
// absolute windows path: C:\path\to\file.txt 
```

* * *

## 回答 #5

> 赞同：18
> 
> 时间：2012-02-05T09:31:15.280

我知道自从乔恩的原始答案以来已经有很长时间了，但我对 OP 有类似的要求。

通过扩展 Jon 的解决方案，我想出了以下方法，它将采用一个或多个路径段，并采用您可以扔给它的尽可能多的路径段。

**用法**

```
Path.combine("/Users/beardtwizzle/");
Path.combine("/", "Users", "beardtwizzle");
Path.combine(new String[] { "/", "Users", "beardtwizzle", "arrayUsage" }); 
```

**在这里为其他有类似问题的人编写代码**

```
public class Path {
    public static String combine(String... paths)
    {
        File file = new File(paths[0]);

        for (int i = 1; i < paths.length ; i++) {
            file = new File(file, paths[i]);
        }

        return file.getPath();
    }
} 
```

* * *

## 回答 #6

> 赞同：11
> 
> 时间：2010-11-14T13:31:21.200

为了增强 JodaStephen 的回答，Apache Commons IO 具有执行此操作的 FilenameUtils。示例（在 Linux 上）：

```
assert org.apache.commons.io.FilenameUtils.concat("/home/bob", "work\\stuff.log") == "/home/bob/work/stuff.log" 
```

它是独立于平台的，可以生成系统需要的任何分隔符。

* * *

## 回答 #7

> 赞同：5
> 
> 时间：2019-02-12T10:54:55.203

也许迟到了，但我想分享我对此的看法。我正在使用 Builder 模式并允许方便地链接`append(more)`调用，并允许混合`File`和`String`. 它也可以很容易地扩展以支持使用`Path`对象，并且还可以在 Linux、Macintosh 等平台上正确处理不同的路径分隔符。

```
public class Files  {
    public static class PathBuilder {
        private File file;

        private PathBuilder ( File root ) {
            file = root;
        }

        private PathBuilder ( String root ) {
            file = new File(root);
        }

        public PathBuilder append ( File more ) {
            file = new File(file, more.getPath()) );
            return this;
        }

        public PathBuilder append ( String more ) {
            file = new File(file, more);
            return this;
        }

        public File buildFile () {
            return file;
        }
    }

    public static PathBuilder buildPath ( File root ) {
        return new PathBuilder(root);
    }

    public static PathBuilder buildPath ( String root ) {
        return new PathBuilder(root);
    }
} 
```

使用示例：

```
File root = File.listRoots()[0];
String hello = "hello";
String world = "world";
String filename = "warez.lha"; 

File file = Files.buildPath(root).append(hello).append(world)
              .append(filename).buildFile();
String absolute = file.getAbsolutePath(); 
```

结果`absolute`将包含以下内容：

```
/hello/world/warez.lha 
```

甚至可能：

```
A:\hello\world\warez.lha 
```

* * *

## 回答 #8

> 赞同：4
> 
> 时间：2017-04-03T12:44:58.557

如果您不需要多个字符串，则可以使用[com.google.common.io.Files](http://google.github.io/guava/releases/17.0/api/docs/com/google/common/io/Files.html)

```
Files.simplifyPath("some/prefix/with//extra///slashes" + "file//name") 
```

要得到

```
"some/prefix/with/extra/slashes/file/name" 
```

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2010-12-07T18:36:46.170

这是一个处理多个路径部分和边缘条件的解决方案：

```
public static String combinePaths(String ... paths)
{
  if ( paths.length == 0)
  {
    return "";
  }

  File combined = new File(paths[0]);

  int i = 1;
  while ( i < paths.length)
  {
    combined = new File(combined, paths[i]);
    ++i;
  }

  return combined.getPath();
} 
```

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2019-10-04T15:23:27.210

该解决方案提供了一个接口，用于连接来自 String[] 数组的路径片段。它使用**java.io.File.File(String parent, String child)**：

```
 public static joinPaths(String[] fragments) {
        String emptyPath = "";
        return buildPath(emptyPath, fragments);
    }

    private static buildPath(String path, String[] fragments) {
        if (path == null || path.isEmpty()) {
            path = "";
        }

        if (fragments == null || fragments.length == 0) {
            return "";
        }

        int pathCurrentSize = path.split("/").length;
        int fragmentsLen = fragments.length;

        if (pathCurrentSize <= fragmentsLen) {
            String newPath = new File(path, fragments[pathCurrentSize - 1]).toString();
            path = buildPath(newPath, fragments);
        }

        return path;
    } 
```

然后你可以这样做：

```
String[] fragments = {"dir", "anotherDir/", "/filename.txt"};
String path = joinPaths(fragments); 
```

回报：

```
"/dir/anotherDir/filename.txt" 
```

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2021-06-08T13:14:44.527

假设所有给定路径都是绝对路径。您可以按照以下片段合并这些路径。

```
String baseURL = "\\\\host\\testdir\\";
String absoluteFilePath = "\\\\host\\testdir\\Test.txt";;
String mergedPath = Paths.get(baseURL, absoluteFilePath.replaceAll(Matcher.quoteReplacement(baseURL), "")).toString(); 
```

输出路径是 \\host\testdir\Test.txt。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2019-06-16T02:26:09.850

这也适用于 Java 8：

```
Path file = Paths.get("Some path");
file = Paths.get(file + "Some other path"); 
```

# javascript - 如何在日历弹出窗口中的个位数月份和日期前插入零？

> ID：412385
> 
> 赞同：0
> 
> 时间：2009-01-05T06:09:05.280
> 
> 标签：javascript, string

我包括用于弹出日历的 Javascript 代码。代码的问题是，如果月份位于日历中的 1--9 和 1--9 之间的天数之间，我希望在月份或日期的前面插入一个“0”。以下是脚本。有人可以指导我进行修改吗？

```
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
    <head>
        <script type="text/javascript">
<!--
var months = new Array("January", "February", "March", "April", "May", "June", "July", "August", "September", "October", "November", "December");
var daysInMonth = new Array(31, 28, 31, 30, 31, 30, 31, 31, 30, 31, 30, 31);
var days = new Array("S", "M", "T", "W", "T", "F", "S");

today = new getToday(); 
var element_id;

function getDays(month, year) 
{
    // Test for leap year when February is selected.
    if (1 == month)
        return ((0 == year % 4) && (0 != (year % 100))) ||
            (0 == year % 400) ? 29 : 28;
    else
        return daysInMonth[month];
}

function getToday()
{
    // Generate today's date.
    this.now = new Date();
    this.year = this.now.getFullYear() ; // Returned year XXXX
    this.month = this.now.getMonth();
    this.day = this.now.getDate();
}

function newCalendar() 
{
    var parseYear = parseInt(document.all.year  [document.all.year.selectedIndex].text);

    var newCal = new Date(parseYear , document.all.month.selectedIndex, 1);
    var day = -1;
    var startDay = newCal.getDay();
    var daily = 0; 

    today = new getToday(); // 1st call
    if ((today.year == newCal.getFullYear() ) &&   (today.month == newCal.getMonth()))
       day = today.day;
    // Cache the calendar table's tBody section, dayList.
    var tableCal = document.all.calendar.tBodies.dayList;

    var intDaysInMonth =
       getDays(newCal.getMonth(), newCal.getFullYear() );

    for (var intWeek = 0; intWeek < tableCal.rows.length;  intWeek++)
           for (var intDay = 0;
             intDay < tableCal.rows[intWeek].cells.length;
             intDay++)
     {
          var cell = tableCal.rows[intWeek].cells[intDay];

          // Start counting days.
          if ((intDay == startDay) && (0 == daily))
             daily = 1;

          // Highlight the current day.
          cell.style.color = (day == daily) ? "red" : "";
          if(day == daily)
          {
                document.all.todayday.innerText= "Today: " +  day + "/" + 
                    (newCal.getMonth()+1) + "/" + newCal.getFullYear() ;
          }
          // Output the day number into the cell.
          if ((daily > 0) && (daily <= intDaysInMonth))
             cell.innerText = daily++;
          else
             cell.innerText = "";
       }

}

     function getTodayDay()
     {
                document.all[element_id].value = today.year + "/" + (today.month+1) + 
                    "/" + today.day; 
                //document.all.calendar.style.visibility="hidden";
                document.all.calendar.style.display="none";
                document.all.year.selectedIndex =100;   
                document.all.month.selectedIndex = today.month; 
     }

        function getDate() 
         {
            // This code executes when the user clicks on a day
            // in the calendar.
            if ("TD" == event.srcElement.tagName)
               // Test whether day is valid.
               if ("" != event.srcElement.innerText)
               { 
                 var mn = document.all.month.selectedIndex+1;
                 var Year = document.all.year [document.all.year.selectedIndex].text;
                document.all[element_id].value=Year +"-"+mn+"-"+event.srcElement.innerText;
                 document.all.calendar.style.display="none";
             }
         }

function GetBodyOffsetX(el_name, shift)
{
    var x;
    var y;
    x = 0;
    y = 0;

    var elem = document.all[el_name];
    do 
    {
        x += elem.offsetLeft;
        y += elem.offsetTop;
        if (elem.tagName == "BODY")
            break;
        elem = elem.offsetParent; 
    } while  (1 > 0);

    shift[0] = x;
    shift[1] = y;
    return  x;
}   

function SetCalendarOnElement(el_name)
{
    if (el_name=="") 
    el_name = element_id;
    var shift = new Array(2);
    GetBodyOffsetX(el_name, shift);
    document.all.calendar.style.pixelLeft  = shift[0]; //  - document.all.calendar.offsetLeft;
    document.all.calendar.style.pixelTop = shift[1] + 25 ;
}

function ShowCalendar(elem_name)
{
        if (elem_name=="")
        elem_name = element_id;

        element_id  = elem_name; // element_id is global variable
        newCalendar();
        SetCalendarOnElement(element_id);
        //document.all.calendar.style.visibility = "visible";
        document.all.calendar.style.display="inline";
}

function HideCalendar()
{
    //document.all.calendar.style.visibility="hidden";
    document.all.calendar.style.display="none";
}

function toggleCalendar(elem_name)
{
    //if (document.all.calendar.style.visibility == "hidden")
    if(document.all.calendar.style.display=="none")
        ShowCalendar(elem_name);
    else 
        HideCalendar();
}
-->
</script>

<style>
.today {COLOR: black; FONT-FAMILY: sans-serif; FONT-SIZE: 10pt; FONT-WEIGHT: bold}
.days {COLOR: navy; FONT-FAMILY: sans-serif; FONT-SIZE: 10pt; FONT-WEIGHT: bold; TEXT-ALIGN: center}
.dates {COLOR: black; FONT-FAMILY: sans-serif; FONT-SIZE: 10pt}
</style>
</head>

    <body bgcolor="#FFF8DC"> 
     <h5>Diesel Generators</h5><br><br>
         <br>
             <br>
                 <script language="JavaScript">
function toggle(source) {
  checkboxes = document.getElementsByName('DG1');
  for each(var checkbox in checkboxes)
    checkbox.checked = source.checked;
  checkboxes = document.getElementsByName('DG2');
  for each(var checkbox in checkboxes)
    checkbox.checked = source.checked;
    checkboxes = document.getElementsByName('DG3');
  for each(var checkbox in checkboxes)
    checkbox.checked = source.checked;
  checkboxes = document.getElementsByName('DG4');
  for each(var checkbox in checkboxes)
    checkbox.checked = source.checked;
     checkboxes = document.getElementsByName('DG5');
  for each(var checkbox in checkboxes)
    checkbox.checked = source.checked;
}
</script>

<input type="checkbox" onClick="toggle(this)" /> Select  All<br/>

<form method=POST action="DGUsageServlet">

<INPUT TYPE="CHECKBOX" name="DG1">DG1
<INPUT TYPE="CHECKBOX" name="DG2">DG2
<INPUT TYPE="CHECKBOX" name="DG3">DG3
<INPUT TYPE="CHECKBOX" name="DG4">DG4
<INPUT TYPE="CHECKBOX" name="DG5">DG5

<br>
<br>
<INPUT TYPE=TEXT NAME="StartDate">
    <a href="JavaScript:;" onClick="toggleCalendar('StartDate')">StartDate</a>
<INPUT TYPE=TEXT NAME="EndDate">
     <a href="JavaScript:;" onClick="toggleCalendar('EndDate')">EndDate</a>
<input name=plotgraph value=plotgraph align="CENTER" type=submit>
</form>
<TABLE bgColor=#ffffff border=1 cellPadding=0 cellSpacing=3 id=calendar style="DISPLAY: none; POSITION: absolute; Z-INDEX: 4">
  <TBODY>
  <TR>
    <TD colSpan=7 vAlign=center>
    <!-- Month combo box -->
    <SELECT id=month onchange=newCalendar()> 
        <script type="text/javascript">
        // Output months into the document.
        // Select current month.
        for (var intLoop = 0; intLoop < months.length; intLoop++)
            document.write("<OPTION " + (today.month == intLoop ? "Selected" : "") + ">" + months[intLoop]);
        </SCRIPT>
    </SELECT> 
    <!-- Year combo box -->
    <SELECT id=year onchange=newCalendar()> 
        <script type="text/javascript">
        // Output years into the document.
        // Select current year.
        for (var intLoop = 1900; intLoop < 2028; intLoop++)
            document.write("<OPTION " + (today.year == intLoop ? "Selected" : "") + ">" + intLoop);
        </SCRIPT>
    </SELECT> 

    </TD>
  </TR>

  <TR class=days>
    <!-- Generate column for each day. -->
    <script type="text/javascript">
    // Output days.
    for (var intLoop = 0; intLoop < days.length; intLoop++)
        document.write("<TD>" + days[intLoop] + "</TD>");
    </SCRIPT>
  </TR>

  <TBODY class=dates id=dayList onclick="getDate('')" vAlign=center>
  <!-- Generate grid for individual days. -->
  <script type="text/javascript">
    for (var intWeeks = 0; intWeeks < 6; intWeeks++)
    {
        document.write("<TR>");
        for (var intDays = 0; intDays < days.length; intDays++)
            document.write("<TD>" +intDays+ "</TD>");

        document.write("</TR>");
    }
  </SCRIPT>

  <!-- Generate today day. --></TBODY>
  <TBODY>
  <TR>
    <TD class=today colSpan=5 id=todayday onclick=getTodayDay()></TD>
    <TD align=right colSpan=2><A href="javascript:HideCalendar();"><SPAN style="COLOR: black; FONT-SIZE: 10px"><B>Hide</B></SPAN></A></TD>
  </TR>
  </TBODY>

</TABLE>

</body>
</html> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-05T06:49:42.830

我认为您编写脚本的方式不会按预期工作。尝试在谷歌上寻找预制的解决方案。这没有什么可耻的。

[https://engineering.purdue.edu/ECN/Support/KB/Docs/JavascriptCalendar](https://engineering.purdue.edu/ECN/Support/KB/Docs/JavascriptCalendar)

[http://www.google.com/search?source=ig&hl=en&rlz=1G1GGLQ_ENUS302&=&q=javascript+popup+calendar&btnG=Google+Search&aq=f](http://www.google.com/search?source=ig&hl=en&rlz=1G1GGLQ_ENUS302&=&q=javascript+popup+calendar&btnG=Google+Search&aq=f)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-30T21:34:40.153

只需在其前面添加一个零字符串，然后使用 .substring(-2,2) 返回最后两个字符，如下所示：

```
var iv="3";
alert(("0"+iv).substring(-2,2));
iv=1;
alert(("0"+iv).substring(-2,2));
iv=2;
alert(("0"+iv).substring(-2,2)); 
```

输入是字符串还是数字都没有关系。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-19T18:01:49.000

我同意尼尔森的观点，

[这](http://www.filamentgroup.com/lab/date_range_picker_using_jquery_ui_16_and_jquery_ui_css_framework/)是最好的 javascript 日期选择器解决方案之一。

# structuremap - 确定 StructureMap 是否配置了特定类型？

> ID：412386
> 
> 赞同：5
> 
> 时间：2009-01-05T06:10:34.217
> 
> 标签：structuremap

有没有办法确定是否在 StructureMap 中配置了特定类型？

如果没有在 StructureMap 中专门配置，我想返回一个泛型类型。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2010-02-12T12:48:39.293

在 v2.6 中，您想要：

```
IContainer.Model.HasImplementationsFor(serviceType) 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-01-06T08:23:46.913

从 StructureMap 版本 2.5.1 开始，有一个`TryGetInstance<T>()`and`TryGetNamedInstance<T>()`将返回`T`if`T`未知的默认值。

# javascript - “全选”选项的问题

> ID：412387
> 
> 赞同：0
> 
> 时间：2009-01-05T06:10:57.103
> 
> 标签：javascript

下面代码的问题是 Select All 选项在 Mozilla 而不是 Internet Explorer 中运行良好。

```
<!-- 
Document   : DG
Created on : Sep 11, 2008, 12:48:37 PM
Author     : padmaja
-->
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
    <script type="text/javascript">
<!--
var months = new Array("January", "February", "March", "April", "May", "June", "July", "August", "September", "October", "November", "December");
var daysInMonth = new Array(31, 28, 31, 30, 31, 30, 31, 31, 30, 31, 30, 31);
var days = new Array("S", "M", "T", "W", "T", "F", "S");

today = new getToday(); 
var element_id;

function getDays(month, year) 
{
// Test for leap year when February is selected.
if (1 == month)
    return ((0 == year % 4) && (0 != (year % 100))) ||
        (0 == year % 400) ? 29 : 28;
else
    return daysInMonth[month];
}

function getToday()
{
// Generate today's date.
this.now = new Date();
this.year = this.now.getFullYear() ; // Returned year XXXX
this.month = this.now.getMonth();
this.day = this.now.getDate();
}

function newCalendar() 
{
var parseYear = parseInt(document.all.year  [document.all.year.selectedIndex].text);

var newCal = new Date(parseYear , document.all.month.selectedIndex, 1);
var day = -1;
var startDay = newCal.getDay();
var daily = 0; 

today = new getToday(); // 1st call
if ((today.year == newCal.getFullYear() ) &&   (today.month == newCal.getMonth()))
   day = today.day;
// Cache the calendar table's tBody section, dayList.
var tableCal = document.all.calendar.tBodies.dayList;

var intDaysInMonth =
   getDays(newCal.getMonth(), newCal.getFullYear() );

for (var intWeek = 0; intWeek < tableCal.rows.length;  intWeek++)
       for (var intDay = 0;
         intDay < tableCal.rows[intWeek].cells.length;
         intDay++)
 {
      var cell = tableCal.rows[intWeek].cells[intDay];

      // Start counting days.
      if ((intDay == startDay) && (0 == daily))
         daily = 1;

      // Highlight the current day.
      cell.style.color = (day == daily) ? "red" : "";
      if(day == daily)
      {
            document.all.todayday.innerText= "Today: " +  day + "/" + 
                (newCal.getMonth()+1) + "/" + newCal.getFullYear() ;
      }
      // Output the day number into the cell.
      if ((daily > 0) && (daily <= intDaysInMonth))
         cell.innerText = daily++;
      else
         cell.innerText = "";
   }

}

 function getTodayDay()
 {
            document.all[element_id].value = today.year + "/" + (today.month+1) + 
                "/" + today.day; 
            //document.all.calendar.style.visibility="hidden";
            document.all.calendar.style.display="none";
            document.all.year.selectedIndex =100;   
            document.all.month.selectedIndex = today.month; 
 }

    function getDate() 
     {
        // This code executes when the user clicks on a day
        // in the calendar.
        if ("TD" == event.srcElement.tagName)
           // Test whether day is valid.
           if ("" != event.srcElement.innerText)
           { 
             var mn = document.all.month.selectedIndex+1;
             var Year = document.all.year [document.all.year.selectedIndex].text;
            document.all[element_id].value=Year +"-"+mn+"-"+event.srcElement.innerText;
             document.all.calendar.style.display="none";
         }
     }

function GetBodyOffsetX(el_name, shift)
{
var x;
var y;
x = 0;
y = 0;

var elem = document.all[el_name];
do 
{
    x += elem.offsetLeft;
    y += elem.offsetTop;
    if (elem.tagName == "BODY")
        break;
    elem = elem.offsetParent; 
} while  (1 > 0);

shift[0] = x;
shift[1] = y;
return  x;
}   

function SetCalendarOnElement(el_name)
{
if (el_name=="") 
el_name = element_id;
var shift = new Array(2);
GetBodyOffsetX(el_name, shift);
document.all.calendar.style.pixelLeft  = shift[0]; //  - document.all.calendar.offsetLeft;
document.all.calendar.style.pixelTop = shift[1] + 25 ;
}

function ShowCalendar(elem_name)
{
    if (elem_name=="")
    elem_name = element_id;

    element_id  = elem_name; // element_id is global variable
    newCalendar();
    SetCalendarOnElement(element_id);
    //document.all.calendar.style.visibility = "visible";
    document.all.calendar.style.display="inline";
}

function HideCalendar()
{
//document.all.calendar.style.visibility="hidden";
document.all.calendar.style.display="none";
}

function toggleCalendar(elem_name)
{
//if (document.all.calendar.style.visibility == "hidden")
if(document.all.calendar.style.display=="none")
    ShowCalendar(elem_name);
else 
    HideCalendar();
}
-->
</script>

<style>
.today {COLOR: black; FONT-FAMILY: sans-serif; FONT-SIZE: 10pt; FONT-WEIGHT: bold}
.days {COLOR: navy; FONT-FAMILY: sans-serif; FONT-SIZE: 10pt; FONT-WEIGHT: bold; TEXT-ALIGN: center}
.dates {COLOR: black; FONT-F

AMILY: sans-serif; FONT-SIZE: 10pt}
</style>
</head>

    <body bgcolor="#FFF8DC"> 
     <h5>Diesel Generators</h5><br><br>
         <br>
             <br>
                 <script language="JavaScript">
function toggle(source) {
  checkboxes = document.getElementsByName('DG1');
  for each(var checkbox in checkboxes)
    checkbox.checked = source.checked;
  checkboxes = document.getElementsByName('DG2');
  for each(var checkbox in checkboxes)
    checkbox.checked = source.checked;
    checkboxes = document.getElementsByName('DG3');
  for each(var checkbox in checkboxes)
    checkbox.checked = source.checked;
  checkboxes = document.getElementsByName('DG4');
  for each(var checkbox in checkboxes)
    checkbox.checked = source.checked;
     checkboxes = document.getElementsByName('DG5');
  for each(var checkbox in checkboxes)
    checkbox.checked = source.checked;
}
</script>

<input type="checkbox" onClick="toggle(this)" /> Select  All<br/>

<form method=POST action="DGUsageServlet">

<INPUT TYPE="CHECKBOX" name="DG1">DG1
<INPUT TYPE="CHECKBOX" name="DG2">DG2
<INPUT TYPE="CHECKBOX" name="DG3">DG3
<INPUT TYPE="CHECKBOX" name="DG4">DG4
<INPUT TYPE="CHECKBOX" name="DG5">DG5

<br>
<br>
<INPUT TYPE=TEXT NAME="StartDate">
    <a href="JavaScript:;" onClick="toggleCalendar('StartDate')">StartDate</a>
<INPUT TYPE=TEXT NAME="EndDate">
     <a href="JavaScript:;" onClick="toggleCalendar('EndDate')">EndDate</a>
<input name=plotgraph value=plotgraph align="CENTER" type=submit>
</form>
<TABLE bgColor=#ffffff border=1 cellPadding=0 cellSpacing=3 id=calendar style="DISPLAY: none; POSITION: absolute; Z-INDEX: 4">
  <TBODY>
  <TR>
    <TD colSpan=7 vAlign=center>
    <!-- Month combo box -->
    <SELECT id=month onchange=newCalendar()> 
        <script type="text/javascript">
        // Output months into the document.
        // Select current month.
        for (var intLoop = 0; intLoop < months.length; intLoop++)
            document.write("<OPTION " + (today.month == intLoop ? "Selected" : "") + ">" + months[intLoop]);
        </SCRIPT>
    </SELECT> 
    <!-- Year combo box -->
    <SELECT id=year onchange=newCalendar()> 
        <script type="text/javascript">
        // Output years into the document.
        // Select current year.
        for (var intLoop = 1900; intLoop < 2028; intLoop++)
            document.write("<OPTION " + (today.year == intLoop ? "Selected" : "") + ">" + intLoop);
        </SCRIPT>
    </SELECT> 

    </TD>
  </TR>

  <TR class=days>
    <!-- Generate column for each day. -->
    <script type="text/javascript">
    // Output days.
    for (var intLoop = 0; intLoop < days.length; intLoop++)
        document.write("<TD>" + days[intLoop] + "</TD>");
    </SCRIPT>
  </TR>

  <TBODY class=dates id=dayList onclick="getDate('')" vAlign=center>
  <!-- Generate grid for individual days. -->
  <script type="text/javascript">
    for (var intWeeks = 0; intWeeks < 6; intWeeks++)
    {
        document.write("<TR>");
        for (var intDays = 0; intDays < days.length; intDays++)
            document.write("<TD>" +intDays+ "</TD>");

        document.write("</TR>");
    }
  </SCRIPT>

  <!-- Generate today day. --></TBODY>
  <TBODY>
  <TR>
    <TD class=today colSpan=5 id=todayday onclick=getTodayDay()></TD>
    <TD align=right colSpan=2><A href="javascript:HideCalendar();"><SPAN style="COLOR: black; FONT-SIZE: 10px"><B>Hide</B></SPAN></A></TD>
  </TR>
  </TBODY>

</TABLE>

</body>
</html> 
```

请指导我

提前致谢。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-01-05T06:18:47.977

您的代码在任何地方都使用 document.all 请*不要使用它*，您应该使用 document.getElementById

IE 4 引入了 document.all DOM。不久之后，标准 DOM 方法 getElementById 被引入，因此在*所有*现代浏览器中都可用。

例如：

```
document.all.calendar.style.display="none"; 
```

现在应该是：

```
document.getElementById('calendar').style.display="none"; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-05T07:58:56.933

该`for each(var in array/object)`构造是 Javascript 的一个相对较新的补充。不要使用它。IE 可能会窒息它。

相反，请使用较旧的（且普遍支持的）`for (var in array/object)`构造。

更好的是，永远不要`for (var in x)`在数组上使用构造，[而只在 objects 上使用它们](https://developer.mozilla.org/en/Core_JavaScript_1.5_Reference/Statements/for...in#Description)。

这是我的重写：

```
function toggle(source) {
    var checkboxes = document.getElementsByName('DG1');
    for (var i=0; i<checkboxes.length; i++){
        checkbox.checked = source.checked;
    }
    // etc...
} 
```

# cocoa-touch - 如果我有多个 UISwitches，我怎么知道哪些是打开的？

> ID：412399
> 
> 赞同：2
> 
> 时间：2009-01-05T06:16:49.540
> 
> 标签：cocoa-touch

希望一切都好。

我在表视图中有 22 个 UISwitch，我在一个函数中创建了所有这些开关对象并将它们设置在表视图中。

我怎么知道哪个开关打开或关闭？我只想通过一种操作方法来做到这一点，但我不知道该怎么做。

如果有人遇到过这个问题，请给我一些想法...

谢谢，哈雷什。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-05T06:19:47.443

执行此类操作的最佳方法是将每个表格单元格设置为您的表格视图控制器作为委托以及指示该单元格正在呈现的开关的标签 - 然后让每个单元格检测开关更改，然后告诉委托人具有指示 ID 的开关已被更改。您可以将开关状态保存在由单元开关标记存储的 NSDictionary 中。

这当然意味着一个自定义 UITableViewCell 类，因此您可以将标签和委托链接存储回您的 UITableViewController（注意，不要将此链接保留回您的表格视图控制器）

编辑此答案提供了您可能更喜欢的不同方法：

[获取 NSButtonCell 的行](https://stackoverflow.com/questions/394287/getting-the-row-of-a-nsbuttoncell)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-05T14:23:35.503

tableView:didSelectRowAtIndexPath: 只会在你的表格视图中选择行本身，这听起来不像你想要做的。

在创建 UISlider 实例的方法中，您可以将这些实例作为键存储在 NSMutableDictionary 中（使用 setObject:forKey），并将 NSNumbers 作为值用于稍后的 switch 语句。对于每个 UISlider，确保通过将目标设置为控制器中的方法来记录其值的更改，方法类似于以下内容：

```
[slider addTarget:self action:@selector(sliderValueDidChange:forEvent:) forControlEvents:UIControlEventAllTouchEvents]; 
```

并在您的控制器中设置一个类似于此的方法：

```
- (void)sliderValueDidChange:(id)sender forEvent:(UIEvent *)event; 
```

在其中您可以使用发送者、UISlider 实例的 NSDictionary 以及 NSNumber 的 intValue 上的 switch 语句来确定哪个滑块的值已更改以及新值是什么。

除了开/关开关，我还可以建议使用复选标记作为辅助视图吗？然后，您可以使用 tableView:didSelectRowAtIndexPath: 来跟踪用户对行的选择，如果元素已被选中，则在辅助视图中显示复选标记。这可能更符合 Apple 的人机界面指南。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-12T11:03:51.400

附件视图上的复选标记？？？？？？找到了一个示例“附件”，但他们设置了一个按钮并设置了复选标记按钮和取消复选标记按钮的图像..你的意思是这样说

# jakarta-ee - 有没有免费的 websphere 5 分析工具？

> ID：412406
> 
> 赞同：1
> 
> 时间：2009-01-05T06:22:06.457
> 
> 标签：jakarta-ee, profiling, websphere

我正在寻找一个客户端应用程序，它可以连接到 websphere 中的 EAR 文件，并为我提供内存使用情况、堆大小等信息。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-01-05T10:40:52.160

ManageEngine 的应用程序管理器确实提供了堆使用情况和其他性能统计信息等基本信息。它在[此处](http://manageengine.adventnet.com/products/applications_manager/ "这里")可用，但它不是分析工具。它是一个监控工具。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-08T01:02:27.007

我发现 Tivoli Performance Viewer 是 Websphere 套件的一部分，但它看起来有点笨重。

# java - JUnit 的@Ignore

> ID：412409
> 
> 赞同：16
> 
> 时间：2009-01-05T06:25:49.290
> 
> 标签：java, unit-testing, testing

我想知道使用 JUnit 的 @Ignore 是否是一个好习惯。人们如何使用它？

我想出了以下用例：假设我正在开发一个类并为它编写一个 JUnit 测试，但没有通过，因为我还没有完成这个类。用@Ignore 标记它是一个好习惯吗？

我有点担心我们以后可能会错过被忽略的测试用例，或者人们开始使用它来“强制”测试通过 CI。

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2009-01-05T06:28:41.467

那很好，我想。

[文档](https://github.com/junit-team/junit/wiki/Ignoring-tests)说，

> 测试运行者将报告被忽略的测试数量，以及运行的测试数量和失败的测试数量。

因此，这意味着即使您事后忘记删除它，您也应该收到通知。

[文档](https://github.com/junit-team/junit/wiki/Ignoring-tests)中给出的示例与您的情况完全相似。

```
@Ignore("not ready yet") 
```

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-08-18T11:10:25.633

我经常将@Ignore 用于由于已知错误而失败的测试。一旦错误被确认并记录在错误数据库中，测试失败就没有任何意义，因为错误是已知的。

保留测试代码仍然有意义，因为一旦修复了错误，它将再次有用。所以我将它标记为被忽略，并带有一个注释来指示相关的错误，并且最好在错误报告中注明应该重新激活测试以测试修复。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2009-01-05T08:26:13.070

恕我直言，请忽略不应轻易使用的内容...由于破窗效果。

我很少发现自己在 xUnit 中使用这个属性/注解。我使用它们的唯一几次是在编写 TestCase#1 时作为**TODO**，我看到了另一个我错过但也应该包括在内的测试用例。为了不忘记，我写了一个带有描述性名称的小测试用例，并用 Ignore 标记它。继续完成 TestCase#1。但这都是内部签到。我从不签入标有“忽略”的测试。

但是通常我只**用一张纸——测试列表**来记下新的测试用例——这要简单得多。这也迎合了我部分完成的场景......完成了 10 个测试中的 5 个。我不会签入 5 个忽略的测试，而是保留测试列表并签入 5 个通过的测试。假设您将在接下来的几次签到中完成其余部分，然后再跳到新事物。

我能想到的其他“特殊情况”是..
当您**等待**来自另一个团队/人员/供应商的组件（其接口已发布并同意）时，测试无法运行。在这种情况下，您可以编写测试并将其标记为 Ignore("Waiting on X to deliver component Y")

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2009-05-13T14:07:14.523

我认为这是一个非常好的使用它的方法。

你的 CI 服务器应该一直是绿色的（或者在 Hudson 的例子中是蓝色的）。只要不是你的首要任务就是修复它。

现在，如果 CI 因测试代码中的错误而中断（也许测试代码是顽皮且不确定的），那么您应该忽略测试“@Ignore（此测试代码是 borken，引发缺陷 #123）”并引发缺陷跟踪器中的错误。

您不会发布损坏的代码，因为无论何时发布，您都会检查所有缺陷并确定其中是否有任何缺陷，对吗？未运行的损坏测试将与它正在测试的代码/功能一起考虑。当且仅当您对它正在测试的代码也没有损坏感到高兴时，您才发货。如果它没有经过测试，则认为它已损坏。

我希望在从 ant 运行测试时使用的 junit xml 报告格式化程序有一天会包括忽略的计数（和原因）以及通过、失败和错误。也许那时，CI 供应商将包括被忽略的测试计数（如果没有，我可能不得不编写一个 Hudson 插件......）

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-01-05T06:31:08.873

好吧，如果您没有完成课程，那很好，测试失败了。将其标记为@Ignore 意味着您将发布一个未完成类的代码。是的，也许您还没有在任何被执行的代码中使用该类，但有一天其他开发人员可能会看到该类并使用它。然后他失败了，即使它应该工作。

在那种情况下，我肯定不会使用@Ignore。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-01-05T07:35:38.227

我认为使用@ignore 是可以的，只要有 -

1.  无法以某种形式测试该方法的一个很好的理由，并且在代码中记录了该方法。这应该是一种特殊情况，需要进行讨论或代码审查，看看是否有任何方法可以对其进行测试。
2.  测试尚未构建 - 理想情况下，这仅适用于遗留代码。这也应该接受代码审查，并且应该将任务添加到添加测试中。

至少在我看来这是规则;-)

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2011-05-02T17:12:51.823

我认为这违背了测试驱动开发的核心基础。当然，如果你不做 TDD，那么它可能没那么重要。

我想说的是，如果您使用的是@ignore，那么您就不是精益并且不做 TDD。

如果你正在做 TDD，那么你不应该在你对你的 repo 所做的任何提交中出现失败的测试。

我完全疯了还是有道理？

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2011-12-22T13:36:14.813

我认为当测试依赖于无法模拟的外部实体时使用@Ignore 是可以的。我们仍然需要测试以确保一切正常，但我们不想部署依赖于外部依赖项的测试。

例如，如果您为 Google 文档编写自定义的 SpreadsheetWriter/Reader，那么使用真正的 google 文档对其进行测试是有意义的。但是，如果 google 文档由于某种原因而关闭，您不希望您的构建失败。在确认您的单元测试在本地通过后，我会在将其推送到生产之前添加一个@Ignore。

一般来说，我认为应该尽可能避免使用@Ignore，因为在大多数情况下，可以模拟外部类/系统。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2012-03-06T16:01:56.677

`@Ignore`可用于为某些第三方服务编写的测试。我最近发现自己需要检查外部服务是否正在发回我期望的数据。在测试（模拟）中这样做非常方便。因为我*知道*我的输入数据不会永远有效，以后可能需要运行类似的测试，所以我添加`@Ignore`而不是删除测试。

# objective-c - 编译 gnustep-gui-0.16.0 未定义对 png_sizeof 的引用时出现问题

> ID：412410
> 
> 赞同：2
> 
> 时间：2009-01-05T06:26:04.577
> 
> 标签：objective-c, gnu, gnustep, openstep

我正在尝试在 linux 机器上编译 GNUstep，但 gnustep-gui-0.16.0 包失败。我下载了 GNUstep Startup stable 0.20.1 ( [http://wwwmain.gnustep.org/resources/downloads.php](http://wwwmain.gnustep.org/resources/downloads.php) ) 并按照有关如何编译 (./configure && make) 的说明进行操作。我收到此错误：

`libgnustep-gui.so: undefined reference to 'png_sizeof'`

我已经编译了最新的 libpng (1.2.34)，我可以看到 png_sizeof 被定义为宏。但是，我不太确定如何修复 gnustep-gui-0.16.0 构建。我试图通过安装 libpng 的 include/lib 目录来配置构建，但似乎没有任何帮助。

我有最新的 linux 机器，但使用的是 gcc 3.3（升级不是一个选项 - 但这应该不是问题）。

完整错误：

```
Making all for tool set_show_service...
 Compiling file set_show_service.m ...
 Linking tool set_show_service ...
../Source/./obj/libgnustep-gui.so: undefined reference to `png_sizeof'
collect2: ld returned 1 exit status
gmake[3]: *** [obj/set_show_service] Error 1
gmake[2]: *** [set_show_service.all.tool.variables] Error 2
gmake[1]: *** [internal-all] Error 2
gmake[1]: Leaving directory `/home/bla/local/src/gnustep-startup-0.22.0/build/gnustep-gui-0.16.0'
gmake[3]: *** [obj/set_show_service] Error 1
gmake[2]: *** [set_show_service.all.tool.variables] Error 2
gmake[1]: *** [internal-all] Error 2 
```

有什么建议么？谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2010-04-15T07:41:16.197

请注意，您可以运行`make messages=yes`让 GNUstep-make 更详细地说明它在做什么。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-12T21:44:56.693

当我使用 --verbose （或 --debug ？）编译时，我注意到 gnustep 正在查看它的 ~/GNUstep/System/Library/Libraries and Headers （以及其他地方），所以我移动了 libpng 的副本，我我刚刚重新编译到那个区域，它全部编译没有问题。

# asp.net-mvc - ASP.Net MVC Html.ActionLink() 问题

> ID：412412
> 
> 赞同：2
> 
> 时间：2009-01-05T06:26:43.327
> 
> 标签：asp.net-mvc, routing

我正在使用 MVC beta 编写一个简单的应用程序来理解 ASP.Net MVC。该应用程序是一个带有标签的简单照片/视频共享站点。我正在处理 MVC 骨架项目。我在导航栏中添加了一些 Html.ActionLink()，但是我在一个地方添加的 Html.ActionLink() 之一出现问题。

我希望 ~/Tags 显示数据库中的所有标签，我希望 ~/Tags/{tag} 显示所有带有 {tag} 标记的文件的列表。这按预期工作，但是当我关注 ~/Tags/{tag} 时，它会将导航栏中的 Html.ActionLink() 更改为与 ~/Tags/{tag} 链接相同，而不仅仅是指向 ~ /标签。我不明白为什么当我跟随 ~/Tags/{tag} 时导航栏中的 ActionLink() 会发生变化。如果我导航到项目中的其他链接，ActionLink() 将按预期工作。

我有这样的操作链接和路由设置。我的 TagsController 有这个 Index 动作。整数？用于分页控制。我有两个视图，一个称为全部，一个称为详细信息。我究竟做错了什么？

```
 Html.ActionLink("Tags", "Index", "Tags") // In navigation bar

        routes.MapRoute(
            "Tags",
            "Tags/{tag}",
            new
            {
              controller = "Tags", action = "Index", tag = "",
            });

        public ActionResult Index(string tag, int? id )
        {  // short pseudocode
           If (tag == "")
             return View("All", model)
           else
             return View("Details", model) 
        } 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-05T11:11:34.330

我认为您需要处理 yoursite.com/Tags/ 的一个实例，因为您只处理一个带有标签的实例。

我会创建另一条路线：

```
routes.MapRoute(
  "TagsIndex", //Called something different to prevent a conflict with your other route
  "Tags/",
  new { controller = "Tags", action = "Index" }
);

routes.MapRoute(
  "Tags",
  "Tags/{tag}",
  new { controller = "Tags", action = "Tag", tag = "" }
);

/* In your controller */
public ActionResult Index() // You could add in the id, if you're doing paging here
{
  return View("All", model);
}

public ActionResult Tag(string tag, int? id)
{
  if (string.IsNullOrEmpty(tag))
  {
    return RedirectToAction("Index");
  }

  return View("Details", model);
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-05T14:08:26.390

除了像 Dan Atkinson 提到的那样创建额外的路由之外，您还应该摆脱控制器中的 if 语句，并创建另一个控制器方法（称为 Details）来处理标签详细信息。控制器中用于确定要显示哪个视图的 if 语句是代码异味。让路由引擎完成它的工作，您的控制器代码将更简单，更易于维护。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-05T12:02:27.907

我建议你研究一下 Lamda 表达式来处理这个问题，你将来可能会得到一个“标签汤”。

此外，请确保您已下载 Microsoft.Web.Mvc dll，与 System.Web.Mvc 不同。

[从哪里获得 Microsoft.Web.Mvc.dll](https://stackoverflow.com/questions/334408/where-to-get-microsoftwebmvcdll)

# ios - 如何通过一个按钮链接两个 iphone 应用程序

> ID：412424
> 
> 赞同：3
> 
> 时间：2009-01-05T06:33:51.380
> 
> 标签：ios, url-scheme

我有两个 iphone 应用程序，希望它们能够通过一个按钮进行切换，无论如何要这样做吗？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-01-05T07:01:29.233

听起来您想使用[URL 方案](http://furbo.org/2008/10/01/redacted/)来打开不同的应用程序。

[这是 Apple关于该主题](http://developer.apple.com/iphone/library/documentation/iPhone/Conceptual/iPhoneOSProgrammingGuide/ApplicationEnvironment/chapter_3_section_6.html#//apple_ref/doc/uid/TP40007072-CH7-SW26)的官方信息，来自评论中的[squelart](http://developer.apple.com/iphone/library/documentation/iPhone/Conceptual/iPhoneOSProgrammingGuide/ApplicationEnvironment/chapter_3_section_6.html#//apple_ref/doc/uid/TP40007072-CH7-SW26)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-05T07:24:58.793

您可能需要某种 Internet 服务来在两个应用程序之间反弹任何非文本数据。如果您的数据可以简单地在 URI 中表示，您可以通过 Alan Storm 建议的 URL 方案传递两个 iphone 应用程序之间的链接。

# asp.net - resx文件的实际用途是什么？

> ID：412425
> 
> 赞同：0
> 
> 时间：2009-01-05T06:34:39.037
> 
> 标签：asp.net, resx

resx文件的实际用途是什么？

我正在使用.net 1.1。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-05T06:42:05.730

店铺资源：

*   图片
*   字符串
*   嵌入文件
*   .... 和更多

[.Resx 文件格式的资源](http://msdn.microsoft.com/en-us/library/ekyft91f(VS.71).aspx)

# crystal-reports - 如何在图像前面设置线条或框？

> ID：412426
> 
> 赞同：4
> 
> 时间：2009-01-05T06:35:03.030
> 
> 标签：crystal-reports, report, line

我已通过以下步骤在水晶报表中插入图像，在包含图像的部分的部分专家中，选中 Underlay 以下部分。但是，当创建一些线条或框时，图像仍然在它们面前。我无法在图像前面设置 Line 或 Box

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-01-12T19:06:16.510

它可能不是解决问题的最优雅的解决方案，但您可以使用文本框，并用下划线填充它。它会产生一条线的错觉，因为它会显示在图像上方。

**注意：**它在报告预览中可能看起来不太好（有时显示为分隔的破折号），但是当您实际运行它时，将其导出为 pdf 或打印它，它看起来很好。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-13T00:51:08.513

您**应该**能够右键单击图像并选择移动/返回。这会将图像移动到 Z 顺序的后面。

（应该是粗体，因为这应该有效，但它没有）:)

编辑：我意识到现在我对此的原始答案是不正确的。这是一个类似的问题，供其他一些想法参考。

[如何在图片上方画一条线？](https://stackoverflow.com/questions/1102124/how-to-draw-a-line-in-picture)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2017-07-20T11:36:33.130

您可以插入一个空文本字段并在顶部为其添加边框。在这种情况下，您模拟一条线。

通过将您的字段移到前面（或将您的图像移到后面），这条“线”将始终位于图像的前面。

# notepad++ - Notepad++ 中的自动缩进

> ID：412427
> 
> 赞同：194
> 
> 时间：2009-01-05T06:36:28.643
> 
> 标签：notepad++, indentation, code-formatting

我们总是这样写正式的代码：

```
void main(){
  if(){
    if()
    } 
```

![替代文字](https://i.stack.imgur.com/dPV7i.jpg)

但是当我使用[Notepad++](http://en.wikipedia.org/wiki/Notepad%2B%2B)时，显示为：

```
void main(){
if(){
if()
} 
```

![替代文字](https://i.stack.imgur.com/1T37o.jpg)

如何使用 Notepad++ 自动缩进？

感谢[Jonathan](https://stackoverflow.com/a/412449/325514)，我已经设置了它，但它没有任何效果。截图如下：

![替代文字](https://i.stack.imgur.com/1jOZS.jpg)

我正在使用 Notepad++ 5.1.3 版。

* * *

## 回答 #1

> 赞同：140
> 
> 时间：2009-01-05T07:26:53.580

如果您手动缩进块中的第一行，Notepad++ 只会自动插入后续缩进；否则，您可以在使用`TextFX > TextFX Edit > Reindent C++ code`.

* * *

## 回答 #2

> 赞同：104
> 
> 时间：2012-03-24T05:47:31.740

如果 TextFX 菜单不存在，则需要下载并安装插件。**Plugins->Plugin Manager->Show Plugin Manager**然后检查插件*TextFX Characters*。单击“安装”，重新启动 Notepad++。

在 Notepad++ v6.1.3 版本中，我解决了：插件管理器->显示插件管理器**，然后检查插件“按折叠缩进”

* * *

## 回答 #3

> 赞同：31
> 
> 时间：2010-03-18T06:42:42.153

至少似乎有一个自动格式化 XML 的选项。可以在`TextFX -> TextFX HTML Tidy -> Tidy: reindent XML`.

* * *

## 回答 #4

> 赞同：29
> 
> 时间：2009-01-06T12:13:06.717

大多数文本编辑程序的开发者都滥用这个名称（自动缩进）。正确的名称是“保持缩进”。自动缩进是你真正想要的，但它没有实现。

我也想在 Notepad++ 中看到这个功能。

* * *

## 回答 #5

> 赞同：22
> 
> 时间：2009-01-05T06:57:46.150

在最新版本中（至少），您可以通过以下方式找到它：

*   **设置**（菜单）
*   **喜好...**
*   **杂项**（选项卡）
*   左下角复选框列表
*   “**自动缩进**”是该组中的第二个选项

[**编辑**]虽然，我不认为它有最好的自动缩进实现。因此，请检查以确保您拥有 5.1 版——自动缩进最近进行了大修，因此它会自动更正您的缩进。

* * *

另请注意，您缺少 2nd 的块`if`：

```
void main(){
  if(){
    if() { }  # here
  }
} 
```

* * *

## 回答 #6

> 赞同：15
> 
> 时间：2012-06-15T17:04:02.593

你可以使用'Indent by fold'插件。从插件管理器安装它。这对我来说可以。

* * *

## 回答 #7

> 赞同：5
> 
> 时间：2014-09-03T18:07:15.037

在 6.6.8 版本中，我从 Plugins > Plugin Manager > Show Plugin Manager 安装了 NppAutoIndent 插件。然后我在 Plugin > NppAutoIndent 中选择了 Smart Indent 选项。希望这可以帮助。

* * *

## 回答 #8

> 赞同：5
> 
> 时间：2020-04-23T06:54:52.127

对于使用 7.8.5 版本的用户，自动缩进设置现在位于“设置”->“首选项...”->“自动完成”。

[![在此处输入图像描述](https://i.stack.imgur.com/r9wI6.png)](https://i.stack.imgur.com/r9wI6.png)

* * *

## 回答 #9

> 赞同：5
> 
> 时间：2016-09-23T05:56:27.993

对于使用 Notepad++ v6.8.1 及更高版本的用户，自动缩进设置现在位于菜单*设置*→*首选项*→ *MISC 中。*→*自动缩进*。

[![在此处输入图像描述](https://i.stack.imgur.com/iSHGf.png)](https://i.stack.imgur.com/iSHGf.png)

* * *

## 回答 #10

> 赞同：3
> 
> 时间：2017-10-20T11:30:11.777

您可以添加“Text FX Character”插件。从[https://sourceforge.net/projects/npp-plugins/files/TextFX/](https://sourceforge.net/projects/npp-plugins/files/TextFX/)下载并通过安装

```
Plugins → Plugin Manager → Show Plugin Manager. 
```

然后你会发现一个新的“TextFX”菜单：

```
Menu TextFX → TextFX Edit → Reindent C++ code 
```

[![在此处输入图像描述](https://i.stack.imgur.com/AXnA9.png)](https://i.stack.imgur.com/AXnA9.png)

**为 Indentation 添加快捷方式**。

单击*设置*→*快捷方式映射器...*设置您喜欢的快捷键。我更喜欢`Ctrl`+ `=`。

[![在此处输入图像描述](https://i.stack.imgur.com/n1geA.png)](https://i.stack.imgur.com/n1geA.png)

* * *

## 回答 #11

> 赞同：3
> 
> 时间：2016-04-14T07:56:02.237

一点更新：您可以跳过 TextFX 插件，直接使用**Tidy2**。在这里，您可以为不同类型的代码配置自己的格式化规则。易于安装和拆卸

**Notepad++ > 插件 > 插件管理器 > 显示插件管理器**

只需搜索**Tidy2**并安装它。完毕。

* * *

## 回答 #12

> 赞同：2
> 
> 时间：2013-08-23T15:44:12.790

试试 Notepad++ 的[UniversalIndentGUI](http://sourceforge.net/projects/universalindent/files/uigui/UniversalIndentGUI_1.0.2/UniversalIndentGUI_1.0.2_NotepadPPplugin.zip/download)插件。它根据一些参数重新缩进代码。它对我来说效果很好。

* * *

## 回答 #13

> 赞同：2
> 
> 时间：2016-10-02T07:56:38.573

这可能看起来很愚蠢，但在最初的问题中，Turion 正在编辑一个纯文本文件。确保从“语言”菜单中选择正确的语言

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2019-02-11T20:39:30.360

首先下载插件管理器[此链接](https://github.com/bruderstein/nppPluginManager/releases)，然后解压缩 zip 文件夹并将其复制到您的程序/notepad++ 文件夹中。然后重新启动记事本++。然后你会在插件菜单中看到插件管理器。然后单击插件管理器，然后单击显示插件管理器。它显示了你所有的插件列表。从底部的列表中找到 XML 工具，检查并安装它。然后重新启动记事本++。打开一个文档后，插件/xml 工具/pretty plain（缩进文本）然后享受。

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2018-05-01T23:45:05.160

安装 Tidy2 插件。我有 Notepad++ v6.2.2，到目前为止 Tidy2 工作正常。

* * *

## 回答 #16

> 赞同：-1
> 
> 时间：2020-06-19T10:52:26.863

尝试之前保存文件，然后它会缩进。

# java - Java日期格式？

> ID：412435
> 
> 赞同：4
> 
> 时间：2009-01-05T06:43:05.587
> 
> 标签：java, date, formatting

我想读取格式为 YYYY-MM-DD 的日期。

但是，如果我输入日期，例如 2008-1-1，我想将其读取为 2008-01-01。

有谁能够帮我？提前致谢

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-01-05T07:14:39.970

或者使用更好的[Joda Time](http://joda-time.sourceforge.net/)库。

```
 DateTime dt = new DateTime();
    System.out.println(dt.toString("yyyy-MM-dd"));

    // The ISO standard format for date is 'yyyy-MM-dd'
    DateTimeFormatter formatter = ISODateTimeFormat.date();
    System.out.println(dt.toString(formatter));
    System.out.println(formatter.print(dt)); 
```

日期和日历 API 很糟糕。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-01-05T06:45:29.780

使用[SimpleDateFormat](http://java.sun.com/javase/6/docs/api/java/text/SimpleDateFormat.html)。

**[已编辑]**

[几个示例代码](http://javatechniques.com/blog/dateformat-and-simpledateformat-examples/)。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2009-01-05T07:12:04.453

如果您需要使用内置的 Java 日期/时间处理，Adeel 的解决方案很好，但我个人更愿意使用[Joda Time](http://joda-time.sourceforge.net/)。在格式化方面，Joda Time 的主要好处是格式化程序是无状态的，因此您可以在线程之间安全地共享它。示例代码：

```
DateTimeFormatter parser = DateTimeFormat.forPattern("YYYY-M-D");
DateTimeFormatter formatter = DateTimeFormat.forPattern("YYYY-MM-DD");

DateTime dt = parser.parseDateTime("2008-1-1");
String formatted = formatter.print(dt); // "2008-01-01" 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-01-05T15:45:50.530

```
import java.text.*;

public class Test
{

    public static void main(String args[])
    {
        try
        {
                SimpleDateFormat sdf = new SimpleDateFormat("yyyy-MM-DD");  
            System.out.println(sdf.parse(args[0]).toString());
        }
                catch(Exception e)
        {
            e.printStackTrace();
        }
    }
} 
```

这可以正常工作，无论您写为参数“2008-1-1”还是“2008-01-01”。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2021-07-21T18:39:50.713

# *java.time*

`java.util`日期时间 API 及其格式化 API已`SimpleDateFormat`过时且容易出错。建议完全停止使用它们并切换到[现代 Date-Time API](https://www.oracle.com/technical-resources/articles/java/jf14-Date-Time.html) ^*。

另外，下面引用的是来自[**Joda-Time**](https://www.joda.org/joda-time/)[主页](https://www.joda.org/joda-time/)**的通知：**

 **> 请注意，从 Java SE 8 开始，用户被要求迁移到 java.time (JSR-310) - JDK 的核心部分，它取代了这个项目。

**使用`java.time`现代日期时间 API 的解决方案：**

```
import java.time.LocalDate;
import java.time.format.DateTimeFormatter;
import java.util.Locale;

public class Main {
    public static void main(String[] args) {
        DateTimeFormatter dtfInput = DateTimeFormatter.ofPattern("u-M-d", Locale.ENGLISH);
        String input = "2008-1-1";
        LocalDate date = LocalDate.parse(input, dtfInput);
        System.out.println(date);
    }
} 
```

**输出：**

```
2008-01-01 
```

[`ONLINE DEMO`](https://ideone.com/0ItOoT)

**笔记：**

1.  使用`y`（指定*year-of-era*）而不是`Y`（指定*week-based-year*）。
2.  使用`d`（指定*day-of-month*）而不是`D`（指定*day-of-year*）。
3.  对于解析，单个`u`可以同时满足两位数和四位数的年份表示。同样，一个单一的`M`可以同时满足一位数和两位数的月份。`DateTimeFormatter`以类似的方式处理其他字母。
4.  在这里，您可以使用`y`代替，`u`但[我更喜欢`u`使用`y`](https://stackoverflow.com/a/65928023/10819573).
5.  您一定已经注意到我没有使用 a`DateTimeFormatter`作为输出字符串。这是因为已经返回[ISO-8601](https://en.wikipedia.org/wiki/ISO_8601)[`LocalDate#toString`](https://docs.oracle.com/javase/8/docs/api/java/time/LocalDate.html#toString--)格式的字符串uuuu-MM-dd （这也是您想要的模式）。

**[从Trail: Date Time](https://docs.oracle.com/javase/tutorial/datetime/index.html)**了解有关现代日期时间 API 的更多信息。

* * *

^(* 出于任何原因，如果您必须坚持使用 Java 6 或 Java 7，则可以使用[***ThreeTen-Backport，***](http://www.threeten.org/threetenbp/)它将大部分*java.time*功能向后移植到 Java 6 和 7。如果您正在为 Android 项目和 Android API 工作level 仍然不符合 Java-8，请检查[Java 8+ APIs available through desugaring](https://developer.android.com/studio/write/java8-support-table)和[How to use ThreeTenABP in Android Project](https://stackoverflow.com/questions/38922754/how-to-use-threetenabp-in-android-project)。)

# c++ - 如何避免大型代码库中的常见错误？

> ID：412438
> 
> 赞同：6
> 
> 时间：2009-01-05T06:44:36.067
> 
> 标签：c++, string

有没有办法取消在字符串和 wstrings 上为 chars 和 wchar_t 定义 +=？

基本上我想避免如下错误：

```
int age = 27;

std::wstring str = std::wstring(L"User's age is: ");
str += age;

std::string str2 = std::string("User's age is: ");
str2 += age; 
```

上面的代码会将 ascii 字符 27 添加到字符串中，而不是数字 27。

**我显然知道如何解决这个问题，但我的问题是：在这种情况下如何产生编译器错误？**

注意：您可以在 std::string 和 int 上覆盖 += 以正确格式化字符串，但这不是我想要做的。我想完全禁止在这些操作数上使用此运算符。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-01-05T07:50:58.460

**您不能停用**类的特定功能（此处为 std::basic_string），因为它的接口清楚地（并且正式地）允许该操作。试图重载操作员只会把事情搞砸。

现在，**您可以使用私有继承或组合将 std::basic_string “包装”在另一个类**中，然后使用公共接口作为 std::basic_string 部分的代理，但只能使用您希望使用的函数。

我建议首先用 typedefs 替换你的字符串类型：

```
namespace myapp
{
    typedef std::string String;
    typedef std::wstring UTFString;
} 
```

然后，一旦您的应用程序在将 std::string 和 std::wstring 替换为 myapp::String 和 myapp::UTFString （这些是示例名称）后编译良好，您就可以在某处定义包装类：

```
namespace myapp
{
/** std::basic_string with limited and controlled interface.
    */
    template< class _Elem, class _Traits, class _Ax >
    class limited_string 
    {
    public:
        typedef std::basic_string< _Elem , _Traits, _Ax > _String; // this is for easier writing
        typedef limited_string< _Elem, _Traits, _Ax > _MyType; // this is for easier writing

    private:
        _String m_string; // here the real std::basic_string object that will do all the real work!

    public:

        // constructor proxies... (note that those ones are not complete, it should be exactly the same as the original std::basic_string
        // see some STL docs to get the real interface to rewrite)
        limited_string() : m_string {}
        limited_string( const _MyType& l_string ) : m_string( l_string.m_string ) {}
        limited_string( const _Elem* raw_string ) : m_string( raw_string ) {}
        //... etc...

        // operator proxies...
        _MyType& operator= ( const _MyType& l_string ) 
        {
            m_string = l_string.m_string;
        }
        // etc...
        // but we don't want the operator += with int values so we DON'T WRITE IT!

        // other function proxies...
        size_t size() const { return m_string.size(); } // simply forward the call to the real string!
        // etc...you know what i mean...

        // to work automatically with other STL algorithm and functions we add automatic conversion functions:
        operator const _Elem*() const { return m_string.c_str(); } 

        // etc..        

    };
} 
```

...然后，您只需替换这些行：

```
// instead of those lines...
    //typedef std::string String; 
    //typedef std::wstring UTFString;

    // use those ones
    typedef limited_string< char, std::char_traits<char>, std::allocator<char> >                String; // like std::string typedef
    typedef limited_string< wchar_t, std::char_traits<wchar_t>, std::allocator<wchar_t> >       UTFString; // like std::wstring typedef 
```

...您的示例将崩溃：

```
error C2676: binary '+=' : 'myapp::UTFString' does not define this operator or a conversion to a type acceptable to the predefined operator
error C2676: binary '+=' : 'myapp::String' does not define this operator or a conversion to a type acceptable to the predefined operator 
```

这是我为证明这一点而编写的完整测试应用程序代码（在 vc9 上编译）：

```
#include <string>
#include <iostream>

namespace myapp
{

    /** std::basic_string with limited and controlled interface.
    */
    template< class _Elem, class _Traits, class _Ax >
    class limited_string 
    {
    public:
        typedef std::basic_string< _Elem , _Traits, _Ax > _String; // this is for easier writing
        typedef limited_string< _Elem, _Traits, _Ax > _MyType; // this is for easier writing

    private:
        _String m_string; // here the real std::basic_string object that will do all the real work!

    public:

        // constructor proxies... (note that those ones are not complete, it should be exactly the same as the original std::basic_string
        // see some STL docs to get the real interface to rewrite)
        limited_string() : m_string {}
        limited_string( const _MyType& l_string ) : m_string( l_string.m_string ) {}
        limited_string( const _Elem* raw_string ) : m_string( raw_string ) {}
        //... etc...

        // operator proxies...
        _MyType& operator= ( const _MyType& l_string ) 
        {
            m_string = l_string.m_string;
        }
        // etc...
        // but we don't want the operator += with int values so we DON'T WRITE IT!

        // other function proxies...
        size_t size() const { return m_string.size(); } // simply forward the call to the real string!
        // etc...you know what i mean...

        // to work automatically with other STL algorithm and functions we add automatic conversion functions:
        operator const _Elem*() const { return m_string.c_str(); } 

        // etc..        

    };

    // instead of those lines...
    //typedef std::string String; 
    //typedef std::wstring UTFString;

    // use those ones
    typedef limited_string< char, std::char_traits<char>, std::allocator<char> >                String; // like std::string typedef
    typedef limited_string< wchar_t, std::char_traits<wchar_t>, std::allocator<wchar_t> >       UTFString; // like std::wstring typedef 
}

int main()
{
    using namespace myapp;

    int age = 27;

    UTFString str = UTFString(L"User's age is: ");
    str += age; // compilation error!
    std::wcout << str << std::endl;

    String str2 = String("User's age is: ");
    str2 += age; // compilation error!
    std::cout << str2 << std::endl;

    std::cin.ignore();

    return 0;
} 
```

我认为它可以彻底解决您的问题，但您必须包装所有功能。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-01-05T09:07:33.940

大多数源代码控制系统允许您在签入期间对代码运行完整性检查。因此，您可以设置一个测试来执行验证并在失败时拒绝签入：

例子：

测试脚本：

```
#!/bin/tcsh
# Pass the file to test as the first argument.

echo "#include <string>\
void operator+=(std::string const& , int const&);\
void operator+=(std::string const& , int);"\
| cat - $1 \
| g++ -c -x c++ -  >& /dev/null

echo $status 
```

这个脚本伪造了上面两个运算符的添加（实际上没有改变源）。即使原始代码编译，这将导致使用带有字符串和字符的 operator+ 失败。

注意：operator+= 从 litb 窃取的想法。谁已经删除了他的例子。但是应该归功于它。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-01-05T09:29:58.497

There is no easy way to prevent it, but there is an easy way to find it. Write a small program that uses this operator, then look at the mangled symbol for the operator+= you want to disallow. This symbol is a unique string. As part of your automated tests, use DUMPBIN (or the equivalent Linux/Mac tool) to check whether this mangled symbol is present in your object files.

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-01-05T07:00:32.683

1) 创建一个您自己的字符串类，该类继承/包含`std::string`.

2）在这个类中重载`operator+=(int val)`并使其私有。

3) 将此类用于所有字符串操作。

每当您执行以下操作时，这都会使编译器标记错误：

```
MyString str;
str += 27; 
```

# security - 银行/金融网站实现临时交易密码的最佳实践/算法/方法

> ID：412440
> 
> 赞同：-1
> 
> 时间：2009-01-05T06:46:37.390
> 
> 标签：security, passwords

为网站实施临时交易密码功能的最佳做法是什么？

例如，在银行/金融场景中，例如 - 将资金从一个账户转移到另一个账户时，需要交易密码 - 进行交易时，需要交易密码 - 等等。

密码应该是临时的并且是基于时间的，即这个密码在 x 分钟后不应该工作。

你会推荐什么算法？您是否建议跟踪使用过的密码，即在某个商店中存储使用过的密码？

一些网站使用 OneTimePassword 设备。除此之外，请强调您认为可能合适的任何其他策略。

欢迎任何其他想法/建议/算法。

编辑：基于来自“lassevk”的问题

1.  密码将通过电子邮件/电话/短信传达。
2.  不涉及第三个站点。

我需要这个来为应用程序中的关键点提供额外的安全级别。这也可以称为“AuthenticationCode”。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-01-05T07:01:21.603

**更新问题后编辑**：

好吧，一种方法是将其简单地存储在会话变量中，这将使其在服务重新启动时强制消失。

此外，您需要在其上设置一个计时器，基本上您将过期时间+密码存储在某处，并且每当您检查密码时，如果过期时间是过去，您就没有密码，只需将其清除即可。

如果您将其封装在一些基本代码中，不仅检查是否给出了正确的密码，那么它需要能够回答*yes*、*no*和*no 密码*，以便您可以向用户提供适当的消息。

* * *

几个问题：

*   您将如何将临时密码传达给用户？短信？
*   是同一个站点的密码，还是为另一个链接的站点创建的？（即，您的银行主站点生成或获取密码，您使用该密码登录或授权另一个相关站点上的交易？）

如果答案是：

*   通过网站
*   不，同一个网站

那有什么意义呢？你希望从中获得什么？实现此功能的具体标准或目标是什么？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-05T07:08:20.217

嗯 它确实因机构而异

基于会话创建财务 PIN 将是更安全的策略，而不是创建适用于特定时间段的 FPIN。

如果您有资源向 FPIN 发送短信，那么最佳做法是在每次交易之前生成 FPIN，并将 FPIN 发送给用户，这类似于 2FA。

问候阿泽姆。

# embedded - 嵌入式+实时开发培训建议

> ID：412444
> 
> 赞同：11
> 
> 时间：2009-01-05T06:52:13.870
> 
> 标签：embedded, real-time

我目前正在学习嵌入式实时工程的职业。但是发现很难找到好的培训材料。尤其是因为您无法像使用桌面应用程序开发那样体验嵌入式开发。

是否有任何书籍和/或工具包可用于基础培训？对学习 RTOS 有什么建议吗？

使用 RTOS 时有什么建议吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-01-05T10:15:33.863

这真是一门复杂的学科，有太多的选择和取舍。

* * *

在硬件方面，我会选择低端的微控制器，因为当它们变得更小时，事情往往会变得更容易，并且离桌面越远，你就越了解嵌入式编程的思维方式。

由于您在日本，因此最好在当地查看流行的控制器，这样您就可以获得良好的社区支持并可以轻松购买零件。

在德国这里是 AVR ATMEGA，我认为这是一个不错的选择。它得到了 GNU 工具的最佳支持，它以 DIP 封装形式提供，并且可以使用其内部振荡器运行，因此可以轻松地在面包板上运行。最大的障碍是我需要一个 ISP 程序员。有一个很好的德语[教程](http://www.mikrocontroller.net/articles/AVR-Tutorial)。

我还有一台瑞萨的 R8C，它在日本可能更受欢迎。让 GNU 工具运行起来更加困难，我必须自己从源代码构建它们。对于 MS-Windows，有免费的 IAR Kickstart 套件，代码大小限制为 4KB。它可以使用串行接口（但具有 TTL 电平）进行编程，为此我有一个 FTDI USB 转串行模块。

* * *

至于 RTOS，看看 OSEK，有几个免费的实现。它可以用于非常小的控制器。

您也可以自己编写一个基本的 RTOS，这并不难，而且您学得最多。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-05T08:20:15.203

您无需学习特定的 RTOS，有数以万计的嵌入式 RTOS 被细分到市场细分市场，即使您知道您要从事的确切细分市场，仍然有很多操作系统在同一细分市场中运行。
重要的是要了解操作系统的基本概念，并且有很强的 C 背景。当我们招聘时（我们是嵌入式开发公司），我们不需要任何嵌入式编程或特定操作系统方面的特定知识。我们正在寻找能够编写完美 C 代码并能够学习的聪明人。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-08T16:25:40.700

用自己的双手玩硬件和软件别无选择。幸运的是，这很容易实现。AVR 芯片的简单开发板可以在线购买几十美元（如[STK500](http://avrwiki.com/wiki/index.php/STK500)或[Arduino](http://www.arduino.cc/)），并且它们的整个软件工具链是开放和可下载的。

关于操作系统 - 在没有操作系统的情况下开始！许多嵌入式代码在没有操作系统的情况下运行，这也是开始编程的最佳方式。通过尝试编写非操作系统代码的各种技术，您将学会了解何时以及为什么需要操作系统，以及如何最好地使用它。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-05-08T14:27:04.283

我会推荐 Quantum Leaps Platform 和 Quantum Framework。这是一个复杂的状态机环境，需要极低的占用空间。它也可以在 Windows 上运行（用于学习它）。

[量子飞跃网站](http://www.state-machine.com)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-08-03T12:09:45.793

您首先需要弄清楚您想了解嵌入式系统的哪些内容。

*) 硬件细节 *) 操作系统 *) 应用程序编程 *) 开发板 *) 小型微控制器 *) Linux

...还有更多选择...

我会决定完成某个嵌入式项目并购买/学习相关技术。

# javascript - 对于 IE 中的每个 JavaScript 支持？

> ID：412447
> 
> 赞同：36
> 
> 时间：2009-01-05T06:56:04.297
> 
> 标签：javascript

我有这个代码：

```
<script>
function toggle(source) {

  checkboxes = document.getElementsByName('DG1');
  for each(var checkbox in checkboxes)
    checkbox.checked = source.checked;

  checkboxes = document.getElementsByName('DG2');
  for each(var checkbox in checkboxes)
    checkbox.checked = source.checked;

  checkboxes = document.getElementsByName('DG3');
  for each(var checkbox in checkboxes)
    checkbox.checked = source.checked;

  checkboxes = document.getElementsByName('DG4');
  for each(var checkbox in checkboxes)
    checkbox.checked = source.checked;

  checkboxes = document.getElementsByName('DG5');
  for each(var checkbox in checkboxes)
    checkbox.checked = source.checked;
}
</script>

<input type="checkbox" onClick="toggle(this)" />Select All<br/>

<form method=POST action="DGUsageServlet">
    <input type="checkbox" name="DG1">DG1</input>
    <input type="checkbox" name="DG2">DG2</input>
    <input type="checkbox" name="DG3">DG3</input>
    <input type="checkbox" name="DG4">DG4</input>
    <input type="checkbox" name="DG5">DG5</input>
</form> 
```

如何使上述脚本在 IE 中工作？

* * *

## 回答 #1

> 赞同：46
> 
> 时间：2009-01-05T07:15:18.707

请注意，Firefox 不再支持每个循环，因此这适用于*每个*浏览器，而不仅仅是 Internet Explorer。[有关替代方案，请参阅此 MDN 文章](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Errors/For-each-in_loops_are_deprecated)。

* * *

Internet Explorer 不支持“for each”循环（以及其他已放弃对它们的支持的现代浏览器）。您需要更改代码以使用常规 for 循环：

```
function toggle(source) {
    var checkboxes = document.getElementsByName('DG1');
    for (var i = 0; i < checkboxes.length; i++) {
        checkboxes[i].checked = source.checked;
    }
    ...
} 
```

或者，您可以使用像 jQuery 这样的库并这样做：

```
function toggle(source) {
    $("input[name^=DG]").attr("checked", source.checked);
} 
```

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2009-07-18T12:07:55.260

或者您可以尝试为不支持 foreach 方法的浏览器扩展 Array 对象，如下所示： [https ://developer.mozilla.org/En/Core_JavaScript_1.5_Reference:Objects:Array:forEach#Compatibility](https://developer.mozilla.org/En/Core_JavaScript_1.5_Reference:Objects:Array:forEach#Compatibility)

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2013-05-27T09:41:58.280

我认为**jQuery.each**是最好的解决方案

```
var idArr = ["LocationFirst","LocationSecond","LocationThird","LocationFourth","LocationFifth"];

 $.each(idArr,function(index, entry) {
   //some code
 }); 
```

它将遍历数组“idArr”中的所有元素，并且可以对每个元素做一些事情。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2013-02-05T18:08:34.077

**本机 IE8 对于foreach**来说已经过时了，但是我该如何使用 jQuery，我选择了**jQuery.each**来克服这个问题。

我从 jQuery API Doc 复制和粘贴：

```
var obj = {
   "flammable", "inflammable"
   "duh": "no duh"
};
$. each (obj, function (key, value) {
   alert (key + ":" + value);
}); 
```

[http://api.jquery.com/jQuery.each/](http://api.jquery.com/jQuery.each/)

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2010-09-30T20:48:58.753

可以在 Internet Explorer 中使用 for each 的修改形式，语法如下。

```
var checkboxes = document.getElementsByName('DG2');
for (var i in checkboxes)
  checkboxes[i].checked = 'true'; 
```

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2016-11-08T13:49:11.583

我在 IE 11 上遇到了 forEach 的问题

我找到了这样的解决方案

```
Array.prototype.slice.call(document.getElementsByName('element_name')).forEach(function (el) {
    if (el.checked) {
       console.log('checked');
    } 
```

它对我有用。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-01-05T07:20:28.787

要完成 Matthew Crumley 的回答，您可能还会遇到`getElementByName()`IE 失败的问题，解释[如下](http://jszen.blogspot.com/2004/07/whats-in-name.html)：

> 很少使用的`getElementsByName()`方法是 DOM Level 1 规范的一部分，并且受到 Internet Explorer 和 Mozilla/Firefox 的支持。getElementsByName()
> 
> 根据 HTML 4.01 规范，支持 NAME 属性的唯一元素是`BUTTON, TEXTAREA, APPLET, SELECT, FORM, FRAME, IFRAME, IMG, A, INPUT, OBJECT, MAP, PARAM and META`. 所以把 a 放在 a`NAME`里面`DIV`实际上是无效的 HTML。

（所以它适用于你的情况（`NAME`一个`INPUT`字段），但在 IE 中使用它是不安全的）

> Moz/Firefox 对此没有任何问题，并且会愉快地返回所有三个 DIV 元素。但 MSIE 将其无效`NAME`属性视为[扩展属性](http://msdn.microsoft.com/workshop/author/dhtml/reference/properties/expando.asp)并排除这些元素

[这个脚本](http://www.dreamincode.net/code/snippet293.htm)给出了一个可能的修复。

* * *

注意：当您编写 a 时`for`，总是添加然后括起花括号`{ and }`：这样更安全。如果您在循环中添加第二行代码，该块将考虑它`for`。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2020-04-20T10:18:42.557

您可以使用：

```
[].slice.call(...).forEach(...); 
```

例子：

```
[].slice.call( document.querySelectorAll('h1') ).forEach(function(h1) { 
    console.log(h1);
}); 
```

或者最好加一次：

```
// make IE9+ support forEach:
if (window.NodeList && !NodeList.prototype.forEach) 
    NodeList.prototype.forEach = Array.prototype.forEach; 
```

然后总是使用紧凑的语法：

```
document.querySelectorAll('h1').forEach(function(h1) { 
    console.log(h1);
}); 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-01-05T20:00:23.183

我会清理一下。

```
function select(){
    var butt = document.getElementById('selectall');
    butt.onclick = selectall;

    function selectall(){
        for(var i=1;i<6;i++){
            var id='DG'+i;
            var all = document.getElementById(id);
            all.setAttribute('checked','checked');
        }
    }   
} 
```

但它仅适用于 getElementById()（而不是 getElementsByName()，我不明白）。只需添加到每个输入 id='selectall', id='DG1'...

# javascript - 如何使用 JQuery Ajax REST 从 flickr flickr.test.echo 方法发送和检索数据？

> ID：412450
> 
> 赞同：2
> 
> 时间：2009-01-05T06:58:09.753
> 
> 标签：javascript, jquery, ajax, rest, flickr

我想使用 rest 显示 flickr.test.echo 的响应在页面上（jquery ajax - 因为这就是我使用的）

我需要提供一个 api_key

* * *

REST 端点 URL 是[http://api.flickr.com/services/rest/](http://api.flickr.com/services/rest/)

要请求 flickr.test.echo 服务，调用如下：

[http://api.flickr.com/services/rest/?method=flickr.test.echo&name=value](http://api.flickr.com/services/rest/?method=flickr.test.echo&name=value)

默认情况下，REST 请求将发送一个 REST 响应。

要以 REST 格式返回响应，请在请求中发送参数“format”，其值为“rest”。使用 REST 请求方法时，响应默认为 REST。

方法调用返回：

[xml-payload-这里]

如果发生错误，则返回以下内容：

我从这里得到了[http://www.flickr.com/services/api/request.rest.html](http://www.flickr.com/services/api/request.rest.html)

* * *

这是我感兴趣的方法[http://www.flickr.com/services/api/flickr.test.echo.html](http://www.flickr.com/services/api/flickr.test.echo.html)

请帮忙。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-05T16:49:21.760

我不确定您将如何使用 Ajax 检索他们的数据，因为 Ajax 不能跨域工作。

你看过他们的 $.getJSON 演示吗？ [http://docs.jquery.com/Ajax/jQuery.getJSON](http://docs.jquery.com/Ajax/jQuery.getJSON)

它允许您指定回调并返回包装为自动生成函数内的参数的 json。它也可以跨域工作。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-05T17:17:09.800

使用[Flickr 的 JSON 格式](http://www.flickr.com/services/api/response.json.html)API 并`jQuery.getJSON`像 sktrdie 建议的那样 - 只需记住附加`callback=?`到 url 以将其包装在[JSONP](http://ajaxian.com/archives/jsonp-json-with-padding)中。

从[jQuery.getJSON](http://docs.jquery.com/Ajax/jQuery.getJSON)文档：

```
$.getJSON("http://api.flickr.com/services/feeds/photos_public.gnetags=cat&tagmode=any&format=json&callback=?",
    function(data){
      $.each(data.items, function(i,item){
        $("<img/>").attr("src", item.media.m).appendTo("#images");
        if ( i == 4 ) return false;
      });
    }); 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-26T19:32:50.603

我只会使用[jQuery-Flickr 插件](http://code.google.com/p/jquery-flickr/)，容易得多！:)

# f# - 如何一般地删除 F# 度量单位

> ID：412459
> 
> 赞同：4
> 
> 时间：2009-01-05T07:01:02.243
> 
> 标签：f#, units-of-measurement

我有一些数据操作代码，最后会吐出 csv。

我开始升级它以在任何地方添加度量单位，但现在我的 csv 函数出现问题：

```
val WriteCSV : string -> 'a list array -> 'b list -> string -> unit 
```

（参数为文件名、列数组、列标题、分隔符）

在我之前将 [|s;x;y|] 发送到 WriteCSV 的地方，我现在遇到了问题，因为我无法发送 [|skm; 毫米; 嗯|]。

我尝试编写一个用于一般删除度量单位的函数，但它不起作用。

```
let removeUnit (n:float<_>) = n/1.0<_> 
```

我的问题是：

*   为什么它不起作用？
*   它可以工作吗？
*   有没有另一种方法来解决这个特定的问题？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-01-05T07:49:59.260

如果我的问题正确，则将其转换为“纯”浮点数会删除该单元。例如：

```
[<Measure>] type m
[<Measure>] type km

let removeUnit (x:float<_>) =
    float x

let foo = removeUnit 2.6<m>
let foo2 = removeUnit 2.1<km> 
```

> val removeUnit : 浮动<'u> -> 浮动

# asp.net - ASP.Net 会话超时：为什么默认使用 20 分钟？

> ID：412462
> 
> 赞同：0
> 
> 时间：2009-01-05T07:04:13.487
> 
> 标签：asp.net, session, session-timeout

在 ASP.Net 中，默认会话超时设置为 20 分钟。为什么这样？背后有什么具体原因吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-01-05T07:32:20.933

> 不应将其设置为高于 20 分钟（特殊情况除外），因为每个打开的会话都会占用内存。

来自[MSDN 网站上的 Session.Timeout](http://msdn.microsoft.com/en-us/library/ms525473.aspx)
注意他们还给出了最小的解释

> 它也不应设置为低于 4 分钟，因为客户端很少在该时间内响应，从而导致会话状态丢失。

希望这可以帮助...

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-05T07:37:24.387

嗯：10分钟太快了。30分钟太长了。15、25分钟——数字不漂亮。所以，他们决定在 20 ：P

数字 20 没有什么神奇的含义。它只是被确定为会话超时的最佳和最漂亮的值。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-05T07:51:39.927

如果您的用户较少，或者如果您将会话状态保存到数据库，则较大的超时不会消耗太多资源。

# php - 如何在 PHP 中嵌入 YouTube 视频？

> ID：412467
> 
> 赞同：58
> 
> 时间：2009-01-05T07:12:32.877
> 
> 标签：php, html, video, youtube, youtube-api

如果我们只有 URL 或嵌入代码，谁能告诉我如何*显示或嵌入 YouTube 视频？*

* * *

## 回答 #1

> 赞同：92
> 
> 时间：2009-01-05T07:30:25.540

您必须要求用户存储 youtube 视频中的 11 个字符代码。

例如[http://www.youtube.com/watch?v=Ahg6qcgoay4](http://www.youtube.com/watch?v=Ahg6qcgoay4)

十一个字符代码为：Ahg6qcgoay4

然后，您获取此代码并将其放入您的数据库中。然后，无论您想在页面中放置 youtube 视频的何处，从数据库中加载角色并输入以下代码：-

例如对于 Ahg6qcgoay4 它将是：

```
<object width="425" height="350" data="http://www.youtube.com/v/Ahg6qcgoay4" type="application/x-shockwave-flash"><param name="src" value="http://www.youtube.com/v/Ahg6qcgoay4" /></object> 
```

* * *

## 回答 #2

> 赞同：53
> 
> 时间：2009-04-09T11:03:07.060

不要将嵌入代码存储在您的数据库中——YouTube 可能会不时更改嵌入代码和 URL 参数。例如，`<object>`嵌入代码已被淘汰，取而代之的是`<iframe>`嵌入代码。您应该从 URL/嵌入代码中解析出视频 ID（使用正则表达式、URL 解析函数或 HTML 解析器）并存储它。然后使用 YouTube API 当前提供的任何机制显示它。

一个简单的提取视频 id 的 PHP 示例如下：

```
<?php
    preg_match(
        '/[\\?\\&]v=([^\\?\\&]+)/',
        'http://www.youtube.com/watch?v=OzHvVoUGTOM&feature=channel',
        $matches
    );
    // $matches[1] should contain the youtube id
?> 
```

我建议您查看这些文章以了解如何处理这些 id：

*   [使用 IFrame Embeds 嵌入 YouTube 视频、播放列表等](http://salman-w.blogspot.com/2012/07/youtube-iframe-embeds-video-playlist-and-html5.html)

要创建您自己的 YouTube 视频播放器：

*   [YouTube 嵌入式播放器参数](https://developers.google.com/youtube/player_parameters)
*   [YouTube JavaScript 播放器 API 参考](https://developers.google.com/youtube/js_api_reference)

* * *

## 回答 #3

> 赞同：17
> 
> 时间：2011-09-29T22:36:16.777

从长短的 youtube 网址中，您可以通过以下方式获得嵌入：

```
$ytarray=explode("/", $videolink);
$ytendstring=end($ytarray);
$ytendarray=explode("?v=", $ytendstring);
$ytendstring=end($ytendarray);
$ytendarray=explode("&", $ytendstring);
$ytcode=$ytendarray[0];
echo "<iframe width=\"420\" height=\"315\" src=\"http://www.youtube.com/embed/$ytcode\" frameborder=\"0\" allowfullscreen></iframe>"; 
```

希望它可以帮助某人

* * *

## 回答 #4

> 赞同：13
> 
> 时间：2015-12-20T14:14:44.000

根据[HTML Youtube Videos](http://www.w3schools.com/html/html_youtube.asp)不推荐使用`<object>`and标签，最好使用标签来这样做。`<embed>``<iframe>`

```
<iframe width="420" height="315"
src="http://www.youtube.com/embed/XGSy3_Czz8k?autoplay=1">
</iframe> 
```

为了让您的用户不会花费一生的时间试图在链接中找到视频 ID 以将其放入您的表单字段，让他们发布他们在 youtube 上找到的视频的链接，您可以使用以下正则表达式来获取视频 ID ：

```
preg_match("/^(?:http(?:s)?:\/\/)?
    (?:www\.)?(?:m\.)?(?:youtu\.be\/|youtube\.com\/(?:(?:watch)?\?(?:.*&)?v(?:i)?=|
    (?:embed|v|vi|user)\/))([^\?&\"'>]+)/", $url, $matches); 
```

要获取视频 ID，您可以获取它`$matches[1]`，这些将匹配：

*   youtube.com/v/vidid
*   youtube.com/vi/vidid
*   youtube.com/?v=vidid
*   youtube.com/?vi=vidid
*   youtube.com/watch?v=vidid
*   youtube.com/watch?vi=vidid
*   youtu.be/vidid
*   youtube.com/embed/vidid
*   [http://youtube.com/v/vidid](http://youtube.com/v/vidid)
*   [http://www.youtube.com/v/vidid](http://www.youtube.com/v/vidid)
*   [https://www.youtube.com/v/vidid](https://www.youtube.com/v/vidid)
*   youtube.com/watch?v=vidid&wtv=wtv
*   [http://www.youtube.com/watch?dev=inprogress&v=vidid&feature=related](http://www.youtube.com/watch?dev=inprogress&v=vidid&feature=related)
*   [https://m.youtube.com/watch?v=vidid](https://m.youtube.com/watch?v=vidid)

@shawn 在这个问题的回答中提到了这个答案的[一部分](https://stackoverflow.com/questions/3392993/php-regex-to-get-youtube-video-id)。

* * *

## 回答 #5

> 赞同：7
> 
> 时间：2009-01-08T07:25:22.460

之后使用正则表达式提取“视频ID”`watch?v=`

将视频 id 存储在一个变量中，我们称这个变量为`vid`

从随机视频中获取嵌入代码，从嵌入代码中删除视频 id 并将其替换为`vid`您获得的。

我不知道如何处理 php 中的正则表达式，但应该不会太难

这是python中的示例代码：

```
>>> ytlink = 'http://www.youtube.com/watch?v=7-dXUEbBz70'
>>> import re
>>> vid = re.findall( r'v\=([\-\w]+)', ytlink )[0]
>>> vid
'7-dXUEbBz70'
>>> print '''<object width="425" height="344"><param name="movie" value="http://www.youtube.com/v/%s&hl=en&fs=1"></param><param name="allowFullScreen" value="true"></param><param name="allowscriptaccess" value="always"></param><embed src="http://www.youtube.com/v/%s&hl=en&fs=1" type="application/x-shockwave-flash" allowscriptaccess="always" allowfullscreen="true" width="425" height="344"></embed></object>''' % (vid,vid)
<object width="425" height="344"><param name="movie" value="http://www.youtube.com/v/7-dXUEbBz70&hl=en&fs=1"></param><param name="allowFullScreen" value="true"></param><param name="allowscriptaccess" value="always"></param><embed src="http://www.youtube.com/v/7-dXUEbBz70&hl=en&fs=1" type="application/x-shockwave-flash" allowscriptaccess="always" allowfullscreen="true" width="425" height="344"></embed></object>
>>> 
```

正则表达式`v\=([\-\w]+)`捕获后面的（子）字符串和破折号`v=`

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2011-12-11T02:03:38.780

这是我编写的一些代码，用于自动将 URL 转换为链接并自动嵌入来自 youtube 的任何视频 URL。我为我正在开发的聊天室制作了它，效果很好。我相信它可以很好地用于任何其他目的，例如博客。

您所要做的就是调用函数“autolink()”并将要解析的字符串传递给它。

例如包含下面的函数，然后回显此代码。

```
`
echo '<div id="chat_message">'.autolink($string).'</div>';

/****************Function to include****************/

<?php

function autolink($string){
    // force http: on www.
    $string = str_ireplace( "www.", "http://www.", $string );
    // eliminate duplicates after force
    $string = str_ireplace( "http://http://www.", "http://www.", $string );
    $string = str_ireplace( "https://http://www.", "https://www.", $string );

    // The Regular Expression filter
    $reg_exUrl = "/(http|https|ftp|ftps)\:\/\/[a-zA-Z0-9\-\.]+\.[a-zA-Z]{2,3}(\/\S*)?/";
    // Check if there is a url in the text

$m = preg_match_all($reg_exUrl, $string, $match); 

if ($m) { 
$links=$match[0]; 
for ($j=0;$j<$m;$j++) { 

    if(substr($links[$j], 0, 18) == 'http://www.youtube'){

    $string=str_replace($links[$j],'<a href="'.$links[$j].'" rel="nofollow" target="_blank">'.$links[$j].'</a>',$string).'<br /><iframe title="YouTube video player" class="youtube-player" type="text/html" width="320" height="185" src="http://www.youtube.com/embed/'.substr($links[$j], -11).'" frameborder="0" allowFullScreen></iframe><br />';

    }else{

    $string=str_replace($links[$j],'<a href="'.$links[$j].'" rel="nofollow" target="_blank">'.$links[$j].'</a>',$string);

        } 

    } 
} 

               return ($string);
 }

?> 
```

`

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2009-01-05T07:18:48.980

如果您想以编程方式上传视频，请查看[YouTube 数据 API](http://code.google.com/apis/youtube/overview.html) for [PHP](http://code.google.com/apis/youtube/1.0/developers_guide_php.html)

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2009-08-14T22:22:57.333

搜索同一主题时，我发现了另一种使用 Javascript 和 Youtube API 的方法

直接来自：[http ://code.google.com/apis/ajax/playground/#simple_embed](http://code.google.com/apis/ajax/playground/#simple_embed)

加载 API

```
<script src="http://www.google.com/jsapi" type="text/javascript"></script> 
```

并执行以下 javascript 代码：

```
 google.load("swfobject", "2.1");
  function _run() {

    var videoID = "ylLzyHk54Z0"
    var params = { allowScriptAccess: "always" };
    var atts = { id: "ytPlayer" };
    // All of the magic handled by SWFObject (http://code.google.com/p/swfobject/)
    swfobject.embedSWF("http://www.youtube.com/v/" + videoID + "&enablejsapi=1&playerapiid=player1",
                       "videoDiv", "480", "295", "8", null, null, params, atts);

  }
  google.setOnLoadCallback(_run); 
```

完整示例在前面提到的页面[http://code.google.com/apis/ajax/playground](http://code.google.com/apis/ajax/playground)

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2015-03-10T04:11:56.627

您可以使用 Joomla 轻松完成此操作。让我假设一个示例 YouTube URL - [https://www.youtube.com/watch?v=ndmXkyohT1M](https://www.youtube.com/watch?v=ndmXkyohT1M)

```
<?php 
$youtubeUrl =  JUri::getInstance('https://www.youtube.com/watch?v=ndmXkyohT1M');
$videoId = $youtubeUrl->getVar('v'); ?>

<iframe id="ytplayer" type="text/html" width="640" height="390"  src="http://www.youtube.com/embed/<?php echo $videoId; ?>"  frameborder="0"/> 
```

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2009-02-05T16:08:18.423

您可以简单地创建一个 php 输入表单`Varchar date`，给它一个`varchar`长度让我们说 300。然后要求用户复制并粘贴嵌入代码。当您查看记录时，您将查看流式视频。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2012-09-02T22:05:14.923

只是对 Alec Smart 答案的一个小更新：由于现在不推荐使用 AS2，因此需要“？version = 3”才能使他的示例正常工作。有关详细信息，请参阅“选择要播放的内容”下的[YouTube 嵌入式播放器和播放器参数](https://developers.google.com/youtube/player_parameters, "YouTube 嵌入式播放器和播放器参数")中的 Youtube 参考。

换句话说：

```
<object width="425" height="350" data="http://www.youtube.com/v/Ahg6qcgoay4?version=3" type="application/x-shockwave-flash"><param name="src" value="http://www.youtube.com/v/Ahg6qcgoay4?version=3" /></object> 
```

显然，上面的 Youtube 参考按如下方式执行此操作（内部嵌入可能用作尚不支持 object 标签的浏览器的后备）：

```
<object width="640" height="390">
  <param name="movie"
         value="https://www.youtube.com/v/u1zgFlCw8Aw?version=3&autoplay=1"></param>
  <param name="allowScriptAccess" value="always"></param>
  <embed src="https://www.youtube.com/v/u1zgFlCw8Aw?version=3&autoplay=1"
         type="application/x-shockwave-flash"
         allowscriptaccess="always"
         width="640" height="390"></embed>
</object> 
```

或使用 iframe（将[http://example.com](http://example.com)替换为您网站的域）：

```
<iframe id="ytplayer" type="text/html" width="640" height="390" src="http://www.youtube.com/embed/u1zgFlCw8Aw?autoplay=1&origin=http://example.com" frameborder="0"/> 
```

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2009-01-05T07:29:49.753

亲爱的男孩，

如果我理解清楚，用户提供 Youtube 视频的 URL/代码，然后该视频会显示在页面上。

为此，只需编写一个带有布局等的简单页面。从 youtube 复制视频嵌入代码并将其粘贴到您的页面中。将嵌入代码替换为某个字段，例如 VideoID。将此 VideoId 设置为您的用户提供的代码。

编辑：查看 Alec Smart 的回答。

* * *

## 回答 #13

> 赞同：-1
> 
> 时间：2014-01-28T16:37:59.100

这个[YouTube 嵌入生成器](http://online-marketing-technologies.com/tools/youtube-embed-code-generator.html)解决了我所有的视频嵌入问题。

# python - 在 Python 中使用 mocking 测试派生类

> ID：412472
> 
> 赞同：4
> 
> 时间：2009-01-05T07:16:34.833
> 
> 标签：python, mocking

我的代码如下所示：

```
import xmlrpclib

class Base(object):
    def __init__(self, server):
        self.conn = xmlrpclib.ServerProxy(server)

    def foo(self):
        return self.conn.do_something()

class Derived(Base):
    def foo(self):
        if Base.foo():
            return self.conn.do_something_else() 
```

我应该如何使用模拟来测试`Derived`类的行为？我不想假设 XML-RPC 连接所涉及的任何内容都将实际存在，但我觉得`xmlrpclib`模拟模块需要对类的实现有太多了解`Base`（我有其他测试）。

或者，我想，我什至应该使用模拟来测试这个吗？如果没有，你将如何测试它？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-05T08:33:05.990

您可以创建一个假的 ServerProxy 类，并将其替换为测试。

像这样的东西：

```
class FakeServerProxy(object):
    def __init__(self, server):
        self.server = server
    def do_something(self):
        pass
    def do_something_else(self):
        pass

def test_derived():
    xmlrpclib.ServerProxy = FakeServerProxy
    derived = Derived(None)
    derived.foo() 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-27T23:14:50.847

通过一些简单的重构（提取调用`do_something_else`），您可以测试`Derived.foo`逻辑而无需“了解”XMLRPC。

```
import xmlrpclib

class Base(object):
    def __init__(self, server):
        self.conn = xmlrpclib.ServerProxy(server)

    def foo(self):
        return self.conn.do_something()

class Derived(Base):
    def foo(self):
        if Base.foo(self):
            return self._bar()
    def _bar(self):
        # moved to its own method so that you
        # you can stub it out to avoid any XMLRPCs
        # actually taking place.
        return self.conn.do_something_else()

import mox

d = Derived('http://deep-thought/unanswered/tagged/life+universe+everything')

m = mox.Mox()
m.StubOutWithMock(Base, 'foo')
m.StubOutWithMock(d, '_bar')
Base.foo(d).AndReturn(True)
d._bar() # Will be called becase Boo.foo returns True.
m.ReplayAll()

d.foo()

m.UnsetStubs()
m.VerifyAll() 
```

或者甚至最好，您可以将调用提取`do_something_else`到`bar`方法 on `Base`。这是有道理的，如果我们同意`Base`封装您的所有 XMLRPC 操作。

该示例使用[pymox 模拟](http://code.google.com/p/pymox/)库，但无论您的模拟风格如何，它的要点都保持不变。

# python - 如何从给定的歌曲文件构建音符？

> ID：412475
> 
> 赞同：2
> 
> 时间：2009-01-05T07:17:31.773
> 
> 标签：python

Python中是否有任何模块可以帮助我们从给定的原始歌曲中构建或获取音符和八度音阶？

谢谢您的帮助

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-05T07:55:53.413

正如 lassevk 所提到的，这是一个复杂的话题——在某种程度上有点像从汇编中重构 C 代码。话虽这么说，一个很好的播放音频的框架是 CLAM：

[http://clam.iua.upf.edu/](http://clam.iua.upf.edu/)

它是一个用于音乐/音频算法原型设计的开源 C++ 框架，但有 python 包装器和用于原型设计的图形工具。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-05T07:34:15.907

这个问题的细节太少，无法给出任何有意义的答案。

问题：

*   歌曲文件是指像 MP3 一样吗？
*   是“歌曲”还是“器乐”？我会收集试图破译声音背后的音符会更难
*   它是一首简单的歌曲吗，就像在钢琴或长笛这样简单的乐器上演奏的单一声音？或者它是一个复杂的，就像电台播放的任何最新热门歌曲一样？

我认为，除了最简单的事情之外，试图从这样的程序中获得好的输出对于任何事情都是极其困难的。

话虽如此，看看快速傅里叶变换，它可以给你一个播放的东西的频谱，但很难从中确定什么是什么。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-05T08:15:43.780

我认为您感兴趣的仍然是研究课题。您将找不到任何可以为您完成此任务的模块。

此外，不清楚您所说的“音符和八度”是什么意思？您想提取什么信息？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-05T11:01:33.320

有一些 Python 库。[从Audio Misc](http://directory.fsf.org/category/audmisc/)的 FSF 列表开始。

但是，也有出色的产品：请参阅[转录！](http://www.seventhstring.com/xscribe/overview.html)和[十二键](http://www.nch.com.au/twelvekeys/)。另请参阅[转录软件列表](http://transcribe.qarchive.org/)。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-09-27T03:56:52.623

[包含在music21](http://web.mit.edu/music21/)中的 Jordi Bartolomé Guillen 的“audioSearch.transcriber”模块可以从单声道声音文件中提供非常准确的转录，因此，如果您正在处理独奏作品（或旋律比伴奏响亮得多的作品），它是一个有用的工具，除了研究特性，您还可以将乐谱输出到 Finale、MuseScore、[Lilypond或 MIDI。](http://www.lilypond.org/)

正如其他人所提到的，对于复音转录，情况要解决得多。最好的作品在[Melodyne 编辑器](http://www.celemony.com/cms/index.php?id=products_editor#top "旋律编辑器")中，但这是一个商业包。我们可能距离该问题的开源解决方案还有 2 到 4 年的时间。

# ide - 2008 趋势：您推荐的最佳 Ultraedit 替代免费文本编辑器

> ID：412477
> 
> 赞同：9
> 
> 时间：2009-01-05T07:19:27.090
> 
> 标签：ide, text-editor, text-files

2008 年已经过去，有新的免费软件或文本编辑器更新可以取代 Ultraedit-32，后者可以说是商业文本编辑器的杀手级应用。

我们都在寻找完美的编辑器，测试它们，比较它们，并最终选择了我们最喜欢的那个。

Ultraedit-32 的强大功能是我们也在替代文本编辑器中寻找的：

*   稳定快速，能够在不牺牲系统资源的情况下打开 GB 大小的文件（AKA 直接文件访问）
*   查找和替换，支持正则表达式。可以在文件之间查找/替换。
*   列编辑，包括选择一个空列并在这些列上的所有行上键入的能力（列编辑的圣杯）。
*   IDE 功能，如语法突出显示、自动完成、自动缩进、模板和源代码导航。
*   文本文件的选项卡式界面。
*   可自定义的字体和颜色

为使本问答非常有用，请注明：

*   文本编辑器名称
*   文本编辑器的操作系统平台
*   网址
*   你的评论

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2009-01-05T08:07:30.847

我使用**[Notepad++](http://notepad-plus.sourceforge.net/uk/site.htm)**，它具有大部分 UltraEdit 功能（Windows 平台）。

但主要原因是部署问题：我知道我可以将它复制到同事的桌面上，他们就可以开始使用它了。不涉及设置或注册表调整。它实际上是[便携式应用程序](http://portableapps.com/apps/development/notepadpp_portable)之一。

[Scintilla 组件](http://en.wikipedia.org/wiki/Scintilla_(editing_component))的集成现在相当稳定。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-01-05T09:31:05.763

对我来说，它是 emacs，我总是回到它。

几乎可以在任何操作系统上使用。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-01-05T09:45:26.267

很久以前，我从 UE 切换到[**Crimson 编辑器**](http://www.crimsoneditor.com/)（但最新版本 3.72 可在 Source Forge 的[**Emerald Editor**](https://sourceforge.net/projects/emeraldeditor/)项目下获得）。

然后最近我在或多或少地测试了目前可用的所有免费编辑器后切换到[**PSpad 。**](http://www.pspad.com/en/)这是最适合我需要的一个。

为了完整起见，很长一段时间以来，我一直在各种平台上使用 MicroEmacs，主要是 Unix，还有 Amiga 和 MSDOS。它仍然作为[**Jasspa MicroEmacs 存在**](http://www.jasspa.com/) ，即使我认为它是一个很棒的编辑器，我也不愿意回到基于字符的界面（我的错）。

所有这些编辑器都是可编写脚本的，并具有语法高亮和其他功能，但它们都不能替代该语言的完整 IDE。最值得注意的是，使用编辑器时，您会错过符号交叉引用来回答诸如“此函数在哪里定义？”之类的问题。或“这个变量在哪里引用？”。对于这样的事情，我使用[**Source Navigator NG**](http://sourcenav.berlios.de/)，它在创建完整的交叉引用数据库方面做得很好。它也有一些编辑功能，但我不会依赖它们！

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-01-05T09:56:24.073

[作为 Mac 上TextMate](http://macromates.com/)的长期用户，我建议使用这个名为[E](http://e-texteditor.com/blog/2006/textmate_on_windows)的“克隆” 。它比任何 IDE 都轻得多，并且对于许多用途而言同样强大。或者你可以用 Mac 代替并运行 TextMate :) 使用 VMware Fusion 和 Parallels 4 之类的东西，为 Windows 文件运行 Mac 编辑器，应该很容易......

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-01-05T11:08:13.027

就像 Stumproot 所说，**Emacs**是一个不错的选择，但它并不严格符合您列出的要求。

**稳定快速**- 好的。

**能够打开 GB 大小的文件**- 不幸的是 Emacs 无法处理大文件，因为它总是将整个文件加载到缓冲区中。在 UNIX 世界中，命令行程序 grep、awk 和 sed 完成编辑大文件的工作，但在 Windows 中无法打开大文件可能是更大的问题。

**查找和替换**- 好的。

**支持正则表达式**- 好的。

**可以在文件中查找/替换**- 好的。

**列编辑**——如果 [这](http://www.vimeo.com/1168225?pg=embed&sec=1168225)就是你的意思，那么 Emacs 就有了。

**语法高亮**- 好的。

**自动完成**- 好的。

**自动缩进**- 好的。

**模板**- 好的。

**源代码导航**- 取决于你的意思。这也取决于编程语言。

**文本文件的选项卡式界面**- 默认情况下，Emacs 没有选项卡（尽管[Aquamacs](http://aquamacs.org/)有）。Emacsists 中的一个普遍观点是选项卡不能缩放。但是如果你真的想的话，你总是可以使用[标签栏模式。](http://www.emacswiki.org/emacs/TabBarMode)

**可自定义的字体和颜色**- 好的。

但是关于 Emacs 的主要事情不是它现在能做什么，而是你可以让它做什么。没有其他编辑器如此容易扩展。我想您甚至可以解决大文件问题并开发某种大文件模式（如果有人还没有这样做的话）。

我不知道任何其他可以[编辑 ASCII 表](http://www.youtube.com/watch?v=EQAd41VAXWo)、[绘制图表](http://www.cinsk.org/emacs/emacs-artist.html) 和[玩游戏](http://www.youtube.com/watch?v=mS1eG5KEh8U)的编辑器。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-01-05T09:37:57.373

Microsoft Visual Studio 速成版 :)

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-01-05T11:41:51.943

目前，我正在使用一些不同的编辑器，具体取决于我正在做的事情——这不是最理想的方法，但我还没有找到“一个编辑器来统治它们”。

*   Windows 开发 - C++、C# 等：Microsoft Visual Studio 2008
*   Java 开发：[Eclipse](http://www.eclipse.org) - 对大纲、调试等的工具支持非常棒。
*   Mac 上的 Ruby 开发：[TextMate](http://macromates.com/) - 好吧，不是完全免费，但它很便宜！
*   Python 开发：带有[PyDev](http://pydev.sourceforge.net/)插件或 Emacs的[Eclipse](http://www.eclipse.org)
*   其他一切：Emacs

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-01-08T06:47:53.673

> Ultraedit-32，可以说是商业文本编辑器的杀手级应用。

您显然从未尝试过[Zeus](http://www.zeusedit.com/forum/viewtopic.php?t=200)编辑器；）

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-02-04T19:09:43.457

> ```
> * Name of Text Editor 
> ```

杰迪特

> ```
> * OS Platform of Text Editor 
> ```

跨平台（基于java）

> ```
> * Website URL 
> ```

[http://www.jedit.org](http://www.jedit.org)

> ```
> * Your comments 
> ```

试试看，很棒！

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2009-06-02T23:01:12.027

我喜欢[SciTE](http://www.scintilla.org/SciTE.html)。它是跨平台的，我在 windows、linux、mac 上使用过。它进行语法高亮和自动缩进，不确定自动完成。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2009-07-23T09:02:00.463

没有人提到[GEdit](http://projects.gnome.org/gedit/)，所以我会提到[Windows](http://live.gnome.org/Gedit/Windows#head-3c27102a3a96958dbb3c9ab49b3fa11929f01d85)（它也在 Gnome [linux] 上）。

[![替代文字](https://i.stack.imgur.com/HGKbr.png)](https://i.stack.imgur.com/HGKbr.png)
[（来源：[gnome.org](http://projects.gnome.org/gedit/images/gedit4.png)）]

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2010-03-24T13:46:55.283

我喜欢用 Geany

它的 gtk+ 基于并在 Linux 和 Windows 上运行

[http://www.geany.org/](http://www.geany.org/)

它对自动缩进、类/方法自动补全有很好的支持，它可以自动关闭[]{}()""''，支持xml/xhtml标签关闭，文件浏览器和插件支持。

同样在 Linux 上，您会在底部看到一个终端窗口。

有编译和执行的按钮。我已经针对 C、C++、Java 和 Python 对其进行了测试。

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2010-03-24T13:49:02.657

GVIM - 适合 vim/vi 爱好者。如果您打算在类似 Unix/Linux 的系统上进行大量工作，那么拥有 GVIM 是最好的编辑器，可以让您的编辑/自动化技能保持敏锐。它有所有的好东西，比如

*   语法高亮
*   自动缩进
*   通过脚本自动化
*   强大的正则表达式引擎来搜索/替换
*   大量的插件

# optimization - 如何优化 LAMP Web 应用的导出功能？

> ID：412481
> 
> 赞同：1
> 
> 时间：2009-01-05T07:21:41.190
> 
> 标签：optimization, caching, lamp

我有一个功能允许用户创建项目并在此页面上查看它。他们可以导入资源（pdf、img 等）以与他们的项目一起保存。所以现在我想创建一个功能，允许用户导出他们所有的东西，以及与他们在同一组中的那些人，它们都整齐地用漂亮的丝带绑在一个 zip 文件中。

目前我正在使用 Archive:Zip 抢先压缩文件，保留他们的 CRC32 校验和并将其作为每日 cronjob 运行以减少用户等待时间。但是，如果对任何文件有任何更改，我将不得不重新运行整个过程。

我的初始基准测试显示 103MB 的文件最多需要 47 秒才能运行。该过程涉及生成将它们链接到 XSL 的 XML、复制图像、用于 iframe 的 html 等等。

我正在考虑创建一个表或文本文件，以将所有文件的 CRC32 校验和或上次修改日期保存在临时存储区域中，并在每次用户单击导出时与此列表进行比较，如果有任何新文件，我将从缓存的 zip 文件中删除相同的文件并添加新文件。或者我将保留所有松散的文件并复制和替换较新的文件，然后在每次单击时进行存档。

我的问题是：

1.  这是否被认为是一种不成熟或糟糕的优化技术？
2.  我应该如何正确优化这个？
3.  对于这些优化技术，我可以学习一些书籍或资源吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-05T10:17:35.700

这个想法有什么问题：

*   每当用户文件更改（添加、删除或更改文件）时设置某种标志。
*   对每个文件已更改的用户运行夜间压缩，然后重置该标志。
*   如果用户在设置标志时请求导出，则必须在导出完成之前再次进行压缩（没有办法解决）。

为了进一步加快用户体验，您还可以将导出请求与导出操作分离。例如，当用户（其标志已设置）请求导出时，通知他们将在压缩发生时完成，并设置不同的标志。然后修改上面的第二步，如果设置了第二个标志，也可以导出新创建的包。

这会给用户即时反馈，即会发生某些事情，但会将繁重的工作转移到未来。

或者，您不必将导出绑定到压缩。您可以每天晚上压缩，但根据需要在白天允许额外的压缩/导出作业。但是，将请求与事件分离仍然很好。

回答您的具体问题。

1/ 我不认为这种过早或糟糕的优化。“代码”在功能上是完整的，因为它可以满足您的所有要求，因此是优化的最佳时机。此外，您已经确定了瓶颈并正在优化正确的区域。

2/见我上面的文字。您应该通过完全按照您所做的来优化它 - 确定瓶颈并专注于改进它。鉴于您不太可能获得更好的压缩性能，我建议的解耦“技巧”是一个很好的方法。像进度条和闪屏一样，它通常更多地与用户对速度的**感知**有关，而不是速度本身。

3/ 书籍？不要打扰，网上有成千上万的资源。继续询问 SO 并打印出所有回复。最终你的大脑会和我一样充实，每一个新的代码片段都会让你暂时忘记你妻子的名字:-)。

# python - 迁移到 Python 的资源

> ID：412482
> 
> 赞同：2
> 
> 时间：2009-01-05T07:23:35.817
> 
> 标签：python

对于可以用其他语言进行体面编码的人来说，有哪些好的在线资源可以*快速*学习 Python ？

编辑：如果您能解释为什么您认为该资源有用，这将有所帮助。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-01-05T07:32:32.213

[潜入蟒蛇](http://diveintopython.net/toc/index.html)

我在一个周末左右的时间里完成了它，这足以学习几乎所有的语言习语并了解什么是“Python方式”:-)

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-01-05T07:34:39.603

不确定您是否已经考虑过，但[官方网站上的文档](http://docs.python.org/3.0/)非常好。特别是，[教程](http://docs.python.org/3.0/tutorial/index.html)可以让您快速开始

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2009-01-05T07:27:58.680

[像 Pythonista 一样编写代码：惯用的 Python](http://python.net/~goodger/projects/pycon/2007/idiomatic/handout.html)

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-01-05T12:15:54.090

**如何像计算机科学家一样思考**

蟒蛇版本

[http://www.greenteapress.com/thinkpython/thinkCSpy/html/](http://www.greenteapress.com/thinkpython/thinkCSpy/html/)

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-01-05T09:18:38.567

我的建议是遵循标准教程（我觉得它非常好），如果你想在学习语言的同时获得很多乐趣，一定要看看 Python Challenge ( [http://www.pythonchallenge.com/](http://www.pythonchallenge.com/) )。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-01-05T08:38:00.583

在 Google 视频上搜索“Alex Martelli - Python For Programmers”。很好的介绍性（但节奏很快）的谈话。相关视频也值得一看。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-01-05T09:00:18.213

我的回答是阅读并立即购买 Beazly 的[Python Essential Reference](https://rads.stackoverflow.com/amzn/click/com/0672328623)。

这本书对 Python 核心语言的介绍是我见过的最好的，它是为希望快速掌握 Python 的有经验的程序员（也就是你）而编写的。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-01-05T10:20:59.423

当我刚开始的时候，我在我的 Delicous 上收藏了这个[链接](http://www.awaretek.com/tutorials.html)——它是一堆 Python 教程的链接。
我也喜欢[Dive into Python](http://www.diveintopython.net/)和标准文档。它假设您了解如何编程的基础知识，并集中展示如何使用 Python - 它使用一些很好的现实和有用的代码来解释。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2012-11-11T21:58:26.430

[用 Python 构建技能][1]

程序员到程序员的最佳书籍 [1]：[http ://www.itmaybeahack.com/homepage/books/python.html](http://www.itmaybeahack.com/homepage/books/python.html)

# cocoa - 查询应用程序开发的设计指南

> ID：412483
> 
> 赞同：1
> 
> 时间：2009-01-05T07:23:40.483
> 
> 标签：cocoa, macos

我有一个用于 MS Windows 的向导应用程序，它是典型的 Next-Next-Finish 类型。该应用程序有一个默认的供应商特定窗口背景主题，该主题在应用程序的所有窗口中持续存在（即每个屏幕的供应商徽标和背景颜色）。我想为 Mac 开发一个类似的应用程序向导。我注意到所有应用程序在 Mac 中都有一个默认的灰色窗口。Apple 是否提供了任何设计指南，规定窗口的背景颜色必须是默认颜色？我可以为应用程序使用自定义颜色和图像吗？任何想法都将受到高度赞赏。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-05T09:23:32.207

Apple 有一个非常全面的文档，称为[Apple Human Interface Guidelines](http://developer.apple.com/documentation/UserExperience/Conceptual/AppleHIGuidelines/XHIGIntro/chapter_1_section_1.html)。大多数 Mac OS X 用户希望应用程序的外观和行为符合这些准则，并且（通常）对偏离这些准则的应用程序的宽容度稍低。当然，完全可以根据需要自定义您的应用程序，但我强烈建议您在决定如何继续之前阅读文档（链接在名称中）。

它们只是指导方针，这意味着如果您有充分的理由不遵循它们，这并不是世界末日，但是一旦您熟悉了它们，您就更有可能将您的定制融入不不会对您的 Mac 用户群感到完全陌生。即使您的主要用户群是最近的 Windows 转换者，这也会为他们提供他们已经最熟悉的东西，并允许他们开始过渡到其他 Mac 应用程序的设计预期。

但最终，这完全取决于您。您可能还想看看 Apple 如何处理这些助手向导。查看安装程序应用程序（许多产品对此进行了自定义，如果您安装了工具，您可以看到它可以轻松自定义的位置，以获取一些线索，作为您可能允许在应用程序中自定义的内容）。此外，您可以查看 Xcode 使用的一些“向导”以及 Apple Pro 软件包使用的（如果您可以访问它们）或各种 iLife 应用程序使用的（您应该可以访问这些）。这项研究与*至少*仔细阅读 Apple 人机界面指南相结合，应该可以让您顺利找到满足您当前客户、您的老板（如果您有；

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-05T07:29:42.997

在 Windows 应用程序中为窗口/控件使用自定义颜色的问题是它们不会根据所选主题而改变。ControlColor/ControlText 和其他选项会根据使用的主题而变化。我认为Macs必须相同。不过不确定...希望您从其他答案中获得线索...

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-05T23:27:24.640

你不必**让**你的背景变灰，但你最好有一个很好的理由（和一个专业的设计师）这样做。Mac 用户通常对 Mac 应用程序应该是什么样子有一个概念，而出现大量奇怪颜色和自定义图形的设计往往会让人觉得“错误”。就像任何领域一样，你可以打破规则并逃脱惩罚，但你真的需要知道你在做什么，否则你会看起来很愚蠢。

作为 Mac 的老用户，我的建议是更喜欢与 Mac UI 保持一致，而不是与程序的 Windows 版本保持一致。它提供了更好的用户体验。就像 Jason Coco 所说，看看 Mac OS X 中包含的向导——Mac 术语是“助手”，其中一些包含在文件夹 /Applications/Utilities 中。安装程序也是这种程序。

# python - 如何访问 mod_python 目录中的根路径？

> ID：412498
> 
> 赞同：1
> 
> 时间：2009-01-05T07:30:03.980
> 
> 标签：python, mod-python, publisher

在我的 Apache 网络服务器中，我放了这个：

```
<Directory /var/www/MYDOMAIN.com/htdocs>
    SetHandler mod_python
    PythonHandler mod_python.publisher
    PythonDebug On
</Directory> 
```

然后我有一个带有索引函数的 handler.py 文件。

当我访问 MYDOMAIN.com/handler.py 时，我看到一个由 index 函数生成的网页（只是一个普通的 HTML 页面）。其他所有页面都属于这种类型：MYDOMAIN.com/handler.py/ *somename*其中*somename*对应于 handler.py 文件中的函数。

但是当我访问 MYDOMAIN.com 时，我得到了这个：

> 未找到
> 
> 在此服务器上找不到请求的 URL /。

mod_python 和发布者有没有办法只使用根而不是 name.py 作为起点？

我已经在 apache conf 文件中尝试过这个：

> DirectoryIndex handler.py

无济于事:(

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-05T10:51:55.757

是的，但您需要创建自己的处理程序。您当前使用发布者，它只是检查 URI 并加载给定的 python 模块。

要创建自己的处理程序，您需要创建一个像这样的模块（只是一个极简示例）：

```
from mod_python import apache

def requesthandler(req):
    req.content_type = "text/plain"
    req.write("Hello World!")
    return apache.OK 
```

然后你只需在 Apache 配置中指向它。

您仍然可以在自己的处理程序中使用发布者处理程序，尽管 AFAIK 不能拥有漂亮的 URL。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-05T08:24:49.533

尝试在目录中创建一个名为 index （或其他）的空文件，然后使用

```
DirectoryIndex index 
```

似乎 DirectoryIndex 检查是在观察文件系统时完成的。

# unit-testing - 不可测试代码的警告标志

> ID：412511
> 
> 赞同：13
> 
> 时间：2009-01-05T07:39:28.330
> 
> 标签：unit-testing, oop, singleton

无法测试的代码真的让我很恼火。以下情况使 oo-code 无法测试：

*   全局状态，例如单例设计模式
*   做一些花哨的工作的静态方法，例如数据库访问
*   深层继承树
*   在构造函数中工作，例如控制语句
*   违反单一职责原则的类

是否有更多警告信号？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-01-05T08:07:09.787

这些都不会使代码无法测试。它们可能会使发现边缘案例错误变得更加困难，但是，如果您已经完全指定了测试的成功标准（并且测试驱动的开发简化了这一点），您所要做的就是通过标准。

TDD 可以应用于特定部分以及整个项目的行为，因此您可以轻松测试非常小的组件。但是，它的目的是测试结果，*而不是*获得这些结果的方法。

如果测试通过，则您已满足要求。如果之后有错误，这是测试的问题，而不是正在测试的代码（在这种情况下，应该修改测试以捕获以前无法预料的问题）。

您不应该关心（就功能的交付而言）您的一个构造函数中是否有 while 语句。您应该问自己什么业务需求要求这样做？我强烈怀疑您的客户会提供一份要求清单，包括“继承限制为 4 个级别”。他们很可能将“无错误”列为一项要求，但您必须就此进行协商:-)。

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2009-01-05T08:11:04.177

请参阅 Miško Hevery 的以下博客文章：[如何编写 3v1L，不可测试的代码](http://misko.hevery.com/2008/07/24/how-to-write-3v1l-untestable-code/)。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2009-01-05T07:48:30.823

硬编码的依赖项。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2009-01-05T08:04:03.537

*   不对接口编程
*   更新对象而不是使用工厂/IOC

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-01-05T08:55:34.743

在与演示无关的 GUI 类中完成的工作。GUI 应该与底层模型完全解耦。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-01-05T09:14:15.360

只要您不能修改代码，代码就无法测试。如果您有可能重构项目，那么没有代码是不可测试的。通常，只需要很小的修改就可以使测试更容易。而且它们是合理的，因为它们提高了代码的质量。

即使在您描述的情况下，代码也不一定是不可测试的。只是更难测试。例如，如果您可以隔离数据库访问并在单元测试期间避免它们，那么测试代码会更容易。但如果必须，您可以建立一个专门用于运行测试的数据库。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-01-05T09:14:46.170

我会说这些都不会使代码无法测试。它们确实使*单元测试*变得困难，因为每一个都增加了实现中的耦合。

在其他使单元测试变得困难的烦恼中：

*   图形用户界面代码与业务逻辑代码混合
*   所有反模式，但特别是上帝反对（[http://en.wikipedia.org/wiki/God_object](http://en.wikipedia.org/wiki/God_object)）
*   同理，一个巨大的功能也很烦人

通常，您可能听到的有关创建更好代码的任何建议也是更易于单元测试代码的建议。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-01-05T09:53:14.127

数据库！特别是那些有触发器的！

我知道你可以模拟数据库，但我一直发现我的代码（主要是 CRUD 应用程序）中的大多数错误都是数据/映射问题，如果你模拟数据库，你不会发现那种错误。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-01-05T16:17:10.843

Miško Hevery 的[编写可测试代码](http://misko.hevery.com/code-reviewers-guide/)指南详细介绍了使代码难以测试的缺陷。他的清单与您的清单有些重叠，但细节令人难以置信。

*   构造函数做真正的工作
*   挖掘合作者
*   脆弱的全球状态和单身人士
*   课堂做得太多

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-01-05T09:23:57.587

缺乏分层，过度耦合... 即类 Y 已被编写为了解 X，但它不应该，X 是可重用的。可测试性和可重用性之间有很强的关系。

# .net - .NET 可用的框架

> ID：412515
> 
> 赞同：3
> 
> 时间：2009-01-05T07:45:44.307
> 
> 标签：.net, asp.net, frameworks, enterprise

我想构建一个将在网络上运行的应用程序，这是一个企业解决方案，但我不知道我将使用什么样的框架，有没有人可以推荐一个最适合的框架在可以处理 DAL、BLL 和 GUI 的 .NET/ASP.NET 应用程序中，而不是 CSLA.NET？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-01-05T07:53:27.083

如果您正在寻找类似 JBoss 的 .NET 等价物，那么不，在 .NET 世界中没有一种产品可以提供万能框架。

但是，有很多产品，主要是 .NET 3.5 堆栈本身，可以拼凑在一起以提供一个可靠的框架。

*   Windows 通信基础（网络）；
*   Windows Workflow Foundation（工作流程）；
*   企业库应用程序块（缓存、日志等）；

对象关系映射器

*   实体框架；
*   休眠；
*   [LLBLGen](http://llblgen.com/)

[控制反转/依赖注入](http://martinfowler.com/articles/injection.html)

*   [统一](http://www.codeplex.com/unity)
*   [春天.NET](http://www.springframework.net/)
*   [温莎城堡](http://www.castleproject.org/container/index.html)
*   [忍者](http://ninject.org/)
*   [结构图](http://structuremap.sourceforge.net/Default.htm)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-05T08:10:22.307

@biozinc 的建议看起来都不错，我也会添加[控制/依赖注入](http://martinfowler.com/articles/injection.html)选项的反转，例如：

*   [统一](http://www.codeplex.com/unity)
*   [春天网](http://www.springframework.net/)
*   [自动法](http://code.google.com/p/autofac/)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-05T13:31:53.843

实际上[.netTiers](http://www.nettiers.com/)除了 dal 还生成一些 bll 和一些用户控件/网页。所以我认为它最接近您正在搜索的内容。

我个人使用[subsonic](http://subsonicproject.com/)，因为：

*   它使用我喜欢的 ActiveRecord 模式（简单易行）
*   轻巧
*   开箱即用地创建清道夫页面...（所以一些 UI :)）

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-05T08:35:41.117

另一种 ioc 容器是[Castle Project](http://www.castleproject.org/container/index.html)。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-05T09:51:40.247

另一个好的 OR 映射器是[LLBLGen](http://llblgen.com/)。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-05T13:03:34.320

我会将[托管可扩展性框架 (MEF)](http://code.msdn.microsoft.com/mef)添加到我开始的任何企业 .NET 项目中。

# mysql - phpMyAdmin 和德语

> ID：412517
> 
> 赞同：0
> 
> 时间：2009-01-05T07:47:12.090
> 
> 标签：mysql

我正在使用 vertrigoserver 开发一个 PHP/MySQL 应用程序。我需要在表格中输入德语文本。问题是当我从 PHP 中读取表格时，某些字符没有显示确切键入的字符。我需要额外的步骤来有效地显示所有字符吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-05T08:45:47.057

您应该将数据库字段设置为`utf8_general`并因此强制您的 MySQL 连接使用[UTF-8](http://en.wikipedia.org/wiki/UTF-8)。

```
mysql_connect();
mysql_query("SET NAMES 'utf8'"); 
```

通过 (x)html 显示结果时，您还必须正确设置标题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-05T07:54:00.327

创建表格时是否在表格上设置了正确的字符集？

您应该将它们设置为支持 ümlaut 等的字符集。

# project-management - 当您有多个项目时，Scrum 如何工作？

> ID：412525
> 
> 赞同：92
> 
> 时间：2009-01-05T07:51:24.060
> 
> 标签：project-management, agile, scrum

我对 Scrum 的好处和流程非常了解。我得到了关于积压、燃尽图、迭代、使用用户故事和其他各种 Scrum“框架”概念的想法。

话虽如此...我在一家网络开发公司工作，该公司一次管理多个项目，有六名团队成员组成“生产团队”。

Scrum 如何处理多个项目？您是否仍然只是在一定时间内为单个项目安排一次迭代，整个团队都在为此工作，然后在迭代完成后继续进行下一个具有新迭代的项目？或者是否有一种“敏捷”的方式来管理多个项目，同时只需要一个团队进行自己的迭代？

* * *

## 回答 #1

> 赞同：61
> 
> 时间：2009-01-05T08:07:00.723

Scrum 并没有真正规定你必须开发一个独立的产品。它只是说明有一堆东西需要完成（产品待办事项），在下一次迭代中有一定的开发时间可用（根据项目速度计算），并且有客户选择的项目/business 将在下一次迭代（sprint backlog）中完成的这个问题/任务池中具有最高优先级。

产品 backlog 和 sprint backlog 没有理由必须来自一个项目——即使在单个项目中，也会有像单独项目一样的离散工作单元——UI、业务层、数据库模式等。尤其是企业软件开发就是这样，你有许多代码库，它们都必须在进步。Scrum 流程——会议、问题、燃尽图等——无论是一个项目还是多个项目都有效。

话虽如此，在实践中，每次迭代都有一个主要主题——“做报告模块”或“与 XYZ 系统的 API 接口”——这样很多问题都来自一个项目或领域，并且在在迭代结束时，您可以指向大量工作并在其上打勾。

* * *

## 回答 #2

> 赞同：26
> 
> 时间：2009-01-05T11:19:39.413

我认为答案取决于“**谁将优先考虑积压项目**”（即决定首先需要做什么）。如果这是一个人，那么这个人就是您的项目的产品负责人，您可以将所有项目的所有项目都有一个积压工作 - 或每个项目一个积压工作 - 并且您在计划时从所有项目中选择积压工作冲刺。在这种情况下，Scrum “工作”很好。

如果每个项目都有其负责人，那么您可能会遇到一些麻烦，每个负责人都会或多或少有意识地尝试支持其项目。恕我直言，您只需要一个有权通过仲裁解决优先级的产品负责人。

在这种情况下应遵循的一条规则是**在 Sprint 期间永远不要更改 Sprint 内容**。如有必要，您可以将迭代缩短到两到三周，以降低必须在当前 Sprint 中添加紧急项目的风险。

* * *

## 回答 #3

> 赞同：16
> 
> 时间：2012-07-13T12:44:18.917

我不得不不同意。我认为让团队在冲刺期间专注于单个项目是流程的关键。如果您有一些专家无法为整个开发过程做出贡献（内容作者、图形人员、业务流程分析师等），当他们无法做出贡献时，我会将他们从团队中解散。或者更好的是，让他们接受一些不同任务的培训，这样他们就可以为测试等事情做出贡献。

要记住的另一件事是并行运行项目会破坏您的日程安排。考虑一下：为简单起见，假设我们有 5 个项目使用同一个团队并在同一日期开始。每个项目需要 3 个 1 个月的努力，在并行运行的最佳情况下，您将一次完成所有项目，需要 15 个月。你的速度会变差，因为你在一个冲刺中只能适应一个月的 1/5 的努力。您还将同时进行 5 次演示会议。所以最好的情况是，你在 15 个月内交付了 5 个项目，而你的竞争对手将声称他们可以在 3 个月内完成相同的工作。你的团队估计成熟度会受到影响，因为他们只能考虑 20% 的可用劳动力。您可能会发现您实际上无法在单个 sprint 中执行某些任务。如果您必须将正在工作的项目数量从 5 个更改，您的团队将不得不调整他们的估算习惯，这将损害团队的效率。此外，当简单的任务重新分配可能需要在工作开始之前启动新的开发环境时，您的团队会发现很难自组织。

如果您要连续运行相同的 5 个项目，您将在相同的 15 个月内交付第 5 个项目，但您会告知您的客户，您的团队需要您有 12 个月的积压工作，并且您可以使用是时候细化你的项目目标了。或者，如果你有一个持续的积压，你知道是时候开始雇佣另一个团队了。但是，您最好的项目是在 3 个月内完成的，客户在活跃期间看到了快速的改进。你可以提前一年完成那个项目，并且可以把它写在你的简历上。您的 sprint 速度将在这段时间内保持稳定，并且您可能会发现在一两个项目之后大步前进，并且能够在给定的 sprint 中完成更多。

我认为连续运行项目是组织尝试采用 Scrum 面孔的最大障碍之一。这是与解构项目经理角色相关的重大文化变革，但 Scrum 流程的好处是巨大的。

请记住，每个人都不需要成为完整的团队成员。他们可以在候诊室与您的客户互动，为开发过程做准备。我让我的业务分析师、网络架构师和图形设计人员担任领域专家，并且只根据需要将他们加入团队。让它们以 sprint 0 运行。您会惊讶于在外观和工作流程上的工作是多么引人入胜。让您的客户了解当开发开始认真时，他们的参与水平实际上可能会提高，并且让他们可用很重要，这也是很好的。让他们知道日程安排，以便他们有足够的时间提前处理假期和假期等事情。

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2009-01-05T13:18:18.287

我一直处于这种精确的情况。

如果您在项目中有一个产品负责人，那么 Phillipe 是绝对正确的；一个团队的一个冲刺应该可以正常工作。

如果您有多个产品负责人，那么理想情况下，业务方需要选择一个负责安排工作的“优先级确定者”。**这绝对是最好的解决方案。**

如果（可能是这种情况）企业不想改变他们想要优先处理事情的方式（这太方便了），那么您可以拆分团队，并运行两个并发冲刺。但是对于一个六人的团队，我不会将它分成超过 3 个团队（我根本不想拆分它，但我认为 2-3 个团队是可行的）。正如 Kenny 所建议的那样进一步拆分，让一个人组成的团队在我看来有点毫无意义，因为那时你不再有一个团队，只有个人程序员。

如果您要拆分团队，我没有发现合并站立会议的价值，除非您有单独的冲刺在非常多的相同代码库上工作，但这可能是合并这些团队的理由冲刺。

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2014-04-29T19:08:55.763

我最近一直在阅读另一种观点，即在敏捷环境中，**项目**的概念可能会适得其反，并且可能会被淘汰。根据这种思路，组织应该专注于**发布**。这是因为*项目*是人工的工作箱，在完成之前不会产生任何价值。它们与敏捷提供可交付价值的目标背道而驰。发布更符合敏捷，因为它以交付价值为导向，并且可以根据团队在下一个*发布**之前*交付的内容来缩小或扩大其范围。

 *有一个潜在的中间地带，您公司以前称为*项目*的东西现在被重新包装为常见的敏捷**主题**或**功能**。这种方法的好处是，*主题*或*功能*现在可以按照产品所有者认为合适的方式实现。

仍然存在一个团队开发多个**产品**的问题，这是一个问题，因为对领域知识和可能的技术技能的合理担忧。但是使用敏捷构建的产品，甚至是单个团队构建的多个*产品*，都在不断积累可*发布**的*价值。相比之下，*项目*在完成之前一文不值（而且很多都没有）。

有什么要考虑的...

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2015-10-26T21:04:25.073

我认为 anopres 是对的：最好的方法是使用 scrum 避免同时进行多个项目。尽一切努力确保并行运行过多是没有效率的。

让我们假设 5 个项目，每个项目大约 3 个月，团队有 5 人。

方法一：每个人在团队中做一个项目

*   每个项目 1/5 的交付速度为所有项目提供 15 个月的交付时间
*   每个人都是专家，但只在自己的项目中
*   没有团队精神

方法 2：每个项目 1 个 sprint，切换项目

*   每 6 个 sprint 都在项目上工作
*   项目工作之间的时间太长 - 不是定期为项目增加价值（对于产品积压是），容易忘记，需要努力恢复上下文，
*   第一个项目在大约 12-13 个月后交付（假设 2 周冲刺）

方法 3：单个 sprint 中的 5 个项目

*   需要太多详细的任务拆分才能适应 sprint
*   每个项目的增量构建很少
*   大约 12-15 个月后交付第一个项目

方法四：推荐——序列化工作

*   团队在一个接一个的项目上工作
*   第一个项目启动并在 3 个月后交付
*   第二个项目在第 3 个月后开始，第 6 个月后交付
*   ...
*   第 5 个项目在第 12 个月后开始，第 15 个月后交付
*   团队高度专注于项目，深入研究并与客户合作
*   整个团队对所有项目都有很好的了解
*   无需在上下文切换上浪费时间
*   需要良好的团队合作（冲突会减慢交付速度）。

如您所见，解决方案 4 通常更好，因为项目交付速度更快，团队合作高效。其他方法包括上下文切换浪费时间、没有完整的团队协作、所有项目的总交付时间非常长等。

那么积压梳理呢？如果团队同时在一个项目上工作，那很简单——每个人都会加入。如果有多个项目，我们可能需要委派一个人参加单独的梳理会议（不涉及整个团队）。

重要的是要让客户相信，在 3 个月后开始第二个项目仍然会导致更快的交付（在第 6 个月之后），而不是我们立即与所有其他项目一起开始。这是经理们看到的一种错觉——我们一次启动5个项目，我们努力工作，一点一点地交付。然而，这最终效率不高。

这就是为什么我不相信 Scrum 对并行的多个项目是有效的，将它匹配到框架中并根据 scrum 规则工作是非常棘手的。有时，拥有 2 个项目来让所有人都忙起来可能会很好，但是我们添加的项目越多，scrum 的效率就越低。也许看板只是为了查看进度和团队合作（不像 Scrum 团队那样强大）？

问候，亚当

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2010-04-06T20:49:11.113

正如@Chris 所说，一个普通的项目里面有子项目。不过，您只有一个积压工作。

考虑所有项目的积压工作。第一个问题：您是否为任务或项目分配了优先级？我确实更喜欢每个项目的积压工作。至少要明确产品所有者的优先级。

拥有不同的产品负责人，并且由于这些产品负责人不会就他们应该为每个项目投入多少时间达成一致。“某人”将不得不放弃关于如何管理项目间优先级的决定。注意：开发人员不应该这样做。

我们的项目“S”经理来了，他将平衡产品所有者所需的资源和团队成员可以给予的时间。产品负责人 A 支付了一个月的工作费用，但产品负责人 B 一直在更新他的项目（并且还给了你丰厚的报酬）。有一些方法可以平衡你的团队，让 A 有一个月的时间（开发人员时间），并且不要阻止 B 填满你的口袋。

对于内部软件（一家公司，一千个项目）。不同的产品所有者应该就给予他们的时间达成一致。他们不是孤立地生活，而是与您（项目“S”经理）在同一条船上。他们会让你的生活更轻松，能够推迟一些任务，但同时你不应该忘记他们的需求。

好吧，我仍在尝试找出最好的方法来做到这一点。但这就是我们现在正在推动的。我希望它有所帮助。

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2012-11-26T15:10:12.697

团队成员可以在 Scrum 项目之间分配他们的时间，但让团队成员全心投入会更有效率。团队成员也可以从一个冲刺切换到下一个冲刺，但这也会降低团队的生产力。具有较大团队的项目被组织为多个 scrum，每个 scrum 都专注于产品开发的不同方面，并密切协调他们的工作。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-01-05T12:58:37.560

我建议为每个项目运行一个 Sprint，并每天召开 1 次站立会议来处理所有活动的 Springs/项目。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2016-02-19T10:05:49.580

我愿意贡献。这就是我这样做的方式：

*   每个团队有一名产品负责人和一份产品待办事项。产品负责人不必是一个人，但这个产品负责人“实体”负责产品积压工作。
*   产品 backlog 包含每个项目的用户故事（这里的所有项目）。每个用户故事都有一个努力/故事点（团队责任）和一个商业价值（产品所有者责任）。
*   我们有一个“产品待办事项梳理”会议每个 sprint。在这次会议之前，产品负责人已经更新了故事的商业价值（如果他们出于任何商业原因需要一些改变——我们不关心也不应该关心——）并包括一些新的故事。在这次会议上，新的故事得到了解释，工作也得到了更新。本次会议持续约1小时（第一次除外，约4小时）。
*   当我们要计划一个新的 sprint 时，我们会打开产品 backlog，按 ROI（这是业务价值/工作量）对故事进行排序，然后计划故事直到时间过去。

就是这样。我可以说这很好用。我们使用几个谷歌电子表格（产品待办事项和 sprint 待办事项，都带有图表和资料）来执行此操作，并每天为在线组织使用 redmine（具有特定语义）：时间、任务进度等

这种方法的问题是我在 sprint backlog 电子表格和 redmine 中复制了任务。但是我没有找到任何在线工具可以完全在线完成此操作。我错过了 redmine 中的产品积压（没有其他语义作品适合我），jira 中的单个板，taiga 中的更多故事等等

# asp.net - 使用 C# 在 ASP.NET 中上传图像

> ID：412530
> 
> 赞同：0
> 
> 时间：2009-01-05T07:55:11.463
> 
> 标签：asp.net

我创建了 2 个页面：page1.aspx 和 page2.aspx。我在第 2 页定义了 5 个文件上传器控件，但我想将 Page1.aspx 保存在保存按钮上。

实际上，该页面包含一个后退按钮，我在其中将所有上传文件存储在一个字符串对象中，并将其作为会话填充到 Page1.aspx 上。

如何在服务器上保存文件？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-05T08:13:53.300

以下是一些可以帮助您解决此问题的链接：

1) [http://www.codeproject.com/KB/aspnet/multiuploads.aspx](http://www.codeproject.com/KB/aspnet/multiuploads.aspx)

2) [http://www.dotnetcurry.com/ShowArticle.aspx?ID=68&AspxAutoDetectCookieSupport=1](http://www.dotnetcurry.com/ShowArticle.aspx?ID=68&AspxAutoDetectCookieSupport=1)

3) [http://www.asp.net/Learn/videos/video-252.aspx](http://www.asp.net/Learn/videos/video-252.aspx)

还有几件事要记住，与 ASP.net 帐户关联的用户应该对您将文件上传到的服务器文件夹具有足够的权限，并且文件的最大大小默认为 4MB，但您可以使用 Web 更改它.config httpRuntime 配置更改。

希望这会有所帮助，

约米特

# javascript - 正则表达式验证应仅允许小数和数字的文本框

> ID：412536
> 
> 赞同：3
> 
> 时间：2009-01-05T08:03:31.027
> 
> 标签：javascript, regex

我有一个“区域”的文本框。我需要一个正则表达式来验证文本框，以便它应该允许输入小数但没有字符。任何人都可以帮助我

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-01-05T09:00:45.623

为什么不尝试 JavaScript 已经内置的东西：[parseFloat](http://www.w3schools.com/jsref/jsref_parseFloat.asp)函数？

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-05T08:21:38.337

这个正则表达式可以验证整数和可选的浮点数：

```
[0-9]*\.?[0-9]+ 
```

[您可以使用isNaN](http://www.w3schools.com/jsref/jsref_isNaN.asp) (value) 来检查数值是否不是数字 (NaN) ，而不是使用正则表达式。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-05T08:21:20.227

您将在您的领域支持的十进制数字的格式是什么？

这个[“十进制数的简单正则表达式？”](https://stackoverflow.com/questions/308122) StackOverflow 问题详细说明了可能的正则表达式。

```
^\d+(\.\d{1,2})?$ 
```

可以确保一个数字有一个或两个小数，但不能使用`34.`（没有小数的点）

[这里列出了](http://regexlib.com/DisplayPatterns.aspx?cattabindex=2&categoryId=3)许多可能的正则表达式。

[Unkwntech](https://stackoverflow.com/questions/412536#412569)是一个很好的完整正则表达式，但允许 1,15223,11,00。

我宁愿使用：

```
[-+]?(?:\d(\,?(?>\d{3}[.,]))?)*(?:\.\d*)? 
```

意思是，如果您使用 a `,`，只有在它后面跟着 3 位数字（然后是另一个`,`或十进制值的点。这会强制执行**[数字分组](http://en.wikipedia.org/wiki/Decimal_separator#Digit_grouping)**，尽管正如 Paul 在评论中指出的那样，有区域设置与逗号后超过三位数...

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-05T08:25:48.360

怎么样

```
[-+]?(?:\d\,?){0,}(?:\.\d*)? 
```

它将匹配以下所有带有 * 的示例：

0*
0.0*
222.0*
1,000.00*
100,000.00*
-100,000,000,000.12*
asdf
blah.blah

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-05T10:08:39.930

您还可以使用“isFinite”函数：

[http://www.w3schools.com/jsref/jsref_isFinite.asp](http://www.w3schools.com/jsref/jsref_isFinite.asp)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-05T08:22:57.337

对于十进制值，您还必须允许 [.] 所以这应该适合您：

```
^[-+]?\d*\.?\d*$ 
```

（这也将接受 + 和 - 符号）

[您可以从此处](http://regexlib.com/DisplayPatterns.aspx?cattabindex=2&categoryId=3)的 RegExLib 获得更具体的表达式。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2018-01-11T12:22:31.157

虽然我在这里很晚了……

现在我们有了用于让用户输入数字`<input>`的类型元素。`number`它们包括内置验证以拒绝非数字条目。[更多信息](https://developer.mozilla.org/en-US/docs/Web/HTML/Element/input/number)

```
<input id="number" type="number">
```

* * *

## 回答 #8

> 赞同：-2
> 
> 时间：2009-01-05T08:12:55.390

`'^[0-9]*$'`

* * *

## 回答 #9

> 赞同：-2
> 
> 时间：2009-01-05T08:19:54.550

如果你想要小数，这应该工作：

```
/^(?:\d+\.?)|(?:\d*\.\d+)$/ 
```

# objective-c - 从 Cocoa 应用程序执行终端命令

> ID：412562
> 
> 赞同：208
> 
> 时间：2009-01-05T08:21:32.097
> 
> 标签：objective-c, cocoa, macos

如何`grep`从我的 Objective-C Cocoa 应用程序执行终端命令（如 ）？

* * *

## 回答 #1

> 赞同：287
> 
> 时间：2009-01-05T08:28:22.473

您可以使用`[NSTask](http://developer.apple.com/documentation/Cocoa/Reference/Foundation/Classes/NSTask_Class/Reference/Reference.html)`. 这是一个将运行“ `/usr/bin/grep foo bar.txt`”的示例。

```
int pid = [[NSProcessInfo processInfo] processIdentifier];
NSPipe *pipe = [NSPipe pipe];
NSFileHandle *file = pipe.fileHandleForReading;

NSTask *task = [[NSTask alloc] init];
task.launchPath = @"/usr/bin/grep";
task.arguments = @[@"foo", @"bar.txt"];
task.standardOutput = pipe;

[task launch];

NSData *data = [file readDataToEndOfFile];
[file closeFile];

NSString *grepOutput = [[NSString alloc] initWithData: data encoding: NSUTF8StringEncoding];
NSLog (@"grep returned:\n%@", grepOutput); 
```

`NSPipe`并`NSFileHandle`用于重定向任务的标准输出。

有关从 Objective-C 应用程序中与操作系统交互的更多详细信息，您可以在 Apple 的开发中心查看此文档：[与操作系统交互](http://developer.apple.com/documentation/Cocoa/Conceptual/OperatingSystem/OperatingSystem.html#//apple_ref/doc/uid/10000058)。

编辑：包括对 NSLog 问题的修复

如果您使用 NSTask 通过 bash 运行命令行实用程序，那么您需要包含这条神奇的行来保持 NSLog 工作：

```
//The magic line that keeps your log where it belongs
task.standardOutput = pipe; 
```

解释在这里：[https ://web.archive.org/web/20141121094204/https://cocoadev.com/HowToPipeCommandsWithNSTask](https://web.archive.org/web/20141121094204/https://cocoadev.com/HowToPipeCommandsWithNSTask)

* * *

## 回答 #2

> 赞同：45
> 
> 时间：2012-09-07T00:15:59.760

肯特的文章给了我一个新的想法。此 runCommand 方法不需要脚本文件，只需逐行运行命令：

```
- (NSString *)runCommand:(NSString *)commandToRun
{
    NSTask *task = [[NSTask alloc] init];
    [task setLaunchPath:@"/bin/sh"];

    NSArray *arguments = [NSArray arrayWithObjects:
                          @"-c" ,
                          [NSString stringWithFormat:@"%@", commandToRun],
                          nil];
    NSLog(@"run command:%@", commandToRun);
    [task setArguments:arguments];

    NSPipe *pipe = [NSPipe pipe];
    [task setStandardOutput:pipe];

    NSFileHandle *file = [pipe fileHandleForReading];

    [task launch];

    NSData *data = [file readDataToEndOfFile];

    NSString *output = [[NSString alloc] initWithData:data encoding:NSUTF8StringEncoding];
    return output;
} 
```

您可以像这样使用此方法：

```
NSString *output = runCommand(@"ps -A | grep mysql"); 
```

* * *

## 回答 #3

> 赞同：40
> 
> 时间：2009-03-30T12:10:23.633

本着分享的精神……这是我经常用来运行 shell 脚本的一种方法。您可以将脚本添加到产品包（在构建的复制阶段），然后在运行时读取和运行脚本。注意：此代码在 privateFrameworks 子路径中查找脚本。警告：这对于已部署的产品可能存在安全风险，但对于我们的内部开发而言，这是一种无需重新编译应用程序即可自定义简单事物（例如要 rsync 到哪个主机...）的简单方法，而只需编辑捆绑包中的 shell 脚本。

```
//------------------------------------------------------
-(void) runScript:(NSString*)scriptName
{
    NSTask *task;
    task = [[NSTask alloc] init];
    [task setLaunchPath: @"/bin/sh"];

    NSArray *arguments;
    NSString* newpath = [NSString stringWithFormat:@"%@/%@",[[NSBundle mainBundle] privateFrameworksPath], scriptName];
    NSLog(@"shell script path: %@",newpath);
    arguments = [NSArray arrayWithObjects:newpath, nil];
    [task setArguments: arguments];

    NSPipe *pipe;
    pipe = [NSPipe pipe];
    [task setStandardOutput: pipe];

    NSFileHandle *file;
    file = [pipe fileHandleForReading];

    [task launch];

    NSData *data;
    data = [file readDataToEndOfFile];

    NSString *string;
    string = [[NSString alloc] initWithData: data encoding: NSUTF8StringEncoding];
    NSLog (@"script returned:\n%@", string);    
}
//------------------------------------------------------ 
```

编辑：包括对 NSLog 问题的修复

如果您使用 NSTask 通过 bash 运行命令行实用程序，那么您需要包含这条神奇的行来保持 NSLog 工作：

```
//The magic line that keeps your log where it belongs
[task setStandardInput:[NSPipe pipe]]; 
```

在上下文中：

```
NSPipe *pipe;
pipe = [NSPipe pipe];
[task setStandardOutput: pipe];
//The magic line that keeps your log where it belongs
[task setStandardInput:[NSPipe pipe]]; 
```

解释在这里：[http ://www.cocoadev.com/index.pl?NSTask](http://www.cocoadev.com/index.pl?NSTask)

* * *

## 回答 #4

> 赞同：27
> 
> 时间：2015-08-27T03:12:10.007

# 这是在 Swift 中的操作方法

> Swift 3.0 的变化：
> 
> *   `NSPipe`已更名`Pipe`
>     
>     
> *   `NSTask`已更名`Process`

* * *

这是基于上面 inkit 的 Objective-C 答案。他把它写成一个***类别***——对于***Swift***，`NSString`它成为.*`String`*

 *### 扩展 String.runAsCommand() -> 字符串

```
extension String {
    func runAsCommand() -> String {
        let pipe = Pipe()
        let task = Process()
        task.launchPath = "/bin/sh"
        task.arguments = ["-c", String(format:"%@", self)]
        task.standardOutput = pipe
        let file = pipe.fileHandleForReading
        task.launch()
        if let result = NSString(data: file.readDataToEndOfFile(), encoding: String.Encoding.utf8.rawValue) {
            return result as String
        }
        else {
            return "--- Error running command - Unable to initialize string from file data ---"
        }
    }
} 
```

* * *

### 用法：

```
let input = "echo hello"
let output = input.runAsCommand()
print(output)                        // prints "hello" 
```

    要不就：

```
print("echo hello".runAsCommand())   // prints "hello" 
```

### 例子：

```
@IBAction func toggleFinderShowAllFiles(_ sender: AnyObject) {

    var newSetting = ""
    let readDefaultsCommand = "defaults read com.apple.finder AppleShowAllFiles"

    let oldSetting = readDefaultsCommand.runAsCommand()

    // Note: the Command results are terminated with a newline character

    if (oldSetting == "0\n") { newSetting = "1" }
    else { newSetting = "0" }

    let writeDefaultsCommand = "defaults write com.apple.finder AppleShowAllFiles \(newSetting) ; killall Finder"

    _ = writeDefaultsCommand.runAsCommand()

} 
```

* * *

请注意从is对象`Process`读取的结果。它可能是一个错误字符串，也可能是一个空字符串，但它应该始终是一个.`Pipe``NSString``NSString`

因此，只要它不是 nil，结果就可以转换为 Swift`String`并返回。

如果由于某种原因根本`NSString`无法从文件数据中初始化，该函数将返回错误消息。该函数可以编写为返回一个 optional `String?`，但这使用起来会很尴尬，并且不会起到有用的作用，因为这种情况不太可能发生。

* * *

## 回答 #5

> 赞同：21
> 
> 时间：2013-09-25T20:20:13.383

### Objective-C（见下文 Swift）

清理了顶部答案中的代码，使其更具可读性，更少冗余，增加了[单行方法](https://stackoverflow.com/a/12310154/528645)的好处并制成了 NSString 类别

```
@interface NSString (ShellExecution)
- (NSString*)runAsCommand;
@end 
```

执行：

```
@implementation NSString (ShellExecution)

- (NSString*)runAsCommand {
    NSPipe* pipe = [NSPipe pipe];

    NSTask* task = [[NSTask alloc] init];
    [task setLaunchPath: @"/bin/sh"];
    [task setArguments:@[@"-c", [NSString stringWithFormat:@"%@", self]]];
    [task setStandardOutput:pipe];

    NSFileHandle* file = [pipe fileHandleForReading];
    [task launch];

    return [[NSString alloc] initWithData:[file readDataToEndOfFile] encoding:NSUTF8StringEncoding];
}

@end 
```

用法：

```
NSString* output = [@"echo hello" runAsCommand]; 
```

如果**您**在输出编码方面遇到问题：

```
// Had problems with `lsof` output and Japanese-named files, this fixed it
NSString* output = [@"export LANG=en_US.UTF-8;echo hello" runAsCommand]; 
```

希望它对你和未来的我一样有用。（你好！）

* * *

### 斯威夫特 4

这是一个使用`Pipe`,`Process`和的 Swift 示例`String`

```
extension String {
    func run() -> String? {
        let pipe = Pipe()
        let process = Process()
        process.launchPath = "/bin/sh"
        process.arguments = ["-c", self]
        process.standardOutput = pipe

        let fileHandle = pipe.fileHandleForReading
        process.launch()

        return String(data: fileHandle.readDataToEndOfFile(), encoding: .utf8)
    }
} 
```

用法：

```
let output = "echo hello".run() 
```

* * *

## 回答 #6

> 赞同：15
> 
> 时间：2009-01-05T08:47:02.373

[fork](http://developer.apple.com/documentation/Darwin/Reference/ManPages/man2/fork.2.html)、[exec](http://developer.apple.com/documentation/Darwin/Reference/ManPages/man3/exec.3.html)和[wait](http://developer.apple.com/documentation/Darwin/Reference/Manpages/man2/wait.2.html)应该可以工作，如果您不是真的在寻找特定于 Objective-C 的方式。`fork`创建当前运行程序的副本，`exec`用新程序替换当前运行的程序，并`wait`等待子进程退出。例如（没有任何错误检查）：

```
#include <stdlib.h>
#include <unistd.h> 
```

```
pid_t p = fork();
if (p == 0) {
    /* fork returns 0 in the child process. */
    execl("/other/program/to/run", "/other/program/to/run", "foo", NULL);
} else {
    /* fork returns the child's PID in the parent. */
    int status;
    wait(&status);
    /* The child has exited, and status contains the way it exited. */
}

/* The child has run and exited by the time execution gets to here. */ 
```

还有[system](http://developer.apple.com/documentation/Darwin/Reference/ManPages/man3/system.3.html)，它运行命令就像你从 shell 的命令行中键入它一样。它更简单，但您对情况的控制较少。

我假设您正在使用 Mac 应用程序，因此这些链接指向 Apple 的这些功能的文档，但它们都是`POSIX`，因此您应该在任何符合 POSIX 的系统上使用它们。

* * *

## 回答 #7

> 赞同：11
> 
> 时间：2009-01-13T12:54:33.970

还有很好的旧 POSIX[系统](http://developer.apple.com/documentation/Darwin/Reference/ManPages/man3/system.3.html)（“echo -en '\007'”）；

* * *

## 回答 #8

> 赞同：8
> 
> 时间：2013-05-24T21:00:16.693

我写了这个“C”函数，因为`NSTask`它很讨厌..

```
NSString * runCommand(NSString* c) {

    NSString* outP; FILE *read_fp;  char buffer[BUFSIZ + 1];
    int chars_read; memset(buffer, '\0', sizeof(buffer));
    read_fp = popen(c.UTF8String, "r");
    if (read_fp != NULL) {
        chars_read = fread(buffer, sizeof(char), BUFSIZ, read_fp);
        if (chars_read > 0) outP = $UTF8(buffer);
        pclose(read_fp);
    }   
    return outP;
}

NSLog(@"%@", runCommand(@"ls -la /")); 

total 16751
drwxrwxr-x+ 60 root        wheel     2108 May 24 15:19 .
drwxrwxr-x+ 60 root        wheel     2108 May 24 15:19 ..
… 
```

哦，为了完整/明确……</p>

```
#define $UTF8(A) ((NSString*)[NSS stringWithUTF8String:A]) 
```

多年后，对我来说，`C`仍然是一个令人眼花缭乱的烂摊子……而且对我纠正上述严重缺点的能力几乎没有信心——我提供的唯一橄榄枝是@inket 答案的改版版本，对于我的同胞来说，这是*最*简单的纯粹主义者/冗长的仇恨者...

```
id _system(id cmd) { 
   return !cmd ? nil : ({ NSPipe* pipe; NSTask * task;
  [task = NSTask.new setValuesForKeysWithDictionary: 
    @{ @"launchPath" : @"/bin/sh", 
        @"arguments" : @[@"-c", cmd],
   @"standardOutput" : pipe = NSPipe.pipe}]; [task launch];
  [NSString.alloc initWithData:
     pipe.fileHandleForReading.readDataToEndOfFile
                      encoding:NSUTF8StringEncoding]; });
} 
```

* * *

## 回答 #9

> 赞同：4
> 
> 时间：2019-02-18T07:19:00.197

除了上面几个优秀的答案，我使用下面的代码在后台处理命令的输出，避免`[file readDataToEndOfFile]`.

```
- (void)runCommand:(NSString *)commandToRun
{
    NSTask *task = [[NSTask alloc] init];
    [task setLaunchPath:@"/bin/sh"];

    NSArray *arguments = [NSArray arrayWithObjects:
                          @"-c" ,
                          [NSString stringWithFormat:@"%@", commandToRun],
                          nil];
    NSLog(@"run command:%@", commandToRun);
    [task setArguments:arguments];

    NSPipe *pipe = [NSPipe pipe];
    [task setStandardOutput:pipe];

    NSFileHandle *file = [pipe fileHandleForReading];

    [task launch];

    [self performSelectorInBackground:@selector(collectTaskOutput:) withObject:file];
}

- (void)collectTaskOutput:(NSFileHandle *)file
{
    NSData      *data;
    do
    {
        data = [file availableData];
        NSLog(@"%@", [[NSString alloc] initWithData:data encoding:NSUTF8StringEncoding] );

    } while ([data length] > 0); // [file availableData] Returns empty data when the pipe was closed

    // Task has stopped
    [file closeFile];
} 
```

* * *

## 回答 #10

> 赞同：3
> 
> 时间：2011-01-28T11:37:25.550

Custos Mortem 说：

> 我很惊讶没有人真正陷入阻塞/非阻塞呼叫问题

有关以下内容的阻塞/非阻塞呼叫问题`NSTask`：

> asynctask.m -- 示例代码，展示了如何实现异步标准输入、标准输出和标准错误流以使用 NSTask 处理数据

asynctask.m 的源代码可在[GitHub](https://gist.github.com/atr000/621601)获得。

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2009-01-05T08:32:25.930

或者由于 Objective C 只是 C 上面有一些 OO 层，你可以使用 posix conterparts：

```
int execl(const char *path, const char *arg0, ..., const char *argn, (char *)0);
int execle(const char *path, const char *arg0, ..., const char *argn, (char *)0, char *const envp[]);
int execlp(const char *file, const char *arg0, ..., const char *argn, (char *)0);
int execlpe(const char *file, const char *arg0, ..., const char *argn, (char *)0, char *const envp[]);
int execv(const char *path, char *const argv[]);
int execve(const char *path, char *const argv[], char *const envp[]);
int execvp(const char *file, char *const argv[]);
int execvpe(const char *file, char *const argv[], char *const envp[]); 
```

它们包含在 unistd.h 头文件中。

* * *

## 回答 #12

> 赞同：2
> 
> 时间：2011-07-11T00:46:59.400

如果终端命令需要管理员权限（又名`sudo`），请`AuthorizationExecuteWithPrivileges`改用。下面会创建一个名为“com.stackoverflow.test”的文件，就是根目录“/System/Library/Caches”。

```
AuthorizationRef authorizationRef;
FILE *pipe = NULL;
OSStatus err = AuthorizationCreate(nil,
                                   kAuthorizationEmptyEnvironment,
                                   kAuthorizationFlagDefaults,
                                   &authorizationRef);

char *command= "/usr/bin/touch";
char *args[] = {"/System/Library/Caches/com.stackoverflow.test", nil};

err = AuthorizationExecuteWithPrivileges(authorizationRef,
                                         command,
                                         kAuthorizationFlagDefaults,
                                         args,
                                         &pipe); 
```

# sql-server - SQL 删除（在活动监视器中暂停）

> ID：412590
> 
> 赞同：2
> 
> 时间：2009-01-05T08:47:49.953
> 
> 标签：sql-server, sql-server-2005

我有一个包含数百个条目的表，我正在尝试删除一个小范围。这需要很长时间，实际上它没有被执行。

我从活动监视器监视查询，其状态为“暂停”

有谁知道可能导致此问题的原因？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-05T08:51:26.653

您正在运行的 SQL 是什么？表上的任何触发器，或对具有触发器的表的任何级联删除？“阻止者”列或等待类型中有任何内容吗？

尝试在管理工作室中执行以下操作（在相关数据库上）：

```
dbcc checkdb
dbcc checkcatalog 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-06T00:33:34.630

根据数据库的大小和删除行时必须检查的约束数量，删除可能需要非常非常长的时间。我从不从我的数据库中一次删除超过一行。它在系统上太耗费资源了。这是游标或非数据库代码（C#、Java 等）中的迭代可以击败基于集合的查询的少数几个地方之一。我什至在删除之间设置了几毫秒的小延迟，以确保没有任何东西被锁定太久。您可以通过从表中删除一系列数据来使数据库崩溃。

# c# - 在 C# 中创建自定义设置

> ID：412596
> 
> 赞同：1
> 
> 时间：2009-01-05T08:51:38.353
> 
> 标签：c#, installation

你能帮我找到我下面提到的问题的解决方案吗？

实际上，我已经为我的应用程序创建了自定义安装程序。其中，我包含了一个询问安装位置的表格。如何将此位置传递给安装程序。我在 context.paramenter["targetdir"]=text1.text 设置了值。但安装程序始终使用默认位置，如 c:\programefiles\manufacturename\productname。我想向用户询问此安装位置，然后将其传递给安装程序。

任何人都可以帮助我吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-05T20:11:17.280

如果您愿意花一些时间学习，那么在[http://wix.sourceforge.net/上有一个免费且高度可定制的安装程序/安装程序创建工具，称为 Windows Installer XML (WIX)](http://wix.sourceforge.net/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-05T21:26:30.373

如果您创建了一个标准的 Visual Studio 部署项目，该项目将已经包含一个要求安装位置的表单，并且会将您放在“文件系统”面板的“应用程序文件夹”中的所有文件安装到该文件夹​​中。此文件夹路径可作为 TARGETDIR 属性用于脚本或条件。这一切都是自动完成的，如果它不起作用，你已经改变了一些东西。

# winforms - 如何以编程方式与应用程序交互

> ID：412598
> 
> 赞同：9
> 
> 时间：2009-01-05T08:53:52.173
> 
> 标签：winforms

我可能很快就会从事一些项目，我需要从文件中获取数据并将该数据以编程方式输入到另一个第三方（不是我自己的）应用程序中。一个问题：我不知道该怎么做。我需要输入数据（例如时间表上的时间） 谁能引导我朝着正确的方向学习这项技能？

附加规格：我在深夜写了原始帖子，所以可能没有我应该做的那么详细。下面是一个示例：我的客户有一个 ERP 应用程序，他们使用该应用程序从一线工人那里收集时间戳，因为他们执行工作并全天完成项目。这个应用程序没有我可以用来输入数据的 API。我听说有人能够以编程方式将数据实际推送到此应用程序的窗口和控件中的屏幕上，以便能够将数据收集到例如 Excel 工作表中，然后有效地上传到此应用程序中。有点像反向屏幕刮擦。它不像 API，但它确实有效。

我已经看到应用程序以类似的方式与其他应用程序交互。我能想到的一个很好的例子是截图实用程序 SnagIt。您可以命令它在特定应用程序中截屏一个窗口，当您在该窗口周围移动鼠标时，指针下的控件将以红色轮廓显示，以指示它将为您捕获哪个控件。我认为这很有趣，而且可能距离真正能够在这样的控件中输入文本*仅一步之遥*。

感谢您到目前为止的评论和答案，我正在追求它们。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-01-05T13:27:53.803

您可能可以使用[AutoIt](http://www.autoitscript.com/autoit3/)脚本将其自动化。这是一种简单的脚本语言，它隐藏了向窗口和控件发送消息的一些复杂性。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-01-05T09:04:59.513

不同的应用程序允许您以不同的方式以编程方式控制它们。两种最常见的方法是：

1) 一些应用程序公开命令行参数。例子：

```
c:\> someapp.exe arg1 arg2 
```

您可以通过如下调用从 C++ 程序调用此类应用程序：

```
System("C:\\>someapp.exe arg1 arg2"); 
```

2) 其他应用程序可能会公开更强大的面向对象的 API。例如，Microsoft Excel 允许您通过将 App 本身用作 C# 程序中的对象来对其进行编程：

```
Excel.Application excelApp = new Excel.App() 
```

一旦你有了 app 对象，你就可以调用它的方法来控制它的行为。例如，您可以使用以下调用打开一个新的 Excel 文件：

```
excelApp.Workbooks.Open("\\Somefile.xls", ...); 
```

对于您尝试控制的任何第三方应用程序，您将不得不阅读其文档以了解它如何让您做到这一点。例如，有关如何编程 Excel 的信息可以在[此处](http://msdn.microsoft.com/en-us/library/bb242656.aspx)找到。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-01-05T09:34:23.573

如果应用程序不是为与之交互而设计的，那可能会非常非常困难。您将需要发送模拟事件（例如假装鼠标在做某些事情）。一种方法是编写一个不连接到真实鼠标的鼠标驱动程序。但是，正如我所说，这取决于应用程序。具有较大用户群的应用程序通常具有允许编程交互的 API，或者具有内置的脚本功能（因此您可以让应用程序使用您的代码）。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-01-05T09:34:44.507

我认为[FindWindow](http://msdn.microsoft.com/en-us/library/ms633499.aspx)和[SendMessage](http://msdn.microsoft.com/en-us/library/ms644950%28VS.85%29.aspx)通常是您要使用的功能。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-05T09:16:50.927

我曾经做过类似的事情，其中​​一个 Windows 应用程序由一个 Web 应用程序控制。我为此使用了很多 Win32 API。如果您的应用程序是类似的应用程序，则为初学者寻找开源 Winamp 遥控器。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-05T13:00:15.047

或者，如果您想更加“hacky”，请开始读取程序内存并直接注入数据。:P

但这可能非常复杂，并且由于程序如何使用内存而通常根本不起作用。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-01-05T13:01:15.417

这不是最漂亮的方法，但我见过一些应用程序使用剪贴板来做这样的事情。不幸的是，这可能还需要手动干预，因为您可能没有办法让应用程序以编程方式从剪贴板拉出/推送到剪贴板。

# c++ - 具有布尔字段默认初始化的结构？

> ID：412611
> 
> 赞同：2
> 
> 时间：2009-01-05T09:07:05.610
> 
> 标签：c++

我有以下用例，一个带有一些 boolean 和 int 变量的结构

```
struct a {

    int field1;
    bool field2;
    bool field3;

}; 
```

我正在重构这段代码，并为 struct 编写一个构造函数，问题是字段的默认初始化。

我不是在这里批评任何语言结构，但理想情况下我希望 null 成为语言本身的一部分

我的意思是我应该能够为 struct a 定义为

```
a : field1(null.int), field2(null.bool), field3(null.bool) {} 
```

C++ 不允许它，因为 null.int 或 null.bool 没有定义。在 C++ 中做的唯一方法是

```
a: field1(-1), field2(false), field3(false) {} 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-01-05T09:08:53.547

你可以做

```
struct a {
    a():field1(), field2(), field3() { }
    int field1;
    bool field2;
    bool field3;
}; 
```

所有字段将分别为零和假。如果您要说字段具有不确定的值，恐怕您必须使用其他技术。一种是使用[`boost::optional`](http://www.boost.org/doc/libs/1_35_0/libs/optional/doc/html/index.html)：

```
struct a {
    a():field1(int()), field2(bool()) { }
    optional<int> field1;
    optional<bool> field2;
    optional<bool> field3;
}; 
```

使 field3 不确定。使用 访问值`*field_name`。`field == boost::none`用or测试无值`if(field) { ... }`。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-01-05T09:24:20.520

如果您正在寻找值为 {true, false, null} 的类型，则该类型不是 bool。然而，`boost::optional<bool>`就是这样的类型。同理，`boost::optional<int>` 可以保存任何 int，或者根本不保存 int。

[编辑] 或者`std::optional`，从 C++17 开始。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-01-05T09:10:58.487

布尔值有两种状态。这就是使它成为布尔值的原因。因此，在任何强类型语言中，布尔值要么为真，要么为假。

c/c++（和java）中的整数是数字的直接二进制表示。您可以为该数字指定一个值以表示“该数字没有价值”，但这在所有情况下都没有意义 - 如果语言要考虑到这一点，则每个数学运算都必须先进行检查- 它真的会减慢速度。

底线：如果您想要一个弱类型系统，请使用另一种语言。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-01-05T09:12:32.307

您似乎希望能够说这些字段处于未定义状态。

这违背了强类型语言（例如 C++）的原则，所以你很不走运。
如果您想检查某些内容是否已定义，您需要自己显式跟踪它。您可能会使用指针来解决您的问题，但我个人认为这不是一个好主意。

也许如果你试图解释你试图解决的真正问题，我们可以提供更好的建议。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-01-05T09:25:46.103

这是不为您不使用的任何东西付费的 c++ 方式，默认初始化和具有未初始化布尔值的能力是许多人不需要的。

如果您真的想要这种行为，您可以构建您正在使用的类型的可为空版本。类似的东西：

```
class NullBool {
  bool m_null;
  bool m_value;
  public:
  NullBool() : m_null(true) {}
  NullBool(bool value) : m_null(false), m_value(value) {}
  void isNull() const {
    return m_null;
  }
  void value() const {
    return m_value;
  }
  ...
  // lots of operations
  ...
}; 
```

这可能应该构建为模板，以便开箱即用地适用于更多类型。而且由于它是您自己的类型，您可以轻松地将默认构造函数设置为默认为空。

# tfs - 为什么从 TFS 中的功能分支合并回来如此痛苦？

> ID：412613
> 
> 赞同：1
> 
> 时间：2009-01-05T09:08:29.443
> 
> 标签：tfs, merge, branch

我们有一个 HEAD 分支，以及一个从 HEAD 分支创建的功能分支。我在功能分支上进行开发，并不断将 HEAD 的更改合并到我的分支。

完成该功能后，我尝试将其合并回 HEAD。这应该是一个 0-pain 操作，因为所有冲突都已经在之前合并到功能分支时得到了解决。然而，它从来都不是。

我最终复制了我的分支的全部内容并用它覆盖了 HEAD 分支。这是 Team Foundation System 2005 和 2008 中的情况。是错误还是我做错了什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-30T17:25:01.897

我已经能够通过两种方式克服这个缺陷。

1.  在功能完成之前，我从不与 main 或 HEAD 合并。（适用于 HEAD 更改对功能不重要的情况。）

2.  这个很复杂。每次我决定将 HEAD 合并到功能分支时，我都会从 HEAD 创建一个我称之为集成分支的东西。然后我对特性分支分支变更集或特性分支上的第一个变更集进行毫无根据的合并。这将文件放在一起，并且是 TFS 应该允许我提供或检测两个兄弟姐妹之间的基础的一个论点。（我觉得这与历史不遵循分支有关。Team Foundation Power Toys 解决了这个问题。）当然要签入以完成关系的建立。然后我在功能分支和新的集成分支之间进行定期合并。这允许我在单个变更集中合并功能分支项。然后我在我的集​​成分支上工作，让我的特性分支死掉。当然，我在功能分支上丢失了历史记录，但我

对不起，它太复杂了。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-05T11:52:59.127

事情就是这样，真的。假设我们的特性分支上有两个变更集，然后从 Head 合并一个新的变更集。

```
Head: Base ----------------> H1 --
           \ \
Ftre: -> 分支 -> F1 -> F2 --> H1'
```

请注意，即使没有进行任何更改（解决冲突），这`H1`也是对 的不同签入`H1'`

当我们现在从 Ftre 合并回 Head 时，我们有变更集`F1`，`F2`并且`H1'`从 运行，但是 Head 在之后`Base`有一个额外的变更集。`H1``Base`

由于我们知道要合并回 Head 的变更集包含所有功能`H1`，因此丢弃 Head 中的变更（即变更集`H1`）并仅从 Ftre 中获取变更集是没有问题的。但是，您不能从 GUI 执行此操作（除非最新版本允许这样做），而且很遗憾，我已经有一段时间没有使用 TFS 为您提供命令行语法了。

# java - 在 C++/Java 中创建 sql 查询？

> ID：412615
> 
> 赞同：6
> 
> 时间：2009-01-05T09:10:23.013
> 
> 标签：java, c++, sql, format, stream

您更喜欢哪种方法来创建动态 sql 查询？格式化还是流式传输？它只是偏好还是有任何理由比其他更好？或者您使用的任何特殊库。

编辑：请在 c++ 的情况下回答。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-01-05T13:42:39.187

始终使用“prepare”将有一个等价于 prepareStatement 但确切的函数名称将取决于您的数据库和驱动程序组合。

与 execute(String) 相比，prepared statement 的优点有很多：-

当执行“准备”语句时，该语句被解析并且访问计划仅确定一次。根据您运行该语句的次数，这可以带来更好的性能。

当您通过 setString() 传递字符串数据时，您无需担心字符串数据中的特殊字符。在 execute(String) 中，数据中的任何单引号或分号都会导致解析错误。

更糟糕的是“sql 注入”攻击的工作方式。如果像 "x' from cust_table; delete from cust_table; select " 这样的字符串作为数据输入，它很可能会导致删除语句被解析和执行。

处理数字要高效得多。setInt 调用采用整数值，对于等效的 SQL 字符串，您必须将其转换为字符，然后 DBMS 必须将其转换回整数。

可读性。您编写一个带有几个问号的单个 SQL 语句，变量所在的位置相对容易阅读，而不是在心理上解析和分析一系列字符串连接，因为转义引号等会产生额外的噪音。

然而，在某些情况下 execute(String) 实际上更好。

您的密钥分布非常不均匀。EG 如果您的客户中有 95% 居住在美国，并且您想列出居住在加拿大的 4%，那么“国家/地区 = 哪里？” 通常会导致表空间扫描，而使用 "where country = 'CA'" 您有一些机会使用索引。

另一种情况是用户可以输入或省略几个搜索条件。为您给出的标准构建一个 SQL 字符串比构建一个复杂的查询来应对输入标准的所有可能排列要好得多。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-01-05T09:25:29.817

在 Java 中，您应该使用[PreparedStatement](http://java.sun.com/j2se/1.5.0/docs/api/java/sql/PreparedStatement.html)。

```
PreparedStatement statement = connection.prepareStatement("SELECT * FROM Table WHERE ID = ?");
statement.setInt(1, 17);
ResultSet resultSet = statement.executeQuery(); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-06T23:16:14.350

**当无法使用准备好的语句时**，我发现使用 C++ 流是编写查询的最佳方式：

```
std::ostringstream sql;
sql << "exec loadStuff(" << param1 << ", " << param2 << ")"; 
```

不必担心参数的类型和字符串的长度很棒！

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-13T13:04:33.090

有一些东西叫做[SOCI - C++ 的 C++ 数据库访问](http://soci.sourceforge.net/index.html)库

# c# - 在 C# 中创建自定义设置的问题

> ID：412626
> 
> 赞同：2
> 
> 时间：2009-01-05T09:19:16.427
> 
> 标签：c#, installation

我为我的应用程序（c#）创建了一个自己的安装程序。在安装过程中，我会询问最终用户的安装位置。我的问题是如何将该安装位置（用户输入）传递给安装程序。安装程序总是试图安装在 c:\progam files[mfr name][product name]。

请帮我

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-05T09:25:14.387

安装程序将询问安装位置，并将其放入名为 %TARGETDIR% 的安装程序变量中。您可以将此作为自定义参数提供给您的自定义操作，以便他们可以使用它来执行其他职责。

转到自定义操作查看器，然后为您的自定义操作选择属性。

输入以下内容作为[CustomActionData](http://msdn.microsoft.com/en-us/library/2w2fhwzz(VS.80).aspx)参数：

> /TARGETDIR="[TARGETDIR]\"

然后在您的自定义操作代码中，您可以使用以下内容访问此属性：

```
string targetDir = Context.Parameters["TARGETDIR"]; 
```

（感谢[Tafa](https://stackoverflow.com/users/22186/tafa)启发我改进我的答案）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-05T09:47:20.817

如果它不仅需要目标目录，而且在设置过程中确定了一些其他值，那么[CustomActionData](http://msdn.microsoft.com/en-us/library/2w2fhwzz(VS.80).aspx)就是要走的路。然后，应使用[安装程序来达到该值。](http://msdn.microsoft.com/en-us/library/system.configuration.install.installer.aspx)例如;

```
this.Context.Parameters["targ"]; 
```

在安装程序代码中，将获得 CustomActionData /targ="someValue" 的值

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-05T09:58:26.677

假设您已经在 Visual Studio 中创建了安装程序，您可以通过右键单击安装项目并选择查看->文件系统来控制部署的文件。在“目标机器上的文件系统”树中，用户输入的安装位置将成为“应用程序文件夹”（对于 WinForms 项目）或“Web 应用程序文件夹”（对于 Web 项目）。因此，通过将文件部署到该特殊文件夹，它们最终会出现在正确的位置。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-05T10:26:50.113

我们在安装程序类的 install 方法中编写的任何代码都只有在安装过程完成后才会生效。那么如何改变安装的目标目录呢？

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2010-12-15T21:40:01.270

如果您在路径中安装，获取此值会出现问题：

```
"C:\Program Files (x86)\AppName" 
```

目标目录正在获取`C:\Program Files(x86)\AppName`

# c# - 如何在 C# 中检索磁盘信息？

> ID：412632
> 
> 赞同：49
> 
> 时间：2009-01-05T09:23:14.843
> 
> 标签：c#, disk

我想使用 C# 访问计算机上逻辑驱动器上的信息。我应该如何做到这一点？谢谢！

* * *

## 回答 #1

> 赞同：76
> 
> 时间：2009-01-05T09:27:49.280

对于大多数信息，您可以使用[DriveInfo](http://msdn.microsoft.com/en-us/library/system.io.driveinfo.aspx)类。

```
using System;
using System.IO;

class Info {
    public static void Main() {
        DriveInfo[] drives = DriveInfo.GetDrives();
        foreach (DriveInfo drive in drives) {
            //There are more attributes you can use.
            //Check the MSDN link for a complete example.
            Console.WriteLine(drive.Name);
            if (drive.IsReady) Console.WriteLine(drive.TotalSize);
        }
    }
} 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2016-09-29T06:20:40.847

如果您想在本地计算机上获取**单个/特定驱动器的信息。**您可以使用[DriveInfo](https://msdn.microsoft.com/en-us/library/system.io.driveinfo.aspx)类执行以下操作：

```
//C Drive Path, this is useful when you are about to find a Drive root from a Location Path.
string path = "C:\\Windows";

//Find its root directory i.e "C:\\"
string rootDir = Directory.GetDirectoryRoot(path);

//Get all information of Drive i.e C
DriveInfo driveInfo = new DriveInfo(rootDir); //you can pass Drive path here e.g   DriveInfo("C:\\")

long availableFreeSpace = driveInfo.AvailableFreeSpace;
string driveFormat = driveInfo.DriveFormat;
string name = driveInfo.Name;
long totalSize = driveInfo.TotalSize; 
```

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-09-06T05:43:01.050

没有驱动器号的已安装卷怎么办？

```
foreach( ManagementObject volume in 
             new ManagementObjectSearcher("Select * from Win32_Volume" ).Get())
{
  if( volume["FreeSpace"] != null )
  {
    Console.WriteLine("{0} = {1} out of {2}",
                  volume["Name"],
                  ulong.Parse(volume["FreeSpace"].ToString()).ToString("#,##0"),
                  ulong.Parse(volume["Capacity"].ToString()).ToString("#,##0"));
  }
} 
```

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2009-01-05T09:29:28.420

使用 System.IO.DriveInfo 类 [http://msdn.microsoft.com/en-us/library/system.io.driveinfo.aspx](http://msdn.microsoft.com/en-us/library/system.io.driveinfo.aspx)

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-01-05T09:28:19.497

检查[DriveInfo](http://msdn.microsoft.com/en-us/library/system.io.driveinfo.aspx)类，看看它是否包含您需要的所有信息。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2020-05-04T11:06:50.950

在 ASP .NET Core 3.1 中，如果您想获得在 windows 和 linux 上都可以运行的代码，您可以按如下方式获取驱动器：

```
var drives = DriveInfo
    .GetDrives()
    .Where(d => d.DriveType == DriveType.Fixed)
    .Where(d => d.IsReady)
    .ToArray(); 
```

如果你不同时应用这两个地方，如果你在 linux 中运行代码，你会得到很多驱动器（例如“/dev”、“/sys”、“/etc/hosts”等）。

这在开发应用程序以在 Linux Docker 容器中工作时特别有用。

# c# - 如何借助 P/Invoke 创建文件以读取引导扇区并显示 .MBR？

> ID：412634
> 
> 赞同：1
> 
> 时间：2009-01-05T09:23:57.447
> 
> 标签：c#, mbr

我浏览了 CreateFile 文档...仍然想知道我应该如何使用 P/Invoke 来调用 CreateFile 并读取引导扇区，以显示 .MBR？

这部分的任何参考代码？先感谢您！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-05T09:37:11.150

要扩展 Baget 的答案，您可以`CreateFile`这样调用：

```
hFile = CreateFile("\\\\.\\physicaldrive0", 
    GENERIC_READ | FILE_SHARE_READ,
    0,
    OPEN_EXISTING,
    0,
    0); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-05T09:33:09.037

也许这个[问题](https://stackoverflow.com/questions/39503/modifying-the-mbr-of-windows)会对你有所帮助

基本上，您需要在文件名中使用此语法访问设备`"\\.\PHYSICALDRIVE0"`

# performance - 如何忽略 JMeter 中的登录和注销请求？

> ID：412649
> 
> 赞同：13
> 
> 时间：2009-01-05T09:29:43.520
> 
> 标签：performance, testing, jmeter

我正在尝试使用 JMeter 测试我们的 webapp 的性能。登录过程包括一些在测试期间无法重现的外部依赖项，因此我编写了备用登录。由于这个备用登录请求不是正常工作流程的一部分，我想从 JMeter 结果中排除登录请求，因为与其他正常请求相比，响应时间相当长。

有没有办法只为一组请求收集结果，而忽略其余的？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2009-04-30T17:31:24.057

据我所知，没有简单的排除方法。然而，通过改变你的结构，你可以得到你想要的。

听众调到所有儿童级别。因此，如果您将侦听器作为“测试计划”的直接子代，则所有线程组都将被侦听器抓取。如果您有多个线程组，并将侦听器放在线程组 A 中，它将不会从线程组 B 捕获结果。同样适用于简单控制器。

我建议采用以下结构：

```
Test Plan
- Thread Group
---- Simple Controller - Login ONLY
---- Simple Controller - Rest of Script
--------- Listener 
```

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2019-03-12T15:39:02.367

从 JMeter 4.0 开始，可以添加**SampleResult.setIgnore()** 来告诉 JMeter 忽略侦听器的 SampleResult。

> 参考：[https ://jmeter.apache.org/api/org/apache/jmeter/samplers/SampleResult.html#setIgnore--](https://jmeter.apache.org/api/org/apache/jmeter/samplers/SampleResult.html#setIgnore--)

`SampleResult`对于 Beanshell、`sampleResult`JS 和Groovy 的PS变量`prev`，请参阅 jmeter.apache.org/usermanual/functions.html。

# c# - DependencyObject 数组 C# 到 VB.NET

> ID：412653
> 
> 赞同：0
> 
> 时间：2009-01-05T09:30:33.957
> 
> 标签：c#, wpf, vb.net

我在 C# 中有一个在数组中使用的 DependencyObject。示例如下所示：

```
private KeywordTag[] tags = new KeywordTag[] {
    new KeywordTag { Tag = "test", IncidenceCount = 2076 },
    new KeywordTag { Tag = "oi", IncidenceCount = 2052 },
    new KeywordTag { Tag = "hmm", IncidenceCount = 1887 },
    new KeywordTag { Tag = "grr", IncidenceCount = 1414 },
    new KeywordTag { Tag = "thanks", IncidenceCount = 1166 }} 
```

如何将此代码转换为 VB.NET？

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-05T14:16:28.277

dummy 的回答几乎是正确的，VB.Net 的语法在构造函数之后有一个“WITH”。

```
Private tags() As KeywordTag = { _
    New KeywordTag() WITH {.Tag = test", .IncidentCount = 2076}, _
    New KeywordTag() WITH {.Tag = "oi", .IncidentCount = 2052}, _
    New KeywordTag() WITH {.Tag = "hmm", .IncidentCount = 1887}, _
    New KeywordTag() WITH {.Tag = "grr", .IncidentCount = 1414}, _
    New KeywordTag() WITH {.Tag = "thanks", .IncidentCount = 1166} _
    } 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-05T09:44:12.413

就像是：

```
Private tags() As KeywordTag = { New KeywordTag { Tag = "test", IncidenceCount = 2076 }, New KeywordTag { Tag = "oi", IncidenceCount = 2052 }, New KeywordTag { Tag = "hmm", IncidenceCount = 1887 }, New KeywordTag { Tag = "grr", IncidenceCount = 1414 }, New KeywordTag { Tag = "thanks", IncidenceCount = 1166 }} 
```

# asp.net - ajax方法

> ID：412655
> 
> 赞同：0
> 
> 时间：2009-01-05T09:32:14.653
> 
> 标签：asp.net, ajax

我在用：

```
[ajax.ajaxmethod()]
public void fnName() 
```

包含：

```
response.redirect("sample.aspx"); 
```

或者：

```
server.transfer("sample.aspx"); 
```

两者都不起作用......解决方案是什么？

在那个块中，我尝试将 javascript 函数称为

```
scriptmanager.registerstartupscript(page,gettype(),"sample","javascriptfunction()",true); 
```

它也不起作用..

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-05T11:15:52.260

我不知道你是如何使用 ASP.NET AJAX 做到这一点的，但是在[Ra-Ajax](http://ra-ajax.org)中你会使用这样的东西；

```
AjaxManager.Instance.WriterAtBack.Write("window.location='foo.aspx';"); 
```

我的猜测是，ASP.NET AJAX 也有某种方法可以将 JavaScript 附加回 Ajax 回调中，就像 Ra-Ajax 一样，您可以使用它来附加 window.location 重定向......

据我所知，没有其他方法可以做到这一点......

然而，对于 Ra-Ajax，还有一个用于重定向的“速记”版本，可以在此处找到；AjaxManager.Instance.Redirect

如果不是 ASP.NET AJAX 也有类似的东西，我会感到惊讶......

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-05T11:29:46.523

我想问题是您试图在客户端执行服务器端代码（C#）。正如托马斯回答的那样，与 response.redirect("foo.aspx") 或 server.transfer("foo.aspx") 等效的 Javascript 是 window.location='foo.aspx'。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-05T10:52:13.400

您需要提供更多详细信息，但我猜测您希望您的 ajax 请求成为重定向页面？那永远不会奏效-充其量将ajax请求本身重定向到您的新内容。

您需要 ajax 响应来提供您想要重定向到的 URL，并且前端需要了解该响应的格式（因为它只是一个字符串，否则）并对其采取行动（例如 document.location = foo）。即重定向必须发生在客户端。

当然，你可能会问一些完全不同的东西。

# .net - .NET 世界中的 ORM 和 SOA

> ID：412660
> 
> 赞同：11
> 
> 时间：2009-01-05T09:33:35.790
> 
> 标签：.net, linq, orm, soa, change-tracking

根据我的经验，.NET 的主要 ORM 框架（[NHibernate](http://nhforge.org)、[LinqToSql](http://msdn.microsoft.com/en-us/library/bb425822.aspx)、[Entity Framework](http://msdn.microsoft.com/en-us/library/aa697427%28VS.80%29.aspx)）在跟踪加载的对象时效果最好。这适用于简单的客户端-服务器应用程序，但是当在面向服务的架构中使用具有 Web 服务的三层或更多层架构时，这是不可能的。最终，通过编写大量代码自己进行跟踪可以完成，但 ORM 不应该简化数据库访问吗？

在面向服务的架构中使用 ORM 的想法真的好吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-01-05T11:47:48.390

[LLBLGen Pro](http://www.llblgen.com)在实体内部具有更改跟踪。这意味着您可以使用预取路径从数据库中获取图形（因此每个图形节点一个查询）并通过线路将其序列化到客户端，在那里进行更改，将其发送回并直接保存图形，因为所有更改跟踪都在里面实体（并在 XML 中序列化为紧凑的自定义元素）。

免责声明：我是 llblgen pro 的首席开发人员。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-01-08T04:05:21.083

这取决于您所说的“SOA”是什么意思。在服务合同中公开域对象很少是好的服务设计——它公开了内部实现细节，更改已发布合同的可能性更大，并且版本控制变得非常困难。

如果您为服务端点创建自定义消息文档（例如 WCF DataContracts），则使用 ORM 来实现服务相对容易。通常，您会从数据库重新加载域对象并映射更改的属性（或调用方法），然后持久化更改。

如果您的服务主要是 CRUD 方法，那么您的自定义消息将有效地成为 DTO。您将需要手动管理乐观并发和域对象映射。

**更新：**这是一个旧答案，所以我想指出 EF4 现在[还包括在实体中的更改跟踪](https://docs.microsoft.com/en-us/archive/blogs/efdesign/self-tracking-entities-in-the-entity-framework)。我仍然认为这是一个糟糕的服务合同设计，但如果你只是追求分布式应用程序框架，它可能是一个不错的选择。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-07-03T20:36:41.387

看一下DataObjects.Net中[即将到来的同步和断开集的描述](http://blog.dataobjects.net/2009/06/disconnected-offline-entities-poco-and.html)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-03-11T12:40:26.107

我会谦虚地建议您停止尝试将分布式对象用作架构模式。它不如消息传递架构或 RESTful 风格有效。

如果您不喜欢将数据传入和传出消息的开销，那么我建议您查看 REST。但是，REST 不像 ADO.NET 数据服务那样，它只是基于 HTTP 的分布式对象。

REST 更多的是在服务器上暴露一个丑陋的（但机器可读的）UI，并使用客户端使其看起来更漂亮。在 REST 中，客户端上没有域实体的知识，因此您不需要通过网络发送它们。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-01-05T09:46:10.040

ORM 框架只会在直接与数据库对话时为您提供帮助。即使在面向服务的架构中，ORM 也只能在对最后一层进行编程时帮助减少负载。您将需要其他技术（如[WCF](http://msdn.microsoft.com/en-us/netframework/aa663324.aspx)）来处理服务部分。[`DataContract`](http://msdn.microsoft.com/en-us/library/ms733127.aspx)我还不知道有人集成了 ORM 和服务，但是注释与实体和s相同的类应该非常简单。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-11T12:24:35.910

[SignumFramework](http://www.signumframework.com)在实体内部也有跟踪。它还有一个完整的 Linq 提供程序，但只能使用新数据库（它从您的 c# 实体生成模式，而不是相反）。

变更跟踪：[http ://www.signumframework.com/ChangeTracking.ashx](http://www.signumframework.com/ChangeTracking.ashx)

免责声明：我是 Signum 框架的首席开发人员 :)

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2010-07-21T07:39:45.650

您可以将 memcached 用作 NHibernate 的二级缓存 - 这就是您所说的“跟踪”的意思吗？

# git - 如何为另一个 SCM 提供 Git 存储库的 2 向镜像？（bzr，汞等）

> ID：412668
> 
> 赞同：7
> 
> 时间：2009-01-05T09:44:11.573
> 
> 标签：git, version-control, mercurial, dvcs, bazaar

在过去 6 个月左右的时间里，我一直在使用我们主要 Perforce 存储库的 2-way Git 镜像来评估我们的工作流程。我不得不说我爱上了使用它，但到目前为止它对我来说有一个致命的缺陷：它对 Windows 的支持很糟糕。

一般来说，这对我来说不是问题，但现在是。我需要在我的 Git 存储库中对一些本地提交的工作做一些工作，我无法从我需要工作的机器上得到它，因为这个盒子上的 Git 发行版存在一些无法解决的问题。

无论如何，如果可以的话，我想做的是运行第二个镜像：这次是从我的 Git 存储库中捎带，但通过 Mercurial 或 Bazar 提供服务。我发现了一些看起来很有前途的工具，并且博客评论中的一些参考资料说人们已经这样做了，但还没有完成。

那么谁能告诉我是否有一种简单的方法可以使用另一个可以在 Windows 上正常工作的DVCS*来维护一个到 Git 存储库的 2 路镜像？*

提前感谢您的麻烦...

杰米

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-02T10:04:40.057

GitHub 上的人们弹出了一个新选项：[git-hg](http://hg-git.github.com/)。现在有一种方法可以在 Git 和 Mercurial 之间进行双向同步。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-05T09:51:04.413

我知道 Mercurial 有一个扩展，可以让你从 git 转换为 mercurial。更多关于[https://www.mercurial-scm.org/wiki/ConvertExtension](https://www.mercurial-scm.org/wiki/ConvertExtension)

不过我自己没用过。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-01-05T09:56:53.467

[*维基化，因为这不是一个真正的答案*]

我在 Vista 上使用[MSYS git](http://code.google.com/p/msysgit/)没有问题。不过，我确实在 Debian GNU/Linux 机器上托管了我的 git 存储库。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-02-12T21:35:50.313

bzr 具有快速导入插件，因此您将能够使用快速导出/快速导入对创建 2 向转换：http: [//bazaar-vcs.org/BzrFastImport](http://bazaar-vcs.org/BzrFastImport)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-02-12T21:52:56.420

还有一个[裁缝](http://progetti.arstecnica.it/tailor)允许在多个存储库之间进行镜像。我让它在 Cygwin 上取得了相当大的成功——直到有人添加了使命令行 svn 阻塞的文件；尽管这可能是一个相当罕见的问题。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-05T09:49:27.350

Mercurial 可能对 Windows 有最好的支持（除了 git 和 bzr）。[它甚至在这里](https://tortoisehg.bitbucket.io/)有一个 TortoiseHg 扩展。

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2009-01-07T07:30:37.020

我认为您不太可能使用当前可用的 git 找到其他 DVCS 同步工具的令人满意的解决方案。[您可能可以使用git-svn](http://git-scm.com/docs/git-svn)拼凑一个可行的系统，从 get 到 subversion 和[hgsubversion](http://code.google.com/p/hgsubversion/)在 mercurial 和 subversion 之间同步，但这似乎是一个疯狂的组合，只是为了绕过 Windows 上弱 git 支持。

也许您最好从 windows 框中通过电子邮件发送差异——git 具有出色的电子邮件补丁处理支持（就像 mercurial 一样）。

# cad - Alibre 设计文件格式

> ID：412676
> 
> 赞同：0
> 
> 时间：2009-01-05T09:48:47.070
> 
> 标签：cad, step

有没有人尝试以编程方式读取[Alibre Design](http://www.alibre.com) CAD 文件？
我看到零件文件 (*.AD_PRT) 的深处有一个 STEP/ISO 10303-21 结构，但我想知道文件的其余部分。它是专有的吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-12T14:31:26.397

Alibre 产品经理（通过电子邮件）告诉我，目前没有针对 AD_PRT 文件的“开放”规范（而且看起来格式经常更改）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-08-13T01:42:48.843

我希望文件的其余部分是专有的。但是，如果您只需要几何图形，那么 STEP 文件流可能就足够了。

# asp.net-1.1 - IE保存excel文件时提示输入密码

> ID：412680
> 
> 赞同：0
> 
> 时间：2009-01-05T09:49:51.233
> 
> 标签：asp.net-1.1

文件使用 Response.writefile 和内容处置作为内联发送到客户端。当用户选择另存为时，即使启用了匿名访问，也会要求他们再次使用 IIS 进行身份验证

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-01-05T11:51:20.893

猜测一下，我建议查看 Excel 文件的所有权。据推测，IUSR 需要对它进行读写。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-05T20:59:57.403

写入时文件的路径是什么？

用户是否具有创建文件的适当权限？

# installation - 创建安装程序时使用 CustomActionData 的问题

> ID：412683
> 
> 赞同：0
> 
> 时间：2009-01-05T09:52:02.290
> 
> 标签：installation

任何人都可以解释如何通过代码将安装位置传递给安装程序？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-06T14:02:10.150

使用安装程序项目上的 customactiondata 属性作为 msi 的输出，例如：

InstallLoc="[TARGETDIR]\"

并在安装程序项目中使用如下代码：

```
installDir = this.Context.Parameters["InstallLoc"]; 
```

# xml - xml xslt 问题

> ID：412687
> 
> 赞同：1
> 
> 时间：2009-01-05T09:54:25.653
> 
> 标签：xml, xslt

我有一个在“word”元素中包含文本的 xml，例如

```
<word>Police</word>
<word>confirmed</word>
<word>they are</word>
<word>questioning</word>
<word>a</word>
<word>man</word> 
```

问题是当我应用 xslt 时，文本看起来像“警察确认他们是质疑人”。

这是执行此转换的 xslt 片段

```
<Paragraph>
 <xsl:for-each select="./speaker/segment">
 <xsl:value-of select="./nbest"/>
 </xsl:for-each>
</Paragraph> 
```

任何人都可以就我如何将其显示为“警方确认他们正在审问一名男子”提供任何帮助吗？

非常感谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-05T10:16:08.433

您可以根据单词的位置有条件地在单词之间添加空格。以下片段显示了如何在除最后一个单词之外添加空格。

```
<xsl:template match="//words">
    <xsl:for-each select="word">
      <xsl:value-of select="."/>
      <!-- Check word's position -->
      <xsl:if test="position()!=last()">
      <!-- Add a whitespace if it's not the last word -->
        <xsl:text> </xsl:text>
      </xsl:if>
    </xsl:for-each>
</xsl:template> 
```

如果您生成 HTML 输出，您可以使用[这篇文章](https://stackoverflow.com/questions/31870/using-a-html-entity-in-xslt-e-g-nbsp#31873)中的信息来了解如何添加空格（而不是我的代码片段中的 <xst:text>）

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-05T10:16:40.430

添加一个空格字符。

简单的方法：

```
<Paragraph>
 <xsl:for-each select="./speaker/segment">
   <xsl:value-of select="./nbest"/>&#160;
 </xsl:for-each>
</Paragraph> 
```

有效修剪字符串的稍微复杂的方法：

```
<Paragraph>
 <xsl:for-each select="./speaker/segment">
   <xsl:if test="not(position() = 1)">&#160;</xsl:if>
   <xsl:value-of select="./nbest"/>
 </xsl:for-each>
</Paragraph> 
```

还有一些[xpath](http://www.w3schools.com/Xpath/xpath_functions.asp)方式：各种形式的**normalize-space**、**substring-before**、**substring-after**。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-05T10:29:55.800

这几乎就像“aku”的答案。但是“aku”答案创建了一个段落。

```
 <xsl:for-each select="./speaker/segment">  
 <Paragraph>   
    <xsl:for-each select="./nbest/word"/>        
      <xsl:value-of select="."/>
        <xsl:if test="position()!=last()">
          <xsl:text> </xsl:text>
        </xsl:if>        
    </xsl:for-each>
 </Paragraph>
</xsl:for-each> 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-01-05T11:09:47.467

它们一起运行的原因是样式表使用内置模板来匹配正在折叠空白区域的模板。我看不到您在哪里显式调用`<word/>`XML 或周围的 XML，所以我假设它是`<xsl:apply-templates />`某个地方的调用。您应该只需要像这样定义一个匹配模板：

```
<xsl:template match="word">
    <xsl:value-of select="." />&#160;
</xsl:template> 
```

空白很重要，所以如果在上面的解决方案中，你发现它搞砸了，你可以把它包装在一个`<xsl:text/>`节点内，空白就消失了。

然后当单词节点匹配时，你会得到它的间隔。注意：最后会有一个额外的空间。为了摆脱它，它会稍微长一点。

```
<xsl:temmplate match="word">
    <xsl:value-of select="." />
    <xsl:if test=". !=../word[last()]">
        <xsl:text>&#160;</xsl:text>
    </xsl:if>
</xsl:template> 
```

这仅在应用模板时有效，而在使用 xsl 指令的 value-of 或 copy-of 时无效。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-05T10:05:32.513

试试这个添加 &npsp; 在标签值之后

# c# - 动态生成 RadioButtonList

> ID：412691
> 
> 赞同：-1
> 
> 时间：2009-01-05T09:58:08.453
> 
> 标签：c#, .net, asp.net

我将`asp:CheckBoxList`使用此代码生成一个

```
<%

System.Collections.Generic.List<QuizzEngine.Common.Question> qList = (System.Collections.Generic.List<QuizzEngine.Common.Question>)Session[QuizzEngine.Common.SessionKeys.QuesionsList];

int navigator = (int)Session[QuizzEngine.Common.SessionKeys.Navigator];

if (True)

{

%>

<'asp:CheckBoxList ID="cblistAnswers" runat="server" 

<'Width="139px"style="text-align: left" AutoPostBack="False">

<'asp:ListItem Value="1">Me<'/asp:ListItem>

<'/asp:CheckBoxList>

<%

cblistAnswers.Items.Clear();

foreach (QuizzEngine.Common.Answer answer in qList[navigator].QuestionAllAnswers)

{
     ListItem i = new ListItem();

     i.Attributes.Add("runat", "server");

     i.Value = answer.AnswerId.ToString();

     i.Text = answer.AnswerText;

     cblistAnswers.Items.Add(i);

}

%> 
```

只有`ListItem`我在标记中添加：

```
<'asp:ListItem Value="1">Me<'/asp:ListItem> 
```

出现了，我动态添加的其他项目没有出现，我该怎么办？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-05T11:21:11.657

看看这个[MSDN 链接](http://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.checkboxlist.aspx)。它包含创建 CheckBoxList 所需的所有详细信息和示例。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-05T14:55:13.970

**我完成它** 就像反转**服务器端代码以生成**带有**CheckBoxList 标记**的项目，原因是在我的第一种情况下执行时将项目添加到渲染后的控件，这是错误的，首先将项目添加到控件然后编写它要渲染的标签。

**我正在将我的服务器端代码与 asp 标签混合以动态生成我的控件并显示它们，如果有人有另一种方式，请提供。**

**谢谢大家**

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-05T16:45:01.783

netseng，看看用户控件、占位符和用户控件的动态加载。我认为使用它们可以使您的页面更加动态，并且，如果您可以重用用户控件，您将获得利润！

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2009-01-05T11:00:34.430

我确定你不需要这个：

```
i.Attributes.Add("runat", "server"); 
```

# windows - Windows XP：用 WSH 脚本替换标准的“新建文件夹”操作

> ID：412693
> 
> 赞同：0
> 
> 时间：2009-01-05T09:58:52.010
> 
> 标签：windows, scripting, directory, wsh

**问题：**我有一个自定义 WSH 脚本，它以与 Windows 桌面中的标准“新建文件夹”操作类似的方式创建一个新目录。然而，这个脚本做了一些额外的事情；例如允许我创建一组预定义的子目录（可选）；如果目录与工作相关或针对特定客户，还允许我添加注释和提醒。

我希望能够做到这一点，以便每次我在 windows xp 中调用“新建文件夹”操作时都会运行此脚本。

**问题：**有哪些可用选项（如果有）允许我替换 WindowsXP 中新目录的标准创建，以便运行我的自定义 WSH 脚本？

**额外问题：**不管在 Windows XP 中做这样的事情是否以及多么麻烦，Windows Vista 是否让它变得更容易？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-06T08:48:48.203

Windows XP 中的标准文件夹创建是[CreateDirectory](http://msdn.microsoft.com/en-us/library/aa363855%28VS.85%29.aspx)。这是一个 Kernel32 函数。

由于您指的是“新文件夹”，并且希望有 UI，我认为您实际上指的是资源管理器，它是 XP 的默认外壳。“Ne Folder”是上下文菜单中的预定义条目，并且该列表是可扩展的。但是，您会注意到一条分隔线。“文件夹”和“快捷方式”是内置的；其他条目已配置。在分隔符下方添加“新文件夹结构”条目将是微不足道的（HKCR 中的 ShellNew 键）

# java - 用于 OLAP 的 Java 图表库

> ID：412695
> 
> 赞同：2
> 
> 时间：2009-01-05T09:59:41.963
> 
> 标签：java, charts, olap

是否有任何支持 OLAP 数据的 Java 图表库，例如 [ChartFX Olap](http://www.softwarefx.com/Extensions/filmsLarge.aspx?movieName=olapAxesLarge&movieWidth=749&movieHeight=565)或[Dundas Chart](http://www.dundas.com/Gallery/Chart/NET/index.aspx?Img=OLAP6)？

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-05T10:39:55.577

[JFreeChart](http://www.jfree.org/jfreechart/)或[JasperReports](http://jasperforge.org/plugins/project/project_home.php?group_id=102)将是我的建议。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-16T10:48:54.487

为了将任何数据显示为图表，需要将其简化为 2D 记录集 - 这是 OLAP 在您运行 MDX 查询时为您提供的。

如果你有二维数据，你可以将它传递给任何图表/图形代码。

我曾经使用 ASP 来运行 MDX，并写出 XML。这变成了带有客户端 JavaScript 的图表。我自己写了很多，这是一场噩梦！使用 Google 图表或 Flot。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2011-08-14T10:04:10.207

它目前仅适用于 icCube 服务器，但您可以查看[Javascript Visualization Library](http://www.iccube.com/support/documentation/viz/doc/vizTutorials.html)。

有一些与 Google Visualization、AmCharts 和 Protovis 集成的示例。实际上，您可以将其集成到任何 JS 库中。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-05T20:26:39.840

这是强制性的谷歌解决这个问题的答案：谷歌图表。

[http://code.google.com/apis/chart/](http://code.google.com/apis/chart/)

但是，这些不会托管在您的系统上。我也不确定它们是否支持发布请求类型，因此您可以发送的数据量仅限于获取请求 url 的大小。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-05T20:25:20.153

jCharts： http: [//jcharts.sourceforge.net/](http://jcharts.sourceforge.net/) 是我过去使用过的。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-05T20:36:24.390

为了回应其他人所说的，是的，[Google Chart API](http://code.google.com/apis/chart/)可能会提供一个轻量级的解决方案以及一个 Java 包装 API，如[charts4j](http://charts4j.googlecode.com)（免责声明：我编写了[charts4j](http://charts4j.googlecode.com)）。要查看所有 Google Chart 包装器 API 的完整列表，请参见[此处](http://groups.google.com/group/google-chart-api/web/useful-links-to-api-libraries)。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-08-15T21:44:46.470

你看过 olap4j 吗？[http://www.olap4j.org/](http://www.olap4j.org/)

虽然不是图表库，但您可以使用它来查询 OLAP 多维数据集。返回的对象可能更易于管理。

# java - 子视图标签的id属性

> ID：412697
> 
> 赞同：2
> 
> 时间：2009-01-05T10:00:28.997
> 
> 标签：java, jsp, jsf

我正在学习jsf。当我使用以下代码时，我在 java.lang.String 中得到类转换异常：

```
<f:facet name="header">
  <f:subview id="header">
    <tiles:insert attribute="header" flush="false"/>
  </f:subview>
</f:facet> 
```

如果我将子视图 ID 替换为标题以外的其他名称，则代码将成功运行。例如

```
<f:facet name="header">
  <f:subview id="header1">
    <tiles:insert attribute="header" flush="false"/>
  </f:subview>
</f:facet> 
```

我正在使用 David Geary 和 Cay Horstmann 编写的核心 Java 服务器面子书。书中给出的示例对于 facet name 和 subview id 具有相同的值。请解释为什么我们应该为 facet name 和 subview id 提供不同的值。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-07T14:57:00.240

组件树使用 id 来引用所有内容。使用 jsf，您应该始终使用唯一的 id 引用所有内容，或者您​​可以让 jsf 这样做，但如果您在多个标签中明确指定相同的名称，您将遇到问题。

# asp.net - WCF 和其他 Web 服务有什么区别？

> ID：412698
> 
> 赞同：5
> 
> 时间：2009-01-05T10:01:05.500
> 
> 标签：asp.net, wcf, asmx

**我对 WCF 和其他 Web 服务（例如 asp.net ASMX、.net Remoting）感到困惑，谁能告诉我 WCF 和其他的有什么区别，我应该什么时候使用它，谢谢！**

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-01-05T20:04:17.030

WCF 是一个通信堆栈，允许通过 HTTP（如 ASMX）和 TCP（如 Remoting）以及命名管道（实际上是机器内跨进程调用）、MSMQ 和 .NET 3.5 REST 公开服务。

它允许这样做，因为它将服务的通信部分与业务逻辑分离。您需要做的就是使用适当的合同属性（分别为 [SeriviceContract]、[OperationContract] 和 [DataContract]）装饰您的服务类、方法和 DTO。

这样做的好处是能够编写一次服务，并允许许多不同类型的客户端使用相同的服务（即 Java 客户端可以使用 HTTP，.NET 客户端可以使用 TCP，旧版客户端可以使用 MSMQ 等）。

WCF 仍将允许您使用每种传输的所有功能，包括安全性、事务、可靠消息传递等，但您需要谨慎使用。并非所有功能都适用于所有传输，您需要相应地进行设计。WCF 允许您在合同中指定需要哪些功能。这可以防止某人尝试以不支持所需功能集的方式公开您的服务（即，如果您的服务需要事务，WCF 运行时将不允许通过基本 HTTP 端点访问该服务）。

WCF 还可以通过自定义行为（影响 WCF 运行时的工作方式）和自定义通道（控制 WCF 服务与外界通信的方式）进行扩展。

与 ASMX 相比，WCF 有一点学习曲线，但好处绝对超过了这条学习曲线。

希望有帮助。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-01-05T10:33:13.283

WCF 是通信库，它是 .NET 远程处理和“旧”ASMX Web 服务的超集，也是这两个库的继承者。

WCF Web 服务对 WS-* 标准有更好的支持，并且互操作性问题更少。

基本上，您应该使用 WCF，因为 .net Remoting 和 ASMX 可能被认为是遗留问题（而且，如果我没记错的话，一些 .NET 远程处理错误仅在 WCF 中修复，而从未在 .NET 远程处理本身中修复）

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-05T10:05:11.110

我认为可以公平地说 WCF 取代了 ASMX 和远程处理。您可以使用 ASMX 和远程处理以及使用 WCF 实现更多功能，但您拥有更多功能，并且通常可以更好地控制正在发生的事情。

所以我相信，如果可以的话，你应该使用 WCF。

# maven-2 - 如何使用不同组的Maven Surefire插件进行测试和集成测试？

> ID：412717
> 
> 赞同：17
> 
> 时间：2009-01-05T10:11:31.377
> 
> 标签：maven-2, maven-plugin, testng, surefire

我想将**[testng](http://testng.org/)**与[Maven](http://en.wikipedia.org/wiki/Apache_Maven)的[Surefire 插件](http://maven.apache.org/plugins/maven-surefire-plugin/)一起使用。这个想法是用一个组标记一些测试并运行插件两次：用于不包括组的目标和仅包括组的目标。`integrationTest``test``integrationTest``integration-test``integrationTest`

我找到了一些用于为这两个目标运行插件的[材料](http://docs.codehaus.org/pages/viewpage.action?pageId=62120)并且有效，但第二次运行的组不起作用（不执行测试）。

这是 my 的 build 元素中的插件配置`pom.xml`：

```
 <plugin>
    <artifactId>maven-surefire-plugin</artifactId>
    <configuration>
      <excludedGroups>integrationTest</excludedGroups>
      <reportFormat>brief</reportFormat>
      <trimStackTrace>true</trimStackTrace>
      <useFile>false</useFile>
    </configuration>
    <executions>
      <execution>
        <id>integration-test</id>
        <phase>integration-test</phase>
        <goals>
          <goal>test</goal>
        </goals>
        <configuration>
          <groups>integrationTest</groups>
          <excludedGroups/>
          <reportsDirectory>${project.build.directory}/surefire-reports/integration</reportsDirectory>
        </configuration>
      </execution>
    </executions>
  </plugin> 
```

任何的想法？`mvn integration-test`按预期运行所有单元测试（不包括 group `integrationTest`），但第二次测试运行只写：

> 运行 TestSuite
> 测试运行：0，失败：0，错误：0，跳过：0，经过时间：0.562 秒

结果符合`mvn test`预期，测试运行并且组`integrationTest`被忽略。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-01-06T08:55:45.507

我明白了 - 恼人的配置实现！

`<excludedGroups/>`不覆盖`<excludedGroups>integrationTest</excludedGroups>`. 例如，您需要指定任何（未知）组`<excludedGroups>none</excludedGroups>`。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2011-03-12T09:45:12.460

[Failsafe 插件](http://maven.apache.org/plugins/maven-failsafe-plugin/index.html)是最好的方法（当您发布此问题时它可能不可用）。它将集成测试阶段添加到构建生命周期。它允许您在测试之前和之后运行设置和拆卸活动，例如，这对于管理嵌入式容器很有用。

# c# - C#2.0 IIS 5.1 中的流式传输：本地主机与计算机名称

> ID：412723
> 
> 赞同：1
> 
> 时间：2009-01-05T10:14:39.030
> 
> 标签：c#, http, iis-5

我正在尝试创建一个返回流数据的网络服务。为此，我创建了一个演示 Web 服务，设置 HttpContext.Current.Response.BufferOutput = false 并且我正在写入相同的响应，一些 jpeg 文件在其间刷新。

在客户端我正在做 loHttp = (HttpWebRequest)WebRequest.Create(Url); loWebResponse = (HttpWebResponse)loHttp.GetResponse();

现在，如果 url 是[http://localhost](http://localhost)我会得到我想要的信息流。但是，如果 url 是[http://[mycomputername]](http://[mycomputername])那么我得到缓冲的信息，只有当**所有**的 jpeg 都被写入时，我才会得到响应。唯一的区别是我如何访问计算机。

我应该配置什么以便在访问远程计算机时也能获得流媒体体验？谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-01-05T11:51:22.533

好的，找到了罪魁祸首。

我在后台运行提琴手，它拦截并缓冲了响应。

# c# - Read MSDTC configuration

> ID：412725
> 
> 赞同：0
> 
> 时间：2009-01-05T10:15:19.527
> 
> 标签：c#, configuration, msdtc

Does anyone have any ideas on how to read the MSDTC configuration on the current machine? I am specifically trying to check that the user has performed the following steps:

1.  Open Component Management (Start > All Programs > Administrative Tools > Component Services)

2.  Double-click on Component Services, then expand Computers. Right-click on My Computer and select Properties

3.  On the MSDTC tab, click the Security Configuration button, and configure the properties as follows:

4.  Network DTC Access: Checked

5.  Allow Remote Clients: Checked

6.  Allow Inbound: Checked

7.  Allow Outbound: Checked

8.  Incoming Caller Authentication Required: Selected

It's part of a small component I need to write to validate end-user configuration. I don't think I would attempt to fix it if it were wrong: just point the user at the help file - so only read only is needed.

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-01-05T18:57:58.287

You can use the COM+ Administration classes/interfaces to do this. It will require COM interop though on your part.

The reference is located at:

[http://msdn.microsoft.com/en-us/library/ms681189(VS.85).aspx](http://msdn.microsoft.com/en-us/library/ms681189(VS.85).aspx)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-05T12:31:34.760

I'm not sure if you can do this programmatically from any API, or WMI. At least you can check the registry information at:

```
HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\MSDTC\Security 
```

# .net - NHibernate.Search 与 Lucene.NET 不使用数据库？

> ID：412730
> 
> 赞同：0
> 
> 时间：2009-01-05T10:17:15.593
> 
> 标签：.net, nhibernate, lucene.net

我可以使用 NHibernate.Search 仅与没有数据库的 lucene 索引一起使用吗？因为我只想将所有数据存储在我的 lucene 索引中，但我真的很喜欢 NHibernate.Search 中的功能。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2010-04-13T14:21:59.490

不是真的，因为它们是紧密耦合的。NHSearch/Lucene.NET/NHibernate 集成的要点是您可以进行全文搜索，但返回的结果是域实体，即来自数据库。

因此，如果不将它们存储在数据库中，NHSearch 就无法膨胀它在 Lucence 索引中找到的域对象。

另一种方法是查看其中一个文档数据库，例如 Raven。

# jquery - jQuery html 属性在 IE 中不起作用

> ID：412734
> 
> 赞同：20
> 
> 时间：2009-01-05T10:18:54.777
> 
> 标签：jquery, html, forms

我在表单中使用国家和州下拉菜单。每当用户在下拉列表中选择国家时，该国家的各个州将填充在州下拉列表中。我正在使用 AJAX 调用填充下拉列表中的状态。问题是在 Mozilla 中填充了这些状态，但在 IE 中不起作用。我猜想在状态下拉列表中加载状态时 jQuery 存在一些问题。我正在使用的 jQuery 代码是

```
$('select#edit-country').change(function(e) {

    $.getJSON("loadContactUsStates",{id: $(this).val(), ajax: 'true'}, function(j){
        var options = '';

        for (var i = 0; i < j.length; i++) { 
            options += '<option value="' + j[i].optionValue + '">' + j[i].optionDisplay + '</option>';

        }

    <!-----I guess the problem is with the below line------------------>
       $("select#edit-state").html(options);

    })//end json

}); 
```

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-01-05T10:32:12.957

尝试使用**append**而不是**html**方法，如本文所述[。](https://stackoverflow.com/questions/317095/how-do-i-add-options-to-a-dropdownlist-using-jquery)

**编辑**

实际上，我自己也遇到过这个问题。对我来说，答案是先调用[empty](http://docs.jquery.com/Manipulation/empty)，然后[append](http://docs.jquery.com/Manipulation/append)与使用 html 方法具有相同的效果（我认为？）。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2010-03-28T22:24:26.527

另外（在我的情况下）检查你是否有有效的 html，我有不匹配的标签，它在 Firefox 中工作并且在 IE 中没有（6-8）

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2012-04-11T17:09:14.500

添加到 .ajax 选项

缓存：假，

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2011-09-20T02:08:34.173

**这对我有用：（我在 IE7 - IE9 和 Chrome 上测试过）**

**看起来 IE 的诀窍是使用 DIV 包装器**

**原始html：**

```
<div  id="dynamicMenu"></div> 
```

**jQuery脚本：**

```
$.ajax({

            url: "/myapp/myajaxUrl.jsp",
            type: "GET",
            dataType: "html",
            async: false,
            success: function(msg) {
                $("#dynamicMenu").html(msg);
            }); 
```

**味精是这样的：**

```
<TABLE>
<TBODY>
 <TR>
  <TD><LABEL for="dropdown1">OS type:</LABEL></TD>
  <TD>
   <SELECT id="dropdown1">
    <OPTION selected value="">Select OS</OPTION>
    <OPTION value="WIN">Windoze</OPTION>
    <OPTION value="UX">Unix</OPTION>
    <OPTION value="LX">Linux</OPTION>
   </SELECT>
  </TD>
 </TR>
</TBODY>
</TABLE> 
```

**我试过 .empty() .html() 无济于事，但上面的效果很好！**

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2012-05-29T10:00:50.833

以下方法为我解决了这个问题：

```
$('Element ID OR Class').empty().html(string); 
```

首先使用`empty()`& 然后设置 html 使用`html()`

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2011-07-24T11:08:06.673

经过数小时的挫折后，我意识到 IE 不支持除 div 之外的 html5 元素的 jquery 属性函数。我试图这样做：

```
success: function (response, textStatus, XMLHttpRequest) {
    $response = $(response.replace(/\t/g, " "));
    $responseHTML = $response.find("#pageContainer").html();
    $container.html($responseHTML); 
```

对于这个元素：

```
<nav id="pageContainer" class="content">
</nav> 
```

通过将其更改为此它解决了问题：

```
<nav>
    <div id="pageContainer" class="content">
    </div>
</nav> 
```

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2010-09-15T14:02:35.710

如果您使用 jquery 解析 xml，并且在 IE 中需要 html()，请尝试以下操作：

var 内容 = ($.browser.msie) ？$(this).context.xml : $(this).html();

这解决了我的问题。我希望它也会对某人有所帮助。

问候。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2012-08-28T21:00:37.887

我在 IE 上遇到了一个问题：

```
$('#valor_total').html(valor_total); 
```

where`id`与作为参数传递的变量同名。更改 id 效果很好：

```
$('#div_valor_total').html(valor_total); 
```

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2012-01-11T13:39:12.190

在我的情况下，就像更改 jquery 版本一样简单。我正在使用 jquery-1.3.2 并添加了这一行

```
<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.7.1/jquery.min.js"> </script> 
```

而是 jquery-1.3.2 导入。在不更改我的源代码中的任何内容的情况下，.prepend 函数在 IE、FF 和 Chrome 中完美运行。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2012-01-05T22:14:58.520

Jukums 的评论让我尝试关闭 ColdFusion 调试输出，然后 .html() 在 IE8 中为我工作。强制调试输出关闭：

```
<cfsetting showdebugoutput="No"> 
```

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2009-10-13T21:50:29.130

我刚刚遇到了同样的问题，建议的修复都没有帮助。原来传递字符串中的制表符是原因。一旦我删除了所有这些， html() 和 append() 都可以正常工作。猜猜 IE 没有格式化字符串.. hmpf。

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2013-02-14T22:16:11.510

对我来说，我只能通过将我的选择放在一个占位符 div 中，然后通过 .html(); 该 div 的整个声明。完全有效。

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2010-09-29T15:09:38.750

在收到带有函数**jQuery.ajax()**的 AJAX HTML 请求，然后尝试使用**jQuery( html_result_data )**解析结果后，我遇到了同样的问题。解决方案是在 html_result_data 中剥离标题和所有选项卡和“返回”，如下所示：

```
success: function( data ) {
   // God this is ugly
   data = data.split("<body>")[1].split("</body>")[0];
   data = data.split("\t").join("").split("\r").join("").split("\n").join("");                      
   data = jQuery( data );
   ...
} 
```

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2012-05-10T10:51:34.747

我有同样的问题，发现最简单的解决方案是使用该`replaceWith()`函数。

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2013-09-27T10:50:12.773

In my case, I've had to change the selector that was a `<figure>` tag. This is what I had:

HTML:

```
<figure id="imagen">...</figure> 
```

JS (**does not work**):

```
$("#imagen").html(res); 
```

And I had to replace with:

HTML:

```
<div id="imagen">...</div> 
```

JS (**it works!**):

```
$("#imagen").html(res); 
```

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2010-04-19T21:12:27.237

您使用的是 1.4.2 吗？`cleanData`在 IE 中使用无效缓存条目的方法存在问题。可以在[此处](http://dev.jquery.com/ticket/6444)找到错误和相应的修复。这会影响调用`.html()`

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2009-01-05T10:59:57.050

另请注意，如果您在选择器中使用 tagName 前缀，则它比仅使用 id 慢。

在你的情况下，只需使用`$("#edit-state").append(options)`

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2010-01-29T04:21:06.983

检查返回数据中的任何 JavaScript 是否在语法上正确。

我有一个带有逗号结尾的 JSON 选项对象，这足以让 IE 拒绝运行它。

* * *

## 回答 #19

> 赞同：0
> 
> 时间：2010-04-13T15:02:44.313

在 IE8 中转到**工具**->**互联网选项**-> 然后选择**高级**选项卡。然后单击**重置**以重置所有 Internet Explorer 设置。

我以为我的代码有问题，但问题是 IE8。这是一种享受。

祝你好运，希望这能帮到你。

* * *

## 回答 #20

> 赞同：0
> 
> 时间：2012-03-06T12:47:17.670

由于这里没有提到解决方案：我在激活兼容模式时在 IE8 中遇到了同样的问题。解决方案是将 jQuery 对象传递给 .html() 函数，如下所示：

```
$("select#edit-state").html($(options)); 
```

如果选项是一个 jQuery 对象并且也是作为一个对象构建的，那么这不是问题。但在上面的例子中，这应该可以解决问题——至少对我来说是这样。

* * *

## 回答 #21

> 赞同：0
> 
> 时间：2010-04-13T11:32:21.567

在我的情况下，返回的数据也应该在语法上是正确的。我有一些不匹配的标签，比如未闭合的标签

或..等

检查所有数据是否正确

如果这是一个 ajax 请求，那么快速的调试方法是在您填充的区域之外添加一个文本区域，并使用返回的数据填充文本区域。然后检查该数据是否存在不一致。Jquery.html 在 IE 上运行良好

* * *

## 回答 #22

> 赞同：0
> 
> 时间：2011-12-14T07:34:19.367

当 html 在 IE 中不起作用时，我遇到了同样的问题。

我相信如果您的 html 无效，它就不起作用

例子：

对于我的情况，我使用的是没有关闭标签的 div。所以无效的html可能是IE的罪魁祸首

* * *

## 回答 #23

> 赞同：0
> 
> 时间：2015-06-02T10:04:13.600

就我而言，问题在于我在加载的数据中注释掉我的 javascript 的方式。

```
// Works fine

/* Works fine */

<!-- This causes a syntax error in IE --> 
```

我以前在 IE 中注释掉这样的问题从来没有遇到过任何问题，只有在使用 ajax 将其加载到现有页面时。其他浏览器也没有问题。

* * *

## 回答 #24

> 赞同：0
> 
> 时间：2016-12-07T20:27:31.260

将 no cache 属性添加到控制器为我解决了这个问题。

从这个答案复制： [https ://stackoverflow.com/a/12948321/1389589](https://stackoverflow.com/a/12948321/1389589)

# nhibernate - 您如何使用 fluent-NHibernate 过滤一对多关系？

> ID：412738
> 
> 赞同：1
> 
> 时间：2009-01-05T10:21:01.060
> 
> 标签：nhibernate, fluent-nhibernate, nhibernate-mapping

我有一组实体，可以使用数据库中的“IsDeleted”标志将它们设置为已删除。

这对于正常的实体集来说很好，但是当我的父级有许多可能具有此标志的子实体时，我希望 NHibernate 能够自动处理选择“IsDeleted”设置为 false 的子实体。

无论如何用fluent-NHibernate来做到这一点？或者我可以添加视图流畅的 XML 映射。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-05T11:21:46.447

这不是在映射、Fluent NHibernate 或标准 XML 中可以完成的事情。您需要做的是注册一个 DeleteEvent 侦听器。[NHibernate FAQ](https://web.archive.org/web/20110227204838/http://blogs.hibernatingrhinos.com/nhibernate/Default.aspx)上有一篇关于[Soft Deletes](https://web.archive.org/web/20090209010820/http://blogs.hibernatingrhinos.com/nhibernate/archive/2008/04/08/soft-deletes.aspx)的帖子非常好。

# iphone - 在 Objective-C 中使用指针数组的最佳方法是什么？

> ID：412740
> 
> 赞同：1
> 
> 时间：2009-01-05T10:22:09.343
> 
> 标签：iphone, objective-c, syntax

我正在尝试模仿以下 Java 代码：

```
int[][] multi; // DIMENSIONS ARE UNKNOWN AT CREATION TIME
// LATER ON...
multi = new int[10][];
multi[5] = new int[20];
multi[5][11] = 66;
// LATER ON...
multi = null; // PROPER WAY OF FREEING EVERYTHING 
```

我推出了以下 Objective-C 版本：

```
int* *multi;
//
multi = malloc(10 * sizeof(int*));
multi[5] = (int *) malloc(20 * sizeof(int));
multi[5][11] = 66;
//
free(multi[5]);
free(multi); 
```

所以首先，我想知道这是否是最好的方法。而且主要是：我找不到以某种“自动”方式释放内存的方法，即以下代码导致 iPhone 上的运行时异常：

```
for (int i = 0; i < 10; i++)
{
    if (multi[i] != NULL) free(multi[i]);
} 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-01-05T10:51:50.063

Free 不会将指针中的内存地址归零，它只是使其无效。所以，如果你多次运行这个循环，当你试图释放已经失效的内存时，你会得到异常。您可以使用 NSPointerArray 或将整数包装在对象中并使用 NSMutableArray 来满足您的目的，但如果您只想使用现有的，并且不止一次运行循环，则必须执行以下操作：

```
int **multi;
multi = calloc(10, sizeof(int*));
multi[5] = calloc(20, sizeof(int));
//
multi[5][11] = 66;
//
for( int i = 0; i < 10; i++ ) {
  if( multi[i] ) {
    free(multi[i]);
    multi[i] = NULL;
  }
}
//
free(multi); 
```

这样，如果循环多次运行，您将不会失败。另外，我使用 calloc 而不是 malloc 因为它会将所有指针设置为 NULL 并将整数设置为 0。第一个参数是您想要的数组的大小（在您的情况下），第二个参数是类型的大小（所以不需要乘法）。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-05T10:39:33.240

首先，问题中建议的解决方案不是特定于Objective-C，这是标准C。Java代码的C翻译看起来是正确的。

其次，建议的“自动” free 不起作用： malloc() 不会初始化分配的内存。我会改用 calloc()，或者在 malloc() 之后添加一个 memset()。

第三，对于 Objective-C 版本，我会考虑使用 NSMutableArray 对象填充的 NSMutableArray 对象，这些对象本身填充有 NSNumber 对象。对于你的目标，我认为 C 版本是可以的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-05T10:26:19.957

您可以创建一个一维数组，然后使用基于您的两个值的索引。这种方式将有更少的初始化代码来处理。

此外，如果您推迟初始化`multi`直到知道尺寸，您可以将其初始化为静态数组，而不是可变大小的数组。

# .net - ORM实体Xml序列化

> ID：412748
> 
> 赞同：2
> 
> 时间：2009-01-05T10:26:11.627
> 
> 标签：.net, xml, serialization, orm

我正在寻找一个与 .net 一起使用的 ORM，我需要能够对 ORM 生成的实体进行完整的图形序列化到 Xml。我自己的研究引导我使用 WCF 和实体框架来实现这一点，这是最好的选择还是有更简单的方法？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-05T11:43:37.353

大多数 O/R 映射器在用于获取实体的上下文/会话对象中都有更改跟踪。当您通过线路将实体对象作为 xml 传递给客户端时，这会产生问题，在那里对其进行更改并将其发送回：获取该对象的会话/上下文早已不复存在。

[LLBLGen Pro](http://www.llblgen.com)在实体中具有更改跟踪功能，因此通过网络使用实体变得轻而易举。它带有用于 WCF 的图形的 XML 序列化/反序列化以及它自己的用于远程处理的二进制序列化（比默认的二进制格式化程序快得多，而且更紧凑）。

免责声明：我是 LLBLGen Pro 的首席开发人员。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-05T10:55:50.820

好吧，大多数 ORM 工具都可以生成标准 POCO .NET 类，并且大多数标准 POCO 类都非常适合序列化。例如，LINQ-to-SQL通过设置为支持`DataContractSerializer`(not ) 。Entity Framework 也是如此（不过，我认为您不需要更改 EF 的任何设置）。`XmlSerializer``Serialization Mode``Unidirectional`

对于“更简单” - 那么，复杂性是什么？设置实体框架（或 LINQ-to-SQL）模型通常不是很棘手。有什么具体的问题吗？

请注意，xml 序列化程序默认是*树*序列化程序，而不是*图形*序列化程序。`DataContractSerializer`可以支持正确的图形，但您需要启用它（在 xml 模式下默认情况下不启用它，因为它会生成看起来很奇怪的 xml）。

你提到了WCF；那是一种通讯技术；你没有在问题中提到通讯，所以不清楚你在这里的意思。请注意，“ADO.NET 数据服务”是此处的另一个选项，如果您想要基于 REST 的数据访问，但大多数 ORM 应该可以与 WCF 一起使用。当然，还有其他选择。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-05T11:02:25.610

[DataSet](http://msdn.microsoft.com/en-us/library/ss7fbaez.aspx)必须是在客户端将数据序列化为 XML 的最简单方法（请参阅[在 DataSet 中使用 XML](http://msdn.microsoft.com/en-us/library/ss7fbaez.aspx)）。但显然它不是一个 ORM 库......

据我所知，ORM 库（如[NHibernate](http://www.hibernate.org/)）通常依赖于自定义[XmlSerializer](http://msdn.microsoft.com/en-us/library/system.xml.serialization.xmlserializer.aspx)（或[自定义 WCF 序列化](http://timvasil.com/blog14/post/2008/02/WCF-serialization-with-NHibernate.aspx))）的使用，这对您来说可能工作量太大（或者不是......）。

然后，将全图序列化为 XML 被设定为[Salamanca](http://salamanca.codeplex.com/)的未来目标，这是一个包含 ORM 库的开源软件工厂。我们仍处于早期开发阶段，但欢迎任何人参与...

# excel - 如何在图表轴上设置标签对齐？

> ID：412750
> 
> 赞同：4
> 
> 时间：2009-01-05T10:26:27.337
> 
> 标签：excel, vba, charts, axis

我必须仅使用 VBA 在 Excel 中制作柱形图（无需用户输入）。

我想格式化 x 轴的标签，以便每个标签的对齐方式变为 -270 度。这可以通过更改“格式轴”对话框的“对齐”选项卡中的“自定义角度”属性来手动完成。

我记录了一个宏，但 Excel 似乎没有记录对齐步骤。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-05T10:35:31.080

如果您使用的是 Excel 2007，请尝试使用早期版本，因为 2007 的宏记录器有点残缺。

这就是我得到的：

```
ActiveSheet.ChartObjects("Chart 1").Activate
ActiveChart.Axes(xlCategory).Select
Selection.TickLabels.Orientation = xlUpward 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2010-08-17T19:23:27.923

```
ActiveChart.Axes(xlCategory).TickLabels.Orientation = 67 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2019-07-18T10:27:01.963

**关于 .Activate**

老派的 VBA 宏通常会让人们认为您必须“激活”并反对使其成为“当前”。就像您单击图形表示一样，您使用鼠标和键盘所做的一切都会被激活的对象接收。*Microsoft Office*产品的“宏生成器”是这种编码风格的罪魁祸首。

但是，在 VBA 编程或使用来自 C# 或其他流行语言的 Office API 的世界中，这不是应该的方式。

要修改图表对象、线条等，您可以通过***对象引用***对对象本身进行操作。一旦获得它，您就可以访问所有方法和属性，并且“激活”不是概念的一部分。如果您出于某种原因实际上希望让对象获得一些焦点以供用户查看 - 视觉对象通常具有要调用的“Activate()”函数。

在此示例中，图表中多个系列的线宽设置为 1：

```
Sub Change_all_charts()
    Dim ch As chart
    Dim ws As Worksheet
    Dim ChtObj As ChartObject
    Dim srs As Series

    'Get a reference to the active worksheet
    Set ws = ActiveSheet

    'Loop each chart object in worksheet ws
    For Each ChtObj In ws.ChartObjects

        'Operate on 'ChtObj.chart' object using . notation
        With ChtObj.chart
            Debug.Print "Chart being modified: '" & .Name & "'"
            'Loop through all series in the chart .Series collection
            For Each srs In .SeriesCollection
                Debug.Print "  Series being modified: '" & srs.Name & "'"
                'Set the series line width
                srs.Format.Line.Weight = 1
            Next
        End With
    Next
End Sub 
```

在过去（甚至现在），财务人员进行 Excel 编程并使他们的工作表像疯了一样闪烁和动画，因为他们认为对象需要接收“焦点”才能进行修改。

好吧，现在有人说它在过去的 40 年里一直在“困扰”我。

# security - SharePoint Web 部件按 AD/SharePoint 组显示用户

> ID：412753
> 
> 赞同：3
> 
> 时间：2009-01-05T10:27:04.713
> 
> 标签：security, sharepoint, web-parts

我正在尝试创建一个 SharePoint Web 部件，它将显示某个活动目录或 SharePoint 安全组中的所有用户。

例如，在名为人力资源的部门的主页上，Web 部件将列出属于名为 HR 的 AD 或 SharePoint 组的所有人员。

有人向我建议，SharePoint 中的用户表与安全组之间没有关系，我很难理解？如果用户属于某个组，您会怀疑存在关系。

非常感谢您的任何建议

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-01-06T18:49:06.213

站点用户 web 部件不会扩展 AD 安全组。对于 AD 安全组枚举，您可能需要查看 Bamboo 的 Web 部件（用户目录 Web 部件）或开发您自己的自定义 Web 部件，如下所述：http: [//sharepointrookie.wordpress.com/2008/07/13/display-来自广告组的网站成员/](http://sharepointrookie.wordpress.com/2008/07/13/display-site-members-from-ad-groups/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-15T09:59:33.680

是的，有一个名为“站点用户”Web 部件的工具，我认为它可以满足您的部分需求。但我不确定它是否在 Web 部件库中的杂项组下。当我在 Web 部件库中闲逛时，我偶然发现了该工具。[同样，这里的 IFY 是另一个工具，不过，它是同步 AD](http://www.boostsolutions.com/active-directory-sync.html)的第三方工具

希望这可以帮助

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-06T00:13:59.477

SharePoint 有一个“站点用户”Web 部件（在 Web 部件库中的杂项组下）-此部件是可配置的，并且可以显示站点中任何 SharePoint 安全组的成员。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-08T22:14:59.497

SharePoint 不会跟踪谁在哪个 AD 组中，您必须向 AD 询问。

这并不是一个可以很好回答的问题，广告旨在回答诸如“凯文是酷孩子组的成员”之类的问题

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-17T22:22:07.950

惊人的

但它有一个奇怪的行为。

“审批者”可以看到所有“贡献者”，也可以看到他们自己的“审批者”组，但“参与者”只能看到其他“贡献者”而不是“审批者”

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2010-05-10T11:02:48.957

为了满足您的需要，您需要`webpart`在 Visual Studio 中创建一个自定义来访问 ldap 服务器，以获取活动目录组下的成员列表。

此外，您可以将此网络艺术部署到您的共享点站点。

# .net - 使用 .NET 远程处理注册对象 _instances_ 而不是 _types_？

> ID：412760
> 
> 赞同：0
> 
> 时间：2009-01-05T10:34:02.983
> 
> 标签：.net, com, remoting

关于 .NET 远程处理，有些事情我只是不明白。好吧，实际上有两件事：

1.  为什么强调从 MarshalByRef 继承的类而不是原始 COM 样式（我喜欢的）的接口？

2.  为什么 .NET 远程处理总是迫使您有效地创建某种对象池，而不是允许您将特定*实例*与 URL 关联？

服务器代码：

```
RemotingConfiguration.RegisterWellKnownServiceType(typeof(RemotingTypes.Server), "MyURL", WellKnownObjectMode.Singleton); 
```

客户端代码：

```
RemotingConfiguration.RegisterWellKnownServiceType(typeof(RemotingTypes.Server), "MyURL", WellKnownObjectMode.Singleton); 
```

但是假设我想自己创建“服务器”实例，然后将其绑定到端点？

```
RemotingTypes.Server myInstance = new RemotingTypes.Server(); 
```

现在怎么办？如何将 "myInstance" 与 URL "MyURL" 关联？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-08T13:41:57.720

Nickd 回答的问题：我想知道如何将已创建的实例与 URL 关联，而不是如何让 .NET 远程处理为我执行此操作（我创建的一些实例没有默认构造函数，例如例子）。

我希望会有一些史诗般的回应来解释 .NET 远程处理背后的“哲学”，以及为什么它与类型系统密不可分......

相反，我得出的结论很简单：a) 这是因为 .NET 远程处理很糟糕。不要使用它 b)改用[WCF](http://social.msdn.microsoft.com/content/en-us/msft/netframework/wcf/GettingStarted)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-05T10:58:15.277

我无法真正解决第 1 点和第 2 点，因为我没有 COM 经验，也不懂第 2 点，但要回答您的最后一个具体问题，如果您使用 system.Activator 类，您可以这样做：

```
RemotingTypes.Server  myInstance = (RemotingTypes.Server) Activator.GetObject(typeof(RemotingTypes.Server), MyUrl); 
```

这意味着您必须在构建时绑定它，但这都是客户端。

请参阅我的[类似问题](https://stackoverflow.com/questions/25982/whats-the-simplest-way-to-connect-to-a-net-remote-server-object)。

# c# - 将 Windows 窗体应用程序转换为 Asp.net

> ID：412763
> 
> 赞同：4
> 
> 时间：2009-01-05T10:36:48.033
> 
> 标签：c#, asp.net, winforms

我问的是您之前使用的将 ac# windows 窗体应用程序转换为 asp.net 的最佳工具？我已经在[谷歌](http://www.google.com/search?q=convert+windows+forms+into+asp.net&rls=com.microsoft:en-us&ie=UTF-8&oe=UTF-8&startIndex=&startPage=1)上搜索了这个主题并找到了很多工具，但我希望有人根据他的使用情况推荐最好的工具。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-01-05T10:46:07.563

我真的不建议使用工具进行转换。Web 应用程序和 WinForms 是根本不同的，应该有不同的*设计*。即使现在有大量的 Ajax 出现，您仍然需要牢记整个无状态 HTTP 模型。

如果您不想重新考虑该应用程序，您可能需要考虑将其转换为 Silverlight 2.0...

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-01-05T11:41:41.773

[@Jon Skeet](https://stackoverflow.com/questions/412763/convert-windows-forms-application-into-asp-net#412774)有最好的建议。也就是说，让我们检查您提供的 Google 链接的结果。会发生什么？

大多数主题（用于查询）结果是其他程序员问基本相同的问题 - 并得到基本相同的答案。事实上，我只看到了一个工具：来自[CodeProject](http://www.codeproject.com/KB/cs/winforms2webforms.aspx)的示例。在这个工具中，不仅生成的 UI 贫瘠丑陋，而且还有以下大的免责声明：

> 请注意，本文或随附的代码示例并非旨在实现 Windows 窗体和 Web 窗体之间的完整转换，包括所有事件和业务逻辑。由于两种编程模型的本质不同，这将是徒劳的尝试。相反，我们的目标是用户界面组件本身，将 Windows 窗体控件映射到相应的 Web 窗体对应项。

这就是真正的问题：它所做的只是根据您现有的 UI 生成一个（非常基本的）UI。所有代码、逻辑、流程甚至导航都取决于您。

底线：没有一个工具出现在前面和中心的原因是因为这样的工具几乎不可能编写，并且会产生（很可能）无法导航、无功能的站点。虽然 WinForms 和 WebForms 在编程上看起来很相似，但实际上它们在底层是完全不同的。除了 WinForms 应用程序之外，没有任何工具能够为您生成整个网站——这些模型比它们看起来更不同。

归根结底，获取 WinForms 应用程序并启用 Web 的最佳方法是编写所述应用程序，以便将所有业务逻辑封装在其自己的 DLL（或其集合）中，并使用这些 DLL 来驱动从头开始的新站点的后端。这样，您所开发的只是前端和显示支持。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2011-03-16T19:25:25.230

[VisualJS.NET](http://visualjs.net)是您正在寻找的解决方案。观看视频

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-06T13:30:10.257

也许你想试试 VisualWebGui？通过一些调整，您可能可以在浏览器窗口中运行 Windows 窗体应用程序。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-05T11:13:16.527

您可以考虑通过远程桌面或 Citrix 托管您的 Windows 窗体应用程序

# algorithm - 如何将 BCD 数字乘以（除以）10^x

> ID：412769
> 
> 赞同：0
> 
> 时间：2009-01-05T10:42:19.457
> 
> 标签：algorithm, math, largenumber, javacard

我有一个大的（12 位）BCD 数字，编码为 6 个字节的数组 - 每个半字节都是一个 BCD 数字。我需要将它乘以 10^x，其中 x 可以是正数或负数。

我知道这可以通过半字节而不是位向左或向右移动来完成，但这是一个可怕的实现——尤其是在我正在使用的 Javacard 中。有没有更好的办法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-05T10:56:14.577

您不必使用位移位（尽管这可能是最有效的方法）。

对于您的 12 位 BCD 数字，假设不会有任何溢出，假设 b[5] 到 b[0] 将您的字节从最高有效到最低有效，并且该 mod 是模数（余数）操作和 div是整数除法，以下伪代码将乘以 10：

```
for i = 5 to 1
    b[i] = (b[i] mod 16) * 16 + b[i-1] div 16
b[0] = (b[0] mod 16) * 16 
```

老实说，这可能比您的位移解决方案更丑陋，但是，只要您将它们中的任何一个封装在一个函数中，这并不重要。

我建议具有以下功能：

```
BcdArray mult10 (BcdArray ba, int shiftAmt); 
```

这将通过应用 10 的幂返回一个修改后的数组。

任何 10 的偶数次方都是字节的简单副本（因为两个 nybbles 是一个字节），而只有 10 的奇数次方需要复杂的位移或余数/除法代码。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-05T10:57:02.080

半点移动是最有效的方法。

如果性能不是您的问题，并且您希望获得最易读的版本，您可能需要将 BCD 数字转换为字符串并移动小数点。

如果您没有小数点（例如您的数字是整数），您可以在 x > 0 时连接零，或者在 x < 0 时删除最后的 -x 字符。

然后将字符串转换回 BCD。注意溢出以及删除所有字符并以空字符串结尾的情况。

# ruby-on-rails - 从数组创建哈希的最简洁方法

> ID：412771
> 
> 赞同：31
> 
> 时间：2009-01-05T10:44:27.550
> 
> 标签：ruby-on-rails, ruby, arrays, hash

我似乎经常遇到这种情况。我需要使用数组中每个对象的属性作为键从数组构建哈希。

假设我需要一个示例的散列，使用由其 id 键入的 ActiveRecord 对象的常用方式：

```
ary = [collection of ActiveRecord objects]
hash = ary.inject({}) {|hash, obj| hash[obj.id] = obj } 
```

其他方式：

```
ary = [collection of ActiveRecord objects]
hash = Hash[*(ary.map {|obj| [obj.id, obj]}).flatten] 
```

Dream Way：我可以并且可能自己创建这个，但是 Ruby 或 Rails 中是否有任何东西可以做到这一点？

```
ary = [collection of ActiveRecord objects]
hash = ary.to_hash &:id
#or at least
hash = ary.to_hash {|obj| obj.id} 
```

* * *

## 回答 #1

> 赞同：64
> 
> 时间：2009-01-05T12:17:03.400

ActiveSupport 中已经有一个方法可以做到这一点。

```
['an array', 'of active record', 'objects'].index_by(&:id) 
```

只是为了记录，这里是实现：

```
def index_by
  inject({}) do |accum, elem|
    accum[yield(elem)] = elem
    accum
  end
end 
```

可以将其重构为（如果您迫切需要单线）：

```
def index_by
  inject({}) {|hash, elem| hash.merge!(yield(elem) => elem) }
end 
```

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2013-04-14T22:44:14.353

最短的？

```
# 'Region' is a sample class here
# you can put 'self.to_hash' method into any class you like 

class Region < ActiveRecord::Base
  def self.to_hash
    Hash[*all.map{ |x| [x.id, x] }.flatten]
  end
end 
```

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2017-03-10T14:15:25.363

万一有人得到普通数组

```
arr = ["banana", "apple"]
Hash[arr.map.with_index.to_a]
 => {"banana"=>0, "apple"=>1} 
```

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2009-01-05T11:52:06.383

您可以自己将 to_hash 添加到 Array 中。

```
class Array
  def to_hash(&block)
    Hash[*self.map {|e| [block.call(e), e] }.flatten]
  end
end

ary = [collection of ActiveRecord objects]
ary.to_hash do |element|
  element.id
end 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-05T17:14:23.270

安装[Ruby Facets Gem](http://facets.rubyforge.org)并使用它们的[Array.to_h](http://facets.rubyforge.org/doc/api/core/classes/Array.html#M000131)。

# java - java：JAXWS 2.0 不支持 Rpc/编码的 wsdls

> ID：412772
> 
> 赞同：62
> 
> 时间：2009-01-05T10:45:16.970
> 
> 标签：java, jax-ws

我正在使用 CXF 2.1 从 wsdl 生成 java 代码，但出现以下错误：

```
WSDLToJava Error: Rpc/encoded wsdls are not supported in JAXWS 2.0

org.apache.cxf.tools.common.ToolException: Rpc/encoded wsdls are not supported in JAXWS 2.0
    at org.apache.cxf.tools.wsdlto.frontend.jaxws.wsdl11.JAXWSDefinitionBuilder.checkSupported(JAXWSDefinitionBuilder.java:141)
    at org.apache.cxf.tools.wsdlto.frontend.jaxws.wsdl11.JAXWSDefinitionBuilder.build(JAXWSDefinitionBuilder.java:87)
    at org.apache.cxf.tools.wsdlto.frontend.jaxws.wsdl11.JAXWSDefinitionBuilder.build(JAXWSDefinitionBuilder.java:61)
    at org.apache.cxf.tools.wsdlto.WSDLToJavaContainer.execute(WSDLToJavaContainer.java:127)
    at org.apache.cxf.tools.wsdlto.WSDLToJavaContainer.execute(WSDLToJavaContainer.java:232)
    at org.apache.cxf.tools.common.toolspec.ToolRunner.runTool(ToolRunner.java:83)
    at org.apache.cxf.tools.wsdlto.WSDLToJava.run(WSDLToJava.java:103)
    at org.apache.cxf.tools.wsdlto.WSDLToJava.main(WSDLToJava.java:173) 
```

我该如何修复这个错误，我可以使用以前版本的 CXF 或其他任何东西来修复它吗？

* * *

## 回答 #1

> 赞同：81
> 
> 时间：2009-01-06T03:14:21.670

RPC/encoded 是使用 XML Schema 定义 SOAP 对象之前的遗迹。它[不再被广泛支持](http://bitkickers.blogspot.com/2008/12/rpcencoded-web-services-on-java-16.html)。您将需要使用来自同一时代的[Apache Axis 1.0生成存根。](http://www.apache.org/dyn/closer.cgi/ws/axis/1_4/)

```
java org.apache.axis.wsdl.WSDL2Java http://someurl?WSDL 
```

您将需要 -cp 类路径参数中的以下 jar 或等效项：

*   [轴1.4.jar](http://www.java2s.com/Code/JarDownload/axis/axis-1.4.jar.zip)
*   [commons-logging-1.1.ja](http://www.java2s.com/Code/Jar/c/Downloadcommonslogging111jar.htm)
*   [commons-discovery-0.2.jar](http://www.java2s.com/Code/JarDownload/commons-discovery/commons-)
*   [jaxrpc-1.1.jar](http://www.java2s.com/Code/JarDownload/jaxrpc/jaxrpc-api-1.1.jar.zip)
*   [saaj-1.1.jar](http://www.java2s.com/Code/JarDownload/axis2-saaj/axis2-saaj-1.1.jar.zip)
*   wsdl4j-1.4.jar
*   [激活-1.1.jar](http://central.maven.org/maven2/javax/activation/activation/1.1/activation-1.1.jar)
*   [mail-1.4.jar](http://www.java2s.com/Code/JarDownload/java-mail/java-mail-1.4.jar.zip)

这将生成与 wsimport 类似的存根。

*或者*，如果您不使用需要 rpc/encoded 的模式部分，您可以下载 WSDL 的副本并注释掉这些位。然后对本地文件运行 wsimport。

如果您查看 WSDL，以下位正在使用 rpc/encoded：

```
<soap:body use="encoded"
           encodingStyle="http://schemas.xmlsoap.org/soap/encoding/"> 
```

* * *

## 回答 #2

> 赞同：20
> 
> 时间：2014-07-28T06:43:25.400

我使用了 Chase Seibert 在[他的回答](https://stackoverflow.com/a/415326/1407228)中建议的 Axis 1.4 ，尽管该答案中给出的下载链接不起作用。我使用的替代下载链接给了我不同的库。以下是我生成代码所遵循的步骤。

转到[http://apache.is.co.za/axis/axis/java/1.4/](http://apache.is.co.za/axis/axis/java/1.4/)并下载**axis-bin-1_4.zip**。

提取它，您应该有以下文件（以及其他文件）：

*   轴.jar
*   commons-discovery-0.2.jar
*   commons-logging-1.0.4.jar
*   jaxrpc.jar
*   saaj.jar
*   wsdl4j-1.5.1.jar

使用以下命令执行 WSDL2Java（当然是替换 URL）：

```
java -cp axis.jar;commons-logging-1.0.4.jar;commons-discovery-0.2.jar;jaxrpc.jar;saaj.jar;wsdl4j-1.5.1.jar org.apache.axis.wsdl.WSDL2Java http://someURL?WSDL 
```

这将生成您的 Java 文件。

**PS：**这似乎在使用 Axis 1.2.1 时同样有效。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2012-04-17T17:10:51.740

可能这对CXF有帮助。Alteast 它对我有用。我编辑了 WSDL 文件并删除了 SOAP-ENC 的所有引用并`ArrayOfString`以下列方式创建了类型

```
<xsd:complexType name="ArrayOfString">
    <xsd:sequence>
      <xsd:element minOccurs="0" maxOccurs="unbounded" name="String" type="xsd:string"/>
    </xsd:sequence>
</xsd:complexType> 
```

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2018-10-15T21:51:48.897

如果有人想使用 maven：（加上一些关于 WSDL 绑定样式[的信息）](https://www.ibm.com/support/knowledgecenter/en/SSB27H_6.2.0/fa2ws_ovw_soap_syntax_lit.html "这里")

```
<build>
    <plugins>
        <plugin>
            <groupId>org.codehaus.mojo</groupId>
            <artifactId>axistools-maven-plugin</artifactId>
            <version>1.4</version>
            <executions>
                <execution>
                    <id>generate-sources</id>
                    <phase>generate-sources</phase>
                    <goals>
                        <goal>wsdl2java</goal>
                    </goals>
                    <configuration>
                        <!-- Use your .wsdl location here-->
                        <sourceDirectory>${basedir}/src/main/resources/wsdl</sourceDirectory>
                    </configuration>
                </execution>
            </executions>
        </plugin>
    </plugins>
</build>
<!-- Here the libraries that you need to call the Axis WS client -->
<dependencies>
    <dependency>
        <groupId>org.apache.axis</groupId>
        <artifactId>axis</artifactId>
        <version>1.4</version>
    </dependency>
    <dependency>
        <groupId>org.apache.axis</groupId>
        <artifactId>axis-jaxrpc</artifactId>
        <version>1.4</version>
    </dependency>
    <dependency>
        <groupId>commons-logging</groupId>
        <artifactId>commons-logging</artifactId>
        <version>1.2</version>
    </dependency>
    <dependency>
        <groupId>commons-discovery</groupId>
        <artifactId>commons-discovery</artifactId>
        <version>0.5</version>
    </dependency>
    <dependency>
        <groupId>axis</groupId>
        <artifactId>axis-wsdl4j</artifactId>
        <version>1.5.1</version>
    </dependency>
    <dependency>
        <groupId>org.apache.axis</groupId>
        <artifactId>axis-saaj</artifactId>
        <version>1.4</version>
    </dependency>
    <!-- activation+mail: To stop Axis generating WARNING about "Attachment support being disabled" -->
    <dependency>
        <groupId>javax.activation</groupId>
        <artifactId>activation</artifactId>
        <version>1.1.1</version>
    </dependency>
    <dependency>
        <groupId>javax.mail</groupId>
        <artifactId>mail</artifactId>
        <version>1.4.7</version>
    </dependency>
</dependencies> 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2020-04-29T12:27:20.883

这是发生在我身上的事情（同一文件夹中的旧 wsdl）：[https ://www.damirscorner.com/blog/posts/20180831-CodeGenerationWithMavenCxfPlugin.html](https://www.damirscorner.com/blog/posts/20180831-CodeGenerationWithMavenCxfPlugin.html)

“很明显，是其他原因导致 Maven 插件出现问题。经过大量试验和错误后，我终于找到了问题的根源。同一文件夹中还有另一个 WSDL 文件，该文件用于 RPC/literal web “

* * *

## 回答 #6

> 赞同：-4
> 
> 时间：2016-08-04T08:09:44.687

只需提取并执行 WSDL2Java？使用以下命令（当然是替换 URL）：

```
java -cp axis.jar;commons-logging-1.0.4.jar;commons-discovery-0.2.jar;jaxrpc.jar;saaj.jar;wsdl4j-1.5.1.jar org.apache.axis.wsdl.WSDL2Java http://someURL?WSDL 
```

# python - 与 Nodebox 类似的应用？

> ID：412775
> 
> 赞同：3
> 
> 时间：2009-01-05T10:48:05.513
> 
> 标签：python, nodebox

我正在寻找类似于[Nodebox](http://nodebox.net/code/index.php/Tutorial)的应用程序/环境。Nodebox 太酷了，我想知道是否还有其他类似的应用程序。

它们不必与图形相关；我对以新方式使用编程语言的软件感兴趣。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-01-05T10:51:44.463

[http://processing.org/](http://processing.org/ "加工")是一种类似于 Nodebox 的用于创建图形和动画的语言。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-05T12:47:00.657

@Jonas processing.org 上引用了它，但[alice.org](http://www.alice.org/)很有趣。

# mysql - 将子查询（不在）重写为加入

> ID：412777
> 
> 赞同：0
> 
> 时间：2009-01-05T10:49:12.313
> 
> 标签：mysql

大家好，是否可以重写查询：

`select userid from User where userid not in(select userid from UserRole where roleid in(8));`

作为加入？

问题是一个用户可能有多个角色
提前谢谢你。

```
mysql> desc 用户；  
+--------------------+--------+------+- ----+---------+----------------+  
| 领域 | 类型 | 空 | 钥匙 | 默认 | 额外 |  
+--------------------+--------+------+- ----+---------+----------------+  
| 用户名 | 整数(11) | 否 | 优先级 | 空 | 自动增量 |  
| 用户名 | varchar(50) | 是 | | 空 | |  

```

...和其他用户相关的列

```
mysql> desc 用户角色；  
+--------+---------+------+-----+---------+------- +  
| 领域 | 类型 | 空 | 钥匙 | 默认 | 额外 |  
+--------+---------+------+-----+---------+------- +  
| 用户名 | 整数(11) | 否 | 优先级 | 0 | |  
| 角色标识 | 整数(11) | 否 | 优先级 | 0 | |  
+--------+---------+------+-----+---------+------- +  

```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-05T19:06:34.323

我没有测试过这个，但我认为它有效。

```
select userID from user 
left join UserRole 
on user.userID = UserRole.userID 
and UserRole.roleID = 8
where UserRole.roleID IS NULL 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-05T10:52:31.950

也许这会起作用？

```
select userid from User 
left outer join
(select userid, roleid from UserRole where roleid in(8)) v
on User.userid = v.userid
where roleid is null; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-05T11:01:30.497

我认为这应该让您拥有除 8 以外的角色的每个人

```
select userid from User
where not exists 
  (select UserId from UserRole
     where UserRole.userid = User.userid and roleid not in(8) ) 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-05T11:45:12.920

如果您想提高可读性，可以使用 EXCEPT 子句。

IE

```
select userId from user 
except
select userId from UserRole where roleId <> 8 
```

不确定MySQL是否支持“除外”。

# c# - c#线程从调试器启动，但不会独立启动

> ID：412784
> 
> 赞同：1
> 
> 时间：2009-01-05T10:53:02.993
> 
> 标签：c#, multithreading

我有一个小应用程序，可以在启动时搜索并存储大量文件的名称。我将此搜索拆分为多个 Thread 对象，每个对象搜索一个目录，并将结果推送回主线程。

当应用程序加载时，我会遍历每个线程并加载它：

```
foreach(Thread t in m_threads)
{
    t.Start();
    while(!t.IsAlive){}
} 
```

当我在调试器中启动这个应用程序时，它会加载并且线程会快速找到所有文件。但是，如果我在调试器之外启动它会冻结。将调试器附加到进程中，我可以看到 IsAlive 永远不会返回 true。

我是 C# 线程的新手，所以有人知道出了什么问题，或者我如何更轻松地调试正在发生的事情吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-05T11:05:08.647

在您检查 IsAlive 之前，该线程可能已完成处理。

你为什么还要通过检查 IsAlive 标志来等待？

为什么不启动所有线程，然后在另一个循环中调用[Join()](http://msdn.microsoft.com/en-us/library/system.threading.thread.join.aspx)以等待线程完成？无需检查“IsAlive”。

更好的是，为什么不使用 ThreadPool 而不是自己启动一堆线程呢？

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-05T11:02:15.767

它可能与事情冻结的原因并不完全相关，但您的实施是非常值得怀疑的。您枚举一组线程，启动每个线程，然后阻塞直到线程完成？我认为您可能打算做的是启动所有线程，然后阻塞直到所有线程完成。（注意：这是假设您打算写：“ *while(t.IsAlive) {}* ”，因为等待线程启动更没有意义。）

至于冻结，我们可能需要看剩下的代码。既然您说您是 C# 线程的新手，并且看看您在上面所做的事情，我假设您也是线程的新手，这意味着可能会有很多地方出现问题。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-05T11:00:58.593

您可能的意思是`IsAlive()`“从不返回错误”。

好吧，如果是这样，那是因为您的线程继续无限执行。可能是您在这些线程中调用的方法具有无限循环或其他东西。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-05T11:08:04.883

It appears I mis-understood the code I cut-and-paste'd to create my threading code. I assumed the while(!t.isAlive){} line was blocking until the thread could properly start itself, and thought it was necessary administration.

I removed that line and the app launches fine out of the debugger. I join the threads later in the code, so that should be it.

Is there a "NEWB!" tag? :)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-01-05T11:24:16.613

With the code you provided above, It seems to me that you want to start the threads sequentially. If so why do you need many threads? 1 thread can do the job.

EDIT: (after your answer)

Ok. I see that you removed the questionable line.

Even so, in your case, I would consider to use only one thread for loading these file names because you are accessing only one IO resource (the disk). Each thread is competing for this resource. Have you tried to move 1 big file in windows and then move another big file while the first is still moving? The performance of your disk decreases. Because of this I would only create one thread for each different IO resource.

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-01-05T11:26:09.697

I would recommend not to hold a collection of Threads, but use Threadstarts instead. If you join them later, theres no need to wait until the Thread is running, so you while-loop is unnecessary. Make sure, your Threads are marked as Background-Threads, so they are cleaned up automatically after execution.

I would do this like this: List threadStarters = new List();

```
foreach (ThreadStart ts in threadStarters)
{
    Thread t = new Thread(ts);
    t.IsBackground = true;
    t.Start();
} 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-01-05T11:08:23.023

I don't know what you are doing in your threads exactly, but I think that...

**Multithreading + Application behaving differently with debugger attached = Race conditions**

I am pretty sure that you got some synchronization issues.

# ftp - 使用 GZipStream 计算进度（条形图）

> ID：412785
> 
> 赞同：3
> 
> 时间：2009-01-05T10:53:34.490
> 
> 标签：ftp, filesize, gzipstream

我正在从一些慢速源（如 FTP 服务器）读取 .gz 文件，并立即处理接收到的数据。看起来像这样：

```
FtpWebResponse response = ftpclientRequest.GetResponse() as FtpWebResponse;
using (Stream ftpStream = response.GetResponseStream())
using (GZipStream unzipped = new GZipStream(ftpStream, CompressionMode.Decompress))
using (StreamReader linereader = new StreamReader(unzipped))
{
  String l;
  while ((l = linereader.ReadLine()) != null)
  {
    ...
  }
} 
```

我的问题是显示准确的进度条。事先我可以得到压缩的 .gz 文件大小，但我不知道解压缩的内容有多大。逐行读取文件我很清楚我读取了多少未压缩字节，但我不知道这与压缩文件大小有何关系。

那么，有什么方法可以从 GZipStream 中获取文件指针进入压缩文件的距离？我只需要当前位置，在读取文件之前我可以获取的 gz 文件大小。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-05T14:58:22.717

You can plug a stream in between which counts, how many bytes GZipStream has read.

```
 public class ProgressStream : Stream
  {
    public long BytesRead { get; set; }
    Stream _baseStream;
    public ProgressStream(Stream s)
    {
      _baseStream = s;
    }
    public override bool CanRead
    {
      get { return _baseStream.CanRead; }
    }
    public override bool CanSeek
    {
      get { return false; }
    }
    public override bool CanWrite
    {
      get { return false; }
    }
    public override void Flush()
    {
      _baseStream.Flush();
    }
    public override long Length
    {
      get { throw new NotImplementedException(); }
    }
    public override long Position
    {
      get
      {
        throw new NotImplementedException();
      }
      set
      {
        throw new NotImplementedException();
      }
    }
    public override int Read(byte[] buffer, int offset, int count)
    {
      int rc = _baseStream.Read(buffer, offset, count);
      BytesRead += rc;
      return rc;
    }
    public override long Seek(long offset, SeekOrigin origin)
    {
      throw new NotImplementedException();
    }
    public override void SetLength(long value)
    {
      throw new NotImplementedException();
    }
    public override void Write(byte[] buffer, int offset, int count)
    {
      throw new NotImplementedException();
    }
  }

// usage
FtpWebResponse response = ftpclientRequest.GetResponse() as FtpWebResponse;
using (Stream ftpStream = response.GetResponseStream())
using (ProgressStream progressStream = new ProgressStream(ftpstream))
using (GZipStream unzipped = new GZipStream(progressStream, CompressionMode.Decompress))
using (StreamReader linereader = new StreamReader(unzipped))
{
  String l;
  while ((l = linereader.ReadLine()) != null)
  {
    progressStream.BytesRead(); // does contain the # of bytes read from FTP so far.
  }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-05T11:40:08.017

我建议你看看下面的代码：

```
public static readonly byte[] symbols = new byte[8 * 1024];

public static void Decompress(FileInfo inFile, FileInfo outFile)
{
    using (var inStream = inFile.OpenRead())
    {
        using (var zipStream = new GZipStream(inStream, CompressionMode.Decompress))
        {
            using (var outStream = outFile.OpenWrite())
            {
                var total = 0;
                do
                {
                    var async = zipStream.BeginRead(symbols, 0, symbols.Length, null, null);
                    total = zipStream.EndRead(async);
                    if (total != 0)
                    {
                        // Report progress. Read total bytes (8K) from the zipped file.
                        outStream.Write(symbols, 0, total);
                    }
                } while (total != 0);
            }
        }
    }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-05T14:27:35.603

I've revisited my code and I've performed some tests. IMHO darin is right. However I think it's possible to read only the header (size ?) of the zipped stream and find out the resulting file size. (WinRar "knows" what's the unzipped file size without unzipping the entire zip archive. It reads this information from archive's header.) If you find the resulting file size this code will help you to report a precise progress.

```
public static readonly byte[] symbols = new byte[8 * 1024];

public static void Decompress(FileInfo inFile, FileInfo outFile, double size, Action<double> progress)
{
    var percents = new List<double>(100);

    using (var inStream = inFile.OpenRead())
    {
        using (var zipStream = new GZipStream(inStream, CompressionMode.Decompress))
        {
            using (var outStream = outFile.OpenWrite())
            {
                var current = 0;

                var total = 0;
                while ((total = zipStream.Read(symbols, 0, symbols.Length)) != 0)
                {
                    outStream.Write(symbols, 0, total);
                    current += total;

                    var p = Math.Round(((double)current / size), 2) * 100;
                    if (!percents.Contains(p))
                    {
                        if (progress != null)
                        {
                            progress(p);
                        }
                        percents.Add(p);
                    }
                }
            }
        }
    }
} 
```

I hope this helps.

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-03-27T03:03:48.497

As a proxy for decompressing progress you may try to get the information for file's download progress from the underlying stream using:

```
var percentageProgress = ftpStream.Position / (double)ftpWebResponse.ContentLength; 
```

or

```
var percentageProgress = ftpStream.Position / (double)ftpStream.Length; 
```

It works on a [FileStream](http://msdn.microsoft.com/en-us/library/system.io.filestream.aspx) and it should work on a [GetResponseStream()](http://msdn.microsoft.com/en-us/library/system.net.ftpwebresponse.getresponsestream%28v=vs.110%29.aspx) provided it implements [Position](http://msdn.microsoft.com/en-us/library/system.io.stream.position%28v=vs.110%29.aspx) property and the FTP server returns information on the downloaded file's length: [http://msdn.microsoft.com/en-us/library/system.net.ftpwebresponse.contentlength(v=vs.110).aspx](http://msdn.microsoft.com/en-us/library/system.net.ftpwebresponse.contentlength(v=vs.110).aspx)

# c - 适用于 Linux 的 Windows Beep() 等效项

> ID：412789
> 
> 赞同：7
> 
> 时间：2009-01-05T10:56:44.513
> 
> 标签：c, linux, audio

我正在 Windows 上尝试 Beep 功能：

```
#include <windows.h>
...
Beep(frequency, duration); 
```

然后计算机会在一段时间内以某种频率发出哔哔声。我将如何在 Linux 计算机上执行此操作？

编辑：输出不同的频率很重要。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-01-05T11:09:32.897

查看 Ubuntu（可能还有其他发行版）提供的 beep 源代码，或者查看[http://www.johnath.com/beep/beep.c](http://www.johnath.com/beep/beep.c)以获取另一个源代码（我相信它是相同的代码）。

它允许您轻松控制频率、长度和重复次数（除其他外）。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-01-05T12:07:13.950

lets have us some gabba coming from the audio speakers

```
#!/usr/bin/ruby

$audio = File.open("/dev/audio", "w+")
def snd char
    $audio.print char.chr
end

def evil z
    0.step(100, 4.0 / z) { |i|
        (i / z).to_i.times { snd 0 }
        (i / z).to_i.times { snd 255 }
    }
end

loop {
    evil 1 
    evil 1
    evil 1
    evil 4
} 
```

more seriously though:

```
//g++ -o pa pa.cpp -lportaudio
#include <portaudio.h>
#include <cmath>

int callback(void*, void* outputBuffer, unsigned long framesPerBuffer, PaTimestamp, void*) {
    float *out = (float*)outputBuffer;
    static float phase;
    for(int i = 0; i < framesPerBuffer; ++i) {
        out[i] = std::sin(phase);
        phase += 0.1f;
    }
    return 0;
}

int main() {
    Pa_Initialize();
    PaStream* stream;
    Pa_OpenDefaultStream(&stream, 0, 1, paFloat32, 44100, 256, 1, callback, NULL);
    Pa_StartStream(stream);
    Pa_Sleep(4000);
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-05T11:00:42.400

我对 Linux 不熟悉，但输出 ascii 字符 0x07 似乎可以从我通过快速谷歌搜索读到的内容中做到这一点。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-05T11:11:55.000

I'd suggest you look at the source for the [beep](http://johnath.com/beep/) utility. that does exactly what you want. (specifically, it opens "/dev/console" and uses ioctl to request beep. note this will only work on the attached console)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-05T21:32:19.350

In summary:

1.  Outputting a BEL character to a terminal might produce a beep - depending on what terminal it is and what its configuration is. There is no control over this however.

2.  Any sound you like can be produced by outputting audio data to /dev/dsp or some other sound device. This includes beep, but making a sound involves playing back an actual sample.

3.  The console driver provides (in some configurations) an ioctl for /dev/console which beeps with a configurable pitch (much like the NT one)

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2009-01-05T11:00:40.967

[该站点](http://syyedwahab.wordpress.com/2007/12/13/producing-beep-in-c-linux/)显示了两种方式：

```
char beep[] = {7, ”};
printf(“%c”, beep); 
```

和

```
Beep(587,500); 
```

# apache-flex - - 旋转图像

> ID：412791
> 
> 赞同：0
> 
> 时间：2009-01-05T10:58:14.153
> 
> 标签：apache-flex, image, rotation

为了图像旋转，我使用了 Matrix 类。旋转效果很好，但如果我尝试滚动 - 图像隐藏。如何解决这个问题呢 ？如何旋转大图像？弹性代码[旋转]：

```
var tmpMatrix:Matrix = wImage.transform.matrix;
var oHeight:Number = wImage.height / 2;
var oWidth:Number = wImage.width / 2;``
tmpMatrix.translate(-oWidth, -oHeight);
tmpMatrix.rotate(-Math.PI / 2);
tmpMatrix.translate(oWidth, oHeight);
wImage.transform.matrix = tmpMatrix;

```

最好的问候， mykhaylo

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-11-05T02:33:43.703

根据我的经验，该代码的工作方式取决于图像先前的大小和位置以及旋转后的操作。旋转后我所做的是修改矩阵 tx 和 ty 以重新定位图像，这实际上是在视口之外。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-06T06:49:27.837

为什么不使用 wImage.rotation 属性？

# javascript - jQuery加载页面问题

> ID：412795
> 
> 赞同：0
> 
> 时间：2009-01-05T11:00:19.563
> 
> 标签：javascript, jquery, jquery-ui, jquery-ui-accordion

我使用起来相对较新，`jQuery`并且希望使用该`load`方法将内容拉入我的页面，因为我托管的网站不支持任何服务器端脚本。

我希望能够在被拉入（通过加载方法）的页面上运行更多的 JQuery，例如 UI 库中的手风琴。我怎样才能让它工作？

提前喝彩

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-05T11:06:15.307

该`$.load`方法有一个`callback`.

这将在数​​据返回时调用，以便您可以在此回调方法中实例化您的 ui 控件。

例如

```
 //Load html page with Accordian markup
    $('#someDiv').load(urlWithAccordian, function(){
        //Create Accordian
        $('#someUL').accordian();
    }); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-05T11:19:57.260

**换主机！**您永远不必依赖 JavaScript 来处理像内容这样基本的东西！

# asp.net - asp.net 观察者模式

> ID：412807
> 
> 赞同：2
> 
> 时间：2009-01-05T11:03:01.133
> 
> 标签：asp.net, design-patterns, methodology

我正在研究一个中心类（主题）将包含大量数据的项目。将有一个使用 .net ajax 显示此数据的 aspx 页面。当从任何页面更新主题时，我希望所有打开的页面都更新。我将为此使用观察者模式。问题是，我是让实际的 aspx 页面成为观察者，还是有更好的方法来做到这一点？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-01-05T12:13:08.463

在这种情况下，观察者模式没有意义。

Web（和 ASP.NET）通过请求（例如来自 Web 浏览器）和响应（例如来自 Web 服务器）的方式工作。

观察者模式要求主体（例如 Web 服务器）维护对其观察者（例如 Web 浏览器）的引用并将通知更新推送给它们。显然，这不适用于 Web 浏览器-Web 服务器场景。

我同意 Sergio 的观点，最好的方法可能是让您的客户端（Web 浏览器）定期检查资源（Web 服务器）的更新。最简洁的方法是 AJAX 调用。

一个很好的例子是 Gmail，新邮件在服务器上收到后很快就会出现在收件箱中，而无需用户提出明确的请求。这是通过 AJAX 调用来完成的，该调用会定期检查 Gmail 服务器是否有新邮件。

更新（2012.03.01）：-

最近的发展使得将数据从 Web 服务器推送到客户端成为一种更现实的可能性，例如[SignalR](http://signalr.net/)。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-05T12:13:51.503

塞尔吉奥是对的，在某种程度上你也是。通过 Asp.Net AJAX 实现这一点的最简单方法是使用 AJAX 计时器控件，但您当然不想在所有页面中复制它。更好的方法是将该功能包装到母版页中，或者甚至创建从 Page 派生的基本页。

查看[Timer Control 上的 MSDN 页面](http://msdn.microsoft.com/en-us/library/system.web.ui.timer.aspx)，以及一个不错的[视频教程](http://www.asp.net/learn/ajax-videos/video-78.aspx)。

作为设计的旁注，我不一定将实际的观察者代码放在你的代码后面。相反，您希望将这些事件转发到某个底层模型。这个想法是你的代码背后只负责与 UI 相关的东西和实现它的逻辑。本质上是 MVP/MVP 中的**V。**

此外，考虑到您正在谈论没有真实状态的单个 HTTP 响应/请求周期，我不确定“实际”观察者模式在 Web 上下文中的应用效果如何。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-05T11:24:35.363

我不熟悉观察者模式，但你必须这样做的唯一方法是在页面加载时放置一个 javascript 无限循环，每 X 秒调用服务器上的 AJAX 方法以检查更新。

# web-services - Oracle 应用程序 API 是否公开 Web 服务？（即 WS-* SOAP Web 服务？）

> ID：412811
> 
> 赞同：1
> 
> 时间：2009-01-05T11:06:42.950
> 
> 标签：web-services, oracle, soap, integration

我看到 Oracle 有一个全面的在线集成存储库 ( [http://irep.oracle.com/](http://irep.oracle.com/) )。

问题是......如何调用这些程序？我必须通过 PL/SQL 来完成吗？还是所有这些功能/程序都有自动公开的相应 Web 服务？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-01-05T11:50:42.550

Oracle 通过对 BPEL、WebServices 和 ESB 的工具和基础架构支持向 SOA 迈进了一大步。Oracle EBS 的某些部分已经有 Web 服务 api，其他部分肯定会在未来跟进。

以下是有关如何将 peoplesoft crm 与 oracle ebs 集成的一些文档：[http ://www.oracle.com/technology/pub/articles/bpel_cookbook/pravin.html](http://www.oracle.com/technology/pub/articles/bpel_cookbook/pravin.html)

# c# - 何时在 c# 中使用 ArrayList 而不是 array[]？

> ID：412813
> 
> 赞同：38
> 
> 时间：2009-01-05T11:07:28.860
> 
> 标签：c#, arrays, arraylist

我经常使用 an`ArrayList`而不是 'normal' `array[]`。

当我使用 an 时，我觉得自己在作弊（或懒惰） ，什么时候可以在数组`ArrayList`上使用 an ？`ArrayList`

* * *

## 回答 #1

> 赞同：66
> 
> 时间：2009-01-05T11:11:31.973

数组是强类型的，可以很好地用作参数。如果您知道集合的长度并且它是固定的，则应该使用数组。

ArrayList 不是强类型的，每次插入或重试都需要强制转换才能恢复到原始类型。如果您需要一种方法来获取特定类型的列表，那么 ArrayLists 就不够用了，因为您可以传入包含任何类型的 ArrayList。ArrayLists 在内部使用动态扩展数组，因此当内部数组达到其容量时，也有一个扩展内部数组大小的问题。

您真正想要使用的是一个通用列表，例如`List<T>`. 这具有 Array 和 ArrayLists 的所有优点。它是强类型的，它支持可变长度的项目。

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2009-01-05T11:20:43.780

除了 Bob 和 Frederick 的回应，我想指出，虽然数组具有协方差，但泛型列表没有。例如，类型数组`MyChildClass[]`可以很容易地转换为`MyParentClass[]`，而`List<MyChildClass>`不能转换为`List<MyParentClass>`，至少不能直接转换为 。

如果您需要协方差，请使用数组、使用 LINQ 的 Cast() 方法或其他方法来单独转换每个项目~~或等待 C# 4~~。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2009-01-05T11:36:06.510

这里的另一个想法是突变。数组 ( `T[]`) 是完全可变的，不能被保护。`List<T>`不提供任何有用的扩展点，但是`Collection<T>`（或许多其他`IList<T>`实现）之类的东西允许您添加代码，例如，在添加项目之前检查它们；同样，您可以拥有只读`IList<T>`实现，这对于需要不可变性的线程安全很有用。

我倾向于在内部方法逻辑（可能作为局部变量）中使用数组，作为`params`参数，或者在一些高度优化的情况下，我知道项目的长度，并且我知道代码*选择*不改变它（作为私人领域）。除此之外，`List<T>`等往往更常见，因为在添加/删除项目时它们的开销要少得多。

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2009-01-05T11:09:38.623

除非这部分代码对性能非常关键，否则使用 ArrayList 是非常好的。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2009-01-05T11:13:53.373

更好的是，无论你在哪里使用`ArrayList`，都可以使用`List<T>`泛型集合。它的类型比前者更强。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-01-05T13:08:53.810

我从 Java 的角度回答这个问题，但这是相同的基本问题。你不应该因为使用更高的抽象而感到内疚。毕竟，您使用的是`String`s 而不是`char[]`，甚至是`byte[]`? 我什至建议更进一步，并`List`尽可能使用该界面。降级的唯一原因是出于性能原因。

使用更高的集合抽象有很多优点。您可以添加装饰器以使列表成为只读，使其大小固定，检查进入或离开集合的项目或使用视图（参见`GetRange`C# 和`subList`Java。）

顺便说一句，an`ArrayList`应该始终基于原始数组，否则名称是错误的。这些操作通常按照您在使用原始数组时所期望的方式实现。如果使用链表，它通常命名为 -- `LinkedList`。这也是使用接口的一个优势：您可以稍后改变对使用的实现的看法。

有一些事情使集合的使用变得笨拙。需要注意的是，集合通常基于对象，并且语言在原始类型和对象类型之间存在相当大的差距。有限的泛型也没有多大帮助。尽管如此，除非有充分的理由，否则我推荐集合而不是数组。

对于原始值，您还可以考虑使用原始集合库，例如[GNU Trove](http://trove4j.sourceforge.net/)。不过，不知道 C# 是否有类似的东西。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-01-05T13:41:14.590

[Fabulous Adventures In Coding](http://blogs.msdn.com/ericlippert/default.aspx)写了一篇[Arrays 被认为有些有害](http://blogs.msdn.com/ericlippert/archive/2008/09/22/arrays-considered-somewhat-harmful.aspx)的文章。这真是一本有趣的书。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-01-05T11:15:46.630

好吧，如果您只打算处理特定类型，则不应使用 ArrayList。例如，如果您只期望一个字节数组，那么您应该只接受一个字节数组。

只有一次我认为您甚至可能会想到使用 ArrayList 来代替 List。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-01-05T11:27:16.403

数组的大小是静态的，所以如果您在设计时知道大小，请使用数组。它应该工作得更快，但我自己没有测试过。如果您需要经常更改对象的数量（从集合中添加或删除对象），请使用 ArrayList 或更好的 .NET 2 中的通用 List。它也更易于使用，因此如果性能不重要，您始终可以使用 List。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2013-02-05T21:16:22.747

如果您需要原始类型数组，请使用 Array 以获得更好的性能，因为它将避免自动装箱和拆箱。但前提是你提前知道你想要的尺寸。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2014-10-28T10:22:43.917

就像这样。

```
using System;
using System.Collections;

namespace ConsoleApplication2
{
    class Program
    {
        static void Main(string[] args)
        {
            //ArrayList
            /*
             An ArrayList doesn't use a LinkedList as the internal data structure! .we can store any type of objects      
             */
            ArrayList list = new ArrayList();
            list.Add("1"); // not strongly type,you can enter any object types (int,string decimals, etc..)
            list.Add(1);
            list.Add(1.25);

            //Array
            /*
             must declare length.
             */
            string[] array = new string[3]; // you must declare object types
            array[0] = "1";
            //array[1] = 1; this get error becoz array is storngly typed. // this print empty value when you run it
            array[2] = "stongly typed";
            Console.WriteLine("------- ARRAYLIST ITEMS ---------");
            foreach (var i in list) {
                Console.WriteLine(i);
            }

            Console.WriteLine("--------- ARRAY ITEMS -----------");
            foreach (var i in array)
            {
                Console.WriteLine(i);
            }

            Console.ReadKey(); 
        }
    }
} 
```

# api - Rect::contains(Point) 或 Point::is_inside(Rect)

> ID：412823
> 
> 赞同：4
> 
> 时间：2009-01-05T11:11:40.430
> 
> 标签：api, math, symmetric

API 应该提供 Rect::contains(Point) 或 Point::is_inside(Rect) 还是两者都提供？或 Math::contains(Point, Rect) 导致它是对称的？

LineSegment::contains(Point)、Rect::fully_contains(Circle) 等也是同样的 Q。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-01-05T11:16:02.150

`Rect::contains(Point)`最有意义，因为它是一个构建块。另一个并不是真正必要的，因为您希望每个特定的形状都可以实现操作，而`Point`不必知道每个可能的形状。同样的答案也适用于`LineSegment`。

关于 和 之间的关系，`Circle`使用`Rect`大多数面向对象的框架更加棘手，并且没有任何明确的答案。其他一些面向对象的风格，如 CLOS，通过使用通用函数和方法来做到这一点，这使得它成为一个不成问题的人。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-05T11:19:02.690

完全取决于是什么使您的程序表达更清晰，更符合您要解决的问题。因此，在某种程度上，以上所有内容在不同的情况下都应该没问题。

但是，总的来说，我略微倾向于`Rect::contains(Point)`而不是`Point::Is_inside(Rect)`. 那是因为我认为这个`Point`类，因为它会被各种类（比如'Circle'，'Hexagon'等）使用，应该是非常基本的并且只包含最小的接口。

`Math::contains(Rect, Point)`将是我的第二选择。如果我想保持我的 Rectangle 类非常原始并且不给它添加太多“便利”功能，我会使用这种方法。

要记住的重要一点是，不要认为你的课程设计是一成不变的。继续选择*现在*看起来最好的设计。每当您的需求发生变化时，您都可以并且*应该*对其进行更改。这就是所谓的[重构](http://en.wikipedia.org/wiki/Refactoring)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-05T11:33:58.403

我在 Math::contains 方法上支持 Frederick，尽管我认为最大的缺点是开发人员在查找方法时失去了 IntelliSense 的可发现性。这是我对 Boost 和 STL 的不满之一。

Rect::contains 最终出错的一个例子是 iPhone SDK 的绘制字符串的方法，它基本上是 String::drawInRect。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-05T12:19:44.987

这取决于实现，但像 Federick 一样，我也倾向于选择**Math::contains(Rect,Point)**，而不是**Rect::contains(Point)**。这样做的原因是后者导致了一个对象层次结构，其中包含作为虚拟的**包含**成员函数，它在类之间被覆盖。在处理大量矩形和类似图元时，这可能会产生巨大的开销。

# syntax - 在 where 子句中的 Haskell 解析器错误

> ID：412828
> 
> 赞同：6
> 
> 时间：2009-01-05T11:14:23.730
> 
> 标签：syntax, haskell

`rs`第一个 where 部分的定义有什么问题？

```
palindrome :: [a] -> [a]

palindrome xs = con xs rs
    where con a b = rev (rev a []) b
        rs = rev xs                        -- here
        where rev [] rs = rs
            rev (x:xs) rs = rev xs (x:rs) 
```

我只是在学习 Haskell，但它的语法规则让我感到困惑。错误信息是

```
[1 of 1] Compiling Main             ( pelindrome.hs, interpreted )

pelindrome.hs:5:8: parse error on input `rs' 
```

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-01-05T11:27:38.087

你的缩进是错误的，我认为你只能有一个`where`（我可能错了。我不是一个haskell人）。调用`rev`（空列表）还缺少一个参数：

```
palindrome :: [a] -> [a]
palindrome xs = con xs rs
    where con a b = rev (rev a []) b
          rs = rev xs []                       -- here
          rev [] rs = rs
          rev (x:xs) rs = rev xs (x:rs)

main = print (palindrome "hello") 
```

打印出来：

```
"helloolleh" 
```

我现在要试着理解它。不管怎样，玩得开心！

编辑：现在对我来说很有意义。我认为这是正确的版本。有关 Haskell 缩进规则，请阅读[Haskell Indentation](https://en.wikibooks.org/wiki/Haskell/Indentation)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-06T18:17:15.357

@litb：您可以以方式重写 con

```
palindrome :: [a] -> [a]
palindrome xs = con xs rs
    where con [] b = b
          con (x:xs) b = x:con xs b
          rs = rev xs []                       -- here
          rev [] rs = rs
          rev (x:xs) rs = rev xs (x:rs) 
```

which is how ++ is implemented in prelude. My previous version is way how to write it in non lazy functional or logical languages in tail call fashion (e.g. Erlang).

# c# - C# 如何为我的软件创建一个简单的基于时间的试用版？

> ID：412833
> 
> 赞同：6
> 
> 时间：2009-01-05T11:15:44.977
> 
> 标签：c#

我有一个想出售的 C# 程序，我想提供 14 天的试用期，我知道所有的盗版预防计划都已被克服，所以我不想浪费太多时间来做这件事。任何人都可以提供任何建议甚至一些示例代码吗？

谢谢

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-01-05T11:24:39.280

我的选择是将安装日期（用密钥加密）存储在注册表或配置文件中。每次应用程序启动时看看这个。

[您可以使用RsaProtectedConfigurationProvider](http://msdn.microsoft.com/en-us/library/system.configuration.rsaprotectedconfigurationprovider.aspx)之类的东西来保护您的 app.config 文件。

显然，如果他们对源代码进行反编译，他们会在其中找到密钥，混淆可能会有所帮助，或者使用公钥/私钥，但这对于您需要的东西来说可能有点过头了。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-01-05T11:47:12.963

窃贼总是可以将时间倒流到安装后的 14 天内，以及虚拟化以达到同样的目的。您可以指望网络访问并让程序电话回家获取密钥吗？

HASP 是一家全职从事这项工作的公司。

此外，根据您的目标市场规模、购买价格、竞争对手以及您要销售的生态系统等因素，您可能会认为一定数量的 priracy 可能是您最好的营销工具。哪个风险更大：您的软件被广泛盗版，或者您的软件被淹没在噪音中，甚至很少有人尝试过？据称，某些软件的成功归功于广泛传播的盗版（WordStar、dBase、Lotus 1-2-3、iirc）。一个快速的谷歌显示“寻找愚蠢”的第 13 章涉及到这一点。

这是一个棘手的问题，祝你好运。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-01-05T13:03:31.980

存储如上所述加密的安装日期。

每次应用程序启动时也存储今天的日期。如果这一天突然回到过去，你就知道他们作弊了，你就关闭了程序。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-01-05T15:40:31.150

Just do a nag screen if it's not registered. People are going to steal your software, whether you like it or not. Wasting time on a copy protection system is just going to make it more frustrating when people steal your software.

A gentle reminder that it's still in the trial stage will probably suit you better, ala WinRar.

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-01-05T11:46:59.453

我会在[www.eziriz.com上使用 .NET Reactor](http://www.eziriz.com)

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-01-05T11:45:46.523

只有这样做的保存方法会侮辱软件的在线注册到你们其中的一个服务器。该软件应在安装时生成一个使用固定系统 ID 的 ID，以便服务器可以识别该系统上的软件。

好吧，我建议不要构建试用版，而是构建功能有限的免费版本。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2015-11-18T12:02:06.967

老实说，因为您使用的是 C#，所以我想说不要在许可上浪费时间。如果有人想要你的程序而不付钱，他们会简单地用任何 IL 阅读器打开它并删除你的许可系统，或者干脆不使用它。

正如另一位用户所说，制作功能有限的免费版本。出售完整版，希望它不会在洪流网站上传播得太快。

或者只是用另一种语言（例如 c++）重新制作您的应用程序，并使用必须连接到服务器的许可系统。使逆向工程变得更加困难。

请注意，只要您的程序变得有点流行，它就会被黑客入侵/破解。

只需依靠诚实的人或将其用于商业用途的人，并且不能承受使用非法软件“被抓”的后果。

编辑* 有人说在 www.eziriz.com 上使用 .NET Reactor 如果它像宣传的那样工作，这只会阻止人们轻松阅读您的代码。它不会阻止人们对其进行逆向工程并对其进行破解。问题是您想为保护支付多少费用？（这基本上是用另一种编程语言重写它，只有你付费。（虽然耗时更少），它再次像宣传的那样工作吗？）

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2011-08-24T04:35:42.017

如果您不想在设计许可方案上浪费时间，可以考虑使用像[CryptoLicensing](http://www.ssware.com/cryptolicensing/cryptolicensing_net.htm)这样的即用型系统——它支持 X 天试用等。

免责声明：我为 CryptoLicensing 的开发人员 LogicNP Software 工作。

* * *

## 回答 #9

> 赞同：-1
> 
> 时间：2015-11-18T11:03:14.510

要在 C 中获取当前的“时间”，您必须使用头文件 stdlib.h 和函数：

```
system("echo %time%"); 
```

程序：

```
main(){
  system("echo %time%");
  getch();
} 
```

# c# - 命名约定：动词/名词和英语语法使用指南

> ID：412839
> 
> 赞同：18
> 
> 时间：2009-01-05T11:18:51.787
> 
> 标签：c#, .net, naming-conventions

谁能给我指点一个站点，或者给我一些关于如何为接口、类甚至可能与该对象或方法的作用相关的方法和属性选择名称的智慧？

这是专门针对 Microsoft 开发的，因此 Java 风格的“doGet”等并没有真正使用，但是必须存在一些跨越语言障碍的通用规则（我会认为）。

一个例子可能会有所帮助：我有 4 种接口名称可供选择：

```
IGroupedItem
IGroupableItem
IDataEntity
IGroupedEntity 
```

它们都包含一个形容词和一个名词，或者只是一个名词。看看 .NET 框架，似乎必须为此制定某种规则集，以保持一致性？除了方法的明显动词。

**编辑：**虽然该示例是一个接口，但我并不仅限于接口。一般准则是类是名词、方法动词、属性名词。我想我的意思是同义词的选择。到处都是错误的“实体”

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2009-01-05T11:37:48.707

查看[MSDN 文章](http://msdn.microsoft.com/en-us/library/xzf533w0(VS.71).aspx)以了解命名准则。简而言之：

*   对类名和属性名使用名词（很明显）
*   对于接口名称，以 I 开头并使用名词和/或形容词来描述行为
*   使用动词作为方法名称来描述动作

对于您的示例 - IGroupableItem。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-01-05T11:21:28.147

接口是类能够做的事情。不是它**是**什么，而是它能做**什么**。

```
IGroupableItem 
```

其他名称描述了事物是什么或太模糊而无用。

具体来说，“IDataEntity”在很大程度上没有意义。毕竟，一切都是数据实体。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-01-05T11:20:46.073

MSDN 有一篇关于[接口命名指南](http://msdn.microsoft.com/en-us/library/8bc1fexb(VS.71).aspx)的文章，可以帮助您。如果您想要接口以外的东西的命名约定，以及许多其他命名和设计指南，您也可以在 MSDN 上找到所有内容。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-05T11:38:30.000

这与 Spodi 的答案相同，但 MSDN 的[类库开发人员设计指南](http://msdn.microsoft.com/en-us/library/czefa0ke.aspx)大多非常出色，涵盖了[命名](http://msdn.microsoft.com/en-us/library/xzf533w0.aspx)等等。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-01-05T11:49:39.040

Joel Spolsky有一篇很好的文章 [Making Wrong Code Look Wrong](http://www.joelonsoftware.com/articles/Wrong.html) 。它讲述了不那么流行但非常方便的命名约定。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-01-05T11:53:40.047

除了 MSDN 指南之外，还有来自Juval Lowy 的[IDesign](http://www.idesign.net)的 C# Coding Standards 文档非常有帮助（不知道这与 MSDN 是否/有多大不同）。

[C# 编码标准](http://www.idesign.net/idesign/download/IDesign%20CSharp%20Coding%20Standard.zip)

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2020-08-02T19:21:02.117

对于功能（等）名称中的动词，通常使用动词的原始形式，例如`Handle`, `ExecuteQuery`, or `IsAny`, ...

动词的一些不太常见的用法使它与`s/es`, like `ProducesResponseType`( [MS Docs](https://docs.microsoft.com/en-us/dotnet/api/microsoft.aspnetcore.mvc.producesresponsetypeattribute?view=aspnetcore-3.1) ) 单数。

* * *

## 回答 #8

> 赞同：-1
> 
> 时间：2009-01-05T11:49:40.057

试试这个....

主站点：[http](http://www.ssw.com.au/ssw/standards/Default.aspx)
://www.ssw.com.au/ssw/standards/Default.aspx 代码规则：[http ://www.ssw.com.au/ssw/Standards/Rules/RulestoBetterCode.aspx](http://www.ssw.com.au/ssw/Standards/Rules/RulestoBetterCode.aspx)

# .net - 我可以使用 .NET 创建 IOC 控件以放置在 Web 项目中吗？

> ID：412859
> 
> 赞同：0
> 
> 时间：2009-01-05T11:29:18.553
> 
> 标签：.net, user-controls, ioc-container

我目前有一个用户控件库，我在我们的许多 Web 应用程序中使用它。我想更新这些控件，以便我可以使用 IOC 来帮助分离逻辑。

所以我会在网页本身上有类似于以下内容的内容：

```
<prefix:ControlName ID="myControl" runat="server" property="value1" /> 
```

并且该控件将具有类似于以下内容的构造函数：

```
public ControlName (IControlLogic logic) 
```

然后理想情况下，IOC 容器将处理注入。这可以做到吗？如果是这样，哪些图书馆提供这个？如果您有任何您知道的讨论这个的链接，他们将非常感谢。

提前致谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-03T22:56:10.127

不幸的是，ASP.NET 似乎不支持任何简单的控件工厂创建模式。但是，在 3.5 中，您可以非常精细地控制 ASP.NET 运行时为您的 .aspx 文件生成的实际代码。

只需将 [ControlBuilder(...)] 属性应用于您希望由容器构造的所有控件。子类化 ControlBuilder 并覆盖 ProcessGeneratedCode 以将构造函数替换为对容器的调用。

这是一个简单的例子：

```
public class ServiceProviderBuilder : ControlBuilder
{
    public override void ProcessGeneratedCode(System.CodeDom.CodeCompileUnit codeCompileUnit, System.CodeDom.CodeTypeDeclaration baseType, System.CodeDom.CodeTypeDeclaration derivedType, System.CodeDom.CodeMemberMethod buildMethod, System.CodeDom.CodeMemberMethod dataBindingMethod)
    {
        // search for the constructor
        foreach (CodeStatement s in buildMethod.Statements)
        {
            var assign = s as CodeAssignStatement;
            if (null != assign)
            {
                var constructor = assign.Right as CodeObjectCreateExpression;
                if (null != constructor)
                {
                    // replace with custom object creation logic
                    assign.Right = new CodeSnippetExpression("("+ ControlType.FullName + ")MyContainer.Resolve<" + ControlType.BaseType.FullName + ">()");
                    break;
                }
            }
        }
        base.ProcessGeneratedCode(codeCompileUnit, baseType, derivedType, buildMethod, dataBindingMethod);
    }
}    

[ControlBuilder(typeof(ServiceProviderBuilder))]
public partial class WebUserControl1 : System.Web.UI.UserControl
{
    public WebUserControl1()
    {

    }

    protected void Page_Load(object sender, EventArgs e)
    {

    }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-05T11:55:30.230

是的，你可以，我建议你看看 spring.net

[http://www.springframework.net/doc-latest/reference/html/springair.html](http://www.springframework.net/doc-latest/reference/html/springair.html)

我不确定您是否要保留您建议的用户控制理念。

就我个人而言，我一起使用 spring.net 和 nHibernate（尽管避免了当前提供的 Hibernate 模板），这与 .net MVC beta 的东西非常配合。

使用 Spring.net 处理 nHibernate 会稍微减少配置条目，并且 MVC 不使用您需要的上下文 xml（springair 是一个很好的例子）。

祝你好运

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-10-05T08:23:52.540

不幸的是，这个问题没有一个答案，许多 IOC 容器包含一些注入控件属性的实现，但是（当前）没有办法在没有无参数构造函数的情况下实际创建控件。

# c# - 如何返回 Visual Studio 当前打开的 soution 目录

> ID：412864
> 
> 赞同：3
> 
> 时间：2009-01-05T11:33:43.893
> 
> 标签：c#, .net, vb.net, visual-studio, ide

我有一个 Visual Studio 解决方案，它由多个项目组成，并被分成不同的目录。

在我的 C# 或 VB.NET 代码中，我想确定基目录（或解决方案所在的目录）。

一个肮脏的解决方案是调用该目录`parent.parent.parent`，直到我找到一个文件 *.sln，但我在其他目录中也有几个我不想返回的解决方案。

我只是想知道是否有更清洁的方法，可能是一部分`System.Diagnostics.Debugger`或类似的方法？

期待您的回复，谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-05T11:49:37.607

即使您在其他目录中有解决方案，但大概这些不是您原始解决方案中的目录，是吗？您设想在什么情况下“递归直到找到 .sln 文件”会失败（除了从错误的目录运行）？

一种替代方法是将解决方案目录作为命令行参数传递。

出于兴趣，你需要这个做什么？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-05T11:50:27.167

由于 sln 文件不需要部署在目标机器上 - 你为什么要试图找到它？[如果您仍想使用EnvDTE 命名空间](http://msdn.microsoft.com/en-us/library/envdte._solution_members(VS.80).aspx)
中的 slntry

> EnvDTE.DTE dte = (EnvDTE.DTE) System.Runtime.InteropServices.Marshal.GetActiveObject("VisualStudio.DTE");
> 字符串文件夹 = System.IO.Path.GetDirectoryName(dte.ActiveDocument.FullName);

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-05T12:10:53.100

谢谢您的回答。所有人都非常有帮助。我使用了 Dror 的答案，并对以下行进行了一些修改，解决了这个问题，谢谢。

```
string folder = System.IO.Path.GetDirectoryName(dte.Solution.FullName); 
```

我想这样做的原因是在 IDE 中运行代码时，我确定了项目的当前 Subversion 版本，以便我可以将其嵌入到正在运行的软件版本中。

这是自动完成的。参见我在 codeproject 上写的文章： [link text](http://www.codeproject.com/KB/architecture/svn_visual_studio.aspx)

如果您查看代码，您将看到我执行以下操作： dirinfoSourceWorkingDir = dirInfo.Parent().Parent().Parent();

我需要确定当前在 Visual Studio 中打开的解决方案的目录，但需要一种更简洁的方式（如果我更改目录结构，这会破坏代码）。

希望这是有道理的！

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-05T11:50:58.400

代码是否在解决方案中运行，即在 IDE 调试器中运行？如果是这样，您可以将解决方案目录`$(SolutionDir)`从 IDE 传递到命令行。

# asp.net - Asp.net 和 windows 身份验证

> ID：412867
> 
> 赞同：4
> 
> 时间：2009-01-05T11:35:22.953
> 
> 标签：asp.net, windows, authentication, forms

我的应用程序需要进行设计，以便管理员可以通过 Web 界面选择他们的用户是通过 Windows 身份验证还是表单身份验证登录。

这意味着我无法在 web.config 中指定身份验证模式，即：

```
<system.web>
    <authentication mode="Windows"/>
</system.web> 
```

我该如何处理？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-05T11:41:41.430

使用 Forms 身份验证模式，登录表单可以确定用户和该用户的首选身份验证方法。如果用户可以通过 windows 身份验证，则不需要提供登录表单，只需将用户设置为已验证并相应地重定向即可。

# php - 在php中按小数点拆分数字

> ID：412875
> 
> 赞同：6
> 
> 时间：2009-01-05T11:40:23.723
> 
> 标签：php, split

如何在php中按小数点拆分数字？

我有 $num = 15/4; 这将 $num 变为 3.75。我想拆分 3 和 75 部分，所以 $int = 3 和 $dec = 75。我的非工作代码是：

```
$num = 15/4; // or $num = 3.75;
list($int, $dec) = split('.', $num); 
```

但这会导致 $int 和 $dec 为空。

提前致谢。

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2009-01-05T12:24:09.300

如果你`explode`用十进制表示数字，你会失去精度。如果您不介意，那就这样吧（对于文本表示来说没关系）。考虑语言环境！我们比利时人使用逗号（至少是非编程的:)。

如果你*介意*（例如计算），你可以使用这个`floor`函数：

```
$num = 15/4
$intpart = floor( $num )    // results in 3
$fraction = $num - $intpart // results in 0.75 
```

注意：这是正数。对于负数，您可以反转符号，使用正方法，并重新反转 int 部分的符号。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-01-05T11:44:40.423

尝试[爆炸](http://php.net/explode)

```
list($int,$dec)=explode('.', $num); 
```

因为您实际上并不需要使用基于正则表达式的拆分。[拆分](http://php.net/split)不适合你作为一个'。字符需要转义以提供文字匹配。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-01-05T11:43:26.993

```
$num = 15/4; // or $num = 3.75;
list($int, $dec) = explode('.', $num); 
```

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-01-05T12:08:24.230

```
$int = $num > 0 ? floor($num) : ceil($num);
$dec = $num - $int; 
```

如果你想`$dec`在消极时保持积极`$num`（就像其他答案一样），你可以这样做：

```
$dec = abs($num - $int); 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2013-05-02T20:57:50.310

```
$num = 3.75;
$fraction = $num - (int) $num; 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-04-03T22:29:47.543

```
$num = 15/4;
substr(strrchr($num, "."), 1) 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2016-02-06T14:01:10.420

这适用于正数和负数：

```
$num = 5.7;
$whole = (int) $num;         //  5
$frac  = $num - (int) $num;  // .7 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2014-09-25T09:59:12.673

如果您不想失去精度，可以使用这些：

```
$number = 10.10;
$number = number_format($number, 2, ".", ",");
sscanf($number, '%d.%d', $whole, $fraction);

// you will get $whole = 10, $fraction = 10 
```

# .net - 在 USB 硬件插件上启动程序

> ID：412910
> 
> 赞同：2
> 
> 时间：2009-01-05T11:58:00.337
> 
> 标签：.net, usb

有没有办法检测特定设备何时插入 USB 端口，我希望发生的情况是，当我将笔记本电脑插入扩展坞时，它会运行多个应用程序来解决我不同的键盘、鼠标和显示器。具体来说，我的 G15 键盘阻止媒体播放器正常关闭的某些软件存在问题。

希望在 .NET 中，但如果没有任何建议，我们将不胜感激。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-05T12:17:39.640

尝试使用[SharpUSBLib](http://www.icsharpcode.net/OpenSource/SharpUSBLib/default.aspx)。它是 libusb 项目的 C# 包装器。

我在下面粘贴了一个代码示例（包含在下载中 - 只是自己尝试过）。它看起来很简单，我认为它会为您提供大量有关通过 USB 连接到笔记本电脑的设备的信息。

```
 foreach (Bus bus in Bus.Busses)
        {
            Console.WriteLine(bus);
            foreach (Descriptor descriptor in bus.Descriptors)
            {
                Console.WriteLine("\t" + descriptor);
                try
                {
                    using (Device device = descriptor.OpenDevice())
                    {
                        Console.WriteLine("\t\t     Product: " + device.Product);
                        Console.WriteLine("\t\tManufacturer: " + device.Manufacturer);
                        Console.WriteLine();
                    }
                }
                catch (UsbException e)
                {
                    Console.WriteLine("Got Exception : " + e);
                }
            }
        } 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-05T12:30:07.993

您可以查看 WMI 以获取硬件信息。

[http://msdn.microsoft.com/en-us/library/aa394582.aspx](http://msdn.microsoft.com/en-us/library/aa394582.aspx)

# sql-server-2005 - 将 SQL2000 升级到 SQL2005 是否有性能优势？

> ID：412913
> 
> 赞同：0
> 
> 时间：2009-01-05T12:00:00.847
> 
> 标签：sql-server-2005, performance, sql-server-2000, migration

我看过[这个](https://stackoverflow.com/questions/140733/why-should-i-upgrade-from-sql2000-to-sql2005)问题，但没有关于性能的回应。

从 SQL2000 到 SQL2005 的简单升级是否有任何性能优势？

我正在考虑一个业务线 OLTP 数据库。我没有使用 OLAP 或 FTI。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-05T12:32:55.087

我们发现是的。

查询优化器已更新且更好。我们发现很多查询计划都不同，完全没有其他变化。

甚至我们的最终用户也对速度改进和总体响应能力发表了评论。我有电子邮件证明:-D

同时，我们重写了一些存储过程，因为它们更糟糕。然而，同样的调整也改进了对 SQL 2000 的响应，只是糟糕的代码/想法。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-10-08T08:35:56.973

I still haven't found much on this but here is a load of marketing stuff that essentially says SQL2005 is a good thing:

[http://www.microsoft.com/sqlserver/2005/en/us/white-papers.aspx#gen](http://www.microsoft.com/sqlserver/2005/en/us/white-papers.aspx#gen)

and in this white paper ["Why upgrade to SQLSERVER2005"(.doc)](http://download.microsoft.com/download/a/4/7/a47b7b0e-976d-4f49-b15d-f02ade638ebe/SQLServer2005_WhyUpgrade.doc)

it states

> **Faster Response Times for End Users**
> 
> Database query response times have improved 70−80 percent for many applications converted from SQL Server 2000 to SQL Server 2005\. Quicker response times to queries help business users react faster and enable the database to be used for real-time decision making. Queries that might have previously taken several hours can now be completed in a matter of minutes. This provides a whole new level of functionality for end-users because analysis can be done on an ad hoc basis rather than exclusively in predefined reports. Companies can use this new accessibility to information to dynamically monitor processes.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-10-08T08:43:41.887

另一方面，升级时似乎没有什么问题。

[为什么从 SQL Server 2000 升级到 2005 会导致查询速度变慢？](https://stackoverflow.com/questions/489137/why-would-upgrading-from-sql-server-2000-to-2005-result-in-slower-queries)

[http://www.google.co.uk/url?sa=t&source=web&ct=res&cd=4&url=http%3A%2F%2Fwww.eggheadcafe.com%2Fforumarchives%2FSQLServersetup%2FFeb2006%2Fpost26068566.asp&ei=76XNSpHWJ5bWmQPDwdSMAw&usg=AFQjCNGY15FipRCEhTA&sPq2comVy15FipRCEzPq2comVs= UN5mcW6T7es0D_UUCcuizQ](http://www.google.co.uk/url?sa=t&source=web&ct=res&cd=4&url=http%3A%2F%2Fwww.eggheadcafe.com%2Fforumarchives%2FSQLServersetup%2FFeb2006%2Fpost26068566.asp&ei=76XNSpHWJ5bWmQPDwdSMAw&usg=AFQjCNGY15FipRCEzPq2OVcomXqys08hTA&sig2=UN5mcW6T7es0D_UUCcuizQ)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-05T12:07:22.080

不是我的经验。

如果您想提高数据库性能，我倾向于以**更多 RAM**和**更快磁盘**的形式投入更多硬件。

# design-patterns - 实施 SOLID 原则的模式

> ID：412914
> 
> 赞同：7
> 
> 时间：2009-01-05T12:01:04.853
> 
> 标签：design-patterns, solid-principles

我正在介绍 SOLID 设计原则，并尝试将单一职责原则和开闭原则与设计模式联系起来。

目前我有

*   **SRP：**代理，外观
*   **OCP：**战略、指挥

还有其他我应该包括的基本模式吗？

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2009-01-05T12:19:10.260

SOLID 原则是一个好的 OO 语言和框架的更多属性，而不是其他任何东西。它们不能轻易地转化为设计模式。相反，它们会影响设计模式中的好与坏。

通常，**所有**SOLID 原则都出现在每个设计模式的某个地方。如果所有 SOLID 原则都没有出现，那么您有办法改进设计模式。

单一职责实际上是封装加上继承和多态的某些方面。单一职责更多的是关于如何将问题分解为协作对象并定义这些对象的类的基本原则或原则。所有的设计模式都应该说明这一点。

同样，Open/Closed 是一种语言特性，通常通过继承来实现。但它可以通过猴子补丁来完成。所有的设计模式都应该说明这一点。

Liskov Substitution 通常也是一种语言特性。我们经常使用设计良好的多态类来实现这一点。有些人认为鸭式打字打破了这个原则，其他人说鸭式打字体现了它。有许多设计模式依赖于 Liskov Substitution。任何具有多态性的东西都会表现出里氏替换。

界面隔离可以是一种语言特性。Java 有它。Python——大多数人认为——不这样做。但是，您会注意到许多 Python 项目尝试使用超类和单元测试来形式化它们的接口定义。

依赖倒置（依赖于抽象）通常是一种语言特性。没有多少设计模式坚持这一点。然而，我们中的许多人喜欢使用 Java Collections 库中的抽象，以便我们可以在具体类中使用 Liskov Substitution。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-05T12:25:26.893

我已经完成了相同的演示，并挑选了一些设计模式来展示它们如何应用这些原则。

我注意到，对于 LSP，除了 GOF 的两种设计模式外，其他所有设计模式都使用了替换。

# haskell - Haskell 尾递归如何工作？

> ID：412919
> 
> 赞同：48
> 
> 时间：2009-01-05T12:04:37.047
> 
> 标签：haskell, tail-recursion

我写了这段代码，我假设`len`它是尾递归的，但仍然会发生堆栈溢出。怎么了？

```
myLength :: [a] -> Integer

myLength xs = len xs 0
    where len [] l = l
          len (x:xs) l = len xs (l+1)

main = print $ myLength [1..10000000] 
```

* * *

## 回答 #1

> 赞同：40
> 
> 时间：2009-01-05T12:39:14.463

请记住，Haskell 是懒惰的。在绝对必要之前，您的计算 (l+1) 不会发生。

“简单”的解决方法是使用“$！” 强制评估：

```
myLength :: [a] -> Integer
myLength xs = len xs 0
where len [] l = l
      len (x:xs) l = len xs $! (l+1)

      main = print $ myLength [1..10000000] 
```

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2009-01-05T12:34:46.377

似乎懒惰会导致`len`构建 thunk：

```
len [1..100000] 0
-> len [2..100000] (0+1)
-> len [3..100000] (0+1+1) 
```

等等。您必须每次强制`len`减少：`l`

```
len (x:xs) l = l `seq` len xs (l+1) 
```

有关更多信息，请查看[http://haskell.org/haskellwiki/Stack_overflow](http://haskell.org/haskellwiki/Stack_overflow)。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-01-13T22:53:56.723

foldl 也有同样的问题；它建立了一个thunk。您可以使用 Data.List 中的 foldl' 来避免该问题：

```
import Data.List
myLength = foldl' (const.succ) 0 
```

foldl 和 foldl' 唯一的区别是严格的累加，所以 foldl' 解决问题的方式与 seq 和 $! 上面的例子。(const.succ) 这里的工作方式与 (\ab -> a+1) 相同，但 succ 的类型限制较少。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2011-01-15T14:37:39.687

解决问题的最简单方法是开启优化。

我在一个名为 tail.hs 的文件中有你的源代码。

```
jmg$ ghc --make tail.hs -fforce-recomp
[1 of 1] 编译 Main (tail.hs, tail.o)
连接尾...
jmg$ ./尾
堆栈空间溢出：当前大小 8388608 字节。
使用`+RTS -Ksize -RTS'来增加它。
girard:haskell jmg$ ghc -O --make tail.hs -fforce-recomp
[1 of 1] 编译 Main (tail.hs, tail.o)
连接尾...
jmg$ ./尾
10000000
jmg$

```

@Hynek -Pichi- Vychodil 上面的测试是在 Mac OS X Snow Leopard 64bit 上完成的，带有 GHC 7 和 GHC 6.12.1，每个都是 32 位版本。在你投反对票后，我在 Ubuntu Linux 上重复了这个实验，结果如下：

```
jmg@girard:/tmp$ cat length.hs
myLength :: [a] -> 整数

我的长度 xs = 长度 xs 0
    其中 len [] l = l
          长度 (x:xs) l = 长度 xs (l+1)

主 = 打印 $ myLength [1..10000000]

jmg@girard:/tmp$ ghc --version
Glorious Glasgow Haskell 编译系统，版本 6.12.1
jmg@girard:/tmp$ uname -a
Linux girard 2.6.35-24-generic #42-Ubuntu SMP Thu Dec 2 02:41:37 UTC 2010 x86_64 GNU/Linux
jmg@girard:/tmp$ ghc --make length.hs -fforce-recomp
[1 of 1] 编译 Main (length.hs, length.o)
连接长度...
jmg@girard:/tmp$ 时间 ./length
堆栈空间溢出：当前大小 8388608 字节。
使用`+RTS -Ksize -RTS'来增加它。

真实0m1.359s
用户 0m1.140s
系统 0m0.210s
jmg@girard:/tmp$ ghc -O --make length.hs -fforce-recomp
[1 of 1] 编译 Main (length.hs, length.o)
连接长度...
jmg@girard:/tmp$ 时间 ./length
10000000

实际0m0.268s
用户 0m0.260s
系统 0m0.000s
jmg@girard:/tmp$

```

因此，如果您有兴趣，我们可以继续找出原因，这对您来说失败了。我猜，GHC HQ 会接受它作为一个错误，如果在这种情况下没有将这种对列表的直接递归优化为一个有效的循环。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-01-06T00:22:21.813

正如你所知道的，有一个更简单的方法来编写这个函数：

`myLength xs = foldl step 0 xs where step acc x = acc + 1`

亚历克斯

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-02-26T00:28:58.860

eelco.lempsink.nl 回答了您提出的问题。这是Yann答案的演示：

```
module Main
    where

import Data.List
import System.Environment (getArgs)

main = do
  n <- getArgs >>= readIO.head
  putStrLn $ "Length of an array from 1 to " ++ show n
               ++ ": " ++ show (myLength [1..n])

myLength :: [a] -> Int
myLength = foldl' (const . succ) 0 
```

foldl' 每次将 1 添加到从 0 开始的累加器时，都会从左到右遍历列表。

下面是一个运行程序的例子：

* * *

```
C:\haskell>ghc --make Test.hs -O2 -fforce-recomp
[1 of 1] Compiling Main             ( Test.hs, Test.o )
Linking Test.exe ...

C:\haskell>Test.exe 10000000 +RTS -sstderr
Test.exe 10000000 +RTS -sstderr

Length of an array from 1 to 10000000: 10000000
     401,572,536 bytes allocated in the heap
          18,048 bytes copied during GC
           2,352 bytes maximum residency (1 sample(s))
          13,764 bytes maximum slop
               1 MB total memory in use (0 MB lost due to fragmentation)

  Generation 0:   765 collections,     0 parallel,  0.00s,  0.00s elapsed
  Generation 1:     1 collections,     0 parallel,  0.00s,  0.00s elapsed

  INIT  time    0.00s  (  0.00s elapsed)
  MUT   time    0.27s  (  0.28s elapsed)
  GC    time    0.00s  (  0.00s elapsed)
  EXIT  time    0.00s  (  0.00s elapsed)
  Total time    0.27s  (  0.28s elapsed)

  %GC time       0.0%  (0.7% elapsed)

  Alloc rate    1,514,219,539 bytes per MUT second

  Productivity 100.0% of total user, 93.7% of total elapsed

C:\haskell> 
```

# excel - Excel VBA：使用哪个 OLE/OCX 控件在表单中显示图表？

> ID：412920
> 
> 赞同：5
> 
> 时间：2009-01-05T12:06:02.363
> 
> 标签：excel, vba, activex, charts, ocx

我必须在 VBA 的用户表单中显示柱形图。将图表导出为 GIF 并在图片框中导入；但我不能使用它，因为图表需要根据用户从同一表单中选择的选项进行修改。我一直在搜索，人们评论说可以使用 MS 提供的默认 OLE/OCX 控件。我找不到可以解决问题的 ActiveX。有人知道要使用哪些控件以及如何使用它们吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-06T06:02:47.773

只需使用 Microsoft Chart，它与 Microsoft Excel 是相同的引擎。

假设您使用的是 Excel 2003 ...该控件称为“Microsoft Office Chart 11.0”

如果您有 Excel 2007，Microsoft 没有提供图表控件。但您仍然可以[下载 Microsoft Office Chart 11.0](http://www.microsoft.com/downloads/details.aspx?FamilyId=7287252C-402E-4F72-97A5-E0FD290D4B76&displaylang=en)。它位于一个名为 OWC11.EXE 的文件中。

然后，在 VBA 编辑器中，当您的 VBA 用户窗体显示时，右键单击工具箱并选择“附加控件”，然后从出现的列表中选中“Microsoft Office Chart 11.0”。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-05T15:58:24.640

如果您只需要 2D 图形，您可能想试试这个：

[二维图形控制](http://www.codeproject.com/KB/miscctrl/ntgraph_activex.aspx)

[3D图形控制](http://www.codeproject.com/KB/openGL/ntgraph3d_atl.aspx)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-03-12T14:03:49.373

作为 Gigasoft 的所有者，请在您的研究中包含[Gigasoft 的 Charting ActiveXs](http://www.gigasoft.com/excelchartactivex.html)。以上链接指向完整的 Excel 2013 演练。或查看[Access 2013 图表 ActiveX 演练](http://www.gigasoft.com/accesschartactivex.html)以在 Access 中使用。

电子表格...

![Excel中的activeX图表](https://i.stack.imgur.com/PxT9S.png)

使用权.. ![在此处输入图像描述](https://i.stack.imgur.com/xuJvb.png)

# haskell - 单子的创造性使用

> ID：412929
> 
> 赞同：52
> 
> 时间：2009-01-05T12:10:13.633
> 
> 标签：haskell, monads

我正在寻找 monad 的创造性用途来学习。我在某处读过单子已在 AI 中使用，但作为单子新手，我看不到如何使用。

请包含指向源代码和示例用法的链接。请不要[使用标准单子](https://web.archive.org/web/20100928141543/http://www.haskell.org/all_about_monads/html/introII.html)。

* * *

## 回答 #1

> 赞同：30
> 
> 时间：2009-01-09T06:02:26.527

Phil Wadler 写[了很多关于 monads 的论文](http://homepages.inf.ed.ac.uk/wadler/topics/monads.html)，但首先阅读的那篇很有趣，任何程序员都可以阅读；它被称为[函数式编程的精髓](http://homepages.inf.ed.ac.uk/wadler/papers/essence/essence.ps)。本文包括源代码和示例用法。

我个人最喜欢的是[概率单子](http://www.cs.tufts.edu/~nr/pubs/pmonad-abstract.html)；如果你能找到[Sungwoo Park](http://www.postech.ac.kr/~gla/)的博士论文，它有许多来自机器人技术的有趣示例代码。

* * *

## 回答 #2

> 赞同：17
> 
> 时间：2009-01-07T18:03:30.050

还有[LogicT](http://okmij.org/ftp/Computation/monads.html#LogicT)（具有公平操作和修剪的回溯单子变换器）。

它对 AI 搜索算法具有很好的价值，因为它具有公平分离的构造，例如，可以轻松地使无限次成功的计算能够被组合（*交错*）。

它的用法在 ICFP'05 论文[Backtracking, Interleaving, and Terminating Monad Transformers中描述](http://okmij.org/ftp/papers/LogicT.pdf)

* * *

## 回答 #3

> 赞同：13
> 
> 时间：2009-01-05T12:25:50.433

您可以在博客[A Neighborhood of Infinity](http://sigfpe.blogspot.com)中找到有趣且高级的 monad 。我可以注意到[Vector Space Monad](http://sigfpe.blogspot.com/2007/03/monads-vector-spaces-and-quantum.html)，以及它用于[理性缠结](http://sigfpe.blogspot.com/2008/08/untangling-with-continued-fractions.html)描述的用途。不幸的是，我认为我理解得不够好，无法在这里解释。

* * *

## 回答 #4

> 赞同：10
> 
> 时间：2009-01-06T02:04:07.787

我最喜欢的单子之一是[Martin Escardo 的搜索单子](http://math.andrej.com/2008/11/21/a-haskell-monad-for-infinite-search-in-finite-time/)。它可以在[package](http://hackage.haskell.org/cgi-bin/hackage-scripts/package/infinite-search)[中的 hackage 上`infinite-search`](http://hackage.haskell.org/cgi-bin/hackage-scripts/package/infinite-search)找到。

它是一组类型元素的“搜索函数”的单子`a`，即`(a -> Bool) -> Maybe a` （在集合中找到与给定谓词匹配的元素）。

* * *

## 回答 #5

> 赞同：8
> 
> 时间：2009-05-16T11:23:13.513

[Harpy](http://hackage.haskell.org/cgi-bin/hackage-scripts/package/harpy)是一个用于运行时生成 x86 机器代码的包，它使用[代码生成单子](http://hackage.haskell.org/packages/archive/harpy/0.4.1/doc/html/Harpy-CodeGenMonad.html)。从描述：

> 这是一个组合的 reader-state-exception monad，它处理处理代码缓冲区、发出二进制数据、重定位等的所有细节。
> 
> 模块 Harpy.X86CodeGen 中的所有代码生成函数都存在于这个 monad 中，并使用它的错误报告工具以及由 monad 维护的内部状态。
> 
> 库用户可以通过 monad 传递用户环境和用户状态。此状态独立于内部状态，并且可以被更高级别的代码生成库用来在代码生成操作中维护它们自己的状态。

我发现这是一个特别有趣的例子，因为我认为这种模式并不少见：我自己发明了一些非常相似的东西，用于根据从（股票）市场数据馈送中收到的消息为我的应用程序生成一组内部消息。事实证明，让框架跟踪各种“全局”事物，同时编写本身不保持状态的简单操作，这是一种非常舒适的方式。

我更进一步他的想法是拥有一个也可以通过 monad 传递的用户状态（我称之为“子状态”）：我有一种在 monad 运行期间切换和恢复状态的机制：

```
-- | Given a generator that uses different substate type, convert it
-- to a generator that runs with our substate type. As well as the
-- other-substate-type generator, the caller must provide an initial
-- substate for that generator and a function taking the final substate
-- of the generator and producing a new substate of our type. This
-- preserves all other (non-substate) parts of the master state touched
-- by the generator.
--
mgConvertSubstate :: MsgGen msg st' a -> st' -> (st' -> st) -> MsgGen msg st a 
```

这用于在短时间内需要自己的状态的组合子子组。它们仅以它们的状态运行，对调用它的生成器的状态一无所知（这有助于使事情更加模块化），但这保留了任何非用户特定的状态，例如生成的当前消息列表和当前的一组警告或错误，以及控制流（即，允许总中止向上流动）。

* * *

## 回答 #6

> 赞同：8
> 
> 时间：2009-01-05T12:39:28.003

monad 的一个有趣用途是解析。[Parsec](http://legacy.cs.uu.nl/daan/parsec.html)是标准示例。

* * *

## 回答 #7

> 赞同：8
> 
> 时间：2009-01-05T13:31:57.057

在此处阅读有关用于对概率和概率过程进行建模的 monad 的系列文章：[http](http://www.randomhacks.net/articles/2007/03/03/smart-classification-with-haskell) ://www.randomhacks.net/articles/2007/03/03/smart-classification-with-haskell （点击上一页/下一页的链接）

* * *

## 回答 #8

> 赞同：6
> 
> 时间：2014-05-27T08:54:41.147

我想列出其他答案中尚未提及的几个单子。

## 枚举和加权搜索单子

[`Omega`monad](http://hackage.haskell.org/package/control-monad-omega/docs/Control-Monad-Omega.html)可用于高效地遍历无限的结果列表[。](http://hackage.haskell.org/package/control-monad-omega/docs/Control-Monad-Omega.html)相比：

```
>>> take 10 $ liftM2 (,) [0..] [0..]
[(0,0),(0,1),(0,2),(0,3),(0,4),(0,5),(0,6),(0,7),(0,8),(0,9)]

>>> take 10 $ runOmega $ liftM2 (,) (each' [0..]) (each' [0..])
[(0,0),(0,1),(1,0),(0,2),(1,1),(2,0),(0,3),(1,2),(2,1),(3,0)] 
```

使用更高级的[`WeightedSearch`monad](http://hackage.haskell.org/package/weighted-search/docs/Control-Monad-WeightedSearch.html)，还可以为计算分配权重，以便具有较低权重的计算结果首先出现在输出中。

## 累积错误单子

有用的[`These`数据类型](http://hackage.haskell.org/package/these/docs/Data-These.html)形成`Monad`类似于`Either`，但能够累积错误。该包还定义了[`MonadChronicle`类](http://hackage.haskell.org/package/these/docs/Control-Monad-Chronicle-Class.html)以及[`ChronicleT`基于](http://hackage.haskell.org/package/these/docs/Control-Monad-Chronicle.html#t%3aChronicleT).`These`

# linq - asp.net 中的高性能产品目录？

> ID：412933
> 
> 赞同：1
> 
> 时间：2009-01-05T12:13:41.020
> 
> 标签：linq, ado.net, e-commerce, product, catalog

我正在 asp.net 中计划一个高性能电子商务项目，需要帮助来选择产品目录的最佳数据检索模型。

一些细节，

*   10-20类产品
*   每个类别 1000-5000 种产品
*   列出产品名称、价格、品牌和形象，每页 15-40
*   产品需要在没有表格标签的情况下列出
*   将连接在一起的 2-4 个表中的产品信息（产品图像未存储在数据库中）
*   不同硬件上的 webserver 和 sql 数据库
*   共享数据库服务器上的 ms sql 2005（开始时性能相当糟糕......）
*   使用户能够结合不同的标准搜索产品，例如价格范围、品牌、有/无图像。

我的问题是，

*   我应该使用什么技术来检索产品？
*   我应该使用什么技术来展示产品？
*   你推荐什么缓存策略？
*   如何以最有效的方式解决过滤、排序、分页？
*   你对这个主题有更多的阅读建议吗？

提前致谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-01-06T22:52:55.973

确保您的数据库设计尽可能标准化 - 在必要时使用查找表以确保您不会不必要地重复数据。

将图像存储在服务器文件系统上，并在数据库中存储对它们的相对（非完整）路径引用。

尽可能多地使用存储过程，并始终从服务器中检索尽可能少的数据，以帮助提高内存和网络流量效率。

不要为缓存而烦恼，您的数据库应该足够快以立即产生结果，如果没有，则使其更快。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-05T14:57:41.393

Let the SQL server retrive the data. With fairly good indexing the SQL server should be able to cope.

in SQL 2005 you can do [paging in results](http://oassaf.wordpress.com/2006/11/20/paging-records-using-sql-2005-row_number-function/), that way you have less data to shuffle back and forth.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-05T15:24:19.390

I think you will end up with a lot of text searching. Give a try for either lucene or Solr ( http server on top of lucene). CNET developed solr for their product catalog search.

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-05T16:00:49.270

您是否考虑过查看允许您购买源代码的现有购物车平台？

我用过[www.aspdotnetstorefront.com](http://www.aspdotnetstorefront.com)

他们有很多在这个平台上运行的主要电子商务商店的例子。我在这个平台上建立[了 www.ElegantAppliance.com 。](http://www.ElegantAppliance.com)数千种产品，100多个类别/子类别。

# windows-xp - 有没有办法禁用 USB 闪存驱动器的格式化？

> ID：412939
> 
> 赞同：2
> 
> 时间：2009-01-05T12:16:37.333
> 
> 标签：windows-xp, usb-drive, group-policy, data-protection

是否可以编写任何脚本或设置（自动运行文件？）来**禁用 USB 闪存驱动器的格式化？** *（Win XP，通过 Windows 资源管理器 > 格式）*

我知道[write-protection](http://www.sizzledcore.com/2008/07/19/how-to-write-protect-your-usb-flash-drive/)，但我不想完全阻止修改文件，而是像[组策略设置](http://www.experts-exchange.com/Microsoft/Windows_Security/Q_22533362.html)可以做什么？

**编辑：**我真正要求的是**注册表设置**，否则我可以在 USB 驱动器启动时修改它以告诉 Win XP 不要格式化驱动器 X：

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-05T12:51:27.200

将这些东西格式化为 NTFS。那应该给你足够的安全性。您需要该卷的管理员权限才能重新格式化 USB 记忆棒。根据定义，任何拥有这些权利的人都可以禁用您可以启用的任何保护。如果您允许Everyone在根目录及以下目录创建和修改文件，用户仍然可以根据需要写入文件。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-02T20:15:01.557

注册表项 'MACHINE\Software\Microsoft\Windows NT\CurrentVersion\Winlogon\AllocateDASD' 限制了外部驱动器的格式化和弹出（请参阅此[有用的 Microsoft 电子表格，其中包含组策略编辑器控制的注册表项](http://www.microsoft.com/en-us/download/details.aspx?id=25250)）。

将其设置为“管理员”或您可以信任的其他组，不会在不应该格式化的地方进行格式化。

# python - 保留百分比列表以加起来为 100% 的算法

> ID：412943
> 
> 赞同：6
> 
> 时间：2009-01-05T12:18:09.843
> 
> 标签：python, algorithm

（代码示例是 python）
让我们假设我们有一个加起来为 100 的百分比列表：

```
mylist = [2.0, 7.0, 12.0, 35.0, 21.0, 23.0] 
```

mylist 的某些值可能会更改，而其他值必须保持不变。
让我们假设前 3 个（2.0、7.0、12.0）必须保持固定，而后三个（35.0、21.0、23.0）可以更改。

```
fix = mylist[:3]
vari = mylist[3:] 
```

目标是向 mylist 添加一个新项目，而 sum(mylist) 保持 100.0 并且 vari
项目保持彼此之间的关系。为此，我们需要
从每个 vari 项中减去 CERTAIN PERCENTAGE。示例：假设我们要将 4.0 添加到 mylist。
使用丑陋的近似循环我发现我需要减去 ca. 每个变量项的5.0634%
（特定百分比 = 5.0634）：

```
adjusted =[]
for number in vari:
    adjusted.append(number-(number*(5.0634/100.0)))
adjusted.extend(fix)
adjusted.append(4.0) 
```

调整现在包含我想要的结果。

# 我的问题是如何计算某些百分比；。）

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-01-05T12:33:25.257

这个怎么样？

```
def adjustAppend( v, n ):
    weight= -n/sum(v)
    return [ i+i*weight for i in v ] + [n] 
```

给定一个数字列表*v*，追加一个新数字*n*。加权现有数字以保持总和相同。

```
 sum(v) == sum( v + [n] ) 
```

*v* , *i*的每个元素必须被*i* , *r* ( *i* ) 的某个函数约简，使得

```
sum(r(i)) == -n 
```

或者

```
sum( map( r, v ) ) == -n 
```

因此，权重函数为`-(n*i)/sum(v)`

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-05T12:29:19.117

你太傻了。

假设您想将 4.0 添加到列表中。你不需要从每一个中减去一定的数量。您需要做的是将每个项目相乘。

100 - 4 = 96。因此，将每个项目乘以 0.96

您想将 20.0 添加为项目。那么你将每个项目乘以 0.8，即 (100-20)*0.01

更新：嗯，我没有仔细阅读。

这样想。（固定）+（变异）= 100；(固定)+(vari * x) + newitem = 100;

所以基本上就像我们之前所做的一样，除了 vari 部分。如果 vari 总计为 50，并且您添加的新项目是 3.0，则将 vari 中的每个项目乘以 (47/50)

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-01-05T12:35:43.363

```
new_item = 4.0
CERTAIN_PERCENTAGE = 100 * (float(new_item) / sum(vari)) 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-05T12:34:44.490

```
NEW_NUMBER = 4.0

mylist = [2.0, 7.0, 12.0, 35.0, 21.0, 23.0]
fix = mylist[:3]
vari = mylist[3:]

weight = (100 - sum(fix) - NEW_NUMBER)/sum(vari)

adjusted = []
adjusted.extend( (weight*v for v in vari) )
adjusted.extend(fix)
adjusted.append(NEW_NUMBER)

print sum(adjusted)                # 100.0 
```

编辑：三联画是对的，如果你真的对*某个百分比*感兴趣，下面的代码就可以了：

```
certain_percentage = 100 * NEW_NUMBER / sum(vari)
print certain_percentage        # 5.06329113924 
```

我认为你的常数 5.0634 实际上应该是 5.0633。

# class - UML 类图枚举

> ID：412944
> 
> 赞同：167
> 
> 时间：2009-01-05T12:18:34.443
> 
> 标签：class, enums, uml, diagram

我正在建模一个类图。类的属性是枚举。我该如何建模？通常你会做这样的事情：

```
- name : string 
```

但是如何使用枚举来做到这一点？

* * *

## 回答 #1

> 赞同：242
> 
> 时间：2009-01-05T12:27:07.843

它们简单地显示如下：

```
_______________________
|   <<enumeration>>   |
|    DaysOfTheWeek    |
|_____________________|
| Sunday              |
| Monday              |
| Tuesday             |
| ...                 |
|_____________________| 
```

然后在它和你的班级之间建立联系。

* * *

## 回答 #2

> 赞同：81
> 
> 时间：2012-02-02T17:32:44.947

如果您的 UML 建模工具支持指定枚举，您应该使用它。它可能会更容易做，它会给你的模型更强的语义。从视觉上看，结果与带有 Stereotype 的类非常相似`<<enumeration>>`，但在 UML 元模型中，枚举实际上是一个单独的（元）类型。

```
+---------------------+
|   <<enumeration>>   |
|    DayOfTheWeek     |
|_____________________|
| Sunday              |
| Monday              |
| Tuesday             |
| ...                 |
+---------------------+ 
```

定义后，您可以将其用作属性的类型，就像您使用数据类型或您自己的类的名称一样。

```
+---------------------+
|        Event        |
|_____________________|
| day : DayOfTheWeek  |
| ...                 |
+---------------------+ 
```

如果您使用 ArgoEclipse 或 ArgoUML，工具栏上有一个下拉菜单，可以在 Datatype、Enumeration、Signal 等中进行选择，让您可以创建自己的 Enumerations。然后，可以使用 EnumerationLiterals 填充通常包含 Attributes 的隔离专区，以获取您的枚举值。

这是 ArgoUML 中一个稍微不同的示例的图片： ![在此处输入图像描述](https://i.stack.imgur.com/IsPOy.png)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-05T12:26:13.320

通常，您将枚举本身建模为具有构造`enum`型的类

# asp.net - 在会话中缓存数据库数据 - 获得正确的平衡

> ID：412946
> 
> 赞同：0
> 
> 时间：2009-01-05T12:19:01.867
> 
> 标签：asp.net, performance, optimization, session, caching

如果您在 ASP.NET 会话中缓存数据库中的数据，那么您将加快对该数据的后续请求（注意：取决于相关数据的序列化/反序列化成本），但会以 IIS 中的内存负载为代价。

（好的，这可能是对现实情况的简化 - 请随时更正或完善我上面的陈述）

您是否使用任何规则（简单的经验法则或其他规则）来决定何时适合在 Session 中缓存？

## 更新

在没有*经过深思熟虑的*情况下使用 Session**存储只读数据是否可以简单地被认为是**[过早优化](http://en.wikiquote.org/wiki/Donald_Knuth)的另一种情况？（因此，不好）

 ** * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-05T12:49:43.087

如果您使用 InProc 模式，请记住会话中的缓存，除非您的代码在会话为空时返回数据库，否则您会限制可伸缩性。您将被迫使用单个服务器或将您的用户固定到特定服务器。

如果您使用会话状态服务器，这不适用，并且如果您使用 SQL 存储会话状态，那么使用会话进行缓存是没有意义的。

# 编辑

有关此主题的任何建议都取决于您的特定环境。正如您所说，即使使用 SQL 会话状态，一个非常复杂的 sql 查询也可能会从缓存中受益。我认为最重要的是首先让您的应用程序执行功能并实现业务需求。然后返回并测试和优化应用程序以处理您期望的负载。

# 编辑 2

根据您的更新，不，我认为这不是真的。在我的一个 ASP.Net 应用程序中，我使用会话状态来存储用户正在操作和修改的复杂对象模型。我们正在使用 AJAX，因此当用户更新对象时，我们与服务器有很多简短的通信。将对象保持在会话中是为了方便。该对象执行大量自定义计算以生成不同的数据点，因此在服务器上执行此操作是理想的，而不是尝试在 servr 和 javascript 中复制代码。还保持它在会话中让我们非常容易地拥有撤消功能。

是的，我知道我们牺牲了可扩展性，但我欢迎我与老板坐下来解释我们遇到问题的那一天，因为我们有太多用户（我知道他也会这样做）。

所以我认为问题是你为什么在会话中存储数据是为了方便并在用户登录时提供对瞬态数据的访问？这与将其存储在那里进行缓存不同。使用缓存要记住的一件事是您将如何刷新缓存？你如何使它无效？我没有建立会话状态来处理这个问题。

# 编辑 3

回到它只读数据，用户特定，从数据库加载昂贵，继续在会话中缓存它。您可以编写代码，因此如果它不在会话中，那么您可以访问数据库。有一个不错的小助手类，它可以从你的网络应用程序中隐藏它，你甚至使用会话，你应该很好。如果您发现遇到问题，您只有一个地方可以更改它，那么将它隐藏在您的网络上的存储位置是一件好事。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-05T13:32:31.690

鉴于很难保证会话中的数据在合理的时间范围内被清除，我会非常谨慎地兑现除奇数以外的任何东西。当您扩大规模时，您将遇到内存问题或让您的所有用户遇到会话超时错误。请记住，与缓存对象会话不同，内存不足时不会被终止。

正如 Josh 所说，如果您使用多个服务器并且需要使用数据库或会话状态服务器，您的会话对象将需要是可序列化的。在这种情况下，序列化和反序列化的成本可能比优化良好的查询的成本更差。

# python - 如何使用动态名称实现属性（）（在python中）

> ID：412951
> 
> 赞同：9
> 
> 时间：2009-01-05T12:19:45.830
> 
> 标签：python, oop, parameters, properties

我正在为单个神经元编程模拟。因此我必须处理很多参数。现在的想法是我有两个类，一个用于 SingleParameter 和一个参数集合。我使用 property() 来轻松访问参数值并使代码更具可读性。这非常适合单参数，但我不知道如何为集合实现它，因为我想在单参数之后命名集合中的属性。这里有一个例子：

```
class SingleParameter(object):
  def __init__(self, name, default_value=0, unit='not specified'):
    self.name = name
    self.default_value = default_value
    self.unit = unit
    self.set(default_value)
  def get(self):
    return self._v
  def set(self, value):
    self._v = value
  v = property(fget=get, fset=set, doc='value of parameter')

par1 = SingleParameter(name='par1', default_value=10, unit='mV')
par2 = SingleParameter(name='par2', default_value=20, unit='mA')

# par1 and par2 I can access perfectly via 'p1.v = ...'
# or get its value with 'p1.v'

class Collection(object):
  def __init__(self):
    self.dict = {}
  def __getitem__(self, name):
    return self.dict[name] # get the whole object
    # to get the value instead:
    # return self.dict[name].v
  def add(self, parameter):
    self.dict[parameter.name] = parameter
    # now comes the part that I don't know how to implement with property():
    # It shoule be something like
    # self.__dict__[parameter.name] = property(...) ?

col = Collection()
col.add(par1)
col.add(par2)
col['par1'] # gives the whole object

# Now here is what I would like to get:
# col.par1 -> should result like col['par1'].v
# col.par1 = 5 -> should result like col['par1'].v = 5 
```

* * *

我为理解 property() 而提出的其他问题：

*   [为什么托管属性只适用于类属性而不适用于 python 中的实例属性？](https://stackoverflow.com/questions/428264 "为什么托管属性只适用于类属性而不适用于 python 中的实例属性？")
*   [如何在 python 中通过 __dict__ 分配新的类属性？](https://stackoverflow.com/questions/432786/ "使用 setattr() 设置类属性")

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-01-05T12:42:31.417

查看内置函数`getattr`和`setattr`. 你可能会快乐很多。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-01-13T16:33:49.457

对两个类使用相同的 get/set 函数会迫使您对参数列表进行丑陋的破解。非常粗略，这就是我的做法：

在 SingleParameter 类中，像往常一样定义 get 和 set：

```
def get(self):
  return self._s
def set(self, value):
  self._s = value 
```

在 Collection 类中，在创建属性之前您无法知道信息，因此您定义了 metaset/metaget 函数并稍后使用 lambda 函数来具体化它们：

```
def metaget(self, par):
  return par.s
def metaset(self, value, par):
  par.s = value
def add(self, par):
  self[par.name] = par
  setattr(Collection, par.name,
    property(
      fget=lambda x : Collection.metaget(x, par),
      fset=lambda x, y : Collection.metaset(x,y, par)) 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-01-05T12:48:29.093

属性旨在动态评估属性或使它们成为只读的。您需要的是自定义属性访问。`__getattr__`并且`__setattr__`做得很好，还有`__getattribute__`如果`__getattr__`还不够。

有关详细信息，请参阅[有关自定义属性访问](http://docs.python.org/reference/datamodel.html#customizing-attribute-access)的 Python 文档。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-01-05T13:56:58.800

你看过[特质包](http://code.enthought.com/projects/traits/)吗？您似乎正在使用参数类重新发明轮子。特征还具有可能对您的应用程序类型有用的附加功能（顺便说一下，我认识一个人乐于在神经模拟中使用特征）。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-01-05T14:10:26.700

现在我用 set-/getattr 实现了一个解决方案：

```
class Collection(object):
...
  def __setattr__(self, name, value):
    if 'dict' in self.__dict__:
      if name in self.dict:
        self[name].v = value
    else:
      self.__dict__[name] = value
  def __getattr__(self, name):
    return self[name].v 
```

有一件事我非常不喜欢：属性不在 __dict__ 中。如果我也有它们，我将拥有该值的副本-这可能很危险...

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-13T14:01:20.310

最后，我成功地用 property() 实现了这些类。非常感谢您的建议。我花了很多时间来解决这个问题——但我可以向你保证，这个练习可以帮助你更好地理解 pythons OOP。

我也用 __getattr__ 和 __setattr__ 实现了它，但仍然不知道属性解决方案的优缺点。但这似乎值得另一个问题。财产解决方案似乎很干净。

所以这里是代码：

```
class SingleParameter(object):
  def __init__(self, name, default_value=0, unit='not specified'):
    self.name = name
    self.default_value = default_value
    self.unit = unit
    self.set(default_value)
  def get(*args):
    self = args[0]
    print "get(): "
    print args
    return self._v
  def set(*args):
    print "set(): "
    print args
    self = args[0]
    value = args[-1]
    self._v = value
  v = property(fget=get, fset=set, doc='value of parameter')

class Collection(dict):
  # inheriting from dict saves the methods: __getitem__ and __init__
  def add(self, par):
    self[par.name] = par
    # Now here comes the tricky part.
    # (Note: this property call the get() and set() methods with one
    # more argument than the property of SingleParameter)
    setattr(Collection, par.name,
      property(fget=par.get, fset=par.set))

# Applying the classes:
par1 = SingleParameter(name='par1', default_value=10, unit='mV')
par2 = SingleParameter(name='par2', default_value=20, unit='mA')
col = Collection()
col.add(par1)
col.add(par2)
# Setting parameter values:
par1.v = 13
col.par1 = 14
# Getting parameter values:
par1.v
col.par1
# checking identity:
par1.v is col.par1
# to access the whole object:
col['par1'] 
```

由于我是新手，我不确定如何继续：如何处理后续问题（就像这样本身）：

*   get() 似乎被调用了两次 - 为什么？
*   oop-design: property vs. "__getattr__ & __setattr__" - 我什么时候应该使用什么？
*   检查自己对自己问题的回答是否被*接受*是不礼貌的吗？
*   是否建议重命名标题，以便将相关问题或用相同示例阐述的问题放在相同的上下文中？

我为理解 property() 而提出的其他问题：

*   [为什么托管属性只适用于类属性而不适用于 python 中的实例属性？](https://stackoverflow.com/questions/428264 "为什么托管属性只适用于类属性而不适用于 python 中的实例属性？")
*   [如何在 python 中通过 __dict__ 分配新的类属性？](https://stackoverflow.com/questions/432786/ "使用 setattr() 设置类属性")

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2013-03-21T18:57:09.240

我有一个执行类似操作的类，但我在集合对象中执行了以下操作：

setattr（自我，par.name，par.v）

# c++ - 将二进制数据转换为可打印的十六进制

> ID：412954
> 
> 赞同：1
> 
> 时间：2009-01-05T12:22:27.477
> 
> 标签：c++, templates, stl

在[这个](https://stackoverflow.com/questions/381267/looped-pushback-against-resize-iterator)线程中，有人评论说以下代码只能在“玩具”项目中使用。不幸的是，他没有回来说明为什么它不符合生产质量，所以我希望社区中的某个人能够向我保证代码是好的（因为我非常喜欢它）或者找出问题所在。

```
template< class T1, class T2>
void hexascii( T1& out, const T2& in )
{
    out.resize( in.size() * 2 );
    const char hexDigits[] = {'0', '1', '2', '3', '4', '5', '6', '7','8', '9', 'A', 'B', 'C', 'D', 'E', 'F'};
    T1::iterator outit = out.begin();
    for( T2::const_iterator it = in.begin(); it != in.end(); ++it )
    {
        *outit++ = hexDigits[*it >> 4];
        *outit++ = hexDigits[*it & 0xF];
    }
}

template<class T1, class T2>
void asciihex( T1& out, const T2& in )
{
    size_t size = in.size;
    assert( !(size % 2) );

    out.resize( size / 2 );
    T1::iterator outit = out.begin();
    for( T2::const_iterator it = in.begin(); it != in.end(); it += 2, ++outit )
    {
    *outit = ((( (*it > '9' ? *it - 0x07 : *it)  - 0x30) << 4) & 0x00f0) + 
                (((*(it+1) > '9' ? *(it+1) - 0x07 : *(it+1)) - 0x30) & 0x000f);
    }
} 
```

编辑：感谢您的帮助，您已经做出了一些重大改进。我已经根据您的答案以两种建议的样式编写了函数。一些粗略的测试表明，第二种方法比第一种方法略快，但 IMO 这被第一种方法提高的可读性所抵消。

```
template<class T1>
void asciihex2( T1& out, const std::string& in )
{
    dassert( sizeof(T1::value_type)==1 );
    size_t size = in.size();
assert( !(size % 2) );
    out.resize( size / 2 );
    T1::iterator outit = out.begin();
    for( size_t i = 0; i < in.size(); i += 2 )
    {
        int tmp;
        sscanf( in.c_str() + i, "%02X", &tmp );
        *outit++ = tmp;
    }
}

template<class T1>
void asciihex3( T1& out, const std::string& in )
{
    dassert( sizeof(T1::value_type)==1 );
    size_t size = in.size();
assert( !(size % 2) );
    out.resize( size / 2 );
    T1::iterator outit = out.begin();
const char hexDigits[] = {0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 
                          0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
                  0x0A, 0x0B, 0x0C, 0x0D, 0x0E, 0x0F};
for( std::string::const_iterator it = in.begin(); it != in.end(); it += 2, ++outit )
    {
    *outit = (hexDigits[(*it - 0x30) & 0x1f] << 4) + 
              hexDigits[((*(it+1) - 0x30) & 0x1f)];
    }
} 
```

围绕此代码的一些假设： 1：它们不是作为通用的，而是在匿名名称空间中用于为特定类转换数据。2：需要模板，因为正在使用两种单独的容器类型（一种是 std::vector，另一种是来自第三方库的类似字节数组类型容器。3：目的是能够转换不确定的二进制数据长度转换为字符串并再次返回 (0x1234abcd <-> "1234abcd") 4：断言在调试和发布模式下都捕获错误 5：在调用这些函数时，字符串的大小已经检查过了，断言用于如果出现严重问题，则终止处理 6：需要一些评论

任何其他想法表示赞赏。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-01-05T12:32:19.423

**鉴于您在标准 C scanf**和**printf**函数中有直接的十六进制转换，似乎很多模板化代码实现的很少。何苦？

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-01-05T12:35:38.857

我对此的主要评论是它很难阅读。

尤其：

```
*outit = ((( (*it > '9' ? *it - 0x07 : *it)  - 0x30) << 4) & 0x00f0) + 
            (((*(it+1) > '9' ? *(it+1) - 0x07 : *(it+1)) - 0x30) & 0x000f) 
```

我的大脑需要一点时间才能理解这一点，如果我继承了代码，我会很恼火。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-01-05T12:41:07.940

它应该做什么？hexascii 或 asciihex 没有众所周知的公认含义，因此名称应该更改。

[编辑] 从二进制转换为十六进制表示法通常不应称为 ascii...，因为 ascii 是 7 位格式。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-01-05T12:39:09.627

我真的不反对。它是通用的（在限制范围内），它使用 consts，在需要的地方引用等等……它缺少一些文档，而且`asciihex` `*outit`乍一看，分配不是很清楚。

`resize`初始化不必要的输出元素（`reserve`改为使用）。

也许通用性有点太灵活了：你可以用你喜欢的任何数据类型来提供算法，而你应该只给它十六进制数字（而不是例如 a `vector`of `double`s）

事实上，考虑到好的库函数的存在，这可能[有点矫枉过正。](https://stackoverflow.com/questions/412954/whats-wrong-with-this-code#412975)

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-01-05T12:47:59.860

有什么问题

```
*outit = hexDigits[*it] 
```

为什么这两个函数不能共享一个公共的 hexDigits 列表并消除 ASCII 字符的复杂（和缓慢）计算？

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2009-01-05T14:05:50.623

*   代码有断言语句，而不是正确处理错误条件（如果您的断言关闭，代码可能会崩溃）

*   for 循环具有危险的迭代器双倍增加 (it+=2)。特别是在您的断言没有触发的情况下。当您的迭代器已经结束并且您 ++ 它时会发生什么？

*   代码是模板化的，但您所做的只是将字符转换为数字或反之。这是[货物崇拜编程](http://en.wikipedia.org/wiki/Cargo_cult_programming)。您希望模板编程的祝福会通过使用模板降临到您身上。您甚至将其标记为模板问题，尽管模板方面与您的函数完全无关。

*   *outit= 行太复杂了。

*   代码重新发明了轮子。在很大程度上。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-01-05T12:47:38.863

我看到的一些问题：

如果它仅用于存储 8 位类型的输入容器 - 例如 char 或 unsigned char，这将非常有用。例如，如果与右移后的值大于 15 的 32 位类型一起使用以下代码将失败 - 建议您始终使用掩码以确保查找索引始终在范围内。

```
*outit++ = hexDigits[*it >> 4]; 
```

如果您传入一个包含无符号长整数的容器，那么预期的行为是什么——对于这是一个泛型类，它可能也应该能够处理将 32 位数字转换为十六进制字符串。

这仅在输入是容器时有效 - 如果我只想转换单个字节怎么办？这里的一个建议是将代码重构为一个可以转换单个字节的核心函数（hex=>ascii 和 ascii=>hex），然后提供额外的函数来使用这个核心函数来转换字节容器等。

在 asciihex() 中，如果输入容器的大小不能被 2 整除，就会发生不好的事情。使用：

```
it != in.end(); it += 2 
```

这是危险的，因为如果容器大小不能被 2 整除，那么增量为 2 将使迭代器前进到容器的末尾，并且与 end() 的比较将永远不会起作用。这通过 assert 调用在一定程度上受到保护，但 assert 可以编译出来（例如，它通常在发布版本中编译出来），因此最好将其设为 if 语句。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-01-05T16:07:52.047

我发现的问题：

hexascii 不检查是否`sizeof(T2::value_type)==1`

hexascii 取消引用`it`两次，asciihex 更多。没有理由这样做，因为您可以存储结果。这意味着您不能使用 istream_iterator。

asciihex 需要一个随机迭代器作为输入，因为使用了 (it+1) 和 (it+=2)。如果您只使用 (++it)，该算法可以在前向迭代器上工作。

`(*it > '9' ? *it - 0x07 : *it) - 0x30`可以简化为，`*it - (*it > '9' ? 0x37 : 0x30)`因此只剩下一个无条件减法。不过，数组查找会更有效。减去 0x30。“0”将变为 0；“A”将变为 0x11，“a”将变为 0x31。使用 0x1f 进行掩码以使其不区分大小写，并且您可以在 char[0x20] 中进行结果查找，而不会出现溢出风险。非十六进制字符只会给你奇怪的值。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-01-05T16:03:56.453

我认为它是玩具代码的原因是没有错误检查。

我可以将两个向量传递给它，它会很高兴地尝试做一些事情并把它弄得一团糟，产生随机的乱码。

# dns - BIND DNS服务器的配置，我迷路了

> ID：412960
> 
> 赞同：1
> 
> 时间：2009-01-05T12:25:35.257
> 
> 标签：dns, sysadmin, bind

我希望您能原谅我认为配置 DNS 服务器很容易。事实证明这很难……尤其是如果您以前从未这样做过。

回顾一下，我之前问过是否有人可以推荐一个用于 Windows XP 的个人 DNS 服务器以用于开发项目。

我的基本愿望是托管一个代表以下查找表的 DNS 服务器：

```
 Address          | IP
------------------+--------------
 *.devdomain1.dev | 192.168.10.2
 *.devdomain2.dev | 192.168.10.2 
```

你知道如何在 BIND 9 中进行设置吗？或者也许有一个我忽略的更简单的解决方案。我知道我可以在我的 HOSTS 文件中添加各个子域，但由于我们有很多子域必须在几台开发机器上维护，我宁愿有一个简单的通配符设置。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-05T12:31:16.103

像这样的区域文件就足够了（在我的系统上，这将在 /etc/bind/zones/devdomain2.dev.hosts 中）

```
devdomain2.dev. IN SOA localhost. johannesh.devdomain2.dev. (
        1102522753
        10800
        3600
        604800
        38400
)

devdomain2.dev.    IN      NS     localhost.
*.devdomain2.dev.   IN      A      192.168.10.2 
```

然后我的 /etc/bind/named.conf.local 将引用它如下

```
zone "devdomain2.dev" {
        type master;
        file "/etc/bind/zones/devdomain2.dev.hosts";
}; 
```

（请注意，您可以完全调整这个通配符 .dev 域，或者为 devdomain1 设置另一个区域）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-05T12:33:01.513

你走了多远？

您可以为 .dev 创建一个区域并使用[通配符记录](http://en.wikipedia.org/wiki/Wildcard_DNS_record)

# php - 邮件正文解析 - 开源邮件客户端（PHP 或 ASP.NET）

> ID：412965
> 
> 赞同：0
> 
> 时间：2009-01-05T12:28:42.003
> 
> 标签：php, asp.net, email

我有一个有趣的问题。

我必须解析邮件正文（正则表达式），从邮件正文中获取一些数据，将此数据放入邮件主题并将此邮件转发到另一个地址。这必须在收到邮件后立即完成。

是否有任何免费的 WEBMAIL 客户端允许编写自定义过滤器，或者我必须为这个简单的任务申请？

哪个是最好的开源邮件客户端（PHP 或 ASP.NET）？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-05T12:47:51.560

要在不进行轮询的情况下立即处理邮件，这应该集成到您的邮件传递过程中（MDA，邮件传递代理）。在大多数 Unix 机器上，这可以通过[procmail](http://www.procmail.org/)和[formail](http://www.stimpy.net/procmail/tutorial/formail.html)（procmail 的一部分）轻松完成。

如果您对邮件程序有更多的控制权，则可以进行更紧密的集成以获得更高的性能 || 更好的错误处理。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-05T12:54:59.673

我不知道任何免费邮件程序可以在其中运行如此高度自定义的过滤器。

请指定“开源邮件客户端”，因为您的问题并不需要网络邮件界面。

作为一种可能的解决方案，您可以编写一个小脚本，a）每 x 分钟收集一次邮件（cronjob），b）应用您的过滤器。这适用于很多免费的 php webhosters，还有一些免费的 cronjob-services（[第一次 google hit](http://www.onlinecronjobs.com/)）可以每 x 分钟调用一次你的脚本。

[Zend_Mail](http://framework.zend.com/manual/en/zend.mail.html)和[PHPMailer](http://sourceforge.net/projects/phpmailer)可能是不错的邮件库。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-05T14:14:35.363

我用这个来解析退回邮件

[http://pear.php.net/package/Mail_Mime](http://pear.php.net/package/Mail_Mime)

到目前为止的好结果。

编辑：

[http://www.xpertmailer.com/](http://www.xpertmailer.com/)也有一个非常好的 MIME 库，可以帮助您。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-05T14:06:03.867

看看[Bugtracker.net](http://ifdefined.com/bugtrackernet.html)，他们实现了一个 pop3 客户端，该客户端可以接收和处理传入的电子邮件（在他们的情况下存储为错误案例）来处理他们使用[SharpMime](http://anmar.eu.org/projects/sharpmimetools/)的邮件内容。

# asp.net - asp.net 模拟

> ID：412969
> 
> 赞同：1
> 
> 时间：2009-01-05T12:30:08.460
> 
> 标签：asp.net, security, impersonation

我正在编写一个与 Exchange 配合使用的 Web 应用程序，因此需要模拟一个对 Exchange 具有管理员权限的帐户。此帐户由用户在设置时指定。模拟使用此帐户的最佳方法是什么，显然将其硬编码到 web.config 中是行不通的，因为它需要能够更改，但我不确定最好的方法。另外，我实际上只需要以这个管理用户的身份运行 1 个类，是否可以只模拟某些方法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-05T14:11:21.440

我发布了关于使用模拟访问网络文件共享的答案，但它也应该适用于您。它包括 ac# 类的源代码，可用于管理模拟的开始/结束，并可被任何类或方法使用。

提供的源代码假定您将用户名和密码存储在 web.config 中。

有关更多详细信息，请参阅原始[问题和答案](https://stackoverflow.com/questions/401284/file-exists-returning-false-from-a-network-share#401325)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-05T12:43:02.257

我过去这样做的方法是使用 LogonUser。下面的链接提供了一些有关如何进行此操作的指导。

[http://blogs.msdn.com/shawnfa/archive/2005/03/21/400088.aspx](http://blogs.msdn.com/shawnfa/archive/2005/03/21/400088.aspx)

[http://www.guidanceshare.com/wiki/ASP.NET_2.0_Security_Guidelines_-_Impersonation/Delegation](http://www.guidanceshare.com/wiki/ASP.NET_2.0_Security_Guidelines_-_Impersonation/Delegation)

您可能还需要考虑是否可以使用 Exchange 模拟，并让您的应用程序在可以通过 Exchange Web 服务[在 Exchange 中模拟的固定身份下运行。](http://msdn.microsoft.com/en-us/library/bb204095.aspx)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-05T13:36:15.067

您可以按照上述方式进行操作，但在这种情况下，在设置过程中仅修改 web.config 有什么问题？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-07T00:42:37.843

除了其他人指出的 LogonUser 或 WindowsImpersonationContext 类之外，您还可以考虑分离出特权代码。例如，作为企业服务对象运行（在 COM+ 下运行）。这将允许您让操作系统管理凭据，而且您在特权代码周围有一个内置的信任边界。
当然，您需要对谁可以调用此对象实施限制，但这很容易配置......

# sharepoint - Sharepoint：是否有一些 OOB 方法可以删除配置文件？

> ID：412970
> 
> 赞同：3
> 
> 时间：2009-01-05T12:30:46.417
> 
> 标签：sharepoint

我正在使用 OOB 功能将文件上传到共享点。我正在使用`<module`包含所有数据的 > 标签和功能。（这里有[描述](http://msdn.microsoft.com/en-us/library/ms441170.aspx)）

这是我的 elements.xml 文件中的模块示例：

```
<Module Name="SampleImages" Url="Style Library/Images/SampleImages" Path="Images" RootWebOnly="TRUE">
    <File IgnoreIfAlreadyExists="TRUE" Name="example.jpg" Url ="example.jpg" Type="GhostableInLibrary" />
</Module> 
```

唯一的问题是，当我停用功能时，上传的文件不会被删除。目前我使用删除这些文件的功能接收器，因为我找不到任何其他解决方案。

那么我是否错过了什么，或者这是我摆脱以这种方式上传的文件的唯一方法？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-07T20:08:05.603

我相信你这样做的方式是唯一的方式。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-12T21:42:02.983

默认情况下，SharePoint 不会删除任何预配文件。如果要在停用时清理内容，则必须使用 FeatureReceiver 手动进行。

# ios - iPhone解压码

> ID：412982
> 
> 赞同：26
> 
> 时间：2009-01-05T12:34:56.220
> 
> 标签：ios, objective-c, zip, compression

真的坚持尝试编写代码来解压缩 iPhone 上的文件或目录。

下面是我用来尝试解压缩简单文本文件的一些示例代码。

它解压缩文件，但它已损坏。

```
(void)loadView {

    NSString *DOCUMENTS_FOLDER = [NSHomeDirectory() stringByAppendingPathComponent:@"Documents"];
    NSString *path = [DOCUMENTS_FOLDER stringByAppendingPathComponent:@"sample.zip"];

    NSString *unzipeddest = [DOCUMENTS_FOLDER stringByAppendingPathComponent:@"test.txt"];  

    gzFile file = gzopen([path UTF8String], "rb");

    FILE *dest = fopen([unzipeddest UTF8String], "w");

    unsigned char buffer[CHUNK];

    int uncompressedLength = gzread(file, buffer, CHUNK);

    if(fwrite(buffer, 1, uncompressedLength, dest) != uncompressedLength ||     ferror(dest)) {
        NSLog(@"error writing data");
    }
    else{

    }

    fclose(dest);
    gzclose(file);  
} 
```

* * *

## 回答 #1

> 赞同：41
> 
> 时间：2010-07-21T23:20:09.947

我想要一个简单的解决方案，但在这里找不到我喜欢的解决方案，所以我修改了一个库来做我想做的事。您可能会发现[SSZipArchive](https://github.com/ZipArchive/ZipArchive)很有用。（它也可以顺便创建 zip 文件。）

用法：

```
NSString *path = @"path_to_your_zip_file";
NSString *destination = @"path_to_the_folder_where_you_want_it_unzipped";
[SSZipArchive unzipFileAtPath:path toDestination:destination]; 
```

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2009-01-05T12:58:23.847

“sample.zip”真的是用 gZip 创建的吗？.zip 扩展名通常用于 WinZip 创建的档案。这些也可以使用 zLib 解压缩，但您必须解析标头并使用其他例程。

要检查，请查看文件的前两个字节。如果是“PK”，则为 WinZip，如果为 0x1F8B，则为 gZip。

因为这是 iPhone 特定的，请查看这个[iPhone SDK 论坛讨论](http://www.iphonedevsdk.com/forum/iphone-sdk-development/4492-using-zlib-unzip-archives.html)，其中提到了[miniZip](http://www.winimage.com/zLibDll/minizip.html)。看来这可以处理 WinZip 文件。

但如果它真的是一个 WinZip 文件，你应该看看[WinZip 规范](http://www.pkware.com/documents/casestudies/APPNOTE.TXT)并尝试自己解析文件。它基本上应该解析一些标头值，寻找压缩流的位置并使用 zLib 例程对其进行解压缩。

* * *

## 回答 #3

> 赞同：12
> 
> 时间：2009-08-16T12:35:23.810

这段代码对我来说适用于 gzip：

数据库是这样准备的：gzip foo.db

关键是在 gzread() 上循环。上面的例子只读取第一个 CHUNK 字节。

```
#import <zlib.h>
#define CHUNK 16384

  NSLog(@"testing unzip of database");
  start = [NSDate date];
  NSString *zippedDBPath = [[[NSBundle mainBundle] resourcePath] stringByAppendingPathComponent:@"foo.db.gz"];
  NSString *unzippedDBPath = [documentsDirectory stringByAppendingPathComponent:@"foo2.db"];
  gzFile file = gzopen([zippedDBPath UTF8String], "rb");
  FILE *dest = fopen([unzippedDBPath UTF8String], "w");
  unsigned char buffer[CHUNK];
  int uncompressedLength;
  while (uncompressedLength = gzread(file, buffer, CHUNK) ) {
    // got data out of our file
    if(fwrite(buffer, 1, uncompressedLength, dest) != uncompressedLength || ferror(dest)) {
      NSLog(@"error writing data");
    }
  }
  fclose(dest);
  gzclose(file);
  NSLog(@"Finished unzipping database"); 
```

顺便说一句，我可以在 77 秒内将 33MB 解压缩成 130MB，或者大约 1.7MB 未压缩/秒。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2011-05-20T11:35:44.750

此代码会将任何 .zip 文件解压缩到您的应用程序文档目录中，并从应用程序资源中获取文件。

```
self.fileManager = [NSFileManager defaultManager];

NSArray *paths = NSSearchPathForDirectoriesInDomains(NSDocumentDirectory, NSUserDomainMask, YES);

NSLog(@"document directory path:%@",paths);

self.documentDirectory = [paths objectAtIndex:0];

NSString *filePath = [NSString stringWithFormat:@"%@/abc", self.documentDirectory];

NSLog(@"file path is:%@",filePath);

NSString *fileContent = [[[NSBundle mainBundle] resourcePath] stringByAppendingPathComponent:@"data.zip"];

NSData *unzipData = [NSData dataWithContentsOfFile:fileContent];

[self.fileManager createFileAtPath:filePath contents:unzipData attributes:nil];

// here we go, unzipping code

ZipArchive *zipArchive = [[ZipArchive alloc] init];

if ([zipArchive UnzipOpenFile:filePath])
{
    if ([zipArchive UnzipFileTo:self.documentDirectory overWrite:NO])
    {
        NSLog(@"Archive unzip success");
        [self.fileManager removeItemAtPath:filePath error:NULL];
    }
    else
    {
        NSLog(@"Failure to unzip archive");
    }
}
else
{
    NSLog(@"Failure to open archive");
}
[zipArchive release]; 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-01-05T13:09:04.263

解压缩任意 zip 文件真的很困难。这是一种复杂的文件格式，并且可能有许多不同的压缩例程可以在文件内部使用。Info-ZIP 有一些免费许可的代码（[http://www.info-zip.org/UnZip.html](http://www.info-zip.org/UnZip.html "解压缩")），可以通过一些黑客攻击在 iPhone 上工作，但坦率地说，API 很可怕——它涉及将命令行参数传递给模拟 UnZIP 运行的假“main”（公平地说，这是因为他们的代码从一开始就没有被设计成这样使用，库功能后来被固定了）。

如果您可以控制要解压缩的文件的来源，我*强烈*建议您使用其他压缩系统而不是 ZIP。它的灵活性和普遍性使其非常适合在人与人之间传递文件档案，但自动化非常尴尬。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-01-05T13:16:55.247

zlib 不是用来打开 .zip 文件的，但你很幸运：zlib 的 contrib 目录包含 minizip，它能够使用 zlib 打开 .zip 文件。

它可能没有捆绑在 SDK 中，但您可能可以使用捆绑版本的 zlib 使用它。获取 zlib 源代码的副本并查看 contrib/minizip。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-01-05T12:45:40.177

我没有使用过 iPhone，但您可能想看看[GZIP](http://www.gzip.org/)，这是一个非常便携的开源 zip 库，可用于许多平台。

* * *

## 回答 #8

> 赞同：-5
> 
> 时间：2009-11-12T00:41:03.007

我在 iPhone 模拟器上对此进行了一些运气测试：

```
NSArray *paths = 
   NSSearchPathForDirectoriesInDomains(NSDocumentDirectory, NSUserDomainMask, YES);

NSString *documentsDirectory = [paths objectAtIndex:0];

NSString *saveLocation = 
   [documentsDirectory stringByAppendingString:@"myfile.zip"];

NSFileManager* fileManager = [NSFileManager defaultManager];

if ([fileManager fileExistsAtPath:saveLocation]) {
    [fileManager removeItemAtPath:saveLocation error:nil];

}

NSURLRequest *theRequest = 
             [NSURLRequest requestWithURL:
                [NSURL URLWithString:@"http://example.com/myfile.zip"]
             cachePolicy:NSURLRequestUseProtocolCachePolicy
             timeoutInterval:60.0];    

NSData *received = 
             [NSURLConnection sendSynchronousRequest:theRequest 
                              returningResponse:nil error:nil];    

if ([received writeToFile:saveLocation atomically:TRUE]) {      
    NSString *cmd = 
       [NSString stringWithFormat:@"unzip \"%@\" -d\"%@\"", 
       saveLocation, documentsDirectory];       

    // Here comes the magic...
    system([cmd UTF8String]);       
} 
```

它看起来比摆弄 zlib 更容易......

# iphone - iPhone 上的 NSbeep()

> ID：412986
> 
> 赞同：5
> 
> 时间：2009-01-05T12:36:38.837
> 
> 标签：iphone, cocoa-touch

iPhone上是否`NSBeep()`存在？我只想播放一个简短的错误声音以表明按下的键不是合法字符。我将在我的 textField 委托中播放这个，它禁止非法字符。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-01-05T12:43:39.587

不，NSBeep() 是 iPhone 上不存在的 ApplicationKit 框架的一部分。

# wpf - 如何在 WPF 中流式传输网络摄像头？

> ID：412995
> 
> 赞同：8
> 
> 时间：2009-01-05T12:40:40.547
> 
> 标签：wpf, streaming, webcam, mediaelement

我可以从我的网络摄像头流式传输 WPF 应用程序中的实时视频吗？如果是，那么如何？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-01-05T13:18:14.510

您将不得不使用 DirectX Capture 或其他东西（在 WPF 中不知道，所以直接使用 DirectX API）。

看：[WPF 媒体工具包](http://www.codeplex.com/WPFMediaKit)。它可以抓取 Vista Windows 桌面管理器 DirectX Direct3D 共享 Surface，并将其用作 WPF 中的视觉画笔。他用它做了一些好事。看看他解释的[博客。](http://jmorrill.hjtcentral.com/Home/tabid/428/EntryId/278/Vista-DWM-Hacking-Capture-and-Stream-D3D-WPF-Windows-Real-Time.aspx)

我希望这可以帮助你在你的路上...

2009-11-06 更新：[VideoRenderElement](http://videorendererelement.codeplex.com) Codeplex 项目有一个关于如何流式传输网络摄像头内容的示例。 [这个项目](http://videorendererelement.codeplex.com/wikipage?title=Screen%20Shots&referringTitle=Home)看起来完全符合您的要求。

更新 2013-02-18：或者可以使用[Expression Encoder SDK](http://msdn.microsoft.com/en-us/library/gg602440%28v=expression.40%29.aspx)。例如，您可以查看 CodeProject 上的[WPF-Webcam-Control](http://www.codeproject.com/Articles/285964/WPF-Webcam-Control)文章***********