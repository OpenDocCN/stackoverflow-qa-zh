# StackOverflow 问答 11023000-11023999

# ios - 如何使用 Forge 配置 developer_certificate_path 和 developer_certificate_password

> ID：11023001
> 
> 赞同：2
> 
> 时间：2012-06-13T20:44:19.210
> 
> 标签：ios, trigger.io, forge

在伪造文档中它指出：

> 您现在应该可以在文件中配置`developer_certificate_path`and了。`developer_certificate_password``local_config.json`

但是，没有这方面的示例或如何指定配置文件。

有没有人有该`local_config.json`文件的任何示例？

我有路径/文件、密码和配置文件——我只是不知道这是在配置文件中格式化/使用的。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-14T08:33:08.793

当然，如果您将证书保存为`my_certificate.pfx`当前目录：

```
{
    "ios": {
        "profiles": {
            "DEFAULT": {
                "provisioning_profile": "development.mobileprovision",
                "developer_certificate_path": "my_certificate.pfx",
                "developer_certificate_password": "my password"
            }
        }
    }
} 
```

我也会在我们的文档中改进对此的报道：感谢您的提醒！现在，这里有一个提及：http: [//docs.trigger.io/en/v1.3/tools/local-config.html#format-of-local-config-json](http://docs.trigger.io/en/v1.3/tools/local-config.html#format-of-local-config-json)

# selenium - selenium webdriver在点击不同的窗口时停止工作

> ID：11023002
> 
> 赞同：2
> 
> 时间：2012-06-13T20:44:21.413
> 
> 标签：selenium, internet-explorer-8, webdriver, selenium-webdriver

我正在使用 IE8 和 webdriver。我遇到的问题是每次运行 webdriver 时我都无法触摸我的电脑。基本上，当我单击另一个窗口时，它就会停止工作。因此，我无法在带断点的调试模式下运行我的代码，因为每次我去 Eclipse 手动执行断点时，webdriver 不再工作，因为没有选择 IE8。使用 Firefox，我可以做任何我想做的事情，但不能使用 IE8。无论如何我可以用IE8解决这个问题吗？

谢谢！

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-06-13T21:31:47.710

简短的回答是，“不，你目前无法用 IE 解决这个问题。” 窗口焦点对于 IE 驱动程序非常重要的原因有很多。最大的原因是您在使用 IE 驱动程序时使用了所谓的“本机事件”，它在操作系统级别模拟鼠标和键盘事件，而不仅仅是在浏览器中使用 JavaScript 和如果浏览器窗口没有焦点，IE 处理本机事件的方式有时会受到影响。更多信息可以[在 2012 Selenium Conference 上的演讲](http://www.youtube.com/watch?v=myffo8o67OA)中找到。

解决该问题的一种方法是使用 IE 驱动程序禁用本机事件。不幸的是，模拟事件[还没有准备好正常使用](http://code.google.com/p/selenium/source/detail?r=16888)。

# matlab - 如何用 Matlab 读取大量的 DICOM 文件？

> ID：11023005
> 
> 赞同：0
> 
> 时间：2012-06-13T20:44:50.477
> 
> 标签：matlab, image-processing, dicom

我正在使用一个在循环中生成字符串集合的脚本：

```
'folder1/im1' 
'folder1/im2'
... 
'folder1/im3' 
```

我将字符串分配给一个变量，当我尝试执行该`img = dicomread(file);`函数时，我收到以下错误：

```
Error using dicomread>newDicomread (line 164)
The first input argument must be a filename or DICOM info struct.

Error in dicomread (line 80)
[X, map, alpha, overlays] = newDicomread(msgname, frames);

Error in time (line 14)
    img = dicomread(file); 
```

但是，使用命令行我没有收到错误：`img = dicomread('folder1/im1')`.

代码如下：

```
 for i=1:6 %six cases
            nameDir = strcat('folder', int2str(i));
            dirData = dir(nameDir);
            dirIndex = [dirData.isdir];
            fileList = {dirData(~dirIndex).name}; % list of files for each directory
            n = size(fileList);
            cd(nameDir);
            for x = 1:n(2)
                    img = dicomread(strcat(pwd(), '/', fileList(x)));
            end
            cd('..');
    end 
```

可能是什么错误？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-13T21:07:53.953

你现在已经想通了，不是吗。

根据你写的，你测试

```
img = dicomread('folder1/im1'); 
```

当你遇到的问题是

```
img = dicomread(file); 
```

您需要实际测试您遇到问题的线路。我会推荐：

> 在 test.ma 中设置一个断点`img = dicomread(file)`。当你到达那条线时，你可以看到`file`等于。还要`whos file`确保它是类的`char`，而不是单元格数组或随机的东西。

如果您仍然需要帮助，请编辑您的原始帖子并显示您分配这些字符串的代码，并告诉我们在命令提示符下`file`键入时会发生什么。`img = dicomread(file)`

# coldfusion - 如何在 ColdFusion 10 中禁用 sameformfieldsasarray？

> ID：11023006
> 
> 赞同：4
> 
> 时间：2012-06-13T20:44:53.313
> 
> 标签：coldfusion, coldfusion-10, application.cfc, application.cfm

**`sameformfieldsasarray`有文件时如何禁用`Application.cfm`？**

我正在将旧应用程序从 ColdFusion 9 移植到 ColdFusion 10。该站点使用了一个旧学校`Application.cfm`文件。

我看到 10 添加了一个新设置`this.sameformfieldsasarray`（这应该默认关闭，但不幸的是，对于我刚刚设置的全新安装，它是“开启”的。

我不能设置`this.sameformfieldsasarray`false 因为我们有`Application.cfm`而不是`Application.cfc`，而且我在管理员或文档中找不到任何内容。

该代码是从 Ubuntu 12.04 x64 上全新安装的 CF10 运行的。@Adam 验证示例代码在 Windows Server 2003 x64 上运行。

* * *

**代码**：[https ://gist.github.com/2931343](https://gist.github.com/2931343)

**样本提交截图**：http : [//imgur.com/Q9DAi](https://imgur.com/Q9DAi)

**服务器范围截图**：http : [//imgur.com/9iwWL](https://imgur.com/9iwWL)

**提交的错误报告**：[https ://bugbase.adobe.com/index.cfm?event=bug&id=3214734](https://bugbase.adobe.com/index.cfm?event=bug&id=3214734)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-13T21:02:38.640

我不确定这个。CF 10 太新了，你可能是第一个在公共场合问这个问题的人 (ha)。但也许您可以在 application.cfm 中执行以下操作。

```
<cfloop collection="#form#" item="fitem">
    <cfif isArray(form[fitem])>
        <cfset form[fitem] = arraytolist(form[fitem])/>
    </cfif>
</cfloop> 
```

我怀疑这会让事情变得正确。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-05T09:12:01.260

此问题现已在 2012 年 8 月 31 日发布的[ColdFusion 10 Update 1中得到解决。](http://helpx.adobe.com/coldfusion/kb/coldfusion10-update-01.html)

应用更新应该可以解决问题并允许删除 Mark A Kruger 建议的解决方法。

# android - NullPointerException 无处不在

> ID：11023009
> 
> 赞同：0
> 
> 时间：2012-06-13T20:45:06.437
> 
> 标签：android, user-interface, bluetooth, nullpointerexception

所以我的代码一直运行良好，我在 GUI 中添加了一些额外的功能，现在突然之间我得到了一个空指针异常。我无法弄清楚我可以改变什么来实现这一点。我已经将代码简化为错误所在的位置。

```
public class AndroidBluetooth extends Activity {

/** Called when the activity is first created. */
private static BluetoothAdapter myBtAdapter;
private static BluetoothDevice myBtDevice;
private ArrayAdapter<String> btArrayAdapter;
private ArrayList<BluetoothDevice> btDevicesFound = new ArrayList<BluetoothDevice>();
private Button btnScanDevice;
private TextView stateBluetooth;
private ListView listDevicesFound;
private InputStream iStream;
private OutputStream oStream;
private BluetoothSocket btSocket;
private String newDeviceAddress;
private BroadcastReceiver mReceiver;

// Intent request codes
private static final int REQUEST_CONNECT_DEVICE = 1;

private static TextView mTitle;

// Name of the connected device
private String mConnectedDeviceName = null;

/**
 * Set to true to add debugging code and logging.
 */
public static final boolean DEBUG = true;

/**
 * Set to true to log each character received from the remote process to the
 * android log, which makes it easier to debug some kinds of problems with
 * emulating escape sequences and control codes.
 */
public static final boolean LOG_CHARACTERS_FLAG = DEBUG && false;

/**
 * Set to true to log unknown escape sequences.
 */
public static final boolean LOG_UNKNOWN_ESCAPE_SEQUENCES = DEBUG && false;

private static final int REQUEST_ENABLE_BT = 2;

// Member fields
//private final BluetoothAdapter mAdapter;
//private final Handler mHandler;
//private ConnectThread mConnectThread;
//private ConnectedThread mConnectedThread;
//private int mState;

//private EmulatorView mEmulatorView;

// Constants that indicate the current connection state
public static final int STATE_NONE = 0;       // we're doing nothing
public static final int STATE_LISTEN = 1;     // now listening for incoming connections
public static final int STATE_CONNECTING = 2; // now initiating an outgoing connection
public static final int STATE_CONNECTED = 3;  // now connected to a remote device

//public boolean customTitleSupported;
@Override
public void onCreate(Bundle savedInstanceState) {

    super.onCreate(savedInstanceState);

    //customTitleSupported = requestWindowFeature( Window.FEATURE_CUSTOM_TITLE );
    // Set up window View
    setContentView(R.layout.main);

    stateBluetooth = (TextView) findViewById ( R.id.titleTvRight );
    startBluetooth();
    myBtAdapter = null;
    CheckBlueToothState();

    //customTitleBar( getText( R.string.app_name).toString(), getText( R.string.app_name).toString() );
}
/**
public void customTitleBar( String left, String right ) {
    if( right.length() > 20 ) right = right.substring( 0, 20 );

    if( customTitleSupported ) {
        getWindow().setFeatureInt( Window.FEATURE_CUSTOM_TITLE, R.layout.customlayoutbar );
        TextView titleTvLeft = (TextView) findViewById( R.id.titleTvLeft );
        TextView titleTvRight = (TextView) findViewById( R.id.titleTvRight );

        titleTvLeft.setText( left );
        titleTvRight.setText( right );

    }
}
*/
public boolean onCreateOptionsMenu( Menu menu ) {
    MenuInflater inflater = getMenuInflater();
    inflater.inflate( R.menu.option_menu, menu );
    return true;
}

public boolean onOptionsItemSelected( MenuItem item ) {
    switch( item.getItemId() ) {
    case R.id.connect:
        startActivityForResult( new Intent( this, DeviceList.class ), REQUEST_CONNECT_DEVICE  );
        return true;
    case R.id.preferences:
        return true;
    default:
        return super.onContextItemSelected( item );
    }
}

private void CheckBlueToothState() {
    Log.i("HUH", "0");
    if( myBtAdapter == null ) {
        Log.i("HUH", "1");
        stateBluetooth.setText("Bluetooth NOT supported" );
    } else {
        Log.i("HUH","2");
        if( myBtAdapter.isEnabled() ) {
            Log.i("HUH","3");
            if( myBtAdapter.isDiscovering() ) {
                Log.i("HUH","4");
                stateBluetooth.setText( "Bluetooth is currently " +
                        "in device discovery process." );
            } else {
                Log.i("HUH","5");
                stateBluetooth.setText( "Bluetooth is Enabled." );
                btnScanDevice.setEnabled( true );
            }
        } else {
            Log.i("HUH","6");
            stateBluetooth.setText( "Bluetooth is NOT enabled" );
            Intent enableBtIntent = new Intent( BluetoothAdapter.ACTION_REQUEST_ENABLE );
            startActivityForResult( enableBtIntent, REQUEST_ENABLE_BT );
        }
    }
}

private Button.OnClickListener btnScanDeviceOnClickListener = new Button.OnClickListener() {
    public void onClick( View arg0 ) {

    }
};

@Override
protected void onActivityResult( int requestCode, int resultCode, Intent data ) {
    if( requestCode == REQUEST_ENABLE_BT ) {
        CheckBlueToothState();
    }
}

//In SDK15 (4.0.3) this method is now public as
//Bluetooth.fetchUuisWithSdp() and BluetoothDevice.getUuids()
public ParcelUuid[] servicesFromDevice(BluetoothDevice device) {
    try {
        Class cl = Class.forName("android.bluetooth.BluetoothDevice");
        Class[] par = {};
        Method method = cl.getMethod("getUuids", par);
        Object[] args = {};
        ParcelUuid[] retval = (ParcelUuid[]) method.invoke(device, args);
        return retval;
    } catch (Exception e) {
        e.printStackTrace();
        return null;
    }
}

private final BroadcastReceiver ActionFoundReceiver = new BroadcastReceiver() {
    public void onReceive( Context context, Intent intent ) {
        String action = intent.getAction();
        if( BluetoothDevice.ACTION_FOUND.equals( action ) ) {
            BluetoothDevice btDevice = intent.getParcelableExtra( BluetoothDevice.EXTRA_DEVICE );
            btDevicesFound.add( btDevice );
            btArrayAdapter.add( btDevice.getName() + "\n" + btDevice.getAddress() );
            btArrayAdapter.notifyDataSetChanged();
        }           
    }
};
public static void startBluetooth(){
    try {
        myBtAdapter = BluetoothAdapter.getDefaultAdapter();
        myBtAdapter.enable();
    } catch ( NullPointerException ex ) {
        Log.e( "Bluetooth", "Device not available" );
    }
}

public static void stopBluetooth() {
    myBtAdapter.disable();
} 
```

}

这是LogCat：

```
06-13 16:34:33.654: I/HUH(17008): 0
06-13 16:34:33.654: I/HUH(17008): 1
06-13 16:34:33.662: D/AndroidRuntime(17008): Shutting down VM
06-13 16:34:33.662: W/dalvikvm(17008): threadid=1: thread exiting with uncaught exception (group=0x40015560)
06-13 16:34:33.662: E/AndroidRuntime(17008): FATAL EXCEPTION: main
06-13 16:34:33.662: E/AndroidRuntime(17008): java.lang.RuntimeException: Unable to start activity    ComponentInfo{com.exercise.AndroidBluetooth/com.exercise.AndroidBluetooth.AndroidBluetooth}: java.lang.NullPointerException
06-13 16:34:33.662: E/AndroidRuntime(17008):    at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:1647)
06-13 16:34:33.662: E/AndroidRuntime(17008):    at android.app.ActivityThread.handleLaunchActivity(ActivityThread.java:1663)
06-13 16:34:33.662: E/AndroidRuntime(17008):    at android.app.ActivityThread.access$1500(ActivityThread.java:117)
06-13 16:34:33.662: E/AndroidRuntime(17008):    at android.app.ActivityThread$H.handleMessage(ActivityThread.java:931)
06-13 16:34:33.662: E/AndroidRuntime(17008):    at android.os.Handler.dispatchMessage(Handler.java:99)
06-13 16:34:33.662: E/AndroidRuntime(17008):    at android.os.Looper.loop(Looper.java:130)
06-13 16:34:33.662: E/AndroidRuntime(17008):    at android.app.ActivityThread.main(ActivityThread.java:3683)
06-13 16:34:33.662: E/AndroidRuntime(17008):    at java.lang.reflect.Method.invokeNative(Native Method)
06-13 16:34:33.662: E/AndroidRuntime(17008):    at java.lang.reflect.Method.invoke(Method.java:507)
06-13 16:34:33.662: E/AndroidRuntime(17008):    at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:839)
06-13 16:34:33.662: E/AndroidRuntime(17008):    at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:597)
06-13 16:34:33.662: E/AndroidRuntime(17008):    at dalvik.system.NativeStart.main(Native Method)
06-13 16:34:33.662: E/AndroidRuntime(17008): Caused by: java.lang.NullPointerException
06-13 16:34:33.662: E/AndroidRuntime(17008):    at com.exercise.AndroidBluetooth.AndroidBluetooth.CheckBlueToothState(AndroidBluetooth.java:165)
06-13 16:34:33.662: E/AndroidRuntime(17008):    at com.exercise.AndroidBluetooth.AndroidBluetooth.onCreate(AndroidBluetooth.java:124)
06-13 16:34:33.662: E/AndroidRuntime(17008):    at android.app.Instrumentation.callActivityOnCreate(Instrumentation.java:1047)
06-13 16:34:33.662: E/AndroidRuntime(17008):    at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:1611)
06-13 16:34:33.662: E/AndroidRuntime(17008):    ... 11 more 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-13T20:52:53.263

由于 CheckBluetoothState () 是问题区域并且堆栈跟踪没有提供太多信息，请尝试用 try catch 包围它并打印整个错误。还可以尝试通过在每个点捕获异常来调试它。有了很少的信息，这就是我所能建议的。通过从 catch 块中发布错误来更新问题。希望这可以帮助。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-13T22:21:30.593

我希望你把全班都贴出来了……我们不知道你是否排除了原因……例如，一个可能的原因；

是`stateBluetooth`声明为类变量还是局部变量？如果您在 onCreate 中滑倒并创建它，这可能就是您在另一种方法中获得 NPE 的原因。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-06-26T10:12:34.860

***myBtAdapter = null;*** ，我有这个初始化的问题

所以将其更改为：

myBtAdapter = **BluetoothAdapter.getDefaultAdapter;**

答对了！

# matlab - Matlab索引到二维数组使用

> ID：11023010
> 
> 赞同：0
> 
> 时间：2012-06-13T20:45:10.087
> 
> 标签：matlab, matrix, indexing, 2d

我有一个二维矩阵，比如 M=zeros(10,10);

我有另一个列矩阵， V=[1;2;3;4;5;6;5;4;3;2];

我希望能够为所有 j >= V(i) 设置 M(i,j) = 1

我知道我可以循环执行此操作

```
for i=1:10
   M(i,V(i):10) = 1;
end 
```

但似乎可以使用某种形式的 Matlab 索引来避免使用循环。例如：

```
M(:,V:10)=1; 
```

或者

```
M(:,V(:):10)=1; 
```

但这些都没有产生预期的结果。

我可以使用一些语法糖来实现这一点还是应该恢复循环？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-13T20:55:47.200

它几乎不微妙，并不比我不认为的循环更好，但是：

```
[J,I] = meshgrid(1:10,1:10); 
V = [1;2;3;4;5;6;5;4;3;2];
M = J>V(I); 
```

享受。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-14T01:49:47.287

由于您正在寻找语法糖，因此这是一种深奥的方法。:)

假设 的长度`V`是所需矩阵 中两个维度的大小`M`，首先创建一个相同大小的单位矩阵，然后适当索引并取`cumsum`：

```
V = [1;2;3;4;5;6;5;4;3;2]; #% 10x1 vector
E = eye(length(V), length(V)); #%10x10 identity matrix
M = cumsum(E(V,:),2)

M =

     1     1     1     1     1     1     1     1     1     1
     0     1     1     1     1     1     1     1     1     1
     0     0     1     1     1     1     1     1     1     1
     0     0     0     1     1     1     1     1     1     1
     0     0     0     0     1     1     1     1     1     1
     0     0     0     0     0     1     1     1     1     1
     0     0     0     0     1     1     1     1     1     1
     0     0     0     1     1     1     1     1     1     1
     0     0     1     1     1     1     1     1     1     1
     0     1     1     1     1     1     1     1     1     1 
```

好的，现在：不那么有趣了，但（在我的机器上）比迄今为止测试过的任何其他选项都快：

```
n=10000;
V = randi(n-1, 1, n); #% as in @KevinRatelle's answer (but not transposed)

tic;
Vlinear = reshape(V + (0:n-1)*n, 1, []); #% find linear indices of first "ones"
M = zeros(n);
M(Vlinear)=1;
M=cumsum(M);
toc 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-14T01:19:08.250

我尝试了循环方法和“网格”方法。我想知道计算大型矩阵的时间（因为 matlab 中的循环问题通常是时间）。

首先，我将代码优化为如下所示：

```
V = V*ones(1,n);
N = ones(1,n)'*(1:n);
M = N>=V; 
```

实际上，N 是一个网格，但这样做似乎更快......

我试过这个：

```
n = 10000;
V = randi(n-1,1,n)';

tic;
M = zeros(n);
for i=1:n
    M(i,V(i):n) = 1;
end
toc

tic;
[J,I] = meshgrid(1:n,1:n);
M = J>=V(I);
toc

tic;
V = V*ones(1,n);
N = ones(1,n)'*(1:n);
M = N>=V;
toc 
```

结果是：

```
Elapsed time is 1.726872 seconds.
Elapsed time is 5.206657 seconds.
Elapsed time is 1.548600 seconds. 
```

但是使用矩阵而不是循环的方法对于较大的 n 会消耗内存。我会亲自坚持循环。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-13T21:53:57.353

尝试这个：

```
v = [1;2;3;4;5;6;5;4;3;2];
n = 10;
M = repmat((1:n)', 1, numel(v)) > repmat(v', n, 1); 
```

# ios - 我的 mac 在 vpn 上运行。因此我的应用程序无法在运行时连接到互联网

> ID：11023015
> 
> 赞同：0
> 
> 时间：2012-06-13T20:45:29.130
> 
> 标签：ios, uiwebview, ios-simulator, vpn

我遇到了一个非常棘手的问题。

我的 Mac 使用受密码保护的 Internet 连接。现在，每次我的应用程序尝试连接到互联网时，它都会失败。我通过加载具有正确 url 的 webview 并将所有四个协议委托附加到它来测试这一点。从这些代表中，我了解到页面开始加载但不会停止加载或加载失败并出现错误。

似乎我需要一种在运行时通过应用程序将用户名和密码传递给服务器的方法。有没有办法做到这一点？任何与此事略有关联的事情都将受到高度赞赏。预先感谢！

Ps - 我知道在真正的 ipad 上有一个适当的设置来设置用户名和密码，这样用户就不需要每次都输入它。但是 ipad 模拟器没有任何这样的东西，我没有设备来测试我的应用程序。:(

# machine-learning - 手势识别功能

> ID：11023016
> 
> 赞同：1
> 
> 时间：2012-06-13T20:45:31.973
> 
> 标签：machine-learning, gesture

我想创建一个应用程序，它可以学习对用户绘制的一系列点进行分类，例如手写识别。如果数据点由许多 (x,y) 对组成（例如对应于手势实例的像素），那么计算该实例的最佳特征是什么，这将构成一个好的多类分类器（例如 SVM， NN等）？特别是如果提供的培训示例有限。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-17T12:33:57.650

如果我是你，我会找到与角点、端点和交叉点相对应的数据点，将它们用作特征并丢弃中间点。您也可以包含这些兴趣点的角度或其他一些描述符。

为了检测兴趣点，您可以使用[Harris 检测器](http://en.wikipedia.org/wiki/Corner_detection#The_Harris_.26_Stephens_.2F_Plessey_.2F_Shi-Tomasi_corner_detection_algorithm)，然后您可以使用该点的梯度值作为简单的描述符。或者，您可以使用更花哨的方法，例如[SIFT](http://en.wikipedia.org/wiki/Scale-invariant_feature_transform)。

您可以使用下采样图像中每个像素的描述符，然后使用 SVM 进行分类。这样做的缺点是特征向量中会有大量无趣的数据点。

另一种方法是不将其视为分类问题，而是将其视为模板匹配问题（在[计算机视觉](/questions/tagged/computer-vision "显示标记为“计算机视觉”的问题")中相当常见）。在这种情况下，可以将手势指定为任意数量的兴趣点，完全忽略不感兴趣的数据。实例点的某个阈值百分比必须与模板匹配才能进行肯定识别。例如，当匹配'R'实例的角点与'X'模板时，右下点应该匹配，是相同位置方向的端点，但其他点太不相似，给出了相当低的分数和标识 R=X 将被拒绝。

# java - 通过 JNLP 写入本地文件

> ID：11023018
> 
> 赞同：1
> 
> 时间：2012-06-13T20:45:33.433
> 
> 标签：java, security, file-io, jnlp, java-web-start

我有从 jar 文件中读取资源然后将其写入本地磁盘的特定要求。但是当我尝试将该资源写入本地磁盘时出现异常：

```
java.io.FilePermission (write) is raised. 
```

我有我的罐子签名。我也尝试了以下解决方案，但它也不起作用。

```
AccessController.doPrivileged(new PrivilegedAction() 
```

似乎没有任何效果。

签署 jar 后我是否错过了一步，因为这是随处可用的最常见解决方案？

如何在不使用策略文件的情况下写入本地文件（因为不能在每台客户端计算机上完成）？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-13T20:52:29.650

您可以使用[`javax.jnlp.FileSaveService`](http://docs.oracle.com/javase/7/docs/jre/api/javaws/jnlp/javax/jnlp/FileSaveService.html).

您可能缺少的一部分是在 JNLP 文件中将应用程序标记为安全。但是，编写一个安全的应用程序有点棘手，我不推荐它。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-13T20:51:52.597

JNLP 还需要指定：

```
<security>
    <all-permissions/>
</security> 
```

有关详细信息，请参阅[JNLP 文件语法](http://docs.oracle.com/javase/7/docs/technotes/guides/javaws/developersguide/syntax.html)。

* * *

我通常会使用`FileSaveService`Tom's answer 中详细说明的内容，但这听起来更像是“文件”可能是用于配置应用程序的默认属性文件的情况。保存服务不太适合，因为应用程序。无法知道文件存储在哪里，或者以后如何访问它。出于安全原因，`FileContents`代替 a 提供的对象`File`没有返回路径的方法。

在这种情况下，提取配置的详细信息。`PersistenceService`使用JNLP API文件和存储它们。这是一个[演示。的`PersistenceService`](http://pscode.org/jws/api.html#ps)。此服务也适用于沙盒应用程序。（没有代码签名巫毒）。

# spotify - libspotify API：浏览同一艺术家时专辑数量不同

> ID：11023020
> 
> 赞同：0
> 
> 时间：2012-06-13T20:45:51.660
> 
> 标签：spotify

我正在尝试使用现有的示例 browse.c 通过给定的艺术家 uri 获取艺术家的专辑数量。每次运行命令**browse spotify:artist:3fMbdgg4jU18AjLCKBhRSm时，** **sp_artistbrowse_num_albums(browse)**的返回值都不同。为什么？

 **我是否正确理解回调**artistbrowse_complete_cb**仅在浏览完成时调用一次，但在更新元数据时调用回调**metadata_updated**？

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-14T06:17:53.393

> 我是否正确理解回调artistbrowse_complete_cb 仅在浏览完成时调用一次，但在更新元数据时调用回调metadata_updated？

这是正确的。正如我之前所说，`metadata_updated`意味着“某些元数据已在某处更新”，并且有更具体的回调，例如`artistbrowse_complete_cb`针对艺术家浏览等更有针对性的操作。

至于为什么它会不断变化——这有点奇怪，因为艺术家的专辑数量通常不会有太大波动，但每天都可以添加和删除专辑。最好只是接受你被告知的内容并保持你的 UI 是最新的。**

# blackberry - 失焦和滚动（黑莓）上的自定义 BitmapField 错误

> ID：11023022
> 
> 赞同：1
> 
> 时间：2012-06-13T20:45:56.353
> 
> 标签：blackberry, java-me, focus, blackberry-os6, bitmapfield

尝试在 BlackBerry 6 上实现图片库时，我遇到了这个烦人的问题。

一切正常，但是当焦点从顶部按钮变为屏幕下方的图片时，图像似乎出现故障并且无法正确绘制自己。请参阅下面的图片以获取示例：

（焦点在屏幕顶部（未显示）） ![初始画面](../Images/da2d9ccf51a901c9755aff4c47e10784.png)

（焦点现在在左下角的图像上，请注意，由于未知原因，顶部的图像现在是空白的）

![滚动屏幕后](../Images/ad5f945c90787d5b0bf72f02686907a0.png)

无论我在缩略图库中添加多少图片，都会发生这种情况。

现在这是我的代码，（其中一部分与缩略图的绘制有关）

```
public ProductImage(String productName){
    super(VERTICAL_SCROLL|VERTICAL_SCROLLBAR);

    currentProduct = productName;

    createGUI(); 
}
public void createGUI(){
    deleteAll();
    try{
        Storage.loadPicture();
    }catch(NullPointerException e){
        e.printStackTrace();
    }
    this.setTitle(new LabelField(_resources.getString(PRODUCT_IMAGE), Field.FIELD_HCENTER));
    if(ToolbarManager.isToolbarSupported())
    {
        Toolbar tb = new Toolbar();
        setToolbar(tb.createToolBar());
    }
    else{
        Toolbar tb = new Toolbar();
        add(tb.createNavBar());
    }

    picVector = Storage.getPicture(currentProduct);

    EncodedImage enc = EncodedImage.getEncodedImageResource("camera.png");
    EncodedImage sizeEnc = ImageResizer.sizeImage(enc, Display.getHeight(), Display.getHeight());

    takenPicture = new BitmapField(enc.getBitmap());

    vfMain = new VerticalFieldManager();
    vfMain.add(logo);
    vfMain.add(new SeparatorField());
    add(vfMain);
    prepareBmpFields();
}   

 private void prepareBmpFields() {

        System.out.println("This is the vector size: " + picVector.getPicVector().size());

        LayoutManager manager = new LayoutManager();

        FieldChangeListener itemListener = new ButtonListener(); 

        mBmpFields = new ImageButtonField[picVector.getPicVector().size()];

        for (int i = 0; i < picVector.getPicVector().size(); i++) {
                /*EncodedImage image = EncodedImage
                                .getEncodedImageResource((String)imageVector.elementAt(i));*/
            byte[] data = getData((String)picVector.getPicVector().elementAt(i));
            //Encode and Resize image 
            EncodedImage  eImage = EncodedImage.createEncodedImage(data,0,data.length);

             eImage = ImageResizer.resizeImage(eImage, mImgWidth, mImgHeight);
             ImageButtonField currentImage = new ImageButtonField(eImage.getBitmap());
             currentImage.setAssociatedPath((String)picVector.getPicVector().elementAt(i));
             mBmpFields[i] = currentImage;
             mBmpFields[i].setChangeListener(itemListener);
             manager.add(mBmpFields[i]);

        }
        vfMain.add(manager);
    }

    private class LayoutManager extends VerticalFieldManager {
        public LayoutManager() {
            super(VERTICAL_SCROLL | VERTICAL_SCROLLBAR);
        }

        protected void sublayout(int width, int height) {
            int columns = mScrWidth / (mImgWidth + 2 * mImgMargin);

            int scrWidth = Display.getWidth();

              int rows = mBmpFields.length / columns
                + (mBmpFields.length % columns > 0 ? 1 : 0);
              int counter = 0;
              for (int i = 0; i < rows; i++) {
               for (int j = 0; j < columns; j++) {
                int posX = j * (mImgWidth + 2 * mImgMargin) + mImgMargin;
                int posY = i * (mImgHeight + 2 * mImgMargin) + mImgMargin;

                if(mBmpFields.length > counter){
                    Field field = mBmpFields[counter];
                    layoutChild(field, mImgWidth, mImgHeight);
                    setPositionChild(field, posX, posY);
                    counter++;
                };
               }  
             }
              if(Display.getWidth() < Display.getHeight()){
                setExtent(mScrWidth, (int)(mScrHeight*1.25));
                }
              else{
                  setExtent(mScrWidth, (int)(mScrHeight*2)); 
              }
        }

        public int getPreferredWidth() {
            return mScrWidth;
        }
        public int getPreferredHeight() {
            return mScrHeight;
        }
    }
} 
```

我已经删除了许多不相关的代码部分，但需要的代码在那里。

有谁知道是什么导致了这个问题？谢谢你的帮助！

编辑：根据要求，这是我对 ImageButtonField 类的实现：

```
import net.rim.device.api.system.Bitmap;
import net.rim.device.api.system.Characters;
import net.rim.device.api.ui.Graphics;
import net.rim.device.api.ui.component.BitmapField;

public class ImageButtonField extends BitmapField{

String associatedPath ="";
BitmapField image2;

public ImageButtonField(Bitmap image) {
    super(image);
}
public void setAssociatedPath(String path){
    associatedPath = path;
}
public String getAssociatedPath(){
    return associatedPath;
}
public boolean isFocusable() {
    return true;
}
protected void applyTheme(Graphics arg0, boolean arg1) {
}

protected void drawFocus(Graphics graphics, boolean on) {
}
protected void onFocus(int direction) {
      // only change appearance if this button is enabled (aka editable)
      if (isEditable()) {
         invalidate();  // repaint
      } 
      super.onFocus(direction);
   }

   public void onUnfocus() {
      invalidate();  // repaint
      super.onUnfocus();
   }
protected boolean navigationClick(int status, int time) {
    fieldChangeNotify(0);
    return true;
}

protected boolean trackwheelClick(int status, int time) {
    fieldChangeNotify(0);
    return true;
}

protected void paint(Graphics graphics) {
    super.paint(graphics);
    if (isFocus()) {
        graphics.setGlobalAlpha(128);
        graphics.setColor(0x888888);
        graphics.fillRect(0, 0, getWidth(), getHeight());
    }else{
        graphics.setGlobalAlpha(0);
        graphics.setColor(0x000000);
        graphics.fillRect(0, 0, getWidth(), getHeight());
        //graphics.drawBitmap(0, 0, getWidth(), getHeight(), image2.getB, 0, 0);
    }
}

protected boolean keyChar(char character, int status, int time) {
    if(Characters.ENTER == character || Characters.SPACE == character) {
        fieldChangeNotify(0);
        return true;
    }
    return super.keyChar(character, status, time);
} 
```

}

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-16T01:31:17.527

好的，所以你可以忽略我的第一个答案，但由于我当时没有你的`ImageButtonField`代码，我不想把它扔掉......也许其他人会觉得它有用。

最后，我不需要对 进行任何更改`ImageButtonField`，但我确实更改了您的`LayoutManager`课程。我发现这是问题的方式是我刚刚开始用内置的自定义 UI 类替换您的自定义 UI 类。我替换`ImageButtonField`为`BitmapField`. 那并没有解决它。然后，我替换`LayoutManager`为`FlowFieldManager`并修复了它。所以，我知道问题出在哪里。

我的解决方案：

```
private class LayoutManager extends Manager {
  public LayoutManager() {
     super(VERTICAL_SCROLL | VERTICAL_SCROLLBAR);
  }

  protected void sublayout(int width, int height) {
     setExtent(width, height);
     // TODO: maybe always set the same virtual extent?
     if (Display.getWidth() < Display.getHeight()) {
        setVirtualExtent(mScrWidth, (int) (mScrHeight * 1.25));
     } else {
        setVirtualExtent(mScrWidth, (int) (mScrHeight * 2));
     }

     int columns = mScrWidth / (mImgWidth + 2 * mImgMargin);
     // int scrWidth = Display.getWidth();

     int rows = mBmpFields.length / columns + (mBmpFields.length % columns > 0 ? 1 : 0);
     int counter = 0;
     for (int i = 0; i < rows; i++) {
        for (int j = 0; j < columns; j++) {
           int posX = j * (mImgWidth + 2 * mImgMargin) + mImgMargin;
           int posY = i * (mImgHeight + 2 * mImgMargin) + mImgMargin;

           if (mBmpFields.length > counter) {
              Field field = mBmpFields[counter];
              layoutChild(field, mImgWidth, mImgHeight);
              setPositionChild(field, posX, posY);
              counter++;
           }
        }
     }
  }

  public int getPreferredWidth() {
     return mScrWidth;
  }

  public int getPreferredHeight() {
     return mScrHeight;
  }
} 
```

我不能肯定地说我理解为什么您的原始代码不起作用，但我可以说我不会在原始代码中做一些事情：

1.  原始代码正在扩展，`VerticalFieldManager`但它自己完成了所有工作，在`sublayout()`. 所以，我认为扩展没有任何意义`VerticalFieldManager`。我把它改成了 extend `Manager`。

2.  原始代码`setExtent()`以不同的大小调用。我不认为那是你想要的。 **Extent**是`Field`. **虚拟范围**是虚拟大小，您希望将其设置为大于实际范围，以便启用滚动。您不需要动态计算纵向与横向的不同**范围**，因为传递给的`width`and`height`参数`sublayout()`已经反映了这一点。我不确定您是否真的需要设置不同的虚拟范围。我认为您可能应该**始终**将虚拟范围高度设置为行数乘以图片高度，并考虑边距。

3.  您的原始代码中有一个未使用的变量`scrWidth`。我在上面评论了它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-14T00:21:02.063

[你最近](https://stackoverflow.com/questions/9263949/how-to-highlight-focused-custom-buttonfield-imagebuttonfield-on-blackberry)也发过这个问题吧？我是否正确假设`ImageButtonField`您在这里提到的与您在另一个问题中正在研究的相同？

我看不到你的完整实现`ImageButtonField`，你也应该在这里发布。但是，看着你的另一个问题的答案，我感觉你正在做一些自定义焦点处理`ImageButtonField`，也许它做得不太正确。无论如何，该类可能是问题所在。

我自己有一个类似`Field`的子类，这里是我定义的焦点处理方法：

```
public class CustomButtonField extends Field {

   private Bitmap _button;    // the currently displayed button image
   private Bitmap _on;        // image for 'on' state (aka in-focus)
   private Bitmap _off;       // image for 'off' state (aka out-of-focus)

   protected void onFocus(int direction) {
      // only change appearance if this button is enabled (aka editable)
      if (isEditable()) {
         _button = _on;
         invalidate();  // repaint
      } 
      super.onFocus(direction);
   }

   protected void onUnfocus() {
      _button = _off;
      invalidate();  // repaint
      super.onUnfocus();
   }

   protected void drawFocus(Graphics graphics, boolean on) {
      // override superclass implementation and do nothing
   }

   public boolean isFocusable() {
      return true;
   } 
```

我也有一个自定义实现`paint()`。我不会在这里全部展示，因为很多代码可能与您的问题无关，但我`paint()`确实包含了这个调用：

```
graphics.drawBitmap(_padding, _padding, _fieldWidth, _fieldHeight, _button, 0, 0); 
```

您可能不关心我有单独的图像用于聚焦和未聚焦状态的事实......也许您始终显示相同的图像。

但是，可能要检查的是您的`onFocus()`和`onUnfocus()`方法。您可能需要`invalidate()`像我一样添加一个呼叫。

查看 Rupak 对您的其他问题的回答，检查您的`ImageButtonField.paint()`方法也很好，并确保如果该领域不在焦点上，您不会忽略执行重要的绘图步骤。

# javascript - 如何将（触摸）铅笔工具变成直线工具？

> ID：11023023
> 
> 赞同：1
> 
> 时间：2012-06-13T20:45:57.650
> 
> 标签：javascript, html, canvas, touch, lines

到目前为止，它是可以完美绘制的移动触控铅笔工具，但我想知道......我将如何让它绘制一条完全直线，而不是可以在线外绘制的基本铅笔工具？

* * *

这是到目前为止的代码：

```
// "Draw Line" Button
$(document).ready(function () {
         initialize();
      });

      // works out the X, Y position of the click inside the canvas from the X, Y position on the page
      function getPosition(mouseEvent, sigCanvas) {
         var x, y;
         if (mouseEvent.pageX != undefined && mouseEvent.pageY != undefined) {
            x = mouseEvent.pageX;
            y = mouseEvent.pageY;
         } else {
            x = mouseEvent.clientX + document.body.scrollLeft + document.documentElement.scrollLeft;
            y = mouseEvent.clientY + document.body.scrollTop + document.documentElement.scrollTop;
         }

         return { X: x - sigCanvas.offsetLeft, Y: y - sigCanvas.offsetTop };
      }

      function initialize() {
         // get references to the canvas element as well as the 2D drawing context
         var sigCanvas = document.getElementById("canvasSignature");
         var context = sigCanvas.getContext("2d");
         context.strokeStyle = 'Black';

         // This will be defined on a TOUCH device such as iPad or Android, etc.
         var is_touch_device = 'ontouchstart' in document.documentElement;

         if (is_touch_device) {
            // create a drawer which tracks touch movements
            var drawer = {
               isDrawing: false,
               touchstart: function (coors) {
                  context.beginPath();
                  context.moveTo(coors.x, coors.y);
                  this.isDrawing = true;
               },
               touchmove: function (coors) {
                  if (this.isDrawing) {
                     context.lineTo(coors.x, coors.y);
                     context.stroke();
                  }
               },
               touchend: function (coors) {
                  if (this.isDrawing) {
                     this.touchmove(coors);
                     this.isDrawing = false;
                  }
               }
            };

            // create a function to pass touch events and coordinates to drawer
            function draw(event) {

               // get the touch coordinates.  Using the first touch in case of multi-touch
               var coors = {
                  x: event.targetTouches[0].pageX,
                  y: event.targetTouches[0].pageY
               };

               // Now we need to get the offset of the canvas location
               var obj = sigCanvas;

               if (obj.offsetParent) {
                  // Every time we find a new object, we add its offsetLeft and offsetTop to curleft and curtop.
                  do {
                     coors.x -= obj.offsetLeft;
                     coors.y -= obj.offsetTop;
                  }
                  // The while loop can be "while (obj = obj.offsetParent)" only, which does return null
                  // when null is passed back, but that creates a warning in some editors (i.e. VS2010).
                  while ((obj = obj.offsetParent) != null);
               }

               // pass the coordinates to the appropriate handler
               drawer[event.type](coors);
            }

            // attach the touchstart, touchmove, touchend event listeners.
            sigCanvas.addEventListener('touchstart', draw, false);
            sigCanvas.addEventListener('touchmove', draw, false);
            sigCanvas.addEventListener('touchend', draw, false);

            // prevent elastic scrolling
            sigCanvas.addEventListener('touchmove', function (event) {
               event.preventDefault();
            }, false); 
         }
         else {

            // start drawing when the mousedown event fires, and attach handlers to
            // draw a line to wherever the mouse moves to
            $("#canvasSignature").mousedown(function (mouseEvent) {
               var position = getPosition(mouseEvent, sigCanvas);

               context.moveTo(position.X, position.Y);
               context.beginPath();

               // attach event handlers
               $(this).mousemove(function (mouseEvent) {
                  drawLine(mouseEvent, sigCanvas, context);
               }).mouseup(function (mouseEvent) {
                  finishDrawing(mouseEvent, sigCanvas, context);
               }).mouseout(function (mouseEvent) {
                  finishDrawing(mouseEvent, sigCanvas, context);
               });
            });

         }
      }

      // draws a line to the x and y coordinates of the mouse event inside
      // the specified element using the specified context
      function drawLine(mouseEvent, sigCanvas, context) {

         var position = getPosition(mouseEvent, sigCanvas);

         context.lineTo(position.X, position.Y);
         context.stroke();
      }

      // draws a line from the last coordiantes in the path to the finishing
      // coordinates and unbind any event handlers which need to be preceded
      // by the mouse down event
      function finishDrawing(mouseEvent, sigCanvas, context) {
         // draw the line to the finishing coordinates
         drawLine(mouseEvent, sigCanvas, context);

         context.closePath();

         // unbind any events which could draw
         $(sigCanvas).unbind("mousemove")
                     .unbind("mouseup")
                     .unbind("mouseout");
      } 
```

谢谢，沃登克里夫

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-13T20:49:45.110

在第一次触摸时锚定笔向下点，然后在下一次触摸的任何地方画一条从第一次触摸到新触摸的直线。在新触摸上方有一个浮动复选标记以接受新行。如果未选中复选标记并且再次触摸，则删除前一行，绘制新行，并显示另一个复选标记以保存新行。在原始落笔点上方提供 (x) 以取消画线工具。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-13T20:51:09.493

直线工具和铅笔工具的区别在于铅笔尽可能多地绘制点，并将它们与（可能平滑的）线段连接起来。直线工具将少量线与相对较大的线段连接起来。

一种选择是让铅笔工具在手指触摸屏幕时留下点。然后线条工具从一个点到另一个点绘制。或者，如果您点击并滑动，线条工具可以将从触摸点到拖动点的线用橡皮筋绑起来，然后保留触摸解除前的最后一个点。

# iphone - UITextView 的自定义委托

> ID：11023030
> 
> 赞同：1
> 
> 时间：2012-06-13T20:46:19.960
> 
> 标签：iphone, objective-c, ios, uitextview, uitextviewdelegate

我是 UITextView 的子类，并且我得到了它的工作，但我还想在调用 UITextView 委托方法时做一些额外的工作。这是我到目前为止所拥有的。

ThanaaTextView.h

```
#import <UIKit/UIKit.h>

#import "ThaanaDelegate.h"

@interface ThaanaTextView : UITextView  {

    @private
    ThaanaDelegate * _thaanaDelegate;

} 
```

ThanaaTextView.m

```
#import "ThaanaTextView.h"

@implementation ThaanaTextView

- (id)initWithFrame:(CGRect)frame
{
    self = [super initWithFrame:frame];
    if (self) {
        // Initialization code
       //do some extra stuff to textview
       //set delegate
       self.delegate = _thaanaDelegate;

    }
    return self;
}

}

@end 
```

这是我的代表课

ThaanaDelegate.h

```
 #import <UIKit/UIKit.h>
 #import <Foundation/Foundation.h>

@interface ThaanaDelegate : NSObject <UITextViewDelegate> {

    NSMutableArray* _lines;
}

   +(NSString*) reverseText:(NSString*) text withFont:(UIFont*) font carretPosition:(NSRange*) cpos Lines:(NSMutableArray*) lines Bounds:(CGRect) bounds;
-(void) setText:(NSString*) txt textview:(UITextView *)textView;

@end 
```

ThaanaDelegate.m

```
 -(BOOL) textView:(UITextView*) textView shouldChangeTextInRange:(NSRange) range replacementText:(NSString*) text {
    //delegate method i want to do things in

    return NO;
}

-(void) setText:(NSString*) txt textview:(UITextView *)textView {

    //stuff
    return txt;
} 
```

它编译并运行没有错误。但从不调用委托函数。我错过了什么。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-13T20:49:12.873

当您初始化 ThanaTextView 时，尚未设置委托。

```
self.delegate = _thaanaDelegate; 
```

_thaanaDelegate 此时为零。因此，您将其设置为零。

编辑：

```
ThaanaTextView *ttv = [[ThaanaTextView alloc] initWithFrame:textViewFrame];
ttv.delegate = someDelegateHere; 
```

# list - 复制列表对象值不参考

> ID：11023035
> 
> 赞同：-1
> 
> 时间：2012-06-13T20:46:38.183
> 
> 标签：list, ref

我正在尝试创建一个新的列表对象。我将新对象设置为旧的现有对象。

```
List<string> names = new List<string>();
names = olderList; 
```

我遇到的问题是，当 oldList 更改时，名称列表指向 oldList ，名称也会更改。我尝试使用 foreach 复制值，但它仍然在做同样的事情，参考 oldList。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-13T20:56:56.723

当您在 Java 中进行分配时，您复制的是参考，而不是内容。因此，names 将指向与 oldList 相同的内存地址。

当您复制所有值时，您会执行相同的操作 - 您正在为名称列表分配另一个对存储在 oldList 中的每个字符串的引用。

可能解决您的问题的一个想法是使用 foreach 但不是添加每个元素，而是创建一个新字符串，它是旧字符串的副本。它会是这样的：

```
names=new List<String>();
foreach (String s: olderList) {
  names.add(new String(s));
} 
```

[在Oracle 的参考站点](http://docs.oracle.com/javase/1.5.0/docs/api/java/lang/String.html#String%28java.lang.String%29)检查我使用的构造函数及其含义。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-13T21:04:09.873

您必须创建一个新列表并克隆每个元素。如果你打电话

```
olderList.clone() 
```

它会给你一个浅拷贝（即一个引用第一个列表对象的新列表）。你必须这样做：

```
for(String name : olderList){
    newList.add(name.clone());
} 
```

参考：java api [Cloneable](http://docs.oracle.com/javase/6/docs/api/java/lang/Cloneable.html)，[Object.clone()](http://docs.oracle.com/javase/6/docs/api/java/lang/Object.html#clone%28%29)

# continuous-integration - 在持续集成 (CCNET) 期间交换参考版本

> ID：11023036
> 
> 赞同：1
> 
> 时间：2012-06-13T20:46:40.640
> 
> 标签：continuous-integration, cruisecontrol.net

我正在带领一个 4 人团队构建一个针对 32 位和 64 位机器的应用程序。我们面临的挑战之一是，在 64 位机器上构建（以及部署和单元测试）时，我们使用的第 3 方 DLL 之一需要是 64 位版本，当我们在上运行测试套件时一台 32 位机器，它需要是 32 位版本。

有没有办法以自动化的方式管理这些引用的版本？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-14T05:16:36.757

您需要在每个项目中创建一个新配置：一个用于 32 位，一个用于 64 位。在每个项目中，在此配置上调整对每个第三方程序集的引用：

```
<Reference Include="ThirdPartyx86.dll" Condition="'$(Configuration)' == 'Debug32'" />
<Reference Include="ThirdPartx64.dll" Condition="'$(Configuration)' == 'Debug64'" /> 
```

每个配置都有一个名称。您将配置名称从 CCNet 传递给 MSBuild：

```
MSBuild.exe /p:Configuration=Debug32
MSBuild.exe /p:Configuration=Debug64 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-14T05:46:58.903

或使用 $(Platform) 属性。
例如 ($Platform ) == 'x86' 或 ($Platform ) == 'x64'

# jquery - JQuery mobile不加载ajax链接

> ID：11023039
> 
> 赞同：0
> 
> 时间：2012-06-13T20:46:44.827
> 
> 标签：jquery, jquery-mobile

我在加载时成功运行的 javascript 文件中创建一个链接。我遇到的问题是，当有人单击链接时，JQM 不会使用 AJAX 加载它，而是将其加载到新页面中。我不明白为什么会这样。

这是链接的 HTML：

```
boxText.innerHTML = "<a href='../home-details/index.php?id=" + home_id + "' class='infowindow'>" + address + "<div class='infowindow-arrow'></div></a>"; 
```

以下是页面流程：索引页面 -> 加载页面时呈现标记的地图页面。标记具有包含链接作为内容的信息窗口。这些也会在创建标记时加载。信息窗口链接不使用 AJAX 加载。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-13T21:12:13.330

您可以发布您在检查员中看到的内容吗？jQuery 将动态应用类等，如文档中所述：

[http://jquerymobile.com/demos/1.1.0/docs/pages/page-links.html](http://jquerymobile.com/demos/1.1.0/docs/pages/page-links.html)

> **没有 Ajax** 的链接指向其他域或具有 rel="external"、data-ajax="false" 或目标属性的链接将不会使用 Ajax 加载。相反，这些链接将导致整个页面刷新而没有动画过渡。两个属性（rel="external" 和 data-ajax="false"）具有相同的效果，但语义不同：链接到另一个站点或域时应使用 rel="external"，而 data-ajax=" false" 对于简单地选择域中的页面不通过 Ajax 加载很有用。由于安全限制，框架总是选择链接到外部域的 Ajax 行为。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-13T21:37:50.510

仅动态创建的链接会完全重新加载吗？

如果不是，那么 jQM 正在使用 AJAX。您在 url 栏中看到了新地址，因为您可能正在使用支持 pushstate 方法的浏览器（webkit、mozilla）。jQM 是 AJAX 加载页面，然后在 URL 栏中更改地址而不实际加载页面。

您可以通过在 IE9 中打开您的页面来检查这一点。它还不支持 pushstate，所以你会得到你期望的 hashtag url。

您可以通过将 jQM 选项设置为 来更改此`pushStateEnabled`行为`false`。

# android - 尝试将值插入数据库，但 insert() 失败

> ID：11023046
> 
> 赞同：0
> 
> 时间：2012-06-13T20:47:03.097
> 
> 标签：android, sqlite

所以，我有一个我正在制作的应用程序，可以简单地描述为一个任务列表。我正在使用 SQLite 数据库来存储所有数据。我在数据库方面遇到了各种问题，但让我们在这里坚持这个更紧迫的问题。在测试运行中，我做了一个基本的输入测试，得到了这个 logcat 条目：

```
06-13 01:49:33.868: E/Database(482): Error inserting ISCHECKED=0 NOTE=This is a test. _id=0 TASK=Hello World
06-13 01:49:33.868: E/Database(482): android.database.sqlite.SQLiteConstraintException: error code 19: constraint failed
06-13 01:49:33.868: E/Database(482):    at android.database.sqlite.SQLiteStatement.native_execute(Native Method)
06-13 01:49:33.868: E/Database(482):    at android.database.sqlite.SQLiteStatement.execute(SQLiteStatement.java:61)
06-13 01:49:33.868: E/Database(482):    at android.database.sqlite.SQLiteDatabase.insertWithOnConflict(SQLiteDatabase.java:1582)
06-13 01:49:33.868: E/Database(482):    at android.database.sqlite.SQLiteDatabase.insert(SQLiteDatabase.java:1426)
06-13 01:49:33.868: E/Database(482):    at com.mowdownDevelopments.nagTasks.NagTasksDatabaseHelper.addTask(NagTasksDatabaseHelper.java:68)
06-13 01:49:33.868: E/Database(482):    at com.mowdownDevelopments.nagTasks.NagTasksAddTaskFragment.save(NagTasksAddTaskFragment.java:65)
06-13 01:49:33.868: E/Database(482):    at com.mowdownDevelopments.nagTasks.NagTasksAddTaskFragment.onOptionsItemSelected(NagTasksAddTaskFragment.java:54)
06-13 01:49:33.868: E/Database(482):    at com.actionbarsherlock.app.SherlockFragment.onOptionsItemSelected(SherlockFragment.java:67)
06-13 01:49:33.868: E/Database(482):    at android.support.v4.app.FragmentManagerImpl.dispatchOptionsItemSelected(FragmentManager.java:1919)
06-13 01:49:33.868: E/Database(482):    at android.support.v4.app.FragmentActivity.onMenuItemSelected(FragmentActivity.java:357)
06-13 01:49:33.868: E/Database(482):    at com.actionbarsherlock.app.SherlockFragmentActivity.onMenuItemSelected(SherlockFragmentActivity.java:288)
06-13 01:49:33.868: E/Database(482):    at com.actionbarsherlock.ActionBarSherlock.callbackOptionsItemSelected(ActionBarSherlock.java:586)
06-13 01:49:33.868: E/Database(482):    at com.actionbarsherlock.internal.ActionBarSherlockCompat.onMenuItemSelected(ActionBarSherlockCompat.java:526)
06-13 01:49:33.868: E/Database(482):    at com.actionbarsherlock.internal.view.menu.MenuBuilder.dispatchMenuItemSelected(MenuBuilder.java:738)
06-13 01:49:33.868: E/Database(482):    at com.actionbarsherlock.internal.view.menu.MenuItemImpl.invoke(MenuItemImpl.java:148)
06-13 01:49:33.868: E/Database(482):    at com.actionbarsherlock.internal.view.menu.MenuBuilder.performItemAction(MenuBuilder.java:879)
06-13 01:49:33.868: E/Database(482):    at com.actionbarsherlock.internal.view.menu.ActionMenuView.invokeItem(ActionMenuView.java:510)
06-13 01:49:33.868: E/Database(482):    at com.actionbarsherlock.internal.view.menu.ActionMenuItemView.onClick(ActionMenuItemView.java:145)
06-13 01:49:33.868: E/Database(482):    at android.view.View.performClick(View.java:2485)
06-13 01:49:33.868: E/Database(482):    at android.view.View$PerformClick.run(View.java:9080)
06-13 01:49:33.868: E/Database(482):    at android.os.Handler.handleCallback(Handler.java:587)
06-13 01:49:33.868: E/Database(482):    at android.os.Handler.dispatchMessage(Handler.java:92)
06-13 01:49:33.868: E/Database(482):    at android.os.Looper.loop(Looper.java:123)
06-13 01:49:33.868: E/Database(482):    at android.app.ActivityThread.main(ActivityThread.java:3683)
06-13 01:49:33.868: E/Database(482):    at java.lang.reflect.Method.invokeNative(Native Method)
06-13 01:49:33.868: E/Database(482):    at java.lang.reflect.Method.invoke(Method.java:507)
06-13 01:49:33.868: E/Database(482):    at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:839)
06-13 01:49:33.868: E/Database(482):    at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:597)
06-13 01:49:33.868: E/Database(482):    at dalvik.system.NativeStart.main(Native Method) 
```

我看不出有什么问题。我将任务添加到数据库的方法非常简单：

```
public void addTask(String title, String notes)
{
    SQLiteDatabase db = getWritableDatabase();
    int newestID = getNewTaskId(db);
    ContentValues values = new ContentValues();
    values.put("_id", newestID);
    values.put("TASK", title);
    values.put("NOTE", notes);
    values.put("ISCHECKED", 0);
    db.insert("TASKS", null, values);
    db.close();
}
@Override
public void onCreate(SQLiteDatabase db) {
    db.execSQL("CREATE TABLE IF NOT EXISTS TASKS (_id INTEGER PRIMARY KEY, TASK TEXT, NOTE TEXT, ISCHECKED INTEGER);");
}
public int getNewTaskId(SQLiteDatabase db)
{
    Cursor c = db.rawQuery("SELECT MAX(_id) FROM TASKS", null);
    int columnID = c.getColumnIndex(ID);
    if (columnID == -1)
    {
        return 0;
    } else {
        return c.getInt(columnID) +1;
    }
} 
```

谁能帮我吗？我看不到“约束失败”的地方。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-13T20:52:01.580

您正在获取 MAX id，这意味着该 id 已经存在。我认为您在返回之前忘记增加 MAX id。这是假设您的 getNewAlarmId 与 getNewTaskId 几乎完全相同

```
public int getNewAlarmId(SQLiteDatabase db)
{
    Cursor c = db.rawQuery("SELECT MAX(_id) FROM ALARMS", null);
    int columnID = c.getColumnIndex(ID);
    if (columnID == -1)
    {
        return 0;
    } else {
        return c.getInt(columnID) + 1;
    }
} 
```

**更新**

尝试将值硬编码为 10。它是否至少运行一次，然后中断？如果是这样，我认为它可能是您的光标。你没有像 Squonk 建议的那样调用 moveToFirst

# javascript - 如何使用 AJAX 从不同页面获取 div 的 html？

> ID：11023051
> 
> 赞同：11
> 
> 时间：2012-06-13T20:47:15.653
> 
> 标签：javascript, jquery, ajax

如何获取位于不同站点上的某个 html 元素的 html？

解决方案：

```
$.ajax({
url: 'somefile.html',
success: function(data) {
    data=$(data).find('div#id');
    $('#mydiv').html(data);
    alert('Done.');
 }
}); 
```

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-06-13T20:49:50.850

您可以将[$.load](http://api.jquery.com/load/)与附加容器一起使用

> .load() 方法与 $.get() 不同，它允许我们指定要插入的远程文档的一部分。

```
$('#result').load('ajax/test.html #container'); 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-06-13T20:59:58.233

对 php 或任何其他文件进行 ajax 调用，使用 CURL 或其他工具抓取您想要的页面并提取 div 并回显它，然后当您返回 html 时，只需将其放入页面中的 div 中

```
 $.ajax({
    url: 'somefile.html',
    success: function(data) {
                    data=$(data).find('div#id');
        $('#mydiv').html(data);
        alert('Done.');
     }
    }); 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2012-06-13T20:50:53.810

干得好：

```
$('#div_id_in_your_page').load('ajax_page.html #required_div'); 
```

上课：

```
$('.div_class_in_your_page').load('ajax_page.html #required_div'); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-06-13T20:52:05.480

一种方法是：

*   向服务器端脚本发送 ajax 调用

*   此脚本获取远程页面并返回 HTML 作为响应。（一般首选 JSON）

*   您的页面终于可以访问 html。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-06-13T20:52:04.370

你也可以这样使用。

```
$.ajax({
   url:"page2.html",
   success:function(response){
      $("#currentDIV").html(response);
   },error:function(){
      alert("error");
   }
}); 
```

# database - 依赖 ODBC 连接的前端访问替代方案？

> ID：11023053
> 
> 赞同：0
> 
> 时间：2012-06-13T20:47:24.783
> 
> 标签：database, ms-access, vba, odbc

我的任务是获取一个依赖于 ODBC 连接的 Access 2007 应用程序，并与具有相同 ODBC 连接的其他机构共享它。如果我没有很好地传达这一点，请原谅我。我不是开发人员，但自从我完成这个项目以来，我一直负责这个项目。我敢肯定，以前从未发生过……

首先，我将给出我们结构的布局：

*   我在一所大学工作，该大学通过 ODBC 与其他 31 所学校共享数据库。
*   维护所有校园数据库的系统办公室只允许我们通过公共接入点服务器 (CAP) 的 VPN 访问只读数据，然后通过 ODBC 连接
*   CAP 服务器（唯一可以链接到 ODBC 的位置）具有 Microsoft Office，并且无法访问 Internet。
*   每个校区都有一个唯一的 ODBC 连接，当 accdb 放置在其 CAP 服务器上时，需要重新链接表。
*   每次启动 Access 时，用户还必须登录到 ODBC 连接。
*   CAP 服务器可以在网络驱动器上读写，但反之则不行。
*   我们可以放心地假设 CAP 服务器上不能安装其他软件，但可以放置文件（这就是我们可以分发 accdb 文件的原因）

Access 应用程序从 ODBC 中提取学生课程活动，并应用逻辑来确定学生是否/何时停止参加所有课程。此时，这个逻辑是一系列与宏绑定的查询。然后数据库生成学生的报告（包含来自 ODBC 的更多信息）。有一个活动的跟踪过程，因此可以从报告中清除记录，除非发生更改，这将导致记录与更改一起重新出现。这也需要在本地存储数据，因为 ODBC 是只读的。VBA 也支持各种形式和报告。

目标是打包软件并分发到所有其他校区。到目前为止，我们通过简单地向他们发送 accdb 文件并拥有一个启动链接表管理器的按钮来完成小型分发。初始分发后，我将继续开发软件并分发更新，必须保留本地存储在 accdb 中的数据。

问题是我只有 Access 方面的经验和足够的 VBA 知识，以便能够在解决方案出现时单独使用谷歌搜索。

我的问题可能很简单，也可能很复杂，我不确定。基本上我想知道除了我一直在做的事情之外是否有更合适的方法：发送 accdb 并且用户复制并粘贴唯一需要结转的表。

**澄清**

将 accdb 转换为每个分发版本的可执行文件是否可行？当 ODBC 需要重新连接并且 ODBC 在校园之间是唯一的时，这是否可能？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-14T01:41:20.660

您可以添加一个重新链接按钮，该按钮循环浏览数据库中的表并重新连接它们

```
dim tdf as tabledef
dim db as database
db = currentdb
db.tabledefs.refresh
for each tdf in db.tabledefs
    with tdf
        if len(.connect)>0 then ' this is a table that has a connect string
           if left$(.connect)="ODBC" then  ' this is an ODBC connection
                .connect = newconnectstring
                .refreshlink
           end if
        end if
    end with
next 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-14T12:30:51.657

每次升级都要求最终用户将存储本地数据的表从一个 accdb 文件复制并粘贴到另一个文件中，最终会导致数据丢失——有人会在升级过程中忘记这一步。

更可靠的方法是创建第二个 accdb 数据库。将其命名为“YourAppName_data.accdb”或类似的名称，并将其放置在与前端客户端相同的目录中或名为“Data”的子目录中。将“数据”accdb 文件中的表链接到前端客户端。

您可以将启动代码添加到可以尝试通过在已知位置查找数据 accdb 文件来自动重新链接这些表的前端客户端。如果程序找不到它，您可以提示用户为您找到它。顺便说一句，您也应该能够对 ODBC 表执行类似的操作。您可以使用类似于 ChrisPadgham 在此步骤的答案中所写的代码。

您此时所做的是将应用程序的数据（只读数据和每个学校需要能够自己维护的数据）与应用程序前端（表单、查询、逻辑和报告）。

这将使向前端客户端分发更新变得更加容易。最终用户只需将前端客户端复制到正确的目录，覆盖目录中的现有文件并运行程序即可。

这将起作用，但它仍然不如它可能的强大，因为任何有权访问 CAP 服务器的人都可能会从服务器上删除数据文件。（希望每个学校都定期备份这台机器，以防止数据丢失。）

正如 HansUp 建议的那样，最终可能通过将存储在 Access accdb 文件中的数据移动到每个位置的 SQL Server 数据库来为您提供更好的服务，这将更好地控制谁可以访问信息，并且在保护方面会更好一些当服务器运行时，SQL Server 数据库文件在机器上“锁定”后的数据。（这将防止有人意外删除文件）。SQL Server 的缺点是有一个学习曲线，它需要在每所学校安装在 CAP 服务器或 CAP 服务器可以在网络上访问的其他机器上。一旦您有更好的信息可供使用，这可能会随着时间的推移而努力。

# arrays - 循环声音动作脚本 Flash

> ID：11023059
> 
> 赞同：0
> 
> 时间：2012-06-13T20:48:42.390
> 
> 标签：arrays, flash, audio, loops

我想知道是否有人可以帮助我使用 Flash 中的动作脚本。

当我单击按钮时，我想要一些不同的按钮并播放不同的声音循环，但是由于音乐旋律，每个循环都必须在另一个循环完成时开始。谁能帮我？

谢谢

特蕾莎

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-14T09:34:36.023

通过在 AS3 中使用 SoundChannel 类，您可以获得 addEventListener - Event.SOUND_COMPLETE，它会通知您声音完成，然后您可以播放下一个声音

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-03-09T18:33:15.837

好吧，我假设您要播放与按下的最后一个按钮相关的声音，而不是一起播放许多声音。

所以你有一个全局声音变量，你可以在按下按钮时改变它

```
var sound:Sound=new Sound(new URLRequest("music.mp3"));
var soundChannel:SoundChannel=new SoundChannel();
soundChannel=sound.play();
soundChannel.addEventListener(Event.SOUND_COMPLETE,loop_Sound);
function loop_Sound(e:Event){
      soundChannel=sound.play();
      //I know you don't need to add the listener again to the sound channel 
      //but this is something i just do
      soundChannel.addEventListener(Event.SOUND_COMPLETE,loop_Sound); 
}
//call this function when the button is pressed
//you could name the button name as the sound file's name 
//and use e.currenttarget.name or something
function change_Sound(e:MouseEvent){
   sound=new Sound(new URLRequest("music2.mp3"));

} 
```

这将在按下按钮时加载声音，但仅在当前声音完成播放时播放，如果在播放时未按下按钮，它将循环播放当前声音。祝你好运！

# powershell - 在函数中引用一个变量同时导出

> ID：11023062
> 
> 赞同：1
> 
> 时间：2012-06-13T20:49:11.677
> 
> 标签：powershell

以下脚本：

```
cls
function test_me([string]$testVar, $my_array)
{
    Write-Host $testVar
}

$test_array = "a","b"
test_me "z", $test_array 
```

产生以下结果：

```
z System.Object[] 
```

我只想引用 $testVar

为什么*System.Object[]*会返回到 Write-Host？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-13T21:21:37.713

此错误可能与 PowerShell 一样古老...您调用类似方法的函数，但它不会那样工作，请改用以下方法：

```
test_me 'z' $test_array 
```

HTH 巴特克

# python - 如何在长期工作的消费者中提供与 Pika 的并发性？

> ID：11023071
> 
> 赞同：3
> 
> 时间：2012-06-13T20:49:50.533
> 
> 标签：python, concurrency, rabbitmq, pika

简短版：如何防止在远程过程调用情况下阻塞 Pika？

长版：

Pika 示例都没有演示我的用例。

我有一个 Tornado 服务器，它通过 AMQP（RabbitMQ、Pika）与其他进程/机器通信。这些其他进程的定义不是很明确，但它们在大多数情况下会返回数据（请参阅[RabbitMQ 网站上的 RPC 示例](http://www.rabbitmq.com/tutorials/tutorial-six-python.html)）。有时，一个进程可能需要花费极长的时间来处理大量信息，但它不应该完全阻止较小的请求被该进程处理。或者，远程服务器可能因为发送了 Web 请求而阻塞。把它想象成一个 Web 服务器，但是使用 AMQP 而不是 HTTP。

由于 Pika 文档声称它不是线程安全的，因此我无法将连接传递给多个线程（或进程，就此而言）。我想要做的是启动一个新进程，并将一个套接字事件（用于该程序的管道）添加到 Pika IOLoop，就像我可以使用 Tornado 一样。Pika IOLoop 与 Tornado IOLoop 有很大不同，它似乎不支持添加多个处理程序；它似乎在一个套接字上使用一个“轮询器”进行操作。

我想避免这个包需要 Tornado 包，因为我只会使用 IOLoop。这不是不可能的，但我想看看我的其他选择是什么，或者是否可以通过以某种方式连接多个 Pika IOLoops/Pollers 来解决我的问题。RabbitMQ 的文档说，工人通常可以通过增加更多来“扩大规模”。我想避免为传入的每个请求创建连接（如果它们快速传入）。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-19T20:36:28.733

根据您的描述，我相信您不幸要么需要不同的通信模型，要么需要多个 Pika IOLoops/Pollers/Redundant Connections。

从文档和其他站点听起来，Pika 中的 RPC 始终是一个阻塞语句，无法在线程之间传递。请参阅[http://www.rabbitmq.com/tutorials/tutorial-six-python.html](http://www.rabbitmq.com/tutorials/tutorial-six-python.html)，其中作者指出，一旦您实际调用 ioloop，Pika 中的 RPC 就会固有地阻塞。

```
"When in doubt avoid RPC. If you can, you should use an asynchronous pipeline - instead of RPC-like blocking" 
```

如果你想在一个连接完成之前继续在同一个连接上发送多个 RPC 调用，你需要一个不同的异步模型。完成之前对同一连接的多个 RPC 调用不是 RPC 模型的通常实现，尽管它在技术上并未被禁止 ( [http://pic.dhe.ibm.com/infocenter/aix/v6r1/index.jsp?topic= %2Fcom.ibm.aix.progcomm%2Fdoc%2Fprogcomc%2Frpc_mod.htm](http://pic.dhe.ibm.com/infocenter/aix/v6r1/index.jsp?topic=%2Fcom.ibm.aix.progcomm%2Fdoc%2Fprogcomc%2Frpc_mod.htm)）。我不认为 Pika 使用此模型进行操作，尽管它确实通过回调提供了异步支持（我认为不是您要寻找的）。

如果您只是想轻松地动态生成新连接，您可以在连接上使用线程或进程包装器，您可以在另一个上下文中创建和阻塞 RPC，然后推送到主线程可以的公共队列监视器。Tornado 可能会给你这个，但我同意这有点矫枉过正，并且制作这样一个连接包装器不应该那么困难，因为我在不到 100 行 Python 中为其他 I/O 操作做了类似的事情（请参阅线程包装器版本的队列包）。我认为您已经看到了这种可能性，尽管基于您对多个 IOLoops 的讨论。

# php - 将复选框数组添加到 kohana orm 验证

> ID：11023078
> 
> 赞同：0
> 
> 时间：2012-06-13T20:50:16.327
> 
> 标签：php, validation, kohana, kohana-orm

通过 orm 将复选框值添加到 db 时遇到问题

适用于普通字段，但如果在允许多个选项的复选框问题上选择了多个复选框，则不会

这是表格位

```
<?php echo Form::label('first_name', 'First Name')?><br />
<?php echo Form::input('first_name', $profile->first_name, array('class'=>'inputbox')); ?><br />

<?php echo Form::label('last_name', 'Last Name')?><br />
<?php echo Form::input('last_name', $profile->last_name, array('class'=>'inputbox')); ?><br />

Favorite Genres: 
<label><input type="checkbox" value="Horror"  name="genres[]"  />
<strong>Horror</strong></label><br />
<label><input type="checkbox" value="Thriller"  name="genres[]"  />
<strong>Thriller</strong></label><br /> 
```

这是控制器位

```
if ($_POST) {
    if ($profile->values($_POST)->check()) {
        $profile->user_id = $user;
        $profile->save();
    }
} 
```

这是模型位

```
protected $_rules = array(

'first_name' => array(
    'not_empty' => NULL,

),

'last_name' => array(
    'not_empty' => NULL,

),

); 
```

仅在选择多个复选框时不工作，我会得到此错误

> Database_Exception [1241]：操作数应包含 1 列

不确定最好的方法。我应该序列化还是内爆？在哪里做这个？

我想在将来构建基本搜索表单以使用此列搜索“喜欢”值。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-14T11:00:48.607

这是一个`DB`例外，而不是`Validation`. 对于这种情况，您应该使用 ORM 关系：

```
class Model_Profile extends ORM {

   protected $_has_many = array(
       // profile has and belongs to many genres
       'genres'  => array(
            'through' => 'profiles_genres', // pivot table name
       ),
   );
} 
```

然后更改当前配置文件的流派，如下所示：

```
try 
{
   $profile->check();
   $profile->save();
   // now replace old genres with a new list
   // clear genres
   $profile->remove('genres');
   foreach($this->request->post('genres') as $genre) 
   {
       $genre = ORM::factory('genre')->where('name', '=', $genre);
       if ($genre->loaded()) 
       {
           $profile->add('genres', $genre);
       }
   }
}
catch (Validate_Exception) 
{
    // wrong input
} 
```

注意不是`genres`分隔表，不是`profiles`列。您还需要一个`profiles_genres`带有`profile_id`和`genre_id`列的数据透视表。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-14T11:04:53.673

您应该创建一个流派表和模型，并为流派和配置文件创建一个数据透视表：

```
CREATE TABLE IF NOT EXISTS `genres` (
  `id` int(11) UNSIGNED NOT NULL AUTO_INCREMENT,
  `name` varchar(100) NOT NULL,
  PRIMARY KEY  (`id`),
  UNIQUE KEY `uniq_name` (`name`)
) ENGINE=InnoDB  DEFAULT CHARSET=utf8;

CREATE TABLE IF NOT EXISTS `genres_profiles` (
  `profile_id` int(10) UNSIGNED NOT NULL,
  `genre_id` int(10) UNSIGNED NOT NULL,
  PRIMARY KEY  (`profile_id`,`genre_id`),
  KEY `fk_genre_id` (`genre_id`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8; 
```

请注意，您不需要为数据透视表创建 ORM 模型。
您可以在[官方文档中找到更多信息](http://kohanaframework.org/3.2/guide/orm/relationships#hasmany-through)

# c# - c# int.tryParse 可以为空的ints如何？

> ID：11023081
> 
> 赞同：1
> 
> 时间：2012-06-13T20:50:22.437
> 
> 标签：c#, asp.net, null, int

我有时需要将 int 的值设置为 null，有时需要设置为实际值。问题是我需要将该值存储在 SAME 变量中，而不是创建另一个。

```
int? year;
if(something)
   year = null;
else
   int.tryParse("some string", out year); 
```

“某些字符串”始终是有效的 int，但问题是我不能在 int 上使用 int.tryParse？如何解决这个问题？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-06-13T20:52:30.367

如果你的字符串总是一个有效的整数，你应该只使用该[`Parse`](http://msdn.microsoft.com/en-us/library/system.int32.parse.aspx)方法。

```
year = int.Parse("some string"); 
```

如果它不是一个有效的整数，你会得到一个`FormatException`or `OverflowException`（不像[`TryParse`](http://msdn.microsoft.com/en-us/library/f02979c7)，它只返回`false`）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-13T20:54:09.923

您可以使用 Convert.ToInt32(year)。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-13T21:02:54.670

你可以试试这个：

```
public class NullInt
{
    public void ParseInt(string someString, ref int? someInt)
    {
        int i;

        if (int.TryParse(someString, out i))
        {
            someInt = i;
        }
    }
} 
```

并使用有点像：

```
NullInt someInt = new NullInt();
int? targetInt = null;
someInt.ParseInt("42", ref targetInt); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-13T20:53:46.507

如果“某些字符串”始终是有效的 int，那么您可以使用[System.Convert.ToInt32](http://msdn.microsoft.com/en-us/library/sf1aw27b.aspx)或[System.Int32.Parse将其转换为 int](http://msdn.microsoft.com/en-us/library/b3h1hf19.aspx)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-06-27T06:16:05.940

int.tryParse 返回一个布尔值，而不仅仅是输出值 - 你也可以这样做：

```
int year;
int? finalYear;
if(int.TryParse("some string", out year))
    finalYear = year; 
```

否则，如果“某些字符串”总是返回一个有效的 int，为什么不这样做

```
int? year = int.Parse("some string"); 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2014-11-06T14:46:05.340

```
public static class StringExtensions
{
    public static int? AsInt(this string input)
    {
        int number;
        if (int.TryParse(input, out number))
        {
            return number;
        }

        return null;
    }
} 
```

用法：`year = someString.AsInt();`

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2012-06-13T21:06:09.950

这似乎也有效：

```
int? year;
    if (something)
       year = null;
    else
    {
       int _year;
       int.TryParse(year.SelectedItem.Value, out _year);
       year = _year;
    } 
```

* * *

## 回答 #8

> 赞同：-2
> 
> 时间：2012-06-13T20:57:03.110

添加一些错误检测：

```
try
{
   year = int.Parse("some string");
}
catch()
{
   year = null;
} 
```

# javascript - 如何从手机中解读这些奇怪的 JavaScript 时间戳？

> ID：11023086
> 
> 赞同：2
> 
> 时间：2012-06-13T20:50:33.980
> 
> 标签：javascript, ios, mobile, timestamp

我维护了一个 JavaScript 库，用于测量网页加载时间 (http://github.com/lognormal/boomerang)，并将它们通过信标发送到我的服务器。它发回的一些时间是相对的 ( `end-start`)，而其他时间是绝对的 ( `new Date().getTime()`)

在大多数情况下，我看到的绝对时间戳是有意义的，并且在请求时间的几秒钟内。然后我时不时地看到一些非常荒谬的时间戳，我不知道该怎么做。这是一个示例：

```
112731879   (Safari 4 on Mac OS X 10.4.11 (PPC))
574766408   (Android 2.3.1)
6855660455  (iOS 4.2.1 on iPad)
5000        (Safari 3.1)
356902853   (Mobile Safari 4.0.4 on iOS 3.2 (iPad))
133643085   (Mobile Safari 5.0.2 on iPhoneOS 4.2.1 (iPod))
2775235876  (Mobile Safari 4.0.5 on iPhoneOS 4.1 (iPod)) 
```

虽然看起来这些主要是移动设备，但其中有一些不是。请注意，所有这些时间戳都应该是毫秒，所以最近的任何东西都应该有 13 位数字。

我已经在网上搜索过，但我要么没有很好的搜索查询，要么没有任何关于这个的内容。我已经测试了我自己的 iOS 设备并获得了 13 位数的时间戳，所以我不知道这些可能是什么。任何关于在哪里寻找或寻找什么的想法/建议将不胜感激。

我知道其中一些请求可能只是假的，但用户的其余浏览模式表明他们是网站的合法用户。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-13T21:23:53.610

这可能与 Date() 所基于的不可靠系统时钟有关吗？新的 performance.now() API 应该有助于解决此类问题（尽管我不知道这个问题在现实世界中应该有多普遍，或者为什么移动设备会受到如此巨大的影响。）

[http://gent.ilcore.com/2012/06/better-timer-for-javascript.html](http://gent.ilcore.com/2012/06/better-timer-for-javascript.html)

# ruby-on-rails - 如何获得对帖子发表评论（多态关联）的用户的 DISTINCT 列表？

> ID：11023088
> 
> 赞同：1
> 
> 时间：2012-06-13T20:50:40.317
> 
> 标签：ruby-on-rails, ruby-on-rails-3, activerecord

用户`has_many`评论。注释在`comments`表中（多态）。

```
User.where("comments.commentable_type = ? AND comments.commentable_id = ?", "Post", post.id).uniq 
```

我得到：

```
Post Load (0.4ms)  SELECT `posts`.* FROM `posts` LIMIT 1
TypeError: Cannot visit Arel::Nodes::Distinct
        from /Users/.rvm/gems/ruby-1.9.3-p125@myapp/gems/arel-3.0.2/lib/arel/visitors/visitor.rb:25:in `rescue in visit'
        from /Users/.rvm/gems/ruby-1.9.3-p125@myapp/gems/arel-3.0.2/lib/arel/visitors/visitor.rb:19:in `visit'
        from /Users/.rvm/gems/ruby-1.9.3-p125@myapp/gems/arel-3.0.2/lib/arel/visitors/to_sql.rb:133:in `visit_Arel_Nodes_SelectCore'
        from /Users/.rvm/gems/ruby-1.9.3-p125@myapp/gems/arel-3.0.2/lib/arel/visitors/mysql.rb:41:in `visit_Arel_Nodes_SelectCore'
        from /Users/.rvm/gems/ruby-1.9.3-p125@myapp/gems/arel-3.0.2/lib/arel/visitors/to_sql.rb:121:in `block in visit_Arel_Nodes_SelectStatement'
        from /Users/.rvm/gems/ruby-1.9.3-p125@myapp/gems/arel-3.0.2/lib/arel/visitors/to_sql.rb:121:in `map'
        from /Users/.rvm/gems/ruby-1.9.3-p125@myapp/gems/arel-3.0.2/lib/arel/visitors/to_sql.rb:121:in `visit_Arel_Nodes_SelectStatement'
        from /Users/.rvm/gems/ruby-1.9.3-p125@myapp/gems/arel-3.0.2/lib/arel/visitors/mysql.rb:36:in `visit_Arel_Nodes_SelectStatement'
        from /Users/.rvm/gems/ruby-1.9.3-p125@myapp/gems/arel-3.0.2/lib/arel/visitors/visitor.rb:19:in `visit'
        from /Users/.rvm/gems/ruby-1.9.3-p125@myapp/gems/arel-3.0.2/lib/arel/visitors/visitor.rb:5:in `accept'
        from /Users/.rvm/gems/ruby-1.9.3-p125@myapp/gems/arel-3.0.2/lib/arel/visitors/to_sql.rb:19:in `accept'
        from /Users/.rvm/gems/ruby-1.9.3-p125@myapp/gems/arel-3.0.2/lib/arel/visitors/bind_visitor.rb:11:in `accept'
        from /Users/.rvm/gems/ruby-1.9.3-p125@myapp/gems/activerecord-3.2.3/lib/active_record/connection_adapters/abstract/database_statements.rb:7:in `to_sql'
        from /Users/.rvm/gems/ruby-1.9.3-p125@myapp/gems/activerecord-3.2.3/lib/active_record/connection_adapters/abstract/database_statements.rb:18:in `select_all'
        from /Users/.rvm/gems/ruby-1.9.3-p125@myapp/gems/activerecord-3.2.3/lib/active_record/connection_adapters/abstract/query_cache.rb:63:in `select_all'
        from /Users/.rvm/gems/ruby-1.9.3-p125@myapp/gems/activerecord-3.2.3/lib/active_record/querying.rb:38:in `block in find_by_sql'
        from /Users/.rvm/gems/ruby-1.9.3-p125@myapp/gems/activerecord-3.2.3/lib/active_record/explain.rb:40:in `logging_query_plan'
        from /Users/.rvm/gems/ruby-1.9.3-p125@myapp/gems/activerecord-3.2.3/lib/active_record/querying.rb:37:in `find_by_sql'
        from /Users/.rvm/gems/ruby-1.9.3-p125@myapp/gems/activerecord-3.2.3/lib/active_record/relation.rb:171:in `exec_queries'
        from /Users/.rvm/gems/ruby-1.9.3-p125@myapp/gems/activerecord-3.2.3/lib/active_record/relation.rb:160:in `block in to_a'
        from /Users/.rvm/gems/ruby-1.9.3-p125@myapp/gems/activerecord-3.2.3/lib/active_record/explain.rb:33:in `logging_query_plan'
        from /Users/.rvm/gems/ruby-1.9.3-p125@myapp/gems/activerecord-3.2.3/lib/active_record/relation.rb:159:in `to_a'
        from /Users/.rvm/gems/ruby-1.9.3-p125@myapp/gems/activerecord-3.2.3/lib/active_record/relation.rb:496:in `inspect'
        from /Users/.rvm/gems/ruby-1.9.3-p125@myapp/gems/railties-3.2.3/lib/rails/commands/console.rb:47:in `start'
        from /Users/.rvm/gems/ruby-1.9.3-p125@myapp/gems/railties-3.2.3/lib/rails/commands/console.rb:8:in `start'
        from /Users/.rvm/gems/ruby-1.9.3-p125@myapp/gems/railties-3.2.3/lib/rails/commands.rb:41:in `<top (required)>'
        from script/rails:6:in `require' 
```

没有`.uniq`，它可以工作，除非我得到重复，因此，我可以尝试：

```
User.where("comments.commentable_type = ? AND comments.commentable_id = ?", "Post", post.id).to_a.uniq 
```

它会起作用......但我不喜欢那种方法！还有其他方法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-10-02T18:46:18.030

这是与您面临的相同问题相关的 github 问题的[链接。](https://github.com/rails/rails/issues/7399)

如果您使用的是 rails 4，请尝试使用`.distinct`而不是`.uniq`.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-15T20:45:29.070

重新启动 rails 服务器会话。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-14T16:38:18.930

我记得有类似的问题，你可以做几件事。首先使用 SQL distinct（我知道它应该类似于 uniq）。其次（我知道这不是最好的方法），您可以将其全部选中，然后使用常规数组 uniq 函数来过滤它，就像您过滤普通数组一样（这只是为了让事情顺利进行）。

# android - 从 Corona/Lua 中的移动设备照片库访问照片属性？

> ID：11023095
> 
> 赞同：0
> 
> 时间：2012-06-13T20:51:16.447
> 
> 标签：android, ios, lua, coronasdk

使用 Corona/Lua，是否可以从具有特定属性的设备（android、iOS）照片库中选择照片？例如，只选择文件名中包含特定字符串的图片，或者只选择一定大小的图片。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-31T13:35:59.700

不。

Corona 还没有对照片库做太多，最新版本是第一个或多或少甚至可以写入照片库的版本，根本不支持像这样的复杂读取（可能是因为 iOS 和 Android 有非常不同的照片库，因此这当然不容易编码，并且它不像队列中的其他功能那样重要）

# jquery - $.tpl 不是函数，$(".timepicker").timepickr 不是函数

> ID：11023097
> 
> 赞同：1
> 
> 时间：2012-06-13T20:51:24.667
> 
> 标签：jquery, jquery-ui, timepicker

使用 jQuery timepickr：[http](http://archive.plugins.jquery.com/project/jquery-timepickr) ://archive.plugins.jquery.com/project/jquery-timepickr 包含了这些文件：

```
jquery-1.7.1.min.js
jquery-ui-1.8.21.custom.min.js
ui.timepickr.js 
```

并得到这个错误。如何解决这个问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-13T21:08:06.483

## 您缺少依赖项。

*   jquery.utils.js
*   jquery.strings.js
*   jquery.ui.js

写在它的源代码中。许可后

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-13T20:53:25.447

如果`$.fn.timepickr`未定义，请确保您没有包含另一个使用 的库`$`，例如 jQuery.

# android - 通过另一个类编辑文本视图

> ID：11023098
> 
> 赞同：0
> 
> 时间：2012-06-13T20:51:26.913
> 
> 标签：android, android-widget

我正在尝试在我的服务器计算机和我的 android 智能手机之间创建一个通信系统。我终于得到了很好的工作成果。但是，我对 android 视图有疑问。具体来说，我试图从一个没有扩展的类中使用文本视图的方法“.setText()”。我将我的 textview 对象传递给该类，但方法“textview.setText()”可以正常工作，并且不会对 UI 产生任何影响。让我把代码直接写下来，我想你会更清楚地理解并有机会尝试代码。

```
public class NetworkingActivity extends Activity {

    public static String message;
    public static EditText editext;
    public static TextView textview;
    private Connector connector;

    /** Called when the activity is first created. */
    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.main);
    }

    public void buttonClicked(View v){
        editext = (EditText) findViewById(R.id.editText1);
        textview = (TextView) findViewById(R.id.textview);
        message = editext.getText().toString();

        connector = new Connector(NetworkingActivity.this);
        connector.start();

    }

    public void yenile(String respond){
        textview.setText(respond);
        editext.setText("");

    }

    public void yenileClicked(View v){
        textview.setText(Connector.respond);
        editext.setText("");

    }

    public static class Connector extends Thread{
        private static final int PORT = 3588;
        private static final String IpAddress = "XXX.XXX.XXX.XXX"; // of course X's have a int value
        public static String respond;
        private NetworkingActivity activity;

        public Connector(NetworkingActivity activity){
            this.activity = activity;
        }

        public void run() {

            try {

                Socket socket = new Socket(IpAddress, PORT);

                PrintWriter writer = new PrintWriter(socket.getOutputStream(), true);
                Scanner scanner = new Scanner(socket.getInputStream());

                writer.println(NetworkingActivity.message);
                respond = scanner.nextLine();

                activity.yenile(respond);

                socket.close();
            } catch (Exception e) {

            }

        }

    }
} 
```

最后，我还要告诉你一件事。方法yenileClicked() 由xml 文件中的代码“android:onClick="yenileClicked"”通过按钮分配。问题是其他类无法执行几乎相同的方法yenile()；

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-13T22:41:49.080

您可以使用以下任何一种：

1.  使用[runOnUiThread](http://developer.android.com/reference/android/app/Activity.html#runOnUiThread%28java.lang.Runnable%29)。

2.  使用[Handler.post](http://developer.android.com/reference/android/os/Handler.html#post%28java.lang.Runnable%29)

3.  在您的情况下可能最简单：使用[textview.post](http://developer.android.com/reference/android/view/View.html#post%28java.lang.Runnable%29)

4.  不太适合这里，但对于类似的任务也可能很好：使用[asycnTask](http://developer.android.com/reference/android/os/AsyncTask.html)。

# r - R中的xyplot（），意大利面条图，如何在某个点为每个人打勾

> ID：11023102
> 
> 赞同：0
> 
> 时间：2012-06-13T20:51:42.017
> 
> 标签：r, plot, lattice

再会，

我正在使用 xyplot() 创建一个意大利面条图……对于每个 subject_identifier，它会随着时间的推移绘制 Y 的分数。

```
xyplot(Y~time,groups=subject_identifier,data=c,type=c('l')) 
```

每个 subject_identifier 都会在某个指定时间 event_time 发生一个事件。如何在 event_time 为每个人在每行上打一个勾或一个点？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-13T21:15:32.157

如果 event_times 是一个向量：`event_times <- c(5,3,6,8)`并且您希望`groups`与这些索引按顺序排列，那么您可以使用组作为 event_times 的索引，然后它将成为面板参数中 x 和 y 的索引：

```
xyplot(Y~time,groups=subject_identifier,data=cdat,
              panel=function(x,y,groups,...){
                panel.xyplot(x,y,groups=groups,...)
                panel.segments(x0=x[(grp-1)*10+event_times[grp]],
                               x1=x[(grp-1)*10+event_times[grp]], 
                               y0=y[(grp-1)*10+event_times[grp]]-.2,
                             y1=y[(grp-1)*10+event_times[grp]]+.2, groups=groups,...)},
       type=c('l')) 
```

所以第一组在 time=5 被打勾，第二组在 time=3 被打勾，以此类推。`(group-1)*10`尽管可能有更清洁的方法，但需要抵消`panel.superpose`. 蜱的其他选项当然是可能的，但您在问题介绍中相当模糊。

![在此处输入图像描述](../Images/7de3e91f63bca303bde9eee2928aa253.png)

# git - Git 在合并后恢复隐藏的更改 --no-ff

> ID：11023103
> 
> 赞同：0
> 
> 时间：2012-06-13T20:51:42.280
> 
> 标签：git, git-merge, git-stash, git-reset

我经常使用“git stash”和“git stash pop”来保存和恢复工作树中的更改。这就是我所做的，我之前未提交的更改现在已经消失了。

```
git stash -u
git checkout master
git pull --rebase
git checkout dev
git merge --no-ff master
10 files changed, 1000 insertions(+), 2000 deletions(-)
git stash pop 
CONFLICT (content): Merge conflict in file.ext 
```

然后我想我可以恢复合并，我做到了：

```
git reset --hard origin/master
git reset --hard origin/master 
```

现在，我在 中的任何地方都看不到我以前隐藏的任何未提交的更改`file.ext`，只有合并的代码。我怎样才能恢复我最初隐藏的所有更改？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-13T21:30:44.123

当您`pop`关闭 时`stash`，它也会将其从 中删除`stash`。因此，隐藏的更改被转储回您的工作目录。然后，当 you 时`reset`，您恢复了这些相同的更改。

`git reset --hard`是为数不多的危险的“你可能在这里完全失去工作”的命令之一。[这](http://git-scm.com/2011/07/11/reset.html)`reset`很好地解释了不同的方面。

总而言之，它们`stash`不再存在，而您`reset`是工作目录。因此，它们很可能会丢失在比特和字节的以太中。尽管由于这些更改曾经被隐藏，但您也许可以使用`git fsck --lost-found`.

# java - 在 main() 中使用带 int 的类

> ID：11023106
> 
> 赞同：1
> 
> 时间：2012-06-13T20:51:47.100
> 
> 标签：java

我想编写一个包含三个 int 值的类，并在 main() 中操作它们；

我可以想到两种方法

1.  有一个单独的 .class 文件并将其包含到另一个包含 main() 函数的类文件中

东西.java：

```
class stuff { ... }

class app {

public static void main(String[] arguments) {
   .. // manipulate the instance variables
     }
} 
```

2在同一个文件app.java中有一个类，然后一个类包含主函数

应用程序.java：

```
class stuff { ... }

class app {

public static void main(String[] arguments) {
   .. // manipulate the instance variables
     }
} 
```

这些是在 java 中完成的主要方式吗（我没有看到任何关于包含 java 类的内容）。或者我可以让 stuff 类包含 main 本身吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-13T21:00:01.747

您不需要有两个单独的类。您可以简单地将 main main 放在包含实例变量的同一类中。

```
class App {

   int var1;
   int var2;
   int var3;

   public static void main(String[] arguments) {
       .. // manipulate the instance variables
      App app = new App();
      app.var1 = 1;
      app.var2 = 2;
      app.var3 = 3;
   }
} 
```

**编辑**：根据您的评论，您想使用必须对象来执行此操作。如果这些类在同一个包中，那就很简单了。

东西.java

```
public class Stuff {
   int var1;
   int var2;
   int var3;
} 
```

应用程序.java

```
class App {

   public static void main(String[] arguments) {
       .. // manipulate the instance variables
      Stuff stuff = new Stuff();
      stuff.var1 = 1;
      stuff.var2 = 2;
      stuff.var3 = 3;
   }
} 
```

这显然是一个过于简单的例子，但应该给你一个大致的想法。如果 App 类在不同的包中，您只需要通过`import pacakage.name.Stuff;`在 App 类的顶部添加来导入 Stuff 类。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-13T21:02:36.293

我想知道，如果你想编写一个包含三个 int 值的类并在 main() 方法中操作它们，那就去做吧！为什么你需要一些`staff`课程？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-13T20:58:21.777

1.  这些类通常在`.java`文件中定义。编译它们时，编译器将为`.class`您定义的每个类创建一个单独的文件。您可以将多个类放在一个`.java`文件中；但是，标记为的类`public`需要单独的`.java`文件。
2.  您可能会出于您的目的考虑[内部类](http://docs.oracle.com/javase/tutorial/java/javaOO/innerclasses.html)

# css - 为不同的字体系列指定不同的字体大小

> ID：11023107
> 
> 赞同：7
> 
> 时间：2012-06-13T20:51:50.100
> 
> 标签：css

有没有办法为不同的字体系列指定不同的字体大小。我想使用的字体（出于产品品牌的目的）是一种罕见的字体（FlashDlig），并非所有 PC 和浏览器都支持。（我的一台带有 IE 9 的 windows 7 PC 不显示它......）现在对于我使用 Arial 的后备字体，问题是 arial 比 FlashDlig 大得多，所以我想为它指定不同的字体大小同一个班级。可能吗？

我知道您可能可以使用 font-size-adjust 但它仅在 Firefox 中受支持。

有什么建议么？也许是 Javascript 魔法？

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-13T21:01:16.567

我建议默认为 Arial，然后创建第二个类，该类使用为您的字体声明的 @font-face。然后我认为你必须使用Javascript来测试字体是否能够加载（也许检查你放在屏幕外的某些元素的派生样式），如果是这样，将类更改为新的。我这样做而不是从您的自定义字体开始的原因与[*渐进增强*](http://en.wikipedia.org/wiki/Progressive_enhancement)的想法有关。

这是在 Javascript 中更改类的一种方法：

```
if (fontLoaded()) {
    document.body.className += " fontLoaded";
} 
```

然后在你的 CSS 中：

```
@font-face {
    ... /* declare font face */
}
body {
    font-family: "Arial";
    font-size: 0.8em;
}
body.fontLoaded {
    font-family: "FlashDLig";
    font-size: 1em;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-13T21:00:01.287

查看以下代码示例：

[http://www.lalit.org/lab/javascript-css-font-detect/](http://www.lalit.org/lab/javascript-css-font-detect/)

和

[http://remysharp.com/2008/07/08/how-to-detect-if-a-font-is-installed-only-using-javascript/](http://remysharp.com/2008/07/08/how-to-detect-if-a-font-is-installed-only-using-javascript/)

并根据检测结果调整样式表。

我前段时间用过这些，效果很好。

祝你好运！:)

# php - WordPress中的PHP全局变量没有返回预期值

> ID：11023115
> 
> 赞同：0
> 
> 时间：2012-06-13T20:52:07.183
> 
> 标签：php, wordpress, upload

我正在制作一个两部分的表单，以允许用户在 WordPress 上创建帖子。

第一部分包含帖子标题、内容和链接，然后使用 AJAX 从该数据创建帖子。当使用`wp_insert_post()`帖子 ID 创建帖子时，将返回。

```
function makeblog_page2form (){

    global $make_post_id;

    if( check_admin_referer('page2form_submit','page2form_subform') ){

        // more code

        $make_post_id = wp_insert_post( $post );

        exit;

    } else{
        wp_redirect( home_url( '/submission-error/' ) );
        exit;
    }

} 
```

第二部分拍摄一张图片并将其上传到 WordPress 画廊，然后将图片附加到帖子中作为其特色图片。对于图像提交，我使用的是[Frontend Uploader](http://wordpress.org/extend/plugins/frontend-uploader/)，并使用了`add_action('fu_after_upload', callback_function)`这个插件中包含的。

当我尝试在 中使用`$make_post_id`全局`add_action()`附加图像时遇到问题，没有返回任何内容。

```
add_action( 'fu_after_upload', function( $attachment_ids ) { 

    global $make_post_id;
    var_dump($make_post_id); // no return value

} ); 
```

这两个都在同一个file.php中。

如果这还不够清楚，请告诉我。谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-13T21:26:57.633

~~Try passing this variable to the anonymous function scope:~~

 ~~```
global $make_post_id;
add_action( 'fu_after_upload', function( $attachment_ids ) use ($make_post_id){
    var_dump($make_post_id);
}); 
```~~  ~~Global variables does not preserve values between separate request, so you have either return post ID form first call and pass it alongside uploaded files or store and access it in `$_SESSION` array.~~

# ruby-on-rails - 从 Mountable Engine 覆盖主机应用程序的根路由

> ID：11023117
> 
> 赞同：6
> 
> 时间：2012-06-13T20:52:19.117
> 
> 标签：ruby-on-rails, ruby-on-rails-3, rails-engines

我正在编写一个可安装的 Rails 3 引擎，并将我的引擎的路线与主机应用程序的路线相结合。但是，主机应用程序的路线优先于我的引擎路线。有没有办法可以覆盖主机应用程序的路由（特别是根路由）？

这是我的引擎的路线`my_enging/config/routes.rb`：

```
MyEngine::Engine.routes.draw do
 root :to => "home#index"
end

# Mount engine routes to host application
Rails.application.routes.draw do
  mount MyEngine::Engine, :at => "/"
end 
```

这是 的结果`rake routes`，主机的根位于顶部：

```
root  / welcome#index
my_engine  / MyEngine::Engine
root  / home#index 
```

[Spree](https://github.com/spree/spree)是一个可以做到这一点的宝石，但我无法找到他们是如何实现这一点的。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2015-08-20T10:13:43.443

人们更有可能做相反的事情，所以我不明白你为什么需要这个，因为应该能够覆盖引擎路线。实际上我不知道如何强制引擎覆盖应用程序路由，但是：

我想， Spree 正在以某种方式通过[eval_block](http://apidock.com/rails/ActionDispatch/Routing/RouteSet/eval_block)动态添加路由。

您可以完全跳过`root to:`应用程序中所有不需要的路由，然后引擎路由就会出现。不要同时保留它们。我没有在您的应用程序中看到指定的 root，但**我刚刚运行了一个实验，一切正常！**

```
W12::Engine.routes.draw do
  root to: 'details#index'
end

MyCarsApplication.routes.draw do
  mount Common::Engine => "/"
end 
```

而且只有一条路线：

```
root / details#index 
```

[这篇关于创建非独立引擎的帖子](https://stackoverflow.com/questions/7588870/engine-routes-in-application-controller)也可能会有所帮助。

如果您找到了确切的答案，请发布它。

# objective-c - 旋转 UITabBarController 图标

> ID：11023118
> 
> 赞同：2
> 
> 时间：2012-06-13T20:52:20.017
> 
> 标签：objective-c, icons, uitabbarcontroller, image-rotation

我的应用程序中有一个 UITabBar。其中一个标签栏图标看起来像一个加载符号。当用户按下加载按钮时，我希望图标旋转/旋转直到加载完成。我应该使用 UIImageView 来制作动画还是其他什么？我应该如何做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-13T21:13:33.877

Jacos，不幸的是，您无法使用`UITabBarController`和操作 tabBarController 的 tabBar 属性来做到这一点。我最好的选择是您使用 a`UIToolBar`并指定黑色并使其看起来像 a`tabBar`并在其中添加按钮作为 a`subView`使它们看起来像`tabBarItems`。

它的可定制性更高，您甚至可以提供滚动体验并为其添加更多按钮。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2016-08-20T15:04:07.880

我知道这个问题已有 4 年历史，但我遇到了同样的问题，并通过阅读此处的教程设法解决了这个问题：

[https://medium.com/@werry_paxman/bring-your-uitabbar-to-life-animating-uitabbaritem-images-with-swift-and-coregraphics-d3be75eb8d4d#.bjfpbdnut](https://medium.com/@werry_paxman/bring-your-uitabbar-to-life-animating-uitabbaritem-images-with-swift-and-coregraphics-d3be75eb8d4d#.bjfpbdnut)

要点是获取所需 UITabBarItem 的视图并在 viewDidLoad 中从中获取 UIImageView：

```
UIView *plusView = self.tabBar.subviews[1];
self.plusImageView = plusView.subviews.firstObject;
self.plusImageView.contentMode = UIViewContentModeCenter; 
```

然后在 didSelectItem 方法中你可以这样做：

```
[UIView animateWithDuration:0.4 animations:^{
      [self.plusImageView setTransform:CGAffineTransformMakeRotation(M_PI/4)];
}]; 
```

我的代码仅将图像视图旋转 45 度，但您可以根据需要进行更改。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-13T21:25:55.513

我想你可以在计时器上更改 UITabBarItem 的图标，但这看起来很笨拙。您必须预先渲染“加载”图标的每一帧，而不是旋转 ImageView。

另一个 hackey 解决方案是将您的 ImageView 添加到 UIWindow 并将其移动到 TabBarController 的 TabBar 的顶部（将其添加到 TabBar 本身就是自找麻烦）。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-13T21:57:43.503

您不应该尝试在 UITabBarController 中为实际的 UIImageView 设置动画。我会采取这种方法：

1.  将相关选项卡的图像设置为 nil 或空白图像。
2.  创建一个`UIActivityIndicatorView`并将其添加到选项卡栏上。将其放置在正确的选项卡上。 `[self.tabBarController.tabBar addSubview:activityIndicatorView]`;
3.  加载任务完成后，将正常图像恢复到选项卡并从选项卡栏中删除活动指示器。

# codemirror - CodeMirror如何在不删除标记的情况下替换标记的文本

> ID：11023120
> 
> 赞同：0
> 
> 时间：2012-06-13T20:52:25.890
> 
> 标签：codemirror

我正在使用 CodeMirror 为文本框中所有出现的给定单词添加 css 样式。editor.markText(s, e, "cssClass");

但我想同时替换单词。

我试过了：

editor.replaceRange("生词", s, e); 但这也会删除标记。

我可以使用 jquery $(".cssClass").text("new Words");

但我担心如果 CodeMirror 包含过时的文本版本，这会在内部搞砸。

有任何想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-15T20:09:00.953

不，简单地弄乱 dom 以插入新文本是行不通的。

如果您希望标记在标记为被替换的文本中保留下来，您必须让您自己的代码手动恢复它们。标记与文本相关联，因此如果文本被杀死/替换，它们也是如此。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-15T23:58:10.540

我在编辑后进行标记/选择的方式是使用 editor.setSelection(s, e); 不确定这是否能解决您的问题...

# asp.net - MVC 3空查询字符串参数值绑定为空字符串而不是null

> ID：11023124
> 
> 赞同：2
> 
> 时间：2012-06-13T20:52:50.463
> 
> 标签：asp.net, asp.net-mvc, asp.net-mvc-3, asp.net-mvc-2, defaultmodelbinder

我有以下内容：

这个动作：

```
public virtual ActionResult Search(string search, string sort)
{
...
} 
```

使用空查询字符串参数从此 url 调用：

```
http://myurl.com/mycontroller/search?search=&sort= 
```

现在我的理解是，从 MVC 2 开始，DefaultModelBinder 会将这些值保留为空值。但是，我发现它们实际上设置为空字符串。这实际上是预期的行为吗？这在任何地方都有记录吗？

谢谢

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-13T20:55:07.817

是的，默认行为是将空字符串设置为空，但可以通过更改来覆盖它`ConvertEmptyStringToNull = false;`

> **如果在表单中回发的空字符串应**转换为 null ，则为****true**；
> 否则为假。**默认值为 true**。**

 **[微软](http://msdn.microsoft.com/en-us/library/system.web.mvc.modelmetadata.convertemptystringtonull.aspx)

就像在这段代码中：

```
public class SimpleArrayModelBinder : DefaultModelBinder 
{
    public override object BindModel(ControllerContext controllerContext, ModelBindingContext bindingContext) 
    {
        if (bindingContext.ModelType == typeof(string)) 
        {
            var value = bindingContext.ValueProvider.GetValue(bindingContext.ModelName);
            bindingContext.ModelMetadata.ConvertEmptyStringToNull = false;
            if (value == null || value.AttemptedValue.IsNullOrEmpty())
                return "";
            else
                return value.AttemptedValue;
        }
    }
} 
```

更改默认行为的另一种方法是使用`ConvertEmptyStringToNull`模型中属性上方的属性。

**例子：**

```
public class Person
{
    [DisplayFormat(ConvertEmptyStringToNull = false)]
    public string Lastname { get; set; }
    ...
} 
```

[博客](http://www.ienablemuch.com/2011/08/empty-string-is-empty-string.html)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-14T12:42:53.060

查看 DefaultModelBinder 的源代码后，我发现只有在绑定的模型是复杂模型时才会检查 ModelMetadata.ConvertEmptyStringToNull 属性。对于在操作中公开的原始类型，按原样检索值。对于我原始问题中的示例，这将是一个空字符串。

来自 DefaultModelBinder 源

```
 // Simple model = int, string, etc.; determined by calling TypeConverter.CanConvertFrom(typeof(string))
        // or by seeing if a value in the request exactly matches the name of the model we're binding.
        // Complex type = everything else.
        if (!performedFallback) {
            bool performRequestValidation = ShouldPerformRequestValidation(controllerContext, bindingContext);
            ValueProviderResult vpResult = bindingContext.UnvalidatedValueProvider.GetValue(bindingContext.ModelName, skipValidation: !performRequestValidation);
            if (vpResult != null) {
                return BindSimpleModel(controllerContext, bindingContext, vpResult);
            }
        }
        if (!bindingContext.ModelMetadata.IsComplexType) {
            return null;
        }

        return BindComplexModel(controllerContext, bindingContext);
    } 
```

据我所知，ModelMetadata.ConvertEmptyStringToNull 仅在绑定复杂类型时适用。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-14T04:37:49.920

`ModelMetadata.ConvertEmptyStringToNull`此属性将影响将值绑定到作为属性位于 a 中的字符串时`Model`。

前任。

```
public class Employee
{
   public string First{get;set;}
   public string Last{get;set;}
} 
```

**使用 ModelMetadata.ConvertEmptyStringToNull = true （默认）**

当请求不包含这些项目的值时，`First`您将看到两者。`Last``null`

**使用 ModelMetadata.ConvertEmptyStringToNull = false**

当请求包含具有空值的参数时，属性将为 ""。如果请求本身不包含参数，那么值仍然是`null`.**

# jsf - 如何从循环或数组中填充 JSF selectonemenu

> ID：11023125
> 
> 赞同：0
> 
> 时间：2012-06-13T20:52:51.937
> 
> 标签：jsf, selectonemenu

我对 JSF 非常陌生，我需要一些帮助来完成我认为的非常简单的任务。我想从数组或循环或其他东西中填充一个 selectonemenu。我有一个表格，我希望用户输入他们的出生日期。我想要的只是一个简单的列表，他们可以从 1..31 中选择一个月中的某一天。我不想拥有 31

```
<f:selectItem value="n" /> 
```

标签。我试图在我的支持 bean 中放置一个“getDates”方法，但效果不佳。任何有关如何执行此操作的建议将不胜感激。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-13T21:25:41.390

你需要[`<f:selectItems>`](http://docs.oracle.com/javaee/6/javaserverfaces/2.1/docs/vdldocs/facelets/f/selectItems.html)而不是[`<f:selectItem>`](http://docs.oracle.com/javaee/6/javaserverfaces/2.1/docs/vdldocs/facelets/f/selectItem.html). `<f:selectItems>`可以带一个或`List<T>`什`T[]`至一个`Map<K,V>`.

例如

```
<h:selectOneMenu value="#{bean.selectedItem}">
    <f:selectItems value="#{bean.availableItems}" />
</h:selectOneMenu> 
```

和

```
private String selectedItem;
private List<String> availableItems; 
```

### 也可以看看：

*   [我们的`h:selectOneMenu`wiki 页面](https://stackoverflow.com/tags/selectonemenu/info)- 包含许多具体示例

# r - 使用 annotate 为不同的 facet 添加不同的注解

> ID：11023129
> 
> 赞同：19
> 
> 时间：2012-06-13T20:53:03.310
> 
> 标签：r, ggplot2

我正在尝试将面板标签添加到图中的不同方面。我希望它们是 1:7，但是，下面的代码

```
d <- ggplot(diamonds, aes(carat, price, fill = ..density..)) +
     xlim(0, 2) + stat_binhex(na.rm = TRUE) + opts(aspect.ratio = 1)

d1<-d + facet_wrap(~ color)

d1+annotate("text", x=0.25, y=1.5e+04, label=1:7) 
```

产量

```
Error: When _setting_ aesthetics, they may only take one value. Problems: label 
```

现在，我可以提供一个值并将其复制到所有方面。但是如何使用 annotate() 在不同的方面拥有不同的标签？

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2012-06-13T21:05:21.020

，`annotate`你不能。但是通过设置 a`data.frame`并将其用作 a 的数据源`geom_text`，这很容易（有一些簿记方面）。

```
d1 + geom_text(data=data.frame(x=0.25, y=1.5e+04, label=1:7, 
                               color=c("D","E","F","G","H","I","J")), 
               aes(x,y,label=label), inherit.aes=FALSE) 
```

![在此处输入图像描述](../Images/4b6df41b4ebd923a9da0d69c6732f3ff.png)

# unix - unix：发生错误时继续cp？

> ID：11023130
> 
> 赞同：1
> 
> 时间：2012-06-13T20:53:05.063
> 
> 标签：unix, cygwin, cp

我有一个包含大约 50,000 个 .jpg 图像的目录。让我们将此目录称为“imageDir”，并将我尝试复制到“outputDir”的空目录称为。

当我执行：

```
cp imageDir/* outputDir/ 
```

通过我得到大约 30,000 张图像：

```
cp: cannot open `imageDir/234235.jpg' for reading: Bad address 
```

（这并不总是发生在同一个文件上），然后复制操作将停止而不复制其余文件。我在阅读后尝试添加`-R`选项，即使发生错误也会继续复制：

```
cp -R imageDir/* outputDir/ 
```

但这并没有解决我的问题。

您一次可以成功复制的文件数量是否有某种限制？为什么我会看到此错误，我该如何解决？（如果它只发生在这里和那里的照片，只要它完成了其余的，我就可以了！）

另外：这是在 Windows 7 上使用 Cygwin。谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-13T21:02:30.107

对我来说，这似乎是 Cygwin 的问题。既然你说它是随机发生的，你可能只想在它发生时再试一次。这是一个可以做到这一点的脚本（未经测试）：

```
#!/bin/sh
for i in imageDir/*
do
  cp $i outputDir/
  while [ $? -ne 0 ]
  do
    cp $i outputDir/
  done
done 
```

# asp.net - 我在这里正确使用 nHIbernate 的 ITransaction 吗？

> ID：11023141
> 
> 赞同：0
> 
> 时间：2012-06-13T20:54:18.567
> 
> 标签：asp.net, nhibernate, transactions

我只是在学习 nHibernate，并且遇到了一个可能很容易解决的问题。

是的，到目前为止，我已经发现您不能/不应该将 nHibernate 事务嵌套在彼此之间；就我而言，当范围转到另一个例程并开始新事务时，我发现了这一点。

那么我应该做以下事情吗？

```
using (ITransaction transaction = session.BeginTransaction())
{
    NHibernateMembership mQuery =
        session.QueryOver<NHibernateMembership>()
            .Where(x => x.Username == username)
            .And(x => x.ApplicationName == ApplicationName)
            .SingleOrDefault();

    if (mQuery != null)
    {
        mQuery.PasswordQuestion = newPwdQuestion;
        mQuery.PasswordAnswer = EncodePassword(newPwdAnswer);
        session.Update(mQuery);

        transaction.Commit();
        passwordQuestionUpdated = true;
    }
}

// Assume this is in another routine elsewhere but being
// called right after the first in the same request
using (ITransaction transaction = session.BeginTransaction())
{
    NHibernateMembership mQuery =
        session.QueryOver<NHibernateMembership>()
            .Where(x => x.Username == username)
            .And(x => x.ApplicationName == ApplicationName)
            .SingleOrDefault();

    if (mQuery != null)
    {
        mQuery.PasswordQuestion = newPwdQuestion;
        mQuery.PasswordAnswer = EncodePassword(newPwdAnswer);
        session.Update(mQuery);

        transaction.Commit();
        passwordQuestionUpdated = true;
    }
} 
```

注意：我知道它们只是一个副本，我只是在展示我的问题

**第一个问题** 这是它应该做的方式吗？每个操作的交易？

**第二个问题** 我需要调用 transaction.Commit(); 每次还是只在最后一组？

**第三个问题** 有没有更好的方法，自动或手动，来做到这一点？

**第三个问题** 我可以使用 session.Transaction.IsActive 来确定“当前会话”是否已经是事务的一部分 - 所以在这种情况下，我可以在最高级别进行“事务包装”，比如说 Web 表单代码，以及让例程在其中调用，然后在最后提交所有工作。这是一个有缺陷的方法吗？

我真的很想把它敲下来，所以我按我的意思开始；我不想找到 1000 行代码，因为我需要全部更改。

提前致谢。

**编辑：**

对，所以我写了一些代码来准确解释我的问题。

```
private void CallingRoutine()
{
    using(ISession session = Helper.GetCurrentSession)
    {
        using (ITransaction transaction = session.BeginTransaction())
        {
            //  RUN nHIbernate QUERY to get an OBJECT-1

            //  DO WORK on OBJECT

            //  Need to CALL an EXTERNAL ROUTINE to finish work
            ExternalRoutine();

            //  DO WORK on OBJECT-1 again

            //  *** At this point ADO exception triggers
        }
    }
}

private bool ExternalRoutine()
{
    using(ISession session = Helper.GetCurrentSession)
    {
        using (ITransaction transaction = session.BeginTransaction())
        {
            //  RUN nHIbernate QUERY to get an OBJECT-2

            //  DO WORK on OBJECT

            //  Determine result
            if(Data)
            {
                return true;
            }

            return false;
        }
    }
} 
```

希望这能说明问题。这就是我理解编写事务的方式，但请注意 ADO 异常是如何发生的。我显然做错了什么。我打算如何编写这些例程？

例如，如果我要为某个提供程序编写一个辅助对象，并且在每个公开的例程中都有一个 nHibernate 查询运行——假设我对调用函数和数据一无所知，我将如何编写这些例程，关于事务——我的工作是有效和高效地使用 nHibernate 并返回结果。

这就是我通过编写事务我在 ExternalRoutine() 中所做的假设 - 假设这是 nHibernate 的唯一用途并明确地进行事务。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-14T09:34:52.237

如果可能，我建议使用 System.Transactions.TransactionScope：

```
using(var trans = new TransactionScope()) 
using(var session = .. create your session...) {
    ... do your stuff ...
    trans.Complete();
} 
```

The trans.Complete will cause the session to flush and commit the transaction, in addition you can have nested transactionscopes. The only "downside" to this is that it will escalate to DTC if you have multiple connections (or enlisted resources such as MSMQ), but this is not necessarily a downside unless you're using something like MySQL which doesn't play nicely with DTC.

For simple cases I would probably use a transaction scope in the BeginRequest and commit it in EndRequest if there were no errors (or use a filter if u're using ASP.NET MVC), but that really depends a lot on what you're doing - as long as your operations are short (which they should be in a web app), this should be fine. The overhead of creating a session and transaction scope is not that big that it should cause problems for accessing static resources (or resources that don't need the session), unless you're looking at a really high volume / high performance website.

# c++ - 在数组中找到平衡点

> ID：11023143
> 
> 赞同：6
> 
> 时间：2012-06-13T20:54:30.673
> 
> 标签：c++, performance, algorithm, data-structures

这个问题来自一个很棒的 youtube 频道，提供了可以在面试中提出的问题。

它基本上与在数组中找到平衡点有关。这是一个最好地解释它的例子；{1,2,9,4,-1}。在这里，因为 sum(1+2)=sum(4+(-1)) 使 9 成为**平衡点**。在没有检查答案的情况下，我决定实施该算法，然后再询问是否可以采用更有效的方法；

1.  对数组**O(n)中的所有元素求和**
2.  得到总和的一半**O(1)**
3.  从左边开始扫描数组，当**sumleft**大于总和的一半时停止。**上）**
4.  对右边做同样的事情，以获得**求和权。** **O(n)**。
5.  如果**sumleft**等于**sumright**返回**arr[size/2]**否则返回**-1**

我之所以问，是因为这个解决方案毫不费力地突然出现在我的脑海中，提供了 O(n) 的运行时间。如果这个解决方案是真的，是否可以开发或者如果不是真的任何替代方法？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-13T21:00:51.107

您的算法不好（反例：）`1 -1 1 0 1 -1 1`，好的解决方案是计算数组的部分总和（以便您可以计算数组的每个单元`sumleft`格`sumright`的 O(1) 和然后（或在同一如果您已经知道全局总和，`sumleft = sumright`则需要在数组中搜索一个 O(n) 的单元格。

数组的部分和`A`是

```
[A[0], A[0]+A[1], A[0]+A[1]+A[2], …, A[0]+A[1]+A[2]+…+A[n-1]] 
```

例子：

```
A=[5,2,3,1,4,6]
partial sum = [5,7,10,11,15,21] 
```

使用此数组，您可以计算`sumleft[i]=partial_sum[i-1]`和`sumright[i]=partial_sum[n-1]-partial_sum[i]`

改进：

如果存储所有 partial_sum 数组，首先计算全局总和，然后仅计算当前索引的部分总和，使您能够仅使用 O(1) 额外空间而不是 O(n) 额外空间。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-13T21:05:33.833

我实际上有 2 个起点，一个在最左边的点 (leftLoc)，一个在最右边的点 (rightLoc)。持有 sumLeft 和 sumRight 数字。

```
leftLoc  = 0;
rightLoc = (n - 1);
sumRight = array[rightLoc];
sumLeft  = array[leftLoc];

while(leftLoc < rightLoc){
    if(sumRight > sumLeft){
        leftLoc++;
        sumLeft += array[leftLoc];
    }else{
        rightLoc--;
        sumRight += array[rightLoc];
    } 
}

if( (sumRight + array[rightLoc - 1]) == sumLeft ){
    return rightLoc--;
}else if( (sumLeft + array[leftLoc + 1]) == sumRight){
    return leftLoc++;
}else{
    // return floating point number location in the middle of the 2 locations
} 
```

一直跟踪总共移动了多少位置 O(n)

您可能会发现您的平衡点是一个浮点数，位于最终点的中间（一旦它们位于彼此相邻的整数位置）。

这甚至**应该**适用于负数示例。也许我遗漏了一些细粒度的细节，但是这个主题的一些变化应该会导致你使用 O(n) 运行时算法。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-13T21:15:36.793

基本上先把所有的数字加起来。这将是一个 O(n) 操作。然后从数组的开头开始一次从数组中减去一个元素，直到`upper`== `lower`。因此，总订单将是 O(n)。

```
int BalancePoint(int a[], int begin, int end) // find index of an array (balance point) such that sum of all elements before the index = sum of all elements after it; else return -1
{
    if(!a) return -1;
    else if(begin == end) return begin;

        long long upper = 0;
        long long lower = 0;

    for(int i = begin; i <= end; ++i)
    {
        upper += *(a+i);
    }

    for(int j = begin; j <= end; ++j)
    {
        upper -= *(a+j);
        if(upper == lower) return j;
        lower += *(a+j);
    }
    return -1;
} 
```

使用 STL

```
int BalancePointSTL( const vector<int> &A ) // find index of an array (balance point) such that sum of all elements before the index = sum of all elements after it; else return -1
{
    if(A.empty()) return -1;

        long long upper = 0;
        long long lower = 0;

    for(unsigned int i = 0; i <= A.size(); ++i)
    {
        upper += A[i];
    }

    for(unsigned int j = 0; j < A.size(); ++j)
    {
        upper -= A[j];
        if(upper == lower) return j;
        lower += A[j];
    }
    return -1;
    } 
```

以下将具有更好的最坏情况性能，但还有更多`if-else`比较

```
int BalancePoint2(int a[], int begin, int end) // Better worst case senario by factor of 2
{
    if(!a) return -1;
    else if(begin == end) return begin;

        long long upper = 0;
        long long lower = 0;

        int mid = (end-begin)/2;

        for(int i = begin; i < mid; ++i)
        {
            lower += *(a+i);
        }
        for(int i = mid+1; i <= end; ++i)
        {
            upper += *(a+i);
        } 

        if(upper == lower) return mid;
        else if(lower < upper)
        {
            lower += *(a+mid);
            for(int i= mid + 1 ; i <= end ; ++i)
            {
                upper -= *(a + i);
                if(upper == lower) return i;
                lower += *(a + i);
            }
        }
        else {
            upper += *(a + mid);
            for(int i = mid - 1; i >=begin; --i)
            {
                lower -= *(a + i);
                if(upper == lower) return i;
                upper += *(a + i);
            }
        }
        return -1;
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2015-05-27T21:56:56.807

您正在寻找*centroid*或*center of mass*。在纯 Python 中：

```
def centroid(input_list):
    idx_val_sum = 0.0
    val_sum = 0.0
    for idx,val in enumerate(input_list):
        idx_val_sum += idx*val
        val_sum += val
    return idx_val_sum/float(val_sum) 
```

这是**O(n)**，如果非整数结果格式不正确，您可以通过模检查拒绝它们：

```
def integer_centroid(input_list):
    idx_val_sum = 0.0
    val_sum = 0.0
    for idx,val in enumerate(input_list):
        idx_val_sum += idx*val
        val_sum += val
    out = idx_val_sum/float(val_sum)
    if out%1.0==0.0:
        return out
    else:
        raise ValueError("Input list has non-integer centorid.") 
```

这篇文章应该是回复trumpetlicks June 14 2012 评论的评论，但我没有足够的声誉。“订单”在 中被隐式跟踪`idx_val_sum`，这是按值加权的累积位置总和。

**编辑：**

马特，谢谢你的观察。我以为这是一个伪代码问题，但现在我看到了 C++ 标签。这是一些（未经测试的）C++，带有注释。

一个直观的例子是一个简单的杠杆臂问题：如果你有一个杠杆，两个力*f1*和*f2*作用在它的位置*x1*和*x2*上，你可以通过在位置*(f1*x1+f2* x2)/(f1+f2)*。*连续系统需要对x*和*f*的乘积进行积分，但是具有离散位置和力的杠杆是这个问题的一个很好的类比。

```
// untested code:

float centroid(float * vec, int vec_length){

  float idx_val_sum = 0.0;
  float val_sum = 0.0;

  for (idx = 0; idx < vec_length; idx++){

    // keep a running sum of the product of the index and the value
    idx_val_sum += float(idx)*vec[idx];

    // similarly, keep a running sum of the index
    val_sum += vec[idx];

  }
  // return the quotient of the product-sum and the index sum:
  return idx_val_sum/val_sum;
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2020-08-09T22:39:30.210

一个 O(n) 且不需要更多空间的解决方案

```
def balance_array(arr):
    if len(arr) < 3:
        return False

    for i in range(1, len(arr)+1):
        lsum = sum(arr[:i])
        rsum = sum(arr[(i+1):])
        if lsum == rsum:
            return True
    return False 
```

测试

`test_arrays = [[5, 3, 7, 0, 9], [5,2,3,1,4,6], [1,0,1], [1,6,5,1,2,3,1], [1,1], [], [1], [1,2,9,4,-1], [5, 4, 7, 0, 9], [1, -1, 1, 0, 1, -1, 1]]`

```
for i in test_arrays:
    print(f'{i}\t{balance_array(i)}')

[5, 3, 7, 0, 9]         False
[5, 2, 3, 1, 4, 6]      True
[1, 0, 1]               True
[1, 6, 5, 1, 2, 3, 1]   True
[1, 1]                  False
[]                      False
[1]                     False
[1, 2, 9, 4, -1]        True
[5, 4, 7, 0, 9]         True
[1, -1, 1, 0, 1, -1, 1] True 
```

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2012-06-14T00:19:50.963

我相信您正在寻找[质量中心](http://en.wikipedia.org/wiki/Center_of_mass)，这是用 Go 编写的解决方案：

```
func centerOfGravity(a []int) float64 {
  tot := 0.0
  mass := 0.0
  for i := range a {
    tot += float64(i) * float64(a[i])
    mass += float64(a[i])
  }
  return tot / mass
} 
```

假设一个基于 0 的数组，这将为您提供数组中质心的索引。它可以返回非整数结果，因为质心可以在数组范围内的任何位置。

# javascript - 在 Javascript 中更轻松地处理十六进制字符串和十六进制值

> ID：11023144
> 
> 赞同：26
> 
> 时间：2012-06-13T20:54:44.573
> 
> 标签：javascript, variables, hex

我有一些代码，它接受代表十六进制数字的字符串 - 实际上是十六进制颜色 - 并添加它们。例如，添加`aaaaaa`并`010101`给出输出`ababab`。
但是，我的方法似乎不必要地冗长和复杂：

```
var hexValue = "aaaaaa";
hexValue = "0x" + hexValue;
hexValue = parseInt(hexValue, 16);
hexValue = hexValue + 0x010101;
hexValue = hexValue.toString(16);
document.write(hexValue); // outputs 'ababab'
```

连接后的十六进制值仍然是字符串`0x`，所以我必须将其更改为数字，*然后*我可以添加，然后我必须将其更改*回*十六进制格式！如果我要添加的数字是以十六进制字符串开头，或者如果您考虑到`#`在所有这些开始之前我正在从十六进制颜色中删除 ，则还有更多步骤。

当然，有一种更简单的方法可以进行如此简单的十六进制计算！为了清楚起见，我的意思并不是像把它全部放在一行上`(parseInt("0x"+"aaaaaa",16)+0x010101).toString(16)`或使用速记一样——我的意思是实际上做的操作更少。

有没有办法让javascript停止对其所有数学运算使用十进制并使用十六进制？还是有其他方法可以让 JS 更轻松地使用十六进制？

* * *

## 回答 #1

> 赞同：37
> 
> 时间：2012-06-13T21:32:48.360

不，没有办法告诉 JavaScript 语言默认使用十六进制整数格式而不是十进制。您的代码尽可能简洁，但请注意，当您将“parseInt”与基础一起使用时，您不需要预先添加“0x”基础指示符。

以下是我将如何解决您的问题：

```
function addHexColor(c1, c2) {
  var hexStr = (parseInt(c1, 16) + parseInt(c2, 16)).toString(16);
  while (hexStr.length < 6) { hexStr = '0' + hexStr; } // Zero pad.
  return hexStr;
}

addHexColor('aaaaaa', '010101'); // => 'ababab'
addHexColor('010101', '010101'); // => '020202' 
```

正如评论者所提到的，上述解决方案充满了问题，因此下面是一个功能，它可以进行正确的输入验证，并在检查溢出时分别添加颜色通道。

```
function addHexColor2(c1, c2) {
  const octetsRegex = /^([0-9a-f]{2})([0-9a-f]{2})([0-9a-f]{2})$/i
  const m1 = c1.match(octetsRegex)
  const m2 = c2.match(octetsRegex)
  if (!m1 || !m2) {
    throw new Error(`invalid hex color triplet(s): ${c1} / ${c2}`)
  }
  return [1, 2, 3].map(i => {
    const sum = parseInt(m1[i], 16) + parseInt(m2[i], 16)
    if (sum > 0xff) {
      throw new Error(`octet ${i} overflow: ${m1[i]}+${m2[i]}=${sum.toString(16)}`)
    }
    return sum.toString(16).padStart(2, '0')
  }).join('')
}

addHexColor2('aaaaaa', 'bogus!') // => Error: invalid hex color triplet(s): aaaaaa / bogus!
addHexColor2('aaaaaa', '606060') // => Error: octet 1 overflow: aa+60=10a 
```

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2012-06-13T21:00:08.213

这个怎么样：

```
var hexValue = "aaaaaa";
hexValue = (parseInt(hexValue, 16) + 0x010101).toString(16);
document.writeln(hexValue); // outputs 'ababab'
```

如果使用 parseInt，则无需添加 0x 前缀。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2018-02-20T23:59:34.633

我认为接受的答案是错误的。十六进制颜色表示不是线性的。但取而代之的是，给 R、G 和 B 提供了 3 组两个字符。

因此，您不能只添加一个整数并期望 RGB 正确添加。

```
For Example

n1 = '005500'; <--- green
n2 = '00ff00'; <--- brighter green 
```

添加这些数字应该会产生更绿的绿色。无论如何，添加果岭应该增加 RED 来增加。但是通过做公认的答案正在做的事情，例如将整数视为一个数字，那么您将结转加起来大于f的数字，f + 1 = 10。

```
you get `015400` so by adding greens the RED increased .... WRONG 
```

添加 005500 + 00ff00 应导致 = 00ff00。您不能将更多的绿色添加到最大绿色。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2020-02-13T21:26:15.020

对于那些正在寻找一个可以在不超出单个元组范围的情况下添加和减去 HEX 颜色的函数的人，我在几分钟前编写了这个函数来做到这一点：

```
export function shiftColor(base, change, direction) {
  const colorRegEx = /^\#?[A-Fa-f0-9]{6}$/;

  // Missing parameter(s)
  if (!base || !change) {
    return '000000';
  }

  // Invalid parameter(s)
  if (!base.match(colorRegEx) || !change.match(colorRegEx)) {
    return '000000';
  }

  // Remove any '#'s
  base = base.replace(/\#/g, '');
  change = change.replace(/\#/g, '');

  // Build new color
  let newColor = '';
  for (let i = 0; i < 3; i++) {
    const basePiece = parseInt(base.substring(i * 2, i * 2 + 2), 16);
    const changePiece = parseInt(change.substring(i * 2, i * 2 + 2), 16);
    let newPiece = '';

    if (direction === 'add') {
      newPiece = (basePiece + changePiece);
      newPiece = newPiece > 255 ? 255 : newPiece;
    }
    if (direction === 'sub') {
      newPiece = (basePiece - changePiece);
      newPiece = newPiece < 0 ? 0 : newPiece;
    }

    newPiece = newPiece.toString(16);
    newPiece = newPiece.length < 2 ? '0' + newPiece : newPiece;
    newColor += newPiece;
  }

  return newColor;
} 
```

您将基本颜色作为参数 1 传递，将更改作为参数 2 传递，然后根据您的意图将“添加”或“子”作为最后一个参数。

# sql-server - 在网格中显示来自数据库的实时队列数据的最佳方式

> ID：11023146
> 
> 赞同：1
> 
> 时间：2012-06-13T20:54:57.503
> 
> 标签：sql-server, winforms, performance, data-binding

我有一个客户端-服务器 VB.NET/SQL2008 应用程序，除其他外，它跟踪排队等候的人。队列的记录都是通过应用程序更新的，但它们是在不同的工作站上添加/删除的。

我需要在网格中显示人员队列（如果可以增加任何好处，可以做一个多列列表框）并在队列更改时自动更新。我不需要它是实时的，但我希望人们在几秒钟内出现。我目前有一个绑定到数据的数据网格，并且我有一个每隔几秒刷新一次数据网格的计时器。但是我认为必须有更好的方法来做到这一点。

我不喜欢的一件事是网格在刷新时如何闪烁，如果有人双击以选择一条记录，它正在刷新它会选择列表中的第一个人，而不是选择的人。

我做了一些研究，似乎一个选择是 SQL Dependency - 但是据我所见，人们说很难设置并开始工作并且“脆弱”。

任何帮助表示赞赏！

# android - 如何在不激活的情况下测试应用程序？

> ID：11023152
> 
> 赞同：0
> 
> 时间：2012-06-13T20:55:38.010
> 
> 标签：android, google-play, android-lvl

好的，所以我导出了一个已签名的发布 APK，使用 Google 的 LVL API “锁定”，但在 Google Play 上激活它以供所有人查看和下载之前，我想先在我的设备上对其进行测试。

问题是当我只是`adb install -r`那个签名的发布 APK 时，许可服务器返回`NOT_LICENSED`并且**我无法测试锁定的功能**。

在不先激活它的情况下测试被 Google LVL 锁定的应用程序的正确方法是什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-13T23:32:37.710

我记得我之前遇到过类似的问题，当时谷歌将 Android Market 重命名为 Google Play。Google Play 似乎被旧的 LVL 缓存数据卡住了。

`Settings -> Applications -> Manage Applications -> Google Play`尝试在您的设备上清除应用程序数据。

# c# - 更改字典的键

> ID：11023156
> 
> 赞同：6
> 
> 时间：2012-06-13T20:56:08.597
> 
> 标签：c#, dictionary

我对字典很陌生。大约 6 小时前我开始使用它们的非常新的含义：p。无论如何，我想知道是否有办法更改字典的键。

这是我的字典：

```
Dictionary<string, string> Information = new Dictionary<string, string>(); 
```

这是我添加到字典的方式（每次用户输入信息并点击按钮时都会触发：

```
Information.Add(txtObjectNumber.Text, addressCombined); 
```

用户需要能够编辑这两个字段以及删除整个记录。

所以几乎应用程序需要添加`txtNumber`和`txtComments`在哪里`txtNumber = txtObjectNumber`

感谢您的帮助。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-06-13T20:58:01.950

无法直接修改密钥。您必须将其删除并重新添加。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-13T21:07:56.733

关键是允许您稍后找到数据（“值”）的机制。

例如，如果你做了

```
information.Add("Kris", "Vandermotten"); 
```

如果您知道“Kris”，您以后可以找到“Vandermotten”。

现在在这种情况下，*改变*“Kris”意味着什么？您将数据放在名称“Kris”下，并希望通过搜索“Bob”将其取出？你不会找到它。

在某种程度上，字典键非常类似于关系数据库中的主键。指的是值的逻辑标识。因此，一方面，他们应该唯一标识它。

所以也许这个例子没有意义。也许像

```
information.Add(42, new Person("Kris", "Vandermotten") 
```

更有意义。那么问题当然是：42 是什么？有时这种键有一个自然的候选者，例如员工编号或其他东西，有时则没有。

当没有时，也许你需要做

```
List<Person> information = new List<Person>();

information.Add(new Person("Kris", "Vandermotten")); 
```

当然，如果 Person 对象允许更改名字属性，而这正是您想要做的，那就去做吧。但是“更改字典键”对我来说没有多大意义。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-13T21:01:36.720

您可以为您的 Dictionary 使用内置的 Remove() 方法。或者你可以通过遍历集合来完成它。虽然我很好奇为什么您需要不断更新键，而不仅仅是值。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-13T20:58:58.213

您不能更改现有字典项的键。您可以做的是删除以前的键并根据编辑添加一个新的键/值。

示例用例：

添加键：名称，值：鲍勃

现在您想更改`Name`为`FirstName`，您必须这样做

从字典中删除键`Name`添加键：名字，值：鲍勃

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-06-13T21:00:06.170

您在这里使用字典似乎有点不对劲。顾名思义，字典旨在为您提供一种基于键“查找”值的方法。但是，在您的情况下，您似乎正在使用它来存储两个相关的数据，其中任何一个都可以更改。在这种情况下，您最好只使用一个列表，并创建一个单独的类来封装这两条信息。就像是

```
public class MyData
{
    public string SomeData { get; set; }
    public string OtherData { get; set; }
} 
```

进而

```
List<MyData> myDataList; 
```

或者，您甚至可能想要一个将不变键（可能是用户 ID）映射到自定义类的字典：

```
Dictionary<string, MyData> myDataDictionary; 
```

# php - 如何在 PHP 中更新 xpath 的版本？

> ID：11023160
> 
> 赞同：5
> 
> 时间：2012-06-13T20:56:17.067
> 
> 标签：php, xml, xpath

> **可能重复：**
> [XPath 2.0 和/或 XSLT 2.0 会在 PHP 中实现吗？](https://stackoverflow.com/questions/2085632/will-xpath-2-0-and-or-xslt-2-0-be-implemented-in-php)

我想我使用的是 xpath 1.0，因为我没有这个`lower-case()`功能。我的 PHP 版本是**5.3.8**。如何将 xpath 更新到 2.0 版本？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-06-14T07:46:02.147

不幸的是，没有人将 PHP XPath 库升级到 2.0 版。如果您有大量的空闲时间或金钱，您会通过开展这项工作为社区提供出色的服务。如果您没有很多空闲时间或金钱，那么希望您会理解为什么没有其他人接受它。可悲的是，这是自由软件的缺点。通常没有投资。

# css - 隐藏链接但在悬停时显示不起作用 - CSS

> ID：11023161
> 
> 赞同：0
> 
> 时间：2012-06-13T20:56:30.367
> 
> 标签：css, visibility

这似乎很有意义，但它不起作用。我似乎违反了某种规则。我试图让链接显示为透明（根本不显示）并在悬停时显示自己。我唯一的限制是它不能有纯色，因为背景不是纯色的。

**jsfiddle：**

[http://jsfiddle.net/AmDUH/](http://jsfiddle.net/AmDUH/)

**HTML：**

```
<a href="#">Click here</a> 
```

​CSS **：**

```
a{
visibility:hidden;
}
a:hover{
visibility:visible;
} 
```

​有没有办法在css中做到这一点？如果我可以只应用透明颜色，这似乎很简单，但据我所知，这是不可能的。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-13T21:00:10.557

您可以改为使用`opacity`：

```
a{
    opacity: 0;
}
a:hover{
    opacity: 1;
}
​ 
```

[JS 小提琴演示](http://jsfiddle.net/davidThomas/AmDUH/1/)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-13T21:00:11.660

尝试使用：

```
a{
opacity:0.0;
}
a:hover{
opacity:1.0;
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-13T21:00:28.667

这隐藏了用户的可见性......当然你不能将鼠标悬停在上面，因为它是“不可见的”。我会尝试按照以下方式做一些事情：

```
a:link {color:#FFFFFF;}
a:visited {color:#000000;}
a:hover {color:#000000;}
a:active {color:#000000;} 
```

或者玩 opacity:0.0

# macos - CFMessagePortSendRequest 超时混乱

> ID：11023165
> 
> 赞同：0
> 
> 时间：2012-06-13T20:57:06.350
> 
> 标签：macos, osx-snow-leopard

我正在使用 CFMessagePortSendRequest 发送消息。有时我会收到一个 kCFMessagePortSendTimeout。有谁了解为什么会发生这种超时的机制？苹果文档有点，嗯，稀疏。消息端口是远程消息端口。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-27T23:52:18.663

根据您提供的少量信息，我最好的猜测是您的 CFTimeInterval sendTimeout 和 CFTimeInterval rcvTimeout 值太小。尝试类似 sendTimeout = rcvTimeout = 30;

# ruby - 没有这样的文件来加载 active_record/associations/has_and_belongs_to_many_association

> ID：11023167
> 
> 赞同：2
> 
> 时间：2012-06-13T20:57:19.303
> 
> 标签：ruby, ruby-on-rails-3

我在我的 Gemfile 中添加了 composite_primary_keys gem。在本地环境中它运行良好，但在 centos 机器上它因以下错误而中断。Ruby 版本是 1.9.2p290，rubygems 版本在两个环境中都是 1.3.7。有谁知道为什么会这样？

```
bundle exec rake db:create --trace

no such file to load -- active_record/associations/has_and_belongs_to_many_association
/var/tmp/jenkins/gem_cache/myapp/gems/activesupport-3.1.3/lib/active_support/dependencies.rb:240:in `require'
/var/tmp/jenkins/gem_cache/myapp/gems/activesupport-3.1.3/lib/active_support/dependencies.rb:240:in `block in require'
/var/tmp/jenkins/gem_cache/myapp/gems/activesupport-3.1.3/lib/active_support/dependencies.rb:223:in `block in load_dependency'
/var/tmp/jenkins/gem_cache/myapp/gems/activesupport-3.1.3/lib/active_support/dependencies.rb:640:in `new_constants_in'
/var/tmp/jenkins/gem_cache/myapp/gems/activesupport-3.1.3/lib/active_support/dependencies.rb:223:in `load_dependency'
/var/tmp/jenkins/gem_cache/myapp/gems/activesupport-3.1.3/lib/active_support/dependencies.rb:240:in `require'
/var/tmp/jenkins/gem_cache/myapp/gems/composite_primary_keys-4.1.2/lib/composite_primary_keys.rb:40:in `<top (required)>'
/opt/ruby/1.9.2/lib/ruby/gems/1.9.1/gems/bundler-1.0.22/lib/bundler/runtime.rb:68:in `require'
/opt/ruby/1.9.2/lib/ruby/gems/1.9.1/gems/bundler-1.0.22/lib/bundler/runtime.rb:68:in `block (2 levels) in require'
/opt/ruby/1.9.2/lib/ruby/gems/1.9.1/gems/bundler-1.0.22/lib/bundler/runtime.rb:66:in `each'
/opt/ruby/1.9.2/lib/ruby/gems/1.9.1/gems/bundler-1.0.22/lib/bundler/runtime.rb:66:in `block in require'
/opt/ruby/1.9.2/lib/ruby/gems/1.9.1/gems/bundler-1.0.22/lib/bundler/runtime.rb:55:in `each'
/opt/ruby/1.9.2/lib/ruby/gems/1.9.1/gems/bundler-1.0.22/lib/bundler/runtime.rb:55:in `require'
/opt/ruby/1.9.2/lib/ruby/gems/1.9.1/gems/bundler-1.0.22/lib/bundler.rb:122:in `require' 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-04-17T19:43:20.817

尝试将 Composite_primary_keys gem 与 A​​ctive Record 4.1.0 一起使用时，可能会发生相同的错误：

```
.../vendor/cache/ruby/1.9.1/gems/activesupport-4.1.0/lib/active_support/dependencies.rb:247:in `require': cannot load such file -- active_record/associations/has_and_belongs_to_many_association (LoadError)
  from .../vendor/cache/ruby/1.9.1/gems/activesupport-4.1.0/lib/active_support/dependencies.rb:247:in `block in require'
  from .../vendor/cache/ruby/1.9.1/gems/activesupport-4.1.0/lib/active_support/dependencies.rb:232:in `load_dependency'
  ... 
```

这是因为composite_primary_keys 的当前版本（截至2014 年4 月17 日的版本6.0.1）不包括对Active Record 4.1.0 的支持，这显然删除了有问题的文件。

但是，该问题已在gem[的`ar_4.1.x`源代码分支中得到](https://github.com/composite-primary-keys/composite_primary_keys/tree/ar_4.1.x)解决。如果您的项目使用 Bundler，解决方案是编辑其 Gemfile 并替换该行

```
gem 'composite_primary_keys' 
```

和

```
gem 'composite_primary_keys', {
  :git => 'git://github.com/composite-primary-keys/composite_primary_keys.git',
  :branch => 'ar_4.1.x'
} 
```

然后`bundle install`从项目的根文件夹运行。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-09-06T19:40:59.920

更新您的 Gemfile： `gem 'composite_primary_keys', '~> 7.0'`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-19T00:31:23.230

清理 jenkins 机器上的共享 gems 列表解决了这个问题。

# mysql - 创建带参数的mysql函数

> ID：11023168
> 
> 赞同：1
> 
> 时间：2012-06-13T20:57:21.240
> 
> 标签：mysql, function, parameters

```
delimeter //
DROP function IF EXISTS get_seq_next//
create function get_seq_next(
IN sequence_ref_ varchar(30)
) returns int(11) unsigned
BEGIN
    DECLARE seq_val_  int(11) unsigned;
    LOCK TABLE ga_seq_tab WRITE;
    select sequence_no into seq_val_ from ga_seq_tab where sequence_ref=sequence_ref_;
    if not seq_val_ is null then
        update ga_seq_tab set sequence_no=sequence_no+1 where sequence_ref=sequence_ref_;
    end if
    UNLOCK TABLES;
    return seq_val;
END //
DELIMETER ; 
```

我正在尝试创建一个函数，但它一直说我有语法错误，我不确定它有什么问题

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-04-23T23:14:49.393

尝试删除`IN`参数列表中的保留字。

# javascript - 如何使用 javascript 获取 html 选择以显示选定的值

> ID：11023171
> 
> 赞同：1
> 
> 时间：2012-06-13T20:57:29.967
> 
> 标签：javascript, html, html-select

我有一个选择下拉列表，其中在 html 中的页面加载时选择了 1 个项目。

```
<select name = "options">
  <option value = "1">Item1</option>
  <option value = "2" selected>Item2</option>
  <option value = "3">Item3</option>
  <option value = "4">Item4</option>
</select> 
```

现在我想在用户按下 shift 并选择另一个选项（例如“Item 3”）时捕获新的选择选项。

我有以下代码来查找列表中的所有选择

```
 var value = "";
 for (var intLoop = 0; intLoop < Form.elements[index].length; intLoop++) {

     if(Form.elements[index][intLoop].selected )
             value = value + Form.elements[index][intLoop].value;
 } 
```

我可以看到“第 2 项”和“第 3 项”被选中，但我只想捕获“第 3 项”。是否可以？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-13T22:19:31.957

这里的代码会告诉你什么被选中和什么被取消[http://jsfiddle.net/8dWzB/](http://jsfiddle.net/8dWzB/)

它使用`Array.prototype.indexOf`，这不是最快的方法。但它应该让你朝着正确的方向前进。

**HTML**

```
<select id="options" multiple="multiple">
  <option value = "1">Item1</option>
  <option value = "2" selected>Item2</option>
  <option value = "3">Item3</option>
  <option value = "4">Item4</option>
</select> 
```

**JS**

```
function getSelectedIndexes(select) {
   var selected = [];
   for (var i = 0; i  < select.options.length; i++) {
       if(select.options[i].selected ) {
            selected.push(i);
       }
   }
   return selected;
}

var select = document.getElementById("options");
var prevSelected = getSelectedIndexes(select);

select.onchange = function(e) {
    var currentlySelected = getSelectedIndexes(this);

    for (var i =0; i < currentlySelected.length; i++) {
        if (prevSelected.indexOf(currentlySelected[i]) == -1) {
            console.log("Added to selection ", this.options[currentlySelected[i]].text);
        }
    }

    for (var i =0; i < prevSelected.length; i++) {
        if (currentlySelected.indexOf(prevSelected[i]) == -1) {
            console.log("Removed from selection  ", this.options[prevSelected[i]].text);
        }
    }        
    prevSelected = currentlySelected;
};
​ 
```

如果你真的只想知道最后点击了哪个项目，你可以使用下面的代码。我将使用 jQuery，因此我可以轻松地在所有选项对象上设置处理程序。请记住，如果您使用键盘更改选择，这将不起作用

```
 $('option').click(function(e){
        var parentNode = this.parentNode;
        for (var i=0; i < this.parentNode.options.length; i++) {
            if (parentNode.options[i] == this) {
              console.log('Clicked item with index', i);
              break;
            }
        }
    }); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-13T21:45:48.620

您可以在更改事件之前检查所选选项的值（例如选择项目 1 和 2），然后在事件之后再次检查（例如选择项目 1、2 和 3），并比较差异。

这是一个例子。

在这里小提琴：http: [//jsfiddle.net/FnAuz/4/](http://jsfiddle.net/FnAuz/4/)

我修改了您`select`以允许多项选择，因为我认为这是问题的症结所在。

HTML：

```
<form id="my-form">
    <select name = "options" id="options" multiple>
      <option value = "val1">Item1</option>
      <option value = "val2">Item2</option>
      <option value = "val3">Item3</option>
      <option value = "val4">Item4</option>
    </select>
</form>​ 
```

JS：

```
var oldValue = "";
document.getElementById('options').onchange = function() {
    var myForm = document.getElementById ('my-form');
    var value = "";
    for (var intLoop = 0; intLoop < myForm.elements[0].length; intLoop++) {
        if(myForm.elements[0][intLoop].selected) {
            value = value + myForm.elements[0][intLoop].value;
        }
    }
    for (var intLoop = 0; intLoop < myForm.elements[0].length; intLoop++) {
        var optionVal = myForm.elements[0][intLoop].value;
        if(myForm.elements[0][intLoop].selected && value.indexOf(optionVal) !== -1  && oldValue.indexOf(optionVal) === -1) {
            console.log('Last clicked was ' + myForm.elements[0][intLoop].value)
        }
    }
    oldValue = value;
}; 
```

**编辑：**我刚刚注意到我的示例在用户进行命令/ctrl 选择时有效，但是如果他们进行了移位选择，那么所有新值都将被计为“最后点击的项目”。所以我的代码需要一些工作来解释这种情况。我没时间了，但希望我的代码在当前状态下仍然有用！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-13T21:40:47.857

它开始看起来很乱，所以我将其发布为答案：

```
<html>
<head>
<script type="text/javascript">
<!--
var value = '0';

document.getElementById('options').onchange = function() {
    value = parseInt(value) + parseInt(this.value);
    alert(value);
}
-->
</script>
</head>
<body>
    <select name="options" id="options">
    <option value = "1">Item1</option>
      <option value = "2" selected>Item2</option>
      <option value = "4">Item3</option>
      <option value = "8">Item4</option>
    </select>
</body>    
</html> 
```

选择多个项目的版本：好吧，如果您想累积项目，您可以为每个产品分配二进制 ID，然后您可以从总数中提取所有选定的产品。例如，如果总数是：7，您可以轻松地将其转换为二进制字符串“111”，这意味着他们选择了项目 1、2、4。听起来有点疯狂，我知道，只是一个想法；）

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-10-25T04:19:47.633

试试这个 ：

```
var e = document.getElementById("ID_of_Select_Element");
var _selectedValue= e.options[e.selectedIndex].value; 
```

# javascript - CSS 选择器从右到左进行评估。querySelectorAll() 选择器是否也会以这种方式进行评估？

> ID：11023173
> 
> 赞同：5
> 
> 时间：2012-06-13T20:57:40.453
> 
> 标签：javascript, css, css-selectors, selectors-api

选择器是否`querySelectorAll()`像 CSS 一样从右到左进行评估，还是从左到右进行？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-13T21:01:15.847

从右到左，这就是为什么右侧应该比左侧更具体的原因。

> jQuery 选择器应该从左到右变得更具体。选择器以相反的顺序解析，因此确保您最具体的选择器在右侧将提高性能。

它说“jQuery”，但对于所有 CSS 选择器都是如此。

# android - Android SDK 和 AVD Manager 将无法运行

> ID：11023179
> 
> 赞同：11
> 
> 时间：2012-06-13T20:58:01.340
> 
> 标签：android, avd

我安装了 Android SDK 但我无法使用它，因为 AVD 和 SDK 管理器没有运行。当我尝试打开其中任何一个时，命令提示符窗口会弹出大约半秒，然后关闭。我尝试从命令提示符运行 exe 以查看是否有错误消息但没有输出并且它的行为相同。我研究了这个问题，发现其他计算机也发生了同样的事情。我尝试了那里发布的一些解决方案：

### 似乎不起作用的解决方案

*   将 JDK 位置添加到`PATH`环境变量的开头
*   将 Android SDK 位置添加到`PATH`环境变量
*   以管理员身份运行应用程序
*   `.android`从用户 ( `C:/Users/[User Name]`) 目录中删除文件夹
*   在驱动器的根目录中安装`C:`，而不是在 Program Files 中

* * *

操作系统信息：Windows 7 Home Premium，管理员权限

* * *

### 更新

我想我找到了问题的根源，但我仍然不知道如何解决它。问题似乎与我`android.bat`在`C:\Android\android-sdk\tools`目录中的文件有关。它尝试调用`find_java.bat`但由于一个小的语法问题而无法调用。这是输出：

* * *

'C:\Android\ANDROI~1\tools\lib\find_java.exe -s' 不是内部或外部命令、可运行程序或批处理文件。

错误：未找到合适的 Java。为了正确使用 Android 开发者工具，您需要在系统上安装合适版本的 Java JDK。我们建议您安装 JavaSE 的 JDK 版本，可在此处获得： [http ://www.oracle.com/technetwork/java/javase/downloads](http://www.oracle.com/technetwork/java/javase/downloads)

您可以在此处找到完整的 Android SDK 要求：http: [//developer.android.com/sdk/requirements.html](http://developer.android.com/sdk/requirements.html)

* * *

在对 进行一些修改后`android.bat`，我能够让它调用`find_java.bat`，无论我对它做了什么，它都会得到一堆错误。我终于感到沮丧，并决定在`java.exe`. 后来在批处理文件中还有另一个错误。我开始认为我的安装或批处理文件确实有问题。这是批处理文件 ( `android.bat`)：

```
@echo off
rem Copyright (C) 2007 The Android Open Source Project
rem
rem Licensed under the Apache License, Version 2.0 (the "License");
rem you may not use this file except in compliance with the License.
rem You may obtain a copy of the License at
rem
rem      http://www.apache.org/licenses/LICENSE-2.0
rem
rem Unless required by applicable law or agreed to in writing, software
rem distributed under the License is distributed on an "AS IS" BASIS,
rem WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
rem See the License for the specific language governing permissions and
rem limitations under the License.

rem Useful links:
rem Command-line reference:
rem   http://technet.microsoft.com/en-us/library/bb490890.aspx

rem don't modify the caller's environment
setlocal

rem Set up prog to be the path of this script, including following symlinks,
rem and set up progdir to be the fully-qualified pathname of its directory.
set prog=%~f0

rem Grab current directory before we change it
set work_dir="%cd%"

rem Change current directory and drive to where the script is, to avoid
rem issues with directories containing whitespaces.
cd /d %~dp0

rem Check we have a valid Java.exe in the path.
set java_exe=
call lib\find_java.bat
if not defined java_exe goto :EOF

set jar_path=lib\sdkmanager.jar;lib\swtmenubar.jar

rem Set SWT.Jar path based on current architecture (x86 or x86_64)
for /f %%a in ('%java_exe% -jar lib\archquery.jar') do set swt_path=lib\%%a

:MkTempCopy
    rem Copy android.bat and its required libs to a temp dir.
    rem This avoids locking the tool dir in case the user is trying to update it.

    set tmp_dir=%TEMP%\temp-android-tool
    xcopy %swt_path% %tmp_dir%\%swt_path% /I /E /C /G /R /Y /Q > nul
    copy /B /D /Y lib\androidprefs.jar   %tmp_dir%\lib\        > nul
    copy /B /D /Y lib\org.eclipse.*      %tmp_dir%\lib\        > nul
    copy /B /D /Y lib\sdk*               %tmp_dir%\lib\        > nul
    copy /B /D /Y lib\common.jar         %tmp_dir%\lib\        > nul
    copy /B /D /Y lib\commons-compress*  %tmp_dir%\lib\        > nul
    copy /B /D /Y lib\swtmenubar.jar     %tmp_dir%\lib\        > nul
    copy /B /D /Y lib\commons-logging*   %tmp_dir%\lib\        > nul
    copy /B /D /Y lib\commons-codec*     %tmp_dir%\lib\        > nul
    copy /B /D /Y lib\httpclient*        %tmp_dir%\lib\        > nul
    copy /B /D /Y lib\httpcore*          %tmp_dir%\lib\        > nul
    copy /B /D /Y lib\httpmime*          %tmp_dir%\lib\        > nul

    rem jar_path and swt_path are relative to PWD so we don't need to adjust them, just change dirs.
    set tools_dir=%cd%
    cd /d %tmp_dir%

:EndTempCopy

rem The global ANDROID_SWT always override the SWT.Jar path
if defined ANDROID_SWT set swt_path=%ANDROID_SWT%

if exist %swt_path% goto SetPath
    echo ERROR: SWT folder '%swt_path%' does not exist.
    echo Please set ANDROID_SWT to point to the folder containing swt.jar for your platform.
    goto :EOF

:SetPath
rem Finally exec the java program and end here.
REM set REMOTE_DEBUG=-Xdebug -Xrunjdwp:transport=dt_socket,server=y,suspend=y,address=8000
call %java_exe% %REMOTE_DEBUG% -Dcom.android.sdkmanager.toolsdir="%tools_dir%" -Dcom.android.sdkmanager.workdir=%work_dir% -classpath "%jar_path%;%swt_path%\swt.jar" com.android.sdkmanager.Main %*

rem EOF 
```

* * *

### 更新（再次）

我在 virtualbox 中运行的 WinXP 上安装了 Android SDK，它运行良好。不过我还是希望能在 Win7 上使用它。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-05-03T03:56:15.280

这就是我让它在 Windows 8 上工作的方式

1.  添加 JAVA_HOME 环境变量并将其设置为您的 java 安装位置（即`C:\Program Files (x86)\Java\jdk1.6.0_39\bin`）

2.  接下来编辑 C:\Users{YOUR USERNAME}\AppData\Local\Android\android-sdk\tools\android.bat 找到该`set java_exe= call lib\find_java.bat`行并将其更改为 `set java_exe=java.exe`

3.  保存文件，它应该运行

**请注意**，如果您收到有关 swt 位置的错误，只需硬编码路径即可。将其设置为 lib\x86 或 lib\x86_64

希望这可以帮助

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-12-01T10:04:46.187

我安装了新的 x64 版本的 JDK 并解决了我的问题

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-06-13T23:38:26.133

我在全新安装 64 位 win 7 pro、使用和全新安装 64 位 JDK 时遇到了这个问题。

Kenton Price 在这篇文章中的解决方案解决了我的问题，现在一切正常。

[Android SDK安装找不到JDK](https://stackoverflow.com/questions/4382178/android-sdk-installation-doesnt-find-jdk)

出于某种原因，我系统上的（最初是 linux 开发的）ADK 需要使用 linux 风格的正斜杠而不是 windows 风格的反斜杠定义的 JAVA_HOME。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2015-06-01T06:14:53.460

我发现 Rajesh 从他上面的评论中发现了同样的问题。此行括号中的命令未执行

```
for /f "delims=" %%a in ('"%java_exe%" -jar lib\archquery.jar') do set swt_path=lib\%%a 
```

编辑：有些人可能有这一行： for /f "delims=" %%a in ('"%~dps0find_java%arch_ext%.exe" -s') do set java_exe=%%a

这一行来自sdk`find_java.bat`的`tools\lib\`目录。

我有一个 Win 7 x64 系统，我不打算重新加载整个操作系统，所以我硬编码了 MZB 从他上面的帖子中建议的内容：

在这一行之后：

```
for /f "delims=" %%a in ('"%java_exe%" -jar lib\archquery.jar') do set swt_path=lib\%%a 
```

编辑：或这一行：

for /f "delims=" %%a in ('"%~dps0find_java%arch_ext%.exe" -s') 设置 java_exe=%%a

我添加了这一行：

```
set java_exe=%JAVA_HOME%\bin\java.exe 
```

这假设您已将 JAVA_HOME 环境变量设置为 Java JDK 文件夹（不带`\bin`）

如果您的 JAVA_HOME 变量包含 ，`\bin`则将其设置如下：

```
set java_exe=%JAVA_HOME%\java.exe 
```

如果您没有设置 JAVA_HOME 环境，那么您需要使用您机器上的实际路径对其进行硬编码，就像 MZB 在他的帖子中所做的那样。

我也为 javaw 逻辑做了它：

```
set javaw_exe=%JAVA_HOME%\bin\javaw.exe 
```

我终于可以访问 SDK 管理器了。

* * *

2015 年 6 月 1 日更新：

致在我提交这篇文章后更新了这篇文章的 Ken YN：

当我创建这篇文章时，我引用了这一行：

for /f "delims=" %%a in ('"%~dps0find_java%arch_ext%.exe" -s') 设置 java_exe=%%a

这在我当前的 find_java.bat 文件夹 ...\sdk\tools\lib 中，我昨天刚刚从当前版本的 Android Studio Windows x64 版本（android-studio-bundle-141.1903250-windows.exe）更新。变量 %arch_ext% 将在其中包含 32 或 64，具体取决于它们拥有的系统。

但我不知道上面的行是如何转换为：

对于 /f "delims=" %%a in ('"%java_exe%" -jar lib\archquery.jar') 设置 swt_path=lib\%%a

在 Ken YN 进行编辑之后。

但也许有些人在他们的 find_java.bat 文件中有你的版本，但我相信有些人像我一样有另一个。我只是为那些无法打开 SDK 管理器的人指出这一点。

另外我应该提到我在 JDK1.7 和 JDK1.8 上都有这个问题。本来是装JDK1.8的，昨天看Android Studio的需求，说需要JDK1.7，所以昨晚装了JDK1.7，以为可以解决我的问题，但是find_java.bat的问题是一样的使用任一版本的 JDK。

我还应该指出，当我用两个版本的 JDK 安装 Android Studio 时，我最初能够在第一次打开 Android Studio 之前访问 SDK 管理器。但是当我打开 Android Studio 时，它首先开始更新 SDK 管理器，也许这就是问题发生的时候，因为在启动一个 IDEA 项目后，我无法打开 SDK 管理器。

所以也许 find_java.bat 在第一次打开 Android Studio 之前有这一行：

对于 /f "delims=" %%a in ('"%java_exe%" -jar lib\archquery.jar') 设置 swt_path=lib\%%a

而当 Adroid Studio 更新 SDK 时，它有这条线吗？

for /f "delims=" %%a in ('"%~dps0find_java%arch_ext%.exe" -s') 设置 java_exe=%%a

我没有时间测试它——我已经浪费了很多时间试图弄清楚如何访问 SDK。如果他们遇到同样的问题，也许其他人可以确认这一点。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-02-06T07:09:39.323

我也有同样的问题，无法打开 Android SDK 管理器，但是通过从用户（C：/Users/[用户名]）目录中删除 .android 文件夹，它可以工作......

谢谢

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2014-02-20T04:24:10.467

我刚刚遇到了与 loplateral98 类似的问题，并在这里尝试了所有解决方案，但没有结果。然后我记得我必须先添加一个环境变量来定位java，然后才能让android studio首先启动，所以我只是尝试添加一个新的系统变量`Android_home`并将其定向到我的android文件夹`C:\Program Files (x86)\Android`。就像我在设置 java 时所做的那样，然后它启动时没有问题。SDK 管理器也已启动并正在工作。如果您仍然遇到问题，我希望这会有所帮助

这是我在设置 java 部分时发现的，只是想我也可以尝试一下 android。

在某些 Windows 系统上，启动器脚本找不到 Java 的安装位置。如果遇到此问题，则需要设置一个环境变量来指示正确的位置。

> 选择开始菜单 > 计算机 > 系统属性 > 高级系统属性。

然后打开并添加一个指向 JDK 文件夹`Advanced tab > Environment Variables`的新系统变量，例如`JAVA_HOME`

> C:\Program Files\Java\jdk1.7.0_21。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2013-02-13T06:26:07.377

不要删除 .android 文件夹。Juz 删除 .android 文件夹中的 avd 文件夹。它会对你的工作有很大的帮助。

提前欢呼。普拉卡什。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2013-06-17T15:30:31.497

我有这个问题，问题原来是这样的：

```
D:\dev\adt-bundle-windows-x86_64-20130522\sdk>"tools\lib\find_java.exe"
C:\Windows\system32\java.exe 
```

我隐约记得很久以前有一个程序发现 Java 并将其复制到 system32 目录以“解决”它的问题。

我删除了这些文件，现在：

```
D:\dev\adt-bundle-windows-x86_64-20130522\sdk>"tools\lib\find_java.exe"
C:\Program Files\Java\jre7\bin\java.exe 
```

SDK/ADK 管理器现在可以正常运行。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2013-10-04T11:32:32.767

我在我的 windows-8 64 位机器上遇到了同样的问题。将问题缩小到 find_java.bat 文件中的特定语句 `for /f "delims=" %%a in ('"%~dps0\find_java.exe" -s') do set java_exe=%%a` 。

由于某种原因，括号中的语句没有作为命令执行。我尝试了上面所有建议的解决方案，但都没有奏效。最后发现这个特定的语句在另一台 Windows 8 64 位机器上运行良好，所以我的 Windows 8 安装存在一些问题。我检查了我的操作系统系统文件，发现其中一些文件已损坏，因此我修复了我的 Windows 8 安装，之后一切正常。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2014-03-26T05:39:49.960

如果问题出在 Windows 机器上，则只需以管理员身份运行 AVD 管理器或 SDK 管理器

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2014-12-09T22:28:35.540

\tools\lib\find_java.bat 可能存在问题，无法成功确定 java.exe 和 javaw.exe 可执行文件的位置。

这里的解决方法：[http](http://www.gmansoft.com/android-sdk-manager-find-java-problem/) : //www.gmansoft.com/android-sdk-manager-find-java-problem/ 为我工作。请注意，如果您“修复” android.bat 中的问题，其他批处理文件仍然会损坏。

如果上述链接中断，解决方法是硬连线 find_java.bat 的结果以返回 java 可执行文件的实际位置。例如将其编辑为：

```
rem Check we have a valid Java.exe in the path. The return code will
rem be 0 if the command worked or 1 if the exec failed (program not found).
rem for /f "delims=" %%a in ('"%~dps0\find_java%arch_ext%.exe" -s') do set java_exe=%%a
set java_exe=c:\program files\Java\jdk1.8.0_25\bin\java.exe
if not defined java_exe goto :CheckFailed

:SearchJavaW
rem Check if we can find a javaw.exe at the same location than java.exe.
rem If that doesn't work, just fall back on the java.exe we just found.
rem for /f "delims=" %%a in ('"%~dps0\find_java%arch_ext%.exe" -s -w') do set javaw_exe=%%a
set javaw_exe=c:\program files\Java\jdk1.8.0_25\bin\javaw.exe
if not exist "%javaw_exe%" set javaw_exe=%java_exe%
goto :EOF 
```

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2014-12-23T09:11:33.610

升级工作环境时，我遇到了同样的问题。问题出在`<AndroidSDK>\tools\lib\find_java.bat`（感谢指向此文件的任何人）。它搜索 64 位版本的 Java，而我安装了 32 位版本。简单而肮脏`set arch_ext=32`的`find_java.bat`解决了我的问题。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2015-06-29T23:11:33.073

我在 Windows 8.1 上遇到了同样的问题，通过以管理员身份运行 Android Studio 解决了这个问题

# c# - 如何根据 DateTime.Now 计算用户使用程序的时间？

> ID：11023182
> 
> 赞同：0
> 
> 时间：2012-06-13T20:58:10.590
> 
> 标签：c#

我有一个变量：`string currentTime in the constructor:`

```
currentTime = DateTime.Now.ToString("HH:mm:ss tt"); 
```

如果是 Form1_FormClosing 我有：

```
currentTimeClosed = DateTime.Now.ToString("HH:mm:ss tt"); 
```

现在我想计算两个字符串时间之间的差异并获得用户使用类似的时间`currenttimeClosed - currentTime = 10 minutes and 10 seconds` 所以我知道用户使用程序 10 分钟和 10 秒。

我该怎么做 ？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-13T21:00:05.437

不要将日期和时间存储为字符串。相反，请使用以下`DateTime`类型：

在构造函数中声明你的变量，如下所示：

```
DateTime currentTime; 
```

然后，您可以像这样在程序启动时分配日期和时间：

```
currentTime = DateTime.Now; 
```

每当您需要运行时间时，请按如下方式计算：

```
TimeSpan runningTime = DateTime.Now - currentTime; 
```

请参考[`TimeSpan`文档](http://msdn.microsoft.com/en-us/library/system.timespan.aspx)；`TimeSpan`提供各种属性来了解您的程序已运行的时间量。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-13T21:00:44.000

将值存储为`DateTime`s，然后进行计算。这将产生一个`TimeSpan`，其中包含所需的结果。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-13T21:00:59.000

首先，您不需要存储*字符串*- 只需`DateTime`直接存储。

您可以将两者相减以获得`TimeSpan`差异并输出其值。

```
// fields
DateTime currentTime;
DateTime currentTimeClosed;

// Somewhere in constructor
currentTime = DateTime.Now;

// in Form1_FormClosing
currentTimeClosed = DateTime.Now;

var difference = currentTimeClosed  - currentTime;

Console.Write(string.Format("{0} minutes and {1} seconds", 
                            (int)difference.TotalMinutes, 
                            difference.Seconds)); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-13T21:02:27.640

我实际上会使用`StopWatch`. 创建它并将其存储在成员变量中并`Start()`在构造函数中调用该方法。然后调用中的`Stop()`方法`Form1_Unload`。`Ellapsed`您可以使用或询问程序使用了多低`ElapsedMillis`。

# javascript - jQuery $("body").height() 返回未定义

> ID：11023183
> 
> 赞同：6
> 
> 时间：2012-06-13T20:58:13.090
> 
> 标签：javascript, jquery

我有这样的电话：

```
$("#ContextMenuModal").height($("body").height()); 
```

但是`$("body").height()`，当我在 Firebug 中查看它时返回未定义。

什么会导致 jQuery 返回未定义的身体高度？

我正在使用 jQuery 1.4.1。

编辑：

这是在 iFrame 内

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-06-13T21:00:12.597

只需使用

```
$(document).height() // - $('body').offset().top 
```

和/或

```
$(window).height() 
```

而是 $('body').height()

稍微展开一下，

```
$(window).height();   // returns height of browser viewport
$(document).height(); // returns height of HTML document 
```

正如 bažmegakapa 指出的那样，尽管有几个像素，但还是有细微差别。正文的真实高度可以通过从文档高度中减去正文偏移量来计算（就像我上面提到的那样）：

```
$(document).height() - $('body').offset().top 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-13T21:08:53.373

用这个-

```
 $("body").css("height") 
```

好吧，我会说不需要jquery-

```
this.style.height;//it will not work if you add it as inline js. 
```

# c++ - 如何在运行时计算 C++ 表达式类型？

> ID：11023187
> 
> 赞同：2
> 
> 时间：2012-06-13T20:58:31.620
> 
> 标签：c++, parsing, types, runtime, expression

我需要编写一个 C++ 代码覆盖程序，该程序接受另一个 C++ 程序（在文件中给出）并在其每个语句下面增强或添加对增加计数器的函数的调用。但是，我需要为每种类型的表达式使用不同的计数器（即我需要计算每种类型有多少个表达式）。为此，我需要确定每个 C++ 表达式的类型。IMO 我需要使用解析器 API 来解析每一行以获取其类型。你看到更好的解决方案了吗？否则，我在哪里可以找到解析 API？

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-13T21:06:34.217

“解析器”API 不会为您提供类型信息。它最多只能让您访问 AST。

您需要一个完整的 C++ 前端，它可以解析 C++ 代码、进行名称和类型解析，并且可以从字面上计算每个表达式的类型。最重要的是，您需要插入所需的工具，然后输出可编译的源代码。

我们的[DMS 软件再造工具包](http://www.semanticdesigns.com/Products/DMS/DMSToolkit.html)及其[C++ 前端](http://www.semanticdesigns.com/Products/FrontEnds/CppFrontEnd.html)具有执行此操作所需的所有功能。

DMS 已用于为 C++（和许多其他语言）构建测试覆盖率和分析器工具；你甚至可以下载并试一试，看看它们是什么样的。您可能会发现这篇关于[使用 DMS 构建测试覆盖工具的](http://www.semdesigns.com/Company/Publications/TestCoverage.pdf)论文很有趣，可以作为您想做的事情的基准。您的变体需要类型推断，但除此之外并没有太大的不同。

# codeigniter - CodeIgniter - 使用 $route['(:any)'] = 'pages/view/$1' 时如何使用其他控制器？

> ID：11023189
> 
> 赞同：2
> 
> 时间：2012-06-13T20:59:00.793
> 
> 标签：codeigniter, routing, controllers

使用时

`$route['(:any)'] = 'pages/view/$1';`

我想在我的路由中使用其他控制器，例如：

```
$route['del/(:any)'] = 'crud/del'; 
```

它行不通。我想它会使用

`pages/view/del/$1`

删除项目时不是我的crud-controller。我该如何解决这个问题？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-06-13T21:45:48.240

如前所述，`$route['(:any)']`将匹配*任何*URL，因此将您的其他自定义路由*放在*“catch-all”路由之前：

```
$route['del/(:any)'] = 'crud/del';
// Other routes as needed...
$route['(:any)'] = 'pages/view/$1'; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-20T11:02:48.773

它百分百的工作

```
$route['(:any)'] url is placed last in your routes file

$route['(:any)/company_product_deal_detail']    =   "mypage_product_picture/deal_detail/$1";
$route['(:any)/company_service_deals/(:any)']    =   "mypage_service_deal_list/index/$1";
$route['(:any)/company_service_deals']    =   "mypage_service_deal_list/index/$1";

$route['(:any)']    =   "company/index/$1"; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-09-10T06:30:59.177

我知道这是一个老问题，但我发现自己是一个很好的解决方案。

默认情况下，CodeIgniter 优先考虑路由配置中的 URL（即使指定了直接控制器、方法等），所以我以这种方式颠倒了这个优先级：

在`system/core/Router.php`查找`_parse_routes`方法中。

在文字路由匹配下添加此代码：

```
$cont_segments = $this->_validate_request($this->uri->segments);
if ($cont_segments == $this->uri->segments) {
  return $this->_set_request($cont_segments);
} 
```

我同意，这种方法有点错误，因为我们从系统/核心编辑文件，但我需要一个快速的解决方案来处理很多 URL。

# c# - 重构方法选择器类

> ID：11023190
> 
> 赞同：0
> 
> 时间：2012-06-13T20:59:01.403
> 
> 标签：c#

我正在处理一些现有的代码。几个小时后，我把这个问题归结为一个方法选择器类。我觉得这门课很难学。是否有可能以简单的方式实现这种类型的方法选择功能？

```
public class MethodPicker
    {
        private delegate string SomeFunc(MethodPicker item);

        static readonly Dictionary<string, SomeFunc> test = new Dictionary<string, SomeFunc>();

        static MethodPicker()
        {
            test.Add("key1", Func1);
            test.Add("key2", Func2);
            test.Add("key3", Func3);
        }

        public string RunTest(string Name)
        {
            string somestring = test[Name].Invoke(this);
            return somestring;
        }

        public static string Func1(MethodPicker entity)
        {
            return "func1 runs";
        }

        public static string Func2(MethodPicker entity)
        {
            return "func2 runs";
        }

        public static string Func3(MethodPicker entity)
        {
            return "func3 runs";
        }
    } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-13T21:25:00.160

我决定用一个新属性和一个扩展方法来隐藏复杂性。

```
public class MethodPicker 
    { 
        public string Name {get;set;}
    } 

public static class Extensions
{     
        private delegate string SomeFunc(MethodPicker item); 
        static readonly Dictionary<string, SomeFunc> test = new Dictionary<string, SomeFunc>(); 

        static Extensions() 
        { 
            test.Add("key1", Func1); 
            test.Add("key2", Func2); 
            test.Add("key3", Func3); 
        } 

        public string AsSpecialString(this MethodPicker obj) 
        { 
            string somestring = test[obj.Name].Invoke(obj); 
            return somestring; 
        } 

        string Func1(MethodPicker entity) 
        { 
            return "func1 runs"; 
        } 

        static string Func2(MethodPicker entity) 
        { 
            return "func2 runs"; 
        } 

        static string Func3(MethodPicker entity) 
        { 
            return "func3 runs"; 
        } 
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-13T21:15:38.413

那么这将是一个更简单的解决方案..

```
public class MethodPicker
    {
        public string RunTest(string Name)
        {
           string somestring;
           if (Name.equals("key1") 
              return Func1(this);
           else if(Name.equals("key2") 
               return Func2(this);
           else if (Name.equals("key3") 
               return Func3(this);
           else 
              throw new Exception(name + " not found.. ");
        }

        public static string Func1(MethodPicker entity)
        {
            return "func1 runs";
        }

        public static string Func2(MethodPicker entity)
        {
            return "func2 runs";
        }

        public static string Func3(MethodPicker entity)
        {
            return "func3 runs";
        }
    } 
```

它还强调了字典解决方案中的潜在问题，因为如果字典中不存在键/名称，则您没有适当的错误处理。在您的解决方案中，它会在此处导致 NullPointerException：

`string somestring = test[Name].Invoke(this);`

`test[Name]`将返回空...

# openstack - 对象存储 - Swift 重启问题

> ID：11023191
> 
> 赞同：0
> 
> 时间：2012-06-13T20:59:15.450
> 
> 标签：openstack

```
root@ubuntu:/etc/swift# swift-init restart all
No container-updater running
No account-auditor running
No object-replicator running
No proxy-server running
No container-replicator running
No object-auditor running
No object-expirer running
No container-auditor running
No container-server running
No account-server running
No account-reaper running
No container-sync running
No account-replicator running
No object-updater running
No object-server running 
```

[我的设置与HP 手册](http://h30529.www3.hp.com/t5/HP-Scaling-the-Cloud-Blog/Setting-Up-a-Single-Node-OpenStack-Storage-Server-Part-1/ba-p/251)完全相同。

任何想法有什么问题。我还需要提供其他信息吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-13T22:13:11.840

我不知道是不是我的错。但是 EOF- End of LineFeed 命令似乎无法正常工作，并且一些配置文件没有正确写入

# git - 在 Vim 中自动包装长的 Git 提交消息

> ID：11023194
> 
> 赞同：80
> 
> 时间：2012-06-13T20:59:34.100
> 
> 标签：git, vim, word-wrap, commit-message

使用 Git，我的提交编辑器是 Vim。我一直在记住换行方面做得很差，所以我排长队（例如，参见[这个答案](https://stackoverflow.com/a/2120040/748858)）。有没有一种方法`git config`可以`.vimrc`让 Vim 在 72 列处自动换行？

[相关问题。](https://stackoverflow.com/questions/1874030/wrap-long-lines-in-vim)

* * *

## 回答 #1

> 赞同：109
> 
> 时间：2012-06-13T21:05:11.510

将此添加到您的`.vimrc`：

```
au FileType gitcommit setlocal tw=72 
```

* * *

## 回答 #2

> 赞同：25
> 
> 时间：2012-06-23T10:44:03.280

虽然其他答案很好地解决了这个问题，但我强烈建议您安装 Tim Pope 的[fugitive.vim](https://github.com/tpope/vim-fugitive)。

fugitive.vim 是一个出色的插件，它为 Vim 带来了 Git 功能。它有许多与您的问题无关的功能，但值得一试。但是，它也可以帮助您记住保持提交消息的适当长度：

![Vim 中关于逃犯的示例提交消息](../Images/535da564d038d8cbde4521608473e026.png)

* * *

## 回答 #3

> 赞同：24
> 
> 时间：2012-06-23T08:45:23.033

Add this to your `.vimrc`:

```
filetype indent plugin on 
```

From [here](https://wincent.com/blog/automatic-wrapping-of-git-commit-messages-using-vim).

* * *

## 回答 #4

> 赞同：12
> 
> 时间：2018-02-12T19:49:40.640

**2018 更新**- 更新 vim

如果您更新 vim，它将自动突出显示标题的前 50 个字符并在 72 个字符处换行。它知道你正在编辑一个 git 提交文件。

* * *

Mac 用户可以使用[Homebrew](https://brew.sh)：

```
brew install vim 
```

* * *

如果您仍然没有看到语法突出显示，请确保已[启用](https://stackoverflow.com/questions/19754849/vim-syntax-highlighting-does-not-work/19754920#19754920)它：

> [根据 Arch linux 文档](https://wiki.archlinux.org/index.php/vim#Syntax_highlighting)，您需要在 .vimrc 文件中进行以下设置
> 
> ```
> filetype plugin on
> syntax on 
> ```

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2019-09-13T16:37:19.950

除了其他答案，`gqip`在编辑时使用 重新格式化段落。

参见[Vim Tips Wiki：自动格式化段落](https://vim.fandom.com/wiki/Automatic_formatting_of_paragraphs)

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2014-01-18T09:09:40.483

这是一个用于自动包装的 git 钩子，适用于任何编辑器： [https ://github.com/surabhigupta/AutoWrapSeventyTwo](https://github.com/surabhigupta/AutoWrapSeventyTwo)

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2018-06-07T20:29:28.043

早期帖子中的几个选项有效，除了我注意到不同系统之间的不一致。

一旦我意识到 Fedora 28（最近从 F26 升级）就很容易了：git-commit/git-tag 中的版本显示它指向 .virc 文件（奇怪*）所以我只是将我的 ~/.vi **m** rc 复制到**~/. virc** [除了，见下文]。

根据[:verbose :set tw=?来自](https://stackoverflow.com/questions/15869839/set-textwidth-in-vim-without-overriding-filetype-specific/15873007#15873007)[brew](https://stackoverflow.com/a/48754406/9910099)的带有 vim 8.0 的 macOS 10.13.4在 /usr/share/vim/vim80/ftplugin/gitcommit.vim 下工作得很好 .

CentOS 7.4 和 vim 7.4（git 版本 1.8.3.1）由于某种原因似乎没有使用其提供的 gitcommit.vim 中的 textwidth 行，所以我采取了一种快速而肮脏的解决方法（以免我处理多个文件）在 ~/.vimrc:

```
nmap <F2> :set textwidth=72<CR>
inoremap <F2> <Esc>:set textwidth=72<CR>a 
```

这似乎工作得很好，而且很容易记住——无论如何我大多只是从那里拉出来，并且已经放弃了再搞乱旧版本的 git 和 vim。

否则，在 Abe Voelker 的[回答](https://stackoverflow.com/a/11023282/9910099)之后，我（暂时）寻求 Chip Hogg 的[建议](https://stackoverflow.com/questions/11023194/automatically-wrap-long-git-commit-messages-in-vim/11023282#comment32469116_11023282)：autocmd FileType gitcommit setlocal textwidth=72

我认为它在 git-commit 内部并没有太大的不同，但最好是安全的（特别是如果该行最终在整个 vimrc 中被复制）。文件类型当然设置为 on，就像在许多示例 vimrcs 中一样。

***但是，**我仍然很好奇为什么 vim 的标尺没有显示，所以我查看了 :help 标尺，它通知 +cmdline_info（在 :version 之后显示）需要在编译时设置。在 git-commit 之外的 vim 中运行 :ver 会显示不同的设置和不同的编译时间，这表明 git 可能正在调用 vim 的系统副本而不是用户副本。

所以我一开始应该做的是运行[**git config --global core.editor "vim"**](https://stackoverflow.com/questions/2596805/how-do-i-make-git-use-the-editor-of-my-choice-for-commits#2596835)，但我没有这样做，因为我认为这是一个多余的步骤。在每次安装 git 时先执行此操作可能会从一开始就省去很多麻烦！

# file - Swi Prolog，卸载源文件

> ID：11023197
> 
> 赞同：6
> 
> 时间：2012-06-13T20:59:50.523
> 
> 标签：file, prolog, swi-prolog

是否有内置谓词或一种简单的方法可以从 prolog 的知识数据库中删除已经查阅过的源文件？我浏览了参考手册并没有找到任何可以做到这一点的东西。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-13T21:43:31.007

您可以使用以下过程来执行此操作`source_file/1`和`source_file/2`：

```
unload_last_source:-
  findall(Source, source_file(Source), LSource),
  reverse(LSource, [Source|_]),
  unload_source(Source).

unload_source(Source):-
  ground(Source),
  source_file(Pred, Source),
  functor(Pred, Functor, Arity),
  abolish(Functor/Arity),
  fail.
unload_source(_). 
```

`unload_source/1`废除由输入源文件名定义的所有谓词。请注意，它必须是绝对路径。

`unload_last_source/0`将检索最后查阅的文件名并将其卸载。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-13T21:51:01.267

在查阅了一个文件后，它对 Prolog 变得“无关紧要”。所以我认为一般回答应该是**no**。但是 SWI-Prolog 有一组丰富的内置函数，可以让你控制你的程序。例如

```
?- [stackoverflow].

?- predicate_property(P, file('/home/carlo/prolog/stackoverflow.pl')).
P = yield(_G297, _G298) ;
P = now _G297 ;
P = x(_G297) ;
...

?- abolish(yield/2).
true.

?- predicate_property(P, file('/home/carlo/prolog/stackoverflow.pl')).
P = now _G297 ;
P = x(_G297) ;
... 
```

请注意，取消不需要文件名才能工作，您可以删除从其他源文件加载的谓词。

[条款](http://www.swi-prolog.org/pldoc/doc_for?object=clause/3)，条款[属性](http://www.swi-prolog.org/pldoc/doc_for?object=clause_property/2)和[擦除](http://www.swi-prolog.org/pldoc/doc_for?object=erase/1)应该给予更多的控制，但我在尝试使用擦除时得到一个我不理解的错误（它没有记录）：

```
?- clause(strip_spaces(_G297, _G298),X,Y),erase(Y).
ERROR: erase/1: No permission to clause erase `<clause>(0x29acc30)' 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-13T22:24:13.743

如果您知道谓词的名称，例如 fact/2，您可以使用：

```
retractall(fact(_,_)). 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2021-08-04T00:40:47.927

这将起作用。

> **卸载文件（+文件）**

> 删除从文件加载的所有子句。如果 File 加载了一个模块，请清除该模块的导出列表并将其与文件解除关联。File 是对 load_files/2 有效的规范文件名或文件指示符。该谓词应谨慎使用。SWI-Prolog 的多线程特性使得删除静态代码不安全。这样做的尝试应该保留用于开发或应用程序可以保证与 File 关联的子句都不处于活动状态的情况。

# ios - iPhone 应用程序：避免闪屏后出现白屏。让闪屏徘徊，在 UIWebview 加载后隐藏它？启动画面没有正确隐藏

> ID：11023198
> 
> 赞同：4
> 
> 时间：2012-06-13T20:59:57.220
> 
> 标签：ios, objective-c, iphone, uiwebview, splash-screen

对于 iPhone 应用，我们的目标很简单：显示一个启动页面，然后在 UIWebview 准备好显示其页面时将其隐藏。

在 UIWebview 准备好显示之前，我们需要默认的闪屏。否则，会短暂出现白屏。

不幸的是，启动画面在我们让它徘徊后无法隐藏。默认的初始屏幕仍然可见，隐藏了下面的 UIWebview。

我们理解这可能违反 Apple 准则。

对于原型来说，这比什么都重要，我们想了解我们做错了什么。有什么线索吗？

我们使用的是 Xcode 4.2。

## **AppDelegate.m:**

```
//
//  AppDelegate.m
//
//  Created by Macintosh User on 6/4/12.
//  Copyright (c) 2012 __MyCompanyName__. All rights reserved.
//

#import "AppDelegate.h"

#import "ViewController.h"

@implementation AppDelegate

@synthesize window = _window;
@synthesize viewController = _viewController;
@synthesize imgv;

- (BOOL)application:(UIApplication *)application didFinishLaunchingWithOptions:(NSDictionary *)launchOptions
{
    self.window = [[UIWindow alloc] initWithFrame:[[UIScreen mainScreen] bounds]];
    // Override point for customization after application launch.
    self.viewController = [[ViewController alloc] initWithNibName:@"ViewController" bundle:nil];
    self.window.rootViewController = self.viewController;
    [self.window makeKeyAndVisible];

    imgv = [[UIImageView alloc] init];
    [imgv setImage:[UIImage imageNamed:@"Default.png"]];
    [imgv setFrame:CGRectMake(0, 0, 320, 480)];
    [self.window addSubview:imgv];

    return YES;
}

@end 
```

## **视图控制器.m：**

```
//
//  ViewController.m
// 
//
//  Created by Macintosh User on 6/4/12.
//  Copyright (c) 2012 __MyCompanyName__. All rights reserved.
//

#import "AppDelegate.h"
#import "ViewController.h"

@implementation ViewController

#pragma mark - View lifecycle

- (void)viewDidLoad
{
    CGRect webFrame = CGRectMake(0.0, 0.0, 320.0, 460.0);
    UIWebView *webView = [[UIWebView alloc] initWithFrame:webFrame];
    [webView setBackgroundColor:[UIColor clearColor]];
    NSString *urlAddress = @"http://www.cnn.com";
    NSURL *url = [NSURL URLWithString:urlAddress];
    NSURLRequest *requestObj = [NSURLRequest requestWithURL:url];
    [webView loadRequest:requestObj];

    for (id subview in webView.subviews)
        if ([[subview class] isSubclassOfClass: [UIScrollView class]])
            ((UIScrollView *)subview).bounces = NO;

    AppDelegate *appDelegate = (AppDelegate *)[[UIApplication sharedApplication] delegate];
    UIImageView *imageView = appDelegate.imgv;
    [imageView removeFromSuperview];
    [imageView setHidden:YES];
    imageView = nil;

    [self.view addSubview:webView];
    [self.view bringSubviewToFront:webView];
    [super viewDidLoad];
    // Do any additional setup after loading the view, typically from a nib.
    NSLog(@"Done loading UIWebView");
}

@end 
```

**当前 ViewController.m 生成错误：**

```
//
//  ViewController.m
//  Stroll
//
//  Created by Macintosh User on 6/4/12.
//  Copyright (c) 2012 __MyCompanyName__. All rights reserved.
//

#import "AppDelegate.h"
#import "ViewController.h"

@implementation ViewController

@synthesize splash;

#pragma mark - View lifecycle

- (void)viewDidLoad
{
    CGRect webFrame = CGRectMake(0.0, 0.0, 320.0, 460.0);
    UIWebView *webView = [[UIWebView alloc] initWithFrame:webFrame];

    webView.delegate = self;

    [webView setBackgroundColor:[UIColor clearColor]];
    NSString *urlAddress = @"http://www.cnn.com";
    NSURL *url = [NSURL URLWithString:urlAddress];
    NSURLRequest *requestObj = [NSURLRequest requestWithURL:url];
    [webView loadRequest:requestObj];

    for (id subview in webView.subviews)
        if ([[subview class] isSubclassOfClass: [UIScrollView class]])
            ((UIScrollView *)subview).bounces = NO;

    /*
    AppDelegate *appDelegate = (AppDelegate *)[[UIApplication sharedApplication] delegate];
    UIImageView *imageView = appDelegate.imgv;
    [imageView removeFromSuperview];
    [imageView setHidden:YES];
    imageView = nil; */

    [self.view addSubview:webView];
    [self.view bringSubviewToFront:webView];
    [super viewDidLoad];
    // Do any additional setup after loading the view, typically from a nib.
    NSLog(@"Done loading UIWebView");
}

- (void)viewWillAppear:(BOOL)animated
{
    [super viewWillAppear:animated];

    static dispatch_once_t onceToken;
    dispatch_once(&onceToken, ^{

        self.view.userInteractionEnabled = NO;

        splash = [[UIImageView alloc] initWithFrame:[UIScreen mainScreen].bounds];

        splash.image = [UIImage imageNamed:@"Default.png"];
        [self.view addSubview:splash];
    });
}

-(void) webViewDidFinishLoad:(UIWebView *)webView {

    static dispatch_once_t onceToken;
    dispatch_once(&onceToken, ^{
        [splash removeFromSuperView];
    });
}

@end 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-13T22:19:48.370

这是实现它的一种方法，首先摆脱 AppDelegate 中的所有代码。在你的根视图控制器中添加一个名为“splash”的类 UIImageView 的实例变量。

现在在 rootViewController.m 中：

```
-(void) viewWillAppear:(BOOL) animated {

    static dispatch_once_t onceToken;
    dispatch_once(&onceToken, ^{

        self.view.userInteractionEnabled = NO;

        splash = [[UIImageView alloc] initWithFrame:[UIScreen mainScreen].bounds];

        splash.image = [UIImage imageNamed:@"Default.png"];
        [self.view addSubview:splash];
    });
    } 
```

现在在你的 webView 加载完成回调方法/块

```
static dispatch_once_t onceToken;
        dispatch_once(&onceToken, ^{

          [splash removeFromSuperView];
        }); 
```

因此 dispatch_once 确保该方法将在应用程序的生命周期中运行一次且仅运行一次。

编辑：

要获得您的回调：

在 viewController.h -> viewC 中： UIViewController < UIWebViewDelegate >

在 viewController.m

```
-(void) viewDidLoad{

    CGRect webFrame = CGRectMake(0.0, 0.0, 320.0, 460.0);
    UIWebView *webView = [[UIWebView alloc] initWithFrame:webFrame];

    webView.delegate = self;

    [webView setBackgroundColor:[UIColor clearColor]];
    NSString *urlAddress = @"http://www.cnn.com";
    NSURL *url = [NSURL URLWithString:urlAddress];
    NSURLRequest *requestObj = [NSURLRequest requestWithURL:url];
    [webView loadRequest:requestObj];
} 
```

然后

```
-(void) webViewDidFinishLoad:(UIWebView *)webView {

    static dispatch_once_t onceToken;
        dispatch_once(&onceToken, ^{

          [splash removeFromSuperView];
        });
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-13T21:53:18.507

Default.png 默认用作启动画面，然后自动删除。但是您创建另一个实例并自己将其放置到视图中。删除这部分代码

```
imgv = [[UIImageView alloc] init];
[imgv setImage:[UIImage imageNamed:@"Default.png"]];
[imgv setFrame:CGRectMake(0, 0, 320, 480)];
[self.window addSubview:imgv]; 
```

从你的`application:didFinishLaunchingWithOptions:`方法

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-18T02:31:42.743

[第一个 ViewController.m]

闪屏没有消失的原因是因为在将闪屏添加到屏幕窗口之前调用了ViewController中的ViewDidLoad。

具体来说，ViewDidLoad 方法是在 [self.window makeKeyAndVisible] 周围调用的，就在调用启动画面之前。

[第二个ViewController.m]

由于两个原因，您可能不想在此处添加启动屏幕：1）在 ViewWillAppear 处，可能尚未创建视图；和 2) ViewWillAppear: 可以被多次调用，你可能并不真正想要。

【可行的方法】

一种可行的方法（我正在使用的方法）是您的第一次和第二次试验的组合。我是说

1.  在 AppDelegate 中的窗口上添加启动画面；
2.  做一些后台任务来获取数据（例如，或者加载一个 webview）；
3.  任务完成后，发布通知。注册到 TaskDoneNotification 的启动屏幕将处理必要的清理并将其自身从其超级视图中删除。

完毕

# oauth - 龙卷风 oauth 查询（推特）

> ID：11023201
> 
> 赞同：0
> 
> 时间：2012-06-13T20:59:58.587
> 
> 标签：oauth, tornado

我正在使用 tornado 框架来使用 Twitter API。我不明白为什么我会得到一个带有 next 值的回调 url

```
auth/login?next=%2F%3Foauth_token%3D 
```

我了解 /auth/login 是我在 AuthLoginHandler 期间设置的。但我不明白在 url 中设置下一个令牌的内容是什么。这使我的另一个论点

```
self.get_argument('oauth_token', None) 
```

返回无。

我知道我们仍然可以解析 url 以获取 oauth_token，但是任何关于 TwitterMixin 或默认 Oauth 类的龙卷风如何做到这一点的见解。我是龙卷风的新手

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-02T15:40:31.290

首先，您可以忽略“下一个”参数，直到您的核心代码正常工作。

'next' 是一个额外的参数，因此您可以将用户转发到您要求的原始页面，如下所示：

```
self.redirect(self.get_argument('next', '/')) 
```

在对 get_current_user 的调用返回 None 之后，[此处的请求处理程序](http://www.tornadoweb.org/documentation/_modules/tornado/web.html#authenticated)中添加了“下一个”参数。[即用户未登录]

[Tornado 文档](http://www.tornadoweb.org/documentation/auth.html#twitter)描述了如何为 Twitter 编写处理程序。

# jquery - Mediaelement 全屏 Flash 后备在 IE7 或 IE8 中无法缩放

> ID：11023204
> 
> 赞同：2
> 
> 时间：2012-06-13T21:00:02.540
> 
> 标签：jquery, html, video, html5-video, mediaelement.js

我有一个使用 MediaElement JS 和一些自定义 jQuery 开发的视频幻灯片播放器。

关于播放器的一切都很好，并且完全按照我的需要做，除了一件事。

在 IE7 和 IE8 中，它使用 flash 后备，每当它使用 flash 后备时，它仍然会全屏显示，但视频不会缩放。它只是保持相同的尺寸并获得一个大的黑色背景。

这确实是一个问题，因为全屏功能对于阅读视频上的某些文字很重要。有没有人遇到过这个？

这是我正在使用的代码：

```
<video id="slide-video" src="/Slides/1.mp4" controls="controls" width="565" height="425">
  <object width="565" height="425" type="application/x-shockwave-flash" data="/js/flashmediaelement.swf">
    <param name="movie" value="/js/flashmediaelement.swf" />
    <param name="flashvars" value="controls=true&amp;file=/Slides/1." />
  </object>
</video> 
```

这是我正在使用的 JavaScript

```
<script type="text/javascript">
$('.scroll-pane').jScrollPane();

var autoPlay = true;
var currChapter = 1;
var currSlide = 1;
var player;

$(document).ready(function () {
    player = new MediaElementPlayer('#slide-video', {
        plugins: ['flash'],
        pluginPath: '<%=SkinPath %>MediaElement/',
        flashName: 'flashmediaelement.swf',
        success: function (mediaElement, domObject) {
            // add event listener
            mediaElement.addEventListener('ended', videoEnded, false);

            if ($.browser.msie && $.browser.version != '9.0' || $.browser.mozilla) {
                if (autoPlay)
                    loadSlide(1, 1);
            }
        }
    });

    $('ul.chapter li img').bind('click', function () {
        loadSlide($(this).attr('chapter'), $(this).attr('slide'));
    });

    if (!$.browser.msie && !$.browser.mozilla || $.browser.msie && $.browser.version == '9.0') {
        if (autoPlay) {
            loadSlide(1, 1);
        }
    }
});

function videoEnded() {
    var nextSlide = parseInt(currSlide) + 1;

    if ($('img[chapter=' + currChapter + '][slide=' + nextSlide + ']').length == 0) {
        currChapter++;
        //nextSlide = 1;
    }

    currSlide++;

    if ($('img[chapter=' + currChapter + '][slide=' + nextSlide + ']').length > 0) {
        loadSlide(currChapter, nextSlide);
    }
}

function videoPrev() {
    var nextSlide = parseInt(currSlide) - 1;

    if ($('img[chapter=' + currChapter + '][slide=' + nextSlide + ']').length == 0) {
        currChapter--;
        //nextSlide = 1;
    }

    currSlide--;

    if ($('img[chapter=' + currChapter + '][slide=' + nextSlide + ']').length > 0) {
        loadSlide(currChapter, nextSlide);
    }
}

function loadSlide(chapter,slide) {
    currChapter = chapter;
    currSlide = slide;

    $('.current-slide').text(slide);

    $('.slide-text-wrap div[slide]').hide();
    $('div[slide=' + slide + '].slide-text').show();

    var imageFile = $('img[chapter=' + chapter + '][slide=' + slide + ']').attr('src').replace('-thumb', '');

    $('.slide-img img:first').attr('src', imageFile);

    player.setSrc(imageFile.replace('.png', '.mp4'));
    player.play();
} 
```

它适用于我见过的播放器的其他实例。我正在使用除此之外的所有标准 JS 和 CSS 文件。

# wcf - 如何通过 HTTPS 在 WCF 中使用 WS-Security 服务？

> ID：11023215
> 
> 赞同：3
> 
> 时间：2012-06-13T21:00:36.597
> 
> 标签：wcf, soap, ws-security

我正在尝试使用 WCF 使用启用 WS-Security 的服务。身份验证使用 UsernameToken 进行。我对 WCF Web 服务客户端不是很了解，但我认为下面的配置适用于常规 HTTP 通信。我（大部分）使用[本指南](http://www.google.com/url?sa=t&rct=j&q=&esrc=s&source=web&cd=1&ved=0CGQQFjAA&url=http://download.microsoft.com/download/e/7/7/e77e5b26-1a19-49b7-b90c-d0847882e848/WCF%2520and%2520WS-Security%2520updated.doc&ei=J_3YT_A1k6LyBPfdpecD&usg=AFQjCNEakEb51jo0NdI-ViRSgMgV45FZWQ)来配置它。主要区别在于我使用了 VS2010 “添加服务参考” UI 而不是命令提示符。

我的问题是我需要通过 HTTPS 执行此操作。当我`<security mode="Message">`在我的 app.config 中使用时，我相信我的肥皂信封包含所需的 WS-Security 标头。我不能确定，因为我无法让日志记录工作。但是，我收到以下错误：`The provided URI scheme 'https' is invalid; expected 'http'. Parameter name: via`.

下面是我的 app.config 文件的内容，以及我的客户端代码示例。

```
<configuration>
  <system.serviceModel>
    <bindings>
      <wsHttpBinding>
        <binding name="Omitted" closeTimeout="00:01:00" openTimeout="00:01:00" receiveTimeout="00:10:00" sendTimeout="00:01:00" allowCookies="false" bypassProxyOnLocal="false" hostNameComparisonMode="StrongWildcard" maxBufferPoolSize="524288" maxReceivedMessageSize="65536" messageEncoding="Text" textEncoding="utf-8" useDefaultWebProxy="true">
          <readerQuotas maxDepth="32" maxStringContentLength="8192" maxArrayLength="16384" maxBytesPerRead="4096" maxNameTableCharCount="16384" />
          <security mode="Message">
            <transport clientCredentialType="None" proxyCredentialType="None" realm="" />
            <message clientCredentialType="UserName" algorithmSuite="Default" negotiateServiceCredential="false" />
          </security>
        </binding>
      </wsHttpBinding>
    </bindings>
    <client>
      <endpoint address="https://omitted.com/service" binding="wsHttpBinding" bindingConfiguration="Omitted" contract="Omitted.Omitted" name="Omitted" />
</client>
  </system.serviceModel> 
```

```
var service = new OmittedClient();
service.ClientCredentials.UserName.UserName = "username";
service.ClientCredentials.UserName.Password = "password";    
var response = service.DoSomething(new DoSomethingRequest()); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-19T16:43:22.580

感谢 500 - Internal Server error 帮助我解决了这个问题。以下是我采取的步骤：

1.  使用 Visual Studio/WCF 生成代理。
2.  将安全模式更改为 TransportWithmessageCredential。
3.  使用以下代码指定用户名/密码。

```
    var client = new WebServiceClient();
    client.ClientCredentials.UserName.UserName = "用户名";
    client.ClientCredentials.UserName.Password = "密码";

```

1.  如果您收到响应，但 WCF 在处理它时抱怨，则响应中可能缺少时间戳。如果是这种情况，请尝试修复它。

```
    // WCF 抱怨缺少时间戳 (http://www.west-wind.com/weblog/posts/2007/Dec/09/Tracing-WCF-Messages)
    var 元素 = service.Endpoint.Binding.CreateBindingElements();
    elements.Find().IncludeTimestamp = false;
    service.Endpoint.Binding = new CustomBinding(elements);

```

# python - 我不明白我的退货声明中发生了什么

> ID：11023218
> 
> 赞同：0
> 
> 时间：2012-06-13T21:00:48.653
> 
> 标签：python, python-2.7

我需要帮助理解函数中发生的事情，尤其是返回语句。我知道 return 语句做了什么，但不知道它们是如何做的。我知道他们格式化了字符串，但我只是不明白它是如何完成的。如果你们一步一步来，那会有所帮助。

```
def intF(n, d, l=40):

    s=str(n*10**l / d) 
    if len(s) < l: 
        return '0.{:0>{width}}'.format(s,width=l) 
    if len(s) > l: 
        return s[0:len(s)-l]+'.'+s[len(s)-l:]  

    return '0.'+s 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-06-13T21:52:39.270

以下是逐行细分：

```
def intF(n, d, l=40): 
```

很明显。`n`是一个数字，`d`是另一个数字（除数），`l`是小数点后要打印的位数。

```
 s=str(n*10**l / d) 
```

这有点不寻常。这不是依赖浮点运算，而是乘以`n`，`10 ** l`即乘以 a`1`后跟`l`数字。这样最终结果不会有任何浮点错误——假设`d`总是一个整数。（当然，任何剩余的数字都会被截断。另外，在 Python 3 中替换`/`为`//`以获得相同的行为。）

此时，`s`将是一个整数的字符串表示形式——再次假设是一个*整数*`d`——但它将与. 所以现在我们只需要在正确的位置插入小数点。*`float(n) / d`*

 *```
 if len(s) < l: 
        return '0.{:0>{width}}'.format(s,width=l) 
```

如果 的长度`s`小于`l`，那么我们需要填充它并在前面加上`0.`。这就是这样做的。该`{:0>{width}}`字段表示要创建一个宽度为零的填充字段，并在右侧 ( ) 侧`width`插入一个值。`>`然后`s`通过 via 传入`format`，我们得到了结果。

```
 if len(s) > l: 
        return s[0:len(s)-l]+'.'+s[len(s)-l:] 
```

如果 的长度`a`大于`l`，那么我们需要在正确的位置插入小数点。这就是这样做的。它从 中删除尾随`l`数字`s`，附加 a `.`，然后附加剩余的`l`数字。

```
 return '0.'+s 
```

最后一种可能性是`s`正好是`l`数字长。在这种情况下，我们不需要做任何填充；我们可以在前面加上`0`一个小数点。

最后一点：如果您向此函数传递除整数以外的任何内容，它将无法按预期工作。考虑一下：

```
>>> intF(10, 10.1, 10)
'990.0990099.01' 
```

或这个：

```
>>> intF(10.1, 10, 10)
'101.00000000.0' 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-13T21:55:17.397

该行通过将比率乘以得到小数点右侧的数字，`s=str(n*10**l / d)`将比率转换为整数。`n/d``10**l``l`

之后，它会测试结果中的位数。如果它小于“l”，则该比率小于 0.1。如果它大于“l”，则大于或等于 1.0。如果介于两者之间，则该比率在 0.1 和 1.0 之间。

该表达式`'0.{:0>{width}}'.format(s,width=l)`是放置前导“0”的一种奇特方式。在前面并填写必要数量的“0”以使其精确到`l`小数点。

该表达式`s[0:len(s)-l]+'.'+s[len(s)-l:]`只是在字符串中间的适当位置放置一个小数点。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-13T21:19:33.190

您正在根据传递给函数的变量创建一个字符串。然后它检查字符串的长度，如果它小于 1，则返回它的格式，大于 1，它的格式，并且作为回退默认值，当它的长度为 1 个字符时，返回另一种格式。*

# onload - 滚动到打开时在 jQuery 对话框中具有类的最后一行

> ID：11023219
> 
> 赞同：2
> 
> 时间：2012-06-13T21:00:50.167
> 
> 标签：onload, jquery-dialog, scrolltop

用一个较长的表填充一个 jQuery UI 对话框，我想让它滚动到具有特定类的表中的最后一行。[我在这里](https://stackoverflow.com/questions/9888585/jquery-dialog-scroll-to-element-in-dialog "这里")和[这里](https://stackoverflow.com/questions/2905867/how-to-scroll-to-specific-item-using-jquery)发现了几乎与此相同的另外两个帖子，但我无法让它工作。我在[jsFiddle](http://jsfiddle.net/wallabykid/e6rDT/)上对其进行了模拟，希望有人可以帮助我看到我对它的思考中的错误。

这是基本代码

```
 jQuery(document).ready(function() {
    var content = jQuery('#amtz_div').html();
    var title = 'Amortization Schedule';
    var open = function() {
        var container = jQuery(".ui-dialog");
        var target = jQuery('tr.amortized:last');
        container.scrollTop(target.offset().top - container.offset().top + container.scrollTop());
        target.css('background', 'red');
    }
    jQuery("#dialog").attr('title', title).html(content).dialog({
        modal: true,
        width: 400,
        height: 400,
        resizable: false,
        open: open
    });
}); 
```

我还尝试了 scrollTo 插件（在上面链接的帖子之一中提到），但现在运气更好了。

有什么想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-24T16:27:50.523

我不确定它是新版本`jQuery UI`还是我们已经远离这个，但在你的情况下将标识符从 .ui-dialog 更改为 #dialog 工作。我要看看这是否也适合我！

[解决方案](http://jsfiddle.net/e6rDT/4/)

# c# - 无法将“OpenQA.Selenium.Remote.RemoteWebElement”类型的对象转换为“System.Collections.Generic.Dictionary”2 [System.String,System.Object]

> ID：11023223
> 
> 赞同：3
> 
> 时间：2012-06-13T21:01:01.917
> 
> 标签：c#, web, selenium-webdriver, timing

我正在尝试使用 Web Timing API 和 Selenium 2 webdrivers 和 C# 来捕获我的网页加载的各种事件（以捕获性能）所花费的时间

基本上这个想法（最初来自 Mozilla 团队的开发人员）来自 Dean Hume 的博客文章...... [http://deanhume.com/Home/BlogPost/measuring-web-page-performance-with-selenium-2-and- the-web-timings-api/56](http://deanhume.com/Home/BlogPost/measuring-web-page-performance-with-selenium-2-and-the-web-timings-api/56)

我无耻地复制了扩展类并编写了几个方法来获取我想要的格式的数字..

```
public static class Extensions
{
    public static Dictionary<string, object> WebTimings(this IWebDriver driver)
    {
        const string scriptToExecute =
            "var performance = window.performance || window.mozPerformance || window.msPerformance || window.webkitPerformance || {}; var timings = performance.timing || {}; return timings;";

        var webTiming = (Dictionary<string, object>)((IJavaScriptExecutor)driver)
            .ExecuteScript(scriptToExecute);

        return webTiming;
    }
} 
```

我的方法会给我时差......

```
 //InternetExplorerOptions options = new InternetExplorerOptions();
        //options.IntroduceInstabilityByIgnoringProtectedModeSettings = true;
        //options.UseInternalServer = true;
        //IWebDriver _driver = new InternetExplorerDriver(options);

        IWebDriver _driver = new FirefoxDriver();

        //IWebDriver _driver = new ChromeDriver();

        Program p = new Program();

        _driver.Manage().Timeouts().ImplicitlyWait(new TimeSpan(0, 0, 30));
        _driver.Navigate().GoToUrl("http://www.google.com");

        Dictionary<string, object> webTimings = _driver.WebTimings();
        Dictionary<string, Int64> timeinSec = new Dictionary<string, Int64>();

        timeinSec.Add("ConnectTime", p.GetTimeDiff(webTimings["connectEnd"], webTimings["connectStart"])); 
```

当我使用 InternetExplorerDriver(options) 时，我遇到了这个异常。但相同的代码适用于 Firefox 和 chrome 驱动程序。

IE 总是让人头疼，而且事实证明它继续如此 ** 我不明白我还能如何投射`.ExecuteScript(scriptToExecute);`返回的内容......？

在这里欣赏任何输入..

```
Unhandled Exception: System.InvalidCastException: Unable to cast object of type
'OpenQA.Selenium.Remote.RemoteWebElement' to type 'System.Collections.Generic.Di
ctionary`2[System.String,System.Object]'.
   at Selenium.Examples.Performance.Extensions.WebTimings(IWebDriver driver) in
C:\Users\......\Extensions.cs:line 13
   at PerfCaptureSample.Program.Main(String[] args) in C:\.........\Program.cs:line 52 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2016-02-16T17:04:45.260

虽然老得令人难以置信，但我遇到了同样的问题。我发现您可以使用 toJSON 转换对象并正确返回。工作代码如下：

```
return timings.toJSON(); 
```

最终代码是：

```
public static class Extensions
{
    public static Dictionary<string, object> WebTimings(this IWebDriver driver)
    {
        const string scriptToExecute =
            "var performance = window.performance || window.mozPerformance || window.msPerformance || window.webkitPerformance || {}; var timings = performance.timing || {}; return timings.toJSON();";

        var webTiming = (Dictionary<string, object>)((IJavaScriptExecutor)driver)
        .ExecuteScript(scriptToExecute);

        return webTiming;
    }
} 
```

# java - 尽管堆保持不变，Java RAM 会增加？

> ID：11023224
> 
> 赞同：1
> 
> 时间：2012-06-13T21:01:03.787
> 
> 标签：java, glassfish, heap-memory, stack-memory

> **可能重复：**
> [限制 ubuntu 上的 jvm 进程内存](https://stackoverflow.com/questions/9145769/limit-jvm-process-memory-on-ubuntu)

在我的应用程序中，我将文档上传到服务器，该服务器对其进行了一些分析。

今天我使用 jconsole.exe 和堆转储分析了我的应用程序，因为我试图找出我是否有内存问题/内存泄漏。我想我可能会遇到一个问题，因为在应用程序运行时我的应用程序在 RAM 上增长得非常快。

当我在一些运行后使用 jconsole 观察堆 / 代码缓存 / perm gen 等内存时，我很惊讶，因为我看到了以下内容：

![查看](../Images/5dedac461f272c500028b5174be8b335.png)

图片链接：[https ://www7.pic-upload.de/13.06.12/murk9qrka8al.png](https://www7.pic-upload.de/13.06.12/murk9qrka8al.png)

正如您在右侧的 jconsole 中看到的那样，当我在做与分析相关的事情时，堆正在增加，但当工作结束时，它也会再次减小到正常大小。在左侧，您可以看到部署应用程序的服务器的“htop”。就是这样：虽然堆正常运行，而且垃圾收集器似乎也运行正常，但 RAM 是**令人难以置信**的高，几乎达到 3,2gb。

现在这真的让我很困惑。我在想我的 java vm 堆栈是否必须对此做些什么？我做了一些研究，我发现 vm 堆栈是一个只有几兆字节（甚至只有 kb）的小内存。

**我的技术背景：**

*   该应用程序在 glassfish v.3.1.2 上运行
*   数据库在 MySQL 上运行
*   Hibernate 用作 ORM 框架
*   Java版本是1.7.0_04
*   它是使用 VAADIN 实现的
*   MySQL 数据库和 glassfish 是这台服务器上唯一运行的东西
*   我在分析期间使用 JAXB 构建 XML-DOM 样式的文档并将它们保存在数据库中
*   上传的文件是 .txt 或 .pdf 文件
*   操作系统是linux

**解决方案？**

**你有什么想法为什么会发生这种情况以及我能做些什么来解决它？**此刻我真的很惊讶，因为我认为内存问题来自导致堆爆炸的内存泄漏。但是现在，堆不是问题。当堆保持在同一级别时，RAM 会越来越高。而且我不知道该怎么做才能解决它。

**感谢您与我分享的每一个想法。**

编辑：也许我还应该指出，这种行为目前使我无法真正让其他人使用我的应用程序。当 RAM 已满且服务器不再响应时，我就退出了。

**Edit2：也许我还应该补充一点，每次成功进行进一步分析后，这个 RAM 都会不断增加。**

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-13T21:56:37.210

### 在 JVM 实现中使用内存的东西比堆设置要多得多。

Heap 设置`-Xmx`仅控制 Java Heap，它不控制JVM 对*本机内存*的消耗，根据实现，其消耗完全不同。

来自以下文章[感谢内存（了解 JVM 如何在 Windows 和 Linux 上使用本机内存）](http://www.ibm.com/developerworks/java/library/j-nativememory-linux/)

维护堆和垃圾收集器使用您无法控制的本机内存。

> 需要更多的本机内存来维护维护 Java 堆的内存管理系统的状态。收集垃圾时，必须分配数据结构来跟踪空闲存储和记录进度。这些数据结构的确切大小和性质因实现而异，但许多与堆的大小成正比。

`javac`并且 JIT 编译器像使用本机内存一样

> 字节码编译使用本机内存（与 gcc 等静态编译器需要内存才能运行的方式相同），但 JIT 的输入（字节码）和输出（可执行代码）也必须存储在本机内存中。包含许多 JIT 编译方法的 Java 应用程序比较小的应用程序使用更多的本机内存。

然后你有使用本机内存的类加载器

> Java 应用程序由定义对象结构和方法逻辑的类组成。它们还使用 Java 运行时类库中的类（例如 java.lang.String），并且可能使用第三方库。只要使用这些类，就需要将它们存储在内存中。类的存储方式因实现而异。

我什至不会开始引用有关线程的部分，我认为您会认为 Java 堆并不是 JVM 实现中唯一消耗内存的东西，并非所有东西都在 JVM 堆中，并且堆占用了方式比您指定用于管理和簿记的更多本机内存。

### 本机代码

应用服务器很多时候都有在 JVM 之外运行的本机代码，但仍向操作系统显示为与控制应用服务器的进程相关联的内存。

# file - 在 Linux 上使用 D 如何确定文件是否隐藏？

> ID：11023234
> 
> 赞同：2
> 
> 时间：2012-06-13T21:01:51.090
> 
> 标签：file, attributes, d

我正在创建一个简单的文件遍历器来列出一些文件，并且需要从结果中省略隐藏文件。我目前正在做这样的事情：

```
private void Walk()
{
    this.Files          = [];
    this.Directories    = [];
    DirIterator Entries = dirEntries(this.Directory, SpanMode.depth, this.FollowSymLinks);

    foreach (DirEntry Entry; Entries)
    {
        version(Windows)
        {
            uint Attributes = Entry.attributes();
            if (Attributes & FILE_ATTRIBUTE_HIDDEN)
            {
                continue;
            }
        }

        version(linux)
        {
            // ?????
        }

        if (Entry.isFile())
        {
            this.Files ~= Entry.name;
            this.NumberOfFiles++;
        }

        if (Entry.isDir())
        {
            this.Directories ~= Entry.name;
            this.NumberOfDirectories++;
        }
    }

    this.Walked = true;
} 
```

windows 部分似乎工作正常，但我需要为 Linux 部分做些什么来确定文件是否隐藏？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-13T21:03:28.843

在linux中，如果文件/目录以a开头，则它们是隐藏的，`.`因此请检查文件/目录名称是否以a开头`.`

例如

`.m2/`并且`.somefile.txt`会隐藏在 linux 上`m2/`和`somefile.txt`不会的地方。

# javascript - 如何使用 javascript var 在 url 上添加一个值

> ID：11023235
> 
> 赞同：0
> 
> 时间：2012-06-13T21:01:58.400
> 
> 标签：javascript, jquery, jquery-ui

当弹出窗口出现时，有没有办法在 url 上添加选择结果？选择结果给出了选定框的值，我想将选定的值传递给表单，但我没有使用表单。我可以使用 url 传递值吗？

我想添加选定的值，如 form.php?id=2882,222,22412,23

```
$(function() {
    $(".selectable").selectable({
        filter: "td.cs",
        stop: function() {
            var result = $("#select-result").empty();
            var result2 = $("#result2");
            $('.ui-selecting:gt(31)').removeClass("ui-selecting");
            confirmation($(".ui-selected").length + " box selected. " + ($(".ui-selected").length));
            function confirmation() {
                var answer = confirm($(".ui-selected").length + " box selected.  " + ($(".ui-selected").length));
                if (answer) {
                    window.open("form.php", "mywindow", "menubar=no,resizable=no,width=650,height=700");
                }
                else {}
            }
            $('#divmsg').html($(".ui-selected").length + " box selected")
            $('#divmsg2').html($(".ui-selected").length)
            if ($(".ui-selected").length > 90) {
                alert("Selection of only 90 boxes allowed");
                $('#divmsg').html($('#divmsg').html() + ",<br><b>Message: Selection of only 90 pixels allowed!!</b>");
                $(".ui-selected").each(function(i, e) {
                    if (i > 3) {
                        $(this).removeClass("ui-selected");
                    }
                });
                return;
            }
            $(".ui-selected", this).each(function() {
                var cabbage = this.id + ', ';
                result.append(cabbage);
            });
            var newInputResult = $('#select-result').text();
            newInputResult = newInputResult.substring(0, newInputResult.length - 1);
            result2.val(newInputResult);
        }
    });
});​ 
```

这是小提琴[http://jsfiddle.net/dw6Hf/57/](http://jsfiddle.net/dw6Hf/57/)

我试过了

window.open ("form.php?id="+ select-result, "mywindow",....

但它不会工作！任何的想法？？？提前致谢​</p>

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-13T21:27:47.447

如果你在问我认为你在问什么，并且`selectable`按照我的想法去做，那么试试这个：

```
window.open("form.php?id=" + $('#select-result').text(), "mywindow", "menubar=no,resizable=no,width=650,height=700"); 
```

如果这不起作用，那么我显然误解了你的答案。我建议清理它，也许可以启动并运行一个工作示例供我们查看。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-13T21:34:25.980

首先，您发布的小提琴已损坏。[但不用担心，我已经将它与http://jsfiddle.net/paragnair/dw6Hf/61/](http://jsfiddle.net/paragnair/dw6Hf/61/)上的解决方案一起修复了

我添加了以下行：

```
var selectedIds = $.map($('.ui-selected'),function(a){ return $(a).attr('id');}).join(','); 
```

上面的行获取了所有具有 class 的元素的 id 列表`ui-selected`。然后您可以将变量附加`selectedIds`到`window.open`如下所示：

```
window.open("form.php?id=" + selectedIds, "mywindow", "menubar=no,resizable=no,width=650,height=700"); 
```

# math - 为什么 0xff & abcd 会截断 abcd 的一半？

> ID：11023236
> 
> 赞同：0
> 
> 时间：2012-06-13T21:02:15.033
> 
> 标签：math, binary, hex

我可以理解二进制运算`11 & x`，例如如果x = 1011，则运算将从x中取出10，将x留下为11。但是，当涉及到十六进制时，我很困惑。类似效果背后的数学和推理是`0xff & x`什么？如果我将它们全部转换为二进制，我只能理解这一点。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-13T21:05:45.593

`0xFF & 0xABCD = 0xCD`... 为什么？

```
Because:
A = 1010
B = 1011
C = 1100
D = 1101

F = 1111

So the 0xFF = 0x00FF = 0000 0000 1111 1111
The 0xABCD           = 1010 1011 1100 1101 
                       ------------------- 
0xFF & 0xABCD        = 0000 0000 1100 1101 
```

与大多数事情一样，一旦您使用 hex 一段时间，您将学习一些记住值的技巧。

# android - Android 4 - 自动对焦后相机白平衡停止

> ID：11023242
> 
> 赞同：6
> 
> 时间：2012-06-13T21:02:32.113
> 
> 标签：android, camera, autofocus

在我当前的应用程序中，我有一个类包含一个 Camera 对象的实例并尝试执行以下操作：

1) 等待指定时间，例如什么都不做（通过 TimerTask 完成） 2) 通过 autoFocus 请求聚焦 3) 在 autoFocus 回调中，请求 OneShotPreviewCallback 4) 在预览回调中，保存图像 5) 重复

虽然白平衡在第一次自动对焦之前工作正常，但在第一次对焦完成后停止。好吧，当然我查了 API，在 autoFocus 描述中有一个有趣的语句。

> 但自动对焦程序可能会在对焦期间暂时停止自动曝光和自动白平衡。

但似乎它只是暂时的，而是永久的。有趣的是，在随后调用 autoFocus 时，相机会再次尝试调整白化，但正确的值大多只有第二个或第三个 autoFocus。

我也尝试在代码中设置白平衡，但它没有改变任何东西。

```
setWhiteBalance(Camera.Parameters.WHITE_BALANCE_AUTO); 
```

有没有其他人知道这个问题，或者我错过了一些观点？我知道我可以永久调用 autoFocus 来强制进行白平衡，但这对我来说似乎不是最佳方式，因为在第一次调用 auf autoFocus 之前，它工作得非常好。

PS：我正在使用 Android 4.0.3 的三星 Galaxy S2 上进行测试。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2014-05-27T14:38:50.170

我在三星 Galaxy 2 Duos 2 上遇到过类似的问题。在这种情况下，自动曝光设置已停止工作，而不是 WB。我试图循环（开/关）自动曝光参数，它对我有用。

```
mCamera.autoFocus(new Camera.AutoFocusCallback() {

    @Override
    public void onAutoFocus(boolean b, Camera camera) {

        Camera.Parameters params = camera.getParameters();
        if (params.isAutoExposureLockSupported()) {
            params.setAutoExposureLock(true);
            camera.setParameters(params);

            params = camera.getParameters();
            params.setAutoExposureLock(false);
            camera.setParameters(params);
        }
     }

 }); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-27T16:09:05.657

我在三星 Galaxy Ace 上遇到了类似的问题 - 在第一次自动对焦后，相机白平衡会关闭并且不会再次打开，无论我做了多少次自动对焦。

由于没有 API 方法可以告诉相机恢复白平衡，并且在自动对焦回调中重置相机参数并不能解决问题，我猜这是三星手机相机驱动程序中的错误 - 我已经尝试过我的应用程序使用不同的手机并且仅在这款三星 Galaxy Ace（GT-S5830；更新至 Android 2.3.3）上，自动对焦后相机白平衡不会恢复。

也许我们应该在 developer.samsung.com 上开一张 bug 票？

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2014-02-25T19:38:36.787

It seems that mCamera.stopPreview(); mCamera.startPreview(); in AutoFocusCallback can enable auto exposure again, but bringing a very short pause on the preview as side effect.

# sencha-touch-2 - Sencha Touch 2 添加图标到嵌套列表

> ID：11023245
> 
> 赞同：1
> 
> 时间：2012-06-13T21:02:40.027
> 
> 标签：sencha-touch-2, sencha-architect

我正在尝试使用 NestedList 的 getItemTextTpl 方法将图像添加到嵌套列表中。你能看看下面的代码，让我知道如何修复它吗？这是使用 Sencha Architect 开发的。谢谢你的帮助。

```
Ext.define('myapp.view.ListContainer', {
    extend: 'Ext.Container',
    alias: 'widget.listcontainer',

    config: {
        layout: {
            type: 'fit'
        },
        tpl: [
            ''
        ],
        items: [
            {
                xtype: 'nestedlist',
                id: 'myList',
                itemId: 'mynestedlist4',
                detailCard: {
                    xtype: 'mytabs'
                },
                store: 'myStore',
                toolbar: {
                    xtype: 'titlebar',
                    docked: 'bottom',
                    ui: 'dark'
                }
            }
        ],
        listeners: [
            {
                fn: 'getItemTextTpl',
                event: 'getItemTextTpl',
                delegate: '#myList'
            }
        ]
    },

    getItemTextTpl: function(node) {
        return '<img class="eventIcon" src="http://localhost/images/test.png">';

    }

}); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-14T21:24:47.857

```
Ext.define('myapp.view.myList', {
    extend: 'Ext.dataview.NestedList',
    alias: 'widget.mynestedlist',

    config: {
        id: 'myList',
        detailCard: {
            xtype: 'mytabs'
        },
        displayField: 'text',
        store: 'myStore'
    },

    getItemTextTpl: function(recordnode) {
        return '<img class="eventIcon" src="http://localhost/images/test.png">'; 
    }

}); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-14T20:45:30.987

只是一个快速提示。[FontAwesome](http://fortawesome.github.com/Font-Awesome/)是一种为您的应用程序轻松添加漂亮图标的好方法。

# sql - 如何检查两个有序 SQL 查询的结果是否匹配？

> ID：11023246
> 
> 赞同：5
> 
> 时间：2012-06-13T21:02:45.067
> 
> 标签：sql, oracle

问题是：我在一个表中有两列，对于每个分组，它们的顺序应该相同。在我做出假设之前，我想检查现有数据是否属实。

一些示例数据：

```
gid  c1  c2
1    1   5
1    2   7
2    1   22
2    2   38
2    3   40
3    1   4
3    2   8
3    3   2 
```

如您所见，如果我使用
`select * from table t where t.gid = 1 order by c1`
结果将是相同的，并且与
`select * from table t where t.gid = 1 order by c2`.
结果也将匹配 gid = 2。但是，如果我对 gid = 3 执行相同操作，则顺序将不再匹配。因为在这种情况下， ordering by`c2`与 ordering by 的结果不同`c1`。

我想检查整个表，以确保按这些列中的任何一个进行排序对于`gid`. Oracle`MINUS`将不起作用，因为它不允许 `order by`在子查询中使用。由于 的限制，我的第一次尝试`MINUS`是：

```
select gid, c1, c2 from table order by gid, c1, c2
  minus
select gid, c1, c2 from table order by gid, c2, c1; 
```

如果对答案有帮助，我正在使用 oracle 11g。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-13T21:11:39.117

[通过分配row_number](http://docs.oracle.com/cd/B19306_01/server.102/b14200/functions137.htm)，您可能会发现同一记录中的顺序不同。

```
with ordering as (
  select t.*,
         row_number() over (partition by gid
                            order by c1) order_c1,
         row_number() over (partition by gid
                            order by c2) order_c2
  from t
)
select *
  from ordering
 where order_c1 <> order_c2 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-13T21:21:32.020

有趣的问题，没有 Oracle 但类似

```
Select gid,c1,c2,row_number() as rownum from ordering order by gid,c1,c2
join (select gid,c1,c2,row_number() as otherrownum from ordering order by gid,c2,c1) otherOrdering
On rownum = otherrownum and 
((ordering.gid <> otherOrdering.gid) Or
(ordering.c1 <> otherOrdering.c1) or
(ordering.c2 <> otherOrdering.c2)) 
```

如果它返回任何东西，你的假设是不正确的。或者您可以将 <> 更改为 = 并将 Or 更改为 AND，它应该返回与表中相同的行数。

反正我觉得。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-13T21:08:26.797

我不确定 Oracle 上的 EXCEPT 等价物。但这在 MS SQL Server 上运行良好。

# ios - iOS - XML 到 NSString 的转换

> ID：11023248
> 
> 赞同：1
> 
> 时间：2012-06-13T21:02:50.200
> 
> 标签：ios, xml, xcode, nsxmlparser, nsstringencoding

我正在使用`NSXMLParser`将 XML 解析到我的应用程序并遇到编码类型问题。例如，这是进来的其中一个提要。它看起来类似于“

```
\U2026Some random text from the xml feed\U2026 
```

我目前正在使用编码类型：

```
NSData *data = [string dataUsingEncoding:NSUTF8StringEncoding]; 
```

我想使用哪种编码类型将 \U2026 转换为椭圆（...）？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-13T21:49:15.153

这里的答案是你搞砸了。他们对 XML 使用非标准编码，但如果他们真的想要文字`\U2026`怎么办？假设您添加了一个解码器来处理所有`\UXXXX`和`\uXXXX`编码。当另一个提要希望数据是文字时会发生什么`\U2026`？

您是首选，最好的办法是修复此提要。如果他们需要对数据进行编码，他们需要使用适当的 HTML 实体或数字引用。

作为后备，我会将解码器与 XML 解析器隔离开来。不要仅仅因为你得到不合格的数据就创建不合格的 XML 解析器。有一个只能在有问题的提要上运行的后处理器。

* * *

如果你必须有一个解码器，那么还有更多的坏消息。没有内置解码器，您需要在线查找类别或自己编写一个。

* * *

经过一番摸索，我认为[使用 Objective C/Cocoa 来取消转义 unicode 字符，即 \u1234](https://stackoverflow.com/questions/2099349/using-objective-c-cocoa-to-unescape-unicode-characters-ie-u1234)可能对你有用。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-13T21:51:23.840

好的，这是一段适用于任何 unicode 代码点的代码片段：

```
NSString *stringByUnescapingUnicodeSymbols(NSString *input)
{
    NSMutableString *output = [NSMutableString stringWithCapacity:[input length]];

    // get the UTF8 string for this string...
    const char *UTF8Str = [input UTF8String];

    while (*UTF8Str) {
        if (*UTF8Str == '\\' && tolower(*(UTF8Str + 1)) == 'u')
        {
            // skip the next 2 chars '\' and 'u'
            UTF8Str += 2;

            // make sure we only read 4 chars
            char tmp[5] = { UTF8Str[0], UTF8Str[1], UTF8Str[2], UTF8Str[3], 0 };
            long unicode = strtol(tmp, NULL, 16); // remember that Unicode is base 16

            [output appendFormat:@"%C", unicode];

            // move on with the string (making sure we dont miss the end of the string
            for (int i = 0; i < 4; i++) {
                if (*UTF8Str == 0)
                    break;
                UTF8Str++;
            }
        }
        else 
        {
            if (*UTF8Str == 0)
                break;

            [output appendFormat:@"%c", *UTF8Str];
        }

        UTF8Str++;
    }

    return output;
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-13T21:28:52.203

您应该简单地替换引号上的文字 '\U2026'，然后使用 NSUTF8StringEncoding encodind 将其编码为 NSData

# haskell - 我需要什么特殊的搜索词来查找有关编写外部 BBS 软件包的信息？

> ID：11023250
> 
> 赞同：1
> 
> 时间：2012-06-13T21:02:59.057
> 
> 标签：haskell

我正在考虑将我在 Haskell 中编写的基于文本的游戏制作成 BBS 软件包。我在查找有关编写最简单的 BBS 软件（例如回声服务器）的信息时遇到问题。我之前实现过一个简单的 telnet 服务器，但从来没有实现过 BBS 软件包。

我是不是在谷歌上搜索正确的关键字，还是那么简单？

理想情况下，我正在寻找有关制作 BBS 软件包的现有教程的链接。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-13T21:28:29.070

您可能想要一个支持您选择的语言和 BBS 的“门开发工具包”。您必须查阅特定 BBS 的文档以确定它支持哪些 dropfile 和门例程。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-13T23:12:53.447

不久前我实现了一个简单的基于 telnet 的 BBS：

```
darcs get http://src.seereason.com/happstack-bbs/ 
```

切换到拨号版本可能并没有那么大的变化。在 Linux 中，调制解调器连接只是像 /dev/modem 这样的设备，您可以像文件一样读取和写入。

因此，在 Telnet.hs 中，您将创建一个类似 runTelnetIO 的函数，该函数对文件句柄而不是套接字进行读取和写入。

接受补丁；）

也就是说，Telnet.hs 并不是我写过的最棒的代码。我想我是一次性完成的，所以我可以将它作为愚人节笑话发布。

# android - 如何在 Eclipse 中安装 m2e-android-plugin？

> ID：11023252
> 
> 赞同：8
> 
> 时间：2012-06-13T21:03:04.237
> 
> 标签：android, eclipse, maven, m2e

我正在尝试设置在 Eclipse 中为我的 Android 项目使用 Maven 和 pom.xml 文件。我安装了 Eclipse Indigo（包括 m2e），安装了 Android SDK，安装了 ADT。我正在努力理解“安装 m2e-android-plugin”的含义（我总是被带到[这个页面](http://rgladwell.github.com/m2e-android/)，它提供了安装它的说明，但我无法遵循）具体来说，当我浏览那个页面上的说明时，完成第 2 部分中的所有步骤后，我的结构没有“Maven 依赖项”，并且我的 pom.xml 文件显示以下错误：

```
Project build error: Unresolveable build extension: Plugin
com.jayway.maven.plugins.android.generation2:android-maven-plugin:3.1.1 or one of its dependencies could 
not be resolved: The following artifacts could not be resolved: 
com.jayway.maven.plugins.android.generation2:android-maven-plugin:jar:3.1.1, 
com.android.ddmlib:ddmlib:jar:r16, org.sonatype.sisu:sisu-inject-bean:jar:2.1.1,     
org.sonatype.sisu:sisu-guice:jar:no_aop:2.9.4, org.codehaus.plexus:plexus- archiver:jar:2.0.1, junit:junit:jar:3.8.1, 
org.codehaus.plexus:plexus-io:jar:2.0.1, org.codehaus.plexus:plexus-utils:jar:3.0, commons-jxpath:commons-
jxpath:jar:1.3, commons-io:commons-io:jar:2.0.1, org.ow2.asm:asm:jar:4.0, commons-lang:commons-lang:jar:
2.6, org.sonatype.aether:aether-util:jar:1.12: Failure to transfer 
com.jayway.maven.plugins.android.generation2:android-maven-plugin:jar:3.1.1 from http://repo1.maven.org/
maven2 was cached in the local repository, resolution will not be reattempted until the update interval of central 
has elapsed or updates are forced. Original error: Could not transfer artifact 
com.jayway.maven.plugins.android.generation2:android-maven-plugin:jar:3.1.1 from/to central (http://
repo1.maven.org/maven2): No response received after 60000 
```

随着：

```
Project build error: Unknown packaging: apk 
```

在线上

```
<packaging>apk</packaging> 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-06-13T21:28:41.313

我已经尝试自己设置一个新的第二个 IDE，一切都按预期工作，假设您已经正确安装了 Android SDK 和 Maven（最好使用最新版本），这些是使用 Mavenized Android 项目所需的唯一 Eclipse 插件：

*   广告
*   平方米
*   m2e-安卓

看看我的截图`Help -> Install New Software... -> what is already installed`：

![在此处输入图像描述](../Images/a643af42b32445867d269fdf40ae8ac8.png)

如果您按照[此页面](http://rgladwell.github.com/m2e-android/)中的说明从新项目开始，则 <packaging> 错误很可能是由于 maven-release-plugin 的早期版本（如果您没有明确指定）。通过将鼠标悬停在 pom.xml 中的 <packaging> 元素上，您应该会得到一些提示，例如：

> m2e 不支持 2.4 之前的 maven-resources-plugin。使用 maven-resources-plugin 2.4 或更高版本。

在 <plugins> 下添加以下插件：

```
<plugin>
  <artifactId>maven-resources-plugin</artifactId>
  <version>2.5</version>
</plugin> 
```

然后右键单击新项目并选择 Maven -> 更新项目配置，这将修复所有错误并为您提供一个工作示例。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-11-22T09:01:28.283

我在 eclipse JUNO 中安装 android m2e 时遇到了同样的问题。然后尝试通过“安装新软件”向导安装，而不是市场。

添加以下内容作为更新站点，然后从列出的软件中选择“Android For Maven eclipse”并安装。

[http://rgladwell.github.com/m2e-android/updates](http://rgladwell.github.com/m2e-android/updates) - 感谢@NullNoname 提供更新站点。

# typo3 - TYPO3 RealURL postVarSets 隐藏关键字

> ID：11023253
> 
> 赞同：1
> 
> 时间：2012-06-13T21:03:11.757
> 
> 标签：typo3, realurl

我有一个如下所示的 URL：

```
http://domain.com/leistungen/industrial-design/?tx_fsproject_fsprojectfp%5Bproject%5D=2&tx_fsproject_fsprojectfp%5Baction%5D=show&tx_fsproject_fsprojectfp%5Bcontroller%5D=Project&cHash=7c405bcde49853af9a7e78bdf465002c 
```

使用具有以下配置的 RealURL（以及[此处](http://www.t3node.com/blog/hiding-repeated-segments-with-realurl/)解释的一些钩子函数）：

```
'postVarSets' => array(
        '_DEFAULT' => array(
            // projects
            'industrial-design' => array(
                array(
                    'GETvar' => 'tx_fsproject_fsprojectfp[controller]',
                ),
                array(
                    'GETvar' => 'tx_fsproject_fsprojectfp[action]',
                ),
                array(
                    'GETvar' => 'tx_fsproject_fsprojectfp[project]',
                    'lookUpTable' => array(
                        'table' => 'tx_fsproject_domain_model_project',
                        'id_field' => 'uid',
                        'alias_field' => 'title',
                        'addWhereClause' => ' AND deleted !=1 AND hidden !=1',
                        'useUniqueCache' => 1,
                        'useUniqueCache_conf' => array(
                            'strtolower' => 1,
                            'spaceCharacter' => '-',
                        )
                    )
                ),
            ),
        ),
    ), 
```

我得到一个如下所示的 URL：

```
http://domain.com/leistungen/industrial-design/industrial-design/projekt/project-b/ 
```

这还不错。但是，为什么这部`industrial-design/`分会出现两次？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-14T07:15:42.627

The first *industrial-design* is the page that is being displayed. The second one is the keyword inserted by RealURL to identify the set of variables. To avoid that you can:

1.  Change the structure of pages so that you don't have *industrial-design* page at all.
2.  Rename the `postVarSets` that you set up in the RealURL configuration.
3.  Use `fixedPostVars` instead as that doesn't use a keyword to identify the set of variables but a page UID.

# ios - iPad：纵向和横向模式之间的时间延迟

> ID：11023254
> 
> 赞同：4
> 
> 时间：2012-06-13T21:03:15.987
> 
> 标签：ios, ipad, html, css

我有一个带有 HTML5 主屏幕的 iPad 应用程序。我需要为横向和纵向模式创建两个不同的设计模板。我使用CSS`@media`和`orientation : landscape`. `orientation : portrait`它对我很有用。但是当我改变设备的方向时会有时间延迟。结果，我可以在一两秒内看到错误的元素大小。

我该如何解决这个问题？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-06-29T04:54:45.127

当我删除`<meta name="viewport" content="width=device-width, initial-scale=1" >`时，方向之间的延迟消失了，100%，（使用 iPad2、iOS6、Safari 浏览器）。

经过更多的试验和错误，我发现`initial-scale`导致滞后。为什么？在我的知识库之外。这正是我发现的。但是，我现在必须为`initial-scale=1`每个`portrait/landscape`方向添加更多的 CSS 样式。

浏览器在视觉上会缩小所有内容以适应`portrait`并扩展`landscape`模式。

这是[一篇关于视口的好文章](http://www.quirksmode.org/mobile/viewports.html)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-07-06T16:54:11.513

这个答案对游戏来说已经很晚了，但是（至少在更新版本的 iOS - 6+ 上）在声明所有视口比例属性时我的运气要好得多：

```
<meta name="viewport" content="width=device-width, user-scalable=no, initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0" /> 
```

声明了所有这些后，纵向和横向之间的过渡更加顺畅，延迟更少。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-06-27T08:03:36.190

如果您无法修复此延迟，您可以尝试通过对方向变化的动画效果使其平滑。

首先在你的 CSS 中应用一个转换属性，你所有的选择器都会移动

```
#container, #header h1, #header h2, #header h3 {
    -webkit-transition: all 0.3s ease-in-out;
    -webkit-transition-delay: 0s;
    -moz-transition: all 0.3s ease-in-out 0s;
    -ms-transition: all 0.3s ease-in-out 0s;
    -o-transition: all 0.3s ease-in-out 0s;
    transition: all 0.3s ease-in-out 0s;
} 
```

您可以查看我使用此技术[的网站](http://catherine-baras.fr/)

# c# - StreamReader和StreamWriter读写的二进制文件可以修复吗？

> ID：11023257
> 
> 赞同：2
> 
> 时间：2012-06-13T21:03:23.427
> 
> 标签：c#, .net

如果我使用 StreamReader 和 StreamWriter 读写二进制文件，该文件可以修复吗？

```
// Original Code - Corrupted the Destination File
using (Stream responseStream = response.GetResponseStream())
{
    using (StreamReader reader = new StreamReader(responseStream))
    {
        using (StreamWriter writer = new StreamWriter(destinationFileName, false))
        {
            writer.Write(reader.ReadToEnd());
        }
    }
}

// New Code - Destination File is Good
using (Stream responseStream = response.GetResponseStream())
{
    using (FileStream fs = File.Create(destinationFileName))
    {
        responseStream.CopyTo(fs);
    } 
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-13T21:05:34.827

> 如果我使用 StreamReader 和 StreamWriter 读写二进制文件，该文件可以修复吗？

这取决于文件中的内容。如果它*实际上*是正确编码的文本，那么您将不会丢失任何东西。

如果它是真正的二进制数据（例如 JPEG），那么您*几乎肯定*会丢失信息，无法挽回。只是不要这样做，如果你已经这样做了，我可能不会尝试“修复”文件 - 我会将它们写成“坏”。

如果您使用了 ISO-8859-1，则可能一切都会好起来的——尽管它仍然是糟糕的代码，最好改一下。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-13T21:07:23.297

尝试用 StreamReader 读取它，看看你得到的字符串是否有意义。这是恢复数据的最佳选择。一旦你有一个“正确”的字符串，你需要尝试不同的编码来写入二进制文件。尝试 UTF8、UTF16 和 Encoding.Default。

我想恢复一些数据需要一些时间。请注意，您可能已经永久丢失了其中的一部分。

# linux - 如何以编程方式将 webkit PyQt 窗口作为墙纸放在桌面上？

> ID：11023258
> 
> 赞同：1
> 
> 时间：2012-06-13T21:03:24.327
> 
> 标签：linux, pyqt4, desktop-application, xorg, spynner

我尝试将谷歌日历放在 webkit 窗口中作为墙纸。

**python 工作脚本如下所示**：

```
#!/usr/bin/python2 -u
# -*- coding: iso8859-15 -*-

display_UI = True
email = "xxxx@gmail.com"
passwd = "xxxxxxxx"
useragent = "Mozilla/5.0 (X11; Linux x86_64; rv:7.0.1) Gecko/20100101 Firefox/7.0.1"

import spynner

browser = spynner.Browser(
        debug_level=spynner.WARNING,
        user_agent = useragent
)

browser.create_webview(display_UI)
browser.webview.setWindowTitle('Gcalendar')
browser.webview.showMaximized()

browser.load("https://accounts.google.com/ServiceLogin?service=cl&passive=1209600&continue=https://www.google.com/calendar/render&followup=http://www.google.com/calendar&scc=1")
browser.fill("input[name=Email]", email)
browser.fill("input[name=Passwd]", passwd)
browser.click("input[name=signIn]")
browser.wait_load()
browser.load("https://www.google.com/calendar/render?pli=1")
browser.wait_load()

# vim:ts=4:sw=4 
```

**我现在想做**的是以编程方式将此窗口作为墙纸：

*   跳过任务栏
*   跳过寻呼机
*   全屏（使用 spynner 模块完成）
*   如果我隐藏所有应用程序，窗口应该像任何壁纸一样保持不变。

**我**没有成功的尝试

*   应用程序名称的 kde 高级设置
*   [xwinwrap](http://tech.shantanugoel.com/projects/linux/shantz-xwinwrap)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-22T21:58:53.890

您可以截取页面的屏幕截图，将其保存在某处，然后启动更改背景的命令。

```
image = spynner.QImage(browser.webpage.viewportSize(), spynner.QImage.Format_ARGB32)
painter = spynner.QPainter(image)
browser.webpage.mainFrame().render(painter)
painter.end()
image.save("/path/to/img/gcscreen.png") 
```

然后使用 subprocess 模块调用从终端更改壁纸的命令。谷歌搜索结果[为](https://askubuntu.com/questions/66914/how-to-change-desktop-background-from-command-line-in-unity)Gnome ubuntu。如果你愿意的话，我相信你也可以为 KDE 找到一个类似的。

# xml - 使用 ApacheFOP 从 Java 中的 XML 生成 PDF

> ID：11023265
> 
> 赞同：4
> 
> 时间：2012-06-13T21:04:04.423
> 
> 标签：xml, xslt, pdf, xsl-fo, apache-fop

我正在尝试从 Java 对象生成动态 PDF 报告。我找不到很多这样的例子，所以我一直在关注这个例子：

[http://svn.apache.org/viewvc/xmlgraphics/fop/trunk/examples/embedding/java/embedding/ExampleObj2PDF.java?view=markup](http://svn.apache.org/viewvc/xmlgraphics/fop/trunk/examples/embedding/java/embedding/ExampleObj2PDF.java?view=markup)

这段代码和我自己的代码之间唯一真正的区别是我使用 JSON 转换和 XMLSerializer 生成了 src（示例中的第 81 行）。

我遇到的问题是使用变压器。当我进行转换时（示例的第 87 行），我收到错误消息：

> `(Location of error unknown)org.apache.fop.fo.ValidationException: First element must be the fo:root formatting object. Found (Namespace URI: "", Local Name: "html") instead. Please make sure you're producing a valid XSL-FO document.`

由于我不了解 Transformer，也找不到那种文档来告诉我它应该如何工作，我真的不知道转换在哪里崩溃。

非常感谢这种转换的任何经验，或者理解我所缺少的任何东西。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-15T09:04:54.267

Apache FOP 的输入是 XSL:FO。错误消息是说输入不是有效的 XSL:FO 文档，因为第一个（根）元素应该是“fo:root”，但找到了“html”。FOP 不读取 HTML 输入。我建议以更小的步骤分解代码并保存中间文档以帮助您识别问题。步骤是：

1.  JSON 对象被序列化为 XML
2.  XML 使用 XSLT 转换为 XSL:FO
3.  XSL:FO 使用 FOP 转换为 PDF。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-15T20:35:32.733

您需要按照本教程将您的 XML 转换为 XSL:FO。从那里，您将能够使用您已经提到的示例。

[http://svn.apache.org/viewvc/xmlgraphics/fop/trunk/examples/embedding/java/embedding/ExampleXML2FO.java?view=markup](http://svn.apache.org/viewvc/xmlgraphics/fop/trunk/examples/embedding/java/embedding/ExampleXML2FO.java?view=markup)

# html - 当溢出设置为自动时，垂直滚动条不再出现

> ID：11023270
> 
> 赞同：0
> 
> 时间：2012-06-13T21:04:20.513
> 
> 标签：html, vertical-scrolling, css

我在一个 JSP 网站上工作。

我有 3 个主要的同心 div：

*   “容器”（包含整个站点）
*   “内容”（包含内容）
*   “结果”（“内容”内部，包含大量服务器生成的数据）

我设置了 CSS，以便当大量数据存储在 div“结果”中时，水平和垂直滚动条会自动出现。

有效。

直到我将这些标签添加到页面顶部以解决其他一些不相关的问题：

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"> 
```

我尝试了下面第二个答案中的建议，在 div 中设置高度。没有快乐，即使我用 px 设置了高度。如果可能，我需要用 %s 设置高度。

我对麻烦的 JSP 进行了屏幕保存，取出了所有与问题无关的垃圾并将 CSS intp 放在头部以简化问题的调试。下面的引用中是一个 HTML 文件，您可以将其放入浏览器和文本编辑器中，以亲自查看问题。粉红色的 div“结果”只应该和 stackoverflow 编辑框一样高，水平和垂直滚动条会根据需要出现。

**结果.html：**

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="content-type" content="text/html; charset=ISO-8859-1">
    <title>Staff Directory</title>
<style type="text/css">
body{background:white;}
#container
{
    margin-left:auto;
    margin-right:auto;
    text-align:center;
    width: 95%;
    background: white;
    font-family:Arial,Helvetica;
}

/* Main Content Area **********************************************************/
#content
{
    clear: left;
    padding: 20px;
    text-align:center;
    margin-left:auto;
    margin-right:auto;
    background:yellow;
}

#content h2
{
    color: #000;
    font-size: 160%;
    margin: 0 0 .5em;
}

.content_center
{
  display: inline-block;
}
.content_center td
{
  text-align:left;
}

/* horizontal button bar */
.button_bar
{
    margin-left:auto;
    margin-right:auto;
    margin-top: 2%;
    margin-bottom: 2%;
    padding-bottom: 2%;
    width:100%;
    height:auto;
    vertical-align:top;
}

/* put a button on the far right of the above button bar */
.button_bar_right_button
{
    float:right;
    margin-left:1%;
    vertical-align:top;
}
/* put a button on the far left of the above button bar */
.button_bar_left_button
{
    float:left;
    margin-left:1%;
    vertical-align:top;
}
/* table field names */
#fieldLabel
{
    font-weight:bold;
}

/* results.jsp ****************************************************************/
#results
{
    overflow:auto;
    margin-left:auto;
    margin-right:auto;
    height:40%;
    width: 100%;
    background:pink;
}
#results td
{
    white-space: nowrap;
    font-size:11px;
    text-align:left;
}
#results th
{
    white-space: nowrap;
    background:silver;
}
 </style>
</head>

    <body>
    <div id="container">
        <!-- Content: Start div content: Main content area -->
        <div id="content">                  
                    <h1>Div "Content" </h1>

        <form id="command" name="f" action="employee" method="post">    
        <div id="results">
            <center>
                <h1>Div "Results"</h1>
            </center>

            <table>
              <tr>
                <td>
               Start:  A very wide string. A very wide string.  A very wide string.  A very wide string.  A very wide string.  A very wide string.  A very wide string.  A very wide string.  A very wide string.  A very wide string.  A very wide string.  A very wide string.  A very wide string.  A very wide string.  A very wide string.  A very wide string.  A very wide string.  A very wide string.  A very wide string.  A very wide string.   The End.
                 </td>
              </tr>

            </table>
            <p>
            Lorem ipsum dolor sit amet consect etuer adipi scing elit sed diam nonummy nibh 
            euismod tinunt ut laoreet dolore magna aliquam erat volut. Ut wisi enim ad minim 
            veniam, quis nostrud exerci tation ullamcorper suscipit lobortis nisl ut aliquip 
            ex ea commodo consequat. Duis autem vel eum iriure dolor in hendrerit in 
            vulputate velit esse molestie consequat, vel illum dolore eu feugiat nulla 
            facilisis at vero eros et accumsan et iusto odio dignissim qui blandit praesent 
            luptatum zzril delenit augue duis dolore te feugait nulla facilisi.
            </p>
            <p>
            Ut wisi enim ad minim veniam, quis nostrud exerci tation ullamcorper suscipit 
            lobortis nisl ut aliquip ex ea commodo consequat. Duis autem vel eum iriure 
            dolor in hendrerit in vulputate velit esse molestie consequat, vel illum dolore 
            eu feugiat nulla facilisis at vero eros et accumsan et iusto odio dignissim qui 
            blandit praesent luptatum zzril delenit augue duis dolore te feugait nulla 
            facilisi. Lorem ipsum dolor sit amet, consectetuer adipiscing elit, sed diam 
            nonummy nibh euismod tincidunt ut laoreet dolore magna aliquam erat volutpat.
            </p>
            <p>
            Duis autem vel eum iriure dolor in hendrerit in vulputate velit esse molestie 
            consequat, vel illum dolore eu feugiat nulla facilisis at vero eros et accumsan 
            et iusto odio dignissim qui blandit praesent luptatum zzril delenit augue duis 
            dolore te feugait nulla facilisi. Lorem ipsum dolor sit amet, consectetuer 
            adipiscing elit, sed diam nonummy nibh euismod tincidunt ut laoreet dolore magna 
            aliquam erat volutpat. Ut wisi enim ad minim veniam, quis nostrud exerci tation 
            ullamcorper suscipit lobortis nisl ut aliquip ex ea commodo consequat.
            </p>
            <p>
            Lorem ipsum dolor sit amet consect etuer adipi scing elit sed diam nonummy nibh 
            euismod tinunt ut laoreet dolore magna aliquam erat volut. Ut wisi enim ad minim 
            veniam, quis nostrud exerci tation ullamcorper suscipit lobortis nisl ut aliquip 
            ex ea commodo consequat. Duis autem vel eum iriure dolor in hendrerit in 
            vulputate velit esse molestie consequat, vel illum dolore eu feugiat nulla 
            facilisis at vero eros et accumsan et iusto odio dignissim qui blandit praesent 
            luptatum zzril delenit augue duis dolore te feugait nulla facilisi.
            </p>
            <p>
            Ut wisi enim ad minim veniam, quis nostrud exerci tation ullamcorper suscipit 
            lobortis nisl ut aliquip ex ea commodo consequat. Duis autem vel eum iriure 
            dolor in hendrerit in vulputate velit esse molestie consequat, vel illum dolore 
            eu feugiat nulla facilisis at vero eros et accumsan et iusto odio dignissim qui 
            blandit praesent luptatum zzril delenit augue duis dolore te feugait nulla 
            facilisi. Lorem ipsum dolor sit amet, consectetuer adipiscing elit, sed diam 
            nonummy nibh euismod tincidunt ut laoreet dolore magna aliquam erat volutpat.
            </p>
            <p>
            Duis autem vel eum iriure dolor in hendrerit in vulputate velit esse molestie 
            consequat, vel illum dolore eu feugiat nulla facilisis at vero eros et accumsan 
            et iusto odio dignissim qui blandit praesent luptatum zzril delenit augue duis 
            dolore te feugait nulla facilisi. Lorem ipsum dolor sit amet, consectetuer 
            adipiscing elit, sed diam nonummy nibh euismod tincidunt ut laoreet dolore magna 
            aliquam erat volutpat. Ut wisi enim ad minim veniam, quis nostrud exerci tation 
            ullamcorper suscipit lobortis nisl ut aliquip ex ea commodo consequat.
            </p>
            <p>
            Lorem ipsum dolor sit amet consect etuer adipi scing elit sed diam nonummy nibh 
            euismod tinunt ut laoreet dolore magna aliquam erat volut. Ut wisi enim ad minim 
            veniam, quis nostrud exerci tation ullamcorper suscipit lobortis nisl ut aliquip 
            ex ea commodo consequat. Duis autem vel eum iriure dolor in hendrerit in 
            vulputate velit esse molestie consequat, vel illum dolore eu feugiat nulla 
            facilisis at vero eros et accumsan et iusto odio dignissim qui blandit praesent 
            luptatum zzril delenit augue duis dolore te feugait nulla facilisi.
            </p>
            <p>
            Ut wisi enim ad minim veniam, quis nostrud exerci tation ullamcorper suscipit 
            lobortis nisl ut aliquip ex ea commodo consequat. Duis autem vel eum iriure 
            dolor in hendrerit in vulputate velit esse molestie consequat, vel illum dolore 
            eu feugiat nulla facilisis at vero eros et accumsan et iusto odio dignissim qui 
            blandit praesent luptatum zzril delenit augue duis dolore te feugait nulla 
            facilisi. Lorem ipsum dolor sit amet, consectetuer adipiscing elit, sed diam 
            nonummy nibh euismod tincidunt ut laoreet dolore magna aliquam erat volutpat.
            </p>
            <p>
            Duis autem vel eum iriure dolor in hendrerit in vulputate velit esse molestie 
            consequat, vel illum dolore eu feugiat nulla facilisis at vero eros et accumsan 
            et iusto odio dignissim qui blandit praesent luptatum zzril delenit augue duis 
            dolore te feugait nulla facilisi. Lorem ipsum dolor sit amet, consectetuer 
            adipiscing elit, sed diam nonummy nibh euismod tincidunt ut laoreet dolore magna 
            aliquam erat volutpat. Ut wisi enim ad minim veniam, quis nostrud exerci tation 
            ullamcorper suscipit lobortis nisl ut aliquip ex ea commodo consequat.
            </p>
            <p>
            Lorem ipsum dolor sit amet consect etuer adipi scing elit sed diam nonummy nibh 
            euismod tinunt ut laoreet dolore magna aliquam erat volut. Ut wisi enim ad minim 
            veniam, quis nostrud exerci tation ullamcorper suscipit lobortis nisl ut aliquip 
            ex ea commodo consequat. Duis autem vel eum iriure dolor in hendrerit in 
            vulputate velit esse molestie consequat, vel illum dolore eu feugiat nulla 
            facilisis at vero eros et accumsan et iusto odio dignissim qui blandit praesent 
            luptatum zzril delenit augue duis dolore te feugait nulla facilisi.
            </p>
            <p>
            Ut wisi enim ad minim veniam, quis nostrud exerci tation ullamcorper suscipit 
            lobortis nisl ut aliquip ex ea commodo consequat. Duis autem vel eum iriure 
            dolor in hendrerit in vulputate velit esse molestie consequat, vel illum dolore 
            eu feugiat nulla facilisis at vero eros et accumsan et iusto odio dignissim qui 
            blandit praesent luptatum zzril delenit augue duis dolore te feugait nulla 
            facilisi. Lorem ipsum dolor sit amet, consectetuer adipiscing elit, sed diam 
            nonummy nibh euismod tincidunt ut laoreet dolore magna aliquam erat volutpat.
            </p>
            <p>
            Duis autem vel eum iriure dolor in hendrerit in vulputate velit esse molestie 
            consequat, vel illum dolore eu feugiat nulla facilisis at vero eros et accumsan 
            et iusto odio dignissim qui blandit praesent luptatum zzril delenit augue duis 
            dolore te feugait nulla facilisi. Lorem ipsum dolor sit amet, consectetuer 
            adipiscing elit, sed diam nonummy nibh euismod tincidunt ut laoreet dolore magna 
            aliquam erat volutpat. Ut wisi enim ad minim veniam, quis nostrud exerci tation 
            ullamcorper suscipit lobortis nisl ut aliquip ex ea commodo consequat.
            </p>

        </div>   <!--END: div id="results" -->   

        <div class="button_bar">

            <div class="button_bar_left_button">     
                <input value="Request More Information" name="buttonRequestMoreInformation" type="submit">
            </div>  

            <div class="button_bar_left_button">     
                <input value="Start New Search" onclick="location.href='search'" name="buttonSearch" type="button">
            </div>

            <div class="button_bar_right_button">
                    <input value="Add Member" onclick="document.formAddButton.submit();" name="buttonAddMember" type="button">
            </div>

        </div><!-- end div button_bar -->
        </form><!-- end form 'f', main form -->  

        <form name="formAddButton" action="initialRequest" method="post">
            <input name="NextRequest" value="Add Member" type="hidden">
        </form>       

        </div><!-- Content: Close div id ="content"  -->

    </div><!-- end div container -->   

</body>

</html> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-14T13:49:40.427

你确定你没有按照我说的去做吗？我刚刚在我的浏览器中转储了您的代码，并更改了

```
#results
{
    height: 40%;
} 
```

至

```
#results
{
    height: 200px;
} 
```

粉红色的盒子表现得和我预期的一样，你想要的。

关于使用 % 而不是 px：除非您为容器设置了固定高度，否则您不能这样做。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-28T20:22:54.310

好吧，既然你的元素都没有被归为高度，那么，40% 的“某事”将永远不会被应用。

因此，为了解决您的情况，您必须在父分隔线的某处固定一些高度。

继续

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-13T21:41:54.153

```
div {overflow-x:hidden; } 
div {overflow-x:scroll; } 
div {overflow-x:visible;} 
div {overflow-x:auto;}
div {overflow-y:hidden; } 
div {overflow-y:scroll; } 
div {overflow-y:visible;} 
div {overflow-y:auto;} 
```

# c# - 有没有更好的方法来过滤这个datagridview？

> ID：11023276
> 
> 赞同：3
> 
> 时间：2012-06-13T21:04:52.383
> 
> 标签：c#, datagridview, code-cleanup

我有一个使用 switch 语句通过双击事件过滤的 datagridview。数据源最初是由基于用户输入的 LINQ to SQL 查询设置的，然后他们可以选择双击单元格来过滤类似的项目，例如型号、计算机名称或操作系统。

这里似乎有太多重复的代码。关于更好的方法的任何想法？

```
private void gridInventory_CellDoubleClick(object sender, DataGridViewCellEventArgs e)
{
        try
        {
            if (e.ColumnIndex > 0 && e.RowIndex > 0)
            {
                var cell = this.gridInventory[e.ColumnIndex, e.RowIndex];
                var clickedValue = (cell.Value != null) ? cell.Value.ToString() : string.Empty;

                if (!string.IsNullOrEmpty(clickedValue))
                {
                    switch (this.gridInventory.Columns[e.ColumnIndex].Name.ToUpper())
                    {
                        case @"MODEL":
                            CurrentList = CurrentList.Where(r => r.Model != null && r.Model.ToUpper() == clickedValue.ToUpper()).ToList();
                            break;
                        case @"COMPUTERNAME":
                            CurrentList = CurrentList.Where(r => r.ComputerName != null && r.ComputerName.ToUpper() == clickedValue.ToUpper()).ToList();
                            break;
                        case @"SERIALNUMBER":
                            CurrentList = CurrentList.Where(r => r.SerialNumber != null && r.SerialNumber.ToUpper() == clickedValue.ToUpper()).ToList();
                            break;
                        case @"COMPUTERID":
                            CurrentList = CurrentList.Where(r => r.ComputerID.ToString().ToUpper() == clickedValue.ToUpper()).ToList();
                            break;
                        case @"MANUFACTURER":
                            CurrentList = CurrentList.Where(r => r.Manufacturer != null && r.Manufacturer.ToUpper() == clickedValue.ToUpper()).ToList();
                            break;
                        case @"OSVERSION":
                            CurrentList = CurrentList.Where(r => r.OSVersion != null && r.OSVersion.ToUpper() == clickedValue.ToUpper()).ToList();
                            break;
                        case @"AUDITDATE":
                            CurrentList = CurrentList.Where(r => r.AuditDate != null && r.AuditDate.ToString().ToUpper() == clickedValue.ToUpper()).ToList();
                            break;
                        case @"AUDITGUID":
                            CurrentList = CurrentList.Where(r => r.AuditGUID != null && r.AuditGUID.ToString().ToUpper() == clickedValue.ToUpper()).ToList();
                            break;
                        default:
                            break;
                    }

                    if (this.CurrentList != null)
                    {
                        gridInventory.DataSource = this.CurrentList;
                        this.lblRecords.Text = string.Format(@"Total Records: {0}", CurrentList.Count(c => c.ComputerID > 0));
                    }
                }
            }
        }
        catch (Exception exc)
        {
            MessageBox.Show(exc.Message, @"error", MessageBoxButtons.OK, MessageBoxIcon.Error);
        }
    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-14T14:40:15.303

使用 LINQ 和反射，这个函数可以这样重写：

```
private void gridInventory_CellDoubleClick(object sender, DataGridViewCellEventArgs e)
{
        try
        {
            if (e.ColumnIndex > 0 && e.RowIndex > 0)
            {
                var cell = this.gridInventory[e.ColumnIndex, e.RowIndex];
                var clickedValue = (cell.Value != null) ? cell.Value.ToString() : string.Empty;
                if (!string.IsNullOrEmpty(clickedValue))
                {
                    CurrentList = CurrentList.Where(r => typeof(r_type_here).GetProperty(this.gridInventory.Columns[e.ColumnIndex].Name).GetValue(r, null) != null &&
                        typeof(r_type_here).GetProperty(this.gridInventory.Columns[e.ColumnIndex].Name).GetValue(r, null).ToString().ToUpper() == clickedValue.ToUpper()).ToList();

                    if (this.CurrentList != null)
                    {
                        gridInventory.DataSource = this.CurrentList;
                        this.lblRecords.Text = string.Format(@"Total Records: {0}", CurrentList.Count(c => c.ComputerID > 0));
                    }
                }
            }
        }
        catch (Exception exc)
        {
            MessageBox.Show(exc.Message, @"error", MessageBoxButtons.OK, MessageBoxIcon.Error);
        }
    } 
```

替换`r_type_here`为您的实际元素类型，`CurrentList`您应该得到相同的结果。

**好处：**

*   代码更短
*   代码更灵活——如果你想添加新的列/属性，那么你不需要在这里写一行代码

**缺点：**

*   您必须保持字符大小写 - 即列表元素类的属性名称中的大小写应该与相应列的名称具有完全相同的大小写`gridInventory.Columns`
*   可读性较差的代码
*   如果您经常使用此功能，可能会成为性能瓶颈 - 反射通常比您的案例语句慢。

还应在同一个 LINQ`where`语句中实现对属性存在性的检查。

# algorithm - 带约束的二部图中的最大权重匹配

> ID：11023281
> 
> 赞同：2
> 
> 时间：2012-06-13T21:05:11.350
> 
> 标签：algorithm, graph, bipartite

假设我们有两个集合：A=(a_1,a_2,...,a_m) 和 B=(b_1,b_2,...,a_n)（不一定大小相同）。函数 F 为从集合 A 到集合 B 的每个链接分配权重：F:A*B->R。因此，例如，F(a_1,b_1)=2 表示 a_1 和 b_1 之间链接的权重为 2。问题是将集合 A 的元素连接到集合 B 的元素，以最大化满足这些约束的链接权重：

*   集合 A 的元素必须与集合 B 的一个元素完全匹配。
*   集合 B 的元素允许有零个或多个匹配 (0,1,2...)，尽管 B 的元素存在对权重总和 C_i 的约束。也就是说，如果我们选择将 a_1 连接到 b_1，而a_2到b_1，权重之和F(a_1,b_1)+F(a_2,b_1)应该小于等于C_1。此约束适用于 B 的所有元素。

我已经搜索了一些想法，并研究了分配问题和匈牙利算法。另外一点是，这些都没有考虑到我的第二个约束。您对如何解决这个问题有任何想法吗？

谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-13T21:28:31.297

这是NP难的。

取一个子集和实例 {x [1] , x [2] , ..., x [n] }，其中 x [i] > 0 和一个数字 k。创建一个二分图，其中左顶点为 {a [1] , ..., a [n] }，右顶点为 {b [1] ,b [2] }，并且：

F(a[我], b [1] ) = x[我]

F(a [i] , b [2] ) = 0

C [1] = k

C [2] = 0

因此，您可以通过将 a [i]与 b [1连接来获取数字 x] [i]，并通过与 b [2]连接来保留它。显然，如果子集和实例有解，则权重 k 匹配。

# html - 如何在 html 文档中嵌入大图像？

> ID：11023285
> 
> 赞同：3
> 
> 时间：2012-06-13T21:05:17.733
> 
> 标签：html, image, embed

我需要创建一个将存储在磁盘上的 HTML 文件；稍后，用户将此文件附加到电子邮件中并将其发送给将单击该文件以使其显示在浏览器中的用户。我的客户要求将图像文件直接嵌入到保存的 html 文件中，而不是作为在浏览器中打开文档时加载的 URL 的链接。

我已经看到（并尝试过）如下所示的 base64 代码：

```
<IMG SRC="data:image/gif;base64, 
```

但我的图像是 150K 或更大，至少在 IE8 中，它们太大而无法正常显示。

是否有另一种方法可以将大图像嵌入（*未*链接）到 HTML 文档中？请记住，我不会运行与浏览器交互的程序。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-13T21:41:36.883

IE 8 的数据 uri 限制为 32k ( [http://en.wikipedia.org/wiki/Data_URI_scheme](http://en.wikipedia.org/wiki/Data_URI_scheme) )，这就是你在那里失败的原因。此外，低于 8 的 IE 版本将不支持此功能。

据我所知，没有办法解决这个问题。但是，您可以分解图像并对其单独的部分进行编码。因为听起来这个内容无论如何都不是动态的，所以这可能不会太难。否则，您可能只想使用 CSS hack 来为 IE8 及更低版本提供不同的样式，或者尝试从这些浏览器的服务器加载图像。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-14T13:57:45.063

谢谢大家，但阿尔伯特的帖子给了我答案，虽然有点间接。我最初将我的 html 文档创建为电子邮件，并将图像直接嵌入到电子邮件中，混合了 htm 和 mime。我需要做的就是将文档的扩展名从 .htm 更改为 .mht。

我的文档代码的相关部分是：

```
<img border=3 width="360" height="360" src="cid:001@mime.mail"></table></div></body></html>
--_=_Boundary_001_VXUXGWO1.FBLEINFI
Content-Type: application/octet-stream; name="1.jpg"
Content-Disposition: attachment; filename="1.jpg"
Content-ID: <001@mime.mail>
Content-Transfer-Encoding: base64
Content-Description: 1.jpg

/9j/4AAQSkZJRgABAQAAAQABAAD/2wBDAA... 
```

请注意 src="cid:001@mime.mail" 对应于实际图像数据开始位置上方的 Content-ID 标记。

# c++ - const 正确性与短内联函数有关吗？

> ID：11023286
> 
> 赞同：0
> 
> 时间：2012-06-13T21:05:18.827
> 
> 标签：c++, inline, const-correctness

我编写了两个简短的测试并使用“g++ -S”（Arch Linux 上的 gcc 版本 4.7）编译：

测试1.cpp

```
inline int func(int a, int b) {
    return a+b;
}

int main() {
    int c = func(5,5);
    return 0;
} 
```

测试2.cpp

```
inline int func(const int& a, const int& b) {
    return a+b;
}

int main() {
    int c = func(5,5);
    return 0;
} 
```

diff test1.s test2.s

```
1,5c1,5
<   .file   "test1.cpp"
<   .section    .text._Z4funcii,"axG",@progbits,_Z4funcii,comdat
<   .weak   _Z4funcii
<   .type   _Z4funcii, @function
< _Z4funcii:
---
>   .file   "test2.cpp"
>   .section    .text._Z4funcRKiS0_,"axG",@progbits,_Z4funcRKiS0_,comdat
>   .weak   _Z4funcRKiS0_
>   .type   _Z4funcRKiS0_, @function
> _Z4funcRKiS0_:
12a13,14
>   movl    8(%ebp), %eax
>   movl    (%eax), %edx
14c16
<   movl    8(%ebp), %edx
---
>   movl    (%eax), %eax
22c24
<   .size   _Z4funcii, .-_Z4funcii
---
>   .size   _Z4funcRKiS0_, .-_Z4funcRKiS0_
36,38c38,44
<   movl    $5, 4(%esp)
<   movl    $5, (%esp)
<   call    _Z4funcii
---
>   movl    $5, 20(%esp)
>   movl    $5, 24(%esp)
>   leal    20(%esp), %eax
>   movl    %eax, 4(%esp)
>   leal    24(%esp), %eax
>   movl    %eax, (%esp)
>   call    _Z4funcRKiS0_ 
```

但是，我真的不知道如何解释结果。我所看到的是 test2 显然会生成更长的代码，但我无法真正说出它们之间的区别。

一个后续问题：成员函数是否重要？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-13T21:07:29.747

这些函数是不等价的，一个按值取参数，另一个按引用取参数。请注意，如果您删除引用，`&`那么您将获得完全相同的功能，除了一个强制您不更改​​复制参数的值而另一个不更改。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-06-13T21:14:01.147

const 正确性适用于人类，而不适用于代码生成

它通过对可以更改的内容引入限制，使人类更容易理解代码

所以，是的，短函数也很重要，因为它们可以从不那么短且一目了然的代码中调用

也就是说，您的示例函数并未说明 const 正确性

所以，虽然这回答了字面上的问题，但可能你误解了 const 正确性是什么，并打算问一些*其他问题*，我不会猜测

# drupal - 将 SPARQL 查询转化为可视化

> ID：11023290
> 
> 赞同：2
> 
> 时间：2012-06-13T21:05:33.487
> 
> 标签：drupal, drupal-7, drupal-modules, rdf, sparql

我目前正在一个网站上工作，该网站主要以图表和可视化为特色。这些可视化的数据将从 SPARQL 端点获取。例如，一个条形图将显示按年份分类的已发表论文总数。现在，这些论文的 URI 使用 Miles Worthington 的 Linked Data Import（以前称为 RDFimporter）作为节点导入。使用映射，我可以将这些论文（年份、作者等）的值存储在自定义字段（或自定义内容类型节点的字段）中。然后，我从 Drupal 的数据库（MySQL？）中选择论文（节点）并处理我感兴趣的值。

```
 // load the node
        $node = node_load($array['nid']);

        // store year in $output
        $fgi_year = field_get_items('node', $node, 'field_year');
        $output = field_view_value('node', $node, 'field_year', $fgi_year[0]); 
```

通过一些迭代，上面给出了我需要的关于论文发表年份的信息。然后将这些值传递给 gRaphael 的实例，该实例可以毫无问题地呈现条形图。

这是可视化从 SPARQL 查询返回的数据的一种方法，但我对可能更有效的方法感兴趣。最终站点最终可能会有数千个节点，我不确定这是否会大大降低性能。非常感谢任何反馈。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-13T22:51:51.543

你听说过还是[Spark](http://km.aifb.kit.edu/sites/spark/)？

它是一个用于进行 SPARQL 查询和可视化结果的客户端 JS 库。如果结果需要最少/不需要处理，最好使用类似的东西并将大部分工作放在客户端上，而不是在服务器端做所有事情。这样，您所要做的就是在服务器端生成相关的 SPARQL 查询。

# javascript - jQuery 快速转储对象的成员

> ID：11023293
> 
> 赞同：7
> 
> 时间：2012-06-13T21:05:34.860
> 
> 标签：javascript, jquery

我想知道是否有一种快速的方法来获取对象的所有变量值，类似于 php 的`var_dump()`方法。

所以如果我有一个对象

```
var myObject = {
    Up: 38,
    Dn: 40,
    Lf: 37,
    Rt: 39,
    Enter: 13,
    Space: 32,
    Esc: 27
}; 
```

我要回来的字符串看起来像

```
[ Up:38, Dn:40, Lf:37, Rt:39, Enter:13, Space:32, Esc:27 ] 
```

假设我需要在无法使用 firebug 的计算机上执行此操作。有没有办法在不遍历对象中的所有参数的情况下做到这一点？有没有这样的独立库？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-06-13T21:22:25.153

作为一种快速的衬里，我经常使用

```
 var o = {a:1, b:2}, k, s = []; for (k in o) o.hasOwnProperty(k) && s.push (o[k]); s = s.join (', '); 
```

您只需更改对象的一次出现（o 的值），结果在 s 中。

这不会递归到数据结构中。如果需要，JSON.stringify 可能更适合。但是请注意 JSON.stringify 不执行函数，它只是跳过它们！

对于格式化的字符串化使用

```
JSON.stringify({a:1,b:2,c:{d:1,e:[1,2]}}, null, 4); // Indented 4 spaces 
```

根据对[Javascript 的回答：如何直接从对象生成格式化的易于阅读的 JSON？](https://stackoverflow.com/questions/3515523)

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-06-13T21:07:39.850

使用默认开发。IE、Chrome 和 Firefox 上的工具

```
console.dir(myObject); 
```

如果您真的不能使用这些工具，那么可能会有`JSON.stringify(myObject)`帮助。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-06-13T21:07:30.957

你试过[FirebugLite](http://getfirebug.com/firebuglite)吗？它有很多 Firebug 功能。

这是 Javascript Firebug 库，您只需要加载脚本

```
<script type="text/javascript" src="https://getfirebug.com/firebug-lite.js"></script> 
```

您将在包括 Internet Explorer 在内的所有主要浏览器中获得 Firebug 控制台

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-06-13T21:13:11.990

**JSON.stringify**是要走的路，但它适用于所有浏览器，只需包含 lib：

[https://github.com/douglascrockford/JSON-js/blob/master/json2.js](https://github.com/douglascrockford/JSON-js/blob/master/json2.js)

例子：

```
 text = JSON.stringify(['e', {pluribus: 'unum'}]);
        // text is '["e",{"pluribus":"unum"}]'

        text = JSON.stringify(['e', {pluribus: 'unum'}], null, '\t');
        // text is '[\n\t"e",\n\t{\n\t\t"pluribus": "unum"\n\t}\n]'

        text = JSON.stringify([new Date()], function (key, value) {
            return this[key] instanceof Date ?
                'Date(' + this[key] + ')' : value;
        });
        // text is '["Date(---current time---)"]' 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-06-13T21:09:03.410

```
function var_dump(obj) {
    var obj_members = "";
    var sep = "";
    for (var key in obj) {
        obj_members += sep + key + ":" + obj[key];
        sep = ", ";
    }
    return ("[" + obj_members + "]");
} 
```

# c# - 客户端到 WCF 服务的应用程序体系结构

> ID：11023294
> 
> 赞同：0
> 
> 时间：2012-06-13T21:05:37.760
> 
> 标签：c#, wcf, architecture, n-tier-architecture

我很好奇构建包含以下内容（需要重构）的应用程序的正确方法：

Excel Addin COM-Visible 客户端库，包括 WinForms 和暴露给 Excel 的方法（计算调用和表单激活方法）然后使用客户端库中的功能连接到 WCF 服务。WCF 服务目前包含计算逻辑、验证逻辑、通过 ORM 工具访问数据库。

即 Addin -> Winform/Direct call in client DLL -> WCF -> DB or 计算

目前，这仅存在于 2 个项目中。我的第一个想法是重新架构如下：

**客户端项目**

*   Excel“视图”（Project.Client.Excel），这将COM可见性级别限制为一个项目。
*   WinForm“视图”（Project.Client.UI）
*   两组“视图”的演示文稿 (Project.Client.Presenter)

**服务器端项目**

*   WCF“视图”包括数据传输对象？（Project.Server.WCF 或服务）
*   服务器端演示者（Project.Server.Presenter）？
*   业务逻辑（Project.Business）
*   数据访问层 (Project.DAL)

我的问题是：

1.  DTO 应该放在哪里，在 WCF 项目中还是作为他们自己的库/项目？
2.  实体转换例程属于哪里（数据实体 <> 业务实体 <> DTO）？全部在业务逻辑层中还是有些在服务器演示者中？
3.  这种方案的正确架构应该是什么？
4.  还有很多我可能错过了？

重构的部分想法是纠正架构、分离关注点等，并允许将单元测试包含到设计中。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-14T12:40:10.617

> DTO 应该放在哪里，在 WCF 项目中还是作为他们自己的库/项目？

您不希望它们出现在 WCF 项目中，因为这意味着客户端必须引用该服务器端项目。最好将 DTO、WCF 服务合同（接口）等保存在服务器和客户端项目都可以引用的单独“公共”项目中。

> 实体转换例程属于哪里？

数据实体<->数据访问层中的业务实体；业务逻辑中的业务实体<-> DTO。当然，在所有层中使用数据实体也是完全可以接受的，避免了对所有这些不同实体和映射代码的需要，您需要保持更新。我想这取决于您系统的复杂性，但请查看 EF4 POCO。

至于您的其他问题，在不了解更多关于您的要求和设计的情况下，您看起来与您的项目列表相符。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-14T16:29:16.047

这就是我的结构，但这个问题没有 100% 正确的答案。在使您的工作舒适之前，许多变化都是有意义的。

*   Excel“视图”（Project.Client.Excel），这将COM可见性级别限制为一个项目。
*   WinForm“视图”（Project.Client.UI）
*   两组“视图”的演示文稿 (Project.Presenter)
*   WCF 主机 (Project.Service) - 如果您在 IIS 中托管，则带有 *.svc 文件的网站（此处没有合同）。这里没有太多的业务代码，它仅用于托管在 BLL 中实现的方法。
*   业务逻辑（Project.Business）
*   数据访问层 (Project.DAL)
*   合同 (Project.Contract) - 操作和数据合同。这是 WCF 客户端、服务器和 BLL 都使用的库。
*   Shared (Project.Shared) - 更好地构建依赖关系的常用助手。

> DTO 应该放在哪里，在 WCF 项目中还是作为他们自己的库/项目？

合同

> 实体转换例程属于哪里（数据实体 <> 业务实体 <> DTO）？全部在业务逻辑层中还是有些在服务器演示者中？

中小型项目业务。

> 这种方案的正确架构应该是什么？

你的似乎很好。

服务器端演示者 (Project.Server.Presenter) - 这对我来说毫无意义，因为没有使用它的 GUI

# c# - 如何在基于 C# 的 Word 加载项中从 Word 文档中获取选定的文本？

> ID：11023296
> 
> 赞同：1
> 
> 时间：2012-06-13T21:05:44.410
> 
> 标签：c#, ms-word, add-in

我正在开发一个 MS Word 加载项。为此，我想知道如何获取当前在 word 文档中选择的文本，然后对其执行我的应用程序特定操作。

谢谢您的帮助。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-14T01:25:28.780

在 Visual Studio 的 Word 加载项项目中，在触发事件上使用以下代码来获取选定的文本：

```
 string selectText = string.Empty;
        Word.Selection wordSelection = this.Application.Selection;
        if (wordSelection != null && wordSelection.Range != null)
        {
            selectText = wordSelection.Text;
        } 
```

注意：以上代码未经测试。

# xml - XSL document() 中的 URL 返回错误

> ID：11023299
> 
> 赞同：0
> 
> 时间：2012-06-13T21:06:09.043
> 
> 标签：xml, xslt-1.0

我有一个 XSL 文件，它将我的图片 XML 文件转换为小图块，太棒了！但我想在页面顶部添加一个下拉选项，允许我在图片页面上选择另一个相册。我正在使用 document() 方法从另一个 XML 文件中提取相册，但返回错误：

“解析“http://mydomain.com/app/albums/?org=markk”时出错。请求的资源没有可用的数据。”

...

```
<xsl:variable name="url" select="document('http://mydomain.com/app/albums/?org=markk')/albums"/>
    <form>
    <fieldset>
        <div class="control-group">
            <div class="controls">
            <select>
                <option>Choose Album</option>
                <xsl:for-each select="$url/album">
                <option><xsl:value-of select="@name"/></option>
                </xsl:for-each>
            </select>
            </div>
        </div>
    </fieldset>
    </form> 
```

# objective-c - Objective-C 库中回调的选择器或块

> ID：11023301
> 
> 赞同：19
> 
> 时间：2012-06-13T21:06:20.213
> 
> 标签：objective-c, events, selector, objective-c-blocks

### 问题

我们正在用 Objective-C 开发一个自定义的[EventEmitter 启发](http://nodejs.org/docs/latest/api/events.html#events_class_events_eventemitter)消息系统。对于侦听器提供回调，我们应该需要[块](http://developer.apple.com/library/ios/#documentation/cocoa/Conceptual/Blocks/Articles/00_Introduction.html)还是[选择器](http://developer.apple.com/library/ios/#documentation/cocoa/conceptual/objectivec/Chapters/ocSelectors.html)，为什么？

作为使用第三方库的开发人员，您更愿意使用哪个？哪一个似乎最符合 Apple 的发展轨迹、指导方针和实践？

### 背景

我们正在用 Objective-C 开发一个全新的 iOS SDK，其他第三方将使用它来将功能嵌入到他们的应用程序中。我们 SDK 的很大一部分将需要将事件传递给侦听器。

我知道在 Objective-C 中执行回调有五种模式，其中三种不适合：

*   [NSNotificationCenter](https://developer.apple.com/library/mac/#documentation/Cocoa/Reference/Foundation/Classes/nsnotificationcenter_Class/Reference/Reference.html) - 不能使用，因为它不保证顺序观察者会被通知，并且因为观察者无法阻止其他观察者接收事件（就像`stopPropagation()`在 JavaScript 中那样）。
*   [Key-Value Observing](http://developer.apple.com/library/mac/#documentation/Cocoa/Conceptual/KeyValueObserving/KeyValueObserving.html) - 似乎不太适合架构，因为我们真正拥有的是消息传递，并不总是“状态”绑定。
*   [委托和数据源](https://developer.apple.com/library/mac/#documentation/cocoa/conceptual/CocoaFundamentals/CommunicatingWithObjects/CommunicateWithObjects.html#//apple_ref/doc/uid/TP40002974-CH7-SW18)——在我们的例子中，通常会有很多侦听器，而不是一个可以正确称为委托的侦听器。

其中两个是竞争者：

*   [选择器](http://developer.apple.com/library/ios/#documentation/cocoa/conceptual/objectivec/Chapters/ocSelectors.html)——在这个模型下，调用者提供一个选择器和一个目标，它们被共同调用来处理一个事件。
*   [块](http://developer.apple.com/library/ios/#documentation/cocoa/Conceptual/Blocks/Articles/00_Introduction.html)- 在 iOS 4 中引入，块允许传递功能而无需像观察者/选择器模式那样绑定到对象。

这似乎是一个深奥的意见问题，但我觉得有一个客观的“正确”答案，我在 Objective-C 中经验不足，无法确定。如果这个问题有更好的 StackExchange 站点，请移到那里帮助我。

## 更新 #1 — 2013 年 4 月

我们选择*块*作为为我们的事件处理程序指定回调的方法。我们对这个选择非常满意，并且不打算删除基于块的侦听器支持。它确实有两个显着的缺点：内存管理和设计阻抗。

### 内存管理

块在堆栈上最容易使用。通过将它们复制到堆上来创建长寿命块会引入有趣的内存管理问题。

调用包含对象上的方法的块隐式增加了`self`引用计数。假设您有一个类属性的设置器`name`，如果您`name = @"foo"`在块内调用，编译器会将其视为`[self setName:@"foo"]`并保留`self`，以便在块仍然存在时不会释放它。

实现 EventEmitter 意味着拥有长寿命的块。为了防止隐式保留，发射器的用户需要创建对块外部的`__block`引用，例如：`self`

```
__block *YourClass this = self;
[emitter on:@"eventName" callBlock:...
   [this setName:@"foo"];...
}]; 
```

这种方法的唯一问题是它`this`可能在调用处理程序之前被释放。所以用户在被释放时必须取消注册他们的监听器。

### 设计阻抗

经验丰富的 Objective-C 开发人员希望使用熟悉的模式与库进行交互。委托是一种非常熟悉的模式，因此规范的开发人员希望使用它。

幸运的是，委托模式和基于块的侦听器并不相互排斥。尽管我们的发射器必须能够处理来自许多地方的侦听器（只有一个委托不起作用），但我们仍然可以公开一个接口，允许开发人员与发射器交互，就好像他们的类是委托一样。

我们还没有实现这个，但我们可能会基于用户的请求。

## 更新 #2 — 2013 年 10 月

我不再从事产生这个问题的项目，我很高兴地回到了我的 JavaScript 故乡。

接手这个项目的聪明的开发者决定完全淘汰我们自定义的基于块的 EventEmitter。即将发布的版本已切换到[ReactiveCocoa](https://github.com/ReactiveCocoa/ReactiveCocoa)。

这为它们提供了比我们之前提供的 EventEmitter 库更高级别的信号模式，并允许它们比我们基于块的事件处理程序或类级方法更好地将状态封装在信号处理程序中。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-06-13T21:28:56.713

就个人而言，我讨厌使用代表。由于objective-C的结构，如果我必须创建一个单独的对象/添加一个协议只是为了收到你的一个事件的通知，它真的会让代码变得混乱，我必须实现5/6。出于这个原因，我更喜欢块。

虽然它们（块）确实有其缺点（例如内存管理可能很棘手）。它们易于扩展，易于实现，并且在大多数情况下才有*意义。*

虽然苹果的设计结构可能使用 sender-delegate 方法，但这只是为了向后兼容。最近的 Apple API 一直在使用块（例如 CoreData），因为它们是 Objective-c 的未来。虽然它们在过度使用时会使代码混乱，但它也允许更简单的“匿名代表”，这在目标 C 中是不可能的。

最后，它真的归结为：你是否愿意放弃一些更旧、更过时的平台，以换取使用区块而不是委托？委托的一个主要优点是它**保证**可以在任何版本的 objc-runtime 中工作，而块是该语言的最新添加。

就`NSNotificationCenter`/`KVO`而言，它们都是有用的，并且有它们的用途，但作为代表，它们并不打算被使用。两者都不能将结果发送回发送者，在某些情况下，这是至关重要的（`-webView:shouldLoadRequest:`例如）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-14T18:01:04.520

我认为正确的做法是实现两者，将其用作客户端，然后看看什么感觉最自然。这两种方法都有优点，它实际上取决于上下文以及您期望如何使用 SDK。

选择器的主要优点是简单的内存管理——只要客户端正确注册和注销，它就不需要担心内存泄漏。使用块，内存管理可能会变得复杂，这取决于客户端在块内执行的操作。对回调方法进行单元测试也更容易。[块当然可以写成可测试](http://twobitlabs.com/2012/05/block-initialization-for-testability-and-reuse/)的，但从我所看到的情况来看，这不是常见的做法。

块的主要优点是灵活性——客户端可以轻松地引用局部变量而无需将它们设为 ivars。

所以我认为它只取决于用例——对于这样一个通用的设计问题，没有“客观正确的答案”。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-15T14:02:51.597

很棒的文案！

在我个人看来，由于编写了大量的 JavaScript，事件驱动的编程感觉比让委托来回更简洁。

关于监听器的内存管理方面，我尝试解决这个问题（大量借鉴 Mike Ash 的[MAKVONotificationCenter](https://github.com/mikeash/MAKVONotificationCenter/blob/master/MAKVONotificationCenter.m)），调动调用者和发射器的`dealloc`实现（[如这里所示](https://gist.github.com/Goos/5357499#file-nsobject-eventemitter-m-L185)），以便以两种方式安全地删除监听器。

我不完全确定这种方法有多安全，但我的想法是尝试它直到它坏掉。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-13T21:19:40.347

关于库的一点是，您只能在某种程度上预测它将如何使用。所以你需要提供一个尽可能简单和开放的解决方案——并且让用户熟悉。

*   对我来说，这一切最适合委派。尽管您是对的，它只能在侦听器（委托）上具有，但这意味着没有限制，因为用户可以编写一个类作为委托，它知道所有需要的侦听器并通知他们。当然你可以提供一个注册类。这将调用所有注册对象的委托方法。
*   块一样好。
*   您将选择器命名为目标/动作，简单而强大。
*   KVO 对我来说似乎也不是最佳解决方案，因为它可能会削弱封装，或者导致如何使用库的类的错误心理模型。
*   NSNotifications 可以很好地通知某些事件，但不应该强迫用户使用它们，因为它们是非常非正式的。如果有人收听，您的班级将无法知道。

关于 API 设计的一些有用的想法：http: [//mattgemmell.com/2012/05/24/api-design/](http://mattgemmell.com/2012/05/24/api-design/)

# javascript-intellisense - 在 Javascript 中，我在哪里将 XML 注释放在 var 上以便它以智能感知显示？

> ID：11023302
> 
> 赞同：1
> 
> 时间：2012-06-13T21:06:24.397
> 
> 标签：javascript-intellisense

我在函数的 javascript 代码中成功使用了智能感知，但我不知道如何让它为 var 工作，或者我是否应该以不同的方式设计这个类，以便有效地记录它。

```
(function ($)
{
  $.myNamespace.MyClass = {

    m_varIWantToCommentOn: null,
    /// <summary locid="m_varIWantToCommentOn">
    ///     *This doesn't work here*  How should I comment on what this var is for?
    /// </summary>

    Init: function ()
    {
        /// <summary locid="Init">
        /// Called when MyClass is initialized for the first time.  this comment works fine.
        /// </summary>
        // ...use m_varIWantToCommentOn in some way...
    }
  }
})(jQuery); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-27T22:11:45.237

我知道这个问题有点老了，但万一其他人有同样的问题......

我会使用`<field>`标签。它超越了它所描述的领域，与内部的功能文档不同。

```
 (function ($) {
    $.myNamespace.MyClass = {

        /// <field> comments here </field>
        m_varIWantToCommentOn: null,

        Init: function () {
            /// <summary locid="Init">
            /// Called when MyClass is initialized for the first time.  this comment works fine.
            /// </summary>
            // ...use m_varIWantToCommentOn in some way...

        }
    }
})(jQuery); 
```

通常，`<var>`标签仅在 var 声明中使用，但它们也高于它们所描述的 var。

```
/// <var>comments here</var>
var someVar = null,
/// <var>This is a number</var>
anotherVar = 0; 
```

# qt - 强制删除 Qt 中的所有水平间距

> ID：11023304
> 
> 赞同：4
> 
> 时间：2012-06-13T21:06:46.623
> 
> 标签：qt, border, margin, spacing, qtstylesheets

使用 Qt，我设置了一个水平布局的主对话框。此水平布局包含三个垂直布局。我真的希望这些布局中的所有控件相互对接，但我无法让 QT 删除所有填充和间距。

我已将所有布局的间距和内边距设置为 0，并使用 CSS 清除所有边框、内边距和边距。我仍然无法摆脱该死的间距。

这是它的样子：
![控件未组合在一起。](../Images/268db81061f2259ae71d48259e80a1fe.png)

据我所知，这些小部件应该被推到那条红线上。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-13T21:28:18.333

你有没有尝试过

`layout->setContentsMargins(0,0,0,0);`

... 其中 layout 是指向 QVBoxLayout、QHBoxLayout 等的指针？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-12-08T02:33:31.747

对于有类似问题的任何人，请尝试以下方法之一

```
layout->setContentsMargins(0,0,0,0);
layout->setSpacing(0);
layout->setMargin(0); 
```

# flash - 基于 Flash AS3 的网站 - Sprite 容器中的子级仅在后台水平添加

> ID：11023307
> 
> 赞同：0
> 
> 时间：2012-06-13T21:06:57.967
> 
> 标签：flash, actionscript

我正在浏览 ActiveTuts 提供的一个非常简单的基于 Flash 的网站教程。任何人，我都在尝试将我的 HTML5/CSS3 设计转换为 Flash 作为学习经验。目前，我的导航是舞台的宽度（所以每个孩子都是舞台的宽度 - 980px）。我希望每个导航元素都在它自己的行上 - 到目前为止，经过数小时的谷歌搜索后，我只能水平添加导航子元素，而不是垂直添加目标。

总而言之，所有新的孩子都是水平添加的，因此在舞台外，我想让他们在另一个下显示。我在 PHP/Java/C# 等方面经验丰富，但对 AS3 完全陌生。也许我有点过头了，先以这种方式进入 AS3 :x。

这是代码：

```
var navContainer:Sprite = new Sprite;
addChild(navContainer);

var navArray:Array =["Home","About","Work","Contact"];

for(var i:Number=0;i<4;i++){

var navItem:NavItem = new NavItem;

navItem.x = navItem.width*i;

navItem.nav_name.text = navArray[i];

navContainer.addChild(navItem);

navContainer.alpha = 0.7;

navContainer.width = stage.stageWidth;

navContainer.y = stage.stageHeight - (stage.stageHeight/1.25); 
```

对于它的价值，我正在运行[http://active.tutsplus.com/tutorials/web-design/create-a-full-screen-scalable-flash-website-part-1/](http://active.tutsplus.com/tutorials/web-design/create-a-full-screen-scalable-flash-website-part-1/)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-13T21:18:58.493

在您的循环中，您正在设置的`x`位置`navItem`：

`navItem.x = navItem.width*i;`

这就是`navItems`水平定位的原因。如果您想影响垂直位置，请`y`改为设置位置：

`navItem.y = navItem.height * i`

# android - 文本更改时如何显示 AutoCompleteTextView 的下拉菜单？

> ID：11023308
> 
> 赞同：1
> 
> 时间：2012-06-13T21:07:09.637
> 
> 标签：android, android-layout

我尝试了一些变体，其中之一：

```
tv.addTextChangedListener(new TextWatcher() {
  @Override
  public void beforeTextChanged(CharSequence charSequence, int i, int i1, int i2) {}
  @Override
  public void onTextChanged(CharSequence charSequence, int i, int i1, int i2) {
    tv.showDropDown();
  }
  @Override
  public void afterTextChanged(Editable editable) {}
}); 
```

但是，下拉建议会立即显示和隐藏（看起来像眨眼）。有没有办法在编辑文本后显示下拉菜单？

我还添加了一个按钮（用于测试）并添加了一个 onclick 侦听器，它调用`tv.showDropDown();`方法并且效果很好，正如我所期望的那样（这意味着（恕我直言）BaseAdapter、Filter 等没有问题）。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-13T21:11:31.487

我不认为你必须做这一切..自动完成应该像自动..

就像你必须告诉它它必须用于自动完成的数据一样，你就完成了。你不需要手动做`tv.showDropDown()`

```
AutoCompleteTextView textView = (AutoCompleteTextView) findViewById(R.id.autocomplete_country);
ArrayAdapter<String> adapter = new ArrayAdapter<String>(this, R.layout.list_item, COUNTRIES);
textView.setAdapter(adapter); 
```

`COUNTRIES`字符串数组在哪里

看这里[http://developer.android.com/resources/tutorials/views/hello-autocomplete.html](http://developer.android.com/resources/tutorials/views/hello-autocomplete.html)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-23T18:32:00.733

看@我的回答。当您获得更新的数据时，通过重置文本是非常简单的黑客攻击...

```
autoRailwayFrom.setText(autoRailwayFrom.getText()); 
```

[https://stackoverflow.com/a/15044017/1136023](https://stackoverflow.com/a/15044017/1136023)

# c# - XAML 中的嵌套资源

> ID：11023317
> 
> 赞同：1
> 
> 时间：2012-06-13T21:07:36.483
> 
> 标签：c#, .net, wpf, xaml, staticresource

我正在处理 xaml 中的嵌套情况，因此我在其中有一个工具栏

```
<Expander x:Name="expander1" Header="Controls" 
          Content="{StaticResource FC}" IsExpanded="True" /> 
```

虽然静态资源`FC`已在另一个 xaml 文件中定义为*在 FC.xaml 中作为*

 *```
<tb:Toolbox x:Key="FC" ItemSize="70,70" SnapsToDevicePixels="True"
            ScrollViewer.HorizontalScrollBarVisibility="Disabled"> 
```

我如何在后面的代码中使用它？请指教。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-14T06:51:57.070

您是否尝试过这样使用它-

```
Toolbox toolbox = expander1.Content as Toolbox; 
```

这应该有效；如果您想从资源字典（您的 xaml 文件）中访问它，请`FrameworkElement.FindResource`按照 Andrei 的建议使用。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-13T21:53:17.287

如果我理解正确，您想在后面的代码中使用工具箱*FC*资源。您可以使用 [FrameworkElement.FindResource](http://msdn.microsoft.com/en-us/library/system.windows.frameworkelement.findresource.aspx)，使用“FC”作为键并将结果转换为 Toolbox 类型。

如果资源 FC 可用于您的窗口/控件，它应该可以正常工作。*

# codeigniter - 在 codeigniter 中使用 Mysql WHERE IN 子句

> ID：11023318
> 
> 赞同：17
> 
> 时间：2012-06-13T21:07:36.887
> 
> 标签：codeigniter, codeigniter-2

我有以下 mysql 查询。您能告诉我如何以 Codeigniter 的方式编写相同的查询吗？

```
SELECT * FROM myTable 
         WHERE trans_id IN ( SELECT trans_id FROM myTable WHERE code='B') 
         AND code!='B' 
```

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2012-06-14T10:44:04.183

为此，您可以使用 codeigniter 的子查询方式来执行此操作，您将不得不破解 codeigniter。像这样
转到 system/database/DB_active_rec.php 从这些函数中删除 public 或 protected 关键字

```
public function _compile_select($select_override = FALSE)
public function _reset_select() 
```

现在子查询写入可用现在这是您的带有活动记录的查询

```
$this->db->select('trans_id');
$this->db->from('myTable');
$this->db->where('code','B');
$subQuery = $this->db->_compile_select();

$this->db->_reset_select();
// And now your main query
$this->db->select("*");
$this->db->where_in("$subQuery");
$this->db->where('code !=', 'B');
$this->db->get('myTable'); 
```

事情就完成了。干杯！！！
注意：在使用子查询时，您必须使用

```
$this->db->from('myTable') 
```

代替

```
$this->db->get('myTable') 
```

运行查询。
也看这个

[如何将此 SQL 重写到 CodeIgniter 的活动记录中？](https://stackoverflow.com/questions/10502778/how-can-i-rewrite-this-sql-into-codeigniters-active-records/10546395#10546395)

注意：在 Codeigntier 3 中，这些功能已经公开，因此您无需破解它们。

* * *

## 回答 #2

> 赞同：17
> 
> 时间：2013-04-18T14:20:11.193

```
$data = $this->db->get_where('columnname',array('code' => 'B'));
$this->db->where_in('columnname',$data);
$this->db->where('code !=','B');
$query =  $this->db->get();
return $query->result_array(); 
```

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2012-06-14T08:36:30.873

试试这个：

```
$this->db->select("*");
$this->db->where_in("(SELECT trans_id FROM myTable WHERE code = 'B')");
$this->db->where('code !=', 'B');
$this->db->get('myTable'); 
```

注意：$this->db->select("*"); 当您从表中选择所有列时是可选的

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-06-13T21:20:12.577

试试这个：

```
return $this->db->query("
     SELECT * FROM myTable 
     WHERE trans_id IN ( SELECT trans_id FROM myTable WHERE code='B') 
     AND code!='B'
     ")->result_array(); 
```

不是活动记录，而是 codeigniter 的方式[http://codeigniter.com/user_guide/database/examples.html](http://codeigniter.com/user_guide/database/examples.html) 请参阅具有多个结果的标准查询（数组版本）部分

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2021-10-14T06:44:39.940

您可以使用更简单的方法，同时仍使用活动记录

```
$this->db->select("a.trans_id ,a.number, a.name, a.phone")
$this->db->from("Name_Of_Your_Table a");
$subQueryIn = "SELECT trans_id FROM Another_Table";
$this->db->where("a.trans_id in ($subQueryIn)",NULL); 
```

# tsql - T-SQL 如果存在

> ID：11023323
> 
> 赞同：0
> 
> 时间：2012-06-13T21:07:56.870
> 
> 标签：tsql

我是 T-SQL 的暑期实习生，我必须在各种数据库上运行 sql select 语句。我想做的是使用“如果存在”来防止发生错误，因为列表中执行此语句的某些数据库不再存在。但是，我无法弄清楚如何将其应用于我的陈述。任何帮助将不胜感激。以下是我和另一位实习生写的声明：

```
select distinct mg.MatterName, mg.ClientNumber, mg.MatterNumber,grp.groupName as SecurityGroup
from (select distinct mat.matterName, mat.clientNumber, mat.matterNumber, usr.GroupID
    from <db_name>.dbo.matter mat
    inner join <db_name>.dbo.usrAccount usr
    on usr.NTlogin=mat.matterCreateBy) as mg
          inner join <db_name>.dbo.usrGroup grp
          on mg.groupID=grp.groupID
order by matterName 
```

< db_name> 是作为数据库名称的传入参数所在的位置。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-13T21:21:36.790

您可以使用`sp_MSforeachdb`枚举实例上的所有数据库。

这将类似于：

```
exec sp_MSforeachdb 'select distinct mg.MatterName, mg.ClientNumber, mg.MatterNumber,grp.groupName as SecurityGroup from (select distinct mat.matterName, mat.clientNumber, mat.matterNumber, usr.GroupID     from ?.dbo.matter mat     inner join ?.dbo.usrAccount usr     on usr.NTlogin=mat.matterCreateBy) as mg           inner join ?.dbo.usrGroup grp           on mg.groupID=grp.groupID order by matterName' 
```

或者，您可以使用动态 sql 来制作脚本：

```
select 'use ' + name + ';' + char(13) + 'select distinct mg.MatterName, mg.ClientNumber, mg.MatterNumber,grp.groupName as SecurityGroup' +CHAR(13) + 'from (select distinct mat.matterName, mat.clientNumber, mat.matterNumber, usr.GroupID' + char(13) + 'from dbo.matter mat' + char(13) + 'inner join dbo.usrAccount usr on usr.NTlogin=mat.matterCreateBy) as mg' + char(13) + 'inner join dbo.usrGroup grp on mg.groupID=grp.groupID' + CHAR(13) + 'order by matterName;'
from master.sys.databases where database_id>4 
```

如果您将输出重定向到 SSMS 中的“结果到文本”然后运行脚本，您将看到编写的脚本，然后您可以将其放入查询编辑器中执行。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-14T15:40:47.817

我让它工作。我认为这有点骇人听闻，但我所做的是捕获抛出的异常并更改页面上的标签以反映数据库不存在。

```
 DataAccess dal = new DataAccess();
 dal.SelectedConnectionString = "WebServer08";

 String exNetName = Request.QueryString["name"];
 if (exNetName != null && !exNetName.Equals(""))
 {
     try
     {
        gvMatters.DataSource = dal.GetMatters(exNetName);
        gvMatters.DataBind();
      }
      catch (Exception ex)
      {
         noDB.Text = "This database doesn't exist.";
         gvMatters.Visible = false;
      }
 } 
```

而且我只是按原样保留了 SQL 语句，而不是试图搞砸它

# javascript - g.nodeName 未定义

> ID：11023325
> 
> 赞同：1
> 
> 时间：2012-06-13T21:08:14.187
> 
> 标签：javascript, jquery, firebug

我正在将登录/注册页面转换为使用 Ajax/jQuery。因此，两种表单之间有很多共同的验证功能。我使用 jQuery 的一个领域是根据输入向用户输出错误消息。虽然表单共享相似的元素 ID，但类名不同。

所以为了检查用户名，我有

```
if ($(":input").is('.registerName')){
   //Username belongs to the registration form, so check if current entry is 
   //valid and not taken.  Output error message otherwise

}  else {
   //username belongs to the login form, so check if current entry exists in database
   //output username/password error depending on catch
} 
```

我经历过一些奇怪的事情。

首先，上面的代码返回一个`g.nodeName is undefined error`. 如果我将初始条件更改为

```
if ($("input#username").is('.registerName')) 
```

Firebug 中也出现了同样的错误。

然而，

```
if ($("#username").is('.registerName')) 
```

和

```
if ($("#username").hasClass('registerName)) 
```

都失败并且登录验证部分执行。

那么如何在没有 g.nodeName 未定义错误的情况下根据类名执行正确的代码块呢？

**编辑**

澄清一下 - 同一页面上没有两种表格。代码功能在 javascript 中。我指的是调用相同 JS 函数的不同页面上的两个单独的 HTML 表单，唯一的区别是错误消息输出中的文本。

**编辑 2**

JFiddle 示例：[这里](http://jsfiddle.net/daredevil82/MEfNs/4/)

文本框 onclear 不适用于小提琴，但我认为您可以了解我正在尝试做的事情的要点。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-13T21:57:58.800

我无法重现您遇到的确切问题，但请尝试

```
if ($(this).is('.registerName')) 
```

反而。这样您就会知道它只查看`keyup`发生事件的特定元素。`$(':input')`将查找页面上的*所有*输入。

# javascript - 来自href的新窗口/标签

> ID：11023330
> 
> 赞同：0
> 
> 时间：2012-06-13T21:08:36.720
> 
> 标签：javascript, joomla

我可以访问 joomla 版本，但不能访问源代码，我需要添加一个必须在其他窗口/选项卡中打开的链接。

我只能更改 href 字段内容。

我尝试

```
javascript:window.open('http://url/') 
```

这适用于chrome，但不适用于firefox。

有什么建议吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-13T21:20:49.960

根据[MDN](https://developer.mozilla.org/en/DOM/window.open)，window.open() 至少需要两个参数。它还返回新打开的窗口的对象，这将导致`[object Window]`出现在原始窗口中。返回`undefined`避免了第二个问题。这会起作用：

```
javascript:window.open('http://url/', '_blank');undefined 
```

较旧的代码通常会使用[`void`operator](https://developer.mozilla.org/en/JavaScript/Reference/Operators/void)，它会评估其唯一的操作数并`undefined`无论如何都会产生结果。所以这也可以：

```
javascript:void(window.open('http://url/', '_blank')) 
```

在任何一种情况下，特殊的窗口名称`_blank`只是告诉浏览器打开一个新窗口或选项卡。浏览器的设置决定了确切的行为，因为标签式浏览是在之后引入`_blank`的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-13T21:14:13.160

只需使用`_blank` [target](http://dev.w3.org/html5/spec/links.html#attr-hyperlink-target)属性，它会在新窗口/选项卡中打开链接（您无法控制哪个，浏览器将根据点击事件算法选择）：

```
<a href="http://blah.com/path" target="_blank">Link</a> 
```

不知道为什么使用“javascript：”协议在 FF 中不起作用，但是在常规脚本标签中的 JS 可能会起作用。window.open 上的[MDN 条目](https://developer.mozilla.org/en/DOM/window.open)也可能有助于阅读。

# jsf - 如何使用 在一个里面 ?

> ID：11023331
> 
> 赞同：5
> 
> 时间：2012-06-13T21:08:43.067
> 
> 标签：jsf, datatable, facelets, uiinclude

我想`<ui:include>`多次动态地包含一页。

代码：

```
<h:dataTable ..>
    <h:column>
        <ui:include  src="#{create_page}">
    <h:column>
<h:dataTable> 
```

现在，当我提交它时，它只保留最后一个 inlude。它只记住最后包含的页面的值。我想要每个 create_page 中的唯一实体对象。我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-13T21:19:59.193

`<ui:include>`is 作为在视图构建期间执行的标记处理程序，而is`<h:dataTable>`作为在视图渲染期间执行的 UI 组件。这意味着在迭代*之前*`<ui:include>`只执行一次，因此不在迭代期间执行。您实际上最终会在每一行中得到完全相同的包含源。提交表单时，行将被逐一处理，直到最后一行，这就是您有效地最终得到最后一行的值的原因。*`<h:dataTable>`*

 *基本上有两种方法可以解决这个问题：

1.  使用`<c:forEach>`代替`<h:dataTable>`，这也在视图构建期间运行。

2.  使用标签文件或复合组件代替`<ui:include>`，这也在视图渲染期间运行。

无论哪种方式，您还需要确保输入值绑定到数据表`var`属性后面的对象，而不是绑定到一个相同的支持 bean 属性。

### 也可以看看：

*   [JSF2 Facelets 中的 JSTL...有意义吗？](https://stackoverflow.com/questions/3342984/jstl-in-jsf2-facelets-makes-sense)（与`<ui:include>`JSTL 属于同一类）
*   [何时使用 <ui:include>、标记文件、复合组件和/或自定义组件？](https://stackoverflow.com/questions/6822000/when-to-use-uiinclude-tag-files-composite-components-and-or-custom-componen/)*

# linux - GETOPTS 传递选项以创建查找功能

> ID：11023333
> 
> 赞同：1
> 
> 时间：2012-06-13T21:09:01.737
> 
> 标签：linux, arguments, getopts

我正在拼命地为我的 Getopts 寻找解决方案，例如

```
#!/bin/bash

while getopts ":a:b:" opt; do

case $opt in 

  a) find / $OPTARG >&2  ;;

  b) 2>/dev/null  >&2 ;;

  \?)
    echo "Invalid option: -$OPTARG" >&2
    exit 1
    ;;
esac 
```

然后作为输出示例

> ./somefile.sh -a *txt -b

或者

> ./somefile.sh -b -a *txt

但是我想确保我可以进一步升级它，例如只找到 sh 文件或其他东西。它不容易找到，但我希望有人可以帮助我。

# android - 如何设置Android按钮背景颜色？

> ID：11023335
> 
> 赞同：2
> 
> 时间：2012-06-13T21:09:06.557
> 
> 标签：android, button

我想为几个按钮使用自定义背景颜色。我试过`android:background="#cc2"`了，但它取代了整个按钮，所以它看起来不再像一个按钮了。

显然，可以为此使用`<selector>`（可绘制的）。这是唯一的方法吗？我在哪里可以获得原始标准 Android 按钮的模板？

注意：[这个问题](https://stackoverflow.com/questions/1521640/standard-android-button-with-a-different-color)的公认答案不是我想要的，因为它看起来不像标准的 Android 按钮。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-13T22:37:23.733

基于[这个问题](https://stackoverflow.com/questions/8369504/why-so-complex-to-set-style-from-code-in-android)，我能够确定例如 Android 2.2 的标准按钮模板位于

```
C:\Program Files (x86)\Android-sdk\platforms\android-8\data\res\drawable\btn_default.xml 
```

显然，您的 PC 上的路径可能不同。它指的是drawable，例如`"@drawable/btn_default_normal"`指的是9-patch文件，例如HDPI文件是

```
data\res\drawable-hdpi\btn_default_normal.9.png
data\res\drawable-hdpi\btn_default_normal_disable.9.png
data\res\drawable-hdpi\btn_default_pressed.9.png
data\res\drawable-hdpi\btn_default_selected.9.png
data\res\drawable-hdpi\btn_default_normal_disable_focused.9.png 
```

**如何查找资源**：我从 Button.java 的构造函数开始（使用 SDK Manager 下载 Android SDK 的 Sources）：

```
this(context, attrs, com.android.internal.R.attr.buttonStyle); 
```

其中指的是`<item>`in `res/values/themes.xml`：

```
<item name="buttonStyle">@android:style/Widget.Button</item> 
```

其中指的是`<style>`in `res/values/styles.xml`：

```
<style name="Widget.Button">
    <item name="android:background">@android:drawable/btn_default</item>
    <item name="android:focusable">true</item>
    <item name="android:clickable">true</item>
    <item name="android:textAppearance">?android:attr/textAppearanceSmallInverse</item>
    <item name="android:textColor">@android:color/primary_text_light</item>
    <item name="android:gravity">center_vertical|center_horizontal</item>
</style> 
```

最后指的是`res/drawable/btn_default.xml`。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-14T10:24:00.310

添加你的风格

```
 <style name="MyButtonStyle" parent="android:Widget.Button">
        <item name="android:background">@drawable/btn_default</item>
 </style> 
```

和您的选择器（此处为 btn_default.xml）

```
<selector xmlns:android="http://schemas.android.com/apk/res/android">
    <item android:state_window_focused="false" android:state_enabled="true"
        android:drawable="@drawable/btn_default_normal" />
    <item android:state_window_focused="false" android:state_enabled="false"
        android:drawable="@drawable/btn_default_normal" />
    <item android:state_pressed="true" 
        android:drawable="@drawable/btn_default_pressed" />
    <item android:state_focused="true" android:state_enabled="true"
        android:drawable="@drawable/btn_default_pressed" />
    <item android:state_enabled="true"
        android:drawable="@drawable/btn_default_normal" />
    <item android:state_focused="true"
        android:drawable="@drawable/btn_default_pressed" />
    <item
         android:drawable="@drawable/btn_default_normal" />
  </selector> 
```

和您的图像（9 个补丁）btn_default_normal 和 btn_default_pressed（名称可能与这些不同）然后，将样式应用于 xml 中的按钮：

```
 <Button
      ...
      style="@style/MyButtonStyle"
   /> 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-13T21:15:13.517

如您所见，如果您更改按钮背景，则整个背景都会更改。如果您想拥有自己风格或颜色的按钮，您可以创建一个 9-patch 文件，将您选择的图形作为按钮背景。如果您希望它显示选择或单击状态，您可以使用带有选择器的状态列表。

9patch 和选择器都在这里解释：http: [//developer.android.com/guide/topics/resources/drawable-resource.html](http://developer.android.com/guide/topics/resources/drawable-resource.html)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-13T21:25:13.313

> 我在哪里可以获得原始标准 Android 按钮的模板？

系统资源包含在 SDK 中。

您可以在以下位置找到它们（在 Windows 上）：`sdk-root/platforms/[pick a platform]/data/res/drawable/`

根据您正在寻找的平台级别，您可能会发现您需要的 xml 选择器是普通可绘制的，而 png 本身位于特定于分辨率的文件夹之一中，例如 drawable-mdpi 或 drawable-hdpi

# jquery - jquery更改事件没有触发？

> ID：11023336
> 
> 赞同：1
> 
> 时间：2012-06-13T21:09:07.577
> 
> 标签：jquery, events, combobox

我正在尝试根据组合框中的更改事件更新隐藏的输入项。我有一堆下拉菜单，如果它们属于某个类（“test1”），我将动态更改为组合框。我想补充一点，我正在使用我在此处找到的一些 jquery 来获得一个“打开”组合框......即接受任何用户输入而不仅仅是选项列表中可用的内容。为此，我使用了此处提供的 javascript：[jQuery combobox/autocomplete but editable](https://stackoverflow.com/questions/9473268/jquery-combobox-autocomplete-but-editable)

但是，只有以下一项工作......

```
 $(document).ready(function () {
        $(".test1").combobox();
    });

    $(document).ready(function () {
        $(".test1").change(function () {
            alert('test'); //Other logic to update hidden elements.

        }
        );
    }); 
```

如果我注释掉这个函数，它会将下拉菜单变成一个组合框，然后警报就会触发。如果我关闭警报功能，组合框调用将起作用，并且下拉列表变为组合框。任何人都可以提出解决方案吗？

**更新：**

我弄清楚了为什么这不起作用（至少我是这么认为的）。在上面的链接中，已经处理了组合框的更改行为。我的额外更改事件处理程序未注册。我必须将我的代码添加到更改事件本身中（就像这个片段）：

```
 change: function (event, ui) {
                var selset = "CHF Discharge Diagnosis";
                    $(':hidden').filter($('input[selsetname="' + selset + '"]')).val(this.value);
                    alert($(':hidden').filter($('input[selsetname="' + selset + '"]')).val());

                    if (!ui.item) {
                        var matcher = new RegExp("^" + $.ui.autocomplete.escapeRegex($(this).val()) + "$", "i"),
                            valid = false; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-13T21:16:56.637

如果组合框正在更改 html 结构（例如创建 ul 或 div 元素而不是表单选择和输入），则它可能不会触发该元素的更改事件。但是在这里：底部的[http://jquery.sanchezsalvador.com/jquery/page/jquerycomboboxapi.aspx](http://jquery.sanchezsalvador.com/jquery/page/jquerycomboboxapi.aspx)`onChange`是一个带有方法的片段。基于此尝试以下

```
$(document).ready(function () {
    var cb = $(".test1").combobox();
    cb.combobox.onChange = function() {
        alert('test'); //Other logic to update hidden elements.
    };
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-15T17:47:26.510

我想我知道为什么这不起作用（至少我是这么认为的）。在定义 UI 小部件的链接 (http://stackoverflow.com/questions/9473268/jquery-combobox-autocomplete-but-editable) 中，已经处理了组合框的更改行为。我的额外更改事件处理程序未注册。我必须将我的代码添加到更改事件本身中（就像这个片段）：

```
change: function (event, ui) {
            var selset = "CHF Discharge Diagnosis";
                $(':hidden').filter($('input[selsetname="' + selset + '"]')).val(this.value);
                alert($(':hidden').filter($('input[selsetname="' + selset + '"]')).val());

                if (!ui.item) {
                    var matcher = new RegExp("^" + $.ui.autocomplete.escapeRegex($(this).val()) + "$", "i"),
                        valid = false; 
```

# c# - C# 抓取输入文本并推送到整数

> ID：11023337
> 
> 赞同：2
> 
> 时间：2012-06-13T21:09:12.943
> 
> 标签：c#, textfield

我试图让这段代码在 C# 中工作，我想做的是如果更新文本字段以验证它的整数（HP 是整数）。

因此，通过尝试将输入转换为整数，我要么得到一个新整数，并将值设置为它，要么如果失败，它会采用先前验证的值并推回文本字段（几乎忽略输入，更新它，它现在是经过验证的输入）。

在我看来，这都是逻辑和工作，实际上它不是。请帮忙。

```
private void Input_HP_TextChanged(object sender, EventArgs e)
{
    Try
    {
        HP = Convert.ToInt32(Input_HP.Text);
    }
    catch(Exception e)
    {
        Input_HP.Text = HP;
    }
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-13T21:11:32.690

Int.TryParse 可能是您正在寻找的：

```
int HP;
if (int.TryParse(Input_HP.Text, out HP))
{
  // the number is an integer at this point
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-13T21:14:08.353

您可以使用 try.parse，但您需要将其设置为临时变量。在您的情况下，使用 HP 将覆盖您要保存的变量。

```
int tempInt;
if(Int32.TryParse(Input_HP.Text, out tempint))
{
    HP = tempInt;
}
else
{
    Input_HP.Text = HP.ToString();
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-13T21:16:41.707

如果 HP 是整数，则不能直接将其分配给`Text`属性，因为这是类型`String`。这应该是编译时错误，对于这部分代码，您应该使用该`.ToString()`函数...

```
Input_HP.Text = HP.ToString(); 
```

当然，`TryParse`无论如何，您都应该使用 a 进行此转换。我想你想要的是这样的......

```
private void Input_HP_TextChanged(object sender, EventArgs e)
{
    int i = 0;
    if(int.TryParse(Input_HP.Text, out i))
    {
       HP = i;
    }
    else
    {
       Input_HP.Text = i.ToString();
    }
} 
```

# php - codeplex phpexcel 只选择有数据的单元格

> ID：11023338
> 
> 赞同：0
> 
> 时间：2012-06-13T21:09:16.777
> 
> 标签：php, phpexcel

我正在阅读一个电子表格并将其放入一个数组中（我将很快将其插入到数据库中，但现在我只是在做一个 vardump 进行测试），使用以下代码：

```
$objPHPExcel->setActiveSheetIndex(1);
$sheetData = $objPHPExcel->getActiveSheet()->toArray(null,true,true,true);
?><pre><?php var_dump($sheetData); 
```

现在这正如我预期的那样工作得很好，但是工作表有大量空白行，这些行也返回到数组中，有没有办法只获取包含数据的行？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-13T21:17:42.393

不幸的是，您需要循环 toArray() 返回的每一行，检查该行中的每个单元格以查看它是否为空

# video - prettyphoto 插件不播放 vzaar 的视频

> ID：11023341
> 
> 赞同：0
> 
> 时间：2012-06-13T21:09:32.863
> 
> 标签：video, prettyphoto

我在我的网站上添加了 prettyphoto 插件，可以在弹出窗口中播放视频。youtube 和 vimeo 上的视频效果很好，但 vzaar 上的视频效果不佳。我收到此错误：“无法加载图像。确保路径正确且图像存在。”

有没有人知道这个解决方案或任何更好的在弹出窗口上播放 vzaar 视频的提议？

提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-15T09:30:21.533

首先我要指出的是，我们在[http://vzaar.com/help](http://vzaar.com/help)上有一个客户支持论坛，因此如果您以后可能遇到任何问题，您将能够得到我们快速、准确的回复.

不过，关于您当前的问题：您能否提供您的代码或网站链接，以便我们区分问题所在？

或者，我们的知识库中有一个使用 zoombox 实现此效果的教程，您可以在此处找到：http: [//vzaar.com/help/kb/video-and-technical-questions/how-do-i-create -a-视频灯箱](http://vzaar.com/help/kb/video-and-technical-questions/how-do-i-create-a-video-lightbox)

一切顺利，
丹

# sql - 如何插入表格列值：来自列日期类型的月份和日期

> ID：11023342
> 
> 赞同：2
> 
> 时间：2012-06-13T21:09:39.260
> 
> 标签：sql, oracle11g, concatenation, oracle-sqldeveloper, datepart

我正在使用 Oracle 11g 架构

我想从日期中选择月份和日期，将其连接起来并将其放入一列中。

我在这里的语法是有道理的，但它抛出了一个错误..

```
INSERT INTO OB_SELECT_LST12_SPG WED 
  VALUES (((TO_CHAR(TO_DATE('RET_DATE', MM))||( TO_CHAR(TO_DATE('RET_DATE', DD))); 
```

“SQL 错误：ORA-00907：缺少右括号”

任何帮助是极大的赞赏。谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-13T21:30:28.097

先说几点...

1.  您的表名中有一个空格
2.  您没有足够的列错误是由于您在表中有多个列
3.  你真的不应该这样做
4.  如果`ret_date`是列，请不要将其封装在引号 ( `'`) 中，因为您将无法将字符串`'ret_date'`转换为日期。

但是，假设`ret_date`是一个看起来像的字符串`13-06-2012`

```
insert into ob_select_lst12_spg_wed (my_column)
values(to_char(to_date(:ret_date,'dd-mm-yyyy'),'mmdd')); 
```

如果`ret_date`是日期数据类型，那么您可以删除内部转换。

```
insert into ob_select_lst12_spg_wed (my_column)
values(to_char(:ret_date,'mmdd')); 
```

`to_char`并且`to_date`两者都使用[日期时间格式模型](http://docs.oracle.com/cd/E11882_01/server.112/e26088/sql_elements004.htm#SQLRF00212)，它们有很多选项。

* * *

请不要这样做。*始终将日期存储为日期*

* * *

您的评论`ret_date`是一个日期，列`wed`是一个字符。您收到错误绑定变量未声明，因为您尚未指定变量。我将假设它`ret_date`在另一个表中，因为它是一个日期，在这种情况下会丢失 values 关键字并直接从该表中插入：

```
insert into ob_select_lst12_spg (wed)
select to_char(ret_date,'mmdd')
  from the_other_table 
```

但这不应该是必需的，您始终可以在*退出*数据库时将日期转换为您想要的任何内容。如果您不将其作为日期存储在数据库中，那么很容易出现错误和不正确的值。我*个人*会将列更改`wed`为日期，在这种情况下，您的查询变得非常简单：

```
insert into ob_select_list12_spg (wed)
select ret_date
  from the_other_table 
```

然后，在从数据库中进行选择时，您可以根据需要使用正确的[日期时间格式模型](http://docs.oracle.com/cd/E11882_01/server.112/e26088/sql_elements004.htm#SQLRF00212)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-13T21:28:42.000

从日期列获取日期、月份的示例查询：

```
Select ((To_Char(to_date('01-FEB-73','dd-mon-yy'), 'MM'))
       ||( To_Char(to_date('01-JAN-73','dd-mon-yy'), 'dd')))
 from dual; 
```

如果 RET_DATE 是日期数据类型，则使用

```
insert into table_name (columname) 
Select ((To_Char(RET_DATE, 'MM'))
           ||( To_Char(RET_DATE, 'dd')))
     from dual; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-13T21:19:24.920

您缺少额外的括号。打开的数量`(`是 8 和关闭的数量`)`是 5

```
INSERT INTO OB_SELECT_LST12_SPG(WED) 
VALUES ((TO_CHAR(TO_DATE(RET_DATE, MM)))||( TO_CHAR(TO_DATE(RET_DATE, DD)))); 
```

**更新** 确保不需要其他列（即允许 NULL）

# objective-c - NSarray 计数超出范围

> ID：11023345
> 
> 赞同：0
> 
> 时间：2012-06-13T21:09:47.383
> 
> 标签：objective-c, nsarray

我正在尝试检查以下内容并全部抛出越界错误

```
if ([objects count] < 1)
if ([objects count] == 0)
if ([objects count] <= 0) 
```

三人都出界了？如何在“if/else”语句中使用它？是否无法检查 NSArray 是否包含零个对象。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-13T21:27:17.727

如果你只是定义了指针但没有初始化你的`objects`实例，你会得到非常奇怪的行为。作为一个初级可可开发者，我至少被类似的东西烧了两次

```
NSMutableArray *objects;
...
if ( [objects count] == 0 )
{
    .... // do something 
} 
```

你确定你初始化了它，例如：

```
NSMutableArray *objects = [NSMutableArray array]; 
```

因为它真的应该在这种情况下工作！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-13T21:18:51.067

我不认为这些代码行会导致这样的错误。

此代码适用于任何数组。越界异常意味着您尝试调用类似

```
[myArray objectAtIndex:0]; 
```

在一个空数组上。或者，换句话说，您试图访问一个不属于数组的对象。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-14T05:41:29.373

你也可以试试这个。

```
if(![objects lastObject])
{
    //... Do Something
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-13T21:51:09.360

`objectAtIndex`您不应该得到越界异常，因为您甚至没有尝试访问数组中的元素——只有在调用数组并指定非法索引时才应该抛出越界异常。

通常，为了防止尝试访问 nil 或空数组，我通常会执行以下操作：

```
if(!objects || !objects.count) ... 
```

这样，如果`objects`不存在则`objects.count`不会被调用。

# gsl - QAWC gsl - 无法集成功能

> ID：11023346
> 
> 赞同：0
> 
> 时间：2012-06-13T21:09:58.653
> 
> 标签：gsl

我有这样一段代码：

```
#include <gsl/gsl_integration.h>
#include <stdio.h>
#include <time.h>
#include <math.h>

double func1(double x, void* params) {
   return 1/(x-1);
}

int main() {
   int num = 100;
   gsl_integration_workspace *workspace = gsl_integration_workspace_alloc(num); 
   double result, error;    
   double alpha;    
   alpha = 1;
   gsl_function F;  
   F.function = &func1; 
   F.params = &alpha;   
   double a, b;
   a=0; 
   b=2;
   double err1= 0;  
   double err2 = 1e-7;
   gsl_integration_qawc (&F, a, b, 1.0, err1, err2, num, workspace,&result, &error);

   printf("Function QAWC - Cauchy Principal value\n");
   printf("Result: %f\n", result);
   printf("Error: %f\n", error);

   result = 0; 
   gsl_integration_workspace_free(workspace);   //zwolnienie pamięci dla całkowania
   return 0;
} 
```

我以为它会处理这种功能，但我得到“无法集成功能”错误。为什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-13T23:57:34.487

这并不难。简单来说，要计算的函数具有 F(x)=g(x)*w(x) 的形式，其中 g(x) 是用户必须定义​​的函数。w(x) 是使用 c 参数生成的，形式为：w(x)=1/(xc)。因此，如果我们要计算函数 f(x)=1/(x-1) 的主值，则 func1 应该是：

```
double func1(double x, void* params) {
   return 1;
} 
```

并且参数 c（4\. 函数 gsl_integration_qawc 的参数）应为 1。

# ios - 临时通知不起作用但没有错误

> ID：11023347
> 
> 赞同：2
> 
> 时间：2012-06-13T21:09:59.090
> 
> 标签：ios, apple-push-notifications, ad-hoc-distribution

通知与我的开发配置文件一起正常工作，但是当我使用分发配置文件进行临时测试时，应用程序停止接收通知。

1.  注册到通知服务器没问题，因为 didRegisterForRemoteNotificationsWithDeviceToken 被正确调用；
2.  Distribution Provisioning Profile 中的权利正确显示“aps-environment”键的“production”；
3.  服务器端连接到“gateway.push.apple.com”的2195端口；
4.  服务器使用从其 APNS 服务器收到的令牌将通知发送到 Apple 网关，并且没有错误；
5.  Ad-hoc Distribution Provisioning Profile 使用为开发和生产推送通知启用的正确 AppID；
6.  Ad-hoc Distribution Provisioning Profile 也基于正确的生产证书。

我迷路了，对要检查的内容没有更多的想法...

# facebook - 在 URL 上添加 Facebook 评论并将其显示在用户个人资料中

> ID：11023348
> 
> 赞同：0
> 
> 时间：2012-06-13T21:10:01.710
> 
> 标签：facebook, facebook-graph-api

我正在创建一个 Web 应用程序，它显示从 Flickr 拍摄的图像列表，我希望用户通过 Facebook 登录并允许他们对这些图像发表评论。我能够使登录/身份验证正常工作，但我现在无法让用户在 Flickr 图像上添加评论（与 Facebook 的“帖子”相反）并让此活动显示在用户的 Facebook 个人资料上/提要（即“约翰史密斯评论了一个链接”）。

这是我到目前为止所拥有的：

```
var fbCommentApi = '/me/myappname_ns:comment?access_token=' + fbUserToken + '&method=post' + '&picture=[WEBSITE_URL]' + selectedItemId;
FB.api(
    fbCommentApi,
    'post',
    { message: txtObj.value },
    function (response) {
        if (!response || response.error) {
            alert("Sorry, there was a problem. Please try again later. [API]");
        }
        else {
            alert("Thank you. Your comment will appear shortly");
            hideCommentBox(txtObj);
        }
    }
); 
```

上面的代码不会创建评论，而是会在用户的时间轴上创建一个附有 URL 的帖子。因此，当我尝试通过 Facebook Graph 检索 WEBSITE_URL 项目的评论时......

```
'https://graph.facebook.com/comments/?id=[WEBSITE_URL]' + itemID 
```

...我最终返回了空数据。

我的 Facebook 应用程序中有一个名为“评论”的操作类型，这就是我在尝试添加评论时使用的操作。

在此先感谢您，我期待您的回答。

**更新1：**现在看来，如果我以这种方式使用Facebook Graph .. `graph.facebook.com/me/appname_ns:discuss?access_token=[TOKEN]&website=[URL]&met‌​hod=post` ..它只会在他们的时间线中向用户的活动框添加一个条目，我什至没有将评论或消息参数作为查询传递给URL字符串参数。这可能是问题的一部分。

**更新 2：**根据另一个[StackOverflow 问题](https://stackoverflow.com/questions/8007724/how-to-get-all-the-open-graph-beta-actions-generated-by-an-app)，似乎无法查看*所有用户*完成的所有*操作*，必须按用户完成（每个用户调用 API）。因此，处理此特定问题的另一种方法是将评论（或执行的任何操作）保存到我们自己的数据库中。

 ** * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-13T21:13:48.650

好吧，Open Graph 操作不是评论，即使您将其命名为*评论*……</p>

如果你想要一个真正的 Facebook 评论，那么要么获取一个实际可以评论的对象的引用；或用帖子/链接帖子替换评论。*

# delphi - 如何备份和恢复我的 Delphi 设置？

> ID：11023353
> 
> 赞同：9
> 
> 时间：2012-06-13T21:10:37.047
> 
> 标签：delphi, backup, delphi-xe

> **可能重复：**
> [如何迁移 Delphi 或克隆 Delphi 注册表设置？](https://stackoverflow.com/questions/9140013/how-to-migrate-delphi-or-clone-delphi-registry-settings)

我需要尽快格式化我的电脑，但我已经按照我想要的方式完美设置了 IDE 和环境设置，以及我安装的一些组件。

显然，格式化和重新安装 Windows 将清除所有设置和注册表项，所以当我再次安装 Delphi 时，我将不得不对其进行调整以使其恢复到原来的样子，这将花费相当多的时间，我宁愿不使用向上。

保留 Delphi IDE 和环境设置以及已安装组件的最佳方法是什么？

这只是备份注册表项和用户数据文件夹的情况吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-06-14T06:47:56.747

如何手动对delphi XE进行完整备份：

*   备份完整的安装文件夹。（提示：将您的组件安装在 delphi 文件夹下，以便它们也得到备份）。
*   导出和备份 HKLM\Software\Embarcadero 注册表项，如果是 64 位操作系统，它将是 HKLM\Software\Wow6432Node\Embarcadero
*   导出和备份 HKCU\Software\Embarcadero 注册表项
*   某些组件可能会将 BPL 文件写入您的系统文件夹（检查 C:\Windows\System32 或 C:\Windows\SysWOW64 文件夹）

**重新安装操作系统后：**

*   将 Delphi 重新安装到相同的文件夹并应用相同的更新
*   用备份覆盖安装
*   从备份中重新导入注册表项
*   如果您有 Delphi 插件/专家，请重新安装它们

一些技巧：

*   将 Delphi 安装在驱动器的根目录下（例如 c:\DelphiXE），这样可以防止在 vista/W7 下 UAC 出现问题。
*   将您的项目保存在 delphi 文件夹下，如果您必须处理不同的 delphi 版本（例如 c:\delphi5\projects、c:\delphixe\projects...），这将非常方便
*   每天自动备份您的 delphi 文件夹（通过 Windows 备份或其他工具）

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-14T04:23:35.963

是的，我同意@Martin，VMWare 非常适合这个[VMWare](http://www.vmware.com)。不仅适用于 Delphi 及其设置和组件，还适用于整个操作系统，包括 SP、KB、驱动程序、设置、应用程序及其设置、防病毒、防火墙。

这就是我对 VMWare ver 5 所做的（其他/新版本可能不同）

1.  在主机操作系统上安装 VMWare。主机可以是 Windows 操作系统或 Linux 操作系统变体。我个人喜欢使用 Linux 作为主机操作系统，因为对我来说，对病毒、恶意软件等的安全性更好。
2.  安装来宾操作系统。这可以是选择的任何受支持的操作系统，包括所需的任何 SP、驱动程序。
3.  安装 Delphi 和您需要的所有组件。
4.  您可以将来宾操作系统备份到媒体，例如 DVD-R。如果发生任何重大事件，您可以将其恢复不到 30 分钟。这是一个巨大的好处。

您可以拥有任意数量的来宾 O/Ses（如果有空间）。这非常适合测试目的。您有多少次听说您的应用程序在客户端 PC 上使用特定 SP/KB、dll 或其他特定设置在特定 O/S 上中断？使用多个来宾操作系统，您可以使用不同的操作系统和/或设置测试您的应用程序，而无需拥有多台 PC 或具有不同操作系统的多个分区。

当然VMWare还有很多其他的用法，但是对于我来说，上面的使用场景就足够了。

其他虚拟机来自免费的[Oracle VM](http://www.oracle.com/us/technologies/virtualization/oraclevm/index.html "甲骨文虚拟机")的 Oracle (Oracle VM) 。他们声称比 VMWare 更好，但我自己没有测试过。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-06-13T23:00:57.303

你可以试试 CnWizard 备份/恢复工具。如果组件和delphi安装路径相同，只需备份，安装delphi和cnwizard，复制所有组件文件夹并进行恢复。我只有从 XP 迁移到 W764b 时遇到问题，必须手动更改注册表中 Program Files 文件夹的路径。

# python - python/pygame 图像无法在同一个文件夹中找到

> ID：11023363
> 
> 赞同：-2
> 
> 时间：2012-06-13T21:11:35.627
> 
> 标签：python, pygame

你好，我是 python/pygame 的新手，并尝试制作一个基本项目。结果并没有按计划进行，因为我不明白这个错误如果你能告诉我为什么我的图像没有加载它会非常感激。 `Traceback (most recent call last): File "C:\Users\Nicolas\Desktop\template\templat.py", line 15, in <module> screen.fill(background_colour) NameError: name 'background_colour' is not defined`

这是我所说的错误，但我现在已经修复了。现在屏幕打开如何显示背景和崩溃。

```
 import pygame, sys

pygame.init()

def game():

 background_colour = (255,255,255)
(width, height) = (800, 600)

screen = pygame.display.set_mode((width, height))

pygame.display.set_caption('Tutorial 1')
pygame.display.set_icon(pygame.image.load('baller.jpg'))
background=pygame.image.load('path.png')

target = pygame.image.load('Player.png')
targetpos =target.get_rect()

screen.blit(target,targetpos)
screen.blit(background,(0,0))
pygame.display.update()

while True:
  screen.blit(background,(0,0))
  screen.blit(target,targetpos)

running = True
while running:
  for event in pygame.event.get():
    if event.type == pygame.QUIT:
      running = False

      if__name__==('__main__')
  game() 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-13T21:37:05.103

你错过了`__init__`定义！

虽然您的代码确实运行，但它不是您想要的。类的定义中有一个无限循环，这意味着，无论您如何运行它，都缺少一些东西。您应该将此代码（至少大部分代码）放在`__init__`函数中，然后创建该类的实例。

这就是我假设你想要的：

```
import pygame, sys

class game():
    width, height = 600,400

    def __init__(self):

        ball_filename = "Ball.png"
        path_filename = "path.png"

        self.screen = pygame.display.set_mode((self.width, self.height))
        pygame.display.set_caption('Star catcher')
        self.background = pygame.image.load(path_filename)
        self.screen.blit(self.background,(0,0))

        self.target = pygame.image.load(ball_filename)

    def run(self):
        while True:
            self.screen.blit(self.background, (0,0))
            targetpos = self.target.get_rect()

            for event in pygame.event.get():
                if event.type == pygame.QUIT:
                    pygame.quit()

if __name__ == "__main__":
    # To run this
    pygame.init()

    g = game()

    g.run() 
```

**更新**：

我做了比你**必须**做的更多的修改，但它们可能很有用。我没有测试这个，但它应该没问题。

未定义宽度和高度的错误是因为它们不是局部/全局变量，而是绑定到类和/或类的实例，因此在它们的命名空间中。因此，您需要通过`game.width`（每个类）或`self.width`（每个实例，**仅在类中定义的方法内**）或`g.width`（每个实例，**如果您在类定义之外**并且 g 是游戏类的实例）访问这些。

我希望我很清楚。:)

# core-plot - 核心图 CPTAxisLabel - 高度

> ID：11023368
> 
> 赞同：1
> 
> 时间：2012-06-13T21:12:04.157
> 
> 标签：core-plot, cptbarplot

我正在使用核心图来绘制条形图。我正在为 X 轴标签使用自定义标签 (CPTAxisLabel)。我的一些标签很长。在这种情况下，标签不会被包裹到下一行。

我如何在 CPTAxisLabel 中实现它？

-巴拉吉·R。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-13T22:51:25.547

您可以在 Core Plot 的任何文本中插入换行符 ( `'\n'`) 以强制它换行到下一行。使用`textAlignment`文本样式的属性来控制文本行的对齐方式（左、中、右）。

# ios - 为代码签名身份选择哪些配置文件、为分发签名和代码签名权利选择哪些配置文件

> ID：11023371
> 
> 赞同：4
> 
> 时间：2012-06-13T21:12:22.270
> 
> 标签：ios, xcode

我已经阅读了 Apple 文档，以及关于 SO 主题的许多帖子以及各种教程，但我不得不承认我并没有 100% 了解何时以及如何使用哪些配置文件，并且通常会反复试验直到我找到了一个有效的组合。

然而，目前我的情况是，通过 iTunes 安装的临时应用程序现在不再在我的手机或测试人员的手机上运行，​​尽管它将使用 XCode 安装。手机上的错误信息是“ZZZ安装失败。”。

我在 XCode 中安装了以下配置文件：1）临时分发配置文件 2）团队配置配置文件 3）开发配置文件 4）Apple Push Profile

一些问题：

1) 我应该在目标构建设置的代码签名身份部分使用哪个配置文件，为什么？

2) 分发 Ad-Hoc 部署时应该使用哪个配置文件？

我会假设 2) 它应该是 Ad-hoc 分发配置文件？如果不是什么/什么时候应该使用该配置文件？

如果在步骤 2) 中使用了 Ad-Hoc 分发配置文件，那么我想我必须在步骤 1) 中使用 Apple Push Profile？否则我怎样才能收到 APN？

那我什么时候应该使用其他配置文件？

一些后续问题：3）在什么情况下，您会或应该在项目中为目标设置不同的代码签名身份？

4) 默认情况下，代码签名标识中有 5 个部分（代码签名标识、调试、调试任何 iOS SDK、发布、发布任何 iOS SDK）。一般来说，这些都应该相同吗？在什么情况下它们会或应该不同？

5) Code Signing Entitlements 部分的用途是什么？

我从事 iOS 开发工作已经有一段时间了，并且认为自己在许多领域都处于领先地位，但这只是我的头脑。

非常感谢，如果有人可以揭开这个神秘面纱。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-13T21:24:44.777

**1）**开发配置文件，必须在APNS配置文件**之后生成。**您不使用 APNS 证书签署捆绑包，它是用于服务器的。但是在您的开发和临时配置文件中将包含有关推送通知的信息，因此您需要在配置门户中的 APNS 设置更改后重新创建开发和临时配置文件。为了正确使用 APNS，您应该阅读其他材料，例如[该](http://arashnorouzi.wordpress.com/2011/03/31/sending-apple-push-notifications-in-asp-net-part-1/)材料或任何其他材料。如果应用没有 APNS，您也可以使用带有您的开发人员名称的团队配置文件进行调试。

**2)**是的，临时的。

**3)**如果项目中有多个目标

**4）**我使用开发配置文件作为“调试”（在“调试任何 iOS SDK”中相同）和临时配置文件作为“发布”（在“发布任何 iOS SDK”中相同）。

欢迎来到疯狂的应用签名世界！

# c# - 如何获取在解决方案/项目中创建的所有会话变量的列表

> ID：11023372
> 
> 赞同：1
> 
> 时间：2012-06-13T21:12:23.910
> 
> 标签：c#, asp.net

我正在处理现有的 ASP.NET / C# 项目。如何在不以调试模式运行项目的情况下，在项目后面/行代码/类文件中的不同代码中找到项目中创建的所有会话变量。我正在使用vs 2008。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-13T21:14:54.220

`Session.Add`在解决方案中对和进行全局搜索`Session["`。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-13T21:19:18.757

您可以使用正则表达式进行全局搜索

这样的事情可能会奏效

```
(?:Session\[.+\]\s*=|Session.Add) 
```

第一部分涵盖由分配创建的会话变量：`Session["MyVarName"] = myValue`

`Add`第二部分介绍使用方法创建的会话变量：`Session.Add("MyVarName", myValue)`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-13T21:19:36.870

使用正则表达式在您的解决方案中进行搜索：`Session\[.*=`这将找到您可能正在设置会话变量的情况，如下所示 `Session['foo'] = "bar"`：Visual Studio 允许您使用其搜索窗口执行此操作：`CTRL`- `SHIFT`- `F` （查找项目中的所有匹配项）

此外，您可以检查`Session.Add`.

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-13T21:30:47.817

按`ctrl`+`f`并输入：

> 会议[

并从下拉菜单中选择在项目中搜索

# sql - SQL (Oracle)：如何改进按 x desc 排序的选择

> ID：11023373
> 
> 赞同：1
> 
> 时间：2012-06-13T21:12:28.090
> 
> 标签：sql, performance, oracle

我在数据库中有一个巨大的日志表。log_id 和 log_date 上有一个索引。

当我以相反的顺序查询日志时，需要“永远”才能完成。虽然我没有顺序地进行相同的查询，但答案是立竿见影的。

如何调整表/改进查询以进行快速（呃）反向选择？

编辑：查询（对不起，查询在我脑海中很明显（在弗洛林也是如此！）：

```
select * from logs ordered by log_date desc 
```

一些指标：

表中有大约 4000 万行

```
select * from logs where log_id < 500 
```

--> 在 0.032 秒内获取

```
select * from logs where log_id < 500 order by log_time desc; 
```

--> 大约 20 秒内获取

$max 是最大 log_id 并且已在另一个查询中检索到

```
select * from logs where log_id > ($max - 500); 
```

--> 大约 16 秒内获取

```
select * from logs where log_id > ($max - 500) order by log_time desc; 
```

--> 大约 16 秒内获取

我的问题是如何改进所有需要太多秒执行的查询。

@Florin
使用“where”子句缩短了登录时间`(where log_time >= truncate(sysdate))`，我的性能很好，但我需要能够选择很长一段时间内的日志或过去很长一段时间内的日志。在这种情况下，查询仍然很慢（比如 20 秒）。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-14T05:43:21.147

```
select * from log_table 
where log_date >= trunc(sysdate)  --current_day
order by log_id desc, log_date desc 
```

这将在 log_date 索引中进行范围扫描，并将从 log_table 中检索一天的行，而不是整个表。在此之后，排序会更快，因为要排序的行数很少。

**更新：** 您可以做的另一件事：

*   制作 log_date 列`NOT NULL`（这可能会更改优化器以使用索引）；
*   使用`/*+parallel(logs 8)*/`提示（如果您不经常执行此查询并且只需要在您的数据库工具中快速获得结果。如果您有很多处理器:)）
*   您可以按月或更详细的方式对表进行分区。

# java - 如何对以对象为参数的方法进行单元测试

> ID：11023374
> 
> 赞同：1
> 
> 时间：2012-06-13T21:12:34.030
> 
> 标签：java, unit-testing, junit

我正在重构一些代码并想对一些方法进行junit测试，但它们使用的是由底层框架创建的对象。如果我自己无法重新创建这些对象，这是否意味着我无法对将框架生成的对象作为参数的方法编写单元测试？

因此，例如 jetspeed Page 对象

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-13T21:22:57.053

你考虑过使用[Mockito](http://code.google.com/p/mockito/)吗？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-14T09:28:31.193

有时，在包装类中包装您无法控制的对象是个好主意。注入包装器的接口。您可以创建一个 PageWrapper:IPageWrapper 类来封装您需要的功能。

# api - 应用getForm时偶尔会出现“尝试应用非功能”错误

> ID：11023377
> 
> 赞同：4
> 
> 时间：2012-06-13T21:12:46.157
> 
> 标签：api, r

我正在使用 getForm 重复从 api 中提取数据。有时程序完成，有时经过一些迭代后，我收到以下错误消息：

```
Error in curlPerform(url = url, curl = curl, .opts = .opts) : 
attempt to apply non-function
In addition: There were more than 50 warnings (use warnings() to see the first 50)
> traceback()
5: .Call("R_curl_easy_perform", curl, .opts, isProtected, .encoding, 
   PACKAGE = "RCurl")
4: curlPerform(url = url, curl = curl, .opts = .opts)
3: getURLContent(uri, .opts = .opts, .encoding = .encoding, binary = binary, 
   curl = curl)
2: getForm("https://xx", .params = parval)
1: fromJSON(getForm("https://xx", 
   .params = parval)) at #32 
```

警告是：

```
In RCurlIconv(str, from = "C99", to = encoding) :
UTF-8 not supported iconv entries 
```

谢谢你的帮助！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-27T14:13:21.470

这只是一个下载错误，有时下载失败。在这种情况下，我只是提供了再次尝试下载的条款。

# c# - c# 如何打开二进制文件并将其存储在 16 位缓冲区中

> ID：11023378
> 
> 赞同：1
> 
> 时间：2012-06-13T21:12:54.330
> 
> 标签：c#, binary, buffer

我正在编写一个程序来进行一些图像处理。我正在处理原始二进制文件，我需要将原始文件中的数据写入 16 位缓冲区。我几乎得到了它，但我不太确定如何进行转换。到目前为止，这是我的代码：

```
 Int16[] pixelBuffer;
        String inFile;
        String outFile;        

        /// Constructor. Allocates space for 3032x2016 16-bit values.
        /// <param name="inputFile">Name of the binary input file to be read.</param>
        /// <param name="outputFile">Name of the binary output file to be written.</param>
        public ColorCorrector(String inputFile, String outputFile)
        {
        this.inFile = inputFile;
        this.outFile = outputFile;
        this.pixelBuffer = new Int16[6112512];
        //I need to open the binary file 'inputFile' and store 16-bit values in pixelBuffer.

    } 
```

任何帮助，将不胜感激！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-13T21:22:21.407

```
using (var inputStream = File.Open(inputFile))      
using (var reader = new BinaryReader(inputStream))      
{           
    int index = 0;
    while (inputStream.Position < inputStream.Length)
        pixelBuffer[index++] = reader.ReadInt16();      
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-13T21:22:43.347

如果您想获得**最佳性能**，我建议您`byte[]`使用 FileStream 类读入一个固定大小的缓冲区（可能为 64KB）。

您可以使用不安全代码将每个缓冲区复制到您的`Int16[]`. 复制只需要几行代码，而且速度很快，因为不需要换班和演员等。这只是一个紧密的复制循环。

我估计 BinaryReader 慢了 10 倍左右。现代 CPU 喜欢没有分支的紧密循环，而 BinaryReader 无法提供。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-13T21:25:44.357

如果您需要全部在内存中，您不妨使用原始`byte[]`缓冲区。你可以*假装*那实际上是`short`/ `ushort`via `unsafe`：

```
 byte[] raw = File.ReadAllBytes(inputPath);
 unsafe
 {
     fixed(byte* ptr = raw)
     {
         ushort* pixels = (ushort*)ptr;
         pixels[0] = 0; // <=== your changes, etc
     }
 }
 File.WriteAllBytes(outputPath, raw); 
```

注意：您可能需要检查文件的*字节顺序*。我已经`ushort`在上面进行了介绍，因为`ushort`对于使用 MSB 集的值使用“移位”操作的人来说，不会有那么大的惊喜。如果它实际上并不代表一个*数字*（而只是：数据），通常更容易将其视为无符号数。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-13T21:16:10.723

你应该看看[`System.IO.BinaryReader`](http://msdn.microsoft.com/en-us/library/system.io.binaryreader.aspx "System.IO.BinaryReader")，[`System.Drawing.Bitmap`](http://msdn.microsoft.com/en-us/library/system.drawing.bitmap.aspx "System.Drawing.Bitmap")那些可能是你正在寻找的。

您可以`BinaryReader`从 a 中创建 a`FileStream`并使用该`ReadInt16()`方法从流中读取 16 位整数。

# android - 我应该将单人和多人游戏模式分成不同的 Android 活动吗？

> ID：11023381
> 
> 赞同：4
> 
> 时间：2012-06-13T21:13:08.650
> 
> 标签：android, android-activity

我一直在开发一个回合制游戏，它有单人游戏和（本地）多人游戏选项。两者之间的游戏玩法在很大程度上相似，除了 CPU 控制单人游戏中的一个回合这一事实。

为这两个选项创建一个单独的 Android 活动或创建一个通过布尔值等处理两者的活动是否明智？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-13T22:35:18.410

你应该做的是有一个包含两个活动基础的库或帮助类，然后有两个不同的活动（一个用于单人游戏，一个用于多人游戏）这样你就不需要复制代码并且它只存在一次. 如果出现问题，也更容易修复。

对于调试，您应该为每个活动设置不同的日志标签，并在所有需要它的东西周围放置尝试的东西，并使用它们的日志标签记录错误。

根据 oracle 的说法，你应该将你的 java 文件保持在 2000 行代码以下，所以如果超过了，肯定会把它们分开。

# java - 是否可以手动设置我的应用程序的语言（而不是让用户通过设置？）

> ID：11023382
> 
> 赞同：3
> 
> 时间：2012-06-13T21:13:09.850
> 
> 标签：java, android, mysql, sqlite, android-resources

> **可能重复：**
> [以编程方式设置区域设置](https://stackoverflow.com/questions/4985805/set-locale-programatically)

我想在我的应用程序的初始屏幕上创建一个英语/西班牙语选项选项，并且想知道我是否可以利用 Android 出色的语言分支，而无需通过设置发送用户来更改整个设备的语言设置。

如果不可能的话，我了解如何自己将其组合在一起，并且只需手动设置我的所有值，但希望我忽略了某种方式让 Android 将其语言系统用于我的应用程序，即使系统的其余部分仍然存在在任何预设的情况下。

TIA

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-13T21:18:46.493

是的，可以通过您的 Android 应用程序设置语言，以便更改仅在您的应用程序中可见：

```
Locale locale = new Locale("us");
Locale.setDefault(locale);
android.content.res.Configuration config = new android.content.res.Configuration();
config.locale = locale;
context.getResources().updateConfiguration(config, this.getResources().getDisplayMetrics()); 
```

我想这会对你有所帮助。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-13T21:25:40.797

```
Resources res = getApplicationContext().getResources();

Locale locale = new Locale("us");
Locale.setDefault(locale);

Configuration config = new Configuration();
config.locale = locale;

res.updateConfiguration(config, res.getDisplayMetrics()); 
```

# c++ - 使用模板元编程将模板函数布尔参数转换为运行时函数参数

> ID：11023384
> 
> 赞同：6
> 
> 时间：2012-06-13T21:13:14.250
> 
> 标签：c++, templates, c++11, metaprogramming, template-meta-programming

我有一个函数，它需要几个布尔模板参数：

```
template<bool par1, bool par2, bool par2>
void function(int arg1, int arg2, int arg3); 
```

我想在编译时（使用任何模板魔术，如果需要，使用 C++11）自动生成一个函数指针的表（或与 C++ 元编程的有趣结构中等效的东西），指向所有值的组合模板参数`par*`，这样我就可以构造一个函数，将这些模板参数作为运行时参数并转发到正确的模板实例化：

```
void runtime_function(bool par1, bool par2, bool par3, int arg1, int arg2, int arg3); 
```

我认为，如果不是模板函数，而是想对类做同样的事情，我认为这可以做到，这要归功于模板模板参数：

```
template<template<bool> class T> class CombinationsOfTemplateParameters;
template<template<bool, bool> class T> class CombinationsOfTemplateParameters;
template<template<bool, bool, bool> class T> class CombinationsOfTemplateParameters;
//and so on, up to some implementation defined hard limit. 
```

但据我所知，没有办法指向通用模板函数，而未指定其模板参数。因此，我首先不知道如何将它传递给其模板参数列表中的某个辅助类。

有没有办法解决这个问题？

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2012-06-13T21:49:04.137

第一步，为了理解问题，我会为每个实例构造一个函数指针数组：

```
template<bool, bool, bool> void function(int, int, int);

typedef void (*func_type)(int, int, int);

func_type funcs[] = {
    &function<false, false, false>,
    &function<false, false, true>,
    &function<false, true,  false>,
    &function<false, true,  true >,
    &function<true,  false, false>,
    &function<true,  false, true >,
    &function<true,  true,  false>,
    &function<true,  true,  true >
}; 
```

注意它看起来像一个 3 位二进制数表：

```
0 0 0  == 0
0 0 1  == 1
0 1 0  == 2
0 1 1  == 3
// etc... 
```

因此，您可以使用按位运算形成的整数对数组进行索引：

```
void runtime_function(bool par1, bool par2, bool par3, int arg1, int arg2, int arg3)
{
  func_type f = funcs[ int(par1)<<2 | int(par2)<<1 | int(par3) ];
  f(arg1, arg2, arg3);
}; 
```

第二步，既然我已经了解了如何构造和使用数组，我将使用可变参数模板自动生成数组，而不是手动写出来。

首先使用创建整数参数包的类型（使用[Johannes Schaub](https://stackoverflow.com/users/34509/johannes-schaub-litb)的`seq`模板）：

```
template<int ...>
struct seq { };

template<int N, int ...S>
struct gens : gens<N-1, N-1, S...> { };

template<int ...S>
struct gens<0, S...> {
  typedef seq<S...> type;
}; 
```

然后在包扩展中使用它来生成每个可能的实例化：

```
template<bool, bool, bool> void function(int, int, int);

typedef void (*func_type)(int, int, int);

template<typename> struct make_table;

template<int... N>
  struct make_table<seq<N...>>
  {
    static const func_type funcs[sizeof...(N)];
  };

template<int... N>
  const func_type make_table<seq<N...>>::funcs[sizeof...(N)] = {
    &function< bool(N&4), bool(N&2), bool(N&1) >...
  }; 
```

现在你可以像这样使用它：

```
void runtime_function(bool par1, bool par2, bool par3, int arg1, int arg2, int arg3)
{
  typedef gens<8>::type seq8;

  func_type f = make_table<seq8>::funcs[ (par1<<2) | (par2<<1) | par3 ];

  f(arg1, arg2, arg3);

} 
```

幻数`8`是二的三的幂（布尔参数的数量。）

第三步，测试。我相当有信心，如果我弄错了核心逻辑，它甚至都不会编译，因为编译器将检查所有类型和包扩展，但我可能把按位运算弄错了。

```
#include <iostream>

template<bool b1, bool b2, bool b3>
  void function(int i1, int i2, int i3){
    std::cout << std::boolalpha << "f<"
      << b1 << ", " << b2 << ", " << b2
      << ">("
      << i1 << ", " << i2 << ", " << i3
      << ")\n";
}

int main()
{
  runtime_function(false, true, true, 1, 2, 3);
  runtime_function(true, false, false, 4, 5, 6);
} 
```

它打印：

```
f<false, true, true>(1, 2, 3)
f<true, false, false>(4, 5, 6) 
```

* * *

### 完全通用的版本

要为具有四个布尔模板参数的函数模板执行此操作，您需要使用`gens<16>`并更改包扩展

```
template<int... N>
  const func_type make_table<seq<N...>>::funcs[] = {
    &function< bool(N&8), bool(N&4), bool(N&2), bool(N&1) >...
  }; 
```

这不是很方便，因此应该可以通过引入另一个整数参数包`seq<3,2,1,0>`并像这样使用它来泛化它以处理任意数量的参数：

```
template<int... N, int... Bits>
  const func_type make_table<seq<N...>, seq<Bits...>>::funcs[] = {
    &function< /* some bitwise op using N & (1<<Bits) ... */ > ...
  }; 
```

但这不起作用，因为我们想要一个包扩展，`Bits`但我们不希望它同时扩展`N`（并且包有不同的大小，所以无论如何它都不会工作，）所以我们需要使用一个级别间接允许包单独扩展。

下面的最终版本使用一个函数`gen_func<N>`来获取索引 N 处的函数指针：

```
template<unsigned N, int... Mask>
  static constexpr func_type gen_func(seq<Mask...>)
  { return &function<(N&(1<<Mask))...>; } 
```

并添加`genrevs`以创建整数的反向序列`seq<2,1,0>`，将其传递给该函数以用作`Mask`参数包：

```
gen_func<I>(typename genrevs<NParams>::type()) ... 
```

通过这种更改，`make_table`类模板可以处理具有任何数量的函数，因此最后一步是通过函数类型对其进行参数化（并让它推断出参数的数量，并从中推断出可能的函数特化的数量）并添加一个访问器获得`make_table`正确的功能：

```
void runtime_function(bool par1, bool par2, bool par3, int arg1, int arg2, int arg3)
{
  auto f = make_table<void(int, int, int)>::get(par1, par2, par3);

  f(arg1, arg2, arg3);
} 
```

这是完整的最终版本。昨晚写完这段代码后，我意识到它假设函数参数`(int, int, int)`的数量与模板参数的数量相同`<bool, bool, bool>`，如果不是这样，那么你需要添加一个额外的非类型模板参数`make_table`，指定数量模板参数（在下面的代码中`NParams`推导出来）：

```
#include <type_traits>

template<int ...>
struct seq { };

template<int N, int ...S>
struct gens : gens<N-1, N-1, S...> { };

template<int ...S>
struct gens<0, S...> {
  typedef seq<S...> type;
};

template<int N, int ...S>
struct genrevs : genrevs<N-1, S..., N-1> { };

template<int ...S>
struct genrevs<0, S...> {
  typedef seq<S...> type;
};

template<bool, bool, bool> void function(int, int, int);

template<unsigned N>
  struct pow2
  {
    static constexpr unsigned value = 2*pow2<N-1>::value;
  };

template<> struct pow2<0> { static constexpr unsigned value = 1; };

template<typename Signature> struct make_table_seq;

template<typename Res, typename... Params>
  struct make_table_seq<Res(Params...)>
  : gens<pow2<sizeof...(Params)>::value>
  { };

template<typename Signature, typename = typename make_table_seq<Signature>::type>
struct make_table;

template<typename Res, typename... Params, int... I>
  class make_table<Res(Params...), seq<I...>>
  {
    static const unsigned NParams = sizeof...(Params);

  public:
    typedef Res (*func_type)(Params...);

    template<typename... Bool>
      static typename std::enable_if<sizeof...(Bool)==NParams, func_type>::type
      get(Bool... b)
      { return funcs[ shift_or(0, b...) ]; }

  private:
    template<unsigned N, int... Mask>
      static constexpr func_type gen_func(seq<Mask...>)
      { return &function<(bool(N&(1<<Mask)))...>; }

    template<typename... Bool>
      static int shift_or(int i, bool b0, Bool... b)
      {
        return shift_or((i<<1) | int(b0), b...);
      }

    static int shift_or(int i) { return i; }

    static const func_type funcs[sizeof...(I)];
  };

template<typename Res, typename... Params, int... I>
  const typename make_table<Res(Params...), seq<I...>>::func_type
  make_table<Res(Params...), seq<I...>>::funcs[] = {
    gen_func<I>(typename genrevs<NParams>::type()) ...
  };

// specialise for function pointer types as well as function types
template<typename Res, typename... Params>
  struct make_table_seq<Res(*)(Params...)>
  : make_table_seq<Res(Params...)>
  { };

template<typename Res, typename... Params, typename T>
  class make_table<Res(*)(Params...), T>
  : make_table<Res(Params...)>
  { }; 
```

# java - 绘制占绘图面板百分比的矩形

> ID：11023385
> 
> 赞同：3
> 
> 时间：2012-06-13T21:13:14.593
> 
> 标签：java, swing, awt, jpanel, java-2d

我想绘制仅指定百分比高的矩形即时绘制它，当我调整面板大小时，它应该调整自身大小。但我的问题是 drawRect() 只接受整数，所以当我尝试绘制矩形时，例如面板高度的 45%，如果面板高度小于 100，它会转换为 0。

我的代码很简单，你可以试试。这是我的代码：

```
public class Drawer extends JPanel {

    @Override
    public void paintComponent(Graphics g) {
        super.paintComponent(g);
            g.fillRect(10,this.getHeight()-this.getHeight()/100*45, 100, this.getHeight()-this.getHeight()/100*45);
    }
} 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-13T21:14:59.447

尝试这个：

```
this.getHeight()-(45*this.getHeight())/100 
```

# redirect - 如何为大量帖子设置重定向

> ID：11023389
> 
> 赞同：0
> 
> 时间：2012-06-13T21:13:36.200
> 
> 标签：redirect, migration, subdomain

我正在为 alpinezone.com 进行主要站点迁移。作为迁移的一部分，我将所有新闻文章从 vbulletin 移至 wordpress cms。vbulletin 文章之前是通过一个名为 GARS 的插件提取的。

无论如何，在五年左右的时间里，我有 3400 篇新闻文章。它们目前采用以下格式：

news.alpinezone.com/12345

如果新闻文章的标题是“Sugarloaf Sets World Record”，那么新位置将是

alpinezone.com/sugarloaf-sets-world-record/

有没有办法让我自动创建必要的重定向，从文字页面 12345 获取标题并转换为 URL？

最后; 额外的技巧是，由于我做了一个 VB 升级，现有的新闻文章不再出现。因此，现在访问 news.alpinezone.com/12345 不会显示任何内容，您需要通过获取该标识符并访问[http://forums.alpinezone.com/showthread来拉出论坛主题（通常是隐藏的） .php?12345](http://forums.alpinezone.com/showthread.php?12345)查看实际标题。我可以从 WP 数据库中提取所有这些内容（因为所有帖子都来自用户 AlpineZone News）。

有任何想法吗？我对此很陌生，子域的附加复杂性是我试图弄清楚的事情。谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-13T21:25:32.860

您可以在之前所在的正确位置创建自己的 showthread.php 文件。

让它使用传递的 id，从您的数据库中检索关联的记录。

通过将标题转换为[小写](http://www.php.net/manual/en/function.strtolower.php)并将空格[更改](http://www.php.net/manual/en/function.str-replace.php)为 - 并通过[标头](http://php.net/manual/en/function.header.php)进行重定向来构造新的 url ('Location: *new url here* ');

# php - PHP Simple DOM find 不起作用

> ID：11023391
> 
> 赞同：0
> 
> 时间：2012-06-13T21:13:46.497
> 
> 标签：php, dom, simple-html-dom

为什么 PHP Simple HTML DOM 的这段代码没有按预期工作？它应该找到`<b>`HTML 文档中的所有标签并将其文本更改为“粗体文本”。它什么也没做。

```
$contentEdited2 = new simple_html_dom();
$contentEdited2->load($html);

$bolds = $contentEdited2->find('b');

foreach($bolds as $b)
    $b->innertext = "bold text"; 
```

在过去的一个小时里，我一直试图弄清楚这一点。任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-13T21:17:08.570

您没有更改原始`$html`变量，而只是更改了仅存在于循环中的本地副本。

您可以将循环更改为：

```
foreach($bolds as &$b)    // assign value by reference
    $b->innertext = "bold text"; 
```

或者：

```
foreach($contentEdited2->find('b') as &$b)
    $b->innertext = "bold text"; 
```

# javascript - 如何在页面刷新时保留视图数据

> ID：11023394
> 
> 赞同：1
> 
> 时间：2012-06-13T21:14:01.443
> 
> 标签：javascript, jquery, backbone.js, mustache, handlebars.js

我正在尝试在我的 MVC 应用程序中使用主干架构。我使用 HandleBars/Mustache 创建了模板，并且我的模型包含我在 UI 上的表中显示的信息（在 div 内）。

我想每 5 分钟刷新一次页面以刷新表中的数据。我可以使用 `<meta http-equiv="refresh" content="some value" />`，

但它不会保存表中的视图数据。在这种情况下如何刷新页面？

编辑：基本上，在页面上我有一个搜索框，搜索项被加载到一个表上。如果我使用元标记刷新页面，则重新加载页面并且表中的数据消失。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-13T21:51:17.907

> 我想每 5 分钟刷新一次页面以刷新表中的数据。

不完全的。您希望每五分钟重新加载一次数据，以便您可以刷新页面中的表格。

您应该[`setTimeout`](https://developer.mozilla.org/en/DOM/window.setTimeout)在某个地方使用，甚至可能在您的视图中`initialize`：

```
start_reloader: function() {
    var _this = this;
    this.timer = setTimeout(function() {
        $.ajax({
            // Load the data from your server...
            success: function(data) {
                _this.redraw_the_table(data);
                _this.start_reloader();
            }
        });
    }, 5*60*1000);
},

initialize: function() {
    this.start_reloader();
} 
```

然后你会想要你的东西`remove`来杀死计时器：

```
remove: function() {
    if(this.timer)
        clearTimeout(this.timer);
    return Backbone.View.prototype.remove.apply(this);
} 
```

您也可以使用[`setInterval`](https://developer.mozilla.org/en/window.setInterval)，[`clearInterval`](https://developer.mozilla.org/en/DOM/window.clearInterval)但是如果 AJAX 调用有延迟，它们有可能会相互堆积。

当然，您不必在视图中管理它。在您的情况下，设置一个模型或集合以每五分钟从服务器重新加载一次可能更有意义；然后，您的视图将像往常一样绑定到模型或集合的事件，并重新绘制表格以响应模型/集合中的`'reset'`, `'change'`, ... 事件。

# hadoop - 使用 Hadoop 的 MapReduce：映射中的键类型不匹配

> ID：11023399
> 
> 赞同：1
> 
> 时间：2012-06-13T21:14:17.410
> 
> 标签：hadoop, mapreduce

我正在运行一个简单的 wordcount 程序，但出现以下错误：

```
Type mismatch in key from map: expected org.apache.hadoop.io.Text, received org.apache.hadoop.io.LongWritable 
```

这是什么意思，我该如何纠正它？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-13T21:17:49.637

您可以在 main 函数中使用以下任一行：

```
 conf.setMapOutputKeyClass(Text.class);
 conf.setMapOutputValueClass(IntWritable.class); 
```

假设您使用的是 JobConf conf；

或者

```
 job.setMapOutputKeyClass(Text.class);
    job.setMapOutputValueClass(IntWritable.class); 
```

假设您正在使用 Job job = new Job();

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-13T21:18:06.057

您正在提供一个序列文件的输入，该文件`LongWritable`的键为 ，而预期的序列文件的键应为`Text`.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-13T21:53:12.607

如果您在输入格式类时使用 TextInputFormat，则可能会发生这种情况。它会生成 LongWritable 类型的键和 Text 类型的值。但您的应用程序可能需要 Text 类型的键。这就是为什么当您按照 shailesh 的指示显式设置 MapOutputKeyClass 时使用“job.setMapOutputKeyClass(Text.class)”它适合你。

# php - ezpdf while循环 - 生成pdf失败

> ID：11023400
> 
> 赞同：0
> 
> 时间：2012-06-13T21:14:17.777
> 
> 标签：php, pdf

我有下面这样的代码，我想要实现的是生成具有动态创建行的 PDF 文档。用户可以从他们填写的表格中生成 PDF。如果他们想在其中一个字段中添加更多文本，则应该将其拆分为行。

想法是这样的：分解文本，并在检查每个单词的大小是否小于 70 后添加空格（需要连续的字符）。不幸的是，WHILE 循环有问题，导致我的脚本不生成任何 PDF 文件。任何人都可以帮忙吗？我看不出我在这里做错了什么。

```
 //length of line is 70 chars
    $n = strlen($datan['reason']) / 70;

    //if there are some chars left add last line
    if(strlen($datan['reason'])%70 > 0)
    {
        $n++;
    }   
    $pieces = explode(" ",$datan['reason']);
    $piece_number = 0;

    //create n lines 
    for($i=0;$i<$n;$i++){
        $previous = "";
        $l = true;
        //add pieces not to exceed 70 chars
        while($l == true){
            $current = $pieces[$piece_number];
            if(strlen($current) + strlen($previous) < 70){
                $previous .= $current . " ";
                $piece_number++;
            }
            else
                $l = false;
        }
        //print line
        $pdf->addText(215,535+(20*$i),10,$previous);
    } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-13T22:00:13.433

好的，正如我预期的那样，问题出现了，它无法结束，因为它用完了 $pieces 数组，我忘了控制它。

# c# - 如何在运行时以常量注入 IL？

> ID：11023401
> 
> 赞同：0
> 
> 时间：2012-06-13T21:14:37.427
> 
> 标签：c#, dynamic, .net-4.0

我知道如何通过注入 IL 来创建动态方法，比如 a * 2;

但是我想像 a * b 一样，其中 b 是常数。

考虑一下。

```
int b = SomeClassInstance.Multiplier;

Func<int,int> MultA = CreateDynMethod(b);

for(int i = 0; i < 1000; i++)
{
    int a = GetValueSomewhere();
    int result = MultA(a);
    Console.WriteLine(result);
} 
```

请参阅.. b 对于所有 1000 次迭代都是相同的。但是我不知道它会是什么。0 1 2 或其他。

我的问题是如何将 b 值作为常量嵌入到 IL 中。

这是非常重要的区别——我**不想**计算 var a * var b。**我想（例如，如果 b == 2 在运行时）创建执行 * 2 的 IL。**

我有理由这样做。如果您按照所写的方式回答问题。谢谢你。

**编辑。这是我在你的帮助下可以写的。请说说你的看法**

```
 static Func<int, int> IL_EmbedConst(int b)
    {
        var method = new DynamicMethod("EmbedConst", typeof(int), new[] { typeof(int) } );

        var il = method.GetILGenerator();

        il.Emit(OpCodes.Ldarg_0);
        il.Emit(OpCodes.Ldc_I4, b);
        il.Emit(OpCodes.Mul);
        il.Emit(OpCodes.Ret);

        return (Func<int, int>)method.CreateDelegate(typeof(Func<int, int>));
    } 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-13T21:24:31.220

你想要[`ldc.i4`](http://msdn.microsoft.com/en-us/library/system.reflection.emit.opcodes.ldc_i4.aspx)操作码。

这会将一个 int 加载到堆栈上，然后可以跟一个`mul`.

你可以像这样使用它：

```
ilGen.Emit(OpCodes.Ldc_I4, b); 
```

顺便说一句，您实际上并不需要在这里从 IL 构建方法。这种方法也可以：

```
Func<int, int> CreateDynMethod(int b)
{
    return a => a * b;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-13T21:24:51.843

你可能想发出类似的东西

```
 ldarg.1
 ldc.i4 2
 mul
 ret 
```

您可以使用发出第二行

```
 il.Emit(OpCodes.Ldc_I4, 2); 
```

或者，为了清楚起见：

```
 int b = 2;
 il.Emit(OpCodes.Ldc_I4, b); 
```

请参阅[http://msdn.microsoft.com/en-us/library/h3c68sh6](http://msdn.microsoft.com/en-us/library/h3c68sh6) 和[http://msdn.microsoft.com/en-us/library/system.reflection.emit.opcodes.ldc_i4](http://msdn.microsoft.com/en-us/library/system.reflection.emit.opcodes.ldc_i4)

# python - 如何将 csv 数据文件导入 scikit-learn？

> ID：11023411
> 
> 赞同：40
> 
> 时间：2012-06-13T21:15:30.600
> 
> 标签：python, scikit-learn

据我了解，scikit-learn 接受 (n-sample, n-feature) 格式的数据，这是一个 2D 数组。假设我有表格中的数据......

```
Stock prices    indicator1    indicator2
2.0             123           1252
1.0             ..            ..
..              .             . 
. 
```

我如何导入这个？

* * *

## 回答 #1

> 赞同：66
> 
> 时间：2015-06-12T22:42:28.907

[numpy loadtxt](http://docs.scipy.org/doc/numpy/reference/generated/numpy.loadtxt.html)的一个很好的替代方法是[Pandas](http://pandas.pydata.org/pandas-docs/stable/generated/pandas.read_csv.html)的 read_csv 。数据被加载到 Pandas 数据帧中的一大优势是它可以处理混合数据类型，例如某些列包含文本，而其他列包含数字。然后，您可以轻松地仅选择数字列并使用[as_matrix](http://pandas.pydata.org/pandas-docs/stable/generated/pandas.DataFrame.as_matrix.html)转换为 numpy 数组。Pandas 还将[读/写 excel 文件和许多其他格式](http://pandas.pydata.org/pandas-docs/stable/io.html)。

如果我们有一个名为“mydata.csv”的 csv 文件：

```
point_latitude,point_longitude,line,construction,point_granularity
30.102261, -81.711777, Residential, Masonry, 1
30.063936, -81.707664, Residential, Masonry, 3
30.089579, -81.700455, Residential, Wood   , 1
30.063236, -81.707703, Residential, Wood   , 3
30.060614, -81.702675, Residential, Wood   , 1 
```

这将读取 csv 并将数字列转换为 scikit_learn 的 numpy 数组，然后修改列的顺序并将其写入 Excel 电子表格：

```
import numpy as np
import pandas as pd

input_file = "mydata.csv"

# comma delimited is the default
df = pd.read_csv(input_file, header = 0)

# for space delimited use:
# df = pd.read_csv(input_file, header = 0, delimiter = " ")

# for tab delimited use:
# df = pd.read_csv(input_file, header = 0, delimiter = "\t")

# put the original column names in a python list
original_headers = list(df.columns.values)

# remove the non-numeric columns
df = df._get_numeric_data()

# put the numeric column names in a python list
numeric_headers = list(df.columns.values)

# create a numpy array with the numeric values for input into scikit-learn
numpy_array = df.as_matrix()

# reverse the order of the columns
numeric_headers.reverse()
reverse_df = df[numeric_headers]

# write the reverse_df to an excel spreadsheet
reverse_df.to_excel('path_to_file.xls') 
```

* * *

## 回答 #2

> 赞同：54
> 
> 时间：2012-06-14T15:04:49.227

这不是 CSV 文件；这只是一个空格分隔的文件。假设没有缺失值，您可以轻松地将其加载到调用的 Numpy 数组`data`中

```
import numpy as np

f = open("filename.txt")
f.readline()  # skip the header
data = np.loadtxt(f) 
```

如果股票价格是您想要预测的（您的`y`价值，在 scikit-learn 术语中），那么您应该`data`使用拆分

```
X = data[:, 1:]  # select columns 1 through end
y = data[:, 0]   # select column 0, the stock price 
```

或者，您可以使用[标准 Python`csv`模块](http://docs.python.org/library/csv.html)来处理这种类型的文件。

* * *

## 回答 #3

> 赞同：20
> 
> 时间：2014-07-23T05:02:10.523

[您可以在numpy](http://docs.scipy.org/doc/numpy/reference/generated/numpy.loadtxt.html)中查找 loadtxt 函数。

获取 loadtxt 方法的可选输入。

csv 的一个简单更改是

```
data =  np.loadtxt(fname = f, delimiter = ',') 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2017-11-10T10:58:26.667

# 用于`numpy`加载 csvfile

```
import numpy as np
dataset = np.loadtxt('./example.csv', delimiter=',') 
```

# jquery - 使用 jQuery 删除单选按钮

> ID：11023413
> 
> 赞同：0
> 
> 时间：2012-06-13T21:15:33.673
> 
> 标签：jquery, asp.net, html, html-select

表单上有一组或多组单选按钮。该值可以从 ^ 的值开始。一旦选择了另一个值， ^ 就不再可行，所以它的 div 需要隐藏。这是源代码和 html，以及 jsfiddle 中的链接：http: [//jsfiddle.net/RSNxS/](http://jsfiddle.net/RSNxS/)

```
$(function(){

    $('.tristateRadio').bind("change", handleTristateRadioChange);

    function handleTristateRadioChange(e) {
        var button = $this;
        var id = button.id();

        $("#"+id).filter(
            function(){ this.value == "^"}
        ).parent().hide();
    }
}); 
```

html

```
$<div class="questionItem">
    <h3>C0900A</h3>
Staff asmt mental status: recall current season <br/>
        <div class="questionCheckbox"><input class="tristateRadio" id="answers_12__Answer" name="answers[12].Answer" type="radio" value="0" /> (0) Not checked (No)</div>
        <div class="questionCheckbox"><input class="tristateRadio" id="answers_12__Answer" name="answers[12].Answer" type="radio" value="1" /> (1) Checked (Yes)</div>
        <div class="questionCheckbox"><input class="tristateRadio" id="answers_12__Answer" name="answers[12].Answer" type="radio" value="-" /> (-) Not assessed</div>
        <div class="questionCheckbox"><input checked="checked" class="tristateRadio" id="answers_12__Answer" name="answers[12].Answer" type="radio" value="^" /> (^) Blank (skip pattern)</div>
</div>

<div class="questionItem">
    <h3>C0900B</h3>
Staff asmt mental status: recall location of room <br/>
        <div class="questionCheckbox"><input class="tristateRadio" id="answers_13__Answer" name="answers[13].Answer" type="radio" value="0" /> (0) Not checked (No)</div>
        <div class="questionCheckbox"><input class="tristateRadio" id="answers_13__Answer" name="answers[13].Answer" type="radio" value="1" /> (1) Checked (Yes)</div>
        <div class="questionCheckbox"><input class="tristateRadio" id="answers_13__Answer" name="answers[13].Answer" type="radio" value="-" /> (-) Not assessed</div>
        <div class="questionCheckbox"><input checked="checked" class="tristateRadio" id="answers_13__Answer" name="answers[13].Answer" type="radio" value="^" /> (^) Blank (skip pattern)</div>
</div>

<div class="questionItem">
    <h3>C0900C</h3>
Staff asmt mental status: recall staff names/faces <br/>
        <div class="questionCheckbox"><input class="tristateRadio" id="answers_14__Answer" name="answers[14].Answer" type="radio" value="0" /> (0) Not checked (No)</div>
        <div class="questionCheckbox"><input class="tristateRadio" id="answers_14__Answer" name="answers[14].Answer" type="radio" value="1" /> (1) Checked (Yes)</div>
        <div class="questionCheckbox"><input class="tristateRadio" id="answers_14__Answer" name="answers[14].Answer" type="radio" value="-" /> (-) Not assessed</div>
        <div class="questionCheckbox"><input checked="checked" class="tristateRadio" id="answers_14__Answer" name="answers[14].Answer" type="radio" value="^" /> (^) Blank (skip pattern)</div>
</div>

<div class="questionItem">
    <h3>C0900D</h3>
Staff asmt mental status: recall in nursing home <br/>
        <div class="questionCheckbox"><input class="tristateRadio" id="answers_15__Answer" name="answers[15].Answer" type="radio" value="0" /> (0) Not checked (No)</div>
        <div class="questionCheckbox"><input class="tristateRadio" id="answers_15__Answer" name="answers[15].Answer" type="radio" value="1" /> (1) Checked (Yes)</div>
        <div class="questionCheckbox"><input class="tristateRadio" id="answers_15__Answer" name="answers[15].Answer" type="radio" value="-" /> (-) Not assessed</div>
        <div class="questionCheckbox"><input checked="checked" class="tristateRadio" id="answers_15__Answer" name="answers[15].Answer" type="radio" value="^" /> (^) Blank (skip pattern)</div>
</div>

<div class="questionItem">
    <h3>C0900Z</h3>
Staff asmt mental status: none of above recalled <br/>
        <div class="questionCheckbox"><input class="tristateRadio" id="answers_16__Answer" name="answers[16].Answer" type="radio" value="0" /> (0) Not checked (No)</div>
        <div class="questionCheckbox"><input class="tristateRadio" id="answers_16__Answer" name="answers[16].Answer" type="radio" value="1" /> (1) Checked (Yes)</div>
        <div class="questionCheckbox"><input class="tristateRadio" id="answers_16__Answer" name="answers[16].Answer" type="radio" value="-" /> (-) Not assessed</div>
        <div class="questionCheckbox"><input checked="checked" class="tristateRadio" id="answers_16__Answer" name="answers[16].Answer" type="radio" value="^" /> (^) Blank (skip pattern)</div>
</div> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-13T21:23:25.450

您的代码各种损坏：

*   没有隐式`$this`变量
*   没有`.id()`功能
*   当您可以使用 if 语句时，您不需要过滤使用 id 选择器选择的 jquery 对象
*   正如其他人指出的那样，DOM id 必须是唯一的，所以如果我在代码中留下了那个 id 选择器，它会在 2/3 的时间里选择不正确的元素。
*   当当前元素被选中时，无需在事件处理程序中重新选择当前元素`this`
*   nitpick：前缀变量是 jquery 对象，具有`$`可读性

编辑：我的代码很烂，我只留下评论

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-13T21:20:36.120

它不起作用，因为`id`页面上只能有一个。jQuery 假设了这一点，并且只会选择您的一个单选按钮，因此永远不会找到任何值为 '^' 的单选按钮。

只需将其更改为一个类，它就可以工作（或使用其他类型的标识 - 比如`name`）

```
$("."+theClass).filter(
    function(){ this.value == "^"}
).parent().hide(); 
```

你也可以选择使用 CSS 选择器：

```
$("."+theClass+"[value='^']").parent().hide(); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-13T21:29:16.660

您绝对应该修复多个 id 问题，这是无效的 HTML，可能导致不希望的和意外的行为（正如其他人已经提到的）。

但是，以下内容不使用 id 选择，并且当任何其他同级发生更改时，将隐藏组中的**最后一个** `<input>`value = ：`^`

```
$('.tristateRadio').bind('change', function() {
    $(this).parent().siblings(':last').hide();
}); 
```

问题中的原始代码不起作用，因为`$this`未定义。我认为您可能是`$(this)`为了将本机对象包装在 jQuery 中。这些类型的错误通常显示在浏览器的控制台或对话框中，并且是调试 JavaScript 时首先要查看的地方。

# javascript - 在 D3 树形图中将 SVG 文本剪辑到矩形的宽度

> ID：11023417
> 
> 赞同：8
> 
> 时间：2012-06-13T21:15:51.473
> 
> 标签：javascript, svg, d3.js, label, treemap

我想知道是否有比使用剪辑路径更简单的方法来限制文本标签的宽度。

这是我正在寻找的有关标签的示例：[treemap](http://mbostock.github.com/d3/ex/treemap.html)：

![在此处输入图像描述](../Images/81b1be3fed85f3f06f2848fdbfd92d38.png)

请注意，标签会被包含的图块的边界截断。

该特定示例是使用`<div>`标签实现的，默认情况下具有此行为。但我使用的是 SVG `<rect>`，我希望有一种比定义另一个矩形形状的单独剪辑路径更直接的方法。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-13T21:30:30.437

`<rect>`您可以将每个元素包装`<svg>`在相同宽度/高度的元素中。默认情况下，[溢出](http://www.w3.org/TR/SVG/masking.html#OverflowProperty)隐藏在内部`<svg>`元素上。

# css - CSS：在其中一个在表单中的 Div 中水平排列按钮

> ID：11023420
> 
> 赞同：0
> 
> 时间：2012-06-13T21:16:06.090
> 
> 标签：css, button, html, alignment

我有一个 JSP 页面，其中在页面底部的自己的 div 中有一行按钮。最左边的按钮属于一个表单，其结束标记与 button_bar div 的开始重叠。最右边的按钮有自己的独立形式。

当我将 JSP 保存为 HTML 页面（完整，带有 css 文件等）时，按钮水平排列，就像我喜欢的那样。但是，当内容在 JSP 中时，按钮不会水平排列。

有什么我可以做的 CSS 来解决这个问题。

**按钮 div：**

```
<div class="button_bar">

        <div class="button_bar_left_button">     
            <input value="Request More Informtion" name="buttonRequestMoreInformation" type="submit">
        </div>

</form><!-- end form 'f', main form -->    

    <div class="button_bar_left_button">     
        <input value="Start New Search" onclick="location.href='search'" name="buttonSearch" type="button">
    </div>

        <div class="button_bar_right_button">
            <form action="initialRequest" method="post">
                <input name="NextRequest" value="Add Member" type="hidden">
                <input "buttonaddmember"="" value="Add Member" type="submit">
            </form>       
        </div>

</div><!-- end div button_bar --> 
```

**我的样式表中的 CSS：**

```
/* horizontal button bar */
.button_bar
{
    margin-left:auto;
    margin-right:auto;
    margin-top: 2%;
    margin-bottom: 2%;
    padding-bottom: 2%;
    width:100%;
    height:auto;
    vertical-align:top;
}

/* put a button on the far right of the above button bar */
.button_bar_right_button
{
    float:right;
    margin-left:1%;
    vertical-align:top;
}
/* put a button on the far left of the above button bar */
.button_bar_left_button
{
    float:left;
    margin-left:1%;
    vertical-align:top;
} 
```

* * *

**回答**

* * *

MODs steveax 在下面的评论帮助我解决了这个问题。他提到一些浏览器会插入标签来平衡我正在做的一个错误。这导致我做出改变以解决问题。我想接受他的第二条评论（第一个建议答案下的第一条评论）作为答案。

我将表单结束标记移到按钮的 div 下方。我还将“添加成员”表单移到了所有这些之外，并将“添加成员”按钮更改为一个普通的旧按钮，并在 onclick 中调用 *.submit 以获取该特殊表单。那解决了它。我没有看到“接受评论作为答案”链接/按钮，但如果有，我会给你。非常感谢。– 史蒂夫刚刚编辑

* * *

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-13T21:19:51.427

我删除了您的一部分输入`"buttonaddmember"=""`，因为它无效。现在似乎水平对齐。不确定你是否有意这样做。

```
<input "buttonaddmember"="" value="Add Member" type="submit"> 
```

[http://jsfiddle.net/6MXuZ/](http://jsfiddle.net/6MXuZ/)

或者在你的 div 上添加 position:relative `button_bar`，然后绝对定位按钮。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-25T02:41:31.250

有一些 HTML 错误会导致不可预知的渲染，*即*：

```
<form><!-- Opening form tag somewhere above -->
[...]
<div class="button_bar">
    <div class="button_bar_left_button">     
        <input value="Request More Informtion" name="buttonRequestMoreInformation" type="submit">
    </div>
</form><!-- end form 'f', main form -->  
[...]
</div><!-- end div button_bar --> 
```

浏览器将纠正这个错误，通过在结束标记`button_bar`之前关闭 div来获得有意义的 DOM ：`<form>`

```
<form><!-- Opening form tag somewhere above -->
[...]
<div class="button_bar">
    <div class="button_bar_left_button">     
        <input value="Request More Informtion" name="buttonRequestMoreInformation" type="submit">
    </div>
</div><!-- Browser will likely insert a closing tag for .button_bar here to correct the error -->
</form><!-- end form 'f', main form -->  
[...]
<!-- This closing div tag will now be "extra" -->
</div><!-- end div button_bar --> 
```

# android - 从单独的类中获取 GPS 经度和纬度 - Android

> ID：11023422
> 
> 赞同：2
> 
> 时间：2012-06-13T21:16:12.923
> 
> 标签：android, gps, latitude-longitude

我正在寻找一种从 GPS 中获取其经度和纬度变量的方法，该变量来自不在主要活动中的分离类。每当用户更改位置时，我都必须获取这些值。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-13T21:24:09.067

这是访问经度和纬度的单独类。

```
public class AppLocationManager implements LocationListener {

    private LocationManager locationManager;
    private String latitude;
    private String longitude;
    private Criteria criteria;
    private String provider;

    public AppLocationManager(Context context) {
        locationManager = (LocationManager) context
                .getSystemService(Context.LOCATION_SERVICE);
        criteria = new Criteria();
        criteria.setAccuracy(Criteria.ACCURACY_FINE);
        provider = locationManager.getBestProvider(criteria, true);
        locationManager.requestLocationUpdates(LocationManager.NETWORK_PROVIDER, 1,
                0, this);
        setMostRecentLocation(locationManager.getLastKnownLocation(provider));

    }

    private void setMostRecentLocation(Location lastKnownLocation) {

    }

    public String getLatitude() {
        return latitude;
    }

    public String getLongitude() {
        return longitude;
    }

    /*
     * (non-Javadoc)
     * 
     * @see
     * android.location.LocationListener#onLocationChanged(android.location.
     * Location)
     */
    @Override
    public void onLocationChanged(Location location) {
        double lon = (double) (location.getLongitude());/// * 1E6);
        double lat = (double) (location.getLatitude());// * 1E6);

//      int lontitue = (int) lon;
//      int latitute = (int) lat;
        latitude = lat + "";
        longitude = lon + "";

    }

    /*
     * (non-Javadoc)
     * 
     * @see
     * android.location.LocationListener#onProviderDisabled(java.lang.String)
     */
    @Override
    public void onProviderDisabled(String arg0) {
        // TODO Auto-generated method stub

    }

    /*
     * (non-Javadoc)
     * 
     * @see
     * android.location.LocationListener#onProviderEnabled(java.lang.String)
     */
    @Override
    public void onProviderEnabled(String arg0) {
        // TODO Auto-generated method stub

    }

    /*
     * (non-Javadoc)
     * 
     * @see android.location.LocationListener#onStatusChanged(java.lang.String,
     * int, android.os.Bundle)
     */
    @Override
    public void onStatusChanged(String arg0, int arg1, Bundle arg2) {
        // TODO Auto-generated method stub

    }

} 
```

您从您的 mian Activity 类中调用经度和纬度。

```
AppLocationManager appLocationManager = new AppLocationManager(YourActivity_name.this);
appLocationManager.getLatitude()
  appLocationManager.getLongitude(); 
```

谢谢

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-04-19T01:49:29.383

要在 Toast 中显示参数，请使用以下代码。

```
lat = appLocationManager.getLatitude();
lng = appLocationManager.getLongitude();
Toast.makeText(ct, lat, Toast.LENGTH_LONG).show();
Toast.makeText(ct, lng, Toast.LENGTH_LONG).show(); 
```

但问题是 GPS，而不是 NETWORK Provider。不知道为什么这被标记为“最佳答案”

# tridion - 发布最终会发布许多组件并耗尽内存

> ID：11023424
> 
> 赞同：4
> 
> 时间：2012-06-13T21:16:23.313
> 
> 标签：tridion

我们注意到组件发布需要很长时间。

我们尝试发布的组件中包含 pdf 和 jpg。它还具有与其他组件的链接。

查看日志，我们发现发布者正在尝试从组件发布多媒体项目，以及从链接组件发布 MM 组件。链接的组件有更多的链接组件。

一些组件在很长一段时间后发布，**一些失败抛出内存异常**。

这是 Tridion 中的错误吗？有没有人遇到过这个问题？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-13T21:32:46.120

这是设计使然，如果您想阻止 SDL Tridion 解析这些附加项目，您将需要修改发送给发布者的说明。如果您使用的是 SDL Tridion 2009 或更早版本，则需要使用事件系统执行此操作。如果您使用的是 2011 或更高版本，则可以利用新的自定义解析器。也许您可以指定您使用的版本。

如果您在 2011 年，请查看有关自定义解析器的这篇文章：[http ://www.tridiondeveloper.com/a-custom-resolver-in-practice](http://www.tridiondeveloper.com/a-custom-resolver-in-practice)

如果您在 2009 年，您可能会发现这个 Event 示例很方便

```
public void OnComponentPublishPre(Component Component, IXMLDOMDocument2 publishInstruction)
{
    //Code to prevent publishing linked components

    XmlNode nodePropagateLinks = (XmlNode)publishInstruction.selectSingleNode("ResolveComponentLinks");
    if (nodePropagateLinks == null)
    {
        IXMLDOMNode nodeResolveLinks = publishInstruction.createNode(XmlNodeType.Element, "ResolveComponentLinks", "http://www.tridion.com/ContentManager/5.0");
        nodeResolveLinks.text = "false";
        publishInstruction.documentElement.appendChild(nodeResolveLinks);

    }
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-13T21:33:21.683

发布一个“连接良好”的组件确实很常见，它会触发大量要包含在该发布操作中的项目。在这种情况下，Tridion 在确定要包含哪些链接项目时通常采用全有或全无的方法。

如果您想更好地控制发布的内容，您应该考虑编写一个自定义解析器，如下所述：[http ://www.tridiondeveloper.com/a-custom-resolver-in-practice](http://www.tridiondeveloper.com/a-custom-resolver-in-practice)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-06-14T17:29:23.773

弗兰克所指的雪崩通常来自三个部分：

*   二进制发布
*   动态模板
*   被物品使用

**二进制发布**

您的*模板*通常会发布多媒体项目：

*   `addbinary()`
*   较旧的`publishbinary()`（在 XSLT 组件模板中），和/或
*   `Publish Binaries in Package`模板构建块 (TBB)，它是`Default Finish Actions`TBB 的一部分。

如果我们跳过这一点，作者需要单独发布多媒体，通常使用动态组件模板。

**每个动态模板**

多个动态组件模板可以为每个动态组件表示发布二进制文件。三个动态模板可能意味着（二进制）发布请求数量的三倍。此外，如果您的逻辑收集了这些链接，任何给定的模板*都可以在其他组件中发布二进制文件。*

**“使用者”控制传播***链接到的* 项目不应发布（上述二进制文件除外）。*反之亦然——使用*您的项目已发布的项目会被发布。这包括具有*链接到*您的项目的项目或组件的页面。

**如何检查**

*   `Where Used`将显示哪些项目正在使用您的项目。
*   发布项目时，`Show Items to Publish`选项应与上述匹配。

除了扩展解析器之外，还要寻找要发布的正确项目。例如，不是发布从页面链接的组件，而是让作者发布页面或*链接*（未链接到）组件。

# c# - 转换整数？有条件地布尔

> ID：11023431
> 
> 赞同：1
> 
> 时间：2012-06-13T21:17:16.417
> 
> 标签：c#, integer, nullable, conditional-statements

所以我在 c# 中创建了一个自定义的 int.tryparse 方法，试图让事情看起来更简单、更清晰。这是方法：

```
 public static int? BoolIntParse(string number)
    {
        int temp;
        if (int.TryParse(number, out temp))
            return temp;
        else
            return null;
    } 
```

现在，我想尝试以这种方式使用它：

```
if(int? someNumber = BoolIntParse(someString))
{
    //do some stuff if its a number
}
else
   //throw some error 
```

这似乎不起作用。我还尝试在条件之前分配值，例如：

```
int? someNumber = BoolIntParse(someString);
if(someNumber)
{
    //do some stuff if its a number
}
else
   //throw some error 
```

我收到错误消息`Cannot implicitely convert type int? to bool`

所以这不是合法的c#。这是为 nullable int 设计的（这种情况）还是我没有正确地做到这一点？我对 c# 比较陌生。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-06-13T21:18:48.633

你想检查是否`someNumber.HasValue`. 那应该在你的条件下。

`if (someNumber.HasValue)`

或作为替代方案，@BrokenGlass 提到：

`if (someNumber != null)`

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-13T21:20:43.110

为什么不使用`TryParse`自身提供的条件逻辑呢？

```
int someNumber;
if (int.TryParse(number, out someNumber))
    //do some stuff if its a number
else
    //throw some error 
```

**编辑**：另外，如果您不需要抛出自定义异常，您可以依靠该[`Parse`](http://msdn.microsoft.com/en-us/library/b3h1hf19.aspx)方法为您抛出异常：

```
int someNumber = int.Parse(number);  //throws error if invalid
//do some stuff if its a number 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-13T21:26:49.613

`someNumber.equals(BoolIntParse(someString))`由于您正在处理对象，因此您将需要使用。下面是代码：

```
string someString = "2";
int? someNumber = 2;
if(someNumber.Equals(BoolIntParse(someString))) {
    Console.Write("done");
} 
```

那应该运行。

# java - 带有 Velocity 模板的架构

> ID：11023444
> 
> 赞同：1
> 
> 时间：2012-06-13T21:18:13.687
> 
> 标签：java, velocity

我想问几个关于使用 Velocity 模板引擎的问题，以确保我使用的是正确的。

我想从模板访问一个数据模型（模型的深层对象图）。我真的很想，这似乎也是最干净的方法，为每个模型都有一个模板： PageModel -> page.vm |--SectionModel -> section.vm

page.vm 是否适合调用速度引擎的自定义包装器并要求它获取 section.vm 的渲染字符串表示形式。其原因是我希望 section.vm*不*共享为 page.vm 设置的上下文变量。

这个想法是每个模板都可以通过 $model 上下文变量访问其模型。每个子模板不包含在 #parse 指令中，而是呈现到主机模板中（子模板也使用自己的 $model 属性，该属性设置为子模型）。

我希望我的解释是有道理的。这种设计是否存在任何性能缺陷？我担心的是，不断创建模板对象并调用合并方法来渲染它们可能会变成性能猪。

谢谢你的建议。

# shopify - 什么会导致 shopify webhook 的主体不包含“客户”数组？

> ID：11023445
> 
> 赞同：2
> 
> 时间：2012-06-13T21:18:29.420
> 
> 标签：shopify

我们订阅了 shopify '订单已完成' webhook。在过去的一个月里，我们在解析发布给我们的数据并根据它采取行动时完全没有问题。特别是，每个请求都包含一个“客户”数组，由（至少）“电子邮件”、“名字”和“姓氏”组成。

我们刚刚收到没有“客户”数组的数据。从表面上看，该订单与我们处理的任何其他订单似乎没有什么不同，因此没有明显的理由会出现这种情况。

我们收到的数据确实包含电子邮件、名字和姓氏，但不在“客户”数组中。我们可以修改我们的代码以查看其他地方以提取这些数据，但我们宁愿在不了解我们为什么要进行更改的情况下这样做。

我们错过的数据 Shopify 帖子的结构是否已宣布更改？

哪些条件会导致“客户”数组不出现在发布的数据中？发布的数据中是否有任何位置可以*保证*始终包含电子邮件、名字和姓氏，以便我们可以防止这种情况再次发生？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-29T17:26:35.293

如果订单上的客户信息丢失，您的 webhook 处理程序应该处理这种情况。如果客户被删除，这可能发生在合法的情况下，这可能由商家手动完成。

特别是在您的情况下，问题在于客户没有与订单相关联。这是 Shopify 用于后台作业处理的库中的一个错误，它不会重试因内存不足而被内核杀死的作业。在这种情况下，该作业将为新客户的订单创建客户。我已经修复了应该防止后台作业在这种情况下丢失的相关错误。

# c# - 使用具有多个条件的联接时出现 LINQ to SQL 查询错误

> ID：11023448
> 
> 赞同：-3
> 
> 时间：2012-06-13T21:18:40.207
> 
> 标签：c#, linq

我有一个 linq 查询

```
from elements in context.Catalog_Element
    join elementattributevalues in context.Catalog_ElementAttributeValue 
         on elements.ElementID equals elementattributevalues.ElementID
    join allowedsubcomponents in context.Catalog_AllowedSubComponents
         on new { AttributeValueID = elementattributevalues.AttributeValueID, 
                  ElementClassID = elements.ElementClassID }
         equals new { AttributeValueID = allowedsubcomponents.AttributeValueIDFilter, 
                  ElementClassID = allowedsubcomponents.ClassIDFilter }
    where allowedsubcomponents.ElementID == 
           new Guid("8c139311-f7cd-4961-a8bb-0d8dd923049e")
    select new
    {
        elements.ElementNumber,
        elements.Description
    }) 
```

这向我显示了一个语法错误，因为 Join 子句中的表达式类型不正确。请帮忙。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-13T23:23:27.963

错误消息清楚地告诉您您的类型不匹配，因此您确实需要确认类型。

我会为四个字段中的每一个（分别更改表格和字段）执行此操作，以查看它们所报告的类型：

```
// look at these in debugger or write them to console
var myFirstType = context.Catalog_ElementAttributeValue
    .Take(1)
    .Select (x => x.AttributeValueID)
    .GetType()
    .ToString();

var mySecondType = ..... 
```

此外，您可以通过将数据强制为字符串来快速查看您的连接子句，以查看它是否有效：

```
on new 
{ 
    AttributeValueID = elementattributevalues.AttributeValueID.ToString(),  
    ElementClassID = elements.ElementClassID.ToString() 
} 
equals new 
{   
    AttributeValueID = allowedsubcomponents.AttributeValueIDFilter.ToString(),  
    ElementClassID = allowedsubcomponents.ClassIDFilter.ToString() 
} 
```

然后尝试仅将 AttributeValueID 转换为字符串，最后尝试仅将 ElementClassID 转换为字符串。失败的一个或多个会告诉你你的类型问题在哪里。

我怀疑这个问题实际上与可空类型有关。

# jquery - Fancybox 2 基于内容大小的动态宽度

> ID：11023450
> 
> 赞同：2
> 
> 时间：2012-06-13T21:18:43.890
> 
> 标签：jquery, iframe, dynamic, fancybox, sizing

我通过 Fancybox 2 打开了一个播放视频的 IFrame：

HTML：

```
<a class="fancybox-video" href="/user/intro-file.cfm" rel="file_name" title="View Video">File Name</a> 
```

Javascript：

```
$("a.fancybox-video").fancybox({
    scrolling   : 'no', 
    type        : 'iframe', 
    helpers     : { 
        title: null 
    }
}); 
```

该视频是用户上传的，所以我不知道大小。我最终会在 Fancybox 上设置 maxHeight 和 maxWidth ，但我已经删除了它们以便于排除故障。

如何根据内容设置 Fancybox 的宽度？我的测试文件大约 400px 宽，fancybox 本身被设置为 830/800px 宽（外部和内部宽度）：[screencap of too-wide fancybox http://img528.imageshack.us/img528/3872/花式框宽度.png](http://img528.imageshack.us/img528/3872/fancyboxwidth.png)

autoSize 和 fitToView 无效。IFrame 页面上没有设置默认宽度的 CSS 或代码。如果我在 Fancybox 代码中强制设置宽度，它可以工作，但由于我的内容是动态的，它不适用于实时系统。

我还尝试从另一个询问高度调整大小的问题中调整一个函数，但它也不起作用：

```
beforeShow  : function() { 
    $('.fancybox-iframe').load(function() { 
        $('.fancybox-inner').width($(this).contents().find('body').width()); 
    }); 
} 
```

编辑：添加了我试图加载到 Fancybox 的 IFrame 页面的代码：

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html>
    <body>
        <cfoutput>
            <script type="text/javascript" src="/Javascript/jwplayer.js"></script>
            <script type='text/javascript'> 
                var max_video_width = 924;
                jwplayer("preview").setup({
                    flashplayer: "/VideoPlayer/player.swf",
                    controlbar: "bottom",
                    file: "/videos/file_name",
                    stretching: 'file_name',
                    autostart: true,
                    events: {
                        onMeta: function(event) {
                            if (get_meta) {
                                if(event.metadata.width != undefined && event.metadata.height != undefined) {
                                    get_meta = false;
                                    if (event.metadata.width > max_video_width) {
                                        var new_height = (max_video_width / (event.metadata.width / event.metadata.height))  
                                        jwplayer("preview").resize(max_video_width,new_height);
                                        jwplayer("preview").stop();
                                        $('##preview_wrapper').width(max_video_width).height(new_height);
                                    } 
                                    else {
                                        jwplayer("preview").resize(event.metadata.width,event.metadata.height);
                                        jwplayer("preview").stop();
                                        $('##preview_wrapper').width(event.metadata.width).height(event.metadata.height);
                                    }
                                    $('.loading-video').slideUp('fast',function(){$('.loading-video').remove()});
                                }
                            }
                        }
                    }
                });
            </script>
        </cfoutput>
    </body>
</html> 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-14T18:37:20.550

查看您的`intro-file.cfm`文件会使事情更清楚。

如果文件中的代码运行良好，我认为您可以从`preview_wrapper`容器中获取尺寸。

只有两个问题：

*   例如，如果您正在使用`$`... ，`$('.loading-video').slideUp()`您不应该将文件包含在`jquery.js`文件中`intro-file.cfm`吗？
*   `##`选择器之前的这个双精度是`$('##preview_wrapper').width()`正确的吗？

假设一切正常，然后尝试在您的 fancybox 脚本中包含：

```
 scrolling: "no", // optional to avoid scrollbars inside fancybox
  beforeShow: function(){
   this.width = $('.fancybox-iframe').contents().find('#preview_wrapper').width();
   this.height = $('.fancybox-iframe').contents().find('#preview_wrapper').height();
  } 
```

...从玩家的包装中获取尺寸。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-14T08:08:02.927

当前未计算 iframe 宽度。也许您可以像这样为每个 iframe 设置宽度/高度 - [http://jsfiddle.net/vVKMF/](http://jsfiddle.net/vVKMF/)

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-06-13T21:33:35.417

添加`autoSize`到：

```
$("a.fancybox-video").fancybox({
    scrolling   : 'no', 
    type        : 'iframe',
    autoSize    : true, 
    helpers     : { 
        title: null 
    }
}); 
```

或者 ：

```
fitToView  : true, 
```

# coldfusion - 数字格式缩短经度和纬度？

> ID：11023455
> 
> 赞同：0
> 
> 时间：2012-06-13T21:19:02.097
> 
> 标签：coldfusion, coldfusion-9

orm 属性名称="poiLat" ormtype="big_decimal" notnull="true" persistent=true precision="16" scale="14"; 属性名称="poiLong" ormtype="big_decimal" notnull="true" persistent=true precision="16" scale="14";

由于超出属性上设置的长度，下面的输入会出错。如果值超过此值，我如何在 ColdFusion 中缩短值。

34.037864685058594

-118.27606201171875

```
local.poiEntity.setpoiLat(local.NewlatO);
local.poiEntity.setpoiLong(local.NewlonO); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-13T22:11:40.480

好的，我想我有这个

圆形（本地.NewlatO * 10 ^ 6）/ 10 ^ 6；

这适用于6个地方

# xslt - 围绕 xsl:apply-templates 的条件测试

> ID：11023458
> 
> 赞同：5
> 
> 时间：2012-06-13T21:19:21.037
> 
> 标签：xslt, xslt-1.0

我一直在尝试学习如何在 xslt 中编写代码，但目前我一直坚持如何在 xsl:apply-templates 标记周围使用条件测试。

这是我正在测试的 xml。

```
<?xml version="1.0" encoding="utf-8"?>
<catalog>
  <cd>
    <title>Empire Burlesque</title>
    <artist>Bob Dylan</artist>
    <country>USA</country>
    <company>Columbia</company>
    <price>10.90</price>
    <year>1985</year>
</cd>
<cd>
    <title>Hide your heart</title>
    <artist>Bonnie Tyler</artist>
    <country>UK</country>
    <company>CBS Records</company>
    <price>9.90</price>
    <year>1988</year>
</cd>
<cd>
    <title>Greatest Hits</title>
    <artist>Dolly Parton</artist>
    <country>USA</country>
    <company>RCA</company>
    <price>9.90</price>
    <year>1982</year>
</cd> 
```

这是我的 xslt

```
<xsl:template match="/">
  <xsl:apply-templates select="catalog/cd" />
</xsl:template>

<xsl:template match="cd">
  <p>
    <xsl:apply-templates select="artist" />
    <br /> 
    <xsl:apply-templates select="country" />
    <br />
    <xsl:if test="country != 'USA' and year != '1985'">
      <xsl:apply-templates select="year" />
    </xsl:if>
  </p>
</xsl:template>

<xsl:template match="artist">
  <xsl:value-of select="." />
</xsl:template>

<xsl:template match="country">
  <xsl:value-of select="." />
</xsl:template>

<xsl:template match="year">
  <xsl:value-of select="." />
</xsl:template> 
```

这是我的输出：

```
Bob Dylan
USA

Bonnie Tyler
UK
1988

Dolly Parton
USA 
```

这是我期待的输出：

```
Bob Dylan
USA

Bonnie Tyler
UK
1988

Dolly Parton
USA
1982 
```

即使我只想在国家/地区的值为 USA 并且年份的值为 1985 时才删除年份，但每次国家/地区的值为 USA 时都会删除年份。有没有更好的方法可以使用应用模板？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-13T21:34:41.017

您可能更喜欢直接将模板应用于所需的节点集，而不需要条件“if”检查。

```
<xsl:apply-templates select="year[not(../country='USA' and ../year='1985)]" /> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-14T02:32:22.523

**简单地纠正你的逻辑**。

**替换**：

```
<xsl:if test="country != 'USA' and year != '1985'"> 
```

**与**：

```
<xsl:if test="country != 'USA' or year != '1985'"> 
```

**甚至更好的是，仅在想要的节点上应用模板**：

```
 <xsl:apply-templates select=
  "self::*[country != 'USA' or year != '1985']/year"/> 
```

**请注意**：

如图所示，可以在`select`属性中指定 Xpath 表达式，而无需使用任何反向轴（来回移动）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-04-30T10:32:32.980

这对我有帮助，谢谢。我正在扩展这个示例并尝试为某个属性调用一个模板（我已将 XML 编辑为例如`<artist sex="male">Bob Dylan</artist>` 我的尝试失败但我解决了。这段代码允许我在 >1 场景中创建条件模板：-

```
<xsl:template match="cd">
    <p>
        <xsl:apply-templates select="title"/>  
        <xsl:apply-templates select="artist [@sex = 'male']"/>
        <xsl:apply-templates select="artist [@sex = 'female']"/>
        <xsl:apply-templates select="year"/>
    </p>
</xsl:template>

<xsl:template match="title">
    Title: <span style="color:#ff0000">
        <xsl:value-of select="."/></span>
    <br />
</xsl:template>

<xsl:template match="artist [@sex = 'male']">
    Artist: <span style="color:#e9d419">
        <xsl:value-of select="."/></span>
    <br />
</xsl:template>

<xsl:template match="artist [@sex = 'female']">
    Artist: <span style="color:#48b8ff">
        <xsl:value-of select="."/></span>
    <br />
</xsl:template>

<xsl:template match="year">
    Year: <span style="color:#eb47dc">
        <xsl:value-of select="."/></span>
    <br />
</xsl:template> 
```

希望这对某人有所帮助和有用！输出会根据性别产生不同颜色的艺术家姓名。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2012-06-13T21:25:16.353

如果国家是美国并且年份是 1985，您想删除年份。

因此，如果国家/地区不是美国**或**年份不是 1985 年，则要复制年份。

您的条件应该使用 an`or`而不是`and`. 请注意`not(a and b) = (not a) or (not b)`.

# facebook - 在 FQL 查询中需要帮助

> ID：11023460
> 
> 赞同：0
> 
> 时间：2012-06-13T21:19:31.847
> 
> 标签：facebook, facebook-graph-api, facebook-fql

我尝试使用[https://developers.facebook.com/tools/explorer查询 FQL](https://developers.facebook.com/tools/explorer)

我输入的命令是`SELECT message FROM status WHERE uid = me()`

但返回的数据仅限于 100 个条目。输入的数据量是否有某种限制？有没有办法改变这个限制？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-14T09:48:28.753

您可以指定返回结果的数量限制。如您所见，默认值为 100。您应该考虑使用更大的限制。

示例：`SELECT message FROM status WHERE uid = me() limit 200`;

# qt - 使用 QList 时 Qt 崩溃（堆损坏）

> ID：11023461
> 
> 赞同：1
> 
> 时间：2012-06-13T21:19:32.907
> 
> 标签：qt, qt4, crash, qlist

我已经使用 MSVC2008 从源代码构建了 Qt，因为建议避免任何不兼容问题。我在使用返回 QList 对象的 Qt 函数时遇到了问题。

```
QList<QNetworkInterface> *netInterfaces = new QList<QNetworkInterface>;
*netInterfaces = QNetworkInterface::allInterfaces();
delete netInterfaces; 
```

尝试释放内存时，此代码将始终在 free.c 中的**“删除 netInterfaces”上崩溃。**它指出堆已损坏，我不知道为什么，因为所有内容都是使用相同版本的 MSVC 编译的。

即使我只是调用函数，它也会发生在所有返回 QList 对象的 Qt 函数中：

```
QNetworkInterface::allInterfaces(); 
```

使用上面的代码，当试图释放 Qt 分配的堆时，应用程序总是会立即崩溃。奇怪的是，这只发生在 Debug 版本中。发布构建工作正常，没有任何崩溃。

我的 Qt 4.8.0 是用 /MT（多线程）编译的，我动态链接到库。我的应用程序也被编译为多线程。

有谁知道这里问题的可能原因是什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-14T10:58:18.467

我找到了解决我的问题的方法。显然 Qt 有它自己的一组堆分配器，虽然我有一个多线程 (/MT) 构建和一个共享库，但 Qt 将使用它们自己在 DLL 中的内存处理程序分配堆。在 Qt 分配此内存后，我的应用程序试图在我自己的代码中释放这些内存块，这导致崩溃，因为 Qt 和主应用程序之间的堆结构不同。

我已经用 /MT 标志重建了 Qt，但现在我生成了一个静态库而不是共享库。在我将 Qt 与我的应用程序静态链接后，所有堆问题都神奇地消失了。

我在这里的解释可能有点错误，但我希望至少该解决方案能帮助一些找到这个线程的人。我在互联网上看到很多人遇到这个问题，关键是要真正理解，当它是用 /MT 标志构建的时，你不应该链接共享库。/MD 完全没问题。

这是我发现启发我的线程：http: [//qt-project.org/forums/viewthread/16513](http://qt-project.org/forums/viewthread/16513)

干杯!

# c# - 无法检索 ContentPresenter 的 ActualWidth / ActualHeight

> ID：11023468
> 
> 赞同：1
> 
> 时间：2012-06-13T21:19:48.897
> 
> 标签：c#, wpf, actualwidth, actualheight

在我的应用程序中，我们有一个视图模型对象，我们`FrameworkElement`使用我们的自定义函数从该对象中检索其附加`GetVisualChildWithDataContext`（见下文）。

发生的情况是，此函数返回一个`ContentPresenter`对象，其`ActualWidth`和`ActualHeight`属性为 0。由于我的内容由 24x24 矩形组成，因此我希望这 2 个属性的值为 24。

我的问题是，我怎样才能通过只有一个视图模型来检索我期望的值（`ActualWidth`和24）？`ActualHeight`如果有更好的方法可以做到这一点，我会全力以赴。

谢谢你的时间。（见下面的示例）

xml:

```
<Window x:Class="WpfApplication2.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:l="clr-namespace:WpfApplication2"
        Title="MainWindow"
        Width="525"
        Height="350">
  <Canvas x:Name="_RootCanvas">
  <ItemsControl Margin="-5,0,0,0" ItemsSource="{Binding MyItems}">
    <ItemsControl.ItemsPanel>
      <ItemsPanelTemplate>
        <Canvas />
      </ItemsPanelTemplate>
    </ItemsControl.ItemsPanel>
    <ItemsControl.ItemTemplate>
      <DataTemplate DataType="{x:Type l:MyItem}">
        <Canvas>
          <Rectangle
              Canvas.Left="{Binding ActualLeft}"
              IsHitTestVisible="True"
              Margin="0,0,0,0"
              Width="24"
              Height="24"
              Fill="Black" />
        </Canvas>
      </DataTemplate>
    </ItemsControl.ItemTemplate>
  </ItemsControl>

    <Button Canvas.Top="50" Width="100" Height="30" Click="Button_Clicked">
      <TextBlock Text="Button" />
    </Button>
  </Canvas>
</Window> 
```

后面的代码：

```
private MyItem _MyItem;
public MainWindow()
{
    InitializeComponent();

    _MyItem = new MyItem(0);
    MyItems = new ObservableCollection<MyItem>();
    MyItems.Add(_MyItem);

    DataContext = this;
}

public ObservableCollection<MyItem> MyItems { get; set; }

public void Button_Clicked(object sender, RoutedEventArgs e)
{
    FrameworkElement fe = GetVisualChildWithDataContext(_RootCanvas, _MyItem);
}

public static FrameworkElement GetVisualChildWithDataContext(DependencyObject parent, object dataContext)
{
    int count = VisualTreeHelper.GetChildrenCount(parent);
    for (int i = 0; i < count; i++)
    {
        DependencyObject d = VisualTreeHelper.GetChild(parent, i);
        FrameworkElement element = d as FrameworkElement;
        if (element != null)
        {
            if (element.DataContext == dataContext)
                return element;

            var f = GetVisualChildWithDataContext(element, dataContext);
            if (f != null)
                return f;
        }
    }

    return null;
}

public class MyItem
{
    public MyItem(double left)
    {
        ActualLeft = left;
    }
    public double ActualLeft { get; set; }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-13T21:28:11.547

我已使用此链接中描述的技术绑定到`ActualWidth`and `ActualHeight`：

[http://meleak.wordpress.com/2011/08/28/onewaytosource-binding-for-readonly-dependency-property/](http://meleak.wordpress.com/2011/08/28/onewaytosource-binding-for-readonly-dependency-property/)

作者将他的技术称为“推送绑定”。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-14T14:05:03.707

为了解决我的问题，我创建了以下扩展方法：

```
public static Size GetActualSize(this FrameworkElement parent)
{
    var contentPresenter = parent as ContentPresenter;
    if (contentPresenter != null)
    {
        Rect descendantBounds = VisualTreeHelper.GetDescendantBounds(contentPresenter);
        if (!descendantBounds.Size.IsEmpty)
            return descendantBounds.Size;
    }

    return new Size(parent.ActualWidth, parent.ActualHeight);
} 
```

不漂亮，但它完成了工作。

# ruby-on-rails - 黄瓜功能选择选项失败

> ID：11023475
> 
> 赞同：1
> 
> 时间：2012-06-13T21:20:21.273
> 
> 标签：ruby-on-rails, cucumber, capybara

无法弄清楚为什么这个功能不会通过......我知道它是通过手动测试工作的，但我不断收到这个错误

```
cannot select option, no option with text 'Don Moen' in select box 'audio_file[artist_id]'
(Capybara::ElementNotFound)
(eval):2:in `select'
./features/step_definitions/web_steps.rb:34:in `/^I select "(.*?)" from "(.*?)"$/'
features/adding_audio.feature:19:in `When I select "Don Moen" from "audio_file[artist_id]"' 
```

场景失败：

```
Background:
    Given I am on the home page
    And I have an admin account
    And I submit valid login information
    And I am in the admin panel
    And I follow "New Upload"

Scenario: Adding Audio with Existing Artist
    Given the following Artists exist
        |   name     |
        |   Don Moen |
    When I fill in "Title" with "Song Name"
    When I select "Don Moen" from "audio_file[artist_id]"
    And I press "Upload"
    Then I should not see an error message 
```

问题步骤定义：

```
Given /^the following Artists exist$/ do |table|
  table.hashes.each do |attributes|
    Artist.create :name => attributes[:name]
  end
end

When /^I select "(.*?)" from "(.*?)"$/ do |option, field|
  page.select option, :from => field
end 
```

我知道问题与模型未保存在数据库中有关，因为如果我在测试控制台中手动添加该艺术家，该功能就会通过。

也许我搞砸了一些数据库配置？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-14T10:20:08.503

我不知道您实际访问该页面的时间点，但我怀疑您在创建艺术家记录之前就已经这样做了，因此下拉菜单将为空。

# ruby-on-rails - 有没有办法删除属于已删除控制器的所有规范测试？

> ID：11023477
> 
> 赞同：0
> 
> 时间：2012-06-13T21:20:30.503
> 
> 标签：ruby-on-rails, rspec

我正在剥离一个巨大的应用程序，并在删除许多控制器的过程中。运行 rspec 时，对于所有这些不再具有相应类的测试，我得到了 NameError（未初始化的常量）。有没有办法自动删除所有这些测试，而不是一个一个地删除这些测试？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-13T21:24:01.287

`rails destroy controller foo`应该删除规范、视图、助手等。

运行`--pretend`选项以查看如果您实际运行它*会发生什么。*

```
Usage: rails destroy GENERATOR [args] [options]

General options:
  -h, [--help]     # Print generator's options and usage
  -p, [--pretend]  # Run but do not make any changes
  -f, [--force]    # Overwrite files that already exist
  -s, [--skip]     # Skip files that already exist
  -q, [--quiet]    # Suppress status output 
```

我不知道是否有办法*自动删除**已经*删除的东西的规范，尽管我想你可以查看规范文件名并通过一个小脚本自己做。

# algorithm - 递归迭代 - 还是优化？

> ID：11023482
> 
> 赞同：0
> 
> 时间：2012-06-13T21:20:44.173
> 
> 标签：algorithm, actionscript-3, optimization, recursion, iteration

我有一个算法可以搜索图中两个节点之间的所有可能路径，但我选择的路径不重复节点并且具有我指定的路径长度。
它在 ActionScript3 中，我需要将我的算法更改为迭代或优化它（如果可能的话）。
我不知道该怎么做，我不确定更改为迭代是否会为该函数带来更好的执行时间。可能无法优化。我不知道。

这是我的功能： http: [//pastebin.com/nMN2kkpu](http://pastebin.com/nMN2kkpu)

如果有人可以就如何解决这个问题提供一些提示，那就太好了。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-13T23:31:53.530

一方面，您可以通过开始顶点对边进行排序。然后，遍历一个顶点的邻居将与该顶点的邻居数成正比（而现在它正在采用，整个图的边数在`O(M)`哪里）。`M`

如果您放宽不重复顶点的条件，我相信问题可以在更好的时间解决。

但是，如果您需要它，恐怕没有简单的更改可以使您的代码更快。不过，我不能保证这一点。

此外，如果我是正确的，代码片段会测试是否已经使用了*边缘*，而不是是否使用了*顶点*。我注意到的另一件事是，一旦找到这样的路径，就不会停止递归。由于在大多数*图中，对于 的合理值，都会存在这样的路径`length`，我想说如果您只需要一个这样的路径，那么在找到一个这样的路径后，您可能会浪费大量的 CPU 时间。

* 大多数 - 读作“也许是大多数（IMO）”。

# c# - 属性未调用的隐式/显式转换运算符 (System.ComponentModel.DataAnnotation.dll)

> ID：11023483
> 
> 赞同：2
> 
> 时间：2012-06-13T21:20:45.713
> 
> 标签：c#, data-annotations, implicit-conversion, explicit-conversion

我们的域模型中使用了一个自定义的 LocalizedString 类型。我们想用验证属性来装饰属性，比如`MaxLength`. 为此，我们添加了隐式运算符以启用此属性所需的强制转换。

奇怪的是，运算符似乎永远不会被调用，并且在属性`IsValid`方法中抛出了 InvalidCastException。在我们自己的项目中执行此演员阵容。

在这个系统 clr ngen'ed 属性中是否有一个特殊的强制转换行为编译器 magix？

```
// Custom type
public class LocalizedString
{
    public string Value
    {
        get { return string.Empty; }
    }

    public static implicit operator Array(LocalizedString localizedString)
    {
        if (localizedString.Value == null)
        {
            return new char[0];
        }

        return localizedString.Value.ToCharArray();
    }
}

// Type: System.ComponentModel.DataAnnotations.MaxLengthAttribute
// Assembly: System.ComponentModel.DataAnnotations, Version=4.0.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35
// Assembly location: C:\Windows\Microsoft.NET\Framework\v4.0.30319\System.ComponentModel.DataAnnotations.dll
public override bool IsValid(object value)
{
  this.EnsureLegalLengths();
  if (value == null)
  {
    return true;
  }
  else
  {
    string str = value as string;
    int num = str == null ? ((Array) value).Length : str.Length;
    if (-1 != this.Length)
      return num <= this.Length;
    else
      return true;
  }
}

[TestMethod]
public void CanCallIsValidWithLocalizedString()
{
    // Arrange
    var attribute = new MaxLengthAttribute(20);
    var localized = new LocalizedString { Value = "123456789012345678901" };

    // Act
    var valid = attribute.IsValid(localized);

    // Assert
    Assert.IsFalse(valid);
} 
```

谢谢你的帮助。

**编辑**

```
Das Objekt des Typs "Nexplore.ReSearch.Base.Core.Domain.Model.LocalizedString" kann nicht in Typ "System.Array" umgewandelt werden.
bei System.ComponentModel.DataAnnotations.MaxLengthAttribute.IsValid(Object value)
bei Nexplore.ReSearch.Base.Tests.Unit.Infrastructure.CodeFirst.MaxLengthLocalizedAttributeTests.CanCallIsValidWithLocalizedString() in d:\Nexplore\SourceForge\Nexplore.ReSearch.Base\Source\Nexplore.ReSearch.Base.Tests.Unit\Infrastructure.CodeFirst\MaxLengthLocalizedAttributeTests.cs:Zeile 40. 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-06-13T22:23:42.997

*任何类型*的运算符仅适用于在编译时知道对象类型的情况。它们不会“即时”应用于`object`.

您*可以*尝试使用`dynamic`which*来做到*这一点。

例子：

```
using System;

class Foo
{
    public static implicit operator Array(Foo foo)
    {
        return new int[0]; // doesn't matter
    }
    static void Main()
    {
        Foo foo = new Foo();
        Array x = (Array)foo; // implicit operator called via compiler
        dynamic dyn = foo;
        Array y = (Array)dyn; // implicit operator called via dynmic
        object obj = foo;
        Array z = (Array)obj; // implicit operator NOT called
                              // - this is a type-check (BOOM!)
    }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-13T22:27:16.167

你写

```
((Array) value) 
```

但是值的静态类型是对象。所以这被编译为从对象到数组的转换。甚至从未考虑过您的转换运算符。

将其更改为

```
((Array)(value as LocalizedString)) 
```

你会没事的。

# asp.net-mvc-3 - 路线在生产环境中不起作用

> ID：11023484
> 
> 赞同：1
> 
> 时间：2012-06-13T21:20:46.870
> 
> 标签：asp.net-mvc-3, routes

我创建了以下路线

```
 routes.MapRoute("ThumbnailRoute",// Route name
           "Image/{action}/{session}/{parentId}/{fileName}/{ctype}/{thumbNailSize}", // URL with parameters
           new { controller = "Image", action = "GenerateThumbnail", session = "", parentId = "", fileName = "", ctype = "", thumbNailSize = 70 },  // Parameter defaults 
           new { controller = @"[^\.]*", action = @"[^\.]*" }); 
```

我的扩展方法返回一个字符串，如下所示，这将是 img 标签的 src 属性：

```
 return string.Format("/{0}/{1}/{2}/{3}/{4}/{5}/{6}", controller, action, session, parentId, fileName, ctype, thumbNailSize); 
```

当我右键单击页面并为 dev 和 prod 环境选择属性时，src av img 标签是相同的（http://localhost/Image/GenerateThumbnail/de-DE/121/0beac6da-7c09-4faf-ad4b-48326f9d337e。 jpg/jpeg/70）唯一不同的是域名（localhost，www.domain.com），但图像不会出现在产品上。感谢您的帮助

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-14T00:39:27.647

如果 URL 在生产版本上看起来不错 - 也许问题不在于路由，而在于操作方法中的代码。

在点击生产 URL 时，您是否检查过从浏览器获得的响应？

当您浏览[http://www.domain.com/Image/GenerateThumbnail/de-DE/121/0beac6da-7c09-4faf-ad4b-48326f9d337e.jpg/jpeg/70](http://www.domain.com/Image/GenerateThumbnail/de-DE/121/0beac6da-7c09-4faf-ad4b-48326f9d337e.jpg/jpeg/70)时会得到什么响应？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-14T05:26:21.573

永远不要像以前那样对 URL 进行硬编码。始终使用 url 助手。问题是，当您在 IIS 中部署应用程序时，会有一个虚拟目录名称。所以正确的网址如下：

```
http://foo.com/MyAppName/Image/GenerateThumbnail/de-DE/121/0beac6da-7c09-4faf-ad4b-48326f9d337e.jpg/jpeg/70 
```

代替：

```
http://foo.com/Image/GenerateThumbnail/de-DE/121/0beac6da-7c09-4faf-ad4b-48326f9d337e.jpg/jpeg/70 
```

由于您已对 url 进行硬编码，因此您会得到 404。

所以使用[RouteUrl](http://msdn.microsoft.com/en-us/library/dd505215.aspx)方法来生成它，如果有的话，它将考虑这个虚拟目录。不要使用任何字符串格式来构建 url：

```
public ActionResult Index()
{
    string url = Url.RouteUrl("ThumbnailRoute", new
    {
        action = "GenerateThumbnail",
        controller = "Image",
        session = session,
        parentId = parentId,
        fileName = fileName,
        ctype = ctype,
        thumbNailSize = thumbNailSize
    });

    ...
} 
```

# c# - 长到十六进制 VB6，在 c# 中重新编码

> ID：11023486
> 
> 赞同：-3
> 
> 时间：2012-06-13T21:20:54.267
> 
> 标签：c#, vb6, hex, long-integer

我想用 c# 编写 VB6 应用程序的这一部分。如何将 long 更改为 Hex 值？

```
Public Function longToHex(l As Long) As String
    longToHex = Hex(l)
    If Len(longToHex) < 4 Then longToHex = String(4 - Len(longToHex), "0") & longToHex
    longToHex = Right(longToHex, 2) & Left(longToHex, 2)
End Function 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-13T21:25:24.620

只需格式化为填充的十六进制字符串：

```
string.Format("{0:X4}", myLong.ToString().Length / 2) 
```

然后将前两个字符与后两个字符转置。

VB6 代码似乎将长度`sData`除以 2，然后将长度转换为十六进制字符串，并在需要时用 0 填充到 4 个字符。然后它将前两个字符与后两个字符转置。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-13T21:31:59.160

看起来很复杂——代码应该做什么？十六进制字符串长度的一半？这可能有效： `sLen = (sData.length / 2).ToString("X")`

# c# - 将 PerWcfSession 生活方式与 Castle WCF 集成工具一起使用

> ID：11023491
> 
> 赞同：3
> 
> 时间：2012-06-13T21:21:30.833
> 
> 标签：c#, wcf, castle-windsor, wcffacility

以下代码使用 Castle Windsor 3.0 的[WCF 集成工具](http://stw.castleproject.org/Default.aspx?Page=WCF-Integration-Facility&NS=Windsor&AspxAutoDetectCookieSupport=1)来注册 WCF 自托管服务：

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.ServiceModel;

using Castle.Facilities.WcfIntegration;
using Castle.MicroKernel.Registration;
using Castle.Windsor;

namespace SelfHost
{
    [ServiceContract]
    public interface IHelloWorldService
    {
        [OperationContract]
        string SayHello(string name);
    }

    [ServiceBehavior(IncludeExceptionDetailInFaults = true)]
    public class HelloWorldService : IHelloWorldService
    {
        private readonly PerSession _perSession;

        public HelloWorldService(PerSession perSession)
        {
            _perSession = perSession;
        }

        public string SayHello(string name)
        {
            return string.Format("Hello, {0} {1}", name, _perSession.Info());
        }
    }

    public class PerSession
    {
        private readonly string _now;

        public PerSession()
        {
            _now = DateTime.Now.ToString();
        }

        public string Info()
        {
            return _now;
        }
    }

    internal class Program
    {
        private static void Main(string[] args)
        {
            Uri baseAddress = new Uri("http://localhost:8080/hello");

            var container = new WindsorContainer();

            container.AddFacility<WcfFacility>();

            container.Register(
                Component.For<PerSession>().LifeStyle.PerWcfSession(),
                Component.For<IHelloWorldService>()
                    .ImplementedBy<HelloWorldService>()
                    .AsWcfService(
                        new DefaultServiceModel()
                            .AddBaseAddresses(baseAddress)
                            .AddEndpoints(WcfEndpoint.BoundTo(new BasicHttpBinding()).At("basic"))
                            .PublishMetadata(o => o.EnableHttpGet())
                    )
                );

            Console.WriteLine("The service is ready at {0}", baseAddress);
            Console.WriteLine("Press <Enter> to stop the service.");
            Console.ReadLine();
        }
    }
} 
```

尝试使用 WcfTestClient.exe 调用 SayHello 方法会导致以下错误：

> 无法获得组件 SelfHost.PerSession 的范围。这很可能是自定义 IScopeAccessor 中的错误，或者您正在尝试访问范围之外的范围组件（例如 Web 请求之外的每个 Web 请求组件等）

使用 PerWcfSession 组件的正确方法是什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-14T00:32:43.657

所以我错过了一些东西：

ServiceContract 需要设置 SessionMode 属性

```
[ServiceContract(SessionMode = SessionMode.Required)] 
```

同样 ServiceBehavior 需要设置 InstanceContextMode

```
[ServiceBehavior(IncludeExceptionDetailInFaults = true, InstanceContextMode = InstanceContextMode.PerSession)] 
```

Finally, the service registration needs to change the Lifestyle from the default (Singleton) so that it gets recreated for each request (and the dependencies are re-evaluated) - Transient or PerWcfSession would work.

Also, because we require a session, the binding needs to change from the basicHttpBinding to something that that supports sessions:

```
Component.For<IHelloWorldService>()
    .ImplementedBy<HelloWorldService>()
    .LifestyleTransient()
    .AsWcfService(
        new DefaultServiceModel()
            .AddBaseAddresses(baseAddress)
            .AddEndpoints(WcfEndpoint.BoundTo(new WSHttpBinding()).At("myBinding"))
            .PublishMetadata(o => o.EnableHttpGet())
    ) 
```

Which makes the final code look like this:

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.ServiceModel;

using Castle.Facilities.WcfIntegration;
using Castle.MicroKernel.Registration;
using Castle.Windsor;

namespace SelfHost
{
    [ServiceContract(SessionMode = SessionMode.Required)]
    public interface IHelloWorldService
    {
        [OperationContract]
        string SayHello(string name);
    }

    [ServiceBehavior(IncludeExceptionDetailInFaults = true, InstanceContextMode = InstanceContextMode.PerSession)]
    public class HelloWorldService : IHelloWorldService
    {
        private readonly PerSession _perSession;

        public HelloWorldService(PerSession perSession)
        {
            _perSession = perSession;
        }

        public string SayHello(string name)
        {
            return string.Format("Hello, {0} {1}", name, _perSession.Info());
        }
    }

        public class PerSession
        {
            private readonly string _now;

            public PerSession()
            {
                _now = DateTime.Now.ToString();
            }

            public string Info()
            {
                return _now;
            }
        }

    internal class Program
    {
        private static void Main(string[] args)
        {
            Uri baseAddress = new Uri("http://localhost:8080/hello");

            var container = new WindsorContainer();

            container.AddFacility<WcfFacility>();

            container.Register(
                Component.For<PerSession>().LifeStyle.PerWebRequest,
                Component.For<IHelloWorldService>()
                    .ImplementedBy<HelloWorldService>()
                    .LifeStyle.PerWebRequest
                    .AsWcfService(
                        new DefaultServiceModel()
                            .AddBaseAddresses(baseAddress)
                            .AddEndpoints(WcfEndpoint.BoundTo(new WSHttpBinding()).At("myBinding"))
                            .PublishMetadata(o => o.EnableHttpGet())
                    )
                );

            Console.WriteLine("The service is ready at {0}", baseAddress);
            Console.WriteLine("Press <Enter> to stop the service.");
            Console.ReadLine();
        }
    }
} 
```

# x86 - 从加载的段切换到保护模式

> ID：11023493
> 
> 赞同：0
> 
> 时间：2012-06-13T21:21:32.670
> 
> 标签：x86, nasm, bootloader

我正在尝试编写简单的引导加载程序。

我想以实模式加载 boot0，跳转到 boot0 并从那里加载完整的内核。然后切换到保护模式并执行内核代码。

到目前为止，我有：

```
;First segment loaded by BIOS:
bits 16
org 0
jmp 0x07c0:start
start:
mov ax, cs
mov ds, ax
mov es, ax

mov al, 0x03
mov ah, 0
int 0x10

mov si, welcome_msg
call print

mov ax, 0x500   ;load boot0 to 0x500
mov es, ax      ;value should be in es
mov cl, 2   ;sector number to be loaded
mov al, 4   ;number of sectors to load
call loadsector

jmp 0x500:0000

loadsector:
mov bx, 0
mov dl, 0 ;load from floppy=0
mov dh, 0
mov ch, 0
mov ah, 2
int 0x13
jc error
ret 

times 510 - ($-$$) db 0
dw 0xaa55 
```

接下来的 4 个段作为 boot0：

```
bits 16
org 0
mov ax, cs
mov ds, ax
mov es, ax
mov ax, 0x7000
mov ss, ax
mov sp, ss

;Printing from tutorial
mov     ax,0xb800       ; Load gs to point to video memory
mov     gs,ax           ; We intend to display a brown A in real mode
mov     word [gs:80],0x0248 ; displaymov word [gs:0],0x641 ; display
mov     word [gs:82],0x0145 ; displaymov word [gs:0],0x641 ; display
mov     word [gs:84],0x034C ; displaymov word [gs:0],0x641 ; display
mov     word [gs:86],0x044C ; displaymov word [gs:0],0x641 ; display
mov     word [gs:88],0x054F ; displaymov word [gs:0],0x641 ; display
;load kernel system
mov ax, 0x2000 
mov es, ax
mov cl, 6   ;after boot0 will be full kernel
mov al, 4   ;for now only 4 sectors
call loadsector ;load kernel
jmp protected_mode_run

loadsector:
mov bx, 0
mov dl, floppy
mov dh, 0
mov ch, 0
mov ah, 2
int 0x13
jc error
ret

protected_mode_run:
cli
lgdt    [gdtr]
mov     eax,cr0 ; The lsb of cr0 is the protected mode bit
or      al,0x01 ; Set protected mode bit
mov     cr0,eax ; Mov modified word to the control register
jmp     codesel:go_pm

bits 32
go_pm:
mov     ax,datasel
mov     ds,ax ; Initialise ds & es to data segment
mov     es,ax
mov     ax,videosel ; Initialise gs to video memory
mov     gs,ax
mov     word [gs:0],0x741 ; Display white A in protected mode
spin:   jmp spin ; Loop
;TODO: instead jump to loaded code here

bits 16
gdtr:
dw      gdt_end-gdt-1 ; Length of the gdt
dd      0x500+gdt ; physical address of gdt

gdt:
nullsel equ $-gdt ; $->current location,so nullsel = 0h
gdt0:            ; Null descriptor,as per convention gdt0 is 0
dd 0        ; Each gdt entry is 8 bytes, so at 08h it is CS
dd 0        ; In all the segment descriptor is 64 bits

codesel equ $-gdt ; This is 8h,ie 2nd descriptor in gdt
code_gdt: ; Code descriptor 4Gb flat segment at 0000:0000h
dw      0x0ffff ; Limit 4Gb bits 0-15 of segment descriptor
dw      0x0000 ; Base 0h bits 16-31 of segment descriptor (sd)
db      0x00 ; Base addr of seg 16-23 of 32bit addr,32-39 of sd
db      0x09a ; P,DPL(2),S,TYPE(3),A->Present bit 1,Descriptor
; privilege level 0-3,Segment descriptor 1 ie code
db      0x0cf ; Upper 4 bits G,D,0,AVL ->1 segment len is page
; granular, 1 default operation size is 32bit seg
; Lower nibble bits 16-19 of segment limit
db      0x00 ; Base addr of seg 24-31 of 32bit addr,56-63 of sd

datasel equ $-gdt ; ie 10h, beginning of next 8 bytes for data sd
data_gdt: ; Data descriptor 4Gb flat seg at 0000:0000h
dw      0x0ffff ; Limit 4Gb
dw      0x0000 ; Base 0000:0000h
db      0x00 ; Descriptor format same as above
db      0x092
db      0x0cf
db      0x00

videosel equ $-gdt ; ie 18h,next gdt entry
dw      3999 ; Limit 80*25*2-1
dw      0x8000 ; Base 0xb8000
db      0x0b
db      0x92 ; present,ring 0,data,expand-up,writable
db      0x00 ; byte granularity 16 bit
db      0x00
gdt_end:

times 2048 - ($-$$) db 0 
```

当我尝试从 BIOS 加载的第一段进行时，进入保护模式工作正常。从加载的段执行此操作的每次尝试都会在“jmp codesel:go_pm”行崩溃

文件的结构是： 1 段 - 初始化 4 段 - boot0（加载到 0x500 段） 4 段 - 内核（加载到 0x2000 段）

我只在 GDT 中更改了“dd 0x500+gdt；gdt 的物理地址”，但看起来还不够。您能否告诉我还应该更改哪些内容或提供任何参考，以便我可以阅读有关 GDT 和切换到保护模式的更多详细信息？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-16T05:40:13.617

第一个问题在这里：

```
gdtr:
dw      gdt_end-gdt-1 ; Length of the gdt
dd      0x500+gdt ; physical address of gdt

gdt: 
```

0x500 是实模式段，但该段在物理内存中的何处开始？在 0x5000，对吧？那么，为什么`0x500+gdt`？

第二个问题在这里：

```
bits 16
org 0
...
jmp     codesel:go_pm

bits 32
go_pm:
...
code_gdt: ; Code descriptor 4Gb flat segment at 0000:0000h
dw      0x0ffff ; Limit 4Gb bits 0-15 of segment descriptor
dw      0x0000 ; Base 0h bits 16-31 of segment descriptor (sd)
db      0x00 ; Base addr of seg 16-23 of 32bit addr,32-39 of sd
db      0x09a ; P,DPL(2),S,TYPE(3),A->Present bit 1,Descriptor
; privilege level 0-3,Segment descriptor 1 ie code
db      0x0cf ; Upper 4 bits G,D,0,AVL ->1 segment len is page
; granular, 1 default operation size is 32bit seg
; Lower nibble bits 16-19 of segment limit
db      0x00 ; Base addr of seg 24-31 of 32bit addr,56-63 of sd 
```

您将 32 位代码段定义为从物理地址 0 开始，但是您的 32 位代码的地址 0 对应于物理地址 0x5000。为什么？因为您要求它`org 0`并在 0x500:0 处加载您的代码。您对数据段有同样的问题[等待发生]。

我注意到还有一些可疑的东西：

```
mov ax, 0x7000
mov ss, ax
mov sp, ss 
```

您确定要 SS=SP=0x7000 吗？我不能说这是错误的（我没有做所有的数学运算），但是 SS 和 SP 不是一回事，用相同的值加载它们肯定看起来很奇怪。

所有必要的细节都在英特尔/AMD 的 CPU 手册中进行了描述。您所要做的就是了解这些内容并注意您正在做的事情以避免出现上述两个错误。

# jquery - Jquery Validation : Adding/Removing Rules Dynamically based on dropdown selection

> ID：11023499
> 
> 赞同：6
> 
> 时间：2012-06-13T21:21:53.200
> 
> 标签：jquery, dynamic, drop-down-menu, jquery-validate

I have a dropdown selector, with values from 1-4\. Depending on the selection, subsequent inputs in form are hidden and validation required is removed from each. eg, if 2 is selected, then inputs 1-2 are shown and validation required is added whilst 3-4 are hidden and validation removed.

```
$("#dropdownSelector").change(function() {
inputtohide = $(this).val();
$('input[id*=conviction]').slice(0, inputtohide).show().rules("add", {required: "#convictions_0:checked" });
$('input[id*=conviction]').slice(inputtohide, 4).hide().rules("remove", {required: "#convictions_0:checked" });
$("#thisform").validate();
}); 
```

This works fine, *however* ( as the documentation for the validation plugin states ) validation is only added for the *first* element returned.

I understand from other posts , that the following code should add validation to each input:-

```
$("#thisform").validate();
$("input[id*=conviction]").each(function() {
    $(this).rules("add", {required: "#convictions_0:checked" });

    }); 
```

**My question** is how do I combine the two bits of code ? Any help greatly appreciated, thanks.

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-13T21:40:20.773

You simply need to use the `.each()` function on your `.slice()` result in order to iterate over all the elements it returns:

```
$('input[id*=conviction]').slice(0, inputtohide).each(function(){
    $(this).show().rules("add", {required: "#convictions_0:checked" });
});

$('input[id*=conviction]').slice(inputtohide, 4).each(function(){
    $(this).hide().rules("remove", {required: "#convictions_0:checked" });
}); 
```

Hope this helps !

# jquery - 我正在尝试设置 Trent 的 datetimepicker 和 timepicker

> ID：11023508
> 
> 赞同：0
> 
> 时间：2012-06-13T21:22:46.150
> 
> 标签：jquery, datepicker, datetimepicker, timepicker

我正在尝试设置 Trent 的 datetimepicker 和 timepicker。我有 jQuery Datepicker 设置和工作。我添加了文档所说的所有内容，但无法使其正常工作。这是我的测试页面的链接，其中 datepicker 正在工作，但 datetimepicker 没有。 [http://testsite.shadownetwest.com/datepicker4/index2.html](http://testsite.shadownetwest.com/datepicker4/index2.html)

谁能告诉我哪里出错了？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-13T21:52:08.297

Hiya**工作演示** [http://jsfiddle.net/HaxfY/1/show/](http://jsfiddle.net/HaxfY/1/show/) **或** [http://jsfiddle.net/HaxfY/1/](http://jsfiddle.net/HaxfY/1/)

您错过了这 2 个 src，如果我可以建议提及`type`输入并使用`/`:)结束它

希望这会有所帮助：（请随时在 jquery 代码中添加您的默认函数）

不要忘记接受答案。:P

**代码**

```
 <script type='text/javascript' src='https://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js'></script>
  <script type="text/javascript" src="http://code.jquery.com/ui/1.8.18/jquery-ui.min.js"></script> 
```

**和**

```
$(function(){

    $(".datepicker").datepicker({
        onSelect: function(){
            if ($('input[name="endDate"]').val() == '') {
              var edate = $('input[name="begDate"]').val();
              $('input[name="endDate"]').val(edate);
            }
        }
    });
     $('#timepicker').timepicker({});
     $("#datetimepicker").datetimepicker();

}); 
```

# amazon-ec2 - 具有弹性 IP 的 Amazon EC2 自动扩展实例

> ID：11023510
> 
> 赞同：8
> 
> 时间：2012-06-13T21:23:11.143
> 
> 标签：amazon-ec2, amazon-web-services, autoscaling

有没有办法让添加到自动缩放组的新实例与弹性 IP 关联？我有一个用例，我的自动缩放组中的实例需要在远程服务器上列入白名单，因此它们需要具有可预测的 IP。

我意识到有一些方法可以使用 API 以编程方式执行此操作，但我想知道是否还有其他方法。CloudFormation 似乎可以做到这一点。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-14T19:07:02.773

您可以使用手动或脚本 API 调用将弹性 IP 关联到 ASG 实例，就像对任何其他实例一样 - 但是，没有自动方法可以做到这一点。ASG 实例被设计为临时/一次性的，而 Elastic IP 关联违背了这一理念。

为了解决您的问题：白名单，您有几个选择：

1.  如果需要可预测源 IP 的系统位于 EC2 上并且在您的控制之下，您可以禁用 IP 限制并改用 EC2 安全组来保护流量
2.  如果系统不受您的控制，您可以使用弹性 IP 设置代理服务器，并让您的 ASG 实例使用代理处理出站流量
3.  您可以使用[http://aws.amazon.com/vpc/](http://aws.amazon.com/vpc/)来完全控制实例寻址，包括网络出口 IP——尽管这可能很耗时

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-02-10T20:03:43.533

我可以找到 3 种方法来做到这一点。Cloud Formation 只会使其自动化，但您需要先了解发生了什么。

1.-正如@gabrtv 提到的使用VPC，这有两种选择。1.1-在 VPC 内使用 NAT 网关将所有流量路由进出网关。网关将具有弹性 IP 和互联网流量，然后将您的服务器端的 NAT 网关列入白名单。在 AWS 文档中查找 NAT 网关。

1.2-创建一个虚拟专用网关/VPN 连接到您的数据中心的后端服务器，并通过它路由流量。1.2.a-在专用私有子网中创建您的实例。1.2.b-将您这边的整个子网列入白名单，来自该子网的任何请求都将被允许进入。 1.2.c 确保您在子网中的路由正确。

（我故意跳过 2，因为那是 1.2）

3.-懒惰的方式：利用 AWS Opsworks 做两件事：第一：分配弹性 IP 的资源池。第二：按需启动 LOAD 实例并自动从池中为它们分配一个弹性 ip。对于第二部分，您需要将 24/7 实例设为最小值，将 Load 实例设为 MAX。AWS Opsworks 现在允许 Cloud Watch 警报触发实例启动，因此它与 ASG 非常相似。Opsworks 的唯一缺点是实例不会终止，而是会在负载下降时停止，并且您必须事先“创建”实例。此外，您还依靠 Chef solo 来启动您的实例，但这是将 EIP 自动分配给我能找到的新创建实例的唯一方法。

干杯!

# php - PHP：根据文本文件检查用户输入？

> ID：11023511
> 
> 赞同：0
> 
> 时间：2012-06-13T21:23:20.610
> 
> 标签：php, regex, compare

我在文本文件中有以下街道名称和门牌号：

```
Albert Dr: 4116-4230, 4510, 4513-4516
Bergundy Pl: 1300, 1340-1450
David Ln: 3400, 4918, 4928, 4825
Garfield Av: 5000, 5002, 5004, 5006, 8619-8627, 9104-9113
.... 
```

该数据代表当地社区的边界数据（即社区内有哪些房屋）。

我想制作一个 PHP 脚本，它将接受用户的输入（以“4918 David Lane”或“3000 Bergundy”之类的形式）搜索此列表，并返回一个是/否响应该房子是否存在于边界内。

什么是解析输入（正则表达式？）并将其与文本列表进行比较的有效方法？

谢谢您的帮助！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-13T21:30:07.740

最好将此信息存储在数据库中，这样您就不必从文本文件中解析出数据。正则表达式通常也不适用于查找范围内的数字，因此也建议使用通用语言。

但是......如果你想用正则表达式来做（看看为什么这不是一个好主意）

查找街道使用的号码

```
David Ln:(.*) 
```

然后得到数字使用

```
[^,]* 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-13T21:33:47.113

您可以简单地将文件导入字符串。完成此操作后，将文件的每一行拆分为数组 so`Array(Line 1=> array(), Line 2=> array()`等。完成此操作后，您可以使用`:`. 之后，您只需在数组中进行搜索。不是最快的方法，但它可能比正则表达式更快。

您应该真诚地考虑使用数据库或重新考虑您的文件是怎样的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-13T21:46:56.513

试试这样的方法，将您的街道名称放入 test.txt 中。现在您可以在文本文件中获取详细信息，只需将其与您在表单中提交的值进行比较。

```
 $filename = 'test.txt';
        if(file_exists($filename)) {
            if($handle = fopen($filename, 'r')) {
                $name = array();
                while(($file = fgets($handle)) !==FALSE) {
                    preg_match('#(.*):(.*)#', $file, $match);
                    $array = explode(',', $match[2]);
                    foreach($array as $val) {
                        $name[$match[1]][] = $val;
                    }

                }
            }
        } 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-13T21:52:53.873

如前所述，使用数据库存储与您的街道名称相关的街道编号是理想的。我认为你可以用你的文本文件来实现它的一种方法是创建一个二维数组；将街道名称存储在第一个数组中，并将有效街道编号存储在它们各自的数组中。

在循环中逐行解析文件。解析街道名称并存储在数组中，然后使用嵌套循环解析*所有*数字（对于范围内的数字`1414-1420`，您可以使用附加循环来获取范围内的每个数字）并在初始中构建下一个数组街道名称数组元素。当你有你的二维数组时，你可以做一个简单的嵌套循环来检查它是否匹配。

我将尝试为您制作一些伪代码..

伪代码：

```
$addresses = array();
$counter = 0;
$line = file->readline
while(!file->eof)
{
  $addresses[$counter] = parse_street_name($line);
  $numbers_array = parse_street_numbers($line);
  foreach($numbers_array as $num)
    $addresses[$counter][] = $num;

  $line = file->readline
  $counter++;
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2015-12-07T18:01:03.863

最好将街道存储在带有 ID 的单独表中，并将数字存储在单独的表中，每个范围或数字和街道 ID 对应一行。

例如：

```
streets:

ID, street
-----------
1, Albert Dr
2, Bergundy Pl
3, David Ln
4, Garfield Av
...

houses:

street_id, house_min, house_max
-----------------
1, 4116, 4230
1, 4510, 4510
1, 4513, 4516
2, 1300, 1300
2, 1340, 1450
... 
```

在没有范围但只有一个门牌号的行中，您将最小值和最大值设置为相同的值。

您可以编写一个脚本，该脚本将解析您的 txt 文件并将所有数据保存到 db。这应该像几个循环和具有不同参数的explode() 和一些插入查询一样简单。

然后通过第一个查询，您将获得街道 ID

```
SELECT id FROM streets WHERE street LIKE '%[street name]%' 
```

之后你运行第二个查询并得到答案，那条街上是否有这样的门牌号

```
SELECT COUNT(*) 
FROM houses 
WHERE street_id = [street_id] 
    AND [house_num] BETWEEN house_min AND house_max 
```

在 [...] 中，您输入真实值，不要忘记转义它们以防止 sql 注入...

或者您甚至可以使用 JOIN 只运行一个查询。

此外，您应该确保您给定的门牌号码是整数，而不是浮点数。

# javascript - 现在为外部文件中的多个页面存储文档

> ID：11023515
> 
> 赞同：0
> 
> 时间：2012-06-13T21:24:08.133
> 
> 标签：javascript, jquery

我的10-15页每页里面有100-200行js`$(document).ready()`

将它们全部合并到一个外部文件中是否明智？我不明白那将如何工作。浏览器是否不必一次检查所有内容，甚至是当前页面上没有的功能？第二个问题可能是功能冲突。

请给我一些关于如何处理这个问题的提示。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-13T21:28:40.077

如果您的 js 文件变得太大，您可以将这些行拆分为多个文件。
请注意，100-200 行非常小。如果大小对你来说真的很重要，你应该缩小你的代码。

*“我们应该忘记小的效率，比如大约 97% 的时间：过早的优化是万恶之源”*

关于函数冲突，使用命名空间和闭包，并尽可能保持全局对象的清洁。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-13T21:30:41.563

这会是明智的吗？是的。你给浏览器一个大的可缓存块，他不必再担心什么会提高页面加载速度。将所有 onload 事件放在不同命名的函数中，并从相关页面调用它们，或者如果它们必须执行相同操作，则在不同页面上重用函数。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-13T21:33:11.970

您必须研究各种事情。

首先在可能的情况下将所有 js 删除到公共 cdn 对于 ex jquery 其次总是将所有 js 缩小并合并到一个文件中（同样适用于 css）

这里的好处是如果你有 10 个 js 文件，浏览器必须发出 10 个请求并分别接收每个文件。更不用说移动设备中每个域的请求数量了。

另一方面，如果所有文件都作为一个文件发送，则只有一个请求。你是对的，它会花费大量时间执行（或者至少检查所有准备就绪的东西），但是这个处理时间比文件不同时发生的请求时间要短得多。

# c# - 当 ItemsSource 正在使用异常时，操作无效 - 我做错了什么？

> ID：11023517
> 
> 赞同：0
> 
> 时间：2012-06-13T21:24:17.677
> 
> 标签：c#, wpf, xaml

我正在尝试将 2d 对象列表链接到内容控件。我遇到了一个我不明白的例外。有人可以为我澄清一下吗？（我尝试将 C# 中的 first.ItemsSource 属性设置为我在代码中声明的 NationMetrics 对象 - 它给了我同样的异常）

外部异常：

向“System.Windows.Controls.ItemCollection”类型的集合添加值引发了异常。

内部异常：

使用 ItemsSource 时操作无效。改为使用 ItemsControl.ItemsSource 访问和修改元素。

NationMetrics 类：

```
public class NationMetrics
{
     List<List<Field>> _Nations = new List<List<Field>>();

     public List<List<Field>> Nations { get { return _Nations; } set { _Nations = value; } }

} 
```

这是我的 MainWindow.xaml 中触发异常的片段

```
<Grid>
    <ItemsControl x:Name="first" ItemTemplate="{DynamicResource DataTemplate_Level1}" ItemsSource="{Binding Path=Nations, Source={StaticResource nationMetric}}" />
</Grid> 
```

这是我的 Window.Resources 的片段，它定义了nationMetric

```
<local:NationMetrics x:Name="nm" x:Key="nationMetric" /> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-14T02:59:49.670

你可以尝试这样的事情：

```
<Window.Resources>
    <DataTemplate x:Key="inner">
                    <TextBlock Content="{Binding}"/>
    </DataTemplate>

<DataTemplate x:Key="outer">
    <ItemsControl ItemsSource="{Binding}" ItemTemplate="{DynamicResource inner}">
        <ItemsControl.ItemsPanel>
            <ItemsPanelTemplate>
                <StackPanel Orientation="Horizontal"/>
            </ItemsPanelTemplate>
        </ItemsControl.ItemsPanel>
    </ItemsControl>
</DataTemplate>

</Window.Resources>

<ItemsControl x:Name="itemControl" ItemsSource="{Binding Path=Nations, Source={StaticResource nationMetric}}" ItemTemplate="{DynamicResource outer}"> 
```

这基本上确定列表中有一个列表并适当地进行绑定。我没有尝试过，但我认为这是方法！

其他资源：

[WPF：如何创建自定义项目控制面板？](https://stackoverflow.com/questions/4538881/wpf-how-to-create-a-custom-items-control-panel)

[将二维集合绑定到某个控件](https://stackoverflow.com/questions/5397153/binding-2-dimensional-collection-to-some-control)

# c# - C# 项目中的“优化代码”选项如何导致本机代码崩溃？

> ID：11023520
> 
> 赞同：0
> 
> 时间：2012-06-13T21:24:34.230
> 
> 标签：c#, visual-studio-2010, debugging, c++-cli

我有一个使用 SQLite 文件作为文件格式的 Windows 窗体应用程序。这些文件由通过 C++/CLI 包装器调用的本机代码创建，其中包括对托管代码的回调以进行进度/取消更新。这对于 32 位非常有效。我试图通过切换到 64 位来消除我的内存上限，但遇到了一个主要障碍。

当在本机代码中分配或释放内存时，我会遇到伪确定性崩溃，这让我想到了内存损坏。但它只发生在发布构建期间，并且仅在没有附加调试器的情况下发生。这是我的噩梦的细分：

```
配置位 优化 互操作 Dbg-symbols 运行时 带调试器 不带调试器
Release 32 on no no / MD no crash no crash
Release 64 on yes no /MD no crash no crash
Release 32 on yes no /MD no crash no crash
Release 64 on yes no /MD no crash crash
Release 64 on yes yes /MD no crash crash
释放 64 关 是 否 /MD 不崩溃 不崩溃
释放 64 关 是 是 /MD 不崩溃 不崩溃
Debug 32 off no yes /MDd no crash no crash
调试 32 关闭 是 是 /MDd 没有崩溃 没有崩溃
调试 64 关闭 是 是 /MDd 没有崩溃 没有崩溃
调试 64 on yes yes /MD no crash no crash
调试 64 on yes no /MD no crash no crash
调试 64 关 是 是 /MD 不崩溃 不崩溃
调试 64 关闭 是 是 /MDd 没有崩溃 没有崩溃
Debug 64 on yes yes /MDd no crash no crash
调试 64 on yes no /MD no crash no crash

```

“互操作”意味着我使用 GUI 应用程序中的 C++/CLI 包装器来运行本机解析器代码。我有一个用本机 C++ 编写的命令行驱动程序，并且在任何配置中都不会崩溃。

基本上调试配置永远不会崩溃，即使本机代码完全像发布代码一样编译！我比较了响应文件，它们是相同的，除了我为调试配置添加了 _NO_DEBUG_HEAP=1 。我怀疑在使用 /MD 和定义 NDEBUG 时会产生任何影响。那么我该如何调试这个噩梦呢？感觉这不是我的代码的问题。请不要要求一个小的复制品，我不知道如何制作它。但是代码都是开源的，所以如果有人想尝试重现这个代码，我会发布一个指向源代码的链接。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-13T22:48:19.527

Heisenbugs 通常是由内存踩踏（在托管代码中不会发生）或将内存中的垃圾视为有效数据引起的。

我已经搜寻了多个通常可重现的 heisenbug，这些问题归结为使用未初始化的变量，该变量将从另一个例程中获取堆栈中的任何内容。您的本机代码可能包含这样一个错误，当它获得一个值时会起作用，而当它获得另一个值时会崩溃。Debug vs release 并不能保证幕后的东西是一样的（毕竟，如果它是为什么会有这两种配置呢？）而且你可能在内存中有不同的垃圾。

优化器也可能有这样的效果。

我会尝试的一件事是：在本机代码中的第一个例程的局部变量中添加一个实质性结构。对它做一些事情以防止链接器剥离它。

这将移动事物，如果它是内存中的垃圾问题，这应该会改变行为。

# flash - 我可以将 papervision 3d 模型保存为 Flash CS6 中的图像吗？

> ID：11023525
> 
> 赞同：0
> 
> 时间：2012-06-13T21:25:03.263
> 
> 标签：flash, 3d, papervision3d

我正在考虑在我的项目中使用 Papervision 3d 和 Flash。

我怀疑我可以在 Flash CS6 中将 Papervision 3d 模型保存为图像（JPG 或 PNG）吗？

例如，我要从搅拌机中导入一个模型，然后将纹理应用到该模型。所以最终结果应该保存在我的服务器中作为图像（public_html/imageeditor/img/final.jpg） 可能吗？如果您有任何教程或参考，请提供给我，可以帮助我额外...

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-13T21:41:01.393

您可以使用`BitmapData.draw`将舞台上的某些内容“快照”成位图。

```
var container:Sprite = new Sprite(); //container 3D stuff will be in

//code putting the 3D stuff in the container

var snapshotBD:BitmapData = new BitmapData(container.width, container.height)
snapshotBD.draw(container); 
```

从那里，您可以在图像的 AS3 中创建一个新的位图：

`var bitmap:Bitmap = new Bitmap(snapshotBD);`

或者像`Bitmap`在 Flash 中一样将图像保存到服务器。

有关 的更多信息`BitmapData.draw`，请查看 Adob​​e 的[文档](http://help.adobe.com/en_US/FlashPlatform/reference/actionscript/3/flash/display/BitmapData.html#draw%28%29)。

# java - 套接字最后总是超时

> ID：11023527
> 
> 赞同：0
> 
> 时间：2012-06-13T21:25:11.843
> 
> 标签：java, sockets, exception, timeout

我有一个代码，我需要从设备中捕获一些信息。本设备有插座连接。基本上是这样的：

我发送一个命令并返回：

```
<some info>
<some info>
<some info>
<some info>

1.551
1.689
... (A bunch of those numbers)
1.258

<more info> 
```

我需要一部分，但对我来说是垃圾。

第一次尝试是：

```
read <somne info>
reached empty line?
start getting the points
reached the points total amount?
break the loop 
```

这种工作。有时出于某种原因，我在套接字上进行的下一次读取（发送命令并期待单行答案）会给我这个套接字读取带来的一些垃圾。只是有时。

我试图这样做：

```
read <somne info>
reached empty line?
while !EOF
    is number?
    read
end 
```

所以。这阅读了我需要的一切。但是当到达终点时给了我一个 IOException: red timeout

我知道没有什么可以阅读的了，那我怎么能避免呢？

抱歉，我没有正确的实际代码，但基本上这就是问题所在：在此循环结束时出现读取超时异常：

```
while((line = readLine()) != null){
      //read stuff
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-13T21:31:51.580

如果没有任何内容可供读取，则对等方应该已关闭连接。然后你会得到你的空值，你可以结束你的结局。如果对等方没有这样做，并且超时时间足够长，您可以确信没有更多数据，那么超时就是您的证据，您既不能也不想避免它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-23T13:15:07.240

我找不到解决这个问题的简单方法。

我所做的是在读取块中插入一个 try/catch 块。所以，当我读完这些点时，我会转到读取到 EOF 的 try/catch 块。由于没有EOF，它会抛出一个IOExcpetion（读取超时）女巫我catchch，忽略它。继续。

我知道这不是最好的解决方案，但现在正在工作。

# python - Python 列出 HTTP 文件和目录

> ID：11023530
> 
> 赞同：17
> 
> 时间：2012-06-13T21:25:21.017
> 
> 标签：python, html, directory, ip-address

如果我只有一个 IP 地址，如何列出文件和文件夹？

使用 urllib 等，我只能显示`index.html`文件的内容。但是，如果我还想查看根目录中的文件怎么办？

我正在寻找一个示例来说明如何在需要时实现用户名和密码。（大多数时候 index.html 是公开的，但有时其他文件不是）。

* * *

## 回答 #1

> 赞同：37
> 
> 时间：2016-01-11T10:12:07.537

用于`requests`获取页面内容并`BeautifulSoup`解析结果。
例如，如果我们`iso`在以下位置搜索所有文件`http://cdimage.debian.org/debian-cd/8.2.0-live/i386/iso-hybrid/`：

```
from bs4 import BeautifulSoup
import requests

url = 'http://cdimage.debian.org/debian-cd/8.2.0-live/i386/iso-hybrid/'
ext = 'iso'

def listFD(url, ext=''):
    page = requests.get(url).text
    print page
    soup = BeautifulSoup(page, 'html.parser')
    return [url + '/' + node.get('href') for node in soup.find_all('a') if node.get('href').endswith(ext)]

for file in listFD(url, ext):
    print file 
```

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2012-06-13T22:16:26.707

正如另一个答案所说，您不能直接通过 HTTP 获取目录列表。是 HTTP 服务器“决定”给你什么。有些会给你一个 HTML 页面，显示“目录”内所有文件的链接，有些会给你一些页面（index.html），有些甚至不会将“目录”解释为一个。

例如，您可能有一个指向“http://localhost/user-login/”的链接：这并不意味着在服务器的文档根目录中有一个名为 user-login 的目录。服务器将其解释为指向某个页面的“链接”。

现在，要实现您想要的，您要么必须使用 HTTP 以外的其他东西（您要访问的“IP 地址”上的 FTP 服务器就可以完成这项工作），或者在该机器上设置一个 HTTP 服务器，为每个路径（http://192.168.2.100/directory）其中的文件列表（无论格式）并通过Python解析。

如果服务器提供“/bla/bla 索引”类型的页面（如 Apache 服务器所做的目录列表），您可以解析 HTML 输出以找出文件和目录的名称。如果没有（例如自定义 index.html，**或服务器决定给您的任何内容**），那么您就不走运了 :(，您不能这样做。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-06-13T21:29:36.100

HTTP 不适用于“文件”和“目录”。选择不同的协议。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2018-03-30T02:04:17.290

Zety 提供了一个不错的紧凑型解决方案。我将通过使`requests`组件更健壮和功能更强大来添加他的示例：

```
import requests
from bs4 import BeautifulSoup

def get_url_paths(url, ext='', params={}):
    response = requests.get(url, params=params)
    if response.ok:
        response_text = response.text
    else:
        return response.raise_for_status()
    soup = BeautifulSoup(response_text, 'html.parser')
    parent = [url + node.get('href') for node in soup.find_all('a') if node.get('href').endswith(ext)]
    return parent

url = 'http://cdimage.debian.org/debian-cd/8.2.0-live/i386/iso-hybrid'
ext = 'iso'
result = get_url_paths(url, ext)
print(result) 
```

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2016-11-17T17:34:06.443

您可以使用以下脚本获取 HTTP 服务器中子目录和目录中所有文件的名称。文件编写器可用于下载它们。

```
from urllib.request import Request, urlopen, urlretrieve
from bs4 import BeautifulSoup
def read_url(url):
    url = url.replace(" ","%20")
    req = Request(url)
    a = urlopen(req).read()
    soup = BeautifulSoup(a, 'html.parser')
    x = (soup.find_all('a'))
    for i in x:
        file_name = i.extract().get_text()
        url_new = url + file_name
        url_new = url_new.replace(" ","%20")
        if(file_name[-1]=='/' and file_name[0]!='.'):
            read_url(url_new)
        print(url_new)

read_url("www.example.com") 
```

# html - 在 Mac 上使用 Pandoc 进行递归目录解析

> ID：11023543
> 
> 赞同：5
> 
> 时间：2012-06-13T21:26:04.963
> 
> 标签：html, markdown, pandoc

[我发现这个问题](https://stackoverflow.com/a/10323583/1026064)对使用 Pandoc 执行批量转换的问题有答案，但它没有回答如何使其递归的问题。我事先声明我不是程序员，所以我在这里寻求一些帮助。

Pandoc 文档在将成批文件传递给可执行文件的细节上很少，并且基于脚本，Pandoc 本身似乎一次无法解析多个文件。下面的脚本在 Mac OS X 中工作得很好，但只处理本地目录中的文件并将结果输出到同一个地方。

`find . -name \*.md -type f -exec pandoc -o {}.txt {} \;`

我使用以下代码来获得我希望的结果：

`find . -name \*.html -type f -exec pandoc -o {}.markdown {} \;`

这个简单的脚本使用安装在 Mac OS X 10.7.4 上的 Pandoc 运行，将我运行它的目录中的所有匹配文件转换为 markdown 并将它们保存在同一目录中。例如，如果我有一个名为**apps.html**的文件，它会将该文件转换为与源文件位于同一目录中的**apps.html.markdown 。**

虽然我很高兴它进行了转换，而且速度很快，但我需要它来处理位于一个目录中的所有文件，并将降价版本放在一组镜像目录中进行编辑。最终，这些目录位于 Github 存储库中。一个分支用于编辑，而另一个分支用于生产/发布。此外，这个简单的脚本保留了原来的扩展名并附加了新的扩展名。如果我再次转换回来，它会在 markdown 扩展名之后添加 HTML 扩展名，并且文件大小会越来越大。

从技术上讲，我需要做的就是解析一个分支目录并将其与生产目录同步，然后当所有更改、删除和新内容验证正确时，我可以运行提交以发布更改。看起来 Find 命令可以处理所有这些，但我不知道如何正确配置它，即使在阅读了 Mac OS X 和 Ubuntu 手册页之后也是如此。

任何善意的智慧之言都将不胜感激。

TC

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-06-14T09:26:15.843

创建以下内容`Makefile`：

```
TXTDIR=sources
HTMLS=$(wildcard *.html)
MDS=$(patsubst %.html,$(TXTDIR)/%.markdown, $(HTMLS))

.PHONY : all

all : $(MDS)

$(TXTDIR) :
    mkdir $(TXTDIR)

$(TXTDIR)/%.markdown : %.html $(TXTDIR)
    pandoc -f html -t markdown -s $< -o $@ 
```

（注意：缩进的行必须以 TAB 开头——这在上面可能不会出现，因为降价通常会去掉标签。）

然后你只需要输入'make'，它就会对工作目录中每个扩展名为.html的文件运行pandoc，在'sources'中生成一个markdown版本。与使用“查找”相比，此方法的一个优点是它只会对自上次运行以来已更改的文件运行 pandoc。

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2013-05-29T09:55:55.473

仅作记录：这是我如何将一堆 HTML 文件转换为它们的 Markdown 等效文件：

```
for file in $(ls *.html); do pandoc -f html -t markdown "${file}" -o "${file%html}md"; done 
```

当您查看来自 -o 参数的脚本代码时，您会看到它使用字符串操作来删除以 md 文件结尾的现有 html。

# svg - 创建原生 SVG 来自 Illustrator/Gephi 的元素

> ID：11023553
> 
> 赞同：0
> 
> 时间：2012-06-13T21:26:45.117
> 
> 标签：svg, raphael, adobe-illustrator, gephi

我正在尝试向我在 Gephi 中制作的输出 SVG 的网络图添加交互性。我正在使用一个 Raphael 模板，该模板喜欢将我的节点输入为 SVG 圆圈。问题是我来自 Gephi 的 SVG 圆圈实际上是贝塞尔曲线。例如：

```
<path fill="#D52A2A" d="M663.395,426.958c0-2.869-2.324-5.194-5.193-5.194s-5.191,2.325-5.191,5.194
c0,2.867,2.322,5.189,5.191,5.189C661.069,432.148,663.395,429.826,663.395,426.958"/> 
```

有没有办法将这样的路径转换为具有 x、y 和半径的标准 SVG 圆形元素？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-14T09:10:44.087

您可以分析路径，但如果您知道哪些路径是从圆圈开始的，那么您可以像这样进行快速近似：

```
var p = document.querySelector("path");
var c = document.createElementNS("http://www.w3.org/2000/svg", "circle");
var b = p.getBBox();
c.cx.baseVal.value = b.x + b.width/2;
c.cy.baseVal.value = b.y + b.height/2;
c.r.baseVal.value = b.width/2; // assuming width and height are the same
p.parentNode.appendChild(c); 
```

提示您的路径是一个圆圈可能是 bbox 的宽度和高度非常接近相等，或者路径 'd' 属性 gephi 输出对圆圈始终使用相同的形式（不确定是否是这种情况）。

Gephi 是开源的，所以另一种选择是让它输出你想要开始的东西。

**更新：** [这是一个显示这个的 jsfiddle](http://jsfiddle.net/X6LDK/)。

# ide - Sublime Text 2 Snippets 的 toLowerCase 或大写函数

> ID：11023556
> 
> 赞同：10
> 
> 时间：2012-06-13T21:26:52.967
> 
> 标签：ide, sublimetext2

创建 Sublime Text 2 Snippets 时是否可以定义某种`capitalize()`或函数？`toLowerCase()`

例如：

```
<snippet>
<content><![CDATA[
<?php
class ${1} extends Datamapper
{
    var \$has_one = array();
    var \$has_many = array();
    var \$table = '${1}s';
    //constructor and other stuff next...
}
?>
]]></content>
<tabTrigger>dmm</tabTrigger>
</snippet> 
```

这个特定的片段帮助我动态创建 Datamapper ORM 模型。当我输入`dmm`代码片段时，我的光标同时放在两个区域；班级名称和作业`$table`。第一个游标需要大写，而第二个游标不需要。我可以强制 Snippet 的案例吗？就像是`{1.toLowerCase}`

简单的例子，但我可以想到其他时候可以使用它。

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2012-06-14T16:01:40.880

您可以使用[替换](http://docs.sublimetext.info/en/latest/extensibility/snippets.html)和[Perl 格式字符串语法](http://www.boost.org/doc/libs/1_44_0/libs/regex/doc/html/boost_regex/format/perl_format.html)

我已经测试了这段代码：

```
<snippet>
<content><![CDATA[
<?php
class ${1} extends Datamapper
{
    var \$has_one = array();
    var \$has_many = array();
    var \$table = '${1/(.+)/\L\1/g}s';
    //constructor and other stuff next...
}
?>
]]></content>
<tabTrigger>dmm</tabTrigger>
</snippet> 
```

问候， 阿曼多

# android - 异步填充 ArrayList 以显示在列表视图中

> ID：11023559
> 
> 赞同：0
> 
> 时间：2012-06-13T21:27:01.627
> 
> 标签：android, asynchronous, android-listview, android-listfragment

当用户单击一个按钮时，会显示一个新的 ListFragment。该片段将包含专辑列表及其关联的艺术家姓名。

我创建了自己的类`AlbumItem (String name, String artist)`，`name`其中包含专辑的标题和`artist`相应的艺术家姓名：

```
public class AlbumItem {

    private String AlbumName;
    private String AlbumArtist;

    public AlbumItem(){
    }

    public AlbumItem(String name, String artist){
        this.AlbumName = name;
        this.AlbumArtist = artist;
    }

    public String getAlbumName() {
        return AlbumName;
        }

    public void setAlbumName(String AlbumName) {
        this.AlbumName = AlbumName;
        }

    public String getAlbumArtist() {
        return AlbumArtist;
        }

    public void setAlbumArtist(String AlbumArtist) {
        this.AlbumArtist = AlbumArtist;
        }
} 
```

然后我编写了我的自定义适配器，它将专辑名称和艺术家名称与我的 ListView 行中的正确 TextView 相关联。

那么我可以声明一个 AlbumItem 的 ArrayList 并像这样填充它：

```
ArrayList<AlbumItem> arrayList;
arrayList.add(new AlbumItem ("Album's title", "Artist"); 
```

现在我有几个问题：

1）我走的路合适吗？我一直在学习填充这样的列表视图，并且我很喜欢使用这种技术（自定义项目类 + ArrayList + CustomAdapter），但我正在做一个音乐播放器，我想查询专辑列表并更新异步列表视图，以便 UI 不会被阻塞。我不知道是否可以按照我的方式将数据加载到 ArrayList 中。

2) 如何异步填充这个 ArrayList ？使用 LoaderManager/CursorLoader 或 Asyntask 或其他什么？（我的目标是 Android 4.0）

谢谢你的建议。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-13T21:39:45.627

CursorLoader 是一种加载列表的便捷方式，尤其是当您从数据库或其他本地数据源获取数据时。如果您的数据来自网络，使用 asynctask 获取数据并将其加载到列表适配器中可能会更容易。如果您熟悉其中之一，请使用它。

# xml - 键：选择前一个兄弟节点的最后一个子节点

> ID：11023568
> 
> 赞同：2
> 
> 时间：2012-06-13T21:27:38.550
> 
> 标签：xml, xslt, xpath

我有一些（格式错误的 DITA）XML 格式如下：

```
<dl>
<dlentry><dt>BLARG</dt>
<dd>BLARG Definition</dd>
<dt>BLARG2</dt>
<dd>BLARG2 Definition</dd></dlentry>
</dl>
<dl>
<dlentry><dt>BLARG3</dt>
<dd>BLARG3 Definition</dd></dlentry>
</dl>
<p>Continuation of BLARG3 definition.</p>
<note>Note pertaining to BLARG3 definition</note> 
```

等等。

我想做的是将这一系列`<dl>`元素合并为一个`<dl>`，如下所示：

```
<dl>
    <dlentry><dt>BLARG</dt>
       <dd>BLARG Definition</dd></dlentry>
    <dlentry><dt>BLARG2</dt>
       <dd>BLARG2 Definition</dd></dlentry>
    <dlentry><dt>BLARG3</dt>
       <dd>BLARG3 definition. Continuation of BLARG3 definition.
       <note>Note pertaining to BLARG3 definition</note></dd></dlentry>
<dl> 
```

我正在尝试根据前面的值使用键来索引任何`<p>`或`<note>`节点，如下所示：`generate-id()``<dd>`

```
<?xml version="1.0" encoding="UTF-8"?>
<xsl:stylesheet xmlns:xsl="http://www.w3.org/1999/XSL/Transform"
version="1.0">
<xsl:key name="kFollowing" match="p|note|table" use="generate-id(preceding::dd[1])"/>
  <!-- identity template -->
<xsl:template match="@*|node()" name="identity">
    <xsl:copy>
        <xsl:apply-templates select="@*|node()"/>
    </xsl:copy>
</xsl:template>
<xsl:template match="dl">
    <xsl:choose>
        <xsl:when test="count(preceding::dl)=0">
            <!--We only want to process the first dl. All others should be ignored, because their content will get included in this one.-->
            <dl>
                <!--Want to grab all following terms, except ones that contain phrase elements, which need to be turned into a table because they are field values-->
                <xsl:for-each select="following::dt[not(child::ph)]|descendant::dt">
                    <dlentry>
<dt><xsl:value-of select="normalize-space(.)"/></dt>
                        <xsl:variable name="ddID"><xsl:value-of select="generate-id(following::dd[1])"/></xsl:variable>
                        <dd><xsl:for-each select="following::dd[1]">
                            <xsl:apply-templates/><xsl:text>. </xsl:text>
                        </xsl:for-each>
                            <xsl:variable name="ddKey" select="key('kFollowing',generate-id(following::dd[1]))"/>
                            <xsl:for-each select="following::*[$ddKey]">
                               <xsl:apply-templates/>
</xsl:for-each>
                        </dd>
                    </dlentry>
                </xsl:for-each>
            </dl>   
        </xsl:when>
        <xsl:otherwise/>
    </xsl:choose>
</xsl:template> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-13T22:32:36.723

```
<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
    <xsl:output indent="yes"/>
    <!-- using a test root -->
    <xsl:template match="/test">
        <dl>
            <xsl:apply-templates select="dl/*/dt" />
        </dl>
    </xsl:template>

    <!-- assuming that we have always a dd for each dt -->
    <xsl:template match="dt">
        <dlentry>
            <xsl:copy-of select="."/>
            <dd>
             <xsl:value-of select="following::*[1]"/>
             <!-- just check the node after dd or dlentry or dl -->
             <xsl:apply-templates select="following::*[2]
                [local-name()='p' or 
                 local-name()='note' or 
                 local-name()='table']"/>
            </dd>

        </dlentry>
    </xsl:template>

    <xsl:template match="p|note|table">
        <xsl:copy-of select="."/>
        <!-- copy next node only if wanted -->
        <xsl:apply-templates select="following::*[1]
                [local-name()='p' or 
                 local-name()='note' or 
                 local-name()='table']"/>
    </xsl:template>

</xsl:stylesheet> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-14T02:18:13.963

**这种转变**：

```
<xsl:stylesheet version="1.0"
     xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
     <xsl:output omit-xml-declaration="yes" indent="yes"/>
     <xsl:strip-space elements="*"/>

     <xsl:key name="kFollowing" match="p|note"
      use="generate-id(preceding-sibling::dl[1]/dlentry)"/>

     <xsl:template match="node()|@*">
         <xsl:copy>
           <xsl:apply-templates select="node()|@*"/>
         </xsl:copy>
     </xsl:template>

     <xsl:template match="dl[1]">
      <dl>
       <xsl:apply-templates select="../dl/dlentry"/>
      </dl>
     </xsl:template>

     <xsl:template match="dd">
      <dd>
        <xsl:value-of select="."/>
        <xsl:copy-of select="key('kFollowing', generate-id(..))/self::p/text()"/>
        <xsl:copy-of select="key('kFollowing', generate-id(..))/self::note"/>
      </dd>
     </xsl:template>
     <xsl:template match="dl|p|note"/>
</xsl:stylesheet> 
```

**当应用于以下 XML 文档时**（提供的片段包装在单个顶部元素中）：

```
<t>
    <dl>
        <dlentry>
            <dt>BLARG</dt>
            <dd>BLARG Definition</dd>
            <dt>BLARG2</dt>
            <dd>BLARG2 Definition</dd>
        </dlentry>
    </dl>
    <dl>
        <dlentry>
            <dt>BLARG3</dt>
            <dd>BLARG3 Definition</dd>
        </dlentry>
    </dl>
    <p>Continuation of BLARG3 definition.</p>
    <note>Note pertaining to BLARG3 definition</note>
</t> 
```

**产生想要的正确结果：**

```
<t>
   <dl>
      <dlentry>
         <dt>BLARG</dt>
         <dd>BLARG Definition</dd>
         <dt>BLARG2</dt>
         <dd>BLARG2 Definition</dd>
      </dlentry>
      <dlentry>
         <dt>BLARG3</dt>
         <dd>BLARG3 DefinitionContinuation of BLARG3 definition.<note>Note pertaining to BLARG3 definition</note>
         </dd>
      </dlentry>
   </dl>
</t> 
```

我故意没有`". "`在两个文本节点之间生成分隔符，因为这没有被声明为要求并且可能只是 OP 的装饰。这样做需要一点额外的努力，留给读者作为练习:)。

# c# - VB的AvalonEdit折叠策略

> ID：11023569
> 
> 赞同：0
> 
> 时间：2012-06-13T21:27:44.743
> 
> 标签：c#, avalonedit

我正在开发一个支持脚本的 C# 应用程序。是否有`FoldingStrategy`用于 AvalonEdit 代码折叠的 Visual Basic 代码示例？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-06-06T15:21:47.670

我在这段代码中发现了两个错误。有两个超出范围的例外：

```
Do Until text(k - 1) = vbLf OrElse text(k - 1) = vbCr 
```

如果 k 运行到 0。我通过一行修复了它：

```
k -= 1
If k <= 0 Then Exit Do 
```

并在：

```
Dim startOffset As Integer = startOffsets.Pop() 
```

如果 startOffset 为空，则此选项通过以下方式固定：

```
If startOffsets.Count > 0 Then
    Dim startOffset As Integer = startOffsets.Pop()
    .....
End If 
```

但是折叠生成在 InlineSubs 上失败了。试试这个例子：

```
Public Class Window
    Public Sub New()
        InitializeComponent()

        AddHandler TextBox.TextChanged, Sub(TBsender As Object, TBe As EventArgs)
                                             CheckCode()
                                        End Sub
    End Sub
End Class 
```

我没有设法解决最后一个问题。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-31T03:12:09.170

这是我创建的一个似乎可以工作的...相当不错。并不完美，因为它没有考虑到许多可能的情况，但这是一个开始。

```
Imports ICSharpCode.AvalonEdit.Folding
Imports ICSharpCode.AvalonEdit.Document

Public Class VBNETFoldingStrategy
    Inherits AbstractFoldingStrategy

    Private foldableKeywords() As String = {"namespace", "class", "sub", "function", "structure", "enum"}

    Public Overrides Function CreateNewFoldings(document As ICSharpCode.AvalonEdit.Document.TextDocument, ByRef firstErrorOffset As Integer) As System.Collections.Generic.IEnumerable(Of ICSharpCode.AvalonEdit.Folding.NewFolding)
        firstErrorOffset = -1

        Dim foldings As New List(Of NewFolding)

        Dim text As String = document.Text
        Dim lowerCaseText As String = text.ToLower()

        For Each foldableKeyword In foldableKeywords
            foldings.AddRange(GetFoldings(text, lowerCaseText, foldableKeyword))
        Next

        Return foldings.OrderBy(Function(f) f.StartOffset)
    End Function

    Public Function GetFoldings(text As String, lowerCaseText As String, keyword As String) As IEnumerable(Of NewFolding)
        Dim foldings As New List(Of NewFolding)

        Dim closingKeyword As String = "end " + keyword
        Dim closingKeywordLength As String = closingKeyword.Length

        keyword += " "
        Dim keywordLength As String = keyword.Length

        Dim startOffsets As New Stack(Of Integer)

        For i As Integer = 0 To text.Length - closingKeywordLength
            If lowerCaseText.Substring(i, keywordLength) = keyword Then
                Dim k As Integer = i
                If k <> 0 Then
                    Dim lastLetterPos As Integer = i
                    Do Until text(k - 1) = vbLf OrElse text(k - 1) = vbCr
                        If Char.IsLetter(text(k)) Then lastLetterPos = k
                        k -= 1
                    Loop
                    If lastLetterPos > k Then k = lastLetterPos
                End If
                startOffsets.Push(k)
            ElseIf lowerCaseText.Substring(i, closingKeywordLength) = closingKeyword Then
                Dim startOffset As Integer = startOffsets.Pop()
                Dim newFolding As NewFolding = New NewFolding(startOffset, i + closingKeywordLength)
                Dim p As Integer = text.IndexOf(vbLf, startOffset)
                If p = -1 Then p = text.IndexOf(vbCr, startOffset)
                If p = -1 Then p = text.Length - 1
                newFolding.Name = text.Substring(startOffset, p - startOffset)
                foldings.Add(newFolding)
            End If
        Next

        Return foldings
    End Function
End Class 
```

# c++ - Windows上的Firebreath插件无法在chrome中加载

> ID：11023573
> 
> 赞同：0
> 
> 时间：2012-06-13T21:27:57.243
> 
> 标签：c++, windows, google-chrome, firebreath, gpgme

我正忙于通过现有的 firebreath 插件进行转换以使用[gpgme](https://github.com/RC1140/cr-gpg/tree/master/gmailGPG/generic)而不是通过操作系统和 gpg 二进制文件进行调用。

我已经设法在 x32 系统上使用 VS 2010 在 Windows 中编译代码，但是在将插件加载到 chrome 后，我根本无法访问 npapi 代码。即使是简单的版本调用也会失败。

加载插件时，我没有看到明显的错误，但是当使用 chrome 的 sawbuck 日志查看器时，我收到下面的错误消息。

```
.\renderer\webplugin_delegate_proxy.cc  347 PluginMsg_Init returned false
..\plugins\npapi\webplugin_impl.cc  271 Couldn't initialize plug-in 
```

我尝试将我的代码与 firebreath 1.4 和 1.6 一起使用，但两个版本都不起作用。经过一些简单的调试后，似乎使用 gpgme 提供的任何代码（无论是否调用）都会导致插件中断。

我通过以下操作得出了这个结论。

1.  使用 firebreath 创建了一个新项目（版本 1.4 和 1.6）
2.  将 gpgme.h 标头添加到 gmailGPGAPI.cpp 中，除了将所需的引用路径添加到项目中之外，没有进行任何其他更改。
3.  构建项目以创建 dll（这会很好地生成 dll）。
4.  将我项目中现有的ddl替换为第2步中的dll，并用下面这段代码进行测试

> plugin = document.createElement('object'); plugin.id = '插件';
> plugin.type = '应用程序/x-gmailtest';
> document.body.appendChild(插件);
> console.log("我的插件返回："+ plugin.valid);
> console.log("我的插件返回：" + plugin.version);

1.  这会返回 valid = true 并且版本会返回我设置的内容。
2.  然后我修改了 gmailGPGAPI.cpp，现在通过在 version 方法中调用 gpgme_check_version(NULL) 返回 gpg 版本。我使用该方法是因为它可能是我可以测试的最简单的返回函数。
3.  构建插件并将 dll 复制到 chrome 扩展，如步骤 3-4 所示。该插件按预期再次构建良好。
4.  加载插件并尝试执行步骤 4 中的代码，此时它现在只为我尝试在插件上访问的任何属性或方法返回未定义。除了记录到 sawbuck 的错误外，不会在控制台或 chrome 中的任何其他地方打印任何错误。

我不知道去哪里看或尝试什么，因为我似乎无法解决可操作的错误。我还通过测试代码减少了它只是一个带有一行更改的新项目，以便更容易找到问题。

我应该注意 repo 中的代码在 linux/OSX 中构建良好并正确加载到 chrome 中，所以我知道在某种程度上我的代码确实有效。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-13T21:44:52.173

两种可能的路径：

1.  您可能有一个不可用的 DLL 依赖项，导致插件无法加载；如果你在它不能在 chrome 上运行的状态下运行 regsvr32，它可以工作吗？
2.  您的插件可能正在加载然后崩溃。使用 --plugin-startup-dialog 启动 chrome，然后当它弹出一个对话框，警告您即将加载插件时附加到该进程并查看该进程是否崩溃。此时，您还可以设置断点来尝试弄清楚它走了多远。

仔细检查 PluginConfig.cmake 中的元数据；有时某些字段中的异常字符会导致此类问题。

# php - 如何按键的值对带有 stdClass 对象的多维数组进行排序？

> ID：11023576
> 
> 赞同：4
> 
> 时间：2012-06-13T21:28:11.263
> 
> 标签：php, arrays, sorting

是的，我已经搜索并尝试了许多技术，但似乎没有任何效果。这是我的数组：

```
Array
(
    [0] => stdClass Object
        (
            [id] => 119
            [name] => Business3
            [start_date] => 1338789600
            [end_date] => 1354604400
        )

    [1] => stdClass Object
        (
            [id] => 153
            [name] => Business1
            [start_date] => 1338962400
            [end_date] => 1370498400
        )

    [2] => stdClass Object
        (
            [id] => 135
            [name] => Business2  
            [start_date] => 1339653600
            [end_date] => 1356937200
        )
) 
```

我基本上想按名称键对其进行排序，但是我在 Stackoverflow 上尝试过的每个功能似乎都不起作用，例如，我得到一个没有错误的空白页。

我试过这个：

```
function array_sort_by_column(&$arr, $col, $dir = SORT_ASC) {
    $sort_col = array();
    foreach ($arr as $key=> $row) {
        $sort_col[$key] = $row[$col];
    }

    array_multisort($sort_col, $dir, $arr);
}

array_sort_by_column(json_decode(json_encode($businesses), true), 'name'); 
```

但这没有用。

有任何想法吗？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-06-13T21:39:22.910

您几乎是对的，但`$row[$col]`尝试像数组一样访问对象。你想要类似的东西`$row->{$col}`。这是一个更简单的工作示例：

```
$db = array(
  0 => (object) array('name' => 'Business3'),
  1 => (object) array('name' => 'Business2'),
  2 => (object) array('name' => 'Business1')
);

$col  = 'name';
$sort = array();
foreach ($db as $i => $obj) {
  $sort[$i] = $obj->{$col};
}

$sorted_db = array_multisort($sort, SORT_ASC, $db);

print_r($db); 
```

输出：

```
Array
(
    [0] => stdClass Object
        (
            [name] => Business1
        )

    [1] => stdClass Object
        (
            [name] => Business2
        )

    [2] => stdClass Object
        (
            [name] => Business3
        )

) 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2015-01-18T14:48:01.420

```
usort($array, function($a, $b) {
    return strcmp($a->name, $b->name);
}); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-13T21:38:25.977

你应该使用[usort](http://php.net/manual/en/function.usort.php) ...

因此，您定义了一个比较两个对象的函数（通过 name 字段），然后在数组上运行 usort，将函数作为第二个参数传入。

像这样的东西：

```
function cmp($a, $b)
{
    if ($a["name"] == $b["name"]) {
        return 0;
    }
    return ($a["name"] < $b["name"]) ? -1 : 1;
}

usort ($my_array, "cmp");
var_dump($my_array); 
```

希望有帮助！

本

# php - 使用 php 从网站清除 cookie

> ID：11023578
> 
> 赞同：0
> 
> 时间：2012-06-13T21:28:15.217
> 
> 标签：php, cookies

当有人在我的网站中运行 php 脚本时，我想清除用户浏览器中特定网站的所有 cookie。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-13T21:32:20.013

浏览所有 cookie 并运行：

`setcookie("cookie_name", $site_name, time()-timeout);`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-13T21:33:55.943

您不能这样做，因为浏览器维护该网站的 cookie，而不是您的网站。这将违反 Web 服务器和浏览器之间的合同。

此外，由浏览器以它认为合适的方式处理 cookie - 毕竟 cookie 要求浏览器通过在来自该服务器（域）的网页访问之间存储一些信息来帮助 Web 服务器。

但是，如果 cookie 来自您的域/服务器，那么您可以要求浏览器让它们超时或给它们一个无效值。

# c# - SOLID：允许同类构造函数调用？

> ID：11023579
> 
> 赞同：3
> 
> 时间：2012-06-13T21:28:16.273
> 
> 标签：c#, dependency-injection, solid-principles

真正 SOLID 代码的一个重要特性是构造函数调用并不经常发生在实际应用程序代码中，而是主要在必要的组合根和工厂方法中发生。这对我来说很有意义，我会尽可能地坚持这一点。

我创建了一个简单的类，在我看来，它不仅是允许的，而且实际上是正确的，可以偏离上述规则。这抽象了一些简单的 Registry 查询，以方便对其他一些代码进行单元测试：

```
public class RegistryKeyProxy : IRegistryKey
{
    private RegistryKey registrykey;

    public RegistryKeyProxy(RegistryKey registrykey)
    {
        this.registrykey = registrykey;
    }

    public IRegistryKey OpenSubKey(string subKeyName)
    {
        var subkey = this.registrykey.OpenSubKey(subKeyName);

        return (null == subkey ? null : new RegistryKeyProxy(subkey));
    }

    public IEnumerable<string> GetSubKeyNames()
    {
        return this.registrykey.GetSubKeyNames();
    }

    public object GetValue(string valueName)
    {
        return this.registrykey.GetValue(valueName);
    }
} 
```

该`OpenSubKey()`方法实际上在不使用工厂的情况下创建了同一个类的实例，但是由于 Registry 呈现的封闭概念，我实际上似乎不希望返回*任何*看起来像 Registry 键的东西，但实际上确实可以正常工作的东西与当前对象相同。

我知道最终取决于我想要工作的 SOLID 程度，但我想知道由于基本概念的性质，这通常是否是可行的路径，或者这是否不是例外遵守规则，但实际上违反了 SOLID。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-14T09:58:26.780

你说的是[依赖倒置原则](http://en.wikipedia.org/wiki/Dependency_inversion_principle)。这个原则并不是说你根本不应该新建对象，但它区分了两种类型的对象。实现行为的对象（服务），以及包含数据的对象（DTO、值类型、实体）。

不更新 DTO 是相当愚蠢的，因为没有要抽象的行为。它们只包含数据。（就像将`IPerson`接口添加到`Person`DTO 一样愚蠢）。

Miško Hevery 称它们为injectables[和newables](http://misko.hevery.com/2008/09/30/to-new-or-not-to-new/)，这是一个很好的术语。

有关更多信息，请参阅这个 Stackoverflow 问题：[为什么不使用 IoC 容器来解决实体/业务对象的依赖关系？](https://stackoverflow.com/questions/4835046)

# linked-list - 指针接收器的 nil 不一致（Go bug？）

> ID：11023593
> 
> 赞同：6
> 
> 时间：2012-06-13T21:29:20.797
> 
> 标签：linked-list, go

当我偶然发现这种明显的不一致时，我正在做一个简单的链表接口来了解 Go 接口。`nextT`总是 nil 但返回值`next()`不是。

```
package main

import (
    "fmt"
)

type LinkedList interface {
    next() LinkedList
}

type T struct {
    nextT *T
}

func (t *T) next() LinkedList {
    //uncomment to see the difference
    /*if t.nextT == nil {
         return nil
    }*/
    return t.nextT//this is nil!
}

func main() {
    t := new(T)
    fmt.Println(t.nextT == nil)

    var ll LinkedList
    ll = t
    fmt.Println(ll.next() == nil)//why isn't this nil?
} 
```

没有零检查（我不应该这样做），`next()`我得到

```
true
false 
```

有了它，我得到了预期的结果

```
true
true 
```

我是否发现了一个错误，或者出于某种原因，这个惊喜是故意的？使用 zip 安装在带有 Go 版本 1 的 Windows 上运行（无 MSI）

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-06-13T22:38:23.977

不，这不是错误。Go 中的接口基本上是一对两个值：类型信息和指向实际数据的指针。将无类型值分配`nil`给接口，这也恰好是接口的零值，意味着该接口既没有类型信息，也没有指向存储的任何数据的指针。

另一方面，将`*T`指针分配给接口，将相应地设置类型信息，并让数据指针指向该指针。在这种情况下，接口`nil`不再存在，因为您在其中存储了具有特定值的特定类型。在您的情况下，您存储的值恰好为零。您可以使用类型断言（或[反射](http://golang.org/pkg/reflect/)包）来检查接口是否分配了特定类型。类型断言只有在类型信息匹配时才会成功（如果您之前已将 nil 分配给该接口，显然永远不会出现这种情况）。如果测试成功，你会得到一个`*T`返回，但是这个指针可能仍然有值`nil`（这是该类型的有效值）。

查看 Go 标准库中的[container/list](http://golang.org/pkg/container/list/)包，了解更惯用的通用链表实现。还有一篇 Russ Cox 的[优秀文章](http://research.swtch.com/interfaces)，其中包含对 Go 接口类型的深入解释。

# elasticsearch - 如何在 Heroku Cedar Stack 上使用 ElasticSearch 和 Tire 获得 Rails 3.1？

> ID：11023598
> 
> 赞同：2
> 
> 时间：2012-06-13T21:29:57.317
> 
> 标签：elasticsearch, heroku, tire, cedar, bonsai-elasticsearch

我在使用 ElasticSearch 和 Heroku Cedar 堆栈上的 Bonsai 插件时遇到问题。它不断使我的应用程序崩溃，当我检查 Heroku 日志（即`heroku logs`在终端中运行）时，我`Errno::ECONNREFUSED (Connection refused - connect(2))`.

该设置在我的本地主机上运行良好。我已经浏览了 Elastic 搜索资源，但还没有找到解决办法。

谁能提供一些帮助或指导？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-13T21:41:15.423

我终于找到了它......通过 Heroku Bonsai 上的一个不起眼的链接帮助。我这样做了，它奏效了：[Configuring Tire to use the Bonsai ElasticSearch Heroku add-on](https://gist.github.com/2041121)

这里有一些关于我做了什么来修复它的更多说明。在`config/initializers/bonsai.rb`：

```
 if ENV['BONSAI_INDEX_URL']
   Tire.configure do
    url "http://index.bonsai.io"
   end
   BONSAI_INDEX_NAME = ENV['BONSAI_INDEX_URL'][/[^\/]+$/]
  else
    app_name = Rails.application.class.parent_name.underscore.dasherize
    app_env = Rails.env
    BONSAI_INDEX_NAME = "#{app_name}-#{app_env}"
  end 
```

# ruby-on-rails-3 - 具有子域（子子域？）的域上的子域约束和 url 助手

> ID：11023599
> 
> 赞同：1
> 
> 时间：2012-06-13T21:29:59.693
> 
> 标签：ruby-on-rails-3, rails-routing, subdomain

所以我已经阅读了有关如何使用 Rails 3 子域约束和 url 帮助器的所有内容，这对大多数应用程序都非常有用。例如，如果我想要一个管理子域（我这样做），我可以使用：

```
constraint :subdomain => :admin
  scope :module => :admin
    defaults :subdomain => 'admin' 
```

但是我的应用程序在许多（客户的）域上运行，并且通常在它的子域上运行。所以，像`directory.customer.com`. 现在，如果我将该逻辑应用于`admin.directory.customer.com`，Rails 的东西`directory`是子域的一部分，所以我必须这样做：

```
constraint :subdomain => /^admin.*/
  scope :module => :admin
    defaults :subdomain => 'admin' 
```

这很棒，只需将任何统计信息与 admin 匹配的子域，但是在使用 url 帮助程序时，它不是很好，因为我设置的默认子域 ( `admin`) 不包括客户的子域部分 ( `directory`)。

将 :host 选项设置为`directory.customer.com`似乎无法解决此问题，url 帮助程序仍然返回`admin.customer.com`. 有什么方法可以设置它，以便 url 助手“知道”它`directory.customer.com`是 :host 的全部部分，并且子域不应该覆盖主机名的那部分？必须有一种我可以修改的方法，或者让它保持主机名完整的方法，对吧？

# mysql - MySQL 按日期排序（MD、Y、H:M:S am\pm）

> ID：11023600
> 
> 赞同：0
> 
> 时间：2012-06-13T21:30:01.233
> 
> 标签：mysql, date

我一直在搞砸这几个小时，尝试按日期排序的不同方式。我希望有一个 strtotime(field) 可以满足我的需要。

我试过弄乱 UNIX_TIMESTAMP、STR_TO_DATE，但我就是想不通。

我正在尝试将这些按以下顺序排列：

```
June 13, 2012, 4:45:28 pm
May  31, 2012, 10:41   am
June 12, 2012, 6:40:34 pm
June 06, 2012, 3:05:22 am
June 10, 2012, 7:59:31 pm 
```

我尝试了很多不同的方法，这是我一直在研究的最新方法......

```
SELECT name,lastonline FROM `users` ORDER BY STR_TO_DATE(UPPER(lastonline),
       '%M %d,%Y, %H:%i:%s') DESC 
```

似乎这是我能得到的最接近的结果，并且没有考虑“AM”或“PM”。我已经尝试在末尾添加 %p ，但由于某种原因，就好像 UPPER 根本没有做任何事情。我也尝试过使用 %r。

有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-13T21:41:08.007

MySQL[文档](http://dev.mysql.com/doc/refman/5.5/en/date-and-time-functions.html#function_date-format)说，应将 12 小时时间和 AM/PM 的构造解析为`%r`一体，而不是`%H:%i:%s %p`.

虽然我认为这是一个错误功能，但它确实有效。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-13T21:44:05.330

您可以`HH24`改用以获得完整的小时数。

# javascript - 尝试通过传入函数来绑定回调会引发错误

> ID：11023605
> 
> 赞同：5
> 
> 时间：2012-06-13T21:30:18.057
> 
> 标签：javascript, jquery, events, backbone.js, jquery-1.7

我只想在输入使用 jQuery 1.7.2 和 Backbone.js 更改值时触发一个事件。

目前我有以下（有效）

```
MyView: Backbone.View.extend({
  initialize: function() {

    this.colorInput = $("<input />", {
         "id": "color",
         "name": "color",
         "value": this.model.get("color")
    });

    var self = this;
    this.colorInput.on("change", function() {
      self.changeColor();
    });

  },
  changeColor: function() {
    var color = this.colorInput.val();
    this.model.set("color", color);
  }
}); 
```

我试图以另一种方式来做，我只是传入我的函数。

```
this.colorInput.on("change", this.changeColor, this); 
```

但是当试图这样做时，它会抛出错误

> ((jQuery.event.special[handleObj.origType] || {}).handle || handleObj.handler).apply 不是函数
> .apply(matched.elem, args);

（[第 3332 行](https://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.js)）

我无法弄清楚。任何想法为什么这种方式不起作用？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-06-13T22:01:14.700

你让[jQuery`on`](http://api.jquery.com/on/)感到困惑：

> **.on( events [, selector] [, data], handler(eventObject) )**
> **.on( events-map [, selector] [, data] )**

与[骨干的`on`](http://backbonejs.org/#Events-on)：

> **object.on（事件，回调，[上下文]）**

Backbone 将上下文作为第三个参数，而 jQuery 则没有。看起来 jQuery`on`正在将您的第三个参数解释为 the`handler(eventObject)`并尝试像函数一样调用它，这将解释您看到的错误消息。

通常你会这样做：

```
MyView: Backbone.View.extend({
  events: {
    'change input': 'changeColor'
  },
  initialize: function() {
    this.colorInput = $("<input />", {
       "id": "color",
       "name": "color",
       "value": this.model.get("color")
    });
  },
  render: function() {
    this.$el.append(this.colorInput);
    return this;
  },
  changeColor: function() {
    var color = this.colorInput.val();
    this.model.set("color", color);
  }
}); 
```

并让 Backbone 的事件委托系统处理事情。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2015-06-14T14:42:44.713

这是给遇到这个问题的谷歌人的。我遇到了完全相同的问题，发生的事情是报告错误的位置和实际发生错误的位置在两个不同的地方。

一行代码已过时，看起来像

```
$('#modal').on('click', function(e) {
   // Execute invalid code here.
}); 
```

另一行代码类似：

```
$('#modal').on('click', function(e) {
   // Execute valid code here.
}); 
```

错误是第一次调用不是真正的函数，所以错误是准确的，被调用的第二个处理程序不是真正的函数，jQuery 无法完成它，但它总是表现得好像它发生在第二个函数调用上.

我会说，如果您遇到此错误，请删除任何可能触发的额外事件处理程序，看看是否可以解决问题。

# c# - C# 中的条件流写入

> ID：11023607
> 
> 赞同：0
> 
> 时间：2012-06-13T21:30:19.787
> 
> 标签：c#, filestream, code-formatting

假设我有一个成员列表，每个成员都是一个自定义对象：

```
public class pail
{
    public string milk;
    public string water;
    public string butter;
    public string beer;
}

public class AddToPail()
{
    private List<pail> _pailList = new List<pail>();
    PSVM(String[] args)
    {
        for(int i = 0; i < 200; i++)
        {
            pail newPail = new Pail();
            switch(i)
            {
                case 1:
                {
                    newPail.milk = "This pail has milk";
                }
                break;
                case 2:
                {
                    newPail.butter = "This pail has butter";
                }
                break;
                case 3:
                {
                    newPail.water = "This pail has water";
                }
                break;
                case 4:
                {
                    newPail.beer = "This pail has beer";
                }
                break;
            }
            _pailList.Add(newPail);
        }
        foreach (pail thisPail in _pailList)
        {
            using (StreamWriter SW = new StreamWriter(@"C:\pail.txt")
            {
                if (!thisPail.milk.IsNullOrEmpty())
                {
                    SW.WriteLine(thisPail.milk);
                }
                else if (!thisPail.butter.IsNullOrEmpty())
                {
                    SW.WriteLine(thisPail.butter);
                }
                else if (!thisPail.beer.IsNullOrEmpty())
                {
                    SW.WriteLine(thisPail.beer);
                }
                else if (!thisPail.water.IsNullOrEmpty())
                {
                    SW.WriteLine(thisPail.water);
                }
                else
                {
                    Console.Writeline("oops");
                }
            }
        }
    }
} 
```

假设我想设置一个仅打印真实值的 StreamWriter，而不必编写一百万个 if、else if、else 语句……在 C# 中有简单的方法或库来执行此操作吗？我基本上是在寻找一种仅以简洁明了的方式打印出真实值的方法。有人对我应该如何处理这个问题有任何建议吗？

非常感谢！

***编辑*** 所以这个的最终目标是我有一个大约有 20 个成员的对象。对象会自动填充，填充脚本可以将某些成员留空。我希望能够以 CSV 格式打印成员，而不必有 20 个 if 语句来查看对象中的特定成员是否在通过 streamwriter 输出之前已被实例化。

***编辑 2***

我将代码更改为更接近我需要它做的事情。抱歉之前的解释不好。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-13T21:40:03.013

我认为你应该稍微重构你的程序。对于初学者，我将使用枚举作为存储桶内容：

```
public enum EBucketContents { Milk, Water, Butter, Beer }; 
```

然后，您可以使用字典，而不是布尔值列表：

```
var pail = Dictionary<EBucketContents,bool>(); 
```

现在只输出那些是真的很简单：

```
foreach( var kvp in pail.Where( x => x.Value ) ) {
    SW.WriteLine( "pail has " + kvp.Key.ToString().ToLower() )
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-13T21:39:57.483

如果您只想节省一些输入，请使用此扩展方法：

```
internal static class Extensions
{
    public static void WriteLineIf(this TextWriter tw, bool condition, string text)
    {
        if (condition)
        {
            tw.WriteLine(text);
        }
    }
} 
```

但看起来只有其中一个布尔值是真的，因为你使用的是`else if`块。

在这种情况下，使用和枚举

```
internal enum Pail
{
    Butter,
    Milk,
    Water,
    Beer
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-14T05:05:02.273

当然使用字典可以解决你的问题，但我不是很喜欢这种解决方案，因为它会让你失去对所输入内容的控制，例如你最终可能会得到一个装有飞机的桶......我会像这样重构你的代码，试图给每个类自己的责任（顺便说一句，我不喜欢 AddToPail 作为类名，它更像是一个方法名）：

```
public class Pail
{
    public string milk;
    public string water;
    public string butter;
    public string beer;

   private bool everythingEmpty = true;

    public Pail(int i)
    {
            switch(i)
            {
                case 1:
                {
                    milk = "This pail has milk";
                    everythingEmpty = false;
                }
                break;
                case 2:
                {
                    butter = "This pail has butter";
                    everythingEmpty = false;
                }
                break;
                case 3:
                {
                    water = "This pail has water";
                    everythingEmpty = false;
                }
                break;
                case 4:
                {
                    beer = "This pail has beer";
                    everythingEmpty = false;
                }
                break;
            }
    }

    public void WriteToStream(StreamWriter SW)
    {
           if (everythingEmpty)
           {
               Console.Writeline("oops");
               return;
           }
           WriteToStream(milk, SW);
           WriteToStream(butter, SW);
           WriteToStream(beer, SW);
           WriteToStream(water, SW);
    }

    public static void WriteToStream(string content, StreamWriter SW)
    {
                if (!content.IsNullOrEmpty())
                {
                    SW.WriteLine(content);
                }
    }
}

public class AddToPail()
{
    private List<pail> _pailList = new List<pail>();
    PSVM(String[] args)
    {
        for(int i = 0; i < 200; i++)
        {
            pail newPail = new Pail(i);
            _pailList.Add(newPail);
        }
        foreach (pail thisPail in _pailList)
        {
            using (StreamWriter SW = new StreamWriter(@"C:\pail.txt")
            {
                thisPail.WriteToStream(SW);
            }
        }
    }
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-06-13T21:49:14.370

您可以只使用字典，其中键是字段名称，值是字段值。这样您就不需要检查输出是否已填充 - 您只需输出所有字段

只有设置了字典键，您的填充脚本才能填充字典键

然后你的streamwriter就可以走了

```
foreach(KeyValuePair<string, string> kvp in fieldsDict)
   sw.Write("Key: " + kvp.Key + ", Value: " + kvp.Value); 
```

甚至只是一个字符串/或枚举列表

例如

```
public class pail
{
    public List<string> Fields = new List<string>();
}

public class AddToPail()
{
    private List<pail> _pailList = new List<pail>();

    PSVM(String[] args)
    {
        for(int i = 0; i < 200; i++)
        {
            pail newPail = new Pail();
            switch(i)
            {
                case 1:
                {
                   newPail.Fields.Add("This pail has milk");
            }
            break;
         *** SNIP 
```

# php - 没有数据库的小型网站的网站结构

> ID：11023612
> 
> 赞同：-1
> 
> 时间：2012-06-13T21:30:40.437
> 
> 标签：php

我正在尝试设置一个系统，以尽量减少更新网站的人员的复杂性，因为我不会是更新日常内容的主要人员，也不会提供干净的 URL。

由于我无法使用数据库，所有内容都位于两个基本文件夹之一（/private/content 或 /private/utilities）。对于正常的每日更新，不需要访问实用程序（包含页面包装器 - 页眉、导航、页脚等）文件夹。这最大限度地减少了日常编辑器的可见代码量。

我创建了一个数组 ($allowedContent)，其中包含可访问的有效部分的列表。代码针对该数组进行测试，以验证用户没有尝试访问不适当的内容。使用下面的代码，这些请求将成功。其他一切都会失败。

*   www.example.com/
*   www.example.com/popup/*
*   www.example.com/test
*   www.example.com/hello
*   www.example.com/foobar

我的问题是：这种方法有什么突出的问题吗？

**.htaccess**

```
RewriteEngine On
#  Rules
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteRule . index.php 
```

**PHP**

```
// parse the URL
$requestURI = explode('/', $_SERVER['REQUEST_URI']);
//print_r ($requestURI);

// a list of non-restricted dynamic content
$allowedContent = array("test", "hello", "foobar");
$allowAccess = false; // assume hackers :o

// determine the section
if (!$requestURI[1]) { // none defined - use root/home
    $section = 'home';
    $skin = true;
    $allowAccess = true;
} elseif ($requestURI[1] == 'popup') { // popup - no skin
    $section = $requestURI[2];
    $skin = false;
    $allowAccess = true;
} else {
    if (in_array($requestURI[1], $allowedContent)) { // verify that the requested content is allowed / prevent someone from trying to hack the site
        $section = $requestURI[1];
        $skin = true;
        $allowAccess = true;
    } else { // this would be either a 404 or a user trying to access a restricted directory
        echo "evil laugh"; // obviously, this would change to a 404 redirect
    }
} 
```

添加了调用内容的代码

```
// call the relevant content pieces
if ($allowAccess == true) {
    if ($skin == true ) {
        // call wrapper part 1
        include $_SERVER['DOCUMENT_ROOT'] . '/private/utilities/wrapperOpen.php';

        // call aside
        include $_SERVER['DOCUMENT_ROOT'] . '/private/utilities/header.php';

        // call aside
        include $_SERVER['DOCUMENT_ROOT'] . '/private/utilities/aside.php';
    }

    // call CONTENT (based on section)
    include $_SERVER['DOCUMENT_ROOT'] . '/private/content/' . $section . '/index.php';

    if ($skin == true ) {
        // call branding
        include $_SERVER['DOCUMENT_ROOT'] . '/private/utilities/branding.php';

        // call footer
        include $_SERVER['DOCUMENT_ROOT'] . '/private/utilities/footer.php';

        // call wrapper part 2
        include $_SERVER['DOCUMENT_ROOT'] . '/private/utilities/wrapperClose.php';
    }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-13T21:45:22.407

这会奏效。您可能还会考虑使用 xml 来存储数据，但如果文件太大，您需要密切关注系统内存使用情况和加载时间。尽可能将它们分开。你不能说服他们使用数据库吗？带有数据库的虚拟主机很便宜。

# mysql - 无法登录到 phpMyAdmin，没有显示错误

> ID：11023619
> 
> 赞同：20
> 
> 时间：2012-06-13T21:31:26.553
> 
> 标签：mysql, linux, phpmyadmin

我在我的 linux 计算机上正确设置了 MySQL，但是我想要一种更好的方法来将数据输入到除了终端之外的数据库中。为此，我下载了 phpMyAdmin。但是，当我尝试从 index.php 登录到 phpMyAdmin 时，它什么也没做。似乎只是刷新页面而不做任何事情。我输入了正确的 MySQL 用户名和密码。问题是什么？

这是我单击“开始”后显示的屏幕截图。

![在此处输入图像描述](../Images/09420d638e94b258c2e53be238baefc8.png)

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2013-08-07T16:47:52.820

当保存 php_session 的路径未正确设置时，这可能是一个问题：

存储会话的目录不存在或 php 没有足够的权限写入它。

要定义 php_session 目录，只需将以下行添加到 php.ini ：

```
session.save_path="/tmp/php_session/" 
```

并赋予http服务器写权限。

通常，http 服务器作为组守护进程中的用户守护进程运行。如果是这种情况，以下命令将使它：

```
chown -R :daemon /tmp/php_session

chmod -R g+wr /tmp/php_session

service httpd restart 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2015-04-01T16:43:20.180

如果会话文件夹不可写，则登录失败。要检查这一点，请在您的 web 目录中创建一个 PHP 文件：

```
<?php
$sessionPath = 'undefined';

if (!($sessionPath = ini_get('session.save_path'))) {
    $sessionPath = isset($_ENV['TMP']) ? $_ENV['TMP'] : sys_get_temp_dir();
}

if (!is_writeable($sessionPath)) {
    echo 'Session directory "'. $sessionPath . '"" is not writeable';
} else {
    echo 'Session directory: "' . $sessionPath . '" is writeable';
} 
```

如果会话文件夹不可写

`sudo setfacl -R -m u:www-data:rwx <session directory>`或 chmod 777 `sudo setfacl -R -m u:www-data:rwx <session directory>` -

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-10-12T20:19:56.347

我用 MariaDB 和 phpmyadmin 在 CentOS 7 上解决了我的问题，我从官方 phpmyadmin 站点下载了

```
session.save_path = "/var/lib/php/session" 
```

到**/etc/php.ini**

和

```
chown -R :lighttpd /var/lib/php/session 
```

之后我还重新启动了 php-fpm 和 lighttpd

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2016-02-18T13:50:43.563

就我而言，解决方案是正确设置 Apache 设置：

```
ProxyPassReverseCookiePath 
```

这是必需的，因为**ProxyPass**和**ProxyPassReverse**正在使用中，但 cookie 路径不会自动更改。

如果 PHPMyAdmin 在使用 POST 发送密码时显示诸如 session not found 之类的东西，那就太好了。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2016-05-12T15:07:08.390

您是否在某个父目录中有一个 .htaccess 文件，该文件通过执行 301 重定向从 url 中剥离 index.php？

301 重定向会丢弃表单数据并重定向您，就好像您没有提交任何内容一样。因此，您将返回登录页面。

因此，您应该在 phpmyadmin 目录中用一行创建一个本地 .htaccess 文件`RewriteEngine On`。这会将之前的重写规则覆盖为空。

由于 Chrome 会主动缓存 301 重定向，您可能需要清除浏览器缓存。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2016-10-05T12:44:43.457

在我的情况下，硬盘驱动器已满。

用于`df -h`检查硬盘驱动器上的剩余空间，如果需要，可以使用`sudo apt-get clean`删除安装文件的命令释放一些空间。

我希望这将有助于一些未来的用户。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2017-01-09T23:37:47.280

我运行了这些命令，它对我有用：

```
sudo service httpd restart
sudo service mysqld stop
sudo service mysqld start 
```

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2017-07-12T16:54:35.407

我玩游戏迟到了，但是在 Amazon linux AMI 上我无法登录到 phpmyadmin ...它只是不断刷新登录屏幕而没有错误。

我已经用下面的命令修复了

```
sudo chmod -R 755 /var/lib/php/session 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2012-06-13T22:34:57.130

1.  尝试在网上搜索 phpMyAdmin 的安装或设置指南。查看其中的两个或三个，并确保您已涵盖所有必需的步骤。（如果您已经这样做了，请在问题中包含您遵循的指南）。
2.  看看它是否有助于编辑 config.inc.php（acecoder 也提到了这一点）。
3.  检查[本指南](http://www.if-not-true-then-false.com/2012/install-phpmyadmin-on-fedora-centos-red-hat-rhel/)是否有帮助。
4.  你在哪个发行版上？尝试搜索您正在使用的发行版的名称以及“phpMyAdmin guide”或“phpMyAdmin setup howto”。
5.  如果您在此过程中遇到错误，请在此处发布错误文本，如果它很短（或者如果它很长，则通过类似 pastebin 的网站粘贴）。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2014-02-24T23:45:47.620

你确定mysql正在运行吗？在进行数据库导入并填充包含 mysql 数据库的卷后，我遇到了同样的问题。更改各种权限并清除会话后，我尝试重新启动 mysql（/etc/init.d/mysql restart），但由于卷已满而失败。增加/var并成功启动mysql后，我就可以正常登录phpmyadmin了。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2014-10-15T07:45:56.123

如果您有如下错误：

由于许多连接错误，主机“host_name”被阻止。

以 root 身份登录 mysql 并运行 flush hosts 命令

1.- mysql -u root -p

2.- mysql > 刷新主机

在此之后，我能够再次登录 phpmyadmin

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2015-02-23T11:46:17.553

登录失败时，phpMyAdmin 将显示错误。如果没有，**则意味着您的设置有错误**。

最有可能检查的地方是您的**`php.ini`**设置。由于似乎没有与 phpMyAdmin 兼容的设置的官方列表，因此主要是反复试验。

确保您已[启用](https://serverfault.com/a/607202/87017)需要启用的内容。还要检查您是否没有启用*不常见*的php.ini 设置（如`enable_post_data_reading = Off`），因为 phpMyAdmin 假定它们是“常用设置”。

为了简化调试，从一个干净的[默认`php.ini`](https://stackoverflow.com/q/3588038/632951)文件开始，然后逐行调整它们以查看导致错误的设置。（不要忘记更改`php.ini`文件后需要重新启动服务器才能进行更改。）

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2016-04-12T19:17:44.313

就我而言，这是由于旧的 Apache 会话所致。停止 Apache，清除您`sessions.save_path`目录中的所有待处理会话（例如`/var/lib/php/session`：）并重新启动 Apache。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2017-04-05T11:18:25.490

确保在`$cfg['blowfish_secret']`值的“config.inc.php”中设置一个 32 字符长的随机键。这为我解决了它。

# facebook-graph-api - 共同好友 Facebook 通话似乎超时

> ID：11023624
> 
> 赞同：0
> 
> 时间：2012-06-13T21:31:49.873
> 
> 标签：facebook-graph-api

我正在尝试使用 Facebook iOS SDK 进行以下图形调用：

```
me/mutualfriends/<friend_id> 
```

使用调用：

```
NSString* mutualFriendsCall = [NSString stringWithFormat:@"me/mutualfriends/%@", friend_id];
[[delegate facebook] requestWithGraphPath: mutualFriendsCall andDelegate:self]; 
```

这有时有效，但经常（经常）返回以下错误：

```
Error message: An unknown error occurred 
```

其他电话，例如我/朋友，几乎 100% 的时间都在工作。

什么可能导致这种差异？

更新：如果您直接调用图形 api，这也是可重现的，因此它可能不是特定于 iOS。 [https://graph.facebook.com/me/mutualfriends/](https://graph.facebook.com/me/mutualfriends/)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-19T20:54:57.497

这似乎是一个已修复的 facebook 错误。

# ajax - Rails 3 Will_Paginate 与 Ajax 不更新部分

> ID：11023643
> 
> 赞同：0
> 
> 时间：2012-06-13T21:32:59.280
> 
> 标签：ajax, ruby-on-rails-3, response, will-paginate

我正在尝试使用[使用 Ajax 分页](http://asciicasts.com/episodes/174-pagination-with-ajax)中指定的 will_paginate gem 将一些 ajax 添加到我的分页中，并且我已经达到了可以在 Firebug 中看到正确 HTML 响应的程度，但它实际上并没有奇怪地呈现新代码足够。

这是我的简化代码：

索引动作

```
def index  
  @videos = Video.paginate :page => params[:page], :per_page =>  per_page
end 
```

index.html.haml

```
#box_content{:style => "padding: 1em;text-align:center;"}
  = render "video 
```

_video.html.haml

```
- @videos.each do |video|
    %iframe{:width=>"200", :height=>"150", :src=>link_src(video.link), :frameborder=>"0", :allowfullscreen =>"true"}
%div.pageinfo
    = will_paginate @videos 
```

应用程序.js

```
$(function () {  
    $('.pagination a').live("click", function () {  
        $.get(this.href, null, null, 'script');  
        return false;  
    });  
}); 
```

index.js.erb

```
$('#box_content').html("<%= escape_javascript(render("video")) %>"); 
```

当我点击 will_paginate 链接时，什么都没有发生，如果我查看网络 GET 响应，我会看到以下内容，这确实表明了一个新页面：

```
$('#box_content').html("<iframe allowfullscreen=\'true\' frameborder=\'0\' height=\'150\' src=\'http://www.youtube.com/embed/z52V60aZ7ro\' width=\'200\'><\/iframe>\n<div class=\'pageinfo\'>\n  <div class=\"pagination\"><a class=\"previous_page\" rel=\"prev start\" href=\"/?_=1339623038312&amp;page=1\">&#8592; Previous<\/a> <a rel=\"prev start\" href=\"/?_=1339623038312&amp;page=1\">1<\/a> <em class=\"current\">2<\/em> <a rel=\"next\" href=\"/?_=1339623038312&amp;page=3\">3<\/a> <a href=\"/?_=1339623038312&amp;page=4\">4<\/a> <a class=\"next_page\" rel=\"next\" href=\"/?_=1339623038312&amp;page=3\">Next &#8594;<\/a><\/div>\n<\/div>\n"); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-09T17:46:25.187

事实证明我实际上遇到了 Javascript 错误。我在 Firebug 控制台中没有看到它，因为 Javascript 被呈现为 html 而不是 javascript。然而，在萤火虫控制台中手动执行响应 javascript 让我看到了错误。

# ruby-on-rails - heroku 运行 rake db：迁移错误

> ID：11023645
> 
> 赞同：0
> 
> 时间：2012-06-13T21:33:11.983
> 
> 标签：ruby-on-rails, postgresql, heroku, rails-migrations

我想在我在 heroku 上的应用程序上运行迁移，但我收到此错误：

```
Running `rake db:migrate` attached to terminal... up, run.1
DEPRECATION WARNING: You have Rails 2.3-style plugins in vendor/plugins! Support for these plugins will be removed in Rails 4.0\. Move them out and bundle them in your Gemfile, or fold them in to your app as lib/myplugin/* and config/initializers/myplugin.rb. See the release notes for more on this: http://weblog.rubyonrails.org/2012/1/4/rails-3-2-0-rc2-has-been-released. (called from <top (required)> at /app/Rakefile:7)
DEPRECATION WARNING: You have Rails 2.3-style plugins in vendor/plugins! Support for these plugins will be removed in Rails 4.0\. Move them out and bundle them in your Gemfile, or fold them in to your app as lib/myplugin/* and config/initializers/myplugin.rb. See the release notes for more on this: http://weblog.rubyonrails.org/2012/1/4/rails-3-2-0-rc2-has-been-released. (called from <top (required)> at /app/Rakefile:7)
DEPRECATION WARNING: You have Rails 2.3-style plugins in vendor/plugins! Support for these plugins will be removed in Rails 4.0\. Move them out and bundle them in your Gemfile, or fold them in to your app as lib/myplugin/* and config/initializers/myplugin.rb. See the release notes for more on this: http://weblog.rubyonrails.org/2012/1/4/rails-3-2-0-rc2-has-been-released. (called from <top (required)> at /app/Rakefile:7)
Migrating to CreateUsers (20120525005302)
Migrating to DeviseCreateUsers (20120611000411)
==  DeviseCreateUsers: migrating ==============================================
-- create_table(:users)
rake aborted!
An error has occurred, this and all later migrations canceled:

PGError: ERROR:  relation "users" already exists
: CREATE TABLE "users" ("id" serial primary key, "email" character varying(255) DEFAULT '' NOT NULL, "encrypted_password" character varying(255) DEFAULT '' NOT NULL, "reset_password_token" character varying(255), "reset_password_sent_at" timestamp, "remember_created_at" timestamp, "sign_in_count" integer DEFAULT 0, "current_sign_in_at" timestamp, "last_sign_in_at" timestamp, "current_sign_in_ip" character varying(255), "last_sign_in_ip" character varying(255), "created_at" timestamp NOT NULL, "updated_at" timestamp NOT NULL) 

Tasks: TOP => db:migrate 
```

我的 github 存储库中有以下迁移文件

1.  20120525005302_create_users.rb（是空的，不知道怎么去掉）
2.  20120611000411_devise_create_users.rb
3.  20120613140535_create_authentications.rb

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-13T21:57:42.920

看起来以下是正确的：

*   `20120525005302_create_users.rb`将尝试`users`在您的数据库中创建一个表。
*   `20120611000411_devise_create_users.rb`还将尝试`users`在数据库中创建一个表。
*   您的数据库当前已经有一个`users`表，因此第二次迁移时迁移失败。

要使`users`数据库中的表与迁移正确对应`20120611000411_devise_create_users.rb`，您可以执行以下两项操作之一：

1.  回滚（或删除）数据库，然后再次运行迁移。`20120525005302_create_users.rb`（如果它是空的，您可以删除它。）
2.  在执行任何其他操作之前修改您的`20120611000411_devise_create_users.rb`迁移以删除任何现有表。`users`
3.  `20120611000411_devise_create_users.rb`如下 修改您的迁移：
    *   修改现有表，而不是创建`users`表。
    *   添加和修改数据库组件以对应

通常，如果您的应用程序处于“婴儿状态”，那么重新创建数据库往往是构建应用程序初始结构的快速方法。但是，如果您的`users`表中已经有重要数据，您将希望保留它并通过修改`20120611000411_devise_create_users.rb`迁移以非破坏性地更改数据库来继续。

**参考**

*   [在 Heroku 上运行 Rake 命令](https://devcenter.heroku.com/articles/rake)
*   [RailsGuides：迁移](http://guides.rubyonrails.org/migrations.html)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-13T21:42:47.603

看起来您已经有 device_create_users 正在尝试重新创建的表用户（可能来自 create_users 迁移）

您可以修改您的 create_device_users 迁移以仅添加您需要的字段

或者，如果它是一个没有用户的全新应用程序，您可以放弃并尝试重新运行所有迁移

# java - 如何处理中断异常

> ID：11023647
> 
> 赞同：1
> 
> 时间：2012-06-13T21:33:16.363
> 
> 标签：java, multithreading

> **可能重复：**
> [在 Java 中处理 InterruptedException](https://stackoverflow.com/questions/3976344/handling-interruptedexception-in-java)

不知该如何`InterruptedException`妥善处理。在 catch 块中应该执行哪些操作？在任何情况下应该将异常委托给更高级别的类？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-13T21:42:11.973

InterruptedException 的要点是允许阻塞方法在请求时提前取消。你不应该做的一件事是什么都不做；不要只是吞下例外。

如果你不能从你的方法中抛出异常，调用`Thread.currentThread().interrupt()`通常是一个不错的选择。

查看 Brian Goetz 的文章[http://www.ibm.com/developerworks/java/library/j-jtp05236/index.html](http://www.ibm.com/developerworks/java/library/j-jtp05236/index.html)，以获得有关该主题的良好讨论。编辑：看起来有人已经推荐了这篇文章——无论如何，这是一本好书。

# ios - 这些是我的泄密吗？

> ID：11023653
> 
> 赞同：0
> 
> 时间：2012-06-13T21:33:45.583
> 
> 标签：ios, memory-management, instruments, memory-leaks

当我在 Instruments 4.3 中分析我的应用程序时，我得到了一堆泄漏。有些小到 32 字节，有些只有几百字节。到目前为止，在我看来，这些似乎不是我的泄漏，因为它没有指向我的源代码的任何地方。

无论如何，这是所有泄漏的图像：

![在此处输入图像描述](../Images/3855e3b3865d0ebe6653928dcd8c48ae.png)

有谁知道这些泄漏是什么，如果我需要担心这些？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-13T21:39:53.020

在 XCode 中打开您的项目。按住“运行”，它将打开一个Tap，然后单击“分析”。这将指出您在代码中的泄漏

希望这可以帮助

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-19T22:11:33.143

事实证明，这些不是我在谷歌搜索后的泄漏。它们只是泄漏 UIKit 和 QuartzCore。所以我这边没有错！:)

# php - 尝试捕获 PHP 后选择查询

> ID：11023655
> 
> 赞同：-1
> 
> 时间：2012-06-13T21:33:48.890
> 
> 标签：php, mysql

任何人都知道为什么我的 sql 查询在使用 try catch 函数后不起作用？该代码是我每次都使用的常规代码，它运行良好，但是当我在尝试捕获函数后尝试使用它时，它不起作用，

```
try{
   //somecode
}
catch{
  // somecode
}
$carType = 'ECAR';
$category = substr($carType,0,1);
if($category){
    $querycy = ("SELECT * FROM carClassCodes where ClassC = '$category'");
    $resultcy = mysql_query($querycy);
    $rowcy = mysql_fetch_array($resultcy);
} 
```

提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-13T21:42:26.030

注意[文档](http://php.net/manual/en/language.exceptions.php)。它清楚地表明`catch`必须紧跟着要捕获的错误类型。在其最基本的形式中，它是`catch(Exception $e)`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-13T21:44:25.577

只需要在try函数之后添加连接，如果在try函数之前添加连接将不起作用，所以请务必在之后。

# javascript - 使用 jquery 对元素进行排序（数字可比较的问题）

> ID：11023667
> 
> 赞同：2
> 
> 时间：2012-06-13T21:34:48.063
> 
> 标签：javascript, jquery, sorting

我正在使用这个[非常方便的插件](http://james.padolsey.com/javascript/sorting-elements-with-jquery/)对元素进行排序。但是在数值上比较元素会产生不正确的结果：99、98、9、83、8、78 等。

这是插件的问题还是我实现它的方式的问题？

代码：

```
<html>
<head>
<script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js"></script>
<script language="javascript">
jQuery.fn.sortElements = (function(){
    var sort = [].sort;
    return function(comparator, getSortable) {
        getSortable = getSortable || function(){return this;};
        var placements = this.map(function(){

            var sortElement = getSortable.call(this),
                parentNode = sortElement.parentNode,
                nextSibling = parentNode.insertBefore(
                    document.createTextNode(''),
                    sortElement.nextSibling
                );

            return function() {

                if (parentNode === this) {
                    throw new Error(
                        "You can't sort elements if any one is a descendant of another."
                    );
                }
                parentNode.insertBefore(this, nextSibling);
                parentNode.removeChild(nextSibling);
            };

        });
        return sort.call(this, comparator).each(function(i){
            placements[i].call(getSortable.call(this));
        });
    };
})();

$(document).ready(function(){

    $('.item').sortElements(function(a,b){
        return $(a).html() < $(b).html() ? 1 : -1;
    });

});
</script>
</head>
<body>

<% for i = 0 to 100 %>
<div class="item"><%=i*Rnd%></div>
<% next %>

</body>
</html> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-13T21:38:54.020

如果要根据字符串的数值进行排序，则使用[`parseInt` ^(MDN docs)](https://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/parseInt)方法将字符串转换为数字

```
$('.item').sortElements(function(a,b){
        return parseInt($(a).html(),10) < parseInt($(b).html(),10) ? 1 : -1;
    }); 
```

（*或浮点数的[`parseFloat` ^(MDN 文档)](https://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/parseFloat)*，正如 Gaurav 在评论中提到的那样。 ）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-13T21:38:27.763

您正在比较字符串。在 Javascript`"88" < "9"`中，但是（显然）`88 > 9`，或（`+"88" > +"9"`）。您应该在比较函数中将字符串转换为数字：

```
return +$(a).html() < +$(b).html() ? 1 : -1; 
```

# php - Yii - 在模块中进行功能单元测试时出现 CHttpRequesterror

> ID：11023668
> 
> 赞同：1
> 
> 时间：2012-06-13T21:34:48.173
> 
> 标签：php, module, yii

当我尝试在 Yii 代码中执行模块的功能单元测试时，我不断收到以下错误：

```
CException: CHttpRequest is unable to determine the request URI. 
```

起初，我以为是因为它找不到模块。但是，如果我将 url 更改为错误的，我会得到一个正确的错误，表明它找不到视图。

这就是我的测试代码的样子

```
public function testViewControllerModule()
{
    ob_start();
    Yii::app()->runController('module/controller/view');
} 
```

关于我可能遗漏的任何想法？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-09-04T19:47:45.547

bool.devs 答案到目前为止有效。

这篇博文很好地解释了异常的起源：http:
[//mattmccormick.ca/2012/09/14/unit-testing-url-routes-in-yii-framework/](http://mattmccormick.ca/2012/09/14/unit-testing-url-routes-in-yii-framework/)

就我而言，我概括了解决方案并在 /www/protected/tests/bootstrap.php 中设置了以下变量：

```
...

$_SERVER['SCRIPT_FILENAME'] = 'index-test.php';
$_SERVER['SCRIPT_NAME'] =  '/index-test.php';
$_SERVER['REQUEST_URI'] = 'index-test.php';

Yii::createWebApplication($config); 
```

考虑使用**“index-test.php”而不是“index.php”**，因为它包含配置“test.php”，它负责固定装置以及其他与测试相关的配置。

如果有人有更好的建议，请随时发表评论：）

亲切的问候

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-21T03:03:19.520

我认为这是因为您没有设置任何服务器变量，即`$_SERVER`您可能在控制器中执行以下操作：

```
Yii::app()->request .... 
```

因此，在您运行测试之前，请确保您也使用了[服务器变量](http://php.net/manual/en/reserved.variables.server.php "http://php.net/manual/en/reserved.variables.server.php")的夹具。我认为现在应该足够了：

```
$_SERVER=array(
    'REQUEST_URI'=>'index.php', // the other fields should follow
); 
```

但是，要运行功能测试，我建议您使用 SeleniumRC，然后您就不必执行这些变通办法，并且我认为也可以模拟用户点击。

[阅读功能测试](http://www.yiiframework.com/doc/guide/1.1/en/test.functional "http://www.yiiframework.com/doc/guide/1.1/en/test.functional")的初始指南，阅读[selenium rc phpunit 指南](http://www.phpunit.de/manual/current/en/selenium.html "http://www.phpunit.de/manual/current/en/selenium.html")，以及[CWebTestCase 文档](http://www.yiiframework.com/doc/api/1.1/CWebTestCase "http://www.yiiframework.com/doc/api/1.1/CWebTestCase")。

注意：您可能仍然需要对某些变量使用固定装置，而且我在测试方面没有太多经验（这很糟糕），所以我不太确定我对硒的看法是否完全正确。

# c# - c# windows服务特殊文件夹异常

> ID：11023670
> 
> 赞同：1
> 
> 时间：2012-06-13T21:35:29.980
> 
> 标签：c#, windows-services, filesystemwatcher, special-folders

我开发了一个 Windows 服务应用程序。该服务所做的只是启动 filewatcher 并侦听正在创建的 .csv 文件，然后处理该文件。之前我们使用应用程序文件夹进行监控，但由于需要安全权限才能将文件复制到应用程序根目录中，我们决定将其路径更改为 My Documents 文件夹。在安装过程中安装程序完成后，将在 My Documents 文件夹下创建 ProductName 文件夹。（存档文件夹也在 ProductName 文件夹下创建。）安装后，我们有一个类似 My Documents\ProductName\Archive\ 的结构

当我们尝试启动服务时，它会停止，我们可以在事件查看器中看到的唯一异常是：

> 异常信息：System.ArgumentException 堆栈：在 System.IO.FileSystemWatcher.set_Path(System.String)

```
public partial class ServiceName : ServiceBase
{
    private readonly IMachineResultProcessos _controler;
    private readonly FileSystemWatcher _watcher;
    private readonly string _rootpath = Path.Combine(Environment.GetFolderPath( Environment.SpecialFolder.MyDocuments),"ProductName");

    public ServiceName()
    {
        InitializeComponent();
        _controler = new DataProcessos();
        _watcher = new FileSystemWatcher
                       {
                           Path = _rootpath + @"\Archive",
                           Filter = "*.csv"
                       };

        _watcher.Created += OnFileCreated;
        _watcher.EnableRaisingEvents = true;
    } 
```

}

它在调试下工作，但在客户端机器上部署时出现问题。

欢迎任何建议或想法。

# python - argparse 更改参数的定义

> ID：11023673
> 
> 赞同：3
> 
> 时间：2012-06-13T21:36:17.530
> 
> 标签：python, argparse

我设置我的参数解析器如下：

```
parser=argparse.ArgumentParser()
parser.add_argument('--point',help='enter a point (e.g. 2,3,4)')
parser.parse_args('--point=-2,5,6'.split())  #works
parser.parse_args('--point -2,5,6'.split())  #doesn't work :( 
```

有没有办法告诉 argparse 匹配正则表达式`r"-\d+.*"`的字符串不是选项，而是选项的参数？

另请注意，我*可以*这样做：

```
parser.add_argument('--point',nargs='*')
parser.parse_args('--point -2 5 6'.split()) 
```

但这并不是我真正想要的工作方式。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-14T14:18:47.060

我认为预处理 sys.argv 是这里最直接的方法。考虑例如：

```
import argparse, re

parser=argparse.ArgumentParser()
parser.add_argument('--point',help='enter a point (e.g. 2,3,4)')

args = '--point -2,5,6'.split() # or sys.argv

is_list = re.compile(r'^-?[\d,.]+$')
args = ['"%s"' % x if is_list.match(x) else x for x in args]
print parser.parse_args(args) 
```

这返回`Namespace(point='"-2,5,6"')`应该很容易解析。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-13T21:41:34.277

您可以更改[前缀 char](http://docs.python.org/library/argparse.html#prefix-chars)以便`-`不再被识别为指示参数的开始。它看起来确实有点奇怪，但是当参数中可能出现负数时它很有用。

```
import argparse
parser=argparse.ArgumentParser(prefix_chars = '@')
parser.add_argument('@@point',help='enter a point (e.g. 2,3,4)')
args = parser.parse_args('@@point=-2,5,6'.split())  #works
print(args)
# Namespace(point='-2,5,6')

args = parser.parse_args('@@point -2,5,6'.split())  #work also
print(args)
# Namespace(point='-2,5,6') 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-14T13:16:58.010

如果您不介意弄乱 argparse 内部结构，那么 argparse 已经做了一些与我想做的非常相似的事情。继承自的类之一`ArgumentParser`有这一行`__init__`

```
import re as _re
...
self._negative_number_matcher = _re.compile(r'^-\d+$|^-\d*\.\d+$') 
```

所以为了让我的例子起作用，我们只需要换出一个合适的正则表达式......

```
parser._negative_number_matcher = re.compile(r'^-\d+|^-\d*\.\d+') 
```

通常我不太赞成在类的内部使用下划线作为前缀（因为它依赖于实现并且容易更改） - 但是，在这种情况下，我认为它可能没问题因为：

*   如果 argparse 更改了该变量名，它不会受到伤害，我们只是回到“--print -2,3,4”不再起作用的情况。
*   我想不出比正则表达式更好的方法来确定某个东西是否是数字（我想他们可以尝试转换为浮点数并捕获异常，但如果他们这样做了，他们将不再有一个名为 _negative_number_matcher 的变量再一次， argparse 仍然可以正常工作，除非在这种极端情况下它没有做我想要的）

# php - 联系表格提交错误

> ID：11023675
> 
> 赞同：1
> 
> 时间：2012-06-13T21:36:44.473
> 
> 标签：php, javascript, validation, contact

如果有人可以通过我的代码并找到可能的错误，我已经尝试了一切，但我找不到错误。我的表单验证得很好，但是当提交并重定向到下一页时，它只是重新加载......

```
<?php
$your_email ='(i have removed e-mail)';

session_start();
$errors = '';
$name = '';
$visitor_email = '';
$user_message = '';

if(isset($_POST['submit']))
{

    $name = $_POST['form-name'];
    $visitor_email = $_POST['form-email'];
    $subject_email = $_POST['form-subject'];
    $user_message = $_POST['form-message'];
    $user_id = $_POST['form-id'];
    $telephone = $_POST['form-telephone'];
    ///------------Do Validations-------------
    if(empty($name)||empty($visitor_email))
    {
        $errors .= "\n Morate popuniti polja ime i e-mail. ";   
    }
    if(IsInjected($visitor_email))
    {
        $errors .= "\n Pogresno unet e-mail!";
    }
    if(empty($_SESSION['6_letters_code'] ) ||
      strcasecmp($_SESSION['6_letters_code'], $_POST['6_letters_code']) != 0)
    {
    //Note: the captcha code is compared case insensitively.
    //if you want case sensitive match, update the check above to
    // strcmp()
        $errors .= "\n Verifikacioni kod je pogresno unet!";
    }

    if(empty($errors))
    {
        //send the email
        $to = $your_email;
        $subject = "Nova poruka: $subject_email";
        $from = $_POST['form-name'];
        $ip = isset($_SERVER['REMOTE_ADDR']) ? $_SERVER['REMOTE_ADDR'] : '';

        $body = "Posetilac $name je poslao poruku sa web-sajta:\n".
        "Ime: $name\n".
        "Email: $visitor_email \n".
        "Poruka: \n ".
        "$user_message\n".
        "Broj licne karte: $user_id\n".
        "Broj telefona: $telephone\n".
        "IP: $ip\n";

        $headers = "From: $from \r\n";
        $headers .= "Reply-To: $visitor_email \r\n";

        mail($to, $subject, $body, $headers);

        header('Location: slanje_uspesno.html');
    }
}

// Function to validate against any email injection attempts
function IsInjected($str)
{
  $injections = array('(\n+)',
              '(\r+)',
              '(\t+)',
              '(%0A+)',
              '(%0D+)',
              '(%08+)',
              '(%09+)'
              );
  $inject = join('|', $injections);
  $inject = "/$inject/i";
  if(preg_match($inject,$str))
    {
    return true;
  }
  else
    {
    return false;
  }
}
?>
<!DOCTYPE html>
<head>

<meta http-equiv="content-type" content="text/html;charset=UTF-8" />

<link href="css/main.css" rel="stylesheet" type="text/css" />

<script type="text/javascript" src="js/jquery.min.js"></script>

<script language="JavaScript" src="js/gen_validatorv31.js" type="text/javascript"></script> 
</head>

<body>

<div id="header">
    <div id="container_header">
          <div id="logo"></div>
    </div>
</div>
<div id="container_kontakt">
    <div id="kontakt_email">
        <div id="kontakt_middle">

            <div id="forma">
                <div class="errors_kontakt">
                    <?php
                    if(!empty($errors)){
                    echo "<p class='err'>".nl2br($errors)."</p>";
                    }
                    ?>
                    <div id='form_errorloc' class='err'></div>
                </div>
                <form id="form" method="post" action="<?php echo htmlentities($_SERVER['PHP_SELF']); ?>">
                    <ul id="form_list">
                        <li><label>Vaše ime:</label><input type="text" id="form-name" name="form-name" value='<?php echo htmlentities($name) ?>'/></li>
                        <li><label>Vaš e-mail:</label><input type="text" id="form-email" name="form-email" value='<?php echo htmlentities($visitor_email) ?>'/></li>
                        <li><label>Naziv poruke:</label><input type="text" id="form-subject" name="form-subject" /></li>
                        <li><label>Broj telefona:</label><input type="text" id="form-telephone" name="form-telephone" maxlength="12" /></li>
                        <li><label>Broj lične karte:</label><input type="text" id="form-id" name="form-id" maxlength="6" /></li>
                        <li><label>Vaša poruka:</label><textarea name="form-message"><?php echo htmlentities($user_message) ?></textarea></li>
                        <li><label for="6_letters_code">Verifikacioni broj:</label><img src="captcha_code_file.php?rand=<?php echo rand(); ?>" id='captchaimg' >&nbsp;<input id="6_letters_code" class="captcha_code" maxlength="6" name="6_letters_code" type="text" ></li>
                        <li><label>&nbsp;</label><input type="submit" id="submit" value="POŠALJI" class="submit"></li>
                    </ul>
                </form>
                <script language="JavaScript">
                    // Code for validating the form
                    // Visit http://www.javascript-coder.com/html-form/javascript-form-validation.phtml
                    // for details
                    var frmvalidator  = new Validator("form");
                    //remove the following two lines if you like error message box popups
                    frmvalidator.EnableOnPageErrorDisplaySingleBox();
                    frmvalidator.EnableMsgsTogether();

                    frmvalidator.addValidation("form-name","req","Unesite Vaše ime"); 
                    frmvalidator.addValidation("form-email","req","Unesite Vašu e-mail adresu"); 
                    frmvalidator.addValidation("form-email","email","Unesite validnu e-mail adresu"); 
                    frmvalidator.addValidation("form-id","req","Unesite Vaš broj lične karte");
                    frmvalidator.addValidation("form-telephone","req","Unesite Vaš broj telefona");
                    frmvalidator.addValidation("6_letters_code","req","Verifikacioni kod je pogresno unet");
                    </script>
                <script language='JavaScript' type='text/javascript'>
                    function refreshCaptcha()
                    {
                        var img = document.images['captchaimg'];
                        img.src = img.src.substring(0,img.src.lastIndexOf("?"))+"?rand="+Math.random()*1000;
                    }
                </script>
            </div>
</div>
<div id="footer">
</div>
</body>
</html> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-13T21:43:59.600

您正在检查是否`$_POST['submit']`曾经提交过。查看您的代码，它永远不会提交，因为您的提交按钮没有`name`属性：

```
<input type="submit" id="submit" value="POŠALJI" class="submit"> 
```

它需要是：

```
<input type="submit" name="submit" id="submit" value="POŠALJI" class="submit"> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-13T21:44:10.710

有你的问题：

```
<input type="submit" id="submit" value="POŠALJI" class="submit"> 
```

`name`属性提交没有输入。

将其更改为：

```
<input type="submit" id="submit" name="submit" value="POŠALJI" class="submit"> 
```

# javascript - 输入多个文件并将它们分成单独的表格

> ID：11023679
> 
> 赞同：1
> 
> 时间：2012-06-13T21:37:12.440
> 
> 标签：javascript, html, file, input

我之前发布了一个[类似的问题](https://stackoverflow.com/questions/10990890/how-to-get-multiple-file-input-from-a-single-input)，但没有得到任何合适的解决方案。

我已经简化了要求：

1.  用户可以选择多个文件
2.  从选定的文件中，将**每个文件**放在单独的表格中
3.  分别提交每份表格

我正在努力实现第二步。任何帮助都会很棒。欢迎所有想法。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-14T15:19:20.477

有些东西在排队...

HTML：

```
<input type="file" multiple onchange="handleFiles(this.files)"> 
```

JavaScript：

```
function handleFiles(files){
  //create/associates a form with each file ("files.length" files)
  // ... do stuff ...
}

function doAllSubmits(){
  // for each form call "doAsubmit"
}

function doASubmit(some_id, callback){
  // instantiate a XmlHttpRequest
  // (or use jquery or any other library you're using)
  // use a POST method
  // (if I remember GET has(may have) query size limitations)
  // populate with the form data
  // plus the respective file data
  // (maybe with readAsDataURL)
} 
```

使用引用的组件的一些示例：

[Using_files_from_web_applications(MDN)](https://developer.mozilla.org/en/Using_files_from_web_applications)

[DOM/文件阅读器(MDN)](https://developer.mozilla.org/en/DOM/FileReader)

# c# - winforms 数据绑定仅适用于开发机器

> ID：11023682
> 
> 赞同：2
> 
> 时间：2012-06-13T21:37:35.730
> 
> 标签：c#, .net, winforms, data-binding, versioning

我的目标是框架 4.0，这在开发机器上运行良好，我可以在启动时看到带有显示绑定消息的文本框的表单。但是当我在任何其他机器上部署可执行文件时，它不会声称“无法绑定到数据源上的属性或列注释”。非常奇怪的是，如果我针对 3.5 框架进行编译，它在任何机器上都能正常工作。有人可以解释这种奇怪的行为吗？开发环境和客户端机器有什么不同？

```
namespace Demo
{
    public partial class Form1 : Form
    {
        private readonly SimpleDataContext _dataContext;

        public Form1()
        {
            InitializeComponent();

            _dataContext = new SimpleDataContext { Prop = new SimpleProp { Note = "hi!" }};
            textBox1.DataBindings.Add("Text", _dataContext, "Prop.Note");         
        }
    }

    public class SimpleDataContext
    {
        public SimpleProp Prop { get; set; }
    }

    public class SimpleProp
    {
        public string Note { get; set; }
    }  
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-13T21:49:59.663

4.0 中的重大变化。请参阅[.Net 4.0 简单绑定问题](https://connect.microsoft.com/VisualStudio/feedback/details/552853/net-4-0-simple-binding-issue#details)

解决方法是使用 BindingSource：

```
public Form1() {
  InitializeComponent();
  _dataContext = new SimpleDataContext { Prop = new SimpleProp { Note = "hi!" } };
  BindingSource bs = new BindingSource(_dataContext, null);
  textBox1.DataBindings.Add("Text", bs, "Prop.Note");    
} 
```

# url - 从字符串中检测 IDN 域的库？

> ID：11023683
> 
> 赞同：5
> 
> 时间：2012-06-13T21:37:39.683
> 
> 标签：url, uri, idn

IM/Email 类型场景：

用户键入他们想要的任何内容并将其发送给他们的好友。如果他们输入一个 URL，我想让收件人可以点击它。这意味着我们需要确定字符串中的一系列字符是一个有效的 URI，并从中创建一个超链接。

是否有一个库可以帮助解析用户输入并检测用户是否将国际化域名作为字符串的一部分输入？

例子：

*嘿伙计，这个俄罗斯麦当劳网站 макдональдс.рф 很酷 - 看看吧！*

请注意，我不是在谈论解析 URI 或进行 punycode/Unicode 转换 - 在执行任何操作之前，我需要先将其识别为 URI……

# php - 当流量增加时将一定比例的访问者重定向到另一个页面

> ID：11023686
> 
> 赞同：0
> 
> 时间：2012-06-13T21:37:53.107
> 
> 标签：php, javascript, html, redirect

我的任务是创建一个脚本，该脚本可以在高峰时段将我们网站流量的 10%、20%、50% 等重定向到“技术困难”页面，指示访问者稍后再回来以减轻负载我们的申请人。

在申请之前，我们的申请人都会通过一个中央登录页面进行引导，例如，假设它是“www.example.com/index.php”。所以问题是，是否有可能创建一个脚本，在这些高容量时间我们可以进入并让它每隔 5、10、20 个访问者重定向到“www.example.com/down.php”？

我们选择重定向这些人不是因为服务器负载，而是因为我们每个月只能有有限数量的申请人。这将创造几天的时间，我们基本上可以减少我们的申请人数，这样我们就不会超过这个门槛。

我知道如何将所有访问者完全重定向到一个站点，但这在这种情况下不起作用。我在这个网站上浏览了几个类似的问题，虽然仍然很有帮助，但我无法弄清楚如何正确处理这样的情况。

我很感激你能给我的任何帮助，和/或只是在正确方向上的一点。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-13T21:42:37.090

我建议研究其他解决方案，因为这不是对待访问者的好方法，但是如果您真的想这样做，请使用：

```
$rand = mt_rand(1, 10);
if ($rand <= 3) { // In this case, 30% of your visitors get redirected.
    // redirect
// normal page 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-13T21:50:32.603

据推测，能够访问您网站的用户可以访问多个页面，因此您必须做一些事情，以便如果用户被授予访问该网站的权限，他们会被记住。为了做到这一点，我会使用会话。因此，当用户访问该站点并且不存在会话 cookie 时，只需执行以下操作：

```
if (rand(0,100) > 30) {
    // Set cookie
}
else {
    // so sorry. site is down for you
    // redirect
} 
```

但是，问题是，您究竟想如何处理那些无法访问该网站的人？因为他们所要做的就是刷新页面，并且在 70% 的时间里，他们将被授予访问权限。如果您希望它是永久性的，则必须找到某种方法将它们列入黑名单。您可以在 cookie 中执行此操作，但随后用户可以轻松删除它并重试。使其持久化的唯一方法是将其 IP 地址存储在数据库中。这又将我们带到了第三个问题，共享 IP 呢？也许您可以先检查会话，然后如果未找到，请检查数据库中列入黑名单的 IP。这样，用户可以绕过它的唯一方法是拥有动态 IP 或使用代理。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-13T21:52:37.617

这真的取决于情况：

*   如果服务器完全没有负载问题，并且您的实际目标是限制每天的应用程序，那么可以使用 PHP 脚本来解决。我建议不要重定向到错误页面，而是告诉访问者有关限制的真相。这样访问者就不会多次点击 [F5] 以希望它会在几秒钟后工作，因为这会增加服务器负载。我还建议设置一个真正的限制，而不是重定向每个第 n 个用户。

*   如果服务器在处理繁重的负载时遇到问题，它甚至可能无法重定向所有请求。在这种情况下，您必须扩展您的服务器才能处理负载。可能的解决方案：使用负载均衡器将流量路由到不同的服务器；升级您的服务器；优化您的代码（因此服务器可能会在不扩展硬件的情况下承担负载）

*   如果您只是因为服务器无法处理负载而决定设置每天的应用程序限制，那么再次扩展您的服务器是最好的解决方案。

# php - 如何使用 Ajax 和锚标记删除元素？

> ID：11023688
> 
> 赞同：0
> 
> 时间：2012-06-13T21:38:15.420
> 
> 标签：php, jquery, css, ajax

我正在尝试创建一个标记系统，例如堆栈溢出。所以每个标签旁边都有一个小x，这样当用户删除它时，它就会从数据库中动态删除。只有输入标签的用户才能删除它们。我正在使用 x 的锚标记并使用 Ajax 将请求发送到 php 脚本，该脚本将删除元素，如下所示：

```
<?php
    require_once("database_connection_handler.php");
    $x=$post->ID; 
    $i=0;
    $select_query = "Select * from wp_tags inner join wp_posts_tags on wp_posts_tags.tag_id=wp_tags.id where wp_posts_tags.post_id='". $x . "'";
    $result = mysql_query($select_query);
    $num=mysql_num_rows($result);
    echo "</ul>";
    echoTagHTML();
    while ($i < $num) {
        $tag=mysql_result($result,$i,"tag");
        $id=mysql_result($result,$i,"id");
        echo "<li>";
        tagLinks($tag,$id);
            if(is_current_user())
            {
            echo "<a href='javascript:void(0)' onclick='deleteTag($id);'>&nbsp x</a>";
            }   
            echo "</li>";
            $i++;
}echo "</ul></div>";

?> 
```

处理这个问题的 Ajax 代码是：

```
function deleteTag(str){
    if (str.length != 0){
            if (window.XMLHttpRequest){// code for IE7+, Firefox, Chrome, Opera, Safari
                xmlhttp=new XMLHttpRequest();}
            else{// code for IE6, IE5
                xmlhttp=new ActiveXObject("Microsoft.XMLHTTP");}
                xmlhttp.open("GET","links/livesearch.php?del="+str,true);
                xmlhttp.send();
                            }
    else{return;}
} 
```

php脚本是：

```
<?php 
$del=$_GET["del"];
ConnectToDB();
$delete_query="delete from wp_tags where id='".$del."'";
    if(!mysql_query($delete_query))
    {
        echo "error while deleting";
    }
mysql_close($con);
?> 
```

我对阿贾克斯真的很陌生。当我单击应该删除用户的链接时，它不会删除任何内容。它不是从数据库中删除标签或从页面中删除链接。我错过了什么？任何帮助，将不胜感激。谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-13T22:46:44.340

注意到您标记了问题“jQuery”并假设 HTML 是这样的：

```
<div id="tagsContainer">
    <div class="tagWrapper">
        <a href="..." class="tag">php</a>
        <button class="tagDelete">X</button>
    </div>
    <div class="tagWrapper">
        <a href="..." class="tag">javascript</a>
        <button class="tagDelete">X</button>
    </div>
</div> 
```

你的 javascript 将是这样的：

```
$(function() {
    $("#tagsContainer").on('click', ".tagDelete", function() {
        var $deleteButton = $(this).attr('disabled', true),
            $wrapper = $deleteButton.closest(".tagWrapper"),
            $tag = $wrapper.find('.tag');
        $.ajax({
            url: "links/livesearch.php"
            data: {
                action: 'tagdelete',
                tag: $tag.text(),
                //other params here, eg. to identify the user and the context of the deletion
            },
            success: function(data, textStatus, jqXHR) {
                $wrapper.remove();
            },
            error: function(jqXHR, textStatus, errorThrown) {
                $deleteButton.attr('disabled', false),
                //display error message?
            }
        });
    });
}); 
```

本质上，这放置了一个处理程序，该处理程序将通过进行 ajax 调用来响应 中的所有`.deleteTag`按钮，并且当从服务器接收到成功的响应时，从 DOM`#tagsContainer`中删除标记（及其按钮）。`.deleteTag`

这里有很多猜测，所以你还有一些工作要做（并调试服务器端脚本）。

# jquery - 打开带有 URL 的 JQuery 选项卡，并在单击选项卡时向 URL 添加哈希

> ID：11023689
> 
> 赞同：7
> 
> 时间：2012-06-13T21:38:16.243
> 
> 标签：jquery, jquery-ui, jquery-ui-tabs

我正在开发一个 Web 应用程序，我正在使用 JQuery UI Tabs 插件来分离数据。
如果我将鼠标悬停在每个选项卡上，在屏幕的左下方我可以看到该选项卡的 URL（例如：testPage.com/#tab1 或 testPage.com/#tab2）

现在，如果我在 URL 栏中输入其中一个地址，我不会转到与 URL 中的哈希相关的选项卡，而是转到应用程序中的第一个选项卡。

我的问题是：我将如何将特定选项卡锚定到 URL？
因此，如果有人访问 testPage.com/#tab3，他们最终会出现在应用程序的选项卡 3 中。

我这样做也是因为我想使用 JQuery BBQ 插件来修改浏览器历史记录，所以我可以让用户在点击后退按钮时转到他们所在的最后一个选项卡。

示例：
[http ://benalman.com/code/projects/jquery-bbq/examples/fragment-jquery-ui-tabs/](http://benalman.com/code/projects/jquery-bbq/examples/fragment-jquery-ui-tabs/)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-21T20:49:00.483

我最终使用了 Asual 的 JQuery Address 插件。我做了以下事情：

```
 // For forward and back
    $.address.change(function(event){
        $("#main_tabs").tabs( "select" , window.location.hash );
    });

    // when the tab is selected update the url with the hash
    $("#main_tabs").bind("tabsselect", function(event, ui) { 
        window.location.hash = ui.tab.hash;
    }); 
```

希望这可以帮助某人！谢谢你。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-10-09T15:00:32.510

您也可以通过以下方式尝试。我`name`在锚元素中有属性。此名称将添加为哈希 URL。

Javascript：

```
$( "#tabs" ).tabs({
    select: function(event, ui) {                   
        window.location.hash = ui.tab.hash;                     
    }
}); 
```

HTML：

```
<div id="tabs" > 
    <ul>
        <li><a name="Test1" href="Home/Test1"> Tab 1  </a></li>
        <li><a name="Test2" href="Home/Test2"> Tab 2  </a></li>
        <li><a name="Test3" href="Home/Test3"> Tab 3  </a></li>            
    </ul>        
</div> 
```

# asp.net - 如何在 Web 应用程序中创建一个即使不在 wwwroot 中也能正常工作的链接？

> ID：11023690
> 
> 赞同：1
> 
> 时间：2012-06-13T21:38:17.033
> 
> 标签：asp.net, html

我有一个在 Visual Web 开发人员中运行良好的 Web 应用程序。但是当我将它发布到 IIS 时，如下链接：`href="/Default.aspx"`不起作用。该页面的地址现在是：`http://localhost/ MyApp.net/Default.aspx`。

所以我尝试添加波浪号：`href="~/Default.aspx"`但浏览器正在寻找：`http://localhost/ MyApp.net/~/Default.aspx`。

这很重要，因为我实际上想发布到文件夹而不是`wwwroot`，但不想硬编码路径。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-13T21:40:16.173

您需要包含 runat="server" 才能从根目录解析它。

```
<a href="~/Default.aspx" id="myLink" runat="server">Link</a> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-13T21:41:27.337

用于`ResolveURL()`输出您的链接引用。.Net 为您处理所有管道，无论您的应用程序位于何处。

```
<a href="<%= ResolveURL("~/Default.aspx")%>" id="theLink">Link</a> 
```

更多阅读：[Control.ResolveUrl 方法](http://msdn.microsoft.com/en-us/library/system.web.ui.control.resolveurl.aspx)

# android - setRotation(90) 以纵向模式拍照在三星设备上不起作用

> ID：11023696
> 
> 赞同：37
> 
> 时间：2012-06-13T21:39:18.857
> 
> 标签：android, android-camera

根据文档，[setRotation(90)](http://developer.android.com/reference/android/hardware/Camera.Parameters.html#setRotation%28int%29)应该旋转捕获的 JPEG 图片（横向模式下的[takePicture](http://developer.android.com/reference/android/hardware/Camera.html#takePicture%28android.hardware.Camera.ShutterCallback,%20android.hardware.Camera.PictureCallback,%20android.hardware.Camera.PictureCallback,%20android.hardware.Camera.PictureCallback%29) .

这适用于 HTC 手机，但不适用于三星 Google Nexus S 和三星 Galaxy S3。这是一个错误吗？

我知道我可以使用矩阵变换旋转，但希望操作系统可以更有效地执行此操作，并且不想冒在其他一些设备上过度旋转的风险。

**编辑**

设置`camera.setDisplayOrientation(90);`使预览处于纵向模式，但它对拍摄的照片没有任何影响。

此外，此外`setRotation`，我还尝试设置图片大小 - 我`h`用`w`:翻转的位置`parameters.setPictureSize(1200, 1600);`。这也没有任何影响。

**解决方案**

显然三星手机设置了 EXIF 方向标签，而不是旋转单个像素。如建议的那样，使用不支持此标记`ariefbayu`读取位图。`BitmapFactory`他的代码示例就是解决方案，而且这个解决方案也兼容使用`inSampleSize`.

* * *

## 回答 #1

> 赞同：34
> 
> 时间：2012-06-13T23:33:58.880

我尝试就 Exif 标签来回答这个问题。这就是我所做的：

```
Bitmap realImage = BitmapFactory.decodeStream(stream);

ExifInterface exif=new ExifInterface(getRealPathFromURI(imagePath));

Log.d("EXIF value", exif.getAttribute(ExifInterface.TAG_ORIENTATION));
if(exif.getAttribute(ExifInterface.TAG_ORIENTATION).equalsIgnoreCase("6")){

    realImage=ImageUtil.rotate(realImage, 90);
}else if(exif.getAttribute(ExifInterface.TAG_ORIENTATION).equalsIgnoreCase("8")){
    realImage=ImageUtil.rotate(realImage, 270);
}else if(exif.getAttribute(ExifInterface.TAG_ORIENTATION).equalsIgnoreCase("3")){
    realImage=ImageUtil.rotate(realImage, 180);
} 
```

`ImageUtil.rotate()`：_

```
public static Bitmap rotate(Bitmap bitmap, int degree) {
    int w = bitmap.getWidth();
    int h = bitmap.getHeight();

    Matrix mtx = new Matrix();
    mtx.postRotate(degree);

    return Bitmap.createBitmap(bitmap, 0, 0, w, h, mtx, true);
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-05-23T03:20:09.620

Liso22，变量流没有任何区别，只需插入您的位图，但是您得到了它（decodeFile 等）。如果您在使用“ImageUtil.rotate()”时遇到问题，只需将“public static Bitmap rotate()”编写为具有相同参数的方法，并使“真实图像”等于它。无论如何，这个解决方案似乎对我不起作用，无论是纵向还是横向，exif 标签都会返回 1（正常）。

# php - Codeigniter 会话返回 310 重定向

> ID：11023699
> 
> 赞同：1
> 
> 时间：2012-06-13T21:39:29.230
> 
> 标签：php, codeigniter, session, redirect

我有一个回调函数来检查我的登录详细信息是否正确 - 如果它们错误，它会返回一个错误（这工作正常）。如果详细信息正确，则应设置会话`$this->session->set_userdata('logged_in',TRUE);`，然后继续使用该功能`login`并重定向到仪表板 - 此重定向工作正常。

在我`function index(){}`的任何仪表板页面上都有这条线

`if($this->session->userdata('logged_in')) redirect('dashboard/home');`

**上面的行是导致我的 310 重定向的行，但我不确定为什么？**

我想检查用户是否登录重定向到`dashboard/home`否则返回登录页面`home/login`

**控制器：**

```
class Home extends CI_Controller {

    function __construct() {
            parent::__construct();
        }    

    public function index()
    {
        //if($this->session->userdata('logged_in')) redirect('dashboard/home');

        $data['contentMangement'] = $this->options_model->systemOptions();
        $data['pageTitle'] = 'Login';
        $data['message'] = "";
        $this->load->view('_assets/header', $data);
        $this->load->view('login', $data);
        $this->load->view('_assets/footer');
    }

    public function login() {
          $this->form_validation->set_rules('userEmail','Username', 'required|valid_email|trim|max_length[99]|xss_clean');
            $this->form_validation->set_rules('userPassword','Password', 'required|trim|max_length[200]|xss_clean|callback__checkUsernamePassword');

            if($this->form_validation->run() === FALSE) {

                $data['contentMangement'] = $this->options_model->systemOptions();
                $data['pageTitle'] = 'Login';
                $data['message'] = validation_errors('<div class="alert alert-error">', '</div>');
                $this->load->view('_assets/header', $data);
                $this->load->view('login', $data);
                $this->load->view('_assets/footer');

            }elseif($this->form_validation->run() === TRUE){

            redirect('dashboard/home');
        }
    }

    function _checkUsernamePassword() {

            $username = $this->input->post('userEmail');
            $password = $this->input->post('userPassword');

            $user = $this->user_model->check_login($username,$password);

            if(! $user)
            {
                $this->form_validation->set_message('_checkUsernamePassword', 'Sorry the details you provided have not been found');
                return FALSE;
            }else{
                 $this->session->set_userdata('logged_in',TRUE);
                return TRUE;
            }   
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-14T10:54:31.237

这是正在发生的事情。

假设我正确登录，在您的登录控制器中，您设置`logged_in = TRUE`了 ，并将我重定向到`dashboard/home`. 在`index()`函数中`dashboard/home`，如果`logged_in = TRUE`（它是）你`dashboard/home`再次将我重定向到。再一次，您检查`logged_in = TRUE`，然后再次重定向我，依此类推。

这会导致无限重定向循环，从而导致 310 错误（重定向过多）。

您需要重新进行登录检查。在`index()`in 中`dashboard/home`，执行以下操作：

`if ($this->session->userdata('logged_in') === FALSE) redirect(site_url('dashboard/login'));`

现在，当我访问仪表板主页时，如果我没有登录，您只会将我重定向。这可以保护您的仪表板主页免受未经身份验证的用户的攻击，同时不会使经过身份验证的用户陷入无限循环。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-14T01:41:27.697

我认为您首先应该创建一个`MY_Controller`来执行此操作，如果有一天您决定将会话变量名称从更改`logged_in`为`logged`怎么办？您会打开所有控制器并更改其会话吗？

创建一个`MY_Controller`你将使所有其他控制器，如`Home_Controller`扩展`MY_Controller`，如：

```
class Home extends MY_Controller
{
    public function __construct()
    {
        parent::__construct();
    }
} 
```

你的`MY_Controller`：

```
//under /application/core/
class MY_Controller extends Controller
{
  public function __construct()
  {
    parent::__construct();
    if(!$this->session->userdata('logged_in'))
       redirect('login');
  }
} 
```

当然，`Login_Controller`你会扩展`Controller`而不是扩展，`MY_Controller`否则你将处于无限循环中。

# compact-framework - SQL Server 2008 和 SQL Server CE 之间的同步框架

> ID：11023700
> 
> 赞同：1
> 
> 时间：2012-06-13T21:39:30.930
> 
> 标签：compact-framework, sql-server-ce, sql-server-2008-r2, microsoft-sync-framework, windows-mobile-6.5

我正在使用一个包含大约 60,000 条记录的中等大小的数据库。我正在构建一个移动应用程序，该应用程序能够将单个表格签出到一个紧凑的表格`.sdf`中，以便在设备上查看和更改，然后允许用户将他们的更改与主服务器同步并接收任何新信息。

我已经使用 WCF 服务库通过 Sync Framework 对其进行了设置。出于某种原因设置连接时，数据库不会让我检查“使用 SQL Server 更改跟踪”并抛出错误：

> "'无法初始化客户端数据库，因为表 'Inventory' 的架构 > 无法由 DbServerSyncProvider 的 GetSchema() 方法检索。确保您可以 > 建立与客户端数据库的连接并且 >SelectIncrementalInsertsCommand > SyncAdapter 的属性或 SelectIncrementalUpdatesCommand 属性已正确指定。”

所以我不选中它并将它设置为使用一些已经创建的列“AddDateTime”和“LastEditTime”，它似乎工作正常，经过大量调整后，我让它部分工作。设备上的更改与数据库完美同步，更新、删除，都得到应用。但是，服务器端的更改......永远不会更新。我已经确保一切都通过双向设置正确设置，所以这不应该是问题。而且，我让它坐了一夜，所以数据库收到了大约 500 条新记录，今天早上它实际上将最新的 24 个条目同步到了数据库中……在 500 条新记录中。所以这应该进一步证明它能够从服务器接收信息，但出于所有有用的目的，它不是。

我已经尝试了几乎所有的东西，老实说，我已经快要失去它了。如果有人有任何想法可以抛出，我可以追随，我将不胜感激。

我不确定我是否只需要回去弄清楚为什么我不能使用“SQL Server 更改跟踪”来做到这一点。或者，如果有一个简单的解释来解释为什么它实际上没有将服务器上 99% 的更改同步回客户端。

此外，服务器数据库表模式无法更改，因为许多其他服务都在使用它。但是紧凑型数据库可以是任何需要的东西，只需要存储表并在两个方向上正确同步。

谢谢！！

快速概览：

*   在没有 SQL Server 更改跟踪的情况下使用 WCF 和同步（在服务器和数据库上完全启用）
*   将更改从客户端同步到服务器完美运行
*   从服务器同步回客户端并没有那么多：在一夜之间的 500 个新条目中，同步下载了 24 个。

编辑：JuneT 让我想到了时间和他们的主播。当我今天早上同步时，它提取了大约 300 条新添加的记录中的 54 条。我进入了一行（大约有 60 列左右，所以为了便于阅读，我删除了它们，这是一个笑话）

> this.SelectIncrementalUpdatesCommand.CommandText = @"SELECT [Value], [Value], [Value] FROM >TABLE WHERE ([LastEditDate] > @sync_last_received_anchor AND [LastEditDate] <= >@sync_new_received_anchor AND [AddDateTime] <= @sync_last_received_anchor)" ;

并用两个不同的时间替换了@sync_last_received_anchor。同步后，它现在返回被困在这两者之间的行并取出中间的行给我：

> this.SelectIncrementalUpdatesCommand.CommandText = @"SELECT[Value], [Value], [Value] FROM >TABLE WHERE ([LastEditDate] > '2012-06-13 01:03:07.470' AND [AddDateTime] <= '2012- 06-14 >08:54:27.727')"; （注：第二个日期只是现在的当前时间）

尽管它返回的行数比最初计划的多几百行（将日期间隔设置为 600，但它返回了刚刚超过 800 行）。实际上，它确实将客户端与新的服务器更改同步。

谁能解释为什么我不能使用 @sync_last_received_anchor 以及我应该寻找什么。我想我总是可以添加允许用户选择开始更新日期的框？或者可能添加某种 xml 文件来存储同步日期，该日期将在同步成功完成时更新？

谢谢！

编辑：运行 SQL 探查器...日期（@sync_last_received_anchor）被设置为比实际时间提前 8 小时。我不知道它是如何或为什么这样做的，但这绝对是有道理的。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-15T18:20:40.433

原来锚是这样收集的：

> this.SelectNewAnchorCommand.CommandText = "选择@sync_new_received_anchor = GETUTCDATE()";

那个 UTC 日期是造成 8 小时差距的原因。要修复它，请将其更改为 GETDATE()，或在命令的 WHERE 子句中将列转换为 UTC 时间。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-01-26T11:40:14.987

在花了很多时间喝了很多杯咖啡之后，我想出了如何解决我的这个错误。当我在桌面测试区运行代码时，一切似乎都运行良好；但是，目标设备上的相同代码和 Web 服务反复出现此错误。然后，突然之间，紧凑型数据库表名上的“dbo_”前缀开始看起来很有趣，就像他们试图告诉我一些非常重要的事情一样。所以，我听...

```
Configuration.SyncTables.Add("Products); 
```

在 ClientSyncAgent.cs 上应更改为

```
Configuration.SyncTables.Add("dbo_Products"); 
```

*[下场]*

# extjs - Sencha 架构师可以使用模板成员函数吗？

> ID：11023703
> 
> 赞同：1
> 
> 时间：2012-06-13T21:39:48.680
> 
> 标签：extjs, sencha-touch, sencha-touch-2, sencha-architect

是否可以在 sencha 架构师 2 中使用“模板成员函数”？

在 sencha touch 中，您可以像这样使用它们：

```
var tpl = new Ext.XTemplate(
'<p>Name: {name}</p>',
'<p>Kids: ',
'<tpl for="kids">',
    '<tpl if="this.isGirl(name)">',
        '<p>Girl: {name} - {age}</p>',
    '<tpl else>',
        '<p>Boy: {name} - {age}</p>',
    '</tpl>',
    '<tpl if="this.isBaby(age)">',
        '<p>{name} is a baby!</p>',
    '</tpl>',
'</tpl></p>',
{
    // XTemplate configuration:
    disableFormats: true,
    // member functions:
    isGirl: function(name){
       return name == 'Sara Grace';
    },
    isBaby: function(age){
       return age < 1;
    }
}
); 
```

你能提供一个例子来说明如何做到这一点吗？有替代方案吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-13T22:03:58.067

你想用什么，`Template`还是 XTemplate？提供了两种类型的模板：模板和 XTemplate。Template 为我们提供了基本的模板功能，而 XTemplate 则更高级。

模板化附加功能，例如 XTemplate 提供的条件、循环、内联函数和内置变量，以显示过滤的项目。

我不是 Sencha Architect 的粉丝，但你能做到吗？：） 再见

# .net - 从子控件绑定到父 UserControl 的 DependencyProperty 的更简洁方法

> ID：11023712
> 
> 赞同：0
> 
> 时间：2012-06-13T21:40:27.547
> 
> 标签：.net, wpf, xaml, ivalueconverter

我有一个带有自定义 DependencyProperty 的自定义 UserControl。为了更好地了解我是如何使用它的，UserControl 是一个类似向导的控件中的左侧导航指示器。左侧导航控件存在于代表向导中的一个步骤的每个控件中。在左侧导航控件内部，我使用一些转换器切换可见性并设置几个子控件的视觉属性，代码类似于以下内容。我不能使用简单的样式选择器或样式选择转换器，因为无论是否选择了项目，我的 StackPanel 中每一行的整个结构都是不同的。

这是大量代码在我的控件中重复以绑定到单个自定义属性。是否有以下更短的形式版本或更清洁的方式来实现它？

```
<Polygon
    Visibility="{Binding
    RelativeSource={RelativeSource Mode=FindAncestor,
    AncestorType=UserControl},
    Path=Selected,
    Converter={StaticResource myCustomConverter},
    ConverterParameter='Expected String'}">
... 
```

父视图提供一个属性来自定义子控件：

```
 <!-- Left Column -->
    <views:LeftNavControl Selected="Item to Select..." /> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-13T22:27:42.043

您可以做一些事情，但我不会将它们描述为既不是更清洁/更短的实现方式。`MVVM`如果您使用一种方法，它们很容易实现。

您可以做的第一件事是摆脱`RelativeSource/AncestorType`绑定中的 以查找绑定属性的位置。如果您的两个/所有控件（尚不清楚您使用多少个控件）将共享相同的视图模型，您可以将相同的视图模型属性绑定到`views:LeftNavControl.Selected`，以及所有切换的可见性控件。

您可以做的第二件事是一种更激进的方法，可以清理您的 xaml，它也会使您`myCustomConverter`过时，但会在您的视图模型中移动一些业务逻辑。这在您有大量`Polygons`需要可见性切换的 /other 控件时效果最好。您可以在视图模型中有一个`StepXVisiblity`属性，并且您可以在每次`views:LeftNavControl.Selected`更改时计算它，并且您的 Polygon(s) xaml 将如下所示：

```
<Polygon Visibility="{Binding StepXVisiblity}"> 
```

上述解释的一个简单示例是：

```
<StackPanel>
    <TextBox Text="{Binding Step, UpdateSourceTrigger=PropertyChanged}" />
    <TextBlock Text="One" Visibility="{Binding StepOneVisible}" />
    <TextBlock Text="One" Visibility="{Binding StepOneVisible}" />
    <TextBlock Text="Two" Visibility="{Binding StepTwoVisible}" />
    <TextBlock Text="Two" Visibility="{Binding StepTwoVisible}" />
</StackPanel> 
```

视图模型：

```
public class MyVM : DomainBase
{
    private int step;

    public int Step
    {
        get 
        { 
            return step; 
        }
        set 
        { 
            step = value;
            OnPropertyChanged("Step");
            OnPropertyChanged("StepOneVisible");
            OnPropertyChanged("StepTwoVisible");
        }
    }

    public Visibility StepOneVisible
    {
        get
        {
            return step == 1 ? Visibility.Visible : Visibility.Collapsed;
        }
    }

    public Visibility StepTwoVisible
    {
        get
        {
            return step == 2 ? Visibility.Visible : Visibility.Collapsed;
        }
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-13T22:18:56.920

唯一想到的是创建自己的绑定类，该绑定类派生自基类（它本身是标记扩展），并将所有这些属性设置为您通常使用的默认值。这样，您只需指定非默认值。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-13T23:05:36.287

首先，由于您说了一些类似于导航面板的内容，您可能需要考虑使用列表视图或列表框之类的东西，并在绑定到视图模型中的集合时模板化您的项目。但是，由于我不知道您的 Nav 控件的范围，我会假设您的 Nav 控件并不完全适合此方案。

我会建议使用附加属性来实现您所描述的基于单个父属性设置多个属性。将以下内容视为伪代码，因为我尚未对其进行测试：

```
 public class MagicHelper
    {
        #region Super Property

        public static readonly DependencyProperty SuperProperty =
            DependencyProperty.RegisterAttached(
                "Super", typeof(SecretType), typeof(MagicHelper)
                new PropertyMetadata(-1, SuperChanged));

        // Get
        public static SecretType GetSuper(DependencyObject obj)
        {
            return (SecretType)obj.GetValue(SuperProperty);
        }

        // Set
        public static void SetSuper(DependencyObject obj, SecretType value)
        {
            obj.SetValue(SuperProperty, value);
        }

        // Change Event - make stuff happen here
        public static void SuperChanged(
            DependencyObject obj, DependencyPropertyChangedEventArgs e)
        {

// I am using Polygon here for example but you could use a base class that might cover all your controls
            if (!(obj is Polygon))
                return;

            Polygon pGon = (Polygon)obj;

        // do your thing to pGon here with e.NewValue
        var mySecretInstance = e.NewValue as SecretType;

        if (mySecretInstance.frap)
        {
        pGon.Visibility = Visibility.Collapsed;
        pGon.Background = Brushes.Red;
            }

...
...

        }

} 
```

XAML 是这样的

```
<UserControl Name="thisControl" 
xmlns:local="yourLibrary">
<Polygon local:MagicHelper.Super="{Binding ElementName=thisControl, Path=Selected"/>
... 
```

米

# ruby - Ruby 中的预填充提示

> ID：11023713
> 
> 赞同：5
> 
> 时间：2012-06-13T21:40:45.563
> 
> 标签：ruby, command-prompt

我正在使用 Ruby 编写一个小型命令行实用程序来搜索 Pubmed。现在，我提示用户进行查询并显示结果，用户可以选择附加到查询或输入全新的查询。我想添加编辑当前查询的功能；即提示应该预先填充上一个查询的可编辑版本，如下所示：

```
Enter query: <PREVIOUS QUERY HERE> 
```

在提示旁边打印出上一个查询很容易，但是如何使此输出可编辑，就好像用户自己键入一样？

@casper：感谢您对 Casper 的回复。我尝试了您在下面提供的代码，它确实可以自行运行。奇怪的是，当我尝试在 gem 中使用它时，它似乎不起作用。我的 gem 叫做 db_hippo。我在 gemspec 中添加了 rb-readline 作为依赖项，并将 RbReadline 的扩展名放在 lib/db_hippo/rb-readline.rb

```
module DbHippo
  module RbReadline
    <CASPER'S EXTENSION HERE>
  end
end 
```

我希望在 DbHippo 的另一个子模块 DbHippo::Source 中使用该功能。在 DbHippo::Source 中，我在顶部添加了：

```
require 'rb-readline'
require 'db_hippo/rb-readline' 
```

然后在 DbHippo::Source 的一种方法中，我有：

```
RbReadline.prefill_prompt(query)
query = Readline.readline("Query: ", true) 
```

查询变量绝对不是空的，但由于某种原因，在这种情况下，提示不会被预填充。我还注意到，如果我将扩展名放在同一个文件 (lib/db_hippo/rb-readline) 中而不使其成为 DbHippo 的子模块，我会收到错误：**未初始化的常量 DbHippo::Source::Readline (NameError)**在线：

```
query = Readline.readline("Query: ", true) 
```

这一切似乎都与模块、require 语句和 gem 的正确命名有关。这是我尝试构建的第一个宝石。知道这里出了什么问题吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2014-06-01T00:04:57.193

也许谷歌人会发现这很有用。

在 Ruby 2.1 上使用普通`Readline`版，您可以使用：

```
def ask(prompt, default=nil)

  if default
    Readline.pre_input_hook = -> {
      Readline.insert_text(default)
      Readline.redisplay
      # prevent re-trigger on every `readline`
      Readline.pre_input_hook = nil
    }
  end
  data = Readline.readline("#{prompt}: ")
  return data.chomp
end

ask("MOAR...?", "COMPUTARS!") # displays: MOAR...? COMPUTARS! 
```

在提示符下，文本`COMPUTARS!`将是可编辑的

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-14T02:17:33.780

你可以用[RbReadline](https://github.com/luislavena/rb-readline)做到这一点：

```
require 'rubygems'
require 'rb-readline'

module RbReadline
  def self.prefill_prompt(str)
    @rl_prefill = str
    @rl_startup_hook = :rl_prefill_hook
  end

  def self.rl_prefill_hook
    rl_insert_text @rl_prefill if @rl_prefill
    @rl_startup_hook = nil
  end
end

RbReadline.prefill_prompt("Previous query")
str = Readline.readline("Enter query: ", true)

puts "You entered: #{str}" 
```

# c# - 如何在新进程中调用有问题的 .dll？

> ID：11023716
> 
> 赞同：1
> 
> 时间：2012-06-13T21:41:04.577
> 
> 标签：c#, dll, service, process, background

我有 ac# windows 服务应用程序在使用第三方 .dll 处理某些文件时崩溃而没有引发异常。我决定做的是创建一个新的控制台应用程序，它复制一小部分 Windows 服务代码，特别是导致服务崩溃的部分。我想做的是从windows服务中调用新的.exe程序，如果它崩溃了，我自己会抛出一个异常。

所以，我需要调用这个.exe程序（不是在后台，因为我不能让windows服务继续，直到我知道要处理的文件是安全的），然后确定它是否成功退出。我该怎么做呢？我见过的示例在后台进程中运行 .exe，这不是我想要的。

谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-13T21:52:46.153

看看这个 SO [answer](https://stackoverflow.com/a/1369252/351383)如何从 Windows 服务运行控制台应用程序。只需添加 WaitForExit，如下所示：

```
ProcessStartInfo info = new ProcessStartInfo(@"c:\myprogram.exe");
info.UseShellExecute = false;
info.RedirectStandardError = true;
info.RedirectStandardInput = true;
info.RedirectStandardOutput = true;
info.CreateNoWindow = true;
info.ErrorDialog = false;
info.WindowStyle = ProcessWindowStyle.Hidden;

Process process = Process.Start(info);
process.WaitForExit(); 
```

在控制台应用程序中，如果您退出`Environment.Exit(statusCode)`或从控制台应用程序的主函数返回 int 值，您可以设置退出代码。或者您可以写入输出，然后在您的服务中检查退出代码 ( `process.ExitCode`) 或输出流，以便确定进程是否成功退出。

# c# - 使用按位运算从 int 日期中提取月份 (yyyyMMdd)

> ID：11023727
> 
> 赞同：-2
> 
> 时间：2012-06-13T21:41:55.937
> 
> 标签：c#, c++, c, bitwise-operators

`int`是否可以使用一些位运算符从表示为（格式 YYYYMMDD，例如 20110401）的日期中提取月份？

如果是这样，怎么办？

编辑：我目前正在使用 20110401 % 10000 / 100。我认为按位可能会更快。DateTime.Parse 等对于我想要做的事情来说太慢了。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-06-13T21:44:24.560

不，因为位运算符使用数字的*二进制*表示。您的日期使用*十进制*表示进行编码。

您可以使用算术运算符来做到这一点：

```
int date = 20110401;

int day = date % 100;
int month = (date / 100) % 100;
int year = date / 10000; 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-13T21:44:57.700

`20110301`(base 10) 作为整数将在位级别上完全不同地表示，实际上是`1001100101101101111011101`(base 2)。使用位级操作从该位串中提取月份并非易事。

备择方案：

*   对整数做一些涉及 mod 的基本数学运算

*   将 转换`int`为字符串，然后提取相关数字并将它们转换回整数。

*   或者更好的是，为此使用一些已经测试过的库函数。

位级操作不是解决这个问题的好方法。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-13T21:49:43.203

如果可以的话，使用按位运算可能容易出错。您可以通过除法和模运算来处理数字。

您还可以将其转换为字符串，解析月份字符，然后再转换回 int。

这是 C# 中的一些示例代码

```
int date = 20119420;
int month = 0;

// using good old math
month = (date / 100) % 100;

// using string parsing
month = int.Parse(date.ToString().Substring(4, 2)); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-13T23:21:02.067

如果您以二进制格式*表示*日期，则可以通过按位运算有效地提取月份，例如，5 位表示月份的日期，4 位表示月份编号，其余表示年份，而不是十进制数字。对于您的示例，日期将是 (2011 << 9) + (4 << 5) + 1 （当然不等于 20110401）。要使用按位运算从此类表示中提取字段：

```
int year = date >> 9;
int month = (date >> 5) & 0xF;
int day = date & 0x1F; 
```

正如 Mark Byers 所提到的，另一种方法是使用结构，例如，

```
typedef struct {
    short year;
    char  month;
    char  day;
} Date; 
```

您可以在堆栈上传递这些，按名称提取字段，并将它们初始化为

```
Date d = { 2011, 4, 1}; 
```

或者，在 C99 中，

```
Date d = { .year = 2011, .month = 4, .day = 1 }; 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2019-02-01T02:31:48.183

所以我知道这是一篇非常古老的帖子，但这实际上是我们班的作业，我有一个压缩日期和一个仅使用按位运算的提取日期函数：

```
 //Compress Date
    int compressDate(int month, int day, int year)
    {
        int date = year;
        date <<= 4;
        date |= month;
        date <<= 6;
        date |= day;

        return date;

    }

    //Extract Date
    void extractDate(int date, int& month, int& day, int& year)
    {
        int dayMask = 63;
        int monthMask = 15;
        int yearMask = 4095;

        day = date & dayMask;
        date >>= 6;
        month = date & monthMask;
        date >>= 4;
        year = date & yearMask;
    } 
```

当您使用 compressDate(1, 25, 2019) 之类的函数执行压缩日期函数时，它会返回数字：2067545，而 extractDate 函数的工作顺序正好相反。这样做的原因是按位运算符比使用数学运算符更快。

# selenium - 如何在 Firefox 中使用 Selenium RC2 将鼠标悬停在 WebElement 上

> ID：11023728
> 
> 赞同：3
> 
> 时间：2012-06-13T21:41:58.107
> 
> 标签：selenium, selenium-rc, mouseover

使用 Selenium 的 Firefox WebDriver 2.20，当鼠标悬停在我的网页上的链接上时，我需要显示一个工具提示。

我尝试使用 Selenium 的 Action 类来执行此操作，但我得到一个 ClassCastException：$Proxy7 与 org.openqa.selenium.internal.Locatable 不兼容。这是我迄今为止尝试过的：

```
Actions builder = new Actions(driver);
WebElement link = driver.findElement(By.tagName("a"));
builder.moveToElement(link).build().perform(); 
```

ClassCastException 发生在 moveToElement() 方法中，当我传递给函数的 WebElement 被强制转换为可定位对象时。方法是：

```
public Actions moveToElement(WebElement toElement) { 
   action.addAction(new MoveMouseAction(mouse, (Locatable) toElement)); 
   return this;
} 
```

我也试过下面的代码，导致同样的错误：

```
WebElement link = driver.findElement(By.tagName("a"));
Mouse mouse = ((HasInputDevices) driver).getMouse();
mouse.mouseDown(((Locatable)link).getCoordinates()); 
```

我听说这些方法适用于以前的 Firefox 版本，但不适用于最近的 Firefox 版本（我使用的是 FF12）。如果这是真的，还有其他方法可以在 Selenium 中模拟鼠标悬停吗？任何帮助使此功能正常工作将不胜感激！

**解决方案** 在挖掘了一段时间并尝试了不同的代码片段后，我找到了解决问题的方法。对于将来遇到此问题的任何人，我必须禁用 Firefox 驱动程序的本机事件，如下所示：

```
DesiredCapabilities cap = DesiredCapabilities.firefox();

FirefoxProfile prof = new FirefoxProfile(); 
prof.setEnableNativeEvents(false); 
cap.setCapability("firefox_profile", prof); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-15T09:16:39.880

您可以使用 Javascript 来做到这一点：

```
string script = "var evt = document.createEvent('MouseEvents');" +
                        "evt.initMouseEvent('mouseover',true, true, window, 0, 0, 0, 0, 0, false, false, false, false, 0, null);" +
                        "arguments[0].dispatchEvent(evt);";
((IJavaScriptExecutor)driver).ExecuteScript(script, element); 
```

# jquery - jQuery fadeTo 和 fadeIn 除了 JSFiddle 之外在任何地方都不起作用

> ID：11023730
> 
> 赞同：1
> 
> 时间：2012-06-13T21:42:25.393
> 
> 标签：jquery, google-chrome, safari, fadein, fadeto

我似乎无法在 chrome 或 safari 上获得简单的淡入效果 - 但它与 jsfiddle (Chrome 19.0.1084.56 & Safari 5.1.7) 完美配合。我也没有得到任何 javascript 错误来解决。以前我试过

> $("#fade").hide().fadeIn

这在 jsfiddle 中也可以正常工作，但在我的文件中却不行。有趣的是，当我使用它时，fadeOut 可以正常工作。

下面是我的代码——它对你有用吗？如果您对为什么它不适合我有任何想法，请告诉我！

```
<html>

<head>

<title>Wheee jQuery!</title>

<!-- jquery -->
<script type="text/javascript" src="http://code.jquery.com/jquery-latest.js"></script>

<script type="text/javascript">

$("#fade").fadeTo(2000, 1);

</script>

<!-- css -->
<style type="text/css">
#fade{
    width: 150px;
    height: 30px;
    text-align: center;
    color: blue;
    border: 1px dotted blue;
    opacity: 0.3;
}
</style>

</head>

<body>

<div id="fade">
lalala
</div>   

</body>

</html> 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-13T21:52:27.197

默认情况下，JSFiddle 已`OnLoad`选择`JavaScript`在事件中运行在面板中找到的代码`body.onload`。另一方面，您的代码运行在标头中解包的代码。要在 JSFiddle 中模拟这种情况，请选择`No Wrap`而不是，`OnLoad`您的代码将突然不起作用，就像在您的服务器上一样。

要解决此问题，请将代码包装在

```
$(document).ready(function(){
    $("#fade").fadeIn(2000);
}); 
```

不带包装的 JSFiddle 示例：http: [//jsfiddle.net/3cXvL/1/](http://jsfiddle.net/3cXvL/1/)

另一种解决方案是将代码放在它需要影响的 div 之后。

```
<div id="fade"></div>
<script>
    $("#fade").fadeIn(2000);
</script> 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-13T21:45:44.123

“使用`$(document).ready(function(){/*mycode*/});`（传入 8 个答案）”——凯文。

为我工作。[http://jsfiddle.net/3cXvL/](http://jsfiddle.net/3cXvL/)

```
$(document).ready(function() {
    $("#fade").fadeTo(2000, 1);
}); 
```

# excel - Excel VBA：替换（）输出用作范围变量

> ID：11023732
> 
> 赞同：0
> 
> 时间：2012-06-13T21:42:29.287
> 
> 标签：excel, debugging, vba, variables, replace

我会尽力解释这一点。希望我在脚本中的笔记能澄清我的胡言乱语。简而言之，此脚本将翻阅历史生产表，将这些表中的选定数据编译为一个。在当前代码中，在识别要粘贴到的下一个空单元格时，我无法让 Replace() 输出正常工作。当我开始浏览工作簿部分时，我试图限制所需的代码更改量。我希望这是有道理的。“复制粘贴需要代码以有限的更改复制过去。我的想法是只需要更改目标列。” 我的技能有限，但我正在学习，所以请随时就方法或设计提供建议和反馈。目前，我很难调试我的 columnCEL 变量在范围选择中的工作方式。我很感激有人能给我的任何有建设性的东西。链接、信息来源等我已经在这个网站和其他网站上浏览了几个小时，但我已经弄清楚了一些事情，但是......

```
 Sub parse()
Dim strPath As String
Dim columnCEL As String
Dim lastrow As Range

'open WB to consolidate too
                        Workbooks.Open "c:\prodplan\compiled\plancon.xlsx"

Set lastrow = ActiveSheet.UsedRange.End(xlDown).Offset(1, 0)

Set objexcel = CreateObject("Excel.Application")
objexcel.Visible = True
objexcel.DisplayAlerts = False
strPath = "C:\prodplan"
Set objfso = CreateObject("Scripting.FileSystemObject")
Set objFolder = objfso.GetFolder(strPath)

'Loop through objWorkBooks
For Each objfile In objFolder.Files

    If objfso.GetExtensionName(objfile.Path) = "xlsx" Then
        Set objworkbook = objexcel.Workbooks.Open(objfile.Path)

objworkbook.Worksheets("plan").Select

 'start header dates and shifts copy from objworkbook to consolidated WB
  objworkbook.Worksheets("plan").Range("b6:p7").Select

            Selection.copy
                    Workbooks("plancon.xlsx").Worksheets("data").Range("B1").Select
                    lastrow.Select
                    ActiveCell.PasteSpecial

                    'start loop for objworkbook name copy to field in plancon corisponding with date/shift and copy/past select row data.

 objworkbook.Close False

 'Move proccesed folder to new Dir

End If
'remove msgbox after debug
 MsgBox "loop stoper remove for final application"
Next

objexcel.Quit

End Sub

"destination  WB "Plancon table structure                   
Date    shift   day Total sales Inventory   Travel
source WB NAME  Thurs   Night   3429        
source WB NAME  Fri Day 2735        
source WB NAME  Fri Night   5294        
source WB NAME  Sat Day 7672        
source WB NAME  Sat Night   0       

Source structure                    
Shift:  Thurs   Fri Fri     
Shift:  Night   Day Night       
Date:   40360   40361   40361       
Total sales 3429    2735    5294        
Inventory   1750.5045   1685.854    3374.3956       
Travel 
```

蒂姆，安迪谢谢你的时间。你们俩都是正确的，它应该是偏移量（1,0）。Tim 关于打开目标工作簿时的活动单元格，我已将其设置为“a1”，但出于不需要它的想法而删除了这一点，因为代码会在粘贴到指定列之前将 Lastcell 设置为活动状态，这将对每个粘贴进行硬编码。我试图找到一种方法，每次输入新列进行粘贴时，我都不必更改结束行的名称。我相信安迪的建议会为我简化事情。在搜索其他代码以获取示例和理解时，我没有看到 usedrange”我更新了代码以反映建议。我还添加了源表和目标表的示例。源表包含大约 78 个行标签，它们将以示例格式复制到目标 WB。在一个完美的世界中，选择所有转置粘贴将使我到达那里。不幸的是，垃圾太多，为 87+ WB 手动过滤它并不吸引人。我将不得不循环比较等于复制范围。或者搜索等于源中每一行的复制范围。关于哪个更快/更有效率的任何建议？无论哪种方式，感谢您的帮助/成为一个共鸣板。关于哪个更快/更有效率的任何建议？无论哪种方式，感谢您的帮助/成为一个共鸣板。关于哪个更快/更有效率的任何建议？无论哪种方式，感谢您的帮助/成为一个共鸣板。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-20T18:23:13.347

做了更多的寻找.. 在一个 MS 开发人员的关节中发现了这个，离搜索排名的顶部还很远。无论哪种方式都成功了。

```
 Dim MyColumn As String
        Dim Here As String
        Here = ActiveCell.Address
                 MyColumn = Mid(Here, InStr(Here, "$") + 1, InStr(2, Here, "$") - 2)
lastrow = ActiveWorkbook.ActiveSheet.Range(MyColumn & "65536").End(xlUp).Offset(1, 0) 
```

# android - 在 ImageView 中更改 drawable 会使 android 应用程序崩溃

> ID：11023733
> 
> 赞同：0
> 
> 时间：2012-06-13T21:42:32.227
> 
> 标签：android, memory-management

所以我正在编写一个软件，当我尝试创建第二个可绘制对象时它一直在崩溃。它从前面的屏幕开始，然后我按下一个按钮，它进入一个新的活动。在那个活动中，我在中间有一个 ImageView，在底部有一个按钮。当活动加载时，ImageView 中有一个可绘制对象。因此，当我单击底部的按钮时，它应该更改 ImageView 中的可绘制对象，但它会崩溃。我在 LogCat 中发现了如下错误：

```
E/AndroidRuntime(1385): Caused by: java.lang.OutOfMemoryError: bitmap size exceeds VM budget 
```

所以这是我从那个活动中得到的代码：

```
package com.foocity.android.gui;

import android.app.Activity;
import android.graphics.Canvas;
import android.graphics.drawable.Drawable;
import android.os.Bundle;
import android.view.View;
import android.widget.ImageView;

public class NewMapActivity extends Activity 
{
    public ImageView    mapPreview;
    public Drawable     currentPic;

    public void onCreate(Bundle savedInstanceState) {

        super.onCreate(savedInstanceState);
        setContentView(R.layout.newmap);

        currentPic = getResources().getDrawable(R.drawable.milestone_cleanenergy);
        mapPreview = (ImageView) findViewById(R.id.chooseCanvas);
        mapPreview.setImageDrawable(currentPic);
    }

    public void changePic(View view)
    {
        System.out.println("tester boy!!!!!!!!!!!");

        currentPic = null;
        currentPic = getResources().getDrawable(R.drawable.welcomescreen);
        mapPreview.setImageDrawable(currentPic);
    }
} 
```

以下是 LogCat 在崩溃时所说的内容：

```
06-13 21:25:56.613: D/dalvikvm(4086): GC_EXTERNAL_ALLOC freed 614 objects / 50072 bytes in 58ms
06-13 21:26:02.133: W/System.err(4086): java.io.FileNotFoundException: /sdcard/000.txt (No such file or directory)
06-13 21:26:02.143: W/System.err(4086):     at org.apache.harmony.luni.platform.OSFileSystem.openImpl(Native Method)
06-13 21:26:02.143: W/System.err(4086):     at org.apache.harmony.luni.platform.OSFileSystem.open(OSFileSystem.java:152)
06-13 21:26:02.143: W/System.err(4086):     at java.io.FileInputStream.<init>(FileInputStream.java:82)
06-13 21:26:02.143: W/System.err(4086):     at java.util.Scanner.<init>(Scanner.java:188)
06-13 21:26:02.143: W/System.err(4086):     at java.util.Scanner.<init>(Scanner.java:167)
06-13 21:26:02.143: W/System.err(4086):     at com.foocity.android.Map.<init>(Map.java:33)
06-13 21:26:02.143: W/System.err(4086):     at com.foocity.android.FooCity.setMap(FooCity.java:594)
06-13 21:26:02.143: W/System.err(4086):     at com.foocity.android.gui.StartActivity.chooseMap(StartActivity.java:33)
06-13 21:26:02.153: W/System.err(4086):     at java.lang.reflect.Method.invokeNative(Native Method)
06-13 21:26:02.153: W/System.err(4086):     at java.lang.reflect.Method.invoke(Method.java:521)
06-13 21:26:02.153: W/System.err(4086):     at android.view.View$1.onClick(View.java:2067)
06-13 21:26:02.153: W/System.err(4086):     at android.view.View.performClick(View.java:2408)
06-13 21:26:02.153: W/System.err(4086):     at android.view.View$PerformClick.run(View.java:8816)
06-13 21:26:02.153: W/System.err(4086):     at android.os.Handler.handleCallback(Handler.java:587)
06-13 21:26:02.153: W/System.err(4086):     at android.os.Handler.dispatchMessage(Handler.java:92)
06-13 21:26:02.153: W/System.err(4086):     at android.os.Looper.loop(Looper.java:123)
06-13 21:26:02.153: W/System.err(4086):     at android.app.ActivityThread.main(ActivityThread.java:4627)
06-13 21:26:02.153: W/System.err(4086):     at java.lang.reflect.Method.invokeNative(Native Method)
06-13 21:26:02.153: W/System.err(4086):     at java.lang.reflect.Method.invoke(Method.java:521)
06-13 21:26:02.153: W/System.err(4086):     at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:868)
06-13 21:26:02.153: W/System.err(4086):     at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:626)
06-13 21:26:02.153: W/System.err(4086):     at dalvik.system.NativeStart.main(Native Method)
06-13 21:26:02.393: D/dalvikvm(4086): GC_EXTERNAL_ALLOC freed 3101 objects / 159528 bytes in 53ms
06-13 21:26:07.113: I/System.out(4086): tester boy!!!!!!!!!!!
06-13 21:26:07.123: E/dalvikvm-heap(4086): 9469350-byte external allocation too large for this process.
06-13 21:26:07.123: E/GraphicsJNI(4086): VM won't let us allocate 9469350 bytes
06-13 21:26:07.133: D/AndroidRuntime(4086): Shutting down VM
06-13 21:26:07.133: W/dalvikvm(4086): threadid=1: thread exiting with uncaught exception (group=0x4001d800)
06-13 21:26:07.143: E/AndroidRuntime(4086): FATAL EXCEPTION: main
06-13 21:26:07.143: E/AndroidRuntime(4086): java.lang.IllegalStateException: Could not execute method of the activity
06-13 21:26:07.143: E/AndroidRuntime(4086):     at android.view.View$1.onClick(View.java:2072)
06-13 21:26:07.143: E/AndroidRuntime(4086):     at android.view.View.performClick(View.java:2408)
06-13 21:26:07.143: E/AndroidRuntime(4086):     at android.view.View$PerformClick.run(View.java:8816)
06-13 21:26:07.143: E/AndroidRuntime(4086):     at android.os.Handler.handleCallback(Handler.java:587)
06-13 21:26:07.143: E/AndroidRuntime(4086):     at android.os.Handler.dispatchMessage(Handler.java:92)
06-13 21:26:07.143: E/AndroidRuntime(4086):     at android.os.Looper.loop(Looper.java:123)
06-13 21:26:07.143: E/AndroidRuntime(4086):     at android.app.ActivityThread.main(ActivityThread.java:4627)
06-13 21:26:07.143: E/AndroidRuntime(4086):     at java.lang.reflect.Method.invokeNative(Native Method)
06-13 21:26:07.143: E/AndroidRuntime(4086):     at java.lang.reflect.Method.invoke(Method.java:521)
06-13 21:26:07.143: E/AndroidRuntime(4086):     at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:868)
06-13 21:26:07.143: E/AndroidRuntime(4086):     at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:626)
06-13 21:26:07.143: E/AndroidRuntime(4086):     at dalvik.system.NativeStart.main(Native Method)
06-13 21:26:07.143: E/AndroidRuntime(4086): Caused by: java.lang.reflect.InvocationTargetException
06-13 21:26:07.143: E/AndroidRuntime(4086):     at com.foocity.android.gui.NewMapActivity.changePic(NewMapActivity.java:30)
06-13 21:26:07.143: E/AndroidRuntime(4086):     at java.lang.reflect.Method.invokeNative(Native Method)
06-13 21:26:07.143: E/AndroidRuntime(4086):     at java.lang.reflect.Method.invoke(Method.java:521)
06-13 21:26:07.143: E/AndroidRuntime(4086):     at android.view.View$1.onClick(View.java:2067)
06-13 21:26:07.143: E/AndroidRuntime(4086):     ... 11 more
06-13 21:26:07.143: E/AndroidRuntime(4086): Caused by: java.lang.OutOfMemoryError: bitmap size exceeds VM budget
06-13 21:26:07.143: E/AndroidRuntime(4086):     at android.graphics.Bitmap.nativeCreate(Native Method)
06-13 21:26:07.143: E/AndroidRuntime(4086):     at android.graphics.Bitmap.createBitmap(Bitmap.java:468)
06-13 21:26:07.143: E/AndroidRuntime(4086):     at android.graphics.Bitmap.createBitmap(Bitmap.java:435)
06-13 21:26:07.143: E/AndroidRuntime(4086):     at android.graphics.Bitmap.createScaledBitmap(Bitmap.java:340)
06-13 21:26:07.143: E/AndroidRuntime(4086):     at android.graphics.BitmapFactory.finishDecode(BitmapFactory.java:488)
06-13 21:26:07.143: E/AndroidRuntime(4086):     at android.graphics.BitmapFactory.decodeStream(BitmapFactory.java:462)
06-13 21:26:07.143: E/AndroidRuntime(4086):     at android.graphics.BitmapFactory.decodeResourceStream(BitmapFactory.java:323)
06-13 21:26:07.143: E/AndroidRuntime(4086):     at android.graphics.drawable.Drawable.createFromResourceStream(Drawable.java:697)
06-13 21:26:07.143: E/AndroidRuntime(4086):     at android.content.res.Resources.loadDrawable(Resources.java:1709)
06-13 21:26:07.143: E/AndroidRuntime(4086):     at android.content.res.Resources.getDrawable(Resources.java:581)
06-13 21:26:07.143: E/AndroidRuntime(4086):     ... 15 more 
```

它显然与内存管理有关，我不习惯使用 Java 进行监控，但我不确定该怎么做。任何帮助，将不胜感激。谢谢

PS我意识到发布这个我尝试了其他东西（创建一个文件对象，然后将它的内容写入System.out），甚至在新活动加载ImageView中的第一个drawable之前它也导致了同样的错误，所以它必须拥有一切与内存管理有关，我想我需要有关如何管理该系统中的内存的帮助，因为我习惯于在常规 Java 中处理该问题的 GC。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-13T21:57:04.073

```
Caused by: java.lang.OutOfMemoryError: bitmap size exceeds VM budget 
```

从这一行可以看出，您尝试显示的图像尺寸过大。尝试减小图像的大小并查看。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-13T21:47:52.563

想到的第一件事是你试图在另一个图像上绘制一个图像，结果你的应用程序内存不足。我不确定如何，但在绘制下一张图像之前尝试清除 ImageView。

编辑：[有效地显示位图](http://developer.android.com/training/displaying-bitmaps/index.html) 这应该可以帮助您解决问题。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-13T21:56:54.377

> 06-13 21:26:07.123: E/dalvikvm-heap(4086): 9469350 字节的外部分配对于这个进程来说太大了。06-13 21:26:07.123: E/GraphicsJNI(4086): VM 不允许我们分配 9469350 字节

这表明您使用的图像资源`R.drawable.welcomescreen`太大（它的位图需要约 9 MBytes）。我坚信您可以缩小图像资源（在将其放入“可绘制”文件夹之前），因此它不会占用太多内存。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-14T01:05:13.907

我使用 android:src="@drawable/blah.jpg" 在 xml 中设置的第一个活动的 ImageView 而不是像我第二次那样的方法。当我从 xml 中删除该行并在第一个活动上设置图片时，就像我在第二个活动 ImageView 中所做的那样，一切正常。现在的问题是为什么会这样？为什么在 xml 中设置图片会占用更多的内存空间？

# ios - UIBezierPath 未绘制

> ID：11023736
> 
> 赞同：0
> 
> 时间：2012-06-13T21:42:46.217
> 
> 标签：ios, uiview, uigesturerecognizer, drawrect, uibezierpath

我正在尝试实现一种基于手势识别绘制线条的方法，但我无法显示 UIBezierPath。我知道手势识别器正在运行，因为每次激活该方法时我都会打印以记录。让我感到困惑的是，我在尝试绘制 BezierPath 之前绘制的蓝线会显示，但 BezierPath 不会。即使我手动添加任意点也不会绘制任何内容，例如：

```
[myPath addLineToPoint:CGPointMake(50, 50)]; 
```

这是我的 UIView 中的代码：

```
- (void)drawRect:(CGRect)rect
{

CGContextRef ctx = UIGraphicsGetCurrentContext(); 
CGContextSetRGBStrokeColor(ctx, 0, 0, 1.0, 1); 
CGContextMoveToPoint(ctx, 0, 150);
CGContextAddLineToPoint( ctx, 480, 150);
CGContextStrokePath(ctx);

[myPath addLineToPoint:CGPointMake(50, 50)];
[myPath stroke];
}

- (IBAction)handlePan:(UIPanGestureRecognizer *) recognizers {

CGPoint translation = [recognizers translationInView:self];
NSLog(@"Logged");

[myPath addLineToPoint:CGPointMake(translation.x, translation.y)];
[self setNeedsDisplay];
} 
```

谢谢你的帮助！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-14T09:02:53.890

你在哪里初始化 myPath？确保它已初始化。

就像

```
CGContextMoveToPoint(ctx, 0, 150); 
```

，您需要在添加行之前调用 move to point on myPath

```
[myPath moveToPoint:CGPointMake(0,150)];
[myPath addLineToPoint:CGPointMake(50, 50)]; 
```

# java - 如何导出一个带有 sqlite 数据库的 jar？

> ID：11023738
> 
> 赞同：2
> 
> 时间：2012-06-13T21:42:55.953
> 
> 标签：java, eclipse, sqlite, deployment, jar

我有一个想要分发的程序，但没有提供使用的源代码或数据库。它是一个 sqlite 数据库，不需要更新。我尝试使用 eclipse fatjar 并更改查找 jar 的位置，但是当我运行程序时，它只是在与 jar 相同的目录中创建一个空白数据库文件。我只想要一个可以分发的文件。

* * *

从被认为相关的评论中：

> ..在使用 TXT 文件测试后包含 XML。

我会，但这个数据库有 80,000 行长，有 4 列。它只会随着程序的更新而变得更大，而不是在运行时。

> 将其放在服务器上并具有 Web 界面。

我真的想避免使用任何互联网连接。如果有人想反编译jar，我不在乎。我只是希望它可以*通过双击来工作，并且没有多余的文件。*

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-13T22:14:39.033

> （部署）..可用性和整洁对我来说很重要

这让我认为真正需要的是跨平台安装程序。用户获取一个文件并双击它，“按照提示”（如果需要任何提示）并提取应用程序。准备启用。

它可能会创建多个文件，但这对最终用户来说在很大程度上是不可见的。'不在现场是疯了'。

> 我想避免使用任何互联网连接..

我建议你重新考虑一下。什么大小的应用程序。Jar'd 什么时候来？几兆？在当今互联网流量大的时代，这算不了什么。那是 2 分钟的 YouTube。

具有互联网连接的设备与具有（例如）CD/DVD 驱动器以加载软件的机器的比率也在发生变化。现在，能够运行 J2SE 的机器拥有 Internet 连接的机器比拥有驱动器的机器还多。我有一台可以运行 J2SE 的台式机和上网本。两者都有互联网连接，但只有台式电脑有 CD/DVD 驱动器。

如果是这种情况（说到我的意思），请查看[Java Web Start](https://stackoverflow.com/tags/java-web-start/info)来部署应用程序。和数据库。非常用户友好，具有良好的桌面集成。

> 它大约是 50mb，但问题是并非所有最终用户都可以随时访问互联网。可以通过 Internet 分发应用程序，但我不想依赖它来访问数据库或一起加载应用程序。

那是没有必要的。JWS 在本地缓存应用程序资源。它将检查服务器**是否**有更新的 Jars，但可以配置为允许从缓存副本启动，即使当时没有互联网连接。要配置的启动文件元素如下所示：

```
<update check="always" policy="prompt-run"> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-13T22:03:08.210

不知道您是否可以使用 SQLite 数据库执行此操作，但 Derby 支持 jar：路径：[http ://db.apache.org/derby/docs/dev/devguide/cdevdvlp17453.html](http://db.apache.org/derby/docs/dev/devguide/cdevdvlp17453.html)

或者，在启动时将数据库从 jar 提取到文件系统并指向那里。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-13T22:26:32.033

我认为您可以执行以下操作：

*   将您的数据库打包到类路径中。
*   当应用程序加载时，将数据库复制到某个临时目录（如 /tmp）
*   指示 sqlite 从那里读取它（通过设置 jdbc url）
*   添加一个 jvm 挂钩以在应用程序关闭时删除文件。

这应该像一个魅力。

暗示：

用于`getClass().getResourceAsStream();`获取类路径上文件的引用。

# c++ - 我可以用 wm_copydata 模拟应用程序退出代码吗？

> ID：11023739
> 
> 赞同：1
> 
> 时间：2012-06-13T21:42:56.653
> 
> 标签：c++, c++builder

我第一次在这里发帖。

我用 borland c++ 构建了一个小型应用程序，它由商业第三方应用程序通过 shell 命令执行。然后，第二个应用程序会一直等待，直到它收到我的应用程序的退出代码。我想要做的是通过发送消息 wm_copydata 将“0”或“1”发送到第二个应用程序，以模仿退出代码。我这样做是因为我希望我的应用程序在不退出的情况下发送退出代码！这可能吗？

问题是数据永远不会到达，也不会被第二个接收应用程序处理。我实际上不确定第二个应用程序是否实现了处理 wm_copydata 消息的代码，我只是假设它确实......

感谢您的帮助，因为我正在尝试构建一个将我们部门不同供应商的不同软件相互连接的应用程序。这是我正在使用的代码：

```
void SendMyMessage(char* command)
{
HWND Hamilton_Window_Handle;
int len;
char title[254];
AnsiString stemp;
AnsiString hname = "HAMILTON RUN CONTROL";
Hamilton_Window_Handle = FindWindow(0,0);
while (Hamilton_Window_Handle != 0)
    {
    len = GetWindowText(Hamilton_Window_Handle, title, 255);
    stemp = UpperCase(title);
    if (AnsiPos(hname, stemp) > 0)
            {break;}
    Hamilton_Window_Handle = GetWindow(Hamilton_Window_Handle, GW_HWNDNEXT);
    }

COPYDATASTRUCT cds;
cds.dwData = 0;
cds.cbData = strlen(command) +1;
cds.lpData = command;
SendMessage(Hamilton_Window_Handle, WM_COPYDATA, 0, (LPARAM)&cds);
if(AnsiString(command) == "1")
    {
    Form1->Label1->Caption="Barcodes passed consistency check!";
    Form1->Label1->Font->Color = clGreen;
    }
else
    {

    Form1->Label1->Caption="Barcodes failed consistency check!";
    Form1->Label1->Font->Color = clRed;
    }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-14T23:36:21.247

除了@Adriano 所说的之外，您生成的进程不能在不先退出自身的情况下将退出代码返回到启动进程。毕竟，这就是为什么它被称为**退出代码的原因。**在进程终止之前，Windows 不会看到进程的退出代码。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-14T20:37:14.443

简而言之：不，这是不可能的。`WM_COPYDATA`旨在将数据从一个应用程序传递到另一个应用程序，但**两个应用程序都**必须**知道**并**使用**此消息。此外，他们必须为其数据共享一个*接口。*它不是自动的，您不能假设它确实如此，因为进程退出代码和此消息是不相关的（如果应用程序等待进程退出它为什么应该接受`WM_COPYDATA`？如果它接受该消息，那么它具有什么结构和目的？） . 如果其他人假设您的应用程序接受 WM_COPYDATA 而不是例如命令行参数，则为图像。您是否处理具有该含义的消息？

您可能需要的是`fork()`Unix 上可用的命令。Windows 不提供此功能，您可以*尝试*使用它来模仿它的行为，`NtCreateProcess()`但这可能非常棘手（而且我不知道它如何与复杂的 GUI 集成）。

一个可能的解决方案是创建一些共享内存，复制所有私有数据并运行另一个进程。然后，第二个进程可以从共享内存中读取其状态，而第一个进程只需使用适当的退出代码终止。

# ant - 在 ant 1.7+ 中运行的 ant 1.65 效果构建中的错误

> ID：11023744
> 
> 赞同：0
> 
> 时间：2012-06-13T21:43:35.593
> 
> 标签：ant, junit, jvm, ivy

**更新的问题**

我（因为意识到我的类路径中有两个版本的 Ant，正如我的构建器所报告的那样）发现我的核心问题只是我的类路径中存在旧版本的 Ant。

为了澄清，在我的构建过程开始时报告了以下内容：

```
WARNING: multiple versions of ant detected in path for junit 

WARNING: multiple versions of ant detected in path for junit 
    [junit]          jar:file:/usr/share/ant/lib/ant.jar!/org/apache/tools/ant/Project.class
    [junit]      and jar:file:/home/vagrant/Development/..../lib/ant-1.6.5.jar!/org/apache/tools/ant/Project.class 
```

那么，我的新（简化）问题是：

*   在运行我的 junit 测试时，强制 ant 和 junit 使用正确的 ant 版本的最佳方法是什么，因为由于 ivy 某些其他版本的 ant 可能是我的类路径中的临时依赖项？

**原始问题**

我注意到这个版本的 ANT 修复了一个 junitvm，但是：

[http://svn.apache.org/repos/asf/ant/core/trunk/WHATSNEW](http://svn.apache.org/repos/asf/ant/core/trunk/WHATSNEW)

*   此错误涉及由 ANT 创建的 junitvmwatcher 文件未关闭的事实。
*   但是，在我最近的 ant 构建中，jvmwatcher 错误仍然存​​在。
*   任何想法为什么这个错误可能存在于最新的 ant 安装中？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-14T20:04:53.493

正确版本的 ANT 应该是运行构建的版本。所以，我经常做的是在我的**ivy.xml**文件中为 ANT 创建一个全局排除项，如下所示：

```
 ..
    ..    
    <!-- Global exclusions -->
    <exclude org="org.apache.ant"/>
</dependencies> 
```

# winforms - 如何让 SharePoint 操作调用 Click-Once 启动的 WinForms 应用程序中的功能？

> ID：11023747
> 
> 赞同：0
> 
> 时间：2012-06-13T21:43:47.467
> 
> 标签：winforms, sharepoint, clickonce

我们有一个用户一直打开的 SharePoint 网站（业务仪表板的类型）。我们有一个 WinForms 应用程序，它在特定端口上侦听用户单击 SharePoint 网站上的 Web 部件时，我们在 WinForms 中获取 JSON，解析请求并在 WinForms 中启动功能。本质上允许网站在同一台客户端计算机上运行 WinForms 应用程序中启动功能。

当我们在 XP 中运行时，这非常有效。当我们迁移到 Windows 7（具有提升的 UAC）时，此功能停止工作。由于我们通过 ClickOnce 启动 WinForms 应用程序，并且 ClickOnce 应用程序不能以管理员身份运行，因此我们当前的代码将无法运行。

由于您在 StackOverflow 上看到的所有原因，我们无法让 ClickOnce 应用程序以管理员身份运行。

所以我的问题是：当用户单击 SharePoint 网站中的某些内容时，我们如何在 ClickOnce 部署的 WinForms 应用程序中调用功能？让 WinForms 应用程序调用 Sharepoint Web 服务非常容易，但我需要反其道而行之。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-19T07:45:07.760

您可以通过调用部署清单 URL 来调用 ClickOnce 应用程序。如果您希望能够调用应用程序并让它执行特定的操作，请调用部署清单 URL 并将查询参数传递给它，然后让应用程序处理查询参数。

[本文](http://msdn.microsoft.com/en-us/library/ms172242%28VS.80%29.aspx)向您展示如何使用 ClickOnce 应用程序处理查询参数。

# c# - 动态扩展应用程序的功能？

> ID：11023748
> 
> 赞同：7
> 
> 时间：2012-06-13T21:43:54.730
> 
> 标签：c#, asp.net, asp.net-mvc, asp.net-mvc-4

我最近在使用 ASP.NET MVC3/4 时遇到了[一种](http://nileshhirapra.blogspot.in/2012/02/aspnet-mvc-pluggable-application.html)开发可插拔应用程序模块的方法，我喜欢这种方法的简单性。目前，我的应用程序结构如下：

![在此处输入图像描述](../Images/67bd6026b79c13a83b2045d821c8e613.png)

因此，任何想要为我的应用程序开发扩展的人，都遵循上述[教程](http://nileshhirapra.blogspot.in/2012/02/aspnet-mvc-pluggable-application.html)中的方法并创建一个保留在`Areas`文件夹中的扩展。我认为当添加新的`Areas`（创建为新项目）时，`.pdb`会创建文件并将其放置在`bin`目录中。我的问题是这样的：

*   如何分发`Areas`可插拔模块？
*   如何更改以下代码，以便当有人将新内容`Area`放入`bin`文件夹时，应用程序会自动将其拾取并创建链接？插件作者应该怎么做才能启用它？

在我的`_Layout.cshtml`（全局共享布局）中，我执行以下操作来构建链接：

```
<ul>
      <li>@Html.ActionLink("Area1", "Index", "Area1", new { Area = "Area1" }, null)</li>
      <li>@Html.ActionLink("Area2", "Index", "Area2", new { Area = "Area2" }, null)</li>
      <li>@Html.ActionLink("Area3", "Index", "Area3", new { Area = "Area3" }, null)</li>
</ul> 
```

为简单起见，假设区域名称是唯一的。关于如何做到这一点的任何建议？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-06-18T09:19:43.073

## 如何将区域分配为可插拔模块？

不要在托管 Web 应用程序中创建区域，而是创建单独的项目，编译为单独的 dll。将 dll 复制到您想要使用它的任何 Web 应用程序中。请记住将所有静态文件设置为“EmbeddedResource”。

## 如何更改以下代码，以便当有人将新区域放入 bin 文件夹时，应用程序会自动将其拾取并创建链接？插件作者应该怎么做才能启用它？

您可以使用 MvcContrib PortableAreaRegistration 的“总线”从便携式区域向“总线”上的任何人发送消息、命令。这可以是托管网络应用程序，或者理论上独立的区域可以相互发送消息。

在 github 上创建了两个粗略但实用的演示代码：

### MVC3 版本：

[https://github.com/AkosLukacs/PluggablePortableAreas](https://github.com/AkosLukacs/PluggablePortableAreas)

### MVC4 RC 版本：

[https://github.com/AkosLukacs/PluggablePortableAreasMVC4](https://github.com/AkosLukacs/PluggablePortableAreasMVC4)

首先，您定义一个可以携带您需要的信息的消息。只是一个具有一些属性的 POCO (PluggablePortableAreas.Common\RegisterAreaMessage.cs)：

```
public class RegisterAreaMessage : IEventMessage
{
    public string LinkText { get; private set; }
    public string AreaName { get; private set; }
    public string ControllerName { get; private set; }
    public string ActionName { get; private set; }
    //...
} 
```

为该消息类型创建一个处理程序 (PluggablePortableAreas.Common\RegisterAreaEventHandler.cs)：

```
public class RegisterAreaEventHandler : MessageHandler<RegisterAreaMessage>{} 
```

在这种情况下，MessageHandler 只是将接收到的消息添加到一个 static`ConcurrentBag<RegisterAreaMessage>`中。如果您愿意，可以使用 DI，但要保持简单。

您可以像这样从便携式区域发送消息（Areas\DemoArea1\Areas\Demo1\Demo1AreaRegistration.cs）：

```
 //the portable area sends a message to the 'bus'
 bus.Send(new RegisterAreaMessage("Link to the Demo area", AreaName, DefaultController, DefaultAction)); 
```

通过迭代消息集合（PluggablePortableAreas.Web\Views\Shared_Layout.cshtml）来显示动态添加的链接：

```
 @foreach(var sor in PluggablePortableAreas.Common.RegisterAreaEventHandler.RegisteredAreas) {
                <li>@Html.ActionLink(sor.LinkText, sor.ActionName, sor.ControllerName, new{Area=sor.AreaName}, null)</li>
                } 
```

还要注意一件事：使用“完全限定”的区域名称。如果您没有明确指定区域名称，MVC 会假定它是当前区域。没有区域没有问题，但第二个将指向`"/path_to_your_app/CurrentArea/Home"`而不是`"/path_to_your_app/Home"`.

```
<li>@Html.ActionLink("Home", "Index", "Home", new { Area = "" }, null)</li>
<li>@Html.ActionLink("I don't work from the portable area!", "Index", "Home")</li> 
```

### 还要注意一件事！

VS中的开发服务器感觉有点“飘忽不定”，有时便携区不加载。在完整的 IIS 中可靠地工作...

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-18T09:41:46.013

你在做什么看起来很像[MVCContrib](http://mvccontrib.codeplex.com/documentation)的便携式区域。

他们使用消息/应用程序总线模式在 Web 元素上动态添加新的小部件。MessageHandlers 是通过反射发现的，每条消息都被传递给它们。因此，在您的情况下，插件作者应该只为标准消息实现一个处理程序（比如注册全局菜单链接）。

便携式区域的资源是嵌入的，因此可以将单个 dll 放入 bin 文件夹中。为了自动获取它并在您的应用程序中使用它，您必须通过[FileSystemWatcher](http://msdn.microsoft.com/en-us/library/system.io.filesystemwatcher.aspx)观看 bin 文件夹并重新启动您的应用程序（我认为没有其他方法可以将新的 .dll 加载到 asp.net 应用程序中的 AppDomain 中）。

您也可以使用 ASP.NET 4 中的 BuildManager 功能从其他文件夹加载 .dll。更多有用信息请参见[此处](http://haacked.com/archive/2010/05/16/three-hidden-extensibility-gems-in-asp-net-4.aspx)。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-15T16:15:34.160

这看起来类似于 Orchard CMS 执行模块的方式。

看看他们的[画廊](http://gallery.orchardproject.net/)......这些模块作为 Nuget 包分发，包含整个模块项目。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-06-18T09:28:41.810

[您好，您可以在nopcommerce](http://nopcommerce.codeplex.com/)项目中寻找相当不错的插件架构。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-06-18T10:17:44.673

**看看这个[教程](http://fzysqr.com/2010/09/10/asp-net-mvc2-plugin-architecture-tutorial-part-3)，我想它会对你有很大帮助。**

# mongodb - 与用户共享文档

> ID：11023749
> 
> 赞同：1
> 
> 时间：2012-06-13T21:43:56.367
> 
> 标签：mongodb, redis, data-sharing, nosql

我必须选择一个数据库来实现共享系统。

我的系统将有用户和文档。我必须与几个用户共享一个文档。

* * *

示例：有 2 个用户，并且有一个文档。

因此，如果我必须与两个用户共享该文档，我可以采取以下可能的解决方案：

我正在使用的当前方法是使用 MySQL（我不想使用它）：

```
Relational Databases (MySQL)
    Users Table = user1, user2
    Docs Table = doc1
    Docs-User Relation Table = doc1, user1
                               doc1, user2 
```

* * *

我想使用这样的东西：

```
NoSQL Document Stores (MongoDB)
    Users Documents:
        {
            _id: user1,
            docs_i_have_access_to: {doc1}
        }
        {
            _id: user2,
            docs_i_have_access_to: {doc1}
        }
    Document's Document:
        {
            _id: doc1
            members_of_this_doc: {user1, user2}
        } 
```

* * *

而且我还不知道如何在 Redis 这样的键值存储中实现。

所以我只是想知道，我上面给出的 MongoDB 方式会是最好的解决方案吗？还有其他方法可以实现吗？也许使用另一个数据库解决方案？我是否应该尝试使用 Redis 来实现它？

我应该选择哪种数据库和哪种方法最适合共享数据，为什么？

注意：我想要一些高度可扩展和持久的东西。:D

谢谢。:D

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-13T22:21:52.483

实际上，您需要表示多对多关系。一个用户可以拥有多个文档。一个文档可以在多个用户之间共享。

请参阅我之前对这个问题的回答：[如何在 redis 中建立多对多关系](https://stackoverflow.com/questions/10907942/how-to-have-relations-many-to-many-in-redis/10917710#10917710)

对于 Redis，表示与集合数据类型的关系是一种非常常见的模式。对于这种数据模型，您可以期望获得比使用 MongoDB 更好的性能。作为奖励，您可以轻松有效地找到哪些用户拥有给定的共同文档列表，或者哪些文档由给定的一组用户共享。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-13T21:55:58.293

仅考虑这个简单的示例（您只需要保留谁拥有什么）SQL 似乎是最合适的，因为它会免费提供其他选项，例如报告谁拥有多少文档、最受欢迎的文档、最活跃的用户等成本几乎为零+数据将更加一致（没有重复，可能是外键）。当然，除非您拥有数百万份文件，否则这是有效的。

如果我在面向文档和关系数据库之间进行选择，我将主要根据文档本身的结构做出决定。无论它们都是统一的还是可能具有不同类型的不同字段，您是否嵌套了子文档或数组，并能够按其内容进行搜索。

# php - 计算字符串中位数的函数

> ID：11023753
> 
> 赞同：28
> 
> 时间：2012-06-13T21:44:09.400
> 
> 标签：php, counting, digits

我正在寻找一个快速的 PHP 函数，给定一个字符串，它会计算该字符串中的数字字符（即数字）的数量。没找到，有这个功能吗？

* * *

## 回答 #1

> 赞同：58
> 
> 时间：2012-06-13T21:46:20.180

这可以通过正则表达式轻松完成。

```
function countDigits( $str )
{
    return preg_match_all( "/[0-9]/", $str );
} 
```

该函数将返回找到模式的次数，在本例中为任意数字。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2012-06-13T21:54:12.810

首先[拆分您的字符串](http://www.php.net/manual/en/function.str-split.php)，然后[过滤](http://www.php.net/manual/en/function.array-filter.php)结果以[仅包含数字](http://www.php.net/manual/en/function.is-numeric.php)字符，然后简单地[计算](http://www.php.net/manual/en/function.count.php)结果元素。

```
<?php 

$text="12aap33";
print count(array_filter(str_split($text),'is_numeric')); 
```

编辑：出于好奇添加了一个基准：（上述字符串和例程的 1000000 循环）

preg_based.php 是 overv 的 preg_match_all 解决方案

```
harald@Midians_Gate:~$ time php filter_based.php 

real    0m20.147s
user    0m15.545s
sys     0m3.956s

harald@Midians_Gate:~$ time php preg_based.php 

real    0m9.832s
user    0m8.313s
sys     0m1.224s 
```

正则表达式显然更胜一筹。:)

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2012-06-13T22:12:52.147

对于 PHP < 5.4：

```
function countDigits( $str )
{
    return count(preg_grep('~^[0-9]$~', str_split($str)));
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-13T21:44:10.163

此函数遍历给定的字符串并检查每个字符以查看它是否为数字。如果是，则增加位数，然后在最后返回。

```
function countDigits($str) {
    $noDigits=0;
    for ($i=0;$i<strlen($str);$i++) {
        if (is_numeric($str{$i})) $noDigits++;
    }
    return $noDigits;
} 
```

# xcode4.3 - 无法使用 TestFlight 安装 xCode 4.3 beta 应用程序

> ID：11023757
> 
> 赞同：1
> 
> 时间：2012-06-13T21:44:14.857
> 
> 标签：xcode4.3, testflight

我刚刚升级到 xCode 4.3 并用它来生成 iPad 应用程序的新版本，大约 50 位 beta 测试人员已经使用了几个月。我像往常一样通过 TestFlight 分发了测试版应用程序。

大多数测试人员升级没有问题，但一些测试人员在尝试安装新版本时收到 TestFlight 消息“您不允许此设备安装此版本”。我以前从未见过这条消息。他们的 iPad UDID 肯定在构建的 embedded.mobileprovision 文件中，并且在之前的版本中一切正常。

我 - 或测试人员 - 做错了什么，我们如何纠正它？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-09T00:48:22.150

嗨，我也遇到了同样的情况，看来您必须从 Xcode（而不是 Apple 开发网站）生成您的移动配置文件，并且您应该使用刚刚在您的机器上生成的相同配置文件更新您的应用程序权限（TestFlight）所以基本上，使用 Xcode 生成和存档应用程序的机器必须生成配置文件，然后您应该使用此文件更新您的 testflight 应用程序权限。

这有任何意义吗？

希望这对你有用 testflight 真的很好用，我的所有应用程序和硬件设备都面临同样的问题（世界各地的测试人员）

谢谢

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-19T12:18:40.997

事实证明，这显然是 Testflight 中的一个错误。我试图通过他们的支持论坛和多封没有真正答案的电子邮件来解决这个问题。我不想切换服务，因为我的测试人员非常了解 Testflight 系统。但最终转[投迪亚维](http://www.diawi.com)。我的测试人员能够使用 Diawi 毫无问题地安装该应用程序。

# .net - 在 Unity 中使用委托解析实例

> ID：11023761
> 
> 赞同：6
> 
> 时间：2012-06-13T21:44:35.593
> 
> 标签：.net, unity-container, enterprise-library, structuremap

自 2011 年 2 月以来，Unity 是否[改进了这个委托故事](https://xhalent.wordpress.com/2011/02/02/resolving-instances-using-delegates-in-unity/)以实现与 StructureMap 的平等？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-06-14T05:03:35.693

是的。实际上，这与 Unity 1.0 作为注入工厂扩展一起提供，因此博客文章关于不存在该功能是错误的。

在 Unity 2.0 中，故事变得容易多了。你可以做：

```
container.RegisterType<IWhatever>(
    new InjectionFactory(container => whateverFunctionYouWant())); 
```

这会导致临时注册；你可以使用任何你想要的生命周期管理器。

# clojure - leiningen 有多个主要课程

> ID：11023762
> 
> 赞同：17
> 
> 时间：2012-06-13T21:44:44.300
> 
> 标签：clojure, leiningen

我想有两个主要的类（或更多）与 leiningen，然后能够在 java 命令行中选择哪一个。例如我有：

```
(ns abc (:gen-class))
(defn -main [] (println "abc"))

(ns def (:gen-class))
(defn -main [] (println "def")) 
```

使用 project.clj 具有：

```
(defproject my-jar "0.0.1"
 :description "test"
 :dependencies [
 ]
 :main abc) 
```

然后我用 构建`lein uberjar`并运行：

```
java -cp my-jar-0.0.1-standalone.jar abc
java -cp my-jar-0.0.1-standalone.jar def 
```

我知道，当我在 project.clj 中指定时，它会将其作为清单中的主类调用，但是如果不放置*某些东西*`:main abc`，我就无法让它运行。但无论哪种方式，当我尝试运行“def”主程序时，我都找不到一个类：

 *```
Exception in thread "main" java.lang.NoClassDefFoundError: def 
```

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2013-09-24T17:31:28.470

这至少适用于 leiningen 2.0+

```
(defproject my-jar "0.0.1"
 :description "test"
 :dependencies [
 ]
 :profiles {:main-a {:main abc}
           {:main-b {:main def}}
 :aliases {"main-a" ["with-profile" "main-a" "run"]
           "main-b" ["with-profile" "main-b" "run"]}) 
```

然后你可以像这样运行每个 main：

```
lein main-a
lein main-b 
```

扩展为：

```
lein with-profile main-a run
lein with-profile main-b run 
```

我在我的一个项目中使用它，它运行良好。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2012-06-13T22:16:38.760

我添加`:aot [abc def]`到 project.clj 以生成编译代码并且它工作。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2016-08-29T17:01:34.643

在 lein 2.7.0 的运行任务以及生成的 uberjar 中对我有用的内容如下...

项目.clj：

```
(defproject many-mains "0.1.0-SNAPSHOT"
  :description "Project containing multiple main methods"
  :dependencies [[org.clojure/clojure "1.8.0"]]
  :main nil
  :target-path "target/%s"
  :profiles {:main-abc {:main many-mains.abc}
             :main-def {:main many-mains.def}
             :main-ghi {:main org.rekdev.mm.ghi}
             :core {:main many-mains.core}
             :uberjar {:aot :all}}) 
```

对于像...这样的来源

```
$ cat src/many_mains/abc.clj
(ns many-mains.abc
  (:gen-class))

(defn -main
  ""
  [& args]
  (println "Hello, from many-mains.abc!")) 
```

这让 lein 像...一样运行工作

```
$ lein with-profile main-abc run
Hello, from many-mains.abc! 
```

在命令行中，many-mains 中的“-”需要变成“_”，这使其成为合法的 Java 类名。

```
$ java -cp target/uberjar/many-mains-0.1.0-SNAPSHOT-standalone.jar many_mains.abc
Hello, from many-mains.abc! 
```

围绕 :main nil 对 MANIFEST.MF 的影响，Lein 2.7.0 和之前的版本之间似乎发生了一些行为变化。我在这里得到的东西就像 Lein 2.7.0 中的冠军。完整来源在[https://github.com/robertkuhar/many-mains](https://github.com/robertkuhar/many-mains)*

# html - Google 阅读器菜单如何保持不变？

> ID：11023764
> 
> 赞同：0
> 
> 时间：2012-06-13T21:44:47.370
> 
> 标签：html, css, menu

我想复制 Google 阅读器左侧导航的功能（您可以在其中找到订阅按钮、“主页”、“所有项目”等）。

我查看了 HTML 和 CSS，但我无法弄清楚。他们没有使用框架，我也没有找到任何***position:fixed***语句。

任何人都可以阐明我所缺少的东西吗？谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-13T21:53:03.093

它使用固定高度（在调整大小时更改）和`overflow-y: auto`2 列。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-13T21:52:12.993

你是指左边的菜单，标题是“所有项目”、“探索”和“订阅”吗？

如果是这样，请查看此代码`<div id="sections-holder"`的内联高度并`overflow:auto`添加滚动条

所以实际上菜单的构建是标准的，右边的窗口会导致效果

但是，如果您是指其他地方，请告诉我...

# git - 如何获取已应用于 git 存储库中文件的所有标签？

> ID：11023769
> 
> 赞同：0
> 
> 时间：2012-06-13T21:45:12.513
> 
> 标签：git

当我`git log filename`列出文件已通过的提交时，我想查看应用到存储库的*所有*标签，其中文件正是`git log filename`. 这可能吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-13T23:12:38.233

首先，找出你感兴趣的提交的提交哈希——在这个例子中它是 6502bcc16b3790cc22cb771d1da3e8f35b4009c0：

```
$ git log «filename»
commit 6502bcc16b3790cc22cb771d1da3e8f35b4009c0
Author: Mike Morearty <mike@morearty.com>
Date:   Wed Jun 13 16:04:56 2012

    added «filename» 
```

然后，用于`git tag --contains`询问包含该提交的所有标签：

```
$ git tag --contains 6502bcc16b3790cc22cb771d1da3e8f35b4009c0
tag1
tag2 
```

如果你想在一行中完成所有这些，这里有一种方法（也许有更有效的方法）：

```
$ git tag --contains $(git log -1 --pretty=%H «filename») 
```

# php - PHP mySQL - 我如何只打印两个具有共同名称的事物的不同属性？

> ID：11023775
> 
> 赞同：0
> 
> 时间：2012-06-13T21:45:38.443
> 
> 标签：php, mysql, sql, loops, while-loop

我正在尝试在页面上打印出产品列表。这是迄今为止的蛋糕。但是我的一些项目共享名称但具有不同的属性。示例就像...：

```
product:

keyboard
keyboard

size:

25 inches
23 inches

color:

red
blue 
```

我的表看起来像这样：id、product、size、color 等等……

所以我的 .php 我正在做我的查询和打印看起来像这样

```
<div id="accordion">
<?php
$letter = $_GET['letter'];
//echo "$id";
include("database.php");
$result = mysql_query("SELECT UPPER(product) AS upperName, PRODUCTS.* FROM PRODUCTS WHERE product LIKE '$letter%' ORDER BY UPPER(product) ");

$prodName = "";
while($row = mysql_fetch_array($result))
{
    if ($row['upperName'] != $prodName)
    {
        print('<div style="background-color:#666; padding-bottom:25px; margin-bottom:25px;">');
        print ("<h1>" . "$row[product]" . "</h1>");
    }

        print ("$row[ndc]" . "<br />");
        print ("$row[size]" . "<br />");
        print ("$row[strength]" . "<br />");
        print ("$row[imprint]" . "<br />");
        print ("$row[form]" . "<br />");
        print ("$row[color]" . "<br />");

        print('</div>');
    $prodName = $row['upperName'];  

}
mysql_close($linkID);

?>
</div> 
```

我的问题来自尝试设置属性的样式..

你看到那个 /div 标签了吗？我想在手风琴中设计这些东西的样式，但是对于在该手风琴中共享相同名称的每个产品，这些东西都会重复。因此，如果我在那里包含 div，它会以相同的名称打印 3 次 3 个结束 div 标签（因此破坏了我所有的 html nooo ！！）

有没有办法循环？或者使用某种条件逻辑来打印最重要的东西，一次是所有产品共享的产品名称，然后循环并打印所有不同的属性，然后当每个属性完成时，然后包含我的结束 html？

因此，如果我有 6 个产品，一半被命名为“键盘”，另一半被命名为“鞋子”，我可以让它打印出 TABLE 产品名称：我所有属性的 KEYBOARD 表我所有属性的结束表 end TABLE

TABLE 产品名称：我的所有属性的 SHOES 表 结束我的所有属性的表 end TABLE

这样我就可以设置我所有的属性。如果没有正确解释，我真的很抱歉，我还在学习。任何帮助表示赞赏！

* * *

您可能不需要弄清楚我的问题的额外内容只是我正在打印到的表的示例以及为什么属性打印方式是一个问题。1-2-3-4-5-6-7-8-9 是属性的数据。

```
<table cellspacing="0" cellpadding="0" border="0" width="649">
    <tr>
        <td width="180" height="10" valign="top"></td><td width="36" height="10" valign="top"></td><td width="433" height="10" valign="top"></td>
    </tr>
    <tr>
        <td width="180" valign="top"><img src="images/slide1.gif" width="180" height="200" border="0" /></td>
        <td width="36" valign="top"></td>
        <td width="433" valign="top"><table cellspacing="0" cellpadding="0" border="0" width="433">
            <tr>
                <td valign="top"><span class="in-table-head">Name:</span></td>
                <td valign="top"><span class="in-table-name">$row[name]</span></td>
            </tr>
            <tr>
                <td valign="top"><span class="in-table-head">Therapeutic Category:</span></td>
                <td valign="top"><span class="in-table-name">$row[therapeutic]</span></td>
            </tr>
            <tr>
                <td colspan="2" valign="top"><span class="in-table-providers">Information for Providers</span></td>
            </tr>
        </table></td>
    </tr></table>
<table cellspacing="0" cellpadding="0" border="0" width="649">
    <tr>
        <td><span class="in-table-att">NDC#:</span></td>
        <td><span class="in-table-att">Strength:</span></td>
        <td><span class="in-table-att">Size:</span></td>
        <td><span class="in-table-att">Imprint:</span></td>
        <td><span class="in-table-att">Form:</span></td>
        <td><span class="in-table-att">Color:</span></td>
        <td><span class="in-table-att">Shape:</span></td>
        <td><span class="in-table-att">Pack Size:</span></td>
        <td><span class="in-table-att">Rating:</span></td>
    </tr>
</table>
<table cellspacing="0" cellpadding="0" border="0" width="649">
    <tr>
        <td>1</td>
        <td>2</td>
        <td>3</td>
        <td>4</td>
        <td>5</td>
        <td>6</td>
        <td>7</td>
        <td>8</td>
        <td>9</td>
    </tr>
</table> 
```

再次感谢任何关注此问题的人！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-13T21:53:02.047

停止按名称匹配，但开始使用 sku 作为选择器。这样，无论您有多少个键盘，您都可以随时掌握。设置您的页面以传递 sku 而不是通用名称。

否则，您需要在 where 语句中添加更多标准，例如尺寸、重量、颜色、价格等……以获得可靠的结果。

- 更新 -

一个例子。

page.php?product_type=键盘

```
<?php
// set up database
$db = mysqli_connect("localhost", "user", "pass", "database_name");
// Just using mysql escape string, you should consider adding more securty checking to prevent injection
$producttype = mysql_real_escape_string($_GET['product_type']);
$result = $db->query("SELECT * FROM `products` WHERE `products`.`type`='$producttype'");
$features["width"][]
$features["height"][]
$features["color"][]
$features["whatever"][]
while ($row = $result->fetch_assoc())
    {
    $features["width"][] = $row["width"];
    $features["height"][] = $row["height"];
    $features["color"][] = $row["color"];
    $features["whatever"][] = $row["whatever"];
    }
// printing the features
echo "You have selected $producttype<BR>";
echo "The following widths can be selected<BR><UL>";
foreach($features["width"] as $width)
    echo "<LI>$width</lI>";
echo "</UL><P>The following heights can be selected<BR><UL>";
foreach($features["heights"] as $height)
echo "<LI>$height</lI>";
    echo "</UL><P>The following colors can be selected<BR><UL>";
foreach($features["colors"] as $color)
    echo "<LI>$color</lI>";
echo "</UL><P>The following whatevers can be selected<BR><UL>";
foreach($features["whatevers"] as $whatevers)
    echo "<LI>$whatevers</lI>";
echo "</UL>";
echo "have a nice day";
?> 
```

# git - Git：如何从其 .gitattributes 标识中获取文件的特定版本？

> ID：11023782
> 
> 赞同：2
> 
> 时间：2012-06-13T21:46:12.007
> 
> 标签：git, gitattributes, ident

我有一些 Python 脚本在结帐时有一个由 .gitattributes 设置的 $Id$ 字段。如何使用此 ident 字符串来检查（或以其他方式识别）文件的特定版本？

当客户使用脚本但不确定他们已签出哪个版本时，就会出现问题。最好只询问 $Id: ... $ 并查看他们使用的版本。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-14T10:14:36.257

$id: 后面的字符串是文件内容的 SHA。所以你可以简单地做：

```
git show <SHA> 
```

这将向您显示由 SHA 标识的文件的内容。

# c++ - 可以槽化基非 QObject 类的虚函数吗

> ID：11023783
> 
> 赞同：3
> 
> 时间：2012-06-13T21:46:17.120
> 
> 标签：c++, qt

如果我在非 QObject 基类中声明一个虚拟函数，然后将其作为具有 Q_OBJECT 宏并且将 QObject 作为基类之一的派生类中的插槽覆盖，它应该可以正常工作吗？

是否保证虚拟通话有效？如果你连接到派生类的插槽会发生什么？

```
class Base
{
public:
    virtual void f();
};

class Derived: public QObject, public Base
{
    Q_OBJECT
public slots:
    virtual void f();
}; 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-06-13T21:50:38.897

是的：

> 由于槽是普通的成员函数，因此在直接调用时它们遵循普通的 C++ 规则。<...> 您还可以将插槽定义为虚拟的，我们发现这在实践中非常有用。

[http://qt-project.org/doc/qt-4.8/signalsandslots.html#slots](http://qt-project.org/doc/qt-4.8/signalsandslots.html#slots)

在您的示例`Derived::f`中是一个普通的虚函数。如果直接调用它，它会按预期工作，就像文档中所说的那样。当被信号调用时，被调用，`qt_static_metacall`生成`moc_Derived.cpp`如下：

```
void Derived::qt_static_metacall(QObject *_o, QMetaObject::Call _c, 
                                 int _id,     void **_a)
{
    if (_c == QMetaObject::InvokeMetaMethod) {
        Q_ASSERT(staticMetaObject.cast(_o));
        Derived *_t = static_cast<Derived *>(_o);
        switch (_id) {
        case 0: _t->f(); break;
        default: ;
        }
    }
    Q_UNUSED(_a);
} 
```

因此，它以正常的函数调用结束`_t->f()`。

请注意，无法`Base::f`通过信号调用。`Base`仅当当前对象实际上是实例而不是实例时，才能执行此函数`Derived`。而且由于`Base`不是基于 QObject 的，因此您不能将其实例传递给`connect`函数。

# javascript - 使用复选框将表单提交到同一页面而不重新加载页面

> ID：11023785
> 
> 赞同：0
> 
> 时间：2012-06-13T21:46:25.977
> 
> 标签：javascript, ajax, onclick, refresh, submit

我想在不刷新页面的情况下使用复选框上的 onClick 事件提交表单。这是一个例子。

```
<form action="index.php" method="POST">
    <input type="checkbox" onClick="this.form.Submit();">
</form> 
```

它发送我需要的数据，但它不断重新加载页面，我该如何防止这种情况？

在此先感谢，霍姆萨斯。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-13T21:48:10.720

传统的 POST 总是会导致刷新（因为您的浏览器必须显示响应）。如果您想避免这种情况，您需要使用异步技术，例如[AJAX](http://en.wikipedia.org/wiki/Ajax_%28programming%29)，它是 Javascript 和 XML 的融合。

存在许多库来简化 AJAX 的使用，[jQuery](http://api.jquery.com/jQuery.ajax/)只是其中之一。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-13T21:48:24.230

当您使用 POST 提交页面时，需要刷新。要防止刷新，请考虑使用 ajax 调用。

# ruby - 用于在 ruby 中匹配行间内容的正则表达式

> ID：11023786
> 
> 赞同：3
> 
> 时间：2012-06-13T21:46:27.323
> 
> 标签：ruby, regex, email

我正在尝试找出 Ruby 1.8.7 上的正则表达式，用于从电子邮件中删除线程。为此，我需要删除与线程模式匹配的邮件边界之间的所有内容，例如，在 Mac Mail 上，我需要删除粗体文本（示例 HTML 已简化以避免使用大量空间，**真实邮件的 HTML远没有那么简洁**）：

```
发件人：XXXX
...邮件标题...
内容类型：多部分/替代；
  边界="苹果邮件=_EFA7D6C2-C778-4C8E-AA13-C97DF1FA9036"
...更多邮件标题...

--Apple-Mail=_EFA7D6C2-C778-4C8E-AA13-C97DF1FA9036
内容传输编码：quoted-printable
内容类型：文本/纯文本；
  charset=us-ascii

从 Mac Mail 添加的新评论

2012 年 6 月 12 日 12:51，XXXX@example.com 写道：

> 线程
> 正文
> 成为
> 删除
>=20

--Apple-Mail=_EFA7D6C2-C778-4C8E-AA13-C97DF1FA9036
内容传输编码：quoted-printable
内容类型：文本/html；
  charset=us-ascii

<html>...很多HTML...

<span>2012 年 6 月 12 日 12:51，XXXX@example.com 写道：</span>

<span> 线程</span>
<span> 文本 </span>
<span> 是 </span>
<span> 已移除 </span>
<span>=20 </span>
</html>=

--Apple-Mail=_EFA7D6C2-C778-4C8E-AA13-C97DF1FA9036--

```

我认为可以捕获所需文本的正则表达式是：

```
--Apple-Mail=_EFA7D6C2-C778-4C8E-AA13-C97DF1FA9036.+?(\bOn.+?)(?!--Apple-Mail=_EFA7D6C2-C778-4C8E-AA13-C97DF1FA9036) 
```

但这在第一个*"On"*之前从边界捕获是行不通的。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-25T18:49:18.463

好的，所以解决方案非常简单，我最终得到了如下表达式：

```
--Apple-Mail=_EFA7D6C2-C778-4C8E-AA13-C97DF1FA9036.+?(On \\d{0,2}[\\/\\-]\\d{0,2}[\\/\\-]\\d{0,4}.+?)--Apple-Mail=_EFA7D6C2-C778-4C8E-AA13-C97DF1FA9036 
```

无需为此执行前瞻/后视。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-13T22:23:34.683

这是两个将匹配文本的正则表达式。您可以`gsub`在每个表达式中找出适当的匹配组。

1.  `/(^On \d\d\/\d\d\/\d{4}.*$\n(\n>.*$)*\n\n)/`
2.  `/(<span>On \d\d\/\d\d\/\d{4}.*<\/span>\n\n(<span>.*<\/span>\n)*)/`

这应该是一个好的开始，但可以改进为更通用，但由于我们只知道一个示例，所以我刚刚写了这个来解决这个问题！

**参考**

*   [红色的](http://rubular.com/)

# php - php preg_match 在标志

> ID：11023790
> 
> 赞同：2
> 
> 时间：2012-06-13T21:47:10.097
> 
> 标签：php, regex, preg-match

您好，我想在下一行中匹配“@”，

```
create@create_time:"2012-05-30 21:14:35.0",update_time:"2012-05-31 22:05:46.0"

preg_replace("@", "", $content)

preg_replace("\@", "", $content) 
```

他们都没有工作。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2015-09-01T19:24:55.477

对于后代：如果有人偶然发现这一点，因为他们对作为其他人代码一部分的正则表达式中的 at 符号的使用感到困惑，`@`偶尔将其用作开始和结束[regex-delimiter](http://php.net/manual/en/regexp.reference.delimiters.php)。下面的引用还与为什么 OP 尝试匹配文字 '@' 失败（强调我的）有关：

> 使用 PCRE 函数时，***需要***用分隔符将模式括起来。定界符可以是任何非字母数字、非反斜杠、非空白字符。

换句话说，任何正则表达式字符串*必须*以由字符类标识的匹配字符开始和结束，`[^A-Za-z\s\\]`或者——如果你觉得你可以处理它们的使用可能会给你带来的任何头痛——一对匹配的分组字符`<>` `{}` `[]` `()`。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-13T21:48:33.420

如果您阅读错误消息，您会发现您的正则表达式缺少分隔符。

一个正确的应该是`~@~`

但是，在这种情况下你不需要`preg_replace`，你应该去

```
str_replace("@", "", $content) 
```

# fortran - fortran 2003 的完整面向对象示例？

> ID：11023792
> 
> 赞同：3
> 
> 时间：2012-06-13T21:47:17.053
> 
> 标签：fortran, fortran2003

谁能给我一个示例，说明与此 C++ 代码等效的简单 Fortran 2003 面向对象布局应该如何：

```
stefanos-imac:tmp borini$ more Animal.h 
class Animal {
    public:
        Animal(int age);
        ~Animal();
        virtual void speak();
        int getAge();
    private:
        int age;
};

stefanos-imac:tmp borini$ more Animal.cpp 
#include <Animal.h>
#include <iostream>
Animal::Animal(int age) {
    std::cout << "init animal" << age << std::endl;
    this->age = age;
}
Animal::~Animal() {
    std::cout << "dtor animal" << std::endl;
}
void Animal::speak() {
    std::cout << "speak not reimplemented" << std::endl;
}
int Animal::getAge() {
    return this->age;
}
stefanos-imac:tmp borini$ more Cat.h 
#include <Animal.h>
class Cat : public Animal {
    public:
        Cat(int age);
        ~Cat();
        virtual void speak();
};
stefanos-imac:tmp borini$ more Cat.cpp 
#include <Cat.h>
#include <iostream>
Cat::Cat(int age) : Animal(age) {
    std::cout << "init cat" << std::endl;
}
Cat::~Cat() { 
    std::cout << "dtor cat" << std::endl;
}
void Cat::speak() {
    std::cout << "meow" << std::endl;
}
stefanos-imac:tmp borini$ more main.cpp 
#include <iostream>
#include <Cat.h>

int main() {
    Cat c(10);

    std::cout << c.getAge() <<std::endl;
    c.speak();
} 
```

我的代码有问题，请参阅以下内容

```
stefanos-imac:oop borini$ more Animal.f90 
module AnimalModule
   implicit none
   private
   public :: AnimalType

   type :: AnimalType
      private
      integer :: age
   contains
      procedure :: getAge 
      procedure :: speak
      final :: dtor
   end type

   interface AnimalType
      module procedure ctor
   end interface
contains 
   subroutine ctor(self, age)
      type(AnimalType), intent(inout) :: self
      integer :: age
      print *, "Constructor Animal"
      self%age = age
   end subroutine 
   subroutine dtor(self)
      type(AnimalType), intent(inout) :: self
      print *, "Destroying animal"
   end subroutine 

   function getAge(self)
      class(AnimalType), intent(inout) :: self
      integer :: getAge
      getAge = self%age
   end function
   subroutine speak(self)
      class(AnimalType), intent(in) :: self

      print *, "Animal::speak not overridden"
   end subroutine
end

stefanos-imac:oop borini$ more Cat.f90 
module CatModule
   use AnimalModule
   implicit none
   private

   type, extends(AnimalType) :: CatType
      private
   contains
      procedure :: speak 
      final :: dtor
   end type

   interface CatType
      module procedure ctor
   end interface

contains 
   subroutine ctor(self, age)
      type(CatType), intent(inout) :: self
      integer, intent(in) :: age
      print *, "Constructor Cat"
      self%AnimalType = AnimalType(age)
   end subroutine 
   subroutine dtor(self)
      type(CatType), intent(inout) :: self
      print *, "Destroying Cat"
   end subroutine 
   subroutine speak(self)
      class(CatType), intent(in) :: self

      print *, "Meow"
   end subroutine
end

stefanos-imac:oop borini$ ifort Animal.f90 Cat.f90 
Cat.f90(10): error #8341: Final subroutines are not inherited through type extension and cannot be overridden.   [DTOR]
      final :: dtor
---------------^
Cat.f90(22): error #6292: The parent type of this field is use associated with the PRIVATE fields attribute   [AGE]
      self%AnimalType = AnimalType(age)
-----------------------------------^
compilation aborted for Cat.f90 (code 1)
stefanos-imac:oop borini$ 
```

特别是，我不清楚如何初始化基类，以及如何为派生类定义析构函数。

谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-14T09:28:29.300

```
 subroutine ctor(self, age)
      type(CatType), intent(inout) :: self
      integer, intent(in) :: age
      print *, "Constructor Cat"
      self%AnimalType = AnimalType(age)
   end subroutine 
```

这是错误的。~~CatType 没有 AnimalType 组件。它扩展了 AnimalType 类型。~~ctor 是一个子例程，您可以将其用作函数。我建议你，将构造函数（但它更多地只是初始化，而不是分配）定义为一个函数，但也可以使用子程序。您可以像使用接口块一样使用接口块来实现与类名相同的名称，但`CALL`如果您将其定义为子例程，则必须保持一致并使用。

在派生类的构造函数中，您可以设置正确的组件，或者使用基类的构造函数。然后不要忘记为您的类型编写正确的工作用户定义分配。

# apache-flex - Flex 应用程序在 ie/chrome 中加载，但在 Firefox 中不加载（托管在 Azure 上）

> ID：11023795
> 
> 赞同：0
> 
> 时间：2012-06-13T21:47:30.580
> 
> 标签：apache-flex, azure, flash, loading

我看到的是浏览器加载 html 并显示一个空白页。如果我将 swfobject 背景颜色更改为黑色，我会看到黑色方块。对于较大的 swf，我看到一个进度条前进到 100%，然后停止。

我把它归结为一个简单的 hello world 应用程序，但对我来说仍然失败。只有当 SWF 文件由 Azure 上的托管 Web 服务器实例提供服务时，它似乎才会失败。奇怪的是，当从文件系统将 html 直接加载到浏览器中时，它可以工作——只是在 Azure 上托管时不行。运行模拟器时也会失败。我刚刚尝试将文件放入 blob 存储中，并且在所有浏览器中都能完美运行。我没有在另一台主机上尝试过该文件。

这是 html - 非常简单和通用。全部从 Flash Builder 生成。忽略它被称为 ClientPreloader.swf 的事实——我现在已经删除了所有功能，所以它只是舞台上的一个标签。

至于 Azure，它托管在 SP2 上，我没有对正在运行的 IE 进行任何更改。

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
    <!-- saved from url=(0014)about:internet -->
    <html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"> 
        <!-- 
        Smart developers always View Source. 

        This application was built using Adobe Flex, an open source framework
        for building rich Internet applications that get delivered via the
        Flash Player or to desktops via Adobe AIR. 

        Learn more about Flex at http://flex.org 
        // -->
        <head>
            <title></title>
            <meta name="google" value="notranslate" />         
            <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
            <!-- Include CSS to eliminate any default margins/padding and set the height of the html element and 
                 the body element to 100%, because Firefox, or any Gecko based browser, interprets percentage as 
                 the percentage of the height of its parent container, which has to be set explicitly.  Fix for
                 Firefox 3.6 focus border issues.  Initially, don't display flashContent div so it won't show 
                 if JavaScript disabled.
            -->
            <style type="text/css" media="screen"> 
                html, body  { height:100%; }
                body { margin:0; padding:0; overflow:auto; text-align:center; 
                       background-color: #ffffff; }   
                object:focus { outline:none; }
                #flashContent { display:none; }
            </style>

            <!-- Enable Browser History by replacing useBrowserHistory tokens with two hyphens -->
            <!-- BEGIN Browser History required section -->
            <link rel="stylesheet" type="text/css" href="history/history.css" />
            <script type="text/javascript" src="history/history.js"></script>
            <!-- END Browser History required section -->  

            <script type="text/javascript" src="swfobject.js"></script>
            <script type="text/javascript">
                // For version detection, set to min. required Flash Player version, or 0 (or 0.0.0), for no version detection. 
                var swfVersionStr = "11.1.0";
                // To use express install, set to playerProductInstall.swf, otherwise the empty string. 
                var xiSwfUrlStr = "playerProductInstall.swf";
                var flashvars = {};
                var params = {};
                params.quality = "high";
                params.bgcolor = "#ffffff";
                params.allowscriptaccess = "sameDomain";
                params.allowfullscreen = "true";
                var attributes = {};
                attributes.id = "ClientPreloader";
                attributes.name = "ClientPreloader";
                attributes.align = "middle";
                swfobject.embedSWF(
                    "ClientPreloader.swf", "flashContent", 
                    "100%", "100%", 
                    swfVersionStr, xiSwfUrlStr, 
                    flashvars, params, attributes);
                // JavaScript enabled so display the flashContent div in case it is not replaced with a swf object.
                swfobject.createCSS("#flashContent", "display:block;text-align:left;");
            </script>
        </head>
        <body>
            <!-- SWFObject's dynamic embed method replaces this alternative HTML content with Flash content when enough 
                 JavaScript and Flash plug-in support is available. The div is initially hidden so that it doesn't show
                 when JavaScript is disabled.
            -->
            <div id="flashContent">
                <p>
                    To view this page ensure that Adobe Flash Player version 
                    11.1.0 or greater is installed. 
                </p>
                <script type="text/javascript"> 
                    var pageHost = ((document.location.protocol == "https:") ? "https://" : "http://"); 
                    document.write("<a href='http://www.adobe.com/go/getflashplayer'><img src='" 
                                    + pageHost + "www.adobe.com/images/shared/download_buttons/get_flash_player.gif' alt='Get 

Adobe Flash player' /></a>" ); 
                </script> 
            </div>

            <noscript>
                <object classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000" width="100%" height="100%" id="ClientPreloader">
                    <param name="movie" value="ClientPreloader.swf" />
                    <param name="quality" value="high" />
                    <param name="bgcolor" value="#ffffff" />
                    <param name="allowScriptAccess" value="sameDomain" />
                    <param name="allowFullScreen" value="true" />
                    <!--[if !IE]>-->
                    <object type="application/x-shockwave-flash" data="ClientPreloader.swf" width="100%" height="100%">
                        <param name="quality" value="high" />
                        <param name="bgcolor" value="#ffffff" />
                        <param name="allowScriptAccess" value="sameDomain" />
                        <param name="allowFullScreen" value="true" />
                    <!--<![endif]-->
                    <!--[if gte IE 6]>-->
                        <p> 
                            Either scripts and active content are not permitted to run or Adobe Flash Player version
                            11.1.0 or greater is not installed.
                        </p>
                    <!--<![endif]-->
                        <a href="http://www.adobe.com/go/getflashplayer">
                            <img src="http://www.adobe.com/images/shared/download_buttons/get_flash_player.gif" alt="Get Adobe 

Flash Player" />
                        </a>
                    <!--[if !IE]>-->
                    </object>
                    <!--<![endif]-->
                </object>
            </noscript>     
       </body>
    </html> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-16T23:40:53.470

这个问题的真正答案似乎是“不要那样做”。我很失望在这里没有看到任何回应。我对 Azure 的科学方法最终让我感到厌烦。我试图一次采用一项功能（托管 IE，然后是存储等）。让它工作的关键是做每一件事。你需要拥抱所有的 Azure。当然，托管的 IIS 中存在与 SWF 文件相关的明显缺陷。但是，如果您完全遵循建议 - 将大文件放入存储中，等等。这一切都很顺利（甚至更快）。

# c# - 表单认证，允许/被所有人看到

> ID：11023797
> 
> 赞同：0
> 
> 时间：2012-06-13T21:47:49.087
> 
> 标签：c#, asp.net, forms-authentication

我正在使用表单身份验证来保护我的应用程序。

我在 web.config 中有以下内容：

```
<authentication mode="Forms">
 <forms loginUrl="Login.aspx" name="ProjectName" defaultUrl="Users.aspx" slidingExpiration="true" timeout="2000" path="/" />
</authentication>

<location path="default.aspx">
 <system.web>
  <authorization>
   <allow users="*"/>
  </authorization>
 </system.web>
</location> 
```

这允许我访问 www.mysite.com/default.aspx，但我希望能够访问 www.mysite.com，但是当我尝试导航到该 URL 时，它会将我重定向到登录页面。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-13T21:52:04.700

```
<location path="/">
 <system.web>
  <authorization>
   <allow users="*"/>
  </authorization>
 </system.web>
</location> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-13T22:01:48.690

注意允许/拒绝元素：http: [//msdn.microsoft.com/en-us/library/8d82143t](http://msdn.microsoft.com/en-us/library/8d82143t)

```
<deny users="?" /> -- will deny access to all anonymous users, and redirect them to login page
<allow users="*" /> -- will allow access to all users, even anonymous, without redirect to login page. 
```

和<位置>：

```
<location path="/"> 
```

路径可能在哪里：

```
"/" - is for root dir(and inner)
"file_or_dir" - restricts only the specified file or directory 
```

# c++ - 如何使用独立于索引的函数初始化向量？

> ID：11023803
> 
> 赞同：1
> 
> 时间：2012-06-13T21:48:19.820
> 
> 标签：c++, lambda, stdvector

我想用一些整数定义一个向量，并用函数的结果填充它`get_a_value()`。可以通过这种方式通过循环来完成：

```
auto v = new std::vector<int>( 7 );
for ( int i = 0; i < 7; i++ )
    v->at(i) = get_a_value(); 
```

但是有一些冗余让我不舒服。这可以通过向量初始化中的一些 lambda 魔法来解决吗？

```
auto v = new std::vector<int>( 7, /* something involving get_a_value() here */ ); 
```

的值`get_a_value()`在每次调用中可能不同。是的，我确实需要一个指针。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-13T22:10:51.353

一般来说，你想要这个：

```
std::vector<T> v;
v.reserve(n); // reserve space only, no need to fill with default-constructed T's

std::generate_n(std::back_inserter(v), n, get_a_T_value); // fill with n values 
```

这是最简单和最有效的。我把它留给你，让它适应你的家庭作业。

# asp.net - 一些 WCF 调用返回站点主页

> ID：11023804
> 
> 赞同：1
> 
> 时间：2012-06-13T21:48:21.927
> 
> 标签：asp.net, wcf, iis-6

在 IIS6 服务器上，某些 WCF 服务返回主页而不是有用的结果。

在 IIS 中，通配符、axd 和 svc 都注册到了 aspnet_isapi.dll。

站点用户对所有内容拥有完全权限。

有趣的是，当通过本地 Cassini 安装查看该站点时，一切正常。

建议？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-14T14:14:39.323

2个可能的建议：

[http://blogs.msdn.com/b/wenlong/archive/2006/09/10/748294.aspx](http://blogs.msdn.com/b/wenlong/archive/2006/09/10/748294.aspx)可能会有所帮助。

此外，在 IIS 管理器下，打开 Web 服务扩展并确保 ASP.NET v2.0.5.0727 设置为允许。（或 ASP.NET v4....如果您正在使用的话）

事实上，[不在 IIS 6.0 下运行的 WCF](https://stackoverflow.com/questions/451701/wcf-not-running-under-iis-6-0)有一些有用的提示。

# java - web.xml 中的 url 模式存在问题

> ID：11023809
> 
> 赞同：3
> 
> 时间：2012-06-13T21:48:51.300
> 
> 标签：java, servlets, servlet-filters

我的过滤器映射`web.xml`如下：

```
 <filter>
    <filter-name>LoginCheckFilter</filter-name>
    <filter-class>com.tutorial.filter.LoginCheckFilter</filter-class>
  </filter>
  <filter-mapping>
    <filter-name>LoginCheckFilter</filter-name>
    <url-pattern>/admin*</url-pattern>
  </filter-mapping> 
```

当我运行我的应用程序并点击`http://localhost:8080/admin`我的过滤器时，我的过滤器没有被执行。我不明白为什么。

图案有没有问题。此外，如果我`'*'`从模式中删除，那么过滤器将在点击以上 url 时执行。

在这方面需要帮助。谢谢。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-06-13T22:00:44.610

规范（第 12.2 段）说明如下：

> 在 Web 应用程序部署描述符中，使用以下语法来定义映射：
> 
> *   以“/”字符开头并以“/*”后缀结尾的字符串用于路径映射。
>     
>     
> *   以“*”开头的字符串。前缀用作扩展映射。
>     
>     
> *   空字符串 ("") 是一种特殊的 URL 模式，它精确地映射到应用程序的上下文根，即表单的请求 `http://host:port/<contextroot>/`。在这种情况下，路径信息是“/”，servlet 路径和上下文路径是空字符串（“”）。
>     
>     
> *   仅包含“/”字符的字符串表示应用程序的“默认”servlet。在这种情况下，servlet 路径是请求 URI 减去上下文路径，并且路径信息为空。
>     
>     
> *   所有其他字符串仅用于完全匹配。

所以 the`*`是字面意思的，除非模式以结尾`/*`或开头`*.`

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-13T21:54:31.470

使用`/admin/*`而不是`/admin*`.

Servlet 容器将无法识别`/admin*`为正确的 URL 模式。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-13T21:55:10.597

也许尝试：

```
<url-pattern>/admin/*</url-pattern> 
```

# asp.net - 用户是否应该成为模式所有者才能读取、写入和执行 SP？

> ID：11023810
> 
> 赞同：0
> 
> 时间：2012-06-13T21:48:53.140
> 
> 标签：asp.net, sql-server-2008, privileges, database-security

我的 webapp 需要在具有五个模式的 SQL 2008 数据库上读取、写入（INSERT、UPDATE、DELETE）和执行存储过程。

我创建了一个通过 SQL 进行身份验证的用户，并通过 Security -> Logins -> (Username) Properties -> User Mappings 授予用户 db_datareader、db_datawriter 和 db_procedureexec。然后我将应用程序配置为使用用户名和正确的密码连接到数据库，但在尝试执行存储过程时，出现此错误：

```
The EXECUTE permission was denied on the object '(stored procedure name)', database '(new database)', schema '(schema 1)'. 
```

在数据库的安全部分找到这个用户，我将其设为数据库中五个模式的所有者。

我是否授予了太多特权？应用程序级用户是否应该成为模式所有者才能读取、写入和执行过程？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-13T21:53:44.823

不，应用程序用户不需要是模式所有者才能读取、写入和执行过程。

你可以这样说：

```
GRANT EXEC ON SCHEMA::whatever TO [user]; 
```

这将允许他们在 [whatever] 模式中执行过程。为了不需要传递特权（例如，假设您的程序执行动态 SQL），您可以考虑将它们设置为`EXECUTE AS OWNER`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-13T21:59:51.250

您不想授予应用程序用户对数据库的所有权。这基本上给了他们购物车的空白。您应该做的是向用户授予`db_datareader`和`db_datawriter`角色，并在所有适用的存储过程和函数上授予执行。

# ruby-on-rails - Postgres sh：/usr/local/var/postgres/server.log：没有这样的文件或目录

> ID：11023814
> 
> 赞同：6
> 
> 时间：2012-06-13T21:49:05.357
> 
> 标签：ruby-on-rails, postgresql, homebrew, rails-postgresql

我最近不得不重新安装 homebrew 和 postgres，现在 postgres 不能与 rails 一起使用。

首先，当尝试运行 rails 时，我得到了这个：

```
/Users/lee/.rvm/gems/ruby-1.9.3-p125@achievex/gems/activerecord-3.2.6/lib/active_record/connection_adapters/postgresql_adapter.rb:1206:in `initialize': could not connect to server: Connection refused (PG::Error) 
```

所以我尝试启动 postgres，我得到了这个：

```
pg_ctl -D /usr/local/var/postgres -l /usr/local/var/postgres/server.log start
server starting
sh: /usr/local/var/postgres/server.log: No such file or directory 
```

看来 postgres 正在运行，因为：

```
 ps aux | grep postgreslee             1099   0.3  0.0  2425480    188 s000  R+    5:48PM   0:00.01 grep postgres 
```

我完全不知道为什么我不能让它运行。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-05T08:44:26.883

一、ps | grep 实际上是把你的 grep 从进程树中拉出来。Postgres 没有运行。当放置登录的目录不存在时，就会发生这种事情。所以可能你将它指向一个不存在的目录。

如果您还没有数据目录，则可能会发生这种情况。

建议：

1.  首先确保您的数据目录存在。搜索 pg_hba.conf 并查看它是否在您系统上的任何位置。如果是，那么它很有可能在您的数据目录中（如果在 etc 中，则查找 base/1/PG_VERSION 这将在您的数据目录中，从基础上一层）。
2.  如果它已经存在，请更改您的 postgresql.conf 以适当地设置日志记录设置并删除 -l 选项。
3.  如果不存在数据目录，请使用 initdb 命令创建一个。

# javascript - 在不使用 Javascript 的情况下切换 div

> ID：11023816
> 
> 赞同：19
> 
> 时间：2012-06-13T21:49:14.247
> 
> 标签：javascript, css

我想切换 a `<div>`，但我的要求是它必须在`javascript`关闭的情况下工作。我想选择一个声明“修改搜索”的超链接，并显示包含搜索条件的 div。

我发现了大量使用 的演示`jQuery`，但它们都需要`javascript`启用。任何帮助表示赞赏。

* * *

## 回答 #1

> 赞同：38
> 
> 时间：2012-06-13T21:56:47.973

[给你，船长！](http://jsfiddle.net/gSPqX/1/)（*编辑*——科学更新）

HTML：

```
<label for=cb>Click Here</label>
<input type='checkbox' style='display: none' id=cb>
<div>
    Hello. This is some stuff.
</div> 
```

CSS：

```
input:checked + div { display: none; } 
```

*编辑*- 附加说明：`display: none`将导致某些浏览器 (IE) 不注意该`<input>`复选框。除了使用`display`CSS 属性隐藏它，您还可以使用类似`position: absolute; left: -10000px;`.

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2016-06-27T09:58:09.077

下面是一个简单的示例，您将能够使用 css 创建切换，而无需任何 JAVASCRIPT 和 JQUERY。您还可以使用没有 JQUERY 的 css 添加动画。CSS3 太棒了！:)

```
.box{width:200px;
height:0;
background:red;
transition:all 0.4s linear;}
input:checked ~ .box{height:220px;}
```

```
<input id="toggle" type="checkbox" style="visibility:hidden">
<label for="toggle"> CLICK ME </label>
<div class="box"> </div>
```

* * *

## 回答 #3

> 赞同：12
> 
> 时间：2018-06-12T11:33:20.097

该[`<details>`元素](https://devdocs.io/html/element/details)在没有应用任何 CSS 或 JavaScript 的情况下执行您所要求的操作。

它当然不是 a `div`，所以它不能从字面上回答你的问题，但我读到你的要求是有一些你希望有条件地显示或隐藏的内容。

> 创建一个披露小`<details>`部件，其中信息仅在小部件切换到“打开”状态时可见。可以使用该`<summary>`元素提供摘要或标签。

不幸的是，[浏览器对的支持`<details>`](https://caniuse.com/#search=details)并不完美，IE 和 Edge 目前根本不支持。边缘状态为[正在考虑](https://developer.microsoft.com/en-us/microsoft-edge/platform/status/detailssummary)中。IE 的开发已停止，因此它永远不会获得支持。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2012-06-13T21:50:48.053

没有 javascript，您无法切换点击。结尾。

**更新：**

如果您可以使用`CSS 3`选择器，您将不得不更改您的 DOM 结构并使用`CSS 3`选择器而不使用涵盖旧浏览器的库，这可能比关闭 javascript 的用户更常见，您可以使用 @pointy 回答`:selected`.

所以我想说，**实际上**这仍然**是不可能**的......！

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2018-01-24T21:06:28.417

对于已接受答案的更精致版本，一种常见的做法是将隐藏的复选框 + 标签组合在一起，以便能够在屏幕上拥有一个可点击的标签，该标签映射到 JavaScript ( [`.checked`](https://developer.mozilla.org/en-US/docs/Mozilla/Tech/XUL/checkbox#p-checked)) 和 CSS都可用的隐藏支持值( [`:checked`](https://developer.mozilla.org/en-US/docs/Web/CSS/:checked))

```
<input type='checkbox' id='css-toggle-switch' checked='checked' class='css-toggle-switch'>
<label for='css-toggle-switch' class='btn'>Error Details</label>
<div class='css-toggle-content'>
   <pre><code>Unexpected StackOverflow</code></pre>
</div > 
```

*通过将复选框放在首位*，我们可以根据[`:checked`](https://developer.mozilla.org/en-US/docs/Web/CSS/:checked)选择器来驱动 CSS 决策。[我们可以使用相邻兄弟选择`+`](https://developer.mozilla.org/en-US/docs/Web/CSS/Adjacent_sibling_selectors)器或[通用兄弟选择器](https://developer.mozilla.org/en-US/docs/Web/CSS/General_sibling_selectors)来抓取后续元素[`~`](https://developer.mozilla.org/en-US/docs/Web/CSS/General_sibling_selectors)

```
 /* always hide the checkbox */
.css-toggle-switch { display: none; }

/* update label text to reflect state */
.css-toggle-switch         + label:before { content: "Hide "; }
.css-toggle-switch:checked + label:before { content: "Show "; }

 /* conditionally hide content when checked */
.css-toggle-switch:checked ~ .css-toggle-content  { display: none; }

/* make the label look clickable */
.css-toggle-switch + label {
   cursor: pointer;
  -webkit-touch-callout: none;
    -webkit-user-select: none;
       -moz-user-select: none;
        -ms-user-select: none;
            user-select: none;
} 
```

[![截屏演示](../Images/6123f1302f889b1377c9758ed6d0bed5.png)](https://i.stack.imgur.com/zw78a.gif)

### [jsFiddle](https://jsfiddle.net/KyleMit/cd5hpp2d/)和 StackSnippets中的工作演示

```
.css-toggle-switch { display: none; }
.css-toggle-switch         + label:before { content: "Hide "; }
.css-toggle-switch:checked + label:before { content: "Show "; }
.css-toggle-switch:checked ~ .css-toggle-content  { display: none; }

.css-toggle-switch + label {
   cursor: pointer;
  -webkit-touch-callout: none;
    -webkit-user-select: none;
       -moz-user-select: none;
        -ms-user-select: none;
            user-select: none;
}

/* just some styles to make the demo a little more pleasant */
.btn {
  padding: 5px 10px;
  background: white;
  border: 1px solid grey;
  border-radius: 3px;
  width: 130px;
  display: inline-block;
  text-align: center;
}
.btn:hover {
  background: #e6e6e6;
  -webkit-box-shadow: inset 0 -1px 0 #dddddd;
     -moz-box-shadow: inset 0 -1px 0 #dddddd;
          box-shadow: inset 0 -1px 0 #dddddd;
}
.panel {
    padding: 15px;
    background: #ffe06d;
    border: 1px solid #d69e01;
    border-radius: 3px;
}
pre {
  padding: 5px;
  margin-bottom: 0;
  background: #eaeaea;
  border: 1px solid grey;

}
```

```
<div class="panel">
  <input type='checkbox' id='css-toggle-switch' 
          checked='checked' class='css-toggle-switch'>
  <label for='css-toggle-switch' class='btn'>
    Error Details
  </label>
  <div class='css-toggle-content'>
     <pre><code>Unexpected StackOverflow</code></pre>
  </div >
</div>
```

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2015-03-14T19:13:10.867

聚会晚了大约三年，但是当我想做同样的事情时，我发现了这个，用于移动菜单，随后找到了一个非常好的解决方案，所以我想我会把它发布给其他人.

基本思想来自这篇文章：[http](http://www.creativebloq.com/css3/build-smart-mobile-navigation-without-hacks-6122800) ://www.creativebloq.com/css3/build-smart-mobile-navigation-without-hacks-6122800 。我想我使用了一种稍微简单的方法（在设置它时偶然发现）。这通过单击菜单按钮隐藏/显示导航。

在 CSS 中，nav 设置为“隐藏”，nav:target 设置为显示。页面有两个菜单按钮，使用同一张图片，都有类menubutton，绝对位置在同一个地方。menbuttonON 的索引为 1000，位于 html 中的导航外部 menubuttonOFF 的索引为 1001，但位于导航内部，因此起初它是不可见的

在 HTML 中，单击 menubuttonON 链接到 nav，然后它是目标，因此它会显示。在那个导航里面是 menubuttonOFF，它的 z-index 比 menubutton ON 高，所以现在它在最上面。单击 menubuttonOFF 链接回 menubuttonON，因此 nav 不是目标，并且会消失，同时使用 menubuttonOFF。

简化的 CSS（没有特定于站点的格式）：

```
nav {display: none;}
nav:target {display: block !important;}
.menubutton { position: absolute;
text-align: right;
top: 0;
margin-top: 14%;} /* This margin puts it below the header logo */
.menubuttonON {z-index: 1000;}
.menubuttonOFF {z-index: 1001;} 
```

HTML

```
<header> <!-- logo here --> </header>
<div class="menubutton menubuttonON" name="buttonON"><a href="#nav"><img src="../Images/menubutton.png">MENU</a></div>

<nav id="nav" name="nav">

<div class="menubutton menubuttonOFF"><a
href="#buttonON"><img src="../Images/menubutton.png">CLOSE</a></div>
<ul> <!-- all the navigation stuff --> </ul>
</nav> 
```

你可以在这里看到它的工作原理：[http](http://www.thewritersgreenhouse.co.uk/storyelements_resources/storyelements.htm) ://www.thewritersgreenhouse.co.uk/storyelements_resources/storyelements.htm 。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2012-06-13T21:50:14.773

如果没有 JavaScript，您所问的问题是不可能的。*（或者，[正如@Pointy 指出的那样](https://stackoverflow.com/a/11023915/362536)，CSS3 选择器。）*

您将不得不修改您的要求，或者更好的是，默认情况下只显示表单并为 JavaScript 用户隐藏（如果需要）。您的页面可以为所有人工作，并且为那些无法使用它们的人禁用不重要的功能。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2012-06-13T21:51:42.423

没有Javascript，没有切换。有一些伪CSS3的方法，但如果你必须支持JS关闭，你肯定不支持CSS3。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2012-06-13T21:52:34.543

正如其他人所说，您必须使用JS来实现div的切换。如果您希望您的网站在禁用 javascript 的情况下工作，您需要将您的网站设计为在 javascript 不可用时优雅地失败。换句话说，您的网站不应依赖 JavaScript 来运行。例如：AJAX 表单应该回退到 HTTP 提交等。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2012-06-13T21:54:40.993

如果不使用 Javascript 或发送另一个请求，您将无法做到这一点。

如果您可以接受额外的请求（即添加页面加载是可以的），那么最直接的解决方案是将链接指向当前 URL，但添加查询字符串参数，例如`http://example.com/current-page?showsearch=1`. 然后，在服务器上，检查是否`showsearch`设置了参数，如果设置了，则将搜索 div 初始化为可见。

当然，您必须注意页面状态的其余部分在请求中仍然存在；您可能必须使用表单才能携带用户可能输入的任何数据，这很可能意味着您的链接不能是链接，但必须是按钮（因为链接无法触发没有 Javascript 的表单提交）。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2012-06-13T21:54:49.347

在禁用 JS 的情况下使其工作的方法是让超链接有一些 href 来完成您想要的任务 - 例如：

/the/original/url?advanced-search=true

当 ?advanced-search=true 存在时，Web 服务器提供不同的内容。如果启用了 JS，您研究的 jquery 代码应该只是取消原始操作。

# mysql - 在不同服务器上同步 MySQL 的最佳方法

> ID：11023820
> 
> 赞同：2
> 
> 时间：2012-06-13T21:49:57.900
> 
> 标签：mysql, synchronization, replication, database-replication

我有两台服务器。一个位于我们的办公室，它的 MySQL 库包含我们的报价、我们的客户等。

第二台服务器位于我们的托管服务提供商的数据中心。它使用相同的数据库结构和相同的报价，我将其用于我们的网站。

我通过每隔几个小时将json从一台服务器发送到另一台服务器手动同步这两个服务器，但现在我需要实时同步。

我应该使用哪种方式？

1.  从公司服务器到网站服务器的主从复制。问题是，我们的从站数据库也有自己的可变表。例如，订单、用户会话、观看次数等。我需要以某种方式将该表发送到办公室的主服务器。

2.  为两台服务器仅使用一个数据库。问题是，每个网页浏览最多可能有 100 个查询，我认为通过互联网运行每个查询可能会很慢。

我们不能只为所有任务使用一台服务器，因为我们无法在我们的办公室提供稳定的低延迟互联网连接。因此，当互联网出现故障时，我们的网站或我们的 CRM 系统就会出现故障。

可能有第三种也是最好的方法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-14T05:48:06.803

您可以在[dbForge Studio for MySQL](http://www.devart.com/dbforge/mysql/studio/)中尝试[数据比较工具](http://www.devart.com/dbforge/mysql/studio/database-synchronization.html)。它将连接到两个不同的 MySQL 服务器（使用简单连接、SSL、SSH 或 HTTP 隧道），比较它们并显示差异；然后它将提供运行同步脚本或查看/保存它。

还有独立的[dbForge 数据比较](http://www.devart.com/dbforge/mysql/datacompare/)工具。

# c++ - 为什么 boost::bind 绑定构造函数<>仿函数时不能推导出返回类型？

> ID：11023825
> 
> 赞同：1
> 
> 时间：2012-06-13T21:50:24.960
> 
> 标签：c++, boost, constructor, lambda, bind

...尽管库提供的`constructor<>`仿函数适配器定义了`sig<>`模板？

```
struct Porc
{
    Porc(int x) {}
};

boost::bind
(
    boost::lambda::constructor<Porc>(),
    _1
)(1); 
```

错误：“struct boost::lambda::constructor”中没有名为“result_type”的类型</p>

我要做的是创建一个仿函数，它接受一个 int 并使用该 int 创建并返回一个 Porc 对象。注意：如果我明确指定函子的返回类型（即 Porc），如下所示，它可以工作：

```
boost::bind<Porc>
(
    boost::lambda::constructor<Porc>(),
    _1
)(1); 
```

我对 lambda 表达式比较陌生，但我认为/希望我掌握了基础知识。它[在文档](http://www.boost.org/doc/libs/1_48_0/doc/html/lambda/le_in_details.html#lambda.bind_expressions)中说**通常，BLL 无法推断出任意函数对象的返回类型。但是，有两种方法可以为某个函数对象类赋予 BLL 这种能力。[...] result_type typedef 和 [...] sig 模板**。由于`constructor<>`提供的是库，因此他们当然声明了一个`sig<>`模板。

# c# - 在每个月和每天的日期范围内循环

> ID：11023834
> 
> 赞同：1
> 
> 时间：2012-06-13T21:51:13.137
> 
> 标签：c#, .net, sharepoint

我有两个文本框，用于选择 From 和 To 日期。我需要有一个循环，其中外循环将持续一年，而内循环将每个月运行。

问题出在下面的代码上，如果我选择 11/01/2011 和 06/30/2012，我的月循环在第 11 个月运行一次。之后循环退出.. 任何帮助表示赞赏。

我正在使用下面的代码查看 SharePoint 日历列表（使用 CAML 查询）并连续 3、5 天获取某个房间可用的次数，不包括周末。想法是使用 CAML 查询来获取每个月的空闲天数，并一直重复到最后一个选定的月份。

```
int year = 0, month = 0; 
for (year = Calendar1.SelectedDate.Year; year <= Calendar2.SelectedDate.Year; year++)
{
  int i = year;
  for (month = Calendar1.SelectedDate.Month; month <= Calendar2.SelectedDate.Month; month++)
  {
    int j = month;
  }
} 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-13T21:59:41.267

像这样的东西会起作用吗？

```
for (DateTime date = Calendar1.SelectedDate; date < Calendar2.SelectedDate; date = date.AddMonths(1))
{
 //code
} 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-06-13T22:07:05.490

如果我对您的理解正确，您想在两个日期之间每个月进行迭代。如果是这样，这应该工作：

```
var dt2 = Calendar2.SelectedDate.Year;
var current = Calendar1.SelectedDate;
while (current < dt2)
{
  current = current.AddMonths(1);
  //do your work for each month here
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-13T21:56:27.263

您的内部循环的开始和结束编号应该是有条件的。

如果您在开始年，那么开始月份应该是选定的月份；否则它应该是1。

如果您在年末，那么末月应该是选定的月份；否则应该是12。

例子：

```
var startYear = Calendar1.SelectedDate.Year;
var endYear = Calender2.SelectedDate.Year;
var startMonth = Calender1.SelectedDate.Month;
var endMonth = Calender2.SelectedDate.Month;

for (var year = startYear; year <= endYear; year++)
{
    var sm = year == startYear ? startMonth : 1;
    var em = year == endYear ? endMonth : 12;

    for (var month = sm; month <= em; month++)
    {

    }    
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-13T21:58:58.083

对于开始年，您需要从适当的月份开始您的内部循环，并运行所有 12 个月，除了结束年，您应该运行到适当的月份。像这样的东西应该工作：

```
int year = 0, month = 0;    
for (year = Calendar1.SelectedDate.Year; year <= Calendar2.SelectedDate.Year; year++)
{
    int i = year;

    for (month = (i==Calendar1.SelectedDate.Year ? Calendar1.SelectedDate.Month : 1); month <= (i==Calendar2.SelectedDate.Year ? Calendar2.SelectedDate.Month : 12); month++)
    {
        int j = month;
    }
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-09-26T09:41:45.660

```
//Function return First day in Month For Date --example : 01-09-2012

public static  DateTime FirstDayOfMonthFromDateTime(DateTime dateTime)
     {
         return new DateTime(dateTime.Year, dateTime.Month, 1);

     }

//code used to loop throw a Date range for each month
DateTime FirstDayInMonth = FirstDayOfMonthFromDateTime(Date);
DateTime TempDay = FirstDayInMonth;
int days = DateTime.DaysInMonth(FirstDayInMonth.Year, FirstDayInMonth.Month);

for (int i = 0; i < days; i++)
   {
     System.Out.Println(TempDay.toString());
     TempDay.AddDays(1);
   }

//then used code for each month in year (simple loop from 1-12).. 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2021-09-23T16:21:04.310

```
 private static void Main(string[] args)
        {
            Console.WriteLine(DateTime.DaysInMonth(2020, 1));

            var start = new DateTime(1900, 1, 1);
            var end = new DateTime(2000, 12, 31);

            end = new DateTime(end.Year, end.Month, DateTime.DaysInMonth(end.Year, end.Month));
            var diff = Enumerable.Range(0, Int32.MaxValue)
                                 .Select(e => start.AddMonths(e))
                                 .TakeWhile(e => e <= end)
                                 .Select(e => e);
            foreach (var item in diff)
            {
                Console.WriteLine("Start Date - " + item.ToString("dd-MM-yyyy"));
                Console.WriteLine("End Date - " + item.AddDays(DateTime.DaysInMonth(item.Year, item.Month) - 1).ToString("dd-MM-yyyy"));
            }
        } 
```

# c++ - 将矩形绘制到屏幕上的最有效方法

> ID：11023839
> 
> 赞同：0
> 
> 时间：2012-06-13T21:51:25.900
> 
> 标签：c++, windows, drawing

基本上我想要一个无**边框的黑色**窗口，我可以设置它的位置和大小。/

然后我想在给定四个点的情况下绘制一个填充的白色多边形。

我说高效，因为我目前正在使用 OpenCV 进行绘制，我认为这是效率低下的。我希望能够更改点并用至少 30fps 的新点重新绘制。

我的目标平台是带有 C++ 的 Windows。

有谁知道实现这一目标的最快方法，也许是一个小图书馆？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-13T21:57:13.170

我建议您通过图书馆使用`openGl`例如。`GLUT`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-14T09:45:18.770

最简单的方法是使用 DirectX。您可以使用 Windows API 创建、调整窗口大小和重新定位窗口，并使用 DirectX 将其渲染到其中。DX 有一个比 OpenGL 更容易访问的 API，因为 OGL 充满了隐式全局变量和弱类型，并且像 GLUT 这样的支持库也是可怕的 C 黑客，而 DX 很容易用几个自定义删除器来创建 RAII，并且是面向对象的。

如果在 Vista 或更高版本上，您还可以使用 Direct2D，它更适合简单的 2D 渲染。

# c# - 如何使用列表 引用字典值？

> ID：11023842
> 
> 赞同：0
> 
> 时间：2012-06-13T21:51:39.553
> 
> 标签：c#

我想`List<MyObject> myList`参考 Dictionary myDic 值...我试过了

```
myList = myDic.Values.ToList() 
```

但这似乎只复制字典值。我需要列表来引用字典，因此对 myDic 所做的任何修改（添加、删除、更新）都将反映在 myList 中。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-13T21:53:46.773

这是不可能的。 `myDic.Values`将`IEnumerable<MyObject>`枚举字典中的值。通过调用`.ToList()`它，您*明确*要求制作副本。如果你省略了这个调用，那么你将有一个可以使用的可枚举，但当然你将无法索引它或直接更改它。

考虑直接使用`IEnumerable<MyObject>`检索自`myDic.Values`- 是什么让您认为您需要一个`List<MyObject>`?

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-13T22:01:29.940

当然，您可以使用 ObservableDictionary 而不是您的列表实现具有两全其美的好处：[可以在这里找到](http://blogs.microsoft.co.il/blogs/shimmy/archive/2010/12/26/observabledictionary-lt-tkey-tvalue-gt-c.aspx)

如果您需要一个列表和一个字典，并且需要同步它们，而没有每次字典更改时都有一个新副本的缺点，那么您为什么不为此编写一个类呢？

这是一个简短的示例，它可能不适合线程问题：

```
public class DictRefList
{
    private Dictionary<int, SomeRefClass> dict;
    private List<SomeRefClass> list; // your list implementation here

    public void DictRefList()
    {
        dict = new Dictionary<int, SomeRefClass>();
        list = new List<SomeRefClass>;
    }

    public void Add(int key, SomeRefClass val)
    { 
        dict.Add(key, val);
        list.Add(val);
    }

    public void Delete(int key, SomeRefClass val)
    {
        dict.Remove(key);
        list.Remove(val);
    }

    public void Update(int key, SomeRefClass val)
    {
        dict[key] = val;
        list.Add(val); // do what is necessary to keep it valid and have no duplicate value
    }
} 
```

# backbone.js - 使用 d3.js 和 svgs 在 Backbone.js 中渲染

> ID：11023852
> 
> 赞同：15
> 
> 时间：2012-06-13T21:52:26.073
> 
> 标签：backbone.js, d3.js

在backbone.js 中，视图的渲染函数会生成未附加的html，以后可以附加到dom。

目前，我必须在 HTML 中有一个现有目标才能将 svg 附加到。然后我使用数据/输入模式将元素插入到 svg 中。有没有办法让 d3.js 在不将其附加到 dom 的情况下生成 svg？

```
var svg = d3.select("#target").append('svg')
    .attr("viewBox","0 0 100 100"); 

svg.selectAll("circle")
    .data(data)
    .enter().append("circle")
        .attr("r", 10)
        .style("fill", "black"); 
```

或者，是否可以为 d3 提供一个未附加的 dom 元素来附加内容？像这样的东西？D3.js 文档建议 select 可以接受节点，但以下对我也不起作用

```
var svg = d3.select(this.$el).append('svg')  // Uncaught TypeError: Object [object Object] has no method 'appendChild' 
    .attr("viewBox","0 0 100 100");     

svg.selectAll("circle")
    .data([1,2,3])
    .enter().append("circle")
        .attr("r", 10)
        .style("fill", "black"); 
```

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-06-13T23:09:47.863

我在这篇文章中找到了答案[SVG没有正确渲染为主干视图](https://stackoverflow.com/q/9651167/783478)

```
d3.select(this.el) 
```

成功了！

# python - Python中小集合的性能

> ID：11023854
> 
> 赞同：2
> 
> 时间：2012-06-13T21:52:27.360
> 
> 标签：python, list, set, bitarray

我正在寻找最有效的方法来表示 Python 中给定范围（比如 0-10）内的一小组整数。在这种情况下，效率意味着快速构建（来自未排序的列表）、快速查询（每个集合上的几个查询）和合理快速构建排序版本（可能每十个集合一次左右）。先验的候选人正在使用 Python 的内置集合类型（快速查询），使用排序数组（可能更快地构造？），或使用位数组（如果我在 C 中，一切都快......但我怀疑 Python 会高效（？））。关于选择哪一个有什么建议吗？

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-13T22:02:32.077

我会使用位图并将“集合”的成员存储在`int`... 在这种情况下实际上可能比内置`set`类型更快 - 尽管我没有测试过。它肯定需要更少的存储空间。

**更新**

我现在没有时间进行类似完整的实现并将其与 Python 的内置类进行基准测试，但我认为这是一个说明我的建议的工作示例。正如我认为你会同意的那样，代码看起来相当快并且内存效率很高。

鉴于 Python 几乎透明的“无限”长整数功能，所编写的内容将自动处理比您需要的范围大得多的整数值，尽管这样做可能会减慢速度。;)

```
class BitSet(object):
    def __init__(self, *bitlist):
        self._bitmap = 0
        for bitnum in bitlist:
            self._bitmap |= (1 << bitnum)

    def add(self, bitnum):
        self._bitmap |= (1 << bitnum)

    def remove(self, bitnum):
        if self._bitmap & (1 << bitnum):
            self._bitmap &= ~(1 << bitnum)
        else:
            raise KeyError

    def discard(self, bitnum):
       self._bitmap &= ~(1 << bitnum)

    def clear(self):
        self._bitmap = 0

    def __contains__(self, bitnum):
        return bool(self._bitmap & (1 << bitnum))

    def __int__(self):
        return self._bitmap

if __name__ == '__main__':

    bs = BitSet()

    print '28 in bs:', 28 in bs
    print 'bs.add(28)'
    bs.add(28)
    print '28 in bs:', 28 in bs

    print
    print '5 in bs:', 5 in bs
    print 'bs.add(5)'
    bs.add(5)
    print '5 in bs:', 5 in bs

    print
    print 'bs.remove(28)'
    bs.remove(28)
    print '28 in bs:', 28 in bs 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-13T22:12:04.540

在这种情况下，您可能只使用 True/False 值列表。使用的哈希表`set`将做同样的事情，但它将包括哈希、桶分配和冲突检测的开销。

```
myset = [False] * 11
for i in values:
    myset[i] = True
mysorted = [i for i in range(11) if myset[i]] 
```

与往常一样，您需要自己计时，以了解它在您的情况下是如何工作的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-13T21:57:26.010

我的建议是坚持使用内置的`set()`. 编写性能优于内置 C 代码的 Python 代码将非常困难。如果您依赖内置的 C 代码，构建速度和查找速度将是最快的。

对于排序列表，最好的办法是使用内置排序功能：

```
x = set(seq) # build set from some sequence
lst = sorted(x)  # get sorted list from set 
```

一般来说，在 Python 中，你编写的代码越少，速度就越快。您越能依赖 Python 的内置 C 基础，速度就越快。在许多情况下，解释型 Python 比 C 代码慢 20 到 100 倍，而且很难变得如此聪明，以至于您能够领先于预期，而不是仅使用内置功能。

如果保证您的集合始终是 [0, 10] 范围内的整数，并且您希望确保内存占用尽可能小，那么整数内的位标志将是可行的方法。

```
pow2 = [2**i for i in range(32)]

x = 0  # set with no values
def add_to_int_set(x, n):
    return x | pow2[n]

def in_int_set(x, n):
    return x & pow2[n]

def list_from_int_set(x):
    return [i for i in range(32) if x & pow2[i]] 
```

我敢打赌这实际上比使用内置`set()`函数要慢，但你知道每个集合只是一个`int`对象：4 个字节，加上 Python 对象的开销。

如果你真的需要数十亿个，你可以通过使用 NumPy`array`而不是 Python 列表来节省空间；NumPy`array`将只存储裸整数。事实上，NumPy 有一个 16 位整数类型，所以如果你的集合真的只在 [0, 10] 的范围内，你可以使用 NumPy 将存储大小缩小到每个字节`array`。

[http://www.scipy.org/FAQ#head-16a621f03792969969e44df8a9eb360918ce9613](http://www.scipy.org/FAQ#head-16a621f03792969969e44df8a9eb360918ce9613)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2020-09-03T13:11:02.443

即使对于小型集合，“包含”检查对集合的结果也相当快。

```
>>> Timer("3 in values", 'values = [range(10)]').timeit(number = 10**7)
0.5200109481811523
>>> Timer("3 in values", 'values = set(range(10))').timeit(number = 10**7)
0.2755239009857178 
```

另一方面，正如您所指出的，构建一个集合需要更长的时间。

```
>>> Timer("set(range(10))").timeit(number = 10**7)
5.87517786026001
>>> Timer("list(range(10))").timeit(number = 10**7)
4.129410028457642 
```

排序时也有一些区别：

```
>>> Timer("sorted(values)", 'values = set(range(10, 0, -1))').timeit(number = 10**7)
5.277467966079712
>>> Timer("sorted(values)", 'values = list(range(10, 0, -1))').timeit(number = 10**7)
4.3836448192596436
>>> Timer("values.sort()", 'values = list(range(10, 0, -1))').timeit(number = 10**7)
2.073429822921753 
```

就地排序要快得多，并且仅适用于列表。

因此，如果您只对每个集合进行少量查询，则列表的性能会更高。在进行大量查询时，我会使用集合。
无论哪种情况，小集合之间的差异都很小。

不建议在 Python 中构建自己的集合类型以获得更好的性能。

# javascript - 从使用 Trigger.io 构建的移动应用程序发送发布请求

> ID：11023861
> 
> 赞同：2
> 
> 时间：2012-06-13T21:52:54.700
> 
> 标签：javascript, zepto, trigger.io, http-post

基本上如上所述，我需要我的移动应用程序（使用 Trigger 构建）将 Post 请求发送到远程服务器。具体来说，应用程序生成 GPS 坐标和时间戳，并将数据发送到服务器（使用 Ruby on Rails 构建），服务器获取并存储数据。我正在使用 Zepto 库来发送它。我该如何实现这一目标？

```
<head> <script type="text/javascript" src="/js/lib/zepto.js"></script></head>

$.post(
    url: "http://www.example.com",
    data: {
    latitude: position.coords.latitude;
    longitude: position.coords.longitude;
    timestamp: new Date().getTime();},
    success: alert("Report Successful");
); 
```

这是实际发送请求的代码。我不相信问题出在其他地方。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-13T22:03:58.190

使用[forge.request.ajax](http://docs.trigger.io/en/v1.3/modules/request.html#request.ajax)。

此外，您的 JavaScript 代码还存在一些问题。此代码段应该可以用于发布帖子（假设在您的代码前面定义了“位置”）：

```
forge.request.ajax({
    type: "POST"
    url: "http://yourserver",
    data: {},
    success: function() { alert("Report Successful"); }
}); 
```

# c# - StreamWriter.Write 不写入文件；没有抛出异常

> ID：11023868
> 
> 赞同：23
> 
> 时间：2012-06-13T21:53:15.637
> 
> 标签：c#, asp.net-mvc, file-io, streamwriter.write

我在 C# (asp.net MVC) 中的代码

```
StreamWriter tw = new StreamWriter("C:\\mycode\\myapp\\logs\\log.txt");

// write a line of text to the file
tw.Write("test"); 
```

该文件已创建但为空。不会抛出异常。我以前从未见过这种情况，我被困在这里；我只需要写一些调试输出。

请指教。

* * *

## 回答 #1

> 赞同：67
> 
> 时间：2012-06-13T21:59:04.040

StreamWriter 默认情况下是缓冲的，这意味着它在收到 Flush() 或 Close() 调用之前不会输出。

如果需要，您可以通过设置[AutoFlush](http://msdn.microsoft.com/en-us/library/system.io.streamwriter.autoflush%28v=vs.71%29.aspx)属性来更改它。否则，只需执行以下操作：

```
StreamWriter tw = new StreamWriter("C:\\mycode\\myapp\\logs\\log.txt");

// write a line of text to the file
tw.Write("test");
tw.Close();  //or tw.Flush(); 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-06-13T22:05:02.513

既不冲洗也不关闭或处置。试试这个

```
using (StreamWriter tw = new StreamWriter(@"C:\mycode\myapp\logs\log.txt"))
{
    // write a line of text to the file
    tw.Write("test");
    tw.Flush();
} 
```

或我的偏好

```
using (FileStream fs = new FileStream( @"C:\mycode\myapp\logs\log.txt"
                                     , FileMode.OpenOrCreate
                                     , FileAccess.ReadWrite)           )
{
    StreamWriter tw = new StreamWriter(fs);
    tw.Write("test");
    tw.Flush();
} 
```

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2015-11-11T19:07:36.733

完成写入后，您需要关闭或刷新 StreamWriter。

```
tw.Close(); 
```

或者

```
tw.Flush(); 
```

但最佳实践是将输出代码包装在 using 语句中，因为 StreamWriter 实现了 IDisposable：

```
using (StreamWriter tw = new StreamWriter("C:\\mycode\\myapp\\logs\\log.txt")){
// write a line of text to the file
tw.Write("test");
} 
```

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2012-06-13T21:58:56.913

采用

```
System.IO.File.WriteAllText(@"path\te.txt", "text"); 
```

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2016-02-10T13:30:18.063

```
FileStream fs = new FileStream("d:\\demo.txt", FileMode.CreateNew,
                               FileAccess.Write);
StreamWriter sw = new StreamWriter(fs, System.Text.Encoding.ASCII);
int data;

sw.Write("HelloWorld");

sw.Close();
fs.Close(); 
```

*   问题是当 StreamWriter 对象是通过引用 FileStream 对象创建时，SW 对象将一直期待一些数据，直到 SW 对象关闭。
*   所以在使用**sw.Close();** 您打开的文件将被关闭并准备好显示输出。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2014-03-21T04:01:37.453

在 VB.net 中，这不是必需的，但对于 CSharp，您似乎需要一个 Writer.Flush 调用来强制写入。当然 Writer.Close() 也会强制刷新。

我们还可以设置 StreamWriter 实例的 AutoFlush 属性：

```
sw.AutoFlush = true;
// Gets or sets a value indicating whether the StreamWriter 
// will flush its buffer to the underlying stream after every  
// call to StreamWriter.Write. 
```

来自： http: [//msdn.microsoft.com/en-us/library/system.io.streamwriter.autoflush (v=vs.110).aspx](http://msdn.microsoft.com/en-us/library/system.io.streamwriter.autoflush(v=vs.110).aspx)

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-06-13T22:05:56.970

替代

```
FileStream mystream = new FileStream("C:\\mycode\\myapp\\logs\\log.txt",    
FileMode.OpenOrCreate, FileAccess.Write);           
StreamWriter tw = new StreamWriter(mystream); 
tw.WriteLine("test");
tw.close(); 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2012-06-13T22:06:52.013

尝试关闭文件或添加`\n`到该行，例如

```
tw.WriteLine("test");
tw.Close(); 
```

# objective-c - 错误：不能在@interface 或@protocol 中声明变量

> ID：11023879
> 
> 赞同：1
> 
> 时间：2012-06-13T21:53:53.297
> 
> 标签：objective-c, xcode, macos, xcode4, xcode4.2

我点击了现代化项目，然后我得到了一些编译错误。（我确实拍了快照）

错误是：无法在@interface 或@protocol 中声明变量

这是复制和粘贴格式的代码。

```
#import <Cocoa/Cocoa.h>
#import "AJHBezierUtils.h"

@interface NSBezierPath (WBBezierPath) 

NSBezierPath        *flattenPath;

NSPointArray        points;

int                 numPoints;

+(NSBezierPath*)roundedPath:(NSRect)aRect radius2:(int)rad2;

-(NSPoint ) getLinePoints:(NSPoint )p1 p2:(NSPoint)p2  withDistance:(int )pointDistance;

- (NSPoint *)pointsFromPathWithDistance:(int)distance numberOfPoints:(int *)numberOfPoints;

- (float)distanceBetweenPoint:(NSPoint)a andPoint:(NSPoint)b;

- (int)numberOfPoints; 
```

![这是XCode中的错误](../Images/cede830a35a7ea624fa133b1ffb4bcb1.png)

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-06-13T21:55:28.787

接口 ivars 需要大括号：

```
@interface NSBezierPath (WBBezierPath)
{
  NSBezierPath        *flattenPath;
  NSPointArray        points;
  int                 numPoints;
} 
```

但是，因为您要定义一个类别，所以不允许使用 ivars。您需要改用属性：

```
@interface NSBezierPath (WBBezierPath)

@property (nonatomic, strong) NSBezierPath *flattenPath;

/* Methods */

@end 
```

# c# - 是否可以语法突出显示内联 SQL？

> ID：11023881
> 
> 赞同：10
> 
> 时间：2012-06-13T21:53:55.447
> 
> 标签：c#, visual-studio-2010, tsql, syntax-highlighting

我经常写一些这样的SQL：

```
string sql = @"
   -- Multi-line SQL
"; 
```

在不讨论这种方法是好是坏的情况下，有人可以告诉我在 Visual Studio 中突出显示此 SQL 的最佳方法是什么？

我能想到的一种方法是创建单独的`.sql`文件，然后在此处将其作为字符串使用，以便在编辑原始 SQL 时，Visual Studio 识别出这是一个 SQL 文件并对其进行语法高亮显示。

这似乎是解决一个简单问题的乏味方法。有没有更简单的解决方案？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2016-09-03T14:19:47.277

JetBrains 刚刚发布了 ReSharper 2016.2，它支持内联语法高亮和智能感知，用于正则表达式和 html，代码注释如`/*language=html*/`.

我发现这是一个了不起的功能，（我相信）可以很容易地扩展它以支持 SQL 和几乎任何其他语言。

我在这里添加了一个功能请求：[https ://youtrack.jetbrains.com/issue/RSRP-460656](https://youtrack.jetbrains.com/issue/RSRP-460656)

这不能回答您的问题，但我希望他们会考虑添加这样的功能，因为内联 SQL 在代码中很常见（即使用 Dapper）。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-09-10T17:31:03.977

为此有一个 Visual Studio 扩展（适用于 VS 2010 和 2012）。它确实有您想象的问题，例如突出显示 SQ：不包含 SQL 的字符串中的关键字。根据您所做的工作类型，您可能仍然更喜欢在 SQL 中不使用高亮显示。

[http://visualstudiogallery.msdn.microsoft.com/a3a662c6-28eb-4de9-9a29-d328b1ac3f6b](http://visualstudiogallery.msdn.microsoft.com/a3a662c6-28eb-4de9-9a29-d328b1ac3f6b)

我可以推荐的一件事是将 Visual Studio 中的 SQL 关键字颜色更改为正常字符串颜色的变体。这样，突出显示在正确时很有帮助，但在突出显示实际上不包含 SQL 的字符串中的单词的情况下不会分散注意力。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-13T22:02:14.930

它不会像其他人告诉你的那样起作用。VS 如何知道哪些字符串是 sql，哪些不是。如果您不想使用 sql 文件，您可以创建自己的文件扩展名，如“.sqlx”或其他东西，然后在 VS 属性中为此扩展名分配 SQL 编辑器，以便 VS 知道对其应用正确的颜色编码。

然后你可以做这样的事情：

```
string sql = System.IO.File.ReadAllText("your path to sql file"); 
```

它甚至可能会更好，因为至少您可以将 SQL 代码分开。但是，我强烈建议您查看 Entity Framework 或 Linq-to-SQL

# asp.net-mvc - 使用 EF 为 google map api 提供数据

> ID：11023887
> 
> 赞同：0
> 
> 时间：2012-06-13T21:54:36.727
> 
> 标签：asp.net-mvc, google-maps

我目前有 google map api 在 MVC3 下的地图上显示我的当前位置。

我想在 EF 查询生成的地图上显示一系列点。

我正在使用谷歌地图 javascript 实现。

这可以实现吗，是否有任何好的灵魂可以提供代码示例以正确的方向发送给我。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-14T06:46:54.843

当然，您的 EF 查询将返回一组坐标。如果您不使用 Ajax 来获取坐标并创建页面，那么您可以创建一个 javascript 数组，如下所示：

```
<script type="text/javascript">

// coordinates
var locations = [];
@foreach (var item in Model) {
    locations.push(new google.maps.LatLng(@(Model.Latitude), @(Model.Longitude));
}

// Initialze your map and add the markers from the locations array
</script> 
```

在这种情况下，您需要通过模型将所有数据发送到您的视图。

另一种方法是使用 Ajax 获取您需要显示的坐标。在这里，您将拥有一个控制器，它将以 JSON 或 XML 的形式提供所有坐标。您将需要相应地处理它并显示标记。

如果您在 Google 地图上显示多个标记时需要帮助，请参阅[此示例](https://google-developers.appspot.com/maps/documentation/javascript/examples/marker-animations-iteration)！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-11T13:42:23.650

我使用控制器加载了一个结果集，并循环访问它们以在 javascript 中为它们中的每一个创建一个 html 弹出窗口。

然后我将它们添加到 google.maps.Marker 例程中......

# javascript - 大流量生产环境中的集群节点JS

> ID：11023889
> 
> 赞同：2
> 
> 时间：2012-06-13T21:54:42.247
> 
> 标签：javascript, node.js, cluster-computing, node-cluster

我有一个 Web 服务处理 http 请求以重定向到特定的 URL。对了，CPU 每天的点击量约为 500 万次，但我需要将其扩大到处理 2000 万次以上。这是一个生产环境，所以我对新的节点集群方法 b/c 有点担心，它仍然被列为实验性的。我需要关于如何集群节点以处理 linux 服务器上的流量的建议。有什么想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-14T14:36:44.110

每天500万相当于每秒57.87次，2500万次相当于每秒289.4次。对于您的情况，这些数字对于单个服务器来说并不算多。如果您只想重定向特定的 url，您可以使用更适合该工作的其他替代方案，例如[nginx 。](http://nginx.org/en/)但是，如果您仍想使用 NodeJS，我认为现代服务器可以处理该负载。以我的博客文章为例，了解如何使用集群：[NodeJS: Simple Clustering Benchmark](http://mustafaakin.wordpress.com/2012/03/19/nodejs-simple-clustering-benchmark/)。如果要使用所有内核，则应使用集群。

# python - 触发时 Python PyQt 装饰方法错误

> ID：11023893
> 
> 赞同：1
> 
> 时间：2012-06-13T21:55:06.400
> 
> 标签：python, qt, pyqt, action, decorator

我过去使用过装饰器没有任何问题，但我坚持使用这个。似乎当我的装饰函数被 PyQt 操作调用时，它失败了。我的理论是 PyQt 以某种方式在内部包装了连接的函数并弄乱了签名或类似的东西，但我找不到任何证据。

连接我的意思是这样的：

```
from PyQt4 import QtGui

# In my widget init...
self.action_my_method = QtGui.QAction("action_my_method", self)
self.action_my_method.triggered.connect(self.my_method) 
```

这是我的简单装饰器：

```
from functools import wraps

def simple_decorator(fn):
    @wraps(fn)
    def wrapper(*args, **kwargs):
        from inspect import getargspec
        print getargspec(fn)

        return fn(*args, **kwargs)
    return wrapper 
```

当我用它来装饰一个没有任何参数（`def my_method(self)`）的方法，并直接从我的 QWidget 类中执行它时，它工作正常。当我使用菜单触发操作时，我得到：

```
# Traceback (most recent call last):
#   File "[...].py", line 88, in wrapper
#     return fn(*args, **kwargs)
# TypeError: my_method() takes exactly 1 argument (2 given) 
```

我看到了一个 arg 规范：

`ArgSpec(args=['self'], varargs=None, keywords=None, defaults=None)`

如果我添加`*args`到我的方法中，所以签名是`my_method(self, *args)`，装饰器工作正常并且 arg 规范是：

`ArgSpec(args=['self'], varargs='args', keywords=None, defaults=None)`

我在这里看不到任何线索，因为装饰器在直接调用时可以正常工作，但在被操作触发时会失败。

任何人都可以对此有所了解，或者提供一些我可以用来进一步调试它的东西吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-13T22:07:51.860

这与其说是一个解决方法，不如说是一个答案。我希望这没有任何不利之处。我在输入一个简单的重定向功能时想到了它。这使用 lambda 在运行时做同样的事情：

```
self.action_my_method.triggered.connect(lambda: self.my_method()) 
```

这足以使我的装饰功能免受损坏并防止错误。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-01-18T08:24:30.873

或者，您可以将可以通过 .connect 调用的每个方法的签名重新定义为：

```
def my_method(self, qtcallparam=None, **kwargs): 
```

所以该方法将忽略第一个未命名的参数，代价是在该方法中使用严格的关键字参数（不是一件坏事）

但是@Rafe 的解决方案可能更干净

# php - 定义自定义颜色

> ID：11023896
> 
> 赞同：1
> 
> 时间：2012-06-13T21:55:16.820
> 
> 标签：php, jquery, css, colors

```
border:3px solid black; 
```

在上面的示例中，您可以通过说出颜色的名称来设置颜色。那里也有各种各样的颜色名称。

所以我的问题是这样的。有没有办法在你的网站上用 css、javascript/jquery 甚至 php 定义你自己的自定义颜色名称。

为什么？（我有点生气，但是）在 c# 中，使用可以更改的全局变量会很方便，它会影响使用它的所有内容，我希望有类似的效果。

你可能会问“你不能只使用 class="myColor" 吗？” 我可以，但我并不总是以同样的方式使用颜色，我有时将它用于边框、背景甚至文本。另外，我必须给它一个类，而不是在 css 中声明它，这对于边框来说可能很奇怪。

基本上，我想知道是否有任何接近我正在寻找的东西，无论是 css（所以怀疑它）、jquery，甚至是 php。考虑到我想在 css 中使用这个颜色名称，我怀疑这是可能的，但我很想被证明是错误的。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-13T21:57:52.937

您可以使用 CSS 预处理器（例如[SASS](http://sass-lang.com/)或[LESS](http://lesscss.org/) ）设置变量。

使用 SASS 它看起来像这样。

```
$lightGrey :#5e5e5el;

a {
    color: $lightGrey;
} 
```

输出：

```
a {
    color: #5e5e5e;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-13T21:57:35.243

使用颜色值而不是命名颜色： [https ://developer.mozilla.org/en/CSS/color_value](https://developer.mozilla.org/en/CSS/color_value)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-13T21:57:38.317

您可以使用“ [LESS](http://lesscss.org/) ”或“ [SASS](http://sass-lang.com/) ”来做到这一点。

```
@myColor: #FFCC00;
...
background-color: @myColor;
...
border: 1px solid @myColor; 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-13T21:57:39.127

[SASS](http://sass-lang.com/)有这个有用的特性（以及许多其他特性）。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-06-13T21:58:56.833

CSS 中没有为此内置任何内容。您可能想查看[LESS](http://lesscss.org/)。有了它，您可以轻松地将颜色放入变量中并在整个 CSS 中使用它。LESS 旨在使 CSS 更加 DRY。

以下是该链接中的描述：

> LESS 扩展了 CSS 的动态行为，例如变量、mixin、操作和函数。LESS 使用 Node.js 和 Rhino 在客户端（Chrome、Safari、Firefox）和服务器端运行。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-06-13T22:18:44.393

[这可能最终会出现在 CSS](http://www.w3.org/TR/css-variables/)中。

# php - 在 php 中使用“function $var() { }”是真的吗？

> ID：11023905
> 
> 赞同：0
> 
> 时间：2012-06-13T21:55:59.363
> 
> 标签：php, function, codeigniter

我正在使用 codeigniter，在控制器文件夹中，我创建了一个 php 文件，例如：
**注意：**自动连接数据库。

```
<?php

    class Book extends CI_Controller {

        $query = $this->db->get('books');

        foreach ($query->result() as $row) {

            function $row->book_name() {
                echo $row->book_name;
            }

        }

    }

?> 
```

我试图通过从数据库中获取书名来创建函数，但我做不到。通过在函数名中使用 $variable，是否可以创建函数？如果没有，如何快速创建它？谢谢...

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-13T22:02:01.577

绝对地。

```
$myfunction = function($a,$b,$c) {return $a+$b+$c;}; 
```

这是一个匿名函数的例子。它没有名称，但可以通过`$myfunction(1,2,3)`.

我不完全确定你在你的例子中想要做什么......`echo $row->book_name`一个人就足够了吗？或者你想定义一个与一本书同名的函数？在后一种情况下，您可以使用可变变量：`${$row->book_name} = function...`- 虽然这可能不是一个好主意。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-06-13T22:04:39.203

我想你可能对[__call()](http://www.php.net/manual/en/language.oop5.overloading.php#object.call)感兴趣。

如果调用了不存在的类中的`__call()`方法，则调用该方法，您可以从那里处理调用。

在您阅读结果时将书籍存储在一个数组中，`__call`并向您的类添加一个方法。访问该方法时，您可以根据调用的函数的名称在数组中搜索书籍并采取适当的行动。

```
class Book extends CI_Controller {
    protected $_books = array();

    public function __construct() {
        $query = $this->db->get('books');

        foreach ($query->result() as $row) {
            $this->_books[] = $row->book_name;
        }
    }

    public function __call($name, $arguments) {
        if (in_array($name, $this->_books)) {
            echo $name;
        } else {
            ehco 'I do not have this book!';
        }
    }
} 
```

请记住 PHP 命名方法的规则，有效的函数名称以字母或下划线开头，后跟任意数量的字母、数字或下划线。不允许有空格，所以请记住这一点。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-13T22:01:23.043

您正在搜索的是[create_function()吗？](http://php.net/manual/en/function.create-function.php)

但说真的，我花了一分钟谷歌它..

# java - Spring JPA 数据的存储库

> ID：11023907
> 
> 赞同：1
> 
> 时间：2012-06-13T21:56:18.940
> 
> 标签：java, spring, jpa, spring-data, spring-data-jpa

我正在尝试让 Spring JPA Data 为我工作，但一直在苦苦挣扎。这是问题所在。

我有两个域类，它们之间有一个简单的 OneToMany 关系：

```
class Card {
    @ManyToOne(mappedBy="user")
    private User user;
}

class User {
     @OneToMany
     private List<Card> cards;
} 
```

我已经为每个类设置了 Repository 接口：CardRepository、UserRepository 扩展了 JpaRepository，这两个存储库都被注入到一个服务中

```
@Service
@Transactional(readOnly = true)
class Service {
  @Autowired
  CardRepository repo1;
  @Autowired
  UserRepository repo2;

  public void someMethod() {
      // make use of the repos
      User u=repo2.findByIdentifier("ID1");
      List<Card> cards = u.getCards();
      //do something with the cards will throw lazyinitialization exception.
  }
} 
```

非常基本的设置。问题出现在 someMethod() 中，我用它的标识符查询了一个用户，然后尝试获取映射的 @OneToMany 列表，然后发生了 LazyInitialization 异常。

我不太确定我是否错过了那里的东西？好像只要repository的方法返回，entitymanager就关闭了；如果是这种情况，我想知道如何在不定义另一个存储库方法的情况下获得关系？

但是，如果我将@OneToMany 的获取设置为急切，那没问题，但这是我真的不想做的事情。

存储库的 delete() 似乎也有问题。如果我先删除一张卡，然后尝试 delete() 其拥有的用户（其列表中仍有该卡），则删除将失败，抱怨找不到该卡。但我没有设置从用户到卡的任何删除传播！

我希望有人可以解释实体管理器是如何在 JpaRepository 中使用的，这似乎使 Jpa 编程更加困难。我知道所有存储库都是自动生成的，但是如果有人可以指出它们是如何实现的，那将非常有帮助。

谢谢。武东

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-14T05:13:18.437

首先，映射标签需要互换，即

```
class User(){
 @OneToMany(mappedBy="user")
 private List<Card> cards;
}

class Card{
@ManyToOne
private User user;
} 
```

你怎么称呼你的**someMethod**？如果在 init-method 中调用它，您将无法使用**@Transactional**

# javascript - GitHub 在其 Graphs 页面上使用什么图形库？

> ID：11023909
> 
> 赞同：33
> 
> 时间：2012-06-13T21:56:23.013
> 
> 标签：javascript, github, graphing

GitHub 在其 Graphs 选项卡上使用什么图形库？当您导航到[https://github.com/USER/REPOSITORY/graphs/commit-activity](https://github.com/USER/REPOSITORY/graphs/commit-activity)时，图表干净、美观且响应迅速。如果他们使用的是开源 javascript 库，我也很乐意使用它！我无法通过简短的代码检查来判断。

* * *

## 回答 #1

> 赞同：46
> 
> 时间：2012-06-13T21:59:26.903

新的 GitHub 图表是使用 @mbostock 的惊人 d3 库构建的。

[http://github.com/mbostock/d3](http://github.com/mbostock/d3)

这是直接取自[https://github.com/blog/1093-introducing-the-new-github-graphs](https://github.com/blog/1093-introducing-the-new-github-graphs)

# python - PyTables 在 Windows 上安装失败

> ID：11023914
> 
> 赞同：0
> 
> 时间：2012-06-13T21:56:48.020
> 
> 标签：python, visual-studio-2008, installation, hdf5, pytables

我尝试安装 pytable 模块。我使用 win7 x64、python 2.7.2 (x32)、cython 0.16、visual studio 2008 (9.0)。在 cmd.exe '以管理员身份运行' 写：'python setup.py install'。

但是有未解析的外部符号并且构建失败：

```
* Found numpy 1.6.2 package installed.
* Found numexpr 1.4.2 package installed.
* Found Cython 0.16 package installed.
* Found HDF5 headers at ``C:\Program Files (x86)\HDF Group\HDF5\1.8.9\include``, library at ``C:\Program Files (x86)\HDF Group\HDF5\1.8.9\lib``.
* Could not find LZO 2 headers and library; disabling support for it.
* Could not find LZO 1 headers and library; disabling support for it.
* Could not find bzip2 headers and library; disabling support for it.
cythoning tables\linkExtension.pyx to tables\linkExtension.c
running install
running build
running build_py
running build_ext
No module named msvccompiler in numpy.distutils; trying from distutils
building 'tables.utilsExtension' extension
C:\Program Files (x86)\Microsoft Visual Studio 9.0\VC\BIN\cl.exe /c /nologo /Ox /MD /W3 /GS- /DNDEBUG -DNDEBUG=1 -DWIN32=1 -D_HDF5USEDLL_=1 -Iblosc -I"C:\Program Files (x86)\Python27\lib\site-packages\numpy\core\include" -I"C:\Program Files (x86)\HDF Group\HDF5\1.8.9\include" -I"C:\Program Files (x86)\Python27\include" -I"C:\Program Files (x86)\Python27\PC" /Tctables\utilsExtension.c /Fobuild\temp.win32-2.7\Release\tables\utilsExtension.obj -Isrc -DH5_USE_16_API
Found executable C:\Program Files (x86)\Microsoft Visual Studio 9.0\VC\BIN\cl.exe
C:\Program Files (x86)\Microsoft Visual Studio 9.0\VC\BIN\cl.exe /c /nologo /Ox /MD /W3 /GS- /DNDEBUG -DNDEBUG=1 -DWIN32=1 -D_HDF5USEDLL_=1 -Iblosc -I"C:\Program Files (x86)\Python27\lib\site-packages\numpy\core\include" -I"C:\Program Files (x86)\HDF Group\HDF5\1.8.9\include" -I"C:\Program Files (x86)\Python27\include" -I"C:\Program Files (x86)\Python27\PC" /Tcsrc/utils.c /Fobuild\temp.win32-2.7\Release\src/utils.obj -Isrc -DH5_USE_16_API
C:\Program Files (x86)\Microsoft Visual Studio 9.0\VC\BIN\cl.exe /c /nologo /Ox /MD /W3 /GS- /DNDEBUG -DNDEBUG=1 -DWIN32=1 -D_HDF5USEDLL_=1 -Iblosc -I"C:\Program Files (x86)\Python27\lib\site-packages\numpy\core\include" -I"C:\Program Files (x86)\HDF Group\HDF5\1.8.9\include" -I"C:\Program Files (x86)\Python27\include" -I"C:\Program Files (x86)\Python27\PC" /Tcsrc/H5ARRAY.c /Fobuild\temp.win32-2.7\Release\src/H5ARRAY.obj -Isrc -DH5_USE_16_API
C:\Program Files (x86)\Microsoft Visual Studio 9.0\VC\BIN\cl.exe /c /nologo /Ox /MD /W3 /GS- /DNDEBUG -DNDEBUG=1 -DWIN32=1 -D_HDF5USEDLL_=1 -Iblosc -I"C:\Program Files (x86)\Python27\lib\site-packages\numpy\core\include" -I"C:\Program Files (x86)\HDF Group\HDF5\1.8.9\include" -I"C:\Program Files (x86)\Python27\include" -I"C:\Program Files (x86)\Python27\PC" /Tcsrc/H5ATTR.c /Fobuild\temp.win32-2.7\Release\src/H5ATTR.obj -Isrc -DH5_USE_16_API
C:\Program Files (x86)\Microsoft Visual Studio 9.0\VC\BIN\cl.exe /c /nologo /Ox /MD /W3 /GS- /DNDEBUG -DNDEBUG=1 -DWIN32=1 -D_HDF5USEDLL_=1 -Iblosc -I"C:\Program Files (x86)\Python27\lib\site-packages\numpy\core\include" -I"C:\Program Files (x86)\HDF Group\HDF5\1.8.9\include" -I"C:\Program Files (x86)\Python27\include" -I"C:\Program Files (x86)\Python27\PC" /Tcblosc/blosc.c /Fobuild\temp.win32-2.7\Release\blosc/blosc.obj -Isrc -DH5_USE_16_API
C:\Program Files (x86)\Microsoft Visual Studio 9.0\VC\BIN\cl.exe /c /nologo /Ox /MD /W3 /GS- /DNDEBUG -DNDEBUG=1 -DWIN32=1 -D_HDF5USEDLL_=1 -Iblosc -I"C:\Program Files (x86)\Python27\lib\site-packages\numpy\core\include" -I"C:\Program Files (x86)\HDF Group\HDF5\1.8.9\include" -I"C:\Program Files (x86)\Python27\include" -I"C:\Program Files (x86)\Python27\PC" /Tcblosc/blosclz.c /Fobuild\temp.win32-2.7\Release\blosc/blosclz.obj -Isrc -DH5_USE_16_API
C:\Program Files (x86)\Microsoft Visual Studio 9.0\VC\BIN\cl.exe /c /nologo /Ox /MD /W3 /GS- /DNDEBUG -DNDEBUG=1 -DWIN32=1 -D_HDF5USEDLL_=1 -Iblosc -I"C:\Program Files (x86)\Python27\lib\site-packages\numpy\core\include" -I"C:\Program Files (x86)\HDF Group\HDF5\1.8.9\include" -I"C:\Program Files (x86)\Python27\include" -I"C:\Program Files (x86)\Python27\PC" /Tcblosc/shuffle.c /Fobuild\temp.win32-2.7\Release\blosc/shuffle.obj -Isrc -DH5_USE_16_API
C:\Program Files (x86)\Microsoft Visual Studio 9.0\VC\BIN\cl.exe /c /nologo /Ox /MD /W3 /GS- /DNDEBUG -DNDEBUG=1 -DWIN32=1 -D_HDF5USEDLL_=1 -Iblosc -I"C:\Program Files (x86)\Python27\lib\site-packages\numpy\core\include" -I"C:\Program Files (x86)\HDF Group\HDF5\1.8.9\include" -I"C:\Program Files (x86)\Python27\include" -I"C:\Program Files (x86)\Python27\PC" /Tcblosc/blosc_filter.c /Fobuild\temp.win32-2.7\Release\blosc/blosc_filter.obj -Isrc -DH5_USE_16_API

C:\Program Files (x86)\Microsoft Visual Studio 9.0\VC\BIN\link.exe /DLL /nologo /INCREMENTAL:NO /LIBPATH:"C:\Program Files (x86)\HDF Group\HDF5\1.8.9\lib" /LIBPATH:"C:\Program Files (x86)\Python27\libs" /LIBPATH:"C:\Program Files (x86)\Python27\PCbuild" hdf5dll.lib /EXPORT:initutilsExtension build\temp.win32-2.7\Release\tables\utilsExtension.obj build\temp.win32-2.7\Release\src/utils.obj build\temp.win32-2.7\Release\src/H5ARRAY.obj build\temp.win32-2.7\Release\src/H5ATTR.obj build\temp.win32-2.7\Release\blosc/blosc.obj build\temp.win32-2.7\Release\blosc/blosclz.obj build\temp.win32-2.7\Release\blosc/shuffle.obj build\temp.win32-2.7\Release\blosc/blosc_filter.obj /OUT:build\lib.win32-2.7\tables\utilsExtension.pyd /IMPLIB:build\temp.win32-2.7\Release\tables\utilsExtension.lib /MANIFESTFILE:build\temp.win32-2.7\Release\tables\utilsExtension.pyd.manifest
Found executable C:\Program Files (x86)\Microsoft Visual Studio 9.0\VC\BIN\link.exe
   Creating library build\temp.win32-2.7\Release\tables\utilsExtension.lib and object build\temp.win32-2.7\Release\tables\utilsExtension.exp
utilsExtension.obj : error LNK2019: unresolved external symbol _H5T_C_S1_g referenced in function ___pyx_pf_6tables_14utilsExtension_15AtomToHDF5Type
H5ATTR.obj : error LNK2001: unresolved external symbol _H5T_C_S1_g
utilsExtension.obj : error LNK2019: unresolved external symbol _H5T_UNIX_D64BE_g referenced in function _initutilsExtension
utilsExtension.obj : error LNK2019: unresolved external symbol _H5T_UNIX_D32BE_g referenced in function _initutilsExtension
utilsExtension.obj : error LNK2019: unresolved external symbol _H5T_IEEE_F64BE_g referenced in function _initutilsExtension
utils.obj : error LNK2001: unresolved external symbol _H5T_IEEE_F64BE_g
utilsExtension.obj : error LNK2019: unresolved external symbol _H5T_IEEE_F32BE_g referenced in function _initutilsExtension
utils.obj : error LNK2001: unresolved external symbol _H5T_IEEE_F32BE_g
utilsExtension.obj : error LNK2019: unresolved external symbol _H5T_STD_U64BE_g referenced in function _initutilsExtension
utilsExtension.obj : error LNK2019: unresolved external symbol _H5T_STD_U32BE_g referenced in function _initutilsExtension
utilsExtension.obj : error LNK2019: unresolved external symbol _H5T_STD_U16BE_g referenced in function _initutilsExtension
utilsExtension.obj : error LNK2019: unresolved external symbol _H5T_STD_U8BE_g referenced in function _initutilsExtension
utilsExtension.obj : error LNK2019: unresolved external symbol _H5T_STD_I64BE_g referenced in function _initutilsExtension
utilsExtension.obj : error LNK2019: unresolved external symbol _H5T_STD_I32BE_g referenced in function _initutilsExtension
utilsExtension.obj : error LNK2019: unresolved external symbol _H5T_STD_I16BE_g referenced in function _initutilsExtension
utilsExtension.obj : error LNK2019: unresolved external symbol _H5T_STD_I8BE_g referenced in function _initutilsExtension
utilsExtension.obj : error LNK2019: unresolved external symbol _H5T_STD_B8BE_g referenced in function _initutilsExtension
utilsExtension.obj : error LNK2019: unresolved external symbol _H5T_UNIX_D64LE_g referenced in function _initutilsExtension
utilsExtension.obj : error LNK2019: unresolved external symbol _H5T_UNIX_D32LE_g referenced in function _initutilsExtension
utilsExtension.obj : error LNK2019: unresolved external symbol _H5T_IEEE_F64LE_g referenced in function _initutilsExtension
utils.obj : error LNK2001: unresolved external symbol _H5T_IEEE_F64LE_g
utilsExtension.obj : error LNK2019: unresolved external symbol _H5T_IEEE_F32LE_g referenced in function _initutilsExtension
utils.obj : error LNK2001: unresolved external symbol _H5T_IEEE_F32LE_g
utilsExtension.obj : error LNK2019: unresolved external symbol _H5T_STD_U64LE_g referenced in function _initutilsExtension
utilsExtension.obj : error LNK2019: unresolved external symbol _H5T_STD_U32LE_g referenced in function _initutilsExtension
utilsExtension.obj : error LNK2019: unresolved external symbol _H5T_STD_U16LE_g referenced in function _initutilsExtension
utilsExtension.obj : error LNK2019: unresolved external symbol _H5T_STD_U8LE_g referenced in function _initutilsExtension
utilsExtension.obj : error LNK2019: unresolved external symbol _H5T_STD_I64LE_g referenced in function _initutilsExtension
utilsExtension.obj : error LNK2019: unresolved external symbol _H5T_STD_I32LE_g referenced in function _initutilsExtension
utilsExtension.obj : error LNK2019: unresolved external symbol _H5T_STD_I16LE_g referenced in function _initutilsExtension
utilsExtension.obj : error LNK2019: unresolved external symbol _H5T_STD_I8LE_g referenced in function _initutilsExtension
utilsExtension.obj : error LNK2019: unresolved external symbol _H5T_STD_B8LE_g referenced in function _initutilsExtension
H5ARRAY.obj : error LNK2019: unresolved external symbol _H5P_CLS_DATASET_CREATE_g referenced in function _H5ARRAYmake
blosc_filter.obj : error LNK2019: unresolved external symbol _H5E_PLINE_g referenced in function _blosc_set_local
blosc_filter.obj : error LNK2019: unresolved external symbol _H5E_CALLBACK_g referenced in function _blosc_set_local
blosc_filter.obj : error LNK2019: unresolved external symbol _H5E_CANTREGISTER_g referenced in function _register_blosc
build\lib.win32-2.7\tables\utilsExtension.pyd : fatal error LNK1120: 31 unresolved externals

error: Command "C:\Program Files (x86)\Microsoft Visual Studio 9.0\VC\BIN\link.e
xe /DLL /nologo /INCREMENTAL:NO /LIBPATH:"C:\Program Files (x86)\HDF Group\HDF5\
1.8.9\lib" /LIBPATH:"C:\Program Files (x86)\Python27\libs" /LIBPATH:"C:\Program
Files (x86)\Python27\PCbuild" hdf5dll.lib /EXPORT:initutilsExtension build\temp.
win32-2.7\Release\tables\utilsExtension.obj build\temp.win32-2.7\Release\src/uti
ls.obj build\temp.win32-2.7\Release\src/H5ARRAY.obj build\temp.win32-2.7\Release
\src/H5ATTR.obj build\temp.win32-2.7\Release\blosc/blosc.obj build\temp.win32-2.
7\Release\blosc/blosclz.obj build\temp.win32-2.7\Release\blosc/shuffle.obj build
\temp.win32-2.7\Release\blosc/blosc_filter.obj /OUT:build\lib.win32-2.7\tables\u
tilsExtension.pyd /IMPLIB:build\temp.win32-2.7\Release\tables\utilsExtension.lib
 /MANIFESTFILE:build\temp.win32-2.7\Release\tables\utilsExtension.pyd.manifest"
failed with exit status 1120 
```

有什么想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-13T22:02:49.797

我找到了解决方案。我必须使用 hdf5 库的共享版本。 [http://www.hdfgroup.org/HDF5/release/obtain5.html](http://www.hdfgroup.org/HDF5/release/obtain5.html) (HDF5189-win32-vs10-shared.zip)。不是静态的！

# django - 使用 Django 后端的 Adob e Flash 应用程序的 CSRF 处理

> ID：11023920
> 
> 赞同：1
> 
> 时间：2012-06-13T21:57:14.330
> 
> 标签：django, flash, security, csrf, tastypie

我正在构建一个使用 Django 作为后端的 Flash 游戏。

我目前使用 django-tastypie 设置了一个 api 端点，flash 应用程序可以调用它来接收 JSON 数据以填充应用程序。

我了解使用简单的 django 视图和模板系统，可以在中间件的帮助下简单地在网页中包含一个 csrf_token。

我现在的问题是尝试在不使用 csrf_exempt 的情况下将数据发布回服务器，理想情况下，可以在不插入 params 标签的情况下运行 flash 应用程序。希望有一个独立的 swf 文件可以按原样工作。

如何将 csrf_token 放入 flash 应用程序，以便它可以将数据发回服务器而无需担心安全问题？

如果无法使用 csrf_token 方式，还有其他方法可以安全地发布数据吗？

我已经搜索了许多导致类似问题的途径，但许多都没有答案。也许我在这里遗漏了一些东西，因为我全神贯注于自己的观点。我希望有人能启发我更好的方法来做到这一点。

提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-15T23:08:41.090

听起来你可能有两个问题：

**我如何通过来自 Flash 的 POST 请求实际发送 CSRF 令牌？**

Django 还通过 header 接受 CSRF 令牌`X-CRSFToken`。[请参阅此处的文档](https://docs.djangoproject.com/en/dev/ref/contrib/csrf/)。

您可以将标头附加到您的请求中，如下所示：

```
var req:URLRequest=new URLRequest();
req.url="http://somesite.com";
var header:URLRequestHeader=new URLRequestHeader("X-CSRFToken","foobar");
req.requestHeaders.push(header); 
```

[URLRequests 文档在这里](http://help.adobe.com/en_US/FlashPlatform/reference/actionscript/3/flash/net/URLRequest.html#requestHeaders)。

* * *

**我如何首先将 CSRF 令牌放入我的 Flash 文件中？！**

（选项 A）因为 CSRF 令牌是在*每个请求*的基础上生成的（例如，使用模板化传统 HTML 表单，在 GET 请求上），最简单的做法是通过模板化参数将 CSRF 令牌传递给 Flash 文件。就像是：`<param name="csrf_token" value="{{ my_csrf_token }}" />`

（选项 B）听起来您不想做参数的事情，所以您的最终选择是构建一个自定义 Django 视图，该视图具有将 CSRFToken 传递到您的 Flash 文件的唯一功能。因此，流程将是您的 Flash 文件加载，您的 Flash 发出一个 GET 请求，`http://mysite.com/csrf_token/`该请求只返回一个有效的 CSRF 令牌，然后您可以使用该令牌来执行您的 POST。（请注意，您需要为每个 POST 请求执行 GET 请求）。

# asp.net-mvc-3 - 如何修复此 MVC 网站错误：无法加载文件或程序集 'System.Web.Helpers，版本 = 2.0.0.0

> ID：11023923
> 
> 赞同：7
> 
> 时间：2012-06-13T21:57:31.577
> 
> 标签：asp.net-mvc-3, iis-7

我在我的专用服务器上安装了 MVC3，并且在那里运行了一个 mvc3 网站，问题是：
在某些页面中我收到此错误：
“无法加载文件或程序集 'System.Web.Helpers，版本 = 2.0.0.0”

![在此处输入图像描述](../Images/919e0a5c7d08f1baff06e664063a03c5.png)

而且我不知道是什么问题，因为它以前没有在这个网站或同一服务器上的任何 MVC3 网站上发生过。

注意：问题发生在我使用网格助手的某些页面中，但还有一些其他页面有网格助手并且工作正常。

我也试过这个：[http](http://haacked.com/archive/2008/11/03/bin-deploy-aspnetmvc.aspx) ://haacked.com/archive/2008/11/03/bin-deploy-aspnetmvc.aspx 虽然我知道这是一个旧帖子，但也没有希望。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-06-13T22:02:14.213

您必须在项目中安装或更新了一些 NuGet 包，这些包依赖于`System.Web.Helpers, Version=2.0.0.0`即将发布的 ASP.NET MVC 4 版本中的 Razor WebPages v2 ( )。

查看所有引用的程序集并检查它们的依赖关系。

# linux - 在 bash 脚本中使用“备用屏幕”

> ID：11023929
> 
> 赞同：54
> 
> 时间：2012-06-13T21:57:51.797
> 
> 标签：linux, bash, terminal, terminfo

*备用屏幕*被许多“用户交互”的终端应用程序使用，如 vim、htop、screen、alsamixer、less，......它就像终端内容的不同缓冲区，在应用程序退出时消失，所以整个终端得到恢复，看起来应用程序没有输出任何东西。

我想在我自己的 shell (bash) 脚本中实现完全相同的东西，只是它不必那么便携。我会坚持只使用 linux 和基于 xterm 的终端仿真器；`tput`但如果可能的话，解决方案应该使用类似的东西。但是，我不想使用一些外部脚本语言（甚至是 C 之类的语言）。

虽然我不想使用 C（因为它应该是一个依赖尽可能少的 bash 脚本），但我查看了 less 的源代码。它似乎使用 terminfo 作为数据库，并在其初始化中查找“ti”终端功能。删除该行时，它不使用备用屏幕，因此我假设我找到了负责的代码行。

但是，我在`man terminfo`. 但也许我在寻找解决方案的错误道路上。也许 terminfo / tput 不是我的朋友。

那么（如何）我可以在 bash 脚本中使用备用屏幕吗？有人知道我可以在其中找到提示的源代码的简单应用程序吗？（C 应用程序或 bash 脚本或其他...）

* * *

## 回答 #1

> 赞同：78
> 
> 时间：2012-06-13T22:25:52.470

您可以使用以下命令切换到备用屏幕：

```
$ tput smcup 
```

并返回：

```
$ tput rmcup 
```

这些命令只是为您的终端输出适当的转义序列。如果它是 XTERM，它们将等同于（更知名但不太优雅或便携）：

```
$ echo -e "\e[?1049h" 
```

和：

```
$ echo -e "\e[?1049l" 
```

有关更多终端控制命令，请参阅`man 5 terminfo`。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2015-02-05T00:56:58.717

使用 smcup/rmcup，但仅用于副作用：在正常/备用屏幕之间切换的转义序列通常嵌入在这些 terminfo 功能中——并非总是如此。

一些背景在 xterm 常见问题解答[中 为什么运行 vi 时屏幕不清晰？](http://invisible-island.net/xterm/xterm.faq.html#xterm_tite)

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2014-11-02T08:12:58.533

对于 C 控制台应用程序：

**诅咒**

维基百科：

> ncurses（新curses）是一个提供API的编程库，允许程序员以独立于终端的方式编写基于文本的用户界面。

`less`使用这个库。

一个 hello world 程序[，](http://tldp.org/HOWTO/NCURSES-Programming-HOWTO/helloworld.html)要在 gcc 中编译，需要标志 -lncurses。

```
#include <ncurses.h>

int main()
{   
    initscr();          /* Start curses mode          */
    printw("Hello World !!!");  /* Print Hello World          */
    refresh();          /* Print it on to the real screen */
    getch();            /* Wait for user input */
    endwin();           /* End curses mode        */

    return 0;
} 
```

# jquery - 摩卡兼容的固定装置支持

> ID：11023933
> 
> 赞同：10
> 
> 时间：2012-06-13T21:58:28.677
> 
> 标签：jquery, testing, bdd, mocha.js, jasmine-jquery

我希望将 Jasmine 测试转换为 Mocha 测试，因为它能够执行 Before(all)、报告功能以及对咖啡脚本的支持。

我无法找到的一件事是 Mocha（或与兼容的断言库一起使用）是否支持像 jasmine-jquery 那样的固定装置（https://github.com/velesin/jasmine-jquery）。Mocha 是否存在这样的功能？

我正在尝试测试一些操纵 DOM 的浏览器内代码（因此我将使用 html 测试运行程序运行它）。我不想使用zombiejs，因为我更喜欢在我正在测试的环境中运行它。

编辑：仅供参考，在寻找解决方案时，我遇到了使用 grunt + mocha 和 phantomjs 实现。这也不适用于我的情况，因为我想使用自定义版本的 webkit。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-06-24T04:16:38.220

据我所知，答案是否定的。这可能是因为 Mocha 最初是为了支持 node.js。在节点中，jasmine-jquery 中的固定装置的概念不存在，因为 DOM/浏览器不存在。

看看对 jasmine-jquery 插件的支持，我现在意识到自己构建这个功能可能并不难。基本机制是使用 jQuery 将外部模板添加到 DOM，同时保留对它的引用，以便清理和缓存成为可能。

如果我决定在 github 上发布一些东西，我会更新这个答案

编辑：这里是 - [https://github.com/badunk/js-fixtures](https://github.com/badunk/js-fixtures)。代码和规范基本上是从 jasmine-jquery 中复制的，但已删除了依赖项。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-09T16:39:06.220

你试过[僵尸.js](http://zombie.labnotes.org/API)吗？它与 NPM 一起安装，似乎与测试框架无关。

这给了我一个功能齐全的窗口对象，我可以用 jQuery 来装饰它。

```
Browser = require 'zombie'

browser = new Browser()
global.window = browser.window
require '../src/js/vendor/jquery-1.7.1.min.js' 
```

更新：

我重新审视了这个问题，看起来 jquery + jsdom（通过 NPM）似乎是一个更流行和轻量级的解决方案。示例： http: [//www.netboy.pl/2012/10/testing-jquery-code-with-mocha-chai-and-jsdom/](http://www.netboy.pl/2012/10/testing-jquery-code-with-mocha-chai-and-jsdom/)

# c - 如何让 SWIG 自动将模拟的“this”指针包装到 C 结构？

> ID：11023940
> 
> 赞同：8
> 
> 时间：2012-06-13T21:59:06.413
> 
> 标签：c, pointers, struct, this, swig

我已经实现了一个简单的 C“类”，在结构中使用函数指针来实现成员函数，并将指向结构的指针作为每个函数的第一个参数传递，类似于隐式的“this”指针C++。

```
%module mytest
%{
typedef struct mytest mytest;

struct mytest {
  int data;
  int (*func1)(mytest *,int);
  void (*func2)(mytest *,int);
};

int f1(mytest *me,int n) { return me->data + n; }
void f2(mytest *me,int n) { me->data += n; }

mytest *mytestNew(int n) {
  mytest *me = (mytest*) malloc(sizeof(mytest));
  me->data = n;
  me->func1 = f1;
  me->func2 = f2;
  return me;
}

%}

typedef struct mytest mytest;

struct mytest {
  int data;
  int func1(mytest *,int);
  void func2(mytest *,int);
};

extern mytest *mytestNew(int n); 
```

现在我的问题是，当为我在前端选择的任何语言创建接口时，我最终不得不将“this”指针显式传递给对象，即使语言本身支持隐藏它。

例如，假设我选择 Python。我必须做这样的事情：

```
from mytest import *
m = mytestNew(1)
m.func1(m,0) 
```

我真正想要的是这样做：

```
from mytest import *
m = mytestNew(1)
m.func1(0) 
```

我知道我可以只写一些包装代码，但是对于我的实际项目，我在现有 C 代码的很多对象中有很多函数，并将其乘以我想要支持的每种语言，这实在是太多的工作！有没有办法让 SWIG 自动执行此操作？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-14T08:58:14.047

您可以在 SWIG 中以语言中立的方式执行此操作，只需两个类型图，只要您在 SWIG 界面中将参数命名为一致的名称以及允许有选择地应用类型图的定义。（当然，除非您希望所有指向的指针都`mytest`默认成为“this”指针）

您需要的类型图是：

```
// Make sure the wraqpped function doesn't expect an input for this:
%typemap(in,numinputs=0) mytest *me "$1=NULL;"
// Slightly abuse check typemap, but it needs to happen after the rest of the arguments have been set:
%typemap(check) mytest *me {
  $1 = arg1;
} 
```

check typemap 并不是真的打算像这样使用，但它是在从目标语言中提取参数之后和进行实际调用之前注入代码的最简单方法。

您还可以借助宏简化模块，以避免编写函数指针和成员技巧之间的映射并保持同步。我最终得到了`test.h`：

```
#ifdef SWIG
#define MEMBER(name, args) name args
#else
#define MEMBER(name, args) (*name) args
#endif

typedef struct mytest mytest;

struct mytest {
  int data;
  int  MEMBER(func1,(mytest *me,int));
  void MEMBER(func2,(mytest *me,int));
}; 
```

以及对应的接口文件（test.i）：

```
%module test

%{
#include "test.h"

static int f1(mytest *me,int n) { return me->data + n; }
static void f2(mytest *me,int n) { me->data += n; }
%}

%extend mytest {
  mytest(int n) {
    $self->data = n;
    $self->func1 = f1;
    $self->func2 = f2;
  }
}

%typemap(in,numinputs=0) mytest *me "$1=NULL;"
%typemap(check) mytest *me {
  $1 = arg1;
}

%include "test.h" 
```

（这个接口文件提供了一个构造函数，它完全按照 Java 程序员的期望“创建”“对象”——你可以调用`new`它，它会在后台设置函数指针）

# c# - 在 C# 中停止调试事件

> ID：11023944
> 
> 赞同：16
> 
> 时间：2012-06-13T21:59:37.917
> 
> 标签：c#, .net, winforms, events

当应用程序关闭时，我如何或在哪里运行命令，即使是调试停止？

即使用户是开发人员并单击 Visual Studio 上的“停止调试”按钮，我也需要在任何退出时执行命令。

我尝试

```
Application.ApplicationExit += new EventHandler(this.OnApplicationExit); 
```

但它不起作用。也许我错了或者不是事件。

我使用的是 Winforms 而不是，Form Close 不能成为事件。

我正在使用 Visual Studio 2005 Net Framework 2.0（根据客户要求），但仅供参考。

也许我可以重写这个？：

```
public static void Exit(); 
```

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-06-13T22:02:33.780

问题是“停止调试”功能将完全停止应用程序 - 因此该应用程序中**没有更多的**代码将运行。

实现这一点的唯一方法是观察正在外部调试的进程，并在它被暂停时执行代码。

根据[MSDN]：

> 如果程序是从 Visual Studio 启动的，则停止调试会终止您正在调试的进程。

但是，您可以使用[Visual Studio 插件来实现您想要的](http://msdn.microsoft.com/en-us/vstudio/bb968855.aspx)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-13T22:08:20.843

根据 MSDN：http: [//msdn.microsoft.com/en-us/library/system.windows.forms.application.applicationexit%28v=vs.80%29.aspx](http://msdn.microsoft.com/en-us/library/system.windows.forms.application.applicationexit%28v=vs.80%29.aspx)

```
// Handle the ApplicationExit event to know when the application is exiting.
Application.ApplicationExit += new EventHandler(this.OnApplicationExit);

private void OnApplicationExit(object sender, EventArgs e) {
// When the application is exiting
} 
```

这是你实施的吗？

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-13T22:16:24.173

试试这个：

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Windows.Forms;

namespace Prueba {
    static class Program {
        [STAThread]
        static void Main() {
            Application.EnableVisualStyles();
            Application.SetCompatibleTextRenderingDefault(false);
            Application.Run(new Form1());
            //This is the magic line code :P
            AppDomain.CurrentDomain.ProcessExit += new EventHandler(CurrentDomain_ProcessExit);
        }

        static void CurrentDomain_ProcessExit(object sender, EventArgs e) {
            MessageBox.Show("");
        }
    }
} 
```

参考在这里（Fredrik Mörk）：. [NET Console Application Exit Event](https://stackoverflow.com/questions/1119841/net-console-application-exit-event)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2021-07-26T15:53:47.153

您可以使用**暂停**和**恢复布局。**此外，如果您有一个装满东西的组合框，它可能会减慢您的速度。我也会考虑进入“**解决方案资源管理器**”并右键单击并选择底部的“**属性”。**选择“**配置属性**”并选择“发布”和“调试”。这将大大缩短表单加载时间。 [这个链接会解释](https://docs.microsoft.com/en-us/dotnet/api/system.windows.forms.control.suspendlayout?view=net-5.0)

# javascript - 一个html文件中的多个相互依赖的javascript文件

> ID：11023945
> 
> 赞同：0
> 
> 时间：2012-06-13T21:59:40.267
> 
> 标签：javascript, html, dependency-management

我有两个 javascript 文件（file1、file2）。File1 使用在 file2 中定义的类。我是否可以通过以下方式从 html 文件中引用这些文件：

```
<script type="text/javascript" src="file1.js"></script>
<script type="text/javascript" src="file2.js"></script> 
```

这是否允许 file1 依赖于 file2 中定义的类？如果不是，有哪些插件允许这种依赖？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-12-05T16:07:35.013

概述：

使用 Jquery 动态加载 JS 使用以下内容：

```
$.getScript("file1.js",function(){

    alert("File1.js is loaded");
} 
```

面向对象 JS 和动态 js 加载的示例。

File1.js 为：

```
File1 = function(){
}
File1.prototype=
{
    constructor:File1,
    primary:function()
    {
        if (File2 == "undefined")
        {
           $.getScript("file2.js",function()
           {
              file2 = new File2();
              file2.secondary();
           });
        }
    }
} 
```

File2.js 为：

```
File2 = function(){
}
File2.prototype=
{
  constructor:File2,
  secondary:function()
  {
    if (File1 == "undefined")
    {
      $.getScript("file1.js",functiom()
      {
         file1 = new File1();
         file1.primary();
      });
    }
  }
} 
```

这应该让您很好地了解 JS 的动态加载，以及 JS 面向对象的概念。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-13T22:24:38.850

这与您使用它们的方式有关。一种简化的方法。

**场景一：**

*script1.js*

```
function primary()
{
    secondary();
} 
```

*script2.js*

```
function secondary()
{
    alert("hi primary");
} 
```

*测试.html*

```
<html>
<head>
<script src=script1.js></script>
<script src=script2.js></script>
</head>
<body>
</body>
</html> 
```

它有效（你已经知道了）

**场景二：**

*script1.js*

```
secondary(); 
```

*script2.js 和 test.html 同上*

它不工作（js错误）

**场景 3：**

*script1.js*

```
secondary(); 
```

*script2.js 保持不变*

*测试.html*

```
<html>
<head>
<script src=script1.js defer></script>
<script src=script2.js></script>
</head>
<body>
</body>
</html> 
```

有用。

这是你要找的吗？

# c++ - 开源或低成本的跨平台视频编解码库，可用于商业用途，支持 RGBA 格式

> ID：11023948
> 
> 赞同：3
> 
> 时间：2012-06-13T21:59:57.583
> 
> 标签：c++, codec

我正在寻找一种在 2D 游戏中显示视频的方法。视频需要支持 alpha 通道，以便它们可以覆盖在其他游戏元素之上。

目前我只有一系列的 PNG 文件，这些文件被解压缩然后翻阅以制作动画。这行得通，但它是一个巨大的内存猪；一个 5 秒长、每秒 24 帧的 1024x1024 动画占用超过 400MB。而且我的目标是嵌入式系统，所以这真的不好。

我一直在寻找一些可以支持这些要求的视频编解码器，但到目前为止，我真正能够提出的所有支持 RGBA 都是在 GPL 下获得许可的，所以我们不能在商业产品中使用它们。

那里有这样的野兽吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-13T22:28:24.357

大多数编解码器不支持 alpha 通道——我能想到的唯一一个是 QuickTime 动画编解码器，它不是很流行。

如果您只需要二进制 Alpha 通道（透明或不透明），那么设置其中一个颜色通道的最高位是一种常用方法。

如果这些是动画类型的帧，那么像 MJPEG 之类的东西可能会很好用，并且有很多 LGPL 许可的 mjpeg 库

# spring - 使用 util:properties 从文件系统加载属性文件？

> ID：11023952
> 
> 赞同：1
> 
> 时间：2012-06-13T22:00:12.573
> 
> 标签：spring, configuration, properties

当我尝试使用 util:properties 从文件系统加载属性文件时，找不到该属性文件。我把它放在我的根驱动器和各种地方，但我似乎无法使用 util:properties 从文件系统加载属性文件。

是否有可能做到这一点？

```
<util:properties id="configProperties" location="file:///d:/config.properties"/> 
```

从类路径加载它可以正常工作.. 但我想配置应用程序，以便系统管理员可以更改属性。

```
<util:properties id="configProperties" location="classpath:/config.properties"/> 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-14T06:11:48.463

我在一个 Linux 项目中有这个，它工作正常：

```
<util:properties id="jdbcConfiguration" location="file:///home/reporting/jdbc.properties"/> 
```

所以问题可能出在您指定路径的方式上。试试这种方式：

```
<util:properties id="configProperties" location="file:d:/config.properties"/> 
```

# javascript - 修改一个js文件的内容

> ID：11023955
> 
> 赞同：1
> 
> 时间：2012-06-13T22:00:47.507
> 
> 标签：javascript, arrays

嗨，我在 content.js 文件中有一个 Url 的 javascript 数组。我需要在单独的页面上的单独输入框中显示 url，例如 display.php。编辑和删除按钮与每个输入框一起提供。用户所做的任何更改都应反映在 content.js 文件中。

我已经在输入框中显示了所有 url。现在一个 onclick 事件在按钮按下时调用一个函数。

我的问题是更新 content.js 文件中的数组的最佳方法是什么（该文件仅包含一个数组）。我正在尝试使用文件处理，但这将要求 content.js 始终具有严格的格式。有没有更好的方法来修改数组的内容或从数组中删除行而不进行文件处理？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-13T22:05:33.070

第一步，您应该读取 JS 文件的内容并将其传递给[json_decode](http://www.php.net/manual/ru/function.json-decode.php)函数。它会给你PHP数组。使用此数组向用户显示文本框。

在第二步中，您应该获取用户提交的字符串（例如 from `$_POST`）并从中构造一个 PHP 数组。然后使用[json_encode](http://www.php.net/manual/ru/function.json-encode.php)将 PHP 数组转换为以字符串表示的 JavaScript 数组。然后你可以把这个字符串写入 JS 文件。所以它的内容总是有效的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-13T22:07:59.373

您可以使用像 PHP 这样的服务器端语言来完成。请参阅[本教程](http://www.tizag.com/phpT/filewrite.php)，了解如何使用 PHP 编写文件。我会使用将数组转换为字符串，[`json_encode`](http://www.php.net/manual/ru/function.json-encode.php)并在[读取](http://www.tizag.com/phpT/fileread.php)[`json_decode`](http://www.php.net/manual/ru/function.json-decode.php)后将其转换回数组。

如果您只为用户保存这些 URL 而没有其他人（因此只有输入/编辑数据的人需要看到它），那么我建议使用[HTML5 localStorage](http://diveintohtml5.info/storage.html)

# android - 如何设置 android webdriver 以使用 selenium 网格？

> ID：11023961
> 
> 赞同：1
> 
> 时间：2012-06-13T22:01:14.857
> 
> 标签：android, selenium, webdriver, selenium-grid

目前我有一个运行 WebDriver.apk 应用程序的 Android 设备进行移动测试。我想通过使用 selenium 网格/节点设置将这些设备合并到一个更大的测试实验室中。不幸的是，我找不到任何关于此的文档。我相信，android WebDriver.apk 使用了 RemoteWebDriverServer，但我不知道如何将其注册到节点甚至直接到网格。有没有人做到这一点？如果是这样，你能提供一些方向吗？

# java - 使用 onClick in 按钮查看视图

> ID：11023966
> 
> 赞同：0
> 
> 时间：2012-06-13T22:01:34.260
> 
> 标签：java, android, android-layout, android-intent, sdk

今天早上刚开始学习Android，需要帮助。我的应用程序中有几个按钮，我希望当用户单击按钮时将显示图像并返回按钮以加载 main.xml 。

代码：

**在 main.xml**

```
<?xml version="1.0" encoding="utf-8"?>
<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="fill_parent"
    android:layout_height="fill_parent"
    android:orientation="vertical" >

    <Button 
        android:layout_marginTop="40dp"
           android:layout_width="100dp"
           android:layout_height="80dp"
           android:id="@+id/b1"
           android:text="xyz"
           android:background="#ff3375"
           android:layout_marginLeft="20dp"
        />

    <Button 
        android:layout_marginTop="40dp"
           android:layout_width="100dp"
           android:layout_height="80dp"
           android:id="@+id/b2"
           android:layout_toRightOf="@id/b1"
           android:text="abc"
           android:background="#ff3375"
           android:layout_marginLeft="80dp"
        /></RelativeLayout> 
```

而在 Activity.java

```
package com.sam;

import android.app.Activity;
import android.os.Bundle;
import android.view.View;
import android.widget.Button;

public class A2Activity extends Activity {
    /** Called when the activity is first created. */

    Button a,b;
    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.main);
        a= (Button) findViewById(R.id.b1);
        b= (Button) findViewById(R.id.b2);
        a.setOnClickListener(new View.OnClickListener() {

        public void onClick(View v) {
            // TODO Auto-generated method stub

        }
    });
        b.setOnClickListener(new View.OnClickListener() {

        public void onClick(View v) {
            // TODO Auto-generated method stub

        }
    });}} 
```

现在，我需要在 onCLick 方法中添加什么来打开图像或 XML 文件以及返回到 main.xml 的后退按钮

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-13T22:07:23.310

请进一步解释您的问题。你是什​​么意思打开图像或xml文件？你的意思是创建一个位图？你的意思是展示它吗？如果有，在哪里？另外，你的后退按钮将返回到 main.xml 是什么意思？main.xml 是一个布局文件，而不是一个活动。

无论如何，也许您的意思是您希望在按下按钮时全屏打开图像，然后单击设备的后退按钮返回您创建的活动？

如果是这样，您可以创建一个扩展 Activity 的新类，更新清单以使其可访问，然后启动它（使用 startActivity）。在新的活动类中，将内容视图设置为显示图像的 ImageView 或具有显示图像的 imageView 的布局文件。

* * *

要开始一项新活动，您需要调用：

```
startActivity(new Intent(CurrentActivity.this, NewActivity.class); 
```

其中“CurrentActivity”是您所在的当前活动（在您的示例中称为“A2Activity”），“NewActivity”是显示图像的活动。

如前所述，不要忘记更新清单。

# php - 网址重写正则表达式

> ID：11023967
> 
> 赞同：0
> 
> 时间：2012-06-13T22:01:37.193
> 
> 标签：php, regex, mod-rewrite

我的 .htaccess 中有这个规则

```
RewriteRule ^([^/\.]+)/?$ ?page=user&id=$1 [L] 
```

它重写一个像

```
http://sitename.ext/nickname 
```

到

```
http://sitename.ext/?page=user&nickname 
```

问题是，使用带有点的网址，例如`http://sitename.ext/nick.name.test`我得到 404 错误..

我不擅长正则表达式..

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-13T22:04:28.517

那是因为它没有被重写。您特别告诉它 exclude `.`，这就是它正在做的事情。

就个人而言，我更喜欢这样的东西：

```
RewriteRule user/(.+) ?page=user&id=$1 [L] 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-13T22:04:52.437

如果你想匹配除斜线以外的任何字符，正则表达式是`[^/]`，因为`\.`它也会导致它不匹配点。

你的规则应该是

```
RewriteRule ^([^/]+)/?$ ?page=user&id=$1 [L] 
```

您可能会发现[此](http://www.regular-expressions.info/)网站很有帮助。

# c# - 虚拟 IEnumerable 编译为空

> ID：11023974
> 
> 赞同：3
> 
> 时间：2012-06-13T22:02:04.183
> 
> 标签：c#, compiler-construction, virtual, ienumerable, yield-return

我正在制作一个基类，它有一个`virtual`名为“GetBaseAddresses()”的方法。它具有作为返回类型`IEnumerable<Uri>`。如果枚举，基类将不会`yield`有任何结果，但派生类可以选择覆盖该方法并返回任意数量的项目。

这是基本方法：

```
public virtual IEnumerable<Uri> GetBaseAddresses() { } 
```

问题是，这不会编译。您*必须*返回一个值才能让编译器满意。所以，因为我想要一个空的结果，所以我会 return `null`，对吧？

```
public virtual IEnumerable<Uri> GetBaseAddresses() { return null; } 
```

问题在于，如果有人`foreach`在基类的实例上执行操作，他们将因“未设置对象引用...”的运行时错误而崩溃

所以，回想一下这个`yield return`关键字对 C# 编译器有一些魔力……我想出了这个编译器技巧（顺便说一句）。

```
public virtual IEnumerable<Uri> GetBaseAddresses()
{
    if (false) { yield return new Uri(""); }
} 
```

奇怪的是，即使“if (false) { ... }”代码被完全编译掉了——编译器很高兴我满足了“必须返回一个值”的要求，并且完全按照我的意愿去做——也就是说，可以安全枚举的空结果集。

**我的问题是 - 有没有办法在没有我的编译器技巧的情况下做到这一点？**

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-06-13T22:05:52.123

使用一个空数组，或者：

```
yield break; //end enumeration 
```

从评论中提取 svick 的想法：

```
return Enumerable.Empty<Uri>(); 
```

这更快，因为`Enumerable.Empty`总是返回一些空可枚举的缓存的、预分配的实例。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2012-06-13T22:07:39.373

只需在基本方法中返回一个空的可枚举。

```
 public virtual IEnumerable<Uri> GetBaseAddresses()
    {
        return Enumerable.Empty<Uri>();
    } 
```

或者，如果您的目标是 .NET framework < 3.5 的版本，则返回一个空列表。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2012-06-13T22:04:14.117

内置数组支持 IEnumerable，因此您可以使用：

```
public virtual IEnumerable<Uri> GetBaseAddresses() 
{     
      return new Uri[0];
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-13T23:17:17.077

空方法不起作用的原因是编译器假设如果你不使用`yield`方法中的关键字，那么你想创建一个普通的方法，而不是一个迭代器。这也是你的`if (false)`hack 有效的原因。

要正确编写返回空集合的方法，您可以以通常的方式返回空集合：

```
public virtual IEnumerable<Uri> GetBaseAddresses()
{
    return Enumerable.Empty<Uri>();
} 
```

或者你可以使用`yield break`：

```
public virtual IEnumerable<Uri> GetBaseAddresses()
{
    yield break;
} 
```

# git - 时间机器恢复后 git 已过期

> ID：11023977
> 
> 赞同：1
> 
> 时间：2012-06-13T22:02:16.663
> 
> 标签：git, timemachine

我刚刚使用 Time Machine 将我的 Mac 恢复到 10 天前的状态。然后我将我网站的存储库文件夹更新回 1 天前以继续编码。

当我运行`git status`or`gitk`时，它显示 10 天前的视图，而不是当前视图，因此它缺少一些最近的提交。我必须更新以获取当前数据的文件夹/文件在哪里？

如果需要澄清，我`origin`在 Github 上的提交时间为 6/10、6/7、6/1 和 5/30。我的错误`git status`只显示提交 6/1 和 5/30，而其他文件只是在暂存区域中浮动，就好像从未提交过一样。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-13T23:53:18.090

我不熟悉时间机器，但这听起来有点像当您使用 Dropbox 或 spideroak 等在多台计算机之间共享一个 repo 时会发生的情况。该系统基本上试图跟上您在 repo 中的工作，但它针对后台工作和不干扰您对计算机的积极使用进行了优化，因此如果它不是 100% 跟踪您的 .git 文件夹中的所有文件更改从一台计算机到另一个，你可以得到一个坏掉的回购。我想知道您的备份系统中的这种操作是否导致了同样的问题？

无论如何 - 尝试创建一个新的空 repo 文件夹并从 github 拉出一个全新的项目副本。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-14T06:19:07.337

### 问题的原因

我的本地文件夹包含一个隐藏的 .git 文件夹，它是本地存储库（感谢@JonathanLeffer）。当我选择存储库中的所有文件进行手动恢复时，Time Machine 没有恢复 .git 文件夹。

### 解决方案

我手动将 .git 恢复到 1 天前的状态，确保为所有文件选择“替换”，以确保旧文件被新文件覆盖。运行后`gitk`，所有提交对于 6/10、6/7、6/1 和 5/30 都是可见的。

# java - android中的本地化设计模式

> ID：11023982
> 
> 赞同：0
> 
> 时间：2012-06-13T22:02:54.163
> 
> 标签：java, android, design-patterns

在我的数据库中，我有一个包含本地化城市的表。

城市
_id |name_en |name_de |name_it
0 |Rome |Rom |Roma
1 |Munich |München |Monaco
...

现在我想显示一个 ListView，其中每一行都存在以用户语言中的名称开头的所有名称。此外，整个列表应按用户语言中的城市排序。

对于此类问题，哪种设计模式是正确的？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-13T22:14:47.310

显然，您需要决定将哪一列用于 SQL 请求（用于说明要检索哪一列和按哪一列排序）。所以你的列名应该是公共常量。并且您需要有一种方法来根据当前设备语言环境返回列名（常量之一）。如果语言环境与任何已知的应用程序语言环境不匹配，则使用其中一个常量作为后备。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-13T22:12:17.643

这是一个相当广泛的问题，但这是一种通用方法：

*   获取用户当前语言（[获取设备当前语言](https://stackoverflow.com/questions/4212320/get-the-current-language-in-device)）
*   使用此语言代码[查询您的数据库](http://developer.android.com/reference/android/database/sqlite/SQLiteDatabase.html)
*   [将返回的Cursor](http://developer.android.com/resources/tutorials/views/hello-listview.html)绑定到您的 ListView

如果您需要具体帮助，请发布您的相关代码。

# gcc - 无法为 cilk 构建 gcc 分支

> ID：11023985
> 
> 赞同：0
> 
> 时间：2012-06-13T22:03:05.897
> 
> 标签：gcc, makefile, cilk, cilk-plus

我正在尝试通过以下命令从下载的 svn 分支中构建 cilk 分支： `svn co http://gcc.gnu.org/svn/gcc/branches/cilkplus-4_7-branch/`

我用来安装的教程是：[这个](http://software.intel.com/en-us/articles/how-to-build-gcc-cilkplus-brance-in-64bit-ubuntu-1204/)

在第 5 步第 9 行中，我收到此错误：

`ar: elem-function-common.o: No such file or directory`

尽管该错误本身很容易解释，但我无法在 make -j3 的命令日志中找到任何此类文件“elem-function-common.o”的创建（步骤 5 第 9 行）。有人可以帮我解决这个问题。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-21T03:10:31.483

[尝试在这里](http://gcc.gnu.org/svn/gcc/branches/cilkplus/)构建其他分支，它可以轻松编译和安装。另一个分支未经测试，因此建议不要使用它（截至日期的帖子）

# mysql - MySQL如何安全地随机化这个查询的输出？

> ID：11023987
> 
> 赞同：0
> 
> 时间：2012-06-13T22:03:15.807
> 
> 标签：mysql, performance, random

我有一个 SELECT 查询，我期望从中获得数百万个结果。我需要在 MySQL 中随机化这些结果。查询后在我的脚本中执行此操作显然会使用太多 RAM。有人可以重做这个查询，以便结果都是随机的，而不使用 rand() 的顺序吗？我看过一些示例并尝试使用它们，但它们对我不起作用，因为它们似乎都依赖于返回整个表而不是使用 WHERE 子句。这是我的查询：

```
SELECT * FROM pool
WHERE gender = 'f'
AND (`location` = 'united states' OR `location` = 'us' OR `location` = 'usa'); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-13T22:11:02.747

如果您可以使用其他语言，例如 php，您可以使用它的`rand()`函数来生成 id 并将其添加到查询中，例如

```
$ids = range($mini, $maxid);
shuffle($ids);
array_slice($ids, 0, $quantity); 
```

或您使用的任何语言中的类似内容。

如果您需要在纯 mysql 查询中执行此操作，那么这里有一些替代方法：[http ://www.electrictoolbox.com/msyql-alternative-order-by-rand/](http://www.electrictoolbox.com/msyql-alternative-order-by-rand/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-13T22:23:21.503

如果您有 1000 万行带有 id 的行，它们是否在连续范围内？

1.  通过快速选择从您想要的范围中获取最低的 id。
2.  获取最大的 id 为好。
3.  使用php生成此范围内的随机数
4.  一旦你有你的号码“SELECT * FROM table1 WHERE id IN（你生成的号码）”或类似的东西

# android - 添加 android:configChanges 到生成的清单

> ID：11023989
> 
> 赞同：0
> 
> 时间：2012-06-13T22:03:23.493
> 
> 标签：android, air, flash-builder

我正在使用 Flash Builder 构建一个 AIR android 应用程序。为了防止在出现锁定屏幕时激活应用程序，我需要修改 AndroidManifest.xml 以在应用程序标记中包含修改后的 android:configChanges 属性。

AIR 在 AIR 应用程序描述符文件 (*-app.xml) 中提供 manifestAdditions 标记来完成此操作，但如果我包含 configChanges 属性，编译器会引发错误。我可以手动解包并编辑清单，但随后我必须重新签署包，这很麻烦（并且有点破坏了使用 IDE 的意义）。

有没有办法自动化修改清单的过程？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-13T22:18:30.553

您不能在 AIR 中调整它，它是保留的。您需要以手动方式进行操作。

看一眼：

[http://help.adobe.com/en_US/air/build/WSfffb011ac560372f-5d0f4f25128cc9cd0cb-7ffc.html](http://help.adobe.com/en_US/air/build/WSfffb011ac560372f-5d0f4f25128cc9cd0cb-7ffc.html)

**保留的 Android 清单设置**

AIR 在生成的 Android 清单文档中设置了几个清单条目，以确保应用程序和运行时功能正常工作。您不能定义以下设置：

**清单元素**

您不能设置清单元素的以下属性：

*   包裹
*   安卓：版本代码
*   安卓：版本名称
*   xmlns:安卓

**活动元素**

您不能为主要活动元素设置以下属性：

*   机器人：标签
*   安卓：图标

**应用元素**

您不能设置应用程序元素的以下属性：

*   安卓：主题
*   机器人：名称
*   机器人：标签
*   安卓：windowSoftInputMode
*   **安卓：配置更改**
*   安卓：屏幕方向
*   安卓：启动模式

# python - Python - 运行 Excel 宏

> ID：11023990
> 
> 赞同：4
> 
> 时间：2012-06-13T22:03:42.043
> 
> 标签：python, excel, win32com, vba

我想使用 Python 在 Data.csv 的工作表上运行 MacroBook.xlsm 中包含的宏。

通常在 excel 中，我打开两个文件并将焦点转移到 Data.csv 文件并从 MacroBook 运行宏。python 脚本每天都会下载 Data.csv 文件，因此我无法将宏放入该文件中。

这是我的代码：

```
import win32com.client
import os
import xl

excel = win32com.client.Dispatch("Excel.Application")

macrowb = xl.Workbook('C:\MacroBook.xlsm')
wb1 = xl.Workbook('C:\Database.csv')
excel.Run("FilterLoans") 
```

我得到一个错误，

> " , u'xlmain11.chm', 0, -2146827284), 无)

错误指出 FilterLoans 在 Database.csv 文件中不可用...如何导入它？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2019-11-28T08:18:31.707

尝试将宏保存到“正常”项目并调用。

```
excel.Application.Run("Normal.ModuleName.SubName") 
```

您甚至可以通过编程方式将模块添加到普通配置文件，但如果您没有足够的访问权限，Office 不允许您这样做。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-01-03T10:22:12.987

1）您不能在 *.csv 文件上使用 VBA。您需要将 *.xlsm 文件作为活动工作簿。如果您的宏知道如何找到它，我认为您根本不需要打开 *.csv 文件。

2) 在 Office Excel 中启用 VBA 模块访问：

```
File
options
Trust Center
Trust Center Settings
Macro Settings
Enable VBA access 
```

3）我正在使用这个函数来运行宏：

```
excel.Application.Run("FilterLoans") 
```

# android - 实现 Facebook 应用，以便轻松生成 Android/iOS 应用

> ID：11023992
> 
> 赞同：-1
> 
> 时间：2012-06-13T22:03:51.980
> 
> 标签：android, ios, facebook

嘿伙计们，我正在创建一个 Facebook 应用程序作为我的暑期项目，并且非常有兴趣在移动设备上访问它。但是，我无法通过官方 FB 应用程序和登录网站访问我的手机 (android) 上的 fb 应用程序。似乎一些 Facebook 应用程序也有移动应用程序，我想知道是否：

*   这些应用程序是用 Java 或 Objective-C 等平台语言从头开始编写的，还是使用某种包装应用程序来包装现有的 Facebook 应用程序代码？一个朋友或我的朋友在使用 flash 制作后使用后一种方法制作一个 android 应用程序，所以我知道这种方式存在！

*   如果这是我的目标，我应该考虑任何具体的设计问题吗？比如用特定的语言来制作吗？

任何指针表示赞赏！感谢阅读：D

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-13T22:35:33.430

如果您访问[Mobile](http://developers.facebook.com/docs/guides/mobile/)文档，您会发现有 3 个选项：Mobile Web、iOS 和 Android，您将找到每个选项的教程。

由于您没有提供太多信息，因此很难回答您的问题，例如您已经拥有的应用程序是什么？它是严格静态的还是您有服务器端？你想在手机版中做什么？它只是您现有应用程序的一个界面，还是您想在移动版本中重新创建它？

# c# - 为什么 lambda 比 IL 注入动态方法快？

> ID：11023993
> 
> 赞同：16
> 
> 时间：2012-06-13T22:03:54.840
> 
> 标签：c#, .net-4.0

我刚刚构建了动态方法 - 见下文（感谢 SO 用户）。看起来，Func 作为一种动态方法创建，IL 注入比 lambda 慢 2 倍。

任何人都知道为什么？

**（编辑：这是在 VS2010 中作为 Release x64 构建的。请从控制台而不是从 Visual Studio F5 内部运行它。）**

```
class Program
{
    static void Main(string[] args)
    {
        var mul1 = IL_EmbedConst(5);
        var res = mul1(4);

        Console.WriteLine(res);

        var mul2 = EmbedConstFunc(5);
        res = mul2(4);

        Console.WriteLine(res);

        double d, acc = 0;

        Stopwatch sw = new Stopwatch();

        for (int k = 0; k < 10; k++)
        {
            long time1;

            sw.Restart();

            for (int i = 0; i < 10000000; i++)
            {
                d = mul2(i);
                acc += d;
            }

            sw.Stop();

            time1 = sw.ElapsedMilliseconds;

            sw.Restart();

            for (int i = 0; i < 10000000; i++)
            {
                d = mul1(i);
                acc += d;
            }

            sw.Stop();

            Console.WriteLine("{0,6} {1,6}", time1, sw.ElapsedMilliseconds);
        }

        Console.WriteLine("\n{0}...\n", acc);
        Console.ReadLine();
    }

    static Func<int, int> IL_EmbedConst(int b)
    {
        var method = new DynamicMethod("EmbedConst", typeof(int), new[] { typeof(int) } );

        var il = method.GetILGenerator();

        il.Emit(OpCodes.Ldarg_0);
        il.Emit(OpCodes.Ldc_I4, b);
        il.Emit(OpCodes.Mul);
        il.Emit(OpCodes.Ret);

        return (Func<int, int>)method.CreateDelegate(typeof(Func<int, int>));
    }

    static Func<int, int> EmbedConstFunc(int b)
    {
        return a => a * b;
    }
} 
```

这是输出（对于 i7 920）

```
20
20

25     51
25     51
24     51
24     51
24     51
25     51
25     51
25     51
24     51
24     51

4.9999995E+15... 
```

==================================================== ===========================

**编辑 编辑 编辑 编辑**

**这是dhtorpe**是正确的证明——更复杂的 lambda 将失去其优势。证明它的代码（这表明 Lambda与 IL 注入具有**完全相同的性能）：**

```
class Program
{
    static void Main(string[] args)
    {
        var mul1 = IL_EmbedConst(5);
        double res = mul1(4,6);

        Console.WriteLine(res);

        var mul2 = EmbedConstFunc(5);
        res = mul2(4,6);

        Console.WriteLine(res);

        double d, acc = 0;

        Stopwatch sw = new Stopwatch();

        for (int k = 0; k < 10; k++)
        {
            long time1;

            sw.Restart();

            for (int i = 0; i < 10000000; i++)
            {
                d = mul2(i, i+1);
                acc += d;
            }

            sw.Stop();

            time1 = sw.ElapsedMilliseconds;

            sw.Restart();

            for (int i = 0; i < 10000000; i++)
            {
                d = mul1(i, i + 1);
                acc += d;
            }

            sw.Stop();

            Console.WriteLine("{0,6} {1,6}", time1, sw.ElapsedMilliseconds);
        }

        Console.WriteLine("\n{0}...\n", acc);
        Console.ReadLine();
    }

    static Func<int, int, double> IL_EmbedConst(int b)
    {
        var method = new DynamicMethod("EmbedConstIL", typeof(double), new[] { typeof(int), typeof(int) });

        var log = typeof(Math).GetMethod("Log", new Type[] { typeof(double) });

        var il = method.GetILGenerator();

        il.Emit(OpCodes.Ldarg_0);
        il.Emit(OpCodes.Ldc_I4, b);
        il.Emit(OpCodes.Mul);
        il.Emit(OpCodes.Conv_R8);

        il.Emit(OpCodes.Ldarg_1);
        il.Emit(OpCodes.Ldc_I4, b);
        il.Emit(OpCodes.Mul);
        il.Emit(OpCodes.Conv_R8);

        il.Emit(OpCodes.Call, log);

        il.Emit(OpCodes.Sub);

        il.Emit(OpCodes.Ret);

        return (Func<int, int, double>)method.CreateDelegate(typeof(Func<int, int, double>));
    }

    static Func<int, int, double> EmbedConstFunc(int b)
    {
        return (a, z) => a * b - Math.Log(z * b);
    }
} 
```

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-06-14T21:47:25.223

**常数 5 是原因。**为什么会这样？原因：当 JIT 知道常量为 5 时，它不会发出`imul`指令，而是发出 lea `[rax, rax * 4]`。这是众所周知的装配级优化。但由于某种原因，这段代码执行得较慢。优化是一种悲观。

发出闭包的 C# 编译器阻止了 JIT 以这种特定方式优化代码。

证明：将常数改为56878567，性能发生变化。检查 JITed 代码时，您可以看到现在使用了 imul。

我设法通过将常量 5 硬编码到 lambda 中来捕捉到这一点，如下所示：

```
 static Func<int, int> EmbedConstFunc2(int b)
    {
        return a => a * 5;
    } 
```

这使我能够检查 JITed x86。

旁注：.NET JIT 不会以任何方式内联委托调用。只是提到这一点，因为它被错误地推测为评论中的情况。

Sidenode 2：为了获得完整的 JIT 优化级别，您需要在发布模式下编译并在不附加调试器的情况下启动。即使在发布模式下，调试器也会阻止执行优化。

旁注 3：虽然 EmbedConstFunc 包含一个闭包并且通常会比动态生成的方法慢，但这种“lea”优化的效果会造成更大的破坏，最终会更慢。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2014-07-05T16:32:01.463

lambda 并不比 DynamicMethod 快。它基于。但是，静态方法比实例方法快，但静态方法的委托创建比实例方法的委托创建慢。Lambda 表达式构建一个静态方法，但通过添加“闭包”作为第一个参数来像实例方法一样使用它。委托给静态方法“pop”堆栈以在“mov”到真正的“IL body”之前摆脱不需要的“this”实例。在委托的情况下，例如方法“IL body”被直接命中。这就是为什么通过 lambda 表达式构建的假设静态方法的委托更快（可能是委托模式代码在实例/静态方法之间共享的副作用）

通过将未使用的第一个参数（例如闭包类型）添加到 DynamicMethod 并使用显式目标实例（可以使用 null）调用 CreateDelegate 可以避免性能问题。

var myDelegate = DynamicMethod.CreateDelegate(MyDelegateType, null) as MyDelegateType;

[http://msdn.microsoft.com/fr-fr/library/z43fsh67(v=vs.110).aspx](http://msdn.microsoft.com/fr-fr/library/z43fsh67%28v=vs.110%29.aspx)

托尼丁字裤

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-06-14T22:05:47.053

鉴于只有在没有附加调试器的情况下以发布模式运行时才存在性能差异，我能想到的唯一解释是 JIT 编译器能够对 lambda 表达式进行本机代码优化，而它无法为发出的IL动态函数。

编译发布模式（优化）并在没有附加调试器的情况下运行，lambda 始终比生成的 IL 动态方法快 2 倍。

使用附加到进程的调试器运行相同的发布模式优化构建会使 lambda 性能下降到与生成的 IL 动态方法相当或更差。

这两次运行之间的唯一区别在于 JIT 的行为。在调试进程时，JIT 编译器会抑制许多本机代码生成优化，以保留本机指令到 IL 指令到源代码行号映射和其他相关性，这些相关性将被激进的本机指令优化破坏。

只有当输入表达式图（在本例中为 IL 代码）匹配某些非常具体的模式和条件时，编译器才能应用特殊情况优化。JIT 编译器显然具有 lambda 表达式 IL 代码模式的特殊知识，并且为 lambdas 发出与“正常” IL 代码不同的代码。

您的 IL 指令很可能与导致 JIT 编译器优化 lambda 表达式的模式不完全匹配。例如，您的 IL 指令将 B 值编码为内联常量，而类似的 lambda 表达式从内部捕获的变量对象实例加载字段。即使您生成的 IL 要模仿 C# 编译器生成的 lambda 表达式 IL 的捕获字段模式，它仍然可能不够“接近”以接收与 lambda 表达式相同的 JIT 处理。

正如评论中提到的，这很可能是由于内联 lambda 以消除调用/返回开销。如果是这种情况，我希望看到这种性能差异在更复杂的 lambda 表达式中消失，因为内联通常只保留给最简单的表达式。

# google-analytics - 如何使用谷歌解析trackEvent？

> ID：11023996
> 
> 赞同：2
> 
> 时间：2012-06-13T22:04:01.140
> 
> 标签：google-analytics

我刚刚加入了我的同事曾经工作过的一个项目。我看到以下代码。

```
 var _gaq = _gaq || [];
  _gaq.push(['_setAccount', "my id"]);
  _gaq.push(['_trackPageview']);

  _gaq.push(['_trackEvent', 'app', 'DEACTIVATE']) 
```

问题是，我在谷歌分析页面下看不到任何用户事件。我检查了内容->事件。

我用谷歌搜索然后发现大多数人使用

```
pageTracker = _gat._getTracker("id")
pageTracker._trackEvent("app","DEACTIVATE"); 
```

哪一个是正确的？我喜欢先自己测试一下，但应用程序已经上线，GA 延迟了一天。我喜欢先确认一下。

**更新**：在深入研究之后，我发现我应该使用第一种方法。但是，除非您传递该值，否则它仍然不起作用。

```
 var _gaq = _gaq || [];
  _gaq.push(['_setAccount', "my id"]);
  _gaq.push(['_trackPageview']);

  _gaq.push(['_trackEvent', 'app', 'DEACTIVATE',""])   // must pass value even if it's empty 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-05T02:23:48.730

如果您使用的是异步版本 - 通常没有理由不应该这样做，那么您应该始终使用

`_gaq.push(...)`- （其中 _gaq 只是一个 javascript 数组，`push()`只是添加到末尾）

这个数组的全部意义在于您可以存储事件，无论是`trackEvent`事件还是`trackPageView`GA 脚本可能加载之前的事件 - 这就是它被称为异步跟踪的原因。加载脚本后，它会处理数组中的所有内容。

如果您在 google 脚本完成加载之前将某些内容推送到此数组的页面上有 javascript，则该事件在加载后仍将被跟踪。它也可以在脚本加载后工作。

我假设（但尚未验证这一点）——一旦脚本被加载，它就会转换`_gaq`为一个可观察的数组——或者只是一个直接的方法调用，这样一旦你向它推送更多内容，它就可以立即被处理。

我建议使用[Google Analytics Debugger](https://chrome.google.com/webstore/detail/google-analytics-debugger/jnkmfdileelhofjcijamephohjechhna)，它是由 Google 发布的 Chrome 插件 - 实时查看发送的内容。[这也](https://developers.google.com/analytics/resources/articles/gaTrackingTroubleshooting)适用于一般的 GA 调试提示。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-04T21:51:13.153

如果您不想一直部署您的应用程序，并且想要更灵活和更快，您可以使用 SiteApps 中的此应用程序，如下所示：

[http://siteapps.com/app/easy_ga_track_event-459](http://siteapps.com/app/easy_ga_track_event-459)

很容易设置。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-13T22:09:57.437

我认为第一部分是正确的。为了确保您可以使用[http://www.fiddler2.com/fiddler2/](http://www.fiddler2.com/fiddler2/)查看是否引发了事件或安装[Google Analytic debugger](https://chrome.google.com/webstore/detail/jnkmfdileelhofjcijamephohjechhna)。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-13T22:22:22.143

_gaq 是 Google Analytics 异步页面跟踪全局对象。
_gat 是 Google 的传统页面跟踪对象。

根据 Google 的文档，不推荐使用 _gat(account) 方法调用。

有关详细信息，请参阅[https://developers.google.com/analytics/devguides/collection/gajs/methods/gaJSApi_gat](https://developers.google.com/analytics/devguides/collection/gajs/methods/gaJSApi_gat)。

另请参阅[https://developers.google.com/analytics/devguides/collection/gajs/](https://developers.google.com/analytics/devguides/collection/gajs/)，了解有关 Google Analytics 的更多信息。

以下是 Google 的基本异步跟踪示例：

```
var _gaq = _gaq || [];
_gaq.push(['_setAccount', 'UA-XXXXX-X']);
_gaq.push(['_trackPageview']);

(function() {
  var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
  ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
  var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
})(); 
```

您是否在页面的 Javascript 中的任何位置看到上述匿名函数？

以下代码适用于我。 **我确实注意到在您发布的代码中，您在事件跟踪调用中缺少一个尾随分号。** 我最初复制了您的代码，该代码导致了 JavaScript 异常，该异常已通过在行上放置一个尾随分号来纠正。

```
var _gaq = _gaq || [];
_gaq.push(['_setAccount', 'UA-######-1']);
_gaq.push(['_trackPageview']);

_gaq.push(['_trackEvent', 'app', 'DEACTIVATE']);

(function() {
  var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
  ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
  var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
})(); 
```

同样，上面的代码对我有用。

祝你好运！

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-06-14T01:30:43.600

对于第二种方法，您要使用`_getTrackerByName`而不是`_getTracker`

```
pageTracker = _gat._getTrackerByName();
pageTracker._trackEvent("app","DEACTIVATE"); 
```

无论哪种方式都可以，但首选第一种。

您是在实时服务器上进行测试，还是在 localhost/Intranet 机器上进行测试？如果您的服务器不在完全限定的域名上，Google Analytics 将不会发送跟踪请求 (__utm.gif) - 请参阅[Google Analytics GIF request not sent](https://stackoverflow.com/questions/9738815/google-analytics-gif-request-not-sent/9741228#9741228)。

# c# - “ClickOnce 不支持请求执行级别‘requireAdministrator’。”

> ID：11023998
> 
> 赞同：104
> 
> 时间：2012-06-13T22:04:20.767
> 
> 标签：c#, wpf, compiler-errors, clickonce

所以我正在编写一个需要访问注册表的应用程序。我没有触及任何构建设置，希望在我添加其他内容（例如描述或名称）之前让它工作。

出乎意料的是，我得到一个不会消失的错误。`ClickOnce does not support the request execution level 'requireAdministrator'.`现在，我还没有在这个应用程序中接触过 ClickOnce。我所做的只是包含一个请求这些权限的清单文件。

我现在的问题是这个错误不会消失，我无法编译我的程序。关于做什么的任何建议？（旁注：我要睡觉了，所以明天下午我会检查这个）。

* * *

## 回答 #1

> 赞同：158
> 
> 时间：2012-06-14T15:59:06.897

**编辑：**这条评论也给出了一个很好的答案。

> 每当您单击“发布”时，单击一次似乎会启用，无论您是否愿意！如果您使用的是“requireAdministrator”，那么您似乎无法使用 ClickOnce，因此无法“发布”您的项目。

* * *

**原来的：**

原来，在“安全”选项卡下，“启用 ClickOnce 安全设置”已被选中。尽管我没有检查它。无论如何，取消选中停止 ClickOnce 给我的错误。找了好久才发现...

* * *

## 回答 #2

> 赞同：50
> 
> 时间：2015-03-17T17:23:49.743

我知道这是一个老问题，但两年后我来到这里，所以：

您可以从项目属性的安全选项卡中禁用 ClicKOnce 以帮助解决问题；见下文：

![在此处输入图像描述](../Images/70aa5cb7e19338c3073b566aebb2842d.png)

* * *

## 回答 #3

> 赞同：20
> 
> 时间：2013-10-03T05:53:36.300

如果您曾经使用过发布向导或“立即发布”，则单击一次复选框会自动选中...

* * *

## 回答 #4

> 赞同：19
> 
> 时间：2017-09-06T16:19:59.143

我知道这很旧，但我偶然发现它正在寻找答案。就我而言，我正在使用发布功能，我需要继续使用它。我还需要访问管理功能。因此，出于这个原因，上述答案都不适合我。

我最终在我的应用程序的最开始添加了一个方法，该方法检查它是否以管理员身份运行，如果不是，则以管理员身份重新启动。为此，您需要添加以下参考。

```
using System;
using System.Diagnostics;
using System.Reflection;
using System.Security.Principal; 
```

然后你需要把它放在你的主要方法可以方便地访问的地方。我正在使用 WPF，所以我将它添加到 MainWindow.xaml.cs 但您可以在代码的早期任何地方添加它。如果需要，请记住在这些方法中添加“静态”。

```
private void AdminRelauncher()
{
    if (!IsRunAsAdmin())
    {
        ProcessStartInfo proc = new ProcessStartInfo();
        proc.UseShellExecute = true;
        proc.WorkingDirectory = Environment.CurrentDirectory;
        proc.FileName = Assembly.GetEntryAssembly().CodeBase;

        proc.Verb = "runas";

        try
        {
            Process.Start(proc);
            Application.Current.Shutdown();
        }
        catch(Exception ex)
        {
            Console.WriteLine("This program must be run as an administrator! \n\n" + ex.ToString());
        }
    }
}

private bool IsRunAsAdmin()
{
    try
    {
        WindowsIdentity id = WindowsIdentity.GetCurrent();
        WindowsPrincipal principal = new WindowsPrincipal(id);
        return principal.IsInRole(WindowsBuiltInRole.Administrator);
    }
    catch (Exception)
    {
        return false;
    }
} 
```

最后，在程序开始时，添加对该方法的引用。就我而言，我将它添加到 MainWindow 但也将其添加到 Main 作品。

```
public MainWindow()
{
    InitializeComponent();
    AdminRelauncher(); //This is the only important line here, add it to a place it gets run early on.
} 
```

希望这可以帮助！

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2019-12-04T02:24:22.337

对于那些使用取消选中“启用 ClickOnce 安全设置”无法工作的人，请尝试我找到的方法。

首先，将您的 app.manifest requestedExecutionLevel 项保持原样：

```
<requestedExecutionLevel level="asInvoker" uiAccess="false" /> 
```

然后像这样编辑 Program.cs 文件：

```
using System;
using System.Diagnostics;
using System.Reflection;
using System.Security.Principal;
using System.Windows.Forms; 
```

重构主要方法，如：

```
 static void Main()
        {
            var wi = WindowsIdentity.GetCurrent();
            var wp = new WindowsPrincipal(wi);

            bool runAsAdmin = wp.IsInRole(WindowsBuiltInRole.Administrator);

            if (!runAsAdmin)
            {
                // It is not possible to launch a ClickOnce app as administrator directly,
                // so instead we launch the app as administrator in a new process.
                var processInfo = new ProcessStartInfo(Assembly.GetExecutingAssembly().CodeBase);

                // The following properties run the new process as administrator
                processInfo.UseShellExecute = true;
                processInfo.Verb = "runas";

                // Start the new process
                try
                {
                    Process.Start(processInfo);
                }
                catch (Exception)
                {
                    // The user did not allow the application to run as administrator
                    MessageBox.Show("Sorry, but I don't seem to be able to start " + 
                       "this program with administrator rights!");
                }

                // Shut down the current process
                Application.Exit();
            }
            else
            {
                // We are running as administrator
                Application.EnableVisualStyles();
                Application.SetCompatibleTextRenderingDefault(false);
                Application.Run(new Form1());
            }
        } 
```

它适用于 Windows 10 和 Visual Studio 2019！

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2017-09-27T20:01:43.553

可以通过选择“启用 ClickOnce 安全设置”（因为在发布期间不能“取消选中”，如前所述）然后选择“这是部分信任的应用程序”来实现此操作。下拉菜单中会自动选择“本地 Intranet”，非常好。

保存您的更改，发布应用程序，完成滑雪。:-)[![安全设置片段](../Images/9e590c529bc1a6cc395f84d74084727b.png)](https://i.stack.imgur.com/5Q3QS.png)

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2014-08-28T17:34:41.213

我有同样的问题我通过取消选中“**启用 ClickOnce 安全设置”**来解决它 要在 Visual Studio 中找到此选项右键单击您的**项目 ==>properties==>选择安全==>启用 ClickOnce 安全设置**（此选项是已经检查过，所以我取消了检查，我的问题得到了解决）。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2017-10-03T13:57:00.807

这是 VB.NET 的代码片段

```
If Not New WindowsPrincipal(WindowsIdentity.GetCurrent).IsInRole(WindowsBuiltInRole.Administrator) Then
            Process.Start(New ProcessStartInfo With { _
                                                     .UseShellExecute = True, _
                                                     .WorkingDirectory = Environment.CurrentDirectory, _
                                                     .FileName = Assembly.GetEntryAssembly.CodeBase, _
                                                     .Verb = "runas"}) 
```

编辑：但是如果你以这种方式部署，一些 AV 软件会阻止你的代码。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2020-06-09T21:58:22.190

对于遇到这种情况的任何人，我想我会贡献最终对我有用的东西。

是的，“启用 ClickOnce 安全设置”选项会在您执行*Build > Publish*时自动重新检查，如果您取消选中它。

对我来说，我不需要“发布”——它是一个简单、可移植的 .exe，它为我的用户创建计划任务，我需要确保它提升，即使以管理员身份登录也是如此。

*所以我刚刚从\bin\Release*中获取了我最新的 .exe ，这就是我在客户系统上部署的内容。

正如预期的那样工作 - 即当我将它放在启用 UAC/在其最高设置的系统上时，.exe 上面有“盾牌”，当我运行它时，即使以管理员身份登录，它升高了，我得到了 UAC 提示。

我的小任务计划程序应用程序现在能够创建任务而不会出现“拒绝访问”错误（以前只能通过右键单击 .exe 并单击以管理员身份运行来解决此问题）。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2014-04-16T12:24:36.660

查看您的 app.Manifest 文件，您会看到：

```
 <requestedExecutionLevel  level="requireAdministrator" uiAccess="false" /> 
```

评论中有说明，但只需删除“requireAdministrator”并将其插入就可以解决我的问题：

```
 <requestedExecutionLevel  level="asInvoker" uiAccess="false" /> 
```

* * *

## 回答 #11

> 赞同：-13
> 
> 时间：2015-06-19T08:49:04.267

只是

```
Imports System.security 
```

你不会得到任何错误，你的应用程序将以管理员身份运行