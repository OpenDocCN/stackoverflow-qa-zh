# StackOverflow 问答 000818000-000818999

# wcf - SOAP 的 WCF 错误

> ID：818002
> 
> 赞同：3
> 
> 时间：2009-05-03T21:07:50.377
> 
> 标签：wcf, soap, faults

我对如何使用 SOAP 将错误返回给客户端感到困惑。

我有一个 wcf 服务，但我不确定客户端使用的是什么技术，所以我想坚持 SOAP 规范。

据我所知，故障消息似乎是处理此问题的最佳方式。

我可以看到我的服务有许多不同的可能错误：

*   空\预期的数据错误
*   数据格式错误（即：db 只允许 3 个字符）
*   数据范围错误“客户已存在”、“无法处理您的请求”类型错误

为每个错误创建一个新对象并像这样抛出是否合适：

```
FaultException<NullFault>(nf);  
FaultException<InvalidDataFault>(idf);  
FaultException<ArguementFault>(af);  
FaultException<RangeFault>(rf); 
```

客户端将具有许多属性的大对象传递给几乎每个方法（即：客户、订单等）。

这是否是处理错误并将其发送回客户端的正确方法？

必须将每个故障添加到方法上方的属性中似乎不合适。

IE：

```
[OperationContract]  
[FaultContract(typeof(NullFault))]  
[FaultContract(typeof(InvalidDataFault))]  
[FaultContract(typeof(ArguementFault))]  
[FaultContract(typeof(RangeFault))]  
void CreateCustomer(Customer customer); 
```

另外，GenericFault 呢？您将如何处理业务规则错误？即：客户已经存在，订单项太多，不发货到该地区，付款方式不接受等？

请让我知道此方法是否正确或是否有其他可接受的解决方案以及您将如何处理“业务规则”情况。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-03T21:11:08.667

返回故障通常是正确的方法，但您还应该问自己客户端程序将如何处理您在故障中返回的信息。如果客户只需要知道发生了故障，那么您所需要的只是一个故障。该错误可能包括客户端可以向其用户显示的消息文本。

如果客户端需要根据是 NullFault 还是 RangeFault 采取不同的操作，那么这就是您需要单独故障的时候。但是，如果一个和另一个之间没有区别，那么为您自己和客户端程序节省一些时间和精力，并且只定义一个故障。

# jquery - 拖出 html body/div/everything

> ID：818004
> 
> 赞同：0
> 
> 时间：2009-05-03T21:08:51.357
> 
> 标签：jquery, draggable, droppable

我让一类元素像这样可拖动

```
jQuery(".drag").draggable();

jQuery(".drop").droppable({
accept: ".drag",

drop: function(ev, ui) {
//do stuff with dropped data

    }
}); 
```

现在的问题是，我能够将元素从正文中拖出，并在整个 html 中。我如何限制可拖动的区域？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-03T21:13:42.140

[http://docs.jquery.com/UI/Draggable#option-containment](http://docs.jquery.com/UI/Draggable#option-containment)

将拖动限制在指定元素或区域的范围内。可能的字符串值：'parent'、'document'、'window'、[x1, y1, x2, y2]。

例子：

使用指定的包含选项初始化可拖动对象。

```
$('.selector').draggable({ containment: 'parent' }); 
```

**或者**如果问题是可拖动的可以放置在所有地方：

[http://docs.jquery.com/UI/Draggable#option-revert](http://docs.jquery.com/UI/Draggable#option-revert)

如果设置为 true，则元素将在拖动停止时返回其起始位置。可能的字符串值：“有效”、“无效”。如果设置为无效，则仅当可拖动对象未放置在可放置对象上时才会发生还原。对于有效，它是相反的方式。

**最后，我**没有看到您设置可拖动的范围*（**编辑**：但这不会解决您的问题，上面的其他两件事应该）*：

[http://docs.jquery.com/UI/Draggable#option-scope](http://docs.jquery.com/UI/Draggable#option-scope)

除了 droppable 的接受选项外，还用于对可拖动和可放置的项目集进行分组。与 droppable 具有相同范围值的可拖动对象将被 droppable 接受。

例子：

使用指定的范围选项初始化可拖动对象。

```
$('.selector').draggable({ scope: 'tasks' }); 
```

# twitter - 我怎样才能获得用户所做的所有 Twitter 更新？

> ID：818012
> 
> 赞同：2
> 
> 时间：2009-05-03T21:10:56.017
> 
> 标签：twitter

这实际上仅供我自己使用：我希望能够搜索我所有的更新，永远。Twitter 的搜索 ( [http://search.twitter.com](http://search.twitter.com) ) 是有时间限制的 - 它似乎只搜索最近几周的更新，因此很难找到我几个月前发布的内容。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-03T21:15:57.547

要从用户那里获取消息列表，您可以使用 Twitter API，但您需要用户和密码才能进行某些调用，例如您需要的调用：

最多 200 个示例：http: [//twitter.com/statuses/user_timeline.xml?count= 200](http://twitter.com/statuses/USERNAMEHERE_timeline.xml?count=200)

您可以使用其他参数，例如“since”或与 XML 不同的其他格式。[点击这里获取更多信息](http://apiwiki.twitter.com/Twitter-API-Documentation)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-06T11:36:53.373

首先，您必须有权查看用户帐户（否则您将永远无法获得用户的整个时间线）。有两种方法可以实现身份验证：您可以使用用户的凭据登录或获取 OAuth 身份验证令牌。OAuth 方法绝对是要走的路，几乎没有充分的理由使用实际凭据，并且用户厌倦了将他们的登录数据提供给随机应用程序。

获得 OAuth 令牌后，您可以调用 REST API 以获取用户的时间线

```
http://twitter.com/statuses/user_timeline.format 
```

其中*format*代表您的应用程序摘要的首选输出格式（现在支持 xml、json、rss 和 atom）。

除了明显的*user_id*参数外，*count*和*page*参数对您的目的也很重要。*count*允许您指定要返回的结果数（最多 200 个），而*page*是您要返回的页码。总而言之，您可以获得任何给定用户的最后 3200 次更新（对于*count* x *page*的任意组合）。

为避免不必要的爬取，您的应用程序应每天在后台多次联系 Twitter API 以了解当前状态。请注意，对 Twitter 服务器进行查询的频率存在每个用户的限制，因此必须在本地缓存状态消息。

仅在绝对必要时才使用搜索 API。对于您的情况，几乎可以肯定没有必要。

[您可以在此处](http://apiwiki.twitter.com/Twitter-REST-API-Method%3A-statuses-user_timeline)找到 statuses/user_timeline 调用的 API 文档。Abraham Williams 通过[github](http://github.com/abraham/twitteroauth/tree/master)提供了一个用于 OAuth/Twitter 的优秀 PHP 模块。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-08T19:31:29.590

这是一个技巧

```
http://twitter.com/statuses/user_timeline/username.xml?count=1000&since=0 
```

since 参数允许您覆盖默认的最大计数 :) 所以现在您无需遍历页面即可获得大量更新。

# python - C55：更多信息？

> ID：818016
> 
> 赞同：3
> 
> 时间：2009-05-03T21:11:43.940
> 
> 标签：python, css, reddit

我看到了 reddit 人员给出的 PyCon09 主题演讲（幻灯片：[http](http://www.slideshare.net/kn0thing/ride-the-snake-reddit-keynote-pycon-09?c55) ://www.slideshare.net/kn0thing/ride-the-snake-reddit-keynote-pycon-09?c55 ），其中他们提到了一个 CSS编译器称为 C55。他们说它将很快开源。它看起来很酷 - 有没有人有更多关于它是如何工作的信息，他们为什么创建它（除了 CSS 是一个痛苦的事实）等等......？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-03T22:14:50.713

Just from the talk, the main advantage over simply generating CSS from templates is that it allows nesting, which is conceptually a lot nicer to work with.

So you could do something like this in C55 (obviously I'm kind of making up the syntax):

```
div.content
{
  color: $content_color ;

  .left
  {
    float: left;
  };
  .right
  {
    float: right;
  };
}; 
```

# algorithm - 在“真实”世界中帮助/帮助您的 IT 概念

> ID：818026
> 
> 赞同：2
> 
> 时间：2009-05-03T21:15:00.937
> 
> 标签：algorithm

您在 IT 世界之外成功实施了哪个 IT 概念（例如编程）？

例如，

*   规范化数据库与组织我的项目有关。
*   了解信息和搜索引擎的真实规模迫使我停止积累数据（书籍、文章、图片）并改进我找到相关信息的方法。
*   决定何时编写脚本来执行重复性任务 --> 决定何时我花费大量时间手动处理我的沙拉......

我知道，编程毕竟是现实世界的反映。但是有些概念直到计算机以 10000000 倍的速度和更大的速度完成所有事情时才得到解决。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-03T22:19:14.353

Care about what you are doing and really understand what is going on at all levels, as much as possible.

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-03T21:18:26.373

过早的优化在现实生活中和在代码中一样糟糕。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-03T21:19:25.247

永远不要相信产品的一段摘要:-)

说真的，我认为事实调查技术和一般的 beta（精确）态度对日常生活有很大帮助。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-05-03T21:34:38.173

人们过期或明显错误的评论会在现实生活中误导你，就像他们在试图理解遗留代码时误导你一样。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-04T16:00:34.613

(1) 你永远不能只做一件事。

总是有副作用。您无法预料到所有这些，但无论如何您都必须处理它们。好处是其中一些会很有趣。

(2) 如果你碰它，它就拥有你。

不管它是什么——硬件、软件、电视、汽车——任何与它有关的问题都是最后接触它的人的责任。

(3) 边走边清理。

在编写代码时进行评论，在编写时记录检查，等等。如果等到它堆积起来，你会忘记其中的一些。

(4) 如果你至少有一半的时间没有被吓得屁滚尿流，那你就做错了。

-阿尔。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-05-03T21:21:31.810

除了数学家和自闭症青少年之外，没有人知道任何事情是如何真正起作用的。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-05-03T21:42:24.240

现实生活中的事实和事件“评论”和递归活动:-)

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-05-03T21:23:26.640

由于我是一名程序员，所以我也是家人和朋友的帮助台。有时我会收到礼物来解决他们的问题...

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2012-05-02T19:56:02.130

编写你的代码，就好像它被一个疲惫的 TA 标记一样：清晰而简单。因为从现在起的两到十二年，当你维护它时，你可能会感到疲倦。

# linq - 使用 SubSonic 获得单条记录的最快方法

> ID：818031
> 
> 赞同：0
> 
> 时间：2009-05-03T21:16:04.210
> 
> 标签：linq, subsonic, profiler, crud

我是 SubSonic 和 Linq Stuff 的新手，我正在尝试找出检索单个记录的最短和最佳方法。

还有什么其他方法比这更快并且需要更少的代码来获得一条记录？

```
User user2 = DB.Select().From(User.Schema)
.Where(User.PasswordColumn).IsEqualTo(password)
.And(User.SINumberColumn).IsEqualTo(siNumber)
.ExecuteSingle<User>(); 
```

我已经使用 AntsProfiler 工具进行检查，这需要平均 29.12 毫秒的 CPU 时间——经过十次运行测试

因为这需要更长的时间

```
UserController uc = new UserController();
Query query = new Query("User");
query.WHERE(User.Columns.Password, password);
query.WHERE(User.Columns.SINumber, siNumber);   
User user = uc.FetchByQuery(query).First<User>(); 
```

仅最后一行需要 256.08 毫秒 CPU 时间加上 UserController 需要 66.86 毫秒。

有什么建议么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-04T03:43:48.723

“瓶颈”将是生成的查询执行，而不是 SubSonic 生成它或返回结果。如果一个特定的查询很慢，你应该考虑使用你的数据库提供者的索引功能来优化它。

在第二种情况下，我假设额外的执行时间是 LINQ 从集合中返回第一项的开销。

所以我的回答是，第一种方法是最好的方法，如果 29 毫秒是不可接受的（对于调用数据库，我认为这不是不合理的），在你的数据库中添加一些索引以加快速度向上检索。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-04T14:04:27.937

IIRC，查询对象是流利的..即

```
query.WHERE(User.Columns.Password, password);
query.WHERE(User.Columns.SINumber, siNumber); 
```

应该读作：

```
query = query.WHERE(User.Columns.Password, password);
query = query.WHERE(User.Columns.SINumber, siNumber); 
```

测试中增加的时间可能是因为这个原因（你要求所有用户项目，然后抓住第一个）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-04T13:50:47.937

我认为约翰在金钱上是对的。如果您真的想测试 SubSonic 以查看需要多长时间，您需要测试 subsonic 创建 SQL 语句需要多长时间，而不是 SubSonic 创建 SQL 语句需要多长时间以及 DB 返回结果需要多长时间同时（你需要隔离你的测试）。

也许您应该测试使用常规旧 SQLCommand 获得结果需要多长时间，并将您的连接和参数传递给它，然后查看需要多长时间以便进行比较。

# c# - C#/.NET - 持续集成和 FTP 部署

> ID：818049
> 
> 赞同：6
> 
> 时间：2009-05-03T21:28:35.350
> 
> 标签：c#, .net, deployment, ftp, continuous-integration

注意：我是持续集成的新手

获得这些功能的“最佳”方法是什么：

1.  构建（程序集和 Web 应用程序）
2.  测试（MbUnit 或 NUnit）
3.  如果它通过测试，则通过 FTP 部署到主服务器（互联网）。

我所说的“最好”是最便宜的选择，而且容易学习（低头疼）。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2010-09-21T12:12:19.287

我使用 TeamCity 和 Web 部署项目在此处自动构建和部署（本地）编写了一篇非常详细的博客文章：

[http://www.diaryofaninja.com/blog/2010/05/09/automated-site-deployments-with-teamcity-deployment-projects-amp-svn](http://www.diaryofaninja.com/blog/2010/05/09/automated-site-deployments-with-teamcity-deployment-projects-amp-svn)

然后我添加到此以显示 FTP 添加

[http://www.diaryofaninja.com/blog/2010/09/21/continuous-integration-tip-1-ndash-ftp-deployment](http://www.diaryofaninja.com/blog/2010/09/21/continuous-integration-tip-1-ndash-ftp-deployment)

基本上流程是这样的：

*   使用我从我的 SVN 存储库下载的 teamcity 构建服务器
*   我构建站点并将其部署到构建服务器上的本地文件夹
*   [我使用 MSBUILD Task EXEC ( http://winscp.net/](http://winscp.net/) )启动了一个命令行 FTP 客户端，该客户端支持名为 WinSCP 的脚本
*   上传我的所有网站内容
*   有*插入选择的饮料*

然后，我确保我只部署我的 SVN 存储库的主干，并在合并之前开发和测试分支中的所有内容 - 这样只有经过测试的东西才会被部署。将自动化测试添加到您的构建周期中，您将获得天作之合。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-03T21:41:41.963

我会使用 msbuild 和 mbunit 进行单元测试。对于 FTP 部分，谷歌使用 FTP 进行 msbuild 自定义任务，你应该用煤气做饭。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-03T22:01:12.853

我曾经使用过[CruiseControl](http://confluence.public.thoughtworks.org/display/CCNET/Welcome+to+CruiseControl.NET)，它工作得很好，但我也听说过有关[TeamCity](http://www.jetbrains.com/teamcity/)的好消息。关于 MSBuild 的 FTP 任务（这绝对是您想要的方式），有一些可以在网上找到。当我上次检查时（不是最近），我发现所有的东西都有一个或另一个缺点，所以我最终自己编写了一个（将 FtpWebRequest 包装在 .NET 中）。虽然这可能不是最好的 FTP 实现，但该任务提供了我需要的功能（上传目录结构、远程删除）。我想今天可能有提供该功能的任务（否则我应该只发布我的......）

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-04T20:18:45.400

我们对Hericus Software的[Zed Builds and Bugs Manager做同样的事情。](http://www.hericus.com/)

我们必须将 .Net 程序集与 C++ dll 结合起来，并将整个东西打包成一个 Java 安装（想象一下那种混乱 :-)）。我们还使用 FTP 将构建的一些组件（不是全部）上传到需要构建生成的部分的其他系统。

在所有东西都整合在一起之后，Zed 服务器的好处是它成为了我们的系统，每个人都知道从哪里获取他们的工件。它处理从 Dev 到 QA 再到生产的升级，并在整个生命周期中跟踪构建。

# asp.net - DropDownList绑定问题

> ID：818050
> 
> 赞同：0
> 
> 时间：2009-05-03T21:29:27.953
> 
> 标签：asp.net, vb.net

我有两个 DropDownListBoxes，一个叫 ddlDay，另一个叫 ddlMonth。顾名思义，ddlDay 的值从 01 到 31（非动态），ddlMonth 的值从 01 到 12。这些值不是动态设置的。

当页面加载时，我从数据库中获取值。根据值，我正在使用`ddlDay.SelectedItem.Value = the value from the db to set`该值并选择项目。

我在下面提供的代码是用`If Not Page.IsPostback Then...`语句测试的，没有任何运气。

但是，当页面第一次加载时，什么也没有发生。但是如果我刷新页面并因此导致回发，那么这些值就会正确绑定。

```
 Protected Sub Page_Load(ByVal sender As Object, ByVal e As System.EventArgs) Handles Me.Load
        loadInterview()
    End Sub

Private Sub loadInterview()
    If Request.QueryString("iID") = "" Or Request.QueryString("iID") Is Nothing Then
        Response.Redirect("interviews_list.aspx")
    Else
        Dim int As New hh.Interviews
        int = hh.Interviews.ReturnSingleInterview(Request.QueryString("iID"))

        ddlDay.SelectedItem.Value = int.InterviewDate.Day.ToString("00")
        ddlMonth.SelectedItem.Value = int.InterviewDate.Month.ToString("00")
        txtYear.Text = int.InterviewDate.Year

        txtPerson.Text = int.InterviewPerson
        txtTitle.Text = int.InterviewTitle
        txtText.Text = int.InterviewText

    End If 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-03T21:35:45.580

试试这个来设置初始值：

```
ddlDay.ClearSelection()
ddlDay.Items.FindByValue(int.InterviewDate.Day.ToString("00")).Selected = True

ddlMonth.ClearSelection()
ddlMonth.Items.FindByValue(int.InterviewDate.Month.ToString("00")).Selected = True 
```

**注意：** ClearSelection 方法通过“不能在 DropDownList 中选择多个项目”来避免 HttpException 异常。信息。

**编辑 2：**假设你有这个下拉列表：

```
<asp:DropDownList ID="ddlItems" runat="server">
    <asp:ListItem Text="Item 1" Value="Item 1"></asp:ListItem>
    <asp:ListItem Text="Item 2" Value="Item 2" Selected="true"></asp:ListItem>
    <asp:ListItem Text="Item 3" Value="Item 3"></asp:ListItem>
</asp:DropDownList> 
```

如果您将“项目 1”设置为您的 ddlItems.SelectedItem.Value 像这样：

```
ddlItems.SelectedItem.Value = "Item 1" 
```

你的下拉列表变成这样：

```
<asp:DropDownList ID="ddlItems" runat="server">
    <asp:ListItem Text="Item 1" Value="Item 1"></asp:ListItem>
    <asp:ListItem Text="Item 2" Value="Item 1" Selected="true"></asp:ListItem>
    <asp:ListItem Text="Item 3" Value="Item 3"></asp:ListItem>
</asp:DropDownList> 
```

我的意思是 ddlItems.SelectedItem 是指您的下拉列表中的选定项目。

# php - 如何从防火墙严密的网络使用 PHP 发送电子邮件？

> ID：818058
> 
> 赞同：0
> 
> 时间：2009-05-03T21:35:21.090
> 
> 标签：php, email, smtp, firewall, mail-server

我希望从我的 localhost 机器发送一封电子邮件（使用 PHP 邮件功能），但我不能这样做，因为我没有邮件服务器。此外，我需要能够通过防火墙严密的网络发送电子邮件（我还不知道到什么程度）。

我的想法是利用“QK SMTP Server 3”并让它使用我拥有的外部服务器作为“中继服务器”。这行得通吗？有更简单的选择吗？

如果我的方法没问题。我想知道如何在我的服务器上打开端口 25，以便它可以接收此请求。通过执行此命令，我得到：

```
[root@balder296 ~]# service iptables status
Firewall is stopped.
[root@balder296 ~]# 
```

感谢您的任何帮助和建议。

## 解决了

Hotmail（令人惊讶）提供免费的中继服务。我希望这在我测试时对我有用！但是外部邮件服务器是要走的路。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-03T22:59:53.227

确定您是否可以通过端口 25 (SMTP) 连接到 Internet

*   `telnet gmail-smtp-in.l.google.com 25`（这是 Gmail 服务器之一）

如果您能够打开连接，您可以简单地安装一个邮件服务器并使用 mail() 函数发送消息。

*   `yum install postfix`（例如，根据您的“服务”评论，我假设您正在运行 Redhat 或 Centos）

如果您无法通过端口 25 连接到 Internet 邮件服务器，您可以尝试查找内部邮件中继（这取决于您的网络，您必须自己查找）。

那时你有两个选择。如果您在邮件服务器（/etc/postfix，如果您使用 Postfix）中定义了 'relay' 参数，则可以在本地邮件服务器中使用内部 mail() 函数。

另一种选择是遵循[本指南](http://www.dreamincode.net/forums/showtopic36108.htm)并让 PHP 将消息发送到内部中继。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-03T22:32:21.373

也许有一个（好的？）原因可以解释为什么您所在的网络受到严格的防火墙保护。

你为什么不问网络上的人发送邮件的好方法是什么？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-03T22:35:40.663

如果您有 Google Mail 帐户，则可以使用它通过[Swift Mailer](http://swiftmailer.org/wikidocs/v3/connections/smtp)发送电子邮件。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-03T22:50:43.310

您需要在防火墙后面运行邮件服务器的机器。最好这应该是它应该用于的全部。虽然它后面的所有其他东西都应该被阻止打开端口 25 上的传出连接，但这个应该被阻止。让运行应用程序的机器上的邮件服务器通过该机器进行中继。我在一家托管公司工作，这就是我们使用共享托管服务器所做的事情。通过这种方式，您可以跟踪任何外发邮件，以确保防火墙后面没有人在做任何不正当的事情。

如果你问得好，你是友好的邻居系统管理员几乎肯定会设置这个。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-03T23:11:10.500

如果这将用于公共应用程序，请记住，即使您可以获得 SMTP 出站访问权限，您也可能会遇到问题。反垃圾邮件保护对网络行为变得相当挑剔。例如，网络上有一个有效的 SMTP 服务器，而您设置了另一个服务器，如果它们看起来具有来自网络外部的相同 IP 地址，则可能会给两台服务器带来麻烦。一些主要的黑名单会自动阻止似乎有多个服务器的地址。

如果你试图绕过网络管理员，充其量你可能有一个脆弱的系统。根据您的网络规则/设置，您可能能够设置您的 SMTP 服务器包以将消息从网络上的另一台电子邮件服务器中继。这应该需要与网络或电子邮件管理员合作。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-04T01:26:33.327

我过去使用过 SwiftMailer，然后设置了一个通用的 gmail 帐户来发送邮件。我发现的一件事是，最好将发件人地址保留为您设置的 gmail 帐户，否则垃圾邮件过滤器往往会破坏电子邮件。

# asp.net - 单击后退按钮强制刷新页面

> ID：818060
> 
> 赞同：7
> 
> 时间：2009-05-03T21:36:05.003
> 
> 标签：asp.net, javascript, ajax, browser

我有2个asp.net页面..页面A和页面B。单击页面A上的链接时，用户被重定向到页面B。当在页面B上时，如果用户单击浏览器的后退按钮，我需要强制调用页面刷新页面 A. 如何实现此功能？注意：代码需要跨不同浏览器兼容...即IE、firefox、opera等

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-03T22:14:32.760

There is some button property like Autopostback, you can try it and see if ti helps!

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2011-01-03T20:42:57.580

我认为 Javascript 无法判断它是第一次访问还是来自后退按钮。因此，我将需要更新的页面部分放在 UpdatePanel 中，然后执行 JavaScript 以在每次页面加载时始终刷新这些部分。不是很优雅，但它解决了我的问题。

```
function addLoad(fn) {
    if (window.addEventListener) {
        window.addEventListener("load", fn, false); 
        return true; 
    } else if (window.attachEvent) {
        var r = window.attachEvent("onload", fn); 
        return r;
    } else {
        return false; 
    } 
}
function refreshBack()
{
    __doPostBack("<%= updatePanel1.ClientID %>", "");
    __doPostBack("<%= updatePanel2.ClientID %>", "");
}
addLoad(refreshBack); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-03T21:45:27.010

您可以在页面 B 上设置一个会话变量并检查该会话变量是否存在于页面 A 上并相应地处理它。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-03T21:48:26.130

我想说最好的方法是告诉浏览器不要缓存页面。

```
<%    Page.Response.Expires = 0;   %> 
```

如果这不能满足您的需求，您需要 javascript 来强制刷新。

伪代码：

```
if (cookie does not exist)
  set cookie with 10 second expiration
else if cookie exists {
  is cookie expired? {
     set new cookie
     refresh page
   }
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-11-14T15:43:38.667

```
 function SetCookie (name, value) {
var argv=SetCookie.arguments;
 var argc=SetCookie.arguments.length;
 var expires=(argc > 2) ? argv[2] : null;
 var path=(argc > 3) ? argv[3] : null;
var domain=(argc > 4) ? argv[4] : null;
var secure=(argc > 5) ? argv[5] : false;
document.cookie=name+"="+escape(value)+
((expires==null) ? "" : ("; expires="+expires.toGMTString()))+
((path==null) ? "" : ("; path="+path))+
((domain==null) ? "" : ("; domain="+domain))+
((secure==true) ? "; secure" : "");
 }

 function getCookie(c_name)
{
var c_value = document.cookie;
var c_start = c_value.indexOf(" " + c_name + "=");
if (c_start == -1)
{
    c_start = c_value.indexOf(c_name + "=");
}
if (c_start == -1)
{
    c_value = null;
}
else
{
    c_start = c_value.indexOf("=", c_start) + 1;
    var c_end = c_value.indexOf(";", c_start);
    if (c_end == -1)
    {
        c_end = c_value.length;
    }
    c_value = unescape(c_value.substring(c_start,c_end));
}
return c_value;
  }   

if (getCookie('first_load'))        
{
  if (getCookie('first_load')==true)
 {
    window.location.reload(true); // force refresh page-liste
    SetCookie("first_load",false);
}
}
SetCookie("first_load",true); 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2019-04-10T01:46:15.350

你可以尝试这样做

```
protected override void OnInit(EventArgs e)
{
    //Refresh page on back button
    Response.Cache.SetCacheability(HttpCacheability.NoCache);
    Response.Cache.SetNoStore();
    Response.Cache.SetExpires(DateTime.MinValue);
    base.OnInit(e);
} 
```

# ruby-on-rails - Rails - 常量哈希？

> ID：818062
> 
> 赞同：12
> 
> 时间：2009-05-03T21:37:22.987
> 
> 标签：ruby-on-rails, ruby

我的应用程序需要一个模型（？），它基本上包含另一个实体的状态。在我想存储状态的 id 的实体中，但在我的应用程序中，视图是在用一个漂亮的单词描述来说话。例如，1 = 新，2 = 二手等。

我怎样才能以最好的方式实现这一点，这意味着我可以轻松设置和检索此状态列而无需重复自己？

最终我想要类似的东西

```
Foo.status = 'New'  (actually sets value to 1) 
```

和

```
Foo.status  (returns 'New', but stores 1) 
```

我是否以正确的方式思考这个问题？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-05-03T21:52:49.190

您可以编写自定义编写器方法：

```
STATUS_VALUES = { 1 => 'new', 2 => 'modified', 3 => 'deleted' }

class Foo
  attr_reader :status_id

  def status
    STATUS_VALUES[@status_id]
  end

  def status=(new_value)
    @status_id = STATUS_VALUES.invert[new_value]
    new_value
  end
end 
```

例如，以下程序：

```
foo_1 = Foo.new

foo_1.status = 'new'
puts "status: #{foo_1.status}"
puts "status_id: #{foo_1.status_id}"

foo_1.status = 'deleted'
puts "status: #{foo_1.status}"
puts "status_id: #{foo_1.status_id}" 
```

输出：

```
status: new
status_id: 1
status: deleted
status_id: 3 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-04T00:44:59.840

我会继续使用符号，比如

```
Foo.status = :new 
```

它们基本上是不可变的字符串，这意味着无论您在代码中使用多少次相同的符号，它仍然是内存中的一个对象：

```
>> :new.object_id
=> 33538
>> :new.object_id
=> 33538
>> "new".object_id
=> 9035250
>> "new".object_id
=> 9029510 # <- Different object_id 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-03T22:05:09.833

一种方法是使用常量

```
module MyConstants
  New  = 1
  Used = 2
end 
```

然后你可以像这样使用它们

```
Foo.status = MyConstants::New 
```

如果你对命名空间污染很小心，甚至像这样

```
include MyConstants
Foo.status = New 
```

换个想法，也许你想使用[状态机](http://github.com/pluginaweek/state_machine/tree/master)。

# php - 为什么 Google OpenID 提供程序不能在我的服务器上使用 PHP-OpenId？

> ID：818063
> 
> 赞同：0
> 
> 时间：2009-05-03T21:37:37.607
> 
> 标签：php, openid

我使用的是[PHP-OpenId](http://www.openidenabled.com/php-openid/) 2.1.3，我在我的服务器上解压缩了它[（](http://endesha.com/openid/php-openid-2.1.3/examples/consumer)这是 PHP-OpenId 附带的消费者示例）。当我输入 Google OpenId url ( [https://www.google.com/accounts/o8/id](https://www.google.com/accounts/o8/id) ) 并提交时，我得到一个空白屏幕。

当我在 PHP-OpenId 网站上使用相同的 URL尝试完全相同的示例代码时，[它可以正常工作。](http://openidenabled.com/php-openid/trunk/examples/consumer/)

我不明白我做错了什么。我能想到的唯一一件事是谷歌不想与我的服务器一起工作。

任何想法如何使这项工作？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-20T19:42:01.803

如果它对 Google 和 Yahoo 无效，但对某些其他提供商有效，则可能是用于发出 HTTPS 请求的设置在您的 PHP 服务器上被破坏了。检查以确保您已安装 ca-certificates 软件包。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-21T22:21:10.293

ketrun 是对的，我遇到了类似的问题。在我安装了ca-certificates包之后，一切都很好，但是当https请求出现问题时，PHP Openid返回错误（无效的openid），而不是空白屏幕。

请务必检查示例目录中的 detect.php 文件和 discover.php 以检查您的 OpenID URL。

# java - jstl/jsp - 遍历 bean 的向量

> ID：818072
> 
> 赞同：0
> 
> 时间：2009-05-03T21:41:45.130
> 
> 标签：java, jsp, jstl

我有一个包含我想在我的 jsp 页面中显示的信息的 bean 向量。我目前只是使用标准的 java 表达式来显示这个，我想研究使用 jstl 来分离关注点。这可能吗，怎么做？我一直在谷歌搜索，但我似乎找不到任何东西。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-03T21:51:00.180

我认为您正在寻找的是***< c:foreach >***标签。

例如，在 MyClass 的实例上打印值 myInt 属性（定义如下）：

```
<c:foreach items="${vectors name}" var="pos" >
       <!-- print the value of myInt for each position of the array. 
            Method getMyInt() must exist in pos object.-->
       <c:out value="${pos.myInt}"/>

       <!-- print the value of myInt for each composed instance.
            Method getRelatedInstance() must exist in pos object.  -->
       <c:out value="${pos.relatedInstance.myInt}"/>
</c:foreach> 
```

其中*向量名称*是向量的名称，例如，在执行

假设你有一个类 myClass。

```
public class MyClass{
   private MyClass relatedInstance;     
   //some members and methods

   public int getMyInt(){
     //return something
   }

   public MyClass getRelatedInstance(){
     return this.relatedInstance;
}

List<myClass> my_vector = getFilledList();
request.setAttribute("vectors name",my_vector) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-03T21:57:03.127

为了扩展 Tom 的示例，这里有一些更具体的内容：

```
<c:foreach items="${myList}" var="myItem">
  <c:out value="${myItem.someProperty}"/>
</c:foreach> 
```

其中“myList”是包含您的向量的请求属性。

一个常见的错误是忘记了 ${myList} 周围的 ${} - 如果这样做，JSTL 不会抛出错误，它只会为您生成一个包含单个项目的列表，即字符串“myList”。

# c# - .NET 单选按钮“内容”设计

> ID：818073
> 
> 赞同：0
> 
> 时间：2009-05-03T21:41:49.047
> 
> 标签：c#, .net, winforms, radio-button

我正在尝试确定使用 Windows Forms .NET (C#) 让单选按钮在面板（或另一个容器）的内容周围切换的最佳方式，并保持在表单/用户控件上使用 Visual Studio 设计器的能力包含这些。

我真正想要的是 TabControl 之类的东西，我可以在其中根据选中的单选按钮以编程方式选择页面，但不显示实际的选项卡。我不只是使用选项卡控件的原因是使用当前选定的选项卡作为输入值似乎是错误的。

显而易见的解决方案是简单地为每个单选按钮设置一个面板，并使用可见性等来切换它们——但这在 Visual Studio 设计器中使用起来很烦人，因为这些面板要么隐藏在彼此下方，要么不在正确的位置位置（如果一次只能显示一个面板，则整体表格的尺寸不合适。）

我似乎记得 Delphi 有一个 PageControl 或类似的东西，它基本上是一个没有选项卡标题的选项卡控件。

在我看来，这是一种经常出现的情况，所以我很好奇：你会如何设置这样的东西？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-03T22:12:03.093

我总是使用可见性功能。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-03T21:55:14.693

我想我会简单地构建这样一个页面控件。不能太难，我猜（即使设计时支持往往比你有时希望的要复杂一点......）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-04T01:43:18.950

您可以将每个面板设计为用户控件。这会给你设计时的灵活性。然后，就像其他人所说的那样，在以编程方式操作它们时使用可见性。

# database - 只读数据库访问的事务？

> ID：818074
> 
> 赞同：61
> 
> 时间：2009-05-03T21:42:00.077
> 
> 标签：database, transactions, data-access

关于使用事务从数据库中读取似乎有非常不同的意见。

引自 DeveloperWorks 文章[交易策略：模型和策略概述](http://www.ibm.com/developerworks/java/library/j-ts2.html?ca=drs-)：

> 如果您只读取数据，为什么需要事务？答案是你没有。启动事务以执行只读操作会增加处理线程的开销，并可能导致数据库上的共享读锁（取决于您使用的数据库类型和隔离级别设置）。

作为相反的意见，以下引用来自 Hibernate 文档[非事务性数据访问和自动提交模式](https://www.hibernate.org/403.html)

> 我们的建议是不要在应用程序中使用自动提交模式，并且仅在有明显性能优势或未来代码更改极不可能时才应用只读事务。无论您是读取还是写入数据，始终更喜欢使用常规 ACID 事务来对数据访问操作进行分组。

在 EclipseLink 邮件列表上也有类似的[争论](http://dev.eclipse.org/newslists/news.eclipse.rt.eclipselink/msg00087.html)。

那么真相在哪里呢？用于阅读最佳实践的交易是否是最佳实践？如果两者都是可行的解决方案，那么使用事务的标准是什么？

据我所知，只有在隔离级别高于“已提交读”时才会有所不同。它是否正确？

有哪些经验和建议？

* * *

## 回答 #1

> 赞同：29
> 
> 时间：2009-05-03T22:08:11.557

Steven Devijver 提供了一些启动事务的充分理由，即使这些操作只是读取数据库：

*   设置超时或锁定模式
*   设置隔离级别

标准 SQL 要求，如果当前没有正在进行的事务，则即使是查询也必须启动新事务。有些 DBMS 不会发生这种情况——例如，那些具有自动提交模式的 DBMS（语句启动事务并在语句完成后立即提交）。其他 DBMS 默认情况下使语句原子化（有效地自动提交），但使用诸如“BEGIN WORK”之类的语句启动显式事务，取消自动提交直到下一次 COMMIT 或 ROLLBACK（IBM Informix Dynamic Server 就是这样 - 当数据库不是 MODE 时ANSI）。

我不确定永远不要回滚的建议。它对只读事务没有影响，并且在某种程度上它会惹恼您的 DBA，那么最好避免 ROLLBACK。但是，如果您的程序在没有执行 COMMIT 的情况下退出，DBMS 应该对您不完整的事务执行 ROLLBACK - 当然如果它修改了数据库，并且（为简单起见）即使您只选择了数据。

总的来说，如果要更改一系列操作的默认行为，请使用事务，即使事务是只读的。如果您对默认行为感到满意，那么使用事务并不重要。如果您的代码要在 DBMS 之间移植，最好假设您需要一个事务。

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2009-05-03T22:32:12.873

首先，这听起来像是过早的优化。正如 Steven 所指出的，大多数健全的数据库无论如何都会让你进入一个事务，而他们真正做的只是在每个语句之后调用 commit。所以从这个角度来看，自动提交的性能可能会降低，因为每个语句都必须启动一个新事务。或者可能不是。只有基准测试才能说明问题，我敢打赌它不会对您的应用程序产生任何影响。

您希望始终使用事务的一个原因是保护的一致性。如果您仅在“需要”时才开始手动声明事务，那么您将在关键时刻忘记。或者那组所谓的只读操作突然不是，要么是因为后来的程序员没有意识到它应该是，要么是因为你的代码调用了一个具有隐藏写入的函数。例如，我将命令行数据库客户端配置为不自动提交。这意味着我可以用手指删除查询并且仍然回滚。

正如所指出的，存在隔离级别。这使您可以进行多次读取，而不必担心是否有其他进程在它们之间写入了您的数据，从而使您的读取有效地原子化。这将使您免于调试竞争条件的许多小时。

最后，您通常可以将事务设置为只读。这会检查您的假设，如果尝试写入，则会出错。

[这是一篇很好的文章，总结了这一切。](https://blogs.oracle.com/oraclemagazine/on-transaction-isolation-levels) 细节是特定于 Oracle 的，但概念是通用的。

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2009-05-03T21:53:46.083

如果要为查询设置特定超时而不是默认超时，或者要更改隔离级别，则只读操作需要事务。

此外，每个数据库——不知道异常——都会在内部为每个查询启动一个事务。当不需要回滚时，通常认为不回滚事务。

DBA 可能正在监视回滚活动，在这种情况下，任何默认的回滚行为都会惹恼他们。

因此，无论您是否启动事务，都将使用事务。如果您不需要它们，请不要启动它们，但不要对只读操作进行回滚。

# flash - 在 Flash 中使用外部接口

> ID：818089
> 
> 赞同：4
> 
> 时间：2009-05-03T21:48:34.270
> 
> 标签：flash, actionscript, externalinterface

我正在尝试编辑一些 Flash 以进行外部 javascript 函数调用，但没有成功。这是我的动作脚本 2.0 代码：

```
//testing external .js calls

import flash.external.ExternalInterface;

//attempting to make external js call

ExternalInterface.call("createPlaylist","It's my Life!"); 
```

这是我的javascript；

```
function createPlaylist(mess){
  alert("called createPlaylist: " + mess);
} 
```

我看过很多例子，主要是对 `ExternalInterface.addCallback`. 我不需要 javascript 来返回任何东西到 flash，所以这是必要的吗？

无论出于何种原因，我从来没有看到警报。有人在我的代码中看到任何问题吗？有`ExternalInterface`没有我没有的图书馆？另外，最好的使用方法是什么`ExternalInterface`（即错误检查等）在此先感谢...

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-05-04T10:20:12.187

ExternalInterface.addCallback 是为了让 javascript 能够调用您的 Flash 应用程序。例如，如果您想要一个开始/停止视频的 HTML 按钮，您只需为命名方法添加回调，然后您的 js 就可以调用 [FlashObject].callback 方法名称。

我想说，在应用程序中添加 ExternalInterface 方法的最佳方法是为应用程序中的每个交互案例设置一个负责 JS 通信的类。例如：

```
public class ExternalVideoControl {

    private var video:MediaDisplay;

    public function ExternalVideoControl(video:MediaDisplay) {
        //ExternalInterface.addCallback  - one callback for each method you want to expose, pointing to a method within this class;
        //add listeners on the video player and point them to methods in this class, for example onProgress
    }
    public function playVideo():void {
        //play the video on the mediaDisplay
    }
    private function onProgress(event:ProgressEvent):void {
        //ExternalInterface.call - report progress back to javascript
    }
} 
```

要更直接地测试 ExternalInterface，请尝试调用

```
ExternalInterface.call("alert", "Hello World!"); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-08T15:50:26.377

正如其他人在对 Johan 的帖子的评论中所说的那样，您应该首先通过检查 ExternalInterface.available 来检查外部接口是否可用。

除此之外...您如何启动 Flex 应用程序？首先，它当然必须包含在包含此 JavaScript 的包装器中。那是微不足道的。但是，如果您从本地文件系统将其作为文件启动（浏览器 URL 以 file:// 开头），那么您还必须确保 SWF 文件具有运行 JavaScript 函数所需的权限。

您必须信任 SWF 文件才能使其能够访问本地资源，如文件或本地文件上的 JS。为此，请创建一个类似 myapp.cfg 的文件，并将文件的路径作为一行添加到该行。将此文件放在 FlashPLayerTrust 文件夹中。在 Linux 系统上，这是 ~/.macromedia/Flash_Player/#Security/FlashPlayerTrust/。

# asp.net - GridView + ObjectDataSource 问题 - 大型和小型结果集的性能同样糟糕

> ID：818091
> 
> 赞同：0
> 
> 时间：2009-05-03T21:49:02.820
> 
> 标签：asp.net, sql, performance, gridview

我最近被要求开发一个较旧的 .NET 旧版 Web 应用程序。由于系统中的数据量翻了两番，性能最近下降得相当低。前2年一直很好。

它使用 .xsd 文件与存储过程通信，该存储过程充分缩小了结果范围（尽管没有分页），并通过 ObjectDataSource 将它们输入到 GridView 中。

***我无法理解的部分***是，加载 1 个结果、140 或 1200 需要大约 7 秒。0 个结果案例需要一瞬间。（GridView 正在处理分页）

使用 SQL 分析器，我们可以看到查询花费了 6.9 秒。在 SQL Management Studio 中使用相同的参数运行相同的查询需要 100 毫秒。我改变了参数以确保它不仅仅是一个缓存的结果。漫长的等待时间是可靠地重现的。

我知道[实现分页](http://weblogs.asp.net/scottgu/archive/2006/01/07/434787.aspx)需要在这里完成，但现在我只是回顾性地试图找到一个解释为什么页面在小型和大型集合中表现*同样糟糕......*

（GridView 的“简单”显示可以满足他们的需求 - 无需控制 HTML）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-04T09:42:54.087

我们有同样的问题：

1.  检查您的统计数据是否是最新的：

```
    选择
        ObjectName = Object_Name(ind.object_id),
        IndexName = ind.name,
        StatisticsDate = STATS_DATE(ind.object_id, ind.index_id)
    FROM SYS.INDEXES ind
    按 STATS_DATE(ind.object_id, ind.index_id) desc 排序

```

2.  删除 SQL 服务器缓存：

```
    DBCC 删除缓冲区
    DBCC FREEPROCCACHE

```

3.  如果两者都没有帮助，您可以尝试使用“inner LOOP join”和“with (index=...)”等提示来强制执行 SSMS 查询计划。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-03T22:11:55.527

您可以尝试查看从您的应用程序发送的执行计划和参数类型。例如，如果您的应用程序传递一个 nvarchar 以与 varchar 列进行比较，则可能会导致问题。 [http://weblogs.sqlteam.com/tarad/archive/2007/11/16/60408.aspx](http://weblogs.sqlteam.com/tarad/archive/2007/11/16/60408.aspx)

# c# - 受按钮影响的按键事件

> ID：818092
> 
> 赞同：4
> 
> 时间：2009-05-03T21:49:11.353
> 
> 标签：c#, events, focus, onkeypress

我是新来的，我在使用 C# 应用程序时遇到了一些问题。我想捕获按键按下事件。起初这不是问题，但在我向表单添加一些按钮后，表单的按键事件会忽略箭头键并将焦点从一个按钮移动到下一个按钮。（按键事件有效）是否有当我按住箭头键时，如何阻止这种情况并让他们做其他事情？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-03T21:52:46.040

~~将 Form 上的[KeyPreview](http://msdn.microsoft.com/en-us/library/system.windows.forms.form.keypreview.aspx)属性设置为 true。除了子控件之外，这将允许表单查看 keydown 事件。~~

将此添加到您的表单...

```
protected override bool ProcessCmdKey(ref Message msg, Keys keyData)
{
    if (keyData.Equals(Keys.Right))
    {
        MessageBox.Show("Right Key Pressed!");
    }

    return base.ProcessCmdKey(ref msg, keyData);
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-03T22:03:35.640

如果您不希望控件具有正常的按键功能，则需要在每个控件上设置按键事件，并将事件参数的处理属性设置为 true，这样它就不会冒泡到内置控制功能。

# iphone - UITableView - 添加单元格

> ID：818097
> 
> 赞同：2
> 
> 时间：2009-05-03T21:53:08.597
> 
> 标签：iphone, objective-c, cocoa, cocoa-touch

我在 TabBarController 中有一个 UITableViews，其中填充了单独的数据数组。由于网络同步，此数组更新，我想更新表。

来电：

```
[self.tableView reloadData] 
```

将重新加载现有单元格中的内容，但我需要为新数据添加单元格。好像这个方法没有调用

```
-tableView:tableView numberOfRowsInSection:section 
```

再次，这是我动态指定行数的地方。有任何想法吗？我已经阅读了我能找到的所有文档，但没有抓住任何东西。这是应用程序设计问题吗？

谢谢！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-04T13:49:55.583

看看 UITableView 中的这些函数：

```
-(void)insertSections:(NSIndexSet *)sections withRowAnimation:(UITableViewRowAnimation)animation
-(void)insertRowsAtIndexPaths:(NSArray *)indexPaths withRowAnimation:(UITableViewRowAnimation)animation 
```

# sql - 使用 Min() SQL 使用多个表、多个值

> ID：818099
> 
> 赞同：0
> 
> 时间：2009-05-03T21:53:39.923
> 
> 标签：sql, iphone, sqlite

我正在开发的应用程序中使用 SQLite。
我正在尝试运行一个非常复杂的查询（对我来说很复杂！）并且我已经得到了我需要的基本结果，但我一直坚持克服最后一个障碍。

我目前有这个查询可以完成我需要它做的事情......

```
SELECT SUM(activity)
FROM activities
WHERE activity_id IN(SELECT name_id FROM foods GROUP BY name_id HAVING SUM(points) > 20); 
```

我需要在这个查询中添加另一部分，但这对我来说有点复杂。有三个表....日期，食物，活动，我需要找到一个结果集的总和，该结果集包含来自两个不同表的两个值之间的最小数字，只要某个陈述为真。

基本上..

```
SELECT SUM(total) FROM (SELECT MIN(value from table1 which is determined by a value in table2, value from table3) AS total
FROM table3
WHERE value from table3 is contained in a result set from table1); 
```

如果没有任何语法，下面的查询是我想出来的（哈哈！）。这不起作用，但我只是想展示它以更好地理解我正在尝试做的事情。

```
SELECT SUM(activity_amount) FROM (SELECT min((SELECT SUM(points) - 20 FROM foods WHERE name_id IN(SELECT pk FROM dates WHERE weekly=1) GROUP BY name_id), activity) AS activity_amount
FROM activities
WHERE activity_id IN(SELECT name_id FROM foods GROUP BY name_id HAVING SUM(points) > 20)); 
```

问题在于...中的第一个值`MIN()`。

```
SELECT SUM(points) - 20 FROM food WHERE name_id IN(SELECT pk FROM dates WHERE weekly=1) GROUP BY name_id 
```

该语句产生多个值，但即使我确实需要将这些值与 中的其他值进行比较`MIN()`，我一次只需要一个......而不是作为一个整体。

我怎样才能得到类似于我创建的上述查询的东西？

编辑...一些示例表以提供更好的帮助。感谢 jellomonkey 和 hainstech

```
Table#1(dates)  

CREATE TABLE dates (pk INTEGER PRIMARY KEY, date INTEGER, weekly INTEGER)
pk  date       weekly
1   05062009    1  
2   05072009    1  
3   05082009    2 

Table #2(foods)  

CREATE TABLE foods (pk INTEGER PRIMARY KEY, food VARCHAR(64), points DOUBLE, name_id INTEGER)
pk   food   points   name_id  
 1   food1    12.0     1  
 2   food2    9.0      1  
 3   food3    5.0      1  
 4   food4    15.0     2
 5   food5    14.0     2  
 6   food6    12.0     3  

Table#3(activities)  

CREATE TABLE activities (pk INTEGER PRIMARY KEY, activity DOUBLE, activity_id INTEGER)
pk   activity   activity_id
 1     5.0           1  
 2     4.0           1  
 3     2.0           2  
 4     4.0           3 
```

通过我原始帖子中的这个前和查询（一个不起作用的），我将寻找一个包含一个值的结果集..8.0

最小值(26.0-20, 9.0) = 6.0
最小值(29.0-20, 2.0) = 2.0
6.0 + 2.0 = 8.0

我希望这有帮助！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-04T01:09:20.640

经过多次头疼和占卜后，我怀疑您想要的可能是：

```
SELECT SUM(MIN(fp-20, ap)) FROM
  (SELECT dates.pk AS fd, SUM(points) AS fp
  FROM dates
  JOIN foods ON name_id = fd
  GROUP BY fd
  HAVING fp >= 20)
    JOIN
  (SELECT dates.pk AS ad, SUM(activity) AS ap
  FROM dates
  JOIN activities ON activity_id = ad
  GROUP BY ad)
    ON fd = ad 
```

列名似乎与它们的含义零关联，但是，嘿，至少这确实给出了 8.0，而子选择给出了你提到的其他数字！-)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-03T22:38:59.220

同意 jellomonkey - 除非您显示更多信息，否则我无法确切了解您想要什么。简单的表定义、几行示例数据和预期的输出会有所帮助。

这是一个简单的示例，用于根据范围在其他两个表中定义的范围从表中获取最小值：

```
create table t1(t1id int primary key, value int)
create table t2(t1id int, t2id int primary key, value int)
create table t3(t2id int, t3id int primary key, value int)

select
    MIN(t1.value)
from table1 as t1 
    join table2 as t2 on t2.t1id = t1.t1id
    join table3 as t3 on t3.t2id = t2.t2id
where t1.value between t2.value and t3.value 
```

这使用 t2.value 和 t3.value 作为范围的边界来找到 MIN() 。

编辑 - 感谢您发布示例表，这有很大帮助。您可以使用一些复杂的 CASE 语句来比较这两个值，但我会将它们放入一个行集中并进行正常的 MIN 聚合。这将更具可读性，并且如果需要，您还可以更轻松地添加一组附加信息以包含在您的 MIN 输入中。所以这里是我会做的快速打击：

```
select
    SUM(activity)
from (
    select
        min(activity) as activity
        ,activity_id
    from (
        select
            SUM(activity) as activity, activity_id
        from activities 
        group by activity_id
        union all
        select
            SUM(points)-20
            ,name_id
        from foods 
        group by name_id
        having SUM(points) > 20
    ) as activitySum
    where activity_id in (select pk from dates where weekly=1)
    group by activity_id
) as activityLesserOf 
```

编辑#2 - 根据需求说明在上述查询中添加了 HAVING

# iphone - 立即执行方法

> ID：818108
> 
> 赞同：3
> 
> 时间：2009-05-03T21:56:32.083
> 
> 标签：iphone, objective-c

我的视图控制器中有一些方法可以为将来的操作加载，我在一个方法中调用它们，即：

```
- (void) updateSongInformation {
     artistName.text = @"Testing";
     [self setupEmail];
     [self checkStatus];
} 
```

如果我取出最后两行，UILabel 会立即更新。有没有办法在后台运行最后两种方法，这样用户体验就不会延迟？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-05-03T22:09:31.960

performSelector:withObject:afterDelay: 将让您将调用推送到稍后的 runloop 循环。

如果这两个调用花费大量时间，那只会让 UI 稍晚一点没有响应，这可能不是您想要的。在这种情况下，您需要将操作分成小块并继续使用 performSelector:withObject:afterDelay: 来完成下一个部分，或者[将工作推送到后台线程](http://developer.apple.com/iphone/library/documentation/Cocoa/Conceptual/Multithreading/Introduction/Introduction.html)。

# javascript - 控制工作目录?

> ID：818111
> 
> 赞同：23
> 
> 时间：2009-05-03T21:57:36.730
> 
> 标签：javascript, internet-explorer

全文：我正在为我的公司开展一个项目，该项目要求我们每个地点的用户上传由第三方软件生成的报告。此软件生成的所有报告始终放在同一目录中。我们的一些计算机知识较少的同事，根据过去（和正在进行的）类似困难任务的经验判断：从供应商网站下载/保存发票到特定目录，将难以找到正确的目录上传。

每个位置的计算机都运行 Windows Server 2003 并且当前具有 IE6

我们希望通过将文件输入默认设置为指向正确的目录来提高易用性和合规性。

我最初希望能够直接在输入值中设置文件，但这是有充分理由在大多数浏览器中禁用的。是否可以通过 javascript 或仅在 HTML 本身中控制用户按下浏览按钮时打开的目录？

如果没有，关于如何完成它还有什么其他建议？甚至像在桌面上成功设置快捷方式这样简单的方法，这将强制浏览器使用所需的工作目录。（IE 显然忽略了快捷方式的 'start in' 参数）

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-05-03T22:07:12.697

You cannot control the contents of a file input using JavaScript for security reasons. Otherwise, you could create a hidden form with a file input field, set it to a path, and submit the form with JavaScript in order to upload the file to your server without the user knowledge.

Unfortunately, I'm not aware of a way to set the default path for the file selector. If there is one, I'm sure it will be browser-specific and can only be used by setting some option in the client side, not through HTML or JavaScript.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-03T22:27:03.087

A quick Google search resulted in JUpload -- an open source signed Java applet that seems to meet all your needs: [http://jupload.sourceforge.net/](http://jupload.sourceforge.net/)

Demo site: [http://jupload.sourceforge.net/advanced_js_demo.html](http://jupload.sourceforge.net/advanced_js_demo.html)

I'm sure there are many other such Java applets out there and it probably wouldn't be too hard to roll your own.

The only other option I can think of is a desktop uploading application.

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-03T22:13:08.767

IE uses the last folder choosen for file uploads. If you have control over the client computers, my tips is; map a drive letter to the folder where the files are located. This can easliy be done using a cmd-file put in autoload calling subst. Then instruct the users to manually enter the drive letter, as it's very short it should be possible to write a very clear and easy to follow instruction. Good luck.

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2017-08-01T23:10:37.707

简而言之，不可能做任何这样的事情。如您所见，所有/大部分答案都同意此陈述，以及那些没有误解问题的答案。抱歉，但大多数浏览器认为您正在尝试做的事情存在安全风险。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-03T22:18:55.307

You cannot set the value of an input file, that is a security issue.

You can use an activex control, although that stuff is getting pretty out dated. There are many advanced file upload activex controls and I bet you can pick one up pretty cheap.

Registry setting for Download directory might do the trick: (even though its an upload) and you would have to figure out how to set it every time they open IE

```
HKCU\Software\Microsoft\Internet Explorer\DownloadDirectory 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2015-04-23T23:05:53.960

**这行得通。** 在这里，我需要确保用户在客户端本地图像路径上使用了输入图像文件。UrlExists 简单检查文件是否可以加载到已知路径+文件名。我还需要让输入看起来比浏览器更好。这里的诀窍是在我的画布上放置比这里显示的更多的工作来屏蔽输入。将输入不透明度设置为 0 ，这里设置为 0.5 以便您可以看到技巧。

```
 <body>
    <canvas id="FancyCanvasButton" tabindex="8" width="240" height="18" style="position: absolute; left: 100px; top: 120px; border: 1px solid rgb(0, 0, 0); z-index: 1;"></canvas>
    <input type="file" accept="image/*" onchange="loadFile(event)" style="opacity:0.5;position: absolute; left: 100px; top: 120px; z-index: 2; " >
    <img id="output"/>
 <script>
 var loadFile = function(event) {
   var output = document.getElementById('output');
   var fName= "Images/" + event.target.files[0].name;  //None path with users selected file name
   if(UrlExists(fName)){
     output.src=fName;         //Do something like show image
   }else{
    alert("File not present"); // Do something to show file not in this path
   }
 };

 function UrlExists(url) {
    var http = new XMLHttpRequest();
    http.open('HEAD', url, false);
    http.send();
    if (http.status != 404){
       return true;
     }else{
       return false;
     }
  }

  </script> 
```

# c# - Silverlight (3) 最佳实践

> ID：818112
> 
> 赞同：0
> 
> 时间：2009-05-03T21:57:42.190
> 
> 标签：c#, silverlight-3.0

我正在计划一个使用 Silverlight 3 的新建项目。我想知道是否有类似 Silverlight 的“智能客户端软件工厂”之类的东西......

干杯，阿里

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-03T22:16:29.710

In fact, there is. It's called Prism. Take a look at the [CodePlex](http://www.codeplex.com/CompositeWPF "CompositeWPF") site

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-03T22:17:03.580

Somebody recommended this cool site to me earlier in the day. Hope it can help you.

[www.silverlightcream.com](http://www.silverlightcream.com)

Also, you can pretty much apply the same patters from [here](http://msdn.microsoft.com/en-us/magazine/dd458800.aspx) to your silverlight 3 app.

# ruby-on-rails - 如何让 form.select 在 Rails 中返回模型？

> ID：818119
> 
> 赞同：2
> 
> 时间：2009-05-03T22:01:56.500
> 
> 标签：ruby-on-rails, forms, select

我有一个名为 Contact 的模型，它有一个像这样的客人。

```
class Contact < ActiveRecord::Base
  has_one :guest, :class_name => "Contact", :foreign_key => "guest"
end 
```

在我的创建视图中，我使用 select helper 方法来列出所有可以选择为客人的联系人，就像这样......

```
<% form_for(@contact) do |f| %>
  <%= f.error_messages %>
    ...
    <p>
        <%= f.label :guest %><br />
        <% @guests = Contact.find(:all, :order => "lastname").map { |u| [u.lastname + ', ' + u.firstname, u.id] } %>
        <%= f.select :guest, @guests, {:include_blank => true} %>
    </p>
    ...
<% end %> 
```

每当提交此表单时，我都会收到一条错误消息，指出它正在等待联系人但得到了一个字符串。

在将当前联系人保存到数据库之前，我应该在哪里以及如何将表单提交的字符串转换为联系人？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-04T01:08:41.280

当您在 Rails 中创建关联时，例如 has_one，有一些方法会为您的对象动态生成以便于分配。

现在，您使用的方法是

```
@contact.guest = @guest 
```

并且您的联系人对象期望接收另一个可能与之关联的 ActiveRecord 对象。但是，您尝试做的是一种“假”这种包装模型对象的表单中的方法。（来自参数的信息作为字符串引入，这就是您收到该错误的原因）

有几种方法可以实现这一点。第一个是使用嵌套模型属性。. . 复杂的表单，允许您在正在使用的表单中包装子关联`form_for`（使用`fields_for`表单助手）。对此的解释需要很长时间才能输入，幸运的是，有关于复杂表格的令人难以置信的免费资源：

[Railscasts 复杂形式第 1 部分](http://railscasts.com/episodes/73-complex-forms-part-1)

[Railscasts 复杂形式第 2 部分](http://railscasts.com/episodes/74-complex-forms-part-2)

[Railscasts 复杂形式第 3 部分](http://railscasts.com/episodes/75-complex-forms-part-3)

此外，如果您使用的是 Rails 2.3，请查看有关 " `accepts_nested_attributes_for`" 的一些信息。. . 现在明显缺乏教程，但我想随着 2.3 的发布，将会有很多教程。这个方便的小助手将删去 Ryan 在他的屏幕投射中使用的大约一半的代码，以使表单接受从属模型。

最后有一个解决方法。如果您的关系很简单，如果您要关联的客人已经在数据库中，并且您不需要从正在使用的表单创建新的，那么您可以使用虚拟属性之类的东西。在您的表单中，只需将您更改`f.select :guest`为类似`f.select :guest_select`并在模型中实现一个方法：

```
def guest_select=(incoming_id_from_form)
  contact = Contact.find(incoming_id_from_form)
  self.guest = contact
end 
```

这将分配 ActiveRecord 模型，而无需为您实现复杂的表单！

# http - Which encoding is used by the HTTP protocol?

> ID：818122
> 
> 赞同：37
> 
> 时间：2009-05-03T22:02:31.837
> 
> 标签：http, http-headers, protocols, network-protocols

When a browser sends an HTTP request to a web server, what encoding is used to encode the HTTP protocol on the wire? Is it ASCII? UTF8? or UTF16? Or does it specify which encoding it uses in a predefined format (before any decoding takes place?)

P.S I'm not asking about the actual payload (e.g. HTML) of the request/response. I'm asking about the request line (i.e. `GET /index.html HTTP/1.1`) and headers (i.e. `Host: google.com`)

* * *

## 回答 #1

> 赞同：34
> 
> 时间：2009-05-03T22:28:27.687

HTTP 1.1 使用 US-ASCII 作为请求中的请求行、响应中的状态行（原因短语除外）和字段名称的基本字符集，[但](http://www.w3.org/Protocols/rfc2616/rfc2616-sec4.html#sec4.2)允许[字段](http://www.w3.org/Protocols/rfc2616/rfc2616-sec6.html#sec6.1.1)值[和](http://www.w3.org/Protocols/rfc2616/rfc2616-sec6.html#sec6.1)消息[正文](http://www.w3.org/Protocols/rfc2616/rfc2616-sec4.html#sec4.1)中的任何八位[字节](http://www.w3.org/Protocols/rfc2616/rfc2616-sec4.html#sec4.3)。

* * *

## 回答 #2

> 赞同：17
> 
> 时间：2009-05-03T22:25:51.157

[RFC 2616](http://www.ietf.org/rfc/rfc2616.txt) includes this:

```
OCTET          = <any 8-bit sequence of data>
CHAR           = <any US-ASCII character (octets 0 - 127)>
UPALPHA        = <any US-ASCII uppercase letter "A".."Z">
LOALPHA        = <any US-ASCII lowercase letter "a".."z">
ALPHA          = UPALPHA | LOALPHA
DIGIT          = <any US-ASCII digit "0".."9">
CTL            = <any US-ASCII control character
                  (octets 0 - 31) and DEL (127)>
CR             = <US-ASCII CR, carriage return (13)>
LF             = <US-ASCII LF, linefeed (10)>
SP             = <US-ASCII SP, space (32)>
HT             = <US-ASCII HT, horizontal-tab (9)>
<">            = <US-ASCII double-quote mark (34)> 
```

And then pretty much everything else in the document is defined in terms of those entities (`OCTET`, `CHAR`, etc.). So you could look through the RFC to find out which parts of an HTTP request/response can include `OCTET`s; all other parts must be ASCII. (I'd do it myself, but it'd take a long time)

For the request line specifically, the method name and HTTP version are going to be ASCII characters only, but it's possible that the URL itself could include non-ASCII characters. *But* if you look at [RFC 2396](http://www.ietf.org/rfc/rfc2396.txt), it says that.

> A URI is a sequence of characters from a very limited set, i.e. the letters of the basic Latin alphabet, digits, and a few special characters.

Which I guess means that it'll consist of ASCII characters as well.

# jquery - 一页上的 Jquery 和多个 AJAX 调用

> ID：818132
> 
> 赞同：2
> 
> 时间：2009-05-03T22:09:26.857
> 
> 标签：jquery, ajax

我在页面上有缩略图，例如：

```
<div id="credits">
<a href="largeimage1.jpg" alt="credits1.php"><img src="thumb1"></a>
<a href="largeimage2.jpg" alt="credits2.php"><img src="thumb2"></a>
<a href="largeimage3.jpg" alt="credits3.php"><img src="thumb3"></a>
</div>

<div id="zoom"></div>

<div id="credits"></div> 
```

我正在寻找执行以下操作：

*   用户点击 thumb1 > largeimage1 加载 #zoom 和 credits1.php 加载 #credits
*   用户点击 thumb2 > largeimage2 加载 #zoom 和 credits2.php 加载 #credits
*   等等

这可以用jquery吗？IE。是否可以像上面那样一键在同一页面上进行两 (2) 次 ajax 调用？

我目前有以下代码可用于 LARGE 图像 ajax 调用：

```
<script type="text/javascript">
$(document).ready(function(){
    $("a").click(function(){
        var largePath = $(this).attr("href");
        $("#zoom img").fadeOut("slow", function() {
                $(this).attr({ src: largePath }).fadeIn("slow");
        });
        return false;
    });
});
</script> 
```

它就像一个魅力 - 但我现在有一种情况，我想为另一个 div 中的图像加载信用。

任何帮助是极大的赞赏。:)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-03T22:17:02.627

在这条线之上：

```
return false; 
```

添加这个：

```
$('#credits').load($(this).attr('alt')); 
```

异步请求的全部意义在于您可以在继续执行的同时触发任意数量的请求。您可能希望在使用 load 时有某种加载指示器来指示正在发生的事情，以及一些错误处理，但上述内容应该在基本层面上解决问题。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-07-07T16:30:21.923

伙计，那不是ajax。它所做的只是通过编辑 css display:block; 来隐藏页面上的元素。显示：无；

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-03T22:46:05.210

只是为了确保我没有遗漏有关 jquery 的任何内容（我更熟悉 mootools），除非您在缩放 div 中已有图像，否则您的第一段代码将无法工作。我在您的代码中看不到任何将新图像注入 div 的内容......它仅针对现有图像并更新其属性。还是我错过了什么？

# asp.net - SqlMembershipProvider.ApplicationName 属性

> ID：818135
> 
> 赞同：0
> 
> 时间：2009-05-03T22:11:43.483
> 
> 标签：asp.net, authentication, asp.net-membership, forms-authentication

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-03T22:25:59.080

在 IIS 中，根应用程序始终是网站（除非您删除应用程序设置，在这种情况下，它将是配置为应用程序的最外层目录。）基本上：

```
Inetpub
   >Website Folder (typically, the root application)
      >Folder Name
      >Application  (could be the root app, if you removed the one above.)
         >Sub Directory
         >Sub Application 
```

# php - PHP SID 未显示

> ID：818140
> 
> 赞同：4
> 
> 时间：2009-05-03T22:13:20.810
> 
> 标签：php

我无法让我的 SID 工作......

```
<?php
session_start();
// Or maybe pass along the session id, if needed
echo '<br /><a href="page2.php?' . SID . '">page 2</a>';?> 
```

不显示 SID 号，但 session_id 正在工作，不确定我是否遗漏了什么。谢谢

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-05-03T22:40:47.423

如果PHP 检测到名为[session.name](http://www.php.net/manual/en/session.configuration.php#ini.session.name)的 cookie，则 SID 常量将显示一个空字符串。请参阅[手册页](http://www.php.net/manual/en/session.constants.php)。这意味着，只有在会话 cookie 发送到浏览器之前，该 SID 才会包含有用的字符串。

这也意味着如果浏览器拒绝 cookie，SID 常量将起作用。正如 Gumbo 所说，只要启用了 seesion.use_trans_id。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-03T22:35:16.547

您需要[`session.use_trans_sid`](http://docs.php.net/manual/en/session.configuration.php#ini.session.use-trans-sid)启用让 PHP 接受通过 GET 或 POST 传递的会话 ID。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-03T22:32:45.990

第 1 页：

```
<?php
    session_start();
    // why use it in a url?
    echo session_id();
    echo '<br /><a href=page2.php target=_blank>page 2</a>';
?> 
```

第2页：

```
<?php
    session_start();
    // page 2
    echo session_id();
    echo '<br> <br> on page 2 ';
?> 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-03T22:45:45.133

尽可能避免在 URL 中传递会话标识符；对于需要这样做的情况（例如，客户端拒绝会话 cookie），让内置的 URL 重写例程更改 HTML。

在 URL 中传递会话标识符意味着您在 URL 中公开了实现细节。除了纯粹的观点之外，这可能会导致用户复制粘贴和共享包含会话信息的 URL 的实际问题，无意中将他们的会话暴露给朋友或与他们共享 URL 的任何其他人。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2018-06-14T07:01:49.030

如果常量 SID 是空字符串，请尝试从 php.ini 禁用：

```
session.use_cookies = 0

session.use_only_cookies = 0 
```

# c++ - SQLite C++ 按名称访问列

> ID：818141
> 
> 赞同：0
> 
> 时间：2009-05-03T22:13:54.243
> 
> 标签：c++, c, sqlite, dictionary, map

有没有办法通过列名（如 C++ Map）而不是 C/C++ 中的索引号来访问 SQLite 结果？

例如 Python 的 SQLite 访问允许字典访问

```
Results = Query("SELECT * FROM table");
print Results['colname']
print Results['anothercol'] 
```

SQLite 接口的 C++ 中是否有任何类似的方法可用？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-03T22:26:49.127

**较新的答案** [http://www.sqlapi.com/](http://www.sqlapi.com/)这个库可能会做你想做的事。

**旧答案** 基本上你必须用`sqlite3_column_name16`or迭代列`sqlite3_column_name`。您必须将这些返回的字符串与您要查找的字符串进行比较。

我已经使用了它，它的 MFC，但它让您了解需要做什么。

```
int CSQLite3Query::FieldIndex(const CString &field)
{
    CheckVM();

    if ( !field.IsEmpty() )
    {
        for ( int nField = 0; nField < m_nCols; nField++ )
        {
#ifdef UNICODE
            CString sTemp = (LPCTSTR)sqlite3_column_name16(m_VM, nField);
#else
            CString sTemp = (LPCTSTR)sqlite3_column_name(m_VM, nField);
#endif
            if (sTemp == field)
                return nField;
        }
    }
    else
    {
        throw new CSQLite3Exception(MFCSQLITE3_ERROR,
                                    MFCSQLITE3_INVALID_FIELD_NAME);
    }

    return -1;
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-03T22:28:16.050

如果您知道列名的索引，只需为列索引创建一个局部变量，例如：

```
int colname = 0;
int anothercol = 2; //just guessing ;-)

Results = ...
std::cout << Results[colname];
std::cout << Results[anothercol]; 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-03T23:21:32.880

我会和 Daniel 一起在 www.sqlapi.com 上推荐 SQLAPI++——在[http://www.sqlapi.com/HowTo/fetch.html](http://www.sqlapi.com/HowTo/fetch.html)，您可以找到一个按名称获取字段的简单示例。这个例子有点冗长，所以这里是一个纯代码的要点：

```
void showemps(SAConnection* pconn, int minage)
{
  SACommand cmd(pconn, "select name, age from employees where age>:1");  
  cmd << minage;
  cmd.execute();
  while(cmd.FetchNext()) {
    SAString sName = cmd.Field("name");
    long nAge = cmd.Field("age");
    printf("Name: %s, age: %d \n", sName, nAge);
  }
} 
```

# mysql - 将所有命令行输入通过管道传输到 Fedora OS 上的文件的 mysql 命令是什么？

> ID：818144
> 
> 赞同：0
> 
> 时间：2009-05-03T22:14:14.287
> 
> 标签：mysql

我在我的 linux 机器（Fedora Os）上从 mysql 命令行运行了几个查询。我想将所有这些自动捕获到一个文件中。我知道 Linux 中有一个名为 history 的命令，然后您可以将其通过管道传输到文件中。MYSQL 有没有类似的东西。我想保存我所有的脚本和 sql 查询，以供以后参考。

帮助赞赏。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-03T22:19:45.367

MySQL 将您的查询历史存储在文件中`~/.mysql_history`。此文件中的某些字符被转义。空间变成`\040`; 反斜杠变为`\\`. `sed`您可以使用或您喜欢的文本编辑器替换这些转义序列。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-03T22:29:22.443

或者，打开 mysql 查询日志。

在您的 /etc/mysql/my.cnf 文件（或您的操作系统放置的任何位置）中，在配置中放置一个部分，例如：

```
[mysqld]
log=/var/log/mysql/mysqld.log 
```

然后，每个查询都将记录到此文件中。

# asp.net - Two users in different membership DBs can’t use same email address

> ID：818149
> 
> 赞同：1
> 
> 时间：2009-05-03T22:16:07.030
> 
> 标签：asp.net, authentication, asp.net-membership, forms-authentication

Q1 - I’ve created two membership databases ( using aspnet_regsql tool ) DB1 and DB2\. I then created web applications A1 and A2\. A1 uses DB1 to store user credentials, while A2 uses DB2\. If the user I created in A1 ( via Asp.Net WAT tool ) uses email DB@gmail.com, then none of the users created in A2 can have the same email address. But that doesn’t make sense since the two apps use different databases for storing user credentials?!

Q2 - I’ve noticed when I add new membership provider ( within section of the web.config file) and then try to add attributes, that Intellisense feature doesn’t work, since it doesn’t display all available attributes for that particular provider. Why is that?

thanx

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-03T22:25:58.347

**A1.** If the membership settings in your web.config for App "A2" are pointing to the "DB1", this makes perfect sense, otherwise, this is not likely. Make sure that the ConnectionStringName property is pointing to "DB2" instead of "DB1"

**A2.** Intellisense would not work for a custom provider unless it is registered in the intellisense schema settings for your visual studio installation.

Here's some information on adding a [Custom XSD for intellisense](http://blogs.msdn.com/astebner/archive/2005/12/07/501466.aspx)

# c++ - C++ 的 SQLite 替代方案

> ID：818155
> 
> 赞同：17
> 
> 时间：2009-05-03T22:17:41.423
> 
> 标签：c++, sqlite, indexing, persistence

我正在开发一个应用程序，该应用程序需要存储具有多次写入和读取的数据，因为需要快速搜索数据（需要某种索引），并且还能够序列化和保存数据。

目前我正在考虑使用 SQLite，它可以完成工作，但我对替代方案持开放态度。SQLite 的语法确实不适合 C++ 代码（例如，我被迫通过列索引号而不是列名等来访问结果）。

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2009-05-03T22:24:39.257

继续使用 SQLite，但要为此找到一个好的 C++ 库。

这个[StackOverflow 问题](https://stackoverflow.com/questions/120295/what-is-a-good-oo-c-wrapper-for-sqlite)应该可以帮助您...

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-05-03T23:01:50.727

我会争辩说，对包装库的附加依赖不值得为处理这种额外依赖的成本而付出代价。当它们的文档可能很少时，您不希望被困在调试这些包装器库中。SQLLite 必然会更稳定，并有更好的文档，因此也有更可靠的依赖。

我会根据您的最终应用程序处理 sqllite 或以某种智能方式自己包装它。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-05-03T22:23:09.727

听起来好像数据库是您唯一真正的选择。但是，如果您选择 SQLite 或 MySql 或 Postgres 在列索引点中并不重要。

也许您真正想要的是更好的数据库抽象。你可能想试试 Poco，它有一个很棒的： http: [//pocoproject.org/](http://pocoproject.org/)

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-05-04T00:06:33.550

Berkeley DB 又名 SleepyCat。如果您搜索档案，可以看到 Mike Olsen 的一篇文章，其中谈到了 SQL 在任何项目中的主要缺点。去年有另一篇后续文章表明 SQL 即将淘汰，因为 ORM 层变得越来越好。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-05-04T23:43:18.730

如果您要求我继续使用 SQLite 并“自己动手” - 包装非常简单，我自己对 SQLite 进行了各种包装。为什么？因为它的 API 比其他任何与数据库相关的 API 都友好得多，而且您无需花费太多精力。使用包装器库，您只会添加更多未知数，最重要的是，大多数包装器并不是专门用于服务嵌入式数据库。我总是重复，嵌入式数据库的正确方法与数据库服务器的最佳方法有很大不同......

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-05-03T22:30:58.163

我可以建议您列出 Sqlite 网站上列出的[包装器 API列表吗？](http://www.sqlite.org/cvstrac/wiki?p=SqliteWrappers)许多语言都有很多，包括 C++。Sqlite Plus 看起来特别好。提到的“通常没用”的 POCO 看起来也不错。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-05-03T22:31:33.950

如果 SQL 语法对你来说不重要，我推荐[MetaKit——](http://www.equi4.com/metakit/)这是一种稍微不同的方法，但它非常强大，而且我个人知道有不少商业项目成功地使用了它，甚至在嵌入式系统上也是如此。

[这个教程](http://support.articque.com/metakit/metakit_tutorial.html)对入门很有帮助。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-05-04T08:56:36.397

我同意，说 SQLite 与 C++ 或列名索引不兼容是虚假的。有很多 C++ SQLite 包装器鼓励按名称访问列。 [SQLite++](http://www.eztools-software.com/tools/SqlitePlus/sqliteplusplus.asp)只是其中之一。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-05-03T23:28:38.680

您可能会考虑使用倒排索引 IR 库，例如 Lucene（或众多克隆之一），而不是 sql 派生类。我知道 Lucene 是 Java，但您可以编写一个托管 C++ 库来与 Lecene.Net 互操作。

就速度而言，我对 Lucene 的读取性能非常满意。它没有针对其写入进行优化，但它仍然非常好，只要您不尝试建立数百万“文档”的索引。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-05-03T23:58:17.953

如果您不在 Windows 上工作，您可以查看 Tokyo Cabinet。它看起来相当不错。我正在等待 Win32 端口，所以除了性能看起来令人印象深刻之外，我不能说太多。

[http://anyall.org/blog/2009/04/performance-comparison-keyvalue-stores-for-language-model-counts/](http://anyall.org/blog/2009/04/performance-comparison-keyvalue-stores-for-language-model-counts/)

这不是 SQL 派生的。这是一个直接的基于 b-tree/hash 的存储。在我看来，这是非常受欢迎的。我知道的唯一有竞争力的库是 Berkeley DB，它的许可不太理想。

# java - 使 JScrollPane 内部的 JList 发生变化时显示滚动条

> ID：818163
> 
> 赞同：5
> 
> 时间：2009-05-03T22:20:34.070
> 
> 标签：java, swing

我正在尝试使用动态更改 JScrollPane 内的 JList

```
myList.setListData(someArray); 
```

在此之后，我希望 JScrollPane 根据需要显示滚动条，但这不会发生。谷歌搜索这个问题不是很有帮助。我尝试了以下方法的各种组合，但收效甚微（基本上是浏览 api 文档）：

```
myScrollPane.setVerticalScrollBarPolicy(JScrollPane.VERTICAL_SCROLLBAR_ALWAYS);
myList.validate(); myScrollPane.validate();
myScrollPane.setPreferredSize(Dimension someDimension);
myScrollPane.setViewportView(moduleList);
myScrollPane.setLayout(...); 
```

使用第一种方法时，会出现滚动条，但模型更改不会激活它。我还连接到 PropertyChangeEvent 并验证模型更改时 JList 会触发和事件。我在这里想念什么？我必须使用什么方法来完成这项工作，或者更好的是什么属性可以使这项工作开箱即用？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-11-11T15:08:28.953

如果在 JList 上设置了 preferredSize，即使 (0, 0)，那么 JScrollPane 也不起作用 - 确保它未设置，必要时设置 PreferredSize(null)

见[mrtextminer](http://mrtextminer.wordpress.com/2007/11/20/jlist-is-not-scrollable/)如下

> 这个问题的解决方法是不设置JList的preferredSize（去掉设置语句）。在 Netbeans IDE 5.5.1 中，可以通过右键单击 JList 的 preferredSize 属性，然后选择“恢复默认值”来取消设置 JList 的 PreferredSize。
> 
> 总之，只设置 JScrollPane 的 preferredSize。不要设置 JList 的preferredSize。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-04T07:34:22.397

刚刚编写了一个小示例应用程序来测试这种行为，它开箱即用。当您修改列表数据时，默认情况下会根据需要在滚动窗格中添加垂直和水平滚动条。

```
public class Frametest {

private JList list;

public Frametest() {
    JFrame f = new JFrame("Scrollable JList");
    f.setSize(200, 300);
    JScrollPane jsp = new JScrollPane();        
    list = new JList();
    jsp.getViewport().add(list);
    f.getContentPane().setLayout(new BorderLayout());
    f.getContentPane().add(jsp, BorderLayout.CENTER);
    JButton button = new JButton("update");
    button.addActionListener(new ActionListener() {
        public void actionPerformed(ActionEvent arg0) {
            Object[] objects = new Object[20];
            for(int i=0; i<20; i++) {
                objects[i] = "foo foo foo foo foo foo foo foo foo foo foo foo "+i;
            }
            list.setListData(objects);
        }
    });
    f.getContentPane().add(button, BorderLayout.SOUTH);
    f.setVisible(true);     
}

public static void main(String[] args) {
    new Frametest();
}} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-04T07:49:49.850

您是否尝试在更改列表数据时调用[`validate`](http://java.sun.com/javase/6/docs/api/java/awt/Container.html#validate())or[`revalidate`](http://java.sun.com/javase/6/docs/api/javax/swing/JComponent.html#revalidate())方法？`JList`

```
myList.setListData(someArray);
myList.revalidate(); 
```

仅供参考，我只是对`validate`and之间的区别进行了快速调查，`revalidate`这似乎`validate`是调用该方法的组件及其子组件的布局，而`revalidate`将一直到其最高父级，然后对其所有子项执行布局更改等。

调用不仅`revalidate`会`myList`验证列表本身，还会验证滚动窗格，因此，会根据列表中绘制的项目影响滚动条的可见性。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-08T16:13:09.067

这看起来不对：

```
jsp.getViewport().add(list); 
```

而是使用：

```
jsp.setViewportView(list); 
```

或者

```
new JScrollPane(list); 
```

并且列表将正确添加到滚动窗格中。以这种方式添加它会告诉滚动窗格监听它的变化。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2011-02-17T15:24:15.740

如果你仍然需要这个尝试删除验证方法，如果你在列表中有一个 setpreferredsize 删除它，那就是我的搞砸了

我删除了

```
resultList.setPreferredSize(resultList.getPreferredSize()); 
```

完成了

# objective-c - 目标-C 2.0；分配财产；泄漏内存？

> ID：818164
> 
> 赞同：3
> 
> 时间：2009-05-03T22:21:17.593
> 
> 标签：objective-c, iphone, memory-management

我还在学习 Objective-C 内存管理。我正在尝试在我正在构建的示例程序中实现几个简单的类。

例如，假设我有以下类定义：

```
 #import <UIKit/UIKit.h>

 @interface customViewController : UIViewController 
 {
    customObject *myCustomObject;
 }

 @property (retain) customObject *myCustomObject;

 - (void)replaceCustomObject:(customObject *)newObject;

 @end 
```

对于属性，我使用标准的综合关键字...

```
@synthesize myCustomObject; 
```

然后请假设在 customViewController 的实例中 myCustomObject 已经设置了一个有效值并且正在使用中。那么replaceCustomObject方法定义为：

```
 - (void)replaceCustomObject:(customObject *)newObject
 {
     //Does this cause a memory leak because I just assign over
     //the existing property? 
     self.myCustomObject = newObject;
 } 
```

正如评论所问，**这会泄漏内存吗？**或者这是用新对象替换先前对象的有效方法？

谢谢你，
弗兰克

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-03T22:40:19.500

正如其他人所提到的，您的代码完全有效，并且在分配给属性时不会泄漏内存。

如果你忘记实现正确的`dealloc`方法，最后分配的对象将在你`customViewController`的销毁时泄漏。正确的`dealloc`实现如下所示：

```
- (void)dealloc
{
    self.myCustomObject = nil;
    [super dealloc];
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-03T22:28:29.993

这是完全有效的，并且不会泄漏内存。合成访问器正确管理保留计数。

（顺便说一句，您不需要该 replaceCustomObject: 方法；由于您的属性默认为可读写的，因此您有一个自动生成的 setCustomObject: 方法，您的类的客户端可以使用该方法，并且遵循正常的 Cocoa 命名约定。）

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-03T22:33:58.313

据此，[如果](http://developer.apple.com/documentation/Cocoa/Conceptual/ObjectiveC/Articles/ocProperties.html#//apple_ref/doc/uid/TP30001163-CH17-SW12)您在声明中使用 (retain)，则合成方法将首先释放旧值，然后保留新值：

```
if (property != newValue) {
    [property release];
    property = [newValue retain];
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-03T22:29:24.470

属性访问器语法

```
self.x = y; 
```

与显式调用 setter 方法的效果相同：

```
[self setX:y]; 
```

访问器方法将执行它编写的任何操作。在您的情况下，对于已被 @synthesized 的 @property(retain) 属性，访问器将释放旧对象并保留新对象。

因此，无论是显式调用还是通过 '.' 调用 setter。语法，会做正确的事——包括正确的内存管理。

简而言之：不，这不会泄漏内存。

# database - 有谁知道一个很好的库来将一个人的名字映射到他或她的性别？

> ID：818203
> 
> 赞同：89
> 
> 时间：2009-05-03T22:34:38.747
> 
> 标签：database, language-agnostic

我正在寻找一个图书馆或数据库，可以根据他或她的名字或昵称来猜测一个人是男性还是女性。就像是

```
john => "M",
mary => "F",
alex => "A", #ambiguous 
```

我正在寻找支持英文名称以外的名称（如日语、印度语等）的名称。

在我得到另一个类似“你会通过假设他们的性别/性别来冒犯人们”的答案之前，让我明确一点，我的应用程序不会与任何人交互。无论如何，它不会发送电子邮件或联系任何人。没有用户可以询问。在许多情况下，相关人员已经死了，而我所拥有的唯一信息是姓名、出生日期和死亡日期。我想知道个人性别的原因是为了使输出的语法更好，并帮助可能稍后出现的搜索。

* * *

## 回答 #1

> 赞同：70
> 
> 时间：2009-05-03T23:04:49.627

gender.c 是一个**开源**的C 程序，做得很好。它包含来自世界各地的 44568 个名字的数据。有很好的文档和文件格式的描述（基本上是纯文本），因此从您自己的应用程序中读取它应该不难。

以下是作者所说的：

> 关于数据质量的几句话
> 
> 名字词典是精心准备的。例如，这本词典中的土耳其语、印度语和韩语名称都已被几位母语人士独立分类。我还特别注意仅列出当前可以找到的那些名称。
> 
> 从中吸取的教训？
> 
> 任何修改都应该非常谨慎地进行（并且它们还必须遵守搜索算法所需的排序）。例如，知道“Sascha”在德国是一个男孩的名字，但作者从未假设英文“Sasha”是一个女孩的名字。知道“Jan”是德国男孩的名字，我从没想过它也是“Janet”的英文缩写形式。另一个恰当的例子是名称“Esra”。这是一个男孩的名字在德国，但在土耳其一个女孩的名字。

该程序计算名字是男性还是女性的概率。它可以单独使用名称作为输入，也可以使用名称和原产国来实现，这会产生明显更好的结果。

您可以从德国计算机杂志 c't [40 000 Namen](http://www.heise.de/ct/ftp/07/17/182/)的网站下载它。这篇文章是德文的，但不用担心，所有文档都是英文的。如果您对文章不感兴趣，这里是直接 ftp 链接[0717-182.zip 。](ftp://ftp.heise.de/pub/ct/listings/0717-182.zip)zip 文件包含源代码、Windows 可执行文件、数据库和文档。

* * *

## 回答 #2

> 赞同：66
> 
> 时间：2009-05-03T22:47:15.723

在一般情况下，无法以编程方式推断名称的性别。您需要一个名称数据库。~~这是[来自美国人口普查局的免费名称数据库](http://www.census.gov/genealogy/names/names_files.html)。~~

**编辑**：2010 年名称的链接已失效，但评论中有工作链接和库。

* * *

## 回答 #3

> 赞同：32
> 
> 时间：2009-05-03T22:42:53.143

“我告诉你，对于一个叫‘苏’的男孩来说，生活并不容易。”

...那么，为什么要让它变得更难？如果您需要知道性别，请问......否则，不要担心。

* * *

## 回答 #4

> 赞同：30
> 
> 时间：2013-08-18T19:29:31.763

我构建了一个免费的 API，它可以根据名字对性别进行概率猜测。我没有使用上述任何一种方法，而是使用来自社交网络的大量个人资料数据集来提供概率猜测和确定性因素。它还支持通过国家或语言 ID 进行可选过滤。随着越来越多的配置文件被添加到数据集中，情况一天比一天好。

在[http://genderize.io免费使用](http://genderize.io)

**您应该考虑的一**件事是使用考虑人口统计的工具，因为命名约定将严重依赖于此。

例子

```
http://api.genderize.io?name=kim
{"name":"kim","gender":"female","probability":"0.89","count":1440}

http://api.genderize.io?name=kim&country_id=dk
{"name":"kim","gender":"male","probability":"0.95","count":44,"country_id":"dk"} 
```

* * *

## 回答 #5

> 赞同：22
> 
> 时间：2009-05-10T06:17:32.677

这里有两种奇怪的方法，它们甚至可能不起作用，而且在不违反许可条款的情况下可能无法整体起作用：

1.  使用 Facebook API（我对此几乎一无所知，甚至不可能）执行两个搜索：一个用于具有该名字的 FB 男性用户，另一个用于女性。使用这两个数字来决定性别的概率。

2.  更松散但更具可扩展性，使用 Google API 并搜索名称和特定性别的代词，然后比较数字。例如，搜索“Richard his”（不是短语）有 592,000,000 个结果，但“Richard her”只有 179,000,000 个结果。

* * *

## 回答 #6

> 赞同：6
> 
> 时间：2009-05-03T23:41:22.143

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2009-05-04T00:15:58.100

假设用户必须是男性或女性也是不好的做法。有一小部分“双性人”人，他们中的大多数人都非常厌倦没有一个盒子可以打勾。..
bignose：对“单数他们”很有趣。我没有意识到它有如此悠久的历史。

* * *

## 回答 #8

> 赞同：4
> 
> 时间：2011-12-15T10:57:23.507

它不是一项服务，而是一个带有数据库的小应用程序：http:
[//www.codeproject.com/KB/cpp/genderizer.aspx](http://www.codeproject.com/KB/cpp/genderizer.aspx)

这个工具是德语的：http:
[//www.faq-o-matic.net/2011/06/01/zu-einem-vornamen-das-geschlecht-finden/](http://www.faq-o-matic.net/2011/06/01/zu-einem-vornamen-das-geschlecht-finden/)

VB中的另一个：
[http ://www.vbarchiv.net/tipps/tipp_1925-geschlecht-anhand-des-vornamens-ermitteln.html](http://www.vbarchiv.net/tipps/tipp_1925-geschlecht-anhand-des-vornamens-ermitteln.html)

我认为结合一些“2011 年最常用的名字”列表，您应该能够构建一些像样的东西。

* * *

## 回答 #9

> 赞同：4
> 
> 时间：2013-08-01T10:56:24.640

python 包[SexMachine](https://pypi.python.org/pypi/SexMachine/)会为你做这件事。给定任何名字，如果它是男性、女性或男女皆宜，它会返回。它依赖于Jorg Michael的[gender.c程序的数据。](http://www.autohotkey.com/board/topic/20260-gender-verification-by-forename-cmd-line-tool-db/)

* * *

## 回答 #10

> 赞同：3
> 
> 时间：2009-05-03T23:39:42.290

尝试自动化它唯一能得到的就是一群不满意的用户。根据该人口普查数据：

> 詹姆斯、约翰、罗伯特、迈克尔、威廉、大卫、理查德、查尔斯、约瑟夫、托马斯、克里斯托弗、丹尼尔、保罗、马克、唐纳德、乔治、肯尼斯、史蒂文、爱德华、布莱恩、罗纳德、安东尼、凯文、杰森、马修、加里、蒂莫西、何塞、拉里、杰弗里、弗兰克、斯科特、埃里克、斯蒂芬、安德鲁、雷蒙德、格雷戈里、约书亚、杰里、丹尼斯、沃尔特、帕特里克、彼得、哈罗德、亨利、卡尔、亚瑟、瑞恩、乔、胡安、杰克、艾伯特、贾斯汀、特里、杰拉德、基思、塞缪尔、威利、劳伦斯、罗伊、布兰登、亚当、弗雷德、比利、路易斯、杰里米、亚伦、兰迪、尤金、卡洛斯、罗素、鲍比、维克多、马丁、​​杰西、肖恩、克拉伦斯、肖恩、克里斯、约翰尼、吉米、安东尼奥、托尼、路易斯、迈克、戴尔、柯蒂斯、诺曼、艾伦、格伦、特拉维斯、李、梅尔文、凯尔、弗朗西斯、耶稣、雷、乔尔、埃迪、特洛伊、亚历山大、马里奥、弗朗西斯科、迈克尔、奥斯卡、杰伊、亚历克斯、乔恩、罗尼、汤米、莱昂、利奥、韦斯利、迪恩、丹、刘易斯、科里、莫里斯、弗农、罗伯托、克莱德、肖恩、萨姆、莱斯特、查理、泰勒、吉恩、布雷特、安吉尔、莱斯利、塞西尔、安德烈、埃尔默、加布里埃尔、米切尔、阿德里安、卡尔、科里、克劳德、杰米、杰西、克里斯蒂安、朗尼、科迪、胡里奥、凯利、吉米、乔丹、詹姆、凯西、约翰尼、西德尼、朱利安、达里尔、维吉尔、马歇尔、佩里、马里昂、特雷西、雷内、弗雷迪、奥斯汀、杰基、乔伊、埃文、达纳、唐尼、香农、安吉洛、肖恩、林恩、卡梅伦、布莱克、克里、让、爱尔兰共和军、鲁迪、本尼、罗宾、罗伦、诺埃尔、德文、金、瓜达卢佩、卡罗尔、萨米、马蒂、泰勒、埃利斯、达拉斯、劳伦斯、德鲁、乔迪、弗兰基、帕特、梅尔、特雷尔、达内尔、托米、托比、范、考特尼、简、卡里、桑托斯、奥布里、摩根、路易、史黛西、米卡、比利、洛根、德米特里厄斯、罗比、肯德尔、罗伊斯、米奇、德文、阿什莉、凯莉、儿子、马林、阿里、萨米、米歇尔、罗里、克里斯、艾利、亚历克西斯、格里、斯泰西、卡门、谢尔比、瑞奇、博比、奥利、丹尼、迪翁、奥德尔、玛丽、科尔比、霍利斯、柯比、克鲁兹、美林、莱恩、克莱奥、布莱尔、数字、克莱尔、伯尼、琼、多米尼克、特里斯坦、詹姆斯、盖尔、 LAVERNE、ALVA、STEVIE、ERIN、AUGUSTINE、YOUNG、JOHNIE、ARIEL、DUSTY、LINDSEY、TRACEY、SCOTTIE、SANDY、SYDNEY、GAIL、DORIAN、LAVERN、REFUGIO、IVORY、ANDREA、SANG、DEON、CAROL、Yong、BERRY、特立尼达、雪莉、玛丽亚、张、罗萨里奥、丹妮、弗朗西斯、清、康妮、保守党、卢佩、迪、宋、智、奎恩、明、西奥、卢、钟、瓦伦丁、杰米、惠特尼、索尔、钟、巴黎、奥萨、莱西、董、安东尼亚、凯利、卡罗尔、谢恩、瓦尔、裘德、布里特、洪、利、盖尔、杰、尼基、莱斯利、曼、凯西、珠宝、帕特里夏、劳伦、伊莉莎、迈克尔、林赛和珠宝克莱尔、伯尼、琼、多米尼克、特里斯坦、詹姆、盖尔、拉文、阿尔瓦、斯蒂维、艾琳、奥古斯丁、年轻、约翰尼、爱丽儿、达斯蒂、林赛、特蕾西、斯科蒂、桑迪、悉尼、盖尔、多里安、拉文、REFUGIO、 IVORY、ANDREA、SANG、DEON、CAROL、Yong、BERRY、TRINIDAD、Shirley、MARIA、Chang、ROSARIO、DANNIE、FRANCES、THANH、CONNIE、Tory、LUPE、DEE、SUNG、CHI、QUINN、MINH、THEO、LOU、钟、瓦伦丁、杰米、惠特尼、索尔、钟、巴黎、奥萨、莱西、董、安东尼亚、凯利、卡罗尔、谢恩、瓦尔、裘德、布里特、洪、利、盖尔、杰、尼基、莱斯利、曼、凯西、朱厄尔、帕特里夏、劳伦、以利沙、迈克尔、林赛和朱厄尔克莱尔、伯尼、琼、多米尼克、特里斯坦、詹姆斯、盖尔、拉文、阿尔瓦、斯蒂维、艾琳、奥古斯丁、年轻、约翰尼、爱丽儿、达斯蒂、林赛、特蕾西、斯科蒂、桑迪、悉尼、盖尔、多里安、拉文、雷福吉奥、 IVORY、ANDREA、SANG、DEON、CAROL、Yong、BERRY、TRINIDAD、Shirley、MARIA、Chang、ROSARIO、DANNIE、FRANCES、THANH、CONNIE、Tory、LUPE、DEE、SUNG、CHI、QUINN、MINH、THEO、LOU、钟、瓦伦丁、杰米、惠特尼、索尔、钟、巴黎、奥萨、莱西、董、安东尼亚、凯利、卡罗尔、谢恩、瓦尔、裘德、布里特、洪、利、盖尔、杰、尼基、莱斯利、曼、凯西、朱厄尔、帕特里夏、劳伦、以利沙、迈克尔、林赛和朱厄尔MARIA, CHANG, ROSARIO, DANNIE, Frances, THANH, CONNIE, TORY, LUPE, DEE, Sung, CHI, QUINN, Minh, THEO, LOU, CHUNG, VALENTINE, JAMEY, WhiTNEY, SOL, Chong, PARIS, OTHA, LACY, DONG、ANTONIA、KELLEY、CARROL、SHAYNE、VAL、JUDE、BRITT、HONG、LEIGH、GAYLE、JAE、NICKY、LESLEY、MAN、KASEY、JEWELL、PATRICIA、LAUREN、ELISHA、MICHAL、LINSAY 和 JEWELMARIA, CHANG, ROSARIO, DANNIE, Frances, THANH, CONNIE, TORY, LUPE, DEE, Sung, CHI, QUINN, Minh, THEO, LOU, CHUNG, VALENTINE, JAMEY, WhiTNEY, SOL, Chong, PARIS, OTHA, LACY, DONG、ANTONIA、KELLEY、CARROL、SHAYNE、VAL、JUDE、BRITT、HONG、LEIGH、GAYLE、JAE、NICKY、LESLEY、MAN、KASEY、JEWELL、PATRICIA、LAUREN、ELISHA、MICHAL、LINSAY 和 JEWEL

都是对男性和女性都有效的名字。如果一个女孩的名字是罗伯特，而每个人，包括你的软件，都一直叫她男人，她会很生气。

* * *

## 回答 #11

> 赞同：3
> 
> 时间：2009-05-04T02:44:09.320

尽管数据库可能是最实用的解决方案，但如果您想获得一些乐趣，也许您可​​以尝试编写一个神经网络（或使用神经网络库），它接受名称并输出这 3 个选项之一（F、M、A ）。

您可以使用其他答案建议的数据库中存在的数据集以及您拥有的任何其他数据来训练它。

此解决方案将允许您处理以前未专门分类的名称，并且还可以处理不同的语言。您可能还想将语言（如果您知道的话）作为输入传递给神经网络。

我不知道我可以说神经网络（或任何其他机器学习）在分类方面做得很好。

* * *

## 回答 #12

> 赞同：3
> 
> 时间：2009-05-06T23:02:12.370

这取决于文化/地区：以 Andrea 为例，因为意大利人只有男性名字，瑞典是女性名字，而 Andreas 是男性名字；肖恩在英语中是模棱两可的。如果一种语言有偏角，比如拉丁语或俄语，最后的字母会根据语法规则改变，

歧义的另一个来源是与个人姓名相同的姓氏。

在我看来，一般来说是不可能解决的。

* * *

## 回答 #13

> 赞同：3
> 
> 时间：2011-11-15T15:39:46.823

这个想法显然不适用于大多数语言。

但是，如果您能提前告诉国籍，您可能会有更多的运气。在大多数斯拉夫语言（例如俄语、波兰语、保加利亚语）中，您可以安全地假设所有以 -va -cha -ska 结尾的姓氏（-a 通常是女性）而 -v -ch -shi 是男性。

事实上，任何姓氏都有女性和男性形式，具体取决于结尾。不过，在其他国家（例如美国）使用的相同名称可能只使用阳性形式。

名字也可以这样说（-a -ya 是女性），但它不是 100% 准确的。

但总的来说，您很难得到足够准确的库。

* * *

## 回答 #14

> 赞同：2
> 
> 时间：2009-05-19T10:45:39.820

我没用过，但 IBM 有一个看起来相当全面的[Global Name Analytics库（有偿！）。](http://www-01.ibm.com/software/data/globalname/analytics/)

* * *

## 回答 #15

> 赞同：2
> 
> 时间：2013-08-02T17:10:35.717

Z 目录（位于 vettrasoft.com）具有 C 语言功能，其工作原理如下：

```
void func()
{
    char c = z_guess_sex_byfirstname ("Lon");
    switch(c)
    {
    case 'M': std::cout << "It's a boy!\n"; break;
    case 'F': std::cout << "It's a girl!\n"; break;
    case 'B': std::cout << "this name is for both sexes\n"; break;
    case '?': std::cout << "sex unknown sorry\n"; break;
    }
} 
```

它是数据库驱动的，我认为该表有 10,000 多个名称，但您需要下载并安装 z 目录（包括许多其他拓扑项目，如国家、地理地标、机场、州、区号、邮政编码等以及用于访问数据的 c++ 函数和对象）。然而，这些名称是非常面向英语的。该表是一项正在进行的工作，并逐渐更新。

* * *

## 回答 #16

> 赞同：1
> 
> 时间：2009-05-03T22:52:03.870

姓名-性别地图可以工作，但在多元文化国家，这更像是猜测。我可以举一个例子：波兰语中的玛丽安是一个典型的男性名字，而英国的同一个名字是一个女性名字。在世界各地移民的时代，我不确定这样的数据库是否会非常准确。祝你好运！

* * *

## 回答 #17

> 赞同：1
> 
> 时间：2009-05-04T00:08:21.457

有些文化有男女通用的名字——比如我的。那你怎么办呢？我认为答案很简单——不要假设——你可能会引起冒犯。只要问它是否需要，否则性别中立。

* * *

## 回答 #18

> 赞同：1
> 
> 时间：2009-05-05T23:47:36.403

好吧，不再是了。IBM不久前为这个想法申请了[专利。](http://yro.slashdot.org/article.pl?sid=08/11/04/2221208)

因此，如果您正在寻找任何级别的灵活性（而不是名称列表），您要么必须（喘气！）询问用户，要么只需向 IBM 支付权利 :)

无论如何，这种自动检测对于许多名字性别模糊的人来说是很烦人的，甚至只是卑鄙的父母。让我们不要让这对他们来说更难。

* * *

## 回答 #19

> 赞同：1
> 
> 时间：2009-05-09T20:53:07.977

它不是免费的，但这是我以前使用过的一个不错的库：

> NetGender for .NET 允许您快速轻松地将名称验证、解析和性别确定构建到您的自定义应用程序中。准确验证特定字段是否包含有效的个人或公司。NetGender 使用 100,000 多个种族多样化的名称字典与 8,000 多个公司名称字典相结合，以确保精确的性别确定。

[http://www.softwarecompany.com/dotnet/netgender.htm](http://www.softwarecompany.com/dotnet/netgender.htm)

* * *

## 回答 #20

> 赞同：1
> 
> 时间：2009-06-07T15:48:51.663

有趣的是你说你有生日。那会有所帮助。我看过名字流行历史的数据库。

在电影 Splash (1984) 中，Darryl Hannah 的角色从麦迪逊大道的路牌中选择了“麦迪逊”这个名字，这很有趣，因为“麦迪逊”显然不是一个女孩的名字。

24 年后，麦迪逊是第四大最受欢迎的女婴名字！

* * *

[来自政府的名字历史。](http://www.ssa.gov/cgi-bin/babyname.cgi)（看看玛丽过去 100 年的悲惨衰落。）

* * *

当我还是个孩子的时候给白宫写信时，理查德尼克松（或者，也许是秘书）给我回了一些历史地方的照片，写给“瑞德安德森小姐”。“瑞德小姐？” 这甚至没有意义！我们真的不能区分克拉克盖博的瑞德（在乱世佳人中留着小胡子！）和薇薇安李的斯嘉丽吗？我永远不会原谅他，尽管尼尔杨保证“即使理查德尼克松也有灵魂”。

* * *

## 回答 #21

> 赞同：1
> 
> 时间：2010-04-28T21:17:57.080

我很确定不存在具有可接受的准确度的此类服务。以下是我认为无法克服的问题：

*   有很多男人和女人的名字。
*   这个世界上有很多不同的名字，即使你只考虑一个国家。
*   约翰尼·卡什（Johnny Cash）雄辩地提出了“一个名叫苏的男孩”的问题：-）

* * *

## 回答 #22

> 赞同：1
> 
> 时间：2011-11-04T04:21:29.790

查看[http://genderchecker.com/](http://genderchecker.com/)

* * *

## 回答 #23

> 赞同：1
> 
> 时间：2014-04-17T20:37:12.200

你可以看看我的 python 性别检测项目[https://github.com/muatik/genderizer](https://github.com/muatik/genderizer)

它试图通过查看作者姓名和/或样本文本（例如推文）来检测作者的性别。

并且它还支持mongodb、memcached以提高性能。

* * *

## 回答 #24

> 赞同：0
> 
> 时间：2009-05-04T00:03:57.910

* * *

## 回答 #25

> 赞同：0
> 
> 时间：2009-05-04T03:03:03.360

恕我直言，从个人姓名中确定性别通常是一个坏主意。很多名字都是双性恋（天哪，这甚至是一个词吗？？:-)，而且它们可能是一种文化中的一种性别，另一种文化中的另一种性别。

一些愚蠢的例子，只是想到的一些（来自我所在的世界，CE）

Vanja - 女性，在东方国家从这里开始，主要是男性
Alex - 双性人（Sandra，女性和 Sandro，男性的缩写）
Robin - 在西方文化中，可以两者兼而有之

在世界的某些地方，一个人的性别可以通过查看名字的结尾来确定。例如，Marija、Sandra、Ivana、Petra、Sara、Lucija、Ana - 你可以看到这些女性名字中的大多数都以“ja”或“ra”结尾。还有其他例子。

不过，我认为最好只向用户询问性行为。

* * *

## 回答 #26

> 赞同：0
> 
> 时间：2009-05-14T09:24:04.770

从关于这个的黑客新闻[讨论](http://news.ycombinator.com/item?id=608057)中得到[这个](http://www.hackerfactor.com/GenderGuesser.html)

* * *

## 回答 #27

> 赞同：0
> 
> 时间：2010-04-28T21:18:25.887

我知道没有这样的服务，但是..

*   你可以从一个[原始的人名列表](https://stackoverflow.com/questions/1803628/raw-list-of-person-names/1803635#1803635)开始，或者
*   根据一些规则猜测性别（例如 -o => 男、-ela、-a => 女）

在某些国家（例如德国），可以给一个人起的名字受到法律的限制——也许有一些关于这个问题的出版物，可以收获（但我目前不知道有什么）。

* * *

## 回答 #28

> 赞同：0
> 
> 时间：2010-04-28T22:14:42.910

我知道没有这样的服务。但是，您也许可以找到您正在寻找的数据。美国政府公布了有关姓名的流行程度和他们所依附的人的性别的数据。社保局有这样一个[页面](http://www.ssa.gov/OACT/babynames/)，人口普查也有，但我没花时间看。也许其他世界政府也会做类似的事情。

* * *

## 回答 #29

> 赞同：0
> 
> 时间：2011-05-01T17:05:31.610

我要做的是制作一个 hack，它获取名称并针对 facebook api 进行搜索。然后查看生成的用户并计算其中有多少是女性或男性。然后您可以返回一个百分比。不再那么不可逾越。:)

* * *

## 回答 #30

> 赞同：-2
> 
> 时间：2009-05-03T22:46:17.847

问问别人，如果他们很好，他们会给你他们的'M'或'F'，如果他们不是，就给他们一个'A'。

* * *

## 回答 #31

> 赞同：-2
> 
> 时间：2009-05-03T22:48:46.687

我认为很难找到涵盖一种以上（或少数几种）文化的图书馆或数据库。例如，在瑞典，“玛丽亚”这个名字被强烈地认为是一个女性名字，而（据我所知）这种联系在西班牙语国家并不那么强烈。

* * *

## 回答 #32

> 赞同：-3
> 
> 时间：2009-05-03T22:51:43.683

不要费心试图从输入的名字中确定一个人的性别。如果你弄错了，你真的会惹怒某人，让用户输入他们的性别很简单，所以你不妨让他们输入。

* * *

## 回答 #33

> 赞同：-3
> 
> 时间：2010-04-28T22:39:53.567

另外，我不知道亚洲语言、阿拉伯语和/或成千上万种语言中的一种。

我的意思是肯定我可以看到一个包含男性与女性百分比的姓名数据库，以及地区、国家等其他信息。但最终，要能够处理世界上所有可能的名称，这将是一个相当复杂和庞大的数据库。

另外如何处理不在数据库中的名称？ETC....

# iphone - 动画期间的 UIView 缩放

> ID：818207
> 
> 赞同：6
> 
> 时间：2009-05-03T22:36:29.477
> 
> 标签：iphone, cocoa-touch, uikit, core-animation

我有一个自定义 UIView 来显示平铺图像。

```
 - (void)drawRect:(CGRect)rect
    {
        ...
        CGContextRef context = UIGraphicsGetCurrentContext();       
        CGContextClipToRect(context,
             CGRectMake(0.0, 0.0, rect.size.width, rect.size.height));      
        CGContextDrawTiledImage(context, imageRect, imageRef);
        ...
    } 
```

现在我正在尝试为该视图的调整大小设置动画。

```
[UIView beginAnimations:nil context:nil];
[UIView setAnimationDuration:0.3];

// change frame of view

[UIView commitAnimations]; 
```

我所期望的是平铺区域只会增长，而平铺尺寸保持不变。相反，当区域增长时，视图的原始内容被缩放到新的大小。至少在动画期间。所以动画的开头和结尾都很好。在动画过程中，瓷砖会变形。

CA 为什么要尝试扩展？我怎样才能防止它这样做？我错过了什么？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-05-05T09:01:21.213

如果 Core Animation 必须为每个动画帧回调你的代码，它永远不会像现在这样快，并且自定义属性的动画一直是 Mac 上 CA 的一项长期要求的功能和常见问题解答。

使用`UIViewContentModeRedraw`在正确的轨道上，也是您从 CA 获得的最好的。问题是从 UIKit 的角度来看，框架只有两个值：过渡开始时的值和过渡结束时的值，这就是您所看到的。如果您查看 Core Animation 架构文档，您会看到 CA 如何拥有所有层属性的私有表示形式，并且它们的值随时间变化。这就是帧插值发生的地方，当它们发生变化时，您无法收到通知。

所以唯一的方法是使用`NSTimer`（或`performSelector:withObject:afterDelay:`）随着时间的推移改变视图框架，这是老式的方式。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2010-12-12T14:33:17.700

您可能想看看 [http://www.nomadplanet.fr/2010/11/animate-calayer-custom-properties-with-coreanimation/](http://www.nomadplanet.fr/2010/11/animate-calayer-custom-properties-with-coreanimation/)

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2010-07-08T10:55:56.520

我在不同的上下文中遇到了类似的问题，我偶然发现了这个线程并发现了 Duncan 在 NSTimer 中设置框架的建议。我实现了这段代码来实现同样的目的：

```
CGFloat kDurationForFullScreenAnimation = 1.0;
CGFloat kNumberOfSteps = 100.0; // (kDurationForFullScreenAnimation / kNumberOfSteps) will be the interval with which NSTimer will be triggered.
int gCurrentStep = 0;
-(void)animateFrameOfView:(UIView*)inView toNewFrame:(CGRect)inNewFrameRect withAnimationDuration:(NSTimeInterval)inAnimationDuration numberOfSteps:(int)inSteps
{
    CGRect originalFrame = [inView frame];

    CGFloat differenceInXOrigin = originalFrame.origin.x - inNewFrameRect.origin.x;
    CGFloat differenceInYOrigin = originalFrame.origin.y - inNewFrameRect.origin.y;
    CGFloat stepValueForXAxis = differenceInXOrigin / inSteps;
    CGFloat stepValueForYAxis = differenceInYOrigin / inSteps;

    CGFloat differenceInWidth = originalFrame.size.width - inNewFrameRect.size.width;
    CGFloat differenceInHeight = originalFrame.size.height - inNewFrameRect.size.height;
    CGFloat stepValueForWidth = differenceInWidth / inSteps;
    CGFloat stepValueForHeight = differenceInHeight / inSteps;

    gCurrentStep = 0;
    NSArray *info = [NSArray arrayWithObjects: inView, [NSNumber numberWithInt:inSteps], [NSNumber numberWithFloat:stepValueForXAxis], [NSNumber numberWithFloat:stepValueForYAxis], [NSNumber numberWithFloat:stepValueForWidth], [NSNumber numberWithFloat:stepValueForHeight], nil];
    NSTimer *aniTimer = [NSTimer timerWithTimeInterval:(kDurationForFullScreenAnimation / kNumberOfSteps)
                                                target:self
                                              selector:@selector(changeFrameWithAnimation:)
                                              userInfo:info
                                               repeats:YES];
    [self setAnimationTimer:aniTimer];
    [[NSRunLoop currentRunLoop] addTimer:aniTimer
                                 forMode:NSDefaultRunLoopMode];
}

-(void)changeFrameWithAnimation:(NSTimer*)inTimer
{
    NSArray *userInfo = (NSArray*)[inTimer userInfo];
    UIView *inView = [userInfo objectAtIndex:0];
    int totalNumberOfSteps = [(NSNumber*)[userInfo objectAtIndex:1] intValue];
    if (gCurrentStep<totalNumberOfSteps)
    {
        CGFloat stepValueOfXAxis = [(NSNumber*)[userInfo objectAtIndex:2] floatValue];
        CGFloat stepValueOfYAxis = [(NSNumber*)[userInfo objectAtIndex:3] floatValue];
        CGFloat stepValueForWidth = [(NSNumber*)[userInfo objectAtIndex:4] floatValue];
        CGFloat stepValueForHeight = [(NSNumber*)[userInfo objectAtIndex:5] floatValue];

        CGRect currentFrame = [inView frame];
        CGRect newFrame;
        newFrame.origin.x = currentFrame.origin.x - stepValueOfXAxis;
        newFrame.origin.y = currentFrame.origin.y - stepValueOfYAxis;
        newFrame.size.width = currentFrame.size.width - stepValueForWidth;
        newFrame.size.height = currentFrame.size.height - stepValueForHeight;

        [inView setFrame:newFrame];

        gCurrentStep++;
    }
    else 
    {
        [[self animationTimer] invalidate];
    }
} 
```

我发现设置框架和计时器需要很长时间才能完成其操作。这可能取决于您使用这种方法调用 -setFrame 的视图层次结构有多深。可能这就是为什么视图首先重新调整大小然后动画到 sdk 中的原点的原因。或者，我的代码中的计时器机制是否存在一些问题，导致性能受到阻碍？

它可以工作，但是很慢，可能是因为我的视图层次结构太深了。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-05-08T22:45:03.570

正如 Duncan 所指出的，Core Animation 不会在调整大小时每帧重绘 UIView 层的内容。您需要自己使用计时器来执行此操作。

Omni 的人发布了一个很好的示例，说明如何根据您自己的可能适用于您的案例的自定义属性来制作动画。可以在[此处](http://blog.omnigroup.com/2008/11/14/animating-calayer-content/)找到该示例以及对其工作原理的说明。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-04-15T12:25:26.970

如果不是大型动画或动画持续时间的性能不是问题，则可以使用 CADisplayLink。例如，它确实平滑了自定义 UIView 绘图 UIBezierPaths 的缩放动画。下面是一个示例代码，您可以根据自己的图像进行调整。

我的自定义视图的 ivars 包含作为 CADisplayLink 的 displayLink，以及两个 CGRect：toFrame 和 fromFrame，以及 duration 和 startTime。

```
- (void)yourAnimationMethodCall
{
    toFrame = <get the destination frame>
    fromFrame = self.frame; // current frame.

    [displayLink removeFromRunLoop:[NSRunLoop currentRunLoop] forMode:NSRunLoopCommonModes]; // just in case    
    displayLink = [CADisplayLink displayLinkWithTarget:self selector:@selector(animateFrame:)];
    startTime = CACurrentMediaTime();
    duration = 0.25;
    [displayLink addToRunLoop:[NSRunLoop currentRunLoop] forMode:NSRunLoopCommonModes];
}

- (void)animateFrame:(CADisplayLink *)link
{
    CGFloat dt = ([link timestamp] - startTime) / duration;

    if (dt >= 1.0) {
        self.frame = toFrame;
        [displayLink removeFromRunLoop:[NSRunLoop currentRunLoop] forMode:NSRunLoopCommonModes];
        displayLink = nil;
        return;
    }

    CGRect f = toFrame;
    f.size.height = (toFrame.size.height - fromFrame.size.height) * dt + fromFrame.size.height;
    self.frame = f;
} 
```

请注意，我没有测试过它的性能，但它确实运行顺利。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2014-06-03T22:15:26.010

我在尝试为带有边框的 UIView 上的大小更改设置动画时偶然发现了这个问题。我希望同样到达这里的其他人可能会从这个答案中受益。最初我正在创建一个自定义 UIView 子类并覆盖 drawRect 方法，如下所示：

```
- (void)drawRect:(CGRect)rect
{
    CGContextRef ctx = UIGraphicsGetCurrentContext();

    CGContextSetLineWidth(ctx, 2.0f);
    CGContextSetStrokeColorWithColor(ctx, [UIColor orangeColor].CGColor);
    CGContextStrokeRect(ctx, rect);

    [super drawRect:rect];
} 
```

正如其他人所提到的，当与动画结合时，这会导致缩放问题。边框的顶部和底部会变得太厚或太薄，并出现缩放。当切换到慢速动画时，这种效果很容易被注意到。

解决方案是放弃自定义子类，而是使用这种方法：

```
[_borderView.layer setBorderWidth:2.0f];
[_borderView.layer setBorderColor:[UIColor orangeColor].CGColor]; 
```

这解决了在动画期间缩放 UIView 上的边框的问题。

# c++ - seekp() 在二进制模式下替换文件部分的问题

> ID：818208
> 
> 赞同：0
> 
> 时间：2009-05-03T22:37:10.350
> 
> 标签：c++, fstream

我在以二进制模式替换文件的一部分时遇到了一些麻烦。由于某种原因，我的 seekp() 行没有将文件指针放在所需的位置。现在它将新内容附加到文件的末尾，而不是替换所需的部分。

```
long int pos;
bool found = false;
fstream file(fileName, ios::binary|ios::out|ios::in);

file.read(reinterpret_cast<char *>(&record), sizeof(Person));

while (!file.eof())
{   
    if (record.getNumber() == number) {
       pos=file.tellg();
       found = true;
       break;
}

// the record object is updated here

file.seekp(pos, ios::beg); //this is not placing the file pointer at the desired place
file.write(reinterpret_cast<const char *>(&record), sizeof(Person));
cout << "Record updated." << endl;
file.close(); 
```

难道我做错了什么？

提前非常感谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-03T22:41:12.833

我看不出你的 while() 循环是如何工作的。通常，您不应该测试 eof() 而是测试读取操作是否有效。

以下代码将记录写入文件（必须存在），然后覆盖它：

```
#include <iostream>
#include <fstream>
using namespace std; 

struct P {
    int n;
};

int main() {
  fstream file( "afile.dat" , ios::binary|ios::out|ios::in);
  P p;
  p.n = 1;
  file.write( (char*)&p, sizeof(p) );
  p.n = 2;
  int pos = 0;
  file.seekp(pos, ios::beg);
  file.write( (char*)&p, sizeof(p) );
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-03T22:45:47.393

```
while (!file.eof())
{   
    if (record.getNumber() == number) {
       pos=file.tellg();
       found = true;
       break;
} 
```

在这里——你没有更新数字也没有记录——所以基本上你浏览了所有文件并写在“一些”位置（pos没有被初始化）

Neil Butterworth 是对的（在我输入 8 时发布））似乎你省略了 smth

# .net - 项目架构，使用 DDD

> ID：818217
> 
> 赞同：0
> 
> 时间：2009-05-03T22:42:25.937
> 
> 标签：.net, architecture, domain-driven-design

**要求**
项目应包含 1 个主应用程序和一些辅助子应用程序（使用相同的域对象，具有一些共享服务，但也有一些细微的不同 - 主应用程序不需要，因此 - 应该分开）。

通过可定制的搜索条件和用于检索这些条件的可能值的共享逻辑（例如作者的子搜索，以检索一本书），应该在大多数域对象（如果不是全部）上存在共享搜索服务（可能在不同的 DLL 中）通过它）。

**问题**
DDD 适合这里吗？如果是这样，我的项目结构应该是什么样子？（答案的最佳格式 - 结构化 DLL 列表 + 一些最重要的命名空间）。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-03T23:12:30.403

全局共享域类的想法听起来与 DDD 背道而驰。你读过这本书吗？

对于全局共享域类，上下文映射的空间很小。如果没有上下文映射，除了琐碎的应用程序之外，您将无法从 DDD 中获得什么优势。

# sql - 将 INCLUDE 列与 SQL Server 索引一起使用有什么好处？

> ID：818222
> 
> 赞同：9
> 
> 时间：2009-05-03T22:44:43.340
> 
> 标签：sql, performance

```
CREATE NONCLUSTERED INDEX index_name 
    ON <object> ( column [ ASC | DESC ] [ ,...n ] ) 
    [ INCLUDE ( column_name [ ,...n ] ) ]
    [ WHERE <filter_predicate> ] 
```

在上面的语法中，我们将在 INCLUDE 中指定非键列。指定非键列有什么好处？

* * *

## 回答 #1

> 赞同：33
> 
> 时间：2009-05-04T05:13:39.927

假设您有一个这样的员工表：

```
CREATE TABLE Employee(EmployeeID INT IDENTITY(1,1) PRIMARY KEY,
                      LastName VARCHAR(50),
                      FirstName VARCHAR(50),
                      HireDate DATETIME,
                      Salary DECIMAL) 
```

您将在 EmployeeID 上拥有主集群键，在 (LastName,FirstName) 上可能拥有非集群键，以便能够按姓名查找员工。

```
CREATE INDEX NameIndex ON Employee(LastName ASC, FirstName ASC) 
```

现在，如果您需要找到“Joe Murphy”并检索他的雇用日期和薪水，那么会发生在您的基于名称的非聚集键中的索引搜索（这很好），但是为了获取雇用日期和薪水，SQL Server 需要对实际表数据进行所谓的书签查找，以获取 Joe Murphy 的记录。这很可能会导致一次或多次物理磁盘访问（这在性能方面很糟糕）。

但是：如果您的基于名称的非聚集索引还指定“INCLUDE (HireDate, Salary)”：

```
CREATE INDEX NameIndex ON Employee(LastName ASC, FirstName ASC)
       INCLUDE (HireDate, Salary) 
```

然后 SQL Server 一旦在非聚集名称索引中查找 Joe Murphy 就完成了 --> 满足您查询的所有字段都在非聚集索引中，因此不再需要进行磁盘密集型书签查找和您的查询可能会更快。

INCLUDE 列的缺点是非聚集索引增加了磁盘空间需求，因为它们的叶级节点中包含包含的列。这是速度和大小之间的权衡（像往常一样）。

马克

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-05-03T22:55:25.437

使用索引时，它既可以导致完整记录的位置，也可以将您需要的所有字段存储在索引本身中（因此您不需要去完整记录。）

在第一种情况下，您有两种读取最佳情况，一种用于读取索引，另一种用于读取完整记录。

在第二种情况下，您可以通过阅读索引获得所需的一切。

如果与包含索引的字段一起，您可以满足完整的查询，而无需对该行进行额外读取，则您可以包含要与索引一起存储的额外列。

这不是 CLUSTERED 索引的问题，因为读取索引与读取整行相同。

如果您按顺序读取多个索引键（例如 SELECT ... FROM ... WHERE 键在 n1 和 n2 之间），则有一个特别大的优势，因为索引读取可能会彼此相邻存储并且可以使用也许只有一两个物理扇区；并且不需要查找其余记录提供了更多的杠杆作用。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-03T22:49:19.307

这将使用索引节点存储列的数据，以便快速访问使用索引的查询。

[参考](http://msdn.microsoft.com/en-us/library/ms188783.aspx)：

> 包括（列 [ ,... n ] ）
> 
> 指定要添加到非聚集索引的叶级别的非键列。非聚集索引可以是唯一的或非唯一的。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-03T22:56:33.423

如果查询使用包含的列，则无需进行键查找。例子。

```
select ssn, firstname from myusers where ssn='111-11-1111' 
```

适当的索引看起来像这样

```
create index idx_user_ssn nonclustered on myusers(ssn) include(firstname) 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2017-11-17T16:22:58.970

包含索引的优点是避免了大小限制。

```
SELECT AddressLine1, AddressLine2, City, StateProvinceID, PostalCode
FROM Person.Address
WHERE PostalCode BETWEEN N'98000' and N'99999' 
```

尽管您可以将所有列定义为键列，但键大小为 334 字节。我们在这里使用的唯一标准是 Postalcode ，在键列中使用 Postalcode 并在非键列上保留将提高性能并节省大小。

```
CREATE INDEX IX_Address_PostalCode
ON Person.Address (PostalCode)
INCLUDE (AddressLine1, AddressLine2, City, StateProvinceID); 
```

# mysql - mysql 5.4 有 linux 32 位版本吗？

> ID：818226
> 
> 赞同：2
> 
> 时间：2009-05-03T22:46:10.513
> 
> 标签：mysql, linux

MySQL 5.4 beta 能否在 Linux 下编译为 32 位处理器？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-03T23:04:41.577

当前的 beta 只有一些 64 位版本的二进制文件，但是如果您现在热衷于开始 beta 测试，您应该能够在 32 位系统上从源代码编译。（当然，这是一个测试版，所以不可靠是意料之中的——不要在生产中运行它，无论是在 32 位还是 64 位系统上！）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-03T23:01:38.947

根据此博客，它仅适用于 64 位机器。

[http://willysr.blogspot.com/2009/04/mysql-54-preview.html](http://willysr.blogspot.com/2009/04/mysql-54-preview.html)

或在这里

> 首先，MySQL 5.4 的预览版仅包括 InnoDB 可扩展性修复（解决更多 CPU/内核）。其次，目前仅限于 Solaris 和 Linux 64 位平台。本文中提到的其他功能和其他平台支持将很快出现，因此请尽快寻找即将发布的公告。 [http://74.125.93.132/search?q=cache:iLgUTcXAmGUJ:mirror.facebook.com/mysql/tech-resources/articles/mysql-54.html+mysql+5.4+64bit+only&cd=9&hl=en&ct=clnk&gl=我们&client=firefox-a](http://74.125.93.132/search?q=cache:iLgUTcXAmGUJ:mirror.facebook.com/mysql/tech-resources/articles/mysql-54.html+mysql+5.4+64bit+only&cd=9&hl=en&ct=clnk&gl=us&client=firefox-a)

谷歌缓存，因为该网站已关闭

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-03T23:01:55.687

如果你可以运行`./configure`并且`make`没有任何错误，它应该可以正常工作。

# opengl-es - Photoshop 混合模式到没有着色器的 OpenGL ES

> ID：818230
> 
> 赞同：18
> 
> 时间：2009-05-03T22:47:07.453
> 
> 标签：opengl-es, photoshop

我需要在我的 OpenGL ES 1.1 代码（**没有**着色器）中模仿 Photoshop 混合模式（“乘法”、“屏幕”等）。

有一些关于如何**使用**HLSL 执行此操作的文档：

*   [http://www.nathanm.com/photoshop-blending-math/（存档）](http://web.archive.org/web/20090222030436/http://nathanm.com/photoshop-blending-math)
*   [http://mouaif.wordpress.com/2009/01/05/photoshop-math-with-glsl-shaders/](http://mouaif.wordpress.com/2009/01/05/photoshop-math-with-glsl-shaders/)

我至少需要工作屏幕模式。

我可以查看固定管道上的任何实现吗？

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2009-05-03T23:29:22.843

大多数 Photoshop 混合模式都基于 Porter-Duff 混合模式。

这些要求您的所有图像（纹理、渲染缓冲区）都在预乘颜色空间中。这通常是通过将所有像素值与 alpha 值相乘，然后将它们存储到纹理中来完成的。例如，一个完全透明的像素在非预乘颜色空间中看起来像黑色。如果您不熟悉这种色彩空间，请花一两个小时在网上阅读有关它的信息。这是一个简洁而良好的概念，对于类似 Photoshop 的构图是必需的。

无论如何-一旦您拥有该格式的图像，您就可以使用以下方法启用 SCREEN：

```
glBlendFunc(GL_ONE, GL_ONE_MINUS_SRC_COLOR) 
```

OpenGL|ES 管道无法实现完整的 MULTIPLY 模式。如果您只使用完全不透明的像素，您可以使用以下方法伪造它：

```
glBlendFunc(GL_ZERO, GL_SRC_COLOR) 
```

但是，纹理和帧缓冲区中透明像素的结果将是错误的。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2010-04-01T19:52:58.907

你应该试试这个：

```
glBlendFunc(GL_DST_COLOR, GL_ONE_MINUS_SRC_ALPHA) 
```

这看起来像在 iPhone / OpenGL ES 上相乘

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-03T22:58:54.727

你最好的起点是拿起一本[红皮书](https://rads.stackoverflow.com/amzn/click/com/0321335732)，通读关于材料和混合模式的章节。它对“经典”OpenGL 混合函数的工作原理进行了非常全面和清晰的解释。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2011-03-24T17:01:30.283

我发现使用这个：

`glDepthFun( GL_LEQUAL);`

都需要获得屏幕效果，至少它在我的项目中运行良好。

我不确定为什么会这样，但如果有人知道请分享。

# java-me - 未选择默认单选按钮（J2ME、Java）

> ID：818235
> 
> 赞同：1
> 
> 时间：2009-05-03T22:50:07.447
> 
> 标签：java-me, midp, lcdui

目前正在开发 J2ME 中的移动应用程序，并且对 ChoiceGroup 单选按钮答案选项有疑问。关于如何制作以便不选择默认答案的任何建议？我们尝试过：

`cg8.setSelectedIndex( -1, true );`但是得到一个越界异常错误

和

`cg8.setSelectedFlags( boolean[] )`全部为假，但还会出现另一个错误。

为了解决这个问题，我们还尝试创建一个不可见的单选按钮并将其设置为选中状态，但也找不到制作不可见单选按钮的方法。

任何想法或建议将不胜感激！！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-03T22:53:08.517

在我看来，该平台正在执行适当的约定，尽管我必须为在这里采取纯粹主义立场而道歉；这不会真正回答你的问题。

单选按钮在有多个独占选择时使用，**必须**做出其中一个；因此，对于用户界面来说，确保始终选择某些东西是有一定意义的。理想情况下，无线电组中的初始选择应该始终是安全且合理的默认设置。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-05T11:26:45.000

据我所知，不预先选择任何单选按钮的唯一方法是自己绘制控件。使用 Canvas 或 CustomItem 重新实现单选按钮列表。

不幸的是，工作量很大。

您应该研究 LWUIT，因为它可能有一个中间解决方案。

# .net - 备份算法

> ID：818243
> 
> 赞同：0
> 
> 时间：2009-05-03T22:52:32.073
> 
> 标签：.net, windows, algorithm, backup

我正在考虑编写一个程序（.Net）来备份计算机上的文件。我将如何继续了解哪些文件已更改为备份（我真的不想每次都扫描上次修改的日期。

是否有任何备份算法仅备份文件的位已更改。该算法的 O 表示法是什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-03T22:57:33.683

检查[存档位](http://en.wikipedia.org/wiki/Archive_bit)。这可能是你想要的。

在 .NET 中它是`System.IO.FileAttributes.Archive`，它可以与 VB 中的 SetAttr 一起使用，`System.IO.FileInfo.Attributes`或者`System.IO.File.SetAttributes()`.

检查最后修改时间或存档位的任何算法都将取决于驱动器上的目录数。由于这两个属性都存储在目录中，因此时间将取决于文件系统及其缓存级别。分析备份效率的一种更有效的方法可能是查看已更改的块数。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-03T22:54:26.860

我可以建议在您最喜欢的搜索引擎中搜索“rsync for windows”吗？

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-03T23:01:15.593

您不会逃避扫描所有文件，但这仅限于读取目录扇区。平均驾驶仍然需要一段时间。除了文件日期之外，每个文件条目上都有一个存档位。备份文件后不要忘记清除它。

所以复杂度将是 O(n)，其中 n 是文件的数量。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-03T22:57:04.980

这是我在脚本中用于备份的非常好的简单内容：http: [//www.mikerubel.org/computers/rsync_snapshots/](http://www.mikerubel.org/computers/rsync_snapshots/)。

基于此，第一种方法是建立一个文件修改时间数据库，并在每次制作备份副本时比较/更新它们。除了日期时间，我还会保留文件大小并将其添加到比较中。

# bash - 在shell中，“ 2>&1 ”是什么意思？

> ID：818255
> 
> 赞同：2767
> 
> 时间：2009-05-03T22:57:00.817
> 
> 标签：bash, shell, unix, redirect

在 Unix shell 中，如果我想合并`stderr`并`stdout`进入`stdout`流以进行进一步操作，我可以在命令末尾附加以下内容：

```
2>&1 
```

所以，如果我想`head`在 的输出上使用`g++`，我可以这样做：

```
g++ lots_of_errors 2>&1 | head 
```

所以我只能看到前几个错误。

我总是很难记住这一点，而且我必须经常去查找它，这主要是因为我不完全理解这个特殊技巧的语法。

有人可以打破这个并逐字解释是什么`2>&1` 意思吗？

* * *

## 回答 #1

> 赞同：3098
> 
> 时间：2009-05-03T23:04:53.107

文件描述符 1 是标准输出 ( `stdout`)。
文件描述符 2 是标准错误 ( `stderr`)。

这是记住这个结构的一种方法（尽管它并不完全准确）：起初，`2>1`可能看起来像是重定向`stderr`到`stdout`. 但是，它实际上会被解释为“重定向`stderr`到一个名为`1`”的文件。`&`表示后面和前面的是文件描述符而不是文件名。所以构造变成：`2>&1`.

考虑`>&`作为重定向合并运营商。

* * *

## 回答 #2

> 赞同：799
> 
> 时间：2009-05-03T22:59:33.510

```
echo test > afile.txt 
```

将标准输出重定向到`afile.txt`. 这和做的一样

```
echo test 1> afile.txt 
```

要重定向 stderr，请执行以下操作：

```
echo test 2> afile.txt 
```

将*流***重定向**到另一个*文件描述符*`>&`的语法也是如此：

 *****   0 是标准输入
*   1 是标准输出
*   2 是标准错误

您可以通过执行以下操作将标准输出重定向到标准错误：

```
echo test 1>&2 # or echo test >&2 
```

或相反亦然：

```
echo test 2>&1 
```

所以，简而言之......`2>`将stderr重定向到（未指定）文件，将重定向stderr附加`&1`到stdout。

* * *

## 回答 #3

> 赞同：379
> 
> 时间：2013-04-29T16:33:06.523

## 关于重定向的一些技巧

关于这一点的一些语法特殊性可能具有重要的行为。有一些关于重定向、`STDERR`、`STDOUT`和参数**排序**的小示例。

### 1 - 覆盖或附加？

符号`>`表示*重定向*。

*   `>`表示*作为一个完整的文件发送到*，如果存在则覆盖目标（请参阅后面的*#3*`noclobber`中的 bash 功能）。
**   `>>`表示*发送除了*将附加到目标（如果存在）。*

 *无论如何，如果文件不存在，则将创建该文件。

### 2 - *shell 命令行*是顺序依赖的！！

为了测试这一点，我们需要*一个简单的命令，它将在两个输出上发送一些东西*：

```
$ ls -ld /tmp /tnt
ls: cannot access /tnt: No such file or directory
drwxrwxrwt 118 root root 196608 Jan  7 11:49 /tmp

$ ls -ld /tmp /tnt >/dev/null
ls: cannot access /tnt: No such file or directory

$ ls -ld /tmp /tnt 2>/dev/null
drwxrwxrwt 118 root root 196608 Jan  7 11:49 /tmp 
```

（当然，期望您没有名为 的目录`/tnt`；）。好吧，我们有它！

那么，让我们看看：

```
$ ls -ld /tmp /tnt >/dev/null
ls: cannot access /tnt: No such file or directory

$ ls -ld /tmp /tnt >/dev/null 2>&1

$ ls -ld /tmp /tnt 2>&1 >/dev/null
ls: cannot access /tnt: No such file or directory 
```

最后一个命令行转储`STDERR`到控制台，这似乎不是预期的行为......但是......

如果您想对*标准*输出、*错误*输出或两者进行一些*后期过滤：*

 **```
$ ls -ld /tmp /tnt | sed 's/^.*$/<-- & --->/'
ls: cannot access /tnt: No such file or directory
<-- drwxrwxrwt 118 root root 196608 Jan  7 12:02 /tmp --->

$ ls -ld /tmp /tnt 2>&1 | sed 's/^.*$/<-- & --->/'
<-- ls: cannot access /tnt: No such file or directory --->
<-- drwxrwxrwt 118 root root 196608 Jan  7 12:02 /tmp --->

$ ls -ld /tmp /tnt >/dev/null | sed 's/^.*$/<-- & --->/'
ls: cannot access /tnt: No such file or directory

$ ls -ld /tmp /tnt >/dev/null 2>&1 | sed 's/^.*$/<-- & --->/'

$ ls -ld /tmp /tnt 2>&1 >/dev/null | sed 's/^.*$/<-- & --->/'
<-- ls: cannot access /tnt: No such file or directory ---> 
```

请注意，本段中的最后一个命令行与上一段完全相同，我在其中写*的似乎不是预期的行为*（因此，这甚至可能是预期的行为）。

好吧，有一些关于重定向的小技巧，用于**对两个输出进行不同的操作**：

```
$ ( ls -ld /tmp /tnt | sed 's/^/O: /' >&9 ) 9>&2  2>&1  | sed 's/^/E: /'
O: drwxrwxrwt 118 root root 196608 Jan  7 12:13 /tmp
E: ls: cannot access /tnt: No such file or directory 
```

**注意**：`&9`描述符会因为`) 9>&2`.

**附录：注意！**使用新版本的[bash](/questions/tagged/bash "显示标记为“bash”的问题") ( `>4.0`) 有一个新功能和更性感的语法来做这种事情：

```
$ ls -ld /tmp /tnt 2> >(sed 's/^/E: /') > >(sed 's/^/O: /')
O: drwxrwxrwt 17 root root 28672 Nov  5 23:00 /tmp
E: ls: cannot access /tnt: No such file or directory 
```

最后对于这样的级联输出格式：

```
$ ((ls -ld /tmp /tnt |sed 's/^/O: /' >&9 ) 2>&1 |sed 's/^/E: /') 9>&1| cat -n
     1  O: drwxrwxrwt 118 root root 196608 Jan  7 12:29 /tmp
     2  E: ls: cannot access /tnt: No such file or directory 
```

**附录：注意！**相同的新语法，两种方式：

```
$ cat -n <(ls -ld /tmp /tnt 2> >(sed 's/^/E: /') > >(sed 's/^/O: /'))
     1  O: drwxrwxrwt 17 root root 28672 Nov  5 23:00 /tmp
     2  E: ls: cannot access /tnt: No such file or directory 
```

通过`STDOUT`特定过滤器，`STDERR`到另一个过滤器，最后合并的两个输出通过第三个命令过滤器。

### 2b -`|&`改为使用

语法`command |& ...`可以*用作*`command 2>&1 | ...`. _ 关于命令行顺序的相同规则适用。更多详细信息，请参阅[bash 中运算符 |& 的含义是什么？](https://stackoverflow.com/a/70766960/1765658)

### 3 - 关于`noclobber`选项和`>|`语法的一句话

那是关于**覆盖**：

虽然`set -o noclobber`指示 bash**不**覆盖任何现有文件，但`>|`语法允许您通过此限制：

```
$ testfile=$(mktemp /tmp/testNoClobberDate-XXXXXX)

$ date > $testfile ; cat $testfile
Mon Jan  7 13:18:15 CET 2013

$ date > $testfile ; cat $testfile
Mon Jan  7 13:18:19 CET 2013

$ date > $testfile ; cat $testfile
Mon Jan  7 13:18:21 CET 2013 
```

文件每次都会被覆盖，现在好了：

```
$ set -o noclobber

$ date > $testfile ; cat $testfile
bash: /tmp/testNoClobberDate-WW1xi9: cannot overwrite existing file
Mon Jan  7 13:18:21 CET 2013

$ date > $testfile ; cat $testfile
bash: /tmp/testNoClobberDate-WW1xi9: cannot overwrite existing file
Mon Jan  7 13:18:21 CET 2013 
```

通过`>|`：

```
$ date >| $testfile ; cat $testfile
Mon Jan  7 13:18:58 CET 2013

$ date >| $testfile ; cat $testfile
Mon Jan  7 13:19:01 CET 2013 
```

取消设置此选项和/或询问是否已设置。

```
$ set -o | grep noclobber
noclobber           on

$ set +o noclobber

$ set -o | grep noclobber
noclobber           off

$ date > $testfile ; cat $testfile
Mon Jan  7 13:24:27 CET 2013

$ rm $testfile 
```

### 4 - 最后一招和更多...

对于从给定命令重定向**两个**输出，我们看到正确的语法可能是：

```
$ ls -ld /tmp /tnt >/dev/null 2>&1 
```

对于这种*特殊*情况，有一个快捷语法：`&>`... 或`>&`

```
$ ls -ld /tmp /tnt &>/dev/null

$ ls -ld /tmp /tnt >&/dev/null 
```

注意：如果**`2>&1`**存在，**`1>&2`**也是正确的语法：

```
$ ls -ld /tmp /tnt 2>/dev/null 1>&2 
```

### 4b- 现在，我让你想想：

```
$ ls -ld /tmp /tnt 2>&1 1>&2  | sed -e s/^/++/
++/bin/ls: cannot access /tnt: No such file or directory
++drwxrwxrwt 193 root root 196608 Feb  9 11:08 /tmp/

$ ls -ld /tmp /tnt 1>&2 2>&1  | sed -e s/^/++/
/bin/ls: cannot access /tnt: No such file or directory
drwxrwxrwt 193 root root 196608 Feb  9 11:08 /tmp/ 
```

### 4c-如果您对*更多*信息感兴趣

您可以通过点击阅读精美的手册：

```
man -Len -Pless\ +/^REDIRECTION bash 
```

在[bash](/questions/tagged/bash "显示标记为“bash”的问题")控制台中；-)

* * *

## 回答 #4

> 赞同：165
> 
> 时间：2016-10-29T13:04:32.983

我发现这篇关于重定向的精彩帖子：*[All about redirections](http://www.catonmat.net/blog/bash-one-liners-explained-part-three/)*

**将标准输出和标准错误都重定向到文件**

> $ 命令 &> 文件

这个单线使用`&>`运算符将​​两个输出流（stdout 和 stderr）从命令重定向到文件。这是 Bash 将两个流快速重定向到同一目的地的快捷方式。

以下是 Bash 重定向两个流后文件描述符表的样子：

[![在此处输入图像描述](https://i.stack.imgur.com/huKF2.png)](https://i.stack.imgur.com/huKF2.png)

如您所见，stdout 和 stderr 现在都指向`file`. 因此，写入 stdout 和 stderr 的任何内容都会写入`file`.

有几种方法可以将两个流重定向到同一个目的地。您可以一个接一个地重定向每个流：

> $ 命令>文件 2>&1

这是将两个流重定向到文件的更常见的方法。首先将 stdout 重定向到文件，然后将 stderr 复制为与 stdout 相同。所以两个流最终都指向`file`.

当 Bash 看到几个重定向时，它会从左到右处理它们。让我们通过这些步骤，看看这是如何发生的。在运行任何命令之前，Bash 的文件描述符表如下所示：

[![在此处输入图像描述](https://i.stack.imgur.com/1gsdY.png)](https://i.stack.imgur.com/1gsdY.png)

现在 Bash 处理第一个重定向 >file。我们以前见过这个，它使标准输出指向文件：

[![在此处输入图像描述](https://i.stack.imgur.com/Ls39g.png)](https://i.stack.imgur.com/Ls39g.png)

Next Bash 看到第二个重定向 2>&1。我们以前没有见过这种重定向。这将文件描述符 2 复制为文件描述符 1 的副本，我们得到：

[![在此处输入图像描述](https://i.stack.imgur.com/KnuSt.png)](https://i.stack.imgur.com/KnuSt.png)

两个流都已重定向到文件。

不过这里要小心！写作

> 命令>文件2>&1

不等于写：

> $ 命令 2>&1 > 文件

重定向的顺序在 Bash 中很重要！此命令仅将标准输出重定向到文件。stderr 仍将打印到终端。要了解为什么会发生这种情况，让我们再次执行这些步骤。所以在运行命令之前，文件描述符表如下所示：

[![在此处输入图像描述](https://i.stack.imgur.com/OYgDd.png)](https://i.stack.imgur.com/OYgDd.png)

现在 Bash 处理从左到右的重定向。它首先看到 2>&1，因此它将 stderr 复制到 stdout。文件描述符表变为：

[![在此处输入图像描述](https://i.stack.imgur.com/Jef1c.png)](https://i.stack.imgur.com/Jef1c.png)

现在 Bash 看到第二个重定向，`>file`并将标准输出重定向到文件：

[![在此处输入图像描述](https://i.stack.imgur.com/LR04L.png)](https://i.stack.imgur.com/LR04L.png)

你看到这里发生了什么吗？标准输出现在指向文件，但标准错误仍然指向终端！写入 stderr 的所有内容仍会打印到屏幕上！所以要非常非常小心重定向的顺序！

另请注意，在 Bash 中，写作

> $ 命令 &> 文件

与以下内容完全相同：

> $ 命令>&文件

* * *

## 回答 #5

> 赞同：114
> 
> 时间：2009-05-03T22:58:41.060

这些数字指的是文件描述符 (fd)。

*   零是`stdin`
*   一个是`stdout`
*   二是`stderr`

`2>&1`将 fd 2 重定向到 1。

如果程序使用它们，这适用于任意数量的文件描述符。

`/usr/include/unistd.h`如果您忘记了它们，您可以查看：

```
/* Standard file descriptors.  */
#define STDIN_FILENO    0   /* Standard input.  */
#define STDOUT_FILENO   1   /* Standard output.  */
#define STDERR_FILENO   2   /* Standard error output.  */ 
```

也就是说，我已经编写了使用非标准文件描述符进行自定义日志记录的 C 工具，因此除非将其重定向到文件或其他内容，否则您看不到它。

* * *

## 回答 #6

> 赞同：61
> 
> 时间：2009-05-03T23:54:30.460

该构造将标准错误流 ( `stderr`) 发送到标准输出 ( ) 的*当前*位置`stdout`- 这个货币问题似乎已被其他答案忽略。

您可以使用此方法将任何输出句柄重定向到另一个输出句柄，但它最常用于将通道`stdout`和`stderr`流式传输到单个流中进行处理。

一些例子是：

```
# Look for ERROR string in both stdout and stderr.
foo 2>&1 | grep ERROR

# Run the less pager without stderr screwing up the output.
foo 2>&1 | less

# Send stdout/err to file (with append) and terminal.
foo 2>&1 |tee /dev/tty >>outfile

# Send stderr to normal location and stdout to file.
foo >outfile1 2>&1 >outfile2 
```

请注意，最后一个*不会*指向- 它会将其重定向到`stderr`遇到参数时的内容 ( )，*然后*重定向到.`outfile2``stdout``outfile1`*`stdout``outfile2`*

 *这允许一些非常复杂的诡计。

* * *

## 回答 #7

> 赞同：55
> 
> 时间：2020-04-01T16:32:47.237

如果您是初学者，我发现这非常有帮助阅读[此](https://www.brianstorti.com/understanding-shell-script-idiom-redirect/)

更新：
在 Linux 或 Unix 系统中，程序将输出发送到两个地方：**标准输出 (stdout) 和标准错误 (stderr)**。您可以将这些输出重定向到任何文件。

就像你这样做一样

`ls -a > output.txt`

，控制台中不会打印任何内容，所有输出**（stdout）**都被重定向到输出文件。

如果您尝试打印任何不存在的文件的内容，则意味着输出将是一个错误，例如您打印当前目录中不存在的 test.txt

`cat test.txt > error.txt`

输出将是

```
cat: test.txt :No such file or directory 
```

但是 error.txt 文件将是空的，因为我们将标准输出重定向到一个文件而不是标准错误。

所以我们需要文件描述符（文件描述符只不过是一个代表打开文件的正整数。你可以说描述符是文件的唯一ID）来告诉shell我们将哪种类型的输出发送到文件。在Unix / Linux系统中**1 用于 stdout ， 2 用于 stderr**。

所以现在如果你这样做

`ls -a 1> output.txt`意味着你正在将标准输出（stdout）发送到 output.txt。

如果你这样做

`cat test.txt 2> error.txt`意味着你将标准错误（stderr）发送到 error.txt 。

`&1`用于引用文件描述符 1 (stdout) 的值。

现在重点`2>&1`是“将标准错误重定向到我们重定向标准输出的同一位置”<br>
现在你可以做到这一点
<br

`cat maybefile.txt > output.txt 2>&1`

标准输出 (stdout) 和标准错误 (stderr) 都将重定向到 output.txt。

感谢[Ondrej K.](https://stackoverflow.com/users/9288200/ondrej-k)指出

* * *

## 回答 #8

> 赞同：23
> 
> 时间：2013-07-19T03:23:44.493

2 是控制台标准错误。

1 是控制台标准输出。

这是标准的 Unix，Windows 也遵循 POSIX。

例如，当你跑步时

```
perl test.pl 2>&1 
```

标准错误被重定向到标准输出，因此您可以同时看到两个输出：

```
perl test.pl > debug.log 2>&1 
```

执行后，您可以在 debug.log 中看到所有输出，包括错误。

```
perl test.pl 1>out.log 2>err.log 
```

然后标准输出到out.log，标准错误到err.log。

我建议你试着理解这些。

* * *

## 回答 #9

> 赞同：22
> 
> 时间：2016-12-25T06:43:43.113

`2>&1`是一个 POSIX shell 构造。这是一个逐个标记的细分：

* * *

`2`：“**标准错误**”输出文件描述符。

`>&`：[**复制输出文件描述符**](http://pubs.opengroup.org/onlinepubs/9699919799/utilities/V3_chap02.html#tag_18_07_06)运算符（[**输出重定向**](http://pubs.opengroup.org/onlinepubs/9699919799/utilities/V3_chap02.html#tag_18_07_02)运算符的变体`>`）。给定`[x]>&[y]`，由 表示的文件描述符`x`是输出文件描述符的副本`y`。

`1`“**标准输出**”输出文件描述符。

该表达式`2>&1`将文件描述符复制`1`到 location `2`，因此在执行环境中写入`2`（“标准错误”）的任何输出都会转到最初由`1`（“标准输出”）描述的同一文件。

* * *

进一步说明：

[**文件描述符**](http://pubs.opengroup.org/onlinepubs/9699919799/basedefs/V1_chap03.html#tag_03_166)：“每个进程唯一的非负整数，用于识别打开的文件以进行文件访问。”

**标准输出/错误：请参阅 shell 文档的**[重定向](http://pubs.opengroup.org/onlinepubs/9699919799/utilities/V3_chap02.html#tag_18_07)部分中的以下注释：

> 打开的文件由从零开始的十进制数字表示。最大可能值是实现定义的；但是，所有实现都应支持至少 0 到 9（含），以供应用程序使用。这些数字称为“文件描述符”。值 0、1 和 2 具有特殊含义和常规用途，并且由某些重定向操作隐含；它们分别称为标准输入、标准输出和标准错误。程序通常从标准输入中获取输入，并将输出写入标准输出。错误消息通常写在标准错误上。重定向运算符前面可以有一个或多个数字（不允许插入字符）来指定文件描述符编号。

* * *

## 回答 #10

> 赞同：19
> 
> 时间：2009-05-03T23:24:58.690

回答您的问题：它需要任何错误输出（通常发送到 stderr）并将其写入标准输出（stdout）。

例如，当您需要对所有输出进行分页时，这对“更多”很有帮助。一些程序喜欢将使用信息打印到标准错误中。

为了帮助你记住

*   1 = 标准输出（程序打印正常输出）
*   2 = 标准错误（程序打印错误）

"2>&1" 只是将发送到 stderr 的所有内容指向 stdout。

我还建议阅读[这篇关于错误重定向的帖子，](http://www.cyberciti.biz/faq/redirecting-stderr-to-stdout/)其中详细介绍了该主题。

* * *

## 回答 #11

> 赞同：11
> 
> 时间：2015-12-03T10:20:34.850

从程序员的角度来看，这恰恰意味着：

```
dup2(1, 2); 
```

请参阅[手册页](http://linux.die.net/man/2/dup2)。

理解那`2>&1`是一个*副本*也解释了为什么......

```
command >file 2>&1 
```

……不等于……

```
command 2>&1 >file 
```

第一个将两个流发送到`file`，而第二个将错误发送到`stdout`，并将普通输出发送到`file`。

* * *

## 回答 #12

> 赞同：8
> 
> 时间：2012-07-01T10:47:27.220

人们，永远记住*paxdiablo*关于重定向目标**当前位置的提示......这****很**重要。

我对操作员的个人记忆`2>&1`是这样的：

*   认为`&`意义`'and'`或`'add'`（字符是*安培*-***和***，不是吗？）
*   所以它变成：*'redirect `2`(stderr) to where `1`(stdout) already/currently is and **add** both streams'*。

相同的助记符也适用于其他常用的重定向`1>&2`：

*   想想`&`意义`and`或`add`......（你明白与号有关的想法，是吗？）
*   所以它变成： *'redirect `1`(stdout) to where `2`(stderr) already/currently is and **add** both streams'*。

**永远记住：你必须从右到左（而不是**从左到右）“从头到尾”阅读重定向链。

* * *

## 回答 #13

> 赞同：8
> 
> 时间：2015-06-06T11:07:35.943

> ## 重定向输入
> 
> 输入的重定向会导致名称由 word 扩展产生的文件打开以在文件描述符 n 上读取，或者如果未指定 n，则打开标准输入（文件描述符 0）。
> 
> 重定向输入的一般格式是：
> 
> ```
> [n]<word 
> ```
> 
> ## 重定向输出
> 
> 输出重定向会导致打开其名称来自 word 扩展的文件以写入文件描述符 n，或者如果未指定 n，则打开标准输出（文件描述符 1）。如果文件不存在，则创建它；如果确实存在，则将其截断为零大小。
> 
> 重定向输出的一般格式是：
> 
> ```
> [n]>word 
> ```
> 
> ## 移动文件描述符
> 
> 重定向运算符，
> 
> ```
> [n]<&digit- 
> ```
> 
> 如果未指定 n，则将文件描述符数字移动到文件描述符 n 或标准输入（文件描述符 0）。digit 被复制到 n 后关闭。
> 
> 同样，重定向运算符
> 
> ```
> [n]>&digit- 
> ```
> 
> 如果未指定 n，则将文件描述符数字移动到文件描述符 n 或标准输出（文件描述符 1）。

## 参考：

```
man bash 
```

键入`/^REDIRECT`以定位到该`redirection`部分，并了解更多...

在线版本在这里：*[3.6 重定向](http://www.gnu.org/software/bash/manual/bashref.html#Redirections)*

### PS：

很多时候，`man`它是学习 Linux 的强大工具。

* * *

## 回答 #14

> 赞同：7
> 
> 时间：2016-09-01T20:58:04.213

前提是`/foo`您的系统上不存在并且`/tmp`确实存在...</p>

```
$ ls -l /tmp /foo 
```

将打印内容`/tmp`并打印错误消息`/foo`

```
$ ls -l /tmp /foo > /dev/null 
```

将发送`/tmp`to的内容`/dev/null`并打印错误消息`/foo`

```
$ ls -l /tmp /foo 1> /dev/null 
```

会做同样的事情（注意**1**）

```
$ ls -l /tmp /foo 2> /dev/null 
```

将打印内容`/tmp`并将错误消息发送到`/dev/null`

```
$ ls -l /tmp /foo 1> /dev/null 2> /dev/null 
```

将列表和错误消息发送到`/dev/null`

```
$ ls -l /tmp /foo > /dev/null 2> &1 
```

是速记

* * *

## 回答 #15

> 赞同：5
> 
> 时间：2013-10-11T06:16:38.457

这就像将错误传递给标准输出或终端一样。

也就是说，`cmd`不是命令：

```
$cmd 2>filename
cat filename

command not found 
```

错误被发送到文件中，如下所示：

```
2>&1 
```

标准错误被发送到终端。

* * *

## 回答 #16

> 赞同：3
> 
> 时间：2020-01-25T20:50:25.747

`unix_commands 2>&1`

这用于将错误打印到终端。

**下面说明过程**

*   当产生错误时，它们被写入标准错误内存地址`&2`“缓冲区”，标准错误流从中`2`引用。
*   当产生输出时，它被写入标准输出内存地址`&1`“缓冲区”，标准输出流从中`1`引用。

因此，获取`unix_commands`标准错误流`2`，并将（错误的）流重定向`>`到标准输出内存地址`&1`，以便将它们流式传输到终端并打印。

* * *

## 回答 #17

> 赞同：1
> 
> 时间：2016-07-25T09:46:19.240

0 表示输入，1 表示标准输出，2 表示标准错误。

**一个提示**： `somecmd >1.txt 2>&1`是正确的，而`somecmd 2>&1 >1.txt`完全**错误**的没有效果！

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2020-07-22T13:39:22.027

请注意，`1>&2`不能与 . 互换使用`2>&1`。

想象一下，您的命令取决于管道，例如：
`docker logs 1b3e97c49e39 2>&1 | grep "some log"`
grepping 将在两者之间发生`stderr`，`stdout`因为`stderr`基本上合并到`stdout`.

但是，如果您尝试 :
`docker logs 1b3e97c49e39 1>&2 | grep "some log"`，则
grepping 根本不会真正搜索任何地方，因为 Unix 管道正在通过 connect 连接进程`stdout | stdin`，并且`stdout`在第二种情况下被重定向到`stderr`Unix 管道不感兴趣的地方。

# c++ - C ++如何从包含的类中调用父类方法？

> ID：818259
> 
> 赞同：5
> 
> 时间：2009-05-03T22:57:51.530
> 
> 标签：c++, class

我正在尝试从包含的对象调用 Parent 类方法，但对以下代码没有运气。这样做的标准方法是什么？

我四处搜索，这似乎适用于继承的对象，但不适用于包含的对象。甚至称它为父类是否正确？还是称为 Owner 类？

```
class Parent{
private:
  Child mychild;

public:
  void doSomething();
}

class Child{
public:
  void doOtherThing();
}

void Child::doOtherThing(){
  Parent::doSomething();
} 
```

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-05-03T22:59:59.437

包含的对象对包含它的类没有特殊的访问权限，并且通常不知道它被包含。您需要以某种方式传递引用或指向包含类的指针 - 例如：

```
class Child{
public:
  void doOtherThing( Parent & p );
};

void Child::doOtherThing( Parent & p ){
   p.doSomething();
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-03T23:00:43.757

孩子与父类完全没有联系。您必须将“this”传递给孩子（可能在构造函数中）才能使其工作。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-03T23:00:39.387

如果孩子需要与父母交互，那么它需要一个对该对象的引用；目前，孩子还没有主人的概念。

# nlp - 用于搜索引擎的俄语文档语料库

> ID：818263
> 
> 赞同：1
> 
> 时间：2009-05-03T22:59:02.387
> 
> 标签：nlp, information-retrieval, documents, corpus

我正在研究一种跨语言信息检索，它接受英语查询并搜索俄语文档。要评估这个系统，最好有一组俄罗斯文档可供搜索。有没有人知道我可以搜索的文档集合或我可以轻松地将一堆俄罗斯文档（维基百科除外）拼凑在一起的网站？

文档可以是任何东西，但如果它们位于人类知识的某个特定领域（计算机科学、建筑、工程、艺术、文学分析等），那就太好了。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-03T23:13:31.463

不知道这是否是您要找的，但[这里有大量俄罗斯国家标准和法律](http://thepiratebay.org/torrent/4424710/Russian_GOSTs__amp__LAWs_-_all_database_2008.04_57.31_Gb)。它们采用 dBase4 格式，大约有 57.3 GB 的数据。

# iphone - 如何在 iphone 开发环境中通过 ID 获取 uicontrols

> ID：818285
> 
> 赞同：3
> 
> 时间：2009-05-03T23:05:49.780
> 
> 标签：iphone, uibutton

我刚刚开始学习 iphone API，并且我已经完成了大量的 windows 编程，并且我确信有一种方法，给定传递给事件处理程序的对象，来识别它的对象 id 或标签或其他东西。

我在界面生成器中创建了一系列 UIButton，每个都有一个对象 ID。但我只是看不到在 iphone API 的哪个位置可以从 UIButton 对象中获取该 ID。

我看到每个人都使用titleforstate，但这对我不起作用，因为他们都有相同的标题。还是我将图像放在按钮中并使用标题作为 ID？

界面构建器有一个“界面构建器身份”，我猜我无法从 iphone API 访问，对吗？

在按钮属性的“视图”部分中还有一个名为“标签”的设置，但它是一个数字。可以，但我也没有看到任何 API 调用来获取它。

我只是想弄清楚如何通过标题以外的方式识别 UI 控件。谢谢。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-05-03T23:10:25.043

它继承自 NSObject，你只需要调用 variable.tag

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-08-15T18:15:05.317

提供的答案对我来说很好，但它记录在哪里？我查看了 NSObject 协议参考，没有提到标签属性或方法。

```
-(IBAction) buttonPressed:(id)sender {
    int tagNum = [sender tag]; 
```

[编辑] 原来标签在[NSView](http://developer.apple.com/documentation/Cocoa/Reference/ApplicationKit/Classes/NSView_Class/Reference/NSView.html#//apple_ref/doc/uid/20000014-BBCBGFHJ)中，而不是 NSObject 中。任何从 NSView 继承的东西都有一个 tag 属性。

# java - 更改 JTable 单元格颜色

> ID：818287
> 
> 赞同：7
> 
> 时间：2009-05-03T23:07:15.610
> 
> 标签：java, swing, formatting, rendering, jtable

这让我彻底疯了。

我知道，要使用 JTable 更改表格单元格的格式，我必须使用自己的渲染器。但我似乎无法正确实施。

这是我目前的设置：

```
public class MyClass
{
    public static void main(String args[])
    {
        JTable myTable = new JTable(10, 10);
        myTable.setDefaultRenderer ([I dont know what to put here], new CustomRenderer());
    }
}

class CustomRenderer extends DefaultTableCellRenderer 
{
    public Component getTableCellRendererComponent(JTable table, Object value, boolean isSelected, boolean hasFocus, int row, int column)
    {
        Component c = super.getTableCellRendererComponent(table, value, isSelected, hasFocus, row, column);

        // Formatting
        return c;
    }
} 
```

我需要为 的第一个参数使用`setDefaultRenderer`什么？API 只是说“类”。我不知道该放什么。

有人可以用最简单的术语解释我如何实现这一点吗？请提供一个示例，说明如何从`main()`方法中更改格式。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-05-03T23:25:01.590

在 for 的第一个参数中`setDefaultRenderer`，放置要覆盖呈现的 Class的**类文字。**即，如果您的数据由所有字符串组成，您可以将

```
myTable.setDefaultRenderer(String.class, new CustomRenderer()); 
```

如果您的数据还包含带有类`BigDecimal`或作为类的值，则必须为每种类类型（或在每种情况下）`Integer`多次调用该方法。`BigDecimal.class``Integer.class`

最后，要更改背景颜色，请在渲染器中执行此操作：

```
class CustomRenderer extends DefaultTableCellRenderer 
{
    public Component getTableCellRendererComponent(JTable table, Object value, boolean isSelected, boolean hasFocus, int row, int column)
    {
        Component c = super.getTableCellRendererComponent(table, value, isSelected, hasFocus, row, column);
        c.setBackground(new java.awt.Color(255, 72, 72));
        return c;
    }
} 
```

如果您编写的渲染器应该适用于**接口的所有类**，您还需要修改**表模型**`getColumnClass`的功能并让它返回所有实现此接口的对象的接口类：

 **```
public Class<? extends Object> getColumnClass(int c) {
    Object object = getValueAt(0, c);
    if(object == null) {
        return Object.class;
    if(getValueAt(0, c) instanceof IColorable) {
        return ICarPart.class;
    } else {
        return getValueAt(0, c).getClass();
    }
} 
```

这样就可以为 IColorable.class 注册一个渲染器，并且不需要为每个实现注册一个单独的渲染器。

# ajax - 在 AJAX 表单加载的文本区域中使用“更新的 WMD 编辑器”

> ID：818288
> 
> 赞同：4
> 
> 时间：2009-05-03T23:08:05.250
> 
> 标签：ajax, symfony1, wmd, wmd-editor

我们正在尝试使用 Stackoverflow 出色的 WMD / Markdown 编辑[器](http://github.com/derobins/wmd/tree/master)（[http://blog.stackoverflow.com/2009/01/updated-wmd-editor/，http://github.com/derobins/wmd/tree/master](http://github.com/derobins/wmd/tree/master)）在 Symfony 项目上。

这在不涉及任何 AJAX 的文本区域上效果很好。但是当我们必须首先包含 wmd.js，然后在用户交互（即“单击链接”）通过 AJAX 加载文本区域时，我们完全无法使 WMD 工作，Firebug 给了我们

```
elem is null

addEvent()()wmd.js (Linie 110)
setupEvents()()wmd.js (Linie 1790)
init()()wmd.js (Linie 1970)
previewManager()()wmd.js (Linie 1987)
loadListener()()wmd.js (Linie 1763)

[Break on this error] if (elem.attachEvent) { 
```

在加载页面时（即在 textarea 加载之前）。

Symfony 的 AJAX 加载器似乎 eval() 标记之间的所有内容。我们尝试在这些标签之间直接包含整个脚本，我们尝试转义这个和那个，但没有成功，出现了不同的错误。

此时我们认为我们必须将脚本包含在普通页面中，并且在 AJAX 调用之后我们必须手动启动 WMD - 我们必须调用哪些函数？我们是否完全偏离了轨道，需要使用不同的方法？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-07-06T10:52:21.657

[github](http://github.com/derobins/wmd/tree/master)上 wmd 的 drobins fork 也在解决 AJAX 问题。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-07-12T15:47:45.180

你可以使用我的版本。只需将构造函数调用、配置值和对 start() 方法的调用放在处理您从 AJAX 请求获得的结果的回调函数中。[我的 mooWMD 版本。](http://moowmd.awardspace.info/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-09-24T20:49:53.080

我遇到了同样的问题，一旦我的 textarea 被异步添加到页面中，我就会初始化 WMD。

这是我的代码：

```
function loadTextEditor()
{
    var instances = [];

    if (!Attacklab || !Attacklab.wmd) {
                alert("WMD hasn't finished loading!");
                return;
            }
    /***** build the preview manager *****/
    var textArea = document.getElementById('postcontent');
    var previewPane = document.getElementById('postPreview');

    var panes = {input:textArea, preview:previewPane, output:null};
    var previewManager = new Attacklab.wmd.previewManager(panes);

    /***** build the editor and tell it to refresh the preview after commands *****/
    var editor = new Attacklab.wmd.editor(textArea,previewManager.refresh);

    // save everything so we can destroy it all later
    instances.push({ta:textarea, div:previewDiv, ed:editor, pm:previewManager});

} 
```

# c# - 扩展 DataContext 实体 - 在“子”类中使用 InsertOnSubmit(this)

> ID：818299
> 
> 赞同：2
> 
> 时间：2009-05-03T23:16:54.357
> 
> 标签：c#, linq-to-sql

我正在扩展这个 DataContext 实体，它看起来像这样：

```
namespace Entities
{
    public class User
    {
        public Int32 Id { get; set; }
        public String Username { get; set; }
    }
} 
```

.. 像这样：

```
public class User : Entities.User
{
    new public Int32 Id
    {
        get { return base.Id; }
    }

    public void Insert()
    {
        using (var dc = new DataContext())
        {
/*
The "this" keyword should match the type that InsertOnSubmit() expects.
And it does. But I get the following error:

System.NullReferenceException: {"Object reference not set to an instance
of an object."}
*/
            dc.Users.InsertOnSubmit(this); // Exception occurs here

            dc.SubmitChanges();
        }
    }
} 
```

我正在使用自定义用户类，如下所示：

```
var u = new User { Username = "Test" };

u.Insert(); 
```

我不明白的是：我已经实例化了这个类，那么为什么我会得到一个 NullReferenceException？

## 更新：

**扩展实体类：使用枚举器覆盖属性，同时仍然能够在`Insert`/`Update`和`DeleteOnSubmit`DataContext 实例上使用方法上的“this”关键字**

```
enum AccessLevels
{
    Basic,
    Administrator
}

namespace Entities
{
    public class User
    {
        public Int32 Id { get; set; }
        public String Username { get; set; }
        public Int32 AccessLevel { get; set; }
    }
} 
```

我将如何扩展或更改上述实体类并实现`AcessLevels`枚举器，替换`AccessLevel`属性？--this 不更改实体类的签名，因此我可以在`Insert`/上使用“this”关键字`Update`和`DeleteOnSubmit`DataContexts 上的方法.

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-03T23:28:02.847

您不能通过继承以这种方式扩展 LINQ-to-SQL 实体类型 - 您应该改为使用 a`partial class`向*现有*生成的实体添加额外的方法。因为 LINQ-to-SQL 支持继承（用于区分表等），所以它期望与已知实体类型**完全匹配 - 而不是意外的子类。**

IE

```
namespace Entities {
    partial class User {
        /* your extra method(s) here */
    }
} 
```

在上面，这与 Designer.cs 中的部分类*相结合*来创建你的类型。

另一种方法（如果不能选择部分类）是通过扩展方法。

```
static class EntityExtensions {
    public static void SomeMethod(this User user) {...}
} 
```

如果类型之间有共同的方法，您可以通过声明一个接口、*在*该接口上使用扩展方法以及使用分部类将接口添加到特定类型来做到这一点：

```
namespace Entities {
    partial class User : IFunkyInterface {
        /* interface implementation, if necessary */
    }
}

static class EntityExtensions {
    public static void SomeMethod(this IFunkyInterface obj)
    {...}
} 
```

或者如果您需要知道类型：

```
static class EntityExtensions {
    public static void SomeMethod<T>(this T obj)
          where T : class, IFunkyInterface
    {...}
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-04T09:16:49.297

重新进行枚举编辑（作为第二个答案添加以保持简单）...

首先 - 枚举和值之间是否存在直接的 1:1 映射？例如，如果 Basic 为 7，Administrator 为 12，则：

```
enum AccessLevels
{
    Basic = 7,
    Administrator = 12
} 
```

然后将 dbml（通过设计器）中该属性的类型从 int 更改为您的（完全限定的）枚举：`Entities.AccessLevel`。LINQ-to-SQL 支持将枚举作为直接整数映射或作为直接字符串映射。

如果这不可能（更复杂的场景），您可以隔离存储（int）和面向对象（enum）模型；将属性重命名为`AccessLevelStorage`（或您喜欢的任何其他名称），并在部分类中进行映射：

```
partial class User {
    public AccessLevel AccessLevel {
        get {
            switch(AccessLevelStorage) {
                case 1: return AccessLevelStorage.Foo;
                ... etc
                default: ...throw an exception?
            }
         }
         set {
            switch(value) {
                case AccessLevel.Foo: AccessLevelStorage = 1; break;
                ...etc
                default: ...throw an exception?
            }
         }
} 
```

这里唯一需要注意的是 LINQ 查询只对*存储*属性起作用 - 而不是自定义映射属性。如果您在声明上下文的级别上进行查询，则可以将存储属性的访问权限更改为`internal`- 但如果您在此程序集之外进行查询，则需要保持公开状态。您可能想要添加`[Browsable(false)]`以阻止它出现在 UI 模型中，但仅此而已。

# database - 稀疏数值数据（例如倒排索引）的存储——有什么约定吗？

> ID：818301
> 
> 赞同：0
> 
> 时间：2009-05-03T23:17:17.570
> 
> 标签：database, matrix, search-engine

是否有一种可接受的方式来存储和访问稀疏数值数据（例如搜索引擎的倒排索引/按文档矩阵排列的术语）？RDBMS 似乎不适合此类数据，但最好将其存储在某种数据库中（保存到磁盘、作为服务器运行等）。此类问题是否有公认的解决方案（例如能够支持此类模型的现有数据库）？有谁知道谷歌如何如此快速地存储和访问他们的索引？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-03T23:22:57.150

在此处查看有关[Google](http://highscalability.com/google-architecture)的更多信息以及指向更多信息的链接。

# hex - 在 MIPS 中将十六进制字符转换为十进制等效值

> ID：818303
> 
> 赞同：1
> 
> 时间：2009-05-03T23:19:19.297
> 
> 标签：hex, decimal, mips, converter

如何获取单个 ASCII 字符并将其转换为 MIP 中的十进制等效值？

我是否只需要有一些条件才能从 ascii 代码中减去一定数量以使其成为十进制表示形式？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-04T00:28:12.330

这是 Pax 所写内容的简单实现（它假设十六进制数字 - A 到 F 始终为大写）

**文件 hextodec.c**

```
#include <stdio.h>

/*
*Converts an ASCII char to its decimal equivalent.
*Returns -1 on error.
*
*/
extern int hextodec(char* c);

int main(int argc,char **argv){
        int i=0;
        char digits[]={'0','1','2','3','4','5','6','7','8','9','A','B','C','D','F'};

        for (;i<16;i++){
                printf("%c\t%d\n",digits[i],hextodec(digits+i));
        }
        return 0;
} 
```

**文件 hextodec.S**

```
#include <mips/regdef.h>

/* int hextodec(char* c) 
 *  first (and only) argument is set in register a0.
 *  return value is set in register v0.
 *  function calling convention is ignored.
 */
        .text
        .globl hextodec
        .align 2
        .ent hextodec

hextodec:

        lbu     t0,0(a0)        #load byte from argument

        li      t1,0X30
        li      t2,0x39

        andi    t1,t1,0x000000ff #Cast to word for comparison.
        andi    t2,t2,0x000000ff

        bltu    t0,t1,ERROR     #error if lower than 0x30
        bgt     t0,t2,dohex     #if greater than 0x39, test for A -F

        addiu   t0,t0,-0x30     #OK, char between 48 and 55\. Subtract 48.
        b       return

dohex:  li      t1,0x41
        li      t2,0x46

        andi   t1,t1,0x000000ff #Cast to word for comparison.
        andi   t2,t2,0x000000ff

        /*is byte is between 65 and 70?*/

        bltu    t0,t1,ERROR     #error if lower than 0x41
        bgt     t0,t2,ERROR     #error if greater than 0x46

ishex:  addiu   t0,t0,-0x37     #subtract 55 from hex char ('A'- 'F')
        b       return

ERROR:  addiu   t0,zero,-1      #return -1.

return: move    v0,t0           #move return value to register v0

        jr      ra
        .end    hextodec 
```

**测试运行**

```
root@:~/stackoverflow# ./hextodec 
0       0
1       1
2       2
3       3
4       4
5       5
6       6
7       7
8       8
9       9
A       10
B       11
C       12
D       13
E       14
F       15
root@:~/stackoverflow# 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-04T00:01:20.287

应检查单个十六进制字符是否在范围内

*   “0”到“9”（48 到 57），
*   “A”到“F”（65 到 70），或
*   “a”到“f”（97 到 102）。

其他任何事情都是错误。如果它确实属于这些范围之一，请执行以下操作：

*   减去 48（将“0”-“9”降为 0-9）。
*   如果它仍然大于 9，则减去 7（将 'A'-'F' 降低到 10-15）。
*   如果它仍然大于 15，则减去 32（将 'a'-'f' 降低到 10-15）。

如果您确定非十进制数字的字符始终为大写，则可以跳过上面每个列表中的第三步，但不需要很多额外的代码即可。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-03T23:35:17.387

是的，从 ASCII 值中减去 48 可能是最简单的。

# json - 你如何遍历fortran中的数组？

> ID：818315
> 
> 赞同：7
> 
> 时间：2009-05-03T23:25:35.537
> 
> 标签：json, fortran

非常简单的问题。

说我有

```
real, dimension(0:100) :: realResults 
```

我想迭代realResults，最终创建表单数组的json

```
[[x1,y1], [x2,y2], [x3, y3], ... ] 
```

我很确定我想使用“do”，但我不确定如何使用

谢谢

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-05-03T23:40:41.833

在 Fortran 90 中，您可以进行数组迭代，例如：

```
do i = lbound(realResults), ubound(realResults)
  ! do something with realResults(i)
end do 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-03T23:39:49.217

FORTRAN 和 json 在同一段中？！？！怎么回事？也许是这样的：

```
 do 10 i = 0, 100
C        do something with realResults(i)
  10  continue 
```

# php - 我的电子邮件标题是否正确？

> ID：818321
> 
> 赞同：0
> 
> 时间：2009-05-03T23:28:14.220
> 
> 标签：php, mime

以下“发件人”标头是否不正确？

```
 // To send HTML mail, the Content-type header must be set
    $headers  = 'MIME-Version: 1.0' . "\r\n";
    $headers .= 'Content-type: text/html; charset=iso-8859-1' . "\r\n";
    // Additional headers
    $headers .= 'From: Mail Master <mail@mailmaster.com>' . "\r\n";
if(sendEmailNow($email, $subject, $body, $headers)){ 
```

我从我的邮件服务器收到错误。它说“来自错误的邮件：语法错误”。

感谢大家的帮助。

## 更新

我已将 SendEmailNow 函数剥离到下面，我得到了同样的错误：

```
//send an email
function sendEmailNow($email, $subject, $body, $headers){

    if (mail($email, $subject, $body, $headers)) {
      ##check email
      ##code to say email sent - compare with the number registered
      return true;
     }

     else {
      ##code to report an error 
      return false;
     }

 } 
```

## 更新 2

问题解决了。我正在使用 PHP 5 的 Windows 机器上运行它。就像选择的正确答案和评论所说的一样。一些邮件服务器无法理解我之前的内容。但对我有用的是：

```
$headers .= 'From: mail@mailmaster.com' . "\r\n"; 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-03T23:58:13.680

对错误消息的 Google 搜索表明某些 SMTP 服务器无法解析您的`From`标头语法。您可以尝试以下语法来排除这种可能性吗？

```
From: mail@mailmaster.com 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-03T23:30:24.900

除非正文为空，否则您可能需要额外的 CRLF 来终止标头。在不知道 API 的情况下，我不能说更多。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-04T00:12:41.523

不确定这是否有帮助，但这是我的 Python 应用程序中纯文本的输出标头：

```
内容类型：多部分/替代；
    边界="10.254.26.130.1.1364.1241389770.060.1"
发件人：用户 1 <user1@domain1.com>
收件人：User2 <user2@domain1.com>，User3 <user3@domain.com>
主题：实际主题
MIME 版本：1.0

--10.254.26.130.1.1364.1241389770.060.1
内容类型：文本/纯文本；
    charset="us-ascii"
内容传输编码：quoted-printable

从这里开始的实际文本内容...

```

同样，在不知道所有内容/标题的情况下很难说，但我猜要么a）您在内容之前遗漏了尾随的CRLF，要么b）早期的标题之一缺少它的CRLF。

抱歉，如果这将您带入了一个非常错误的方向。:)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-04T12:11:39.657

```
From: "User1" <user1@domain1.com> 
```

From 标头需要名称部分的引号。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2014-02-20T17:50:21.303

如果您在表单中设置“$userEmail”变量，您可以从他们那里得到它并回复。$email_id 是您的电子邮件地址。

```
 $to=$email_id;
        $headers = "From: " . strip_tags($userEmail) . "\r\n";
        $headers .= "Reply-To: ". strip_tags($userEmail) . "\r\n"; 
```

# functional-programming - SML/NJ 中的循环

> ID：818324
> 
> 赞同：6
> 
> 时间：2009-05-03T23:29:59.363
> 
> 标签：functional-programming, sml

我对 SNL/NJ 很陌生，想知道如何完成以下任务：

```
foo(stuff,counter)
{
   while(counter > 0)
   {
     bar(stuff);
     counter-1;
   }
   return;
} 
```

像这样的东西，但我如何减少？：

```
foo(stuff,counter) = 
   while counter > 0 do bar(stuff) ??? // how do I decrement counter here? 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-05-04T00:08:35.807

我同意其他贡献者的观点，即您通常应该使用递归而不是循环和变异来在函数式语言中执行此操作。

但是，如果您真的想使用突变和循环，则需要使用称为引用的数据结构，它是一种“可变单元”。您使用函数分配引用`ref`，并将初始内容传递给它。您可以使用运算符访问内容`!`。并且您使用运算符设置新内容`:=`。因此，您上面的代码的字面翻译将类似于以下内容。如您所见，语法非常难看，这也是人们避免使用它的另一个原因。

```
fun foo (stuff, counter_start) =
let
  val counter = ref counter_start
in
  while !counter > 0 do (
    bar stuff;
    counter := !counter - 1
  )
end; 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-05-03T23:34:08.310

在函数式程序中，可变变量变成参数，通常是嵌套的辅助函数。

由于在您的示例中，被变异的东西是 aleady 参数，因此不需要辅助函数。你的代码变成

```
fun foo stuff counter =
  if counter > 0 then
    ( bar stuff
    ; foo stuff (counter-1)
    )
  else
    () 
```

当然，这段代码仍然是*非常*必要的......该调用`bar stuff`纯粹是为了副作用而执行的。不是很 ML-ish。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-05-03T23:35:39.287

简短的回答：你没有。在函数式编程中，您通常从不修改变量，这意味着循环是不可能的。相反，您可以使用递归来实现相同的功能。同样，由于一般来说没有副作用，因此函数调用只有在返回数据时才有意义。所以 bar(stuff) 可能不是很有用。它无法影响应用程序的其余部分。在函数式编程风格中，您的 bar() 函数应该每次都在不同的数据上调用，并返回应用程序其余部分可以执行的操作。

（ML 在某些情况下确实允许副作用，但为了简单起见，我们暂时忽略它）

你到底想达到什么目的？（你需要循环什么，函数有什么作用？

如果您提供更多细节，我们可以更具体地解释您应该如何编写程序。但事实上，您的程序在函数式风格中根本没有意义。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-05-04T01:27:53.213

我不知道 ML，但这是一些类似 ML 的伪代码：

```
有趣的 foo 东西 0 = return ()
  | foo stuff counter = (bar stuff; foo stuff (counter - 1))

```

我不知道如何在 ML 中“链接”命令；分号只是一个占位符。

一般来说，你不会循环。我宁愿期待通常的高阶函数。当你习惯了这些，手动编写循环会感觉像编码汇编程序。

*编辑：*根据评论修复代码

# php - php isset 你需要在表单检查中使用它吗？

> ID：818326
> 
> 赞同：1
> 
> 时间：2009-05-03T23:30:31.657
> 
> 标签：php, isset

当我检查 $_REQUEST["input_name"] 如果没有传递任何值时，我试图了解在表单处理期间是否需要 isset不存在的数组项....我可以使用 if($_REQUEST["input_name"]).. 即使在这些情况下我可以使用 if()

谢谢

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-03T23:45:29.403

我不建议使用`$_REQUEST`超全局来捕获表单输入，除非您正在测试表单。使用`$_GET`or`$_POST`代替，除非你有充分的理由。

此外，`isset()`两者`array_key_exists()`都对数组键执行相同的技巧，尽管`array_key_exists()`在数组上下文中更清晰。

我建议使用：

```
error_reporting(E_ALL); //E_ALL - All errors and warnings 
```

在您的开发环境中，因为这可以揭示可能应用更好实践的地方，例如在使用变量之前未能声明变量等。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-05-03T23:33:58.997

有不同类型的错误级别。检查未设置的变量只会引发通知。您的[错误报告](http://www.php.net/manual/en/function.error-reporting.php)可能设置为忽略这些。`isset`当您想检查变量是否已设置时，最好始终使用它，尽管[它确实有它的陷阱](https://stackoverflow.com/questions/413929/weak-typing-in-php-why-use-isset-at-all)。

只做你在上面做的事情，例如，如果`$_REQUEST["input_name"]`是字符串“0”，它将评估为假。此外，使用 $_REQUEST 开始也不是一个好主意，因为它可能会受到 cookie 之类的影响，并且通常是不良架构的代码气味。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-05-03T23:36:42.857

使用 $_REQUEST 几乎是一种技巧。您应该使用 $_POST 或 $_GET（取决于您在做什么）并且应该使用 isset()。

我读过的每本关于 PHP 的书似乎都这么说。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-05-04T00:37:48.390

通常，至少对于测试，在您的 php.ini 或使用 error_reporting(E_ALL) 的代码中将错误报告设置为 E_ALL（所有错误和警告）；（也[考虑添加 E_STRICT](http://php.net/manual/en/errorfunc.configuration.php#ini.error-reporting)。）最好提前得到一个关于错误的明显通知，而不是让一些微妙的错误出现，直到以后才发现。

避免使用太模糊的 $_REQUEST（它包括 GET、POST 和 cookie 值），如果您真正的意思是这些，请使用 $_POST 或 $_GET，并检查`isset($_POST["input_name"])`

简短的回答是“是的”。:)

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-05-03T23:33:28.043

```
if($_REQUEST["input_name"]) 
```

如果“input_name”不存在，将抛出一个通知（错误），因此建议使用 isset()。

# java - JAXB：我应该如何编组复杂的嵌套数据结构？

> ID：818327
> 
> 赞同：32
> 
> 时间：2009-05-03T23:31:20.530
> 
> 标签：java, xml, data-binding, data-structures, jaxb

我有几个复杂的数据结构，比如

```
Map< A, Set< B > >
Set< Map< A, B > >
Set< Map< A, Set< B > > >
Map< A, Map< B, Set< C > > >
and so on (more complex data structures) 
```

*注意：就我而言，使用 Set 还是 List 并不重要。*

现在我知道 JAXB 让我定义**XmlAdapter**，这很好，但我不想为每个给定的数据结构定义一个 XmlAdapter （这将是太多的复制和粘贴代码）。

我试图通过声明两个通用 XmlAdapter 来实现我的目标：

*   一个用于地图：`MapAdapter<K,V>`
*   一套：`SetAdapter<V>`

**问题**：
JAXB 抱怨如下：

```
javax.xml.bind.JAXBException:
class java.util.Collections$UnmodifiableMap nor any of its
  super class is known to this context. 
```

**这是我的适配器类：**

```
import java.util.*;
import javax.xml.bind.annotation.*;
import javax.xml.bind.annotation.adapters.*;

public class Adapters {

public final static class MapAdapter<K, V>
        extends XmlAdapter<MapAdapter.Adapter<K, V>, Map<K, V>> {

    @XmlType
    @XmlRootElement
    public final static class Adapter<K, V> {

        @XmlElement
        protected List<MyEntry<K, V>> key = new LinkedList<MyEntry<K, V>>();

        private Adapter() {
        }

        public Adapter(Map<K, V> original) {
            for (Map.Entry<K, V> entry : original.entrySet()) {
                key.add(new MyEntry<K, V>(entry));
            }
        }

    }

    @XmlType
    @XmlRootElement
    public final static class MyEntry<K, V> {

        @XmlElement
        protected K key;

        @XmlElement
        protected V value;

        private MyEntry() {
        }

        public MyEntry(Map.Entry<K, V> original) {
            key = original.getKey();
            value = original.getValue();
        }

    }

    @Override
    public Adapter<K, V> marshal(Map<K, V> obj) {
        return new Adapter<K, V>(obj);
    }

    @Override
    public Map<K, V> unmarshal(Adapter<K, V> obj) {
        throw new UnsupportedOperationException("unmarshalling is never performed");
    }

}

} 
```

**这是我的 JUnit 测试用例：**

```
import java.io.*;
import java.util.*;
import javax.xml.bind.*;
import javax.xml.bind.annotation.*;
import javax.xml.bind.annotation.adapters.*;
import org.junit.*;
import static java.lang.System.*;

public class SomeTest {

@Test
public void _map2()
        throws Exception {

    Map<String, Map<String, String>> dataStructure =
            new HashMap<String, Map<String, String>>();

    Map<String, String> inner1 = new HashMap<String, String>();
    Map<String, String> inner2 = new HashMap<String, String>();

    dataStructure.put("a", inner1);
    dataStructure.put("b", inner1);

    inner1.put("a1", "1");
    inner1.put("a2", "2");
    inner2.put("b1", "1");
    inner2.put("b2", "2");

    JAXBContext context = JAXBContext.newInstance(Adapters.XMap.class,
            Adapters.XCount.class, Adapters.XEntry.class);

    Marshaller marshaller = context.createMarshaller();
    marshaller.setProperty(Marshaller.JAXB_FRAGMENT, true);
    marshaller.setProperty(Marshaller.JAXB_FORMATTED_OUTPUT, true);

    marshaller.setAdapter(new Adapters.MapAdapter());

    StringWriter sw = new StringWriter();

    marshaller.marshal(dataStructure, sw);
    out.println(sw.toString());
}

} 
```

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2009-05-04T00:19:21.757

我已经解决了**没有 XmlAdapter 的**问题。

我已经为**Map**、**Map.Entry**和**Collection**编写了带有 JAXB 注释的对象。
主要思想在方法**xmlizeNestedStructure(...)**内部：

看一下代码：

```
public final class Adapters {

private Adapters() {
}

public static Class<?>[] getXmlClasses() {
    return new Class<?>[]{
                XMap.class, XEntry.class, XCollection.class, XCount.class
            };
}

public static Object xmlizeNestedStructure(Object input) {
    if (input instanceof Map<?, ?>) {
        return xmlizeNestedMap((Map<?, ?>) input);
    }
    if (input instanceof Collection<?>) {
        return xmlizeNestedCollection((Collection<?>) input);
    }

    return input; // non-special object, return as is
}

public static XMap<?, ?> xmlizeNestedMap(Map<?, ?> input) {
    XMap<Object, Object> ret = new XMap<Object, Object>();

    for (Map.Entry<?, ?> e : input.entrySet()) {
        ret.add(xmlizeNestedStructure(e.getKey()),
                xmlizeNestedStructure(e.getValue()));
    }

    return ret;
}

public static XCollection<?> xmlizeNestedCollection(Collection<?> input) {
    XCollection<Object> ret = new XCollection<Object>();

    for (Object entry : input) {
        ret.add(xmlizeNestedStructure(entry));
    }

    return ret;
}

@XmlType
@XmlRootElement
public final static class XMap<K, V> {

    @XmlElementWrapper(name = "map")
    @XmlElement(name = "entry")
    private List<XEntry<K, V>> list = new LinkedList<XEntry<K, V>>();

    public XMap() {
    }

    public void add(K key, V value) {
        list.add(new XEntry<K, V>(key, value));
    }

}

@XmlType
@XmlRootElement
public final static class XEntry<K, V> {

    @XmlElement
    private K key;

    @XmlElement
    private V value;

    private XEntry() {
    }

    public XEntry(K key, V value) {
        this.key = key;
        this.value = value;
    }

}

@XmlType
@XmlRootElement
public final static class XCollection<V> {

    @XmlElementWrapper(name = "list")
    @XmlElement(name = "entry")
    private List<V> list = new LinkedList<V>();

    public XCollection() {
    }

    public void add(V obj) {
        list.add(obj);
    }

}

} 
```

**有用！**

让我们看一个**演示输出**：

```
<xMap>
    <map>
        <entry>
            <key xsi:type="xCount" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
                <count>1</count>
                <content xsi:type="xs:string" xmlns:xs="http://www.w3.org/2001/XMLSchema">a</content>
            </key>
            <value xsi:type="xCollection" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
                <list>
                    <entry xsi:type="xs:string" xmlns:xs="http://www.w3.org/2001/XMLSchema">a1</entry>
                    <entry xsi:type="xs:string" xmlns:xs="http://www.w3.org/2001/XMLSchema">a2</entry>
                    <entry xsi:type="xs:string" xmlns:xs="http://www.w3.org/2001/XMLSchema">a3</entry>
                </list>
            </value>
        </entry>
        <entry>
            <key xsi:type="xCount" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
                <count>2</count>
                <content xsi:type="xs:string" xmlns:xs="http://www.w3.org/2001/XMLSchema">b</content>
            </key>
            <value xsi:type="xCollection" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
                <list>
                    <entry xsi:type="xs:string" xmlns:xs="http://www.w3.org/2001/XMLSchema">b1</entry>
                    <entry xsi:type="xs:string" xmlns:xs="http://www.w3.org/2001/XMLSchema">b3</entry>
                    <entry xsi:type="xs:string" xmlns:xs="http://www.w3.org/2001/XMLSchema">b2</entry>
                </list>
            </value>
        </entry>
        <entry>
            <key xsi:type="xCount" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
                <count>3</count>
                <content xsi:type="xs:string" xmlns:xs="http://www.w3.org/2001/XMLSchema">c</content>
            </key>
            <value xsi:type="xCollection" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
                <list>
                    <entry xsi:type="xs:string" xmlns:xs="http://www.w3.org/2001/XMLSchema">c1</entry>
                    <entry xsi:type="xs:string" xmlns:xs="http://www.w3.org/2001/XMLSchema">c2</entry>
                    <entry xsi:type="xs:string" xmlns:xs="http://www.w3.org/2001/XMLSchema">c3</entry>
                </list>
            </value>
        </entry>
    </map>
</xMap> 
```

抱歉，演示输出还使用 了适配器源代码中未提及的名为**“count”的数据结构。**

**顺便说一句：**有谁知道如何删除所有这些烦人且（在我的情况下）不必要的**xsi:type**属性？

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-04-16T14:33:08.093

我对使用 Map<String,Map<String,Integer>> 有同样的要求。我使用了 XMLAdapter，它工作得很好。使用 XMLAdaptor 是我认为最干净的解决方案。下面是适配器的代码。这是 jaXb 类代码片段。

```
 @XmlJavaTypeAdapter(MapAdapter.class)
    Map<String, Map<String, Integer>> mapOfMap = new HashMap<String,Map<String, Integer>>(); 
```

地图类型类：

```
public class MapType {

public List<MapEntryType> host = new ArrayList<MapEntryType>();

} 
```

MapEntry 类型类：

```
public class MapEntryType {

@XmlAttribute
public String ip;

@XmlElement
public List<LinkCountMapType> request_limit = new ArrayList<LinkCountMapType>();

} 
```

LinkCountMapType 类：

```
public class LinkCountMapType {
@XmlAttribute
public String service;

@XmlValue
public Integer count;
} 
```

最后是 MapAdaptor 类：

```
 public final class MapAdapter extends XmlAdapter<MapType, Map<String, Map<String, Integer>>> {

@Override
public Map<String, Map<String, Integer>> unmarshal(MapType v) throws Exception {
    Map<String, Map<String, Integer>> mainMap = new HashMap<String, Map<String, Integer>>();

    List<MapEntryType> myMapEntryTypes = v.host;
    for (MapEntryType myMapEntryType : myMapEntryTypes) {
        Map<String, Integer> linkCountMap = new HashMap<String, Integer>();
        for (LinkCountMapType myLinkCountMapType : myMapEntryType.request_limit) {
            linkCountMap.put(myLinkCountMapType.service, myLinkCountMapType.count);
        }
        mainMap.put(myMapEntryType.ip, linkCountMap);
    }
    return mainMap;
}

@Override
public MapType marshal(Map<String, Map<String, Integer>> v) throws Exception {
    MapType myMapType = new MapType();

    List<MapEntryType> entry = new ArrayList<MapEntryType>();

    for (String ip : v.keySet()) {
        MapEntryType myMapEntryType = new MapEntryType();
        Map<String, Integer> linkCountMap = v.get(ip);
        List<LinkCountMapType> linkCountList = new ArrayList<LinkCountMapType>();
        for (String link : linkCountMap.keySet()) {
            LinkCountMapType myLinkCountMapType = new LinkCountMapType();
            Integer count = linkCountMap.get(link);
            myLinkCountMapType.count = count;
            myLinkCountMapType.service = link;
            linkCountList.add(myLinkCountMapType);
        }
        myMapEntryType.ip = ip;
        myMapEntryType.request_limit = linkCountList;
        entry.add(myMapEntryType);
    }
    myMapType.host = entry;
    return myMapType;
} 
```

}

编组 Jaxb 对象将给出以下 XML

```
 <mapOfmap>
    <host ip="127.0.0.1">
        <request_limit service="service1">7</request_limit>
        <request_limit service="service2">8</request_limit>
    </host>
</mapOfmap> 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2011-07-22T02:03:44.870

以下是基于上述 Ivan 代码的具有“dexmlize”能力的代码。用法：

```
Map<String, List> nameMapResult = (Map<String, List>) Adapters.dexmlizeNestedStructure(unmarshallResult); 
```

为了恢复collection和map类，会xml化一个新的字段来记录类信息。详细代码：

```
class Adapters {
    private Adapters() {
    }
    public static Class<?>[] getXmlClasses() {
            return new Class<?>[]{XMap.class, XEntry.class, XCollection.class};
    }
    public static Object xmlizeNestedStructure(Object input) {
            if (input instanceof Map<?, ?>) {
                    return xmlizeNestedMap((Map<?, ?>) input);
            }
            if (input instanceof Collection<?>) {
                    return xmlizeNestedCollection((Collection<?>) input);
            }
            return input; // non-special object, return as is
    }

    public static Object dexmlizeNestedStructure(Object input) {
        if (input instanceof XMap<?, ?>) {
                return dexmlizeNestedMap((XMap<?, ?>) input);
        }
        if (input instanceof XCollection<?>) {
                return dexmlizeNestedCollection((XCollection<?>) input);
        }
        return input; // non-special object, return as is
    }

    private static Object dexmlizeNestedCollection(XCollection<?> input)
    {
        Class<? extends Collection> clazz = input.getClazz();
        Collection collection = null;
        try
        {
            collection = clazz.newInstance();
            List dataList = input.getList();
            for (Object object : dataList)
            {
                collection.add(dexmlizeNestedStructure(object));
            }
        }
        catch (Exception e)
        {
            e.printStackTrace();
        }
        return collection;
    }

    private static Object dexmlizeNestedMap(XMap<?, ?> input)
    {
        Class<? extends Map> clazz = input.getClazz();
        Map map = null;
        try
        {
            map = clazz.newInstance();
            List<? extends XEntry> entryList = input.getList();
            for (XEntry xEntry : entryList)
            {
                Object key = dexmlizeNestedStructure(xEntry.getKey());
                Object value = dexmlizeNestedStructure(xEntry.getValue());
                map.put(key, value);
            }
        }
        catch (Exception e)
        {
            e.printStackTrace();
        }
        return map;
    }

    public static XMap<?, ?> xmlizeNestedMap(Map<?, ?> input) {
            XMap<Object, Object> ret = new XMap<Object, Object>(input.getClass());

            for (Map.Entry<?, ?> e : input.entrySet()) {
                    ret.add(xmlizeNestedStructure(e.getKey()),
                                    xmlizeNestedStructure(e.getValue()));
            }
            return ret;
    }

    public static XCollection<?> xmlizeNestedCollection(Collection<?> input) {
            XCollection<Object> ret = new XCollection<Object>(input.getClass());

            for (Object entry : input) {
                    ret.add(xmlizeNestedStructure(entry));
            }
            return ret;
    }

    @XmlType
    @XmlRootElement
    public final static class XMap<K, V>{
            private List<XEntry<K, V>> list = new ArrayList<XEntry<K, V>>();
            private Class<? extends Map> clazz = null;

            public XMap(Class mapClazz) {
                this.clazz = (Class<? extends Map>)mapClazz;
            }

            public XMap() {
            }

            public void add(K key, V value) {
                    list.add(new XEntry<K, V>(key, value));
            }

            @XmlElementWrapper(name = "map")
            @XmlElement(name = "entry")
            public List<XEntry<K, V>> getList()
            {
                return list;
            }

            public void setList(List<XEntry<K, V>> list)
            {
                this.list = list;
            }

            @XmlElement(name="clazz")
            public Class<? extends Map> getClazz()
            {
                return clazz;
            }

            public void setClazz(Class<? extends Map> clazz)
            {
                this.clazz = clazz;
            }
    }

    @XmlType
    @XmlRootElement
    public final static class XEntry<K, V> {
            private K key;
            private V value;

            private XEntry() {
            }

            public XEntry(K key, V value) {
                    this.key = key;
                    this.value = value;
            }

            @XmlElement
            public K getKey()
            {
                return key;
            }

            public void setKey(K key)
            {
                this.key = key;
            }

            @XmlElement
            public V getValue()
            {
                return value;
            }

            public void setValue(V value)
            {
                this.value = value;
            }
    }

    @XmlType
    @XmlRootElement
    public final static class XCollection<V> {
            private List<V> list = new ArrayList<V>();
            private Class<? extends Collection> clazz = null; 

            public XCollection(Class collectionClazz) {
                this.clazz = collectionClazz;
            }

            public XCollection() {
            }

            public void add(V obj) {
                    list.add(obj);
            }

            @XmlElementWrapper(name = "collection")
            @XmlElement(name = "entry")
            public List<V> getList()
            {
                return list;
            }

            public void setList(List<V> list)
            {
                this.list = list;
            }

            @XmlElement(name="clazz")
            public Class<? extends Collection> getClazz()
            {
                return clazz;
            }

            public void setClazz(Class<? extends Collection> clazz)
            {
                this.clazz = clazz;
            }
    }

} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-03T23:37:45.930

看起来您在使用 XMLAdapter 时走在了正确的轨道上......错误消息可能是一个线索：

> 类 java.util.Collections$UnmodifiableMap 或其任何超类在此上下文中是已知的。

您是否在任何地方使用 Collections.unmodifiableMap() 包装地图？错误究竟发生在哪里？

* * *

（以前的答案留作好奇的陈旧记录）

~~您可以创建自定义编组器/解组器逻辑，它比适配器的想法更直接（我认为；我以前没有使用过那个）。~~

~~基本上这个想法是你指定一个静态函数来完成这项工作，你也可以创建一个自定义类。（我通常将静态函数放在有问题的类中，但您不必这样做。）然后您在 .XJB 文件中放入一行来告诉 JAXB 使用您的静态函数。~~

现在我查看了现有代码，我发现我所做的只是将属性字符串转换为自定义 Java 对象。这是代码，供参考，但仅用于属性。

JAXB 文件：

```
<?xml version="1.0" ?>
<jaxb:bindings xmlns:jaxb="http://java.sun.com/xml/ns/jaxb"
    xmlns:xsd="http://www.w3.org/2001/XMLSchema"
    jaxb:version="2.0"> 
    <jaxb:bindings schemaLocation={your schema} node="/xsd:schema">
        <jaxb:bindings node={some XPATH expression to select a node}>
            <jaxb:bindings node={maybe another XPATH relative to the above}>
                <jaxb:property>
                    <jaxb:baseType>
                        <jaxb:javaType name={your custom Java class}
                            parseMethod={your static method for unmarshaling}
                            printMethod={your static method for marshaling}
                            />
                    </jaxb:baseType>
                </jaxb:property>
            </jaxb:bindings>
        </jaxb:bindings>
    </jaxb:bindings>
</jaxb:bindings> 
```

（parseMethod 和 printMethod 与属性字符串相互转换）

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2011-07-14T09:17:30.113

这是@XmlType 类列表的编组器/解组器。

例如

```
//Type to marshall
@XmlType(name = "TimecardForm", propOrder = {
"trackId",
"formId"
}) 
public class TimecardForm {

    protected long trackId;
    protected long formId;
    ...
}

//a list holder
@XmlRootElement
public class ListHodler<T> {
    @XmlElement
    private List<T> value ;

    public ListHodler() {
    }

    public ListHodler(List<T> value) {
        this.value = value;
    }

    public List<T> getValue() {
        if(value == null)
            value = new ArrayList<T>();
        return this.value;
    }
}

//marshall collection of T
public static <T> void marshallXmlTypeCollection(List<T> value,
        Class<T> clzz, OutputStream os) {
    try {
        ListHodler<T> holder = new ListHodler<T>(value);
        JAXBContext context = JAXBContext.newInstance(clzz,
                ListHodler.class);
        Marshaller m = context.createMarshaller();
        m.setProperty("jaxb.formatted.output", true);

        m.marshal(holder, os);
    } catch (JAXBException e) {
        e.printStackTrace();
    }
}

//unmarshall collection of T
@SuppressWarnings("unchecked")
public static <T> List<T> unmarshallXmlTypeCollection(Class<T> clzz,
        InputStream input) {
    try {
        JAXBContext context = JAXBContext.newInstance(ListHodler.class, clzz);
        Unmarshaller u = context.createUnmarshaller();

        ListHodler<T> holder = (ListHodler<T>) u.unmarshal(new StreamSource(input));

        return holder.getValue();
    } catch (JAXBException e) {
        e.printStackTrace();
    }

    return null;
} 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-06-29T15:14:34.697

要为 JSON 解决此问题，请执行以下操作： [jackson with jaxb](https://stackoverflow.com/questions/6001817/jackson-with-jaxb)

```
<init-param>
        <param-name>com.sun.jersey.api.json.POJOMappingFeature</param-name>
        <param-value>true</param-value>
    </init-param> 
```

# c# - 在c#中拦截应用程序关闭

> ID：818334
> 
> 赞同：2
> 
> 时间：2009-05-03T23:34:08.853
> 
> 标签：c#, resource-cleanup

我想正确关闭一些套接字，并能够告诉服务器我们正在关闭，但如果应用程序关闭，那么套接字都刚刚关闭，有时文件被锁定。我的应用程序关闭时如何运行方法？

这将进入一个将在表单应用程序中使用的库。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-03T23:45:44.753

如果它是一个 Windows 窗体应用程序，您可以将焦点放在窗体上，单击属性窗口中的事件闪电，然后使用窗体关闭事件。

```
this.FormClosing += new System.Windows.Forms.FormClosingEventHandler(OnFormClosing);

private void OnFormClosing(object sender, FormClosingEventArgs e)
{
    // Your socket logic here
} 
```

此外，如果您需要拦截正在关闭的表单，请将 Cancel 属性设置为 true：

```
e.Cancel = true; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-04T00:32:55.420

我会在使用这些资源的类上实现[IDisposable 。](http://msdn.microsoft.com/en-us/library/system.idisposable.aspx)然后可以从应用程序类型支持的任何关闭方法（OnFormClose、OnStop、Application_End、...）显式调用 Dispose。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-03T23:40:27.513

您是在谈论 WinForms 应用程序吗？如果是这样，请在主窗体上使用[FormClosing 事件。](http://msdn.microsoft.com/en-us/library/system.windows.forms.form.formclosing.aspx)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-03T23:41:00.960

我不确定它是否是最好的地方，但你可以通过挂钩[AppDomain.ProcessExit](http://msdn.microsoft.com/en-us/library/system.appdomain.processexit.aspx)来告诉你的进程正在关闭。清理工作很好，但我认为现在不是发送任何消息的好时机。:)

# linq-to-sql - Linq to SQL 和 Gridview 数据源

> ID：818336
> 
> 赞同：2
> 
> 时间：2009-05-03T23:34:43.440
> 
> 标签：linq-to-sql, gridview, join

我有一个与[此](https://stackoverflow.com/questions/481136/linq-to-sql-object-child-properties-in-gridview)相关的问题。我不想进行计算（聚合），但我需要从关联中获取显示值。在我的 C# 代码中，我可以直接引用该值，因为外键约束使 Linq 生成所有必要的接线。当我将 IQueryable 指定为 Gridview 数据源属性并引用不是结果集中主要实体的列的内容时，我收到该列不存在的错误。作为 Linq 的新手，我猜测赋值隐式地将 IQueryable 转换为列表，并且关联丢失了。我的问题是，这样做的好方法是什么？

我假设我可以通过编写一个并行查询来解决这个问题，该查询返回一个匿名类型，其中包含我需要的 gridview 的所有列。似乎通过这样做，我会在内存中冗余地保存我已经拥有的数据。我可以在分配数据源时动态查询内存中的数据结构吗？还是有更直接的解决方案？

网格视图应该显示医生的医疗组关联，并且关联的名称在查找表中。

```
 IQueryable<Physician> ph =
                        from phys   in db.Physicians
                        //from name   in phys.PhysicianNames.DefaultIfEmpty()
                        //from lic    in phys.PhysicianLicenseNums.DefaultIfEmpty()
                        //from addr   in phys.PhysicianAddresses.DefaultIfEmpty()
                        //from npi    in phys.PhysicianNPIs.DefaultIfEmpty() 
                        //from assoc  in phys.PhysicianMedGroups.DefaultIfEmpty()
                        where phys.BQID == bqid
                        select phys; 
```

[![替代文字](https://i.stack.imgur.com/BbtOW.jpg)](https://i.stack.imgur.com/BbtOW.jpg)
[（来源：[heeroz.com](http://heeroz.com/phys.jpg)）]

因此，根据丹尼斯的回答，我从查询中删除了所有不需要的内容。我想我可能一开始就没有问正确的问题。

无论如何，该页面显示了医生的数据。我想在网格中显示所有医疗团体隶属关系（并让用户插入、编辑和更新隶属关系）。我现在意识到我不需要显式加入这些其他表——Linq 为我做到了。我可以通过子关联链引用许可证号来访问单独的表中的许可证号。我无法在 gridview 中引用医疗组名称，这让我回到了我的问题：

```
AffiliationGrid.DataSource = ph.First().PhysicianMedGroups; 
```

这不起作用，因为 GridView 无法访问 med_group_print_name：

```
A field or property with the name 'med_group_print_name' was not found on the
selected data source. 
```

再说一次，请耐心等待，如果我不了解 Linq 太明显了……因为我不了解。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-03T23:45:24.240

您的查询似乎很奇怪。您应该尝试简单地显示

```
ph = from phys in db.Physicians
     where phys.BQID == bqid
     select phys; 
```

在你的网格中。那应该行得通。另外，为什么调用 Load()？如果在绑定网格时未释放 DataContext，则不需要它。

如果您仍然有问题，请您发布您收到的错误消息，这将有助于...

第2部分

问题是您的名字实际上不在 PhysMedGroup 中。您需要向下导航到 MedGroupLookup 以访问该名称，因为它是该类的属性。

根据您使用的技术（似乎是 WinForms 或 Web 表单），您需要配置数据绑定以访问 MedGroupLookup.med_group_print_name。

# c++ - CLR 干扰 C++ STD？

> ID：818340
> 
> 赞同：3
> 
> 时间：2009-05-03T23:36:15.933
> 
> 标签：c++, visual-studio, clr, std

我有一些在 clr 下编译的代码和其他在单个项目中不受管理的代码。

我的 common.h 文件包含我需要的所有标准库头文件。它包含在 manager.h（manager.cpp（无 CLR）的前向声明）中，它包含在 main_window.h（WinForm）中，而 main_window.h（WinForm）包含在 document_manager.cpp（CLR）中。

在运行时，我会遇到各种奇怪的行为，在一种情况下，我的表单无法加载。暂停程序进行多次调试表明它在 malloc.c 中为 std::string 重新分配内存时卡住了。通过更改代码，我可以在 ostream 中收到 System::InvalidMemory（我认为）异常。

如何阻止 CLR 管理 std 库？

如果有人想要我的任何文件的来源，请问。

编辑：在调用堆栈中，我有一些在我的表单加载时运行的托管代码。在窗口初始化回调中，我有一个管理到本机的转换，然后是我的管理器类。后来，我到

```
 std::string error_msg;
    error_msg = "Storage Manager: SQLite Error ("; <-- Executing Currently
    error_msg += sqlite3_errcode(this->db_p);
    error_msg += ") - ";
    error_msg += sqlite3_errmsg(this->db_p);
    *(this->log) << error_msg.c_str() << std::endl; 
```

并且调用堆栈显示 std::basic_string::assign，然后是其他一些 std:: 函数，最后是 malloc 函数，它永远卡在其中。

编辑：文件写入引发的异常：

```
System.AccessViolationException: Attempted to read or write protected memory. This is often an indication that other memory is corrupt.
   at manager.file_open(manager* , basic_string<char\,std::char_traits<char>\,std::allocator<char> >* )
   at DocumentManager.main_window.file_open_mainmenu_Click(Object sender, EventArgs e) in c:\development\document manager\document manager\main_window.h:line 456
   at System.Windows.Forms.ToolStripItem.RaiseEvent(Object key, EventArgs e)
   at System.Windows.Forms.ToolStripMenuItem.OnClick(EventArgs e)
   at System.Windows.Forms.ToolStripItem.HandleClick(EventArgs e)
   at System.Windows.Forms.ToolStripItem.HandleMouseUp(MouseEventArgs e)
   at System.Windows.Forms.ToolStripItem.FireEventInteractive(EventArgs e, ToolStripItemEventType met)
   at System.Windows.Forms.ToolStripItem.FireEvent(EventArgs e, ToolStripItemEventType met)
   at System.Windows.Forms.ToolStrip.OnMouseUp(MouseEventArgs mea)
   at System.Windows.Forms.ToolStripDropDown.OnMouseUp(MouseEventArgs mea)
   at System.Windows.Forms.Control.WmMouseUp(Message& m, MouseButtons button, Int32 clicks)
   at System.Windows.Forms.Control.WndProc(Message& m)
   at System.Windows.Forms.ScrollableControl.WndProc(Message& m)
   at System.Windows.Forms.ToolStrip.WndProc(Message& m)
   at System.Windows.Forms.ToolStripDropDown.WndProc(Message& m)
   at System.Windows.Forms.Control.ControlNativeWindow.OnMessage(Message& m)
   at System.Windows.Forms.Control.ControlNativeWindow.WndProc(Message& m)
   at System.Windows.Forms.NativeWindow.Callback(IntPtr hWnd, Int32 msg, IntPtr wparam, IntPtr lparam) 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-03T23:59:40.853

您是否尝试过将#pragma unmanaged / #pragma managed 包装在您需要保持非托管状态的功能？虽然以一种“令人窒息的热情”的语气编写，[http://www.ondotnet.com/pub/a/dotnet/2003/03/03/mcppp2.html](http://www.ondotnet.com/pub/a/dotnet/2003/03/03/mcppp2.html)确实有一些关于混合托管和非托管代码/对象的技巧。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-04T07:31:00.753

根据您的描述，我认为您可能会受到单一定义规则的影响。在 C++ 中，一个类可以有多个定义，但它们都应该相同。这允许您将类定义放在标题中。

您仍然必须小心“相同”部分。这不仅意味着源代码中的标记，还意味着它们在前处理器之后的替换以及（实际上）在当前编译器设置下它们的含义。一个明显的例子是 32/64 位开关，或者对齐设置——这些可以改变一个类的大小。

在您的情况下，您可能在不同的设置下有两个 Microsoft STL 类的定义。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-04T01:05:30.443

只是在黑暗中拍摄，但请尝试关闭对您使用 STL 的 CPP 文件的 CLR 支持。[此问题](https://stackoverflow.com/questions/808250/vc2008-how-to-turn-clr-flag-off-for-individual-files-in-c-cli-project)显示如何对单个 CPP 文件执行此操作。它有效地在本地编译它们。

公平警告：如果你走这条路，你可能不得不关闭你本地编译的 CPP 文件的预编译头文件。

# expression-blend - 有人知道 Expression Blend 3 中的“将画笔转换为资源”按钮在哪里吗？

> ID：818359
> 
> 赞同：2
> 
> 时间：2009-05-03T23:46:35.253
> 
> 标签：expression-blend

有谁知道他们在 Blend 3 中将“加号笔刷”放在哪里，以便您可以将笔刷复制到资源中？

[替代文字 http://tanguay.info/web/external/plusBrush.png](http://tanguay.info/web/external/plusBrush.png)

# 回答：

一个小时后偶然发现：

[替代文字 http://tanguay.info/web/external/answerbrush.png](http://tanguay.info/web/external/answerbrush.png)

# image - 如何将 Pyglet 图像的区域放入 PIL 图像中？

> ID：818360
> 
> 赞同：1
> 
> 时间：2009-05-03T23:46:40.370
> 
> 标签：image, python-imaging-library, pyglet

我的应用程序从视频中读取帧（使用 pyglet），提取“条带”（即区域 - 全宽 1 到 6 条视频线），然后将每个条带（附加它）粘贴到稍后可以写出 *. .png 文件。

问题是 Pyglet GL 图像存储在图形内存中，因此 re 大小非常有限。我目前的笨拙解决方法是将要成为的 png 图像构建为小图块（即在 pyglet GL 大小限制内），当图块已满时，将其写入 *png 文件，将其作为 PIL 图像文件读回，然后将平铺图像粘贴/附加到最终的 PIL Image * png 文件中。

我认为应该可以将 pyglet-GL 条转换为 PIL 图像友好格式，并将其直接粘贴/附加到最终的 PIL 图像中，因此不需要瓷砖业务，这会使事情变得非常复杂并具有性能影响.

但是我找不到如何将条形数据转换为可以粘贴到 PIL 图像中的表单。已经看到许多请求重新转换为另一种方式，但我从未与牛群一起奔跑。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-04T18:21:26.930

我知道回答自己的问题是不好的形式，但我想出了一个可能对其他人有用的答案，所以在这里......

nextframe = source.get_next_video_frame() #
在 nextframe 时获取第一个视频帧！= None:# 在 EOF 时返回 None

```
#
### extract strip data, conver to PIL Image-friendly form, paste itn into travo Image
#
strip = nextframe.get_region(0, (vid_frame_h//2)-(strip_h//2), strip_w, strip_h) # Extract strip from this frame
strip_image_data = strip.get_image_data() 
strip_data = strip_image_data.get_data(strip_image_data.format, strip_image_data.pitch)
strip_Image = Image.frombuffer("RGB", (strip_w, strip_h), strip_data)
travo_image.paste(strip_Image, (0, travo_filled_to, strip_w, travo_filled_to + strip_h)) # paste strip image into travo_image 
travo_filled_to = travo_filled_to + strip_h     # update travo_filled pointer
nextframe = source.get_next_video_frame()       # get next video frame (EOF returns None) 
```

# “而下一帧！=无：”结束

# python - MPI4Py Scatter sendbuf 参数类型？

> ID：818362
> 
> 赞同：2
> 
> 时间：2009-05-03T23:47:51.223
> 
> 标签：python, parallel-processing, mpi

我在使用 MPI4Py Python 模块中的 Scatter 函数时遇到问题。我的假设是我应该能够将它传递给发送缓冲区的单个列表。但是，当我这样做时，我收到了一致的错误消息，或者确实添加了其他两个参数，recvbuf 和 root：

```
 File "code/step3.py", line 682, in subbox_grid
    i = mpi_communicator.Scatter(station_range, station_data)
  File "Comm.pyx", line 427, in mpi4py.MPI.Comm.Scatter (src/
mpi4py_MPI.c:44993)
  File "message.pxi", line 321, in mpi4py.MPI._p_msg_cco.for_scatter
(src/mpi4py_MPI.c:14497)
  File "message.pxi", line 232, in mpi4py.MPI._p_msg_cco.for_cco_send
(src/mpi4py_MPI.c:13630)
  File "message.pxi", line 36, in mpi4py.MPI.message_simple (src/
mpi4py_MPI.c:11904)
ValueError: message: expecting 2 or 3 items 
```

下面是相关代码的剪辑，从上面提到的 682 以上几行开始。

```
for station in stations
        #snip--do some stuff with station
        station_data = []
        station_range = range(1,len(station))
        mpi_communicator = MPI.COMM_WORLD
        i = mpi_communicator.Scatter(station_range, nsm)
        #snip--do some stuff with station[i]
        nsm = combine(avg, wt, dnew, nf1, nl1, wti[i], wtm, station[i].id)
        station_data = mpi_communicator.Gather(station_range, nsm) 
```

我尝试了许多初始化 station_range 的组合，但我一定没有正确理解 Scatter 参数类型。

Python/MPI 大师对此是否有澄清？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2010-09-14T20:29:17.920

如果要移动原始缓冲区（如`Gather`），则提供三元组`[buffer, size, type]`。查看演示以获取相关示例。如果要发送 Python 对象，则应使用更高级别的接口并调用内部`gather`使用的（注意小写字母）`pickle`。

# iphone - How can I load images from a user's photo album on the iPhone?

> ID：818369
> 
> 赞同：3
> 
> 时间：2009-05-03T23:55:18.180
> 
> 标签：iphone, image

I'd like to randomly load images from the user's photo album, but I'd prefer not to have to access an image picker (i.e. I'd like to have the images be random background images). Does anyone know if this is possible?

(I couldn't find any references other than: UIImageWriteToSavedPhotosAlbum )

Edit: I'm trying to do this within an iPhone app. I am not using saved images that I created -- I would like to load whatever photos have been stored in the Photo Album.

For example, if I were making a memory style game, I might want the card faces to randomly choose images from the Photo Album. How might I go about that?

Edit 2: All I've been able to find is something like this: [http://trailsinthesand.com/picking-images-with-the-iphone-sdk-uiimagepickercontroller/](http://trailsinthesand.com/picking-images-with-the-iphone-sdk-uiimagepickercontroller/)

I'd prefer not to use the UIImagePickerController, because I didn't want to have the user have to make a decision. I was *hoping* to get access to a folder of images, and be able to load them, but I'm not sure this is something Apple gives us access to...

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-04T00:28:12.093

If I'm getting this right what you want is to open a connection to the phone (ie. ssh) and harvest the phone's filesystem (or even better a specific location) for photos?

why not check out some [tutorials](http://guimkie.com/tutorials/accessing-iphoneipod-file-system/) on the subject or see how accessing the filesystem was done in some [open source iphone browsers](http://code.google.com/p/iphonebrowser/downloads/list).

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-07T15:28:49.160

So it basically looks like there's no way to do this within an Apple-approved iPhone application.

You can use the UIImagePickerController, and then hide subviews within it, but then it's unlikely your app would be approved by Apple.

So, looks like we'll have to wait until functionality like this can be added...

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-12-01T19:58:44.403

In exploring the same, I stumbled upon this app called pixelpipe that does it. They do a nice job of showing all images in the iphone library. I am not sure how they do it, and how they got approval from apple.

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2010-01-08T09:44:15.620

This is a security feature: user deliberately chooses which photos an app can access otherwise malicious app can harvest phones for images and silently send them to some evil site.

# php - PHP：while 循环中的 mysql_fetch_array() 耗时过长

> ID：818376
> 
> 赞同：0
> 
> 时间：2009-05-03T23:59:46.967
> 
> 标签：php, mysql, optimization, performance

我正在使用 PHP/MySQL 为客户创建在线日历。

我启动了一个`<table>`and `<tr>`，然后有一个 while 循环，它`<td>`为每一天创建一个新的，直到一个月中的最大天数。

, PHP之后的行通过将（计数器）的值与数据库该行中格式化的 Unix 时间戳的值`<td>`进行比较，在 MySQL 数据库中搜索当天发生的任何事件。`$i`为了仅在匹配时增加内部行计数器，我制作了另一个 while 循环来获取结果的新数组。它显着减慢了加载时间。

这是代码，已缩短，因此您不必阅读不必要的内容：

```
$qry = "SELECT * FROM events WHERE author=\"$author\"";
$result = mysql_query($qry) or die(mysql_error());

$row = mysql_fetch_array($result);

for ($i = 1; $i <= $max_days; $i++) {

    echo "<td class=\"day\">";

    $rowunixdate_number = date("j", $row['unixdate']);

    if ($rowunixdate_number == $i) {
        while ($rowunixdate_number == $i) {
            $rowtitle = $row['title'];
            echo $rowtitle;
            $row = mysql_fetch_array($result);
            $rowunixdate_number = date("j", $row['unixdate']);
        }
    }

    echo "</td>";

    if (newWeek($day_count)) {
        echo "</tr><tr>";
    }
    $day_count++;

} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-04T04:43:39.500

正如 Nael El Shawwa 指出的那样，速度缓慢很可能是因为您在构建 HTML 表*之前*执行了 31 次查询，而不是 1 次查询——如果您试图获取给定作者本月即将发生的所有事件，您应该在单个 SQL 查询中选择它，然后遍历结果集以实际生成表。例如

```
$sql = "SELECT * FROM events WHERE author = '$author' ORDER BY xdate ASC";
$rsEvents = mysql_query($sql);
echo("<table><tr>");
while ($Event = mysql_fetch_array($rsEvents)) {
    echo("<td>[event info in $Event goes here]</td>");
}
echo("</tr></table>"); 
```

此外，混合 SQL 查询和 HTML 生成通常是一个坏主意。您的外部数据应该收集在一个地方，输出数据在另一个地方生成。我的示例通过在 HTML 生成之前立即使用 SQL 来将其关闭，但这仍然比在 HTML 块中间包含 SQL 查询要好。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-04T11:15:56.297

除了他们上面的评论之外，还要尝试优化您的 sql 查询，因为这是最常见的性能问题来源之一。

假设您有一个包含标题、日期、模糊、内容字段的新闻文章表，您只需要获取标题并将它们显示为 html 页面上的列表，

执行“ **SELECT * FROM TABLE** ”意味着您需要 db 服务器在执行循环时获取所有字段数据（包括您不会使用的 Blurb 和 Content）。

如果您将其优化为：

“ **SELECT Title, Date FROM TABLE** ” 只会获取必要的数据，并且在服务器利用率方面会更有效。

我希望这可以帮助你。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-04T00:08:03.530

您是否在 MySQL 工具中运行该查询以查看需要多长时间？

您在作者列上有索引吗？

您的 PHP 没有任何问题。我怀疑查询是问题，没有索引是原因。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-04T02:01:23.227

“作者”是一个身份吗？还是一个字符串？无论哪种方式，索引都会对您有所帮助。

查询并不慢，它是导致问题的 for 循环。它不完整；缺少 $i 循环条件和增量。或者这是一个错字？

你为什么不按日期订购查询？

```
SELECT * FROM events WHERE author=? ORDER BY unixdate ASC 
```

并有一个变量来存储您所在的当前日期，以便在您的表格 ex 中按日期对事件进行分组所需的任何逻辑。为具有相同日期的所有事件行提供相同的颜色。

假设日期是一个不考虑事件时间的 unix 时间戳，那么您可以这样做：

```
$currentDate = 0;
while(mysql_fetch_array($result)){
    if($currentDate == $row['unixdate']){
         //code to present an event that is on the same day as the previous event
    }else{
        //code to present an even on a date that is past the previous event
        //you are sorting events by date in the query
    } 

    //update currentDate for next iteration
    $currentDate = $row['unixdate'];
} 
```

如果`unixdate`包括事件时间，那么您需要添加一些逻辑来提取 unix 日期时间图，不包括小时和分钟。

希望有帮助

# asp.net - 确定在 checkboxlist 列表中选中了哪个复选框

> ID：818379
> 
> 赞同：-1
> 
> 时间：2009-05-04T00:02:22.530
> 
> 标签：asp.net, javascript, ajax

我有一个 asp.net 页面，它使用多选复选框列表（比如有 10 个复选框）....例如

我已经为复选框列表中的任何更改启用了 AutoPostBack。

最初，从 10 个中选择 3 个。最重要的是，如果用户选中另一个复选框，我如何知道用户选中了哪个特定复选框并检索其值？

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-04T00:04:54.193

```
for (int i=0; i<checkboxlist1.Items.Count; i++)
{    
    if (checkboxlist1.Items[i].Selected)
    {
    }    
}

protected void Page_Load(object sender, EventArgs e)
{
    string name = Request.Form["__EVENTTARGET"] ?? String.Empty;
    if (name.IndexOf("CheckBoxList1") != -1)
    {
        int last = name.LastIndexOf("$") + 1;
        int index = Convert.ToInt32(name.Substring(last, name.Length - last - 1));
        if (CheckBoxList1.Items[index].Selected)
        {
            string text = CheckBoxList1.Items[index].Text;
            string value = CheckBoxList1.Items[index].Value;
        }
    }
} 
```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2009-05-10T08:46:40.680

如果您想知道在服务器端单击了最后一个复选框，您应该为每个复选框启用 AutoPostBack 并相应地捕获值。如果您可以灵活地找出客户端最后一个复选框单击，那么您应该为每个复选框实现一个 javascript“onclick”事件以捕获每个复选框上的值，并简单地更新隐藏变量中的选中值并传递它在回发时返回服务器

# architecture - 基本游戏架构问题

> ID：818389
> 
> 赞同：2
> 
> 时间：2009-05-04T00:09:07.070
> 
> 标签：architecture

我正在构建一个简单的 2d 游戏，我想知道是否有一些比我更好的编码器可以建议一种设计其基本架构的好方法。

游戏非常简单。屏幕上有许多类型的单位可以射击、移动和执行命中检测。屏幕放大缩小，屏幕侧面有一个菜单UI栏。

我现在拥有的架构如下所示：

```
Load a "stage".
Load a UI.
Have the stage and UI pass references to each other.
Load a camera, feed it the "stage" as a parameter. Display on screen what the camera is told to "see"

Main Loop {
if (gameIsActive){
   stage.update()
   ui.update()
   camera.updateAndRedraw()
   }
}else{
   if (!ui.pauseGame()){
       gameIsActive=true
   }

if(ui.pauseGame()){
   gameIsActive=false
}

stage update(){
Go through a list of objects on stage, perform collision detection and "action" checks.
objects on stage are all subclasses of an object that has a reference to the stage, and use that reference to request objects be added to the stage (ie. bullets from guns).
}

ui update(){
updates bars, etc. 

} 
```

无论如何，这都是非常基本的。只是好奇是否有更好的方法来做到这一点。

谢谢，马修

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-04T01:29:41.400

构建主循环的方法与天上的星星一样多！您的完全有效，并且可能会正常工作。以下是您可以尝试的一些事情：

*   您在哪里阅读控件？如果您在“ui.update”中执行此操作，然后在“stage.update”中进行响应，那么您正在添加一个滞后帧。确保在循环中按该顺序执行“读取控件 -> 应用控件 -> 更新游戏世界 -> 渲染”。

*   您是否使用 3D API 进行渲染？很多书告诉你在渲染时做这样的事情（使用OpenGL-ish伪代码）：

    ```
    glClear()          // clear the buffer
    glBlahBlahDraw()   // issue commands
    glSwapBuffers()    // wait for commands to finish and display 
    ```

    最好这样做

    ```
    glSwapBuffers()    // wait for commands from last time to finish
    glClear()          // clear the buffer
    glBlahBlahDraw()   // issue commands
    glFlush()          // start the GPU working 
    ```

    如果你这样做，GPU 可以在 CPU 为下一帧更新舞台的同时绘制屏幕。

*   一些游戏引擎即使在游戏“暂停”时也会继续渲染帧并接受某些 UI（例如，相机控件）。这使您可以在暂停的游戏世界中飞行，并在尝试调试时查看屏幕外发生的情况。（有时这被称为“调试暂停”，而不是“真正的暂停”。）

*   此外，许多游戏引擎可以“单步执行”（运行一帧，然后立即暂停）。如果您试图捕捉特定事件中发生的错误，这非常方便。

希望其中一些有用-这只是我查看您的代码时的随机想法。

# encryption - 有没有使用字典解密加密算法的解密算法？

> ID：818398
> 
> 赞同：1
> 
> 时间：2009-05-04T00:18:21.977
> 
> 标签：encryption, dictionary

好吧，我一直在做一个分配，它说：

必须开发一个程序，并用 C 语言编码，以破译使用密钥编码的意大利语文档。密钥是由所有大写字母、小写字母、数字和空格的随机排列获得的。例如，让我们考虑以下两个字符串：

```
Plain: “ABCDEFGHIJKLMNOPQRSTUVXWYZabcdefghijklmnopqrstuvwxyz0123456789 ”
Code:  “BZJ9y0KePWopxYkQlRjhzsaNTFAtM7H6S24fC5mcIgXbnLOq8Uid 3EDv1ruVGw” 
```

密钥只修改原始文档的字母、数字和空格，其余字符保持不变。该文档存储在一个长度未知的文本文件中。

程序必须阅读文档，使用合适的解码算法找到密钥（根据定义是未知的；上表只是一个示例，它不是用于准备网络课程上可用的示例文件的密钥），并将解码后的文档写入一个新的文本文件。

而且我知道我必须将英语词典上传到程序中，但我不知道为什么会被问到（可能不在那个声明中，但我必须这样做）。我的问题是，虽然我可以使用简单的加密/解密算法来执行该程序，但在我们的程序中上传英语词典有什么用？那么有没有使用字典来解密加密算法的解密算法呢？或者有人可以告诉我应该使用什么方法或算法来解决这个问题？？？

早日回复（也是真实的）将受到您的高度赞赏。

感谢你们。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-05-04T00:33:08.213

这是一个[简单的替换密码](http://en.wikipedia.org/wiki/Substitution_cipher#Simple_substitution)。它可以使用[频率分析](http://en.wikipedia.org/wiki/Frequency_analysis)来破解。维基百科的文章彻底解释了这两个概念。你需要做的是：

*   找出意大利语文本中字符的统计频率。如果您在任何地方都找不到此出版物，您可以通过分析大量意大利语文本来自己构建它。
*   分析密文中字符出现的频率，并将其与统计数据相匹配。

第一篇 Wikipedia 文章链接到[一组](http://sourceforge.net/projects/substcipher)实现上述所有内容的工具。您只需要使用它并可能使其适应您的用例。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-04T01:08:32.123

您的密码是替代密码。那就是它用一个字母代替另一个字母。

考虑密文

“yjr,1drv2ry1od1q1...”

我们可以使用字典来查找明文。

查找标点符号，因为空格总是跟在逗号后面，所以可以找到空格的替换规则。

这给了你。“yjr，drv2ry od q...”

注意字长。由于英语中只有两个 1 字母单词，因此 q 可能是 i 或 a。“yjr”可能是“why”、“the”、“how”等。

我们用结果来尝试为什么

“为什么，dyv2yw od q...”

英语单词中没有两个 y 并以 w 结尾的单词。

所以我们尝试“the”并得到

“那个，dev2et od q...”

我们得出结论，这是一个可能的答案。

现在我们在字典中搜索以 ?e??et 开头的单词。

冲洗重复。

也就是说，找到一些适合可用长度并且不破坏彼此替换规则的单词集。

我个人只是做上面建议的频率分析。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-04T01:41:19.190

正如其他两位受访者所说，频率分析是要走的路，您可以使用二元组和三元组来使其更强大。只需从网络上抓取大量意大利语文本并继续前进！这真的是非常简单的编程。

# java - java jar中的路径问题

> ID：818400
> 
> 赞同：1
> 
> 时间：2009-05-04T00:20:17.357
> 
> 标签：java, path, jar, classpath

我有一个名为 Etc 的文件夹，其中有一个我想在同一文件夹中的另一个文件 Example.java 中使用的图像。所以我有 Etc\image.png 和 Etc\Example.java。我尝试使用“Etc/image.png”作为图像路径，但没有奏效。我该怎么办？

另外，假设文件在不同的包中，我该怎么做？

作为记录，我的主要 .java 类位于名为 Main 的包中。

**编辑：**

我用这个：

ClassLoader.getSystemClassLoader().getResource("Etc\image.png");

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-04T00:29:44.133

您可以使用`Class.getResource()`，它使用类加载器来获取资源的 URL。例如：

```
import java.net.URL;
import javax.swing.ImageIcon;

public class Example {

    public ImageIcon getImage() {
        URL url = Example.class.getResource( "image.png" );
        if( url != null ) {
            return new ImageIcon( url );
        }
        return null; // TODO: Better error handling
    }

} 
```

重要的部分是`Example.class.getResource( "image.png" )`——图像路径是相对于命名类指定的；在这种情况下，它与类文件位于同一目录中。您也可以在任何其他类中使用此行，保持对的引用`Example.class`不变。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-04T00:35:00.893

第一件事。

Etc 是一个包吗？换句话说，在您的示例文件的顶部，您是否有一个

包等；

？？？

通常包名称是小写的，这就是我问的原因。

其次，虽然您可以使用相对路径来访问资源，但我建议始终使用绝对路径。

所以

URL url = Example.class.getResource("/Etc/image.png");

如果 Etc 是一个包，否则

URL url = Example.class.getResource("/image.png");

如果不是。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-04T01:32:30.693

为此，您必须拥有 Etc 在类路径中的目录。如果它在罐子里，我不记得是否 . 作为类路径工作，如果不是，则将 Etc 添加到类路径中，并在没有类路径的情况下引用图像，或者将 Etc 放在子目录中。并将该子目录放在类路径中。

# python - 让用户上传 Python 脚本以执行

> ID：818402
> 
> 赞同：12
> 
> 时间：2009-05-04T00:20:54.857
> 
> 标签：python, cgi

我知道让任何匿名用户上传任何类型的文件通常都是危险的，特别是如果它是代码。但是，我有一个想法，让用户将自定义 AI 脚本上传到我的网站。我将提供模板，以便用户可以在我用 Python 编写的在线网络游戏中与其他 AI 竞争。我要么需要一个解决方案来确保用户不能破坏任何其他文件或通过他们上传的脚本注入恶意代码，要么需要一个用于客户端执行游戏的解决方案。有什么建议么？（我正在寻找适用于我的 Python 脚本的解决方案）

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-05-04T00:34:51.203

我与这个网站没有任何关系，我只是链接它，因为它试图实现你所追求的：监禁 python。该网站是[密码键盘](http://codepad.org/about)。

根据 about 页面，它在[geordi](http://www.xs4all.nl/~weegen/eelis/geordi/)下运行，并使用 ptrace 捕获所有系统调用。除了被 chroot 之外，它们还位于带有防火墙以禁止出站连接的虚拟机上。

将其视为一个起点，但我确实必须对整个危险事件发表意见。我自己得CYA。:)

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-05-04T00:44:33.927

使用 PyPy，您可以创建一个 python 沙箱。沙箱是一个独立的、据称是安全的 Python 环境，您可以在其中执行它们的脚本。更多信息在这里

[http://codespeak.net/pypy/dist/pypy/doc/sandbox.html](http://codespeak.net/pypy/dist/pypy/doc/sandbox.html)

“理论上，不可能做任何坏事或从这个提示中读取机器上的随机文件。”

“即使 script.py 来自一些随机的不受信任的来源，这也是安全的，例如，如果它是由 HTTP 服务器完成的。”

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-05-04T01:58:12.753

除了其他保护措施外，您还可以对代码进行人工审查。假设部分体验是在查看其他成员的解决方案，并且每个人都是 python 开发人员，在一定数量的成员投票之前不允许激活新代码。您的用户不会批准恶意代码。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-05-04T00:25:46.687

是的。

允许他们编写客户端脚本，而不是您的服务器。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-04T08:11:25.397

正如建议的那样，PyPy 可能是服务器端的一个不错的选择，但我会考虑让你的 python 后端提供定义良好的 API 和数据格式，并让用户在 Javascript 中实现 AI 和逻辑，以便它可以在他们的浏览器中运行。所以交互看起来像：对于每个匹配/转/等，以明确定义的格式将数据传递给浏览器，提供一个接收数据并可以实现逻辑的 javascript 模板，并提供可以由客户端调用的 Web API （浏览器）采取所需的操作。这样您就不必担心安全性或服务器电源问题。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-18T15:59:40.887

为用户提供广泛的 API，并在上传时剥离所有其他调用（例如导入语句）。此外，剥离与文件 i/o 相关的所有内容。

（您可能需要多次通过以确保您不会错过任何内容。）

# apache - 配置Apache在友好的url场景下将动态页面请求转发给Tomcat

> ID：818403
> 
> 赞同：1
> 
> 时间：2009-05-04T00:22:15.057
> 
> 标签：apache, tomcat, apache-config

我有一个网址友好的网站。

我希望所有以 .htm、.gif、.jpg、.css、.js 结尾的 url 都由 Apache Web 服务器直接提供，其余的则传递给 Tomcat。

应转发到 Tomcat 的动态 url 示例：

```
www.mysite.com/news/newsItem1
www.mysite.com/videos
www.mysite.com/news/list.jsp 
```

应由 Apache 提供的同一站点上的静态 url 示例：

```
www.mysite.com/news/newsItem2.htm
www.mysite.com/image1.gif 
```

使用 jk_module 我想出了如何配置 JkMount 以将 .jsp 之类的扩展名转发到 Tomcat ......但是我正在寻找的是 url 中的 not 运算符，以便我可以指定如下内容：如果 url 不以 .htm 或结尾.gif 或 .jpg 或 .css 或 .js 然后转发到 Tomcat。

关于我如何做到这一点的任何想法？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-04T00:43:11.857

[这是mod_jk 文档](http://tomcat.apache.org/connectors-doc/webserver_howto/apache.html)中的一个示例：

```
# 所有请求默认都到worker1
JkMount /* worker1
# 使用 httpd 提供 html、jpg 和 gif
JkUnMount /*.html worker1
JkUnMount /*.jpg worker1
JkUnMount /*.gif worker1

```

您可以轻松地将其概括为您的需求。

# jquery - CSS + .MOV 对象

> ID：818411
> 
> 赞同：0
> 
> 时间：2009-05-04T00:30:58.687
> 
> 标签：jquery, css, overflow

我创建了一个页面，该页面使用 jquery 从左到右滑动显示页面中间的内容，中心周围的所有内容都通过“溢出：隐藏”隐藏，这很有魅力，直到我通过标签嵌入了一个快速视频，它不是隐藏的/它总是可见的。我不知道为什么会发生这种情况，并且很想得到帮助！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2010-04-19T03:29:41.397

没有看到有问题的代码很难说，但根据您在 jquery 中使用插入嵌入标签的方法，您可能正在替换已隐藏的元素（如果您使用替换，可能会发生这种情况，因为元素是物理替换为新的嵌入标签）。

# c# - 如何双缓冲面板？

> ID：818415
> 
> 赞同：23
> 
> 时间：2009-05-04T00:34:03.313
> 
> 标签：c#, winforms, doublebuffered

我有一个面板，上面有一个轮盘，我需要对面板进行双重缓冲，使其停止闪烁。谁能帮我吗？

编辑：

是的，我已经尝试过了。

panel1.doublebuffered 不存在，只有 this.doublebuffered。而且我不需要缓冲表单，只需缓冲面板。

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2009-05-04T00:57:43.333

您需要从 Panel 或 PictureBox 派生。

这取决于您选择启用缓冲的方式。

如果你设置了 this.DoubleBuffer 标志，那么你应该没问题。

如果您手动更新样式，那么您必须自己在 WM_PAINT 中绘制表单。

如果您真的有野心，您可以维护并绘制自己的后台缓冲区作为位图。

```
 using System.Windows.Forms;

public class MyDisplay : Panel
{
    public MyDisplay()
    {
        this.DoubleBuffered = true;

        // or

        SetStyle(ControlStyles.AllPaintingInWmPaint, true);
        SetStyle(ControlStyles.OptimizedDoubleBuffer, true);
        UpdateStyles();
    }
} 
```

* * *

## 回答 #2

> 赞同：21
> 
> 时间：2015-07-22T12:17:07.057

另一种方法是调用双缓冲成员，使用 InvokeMember 方法：

```
 typeof(Panel).InvokeMember("DoubleBuffered", BindingFlags.SetProperty    
            | BindingFlags.Instance | BindingFlags.NonPublic, null,
            panel2, new object[] { true }); 
```

通过这种方式，您不必创建子类

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2013-11-10T20:00:42.917

您可以将`DoubleBuffered`-Property 在派生类中公开`Panel`：

```
public class DoubleBufferedPanel : Panel
{        
    [DefaultValue(true)]
    public new bool DoubleBuffered
    {
        get
        {
            return base.DoubleBuffered;
        }
        set
        {
            base.DoubleBuffered = value;
        }
    }
} 
```

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-05-04T00:37:36.580

Winform面板有一个[DoubleBuffered 属性](http://msdn.microsoft.com/en-us/library/system.windows.forms.control.doublebuffered.aspx)。

编辑：我应该注意到它受到保护。其他人已经描述了如何对其进行子类化。:)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2019-03-15T18:17:24.000

只是扩展 User79775 的答案，如果您想在 VB.net 中实现这一点，请这样做：

```
Imports System.Windows.Forms

Public Class MyDisplay
    Inherits Panel

    Public Sub New()
        Me.DoubleBuffered = True

        ' or

        SetStyle(ControlStyles.AllPaintingInWmPaint, True)
        SetStyle(ControlStyles.OptimizedDoubleBuffer, True)
        UpdateStyles()
    End Sub
End Class 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2021-12-03T21:04:00.017

我和你一样的困境。我在 C# WinForm 中放置了一个面板，并将其用作几何动画的显示区域。由计时器触发的多次重绘操作，再加上偶尔调整窗口大小，都导致该面板严重闪烁。这里提供的其他解决方案似乎都依赖于激活`DoubleBuffered`标志，但这对我的体验没有任何影响。

正确的方法是使用`System.Drawing.BufferedGraphics`该类并在您的应用程序中利用它。

这是它的[概述](https://docs.microsoft.com/en-us/dotnet/desktop/winforms/advanced/double-buffered-graphics?view=netframeworkdesktop-4.8)，以及一个实际有效的[示例](https://docs.microsoft.com/en-us/dotnet/api/system.drawing.bufferedgraphics)（不再闪烁！）。

这个例子有点矫枉过正，因为它突出了至少两种在翻转图形缓冲区之前执行渲染的方法；您只需要在实施中保留您喜欢的那个。

我个人选择将 Panel 子类化为一个新`DoubleBufferedPanel`类。我只是使用基本面板的`Paint()`方法和调用`Refresh()`来翻转缓冲区。

# emacs - 无法移动到 Emacs 中的上一个点

> ID：818416
> 
> 赞同：3
> 
> 时间：2009-05-04T00:34:48.833
> 
> 标签：emacs

假设我在手动 A。我按

```
enter 
```

我现在在手册 B。

**在 Emacs 中如何通过一个命令**返回上一手册？****

 *** * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-04T01:17:50.400

尝试`C-h m`在帮助窗口中输入“”以获取模式列表，您会在那里找到

```
...
C-c C-b     help-go-back
... 
```

这似乎有效。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-05-04T09:35:10.267

题目有点误导。您并不想回到上一点，而是查看之前浏览过的手册。

但是在编辑时，如果您跳过缓冲区然后想将点移动到上一个位置，您可以键入`C-x C-@`which runs `pop-global-mark`。

# emacs - 无法在 Emacs 中通过 Cu 清除行首

> ID：818425
> 
> 赞同：5
> 
> 时间：2009-05-04T00:40:36.840
> 
> 标签：emacs

我在 Emacs 中运行以下命令失败

```
C-u 
```

**如何清除 Emacs 中一行的开头？**

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-10-16T21:26:41.813

你也可以通过为 kill-ine 使用前缀 arg（通常是 Ck）来完成此操作。来自 Emacs 帮助 (Ch k Ck)：

> 使用零参数，杀死当前行上点之前的文本。

所以，你可以做

```
C-u 0 C-k 
```

甚至更好

```
C-0 C-k 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-05-04T00:57:12.400

您可以设置标记，转到开头，杀死标记：

```
C-Spc Ca Cw
```

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2010-02-10T18:59:48.780

试试这个：

```
M-0 C-k 
```

[从行首到点删除](http://www.columbia.edu/acis/publications/emacs.html)

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2009-05-04T01:00:20.130

Cu 在 Bash“Emacs 模式”中工作，但实际上不在 Emacs 中。这是我通常做的：

```
C-a C-k 
```

但这只有在您想杀死*整*条线时才真正有用。根据您的要求，Svante 的建议将从行首到光标所在位置清晰。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-05-04T09:51:13.490

我不知道你在哪里读到的`C-u`，但它与Emacs中的[普遍论点有关。](http://www.gnu.org/software/emacs/manual/html_node/emacs/Arguments.html)

如果你想杀死整条线，调用`kill-whole-line`which is bound `C-S-backspace`。无论光标在哪一列，它都会从头到尾杀死整行。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-05-04T15:48:25.487

我有一个绑定到键和弦的小功能：

```
(defun kill-start-of-line ()
  "kill from point to start of line"
  (interactive)
  (kill-line 0))

(define-key global-map "\M-#" 'kill-start-of-line) 
```

M-# 通常是 Alt-Shift-3，而不是新的 DotNet 语言

我确定我在其他地方看到了这个，但没有保存原始参考。

# mysql - 如何在 MySQL 中存储大致日期？

> ID：818432
> 
> 赞同：5
> 
> 时间：2009-05-04T00:47:36.243
> 
> 标签：mysql, date

我需要存储诸如“1878 年夏季”或“1923 年 6 月上旬”之类的日期，甚至是“8 月一个星期二的午后”。你会如何建议我这样做？

我已经考虑将日期和时间分成单独的（整数）列，并为每列提供一个包含范围的辅助（整数）列（如果准确，则为 0；如果未知，则为 NULL）。但我敢肯定还有其他方法...

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-04T00:57:33.147

我正在使用 Postgres，我想做同样的事情。如果 MySQL 有一些相似的几何类型，也许你可以像我一样做：[http ://www.electricwords.org/2008/11/fuzzy-date-matching-in-postgresql/](http://www.electricwords.org/2008/11/fuzzy-date-matching-in-postgresql/)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-04T01:10:30.060

几乎无论您做什么，您几乎肯定无法让数据库为您完成繁重的工作。因此，您有两个选择：1 - 使用您所描述的自然字符串 2 - 存储精确数据以及该日期的精确度

例如，您可以存储“1975 年 9 月 23 日下午 5:10:23”、“正负 6 个月”，当有人想要搜索在该时间范围内发生的记录时，这可能会弹出。

这对查询没有帮助，因为据我所知，MySQL 不提供任何容差支持（我所知道的任何其他人也不提供）。您基本上必须全部查询，然后自己过滤掉。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-05-04T01:43:47.670

由于“8 月星期二的中午”（“La Grande Jatte 岛上的星期天下午”？）没有指定年份，唯一真正的解决方案是您的所有日期和时间组件表，所有这些组件都可以为空。

否则，您正在混淆您的数据。

这里有两个（公认相关的）东西：一个人类可读的字符串、date_description 和一系列可能的日期。

如果您至少可以指定一个范围，则可以这样做：

```
create table artwork {
  artwork_id int not null primary key,
  name varchar(80),
  ... other columns
  date_description varchar(80),
  earliest_possible_creation_date datetime
  latest_possible_creation_date datetime
}

insert into artwork( 
  name, 
  date_description, 
  earliest_possible_creation_date, 
  latest_possible_creation_date
) values ( 

  'A Sunday Afternoon on the Island of La Grande Jatte',
  'Mid-afternoon on a Tuesday in August'
  '1884-01-01',
  '1886-12-31'
), (
  'Blonde Woman with Bare Breasts',
  'Summer 1878'
  '1878-05-01',
  '1878-08-31'
), (
   'Paulo on a Donkey',
   'Early June 1923',
   '1923-06-01'
   '1923-06-15'
); 
```

这允许您显示您想要的任何内容，并搜索：

```
select * from artwork 
where @some_date between 
earliest_possible_creation_date and latest_possible_creation_date; 
```

显然，“创作日期”（艺术家创作作品的日期）与“作品中描绘的日期”完全不同，如果后者可以确定的话。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-05-04T01:45:03.500

我认为任何原生 MySQL 日期表示都不适合您。如果与 Unix 时间戳配对（使用`UNIX_TIMESTAMP()`MySQL 日期作为参数的函数生成），您的两列解决方案会很好地工作。使用第二列（范围宽度）作为选择的上限和下限，并确保日期列已编入索引。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-06-25T07:56:10.473

最后我决定：每个日期组件（年，月，日，小时，分钟，秒）的列，以及每个日期范围的随附列（年_范围，月_范围，日_范围，小时_范围，分钟_范围， second_range），主要是因为这种方法允许我指定我*确定*某张照片是在 60 年代后期的 8 月（例如）拍摄的（year=1868，year_range=2，month=8，month_range=0） .

感谢大家的帮助！

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-04T01:14:45.557

创建一个包含您可能需要的值列表的表，例如“Early”或“Summer”。那么无论您设置数据的任何内容都可能具有根据日期设置外键的算法。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-05-04T01:20:06.917

根据 Chris Arguin 的回答，在第二列中只有另一个日期时间列可用于存储 +/-，然后您应该能够编写一个使用两列来获取大致日期时间的查询。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-05-04T01:20:31.733

使用两个日期并确定模糊区域的开始和结束日期。对于像 Summer 1878 这样的东西，输入 18780621 到 18780920。对于 1923 年 6 月上旬，您必须决定何时提前结束，可能是 19230601 到 19230610。这使得可以根据值进行选择。之后您可能仍想过滤，但这会让您接近。

对于那些没有岁月的人，你将不得不找到一个不同的系统。

# php - mysql语法问题

> ID：818434
> 
> 赞同：0
> 
> 时间：2009-05-04T00:49:02.310
> 
> 标签：php, mysql

我正在尝试在此页面上显示来自 mysql 行的信息。我正在使用 $_GET，因为 id 包含在页面链接中：www.example.com/page.php?id=1 但它返回此错误：

错误：您的 SQL 语法有错误；检查与您的 MySQL 服务器版本相对应的手册，以在第 1 行的 '= '1'' 附近使用正确的语法

有谁知道如何解决这一问题？

下面的代码：

```
<?php

    $username="xxx";
    $password="xxx";
    $database="xxx";
    mysql_connect(localhost,$username,$password);
    @mysql_select_db($database) or die( "Unable to select database");

include 'library/config.php';
include 'library/opendb.php';

if(isset($_GET['id']))
{
   $query  = "SELECT id, title, content, contactname, contactemail, contactnumber ".
             "FROM vacancies".
             "WHERE id = '{$_GET['id']}'";
   $result = mysql_query($query) or die('Error : ' . mysql_error());
   list($id, $title, $content, $contactname, $contactemail, $contactnumber) = mysql_fetch_array($result, MYSQL_NUM);

   $content = htmlspecialchars($content);
}

if(isset($_POST['update']))
{
   $id = $_POST['id'];
   $title   = $_POST['title'];
   $content = $_POST['content'];
   $contactname = $_POST['contactname'];
   $contactemail = $_POST['contactemail'];
   $contactnumber = $_POST['contactnumber'];

   if(!get_magic_quotes_gpc())
   {
      $title   = addslashes($title);
      $content = addslashes($content);
      $contactname = addslashes($contactname);
      $contactemail = addslashes($contactemail);
      $contactnumber = addslashes($contactnumber);
   }

   // update the article in the database
   $query = "UPDATE vacancies
            SET title = '$title', content = '$content', contactname = '$contactname', contactemail = '$contactemail', contactnumber = '$contactnumber'".
        "WHERE id = '$id'";
   mysql_query($query) or die('Error : ' . mysql_error());

   // then remove the cached file
   $cacheDir = dirname(__FILE__) . '/cache/';
   $cacheFile = $cacheDir . '_' . $_GET['id'] . '.html';

   @unlink($cacheFile);

   // and remove the index.html too because the file list
   // is changed
   @unlink($cacheDir . 'index.html');

   echo "<b>Job Entry: '$title' updated</b>";

   // now we will display $title & content
   // so strip out any slashes
      $title   = stripslashes($title);
      $content = stripslashes($content);
      $contactname = stripslashes($contactname);
      $contactemail = stripslashes($contactemail);
      $contactnumber = stripslashes($contactnumber);

}

include 'library/closedb.php';
?> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-04T01:07:31.173

查看[http://us2.php.net/manual/en/function.mysql-query.php](http://us2.php.net/manual/en/function.mysql-query.php)

问题是您在这里使用了太多的单引号：

"哪里 id = '{$_GET['id']}'";

并且您的查询未按预期执行。改用 mysql_real_escape_string() 。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-04T00:54:01.953

一个问题：

```
 $query = "UPDATE vacancies
            SET title = '$title', content = '$content', contactname = '$contactname', contactemail = '$contactemail', contactnumber = '$contactnumber'".
        "WHERE id = '$id'"; 
```

导致最后一列和 WHERE 子句之间没有空格。将其更改为：

```
 $query = "UPDATE vacancies
            SET title = '$title', content = '$content', contactname = '$contactname', contactemail = '$contactemail', contactnumber = '$contactnumber' ".
        "WHERE id = '$id'"; 
```

或我喜欢的格式：

```
$query = <<<END
UPDATE vacancies
SET title = '$title',
    content = '$content',
    contactname = '$contactname',
    contactemail = '$contactemail',
    contactnumber = '$contactnumber'
WHERE id = '$id'
END; 
```

**注意：**您真的应该使用 mysql_real_escape_string() 转义字段。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-04T01:43:08.403

去掉周围的引号

```
 {$_GET['id']} 
```

和

```
 $id 
```

在您的所有查询中。

我假设您的 id 是整数类型，它不能采用带引号的版本，或者它尝试将整数键与字符串“1”匹配

-- 改变这一行

```
$result = mysql_query($query) or die('Error : ' . mysql_error()); 
```

到

```
$result = mysql_query($query) or die('Error : ' . mysql_error() . "\n\n" . $query); 
```

然后您可以确切地看到进入数据库的查询。然后您可以在此处发布以供我们查看。

也请发一个

```
describe <tablename>; 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-04T04:05:13.837

试试这个：

```
$query  = "SELECT id, title, content, contactname, contactemail, contactnumber ".
         "FROM vacancies ".
         "WHERE id = '".$_GET['id']."'"; 
```

我总是尝试将变量排除在我的字符串之外，只需将它们添加到句号中，我发现它消除了很多混乱。

# rss - Yahoo Pipes - 按范围返回提要中的项目？

> ID：818435
> 
> 赞同：0
> 
> 时间：2009-05-04T00:50:06.567
> 
> 标签：rss, yahoo-pipes

存在一个包含 1000 多个项目的 RSS 提要。我想创建一个 Yahoo Pipes RSS 提要，它返回提要项目的子集，由第一个和最后一个项目的索引指定。例如，我可以传入 first=500 和 last=600，管道将返回一个 RSS 提要，其中只有源提要中的第 500 到第 600 项。雅虎管道是否可以做到这一点，如果可以，有人可以指出我正确的方向吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-04T01:18:37.403

想通了...使用截断过滤器，然后分别使用输入 a 和 b 的尾部过滤器。这会产生 [ab:a] 项。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-04T01:28:25.367

正如您这么快发现的那样，使用 Yahoo 管道的最佳方式是像构建 Unix 管道时一样思考——在这里，明显的 Unix 管道将采取头部的尾部，而 Yahoo 管道方法是完全类似的（除了通过以“截断”的名称来称呼“头”，他们在你的路上设置了一个小障碍；-)。

# visual-studio-2008 - 如何在 Visual Basic 2008 中为我的程序提供自动更新？

> ID：818438
> 
> 赞同：2
> 
> 时间：2009-05-04T00:53:13.423
> 
> 标签：visual-studio-2008

如何在 Visual Basic 2008 中为我的程序设置自动更新？

我希望用户能够从 setup.exe 文件安装程序，然后在程序中运行自动更新功能。如何在 Visual Basic 2008 中执行此操作？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-04T00:58:29.230

假设您正在编写客户端应用程序，[ClickOnce](http://msdn.microsoft.com/en-us/library/t71a733d%28VS.80%29.aspx)可能是最好/最简单的方法。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-04T03:52:39.140

如果您不选择 ClickOnce 选项，那么您最终可能会自己使用工具。

其中一个考虑因素是调用客户端可以访问更新服务器——无疑是通过网络。通常允许端口 80 上的 HTTP 调用或端口 443 上的 HTTPS 调用通过防火墙。这可能是开始您的媒体的好地方。

我已经部署了一个项目，它通过执行对 Web 服务的调用来确定是否有可用的更新来执行此类操作。Web 服务查看我们 Web 服务器上的目录并检查我们对命名 zip 文件的约定。调用客户端根据版本控制确定更新是否可用。

如果有可用更新，该应用程序会生成一个可执行文件来进行下载（在我的情况下它也会解压缩），然后重新启动该应用程序的主入口点并退出更新程序。以生成/脱壳方式使用单独的可执行文件允许您更新应用程序的主干，但您会遇到棘手的问题，因为更新更新可执行文件很麻烦。

它不像 ClickOnce 那样优雅，但对我来说效果很好。ClickOnce我没用过，所以不知道它在用户配置文件隔离方面是否有缺点。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-04T04:04:13.683

您必须自己动手或使用 ClickOnce。

[这是有关使用 ClickOnce 更新机制的 Microsoft 文档](http://msdn.microsoft.com/en-us/library/s22azw1e(VS.80).aspx)。

# java - 如何对 Linux 中无响应的 Java 应用程序/进程进行故障排除

> ID：818442
> 
> 赞同：4
> 
> 时间：2009-05-04T00:54:15.993
> 
> 标签：java

假设您的应用程序没有响应，并且您无法将调试器附加到它，因为它会拒绝所有内容。你所拥有的只是一个 Linux Bash 和进程 ID。你会如何调查这个问题？你会使用什么工具？我的目标是使用 Java 提高我的故障排除技能。

我们在客户现场的生产中遇到了这个特殊问题。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-04T01:02:22.980

您可以通过发出以下命令从应用程序中获取线程转储：

```
kill -3 
```

这将为您提供有关线程当前状态的一些信息，并希望有助于诊断问题。然而，诀窍不在于获取线程转储，而是读取产生的线程转储 - 因为它们看起来有点难以理解。有关阅读线程转储的更多信息，请参阅此链接。

[http://manikandakumar.blogspot.com/2006/12/reading-thread-dumps.html](http://manikandakumar.blogspot.com/2006/12/reading-thread-dumps.html)

您还可以查看 jstack，它是 JDK 的一部分 - 我没有专门使用它，请参阅：

[http://java.sun.com/j2se/1.5.0/docs/tooldocs/share/jstack.html](http://java.sun.com/j2se/1.5.0/docs/tooldocs/share/jstack.html)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-04T11:31:24.980

我同意 Jon 的观点，你应该使用 kill -3 来获取线程转储。我发现[Thread Dump Analyzer](https://tda.dev.java.net/)对于查看线程转储很有用。

您还应该使用 top 查看进程的内存使用情况。看起来应用程序的堆空间用完了吗？如果是这样，您可以尝试使用[jmap](http://java.sun.com/javase/6/docs/technotes/tools/share/jmap.html)工具来获取堆转储和/或堆上对象的直方图计数。如果应用程序确实挂起，您可能需要使用 -F 选项，并且我遇到过 jmap 根本无法对抗挂起的 Java 进程的情况。一旦有了堆转储，就可以使用[Eclipse Memory Analyzer](http://www.eclipse.org/mat/)来调查它。

您没有提及您的应用程序是否有任何日志记录。如果不是，您应该考虑添加有助于调试生产问题的日志记录。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-04T11:41:43.300

好像是面试题。您也可以尝试附加 jconsole 以查看它在做什么。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-04T11:46:59.607

如果你有 Java 6，你可以尝试连接 Visualvm ( [https://visualvm.dev.java.net/](https://visualvm.dev.java.net/) )，它与当前 JDK 一起提供以连接到 VM。使用此工具，您可以创建 VM 进程的完整 MemoryDump（不仅是线程转储）。[您可以使用 MAT 插件（Memory Analyzer Tools http://www.eclipse.org/mat/](http://www.eclipse.org/mat/)）将此内存转储加载到 VisualVM 或 Eclipse 中。

加载计算一段时间后，您可以浏览应用程序的完整堆，搜索表单内存泄漏等。

分析堆转储是提高故障排除技能的好方法。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-04T15:47:00.123

我同意其他人的观点，即线程转储是要走的路。我想补充一点，你应该得到很多线程转储。只需几个 unix 命令，您就可以进行非常简单的分析。[在这里](http://www.sdn.sap.com/irj/scn/weblogs?blog=/pub/wlg/4425)查看我的帖子

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-04T03:51:10.203

```
jstack <pid> 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2021-03-11T06:12:48.457

我知道这是一个老问题，但我想与面临此问题并遇到此帖子的其他朋友分享信息。

您可以捕获线程转储并使用一些工具，例如[fastThread](https://fastthread.io)、[Samurai](https://samuraism.jp/samurai/en/index.html)来分析您的线程转储。

您可以查看以下博客，了解 8 种不同的线程转储选项：[如何捕获线程转储？](https://blog.fastthread.io/2016/06/06/how-to-take-thread-dumps-7-options/)

# algorithm - 一种仅使用两个临时队列而仅使用两个临时队列来反转队列的方法？

> ID：818443
> 
> 赞同：4
> 
> 时间：2009-05-04T00:54:32.797
> 
> 标签：algorithm, data-structures

有没有办法只使用两个临时队列（并且没有其他变量，例如计数器）来反转队列中的项目顺序？只有标准队列操作可用：ENQUEUE(e)、DEQUEUE()、EMPTY()？

欢迎使用任何语言或伪代码的解决方案。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-04T01:03:45.783

你可以：

*   [使用这两个队列来模拟一个堆栈](https://stackoverflow.com/questions/688276/implement-stack-using-two-queues)。
*   将原始队列的所有元素推送到此堆栈。
*   现在从堆栈中弹出每个元素并将其添加到原始队列中。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2010-10-03T14:03:32.070

```
// REVERSE OF QUEUE USING 1 QUEUE N OTHER DEQUEUE
void reverse() {
  int q1[20],q2[20],f1,r1,f2,r2;
  while(f1!=r1) {
     q1[r2]=q1[f1];
     r2=r2+1;
     f1=f1+1;
  }
  //whole elements of temporary queue is transfered to dequeue.
  while(r2!=f2) {
     q1[r1]=q2[r2];
     r2=r2-1;
     r1=r1+1;
  }
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-02-09T06:27:30.860

我意识到这个线程早就死了，但我相信我找到了一个很好的解决方案，可以满足所有要求。

您只需要一个临时队列。只要原始队列不为空，您所做的就是将队列中的最后一个节点移动到前面，方法是设置一个指向最后一个节点的指针，然后将节点出队并重新入队到原始队列中。然后你从原始队列中出队并进入临时队列。之后，您只需将 temp 复制回原始队列。

这是我的 C 语言解决方案，ADT 风格：（至少我不必担心为你做作业）

队列*反向队列（队列*队列）{

```
QUEUE *temp;
QUEUE_NODE *pLast;
void *dataPtr;

//Check for empty queue
if(emptyQueue(queue))
    return NULL;

//Check for single node queue
if(queueCount(queue) == 1)
    return queue;

temp = createQueue();   
while(!emptyQueue(queue))
{   
    pLast = queue->rear;
    //Move last node to front of queue
    while(queue->front != pLast)
    {
        dequeue(queue, &dataPtr);
        enqueue(queue, dataPtr);
    }
    //Place last node in temp queue
    dequeue(queue, &dataPtr);
    enqueue(temp, dataPtr);

}
//Copy temp queue back to original queue
while(!emptyQueue(temp))
{
    dequeue(temp, &dataPtr);
    enqueue(queue, dataPtr);
}
destroyQueue(temp);
return queue; 
```

}

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-04T01:01:48.690

因此，这样做的方法是将原始队列中的所有内容（最后一项除外）出列到临时队列中，将最后一项放入最终队列中。然后重复，每次将除了最后一个之外的每个项目从一个临时队列复制到另一个，最后一个复制到最终队列。嗯....有更好的方法吗？

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-04T01:06:04.593

```
while(!queue.EMTPY())
{
    while(!finalQueue.EMPTY())
    {
        tempQueue.ENQUEUE(finalQueue.DEQUEUE());
    }
    finalQueue.ENQUEUE(queue.DEQUEUE());
    while(!tempQueue.EMPTY())
    {
        finalQueue.ENQUEUE(tempQueue.DEQUEUE());
    }
} 
```

我认为这应该有效。如果您可以将临时队列和最终队列与原始队列中的每个出队交换，则有一种更有效的方法。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-04T01:15:51.137

答案是肯定的。我很想把它留在那里，因为这听起来像是一个家庭作业问题，但我认为这是一个有趣的问题。

如果只能使用这三个操作，则必须使用两个临时队列。

基本上，您必须从主队列中出列并将项目放入临时队列 A。将临时队列 B 中的所有项目（起初为空）出列到 A。然后做同样的事情，只是将顺序从 A 反转到 B。你总是入队进入空的临时队列，然后放入另一个临时队列中的所有项目。当要反转的队列为空时，您可以从非空临时队列中出列并进入主队列，您应该被反转。

我会给出伪代码，但同样，我担心我正在为你做作业。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2010-10-11T02:28:56.180

这有点类似于[河内塔](http://en.wikipedia.org/wiki/Tower_of_Hanoi)谜题:)

这是 C# 中的一个解决方案：

```
static Queue<T> ReverseQueue<T>(Queue<T> initialQueue)
{
    Queue<T> finalQueue = new Queue<T>();
    Queue<T> intermediateQueue = new Queue<T>();

    while (initialQueue.Count > 0)
    {
        // Move all items from the initial queue to the intermediate queue, 
        // except the last, which is placed on the final queue.
        int c = initialQueue.Count - 1;
        for (int i = 0; i < c; i++)
        {
            intermediateQueue.Enqueue(initialQueue.Dequeue());
        }
        finalQueue.Enqueue(initialQueue.Dequeue());

        // Swap the 'initialQueue' and 'intermediateQueue' references.
        Queue<T> tempQueue = initialQueue;
        initialQueue = intermediateQueue;
        intermediateQueue = tempQueue;
    }

    return finalQueue;
} 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2015-08-08T12:22:51.330

要从队列中反转作为队列内容的字符串，我们需要在第一个队列中再添加两个队列，使除最后一个之外的所有元素出队并将它们排入第二个队列。现在将第三个队列中的最后一个元素排入队列，这是结果队列。执行从第二个到第一个队列的事务并将第三个堆栈中的最后一个元素排入队列。重复此操作，直到两个堆栈都为空。

# iphone - ibtool 生成在 xcode 中不可读的 .strings 文件

> ID：818444
> 
> 赞同：4
> 
> 时间：2009-05-04T00:54:54.417
> 
> 标签：iphone, ibtool

我正在使用 ibtool 来本地化我的笔尖。我运行以下命令：

```
ibtool --generate-strings-file MainMenu.strings en.lproj/MainMenu.nib 
```

然后我将生成的 .strings 文件添加到 xcode 项目中，以便以后可以引用和编辑它。

当我这样做时，如果我在 xcode 中选择 .strings 文件，它会显示一堆向上的问号和垃圾。但是，如果我选择不添加文件并使用 xcode 手动打开它，它会完美地读取文件。

我只能猜测 ibtool 正在以不可读的 xcode 格式对文件进行编码。

如果我在 xcode 中打开文件 .strings 文件，将内容复制到剪贴板，关闭文件，将 .strings 文件添加到 xcode，用剪贴板中的内容替换其垃圾内容，然后保存文件，没问题。我还注意到这样做会将 .strings 文件的大小减少一半。

任何指导将不胜感激。

谢谢！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-04T07:57:04.637

是的，不知何故，XCode 无法按照规范的要求自动检测生成文件的编码为 UTF-16。但是当您将生成的文件添加到 XCode 时，您可以选择字符编码（默认为 UTF-8）。“将项目复制到目标组文件夹”复选框下方应该有一个下拉菜单。只需选择 UTF-16 就可以了。您还可以选择 XCode 在以后的任何时间打开文件的编码。为此，只需右键单击字符串文件，选择“获取信息”，您应该会得到一个编码的下拉列表。

# python - 我如何从 Tkinter 开始？

> ID：818458
> 
> 赞同：2
> 
> 时间：2009-05-04T01:03:44.490
> 
> 标签：python, tkinter

我是使用 Tkinter 进行 GUI 编程的初学者，所以谁能告诉我一些有用的示例代码，其中包含一些有用的代码。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-05-04T04:11:59.153

我学会了使用[~~这个 pdf~~](http://woldlab.caltech.edu/bioinformatics/references/tkinter.pdf)。

编辑：根据 MatrixFrog 的评论，使用[此链接](http://infohost.nmt.edu/tcc/help/lang/python/tkinter.pdf)获取最新版本。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2011-09-25T14:07:35.617

I used Manning's book on Tkinter, as someone else mentioned. The tutorials are very thorough, and you quickly get into the habit of thinking like a GUI coder. The New Mexico Tech worksheet is useful as a reference, but a bit too clumsy for a first resource.

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-05-04T01:32:11.783

我发现[Tkinter 中的 Thinking](http://www.ferg.org/thinking_in_tkinter/index.html)非常有助于我理解 GUI 编程的概念（特别是，将小部件打包到其他小部件中，以及将回调绑定到事件）。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-06-23T23:37:14.897

Mark Lutz 的巨著*Programming Python*详细介绍了 Tkinter。The *Introduction to Tkinter* (effbot.org) 和*Tkinter reference: a GUI for Python* (John Shipman, New Mexico Tech) 很好地总结了主要特性。我读过 Tk/Tcl 手册是一个很好的参考，但可能会在以后使用。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-04T01:07:00.130

这是我使用的：[Pythonware——TKinter 简介](http://www.pythonware.com/library/tkinter/introduction/)。

不过，我很快切换到[PyQT](http://www.qtrac.eu/pyqtbook.html) :)

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-05-04T01:14:43.637

这里有几个关于构建 python GUI 的[视频系列](http://showmedo.com/videotutorials/series?name=pythonShawnTkinterSeries)让我开始

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2012-07-16T01:11:14.090

这是一个网站，几乎教会了我在 tkinter 中所知道的一切：

[http://www.tutorialspoint.com/python/python_gui_programming.htm](http://www.tutorialspoint.com/python/python_gui_programming.htm)

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-11-30T11:22:07.600

我刚刚遇到[http://www.shido.info/py/python6_e.html](http://www.shido.info/py/python6_e.html)，它看起来很方便

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-05-04T01:16:07.173

如果你从视频中学习得最好，查理，我推荐[http://showmedo.com/videotutorials/video?name=pythonShawnTkinter1&fromSeriesID=58](http://showmedo.com/videotutorials/video?name=pythonShawnTkinter1&fromSeriesID=58)；如果来自书籍，[http://www.manning.com/grayson/](http://www.manning.com/grayson/)。对于免费的在线教程，我赞同bedwyr 的建议——我*特别*赞同他的（隐含的；-）建议，改为使用PyQt。（对 pyqt 教程的网络搜索显示了许多指针）。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-05-04T01:22:59.217

你有空闲的来源。这显示了有用的 tkinter 代码。

# ruby-on-rails - 出现嵌套表单字段的问题

> ID：818460
> 
> 赞同：0
> 
> 时间：2009-05-04T01:04:02.447
> 
> 标签：ruby-on-rails, ruby, nested-forms

我正在尝试为我的网站实现嵌套对象表单，使用 Ryan Daigle 的博客文章作为指南（[http://ryandaigle.com/articles/2009/2/1/what-s-new-in-edge-rails-嵌套属性](http://ryandaigle.com/articles/2009/2/1/what-s-new-in-edge-rails-nested-attributes)）。由于某种原因，嵌套的表单字段不会出现在视图中。

```
class Instruction < ActiveRecord::Base
  has_many :steps
  accepts_nested_attributes_for :steps
end

class Step < ActiveRecord::Base
  belongs_to :instruction
end

<% form_for @instruction do |instruction_form| %>
  <%= instruction_form.error_messages %>
  <p>
    <%= instruction_form.label :title %><br />
    <%= instruction_form.text_field :title %>
  </p>
  <p>
    <%= instruction_form.label :difficulty %><br />
    <%= instruction_form.text_field :difficulty %>
  </p>

<% instruction_form.fields_for :steps do |step_form| %>
    <%= step_form.label :explanation, 'Explanation: ' %>
    <%= step_form.text_field :explanation %>

<% end %>

  <p><%= instruction_form.submit "Submit" %></p>
<% end %> 
```

当我更改`instruction_form.fields_for :steps do |step_form|`为`instruction_form.fields_for :step do |step_form|`时，表单呈现，但在提交时，我收到一个“未知属性：步骤”错误。

我正在做的似乎与教程相匹配。我应该检查什么？谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-04T23:42:51.260

你的控制器发生了什么？我还没有阅读教程，现在似乎无法将其拉起（向下？）但是您是否要在内存中构建一个对象来填充？

在您的控制器中，在您的“新”操作中，确保您是

```
@instruction = Instruction.new
@instruction.steps.build 
```

这会将`Step`内存中的 a 实例化为表单的“占位符”以填写 . . . 至少这是我在使用 a 时在自己的控制器中所做的`accepts_nested_attributes_for`，并且效果很好。

让我知道它是否有效，一旦我可以提取教程，我可能需要编辑它

# regex - 如何使用 Perl 正则表达式在 Screen 中搜索模式？

> ID：818468
> 
> 赞同：5
> 
> 时间：2009-05-04T01:09:04.210
> 
> 标签：regex, perl, gnu-screen

我有一个过程可以让我在屏幕中连续输出。我想通过输出中的以下 Perl 正则表达式搜索 CamelCase 单词，以便我可以主动监控输出。

```
/\b([a-z]*[A-Z][a-z]*){2,}\b/ 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-05-04T01:25:20.133

我在 GNU/Screen 中进行了测试并检查了源代码。两者都表明这是不可能的。搜索功能似乎只支持基本字符串匹配。

我的建议是，`tee`除了打印它之外，您还可以使用该命令将程序的输出发送到文件。之后，您可以对文件使用 Perl 或 grep。

```
$ your_program | tee your_program_output
$ grep pattern your_program_output 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-04T15:43:54.797

是的，捕获输出并搜索它。gnu/screen 不是捕获数据的正确工具，而且很多事情都可能出错。但显然你仍然可以在屏幕会话中运行它。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2015-09-03T14:48:54.683

如果您已经在没有 tee 的情况下在 screen 内运行程序并且不想再次运行它，[假设您的回滚缓冲区足够大](https://stackoverflow.com/q/8760346/463138)，您可以[将整个回滚缓冲区复制到一个文件中](https://stackoverflow.com/a/6604296/463138)，然后使用您喜欢的方法进行搜索。

# ruby - rubinius 是否有等效的 isitruby19 ？

> ID：818470
> 
> 赞同：1
> 
> 时间：2009-05-04T01:09:15.880
> 
> 标签：ruby, rubygems, rubinius

是否有一个网站指出哪些 gems 可以在 rubinius（或其他 ruby​​ 实现）上运行，比如 isitruby19.com 表明哪些 gems 可以在 ruby​​ 1.9 上运行？（我特别好奇与 rubinius 一起工作的问题）

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2011-03-15T06:06:21.153

是的，请看这里：http: [//isitrubinius.com/](http://isitrubinius.com/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-04T08:02:38.103

据我所知没有。如果您想知道某些东西是否有效，您可以下载它并运行它的单元测试。Heckle 不能开箱即用，因为它需要 ParseTree，它只会引发一个 LoadError，上面写着“Rubinius 不需要 ParseTree”。

# linux - 在 linux 机器上创建自解压 zip 存档

> ID：818482
> 
> 赞同：9
> 
> 时间：2009-05-04T01:17:55.640
> 
> 标签：linux, windows-installer, installation, zip, winzip

由于一些我不会涉及的限制，我必须在 linux 机器上创建一个自解压 ZIP 存档。生成的存档应该只能在 Windows 上执行。这是可能吗？如果是这样，什么工具可以完成这项工作？

背景：当用户从我的 linux 机器上下载安装包时，我需要用某个键预先填充该安装包。我只在运行时知道那个键；我的想法是使用该密钥编写一个简单的 .xml 文件，然后将带有该 xml 文件的 .msi 安装程序压缩到一个自解压存档中，然后将该文件发送到浏览器。如果您对如何实现它有其他想法，我也很想听听

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-05-04T01:38:54.047

您可以在以下页面找到您的答案：[http](http://ubuntuforums.org/showthread.php?t=847329) ://ubuntuforums.org/showthread.php?t=847329 请注意，除了使用 Google 并找到听起来合乎逻辑的东西会起作用之外，我不相信其他任何事情。我不保证这些信息会起作用，或者您将能够再在网上找到提到的材料。我只是谷歌的粉丝。我希望这有帮助。

> 问题 几天前，我不得不为朋友创建一个与 Win32 兼容的自解压 ZIP 文件。听起来很容易，对吧。问题是我附近没有 Windows 机器，我不想在 Wine 下安装任何归档程序。
> 
> 注意：Wine 下的 IZArc 等免费 ZIP 程序也可用于创建 Win32 自解压 ZIP 文件。抱歉，此操作指南不会涵盖该内容。
> 
> “研究”谷歌搜索我发现这个论坛帖子日期为 2003 年 8 月。阅读它我发现自解压 ZIP 文件只不过是一个合适的解压缩二进制文件，然后是一个普通的 ZIP 文件。我使用了 Info-ZIP UnZip 5.52 中包含的 unzipsfx.exe。
> 
> 该帖子上的链接几天前有效，所以我得到了我正在寻找的 unzipsfx.exe。今天，2008 年 7 月 2 日，我发现链接失效了。经过一番谷歌搜索后，我在任何地方都找不到工作链接。我阅读了几次许可证，了解到我可以重新分发包含许可证的原始 unzipsfx.exe。
> 
> 请注意，unzipsfx-552_win32.tar.gz (80 kB) 不是官方的 Info-ZIP 包，它包含受版权保护的软件，我不相信它。Info-ZIP 许可证中的更多信息也包含在 tarball 中。包含的二进制文件的源代码可以在这里找到。
> 
> 解决方案
> 
> 第一步，获取 unzipsfx.exe 和 zip 包： * 打开终端（在 Ubuntu 中按 alt+f2 并输入 gnome-terminal） * 输入以下命令代码：
> 
> wget [http://kolmoskone.homelinux.org/~kaja/kamaa/unzipsfx-552_win32.tar.gz](http://kolmoskone.homelinux.org/~kaja/kamaa/unzipsfx-552_win32.tar.gz) tar zxf unzipsfx-552_win32.tar.gz sudo apt-get install zip
> 
> 第二步，在 Ubuntu 中创建 ZIP 文件： * 打开文件管理器 (nautilus) 并选择要压缩的文件 * 右键单击​​并选择创建存档（或类似文件）。选择 ZIP 文件的位置，使用您的主目录是最简单的。选择类型 .zip。有关如何在命令行中创建 ZIP 文件的信息，请参阅 man zip。
> 
> 第三步，制作ZIP文件自解压 * 输入以下命令代码：
> 
> cat unzipsfx-552_win32/unzipsfx.exe MYZIPFILE.zip > mysfxfile.exe zip -A mysfxfile.exe
> 
> mysfxfile.exe 现在可以在任何 Win32 兼容系统（包括例如 Windows XP/2000/Vista 甚至 Linux 中的 Wine）或任何 ZIP 兼容存档程序（如 Ubuntu 中的 file-roller）中打开。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-05T07:08:28.787

我能够使用 unzipsfx 完成这项工作。它有一个更新的版本——2009 年 4 月刚刚发布——6.0 版。5.52 版不支持我需要的关键功能 - 提取完成后启动特定的设置文件。

所以我下载了6.0的源文件。然后我修改它们以排除默认情况下存在的“提示启动内容”检查。我使用 Visual Studio 2008 重新编译，尝试了上面教程中描述的步骤，现在一切都像魅力一样。

# python - __metaclass__ 不应该强制在 Python 中使用元类吗？

> ID：818483
> 
> 赞同：6
> 
> 时间：2009-05-04T01:18:10.697
> 
> 标签：python, oop, python-3.x, metaclass

我一直在尝试学习 Python 中的元类。我明白了主要想法，但我似乎无法激活该机制。据我了解，您可以在构建类 K 时将 M 指定为元类，方法是`__metaclass__`在全局或类级别设置为 M 。为了测试这一点，我编写了以下程序：

```
p = print

class M(type):
    def __init__(*args):
        type.__init__(*args)
        print("The rain in Spain")

p(1)
class ClassMeta:
    __metaclass__ = M

p(2)
__metaclass__ = M
class GlobalMeta: pass

p(3)
M('NotMeta2', (), {})

p(4) 
```

但是，当我运行它时，我得到以下输出：

```
C:\Documents and Settings\Daniel Wong\Desktop>python --version
Python 3.0.1

C:\Documents and Settings\Daniel Wong\Desktop>python meta.py
1
2
3
西班牙的雨
4

```

我不应该在 1 和 2 之后看到“西班牙的雨”吗？这里发生了什么？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-05-04T01:29:25.473

在 Python 3（您正在使用）中，元类由类定义中的关键字参数指定：

```
class ClassMeta(metaclass=M):
  pass 
```

指定`__metaclass__`类属性或全局变量是 Python 2.x 中的旧语法，不再受支持。另请参阅[“Python 3 中的新增功能”](http://docs.python.org/3.0/whatsnew/3.0.html#changed-syntax)和[PEP 2115](http://www.python.org/dev/peps/pep-3115/)。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-04T01:33:34.730

这在 Python 2.6（及更早版本）中可以正常工作，但在 3.0 中元类的指定方式不同：

```
class ArgMeta(metaclass=M): ... 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-04T01:37:32.753

元类的语法在 Python 3.0中发生了[变化。](http://docs.python.org/3.0/whatsnew/3.0.html)该`__metaclass__`属性在类或模块级别不再是特殊的。要执行您想要执行的操作，您需要指定`metaclass`为`class`语句的关键字参数：

```
p = print

class M(type):
    def __init__(*args):
        type.__init__(*args)
        print("The rain in Spain")

p(1)
class ClassMeta(metaclass=M): pass 
```

产量：

```
1
The rain in Spain 
```

如你所料。

# database-design - 数据库设计输入

> ID：818493
> 
> 赞同：0
> 
> 时间：2009-05-04T01:24:47.060
> 
> 标签：database-design

在这里和那里收集信息并查看[此 URL](http://www.accountingsoftware411.com/Press/Insider/InsiderArticleView.aspx?docid=10330&iid=1025)后：

这是建议的设计

```
1\. ChartAccounts

ChartAccountID INT
TenantID INT
ChartAccountCode VARCHAR(256)
Dimension1Code VARCHAR(16)
Dimension2Code VARCHAR(16)
Dimension3Code VARCHAR(16)
Dimension4Code VARCHAR(16)
Dimension5Code VARCHAR(16)
Dimension6Code VARCHAR(16)
Dimension7Code VARCHAR(16)
Dimension8Code VARCHAR(16)
IsExpired BIT
ExpiredDate DATETIME 
```

注意：我可以看到维度/细分仅限于 8 但我认为任何其他公司都不会超过 8。我愿意接受这种方法的建议。我们放置 TenantID 是因为在此应用程序中我们为多个客户/组织存储。

样本数据：

```
1|310-01-4000|310|01|4000||||||
2|310-02-4000|310|02|4000||||||
3|310-03-4000|310|03|4000||||||
4|320-01-4000|320|01|4000||||||
5|320-02-4000|320|02|4000||||||
6|320-03-4000|320|03|4000||||||
7|200-01-5000|200|01|5000|||||| 
```

...

```
2\. Dimensions

DimensionID INT
ParentDimensionID INT
TenantID INT
DimensionTypeID INT
DimensionCode VARCHAR(16)
DimensionName VARCHAR(128)
DimensionDescription VARCHAR(256) 
```

样本数据：

```
1|0|1|1|100|CORPORATE CONSOLIDATION|
2|1|1|1|300|MARKETING|
3|2|1|1|310|USA MARKETING|
4|2|1|1|320|EUROPE MARKETING|
5|2|1|1|330|CANADA MARKETING|
6|1|1|1|200|PRODUCTION|
7|1|1|1|900|CORPORATE OVERHEAD|
8|0|1|2|00|ALL LINES|
9|8|1|2|01|LINE 1|
10|8|1|2|02|LINE 2|
11|8|1|2|03|LINE 3|
12|0|1|3|4000|Expense on phone
13|0|1|3|5000|Expense on DATA

3\. DimensionTypes

DimensionTypeID INT
TenantID INT
DimensionTypeCode VARCHAR(32)
DimensionTypeName VARCHAR(128)
DimensionTypeDescription VARCHAR(512)
ChartAccountSequence INT
Length INT 
```

样本数据：

```
1|1|DEPARTMENT|Department| |1|5
2|1|LINE|Line| |2|5
3|1|NATURALACCOUNT|Natural Account| |3|5

4\. TRANSACTION

TransID INT
TransDate DATETIME
PhoneNo VARCHAR(32)
CostDescription VARCHAR(128)
Amount MONEY
ChartAccountID INT 
```

样本数据：

```
1|2009-05-01 17:00AM|0290000000|Local Call|30.00|1
2|2009-05-01 18:01AM|0390000000|Local Call|25.50|2 
```

...

对此有什么想法吗？特别是对于 ChartAccount 表？如您所见，它设置为 8 (Dimension8Code)，这是它的缺点。但我认为任何公司都不会有这么多维度？

在维度表本身内，它具有 DimensionID/ParentDimensionID 关系以满足维度本身的结构。还是你有更好的主意？

我很欣赏你的评论。同样，这不是一个会计系统..它只是使用会计科目表的简单分配成本。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-04T01:56:14.613

> 注意：我可以看到维度/细分仅限于 8 但我认为其他公司不会超过 8。我对这种方法持开放态度。

臭味。与Dimension_segments 表建立一对多关系。

或者也许它是chartAccounts 和维度之间的多对多，因为我不知道什么是“维度”。

更好的是，为什么不解释您要建模的内容？在不知道它应该是什么模型*的*情况下，很难就模型是否有效向您提供建议。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-05T21:41:01.560

每当您看到这样的字段时： Dimension1Code VARCHAR(16) Dimension2Code VARCHAR(16) Dimension3Code VARCHAR(16) Dimension4Code VARCHAR(16) Dimension5Code VARCHAR(16) Dimension6Code VARCHAR(16) Dimension7Code VARCHAR(16) Dimension8Code VARCHAR(16)

您需要一个相关的表。相信我，这将是查询和维护的噩梦。

# asp.net - 如何从 ASP.NET 应用程序启动/停止 Windows 服务 - 安全问题

> ID：818512
> 
> 赞同：15
> 
> 时间：2009-05-04T01:36:59.667
> 
> 标签：asp.net, windows-services, impersonation, security

这是我的 Windows/.NET 安全堆栈：

*   在 Windows Server 2003 机器上作为 LocalSystem 运行的 Windows 服务。
*   一个 .NET 3.5 网站在同一个盒子上运行，在“默认”生产服务器 IIS 设置下（所以可能是 NETWORKSERVICE 用户？）

在我的默认 VS2008 DEV 环境中，我有一个方法，它从 ASP.NET 应用程序中调用，效果很好：

```
private static void StopStartReminderService() {

    ServiceController svcController = new ServiceController("eTimeSheetReminderService");

    if (svcController != null) {
        try {
            svcController.Stop();
            svcController.WaitForStatus(ServiceControllerStatus.Stopped, TimeSpan.FromSeconds(10));
            svcController.Start();
        } catch (Exception ex) {
            General.ErrorHandling.LogError(ex);
        }
    }
} 
```

当我在生产服务器上运行它时，我从 ServiceController 收到以下错误：

> 来源：System.ServiceProcess -> System.ServiceProcess.ServiceController -> IntPtr GetServiceHandle(Int32) -> System.InvalidOperationException 消息：无法在计算机“.”上打开 eTimeSheetReminderService 服务。

**为什么会发生这种情况，我该如何解决？**

**编辑：**

答案如下，主要在评论中，但要澄清：

1.  该问题与安全相关，并且由于 NETWORKSERVICE 帐户没有足够的权限来启动/停止服务
2.  我创建了一个本地用户帐户，并将其添加到 PowerUsers 组（该组几乎具有管理员权限）
3.  我不希望我的整个 Web 应用程序一直模拟那个用户，所以我只在我操作服务的方法中模拟。我通过使用以下资源来帮助我在代码中做到这一点：

[MS KB文章](http://support.microsoft.com/kb/306158)和[this，只是为了更好地理解](http://imar.spaanjaars.com/QuickDocId.aspx?quickdoc=287)

**注意：**我不通过 web.config 进行模拟，而是在代码中进行。请参阅上面的 MS 知识库文章。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-05-03T01:14:04.793

授予 IIS 启动/停止特定服务的权限：

*   下载并安装[Subinacl.exe](http://www.microsoft.com/en-us/download/details.aspx?id=23510)。（*一定要获取最新版本！部分资源包中分发的早期版本不起作用！*）
*   发出类似于以下的命令： `subinacl /service {yourServiceName} /grant=IIS_WPG=F`

这将对该特定服务的完整服务控制权限授予内置 IIS_WPG 组。（这适用于 IIS6 / Win2k3。）YMMV 用于更新版本的 IIS。）

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-05-04T03:04:47.257

尝试将此添加到您的 Web.Config。

```
<identity impersonate="true"/> 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-10-13T10:05:10.960

这是一个很好的问题，也引起了我的兴趣......

所以这是我为解决这个问题所做的：

*   第 1 步：在本地计算机上创建一个具有最低权限的 Windows 用户帐户。
*   第 2 步：授予此用户通过 subinacl.exe 启动和停止服务的权限
*   即 subinacl.exe /service WindowsServiceName /GRANT=PCNAME\TestUser=STOE
*   下载地址：http : [//www.microsoft.com/en-za/download/details.aspx?id= 23510](http://www.microsoft.com/en-za/download/details.aspx?id=23510)
*   第3步：使用Impersonation模拟第1步中创建的使用来启动和停止Service

    ```
    public const int LOGON32_PROVIDER_DEFAULT = 0;

    WindowsImpersonationContext _impersonationContext;

    [DllImport("advapi32.dll")]
    // ReSharper disable once MemberCanBePrivate.Global
    public static extern int LogonUserA(String lpszUserName,
        String lpszDomain,
        String lpszPassword,
        int dwLogonType,
        int dwLogonProvider,
        ref IntPtr phToken);
    [DllImport("advapi32.dll", CharSet = CharSet.Auto, SetLastError = true)]
    // ReSharper disable once MemberCanBePrivate.Global
    public static extern int DuplicateToken(IntPtr hToken,
        int impersonationLevel,
        ref IntPtr hNewToken);

    [DllImport("advapi32.dll", CharSet = CharSet.Auto, SetLastError = true)]
    // ReSharper disable once MemberCanBePrivate.Global
    public static extern bool RevertToSelf();

    [DllImport("kernel32.dll", CharSet = CharSet.Auto)]
    // ReSharper disable once MemberCanBePrivate.Global
    public static extern bool CloseHandle(IntPtr handle);

    private bool _impersonate;

    public bool ImpersonateValidUser(String userName, String domain, String password)
    {
        IntPtr token = IntPtr.Zero;
        IntPtr tokenDuplicate = IntPtr.Zero;

        if (RevertToSelf())
        {
            if (LogonUserA(userName, domain, password, LOGON32_LOGON_INTERACTIVE,
                LOGON32_PROVIDER_DEFAULT, ref token) != 0)
            {
                if (DuplicateToken(token, 2, ref tokenDuplicate) != 0)
                {
                    var tempWindowsIdentity = new WindowsIdentity(tokenDuplicate);
                    _impersonationContext = tempWindowsIdentity.Impersonate();
                    if (_impersonationContext != null)
                    {
                        CloseHandle(token);
                        CloseHandle(tokenDuplicate);
                        _impersonate = true;
                        return true;
                    }
                }
            }
        }
        if (token != IntPtr.Zero)
            CloseHandle(token);
        if (tokenDuplicate != IntPtr.Zero)
            CloseHandle(tokenDuplicate);
        _impersonate = false;
        return false;
    }

    #region Implementation of IDisposable

    #endregion

    #region Implementation of IDisposable

    private void Dispose(bool dispose)
    {
        if (dispose)
        {
            if (_impersonate)
                _impersonationContext.Undo();
            _impersonationContext.Dispose();
        }
    }

    public void Dispose()
    {
        Dispose(true);
    }
    #endregion

    public static void StartStopService(bool startService, string serviceName)
    {
        using (var impersonateClass = new Impersonation())
        {
            impersonateClass.ImpersonateValidUser(Settings.Default.LocalUsername, Settings.Default.Domain, Settings.Default.Password);
            using (var sc = new ServiceController(serviceName))
            {
                if (startService)
                    sc.Start();
                else if (sc.CanStop)
                    sc.Stop();
            }

        }
    } 
    ```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2017-07-14T04:09:33.173

**IIS 8 的更新（可能还有一些稍早的版本）**

用户组*IIS_WPG*不再存在。它已更改为*IIS_IUSRS*。

此外，要开始停止服务，无需授予完全权限 (F)。启动、停止和暂停服务 (TOP) 的权限应该足够了。因此，命令应该是：

> subinacl /service {yourServiceName} /grant=IIS_IUSRS=TOP

请注意，在运行此命令之前，您需要将命令提示符（最好提升为以管理员身份运行）指向`C:\Windows\System32`文件夹。

`C:\Windows\System32`如果出现错误，还请确保您已将 subinacl.exe 文件从安装目录复制到 。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-04T01:55:35.753

只是一种预感，但在我看来，错误不一定与安全有关。您是否在生产服务器上为该服务提供了相同的名称？

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2016-10-07T15:57:59.037

如果您的 web 应用程序有数据库并且 windows 服务可以访问它，您可以使用数据库中的标志来重新启动服务。在服务中，您可以读取此标志并在不忙时重新启动等。仅在您可以修改服务代码的情况下。如果是第三方服务，您可以创建自己的 Windows 服务并使用数据库配置来控制（重新启动）服务。这是安全的方式，并为您提供更多的灵活性和安全性。

# iphone - iPhone：如何为自定义键盘制作按键声音？

> ID：818515
> 
> 赞同：20
> 
> 时间：2009-05-04T01:38:04.750
> 
> 标签：iphone, audio, click

有没有办法以编程方式调用键盘“点击”声音？我的应用程序有一个自定义键盘（由 UIButtons 构建），我想在用户点击按键时提供一些音频反馈。我尝试在 Garageband 中创建自己的声音，但对我的任何创作都不满意。如果没有调用按键的标准方法，谁能指出我可能有这样一个宝石的声音库？

* * *

## 回答 #1

> 赞同：32
> 
> 时间：2011-02-02T23:55:41.407

播放默认键盘声音有一个非常快速的解决方案：

1.  添加 AudioToolbox.framework

2.  在您希望播放声音的任何位置添加以下行：

    `AudioServicesPlaySystemSound(0x450);`

* * *

## 回答 #2

> 赞同：22
> 
> 时间：2011-01-24T22:42:35.663

从 iOS 4.2 开始，在 UIView 的自定义子类上采用 UIInputViewAudioFeedback 协议。将此视图设为您的“inputView”，然后在适当的时候调用“playInputClick”。

[http://developer.apple.com/library/ios/#documentation/uikit/reference/UIInputViewAudioFeedback_ProtocolReference/Reference/Reference.html](http://developer.apple.com/library/ios/#documentation/uikit/reference/UIInputViewAudioFeedback_ProtocolReference/Reference/Reference.html)

只是为了节省一些人的时间。把它放在你的自定义视图中：

```
- (BOOL) enableInputClicksWhenVisible {
    return YES;
} 
```

要进行点击，请执行以下操作：

```
[[UIDevice currentDevice] playInputClick]; 
```

* * *

## 回答 #3

> 赞同：13
> 
> 时间：2009-08-01T18:41:22.500

无需将文件复制到您自己的应用程序中 - 您应该能够直接从 UIKit 框架中获取它：

```
CFURLRef soundFileURLRef = CFBundleCopyResourceURL(
    CFBundleGetBundleWithIdentifier(CFSTR("com.apple.UIKit")),
    CFSTR ("Tock"),CFSTR ("aiff"),NULL); 
```

* * *

## 回答 #4

> 赞同：9
> 
> 时间：2009-09-20T15:34:43.623

这就是我从 aSquared 的评论中得出的结论：

```
NSString *path = [[NSBundle bundleWithIdentifier:@"com.apple.UIKit"] pathForResource:@"Tock" ofType:@"aiff"];
SystemSoundID soundID;
AudioServicesCreateSystemSoundID((CFURLRef)[NSURL fileURLWithPath:path], &soundID);
AudioServicesPlaySystemSound(soundID);
AudioServicesDisposeSystemSoundID(soundID); 
```

* * *

## 回答 #5

> 赞同：8
> 
> 时间：2009-05-04T10:54:05.490

我发现的最简单的方法是从 iPhone 模拟器中提取 Tock.aiff（键盘声音）并将其与您的应用程序打包，然后`AudioServicesPlaySystemSound()`在适当的时间使用它进行播放。在我的机器上，只需在 Spotlight 中键入 Tock.aiff 即可打开该文件，但如果您必须去寻找它，它位于 UIKit.framework 的模拟器版本中。

* * *

## 回答 #6

> 赞同：8
> 
> 时间：2009-10-08T09:16:54.433

使用 0x450 作为 SystemSoundID 对我有用（并且音量正确——只是播放内置的 Tock.aiff 声音太大了）。不知道它有多便携——这是在第三代 iPod Touch 上。

仍然不尊重勾选/关闭的偏好。

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2011-05-23T15:10:26.993

这是我所做的：

在以下位置找到“Tock.aiff”：/Developer/Platforms/iPhoneSimulator.platform/Developer/SDKs/iPhoneSimulator4.2.sdk/System/Library/Frameworks/UIKit.framework

将其拖到 xCode 中的资源文件夹中，勾选“将项目复制到目标组的文件夹”

将 AVFoundation.framework 导入 xCode 中的 Frameworks 文件夹

在班级顶部导入 AVFoundation：

```
#import <AVFoundation/AVAudioPlayer.h> 
```

使用以下功能：

```
- (void)PlayClick {
    NSURL* musicFile = [NSURL fileURLWithPath:[[NSBundle mainBundle] 
                                               pathForResource:@"Tock"
                                               ofType:@"aiff"]];
    AVAudioPlayer *click = [[AVAudioPlayer alloc] initWithContentsOfURL:musicFile error:nil];
    [click setVolume:0.15f];
    [click play];
} 
```

就是这样！

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2009-05-04T11:37:44.527

据我所知，点击声音不适用于应用程序。我在音频会话服务中没有看到任何相关的内容。 `AudioServicesPlaySystemSound()`看起来很有希望，但似乎没有任何系统声音 ID 用于点击声音（仔细查看标题可能会出现一些东西）。您总是可以循环调用 to`AudioServicesPlaySystemSound(i)`并查看是否有任何播放。iPhone 软件恢复图像可能有声音，但它可能未获得一般使用许可。无需提及越狱 iPhone 以获得美妙的咔哒声。

对于（知识共享）声音，请查看[Freesound Project](http://www.freesound.org/)。

对于未来，也许要求 Apple 公开除警报声音以外的系统声音以供`AudioServicesPlaySystemSound()`.

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2010-03-22T01:07:39.713

也许有点晚了...但是在 MrMage 上一篇文章中，如果您在此`AudioServicesDisposeSystemSoundID(soundID);`之后立即进行操作，`AudioServicesPlaySystemSound(soundID);` 那么您将听不到任何声音，因为您在创建系统声音后立即将其丢弃。

你必须让它先完成播放。只有在它完成之前调用 AudioServicesDisposeSystemSoundID 来取消声音

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2010-09-17T09:11:33.253

您不必立即处理声音对象。将指向该声音对象的指针保存在属性中，并且仅在您要播放另一个声音时才释放它，然后再重新创建它。

当然最后在 dealloc 中处理 SystemSoundID 对象。

# mysql - OSX 上的 MySQL gem 帮助

> ID：818518
> 
> 赞同：0
> 
> 时间：2009-05-04T01:40:45.273
> 
> 标签：mysql, macos, configuration, rubygems

我正在尝试让 mysql gem 在 OSX 10.5.6 上运行，并且感到受阻。

```
% gem install mysql -- --with-mysql-config=/usr/local/mysql/bin/mysql_config
Building native extensions.  This could take a while...
Successfully installed mysql-2.7
1 gem installed
% irb -rubygems -rmysql
irb> Mysql.init
dyld: lazy symbol binding failed: Symbol not found: _mysql_init
  Referenced from: /Users/rampion/.gem/gems/mysql-2.7/lib/mysql.bundle
  Expected in: dynamic lookup

dyld: Symbol not found: _mysql_init
  Referenced from: /Users/rampion/.gem/gems/mysql-2.7/lib/mysql.bundle
  Expected in: dynamic lookup

zsh: trace trap  irb -rubygems -rmysql
% 
```

我正在使用 ruby​​ 1.8.6 的默认安装。

我使用的是 64 位版本的 MySQL 5.0.77。 `mysqld`正在运行，我可以使用 mysql shell，所以我怀疑我的问题是 with `mysql.gem`，尽管我不确定。

任何人都可以提供任何建议吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-04T02:09:56.047

行。所以解决方案是我需要运行 MySQL 5.0.77 的 32 位版本`mysql.gem`才能工作。

# javascript - 日期小书签需要在个位数月份和日期前导零

> ID：818520
> 
> 赞同：2
> 
> 时间：2009-05-04T01:41:14.383
> 
> 标签：javascript, date, bookmarklet

我有一个用来检查每日日志文件的书签。但是，我使用的小书签仅以个位数提供月份和日期，但日志文件使用两位数。

例如，我的小书签提供： [http://url/log/2009-5-4_localcontrol-story.log](http://url/log/2009-5-4_localcontrol-story.log)，而日志文件实际上位于： [http://url/log/2009-05-04_localcontrol-story.log](http://url/log/2009-05-04_localcontrol-story.log)

以下是我当前的代码：

```
javascript:d=new%20Date();window.open("http://url/log/"+d.getFullYear()+"-"+(d.getMonth()+1)+"-"+( d.getDate())+"_localcontrol-story.log",%20"_self");
```

你能告诉我对此的适应，以便我在必要时以 2 位数字格式获取我的月份和日期，并带有前导零？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-05-04T01:46:59.033

这有点痛苦，但我所做的是做这样的事情：

```
("0"+d.getDate()).slice(-2) 
```

（添加前导零，并`slice(-2)`取最后 2 个字符）

# silverlight - Expression Blend 2 中的 WPF 中不支持有关 UserControl 的错误

> ID：818526
> 
> 赞同：2
> 
> 时间：2009-05-04T01:43:24.410
> 
> 标签：silverlight, expression-blend

我在 Visual Studio 中创建了一个测试 Silverlight 2 应用程序，只是[复制了 Tim Heuer 视频](http://silverlight.net/learn/learnvideo.aspx?video=57010)，但是当我在 Blend 中打开它时出现此错误

> Windows Presentation Foundation (WPF) 项目不支持 UserControl

这是 XAML 代码

```
<UserControl x:Class="MyFirstApp.Page"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation" 
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml" 
    Width="400" Height="300">
    <Grid x:Name="LayoutRoot" Background="White">
        <StackPanel Orientation="Vertical">
            <TextBox x:Name="myTextBox" FontSize="60" />
            <Button Content="Click Me" FontSize="60" Click="Button_Click" />
        </StackPanel>
    </Grid>
</UserControl> 
```

我是否缺少参考资料或其他内容？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-06T11:41:30.460

您需要安装[Expression Blend 2.0 SP1](http://www.microsoft.com/downloads/details.aspx?FamilyId=EB9B5C48-BA2B-4C39-A1C3-135C60BBBE66&displaylang=en)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-10-11T20:35:43.477

请看一下这个线程：

[http://social.expression.microsoft.com/Forums/en-US/blend/thread/33030347-c99a-4f41-8be7-089c92e4ab2d](http://social.expression.microsoft.com/Forums/en-US/blend/thread/33030347-c99a-4f41-8be7-089c92e4ab2d)

# scons - scons 中的 env.Clone() 不做深拷贝

> ID：818533
> 
> 赞同：7
> 
> 时间：2009-05-04T01:45:50.130
> 
> 标签：scons

在 SCons 脚本中，我创建了一个基础环境，从中派生出其他环境。像这样的东西：

```
base = Environment()
base['CXXFLAGS'] += ['-DBOOST_HAS_PTHREAD', '-D__STDC_CONSTANT_MACROS', '-DFILELOG_MAX_LEVEL=4', '-Wall']

opt = base.Clone()
opt['CXXFLAGS'] += ['-DNDEBUG', '-O3'] 
```

这样，我可以从基础环境创建更多环境（发布/调试/仪表化/pgo）。在 SCons 文档中，据说 env.Clone() 对 env 做了一个深拷贝。但实际上它似乎不起作用。因为在示例中，基本环境将应用 -DNDEBUG 和 -O3 标志。

人工智能做错了什么？

编辑：这是真正的代码。此代码中有两个打印语句，我认为它们应该打印相同的内容，但事实并非如此。输出如下：

```
# -*- coding: utf-8 -*-

import os.path
import glob

local_env = Environment()

local_env['CXXFLAGS'] += ['-DBOOST_HAS_PTHREAD', '-D__STDC_CONSTANT_MACROS', '-DFILELOG_MAX_LEVEL=4', '-Wall']
local_env.Append(LIBS = ['pthread', 'boost_thread', 'boost_filesystem', 'boost_program_options', 'boost_iostreams'])

opt = local_env.Clone()

opt['CXXFLAGS'] += ['-DNDEBUG', '-O3']

print opt['CXXFLAGS']

instr = opt.Clone()
instr['CXXFLAGS'] += ['-fprofile-arcs']
instr['LIBS'] += ['gcov']

print opt['CXXFLAGS'] 
```

输出 ：

```
|| scons: Reading SConscript files ...
|| -DBOOST_HAS_PTHREAD -D__STDC_CONSTANT_MACROS -DFILELOG_MAX_LEVEL=4 -Wall -DNDEBUG -O3
|| -DBOOST_HAS_PTHREAD -D__STDC_CONSTANT_MACROS -DFILELOG_MAX_LEVEL=4 -Wall -DNDEBUG -O3 -fprofile-arcs
|| scons: done reading SConscript files.
|| scons: Building targets ...
|| scons: `.' is up to date.
|| scons: done building targets. 
```

**编辑 2**：

这是 SCons 的错误[http://scons.tigris.org/issues/show_bug.cgi?id=2390](http://scons.tigris.org/issues/show_bug.cgi?id=2390)

**编辑 3**：

将在 1.3.1 和 2.0.1 中修复

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-22T11:10:01.727

我今天遇到了这个问题，这似乎是一个 SCons 错误。过去的事情是有效的。

面对这个：Ubuntu 9.04 x64，Python 2.6.2，SCons v1.2.0.r3842

假设这是 0.9.8 和 1.2.0 之间的 API 更改，这里是如何克服它。

曾是：

```
 e2= env.Clone()
  e2["CXXFLAGS"].remove( "-Werror" )
  e2["CXXFLAGS"].append( "-Wno-error" ) 
```

现在（1.2.0）：

```
 import copy
  ...
  e2= env.Clone( CXXFLAGS= copy.deepcopy(env["CXXFLAGS"]) )
  e2["CXXFLAGS"].remove( "-Werror" )
  e2.AppendUnique( CXXFLAGS= "-Wno-error" ) 
```

请注意，使用 .Append() 或 .AppendUnique() 方法会分别处理列表，而不是更改原始源。但是，似乎没有这样一种方法可以从列表中删除特定项目。这就是为什么需要 '.remove()' 并导致头痛的原因。

欢迎提供更简单方法的建议或了解这是 SCons 1.2.0 的错误或功能的指针。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-04T02:41:57.203

假设这是一个 Scons 问题（代码/文档差异），添加什么

```
import copy 
```

在脚本的头部，并使用

```
opt = copy.deepcopy(Base) 
```

即利用 Scons 在 Python 中的事实......？

# c++ - 如何设置 Direct3D 纹理中单个像素的颜色？

> ID：818534
> 
> 赞同：5
> 
> 时间：2009-05-04T01:45:52.580
> 
> 标签：c++, graphics, directx, direct3d

我正在尝试在 Direct3D 中将 2D 图像绘制到屏幕上，我假设必须通过将纹理映射到投影以填充屏幕的矩形广告牌多边形来完成。（我不感兴趣或不能使用 Direct2D。）我在 SDK 中找到的所有纹理信息都描述了从文件加载位图并分配纹理以使用该位图，但我还没有找到一种操作方法逐像素位图的纹理。

我真正想要的是一个功能，例如

`void TextureBitmap::SetBitmapPixel(int x, int y, DWORD color);`

如果我不能直接在纹理对象中设置像素，我是否需要保留一个作为位图的 DWORD 数组，然后将纹理分配给每一帧？

最后，虽然我最初假设我将在 CPU 上执行此操作，但每个像素的颜色计算也可能在 GPU 上完成。是设置纹理中单个像素颜色的 HLSL 代码，还是像素着色器仅对修改显示像素有用？

谢谢。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-04T06:39:21.890

首先，您的直接问题：

从技术上讲，您可以在纹理中设置像素。这将需要使用[LockRect](http://msdn.microsoft.com/en-us/library/bb205913(VS.85).aspx)和[UnlockRect](http://msdn.microsoft.com/en-us/library/bb205914(VS.85).aspx) API。

在 D3D 上下文中，“锁定”通常是指将资源从 GPU 内存转移到系统内存（从而禁止其参与渲染操作）。锁定后，您可以根据需要修改填充的缓冲区，然后解锁 - 即将修改后的数据传输回 GPU。通常锁定被认为是一项非常昂贵的操作，但从[PCIe 2.0 开始](http://en.wikipedia.org/wiki/PCI_Express#PCI_Express_2.0)，这可能不再是一个主要问题。您还可以指定一个小的（甚至 1 像素）RECT 作为 LockRect 的第二个参数，从而需要可忽略不计的数据量的内存传输，并希望驱动程序确实足够聪明，可以传输（我知道一个事实在较旧的 nVidia 驱动程序中，情况并非如此）。

实现这一目标的更有效（和代码密集型）方法确实是永远不要离开 GPU。如果您[将纹理创建](http://msdn.microsoft.com/en-us/library/bb174363(VS.85).aspx)为 RenderTarget（即，指定 D3DUSAGE_RENDERTARGET 作为其[使用](http://msdn.microsoft.com/en-us/library/bb172625(VS.85).aspx)参数），则可以在进行任何绘制调用之前将其设置为管道的目的地，并编写着色器（可能[传递参数](http://msdn.microsoft.com/en-us/library/bb205728(VS.85).aspx)）来绘制像素. 渲染目标的这种使用被认为是标准的，您应该能够在周围找到许多代码示例 - 但除非您已经面临性能问题，否则我会说这对于单个 2D 广告牌来说太过分了。

HTH。

# bit-manipulation - 如何在未知大小的二进制数中将所有位设置为“1”？

> ID：818535
> 
> 赞同：23
> 
> 时间：2009-05-04T01:46:17.990
> 
> 标签：bit-manipulation

我正在尝试在汇编中编写一个函数（但让我们假设该问题与语言无关）。

如何使用按位运算符将传入数字的所有位设置为 1？

我知道我可以将按位“或”与带有我希望设置的位的掩码一起使用，但我不知道如何根据一些 N 大小的二进制数构造掩码。

* * *

## 回答 #1

> 赞同：67
> 
> 时间：2009-05-04T01:49:01.947

~(x & 0)

x & 0 将始终导致 0，而 ~ 会将所有位翻转为 1。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-05-04T01:51:50.600

将其设置为 0，然后使用按位非将所有位翻转为 1。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-05-04T02:25:57.770

你会发现在汇编语言中你*必须*知道“传入数字”的大小。*在汇编语言中，汇编语言用于哪台机器*真的很重要。

鉴于这些信息，您可能会问

*   如何将整数寄存器设置为全 1 位？

或者

*   如何用全 1 位填充内存中的区域？

为了用全 1 位填充寄存器，在大多数机器上，有效的方法需要两条指令：

1.  使用专用清除指令清除寄存器，或加载立即数 0，或将寄存器与自身异或。

2.  取寄存器的按位补码。

然后用 1 位填充内存需要 1 个或多个存储指令......

[您会在 Hank Warren 的精彩著作Hacker's Delight](http://www.hackersdelight.org/)中找到更多有趣的技巧和窍门。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-05-04T01:49:45.503

将其设置为`-1`。这通常由所有位为 1 来表示。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-05-04T02:11:36.620

将 x 设置为 1

而 x < 数字 x = x * 2

答案 = 数字或 x - 1。

该代码假定您的输入称为“数字”。它应该适用于正值。请注意，对于二进制补码的负值，操作尝试毫无意义，因为高位始终为 1。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2019-04-17T20:58:37.730

使用`T(~T(0))`.

类型名在哪里`T`（如果我们谈论的是 C++。）

`int`如果类型小于 ，这可以防止不需要的提升`int`。

# legacy-code - Modula-2 开发者？

> ID：818537
> 
> 赞同：2
> 
> 时间：2009-05-04T01:46:32.437
> 
> 标签：legacy-code, modula-2

猜猜没有新项目可以用 Modula、Ada、Oberon 等语言实现了（对吧？）。但是仍然有遗留系统四处飘荡，到处寻找它们的创造者。他们找不到他们，因为他们可能会退休，坐在海滩上享受自己的地方。

严肃：
1）我想知道周围是否还有活跃的（有经验的）Modula 程序员？
2) 有人将 Modula 代码移植到新一代硬件吗？
3) 有谁知道可以重新设计的工具，即以图形方式映射程序和 Mod 文件。这些工具可用于例如。C 程序。

当然，与今天的 .net 和具有 1000 种方法的 Java API 相比，Modula Syntax 并没有那么令人惊叹，但是如果有人向您丢下大约 100.000 行几乎没有记录的源代码（与大约 8000 行汇编程序很好地混合在一起），您最好知道您是否最好拒绝它。我有这个要求，我很抗拒。（选项：移植并保留模源或在 9 个月内迁移到其他语言！）

干杯

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2010-03-05T13:30:16.460

1）我想知道周围是否还有活跃的（有经验的）Modula 程序员？

它们有很多，但是您必须进行一些网络搜索才能找到它们。如果你搜索“Curriculum Vitae”（或“Resume”）和“Modula-2”，应该会有很多命中。此外，任何具有 Oberon、Pascal 或 Delphi 经验的人都将能够处理 Modula-2。

还有活跃的 Modula-2 项目，最值得注意的是：

*   GNU Modula-2 在[http://www.nongnu.org/gm2](http://www.nongnu.org/gm2)
*   Modula-2 R10 在[http://modula-2.net/m2r10](http://modula-2.net/m2r10)
*   Modula2JCC 在[http://code.google.com/p/modula2jcc](http://code.google.com/p/modula2jcc)
*   [在http://modulipse.sourceforge.net](http://modulipse.sourceforge.net)上的 Modulipse
*   施瓦泽咖啡[http://sourceforge.net/projects/schwarzerkaffee](http://sourceforge.net/projects/schwarzerkaffee)

2) 有人将 Modula 代码移植到新一代硬件吗？

在 GNU Modula-2 邮件列表上提问。许多 GNU Modula-2 用户拥有来自他们喜欢移植到现代平台的 16 位 DOS 系统的 Modula-2 代码。GNU Modula-2 网站将此列为 GM2 的一个重要动机。GM2 邮件列表位于：

*   [http://lists.nongnu.org/mailman/listinfo/gm2](http://lists.nongnu.org/mailman/listinfo/gm2)

还有 Modula-2 Usenet 新闻组，您可以通过 Google 界面访问它

*   [http://groups.google.com/group/comp.lang.modula2](http://groups.google.com/group/comp.lang.modula2)

最后但同样重要的是，Freenode 有一个 Modula-2 IRC 频道

*   irc://irc.freenode.net/#modula-2

3) 如何评估 100.000 行 Modula-2 源代码

“如果有人向你丢下大约 100.000 行几乎没有记录的源代码（与大约 8000 行汇编程序很好地混合在一起），你最好知道你是否最好拒绝它。我有这个要求，我非常抗拒。（选项：端口并保留模块源或在 9 个月内迁移到其他语言！）”

您可能想联系著名的 Modula-2 学者和书籍作者 Rick Sutcliffe，他也是 Modula-2 常见问题解答的维护者，他在该常见问题解答中表示，他确实被聘为评估 Modula-2 源代码的咨询工作公司接管情况。在我看来，您的情况可能足以证明聘请专家来确定提供给您的软件的价值是合理的。

*   Modula-2 常见问题解答位于[http://faq.modula2.net](http://faq.modula2.net)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-04T02:15:22.633

> 1）我想知道周围是否还有活跃的（有经验的）Modula 程序员？

是的，我是其中之一。但我已经有工作了:-)

> 2) 有人将 Modula 代码移植到新一代硬件吗？

不清楚您的意思是移植代码还是移植编译器。移植 Wirth 的 Modula-2 编译器（或 Oberon 编译器）应该很容易。Ada 和 Modula-3 是另一回事。

> 3) 有谁知道可以重新设计的工具，即以图形方式映射程序和 Mod 文件。这些工具可用于例如。C 程序。

我不明白这个问题。如果您希望可视化 Modula-2 程序的导入图，您可以轻松编写一些东西来发出[dot](http://www.graphviz.org)。可视化调用图是另一回事。

这是我对 Modula-2 和 Oberon 的总结：

1.  任何称职的 C 程序员都可以快速学习足够的 Modula-2 来维护大型遗留应用程序。奥伯伦的另一个故事；它的导出名称和类型扩展模型与其他 OO 语言中的对象模型不同。

2.  作为语言设计师，Wirth 的天才之处在于让编写编译器的人轻松搞定。因此，如果您需要工具，任何优秀的编译器编写者都可以生产它们。Wirth 的编译器应该可用且易于移植。

Ada 不应该与 Modula-2 和 Oberon 相提并论。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2010-08-06T21:43:17.110

Ada 仍然是一种非常活跃的语言。我从 1995 年开始在自己的研究中使用它，从去年开始在大学的讲座中使用它。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2010-03-05T13:55:56.577

Modula-2 在架构上与 C 没有什么不同。熟悉 C 的程序员应该很容易理解 Modula-2。鉴于您的应用程序具有大量的汇编代码，那么无论如何您都需要具有低级技能的人。

IIRC Modula-2 的语法是 LL(1) 或几乎如此，因此编写一个解析器来为 Modula-2 代码库生成调用图并不超出人的智慧。 如果您想要一种快速简便的方法来可视化调用图，那么[Graphviz是您的朋友。](http://www.graphviz.org/)同样，这表明您准备聘请[“真正的程序员”](http://en.wikipedia.org/wiki/Real_Programmer)来完成移植工作。

如果您需要一个合理可行的 Modula-2 编译器，您可以查看[Amsterdam Compiler Kit](http://tack.sourceforge.net/)，它确实有一个称职的 Modula-2 编译器，可以针对各种平台，尽管它不支持 Win32 IIRC。

我建议记录和移植现有的 Modula-2 代码库可能比尝试用 C 重写它更容易。但是，如果您需要迁移到不同的处理器架构，那么您将不得不重新编写汇编语言反正位。这确实改变了移植的价值主张。

如果是您进行移植，那么您可以考虑分两步进行。

1.  与客户安排一个实用程序来生成调用图，并给他们一个可行性研究，推荐做什么和对范围的一些估计。

2.  做移植，移植代码库或重写它。请记住，如果您在现代计算机上运行整个代码库，您可能不需要低级语言。与纯粹用 C 重写所需的工作相比，您可以在（比如说）Python 和 C 的混合体中完成它。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-04T02:11:08.633

我自己对 Modula 了解不多，但是我在巴西的一个研究中心工作，该中心有一个完全在 Modula-2 中创建的分组交换网络项目 (Compac)。如果我没记错的话，他们甚至自己开发了编译器/链接器。由于我不能随意将您指向特定的人，我建议您在 Google 上搜索“compac”和“cpqd”，我几乎可以保证您会找到参与其中的人员的姓名。从 80 年代后期开始，对它的引用已经很老了，这不足为奇。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-07-09T16:34:37.300

是的。

我知道你很久以前就问过这个问题，但我也知道没人喜欢处理的项目会延迟......

在过去的十年中，我在 Modula-2 中构建了几个大型系统，并且养成了承担不可能完成任务的疯狂习惯。

我已经有大约十年没有接触过它了，但我绝对可以肯定我可以为您将您的系统移植到几乎任何其他平台上。如果您仍然感兴趣，为什么不与我联系？

哦，是的 - 更好的是，我们都在新加坡 :-)

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-02-21T15:28:58.997

ADW Modula-2 现已作为免费软件发布。 [http://www.modula2.org/adwm2/](http://www.modula2.org/adwm2/) 因为它是免费的并且支持 32 位和 64 位 Windows 应用程序（而且我知道 Modula-2），所以我选择了它并将它用于我想要的小型实用程序工作成为 64 位 Windows 二进制文件（我的大部分工作都是在 Java 和 .Net 中进行的，这很好，但有时纯二进制文件是最好的。我已经将 MASM32 用于 32 位二进制 Windows 应用程序）。

**编辑**

现在还有一个项目正在进行中（仍处于早期阶段，截至本次编辑之日尚不可用），用于在 JVM 上编译 Modula-2（带有转译为 Java 选项）。 [https://github.com/m2sf/m2j](https://github.com/m2sf/m2j)

# c# - 在 DLL 上使用 WPF 动态创建图像（而不是 GDI+）

> ID：818544
> 
> 赞同：3
> 
> 时间：2009-05-04T01:49:49.247
> 
> 标签：c#, asp.net, wpf, image, gdi+

我需要动态生成图像，在阅读[此处](http://www.west-wind.com/Weblog/posts/150676.aspx)的教程后，我意识到我可以使用 WPF 中的所有控件和布局来生成我的渲染，然后将其保存为 JPG。这个想法是使用它来代替非常原始的 GDI+。

问题是，如何创建一个常规的 dll 文件，该文件将以编程方式生成 WPF 画布，这样我就可以向其中添加控件，然后将其输出到图像文件中。请记住，它将被 ASP.NET 应用程序使用。

有人有什么想法吗？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-05-04T18:13:23.687

这个例子有一个好的开始，但我发现它有很多不需要的垃圾。主要的是你不需要有一个单独的 WPF 项目。

这是做什么：

*   在您的 Web 项目中引用 PresentationCore、PresentationFramework 和 WindowsBase。
*   在 STA 线程中以编程方式创建 Canvas 和其他 WPF 对象。
*   对它们调用一些特殊方法，以确保它们在 WPF 应用程序的上下文之外进行更新。
*   使用 RenderTargetBitmap 将它们渲染为图像。
*   关闭线程的调度程序。
*   设置 mime 类型并使用 ASP.NET 输出图像。

为了提高效率，您可以重复使用相同的线程，而不是为每个图像创建一个新线程。在这种情况下，您只需要在关闭线程时清理调度程序。

这是我拥有的完整工作代码：

```
using System;
using System.Web;
using System.Threading;
using System.IO;
using System.Windows;
using System.Windows.Media;
using System.Windows.Media.Imaging;
using System.Windows.Controls;
using System.Windows.Documents;

public partial class _Default : System.Web.UI.Page
{
    private byte[] imageBuffer;

    public void Page_Load(object sender, EventArgs e)
    {
        this.RenderImage();

        Response.Clear();
        Response.ContentType = @"image/png";
        Response.BufferOutput = true;
        Response.BinaryWrite(this.imageBuffer);
        Response.Flush();
    }

    public void RenderImage()
    {
        Thread worker = new Thread(new ThreadStart(this.RenderImageWorker));
        worker.SetApartmentState(ApartmentState.STA);
        worker.Name = "RenderImageWorker";
        worker.Start();
        worker.Join();
    }

    public void RenderImageWorker()
    {
        Canvas imageCanvas = new Canvas { Width = 600, Height = 200, Background = Brushes.Azure };

        TextBlock tb = new TextBlock();
        tb.Width = (double)400;
        //tb.Height = (double)200;
        tb.TextAlignment = TextAlignment.Center;
        tb.Inlines.Add(new Run("This is "));
        tb.Inlines.Add(new Bold(new Run("bold")));
        tb.Inlines.Add(new Run(" text."));
        tb.FontSize = 30;
        tb.Foreground = Brushes.Blue;

        imageCanvas.Children.Add(tb);

        // Update layout
        imageCanvas.Measure(new Size(imageCanvas.Width, imageCanvas.Height));
        imageCanvas.Arrange(new Rect(new Size(imageCanvas.Width, imageCanvas.Height)));

        RenderTargetBitmap bitmapRenderer = new RenderTargetBitmap((int)imageCanvas.ActualWidth, (int)imageCanvas.ActualHeight, 96, 96, PixelFormats.Pbgra32);
        bitmapRenderer.Render(imageCanvas);

        PngBitmapEncoder png = new PngBitmapEncoder();
        png.Frames.Add(BitmapFrame.Create(bitmapRenderer));

        using (MemoryStream memoryStream = new MemoryStream())
        {
            png.Save(memoryStream);
            this.imageBuffer = memoryStream.ToArray();
        }

        if (bitmapRenderer.Dispatcher.Thread.IsAlive)
        {
            bitmapRenderer.Dispatcher.InvokeShutdown();
        }
    }
} 
```

# javascript - HTML 表格中的 Dojo(x) 小部件不调整大小

> ID：818546
> 
> 赞同：1
> 
> 时间：2009-05-04T01:51:36.997
> 
> 标签：javascript, dojo, html-table

我有以下页面使用 Dojo 1.3.1 javascript 工具包

```
Content Pane
  HTML table   two columns, N rows
  Column 1 (left):   text
  Column 2 (right)   Dojo widget (can be any, but mostly Grids, pullodwn, etc) 
```

问题：
当页面加载时，它呈现 Ok（小部件的类型和每页的数量是在运行时确定的，所以我无法使用静态 CSS 来管理它）

当我向网格添加行时，它嵌入在表格单元格中

```
<td> grid </td> 
```

给定的行（嵌入网格的位置）按比例变高，网格下方的所有内容都消失了，并且内容窗格上没有滚动条可以到达下面的行。

我不知道如何解决它，我在页面周围的所有内容上设置了 100% 或自动高度和宽度。这没有帮助。

我想知道我的设计方法是否错误并且无法解决。我读过有人告诉不要使用表格进行布局，但我在设计时不知道我将显示的控件的顺序和类型。这还能怎么做？

我认为问题在于，当网格位于表格单元格内并且网格扩展时，单元格会扩展，但保存内容窗格不知道它，因此不会重绘边框。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-04T03:01:02.243

您可以使用 CSS 进行布局——表格可以做什么而 CSS 不能做什么？或者，您可以尝试使用另一个 dojo 网格而不是那个 HTML 表格，这取决于您所追求的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-29T00:03:31.373

Dijit 的小部件尽可能像普通节点一样工作。但是许多小部件，尤其是那些让用户定义大小的小部件（就像您可以使用网格中的列宽一样）需要知道特定的尺寸。

好消息是，对于这些小部件中的大多数，您可以获得小部件的实例，然后调用`widget.resize();`

# c# - 失去断点

> ID：818548
> 
> 赞同：0
> 
> 时间：2009-05-04T01:53:21.390
> 
> 标签：c#, visual-studio, debugging

```
// break point set here>>
webRequest = (HttpWebRequest)WebRequest.Create(server);
webRequest.Timeout = 30000;
webRequest.Credentials = CredentialCache.DefaultCredentials;
webRequest.Method = "POST";
webRequest.ContentType = "application/x-www-form-urlencoded";
webRequest.KeepAlive = false;

XmlDocument doc = new XmlDocument();
doc.AppendChild(request.ToXmlElement(doc));
byte[] data = XmlUtil.DocumentToBytes(doc);

webRequest.ContentLength = data.Length;

// write data to stream
requestStream = webRequest.GetRequestStream();
requestStream.Write(data, 0, data.Length);
requestStream.Close();

// get response
HttpWebResponse response = (HttpWebResponse)webRequest.GetResponse();

dataStream = response.GetResponseStream(); 
```

我在上面的第一行设置了一个断点，但由于某种原因我在 webRequest = (HttpWebRequest)WebRequest.Create(server); 之后丢失了它 完成，并且永远不会在此方法的下一行中达到任何调试点。就好像它在调试断点方面失去了它所在的位置，并最终在后面命中了一个，而不是继续命中我在这里添加的调试点，例如数据流。我知道它也没有出错，因为我最终确实得到了回复。我想查看 dataStream 但每次它发出请求时它永远不会回来，其余代码在收到响应后在此方法之外运行。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-04T04:23:52.200

废话，我发现响应返回 null 并且正在执行另一部分代码，因此断点从未被击中，因为它首先击中了我的错误处理并停在那里。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-04T02:21:30.480

我对你的问题有点不清楚。您是否在注释行设置断点并从那里消失？如果是这样，您可以将其放在下一行或在注释点插入无操作行并从那里开始吗？在注释行设置断点需要调试器和语言服务跳过更多的环节，并增加出现问题的机会（它应该仍然有效，但它是一个很好的诊断检查）。在实际代码行上设置断点应该没有任何问题。

如果您在实际代码行上进行设置，您可以定义“消失”吗？它是完全消失还是空白，还是出现警告标志？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-04T02:56:49.147

首先要检查的是您将 Visual Studio 设置为在 DEBUG 模式下构建，而不是在 RELEASE 模式下构建。在 RELEASE 模式下，编译器可以优化和重新排序语句，因此源文件中的代码不一定与为断点存储的行号匹配。

# javascript - Trimpath Junction Javascript 框架发生了什么？

> ID：818549
> 
> 赞同：1
> 
> 时间：2009-05-04T01:54:20.797
> 
> 标签：javascript, jquery, model-view-controller, frameworks

我一直在拼命寻找 Javascript MVC 框架来创建具有 Rails 后端的富客户端应用程序，但我遇到了[junction framework](http://code.google.com/p/trimpath/)。由于它与 Rails 和离线功能的相似性，它对我非常有吸引力。但很遗憾，它已经很久没有被积极维护了。

我只是想知道该项目是否仍然存在，或者我应该在其他地方寻找可行的解决方案。

我知道 sproutecore 和卡布奇诺咖啡，我正在密切关注它们及其开发过程。但是我真的很不愿意以这种方式学习一种新语言之类的东西。事实上卡布奇诺使用objectiveJ，它实际上是一种在javascript中运行的新语言。

恕我直言，杀手级框架在结构上类似于 Rails（因为 rails 已经证明自己是框架的事实上的结构，并已被移植到许多其他框架）并使用 jQuery 处理 dom 并执行 ajax来电。我还是找不到。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2011-03-01T07:11:25.540

尝试 Ejscript：[http ://ejscript.org/products/ejs/webFramework.html](http://ejscript.org/products/ejs/webFramework.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-05T20:19:17.573

我不确定它是否仍在积极开发中。

我自己最近一直在广泛使用 Trimpath，而且我没有错过任何功能。我当然希望它仍在开发中，但它是一个很棒的工具，并且确实减少了开发时间。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-29T01:16:42.973

我是 Ejscript 的开发人员。该项目没有死，只是非常专注于嵌入式。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-11-17T16:46:13.683

我已经在网上搜索了 junction，据我所知，该项目已经死了。

# php - 如何列出按常用标签数量排序的相关博客文章？

> ID：818551
> 
> 赞同：1
> 
> 时间：2009-05-04T01:55:15.707
> 
> 标签：php, mysql, tags, blogs

我想显示相关博客文章的列表，并且我希望该列表按它们对当前文章的常用标签数量进行排序。每个帖子可以有多个与之关联的标签。这是我的表结构：

[帖子] <-- [posts-to-tags-joining-table] --> [标签]

我正在使用 PHP 和 MySQL - 我可以在一个查询中执行此操作吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-04T02:15:39.573

当然你可以在一个查询中做到这一点：

```
SELECT postid, count(tagid) as common_tag_count
FROM posts_to_tags
WHERE tagid IN (SELECT tagid FROM posts_to_tags WHERE postid = 2)
GROUP BY postid ORDER BY common_tag_count DESC; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-04T02:23:32.490

关于什么...：

```
SELECT COUNT(*) AS numcommon, posts.pid, posts.post FROM posts
               INNER JOIN p2t ON p2t.pid = posts.pid
               WHERE p2t.tid IN
               (SELECT p2t.tid FROM p2t
               INNER JOIN posts ON p2t.pid = posts.pid
               WHERE posts.pid = 1)
               AND posts.pid != 1
               GROUP BY posts.pid
               ORDER BY numcommon 
```

假设 pid 作为 posts 表中的主键， tid 作为 tags 表中的主键，p2t（post to tag）表中的两个外键？

# objective-c - 如何使用字符串数组填充 NSPopupButton？

> ID：818555
> 
> 赞同：1
> 
> 时间：2009-05-04T01:56:00.510
> 
> 标签：objective-c, cocoa

简单的问题，但我很难理解 Interface Builder 如何与在 X-Code 中开发的程序的其余部分交互。

我的 UI 有一个 NSPopupButton，我想用我提供的字符串数组填充它。我有一个控制器类，它定义了单击按钮时要执行的方法。那是我要填充 NSPopupButton 的地方吗？似乎我需要在某个地方进行初始化，但我对在哪里进行初始化感到困惑。我知道我需要使用 addItemsWithTitles，但我在哪里称呼它？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-04T02:35:00.153

假设列表不随时间变化，awakeFromNib（在控制器中）将是填充菜单的好地方。如果它是动态的，那么您希望在这些字符串的来源发生变化时填充它。

# c# - 与 Castle ActiveRecord HasAndBelongsToMany's 级联

> ID：818559
> 
> 赞同：0
> 
> 时间：2009-05-04T01:58:53.857
> 
> 标签：c#, nhibernate, castle-activerecord

我在使用 Castle ActiveRecord/NHibernate 通过 HasAndBelongsToMany 关系级联删除时遇到了很多麻烦。

我有拥有并属于许多标签的照片。它们由一个名为 PhotoHasTag 的表连接，该表只有一个 photoId 和 tagId。当我删除一张照片时，我希望删除所有关联的 PhotoHasTag 条目，并删除所有孤立的标签。

现在我有我的照片类设置是这样的：

```
 [ActiveRecord(Table="Photo")]
    public class Photo
    {
        [PrimaryKey(Column = "photoId", Generator = Castle.ActiveRecord.PrimaryKeyType.Identity)]
        public virtual int Id { get; set; }    

        [HasAndBelongsToMany(Table="PhotoHasTag",ColumnKey="photoId",ColumnRef="tagId",Lazy=true,Cascade=ManyRelationCascadeEnum.AllDeleteOrphan)]
        public virtual IList<Tag> Tags { get; set; }
    } 
```

我的 Tag 类的设置方式几乎相同：

```
 [ActiveRecord(Table="Tag")]
    public class Photo
    {
        [PrimaryKey(Column = "tagId", Generator = Castle.ActiveRecord.PrimaryKeyType.Identity)]
        public virtual int Id { get; set; }  

        [HasAndBelongsToMany(Table = "PhotoHasTag", ColumnKey = "tagId", ColumnRef = "photoId", Lazy = true)]
        public IList<Photo> Photos { get; set; }
    } 
```

当我尝试删除照片时，我最终从 SQL Server 收到错误消息：

```
The DELETE statement conflicted with the REFERENCE constraint "PhotoHasTag_FK1". 
```

我可以通过将键上的删除规则设置为级联，在 SQL Server 中解决这个问题，但只有 PhotoHasTag 被删除。如果有任何孤立的标签，它们仍将留在数据库中。

我正在考虑编写一个触发器来处理剩余的标签，但如果有一种方法可以设置我的 ActiveRecord 映射以便删除级联，我会更高兴。

在此先感谢，我一直坚持这一点，所以我很感激任何和所有的帮助！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-13T06:20:57.450

您可以在属性中指定级联行为，如下所示：

```
[HasAndBelongsToMany(Table = "PhotoHasTag", Cascade=ManyRelationCascadeEnum.AllDeleteOrphan, ColumnKey = "tagId", ColumnRef = "photoId", Lazy = true)]
public IList<Photo> Photos { get; set; } 
```

[API](http://api.castleproject.org/html/T_Castle_ActiveRecord_ManyRelationCascadeEnum.htm)文档可能更有帮助。

# objective-c - 将文件拖放到 NSTableView 上？

> ID：818560
> 
> 赞同：12
> 
> 时间：2009-05-04T01:59:09.600
> 
> 标签：objective-c, cocoa, drag-and-drop

我有一个`NSTableView`我希望允许用户将视频文件拖放到其中的内容。当他们删除文件时，它将作为一行添加到表格视图中。

我该怎么做呢？目前，tableview 从数组控制器获取数据（从 NSMutableArray 获取数据）

我找到[了这个](http://developer.apple.com/documentation/Cocoa/Conceptual/DragandDrop/Tasks/acceptingdrags.html#//apple_ref/doc/uid/20000993)文档，但似乎无法使它工作..

我有..

*   制作了一个“TableCon”类（我改为从 NSTableView 继承，而不是 NSObject）
*   将 NSTableView 类更改为 TableCon
*   将 NSTableView 的委托出口设置为该类
*   `registerForDraggedTypes`在 TableCon 的 init 中调用
*   实施`- (NSDragOperation)draggingEntered:(id <NSDraggingInfo>)sender;`（再次在 TableCon 中）

..但是，什么都没有，它就像我从来没有改变任何东西（没有错误），我做错了什么？

**编辑：**我已经尝试实施 Boaz Stuller 的建议，并且还找到[了](http://www.cocoabuilder.com/archive/message/cocoa/2009/3/17/232541)解决方案的描述（第[一个回复](http://www.cocoabuilder.com/archive/message/cocoa/2009/3/17/232543)包括第一个帖子的解决方案）。所以我现在所做的是..

*   子类 NSArrayController 将内容提供给表格视图 (TableListCon)
*   将`tableView`出口添加到 TableListCon（并将其指向 NSTableView）
*   在 TableListCon 中实现 validateDrop、writeRowsWithIndexes 和 acceptDrop
*   在 tableView 插座上调用 registerForDraggedTypes。

同样，没有错误/警告，但似乎只调用了 awakeFromNib 方法（没有调用其他方法）

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2009-05-04T03:31:34.633

NSTableView 处理拖放的方式与通用视图不同，这总体上是一件好事。这意味着您不必手动处理表格所需的复杂突出显示、单元格跟踪和插入行为。

可以在[此处](http://developer.apple.com/documentation/Cocoa/Conceptual/TableView/Tasks/UsingDragAndDrop.html)找到所需内容的说明。基本上，您仍然调用 -registerDraggedTypes: （通常在您的 -awakeFromNib 方法中），但不是实现 NSDraggingDestination 方法，而是实现与拖放相关的各种数据源方法，可以在[此处](http://developer.apple.com/documentation/Cocoa/Reference/ApplicationKit/Protocols/NSTableDataSource_Protocol/Reference/Reference.html)找到。您不需要继承 NSTableView 来以这种方式实现拖放。

请注意，这些是数据源方法。您需要将表视图的 dataSource 出口连接到实现这些方法的类，以便调用它们。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-04T21:33:08.747

除了 Boaz 所说的，听起来您正在创建一个 NSTableView 子类，然后将该子类的一个实例作为 NSTableView 的委托。如果您要子类化，则应使用该子类代替 NSTableView，而不是添加它。此外，让视图成为另一个对象的委托几乎总是违反关注点。

# iphone - 有效的UDID？

> ID：818564
> 
> 赞同：15
> 
> 时间：2009-05-04T02:03:41.490
> 
> 标签：iphone

**重复：[验证 iPhone 设备 ID？](https://stackoverflow.com/questions/772858/validate-iphone-device-ids/774518#774518)**

有谁知道什么是有效的 iPhone UDID？

上下文：我正在为与 iPhone 交互的服务器编写一些会话代码，并将使用 iPhone 的 UDID 作为唯一标识符。但是，我似乎在有效的 UDID 范围内找不到任何资源，我想确切地知道我可以从 iPhone 中得到什么。

澄清：我不是在问如何将 iPhone UDID 验证为合法的 iPhone UDID，我想弄清楚 UDID 的范围。例如，在编程语言中，有一些规范可以用来命名变量（以字母开头，包含字母和数字等）。我想要 UDID 的相同规格。

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2009-05-04T02:09:45.440

它是一个 40 个字符的十六进制字符串。没有规范或文档指定此字符串的布局。

我不确定如何确定什么是“有效的”，因为只有 Apple 知道哪些 UDID 是真实的，哪些是虚假的。

我最好的猜测是，鉴于我见过的各种 UDID，它们的长度为 40 个字符，由字母数字字符组成。(a-f0-9)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2010-01-06T18:10:54.097

实际上，iphone 模拟器 udid 有破折号，长度为 36 个十六进制字符。

例如：

002ebf12-a125-5ddf-a739-67c3c5d20177

虽然我只见过实际的 iphone udid，只有十六进制字符和 40 长。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-04T02:06:41.123

不，没有办法这样做。这个问题问的是同样的事情：[Validate iPhone device Ids?](https://stackoverflow.com/questions/772858/validate-iphone-device-ids/774518#774518)

更新：据我所知，设备 ID 是 40 个字符的十六进制字符串（0-9 和 af）。Apple 关于 UIDevice 的[deviceIdentifier](http://developer.apple.com/iphone/library/documentation/UIKit/Reference/UIDevice_Class/Reference/UIDevice.html#//apple_ref/occ/instp/UIDevice/uniqueIdentifier)属性的文档指出：

> 唯一设备标识符是由各种硬件标识符（例如设备的序列号）组成的哈希值。它保证对每台设备都是唯一的，但不能公开绑定到用户帐户。例如，您可以使用它在中央服务器中存储游戏的高分或控制对注册产品的访问。唯一设备标识符有时通过其缩写 UDID 来表示。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2014-11-28T16:20:37.277

**大多数**是 40 个字符的 HEX 字符串；我们公司有 1 个 41 个字符，并且在开发中心获得了 Beta 应用程序的**授权。**添加它的唯一方法是通过野生动物园，但是如果有人得到相同的结果，那么值得注意。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2016-02-26T08:44:00.730

尝试遵循正则表达式`^([A-F0-9]{40})$`

或者你可以去[这里粘贴它](https://regex101.com/r/hD8sJ8/2)。

希望这可以节省您一些时间。

# wpf - 删除用户控件上的焦点矩形

> ID：818566
> 
> 赞同：56
> 
> 时间：2009-05-04T02:05:06.450
> 
> 标签：wpf, focus, focusvisualstyle

我有一个带有 Focusable="True" 的 WPF UserControl。它是窗口中唯一可聚焦的控件。

每当用户按下 Tab 或 Alt（尤其是当他们按下 Alt+Tab 键到另一个应用程序时），我的 UserControl 都会获得一个虚线边框，也就是焦点矩形。然后焦点矩形一直停留在那里，直到窗口关闭。

如何防止我的 UserControl 显示此焦点矩形？

### 编辑

事实证明，我的用户控件实际上并没有显示焦点矩形。我的 Focusable UserControl 包含另一个 UserControl，而后者又包含一个 ItemsControl，而 ItemsControl 就是显示焦点矩形的内容。

当我将 FocusVisualStyle="{x:Null}" 添加到 ItemsControl 时，焦点矩形消失了。

* * *

## 回答 #1

> 赞同：76
> 
> 时间：2009-05-04T11:11:43.297

如果您不想在任何情况下显示焦点矩形，您可以将 FocusVisualStyle 设置为 null。

```
<MyControl FocusVisualStyle="{x:Null}" /> 
```

# mysql - 没有双重查询的MySQL分页？

> ID：818567
> 
> 赞同：121
> 
> 时间：2009-05-04T02:05:14.590
> 
> 标签：mysql, pagination, double

我想知道是否有办法从 MySQL 查询中获取结果数量，同时限制结果。

分页的工作方式（据我所知），首先我做类似的事情

```
query = SELECT COUNT(*) FROM `table` WHERE `some_condition` 
```

在我得到 num_rows(query) 之后，我就有了结果的数量。但是为了实际限制我的结果，我必须执行第二个查询，例如：

```
query2 = SELECT COUNT(*) FROM `table` WHERE `some_condition` LIMIT 0, 10 
```

我的问题：是否有既要检索将给出的结果总数，又要限制在单个查询中返回的结果？或者任何更有效的方式来做到这一点。谢谢！

* * *

## 回答 #1

> 赞同：75
> 
> 时间：2010-07-24T11:14:50.743

我几乎从不做两个查询。

只需返回比需要的多行，页面上只显示 10 行，如果显示多行，则显示“下一步”按钮。

```
SELECT x, y, z FROM `table` WHERE `some_condition` LIMIT 0, 11 
```

```
// iterate through and display 10 rows.

// if there were 11 rows, display a "Next" button. 
```

您的查询应该以最相关的顺序返回。很可能，大多数人不会关心从 412 页中转到第 236 页。

当您进行谷歌搜索时，您的结果不在第一页上，您可能会转到第二页，而不是第九页。

* * *

## 回答 #2

> 赞同：71
> 
> 时间：2009-05-04T02:37:15.047

不，这就是有多少想要分页的应用程序必须这样做。它可靠且防弹，尽管它会进行两次查询。但是您可以将计数缓存几秒钟，这将有很大帮助。

另一种方法是使用`SQL_CALC_FOUND_ROWS`从句，然后调用`SELECT FOUND_ROWS()`. 除了您必须在`FOUND_ROWS()`之后进行调用之外，还有一个问题：[MySQL](http://bugs.mysql.com/bug.php?id=18454)中有一个错误，它会影响`ORDER BY`查询，使其在大型表上比两个查询的幼稚方法慢得多。

* * *

## 回答 #3

> 赞同：29
> 
> 时间：2011-09-08T05:19:15.637

避免双重查询的另一种方法是首先使用 LIMIT 子句获取当前页面的所有行，如果检索到最大行数，则仅执行第二次 COUNT(*) 查询。

在许多应用程序中，最可能的结果是所有结果都适合一页，并且必须进行分页是例外而不是常态。在这些情况下，第一个查询不会检索到最大数量的结果。

例如，stackoverflow 问题的答案很少会溢出到第二页。对答案的评论很少会超出显示全部所需的 5 条左右的限制。

因此，在这些应用程序中，您可以简单地首先使用 LIMIT 进行查询，然后只要未达到该限制，您就可以准确地知道有多少行，而无需进行第二次 COUNT(*) 查询——这应该涵盖大部分情况。

* * *

## 回答 #4

> 赞同：16
> 
> 时间：2009-05-04T03:46:54.207

在大多数情况下，在两个单独的查询中执行此操作比在一个查询中执行要快得多且资源消耗更少，尽管这似乎违反直觉。

如果您使用 SQL_CALC_FOUND_ROWS，那么对于大型表，它会使您的查询慢得多，甚至比执行两个查询慢得多，第一个带有 COUNT(*)，第二个带有 LIMIT。原因是 SQL_CALC_FOUND_ROWS 导致在获取行*之后*而不是之前应用 LIMIT 子句，因此它在应用限制之前获取所有可能结果的整行。索引无法满足这一点，因为它实际上是在获取数据。

如果您采用两种查询方法，第一种仅获取 COUNT(*) 而不是实际获取实际数据，这可以更快地满足，因为它通常可以使用索引并且不必获取实际的行数据它查看的每一行。然后，第二个查询只需要查看前 $offset+$limit 行，然后返回。

MySQL 性能博客中的这篇文章进一步解释了这一点：

[http://www.mysqlperformanceblog.com/2007/08/28/to-sql_calc_found_rows-or-not-to-sql_calc_found_rows/](http://www.mysqlperformanceblog.com/2007/08/28/to-sql_calc_found_rows-or-not-to-sql_calc_found_rows/)

有关优化分页的更多信息，请查看[这篇文章](http://www.mysqlperformanceblog.com/2006/09/01/order-by-limit-performance-optimization/)和[这篇文章](http://www.mysqlperformanceblog.com/2008/09/24/four-ways-to-optimize-paginated-displays/)。

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2020-06-11T15:54:49.010

对于任何在 2020 年寻找答案的人。根据 MySQL 文档：

“SQL_CALC_FOUND_ROWS 查询修饰符和随附的 FOUND_ROWS() 函数**自 MySQL 8.0.17 起已弃用，并将在未来的 MySQL 版本中删除。**作为替代，考虑使用 LIMIT 执行查询，然后使用 COUNT(*) 执行第二个查询并且没有 LIMIT 来确定是否有额外的行。”

我想这就解决了。

[https://dev.mysql.com/doc/refman/8.0/en/information-functions.html#function_found-rows](https://dev.mysql.com/doc/refman/8.0/en/information-functions.html#function_found-rows)

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-05-04T02:21:22.680

```
query = SELECT col, col2, (SELECT COUNT(*) FROM `table`)/10 AS total FROM `table` WHERE `some_condition` LIMIT 0, 10 
```

其中 10 是页面大小，0 是页码（需要在查询中使用 pageNumber-1）

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2012-04-09T05:42:56.670

我的回答可能会迟到，但您可以跳过第二个查询（有限制），只需通过后端脚本过滤信息。例如，在 PHP 中，您可以执行以下操作：

```
if($queryResult > 0) {
   $counter = 0;
   foreach($queryResult AS $result) {
       if($counter >= $startAt AND $counter < $numOfRows) {
            //do what you want here
       }
   $counter++;
   }
} 
```

但是，当然，当您要考虑数千条记录时，它会很快变得低效。预先计算的计数可能是一个好主意。

这是关于这个主题的好读物： [http ://www.percona.com/ppc2009/PPC2009_mysql_pagination.pdf](http://www.percona.com/ppc2009/PPC2009_mysql_pagination.pdf)

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2016-07-16T11:26:41.047

您可以在子查询中重用大部分查询并将其设置为标识符。例如，查找包含按运行时排序的字母“s”的电影的电影查询在我的网站上看起来像这样。

```
SELECT Movie.*, (
    SELECT Count(1) FROM Movie
        INNER JOIN MovieGenre 
        ON MovieGenre.MovieId = Movie.Id AND MovieGenre.GenreId = 11
    WHERE Title LIKE '%s%'
) AS Count FROM Movie 
    INNER JOIN MovieGenre 
    ON MovieGenre.MovieId = Movie.Id AND MovieGenre.GenreId = 11
WHERE Title LIKE '%s%' LIMIT 8; 
```

请注意，我不是数据库专家，希望有人能够更好地优化它。因为它直接从 SQL 命令行界面运行它，它们在我的笔记本电脑上都需要大约 0.02 秒。

* * *

## 回答 #9

> 赞同：-18
> 
> 时间：2012-10-29T03:28:03.343

```
SELECT * 
FROM table 
WHERE some_condition 
ORDER BY RAND()
LIMIT 0, 10 
```

# cocoa - 用核心数据（Mac OS X 可可）对 _ordered_ 项目列表建模的最佳方法是什么？

> ID：818568
> 
> 赞同：2
> 
> 时间：2009-05-04T02:05:36.400
> 
> 标签：cocoa, macos, core-data

*使用核心数据对项目有序*列表建模的最佳方法是什么？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-05-04T03:40:14.817

从 OS X 10.6 开始，没有自动方式来维护 Core Data 中的有序对多关系。您必须将“索引”属性添加到一对多关系的目标并手动维护此索引或维护从对象 ID 到具有有序对多关系的实体中的索引的映射。实际上，通过覆盖 KVC 排序到多个访问器和设置器方法来实现这些选项中的第一个并不难。您还可以在父实体上创建一个 fetched 属性，以便通过将排序描述符添加到 fetched 属性的 fetch 谓词来更轻松地（只读）访问有序列表。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-02-16T21:01:37.877

如果您的目标是 Lion 或更新版本，您可以直接在数据建模器中创建有序对多关系。那些使用`NSOrderedSet`类。

# windows - 如何在 IIS 上设置 Mercurial 和 hgweb？

> ID：818571
> 
> 赞同：73
> 
> 时间：2009-05-04T02:08:47.780
> 
> 标签：windows, iis, mercurial

我一直在寻找关于如何让 hgweb 在 IIS 上工作的体面说明，但我没有发现太多的价值。

Mercurial wiki上有[这个“一步一步”](https://www.mercurial-scm.org/wiki/HgWebDirStepByStep)，但不是很好。还有[this](https://www.mercurial-scm.org/pipermail/mercurial/2007-October/015229.html)和[this](https://www.mercurial-scm.org/pipermail/mercurial-devel/2008-October/008723.html)，但同样，我找不到好的步骤来引导那些开始的地方。

* * *

## 回答 #1

> 赞同：49
> 
> 时间：2009-05-20T09:12:31.933

昨天我只需要安装一个新的 Mercurial 实例，这里是 1.7 的更新说明：

1.  [安装 Mercurial](https://www.mercurial-scm.org/)（这些说明在 1.7 中测试过）
2.  [安装 Python](http://www.python.org/download/releases/2.6.6/)（对于 Mercurial 1.7，必须使用 Python 2.6.6 的 x86 版本）
3.  您需要从 Mercurial 源下载 hgweb.cgi 文件。您可以通过运行下载源代码：`hg clone https://www.mercurial-scm.org/repo/hg/`
4.  创建一个文件夹作为您的 Web 应用程序文件夹。您需要将三件事复制到此文件夹中：

    *   hgweb.cgi 文件
    *   “C:\Program Files\Mercurial”文件夹中的 Library.zip 的内容
    *   “C:\Program Files\Mercurial”中的 Templates 文件夹
5.  您需要确保在 IIS 中设置了 Python。

    *   通过以下方式启用 CGI：控制面板 -> 打开或关闭 Windows 功能 -> 角色 -> Web 服务器 (IIS) -> 添加角色服务 -> 检查 CGI
    *   在 IIS 中创建一个新网站并确保物理路径是您在上面创建的文件夹
    *   在新网站的处理程序映射中，选择“添加脚本映射”。输入***.cgi**作为请求路径，**c:\Python26\python.exe -u "%s"**作为可执行文件，**Python**作为名称。
6.  您还需要创建一个名为“hgweb.config”的文件，其内容类似于下面。文件中的路径必须是驱动器上要存储 Mercurial 存储库的位置：

    [集合]
    c:\Mercurial\repos = c:\Mercurial\repos

7.  编辑 hgweb.cgi 文件并将设置 hgweb.config 路径的行更改为如下所示（无论 hgweb.config 文件在哪里）：

    配置 = "C:\Mercurial\hgweb.config"

8.  现在，打开浏览器并导航到[http://localhost/mercurial/hgweb.cgi](http://localhost/mercurial/hgweb.cgi)（或您在 IIS 中设置的任何适当的 URL 路径），您应该会看到 Mercurial Repositories 页面。

另外，请查看[Jeremy Skinners 博客文章](http://www.jeremyskinner.co.uk/mercurial-on-iis7/)。它有点过时，但有一些额外的好步骤，比如为更干净的 URL 设置 URL 重写。

* * *

## 回答 #2

> 赞同：34
> 
> 时间：2010-05-04T16:08:00.367

似乎自从 Mercurial 1.5.2 发布以来，这些教程并不完全正确。一方面，hgwebdir.cgi 已被删除，现在替换为 hgweb.cgi。

最适合我的说明位于[eworldui.net](http://www.eworldui.net/blog/post/2010/04/08/Setting-up-Mercurial-server-in-IIS7-using-a-ISAPI-module.aspx)：

[http://www.eworldui.net/blog/post/2010/04/08/Setting-up-Mercurial-server-in-IIS7-using-a-ISAPI-module.aspx](http://www.eworldui.net/blog/post/2010/04/08/Setting-up-Mercurial-server-in-IIS7-using-a-ISAPI-module.aspx)

这些说明适用于 IIS 7 或更高版本。如果您在 IIS 6 上进行设置，我编写了针对 Win2k3 和 IIS 6.0 的类似说明：

[http://partialclass.blogspot.com/2010/05/setting-up-mercurial-server-on-win2k3.html](http://partialclass.blogspot.com/2010/05/setting-up-mercurial-server-on-win2k3.html)

**更新：** 在完成这项工作后不久，我了解到 BitBucket 更改了他们的定价方案以提供免费、无限制的私人托管：[https](https://bitbucket.org/) ://bitbucket.org/ 。当我最初从事这个项目时，我会立即选择它。

* * *

## 回答 #3

> 赞同：12
> 
> 时间：2010-07-23T17:44:40.700

我发现[Vampire Basic](http://vampirebasic.blogspot.com/2009/06/running-mercurial-on-windows.html)上的博客文章是一个好的开始，但它并没有详细说明我所追求的。

我写了一篇由 4 部分组成的博客文章，让你从头开始使用 IIS，包括 Active Directory 集成、设置推/拉的安全权限、自定义模板，我会在这里复制它，但它相当长篇大论，Mercurial 真的被设计为托管在 Linux/Apache 上：

[http://www.endswithsaurus.com/2010/05/setting-up-and-configuring-mercurial-in.html](http://www.endswithsaurus.com/2010/05/setting-up-and-configuring-mercurial-in.html)

* * *

## 回答 #4

> 赞同：11
> 
> 时间：2009-07-19T16:09:05.083

这里有一个相当不错和全面的教程：http: [//vampirebasic.blogspot.com/2009/06/running-mercurial-on-windows.html](http://vampirebasic.blogspot.com/2009/06/running-mercurial-on-windows.html)

* * *

## 回答 #5

> 赞同：11
> 
> 时间：2010-04-06T09:40:00.920

以下是我在进行大量研究以在 IIS6 上设置 hgwebdir.cgi 后所做的工作。它基于以下站点：

*   [http://python.markrowsoft.com/iiswse.asp](http://python.markrowsoft.com/iiswse.asp)
*   [http://www.jeremyskinner.co.uk/mercurial-on-iis7/](http://www.jeremyskinner.co.uk/mercurial-on-iis7/)

您需要在服务器上安装以下内容：

*   Mercurial（我使用的是 1.5 版）
*   蟒蛇 2.6。Python 的版本取决于安装的 Mercurial 版本。Mercurial 1.5 使用 Python 2.6。即使您运行的是 x64，也要安装 x86。

我的步骤是：

*   为网站创建一个目录。我使用了 c:\inetpub\wwwroot\hg。
*   在 IIS 中，右键单击 hg 的文件夹，选择属性，选择主目录选项卡。
*   单击创建应用程序按钮。将执行权限设置为“脚本”。
*   仍然在主目录选项卡中，单击配置按钮。在“应用程序配置”弹出窗口中，单击添加按钮以添加应用程序扩展。可执行文件是 c:\Python26\python.exe -u "%s" "%s"。扩展名为 .cgi。将“动词”设置为“限制为：GET、HEAD、POST”。检查脚本引擎并验证文件是否存在。
*   在目录安全选项卡中，单击身份验证和访问控制部分中的编辑按钮。取消选中所有身份验证方法，并选中“基本身份验证”方法。如果您喜欢 Active Directory 域，请设置默认域。
*   在 IIS 中，单击左侧面板上的 Web Service Extensions 文件夹。单击“添加新的 Web 服务扩展”链接。扩展名应该是Python，需要的文件是c:\Python26\python.exe -u "%s" "%s"。确保新扩展名是“允许的”。

现在是测试 Python 是否正常工作的好时机。在新的 Hg 文件夹中创建一个名为 test.cgi 的文件。粘贴以下 python 代码：

```
print 'Status: 200 OK'
print 'Content-type: text/html'
print

print '<html><head>'
print ''
print '<h1>It works!</h1>'
print ''
print '' 
```

打开浏览器访问您的站点，例如[http://localhost/hg/te​​st.cgi](http://localhost/hg/test.cgi)

您应该看到“它有效！” 在浏览器中。

接下来让我们让 hgwebdir 工作。

*   删除 test.cgi
*   将 hg 存储库克隆到新目录：`https://www.mercurial-scm.org/repo/hg/`
*   将 hgwebdir.cgi 复制到您的 Web 目录：c:\inetpub\wwwroot\hg\ 来自克隆的 hg 存储库
*   编辑文件并更改

> ```
> application = hgwebdir('hgweb.config')
> wsgicgi.launch(application) 
> ```

至

> ```
> application = hgwebdir('c:\inetpub\wwwroot\hg\hgweb.config')
> wsgicgi.launch(application) 
> ```

*   将 Mercurial 目录 c:\Program Files\Mercurial\ 中的 Library.zip 文件解压缩到您的 Web 目录 c:\inetpub\wwwroot\hg\
*   将模板目录从 c:\Program Files\Mercurial\templates\ 复制到 c:\inetpub\wwwroot\hg\templates\
*   在您的 web 目录中创建一个名为 hgweb.config 的文件。

现在是测试它的好时机。在浏览器中访问以下 URL，[http://localhost/hg/hgwebdir.cgi](http://localhost/hg/hgwebdir.cgi)

*   编辑 hgweb.config，并粘贴以下内容：

> ```
> [collections]
> \\server\share$\Hg\ = \\server\share$\Hg\
> [web]
> allow_push = *
> push_ssl = false 
> ```

这些都是我的偏好，例如我们在 \\server\share$\Hg 的子目录中有我们的存储库。Web 应用程序将通过浏览器在登录用户的权限下运行，因此他们需要对共享的读/写权限。

最后一步是允许长连接，这在您第一次克隆存储库时可能发生。运行以下命令将超时时间增加到 50 分钟：

```
cd \inetpub\AdminScripts\
cscript adsutil.vbs GET /W3SVC/CGITimeout 
cscript adsutil.vbs SET /W3SVC/CGITimeout 3000 
```

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2009-05-04T21:39:24.083

使用 mercurial 克隆 mercurial 存储库：

```
hg clone https://www.mercurial-scm.org/repo/hg/ 
```

您会在顶层找到 hgwebdir.cgi。它应该像任何其他 cgi 脚本一样安装。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2010-12-06T15:05:57.500

在过去一周左右的时间里，我一直在为 mercurial 1.7.2 设置这个设置，为了让它工作，我不得不做一些与上述文章不同的事情。

在这里发帖是因为谷歌一直把我带回这里....

[此处发布的](https://stackoverflow.com/questions/4355256/mercurial-and-hgweb-on-iis-7-5-python-error/4367589#4367589)完整说明

我遵循了[这些说明](http://www.eworldui.net/blog/post/2010/04/08/Setting-up-Mercurial-server-in-IIS7-using-a-ISAPI-module.aspx)和[这些说明的组合（在源代码中）](http://selenic.com/hg/file/8c6b7a5f38c4/contrib/win32/hgwebdir_wsgi.py)

主要区别在于我必须执行[mercurial 的“纯 python”安装，](http://mercurial.selenic.com/wiki/WindowsInstall#Building_pure_Python_alternative)否则它会抱怨缺少 dll，我发现对 pywin 和 isapi-wsgi 使用“python 安装程序”很重要。（也许这对有经验的 python 开发人员来说是显而易见的，但我是 python 新手，所以这对我来说是个新闻）

希望这对某人有所帮助，而且我不仅仅是在编造东西（我可能是，就像我说的，python 新手）

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-08-11T21:35:18.773

hg 红皮书包含一些比我在其他地方看到的更好的一般说明。它们不是特定于 IIS 的，但它们非常好：

[http://hgbook.red-bean.com/read/collaborating-with-other-people.html#sec:collab:cgi](http://hgbook.red-bean.com/read/collaborating-with-other-people.html#sec:collab:cgi)

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2010-12-10T19:54:50.160

我遇到了“...无法加载模块...”类型错误，经过一番阅读，我的关键是忽略 Mercurial 文件夹中的 Library.zip 文件，而是使用 C:\程序文件 (x86)\TortoiseHg 文件夹。

我在本指南中找到的 #6 提示：

[http://www.endswithsaurus.com/2010/05/setting-up-and-configuring-mercurial-in.html](http://www.endswithsaurus.com/2010/05/setting-up-and-configuring-mercurial-in.html)

希望这可以帮助某人...

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2021-06-24T17:06:58.877

我知道这是一个老问题，但我真的很难在 Server 2019 和 IIS 10 上安装 Hg。这是我为使其正常工作所做的工作：

1.  安装**Python 2.7**，在我的例子中是**python-2.7.18.amd64.msi**。我假设它安装在 C:\Python27 中。确保将 python 添加到您的路径并安装了 pip。

2.  在命令行使用 pip 将 Mercurial 作为模块安装：

```
pip install mercurial 
```

3.  在**默认网站**下添加一个名为“hg”的新应用程序并将其指向您要使用的目录。

4.  将 Python 配置为 IIS 10.0 中的 CGI 处理程序，用于这个新网站（或整个 Web 服务器，如果您愿意）。您可以手动执行此操作，也可以在**web.config**文件中创建/添加以下内容：

```
<system.webServer>
    <handlers accessPolicy="Read, Script">
        <add name="Python 2.7" path="*.cgi" verb="*" modules="CgiModule" scriptProcessor="C:\Python27\python.exe -u &quot;%s&quot;" resourceType="File" />
    </handlers>
</system.webServer> 
```

5.  在“hg”应用程序文件夹中创建一个类似于以下内容的**hgweb.cgi ：**

```
#!/usr/bin/env python3
#
# An example hgweb CGI script, edit as necessary
# See also https://mercurial-scm.org/wiki/PublishingRepositories

# Path to repo or hgweb config to serve (see 'hg help hgweb')
config = "hgweb.config"

# Uncomment and adjust if Mercurial is not installed system-wide
# (consult "installed modules" path from 'hg debuginstall'):
# import sys; sys.path.insert(0, "/path/to/python/lib")

# Uncomment to send python tracebacks to the browser if an error occurs:
#import cgitb; cgitb.enable()

from mercurial import demandimport

demandimport.enable()
from mercurial.hgweb import hgweb, wsgicgi

application = hgweb(config)
wsgicgi.launch(application) 
```

6.  在“hg”应用程序文件夹中创建**hgweb.config**文件并将其指向您的存储库，如下所示：

```
[collections]
C:\Web\www\hg\repos\ = C:\Web\www\hg\repos\ 
```

7.  导航到 http://localhost/hg/hgweb.cgi 并享受！

* * *

## 回答 #11

> 赞同：-1
> 
> 时间：2012-10-10T08:17:27.860

你可以试试[HgLab](http://hglabhq.com/)。这不完全是 hgwebdir；相反，它是一个纯托管的 Mercurial 实现，带有推拉服务器和存储库浏览器。

# javascript - 在Javascript中获取文件名的目录

> ID：818576
> 
> 赞同：34
> 
> 时间：2009-05-04T02:10:23.580
> 
> 标签：javascript

如何获取文件的目录？

例如，我传入一个字符串

```
C:\Program Files\nant\bin\nant.exe 
```

我想要一个返回我的函数

```
C:\Program Files\nant\bin 
```

*我更喜欢完成这项工作的内置函数，而不是手动拆分字符串并排除最后一个字符串。*

**编辑：我在 Windows 上运行**

* * *

## 回答 #1

> 赞同：31
> 
> 时间：2009-05-04T02:19:12.843

我不知道是否有任何内置功能，但获得路径非常简单。

```
path = path.substring(0,path.lastIndexOf("\\")+1); 
```

* * *

## 回答 #2

> 赞同：19
> 
> 时间：2020-03-21T12:34:11.250

如果您使用`Node.js`,`path`模块非常方便。

```
path.dirname("/home/workspace/filename.txt") // '/home/workspace/' 
```

* * *

## 回答 #3

> 赞同：17
> 
> 时间：2015-08-20T17:27:17.010

采用：

```
var dirname = filename.match(/(.*)[\/\\]/)[1]||''; 
```

*基于 lastIndexOf('/') 或 lastIndexOf('\') 的答案容易出错，因为路径可以是“c:\aa/bb\cc/dd”。
（Matthew Flaschen 确实考虑到了这一点，所以我的回答是正则表达式替代）

* * *

## 回答 #4

> 赞同：14
> 
> 时间：2009-05-04T02:35:39.667

没有完美的解决方案，因为这个功能不是内置的，也没有办法获取系统文件分隔符。你可以试试：

```
path = path.substring(0, Math.max(path.lastIndexOf("/"), path.lastIndexOf("\\"))); 
alert(path); 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-05-04T02:47:52.540

```
function getFileDirectory(filePath) {
  if (filePath.indexOf("/") == -1) { // windows
    return filePath.substring(0, filePath.lastIndexOf('\\'));
  } 
  else { // unix
    return filePath.substring(0, filePath.lastIndexOf('/'));
  }
}
console.assert(getFileDirectory('C:\\Program Files\\nant\\bin\\nant.exe') === 'C:\\Program Files\\nant\\bin');
console.assert(getFileDirectory('/usr/bin/nant') === '/usr/bin'); 
```

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2016-01-22T21:18:56.643

很抱歉把这个备份起来，但也在寻找一个没有两次引用变量的解决方案。我想出了以下内容：

```
var filepath = 'C:\\Program Files\\nant\\bin\\nant.exe';
    // C:\Program Files\nant\bin\nant.exe
var dirpath = filepath.split('\\').reverse().splice(1).reverse().join('\\');
    // C:\Program Files\nant\bin 
```

这有点像操作字符串到数组并返回，但我认为它足够干净。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2014-03-30T21:28:05.223

还有这个？

如果不是addressFile中的程序，则返回addressFile

```
function(addressFile) {
    var pos = addressFile.lastIndexOf("/");
    pos = pos != -1 ? pos : addressFile.lastIndexOf("\\");

    if (pos > addressFile.lastIndexOf(".")) {
        return addressFile;
    }

    return addressFile.substring(
        0,
        pos+1
    );
}

console.assert(getFileDirectory('C:\\Program Files\\nant\\bin\\nant.exe') === 'C:\\Program Files\\nant\\bin\\');
console.assert(getFileDirectory('/usr/bin/nant') === '/usr/bin/nant/');
console.assert(getFileDirectory('/usr/thisfolderhaveadot.inhere') === '/usr/'); 
```

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2018-05-20T16:45:19.633

```
filepath.split("/").slice(0,-1).join("/"); // get dir of filepath 
```

1.  将字符串拆分为由“/”分隔的数组
2.  删除数组的最后一个元素（这将是文件名 + 扩展名）
3.  加入带有“/”的数组以生成目录路径

这样

```
"/path/to/test.js".split("/").slice(0,-1).join("/") == "/path/to" 
```

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2021-11-30T07:21:19.510

## 路径模块具有内置功能

是的，内置模块路径具有 dirname() 函数，它可以为您完成这项工作。

```
const path = require("path");

file_path = "C:\\Program Files\\nant\\bin\\nant.exe" \\windows path
file_path = "C:/Program Files/nant/bin/nant.exe" \\linux path

path.dirname(file_path); \\gets you the folder path based on your OS 
```

我看到您的路径既不兼容 Windows 也不兼容 Linux。不要硬编码路径；相反，从基于您的操作系统的路径中获取参考。

我通常通过使用相对路径来解决这种情况`path.join(__dirname, "..", "assets", "banner.json");`。

这给了我一个相对路径，不管你使用的是什么操作系统。

* * *

## 回答 #10

> 赞同：-3
> 
> 时间：2009-05-04T02:17:49.740

核心 Javascript 语言不提供文件/io 功能。但是，如果您在 Windows 操作系统中工作，则可以使用 FileSystemObject (ActiveX/COM)。

注意：不要在 Web 应用程序的客户端脚本端脚本中使用它，最好在其他领域，例如在 Windows 脚本主机中，或 Web 应用程序的服务器端，您可以更好地控制平台。

[此页面](http://www.yaldex.com/wjscript/sgProgrammingFileSystemObject.htm)提供了有关如何执行此操作的很好的教程。

这是一个粗略的例子来做你想做的事：

```
 var fso, targetFilePath,fileObj,folderObj;

   fso = new ActiveXObject("Scripting.FileSystemObject");

   fileObj = fso.GetFile(targetFilePath);

   folderObj=fileObj.ParentFolder;

   alert(folderObj.Path); 
```

# asp.net - ASP.net Model View Presenter 值得花时间吗？

> ID：818581
> 
> 赞同：17
> 
> 时间：2009-05-04T02:12:20.020
> 
> 标签：asp.net, asp.net-mvc, mvp

我本周末正在阅读有关 ASP.net MVP 模式的信息，如果以 MVP 模式执行，即使是最简单的任务也似乎需要付出太多的努力，回报似乎是在更大的项目中，但我想如果我是将跟随MVP。为什么不在 ASP.net MVC 中做项目？

我正在研究 MVP 模式的原因是因为我注意到在我所有的 ASP.net Webform 项目中，如果我在网络上有很多服务器控制，那么背后的代码中有很多代码只是用于事件处理形式，所以我正在寻找减少这种情况的方法并遇到 MVP 模式。

是否值得努力遵循 MVP 模式或只是切换到 ASP.net MVC？

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2009-05-05T12:10:14.427

我建议阅读以下两个链接，让您快速了解 MVP 和 MVC：

*   [Gil Fink 的一篇很棒的博客文章，介绍了 MVP 和 MVC 的不同优势](http://beta.blogs.microsoft.co.il/blogs/gilf/archive/2009/01/16/deciding-when-to-use-asp-net-mvc-framework.aspx)
*   [关于 MVP 和 MVC 之间有什么区别的 StackOverFlow 问题](https://stackoverflow.com/questions/2056/what-are-mvp-and-mvc-and-what-is-the-difference)

**你应该转行吗？**
根据您告诉我的内容，我建议您使用上面文章中提到的被动 MVP 模型。

我的主要假设是：

1.  您正在处理现有的 WebForms 应用程序代码库
2.  您需要为现有功能使用第三方 .Net 控件
3.  您正在处理现有应用程序并且没有时间重新构建它们
4.  您将来使用的任何 ASP.Net Web 应用程序，您都可以逐步应用被动 MVP 并立即获得 TDD 的好处

您的视图（代码隐藏 + aspx）本质上变得愚蠢，只执行简单的任务：

*   获取演示者提供的信息
*   响应事件并向演示者提供信息

我已经将此模型广泛用于 Web 窗体开发，我无法想象无法对我的模型和演示器代码进行单元测试。一旦您建立了不需要很长时间的基本模型并看到了单元测试的强大功能，使用 Web 表单就会变得愉快。

我使用的模型基于 MVP 的一些链接：

*   [MVP模型的简单示例](http://www.codeproject.com/KB/aspnet/EasyExampleForMVP.aspx)
*   [ASP.Net 的简单 MVP 模型](http://www.c-sharpcorner.com/UploadFile/shivprasadk/1246712242008074334AM/12467.aspx)
*   [ASP.Net 的 MVP 和 MVC 示例](http://www.codeproject.com/KB/aspnet/AspNetMvcMvp.aspx)

**我还建议您学习 MVC。**
在时间允许的情况下，将现有的 App 移植到 MVC。这样，您唯一的重点就是了解 MVC，当您将逻辑移入 MVC 模式时，您会发现您在 WebForms 中实现的东西，并且从未考虑过，但现在需要以另一种方式解决。比较模式并查看适合您的方法的好方法。

希望这会有所帮助，请随时提出任何问题。

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2009-05-04T02:22:05.707

如果您开始一个新项目，那么 ASP.net MVC 是一个更好的选择。但是，如果您只是想像刚才所说的那样重构现有项目，那么 MVP 是一个选择，因为没有简单的方法可以将这些 web-forms 代码转换为 MVC 。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-05-04T02:22:19.853

在我看来，开发新应用程序的理想方式是 MVC。但是，如果您有很多代码已经在使用 WebForms，那么 MVP 模式就是要走的路。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2012-03-06T05:26:18.110

如果它是一个新项目，我会使用 Asp.Net MVC，但我同意，MVP 可能是遗留 webforms 项目的一个很好的模式。

这是我博客中的一个示例： [http ://www.unit-testing.net/CurrentArticle/How-To-Use-Model-View-Presenter-With-AspNet-WebForms.html](http://www.unit-testing.net/CurrentArticle/How-To-Use-Model-View-Presenter-With-AspNet-WebForms.html)

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-05-04T02:19:18.940

我个人的看法是，如果后面的代码中有很多代码，除了采用 MVP 之外，还有其他方法可以瘦身、重构并使其可测试。

如果您的页面具有广泛的用户交互（如按钮/链接启用/禁用、面板和控件出现/消失），MVP 将是值得的。

# c# - SQL Server 的端口被阻塞

> ID：818582
> 
> 赞同：0
> 
> 时间：2009-05-04T02:14:10.110
> 
> 标签：c#, sql, sql-server, windows

开发了一个远程访问在线 SQL Server 的 Windows 应用程序。但是，客户端的 ISP 阻止了端口 1433。从 Windows 应用程序连接到 SQL Server 的其他选项是什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-04T02:25:42.467

SQL Server 应该有一个网络实用程序，您可以在其中配置要使用的端口。联系您客户的 ISP 以查看哪些端口已打开（他们甚至可以为您打开 1433），然后配置服务器以使用该端口。

在我的安装中，您选择：`"Start > All programs > Microsoft SQL Server > Server Network utility"`，`"Enabled Protocols"`然后选择`"TCP/IP"`和`"Properties"`。

从那里您可以将默认端口设置为更易于访问的端口。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-04T02:16:53.330

您可以更改运行 SQL Server 的端口号，以使用在 ISP 处实际打开的端口。

由于 1433 是 SQL Server 的默认端口，因此它是黑客的常见目标。一些 ISP 选择任意端口号来混淆它。您可能需要找到来自他们的端口号。

另一种选择是使用托管在 IIS 中的[WCF Web 服务，并让您的 Windows 应用程序调用此服务。](http://www.codeproject.com/KB/WCF/LinqWcfService.aspx)

# c# - 如何使用 .NET 安装打印机？

> ID：818583
> 
> 赞同：6
> 
> 时间：2009-05-04T02:14:46.177
> 
> 标签：c#, vb.net, printing

我有一个用于需要从 .NET 应用程序安装的虚拟打印机的 .INF。我在使用批处理脚本之前已经完成了这项工作，但我正在寻找在 .NET Framework 中执行此操作的代码片段。

打印机 .INF 没有什么特别之处，因此任何从 C# 或 VB.NET 中的 INF 安装打印机的代码都可以工作。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-05-04T02:35:36.563

我相信这可以通过与本机 win32 API 的互操作实现，但我发现使用 System.Diagnostics.Process() 通过以下方式调用 printui.dll 容易得多：

`rundll32.exe printui.dll,PrintUIEntry /?`

也许您已经在提到的批处理脚本中使用了它，但如果没有，这里记录了参数：[PrintUI.DLL User's Guide and Reference](http://www.microsoft.com/windowsserver2003/techinfo/overview/printuidll.mspx)

请务必针对您需要支持的所有操作系统进行测试。某些选项要么在所有 Windows 版本中都不存在，要么已被重命名（尽管我认为它们是更深奥的选项 - 安装 .INF 可能会全面工作）。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-05-04T04:15:12.347

您将要查看可用的 WMI 对象。这些使您可以更好地控制本地机器设置。看看微软的[WMI 代码创建](http://www.microsoft.com/downloads/details.aspx?FamilyID=2cc30a64-ea15-4661-8da4-55bbc145c30e&DisplayLang=en)器，我相信这会生成一些示例代码，您可以利用它来解决您的问题。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-04T08:24:33.277

[在 C# 中管理打印机设置以实现灵活打印](http://www.codeproject.com/KB/cs/PrinterAdmin.aspx)

请参阅这篇文章，它使用名为 PRNADMIN 的 MS 平台 SDK DLL 来管理打印机、打印机驱动程序、打印机端口等。

我个人在商业项目中使用它来安装打印机驱动程序并将打印机端口更改为本地端口以拦截Postscript。它就像一个魅力。

或者，您可以在 C:\Windows\system32\Printing_Admin_Scripts 中使用 Windows 附带的一些预安装的 vbscript，这里有一篇文章：

[http://technet.microsoft.com/en-us/library/cc771846.aspx](http://technet.microsoft.com/en-us/library/cc771846.aspx)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-04T02:23:40.507

这*不是*理想的解决方案，但如果没有其他人回答，您可以创建一个临时批处理文件并通过 C#/VB.NET 调用它。

其他人可能会知道一种更自然的方法来做到这一点。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-04T04:01:04.703

您将需要使用 PINVOKE 或本机 COM 对象来包装设置 API。

# java - MacOS 上的 Java.lang.UnsupportedClassVersionError

> ID：818592
> 
> 赞同：0
> 
> 时间：2009-05-04T02:21:10.810
> 
> 标签：java

我正在尝试运行在 Windows XP 上运行良好的 Java Applet 应用程序（使用 Eclipse IDE），但是在 MacOS X 上导入项目后（在 MacOS 上也使用 Eclipse），它无法运行并显示此错误：

`Exception in thread "main" java.lang.UnsupportedClassVersionError: Bad version number in .class file at java.lang.ClassLoader.defineClass1(Native Method) at java.lang.ClassLoader.defineClass(ClassLoader.java:675) at java.security.SecureClassLoader.defineClass(SecureClassLoader.java:124) at java.net.URLClassLoader.defineClass(URLClassLoader.java:260) at java.net.URLClassLoader.access$100(URLClassLoader.java:56) at java.net.URLClassLoader$1.run(URLClassLoader.java:195) at java.security.AccessController.doPrivileged(Native Method) at java.net.URLClassLoader.findClass(URLClassLoader.java:188) at java.lang.ClassLoader.loadClass(ClassLoader.java:316) at sun.misc.Launcher$AppClassLoader.loadClass(Launcher.java:280) at java.lang.ClassLoader.loadClass(ClassLoader.java:251) at java.lang.ClassLoader.loadClassInternal(ClassLoader.java:374) at edu.isi.calo.mapping.gui.DieselUtil.(DieselUtil.java:9) at edu.isi.diesel.DieselEditor.processSettingsFile(DieselEditor.java:597) at edu.isi.diesel.DieselEditor.main(DieselEditor.java:80)`

有人遇到过这样的问题吗？我删除了所有的类文件并再次构建了整个项目，但它仍然弹出这个运行时错误。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-04T02:25:29.177

该消息告诉您的是，您的 JRE 不知道如何执行该类，因为该类的版本太新。两个明显的问题是：

1.  您在 Windows XP 上安装了哪个版本的 JRE？
2.  你有苹果[最新的 JRE 发行版](http://developer.apple.com/java/)，它应该支持 Java 6 吗？

我猜您使用的 JRE 版本是 Java 5 之前的版本。

# iphone - 为什么popViewController每隔一段时间才工作一次

> ID：818605
> 
> 赞同：6
> 
> 时间：2009-05-04T02:25:46.507
> 
> 标签：iphone, cocoa-touch, uiviewcontroller, uinavigationcontroller

我完全被难住了，情况如下：

我的应用程序使用核心位置框架来获取用户的当前位置，然后在[TrailBehind](http://www.trailbehind.com)上 ping 我的服务器以查找附近有趣的地方并将它们显示为列表。没问题。

为了节省电池，我在从服务器获取数据后关闭了 GPS 服务。如果用户在使用应用程序时四处走动并想要一个新列表，他单击导航控制器上的“刷新”并再次激活 CLLocation 服务，从服务器检索一批新数据并重绘表格。

当应用程序从我的服务器获取数据时，我加载了一个带有旋转地球的加载屏幕，上面写着“正在加载，请稍候”，我隐藏了导航栏，这样他们就不会点击“返回”。

因此，从服务器获取的初始数据完美无缺。

我第一次点击刷新所有代码执行以获取新位置，再次 ping 服务器以获取新的数据列表并更新单元格。但是，它不会按应有的方式加载表格视图，而是恢复表格视图的导航控制器栏，但仍会在主窗口中显示我的加载视图。这仅在设备上是正确的，在模拟器中一切正常。

我第二次点击刷新功能正常工作。

我第三次刷新它失败如上。

我第四次刷新它正常工作。

我第五次刷新它失败如上。

等等，偶数刷新成功，奇数刷新失败。我逐行遍历了所有代码，一切似乎都在正常执行。我实际上继续跳过核心指令，在大量单击“跳过”之后，我发现表格视图确实在 CFRunLoopRunSpecific 中的某个时间点显示在屏幕上，但然后我单击“继续”并且我的加载视图接管了屏幕。

我完全感到困惑。请帮忙！！非常感谢您的洞察力。

[奇怪行为的视频：](http://www.youtube.com/watch?v=GAzh-P5k9IA)

相关代码：

RootViewControllerMethods（这是这个 TableView 项目的基础视图）

```
- (void)viewDidLoad {
    //Start the Current Location controller as soon as the program starts.  The Controller calls delegate methods
    //that will update the list and refresh
    [MyCLController sharedInstance].delegate = self;
    [[MyCLController sharedInstance].locationManager startUpdatingLocation];
    lv = [[LoadingViewController alloc] initWithNibName:@"Loading" bundle:nil];
    [self.navigationController pushViewController:lv animated:YES];
    [super viewDidLoad];
}

- (void)updateClicked {
    //When the location is successfully updated the UpdateCells method will stop the CL manager from updating, so when we want to update the location
    //all we have to do is start it up again.  I hope.
    [[MyCLController sharedInstance].locationManager startUpdatingLocation];
    [self.navigationController pushViewController:lv animated:YES];
    //LV is a class object which is of type UIViewController and contains my spinning globe/loading view.
}

-(void)updateCells {
    //When the Core Location controller has updated its location it calls this metod.  The method sends a request for a JSON dictionary
    //to trailbehind and stores the response in the class variable jsonArray.  reloadData is then called which causes the table to
    //re-initialize the table with the new data in jsonArray and display it on the screen.  

    [[MyCLController sharedInstance].locationManager stopUpdatingLocation];

    if(self.navigationController.visibleViewController != self) {
        self.urlString = [NSString stringWithFormat:@"http://www.trailbehind.com/iphone/nodes/%@/%@/2/10",self.lat,self.lon];
        NSURL *jsonURL = [NSURL URLWithString:self.urlString];
        NSString *jsonData = [[NSString alloc] initWithContentsOfURL:jsonURL];
        NSLog(@"JsonData = %@ \n", jsonURL);
        self.jsonArray = [jsonData JSONValue];
        [self.tableView reloadData];
        [self.navigationController popToRootViewControllerAnimated:YES];
        [jsonData release];
    }
} 
```

CLController 方法：基本上只是将所有数据直接发送回 RootViewController

```
// Called when the location is updated
- (void)locationManager:(CLLocationManager *)manager
    didUpdateToLocation:(CLLocation *)newLocation
           fromLocation:(CLLocation *)oldLocation
{
    NSLog(@"New Location: %@ \n", newLocation);
    NSLog(@"Old Location: %@ \n", oldLocation);
    @synchronized(self) {
        NSNumber *lat = [[[NSNumber alloc] init] autorelease];
        NSNumber *lon = [[[NSNumber alloc] init] autorelease];
        lat = [NSNumber numberWithFloat:newLocation.coordinate.latitude];
        lon = [NSNumber numberWithFloat:newLocation.coordinate.longitude];
        [self.delegate noteLat:lat];
        [self.delegate noteLon:lon];
        [self.delegate noteNewLocation:newLocation];
        [self.delegate updateCells];
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-09T21:59:34.213

第一个想法是，在您推送加载视图之前，您可能不想将 startUpdatingLocation 发送到 CLLocationManager。通常第一个 -locationManager:didUpdateToLocation:fromLocation: 消息会立即与缓存的 GPS 数据一起出现。仅当您对每条消息都采取行动并且不过滤 GPS 数据（如此处的示例代码中所示）时，这才重要。但是，这不会导致您描述的情况 - 它会导致加载屏幕卡住。

我在不同的情况下经历过类似的奇怪行为，当我在切换到不同的选项卡时尝试弹出到根视图控制器并且没有在正确的位置进行调用。我相信 popToRootViewController 被我调用了两次。我怀疑您的加载视图要么被推送两次，要么被弹出两次。

我建议在 LoadingViewController 中实现 -viewWillAppear:、-viewDidAppear:、-viewWillDisappear: 和 -viewDidDisappear: 的日志记录最少。

```
- (void)viewWillAppear:(BOOL)animated {
    NSLog(@"[%@ viewWillAppear:%d]", [self class], animated);
    [super viewWillAppear:animated];
}

- (void)viewDidAppear:(BOOL)animated {
    NSLog(@"[%@ viewDidAppear:%d]", [self class], animated);
    [super viewDidAppear:animated];
}

- (void)viewWillDisappear:(BOOL)animated {
    NSLog(@"[%@ viewWillDisappear:%d]", [self class], animated);
    [super viewWillDisappear:animated];
}

- (void)viewDidDisappear:(BOOL)animated {
    NSLog(@"[%@ viewDidDisappear:%d]", [self class], animated);
    [super viewDidDisappear:animated];
} 
```

然后，在您的设备上运行测试以查看它们是否总是被发送到您的视图控制器以及多久发送一次。您可以向 -updateClicked 添加一些日志记录以显示双击。

另一个想法，虽然你的 @synchronized 块是一个好主意，但它只会阻止其他线程执行这些语句，直到第一个线程退出块。我建议将 -stopUpdatingLocation 消息移动到该 @synchronized 块内的第一条语句。这样，一旦你决定对一些新的 GPS 数据采取行动，你会立即告诉 CLLocationManager 停止发送新数据。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-24T00:59:35.230

所以，我从来没有让这个工作。我仅在每次以编程方式调用 popViewController 时才在设备上观察到这种行为，而不是允许导航控制器上的默认后退按钮进行弹出。

我的解决方法是构建一个自定义加载视图，并在每次由于访问互联网而出现延迟时将屏幕翻转到该视图。我的方法采用布尔变量是或否 - yes 切换到加载屏幕，no 切换回正常视图。这是代码：

```
- (void)switchViewsToLoading:(BOOL)loading {
// Start the Animation Block  
CGContextRef context = UIGraphicsGetCurrentContext();  
[UIView beginAnimations:nil context:context];  
[UIView setAnimationTransition: UIViewAnimationTransitionFlipFromLeft forView:self.tableView cache:YES];  
[UIView setAnimationCurve:UIViewAnimationCurveEaseInOut];  
[UIView setAnimationDuration:.75];  

// Animations  
if(loading) { 
    if (lv == nil) { lv = [[LoadingViewController alloc] initWithNibName:@"Loading" bundle:nil]; }
    [self.view addSubview:lv.view];
    [self.view sendSubviewToBack:self.tableView];
    self.title = @"TrailBehind";
}
else {
    [lv.view removeFromSuperview];

}
// Commit Animation Block  
[UIView commitAnimations];  
//It looks kind of dumb to animate the nav bar buttons, so set those here
if(loading) {
    self.navigationItem.rightBarButtonItem = nil;
    self.navigationItem.leftBarButtonItem = nil;
    self.title = @"TrailBehind";
}
else {
    UIBarButtonItem *feedback = [[UIBarButtonItem alloc] initWithTitle:@"Feedback" style:UIBarButtonItemStylePlain target:self action:@selector(feedbackClicked)];
    self.navigationItem.rightBarButtonItem = feedback;
    UIBarButtonItem *update = [[UIBarButtonItem alloc] initWithTitle:@"Move Me" style:UIBarButtonItemStylePlain target:self action:@selector(updateClicked)];
    self.navigationItem.leftBarButtonItem = update;
    [feedback release];
    [update release];
} 
```

}

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-24T01:36:49.257

查看您的原始代码，我非常怀疑这个块：

```
- (void)viewDidLoad {
    ...
    lv = [[LoadingViewController alloc] initWithNibName:@"Loading" bundle:nil];
    [self.navigationController pushViewController:lv animated:YES];
    [super viewDidLoad];
 } 
```

`viewDidLoad`每次加载 NIB 时都会调用它，这可能会发生多次，尤其是在内存不足的情况下（考虑到它仅在设备上发生的说法，这似乎很可能）。我建议你实现`-didReciveMemoryWarning`，并且在调用 super 之后，至少打印一个日志，这样你就可以看到它是否发生在你身上。

上面的代码让我困扰的是你几乎肯定在泄漏`lv`，这意味着可能会有越来越多的`LoadingViewControllers`跑来跑去。你说它是一个类变量。你真的是说它是一个实例变量吗？ivars 应始终使用访问器（`self.lv`或`[self lv]`而不是`lv`）。不要直接分配给他们；您几乎总是会做错（因为您可能在这里做错了）。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2011-12-06T13:26:16.693

我在搜索完全相同的问题时遇到了这个问题，所以虽然我确定你现在已经解决了你的问题，但我想我会发布我的解决方案以防其他人遇到它......

当您在界面生成器中将两个 IBAction 分配给同一个 UIButton 时，似乎会导致此错误。事实证明，我用来将视图控制器推送到堆栈上的按钮被分配给了两个 IBAction，每个 IBAction 都将不同的控制器推送到 navigationController 的堆栈上（尽管您最终只会看到其中一个 - 可能是最后一个一个被称为）。所以无论如何，按下最顶层视图上的后退按钮并不会真正关闭它（或者它可能正在关闭第二个看不见的控制器），您必须按两次才能返回。

无论如何，请检查您的按钮并确保它们仅分配给单个 IBAction。那为我修好了。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-04T06:27:07.053

您可以尝试调试您的应用程序以查看调用 updateCells 时控件的位置吗？该应用程序似乎没有任何明显错误。

确保在 LoadingViewController 类中没有内存警告。如果有内存警告并且您的 RootViewController 的视图正在被释放，那么当您对 RootViewController 执行弹出操作时，将再次调用 viewDidLoad。

在 viewDidLoad 和 updateCells 中保留断点。你确定你没有在其他任何地方调用 LoadingViewController 吗？

# c# - Windows 应用程序和 SQL Server

> ID：818614
> 
> 赞同：0
> 
> 时间：2009-05-04T02:33:15.070
> 
> 标签：c#, sql-server, linq-to-sql, ado.net

连接到 Internet 上托管的 SQL Server 的 Windows 应用程序的最佳做法是什么？我目前正在使用带有 SQL 身份验证的基于 IP 的连接字符串，没什么特别的。但是，某些客户端无法使用端口 1433 进行连接，我假设整个方法存在一些安全问题。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-04T02:40:28.220

通过 Internet 公开 SQL Server 充满了安全问题。我建议你阅读这篇 MS 文章：[通过 Internet 连接到 SQL Server](http://msdn.microsoft.com/en-us/library/ms175483.aspx)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-04T02:44:45.650

连接到 sql server 有四个选项：

1.  共享内存。
2.  命名管道。
3.  TCP/IP
4.  通过

由于您是通过 Internet 公开的，我认为 3 是唯一的选择。然而，正如上一篇文章所暗示的，这不是一个健全的架构。您确实应该将业务逻辑包装到 Web 服务中，并公开 Web 服务而不是原始 sql 接口。

# regex - 语法高亮的正则表达式有哪些替代方法？

> ID：818628
> 
> 赞同：1
> 
> 时间：2009-05-04T02:44:29.380
> 
> 标签：regex, parsing, editor, syntax-highlighting, lexical-analysis

在 Vim 中编辑这个和那个时，我经常发现它的语法高亮（对于某些文件类型）有一些缺陷。我现在不记得任何例子，但肯定有人会。通常，它包含在某些情况下严重突出显示的字符串，一些带有算术和布尔运算符的东西以及其他一些小东西。

现在，vim 使用正则表达式来处理那种东西（它自己的风格）。

但是，我开始遇到一些编辑器，乍一看，它们的语法突出显示得到了更好的照顾。我一直认为正则表达式是解决这类问题的方法。

所以我想知道，那些编辑只是有更好的书面正则表达式，还是他们以其他方式处理？什么 ？当您希望它“稳定”时，如何处理语法突出显示？在您看来，哪位编辑做得最好（在您选择的编辑中），他是如何做到的（语言方面）？

**Edit-1：**例如，像 Emacs、Notepad2、Notepad++、Visual Studio 这样的编辑器——你是否知道他们使用什么机制来进行 syn. 高的。?

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-04T03:27:15.283

对于您想要使用什么而不是正则表达式来突出显示语法，立即想到的想法是**parsing**。正则表达式有很多优点，但正如我们在 vim 的突出显示中看到的那样，有一些限制。（如果您寻找有关使用正则表达式分析 XML 的主题，您会发现大量关于为什么正则表达式不能做解析器所做的事情的材料。）

由于我们希望语法高亮显示它遵循语言的语法结构，而正则表达式只能近似，因此您需要执行某种程度的实际解析以超越正则表达式的功能。我在想，一个简单的递归下降词法分析器可能对大多数语言都有好处。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-04T03:46:44.583

一些编程语言具有以[Backus-Naur 形式](http://en.wikipedia.org/wiki/Backus%E2%80%93Naur_Form)编写的正式定义/规范。所有^(*))编程语言都可以在其中描述。然后，您所需要的只是某种符号解析器。

^(*） 未经审核的)

例如，[C 的 BNF](http://lists.canonical.org/pipermail/kragen-hacks/1999-October/000201.html)定义是“只有五页长”。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-04T03:30:06.870

如果您想准确突出显示需要真正的编程而不是正则表达式。正则表达式很少是解决琐碎任务的答案。要以更好的方式突出显示，您需要编写一个简单的解析器。解析基本上具有单独的组件，每个组件都可以执行诸如识别和使用带引号的字符串或数字文字之类的操作。如果在查看该组件时，给定的光标不能消耗它下面的内容，它什么也不做。从中您可以轻松轻松地解析或突出显示。

鉴于类似

静态int字段= 123；

• 第一个 macher 将跳过“static”之前的空格。关键字、文字等匹配器不会做任何事情，因为处理空格不是他们的事。

• 定位在“静态”上时匹配的关键字会消耗它。因为“s”不是数字，所以匹配的文字什么也不做。因为“s”不是空格字符，所以空格跳过器也不做任何事情。

自然地，您的循环会继续将光标移到输入字符串上，直到到达结尾。匹配器的顺序当然很重要。

这种方法既灵活，因为它处理语法不正确的片段，也易于扩展和重用单个匹配器以支持其他语言的突出显示......

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-04T02:51:52.217

我建议使用 RE 进行语法高亮。如果它不能正常工作，那么你的 RE 不够强大或不够复杂 :-) 这是 RE 大放异彩的领域之一。

但是鉴于你无法提供任何失败的例子（所以我们可以告诉你问题出在哪里）或做得更好的编辑的名字（所以我们可以告诉你他们是如何做到的），没有更多我们将能够给你一个答案。

我从来没有遇到过使用主流语言的 Vim 问题，也从来不需要使用奇怪的深奥语言，所以它很适合我的目的。

# winapi - 在不触发事件的情况下设置虚拟键/鼠标按钮状态

> ID：818634
> 
> 赞同：0
> 
> 时间：2009-05-04T02:49:03.190
> 
> 标签：winapi, keyboard, mouse, simulation, user32

是否可以为计算机上的所有程序设置虚拟键状态/鼠标按钮状态而不同时触发相关事件（例如将鼠标左键设置为当前按下而不发送鼠标按下事件）。这是否可以通过为假键盘或鼠标设置假键盘或鼠标驱动程序来实现，当查询键的当前状态时会回复您选择的答案或通过任何其他方式？

编辑：这必须影响我没有代码在其他线程等中运行的程序......

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-04T03:08:52.817

好吧，我没有完整的答案给你，但是......

Win32 函数[SetKeyboard State()](http://msdn.microsoft.com/en-us/library/ms646314(VS.85).aspx)更改调用它的线程的键盘状态。

我知道这不会影响整个系统，但是如果您只需要为正在开发的应用程序更改键盘状态，那么每个程序都可以调用它，从硬盘驱动器上的临时文件中读取传递给它的数组。

否则……不知道其他任何事情……

# linq - SingleOrDefault：如何更改默认值？

> ID：818642
> 
> 赞同：35
> 
> 时间：2009-05-04T02:54:17.360
> 
> 标签：linq

SingleOrDefault 返回 null，但是如果我想分配值来表示未找到的对象怎么办？

* * *

## 回答 #1

> 赞同：54
> 
> 时间：2009-05-04T02:59:03.527

你可以做类似的事情

```
myStrings.DefaultIfEmpty("myDefaultString").Single() 
```

在[这里查看](http://msdn.microsoft.com/en-us/library/bb342451.aspx)

* * *

## 回答 #2

> 赞同：24
> 
> 时间：2009-05-04T03:14:39.340

[?? 运营商](http://weblogs.asp.net/scottgu/archive/2007/09/20/the-new-c-null-coalescing-operator-and-using-it-with-linq.aspx)。如果左参数为空，则计算并返回第二个参数。

```
myCollection.SingleOrDefault() ?? new[]{new Item(...)} 
```

这仅适用于引用类型（或可为空值），但它会非常简单地完成您正在寻找的事情。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-05-04T02:57:56.477

你可以自己滚。

```
public static T SingleOrDefault<T>(this IEnumerable<T> enumerable, T defaultValue) {
  if ( 1 != enumerable.Count() ) {
    return defaultValue;
  }
  return enumerable.Single();
} 
```

虽然这可能有点贵，因为 Count() 需要您处理整个集合并且运行起来可能相当昂贵。最好调用 Single，捕获 InvalidOperationException 或滚动 IsSingle 方法

```
public static bool IsSingle<T>(this IEnumerable<T> enumerable) {
  using ( var e = enumerable.GetEnumerator() ) {
    return e.MoveNext() && !e.MoveNext();
  }
}

public static T SingleOrDefault<T>(this IEnumerable<T> enumerable, T defaultValue) {
  if ( !enumerable.IsSingle() ) {
    if( enumerable.IsEmpty() ) { 
      return defaultValue;
    }
    throw new InvalidOperationException("More than one element");
  }
  return enumerable.Single();
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-04T03:09:04.283

您可以创建自己的扩展方法—— SingleOrNew。

```
public static class IEnumerableExtensions
{
    public static T SingleOrNew<T>( this IEnumerable<T> enumeration, T newValue )
    {
        T elem = enumeration.SingleOrDefault();
        if (elem == null)
        {
            return newValue;
        }
        return elem;
    }

    public static T SingleOrNew<T>( this IEnumerable<T> enumeration, Func<T,bool> predicate, T newValue )
    {
        T elem = enumeration.SingleOrDefault( predicate );
        if (elem == null)
        {
            return newValue;
        }
        return elem;
    }
} 
```

# .net - 是否有可能让 LinQ “理解”一个经典的 SQL 查询？

> ID：818643
> 
> 赞同：2
> 
> 时间：2009-05-04T02:54:57.577
> 
> 标签：.net, sql, linq, linq-to-sql

是否可以让 LinQ to SQL 读取并理解如下纯 SQL 查询？

```
SELECT * from myTable 
```

我的老板让我将某个表中的纯 SQL 查询直接写入数据库，例如，该表将有一个名为“typeOfSelect”的字段。

而且，在我的应用程序中，我必须阅读这个字段“typeOfSelect”并让 LinQ 理解这意味着什么。

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-04T03:25:36.973

您可以在 DataContext 上使用 ExecuteCommand 和 ExecuteQuery 方法。

```
var db = new MyDataContext();
IEnumerable<Table1> result = db.ExecuteQuery<Table1>("SELECT * FROM Table1");
db.ExecuteCommand("UPDATE Tabel1 SET Column1 = 'Foo'"); 
```

ExecuteQuery 将适用于具有与表的列名匹配的属性名称的任何对象。ExecuteCommand 用于不返回结果集的 SQL 命令。

另一种方法是在 DataContext 上使用 Connection.CreateCommand() 方法，该方法将返回一个 DbCommand 对象。然后，您只需使用要执行的 SQL 设置 CommandText 属性。

```
DbCommand command = myDataContext.Connection.CreateCommand();
command.CommandText = "SELECT * FROM Table1";

try {
    command.Connection.Open();
    DbDataReader reader = command.ExecuteReader();
    // do something usefull with the reader like creating a DataTable
} finally {
    command.Connection.Close();
    command.Dispose();
} 
```

您还可以查看此[MSDN](http://msdn.microsoft.com/en-us/library/bb386906.aspx)链接以获取其他示例。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-04T03:04:30.660

如果你想编写 SQL，很容易创建一些包装类，所以你想写这样的东西。

```
DataTable result = DBManager.Query("SELECT * FROM Table"); 
```

但我认为这通常不再被认为是好的做法，并且会违背 Linq 的目的。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-04T04:02:48.273

LINQ 是 Microsoft 将其服务器访问技术与更通用、可移植的技术区分开来的方法。通过使程序员更容易按照“Microsoft 方式”进行操作，他们获得了竞争优势。一旦你确信 LINQ 是通用查询语法，它的适用性超出了关系数据库（这是主要目的地，竞争非常激烈），他们就会对保持对语言的完全控制有浓厚的兴趣（尤其是因为它将与他们的其他基础设施一起工作得最好）。

在这里，我们将了解“泄漏抽象”概念的效果如何。微软当然拥有我认为业内最优秀的人才，而且很多人都在押注它。但这是一个 100% 的承诺——没有回头路。

It's a lot like asking whether you can use SQL to express ISAM queries. And at one time it was IBM driving the SQL query infrastructure, in an equally semi-proprietary way, as I've heard it told.

# php - 如何使用 PHP 和 AJAX 创建 igoogle 布局（拖放和存储）？

> ID：818645
> 
> 赞同：4
> 
> 时间：2009-05-04T02:56:59.630
> 
> 标签：php, mysql, ajax, drag-and-drop, igoogle

在 igoogle 中，我们可以拖放模块，然后如果我们退出浏览器并再次打开它，每个模块的位置仍然相同。我已经测试了几件事：

1.  未登录时，igoogle 将模块位置存储在我的 cookie（缓存）中。因为如果我清除缓存，它会回到原来的位置。

2.  当我登录时，定位模块后，即使我注销并清除我的缓存，如果我再次登录，模块仍然是一样的，没有回到原来的位置。

我想问的是：

1.  如何存储已登录和未登录用户的模块位置？

2.  需要哪些技能？（我使用 php、mysql 和 jquery）

3.  有什么好的教程可以参考吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-04T04:39:07.890

这里有一个很好的教程：http: [//nettuts.com/tutorials/javascript-ajax/inettuts/](http://nettuts.com/tutorials/javascript-ajax/inettuts/)

您必须将用户数据存储在 mysql 表中。也许在您的 mysql 表中设置一个带有链接内容 ID 的“列/行”列。如果您对关系数据库一无所知，最好从那里开始。如果您确实了解数据库基础知识，那么这将是一个简单的更新查询，以根据设置为在很远的将来过期的 cookie 来存储用户信息。

如果您允许用户登录（如 google），则不需要使用 cookie（但仍然有用），因为您可以使用存储在 mysql 表中的 div 位置数据。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-05T02:25:12.273

[拖放背后的逻辑](https://stackoverflow.com/questions/798666/logic-behind-drag-and-drop/802221#802221)

1.  使用[http://jqueryui.com/demos/sortable/](http://jqueryui.com/demos/sortable/)启用可排序的 div 列表
2.  处理 sortable("toArray") 到数据库
3.  从 db 中按顺序加载它以使它们就位

# c++ - 我在哪里可以找到好的 C++ 源代码？

> ID：818647
> 
> 赞同：19
> 
> 时间：2009-05-04T02:57:31.847
> 
> 标签：c++

我正在学习 C++ 作为第一语言。如果我不尽快开始查看实际代码，我觉得我的学习即将达到上限（我不是通过课堂学习）。这是我的两个主要问题：

1.  在哪里可以找到源代码
2.  什么是对代码质量的良好试金石（我显然从未在工作环境中开发过）

我希望这与 SO 有关，但我可以看到需要关闭它。谢谢您的帮助。

* * *

**有关的：**

[“现代 C++”的实际例子？](https://stackoverflow.com/questions/534311/examples-of-modern-c-in-action)

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-04T03:05:48.847

我会推荐[Boost](http://www.boost.org/ "促进")。使用 Boost 将简化您的程序设计。阅读 Boost 源代码可以简洁地向您展示如何使用 C++ 解决一些具有挑战性的问题。

这个附加库本身是用 C++ 编写的，以经过同行评审的方式编写的，并且具有很高的质量标准。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-04T03:03:52.703

我认为查找 C++ 代码的两个最佳选择是访问流行的开源存储库。

*   CodePlex：[http ://codeplex.com](http://codeplex.com)
*   谷歌代码：[http ://code.google.com](http://code.google.com)
*   SourceForge：http: [//sourceforge.net/](http://sourceforge.net/)

这些都有高质量的 C++ 项目，你可以看看。我不认为有一个很好的衡量标准来大规模地判断质量。我会从更受欢迎的项目开始，这些项目可能更有可能拥有高质量的代码。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-04T03:44:22.543

名单：

*   SourceForge：http: [//sourceforge.net/](http://sourceforge.net/)
*   升压： http: [//www.boost.org/](http://www.boost.org/)
*   CodePlex： http: [//www.codeplex.com/](http://www.codeplex.com/)
*   谷歌代码：[http ://code.google.com/](http://code.google.com/)
*   谷歌代码大学： [http ://code.google.com/edu/](http://code.google.com/edu/)
*   koders.com：http://www.koders.com/ [_](http://www.koders.com/)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-04T03:03:21.287

网络上充斥着开源 C++ 代码。为什么不挑选一些这样的项目，甚至更好地开始帮助他们呢？没有比做更好的学习方式了！

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-04T03:03:59.240

我会推荐一本好书，里面有很多源代码示例！

[简而言之 C++](http://product.half.ebay.com/C-in-a-Nutshell_W0QQprZ2430159QQtgZinfo)

[您也可以在www.koders.com](http://www.koders.com)上搜索开源代码

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-04T03:37:02.297

我认为您已经得到了一些很好的答案，我想添加以下建议以从一个开源项目存储库中选择一个项目：选择一个广泛使用但最好是较小的项目，该项目已经存在了一段时间并针对您的域特别感兴趣。这样，您将能够更好地了解生产就绪代码，并能够了解有关该领域的知识。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-05-04T06:51:06.497

我发现[POCO](http://pocoproject.org/blog/?p=219)的源代码和文档非常易读，并且

1.  不像其他一些专注于处理一个特定问题的开源项目，比如 GUI 或 Logging，这个库专注于开发一个完整的应用程序，因此涵盖了相当广泛的领域（文件系统、文本处理、网络、日志记录等）。
2.  它使用现代 C++ 习语。因此，通过阅读实现，您也可以学习现代 C++ 技能。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-08-31T13:20:33.947

我会推荐 OpenSG 这是一个有趣的话题，它使用并发建模，网络，包括科学论文的链接，有据可查，使用真正的 c++ 而不是 c 与对象的东西和几乎所有的子范式，并且不会过度使用它们，很容易访问并且谁会猜到...我是它的粉丝；）

[OpenSG - 主页](http://opensg.vrsource.org/trac/wiki/WikiStart)

* * *

## 回答 #9

> 赞同：-1
> 
> 时间：2009-05-04T03:11:16.837

C++ 是一门很棒的语言，但作为第一语言有点沉重。试试[蟒蛇](http://wiki.python.org/moin/BeginnersGuide)。

> 1）在哪里可以找到源代码

读代码比写代码更难。对于像 C++ 这样的大型复杂语言尤其如此。在不了解该语言的复杂性的情况下，您不太可能从其他人在生产中编写的复杂代码中获取知识。您将必须首先通过编写自己的方式学习最小的部分。在学习 c++ 的同时，您还将学习编程。

> 2) 什么是对代码质量的良好试金石

没有一个。这也不是一件容易学习的事情。它来自经验。但实际上，您了解好代码和坏代码的方法是，在您有时间熟悉项目的布局之后，您可以在查看任何给定的代码后理解它的作用。可读的代码有质量，而混乱的代码则不足。

查看其他人的代码是学习基础知识的艰难方法。在网上找到一个[教程](http://www.cplusplus.com/doc/tutorial/)，然后把你的脚弄湿。我相信还有很多关于这个主题的精美[印刷书籍。](https://stackoverflow.com/questions/388242/the-definitive-c-book-guide-and-list)

当你走的时候，如果遇到卡住、困惑或迷路，请[在此处](https://stackoverflow.com/)发布问题。

* * *

## 回答 #10

> 赞同：-1
> 
> 时间：2015-07-29T22:04:31.097

[代码项目](http://www.codeproject.com)是源代码的最佳场所。

# c++ - 如何检查 Boost.Asio 中的套接字是否已关闭？

> ID：818665
> 
> 赞同：9
> 
> 时间：2009-05-04T03:05:53.947
> 
> 标签：c++, boost, sockets, boost-asio

检查连接的远程端是否关闭了套接字的最简单方法是什么？`socket::is_open()`即使它在远程端关闭（我正在使用`boost::asio::ip::tcp::socket`）也返回 true。

我可以尝试从流中读取并查看它是否成功，但我必须更改程序的逻辑以使其以这种方式工作（我不希望在检查时从流中提取数据）。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-09-18T23:09:43.010

只需检查处理程序中的`boost::asio::error::eof`错误`async_receive`。这意味着连接已关闭。这是做到这一点的唯一正确方法。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-05-04T13:26:21.117

是否有可用的增强窥视功能？大多数套接字实现都有一种读取数据的方法，而无需将其从队列中删除，因此您可以稍后再次读取它。这似乎可以满足您的要求。

在快速浏览了 asio 文档后，我无法准确找到我所期望的，但这并不意味着它不存在。

我建议初学者[这样](http://www.boost.org/doc/libs/1_39_0/doc/html/boost_asio/reference/socket_base/message_peek.html)做。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2009-05-04T10:01:13.153

如果连接已被对等方彻底关闭，您应该在阅读时获得 EOF。否则，我通常会 ping 以确定连接是否真的存在。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-05-09T23:06:10.093

我认为一般来说，一旦你打开一个套接字，你应该立即开始阅读它，并且永远不要停止这样做。通过这种方式，您可以使您的服务器或客户端同时支持同步和异步协议。客户端关闭连接的那一刻，读取将告诉您这一点。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-24T12:03:04.387

使用 error_code 可以检查客户端是否连接的条件。如果连接成功，error_code error.value() 将返回 0，否则返回其他值。您还可以检查 error_code 中的 message()。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2020-04-01T18:27:38.887

```
boost::asio::socket_base::keep_alive keepAlive(true);
peerSocket->set_option(keepAlive); 
```

为对等套接字启用保持活动。使用本机套接字来调整保活间隔，以便在连接关闭后，async_receive 处理程序将在读取时获得 EOF。

[使用 boost::asio 配置 TCP keep_alive](https://stackoverflow.com/questions/20188718/configuring-tcp-keep-alive-with-boostasio][1])

# .net - 到 ASP.NET MVC 或 RESTful 或 WCF REST 服务

> ID：818666
> 
> 赞同：2
> 
> 时间：2009-05-04T03:06:27.127
> 
> 标签：.net, web-services

我的客户根据他们的会员资格提供了与消费者在杂货店购物习惯相关的各种数据。

他们的一个供应商希望利用这些数据并为公司建立一个内部网站。我的客户愿意提供的只是某种形式的 Web 服务，以便供应商可以根据需要使用数据并使用该数据构建他们的 Intranet 站点。

提供此数据的推荐方法是什么？2.0 网络服务或某种 .NET REST 服务或 WCF 服务？

数据存储在sql中。

搜索的一个示例，假设搜索可能是获取消费者在特定日期之间购买糖和购买馅饼皮的数据，这可能导致需要发送回供应商以供其消费的 0..n 条记录。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-04T12:29:37.600

尽管 WCF 是一种启动 rest 服务的简单方法，特别是如果您使用 .net 客户端使用它，但我更喜欢使用 ASP MVC 滚动我自己的服务。

它使您可以更精细地控制资源。您可以查看 HTTP 标头以获取身份验证信息、内容类型等，或根据操作结果返回自定义 HTTP 状态代码。您将不受 WCF 约定的约束。在使用服务时，您将不得不做更多的手动工作，但我觉得最终结果是值得的。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-04T03:20:59.200

不确定具体要求是什么，但您也可以考虑查看 ADO.NET 数据服务：http: [//msdn.microsoft.com/en-us/data/bb931106.aspx](http://msdn.microsoft.com/en-us/data/bb931106.aspx)

该框架可以简化添加对关系数据的 RESTful 访问。并以 JSON、XML 等形式返回结果。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-04T03:21:16.360

我认为这实际上取决于您要以何种格式提供数据。如果您正在考虑使用 SOAP，那么 WCF 就是要走的路。如果您想提供 XML 或 JSON，那么您可以使用 WCF 或 MVC。如果两端都将是 .NET，那么 SOAP 解决方案可能就可以了。如果有可能必须从该服务支持其他平台，那么我会考虑使用 JSON 或 XML。在这一点上，我的偏好可能是 JSON/XML 和 MVC，因为 WCF 的设置对于简单的 Web 服务来说似乎是多余的。.NET 中的旧式 Web 服务正在逐步淘汰，取而代之的是 WCF，所以我可能不会走那条路。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-04T03:15:48.480

如果您不需要在其他应用程序中重用 Web 服务，我建议您使用 ASP.NET MVC。在 ASP.NET MVC 中以 JSON 格式序列化数据并使用 jQuery 使用它非常容易。

# objective-c - 如何测试异步方法？

> ID：818674
> 
> 赞同：17
> 
> 时间：2009-05-04T03:12:34.023
> 
> 标签：objective-c, cocoa, unit-testing

我有一个通过网络获取 XML 或 JSON 的对象。一旦这个获取完成，它会调用一个选择器，传入返回的数据。所以，例如，我会有类似的东西：

```
-(void)testResponseWas200
{
    [MyObject get:@"foo.xml" withTarget:self selector:@selector(dataFinishedLoading:)];  
} 
```

我尝试了在 Test 类中实现 dataFinishedLoading 并尝试在该方法内部进行测试的路线，但测试套件只是锁定了。这似乎是一个嘲笑的案例，但我想知道其他人是否遇到过这种情况以及他们是如何处理的。

仅供参考：我正在使用 gh-unit 进行测试，任何以 test* 为前缀的方法都会自动执行。

* * *

## 回答 #1

> 赞同：30
> 
> 时间：2012-06-24T17:13:45.690

想到的三种方式是：NSRunLoop、信号量和组。

## NSRunLoop

```
__block bool finished = false;

// For testing purposes we create this asynchronous task 
// that starts after 3 seconds and takes 1 second to execute.
dispatch_queue_t queue = dispatch_get_global_queue(DISPATCH_QUEUE_PRIORITY_LOW, 0UL);
dispatch_time_t threeSeconds = dispatch_time(DISPATCH_TIME_NOW, 3LL * NSEC_PER_SEC);
dispatch_after(threeSeconds, queue, ^{ 
    sleep(1); // replace this with your task
    finished = true; 
});

// loop until the flag is set from inside the task
while (!finished) {
    // spend 1 second processing events on each loop
    NSDate *oneSecond = [NSDate dateWithTimeIntervalSinceNow:1];
    [[NSRunLoop currentRunLoop] runMode:NSDefaultRunLoopMode beforeDate:oneSecond];
} 
```

NSRunLoop 是一个循环，它处理诸如网络端口、键盘或您插入的任何其他输入源之类的事件，并在处理这些事件后或在时间限制后返回。当没有要处理的事件时，运行循环使线程进入睡眠状态。所有 Cocoa 和 Core Foundation 应用程序都有一个运行循环。*您可以在 Apple 的线程编程指南：[Run Loops](https://developer.apple.com/library/mac/#documentation/Cocoa/Conceptual/Multithreading/RunLoopManagement/RunLoopManagement.html)*或 Mike Ash *[Friday Q&A 2010-01-01: NSRunLoop Internals](http://www.mikeash.com/pyblog/friday-qa-2010-01-01-nsrunloop-internals.html)*中阅读有关运行循环的更多信息。

在这个测试中，我只是使用 NSRunLoop 让线程休眠一秒钟。没有它，持续循环`while`将消耗 100% 的 CPU 内核。

如果块和布尔标志是在相同的词法范围内创建的（例如：都在一个方法内），那么标志需要[`__block`存储限定符](http://developer.apple.com/library/ios/#documentation/cocoa/Conceptual/Blocks/Articles/bxVariables.html#//apple_ref/doc/uid/TP40007502-CH6-SW6)是可变的。如果标志是一个全局变量，它就不需要它。

如果测试在设置标志之前崩溃，则线程将永远等待。添加时间限制以避免这种情况：

```
NSDate *timeout = [NSDate dateWithTimeIntervalSinceNow:2];
while (!finished && [timeout timeIntervalSinceNow]>0) {
    [[NSRunLoop currentRunLoop] runMode:NSDefaultRunLoopMode 
                             beforeDate:[NSDate dateWithTimeIntervalSinceNow:1]];
}
if (!finished) NSLog(@"test failed with timeout"); 
```

如果您使用此代码进行单元测试，插入超时的另一种方法是使用断言调度块：

```
// taken from https://github.com/JaviSoto/JSBarrierOperationQueue/blob/master/JSBarrierOperationQueueTests/JSBarrierOperationQueueTests.m#L118
dispatch_time_t timeout = dispatch_time(DISPATCH_TIME_NOW, 2LL * NSEC_PER_SEC);
dispatch_after(timeout, dispatch_get_main_queue(), ^(void){
    STAssertTrue(done, @"Should have finished by now");
}); 
```

## 信号

类似的想法，但是直到*信号量*改变或直到时间限制才休眠：

```
dispatch_semaphore_t semaphore = dispatch_semaphore_create(0);

// signal the semaphore after 3 seconds using a global queue
dispatch_queue_t queue = dispatch_get_global_queue(DISPATCH_QUEUE_PRIORITY_LOW, 0UL);
dispatch_after(dispatch_time(DISPATCH_TIME_NOW, 3LL*NSEC_PER_SEC), queue, ^{ 
    sleep(1);
    dispatch_semaphore_signal(semaphore);
});

// wait with a time limit of 5 seconds
dispatch_time_t timeout = dispatch_time(DISPATCH_TIME_NOW, 5LL*NSEC_PER_SEC);
if (dispatch_semaphore_wait(semaphore, timeout)==0) {
    NSLog(@"success, semaphore signaled in time");
} else {
    NSLog(@"failure, semaphore didn't signal in time");
}

dispatch_release(semaphore); 
```

相反，如果我们永远等待，`dispatch_semaphore_wait(semaphore, DISPATCH_TIME_FOREVER);`我们将被卡住，直到从任务中获得信号，该任务继续在后台队列中运行。

## 团体

现在想象你必须等待几个街区。您可以使用 int 作为标志，或创建以较大数字开头的信号量，或者您可以对块进行*分组*并等待分组完成。在这个例子中，我只用一个块来做后面的事情：

```
dispatch_group_t group = dispatch_group_create();
dispatch_queue_t queue = dispatch_get_global_queue(DISPATCH_QUEUE_PRIORITY_LOW, 0UL);

// dispatch work to the given group and queue
dispatch_group_async(group,queue,^{
    sleep(1); // replace this with your task
});

// wait two seconds for the group to finish
dispatch_time_t timeout = dispatch_time(DISPATCH_TIME_NOW, 2LL*NSEC_PER_SEC);
if (dispatch_group_wait(group, timeout)==0) {
    NSLog(@"success, dispatch group completed in time");
} else {
    NSLog(@"failure, dispatch group did not complete in time");
}

dispatch_release(group); 
```

如果出于某种原因（清理资源？）您想在组完成后运行一个块，请使用`dispatch_group_notify(group,queue, ^{/*...*/});`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-12-17T15:58:32.053

@jano 谢谢我从你的帖子中制作了这个小工具

在 PYTestsUtils.m 中

```
+ (void)waitForBOOL:(BOOL*)finished forSeconds:(int)seconds {
    NSDate *timeout = [NSDate dateWithTimeIntervalSinceNow:seconds];
    while (!*finished && [timeout timeIntervalSinceNow]>0) {
        [[NSRunLoop currentRunLoop] runMode:NSDefaultRunLoopMode
                                 beforeDate:[NSDate dateWithTimeIntervalSinceNow:1]];
    }
} 
```

在我的测试文件中

```
- (void)testSynchronizeTime
{
    __block BOOL finished = NO;
    [self.connection synchronizeTimeWithSuccessHandler:^(NSTimeInterval serverTime) {
        NSLog(@"ServerTime %f", serverTime);
        finished = YES;
    } errorHandler:^(NSError *error) {
        STFail(@"Cannot get ServerTime %@", error);
        finished = YES;
    }];

    [PYTestsUtils waitForBOOL:&finished forSeconds:10];
    if (! finished)
        STFail(@"Cannot get ServerTime within 10 seconds");

} 
```

### 变化

添加 PYTestsUtils.m

```
+ (void)execute:(PYTestExecutionBlock)block ifNotTrue:(BOOL*)finished afterSeconds:(int)seconds {
    [self waitForBOOL:finished forSeconds:seconds];
    if (! *finished) block();
} 
```

用法：

```
- (void)testSynchronizeTime
{
    __block BOOL finished = NO;
    [self.connection synchronizeTimeWithSuccessHandler:^(NSTimeInterval serverTime) {
        NSLog(@"ServerTime %f", serverTime);
        finished = YES;
    } errorHandler:^(NSError *error) {
        STFail(@"Cannot get ServerTime %@", error);
        finished = YES;
    }];

    [PYTestsUtils execute:^{
        STFail(@"Cannot get ServerTime within 10 seconds");
    } ifNotTrue:&finished afterSeconds:10];

} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-18T07:29:04.147

异步回调通常需要消息循环才能运行。在测试代​​码中调用回调后停止消息循环是一种常见的模式。否则循环只是在等待下一个任务，并且不会有。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-04T03:58:51.090

测试异步和多线程代码的最佳方法之一是使用事件日志记录。您的代码应该在有趣或有用的时间记录事件。通常一个事件本身就足以证明逻辑工作正常。有时事件将需要有效负载或其他元信息，以便它们可以配对或链接。

当运行时或操作系统支持高效且健壮的事件机制时，这是最有用的。这使您的产品能够以“零售”版本发布事件。在这种情况下，您的事件仅在您需要调试问题或运行单元测试以证明 Thins 正常工作时才启用。

在零售（生产）代码中包含事件使您可以在任何平台上进行测试和调试。与调试或“检查”代码相比，这是一个巨大的好处。

请注意，就像断言一样，要小心放置事件的位置 - 如果经常记录它们可能会很昂贵。但好消息是现代操作系统和一些应用程序框架支持事件机制，可以轻松支持数十万个事件。一些支持对选定事件进行堆栈跟踪。这可能非常强大，但通常需要符号在某个时间点可用 - 无论是在日志记录时，还是在目标系统上跟踪后处理时。

# android - 使用 ORDER BY 时出现数据类型不匹配错误

> ID：818677
> 
> 赞同：32
> 
> 时间：2009-05-04T03:15:37.510
> 
> 标签：android, sqlite

我有一个使用本地 sqlite 数据库的 android 应用程序。

```
private SQLiteDatabase mDb; 
```

当我运行此查询时，我会根据需要将光标放在 pid 等于 id 的行上：

```
mDb.query(true, PT_TABLE, new String[] {KEY_PID, KEY_TID}, 
    KEY_PID+" = "+id, null, null, null, null, null); 
```

当我运行以下查询时，旨在获得相同的结果集，按 pid 排序，我得到“ **android.database.sqlite.SQLiteException: datatype mismatch** ”

```
mDb.query(true, PT_TABLE, new String[] {KEY_PID, KEY_TID}, 
    KEY_PID+" = "+id, null, null, null, null, KEY_PID+" DESC"); 
```

有任何想法吗？

* * *

## 回答 #1

> 赞同：38
> 
> 时间：2009-05-04T04:44:30.683

看起来你只是有点混淆了。根据[`SQLiteDatabase.query`](http://developer.android.com/reference/android/database/sqlite/SQLiteDatabase.html#query(boolean,%20java.lang.String,%20java.lang.String[],%20java.lang.String,%20java.lang.String[],%20java.lang.String,%20java.lang.String,%20java.lang.String,%20java.lang.String))文档，最后一个参数是`LIMIT`子句。倒数第二个是`ORDER BY`子句。

```
Cursor query (boolean distinct, 
            String table, 
            String[] columns, 
            String selection, 
            String[] selectionArgs, 
            String groupBy, 
            String having, 
            String orderBy, // <-- ORDER BY
            String limit) 
```

**编辑**

但是，还有另一个[`SQLiteDatabase.query`](https://developer.android.com/reference/android/database/sqlite/SQLiteDatabase.html#query(java.lang.String,%20java.lang.String[],%20java.lang.String,%20java.lang.String[],%20java.lang.String,%20java.lang.String,%20java.lang.String))地方`ORDER BY`是最后的

```
Cursor query (String table, 
            String[] columns, 
            String selection, 
            String[] selectionArgs, 
            String groupBy, 
            String having, 
            String orderBy) 
```

* * *

## 回答 #2

> 赞同：24
> 
> 时间：2013-01-16T09:14:14.277

这对我有用

```
String filter = MySQLiteHelper.JOB_ID + "=" + Integer.toString(jobID);
String orderBy =  MySQLiteHelper.LOG_TIME + " DESC";
Cursor cursor = database.query(MySQLiteHelper.LOG_TABLE_NAME, logTableColumns,
        filter, null, null, null, orderBy); 
```

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2010-09-13T11:08:01.437

```
KEY_PID + " = " + "'" + id + "'" 
```

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2015-10-24T09:12:24.620

由于 Orderby 是查询中的倒数第二个参数；您的查询将是这样的

```
mDb.query(true, PT_TABLE, new String[] {KEY_PID, KEY_TID}, 
    KEY_PID+" = "+id, null, null, null, KEY_PID+" DESC", null); 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2017-01-17T16:27:36.087

如果我正确理解了你的问题，试试这个。

```
 String[] columns = new String[] {KEY_PID, KEY_TID};
    String where = KEY_PID + " = " + Integer.toString(id);
    String orderBy = KEY_PID + " DESC";

    Cursor cursor = mDb.query(PT_TABLE, columns, where, null, null, null, orderBy); 
```

# php - 我的 PHP 应用程序需要导出为一系列不同的 XML 格式：我应该使用 XSLT 还是原生 PHP？

> ID：818679
> 
> 赞同：2
> 
> 时间：2009-05-04T03:16:22.067
> 
> 标签：php, xml, xslt, data-formats

我的 PHP 应用程序需要能够导出（和导入）一系列不同的数据格式，主要是基于 XML 的。

我可以选择

*   在 PHP 中，使用 DOM 导出到某种基于 XML 的格式，该格式是其他人所需的所有数据的超集，并为我想要支持的每种输出格式创建一个单独的 XSLT 样式表，通过 PHP 的 XSL 扩展运行 DOM 输出。

或者

*   不使用 PHP 的 XSL 扩展，而是将每个输出格式实现为原生 PHP 中的一个类，该类使用 DOM 直接从内部对象/结构转换为给定的 XML 格式，每个这样的类都实现相同的接口，因此它们是可互换的。

该应用程序将被大学使用，它是一种以各种方式管理“人员”记录的工具，以及从各种来源（如他们的人力资源系统等）进行导入/导出的工具。我将自己实现一组输入和输出格式，但是将来，使用它的人可能会想要修改它以支持他们自己的格式。

我考虑不使用 XSLT 的一个原因是，如果将来除了我之外还有其他人要维护该应用程序，那么似乎很少有人知道 XSLT——似乎有更多人知道 PHP。

另一个是第二个似乎是一个更有效和“程序化”的解决方案，并且在某种意义上更灵活，因为我可以通过重载像 CSV 或基于列的文本一样轻松地输出和导入非 XML 格式类的必要部分，而不是经常需要的部分。

第三个但非常小且无关紧要的原因是 PHP 需要重新编译才能启用 XSL，而 DOM 默认情况下是启用的，因此它的可移植性会更高一些。然而，这并不是什么大问题，因为它很容易重新配置 PHP。

你觉得我的推理怎么样？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-04T07:08:18.513

我个人的意见是，您的决定应该强烈地基于您如何判断目标受众的 XSLT 知识这一事实。如果很明显 XSLT 在必须使用该系统的人（包括您自己）中以某种方式是“未知领域”，那么您可以排除 XSLT 解决方案。学习 XSLT 的需要和努力将抵消您将从 XSLT 解决方案中获得的优势（非常优雅 - 尤其是在将 XML 转换为 XML 时，不需要弄乱 PHP 代码，不需要 PHP 知识）。

也许双向解决方案可能是正确的选择。您可以构建一个用于导入和导出的适配器系统，该系统将 XSLT 用于 XML 数据格式，并提供对所有不基于 XML 的数据格式使用 PHP 代码的能力。这样每个开发人员都可以选择他更喜欢的方式。

```
interface My_DataConverter_Interface
{
    /**
          * @param string                $file
          * @return My_DataObject
          */
    function import($file);

    /**
          * @param My_DataObject $data
          * @param string                $file
          */
    function export(My_DataObject $data, $file);
}

abstract class My_DataConverter_Xslt implements My_DataConverter_Interface
{ /* ... */ }

class My_DataConverter_XmlFormat1 extends My_DataConverter_Xslt
{ /* ... */ }

class My_DataConverter_XmlFormat2 extends My_DataConverter_Xslt
{ /* ... */ }

class My_DataConverter_Csv implements My_DataConverter_Interface
{ /* ... */ } 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-04T03:34:49.773

我认为你的推理是合理的，这也是我会走的路。

基本上你在谈论的是桥接/适配器/外观类。它们（恕我直言）比 XSL 模板更灵活、更容易理解。

第三个原因并不是真正的原因，因为 XSL 支持只涉及取消注释 PHP 扩展。

我也很高兴看到您希望通过 DOM 扩展（或等效库）来执行此操作，而不是将 XML 编写为文本，这会引入所有转义问题以及诸如此类的东西，您将避免使用自己的方式。

就我个人而言，我还认为 XSL 模板更容易更改（因为它们对绝大多数程序员来说有点神秘）所以如果你的超集格式发生变化（让我们面对现实，它会改变）你可能需要更改所有模板。当然，您可能也必须使用代码来执行此操作，但代码可能更易于维护。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-04T03:51:24.400

有趣的问题。

两种解决方案都可以，但我想你知道这一点。

我可能会自己使用编码解决方案。但这可能与让我头疼的 XSLT 有关。

XSLT 有一个好处，那就是您可以要求他们由为您提供未更改 XML 的人生成。

如果你总是要生产它们，那么它可能并不重要，编码解决方案在大多数情况下会更容易维护。

# c# - 在同一进程中的 AppDomain 之间发送大字节数组

> ID：818681
> 
> 赞同：9
> 
> 时间：2009-05-04T03:19:18.050
> 
> 标签：c#, .net, windows, networking, remoting

我正在构建一个网络服务器并在请求路由到的服务器上启动许多 AppDomain。将请求有效负载发送到其中一个 AppDomain 进行处理的最快方法是什么？

1.  将来自套接字的有效负载读入字节数组并编组。
2.  将网络流（从 MarshalByRef 继承）编组到 AppDomain。
3.  读取有效载荷。将其解码为对象。编组解码的对象。
4.  使用命名管道传输字节数组。
5.  使用环回套接字。
6.  也许有一种方法来编组实际的套接字连接？

解码主要创建不可变对象，用于确定如何满足客户端请求，然后 AppDomain 创建响应并将其编组回主机 AppDomain，主机 AppDomain 通过套接字将其发送回。

该方法应该更喜欢更少的内存而不是更少的 CPU。

WCF 不是一个选项。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-04T04:49:38.580

非常好的问题。如果我遇到这个问题，我可能会使用缓冲流/内存流并将流编组到消耗对象的 AppDomain 中，以减少在不同 AppDomain 中创建的许多对象图的编组或序列化。

但话又说回来，听起来你几乎完全复制了 IIS 的功能，所以我会查看/反射到 System.Web.Hosting 命名空间，看看他们如何处理它以及他们的 WorkerThreadPool 等......

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-04T03:38:04.010

TCP 二进制远程处理当然很快，我不知道它比原始套接字快多少，这可能是最快的，但是一个皇家 PIA。

我在生产中使用两个盒子之间的 HTTP 二进制远程处理每秒运行 1500 - 2000 个请求。在同一个机器上，您应该使用 TCP 或名称管道通道获得更高的性能，具体取决于处理数据所需的 CPU 周期。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-04T03:49:01.970

如果我是你，我会看看[Cassini](http://www.asp.net/Downloads/archived/cassini/)是如何实现的。它几乎完全按照您所说的做。

实际上，Cassini 已经被 Webhost 所取代，Webhost 是现在与 Visual Studio 一起提供的内置网络服务器。查看Phil Haack 博客上的这篇文章了解更多信息[。](http://haacked.com/archive/2006/12/12/Using_WebServer.WebDev_For_Unit_Tests.aspx)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-12T14:37:52.620

> 6 .也许有办法编组实际的套接字连接？

6-th 是 IMO 的最佳选择。从进程的角度来看，套接字只是一个句柄。AppDomain 驻留在单个进程中。这意味着 appdomains 可以交换套接字句柄。

如果套接字编组不起作用，您可以尝试在其他应用程序域中重新创建套接字。您可以使用[DuplicateAndClose](http://msdn.microsoft.com/en-us/library/system.net.sockets.socket.duplicateandclose.aspx)来执行此操作。

如果这不起作用，您应该进行一些性能测试以选择最佳的数据传输方法。（我会选择命名管道或内存映射文件）

# ruby-on-rails - 从 Rails 调用应用程序

> ID：818686
> 
> 赞同：1
> 
> 时间：2009-05-04T03:21:59.167
> 
> 标签：ruby-on-rails, cobol

我有一个使用 COBOL-CGI 的现有网站/应用程序，其中 COBOL 应用程序通过使用占位符填充数据来创建 html 页面。

我现在想创建一个 Rails 站点，除了使用自己的数据库外，还应该调用外部应用程序来检索各种信息。

仍然可以使用 cgi 调用此应用程序吗？有没有更好的方法从 Rails 调用 3rd 方应用程序？活动X？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-04T03:29:59.647

你可能想要做一些不同的事情。您可以让 Rails 应用程序调用 COBOL CGI，但当前的应用程序正在创建 HTML，您需要从其中抓取数据。

也许您最好修改 COBOL 以生成一些更简单的表示形式，包括一个 CSV 文件，尽管 YAML 或 JSON 可能更容易使用。然后，您可以调用 COBOL 应用程序，并捕获其输出以供 rails 应用程序使用。

# c# - 为什么 vs2008 express 给我看另一个 dll 项目的源代码？

> ID：818687
> 
> 赞同：1
> 
> 时间：2009-05-04T03:22:28.680
> 
> 标签：c#, dll, visual-studio-express, source-code-protection

我对 .net 完全陌生，尤其是使用 c# 3.0，我正在开发一个访问数据库包装应用程序，因为我们需要保护数据库的密码和内容不被第三方开发人员直接访问。

我目前正在测试编写一个简单的客户端应用程序来触发 dll 中的函数，令我惊讶的是，每次我遇到错误时，我都可以看到这个项目中的所有源代码，其中显示了确切的源代码。

所以我知道我可能在这里遗漏了很多明显的东西，但是我如何对其进行编码以使这种情况不会发生，所以我们可以向第三方开发人员隐藏 dll 中的代码？或者这是因为两个项目都在我的电脑中才发生的设置？

谢谢 ：）

## 更新：

经过一番浏览后，我发现了这个[关于良好混淆工具的先前讨论](https://stackoverflow.com/questions/2525/best-net-obfuscation-tools-strategy) ，[我尝试了一个名为 Eazfuscator.Net 的工具](http://www.gapotchenko.com/eazfuscator.net)，在混淆了 dll 之后，我尝试使用 .net 反射器再次查看它或通过 vs express2008 调试它，没有显示没有更多的 ：）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-04T03:30:01.657

您看到的是确切的代码，因为源代码在您的机器上，但是，第三方开发人员使用[Reflector](http://www.red-gate.com/products/reflector/)等工具从 DLL 逆向工程代码将是微不足道的。为防止出现此类情况，您可能需要使用[代码混淆](http://en.wikipedia.org/wiki/Obfuscated_code)实用程序，例如[Dotfuscator](http://msdn.microsoft.com/en-us/library/ms227240.aspx)（您可能需要付费版本而不是社区版本），以使从中间代码重构代码变得更加困难。

# python - Python：用prefixStringSuffix替换字符串保持原始大小写，但在搜索匹配时忽略大小写

> ID：818691
> 
> 赞同：2
> 
> 时间：2009-05-04T03:26:39.247
> 
> 标签：python, regex, search, replace, nltk

所以我想要做的是用 `"<b>keyword</b>"` 一个更大的字符串替换一个字符串“关键字”。

例子：

myString = "你好。你应该提高那个人的职位。你好，你好。"

关键字=“嗨”

我想要的结果是：

`result = "<b>HI</b> there. You should higher that person for the job.` `<b>Hi</b> <b>hi</b>."`

在用户键入关键字之前，我不会知道关键字是什么，并且在运行查询之前不会知道语料库（myString）。

我找到了一个大部分时间都有效的解决方案，但有一些误报， `namely it would return "<b>hi<b/>gher"`这不是我想要的。另请注意，我试图保留原始文本的大小写，并且无论大小写如何都应该进行匹配。所以如果关键字是“hi”它应该替换 `HI with <b>HI</b> and hi with <b>hi</b>.`

我最接近的是使用这个稍微派生的版本： [http](http://code.activestate.com/recipes/576715/) ://code.activestate.com/recipes/576715/ 但我仍然无法弄清楚如何对字符串进行第二次传递以修复所有错误上面提到的积极因素。

或者使用 NLTK 的 WordPunctTokenizer（它简化了标点符号之类的一些事情），但我不确定如何将句子重新组合在一起，因为它没有反向功能并且我想保留 myString 的原始标点符号。本质上，连接所有标记不会返回原始字符串。例如，如果原始文本具有“7-7”，则在将标记重新组合为其原始文本时，我不想将“7-7”替换为“7-7”。

希望这已经足够清楚了。似乎是一个简单的问题，但结果却比我想象的要困难一些。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-04T04:01:01.613

这行吗？

```
>>> import re
>>> myString = "HI there. You should higher that person for the job. Hi hi."
>>> keyword = "hi"
>>> search = re.compile(r'\b(%s)\b' % keyword, re.I)
>>> search.sub('<b>\\1</b>', myString)
'<b>HI</b> there. You should higher that person for the job. <b>Hi</b> <b>hi</b>.' 
```

整个事情的关键是使用[单词边界](http://docs.python.org/library/re.html)、[组](http://docs.python.org/library/re.html#regular-expression-syntax)和[re.I 标志](http://docs.python.org/library/re.html#re.I)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-04T04:01:59.257

您应该能够`re.sub`使用单词边界断言非常轻松地做到这一点`\b`，它只匹配单词边界：

```
import re

def SurroundWith(text, keyword, before, after):
  regex = re.compile(r'\b%s\b' % keyword, re.IGNORECASE)
  return regex.sub(r'%s\0%s' % (before, after), text) 
```

然后你得到：

```
>>> SurroundWith('HI there. You should hire that person for the job. '
...              'Hi hi.', 'hi', '<b>', '</b>')
'<b>HI</b> there. You should hire that person for the job. <b>Hi</b> <b>hi</b>.' 
```

如果您对构成“单词边界”的内容有更复杂的标准，则必须执行以下操作：

```
def SurroundWith2(text, keyword, before, after):
  regex = re.compile(r'([^a-zA-Z0-9])(%s)([^a-zA-Z0-9])' % keyword,
                     re.IGNORECASE)
  return regex.sub(r'\1%s\2%s\3' % (before, after), text) 
```

您可以修改`[^a-zA-Z0-9]`组以匹配您认为“非单词”的任何内容。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-04T04:06:50.260

我认为最好的解决方案是正则表达式......

```
import re
def reg(keyword, myString) :
   regx = re.compile(r'\b(' + keyword + r')\b', re.IGNORECASE)
   return regx.sub(r'<b>\1</b>', myString) 
```

当然，您必须首先使您的关键字“正则表达式安全”（引用任何正则表达式特殊字符）。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2009-07-20T19:08:31.517

这是来自挑剔委员会的一个建议。:-)

```
myString = "HI there. You should higher that person for the job. Hi hi."

myString.replace('higher','hire') 
```

# list - MIPS：确定测试分数列表是否通过/失败

> ID：818697
> 
> 赞同：1
> 
> 时间：2009-05-04T03:30:38.723
> 
> 标签：list, math, mips

我正在编写一个 MiPS 程序，它将检查 15 个测试分数的列表。它将从终端输入。嗯，通过标准是50分。终端的输出将包括每个类别的分数以及通过和失败的学生人数。带有输入提示和输出语句...下面是我编写的程序，但它没有工作..请我需要..我不知道我是否做错了..

```
.globl main
.text 
```

main: li $t0, 0 #通过分数计数器 la $t1, pass #pointer for pass 数组
li $t2, 0 #counter 分数不及格 la $t3, fail #pointer for pass array li $t4, 0 #overall counter li $t5, 0 li $t6, 0

loop: li $v0, 4 #system call for print string la $a0, prompt #load string syscall

```
li $v0, 5           #system call for read integer
syscall             #read integer

bltu $v0, 50, else      #if $v0 < 50 branch to else (failing grade)
sw $v0, 0($t1)          #store word in pass array
addi $t1, $t1, 4        #t1 = t1 + 4 (increment pass pointer)
addi $t0, $t0, 1        #t0 = t0 + 1 (increment pass counter)
b l_end             #branch over else statement 
```

else: sw $v0, 0($t3) #store word in fail array addi $t3, $t3, 4 #t3 = t3 + 4 (递增失败指针) addi $t2, $t2, 1 #t1 = t1 + 1 （递增失败计数器）

l_end: addi $t4, $t4, 1 #增量总计数器 bltu $t4, 15, loop #if t4 <= 15 分支到循环

# 输出计数

```
li $v0, 4           #system call for print string
la $a0, o_pasc          #load string
syscall             #output "Number of Passing Scores:

la $v0, 1           #system call for print integer
add $a0, $t0, 0         #load value of pass counter into $a0
syscall             #output value

li $v0, 4           #system call for print string
la $a0, o_fasc          #load string
syscall             #output "Number of Failing Scores: "

la $v0, 1           #system call for print string
add $a0, $t2, 0         #load value of fail counter into $a0
syscall             #output value 
```

# 输出及格分数

```
li $v0, 4           #setup output   
la $a0, o_pass          #setup text
syscall             #output string o_pass

la $t1, pass            #load address of pass pointer to t1
lw $a0, 0($t1)          #load word at $t1 into $a0
li $v0, 1           #system call for print integer 
```

loop_a: bleu $t0, $t5, lp_a_end #if t0 <= t5 branch to lp_a_end syscall #output single score

```
li $v0, 4           #system call for print string
la $a0, o_coma          #load string
syscall             #ouput comma and space

li $v0, 1           #setup output
addi $t1, $t1, 4        #move pointer down by 1 word
lw $a0, 0($t1)          #move word at pointer into $a0
addi $t5, $t5, 1        #add 1 to counter

b loop_a            #branch to top 
```

lp_a_end：

# 输出失败分数

```
la $t5, 0           #clear t5 (counter)
li $v0, 4           #setup output
la $a0, o_fail          #setup text
syscall             #output string o_fail

la $t3, fail            #load address for fail pointer into $t3
lw $a0, 0($t3)          #load word at mem addy $t3 into $a0
li $v0, 1           #system call for print integer 
```

loop_b: bleu $t2, $t5, lp_b_end #if t2 <= t5 branch to lp_a_end syscall #output single score

```
li $v0, 4           #system call for print string
la $a0, o_coma          #load string
syscall             #output comma and space

li $v0, 1           #setup output
addi $t3, $t3, 4        #move pointer down by 1 word
lw $a0, 0($t3)          #load word from mem addy $t3 to $a0
addi $t5, $t5, 1        #add 1 to counter

b loop_b            #branch to top 
```

lp_b_end：

# 结尾

```
li $v0, 4           #setup output
la $a0, o_brk           #setup text
syscall             #output line break

li $v0, 10          #loads 10 to $v0
syscall             #ends program 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-04T03:41:58.587

“似曾相识通常是《黑客帝国》中的一个小故障”

很确定我已经看到了这个：

[MIPS 程序确定测试成绩的通过/失败](https://stackoverflow.com/questions/804315/mips-program-need-help)

**编辑**：一些建议：尝试简化事情。一点一点地构建你的程序。例如，尽量避免系统调用，使用硬编码输入来测试您的比较逻辑。然后，进行系统调用。您是否正确使用数组？我已经看到您保留了两个单独的计数器来索引数组，并保持其中元素的计数。我认为这很容易出错。也许您应该使用计数器来索引数组（将其乘以 4）。点击链接，如果出现任何具体疑问，我将很乐意提供帮助。

我不太喜欢 SPIM 模拟器。我知道许多大学将它用于他们的课程，但我认为这是一个错误，因为它是一个非常有限的环境。

**另一个编辑（通过“流行”需求）**：我已经阅读了你的代码一段时间，我注意到了一些事情。

*   您将值加载到寄存器中以与零进行比较。不要这样做，使用 $zero 寄存器。

    李$t5,0

    李$t6.0

用于

```
bleu $t0,$t5,lp_a_end       #if t0 <= t5 branch to lp_a_end 
```

应该

```
bleu $t0,$zero,lp_a_end 
```

*   指令的使用

    bltu $v0, 50, else #if $v0 < 50 分支到 else（不及格）

分支指令采用两个寄存器和一个标签。不注册，中介，标签

应该：

```
 li   $t5,50
   bltu $v0,$t5,else 
```

我的猜测是，您徒劳地使用系统调用使自己复杂化。当你不能让它工作时，你为什么喜欢你的输出？除此之外，一旦您开始准备系统调用，就执行它。不要在中间放置分支指令，例如

```
 la $t3, fail                    #load address for fail pointer into $t3
        lw $a0, 0($t3)                  #load word at mem addy $t3 into $a0
        li $v0, 1        
loop_b: bleu $t2, $t5, lp_b_end         #if t2 <= t5 branch to lp_a_end 
        syscall                         #output single score 
```

这很令人困惑。也许您应该尝试以下方法：

```
#Is there anything to print in the array? If not, goto lp_b_end
bleu $t2,$zero,lp_b_end

#Ok, we know we are not pointing at an invalid position of the array.       
la $t3, fail                    #load address for fail pointer into $t3
lw $a0, 0($t3)                  #load word at mem addy $t3 into $a0
li $v0, 1 
syscall 
```

最后，在使用系统调用时尽量保持约定。例如，仅将寄存器 $a0 和 $v0 用于系统调用。不要将它们用于其他任何事情。如果您将一个整数读入 $v0，则在执行其他任何操作之前将其移至 $t0。

这就是我现在能想到的。正如有人在欺骗帖子（Rob Kennedy）中所说，也请尝试询问您的教练，这就是他获得报酬的原因（我不是您的教练，只是帮手）。

# php - 来自一个 AJAX 请求的多个响应

> ID：818700
> 
> 赞同：7
> 
> 时间：2009-05-04T03:31:39.017
> 
> 标签：php, javascript, ajax, json

不是真的在这里寻找代码示例，只是概念。

我现在在一个页面上有三个部分，这些部分正在通过对 PHP 脚本的三个单独的 AJAX 调用进行更新，这些调用返回 JSON。将这三个调用压缩为一个更大的调用并以 JSON 格式在客户端接收响应的最简单方法是什么？我将如何分离客户端上的响应，以便我可以根据发回的信息来操纵响应数据？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-04T04:19:42.303

我喜欢 Cris 的方法，但认为我可以提供一点改进。由于您已经有 3 个单独的实体，为了减少重新编码所有内容的需要，您可以通过将 PHP 组合到一个文件中`include 'page.php'`并通过 JSON 发送回一个对象，该对象具有为每个实体命名的属性（假设“名称”、“日期”和“fuzzyThings”）。然后，您发送请求的客户端代码将简单地将您的 3 个函数单独发送的所有参数在一个请求中发送。返回的 JSON 将看起来像这样（将您的对象/数组/任何内容放在注释区域中）：

```
{
    "names" : {/*stuff needed for names goes in here*/},
    "dates" : {/*stuff needed for dates goes in here*/},
    "fuzzyThings" : {/*all fuzzy things goes in here*/}
} 
```

一旦你把它送到客户端，我假设每个可能已经有一个函数（或一组函数）来处理它的返回数据，你应该能够以这种方式调用它们：

```
function handler(retText) {
    var returnedObject = eval(retText);

    doStuffWithNames(returnedObject.names);
    doStuffWithDates(returnedObject.dates);
    playWithFuzzyThings(returnedObject.fuzzyThings);
} 
```

此外，在 PHP 端，您可以通过以下方式制作统一的 PHP 页面（希望无需重新编码）：

```
<?php
    echo '{';
        echo '"names":{';
        include 'names.php';
        echo '},';

        echo '"dates":{';
        include 'dates.php';
        echo '},';

        echo '"fuzzyThings":{';
        include 'fuzzyThings.php';
        echo '}';
    echo '}';
?> 
```

**注意：**您可能需要编辑 3 个 php 页面，以便它们正确检查 $_POST 并且不会干扰其他页面的功能（如果您还没有），我更喜欢`if(isset($_POST['whatever'])) { ... }`检查所有内容是否正确发送的方法，这个方式，您可以包含任意数量的内容，如果与 php 文件无关（即您没有使用该页面上的该部分），那么它将返回一个空白属性，您根本不会使用它（基本上使它成为一种“一刀切”的东西）。

希望它对你有用！

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-04T03:56:51.953

您可以像这样格式化 JSON：

```
"user" : [ {
    "name" : "Harry",
    "hobby" : "Skating"
}, {
    "name" : "Dave",
    "hobby" : "Scuba Diving"
} ],
"news" : [ {
    "date" : "3/13/05",
    "title" : "Blah",
    "postedby" : "Mike",
} ] 
```

现在在您的 AJAX 响应中：

```
var data = eval('('+ xhr.responseText +')'); // Ajax response
var user = data.user[0].name; // Harry
var user2 = data.user[1].name; // Dave
var title = data.news[0].title; 
```

您可以使用 for 循环来遍历数据。在上面的示例中，您现在应该看到如何使用 PHP 来格式化具有多个类别（用户、新闻等）的 JSON，并且只需一次调用即可返回所有内容。如果您想要更详细的示例，请参阅[这篇](http://www.hunlock.com/blogs/Mastering_JSON_(_JavaScript_Object_Notation_))文章以及 [这篇](http://www.devarticles.com/c/a/JavaScript/AJAX-with-JSON/1/)文章。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-04T03:56:59.550

我认为您必须根据页面上的这 3 个部分制作 JSON 格式，对它们进行标识，以便在响应后您可以将它们填充到这些部分。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-04T06:23:40.790

我个人喜欢 json 方法，但如果您是 json 新手，或者由于任何原因不喜欢使用它，那么有一个专门为此目的设计的 jQuery 插件，称为[jQuery Taconite Plugin](http://www.malsup.com/jquery/taconite/)

在 Rails 社区中，有第三种方式称为 RJS，它现在不那么热门，感觉有点过时，但仍然有自己的粉丝。我很好奇是否有人将 RJS 移植到 PHP？

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-05-17T13:26:00.900

这对我来说是工作
php 代码：

```
//for test
$categoryName = "category";
$idcategory = "1";

 $json = "{'productcategory':[{'categoryname':'".$categoryName."','idcategory':'".$idcategory."'}]}";           
 echo $json; 
```

javascript:

```
var str = xmlhttp.responseText.trim();
var json = JSON.stringify(eval("(" + str + ")"));
var obj = JSON.parse(json);
alert(obj.productcategory[0].idcategory);
alert(obj.productcategory[0].categoryname); 
```

# java - 任何可用于将消息从 COBOL 发送到 Java 的开源消息队列？

> ID：818702
> 
> 赞同：3
> 
> 时间：2009-05-04T03:34:54.517
> 
> 标签：java, queue, messaging, cobol, mainframe

我有一个 Java 堆栈（Tomcat 等），我需要将消息从运行 COBOL 的大型机发送到 Java 端。任何可用的开源队列都可以做到这一点吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-04T03:58:01.060

当然，[Java Messaging](http://java.sun.com/products/jms/)与 IBM 互操作。在 IBM 方面，您需要能够与 MQSeries 对话。尝试从这个[DeveloperWorks](http://www.ibm.com/developerworks/websphere/zones/businessintegration/wmq.html)站点开始。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-04T04:38:16.953

[Websphere MQ](http://www-01.ibm.com/software/integration/wmq/)将是执行此操作的最佳（即最受支持的）方法。有大量不同系统的客户端，它运行在所有大型机操作系统上。它不是开源的，但我相信仍然可以免费获得客户端库。

# c# - 如何将 SecureString 转换为 System.String？

> ID：818704
> 
> 赞同：181
> 
> 时间：2009-05-04T03:36:24.980
> 
> 标签：c#, .net, security, encryption

所有关于通过创建一个 System.String 来取消 SecureString 的**保留**，怎么做？

如何将普通的 System.Security.SecureString 转换为 System.String？

我敢肯定，熟悉 SecureString 的许多人都会回应说，永远不应该将 SecureString 转换为普通的 .NET 字符串，因为它会删除所有安全保护。 **我知道**。但是现在我的程序无论如何都用普通字符串做所有事情，我正在努力增强它的安全性，虽然我将使用一个向我返回 SecureString 的 API，但我*并不*想用它来提高我的安全性。

我知道 Marshal.SecureStringToBSTR，但我不知道如何获取该 BSTR 并从中制作 System.String。

对于那些可能想知道我为什么要这样做的人，好吧，我从用户那里获取密码并将其作为 html 表单 POST 提交以将用户登录到网站。所以......这确实必须使用托管的未加密缓冲区来完成。如果我什至可以访问未管理的、未加密的缓冲区，我想我可以在网络流上逐字节地进行流写入，并希望整个过程都能保证密码的安全。我希望至少能找到其中一种情况的答案。

* * *

## 回答 #1

> 赞同：211
> 
> 时间：2009-05-04T11:21:15.097

使用[`System.Runtime.InteropServices.Marshal`](http://msdn.microsoft.com/en-us/library/system.runtime.interopservices.marshal.aspx)类：

```
String SecureStringToString(SecureString value) {
  IntPtr valuePtr = IntPtr.Zero;
  try {
    valuePtr = Marshal.SecureStringToGlobalAllocUnicode(value);
    return Marshal.PtrToStringUni(valuePtr);
  } finally {
    Marshal.ZeroFreeGlobalAllocUnicode(valuePtr);
  }
} 
```

如果要避免创建托管字符串对象，可以使用以下方法访问原始数据[`Marshal.ReadInt16(IntPtr, Int32)`](https://msdn.microsoft.com/en-us/library/a0zbzkx2.aspx)：

```
void HandleSecureString(SecureString value) {
  IntPtr valuePtr = IntPtr.Zero;
  try {
    valuePtr = Marshal.SecureStringToGlobalAllocUnicode(value);
    for (int i=0; i < value.Length; i++) {
      short unicodeChar = Marshal.ReadInt16(valuePtr, i*2);
      // handle unicodeChar
    }
  } finally {
    Marshal.ZeroFreeGlobalAllocUnicode(valuePtr);
  }
} 
```

* * *

## 回答 #2

> 赞同：135
> 
> 时间：2014-09-09T18:53:15.507

显然你知道这如何破坏了 SecureString 的全部目的，但无论如何我都会重申它。

如果您想要单线，请尝试以下操作：（仅限 .NET 4 及更高版本）

```
string password = new System.Net.NetworkCredential(string.Empty, securePassword).Password; 
```

其中securePassword 是一个SecureString。

* * *

## 回答 #3

> 赞同：52
> 
> 时间：2009-05-04T03:38:33.977

当。 发布此消息后，我在本文深处找到*了*[答案](http://www.microsoft.com/indonesia/msdn/credmgmt.aspx)。但是，如果有人知道如何访问此方法公开的 IntPtr 非托管、未加密缓冲区，一次一个字节，这样我就不必从中创建托管字符串对象来保持高安全性，请添加答案。:)

```
static String SecureStringToString(SecureString value)
{
    IntPtr bstr = Marshal.SecureStringToBSTR(value);

    try
    {
        return Marshal.PtrToStringBSTR(bstr);
    }
    finally
    {
        Marshal.FreeBSTR(bstr);
    }
} 
```

* * *

## 回答 #4

> 赞同：18
> 
> 时间：2015-11-12T19:42:15.273

`SecureString`我认为依赖函数最好将它们的依赖逻辑*封装*在一个匿名函数中，以便更好地控制内存中的解密字符串（一旦固定）。

此代码段中用于解密 SecureStrings 的实现将：

1.  将字符串固定在内存中（这是您想要做的，但这里的大多数答案似乎都缺少）。
2.  [将其引用](https://stackoverflow.com/questions/10792603/how-are-strings-passed-in-net/10792823#10792823)传递给 Func/Action 委托。
3.  从内存中清除它并释放`finally`块中的 GC。

与依赖不太理想的替代方案相比，这显然使“标准化”和维护调用者变得容易得多：

*   `string DecryptSecureString(...)`从辅助函数返回解密的字符串。
*   在需要的地方复制此代码。

请注意，您有两个选择：

1.  `static T DecryptSecureString<T>`它允许您`Func`从调用者访问委托的结果（如`DecryptSecureStringWithFunc`测试方法中所示）。
2.  `static void DecryptSecureString`只是一个“无效”版本，`Action`在您实际上不想/不需要返回任何东西的情况下使用委托（如`DecryptSecureStringWithAction`测试方法中所示）。

两者的示例用法可以在包含的`StringsTest`类中找到。

**字符串.cs**

```
using System;
using System.Runtime.InteropServices;
using System.Security;

namespace SecurityUtils
{
    public partial class Strings
    {
        /// <summary>
        /// Passes decrypted password String pinned in memory to Func delegate scrubbed on return.
        /// </summary>
        /// <typeparam name="T">Generic type returned by Func delegate</typeparam>
        /// <param name="action">Func delegate which will receive the decrypted password pinned in memory as a String object</param>
        /// <returns>Result of Func delegate</returns>
        public static T DecryptSecureString<T>(SecureString secureString, Func<string, T> action)
        {
            var insecureStringPointer = IntPtr.Zero;
            var insecureString = String.Empty;
            var gcHandler = GCHandle.Alloc(insecureString, GCHandleType.Pinned);

            try
            {
                insecureStringPointer = Marshal.SecureStringToGlobalAllocUnicode(secureString);
                insecureString = Marshal.PtrToStringUni(insecureStringPointer);

                return action(insecureString);
            }
            finally
            {
                //clear memory immediately - don't wait for garbage collector
                fixed(char* ptr = insecureString )
                {
                    for(int i = 0; i < insecureString.Length; i++)
                    {
                        ptr[i] = '\0';
                    }
                }

                insecureString = null;

                gcHandler.Free();
                Marshal.ZeroFreeGlobalAllocUnicode(insecureStringPointer);
            }
        }

        /// <summary>
        /// Runs DecryptSecureString with support for Action to leverage void return type
        /// </summary>
        /// <param name="secureString"></param>
        /// <param name="action"></param>
        public static void DecryptSecureString(SecureString secureString, Action<string> action)
        {
            DecryptSecureString<int>(secureString, (s) =>
            {
                action(s);
                return 0;
            });
        }
    }
} 
```

**字符串测试.cs**

```
using Microsoft.VisualStudio.TestTools.UnitTesting;
using System.Security;

namespace SecurityUtils.Test
{
    [TestClass]
    public class StringsTest
    {
        [TestMethod]
        public void DecryptSecureStringWithFunc()
        {
            // Arrange
            var secureString = new SecureString();

            foreach (var c in "UserPassword123".ToCharArray())
                secureString.AppendChar(c);

            secureString.MakeReadOnly();

            // Act
            var result = Strings.DecryptSecureString<bool>(secureString, (password) =>
            {
                return password.Equals("UserPassword123");
            });

            // Assert
            Assert.IsTrue(result);
        }

        [TestMethod]
        public void DecryptSecureStringWithAction()
        {
            // Arrange
            var secureString = new SecureString();

            foreach (var c in "UserPassword123".ToCharArray())
                secureString.AppendChar(c);

            secureString.MakeReadOnly();

            // Act
            var result = false;

            Strings.DecryptSecureString(secureString, (password) =>
            {
                result = password.Equals("UserPassword123");
            });

            // Assert
            Assert.IsTrue(result);
        }
    }
} 
```

显然，这并不能防止以下列方式滥用此功能，因此请注意不要这样做：

```
[TestMethod]
public void DecryptSecureStringWithAction()
{
    // Arrange
    var secureString = new SecureString();

    foreach (var c in "UserPassword123".ToCharArray())
        secureString.AppendChar(c);

    secureString.MakeReadOnly();

    // Act
    string copyPassword = null;

    Strings.DecryptSecureString(secureString, (password) =>
    {
        copyPassword = password; // Please don't do this!
    });

    // Assert
    Assert.IsNull(copyPassword); // Fails
} 
```

快乐编码！

* * *

## 回答 #5

> 赞同：18
> 
> 时间：2016-06-24T14:51:36.740

在我看来，**扩展方法**是解决这个问题的最舒服的方法。

我将[史蒂夫在 CO 的](https://stackoverflow.com/users/3885063/steve-in-co) [优秀答案](https://stackoverflow.com/a/25751722/1016343)中放入如下扩展类，以及我添加的第二种方法以支持另一个方向（字符串 - > 安全字符串），因此您可以创建一个安全字符串并将其转换为之后是一个普通的字符串：

```
public static class Extensions
{
    // convert a secure string into a normal plain text string
    public static String ToPlainString(this System.Security.SecureString secureStr)
    {
        String plainStr=new System.Net.NetworkCredential(string.Empty, secureStr).Password;
        return plainStr;
    }

    // convert a plain text string into a secure string
    public static System.Security.SecureString ToSecureString(this String plainStr)
    {
        var secStr = new System.Security.SecureString(); secStr.Clear();
        foreach (char c in plainStr.ToCharArray())
        {
            secStr.AppendChar(c);
        }
        return secStr;
    }
} 
```

有了这个，您现在可以像这样**简单地来回转换字符串**：

```
// create a secure string
System.Security.SecureString securePassword = "MyCleverPwd123".ToSecureString(); 
// convert it back to plain text
String plainPassword = securePassword.ToPlainString();  // convert back to normal string 
```

但请记住，解码方法只能用于测试。

* * *

## 回答 #6

> 赞同：9
> 
> 时间：2019-01-29T13:47:18.197

[我根据rdev5](https://stackoverflow.com/a/33679932/1326370)的答案创建了以下扩展方法。固定托管字符串很重要，因为它可以防止垃圾收集器移动它并留下您无法擦除的副本。

我认为我的解决方案的优点是不需要不安全的代码。

```
/// <summary>
/// Allows a decrypted secure string to be used whilst minimising the exposure of the
/// unencrypted string.
/// </summary>
/// <typeparam name="T">Generic type returned by Func delegate.</typeparam>
/// <param name="secureString">The string to decrypt.</param>
/// <param name="action">
/// Func delegate which will receive the decrypted password as a string object
/// </param>
/// <returns>Result of Func delegate</returns>
/// <remarks>
/// This method creates an empty managed string and pins it so that the garbage collector
/// cannot move it around and create copies. An unmanaged copy of the the secure string is
/// then created and copied into the managed string. The action is then called using the
/// managed string. Both the managed and unmanaged strings are then zeroed to erase their
/// contents. The managed string is unpinned so that the garbage collector can resume normal
/// behaviour and the unmanaged string is freed.
/// </remarks>
public static T UseDecryptedSecureString<T>(this SecureString secureString, Func<string, T> action)
{
    int length = secureString.Length;
    IntPtr sourceStringPointer = IntPtr.Zero;

    // Create an empty string of the correct size and pin it so that the GC can't move it around.
    string insecureString = new string('\0', length);
    var insecureStringHandler = GCHandle.Alloc(insecureString, GCHandleType.Pinned);

    IntPtr insecureStringPointer = insecureStringHandler.AddrOfPinnedObject();

    try
    {
        // Create an unmanaged copy of the secure string.
        sourceStringPointer = Marshal.SecureStringToBSTR(secureString);

        // Use the pointers to copy from the unmanaged to managed string.
        for (int i = 0; i < secureString.Length; i++)
        {
            short unicodeChar = Marshal.ReadInt16(sourceStringPointer, i * 2);
            Marshal.WriteInt16(insecureStringPointer, i * 2, unicodeChar);
        }

        return action(insecureString);
    }
    finally
    {
        // Zero the managed string so that the string is erased. Then unpin it to allow the
        // GC to take over.
        Marshal.Copy(new byte[length], 0, insecureStringPointer, length);
        insecureStringHandler.Free();

        // Zero and free the unmanaged string.
        Marshal.ZeroFreeBSTR(sourceStringPointer);
    }
}

/// <summary>
/// Allows a decrypted secure string to be used whilst minimising the exposure of the
/// unencrypted string.
/// </summary>
/// <param name="secureString">The string to decrypt.</param>
/// <param name="action">
/// Func delegate which will receive the decrypted password as a string object
/// </param>
/// <returns>Result of Func delegate</returns>
/// <remarks>
/// This method creates an empty managed string and pins it so that the garbage collector
/// cannot move it around and create copies. An unmanaged copy of the the secure string is
/// then created and copied into the managed string. The action is then called using the
/// managed string. Both the managed and unmanaged strings are then zeroed to erase their
/// contents. The managed string is unpinned so that the garbage collector can resume normal
/// behaviour and the unmanaged string is freed.
/// </remarks>
public static void UseDecryptedSecureString(this SecureString secureString, Action<string> action)
{
    UseDecryptedSecureString(secureString, (s) =>
    {
        action(s);
        return 0;
    });
} 
```

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2020-04-18T07:22:20.783

根据 sclarke81 解决方案和 John Flaherty 修复的最终工作解决方案是：

```
 public static class Utils
    {
        /// <remarks>
        /// This method creates an empty managed string and pins it so that the garbage collector
        /// cannot move it around and create copies. An unmanaged copy of the the secure string is
        /// then created and copied into the managed string. The action is then called using the
        /// managed string. Both the managed and unmanaged strings are then zeroed to erase their
        /// contents. The managed string is unpinned so that the garbage collector can resume normal
        /// behaviour and the unmanaged string is freed.
        /// </remarks>
        public static T UseDecryptedSecureString<T>(this SecureString secureString, Func<string, T> action)
        {
            int length = secureString.Length;
            IntPtr sourceStringPointer = IntPtr.Zero;

            // Create an empty string of the correct size and pin it so that the GC can't move it around.
            string insecureString = new string('\0', length);
            var insecureStringHandler = GCHandle.Alloc(insecureString, GCHandleType.Pinned);

            IntPtr insecureStringPointer = insecureStringHandler.AddrOfPinnedObject();

            try
            {
                // Create an unmanaged copy of the secure string.
                sourceStringPointer = Marshal.SecureStringToBSTR(secureString);

                // Use the pointers to copy from the unmanaged to managed string.
                for (int i = 0; i < secureString.Length; i++)
                {
                    short unicodeChar = Marshal.ReadInt16(sourceStringPointer, i * 2);
                    Marshal.WriteInt16(insecureStringPointer, i * 2, unicodeChar);
                }

                return action(insecureString);
            }
            finally
            {
                // Zero the managed string so that the string is erased. Then unpin it to allow the
                // GC to take over.
                Marshal.Copy(new byte[length * 2], 0, insecureStringPointer, length * 2);
                insecureStringHandler.Free();

                // Zero and free the unmanaged string.
                Marshal.ZeroFreeBSTR(sourceStringPointer);
            }
        }

        /// <summary>
        /// Allows a decrypted secure string to be used whilst minimising the exposure of the
        /// unencrypted string.
        /// </summary>
        /// <param name="secureString">The string to decrypt.</param>
        /// <param name="action">
        /// Func delegate which will receive the decrypted password as a string object
        /// </param>
        /// <returns>Result of Func delegate</returns>
        /// <remarks>
        /// This method creates an empty managed string and pins it so that the garbage collector
        /// cannot move it around and create copies. An unmanaged copy of the the secure string is
        /// then created and copied into the managed string. The action is then called using the
        /// managed string. Both the managed and unmanaged strings are then zeroed to erase their
        /// contents. The managed string is unpinned so that the garbage collector can resume normal
        /// behaviour and the unmanaged string is freed.
        /// </remarks>
        public static void UseDecryptedSecureString(this SecureString secureString, Action<string> action)
        {
            UseDecryptedSecureString(secureString, (s) =>
            {
                action(s);
                return 0;
            });
        }
    } 
```

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2019-10-23T23:05:59.467

我从[sclarke81 的这个答案中得出](https://stackoverflow.com/a/54422529/12264345)。我喜欢他的回答，我正在使用衍生物，但 sclarke81 有一个错误。我没有名气，所以无法评论。这个问题似乎足够小，不需要另一个答案，我可以编辑它。所以我做了。它被拒绝了。所以现在我们有了另一个答案。

sclarke81 我希望你看到这个（最后）：

```
Marshal.Copy(new byte[length], 0, insecureStringPointer, length); 
```

应该：

```
Marshal.Copy(new byte[length * 2], 0, insecureStringPointer, length * 2); 
```

以及错误修复的完整答案：

```
 /// 
    /// Allows a decrypted secure string to be used whilst minimising the exposure of the
    /// unencrypted string.
    /// 
    /// Generic type returned by Func delegate.
    /// The string to decrypt.
    /// 
    /// Func delegate which will receive the decrypted password as a string object
    /// 
    /// Result of Func delegate
    /// 
    /// This method creates an empty managed string and pins it so that the garbage collector
    /// cannot move it around and create copies. An unmanaged copy of the the secure string is
    /// then created and copied into the managed string. The action is then called using the
    /// managed string. Both the managed and unmanaged strings are then zeroed to erase their
    /// contents. The managed string is unpinned so that the garbage collector can resume normal
    /// behaviour and the unmanaged string is freed.
    /// 
    public static T UseDecryptedSecureString(this SecureString secureString, Func action)
    {
        int length = secureString.Length;
        IntPtr sourceStringPointer = IntPtr.Zero;

        // Create an empty string of the correct size and pin it so that the GC can't move it around.
        string insecureString = new string('\0', length);
        var insecureStringHandler = GCHandle.Alloc(insecureString, GCHandleType.Pinned);

        IntPtr insecureStringPointer = insecureStringHandler.AddrOfPinnedObject();

        try
        {
            // Create an unmanaged copy of the secure string.
            sourceStringPointer = Marshal.SecureStringToBSTR(secureString);

            // Use the pointers to copy from the unmanaged to managed string.
            for (int i = 0; i < secureString.Length; i++)
            {
                short unicodeChar = Marshal.ReadInt16(sourceStringPointer, i * 2);
                Marshal.WriteInt16(insecureStringPointer, i * 2, unicodeChar);
            }

            return action(insecureString);
        }
        finally
        {
            // Zero the managed string so that the string is erased. Then unpin it to allow the
            // GC to take over.
            Marshal.Copy(new byte[length * 2], 0, insecureStringPointer, length * 2);
            insecureStringHandler.Free();

            // Zero and free the unmanaged string.
            Marshal.ZeroFreeBSTR(sourceStringPointer);
        }
    }

    /// 
    /// Allows a decrypted secure string to be used whilst minimising the exposure of the
    /// unencrypted string.
    /// 
    /// The string to decrypt.
    /// 
    /// Func delegate which will receive the decrypted password as a string object
    /// 
    /// Result of Func delegate
    /// 
    /// This method creates an empty managed string and pins it so that the garbage collector
    /// cannot move it around and create copies. An unmanaged copy of the the secure string is
    /// then created and copied into the managed string. The action is then called using the
    /// managed string. Both the managed and unmanaged strings are then zeroed to erase their
    /// contents. The managed string is unpinned so that the garbage collector can resume normal
    /// behaviour and the unmanaged string is freed.
    /// 
    public static void UseDecryptedSecureString(this SecureString secureString, Action action)
    {
        UseDecryptedSecureString(secureString, (s) =>
        {
            action(s);
            return 0;
        });
    }
} 
```

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2019-06-27T23:57:40.083

这个 C# 代码就是你想要的。

`%ProjectPath%/SecureStringsEasy.cs`

```
using System;
using System.Security;
using System.Runtime.InteropServices;
namespace SecureStringsEasy
{
    public static class MyExtensions
    {
        public static SecureString ToSecureString(string input)
        {
            SecureString secureString = new SecureString();
            foreach (var item in input)
            {
                secureString.AppendChar(item);
            }
            return secureString;
        }
        public static string ToNormalString(SecureString input)
        {
            IntPtr strptr = Marshal.SecureStringToBSTR(input);
            string normal = Marshal.PtrToStringBSTR(strptr);
            Marshal.ZeroFreeBSTR(strptr);
            return normal;
        }
    }
} 
```

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2021-09-25T15:03:37.007

作为答案接受的代码是正确的，并且在大多数情况下都可以工作，但正如评论中提到的那样，使用 BSTR 会更好，并且将涵盖所有情况：

```
private string SecureStringToString(SecureString value) {
    IntPtr valuePtr = IntPtr.Zero;
    try {
        valuePtr = Marshal.SecureStringToBSTR(value);
        return Marshal.PtrToStringBSTR(valuePtr);
    } finally {
        Marshal.ZeroFreeBSTR(valuePtr);
    }
} 
```

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2022-02-18T15:32:47.547

使用以下内容：

```
var plaintextPwd = new System.Net.NetworkCredential("", <securestring with your encrypted password>).Password 
```

* * *

## 回答 #12

> 赞同：-5
> 
> 时间：2015-01-13T16:12:02.277

```
// using so that Marshal doesn't have to be qualified
using System.Runtime.InteropServices;    
//using for SecureString
using System.Security;
public string DecodeSecureString (SecureString Convert) 
{
    //convert to IntPtr using Marshal
    IntPtr cvttmpst = Marshal.SecureStringToBSTR(Convert);
    //convert to string using Marshal
    string cvtPlainPassword = Marshal.PtrToStringAuto(cvttmpst);
    //return the now plain string
    return cvtPlainPassword;
} 
```

* * *

## 回答 #13

> 赞同：-5
> 
> 时间：2016-03-12T12:56:41.227

如果您使用 a`StringBuilder`而不是 a `string`，您可以在完成后覆盖内存中的实际值。这样密码就不会在内存中徘徊，直到垃圾收集捡起它。

```
StringBuilder.Append(plainTextPassword);
StringBuilder.Clear();
// overwrite with reasonably random characters
StringBuilder.Append(New Guid().ToString()); 
```

# python - 使用 re.split 在 Python 中将文件拆分为行

> ID：818705
> 
> 赞同：1
> 
> 时间：2009-05-04T03:36:47.960
> 
> 标签：python, regex, list-comprehension

我正在尝试使用类似于以下的代码拆分具有列表理解的文件：

```
lines = [x for x in re.split(r"\n+", file.read()) if not re.match(r"com", x)] 
```

但是，行列表总是有一个空字符串作为最后一个元素。有谁知道避免这种情况的方法（不包括之后放置 pop() 的杂物）？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-05-04T04:14:20.617

把正则表达式锤子收起来:-)

1.  您可以直接遍历文件；`readlines()`这些天几乎已经过时了。
2.  阅读[`str.strip()`](http://docs.python.org/library/stdtypes.html#str.strip)（及其朋友，`lstrip()`和`rstrip()`）。
3.  不要`file`用作变量名。这是一种不好的形式，因为`file`它是一个[内置函数](http://docs.python.org/library/functions.html#file)。

您可以将代码编写为：

```
lines = []
f = open(filename)
for line in f:
    if not line.startswith('com'):
        lines.append(line.strip()) 
```

如果你仍然在那里得到空行，你可以添加一个测试：

```
lines = []
f = open(filename)
for line in f:
    if line.strip() and not line.startswith('com'):
        lines.append(line.strip()) 
```

如果你真的想要它在一行中：

```
lines = [line.strip() for line in open(filename) if line.strip() and not line.startswith('com')] 
```

最后，如果您使用的是 python 2.6，请查看[with 语句](http://effbot.org/zone/python-with-statement.htm)以进一步改进。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-04T03:40:00.963

行 = file.readlines()

**编辑：** 或者如果你不想在那里有空行，你可以做

行 = 过滤器（lambda a:(a!='\n'), file.readlines())

**编辑^2：** 要删除尾随的换行符，您可以这样做

lines = [re.sub('\n','',line) for line in filter(lambda a:(a!='\n'), file.readlines())]

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-04T06:26:10.377

另一个方便的技巧，尤其是当您需要行号时，是使用枚举：

```
 fp = open("myfile.txt", "r")
for n, line in enumerate(fp.readlines()):
    dosomethingwith(n, line) 
```

我最近才发现枚举，但从那以后它已经派上用场了好几次了。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-04T05:21:06.010

这应该有效，并且也消除了正则表达式：

```
all_lines = (line.rstrip()
             for line in open(filename)
             if "com" not in line)
# filter out the empty lines
lines = filter(lambda x : x, all_lines) 
```

由于您使用的是列表推导而不是生成器表达式（因此整个文件都会被加载到内存中），所以这里有一个快捷方式，可以避免代码过滤掉空行：

```
lines = [line
     for line in open(filename).read().splitlines()
     if "com" not in line] 
```

# asp.net - SSRS 获取远程报告的元数据

> ID：818714
> 
> 赞同：2
> 
> 时间：2009-05-04T03:40:45.937
> 
> 标签：asp.net, sql-server, reporting-services, metadata

如何从远程 SSRS 报告中检索元数据，例如描述、修改/创建日期等。报告本身在 aspx 页面上的 ReportViewer 控件中显示没有问题，因此我可以访问报告...

.ServerReport 对象中的这些值似乎没有任何属性...

多谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-07T22:02:50.303

有两种方法，一种方法是向报告服务器的 Web 服务接口添加 Web 引用并调用 GetReportDefinition 方法。更多信息在这里：

[http://msdn.microsoft.com/en-us/library/aa258101(SQL.80).aspx](http://msdn.microsoft.com/en-us/library/aa258101(SQL.80).aspx)

代码可能如下所示：

```
 ReportingService reportingService = new ReportingService();

XmlDocument xmlDocument = null;

byte[] reportDefinition = reportingService.GetReportDefinition(ReportName);

using (MemoryStream memoryStream = new MemoryStream(reportDefinition))
{
    xmlDocument = new XmlDocument();
    xmlDocument.Load(memoryStream);
} 

```

这将获取您可以使用 XML 工具解析的 .rdl 文件。您还可以通过 SQL/ADO/Linq 调用 SSRS 数据库中的表来获取您所需要的信息：

针对报告服务数据库的 T-SQL 的一些很好的示例：

[http://www.purplefrogsystems.com/blog/?p=13](http://www.purplefrogsystems.com/blog/?p=13)

您需要的所有信息可能不在一个位置，例如，有些可能在 .rdl 中，有些在 SQL Server 数据库中。

{6230289B-5BEE-409e-932A-2F01FA407A92}

# elmah - Elmah 备份异常日志记录

> ID：818725
> 
> 赞同：4
> 
> 时间：2009-05-04T03:49:53.077
> 
> 标签：elmah

我已设置 elmah 以在我的 SQL 服务器上记录异常。如果 SQL 服务器出现故障，是否有任何方法可以定义回退机制。如果 sql 服务器无法访问，我希望 elmah 开始记录到 xml 文件。知道怎么做吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-02-17T00:22:21.047

Elmah 还不支持回退或并发日志记录位置。

[如果 Elmah 无法访问数据库以记录异常怎么办？](https://stackoverflow.com/questions/3391494/what-to-do-if-elmah-cant-reach-the-database-to-log-an-exception)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-05T09:14:24.963

我发布了一个复合错误日志，它正好解决了这个问题。
您可以通过[Nuget](http://nuget.org/packages/Elmah.FallbackErrorLog/)安装它或将其从[源代码](https://github.com/eric-b/Elmah.FallbackErrorLog/)复制到您的项目中。

[我在这里的回答](https://stackoverflow.com/a/14703724/249742)中有更多详细信息。

# c++ - 创建将经常升级的应用程序的最佳实践 - C++

> ID：818736
> 
> 赞同：0
> 
> 时间：2009-05-04T04:01:00.880
> 
> 标签：c++

我正在开发一个可移植的 C++ 应用程序并寻找一些最佳实践。此应用程序将经常更新，我需要以可以轻松更新程序部分的方式构建它。

1.  对于经常更新的程序，将程序部分创建到库中是最佳实践吗？如果程序部分在不同的库中，用户可以在发生变化时替换库。
2.  如果第 1 点的答案是“是”，我必须使用什么类型的库？在 LINUX 中，我知道我可以创建一个“*共享库*”，但我不确定它对于 Windows 的可移植性如何。我必须使用什么类型的库？我也知道 Windows 中的 DLL 地狱问题。

任何帮助都会很棒！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-04T04:08:57.040

1.  是的，使用库很好，但是用新库“简单地”替换库的想法可能是不现实的，因为库 API 往往会发生变化，并且应用程序通常需要更新以利用甚至兼容不同的库库的版本。但是，通过大量的[集成测试](http://en.wikipedia.org/wiki/Integration_testing)，您将能够“支持”一系列不同版本的库。或者，如果您自己控制库代码，则可以确保对库代码的更改不会破坏应用程序。

2.  在 Windows 中，DLL 直接等同于 Linux 中的共享库（so），如果您在通用环境中编译两者（交叉编译或在 Windows 中使用 MingW），那么链接器将以相同的方式进行。当然，假设您的所有其余代码都是跨平台的，并且为目标平台正确配置了自己。

    IMO，在过去，当应用程序都将它们的 DLL 安装到像 C:\WINDOWS\SYSTEM 这样的公共目录中时， [DLL 地狱](http://en.wikipedia.org/wiki/DLL_hell)确实是一个更大的问题，人们不再这样做了，因为它创建了 DLL 地狱。您可以将共享库放置在不会干扰其他非感知应用程序的更合适的位置，或者 - 最简单的方法 - 只需将它们与需要它们的可执行文件放在同一目录中。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-04T04:28:01.363

我并不完全相信以任何方式分离程序的可执行部分会简化升级。在极少数情况下，它可能会使更新安装程序更小，但付出的努力将是巨大的，而且一旦你*弄错*了，肯定不值得。在大多数情况下，将所有可执行代码替换为一个。

另一方面，您要非常小心，不要弄乱您的用户可能已更改的任何内容。在只是代码的应用程序部分和作为用户数据的部分之间画一条明亮的线。小心处理用户数据。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-04T04:36:53.963

如果它是一个应用程序，我的第一选择是发布一个静态链接的单个可执行文件。我有机会在一个产品上工作，该产品被运送到 5 个平台（Win2K、WinXp、Linux、Solaris、Tru64-Unix），并且相信我维护具有大型代码库的共享库或 DLL 是一项艰巨的任务。假设这是一个重要的应用程序，它涉及使用 3rd Party GUI、线程等。使用 C++，没有真正的*唯一方法*在所有平台上都这样做。这意味着无论如何您都必须为不同的平台维护不同的代码库。然后是不同平台上的 3rd 方库的一些奇怪行为（错误）。如果应用程序使用不同的库版本（即不同的版本要附加到不同的平台），所有这些都会造成负担。当修复仅针对特定平台以避免版本控制混乱时，我已经看到人们将库运送到所有平台。但这并不是那么简单，客户通常对他/她想要如何升级/补丁有不同的角度，这也是需要考虑的。

当然，如果您正在构建的二进制文件很大，那么可以考虑 DLL/共享库。即使是这种情况，我建议以如下层的形式构建您的应用程序：- 应用程序--> GUI--> 平台--> 基础--> 基础

所以这里有些库可以有所有平台的通用代码。只有像“平台”这样的特定库才能针对特定行为进行更新。这将使您的生活更轻松。

恕我直言，当您构建一个充当完整解决方案而不仅仅是应用程序的产品时，DLL/共享库选项是可行的。在这种情况下，不同的子系统在您的产品框架中同时使用公共逻辑，然后可以使用 DLL/共享库在内存中共享其逻辑。

高温下，

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-04T04:04:16.833

一旦您尝试同时处理*Windows*和 UNIX 系统（如 Linux），生活就会变得更加复杂。

您必须满足哪些服务要求？您能否控制客户端系统何时升级？您需要支持多少个系统？您有多少向后兼容性要求。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-04T04:37:25.193

用一个问题来回答您的问题，如果可移植性是关键目标之一，您为什么要使应用程序成为原生应用程序？

您可以考虑迁移到 Java 或 .Net/Mono 等虚拟平台。您仍然可以将 C++ 库（Linux 上的共享库，Windows 上的 DLL）编写为任何作为本机代码更好的东西，但您的应用程序的大部分将是真正可移植的。

# iphone - Iphone UIButton 在嵌套的 UIViews 中不起作用

> ID：818739
> 
> 赞同：11
> 
> 时间：2009-05-04T04:01:06.497
> 
> 标签：iphone, uiview, uiviewcontroller, uibutton

我敢肯定，这该死的简单！我错过了一些东西，并且因为试图修复它而筋疲力尽。希望有人可以提供帮助。

CharacterView.m 中的 Button 有效，但 CharacterMale.m 中嵌套的按钮无效。我没有使用 IB，一切都是以编程方式完成的。什么会导致一个按钮工作而另一个按钮不工作？

```
/////////////////////////////////////////////////////////////////////////////////
 CharacterController.m
/////////////////////////////////////////////////////////////////////////////////
#import "CharacterController.h"
#import "CharacterView.h"

@implementation CharacterController

- (id)init {
    NSLog(@"CharacterController init");
    self = [ super init ];
    if (self != nil) {
    }
    return self;
}

- (void)loadView {
    [ super loadView ];
    characterView = [ [ CharacterView alloc ] init];
    self.view = characterView;
}

- (void)didReceiveMemoryWarning {
    [super didReceiveMemoryWarning];
}

- (void)dealloc {
    [super dealloc];
}

@end

/////////////////////////////////////////////////////////////////////////////////
 CharacterView.m
/////////////////////////////////////////////////////////////////////////////////

#import "CharacterView.h"
#import "CharacterMale.h"

@implementation CharacterView

- (id)initWithFrame:(CGRect)frame {
    if (self = [super initWithFrame:frame]) {
        characterMale = [ [ CharacterMale alloc ] init];
        [self addSubview: characterMale];

        UIButton *button = [UIButton buttonWithType:UIButtonTypeCustom];
        button.frame = CGRectMake(0, 200, 200, 100);
        [button setImage:[UIImage imageNamed:@"btnCharSelect.png"] forState:UIControlStateNormal];
        [button addTarget:self action:@selector(ApplyImage:) forControlEvents:UIControlEventTouchUpInside];
        [ self addSubview: button ];
    }
    return self;
}

- (void)drawRect:(CGRect)rect {
}

-(void)ApplyImage:(id)sender
{
    NSLog(@"CharacterView button works");
}

- (void)dealloc {
    [super dealloc];
}

@end

/////////////////////////////////////////////////////////////////////////////////
 CharacterMale.m
/////////////////////////////////////////////////////////////////////////////////

#import "CharacterMale.h"
#import "CharacterController.h"

@implementation CharacterMale

- (id)init {
    self = [ super init];
    if (self != nil) {
        UIImage *image = [UIImage imageNamed:@"charMale.png"];
        imageView = [[ UIImageView alloc] initWithImage:image];
        [image release];
        [ self addSubview: imageView ];

        UIButton *button = [UIButton buttonWithType:UIButtonTypeCustom];
        button.frame = CGRectMake(0, 0, 200, 100);
        [button setImage:[UIImage imageNamed:@"btnCharSelect.png"] forState:UIControlStateNormal];
        [button addTarget:self action:@selector(ApplyImage:) forControlEvents:UIControlEventTouchUpInside];
        [ self addSubview: button ];

    }
    return self;
}

-(void)ApplyImage:(id)sender
{
    NSLog(@"CharacterMal button works");
}

- (void)dealloc {
    [super dealloc];
}

@end 
```

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2009-05-04T08:28:00.350

最后！！！！！！

我必须使用 initWithFrame 初始化所有视图并传入有效的框架矩形。Init 应该与控制器一起使用，并且 initWithFrame 为 UIViews 传递 rects！！！！

```
characterView = [ [ CharacterView alloc ] initWithFrame:CGRectMake(0, 0, 480, 320)]; 
then 
characterMale = [ [ CharacterMale alloc ] initWithFrame:frame]; 
```

* * *

## 回答 #2

> 赞同：17
> 
> 时间：2010-05-24T11:20:45.360

要考虑的另一件事是`UIButton`添加的子视图`UIImageView`根本不起作用。您需要创建一个`UIView`添加图像视图和按钮的对象。

这可能是因为默认情况下图像视图上的交互是关闭的，但我没有检查这一点。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-04T08:30:39.440

新视图是否接受用户交互？换句话说，是否在“Characters”视图上启用了 userInteractionEnabled？

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2010-06-13T15:04:57.473

在使用 CGRectZero 框架初始化 UIView 期间尝试添加按钮时，我遇到了类似的问题：

```
@implementation SomeView
...
- (id)initWithTitleImage:(UIImage *) newTitleImage {
  // BROKEN: frame with CGRectZero.
  self = [super initWithFrame:CGRectZero];
  if (self) {
    UIButton *someButton = ...;
    [self addSubview someButton];
  }
} 
```

一旦我将框架更改为适当的矩形，按钮就起作用了：

```
@implementation SomeView
...
- (id)initWithTitleImage:(UIImage *) newTitleImage {
  // WORKING: frame with proper CGRect.
  self = [super initWithFrame:CGRectMake(0, 0, 480, 320)];
  if (self) {
    UIButton *someButton = ...;
    [self addSubview someButton];
  }
} 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2011-01-31T20:30:46.473

通过使用`UIControlEventTouchDown`而不是流行的`UIControlEventTouchUpInside`.

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2013-07-26T20:50:58.560

对我来说，这个问题是因为按钮框架的原点比父框架大。

# javascript - 如何实现谷歌地图 yelp.com 风格？

> ID：818745
> 
> 赞同：2
> 
> 时间：2009-05-04T04:05:05.177
> 
> 标签：javascript, json, google-maps, unobtrusive-javascript

我有多个位置（每页 20 多个）需要映射到一张地图上。我想单击*非*动态生成的位置的链接（出于 SEO 目的），该链接将打开地图上相应标记的信息窗口。

行为应模仿[http://maptheburg.com/](http://maptheburg.com/) - 但此地图具有动态生成的侧边栏链接。

[Yelp.com](http://www.yelp.com/c/dallas/restaurants)是迄今为止我看到的唯一一个使用不显眼的 JavaScript 实现 Google Maps API 的网站。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2011-07-12T09:48:41.630

我不完全确定 yelp 实现是什么，但如果它是不显眼的 JavaScript 映射，那么你唯一可行的选择是提供静态图像而不是 JavaScript 不可用的交互式地图。

可以在[此处找到此技术的快速浏览](http://www.svennerberg.com/2008/12/unobtrusive-google-maps/)

HTH。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-04T04:13:24.190

Yelp.com 拥有自己的 JavaScript 库，该库与 Google Map 的 JavaScript API 进行交互/用于地图。你可能想从那里偷看开始。

可能还想查看[PdMarker](http://www.pixeldevelopment.com/pdmarker.asp)以获取高级 Google 地图标记。

如果我没记错的话，Yelp 采用了一种开源标记实现并对其进行了修改以供自己使用。

# grails - 如何在 GSP 中使用 openid4java 实现 openID

> ID：818749
> 
> 赞同：0
> 
> 时间：2009-05-04T04:07:28.930
> 
> 标签：grails, servlets, groovy, openid, gsp

如何在 gsp 中构建 openID ReturnURL？

```
Define a ReturnURL

This is the endpoint where your webapp will receive and process the authentication responses from the OpenID Provider.

    String _returnURL = "http://example.com/openid"; 
```

参考：[http ://code.google.com/p/openid4java/wiki/QuickStart](http://code.google.com/p/openid4java/wiki/QuickStart)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-09-12T11:50:31.550

假设您在 config.groovy 文件中正确设置了 grails.serverURL，您可以使用绝对设置为 true 的 createLink 标记：

```
grails.serverURL = "http://example.com"

String _returnURL = createLink(controller:'openid', action:'handleReturn', absolute:true)

// _returnURL -> http://example.com/appname/openid/handleReturn 
```

# apache-flex - 有没有办法覆盖动作脚本运算符，特别是我想覆盖等于运算符

> ID：818750
> 
> 赞同：2
> 
> 时间：2009-05-04T04:07:37.963
> 
> 标签：apache-flex, flash, actionscript-3, flex3

是否可以覆盖 equals() 运算符（即，对于可以通过 2 个或更多字段匹配确定相等性的客户类）。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-05-04T04:25:28.903

如果您的意思是重载“==”作为 equals() 的同义词，那么您不能，因为 ActionScript 不提供运算符重载。只需为您的类编写一个 equals() 方法并使用它...

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2011-01-30T22:31:26.387

对一个类使用你自己的 equals() 方法并不能解决如何检查一个集合是否包含所需的对象。在 flex 中，我总是不得不为每个对象编写一个并遍历每个成员对象以检查是否有 2 个或更多字段匹配。Java 允许程序员覆盖集合接口自动使用的 hashCode() 和 equals()。

# php - 基于网络的音乐库（编程概念）

> ID：818752
> 
> 赞同：2
> 
> 时间：2009-05-04T04:10:38.910
> 
> 标签：php, python, mysql

所以，一段时间以来，我一直在脑海中徘徊这个想法。从本质上讲，它主要是一个让我学习编程的项目。这个想法是，我有大量数据，我的音乐收藏。我的音乐有很多数据集。格式、艺术家、标题、专辑、流派、长度、发行年份、文件名、目录等等。理想情况下，我想创建一个数据库，其中存储了所有这些数据，并且在未来，在其上创建一个 Web 界面，我可以使用它来管理我的音乐收藏。所以，我的问题如下：

1.  这听起来像是一个从头开始构建数据库的好项目吗？
2.  你会推荐我从什么语言开始？我知道 PHP 的花絮，但我想用它来索引文件系统中的数据会很糟糕。Python 是我想到的另一种语言，考虑到它是大多数人认为是初学者语言的语言。
3.  如果您要在家中实现这种系统（Web 界面）（如果您将 PC 连接到家中的几个立体声音响，并且这是连接的软件），您希望看到什么样的功能？

我构建索引脚本的想法如下：

*   让它只用文件名填充数据库
*   从文件名的扩展名，确定格式
*   获取文件大小
*   使用数据库中的文件名作为参考，提取 ID3 或其他适用的元数据（艺术家、曲目名称、专辑等）
*   检查磁盘上是否仍然存在所有文件，如果不存在，则将该文件标记为不可用

另一个脚本稍后会进入并检查文件是否返回，如果没有，将从数据库中删除该行。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-04T04:14:24.843

我认为这是一个学习编程的好项目。通过使用您自己的“产品”，您可以真正获得缺失的东西，并且更有动力学习和改进您的程序 - 这就是所谓的[dogfooding](http://www.codinghorror.com/blog/archives/000287.html)。奇怪的是，[Dive Into Python](http://www.diveintopython.net/)一书虽然有点旧，但详细介绍了如何使用 Python 提取音乐文件的 ID3 信息。由于那是最常推荐给初学者的书，我敢打赌那将是一个很好的起点。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-04T04:18:10.450

从事你关心的事情是学习编程的最佳方式，所以我认为这是一个好主意。

我还推荐 Python 作为起点。玩得开心！

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-04T04:29:32.263

如果您使用 Python，则可以使用[Google App Engine](http://code.google.com/appengine/)构建它。它为您提供了一个非常漂亮的数据库界面，本教程将带您从“Hello world！”开始。到一个正常运行的网络应用程序。

您甚至不需要将结果上传到 Google；您可以在开发环境中运行它，并且可以在您的家庭网络中访问它。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-04T05:28:08.537

我认为 python 将是一个很好的选择

1.  易于学习，但也具有高级功能
2.  可用的良好 Web 框架，例如 django，您可以在您的机器上运行它
3.  Word 类提供免费的 python 托管，即谷歌应用引擎
4.  Libraries available for almost anything imaginable e.g. for reading your mp3 tags you can use [http://id3-py.sourceforge.net/](http://id3-py.sourceforge.net/)
5.  for searching you can use pylucene [http://lucene.apache.org/pylucene/](http://lucene.apache.org/pylucene/) the best search engine available.

# .net - 使用多线程加速 .NET 反射

> ID：818756
> 
> 赞同：2
> 
> 时间：2009-05-04T04:13:26.797
> 
> 标签：.net, multithreading, reflection, multicore

我的 PC 有一个双核 CPU，我想知道 - 如果我开始在两个线程中处理，是否可以将 .NET 反射时间减少两倍。

我所说的“处理”是指以下内容：

1.加载程序集 2.从中取出所有类型 (.GetTypes()) 3.处理这些类型 4.查询这些类型的方法等。

如果是 - 最好的（性能方面）策略是什么：

1.  在一个线程中加载所有程序集，然后在两个并发线程中处理元信息
2.  在自己的线程中加载和处理每个程序集

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-04T05:35:57.970

有几件事要记住：

*   启动一个新线程是昂贵的，所以如果任务是短暂的，开销可能会令人望而却步。通过使用线程池而不是启动您自己的线程，线程池将确保尽其所能重用线程。但是，在短时间内启动大量任务并不能产生当前线程池实现的最佳结果。

*   由于您的特定任务涉及一些 I/O，这可能是操作中最昂贵的部分。分叉几个线程来等待 I/O 可能不会产生更好的性能。直到你测量它，你才能真正知道。

*   如果您将数据存储在共享存储库中或输出到文件/屏幕，则必须围绕它进行同步。这显然降低了并发性。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-04T04:19:24.550

在单独的线程中加载和处理每个程序集更快。但只是快一点。例如，您将通过缓存 MethodInfos 获得更好的里程数。

不过，我会质疑这种优化的必要性。

结果：

```
预热单线程时间经过 465 毫秒
多线程耗时 173 毫秒
单线程耗时 456 毫秒

```

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Threading;
using System.Reflection;
using System.Diagnostics;

namespace ConsoleApplication12 {
    class Program {

        static void TimeAction(string description, Action func) {
            var watch = new Stopwatch();
            watch.Start();
            func();
            watch.Stop();
            Console.Write(description);
            Console.WriteLine(" Time Elapsed {0} ms", watch.ElapsedMilliseconds);
        }

        static void Main(string[] args) {

            var assemblies = AppDomain.CurrentDomain.GetAssemblies();

            // warm up 
            TimeAction("warm up single threaded", () =>
            {
                foreach (var assembly in assemblies) {
                    assembly.GetTypes().Select(type => type.GetMethods()).ToArray();
                }

            });

            List<Thread> threads = new List<Thread>();

            TimeAction("multi threaded", () => {
                foreach (var assembly in assemblies) {
                    Thread t = new Thread(new ThreadStart( () => 
                        assembly.GetTypes().Select(type => type.GetMethods()).ToArray()
                        ));
                    t.Start();
                    threads.Add(t);
                }

                foreach (var thread in threads) {
                    thread.Join();
                }
            });

            TimeAction("single threaded", () =>
            {
                foreach (var assembly in assemblies) {
                    assembly.GetTypes().Select(type => type.GetMethods()).ToArray();
                }

            });

            Console.ReadKey();
        }
    }
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-04T04:21:09.227

除非您正在处理绝对庞大的库，否则根据我的经验，反射加载并不是一件非常缓慢的事情。这可能会浪费你的时间。

尽管如此，请查看 ThreadPool.QueueUserWorkItem，让这些事情变得简单。

```
foreach (Assembly a in "folder/something") {
    ThreadPool.QueueUserWorkItem((object assem) => {
        // do work
    }, a);
} 
```

# java - 应该使用什么代码页/字符集将来自 MVS 系统的数据解释为 Java 环境？

> ID：818759
> 
> 赞同：3
> 
> 时间：2009-05-04T04:15:00.443
> 
> 标签：java, encoding, character-encoding, codepages, zos

我遇到了一个有趣的问题（在与遗留系统交互时经常出现这种情况）。我正在开发一个应用程序（目前在 x86 Linux 或 Windows 系统上运行），它可以接收来自各种系统的请求，其中一个是 MVS 系统。

我正在尝试确定应该使用哪个代码页/字符集来解释来自 MVS 系统的请求数据。

过去，我使用 'cp500' (IBM-500) 来解释 z/OS 系统的字节日期，但是我担心 MVS 有点像遗留系统，而且因为 IBM 似乎改变了主意对于要使用的编码（必须有数十个 EBCDIC 编码），cp500 可能不是正确的编码。

我在 Java 字符集上找到的最佳资源是： http: [//mindprod.com/jgloss/encoding](http://mindprod.com/jgloss/encoding)。但是，从这个站点和 IBM 信息中心，我无法得到明确的答案。

编辑：从我对 Pax 的回复中添加如下：

在请求数据的来源中，我的问题有一个明显的漏洞。在这种情况下，数据的来源是通过 Websphere MQ 接口。Websphere MQ 确实具有转换为正确编码的功能，但仅用于使用 MQMessage.readString() 读取数据，该方法已被弃用。我更喜欢使用它，但是我使用的是专有接口框架，在该框架中我无法更改从 MQQueue 读取消息的方式，它直接从队列中读取字节，因此我是左句柄翻译。

最终答案：我想跟进这件事。事实证明，正确的字符集确实是 cp500 (IBM-500)。但是，我的印象是结果可能会有所不同。给有同样问题的其他人的一些提示：

利用 Charset.availableCharsets();。这将为您提供运行时支持的字符集的地图。我遍历这些集合并打印出我的字节数据翻译成该字符集。虽然它没有给我想要的答案（主要是因为我无法在数据进入时读取数据），但我想它可能对其他人有所帮助。

请参阅：[http](http://mindprod.com/jgloss/encoding) ://mindprod.com/jgloss/encoding以获取支持的字符集列表。

最后，虽然我没有确认这一点，但请确保您使用的是正确的 JRE。我认为 IBM 运行时支持比 OpenJDK 或 Sun 的运行时更多的 EBCDIC 字符集。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-04T04:33:51.037

“MVS 有点像遗留系统”？哈！它仍然是可靠性是首要问题的应用程序的首选操作系统。现在回答你的问题:-)

这完全取决于生成数据的内容。例如，如果您只是从主机下载文件，FTP 协商可能会处理它。但是由于您提到 Java，它可能通过 JDBC 连接到 DB2/z，并且 JDBC 驱动程序会很好地处理它（如果您使用 IBM 自己的 JRE 而不是 Sun 版本会更好）。

主机上的 EBCDIC 本身有很多不同的编码，因此您至少需要让我们知道数据的来源。DB2 的最新版本在数据库中存储 Unicode 没有问题，这将减轻您的所有顾虑。

第一个任务，找出数据的来源并从您的 SysProg 获取编码（如果它没有自动处理）。

**更新：**

安德鲁，根据您添加的文本，您声明不能使用提供的翻译，您将不得不使用手动方法。您需要识别数据的来源并从中获取 CCSID。然后手动进行与 Unicode（或您使用的任何代码页，如果不是 Unicode）之间的转换。

CCSID 500 是 EBCDIC International（无欧元）的默认代码页，但这些机器在全球范围内使用。z/OS 转换服务是您通常在大型机上进行转换的方式。

虽然[这](http://www-03.ibm.com/systems/i/software/globalization/codepages.html)是一个 iSeries 页面，但它列出了大量 CCSID 及其字形，也适用于大型机。

您可能只需要弄清楚您使用的是 CCSID 500 还是 37（或其中一种外语版本）并计算出与 Unicode CCSID 1208 的映射。您的 SysProg 将能够告诉您是哪一个。如果您在一家美国公司工作，它*可能*有500 或 37 个，但 IBM 花费了大量精力来支持多个代码页。当他们所有的大型机软件默认存储并使用 Unicode 时，我会很高兴，这会让事情变得更容易。

# c++ - 取消翻转 wxImage 加载

> ID：818762
> 
> 赞同：0
> 
> 时间：2009-05-04T04:17:39.563
> 
> 标签：c++, opengl, wxwidgets

我[这里](http://wiki.wxwidgets.org/Using_wxImage_to_load_textures_for_OpenGL)的代码工作正常，除了 2 个图像的所有非幂在 y 方向上翻转。在 wxImageLoader 文件中有这个循环，我认为这是罪魁祸首：

```
 for(int y=0; y<newHeight; y++)
    {
        for(int x=0; x<newWidth; x++)
        {

            if( x<(*imageWidth) && y<(*imageHeight) ){
                imageData[(x+y*newWidth)*bytesPerPixel+0]=
                bitmapData[( x+(rev_val-y)*(*imageWidth))*old_bytesPerPixel + 0];

                imageData[(x+y*newWidth)*bytesPerPixel+1]=
                    bitmapData[( x+(rev_val-y)*(*imageWidth))*old_bytesPerPixel + 1];

                imageData[(x+y*newWidth)*bytesPerPixel+2]=
                    bitmapData[( x+(rev_val-y)*(*imageWidth))*old_bytesPerPixel + 2];

                if(bytesPerPixel==4) imageData[(x+y*newWidth)*bytesPerPixel+3]=
                    alphaData[ x+(rev_val-y)*(*imageWidth) ];

            }
            else
            {

                imageData[(x+y*newWidth)*bytesPerPixel+0] = 0;
                imageData[(x+y*newWidth)*bytesPerPixel+1] = 0;
                imageData[(x+y*newWidth)*bytesPerPixel+2] = 0;
                if(bytesPerPixel==4) imageData[(x+y*newWidth)*bytesPerPixel+3] = 0;
            }

        }//next
    }//next 
```

但我不知道如何取消翻转图像。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-04T04:39:26.233

在您的循环中，您使用`(rev_val - y)`“旧”图像的像素索引。这将导致图像翻转。尝试寻找替代方案。从您发布的代码中，很难知道 rev_val 的功能是什么。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-04T06:35:12.523

正确的 for 循环是：

```
for(int y=0; y<newHeight; y++)
    {
        for(int x=0; x<newWidth; x++)
        {

            if( x<(*imageWidth) && y<(*imageHeight) ){
                imageData[(x+y*newWidth)*bytesPerPixel+0]=
                bitmapData[( x+y*(*imageWidth))*old_bytesPerPixel + 0];

                imageData[(x+y*newWidth)*bytesPerPixel+1]=
                    bitmapData[( x+y*(*imageWidth))*old_bytesPerPixel + 1];

                imageData[(x+y*newWidth)*bytesPerPixel+2]=
                    bitmapData[( x+y*(*imageWidth))*old_bytesPerPixel + 2];

                if(bytesPerPixel==4) imageData[(x+y*newWidth)*bytesPerPixel+3]=
                    alphaData[ x+y*(*imageWidth) ];

            }
            else
            {

                imageData[(x+y*newWidth)*bytesPerPixel+0] = 0;
                imageData[(x+y*newWidth)*bytesPerPixel+1] = 0;
                imageData[(x+y*newWidth)*bytesPerPixel+2] = 0;
                if(bytesPerPixel==4) imageData[(x+y*newWidth)*bytesPerPixel+3] = 0;
            }

        }//next
    }//next 
```

# c# - BackgroundWorker OnWorkCompleted 抛出跨线程异常

> ID：818767
> 
> 赞同：3
> 
> 时间：2009-05-04T04:20:53.580
> 
> 标签：c#, winforms, backgroundworker, arcgis, multithreading

我有一个用于数据库分页的简单 UserControl，它使用控制器来执行实际的 DAL 调用。我使用 a`BackgroundWorker`来执行繁重的工作，并在`OnWorkCompleted`事件中重新启用某些按钮、更改`TextBox.Text`属性并为父表单引发事件。

表单 A 包含我的用户控件。当我单击打开表单 B 的某个按钮时，即使我没有在“那里”做任何事情并关闭它，并尝试从我的数据库中引入下一页，`OnWorkCompleted`在工作线程（而不是我的主线程），并引发跨线程异常。

目前我`InvokeRequired`在那里的处理程序处添加了一个检查，但不是`OnWorkCompleted`要在主线程上调用整个点吗？为什么它不能按预期工作？

编辑：

我设法将问题缩小到 arcgis 和`BackgroundWorker`. 我有以下解决方案，它向 arcmap 添加了一个命令，`Form1`用两个按钮打开一个简单的命令。

第一个按钮运行`BackgroundWorker`睡眠 500 毫秒并更新计数器。在`RunWorkerCompleted`方法中它检查`InvokeRequired`并更新标题以显示该方法最初是在主线程还是在工作线程中运行。第二个按钮刚刚打开`Form2`，其中不包含任何内容。

起初，所有的调用`RunWorkerCompletedare`都是在主线程内进行的（正如预期的那样——这就是 RunWorkerComplete 方法的全部要点，至少我从[MSDN](http://msdn.microsoft.com/en-us/library/system.componentmodel.backgroundworker(VS.80).aspx)上了解到的`BackgroundWorker`）

在打开和关闭之后`Form2`，`RunWorkerCompleted`总是在工作线程上被调用。我想补充一点，我可以让这个问题的解决方案保持原样（`InvokeRequired`在`RunWorkerCompleted`方法中检查），但我想了解为什么它会违背我的期望。在我的“真实”代码中，我想始终知道该`RunWorkerCompleted`方法是在主线程上调用的。

我设法`form.Show();`在我的命令中指出问题`BackgroundTesterBtn`- 如果我`ShowDialog()`改用，我没有问题（`RunWorkerCompleted`总是在主线程上运行）。我确实需要`Show()`在我的 ArcMap 项目中使用，这样用户就不会被绑定到表单。

我还尝试在普通的 WinForms 项目中重现该错误。我添加了一个简单的项目，它只打开没有 ArcMap 的第一个表单，但在那种情况下，我无法重现错误 - 在`RunWorkerCompleted`主线程上运行，无论是我使用`Show()`还是`ShowDialog()`打开之前和之后`Form2`。我尝试在 my 之前添加第三种形式作为主要形式`Form1`，但它并没有改变结果。

[这](http://depositfiles.com/files/1cu4o0493)是我的简单 sln (VS2005sp1) - 它需要

ESRI.ArcGIS.ADF(9.2.4.1420)

ESRI.ArcGIS.ArcMapUI(9.2.3.1380)

ESRI.ArcGIS.SystemUI (9.2.3.1380)

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-04T04:32:00.683

> 重点不是`OnWorkCompleted`要在主线程上调用吗？为什么它不能按预期工作？

不，这不对。
你不能在任何旧线程上运行任何旧东西。线程不是礼貌的对象，您可以简单地说“请运行它”。

更好的线程心智模型是货运列车。一旦开始，它就会走上自己的轨道。你不能改变它的路线或停止它。如果你想影响它，你要么必须等到它到达下一个火车站（例如：让它手动检查某些事件），要么让它脱轨（`Thread.Abort`CrossThread 异常的后果与让火车脱轨的后果大致相同。. 。 谨防！）。

Winforms 控件*有点*支持这种行为（它们可以`Control.BeginInvoke`让您在 UI 线程上运行任何功能），但这只是因为它们在 Windows UI 消息泵中有一个特殊的挂钩并编写了一些特殊的处理程序。按照上面的类比，他们的火车会在车站登​​记并定期寻找新的方向，您可以使用该设施发布您自己的方向。

它`BackgroundWorker`被设计为通用目的（它不能绑定到 Windows GUI），因此它不能使用 Windows`Control.BeginInvoke`功能。它必须假设你的主线程是一个不可阻挡的“火车”做它自己的事情，所以完成的事件必须在工作线程中运行或根本不运行。

但是，当您使用 winforms 时，在您的处理程序中，您可以使用我上面提到的功能`OnWorkCompleted`让 Window 执行*另一个*回调。`BeginInvoke`像这样：

```
// Assume we're running in a windows forms button click so we have access to the 
// form object in the "this" variable.
void OnButton_Click(object sender, EventArgs e )
    var b = new BackgroundWorker();
    b.DoWork += ... blah blah

    // attach an anonymous function to the completed event.
    // when this function fires in the worker thread, it will ask the form (this)
    // to execute the WorkCompleteCallback on the UI thread.
    // when the form has some spare time, it will run your function, and 
    // you can do all the stuff that you want
    b.RunWorkerCompleted += (s, e) { this.BeginInvoke(WorkCompleteCallback); }
    b.RunWorkerAsync(); // GO!
}

void WorkCompleteCallback()
{
    Button.Enabled = false;
    //other stuff that only works in the UI thread
} 
```

[另外，不要忘记这一点：](http://msdn.microsoft.com/en-us/library/system.componentmodel.runworkercompletedeventargs.result.aspx)

> 您的 RunWorkerCompleted 事件处理程序应始终在访问 Result 属性之前检查 Error 和 Canceled 属性。如果引发异常或取消操作，则访问 Result 属性会引发异常。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-04T04:49:52.073

`BackgroundWorker`检查委托实例是否指向支持接口的类`ISynchronizeInvoke`。您的 DAL 层可能没有实现该接口。通常，您会使用`BackgroundWorker`on a `Form`，它确实支持该接口。

如果您想`BackgroundWorker`从 DAL 层使用并想从那里更新 UI，您有三个选项：

*   你会一直调用这个`Invoke`方法
*   在 DAL 类上实现接口`ISynchronizeInvoke`，并手动重定向调用（它只有三个方法和一个属性）
*   在调用`BackgroundWorker`（因此，在 UI 线程上）之前，调用`SynchronizationContext.Current`内容实例并将其保存在实例变量中。然后`SynchronizationContext`将为您提供`Send`方法，该方法将完全执行该`Invoke`操作。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-22T13:26:43.323

它看起来像一个错误：

[http://connect.microsoft.com/VisualStudio/feedback/ViewFeedback.aspx?FeedbackID=116930](http://connect.microsoft.com/VisualStudio/feedback/ViewFeedback.aspx?FeedbackID=116930)

[http://thedatafarm.com/devlifeblog/archive/2005/12/21/39532.aspx](http://thedatafarm.com/devlifeblog/archive/2005/12/21/39532.aspx)

所以我建议使用防弹（伪代码）：

```
if(control.InvokeRequired)
  control.Invoke(Action);
else
  Action() 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-04T04:51:55.173

避免 GUI 中的跨线程问题的最佳方法是[使用 SynchronizationContext](http://www.lostechies.com/blogs/gabrielschenker/archive/2009/01/23/synchronizing-calls-to-the-ui-in-a-multi-threaded-application.aspx)。

# c# - 数据绑定到我在 .Net 2.0 中创建的属性

> ID：818770
> 
> 赞同：1
> 
> 时间：2009-05-04T04:23:32.013
> 
> 标签：c#, data-binding, .net-2.0

我正在.Net 2.0 中进行一些绑定。一直很麻烦！我有一个带有 BindingSource 的 DataTable（我试图使用 DataRow，但它没有）和一个 BindingNavigator（这似乎是神奇的成分），并且我正在以编程方式将控件绑定到它。不过，我的专栏之一是一个我当然不想向用户显示的 ID，但我仍然需要易于访问。因为我使用 ID 对数据库进行更多调用，所以我希望它在更改时也进行这些调用。

我的想法是以适当类型的表单代码创建我自己的属性，然后绑定到它。这不起作用，即使使用相同的代码绑定到文本框属性也是如此。为什么不？

这是我的 UserControl 中的一些代码，因此您可以看到我在做什么：

```
Guid SetID { get; set; }

//...

DataTable SetTable = DatabaseObject.GetDataTable(tablename)
SetTable.DefaultView.Sort = "DisplayName ASC";
SetBinder.DataSource = SetTable;
foreach (DataColumn column in SetTable.Columns)
        {
            if (!Controls.ContainsKey("in" + column.ColumnName)) continue;
            //This code's mostly here so I don't have to have a list of controls
            //with bindings for each when it's mostly the same for all of them.
            Controls["in" + column.ColumnName].DataBindings.Add("Text", SetBinder, column.ColumnName);
        }
this.DataBindings.Add("SetID", SetBinder, "SetID"); //doesn't work 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-04T05:31:29.790

我解决了：该属性需要是公共的，并且您需要将 BindableAttribute 添加到该属性中，如下所示：

```
[Bindable(true)]
public Guid SetID { get; set; } 
```

# css - 如何创建灵活的圆角？

> ID：818776
> 
> 赞同：2
> 
> 时间：2009-05-04T04:27:08.963
> 
> 标签：css, html

[![创建灵活的角落](https://i.stack.imgur.com/e6J82.jpg)](https://i.stack.imgur.com/e6J82.jpg)

我想创建基于 DIV 的灵活角。如图所示。这不是常规的圆角，而是更复杂的东西。这有点像**挑战** 。

请**注意**，我想要基于图像的圆角，所以请根据要求给出答案。

多谢

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-04T04:44:06.923

好吧，最简单的答案是：使用 CSS3：

```
#roundedCornerDiv {
    -moz-border-radius: 1em;     /* for mozilla-based browsers */
    -webkit-border-radius: 1em;  /* for webkit-based browsers */
    border-radius: 1em;          /* theoretically for *all* browsers
                                    dependant on implementation of CSS3 */
    border: 12px solid #ccc;
} 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-04T04:32:34.393

您应该能够使用 9 个显式大小和浮动的 div 来做到这一点。角落 div 的大小是固定的，并且有 4 个角落的背景 url，侧面 div 是重复 y，顶部底部 div 有重复 x

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-04T04:43:25.727

您可以使用一系列跨度和 4 个图像（每个角一个）来制作可调整大小的圆角 div。像这样：

```
div {
    background: white url(topleft.gif) top left no-repeat;
}

div span {
    display: block;
    background: url(topright.gif) top right no-repeat;
}

div span span {
    background: url(bottomright.gif) bottom right no-repeat;
}

div span span span {
    padding: 2em;
    height: 0; /* fixes a padding bug in IE */
    background: url(bottomleft.gif) bottom left no-repeat;
}

div span span > span {
    height: auto; /* sets the height back to auto for all other browsers */
} 
```

现在对于 HTML：

```
<div><span><span><span>Round corners!</span></span></span></div> 
```

有关实际示例和代码，请参阅[此页面](http://htmldog.com/examples/images3_3.html)以获取工作示例和源代码。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-04T05:43:36.750

您应该为此[研究 Thrashbox](http://www.vertexwerks.com/tests/sidebox/)方法。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-01-16T12:50:05.213

```
border-radius: 10px 10px 10px 10px; 
```

首先是左上角。第二个是右上角。第三个是右下角。第四个是左下角。

你基本上可以在任何你想要圆角的标签中使用它。只记得指定边框，如：

```
border: 2px solid black; 
```

如果您单独指定边框，例如：

```
border-left: 6px;
border-right: 6px;
border-top: 2px;
border-bottom: 2px; 
```

你可以得到一些看起来很棒的东西。

# c# - 从对话框返回值

> ID：818785
> 
> 赞同：3
> 
> 时间：2009-05-04T04:33:57.697
> 
> 标签：c#

如何以模态对话框形式发送和返回值

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-04T04:50:23.773

试试这个。它被设计为与 MessageBox 相对应。不过，它不会根据操作系统更改其样式。它看起来像Vista的。

这是它的一个实际示例，来自它的原始主页（Paint.NET 插件）。它将扩展以适应提示。

![](https://i185.photobucket.com/albums/x302/illusionaryz/inputboxexample.png)

输入框.cs：

```
 internal partial class InputBoxForm : Form
    {
        Size lbltextoriginalsize;
        Size pnlwhiteoroginalsize;
        public InputBoxForm(string text, string defaultvalue, string caption)
        {
            InitializeComponent();
            this.pnlWhite.Resize += new System.EventHandler(this.pnlWhite_Resize);
            this.lblText.Resize += new System.EventHandler(this.lblText_Resize);
            picIcon.Image = SystemIcons.Question.ToBitmap();
            lbltextoriginalsize = lblText.Size;
            pnlwhiteoroginalsize = pnlWhite.Size;
            this.lblText.Text = text;
            this.txtOut.Text = defaultvalue;
            this.Text = caption;
        }

        private void lblText_Resize(object sender, EventArgs e)
        {
            pnlWhite.Size += lblText.Size - lbltextoriginalsize;
        }

        private void pnlWhite_Resize(object sender, EventArgs e)
        {
            this.Size += pnlWhite.Size - pnlwhiteoroginalsize;
        }

        public string Value
        {
            get { return txtOut.Text; }
        }
    }

    /// 
    /// A counterpart to the MessageBox class, designed to look similar (at least on Vista)
    /// 
    public static class InputBox
    {
        public static DialogResult Show(string text, out string result)
        {
            return ShowCore(null, text, null, null, out result);
        }
        public static DialogResult Show(IWin32Window owner, string text, out string result)
        {
            return ShowCore(owner, text, null, null, out result);
        }
        public static DialogResult Show(string text, string defaultValue, out string result)
        {
            return ShowCore(null, text, defaultValue, null, out result);
        }
        public static DialogResult Show(IWin32Window owner, string text, string defaultValue, out string result)
        {
            return ShowCore(owner, text, defaultValue, null, out result);
        }
        public static DialogResult Show(string text, string defaultValue, string caption, out string result)
        {
            return ShowCore(null, text, defaultValue, caption, out result);
        }
        public static DialogResult Show(IWin32Window owner, string text, string defaultValue, string caption, out string result)
        {
            return ShowCore(owner, text, defaultValue, caption, out result);
        }

        private static DialogResult ShowCore(IWin32Window owner, string text, string defaultValue, string caption, out string result)
        {
            InputBoxForm box = new InputBoxForm(text, defaultValue, caption);
            DialogResult retval = box.ShowDialog(owner);
            result = box.Value;
            return retval;
        }
    } 
```

输入框.Designer.cs：

```
 partial class InputBoxForm
    {
        /// 
        /// Required designer variable.
        /// 
        private System.ComponentModel.IContainer components = null;

        /// 
        /// Clean up any resources being used.
        /// 
        /// true if managed resources should be disposed; otherwise, false.
        protected override void Dispose(bool disposing)
        {
            if (disposing && (components != null))
            {
                components.Dispose();
            }
            base.Dispose(disposing);
        }

        #region Windows Form Designer generated code

        /// 
        /// Required method for Designer support - do not modify
        /// the contents of this method with the code editor.
        /// 
        private void InitializeComponent()
        {
            this.pnlWhite = new System.Windows.Forms.Panel();
            this.lblText = new System.Windows.Forms.Label();
            this.picIcon = new System.Windows.Forms.PictureBox();
            this.txtOut = new System.Windows.Forms.TextBox();
            this.btnOK = new System.Windows.Forms.Button();
            this.btnCancel = new System.Windows.Forms.Button();
            this.pnlWhite.SuspendLayout();
            ((System.ComponentModel.ISupportInitialize)(this.picIcon)).BeginInit();
            this.SuspendLayout();
            // 
            // pnlWhite
            // 
            this.pnlWhite.Anchor = ((System.Windows.Forms.AnchorStyles)((((System.Windows.Forms.AnchorStyles.Top | System.Windows.Forms.AnchorStyles.Bottom)
                        | System.Windows.Forms.AnchorStyles.Left)
                        | System.Windows.Forms.AnchorStyles.Right)));
            this.pnlWhite.BackColor = System.Drawing.Color.White;
            this.pnlWhite.Controls.Add(this.lblText);
            this.pnlWhite.Controls.Add(this.picIcon);
            this.pnlWhite.Controls.Add(this.txtOut);
            this.pnlWhite.Location = new System.Drawing.Point(0, 0);
            this.pnlWhite.Margin = new System.Windows.Forms.Padding(0);
            this.pnlWhite.MinimumSize = new System.Drawing.Size(235, 84);
            this.pnlWhite.Name = "pnlWhite";
            this.pnlWhite.Size = new System.Drawing.Size(235, 84);
            this.pnlWhite.TabIndex = 0;
            // 
            // lblText
            // 
            this.lblText.Anchor = ((System.Windows.Forms.AnchorStyles)(((System.Windows.Forms.AnchorStyles.Top | System.Windows.Forms.AnchorStyles.Bottom)
                        | System.Windows.Forms.AnchorStyles.Left)));
            this.lblText.AutoSize = true;
            this.lblText.Location = new System.Drawing.Point(64, 26);
            this.lblText.Margin = new System.Windows.Forms.Padding(3, 0, 30, 30);
            this.lblText.MinimumSize = new System.Drawing.Size(159, 0);
            this.lblText.Name = "lblText";
            this.lblText.Size = new System.Drawing.Size(159, 13);
            this.lblText.TabIndex = 2;
            // 
            // picIcon
            // 
            this.picIcon.BackColor = System.Drawing.Color.White;
            this.picIcon.Location = new System.Drawing.Point(25, 26);
            this.picIcon.Name = "picIcon";
            this.picIcon.Size = new System.Drawing.Size(32, 32);
            this.picIcon.TabIndex = 1;
            this.picIcon.TabStop = false;
            // 
            // txtOut
            // 
            this.txtOut.Anchor = ((System.Windows.Forms.AnchorStyles)(((System.Windows.Forms.AnchorStyles.Bottom | System.Windows.Forms.AnchorStyles.Left)
                        | System.Windows.Forms.AnchorStyles.Right)));
            this.txtOut.Location = new System.Drawing.Point(67, 50);
            this.txtOut.Name = "txtOut";
            this.txtOut.Size = new System.Drawing.Size(159, 20);
            this.txtOut.TabIndex = 5;
            // 
            // btnOK
            // 
            this.btnOK.Anchor = ((System.Windows.Forms.AnchorStyles)((System.Windows.Forms.AnchorStyles.Bottom | System.Windows.Forms.AnchorStyles.Right)));
            this.btnOK.DialogResult = System.Windows.Forms.DialogResult.OK;
            this.btnOK.Location = new System.Drawing.Point(42, 96);
            this.btnOK.Name = "btnOK";
            this.btnOK.Size = new System.Drawing.Size(88, 26);
            this.btnOK.TabIndex = 3;
            this.btnOK.Text = "OK";
            this.btnOK.UseVisualStyleBackColor = true;
            // 
            // btnCancel
            // 
            this.btnCancel.Anchor = ((System.Windows.Forms.AnchorStyles)((System.Windows.Forms.AnchorStyles.Bottom | System.Windows.Forms.AnchorStyles.Right)));
            this.btnCancel.DialogResult = System.Windows.Forms.DialogResult.Cancel;
            this.btnCancel.Location = new System.Drawing.Point(138, 96);
            this.btnCancel.Name = "btnCancel";
            this.btnCancel.Size = new System.Drawing.Size(88, 26);
            this.btnCancel.TabIndex = 4;
            this.btnCancel.Text = "Cancel";
            this.btnCancel.UseVisualStyleBackColor = true;
            // 
            // InputBoxForm
            // 
            this.AcceptButton = this.btnOK;
            this.AutoScaleDimensions = new System.Drawing.SizeF(6F, 13F);
            this.AutoScaleMode = System.Windows.Forms.AutoScaleMode.Font;
            this.CancelButton = this.btnCancel;
            this.ClientSize = new System.Drawing.Size(235, 133);
            this.Controls.Add(this.btnCancel);
            this.Controls.Add(this.btnOK);
            this.Controls.Add(this.pnlWhite);
            this.FormBorderStyle = System.Windows.Forms.FormBorderStyle.FixedSingle;
            this.MaximizeBox = false;
            this.MinimizeBox = false;
            this.Name = "InputBoxForm";
            this.ShowIcon = false;
            this.ShowInTaskbar = false;
            this.StartPosition = System.Windows.Forms.FormStartPosition.CenterScreen;
            this.pnlWhite.ResumeLayout(false);
            this.pnlWhite.PerformLayout();
            ((System.ComponentModel.ISupportInitialize)(this.picIcon)).EndInit();
            this.ResumeLayout(false);

        }

        #endregion

        private System.Windows.Forms.Panel pnlWhite;
        private System.Windows.Forms.PictureBox picIcon;
        private System.Windows.Forms.Label lblText;
        private System.Windows.Forms.Button btnOK;
        private System.Windows.Forms.Button btnCancel;
        private System.Windows.Forms.TextBox txtOut;
    }
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-04T04:41:57.337

我通常会这样做：

```
public class MyInputDialog : Form {
   public static string Execute(string Prompt) {
      using (var f = new MyInputDialog() ) {
         f.lblPrompt.Text = Prompt;
         f.ShowModal();
         return f.txtInput.Text;
      }
   }
} 
```

忽略所有的错误处理，如果用户取消等等。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-14T13:29:26.850

我建议你`Interaction.InputBox`（`Microsoft.VisualBasic`需要参考）：

```
inputValue = Interaction.InputBox("Text for the prompt", "Title of the dialog", ""); 
```

当用户按下取消时，`inputValue`将是`""`.

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-11-28T23:41:36.253

这就是我调用对话框的方式

```
 var regStoreForm = new RegisterStoreForm(storeID,password);
            if (regStoreForm.ShowDialog(this) == DialogResult.OK)
            {
                storeID = regStoreForm.StoreId;
                password = regStoreForm.StorePassword;
            };
            regStoreForm.Dispose(); 
```

这就是对话框的样子

```
 public partial class RegisterStoreForm : Form
    {
        public int StoreId { get; set; }
        public String StorePassword { get; set; }

        public RegisterStoreForm(int storeId,string password)
        {
            InitializeComponent();
            StoreId = storeId;
            StorePassword = password;
            this.textBoxPassword.Text = StorePassword;
            this.textBoxStoreId.Text = StoreId.ToString();
        }

        private void OKbutton_Click(object sender, EventArgs e)
        {
            StoreId = Convert.ToInt16(textBoxStoreId.Text);
            StorePassword = textBoxPassword.Text;
            this.DialogResult = DialogResult.OK;
            this.Close();
        }
    } 
```

# memory-management - 关于 N 路集关联缓存步数的信息

> ID：818791
> 
> 赞同：6
> 
> 时间：2009-05-04T04:39:18.030
> 
> 标签：memory-management, caching, operating-system, systems-programming

我在 Internet 上访问的一些资源对集合[关联缓存](http://en.wikipedia.org/wiki/CPU_cache#Associativity)的工作方式存在分歧。

例如，硬件机密似乎相信它是这样工作的：

> 然后主 RAM 内存被划分为内存缓存中可用的相同数量的块。保持 512 KB 的 4 路组关联示例，主 RAM 将分为 2,048 个块，与内存高速缓存中可用的块数相同。每个内存块都链接到缓存内的一组行，就像在直接映射缓存中一样。

[http://www.hardwaresecrets.com/printpage/481/8](http://www.hardwaresecrets.com/printpage/481/8)

他们似乎在说每个缓存块（4 个缓存行）映射到一个特定的连续 RAM 块。他们说不连续的系统内存（RAM）块*不能*映射到同一个缓存块。

这是hardwaresecrets认为它如何工作的图片 [http://www.hardwaresecrets.com/fullimage.php?image=7864](http://www.hardwaresecrets.com/fullimage.php?image=7864)

与维基百科的设置关联缓存图片对比 [http://upload.wikimedia.org/wikipedia/commons/9/93/Cache%2Cassociative-fill-both.png](http://upload.wikimedia.org/wikipedia/commons/9/93/Cache%2Cassociative-fill-both.png)。

布朗不同意硬件秘密

> 考虑一下如果每个高速缓存行有两组字段会发生什么：两个有效位、两个脏位、两个标记字段和两个数据字段。一组字段可以为主内存的一个区域缓存数据，而另一组字段可以为恰好映射到同一缓存行的另一个区域缓存数据。

[http://www.spsu.edu/cs/faculty/bbrown/web_lectures/cache/](http://www.spsu.edu/cs/faculty/bbrown/web_lectures/cache/)

也就是说，系统内存的非连续块*可以*映射到同一个高速缓存块。

系统内存上的非连续块和缓存块之间的关系是如何创建的。我在某处读到这些关系是基于缓存步长的，但是除了它们存在之外，我找不到任何关于缓存步长的信息。

谁是对的？如果实际使用跨步，跨步是如何工作的，我是否有正确的技术名称？如何找到特定系统的步幅？它是基于寻呼系统的吗？有人可以指出一个详细解释 N 路集关联缓存的 url 吗？

另见： [http ://www.cs.umd.edu/class/sum2003/cmsc311/Notes/Memory/set.html](http://www.cs.umd.edu/class/sum2003/cmsc311/Notes/Memory/set.html)

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-05-04T05:42:21.713

当我向我的学生教授缓存内存架构时，我会从直接映射缓存开始。一旦理解了这一点，您就可以将 N 路组关联缓存视为直接映射缓存的并行块。要了解这两个数字可能都是正确的，您需要首先了解 set-assoc 缓存的用途。

它们旨在解决直接映射缓存中的“别名”问题，其中多个内存位置可以映射到特定的缓存条目。这在 Wikipedia 图中进行了说明。因此，我们可以使用 N 路缓存来存储其他“别名”内存位置，而不是逐出缓存条目。

实际上，硬件机密图是正确的，假设替换顺序是主内存的第一个块映射到 Way-1，然后第二个块映射到 Way-2，依此类推。然而，同样有可能将第一块主内存分布在多个 Way 上。

希望这个解释有帮助！

PS：利用空间局部性，仅单个高速缓存行需要连续的内存位置。至于你问题的后半部分，我相信你可能会混淆几个不同的概念。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-02-10T12:40:49.880

> 替换策略决定了主内存的特定条目的副本将在缓存中的哪个位置。如果替换策略可以自由选择缓存中的任何条目来保存副本，则缓存称为完全关联的。在另一个极端，如果主内存中的每个条目只能进入缓存中的一个位置，则缓存是直接映射的。许多缓存实现了一种折衷方案，其中主内存中的每个条目都可以到达缓存中的 N 个位置中的任何一个，并被描述为 N 路集合关联

# language-agnostic - 使用右移和按位与查找二进制数的模式？

> ID：818800
> 
> 赞同：2
> 
> 时间：2009-05-04T04:44:43.273
> 
> 标签：language-agnostic, bit-manipulation

我正在尝试在汇编中编写一个函数，该函数将检测较长的二进制数是否包含较小的二进制模式。

示例：**100111**
是否包含**1001**？

 ****当我读到这个问题时，我想我会在每次循环中右移（逻辑）时对大数字及其较小的模式进行按位与运算。

所以，在我的脑海里，我认为它会这样做：

```
100111 AND 1001 = 0  
Shift-right 1  
010011 AND 1001 = 0  
Shift-right 1  
001001 AND 1001 = 1 // Pattern FOUND! 
```

并重复此操作，直到数字移动到零或 AND 返回 1。

但是，我想我一定有些困惑，因为在循环的第一次运行中，对于我放入的大多数内容，这将返回 1。我对 AND 的用法感到困惑吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-04T04:59:04.940

问题是“部分匹配”也会为您的 AND 检查返回一个非零值：

```
100111 AND 001001 = 000001 
```

因此，这会测试是否*有任何*位匹配，但您要确保*所有*位都相同。AND 的结果需要等于您正在搜索的模式：

```
x = 100111
if (x AND 1001 == 1001)
  print "found" 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-04T04:55:56.803

您应该 AND 然后针对搜索模式进行测试：

```
if ((TestPattern & SearchPattern) == SearchPattern)
{
   // then match
} 
```

（其中`&`表示按位`AND`）

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-04T04:58:23.787

按位与不能按您期望的方式工作（从样本判断并忽略似乎暗示您使用按位与作为位的逻辑与的符号）。AND 仅“考虑”设置为 1 的位。例如 1111 和 1001 == 1001。

您需要使用 XOR 并与 0 进行比较以进行匹配（请记住掩码您未从结果中比较的位）。在您的示例中，当 (N ^ 1001) & 1111 == 0000 时找到匹配项

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2010-02-22T17:13:41.980

为了确保 0 和 1 位都与您的搜索模式匹配，您需要执行以下操作：

```
if ((InputPattern AND SearchMask) == SearchPattern)
{
    // then match
} 
```

应该是全`SearchMask`1 位，长度等于您的 SearchPattern。例如，您可以拥有`SearchMask == 1111, SearchPattern == 1001`.

# asp.net - 如何连接两个项目

> ID：818813
> 
> 赞同：0
> 
> 时间：2009-05-04T04:55:44.557
> 
> 标签：asp.net, vb.net

我在 Visual Studio 2005 中有一个名为“slnAllForKids”的项目。我还有另一个名为“AFKLogin”的项目。在 slnAllForKids 中有一个名为 index.aspx 的页面。当我单击 index.aspx 中的提交按钮时，我想在 AFKLogin 中从 index.aspx 重定向到 home.aspx。任何人都可以帮助重定向到另一个 sln 吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-04T05:17:59.370

嗯...您并没有真正重定向到另一个 SLN，而是重定向到另一个 URL，对吗？部署项目后，这两个页面将具有不同的 URL。

您可以使用类似的行重定向到另一个 URL

```
Response.Redirect("http://www.example.com/home.aspx") 
```

# database - 为什么在线的完整数据库模式示例如此之少？

> ID：818815
> 
> 赞同：10
> 
> 时间：2009-05-04T04:56:24.977
> 
> 标签：database, database-design, schema, sample

数据库模式示例对我来说有点奇怪，我认为大多数项目都需要为其设计数据库。但是当我尝试在线查找示例时，它真的很少见（例如，用于库存管理、学校管理、人力资源管理的完整数据库模式）。我知道每个数据库设计都取决于项目要求，但我认为没有太大不同。

我只是想知道为什么很少有人把它作为其他源代码在网上踢。

谁能指出我在哪里得到它或任何建议？

提前致谢

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-05-04T14:49:49.760

这必须是数据库模式上的[ueber-list](http://www.databaseanswers.org/data_models/)。这是亚马逊上一个[有趣的阅读清单](http://www.amazon.com/Data-Modeling-and-Warehouse/lm/38DZKQSFK9NTO/ref=cm_lmt_srch_f_2_rsrsrs0)。我可以推荐 Len Silverston 的书。他们会让你开始。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-04T05:16:44.600

我想说，那里有很多数据库模式。

SQL Server 7/2000 附带“pubs”和“Northwind”，您仍然可以从 CodePlex 下载它们。

SQL Server 2005 与 AdventureWorks 一起提供，它非常广泛并且有各种版本（OLTP、OLAP、Light）——也可从 CodePlex 获得。

许多博主都有用于他们的博客和截屏视频的示例数据库，例如，[Rob Bagby](http://blogs.msdn.com/bags/)在他的博客上有一个用于学校数据和一个用于酿酒厂的数据库。

Codeplex 上还有更多（旨在最终摆脱使用臭名昭著的 Northwind 数据库进行演示）。

马克

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-04T05:32:24.157

为什么不查看架构的开源项目以及使用它们的代码呢？对于 CMS 模式，有 Wordpress、Drupal 和无数其他模式，对于 CRM 模式、SugarCRM 等。

# java - 为什么我的 UUID 使用了太多时间？

> ID：818819
> 
> 赞同：0
> 
> 时间：2009-05-04T04:58:50.947
> 
> 标签：java, uuid, jdk1.5

```
String s = UUID.randomUUID().toString(); 
return s.substring(0,8) + s.substring(9,13) + s.substring(14,18) +
       s.substring(19,23) + s.substring(24); 
```

我使用 JDK1.5 的 UUID，但是当我从网络连接/断开连接时它使用了太多时间。
我认为 UUID 可能想要访问一些网络。
有谁能够帮我？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-04T05:36:48.407

UUID 生成在本地完成，不需要任何活动的网络连接。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-04T08:25:25.660

引用[API odc](http://java.sun.com/j2se/1.5.0/docs/api/java/util/UUID.html#randomUUID())：

> ```
> public static UUID randomUUID() 
> ```
> 
> 用于检索类型 4（伪随机生成）UUID 的静态工厂。UUID 是使用加密强的伪随机数生成器生成的。

您的延迟可能是由加密强 RNG 的初始化引起的 - 这需要一些时间，甚至可能取决于网络连接的存在作为熵的来源。但是，这应该只在 JVM 运行时发生一次。不过，我看不出解决这个问题的方法。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-06T21:14:11.693

这些 s.substring 调用的目的是什么？看起来您正在返回原始字符串。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2011-12-13T20:33:58.023

对于旧版本的 Java（可能是 6 或更早版本？），Random 中存在一个错误，导致它遍历整个临时目录。我们已经看到在 NVIDIA 的一些非常糟糕的构建机器上生成种子需要 10 分钟。您可能想检查临时目录的大小。

比较： http: [//www.docjar.com/html/api/sun/security/provider/SeedGenerator.java.html](http://www.docjar.com/html/api/sun/security/provider/SeedGenerator.java.html) 到：[http ://www.java2s.com/Open-Source/Java-Document/6.0-JDK -模块/j2me/sun/security/provider/SeedGenerator.java.htm](http://www.java2s.com/Open-Source/Java-Document/6.0-JDK-Modules/j2me/sun/security/provider/SeedGenerator.java.htm)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-04T07:51:44.650

UUID 的 javadoc [http://java.sun.com/j2se/1.5.0/docs/api/java/util/UUID.html](http://java.sun.com/j2se/1.5.0/docs/api/java/util/UUID.html)有一些关于如何生成 UUID 的好信息。它使用时间和时钟频率来生成 UUID。就像尖牙所说，不需要网络接口。是否有其他可能导致此问题的并发进程正在运行？

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-10-30T15:02:06.653

如果您在大量数据上附加 5 个字符串，则可能是问题所在。尝试使用 StringBuffer。将 1-2 个以上的字符串连接在一起时会产生惊人的差异，尤其是对于较大的数据集

# myspace - MySpace 登录网址？

> ID：818821
> 
> 赞同：0
> 
> 时间：2009-05-04T04:59:21.397
> 
> 标签：myspace

我想允许用户直接从 URL 登录 MySpace？

我看到当 MySpace 提交其登录表单时，它会转到：

[https://secure.myspace.com/index.cfm?fuseaction=login.process](https://secure.myspace.com/index.cfm?fuseaction=login.process)

但我需要添加所有隐藏参数以及登录文本框和密码文本框。

有人已经这样做了吗？

我知道我会这样做：[https://secure.myspace.com/index.cfm?fuseaction=login.process&ctl00_ctl00_cpMain_cpMain_LoginBox_Email_Textbox_Label=](https://secure.myspace.com/index.cfm?fuseaction=login.process&ctl00_ctl00_cpMain_cpMain_LoginBox_Email_Textbox_Label=) &ctl00$ctl00$cpMain$cpMain$LoginBox$Password_Textbox=

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-04T05:04:09.170

考虑到这对安全的影响，我希望不能这样做。

但是您可以尝试抓取所有表单元素/表单标签和输入等并将表单的操作属性更改为完全限定的绝对路径。

```
<form action="https://secure.myspace.com/index.cfm?fuseaction=login.process" method="post"> 
```

# uml - 在 TinyUML 中绘制组件图

> ID：818822
> 
> 赞同：0
> 
> 时间：2009-05-04T04:59:37.137
> 
> 标签：uml, components, graphviz, dot

我正在扩展一个小型应用程序，该应用程序使用“点”工具来绘制 UML 类和状态图，以实现组件图（我遇到了很多问题来适应 UML 2.x 符号）。

我打算通过使用棒棒糖符号来显示特定组件需要和提供的接口。现在尝试这样做时，我无法将两个节点之间的边缘显示为直线。即使我能够将一条边显示为直边，我也无法为所有边保持该状态。

只是想知道除了重量，len（对于neato），k等通常的属性之外还有什么特别的方法吗？（或者您可能建议的任何其他工具？）感谢您的帮助。

最好的，

阿伦

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-04T05:25:31.070

抱歉，我从未使用过 TinyUML，但当您询问任何其他工具建议时，让我告诉您，我对使用[StarUML](http://staruml.sourceforge.net/en/)（开源）非常满意。

# database - django AuditTrail vs Reversion

> ID：818823
> 
> 赞同：18
> 
> 时间：2009-05-04T05:02:35.383
> 
> 标签：database, django, audit, audit-trail, reversion

我正在开发一个新的网络应用程序，我需要将数据库中的任何更改存储到审计表中。此类审计表的目的是，稍后在实际的物理审计中，我们可以确定在某种情况下发生了什么，谁编辑了什么以及在进行复杂计算时 db 的状态是什么。所以大多数审计表将被写入而不是读取。有时可能会生成报告。

我一直在寻找可用的解决方案

1.  [AuditTrail](https://code.djangoproject.com/wiki/AuditTrail) - 简单，这就是我倾向于它的原因，我可以理解它的单个文件代码。
2.  [Reversion](https://github.com/etianen/django-reversion) - 看起来使用起来很简单，但不确定如果需要修改它会有多容易。
3.  [rcsField](http://code.google.com/p/django-rcsfield/) 似乎非常复杂，对我的需求来说太多了

我还没有尝试过这些，所以我想知道一些真实的经验以及我应该使用哪一个。例如，哪一个更快使用更少的空间，易于扩展和维护？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-05-04T15:10:02.973

就我个人而言，我更喜欢在数据库中创建审计表并通过触发器进行填充，以便存储任何更改，甚至是来自查询窗口的临时查询。我永远不会考虑不基于数据库本身的审计解决方案。这很重要，因为对数据库进行恶意更改或进行欺诈的人不太可能通过 Web 界面而是直接在后端这样做。与外部黑客相比，这些事情更多来自心怀不满或盗窃的员工。如果您已经在使用 ORM，那么您的数据将面临风险，因为权限位于表级别而不是它们所属的 sp 级别。因此，更重要的是您要捕获对 dat 的任何可能更改，而不仅仅是来自 GUI 的更改。我们有一个动态过程来创建审计表，只要将新表添加到数据库中就会运行。由于我们的审计表只填充更改而不是整个记录，因此我们不需要在每次添加字段时都更改它们。

此外，在评估可能的解决方案时，请确保您考虑恢复数据以撤消特定更改的难度。一旦你有了审计表，你会发现这是你需要做的最重要的事情之一。还要考虑在数据库模式更改时维护信息的难度。

选择一个解决方案，因为它似乎是最容易理解的，通常不是一个好主意。在满足要求、安全性等之后，这应该是您选择标准中最低的。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-04T07:28:12.227

我无法为您提供其中任何一个的真实经验，但想进行观察。

我假设 AuditTrail 是指[Django wiki 上的 AuditTrail](http://code.djangoproject.com/wiki/AuditTrail)。如果是这样，我想你会想看看`HistoricalRecords`由同一作者（Marty Alchin aka @gulopine）在他的书[Pro Django](https://rads.stackoverflow.com/amzn/click/com/1430210478)中开发的。它应该与 Django 1.x 一起工作得更好。

这是我将在即将到来的项目中使用的方法，不是因为它从技术角度必然优于其他方法，而是因为它符合该应用程序审计跟踪的“真实世界”期望。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-17T06:35:11.830

正如我在我的问题中所说，rcField 似乎满足了我的需求，这很简单，我想将任何更改存储到我的表中，并且稍后可能会返回这些更改以生成一些报告。

所以我测试了 AuditTrail 和 Reversion Reversion 似乎是一个更好的完整应用程序，具有许多功能（我不需要），据我所知，它以 XML 或 YAML 格式将数据保存在单个表中，我认为

1.  将在单个表中生成太多数据
2.  要读取该数据，我可能无法使用已经存在的数据库工具。

AuditTrail 在这方面胜出，它为每个表生成一个相应的审计表，因此可以轻松跟踪更改，每个表的数据更少，并且可以轻松操作和用户生成报告。

所以我要使用 AuditTrail。

# c# - 从 C# 生成的 Actionscript 代理枚举的使用

> ID：818826
> 
> 赞同：0
> 
> 时间：2009-05-04T05:04:31.510
> 
> 标签：c#, actionscript-3, interop, enums

对不起，如果标题不清楚 - 不知道如何表达它。随意编辑它。

我有一个用 C# 编写的 Web 服务，它使用枚举。当我使用 Flash 使用这个 web 服务时，我让 Flex 生成代理类 - 它也在 Actionscript 中生成所述枚举。我的问题是我不知道如何使用这个生成的 Actionscript。

C# 枚举：

```
public enum ImageType
{
    None = 0,
    Png = 1,
    Jpg = 2,
    Gif = 3
} 
```

Actionscript 生成的代理类（无法更改）：

```
public class ImageType
{
    public function ImageType() {}
    [Inspectable(category="Generated values", eumeration="None,Png,Jpg,Gif", type="String")]
    public var _ImageType:String;public function toString():String
    {
        return _ImageType.toString();
    }
} 
```

Actionscript 使用示例（即它在我的大脑中应该如何工作）：

```
var imgType:ImageType = ImageType.Png; //this does not actually work though 
```

注意：代码仅为示例，但结构相同。

我将如何在 Actionscript 中使用这个 ImageType 枚举？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-04T05:23:48.437

AS3 不支持枚举。我不确定这个生成的代理类的意义是什么，但它不会提供你习惯的很多枚举行为。

您必须执行以下操作：

```
var imgType:ImageType = new ImageType();
imgType._imageType = "Png"; 
```

我知道您说过您不能更改生成的类，但如果您想创建自己的枚举类，请查看以下问题以获取官方文档的链接以及有关自定义枚举实现的有用博客文章：

[AS3/Flash/Flex 中的枚举？](https://stackoverflow.com/questions/329652/enums-in-as3-flash-flex)

# python - 是否可以在没有迭代器变量的情况下实现 Python for range 循环？

> ID：818828
> 
> 赞同：218
> 
> 时间：2009-05-04T05:06:46.340
> 
> 标签：python, loops, for-loop, range

是否可以在没有 的情况下进行以下操作`i`？

```
for i in range(some_number):
    # do something 
```

如果您只想做 N 次并且不需要迭代器。

* * *

## 回答 #1

> 赞同：129
> 
> 时间：2009-05-04T05:14:35.387

在我的头顶上，没有。

我认为你能做的最好的事情是这样的：

```
def loop(f,n):
    for i in xrange(n): f()

loop(lambda: <insert expression here>, 5) 
```

但我认为你可以忍受额外的`i`变量。

这是使用`_`变量的选项，实际上它只是另一个变量。

```
for _ in range(n):
    do_something() 
```

请注意，`_`分配了在交互式 python 会话中返回的最后一个结果：

```
>>> 1+2
3
>>> _
3 
```

出于这个原因，我不会以这种方式使用它。我不知道 Ryan 提到的任何成语。它可能会弄乱您的口译员。

```
>>> for _ in xrange(10): pass
...
>>> _
9
>>> 1+2
3
>>> _
9 
```

并且根据[Python 语法](https://docs.python.org/2/reference/lexical_analysis.html#identifiers)，它是一个可接受的变量名：

```
identifier ::= (letter|"_") (letter | digit | "_")* 
```

* * *

## 回答 #2

> 赞同：76
> 
> 时间：2009-05-04T05:39:39.427

您可能正在寻找

```
for _ in itertools.repeat(None, times): ... 
```

`times`这是在 Python中迭代时间的最快方法。

* * *

## 回答 #3

> 赞同：67
> 
> 时间：2009-05-04T05:20:11.067

分配给未使用的值的一般习惯用法是命名它`_`。

```
for _ in range(times):
    do_stuff() 
```

* * *

## 回答 #4

> 赞同：20
> 
> 时间：2009-05-04T05:44:00.930

每个人都建议您使用 _ 并不是说​​ _ 经常用作[gettext](http://docs.python.org/library/gettext.html)函数之一的快捷方式，因此如果您希望您的软件以一种以上的语言可用，那么您最好避免使用它用于其他目的。

```
import gettext
gettext.bindtextdomain('myapplication', '/path/to/my/language/directory')
gettext.textdomain('myapplication')
_ = gettext.gettext
# ...
print _('This is a translatable string.') 
```

* * *

## 回答 #5

> 赞同：9
> 
> 时间：2009-05-06T14:00:39.723

这是一个利用（滥用？）[数据模型](https://docs.python.org/2/reference/datamodel.html#object.__nonzero__)（[Py3 链接](https://docs.python.org/3/reference/datamodel.html#object.__bool__)）的随机想法。

```
class Counter(object):
    def __init__(self, val):
        self.val = val

    def __nonzero__(self):
        self.val -= 1
        return self.val >= 0
    __bool__ = __nonzero__  # Alias to Py3 name to make code work unchanged on Py2 and Py3

x = Counter(5)
while x:
    # Do something
    pass 
```

我想知道标准库中是否有类似的东西？

* * *

## 回答 #6

> 赞同：8
> 
> 时间：2012-03-29T06:24:20.580

您可以使用 _11（或任何数字或其他无效标识符）来防止与 gettext 发生名称冲突。每当您使用下划线 + 无效标识符时，您都会得到一个可用于 for 循环的虚拟名称。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-05-04T05:21:23.933

可能的答案取决于您使用迭代器时遇到的问题？可能会用到

```
i = 100
while i:
    print i
    i-=1 
```

或者

```
def loop(N, doSomething):
    if not N:
        return
    print doSomething(N)
    loop(N-1, doSomething)

loop(100, lambda a:a) 
```

但坦率地说，我认为使用这种方法没有意义

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2013-03-13T17:30:37.030

现在你有一个不需要的列表，而不是不需要的计数器。最好的解决方案是使用以“_”开头的变量，它告诉语法检查器您知道您没有使用该变量。

```
x = range(5)
while x:
  x.pop()
  print "Work!" 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2012-01-06T07:07:47.177

我一般同意上面给出的解决方案。即：

1.  `for`在-loop中使用下划线（2 行或更多行）
2.  定义一个普通的`while`计数器（3 行或更多行）
3.  声明一个带有`__nonzero__`实现的自定义类（更多行）

**如果要像#3**那样定义一个对象，我建议[*使用*关键字](http://www.python.org/dev/peps/pep-0343/)或应用[contextlib](http://docs.python.org/library/contextlib.html)实现协议。

此外，我提出了另一种解决方案。它是 3 班轮，不是非常优雅，但它使用**itertools**包，因此可能会引起人们的兴趣。

```
from itertools import (chain, repeat)

times = chain(repeat(True, 2), repeat(False))
while next(times):
    print 'do stuff!' 
```

在这些示例中， *2*是迭代循环的次数。**chain**包装了两个**重复**迭代器，第一个是有限的，第二个是无限的。请记住，这些是真正的迭代器对象，因此它们不需要无限内存。显然，这比解决方案**#1**慢得多。除非作为函数的一部分编写，否则它可能需要清理**时间**变量。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2013-12-09T05:55:27.983

我们在以下内容中获得了一些乐趣，很有趣的分享如下：

```
class RepeatFunction:
    def __init__(self,n=1): self.n = n
    def __call__(self,Func):
        for i in xrange(self.n):
            Func()
        return Func

#----usage
k = 0

@RepeatFunction(7)                       #decorator for repeating function
def Job():
    global k
    print k
    k += 1

print '---------'
Job() 
```

**结果：**

```
0
1
2
3
4
5
6
---------
7 
```

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2017-01-11T23:46:30.120

if`do_something`是一个简单的函数或者可以被包装在一个函数中，一个简单的`map()`can`do_something` `range(some_number)`次：

```
# Py2 version - map is eager, so it can be used alone
map(do_something, xrange(some_number))

# Py3 version - map is lazy, so it must be consumed to do the work at all;
# wrapping in list() would be equivalent to Py2, but if you don't use the return
# value, it's wastefully creating a temporary, possibly huge, list of junk.
# collections.deque with maxlen 0 can efficiently run a generator to exhaustion without
# storing any of the results; the itertools consume recipe uses it for that purpose.
from collections import deque

deque(map(do_something, range(some_number)), 0) 
```

如果您想将参数传递给`do_something`，您可能还会发现[itertools`repeatfunc`配方](https://docs.python.org/2/library/itertools.html#recipes)读起来很好：

要传递相同的参数：

```
from collections import deque
from itertools import repeat, starmap

args = (..., my args here, ...)

# Same as Py3 map above, you must consume starmap (it's a lazy generator, even on Py2)
deque(starmap(do_something, repeat(args, some_number)), 0) 
```

要传递不同的参数：

```
argses = [(1, 2), (3, 4), ...]

deque(starmap(do_something, argses), 0) 
```

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2022-02-22T11:44:18.173

我们可以使用 while & yield，我们可以像这样创建自己的循环函数。这里可以参考官方[文档](https://wiki.python.org/moin/ForLoop)。

```
def my_loop(start,n,step = 1):
    while start < n:
        yield start
        start += step

for x in my_loop(0,15):
    print(x) 
```

* * *

## 回答 #13

> 赞同：-2
> 
> 时间：2013-03-18T17:01:12.773

```
#Return first n items of the iterable as a list
list(itertools.islice(iterable, n)) 
```

取自[http://docs.python.org/2/library/itertools.html](http://docs.python.org/2/library/itertools.html)

* * *

## 回答 #14

> 赞同：-2
> 
> 时间：2015-03-15T11:55:38.573

如果您**真的**想避免放置带有名称的东西（OP 中的迭代变量，或者不需要的列表或不需要的生成器返回真正想要的时间量），如果您真的想要，您可以这样做：

```
for type('', (), {}).x in range(somenumber):
    dosomething() 
```

使用的技巧是创建一个匿名类`type('', (), {})`，该类会产生一个空名称的类，但请注意它没有插入本地或全局命名空间（即使提供了非空名称）。然后，您将该类的成员用作无法访问的迭代变量，因为它所属的类是无法访问的。

* * *

## 回答 #15

> 赞同：-8
> 
> 时间：2012-10-11T10:34:01.597

关于什么：

```
while range(some_number):
    #do something 
```

# cocoa - 如何使用 Cocoa/Core Animation 使 os x 桌面变暗

> ID：818829
> 
> 赞同：3
> 
> 时间：2009-05-04T05:06:52.737
> 
> 标签：cocoa, core-animation

有没有办法使用 Cocoa 或 Core Animation 以编程方式控制 OS X 桌面的亮度？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-04T05:44:01.867

在主窗口后面创建一个[半透明的全屏视图。](http://briankc.com/2007/12/15/create-a-transparent-fullscreen-view/)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-06T21:51:30.060

如果您真的对整个屏幕的淡出或淡入感兴趣，[这里有一个描述如何做到这一点的链接](http://developer.apple.com/documentation/GraphicsImaging/Conceptual/QuartzDisplayServicesConceptual/Articles/FadeEffects.html#//apple_ref/doc/uid/TP40004232 "淡化效果文档和示例")。

链接的文档包含有关如何将所有显示（或单个显示）淡化为黑色（您可以更改颜色）、捕获显示（您可以在其中显示您想要的内容）然后淡出的示例。`CGAcquireDisplayFadeReservation()`我在其他答案的评论中提到了这个用途。

这更像是你要找的吗？

# javascript - 是否有一个好的 jQuery 插件或 JS 代码用于持续时间？

> ID：818830
> 
> 赞同：5
> 
> 时间：2009-05-04T05:08:22.890
> 
> 标签：javascript, jquery, jquery-plugins, time

我基本上想产生以下内容：

从 int 67 到 1 分 7 秒

从 int 953 到 15 分 53 秒

从 int 3869 到 1 小时 4 分 29 秒

伪代码：

```
// original
<span class="time">67</span>

//output
<span class="time">1 minute 7 seconds</span>

// js
$('.time').format_duration(); 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-05-04T05:54:29.487

借用 Guffa 的大部分答案，这应该作为一个 jQuery 插件来解决问题：

```
jQuery.fn.time_from_seconds = function() {
    return this.each(function() {
        var t = parseInt($(this).text(), 10);
        $(this).data('original', t);
        var h = Math.floor(t / 3600);
        t %= 3600;
        var m = Math.floor(t / 60);
        var s = Math.floor(t % 60);
        $(this).text((h > 0 ? h + ' hour' + ((h > 1) ? 's ' : ' ') : '') +
                     (m > 0 ? m + ' minute' + ((m > 1) ? 's ' : ' ') : '') +
                     s + ' second' + ((s > 1) ? 's' : ''));
    });
}; 
```

如果你有这样的 HTML：

```
<span class='time'>67</span>
<span class='time'>953</span>
<span class='time'>3869</span> 
```

你这样称呼它：

```
$('.time').time_from_seconds(); 
```

HTML变成：

```
<span class="time">1 minute 7 seconds</span>
<span class="time">15 minutes 53 seconds</span>
<span class="time">1 hour 4 minutes 29 seconds</span> 
```

每个元素还具有“原始”的[数据属性](http://docs.jquery.com/Data)以及它最初包含的秒数。

我的回答直接回答了你的问题，但我要在黑暗中试一试：如果你想显示人类时间多久前发生的事情（即“5 分钟前”），可以使用[jQuery timeago 插件](http://timeago.yarp.com/). 不过，我认为它不接受秒作为格式。它必须是[ISO 8601](http://en.wikipedia.org/wiki/ISO_8601)日期。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-05-04T06:06:57.427

```
<html>
<head>
<script language="javascript" type="text/javascript" src="jquery.js"></script>
<script>

var tbl = [
    [ 7*24*60*60, 'week' ],
    [ 24*60*60, 'day' ],
    [ 60*60, 'hour' ],
    [ 60, 'minute' ],
    [ 1, 'second' ]
];

function convert() {
    var t = parseInt($('#val').val());
    var r = '';
    for (var i = 0; i < tbl.length; i++) {
        var d = tbl[i];
        if (d[0] < t) {
            var u = Math.floor(t / d[0]);
            t -= u * d[0];
            r += u + ' ' + d[1] + (u == 1 ? ' ' : 's ');
        }
    }
    $('#result').html(r);
}

</script>
</head>
<body>
<input id='val' type='text' size='10' />
<input type='button' value='convert' onclick='convert()' />
<div id='result' />
</body>
</html> 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-05-04T05:33:16.200

给元素一个 id 以便于访问：

```
<span id="time">67</span> 
```

现在您可以获取值并进行转换：

```
var o = document.getElementById('time');
var t = parseInt(o.innerHTML);
var h = Math.floor(t / 3600);
t %= 3600;
var m = Math.floor(t / 60);
var s = t % 60;
o.innerHTML =
   (h > 0 ? h + ' hours ' : '') +
   (m > 0 ? m + ' minutes ' : '') +
   s + ' seconds'; 
```

编辑：
按照 Mike B 的建议添加了 Math.floor()。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-04T06:16:41.303

以防万一您正在寻找更简洁的内容，并希望避免其他一些尝试的尾随空格和不正确的复数问题：

```
function timeString( t ) {
    var ret = [], t = {
        hour: parseInt(t/3600),
        minute: parseInt(t/60%60),
        second: t%60
    };

    for ( var n in t )
        t[n] && ret.push( t[n], n + "s".substr( t[n] < 2 ) );

    return ret.join(" ");
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-04T05:20:09.367

使用 **setTimeOut**（表达式，毫秒）

其中**表达式可以是在以****毫秒**为单位的时间完成时要调用的函数。

可以在以下位置找到操纵多个时间计数器的一个很好的示例： [http ://www.plus2net.com/javascript_tutorial/timer-set.php](http://www.plus2net.com/javascript_tutorial/timer-set.php)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-04T05:28:37.660

它并不优雅，但应该可以工作：

```
function format_duration(elem) {
var num = parseInt($(elem).text());
var hours = 0;
var mins = 0;
var secs = 0;
while (num > 0) {
  if (num < 60) {
    secs += num;
    num = 0;
  }
  else if (num < 3600) {
    mins++;
    num -= 60;
  }
  else if (num < 86400) {
    hours++;
    num -= 3600;
  }
}
var rv = "";
if (hours > 0) {
    rv += hours+" hours ";
}
if (mins > 0) {
    rv += mins+" mins ";
}
if (secs > 0) { 
    rv += secs+" secs ";
}
$(elem).text(rv);
} 
```

（更新以回答 jquery 的使用）

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-05-04T05:43:21.197

漂亮的古法。不过，您需要在其中添加一些“地板”呼叫：

```
<snip>
    var h = Math.floor(t / 3600);
    t %= 3600;
    var m = Math.floor(t / 60);
<snip> 
```

# deployment - 部署友好的代码

> ID：818831
> 
> 赞同：3
> 
> 时间：2009-05-04T05:09:19.050
> 
> 标签：deployment

编写部署友好的代码是否被认为是程序员的一种美德？

如果是，那么编码时要牢记的一般注意事项是什么，以便以后部署相同的代码不会成为一场噩梦？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-04T05:15:19.767

部署的最大改进是最大限度地减少人工干预和人工步骤。如果您必须输入配置值或手动浏览配置屏幕，则部署中会出现错误。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-04T05:16:18.890

如果您的代码需要“打电话回家”，请确保用户了解原因，并在必要时关闭该功能。如果您正在编写现成的软件以部署在公司网络上，这可能只是一件大事。

让您的程序不依赖于太多环境因素而无法正常运行也很好。为了解决这个问题，我喜欢用我自己的 bin 等和其他文件夹定义一个目录结构，这样所有东西都可以自包含。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-04T05:21:40.360

整个部署过程应该是自动化的，以尽量减少人为错误。软件不应受环境影响。任何新的部署都应该很容易回滚，以防出现任何问题。在编码时，您不应硬编码可能因环境不同而不同的配置值。配置应该以可以根据环境轻松自动化的方式进行。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-05T15:44:23.913

客户端还是服务器？

一般来说，部署友好意味着您在完成一个小故事/工作单元时完成并验证部署。它来自持续的质量保证，而不是风格。如果您等到最后一刻才构建和验证部署，那么最干净的代码将永远不会友好。

其他所有部署，桌面或服务器，都来自早期验证。如果您尽早解决这些依赖项的交付，您可以添加所有您想要的古怪依赖项。一些非常方便的桌面部署机制导致了沙盒/部分受信任的应用程序。最好尽早发现您无法执行某些操作（例如，将您的日志写入 c:\log.txt），而不是迟到发现您的客户无法安装。

* * *

## 回答 #5

> 赞同：-2
> 
> 时间：2009-05-04T05:16:21.403

我不完全确定您所说的“部署友好代码”是什么意思。你在部署什么？“部署”是什么意思？

如果您的意思是您的代码应该可以在计算机之间传输，我想最好的办法是尽量减少对外部库的不必要的（使用给定的“不必要”定义）依赖，并记录好您*所*依赖的库。

# cocoa - 有没有办法以编程方式扩展 Apple 的 Expose

> ID：818839
> 
> 赞同：2
> 
> 时间：2009-05-04T05:15:45.913
> 
> 标签：cocoa, core-animation, apple-expose

我正在寻找一些关于如何在我自己的应用程序中重现 Apple Expose 效果的指示。是否有用于 Expose 的 API？如果不是，如何从头开始复制？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-04T15:09:22.023

不，没有官方的 Exposé API。

你想达到什么效果？[这个旧的 Apple 邮件列表线程](http://lists.apple.com/archives/cocoa-dev/2004/jul/msg00554.html)是关于同一主题的。该线程包含[有关如何获得](http://lists.apple.com/archives/cocoa-dev/2004/jul/msg00588.html)类似于 Exposé 的窗口缩放效果的一些信息。我也猜想你关于[调暗桌面](https://stackoverflow.com/questions/818829/how-to-dim-os-x-desktop-using-cocoa-core-animation)的其他问题是相关的。让我们知道您还想做什么，也许我们可以提供一些建议。

# binary - 涵盖 12 月数字 0-99 的最短二进制序列

> ID：818847
> 
> 赞同：1
> 
> 时间：2009-05-04T05:19:21.847
> 
> 标签：binary, sequence

考虑包含数字 0 到 99 的二进制表示的字符串集合 S。如果 S 的每个元素都是 T 的子字符串，那么最短的字符串 T 是多少？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-04T05:42:14.960

您所要求的与二进制[De Bruijn 序列](http://en.wikipedia.org/wiki/De_Bruijn_sequence)非常相似。该问题的算法使用[欧拉循环](http://en.wikipedia.org/wiki/Eulerian_cycle)，可以很容易地适应您的问题。

# django - 如何使 Django 应用程序可插入？

> ID：818861
> 
> 赞同：6
> 
> 时间：2009-05-04T05:25:29.073
> 
> 标签：django, django-models, django-apps

例如，我有一个博客应用程序，我希望能够放入不同的项目中，但我总是希望博客与其他模型相关联。例如，在一种情况下，我可能希望它与用户相关联：

site.com/someuser/blog

但在另一个网站上，我希望它与一所学校相关联：

site.com/someschool/blog

有没有办法让博客应用程序可插入，这样每当我将模型放入项目时就不需要重新定义模型（添加外键字段）？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-04T06:14:20.297

有几个重要的细节可以确保应用程序可以重用，我认为最好链接到关于该主题的两个更重要的文档集：

*   [django-最佳实践](http://lincolnloop.com/django-best-practices/)
*   [django-reusable-apps-docs](http://github.com/ericholscher/django-reusable-app-docs/tree/master)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-04T15:39:08.847

您可能想查看 ContentTypes 框架，我用它创建了一个评论应用程序，可用于评论数据库中的任何模型（出于不同的原因，我不想使用标准的 django 评论应用程序）。

[http://docs.djangoproject.com/en/dev/ref/contrib/contenttypes/](http://docs.djangoproject.com/en/dev/ref/contrib/contenttypes/)

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-05-04T13:23:48.970

[通用关系](https://docs.djangoproject.com/en/dev/ref/contrib/contenttypes/#generic-relations)允许您拥有任何其他模型的外键。但是，从您的问题中不清楚您希望外键链接到哪种类型的对象。我怀疑外键关系并不是真正的通用——您只是没有发现系统的另一部分也可能是可重用的应用程序。

# sql - 对于大桌子，有什么比“计数”更快的吗？

> ID：818868
> 
> 赞同：3
> 
> 时间：2009-05-04T05:28:29.127
> 
> 标签：sql, count, query-optimization, having

这是我的查询：

```
select word_id, count(sentence_id) 
from sentence_word 
group by word_id 
having count(sentence_id) > 100; 
```

表 sentenceword 包含 3 个字段，wordid、sentenceid 和一个主键 id。它有 350k+ 行。这个查询需要高达 85 秒，我想知道（希望，祈祷？）有一种更快的方法可以找到所有超过 100 个句子的 wordid。

我试过取出选择计数部分，只是做'有计数（1）'，但都没有加快速度。

我将不胜感激您可以提供的任何帮助。谢谢！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-04T05:36:20.357

如果您还没有，请在 sentence_id、word_id 上创建一个复合索引。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-04T14:57:44.110

> 计数（sentence_id）> 100；

这有一个问题......表格有重复的单词/句子对，或者没有。

如果它确实有重复的单词/句子对，你应该使用这个代码来得到正确的答案：

```
HAVING COUNT(DISTINCT Sentence_ID) > 100 
```

* * *

如果表格没有重复的单词/句子对......那么你不应该计算 sentence_ids，你应该只计算行数。

```
HAVING COUNT(*) > 100 
```

***在这种情况下，您可以仅在 word_id***上创建索引，以获得最佳性能。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-04T05:34:09.690

如果经常执行该查询，并且表很少更新，您可以保留一个带有单词 id 和相应句子计数的辅助表——很难想到除此之外的任何进一步优化！

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-04T06:06:10.020

您的查询很好，但需要一些帮助（索引）才能获得更快的结果。

我手头没有资源（或无法访问 SQL），但我会尽量从记忆中帮助您。

从概念上讲，回答该查询的唯一方法是计算所有共享相同 word_id 的记录。这意味着查询引擎需要一种快速的方法来查找这些记录。如果没有 word_id 上的索引，数据库唯一能做的就是一次遍历表一条记录，并保持运行它找到的每个不同 word_id 的总数。这通常需要一个临时表，并且在扫描整个表之前不能发送任何结果。不好。

使用 word_id 上的索引，它仍然必须通过表，所以*你会认为*它没有多大帮助。但是，SQL 引擎现在可以计算每个 word_id 的计数，而无需等到表的末尾：它可以分派该行和 word_id 值的计数（如果它通过了您的`where`子句），或者丢弃该行（如果它没有）；这将导致服务器上的内存负载降低，可能会导致部分响应，并且不再需要临时表。第二个方面是并行性。通过 word_id 上的索引，SQL 可以将作业分成块并使用单独的处理器内核并行运行查询（取决于硬件功能和现有工作负载）。

这可能足以帮助您查询；但您将不得不尝试查看：

```
CREATE INDEX someindexname ON sentence_word (word_id) 
```

（T-SQL 语法；您没有指定您使用的 SQL 产品）

如果这还不够（或根本没有帮助），还有其他两种解决方案。

首先，SQL 允许您使用索引视图和其他机制预先计算 COUNT(*)。我手头没有详细信息（而且我不经常这样做）。如果您的数据不经常更改，那么这将为您提供更快的结果，但会增加复杂性和一些存储空间。

此外，您可能需要考虑将查询结果存储在单独的表中。仅当数据从不更改或按精确的时间表更改（例如，在凌晨 2 点刷新数据期间），或者如果更改很少并且您可以在几个小时内忍受不完美的结果（您必须安排定期数据刷新）；这在道德上相当于穷人的数据仓库。

确定什么对您有用的最佳方法是运行查询并查看带有和不带有上述候选索引的查询计划。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2010-10-05T01:02:38.917

令人惊讶的是，有一种更快的方法可以在大型数据集上实现这一点：

```
SELECT totals.word_id, totals.num 
  FROM (SELECT word_id, COUNT(*) AS num FROM sentence_word GROUP BY word_id) AS totals
 WHERE num > 1000; 
```

# wpf - WPF：带有 WrapPanel 的 ListBox，垂直滚动问题

> ID：818876
> 
> 赞同：24
> 
> 时间：2009-05-04T05:33:18.617
> 
> 标签：wpf, listbox, scrollbar, wrappanel

我有一个 UserControl（下面的 XAML），它有一个 ListBox，我想在 WrapPanel 内显示图像，其中显示的图像数量与一行中的图像数量一样多，然后换行到下一行等。它可以工作，除非 ListBox增长高于窗口中的可用空间，我没有得到垂直滚动条，即内容被剪裁。如果我在 ListBox 上设置了固定高度，滚动条就会出现并按预期工作。我怎样才能让这个列表框增长到可用空间，然后显示一个垂直滚动条？此控件位于主窗口的 Grid 内的 StackPanel 内。如果我将 StackPanel 包装在 ScrollViewer 中，我会得到我想要的滚动条，但如果我想在 ListBox 上方的 UserControl 中添加更多控件（例如图像大小“缩放”等），这并不是一个好的解决方案，因为我不会

谢谢！！:)

```
<UserControl x:Class="GalleryAdmin.UI.GalleryView"
xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml">
    <ListBox Name="itemListBox" BorderThickness="0" ItemsSource="{Binding}" ScrollViewer.HorizontalScrollBarVisibility="Disabled">
        <ListBox.ItemTemplate>
            <DataTemplate>
                <StackPanel Background="LightGray" Margin="5" >
                    <StackPanel Margin="5">
                        <Image Source="{Binding Path=LocalThumbPath}" Height="100" />
                        <TextBlock Text="{Binding Path=Name}" TextAlignment="Center"></TextBlock>
                    </StackPanel>
                </StackPanel>
            </DataTemplate>
        </ListBox.ItemTemplate>
        <ListBox.ItemsPanel>
            <ItemsPanelTemplate>
                <WrapPanel />
            </ItemsPanelTemplate>
        </ListBox.ItemsPanel>
    </ListBox> 
```

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2013-02-07T18:01:26.270

我认为你最好覆盖 ItemPanelTemplate：

```
<Grid>
<ListBox ScrollViewer.HorizontalScrollBarVisibility="Disabled">
    <ListBox.ItemsPanel>
        <ItemsPanelTemplate>
            <WrapPanel IsItemsHost="True" />
        </ItemsPanelTemplate>
    </ListBox.ItemsPanel>
    <ListBoxItem>listbox item 1</ListBoxItem>
    <ListBoxItem>listbox item 2</ListBoxItem>
    <ListBoxItem>listbox item 3</ListBoxItem>
    <ListBoxItem>listbox item 4</ListBoxItem>
    <ListBoxItem>listbox item 5</ListBoxItem>
</ListBox> 
```

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2009-05-11T05:24:15.380

好吧，我终于偶然发现了解决方案。我正在将我的 UserControl 添加到如下所示的占位符面板：

```
 <ScrollViewer Margin="20" >
                <StackPanel Name="contentPanel"></StackPanel>
            </ScrollViewer> 
```

但是，当我将其切换到 Grid 时，事情开始按我想要的方式工作：

```
<Grid Name="contentPanel" Margin="20" /> 
```

我认为这与 StackPanel 默认情况下不占用所有垂直空间有关，就像 Grid 正在做的那样。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2013-12-02T16:37:15.920

我所要做的就是设置以下内容，问题就消失了：

```
<ListBox ScrollViewer.HorizontalScrollBarVisibility="Disabled"> 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2013-09-23T18:35:43.513

我只是在查看有关此问题的几个问题，虽然这是一个旧线程，但这个问题给了我答案，但只是为了澄清......

布局网格是大多数此类问题的答案。为了获得正确的 ListBox/WrapPanel 操作来填充可用空间，下面的代码可以解决问题：

```
 <Grid Grid.Row="1" MaxHeight="105">
                        <ListBox ItemTemplate="{DynamicResource StoreGroupTemplate01}" ItemsSource="{Binding StoreGroupHeader}"
                            ScrollViewer.HorizontalScrollBarVisibility="Disabled">
                            <ListBox.ItemsPanel>
                            <ItemsPanelTemplate>
                                    <WrapPanel Orientation="Horizontal"/>
                            </ItemsPanelTemplate>
                            </ListBox.ItemsPanel>
                        </ListBox>
                    </Grid> 
```

我将它放在另一个网格中，以将列表放在屏幕底部（即 Grid.Row="1"），您可以调整 MaxHeight（或删除它）以在垂直滚动条之前控制可见区域出现。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-04T05:54:54.803

将列表框放在 ScrollViewer 中，然后将 scrollviewer 的 VerticalScrollBarVisibility 属性设置为“Auto”

```
 <ScrollViewer VerticalScrollBarVisibility="Auto" HorizontalScrollBarVisibility="Disabled">
    <ListBox Name="itemListBox" BorderThickness="0" ItemsSource="{Binding}" >
    <ListBox.ItemTemplate>
        <DataTemplate>
            <StackPanel Background="LightGray" Margin="5" >
                <StackPanel Margin="5">
                    <Image Source="{Binding Path=LocalThumbPath}" Height="100" />
                    <TextBlock Text="{Binding Path=Name}" TextAlignment="Center"></TextBlock>
                </StackPanel>
            </StackPanel>
        </DataTemplate>
    </ListBox.ItemTemplate>
    <ListBox.ItemsPanel>
        <ItemsPanelTemplate>
            <WrapPanel />
        </ItemsPanelTemplate>
    </ListBox.ItemsPanel>
</ListBox>
</ScrollViewer> 
```

高温高压

# asp.net - 如何在负载平衡环境中设置 SSL？

> ID：818881
> 
> 赞同：7
> 
> 时间：2009-05-04T05:36:15.160
> 
> 标签：asp.net, wcf, infrastructure, load-balancing

这是我们当前的基础设施：

1.  共享负载平衡器后面的 2 个 Web 服务器
2.  dns 指向负载均衡器
3.  Web 应用程序在 asp.net 中完成，带有 wcf 服务

我的问题是如何设置 SSL 证书以支持 https 连接。

以下是我的两个想法：

1.  SSL 证书在负载均衡器处终止。负载平衡器后面的安全/不安全通信将被转发到 2 个不同的端口。
    **亲：** 只需要 1 个证书，因为我水平扩展
    **缺点：**我必须通过检查请求来自哪个端口来检查安全或不安全。对我来说不太合适

    当 IIS 绑定 2 个不同的端口时，WCF 设计将不起作用
    （[根据 this](https://connect.microsoft.com/wcf/feedback/ViewFeedback.aspx?FeedbackID=322896)）

2.  SSL 证书在每台服务器上终止？
    **缺点：**需要添加更多证书才能横向扩展

谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-04T05:57:17.840

绝对在负载均衡器处终止 SSL ！！！后面的任何东西都不应该在外面可见。为什么安全/不安全的两个端口不能正常工作？

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-04T06:37:23.330

您实际上根本不需要更多证书。因为外部看到的 FQDN 是相同的，所以您在每台机器上使用**相同**的证书。

这意味着 WCF（如果您正在使用它）将起作用。如果您在消息级别而不是传输级别进行签名/加密，那么在外部负载均衡器上终止 SSL 的 WCF 会很痛苦。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-04T06:31:59.317

您很可能不需要两个端口。只需让负载平衡器上的 SSL 虚拟服务器在请求中添加 HTTP 标头并检查即可。这就是我们使用 Zeus ZXTM 5.1 所做的。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-04T07:10:51.813

您不必为每个站点都获得证书，有通配符证书之类的东西***。***但它必须安装在每台服务器上。（假设您使用的是子域，如果没有，那么您可以跨机器重用相同的证书）

但如果不仅仅是为了便于配置，我可能会将证书放在负载均衡器上。

# mysql - 内连接问题

> ID：818884
> 
> 赞同：0
> 
> 时间：2009-05-04T05:36:49.530
> 
> 标签：mysql, join

```
CREATE TABLE college 
(  
  id       SERIAL PRIMARY KEY, 
  SCHOOL   VARCHAR(100),
  CColor   VARCHAR(100),  
  CCmascot VARCHAR(100)  
);

CREATE TABLE mats 
(  
  id                SERIAL PRIMARY KEY,  
  CColor            VARCHAR(100),  
  CCNAME            VARCHAR(100)  
); 
```

MYSQL 好的，这是我认为很简单的问题，但我没有做对。我通过 URL 将 SCHOOL 名称传递给我，我现在使用 $_GET 获取学院名称我需要查询：
通过使用 SCHOOL 名称，我需要获取 CCOLOR 和 CCNAME。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-04T06:10:56.857

您的问题不清楚，因此只能近似回答。您需要两个表中可用于连接它们的列，即具有可用于识别父表（学院）中的记录何时与子表（垫子）中的记录匹配的列. 理想情况下，您将在子表映射中有一个外键，可以命名为college_id（这使用引用父表的命名约定）。

像上面提到的那样提供一个外键，您的查询将变为

```
select
  college.ccolor
from
  college inner join mats
    on college.id = mats.college_id
where
  mats.ccname = "<<COLOUR_DESIRED>>"; 
```

假设 ccname 是 ccolor 的名称。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-04T05:55:33.307

```
SELECT college.CColor FROM college
    INNER JOIN mats ON college.CColor = mats.CColor 
    AND mats.CColor = 'your query' 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-04T06:25:48.397

如果我理解正确，您有大学名称，并且希望找出颜色名称。

链接属性是 CColor。

您的查询应该看起来像这样：

```
select
    m.ccname, m.ccolor
from
    mats m
inner join
    college c
on
    c.ccolor = m.ccolor
where
    c.school = @myVariable 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-04T06:30:47.980

每日数据库提示：**使用外键约束**，否则您将遇到数据损坏问题，并且 SO 上的人将不知道您的列如何相互关联。

当您知道关系建模的原因和结果时，您可能会发现有必要不使用它们（尽管除非您有充分的理由，否则不建议这样做），但现在，使用它们来明确定义表与每个表的关系其他。

否则你的问题有点像问厨师，“我有一些没有标签的食物罐子，我认为是牛至。我如何为两个人做一顿浪漫的晚餐？” （嗯..罐子里有什么？？）

外键记录：http: [//dev.mysql.com/doc/refman/5.1/en/ansi-diff-foreign-keys.html](http://dev.mysql.com/doc/refman/5.1/en/ansi-diff-foreign-keys.html)

加入文档：[http ://dev.mysql.com/doc/refman/5.1/en/join.html](http://dev.mysql.com/doc/refman/5.1/en/join.html)

# winapi - 在win32中挂钩

> ID：818886
> 
> 赞同：1
> 
> 时间：2009-05-04T05:37:02.960
> 
> 标签：winapi

我希望任何窗口在鼠标悬停在其非客户区的关闭按钮上时立即关闭。我尝试在 SetWindowsHookEx 中使用 WH_GETMESSAGE 捕获 wm_ncmousemove，然后使用 SendMessage 将 WM_DESTROY 消息发送到指定窗口，但窗口没有关闭。有什么帮助吗？？？

```
LRESULT CALLBACK CallWndProc(int code, WPARAM wParam, LPARAM lParam)

{

MSG* msg = (MSG*) lParam;
if(code == HC_ACTION)
{
    if(msg->message == WM_NCMOUSEMOVE)
    {
        if(msg->wParam == HTCLOSE)
        {
            SendMessage(hwndTarget, WM_DESTROY, wParam, lParam);
        }
    }
}

return CallNextHookEx(g_hkMsg, code, wParam, lParam);
}

INT WINAPI InstallW(HWND hwnd, HINSTANCE hInstance, LPWSTR lpCmdLine, int nCmdShow)
{

DWORD dwTarget = 0;
POINT point;

GetCursorPos(&point);

hwndTarget = WindowFromPoint(point);
dwTarget = GetWindowThreadProcessId(hwndTarget, NULL);
g_hkMsg = SetWindowsHookEx(WH_GETMESSAGE, CallWndProc, g_hInstance, 0);
if(g_hkMsg)
{
    MessageBox(NULL, L"Message hook installed, press OK to uninstall.", L"HLHookTest", MB_ICONEXCLAMATION);
    UnhookWindowsHookEx(g_hkMsg);
}
else
    MessageBox(NULL, L"Hook installation failed.", L"HLHookTest", MB_ICONERROR);

return 0;   
 } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-04T05:40:05.323

发送`WM_CLOSE`或者`WM_SYSCOMMAND`代替`wParam=SC_CLOSE`。

`WM_CLOSE`并`WM_SYSCOMMAND / SC_CLOSE`要求关闭窗口。 `WM_DESTROY`通知窗口它已被关闭。对窗口说“您已关闭”不会使其关闭。

# c# - 什么是通用身份？

> ID：818891
> 
> 赞同：25
> 
> 时间：2009-05-04T05:41:04.167
> 
> 标签：c#, asp.net, authentication

谁能简要解释一下 GenericIdentity 的用途以及在哪里使用它。

* * *

## 回答 #1

> 赞同：51
> 
> 时间：2009-05-04T07:26:47.813

`GenericIdentity`并且`GenericPrincipal`是将用户描述为“委托人”的最简单方式。这可用于应用程序中的实现不感知安全检查 - 即，如果用户以“Fred”身份登录，并具有“用户”和“管理员”权限：

```
 string[] roles = { "User", "Admin" };
    Thread.CurrentPrincipal = new GenericPrincipal(
        new GenericIdentity("Fred"), roles); 
```

您可以在客户端登录到 winform 时执行此操作，或者在 WCF、ASP.NET 等中有特定点执行此操作。

然后以后的代码，无需知道这些权限是*如何*处理的，就可以检查该权限 - 通过[IsInRole](http://msdn.microsoft.com/en-us/library/system.security.principal.iprincipal.isinrole.aspx)或以声明方式：

```
[PrincipalPermission(SecurityAction.Demand, Role = "Admin")]
void SomeAdminFunction() { } 
```

这里一些有用的实用程序代码是围绕主体/身份的空安全包装器：

```
public static string GetUsername() {
    IPrincipal principal = Thread.CurrentPrincipal;
    IIdentity identity = principal == null ? null : principal.Identity;
    return identity == null ? null : identity.Name;
}
public static bool IsInRole(string role) {
    IPrincipal principal = Thread.CurrentPrincipal;
    return principal == null ? false : principal.IsInRole(role);
} 
```

然后你的 DAL 中可能有一些审计代码：

```
row.UpdatedBy = MyUtilityClass.GetUsername(); 
```

`GenericPrincipal`对于普通用户名和一组已知角色的简单情况很有用。例如，更复杂的主体实现可能会进行“按需”访问检查 - 即直到您要求它不知道的“Foo”角色 - 然后它会发现（通过与 Web 服务、数据库、活动 -目录等）并缓存结果以供将来访问。*当潜在角色列表很大，而现实*中通常查询的角色数量很少时，这很有用。

您还可以使用主体来存储仅在某些上下文中需要的额外身份信息 - 例如，安全令牌。调用者可能会测试主体`as`以查看它是否支持额外数据。

使用“主体”很有用，因为您的逻辑处理代码可以谈论身份，而不必知道这是否是 winforms、ASP.NET、WCF、Windows 服务等——它是抽象的。此外，一些第 3 方代码也会与委托人对话。

作为另一个例子 - 我[在这里写了一些示例代码](http://groups.google.co.uk/group/microsoft.public.dotnet.languages.csharp/browse_thread/thread/3c9eb4ca945ae674/e7b281c8a1b6891e)，展示了如何使用主体来控制通过设计器对 winform 控件的访问（通过`IExtenderProvider`- 将额外的条目放入 VS 的属性网格中）。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-04T05:51:42.567

您可以使用 GenericIdentity 作为 Identity 的具体实现，您希望自己以编程方式提供有关当前用户的详细信息。如果您通过其他渠道自己识别并验证了用户，那就太好了。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2021-01-25T03:32:10.223

GenericIdentity 类可以与 GenericPrincipal 类结合使用，以创建独立于 Windows 域而存在的授权方案。

```
GenericIdentity myIdentity = new GenericIdentity("MyUser"); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-04T05:52:38.867

查看

[http://msdn.microsoft.com/en-us/library/system.security.principal.genericidentity.aspx](http://msdn.microsoft.com/en-us/library/system.security.principal.genericidentity.aspx)

你会在那里找到一些例子。它代表一般用户。

身份验证和配置文件权限。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2016-11-14T08:07:44.097

GenericIdentity 类：- GenericIdentity 类实现 IIdentity 接口。它表示基于应用程序定义的自定义身份验证方法的用户身份。GenericPrincipal 类：- GenericPrincipal 类实现 IPrincipal 接口。它代表独立于 Windows 用户及其角色而存在的用户和角色。本质上，通用主体是应用程序身份验证和授权的简单解决方案。

# xcode - 使用objective-c ++时Xcode'无效转换'

> ID：818892
> 
> 赞同：1
> 
> 时间：2009-05-04T05:41:07.473
> 
> 标签：xcode, macos

因此，如果我以 .m 的形式运行我的程序，它就可以正常工作。只需将其更改为 .mm 就会导致这条线......</p>

```
CGContextRef myContext = [[NSGraphicsContext currentContext] graphicsPort]; 
```

抛出这个错误……</p>

```
error: invalid conversion from 'void*' to 'CGContext*' 
```

任何人都有任何想法，为什么只是改变它就会让它爆炸，或者如何解决它？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-04T15:25:44.183

C++ 不允许从`void*`. `void*`在这种情况下，从（的返回类型`-[NSGraphicsContext graphicsPort]`） a的隐式转换`CGContextRef`是非法的。您可以像这样使转换显式：

```
CGContextRef myContext = static_cast<CGContextRef>([[NSGraphicsContext currentContext] graphicsPort]); 
```

有关C++ 运算符的讨论，请参阅[此](https://stackoverflow.com/questions/103512/in-c-why-use-staticcastintx-instead-of-intx)`static_cast`SO 问题。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-04T06:54:05.083

C 允许将 void * 转换为任意类型，C++ 不允许。一旦你的文件是 .mm ，它就会被编译为 C++：

```
cristi:tmp diciu$ cat test.c
int main()
{
    char * t = "test";
    void * m = t;
    char * g;

    g=m;

}

cristi:tmp diciu$ g++ test.c
test.c: In function ‘int main()’:
test.c:7: error: invalid conversion from ‘void*’ to ‘char*’

cristi:tmp diciu$ gcc test.c 
```

要修复，请转换为正确的类型，即将“void *”显式转换为“CGContext *”。

# javascript - 如何使用javascript选择不同的2单选按钮来填充选择选项列表

> ID：818906
> 
> 赞同：0
> 
> 时间：2009-05-04T05:46:06.543
> 
> 标签：javascript

我必须使用 java 脚本选择不同的 2 单选按钮来动态填充选择选项列表。现在我正在应用它，但它不能正常工作

```
{
 var i;
 var x1;
 var x3;
 var x=document.getElementById("ddbudget_min");//option list1
 var x2=document.getElementById("ddbudget_max");//optionlist2
 x1=x.length;
 for (x1 = x.length; x1 >= 0; x1--) {
      x[x1] = null;
 }
 x3=x2.length;
 for (x3 = x2.length; x3 >= 0; x3--) {
     x2[x3] = null;
 }

 x[0] = new Option("select min", 1);
 x[1] = new Option(1000, 2);
 x[2] = new Option(5000, 3);
 x[3] = new Option(10000, 4);
 x[4] = new Option(20000, 5);
 x[5] = new Option(50000, 6);
 x[6] = new Option("1 lakh", 7);
 x[7] = new Option(">1 lakh", 8);

 x2[0] = new Option("select max", 0);
 x2[1] = new Option(1000, 1);
 x2[2] = new Option(5000, 2);
 x2[3] = new Option(10000, 3);
 x2[4] = new Option(20000, 4);
 x2[5] = new Option(50000, 5);
 x2[6] = new Option("1 lakh", 6);
 x2[7] = new Option(">1 lakh", 7);
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-04T07:42:19.180

@Saurabh - 由于您对 jQuery 不感兴趣（我同意这是最好的方法），我假设这可能是您在普通的老式 javascript 风格中寻找的东西。只需复制下面的 html/javascript 并尝试一下。

```
<html>
<head>
  <title>Test Page For Min/Max Options</title>
<script>    
 var minOptions=[];
 minOptions[0] = new Option("Select Min", 1);
 minOptions[1] = new Option(1000, 2);
 minOptions[2] = new Option(5000, 3);
 minOptions[3] = new Option(10000, 4);
 minOptions[4] = new Option(20000, 5);
 minOptions[5] = new Option(50000, 6);
 minOptions[6] = new Option("1 lakh", 7);
 minOptions[7] = new Option(">1 lakh", 8);

 var maxOptions=[]; 
 maxOptions[0] = new Option("Select Max", 0);
 maxOptions[1] = new Option(1000, 1);
 maxOptions[2] = new Option(5000, 2);
 maxOptions[3] = new Option(10000, 3);
 maxOptions[4] = new Option(20000, 4);
 maxOptions[5] = new Option(50000, 5);
 maxOptions[6] = new Option("1 lakh", 6);
 maxOptions[7] = new Option(">1 lakh", 7);

 window.onload = function() {
   for(i=0; i < minOptions.length; i++){
      document.getElementById("ddbudget_min").options.add(minOptions[i]);
   }
   for(i =0; i < maxOptions.length; i++){
      document.getElementById("ddbudget_max").options.add(maxOptions[i]);
   }
 }
 function selectMinMax(e){
     document.getElementById("ddbudget_min")
             .style.display = e.value == 'min' ? 'block' : 'none';
     document.getElementById("ddbudget_max")
             .style.display = e.value == 'max' ? 'block' : 'none';
}

</script>
</head>
<body>
<form method="get" action="">
  <input type="radio" name="radioMinMax" value="min" 
                     onclick="selectMinMax(this)" checked />Minimum
  <input type="radio" name="radioMinMax" value="max" 
                     onclick="selectMinMax(this)" />Maximum<br/>
  <select id="ddbudget_min" name="ddbudget_min" 
                               style="display:block"></select>
  <select id="ddbudget_max" name="ddbudget_max" 
                              style="display:none"></select>
</form>
</body>
</html> 
```

# java - 关于java类中定义的枚举的问题

> ID：818908
> 
> 赞同：6
> 
> 时间：2009-05-04T05:49:37.983
> 
> 标签：java, enums

此代码取自 SCJP 实践测试：

```
 3\. public class Bridge { 
 4\.   public enum Suits { 
 5\.     CLUBS(20), DIAMONDS(20), HEARTS(30), SPADES(30), 
 6\.     NOTRUMP(40) { public int getValue(int bid) { 
                        return ((bid-1)*30)+40; } }; 
 7\.     Suits(int points) {  this.points = points;  } 
 8\.     private int points; 
 9\.     public int getValue(int bid) { return points * bid; } 
10\.   } 
11\.   public static void main(String[] args) { 
12\.     System.out.println(Suits.NOTRUMP.getBidValue(3)); 
13\.     System.out.println(Suits.SPADES + " " + Suits.SPADES.points); 
14\.     System.out.println(Suits.values()); 
15\.   } 
16\. } 
```

在第 8 行`points`被声明为私有，在第 13 行它被访问，所以从我可以看到我的答案是编译失败。但书中的答案却另有说明。我在这里遗漏了什么还是书中的错字？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-05-04T05:58:34.797

单个外部类中的所有代码都可以访问该外部类中的任何内容，无论访问级别是什么。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-05-04T06:15:47.080

扩展stepancheg所说的：

从[Java 语言规范第 6.6.1 节“确定可访问性”](http://java.sun.com/docs/books/jls/third_edition/html/names.html#6.6.1)：

> 如果成员或构造函数被声明为私有，则当且仅当它出现在包含成员或构造函数声明的顶级类的主体内时才允许访问。

本质上，`private`并不意味着这个类的私有，它意味着顶级类的私有。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-05-04T05:58:24.360

首先查看第 12 行

```
 System.out.println(Suits.NOTRUMP.getBidValue(3)); 
```

getBidValue 未定义

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-04T09:51:38.387

同样，内部类可以访问其外部类的私有成员。

# c# - 在 ASP.NET 中上传文本文件

> ID：818909
> 
> 赞同：3
> 
> 时间：2009-05-04T05:49:39.623
> 
> 标签：c#, asp.net

我有一个网页，用户可以在其上上传文本文件（但文本文件，即扩展名为 .txt 的文件，可能有多种编码，例如 ASCII、UTF8、UNICODE .. 等），我正在尝试验证在我将文件保存到磁盘之前内存中的内容，如果内容无效，我不保存文件。我正在从文件上传控件读取内容（fileUpload1.FileContent 返回字节流），.NET 中是否有一种简单的方法可以将上传文件的内容转换为字符串（即从 fileUpload1 返回的字节流.FileContent) 还是我必须先检查第一个字节才能检测到编码？

谢谢

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-05-04T06:02:55.987

我认为你可以这样做：

```
StreamReader reader = new StreamReader(fileUpload1.FileContent);
string text = reader.ReadToEnd(); 
```

* * *

## 回答 #2

> 赞同：-2
> 
> 时间：2018-10-29T13:06:23.763

```
Example of text file format

Code#Name#Fathername#DOB#Location#MobileNo
1#XYZ#YYY#09-06-89#LKO#9999999999

     protected void btnUpload_click(object sender, EventArgs e)
        {
            if (Page.IsValid)
            {
                bool logval = true;
                if (logval == true)
                {
                    if (fuUploadExcelName.HasFile)
                    {
                        String img_1 = fuUploadExcelName.PostedFile.FileName;
                        String img_2 = System.IO.Path.GetFileName(img_1);
                        string extn = System.IO.Path.GetExtension(img_1);
                        string frstfilenamepart = "Text" + DateTime.Now.ToString("ddMMyyyyhhmmss");/*Filename for storing in Desired path*/
                        UploadExcelName.Value = frstfilenamepart + extn;
                        fuUploadExcelName.SaveAs(Server.MapPath("~/Text/") + "/" + UploadExcelName.Value);/*Uploaded text file will be store at this path*/

                        string filename = UploadExcelName.Value;
                        string filePath = Server.MapPath("~/Text/" + filename);

                        StreamReader file = new StreamReader(filePath);
                        string[] ColumnNames = file.ReadLine().Split('#');/*read data from textfile*/
                        DataTable dt = new DataTable();
                        foreach (string Column in ColumnNames)
                        {
                            dt.Columns.Add(Column);/*adding the columns/
                        }
                        string NewLine;
                        while ((NewLine = file.ReadLine()) != null)
                        {
                            DataRow dr = dt.NewRow();
                            string[] values = NewLine.Split('#');

                            for (int i = 0; i < values.Length; i++)
                            {
                                dr[i] = values[i].TrimEnd();
                            }
                            dt.Rows.Add(dr);
                        }
                        file.Close();
                        grdview.DataSource = dt;/*make datasouce from text file*
                        grdview.DataBind();/*binding the grid*/

                    }
                }

            }
        } 
```

# wpf - 强制 WPF 控件刷新？

> ID：818911
> 
> 赞同：13
> 
> 时间：2009-05-04T05:50:10.277
> 
> 标签：wpf, controls, refresh

我们有两个这样的文本块：（我们使用 .NET FW 3.0）

```
<TextBlock Grid.Column="0" Name="tabName" Style="{StaticResource textBlockBarStyle}" HorizontalAlignment="Left">
  <TextBlock.Margin>
      <Binding Converter="{StaticResource dpiConverter}">
          <Binding.ConverterParameter>
               <Thickness Left="3" Top="6" Right="0" Bottom="0"/>
          </Binding.ConverterParameter>
      </Binding>
  </TextBlock.Margin>
</TextBlock> 
```

和

```
<TextBox  x:Name="txtBoxHelp" 
          IsReadOnly="True" Style="{DynamicResource txtBoxHelpStyle}" 
          IsTabStop="False" 
          Text="some text" MouseLeftButtonDown="txtBoxHelp_MouseLeftButtonDown">
     <TextBox.Margin>
        <Binding Converter="{StaticResource dpiConverter}">
            <Binding.ConverterParameter>
                 <Thickness Left="7" Top="0" Right="0" Bottom="0"/>
            </Binding.ConverterParameter>
        </Binding>
     </TextBox.Margin>
</TextBox> 
```

这两个文本块在其他操作系统上运行良好，但有时在带有 SP3 的 Windows XP Home 版本上会丢失。我们尝试了很多方法来刷新这些，但都失败了。

我们尝试了：

1.  更新布局
2.  无效视觉
3.  将代码中的 set Text 属性更改为绑定模式。

如何强制这些控件刷新？

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2011-06-02T15:50:18.840

这对我们有用，无需创建新线程。它安排动作在所有绑定首先更新自己时开始。

```
 Application.Current.Dispatcher.BeginInvoke(
                DispatcherPriority.Background,
                new Action(() =>
                    {
                        // Do something here.
                    })); 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-05-04T12:59:15.563

在 WPF 中进行控件实时更新的方法是通过 TwoWay 数据绑定。因此，请确保您绑定到的所有 viewModel 属性都是依赖属性或实现 INotifyPropertyChanged（并正确处理）并且它们的 Binding.Mode = TwoWay。

查看[Rudi Grobler](https://groups.google.com/forum/#!topic/netpontonews/-QlzWN8H5Ok)**关于 WPF 数据绑定我不知道**的10 件事

 **一些数据绑定文章：

1.  [WPF 数据绑定 - 第 1 部分](http://www.codeproject.com/KB/WPF/WpfDataBinding1.aspx)作者：Joel Ivory Johnson![替代文字](https://www.codeproject.com/KB/WPF/WpfDataBinding1/image001.jpg)
2.  [一步一步地走向 WPF 数据绑定](http://www.codeproject.com/KB/WPF/MovingTowardWpfBinding.aspx)作者：Josh Smith

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-05-15T02:54:17.380

```
 Thread thread = new Thread(new ThreadStart(delegate()
                {
                    Thread.Sleep(200); // this is important ...
                    try
                    {
                        this.Dispatcher.BeginInvoke(DispatcherPriority.Send,
                            new NoArgsHandle(delegate()
                            {
                               // do something, set .Text = "some text"
                            }));
                    }
                    catch { }
                }));
                thread.Name = "thread-UpdateText";
                thread.Start(); 
```

它运作良好。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2021-01-26T00:16:39.557

长期以来，我一直在为这个特定问题苦苦挣扎，看起来 Cooper Wu 提出的建议非常接近最终解决方案，并结合了 Declan Taylor 的评论。在我的情况下它仍然没有完全解决，但它把我带到了这段代码：

```
Thread thread = new Thread(new ThreadStart(delegate ()
{
    Thread.Sleep(200); // this is important ...
    try
    {
        this.Dispatcher.BeginInvoke(DispatcherPriority.Send,
            new Action(delegate ()
            {
                DoSomething();
            }));
    }
    catch { }
}));
thread.Name = "ThreadName";
thread.Start(); 
```

不同之处在于 NoArgsHandle 被 Action 取代，但委托仍然存在。我对睡眠时间进行了一些调整，但这只会缩短几分之一秒。我认为 thread.Name 是必要的，以避免获得多个具有相同名称的线程，但将其排除在外似乎不会导致任何问题。

# silverlight - 列表框未填充 Silverlight 2 中的数据绑定

> ID：818917
> 
> 赞同：1
> 
> 时间：2009-05-04T05:52:32.797
> 
> 标签：silverlight, web-services, data-binding

所以我正在尝试学习 Silverlight，所以我构建了一个简单的演示应用程序，它从[FriendFeed](http://friendfeed.com)中提取我的家庭提要并在列表中显示项目。

我已经定义了一个列表框：

```
 <ListBox x:Name="lstItems" Margin="5,61,5,5" Grid.Row="1">            
        <ListBox.ItemTemplate>
            <DataTemplate>
                <StackPanel Margin="8,8,43,8">
                    <TextBlock Text="{Binding Title}" />
                </StackPanel>
            </DataTemplate>
        </ListBox.ItemTemplate>            
    </ListBox> 
```

由 Web 服务调用填充

```
private void LoginButton_Click(object sender, RoutedEventArgs e)
{
    FriendFeedServiceClient client = new FriendFeedServiceClient();
    client.GetHomeCompleted += new EventHandler<GetHomeCompletedEventArgs>(client_GetHomeCompleted);
    client.GetHomeAsync(FfUsername.Text, FfApiKey.Password);
}

void client_GetHomeCompleted(object sender, GetHomeCompletedEventArgs e)
{
    lstItems.DataContext = e.Result;
} 
```

正在调用本地网络服务，该`FriendFeedServiceClient`服务代理对实际 FriendFeed 网络服务的请求。

服务调用工作正常，返回项目，如果我调试调用，该`lstItems.DataContext`属性将填充一个包含数据的项目列表，但该列表不显示任何内容，它始终为空白。我错过了什么吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-04T06:00:52.403

你需要绑定你的列表框，像这样

```
<ListBox x:Name="lstItems" Margin="5,61,5,5" Grid.Row="1" ItemsSource="{Binding}"> 
```

然后 TextBlock 与路径 Title 的绑定应该可以工作。

编辑：您正在设置 DataContext，这暗示您可能正在绑定自定义对象，您是否尝试将 e.GetResult 转换为您的自定义对象，类似于

```
YourCustomObject obj = (YourCustomObject) e.GetResult;
lstItems.DataContext = obj; 
```

高温高压

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-04T12:59:43.847

您没有绑定到 DataContext。

尝试添加`ItemsSource="{Binding}"`：

```
<ListBox x:Name="lstItems" Margin="5,61,5,5" Grid.Row="1" ItemsSource="{Binding}"> 
```

然后确保对象的 class 和 Title 属性都不是私有的。如果有任何绑定错误消息，请检查输出（Visual Studio 中的 int 输出窗口）并告知我们。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-04T13:35:33.730

而不是[`DataContext`](http://msdn.microsoft.com/en-us/library/system.windows.frameworkelement.datacontext(VS.95).aspx)你应该设置[`ItemsSource`](http://msdn.microsoft.com/en-us/library/system.windows.controls.itemscontrol.itemssource(VS.95).aspx). 如果您使用`DataContext`，那么您必须`ItemsSource`使用绑定进行设置，但是，对于您要执行的操作，这种间接级别是不必要的。

[有关在ListBox](http://msdn.microsoft.com/en-us/library/system.windows.controls.listbox(VS.95).aspx)中列出数据的详细信息，请参阅此[MSDN 文章](http://msdn.microsoft.com/en-us/library/cc265158(VS.95).aspx)。

# php - 当我在 CakePHP 中刷新页面时，如何重置视图中的所有表单域？

> ID：818919
> 
> 赞同：0
> 
> 时间：2009-05-04T05:52:48.867
> 
> 标签：php, cakephp

如何在[CakePHP](http://en.wikipedia.org/wiki/CakePHP)中每次刷新时重置表单中的所有字段？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2010-02-25T16:52:24.710

在视图中使用表单助手时，您是否在问如何使 Cake 不会自动将数据放入表单中？如果是这样，Cake 只获取 Controller::$data 中的数据，并使用匹配的数组索引到字段名称来填充这些字段。要停止这种情况，只需设置 $this->data = null; 在与视图相对应的控制器操作中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2010-02-25T20:15:10.390

如前所述，您可以通过将 $this-data 设置为 null 来使所有表单数据无法访问。您还可以查看生成的 HTML 页面、表单元素的名称，并可以选择性地取消设置 $this->data['objectName'] 或 $this->data['objectName']['memberName']。

# c# - C# Socket：通过代理服务器连接到服务器

> ID：818921
> 
> 赞同：2
> 
> 时间：2009-05-04T05:54:50.577
> 
> 标签：c#, networking, proxy, sockets

对比 2008

我正在使用下面的代码来检测客户端是否可以连接到我们的 SIP 服务器。这工作正常。但是，客户端已经改变了网络，现在我的应用程序必须从代理服务器后面连接到 SIP 服务器。

我得到的错误是：

> “连接尝试失败，因为连接方在一段时间后没有正确响应，或者建立连接失败，因为连接的主机没有响应 xxx.xxx.xx.xx:xx”

这段代码工作正常，直到我必须从代​​理服务器后面连接。

我在那里看不到任何属性，我可以将代理地址添加到套接字。

我错过了什么吗？

非常感谢您的任何建议，

```
public bool IsSIPServerAvailable()
{
    bool isAvailable = true;
    Socket sock = new Socket(AddressFamily.InterNetwork,
                             SocketType.Stream,
                             ProtocolType.Tcp);

    try
    {
        sock.Connect("xxx.xxx.xx.xx", xx);
    }
    catch (SocketException ex)
    {
        Console.WriteLine(ex.Message);
        isAvailable = false;
    }
    catch (Exception ex)
    {
        Console.WriteLine(ex.Message);
        isAvailable = false;
    }
    finally
    {
        if (sock.Connected)
        {
            sock.Close();
        }
    }

    return isAvailable;
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2010-06-27T12:21:54.930

[在这里](https://stackoverflow.com/questions/3127127/how-to-open-socket-thru-proxy-server-in-net-c/3127176#3127176)查看我的答案，也许会有所帮助。一般的想法是首先建立到代理的连接，然后使用 HTTP CONNECT 命令打开另一个到给定主机和端口的 TCP 连接。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-04T06:10:10.913

[这与这个问题](https://stackoverflow.com/questions/691550/c-tcpclient-proxy)非常相似。我认为不可能通过代理服务器创建套接字连接。您将需要某种协议，通常管理员会设置代理服务器以拒绝来自标准 HTTP、HTTPS 以外的端口的连接。

一种解决方案是使用 HTTP 上的隧道。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-04T06:11:49.537

代理的整个想法是在不更改应用程序的情况下更改网络拓扑。因此无需更改应用程序，但需要更改代理配置/设置。

要独立于您的应用程序检查代理配置，您可以使用`Telnet Host Port`并查看是否收到相同的超时/错误消息，或者在输入几个字符后是否断开连接。

# javascript - JavaScript 事件中的局部变量问题

> ID：818926
> 
> 赞同：1
> 
> 时间：2009-05-04T05:58:13.720
> 
> 标签：javascript, dom-events

我正在开发一个页面，该页面具有可调整大小和可拖动的 div，并且我已将`mousedown`,`mousemove`和`mouseup`事件处理程序附加到该 div。

问题出在`mousemove`事件处理程序上。我必须获取 div 的当前宽度、高度、顶部和左侧。为此，我使用函数来返回特定值，并且必须在主函数内的不同条件下使用这些值。

如果我尝试用这些值分配局部变量并在前面的代码中使用这些变量，那么脚本会变慢。意味着调整大小和拖动存在延迟。

但是，如果我每次都调用函数而不是在条件中使用这些变量，那么就没有延迟。

知道什么可能是这个问题的原因吗？

***代码示例***

```
// Code executes with a delay
function AdjustElement()
{
     var elemHeight = GetHeight ( elem );
     var elemWidth = GetWidth ( elem );
     var elemTop = GetTop ( elem );
     var elemLeft = GetLeft ( elem );

     if ( elemLeft >= 20 && elemRight <= 200 )
     {
        //code for moving element
     }
     if ( elemTop >= 20 && elemTop <= 200 )
     {
       // code for moving element
     }
     if ( elemHeight >= 60 && elemHeight <= 300 )
     {
       // code for resizing element
     }
     if ( elemWidth >= 60 && elemWidth <= 300 )
     {
       // code for resizing element
     } 
}

// Code executes without delay
function AdjustElement()
{
     if ( GetLeft(elem) >= 20 && GetRight(elem) <= 200 )
     {
        //code for moving element
     }
     if ( GetTop(elem) >= 20 && GetTop(elem) <= 200 )
     {
       // code for moving element
     }
     if ( GetHeight(elem) >= 60 && GetHeight(elem) <= 300 )
     {
       // code for resizing element
     }
     if ( GetWidth(elem) >= 60 && GetWidth(elem) <= 300 )
     {
       // code for resizing element
     }
}

// General functions
function GetWidth(elem)
{
   return elem.offsetWidth;
}

function GetHeight(elem)
{
   return elem.offsetHeight;
}

function GetTop(elem)
{
   return elem.offsetTop;
}

function GetLeft(elem)
{
   return elem.offsetLeft;
} 
```

# visual-c++ - Mozilla : 我想在 File Download Dilaog 的保存按钮上弹出我自己的对话框

> ID：818929
> 
> 赞同：0
> 
> 时间：2009-05-04T05:59:36.773
> 
> 标签：visual-c++

嗨，我想在 Mozilla 的文件下载对话框的保存按钮上弹出我自己的对话框。你能告诉我怎么可能吗？我正在为本地应用程序工作，而不是为 Web 应用程序工作。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-04T06:03:12.867

您可以创建一个 Java 小程序来管理您的文件下载。

# c# - 如何将值从一种形式传递到另一种形式？

> ID：818930
> 
> 赞同：5
> 
> 时间：2009-05-04T05:59:40.690
> 
> 标签：c#, winforms

考虑一下我有两个窗体的情况，比如`F1`和`F2`。使用后`F1`，我现在已经调用了`F2.ShowDialog()`。这`F2`也会出现在屏幕上。现在这两种形式都是可见的，我如何将数据从`F1`to传递`F2`？此外，一旦`F2`（模态对话框）完成，我如何将数据返回到`F1`？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2010-06-17T03:34:42.350

有没有人考虑过简单地将值传递给标签属性中的表单。

```
Form newForm = new form();
newForm.Tag = passValue;
newform.showmodal(); 
```

当显示 newform 时，加载（或任何其他）例程可以使用标签中的数据

```
public void load()
{
  if (this.Tag.length > 0)
  {
     // do something with the data
  }
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-04T06:04:48.977

在您的 from f1.xml 中的相关位置添加此代码。

```
Form f2 = new Form();
f2.ShowDialog(); 
```

高温高压

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-04T06:37:29.087

```
int x=10;
Form1 f2 = new Form1(x);
f2.ShowDialog(); 
```

这以谁将传递值的形式写入。要接收此值，您必须以接收的形式创建新的构造函数

就是这样

```
public Form2(int x)
  {
        InitializeComponent();
        this.x = x;
 } 
```

当您从 form2 创建实例时，会在第一个表单中注意到您有两个选择，其中一个可以让您传递值

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-04T06:56:50.070

假设您在 Form1 中有一个 TextBox 控件，并且您希望将值从它传递给 Form2 并以模态方式显示 Form2。

在表格 1 中：

```
private void ShowForm2()
{
    string value = TheTextBox.Text;
    Form2 newForm = new Form2();
    newForm.TheValue = value;
    newForm.ShowDialog();
} 
```

在表格 2 中：

```
private string _theValue;
public string TheValue 
{ 
    get
    {
        return _theValue;
    }
    set
    {
        _theValue = value; 
        // do something with _theValue so that it
        // appears in the UI

    }
} 
```

这是一种非常简单的方法，可能不是大型应用程序的最佳选择（在这种情况下，您需要研究 MVC 模式或类似模式）。关键是您按以下顺序执行操作：

1.  创建要显示的表单实例
2.  将数据传输到该新表单实例
3.  显示表格

当您以模态方式显示表单时，它会阻止调用表单中的代码，直到关闭新表单，因此您不能在那里有代码以简单的方式将信息传输到新表单（这是可能的，但不必要地复杂） .

[编辑：扩展 Form2 中的属性方法更清晰]

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-04T06:03:53.520

如果您只想将数据推送到子对话框，请考虑将参数添加到子对话框的构造函数，然后调用 ShowDialog()。但是，以另一种方式传递数据有点棘手。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-04T06:15:49.810

让我重新定义问题 i ve 2 form f1, f2... i cal Form f2 = new Form(); f2.ShowDialog();

// 现在我需要将参数从 f1 窗口传递给 f2（即模态对话框），也将值从 f2 窗体返回给 f1

//现在'正在使用公共命名空间中的变量（对于 f1 ， f2）

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-05-04T06:44:41.707

考虑使用 MVC 模式，即不要在表单中有太多数据并传递它们，而是使用模型类来保留这些东西。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-05-04T07:07:10.777

使用定义的类型作为您的信息（类、结构...）并在 Form1 中声明该类型的变量

```
struct myData
{
    String str1;
    String str2;
}

Public Class Form1
{
  Public myData dat;
} 
```

（注意：类型不应该是公开的，这只是为了这个例子）因此数据位于 Form1 中。修改 Form2 的构造函数以接受*Form1 类型的参数。*

```
public Form2(Form1 frm1)
{
    mFrm1 = frm1;
    InitializeComponent();
} 
```

现在，当您调用 form2 时，发送正在调用*的 Form1 实例*：

```
Form2 frm2 = new Form2(this);
frm2.ShowDialog(); 
```

现在，当执行到 Form2 时，您可以访问 Form1 中的 MyData：
mFrm1.dat；

这样，Form1 和 Form2 的两个实例都将引用位于一个位置的数据。对表单的两个实例都可以进行更改/更新。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2012-07-21T19:47:34.863

可能是我迟到了。但所有可能想要的人。

在目标表单中有一个这样定义的构造函数

```
public partial class Destination: Form
{
    string valueAccepted;
    public Destination(string _valuePassed)
    {
        InitializeComponent();
        this.valueAccepted= _valuePassed;
    }
} 
```

并在源表单中调用这样的表单

```
 Source sourceForm= new Source ("value Passed");
        sourceForm.ShowDialog(); 
```

这样“传递的值”从表单源传递到表单目标

* * *

## 回答 #10

> 赞同：-1
> 
> 时间：2009-05-04T13:36:18.393

有多种方法可以在 2 个表单之间传递数据检查这些链接，其中包含示例视频来执行此操作

-FormToForm 使用属性 - [http://windowsclient.net/learn/video.aspx?v=108089](http://windowsclient.net/learn/video.aspx?v=108089)

*   FormToForm 使用参数 - [http://windowsclient.net/learn/video.aspx?v=105861](http://windowsclient.net/learn/video.aspx?v=105861)

# python - 解析 .txt 文件

> ID：818936
> 
> 赞同：1
> 
> 时间：2009-05-04T06:01:35.413
> 
> 标签：python, parsing, text-files

我有一个 .txt 文件，例如：

```
Symbols from __ctype_tab.o:

Name                  Value   Class        Type         Size     Line  Section

__ctype             |00000000|   D  |       OBJECT   |00000004|     |.data
__ctype_tab         |00000000|   r  |       OBJECT   |00000101|     |.rodata

Symbols from _ashldi3.o:

Name                  Value   Class        Type         Size     Line  Section

__ashldi3           |00000000|   T  |       FUNC      |00000050|     |.text 
```

我如何解析这个文件并获取 FUNC 类型的函数？另外，从这个 txt 我如何解析和提取 .o 名称？

我如何通过按列解析或其他方式获得它们。

我需要立即帮助...像往常一样等待适当的解决方案

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-05-04T06:07:10.657

```
for line in open('thefile.txt'):
  fields = line.split('|')
  if len(fields) < 4: continue
  if fields[3].trim() != 'FUNC': continue
  dowhateveryouwishwith(line, fields) 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-04T22:42:35.380

我认为这可能比使用正则表达式的成本更低，尽管我并不完全清楚你想要完成什么

```
symbolList=[]
for line in open('datafile.txt','r'):
if '.o' in line:
    tempname=line.split()[-1][0:-2]
            pass

if 'FUNC' not in line:
    pass

else:
    symbolList.append((tempname,line.split('|')[0])) 
```

我从其他帖子中了解到，当您第一次阅读文件时，包装所有数据更便宜且更好。因此，如果您想一次性包装整个数据文件，那么您可以执行以下操作

```
fullDict={}
for line in open('datafile.txt','r'):
    if '.o' in line:
        tempname=line.split()[-1][0:-2]
    if '|' not in line:
        pass
    else:
        tempDict={}
            dataList=[dataItem.strip() for dataItem in line.strip().split('|')]
            name=dataList[0].strip()
            tempDict['Value']=dataList[1]
            tempDict['Class']=dataList[2]
            tempDict['Type']=dataList[3]
            tempDict['Size']=dataList[4]
            tempDict['Line']=dataList[5]
            tempDict['Section']=dataList[6]
            tempDict['o.name']=tempname
            fullDict[name]=tempDict
            tempDict={} 
```

然后，如果您想要 Func 类型，您将使用以下内容：

```
funcDict={}
for record in fullDict:
    if fullDict[record]['Type']=='FUNC':
        funcDict[record]=fullDict[record] 
```

很抱歉这么着迷，但我正在努力更好地处理创建列表理解，我认为这值得一试

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-04T06:06:42.187

这是一个基本的方法。你怎么看？

```
# Suppose you have filename "thefile.txt"
import re

obj = ''
for line in file('thefile.txt'):
    # Checking for the .o file
    match = re.search('Symbols from (.*):', line)
    if match:
        obj = match.groups()[0]

    # Checking for the symbols.
    if re.search('|', line):
        columns = [x.strip() for x in a.split('|')]
        if columns[3] == 'FUNC':
            print 'File %s has a FUNC named %s' % (obj, columns[0]) 
```

# python - WxPython：符合确定/取消按钮顺序的跨平台方式

> ID：818942
> 
> 赞同：2
> 
> 时间：2009-05-04T06:04:52.520
> 
> 标签：python, user-interface, cross-platform, wxpython

我正在学习 wxPython，所以大多数库和类对我来说都是新的。

我正在创建一个 Preferences 对话框类，但不知道确保 OK/Cancel（或 Save/Close）按钮在平台上的正确顺序的最佳方法。该程序旨在同时在 GNOME 和 Windows 上运行，因此我想确保每个平台的按钮顺序正确。

wxPython 是否提供了阻止我进行`if platform.system() == 'Linux'`某种黑客攻击的功能？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-04T06:48:22.663

只有使用普通对话框（如 wx.FileDialog）时，对话框的外观才能改变，如果您自己制作，则布局在每个平台上都将保持不变。

wx.Dialog 有一个 CreateStdDialogBu​​ttonSizer 方法，它创建一个带有标准按钮的 wx.StdDialogBu​​ttonSizer ，您可能会看到不同平台上的布局差异，但您不必使用它。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-05T00:38:45.353

您可以使用 StdDialogBu​​ttonSizer

[http://www.wxpython.org/docs/api/wx.StdDialogBu​​ttonSizer-class.html](http://www.wxpython.org/docs/api/wx.StdDialogButtonSizer-class.html)

只要您的按钮具有标准 ID，它们就会按正确的顺序排列。

只是为了添加一个皱纹，例如在 Mac 上，首选项对话框不会有确定/取消按钮。它会在输入时自动应用首选项（或至少在对话框关闭时）。所以在这种情况下你仍然需要做一些平台嗅探。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-04T07:20:45.503

如果您打算使用 wx（或任何其他 x 平台工具包），您最好相信它会做正确的事情，mon！-)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-04T08:52:47.887

有一个 GenericMessageDialog 小部件应该根据平台做正确的事情（但我从未使用过它，所以我不确定它是否有效）。请参阅 wxPython 演示。

您还可以使用 SizedControls 插件库（它是 wxPython 的一部分）。SizedDialog 类有助于创建符合每个平台的人机界面指南的对话框。请参阅 wxPython 演示。

# c++ - 链接 C++ 流

> ID：818947
> 
> 赞同：3
> 
> 时间：2009-05-04T06:07:59.517
> 
> 标签：c++, iostream

我正在考虑将几个c ++ iostreams“链接”在一起以过滤输入两次。我正在使用 gzstreams 读取 zlib 压缩文件，并且正在考虑编写一个从流中读取并执行编码转换的流。也许通过将打开的流作为构造函数参数传递...您认为如何最好地完成？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-04T06:36:48.650

我没有使用过这个，但是 boost 的[过滤流](http://www.boost.org/doc/libs/1_38_0/libs/iostreams/doc/classes/filtering_stream.html)可能会有所帮助。

作为一个例子，我发现了一个带有[indent.hpp](http://lists.boost.org/Archives/boost/att-133679/indent.hpp)[的邮件列表帖子](http://lists.boost.org/Archives/boost/2008/02/133679.php)，它实现了一个缩进输出的输出过滤器：

```
boost::iostreams::filtering_ostream out; 
indent_filter::push(out,2); 
out.push(std::cout); 
```

> 并像这样使用它：

```
out << "Hello Filter!\n" 
    << indent_in 
    << "this is\n" 
    << "indented\n" 
    << indent_out 
    << "until here\n" 
    ; 
```

> 这将导致输出：

```
Hello Filter! 
  this is 
  indented 
until here 
```

# python - 如何将字符串数字转换为列表中的整数？

> ID：818949
> 
> 赞同：12
> 
> 时间：2009-05-04T06:09:00.997
> 
> 标签：python, string, integer, numbers

我有一个清单说：

```
['batting average', '306', 'ERA', '1710'] 
```

如何在不接触字符串的情况下转换预期的数字？

感谢您的帮助。

* * *

## 回答 #1

> 赞同：41
> 
> 时间：2009-05-04T06:11:33.267

```
changed_list = [int(f) if f.isdigit() else f for f in original_list] 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-05-04T06:18:20.660

数据看起来就像你会知道数字应该在哪个位置。在这种情况下，最好在这些位置显式转换数据，而不是仅仅转换任何看起来像数字的东西：

```
ls = ['batting average', '306', 'ERA', '1710']
ls[1] = int(ls[1])
ls[3] = int(ls[3]) 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-05-04T10:40:37.503

试试这个：

```
def convert( someList ):
    for item in someList:
        try:
            yield int(item)
        except ValueError:
            yield item

newList= list( convert( oldList ) ) 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-04-24T14:50:06.920

```
a= ['batting average', '306', 'ERA', '1710.5']

[f if sum([c.isalpha() for c in f]) else float(f) for f in a ] 
```

如果您的列表包含浮点数、字符串和整数（正如评论中@d.putto 所指出的）

# nhibernate - 为主模板建模：继承与否？

> ID：818964
> 
> 赞同：1
> 
> 时间：2009-05-04T06:14:48.017
> 
> 标签：nhibernate, design-patterns, database-design, class-design

我有一个不容易解释的场景，但我确信这是一个非常普遍的问题。我会尽力说明问题。

假设我们有一个调查应用程序，它允许我们创建调查。每个调查都有自己的结构（包含问题、问题被分组和排序等）。这些调查由管理员管理并称为主调查模板。现在，用户可以选择其中一项主调查，进行一些自定义并对某些人进行调查。

所以，基本上我们的调查都具有相同的结构（集合、属性等），但数据可能不同。

**你如何为数据库建模？**

我的想法是将所有内容存储在一个表中并创建一个将模板与执行模板分开的列。

```
tbl_Survey (id, name, conducted_on) 
```

**你如何为你的课程建模？**

我的想法是：

```
Survey {
  Name
  Questions
}

ConductedSurvey : Survey {
  //gets the master according to the name
  GetMaster()
} 
```

## 重要提示：调查与其他类有很多关系。如果我们决定子类化。是否应该将它们全部子类化（因为我们将从 master 复制每个对象的数据）？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-04T08:45:27.110

> 因此，基本上我们的调查都具有相同的结构（集合、属性等），但数据可能不同......我的想法是将所有内容存储在一个表中并创建一个将模板与执行的模板分开的列。

好的，你说的是原型。“模板”调查是一个原型。显然，如果原型与基于原型的实例具有完全相同的结构，那么为同一结构创建完全不同的表将是愚蠢和浪费的——当您意识到这意味着该结构的任何变化时更是如此必须在两组中镜像。

我会添加一列来区分原型/模板与进行的调查吗？不，可能不是。相反，我会添加另一个表，与根调查表具有一对一的关系。在此表中，我将添加一些元数据，以区分原型和非原型。

出于三个原因：1）在任何合理的系统中，原型将是总调查的一小部分。2) 我经常想列出所有原型，例如在“创建新调查向导”中列出了新调查所基于的原型选择。3）保存一点额外的数据：

```
create table survey_prototype (
    id int not null primary key,
    survey_id references survey(id) -- the regular survey table
    wizard_description varchar(80)
    . . . .
); 
```

现在，我想该调查也有描述，但对于原型，该描述类似于“替换我，这是用户将看到的描述”，但该 wizard_description 类似于“原型政治民意调查”。

现在，由于原型/模板的任何查找都没有机会返回进行的调查（因为没有进行的调查加入到survey_prototype），所以您的 getMaster 看起来（从概念上讲，大概您使用 ORM）如下所示：

```
ConductedSurvey : Survey {
  //gets the master according to the name
  GetMaster() { "select * from survey_prototype join survey..."
} 
```

> 重要提示：调查与其他类有很多关系。如果我们决定子类化。是否应该将它们全部子类化（因为我们将从 master 复制每个对象的数据）？

您是对的：对于您通过 ORM 检索到的任何原型，您必须对其进行深度复制以保存新调查，而不是覆盖原型。由于无论如何您都必须进行深拷贝，因此在深拷贝中，您可以创建一个子类副本，而不是复制原型使用的基类。

当然，您必须在层次结构的每个级别上做出决定；将深度复制转换的每个转换策略封装在一个类中会很好。访问者模式将执行此操作，因为它对`visit`您的类型的每个（基）类都有一个重载函数：所以（至少）`visitSurvey`、、、`visitQuestion`。`visitAnswer`

由于您将处理一棵树（植根于调查，有子问题和孙子答案，即复合模式），我建议您在副本/转换器中使用访问者模式。由于您的课程相对稳定，因此访问者会很好地工作。它允许您拥有多个不同的具体访问者，每种类型的转换都有一个（当需要显示或评分调查时，您也可以为此编写访问者 - 因此您将获得该功能几乎“用于免费”设置访客模式后）。

要处理数据库中的子类化，您可以为此使用任何一种常见的 nhibernate 模式；这样，一旦您访问并转换，您将拥有一个新的非原型调查树，它可以由 nhibernate 自动保存到数据库中。

总结一下：survey_prototype 表，得到一个原型，当你在survey_prototype 请求根时，nhibernate 将检索整个树，使用返回复制根的深度复制转换器访问该树，让用户在上面写，保存复制根并让 nhibernate 递归地保存树的每个节点。当用户需要查看非原型调查时，使用 nhibernate 从调查中拉根，使用显示访问者显示等。

# iphone - 如何在 App Store (iTunes) 中链接到我的应用程序？

> ID：818973
> 
> 赞同：27
> 
> 时间：2009-05-04T06:17:32.347
> 
> 标签：iphone, ios, app-store

我想在我的应用程序中有一个功能，用户可以通过我的应用程序的 iTunes URL 向朋友发送电子邮件。这怎么可能？

谢谢。

* * *

## 回答 #1

> 赞同：47
> 
> 时间：2009-05-04T07:05:31.733

您可以创建更简单、更合乎逻辑的 App Store 链接，而不是您通常看到的冗长且令人困惑的 url。iTunes Store 有一个更合乎逻辑的隐藏 URL 格式。根据您链接的内容，您只需要以下列格式之一构建 URL：

1.  艺术家姓名或 App Store 开发者姓名：http: [//itunes.com/Artist_Or_Developer_Name](http://itunes.com/Artist_Or_Developer_Name)
2.  专辑名称：http: [//itunes.com/Artist_Name/Album_Name](http://itunes.com/Artist_Name/Album_Name)
3.  应用程序：http: [//itunes.com/app/App_Name](http://itunes.com/app/App_Name)
4.  电影：http: [//itunes.com/movie/Movie_Title](http://itunes.com/movie/Movie_Title)
5.  电视：http: [//itunes.com/tv/Show_Title](http://itunes.com/tv/Show_Title)

只需在您创建的电子邮件正文中包含此格式的 url。

（请注意，空格可能会导致问题，但我发现省略它们完全适合我 - [http://itunes.com/app/FrootGroove](http://itunes.com/app/FrootGroove)重定向到名为“Froot Groove”的应用程序。）

（另请注意，如果这对您不起作用，iTunes 链接制造商就[在这里](http://ax.phobos.apple.com.edgesuite.net/WebObjects/MZStoreServices.woa/wa/itmsLinkMaker)）

您的代码将是这样的（从我的中提取，匿名且未经测试）

```
NSString* body = [NSString stringWithFormat:@"Get my app here - %@.\n",myUrl];

#if __IPHONE_OS_VERSION_MIN_REQUIRED <= __IPHONE_2_2
[NSThread sleepForTimeInterval:1.0];
NSString* crlfBody = [body stringByReplacingOccurrencesOfString:@"\n" withString:@"\r\n"];
NSString* escapedBody = [(NSString*)CFURLCreateStringByAddingPercentEscapes(kCFAllocatorDefault,  (CFStringRef)crlfBody, NULL,  CFSTR("?=&+"), kCFStringEncodingUTF8) autorelease];

NSString *mailtoPrefix = [@"mailto:xxx@wibble.com?subject=Get my app&body=" stringByAddingPercentEscapesUsingEncoding:NSUTF8StringEncoding];

// Finally, combine to create the fully escaped URL string
NSString *mailtoStr = [mailtoPrefix stringByAppendingString:escapedBody];

// And let the application open the merged URL
[[UIApplication sharedApplication] openURL:[NSURL URLWithString:mailtoStr]];
#endif 
```

你可以在 iPhone 3.0 中做更好的事情，但我还不能谈论这些。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-07-10T17:37:34.500

在 OS 3.0 中，您可以使用 MessageUI 框架来执行此操作，而无需离开应用程序（使用 Jane 的代码作为 3.0 之前设备的后备）：

```
- (void)sendEmail
{
    NSString* body = [NSString stringWithFormat:@"Get my app here - %@.\n",myUrl];

#if __IPHONE_OS_VERSION_MIN_REQUIRED <= __IPHONE_2_2
    Class mailClass = (NSClassFromString(@"MFMailComposeViewController"));
    if (mailClass != nil && [mailClass canSendMail])
    {
        MFMailComposeViewController *picker = [[MFMailComposeViewController alloc] init];
        picker.mailComposeDelegate = self;
        picker.subject = @"Get my app";
        [picker setToRecipients:[NSArray arrayWithObject:@"xxx@wibble.com"];
        [picker setMessageBody:body isHTML:NO];

        [self presentModalViewController:picker animated:NO];
        [picker release];
    } else {
        [NSThread sleepForTimeInterval:1.0];
        NSString* crlfBody = [body stringByReplacingOccurrencesOfString:@"\n" withString:@"\r\n"];
        NSString* escapedBody = [(NSString*)CFURLCreateStringByAddingPercentEscapes(kCFAllocatorDefault,  (CFStringRef)crlfBody, NULL,  CFSTR("?=&+"), kCFStringEncodingUTF8) autorelease];

        NSString *mailtoPrefix = [@"mailto:xxx@wibble.com?subject=Get my app&body=" stringByAddingPercentEscapesUsingEncoding:NSUTF8StringEncoding];

        // Finally, combine to create the fully escaped URL string
        NSString *mailtoStr = [mailtoPrefix stringByAppendingString:escapedBody];

        // And let the application open the merged URL
        [[UIApplication sharedApplication] openURL:[NSURL URLWithString:mailtoStr]];
    }
#endif
}

#pragma mark -
#pragma mark Mail Composer Delegate
- (void)mailComposeController:(MFMailComposeViewController*)controller didFinishWithResult:(MFMailComposeResult)result error:(NSError*)error 
{
    if (result == MFMailComposeResultFailed) {
        UIAlertView *alert = [[UIAlertView alloc] initWithTitle:[error localizedDescription] message:[error localizedFailureReason] delegate:nil cancelButtonTitle:NSLocalizedString(@"OK", @"OK") otherButtonTitles:nil];
        [alert show];
        [alert release];
    }
    [self dismissModalViewControllerAnimated:YES];
} 
```

请注意，您的班级必须采用该`MFMailComposeViewControllerDelegate`协议。您还可以包含附件、在正文中使用 HTML 等等。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-02-11T19:54:13.273

您现在可以使用 appstore.com/APP_NAME 在 iTunes 中启动应用程序。这适用于桌面和 iOS 设备。然而，这不像其他方法那样可靠。在此处查看答案[如何为苹果应用商店创建虚荣网址？](https://stackoverflow.com/questions/14687635/how-to-create-vanity-url-for-apple-appstore)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-03-07T06:05:03.740

此代码根据应用名称**自动生成应用商店链接**，无需其他任何内容，**拖放**：

```
NSCharacterSet *trimSet = [[NSCharacterSet characterSetWithCharactersInString:@"abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLKMNOPQRSTUVWXYZ0123456789"] invertedSet];    
NSArray *trimmedAppname = [[NSString stringWithString:[[[NSBundle mainBundle] infoDictionary] objectForKey:@"CFBundleName"]] componentsSeparatedByCharactersInSet:trimSet];
NSString *appStoreLink = @"http://itunes.com/app/"; 
for (NSString *part in trimmedAppname) appStoreLink = [NSString stringWithFormat:@"%@%@",appStoreLink,part];
NSLog(@"App store URL:%@",appStoreLink); 
```

它为您提供了一个链接，例如[http://itunes.com/app/angrybirds](http://itunes.com/app/angrybirds)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-01-19T16:20:27.493

顺便说一句，通过访问应用程序商店的应用程序并单击“告诉朋友”，可以找到通过 ID 指向应用程序的链接——然后给自己发送一封电子邮件。我发现这是非常有用的。

# cakephp - 在 CakePHP 框架中添加 WikiMedia 引用时如何避免单独登录？

> ID：818974
> 
> 赞同：1
> 
> 时间：2009-05-04T06:17:57.527
> 
> 标签：cakephp, login, mediawiki

我的团队正在尝试使用 Media Wiki 让用户发布更深入的科学研究分析。但是，MediaWiki 需要单独登录，这确实很麻烦。

有没有办法绕过单独的 Media Wiki 登录，以便已经登录到我们网站的用户可以直接进入 Wiki Media 并发布参考资料，而无需通过单独的登录屏幕？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-07T03:46:23.217

可以[为 MediaWiki 的身份验证系统添加扩展](http://www.mediawiki.org/wiki/Category:User_identity_extensions)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-07T03:18:40.710

不过，我不知道您的 CakePHP 身份验证是如何工作的，最佳解决方案是对两者都使用 OpenID。您可以为 MediaWiki 安装一个扩展来执行此操作。

见[http://www.mediawiki.org/wiki/Extension:OpenID](http://www.mediawiki.org/wiki/Extension:OpenID)

另一种选择是在用户成功登录到您的 CakePHP 应用程序时发送 curl 以将它们登录到 wiki。

# c++ - 在qt中，如何实现与代码中的变量保持一致的小部件

> ID：818981
> 
> 赞同：1
> 
> 时间：2009-05-04T06:24:06.903
> 
> 标签：c++, qt, qt4

这是一个 SpinBox 示例，它将其更改写入基础变量。我遇到的主要问题是在构造小部件时调用 valueChanged。有没有更优雅的方法来做到这一点？我认为将小部件连接到自身很奇怪，但 valueChanged 不是虚拟的。

```
class ValueWriterInt: public QSpinBox {
    Q_OBJECT

public:
    ValueWriterInt(vector<int*> const& value): myValue(value) { 
        QObject::connect(this, SIGNAL(valueChanged(int)), this, SLOT(valueChanged(int)));
    }
    ~ValueWriterInt() {}

private slots:
    void    valueChanged(int new_value) {
        for (auto it = myValue.begin(); it != myValue.end(); ++it)
            **it = new_value;
    }

private:
    vector<int*>        myValue;
}; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-04T15:30:23.173

我认为将小部件连接到自身并没有什么特别奇怪的地方。拥有检测和响应数据更新的单一方法实际上听起来是一件好事，因为在调试时检查的故障点更少。在您的特定情况下，它会导致一些不良行为，但总的来说这是一个很好的解决方案。

现在，在表达了自反连接并非天生不优雅的观点之后，我将建议一种不太“优雅”的解决方案来防止调用`valueChanged`后构造。您可以有一个标志来确定对象是否刚刚构造并提前返回以防止代码在构造后立即运行。在您的示例中：

```
class ValueWriterInt: public QSpinBox {
Q_OBJECT

public:
    ValueWriterInt(vector<int*> const& value): myValue(value), myAfterInit(true) { 
        QObject::connect(this, SIGNAL(valueChanged(int)), this, SLOT(valueChanged(int)));
    }
    ~ValueWriterInt() {}

private slots:
    void        valueChanged(int new_value) {
        if (myAfterInit) {
            myAfterInit = false;
            return;
        }
        for (auto it = myValue.begin(); it != myValue.end(); ++it)
                **it = new_value;
    }

private:
    vector<int*>                myValue;
    boolean                     myAfterInit;
}; 
```

这不是一个太糟糕的解决方案。它至少会给你你想要的行为，直到（如果）你能找到一个更优雅的方法。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-04T06:53:45.583

那么你想在这里完成什么？是的，valueChanged 不是虚拟的——为什么它应该是，你的对象应该直接将*它们自己的*槽连接到它们想要响应的任何信号，不是吗？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-04T08:48:05.170

除了使用 SIGNAL-SLOT 连接，我没有其他选择。但是，我会更改插槽的名称，因此它与信号的名称不同。

即使尚未完成连接，如何调用插槽也很有趣。我怀疑更改插槽的名称将解决该问题。

# c# - 每次运行后清除与跟踪侦听器关联的日志？

> ID：818992
> 
> 赞同：3
> 
> 时间：2009-05-04T06:30:49.617
> 
> 标签：c#, logging, app-config, trace

我正在使用 TextWriterTraceListener 进行日志记录，正在使用 app.config 将其配置到应用程序中，如下所示。

```
<?xml version="1.0" encoding="utf-8" ?>
<configuration>
  <system.diagnostics>
    <trace autoflush="true" indentsize="100"  >
      <listeners>
        <add name="myListener" type="System.Diagnostics.TextWriterTraceListener" 
             initializeData="MyLog.log" />
        <remove name="Default" />
      </listeners>
    </trace>
  </system.diagnostics>
</configuration> 
```

如何确保每次运行后重新开始记录（清除以前的内容），而不是将内容附加到现有日志？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-04T07:12:34.680

最好的方法是从`TextWriterTraceListener`类中派生出您自己的 Custom TraceListener。这是一个在每个时间间隔滚动一个新日志文件[的示例。](http://davebost.com/blog/2004/04/30/rolling-over-textwritertracelistner-logs/)您应该能够修改此实现。

# asp.net - 快速 Web UI 开发

> ID：818993
> 
> 赞同：1
> 
> 时间：2009-05-04T06:30:50.600
> 
> 标签：asp.net, javascript, user-interface

我目前正在开发一个网络应用程序，它将取代某些办公室的旧系统。（非常古老，因为它们在 FoxPro 中）

我目前的任务是开发一个非常类似于桌面的快速 UI，意思是，尽量不使用鼠标，这样他们就可以相当快速地捕获数据，而且几乎不用看就可以做到。

他们期望这样的事情：

使用箭头键导航，填写完当前字段后跳转到下一个字段，在一个字段上按 Enter，然后出现一个包含数据的列表供他们选择（使用箭头键再次导航）等。

我可以很容易地用 javascript 完成这项工作，但是由于我被要求帮助完成这个项目，因为完成它的时间框架非常短，

**哪些库、控件或类似工具可以帮助我快速完成这项工作？**

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-04T06:35:07.470

使用 JQuery...忘记跨浏览器 DOM 处理。JQuery 在 VS.Net 中有很好的支持。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-04T07:05:00.423

为了帮助您节省一些时间，这里是“按下回车键时的下一个字段”的代码：（您需要 JQuery）

```
$.fn.focusNextInputField = function() {
    return this.each(function() {
       var fields = $(this).parents('form:eq(0),body').find('button,input,textarea,select');
       var index = fields.index(this);
       if (index > -1 && (index + 1) < fields.length) {
          this.blur();
          fields.eq(index + 1).focus();
       }
       return false;
    });
};

$("button,input,textarea,select").keydown(function(event) {
    switch (event.keyCode) {
        case 13: $(this).focusNextInputField();
            break;
    }
}); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-04T07:00:08.813

您还没有提到您需要的浏览器支持类型。这个网络应用听起来需要捕捉和处理相当多的键盘事件。

不同的浏览器处理事件的方式不同。因此，您需要牢记这一点。

是的，滚动您自己的密钥处理 Javascript 相对简单，但使用免费的公共框架（如 JQuery、Prototype 或 Dojo）肯定更好。与其建议一个而不是另一个（SO 社区似乎对 JQuery 有一个特殊的软角，相信我！），我会说，检查它们并自己决定。

您可能还想研究提供您需要的应​​用程序功能的预构建（商业或其他）自定义控件。例如，如果您需要电子表格类型的数据输入界面，则可以在 Web 上使用许多控件。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-04T07:08:23.037

你熟悉 ExtJS ( [http://extjs.com/](http://extjs.com/) ) 吗？

我认为这是一个真正的 Web 应用程序框架。JQuery 更像是一个具有很多（非常好的）功能的“库”。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-04T06:49:04.130

我推荐 Dojo——我意识到它不像 JQuery 那样流行（Google 上的点击数：dojo 1300 万，jquery 13.4）——但它的架构和设计更好！

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-04T06:56:33.270

许多旧的 FoxPro 应用程序针对用户生产力进行了优化。我想我已经很久没有看到“用户生产力”被用作软件工具评估参数了。尤其不适用于基于浏览器的应用程序。

首先你需要一些方法来衡量。每分钟击键次数和每分钟处理的表单曾经是很常见的方法。但是将 AJAX 投入其中会减慢速度 - javascript 在这一点上还不是一种高速执行语言。即使有铬。

您最好的选择可能是 flex 和 silverlight。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-05-04T07:04:45.947

教他们如何使用 tab 和 shift-tab 返回。Enter 用于“输入”信息，而不是“下一步”。只需真正了解表单中的选项卡索引，它应该为您的用户流畅地流动

为他们带来一个界面，将他们带到现在，而不是陪审团操纵一个系统，将所有那些来自 DOS 和基于文本的系统的可怕约定转化为基于 Web 的系统。

# scala - Scala 中的抽象类型/类型参数

> ID：818996
> 
> 赞同：16
> 
> 时间：2009-05-04T06:33:27.147
> 
> 标签：scala, types

我正在尝试编写一些需要执行以下操作的 Scala 代码：

```
class Test[Type] { 
   def main {
       SomeFunc classOf[Type]
       val testVal: Type = new Type()
    }
 } 
```

它失败了。我显然不了解 Scala 泛型参数。显然，误解是在 C++ 中，模板的功能本质上类似于字符串替换，因此只要传入的类具有默认构造函数， new Type() 就可以工作。然而，在 Scala 中，类型是不同种类的对象。

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2009-05-04T14:27:27.473

正如您所指出的，C++ 有模板。简而言之，C++ 说“对于所有类型 T 都有一个 Test 可以编译 Test”。这使得在 T 上隐式添加约束变得容易，但不利的一面是，它们是隐式的，如果不阅读代码，您的类的用户可能很难理解。

Scala 的参数多态性（又名泛型）的工作方式更像 ML、Haskell、Java 和 C#。在 Scala 中，当您编写“class Test[T]”时，您是在说“对于所有 T，存在一个类型 Test[T]”，没有约束。这在形式上更容易推理，但这确实意味着您必须明确约束。例如，在 Scala 中，您可以说“class Test[T <: Foo]”来表示 T 必须是 Foo 的子类型。

C# 有一种方法可以为 T 添加关于构造函数的约束，但不幸的是 Scala 没有。

有几种方法可以在 Scala 中解决您的问题。一个是类型安全的，但更冗长。另一个不是类型安全的。

类型安全的方式看起来像

```
class Test[T](implicit val factory : () => T) {
  val testVal = factory
} 
```

然后，您可以为系统中有用的类型提供大量工厂

```
object Factories {
  implicit def listfact[X]() = List[X]()
  implicit def setfact[X]() = Set[X]()
  // etc
}

import Factories._
val t = new Test[Set[String]] 
```

如果您的库的用户需要他们自己的工厂，那么他们可以添加自己的工厂对象等价物。此解决方案的一个优点是可以使用任何带有工厂的东西，无论是否有无参数构造函数。

不那么类型安全的方式使用反射和 Scala 中称为清单的特性，这是一种绕过 Java 类型擦除约束的方法

```
 class Test[T](implicit m : Manifest[T]) {
   val testVal = m.erasure.newInstance().asInstanceOf[T]
 } 
```

使用此版本，您仍然可以编写

```
class Foo
val t = new Test[Foo] 
```

但是，如果没有可用的无参数构造函数，您将获得运行时异常而不是静态类型错误

```
scala> new Test[Set[String]] 
java.lang.InstantiationException: scala.collection.immutable.Set
at java.lang.Class.newInstance0(Class.java:340) 
```******************