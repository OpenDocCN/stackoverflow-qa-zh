# StackOverflow 问答 10180000-10180999

# logic-programming - Maude 语言的社区资源

> ID：10180000
> 
> 赞同：3
> 
> 时间：2012-04-16T18:59:38.130
> 
> 标签：logic-programming

[学习莫德语言](http://en.wikipedia.org/wiki/Maude_system)时，我该去哪里寻求互动帮助？

我找到了具有出色指导的书籍、教程和网页。我找不到任何类型的交互，例如 IRC 频道、活动邮件列表或堆栈交换（有[这样的列表](http://lists.cs.uiuc.edu/pipermail/maude-help/)，但它每月收到一两条消息。）

这种语言还有哪些其他人际资源？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2015-04-22T02:16:51.850

我在 freenode 上创建了频道#maude，让我们潜伏在那里并将其变成一个活跃的社区。

Maude 是一门很好的语言。

# email - TinyMCE 编辑器在消息撰写期间不显示圆形立方体

> ID：10180001
> 
> 赞同：0
> 
> 时间：2012-04-16T18:59:53.177
> 
> 标签：email, tinymce, html-email, roundcube

我正在做一个关于 roundcube 的新项目，经过长时间的不眠之夜，我设法在测试服务器上安装和配置了所有必要的软件 roundcube。我可以登录服务器并发送和接收消息，但问题是我在撰写消息时无法看到 TinyMCE 编辑器。

在 main.inc.php 文件中启用了以下参数：

// 默认编写 html 格式的邮件 $rcmail_config['htmleditor'] = TRUE;

但我仍然找不到编辑器。当我查看加载的撰写页面的源代码时，我能够看到加载的 tiny_mce javascript 文件，这使得编辑器未显示的原因更加令人困惑。

我错过了什么吗？请帮忙...

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-17T09:08:39.647

您需要调用一些 javascript 来使编辑器出现。理想情况下，您的页面上有类似以下脚本的内容：

```
<script type="text/javascript">
tinyMCE.init({
        // General options
        mode : "textareas",
        theme : "advanced"
});
</script> 
```

这会将页面上的所有文本区域转换为 tinymce 实例。

有许多配置选项允许定义您想在哪里看到的按钮以及更多... [这里是](http://www.tinymce.com/wiki.php/Configuration)所有可能的配置选项的列表。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-20T05:44:54.417

谢谢你的信息，但我试过你说的，它没有用:(

但是，实际问题是在服务器上找不到 tiny_mce 编辑器 js 文件。一旦我是 apache 错误日志，我就能够确认这一点。我上传了 tiny_mce 编辑器 js 文件，现在我可以在撰写消息时看到编辑器。

# actionscript-3 - 动态放置标签

> ID：10180006
> 
> 赞同：0
> 
> 时间：2012-04-16T19:00:15.657
> 
> 标签：actionscript-3, apache-flex, flash-builder

在我的 .mxml 文件中，我使用数据库中的文本数据填充两个并排的标签。

像这样：

```
 <s:Label x="10" y="37.5" width="100%" text="{data.city}"/>
    <s:Label x="86" y="36.75" width="100%" text="{data.state}"/> 
```

有时，我会得到一段特别长的文本数据，这会导致 2 个标签相互重叠，变得完全不可读。

我认为这是因为我设置了 x 和 y。有没有办法让这更加动态？

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-16T19:20:08.067

我建议探索不同的 Flex 布局容器。

## H集团

```
<s:HGroup>
    <s:Label text="{data.city}"/>
    <s:Label text="{data.state}"/>
</s:HGroup> 
```

这提供了听起来像您从示例中寻找的那种布局。但是，您可能还想查看 Flex 提供的其他一些容器。

## 形式

Flex 表单以通常对创建表单有用的方式对齐数据。您可能希望为您的 UI 考虑这一点，尤其是当您允许用户提供持久回您的数据库的输入时。

```
<s:Form>
    <s:FormItem label="City:">
        <s:Label text="{data.city}"/>
    </s:FormItem>
    <s:FormItem label="State:">
        <s:Label text="{data.state}"/>
    </s:FormItem>
</s:Form> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-16T19:10:25.927

尝试将第二个标签的 X 设置为第一个标签的宽度 + 空格 + x 第一个标签。

所以：第一个标签宽度 + 空格 + 第一个标签的 x

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-16T19:17:57.880

你可以做几件事：

如果您有一个函数被调用来设置每个标签的值，请根据该函数中的内容重新定位标签。

如果标签的值绑定到数据，因此您不必在数据刷新时收到通知，那么是时候重写`updateDisplayList()`UIComponent 的方法，并让它重新定位您的标签。

通过理解和使用 UIComponent 的生命周期，可以获得很多效率（这将提高您的性能）。如果你只用谷歌搜索“Flex 组件生命周期”，就会有很多关于这个主题的好信息

祝你好运！

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-04-17T05:48:23.760

如果您必须以有限的宽度显示标签，那么您可以使用标签的 maxWidth 属性，这将在标签中显示您的文本，如果文本很长，那么它将显示一些文本并以 ... 格式保留。

```
<s:Label text="{data.city}" maxWidth="150"/> 
```

# xslt - 使用 XSLT 检测节点与其后续兄弟节点之间的空间或文本

> ID：10180007
> 
> 赞同：3
> 
> 时间：2012-04-16T19:00:22.163
> 
> 标签：xslt

我有一个 XML 文档，其中包含以下示例摘录：

```
<p>
    Some text <GlossaryTermRef href="123">term 1</GlossaryTermRef><GlossaryTermRef href="345">term 2</GlossaryTermRef>.
</p> 
```

我正在使用 XSLT 使用以下模板将其转换为 XHTML：

```
<xsl:template match="GlossaryTermRef">
    <a href="#{@href}" class="glossary">
        <xsl:apply-templates select="node()|text()"/>
    </a>
</xsl:template> 
```

这很好用，但是`GlossaryTermRef`如果它们彼此相邻，我需要在两个元素之间插入一个空格吗？

有没有办法检测当前节点和下一个兄弟节点之间是否有空格或文本？我不能总是插入空格`GlossaryTermRef`项，因为它后面可能跟着一个标点符号。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-16T19:12:06.743

我设法自己解决了这个问题，我修改模板如下：

```
<xsl:template match="GlossaryTermRef">
    <a href="#{@href}" class="glossary">
        <xsl:apply-templates select="node()|text()"/>
    </a>
    <xsl:if test="following-sibling::node()[1][self::GlossaryTermRef]">
        <xsl:text> </xsl:text>
    </xsl:if>
</xsl:template> 
```

任何人都可以提出更好的方法，或者看到这个解决方案有什么问题吗？

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-16T21:56:40.280

首先，“node()|text()”是“node()”的冗长等价物。也许您的意思是“*|node()”，它将选择元素和文本子项，而不是评论或 PI。

您的解决方案可能与任何解决方案一样好。另一个是使用分组：

```
<xsl:for-each-group select="node()" group-adjacent="boolean(self::GlossaryTermRef)">
  <xsl:choose>
    <xsl:when test="current-grouping-key()">
      <xsl:for-each select="current-group()">
        <xsl:if test="position() gt 1"><xsl:text> </xsl:text></xsl:if>
        <xsl:apply-templates select="."/>
      </xsl:for-each>
    </xsl:when>
    <xsl:otherwise>
     <xsl:apply-templates select="current-group()"/>
    </xsl:otherwise>
  </xsl:choose>
</xsl:for-each-group> 
```

不，那一点都不漂亮。

我的下一个尝试是使用兄弟递归（父母对第一个孩子应用模板，每个孩子对紧随其后的兄弟应用模板），但我认为这也不会是一个改进。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-08-23T12:23:23.427

这个如何？你感觉怎么样？

```
<xsl:template match="GlossaryTermRef">
<a href="#{@href}" class="glossary">
<xsl:apply-templates select="node()|text()"/>
</a>
</xsl:template> 
```

# ant - 使用 java1.6 JDK 编译遗留的 Java 代码

> ID：10180010
> 
> 赞同：1
> 
> 时间：2012-04-16T19:00:27.560
> 
> 标签：ant, javac

我正在编译许多可能用 Java1.3 编写的遗留 Java 代码，我遇到了很多这样的错误：

```
Copydir.java:128: warning: as of release 5, 'enum' is a keyword, and may not be used as an identifier

[javac] (use -source 5 or higher to use 'enum' as a keyword)
[javac]             Enumeration enum = filecopyList.keys(); 
```

用 _enum 替换每个枚举实例太耗时，所以我在 ant javac 任务中添加了 source="1.3" ，如下所示（基于[http://ant.apache.org/manual/Tasks/javac.html](http://ant.apache.org/manual/Tasks/javac.html)的示例）。但是我仍然遇到相同的编译错误。我试图改变 source = 1.4,1.5，但仍然是同样的错误。

```
<javac srcdir="${src.dir}"

destdir="${build.classes}"

debug="true" debuglevel="lines,vars,source"

source="1.3"

deprecation="off"

optimize="on"> 
```

告诉编译器源是用 1.3 编写的，但我想编译它以在 1.6 中运行的正确方法是什么？我正在使用 jdk1.6.0.26 和 ant 1.8.2

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-16T20:04:36.983

这是一个警告，而不是错误。除非构建中存在其他应该可以正常工作的错误。

# forms - 不使用 VCL 创建表单

> ID：10180016
> 
> 赞同：8
> 
> 时间：2012-04-16T19:00:50.610
> 
> 标签：forms, delphi, winapi

我需要创建一个表单（使用函数），而无需（或任何视觉控件）`CreateWindow`的任何帮助，仅使用 Windows API。`VCL`

这种形式将有一个`InputBox`，一个`Button`和一个`BitMap`（像这样`TImage`做）。

我无法在互联网上找到任何样本。有谁知道除了 MSDN 之外可以下载示例的好地方吗？

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2012-04-16T19:40:08.773

这是一个示例应用程序，它仅使用 WinApi 来创建带有静态、编辑和按钮的 Windows，我让您展示位图显示作为练习。

```
uses
  Windows,
  Messages,
  SysUtils;

var
  Msg        : TMSG;
  LWndClass  : TWndClass;
  hMainHandle: HWND;
  hButton    : HWND;
  hStatic    : HWND;
  hEdit      : HWND;
  hFontText  : HWND;
  hFontButton: HWND;

procedure ReleaseResources;
begin
  DestroyWindow(hButton);
  DestroyWindow(hStatic);
  DestroyWindow(hEdit);
  DeleteObject(hFontText);
  DeleteObject(hFontButton);
  PostQuitMessage(0);
end;

function WindowProc(hWnd,Msg:Longint; wParam : WPARAM; lParam: LPARAM):Longint; stdcall;
begin
  case Msg of
      WM_COMMAND: if lParam = hButton then
                    MessageBox(hMainHandle,'You pressed the button Hello', 'Hello',MB_OK or MB_ICONINFORMATION);
      WM_DESTROY: ReleaseResources;
  end;
  Result:=DefWindowProc(hWnd,Msg,wParam,lParam);
end;

begin
  //create the window
  LWndClass.hInstance := hInstance;
  with LWndClass do
    begin
      lpszClassName := 'MyWinApiWnd';
      Style         := CS_PARENTDC or CS_BYTEALIGNCLIENT;
      hIcon         := LoadIcon(hInstance,'MAINICON');
      lpfnWndProc   := @WindowProc;
      hbrBackground := COLOR_BTNFACE+1;
      hCursor       := LoadCursor(0,IDC_ARROW);
    end;

  RegisterClass(LWndClass);
  hMainHandle := CreateWindow(LWndClass.lpszClassName,'Window Title', WS_CAPTION or WS_MINIMIZEBOX or WS_SYSMENU or WS_VISIBLE, (GetSystemMetrics(SM_CXSCREEN) div 2)-190,
      (GetSystemMetrics(SM_CYSCREEN) div 2)-170, 386,200,0,0,hInstance,nil);

  //Create the fonts to use
  hFontText := CreateFont(-14,0,0,0,0,0,0,0,DEFAULT_CHARSET,OUT_DEFAULT_PRECIS,CLIP_DEFAULT_PRECIS,DEFAULT_QUALITY,VARIABLE_PITCH or FF_SWISS,'Tahoma');
  hFontButton := CreateFont(-14,0,0,0,0,0,0,0,DEFAULT_CHARSET,OUT_DEFAULT_PRECIS, CLIP_DEFAULT_PRECIS,DEFAULT_QUALITY,VARIABLE_PITCH or FF_SWISS,'Tahoma');

  //create the static
  hStatic:=CreateWindow('Static','This is static text, like a TLabel',WS_VISIBLE or WS_CHILD or SS_LEFT, 10,10,360,44,hMainHandle,0,hInstance,nil);
  SendMessage(hStatic,WM_SETFONT,hFontText,0);

  //create the edit
  hEdit:=CreateWindowEx(WS_EX_CLIENTEDGE,'Edit','This a Edit like and TEdit', WS_VISIBLE or WS_CHILD or ES_LEFT or ES_AUTOHSCROLL,10,35,360,23,hMainHandle,0,hInstance,nil);
  SendMessage(hEdit,WM_SETFONT,hFontText,0);

  //create the button
  hButton:=CreateWindow('Button','Hello', WS_VISIBLE or WS_CHILD or BS_PUSHBUTTON or BS_TEXT, 10,130,100,28,hMainHandle,0,hInstance,nil);
  SendMessage(hButton,WM_SETFONT,hFontButton,0);

  //message loop
  while GetMessage(Msg,0,0,0) do
  begin
    TranslateMessage(Msg);
    DispatchMessage(Msg);
  end;

end. 
```

![在此处输入图像描述](../Images/8e7361f76bbcbeb6936dd6ac4206f293.png)

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2012-04-16T19:21:51.593

> 有谁知道除了 MSDN 之外可以下载示例的好地方吗？

我通过粗略的网络搜索找到了以下示例：

*   [在 Windows API 中开发 Delphi 程序的指南（不使用 VCL）](http://delphi.about.com/od/windowsshellapi/a/apicourse.htm)
*   [没有 VCL 或 IDE 的 Delphi](http://www.codexterity.com/raw-delphi/index.htm)

我敢肯定还有更多，但这两个应该让你开始。

但是，要使用原始的 Win32 GUI，您确实需要对窗口框架有深入的了解。为此，我推荐[Charles Petzold](http://www.charlespetzold.com/)所著的[Programming Windows](http://www.charlespetzold.com/pw5/)，这是所有老式 Windows 1.0 程序员当年学习的书。是的，它很旧，但它涵盖了您所需要的基础知识。

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2012-04-16T19:44:41.727

Peter 下面只使用 windows API 为 Delphi编写了一个[Threaded Splashscreen 。](http://cc.embarcadero.com/Item/20139)

看看它是如何制作的：

```
{== PBThreadedSplashscreenU ===========================================}
{: This unit implements a component that can be used to show a splash
  screen in a different thread.
@author Dr. Peter Below
@desc   Version 1.0 created 2003-05-29<br/>
        Last modified       2003-06-01<p/>
While it is possible to install this component and drop it on a form
or datamodule to configure it at design-time a more typical use will
be to create an instance of the component in code, to show the splash
screen before the main form has even been created. A genuine form may
be used as template for the splash screen, the template is created but
not shown (do not use Application.FormCreate for this, call the
constructor directly!), its GetFormImage is used to obtain the image to
show in the real splash screen. <br/>
The splash screen can be configured to show a statusbar, in which
progress messages can be displayed.    }
{======================================================================}
{$BOOLEVAL OFF}{Unit depends on shortcut boolean evaluation}
Unit PBThreadedSplashscreenU;

Interface

Uses
  Windows, SysUtils, Classes, Graphics, Controls, StdCtrls;

Type
  {: This component is the interface of the splash screen to the
     outside world. All its methods will execute in the context of
     the main thread. You will typically set up the properties of
     a TPBThreadedSplashscreen object and then call its Show method
     to show the splashscreen. This method creates a secondary thread
     and passes it the relevant property values. The thread will then
     create an API-level window and show the image you put into the
     components Image property. Calling the Hide method will stop and
     destroy the secondary thread and its window. <br/>
     <b>Note:</b> Changes made to the components properties after the
     Show method has been called will have no effect on the secondary
     threads splash window! The only exception is the Image property,
     changes to it will be reflected in the splash screen. But it is
     assumed that the new image will have the same size than the old
     one. <br/>
     You can call the components ShowStatusMessage to show a string
     in the splash screens status bar (if it has one, that is). }
  TPBThreadedSplashscreen = class(TComponent)
  private
    FShowThread: TThread;
    FUseStatusbar: Boolean;
    FTopmost: Boolean;
    FCenter: Boolean;
    FVisible: Boolean;
    FTop: Integer;
    FLeft: Integer;
    FImage: TBitmap;

    { property write methods }
    procedure SetCenter(const Value: Boolean);
    procedure SetImage(const Value: TBitmap);
    procedure SetLeft(const Value: Integer);
    procedure SetTop(const Value: Integer);
    procedure SetTopmost(const Value: Boolean);
    procedure SetUseStatusbar(const Value: Boolean);
    procedure SetVisible(const Value: Boolean);
  protected
    {: Handler for the images OnChange event, forwards changes to the
       show thread. }
    Procedure ContentChanged( sender: TObject );
  public
    {: Create the internal bitmap for the image property. }
    Constructor Create(AOwner: TComponent); override;
    {: Hide the splash screen, if it is visible, destroy the internal
      bitmap for the image property. }
    Destructor Destroy; override;
    {: Create the secondary thread and run it to show the splash screen. }
    Procedure Show;
    {: Stop and destroy the secondary thread and its splash screen window. }
    Procedure Hide;
    {: Show a message in the splash screens status bar. If there is
      none the procedure does nothing. }
    Procedure ShowStatusMessage( const msg: String );
  published

    {: X coordinate of splash screen windows upper left corner, ignored
       if Center is set to true. }
    property Left: Integer read FLeft write SetLeft;

    {: Y coordinate of splash screen windows upper left corner, ignored
       if Center is set to true. }
    property Top: Integer read FTop write SetTop;

    {: If set to true the splash screen will be centered in the workarea.
      If set to false the Left and Top properties determine the position
      of the splash screen. }
    property Center: Boolean read FCenter write SetCenter;

    {: The background image to show in the splash screen. The size of the
       image determines the size of the splash screen window. }
    property Image: TBitmap read FImage write SetImage;

    {: Determines whether the splash screen should be a topmost window. }
    property Topmost: Boolean read FTopmost write SetTopmost;

    {: Determines whether the splash screen window has a status bar
      to show status messages on. }
    property UseStatusbar: Boolean read FUseStatusbar write SetUseStatusbar;

    {: Shows or hides the splash screen. If set to true at design-time
      the splash screen will be shown automatically. }
    property Visible: Boolean read FVisible write SetVisible;

  end;

Procedure Register;

Implementation

Uses
  Messages, SyncObjs, CommCtrl, Types;

Procedure Register;
  Begin
    RegisterComponents('PBGoodies', [TPBThreadedSplashscreen]);
  End;

Type
  {: Specialized thread class used to show a splash window holding
    a bitmap and optionally a status bar in the context of a secondary
    thread. The window is created using API methods only, the VCL is
    not involved since it is not thread-safe. }
  TPBSplashThread = class( TThread )
  private
    FWnd: HWND;               // handle of splash screen window
    FStatusbar: HWND;         // handle of its statusbar
    FCallstub: Pointer;       // window proc stub for the splash screen
    FSplash : TPBThreadedSplashscreen;  // reference to component
    FGuardian: TCriticalSection; // guards access to the FSurface bitmap
    FSurface: TBitmap;        // holds the image to show
    FWndClass: ATOM;          // holds window class for the splash window
    FUseStatusbar: Boolean;   // copy of FSplashs property
    FTopmost: Boolean;        // copy of FSplashs property
    FCenter: Boolean;         // copy of FSplashs property
    FOrigin: TPoint;          // upper left position of splash window
    FStatusMessage: String;   // buffer for status message
  private
    {: This method handles all messages after WM_NCCREATE for the
      splash window. It uses the standard Dispatch mechanims build
      into TObject for most of them. This method executes in the
      secondary threads context. It trap and reports any exceptions
      happening during message processing. }
    Procedure WndProc( Var msg: TMessage );

    {: Creates the splash screen window class. This method executes in
      the main threads context since it is called from the constructor.  }
    Procedure CreateWindowclass;

    {: Destroys the splash screen window class. This method executes in
      the main threads context since it is called from the destructor.  }
    Procedure DestroyWindowClass;

    {: Create the splash screen window. This method executes in the
      secondary threads context since it is called from Execute. }
    Procedure CreateSplashWindow;

    {: Create the splash windows statusbar. This method executes in
      the secondary threads context. }
    Procedure CreateStatusBar;

    {: Center the splash screen window in the workarea.  This method
       executes in the secondary threads context. }
    Procedure CenterSplashScreen;

    {: Copy property values from the splash screen components. This
      method executes in the main threads context since it is called
      from the constructor. }
    Procedure Init;

    { All message handlers execute in the secondary threads context. }
    {: On WM_CREATE we size and position the splash window and create
     its status bar, if one was requested. }
    Procedure WMCreate( var msg: TWMCreate ); message WM_CREATE;

    {: On WM_ERASEBKGND we paint the image in FSurface onto the window. }
    Procedure WMEraseBkGnd( var msg:TWMEraseBkGnd ); message WM_ERASEBKGND;

    {: We return HTCAPTION for hit tests in the windows client area so
      the user can move it with the mouse. }
    Procedure WMNCHittest( var msg: TWMNCHITTEST ); message WM_NCHitTest;
  protected
    {: Helper routine to show an exception message using Windows.MessageBox.
      This function is thread-safe, so we can use it to report exceptions
      happening in the secondary thread. }
    Procedure ReportException( E: Exception );

    {: The threads work method creates the splash window, shows it and
      then enters a message loop. The loop will be left when the splash
      window is closed. Executes in the secondary threads context, of
      course.}
    procedure Execute; override;
  public
    {: Store the passed component reference, copy a number of its
      properties to internal fields, create the window class and image,
      resume the thread. Executes in the main threads context.
     @precondition aSplashScreen <> nil }
    Constructor Create( aSplashScreen: TPBThreadedSplashscreen );

    {: If the splash window is still up close it to make the message
      loop exit, then destroy the image and the thread object. Executes
      in the main threads context. }
    destructor Destroy; override;

    {: Show a message in the splash windows status bar. Executes in the
     main thread context. }
    Procedure ShowStatusMessage( const msg: String );

    {: Copy the image from the splash component again and redraw the
      splash window to show the new image. Executes in the main threads
      context. }
    Procedure UpdateContent( sender: Tobject );

    {: Pass all received messages to DefWindowProc. Executes in the
      secondary threads context. }
    Procedure DefaultHandler(var Message); override;
  End;

{—— TPBThreadedSplashscreen ———————————————————————————————————————————}

procedure TPBThreadedSplashscreen.ContentChanged( sender: TObject );
begin
  If Visible Then
    TPBSplashThread( FShowThread ).UpdateContent( sender );
end;

constructor TPBThreadedSplashscreen.Create(AOwner: TComponent);
begin
  inherited;
  FImage := TBitmap.Create;
  FImage.OnChange := ContentChanged;
end;

destructor TPBThreadedSplashscreen.Destroy;
begin
  If Visible Then
    Hide;
  Fimage.Free;
  inherited;
end;

procedure TPBThreadedSplashscreen.Hide;
begin
  If Visible Then Begin
    FreeAndNil( FShowThread );
    FVisible := false;
  End; { If }
end;

procedure TPBThreadedSplashscreen.SetCenter(const Value: Boolean);
begin
  If FCenter  <> Value Then
    FCenter  := Value;
end;

procedure TPBThreadedSplashscreen.SetImage(const Value: TBitmap);
begin
  FImage.Assign( Value );  // will fire images OnChange event
end;

procedure TPBThreadedSplashscreen.SetLeft(const Value: Integer);
begin
  If FLeft  <> Value Then
    FLeft  := Value;
end;

procedure TPBThreadedSplashscreen.SetTop(const Value: Integer);
begin
  If FTop  <> Value Then
    FTop  := Value;
end;

procedure TPBThreadedSplashscreen.SetTopmost(const Value: Boolean);
begin
  If FTopmost  <> Value Then
    FTopmost  := Value;
end;

procedure TPBThreadedSplashscreen.SetUseStatusbar(const Value: Boolean);
begin
  If FUseStatusbar  <> Value Then
    FUseStatusbar  := Value;
end;

{ CAUTION! The way this property setter is written now setting visible
  to true *at design time* will show the splash screen! This may be
  valuable as a preview feature but may cause problems in the IDE.

  I HAVE NOT TESTED THE COMPONENT AT DESIGN-TIME!

  If you experience problems add a If csDesigning in ComponentState test
  to show the splash screen only at run-time and just store the value
  at design-time. }
procedure TPBThreadedSplashscreen.SetVisible(const Value: Boolean);
begin
  If FVisible  <> Value Then Begin
    If Value Then
      Show
    Else
      Hide;
  End; { If }
end;

procedure TPBThreadedSplashscreen.Show;
begin
  If not Visible Then Begin
    FVisible := true;
    try
      FShowThread := TPBSplashThread.Create( self );
    except
      FVisible := false;
      raise
    end;
  End; { If }
end;

procedure TPBThreadedSplashscreen.ShowStatusMessage(const msg: String);
begin
  If UseStatusbar and Visible Then
    TPBSplashThread( FShowThread ).ShowStatusMessage( msg );
end;

{—— TPBSplashThread ———————————————————————————————————————————————————}

{ This is a helper function that will be used as window proc for the
 splash screen class. Its only reason for existence is the sad fact
 that the TMessage record passed to the threads WndProc does not contain
 the window handle of the splash screen. This is a problem for all
 messages that are send during the windows creation (the call to
 CreateWindowEx), since for those the thread objects FWnd field will not
 have a value yet. We need the handle during WM_CREATE processing, however.

 This function only handles WM_NCCREATE, the very first message a window
 will receive. We store the window handle into the thread object and then
 subclass the window to use the threads WindowProc for any further
 messages. The thread objects reference is handed to CreateWIndowEx as
 user parameter, so we can retrieve it from the createstruct passed via
 lparam here. }
Function CreateWndProc( wnd: HWND; msg: Cardinal; wparam: WPARAM; lparam: LPARAM ): LRESULT; stdcall;
  Var
    thread: TPBSplashThread;
  Begin
    If msg = WM_NCCREATE Then Begin
      thread := TPBSplashThread( PCreateStruct( lparam )^.lpCreateParams );
      thread.FWnd := wnd;
      SetWindowLong( wnd, GWL_WNDPROC, Integer( thread.FCallstub ));
      result := 1;
    End
    Else // will actually never get here, but better safe than sorry
      result := DefWindowProc( wnd, msg, wparam, lparam );
  End;

procedure TPBSplashThread.CenterSplashScreen;
var
  r, workarea: TRect;
  x, y: Integer;
begin
  Win32Check( GetWindowRect( FWnd, r ));
  SystemParametersInfo( SPI_GETWORKAREA, sizeof( workarea ), @workarea, 0 );
  x:= ((workarea.Right - workarea.Left) - (r.Right - r.Left )) div 2;
  y:= ((workarea.Bottom - workarea.Top) - (r.Bottom - r.Top )) div 2;
  SetWindowPos( FWnd, 0, x, y, 0, 0, SWP_NOSIZE or SWP_NOZORDER );
end;

constructor TPBSplashThread.Create(aSplashScreen: TPBThreadedSplashscreen);
begin
  Assert( Assigned( aSplashscreen ) );
  inherited Create( true );
  FSplash := aSplashScreen;
  FCallstub:= MakeObjectInstance( WndProc );
  FGuardian:= TCriticalSection.Create;
  Init;
  CreateWindowclass;
  Resume;
end;

procedure TPBSplashThread.CreateSplashWindow;
const
  TopmostStyle: Array [Boolean] of DWORD = (0, WS_EX_TOPMOST );
  NoActivateStyle : Array [Boolean] of DWORD = (0, WS_EX_NOACTIVATE );
var
  wsize: TSize;
begin
  wsize.cx := FSurface.Width + GetSystemMetrics( SM_CXEDGE ) * 2;
  wsize.cy := FSurface.Height + GetSystemMetrics( SM_CYEDGE ) * 2;
  FWnd := CreateWindowEx(
            TopmostStyle[ FTopmost ] or WS_EX_TOOLWINDOW
            or WS_EX_STATICEDGE or WS_EX_CLIENTEDGE
            or NoActivateStyle[ Win32MajorVersion >= 5 ],
            MakeIntResource( FWndClass ),
            nil,
            WS_POPUP or WS_BORDER,
            Forigin.x, Forigin.y,
            wsize.cx, wsize.cy,
            0, 0, hInstance, self );
  If FWnd = 0 Then
    raise exception.create('TPBSplashThread.CreateSplashWindow: CreateWindowEx failed');
    // RaiseLastOSError;
end;

procedure TPBSplashThread.CreateStatusBar;
var
  initrec: TInitCommonControlsEx;
  ncInfo: TNonClientMetrics;
  h: Integer;
  r: TRect;
begin
  initrec.dwSize := sizeof( initrec );
  initrec.dwICC  := ICC_BAR_CLASSES;
  Win32Check( InitCommonControlsEx( initrec ));
  ncInfo.cbSize := sizeof( ncInfo );
  SystemParametersInfo( SPI_GETNONCLIENTMETRICS, ncinfo.cbsize,
                        @ncinfo, 0 );
  h:= Abs(ncinfo.lfStatusFont.lfHeight)+ ncinfo.iBorderWidth * 2 + 4;
  Win32Check( GetWindowRect( FWnd, r ));
  SetWindowPos( Fwnd, 0, 0, 0, r.Right-r.left,
               r.Bottom-r.top+h,
               SWP_NOMOVE or SWP_NOZORDER );
  FStatusbar := CreateWindow(
              STATUSCLASSNAME,
              nil,
              WS_CHILD or WS_VISIBLE,
              0, FSurface.Height,
              FSurface.Width, h,
              FWnd, 0, hInstance, nil );
  If FStatusbar = 0 THen
    RaiseLastOSError;

  SendMessage( FStatusbar, SB_SIMPLE, 1, 0 );
  FGuardian.Acquire;
  try
    If FStatusMessage <> '' Then
      SendMessage( FStatusbar,
                   SB_SETTEXT,
                   255,
                   Integer( Pchar( FStatusMessage )));
  finally
    FGuardian.Release;
  end;
end;

procedure TPBSplashThread.CreateWindowclass;
var
  wndclass: TWndClass;
  S: String;
begin
  fillchar( wndclass, sizeof( wndclass ), 0 );
  wndclass.style := CS_NOCLOSE or CS_OWNDC or CS_VREDRAW or CS_HREDRAW;
  wndclass.lpfnWndProc := @CreateWndProc;
  wndclass.hInstance := hInstance;
  wndclass.hCursor := LoadCursor( 0, IDC_WAIT );
  wndclass.hbrBackground := HBRUSH( COLOR_WINDOW );
  S:= Format( '%s_wnd_%x',[ classname, getcurrentthreadid() ] );
  wndclass.lpszClassName := Pchar( S );
  FWndClass:= Windows.Registerclass( wndclass );
  If FWndClass = 0 Then
    RaiseLastOSError;
end;

procedure TPBSplashThread.DefaultHandler(var Message);
begin
  With TMessage( Message ) Do
    Result := DefWindowProc( FWnd, Msg, wparam, lparam );
end;

destructor TPBSplashThread.Destroy;
begin
  If FWnd <> 0 Then
    PostMessage( FWnd, WM_CLOSE, 0, 0 );
  inherited;
  FreeObjectInstance( FCallstub );
  FGuardian.Free;
  FSurface.Free;
  DestroyWindowClass;
end;

procedure TPBSplashThread.DestroyWindowClass;
begin
  If FWndClass <> 0 Then
    Windows.UnregisterCLass( MakeIntResource( FWndClass ), hInstance );
end;

procedure TPBSplashThread.Execute;
var
  msg: TMsg;
begin
  // create the threads message queue
  PeekMessage( msg, 0, 0, 0, PM_NOREMOVE );
  Try
    CreateSplashWindow;
    ShowWindow( FWnd, SW_SHOWNORMAL );
    While GetMessage( msg, 0, 0, 0 ) Do Begin
      TranslateMessage( msg );
      DispatchMessage( msg );
    End; { While }
  Except
    On E: Exception Do
      ReportException( E );
  End; { Except }
end;

procedure TPBSplashThread.Init;
begin
  FUseStatusbar := FSplash.UseStatusbar;
  FCenter       := FSplash.Center;
  FOrigin       := Point( FSplash.Left, FSplash.Top );
  If not Assigned( FSurface ) Then
    FSurface  := TBitmap.Create;
  FSurface.Assign( FSplash.Image );
  FTopmost      := FSplash.FTopmost;
end;

procedure TPBSplashThread.ReportException(E: Exception);
var
  s: String;
begin
  S:= Format( 'Error in TPBSplashThread, class %s:'#13#10'%s',
              [E.classname, E.Message] );
  Messagebox( 0,Pchar(S), 'Error', MB_OK or MB_ICONHAND );
end;

procedure TPBSplashThread.ShowStatusMessage(const msg: String);
begin
  If FStatusbar <> 0 Then
    SendMessage( FStatusbar,
                 SB_SETTEXT,
                 255,
                 Integer( Pchar( msg )))
  Else Begin
    FGuardian.Acquire;
    try
      FStatusMessage := msg;
    finally
      Fguardian.Release;
    end
  End; { Else }
end;

procedure TPBSplashThread.UpdateContent(sender: Tobject);
begin
  FGuardian.Acquire;
  Try
    FSurface.Assign( FSplash.Image );
    { We could provide for changes of the image size as well here,
      but since that will be rarely needed let's skip it for now. }
  Finally
    FGuardian.Release;
  End; { Finally }
  InvalidateRect( FWnd, nil, true );
end;

procedure TPBSplashThread.WMCreate(var msg: TWMCreate);
begin
  msg.result := 1;
  If FUseStatusbar Then
    CreateStatusbar;
  If FCenter Then
    CenterSplashScreen;
end;

procedure TPBSplashThread.WMEraseBkGnd(var msg: TWMEraseBkGnd);
begin
  msg.Result := 1;
  FGuardian.Acquire;
  try
    FSurface.Canvas.Lock;
    Bitblt( msg.DC, 0, 0, Fsurface.Width, FSurface.Height,
            FSurface.Canvas.Handle, 0, 0, SRCCOPY );
    FSurface.Canvas.UnLock;
  finally
    FGuardian.Release;
  end;
end;

procedure TPBSplashThread.WMNCHittest(var msg: TWMNCHITTEST);
begin
  inherited;
  If msg.Result = HTCLIENT Then
    msg.Result := HTCAPTION;
end;

procedure TPBSplashThread.WndProc(var msg: TMessage);
begin
  try
    msg.result := 0;
    Case msg.Msg Of
      WM_CLOSE   : DestroyWindow( FWnd );
      WM_DESTROY : PostQuitMessage( 0 );
      WM_NCDESTROY: FWnd := 0;
    Else
      Dispatch( msg );
    End;
  except
    On E:Exception Do
      ReportException( E );
  end;
end;

End. 
```

该组件只能使用 Windows API 在状态栏上显示图像和消息。`Show`当您调用该方法时，后台线程用于显示窗口。之后唯一可以更改的属性是图像，假设它与原始大小相同。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2012-04-16T20:22:04.340

如果你想不用 VCL，我建议你去看看[Key Objects Library](http://kolmck.net/)，它允许你创建轻量级的 GUI 应用程序。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-04-16T19:05:27.747

我知道 MadExcept 使用直接的 WinAPI 来构建它的异常对话框，因为它必须能够从除主线程之外的其他线程显示它，而 VCL 不能这样做。MadExcept 是免费的，但不幸的是它的代码不是。但它也不是太贵。因此，如果您有的话，这可能是一种可供研究的代码来源。（如果你不这样做，你至少应该看看它。当错误发生时，实际上能够将调试器连接到用户的系统是第二好的事情。）

# salesforce - SalesForce，如何使用来自另一个 obj 的数据更新一个对象上的字段？

> ID：10180023
> 
> 赞同：0
> 
> 时间：2012-04-16T19:01:13.300
> 
> 标签：salesforce

在销售队伍中。我在 MDR 中有 3 个对象：

```
obj_1 ---< obj_2 >--- Contacts. 
```

**Object_1** = 会议类型和预算

**Object_2** = 每次会议的参加者以及在每个会议上花费的资金。

每次更新涉及 obj_2 中的联系人的记录时，仅当会议发生在过去一年时，我才需要更新联系人对象中的字段。

我该怎么做呢？工作流程？公式？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-17T13:20:16.597

这可以通过工作流或 Apex 触发器来完成。

要使用工作流程，请转到设置 - 创建 - 工作流程和批准 - 工作流程规则。

*   点击“新规则”
*   如果那是启动更改的对象，请选择 Obj2
*   为规则选择一个名称，例如“在 Obj2 更新时更新联系人”
*   通过从“规则标准”部分的下拉框中选择“公式计算结果为真”并在公式编辑器中写入如下内容，指定何时制定工作流的标准：DATEVALUE(MeetingDate) > DATE(YEAR(TODAY())-1 ，月（今天（）），天（今天（）））。
*   点击“保存并下一步”
*   从“添加工作流操作”下拉框中选择“新字段更新”。
*   为更新操作选择一个名称，例如“更新联系人预算”
*   通过从联系人下方的下拉框中选择要更新的字段以及联系人中的字段名称，例如 ContactBudget
*   在下面的“指定新字段值”部分中，选择“使用公式设置新值”并在 Obj2 中输入指定预算的字段名称，例如 Meeting_budget__c
*   节省
*   再次转到设置 - 创建 - 工作流程和批准 - 工作流程规则
*   单击刚刚创建的规则旁边的“激活”

问候， lenin_ra

# graphics - 位图中高度的视觉效果

> ID：10180024
> 
> 赞同：0
> 
> 时间：2012-04-16T19:01:15.017
> 
> 标签：graphics, bitmap

我正在创建一个地图，即每个像素都有一些实际值的位图 - 高度。如果这个像素，我想根据高度填充每个像素。我想得到这样的东西[，](http://en.wikipedia.org/wiki/File:Contour3D.jpg)但是是二维的。

我有这种图片的将高度映射到（R，G，B）的功能是什么？

编辑：我在 python 中编码。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-16T19:09:02.757

它只是一种色调，从 360° 开始，然后倒退到 0°。您尚未指定语言，但这里是如何在 JavaScript 中进行从 HSL 到 RGB 的转换，例如：

```
/**
 * Converts an HSL color value to RGB. Conversion formula
 * adapted from http://en.wikipedia.org/wiki/HSL_color_space.
 * Assumes h, s, and l are contained in the set [0, 1] and
 * returns r, g, and b in the set [0, 255].
 *
 * @param   Number  h       The hue
 * @param   Number  s       The saturation
 * @param   Number  l       The lightness
 * @return  Array           The RGB representation
 */
function hslToRgb(h, s, l) {
    var r, g, b;

    if(s == 0) {
        r = g = b = l; // achromatic
    } else {
        function hue2rgb(p, q, t){
            if(t < 0) t += 1;
            if(t > 1) t -= 1;
            if(t < 1/6) return p + (q - p) * 6 * t;
            if(t < 1/2) return q;
            if(t < 2/3) return p + (q - p) * (2/3 - t) * 6;
            return p;
        }

        var q = l < 0.5 ? l * (1 + s) : l + s - l * s;
        var p = 2 * l - q;
        r = hue2rgb(p, q, h + 1/3);
        g = hue2rgb(p, q, h);
        b = hue2rgb(p, q, h - 1/3);
    }

    return [r * 255, g * 255, b * 255];
} 
```

您需要 100% 的固定饱和度和 50% 的亮度。

# android - 如何检查 Monkeyrunner 的 waitForConnection() 是否失败

> ID：10180027
> 
> 赞同：1
> 
> 时间：2012-04-16T19:01:16.970
> 
> 标签：android, python, monkeyrunner

我希望能够确定对 Monkeyrunner 的 waitForConnection() 方法的调用何时失败（超时）。似乎即使设备不存在并且方法超时，也会返回相同的对象。我正在通过 API 查看可能使用不同的方法来确定电话是否未连接，但到目前为止没有任何效果。有什么建议吗？

PS。这是在 Python 脚本中完成的。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-29T12:19:13.757

我以前遇到过类似的问题。这可能会在 ICS SDK 中更新，但到目前为止，您可以使用下面提到的解决方案。

```
try:
    device = MonkeyRunner.waitForConnection(20)
    strProperty = device.getProperty('model')
except:
    device = None 
```

这是一种使用较少代码的解决方法。谢谢你。

# regex - 使用 ack/grep 正则表达式通过特定 css 值查找选择器

> ID：10180028
> 
> 赞同：1
> 
> 时间：2012-04-16T19:01:42.843
> 
> 标签：regex, grep, ack

我的 css 中有以下两个选择器，以这种格式布局：

```
// file1.css
#myId {
    margin-right:0;
    color:#f00;
}

// file2.css
#otherId { margin-right:0; color: #f00 } 
```

我的目标是使用 ack/grep 搜索来获取选择器和颜色值。

如果我：

`ack-grep '(^.*color:\s+\d+)'`

我去拿：

```
file1.css
color:#f00;

file2.css
#otherId { margin-right:0; color: #f00 } 
```

此搜索对 运行良好`file2.css`，但对 运行不太好`file1.css`，可能是因为我使用`^`匹配到行首.. 我将如何始终匹配回某些 css 选择器的开头（以 id 或类或标记名开头)?

更明显的是，我想要：

```
file1.css
#myId {margin-right:0; color:#f00;

file2.css
#otherId { margin-right:0; color: #f00 } 
```

（并且选择器不一定必须是 ID .. 我应该匹配回`}`文件的前一个还是开头？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-16T20:37:18.560

grep 和 ack 都不支持多行正则表达式：

[确认常见问题](http://search.cpan.org/dist/ack/ack-base#Can_I_do_multi-line_regexes?)

还有其他选择，例如 pcregrep。不过我会使用一些 CSS 解析器。

# facebook - Facebook API - 什么是“curl -F”？

> ID：10180029
> 
> 赞同：14
> 
> 时间：2012-04-16T19:02:03.010
> 
> 标签：facebook, api, curl

来自 Facebook Graph Api（[https://developers.facebook.com/docs/reference/api/](https://developers.facebook.com/docs/reference/api/)）：

> 发布：您可以通过使用访问令牌向适当的连接 URL 发出 HTTP POST 请求来发布到 Facebook 图表。例如，您可以通过向[https://graph.facebook.com/arjun/feed](https://graph.facebook.com/arjun/feed)发出 POST 请求，在 Arjun 的墙上发布新的墙帖：

```
curl -F 'access_token=...' \
     -F 'message=Hello, Arjun. I like this new API.' \
     https://graph.facebook.com/arjun/feed 
```

*   Q1：这是 javascript 还是 php ？
*   Q2：我没有看到“curl -F”函数参考，有人可以给我看一个吗？

非常感谢~

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-04-16T19:06:19.320

`curl`（或`cURL`）是用于访问 URL 的命令行工具。

文档：[http ://curl.haxx.se/docs/manpage.html](http://curl.haxx.se/docs/manpage.html)

在这个例子中，他们只是发送一个 POST 到`https://graph.facebook.com/arjun/feed`. `-F`定义要与 POST 一起提交的参数。

这不是 javascript 或 php。您可以在 php 中使用 curl，尽管使用这些参数对该地址的任何 POST 都将完成示例所演示的内容。

要在 javascript 中执行此操作，您将创建一个表单，然后提交它：

```
var form = document.createElement("form");
form.setAttribute("method", "post");
form.setAttribute("action", "https://graph.facebook.com/arjun/feed");

var tokenField = document.createElement("input");
tokenField.setAttribute("type", "hidden");
tokenField.setAttribute("name", "access_token");
tokenField.setAttribute("value", token);

var msgField = document.createElement("input");
msgField.setAttribute("type", "hidden");
msgField.setAttribute("name", "message");
msgField.setAttribute("value", "Hello, Arjun. I like this new API.");

form.appendChild(hiddenField);

document.body.appendChild(form);
form.submit(); 
```

使用jQuery，它要简单得多：

```
$.post("https://graph.facebook.com/arjun/feed", { 
    access_token: token, 
    message: "Hello, Arjun. I like this new API."
}); 
```

# c# - 在现有类上设置 Json 属性

> ID：10180030
> 
> 赞同：1
> 
> 时间：2012-04-16T19:02:10.243
> 
> 标签：c#, .net, json

我在外部程序集中有一个无法更改的现有类。我想用 Newtonsoft JSON.Net 序列化这个类的一个对象，但不是所有的属性。

通常我可以使用 JsonIgnoreAttribute 属性来做到这一点，如下所示：

```
public class TestJsonClass
{
    public string PropA { get; set; }

    [JsonIgnoreAttribute]
    public string PropB { get; set; }
} 
```

但是由于我不能更改类，有没有办法忽略没有属性的属性？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-16T19:18:49.500

尝试使用适当的注释继承类并覆盖属性或将属性值复制到一个全新的类中。

# mysql - 如何计算mysql中一系列行中时间的最小值和最大值之间的差异

> ID：10180031
> 
> 赞同：0
> 
> 时间：2012-04-16T19:02:10.557
> 
> 标签：mysql, sql

我在 mysql 数据库中有以下行：

```
Object1 2012-03-25 13:02:17         
Object2 2012-03-25 13:02:20         
Object3 2012-03-25 13:03:22         
Object1 2012-03-25 13:03:25         
Object4 2012-03-25 13:03:38         
Object1 2012-03-25 13:03:41         
Object5 2012-03-25 13:03:46         
Object4 2012-03-25 13:04:15         
Object6 2012-03-25 13:09:16         
Object1 2012-03-25 13:10:02         
Object4 2012-03-25 13:10:33         
Object3 2012-03-25 13:26:52 
```

我想计算一个对象的最早时间和同一对象的最晚时间之间的时间差。

例如，Object1 的输出值大约为 8 秒。

我能用sql完成这个吗？如果有怎么办？如果没有，怎么办？

谢谢你的帮助。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-16T19:06:12.307

您可以在任何查询中引用 MAX 和 MIN，如下所示：

```
SELECT objectid, DATEDIFF(MAX(time),MIN(time)) as diff
FROM objects
GROUP BY objectid 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-16T19:07:03.150

```
SELECT obj, MIN(otime) AS mn, MAX(otime) AS mx, DATEDIFF(MAX(otime),MIN(otime)) AS df
FROM mytable
GROUP BY obj 
```

应该这样做。您不需要 mn 和 mx 列，但我喜欢查看它们以进行检查。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-16T19:08:10.823

```
SELECT obj_name, MIN(obj_time) as min_time, MAX(obj_time) as max_time, 
TIMESTAMPDIFF(SECOND, MIN(obj_time),MAX(obj_time)) as diff_seconds
FROM table1
GROUP BY obj_name 
```

# algorithm - 如何忽略 OCR Engine 没有意义的输出？

> ID：10180032
> 
> 赞同：2
> 
> 时间：2012-04-16T19:02:17.240
> 
> 标签：algorithm, nlp, ocr, tesseract

Tesseract OCR 引擎有时会输出没有意义的文本，我想设计一种算法来忽略任何没有意义的文本或单词，下面是我想忽略的某种输出文本，我的简单解决方案是计算单词以“”分隔的已识别文本和包含太多单词的文本将是垃圾（提示：我正在扫描最多包含 40 个单词的图像）任何想法都会有所帮助，谢谢。

```
 wo:>"|axnoA1wvw\
 ldﬂﬁg
 °J!9O‘ !P99W M9N 6 13!-|15!Cl ‘I-/Vl
 978 89l9 Z0 3+ 3 'l9.l.
 97 999 VLL lLOZ+ 3 9l!q°lN
 wo0'|axno/(@|au1e>1e: new;
 1=96r2a1ey\1 1uauud0|e/\e(]
 |8UJB){ p8UJL|\7' 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-16T20:11:02.373

将输出文本分成单词。将单词分成三组。计算三重频率，并与来自已知良好文本语料库的文本的三重频率进行比较（例如，来自某个邮件列表的所有文章讨论您打算使用 OCR 做什么，减去标题行）。

当我说“三元组”时，我的意思是：

whe, hen, i, say, tri, rip, ipl, ple, les, i, mea, ean

...所以在这个简短的例子中，“i”的频率为 2，而其他的都是频率 1。

如果您对使用预期语言的大型文档的这些三元组中的每一个进行频率计数，则应该可以相当准确地猜测字符串是否使用相同的语言。

当然，这是启发式的。

我在密码更改程序中使用了类似的方法来检测英文密码。它工作得很好，尽管没有完美的“明显的密码拒绝器”这样的东西。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-16T19:44:11.473

对照字典查单词？

当然，这会对诸如外来短语或代码之类的东西产生误报。一般来说，这个问题是棘手的*（例如，[这段](https://stackoverflow.com/a/967906/238419)代码是乱码还是乱码？:)）*。唯一（几乎）完美的方法是将其用作启发式方法来标记某些部分以供人工审查。

# objective-c - 在 Objective-C 中将大写字符串转换为标题大小写

> ID：10180035
> 
> 赞同：2
> 
> 时间：2012-04-16T19:02:42.403
> 
> 标签：objective-c, string, casing

我创建了以下方法，首先在 NSString 上使用内置的 convertStringToTitleCase 方法，但它实际上只是将每个单词的第一个字母大写。我在 .NET 中看到有一个 TextInfo.ToTitleCase 方法，它尝试了我想用 Objective-C 做的事情，但也达不到要求。

[http://msdn.microsoft.com/en-us/library/system.globalization.textinfo.totitlecase.aspx](http://msdn.microsoft.com/en-us/library/system.globalization.textinfo.totitlecase.aspx)

我写的开始方法如下。您将如何正确处理大写字符串的大小写？将单词数据库转换为所有大写/小写有帮助吗？

```
- (NSString *)convertStringToTitleCase:(NSString *)str {
    NSMutableString *convertedStr = [NSMutableString stringWithString:[str capitalizedString]];

    NSRange range = NSMakeRange(0, convertedStr.length);

    // a list of words to always make lowercase could be placed here
    [convertedStr replaceOccurrencesOfString:@" De " 
                                  withString:@" de " 
                                     options:NSLiteralSearch 
                                       range:range];

    // a list of words to always make uppercase could be placed here
    [convertedStr replaceOccurrencesOfString:@" Tv " 
                                  withString:@" TV " 
                                     options:NSLiteralSearch 
                                       range:range];

    return convertedStr;
} 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-16T20:03:37.583

如评论中所述，您引用的 .NET 方法不使用“正确”的标题大小写（即，遵循以全大写或全小写形式保留的异常词列表），因此`-[NSString capitalizedString]`与你会得到。如果您想要异常词，则必须编写自己的方法（或找到其他人，如[谷歌搜索`NSString "title case"`](http://www.google.com/search?q=NSString+%22title+case%22)可能）。

你的标题大小写有多“合适”取决于你愿意抛出多少异常词。您希望它支持多少英语？其他语言呢？它还取决于您在分析单词边界方面走了多远——您可能希望“TV”保持全大写，无论它是否在引号中、句尾等，但您也可能不这样做不想让“you've”出现“You'Ve”。

如果你想处理异常词，你的重复运行计划`replaceOccurrencesOfString...`会越慢，你的异常词越多。（此外，在搜索/替换字符串中使用空格意味着您没有考虑您可能想要的其他单词边界。）

考虑 可能很有用`NSRegularExpression`，因为正则表达式已经具有相当健壮的大小写和单词边界概念。如果这对您不起作用，则使用扫描仪读取输入字符串同时生成转换后的输出字符串将比运行多个搜索/替换操作更有效。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2015-06-02T02:33:39.637

一个不错的单线（不是通用解决方案，在大字符串上可能效率很低）：

```
[[str lowercaseString] capitalizedString]; 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2016-06-06T12:24:58.080

```
extension String {

    /**
      Get the title case string.
     */
    var titleCase: String {
        get {
            return getTitleCaseString()
        }
    }

    // MARK: Private methods.

    /**
     Get title case string.

     - returns: The title case string regarding the lowercase words.
     */
    private func getTitleCaseString() -> String {
        struct Holder {
            static let lowercaseWords = ["a", "an", "and", "at", "but", "by", "else", "for",
                                         "from", "if", "in", "into", "is", "nor", "of", "off",
                                         "on", "or", "out", "the", "to", "via", "vs", "with"]
        }
        return replaceToLowercaseAllOccurrencesOfWords(Holder.lowercaseWords).capitalizeFirst
    }

    /**
     Replace to lowercase all occurrences of lowercase words.

     - parameter lowercaseWords: The lowercase words to replace.

     - returns: String with all occurrences replace to the lowercase words.
     */
    private func replaceToLowercaseAllOccurrencesOfWords(lowercaseWords: [String]) -> String {
        let capitalizedSelf = NSMutableString(string: self.capitalizedString)
        for word in lowercaseWords {
            if let lowercaseWordRegex = try? NSRegularExpression(pattern: "\\b\(word)\\b", options: .CaseInsensitive) {
                lowercaseWordRegex.replaceMatchesInString(capitalizedSelf,
                                                          options: NSMatchingOptions(),
                                                          range: NSMakeRange(0, capitalizedSelf.length),
                                                          withTemplate: word)
            }
        }
        return capitalizedSelf as String
    }

/**
     Capitalize first char.
     */
    private var capitalizeFirst: String {
        if isEmpty { return "" }
        var result = self
        result.replaceRange(startIndex...startIndex, with: String(self[startIndex]).uppercaseString)
        return result
    }

} 
```

# c++ - 在 Eclipse 中从 C++ 调用 Ada

> ID：10180040
> 
> 赞同：3
> 
> 时间：2012-04-16T19:03:08.703
> 
> 标签：c++, eclipse, eclipse-plugin, eclipse-cdt, ada

我正在尝试创建一个完全托管在 Eclipse 中、以 C++ 开始并调用 Ada 的程序。我已经加载了 GNATBench，并且可以毫无问题地运行 Ada 程序。我不能做的是让 C++ 项目称为 Ada 项目。

在四处寻找之后，我找到并使用 make 文件执行了下面显示的代码。

[http://www.pegasoft.ca/resources/boblap/book.html](http://www.pegasoft.ca/resources/boblap/book.html)

我还发现一个帖子说我的目标已经完成。

[http://blogs.windriver.com/parkinson/2009/10/yesterday-adacore-announced-the-release-of-gnatbench-231-its-ada-integrated-development-environment-eclipse-plugin-which.html](http://blogs.windriver.com/parkinson/2009/10/yesterday-adacore-announced-the-release-of-gnatbench-231-its-ada-integrated-development-environment-eclipse-plugin-which.html)

我还需要包括什么才能让 Eclipse 中的 C++ 在 Eclipse 中调用 Ada？

* * *

使用制作文件：

```
$ c++ -c test.cc
$ gnatgcc -c test_subr
$ gnatbind -n test_subr
$ gnatgcc -c b~test_subr
$ gnatlink -o main test.o test_subr.ali --link=c++
$ ./main 
```

  CPP代码：

```
//main.cc

#include extern "C" void adainit(void);    
#include extern "C" void adafinal(void);
#include extern "C" void ada_subroutine(void);

int main(int argc, char **argv)
{
   puts("C++ main");
   adainit();

   ada_subroutine();

   adafinal();
   puts("C++ done");

   return 0;
} 
```

阿达代码：

```
package Test_Subr is
    procedure Ada_Subroutine;
    pragma export(CPP, Ada_Subroutine);
end Test_Subr;

with Ada.Text_IO;
use Ada.Text_IO;

package body Test_Subr is

    procedure Ada_Subroutine is
    begin
        put("IN ADA");
    end Ada_Subroutine;

end Test_Subr; 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-16T20:54:03.980

您是否尝试过使用 Export pragma 的 External_Name 参数？（IIRC，C++ 链接可能会非常混乱。）

```
pragma Export
( Convention    => CPP,
  Entity        => Ada_Subroutine,
  External_Name => "Ada_Subroutine "
); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-20T09:33:19.137

我不知道 Eclipse；但是，您如何在 Eclipse 中获得一个 C++ 项目来调用另一个 C++ 项目？还是用C写的？

您也许可以让 Eclipse[将 Ada 构建为库](http://gcc.gnu.org/onlinedocs/gcc-4.6.0/gnat_ugn_unw/Creating-a-Stand_002dalone-Library-to-be-used-in-a-non_002dAda-context.html#Creating-a-Stand_002dalone-Library-to-be-used-in-a-non_002dAda-context)并从 C++ 调用它？

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-18T13:21:01.203

在一般情况下，您需要`extern C`在 C++ 端和`pragma exprort (C, ..`Ada 端使用以使两个链接（参数传递方案）相同。但是，如果您对 Ada 和 C++ 都使用 gcc，那么您可以`pragma export (CPP`改用。

还有一个你必须注意的细节。如果你的“main”（程序的入口点）[不是用 Ada 编写的](http://gcc.gnu.org/onlinedocs/gnat_ugn_unw/Binding-with-Non_002dAda-Main-Programs.html#Binding-with-Non_002dAda-Main-Programs)，那么你需要`adainit()`在调用任何东西之前手动调用 Ada 的精化过程（通过routine）一次。同样，在大多数情况下，您应该在`adafinal()`退出程序之前调用。

# mocking - 模拟 RavenDb

> ID：10180044
> 
> 赞同：3
> 
> 时间：2012-04-16T19:03:18.497
> 
> 标签：mocking, ravendb

我已经阅读了很多关于如何模拟 RavenDb 的问题。有一个常见的答案：“不要”

这让我陷入了一个奇怪的境地。我模拟接口最强烈的原因之一是测试我的代码对错误的反应。

如果您无法模拟可能导致错误的对象，则注入错误可能非常复杂。

我在这里想错了吗？？？？

//lg

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-04-17T06:16:12.090

为什么要模拟以模拟错误？创建一个内存数据库（使用`EmbaddedDocumentStore`），只做*错误*，不需要模拟它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2015-04-17T15:59:57.020

我不知道你是否知道，但**RavenDB**有很好的单元测试助手。

您唯一需要做的就是实现 RavenTestBase，如下所示：

```
[TestFixture]
public class RavenDummyTests : RavenTestBase
{
    private IDocumentStore _documentStore;

    [SetUp]
    public void Setup()
    {
        _documentStore = NewDocumentStore();
    }

    [TestFixtureTearDown]
    public void TestFixtureTearDown()
    {
        _documentStore.Dispose();
    }

    [Test]
    public void Search_And_Where_Result_In_An_And()
    {
        using (var db = _documentStore.OpenSession())
        {
            db.Store(_oscar);
            db.Store(_max);
            db.Store(_tiger);
            db.SaveChanges();
        }

        WaitForIndexing(_documentStore); // <== very helpful

        using (var db = _documentStore.OpenSession())
        {
            var query = db.Query<Cat>().Search(cat => cat.Color, "gray").Where(cat => cat.Name == "max");
            var list = query.ToList();

            Assert.IsEmpty(list);
            Assert.AreEqual("Color:(gray) AND (Name:max)", query.ToString());
        }
    }} 
```

# c# - Windows Phone Live 控件：SignInButton - 如何防止它连接到互联网？

> ID：10180050
> 
> 赞同：2
> 
> 时间：2012-04-16T19:03:49.433
> 
> 标签：c#, windows-phone-7, live, onedrive

`Live:SignInButton`（在 Windows Phone 7 上）在使用它导航到页面后立即尝试连接到 Internet。

是否可以禁用此功能？我希望它在用户想要它的那一刻连接到互联网。目前，每次用户进入应用程序时它都使用互联网数据包。也欢迎任何解决方法。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2015-01-11T10:25:44.007

我知道这是一个旧帖子，但无论如何我都会回答。如果您将“wl.offline_acces”提供给 SignInButton，它将自动连接，如果您不给它，用户必须单击按钮才能连接。如果需要，您可以使用自定义按钮。你可以在这里找到代码：

[http://msdn.microsoft.com/en-us/library/hh243641.aspx#signin](http://msdn.microsoft.com/en-us/library/hh243641.aspx#signin)

# c# - 在 SignalR 中 Hub.Context 线程安全吗？

> ID：10180052
> 
> 赞同：8
> 
> 时间：2012-04-16T19:03:56.687
> 
> 标签：c#, iis-7.5, signalr

如果不同客户端同时发生多个请求，则 Hub.Context.ConnectionId 的值会在处理程序执行期间发生变化。

假设我有 2 个客户端与客户端 ID A 和 B 连接，并且我的 Hub 上有一个名为 foo() 的方法。我从 A 向调用 foo() 的服务器发送一个请求，然后在处理来自 A 的请求时，我从 B 发送一个调用 foo() 的请求。在开始处理 A 的请求 Hub.Context.ConnectionId == A 但在方法调用结束时 Hub.Context.ConnectionId == B。

我应该复制 Hub.Context 吗？我应该在什么时候这样做？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-04-21T19:03:52.143

它不需要是线程安全的，因为 Hub 实例不是静态的，因此您不需要复制任何内容。

它们是按调用创建的。因此来自客户端的每次调用都会创建一个新的 Hub 实例和 HubContext。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-17T19:17:52.007

这并不能直接回答您的问题，但是我通常的工作流程是在呼叫者首次连接时为其设置一个值，这可能会完成您的需要吗？

```
Caller.clientId = Guid.NewGuid(); 
```

# latex - 如何在 LaTeX 上使用 '_' 和其他字符？

> ID：10180054
> 
> 赞同：2
> 
> 时间：2012-04-16T19:03:59.747
> 
> 标签：latex, tex, latex-environment

我需要将一些命令行的示例放入 LaTeX 文件中，但每次尝试使用某些字符（例如`_`）时，我都会收到“!Missing $ inserted”错误。

如何编写字符串，例如：

```
./configure FC=gfortran  --with-cuda --without-mpi FLAGS_CHECK="-g -O2" FLAGS_NO_CHECK="-g -O2 -ffree-line-length-none -I../shared/ -L/usr/local/cuda/lib64  -fopenmp" 
```

无需使用`$`... `$`？（我不希望它看起来像一个数学表达式。）

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-16T19:08:37.357

使用反斜杠转义，即`\_`. 或者，使用`verbatim`环境或代码包（例如，列表）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-16T19:07:22.307

试试这个`\_`。因此，您的示例应如下所示：

```
./configure FC=gfortran  --with-cuda --without-mpi FLAGS\_CHECK="-g -O2" FLAGS\_NO\_CHECK="-g -O2 -ffree-line-length-none -I../shared/ -L/usr/local/cuda/lib64  -fopenmp" 
```

# c# - 任务并行库 - 如何立即返回但有并行步骤

> ID：10180056
> 
> 赞同：2
> 
> 时间：2012-04-16T19:04:01.567
> 
> 标签：c#, parallel-processing, task-parallel-library

我有以下需要以非阻塞并行处理方式发生的工作流程。我希望该方法`DoStuff()`立即返回，所以我正在使用任务并行库

```
DoStuff():
  Do some setup
  Parse an Excel file

  then for each row
   Fill Template with parsed values
   Convert filled template to Pdf
   Convert pdf to Tiff

  when all row processing has completed Create Summary Text File

  when summary text file has completed, Finalize 
```

因为我想立即返回，所以我在“所有行处理完成后”步骤中遇到了一些问题。以下大致是我应该做的吗？

```
public Task<ProcessingResult> DoStuff() {
    return new Task<SetupResult>(SetUp)
        .ContinueWith(ParseExcel, TaskContinuationOptions.OnlyOnRanToCompletion)
        .ContinueWith(excelProcessing => {
            var templateProcessing = excelProcessing.Result.RowParsing
                .Select(template =>
                  new Task<TemplateFillingResult>(()=>FillTemplate)
                       .ContinueWith(ConvertToPdf, TaskContinuationOptions.OnlyOnRanToCompletion)
                       .ContinueWith(ConvertToTiff, TaskContinuationOptions.OnlyOnRanToCompletion)
                ).ToArray()

            //-------------------------------------------------------------
            // This is the part that seems wierd
            //-------------------------------------------------------------
            Task.Factory.ContinueWhenAll(templateTasks, t=> { }).Wait();
            return new TemplatesProcessingResult(templateProcessing);
        }, TaskContinuationOptions.OnlyOnRanToCompletion)
        .ContinueWith(CreateSummaryFile, TaskContinuationOptions.OnlyOnRanToCompletion)
        .ContinueWith(FinalizeProcessing, TaskContinuationOptions.OnlyOnRanToCompletion); 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-16T19:14:09.953

我认为您会感到困惑，因为您试图将所有这些组件连接起来作为原始事件的延续。如果没有令人信服的理由让所有这些调用继续，那么这一切都可以通过单个后台线程（任务）简单地完成。

```
var task = Task.Factory.StartNew(() =>
   {
        // setup
        // var stuff = ParseFile()

        // Executes elements in parallel and blocks this thread until all have completed, else bubbles the exception up
        var transformations = excelProcessing.Result.RowParsing.AsParallel().Select(x =>
           {
                FillTemplate(x);
           }).ToArray();

        // create summary text file

        // Finalize

        return processingResult;
   }); 
```

基本上，您可以在一个线程中完成所有这些操作，而不必担心。将所有这些步骤标记为延续对于您需要做的事情来说非常复杂。

然后你的调用代码可以简单地阻塞`Result`那个人的属性来获得异步调用的结果：

```
 try
  {
      var result = task.Result;
  }
  catch(AggregateException e)
  {
      e.Flatten().Handle(ex => 
        {
             // Do Stuff, return true to indicate handled
        });
  } 
```

但是，您需要了解的一件事是例外情况。如果这将是一项“一劳永逸”的任务，那么如果您有异常，它将一直冒泡并可能​​会杀死您的进程。

# ruby-on-rails - 在 application_controller 中分配后 current_user 为空

> ID：10180063
> 
> 赞同：2
> 
> 时间：2012-04-16T19:04:45.750
> 
> 标签：ruby-on-rails

现在我正在使用 parse_resource gem (https://github.com/adelevie/parse_resource) 进行身份验证。我正在尝试使用 gem forum_monster (https://github.com/gitt/forum_monster) 创建一个论坛。问题是它要求用户模型是 ActiveRecord，但要使用 parse_resource，用户模型需要是 ParseUser。所以现在事情不正常。

我的攻击计划是我试图将解析身份验证抽象为 Parseuser 模型以及 ActiveRecord 的用户模型，因此 forum_monster 不会抱怨。我的问题是 current_user 由于某种原因是空白的。

我的用户模型：

```
class User < ActiveRecord::Base
    has_many :topics, :dependent => :destroy
    has_many :posts, :dependent => :destroy
end 
```

我的 Parseuser 模型：

```
class Parseuser < ParseUser
end 
```

我的应用程序控制器：

```
class ApplicationController < ActionController::Base
    protect_from_forgery
    helper_method :current_user  

    private  
    def current_user  
        @current_user ||= Parseuser.find(session[:user_id]) if session[:user_id]
    end 

end 
```

Parseuser.find 应该在应用程序控制器中工作，因为 Parseuser.authenticate 在会话控制器中完美工作。

我检查了 session[:user_id] 并且它已正确填充，所以这也不是问题。

# java - Java 游戏不工作

> ID：10180068
> 
> 赞同：0
> 
> 时间：2012-04-16T19:05:14.383
> 
> 标签：java, nullpointerexception

我在网上找到了这个破砖游戏的 java 源代码。我下载了它并尝试运行它，但它给了我一个 NullPointerException。是什么导致了这个异常，我该如何解决？谢谢。

[http://zetcode.com/tutorials/javagamestutorial/breakout/](http://zetcode.com/tutorials/javagamestutorial/breakout/)

这是堆栈跟踪：

```
Exception in thread "main" java.lang.NullPointerException
    at javax.swing.ImageIcon.<init>(ImageIcon.java:181)
    at Ball.<init>(Ball.java:16)
    at Board.gameInit(Board.java:48)
    at Board.addNotify(Board.java:43)
    at java.awt.Container.addNotify(Container.java:2578)
    at javax.swing.JComponent.addNotify(JComponent.java:4685)
    at java.awt.Container.addNotify(Container.java:2578)
    at javax.swing.JComponent.addNotify(JComponent.java:4685)
    at java.awt.Container.addNotify(Container.java:2578)
    at javax.swing.JComponent.addNotify(JComponent.java:4685)
    at javax.swing.JRootPane.addNotify(JRootPane.java:739)
    at java.awt.Container.addNotify(Container.java:2578)
    at java.awt.Window.addNotify(Window.java:663)
    at java.awt.Frame.addNotify(Frame.java:470)
    at java.awt.Window.show(Window.java:859)
    at java.awt.Component.show(Component.java:1584)
    at java.awt.Component.setVisible(Component.java:1536)
    at java.awt.Window.setVisible(Window.java:842)
    at Breakout.<init>(Breakout.java:14)
    at Breakout.main(Breakout.java:18)
Exception in thread "Timer-0" java.lang.NullPointerException
    at Board$ScheduleTask.run(Board.java:110)
    at java.util.TimerThread.mainLoop(Timer.java:512)
    at java.util.TimerThread.run(Timer.java:462) 
```

显然这段代码应该可以工作，但事实并非如此。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-16T19:05:44.640

您可能也没有下载图像，或者至少没有将它们放在正确的文件夹中。确保将图像放在这里：

浏览到 Ball.java，向上两层文件夹，在其中创建一个名为 images 的文件夹并将您的图像放在那里。

# wix - 在 WiX 中将 RegisterValue 设置为默认值

> ID：10180069
> 
> 赞同：0
> 
> 时间：2012-04-16T19:05:14.873
> 
> 标签：wix, windows-installer

如果选择了某个功能，我想将寄存器值设置为特定字符串 (true)，如果未选择，我想将其设置为默认值 (false)。我已经尝试了以下，但我似乎没有工作:-(

```
 <Component Id="ExampleFalseComponent">
        <Condition><![CDATA[Feature1 = "3" ]]></Condition>
        <RegistryValue Root="HKCU" Key="path" Name="examplevalue" Type="string" Value="false" KeyPath="yes"/>
    </Component>
    <Component Id="ExampleTrueComponent">
        <Condition><![CDATA[Feature1 < "3" ]]></Condition>
        <RegistryValue Root="HKCU" Key="path" Name="examplevalue" Type="string" Value="true" KeyPath="yes"/>
    </Component>
    <Feature Id="Feature1" Title="Some text string" Absent="allow" AllowAdvertise="no" InstallDefault="local" Display="collapse" Level="3">
        <ComponentRef Id="ExampleFalseComponent"/>
        <ComponentRef Id="ExampleTrueComponent"/>
    </Feature> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-16T21:48:46.520

当您的条件评估为真时，我将使用在成本最终确定后的执行序列中安排的 SetProperty 元素将 SomeProperty 设置为“真”。然后在 RegistryValue 中使用 [SomeProperty]。

另请注意，在第一次安装期间，该功能将安装但尚未安装，在修复期间您的功能将安装但未安装，因此请相应地写下您的条件。

# javascript - JavaScript setSelectionRange() 方法和光标位置

> ID：10180075
> 
> 赞同：5
> 
> 时间：2012-04-16T19:05:37.987
> 
> 标签：javascript

我有以下一段 JavaScript 用于将 unicode 字符（下面由 txtToIns 变量表示）动态插入到正文中

```
elmt.value = elmt.value.substring(0, elmt.selectionStart) + txtToIns + " " + elmt.value.substring(elmt.selectionStart, elmt.selectionEnd) + elmt.value.substring(elmt.selectionEnd, elmt.value.length) + " ";
elmt.focus();
elmt.value = elmt.value.trim(); 
```

使用上面的光标总是在文本的末尾。有什么办法可以将它直接放在 txtToIns 之后？不，txtToIns.focus() 不起作用

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-04-16T21:07:45.020

我不确定您要对 textarea 值中的空格字符做什么，特别是最后一个将在两行后再次修剪掉的字符，因此我忽略了下面代码中的空格。我也不确定您要对先前选择的文本（如果有的话）做什么，所以我假设您想用新文本覆盖它。

请记住，这在 IE < 9 中不起作用，它不支持`selectionStart`,`selectionEnd`也不支持`setSelectionRange()`.

演示：http: [//jsfiddle.net/timdown/wPfVn/](http://jsfiddle.net/timdown/wPfVn/)

代码：

```
var val = elmt.value;
var start = elmt.selectionStart, end = elmt.selectionEnd;
elmt.value = val.slice(0, start) + txtToIns + val.slice(end);
elmt.focus();
var caretPos = start + txtToIns.length;
elmt.setSelectionRange(caretPos, caretPos); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-16T19:14:27.597

当您更改值时，光标将移动到末尾。更改其值后，您必须手动重置光标位置。

尝试这个：

```
var start = elmt.selectionStart,
    len   = txtToIns.length,
    pos   = start + len;
elmt.value = elmt.value.substring(0, start) + txtToIns + " " + elmt.value.substring(start) + " ";
elmt.focus();
elmt.value = elmt.value.trim();
elmt.setSelectionRange( pos, pos, 0 ); 
```

我还在设置值的行中清理了一些不必要的逻辑。希望我没有破坏任何东西，但如果我这样做了，就恢复到原来的行。​</p>

# c++ - c++ 二维数组非常规网格插值

> ID：10180084
> 
> 赞同：0
> 
> 时间：2012-04-16T19:05:59.903
> 
> 标签：c++, interpolation

我有一个非常规的二维数组。

这是数组的某些部分，使用“最近邻”插值。

![最近邻样本](../Images/39ac61458d7fda0990ba64968272f5e7.png) ![网格上的其他地方...](../Images/2e6f5901fb08b75cb2910077f62897af.png)

我想从那开始：

![最近邻插值](../Images/b74cb75830f5011e16a375577bf396c1.png) 对此： ![双三次插值](../Images/92a371616640cafb8cfc2e0ffdf11c1c.png)

我不能使用双三次插值，因为我的网格不规则。

我可以用什么？（需要快速 - 实时渲染......）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-16T19:26:01.740

创建不规则点云的 Delaunay 三角剖分。使用三角形顶点中的值在三角形内部的每个像素处插入颜色。

[http://en.wikipedia.org/wiki/Delaunay_triangulation](http://en.wikipedia.org/wiki/Delaunay_triangulation)

# r - 重命名数据框中的变量名序列

> ID：10180091
> 
> 赞同：4
> 
> 时间：2012-04-16T19:06:24.110
> 
> 标签：r, dataframe

我在数据框中有 5 列，我想将变量名称重命名为 Var1、Var2、Var3、Var4、Var5。

我目前的做法不是很方便：

```
names(mydata)[1:10] <- c("Var1", "Var2", "Var3", "Var4", "Var5") 
```

有没有更好的方法，当我有 100 个变量时，我不必输入所有 100 个名称？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-04-16T19:08:34.397

```
names(mydata)[1:100] <- paste("Var", 1:100, sep="") 
```

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2012-04-16T20:01:34.007

该`sprintf`功能将非常适合：

```
names(mydata)[1:100] <- sprintf("Var%d", 1:100) 
```

或者

```
names(mydata)[1:100] <- sprintf("Var%03d", 1:100) 
```

取决于您是否想要“Var1”、“Var2”、... 或“Var001”、“Var002”、...等名称

# facebook - Facebook FQL 用于检索对评论框评论的回复

> ID：10180092
> 
> 赞同：1
> 
> 时间：2012-04-16T19:06:28.773
> 
> 标签：facebook, facebook-fql, facebook-comments

我正在使用 Facebook 评论框插件，并且还订阅了 comment.create JavaScript 事件，以便我可以使用 FQL 从 Facebook 检索评论的详细信息，并将该评论数据存储在我的应用程序的数据库中。

到目前为止，当我收到新评论的 ID 和 href（传递到 comment.create 事件处理程序）时，我可以使用以下 FQL 来检索该评论的详细信息：

```
SELECT object_id, post_id, fromid, time, text, username 
FROM comment 
WHERE post_fbid='*** EVENT COMMENT_ID ***' AND object_id 
    IN (SELECT comments_fbid FROM link_stat WHERE url='*** EVENT HREF ***') 
```

所有这一切都很好。

当用户回复评论时会出现问题。在这种情况下，上面的查询无法检索到评论。

[我做了一些挖掘](http://developers.facebook.com/docs/reference/fql/comment/)，发现 Facebook 的“评论”表显然有一个“评论”字段（或关系，不确定），其中包含对评论的回复。您甚至可以使用以下查询来检索对评论的所有回复：

```
SELECT comments
FROM comment 
WHERE post_fbid='*** EVENT COMMENT_ID ***' AND object_id 
    IN (SELECT comments_fbid FROM link_stat WHERE url='*** EVENT HREF ***') 
```

在修改 FQL 测试控制台后，我可以看到回复已添加到此“评论”字段中。但是，我没有尝试检索所有回复，而是尝试查找我在 comment.create 事件处理程序中收到其 ID 的特定回复。问题是，由于“评论”似乎是一个字段而不是链接表，我认为我无法查询它。

还有其他人遇到这个吗？任何建议将不胜感激。

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-17T05:56:35.117

尝试这个：

```
SELECT text, time, id, likes, fromid, comments FROM comment WHERE   is_private = 0 AND 
object_id IN (SELECT comments_fbid FROM link_stat WHERE url ='YOUR_URL') or
object_id in (select post_fbid from comment where object_id in (select comments_fbid from link_stat where url ='YOUR_URL')) 
ORDER BY time DESC limit 0,10 
```

# perl - Perl - Web::Scraper - 链接数组

> ID：10180095
> 
> 赞同：3
> 
> 时间：2012-04-16T19:06:47.637
> 
> 标签：perl, web-scraping

我有这个代码：

```
#!/opt/local/bin/perl
use 5.014;
use warnings;
use Web::Scraper;
use Data::Dumper;

my $html = do { local $/; <DATA> };

my $br = scraper {
    process 'div#br-wrap > ul', 'bc[]' => scraper {
        process 'li > a', 'link' => '@href';
    };
};
my $res = $br->scrape( $html );
say Dumper($res);

__DATA__
<html>
<head><title>title</title></head>
<body>
    <div id="content">
        <div id="br-wrap">
            <ul class="br">
                <li><a href="/">Home</a></li>
                <li><a href="/sub/xxx">Sub-xxx</a></li>
                <li><a href="/sub/xxx/cat/name">Sub-Cat</a></li>
                <li><a href="/sub/xxx/item">Sub-Item</a></li>
            </ul>
        </div>
    </div>
</body>
</html> 
```

结果是：

```
$VAR1 = {
          'bc' => [
                    {
                      'link' => '/'
                    }
                  ]
        }; 
```

但是，我正在寻找链接的**数组**......

```
$VAR1 = {
          'bc' => [
                    {
                      'link' => '/'
                    },
                    {
                      'link' => '/sub/xxx'
                    },
                    {
                      'link' => '/sub/xxx/cat/name'
                    },
                    {
                      'link' => '/sub/xxx/item'
                    }
                  ]
        }; 
```

代码中的错误在哪里？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-16T19:17:24.040

```
process 'div#br-wrap > ul > li', 'bc[]' => scraper {
    process 'a', 'link' => '@href'; 
```

# database - 分类数据的回归模型

> ID：10180113
> 
> 赞同：2
> 
> 时间：2012-04-16T19:07:33.933
> 
> 标签：database, data-mining

我在 csv 文件中有非常大的数据集（1,700,000 个原始数据和 300 个稀疏特征）。- 它有很多缺失值。- 数据在数值和分类值之间变化。- 因变量（类）是二进制的（1 或 0）。- 数据高度倾斜，积极响应的数量很少。

现在我需要的是对这些数据应用回归模型和任何其他机器学习算法。

我是新手，我需要帮助.. - 在回归模型的情况下如何处理分类数据？缺失值是否对其影响太大？- 对于像这样的大型、稀疏、倾斜的数据，我可以尝试的最佳预测模型是什么？- 你建议我使用什么程序？我尝试了 Weka，但它甚至无法打开那么多数据（内存故障）。我知道matlab可以打开数字csv或未混合的类别csv，除了必须估算缺失值以允许它打开文件。我知道一点R。

*   我正在尝试使用 excel、access 和 perl 脚本来操作数据。对于这么多的数据，这真的很难。excel不能打开超过近1M的记录，访问不能打开超过255列。任何建议。

提前感谢您的帮助

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-18T03:14:55.397

首先，您在谈论**分类**，而不是回归 - 分类允许从固定集合（例如 0 或 1）预测值，而回归产生实数输出（例如 0、0.5、10.1543 等）。也不要与所谓的逻辑回归混淆——它也是分类器，它的名字只是表明它是基于线性回归的。

要处理如此大量的数据，您需要**归纳**（**可更新**）模型。特别是，在 Weka 中，分类部分下有许多这样的算法（例如 Naive Bayes Updatable、Neutral Networks Updatable 等）。使用归纳模型，您将能够逐部分加载数据并以适当的方式更新模型（对于 Weka，请参阅知识流界面了解如何更轻松地使用它的详细信息）。

一些分类器可能适用于分类数据，但我不记得它们有任何可更新的，所以很可能你仍然需要将分类数据转换为数字。这里的标准解决方案是使用**指标属性**，即用几个二元指标替换每个分类属性。例如，如果您有`day-of-week`7 个可能值的属性，您可以用 7 个二进制属性 - `Sunday`、`Monday`等替换它。当然，在每个特定实例中，只有 7 个属性中的一个可能具有值`1`，而所有其他属性都必须是`0`。

**缺失值**的重要性取决于数据的性质。有时值得预先用一些中性值替换它们，有时分类器实现会自己完成（查看手册了解算法的详细信息）。

最后，对于高度偏斜的数据，使用**F1**（或只是**Precision** / **Recall**）测量而不是准确度。

# java - Java Applet：快速拖动鼠标在点之间产生巨大间隙

> ID：10180114
> 
> 赞同：1
> 
> 时间：2012-04-16T19:07:40.893
> 
> 标签：java, applet, awt

我的目标是在拖动鼠标时画点。问题是，当鼠标移动得非常快时，点之间的距离会变得很大，而不是所需的距离很小，这将无法识别。

缩短的代码是：

```
public void update(Graphics g){
    paint(g);
}

public void paint(Graphics g){
        for(i = 0; i <= height; i++){
            for(j = 0; j <= width; j++){
                if(virWorld[i][j] == 1) bufferGraphics.fillRect(i,j,1,1);
            }
        }
        g.drawImage(offscreen,0,0,this);
 }

public void mouseDragged(MouseEvent evt){
    curX = evt.getX();
    curY = evt.getY();
    virWorld[curX][curY] = 1;
}

public void run(){
    while(true){
        repaint();
        try{
            Thread.wait(10);    
        }
        catch(Exception exception){
            System.out.println(exception);
        }
    }
} 
```

谢谢你的帮助，罗宾

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-16T19:11:50.343

确实如此。您需要在前一点和当前点之间进行插值，即在两点之间画一条线。此外，您可能希望在执行此操作时设置更粗的 Stroke

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-16T19:13:15.130

在遥远的点之间画一条线，或者如果您喜欢冒险，可以尝试一条曲线。

# jquery - css 图片库有问题..？

> ID：10180117
> 
> 赞同：0
> 
> 时间：2012-04-16T19:07:55.130
> 
> 标签：jquery, html, jquery-ui, css

我正在尝试使用 Jquery Image Gallery，但不知何故导航图标不显示，甚至“加载”图标在点击时显示...

使用的代码是：

```
 .ad-gallery .ad-image-wrapper .ad-prev .ad-prev-image, .ad-gallery .ad-image-wrapper .ad-next .ad-next-image {
    background: url(ad_prev.png);
    width: 30px;
    height: 30px;
    display: none;
    position: absolute;
    top: 47%;
    left: 0;
    z-index: 101;
  }
  .ad-gallery .ad-image-wrapper .ad-next .ad-next-image {
    background: url(ad_next.png);
    width: 30px;
    height: 30px;
    right: 0;
    left: auto;
  }
  .ad-gallery .ad-image-wrapper .ad-image .ad-image-description {
    position: absolute;
    bottom: 0px;
    left: 0px;
    padding: 7px;
    text-align: left;
    width: 100%;
    z-index: 2;
    background: url(opa75.png) #ededed;
    color: #000;
  } 
```

这是该页面的链接：[http ://www.thekashmirscenario.com/gallery/index.php](http://www.thekashmirscenario.com/gallery/index.php)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-16T19:09:25.107

图像的路径是错误的。浏览器正在为他们显示 404 条消息。检查路径并确保它们存在。在不相关的说明中，您可能还需要考虑升级您正在使用的 jQuery 版本。

```
GET http://www.thekashmirscenario.com/gallery/loader.gif 404 (Not Found)
GET http://www.thekashmirscenario.com/gallery/ad_next.png 404 (Not Found)
GET http://www.thekashmirscenario.com/gallery/ad_prev.png 404 (Not Found)
GET http://www.thekashmirscenario.com/gallery/ad_scroll_back.png 404 (Not Found)
GET http://www.thekashmirscenario.com/gallery/ad_scroll_forward.png 404 (Not Found) 
```

# php - 如何在 wordpress 中控制 guid url

> ID：10180123
> 
> 赞同：0
> 
> 时间：2012-04-16T19:08:28.157
> 
> 标签：php, wordpress, guid

我的标题是 kadhal-rojave-roja-2 但 guid id 是[http://sample.com/kadhal-rojave-roja-2/](http://sample.com/kadhal-rojave-roja-2/)。我需要它没有破折号，像这样：

```
http://sample.com/kadhal rojave roja 2/ 
```

怎么做？

这是我的邮政编码：

```
 $new_post = array(
      'ID' => '',
      'post_author' => $user->ID, 

      'post_excerpt' => $excerpt,
      'post_title' => $post_title,
      'post_status' => 'publish',

    );
$post_id = wp_insert_post($new_post); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-16T19:10:20.133

这是不可能的，即使您确实找到了这样做的方法，浏览器也会将空格编码为 %20。谷歌还建议使用下划线或连字符而不是空格，因此它更适合搜索引擎优化。

此外，如果您使用 %20，URL 可能会更长，因为它是 3 个字符而不是 1 个字符。

# mips - MARS 上的 MIPS 系统调用：“地址超出范围”

> ID：10180124
> 
> 赞同：2
> 
> 时间：2012-04-16T19:08:31.943
> 
> 标签：mips

我是 MIPS 和 MARS 的新手。作为我程序的一部分，我想从用户那里读取一个字符串。

我有一个简单的代码如下

```
.globl  test
.data   0x10010000
foo: .asciiz "Input a string"
.data   0x10020000
in: .asciiz "xyz"
.text   0x00400000

test:
li  $v0, 54
add $a0, $zero, 0x1001
add $a1, $zero, 0x1002
add $a2, $zero, 3
syscall 
```

这个想法是将一个长度最多为 3 的字符串读入内存 0x1002。运行代码会给我“0x00400010 处的运行时异常：地址超出范围 0x00001001”。

为什么会这样？我如何解决它？我怀疑我在做一些非常愚蠢的事情，但无法弄清楚。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-16T19:25:18.700

我认为您与寻址混淆了。您已在 0x10020000 处定义了缓冲区空间，但您使用 0x1002 的地址进行系统调用。与对话框字符串相同。

您`$a0`应该是对话框中显示的字符串的地址；我怀疑这应该是`foo`：

```
la $a0, foo 
```

你的缓冲区应该是`in`：

```
la $a1, in 
```

**编辑**：这些是`add`s 的替代品，所以最后它应该看起来像：

```
test:
li  $v0, 54
la  $a0, foo
la  $a1, in
li  $a2, 3
syscall 
```

我也用`$a2`更简单的东西替换了这条线。试着看看它们是如何等价的。

# java - How to pass a list of elements as parameter in Jersey?

> ID：10180127
> 
> 赞同：1
> 
> 时间：2012-04-16T19:08:41.067
> 
> 标签：java, jersey

Is there a way to pass a list of elements as a parameter to a method using Jersey?

I have the class `Sample` annotated with `@XmlRootElement` with the following variables: `idUsuario`, `x`, and `timestamp`.

In my `MedicaoResource` class, the method:

```
@GET
@Produces("text/xml")
public List<Medicao> getMedicoes() {
    return new ArrayList<Medicao>(getAllMedicoes());
} 
```

returns something like:

```
<medicaoes>
    <medicao>
        <idUsuario>1</idUsuario>
        <timestamp>2012-04-16T12:25:00.454-03:00</timestamp>
        <x>0.71</x>
    </medicao>
    <medicao>
        <idUsuario>1</idUsuario>
        <timestamp>2012-04-16T12:25:00.454-03:00</timestamp>
        <x>1.71</x>
    </medicao>
</medicaoes> 
```

**Now, I would like to do something like this:**

```
@POST
@Consumes(MediaType.APPLICATION_XML)
@Produces("text/plain")
public String addMedicoes(ArrayList<Medicao> medicoes) {
    for (Medicao medicao : medicoes) {
        addMedicao(medicao);
    }
    return "success";
} 
```

**How would I have to write my XML for the method above to work properly? I have tried passing the same XML that the method `getMedicoes` returns, but it won't work.**

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-16T20:31:05.713

You should use type `List<Medicao>` instead of `ArrayList` in the `addMedicoes` method. This is probably what was preventing jersey/jaxb to properly unmarshall your xml query.

Besides, you should post more information apart from `won't work`, because with just that, we can only guess what's wrong. What does not work ? Do you have any error message/log to show. What exactly did you try?

# linux - SSH：不要在 shell 脚本中提示输入密码

> ID：10180128
> 
> 赞同：19
> 
> 时间：2012-04-16T19:08:42.920
> 
> 标签：linux, bash, ssh, rsa-key-fingerprint

我正在使用 ssh 并为我的系统设置了无密码 ssh。在脚本中使用 ssh 可以正常工作，但如果用户指定的主机没有无密码 ssh 设置，则脚本会提示输入密码并挂起。

如果没有为主机设置无密码 ssh，如何避免密码提示并返回错误？

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2012-04-16T19:11:14.863

```
ssh -o PasswordAuthentication=no user@hostname 
```

有关更多详细信息，请参见手册页`ssh_config`。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2018-06-27T23:22:21.570

设置*PasswordAuthentication*对我不起作用，但这确实：

```
ssh -o BatchMode=yes user@hostname 
```

从 ssh_config(5)

> **BatchMode**如果设置为“yes”，密码短语/密码查询将被禁用。此选项在没有用户提供密码的脚本和其他批处理作业中很有用。参数必须是“是”或“否”。默认值为“否”。

为了更好地衡量，您还可以输入*StrictHostKeyChecking*以便它会自动接受密钥并避免提示。

```
ssh -o StrictHostKeyChecking=no -o BatchMode=yes user@hostname 
```

# c# - 如何将控件的外观转换为图像？

> ID：10180129
> 
> 赞同：13
> 
> 时间：2012-04-16T19:08:47.997
> 
> 标签：c#, winforms

我希望用户能够拖动一段`Control`时间来显示它。我似乎找不到将其外观转换为图像的方法（以便将该图像转换为图标，以便将其作为拖动图标）。

* * *

## 回答 #1

> 赞同：33
> 
> 时间：2012-04-16T19:11:32.023

如果我理解正确，您想将控件绘制到图像上吗？使用[`Control.DrawToBitmap`](http://msdn.microsoft.com/en-us/library/system.windows.forms.control.drawtobitmap.aspx)：

```
Bitmap b = new Bitmap(myControl.Width, myControl.Height);
myControl.DrawToBitmap(b, new Rectangle(0, 0, b.Width, b.Height)); 
```

# r - 合并重复行

> ID：10180132
> 
> 赞同：43
> 
> 时间：2012-04-16T19:08:58.383
> 
> 标签：r

我有一个数据框，其中一列是物种的名称，第二列是丰度值。由于抽样程序，一些物种出现了不止一次（即，有不止一行包含物种 X）。我想合并这些条目并总结它们的丰富性。

例如，给定这个数据框：

```
set.seed(6)
df=data.frame(
  x=c("sp1","sp2","sp3","sp3","sp4","sp2","sp3"),
  y=rpois(7,2)); df 
```

产生：

```
 x y
1 sp1 2
2 sp2 4
3 sp3 1
4 sp3 1
5 sp4 3
6 sp2 5
7 sp3 5 
```

我想改为生产：

```
 x y
1 sp1 2    
2 sp2 9     (5+4)
3 sp3 7     (5+1+1)
5 sp4 3 
```

提前感谢您提供的任何帮助！

* * *

## 回答 #1

> 赞同：54
> 
> 时间：2012-04-16T19:12:36.583

这有效：

```
library(plyr)
ddply(df,"x",numcolwise(sum)) 
```

`df`用文字来说：（1）按列拆分数据框`"x"`；(2) 对于每个块，取每个数值列的总和；(3) 将结果粘贴回单个数据框中。（`dd`in`ddply`代表“将**数据**帧作为输入，返回**数据**帧”）

另一种可能更清晰的方法：

```
aggregate(y~x,data=df,FUN=sum) 
```

请参阅快速/优雅的方式来构建相关（稍微复杂）问题的[均值/方差汇总表。](https://stackoverflow.com/questions/7449198/quick-elegant-way-to-construct-mean-variance-summary-table)

* * *

## 回答 #2

> 赞同：29
> 
> 时间：2012-04-16T19:15:39.883

简单如`aggregate`：

```
aggregate(df['y'], by=df['x'], sum) 
```

* * *

## 回答 #3

> 赞同：13
> 
> 时间：2016-01-05T13:34:22.283

一个`dplyr`解决方案：

```
library(dplyr)
df %>% group_by(x) %>% summarise(y = sum(y)) 
```

* * *

## 回答 #4

> 赞同：9
> 
> 时间：2012-09-13T04:13:38.903

`data.table`时间和内存效率的解决方案

```
library(data.table)
DT <- as.data.table(df)
# which columns are numeric 
numeric_cols <- which(sapply(DT, is.numeric))
DT[, lapply(.SD, sum), by = x, .SDcols = numeric_cols] 
```

或者，在您的情况下，假设您知道只有 1 列`y`您希望求和

```
DT[, list(y=sum(y)),by=x] 
```

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2012-04-16T19:16:27.070

```
> tapply(df$y, df$x, sum)
sp1 sp2 sp3 sp4 
  2   9   7   3 
```

如果必须是`data.frame`本的答案，效果很好。或者你可以强制tapply输出。

```
out <- tapply(df$y, df$x, sum)
>     data.frame(x=names(out), y=out, row.names=NULL)
    x y
1 sp1 2
2 sp2 9
3 sp3 7
4 sp4 3 
```

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2016-01-05T13:31:04.563

一个 MWE 来验证一个公式是否尊重第二个变量（即这里的“Z”和“X”之外的，实际上会起作用：

```
example = data.frame(X=c("x"),Z=c("a"),Y=c(1), stringsAsFactors=F)
newrow = c("y","b",1)
example <- rbind(example, newrow)
newrow = c("z","a",0.5)
example <- rbind(example, newrow)
newrow = c("x","b",1)
example <- rbind(example, newrow)
newrow = c("x","b",2)
example <- rbind(example, newrow)
newrow = c("y","b",10)
example <- rbind(example, newrow)
example$X = as.factor(example$X)
example$Z = as.factor(example$Z)
example$Y = as.numeric(example$Y)
example_agg <- aggregate(Y~X+Z,data=example,FUN=sum) 
```

# mysql - MySQL / JDBC 如何检索查询的完整终端视图（显示带有 +- 的表）

> ID：10180136
> 
> 赞同：0
> 
> 时间：2012-04-16T19:09:22.990
> 
> 标签：mysql, jdbc

如何检索 mysql 选择查询的终端视图？

期望的结果：以下；我如何在我的结果集中得到它？而不仅仅是特定列的数字？

```
+---------+----------+
| Dog_ID  | Owner_ID |
+---------+----------+
|    1    |     1    |
|    2    |     1    |
|    3    |     2    |
+---------+----------+ 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-16T19:14:19.110

MySQL 在控制台中使用该确切的输出。打开`MySQL Command Line Client`MySQL 安装附带的，然后输入您的选择，例如

```
select * from your_table; 
```

然后将结果从控制台输出中复制出来。

# c++ - 比较乘法和除法

> ID：10180143
> 
> 赞同：-2
> 
> 时间：2012-04-16T19:09:39.263
> 
> 标签：c++, performance, analysis

我想知道以下两种方法在速度上是否有区别

```
#include<math.h>
#include<iostream>
using namespace std;

int main()
{
    float k=7;
    float b=4;
    cout<<(float)k/b<<" "<<endl;
    cout<<(float)(k*powf(b,-1))<<" "<<endl;

    return 0;
} 
```

1.  琐碎的划分`k/b`
2.  使用乘法`k*b^(-1)`，

我认为在第二种方法中，没有实际的划分程序。所以我认为第二个更快。我对吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-16T19:18:28.280

你错的可能性很大。即使编译器可以生成`powf`内在函数（即为其生成内联代码），N ^(-1)也等于 1/N，因此您只是以更迂回的方式进行除法。如果提高幂是一种更快的除法方法，那么编译器可能已经生成了这样的代码。

另一方面，如果您使用相同的分母进行大量除法，您*可能会*通过转动以下循环获得一些东西：

```
for (int i=0; i<some_size; i++)
    somearray[i] /= denom; 
```

进入：

```
double scale = 1.0/denom;

for (int i=0; i<some_size; i++)
    somearray[i] *= scale; 
```

当然，编译器*可能也*足够聪明，可以做到这一点，但至少在这样的情况下，你正在做的事情很有可能成为改进——唯一的问题是编译器是否已经这样做了它给你。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-16T19:20:28.297

您应该分析两个版本并检查哪个版本更快，但如果是第二个版本，我几乎准备吃掉我的帽子，原因如下：

1.  `powf`是一个通用函数，对于指数参数的典型值来说*非常*慢。即使经过优化`-1`专门处理这种情况，仍然会有`if`s 等来检查这种特殊情况，这会增加计算的开销。
2.  根据实现，`powf`可能不会内联，并且您将承担函数调用的成本。
3.  如果`k*(1.0/b)`真的比 快`k/b`，那么编译器已经将后者优化为前者（尤其是在指定编译器标志以允许快速但不一定完全符合 IEEE 的浮点数学时。）

底线是现代编译器非常擅长执行微优化。我不会梦想尝试像这样的“技巧”，除非分析和反汇编显示明确的证据表明编译器正在做一些低效的事情。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-16T19:15:58.927

速度始终取决于编译器的优化程度。所以，只有通过测量才能找到可靠的答案。

但是，第二种方法比第一种方法意味着更多的调用。因此，我想第一个会更快。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-04-16T19:17:48.457

计算 b^(-1) 并非易事，有时（尽管不总是）会被优化器转换为 1/b。同样，优化器可能会`*b^(-1)`使用`/b`. 这可能与硬件有关（如果在编译时已知数字，甚至可能与数字有关）。

如果你想测试它，把每一个都放在一个运行多次的循环中（不要在屏幕上打印任何东西），并为每次执行计时。

另请注意，在某些情况下，如果您对精确计算感兴趣，这两种方法会给您带来略微不同的结果。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-04-16T19:25:20.403

正如其他人所说，个人资料。在计算机科学中，除法可以通过重复减法来实现。这可能比乘以倒数更快。

我相信除法会比乘以倒数更快，因为必须先计算倒数，然后再执行乘法。因此，当除法执行减法时，另一种方法是确定逆。在计算出逆后，必须执行多次移位和加法（乘法）。

参见[关于除法算法的维基百科文章](http://en.wikipedia.org/wiki/Division_algorithm)

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-04-16T19:33:03.703

在我的 x86-64 机器上使用 gcc -O2 ， k / b 转换为一条指令：

```
divss   xmm0, xmm1 
```

'powf' 方式导致以下结果：

```
movss   xmm2, DWORD PTR .LC0[rip]
divss   xmm2, xmm1
mulss   xmm2, xmm0
movaps  xmm0, xmm2 
```

其中 .LC0 是 1065353216 或 1.0f。

所以在我看来，至少对于现在常见的 x86-64 机器来说，k / b 更快。

# linux - 透明代理请求如何路由回客户端？

> ID：10180144
> 
> 赞同：0
> 
> 时间：2012-04-16T19:09:53.230
> 
> 标签：linux, proxy, cdn, bandwidth

我正在寻找一种方法来混淆对 Web 服务器的请求，而不是从 CDN 中提取数据

我相信我需要在 Web 服务器上创建一个透明代理并将请求传递给 CDN，如下所示：

客户端 ===> 网络服务器：80 ====> 代理：someport ===> cdn.example.com

我不知道响应是否通过代理路由回，有效地向我收取两次带宽费用，如下所示：

cdn.example.com ====> 代理：someport ====> 网络服务器：80 ====> 客户端

或者，如果请求实质上绕过代理并响应客户端：

cdn.example.com ===> 客户端

我也*很*确定代理请求的端点不可嗅探，但如果有人知道否则我会很感激！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-16T19:25:03.247

并不是说我完全精通这一点，但是您不能直接返回`302 found`并让客户端首先联系 cdn（甚至可能更改相关文件的 url，因此客户端永远不会联系 webserver:80）？像这样回复：

cdn.example.com ===> 客户端

只能通过将 IP 数据包的源地址伪造到 CDN 来实现。我不确定您的网络服务器的 ISP 是否允许这样做。

# javascript - 如何在javascript中计算下降高度？

> ID：10180148
> 
> 赞同：4
> 
> 时间：2012-04-16T19:10:06.247
> 
> 标签：javascript, css, fonts, embedded-fonts

我的 css 已根据可用的字体定义了要层叠的字体系列：

```
.myfont { 
    text-transform: uppercase;
    font-family: Calibri, Arial, sans-serif;
    padding: 2em;
    background-color: red;
} 
```

并且，根据渲染的字体，我想调整填充以将全大写文本适当地居中在`<sarcasm>`美丽的`</sarcasm>`红色背景中。有没有一种好方法来计算字体[下降](http://en.wikipedia.org/wiki/Descender)器的大小，以便我可以相应地调整底部填充？

[还计算上升高度](http://en.wikipedia.org/wiki/Ascender_%28typography%29)、[上限高度](http://en.wikipedia.org/wiki/Cap_height)和[x 高度](http://en.wikipedia.org/wiki/X-height)的解决方案的奖励积分。

提前致谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2014-08-08T08:57:28.680

这是可能的：使用这个库：[baseline ratio](https://github.com/nathanhammond/baseline-ratio/blob/master/baseline-ratio.js)或[typography.js](https://github.com/ELLIOTTCABLE/typography.js/)将两个跨度插入容器div，字体大小为0px，字体大小为100或2000，调用`getBoundingClientRect();`，获取高度差，然后除以更大的高度。0 px 字体位于基线上。这给出了基线比率，上升和下降的百分比。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-16T19:20:58.317

AFAIK 用 Ja​​vaScript 是不可能的。您可能能够找出使用的字体，但不能找出字体参数。

因此，您需要搜索这些参数（例如在字体库中）并按字体存储它们，以便在知道使用的字体后查找它们。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2019-05-15T10:05:00.403

一个名为 EightShapes 的 Web 开发机构已经整合了一个[工具](http://text-crop.eightshapes.com/)，可以让您生成 CSS 以裁剪文本上方和下方的空间，从而使布局能够很好地围绕上升和下降。有一篇关于它的[随附博客文章](https://medium.com/eightshapes-llc/cropping-away-negative-impacts-of-line-height-84d744e016ce)。

# java - Android - 没有传入引用的泄漏对象

> ID：10180149
> 
> 赞同：2
> 
> 时间：2012-04-16T19:10:06.213
> 
> 标签：java, android, memory-leaks

我在 Android 的 HttpClient 中遇到内存泄漏问题。当我导出 hprof 文件并在 Eclipse MAT 中打开它时，我可以看到有两个内存泄漏嫌疑人。

1）“org.apache.http.impl.conn.DefaultResponseParser”的48个实例，由“”加载，占用8 066 552（61,52％）字节。2）12个“org.apache.http.impl.io.SocketInputBuffer”实例，由“”加载，占用2098480（16.01%）字节。

这超过了整个堆的 3/4 和超过 10MB 的内存。两者都在 HttpClient 中的某个地方，两者在 MAT 中都没有传入引用。

你有一些想法如何解决这个问题吗？问我是否需要更多信息。

# iphone - PNG图像需要被压碎的原因是什么？

> ID：10180150
> 
> 赞同：1
> 
> 时间：2012-04-16T19:10:07.917
> 
> 标签：iphone, uiimage, pngcrush

我注意到一些文章谈论粉碎的 PNG 图像以及如何解压它们。粉碎第一手图像的目的是什么？并且还可以使用 [UIImage imageWithName:] 加载粉碎的图像吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-16T19:14:50.550

它用于使用无损优化和/或压缩来减小文件的大小。

它可以使用多种优化来评估您的输入图像。基本示例：如果您的输入是灰度并保存为颜色，它可能会输出灰度图像。当然，它使用了更复杂的优化。

> 仍然可以使用 [UIImage imageWithName:] 加载粉碎的图像吗？

是的

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-16T19:15:04.560

它基本上是一种不涉及任何数据丢失的压缩形式（也就是说，您不会丢失任何图像质量）。压缩任何数据都会减小它的大小，这就是实际这样做的原因。

# iphone - 如何在 iPhone 应用程序中有 2 个 leftBarButtonItems，并且 1 个是默认的后退按钮？

> ID：10180155
> 
> 赞同：6
> 
> 时间：2012-04-16T19:10:42.807
> 
> 标签：iphone, xcode, uinavigationcontroller, uibarbuttonitem

我想要 2 个 leftBarButtonItems，但将其中一项保留为导航控制器的默认后退按钮。我已经设置：

```
self.navigationItem.leftBarButtonItems = [NSArray arrayWithObjects:archives, ???, nil]; 
```

其中 archives 是我创建的 UIBarButtonItem，但不知道数组中包含的默认后退按钮是什么。有什么建议么？

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2012-04-16T19:18:21.750

确保设置`leftItemsSupplementBackButton`为 YES。

```
self.navigationItem.leftItemsSupplementBackButton = YES;
self.navigationItem.leftBarButtonItems = [NSArray arrayWithObjects:archives, nil]; 
```

# c# - 事件句柄和可见

> ID：10180156
> 
> 赞同：2
> 
> 时间：2012-04-16T19:10:42.970
> 
> 标签：c#, .net

好的，我正在为我的班级做一个项目。我必须在一页上制作所有内容，顶部有一个菜单。在菜单中，假设有新建、打开、从 Html、保存和退出。除了From HTML之外，我已经完成了所有工作。我有点困惑。当用户单击 From HTML 时，所有内容都需要在一个页面上显示一个文本框和一个按钮，然后您应该能够输入一个网址并单击 go，html 代码会显示在richtextbox 中。现在我遇到的问题是把这一切都说对了。这是我到目前为止所拥有的..

```
 private void button1_Click(object sender, EventArgs e)
    {
         WebRequest myRequest;
        myRequest = WebRequest.Create("//");
        WebResponse myResponse = myRequest.GetResponse();
        Stream responseStream = myResponse.GetResponseStream();
        StreamReader reader = new StreamReader(responseStream);

        StringBuilder sb = new StringBuilder();
        string line="";
        while ((line = reader.ReadLine()) != null)
        {
            sb.Append(line);
            sb.Append("\r\n");
        }
        richTextBox1.Text = sb.ToString();

    } 
```

正如你所看到的，这条线有这个

```
 myRequest = WebRequest.Create("//"); 
```

事实上，我有点忘记如何将其设置为空白以供用户输入信息。或者有没有一种方法，当他们点击 From HTML 时，消息框可以显示文本框和按钮，但显示在 RichTextBox 中？我忘了添加这段代码

```
private void fromHTMLToolStripMenuItem_Click(object sender, EventArgs e)
    {

    } 
```

当用户单击此按钮时，消息框应该是可见的，因此它显示文本框和按钮以在富文本区域中显示 HTML。

编辑：我有一个名为 panel1 的面板组。它有按钮和文本框供用户输入他们想要的 URL。知道我的问题是，当 peron 点击​​ From HTML 时，我需要让面板仅对该面板可见。那么我会点击面板吗？我如何才能让它只对那个面板可见。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-16T19:23:16.847

由于这是作业，我不会给你完整的答案，但这里是一个开始的地方：

`MessageBox`向用户显示一条消息并让他单击一个按钮作为响应，但您不能向其添加控件。相反，您必须定义另一个包含文本框和确认按钮的表单，并在`fromHTMLToolStripMenuItem_Click`. 您可以在该表单中设置一个属性来保存用户的响应（所需的 URI），并在表单返回时在事件处理程序中检索它。

# c# - .NET 4.0 完整包含客户端配置文件？

> ID：10180157
> 
> 赞同：2
> 
> 时间：2012-04-16T19:10:46.980
> 
> 标签：c#, asp.net, .net, distribution

我开始使用 4.0 客户端配置文件发送我的应用程序，但现在我需要完整的 4.0 框架，因为我的新应用程序需要一些 ASP.NET “东西”。

在没有任何 4.0 的新 PC 上，我可以安装“完整”4.0 框架并让我的“客户端配置文件”4.0 框架代码仍然有效吗？

还是我必须让最终用户同时安装两者？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-04-16T19:13:00.477

完整的框架应该是一个超集，包括来自客户端配置文件的所有内容。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-16T19:14:10.550

完整包括客户端配置文件中的所有内容。

# styles - 如何更改已分配样式的 mdiTab 的颜色？（基础设施）

> ID：10180162
> 
> 赞同：1
> 
> 时间：2012-04-16T19:11:13.197
> 
> 标签：styles, infragistics, mdi

我想在某个事件上更改选项卡的颜色。项目的 ISL 文件包含以下内容：

```
<styleLibrary>
  <styleSets defaultStyleSet="Default">
    <styleSet name="Default" viewStyle="Standard">
      ...
      <styles>
        ...
        <style role="TabItem">
          <states>
            <state name="Normal">
              <resources>
                <name>Header</name>
              </resources>
            </state>

            <state name="HotTracked">
              <resources>
                <name>HeaderHotTrack</name>
              </resources>
            </state>

            <state name="Active">
              <resources>
                <name>HeaderActive</name>
              </resources>
            </state>
            ...
          </states>
        </style>
      </styles>
    </styleSet>
  <resources>
    ...
    <resource name="Header" backColor="White" foreColor="Black" backColor2="255, 152, 53" backGradientStyle="Vertical" />

    <resource name="HeaderActive" backColor="255, 237,175" foreColor="Black" backColor2="255, 127, 0" backGradientStyle="Vertical" />

    <resource name="HeaderHotTrack" backColor="25, 237, 175" foreColor="White" backColor2="255,127, 0" backGradientStyle="Vertical" />

    <resource name="HeaderHasUpdates" backColor="Green" foreColor="Black" backColor2="White" backGradientStyle="Vertical" />
    ...
  </resources>
</styleLibrary> 
```

当程序开始时，它会加载：

Infragistics.Win.AppStyling.StyleManager.Load()

选择选项卡时，选项卡将着色为名为“HeaderActive”的资源。在某个触发器上，我希望它切换到名为“HeaderHasUpdates”的资源。我目前没有工作的是这个（mdiTab 是 Infragistics.Win.UltraWinTabbedMdi.MdiTab）：

mdiTab.Settings.TabAppearance.StyleResourceName = "HeaderHasUpdates"

如果我删除除“HeaderHasUpdates”之外的所有资源，前景色确实会发生变化，这让我认为还有另一个地方正在设置颜色，而在那个地方，前景色没有被设置。我只是不熟悉颜色样式的优先级。

那么我能做些什么来改变风格呢？

-- 编辑 2012 年 4 月 17 日 --

作为记录，在 <styleSet> 和 <styles> 之上添加的修复：

```
<componentStyles>
  <componentStyle name="UltraTabbedMdiManager" resolutionOrder="ControlThenApplication">
    <properties>
      <property> name="ViewStyle" colorCategory="{Default}">Office2003</property>
    </properties>
  </componentStyle>
</componentStyles> 
```

以防万一您不想使用 AppStylist

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-16T19:49:28.123

从来没有这样做过，所以这需要测试，但是我认为你可以尝试在你的 ISL 文件中定义两个 StyleSet。（样式资源管理器-> 添加）

In the first you set your default style, in the second you define only the Style for the TabHeader. When you need the different style, just set the StyleSetName to the second StyleSet available in your ISL file. Don't know if some kind of refresh will be needed.

Also if you want to override the settings from appstylist with appearances defined at design time, you would need to check the **ResolutionOrder** in AppStylist Go to `"Component Role Settings->Infragistics Components->UltraTabControl->ResolutionOrder"` The ResolutionOrder is, by default, set to `ApplicationThenControl` which means that the AppStyling property values take precedence over any control settings for the corresponding appearance properties. In your case, you should change that to `ControlThenApplication` so the properties set on the control will take precedence.

# javascript - 递归搜索 JSON 并删除某些子对象

> ID：10180167
> 
> 赞同：2
> 
> 时间：2012-04-16T19:11:31.130
> 
> 标签：javascript

我需要递归搜索一个复杂的 json 对象，并删除与任何以“_”开头的键关联的对象。

到目前为止，我有：

```
sanitize: function(json){
    for(var i in json){
        if(json[i]){
            if(i.substring(0,1) == "_")
                delete json[i];
            else
                this.sanitize(json[i]);
        }
    }
    console.log(json);
    return json;
} 
```

我超过了最大调用堆栈。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-16T19:16:20.743

尝试使用您自己的数组，并确保子对象不是循环引用，并确保它们是对象。

```
function sanitize(json) {
    var stack = [];
    var done = [];

    do {
        for(var x in json) {
            if(x.charAt(0) === '_') {
                delete json[x];
            } else if(done.indexOf(json[x]) === -1 && typeof json[x] === 'object') {
                stack.push(json[x]);
                done.push(json[x]);
            }
        }
    } while(json = stack.pop());
} 
```

# ruby-on-rails - 使用 Mongo db 让 Rails 在 Heroku 上工作

> ID：10180169
> 
> 赞同：2
> 
> 时间：2012-04-16T19:11:33.657
> 
> 标签：ruby-on-rails, mongodb, heroku

我已经下载了一个开源代码[ribbot](https://github.com/barmstrong/ribbot.git)。我是 Ruby 和 Rails 的新手，但我已经设置了我的环境，并且能够让这段代码在我的本地机器上运行。

我想使用 Heroku 作为我的服务器基础解决方案。我将此应用程序推送到 Heroku。Heroku 似乎告诉我该应用程序运行良好，但是我不断通过开源代码重定向到错误页面；它不会在我的本地机器上这样做。我怀疑它与Mongo有关。我已经为 Heroku 下载了 MongoHQ 上的插件，但仍然遇到这个问题。我知道这段代码使用 mongoid：

```
2012-04-16T19:06:47+00:00 app[web.1]: localhost:11211 failed (count: 2)
2012-04-16T19:06:47+00:00 app[web.1]: 
2012-04-16T19:06:47+00:00 app[web.1]: 
2012-04-16T19:06:47+00:00 app[web.1]: Started GET "/" for 208.124.140.154 at 2012-04-16 19:06:47 +0000
2012-04-16T19:06:47+00:00 app[web.1]: allow_dynamic_fields is not a valid option for Mongo::Connection
2012-04-16T19:06:47+00:00 app[web.1]: autocreate_indexes is not a valid option for Mongo::Connection
2012-04-16T19:06:47+00:00 app[web.1]: identity_map_enabled is not a valid option for Mongo::Connection
2012-04-16T19:06:47+00:00 app[web.1]: include_root_in_json is not a valid option for Mongo::Connection
2012-04-16T19:06:47+00:00 app[web.1]: include_type_for_serialization is not a valid option for Mongo::Connection
2012-04-16T19:06:47+00:00 app[web.1]: max_retries_on_connection_failure is not a valid option for Mongo::Connection
2012-04-16T19:06:47+00:00 app[web.1]: parameterize_keys is not a valid option for Mongo::Connection
2012-04-16T19:06:47+00:00 app[web.1]: scope_overwrite_exception is not a valid option for Mongo::Connection
2012-04-16T19:06:47+00:00 app[web.1]: persist_in_safe_mode is not a valid option for Mongo::Connection
2012-04-16T19:06:47+00:00 app[web.1]: preload_models is not a valid option for Mongo::Connection
2012-04-16T19:06:47+00:00 app[web.1]: raise_not_found_error is not a valid option for Mongo::Connection
2012-04-16T19:06:47+00:00 app[web.1]: skip_version_check is not a valid option for Mongo::Connection
2012-04-16T19:06:47+00:00 app[web.1]: time_zone is not a valid option for Mongo::Connection
2012-04-16T19:06:47+00:00 app[web.1]: use_utc is not a valid option for Mongo::Connection
2012-04-16T19:06:47+00:00 app[web.1]: timestamped_migrations is not a valid option for Mongo::Connection
2012-04-16T19:06:50+00:00 app[web.1]: 
2012-04-16T19:06:50+00:00 app[web.1]: Mongo::ConnectionFailure (Failed to connect to a master node at localhost:27017):
2012-04-16T19:06:50+00:00 app[web.1]:   app/controllers/application_controller.rb:19:in `current_forum'
2012-04-16T19:06:50+00:00 app[web.1]:   app/controllers/application_controller.rb:40:in `require_current_forum!'
2012-04-16T19:06:50+00:00 app[web.1]: 
2012-04-16T19:06:50+00:00 app[web.1]: 
2012-04-16T19:06:50+00:00 app[web.1]: cache: [GET /] miss
2012-04-16T19:06:50+00:00 app[web.1]:   Processing by PostsController#index as HTML
2012-04-16T19:06:50+00:00 app[web.1]: Completed 500 Internal Server Error in 2997ms
2012-04-16T19:06:50+00:00 app[web.1]: Rendered vendor/bundle/ruby/1.9.1/gems/exception_notification_rails3-1.2.0/lib/exception_notifier/views/exception_notifier/_request.text.erb (0.2ms)
2012-04-16T19:06:50+00:00 app[web.1]: Rendered vendor/bundle/ruby/1.9.1/gems/exception_notification_rails3-1.2.0/lib/exception_notifier/views/exception_notifier/_title.text.erb (0.0ms)
2012-04-16T19:06:50+00:00 app[web.1]: Rendered vendor/bundle/ruby/1.9.1/gems/exception_notification_rails3-1.2.0/lib/exception_notifier/views/exception_notifier/_session.text.erb (0.2ms)
2012-04-16T19:06:50+00:00 app[web.1]: Rendered vendor/bundle/ruby/1.9.1/gems/exception_notification_rails3-1.2.0/lib/exception_notifier/views/exception_notifier/_title.text.erb (0.0ms)
2012-04-16T19:06:50+00:00 app[web.1]: Rendered vendor/bundle/ruby/1.9.1/gems/exception_notification_rails3-1.2.0/lib/exception_notifier/views/exception_notifier/_environment.text.erb (23.9ms)
2012-04-16T19:06:50+00:00 app[web.1]: Rendered vendor/bundle/ruby/1.9.1/gems/exception_notification_rails3-1.2.0/lib/exception_notifier/views/exception_notifier/_title.text.erb (0.0ms)
2012-04-16T19:06:50+00:00 app[web.1]: Rendered vendor/bundle/ruby/1.9.1/gems/exception_notification_rails3-1.2.0/lib/exception_notifier/views/exception_notifier/_backtrace.text.erb (0.1ms)
2012-04-16T19:06:50+00:00 app[web.1]: Rendered vendor/bundle/ruby/1.9.1/gems/exception_notification_rails3-1.2.0/lib/exception_notifier/views/exception_notifier/_title.text.erb (0.0ms)
2012-04-16T19:06:50+00:00 app[web.1]: Rendered vendor/bundle/ruby/1.9.1/gems/exception_notification_rails3-1.2.0/lib/exception_notifier/views/exception_notifier/exception_notification.text.erb (26.8ms)
2012-04-16T19:06:50+00:00 app[web.1]: 
2012-04-16T19:06:50+00:00 app[web.1]: Sent mail to barmstrong@gmail.com (274ms)
2012-04-16T19:06:50+00:00 heroku[router]: GET impact-project.herokuapp.com/ dyno=web.1 queue=0 wait=0ms service=3832ms status=500 bytes=728
2012-04-16T19:06:51+00:00 app[web.1]: localhost:11211 failed (count: 3)
2012-04-16T19:06:51+00:00 app[web.1]: cache: [GET /favicon.ico] miss, store
2012-04-16T19:06:51+00:00 app[web.1]: [2012-04-16 19:06:51] ERROR NoMethodError: undefined method `each' for nil:NilClass
2012-04-16T19:06:51+00:00 app[web.1]:   /app/vendor/bundle/ruby/1.9.1/gems/rack-1.3.5/lib/rack/handler/webrick.rb:71:in `service'
2012-04-16T19:06:51+00:00 app[web.1]:   /usr/local/lib/ruby/1.9.1/webrick/httpserver.rb:111:in `service'
2012-04-16T19:06:51+00:00 app[web.1]:   /usr/local/lib/ruby/1.9.1/webrick/httpserver.rb:70:in `run'
2012-04-16T19:06:51+00:00 app[web.1]:   /usr/local/lib/ruby/1.9.1/webrick/server.rb:183:in `block in start_thread'
2012-04-16T19:06:51+00:00 heroku[router]: GET impact-project.herokuapp.com/favicon.ico dyno=web.1 queue=0 wait=0ms service=517ms status=500 bytes=337 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-04-16T19:52:38.503

如果你在 Heroku 中安装了 MongoHQ 插件，它会创建一个 MONGOHQ_URL 环境变量，你的 Rails 应用可以使用它来连接数据库。看起来您的 config/mongoid.yml 配置不正确。这是 Heroku 和 MongoHQ 的一个工作示例：

```
development:
    host: localhost
    database: yourapp_dev

test:
   host: localhost
   database: yourapp_test

# set these environment variables on your prod server
production:
    uri: <%= ENV['MONGOHQ_URL'] %> 
```

希望这可以帮助！

# ruby - 如何使用 ruby fb_graph 发布 Facebook 页面更新？

> ID：10180170
> 
> 赞同：3
> 
> 时间：2012-04-16T19:11:46.240
> 
> 标签：ruby, facebook, facebook-graph-api, fb-graph

我只是想将某些事件的帖子自动发送到我的公司 Facebook 页面。从我迄今为止所读到的内容看来，它似乎应该很简单，但是我遇到了障碍。

我有一些代码的示例，错误如下：

```
 user = FbGraph::User.me(access_token)
  user = FbGraph::User.fetch('PageName')
  FbGraph.debug! # yields true
  user.feed!(
    :message => 'Updating via FbGraph',
    :link => 'https://domain.tld',
    :name => 'PageName',
    :description => 'This is a test post to be deleted'  
  ) 
```

这将返回以下错误：

```
======= [FbGraph] API REQUEST STARTED =======
POST /234062246478665/feed HTTP/1.1
Content-Type: application/x-www-form-urlencoded
Content-Length: 124
Host: graph.facebook.com

message=Updating+via+FbGraph&link=https%3A%2F%2Fdomain.tld&name=PageName&description=This+is+a+test+post+to+be+deleted
--------------------------------------------------
Status: 403 Forbidden
Access-Control-Allow-Origin: *
Cache-Control: no-store
Content-Type: text/javascript; charset=UTF-8
Expires: Sat, 01 Jan 2000 00:00:00 GMT
Pragma: no-cache
WWW-Authenticate: OAuth "Facebook Platform" "insufficient_scope" "(#200) This API call requires a valid app_id."
X-FB-Rev: 541309
X-FB-Debug: JN9/Vt8MN24GNUL34l8TE2cDuCRZZehdUTx2KkOrHQ8=
X-Cnection: close
Date: Mon, 16 Apr 2012 18:55:20 GMT
Content-Length: 0

{"error":{"message":"(#200) This API call requires a valid app_id.","type":"OAuthException","code":200}}
======= [FbGraph] API REQUEST FINISHED =======
/Users/username/.rvm/gems/ruby-1.9.3-p125@all/gems/fb_graph-2.4.10/lib/fb_graph/exception.rb:55:in `handle_httpclient_error': OAuthException :: (#200) This API call requires a valid app_id. (FbGraph::Unauthorized)
    from /Users/username/.rvm/gems/ruby-1.9.3-p125@all/gems/fb_graph-2.4.10/lib/fb_graph/node.rb:145:in `handle_response'
    from /Users/username/.rvm/gems/ruby-1.9.3-p125@all/gems/fb_graph-2.4.10/lib/fb_graph/node.rb:54:in `post'
    from /Users/username/.rvm/gems/ruby-1.9.3-p125@all/gems/fb_graph-2.4.10/lib/fb_graph/connections/feed.rb:15:in `feed!'
    from ./test_script.rb:168:in `block in <main>'
    from /Users/username/.rvm/gems/ruby-1.9.3-p125@all/gems/nokogiri-1.5.2/lib/nokogiri/xml/node_set.rb:239:in `block in each'
    from /Users/username/.rvm/gems/ruby-1.9.3-p125@all/gems/nokogiri-1.5.2/lib/nokogiri/xml/node_set.rb:238:in `upto'
    from /Users/username/.rvm/gems/ruby-1.9.3-p125@all/gems/nokogiri-1.5.2/lib/nokogiri/xml/node_set.rb:238:in `each'
    from ./test_script.rb:85:in `each_with_index'
    from ./test_script.rb:85:in `<main>' 
```

在*developers.Facebook.com/apps -> Settings -> Auth* Dialog 上，我将 设置`Extended Permissions`为包含`publish_stream`和`status_update`.

**我发现`curl`使用相同令牌的访问确实可以按如下方式工作：**

```
curl -F 'access_token=MY_BIG_OLE_LONG_TOKEN' -F 'message=testing message' https://graph.facebook.com/MyPage/feed 
```

我是否错过了某处的权限设置，或者没有使用`fb_graph`ruby​​ gem 正确调用 api？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-17T07:27:42.210

您需要查看图形 API[页面的文档。](https://developers.facebook.com/docs/reference/api/page/)检查`access_token`哪个字段`manages_pages`。您需要在`extended_permission`. 这里的关键是获得正确的令牌。文本字段中的令牌可能大部分时间都不起作用。您需要向[https://graph.facebook.com/YOUR_PROFILE_ID/accounts](https://graph.facebook.com/YOUR_PROFILE_ID/accounts)`GET`发送请求以获取正确的令牌。好像你已经选对了。

我以前用过`koala`宝石。如张贴[在这里](https://github.com/arsduo/koala/wiki/Graph-API)。

`page_graph = Koala::Facebook::GraphAPI.new(@access_token)`
`page_graph.put_object('MyPage', 'feed', :message => 'This is posted as the page')`

好吧，我必须说 facebook 的 API 文档缺乏对开发人员的友好性。你需要深入挖掘才能让最简单的事情发挥作用。

我希望这将帮助您开始自动化 FB 帖子。

# wpf - 为什么我不能在边框上使用 AlternationCount？

> ID：10180172
> 
> 赞同：1
> 
> 时间：2012-04-16T19:11:50.287
> 
> 标签：wpf, xaml

在下面的代码中，如果我改变

```
 <Style  TargetType="{x:Type Border}"> 
```

至

```
 <Style  TargetType="{x:Type ListBoxItem}"> 
```

它会将我的整个列表框项着色为正确的颜色。但我只想打边框背景

```
 <ListBox  x:Name="FilteredMessagesListBox" BorderThickness="0" ScrollViewer.HorizontalScrollBarVisibility="Disabled" HorizontalContentAlignment="Stretch"  SelectionMode="Extended" Background="Transparent" AlternationCount="2">
                        <ListBox.Resources>
                            <Style  TargetType="{x:Type Border}">
                                <Style.Triggers>
                                    <Trigger Property="ItemsControl.AlternationIndex" Value="0">
                                        <Setter Property="Background" Value="LightBlue"></Setter>
                                    </Trigger>
                                    <Trigger Property="ItemsControl.AlternationIndex" Value="1">
                                        <Setter Property="Background" Value="LightGreen"></Setter>
                                    </Trigger>
                                </Style.Triggers>
                            </Style>

                        </ListBox.Resources>

                        <ListBox.ItemTemplate >
                            <DataTemplate>
                                <DockPanel Margin="0,0,0,3">
                                    <Button x:Name="AttachmentImageButton" Click="AttachmentImageButton_Click" DockPanel.Dock="Bottom" MaxWidth="200" MaxHeight="200" HorizontalContentAlignment="Center" Visibility="{Binding ElementName=AttachmentImageButton, Converter={StaticResource cImageAttachmentToVisible}}" >
                                        <Image Source="{Binding Path=Attachment}" x:Name="AttachmentImage" />
                                    </Button>
                                    <Button x:Name="AttachmentButton" Click="AttachmentButton_Click" DockPanel.Dock="Right" Visibility="{Binding ElementName=AttachmentButton, Converter={StaticResource cAttachmentToVisible}}" >
                                        <Image Source="/MobilWPF;component/Resources/Images/PaperClip/PaperClip.jpg" Width="20" Height="20"/>
                                    </Button>

                                    <TextBlock Text="{Binding Converter={StaticResource cGetInstantMessageHeader}}" Width="120" TextWrapping="Wrap" HorizontalAlignment="Left"  Background="Transparent" FontSize="10" DockPanel.Dock="Left"/>

                                    <Border DockPanel.Dock="Left"  HorizontalAlignment="Stretch" CornerRadius="5">
                                        <DockPanel>
                                            <TextBlock Margin="5,0,0,0" Text="{Binding Path=Message}" TextWrapping="Wrap" DockPanel.Dock="Left" HorizontalAlignment="Left" Background="Transparent" FontSize="12"/>
                                        </DockPanel>
                                    </Border>
                                </DockPanel>
                            </DataTemplate>
                        </ListBox.ItemTemplate>
                    </ListBox> 
```

我试过这个：

```
 <Border DockPanel.Dock="Left"  HorizontalAlignment="Stretch" CornerRadius="5">
                                        <Border.Triggers>
                                            <DataTrigger Binding="{Binding Path=(ItemsControl.AlternationIndex), RelativeSource={RelativeSource FindAncestor, AncestorType={x:Type ListBoxItem}}}" Value="0">
                                                <Setter Property="Background" Value="LightBlue"/>
                                            </DataTrigger>
                                            <DataTrigger Binding="{Binding Path=(ItemsControl.AlternationIndex), RelativeSource={RelativeSource FindAncestor, AncestorType={x:Type ListBoxItem}}}" Value="1">
                                                <Setter Property="Background" Value="LightGreen"/>
                                            </DataTrigger>
                                        </Border.Triggers>
  <DockPanel>
                                            <TextBlock Margin="5,0,0,0" Text="{Binding Path=Message}" TextWrapping="Wrap" DockPanel.Dock="Left" HorizontalAlignment="Left" Background="Transparent" FontSize="12"/>
                                        </DockPanel>
                                    </Border> 
```

在“ContentPresenter”类型上找不到静态成员“BackgroundProperty”

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-16T19:49:42.757

问题在于它`AlternationIndex`是在容器上设置的（`ListBoxItem`在这种情况下是 s ），而不是在其中的某个孩子上。`DataTrigger`您可以通过使用绑定到`AlternationIndex`父级的 s来解决此问题`ListBoxItem`：

```
<DataTrigger Binding="{Binding Path=(ItemsControl.AlternationIndex), RelativeSource={RelativeSource FindAncestor, AncestorType={x:Type ListBoxItem}}}" Value="0">
    <Setter Property="Background" Value="LightBlue"/>
</DataTrigger> 
```

# java - 在java中创建图形

> ID：10180173
> 
> 赞同：15
> 
> 时间：2012-04-16T19:11:54.197
> 
> 标签：java

我想创建一个程序来创建一个图（具体来说是一个程序图），它在节点上存储值，还存储每个节点连接到的其他节点。

我正在考虑使用链表来做到这一点。这是正确的方法吗？任何其他建议将不胜感激。

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2012-04-16T19:36:22.827

在大多数情况下，使用邻接列表对图形进行建模是个好主意。可能有现有的框架可以做到这一点，但如果您对作为练习的表示感兴趣，您通常需要两件事。首先，一个包含所有节点的 HashMap，节点的节点标签可以是键，节点本身就是值。

Java API[在此处](http://docs.oracle.com/javase/6/docs/api/java/util/HashMap.html)记录 HashMaps 。

在每个节点对象中，您需要一个与该节点相邻的节点列表。最好使用 ArrayList 来完成，[这里](http://docs.oracle.com/javase/6/docs/api/java/util/ArrayList.html)记录了它。

以下是它的组织方式。

```
import java.util.Hashmap;
import java.util.ArrayList;

class Node {
    String label;
    ArrayList<Node> adjacencyList;
}

HashMap<String, Node> graph = new HashMap<String, Node>(); 
```

您希望在图上运行的大多数算法都可以在此表示上运行良好。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-16T21:14:17.777

您正在寻找的似乎是**TreeNode API**。实际上，swing 包中有一个不错的包，它已经存在于 Java SE 中，默认实现是：[javax.swing.tree.DefaultMutableTreeNode](http://docs.oracle.com/javase/6/docs/api/javax/swing/tree/DefaultMutableTreeNode.html)。它可以在 Swing 应用程序之外使用，并提供非常标准的 TreeNode 模型。

您会找到适合您需要的所有东西：**getChildren** ()、**getParent** ()、**setUserObject** ()... 等等，以及在节点树上爬行和搜​​索的每个递归方法。

好消息是您将获得在几分钟内编写 JTree UI 的能力！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-16T19:13:34.747

您可以编写自己的图形对象或使用[Jung 之](http://jung.sourceforge.net/)类的东西。

# php - 仅使用 CMS 管理内容，但不显示内容

> ID：10180177
> 
> 赞同：3
> 
> 时间：2012-04-16T19:12:32.833
> 
> 标签：php, mysql, content-management-system

我正在开发我的个人网站，并希望在主页中有一个“博客部分”。我只想使用 CMS 来管理内容，而不是使用预先构建的模板在页面中显示它。

我在这里要问的是是否有一个 CSM 提供用于管理内容、添加、更新、删除和主要部分的接口，这是一种使用数据库检索这些信息的简单方法。

我已经用 Wordpress 做过一次，但也许有更合适的方法。

不知道我说清楚了没有，所以，我想用CMS管理内容，但是用我自己的方式展示。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-18T18:42:00.207

你听说过 Mut8。该应用程序管理您的内容，您可以使用其特殊的 css 类进行编辑来构建模板。这个很不错。

[http://mut8.me](http://mut8.me)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-16T19:29:17.627

我没有使用过它，但很久以前我遇到过[Symphony CMS](http://symphony-cms.com/)（不要与 PHP 框架 Symfony 混淆）。Symphony 始终使用 XML，因此一旦您编辑了您的内容，几乎任何东西都可以使用和缓存它。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-04-16T20:29:29.787

您可以使用 Joomla 并构建自己的模板。安装 Joomla 只需不到 5 分钟。试试看 ！

Joomla 模板教程：[来自 NetTuts 的 Joomla 模板教程](http://net.tutsplus.com/tutorials/other/creating-your-first-joomla-template/)

如果您想使用另一种编程语言，可以尝试 Python 和 Django CMS。它可以让您在几分钟内构建一个“定制的”后端。

# asp.net-mvc-3 - IIS7 URL 重写 - 为什么这不起作用？

> ID：10180187
> 
> 赞同：0
> 
> 时间：2012-04-16T19:13:08.637
> 
> 标签：asp.net-mvc-3, iis-7, url-rewriting

我有这个简单的重写，但由于某种原因，我无法弄清楚它为什么不起作用：

```
<system.webServer>
  <rewrite>
    <rules>
      <rule name="men-s-watches" stopProcessing="true">
        <match url="(.*)/men-s-watches(.*)" />
        <action type="Redirect" url="{R:1}/mens-watches" appendQueryString="false" />
      </rule>
    </rules>
  </rewrite>
</system.webServer> 
```

希望有人能指出我的菜鸟错误。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-16T19:45:04.717

通常在 IIS7 中使用 url 重写模块，您可以像这样分配规则。

```
<system.webServer>
  <rewrite>
    <rewriteMaps>
      <rewriteMap name="usr_rule">
    </rewriteMap>
  </rewriteMaps>
  <rules>
    <rule name="men-s-watches">
      <match url="^([0-9]+)/men-s-watches/([0-9]+)" />
      <action type="Rewrite" url="men-s-watches/default.aspx?id={R:1}&amp;p={R:2}" />
    </rule>
    </rules>
   </rewrite>
</system.webServer> 
```

# linux - AWK 将列的总和除以文件中的行数

> ID：10180189
> 
> 赞同：1
> 
> 时间：2012-04-16T19:13:16.430
> 
> 标签：linux, bash, unix, awk

我有一个文件，其中包含如下数据行

```
300,,,292,15.4,0,04/16/12 20:10:39
200,,,292,15.4,0,04/16/12 20:10:39
100,,,292,15.4,0,04/16/12 20:10:39 
```

使用 awk 我总结了这样的第一列

```
awk -F ',' '{ x = x + $1 } END { print x }' MyFile 
```

这就是重调600没问题。

我想修改这个命令来计算文件中的行数，然后`{ print x }`我想要`{ print x / y }`其中 y 是文件中的行数。

所以它会返回 600 / 3 = 200。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-16T19:19:35.077

到目前为止处理的记录数在 NR 中：

```
awk -F, '{ x += $1 } END { print x " " x/NR }' MyFile 
```

所有处理的文件的 NR 计数；在这里，这是一个文件。至少在某些版本中还有 FNR `awk`；计算当前文件中处理的记录数。在此示例中，NR == FNR 始终是因为只有一个文件。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-16T19:20:05.587

您是否尝试过 NR[的记录数](http://en.wikipedia.org/wiki/AWK#Built-in_variables)？

```
awk -F ',' '{ x = x + $1 } END { print x/NR }' MyFile 
```

# c++ - 时间：2019-01-10 标签：c++quicksort排序字符串文本

> ID：10180197
> 
> 赞同：1
> 
> 时间：2012-04-16T19:13:55.273
> 
> 标签：c++, algorithm, quicksort

我正在做作业，并完成了递归快速排序，但是它没有以正确的方式排序。似乎它没有正确交换。

这是我的代码

```
#include<iostream>
#include<ctime>
#include<string>
using namespace std;

int quick_sort_help(string &text,int left, int right, int pivot){

  char val = text[pivot];
  char temp;

  //swap
 // temp =text[pivot];
  //text[pivot]= text[right];
  //text[right]=temp;

  //swap(&text[left],&text[right]);

  int l = left;
  int r = right;

  int i=left;
  while (i<=r)
  {
      while (text[i]<val)
          i++;
      while (text[right]>val)
          r--;
      if (i<=r)
      {
          temp=text[i];
          text[i]=text[r];
          text[r]=temp;
          i++;
          r--;
      }
  }

  return l;
     }

void quicksort(string &text,int left, int right){

      if (left < right){

          int pivot=(left+right)/2;
          int pivottwo = quick_sort_help(text, left, right, pivot);
          quicksort(text, left, pivottwo - 1);
          quicksort(text, pivottwo + 1, right);
          }
 }  
void quick_sort(string &text,int size){
              quicksort(text,0,size);}

int main()
{

    string text="this is a test string text,.,!";
    int size = text.length();
    float t1, t2;
    t1 = clock();
    quick_sort(text,size);

    t2=clock();
    cout<<"quicksort Sort: "<<(t2-t1)/CLK_TCK*1000<<" msec\n"; 
    cout<<text<<endl;

    system("pause");
    return 0;
} 
```

我得到的输出：

```
hi  a e  e,g.nii,r!tssssxttttt 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-16T19:52:34.550

你必须：

1) 不要使用 size 而是 size-1 值

```
void quick_sort(string &text,int size){
          quicksort(text,0,size-1);} 
```

2) Pivot 不是 (left+right)/2 但它是 quick_sort_help 返回的值，pivottwo 不是必需的：

```
void quicksort(string &text,int left, int right)
{
  if (left < right)
  {
      int pivot = quick_sort_help(text, left, right);
      quicksort(text, left, pivot - 1);
      quicksort(text, pivot + 1, right);
  }
} 
```

3）第二次测试我的j值（你的r）并在返回枢轴之前进行交换（i值）：

```
int quick_sort_help(string &text,int left, int right)
{
  char val = text[right];
  char temp;

  int j = right;
  int i = left - 1;

  while (true)
  {
  while (text[++i] < val);

  while (text[--j] > val) {
      if(j == left)
          break;
  }

  if(i >= j)
      break;

  temp=text[i];
  text[i]=text[j];
  text[j]=temp;
 }

 temp=text[i];
 text[i]=text[right];
 text[right]=temp;

 return i;
 } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-16T19:19:25.447

看看这个：[快速排序实现](http://en.wikibooks.org/wiki/Algorithm_Implementation/Sorting/Quicksort)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-16T19:28:56.447

```
 while (text[right]>val)
      r--; 
```

这似乎不太可能。你正在递减`r`，但你测试的条件永远不会改变（应该取决于`r`，可能......）

还

```
return l; 
```

看起来很可疑，因为调用函数似乎期望它是枢轴的新位置，而它是旧的左侧。

另一个，您使用封闭间隔（[看看为什么不应该](https://stackoverflow.com/a/9963438/51831)），这意味着您正在访问越界的字符串（即 UB）。

# javascript - Jquery 绑定似乎失败了

> ID：10180198
> 
> 赞同：0
> 
> 时间：2012-04-16T19:13:58.540
> 
> 标签：javascript, jquery

我目前正在研究一个给我带来很多麻烦的 jQuery 脚本。我不是该框架的专家，但我过去曾在许多场合成功地使用过它。

我正在尝试设置相当于子表单的子表单。即用户正在填写调查问卷，根据用户输入显示附加表单字段，在这种情况下，基于该输入可以显示更多字段。

因此，在这种情况下，我加载了一个脚本，该脚本搜索控制元素并将某些内容绑定到它们的更改事件。这种方法适用于第一个表单字段，但不适用于另一个。内容与 html 的其余部分一起加载，而不是通过 ajax。真正奇怪的部分是，使用调试器并观察控制台我可以看出下面的脚本正在寻找我想要的元素，并尝试调用 change()，但随后事件永远不会触发！

```
$('td.subFormYesControl input.CodebtorParentQuestion').each(function() {
    console.log("Hit");
    //alert($(this).prop('class'));
    $(this).on("change", function() {
        if ($(this).val() == "1") {
            $(this).parents('tbody').eq(0).children('tr.subFormRow').show();
            $(this).parents('tbody').eq(0).siblings('tbody.CodebtorSubForm').show();
        } else {
            $(this).parents('tbody').eq(0).children('tr.subFormRow').hide();
            $(this).parents('tbody').eq(0).siblings('tbody.CodebtorSubForm').hide();
        }
    });
});​ 
```

我一直在做一些试验和错误测试，但运气很少。如果我将它从被包装更改`$(document).ready()`为`$(window).load()`它可以在 FF 中工作，但不能在 IE 中工作。

有谁知道可能发生了什么？？？

编辑：感谢所有帮助！我正在使用的实现中有很多生成的 html，所以这里是我正在尝试使用的控件的父元素。让我知道是否有更多帮助！

```
<td class="subFormYesControl"><input type="radio" value="1" id="c1_CodebtorsParent[0]0" class="CodebtorParentQuestion" name="c1_CodebtorsParent[0]"><label for="c1_CodebtorsParent[0]0">Yes</label><br><input type="radio" checked="checked" value="0" id="c1_CodebtorsParent[0]1" class="CodebtorParentQuestion" name="c1_CodebtorsParent[0]"><label for="c1_CodebtorsParent[0]1">No</label><br></td> 
```

编辑2：它似乎变得更加奇怪，但我想我找到了线索。如果我添加一个简单的警报，如下所示：

```
 alert($(this).prop('class'));
        $('td.subFormYesControl input.CodebtorParentQuestion').each(function() {

    $(this).on("change", function() {
        console.log($(this).length);
                    if($(this).val() == "1") {
                        $(this).parents('tbody').eq(0).children('tr.subFormRow').show();
                        $(this).parents('tbody').eq(0).siblings('tbody.CodebtorSubForm').show();
                    } else {
                        $(this).parents('tbody').eq(0).children('tr.subFormRow').hide();
                        $(this).parents('tbody').eq(0).siblings('tbody.CodebtorSubForm').hide();
                    }                    
            });
        }); 
```

代码似乎有效！删除警报，它停止工作！！！有任何想法吗？？？？

* * *

谢谢大家的帮助。我正在准备 jsfiddle 并删除了一些看似无关的插件。当我删除其中一个智能文本工具时，代码开始在所有浏览器中运行良好。我已经通过测试，甚至能够将代码推回 document.ready，所以我想我会将其标记为已回答并将其归结为插件兼容性问题/错误。

再次感谢大家

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-16T19:24:39.230

如何使用以下内容？

```
$(this).live ("change", function() {
    //...
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-16T19:55:10.230

我已经测试了您的 HTML 示例和 jQuery 代码。有趣的是，您使用了两个无线电输入，这两个输入同时变化，或者其中任何一个随着另一个的变化而切换。很简单，如果您将一个值更改为 1，那么它会自动将另一个值更改为 0

`if ($(this).val() == "1")` 如果一个值更改为 1 而另一个值也更改为 0，那么您也使用过。因此，这两个更改实际上都是先显示然后隐藏，这使得似乎没有触发任何事件。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-16T19:57:18.860

注释掉或删除该`console.log()`行。除非在运行脚本时打开开发人员工具，否则 IE 会卡住它。

# javascript - 使用 KendoUI 折线图，如何在类别上附加多个折线标签？

> ID：10180202
> 
> 赞同：1
> 
> 时间：2012-04-16T19:14:10.700
> 
> 标签：javascript, jquery, asp.net, telerik, kendo-ui

我正在用 KendoUI 替换 DotNet Charting 图表。我需要能够在折线图上放置多线标签。请参见下图，标签上有红色圆圈。任何建议将不胜感激。

查看我当前的图表和我需要更换的 DotNet 购物车：

![](../Images/27ca4767c6811171e7f1c638eb1d18b6.png)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-16T19:41:14.553

简短的回答：你不能。

长答案：你不能，但你在剑道中有一个错误会让你......有点。

Kendo 正在为您的图表动态创建 SVG。SVG 只是 XML，您可以通过 javascript 配置将 XML 注入到元素中。

对于您的标签，您必须使用元素来定位文本。请参阅此元素的 SVG 规范：http: [//www.w3.org/TR/SVG/text.html#TSpanElement](http://www.w3.org/TR/SVG/text.html#TSpanElement)

这里的问题是 Kendo 使用左对齐文本，并且您无法使用此错误更改父元素。这意味着您必须手动偏移所有内容，一次一个像素。如果您的文本是静态的，这可能会起作用；如果它是动态的，我什至不会尝试它。

您*可能*可以通过 JS 一起破解某些东西，并在每次 Kendo 修改 SVG 时动态操作它……但如果您要做那么多工作，您也可以编写一个图表库。

**编辑**：为了您的使用，如果您不必完全镜像旧显示器，最好旋转标签。

# html - 将 1 列变为 2

> ID：10180204
> 
> 赞同：0
> 
> 时间：2012-04-16T19:14:11.327
> 
> 标签：html, css

我遇到了一个问题，我只给了一个里面有大约 10 个 div 的容器 div。我想找到一种方法将这 1 列 div 变成 2 列而不添加额外的 div（即不为左列或右列添加 div）。我可以而且最好是想找到一个 CSS 解决方案。

```
<div class="container">
    <div>1</div>
    <div>2</div>
    <div>3</div>
    <div>4</div>
    <div>5</div>
    <div>6</div>
</div> 
```

理想输出：

```
1      2
3      4
5      6 
```

我试着玩弄漂浮，但效果不太好。请告诉我。谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-16T19:16:53.557

像这样：http: [//jsfiddle.net/Qzj2d/](http://jsfiddle.net/Qzj2d/)？这是最简单的解决方案（不一定是最漂亮的解决方案）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-16T19:17:24.383

将您的内部 div 设置为容器宽度的一半并浮动它们。例如

```
.container { width:600px;}

.container div {
   width:300px;
   float:left;
} 
```

工作示例[http://jsfiddle.net/k2tQG/](http://jsfiddle.net/k2tQG/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-16T19:27:12.733

我认为`display: inline-block`比 更好`float`，因为元素的高度可能会有所不同。但是您需要设置`font-size`为`0`on`.container`然后在元素上将其重置。

[jsfiddle 示例](http://jsfiddle.net/x95QY/)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-16T19:57:07.273

我知道这里已经发布了更合适的解决方案，并且我将提出的提案严重缺乏支持，但是您可以使用新的 ccs3 column-count 和 column-gap 属性将任何 div 分成任意数量的列。

可以在这里看到一个链接：

[http://www.quirksmode.org/css/multicolumn.html](http://www.quirksmode.org/css/multicolumn.html)

对此的支持如此之低，我感到非常失望，因为这些属性将允许真正的“打印样式”布局，如​​果支持，我们不必清除：使我们的父 div 和子 div 正确对齐。我知道我在这里打开了一罐蠕虫，但这是迄今为止最好的选择。

我听到很多人询问列布局，那么为什么哦，为什么我们不能支持使用已经存在的技术......？？抱歉吐槽

# wpf - WPFToolkit Datagrid 未显示列拆分器

> ID：10180205
> 
> 赞同：1
> 
> 时间：2012-04-16T19:14:13.197
> 
> 标签：wpf, datagrid, wpftoolkit

我正在使用 WPF 数据网格。我已将 datagrid 中列的 resize 属性设置为 true。它仍然没有在数据网格的列上显示拆分器图标。

WpfToolkit 版本是 3.5.31016.1

# php - Fancybox 更改网址

> ID：10180210
> 
> 赞同：0
> 
> 时间：2012-04-16T19:14:43.557
> 
> 标签：php, jquery, fancybox

我有一个 pinterest 风格的画廊。我想这样做，所以当您单击图像时，它会打开一个带有更大图像的花式框，然后在框下进行评论和其他内容。但我希望每个图像/图像花式框都有自己的 url，以便人们可以共享链接和内容。关于如何做到这一点的任何想法？

提前致谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-16T19:20:14.213

只需使用 fancybox 作为默认值。当 onComplete 事件被引发时，为 fancybox 容器操作 DOM 和 serach 并添加评论和内容。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-16T19:21:55.967

您可以使用 HTML5 历史记录更改浏览器中的 url。 [https://developer.mozilla.org/en/DOM/Manipulating_the_browser_history](https://developer.mozilla.org/en/DOM/Manipulating_the_browser_history)

然后在整个页面加载时，您可以使用 window.location 获取 url 并修改 DOM 以满足您的需要。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-16T19:23:04.010

有两种方法：
1\. 像 Facebook 那样：[http](http://spoiledmilk.dk/blog/html5-changing-the-browser-url-without-refreshing-page)
://spoiledmilk.dk/blog/html5-changeing-the-browser-url-without-refreshing-page 2\. 像 Twitter 那样：
你可以访问和更改# - 部分网址使用`location.hash`
`//example.com/`
`location.hash = 'foo'; //becomes example.com/#foo`

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-16T19:24:38.543

我会通过创建一个 PHP 脚本来解决这个问题，该脚本接受图像的 id，例如`outputimage.php?id=123`，然后输出图像的 html、注释等。可以使用 jQuery ajax 调用来调用此脚本，该调用从脚本中请求 html，然后将其放置在 fancybox div 中。

另一个调用`image.php?id=`的页面再次接受图像的 id 并用于`outputimage.php`在单独的页面布局中显示 html。该页面将成为您的独立布局。

# bcp - 如何回滚 BCP 导入

> ID：10180211
> 
> 赞同：1
> 
> 时间：2012-04-16T19:14:44.367
> 
> 标签：bcp

我正在尝试使用 BCP 将 100 条记录导入 SQL Server。假设第 51 条记录由于数据错误而失败。当第 51 条记录失败时，我无法回滚之前的 50 条记录。在 BCP 导入过程中出现错误时如何回滚整个导入操作。

谢谢您的帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-16T19:32:15.423

您将无法回滚，因为启用回滚的 SQL 日志记录在使用 BCP 时已关闭。无需日志维护开销即可移动大量数据是 BCP 的主要优势。我不知道您的具体情况，但您可以考虑先将 BCP 导入到临时表中，以确保它成功完成。然后，您可以在失败时删除临时表，有效地回滚事务，或将成功的结果移动到您的永久存储中。

# java - 从 HashMap 中提取值

> ID：10180214
> 
> 赞同：6
> 
> 时间：2012-04-16T19:15:07.347
> 
> 标签：java, iterator, hashmap

我试图从 HashMap 的工作中学习和理解。所以我创建了这个哈希图来存储某些值，这些值在使用迭代器显示时会给我输出为

```
 1=2
 2=3
 3=4 
```

等等。`Iterator.next()`我使用该函数获得的此输出。现在我真正的疑问是，由于这个值的类型是在迭代器对象中返回的，如果我只需要提取上述等式的右侧值，是否有任何功能？类似于子字符串的东西。有什么办法可以让我得到结果

```
 2
 3
 4 
```

任何帮助将不胜感激。提前致谢。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-04-16T19:17:07.677

我会使用类似的东西

```
Map<Integer, Integer> map = new HashMap<>();

for(int value: map.values())
   System.out.println(value); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-16T19:17:34.820

您正在寻找`map.values()`.

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-04-16T19:20:05.997

```
import java.util.HashMap;

public class Test
{
    public static void main( String args[] )
    {
        HashMap < Integer , Integer > map = new HashMap < Integer , Integer >();

        map.put( 1 , 2 );
        map.put( 2 , 3 );
        map.put( 3 , 4 );

        for ( Integer key : map.keySet() )
        {
            System.out.println( map.get( key ) );
        }
    }
} 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-04-16T19:17:58.423

Map 有一个名为 values() 的方法来获取所有值的集合。（右侧）

同样，有一个方法调用 keySet() 来获取所有键的 Set。(左侧)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-04-16T19:18:54.990

您需要[Map#values()](http://docs.oracle.com/javase/6/docs/api/java/util/Map.html#values%28%29)方法，该方法返回一个`Collection`.

然后，您可以`Iterator`以正常方式从该集合中获取一个。

# php - 确定通过 FTP 上传的文件的权限

> ID：10180217
> 
> 赞同：0
> 
> 时间：2012-04-16T19:15:21.330
> 
> 标签：php, ftp

所以我正在处理一些遗留/维护代码，并且有一个使用 FTP 的文件上传，特别是 ftp_login() 和 ftp_put()。

无论如何，每当我上传文件时，它的权限都非常低 - 只有上传的用户才有写权限。我希望所有上传的文件都启用所有权限。

我该怎么办？反正我看不出来。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-16T19:19:45.913

您可以使用[`ftp_chmod`](http://php.net/ftp_chmod)PHP 更改 FTP 服务器上文件的权限。

```
ftp_chmod($conn, 0777, $file); 
```

如果成功，上述行将授予所有人所有权限`$file`。

# java - 如何逐步从大型系统中的遗留问题中恢复？

> ID：10180220
> 
> 赞同：1
> 
> 时间：2012-04-16T19:15:33.653
> 
> 标签：java, dependency-injection, refactoring, legacy-code, code-cleanup

我们的团队已经获得了一个遗留系统，用于进一步的维护和开发。因为这是真正的“遗留”东西，所以测试的数量真的非常少，而且大部分都是废话。这是一个带有 Web 界面的应用程序，因此既有容器管理的组件，也有普通的 Java 类（不绑定到任何框架等），无论何时何地，它们都是“新版”的。

当我们使用这个系统时，每次我们接触给定的部分时，我们都会尝试将所有这些东西分解成更小的部分，发现和重构依赖关系，推送依赖而不是在代码中拉取它们。

我的问题是如何使用这样的系统，打破依赖，使代码更易测试等？何时停止以及如何处理？

让我给你看一个例子：

```
public class BillingSettingsAction {

    private TelSystemConfigurator configurator;
    private OperatorIdDao dao;

    public BillingSettingsAction(String zoneId) {
        configurator = TelSystemConfiguratorFactory.instance().getConfigurator(zoneId);
        dao = IdDaoFactory.getDao();
        ...
    }

    // methods using configurator and dao
} 
```

这个构造函数肯定做的太多了。另外为了测试它以进一步重构它需要使用 PowerMock 等做魔术。我要做的是将其更改为：

```
public BillingSettingsAction(String zone, TelSystemConfigurator configurator, OperatorIdDao dao) {
    this.configurator = configurator;
    this.dao = dao;
    this.zone = zone;
} 
```

或仅使用依赖项的设置器提供构造函数设置区域。

我看到的问题是，如果我在构造函数中提供依赖项，我仍然需要在某个地方提供它们。所以它只是将问题向上移动一个级别。我知道我可以创建工厂来连接所有依赖项，但是触摸应用程序的不同部分会导致每个工厂都有不同的工厂。我显然不能一次重构所有应用程序并在那里引入例如 Spring。

暴露设置器（可能提供了默认实现）是相似的，而且它就像只为测试添加代码。

所以我的问题是你如何处理这个问题？如何使对象之间的依赖关系更好、更易读、更可测试，而无需一次性完成？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-16T21:29:45.587

我最近才开始阅读 Michael Feathers 的“有效使用遗留代码”。这本书基本上是对您的问题的回答。它提供了非常可操作的“块”和技术，以逐步对遗留系统进行测试并逐步改进代码库。

导航可能有点混乱，因为本书通过指向特定技术来引用自己，几乎从第 1 页开始，但我发现到目前为止的内容非常有用。

我不隶属于作者或类似的东西，只是我面临类似的情况，发现这是一个非常有趣的资源。

高温高压

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-16T19:27:05.307

我会尝试建立一个类似于童子军规则的规则：当你触摸一个文件时，你必须对其进行一些改进，除了实现你想要实现的东西。

为了支持你可以

*   同意这样的改进的固定时间预算，例如 2 小时的功能工作，我们允许 1 小时的清理。

*   有可见的指标显示随时间的改进。通常像平均文件大小和测试覆盖率这样简单的事情就足够了

*   列出您至少要针对较大的内容进行更改的内容列表，例如“摆脱 TelSystemConfiguratorFactory”跟踪您已经在工作的任务，并优先处理已经开始的事情而不是新事物。

无论如何，请确保管理层同意您的方法。

在更技术方面：您展示的方法很好。在许多情况下，我会考虑提供所有依赖项的第二个构造函数，但通过带有参数的新构造函数。弃用额外的构造函数。当您接触该类的客户时，请让他们使用新的构造函数。

如果您要使用 Spring（或其他一些 DI 框架），您可以首先通过从 Spring 上下文中获取实例作为中间步骤替换对静态工厂的调用，然后再通过 spring 实际创建它并注入所有依赖项。

# forms - 使用 Nodejs 将 POST 数据发送到带有 GET 参数的页面

> ID：10180238
> 
> 赞同：0
> 
> 时间：2012-04-16T19:17:29.250
> 
> 标签：forms, node.js, post, get

我正在尝试将 POST 数据发送到 test.php 文件，该文件仅在提供特定 GET 数据时才处理 POST 数据。不幸的是，我不知道该怎么做；并且已经搜索了大约一个小时。

任何帮助将不胜感激，因为我目前正在玩很多这些神奇的东西。

提前致谢;

一些澄清：

假设您有一个如下所示的 index.php：

```
<?php

if (isset($_GET['p']))
    echo count($_POST) . ' -- ' . count($_GET);
else echo 'fuuu';

?>
<form action="?p" method="POST">
    <input type="submit" name="lolw" value="Go" />
</form> 
```

如果您提交该表单，PHP`$_GET`和`$_POST`superglobals 都将包含 1 个元素。

现在，让我们尝试通过 nodeJS 运行该表单。

这是我的测试用例（这只是从 doku 中的一些剪切粘贴）：

```
var http = require('http');

var options = {
   hostname: 'localhost',
   port: 80,
   path: '/test.php?lolw=1&p',
   method: 'POST'
};

var req = http.request(options, function(res) {
  console.log('STATUS: ' + res.statusCode);
  console.log('HEADERS: ' + JSON.stringify(res.headers));
  res.setEncoding('utf8');
  res.on('data', function (chunk) {
    console.log('BODY: ' + chunk);
  }).on('error', function (e) {
    console.log('error in chunk');
  });
});

req.on('error', function(e) {
  console.log('problem with request: ' + e.toString());
});

// write data to request body
req.write('data\n');
req.end(); 
```

CLI 输出为正文提供：0 -- 2，然后遵循表单。

我的观点是：是否可以通过 GET 发送*一些*参数，通过 POST 发送一些参数，并指定哪些需要通过 GET 发送，哪些需要通过 POST 发送？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-16T19:24:08.250

要在 node.js 中发出 HTTP 请求，您需要使用[`http.request`](http://nodejs.org/api/http.html#http_http_request_options_callback). 您可以将方法设置为“POST”，并且在您的 URL 中仍然有获取参数。您需要将*Content-Length*标头设置为数据长度，并将*Content-Type*标头设置`application/x-www-form-urlencoded`为“标准” POST 请求。

你的问题很模糊。如果您遇到特定问题，只需显示您的代码并提出更准确的问题。

# visual-studio-2010 - 具有多个时间序列的立方体设计

> ID：10180239
> 
> 赞同：3
> 
> 时间：2012-04-16T19:17:30.877
> 
> 标签：visual-studio-2010, ssas, cube

我正在尝试设计一个多维数据集，该多维数据集将处理具有多个与之关联的时间序列数据的测量数据集。这是在金融合同的背景下。第一个时间序列是 TradeDate，即产品在财务上结算的日期。另一个时间序列是 ContractDate，或合约在未来交易的日期。例如...

TradeDate 合约日期 价格

2005 年 1 月 1 日 2005 年 11 月 1 日 $5.00

2005 年 1 月 2 日 2005 年 12 月 1 日 5.25 美元

2005 年 1 月 3 日 2005 年 12 月 1 日 5.50 美元

TradeDate 和 ContractDate 时间维度均以每日间隔记录。我想设置我的多维数据集，以便我可以跨两个时间维度创建聚合。在示例中（使用上面的数据），我想创建一个由 TradeDate 和 ContractDate 定义的平均值......

TradeDate ContractDate Avg_Price

2005 年 1 月 2005 年 11 月 5.00 美元

2005 年 1 月 2005 年 12 月 5.37 美元

任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-17T08:35:19.260

SSAS 支持角色扮演维度。这意味着一个维度可以多次添加到多维数据集中，每次用于不同的目的。

要使用角色扮演维度，请创建一次日期维度，但在多维数据集的维度使用选项卡中添加两次。为多维数据集维度提供适当的名称（交易日期和合同日期），并将事实和维度表（省略号按钮）之间的关系编辑为模式的正确字段。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-17T23:31:13.367

创建您的时间维度并将其添加到多维数据集两次。立方体和维度可以分开创建。一旦你拥有了这两者，你可以双击你的多维数据集，选择多维数据集结构选项卡，右键单击多维数据集的名称并选择“添加多维数据集维度”。

右侧的选项卡称为维度使用，您可以在其中定义多维数据集如何链接到该特定维度

# c# - 在带有 ASP.NET 回发问题的 JQuery 对话框中加载动态数据

> ID：10180248
> 
> 赞同：2
> 
> 时间：2012-04-16T19:18:26.290
> 
> 标签：c#, jquery, asp.net

我很清楚我遇到的问题之前已经在 SO 上被询问和讨论过，但我已经阅读了无数次，但没有一个真正帮助我解决了我的问题。我正在使用 Visual Studio、ASP.NET 和 C#。

这正是我想要做的：我有一个 JQuery 对话框，里面有一个标签。我也有一个按钮。当按下该按钮时，我想跳入按钮的单击事件并为 JQuery 对话框中的标签设置文本。然后我希望打开对话框，显示带有刚刚在我的按钮的单击处理程序中设置的文本的标签。

这是我的 JQuery 对话框中应该包含的内容（请注意，我已经为这个问题简化了代码）：

```
<div id="dialog" title="Basic dialog">
<asp:Label ID="Label1" runat="server" ></asp:Label>
</div> 
```

在我的页面上，我有一个带有 onClick 事件的 ASP.NET 按钮。在后面的代码中，在我的按钮的单击事件中，我为 Label1 设置了文本。

这是我的按钮：

```
<asp:LinkButton ID="testButton" runat="server" onClick="button_Click" text="click me"/> 
```

这是点击处理程序背后的代码：

```
protected void button_Click(object sender, EventArgs e)
{
    Label1.Text = "Hello";
} 
```

这实际上*有效*，但不是我想要的。

我的问题：由于某种原因，标签的文本仅在我按下按钮的**第二次设置。**这意味着，当我第一次单击按钮时，对话框打开，什么也不显示，然后对话框消失，页面回发。第二次按下按钮时，我看到已为标签设置文本，但随后对话框立即消失，页面回发。

我尝试将以下内容添加到我的按钮中： OnClientClick="return false;" 当我这样做时，回发问题消失了，但现在我的按钮的点击事件不会触发。

我还尝试将以下内容添加到我的脚本中： event.preventDefault(); 这会导致与 return false; 相同的问题，页面不会回发，只是不会跳转到按钮的单击事件。

这是我的对话脚本：

```
<script>
 $(function () {

     $('#dialog').parent().appendTo($("form:first"))

     $("#dialog").dialog(
        {
            autoOpen: false,
            buttons: {
                "Ok": function () {
                    $(this).dialog("close");
                }
            }
                     } 

     );

     $("#testButton")
        .button()
        .click(function openConfirmDialog() {

            $("#dialog").dialog("open")

        });

 });
</script> 
```

基本上我想要做的就是单击一个按钮来设置标签的文本，打开一个对话框，并保持该对话框打开，直到用户关闭它。

我可能会遗漏一些东西，但让我惊讶的是，做一件我想做的简单的事情是多么困难。

亲切的问候，简

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-16T19:37:49.743

当通过单击按钮控件回发页面时，对话框会刷新并关闭。您需要实现一种在页面回发时显示对话框的方法，其中包含数据。

i：第一步在代码后面创建一个变量。例如

```
 protected string PostBackOption =""; 
```

ii：当页面在页面加载或页面预渲染事件中回发时，添加检查以设置对话框选项文本。例如

```
if (Page.IsPostBack)
{
   PostBackOption = "$(\"#dialog\").dialog(\"open\");";
} 
```

iii：现在在javascript中调用这个变量，如下所示。

```
<script>
        $(function () {

            $('#dialog').parent().appendTo($("form:first"))

            $("#dialog").dialog(
                {
                    autoOpen: false,
                    buttons: {
                        "Ok": function () {
                            $(this).dialog("close");
                        }
                    }
                }

             );

                $("#<%= testButton.ClientID %>")
            .button()
            .click(function openConfirmDialog() {

                $("#dialog").dialog("open")

            });
            <%=PostBackOption %>
        }); 
```

现在，当您单击“单击我”按钮时，页面将回发，回发后对话框将不会出现，并且标签将正确填充文本“hello”。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-16T19:51:22.587

我创建了一个简单的例子来决定是否`autoOpen`根据你的 Label 包含一个值。由于页面刷新，对话框消失。如果您想消除整个页面的回发，您可以使用 UpdatePanels，或者您可以执行以下操作：

## HTML 和 jQuery：

```
<!DOCTYPE html>

<html>
<head runat="server">
    <meta charset="utf-8" />
    <title>jQuery Dialog Demo</title>
    <link rel="stylesheet" type="text/css" href="//ajax.aspnetcdn.com/ajax/jquery.ui/1.8.16/themes/cupertino/jquery-ui.css" />
</head>
<body>
    <form runat="server">
        <div id="dialog" title="Basic dialog" style="display: none;">
            <asp:Label ID="Label1" runat="server"></asp:Label>
        </div>
        <asp:LinkButton ID="testButton" runat="server" onClick="button_Click" text="click me"/>
    </form>

    <script type="text/javascript" src="//ajax.aspnetcdn.com/ajax/jquery/jquery-1.7.2.min.js"></script>
    <script type="text/javascript" src="//ajax.aspnetcdn.com/ajax/jquery.ui/1.8.16/jquery-ui.min.js"></script>
    <script type="text/javascript">
        var $labelText = $("#Label1").html().trim(),
            $dialog = $("#dialog").dialog({
                autoOpen: $labelText.length,
                buttons: { "Ok": function () { $(this).dialog("close"); } }
             });

         $("#testButton").button().click(function() { 
            if ($labelText.length) $dialog.dialog("open");
         });
    </script>
</body>
</html> 
```

## C#代码隐藏：

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Web;
using System.Web.UI;
using System.Web.UI.WebControls;

public partial class test6 : System.Web.UI.Page
{
    protected void button_Click(object sender, EventArgs e)
    {
        Label1.Text = "Current time in ticks: " + DateTime.Now.Ticks.ToString();
    }
} 
```

## 输出：

![在此处输入图像描述](../Images/aabd1cdda0f9aaf11018cf5fb404d51a.png)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-16T19:37:27.493

您的标签已添加到表单中，无需将对话框添加到表单中。ASP.Net 只接受放入`<form runat="server">`标签的控件。

# java - 如何获取 java RMI 编程的 Client IP？

> ID：10180251
> 
> 赞同：1
> 
> 时间：2012-04-16T19:18:38.853
> 
> 标签：java, client, ip, rmi

谁能解释我如何获得 Java RMI 编程的客户端 IP，包括如何使用它的示例？

我查过[Java API](http://docs.oracle.com/javase/7/docs/api/java/rmi/server/RemoteServer.html)，但很难理解。

我想在服务器上打印客户端 IP

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-16T22:12:20.080

类中唯一`RemoteServer`需要调用的方法是`getClientHost()`. 这就是你在标题中所问的那个。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-17T07:00:52.387

我找到了解决方案以及你们的意思，谢谢：

我们需要一个 try-catch 来处理 server 的接口实现中的 getClientHost() 函数。

**这是代码：**

```
try{
    System.out.println(getClientHost()); // display message
}catch(Exception e){} 
```

# windows - 如何在远程运行的脚本中询问“主机名”

> ID：10180252
> 
> 赞同：1
> 
> 时间：2012-04-16T19:18:39.847
> 
> 标签：windows, bash, ssh, cygwin

我想让主机 A 在主机 B、C、D 上运行脚本`ssh`。脚本需要知道主机的主机名（是 B、C 还是 D？）。

在主机 A 上执行以下脚本时遇到以下问题：

```
#!/bin/sh
ssh Adam@$1 <<'EOF'
echo 12345`hostname`ABC
EOF 
```

我得到`ABC45myhostB`而不是`12345myhostBABC`for hostname `myhostB`。

主机 A 是 Ubuntu 服务器 10.4 32 位，主机 B、C、D 是从 cygwin 运行 openssh 的 Windows XP。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-16T19:58:26.783

```
uname -a | grep -i cygwin && {
echo 12345${COMPUTERNAME}ABC
} || echo 12345`hostname`ABC 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-16T21:12:18.550

您可能想改用环境变量 HOSTNAME

echo abc${HOSTNAME}def 或类似的东西

# web-services - 调用 Web 服务时如何获取/调试请求消息

> ID：10180253
> 
> 赞同：0
> 
> 时间：2012-04-16T19:18:40.620
> 
> 标签：web-services, c#-4.0, https

我有一个调用 Https Web 服务的应用程序（因为它似乎是用 java 创建的，但不确定）。我收到一个错误作为响应：

```
"Error on verifying message against security policy Error code:1000" 
```

现在我不完全理解错误代码，目前找不到任何负责正确回答我的人。我当然不要求错误，因为这可能与证书、服务器安全等有关。

虽然我想捕捉我发出的请求客户端调用，并查看整个信封消息以与我拥有的几个样本进行比较，这样我可能会捕捉到一些东西。

我该怎么做......我记得有一个工具可以在调试 WCF 服务调用时做这样的事情，这个工具可以在这种情况下使用吗？有人能记住我工具的名称吗:)

我使用 VS 2010 中的 Add Service Reference 创建了客户端，它创建了一些自定义绑定。在这些绑定上，它创建了一个带有属性 decompressionEnabled="true" 的标签，但我删除了，因为 VS 抱怨属性不允许！！！

我为这些服务提供的文档说明了在请求 (requestObject) 中序列化的消息传输对象中的身份验证凭据，但引用了另一对密码和用户名属性，我似乎找不到它们。尝试添加 in client.ClientCredentials.UserName.UserName 和 Password 属性，但我在此处收到只读错误（并不总是很奇怪）。

他们还在有关使用 SOAP 安全扩展 (WS-Security) 连接的规范中提到，如果我作为客户端必须从它的一方做一些事情，我不明白这些是不是应该在生成时提取到配置文件中?

欢迎任何提示和提示。

谢谢你。

# android - 在活动之间发送数据时崩溃

> ID：10180254
> 
> 赞同：0
> 
> 时间：2012-04-16T19:18:48.300
> 
> 标签：android, crash, android-activity

所以，我基本上是在玩弄某种登录表单，并试图在即将到来的活动中用用户名打个招呼。代码编译没有问题，但是当我点击登录按钮时应用程序崩溃，在我尝试实现自定义的 hello 之前登录成功，所以问题必须在以下代码中的某个地方。

这是我称之为活动的地方：

```
Intent k = new Intent(this, MainActivity.class);
            //Sends login name to activity k
            k.putExtra("loginName", login.getText().toString()); 
 //login is the EditText variable name for the login text field
            startActivity(k); 
```

这是我检索额外数据并尝试按照描述使用它的地方：

```
import android.app.Activity;
import android.os.Bundle;
import android.widget.TextView;

public class ProfileActivity extends Activity {

    TextView helloString;

    @Override
    public void onCreate(Bundle savedInstanceState){
        super.onCreate(savedInstanceState);
        setContentView(R.layout.home);
        Bundle extras = getIntent().getExtras();

        //Getting the hello text string
        helloString = (TextView)findViewById(R.id.textHello);
        String loginName = extras.getString("loginName");
        helloString.setText("¡Hello, " + loginName + "!");

    }

} 
```

如果我在这两行中添加评论，它会以某种方式避免崩溃：

```
String loginName = extras.getString("loginName");
helloString.setText("¡Hello, " + loginName + "!"); 
```

不过，我无法确定问题是否真的存在，我认为这可能与第一个活动发送的数据类型与第二个活动中检索到的类型不匹配有关，但仍然没有在尝试了一些东西之后的线索。

提前致谢。

编辑：

我实际上发现我可能与以下事实有关所以我真的不知道我应该如何处理。

编辑2：

所以我终于自己解决了，对于任何感兴趣的人，我只是将数据发送到 MainActivity.class

```
Intent k = new Intent(this, MainActivity.class);

            //Sends login name to activity k
            k.putExtra("loginName", login.getText().toString());
            startActivity(k); 
```

并且，在 Main Activity 内部，当调用 ProfileActivity 将其设置为选项卡时：

```
//Profile tab
            intent = new Intent(this, ProfileActivity.class);
            Bundle extras = getIntent().getExtras();
            intent.putExtra("loginName", extras.getString("loginName"));
            spec = mTabHost.newTabSpec("home")
                    .setIndicator("Home", res.getDrawable(R.drawable.profile_icon))
                    .setContent(intent);
            mTabHost.addTab(spec); 
```

问题解决了，谢谢大家的帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-16T19:26:07.140

您的意图是指 MainACtivity.class，并且您正试图在 ProfileActivity 中获取额外内容。如果您的流程是这样，请尝试将 MainActivity.class 更改为 ProfileActivity.class。请交叉检查您的活动流程。

希望能帮助到你。

```
Intent k = new Intent(this, ProfileActivity.class);
            //Sends login name to activity k
            k.putExtra("loginName", login.getText().toString()); 
 //login is the EditText variable name for the login text field
            startActivity(k); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-16T20:00:24.500

由于您声明您希望将数据发送到 ProfileActivity 但需要打开 MainActivity，您可以遵循 4 种方法之一。

注意：您应该在使用 getExtra 时检查返回的值是否不为空，并相应地处理它。

1.  首先将数据发送到 MainActivity，然后在从 MainActivity 启动 ProfileActivity 时，发送之前传入的数据。
2.  将数据放在 ProfileActivity 的公共静态字段中。公共静态变量可能会导致问题，所以我建议不要这样做。
3.  将数据保存到 sharedPreferences 文件中，并在需要时在 ProfileActivity 中读取它。
4.  子类应用程序，您可以在那里设置/访问许多变量。以下内容是从[是否保证 Activity 类中的静态字段超过创建/销毁周期？](https://stackoverflow.com/questions/1636500/are-static-fields-in-activity-classes-guaranteed-to-outlive-a-create-destroy-cyc)：

    公共类 MyApplication 扩展应用程序{私有字符串事物 = null;

    ```
     public String getThing(){
            return thing;
        }

        public void setThing( String thing ){
            this.thing = thing;
        }
    }

    public class MyActivity extends Activity {
        private MyApplication app;

        public void onCreate(Bundle savedInstanceState) {
            super.onCreate(savedInstanceState);

            app = ((MyApplication)getApplication());

            String thing = app.getThing();
        }
    } 
    ```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-16T20:11:43.003

在 MainActivity 上：

```
String user = this.getIntent().getStringExtra("loginName"); 
```

当您在 MainActivity 上创建 tabhost 时，以相同的方式传递字符串：

```
Intent intent = new Intent().setClass(this, ProfileActivity.class);
intent.putExtra("loginName", user);
intent.addFlags(Intent.FLAG_ACTIVITY_CLEAR_TOP);
// Initialize a TabSpec for each tab and add it to the TabHost
spec = mTabHost.newTabSpec("profile").setIndicator("Profile").setContent(intent);
mTabHost.addTab(spec); 
```

像这样的东西。

但是，如果您需要整个应用程序中的用户名，请使用 Helper Class 来存储用户名。

# java - 如何获取值列表？

> ID：10180256
> 
> 赞同：-1
> 
> 时间：2012-04-16T19:18:53.853
> 
> 标签：java

下面是我想要获取特定管理员编号的名称输出的代码，管理员 Emailid，但我得到的输出是：列表 ---> com.demo.model.Administrator@91e143 与不同的数字，基本上我是java新手。请你在循环迭代中帮助我。

```
package com.demo.action;

import java.util.ArrayList;
import java.util.Iterator;
import java.util.LinkedList;
import java.util.List;

import javax.servlet.http.HttpServletRequest;
import javax.servlet.http.HttpServletResponse;

import org.apache.struts.action.Action;
import org.apache.struts.action.ActionForm;
import org.apache.struts.action.ActionForward;
import org.apache.struts.action.ActionMapping;
import org.apache.struts.actions.DispatchAction;
import org.json.JSONArray;
import org.json.JSONException;
import org.json.JSONObject;

import com.demo.model.Administrator;

import com.demo.model.AdministratorDAO;
import com.demo.model.AdministratorDemo;
import com.demo.model.JQueryDataTableParam;
import com.demo.model.JqueryDatatablesParamUtil;

public class AdministratorAction extends Action {

    public ActionForward execute(ActionMapping mapping, ActionForm form,
            HttpServletRequest request, HttpServletResponse response)
            throws Exception {
        System.out.println("in execute..");
        JQueryDataTableParam param = JqueryDatatablesParamUtil
                .getParam(request);

        String txt2=request.getParameter("txt1");
        //String select2=request.getParameter("select1");
        //request.setAttribute("e", "select2");

        //String select3=request.getParameter("select2");

        //System.out.println("txtValue->"+e);
        //System.out.println("txtValue->"+select2);
        System.out.println("txtValue->"+txt2);
        //String var = Administrator.isValidname(sData);
        String sEcho = param.sEcho;
        int iTotalRecords;
        int iTotalDisplayRecords;
        int start = param.iDisplayStart;
        System.out.println("start" + start);
        int last = param.iDisplayLength +param.iDisplayStart;
        System.out.println("last" + last);
        int sortColumnIndex = param.iSortColumnIndex;
        System.out.println("sortColumnIndex" + sortColumnIndex);
        String sortDirection = param.sSortDirection;
        System.out.println("sortDirection" + sortDirection);

        JSONArray data = new JSONArray();
        iTotalRecords = AdministratorDemo.getAdminCount();
        List<Administrator> Administrators = new LinkedList<Administrator>();
        for (Administrator a : AdministratorDemo.getAdimistrators()) {
            if (a.getAdministrator_nm() != null
                    && a.getAdministrator_nm().toLowerCase()
                            .contains(param.sSearch.toLowerCase())

                    || a.getAdmin_Email_ID() != null
                    && a.getAdmin_Email_ID().toLowerCase()
                            .contains(param.sSearch.toLowerCase())
                    || a.getAdmin_Fax_Phone_Num_Tx() != null
                    && a.getAdmin_Fax_Phone_Num_Tx().toLowerCase()
                            .contains(param.sSearch.toLowerCase())) {
                Administrators.add(a);

            }

        }
        iTotalDisplayRecords = iTotalRecords;

    if (Administrators.size() < param.iDisplayStart + param.iDisplayLength)

                Administrators = Administrators.subList(param.iDisplayLength,
                        Administrators.size());
            else
                Administrators = Administrators.subList(param.iDisplayStart,
                        param.iDisplayStart + param.iDisplayLength);

        System.out.println("End of the operations");

        try {
            JSONObject jsonresponse = new JSONObject();
            jsonresponse.put("sEcho", sEcho);
            jsonresponse.put("iTotalRecords", iTotalRecords);
            jsonresponse.put("iTotalDisplayRecords", iTotalDisplayRecords);
            JSONArray row = new JSONArray();

            for(Iterator<Administrator> i = AdministratorDemo.getAdimistrators().iterator();i.hasNext();)
            {
            System.out.println(i.next());
            }
            jsonresponse.put("aaData", data);
            response.setContentType("application/json");
            response.getWriter().print(jsonresponse.toString());
        } catch (JSONException e1) {
            // TODO Auto-generated catch block
            e1.printStackTrace();
            response.setContentType("text/html");
            response.getWriter().print(e1.getMessage());
        }

        System.out.println("In execute method.");

        return null;

    }

    public String getXMLObject(HttpServletRequest request) {

        return new java.util.Date().toString()
                + " sent by vasu from Date Action";

    }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-16T19:21:41.340

您看到的结果 (com.demo.model.Administrator@91e143) 是 Administrator 对象的默认字符串表示形式，更具体地说，它是`toString()`从继承自的默认方法返回的内容`Object`

要打印有用的信息，`public String toString()`覆盖`Administrator`

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-16T19:24:41.820

你需要在你的类中覆盖[Object#toString() 。](http://docs.oracle.com/javase/6/docs/api/index.html?java/util/Map.html)`Administrator`

此方法可以返回您想要的对象的任何有意义的表示，例如：

```
@Override
public String toString() {
    return "id = " + id + "email = " + email;
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-16T19:23:25.510

您正在制作一个`Administrator`s 列表，您想在其中制作一个`String`s 列表。
或者（可能更好），如果您可以更改`Administrator`类，只需在其中实现`toString`方法，这将返回您想在屏幕上看到的字符串。

# python - 如何搜索特定元素并将其值打印在 Python 的 CSV 文件中

> ID：10180258
> 
> 赞同：0
> 
> 时间：2012-04-16T19:18:59.737
> 
> 标签：python, csv

示例 CSV 文件如下所示：

```
aa  danny  james    
1   3      6    

aa  bla h  mno  
1   3      6    

aa  danny  james    
1   10     15 
```

我想阅读这个 CSV 文件并以下列形式打印输出：

```
line number  james  danny
2            6      3
7            15     10 
```

我尝试使用 re.search 开始查找具有值“Danny”的元素，但结果为错误。

```
import csv, re

file_location=r'D:\\'

spamReader = csv.reader(open(file_location))
for row in spamReader:
    if re.search('Danny', row):
        print(row) 
```

我不确定是否必须使用字典或其他东西来获得所需的输出。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-16T20:47:04.520

这不是一个特别优雅的解决方案，但却是我能想到的最简单的方法。

```
>>> with open('test.test') as f:
...     num_to_scores = {}
...     for linenum, line in enumerate(f):
...         splitline = line.split()
...         if 'danny' in line and 'james' in line:
...             store_next_vals = True
...             dannyloc, jamesloc = splitline.index('danny'), splitline.index('james')
...         else:
...             if store_next_vals:
...                 num_to_scores[linenum] = {"james":splitline[jamesloc], "danny":splitline[dannyloc]}
...                 store_next_vals = False
>>> with open('out.test', 'w') as f:
...     f.write('line number,james,danny\n')
...     for linenum in num_to_scores:
...         f.write('%d,%s,%s\n' % (linenum, num_to_scores[linenum]['james'], num_to_scores[linenum]['danny']))
>>> print open('out.test').read()
line number,james,danny
1,6,3
7,15,10 
```

# excel - Excel中的双重选择功能？

> ID：10180261
> 
> 赞同：0
> 
> 时间：2012-04-16T19:19:13.260
> 
> 标签：excel, function, charts

这就是我想做的。我有 3 组行...每组有 4 行...我想将此数据用于图表。所以我使用了一个 CHOOSE 函数来从其中一个集合中获取值，我可以在其中获取图表数据。现在...我想添加另一个列表来选择行并只看到一条线（在图表中）（而不是 4 条）。有没有办法做到这一点？

所以...我有 3 组，每组 4 行。我想要一个可以选择集合的列表和另一个可以选择集合行的列表。这可以通过 CHOOSE 函数或 Excel 中的任何其他函数实现吗？谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-16T22:11:42.937

会`INDEX`为你工作吗？试试这个版本

`=INDEX((SetOne,SetTwo,SetThree),n,0,m)`

其中 m 是集合数（1、2 或 3），n 是行数（1、2、3 或 4），所以显然这个公式

`=INDEX((SetOne,SetTwo,SetThree),4,0,3)`

将为您提供 SetThree 中的第 4 行

虽然我不确定你是否可以在图表定义中使用“联合”，所以用另一种方式`CHOOSE`in `INDEX`......

`=INDEX(CHOOSE(3,SetOne,SetTwo,SetThree),4,0)`

这也让你从 SetThree 中获得第 4 行......

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-16T19:33:29.037

我可能会制作另一条线，图表从中挑选他的数据。所以...我根据第一个下拉列表选择了 4 行，而图表从中选择的另一行数据在使用第二个下拉列表时会发生变化...

# java - Android 从 RSS xml 提要解析 pubDate 标记

> ID：10180265
> 
> 赞同：1
> 
> 时间：2012-04-16T19:19:28.810
> 
> 标签：java, android, parsing, rss, feed

我在从 RSS 源解析标签时遇到问题。

格式如下：Mon, 16 Apr 2012 16:42:30 +0000

我创建了一个函数**parseDate**来解决这个问题，但事实是它使用 Locale.US 解析日期，它返回日期但使用美国语言环境，因此它返回时间 +2 小时。如果我不提供 Locale.US 参数，我会得到 ParseException。

我怎样才能完成正确的解析，以便提供的日期对于任何本地都是正确的？

这是功能：

```
public String parseDate (String dateraw){
        String returndate;

        try {String format = "EEE, dd MMM yyyy kk:mm:ss Z";
        SimpleDateFormat sdf = new SimpleDateFormat("EEE, dd MMM yyyy kk:mm:ss z",Locale.US);
        Date formatedDate = sdf.parse(dateraw);

        Calendar c= Calendar.getInstance();
        c.setTime(formatedDate);

        returndate=""+c.get(Calendar.DAY_OF_MONTH)+"/"+c.get(Calendar.MONTH)+"/"+c.get(Calendar.YEAR)+" "+c.get(Calendar.HOUR_OF_DAY)+":"+c.get(Calendar.MINUTE);
            return returndate;
        } catch (ParseException e) {
            e.printStackTrace();
            // TODO Auto-generated catch block
            return "NO DATE AVAILABLE";

        }
    } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-21T14:30:34.153

您的代码工作正常。日期被解析并且不依赖于时区。尝试打印您当前的时区或日历时区，看看是否正确：

```
 //...            
        Calendar c = Calendar.getInstance();
        c.setTime(formatedDate);
        Log.i(TAG, c.getTimeZone().getID());
        Log.i(TAG, TimeZone.getDefault().getID());
        //... 
```

# .net - 将 OpenFileDialog.InitialDirectory 设置为 MTP 设备

> ID：10180267
> 
> 赞同：2
> 
> 时间：2012-04-16T19:19:38.057
> 
> 标签：.net, openfiledialog, mtp

我正在编写一个应用程序来从相机中获取图片，并希望打开一个 OpenFileDialog，并将其 InitialDirectory 设置为相机。

这工作正常：

```
openFileDialog.InitialDirectory = "c:\\someFolder\\"; 
```

但这些不会：

```
openFileDialog.InitialDirectory = "CameraName\\";
openFileDialog.InitialDirectory = "My Computer\\CameraName\\"; 
```

我认为这是因为它是一个 MTP 设备，而不是它的“真实目录名称”。有没有办法做到这一点？

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-16T21:03:17.543

据我所知，不可能做到这一点，至少不能使用 .NET IO 操作，因为 MTP 设备不符合基本 I/O 操作（读/写）。

在这里，您必须找到某种方法来强制使用驱动器号映射 MTP 设备存储（曾经有人试图完成此操作，但不确定他从哪里得到），或者只是移除 SD 卡并将其直接连接到 PC。

对不起，我帮不了你太多。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2020-12-21T10:46:03.450

有同样的问题，发现[如何为 mtp 设备构建路径（可在文件夹浏览对话框中使用）？](https://stackoverflow.com/questions/13452798/how-to-construct-path-for-mtp-devices-usable-in-folder-browse-dialog)

当我插入`"{20D04FE0-3AEA-1069-A2D8-08002B30309D}"`（他们说是“我的电脑”）时`InitialDirectory`，它实际上会显示 MTP 文件夹:)

# php - php - array_combine 还是 array_merge？

> ID：10180271
> 
> 赞同：2
> 
> 时间：2012-04-16T19:19:53.143
> 
> 标签：php, array-merge

我确信这对于精通 php 的人来说很容易，但是我犯了一个让我的大脑超负荷的错误，所以现在我真的很困惑是否应该使用 array_combine、array_merge 或其他东西......我一直在谷歌搜索和阅读 php.net 4 小时，我想我只是让自己更加困惑......

本质上，我只想在保留键的同时组合一个数组？

```
//Here are the original arrays
[field_sreference] => Array
    (
        [0] => Array
            (
                [nid] => 28
            )

        [1] => Array
            (
                [nid] => 28
            )

        [2] => Array
            (
                [nid] => 29
            )
    )

[field_idelta] => Array
    (
        [0] => Array
            (
                [value] => 0
            )

        [1] => Array
            (
                [value] => 1
            )

        [2] => Array
            (
                [value] => 0
            )
    )

[field_iswitch] => Array
    (
        [0] => Array
            (
                [value] => 0
            )

        [1] => Array
            (
                [value] => 0
            )

        [2] => Array
            (
                [value] => 0
            )
    )

//Here is what I'm trying to achieve:

[combinedarray] => Array
        (
            [0] => Array
                (
                    [nid] => 28
                    [idelta] => 0
                    [iswitch] => 0

                )

            [1] => Array
                (
                    [nid] => 28
                    [idelta] => 1
                    [iswitch] => 0
                )

            [2] => Array
                (
                    [nid] => 29
                    [idelta] => 0
                    [iswitch] => 0
                )
        ) 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-16T19:26:07.840

您可以通过简单地迭代数组来解决这个 O(n) ......

```
$combinedarray = array();
$len = count($field_sreference);
for ($i = 0; $i < $len; $i++) {
    $combinedarray[] = array("nid" => $field_sreference[$i]['nid'], 
                             "idelta" => $filed_idelta[$i]['value'], 
                             "iswitch" => $field_iswitch[$i]['value']);
} 
```

这假设 3 个数组的长度都相同。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-16T19:44:09.053

有点快速输入，但这应该工作：

```
$result = array();
foreach ($arrays as $array)
{
    foreach ($array as $index => $data)
    {
        $result[$index] += $data;        
    }
} 
```

由于您没有以某种简单的形式提供一些输入数组，因此您需要自己测试它。假设它是伪代码，我把它留在这里作为练习。+ 运算符是[数组联合运算符](http://php.net/manual/en/language.operators.array.php)。

# android - 如何将相机添加为画布背景

> ID：10180273
> 
> 赞同：2
> 
> 时间：2012-04-16T19:20:01.107
> 
> 标签：android, camera, surfaceview

我有一个简单的应用程序，其图形在画布上移动，在表面视图中实现，即不使用 xml 布局。

有没有一种简单的方法可以使用相机预览作为背景？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-16T19:24:13.387

您可以使用**FrameLayout**并首先将您的**surfaceView**作为子项，然后将其他一些没有/透明背景的视图。

**FrameLayout**按添加的顺序绘制其子项。

# regex - emberjs 字段验证正则表达式

> ID：10180278
> 
> 赞同：1
> 
> 时间：2012-04-16T19:20:11.043
> 
> 标签：regex, validation, ember.js

我有一个像这样的自定义 emberjs 字段

```
App.NameTextField = App.FieldView.extend({
ValidationText: '',
IsValid: function(){
    var valText = this.get('ValidationText');
    return valText == '';
}.property(),
Regex: null,
DataView: Ember.TextField.extend({
    nameValue: function(){
        return App.FormContact.get('FirstName');
    }.property(),
    ValidationMessages: {Req: 'this is required. fill it in.', Invalid: 'invalid name', Valid: ''},
    valueBinding: 'nameValue',
    Regex: function(){
        return this.get('parentView').get('Regex');
    }.property(),
    IsRequired: function(){
        return this.get('parentView').get('IsRequired');
    }.property(),
    focusOut: function(){
        var reg = new RegExp(this.get('Regex'));
        var val = this.get('value');
        var validMsg = validateName(this.get('IsRequired'), val, reg);
        this.get('parentView').set('ValidationText', this.ValidationMessages[validMsg]);
    }
}) 
```

});

在前端，我像这样分配正则表达式：

```
 <p>{{view Rewards.NameTextField size="50px" label="First Name" Regex="/^[A-Za-z-'.\s]+$/"}}</p> 
```

这是一个问题，因为当我在 DataView 中执行“this.get('Regex')”时，它的计算结果为

> //^[A-Za-z-'.\s]+$//

导致我的正则表达式评估不正确。那么我如何动态地将正则表达式值分配给模板中的视图？

提前致谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-17T18:03:07.583

我正要建议删除斜线，但您的角色类中也有一个未转义的连字符。这将无法匹配文字`-`字符。如果您希望按字面处理最后一个连字符，则应将正则表达式更改为以下之一：

*   `^[A-Za-z'.\s-]+$`- 最后的连字符
*   `^[-A-Za-z'.\s]+$`- 连字符开头
*   `^[A-Za-z\-'.\s]+$`- 转义的连字符

我在 Stack Overflow 上经常看到这个错误。查看[来自 regular-expressions.info 的这篇文章](http://www.regular-expressions.info/charclass.html)，了解连字符在字符类中的工作原理（请参阅“字符类中的元字符”部分）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-17T17:47:31.497

我在开头和结尾删除了斜线，所以现在它只是`Regex="^[A-Za-z-'.\s]+$"`并且它正在工作！在 App js 中获取正则表达式值时，斜线会导致额外的斜线。结果是

```
<p>{{view Rewards.NameTextField size="50px" label="First Name" Regex="^[A-Za-z-'.\s]+$"}}    </p> 
```

# gwt - RequestFactory 和 @OneToMany 关联

> ID：10180282
> 
> 赞同：0
> 
> 时间：2012-04-16T19:20:28.270
> 
> 标签：gwt, jpa, requestfactory

我被困在这里！任何帮助，将不胜感激。

我的情况是我的模块上有一个@OneToMany 关联。

```
 class Parent{
    @OneToMany(
       mappedBy="parent"
    )
    return List<Child> getChildren();
 }

 class Child{
   @ManyToOne
   return Parent getParent();
 } 
```

在客户端我想得到整个对象图。

我这样做（以 DataGrid 作为显示的 AsyncDataProvider）：

```
 requestContext.getParents().with("children").fire(new Receiver<CallbackProxy>() {
                @Override
                public void onSuccess(CallbackProxy response) {
                    display.setRowData(range.getStart(),response.getParents());
                    updateRowCount(response.getCount().intValue(), true);
                }
            }); 
```

我的 DAO 只是查询整个地图。

```
 Criteria criteria = session.createCriteria(Parent.class);
 criteria.setFetchMode("children", FetchMode.JOIN);
 criteria.setResultTransformer(Criteria.DISTINCT_ROOT_ENTITY);

 /* we got all the map here on the server side */       

 Callback callback = new Callback();
 callback.setCount(count);
 callback.setParents(criteria.list());

 return callback; 
```

但我不能得到孩子。它们的列表为空。请注意我正在使用 with("children")

谢谢你。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-18T06:21:23.973

RequestContext.getParents() 似乎返回 CallbackProxy 但不返回父级。所以 with 子句应该看起来像“parents.childs”。

顺便说一句，为什么不称他们为“孩子”？只是为了这种情况，GWT 家伙有一天会添加一个语法检查器:-)

# asp.net-mvc-3 - MVC3 不在外部程序集中调用控制器

> ID：10180285
> 
> 赞同：1
> 
> 时间：2012-04-16T19:20:51.297
> 
> 标签：asp.net-mvc-3, asp.net-mvc-routing

我正在尝试在单独的程序集中创建一个区域。根据 RouteDebugger，我的路由看起来是正确的，但我收到“路径 {0} 的控制器未找到或未实现 IController”。错误。

我验证了控制器已在我的容器中注册，但在我在路由中指定的不同命名空间下。

路线登记：

```
 routes.MapRoute(
        "EventCalendar", 
        "EventCalendar/{action}/{id}", 
        new { controller = "EventCalendar", action = "Index", id = UrlParameter.Optional }, 
        new[] { "MyAssembly.MyName.Controllers", " MyAssembly.MyName" }
    ); 
```

控制器：

```
namespace MyAssembly.MyName.Controllers
{
    public class EventCalendarController : Controller
    {
        public PartialViewResult Index()
        {
            return new PartialViewResult
            {
                ViewName = "~/Views/EventCalendar/Index.cshtml",
                ViewData = new ViewDataDictionary<object>(this.ViewData.Model)
            };
        }
    }
} 
```

我在路由中指定了控制器的命名空间和父命名空间。我看过的例子并不清楚需要哪一个。OrchardCMS 使用父命名空间。我是否正确注册了路线？

只要控制器在我的容器中，并且命名空间匹配，它就应该解析并被调用，对吗？主组件中的控制器工作正常。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-16T19:45:58.667

你可能想使用依赖注入来做到这一点。我正在开发一个具有类似方法的项目（分离程序集中的一些控制器），我们正在使用 Unity 将控制器注入 MVC 项目。也许[这个](http://msdn.microsoft.com/en-us/vs2010trainingcourse_aspnetmvcdependencyinjection_topic2)网址可能会有所帮助

另外请确保对应的dll在你的MVC项目的bin文件夹下，这样可以解析类型

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-16T19:46:26.323

如果是这样，我实际上会感到惊讶，但是 MapRoute 期望的命名空间数组是字符串类型，而不是对象。

```
new string[] { "MyAssembly.MyName.Controllers", " MyAssembly.MyName" } 
```

# javascript - Jquery 类选择器

> ID：10180287
> 
> 赞同：0
> 
> 时间：2012-04-16T19:20:55.600
> 
> 标签：javascript, jquery

我正在开发一个正在使用的应用程序

```
 $("#plblAgreeProblem",".plblAgreeComment").live("click", function(){
      alert("bil");
} 
```

但类选择器不起作用。我的具有 class="plblAgreeComment" 的 div 正在动态创建，所以我正在使用 .live()

请帮我。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-16T19:23:03.543

问题不是很清楚。对于选择器，请尝试使用以下内容。

```
$("#plblAgreeProblem, .plblAgreeComment").live("click", function(){
      alert("bil");
}); 
```

或者

```
$(".plblAgreeComment").live("click", function(){
      alert("bil");
}); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-16T19:26:23.717

首先，您应该知道`live`在当前的 jQuery 版本中已弃用它，您应该`on`改用它。

也就是说，您的选择器`$("#plblAgreeProblem",".plblAgreeComment")`将搜索`#plblAgreeProblem` `id`带有`plblAgreeComment` `class`. 是你要写的选择器吗？

另一个注意事项，`id`必须是唯一的，这意味着页面中不能有多个具有相同`id`属性的元素。

哦..你忘记了函数`);`的末尾：`live`

```
$("#plblAgreeProblem",".plblAgreeComment").live("click", function(){
      alert("bil");
}); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-16T19:26:46.743

如果您的“plblAgreeComment”类元素位于节点“#plblAgreeProblem”的内部，请尝试使用不同的选择器：

```
 $("#plblAgreeProblem .plblAgreeComment") 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-16T19:27:07.497

如果您使用的是较新的 jQuery 版本，并且包含“.on”，请使用：

```
$(document).on("click", "#plblAgreeProblem, .plblAgreeComment" ,function(){ 
      alert("bil");
 }); 
```

注意：如果可能的话，请尝试绑定到比“文档”更近的东西 - 例如标记该部分的包装器等，以解决速度问题。

其他答案涵盖以前的版本

这是一个包装好的工作示例：http: [//jsfiddle.net/MarkSchultheiss/pP6nL/](http://jsfiddle.net/MarkSchultheiss/pP6nL/)

# java - 自定义 TableModel 中的 NullPointerException

> ID：10180289
> 
> 赞同：0
> 
> 时间：2012-04-16T19:20:59.640
> 
> 标签：java, swing, jtable, nullpointerexception, abstracttablemodel

我为 JTable 编写了一个自定义表模型：

```
class MessageTableModel{

    private static Set<Message> messages = Collections.synchronizedSet(new TreeSet<Message>());

    .
    .
    .

    public void setMessages(List<Message> newMessages) {
        Collections.sort(newMessages);
        Iterator<Message> it = messages.iterator();
        while (it.hasNext()) {
            Message mess = it.next();
            if (!newMessages.contains(mess)) {
                it.remove();
                this.fireTableDataChanged();
            }
        }
        for (Message message : newMessages)
            if (message.isOrderStatusMessage())
                if (!messages.contains(message)) {
                    addMessage(message);
                }
        this.fireTableDataChanged();
    }

    public Message getMessageAtRow(int row){
        return (Message) messages.toArray()[row];
    }
} 
```

问题是有一个更新表值的线程，定期调用 setMessages() 方法。如果我尝试在此更新期间获得一行：

```
Exception in thread "AWT-EventQueue-0" java.lang.ArrayIndexOutOfBoundsException: -1 
```

在这一行：

```
return (Message) messages.toArray()[row]; 
```

有一种方法可以让方法 getMessageAtRow() 等待修改完成，或者这个问题的另一种解决方案？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-16T19:36:59.007

Swing 是单线程的。您不能在事件线程之外的线程上修改模型。解决此问题的最简单方法是：

```
public void setMessages(List<Message> newMessages) {
    SwingUtilities.invokeLater(new Runnable() {
      public void run() {
            Collections.sort(newMessages);
        Iterator<Message> it = messages.iterator();
        while (it.hasNext()) {
            Message mess = it.next();
            if (!newMessages.contains(mess)) {
                it.remove();
                this.fireTableDataChanged();
            }
        }
        for (Message message : newMessages)
            if (message.isOrderStatusMessage())
                if (!messages.contains(message)) {
                    addMessage(message);
                }
        this.fireTableDataChanged();
    }
  )};
} 
```

此外，`fireTableDateChanged()`也应该只在事件线程上调用。

# c++ - 让派生类不继承基类函数

> ID：10180292
> 
> 赞同：0
> 
> 时间：2012-04-16T19:21:04.057
> 
> 标签：c++, inheritance

我不确定这是否甚至是可能的，但它是这样的：派生类是否有可能不继承基类函数（而不使它们成为私有/受保护或覆盖它们的空定义）？就像是：

```
class base{
public:
virtual int f();
virtual int g();
};

class derived1: public base  //<-- this would inherit f() but not g()
class derived2: public base  //<-- this would inherit g() but not f() 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-16T19:23:06.767

不，这不对。即使是这样，这也将是一个设计缺陷。

如果`derived1` **is-a** `base`，为什么不应该继承它的所有成员？这就是继承所代表的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-16T19:24:11.657

将方法标记为虚拟方法的全部意义在于获得继承。我不明白您为什么要将其标记为虚拟但不被继承。那么您要解决的问题是什么？

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-16T19:27:40.893

如果你想做某事，“事”就应该有目的。您正在尝试做的事情通常会破坏虚拟功能和继承的整个想法。没有任何情况可以保证这种类型的构造。

而且由于继承与现实世界如此相关，孩子可以从父母那里选择特征吗？？我猜不是（尽管在这种情况下它可能很有用。:)）

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-16T19:23:41.777

这实际上违背了继承的意义。这是不可能的。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-06-16T01:29:57.077

我只是想谈谈设计概念和可以出现的案例。

我有一个名为 Range 的基类，如下所示：

```
class Range
{
private:
    int max;
    int min;
    int value;

    virtual void SetMax(int);
    virtual void SetMin(int);
public:
    Range(int max, int min);
    virtual void SetValue(int v);
    virtual int  GetValue() const;
    virtual ~Range();
    Range & operator =(int);
    Range & operator =(const Range &);

}; 
```

这个基类用于我们编写的日期和时间类：

```
class Month : public Range
{
public:
    Month();
    Month(int);
    Month(const Month &);
    ~Month();
    Month & operator =(int);
    Month & operator =(const Month &);
    const wchar_t * const AsString() const;
}; 
```

Month 的构造函数之一如下所示：

```
ptiDate::Month::Month(int v):Range(12,1)
{
    SetValue(v);
} 
```

但是到了定义 Day 类的时候，我原本打算创建一个 Day::Range 基类，从中派生 WeekDay 和 MonthDay 类，但觉得这会创建一个混乱的 API。当我尝试同时封装 WeekDay 和 MonthDay 时，我尝试了以下操作：

这是我尝试过的：

```
class Day : public Range
{
private:
    bool LeapDay;
    int  wday;
    int  mday;
public:
    Day();
    Day(int);
    Day(const Day &);
    ~Day();
    Day & operator =(int);
    Day & operator =(const Day &);
    const wchar_t * const WeekDayAsString() const;
    const wchar_t * const MonthDayAsString() const;

    bool isLeapDay() const;
}; 
```

然后是我的困境：由于歧义，我不再想继承 Range SetMax 和 SetMin 方法。IE 我是在设置一周中的最大天数还是一个月中的天数...嗯，一周中的天数是固定的，所以 Day::Range::max 和 Day::Range::min 指的是一个月中的天数和一周中的哪一天刚刚弄清楚....

我会很好奇其他人是如何设计这个的。

引发：

```
Date Today(Month(3), Day(19), Year(2012)); 
```

受 Scott Meyers 启发的想法，Effective C++ (3rd Ed)，第 80 页 [第 18 项]

# rhomobile - Rails 中的 Session 与 rhodes 中的 Session

> ID：10180300
> 
> 赞同：2
> 
> 时间：2012-04-16T19:21:56.620
> 
> 标签：rhomobile, rhodes

在 Rails 中，它很容易存储和检索会话变量。

例如

```
session[:user_id] = @current_user.id 
```

我想知道罗德岛是否也有类似的东西。

就像在 rails 中一样，请求参数可以通过

```
params['name'] 
```

而在罗兹

```
@params['name'] 
```

如果没有像会话变量这样的东西，任何人都可以建议一些解决方法来管理会话。就像使用在多个请求中可用的全局变量一样。

评论/提示，好吗？

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-17T16:37:14.830

我在罗德岛实现了我自己的会话。假设一个 rhodes 应用程序只有一个用户，您不需要检测到您是哪个用户或“会话”，所以您将只有一个会话。我创建了一个名为 的全局哈希，`$session`您可以在其中放置和获取值：

在 application.rb 我把这个：

```
$session ||= {} 
```

我这样使用它：

```
$session[:user] = 'john'

puts $session[:user] 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-30T10:08:41.700

您还可以将持久值作为键/值对数据库存储在 Redis 数据库中。

# android - 使用 Phonegap 发送短信并在收件箱中显示

> ID：10180307
> 
> 赞同：4
> 
> 时间：2012-04-16T19:22:43.670
> 
> 标签：android, cordova, android-intent, phonegap-plugins

[因此，我发现了如何使用https://github.com/phonegap/phonegap-plugins/tree/master/Android/SMSPlugin](https://github.com/phonegap/phonegap-plugins/tree/master/Android/SMSPlugin)以编程方式使用 phonegap 发送短信。

但是，当我使用它发送短信时，如果我转到我的收件箱并且与我发送它的人的对话也很少，它不会在那里显示。有没有办法将它添加到那里的对话中？

谢谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-17T15:33:40.683

好吧，我得到它的工作。下面是我是如何做到的：

这就是我的 sendSMS 现在的样子，它似乎在做我想做的事。

```
 private void sendSMS(String phoneNumber, String message) {
    SmsManager manager = SmsManager.getDefault();

    PendingIntent sentIntent = PendingIntent.getActivity(this.ctx, 0, new Intent(), 0);  
    manager.sendTextMessage(phoneNumber, null, message, sentIntent, null);

    ContentValues values = new ContentValues();
    values.put("address", phoneNumber);
    values.put("body", message);
    this.ctx.getContentResolver().insert(Uri.parse("content://sms/sent"), values);
} 
```

# c# - 当由一组凭据下的计划任务启动的进程在另一组凭据下运行另一个程序时，Windows是否有限制

> ID：10180310
> 
> 赞同：13
> 
> 时间：2012-04-16T19:22:54.403
> 
> 标签：c#, powershell, scheduled-tasks

所以我有一个简单的例子，我有一个应用程序 A，它对用户 X 有一些硬编码的凭据，一个本地管理员，然后它使用硬编码的绝对路径使用这些凭据启动应用程序 B。A 和 B 以及 dotnet 控制台应用程序，但是它们不与控制台交互，只是将信息写入文件。

当我以交互方式运行 A 时（在我的 Creds 下，通过双击，或通过 CMD.exe 或交互式 PowerShell 会话运行良好。成功调用 B

当我通过计划任务运行它时，A 受信任，并使用用户 X 调用 B，Process.Start(mystartinfo) 的错误代码是十六进制的 -1073741502 或 0xC0000142，这意味着“应用程序无法正确初始化”

但是，如果我使用用户 X 凭据运行调用 A 的计划任务，它就可以工作..

我做了这个小测试，主要是因为我在尝试从计划任务或远程处理中尝试在 powershell 中执行“start-job -Credential”时看到类似的行为，或者在 powershell 中调用 start-process 或 System.Diagnostic>Process.Start 从 PowerShell 中在相同的场景中。起初我认为这是 PowerShell 中的一个错误，但它似乎更深。无论是 Windows 还是特别是 Dotnet，我想知道这是否已知/记录在案，以及是否有任何解决方法。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2015-06-22T11:17:00.153

好的，这篇文章已经很老了，但我在同一个问题上运行（通过服务运行时，powershell 启动进程失败，退出代码为 -1073741502）。
显然这与这个问题有关（[为什么这个进程一启动就崩溃？](https://stackoverflow.com/questions/15581142/why-is-this-process-crashing-as-soon-as-it-is-launched/15688675#15688675)）

> Process.Start 在指定凭据时在内部调用 CreateProcessWithLogonW(CPLW)。不能从 Windows 服务环境（如 IIS WCF 服务）调用 CreateProcessWithLogonW。它只能从交互式进程（由通过 CTRL-ALT-DELETE 登录的用户启动的应用程序）调用。

我想当您运行计划任务时它是类似的，它在 Windows 服务环境中运行。
可能会阻止您诱导的 API 本机调用从服务运行。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-09T19:57:01.603

因此，您有一个进程 A，它像您一样从计划任务（非交互式）运行，并以 X（本地管理员）的身份启动进程 B 说明：

*   你是那个盒子的管理员吗？
*   B 是否需要窗口句柄或控制台句柄？

您可以尝试使用 ProcessMonitor 来查看哪个调用完全失败。我的猜测是 B 正在尝试与桌面交互并且被拒绝这样做的权限。

当您以用户 A 的身份登录并使用调度程序启动交互式进程时，窗口会正常显示。但是，如果您以用户 B（例如来宾用户）身份登录并启动以 A 身份（例如本地管理员）运行的交互式进程，那么系统在显示 UI 方面确实存在问题

总而言之，如果您有一个使用未登录用户凭据的交互式流程，那么对于正确的做法没有明确的赢家。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-23T11:13:01.613

我在 Windows Server 2008R2 下遇到过这样的行为。我的 C# 应用程序 (A) 启动了一个进程 B。

进程 B 在无法访问 Windows 桌面的情况下无法运行，[调用 Windows API **CreateWindow() 失败；**] 在作为服务（或通过调度程序）运行时被阻止运行（这是为了防止使用“at /interactive cmd.exe”进行众所周知的用户权限升级）

我建议检查您正在使用的环境并检查它是否是同样的问题。如果是这样，那么您应该搜索如何删除对 CreateWindow() API 调用的引用或正确处理它。

不幸的是，我无法访问流程 B，因此无法成功解决此问题。我最终在 Server 2003 机器上部署了该解决方案。

# java - Java Android：将一个单词（从一个段落）变成一个按钮

> ID：10180312
> 
> 赞同：1
> 
> 时间：2012-04-16T19:23:03.387
> 
> 标签：java, android, button, text, hyperlink

我搜索了一些答案，但空无一物，也许我的问题措辞不正确。

基本上我想要一个超链接，除了它附加了一个 java on click 侦听器，而不是一个 html 链接。我有一些文本段落并且某些单词被突出显示，我希望用户能够单击这些单词并执行一个功能。

任何想法或网站教程？谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-16T19:29:27.600

您应该使用 Linkify 类来实现您想要的。[这是一个完整的教程，可以帮助你](http://android-developers.blogspot.com/2008/03/linkify-your-text.html)

# objective-c - UIScrollView中的滚动方向？

> ID：10180315
> 
> 赞同：0
> 
> 时间：2012-04-16T19:23:04.150
> 
> 标签：objective-c, ios, uiscrollview

如何知道滚动视图何时垂直或水平滚动？我想知道 UIScrollview 的方向。？

请帮忙，

提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-16T19:25:59.957

您应该查看滚动视图的[contentOffset](http://developer.apple.com/library/ios/documentation/UIKit/Reference/UIScrollView_Class/Reference/UIScrollView.html#//apple_ref/occ/instp/UIScrollView/contentOffset)属性。

# ravendb - 尝试通过索引使用集合查询 RavenDB 实体

> ID：10180317
> 
> 赞同：4
> 
> 时间：2012-04-16T19:23:08.560
> 
> 标签：ravendb

我有一个 RavenDB mvc 应用程序，它有一个名为 Member 的文档实体。每个成员文档都有一个被视为管理员的用户列表。只有他们可以查看和管理该会员文档。在其中一个页面上，我进行了会员搜索，并创建了一个索引来协助搜索。

```
public class Members_ByName : AbstractIndexCreationTask<Member>
{
    public Members_ByName()
    {
        Map = members => from member in members select new {member.Title};
        Indexes.Add(x => x.Title, FieldIndexing.Analyzed);
        Sort(x => x.Title, SortOptions.String);
    }
}

public class UserReference
{
    public string Id { get; set; }
    public string Name { get; set; }
}

public class Member
{
    public string Id { get; set; }
    public string Title { get; set; }
    public ICollection<UserReference> Administrators { get; set; }
} 
```

由于当我执行以下操作以获取成员时，用户只能查看/管理他们是管理员的成员文档

```
RavenQueryStatistics stats;
var query = RavenSession.Query<Member, Members_ByName>().Statistics(out stats);
query = query.Where(x => x.Title.StartsWith("anything"));
query = query.Where(x => x.Administrators.Any(y => y.Id == CurrentUser.Id)); 
var list = query.OrderBy(x => x.Title).Paging(CurrentPage, Configuration.DefaultPage, CurrentPageSize).ToList(); 
```

当上面的代码运行时，我得到“字段'Administrators_Id'未编入索引，无法查询未编入索引的字段”，我理解但我试图在索引中获取管理员ID的每件事都没有奏效，不知道如何让它在这一点上工作。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-17T07:58:49.717

试试这个：

```
 Map = members => from member in members
                     select new {member.Title, Administrators_Id = members.Administrators.Select(x=>x.Id)}; 
```

# java - ffmpeg 用于屏幕截图？

> ID：10180323
> 
> 赞同：4
> 
> 时间：2012-04-16T19:23:32.840
> 
> 标签：java, audio, video, applet, mux

所以我有一个小程序，它可以捕获屏幕，并从计算机的麦克风发出声音，然后将屏幕截图编码为 ScreenVideo2，然后将声音编码为 AAC。

我如何使用 ffmpeg 逐帧复用它，然后将复用的输出发送到 wowza 媒体服务器？

如果不能用 ffmpeg 完成，你能提供任何建议吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-16T20:48:16.310

哪个操作系统？在 Linux 下，你可能要考虑[http://kde-apps.org/content/show.php/FDesktopRecorder?content=147844](http://kde-apps.org/content/show.php/FDesktopRecorder?content=147844)

脚本的核心是这样的：

记录屏幕：

```
ffmpeg -f alsa -ac 2 -i pulse -f x11grab -r 30 -s $(xwininfo -root | \
  grep 'geometry' | awk '{print $2;}') -i :0.0 -acodec flac -vcodec libx264 \
  -vpre lossless_ultrafast -threads 0 -y output.mkv 
```

记录一个窗口：

```
#!/bin/sh INFO=$(xwininfo -frame) WIN_GEO=$(echo $INFO | \
  grep -oEe 'geometry [0-9]+x[0-9]+' | \
  grep -oEe '[0-9]+x[0-9]+')WIN_XY=$(echo $INFO | \
  grep -oEe 'Corners:\s+\+[0-9]+\+[0-9]+' | grep -oEe '[0-9]+\+[0-9]+' | \
  sed -e 's/\+/,/' ) ffmpeg -f alsa -ac 2 -i pulse -f x11grab -r 30 \
  -s $WIN_GEO -i :0.0+$WIN_XY -acodec flac -vcodec libx264 \
  -vpre lossless_ultrafast -threads 0 -y output-single.mkv 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-17T14:05:40.190

[Xuggler](http://www.xuggle.com/xuggler/)可以为您做到[这一点](http://wiki.xuggle.com/Encoding_Video_from_a_sequence_of_Images)。我不确定它是否在 Applets 中工作。它能够在后台使用 ffmpeg 对帧进行编码。它现在正在积极开发，并通过其邮件列表获得良好的支持。

# graph - 饼图中的负值

> ID：10180329
> 
> 赞同：4
> 
> 时间：2012-04-16T19:23:58.797
> 
> 标签：graph, charts, visualization, pie-chart

我的应用程序使用各种图表类型可视化数据。饼图可视化的一些数据包括负值。饼图并非旨在显示负面影响。

*   **Excel**输出所有值的绝对值。因此，-20 在饼图中输出为一个占饼图周长 20% 的切片。判断数字是否为负的唯一方法是参考图例。*   **Highcharts**是我们使用的图表引擎，它保留了正面切片完好无损，但以一种非常奇怪和令人困惑的方式呈现了负面切片（[JS Lint 上的示例](http://jsfiddle.net/E4jg7/)）。支持他们尝试渲染底片，但我们的用户感到困惑。*   其他人建议完全**过滤掉负面**因素，因为它们在饼图上没有意义。这会剥离数据并且不能完全代表数据集，因此它可能对我们不起作用。*   并且，其他人建议**使用更合适的图表类型**，例如条形图。

解决这个问题还有其他选择吗？你是怎么做到的？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-16T19:28:36.523

对正值使用绿色阴影。

使用负值的绝对值，然后以红色阴影显示不同的负值。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2016-07-02T10:01:35.743

最近我想到了同样的问题，并制作了这样的粗略样本。
请假设 B 项具有负值。

d3.js的'arc'和'pie'函数使用起来非常方便。

工作样本在[这里](http://hitokun-s.github.io/old/demo/chart/donuts-chart-containing-negative-value.html)。

[![包含负值模式 1 的圆环图](../Images/546523060d239c00dbb1ec9138c558b9.png)](https://i.stack.imgur.com/MaVUR.png)

我还添加了同心圆，像这样。

[![包含负值模式 2 的圆环图](../Images/05585754e4ed7e328de688a959eaf865.png)](https://i.stack.imgur.com/zfehv.png)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-01-30T21:47:32.617

您可以在饼图周围使用圆环图，其中一个表示正值，另一个表示负值。这里的关键是表示 100% 的值对于正负都相同。结果是正面、负面以及整个集合的正面或负面程度的直观表示。

[http://www.highcharts.com/demo/pie-donut](http://www.highcharts.com/demo/pie-donut)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2021-10-19T18:49:03.223

您可以在彼此周围使用两个甜甜圈图。一个代表负值，另一个代表正值（可能通过使用不同的颜色梯度，例如绿色/红色来指示哪个是哪个）。诀窍是根据正值或绝对负值选择每个甜甜圈的半径。如果您有重叠，请调整可视化，使两个甜甜圈之间的边界恰好位于两个绝对值的平均值。

# python - MySQLdb 使用列表作为输入执行吗？

> ID：10180335
> 
> 赞同：4
> 
> 时间：2012-04-16T19:24:17.047
> 
> 标签：python, mysql-python

我想在我的程序中使用 executemany 一次存储 20 条记录，这就是它在文档中所说的......

```
c.executemany(
  """INSERT INTO breakfast (name, spam, eggs, sausage, price)
  VALUES (%s, %s, %s, %s, %s)""",
  [
  ("Spam and Sausage Lover's Plate", 5, 1, 8, 7.95 ),
  ("Not So Much Spam Plate", 3, 2, 0, 3.95 ),
  ("Don't Wany ANY SPAM! Plate", 0, 4, 3, 5.95 )
  ] ) 
```

但是，我在列表中有我的值，并且宁愿不使用列表中的索引来执行上述 18 个版本。

下面是我的代码...

```
db = connect_to_db()
cursor = db.cursor()
sql = "INSERT INTO gkey (keyword, date, time, position) VALUES (%s, %s, %s, %s)"
params = [(str(keywords[0]), date, time, position[0])]
cursor.executemany(sql, params)
db.commit() 
```

这很好用，它会提交列表中的第一个关键字，以及日期、时间和位置，我不想像下面那样重复参数 19 次......

```
db = connect_to_db()
cursor = db.cursor()
sql = "INSERT INTO gkey (keyword, date, time, position) VALUES (%s, %s, %s, %s)"
params = [
(str(keywords[0]), date, time, position[0])
(str(keywords[0]), date, time, position[0])
(str(keywords[0]), date, time, position[0])
(str(keywords[0]), date, time, position[0])
(str(keywords[0]), date, time, position[0])
(str(keywords[0]), date, time, position[0])
(str(keywords[0]), date, time, position[0])
(str(keywords[0]), date, time, position[0])
(str(keywords[0]), date, time, position[0])
(str(keywords[0]), date, time, position[0])
(str(keywords[0]), date, time, position[0])
(str(keywords[0]), date, time, position[0])
(str(keywords[0]), date, time, position[0])
(str(keywords[0]), date, time, position[0])
(str(keywords[0]), date, time, position[0])
(str(keywords[0]), date, time, position[0])
(str(keywords[0]), date, time, position[0])    
(str(keywords[0]), date, time, position[0])
(str(keywords[0]), date, time, position[0])

]
cursor.executemany(sql, params)
db.commit() 
```

以上是我试图避免的一个例子（我知道索引需要增加才能工作！;)）

当我尝试将整个列表作为值传递时出现错误，我需要一次传递一个，有什么想法吗？可以执行很多这样做，还是我应该循环并一次更新它们？但我很确定我试过了，但我得到了类似的错误？不过我没有记下来。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-04-16T19:29:54.113

```
params = [(str(keywords[i]), date, time, position[i]) for i in range(20)] 
```

# android - 错误的 ImageView 尺寸

> ID：10180336
> 
> 赞同：0
> 
> 时间：2012-04-16T19:24:18.500
> 
> 标签：android, layout

# 编辑：部分答案

如果在 xml 中设置了两个维度，则它的行为与预期一样，例如

```
android:layout_width="250dp"
android:layout_height="250dp" 
```

如果将一个留给 wrap_content，则不会。

# 原帖

这是我的布局：

```
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
android:layout_width="wrap_content"
android:layout_height="match_parent"
android:orientation="horizontal" >

<ImageView
android:id="@+id/board"
android:layout_width="wrap_content"
android:layout_height="match_parent"
android:src="@drawable/board" />

</LinearLayout> 
```

为什么我在屏幕上看到的图像具有正确的尺寸（屏幕高度 x 屏幕高度，因为它是一个方形位图并且我将 match_parent 设置为高度），但是如果我调用 ImageView.getWidth() 和 ImageView.getHeight() 它给了我屏幕尺寸？

最好的祝福

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-17T01:21:43.900

发生这种情况是因为我在您之前的问题中提供的原因 [https://stackoverflow.com/a/10183799/1244489](https://stackoverflow.com/a/10183799/1244489)

当您调用 getWidth() 和 getHeight() 时，它会返回 ImageView 的大小，如果您观察到，则在您的情况下是全屏大小。您的源图像已缩小以适应屏幕，保持其纵横比，但 ImageView 没有缩小。要将其缩小到图像大小，您需要提供参数

> 机器人：adjustViewBounds =“真”

在您的 ImageView 中。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-20T11:30:44.707

在这里找到答案： [Fit image into ImageView, keep aspect ratio and then resize ImageView to image dimensions?](https://stackoverflow.com/questions/8232608/fit-image-into-imageview-keep-aspect-ratio-and-then-resize-imageview-to-image-d)

这是问题的根源：ImageView 自身的大小不符合图像尺寸，所以我们必须自己调整大小：

```
LinearLayout.LayoutParams params = (LinearLayout.LayoutParams) imageView.getLayoutParams(); 
params.width = width;
params.height = height;
imageView.setLayoutParams(params); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-16T19:31:02.800

因为`getWidth()`和`getHeight()`是从作为`View`屏幕尺寸的层次结构中调用的。事实上，如果图像是使用`ImageView'`fitCenter 等 s 比例类型缩放的，那么您得到的尺寸将与图像完全不匹配。它们将保留整个视图的像素宽度和像素高度，而不仅仅是图像占用的内容。

# delphi - 德尔福 XE 绝地 3.45

> ID：10180341
> 
> 赞同：0
> 
> 时间：2012-04-16T19:24:49.847
> 
> 标签：delphi, installation, delphi-xe, jedi

我正在尝试更新 Delphi XE 上的 Jedi 安装，但在安装 JCL 2.3 Build 4197 (Jedi 3.45) 时出现错误。

```
jclOtaUtils.pas(1311) Error: E2003 Undeclared identifier: 'ActivePlatformName' 
```

我更新的原因是`jvclHIDController`，当我将它添加到表单并在 Windows 7 64 位上运行它时，我收到一个错误“无效的指针操作”。

我能够在我的 Delphi 2007 上安装 Jedi 3.45，发现使用`jvclHIDController`.

谢谢你的帮助。

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2012-05-09T16:32:05.940

看看 Stefan Glienke 的评论

# c - strcat 导致字符串变为空

> ID：10180343
> 
> 赞同：0
> 
> 时间：2012-04-16T19:24:54.817
> 
> 标签：c, string

我有以下代码，其中 strcat 导致问题。

```
 char* tokens = strtok(buf, "+");
      int n = 0;
      int type = 0;
      char* name = "";
      char* lifetime = "";
      char* data = "";
      for(n=0; tokens!=NULL; n++) {
          if(n==0)
            type = atoi(tokens);
          if(n==1)
            name = tokens;
          if(n == 2) {
             if(type == 1)
                lifetime = tokens;
             else
                data = tokens;
          }
          if(n == 3)
             lifetime = tokens;
          tokens = strtok(NULL, "+");
      }

      if(type == 2) {
         printf("Received Data with Name: %s, Data: \"%s\" and lifetime: %s seconds\n", name, data, lifetime);

         strncat(name, "+", 1);
         printf("Data: %s\n", data);
         strncat(name, data, strlen(data));
         printf("Full Name: %s\n", name);
      } 
```

在我打印名称、数据和生命周期的行中，所有内容都正确打印。但是在 strcat 操作之后，我发现该`data`值是空的。添加调试 printf 语句后，我发现`data`值在`strncat(name,"+",1)`. 可能是什么原因？请帮忙。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-16T19:27:49.037

您必须分配名称和数据

```
strncat(name, "+", 1); 
```

此处未分配名称，您不能将“+”复制到名称，因为没有保留的内存来执行此操作

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-16T19:38:12.573

name 和 data 指针都指向 buf 字符串的某个位置。连接到名称字符串时，您可能碰巧用空字符覆盖了数据字符串。在写入之前，您需要为 name 分配一个新缓冲区：

```
char resultingName[BUFFER_LENGTH];
strcpy(resultingName, name);
strncat(resultingName, "+", 1);
[...] 
```

# python - 为什么 python `any` 返回一个布尔值而不是值？

> ID：10180344
> 
> 赞同：49
> 
> 时间：2012-04-16T19:24:57.877
> 
> 标签：python, function, internal

`and`并`or`返回他们评估的最后一个元素，但为什么 Python 的内置函数不`any`呢？

我的意思是这样实现自己很容易，但我仍然想知道为什么。

```
def any(l):
    for x in l:
        if x:
            return x
    return x 
```

编辑：

要添加到下面的答案，这里是来自同一个邮件列表的实际引用 ye 强大的皇帝在这个问题上：

> 是否始终返回 True 和 False 或第一个失败/传递元素？我在写博客之前也玩过这个，并意识到最终情况（如果序列为空或所有元素都未通过测试）永远无法令人满意地工作：如果参数是布尔值的可迭代，则选择 None 感觉很奇怪，并且如果参数是非布尔对象的可迭代对象，则选择 False 感觉很奇怪。
> 
> Guido van Rossum（主页： http: [//www.python.org/~guido/](http://www.python.org/~guido/)）

* * *

## 回答 #1

> 赞同：48
> 
> 时间：2012-04-16T19:56:51.577

这个问题在 2005 年出现在 Python 开发人员的邮件列表中，当时 Guido Van Rossum 提议将`any`和添加`all`到 Python 2.5。

Bill Janssen[要求](http://mail.python.org/pipermail/python-dev/2005-March/052012.html)将它们实施为

```
def any(S):
    for x in S:
        if x:
            return x
    return S[-1]

def all(S):
    for x in S:
        if not x:
            return x
    return S[-1] 
```

`any`实施and`all`的Raymond Hettinger专门[回应](http://mail.python.org/pipermail/python-dev/2005-March/052015.html)了为什么`any`和`all`不表现得像`and`and `or`：

> 随着时间的推移，我收到了关于这些和其他 itertools 食谱的反馈。没有人反对这些食谱或 Guido 版本中的 True/False 返回值。
> 
> Guido 的版本符合任何/所有作为谓词的正常期望。此外，它避免了人们目前在使用 Python 的“and”和“or”的独特实现时遇到的那种错误/困惑。
> 
> 返回最后一个元素并不邪恶；这很奇怪，出乎意料，而且不明显。克制住把这个变得棘手的冲动。

邮件列表在很大程度上同意了，留下了你今天看到的实现。

* * *

## 回答 #2

> 赞同：22
> 
> 时间：2012-04-16T19:41:07.227

`and`并且`or`可以合理地定义为它们*总是*返回它们的一个操作数。但是，`any`不能`all`明智地将其定义为始终从其输入序列中返回一个值：特别是当列表为空时，它们不能这样做。在这种情况下，两者`any`和`all`当前都有一个明确定义的结果：`any`返回 False 并`all`返回 True。*您有时*会被迫返回一个布尔值，*有时会*从序列中返回一个项目，这会产生令人不快且令人惊讶的界面。简单和一致要好得多。

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2019-04-28T10:18:22.853

开始`Python 3.8`，并引入[赋值表达式（PEP 572）](https://www.python.org/dev/peps/pep-0572/)（`:=`运算符），我们可以交替地显式捕获表达式的*见证*`any`或表达式的*反*例`all`：

* * *

引用[PEP 描述](https://www.python.org/dev/peps/pep-0572/)中的几个例子：

```
if any(len(long_line := line) >= 100 for line in lines):
  print("Extremely long line:", long_line) 
```

```
if all((nonblank := line).strip() == '' for line in lines):
  print("All lines are blank")
else:
  print("First non-blank line:", nonblank) 
```

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2012-04-16T19:37:48.790

[我在 python-ideas 上](http://permalink.gmane.org/gmane.comp.python.ideas/11578)问了同样的问题，并被告知原因是`any()`and`all()`需要在序列为空时返回一个值，并且这些值必须是`False`and `True`。对我来说，这似乎是一个软弱的论据。

这些函数现在不能改变，但我认为如果它们返回他们遇到的第一个真值或假值，它们会更有用，更好地模拟它们概括的`and`和运算符。`or`

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2012-04-16T19:40:07.700

的行为`and`和`or`存在的历史原因。

在 Python 有三元运算/条件表达式之前，`and`如果`or`你想在条件上使用值，你就使用过。任何这样的表达式都可以用条件表达式语法重写：

```
true_val if condition else false_val 
```

本质上，它们重载了两个函数，出于兼容性原因，它们没有被更改。

这*不是*重载其他操作的理由。`any`似乎它应该告诉您*任何 item 的条件是否为真*，它是一个布尔值，所以它应该返回一个`bool`.

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-04-16T19:31:17.437

`Any`返回一个布尔值，因为它在考虑其中任何一个是否为真之前有效地将其参数视为布尔列表。它*正在*返回它评估的元素，但这恰好是一个布尔值。

你想什么时候使用你的版本`any`？如果它在布尔列表中，那么您已经有了正确的答案。否则，您只是在防备`None`，可能会表示为：

```
filter(lambda x: x != None, l)[0] 
```

或者：

```
[x for x in l if x != None][0] 
```

这是一个更清晰的意图陈述。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-04-16T19:34:36.617

`any`' 的值可能是 False 或输入中的值之一并不是很明显。此外，大多数用途看起来像

```
tmp = any(iterable)
if tmp:
   tmp.doSomething()
else:
   raise ValueError('Did not find anything') 
```

那是[在你跳跃之前](http://docs.python.org/glossary.html#term-lbyl)先看一下，因此是不合情理的。相比于：

```
next(i for i in iterable if i).doSomething()
# raises StopIteration if no value is true 
```

`and`和的行为`or`在历史上作为当时不可用的条件表达式的插入项很有用。

# objective-c - 无法为实例变量赋值

> ID：10180350
> 
> 赞同：0
> 
> 时间：2012-04-16T19:25:21.273
> 
> 标签：objective-c, xcode

这是我将一些参数传递给方法，然后将参数值分配给本地 ivars 和属性的情况：

```
- (void) assignOwnerView:(UIView*)oView andPosition:(menuPosition)position withTopView:(UIView*)topView {

    self.topView = topView;
    self.ownerView = oView;
    self.position = position;

    << --- other code --- >>
} 
```

这些属性的接口是这样的（用综合更新）

```
@interface MenuVC (){
    UIView *ownerView_;
    UIView *topView_;
    menuPosition position_;
}

@property (nonatomic, retain) UIView *ownerView;
@property (nonatomic, retain) UIView *topView;
@property (assign) menuPosition position;

@end

@implementation MenuVC
@synthesize list, menuDelegate;
@synthesize ownerView = ownerView_;
@synthesize topView = topView_;
@synthesize position = position_;

- (id)initWithFrame:(CGRect)frame style:(UITableViewStyle)style
{... 
```

枚举在这里定义：

```
typedef enum {
    above,
    below,
    centered
} menuPosition; 
```

执行完这三个赋值后，在调试器的断点处，值如下图：

![在此处输入图像描述](../Images/117b18ec77433f5761fd2611030fbc67.png)

接收到的参数值看起来没问题，但 ivars 的分配值`ownerView_`和`position_`不正确。另一方面，`topView`没关系。

当我直接分配给 ivars 而不是属性时，同样的事情发生了。

当我升级到 Lion (10.7.3) 和 XCode 4.3.1 时，我开始看到这个问题。在那之前它工作正常。我在我的应用程序的其他位置看到了这一点，但我还没有看到任何模式。

没有使用 ARC。

我之前报告过这个问题，但没有得到答案。在这种情况下，问题描述更简单。这可能更容易看出问题所在。

更新——添加了头文件

```
#import <UIKit/UIKit.h>
@class MenuVC;

@protocol menuDelegateProtocol 

typedef enum {
    above,
    below,
    centered
} menuPosition;

- (void) didSelectItemFromMenu:(MenuVC *)menu atIndex:(NSUInteger) index;

@end

@interface MenuVC : UITableViewController {

    NSArray *list;

    float extendedHeight;

    id<menuDelegateProtocol> menuDelegate;

}

@property (nonatomic, retain) NSArray *list;
@property (nonatomic, assign) id<menuDelegateProtocol> menuDelegate;

- (id) initWithFrame:(CGRect)frame style:(UITableViewStyle)style;
- (void) hide;
- (void) unhide;
- (void) assignOwnerView:(UIView*)oView andPosition:(menuPosition)position withTopView:(UIView*)topView;

@end 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-16T19:28:22.940

你没有合成属性。

放：

```
@synthetize ownerView = ownerView_;
@synthetize topView = topView_;
@synthetize position = position_; 
```

在“@implementation MenuVC”之后。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-17T05:44:27.733

我将调试器从 LLDB 更改为 GDB。这似乎是 LLDB 的问题。我现在没有看到这个。

# c++ - VS 2010，移动构造函数仅在 move() 之后到达并且比复制构造函数慢？

> ID：10180357
> 
> 赞同：0
> 
> 时间：2012-04-16T19:25:46.347
> 
> 标签：c++, visual-studio-2010, visual-c++, c++11

试图测试移动语义我构建了一个分配一些内存的简单类：

```
class CTest
{
    private:
        std::size_t size;
        char* buffer;

    public:
        CTest(std::size_t size) : size(size), buffer(nullptr)
        {
            buffer = new char[size];
        }

        ~CTest()
        {
            delete[] buffer;
        }

        CTest(const CTest& other) : size(other.size), buffer(nullptr)
        {
            buffer = new char[size];
        }

        CTest(CTest&& other) : size(other.size), buffer(other.buffer)
        {
            other.buffer = nullptr;
        }
}; 
```

正如您所看到的，它是一个非常简单的类，当它通过 ref 复制时，它会分配新的内存（不会复制其内容，只是为了测试）。而移动构造函数只是使内部指针指向参数数据，没有分配新的内存。

使用带有帮助函数的 windows QueryPerformanceCounter() 对我进行基准测试，例如：

```
template <typename Func>
__int64 Benchmark(Func f, size_t count)
{
    LARGE_INTEGER li = {};
    QueryPerformanceCounter(&li);
    __int64 start = li.QuadPart;

    f(count);

    QueryPerformanceCounter(&li);
    return li.QuadPart - start;
} 
```

非常简单的基准函数，保存开始时间并从结束时间中减去它并返回结果。现在用于测试功能：

```
void Alloc_Ref(size_t count)
{
    CTest t(1024);
    for(size_t i = 0; i < count; ++i)
        CTest c(t);
}

void Alloc_Move(size_t count)
{
    for(size_t i = 0; i < count; ++i)
        CTest c(CTest(1024));
} 
```

Alloc_Ref 使用一个预先初始化的变量，因此它调用复制构造函数，而 Alloc_Move 仅使用一个临时类，因此它调用移动构造函数。

我这样调用测试：

```
cout << "Ref: " << Benchmark(Alloc_Ref, 1000000) << " ms." << endl;
cout << "Move: " << Benchmark(Alloc_Move, 1000000) << " ms." << endl; 
```

问题是，Alloc_Move 没有调用移动构造函数，它继续调用复制构造函数，我缺少什么吗？

同样重要的是，当我在 Alloc_Move 上执行此操作时：`CTest c(move(CTest(1024))`它确实调用了移动构造函数，但它比 Alloc_Ref 慢，还有什么我缺少的吗？

抱歉，这篇长文并提前致谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-16T20:42:37.423

> 问题是，`Alloc_Move`不是调用移动构造函数，而是继续调用复制构造函数，我缺少什么吗？

你的分析不正确。如果您使用的是 Visual C++ 2010 SP1 编译器，`Alloc_Move`则既不调用复制构造函数也不调用移动构造函数。声明和初始化

```
CTest c(CTest(1024)); 
```

被转化为

```
CTest c(1024); 
```

即`c`直接调用构造函数初始化`CTest(std::size_t size)`。不会创建或销毁临时`CTest`对象。

* * *

`Alloc_Move`在我的 Visual Studio 2010 32 位 VM 上，我发现你的和函数之间的性能差异大约为 20% `Alloc_Ref`（后者更快）。我简要浏览了生成的程序集，但没有看到任何明显的差异原因。使用 Visual C++ 11 Beta 编译器（适用于 x86），`Alloc_Move`速度远远超过两倍`Alloc_Ref`（我没有进一步调查，也不知道原因是什么）。

[另请注意，您的测量单位是错误的： `QueryPerformanceCounter`不返回毫秒；它返回滴答声。您需要调用[`QueryPerformanceFrequency`](http://msdn.microsoft.com/en-us/library/windows/desktop/ms644905%28v=vs.85%29.aspx)以获取每秒的滴答数，然后相应地划分您的测量值。]

* * *

## 回答 #2

> 赞同：-2
> 
> 时间：2012-04-16T19:30:25.893

为了利用移动语义，您需要显式使用右值引用。为了与旧代码兼容，编译器永远不会为您隐式转换为右值引用；您需要使用`std::move`或显式转换。

你`Alloc_Move`的速度很可能更慢，因为`CTest(1024)`每次你都在构造一个新的构造`c`，而 as`Alloc_Ref`只构造一个`CTest(1024)`并重用它。

# deployment - 使用 Powershell 部署到 SQL Azure - 有没有办法生成数据丢失警告报告？

> ID：10180359
> 
> 赞同：4
> 
> 时间：2012-04-16T19:25:58.030
> 
> 标签：deployment, powershell, azure-sql-database, data-tier-applications

在部署到 SQL Azure 数据库时，我有一个关于数据层应用程序 (DACPAC) 升级的问题。当我们通过向导 UI 手动升级 DACPAC 时，有一个步骤是我们查看数据丢失警告报告并能够将操作报告保存到 HTML 文件（*请参阅[此处](http://msdn.microsoft.com/en-us/library/ee634742.aspx)的“查看升级计划页面”*）。操作列显示将运行以执行升级的操作，例如 Transact-SQL 语句。如果相关操作可能会删除数据，则数据丢失列将包含警告。

现在，我正在使用 Powershell 自动化数据库升级过程，到目前为止效果很好。不幸的是，**我找不到生成相同数据丢失警告报告的方法**。

我的 Powershell 升级脚本的摘录如下：

```
## Generate the database change list (database drift) and upgrade script and save them to file.
$dacChanges = $dacStore.GetDatabaseChanges($dataTierAppNameToUpgrade) | Out-File -Filepath .\DatabaseChanges.txt

## Getting the DAC incremental upgrade script for data-tier application
$dacStore.GetIncrementalUpgradeScript($dataTierAppNameToUpgrade, $nextDacType) | Out-File -Filepath .\DatabaseUpgrade.sql 
```

生成的`DatabaseChanges.txt`输出文件`GetDatabaseChanges()`并没有提供真正的信息，所以我们想知道是否有一种方法可以获得与手动完成升级向导时获得的报告文件相同的报告文件。在解决数据迁移问题时，此报告对部署团队有很大帮助，我们希望在部署到实时生产数据库时能够手动检查它。

我们搜索了 MSDN 文档，但没有任何运气。有谁知道 Powershell 部署是否支持此功能？是否有计划在不久的将来支持此功能？

提前感谢您的帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-17T08:55:36.210

根据[http://technet.microsoft.com/en-us/library/microsoft.sqlserver.management.dac.dacupgradeoptions.aspx](http://technet.microsoft.com/en-us/library/microsoft.sqlserver.management.dac.dacupgradeoptions.aspx)，默认情况下 IgnoreDataLoss 为 false，这意味着如果检测到数据丢失，升级将失败。在 .NET 中，您可以处理 DacActionFinished 事件 (http://technet.microsoft.com/en-us/library/microsoft.sqlserver.management.dac.dacstore.dacactionfinished.aspx)，该事件将在升级操作完成时触发. 如果出现问题，事件 arg 的错误属性 (http://technet.microsoft.com/en-us/library/microsoft.sqlserver.management.dac.dacactioneventargs.error.aspx) 将包含详细的异常。它可能不是您想要的 html 报告，但它仍会为您提供一些信息。您可以从 PowerShell 处理 CLR 事件。请参阅[http://blogs.msdn.com/b/powershell/archive/2008/05/24/wpf-powershell-part-3-handling-events.aspx](http://blogs.msdn.com/b/powershell/archive/2008/05/24/wpf-powershell-part-3-handling-events.aspx)示例。

顺便说一句，实际上这个问题不仅特定于 SQL Azure。您还可以将标记修改为 SQL Server 以获得进一步的建议。

最好的祝福，

明旭。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-19T20:40:11.160

刚刚与 DAC @ Microsoft 的所有者取得联系，这是他建议的解决方案：可以使用他们的托管 API 或通过**SqlPackage.exe**。

**SqlPackage.exe 对其**进行了操作以生成部署报告。如果检测到可能的数据丢失问题，它将包含在报告中。

参考： http: [//msdn.microsoft.com/en-us/library/hh550080 (v=VS.103).aspx](http://msdn.microsoft.com/en-us/library/hh550080(v=VS.103).aspx)

# grep - grep 中有没有办法找出与 grep 结果匹配的行数？

> ID：10180362
> 
> 赞同：1
> 
> 时间：2012-04-16T19:26:06.367
> 
> 标签：grep

假设我编写了一个`grep`查询来找出对象上的方法调用的发生情况，如下所示：

```
 // might not be accurate, but irrelevant
 grep -nr "[[:alnum:]]\.[[:alnum:]](.*)" . 
```

这会产生很多结果。如何找出获得了多少这样的结果？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-04-16T19:28:49.057

用`| wc -l`它来计算结果行的数量怎么样？

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-16T19:41:02.020

关于什么

```
man grep | grep "count" 
```

它输出

```
-c, --count
  Suppress normal output; instead print a count of  matching  lines  for  each  input  file. [...] 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2018-10-17T15:02:50.393

以前的答案还可以，我只想将其放入命令行指令中，以便将来拥有复制粘贴版本（从显式到最简单）：

```
grep --count  "PATTERN" FILE 
```

与以下内容完全相同：

```
grep -c  "PATTERN" FILE 
```

它相当于：

```
grep "PATTERN" FILE | wc -l 
```

作为奖励，下面我给你一个版本，其中使用了带有模式列表的文件。

```
grep -count --file=PATTERNFILE FILE 
```

或者干脆

```
grep -cf PATTERNFILE FILE 
```

# c# - 视图模型和视图中直接提到的实体是否可以接受？

> ID：10180369
> 
> 赞同：0
> 
> 时间：2012-04-16T19:26:36.717
> 
> 标签：c#, asp.net, asp.net-mvc-3, entity-framework, domain-driven-design

我正在开发一个多层的，使用 ASP.NET MVC 3 和实体框架。我有一个名为“站点”的实体，它属于域层。在域实体视图模型和视图中直接提及是否可以接受？

视图模型

```
public IList <Domain.Entities.Site> Sites; 
```

看法

```
foreach (var item in Model.Sites)
{
...
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-16T19:28:03.903

通常不会。ViewModel 的重点是仅从模型中抽象出所需的信息。

您应该有一个也对应于站点模型的 ViewModel。

所以你会有：

```
// assuming the Domain model is what we're talking about
public class DomainViewModel
{
    public IList<SiteViewModel> Sites { get; set; }
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-16T19:40:10.160

我认为在您的视图中引用域实体是完全可以接受的。如果您不需要为视图转换域实体中的任何信息，那么使用 ViewModel 将其抽象出来是多余的。

您可能会发现在这个主题上有不同的意见，但真正归结为抽象出领域实体是否会增加任何价值。创建一个 ViewModel 将增加一些未来的灵活性，也许对你来说这足以证明它的合理性。如果是这种情况，那么一定要这样做。但是不要觉得你必须出于对违反 MVC 的恐惧。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-16T19:42:26.997

直接绑定到模型是一种短期解决方案。最好让视图模型包装您的模型，以防您需要绑定到与模型不直接相关的其他属性。即 bool CanDelete，bool IsEnabled...

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-16T19:52:02.090

一般来说，没有。

如果这是一个 QUICK 和 BASIC 应用程序，那么肯定是不情愿的。

除此以外的任何事情，您都在为自己开枪，而普遍接受的模式是使用 ViewModels 来保存您需要的所有数据（包括 SelectList 数据等，而不是使用 ViewBag。

顺便说一句，在 ViewBag 上，也请避免： [http ://completedevelopment.blogspot.com/2011/12/stop-using-viewbag-in-most-places.html](http://completedevelopment.blogspot.com/2011/12/stop-using-viewbag-in-most-places.html)

# ios - iOS：从音频文件中获取原始 PCM 数据

> ID：10180370
> 
> 赞同：0
> 
> 时间：2012-04-16T19:26:41.070
> 
> 标签：ios, file, audio, core-audio, reverse

我正在调查一个简单的任务：

*   从 iPhone 的“iPod 音频库”打开一个音频文件
*   允许用户通过设置两个标记来选择一个块：开始时间和结束时间
*   时间反转这个块
*   将其另存为新文件

我有哪些选择？

我将列出几个小时的研究结果：（原谅乱七八糟，一旦我弄清楚了，我会一如既往地整理pu）

*   [http://lists.apple.com/archives/coreaudio-api/2005/May/msg00096.html](http://lists.apple.com/archives/coreaudio-api/2005/May/msg00096.html) <-- *'我目前正在尝试创建一个使用 AUAudioFilePlayer AudioUnit 插件播放音频的程序，该插件将音频流式传输到输出音频单元'*

*   AU文件播放器

*   [http://lists.apple.com/archives/coreaudio-api/2008/Dec/msg00156.html](http://lists.apple.com/archives/coreaudio-api/2008/Dec/msg00156.html)

*   [http://zerokidz.com/audiograph/docs/audiograph.pdf](http://zerokidz.com/audiograph/docs/audiograph.pdf) <--这可能链接到执行它的代码，但它说它处于测试阶段

*   [使用 ExtAudioFile 读取音频文件时，是否可以不连续读取音频浮点数？](https://stackoverflow.com/questions/6902730/when-reading-audio-file-with-extaudiofile-read-is-it-possible-to-read-audio-flo)<-- 这会导致一个 OS X 项目将音频文件从磁盘读取到内存中；查看代码会导致我们：

*   [https://developer.apple.com/library/mac/#documentation/MusicAudio/Reference/ExtendedAudioFileServicesReference/Reference/reference.html](https://developer.apple.com/library/mac/#documentation/MusicAudio/Reference/ExtendedAudioFileServicesReference/Reference/reference.html)

    据我所知，audio Graph 项目试图从文件中实时传输音频，而 Stephan 的项目只是公开音频；但是看起来他正在使用过时的 API 调用。

    这看起来像正确的代码（除了它似乎有一个错误）：[https ://stackoverflow.com/questions/8533143/decoding-mp3-files-by-extaudiofileopenurl](https://stackoverflow.com/questions/8533143/decoding-mp3-files-by-extaudiofileopenurl)

[http://cocoadev.com/forums/discussion/499/core-audio/p1](http://cocoadev.com/forums/discussion/499/core-audio/p1)

[https://developer.apple.com/library/ios/#samplecode/iPhoneExtAudioFileConvertTest/Introduction/Intro.html](https://developer.apple.com/library/ios/#samplecode/iPhoneExtAudioFileConvertTest/Introduction/Intro.html) <--这是一个官方的Apple示例项目，可能会被修改以获得我想要的东西

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-16T22:28:26.530

我相信你可以像你说的那样使用 IphoneExtAudioFileConvertTest 来得到你需要的东西，在用户标记他想要的时间之后，你要做的第一件事就是转换为 PCM，接下来你需要找出哪些数据包是你需要的，写到音频文件，然后重新压缩...我在[这里](https://stackoverflow.com/questions/7375309/audioqueue-how-to-find-out-playback-length-of-queued-data)写了一个关于如何从音频文件中获取 x 秒数的答案，我只用 mp3 和 m4a 对其进行了测试，但它可以适应 PCM（pcm 应该更容易做，因为它是线性的）。

丹尼尔

# r - 奇怪的“提供给 scale_x_continuous 错误的非连续变量”

> ID：10180373
> 
> 赞同：4
> 
> 时间：2012-04-16T19:27:02.633
> 
> 标签：r, ggplot2, visualization, time-series

我有一个有趣的难题。我可以以交互方式创建我寻找的图表类型，但不能自动创建。或者，我几乎自动拥有它，但有些东西坏了。（帖子末尾的示例数据）。

我的循环按照我想要的方式工作，但是当我添加一些 geom_vline() 语句时遇到了错误（对我们来说，表示我们的生产环境发生了重大变化）。我已经尝试在循环之外解决它，并且能够使用以下详细信息重新创建问题。

我有以下步骤：

*   创建一个包含更改列表的向量：

`changeVector <- c(as.Date("2011-11-30"),as.Date("2011-12-05"))`

*   [WORKS] 使用以下数据创建一个绘图，它可以工作：

`ggplot(df,aes(x=OBSDATE,y=AVG_RESP))+geom_line(aes(group=REGION,color=REGION))`

*   [WORKS] 尝试添加 geom_vline(xintercept=c(15308,15313))，它可以工作（但前提*是*geom_vline 在末尾）：

`ggplot(df,aes(x=OBSDATE,y=AVG_RESP))+geom_line(aes(group=REGION,color=REGION))+geom_vline(xintercept=c(15308,15313))`

*   [失败] 尝试添加 geom_vline(xintercept=changeVector) - 由于某种原因我遇到了问题，必须添加 as.numeric 才能正确识别向量值：

`ggplot(df,aes(x=OBSDATE,y=AVG_RESP))+geom_vline(xintercept=as.numeric(changeVector))+geom_line(aes(group=REGION,color=REGION))`

当这一步运行时，我会收到非常有用的错误消息： `Error: Non-continuous variable supplied to scale_x_continuous.`

那么，有什么想法吗？如果我尝试向 geom_vline 添加美学组件，我仍然没有任何进展。我的愿望是让 geom_vline 在 geom_line 之前，因为 vline 是上下文，而不是数据。

谢谢您的帮助！

这是数据的子集（数据文件名 df）：

```
OBSDATE REGION COUNT AVG_RESP
2011-11-29     EMEA   293 4.430375
2011-11-30     EMEA   299 4.802876
2011-12-01     EMEA   292 4.362363
2011-12-02     EMEA   293 4.209829
2011-12-03     EMEA   294 4.262959
2011-12-04     EMEA   294 4.207959
2011-12-05     EMEA   293 4.172594
2011-12-06     EMEA   293 4.230887
2011-12-07     EMEA   298 4.259329
2011-12-08     EMEA   293 4.197645
2011-11-29 Americas   296 2.841182
2011-11-30 Americas   296 2.932196
2011-12-01 Americas   292 2.766438
2011-12-02 Americas   293 2.819556
2011-12-03 Americas   291 2.710584
2011-12-04 Americas   295 2.728407
2011-12-05 Americas   290 2.764310
2011-12-06 Americas   290 2.817483
2011-12-07 Americas   295 2.733864
2011-12-08 Americas   291 2.732405
2011-11-29     APAC   328 7.294024
2011-11-30     APAC   325 7.091046
2011-12-01     APAC   314 6.969236
2011-12-02     APAC   327 6.920428
2011-12-03     APAC   325 7.226308
2011-12-04     APAC   324 7.046296
2011-12-05     APAC   318 7.075094
2011-12-06     APAC   317 7.016467
2011-12-07     APAC   318 7.187358
2011-12-08     APAC   318 7.310220 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-16T20:04:26.530

我不确定为什么要这样做，但这里有一个解决方法，可以将垂直线保持在数据线后面：

```
ggplot(df,aes(x=OBSDATE,y=AVG_RESP)) + 
  geom_blank() +
  geom_vline(xintercept=as.numeric(changeVector)) + 
  geom_line(aes(group=REGION,color=REGION)) 
```

编辑：

这是另一种解决方法：明确指定 x 轴是日期，而不是让 ggplot 猜测。当它猜测时，它会查看绘制的第一层，即垂直线。鉴于`xintercept`必须以数字而不是日期的形式给出，x 轴被假定为连续/数字。绘制下一层时，无法将 x 轴的日期映射到该层上，并引发错误。

```
ggplot(df,aes(x=OBSDATE,y=AVG_RESP)) + 
  geom_vline(xintercept=as.numeric(changeVector)) + 
  geom_line(aes(group=REGION,color=REGION)) +
  scale_x_date() 
```

# ios - 带有浮动单元格的 UITableView

> ID：10180378
> 
> 赞同：2
> 
> 时间：2012-04-16T19:27:10.503
> 
> 标签：ios, layout, uitableview, position

我正在为 iOS 应用程序开发一种特定类型的列表，其中单元格将简单地具有特定的宽度和高度，然后向左浮动（想想 CSS 之类的东西`float:left`），然后创建一个列表，如果超过 12 个项目（比如下图）。

[![](../Images/2c83ee7bbe3052a9c1072da9b195d43b.png)](https://i.stack.imgur.com/Ig0qk.png)

我在想也许这可以通过自定义 UITableViewCell 并设置框架的宽度和高度来完成，这样我就可以重用 UITableViewController、delegate 和 dataSource 提供的各种好处。但不幸的是，这似乎是不可能的。所以，我现在只是创建了许多 UIViews 并以编程方式将它们定位在其父级中。

我只是想确保这将是实现此类列表的正确方法，如果有人可以让我知道是否确实不可能在 UITableView 上拥有这种功能并继承它提供的所有优点。

多谢你们

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-06T14:12:23.550

我知道这个问题已经回答了，但仍然......

我相信您可以从 iOS 6.0 开始简单地使用 UICollectionView。

[文档](http://developer.apple.com/library/ios/#documentation/uikit/reference/UICollectionView_class/Reference/Reference.html)

这就是它的样子（[图片](http://www.howzhi.com/files/course/2013/02/01/1015451b622c889967.jpeg)）

也许这会对某人有所帮助。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-16T19:45:28.883

UITableView 只能有一个方向的单元格。如果数量合理，创建许多 UIView（表格视图单元格也是 UIView）是完全可以的。您通常可以在滚动视图中拥有几百个 UIView，而不会看到任何性能问题，但这也取决于 uiview 内部内容的复杂性。自己尝试一下，如果发现需要太多 uiview，或者它们的复杂性太高，可以进一步优化。您可以将该`.layer.shouldRasterize`属性设置为“缓存”视图的内容。或者您可以使用 CATiledLayer，它类似于 UITableView，但它支持各个方向的*图块*（以及滚动、缩放……）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-16T19:50:40.493

看看这个项目，我认为可能对您的问题有所帮助

[关联](https://github.com/provideal/MMGridView)

# jquery - 特殊字符未在 db jQuery Ajax POST 中正确注册

> ID：10180382
> 
> 赞同：1
> 
> 时间：2012-04-16T19:27:18.287
> 
> 标签：jquery, ajax, forms, jquery-mobile, special-characters

我正在制作一个 phonegap (1.4.1) Jquery Mobile (JQM 1.1 Jq 1.7.1) 应用程序，其主要功能是通过 Ajax 提交表单，但通过应用程序发送的特殊字符（此处为 ä ö ö）不会注册在数据库中正确。

注意：我无法控制接收端的服务器/脚本，因此解决方案不能基于对服务器进行更改。有一个基于 Web 的非 ajax 表单可以正确注册特殊字符。

```
var dataString = $("#klinikkurt").serialize();
$.ajax({
    type: "POST",
    url: "http://doit.medfarm.uu.se/script/kurt2/receive.php",
    data: dataString,
    timeout: 20000,
    datatype: "html",
    contentType: "application/x-www-form-urlencoded;charset=ISO-8859-1",
    success: ...
 }); 
```

我已经尝试过 ISO-8859-1 和 UTF-8 并且我也尝试过添加

```
dataString = encodeURIComponent(dataString) 
```

和

```
dataString = escape(dataString) 
```

我已经尝试了所有我还没有遇到的解决方案。但可惜没有雪茄。

更新：ÅÄÖåäö 注册为 Ã_Ã_Ã_Ã¥Ã¤Ã¶

# c - 掷骰子直方图

> ID：10180383
> 
> 赞同：0
> 
> 时间：2012-04-16T19:27:18.450
> 
> 标签：c, generator, histogram, dice

您好，我已经编写了基于 rand() 和 time.h 的骰子滚动生成器所需的代码。它基本上要求用户输入他希望掷骰子的次数，然后掷 X 次。它保存了 1-6 个数字中的每个数字在一个数组中滚动的次数以及每个数字在另一个数组中的百分比。

现在我想做的是创建一个直方图，其中有数字 1-6 和 - 在 X 轴上，百分比和 | 在 Y 轴上，星号 (*) 用于列。

像这样的东西：

```
10% | *
 8% |* * *
 6% |* * * * *
 4% |* * * * * *
 2% |* * * * * *
    +------------
     1 2 3 4 5 6 
```

我已经通过谷歌搜索以找到开始的东西，但我真的找到了与我的案例类似的任何东西，这将帮助我开始。

因此，我的代码是：

```
#include <stdio.h>
#include <stdlib.h>
#include <time.h>

int random_number();
float calc_percentage(int totals, int nums);
float calc_maxper(float perc[6]);
float calc_minper(float perc[6]);
float permin;
float permax;

int main(void)
{
  int nums;
  int i;
  int totals[6] = {0};
  float percentages[6] = {0};

  srand(time(NULL));

  printf("How many numbers to generate?");
  scanf("%d", &nums);

  for (i = 1; i <= nums; i++)
  {
    int x = random_number();
    totals[x-1]++;
  }

  for (i = 0; i<6; i++)
  {
    percentages[i] = calc_percentage(totals[i],nums);
    printf("The percentage of each number is: %.2f%\n", percentages[i]);
  }

  permin = calc_minper(percentages);
  permax = calc_maxper(percentages);

  if (((permax) - (permin)) > 5)
    printf("The generator is not good.\n");
  printf("The percentage difference is:%.1f\n", permax-permin);

  system("pause");
  return 0;
}

int random_number()
{
  int randnum;
  randnum = 1 + (rand() % 6);

  return randnum;
}

float calc_percentage(int totals, int numbers)
{
  float a;

  a = (totals * 100)/numbers;

  return a;
}

float calc_minper(float perc[6])
{
  int i;
  float min;
  min = perc[0];

  for (i=1; i<6; i++)
  {
    if (perc[i] < min)
      min = perc[i];
  }
  return min;
}

float calc_maxper(float perc[6])
{
  int i;
  float max;
  max = perc[0];

  for (i=1; i<6; i++)
  {
    if (perc[i] > max)
      max = perc[i];
  }
  return max;
} 
```

好的，我终于完成了。

有点长和凌乱，但它绝对可以完成工作！

```
printf("20%|");
for (i=0; i<6; i++)
{
    if (percentages[i] >= 20)
       printf("* ");
}
printf("\n");

printf("16%|");
for (i=0; i<6; i++)
{
    if (percentages[i] >= 16)
       printf("* ");
}  
printf("\n");

printf("12%|");
for (i=0; i<6; i++)
{
    if (percentages[i] >= 12)
       printf("* ");
}  
printf("\n");

printf(" 8%|");
for (i=0; i<6; i++)
{
    if (percentages[i] >= 8)
       printf("* ");
}  
printf("\n");

printf(" 4%|");
for (i=0; i<6; i++)
{
    if (percentages[i] >= 4)
       printf("* ");
}  

printf("\n");
printf("  +------------\n");   
printf("   1 2 3 4 5 6\n"); 
```

谢谢老哥你的想法！！如果你有任何快速的想法让它更短，我会全力以赴！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-16T19:47:53.333

对于每个范围（10%、8% 等），检查当前骰子数量 (1-6) 的百分比是否超过它，然后打印一个 *（如果不符合最小范围，则打印一个空格）。最后，打印图基。

您可以使用 for 来处理范围：

```
float range;
float interval = (permax-permin)/(NUM_INTERVALS-1);
for (range = permax; range >= permin - EPSILON; range -= interval){
    int i;
    printf("%2.2f%% | ", range);
    for(i=0; i<6; i++){
        char *out = percentages[i] >= range ? "*" : " ";
        printf("%s ", out);
    }
    printf("\n");
}
printf("      | 1 2 3 4 5 6\n"); 
```

# c# - LINQ Union 和 Distinct

> ID：10180386
> 
> 赞同：2
> 
> 时间：2012-04-16T19:27:34.770
> 
> 标签：c#, linq, union, distinct

我有一个 C# .Net Web 应用程序，我正在使用以下 LINQ 查询来获取用户创建或具有各种用户角色的不同提案列表。即使在 Union 和 Distinct 之后，要返回的列表也包含相同提案的欺骗。我究竟做错了什么？

```
 var thereturn = FindAll(DetachedCriteria.For<Proposal>(),
                             new Order("CreateDate", false));

     //get the proposals that aUser created
     IList<Proposal> it = 
                thereturn.Where(proposal => proposal.CreatedBy.Equals(aUser)).ToList();

     //get the proposals that aUser is a BOE Author
     IList<Proposal> it2 =
          thereturn.Where(proposal =>
              proposal.BOEs.Any(boe =>
                  boe.Users.Where(a => a.Name == aUser).Any())).ToList();
     //get all other proposals that aUser is on
     IList<Proposal> it3 = 
          thereturn.Where(proposal =>
              proposal.Users.Where(o => o.Name == aUser).Any()).ToList();
     //now union with all other proposals that aUser is on
     return it3.Union(it).Union(it2).
               OrderByDescending(o=>o.CreateDate).Distinct().ToList(); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-16T19:35:45.747

类的定义是`Proposal`什么？您可能对`Proposal`类的默认相等运算符有疑问。[正如 msdn 所说的 Distinct](http://msdn.microsoft.com/en-us/library/bb348436.aspx)：

> **通过使用默认的相等比较器来比较值，**从序列中返回不同的元素。

 **编辑：换句话说，你有`Equals`和/或的自定义实现`GetHashCode`吗？**

# visual-studio - 如何在 Visual Studio (c#) 中使用来自外部项目的代码？

> ID：10180390
> 
> 赞同：0
> 
> 时间：2012-04-16T19:27:52.503
> 
> 标签：visual-studio, windows-phone-7, ssh

我有 C++ 经验，但没有 C# 经验。

我有一个 windows phone 项目，想使用这个库： [http ://sshnet.codeplex.com/](http://sshnet.codeplex.com/)

它有很多 C# 源文件和一个项目文件

经过数小时的谷歌搜索和尝试，我仍然无法使用 Renci.sshnet 的功能。我有适用于 Windows Phone 的 Microsoft Visual Studio 2010 Express。

提前致谢..

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-17T07:20:00.243

我希望这对你有帮助。

首先将现有项目 (http://sshnet.codeplex.com/) 添加到您的同一解决方案中。右键单击解决方案资源管理器中的项目，然后单击添加引用，选择项目选项卡。选择要添加的项目。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-16T19:33:17.437

WP 是 Silverlight，所以你需要**SshNet Windows Phone Binary**。你拿了这个吗？您采取了哪些步骤来使用（例如，您可以添加参考吗？）。

# javascript - Javascript - 如何在做繁重的工作时避免阻塞浏览器？

> ID：10180391
> 
> 赞同：25
> 
> 时间：2012-04-16T19:28:01.220
> 
> 标签：javascript

我的 JS 脚本中有这样一个函数：

```
function heavyWork(){
   for (i=0; i<300; i++){
        doSomethingHeavy(i);
   }
} 
```

也许“doSomethingHeavy”本身没问题，但重复 300 次会导致浏览器窗口卡住一段不可忽略的时间。在 Chrome 中，这不是什么大问题，因为只有一个 Tab 会受到影响；但对于 Firefox 来说，这完全是一场灾难。

有没有办法告诉浏览器/JS“放轻松”而不是阻止调用doSomethingHeavy之间的所有内容？

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2012-04-16T19:34:01.550

您可以将调用嵌套在`setTimeout`调用中：

```
for(...) {
    setTimeout(function(i) {
        return function() { doSomethingHeavy(i); }
    }(i), 0);
} 
```

这会将调用排队`doSomethingHeavy`等待立即执行，但其他 JavaScript 操作可以插入它们之间。

[更好的解决方案是让浏览器通过Web Workers](https://developer.mozilla.org/en-US/docs/Web/API/Web_Workers_API/Using_web_workers)生成一个新的非阻塞进程，但这是特定于 HTML5 的。

**编辑：**

使用`setTimeout(fn, 0)`实际上需要比零毫秒更长的时间——例如，Firefox[强制要求至少 4 毫秒的等待时间](https://developer.mozilla.org/en-US/docs/Web/API/window.setTimeout?redirectlocale=en-US&redirectslug=DOM%2Fwindow.setTimeout#Minimum.2F_maximum_delay_and_timeout_nesting)。更好的方法可能是使用***[setZeroTimeout](https://github.com/shahyar/setZeroTimeout-js)***，它更喜欢`postMessage`瞬时、可中断的函数调用，但`setTimeout`用作旧浏览器的后备。

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2012-04-16T19:32:09.287

您可以尝试将每个函数调用包装在 a`setTimeout`中，超时为 0。这会将调用推到堆栈的底部，并且应该让浏览器在每个调用之间休息。

```
function heavyWork(){
   for (i=0; i<300; i++){
        setTimeout(function(){
            doSomethingHeavy(i);
        }, 0);
   }
} 
```

编辑：我刚刚意识到这行不通。每次循环迭代的`i`值都相同，您需要进行闭包。

```
function heavyWork(){
   for (i=0; i<300; i++){
        setTimeout((function(x){
            return function(){
                doSomethingHeavy(x);
            };
        })(i), 0);
   }
} 
```

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2012-04-16T19:33:03.267

你需要使用 Web Workers

[https://developer.mozilla.org/En/Using_web_workers](https://developer.mozilla.org/En/Using_web_workers)

如果你在谷歌上搜索，网络工作者有很多链接

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2012-04-16T19:43:08.523

我们需要时常将控制权释放给浏览器，以避免垄断浏览器的注意力。

释放控制的一种方法是使用`setTimeout`，它安排在某个时间段调用“回调”。例如：

```
var f1 = function() {
    document.body.appendChild(document.createTextNode("Hello"));
    setTimeout(f2, 1000);
};

var f2 = function() {
    document.body.appendChild(document.createTextNode("World"));
}; 
```

在此处调用`f1`会将单词添加`hello`到您的文档中，安排待处理的计算，然后将控制权释放给浏览器。最终，`f2`将被调用。

请注意，在整个程序中不加选择地洒在整个程序中是不够的，`setTimeout`就好像它是神奇的小精灵尘埃：您确实需要将其余的计算封装在回调中。通常，`setTimeout`将是函数中的最后一件事，其余的计算填充到回调中。

对于您的特定情况，需要将代码仔细转换为以下内容：

```
var heavyWork = function(i, onSuccess) {
   if (i < 300) {
       var restOfComputation = function() {
           return heavyWork(i+1, onSuccess);
       }
       return doSomethingHeavy(i, restOfComputation);          
   } else {
       onSuccess();
   }
};

var restOfComputation = function(i, callback) {
   // ... do some work, followed by:
   setTimeout(callback, 0);
}; 
```

这将在每个`restOfComputation`.

作为另一个具体示例，请参阅：[如何将一系列声音 HTML5 <audio> 声音剪辑排队以按顺序播放？](https://stackoverflow.com/questions/7701346/how-can-i-queue-a-series-of-sound-html5-audio-sound-clips-to-play-in-sequence/8348599#8348599)

高级 JavaScript 程序员需要知道如何进行这种程序转换，否则他们会遇到您遇到的问题。您会发现，如果您使用这种技术，您将不得不以一种特殊的风格编写程序，其中每个可以释放控制的函数都接收一个回调函数。这种风格的技术术语是“延续传递风格”或“异步风格”。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2012-04-16T19:31:11.893

我看到两种方法：

a) 您可以使用 Html5 功能。那么你可以考虑使用工作线程。

b）您拆分此任务并将一条消息排队，该消息一次只执行一个调用，并且只要有事情要做就迭代。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2012-04-17T12:06:47.880

你可以做很多事情：

1.  优化循环 - 如果繁重的工作与 DOM 访问有关，请参阅此[答案](https://stackoverflow.com/questions/10021223/how-to-manage-dom-elements/10021499#10021499)
    *   如果函数正在处理某种原始数据，请使用类型化数组[^(MSDN)](http://msdn.microsoft.com/en-us/library/br212485%28v=vs.94%29.aspx) [^(MDN)](https://developer.mozilla.org/en/JavaScript_typed_arrays)
2.  带有 setTimeout() 的方法称为[eteration](https://stackoverflow.com/questions/7184896/eteration-explanation-and-example)。非常有用。

3.  对于非函数式编程语言，该函数似乎非常简单。JavaScript 获得了回调[^(SO question)](https://stackoverflow.com/questions/483073/getting-a-better-understanding-of-callback-functions-in-javascript)的优势。

4.  一项新功能是网络工作者[^(MDN)](https://developer.mozilla.org/En/Using_web_workers) [^(MSDN)](http://msdn.microsoft.com/en-us/hh549259) [^(维基百科)](http://en.wikipedia.org/wiki/Web_worker)。

5.  最后一件事（也许）是结合所有方法 - 与传统方式的函数只使用一个线程。如果您可以使用网络工作者，您可以将工作分配给几个人。这应该最大限度地减少完成任务所需的时间。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2012-04-16T19:29:27.767

```
function doSomethingHeavy(param){
   if (param && param%100==0) 
     alert(param);
}

(function heavyWork(){
    for (var i=0; i<=300; i++){
       window.setTimeout(
           (function(i){ return function(){doSomethingHeavy(i)}; })(i)
       ,0);
    }
}()) 
```

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2012-04-16T19:30:26.547

有人编写了一个特定的 backgroundtask javascript 库来完成如此繁重的工作。你可以在这里查看这个问题：

[在Javascript中执行后台任务](https://stackoverflow.com/questions/1160137/execute-background-task-in-javascript)

我自己没有使用过，只是使用了也提到的线程用法。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2022-02-28T20:08:52.377

# 2022答案

有一个名为的新功能`requestIdleCallback`，您可以在其中运行仅在没有其他函数占用事件循环时才会执行的函数，这意味着对于不太重要的繁重工作，您可以安全地执行它而不会影响主线程（假设任务占用小于16ms，也就是一帧。否则必须批量处理）

我编写了一个函数来执行一系列操作而不影响主线程。您还可以随时传递 shouldCancel 回调来取消工作流。它将回退到 setTimeout：

```
export const idleWork = async (
  actions: (() => void)[],
  shouldCancel: () => boolean
): Promise<boolean> => {
  const actionsCopied = [...actions];
  const isRequestIdleCallbackAvailable = "requestIdleCallback" in window;

  const promise = new Promise<boolean>((resolve) => {
    if (isRequestIdleCallbackAvailable) {
      const doWork: IdleRequestCallback = (deadline) => {
        while (deadline.timeRemaining() > 0 && actionsCopied.length > 0) {
          actionsCopied.shift()?.();
        }

        if (shouldCancel()) {
          resolve(false);
        }

        if (actionsCopied.length > 0) {
          window.requestIdleCallback(doWork, { timeout: 150 });
        } else {
          resolve(true);
        }
      };
      window.requestIdleCallback(doWork, { timeout: 200 });
    } else {
      const doWork = () => {
        actionsCopied.shift()?.();
        if (shouldCancel()) {
          resolve(false);
        }

        if (actionsCopied.length !== 0) {
          setTimeout(doWork);
        } else {
          resolve(true);
        }
      };
      setTimeout(doWork);
    }
  });

  const isSearchSuccessful = await promise;
  return isSearchSuccessful;
}; 
```

上面将执行一个函数列表。该列表可能非常长且昂贵，但只要每个单独的任务都在 16 毫秒以下，它就不会影响主线程。警告，因为并非所有浏览器都支持这一点，但 webkit 支持

# windows-phone-7 - 在 WP7 中运行 Powerpoint 以编辑文档

> ID：10180397
> 
> 赞同：0
> 
> 时间：2012-04-16T19:28:44.533
> 
> 标签：windows-phone-7

我正在开发一个需要在 windows phone 7 中运行 powerpoint 以让用户编辑文档的应用程序。该应用程序连接到 skydrive，因此我有此文档的文件 ID 等信息。如何运行 powerpoint 并打开此文档？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-16T20:18:45.773

所以我猜您想使用“Office”应用程序来执行此操作，对吧？然而，这是不可能的，因为微软没有为此提供“任务”（例如 ConnectionSettingsTask）。

# android - RelativeLayout layout_above 崩溃的应用程序

> ID：10180400
> 
> 赞同：1
> 
> 时间：2012-04-16T19:28:59.120
> 
> 标签：android, android-relativelayout

--更新-- 2012 年 4 月 17 日

似乎只有在我添加时才会崩溃：

```
 android:layout_above="@+id/lakeSearchAdWebView" 
```

到lakeSearchScrollView，将它添加到lakeSearchDetailsWebView 工作正常。

这是我的布局：

```
<?xml version="1.0" encoding="utf-8"?>
<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
android:layout_width="fill_parent"
android:layout_height="fill_parent" >

<ScrollView
    android:id="@+id/lakeSearchScrollView"
    android:layout_width="match_parent"
    android:layout_height="wrap_content"
    android:layout_alignParentTop="true"
    android:visibility="visible" >

    <RelativeLayout
        android:layout_width="wrap_content"
        android:layout_height="match_parent" >

        <ImageView
            android:id="@+id/imageView1"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:layout_x="0dp"
            android:layout_y="0dp"
            android:src="@drawable/contentbg" />

        <EditText
            android:id="@+id/searchBar"
            android:layout_width="274dp"
            android:layout_height="wrap_content"
            android:layout_alignParentTop="true"
            android:layout_centerHorizontal="true"
            android:layout_marginTop="83dp" >

            <requestFocus />
        </EditText>

        <Button
            android:id="@+id/lakeSearchSearchBTN"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:layout_alignRight="@+id/searchBar"
            android:layout_below="@+id/searchBar"
            android:layout_marginTop="15dp"
            android:text="Search" />

        <TableLayout
            android:id="@+id/resultsTableLayout"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:layout_below="@+id/lakeSearchSearchBTN" >
        </TableLayout>
    </RelativeLayout>
</ScrollView>

<WebView
    android:id="@+id/lakeSearchDetailsWebView"
    android:layout_width="match_parent"
    android:layout_height="wrap_content"
    android:layout_alignParentTop="true"
    android:visibility="invisible" />

<WebView
    android:id="@+id/lakeSearchAdWebView"
    android:layout_width="match_parent"
    android:layout_height="50dp"
    android:layout_alignParentBottom="true" />

</RelativeLayout> 
```

我想设置lakeSearchScrollView 和lakeSearchDetailsWebView 以便它们始终位于lakeSearchAdWebview 上方，因此lakeSearchAdWebview 始终可见。一次只有一个lakeSearchScrollView 和lakeSearchDetailsWebView 可见，这就是它们被设置为彼此重叠的原因。

如果我将以下行添加到lakeSearchScrollView，应用程序崩溃：

```
android:layout_above="@+id/lakeSearchAdWebView" 
```

谁能告诉我我做错了什么？我对 Android 还是很陌生，所以我认为这可能是新手的错误......提前谢谢！

--更新-- 源代码：

```
package com.theappdoor.ifish;

import java.util.ArrayList;
import java.util.Iterator;
import java.util.List;

import android.app.Activity;
import android.app.AlertDialog;
import android.app.TabActivity;
import android.content.Context;
import android.content.DialogInterface;
import android.content.Intent;
import android.content.SharedPreferences;
import android.os.Bundle;
import android.view.LayoutInflater;
import android.view.View;
import android.view.View.OnClickListener;
import android.view.inputmethod.InputMethodManager;
import android.webkit.WebSettings;
import android.webkit.WebView;
import android.webkit.WebViewClient;
import android.widget.Button;
import android.widget.EditText;
import android.widget.ScrollView;
import android.widget.TabHost;
import android.widget.TableLayout;
import android.widget.TableRow;
import android.widget.TextView;

import android.util.Log;

public class iFishLakeSearch extends Activity {

    private EditText searchBar;
    private TableLayout resultsTableLayout;
    private DataHelper dh;
    private iFishLakeDetails iFishLD;

    private Button lakeSearchBTN;
    private ScrollView searchScrollView;
    private WebView detailsWebView;
    private String lake_id;

    private WebView lakeSearchAdWebView;

    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);

        //setContentView(R.layout.lakesearch);
        //This sets the context to the be of the parent, which is what we want
        View viewToLoad = LayoutInflater.from(this.getParent()).inflate(R.layout.lakesearch, null);
        setContentView(viewToLoad);

        //setup vars

        this.dh = new DataHelper(this);
        this.iFishLD = new iFishLakeDetails(this);

        // connect our elements from the UI XML

        this.searchBar = (EditText) findViewById(R.id.searchBar); //LINE 61

        this.resultsTableLayout = (TableLayout) findViewById(R.id.resultsTableLayout);

        this.lakeSearchBTN = (Button) findViewById(R.id.lakeSearchSearchBTN);
        this.lakeSearchBTN.setOnClickListener(new OnClickListener(){
            public void onClick(View v) {
                lakeSearch(v);
            }
        });

        this.searchScrollView = (ScrollView) findViewById(R.id.lakeSearchScrollView);

        this.detailsWebView = (WebView) findViewById(R.id.lakeSearchDetailsWebView);
        WebSettings webSettings = this.detailsWebView.getSettings();
        webSettings.setJavaScriptEnabled(true);
        this.detailsWebView.setWebViewClient(new MyWebViewClient());
        this.detailsWebView.addJavascriptInterface(new JavaScriptInterface(this), "Android");

        this.detailsWebView.loadUrl("file:///android_asset/webassets/index.html");

        this.lakeSearchAdWebView = (WebView)findViewById(R.id.lakeSearchAdWebView);
        webSettings = this.lakeSearchAdWebView.getSettings();
        webSettings.setJavaScriptEnabled(true);

        this.lakeSearchAdWebView.loadUrl(this.getString(R.string.server)+"/iFish_ads/");

    } 
```

第 61 行：

```
this.searchBar = (EditText) findViewById(R.id.searchBar); 
```

- 更新 -

崩溃日志：

```
 04-16 13:22:23.951: D/AndroidRuntime(20896): Shutting down VM
    04-16 13:22:23.951: W/dalvikvm(20896): threadid=1: thread exiting with uncaught exception (group=0x40015578)
    04-16 13:22:23.970: E/AndroidRuntime(20896): FATAL EXCEPTION: main
    04-16 13:22:23.970: E/AndroidRuntime(20896): java.lang.IllegalStateException: Could not execute method of the activity
    04-16 13:22:23.970: E/AndroidRuntime(20896):    at android.view.View$1.onClick(View.java:2154)
    04-16 13:22:23.970: E/AndroidRuntime(20896):    at android.view.View.performClick(View.java:2538)
    04-16 13:22:23.970: E/AndroidRuntime(20896):    at android.view.View$PerformClick.run(View.java:9152)
    04-16 13:22:23.970: E/AndroidRuntime(20896):    at android.os.Handler.handleCallback(Handler.java:587)
    04-16 13:22:23.970: E/AndroidRuntime(20896):    at android.os.Handler.dispatchMessage(Handler.java:92)
    04-16 13:22:23.970: E/AndroidRuntime(20896):    at android.os.Looper.loop(Looper.java:123)
    04-16 13:22:23.970: E/AndroidRuntime(20896):    at android.app.ActivityThread.main(ActivityThread.java:3687)
    04-16 13:22:23.970: E/AndroidRuntime(20896):    at java.lang.reflect.Method.invokeNative(Native Method)
    04-16 13:22:23.970: E/AndroidRuntime(20896):    at java.lang.reflect.Method.invoke(Method.java:507)
    04-16 13:22:23.970: E/AndroidRuntime(20896):    at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:842)
    04-16 13:22:23.970: E/AndroidRuntime(20896):    at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:600)
    04-16 13:22:23.970: E/AndroidRuntime(20896):    at dalvik.system.NativeStart.main(Native Method)
    04-16 13:22:23.970: E/AndroidRuntime(20896): Caused by: java.lang.reflect.InvocationTargetException
    04-16 13:22:23.970: E/AndroidRuntime(20896):    at java.lang.reflect.Method.invokeNative(Native Method)
    04-16 13:22:23.970: E/AndroidRuntime(20896):    at java.lang.reflect.Method.invoke(Method.java:507)
    04-16 13:22:23.970: E/AndroidRuntime(20896):    at android.view.View$1.onClick(View.java:2149)
    04-16 13:22:23.970: E/AndroidRuntime(20896):    ... 11 more
    04-16 13:22:23.970: E/AndroidRuntime(20896): Caused by: java.lang.RuntimeException: Unable to start activity ComponentInfo{com.theappdoor.ifish/com.theappdoor.ifish.TabGroup2Activity}: java.lang.RuntimeException: Unable to start activity ComponentInfo{com.theappdoor.ifish/com.theappdoor.ifish.iFishLakeSearch}: java.lang.ClassCastException: android.webkit.WebView
    04-16 13:22:23.970: E/AndroidRuntime(20896):    at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:1651)
    04-16 13:22:23.970: E/AndroidRuntime(20896):    at android.app.ActivityThread.startActivityNow(ActivityThread.java:1491)
    04-16 13:22:23.970: E/AndroidRuntime(20896):    at android.app.LocalActivityManager.moveToState(LocalActivityManager.java:127)
    04-16 13:22:23.970: E/AndroidRuntime(20896):    at android.app.LocalActivityManager.startActivity(LocalActivityManager.java:339)
    04-16 13:22:23.970: E/AndroidRuntime(20896):    at android.widget.TabHost$IntentContentStrategy.getContentView(TabHost.java:657)
    04-16 13:22:23.970: E/AndroidRuntime(20896):    at android.widget.TabHost.setCurrentTab(TabHost.java:329)
    04-16 13:22:23.970: E/AndroidRuntime(20896):    at com.theappdoor.ifish.iFishHome.goToLakeSearch(iFishHome.java:20)
    04-16 13:22:23.970: E/AndroidRuntime(20896):    ... 14 more
    04-16 13:22:23.970: E/AndroidRuntime(20896): Caused by: java.lang.RuntimeException: Unable to start activity ComponentInfo{com.theappdoor.ifish/com.theappdoor.ifish.iFishLakeSearch}: java.lang.ClassCastException: android.webkit.WebView
    04-16 13:22:23.970: E/AndroidRuntime(20896):    at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:1651)
    04-16 13:22:23.970: E/AndroidRuntime(20896):    at android.app.ActivityThread.startActivityNow(ActivityThread.java:1491)
    04-16 13:22:23.970: E/AndroidRuntime(20896):    at android.app.LocalActivityManager.moveToState(LocalActivityManager.java:127)
    04-16 13:22:23.970: E/AndroidRuntime(20896):    at android.app.LocalActivityManager.startActivity(LocalActivityManager.java:339)
    04-16 13:22:23.970: E/AndroidRuntime(20896):    at com.theappdoor.ifish.TabGroupActivity.startChildActivity(TabGroupActivity.java:116)
    04-16 13:22:23.970: E/AndroidRuntime(20896):    at com.theappdoor.ifish.TabGroup2Activity.onCreate(TabGroup2Activity.java:10)
    04-16 13:22:23.970: E/AndroidRuntime(20896):    at android.app.Instrumentation.callActivityOnCreate(Instrumentation.java:1047)
    04-16 13:22:23.970: E/AndroidRuntime(20896):    at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:1615)
    04-16 13:22:23.970: E/AndroidRuntime(20896):    ... 20 more
    04-16 13:22:23.970: E/AndroidRuntime(20896): Caused by: java.lang.ClassCastException: android.webkit.WebView
    04-16 13:22:23.970: E/AndroidRuntime(20896):    at com.theappdoor.ifish.iFishLakeSearch.onCreate(iFishLakeSearch.java:61)
    04-16 13:22:23.970: E/AndroidRuntime(20896):    at android.app.Instrumentation.callActivityOnCreate(Instrumentation.java:1047)
    04-16 13:22:23.970: E/AndroidRuntime(20896):    at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:1615)
    04-16 13:22:23.970: E/AndroidRuntime(20896):    ... 27 more
    04-16 13:22:44.244: I/Process(20896): Sending signal. PID: 20896 SIG: 9 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-16T20:07:37.913

android:layout_above="@+id/lakeSearchAdWebView" 表示视图将直接位于lakeSearchAdWebView 上方。既然你说你把它放在两个不同的视图中，就有一个问题，因为它们不能都直接位于lakeSearchAdWebView之上。

因此要修复，简单的说： `android:layout_above="@+id/lakeSearchAdWebView"`在lakeSearchDetailsWebView

然后放入`android:layout_above:"@+id/lakeSearchDetailsWebView"`lakeSearchScrollView

这样做会使您的视图按顺序（从上到下）lakeSearchScrollView、lakeSearchDetailsWebView、lakeSearchAdWebView

# c++ - 如何表示以 2³² 为底的数字？

> ID：10180401
> 
> 赞同：7
> 
> 时间：2012-04-16T19:29:11.230
> 
> 标签：c++, c, numbers, biginteger, base

如果我有一些以 10 为基数或以 16 为基数的数字，如何将其更改为以 2 ^(32)为基数？

我尝试这样做的原因是为了按照此处其他成员的建议实施 BigInt[为什么要使用更高的基础来实施 BigInt？](https://stackoverflow.com/questions/10178055/why-to-use-higher-base-for-implementing-bigint)

它是否与整数（以 10 为底）相同，直到 2 ^(32)？之后会发生什么？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-04-16T19:58:47.467

你正试图找到某种形式的东西

```
a0 + a1 * (2^32) + a2 * (2^32)^2 + a3 * (2^32)^3 + ... 
```

这*正是*base-2 ^(32)系统的定义，所以请忽略所有告诉您您的问题没有意义的人！

无论如何，您所描述的内容称为[*基本转换*](http://en.wikipedia.org/wiki/Base_conversion#Base_conversion)。有快速的方法，也有简单的方法来解决这个问题。快速方法非常复杂（有专门针对该主题[的书籍的整章](http://www.amazon.co.uk/Precision-Arithmetic-Encyclopedia-Mathematics-Applications/dp/0521761352/ref=sr_1_1?ie=UTF8&qid=1325537407&sr=8-1)），我不打算在这里尝试解决它们（尤其是因为我从未尝试过使用它们）。

一种简单的方法是首先在数字系统中实现两个函数，乘法和加法。（即实施`BigInt add(BigInt a, BigInt b)`和`BigInt mul(BigInt a, BigInt b)`）。一旦你解决了这个问题，你会注意到一个以 10 为底的数字可以表示为：

```
b0 + b1 * 10 + b2 * 10^2 + b3 * 10^3 + ... 
```

也可以写成：

```
b0 + 10 * (b1 + 10 * (b2 + 10 * (b3 + ... 
```

因此，如果您在输入字符串中从左到右移动，您可以一次剥离一个以 10 为基数的数字，并使用您的`add`和`mul`函数累积到您的`BigInt`：

```
BigInt a = 0;
for each digit b {
    a = add(mul(a, 10), b);
} 
```

**免责声明：**此方法计算效率**不**高，但至少可以帮助您入门。

**注意：**从 base-16 转换**要**简单得多，因为 2 ^(32)是 16 的精确倍数。所以转换基本上归结为连接位。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-04-16T19:58:15.970

假设我们正在谈论一个以 10 为底的数字：

```
a[0]*10^0 + a[1]*10^1 + a[2]*10^2 + a[3]*10^3 + ... + a[N]*10^N 
```

其中 each`a[i]`是 0 到 9（含）范围内的一个数字。

我将假设您可以解析作为输入值的字符串并找到数组`a[]`。一旦你能做到这一点，并假设你已经用and运算符实现了你的`BigInt`类，那么你就回家了。您可以使用您的类的实例简单地评估上面的表达式。`+``*``BigInt`

[您可以使用Horner 方法](http://en.wikipedia.org/wiki/Horner_scheme)相对有效地评估此表达式。

我刚刚把这个写下来，我敢打赌，有更有效的基本转换方案。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-04-16T19:43:23.970

> 如果我有一些以 10 为底或以 16 为底的数字，如何将其更改为以 2^32 为底的数字？

就像您将其转换为任何其他基础一样。您想将数字写`n`为

```
n = a_0 + a_1 * 2^32 + a_2 * 2^64 + a_3 * 2^96 + ... + a_k * 2^(32 * k). 
```

因此，找到 2^32 的最大幂，除以`n`，从 中减去该幂的倍数`n`，然后用差值重复。

但是，你确定你问对了问题吗？

我怀疑你的意思是问一个不同的问题。我怀疑您的意思是要问：如何将 base-10 数字解析为 my 的实例`BigInteger`？这很容易。编写您的实现代码，并确保您已实现`+`和`*`. 我完全不知道您实际上如何在内部表示整数，但如果您想使用基数 2^32，那么可以。然后：

```
 BigInteger Parse(string s) {
      BigInteger b = new BigInteger(0);
      foreach(char c in s) { b = b * 10 + (int)c - (int)'0'; }
      return b;
 } 
```

我会留给你把它翻译成C。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-04-16T20:04:29.120

以 16 为底很容易，因为 2 ^(32)是 16 ⁸，一个精确的幂。因此，从最低有效位开始，一次读取 8 个 base-16 数字，将这些数字转换为 32 位值，即下一个 base-2 ^(32) “数字”。

Base 10 更难。正如您所说，如果它小于 2 ^(32)，那么您只需将该值作为单个 base-2 ^(32) “数字”。否则，我能想到的最简单的方法是使用长除法算法将基数为 10 的值除以 2 ^(32)；在每个阶段，余数是下一个以 2 为底的^(32) “数字”。也许比我了解更多数论的人可以提供更好的解决方案。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-04-16T20:20:02.657

我认为这是一件完全合理的事情。

您正在做的是在 32 位整数数组中表示一个非常大的数字（如加密密钥）。

以 16 为基数的表示是以 2^4 为基数的，或者一次是一系列 4 位。如果您正在接收以 16 个“数字”为基数的流，请填写数组中第一个整数的低 4 位，然后是下一个最低位，直到您读取 8 个“数字”。然后转到数组中的下一个元素。

```
long getBase16()
{
  char cCurr;

  switch (cCurr = getchar())
  {
  case 'A':
  case 'a':
    return 10;
  case 'B':
  case 'b':
    return 11;
  ...
  default:
    return cCurr - '0';
  }
}

void read_input(long * plBuffer)
{
  long * plDst = plBuffer;
  int iPos = 32;

  *(++plDst) = 0x00;

  long lDigit;
  while (lDigit = getBase16())
  {
     if (!iPos)
     {
       *(++plDst) = 0x00;
       iPos = 32;
     }

     *plDst >> 4;
     iPos -= 4;
     *plDst |= (lDigit & 0x0F) << 28
  }
} 
```

有一些修复要做，比如通过将 *plDst 移动 iPos 来结束，并跟踪数组中的整数数量。

还有一些工作要从基数 10 转换。

但这足以让您入门。

# wordpress - 用 .htaccess 重写一个奇怪的 URL 字符串

> ID：10180402
> 
> 赞同：0
> 
> 时间：2012-04-16T19:29:12.270
> 
> 标签：wordpress, .htaccess, mod-rewrite

我想`?s=`用`/search/`.`.htaccess`

示例：`http://hello.com/?s=hey`=>`http://hello.com/search/hey`

我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-16T20:08:07.027

感谢大家的回答，这对我有用，取自[这里](http://wpengineer.com/2258/change-the-search-url-of-wordpress/)。

```
RewriteCond %{QUERY_STRING} s=(.*)
RewriteRule ^$ /search/%1? [R,L] 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-16T19:31:20.253

可能是这样的

```
RewriteEngine On
RewriteRule ^search/(.*)  index.php?s=$1     [QSA,L] 
```

这样，您将访问您的网站，例如

`http://hello.com/search/hey`将被解释为`http://hello.com/index.php?s=hey`

希望这可以帮助

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-16T19:55:46.647

将此代码放在 DOCUMENT_ROOT 下的 .htaccess 中：

```
Options +FollowSymLinks -MultiViews
# Turn mod_rewrite on
RewriteEngine On
RewriteBase /

# external redirect from index.php?s=key to search/key
RewriteCond %{THE_REQUEST} ^[A-Z]{3,}\s/+index\.php\?s=([^\s]+) [NC]
RewriteRule ^ search/%1? [L,R,NC]

# external redirect from search/key to index.php?s=key
RewriteRule ^search/(.+)$ index.php?s=$1 [L,NC,QSA] 
```

# java - setImageResources - 我想添加一个字符串。有可能吗？

> ID：10180408
> 
> 赞同：0
> 
> 时间：2012-04-16T19:29:53.443
> 
> 标签：java, android

```
public void correctLetter(String Letter, int pos){
    if(letter.equals("a")){ 
          ImageView image = images[pos];
          image.setImageResource(R.drawable.a);
          image.setVisibility(ImageView.VISIBLE); 
    } 
```

目前我有一个看起来像这样的方法。但是，当我收到 26 封信时，那将是很多如果。

有人知道我该如何改变吗？我尝试做这样的事情，但 setImageResource 无论如何都需要 int 。

```
public void correctLetter(String letter, int pos) {
        char newLetter = letter.toCharArray()[0];
        String startS = "R.drawable." + letter;
        startS += Character.toString(newLetter);
        ImageView image = images[pos];
        image.setImageResource(startS);
        image.setVisibility(ImageView.VISIBLE);
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-16T19:44:53.577

您可以将图像的资源 ID 保存在静态 int 数组中，并在调用 setImageResource() 时对其进行索引。请参考下面的代码

```
private static final int charImgIds[] = { R.drawable.a, R.drawable.b, ... , R.drawable.z };
public void correctLetter(String letter, int pos) {
    int letterIndex = letter.toCharArray()[0];
    ImageView image = images[pos];
    image.setImageResource(charImgIds[letterIndex]);
    image.setVisibility(ImageView.VISIBLE);
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-16T20:25:38.550

`startS`你可以通过这种方式初始化：

```
int startS =  getResources().getIdentifier(letter, "drawable","com.yourpackage.name"); 
```

# xslt - 如何在 XSLT 中用单引号替换双引号？

> ID：10180417
> 
> 赞同：3
> 
> 时间：2012-04-16T19:30:30.237
> 
> 标签：xslt

我正在通过 XSLT 使用 XML 数据创建幻灯片。该过程的一部分是使用标题初始化一个数组：

```
item[0] = ["How do I jump?"];
item[1] = ["I know how to jump!"];
item[2] = ["Did you read "how to jump""]; 
```

请注意，第三个元素的书名用双引号括起来？好吧，初始化该元素会导致样式表的编译出现问题（应该如此），但是有什么方法可以删除双引号并用单引号替换它们？

```
<xsl:variable name="apos"><xsl:text>'</xsl:text></xsl:variable>
<xsl:variable name="double_quote"><xsl:text>"</xsl:text></xsl:variable>

<xsl:for-each select="/data/calendar/event/title">  
        <xsl:variable name="index">
            <xsl:value-of select="position() - 1"/>
        </xsl:variable>
        <xsl:variable name="safeTitle" select="translate(text(),$double_quote, $apos)" /><!-- prevents double quotes from being used inside an array using double quotes -->           
        fadetitlesSS12<xsl:value-of select="/data/calendar/id" />[<xsl:value-of select="$index" />]=["<xsl:value-of select="$safeTitle" />"];
    </xsl:for-each> 
```

# ruby-on-rails - Rails Active Admin css 与 Twitter Bootstrap css 冲突

> ID：10180418
> 
> 赞同：41
> 
> 时间：2012-04-16T19:30:43.207
> 
> 标签：ruby-on-rails, css, twitter-bootstrap, asset-pipeline

我对 Rails 资产管道有些陌生，所以我可能做错了什么。我正在尝试将 Active Admin 用于我的后端，并将 twitter bootstrap css 用于我的前端应用程序。

我将 bootstrap.css 添加到**/app/assets/stylesheets**然后还添加了：

```
//= require bootstrap 
```

到 application.css - 然后我在本地对资产进行了预编译

它似乎工作正常，但有些样式并没有完全通过，我认为这是因为活动管理员的 css 覆盖了它。

我的理解是应用程序将 css 资产编译到应用程序 css 公共资产中，并且应用程序在运行时使用该文件。

我需要以某种方式将两者分开并使其使用**twitter bootstrap css**作为前端的主要 css，并且可能告诉它不要在前端使用**活动管理员的 css**文件。

最好的方法是什么？

* * *

## 回答 #1

> 赞同：132
> 
> 时间：2012-07-31T17:10:23.707

我有同样的问题，并且能够通过移动来解决它

```
app/assets/stylesheets/active_admin.css.scss 
```

到

```
vendor/assets/stylesheets/active_admin.css.scss 
```

活动的管理资产**应该**在[rails 指南](http://guides.rubyonrails.org/asset_pipeline.html#asset-organization)`vendor/`中提到：

*“供应商/资产适用于外部实体拥有的资产，例如 JavaScript 插件和 CSS 框架的代码。”*

* * *

## 回答 #2

> 赞同：29
> 
> 时间：2012-04-25T17:57:24.363

您是否观看过有关使用 ActiveAdmin 的 RailsCasts 视频？在视频中，Ryan 向您展示了如何防止 ActiveAdmin CSS 踩到您的主应用程序 CSS。

[http://railscasts.com/episodes/284-active-admin](http://railscasts.com/episodes/284-active-admin)

将视频中的信息转移到答案中

在 application.css 你删除：

```
*= require_tree . 
```

对于 rails 4，[Jiten K](https://stackoverflow.com/questions/19304681/activeadmin-overides-my-css)建议将其添加到`production.rb`：

```
config.assets.precompile += ['active_admin.css'] 
```

然而，关于那个 SO 答案的评论之一说这不是必需的。到目前为止我还不需要它。

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2016-11-23T12:59:22.987

对我来说`application.css`，改为以下解决了这个问题：

```
 *= require bootstrap
 *= require_tree .
 *= stub "active_admin" 
```

# android - 布局中的动画视图（Honeycomb 之前）

> ID：10180420
> 
> 赞同：2
> 
> 时间：2012-04-16T19:31:11.717
> 
> 标签：android

我试图为 View 在 RelativeLayout 中的位置设置动画。在每一帧中，我都会更改视图的 LayoutParams 的 topMargin，然后调用 View#setLayoutParams(newParams)。

不幸的是，动画太慢了，因为 setLayoutParams() 调用触发了对整个视图树的重新测量。

如何在不使用 API 11+ 的情况下解决这个问题？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-16T19:43:01.147

您可以使用[View Animations](http://developer.android.com/guide/topics/graphics/view-animation.html)只需将自己制作一个带有翻译动画的 xml 文件，该文件定义您希望 View 如何移动。然后膨胀对您的动画的引用并调用

```
view.startAnimation(anim); 
```

这是一个翻译 xml 文件的示例。你会在 res/anim/ 中保存这样的文件

```
<set xmlns:android="http://schemas.android.com/apk/res/android"
android:interpolator="@android:anim/overshoot_interpolator">

<translate android:fromXDelta="100%p" android:toXDelta="0%p" android:duration="700"/>

</set> 
```

这是您在 java 中使用它时要做的事情。

```
Animation slideLeftIn;

@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    slideLeftIn = AnimationUtils.loadAnimation(this, R.anim.slide_left_in);
    //mView can be any View object.
    mView.startAnimation(slideLeftIn);
} 
```

# java - 从其他类调用静态方法

> ID：10180422
> 
> 赞同：0
> 
> 时间：2012-04-16T19:31:16.763
> 
> 标签：java, android, scoreloop

所以我在将 scoreloop 集成到我的游戏中时遇到了一些问题。我使用用 c++ 编写的 cocos2dx 并使用 ndk。主应用程序类是从活动而不是从 android.app.application 派生的。在布局中添加一个按钮并使用它来调出记分牌或提交乐谱作品，但它没有连接到互联网。我在这里找到了解决方案：[scoreloop support forum](http://support.scoreloop.com/discussions/problems/606-error-on-android-16-and-not-on-23)或更具体地说

> 是的，使用 libgdx 似乎是个问题。libgdx 带来了它自己的 Application 类，它实际上是从 Android 的 Activity 派生的，而不是 Application。来自 libgdx 的 helloworld 示例根本没有（Android）应用程序类，这里是如何添加一个：
> 
> > 创建一个扩展 android.app.Application 的新类（不是 com.badlogic.gdx.backends.android.AndroidApplication）
> > 
> > 在 AndroidManifest.xml 中找到创建的类的标签和名称作为属性： android:name="YourApplication"
> > 
> > 将方法 public void onCreate() 添加到该类并在那里初始化 Scoreloop。

所以接下来我创建了这个：

```
public class scoreLooped extends android.app.Application{
public void onCreate(Bundle savedInstanceState){
    ScoreloopManagerSingleton.init(this, "redacted");
} 
 public void onTerminate()
 {
     ScoreloopManagerSingleton.destroy();
 } 
```

}

我从我的主要活动类创建这个类，如下所示：

```
public class wordsweeper extends Cocos2dxActivity implements OnScoreSubmitObserver{
private Cocos2dxGLSurfaceView mGLView;
private static scoreLooped a;

protected void onCreate(Bundle savedInstanceState){
    super.onCreate(savedInstanceState);
    wordsweeper.a = new scoreLooped();
    //Set the observer equal to an instance of this class
    ScoreloopManagerSingleton.get().setOnScoreSubmitObserver(this); 
```

最后一行是它因错误“引起：java.lang.IllegalStateException：必须首先调用 ScoreloopManagerSingleton.init()”而崩溃的地方，所以显然我的 scoreLooped 类没有调用 scoreloopmanager。我曾考虑过使用 scorelooped 类来提交、检索记分牌，但如果不扩展活动，我似乎无法做到这一点。我对java很陌生，所以我可能会遗漏一些明显的东西，所以如果有人能指出我正确的方向，那就太好了。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-16T20:09:50.537

看来您需要创建自己的 Application 类并`ScoreloopManagerSingleton.init()`在那里调用。请参阅此处的答案，其中引用了一些示例文档：http: [//support.scoreloop.com/discussions/problems/789-illegalstateexception-scoreloopmanagersingletoninit-can-be-call-only-once](http://support.scoreloop.com/discussions/problems/789-illegalstateexception-scoreloopmanagersingletoninit-can-be-called-only-once)

# c++ - 你能改变指针指向的大小吗

> ID：10180425
> 
> 赞同：0
> 
> 时间：2012-04-16T19:31:52.253
> 
> 标签：c++, pointers, strncpy

例如，如果一个指针指向一个字符数组，上面写着“你好，你好吗？” 而您只希望指针指向 Hello。我传入一个 char 指针，当我计算它时，它会读取整个数组。我尝试使用一个 for 循环来减小大小，该循环在遇到“”时会中断。但我没有运气弄清楚。有任何想法吗？

```
const char *infile(char * file )
{
    cout<<file<<endl;  //this prints out the entire array
    int j;
    for(j=0;j<500; j++)
    {
        if(file[j]==' ')
           break;
    }
    strncpy(file, file,  j);
    cout<<file<<endl;  //how to get this to print out only the first word
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-16T19:37:19.057

`strncpy()``j`如果源字符串的第一个字节中没有空终止符，则不会附加空终止符。而你的情况，没有。

我认为您想要做的是将第一个空格手动更改为`\0`：

```
for (j = 0; j < 500; j++) {
  if (file[j] == ' ') {
    file[j] = '\0';
    break;
  }
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-16T19:39:13.607

首先，*避免*使用 strtok（就像它最常见的瘟疫一样）。这是令人不快的，但有时在 C 中是合理的。不过，我还没有看到我所说的在 C++ 中使用它的理由。

其次，可能最简单的处理方法（假设您使用的是 C++）是使用字符串流：

```
void infile(char const *file) 
{
    std::strinstream buffer(file);
    std::string word;
    buffer >> word;
    std::cout << word;
} 
```

另一种可能性是使用 std::string 中内置的一些函数：

```
void infile(char const *file) {
    std::string f(file);
    std::cout << std::string(f, 0, f.find(" "));
} 
```

...现在我想起来，这可能比`stringstream`事物的版本简单一些。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-16T19:49:03.893

`char*`指针实际上只指向一个对象`char`。如果该对象恰好是字符串的第一个（或任何）元素，您可以使用指针算法来访问该字符串的其他元素——这就是字符串（C 风格的字符串，而不是 C++ 风格`std::string`的对象）通常的样子访问。

（C 风格）字符串只是一个以空字符 (' `\0`') 结尾的字符序列。（`'\0'`终止符之后的任何内容都不是字符串的一部分。）因此，字符串`"foo bar"`由以下字符序列组成：

```
{ 'f', 'o', 'o', ' ', 'b', 'a', 'r', '\0' } 
```

如果要将字符串从更改`"foo bar"`为 just `"foo"`，一种方法是将空格字符替换为空字符：

```
{ 'f', 'o', 'o', '\0', ... } 
```

`...`不是语法的一部分；它表示仍然存在的字符（`'b'`, `'a'`, `'r'`, `'\0'`），但不再是字符串的一部分。

由于您使用的是 C++，因此使用`std::string`;可能会更好。它更加强大和灵活，让您不必担心终结符、内存分配和其他细节。（当然，除非这个练习的目的是学习 C 风格的字符串是如何工作的。）

请注意，这*会修改*指向的字符串`file`，并且该更改将对调用者可见。您可以通过制作字符串的本地副本来避免这种情况（这需要为其分配空间，然后释放该空间）。再次，`std::string`使这种事情*变得*容易得多。

最后，这个：

```
strncpy(file, file,  j); 
```

在几个层面上都不好。像这样使用重叠的源和目标调用`strncpy()`具有未定义的行为；从字面上看，任何事情都可能发生。并且`strncpy()`不一定在目的地提供适当的 NUL 终止符。从某种意义上说，`strncpy()`它并不是一个真正的字符串函数。你最好假装它不存在。

[见我对这个话题的咆哮](http://the-flat-trantor-society.blogspot.com/2012/03/no-strncpy-is-not-safer-strcpy.html)。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-16T22:17:02.693

```
std::copy(file, std::find(file, file+500, ' '),
          std::ostream_iterator<char>(std::cout, "")); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-04-16T19:33:58.973

这与指针的大小无关。**对于特定类型，指针始终具有相同的大小。**

strtok 可能是最好的解决方案（使用 strtok 的这段代码每次遇到空格、“、”、点或“-”时都会将字符串分解为子字符串。

```
char str[] ="- This, a sample string.";
  char * pch;
  printf ("Splitting string \"%s\" into tokens:\n",str);
  pch = strtok (str," ,.-");
  while (pch != NULL)
  {
    printf ("%s\n",pch);
    pch = strtok (NULL, " ,.-");
  } 
```

资料来源：[CPP STTOK](http://www.cplusplus.com/reference/clibrary/cstring/strtok/)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-04-16T19:35:06.387

这样做会容易得多

```
 if(file[j]==' ') {
   file[j] = 0;
   break;
   ..

  // strncpy(file, file,  j); 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-04-16T19:35:19.193

使用[`strtok`](http://www.cplusplus.com/reference/clibrary/cstring/strtok/)可能会让您的生活更轻松。
使用 ' ' 作为分隔符拆分字符串，然后打印您从中获得的第一个元素`strtok`。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2012-04-16T19:35:33.187

使用“strtok”，参见例如[http://www.cplusplus.com/reference/clibrary/cstring/strtok/](http://www.cplusplus.com/reference/clibrary/cstring/strtok/)

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2012-04-16T19:39:18.837

如果您要问的是“我可以动态调整此指针指向的内存块的大小”那么......不是真的，不。（您必须创建一个所需大小的新块，然后复制字节，删除第一个块等）

如果您只想“打印第一个单词”，则将空格位置的字符设置为 0。然后，当您输出 file* 指针时，您只会得到第一个单词（直到 \0 .) （阅读以[空字符结尾的字符串](http://en.wikipedia.org/wiki/Null-terminated_string)，了解更多关于为什么会这样工作的信息。）

但这一切都取决于你所做的有多少是一个例子来展示你试图解决的问题。如果您真的“拆分字符串”，那么您至少要**考虑**使用[strtok](http://en.wikipedia.org/wiki/Strtok)。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2012-04-16T19:39:23.540

为什么不一次输出每个字符，然后在遇到空格时中断。

```
const char *infile(char * file )
{
  cout<<file<<endl;  //this prints out the entire array
  int j;

  for(j=0;j<500; j++)
  {
    if(file[j]==' ')
       break;
    cout<<file[j];
  }

  cout<<endl;
} 
```

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2012-04-16T19:56:36.943

如果您使用 malloc 分配了 char * 指向的空间，则可以使用 realloc 更改大小。

```
char * pzFile = malloc(sizeof("Hello how are you?" + 1));
strcpy(pzFile, "Hello how are you?");
realloc(pzFile, 6);
pzFile[6] = '\0'; 
```

请注意，如果不设置空指针，使用字符串可能会导致问题。

如果您只是想缩短字符串，您所要做的就是在位置 6 处设置空终止符。分配的空间比需要的空间大，但只要不短就可以了。

我强烈建议您最想做的是将字符串复制到空格中。

```
char * pzInput = malloc(sizeof("Hello how are you?" + 1));
strcpy(pzInput, "Hello how are you?");
char * pzBuffer = malloc(BUFFER_SIZE);

char * pzSrc = pzInput;
char * pzDst = pzBuffer;
while (*pzSrc && ' ' != *pzSrc)
  *(pzDst++) = *(pzSrc++);
*pzDst = '\0'; 
```

这也会导致 pzSrc 指向字符串的其余部分以供以后使用！

# java - 在 UI 线程和后台网络线程之间交换消息

> ID：10180426
> 
> 赞同：2
> 
> 时间：2012-04-16T19:31:56.973
> 
> 标签：java, android

我目前正在开发一个仅供个人使用的 android 应用程序。该应用程序通过 TCP 套接字与服务器通信。如果用户进行输入，则需要立即发送。此外，在任何给定时间，都可能有来自服务器的消息需要显示在 UI 上。对于所有网络内容，我都有一个背景线程。

由于我需要在任何用户输入时将消息从 UI 传递到网络线程，并且在任何给定时间将消息从网络线程传递到 UI，我的问题如下：如何传递消息？我已经阅读了 3 个小时的 Handler 类，但我什么也想不通。处理程序如何工作？什么是一个整洁而流畅的运行实现？我更多地寻找实现这一目标的策略，而不一定是实现细节。

非常感谢您！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-09T04:17:15.290

首先，我会说我自己正在学习这个，但我已经设法让这个精确的设置在原型中工作。如果有人看到应该更改以在 Android 中更好地工作的东西，请务必告诉我。

其次，我使用空消息，以便我们拥有可以实际工作的代码。我认为创建消息对象是直截了当的。

# **第 1 部分 - 网络线程的 UI**

据我所知，Handler 是您需要的答案，但它不是全部。Deucalion 对 Looper 的评论是您接下来需要关注的地方。

[http://developer.android.com/reference/android/os/Looper.html](http://developer.android.com/reference/android/os/Looper.html)

```
class LooperThread extends Thread {
  public Handler mHandler;

  public void run() {
      Looper.prepare();

      mHandler = new Handler() {
          public void handleMessage(Message msg) {
              // process incoming messages here
          }
      };

      Looper.loop();
  }
} 
```

这个设置一开始是反直觉的，你需要在你的方法内部`Looper.prepare()`和`Looper.loop()`调用之间创建 Handler 对象。`run()`我不知道幕后的魔力，还没有机会在兔子洞里走得那么远。

**重要说明**：该示例显示了正在创建的匿名 Handler()。我强烈建议在您自己的类中子类化 Handler，然后使用它的实例。这只是可重用性的问题，很多网络代码最终都是一样的。

所以，重命名`LooperThread`为`NetworkThread`，或者任何你想要的名字，并将你的连接代码放在`run()`方法中，但在`Looper.prepare() / Looper.loop()`块之外（我不知道魔法是如何工作的，所以我只是假设这更好做的比把它放在里面）。

```
// process incoming messages here 
```

往往看起来像这样：

```
switch(msg.what)
{
    case 1:
        break;
    default:
        break
} 
```

LooperThread 示例有`public Handler mHandler;`，但我更喜欢将处理程序设为私有并创建一个方法来返回它。我这样做只是为了防止处理程序在建立网络连接之前无法访问。没有联系，与消息无关。

因此，在您的活动代码中的某处，您创建`NetworkThread`对象、运行它，然后从中获取处理程序。

```
NetworkThread network = new NetworkThread();
new Thread(network).run();
//Handler networkHandler = network.handler;
Handler networkHandler = network.getHandler(); 
```

然后，您只需根据需要向该处理程序发送消息。

```
networkHandler.sendEmptyMessage(1); 
```

* * *

# 第 2 部分 - 到 UI 的网络线程

有几种不同的方法来处理这个问题。您可以在 Activity 类中创建一个处理程序。所有活动都已经设置了 Looper，因此调用 Looper.prepare 和 Looper.loop 似乎会导致问题。

在我的代码中，我在`onCreate()`方法中创建了一个处理程序，然后将它传递给我的`NetworkThread`对象。可能有更好的地方来创建这个处理程序，我不知道如果您的应用程序被暂停然后稍后再次启动会发生什么`onResume()`或`onRestart()`

```
public NetworkThread(Handler mainHandler)
{
    this.mainHandler = mainHandler;
} 
```

然后在其他任何地方我需要向 UI 发送消息：

```
this.mainHandler.sendEmptyMessage(1); 
```

我更喜欢这种方法，因为执行实际工作的 Handler 代码要么存在于实际响应消息的类中（使用匿名 Handler 对象），要么存在于可能位于同一包中的 Handler 子类中。

您也可以将`Activity`or传递`View`给网络线程并从该 call`runOnUIThread(Runnable)`传递，但这需要您传递 Runnable。因此，在网络类中编写或引用了用于 UI 的代码。

* * *

## 更新

您也可以为此使用服务。当 Activity 和 Networking 具有相同的生命周期时，上述方法有效。如果我们只需要在 Activity 处于活动状态时进行网络连接。

如果您需要 Activity 生命周期之外的网络连接，例如在音乐流媒体应用中，那么使用 Service 将是更好的选择。看起来这并不是您要寻找的问题。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-16T19:34:52.017

[http://developer.android.com/reference/android/os/AsyncTask.html](http://developer.android.com/reference/android/os/AsyncTask.html)使用这个我也有很多处理程序的问题，但是异步任务为你处理了所有烦人的工作。确保使用 onPrexecute() 和 onPostExecute() 来更新 UI。希望这可以帮助。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-16T19:36:14.023

您可以`AsyncTask`在这种情况下使用。您可以在 UI 线程上调用它，并在 onPostExecute 中对消息执行您想要执行的操作。这比在那里做所有肮脏的网络工作要干净得多。

# java - 特殊的 Java 作用域

> ID：10180434
> 
> 赞同：6
> 
> 时间：2012-04-16T19:32:55.637
> 
> 标签：java, design-patterns, syntax, scope, initialization

我正在浏览 Android 源代码，只是在阅读它，我在`Android.Util.JsonReader`. 如下：

```
private final List<JsonScope> stack = new ArrayList<JsonScope>();
{
    push(JsonScope.EMPTY_DOCUMENT);
} 
```

这究竟是在做什么？也就是说，紧随其后的范围`new`？如果我理解正确，每当这个类`JsonReader`被实例化（不是静态的，对吗？），`stack`将在这里初始化，而不是通过`this.stack = ...`构造函数中的 a ，对吗？

那么作用域是做什么的呢？`stack`是在初始化之后执行的吗？对于这种模式的名称及其用途，我在这里有点困惑。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-16T19:34:51.683

它与新声明无关。它是一个初始化器，有点像一个未命名的无参数构造函数。

[http://docs.oracle.com/javase/specs/jls/se7/html/jls-8.html#jls-8.6](http://docs.oracle.com/javase/specs/jls/se7/html/jls-8.html#jls-8.6)

它们按文本顺序在类的构造函数之前执行

[http://docs.oracle.com/javase/specs/jls/se7/html/jls-12.html#jls-12.5](http://docs.oracle.com/javase/specs/jls/se7/html/jls-12.html#jls-12.5)

# google-maps - Google Maps API 静态地图越野标记

> ID：10180435
> 
> 赞同：0
> 
> 时间：2012-04-16T19:32:56.180
> 
> 标签：google-maps, google-maps-markers, google-static-maps

当我在越野位置放置带有地理编码的标记时，Google 总是将标记放在道路上。例子：

```
<http://maps.googleapis.com/maps/api/staticmap?\zoom=17&size=512x512&maptype=roadmap&markers=color:blue|label:S|52%2006.761,%205%2008.347&sensor=false> 
```

在普通的 Google 地图中，您会看到原始位置（绿色箭头）和放置标记的位置：http: [//g.co/maps/wc4vg](http://g.co/maps/wc4vg)

我怎样才能让标记离开道路？所以我希望我的标记位于我的 Google Maps API 中绿色箭头的位置。

也许静态地图不可能，但如果是这样，V3 API 有可能吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-16T23:27:31.147

使用 LatLng(52.112683,5.138950) 代替地址：[http ://maps.googleapis.com/maps/api/staticmap?zoom=17&size=512x512&maptype=roadmap&markers=color:blue|label:S|52.112683,5.138950&sensor=错误的](http://maps.googleapis.com/maps/api/staticmap?zoom=17&size=512x512&maptype=roadmap&markers=color:blue|label:S|52.112683,5.138950&sensor=false)

# c# - 从数据库打印多行

> ID：10180442
> 
> 赞同：0
> 
> 时间：2012-04-16T19:33:20.287
> 
> 标签：c#, sql, database, wml

从数据库中查询数据后，我使用数据读取器填充数组。如下。

```
connection.Open();
System.Data.SqlClient.SqlDataReader reader = command.ExecuteReader();
reader.Read();

_firstname = reader[0].ToString();
_Year = reader[1].ToString();
_coursename = reader[2].ToString();
_credits = reader[3].ToString();
_mark = reader[4].ToString();
_firstname2 = reader[5].ToString();

reader.Close(); 
```

我但结果显示如下

```
1 - Sam Bons 
2- 2012 
3- DDD 
4- 3 
5- 80 
```

如何执行循环以从数据库中获取**所有结果**并将其打印出来？

谢谢你

* * *

我这样做了**谢谢你，安**

```
result = string.Empty;
                int counter = 1;
                while (reader.Read())
                {
                    _firstname = reader[0].ToString();
                    _Year = reader[1].ToString();
                    _coursename = reader[2].ToString();
                    _credits = reader[3].ToString();
                    _mark = reader[4].ToString();

                    result += string.Format("{5} - {0}{1}{2}{3}{4} </br>  ",
                        _firstname,
                        _Year,
                        _coursename,
                        _credits,
                        _mark,
                        counter);
                    counter++;

                }
                Response.Write(result);

                reader.Close(); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-16T19:38:59.300

首先，正如您所说，您实际上并没有将任何东西放入数组中。您只是在设置看起来是局部变量的内容。

如果您的问题是关于循环的语法，它会是这样的：

```
while(reader.Read())
{
   // set your variables
   // do something with the variables
} 
```

把它放在你的 ExecuteReader 调用和你的 reader.Close() 调用之间。

# java - 迭代 null ArrayList 时出现 NullPointerException

> ID：10180444
> 
> 赞同：0
> 
> 时间：2012-04-16T19:33:37.650
> 
> 标签：java, arraylist, nullpointerexception

我在 2 个不同的环境中运行以下代码。第一个环境是 Eclipse 中的开发环境，Java 7 使用 Java 6 合规性来运行我的 webapp。另一个是我运行 Java 6 的开发服务器。以下代码在开发服务器上抛出 NullPointerException，但在我的开发环境中没有。有人可以解释为什么会这样吗？

```
List<String> list = null;
for(String s : list)
{
// do something
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-16T19:39:43.570

编写的代码每次都会抛出异常。确保代码在您的开发环境中正确编译。如果它运行成功，它正在运行不同版本的代码（可能是不抛出 NullPointerException 的旧版本的类）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-16T19:35:28.773

这将始终引发异常。更有可能的是，某些东西在一个环境中失败并且值为 null，而在另一个不为 null 的环境中没有失败。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-16T19:36:00.883

你在开玩笑吗？每次保证都会爆炸。

如果它“在其他地方运行时没有爆炸”，我保证您没有运行此代码。

# apache - OpenNLP 名称查找器

> ID：10180445
> 
> 赞同：9
> 
> 时间：2012-04-16T19:33:38.240
> 
> 标签：apache, nlp, data-mining, opennlp

我正在使用 OpenNLP 的[NameFinder](http://opennlp.apache.org/documentation/1.5.2-incubating/manual/opennlp.html#tools.namefind) API 示例文档。初始化 Name Finder 后，文档使用以下代码作为输入文本：

```
for (String document[][] : documents) {

  for (String[] sentence : document) {
    Span nameSpans[] = nameFinder.find(sentence);
    // do something with the names
  }

  nameFinder.clearAdaptiveData()
} 
```

但是，当我将它带入 Eclipse 时，“文档”（不是“文档”）变量给我一个错误，说*变量文档无法解析*。'documents' 数组变量引用的文档是什么？我是否需要初始化一个名为“documents”的数组，该数组包含 txt 文件以使此错误消失？

感谢您的帮助。

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2012-04-17T01:58:29.513

OpenNLP[文档](http://opennlp.apache.org/documentation/1.5.2-incubating/manual/opennlp.html#tools.namefind.recognition.api)指出输入文本应该被分割成文档、句子和标记。您提供的这段代码说明了如何处理多个文档。

如果您只有一个文档，则不需要第一个文档，只需包含句子数组的内部文档，该句子由标记数组组成。

要从文档创建句子数组，您可以使用 OpenNLP SentenceDetector，对于每个句子，您可以使用 OpenNLP Tokenizer 来获取标记数组。

您的代码将如下所示：

```
// somehow get the contents from the txt file 
//      and populate a string called documentStr

String sentences[] = sentenceDetector.sentDetect(documentStr);
for (String sentence : sentences) {
    String tokens[] = tokenizer.tokenize(sentence);
    Span nameSpans[] = nameFinder.find(tokens);
    // do something with the names
    System.out.println("Found entity: " + Arrays.toString(Span.spansToStrings(nameSpans, tokens)));
} 
```

[您可以从OpenNLP 文档](http://opennlp.apache.org/documentation/1.5.2-incubating/manual/opennlp.html)文档中了解如何使用 SentenceDetector 和 Tokenizer 。

# ios - Xcode/iOS：如何在向下滚动时隐藏导航和工具栏？

> ID：10180446
> 
> 赞同：10
> 
> 时间：2012-04-16T19:33:50.027
> 
> 标签：ios, xcode, toolbar, navigationbar

我想在我的 iPhone 上向下滚动时隐藏两个栏。当我向上滚动时，它们应该再次出现。我该如何处理？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-04-16T20:30:28.563

```
- (void)scrollViewWillBeginScroll :(UIScrollView *)scrollView {
      if (scrollView.contentOffset.y < lastOffset.y) {
                 [toolBar setHidden:YES];
                 [[[self navigationController] navigationBar] setHidden:YES];
      } else{
                 // unhide
      }
}

- (void)scrollViewDidScroll :(UIScrollView *)scrollView {
      /// blah blah
      lastOffset = scrollView.contentOffset;
} 
```

**注意**:`lastOffset`是一个`CGPoint`，它在你的头文件中：`@Interface`.

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2014-03-10T16:10:21.933

接受的答案对我不起作用，因为`scrollViewWillBeginScroll:`不是委托方法。

相反，我做

```
-(void)scrollViewWillBeginDragging:(UIScrollView *)scrollView
{
    [[NSNotificationCenter defaultCenter] postNotificationName:@"BarsShouldHide" object:self];

}

-(void)scrollViewDidEndDragging:(UIScrollView *)scrollView 
                 willDecelerate:(BOOL)decelerate
{
    if(!decelerate)
        [[NSNotificationCenter defaultCenter] postNotificationName:@"BarsShouldUnhide" 
                                                            object:self];
}

- (void)scrollViewDidEndDecelerating:(UIScrollView *)scrollView
{
    [[NSNotificationCenter defaultCenter] postNotificationName:@"BarsShouldUnhide"
                                                        object:self];
} 
```

应用程序对象中的任何地方都可以监听此通知，例如

```
- (void)viewDidLoad
{
    [super viewDidLoad];
    [[NSNotificationCenter defaultCenter] addObserverForName:@"BarsShouldHide" 
                                                      object:nil
                                                       queue:nil
                                                  usingBlock:^(NSNotification *note) {
        //hide tab bar with animation;
    }];
    [[NSNotificationCenter defaultCenter] addObserverForName:@"BarsShouldUnhide" 
                                                      object:nil
                                                       queue:nil
                                                  usingBlock:^(NSNotification *note) {
        //Unhide tab bar with animation;
    }];
} 
```

此代码将隐藏任何滚动条。如果您只想关闭，则与`locationOffset`已接受答案中的技巧相同。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-08-08T07:46:17.597

这是我在 Swift 中的解决方案；它工作得很好

```
func scrollViewDidScroll(scrollView: UIScrollView) {
    let navController: UINavigationController = self.navigationController!
    if self.collectionView.panGestureRecognizer.translationInView(self.view).y <= 0.0 {
        defaultCenter.postNotificationName("stuffShouldHide", object: self)
    } else {
        defaultCenter.postNotificationName("stuffShouldUnhide", object: self)
    }
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-12-08T10:00:27.663

你可能会检查这个，可从 iOS8 获得，我认为这与你正在寻找的相反......但值得检查，因为它是标准的，这就是 Safari 的工作方式。

> 迅速
> 
> var hidesBarsOnSwipe: 布尔
> 
> Objective-C
> 
> @property(nonatomic, readwrite, assign) BOOL hidesBarsOnSwipe 讨论
> 
> 当此属性设置为 YES 时，向上滑动会隐藏导航栏和工具栏。向下滑动再次显示两个条形。如果工具栏没有任何项目，即使在滑动之后它仍然可见。此属性的默认值为 NO。

# prolog - 如何比较Prolog中列表中的值？

> ID：10180447
> 
> 赞同：-1
> 
> 时间：2012-04-16T19:33:57.177
> 
> 标签：prolog

列表：Bag = [ (a, 1, 2), (b, 2, 3), (c, 3, 4)],

我想比较列表 a 中的 1*2、列表 b 中的 2*3 和列表 c 中的 3*4 的结果。并对结果和输出进行排序，如何在 PROLOG 中做到这一点？

谢谢你。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-16T20:18:01.327

您可以使用`sort/2`：

```
?- findall([Result, Name], 
        (member((Name, A, B), [(a, 3, 2), (b, 1, 3), (c, 3, 4)]),
         Result is A*B),Output), 
   sort(Output, SOutput).

SOutput = [[2, a], [6, b], [12, c]]. 
```

# android - 创建一个新位图并在其中绘制新像素

> ID：10180449
> 
> 赞同：8
> 
> 时间：2012-04-16T19:33:59.853
> 
> 标签：android, bitmap

我正在尝试制作一个应用程序，该应用程序将拍摄您通过 editText 指定的两张图片，比较两张图片上每个像素的颜色并创建一张新图片（位图）（您可以将其保存到 sd 卡），其中包含两张原图。

我在创建这个新位图时遇到问题。我怎样才能实现我的目标？我真的不知道该怎么做，我是先创建新位图然后写入它，还是先获取差异然后从中绘制位图？图片将是大约。300x300 像素。

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2012-04-16T20:07:29.687

这段代码只是我的想法，未经测试，但它应该让你走上正轨。

```
final int w1 = b1.getWidth();
final int w2 = b2.getWidth();
final int h1 = b1.getHeight();
final int h2 = b2.getHeight();
final int w = Math.max(w1, w2);
final int h = Math.max(h2, h2);

Bitmap compare = Bitmap.createBitmap(w, h, Config.ARGB_8888);

int color1, color2, a, r, g, b;

for (int x = 0; x < w; x++) {
    for (int y = 0; y < h; y++) {
        if (x < w1 && y < h1) {
            color1 = b1.getPixel(x, y);
        } else {
            color1 = Color.BLACK;
        }
        if (x < w2 && y < h2) {
            color2 = b2.getPixel(x, y);
        } else {
            color2 = Color.BLACK;
        }
        a = Math.abs(Color.alpha(color1) - Color.alpha(color2));
        r = Math.abs(Color.red(color1) - Color.red(color2));
        g = Math.abs(Color.green(color1) - Color.green(color2));
        b = Math.abs(Color.blue(color1) - Color.blue(color1));

        compare.setPixel(x, y, Color.argb(a, r, g, b));
    }
}
b1.recycle();
b2.recycle(); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-16T20:01:36.627

我会先创建位图并计算每个像素之间的差异，但欢迎您先计算差异然后使用 Bitmap.copyPixels，但我认为第一种方式更容易理解。这是一个例子：

```
// Load the two bitmaps
Bitmap input1 = BitmapFactory.decodeFile(/*first input filename*/);
Bitmap input2 = BitmapFactory.decodeFile(/*second input filename*/);
// Create a new bitmap. Note you'll need to handle the case when the two input
// bitmaps are not the same size. For this example I'm assuming both are the 
// same size
Bitmap differenceBitmap = Bitmap.createBitmap(input1.getWidth(), 
    input1.getHeight(), Bitmap.Config.ARGB_8888);
// Iterate through each pixel in the difference bitmap
for(int x = 0; x < /*bitmap width*/; x++)
{
    for(int y = 0; y < /*bitmap height*/; y++)
    {
        int color1 = input1.getPixel(x, y);
        int color2 = input2.getPixel(x, y);
        int difference = // Compute the difference between pixels here
        // Set the color of the pixel in the difference bitmap
        differenceBitmap.setPixel(x, y, difference);
    }
} 
```

# c# - XNA - Video 和 VideoPlayer 缺少命名空间？

> ID：10180452
> 
> 赞同：1
> 
> 时间：2012-04-16T19:34:14.737
> 
> 标签：c#, namespaces, xna

今天我尝试添加一些过场动画视频，但我什至无法识别变量。

如果我尝试访问 Microsoft.Xna.Framework.Media.Video 或 Microsoft.Xna.Framework.Media.VideoPlayer，它就会丢失。.Media 存在，但 Video/VideoPlayer 不存在我也不能使用“使用 Microsoft.Xna.Framework.Media;”。

如果我将完全相同的项目复制到 Microsoft 网站上的示例项目中，它会识别“Video”和“VideoPlayer”，但当然，由于命名空间错误、缺少内容和所有这些东西，其他一切都将不起作用。

我已经使用 XNA 和 .NET Frameworks 重新安装了完整的 SDK，但它仍然无法正常工作。

如果我创建一个新项目并将其复制到那里，它也不起作用，我错过了什么吗？除了使用 Microsoft.Xna.Framework.Media.Video 之外，我还需要其他东西吗？我比较了完整的项目，但根本找不到任何区别。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-16T20:24:06.320

您缺少对`Microsoft.Xna.Framework.Video.dll`.

这就是这两个类所在的位置。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-16T20:15:51.293

看起来您的项目缺少对程序集的引用：`Microsoft.Xna.Framework.dll`.

**更新：** Kendall Frey 是对的，虽然微软在[文档](http://msdn.microsoft.com/en-us/library/microsoft.xna.framework.media.videoplayer(v=xnagamestudio.40).aspx)中说`Video`和`VideoPlayer`类在`Microsoft.Xna.Framework.dll`，但这些信息是不正确的，这些类确实在`Microsoft.Xna.Framework.Video.dll`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-06-29T13:19:30.603

对不起，迟到的答案，但这可能会有所帮助..您可以尝试安装 nuget 包**directxtk_desktop_2015**这将解决问题。 [这](https://www.nuget.org/packages/directxtk_desktop_2015/)是参考链接。

# xcode - 为什么不提交对版本控制的更改......之前

> ID：10180453
> 
> 赞同：2
> 
> 时间：2012-04-16T19:34:15.793
> 
> 标签：xcode, git, version-control, methodology

我是新手开发人员，独自工作。我正在使用 Xcode 和 git 版本控制。可能我没有适当的组织和做错事，但我通常决定做承诺只是为了在我破坏一切之前提出安全点。在那一刻，我发现很难恰当地描述我已经完成的事情，但我确切地知道我接下来要尝试什么。所以当我做下一个参考点时，前一个参考点已经命名。

所以我的问题是 - 是否有一些版本控制方法，其中参考点由计划而不是事实来描述。为什么这可能是个坏主意？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-16T19:43:28.697

根据您“计划”做什么来描述提交的问题是您失去了对已完成内容的准确记录。假设您打算做某事，但这不起作用。因此，您回滚并尝试其他方法，并且有效。你承诺了，但现在你“计划”做的并不是实际完成的。

那时，您需要返回并编辑上一次提交的注释以描述您实际做了什么，否则可能会随着时间的推移丢失更改记录。此外，如果您在一个小组中工作，您几乎需要根据您实际所做的事情发表您的评论，以便团队的其他成员可以看到它并检查您所做的事情或改进它。

除非你打算从不参与团队项目，否则最好的办法就是咬紧牙关，弄清楚如何跟踪自上次提交以来你所做的事情。我在身边放了一支笔和记事本，这样我就可以跟踪变化。我也经常提交以防止忘记我在很长一段时间内所做的事情。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-16T20:00:58.163

ABC，永远承诺。虽然您可能正在为自己的项目工作，除了您自己，没有人对您负责，但通常最好是提交已经完成的事情而不是您计划做的事情。

分支旨在使您免于计划做的事情。创建一个名为“addnewscreen”的分支或您计划执行的任何操作。这样，您可以继续提交对新内容的所有小更改，而不会污染您的主分支。满意后，将其重新合并并为下一步创建一个新分支。

如果你遇到困难，[Pro-Git Book](http://progit.org/book/)已经帮助了我很多次，我已经数不清了。希望这对您也有帮助。祝你好运。

# c# - ASP.NET Intranet 网站将文本文件写入网络文件夹

> ID：10180454
> 
> 赞同：0
> 
> 时间：2012-04-16T19:34:18.647
> 
> 标签：c#, .net, file-io, permissions

我有一个需要编写文本文件的 Intranet 应用程序。该文本文件需要存在于网络共享文件夹中。我通过 UNC 名称“\\fileserver\subfolder\TEST.txt”访问它，当然我遇到了可怕的“访问路径被拒绝”错误。

我的 Intranet 网站在 IIS 6 上运行。我在 Intranet 上有另一个应用程序需要能够使用 Request.ServerVariables["AUTH_USER"] 访问已登录用户的帐户。我发现如果我启用对该站点的匿名访问，这将不起作用。我正在使用集成的 Windows 身份验证。如何为 Web 应用程序启用对我的网络共享文件夹的写访问权限？我想我不能在不破坏我的其他应用程序的情况下使用模拟。我可以对我的网站的这一部分（文件夹）做一些不会影响我的其他应用程序的事情吗？

我需要一步一步地在 IIS 和/或我要写入的网络文件夹的文件夹设置上执行操作以使其正常工作。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-16T19:47:37.123

有点黑客行为是模拟写入文件的代码部分。即您切换到有足够权限写入文件的用户。

有一个小的[`Impersonator`帮助类](http://www.codeproject.com/Articles/10090/A-small-C-Class-for-impersonating-a-User)，您可以使用它来执行此操作，例如：

```
... 
using ( new Impersonator( "myUsername", "myDomainname", "myPassword" ) )
{
   ...

   <code that executes under the new context>

   ...
}

... 
```

这种方法的缺点是你必须在某个地方存储用户名和密码，要么硬编码在你的代码中，要么在你的 web.config 文件中。从安全的角度来看，这两件事都可能很糟糕。

# javascript - 关闭事件的颜色框

> ID：10180456
> 
> 赞同：0
> 
> 时间：2012-04-16T19:34:23.013
> 
> 标签：javascript, jquery, jquery-ui, colorbox

我想解雇以下事件：

1.  单击提交按钮时，我想隐藏表单，执行 ajax 请求并显示成功或错误消息 1 秒钟，然后关闭颜色框。
2.  如果单击取消按钮而不做任何事情，则关闭颜色框。

到目前为止，我设法创建了以下演示：http: [//jsfiddle.net/2YdbH/31/](http://jsfiddle.net/2YdbH/31/)

ps：我不确定如何执行第 1 步。我正在显示#message，但我不确定如何在显示#message 1 秒后关闭颜色框。此外，我不知道单击取消时如何关闭颜色框。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-16T19:48:58.923

首先，给按钮一些识别名称，然后在点击时触发适当的操作。要关闭彩盒（假设我们谈论的是同一个彩盒），请使用它们的 close 方法，如下所示：

```
$('#cancel').bind('click', function(){
    $.colorbox.close();
});
$('#submit').bind('click', function(){
    $.ajax({ /* AJAX OPTIONS  */});
    setTimeout("$.colorbox.close();",1000);
}) 
```

# list - Haskell - 格式列表输出

> ID：10180457
> 
> 赞同：0
> 
> 时间：2012-04-16T19:34:23.233
> 
> 标签：list, haskell

```
testDatabase :: [Film]
testDatabase = [("Director 1","Film 1",2012,[]),("Director 2","Film 2",2,[])]

filmsByDirector :: String -> [Film]
filmsByDirector name = filter (\(a,_,_,_) -> a == name) testDatabase 
```

我从另一个函数调用它，我正在尝试格式化列表，以便可以看到如下输出：

```
Director: Director 1
Film Name: Film 1
Year: 2012
Ratings: 
```

有什么帮助吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-16T19:53:49.063

您需要一个接受字符串并将其转换为格式化字符串的函数。实现是直接格式化。

```
formatString :: Film -> String 
```

然后，您只需将此函数应用于`Film`您感兴趣的每个（通过 a `map`）并加入（`concat`）最终字符串以获得结果。

```
type Film = (String, String, Int, [Int])

testDatabase :: [Film]
testDatabase = [("Director 1","Film 1",2012,[]),("Director 2","Film 2",2,[])]

filmsByDirector :: String -> [Film]
filmsByDirector name = filter (\(a,_,_,_) -> a == name) testDatabase

formatString :: Film -> String
formatString (dir, film, year, rat) = "Director: " ++ (show dir) ++ "\nFilm Name: " ++ (show film) ++ "\nYear:" ++ (show year) ++ "\nRatings: " ++ concatMap (\r -> (show r) ++ " ") rat

formattedByDirector :: String -> String
formattedByDirector dir = concatMap formatString $ filmsByDirector dir

putStrLn $ formattedByDirector "Director 1" 
```

# javascript - 对象引用在变量声明之外仍然存在

> ID：10180458
> 
> 赞同：-1
> 
> 时间：2012-04-16T19:34:36.477
> 
> 标签：javascript, object, reference

我正在建立一个客户端数据集合以发布到服务器。使用 Add 按钮的 onClick 事件，我收集表单数据并将其存储在内部数组中。这是一些假的/示例代码，试图演示这个问题（不幸的是，我不能分享源代码）。

```
var getDataFromForm = (function() {
    var _internal = {}; /* Based on feedback, I think this is the reason for the behavior I'm experiencing */
    return function() {
      var form = {}; 
      /* Get the form data */
       _internal.name = form.name;
       _internal.id = form.id;
       return _internal; 
    };
}());

var internal = { vals: [] };

function onClick() {
   var newData = getDataFromForm();

   doAjaxValidation({
       success: function() {
           internal.vals.push(newData); /* All values in array have been updated to this newData reference on click */
           internal.vals.push( JSON.parse(JSON.stringify(newData)) ); /* ugly, but the reference is broken and future clicks work as expected */
           internal.vals.push( $.extend({}, newData) ); /* reference to the object is still persisted through jQuery's extend */
       }
   });

} 
```

我对为什么将`newData`引用交给`newData`每个按钮单击的新分配感到困惑。每个点击事件都是一个新的函数调用，并且（理论上）应该是一个与任何其他按钮点击`newData`无关的新对象。`newData`

我错过了什么？

编辑：此示例来自更大的代码块，我试图将其简化为最简单的表达式。显然，按原样，这不是一段功能代码。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-17T01:26:28.007

听起来好像您正在传递一个对象，并期待一个副本。

在 JavaScript 中，对象本身永远不会被复制到赋值中。它是一种*按值*的语言，但在对象的情况下，复制的值是对对象的引用。因此，`newData`从返回`getDataFromForm`将导致在 each 中复制对同一对象的引用`onClick`。

# c++ - 试图从函数返回 std::ifstream

> ID：10180460
> 
> 赞同：0
> 
> 时间：2012-04-16T19:34:47.883
> 
> 标签：c++

当我尝试使用此功能时，我在两次返回时收到错误消息。如果我将它们注释掉，我不会得到错误。有什么理由不应该这样做吗？

```
 std::ifstream bipgetConfigurationPath() {
    char bipacfFilename[256], bipacfFullPath[512];
    char *bipconfigPath;
    char *bipdefaultConfigFile;
    const char *bipdefaultConfigFileName;
    bipdefaultConfigFile = "./Resources/plugins/Xsaitekpanels/D2B_config.txt";
    bipdefaultConfigFileName = "D2B_config.txt";
    XPLMGetNthAircraftModel(0, bipacfFilename, bipacfFullPath);
    bipconfigPath = strstr(bipacfFullPath, bipacfFilename);
    strncpy(bipconfigPath, bipdefaultConfigFileName, sizeof(bipacfFilename));
    puts(bipacfFullPath);

    // Check if ACF-specific configuration exists
    std::ifstream bipcustomStream(bipacfFullPath);
    if (bipcustomStream.good()) {
        return bipcustomStream;
    } else {
        std::ifstream bipdefaultStream(bipdefaultConfigFile);
        if (bipdefaultStream.good()) {
            return bipdefaultStream;
        }

    }
} 
```

谢谢比尔

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-16T19:37:54.867

C++ 中的所有流类都通过制作它们的 copy-constructor 变得不可复制`private`。这意味着，您不能按值返回流对象。详细阅读[此](https://stackoverflow.com/questions/6010864/why-copying-stringstream-is-not-allowed)内容。故事的结局。

所以解决方案是将流对象作为引用传递给函数，并在函数中打开文件，然后从它返回，或者使用创建流对象`new`并从函数返回指向流对象的指针，但是如果你这样做，`delete`当你完成它时，你已经到了对象。我个人不会做其中任何一个。

我可能会将流和您想对对象执行的行为/工作封装在一个类中。

在 C++11 中，您可以使用`std::move`来移动流对象，因为流是可移动的。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-04-16T19:37:58.127

std::streams 不可复制。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-04-16T19:45:24.860

正如其他人所说，文件流不可复制。也许更像这样：

```
bool bipgetConfigurationPath(std::ifstream& ifs) {

    std::string bipdefaultConfigFileName("D2B_config.txt");

    // ...

    ifs.open(bipdefaultConfigFileName);
    return ifs.good();
} 
```

# ruby-on-rails - 如何为响应式设计创建文件？

> ID：10180463
> 
> 赞同：0
> 
> 时间：2012-04-16T19:35:00.927
> 
> 标签：ruby-on-rails, responsive-design

我有一个简单的控制器，它可以转到下面的视图`views/mobile/home/index.html.haml`

它有效，现在我正在尝试添加文件以`views/layouts/mobile`确保该站点响应移动设备和平板电脑的查看。

我应该为平板电脑创建一个新`index.html.haml`的并为平板电脑视图创建一个单独的吗？

另外，据我了解，我应该制作`index.html.haml`并`views/mobile/home/index.html.haml`拥有一个 yield 命令，以便在加载过程中的某个时刻加载正确版本的移动页面。我怎么做？

我当前的控制器非常基本，如下所示：

```
class Mobile::HomeController < ApplicationController
  def index

    respond_to do |format|
      format.html
    end
  end

  def create

  end
end 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-16T19:47:39.150

通常，响应式设计应该发生在 CSS 和 Javascript 级别。HTML 应该定义您正在显示的信息的语义结构，而不是视觉设计。相反，看看 TwitterBootstrap 等框架如何使用 CSS 媒体查询等处理响应式设计。

# php - 将附件移动到文件夹并使用电子邮件附加它们

> ID：10180464
> 
> 赞同：0
> 
> 时间：2012-04-16T19:35:01.767
> 
> 标签：php, upload, attachment, email-attachments

我有一个简单的页面，它通过 phpmailer 发送一封电子邮件和多个附件。我必须将多个附件附加到要发送的电子邮件消息中，并同时将这些文件上传到服务器，为此我使用以下循环：

```
 $MyUploads = array();

 foreach(array_keys($_FILES['attach']['name']) as $key)
 { $Location="uploads/";

 $name=$_FILES['attach']['name'][$key];
 $filePath = $Location . $name;
 $source = $_FILES['attach']['tmp_name'][$key]; // location of PHP's temporary file for 
 $tmp=$_FILES['attach']['tmp_name'][$key];

 if($mail->AddAttachment($source, $name))
  {if(move_uploaded_file($tmp, $filePath)){
 $MyUploads[] = $filePath;}
 else
 {$MyUploads[]='';
 echo "not uploaded";}
 }
 } 
```

问题是，当我使用函数 move_uploaded_file() 时，文件会上传到服务器文件夹，但不会与附件一起发送。当我注释掉这个功能时，附件会被发送。

无法找出，为什么这两个 dnt 一起工作。请任何身体帮助

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-17T11:36:27.550

这是发送附件的循环，并将它们移动到目标路径，以供进一步使用。我希望其他任何人都可以通过以下方式得到帮助：

```
$MyUploads = array();
$numFiles = count(array_filter($_FILES['attach']['name']));

for ($i = 0; $i < $numFiles; ++$i) {
    $target_path = 'uploads/' . basename($_FILES['attach']['name'][$i]);
    if(move_uploaded_file($_FILES['attach']['tmp_name'][$i], $target_path)) {
        echo "the file ".basename($_FILES['attach']['name'][$i])." has been uploaded<br />";
        $MyUploads[] = $target_path;
        echo $MyUploads;
        $mail->AddAttachment($target_path);
    }
} 
```

# api - IBM 的 Sterling Web Forms 是否有 API？

> ID：10180469
> 
> 赞同：1
> 
> 时间：2012-04-16T19:35:32.563
> 
> 标签：api

*Sterling Web Forms*是一个基于 Web 的消息传递系统，供大公司发送发票/订单/通知/等。从他们的 ERP 系统发送给供应商。

我有一个应用程序，它可以通过访问以编程方式发送给我的消息而受益。假设有一个与之交互的 API，那么它**在哪里公开记录？**

我感觉这是存在的，但我没有使用正确的 Enterprise-y 术语或产品名称进行搜索......

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-08T19:13:00.127

有一个名为 IBM Sterling Direct Connect 的 IBM 产品可能对您有很大帮助。

[http://www-947.ibm.com/support/entry/portal/documentation_expanded_list/software/other_software/sterling_connect:direct](http://www-947.ibm.com/support/entry/portal/documentation_expanded_list/software/other_software/sterling_connect:direct)

它有 .net 和 java 的文档

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-09T07:54:15.567

1.  [http://publib.boulder.ibm.com/infocenter/sb2bsvcs/v1r0/index.jsp](http://publib.boulder.ibm.com/infocenter/sb2bsvcs/v1r0/index.jsp)

“IBM Sterling B2B 服务用户指南”、“使用 IBM Sterling Web 表单”、“IBM Sterling Web 表单常见问题解答”

# java - 正则表达式帮助或替代方法

> ID：10180475
> 
> 赞同：0
> 
> 时间：2012-04-16T19:35:59.597
> 
> 标签：java

我有一个带有标签行的文件，如下所示。我有：

```
Pattern.compile("<(?:TIMEX TYPE|ENAMEX TYPE)=.+?>(.+?)</(?:TIMEX|ENAMEX)>"); 
```

如果两个标签都在一行上，这将获得我需要的数据。我的问题是处理以下几行：

```
<ENAMEX
TYPE="CITED">1</ENAMEX> 
```

如果标签中间有裂痕，则无法正常工作。因此，我正在寻求改进我的正则表达式的帮助，或者与非标准 xml 标签一起使用的替代方法。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-16T19:40:53.690

与其寻找 ' ' （单个空格），为什么不多次寻找任何空白？应该是'\s+'之类的东西。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-16T19:38:51.893

您需要[`Pattern.DOTALL`](http://docs.oracle.com/javase/6/docs/api/java/util/regex/Pattern.html#DOTALL)开关*和*空白 ( ) 的匹配项`"\\s+"`，而不是文字空间：

```
Pattern.compile("<(?:TIMEX\\s+TYPE|ENAMEX\\s+TYPE)=.+?>(.+?)</(?:TIMEX|ENAMEX)>", Pattern.DOTALL); 
```

此开关的 javadoc 摘录解释了该`DOTALL`开关：

> 在 dotall 模式下，表达式 . 匹配任何字符，包括行终止符。

另请注意，尽管它的名称，[`Pattern.MULTILINE`](http://docs.oracle.com/javase/6/docs/api/java/util/regex/Pattern.html#MULTILINE)开关*不会*在这里帮助你。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-16T20:10:15.157

只是举例给你一个替代方案。模式匹配之前的搜索替换可以帮助您。

```
 final static String NEWLINE = "\n";
    final static String SPACE = " ";

public static void main(String[] args) {

            String s = "<ENAMEX\n TYPE=\"CITED\">1</ENAMEX>";

    Pattern pattern = Pattern.compile("<(?:TIMEX TYPE|ENAMEX TYPE)=.+?>(.+?)</(?:TIMEX|ENAMEX)>");

            s = s.replaceAll(NEWLINE, SPACE);

            Matcher matcher = pattern.matcher(s);

    while (matcher.find()) {
        System.out.println("Start index: " + matcher.start());
        System.out.println("End index: " + matcher.end());
    }
} 
```

# android - 另一个活动中的选项卡 OnClickListener

> ID：10180484
> 
> 赞同：0
> 
> 时间：2012-04-16T19:36:26.913
> 
> 标签：android, class, android-tabhost, tabwidget, onclicklistener

**我的工具.java：**

```
protected void onCreate(Bundle savedInstanceState) {
// TODO Auto-generated method stub
super.onCreate(savedInstanceState);
setContentView(R.layout.tabtools);

Resources res = getResources();
TabHost tabHost = getTabHost();
TabHost.TabSpec spec;
Intent intent;

// TabDados
intent = new Intent().setClass(this, ToolDadosTubuCirc.class);
spec = tabHost.newTabSpec("dados")
        .setIndicator("Dados", res.getDrawable(R.drawable.icondados))
        .setContent(intent);
tabHost.addTab(spec);
// TabLegenda
intent = new Intent().setClass(this, ToolLegendaTubuCirc.class);
spec = tabHost
        .newTabSpec("legenda")
        .setIndicator("Legenda",
                res.getDrawable(R.drawable.iconlegenda))
        .setContent(intent);
tabHost.addTab(spec);
// TabCalcular
intent = new Intent().setClass(this, ToolCalcularTubuCirc.class);
spec = tabHost
        .newTabSpec("calcular")
        .setIndicator("Calcular",
                res.getDrawable(R.drawable.iconcalcular))
        .setContent(intent);
tabHost.addTab(spec);
// TabCorrente
tabHost.setCurrentTab(0);}} 
```

**我的 tabtools.xml**

```
<TabHost
xmlns:android="http://schemas.android.com/apk/res/android"
android:id="@android:id/tabhost"
android:layout_width="fill_parent"
android:layout_height="fill_parent"
android:layout_above="@+layout/rowLog"
android:layout_below="@+layout/rowLine" >

<LinearLayout
    android:layout_width="fill_parent"
    android:layout_height="fill_parent"
    android:orientation="vertical"
    android:padding="5dp" >

    <TabWidget
        android:id="@android:id/tabs"
        android:layout_width="fill_parent"
        android:layout_height="wrap_content" />

    <FrameLayout
        android:id="@android:id/tabcontent"
        android:layout_width="fill_parent"
        android:layout_height="fill_parent"
        android:padding="5dp" />

</LinearLayout> 
```

**第一个选项卡称为“ToolDadosTubuCirc.java”类，此活动具有以下代码：**

```
package br.com.mobile4you.engtools;

import android.app.Activity;
import android.os.Bundle;

public class ToolCalcularTubuCirc extends Activity {

    @Override
    protected void onCreate(Bundle savedInstanceState) {
        // TODO Auto-generated method stub
        super.onCreate(savedInstanceState);
        setContentView(R.layout.toolcalculartubucirc);

    }
} 
```

**如何在文件 onClickListener "ToolDadosTubuCirc.java" 中创建事件？我需要创建一个函数，当人们单击“calcular”选项卡时，它会填写一些测试数据，它应该填写“dados”选项卡。

**我有 3 个选项卡：tab1 = 数据；tab2 = 图例；tab3 = 计算。当前选项卡是“数据”。我需要检查用户何时单击“计算”选项卡以完成“数据”选项卡的所有字段。我不知道在其他活动（类）中为 TabDados 创建 onclickListener 事件。我不知道 tabhost 和 TabWidget 的 id。如何创建这个事件？谢谢！****

*如果我的 tabhost 的 id 是标准 android 并且我的 id 也是 TabWidget。我无法参加此活动。帮我。*

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-16T20:09:49.303

问题不清楚

“我需要创建一个功能，当人们单击选项卡时”。假设 mTab​​Widget 是您的 TabWidget 控件，并且 nTabOffset = 0，即您的 dados 选项卡的偏移量：

```
mTabWidget.getChildAt(nTabOffset).setOnClickListener(new OnClickListener() 
{
 @Override
 public void onClick(View v)
 {
   // TODO:
 }
}); 
```

TabHost 将实例化您的活动并调用 onCreate()。您将在那里初始化您的活动视图，但如果您希望选项卡单击事件重新启动某些数据更新，您可以通过上面的 onClick() 方法执行此操作，可能会发送在您的活动中注册的广播意图。

# sql - 为什么除法的时候一直是0

> ID：10180486
> 
> 赞同：0
> 
> 时间：2012-04-16T19:36:44.063
> 
> 标签：sql, sql-server, sql-server-2008, casting, sum

我有以下代码总是导致 0.00。我确定 weight_score 是一个实际数字。有人可以帮我格式化它，以便它产生一个十进制数。使用 SQL Server 2008，此代码在视图中。非常感谢！

```
CAST(SUM(weight_score * (45/100)) as decimal(10,2)) As avg_score 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-04-16T19:37:34.327

45/100 被隐含地视为一个 INT 除以另一个 INT，这导致一个 INT 四舍五入为 0。为每个 INT 添加一个小数以解决该问题。

```
CAST(SUM(weight_score * (45.0/100.0)) as decimal(10,2)) As avg_score 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-16T19:54:30.390

```
 45/100 is treated as INT.So change it to 45.0/100.0\. 
 select CAST(SUM(weight_score * (45.0/100.0)) as decimal(10,2)) As avg_score

 Even if you write the following code you will get 0
 select (45/100) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-16T20:06:39.897

如果要避免错误，可以使用 NULLIF 函数。

# android - 图像 ArrayList 中的 NullPointerException

> ID：10180489
> 
> 赞同：0
> 
> 时间：2012-04-16T19:37:01.973
> 
> 标签：android

我在下面注释的以下行中收到 NullPointerException。
有时我得到它（尤其是在第一次实例中），有时我没有。所以我试图一劳永逸地解决这个问题。
我从图像数据库中检索文件路径，然后对其使用位图解码。我确信数据库中有值。

谢谢你。

```
 ImageDB imagedb = new ImageDB(this);    
        imagedb.open();

        ArrayList<String> image_list = new ArrayList<String>();
        image_list.clear();

            if(imagedb.open() != null){
            Cursor tagcursor = imagedb.retrieveTag(tag);

             if(tagcursor.moveToFirst()){
                do{
                    image_list.add(tagcursor.getString(tagcursor.getColumnIndex(tag)));

                }       
                while(tagcursor.moveToNext());

                }

             tagcursor.close();
           imagedb.close();
            }

                if(image_list != null && !image_list.isEmpty()){ 
            Collections.shuffle(image_list);

    if(image_list.get(0).toString() != null){ // nullpointerexception here or below if I comment here

                imagepath = image_list.get(0).toString(); 
            }

        } 
```

这是堆栈跟踪，但它只是作为警告，程序仍在运行：

```
04-16 19:03:31.603: W/System.err(1355): java.lang.NullPointerException
04-16 19:03:31.613: W/System.err(1355):     at com.MucaaApps.imageUpdate.ImageService.setTag(ImageService.java:422)
04-16 19:03:31.613: W/System.err(1355):     at com.MucaaApps.ImageUpdate.imageService.setImageIcon(ImageService.java:377)
04-16 19:03:31.623: W/System.err(1355):     at com.MucaaApps.ImageUpdate.ImageService.onStart(ImageService.java:237)
04-16 19:03:31.623: W/System.err(1355):     at android.app.Service.onStartCommand(Service.java:306)
04-16 19:03:21.552: W/System.err(1355):     at android.app.ActivityThread.handleServiceArgs(ActivityThread.java:2873)
04-16 19:03:21.552: W/System.err(1355):     at android.app.ActivityThread.access$3500(ActivityThread.java:119)
04-16 19:03:21.552: W/System.err(1355):     at android.app.ActivityThread$H.handleMessage(ActivityThread.java:1926)
04-16 19:03:21.552: W/System.err(1355):     at android.os.Handler.dispatchMessage(Handler.java:99)
04-16 19:03:21.552: W/System.err(1355):     at android.os.Looper.loop(Looper.java:123)
04-16 19:03:21.552: W/System.err(1355):     at android.app.ActivityThread.main(ActivityThread.java:4363)
04-16 19:03:21.563: W/System.err(1355):     at java.lang.reflect.Method.invokeNative(Native Method)
04-16 19:03:21.563: W/System.err(1355):     at java.lang.reflect.Method.invoke(Method.java:521)
04-16 19:03:21.573: W/System.err(1355):     at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:860)
04-16 19:03:21.573: W/System.err(1355):     at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:618)
04-16 19:03:21.582: W/System.err(1355):     at dalvik.system.NativeStart.main(Native Method) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-16T19:51:07.280

简单的答案。您将值 null 添加到 ArrayList。

你可以这样修复它：

```
ImageDB imagedb = new ImageDB(this);
        imagedb.open();
        ArrayList<String> image_list = new ArrayList<String>();
        image_list.clear();

        if (imagedb.open() != null) {
            Cursor tagcursor = imagedb.retrieveTag(tag);

            if (tagcursor.moveToFirst()) {
                        final int index = tagcursor.getColumnIndex(tag)
                do {
                    final String val = tagcursor.getString(index);
                    if (val!=null){
                        image_list.add(val);
                    }

                } while (tagcursor.moveToNext());

            }

            tagcursor.close();
            imagedb.close();
        }

        if (image_list != null && !image_list.isEmpty()) {
            Collections.shuffle(image_list);

            if (image_list.get(0).toString() != null) { // nullpointerexception
                                                        // here or below if i
                                                        // comment here

                imagepath = image_list.get(0).toString();
            }

        } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-16T19:49:21.930

你正在洗牌。所以我的猜测是其中一个文件路径是空的，并且被随机打乱到导致空指针的第一个位置。

你可以在这里查看

```
String filePath = tagcursor.getColumnIndex(tag);
if (filepath == null || filepath.isEmpty()) [
  //get additional info from cursor ..row id etc to debug
} else {
  image_list.add(filepath);
} 
```

# java - 打开图形标签中提供的数据不会使用“赞”按钮呈现

> ID：10180490
> 
> 赞同：0
> 
> 时间：2012-04-16T19:37:10.690
> 
> 标签：java, facebook-like

我希望我的网页上的 Like 按钮能够像[这里](https://developers.facebook.com/docs/reference/plugins/like/ "这里")的那样呈现，它在评论框下方显示图像、标题和描述。我已经包含了必要的开放图标签，但是 Like 框只是基本的、开箱即用的标签，没有任何额外的开放图信息。这是我的代码，如您所见，我已经编辑了我的 FB 应用程序 ID，但除此之外，这就是我正在运行的代码：

```
<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en" id="facebook" class="no_js" xmlns:fb="http://ogp.me/ns/fb#" xmlns:og="http://ogp.me/ns#">
<head>
    <title>Facebook Test Page</title>
    <link ref="canonical" href="http://localhost/Fbtest.jsp" />
    <meta property="fb:app_id" content="<REDACTED>" />
    <meta property="og:title" content="Facebook Test Page" />
    <meta property="og:type" content="website" />
    <meta property="og:url" content="http://localhost/Fbtest.jsp" />
    <meta property="og:image" content="http://localhost/images/my_family.png" />
    <meta property="og:site_name" content="My Website" />
    <meta property="og:description" content="This is just a test page, for Facebook integration." />
</head>
<body>
    <div id="fb-root"><!-- The JS SDK requires the fb-root element in order to load properly. --></div>
    <script>
        window.fbAsyncInit = function() {
            FB.init({appId: '<REDACTED>', status: true, cookie: true, xfbml: true});
        };
        (function(d){
            var js, id = 'facebook-jssdk', ref = d.getElementsByTagName('script')[0];
            if (d.getElementById(id)) {return;}
            js = d.createElement('script'); js.id = id; js.async = true;
            js.src = "//connect.facebook.net/en_US/all.js";
            ref.parentNode.insertBefore(js, ref);
        }(document));
    </script>

    <h1>Facebook Test Page</h1>
    <p>Here is a picture of my family. This is just a test, for Facebook integration.</p>
    <img alt="My family" src="http://localhost/images/my_family.png"/>
    <p/>
    <fb:like></fb:like>
</body> 
```

我在 Windows 7/Intel 笔记本电脑上的 JBoss 5.1 上运行它，并且同时使用 IE9 和 Firefix 网络浏览器。

我感谢您的帮助！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-16T20:56:04.583

如果`http://localhost/Fbtest.jsp`实际上是您正在使用的值，这将不起作用 - Facebook 需要联系该 URL 以读取标签，因此它需要是一个可公开访问的 URL

# sorting - “<=>”运算符有什么用？

> ID：10180493
> 
> 赞同：1
> 
> 时间：2012-04-16T19:37:25.000
> 
> 标签：sorting, groovy, operators

> **可能重复：**
> [这个运算符叫什么以及它用于 <=>](https://stackoverflow.com/questions/5321745/what-is-this-operator-called-and-what-is-it-used-for)

我一直很好奇这种运算符“<=>”的类型和工作原理？

基本上，我一直在努力用 groovy 对我的收藏进行分类。由于某种原因，所有 java 和 groovy 集合排序函数都未能产生所需的结果。通过谷歌搜索，我发现了对我有用的排序闭包，闭包代码粘贴在下面：

```
blahblah.findAll{it -> (it.blahblah == "blahblah" || it.blahblah2 == "blahblah") && (it.blahblah == blahblah)}.sort{a,b -> a.id <=> b.id}*.blah() 
```

谁能澄清一下这是什么类型的操作员以及它是如何在背后工作以完成工作的？

# android - ListFragment 选择器选择所有项目

> ID：10180495
> 
> 赞同：1
> 
> 时间：2012-04-16T19:37:29.727
> 
> 标签：android, android-layout, android-listview, android-listfragment

我有这个 ListFragment，我以这种方式在我的 Activity 中调用它：

```
@Override
    protected void onCreate( Bundle savedInstanceState ) {

        super.onCreate( savedInstanceState );
        setTitle( getString(R.string.something) );

        if ( savedInstanceState == null ) {
            final FragmentManager fm = getSupportFragmentManager();
            final FragmentTransaction ft = fm.beginTransaction();
            final Fragment f = CustomerListFragment.newInstance();
            ft.add( android.R.id.content, f, FRAG_TAG_CUSTOMER_LIST );
            ft.commit();
        }

    } 
```

在我的片段上，我设置了单选：

```
getListView().setChoiceMode(ListView.CHOICE_MODE_SINGLE); 
```

在我的清单中，我为它设置了一个样式：

```
<activity android:name=".ui.CustomerListActivity" android:clearTaskOnLaunch="true" android:theme="@style/Theme.AppList"> 
```

主题定义如下：

```
<style name="Theme.AppList">
        <item name="android:windowContentOverlay">@null</item>
        <item name="android:windowBackground">@color/window_background</item>
        <item name="android:listViewStyle">@style/AppListView</item>
    </style>

    <style name="AppListView" parent="@android:style/Widget.ListView.White">
        <item name="android:dividerHeight">4dp</item>
        <item name="android:listSelector">@color/selector_color</item>
        <item name="android:ellipsize">marquee</item>
        <item name="android:cacheColorHint">@color/list_item</item>
        <item name="android:divider">@android:color/transparent</item>
    </style> 
```

和颜色：

```
<color name="list_item">@android:color/white</color>
    <color name="selector_color">#ffba00</color> 
```

但是，每当应用程序运行时，它看起来都很好，直到我长按一个项目或尝试拖动。然后所有元素都被选中，看起来像这样，而不是只选择一个元素。

所以问题是：如何使列表只选择 1 个元素而不是全部。

![在此处输入图像描述](../Images/0943724cec9ead4bb086a682cfbfbe56.png)

任何帮助将非常感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-16T19:43:19.963

您需要制作 listSelector`@android:color/transparent`并将单个行视图的选择器设置为`@color/selector_color`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-17T14:53:07.140

解决方案是实现一个选择器 xml，我在其中添加了列表项的所有状态：

```
<?xml version="1.0" encoding="utf-8"?>
<selector xmlns:android="http://schemas.android.com/apk/res/android" >
<item android:state_pressed="true" android:drawable="@drawable/bg_list_item_selected"></item>  <!-- pressed -->    
<item android:state_focused="true" android:drawable="@drawable/bg_list_item_selected"/>         <!-- focused -->
<item android:drawable="@drawable/bg_list_item"/>       <!-- default -->
</selector> 
```

选择器可绘制状态，其中 9 个补丁图像。然后在我定义行的 XML 上，我将布局背景设置为选择器，如下所示：

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout
    xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="match_parent"
    android:layout_height="?android:attr/listPreferredItemHeight"
    android:orientation="vertical"
    android:paddingLeft="@dimen/space_screen_borders"
    android:paddingRight="@dimen/space_screen_borders"
    android:background="@drawable/custom_selector" 
    > 
    ... your layout items 
</LinearLayout> 
```

清单活动如下：

```
<activity android:name=".ui.CustomerListActivity" android:clearTaskOnLaunch="true" android:theme="@style/Theme.AppList"> 
```

最后主题如下：

```
<style name="Theme.AppList">
   <item name="android:windowContentOverlay">@null</item>
   <item name="android:windowBackground">@color/window_background</item>
   <item name="android:listViewStyle">@style/AppListView</item>
</style>
<style name="AppListView" parent="@android:style/Widget.ListView.White">
    <item name="android:dividerHeight">4dp</item>
    <!--item name="android:background">@color/</item-->
    <item name="android:cacheColorHint">@color/list_item</item>
    <item name="android:divider">@android:color/transparent</item>
</style> 
```

然后列表视图将按预期显示，元素为白色背景，活动为蓝色背景，元素之间有 4dp 透明空间。

# ios - 如何使用 kAudioSessionProperty_OverrideCategoryMixWithOthers

> ID：10180500
> 
> 赞同：7
> 
> 时间：2012-04-16T19:37:51.653
> 
> 标签：ios, audio

当应用程序在后台时，我想让我的虚拟乐器应用程序能够被使用（通过 MIDI 键盘）。通过将 UIBackgroundModes 设置为“音频”并将 AudioSessions 的类别设置为 AVAudioSessionCategoryPlayback 可以正常工作。此外，为了允许与音乐播放器应用程序混合，我设置了属性 kAudioSessionProperty_OverrideCategoryMixWithOthers。

为节省电池电量，建议在不需要时让用户关闭后台操作。所以我的应用程序中有一个开关可以在 AVAudioSessionCategoryAmbient 类别和 AVAudioSessionCategoryPlayback 类别之间切换（使用 kAudioSessionProperty_OverrideCategoryMixWithOthers）。代码是这样的（省略错误处理）：

```
NSString *category = supportsBackgroundOperation ? AVAudioSessionCategoryPlayback : AVAudioSessionCategoryAmbient;

[session setCategory:category error:nil];

if (category == AVAudioSessionCategoryPlayback) {
    UInt32 allowMixing = true;
    AudioSessionSetProperty(kAudioSessionProperty_OverrideCategoryMixWithOthers, sizeof(allowMixing), &allowMixing);
} 
```

现在的问题是：假设音乐应用程序正在后台播放。用户正在前台（通过 MIDI 键盘）演奏虚拟乐器以配合音乐播放器，并决定启动另一个应用程序，例如幻灯片放映以享受演奏乐器的原因。所以他/她进入我的应用程序的设置视图并激活后台操作。然后执行上面的代码。砰，音乐应用程序变得安静。据我了解，kAudioSessionProperty_OverrideCategoryMixWithOthers 属性只能在设置类别**后**设置，但是当我将类别设置为 AVAudioSessionCategoryPlayback 时，系统会在我有机会设置 kAudioSessionProperty_OverrideCategoryMixWithOthers 之前将音乐播放器静音。

这是发生了吗？有什么可以做的吗？我试图在更改类别之前/之后停用/激活会话，但这会导致其他麻烦。

马库斯

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2013-03-26T12:29:26.437

从 iOS 6.0 开始，您可以使用

```
[[AVAudioSession sharedInstance] setCategory:AVAudioSessionCategoryPlayback withOptions:AVAudioSessionCategoryOptionMixWithOthers error:nil]; 
```

斯威夫特 5：

```
try? AVAudioSession.sharedInstance().setCategory(.playback, options: .mixWithOthers) 
```

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2012-05-28T14:17:55.583

你可以做到这一点。原则是先停用音频会话，设置音频会话的所有属性，然后激活音频会话。这样，在其他应用中播放的音乐不会被静音。

```
// Initialize audio session
AVAudioSession *audioSession = [AVAudioSession sharedInstance];

// Active your audio session
[audioSession setActive: NO error: nil];

// Set audio session category
[audioSession setCategory:AVAudioSessionCategoryPlayback error:nil];

// Modifying Playback Mixing Behavior, allow playing music in other apps
OSStatus propertySetError = 0;
UInt32 allowMixing = true;

propertySetError = AudioSessionSetProperty (
                       kAudioSessionProperty_OverrideCategoryMixWithOthers,
                       sizeof (allowMixing),
                       &allowMixing);

// Active your audio session
[audioSession setActive: YES error: nil]; 
```

这个解决方案对我有用。但是根据您的描述，您提到您确实在更改类别之前/之后尝试激活/停用会话，但会导致其他问题。您是否以与上述完全相同的方式进行停用/激活？如果是这样，请提供有关其他问题的更多信息，也许我可以提供帮助。

* * *

## 回答 #3

> 赞同：-6
> 
> 时间：2013-04-25T07:07:21.023

我不得不不同意 M0rph3v5。

withOptions 参数的唯一有效值是`AVAudioSessionInterruptionOptionShouldResume`

# grep - 如何使用引用查找 Java 方法调用的所有实例？

> ID：10180502
> 
> 赞同：0
> 
> 时间：2012-04-16T19:37:55.780
> 
> 标签：grep

我正在尝试以下查询，但没有成功

```
 grep -nr "[[:alnum:]]+\.[[:alnum:]]+\(\)" . 
```

因此，根据我的逻辑，方法调用将是一个或多个字母数字字符

```
 [[:alnum:]]+ 
```

后跟一个点

```
 \. 
```

后跟一个或多个字母数字字符

```
 [[:alnum:]]+ 
```

后跟括号（仅适用于 void 返回类型）

```
 \(\) 
```

但是这个查询不起作用。如何编写这样的查询？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-16T19:43:42.677

您需要使用“\+”而不是“+”，否则它将直接匹配字符“+”。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-16T20:18:57.640

`grep`提供了几种类型的正则表达式语法。
您编写的模式是扩展语法，并且`-E`
`extended-regexp`具有更简单/更好的语法，并且`perl-regexp`非常强大。

*   -E，--扩展正则表达式
*   -F，--固定字符串
*   -G, --basic-regexp（默认）
*   -P, --perl-正则表达式

* * *

```
grep -nrE "[[:alnum:]]+\.[[:alnum:]]+\(\)" . 
```

# caching - 利用浏览器缓存和 CSS 引用图像

> ID：10180503
> 
> 赞同：0
> 
> 时间：2012-04-16T19:37:56.917
> 
> 标签：caching, browser

我在这里的第一篇文章，在这里做了很多阅读，其中一些非常有帮助。然而，尽管有很多关于浏览器缓存的帖子，但似乎都没有涵盖我下面的观点。

我一直在更新我们的网站，并且（和许多人一样）遇到了这个与页面速度有关的杠杆浏览器缓存问题。现在，与其急于求成并更改我们的 .htacess 文件，还不如让用户在几周和几周内看到旧内容，我想我最好做一些阅读，花了半天时间做这些，我现在明白它是什么以及“破坏”缓存”。

我了解，如果我对 .css 文件或图像文件进行更改并且我使用了时间戳，它将更新，例如 top_nav.png?123456 更改为 top_nav.png?654321 这将被更新并重新缓存为浏览器会将其视为新资产。

但是，假设我们有一个本身未更新的 .css 文件，但 .css 文件中的其中一个图像已更新并且在没有时间戳的情况下被引用，从我所阅读的内容来看，浏览器仍将使用缓存版本！我对么..？

这是否意味着 .css 文件中的所有图像都带有时间戳，这意味着当图像更新时，实际上 .css 文件也会更新，导致浏览器重新加载 .css 文件，从而重新加载图像。

很抱歉这篇冗长的帖子，我只是想尽可能清楚地说明这一点。

在此先感谢，加里。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-16T20:00:40.400

您对强制客户端更新文件的名称更改是正确的。然而，缓存不是递归的；缓存的 .css 文件并不意味着它链接到的图像或其他内容也被缓存。

例如，假设我的 .htaccess 文件中有这个：

```
<filesMatch "\.(xml|txt|js|css)$">
    Header set Cache-Control "max-age=172800, public, must-revalidate"
</filesMatch> 
```

用户请求 index.html，它引用了一个 css 文件。该 css 文件还引用了一些背景 .jpg 图像。如果用户之前访问过该页面，css 文件将被缓存，但 .jpg 图像将被重新加载，因为它们未在 .htaccess 中设置为缓存。

# ruby-on-rails - HAML 从哪里加载它的模板？

> ID：10180506
> 
> 赞同：0
> 
> 时间：2012-04-16T19:38:13.123
> 
> 标签：ruby-on-rails, ruby, haml

我正在涉足一些现有的代码，并且能够像这样呈现一些 HAML：

```
.content_container
    %strong{:class => "code", :id => "message"} Hello World! 
```

但是当页面加载时，这个 HTML 会在现有布局中呈现，其中很多元素已经定义。

我查看了 HAML 教程建议我做的 config/settings/environment.rb，但没有提到任何其他 HAML 代码。

知道如何覆盖标题或找到预定义模板的位置吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-16T19:46:10.400

听起来模板正在使用布局呈现。查找`<app_root>/app/views/layouts/`您丢失的 HTML。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-16T19:45:22.860

HAML 喜欢`views`目录中具有`haml`扩展名的文件。

[文档](http://haml-lang.com/docs/yardoc/file.HAML_REFERENCE.html#plugin)说：

> ...所有带有“.html.haml”扩展名的视图文件都将使用 Haml 进行编译。

# django - Django 1.4：找不到静态文件

> ID：10180508
> 
> 赞同：3
> 
> 时间：2012-04-16T19:38:18.460
> 
> 标签：django

我尝试谷歌，但我无法解决我的问题。很多人都有这个问题并尝试按照他们的指示进行操作，但我仍然无法修复它。那么，我的配置有什么问题吗？

--- 设置.py ----

```
PROJECT_PATH = os.path.abspath(os.path.dirname(__file__))
STATIC_ROOT = os.path.join(PROJECT_PATH, 'static')
STATIC_URL = '/static/'

TEMPLATE_CONTEXT_PROCESSORS = (
"django.contrib.auth.context_processors.auth",
"django.core.context_processors.debug",
"django.core.context_processors.i18n",
"django.core.context_processors.media",
"django.core.context_processors.static",
"django.core.context_processors.tz",
"django.contrib.messages.context_processors.messages") 
```

---views.py---

```
render_to_response('authen/login.html',context_instance=RequestContext(request)) 
```

---login.html---

```
<link rel="stylesheet" type="text/css" href="{{ STATIC_URL }}styles/reset.css" />
<link rel="stylesheet" type="text/css" href="{{ STATIC_URL }}styles/root.css" /> 
```

- -错误 - -

```
[16/Apr/2012 21:27:26] "GET /authen/login.php HTTP/1.1" 200 1391
[16/Apr/2012 21:27:26] "GET /static/styles/reset.css HTTP/1.1" 404 1652
[16/Apr/2012 21:27:26] "GET /static/styles/root.css HTTP/1.1" 404 1649 
```

---urls.py---

```
if settings.DEBUG:
    urlpatterns += patterns('django.contrib.staticfiles.views',
        url(r'^static/(?P<path>.*)$', 'serve'),
    ) 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-16T20:27:51.137

您可能正在寻找：

[https://docs.djangoproject.com/en/1.4/ref/contrib/staticfiles/#static-file-development-view](https://docs.djangoproject.com/en/1.4/ref/contrib/staticfiles/#static-file-development-view)

更新：我看到你有静态文件的 url 模式。您在 settings.py 中有 DEBUG=True 吗？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-13T23:46:23.670

我有同样的问题，它找不到任何静态文件。但是随着 Sophy SEM 的评论（见上文），它起作用了：

而不是设置

```
STATIC_ROOT = os.path.join(SITE_ROOT, 'static') 
```

我已经设置

```
STATIC_ROOT = ''
STATICFILES_DIRS = ( os.path.join(SITE_ROOT, 'static'), ) 
```

然后，它奏效了。首先，我不敢相信它有什么不同，但是当我再次重新测试时，它很重要。

# php - PHP 多维数组

> ID：10180512
> 
> 赞同：1
> 
> 时间：2012-04-16T19:38:45.693
> 
> 标签：php, multidimensional-array

我有一个我想要发生的事情的逻辑结构或想法，我希望它使用数组在 PHP 中编码，这是场景：

10 次循环/每月出现次数

> **月 => 重复**

```
jan => 2
mar => 1
sep => 5
dec => 2 
```

如上所示，我有一个发生 10 次的循环，在该循环计数中记录了 4 个不同的月份，并且每个特定月份都有可能重复多次，例如月份 (sep) 已重复 5 次。这个想法与一个人记录他/她旅行的月份以及他/她在该月内旅行的次数（从 10 次记录的旅行中）的示例相同。知道如何使用数组在 PHP 中构建它吗？非常感谢任何建议或答案！

好的，这是我想要发生的事情，我从数据库中提取月份的记录，然后我想显示从数据库中提取的月份以及重复的次数，例如显示如下：

```
Jan (2)
Sep (5) 
```

我希望它是动态的，如果数据库记录中不存在某个月份，则不会显示它。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-16T19:57:28.940

我认为他正在尝试进行基本的频率分析。假设您以某种方式将日期输入数组，您可以继续使用**strtotime** ()、**date** () 函数生成键，然后解析它们。

首先，创建一些虚拟数据：

```
// dummy data; unsure of the format, so going with time()-like structure
$dates = array();
for( $i = 0; $i < 10; $i++ ) {
    $dates[] = strtotime(sprintf("%s-%s-2012", rand(1,30), rand(1,12) ));
} 
```

现在执行频率计数，以 date("M" ...) 编写的月份为键：

```
$freq = array();
foreach( $dates as $timestamp ) {
    // assuming it's all the same year, discover the month
    $month = date("M", $timestamp );

    if( !isset($freq[$month]) ) $freq[$month] = 0;
    $freq[$month]++;
} 
```

此时，您将拥有类似于您想要的东西：

```
print_r( $freq );

Array
(
    [Sep] => 2
    [Feb] => 2
    [Nov] => 1
    [Dec] => 1
    [Jan] => 2
    [Apr] => 1
    [May] => 1
) 
```

如果年份不同，您可能希望以某种方式或其他方式进行双重连接。

# python - Python 错误不支持的操作数类型

> ID：10180515
> 
> 赞同：0
> 
> 时间：2012-04-16T19:38:55.233
> 
> 标签：python, machine-learning

我正在尝试编写朴素贝叶斯分类器，但我不断收到此错误：

```
Traceback (most recent call last):
File "<pyshell#30>", line 1, in <module>
import naive_assignment
File "C:\Python27\naive_assignment.py", line 655, in <module>
main()
File "C:\Python27\naive_assignment.py", line 650, in main
pans.append(p.classify(row))
File "C:\Python27\naive_assignment.py", line 597, in classify
less50Kcp = less50Kcp + self.less_cat_probs.get(query[4])
TypeError: unsupported operand type(s) for +: 'float' and 'NoneType' 
```

我确定如何修复它，因为那里的大多数修复都说返回一些东西，但已经在代码中。

```
def classify(self, query):

    less50Knp = 0.0
    less50Kcp = 0.0
    great50Knp = 0.0
    great50Kcp = 0.0

    less50Knp = less50Knp +self.less_num_prob_dist(float(query[1])/100)
    less50Knp = less50Knp + self.less_num_prob_dist(float(query[3])/100)
    less50Knp = less50Knp + self.less_num_prob_dist(float(query[5])/100)
    less50Knp = less50Knp + self.less_num_prob_dist(float(query[11])/100)
    less50Knp = less50Knp + self.less_num_prob_dist(float(query[12])/100)
    less50Knp = less50Knp + self.less_num_prob_dist(float(query[13])/100)

    less50Kcp = less50Kcp + self.less_cat_probs.get(query[2])
    less50Kcp = less50Kcp + self.less_cat_probs.get(query[4])
    less50Kcp = less50Kcp + self.less_cat_probs.get(query[6])
    less50Kcp = less50Kcp + self.less_cat_probs.get(query[7])
    less50Kcp = less50Kcp + self.less_cat_probs.get(query[8])
    less50Kcp = less50Kcp + self.less_cat_probs.get(query[9])
    less50Kcp = less50Kcp + self.less_cat_probs.get(query[10])
    less50Kcp = less50Kcp + self.less_cat_probs.get(query[14])

    less50K_prob = less50Kcp * less50Knp

    great50Knp = great50Knp + self.great_num_prob_dist(float(query[1])/100)
    great50Knp = great50Knp + self.great_num_prob_dist(float(query[3])/100)
    great50Knp = great50Knp + self.great_num_prob_dist(float(query[5])/100)
    great50Knp = great50Knp + self.great_num_prob_dist(float(query[11])/100)
    great50Knp = great50Knp + self.great_num_prob_dist(float(query[12])/100)
    great50Knp = great50Knp + self.great_num_prob_dist(float(query[13])/100)

    great50Kcp = great50Kcp + self.great_cat_probs.get(query[2])
    great50Kcp = great50Kcp + self.great_cat_probs.get(query[4])
    great50Kcp = great50Kcp + self.great_cat_probs.get(query[6])
    great50Kcp = great50Kcp + self.great_cat_probs.get(query[7])
    great50Kcp = great50Kcp + self.great_cat_probs.get(query[8])
    great50Kcp = great50Kcp + self.great_cat_probs.get(query[9])
    great50Kcp = great50Kcp + self.great_cat_probs.get(query[10])
    great50Kcp = great50Kcp + self.great_cat_probs.get(query[14])

    great50K_prob = great50Kcp * great50Knp

    if less50K_prob > great50K_prob:
        return ' <=50K'

    elif less50K_prob < great50K_prob:
        return ' >50K'

    else:
        return 'unknown' 
```

我知道这不是最好的编码方式。调用它的主要函数是：

```
def main():

data = getInputData('./trainingset.txt')
test = getInputData('./queries.txt')

p = nbayes(data)
p.train()

pans = []

for row in test:
    pans.append(p.classify(row))
print("n-bayes")
print(pans)

main() 
```

有谁知道如何解决这个问题？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-16T19:45:09.240

`self.less_cat_probs.get(query[4])`显然评估为`None`- 您需要检查并避免它，或修复产生它的代码。

错误消息很好地解释了这一点——它抛出了一个不受支持的类型错误，并告诉你不能在给定的行上添加`float`a 。`NoneType`我们可以看到这`less50Kcp`是一个浮点数，另一个项目必须是`None`，因此错误，因为`None`它不是数字。

一个可能的修复 - 假设`self.less_cat_probs`是一个字典，将提供[`get()`](http://docs.python.org/py3k/library/stdtypes.html?highlight=dict#dict.get)一个默认值`0`，以便在找不到键时添加仍然有效。例如：

`less50Kcp = less50Kcp + self.less_cat_probs.get(query[4], 0)`

但是，有一个问题是，这是否是所需的功能 - 您可能希望确保在需要的地方有 dict 条目，并且可能希望在结果中重复此修复。

请注意，您给我们的代码是复制/粘贴编码的一个非常糟糕的例子——这会导致更多的错误、更难的维护、更多的错误和更多的打字。我强烈建议正确执行此操作，使用循环和数据结构减少重复代码，这将更容易发现错误。

# android - 使用数组 Android 中的随机字符串创建对话警报

> ID：10180518
> 
> 赞同：-1
> 
> 时间：2012-04-16T19:39:01.910
> 
> 标签：android, eclipse

我正在尝试为 andriod 编写一个应用程序（使用 eclipse），其中当按下图像按钮时，alertdialouge 会从数组中产生一个随机字符串，每次按下按钮时我都希望它更改数组中的字符串. 我编写了一个 alertdialouge 和一些获取随机字符串的代码，但它是针对文本视图而不是 alert dialouge 进行的。你能看看我的代码并告诉我我需要改变什么吗？

```
package kevin.erica.box;

import android.app.Activity;
import android.app.AlertDialog;
import android.os.Bundle;
import android.view.View;
import android.widget.TextView;
import java.util.Random;

public class TheKevinAndEricaBoxActivity extends Activity {
/** Called when the activity is first created. */
private String[] myString;
private String list;
private static final Random rgenerator = new Random();

@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.main);

    Resources res = getResources();

    myString = res.getStringArray(R.array.myArray); 

    list = myString[rgenerator.nextInt(myString.length)];

    TextView tv = (TextView) findViewById(R.id.textView1);
    tv.setText(list);
}

public void kevin(View view)
{
new AlertDialog.Builder(this).setTitle("The Box").setMessage(getResources().getText(R.string.list)).setNeutralButton("Close", null).show(); }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-16T19:59:43.710

据我了解，每当按下特定的 ImageButton 时，您都需要从数组中随机选择一个文本字符串。

试试下面的代码：

```
@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.main);
    Resources res = getResources();

   myString = res.getStringArray(R.array.myArray); 

   list = myString[rgenerator.nextInt(myString.length)];

   ImageButton ib = (ImageButton) findViewById(R.id.img_button_id);
   ib.setOnClickListener(new OnClickListener() {
       @Override
       public void onClick(View arg0) {
           AlertDialog.Builder b = new AlertDialog.Builder(TheKevinAndEricaBoxActivity.this);
           b.setMessage(myString[rgenerator.nextInt(myString.length)]);
           Dialog d = b.create();
           d.show();
       }
   });
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-16T19:54:36.220

```
{...

  list = myString[rgenerator.nextInt(myString.length)];

  TextView tv = (TextView) findViewById(R.id.textView1);
  tv.setText(list);
}

public void kevin(View view)
{
  new AlertDialog.Builder(this).setTitle("The Box").setMessage(getResources().getText(R.string.list)).setNeutralButton("Close", null).show(); 
}
...} 
```

R.string.list 是一个在运行时永远不会改变的静态字符串，它在 res/values/strings.xml 中定义

我会完全删除 TextView 并传入要在警报中显示的值。

```
{...

  String randomInt = myString[rgenerator.nextInt(myString.length)];
  showAlert(randomInt);
}

public void showAlert(String randomInt){
  new AlertDialog.Builder(this).setTitle("The Box").setMessage(
    "Here's a random number: " + randomInt
    ).setNeutralButton("Close", null).show(); 
}

...} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-16T19:54:37.157

您只需要更改 .setTitle() 或 .setMessage() 即可传入您的值。像这样的东西应该适合你：

```
 AlertDialog.Builder builder = new AlertDialog.Builder(this);
    builder.setMessage(list)
    .setCancelable(false)
    .setPositiveButton("Yes", new DialogInterface.OnClickListener() {
        public void onClick(DialogInterface dialog, int id) {
            // put your code here
        }
    })
    .setNegativeButton("No", new DialogInterface.OnClickListener() {
        public void onClick(DialogInterface dialog, int id) {
            // put your code here 
            dialog.cancel();
        }
    });
    AlertDialog alertDialog = builder.create();
    alertDialog.show(); 
```

如果您不尝试将所有链接的方法调用塞到一行中，则更容易理解正在发生的事情。

此外，您似乎获得了这两个向后的变量名称：

```
private String[] myString;
private String list; 
```

# python - 使用 python PYPI 包中的命令行工具

> ID：10180520
> 
> 赞同：1
> 
> 时间：2012-04-16T19:39:15.747
> 
> 标签：python

这是一个我找不到答案的新手问题，我从 python PYPI 下载了一个包，我能够使用包中的所有模块，但是在我注意到的文档中，有一些命令行工具，可以对我来说非常有用，所以我想知道是否有人知道我可以如何使用这些工具。 [http://packages.python.org/macholib/scripts.html#macho-find](http://packages.python.org/macholib/scripts.html#macho-find)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-16T19:49:05.017

如果您使用 normal`python setup.py install`或 with安装`pip install ...`，您应该已经发现脚本在您的路径上。对于这个库，看起来提供了三个：

[设置.cfg](http://download.ag-projects.com/SipClient/python-backports-1.0.0.tar.gz)

```
console_scripts = 
    macho_find = macholib.macho_find:main
    macho_standalone = macholib.macho_standalone:main
    macho_dump = macholib.macho_dump:main 
```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-04-16T19:40:29.913

将模块用作命令行工具的标准方法是使用`-m`开关。例如，使用`timeit`模块计时一小段代码：

```
python -m timeit "range(0, 10)" 
```

然后给出：

```
1000000 loops, best of 3: 0.339 usec per loop 
```

来自`python -h`：

> -m mod：将库模块作为脚本运行（终止选项列表）

# asp.net - 如何在 asp.net 中使用实体框架保存相关实体

> ID：10180524
> 
> 赞同：2
> 
> 时间：2012-04-16T19:39:33.300
> 
> 标签：asp.net, asp.net-mvc, orm, entity-framework-4.1, entity-relationship

我对实体框架很陌生。我收到一个错误

> 具有临时 EntityKey 值的对象不能附加到对象上下文

我想我做错了什么。

我有一个`Customer`表和`Address`表，其中`Address`表具有客户 ID 作为外键。

我想向客户实体添加一个新地址并保持会话状态，并且在下次通话中我想保存它。这只是一个例子。

```
using (var db = new MyModel())
{
    Customer cust = db.Customers.SingleOrDefault(c => C.ID == 1);
    Address addr = new Address();
    addr.Street = "123 super st";
    cust.Addresses.Add(addr);   
    Session["customer"] = cust;         
}   

Customer SessionCustomer = (Customer)Session["customer"];
Customer.Comments = "Added new address"; 

using (var db = new MyModel())
{
    db.Customers.Attach(SessionCustomer); //This throws exception: An object with a temporary EntityKey value cannot be attached to an object context
    db.ObjectStateManager.ChangeObjectState(SessionCustomer, System.Data.EntityState.Modified);
    db.SaveChanges(); 
} 
```

任何帮助表示赞赏。谢谢你。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-16T20:02:35.147

尝试使用`db.Customers.AddObject()`将对象重新附加到数据上下文。
也看看这个：http: [//msdn.microsoft.com/en-us/library/system.data.objects.objectcontext.addobject.aspx](http://msdn.microsoft.com/en-us/library/system.data.objects.objectcontext.addobject.aspx)

干杯

# grails - Grails RabbitMQ ImmediateAcknowledgeAmqpException

> ID：10180528
> 
> 赞同：1
> 
> 时间：2012-04-16T19:39:50.333
> 
> 标签：grails, plugins, rabbitmq

我正在尝试使用 RabbitMQ 插件，无论我做什么我都会得到一个 org.springframework.amqp.ImmediateAcknowledgeAmqpException: Recovered message force ack (如果 ack 模式需要它):...

我正在使用 AMQP 模板使用纯 Spring 应用程序发送 AMQP 消息，并尝试在 Grails 2.0.3 应用程序中处理消息。有什么我想念的吗？我能做些什么来摆脱这个错误？

亲切的问候，马可

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-28T10:20:51.137

我有一个类似的问题。但后来我意识到我错误地命名了我的 handleMessage 方法。我的监听器类（我只是在学习！）现在看起来像这样，并且没有显示 ImmediateAcknowledgeAmqpException。

```
class ListenerService {

static rabbitQueue = 'sub'
    def handleMessage(message) {
        println "Message received"
    }
 } 
```

# xamarin.ios - 在 ParentViewController.View.AddSubview 之后视图不可访问

> ID：10180533
> 
> 赞同：2
> 
> 时间：2012-04-16T19:40:20.740
> 
> 标签：xamarin.ios

我正在使用 Monotouch 开发 iPad 应用程序。

这是我的场景：

我创建了选项卡式基础应用程序。例如 Home、Admin、Reports....等 Home 选项卡是 UIViewController。

我想要主页选项卡内的三个部分：例如类别（带有导航控件的表视图（使用导航的原因，因为我们在类别中有子类别），在类别表旁边，选定类别的项目（其他表视图）和右侧是选定的详细视图物品。

这就是我所做的......

动态创建两个 tableview 控制器并添加到主视图控制器。

HomeViewController.cs：

```
 public override void ViewDidLoad ()
    {
        base.ViewDidLoad ();

         RootViewController rvc = new RootViewController("",UITableViewStyle.Grouped);

        // navigation controller will manage the views displayed and provide navigation buttons
        navigationController = new UINavigationController();
        navigationController.PushViewController(rvc, false);
        navigationController.TopViewController.Title ="Category";

        navigationController.View.Frame = new RectangleF (0, 50, (50), (600));

        // Main window to which we add the navigation controller to
         this.View.AddSubview(navigationController.View);

        itemtable.Delegate = new TableViewDelegate (list);
        itemtable.DataSource = new TableViewDataSource (list);

        // Perform any additional setup after loading the view, typically from a nib.
    } 
```

==================================================== ===

根视图控制器：

```
using System;
using System.Collections.Generic;
using System.Linq;
using MonoTouch.Foundation;
using MonoTouch.UIKit;
using System.Drawing;

namespace DVPNTN_MobileApp
{
[MonoTouch.Foundation.Register("RootViewController")]
public partial class RootViewController : UITableViewController
{
    public List<string> RootData = new List<string> { "Group1", "Group2" };
    MonoTouch.UIKit.UINavigationController navigationControllerItem;
    string SelectedGroup;

    // Allow us to set the style of the TableView
    public RootViewController(string selectedGroup, UITableViewStyle style) : base(style)
    {
        this.SelectedGroup = selectedGroup; 
    }

    class DataSource : UITableViewDataSource
    {
        static NSString kCellIdentifier = new NSString ("MyIdentifier");
        RootViewController tvc;

        public DataSource (RootViewController tvc)
        {
            this.tvc = tvc;
        }

        public override int RowsInSection (UITableView tableView, int section)
        {
            return tvc.RootData.Count;
        }

        public override UITableViewCell GetCell (UITableView tableView, NSIndexPath indexPath)
        {
            var cell = tableView.DequeueReusableCell (kCellIdentifier);

            if (cell == null)
            {
                cell = new UITableViewCell (UITableViewCellStyle.Default, kCellIdentifier);
            }

            cell.TextLabel.Text = tvc.RootData.ElementAt(indexPath.Row);
            cell.Accessory = UITableViewCellAccessory.DetailDisclosureButton;
            return cell;
        }
    }

    class TableDelegate : UITableViewDelegate
    {
        RootViewController tvc;
        SubGroupViewController sgvc;

        public TableDelegate (RootViewController tvc)
        {
            this.tvc = tvc;
        }

        public override void RowSelected (UITableView tableView, NSIndexPath indexPath)
        {
            string selectedGroup = tvc.RootData.ElementAt(indexPath.Row);

            sgvc = new SubGroupViewController(selectedGroup, UITableViewStyle.Grouped);

            tvc.NavigationController.PushViewController(sgvc,true);
            //tvc.View.RemoveFromSuperview();
            //tvc.DidReceiveMemoryWarning();
            GC.Collect();
        }
    }

    public override void DidReceiveMemoryWarning ()
    {
        // Releases the view if it doesn't have a superview.
        base.DidReceiveMemoryWarning ();

        // Release any cached data, images, etc that aren't in use.
    }
    public override void ViewDidLoad ()
    {
        base.ViewDidLoad ();

        TableView.Delegate = new TableDelegate (this);
        TableView.DataSource = new DataSource (this);

        RootVIewItemController rvc1 = new RootVIewItemController(SelectedGroup,UITableViewStyle.Grouped);

        // navigation controller will manage the views displayed and provide navigation buttons
        navigationControllerItem = new UINavigationController();

        navigationControllerItem.PushViewController(rvc1, false);
        navigationControllerItem.TopViewController.Title = SelectedGroup + " " + "Item List";

            navigationControllerItem.View.Frame = new RectangleF (0, 300, (50),(700));

         //this.View.AddSubview(navigationControllerItem.View);
        //rvc1.View.EnableInputClicksWhenVisible = true;

        //this.ParentViewController.AddChildViewController(navigationControllerItem);
**> Problem is here --- subview is successfully added to parent view but it's not accessible, mean items are there but we can't touch cell or row???????**
        ParentViewController.View.AddSubview(navigationControllerItem.View);

        GC.Collect();
    }
    public override bool ShouldAutorotateToInterfaceOrientation (UIInterfaceOrientation toInterfaceOrientation)
    {
        // Return true for supported orientations
        return true;

    }

} 
```

}

****** *** ** *** ** ***项目*****视图**控制器 ******* *******

 ***```
using System;
using System.Collections.Generic;
using System.Linq;
using MonoTouch.Foundation;
using MonoTouch.UIKit;

namespace DVPNTN_MobileApp
{
[MonoTouch.Foundation.Register("RootVIewItemController")]
public partial class RootVIewItemController : UITableViewController
{

    public List<string> RootData = new List<string> { "Item 1", "Item 2", "Item 3", "Item 4" };
    string SelectedGroup;

    public RootVIewItemController (string selectedGroup, UITableViewStyle style) : base (style)
    {
        this.SelectedGroup = selectedGroup; 
    }

    class DataSource : UITableViewDataSource
    {
        static NSString kCellIdentifier = new NSString ("MyIdentifier");
        RootVIewItemController tvc;

        public DataSource (RootVIewItemController tvc)
        {
            this.tvc = tvc;
        }

        public override int RowsInSection (UITableView tableView, int section)
        {
            return tvc.RootData.Count;
        }

        public override UITableViewCell GetCell (UITableView tableView, NSIndexPath indexPath)
        {
            var cell = tableView.DequeueReusableCell (kCellIdentifier);

            if (cell == null)
            {
                cell = new UITableViewCell (UITableViewCellStyle.Default, kCellIdentifier);
            }

            cell.TextLabel.Text = tvc.RootData.ElementAt(indexPath.Row);
            //cell.Accessory = UITableViewCellAccessory.DetailDisclosureButton;

            return cell;
        }
    }

    class TableDelegate : UITableViewDelegate
    {
        RootVIewItemController tvc;
        SubGroupViewController sgvc;

        public TableDelegate (RootVIewItemController tvc)
        {
            this.tvc = tvc;
        }

        public override void RowSelected (UITableView tableView, NSIndexPath indexPath)
        {
            string selectedGroup = tvc.RootData.ElementAt(indexPath.Row);
            Console.WriteLine(
                "TableViewDelegate.RowSelected: Label={0}",selectedGroup);

            /*
            if(sgvc == null)
                sgvc = new SubGroupViewController(selectedGroup, UITableViewStyle.Grouped);

            tvc.NavigationController.PushViewController(sgvc,true);*/
        }
    }

    public override void ViewDidLoad ()
    {
        base.ViewDidLoad ();

        TableView.Delegate = new TableDelegate (this);
        TableView.DataSource = new DataSource (this);
    }

    public override void DidReceiveMemoryWarning ()
    {
        // Releases the view if it doesn't have a superview.
        base.DidReceiveMemoryWarning ();

        // Release any cached data, images, etc that aren't in use.
    }
} 
```

}

* * *

问题：

*   这是做这种情况的正确方法吗？
*   它工作正常，但是当我们将项目视图添加到父视图控制器时，它无法访问，意味着项目列表在那里但单元格不可访问，我们无法触摸单元格并提升甚至滚动或滚动。

请问有人可以帮助我吗？

谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-23T05:14:42.050

我不完全确定你想做什么。我做了最好的猜测，并创建了一个包含两种解决方案的样本。每个选项卡一个解决方案。第一个使用内置的拆分视图控制器。我已经阅读了几个地方 UISplitViewController 必须是应用程序的根。我通过将其添加为选项卡控件的子项来打破该规则。

第二个创建拆分控件的自定义版本。

```
using System;
using System.Collections.Generic;

using MonoTouch.Foundation;
using MonoTouch.UIKit;
using System.Drawing;

namespace delete04223
{
    [Register ("AppDelegate")]
    public partial class AppDelegate : UIApplicationDelegate
    {
        // class-level declarations
        UIWindow window;
        UITabBarController tabBarController;

        public override bool FinishedLaunching (UIApplication app, NSDictionary options)
        {
            // create a new window instance based on the screen size
            window = new UIWindow (UIScreen.MainScreen.Bounds);

            var viewController1 = new MyUISplitViewController ();
            var viewController2 = new MyUISplitViewController2 ();
            tabBarController = new UITabBarController ();
            tabBarController.ViewControllers = new UIViewController [] {
                viewController1,
                viewController2,
            };

            window.RootViewController = tabBarController;
            // make the window visible
            window.MakeKeyAndVisible ();

            return true;
        }
    }

    public class MyUISplitViewController : UISplitViewController
    {
        public MyUISplitViewController ()
        {
            this.Title = "Native Split View";
        }

        public override void ViewDidLoad ()
        {
            base.ViewDidLoad ();

            var viewController1 = new LeftViewController ();
            var viewController2 = new DummyViewController ("Pane 1", "Pane 1");
            this.ViewControllers = new UIViewController [] {viewController1, viewController2};
            this.WeakDelegate = viewController2;

        }

        public override bool ShouldAutorotateToInterfaceOrientation (UIInterfaceOrientation toInterfaceOrientation)
        {
            return true;
        }
    }

    public class MyUISplitViewController2 : UIViewController
    {
        public MyUISplitViewController2 ()
        {
            this.Title = "Custom Split View";
        }

        public override void ViewDidLoad ()
        {
            base.ViewDidLoad ();

            var viewController1 = new LeftViewController ();
            var viewController2 = new DummyViewController ("Pane 1", "Pane 1");

            this.AddChildViewController (viewController1);
            this.AddChildViewController (viewController2);

            this.View.AddSubview (viewController1.View);
            this.View.AddSubview (viewController2.View);
        }

        public override void ViewDidLayoutSubviews ()
        {
            base.ViewDidLayoutSubviews ();

            RectangleF lRect = this.View.Frame;
            RectangleF rRect = lRect;

            lRect.Width = .3f * lRect.Width;
            rRect.X = lRect.Width + 1;
            rRect.Width = (.7f * rRect.Width)-1;

            this.View.Subviews[0].Frame = lRect;
            this.View.Subviews[1].Frame = rRect;
        }

        public override bool ShouldAutorotateToInterfaceOrientation (UIInterfaceOrientation toInterfaceOrientation)
        {
            return true;
        }
    }

    public class LeftViewController : UINavigationController
    {
        public LeftViewController ()
        {

        }

        public override void ViewDidLoad ()
        {
            base.ViewDidLoad ();    

            MyUITableViewController table = new MyUITableViewController (this);

            this.PushViewController (table, false);
        }

        public override bool ShouldAutorotateToInterfaceOrientation (UIInterfaceOrientation toInterfaceOrientation)
        {
            return true;
        }

        public override UIViewController PopViewControllerAnimated (bool animated)
        {
            return base.PopViewControllerAnimated (true);
        }
    }

    public class DummyViewController : UIViewController
    {
        string _myLabelText = "";
        UIToolbar _toolbar;

        public DummyViewController (string viewName, string labelText)
        {
            this.Title = viewName;  
            this._myLabelText = labelText;
            this.View.BackgroundColor = UIColor.White;
        }

        public override bool ShouldAutorotateToInterfaceOrientation (UIInterfaceOrientation toInterfaceOrientation)
        {
            return true;
        }

        public override void ViewDidLoad ()
        {
            base.ViewDidLoad ();

            float center = this.View.Frame.Width / 2f;
            UILabel label = new UILabel (new RectangleF (center - 50, 100, 100, 40));
            label.Text = this._myLabelText;
            label.TextAlignment = UITextAlignment.Center;
            label.AutoresizingMask = UIViewAutoresizing.FlexibleMargins;

            RectangleF rect = this.View.Frame;
            rect.Y = 0;
            rect.Height = 44;
            _toolbar = new UIToolbar (rect);
            _toolbar.AutoresizingMask = UIViewAutoresizing.FlexibleWidth;

            this.View.AddSubview (label);
            this.View.AddSubview (_toolbar);
        }

        [Export("splitViewController:willHideViewController:withBarButtonItem:forPopoverController:")]
        public void WillHideViewController (UISplitViewController svc, UIViewController vc,
            UIBarButtonItem barButtonItem, UIPopoverController pc)
        {
            barButtonItem.Title = "Menu";
            var items = new List<UIBarButtonItem> ();
            items.Add (barButtonItem);
            if (_toolbar.Items != null) 
                items.AddRange (_toolbar.Items);
            _toolbar.SetItems (items.ToArray (), true);
            //popoverController = pc;
        }

        [Export("splitViewController:willShowViewController:invalidatingBarButtonItem:")]
        public void WillShowViewController (UISplitViewController svc, UIViewController vc,
            UIBarButtonItem button)
        {
            // Called when the view is shown again in the split view, invalidating the button and popover controller.
            var items = new List<UIBarButtonItem> (_toolbar.Items);
            items.RemoveAt (0);
            _toolbar.SetItems (items.ToArray (), true);
            //popoverController = null;
        }
    }

    internal class MyUITableViewController : UITableViewController
    {
        static NSString kCellIdentifier = new NSString ("MyIdentifier");
        LeftViewController _parent;

        public MyUITableViewController (LeftViewController parent) : base (UITableViewStyle.Plain)
        {
            this.TableView.WeakDelegate = this;
            this.TableView.WeakDataSource = this;
            this._parent = parent;
        }

        [Export ("tableView:numberOfRowsInSection:")]
        public int RowsInSection (UITableView tableView, int section)
        {
            if (section == 0)
                return 2;

            return 3;
        }

        [Export ("tableView:cellForRowAtIndexPath:")]
        public UITableViewCell GetCell (UITableView tableView, NSIndexPath indexPath)
        {
            var cell = tableView.DequeueReusableCell (kCellIdentifier);

            if (cell == null)
            {
                cell = new UITableViewCell (UITableViewCellStyle.Default, kCellIdentifier);
            }

            cell.TextLabel.Text = GetRowName (indexPath);

            return cell;
        }

        private string GetRowName (NSIndexPath indexPath)
        {
            string ret;
            if (indexPath.Section == 0)
            {
                ret = 
                    indexPath.Row == 0 ? "Row A" : "Row B";
            }
            else
            {
                ret = 
                    indexPath.Row == 0 ? "Row D" : 
                        indexPath.Row == 1 ? "Row E" : "Row F"; 
            }   

            return ret;
        }

        [Export ("numberOfSectionsInTableView:")]
        public int NumberOfSections (UITableView tableView)
        {
            return 2;
        }

        [Export ("tableView:titleForHeaderInSection:")]
        public string TitleForHeader (UITableView tableView, int section)
        {
            if (section == 0)
                return "One";

            return "Two";
        }

        [Export ("tableView:didSelectRowAtIndexPath:")]
        public virtual void RowSelected (UITableView tableView, NSIndexPath indexPath)
        {
            Console.WriteLine("Item Selected: Section={0}, Row={1}",indexPath.Section, indexPath.Row);  
            this._parent.PushViewController (new MySubUITableViewController (), true);
        }

        public override bool ShouldAutorotateToInterfaceOrientation (UIInterfaceOrientation toInterfaceOrientation)
        {
            return true;
        }
    }

    internal class MySubUITableViewController : UITableViewController
    {
        static NSString kCellIdentifier = new NSString ("MyIdentifier");
        static string [] _names = new string [] {"One", "Two", "Three", "Four", "Five"};

        public MySubUITableViewController () : base (UITableViewStyle.Plain)
        {
            this.TableView.WeakDelegate = this;
            this.TableView.WeakDataSource = this;
        }

        [Export ("tableView:numberOfRowsInSection:")]
        public int RowsInSection (UITableView tableView, int section)
        {
            return 5;
        }

        [Export ("tableView:didSelectRowAtIndexPath:")]
        public virtual void RowSelected (UITableView tableView, NSIndexPath indexPath)
        {
            Console.WriteLine("Item Selected: Section={0}, Row={1}",indexPath.Section, indexPath.Row);  
        }

        [Export ("tableView:cellForRowAtIndexPath:")]
        public UITableViewCell GetCell (UITableView tableView, NSIndexPath indexPath)
        {

            var cell = tableView.DequeueReusableCell (kCellIdentifier);

            if (cell == null)
            {
                cell = new UITableViewCell (UITableViewCellStyle.Default, kCellIdentifier);
            }

            cell.TextLabel.Text = _names[indexPath.Row];

            return cell;
        }

        public override bool ShouldAutorotateToInterfaceOrientation (UIInterfaceOrientation toInterfaceOrientation)
        {
            return true;
        }
    }
} 
```***

# android - Android“DataDroid”示例库 - 使用现有库多次调用 WS

> ID：10180538
> 
> 赞同：1
> 
> 时间：2012-04-16T19:40:55.780
> 
> 标签：android, android-intent, android-activity

我已经能够将 2010 年 Google IO 演示文稿中的[DataDroid](http://datadroid.foxykeep.com/presentation)库巧妙地实现到我的 Android 项目中，并且当我有 1-1关系时它工作得很好`Activity`。`Request`但是，在我的视图中`FilterSelectActivity`，我需要多次调用以填充视图上的下拉框，以便用户可以选择过滤器。问题是库的结构方式并不是很明显如何使用现有的库/回调对 WS 进行多次（不同的）调用。特别是，我可以设置自己的`callThisMethodWS`功能，但只有一个`onRequestFinished`签名：

`public void onRequestFinished(final int requestId, final int resultCode, final Bundle payload)`

现在，是由特定调用函数生成`requestId`的伪随机`int`数，因此它在参数方面表示“唯一”请求，但肯定不是特定请求类型。`resultCode`没用，我不确定`Bundle`除了抓住一个额外的意图之外我还能做什么。

如果有人`DataDroid`在他们的项目中实现了一项活动中的多个 WS 调用，我想知道您如何区分请求，以便您可以填写各种`ArrayLists`或`ArrayAdapters`.

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-26T16:35:46.990

我是 DataDroid 的开发人员，从那时起我发布了 datadroid 的第 2 版，允许更轻松地从单个 Activity 或 Fragment 发送多个请求。

I've also added a new sample ([DoubleListActivity](https://github.com/foxykeep/DataDroid/blob/master/DataDroidPoC/src/com/foxykeep/datadroidpoc/ui/ws/DoubleListActivity.java) in the sample project) which calls 2 webservices from the same activity.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-17T19:41:38.710

我能够通过在类中设置一些常量来识别请求类型，创建请求类型成员，将该成员设置为每个相应 WS 调用中的特定常量，然后在处理中的条件中使用该请求类型成员来实现这一点结果。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-02T16:13:45.187

在我的应用程序中，我也需要这样的东西。我有很多活动可以对 WS 进行多次调用，有些活动需要处理超过 5 或 6 个不同的调用。

为了实现这种行为，我添加了一个`Request`包含请求类型和默认`onRequestFinished`回调的对象，它将调用`OnRequestSuccess, OnRequestError...`函数。然后我有一个`Activity`请求`SparseArray`，它实现`OnRequestFinishedListener`并将所有内容重定向到正确的请求。我所有使用 WS 调用的活动都继承了`Activity`. 我最近也为片段实现了这个。

# android - 使用 ViewPager 和 Fragments

> ID：10180539
> 
> 赞同：10
> 
> 时间：2012-04-16T19:40:59.600
> 
> 标签：android, http, android-viewpager

我是一名初级 Android 开发人员。我正试图了解 ViewPager。在我尝试使用此示例之前：

[http://mobile.tutsplus.com/tutorials/android/android-user-interface-design-horizo​​ntal-view-paging/](http://mobile.tutsplus.com/tutorials/android/android-user-interface-design-horizontal-view-paging/)

我有视图工作，但无法在其中工作，我被告知我需要在 ViewPager 中使用 Fragments。

我改为使用本教程：

[http://tamsler.blogspot.co.uk/2011/11/android-viewpager-and-fragments-part-ii.html](http://tamsler.blogspot.co.uk/2011/11/android-viewpager-and-fragments-part-ii.html)

我已经掌握了带有 Fragment 的 ViewPager 的基础知识：

FragmentPagerActivity.java

```
import android.os.Bundle;
import android.support.v4.app.Fragment;
import android.support.v4.app.FragmentActivity;
import android.support.v4.app.FragmentManager;
import android.support.v4.app.FragmentPagerAdapter;
import android.support.v4.view.ViewPager;

public class FragmentPagerActivity extends FragmentActivity {

    private static final int NUMBER_OF_PAGES = 10;

    private ViewPager mViewPager;
    private MyFragmentPagerAdapter mMyFragmentPagerAdapter;

    public void onCreate(Bundle savedInstanceState) {

         super.onCreate(savedInstanceState);
         setContentView(R.layout.main);
         mViewPager = (ViewPager) findViewById(R.id.viewpager);
         mMyFragmentPagerAdapter = new MyFragmentPagerAdapter(getSupportFragmentManager());
         mViewPager.setAdapter(mMyFragmentPagerAdapter);
    }

    private static class MyFragmentPagerAdapter extends FragmentPagerAdapter {

         public MyFragmentPagerAdapter(FragmentManager fm) {
              super(fm);
         }  

         @Override
         public Fragment getItem(int index) { 

              return PageFragment.newInstance("My Message " + index);
         }  

         @Override 
         public int getCount() {

              return NUMBER_OF_PAGES;
         }
    }
} 
```

PageFragment.java：

```
import android.os.Bundle;
import android.support.v4.app.Fragment;
import android.view.LayoutInflater;
import android.view.View;
import android.view.ViewGroup;
import android.widget.TextView;

public class PageFragment extends Fragment {

    public static PageFragment newInstance(String title) {

        PageFragment pageFragment = new PageFragment();
        Bundle bundle = new Bundle();
        bundle.putString("title", title);
        pageFragment.setArguments(bundle);
        return pageFragment;
    }

    @Override  
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
    }

    @Override  
    public View onCreateView(LayoutInflater inflater, ViewGroup container, Bundle savedInstanceState) {

        View view = inflater.inflate(R.layout.fragment, container, false);
        TextView textView = (TextView) view.findViewById(R.id.textView1);
        textView.setText(getArguments().getString("title"));
        return view;
    }
} 
```

主.xml：

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="fill_parent"
    android:layout_height="fill_parent"
    android:orientation="vertical" >
<android.support.v4.view.ViewPager
        android:id="@+id/viewpager"
        android:layout_width="fill_parent"
        android:layout_height="fill_parent" />

</LinearLayout> 
```

片段.xml：

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    android:orientation="vertical" >

    <TextView
        android:id="@+id/textView1"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:text="TextView" />

</LinearLayout> 
```

我希望能够用我自己的 7 个已经存在的布局替换 ViewPager 中的当前布局，并使用 Fragments 向布局添加功能。我可以如何处理我已经拥有的代码以及为使其正常工作而进行的更改？

如果网上也有任何带有片段的 ViewPager 示例，而不是像 Adroid Developers 博客中那样简单地介绍它，我将非常感激。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-04-16T19:53:17.590

在你的 MyFragmentPagerAdapter 中声明这个：

```
private Fragment[] fragments = new Fragment[] { new Fragment1(),Fragment2(),Fragment3(),Fragment4(),Fragment5()}; 
```

然后像这样实现 getItem 方法：

```
 @Override  
         public Fragment getItem(int index) {  

              return fragments[index];
         } 
```

并且每个片段都有它自己的类和布局：

```
public class Fragment1 extends Fragment { 
   //your code here
} 
```

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2012-04-16T19:50:27.340

假设您知道如何自己创建片段，只需执行以下操作即可将它们放入您的视图寻呼机：

```
 @Override
        public Fragment getItem(int page) {
            switch (page) {
                case 0: return new MyFirstFragment();
                case 1: return new MySecondFragment();
                case 2: return new MyThirdFragment();
                //and so on....
            }
            return null;
        }

        @Override
        public int getCount() {
            return [the count of total fragments];
        } 
```

而不是这个：

```
 @Override  
     public Fragment getItem(int index) {  
          return PageFragment.newInstance("My Message " + index);
     } 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-12-20T00:03:26.550

我稍微修改了 hambonious 的答案：

在 MyFragmentPagerAdapter 中声明：

`private SparseArray<Fragment> fragments = new SparseArray<Fragment>();`

然后像这样实现 getItem 方法：

```
 @Override  
 public Fragment getItem(int index) {
     if(fragments != null && fragments.size() >= index)
        return fragments.get(i);
     else return null;
 } 
```

您还必须覆盖 getSize()

```
 @Override
 public int getCount() {
    return fragments.size();
 } 
```

然后您可以从中动态添加和删除片段。

# php - PHP检测ImageCreateFromString是否失败

> ID：10180543
> 
> 赞同：0
> 
> 时间：2012-04-16T19:41:08.977
> 
> 标签：php, gd

我希望能够检测我何时启动此功能是否**由于内存大小限制而失败**

```
ImageCreateFromString(); 
```

[http://php.net/manual/en/function.imagecreatefromstring.php](http://php.net/manual/en/function.imagecreatefromstring.php)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-16T19:44:03.537

在您链接的 PHP 手册中，已经编写了解决方案：

**返回值**

成功时将返回一个图像资源。如果图像类型不受支持、数据不是可识别的格式或图像已损坏且无法加载，则返回 FALSE。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-16T19:57:17.753

如果您已阅读问题中链接的手册，则已经有了答案。

> 成功时将返回一个图像资源。如果图像类型不受支持、数据不是可识别的格式或图像已损坏且无法加载，则返回 FALSE。

有一个例子

```
$im = imagecreatefromstring($data);
if ($im !== false) {
    // OK
}
else {
    echo 'An error occurred.';
} 
```

* * *

## 回答 #3

> 赞同：-3
> 
> 时间：2012-04-16T19:45:32.027

如果成功，该函数将返回一个字符串。因此，您可以检查返回是否为字符串：

```
if( !is_string(ImageCreateFromString($img)) ) {
    // Do something because it didn't return a string
} 
```

# jquery - 从使用 JQuery Ajax 调用的 Coldfusion CFC 返回值

> ID：10180544
> 
> 赞同：2
> 
> 时间：2012-04-16T19:41:10.723
> 
> 标签：jquery, ajax, coldfusion

我正在尝试使用 Ajax 调用 CFC 组件。但我需要将 CFC 返回的值传递给我的 javascript 例程。当我在警报中显示时，该`done`函数会创建正确的消息。`msg`但是该`ret`变量永远不会填充该值。我需要返回的值来改变 javascript 数据流。

我究竟做错了什么？

```
var ret = $.ajax({
              type: "post",
              url: "cfc/CFCSemae.cfc",
              data: {
                  method: "verificaCadastro",
                  returnformat: "plain",
                  queryformat: "column",
                  nro_cadastro: num_cad
      },
      dataType: "html",
      }).done(function(msg){ return msg; });

alert(ret); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-16T20:03:15.893

以下代码应该为您完成，但是请**理解**，当您执行异步请求时，您只会在执行回调时获得结果。您的代码只会调用您的`$.ajax`函数，但它不会等待响应（就像它在不同的线程中一样）。当响应准备好时，回调`complete`被执行。如果响应返回成功消息（HTTP 状态 200），则`success`调用回调，`error`否则调用。

```
//somewhere in your script
var ret = '';

// then at the ajax request
$.ajax({
    type: "post",
    url: "cfc/CFCSemae.cfc",
    data: { method: "verificaCadastro", returnformat: "plain",
            queryformat: "column", nro_cadastro: num_cad },
    dataType: "json",
    contentType: "application/json; charset=utf-8", // make sure your serverside function can return json
    success: function(data) {
        //your own validation to check whether 'data' is a valid response 
        ret = data;
    },
    error: function(xhr, msg) {
        // handle error
    }
}); 
```

请阅读以下有关 ajax 编程的文章。这将使您更好地理解什么是异步编程：[http](http://en.wikipedia.org/wiki/Ajax_(programming) ://en.wikipedia.org/wiki/Ajax_(programming )

*编辑*：更正拼写错误

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-16T19:48:36.133

AJAX 是异步的，如果不进行同步调用，则无法从回调中返回值。你真的不想那样做。

为成功提供回调函数：handler。您可以在此处添加逻辑，以将返回的数据放入您的 JavaScript 流中。

# iphone - 通用应用程序的最小启动图像数

> ID：10180548
> 
> 赞同：1
> 
> 时间：2012-04-16T19:41:27.080
> 
> 标签：iphone, ios

我有一个支持方向和所有分辨率的通用应用程序，因此有一堆可能的启动图像（iphone 和 ipad、纵向和横向（左/右）、视网膜和标准显示）。但是除了背景图像作为我的应用程序的启动图像之外，没有任何意义。背景只是一个简单的重复图案，所以理想情况下，我只需指定一个 10x10 像素的小图像并用它平铺屏幕。

但据我所知，这是不可能的，我需要提供一堆预渲染的全屏图像。所以我想知道通用应用程序所需的最少图像数量是多少？只有一个 Default.png 就足够了吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-16T19:46:58.900

在您的情况下，我将放置 4 个默认 png。

是的。您需要在一个（或多个）大 default.png 文件中预先填充 10x10 的图块。

两个用于 iPad (iPad / iPad Retina) 和两个用于 iPhone (iPhone / iPhone Retina)。

您需要在应用 plist 中设置基本名称。寻找`Launch image (iPad)`然后进入那里`DefaultiPad`（或类似的东西）。然后你应该在你的项目资源中放置一个 DefaultiPad.png 和一个 DefaultiPad@2x.png。

对 iPhone 做同样的事情。`Launch image (iPhone)`在您的应用 plist 中照顾并使用不同的基本名称执行相同的操作。

**更新 1：** 您还可以为每个设备方向添加 Default.pngs。最简单的方法是使用`[Basename]-Landscapen.png`and `[Basename]-Portrait.png`。因此，在上述情况下，您可以使用文件名`DefaultiPad-Landscape.png`和`DefaultiPad-Portrait.png`

但这也会增加你的二进制文件大小——也许对于你的 10x10 瓷砖案例——不值得这样做。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-16T20:04:55.860

因为您要求的是最低限度：

> 每个应用程序必须提供至少一个启动图像。此图像通常位于名为 Default.png 的文件中，该文件以纵向显示应用程序的初始屏幕。但是，您也可以提供其他启动图像以在不同的启动条件下使用。

来源：[应用启动（默认）图像](http://developer.apple.com/library/ios/DOCUMENTATION/iPhone/Conceptual/iPhoneOSProgrammingGuide/App-RelatedResources/App-RelatedResources.html#//apple_ref/doc/uid/TP40007072-CH6-SW12)

但是，我也建议至少使用 4 个（iPad + iPhone 各正常，@2x）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-16T19:52:31.960

您不能仅通过提供一个小图像并将其平铺来做到这一点，您必须为您想要支持的所有内容提供一个实际的、预制的图像。在你的情况下：

*   4 张适用于 iPad 的图像（横向、纵向、横向 2x、纵向 2x）
*   iPhone 的 2 张图像（纵向、纵向 2x）

左右是相同的图像，除非你对这些方向做不同的事情。颠倒也是一样。

如果您认为这很多，请等到您看到需要多少图标。

更多信息在[App Launch (Default) Images](http://developer.apple.com/library/ios/DOCUMENTATION/iPhone/Conceptual/iPhoneOSProgrammingGuide/App-RelatedResources/App-RelatedResources.html#//apple_ref/doc/uid/TP40007072-CH6-SW12)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-16T20:03:45.113

您可以提供的最小数量**为零**。如果您的应用可以快速启动，则无需提供。如果您的应用程序启动缓慢，请将重量级的东西放在后台线程上并尽快在屏幕上显示 UI（或平铺模式的普通视图）以使其更快。

# combobox - 如何使用 Ajax 在 ExtJS 中制作 Dependent ComboBox？我的第二个 ComboBox 不断加载

> ID：10180549
> 
> 赞同：0
> 
> 时间：2012-04-16T19:41:38.517
> 
> 标签：combobox, extjs4

希望你们一切都好。我在使用 ExtJS 4 的两个组合时遇到了下一个问题（实际上，这是我正在尝试做的一个示例，但我无法获得所需的结果）。

我的目标是，使用一个组合并通过选择其中一个项目，第二个组合显示不同的数据（我需要完成这个练习来实现 Country-State-City 组合集）。由于一切都是一个例子，它根本没有意义，但功能是我所需要的。

我的代码是下一个：

```
<script type="text/javascript">
    Ext.require([
        'Ext.form.field.ComboBox',
        'Ext.form.FieldSet',
        'Ext.tip.QuickTipManager',
        'Ext.data.*'
    ]);

    Ext.define('State', { //Define state model
        extend: 'Ext.data.Model',
        fields: [
            { type: 'integer', name: 'conse' },
            { type: 'string', name: 'abbr' },
            { type: 'string', name: 'name' },
            { type: 'string', name: 'slogan' }
        ]
    });

    Ext.define('User', { //Define user model
        extend: 'Ext.data.Model',
        fields: [
            { name: 'Id', type: 'string' },
            { name: 'Name', type: 'string' },
        ]
    });

    Ext.onReady(function () {

        var states = [
        { "conse": 1, "abbr": "AL", "name": "Alabama", "slogan": "The Heart of Dixie" },
        { "conse": 2, "abbr": "AK", "name": "Alaska", "slogan": "The Land of the Midnight Sun" },
        { "conse": 3, "abbr": "AZ", "name": "Arizona", "slogan": "The Grand Canyon State" },
        { "conse": 4, "abbr": "AR", "name": "Arkansas", "slogan": "The Natural State" },
        { "conse": 5, "abbr": "CA", "name": "California", "slogan": "The Golden State" },
        { "conse": 6, "abbr": "CO", "name": "Colorado", "slogan": "The Mountain State" },
        { "conse": 7, "abbr": "CT", "name": "Connecticut", "slogan": "The Constitution State" },
        { "conse": 8, "abbr": "DE", "name": "Delaware", "slogan": "The First State" },
        { "conse": 9, "abbr": "DC", "name": "District of Columbia", "slogan": "The Nation's Capital" },
        { "conse": 10, "abbr": "FL", "name": "Florida", "slogan": "The Sunshine State" },
        { "conse": 11, "abbr": "GA", "name": "Georgia", "slogan": "The Peach State" },
        { "conse": 12, "abbr": "HI", "name": "Hawaii", "slogan": "The Aloha State" },
        { "conse": 13, "abbr": "ID", "name": "Idaho", "slogan": "Famous Potatoes" },
        { "conse": 14, "abbr": "IL", "name": "Illinois", "slogan": "The Prairie State" },
        { "conse": 15, "abbr": "IN", "name": "Indiana", "slogan": "The Hospitality State" },
        { "conse": 16, "abbr": "IA", "name": "Iowa", "slogan": "The Corn State" },
        { "conse": 17, "abbr": "KS", "name": "Kansas", "slogan": "The Sunflower State" },
        { "conse": 18, "abbr": "KY", "name": "Kentucky", "slogan": "The Bluegrass State" },
        { "conse": 19, "abbr": "LA", "name": "Louisiana", "slogan": "The Bayou State" },
        { "conse": 20, "abbr": "ME", "name": "Maine", "slogan": "The Pine Tree State" },
        { "conse": 21, "abbr": "MD", "name": "Maryland", "slogan": "Chesapeake State" },
        { "conse": 22, "abbr": "MA", "name": "Massachusetts", "slogan": "The Spirit of America" },
        { "conse": 23, "abbr": "MI", "name": "Michigan", "slogan": "Great Lakes State" },
        { "conse": 24, "abbr": "MN", "name": "Minnesota", "slogan": "North Star State" },
        { "conse": 25, "abbr": "MS", "name": "Mississippi", "slogan": "Magnolia State" },
        { "conse": 26, "abbr": "MO", "name": "Missouri", "slogan": "Show Me State" },
        { "conse": 27, "abbr": "MT", "name": "Montana", "slogan": "Big Sky Country" },
        { "conse": 28, "abbr": "NE", "name": "Nebraska", "slogan": "Beef State" },
        { "conse": 29, "abbr": "NV", "name": "Nevada", "slogan": "Silver State" },
        { "conse": 30, "abbr": "NH", "name": "New Hampshire", "slogan": "Granite State" },
        { "conse": 31, "abbr": "NJ", "name": "New Jersey", "slogan": "Garden State" },
        { "conse": 32, "abbr": "NM", "name": "New Mexico", "slogan": "Land of Enchantment" },
        { "conse": 33, "abbr": "NY", "name": "New York", "slogan": "Empire State" },
        { "conse": 34, "abbr": "NC", "name": "North Carolina", "slogan": "First in Freedom" },
        { "conse": 35, "abbr": "ND", "name": "North Dakota", "slogan": "Peace Garden State" },
        { "conse": 36, "abbr": "OH", "name": "Ohio", "slogan": "The Heart of it All" },
        { "conse": 37, "abbr": "OK", "name": "Oklahoma", "slogan": "Oklahoma is OK" },
        { "conse": 38, "abbr": "OR", "name": "Oregon", "slogan": "Pacific Wonderland" },
        { "conse": 49, "abbr": "PA", "name": "Pennsylvania", "slogan": "Keystone State" },
        { "conse": 40, "abbr": "RI", "name": "Rhode Island", "slogan": "Ocean State" },
        { "conse": 41, "abbr": "SC", "name": "South Carolina", "slogan": "Nothing Could be Finer" },
        { "conse": 42, "abbr": "SD", "name": "South Dakota", "slogan": "Great Faces, Great Places" },
        { "conse": 43, "abbr": "TN", "name": "Tennessee", "slogan": "Volunteer State" },
        { "conse": 44, "abbr": "TX", "name": "Texas", "slogan": "Lone Star State" },
        { "conse": 45, "abbr": "UT", "name": "Utah", "slogan": "Salt Lake State" },
        { "conse": 46, "abbr": "VT", "name": "Vermont", "slogan": "Green Mountain State" },
        { "conse": 47, "abbr": "VA", "name": "Virginia", "slogan": "Mother of States" },
        { "conse": 48, "abbr": "WA", "name": "Washington", "slogan": "Green Tree State" },
        { "conse": 49, "abbr": "WV", "name": "West Virginia", "slogan": "Mountain State" },
        { "conse": 50, "abbr": "WI", "name": "Wisconsin", "slogan": "America's Dairyland" },
        { "conse": 51, "abbr": "WY", "name": "Wyoming", "slogan": "Like No Place on Earth" }
    ];

    var store = Ext.create('Ext.data.Store', { //Store for the STATES
        model: 'State',
        data: states
    });

    //In this otherStore, i'll save the Categories data 
    var otherStore = Ext.create('Ext.data.Store', {
        model: 'User',
        proxy: {
            type: 'ajax',
            url: '/Categories',
            reader: {
                type: 'json',
                root: 'Categories'
            }
        }
    });

    var simpleCombo = Ext.create('Ext.form.field.ComboBox', {
        id: 'simpleCombo',
        store: otherStore,                        
        displayField: 'Name',
        valueField: 'Id',
        queryMode: 'local',
        triggerAction: 'all',
        emptyText: 'Select a category...',
        renderTo: 'simpleCombo',
        listeners: {
            select: function (combo, record, index) {
                alert(combo.getValue());
            }
        }
    });

    var anotherCombo = Ext.create('Ext.form.field.ComboBox', {
        fieldLabel: 'Select a single state',
        store: store,
        displayField: 'name',
        valueField: 'conse',
        queryMode: 'local',                       
        forceSelection: true,
        triggerAction: 'all',
        emptyText: 'State',
        selectOnFocus: true,
        renderTo: 'anotherCombo'
    });

    anotherCombo.on('select',function(cmb,record,index){
        simpleCombo.enable();
        simpleCombo.clearValue();
        otherStore.load({
            params:{  
                id:cmb.getValue()
            }  
        });  
    },this); 
});
</script> 
```

好的，让我解释一下我正在尝试做什么，什么有效，什么无效。状态被加载到 otherCombo。在那里，当我选择它的一个项目时，我将 conse 值发送到服务器（.NET 中的 MVC，它可以正常工作，所以我没有放置它的代码）。conse 值表示将加载到 simpleCombo 中的项目数。第一次，一切似乎都很好。这是图片： ![第一次选择otherCombo](../Images/d2ac652a207246c3012d6ea19f4e30e5.png)
我选择了 Arizona（项目编号 3），因此加载了 3 个项目。好的，那个工作得很好，但是，我第二次从 otherCombo 中选择其他项目：

![在此处输入图像描述](../Images/6ec6b07e27d720dceaacc55521b0b509.png)

通过选择阿拉斯加（项目编号 2），加载了 2 个项目，好吗？但是，发生了一些错误，因为看起来仍在加载某些内容，但是您可以看到数据已正确更改。

那是我的问题。我看过不同的例子，它应该是有效的。

希望你能帮我！:D

非常感谢您提前。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-18T16:42:09.103

我遇到了同样的问题，为此我使用了一种解决方法。
在第一个组合框的更改事件中，您需要将第二个组合框存储设置为 null，然后再次绑定它。这是代码：

```
var anotherCombo = Ext.create('Ext.form.field.ComboBox', {
    fieldLabel: 'Select a single state',
    store: store,
    displayField: 'name',
    valueField: 'conse',
    queryMode: 'local',
    forceSelection: true,
    triggerAction: 'all',
    emptyText: 'State',
    selectOnFocus: true,
    renderTo: 'anotherCombo',
    listeners:[{
        'change': function(cbo, newValue, oldValue){
            var simpleCombo = Ext.getCmp("simpleCombo");
            simpleCombo.bindStore(null);
            otherStore.load({callback: function(){
                simpleCombo.bindStore(otherStore);
            }});
        }
    }]
}); 
```

# c# - 无法将字符串列表格式化为列

> ID：10180551
> 
> 赞同：0
> 
> 时间：2012-04-16T19:41:46.050
> 
> 标签：c#, string, list, formatting

很抱歉很痛苦，但我无法在 c# 中将我的字符串列表格式化为列。我正在使用的是一个输入文件，例如；“aa bbb cccc ddddd eeeeee fffffff”

并使用字符限制（自动换行）我需要像这样将单词隔开输出：Wrap = 20

```
aa    bbb    cccc
ddddd eeeeee fffffff 
```

目前我可以获得每行的单词数，但是例如，如果一个单词由于换行而无法容纳，我的程序会将它放到另一行，但是我需要保持每行相同数量的字符串，所以第一行将有 4 个字符串，但其余的有 5 个，因为它们的字符串更小。

提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-17T02:14:26.183

我能想到的唯一方法很复杂，您可以首先获取对字符串进行拆分的组数，然后获取每个组中的字符数。当你拥有它时，你可以开始制作组，当其中一个子组超过限制时你停止

```
//creates groups and lengths arrays
string letters = aaa bbbb ccc dd eeeeeee ffffffffff gggggggggggggggg hh iiiiiiiiii;
string[] groups = letters.split(" ");
int[] lengths = new int[groups.length]
    for(int i = 0; i<groups.length, i++){
    lengths[i] = groups[i].length;
}
int numberofrows;
//starts doing groups: is one element is more that 20, then if 2 elements are more 
//than 20, 3 elements more than 20....
// when a sum is more than 20, then the last amount of groups was the one to use
for(int i = 0, i<groups.length<i++){
    for(int j = 1, j<=groups.length, j++)
        int sum = add(i, j) 
        if(sum > limit){
            numberofrows = j-1;
            return;
        }
    }
}

//this makes the addition of several elements of the array, next to the other
public int add(int index, id sums){
    int sum = lengths[index];
    for(int i = 0, i<=sums;i++){
        sum += lengths[index+i];
    }
    return sum;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-16T19:49:34.220

您可以通过遍历数组中的每个第 n 个项目来计算每列的间距。

例如，如果您知道每行的单词数，比如每行 3 个单词，您可以获取每个第 3 个元素，从第一个元素开始获取第一列最长的单词。

所以你会有一个 for 循环：

```
int longestWord = 0;

for(int i = 0; i < arrayLength; i += wordsPerLine)
{
    if(array[i].Length > longestWord)
        longestWord = array[i].Length;
} 
```

不确定如何为每一列实现这一点，但这是一个想法？

# c++ - 替换失败是依赖非类型模板参数的错误吗？

> ID：10180552
> 
> 赞同：10
> 
> 时间：2012-04-16T19:41:48.857
> 
> 标签：c++, templates, c++11, sfinae, template-aliases

假设我有这些模板别名：

```
enum class enabler {};

template <typename T>
using EnableIf = typename std::enable_if<T::value, enabler>::type;
template <typename T>
using DisableIf = typename std::enable_if<!T::value, enabler>::type; 
```

我可以在 GCC 中执行以下操作：

```
#include <iostream>

template <typename T, EnableIf<std::is_polymorphic<T>> = {}>
void f(T) { std::cout << "is polymorphic\n"; }

template <typename T, DisableIf<std::is_polymorphic<T>> = {}>
void f(T) { std::cout << "is not polymorphic\n"; }

struct foo { virtual void g() {} };

int main() {
    f(foo {});
    f(int {});
} 
```

它打印：

> 是多态
> 的 不是多态的

这符合我的期望。

使用clang，该代码无法编译。它会产生以下错误消息。

```
test.cpp:11:58: error: expected expression
template <typename T, EnableIf<std::is_polymorphic<T>> = {}>
                                                         ^
test.cpp:14:59: error: expected expression
template <typename T, DisableIf<std::is_polymorphic<T>> = {}>
                                                          ^
test.cpp:20:3: error: no matching function for call to 'f'
  f(foo {});
  ^
test.cpp:12:6: note: candidate template ignored: couldn't infer template argument ''
void f(T) { std::cout << "is polymorphic\n"; }
     ^
test.cpp:15:6: note: candidate template ignored: couldn't infer template argument ''
void f(T) { std::cout << "is not polymorphic\n"; }
     ^
test.cpp:21:3: error: no matching function for call to 'f'
  f(int {});
  ^
test.cpp:12:6: note: candidate template ignored: couldn't infer template argument ''
void f(T) { std::cout << "is polymorphic\n"; }
     ^
test.cpp:15:6: note: candidate template ignored: couldn't infer template argument ''
void f(T) { std::cout << "is not polymorphic\n"; }
     ^
4 errors generated. 
```

它应该编译吗？两个编译器哪个有问题？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-04-16T20:54:15.630

^(首先，感谢@Richard [Smith](https://stackoverflow.com/users/1041090/richard-smith)在 oftc 的[#llvm IRC 频道上](http://llvm.org/docs/#irc)的解释。)
不幸的是，这不是合法的 C++，因此 Clang 是正确的：`{}`不是表达式，而是*花括号初始化列表*，因此永远不会是非类型模板参数的初始化程序所需的*常量表达式。*

`§14.3.2 [temp.arg.non-type] p1`

> 非类型、非模板模板*参数*的*模板参数*应为以下之一：
> 
> *   对于整数或枚举类型的非类型*模板参数，模板**参数类型的转换***常量表达式**（5.19）；或者
> **   [...]*

 *一种解决方案是`enabler`.*

# ruby-on-rails - 使用 rspec 测试登录/注销（保留两个 API 调用之间的会话数据）

> ID：10180553
> 
> 赞同：1
> 
> 时间：2012-04-16T19:41:53.797
> 
> 标签：ruby-on-rails, testing, rspec

我想要测试的 Rails 应用程序中有以下 API 方法：

```
/current-user.json
/login.json
/logout.json 
```

我想在 RSpec 中运行以下测试：

*   检查用户是否已在 /current-user.json 注销
*   通过向 /login.json 发送访问令牌登录
*   检查用户是否在 /current-user.json 登录

问题是，一旦用户登录，我就在控件中设置了 session[:user_id]。似乎会话在请求之间没有延续。有没有办法在 RSpec 中进行测试，同时保留请求之间的会话数据？

这是我的规范文件中的代码

[https://gist.github.com/2c077538bddfdb9c76bd](https://gist.github.com/2c077538bddfdb9c76bd)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-16T23:56:43.407

你试过机械化图书馆吗？

```
require 'Mechanize'
m = Mechanize.new
m.keep_alive = true
m.body = YOUR_JSON
m.basic_auth(YOUR_USER, YOUR_PASSWORD)
m.get("#{server_url}/login.json")
m.get("#{server_url}/current.user")
m.get("#{server_url}/login.json")
m.get("#{server_url}/current.user") 
```

# php - 非常高级的.htaccess

> ID：10180556
> 
> 赞同：3
> 
> 时间：2012-04-16T19:42:07.540
> 
> 标签：php, .htaccess, http-status-code-301

好的，我环顾四周，似乎找不到答案。

现在我不是要求你只给我一段代码，然后说“这就是修复”，我想让你解释一下你是怎么做到的，你想出了什么等等。我真的很喜欢要了解更多有关此的信息，而学习的唯一方法是通过示例。

现在我需要做的是：

目前我的博客（word press go figure，因为他们拥有世界）位于根目录。所以我的帖子看起来像：`http://localhost/hello-world`。只是一个例子。

然而，我刚刚扩展了我的网站，使用 Code Igniter 定制了一个 PHP 脚本。我需要将 Code Igniter 脚本放在根目录下，并将博客移动到 /main/ 或 /blog/。我不想摆脱我的博客，但我不希望谷歌不得不重新索引每一篇博文，或者让谷歌导致错误的帖子网址。更重要的是，我不想坐在这里几个小时，为每一篇博文（有数百篇）创建重定向网址。

现在我需要重定向是 301 重定向。

这是我遇到的问题。

我需要在 .htaccess 中有这个：

```
 RewriteEngine on
 RewriteCond $1 !^(index\.php|admin|css|img|js|main|favicon.ico)
 RewriteRule ^(.*)$ index.php/$1 [L] 
```

这删除了丑陋的 localhost/index.php/controller/controller-function/

但我需要让我的 .htaccess 重定向 / 上的所有内容，而不是我已经拥有的预设网址。

我通过 Code Igniter 获得的 Preset url 争论是：

```
/details/
/register/
/city/
/search_process/
/login/
/logout-success/
/login-success/
/logout/
/login/
/manage/
/panel/ 
```

所以本质上..

localhost/hello-world/ 必须 301 重定向到 localhost/main/hello-world

和

localhost/(any-of-the-above)/ 必须不重定向到 /main/ 或 /blog/

另外，如果您在当前的 .htaccess 中注意到，我已经允许某些内容，例如 /admin/ /css/ /img/ /js/（/main/ 显然是博客）和 favicon.ico（因为它看起来很棒）

请教我！（你多久听到一次？：P）

**劳伦斯·切罗内功劳！**

他最初给了我答案，从那时到现在，我认为我第一次打错了代码，不小心丢失了代码，第二次复制/粘贴后它没有工作（因为我第一次真的打字它出来学习它）。

所以这里使用修改后的工作解决方案。我完全归功于 Lawrence Cherone（对这个问题有公认答案的人），因为他帮助我解决了这个问题，最终如果没有他，我无法得到这个可行的解决方案。再次感谢 bud！

```
RewriteEngine on
RewriteCond $1 !(panel|manage)
RewriteRule ^(.*)$ http://localhost/choosefitness/main/$1 [R=301,L]

RewriteEngine on
RewriteCond $1 !^(index\.php|admin|css|img|js|less|favicon.ico)
RewriteRule ^(.*)$ index.php/$1 [L] 
```

这只是说明，只要第一个参数`http://localhost/choosefitness/first-argument`不是 /panel 或 /manage。它应该 301 重定向到 /main/（必须为 301 重定向提供完整的 URL，而不仅仅是 main/$1）

然后它指出在 admin css img js lss 或 favicon.ico 上发出的任何请求都应该被忽略。else 应该在 index.php 上进行（这会从代码点火器中的 url 中删除 index.php）

我不知道它为什么有效，我只知道它有效。但是我还没有完全测试它，但我相信能够在没有重定向的情况下访问 /css，你必须将 |css 添加到第一个 RewriteCond。但是，服务器无需这样做即可访问 css 文件。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-16T20:19:18.590

这是未经测试的，而且很肯定`index.php/$1/$2`是错误的，但是......您可以包含一个与您的 CI 规则匹配的规则，然后传递给 CI 控制器，如果发现不匹配，则重写您的`/blog/`url。也不要忘记逃避。在`favicon\.ico`部分。

```
RewriteEngine on
RewriteCond $1 !^(index\.php|admin|css|img|js|main|favicon\.ico)

RewriteRule ^(details|register|city|search_process|login|logout-success|login-success|logout|login|manage|panel)/(.*)$ index.php/$1/$2 [L]
RewriteRule ^(.*)$ /blog/$1 [L] 
```

编辑：如果您的参数在前面，则将规则切换为如下内容：

```
RewriteRule ^(.*)/(details|register|city|search_process|login|logout-success|login-success|logout|login|manage|panel)$ index.php/$1/$2 [L] 
```

# python - 如何将按钮小部件放在标签小部件上并确定其在 Tkinter 中的位置

> ID：10180557
> 
> 赞同：2
> 
> 时间：2012-04-16T19:42:14.267
> 
> 标签：python, tkinter, tk

如何将按钮小部件放在背景图像的顶部？

```
from Tkinter import *
import tkMessageBox

root = Tk()

# load image
logo = PhotoImage(file="C:\\Users\\admin\\Desktop\\project\\front page.gif")
w = logo.width()
h = logo.height()

root.geometry('%dx%d+0+0' % (w,h))

def helloCallBack():
    tkMessageBox.showinfo("Hello Python", "Hello World")

#create widgets
B = Button(root,text = "ASSOCIATIONS", command = helloCallBack,width = 20,padx = 20)
B.pack()

B1 = Button(root,text = "HELP", command = helloCallBack,width = 20,padx = 20)
B1.place(relx=1, x=-50, y=2, anchor=NE)
B1.pack()

w1 = Label(root, compound = CENTER, image = logo).pack(side="right")

root.mainloop() 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-16T20:42:28.350

最简单的做法是使用 将背景图像`place`放入小部件中，然后按照您通常使用`pack`或的方式将其他小部件放入该小部件中`grid`

```
background=Label(root, image=logo).place(x=0,y=0,relwidth=1, relheight=1)
b = Button(root, ...).pack(...) 
```

确保首先创建背景，使其具有较低的堆叠顺序。

如果您真的想将按钮放入标签中，只需将标签设置为按钮的父级并使用`pack`或`grid`按照您通常的方式使用 - 在 Button 或 Label 或任何其他小部件中打包东西是完全合法的（尽管，最终结果可能不是您所期望的）。

# php - 如何创建一个全局访问计数器，为每次访问创建一个图像？

> ID：10180559
> 
> 赞同：1
> 
> 时间：2012-04-16T19:42:29.677
> 
> 标签：php, image

基本上我想创建一个网页的全局访问计数器，然后我想为每次访问显示一个图像。因此，如果有 10 个人访问了该页面，则来自服务器的 10 个随机图像将在该页面上回显。当第 11 个访问者到达页面时，将回显一个新的随机图像，依此类推......

所以我真的需要两件事的帮助——

1.  我有一个非常基本的访问计数器，但它只在会话中有效，我需要它在全球范围内工作吗？
2.  如何根据访问次数回显图像？

这是我的访问计数器的基本代码：

```
if(isset($_SESSION['views']))
   $_SESSION['views']=$_SESSION['views']+1;
else
   $_SESSION['views']=1

echo "Page views: ".$_SESSION['views']; 
```

我仍然是 php 的大量初学者，任何帮助将不胜感激:)

多谢你们。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-16T20:03:30.620

如果您选择不将数据存储在数据库中，那么此代码应该适合您，您所要做的就是找到从 0 到 9 的图像，并创建名为 counter.txt 的空文本文件并将此代码放在您的 php 文件中某处

```
$file = "counter.txt";
$count = file_get_contents($file);
$fh = fopen($file, 'w') or die("ccould not open file");
$content = (int)$count + 1;
fwrite($fh, $content);
fclose($fh);
$counter_array = str_split($content);
foreach($counter_array as $digit){
    echo "<img src='" . $digit . ".gif' />";
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-16T19:46:56.947

### 会话不适**用于**全局存储。

他们只有在网站打开之前还活着。

> 您应该使用数据库来存储全局变量。

* * *

现在，进入图像显示部分。您可以使用特定于访问次数的编号命名图像。

> **例如：**
> 
> 4.jpg 将是第四个人的图像

接下来，您可以使用这样的简单代码段

```
$visitCounter = "?"; //Get the count using a logic
echo "<img src="$visitCounter.jpg" />"; //Use it to create a image path 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-16T19:47:21.087

$_SESSION 是错误的用途。

过去，我会在服务器上读取和写入文本文件。由于羊群问题，这不是最好的方法，但它会给你一些读写文件的经验。

# sql - 每当将项目添加到服务代理队列时，如何执行存储过程？

> ID：10180560
> 
> 赞同：2
> 
> 时间：2012-04-16T19:42:37.743
> 
> 标签：sql, sql-server, sql-server-2008, stored-procedures, service-broker

我正在使用 SQL 服务代理。我有一个队列，另一个进程正在向其中添加项目。每当将项目添加到队列中时，我都想运行存储过程。该过程将从队列中接收顶部项目并在存储过程中使用其信息。做这样的事情的正确语法是什么？在使用 Service Broker 队列时，我是使用典型的 SQL 触发器还是有什么特殊的用途？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-16T20:24:44.920

可以将触发的存储过程指定为队列定义的一部分。请参阅文档`CREATE QUEUE`- 特别是该`ACTIVATION`条款。

[文档](http://msdn.microsoft.com/en-us/library/ms190495.aspx)中的一个示例：

> 以下示例创建一个可用于接收消息的队列。当消息进入队列时，队列启动存储过程费用_procedure。存储过程以用户 ExpenseUser 的身份执行。队列最多启动存储过程的 5 个实例。
> 
> ```
> CREATE QUEUE ExpenseQueue
>     WITH STATUS=ON,
>     ACTIVATION (
>         PROCEDURE_NAME = expense_procedure,
>         MAX_QUEUE_READERS = 5,
>         EXECUTE AS 'ExpenseUser' ) ; 
> ```

# facebook - 没有收到来自 FBAS.init 的响应

> ID：10180561
> 
> 赞同：1
> 
> 时间：2012-04-16T19:42:52.757
> 
> 标签：facebook, actionscript-3, flash, facebook-graph-api, facebook-actionscript-api

它一直工作到上周的星期四，但我想知道是否发生了一些变化，因为从那时起代码一直是相同的。

我将以下 JSON 信息从我在 facebook 中的应用程序传递给 FBAS.init 调用

```
{"oauth":true,"appId":"MYAPPID"} 
```

以下是相关代码：

```
//We call Facebook API init call like so:   
trace("init");
Facebook.init(_appKey, _fbInitResponse);

//Here's our callback
protected function _fbInitResponse(success:Object, fail:Object):void
{
    trace("fbInitResponse: success = " + success);

    // User logged in successfully
    if (success) 
    {
        trace("\t session recieved!");
        _session = success;
        dispatchEvent(new Event(FacebookEvent.INIT));
    } 
    else 
    {
        trace("ERROR: " + fail);
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-18T18:56:38.843

**实际上：**这看起来像是 Facebook 没有正确重定向到 Secure Canvas URL 的错误。下面的 hack 是一个短期的解决方法，但这看起来像是 Facebook 的一个错误。

遇到和你一样的问题。当用户使用 https 访问 Facebook 应用程序时不匹配，但应用程序页面是在 http 中提供的。

自 3 月以来，Facebook 身份验证更改一直在向用户传播。我认为这是导致破坏的变化： [https ://developers.facebook.com/roadmap/#enhanced-auth-dialog](https://developers.facebook.com/roadmap/#enhanced-auth-dialog)

在这个答案中找到的提示帮助了我： [Facebook JavaScript SDK over HTTPS loading non-secure items](https://stackoverflow.com/questions/5212016/facebook-javascript-sdk-over-https-loading-non-secure-items)

我把：`FB._https = (window.location.protocol == "https:");`

我把它放在脚本元素中的 fb-root div 之后。非常hacky。

# jquery - 预加载链接到页面的图像

> ID：10180562
> 
> 赞同：0
> 
> 时间：2012-04-16T19:42:57.007
> 
> 标签：jquery, preload, shadowbox

我想提高[此页面上Shadowbox 弹出图像的加载速度](http://carolineelisa.com)

基本上，Shadowbox 打开的所有图像都链接到此页面：

```
<a href="images/illustration/garden1.jpg" class="garden"></a>
<a href="images/illustration/garden2.jpg" class="garden"></a> 
```

等等等等

我知道如何通过像这样列出它们来预加载图像：

```
var images = [ 'image1.jpg', 'image2.jpg', ]

$.fn.preload = function() {
    this.each(function(){
        $('<img/>')[0].src = this;
    });
}

$(document).ready(function(){
 $(images).preload();
 }); 
```

有没有办法将所有`href`值拉入预加载数组？如果是这样，我如何排除指向其他文档的链接？还是我做错了？！

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-28T09:48:34.530

这是一个使用通配符选择器的纯 JQuery 解决方案

```
$(function(){
  $('a[href$=".jpg"]').each(function(index, elem){
    var href = $(elem).attr('href');
    $('<img/>')[0].src = href;
  });
}); 
```

基本上，`$=`选择器的意思是'ends-with'，所以它会找到任何以 .jpg 结尾的链接并预加载它。如果您使用的是 shadowbox 约定，您可能希望将此选择器更改`$('a[rel^="shadowbox"]')`为更具体一些。`^=`意思是“开始”。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-16T20:01:42.290

下面的文件将找到在所选文件夹中找到的所有图像（输入到 listImages 函数调用中）。将此作为 all_images.php 保存在您要抓取图像的目录中：

```
<?php
function listImages($dir){
    $ffs = scandir($dir);
    foreach($ffs as $ff){
        if($ff != '.' && $ff != '..' && strstr($ff, '.png') || strstr($ff, '.jpg') || strstr($ff, '.gif') || strstr($ff, '.jpeg')){
            echo '"/images/'.$ff;
            if(is_dir($dir.'/'.$ff)) listFolderFiles($dir.'/'.$ff);
            echo '", ';
        }
    }
}
echo '[ ';
listImages('images');
echo ']';
// output: ["image1.png", "image2.png"] etc.
?> 
```

然后，为了预加载这些图像，将 all_images.php 文件加载到一个变量中，并预加载它包含的生成的图像文件字符串：

```
<script src="jquery.js"></script>
<script type="text/javascript">
// put contents of all_images.php file into variable 'images'
$.get('/all_images.php', function (data) {
    images = $(data);
});

// The variable 'images' now contains string of file names
// needed to be preloaded.
$.fn.preload = function() {
    this.each(function(){
        $('<img/>')[0].src = this;
    });
}

$(document).ready(function(){
    $(images).preload();
});
</script> 
```

此解决方案不需要额外的“包含”文件（与我之前的答案不同）。

# php - 是否有模仿 " " 行为的 php 函数？

> ID：10180563
> 
> 赞同：0
> 
> 时间：2012-04-16T19:42:59.620
> 
> 标签：php, zend-framework

我正在尝试在 Zend Framework 中创建一个表视图助手，它需要一个模型数组并生成一个显示模型属性的 html 表。

用户可以添加额外的列来显示更新、删除模型等操作。

所以用户可以添加这样的字符串

```
 $columnContent =   '<a href=\'update/$item[id]\'>update</a>' ; 
```

请注意，我使用简单的引号来缓存稍后要评估的字符串

我的问题是，**以后有没有办法在上下文中评估该字符串？**

所以我需要模仿 PHP 中字符串的 " " 行为，谢谢。

就像是 ：

// 在上下文中，其中 $item 是模型数组中的一行：

```
$myVar = evaluatemyString($columnContent); 
```

编辑 ：

我不是在寻找在我的情况下不起作用的 eval 函数，（我认为）。

编辑 2：

我也需要将结果放入变量中。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-16T19:59:57.480

改用“模板”（引号是有意的）。看看[`intl`](http://php.net/intl)，尤其是[`messageformatter`](http://php.net/messageformatter)。还有很好的旧[`printf()`](http://php.net/printf)功能（包括`sprintf()`等等）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-16T19:44:41.813

PHP中的[eval函数](http://ca.php.net/manual/fr/function.eval.php)

```
eval($columnContent); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-16T23:49:29.653

这是一个简单的 UTF-8 安全字符串插值示例。正则表达式强制使用以下规则的变量：

1.  以@为前缀
2.  object:property notation（表示关联数组键“对象”，其值也是关联数组）

换句话说，而不是像这样的变量：`$item[id]` 你将拥有像这样的变量：`@user:id`

```
<?php

// <a href="update/@user:name">update</a>
//$template = '<a href="update/@user:name">update</a>';

// <a href="update/500">update</a>
$template = '<a href="update/@user:id">update</a>';

// fixture data
$db[499]  = array('user' => array('id' => 499));
$db[500]  = array('user' => array('id' => 500));

// select record w/ ID = 500
$context  = $db[500];

// string interpolation
$merged = preg_replace_callback('/@(?:(?P<object>[^:]+):)(?P<property>[\w][\w\d]*){1}/iu', function($matches) use($context) {
  $object   = $matches['object'];
  $property = $matches['property'];

  return isset($context[$object][$property])
       ? $context[$object][$property]
       : $matches[0];
}, $template);

echo "TEMPLATE: ${template}", PHP_EOL;
echo "MERGED  : ${merged}",   PHP_EOL; 
```

# android - Android HTML5 本地 mp3

> ID：10180571
> 
> 赞同：1
> 
> 时间：2012-04-16T19:43:28.587
> 
> 标签：android, html, mp3

任何人都知道在 Android 中是否可以使用 HTML5 播放本地 mp3 文件？
从 url 播放 mp3 文件可以正常工作，但在嵌入应用程序时不能。一直在寻找确定的答案。

谢谢你的帮助

```
<html>
<head>
    <title>Audio Player</title>

</head>
<body>
<br /> <br />

     <audio id="player" autoplay loop controls="controls">
    <source src="bassscales.mp3"   />
     </audio>

<br /> <br /> 

<div> 
<button style="width:85;height:75" button onclick="document.getElementById('player').play()">Play</button> 

<button style="width:85;height:75" button onclick="document.getElementById('player').pause()">Pause</button> 

<button style="width:85;height:75" button onclick="document.getElementById('player').pause(); document.getElementById('player').currentTime = 0;">Stop</button>

</div>

</body>
</html> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-21T10:53:45.643

这对于 HTML 文件是否正确？

```
<body>

<video id="video"  controls height="270" src="http://dl.dropbox.com/u/39276137/intro1girl.mp4" width="480">
</video>

<script type="text/javascript">
var video = document.getElementById('video');
video.addEventListener('click',function(){
  MyAndroid.video.play();
},false);
</script> 
```

然后不知道在 JavaScriptInterface.java 类中放什么...感谢所有帮助:)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-16T19:56:27.423

我对 HTML5 和`<video>`标签有同样的问题，如果从文件系统以编程方式调用视频播放正常，但是从标签调用时，不起作用，

我解决它的方法是在 HTML 中有一个 javascript 函数调用 android 系统，在你的情况下播放 mp3

[Android JavaScript接口教程](http://ganeshtiwaridotcomdotnp.blogspot.com.au/2011/09/android-javascriptinterface-tutorial.html)

还要检查我 [在同一主题中的问题](https://stackoverflow.com/questions/9595761/change-activity-with-javascript-in-android)

请注意，您需要将mp3放在正确的文件夹中[对不起，不记得在哪个文件夹中，进行搜索并找到它很容易]

所以首先做一个hello world javascript调用android中的日志或基本函数，

然后让javascript调用播放函数，

祝你好运

附言。 [从资产文件夹示例播放 mp3](http://droidapp.co.uk/?p=272)

[并使用 javascript jsInterface 示例](https://github.com/scottagarman/Android-JavaScript-Interface-Example)调用 Android 方法

# html - 与 Epiphany (WebKit) 相比，为什么 Firefox (Gecko) 中的字体渲染如此糟糕？

> ID：10180573
> 
> 赞同：0
> 
> 时间：2012-04-16T19:43:38.103
> 
> 标签：html, firefox, fonts, webkit, gecko

这是 Firefox (Gecko) 屏幕截图 [[全尺寸](https://i.stack.imgur.com/oxNQW.jpg)]：

![火狐截图。](../Images/56b370adc17c8b3bdb0a526dfe1c6ea6.png)

这是 Epiphany (WebKit) 屏幕截图 [[全尺寸](https://i.stack.imgur.com/NJnGY.jpg)]：

![顿悟截图。](../Images/ce2e303559ef1c9f02ac774d7fb00102.png)

我能做些什么让它在 Firefox (Gecko) 中看起来不错吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-16T21:19:59.397

我不确定你的 CSS 中有什么，但你应该确保做的一件事是定义所有字体大小，然后在 em 中重置主正文。如果这不起作用，请尝试使用 letter-spacing CSS 属性并在两个浏览器中进行测试。

希望这些能奏效！

作为最后的手段，您可以尝试再次通过[fontsquirrel](http://www.fontsquirrel.com/fontface/generator)运行原始字体并尝试不同的设置，因为 FF 和 Chrome 可能使用两种不同的字体类型。

祝你好运！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-17T19:50:48.560

这看起来像一个可下载的字体，是吗？您是否使用它来设置粗体文本的样式，但没有告诉浏览器它是粗体，导致浏览器应用合成粗体？显然，使用合成粗体这样的字体效果不佳。

# wpf - 如何实现后台工作线程队列

> ID：10180575
> 
> 赞同：1
> 
> 时间：2012-04-16T19:44:01.487
> 
> 标签：wpf, multithreading, mvvm, backgroundworker

我正在尝试使用 MVVM 模式实现我的第一个应用程序。我已经设法让大多数事情正常工作，但现在我面临以下（恕我直言很常见）场景的问题：

按下`Button`（视图）将调用方法（模型）。使用`ICommand`（ViewModel）这很容易。但是如果必须执行耗时的操作怎么办？

我当前的解决方案要求我实现一个`WorkQueue`包含`WorkQueueItems`. 有一个与之关联的`WorkQueue`线程，它执行`WorkQueueItem`s。每个`WorkQueueItem`都有 a `Name`， a`Status`和 a`Progress`在执行期间更新。每个`Window`都有自己的`WorkQueue`可视化为`StatusBar`。

**我的问题：** ViewModel 如何找到合适的`WorkQueue`？我是否必须将 传递`WorkQueue`给我创建的每个 ViewModel（这真的很烦人）？或者还有其他我可以使用的机制吗？

我对`RoutedCommand`s 不是很熟悉 - 基本概念似乎朝着这个方向发展。希望看到的是一个解决方案，我可以将 a 绑定`WorkQueueItem`到一个命令/事件，然后它会冒泡到包含`Window`它被添加到`Window`'s 的地方`WorkQueue`。

我也考虑过制作`WorkQueue`一个单身人士——但这只有在我一次只有一个`Window`的情况下才有效。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-16T20:09:00.380

使用后来的 .Net Frameworks (4.0+) 和 WPF，您可以利用该[`System.Threading.Tasks`](http://msdn.microsoft.com/en-us/library/system.threading.tasks.aspx)库在后台提供大量此类工作。

如果说您的命令需要更新视图模型上的属性，但它必须等待信息，您只需启动一个任务来执行 IO：

```
this.FindDataCommand = new RelayCommand<string>(
    /* ICommand.Execute */
    value =>
    {
        Task.Factory
            .StartNew<IEnumerable<Foo>>(() => FindData(value))
            .ContinueWith(
                task =>
                {
                    this.foundData.Clear();
                    this.foundData.AddRange(task.Result);
                },
                TaskScheduler.FromCurrentSynchronizationContext());
    },

    /* ICommand.CanExecute */
    value => !String.IsNullOrWhitespace(value)); 
```

将其分解为可管理的部分，我们将开始一个调用 some method[的新任务](http://msdn.microsoft.com/en-us/library/dd321421.aspx)`IEnumerable<Foo> FindData(string)`。这是您一直编写的简单而无聊的同步代码。可能它已经存在于您的视图模型中！

接下来，我们告诉框架在完成使用[时启动一项新任务](http://msdn.microsoft.com/en-us/library/dd270696.aspx)`ContinueWith`，但改为在[WPF 调度](http://blog.lab49.com/archives/4034)程序上执行。这使您可以避免 UI 元素的跨线程问题的麻烦。

您可以使用辅助类扩展它以进行监视：

```
public class TaskManager
{
    private static ConcurrentDictionary<Dispatcher, TaskManager> _map
        = new ConcurrentDictionary<Dispatcher, TaskManager>();

    public ObservableCollection<WorkItem> Running
    {
        get;
        private set;
    }

    public TaskManager()
    {
        this.Running = new ObservableCollection<WorkItem>();
    }

    public static TaskManager Get(Dispatcher dispatcher)
    {
        return _map.GetOrAdd(dispatcher, new TaskManager());
    }
    // ... 
```

在 XAML 中使用此类将类似于将其实例添加到您的 Window 中`ViewModel`：

```
public TaskManager CurrentTaskManager
{
    get { return TaskManager.Get(Dispatcher.CurrentDispatcher); }
}
// <StatusBarItem Content="{Binding CurrentTaskManager.Running.Count}" /> 
```

然后，您将向 TaskManager 添加一个方法来处理向 Running 集合添加任务和从 Running 集合添加任务：

```
 public Task<TResult> StartNew<TResult>(Func<TResult> work)
    {
         var task = Task.Factory
                        .StartNew<TResult>(work);

         // build our view model
         var workItem = new WorkItem(task);
         this.Running.Add(workItem);

         // Pass the result back using ContinueWith
         return task.ContinueWith(
             t => { this.Running.Remove(workItem); return t.Result; },
             TaskScheduler.FromCurrentSynchronizationContext());
    } 
```

现在我们简单地改变我们的`FindDataCommand`实现：

```
TaskManager.Get(Dispatcher.CurrentDispatcher)
           .StartNew<IEnumerable<Foo>>(() => FindData(value))
           .ContinueWith(
               task =>
               {
                   this.foundData.Clear();
                   this.foundData.AddRange(task.Result);
               },
               TaskScheduler.FromCurrentSynchronizationContext()); 
```

该类`WorkItem`可以将类上的属性公开`Task`给 UI，或者可以将其扩展为封装 a`CancellationToken`以支持将来的取消。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-16T19:49:57.197

我不确定我的问题是否正确，但我觉得在[Dispatcher](http://msdn.microsoft.com/en-us/library/system.windows.threading.dispatcher.aspx)中使用 buil可以解决您的问题，并且您不需要`WorkQueue`手动实现，因为 Dispatcher 为您实现了这样一个队列并能够将“工作项”调度到 UI/任何thred 使用预定义的一组优先级。`Dispatcher.Invoke()`您可以使用或同步或异步执行操作`Dispatcher.BeginInvoke()`

有用的链接：

*   MSDN 杂志：[WPF 线程，使用 Dispatcher 构建更具响应性的应用程序](http://msdn.microsoft.com/en-us/magazine/cc163328.aspx)

# r - 数组函数错误地重新排序输出列

> ID：10180580
> 
> 赞同：0
> 
> 时间：2012-04-16T19:44:17.560
> 
> 标签：r, vectorization

在为输入向量执行以下函数时，我发现结果不一致。当使用矢量化输入时，输出列似乎被重新排序。有没有更好的方法来矢量化这个函数？

```
func <- function(t, alpha) { exp(matrix(-rep(t,7), ncol=7)*1:7*alpha) }

# correct    
rbind(func(3, 0.02), func(4, 0.02))

#incorrect
func(c(3, 4), 0.02)

> rbind(func(3, 0.02), func(4, 0.02))
          [,1]      [,2]      [,3]      [,4]      [,5]      [,6]      [,7]
[1,] 0.9417645 0.8869204 0.8352702 0.7866279 0.7408182 0.6976763 0.6570468
[2,] 0.9231163 0.8521438 0.7866279 0.7261490 0.6703200 0.6187834 0.5712091

> func(c(3, 4), 0.02)
          [,1]      [,2]      [,3]      [,4]      [,5]      [,6]      [,7]
[1,] 0.9417645 0.8352702 0.7408182 0.6570468 0.8869204 0.7866279 0.6976763
[2,] 0.8521438 0.7261490 0.6187834 0.9231163 0.7866279 0.6703200 0.5712091 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-16T20:20:03.783

结果没有任何不正确或不一致的地方，只有您对 R 的回收规则以及如何应用逐元素操作的理解。;-)

R 以列优先顺序（包括回收规则）存储和操作对象。只有当 R 是行主要顺序时，您的示例才有效。列主要排序方式`matrix(-rep(t,7), ncol=7)*1:7`产生的结果如下：

```
3*1 3*3 3*5 3*7 3*2 3*4 3*6
4*2 4*4 4*6 4*1 4*3 4*5 4*7 
```

这是因为，在内部，矩阵只是一个带有`dim`属性的向量。你可以通过运行看到这一点：

```
> as.vector(matrix(-rep(3:4,7), ncol=7))
 [1] -3 -4 -3 -4 -3 -4 -3 -4 -3 -4 -3 -4 -3 -4 
```

看看向量的前两个元素是矩阵的第一列吗？这就是为什么当您乘以 时会得到“不一致”的结果`1:7`。你真的要求 R 做：

```
> (foo <- as.vector(matrix(-rep(3:4,7), ncol=7)) * 1:7)
 [1]  -3  -8  -9 -16 -15 -24 -21  -4  -6 -12 -12 -20 -18 -28 
```

通过以下方式将其变回“矩阵”：

```
> dim(foo) <- c(2,7)
> foo
     [,1] [,2] [,3] [,4] [,5] [,6] [,7]
[1,]   -3   -9  -15  -21   -6  -12  -18
[2,]   -8  -16  -24   -4  -12  -20  -28 
```

如果您想利用回收规则，您需要从当前矩阵的转置开始。然后乘以`1:7`并转置该结果。说到转置，您可能希望避免命名变量`t`，因为这是转置函数的名称。

```
func <- function(v, alpha) {
  t(exp(matrix(-rep(v,7), nrow=7, byrow=TRUE)*1:7*alpha))
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-16T20:12:08.760

这会起作用：

```
func <- function (t,alpha) exp(-rep(t,7) * sapply(1:7,rep,length(t)) * alpha) 
```

# php - 如何使用 $.post() 返回字符串而不是整页

> ID：10180586
> 
> 赞同：0
> 
> 时间：2012-04-16T19:44:58.457
> 
> 标签：php, jquery, ajax, post, json

伙计们，使用以下代码：

```
$(document).ready(function() {
    $(".list-book-description").css("display", "none");
    $("#user-panel-login").css("display", "none");
    $('#login-form').submit(function(e) {
        e.preventDefault();
        var formUsername=$("#login-form #username").val();
        var formPassword=$("#login-form #password").val();
        if((formUsername.length<6))
        {
        $("#ajax-output").html("<div class='error'>Attenzione username troppo breve!</div>");
        }
        else if((formPassword.length<6))
        {
            $("#ajax-output").html("<div class='error'>Attenzione password troppo breve!</div>");
         }
    else
    {
        $.post(
            'index.php?module=login',
            {
                "username": formUsername,
                "password": formPassword,
            },
            function(data){
                $("#ajax-output").html(data);
            }
        );
    }
});
}); 
```

我试图将`?index.php&module=login&function=1`用户名和密码传递给`#login-form`字段`#username`和使用函数`#password`的`login()`php 函数，`setLogin();`如果数据进入数据库来设置登录会话。

```
function Login()
 {
 if(!checkLogin())
    {
    $function=@stringEscape($_GET['function']);

    if($function==1)
    {
        $username=stringEscape($_POST['username']);
        $password=sha1(stringCrypt($_POST['password'], 'sha1').stringCrypt(DB_CRYPT, 'sha1'));
        if(setLogin($username, $password))
        {
            echo "<div class='ok'>Login effettuato con successo, tra pochi secondi verrai riportato alla homepage!</div>";
        }   
    }
}
else notfound();
}

function setLogin($username, $password, $time="")
{
if(!checkLogin())
{
    if((isset($username)) && (isset($password)))
    {
        $query=mysql_query("SELECT * FROM ".DB_PREF."users WHERE user_username='".$username."' AND user_password='".$password."'");
        if(mysql_num_rows($query))
        {
            $fetch=mysql_fetch_assoc($query);
            $_SESSION['logged_user_id']=$fetch['user_id'];
            $_SESSION['logged_user_username']=$fetch['user_username'];
            return true;
        }
        else
        {
            echo "<div class='error'>Dati non validi, ripeti la procedura di login o <a href='?index.php&module=registration'>registrati</a>!</div>";
        }
    }
}
else notfound();
} 
```

现在当我`$.post()`在我的`#ajax-input`div 中获得提交登录表单的结果时，我遇到了一个问题，它不仅返回登录函数的结果，而且返回索引页面+登录函数的结果。

如果我尝试将“json”参数设置为`$.post`函数并且`echo json_encode()`在 php 函数中它根本不起作用。那么，可能是什么问题？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-16T19:52:19.410

you make a request for a full page here, I think.you could make a parameter, post or get, you decide, and if that is for example true, then you return the full page, and he it's false you only return a JSON string or something like that. I believe it is even possible to determine if the request is from ajax or not! That could be your second option. Just add a simple if-statement, I think.

# android - Android Shell 命令（或在 adb 中）使用 cwm 恢复自动重启和恢复备份

> ID：10180594
> 
> 赞同：1
> 
> 时间：2012-04-16T19:45:22.653
> 
> 标签：android, recovery, reboot

寻找在 android 上创建 shell 脚本的命令（或步骤），告诉设备重新启动进入恢复模式并自动恢复位于 /sdcard/clockworkmod/backup/ 文件夹中的备份。我知道重启是：

```
reboot recovery 
```

但我想我需要在该行中添加其他内容，或者在某处创建一个文件，指示 cwm 自动恢复备份并重新启动。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-19T22:40:56.820

找到了我自己的答案...对于以太坊中的人们...

1.  安装 ROM Manager Premium（小 $$）。
2.  使用 Koush 的测试 rom 管理项目 ( [https://github.com/koush/TestRomManager](https://github.com/koush/TestRomManager) ) 连接到 ROM 管理器并要求它重新启动设备以恢复并进行备份。该系统实际上非常强大，因为您可以在空中做一些很酷的事情。这对于内部管理的设备来说是一个很好的设置...您甚至可以运行自己的 update.zip scipts...
3.  或者，您可以添加几个 exec 行以自动单击 确定到 ROM 管理器弹出窗口“你想现在重新启动吗？”。

就是这样。大量的研究，像往常一样来自一个充满开发者的伟大世界的科学怪人。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-05-22T14:03:55.777

如果您遵循此文件的评论，您将设法做您想做的事 [https://android.googlesource.com/platform/bootable/recovery/+/fadc5ac81d6400ebdd041f7d4ea64021596d6b7d/recovery.c](https://android.googlesource.com/platform/bootable/recovery/+/fadc5ac81d6400ebdd041f7d4ea64021596d6b7d/recovery.c)

具体来说，您将不得不处理文件

```
/cache/recovery/command 
```

并在其中包含您要发出的命令。这样做需要root访问权限。

或者，如果您的恢复承认它（CWM，TWRP），您可以在`recovery`重新启动后通过 adb 使用该命令。

# javascript - JavaScript 世界，生活在一个双倍的未来？

> ID：10180601
> 
> 赞同：0
> 
> 时间：2012-04-16T19:45:49.550
> 
> 标签：javascript, time

我正在尝试获取特定日期的确切秒数、分钟数等。这听起来可能很愚蠢，但为什么结果翻了一番？这似乎不对，是吗？

```
setInterval(function() {
    var startDate = new Date(),
        startDateTime = startDate.getTime(),
        endDate = new Date(2012, 5, 14),
        endDateTime = endDate.getTime();
    var timeLeft = endDateTime - startDateTime;
    var seconds = Math.round(timeLeft / 1000),
        minutes = Math.round(seconds / 60),
        hours = Math.round(minutes / 60),
        days = Math.round(hours / 24),
        weeks = Math.round(days / 7);
    console.log(weeks, days, hours, minutes, seconds);
}, 1000);​ 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-16T19:49:52.863

JavaScript Date 构造函数的工作方式与 Java 构造函数类似——Days 和 Years 从 1 开始，但月份从 0 开始。所以 2015 年 2 月 10 日的日期是：

```
var aDate= new Date(2015,1,10); 
```

# shell - 在shell脚本while循环中混合awk命令并且变量在循环后不保持它们的值？

> ID：10180602
> 
> 赞同：0
> 
> 时间：2012-04-16T19:45:54.447
> 
> 标签：shell, awk, while-loop

大家好，对于这个尴尬的标题感到抱歉，但我认为描述起来有点微妙。所以这是我的问题，我想在从 awk 读取输入的 while 循环中保留一个计数（i），然后在循环后打印 i 的值。然而，循环后 i 变回零。下面是我的程序的简化版本，实际上我还在循环内进行了一些字符串匹配，以便跳过某些行并且 i 不会增加。

我试图删除 awk 并执行另一个普通的 while 循环，并且 i 的值在循环之后保留，因此我相信这不是由于某些语法错误。

任何想法都非常感谢！

```
#!/bin/bash
arr=();
i=0;
awk -F '{print $1}' SOMEFILE | while read var
do
  echo $var;
  arr[i]=$var;
  i=$((i+1));
  echo $i;
done
echo $i; 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-16T20:06:20.233

因为 while 循环在管道中，所以它作为子进程运行，并且 i 的值是该子进程的本地值。有几种方法可以保持价值；使用命名管道而不是在管道中运行，使用进程替换，或使用插值 heredoc。这是后者的一个例子：

```
while read var; do ... done << EOF
$( awk ... )
EOF 
```

# c - 功能指针，设计

> ID：10180607
> 
> 赞同：3
> 
> 时间：2012-04-16T19:46:11.770
> 
> 标签：c

我遇到了 C 中的设计问题。

假设我有相当多的函数，具有不同的参数计数。

问题：

```
int print_one(int x)
{
    printf("one: %d\n", x);
    return 1;
}

int print_three(int x, int y, int z)
{
    printf("three: %d-%d-%d\n", x, y, z);
    return 3;
} 
```

现在，我想将一些属性连接到结构中的这些函数，这样我就可以在不知道确切函数的情况下操作它们，包括它们的参数计数（我什至可以调用结构接口）

我像这样尝试过，（我认为这是非常错误的）：

```
typedef int (*pfunc)(int c, ...);

typedef struct _stroffunc
{
    pfunc myfunction;
    int flags;
    int some_thing_count;
    int arguments[10];
    int argumentcount;
} stroffunc;

int main()
{
    stroffunc firststruct;

    firststruct.pfunc = (pfunc) print_two;
    firststruct.something_count = 101;
    arguments[0] = 102;
    argumentcount = 1;
    flag &= SOME_SEXY_FLAG;

    // now I can call it, in a pretty ugly way ... however I want (with patially random results ofc)
    firststruct.pfunc(firststruct.arguments[0]);
    firststruct.pfunc(firststruct.arguments[0], 124, 11);
    firststruct.pfunc(1, firststruct.arguments[0], 124, 1, 1);
} 
```

我发现这个解决方案非常难看，我认为（希望）有一个更好的解决方案来调用 & 和设置函数指针。

我只是希望，我足够清楚......注意：我没有编译这段代码，但我编译并运行了一个非常相似的代码，所以这些概念是有效的。注意：需要纯 C

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-16T20:32:59.103

通过可变参数函数指针调用非可变参数函数会导致**未定义的行为**。首先，回想一下可变参数函数的参数经过*默认参数提升*（`char`s 转换为`int`s 等），这将完全搞砸。

目前尚不清楚您打算如何或为什么要动态调用具有不同数量参数的函数。但一种解决方案可能是使用联合：

```
typedef struct {
    int num_args;
    union {
        void (*f1)(int);
        void (*f2)(int, int);
        void (*f3)(int, int, int);
    } func;
} magic;

...

magic m;
...
switch (m.num_args) {
case 1: m.func.f1(arg1); break;
case 2: m.func.f2(arg1, arg2); break;
case 3: m.func.f3(arg1, arg2, arg3); break;
default: assert(0);
} 
```

第二种解决方案是将所有函数重写为可变参数。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-16T19:50:47.647

这是我知识的边缘，但我相信由于 ABI 中的不兼容性，您还需要使函数成为可变参数。

见：[维基百科的例子](http://en.wikipedia.org/wiki/Variadic_function#Variadic_functions_in_C.2C_Objective-C.2C_C.2B.2B.2C_and_D)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-16T19:56:58.617

也许你可以添加一个库，它有一些函数来处理结构，比如“伪”类，

```
int initFunc(int (*pfunc)(int c,...)); 
```

该函数会将指针保存到结构中，就像 POO 中的上下文一样，在结构中，您将像使用所有函数的“映射”一样使用它，您将使用 id 调用每个函数。

它返回一个id，你把它保存在一个数组中，然后另一个函数说

```
int call(int id,int p1,...); 
```

你说函数id和参数的地方，确定你现在必须哪个函数是每个id

# linux - AWK 日期到纪元

> ID：10180609
> 
> 赞同：0
> 
> 时间：2012-04-16T19:46:30.283
> 
> 标签：linux, bash, unix, awk

我有以下命令从文件中返回日期

```
tail -1 MyFile | awk -F ',' '{print $7}' 
```

像这样返回日期`04/16/12 20:44:19`

我想通过以某种方式修改 awk 命令来将该日期转换为纪元时间，方法是将 $7 输入`date -d $7 +%s`

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-23T13:11:40.930

*GNU awk*有*内置*的时间函数：

```
tail -1 infile | awk -F, '{
  split($7, t, /[/: ]+/)
  t[3] = t[3] > 69 ? 19 t[3] : 20 t[3]
  print mktime(t[3]" "t[1]" "t[2]" "t[4]" "t[5]" "t[6]) 
  }' 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-16T19:56:18.003

我认为`awk`这份工作有点重，`cut`也许有点轻：

```
tail -1 MyFile | date -d "`cut -d, -f7`" +%s 
```

但当然你也可以这样做`awk`：

```
tail -1 MyFile | date -d "`awk -F, '{ print $7 }'`" +%s 
```

# c# - Visual Studio 2008 - 未处理的异常直接到 Form Dispose

> ID：10180611
> 
> 赞同：0
> 
> 时间：2012-04-16T19:46:37.023
> 
> 标签：c#, winforms, visual-studio-2008, .net-3.5, componentone

我正在使用 Visual Studio 2008，并使用 winform。通常，在发生未处理的异常时，代码会在导致错误的行上中断。但是，它已经开始简单地关闭表单。单步执行代码时，它将直接从未处理的异常转到表单处置，然后关闭我的应用程序。

我是否无意中更改了选项？

出于测试目的，我创建了一个空的 windows 窗体，只有一行：

抛出新异常（）；

并观察到同样的行为。此外，当出现用户未处理的异常时，一切都会中断。我已经尝试了另一个没有问题的项目，所以它必须是特定于项目的。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-16T20:13:02.407

转到菜单 | 调试 | 异常...并确保 VS 在适当的异常上中断。

# grails - 如何将基于 hudson 构建的 grails 应用程序部署到 JbossAS 7？

> ID：10180619
> 
> 赞同：2
> 
> 时间：2012-04-16T19:47:20.007
> 
> 标签：grails, hudson, jboss7.x, hudson-plugins

我们有一个使用 hudson 构建的 grails 应用程序。Hudson 过去通过 tomcat-manager 将生成的 war 部署到 tomcat。现在我们正在迁移到 JBoss 7，在 hudson 中没有明显的步骤可以部署到 JBoss7。是否有我可以使用的 JBoss7 部署插件？或者在 JBoss7 上执行部署的命令？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-16T22:25:15.077

你应该看看这个： [https ://docs.jboss.org/jbossas/7/plugins/maven/latest/](https://docs.jboss.org/jbossas/7/plugins/maven/latest/)

此外，如果您更喜欢使用脚本：[https](https://github.com/maxandersen/as7scripting) ://github.com/maxandersen/as7scripting （现在可能有点过时了）

问候

# mysql - MySQL 选择同时属于这两个类别的产品

> ID：10180624
> 
> 赞同：0
> 
> 时间：2012-04-16T19:47:51.927
> 
> 标签：mysql, select

## 产品

```
PRODUCTID;NAME
1        ;BMW
2        ;AUDI
3        ;Mercedes
4        ;Volvo 
```

## 产品类别

```
CATID;CATNAME
1    ;Car
2    ;Motorcicle;
3    ;Bus 
```

## 产品类别Rel

```
PRODUCTID;CATID;
1        ;1
1        ;2
2        ;1
3        ;1
4        ;3 
```

如果我使用 SQL

```
SELECT productID FROM  productCategiresRel WHERE catID IN (1,2) 
```

结果是

```
productCategiresRel
PRODUCTID;CATID;
1        ;1
1        ;2
2        ;1
3        ;1
4        ;3 
```

但我想选择在两个选择类别（汽车和摩托车）中都有代表的这些产品。

结果应该是：

```
PRODUCTID;CATID;
1        ;1 (Car)
1        ;2 (Motorcicle) 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-16T19:50:54.223

您可以使用 an`EXISTS`检查多次。

```
SELECT *
FROM products
WHERE EXISTS (SELECT '' 
    FROM productCategiresRel 
    WHERE catID = 1
    AND productCategiresRel.productId = products.productId)
AND EXISTS (SELECT '' 
    FROM productCategiresRel 
    WHERE catID = 2
    AND productCategiresRel.productId = products.productId) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-16T19:58:54.727

或者，如果您想查找属于多个类别的所有产品（不仅仅是类别 1 和 2），请尝试以下操作：

```
SELECT *
FROM products
WHERE productID IN (
    SELECT productID
    FROM productCategiresRel
    GROUP BY productID
    HAVING COUNT(*) > 1
); 
```

# php - 带有“”的PHP序列化错误计为两个字符

> ID：10180627
> 
> 赞同：0
> 
> 时间：2012-04-16T19:48:03.060
> 
> 标签：php, wordpress, serialization

我在使用 php 序列化时遇到问题，如果包含“”，我会得到一个额外的字符空间。例如，如果它是 6 个字符，我会得到 7 个

```
 $episodes_count = sizeof($episode_title);
$episodes = array();
$content = '';

for ($i = 0; $i <= $episodes_count; $i++) {
    $title = htmlspecialchars($episode_title[$i], ENT_QUOTES);
    $airdate    = $episodes_airdates[$i];
    $season    = $episodes_seasons[$i];
    $number    = $episodes_numbers[$i];
    $plot    = $episodes_plot[$i];

    // check if empty
    if (!empty($title) && !empty($number ) && !empty($plot )) {
        $episodes[] = array(
            'title' => $title, 
            'airdate' => $airdate,
            'season' => $season,
            'number'   => $number,
            'plot'   => $plot,
        );
    }
}

// Serialized Episodes in case they exist, if not, remove the goal post
if ( sizeof($episodes) > 0 ) {
    $content = str_replace("'", '%',serialize($episodes));
}

update_post_meta($post_id, 'episodes', $content);
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-18T08:07:52.240

您将一些看起来序列化的数据传递给 wordpress `update_post_meta`- wordpress 可能会遇到问题，并且数据在存储和检索时会被破坏。

为了防止这种情况，您可以为字符串添加前缀，使其看起来不再序列化，或者您甚至对整个字符串进行编码，例如使用[`base64_encode`](http://php.net/base64_encode). 这将防止 wordpress 和其他组件由于编码问题而修改值。

# android - 如何以编程方式创建 Android 测试项目？

> ID：10180629
> 
> 赞同：1
> 
> 时间：2012-04-16T19:48:05.890
> 
> 标签：android, testing, project

我试过这样的事情：

```
public boolean createTestProject(String projectName, IProject testedProject, int apiLevel){
        NewProjectWizardState mValues = new NewProjectWizardState(Mode.TEST);
        mValues.projectName = projectName;
        if(testedProject != null){
            mValues.testedProject = testedProject;
            mValues.testingSelf = false;
            mValues.useExisting = false;
        }
        else{
            mValues.testingSelf = true;
            mValues.useExisting = false;
        }
        mValues.minSdk = "1.5";
        mValues.minSdkModifiedByUser = true;
        mValues.useDefaultLocation = true;
        mValues.projectLocationModifiedByUser = false;
        mValues.createActivity = false;
        mValues.activityName = "sf";
        mValues.applicationName = "sf";
        mValues.packageName = "sf";
        NewProjectCreator creator = new NewProjectCreator(mValues, getContainer());

        return creator.createAndroidProjects();
    } 
```

但它会在 com.android.ide.eclipse.adt.internal.wizards.newproject.NewProjectCreator.createEclipseProject(NewProjectCreator.java:561) 处引发 NullPointerException。我检查了那个文件（可能是旧版本），这一行是空的。我错过了什么？

编辑：好的，我解决了。我错过了几件事。现在它可以工作了，它甚至可以创建 android 项目（不是测试）：

```
public IProject createProject(String projectName, IProject testedProject,
    boolean testMode, int apiLevel, IWizardContainer container,
    Type type, String packName) throws Exception {
    NewProjectWizardState mValues;
    if (testMode) {
        mValues = new NewProjectWizardState(Mode.TEST);
    } else {
        mValues = new NewProjectWizardState(Mode.ANY);
    }
    mValues.projectName = projectName;
    mValues.projectNameModifiedByUser = true;
    mValues.applicationName = capitalize(mValues.projectName);
    mValues.testApplicationName = projectName;
    mValues.createActivity = false;
    mValues.testedProject = testedProject;
    mValues.minSdk = apiLevel;
    mValues.updateSdkTargetToMatchMinSdkVersion();
    String value = Platform.getLocation().append(mValues.projectName)
            .toString();
    value = TextProcessor.process(value);
    mValues.projectLocation = new File(value);
    mValues.packageName = "com.example.android.apis.test";
    if (testedProject != null) {
        mValues.testProjectName = projectName;
        mValues.packageName = String.format("%1$s.test",
            Helper.getPackageName(testedProject));
        mValues.createPairProject = false;
        mValues.testTargetPackageName = Helper
            .getPackageName(testedProject);
    }
    if (testedProject == null && testMode) {
        mValues.createPairProject = false;
        mValues.testProjectName = projectName;
        mValues.testTargetPackageName = "com.example.android.apis";
    }
    if (packName != null && packName.length > 0) {
        mValues.packageName = packName;
    }
    NewProjectCreator creator = new NewProjectCreator(mValues,
            container);

    creator.createAndroidProjects();
    return ResourcesPlugin.getWorkspace().getRoot().getProject(projectName);
} 
```

# jquery - 为什么这个处理程序在 Chrome 上不起作用？

> ID：10180630
> 
> 赞同：0
> 
> 时间：2012-04-16T19:48:21.077
> 
> 标签：jquery, google-chrome

[代码](http://jsfiddle.net/cSBET/)：

```
<select id="example">
    <option value="38">Marco</option>
    <option value="39">Hello</option>
</select>​

$("#example> option").click(function () {
    alert("ciao");
}); 
```

单击下拉项目，不显示警报... IE 和 Firefox 没有问题..

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-16T19:50:16.570

使用`$('#example').change(...)`- 选择/单击一个元素将更改选择框的值，这样应该可以工作。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-16T19:51:40.140

请改用更改功能 - 它非常适合下拉菜单。

```
$('#example').change(function() {
    alert('ciao');
}); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-16T20:02:21.387

似乎是在元素`.change()`上进行此操作的正确方法。`<select>`

`<select>`但是请注意，一旦在因为`this`引用`<select>`元素而不是元素的更改事件上触发了更改事件，您就必须手动检索该选项`<option>`。

你必须这样做：`var $selected = $(this).find(":selected");`

`$selected`将包含选择选项，或者如果启用了多选，则包含多个选择的选项。

只是想澄清一下`.change()`是用于`<select>`元素而不是`<option>`元素。

# r - R中的双变量泊松回归？

> ID：10180631
> 
> 赞同：11
> 
> 时间：2012-04-16T19:48:25.650
> 
> 标签：r, poisson

我为 R 找到了一个包“bivpois”，它评估两个相关泊松过程的模型（例如，足球比赛中主队和客队的进球数）。但是，这个包似乎不再可用于较新版本的 R。

是否有合理的方法来修改 glm() 函数以执行类似的过程，或者在我的新版本 R 上运行这个旧包？我发现关于这类过程的文献很少，并且在其他统计软件包（如 STATA）中易于实施方面也很少发现。

任何建议将不胜感激。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-04-17T16:01:54.027

虽然 CRAN 不托管当前的 bivpois 二进制文件，但您可以从存档的源代码构建包（参见[http://cran.r-project.org/doc/manuals/R-exts.html#Checking-and-building -包](http://cran.r-project.org/doc/manuals/R-exts.html#Checking-and-building-packages)）。从源代码构建 bivpois 0.50-3.1（可在[http://cran.r-project.org/src/contrib/Archive/bivpois/ 获得](http://cran.r-project.org/src/contrib/Archive/bivpois/)）适用于 R 2.15.0 Windows x64。我构建的压缩 Windows 二进制文件可在此处获得：[http](http://commondatastorage.googleapis.com/jthetzel-public/bivpois_0.50-3.1.zip) ://commondatastorage.googleapis.com/jthetzel-public/bivpois_0.50-3.1.zip 。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-12-05T11:55:22.163

您可以随意参考[体育博彩公司的赔率建模和测试效率低下，](https://github.com/scibrokes/odds-modelling-and-testing-inefficiency-of-sports-bookmakers)因为我已经修改了`bivpois`包内的相关功能。

# c++ - C++ 将一个类实例转换为另一个实例抛出：没有合适的定义从类到类 2 的转换

> ID：10180632
> 
> 赞同：-1
> 
> 时间：2012-04-16T19:48:32.567
> 
> 标签：c++

这是我的代码：

```
using namespace std;

class HuffmanTree
{
public: 
    int frequency;

    HuffmanTree(){}
    HuffmanTree(int freq)
    {
        frequency = freq;
    }

    int compareTo(HuffmanTree tree)
    {
        return frequency - tree.frequency;
    }
}

class HuffmanLeaf : public HuffmanTree
{
public:
    char value;

    HuffmanLeaf(int freq, char val)
    {
        HuffmanTree(freq);
        value = val;
    }
}

class HuffmanNode : public HuffmanTree
{
public:
    HuffmanTree left, right;

    HuffmanNode(HuffmanTree l, HuffmanTree r)
    {
        HuffmanTree(l.frequency + r.frequency);
        left = l;
        right = r;
    }
}

class HuffmanCode
{
    static HuffmanTree buildTree(int charFreqs[])
    {
        priority_queue<HuffmanTree> pq;

        for(int i = 0; i < sizeof(charFreqs)/sizeof(char); i++)
        {
            if(charFreqs[i] > 0)
                pq.push(HuffmanLeaf(charFreqs[i], (char)i));
        }
        while (pq.size() > 1)
        {
            // two trees with least frequency
            HuffmanTree a = pq.top();
            pq.pop();
            HuffmanTree b = pq.top();
            pq.pop();

            // put into new node and re-insert into queue
            pq.push(HuffmanNode(a, b));
        }
        HuffmanTree c = pq.top();
        pq.pop();
        return c;
    }
}

static void printCodes(HuffmanTree tree, string prefix) {
    //assert tree != null;
    HuffmanTree* baseClass;
    HuffmanLeaf* leafClass;
    HuffmanNode* nodeClass;
    if (typeid(*baseClass) == typeid(HuffmanLeaf)) 
    {
        HuffmanLeaf leaf = (HuffmanLeaf)tree;

        // print out character, frequency, and code for this leaf (which is just the prefix)
        cout<<leaf.value<<"\t"<<leaf.frequency<<"\t"<<prefix;
    }
    else if (typeid(*baseClass) == typeid(HuffmanNode)) 
    {
        HuffmanNode node = (HuffmanNode)tree;

        // traverse left
        prefix.append("0");
        printCodes(node.left, prefix);
        prefix.erase(prefix.length()-1);

        // traverse right
        prefix.append("1");
        printCodes(node.right, prefix);
        prefix.erase(prefix.length()-1);
    }
} 
```

我不知道如何解决线路失败的问题

```
HuffmanNode node = (HuffmanNode)tree;
HuffmanLeaf leaf = (HuffmanLeaf)tree; 
```

我知道它与类型转换有关，并且我对 dynamic_cast、static_cast 和其他两个进行了研究，但我似乎无法弄清楚它的要求。任何帮助，将不胜感激。如果您发现任何其他问题，请告诉我。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-16T19:55:33.340

垂头丧气是违法的。A`HuffmanTree`既不是 a`HuffmanNode`也不是 a `HuffmanLeaf`，而是相反。

你试图做的事情并没有真正的意义。为什么要将 a 转换`HuffmanTree`为 a`HuffmanNode`或 a `HuffmanLeaf`？

无论哪种方式，要**编译**它（但同样，它没有意义），您必须为`HuffmanNode`or`HuffmanLeaf`或 add `operator HuffmanNode()`and `operator HuffmanLeaf()`to声明转换构造函数`HuffmanTree`。

# prestashop - PrestaShop - 使用附加参数重新加载 CMS 页面

> ID：10180635
> 
> 赞同：0
> 
> 时间：2012-04-16T19:48:35.183
> 
> 标签：prestashop

**情况**：我需要使用 POST 方法将表单添加到 CMS 页面。我创建了自定义钩子和一个成功显示表单的模块。然后我需要对用户输入错误做出反应，例如。当用户没有输入电子邮件地址时，我需要检测它，再次显示整个页面以及表单，并在用户输入中明确说明“错误”。

**问题**：问题是再次显示整个页面以及相关信息（例如，关于错误等）。当我添加这种代码时，在模块 PHP 文件中，

```
return $this->display(__FILE__, 'modulename.tpl'); 
```

它（自然）只显示表单，而不是带有表单的整个 CMS 页面。

在此代码的情况下，

```
Tools::redirectLink('cms.php?id_cms=7'); 
```

我无法通过 GET 和 POST 方法传输任何信息。

```
$_POST['test'] = 1;
Tools::redirectLink('cms.php?id_cms=7&test'); 
```

我也尝试分配给 smarty 变量

```
$smarty->assign('test', '1'); 
```

（我需要在创建表单本身的 .tpl 文件中使用它）但没有办法让它工作。

```
{if isset($test)}...,
{if isset($smarty.post.test)}...,
{if isset($_POST['test'])}... {* neither of these conditionals end up as true *} 
```

即使将 GET 参数分配给 url 也没有影响，因为我猜，无论我是否包含其他参数，都会对某种友好的 url 进行链接重写。( `[SHOPNAME]/cms.php?id_cms=7&test`-> `[SHOPNAME]/content/7-cmspage-name`)

**我的问题是**：有没有办法在 prestashop 中“重定向”或“重新加载”当前页面（或通常可能是任何页面）以及我自己的数据？

我有点解释了整个案例，所以我愿意听到比我更好的整体解决方案（也许我完全以错误的方式思考这个案例）。这将是其他可能的答案。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-20T11:21:54.213

最简单的方法是使用 javascript 来验证表单 - 您可以使用 jQuery 突出显示错误的字段；提供有关提交失败的视觉反馈。实际上，您不允许用户提交表单（从而离开页面），直到您对操作成功感到高兴。我假设您将在收到成功提交后重定向到另一个页面。

有很多文章和操作方法可用于使用 javascript，实际上还有 jQuery 用于表单验证。如果您想保持站点精简和平均，那么您可以为 CMS 控制器提供覆盖，并且仅将您想要使用表单验证的特定页面的脚本排入队列。

If the validation is complex, then you might be best using AJAX and just reloading the form section of your page via a call to your module. Hooks aren't great for this kind of thing, so you might want to consider using an alternative mnethod to inject your code onto the cms page. I've written a few articles on this alternative approach which can be found on my [prestashop blog](http://www.ecartservice.net/prestashop-articles/1-4-plugins-revisited-part-1/)

# android - 依赖的附加 APK

> ID：10180636
> 
> 赞同：0
> 
> 时间：2012-04-16T19:48:36.170
> 
> 标签：android, android-manifest

您好，我正在尝试为我自己现有的 Android 应用程序构建一个单独的附加组件。

如果用户没有像“uses-library”这样的主应用程序，我希望这个附加组件隐藏在 android 市场上。我尝试在项目 1 的包名中使用“uses-library”，但编译器只是说无法安装库不存在！它安装在设备上。我是否还必须将共享库添加到第一个项目清单中？还是我完全偏离目标！

Astro 用它的专业版、蓝牙和网络模块来做这种事情。

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-16T20:00:36.487

我认为该功能是不可能的。

android 市场进行自己的过滤以确定哪些应用程序显示给女巫设备/用户。到目前为止，我不相信有任何公共 API 可以与任何这些功能进行交互。

我刚刚在没有安装任何 Astro 应用程序的情况下仔细检查了我的设备，如果我搜索 Astro Developer，我仍然可以看到市场上的蓝牙和网络模块。所以我认为你误解了他们的部署方式。

# c# - 如何让我的视图看起来像一个时间表

> ID：10180642
> 
> 赞同：0
> 
> 时间：2012-04-16T19:48:53.800
> 
> 标签：c#, asp.net-mvc, asp.net-mvc-3, entity-framework

我正在使用 MVC3 和实体框架

我有一张桌子：

id - 星期几 - 肌肉 - 组数 - 客户

这是一张桌子……这只是一个简单的小项目。

但我的问题是我不知道如何获得正确的视图。

```
 **Monday    Tuesday    Wednesday   Thursday   Friday   Saturday   Sunday**
    Muscle    Muscle     etc...
    sets      sets 
```

我认为我应该做的...首先获取客户（他创建的）想要锻炼的天数列表

模型

Fitnessday 是一个属性，它通过 datacontext 与我的数据库连接。

很喜欢

```
 public class FitnessDay
  {
    public int id { get; set; }
    public string dayoftheweek{ get; set; }
    public string muscle{ get; set; }
    public Nullable<int> sets{ get; set; }
    public Nullable<int> customerId{ get; set; }

     public virtual Customer Customers{ get; set; }
  }

  public class Customer 
   {
    public Customer()
    {
        this.fitnessDay = new HashSet<fitnessDay>();
    }

    // Primitive properties

    public int id { get; set; }
    public string name{ get; set; }
    public string lastname{ get; set; }

    // Navigation properties

    public virtual ICollection<fitnessDay> fitnessDay { get; set; }

 } 
```

-

```
 private IList<fitnessDay> trainingList= null;

          public IList<fitnessDay> Training() 
       {
           string nameOfCustomer= "bob";
           var Training1 = db.fitness.Where(c => c.Customer.name== nameOfCustomer); 

           trainingList= Training1.ToList();
           return trainingList;

       } 
```

控制器

```
 public ViewResult TrainingView()
    {
        var list = model.training();

        return View(list); 
    } 
```

看法

```
 Don't know how to show it here. 
```

有人可以帮我找出星期几并放置适当的肌肉并放在它下面（每天可能有几块肌肉）

编辑：添加了新信息

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-16T20:03:06.627

这是为了显示元素周期表而创建的，但它是一个很棒的 ui [http://isotope.metafizzy.co/](http://isotope.metafizzy.co/) 它确实需要相当多的 jquery 知识，但同样，它是一个很好的 ui，适应性很强。也就是说，当然，如果您正在寻找比日历更多的东西。

**编辑** 由于 jquery 真的不是你的事，我认为这是一个简单的建议。在控制器端，加载所有培训课程 ORDER ASC（我不知道如何使用 Linq，但肯定可以完成）。我还假设您知道您要查询的培训日期之间的日期。所以在控制器中你会聚集这样的日期：

```
 public ActionResult Trainings()
    {
        //dummy data
        var trainings = new List<Training>();
        trainings.Add(new Training { TrainingDay = DateTime.Now });

        var week = new Dictionary<DayOfWeek, List<Training>>() 
        { 
            { DayOfWeek.Monday, new List<Training>() },
            { DayOfWeek.Tuesday, new List<Training>() },
            { DayOfWeek.Wednesday, new List<Training>() },
            { DayOfWeek.Thursday, new List<Training>() },
            { DayOfWeek.Friday, new List<Training>() },
            { DayOfWeek.Saturday, new List<Training>() },
            { DayOfWeek.Sunday, new List<Training>() },
        };
        for (int i = 0; i < trainings.Count; i++) 
        {
            switch (trainings[i].TrainingDay.DayOfWeek)
            {
                case DayOfWeek.Friday:
                    week[DayOfWeek.Friday].Add(trainings[i]);
                    break;
                case DayOfWeek.Monday:
                    week[DayOfWeek.Monday].Add(trainings[i]);
                    break;
                case .....

            }
        }
        return View(week);
    } 
```

这将使所有训练都在同一天进行（我听说有些人一天去健身房的次数更多，不确定这是不是真的）。现在，您可以让视图强类型化，因此您可以将其更改为：

```
<%@ Page Language="C#" MasterPageFile="~/Views/Shared/Site.Master" Inherits="System.Web.Mvc.ViewPage<Dictionary<DayOfWeek, List<Training>>>" %> 
```

并且不要忘记`<%@ Import %>`培训`namespace`，最后你看到的可能是这样的：

```
 <table>
        <tr>
            <td>Monday</td>
            <td>Tuesday</td>
            <td>Wednesday</td>
            <td>Thursday</td>
            <td>Friday</td>
            <td>Saturday</td>
            <td>Sunday</td>
        </tr>
        <tr>
            <%foreach (KeyValuePair<DayOfWeek, List<Training>> entry in Model){%>
                <td>
                    <%if (entry.Key == DayOfWeek.Monday){
                       foreach (var training in entry.Value){
                        Response.Write(training.TrainingDay); 
                       } 
                    }%> 
                </td>
            <%} %>
        </tr>
   </table> 
```

显然，您可以为 Html 对象创建扩展方法，而不是为条目重复相同的代码。

# string - 将字符串转换为数字而不使用任何 java 转换函数/实用程序类

> ID：10180649
> 
> 赞同：0
> 
> 时间：2012-04-16T19:49:29.270
> 
> 标签：string, numbers, data-conversion

在一次 Java 面试中，我被要求编写一个程序，该程序可以将字符串（例如“123”）转换为数字 123，而无需使用任何 java 的转换函数/实用程序类。

如果这可能，我仍然感到困惑。有任何想法吗 ？谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-16T19:52:53.250

将字符串分解为单个字符，将每个字符映射到其数值，然后通过将每个字符乘以其位置值来组合。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-16T19:57:15.417

我应该让我的评论成为答案，这样我才能得到答案:)

“什么算作实用程序类？你能有一个字符串到数字的映射，遍历字符串，通过字符串查找数字，然后构造数字吗？”

在伪代码中：

```
Map<String, Integer> = {
"0":0,
"1":1,
"2":2,
... etc }

int number = 0;

for(i=string.length-1; i>=0; i--){
String substr = string.substring(i, i+1);
int digit = map.get(substr);
number += 10^(string.length-i)*digit;
}

return number 
```

# c# - Basic Booksleeve 加上 Protobuf-net 加上 Lists/SortedSets，实现？

> ID：10180650
> 
> 赞同：1
> 
> 时间：2012-04-16T19:49:34.080
> 
> 标签：c#, redis, protobuf-net, booksleeve

关于将 bookleeve 与 protobuf-net 结合使用，我有一些相当基本的问题。现在我已经实现了一个单例类来管理连接，因此我按照[推荐](https://stackoverflow.com/questions/6477623/how-should-i-be-using-booksleeve-with-protobuf-net)的方式多次重复使用相同的连接。现在我有几个关于实际使用组合的问题：

1.  “db” int 和“key” 字符串的区别/重要性是什么？
2.  如何使用 protobuf-net 将一堆对象序列化为 SortedSet/List？
3.  如何使用 protobuf-net 从 SortedSet/List 反序列化一堆对象？

我在想我应该使用 Range() 方法进行检索：

```
 public IList<T> RetrieveAllAsList()
    {
        var conn = RedisConnectionManager.Current.GetConnection();
        conn.Open();

        int length = (int)conn.Lists.GetLength(10, "idk").Result;
        byte[][] data = conn.Lists.Range(10, "idk", 0, length-1).Result;

        List<T> output = new List<T>();
        for (int i = 0; i < data.Length; i++)
        {
            using (MemoryStream ms = new MemoryStream(data[i]))
            {
                output.Add(Serializer.Deserialize<T>(ms));
            }
        }

        conn.Close(false);
        return output;
    } 
```

我将不胜感激在这件事上的任何帮助。谢谢你。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-16T20:58:04.733

> “db” int 和“key” 字符串的区别/重要性是什么？

Redis 允许您将数据分区到多个数据库中。例如，在 stackexchange 网站上，您可以将 stackoverflow.com 相关内容存储在 db=0 中，将programmers.se.com 相关内容存储在 db = 1 中。

在每个数据库中，您都有 key = value 对。键始终是字符串。该值可以是以下五种数据类型之一 - String、List、Set、Sorted Set 或 Map。

传统的 Redis 客户端不会强制您提供数据库编号。如果您不提供，则假定 db=0。但是 Booksleeve 要求您提供数据库编号。如果您不在乎，只需将 0 传递给所有 API 调用。

但是，字符串键必须是唯一的，并且完全是特定于应用程序的。例如，要存储一个用户对象，通常的技术是有一个像 一样的键`user:1190099`，而值是一个带有键=值对的 Map，比如`{"name":"singlelabs", "id":1190099 ... }`

> 如何使用 protobuf-net 将一堆对象序列化为 SortedSet/List？如何使用 protobuf-net 从 SortedSet/List 反序列化一堆对象？

首先，您需要决定是否要使用协议缓冲区。

协议缓冲区可以将复杂对象序列化/反序列化为二进制 blob。这个 blob 对 Redis 是不透明的。换句话说，您可以设置或获取此二进制 blob，但不能使用任何其他 Redis 功能。

如果你真的想使用 Redis 的列表和排序集，你应该使用 BookSleeve 提供的 API。我没用过Booksleeve，但是下面两个接口应该解释一下如何将数据插入到list/sortedset中。

[http://code.google.com/p/booksleeve/source/browse/BookSleeve/ISortedSetCommands.cs](http://code.google.com/p/booksleeve/source/browse/BookSleeve/ISortedSetCommands.cs)

[http://code.google.com/p/booksleeve/source/browse/BookSleeve/IListCommands.cs](http://code.google.com/p/booksleeve/source/browse/BookSleeve/IListCommands.cs)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-17T06:55:13.640

Sripathi 已经很好地解释了 DB 密钥*是*什么。需要它的原因是 BookSleeve 用作多路复用器，因此当不同的调用*者*使用不同的数据库时，需要传递它以避免竞争条件。如果您不使用多个数据库，只需传递 0。

重新序列化/反序列化 - 这是故意单独完成的，以便调用者可以*为它们*使用适当的序列化- 所以 BookSleeve 只知道字符串和 blob。不过，您的序列化代码看起来还不错。

我唯一的批评是没有必要先得到长度。智能感知应该说明用法 - 我希望通过 -1 或 int.MaxValue 将列出所有项目，而无需先获取长度（抱歉含糊不清，但我在候机室）。这避免了网络旅行。

# mysql - 是否有 MySQL 命令删除除 PRIMARY 索引之外的所有索引？

> ID：10180653
> 
> 赞同：4
> 
> 时间：2012-04-16T19:49:34.950
> 
> 标签：mysql, indexing, sql-delete

我有一个带有一个索引的数据库表，其中键名是 PRIMARY，类型是 BTREE，唯一是 YES，打包是 NO，列是 ID，基数是 728，排序规则是 A。

我有一个在页面加载时运行的脚本，它将条目添加到 MySQL 数据库表中，并从数据库表中删除重复项。

以下是删除重复项的脚本部分：

```
// Removes Duplicates from the MySQL Database Table

   // Removes Duplicates from the MySQL Database Table based on 'Entry_Date' field
      mysql_query("Alter IGNORE table $TableName add unique key (Entry_Date)");

   // Deletes the added index created by the Removes Duplicates function
      mysql_query("ALTER TABLE $TableName DROP INDEX Entry_Date"); 
```

使用上面的 Remove Duplicates 命令，将一个附加索引添加到表中。下一行命令假设删除这个添加的索引。

问题是有时由 Removes Duplicates 命令创建的添加索引不会被以下 Delete added index 命令删除，因此会向表中添加更多索引。在我手动删除添加的索引之前，这些额外的索引会阻止脚本向数据库添加额外的数据。

我的问题：有没有可以添加到脚本中的命令或短函数来删除除本文开头提到的原始索引之外的所有索引？

我确实阅读了以下帖子，但我不知道这是否是要使用的正确脚本： [如何使用单个查询删除除主键之外的所有索引](https://stackoverflow.com/questions/7530103/how-to-drop-all-of-the-indexes-except-primary-keys-with-single-query)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-16T20:05:39.807

我不这么认为，您可以做的是创建副本，但这不会复制索引。例如，如果您将 create table1 作为 (select * from table_2)，他将进行复制但没有索引或 PK。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-16T21:06:41.187

在所有的评论之后，我想我意识到发生了什么。您实际上允许在数据库中重复。您只想清洁它们几次。问题是您选择清理它们的方法是通过创建唯一键并使用 IGNORE 选项导致重复行被删除而不是使唯一键创建失败。然后删除唯一键，以便可以再次添加重复的行。您的问题是，有时唯一键没有被删除。

我建议您以另一种方式删除重复项。假设您的表名是“my_table”并且您的主键是 my_mey_column，那么：

```
delete from my_table where my_key_column not in (select min(my_key_column) from my_table group by Entry_Date) 
```

**编辑**：由于@a_horse_with_no_name 指出的mysql中的限制，上述内容将不起作用

请尝试以下三个查询：

```
create temporary table if not exists tmp_posting_data select id from posting_data where 1=2 

insert into tmp_posting_data(id) select min(id) from posting_data group by Entry_Date

delete from Posting_Data where id not in (select id FROM tmp_posting_data) 
```

最后一点，请尝试重新考虑是否需要按照@a_horse_with_no_name 的建议允许复制行。您可以在数据库中创建一次唯一键，而不是允许输入然后删除行，例如：

```
Alter table posting_data add unique key (Entry_Date) 
```

然后，当您从 RSS 插入新数据时，使用以下内容而不是“插入”使用“替换”，如果旧行在主键或任何唯一索引上重复，它将删除旧行

```
replace into posting_data (......) values(.....) 
```

# java - 为什么锁定被捕获到局部变量

> ID：10180656
> 
> 赞同：6
> 
> 时间：2012-04-16T19:49:51.620
> 
> 标签：java, reentrantlock

在java JRE中我看到[了代码](http://svn.apache.org/repos/asf/harmony/standard/classlib/trunk/modules/concurrent/src/main/java/java/util/concurrent/DelayQueue.java)

```
private final ReentrantLock lock;
public E poll() {
        final ReentrantLock lock = this.lock;
        lock.lock(); 
```

为什么锁定被捕获到私有变量？我希望简单

```
public E poll() {
        lock.lock(); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-16T19:52:31.603

主要是为了确保最大的性能。虽然这是一个真正的微优化，但它可能是在性能敏感的代码中，你不妨去做。

您还需要*非常*小心，您正在使用的锁引用不会发生变化。当然 make field `final`，但是获取`final`本地引用是本地显式的。

# apache - 没有输入文件指定apache

> ID：10180666
> 
> 赞同：1
> 
> 时间：2012-04-16T19:50:44.357
> 
> 标签：apache, .htaccess, ubuntu

我使用灯泡，当我尝试将新的 php 文件添加到我的网站文件夹时没有输入错误我尝试研究它但没有修复它这个我的 htaccess 文件

```
 <Directory /var/www/>
            Options Indexes FollowSymLinks MultiViews
            AllowOverride all
            Order allow,deny
            allow from all
            # Uncomment this directive is you want to see apache2's
            # default start page (in /apache2-default) when you go to /
            #RedirectMatch ^/$ /apache2-default/
    </Directory> 
```

我已经安装了这个`sudo a2enmod rewrite`

谢谢三木

# javascript - 使用 Javascript 检索最新的 5 个 Facebook 墙贴

> ID：10180671
> 
> 赞同：0
> 
> 时间：2012-04-16T19:50:57.227
> 
> 标签：javascript, facebook-graph-api

如何使用 JavaScript 从 Facebook 检索最新的 5 个墙帖？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-16T20:06:04.457

使用[FB.api](https://developers.facebook.com/docs/reference/javascript/FB.api/)

```
FB.api("/me/feed", {limit: 5}, function(data){
    // data is an array of feed posts...
}); 
```

# assembly - x86 hw：字符串声明，在 -1000 和 1000 之间的数字上使用 $？

> ID：10180672
> 
> 赞同：0
> 
> 时间：2012-04-16T19:51:05.880
> 
> 标签：assembly, x86

关于这个家庭作业，我有两个问题：

* * *

在名为 HW5.asm 的文件中编写一个汇编语言程序，该程序将从键盘读取带符号的以 10 为底的数字（小于 1000 且大于 -1000 以 $ 符号结尾）并计算数字的平方并打印回展示。由于我们使用的是 Visual Studio 模拟器并且没有 I/O，因此您必须创建一个字符串变量作为输入，并将一个字符串写入内存作为输出。

* * *

A. 字符串变量应该有多大？字串？

B. 教授所说的“以 $ 符号结尾”是什么意思？真的吗？如何删除它以便正确读取数字？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-16T19:57:25.560

A. 字符串变量将根据需要保存有问题的字符串；鉴于规格，WORD 将不够大。

B. 由于您是编写代码来计算由字符串表示的数值的人，因此您可以按预期使用 $：表示字符串的结尾。

# ninject - 使用 Ninject 访问 SolrNet 中的多个内核时的 ActivationException

> ID：10180683
> 
> 赞同：0
> 
> 时间：2012-04-16T19:51:50.653
> 
> 标签：ninject, solrnet

我想我可能用错了，多核的 Ninject 变体没有太多，但我正在尝试使用 Ninject 和 SolrNet。同时利用完全松散的映射。所以我知道我需要使用 Ninject 命名绑定。不能使用 Windsor，它的 dll 似乎与我们当前的东西不兼容。

可疑代码：

```
SolrServers cores = new SolrServers();

cores.Add(new SolrServerElement
{
    Id = "index1",
    DocumentType = typeof(ISolrOperations<Dictionary<string, object>>).AssemblyQualifiedName,
    Url = "http://localhost:8080/solr/index1",
});

cores.Add(new SolrServerElement
{
    Id = "index2",
    DocumentType = typeof(ISolrOperations<Dictionary<string, object>>).AssemblyQualifiedName,
    Url = "http://localhost:8080/solr/index2",
});

var kernal = new StandardKernel(new SolrNetModule(cores));
var operations = kernal.Get<ISolrOperations<Dictionary<string, object>>>("index1"); 
```

产生的错误：

```
Test 'Test.DifferentTest' failed: 
Ninject.ActivationException : Error activating ISolrOperations{Dictionary{string, Object}}
No matching bindings are available, and the type is not self-bindable.
Activation path:
    1) Request for ISolrOperations{Dictionary{string, Object}} 
```

我了解 DI 的概念，但我知道的并不多，因为在 MVC 中，一切似乎都对我隐藏了。因此，任何额外的解释，关于为什么这是愚蠢的/SolrNet 如何与之交互，将不胜感激。

链接到 SolrNet 模块[https://github.com/mausch/SolrNet/blob/master/Ninject.Integration.SolrNet/SolrNetModule.cs](https://github.com/mausch/SolrNet/blob/master/Ninject.Integration.SolrNet/SolrNetModule.cs)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-16T22:23:28.103

我还没有使用 Solr，但是从我在 github 上找到的模块中，我会说你必须将泛型类型参数分配给文档类型而不是 IsolrOperations

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-17T14:28:04.117

由于我看到您正在使用 SolrNet 的完全松散的映射功能，因此您可以实现以下动态映射作为解决方法，直到将相同类型/类的支持添加到 SolrNet for Ninject。

```
 public class Index1Item
 {
     SolrField["*"]
     public IDictionary<string, object> Fields { get; set; }
 }

 public class Index2Item
 {
     SolrField["*"]
     public IDictionary<string, object> Fields { get; set; }
 } 
```

有关此动态映射的更多详细信息，请参阅[SolrNet](http://code.google.com/p/solrnet/wiki/Mapping)项目页面上的映射。

然后您的 SolrNet 设置将更改为以下内容：

```
 SolrServers cores = new SolrServers();

 cores.Add(new SolrServerElement
 {
     Id = "index1",
     DocumentType = typeof(Index1Item).AssemblyQualifiedName,
     Url = "http://localhost:8080/solr/index1",
 });

 cores.Add(new SolrServerElement
 {
     Id = "index2",
     DocumentType = typeof(Index2Item).AssemblyQualifiedName,
     Url = "http://localhost:8080/solr/index2", 
 });

 var kernal = new StandardKernel(new SolrNetModule(cores));
 var operations = kernal.Get<ISolrOperations<Index1Item>>("index1"); 
```

希望这会有所帮助...

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-02T13:57:01.887

[SolrNet](https://github.com/mausch/SolrNet)已经更新为支持具有命名绑定的同一 DocumentType 的多个核心，因此您的可疑代码现在应该可以工作了。

# mongodb - 用表达式而不是值更新

> ID：10180687
> 
> 赞同：7
> 
> 时间：2012-04-16T19:52:07.657
> 
> 标签：mongodb

我对 MongoDB 完全陌生......我缺少一个“新手”标签，所以专家不必看到这个问题。

我正在尝试使用表达式更新集合中的所有文档。我期望解决的查询是：

```
db.QUESTIONS.update({}, { $set: { i_pp : i_up * 100 - i_down * 20 } }, false, true); 
```

但是，这会导致以下错误消息：

> ReferenceError: i_up 未定义 (shell):1

同时数据库吃这个也没问题：

```
db.QUESTIONS.update({}, { $set: { i_pp : 0 } }, false, true); 
```

我必须一次做一份文件吗？这似乎过于复杂。

**更新** 感谢 Sergio Tulentsev 告诉我它不起作用。现在，我真的很挣扎如何做到这一点。我向乐于助人的灵魂提供 500 个[利润点](http://open-org.com/profit-sharing)，他们可以以 MongoDB 理解的方式编写此代码。如果您在[我们的论坛](http://forum.open-org.com)上注册，我可以在那里将利润点添加到您的帐户中。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-29T03:07:59.127

我只是在搜索相当于 SQL 的 MongoDB 时遇到了这个问题：

```
update t
set c1 = c2
where ... 
```

Sergio 是正确的，您不能在直接更新中引用另一个属性作为值。但是，`db.c.find(...)`返回一个[游标，并且该游标有一个`forEach`方法](http://www.mongodb.org/display/DOCS/Queries+and+Cursors)：

> 对 MongoDB 的查询返回一个游标，可以对其进行迭代以检索结果。查询的确切方式因语言驱动程序而异。下面的详细信息侧重于来自 MongoDB shell（即 `mongo`进程）的查询。
> 
> shell`find()`方法返回一个游标对象，然后我们可以对其进行迭代以从结果中检索特定文档。我们 为此目的使用`hasNext()`和方法。`next()`
> 
> ```
> for( var c = db.parts.find(); c.hasNext(); ) {
>    print( c.next());
> } 
> ```
> 
> 此外，在 shell 中，`forEach()`可以与游标一起使用：
> 
> ```
> db.users.find().forEach( function(u) { print("user: " + u.name); } ); 
> ```

所以你可以这样说：

```
db.QUESTIONS.find({}, {_id: true, i_up: true, i_down: true}).forEach(function(q) {
    db.QUESTIONS.update(
        { _id: q._id },
        { $set: { i_pp: q.i_up * 100 - q.i_down * 20 } }
    );
}); 
```

在不离开 MongoDB 的情况下一次更新它们。

如果您使用驱动程序连接到 MongoDB，那么应该有某种方法可以将 JavaScript 字符串发送到 MongoDB；例如，使用您要使用的 Ruby 驱动程序[`eval`](http://api.mongodb.org/ruby/current/Mongo/DB.html#eval-instance_method)：

```
connection.eval(%q{
    db.QUESTIONS.find({}, {_id: true, i_up: true, i_down: true}).forEach(function(q) {
        db.QUESTIONS.update(
            { _id: q._id },
            { $set: { i_pp: q.i_up * 100 - q.i_down * 20 } }
        );
    });
}) 
```

其他语言应该类似。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-04-16T19:54:31.547

您不能在更新中使用表达式。或者，您不能使用依赖于文档字段的表达式。简单的自包含数学表达式很好（例如`2 * 2`）。

如果要为所有文档设置一个新字段，该字段是其他字段的函数，则必须遍历它们并手动更新。多更新在这里无济于事。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2017-09-27T17:30:38.103

Rha7 给出了一个好主意，但是如果不定义临时变量，上面的代码是行不通的。

此示例代码基于“生日”字段生成年龄（闰年）的近似计算，并将该值插入到所有不包含以下内容的文档的合适字段中：

```
db.employers.find({age: {$exists: false}}).forEach(function(doc){
    var new_age = parseInt((ISODate() - doc.birthday)/(3600*1000*24*365));
    db.employers.update({_id: doc._id}, {$set: {age: new_age}});
}); 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2021-04-09T10:29:34.803

```
//the only differnce is to make it look like and aggregation pipeline
db.table.updateMany({}, [{
      $set: {
        col3:{"$sum":["$col1","$col2"]}
      },
    }]
 )
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2014-01-30T11:26:20.837

从呼叫者 ID 的开头删除“00”的示例：

```
db.call_detail_records_201312.find(
    { destination: /^001/ }, 
    { "destination": true }
).forEach(function(row){
    db.call_detail_records_201312.update(
        { _id: row["_id"] },
        { $set: {
                destination: row["destination"].replace(/^001/, '1')
            }
        }
    )
}); 
```

# xcode - 应用特定音量

> ID：10180694
> 
> 赞同：1
> 
> 时间：2012-04-16T19:52:40.987
> 
> 标签：xcode, macos, volume, nsslider

有没有办法使用 NSslider 更改应用程序音量？我只想更改当前应用程序的音量，而不是系统音量。

# java - 有多少个外部**this** 会有这个内部类？

> ID：10180695
> 
> 赞同：3
> 
> 时间：2012-04-16T19:52:41.850
> 
> 标签：java, inner-classes

我有以下内部类的情况。

```
class Outer {
   private class Inner1 extends InnerBase {
   }
   private class Inner2 extends InnerBase {
   }
   private class InnerBase {
   }
} 
```

通常我认为内部类对外部类有一个额外的、隐藏的“this”。

但是，如果内部类是从另一个内部类派生的，会发生什么呢？

所有内部类（Inner1、Inner2、InnerBase）都应该有一个额外的 this。

Inner1, Inner2 会有自己对外部 this 的引用吗？或者只是重用 InnerBase 中的那个，导致行为略有不同？

（隐藏 this == 指向外部类实例的引用）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-16T19:57:11.133

在内部，层次结构中的每个非静态内部类都有自己的对`this`. 你可以用`javap`

```
$ javap -private Outer.Inner1
Compiled from "Outer.java"
class Outer$Inner1 extends Outer$InnerBase{
    final Outer this$0;
    private Outer$Inner1(Outer);
}

$ javap -private Outer.InnerBase
Compiled from "Outer.java"
class Outer$InnerBase extends java.lang.Object{
    final Outer this$0;
    private Outer$InnerBase(Outer);
    Outer$InnerBase(Outer, Outer$1);
} 
```

`this$0`顺便说一句，如果你真的想要，你可以利用一些晦涩的 java 语法来为父类和子类之间的成员设置不同的值。就是这样：

```
public class Outer {
    class InnerBase {
        Outer innerBaseOuter() { return Outer.this; }
    }

    class Inner1 extends InnerBase {
        public Inner1() {}
        public Inner1(Outer parentOuter) {
            parentOuter.super(); // set a different super in InnerBase
        }
        Outer innerOuter() { return Outer.this; }
    }

    public static void main(String[] args) {
        Outer outer1 = new Outer();
        Outer outer2 = new Outer();

        Inner1 a = outer1.new Inner1();
        System.out.println("Checking (a.base == a.inner) => "+
            (a.innerBaseOuter() == a.innerOuter()));

        Inner1 b = outer1.new Inner1(outer2);
        System.out.println("Checking (b.base == b.inner) => "+
            (b.innerBaseOuter() == b.innerOuter()));
    }
} 
```

运行你得到的程序：

```
Checking (a.base == a.inner) => true
Checking (b.base == b.inner) => false 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-16T20:05:22.317

每个都会引用相同的 Outer 实例。它们每个都有自己对 Outer 的引用，但该引用将指向同一个 Outer 实例。由于无法更改引用，因此从其中任何一个引用外部 this 将是等效的。

```
class Outer {
    private class Inner1 extends InnerBase {
        Outer getOuter() {
            return Outer.this;
        }
    }

    private class Inner2 extends InnerBase {
        Outer getOuter() {
            return Outer.this;
        }
    }

    private class InnerBase {
        Outer getOuter() {
            return Outer.this;
        }
    }

    public static void main(String[] args) {
        new Outer().test();
    }
    public void test() {
        System.out.println((new Inner1()).getOuter());
        System.out.println((new Inner2()).getOuter());
        System.out.println((new InnerBase()).getOuter());
    }
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-16T20:25:56.267

让我们看一下程序：

```
public class Outer 
{
    public Outer() {}
    class Inner1 extends Outer 
    {
        public Inner1() 
        {
            super(); // invokes Object() constructor
        }
    }

    class Inner2 extends Inner1 
    {
        public Inner2() 
        {
            super(); // invokes Inner1() constructor
        }
    }
} 
```

如果尝试编译它，就会发生错误。

```
Outer.java:12: cannot reference this before
supertype constructor has been called
super(); // invokes Inner1() constructor 
```

因为超类`Inner2`本身就是一个内部类，所以一个晦涩的语言规则开始发挥作用。如您所知，内部类的实例化，例如 `Inner1`，需要将封闭实例提供给构造函数。通常，它是隐式提供的，但也可以通过超类构造函数调用形式显式提供`expression.super(args)`

如果封闭实例是隐式提供的，编译器会生成表达式： 它使用 this 引用作为超类是其成员的最内层封闭类。诚然，这有点拗口，但这是编译器所做的。在这种情况下，超类是`Inner1`。因为当前类 , `Inner2`间接扩展 Outer，所以它具有 Inner1 作为继承成员。因此，超类构造函数的限定表达式就是 this。编译器提供一个封闭实例，将 super 重写为 this.super。

默认`Inner2`构造函数在调用超类构造函数之前尝试引用 `this`，这是非法的。

解决此问题的蛮力方法是显式提供合理的封闭实例：

```
public class Outer
{
    class Inner1 extends Outer { }
    class Inner2 extends Inner1 
    {
        public Inner2() 
        {
            Outer.this.super();
        }
    }
} 
```

这可以编译，但很复杂。有一个更好的解决方案： **每当你写一个成员类时，问问自己，这个类真的需要一个封闭的实例吗？如果答案是否定的，请将其设为 static**。内部类有时很有用，但它们很容易引入使程序难以理解的复杂性。它们与泛型、反射和继承有复杂的交互。如果你声明`Inner1`是静态的，问题就会消失。如果你也声明`Inner2`为静态的，你就可以真正理解程序做了什么。

总之，一个类既是内部类又是另一个类的子类很少适合。更一般地说，扩展内部类很少合适。如果必须，请仔细考虑封闭的实例。大多数成员类可以并且应该声明为静态的。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-16T19:58:39.577

您的示例中只有一个“内部”级别，因此每个内部类都可以访问`Outer`您提到的类。

这是一个有趣的例子：

```
public class Test {

    public static void main(String[] args) {
        Level1 l1 = new Level1();
        Level1.Level2 l2 = l1.new Level2();
        Level1.Level2.Level3 l3 = l2.new Level3();
    }

    public static class Level1 {

        private String s = "Level1";

        public Level1() {
            System.out.println(this + ": " + s);
        }

        public class Level2 {

            private String s = "Level2";

            public Level2() {
                System.out.println(this + ": " + s);
                System.out.println("Level1: " + Level1.this);
            }

            public class Level3 extends OtherLevel {

                private String s = "Level3";

                public Level3() {
                    System.out.println(this + ": " + s);
                    System.out.println("Level1: " + Level1.this);
                    System.out.println("Level2: " + Level2.this);

                    System.out.println("super: " + super.toString());
                }
            }
        }

        public class OtherLevel {

            private String s = "OtherLevel";

            public OtherLevel() {
                System.out.println(this + ": " + s);
            }
        }
    }
} 
```

输出：

```
javaapplication4.Test$Level1@70284ac3: Level1
javaapplication4.Test$Level1$Level2@74a14fed: Level2
Level1: javaapplication4.Test$Level1@70284ac3
javaapplication4.Test$Level1$Level2$Level3@88d00c6: OtherLevel
javaapplication4.Test$Level1$Level2$Level3@88d00c6: Level3
Level1: javaapplication4.Test$Level1@70284ac3
Level2: javaapplication4.Test$Level1$Level2@74a14fed
super: javaapplication4.Test$Level1$Level2$Level3@88d00c6 
```

# svn - 当我运行 svn diff 时，'MM' 是什么意思？

> ID：10180700
> 
> 赞同：7
> 
> 时间：2012-04-16T19:53:10.273
> 
> 标签：svn, diff

当我`svn diff`带着`--summarize`论点奔跑时，

```
svn diff --summarize <path1> <path2> 
```

`MM`我在输出中看到一些以开头的行。

我知道`M`是为了修改，`D`为了删除等，但我以前从未见过`MM`。

有谁知道是什么`MM`意思？

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2012-04-16T19:55:57.253

第一列是内容，第二列是属性

因此您的内容及其属性已被修改。

# c - 如何将指针中的值保存到char数组中？

> ID：10180701
> 
> 赞同：1
> 
> 时间：2012-04-16T19:53:10.687
> 
> 标签：c

我有一个包含这样数据的文件

```
{0 /Data1/ , 0x00, 0, 0xFF},

{1 /data2/ , 0x00, 0, 0xFF},

{2 /data3/ , 0x00, 0, 0xFF},

{3 /data4/ , 0x00, 0, 0xFF}, ... 
```

我只想打印每行的第二列。下面是我处理的代码。

```
#include<stdio.h>
#include<string.h>
int main ()
{
char filename[] = "file.txt";
FILE *file = fopen(filename, "r");
if(file!= NULL)
{
char line[128];
char * word1;
char  word2;
char  word3;
int i=0;
clrscr();
while ( fgets( line, sizeof line, file)!= NULL)
{
i=0;
word1 = strtok(line, " ,");

while(word1!= NULL)
{
i++;
if(i==2 ){

printf("%s\n",word1);
}
word1 = strtok(NULL," ,");
}

}
fclose(file);
}
else
{
perror(filename);
}

getch();

return 0;
} 
```

它工作正常。我可以将每行中打印的值保存到数组中吗？我尝试过这样的事情

```
if(i==2){
word2 = * (word1);
} 
printf("%s\n",word1); 
```

但它给了我一个空指针赋值。如何将我打印的值存储到数组中？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-16T20:42:00.930

您只将字符串 word1 的第一个字符保存到 word2 中。

如果要存储所有第二列，则需要分配指向 (char *) 的动态指针数组，然后分配给每个单词/列的空间分配给单词并使用 strcpy 进行复制，因为 word1 在 while 的每次迭代中都会发生变化，因此您可以不要只保存参考。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-16T20:08:46.323

您可以使用动态分配的数组，随着您需要更多空间而增加。请参阅[为什么即使在 C 中分配给大型可变长度数组也具有固定值 -1？](https://stackoverflow.com/questions/4269756/array-with-variable-size-in-c)寻求更多帮助。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-17T00:47:50.893

尝试这样的事情：

```
#define MAX_BUFFER_SIZE 256
/* ... */

char ** lines = malloc(MAX_BUFFER_SIZE + 1);
char ** p = lines;
char ** newbuf;
int len;
int bytesloaded = 0;  
int buf_size = MAX_BUFFER_SIZE;  
assert(lines != NULL);
//... loop etc.. 

if(i==2 ){
   len = strlen(word1);
   bytesloaded += len;

   if(bytesloaded >= buf_size) /* Controls buffer size. For avoid buffer overflow/heap corruption/UB. */
   {
      buf_size += MAX_BUFFER_SIZE;
      newbuf = realloc(lines, buf_size);

      if(!newbuf)  /* return or break. */ 
      {  
        printf("Allocation failed.\n");
        free(lines);
        return 1;
      }

       lines = newbuf;
    }

    *p++ = word1; /* store the word in lines */
    printf("%s\n",word1);
} 
```

注意：不要忘记`\0`在第一个循环结束后将 0 终止符 , 放入数组中。

我没有测试过这段代码，但我相信它可以工作。

这是一个简单的例子：[`a dynamic memory allocation`](http://en.wikipedia.org/wiki/C_dynamic_memory_allocation)控制它的大小，内存重新分配和值存储。

# php - 在 MySQL 中查找重复和匹配条件的用户

> ID：10180703
> 
> 赞同：3
> 
> 时间：2012-04-16T19:53:25.097
> 
> 标签：php, mysql

我的表包含日期、用户、用户位置，例如：

```
20120417 userA location1
20120417  userA location2
20120417  userB location3
20120417  userC location2
20120417  userA location1
20120417  userB location2
20120417 userA location3
20120416 userA location1
20120416  userA location2
20120416  userB location3
20120416  userC location2
20120416  userA location1
20120416  userB location2
20120415 userA location3
20120415 userA location1
20120415  userA location2
20120415  userB location3
20120415  userC location2
20120415  userA location1
20120415  userB location2
20120415 userA location3
20120414 ....
.... 
```

我尝试了几种愚蠢的方法来找到连续 3 天匹配的用户，每天必须至少有 2 个不同的位置。

是否可以使用 sql 查询来执行此操作，或者我应该尝试使用 php 脚本之类的东西？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2015-03-06T21:21:40.097

我认为这行得通。使用 MSSQL，无需复制派生表。

```
SELECT l1.user,l1.thedate, COUNT(*) CNT FROM
( /* Derived table1: user,thedate,loc */
SELECT st.user,st.thedate,COUNT(*) locs FROM sotest st
GROUP BY st.user,st.thedate 
HAVING( COUNT(DISTINCT st.location) > 1)
) l1
JOIN
( /* Derived table2: user,thedate,loc */
SELECT st.user,st.thedate,COUNT(*) locs FROM sotest st
GROUP BY st.user,st.thedate 
HAVING( COUNT(DISTINCT st.location) > 1)
) l2 ON l2.user = l1.user and DATEDIFF(l2.thedate , l1.thedate) = 1
JOIN
( /* Derived table3: user,thedate,loc */
SELECT st.user,st.thedate,COUNT(*) locs FROM sotest st
GROUP BY st.user,st.thedate 
HAVING( COUNT(DISTINCT st.location) > 1)
) l3  ON l3.user = l2.user and DATEDIFF(l3.thedate , l2.thedate) = 1
GROUP BY l1.user,l1.thedate 
```

每个派生表都标识了用户拥有 2 个或更多位置的那些日子。

# 3d - 在 XNA 中编写我自己的 Vector3D 和 Matrix 3D 类是否有用？

> ID：10180704
> 
> 赞同：1
> 
> 时间：2012-04-16T19:53:26.357
> 
> 标签：3d, xna

对于学校，我要编写一个 3D 游戏（非常简单的台球游戏），使用 3D 代数来模拟物理。在 2D 游戏中，我编写了自己的 Vector 和 Matrix 类，效果很好，因为我不必一直从 3D 转换为 2D，这要困难得多，因为我现在很困惑一些非常基本计算，例如球和墙之间的碰撞检测。但我真的很想学习使用矩阵和向量，这样我就知道自己在做什么，而不仅仅是让 XNA 完成所有的工作。所以我的问题是：游戏必须在 8 周内准备好，编写自己的 Vector 和 Matrix 类是否方便，甚至有用，或者这会花费我太长时间吗？提前致谢！

问候，极客

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-16T22:44:18.093

如果你想很好地理解 3D 原理，你*必须*很好地理解 3D 向量和矩阵变换是如何工作的——包括齐次变换和投影。无论如何，使用预先存在的代码来完成这项工作，但没有理由不能同时处理自己的事情。只需将其与您的项目隔离开。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-16T22:06:15.947

这是一个很难回答的问题，但通常永远不要重复某人以前做过的事情。只写你发现你需要的东西。如果您的学校没有要求，请不要这样做。你花在写作上的时间会影响你游戏的整体质量。

时间就是金钱。

# c# - 使用运行时类型执行的通用方法

> ID：10180707
> 
> 赞同：4
> 
> 时间：2012-04-16T19:53:55.180
> 
> 标签：c#, .net, reflection

这很奇怪，但源代码

```
public class Processor<T> where T: class
{
...
    private object WorkWithSubtype(IRequester nextRequester, Type type)
    {
        if (type.GetInterface("IList") != null)
        {
            var originalType = type.GetGenericArguments()[0];
            var list = Activator.CreateInstance(type);

            var method = typeof(Processor<>).GetMethod("GetObjects", BindingFlags.NonPublic | BindingFlags.Instance).MakeGenericMethod(originalType);
            var resList = method.Invoke(this, new object[] { nextRequester });
            typeof(List<>).GetMethod("AddRange").MakeGenericMethod(originalType).Invoke(list, new object[] { resList });
            return list;
        }
    }

    private IEnumerable<K> GetObjects<K>(IRequester requester) where K: class
    {
        ...
        //We can call method WorkWithSubtype in this method sometimes
    }
} 
```

我得到“不能对 ContainsGenericParameters 为真的类型或方法执行后期绑定操作。”。异常是在“var resList = method.Invoke(this, new object[] { nextRequester });”行抛出。你能帮助我吗？提前致谢！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-16T19:58:14.960

您有两个通用参数：一个用于处理器类；另一个用于 GetObjects 方法。在创建泛型方法时，您为方法的类型参数提供了类型参数，但您没有为类的泛型参数提供类型参数。

根据处理器类的用途，您可以尝试以下解决方案之一：

*   使用类型参数构建封闭的泛型类型
*   使用`typeof(Processor<T>)`而不是使用反射来构建封闭的泛型类型
*   从类中删除类型参数
*   从方法中删除类型参数

我认为第二个最有可能是您正在寻找的东西：

```
var method = typeof(Processor<T>)
    .GetMethod("GetObjects", BindingFlags.NonPublic | BindingFlags.Instance)
    .MakeGenericMethod(originalType); 
```

此外，`AddRange`不是通用方法；相反，`List<>`是一个泛型类型，所以：

```
typeof(List<>)
    .MakeGenericType(originalType)
    .GetMethod("AddRange")
    .Invoke(list, new object[] { resList }); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-16T19:59:23.757

您需要像这样使用 MakeGenericType：

```
var method = typeof(Processor<>).MakeGenericType(typeof(T)).GetMethod("GetObjects", BindingFlags.NonPublic | BindingFlags.Instance).MakeGenericMethod(originalType); 
```

同样，当您调用该`AddRange`方法时。

问题是这`List<string>.AddRange`是一种不同的方法，`List<int>.AddRange`并且 MakeGenericType 将类型参数应用于类。GetObjects 仍然需要调用 MakeGenericMethod，因为它具有与包含类 (T) 不同的泛型类型参数 (K)。

# java - JSF：ArrayList 的元素未正确呈现？

> ID：10180709
> 
> 赞同：1
> 
> 时间：2012-04-16T19:54:15.520
> 
> 标签：java, jsf, data-structures, arraylist

我正在尝试`arrayList`在`xhtml`页面上显示元素，但是每次我上传新文件时，然后在状态页面上，我都会获得上次上传文件的多个条目，而不是有关数组中存在的所有元素的详细信息。

这是代码

**XHTML 代码：**

```
<ace:dataTable id ="archiveResults" resizableColumns="true" paginatorPosition="bottom" paginator="true" page="1" value="${fileUpload.resultBeanList}" var="result">
        <ace:column id="fileUploadFileName" headerText="uploaded file" sortBy="#{result.fileName}" filterBy="#{result.fileName}" filterMatchMode="contains">
            <h:outputFormat id="cellFileUploadFileName" value="${result.fileName}" />
        </ace:column>
        <ace:column id="fileUploadTime" headerText="time run" sortBy="#{result.timeRun}" filterBy="#{result.timeRun}" filterMatchMode="contains">
            <h:outputFormat id="cellFileUploadTime" value="${result.timeRun}" />
        </ace:column>
        <ace:column id="fileUploadJobType" headerText="job type" sortBy="#{result.jobType}" filterBy="#{result.jobType}" filterMatchMode="contains">
            <h:outputFormat id="cellFileUploadJobType" value="${result.jobType}" />
        </ace:column>
        <ace:column id="fileUploadStatus" headerText="Status" sortBy="#{result.status}" filterBy="#{result.status}" filterMatchMode="contains">
            <h:outputFormat id="cellFileUploadStatus" value="${result.status}" />
        </ace:column>
</ace:dataTable> 
```

**Java 代码：**

```
 private List<ResultBean> resultBeanList = new ArrayList<ResultBean>();
    private ResultBean resultBean = new ResultBean();

    public ResultBean getResultBean() {
        return resultBean;
    }

    public void setResultBean(ResultBean resultBean) {
        this.resultBean = resultBean;
    }

    public List<ResultBean> getResultBeanList() {
        System.out.println("resultBeanList: "+resultBeanList.toString());
        return resultBeanList;
    }

    public void setResultBeanList(List<ResultBean> resultBeanList) {
        this.resultBeanList = resultBeanList;
    }

public void uploadFile(FileEntryEvent event) {
        FileEntry fileEntry = (FileEntry) event.getSource();
        FileEntryResults results = fileEntry.getResults();
        FileEntry fe = (FileEntry) event.getComponent();
        FacesContext ctx = FacesContext.getCurrentInstance();
        FacesMessage msg = new FacesMessage();
        for (FileEntryResults.FileInfo fileInfo : results.getFiles()) {
            if (fileInfo.isSaved()) {
                File file = fileInfo.getFile();
                String filePath = file.getAbsolutePath();
                resultBean.setStatus(fileInfo.getStatus().toString());
                resultBean.setFileName(fileInfo.getFileName());
                resultBean.setJobType(selectedItem);
                DateFormat dateFormat = new SimpleDateFormat("yyyy/MM/dd HH:mm:ss");
                Date date = new Date();
                Calendar cal = Calendar.getInstance();
                dateFormat.format(cal.getTime());
                resultBean.setTimeRun(dateFormat.format(cal.getTime()));
            }
            resultBeanList.add(resultBean);
        }
    } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-16T20:03:27.747

我认为您的问题是您正在重用您的结果bean。`ResultBean`您应该在上传方法中创建一个新实例，这应该可以解决问题。

# android - RelativeLayout 不显示左侧的项目

> ID：10180712
> 
> 赞同：0
> 
> 时间：2012-04-16T19:54:33.100
> 
> 标签：android, android-relativelayout

我有我认为的简单布局。这包含一个滚动视图，其中包含一个水平滚动视图，因此我可以双向滚动。我已经简化了这个例子，所以它只有一个包含一个TextView 和另一个RelativeLayout 的RelativeLayout。这是 XML：

```
 <HorizontalScrollView
        android:id="@+id/scrollView"
        android:layout_width="fill_parent"
        android:layout_height="wrap_content"
        android:fadeScrollbars="false"
        android:scrollbarAlwaysDrawHorizontalTrack="true" 
        android:fillViewport="true">
        <RelativeLayout
            android:id="@+id/mainLayout"
            android:layout_width="wrap_content"
            android:layout_height="fill_parent"                
            android:orientation="horizontal" >
            <TextView
                android:id="@+id/myText"
                android:layout_width="wrap_content"
                android:layout_height="wrap_content"                    
                android:text="TEXT LABEL" />
            <RelativeLayout
                android:id="@+id/relativeLayout"
                android:layout_width="wrap_content"
                android:layout_height="wrap_content"
                android:layout_below="@+id/myText">
                     <Button android:id="@+id/button2"
                        android:layout_width="wrap_content"
                        android:layout_height="wrap_content"
                        android:layout_toLeftOf="@+id/button1"
                        android:layout_above="@+id/button1"
                        android:text="2"/>
                    <Button android:id="@+id/button1"
                        android:layout_width="wrap_content"
                        android:layout_height="wrap_content"
                        android:text="1"/>
                     <Button android:id="@+id/button3"
                        android:layout_width="wrap_content"
                        android:layout_height="wrap_content"
                        android:layout_below="@+id/button1"
                        android:text="3"/>                       
           </RelativeLayout>
        </RelativeLayout>
    </HorizontalScrollView>
</ScrollView> 
```

我可以看到按钮 1 和 3，但我没有看到按钮 2。不幸的是，我需要这样做，因为页面是动态构建的（这个 xml 是我正在做的简化版本）而且我只知道我需要什么被留下。我让它在某个时候工作，但不得不重新安排一些其他代码并且它坏了。我错过了什么？

这是快照的链接：[快照](http://i.imgur.com/tmCeP.jpg)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-16T20:18:39.847

按钮 2 位于按钮 1 左上角的屏幕外。

我不确定您的预期结果是什么，但是您可以尝试将 button2 锚定到左上角（layout_alignParentTop、layout_alignParentLeft），然后根据您的需要在其右侧或下方显示 button1。

如果您只希望按钮 1 在按钮 2 的右侧，这是一个示例：

```
 <Button
                android:id="@+id/button2"
                android:layout_width="wrap_content"
                android:layout_height="wrap_content"
                android:text="2"
                android:layout_alignParentLeft="true" />

            <Button
                android:layout_toRightOf="@+id/button2"
                android:id="@+id/button1"
                android:layout_width="wrap_content"
                android:layout_height="wrap_content"
                android:text="1" />

            <Button
                android:id="@+id/button3"
                android:layout_width="wrap_content"
                android:layout_height="wrap_content"
                android:layout_below="@+id/button1"
                android:text="3" />
        </RelativeLayout> 
```

取决于您实际尝试做什么（我对 button2 中的 android:layout_above="@+id/button1" AND android:layout_toLeftOf="@+id/button1" 感到困惑）

# cocoa - 创建模型类

> ID：10180717
> 
> 赞同：0
> 
> 时间：2012-04-16T19:54:51.493
> 
> 标签：cocoa, model, instantiation

我已经查看了其他问题，但仍在苦苦挣扎，所以如果有人能花时间看看这个，将不胜感激:)。

我目前的应用程序运行良好，但我一直在阅读并认为它不符合 MVC 设计模式。我仍在学习很多有关设计的知识，并希望对其进行编辑以使其更合理。

我想我知道我的模型类应该包含什么，并且我认为它应该在应用程序委托中实例化。我的问题是：为什么在那个位置？惰性实例化是最好/正确的方法吗？最后，一旦启动，我是使用属性来访问类还是使用特殊方法？

抱歉超载；我也在努力提高我的声誉，以便对其他问题进行投票！:)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-18T01:02:13.467

像这样的一般性问题真的很难回答，因为有很多方法可以实现任何特定的项目。一般来说，我认为在您的应用程序委托中实例化模型类不一定是要走的路。由于控制器类在模型和视图之间进行调解，因此在控制器类中实例化您的模型通常会更好——例如，我有一个跟踪花园中植物的程序，而我的控制器类是NSArray 控制器。在控制器中创建新的植物对象然后将它们添加到它的排列对象中似乎是有意义的。我尝试尽可能少地在类之间建立联系（通过属性或 ivars），我的想法是每个类都应该尽可能地处理自己的业务。通常，你不

# css - 按钮状态通过单击持续存在？

> ID：10180721
> 
> 赞同：1
> 
> 时间：2012-04-16T19:55:08.707
> 
> 标签：css, mobile

我注意到在 Iphone 上我的按钮状态有点滑稽。

这是设置的内容：

```
<button class="button follow">follow</button>
<button class="button unfollow" style>unfollow</button> 
```

CSS：

```
.button {
  background: green;
}

.button:hover, .button:active {
  red;
} 
```

单击按钮时，它们会执行 ajax 功能并交替使用。IE 如果关注显示并且我单击关注，则进行 ajax 调用并且关注被隐藏并显示取消关注，反之亦然。

我的难题：

在移动设备中，当我单击按钮时，按钮会交换，但新按钮会呈现为活动状态（即背景为红色）。

关于如何确保按钮不会在其悬停/活动状态下呈现的任何想法？

# extjs4 - 编辑元素后在 ExtJs4 中丢失 keyNavigation

> ID：10180727
> 
> 赞同：0
> 
> 时间：2012-04-16T19:55:34.067
> 
> 标签：extjs4, treepanel

我想用键盘箭头导航实现交互式 TreePanel。在第一次单击任何项​​目后，它可以正常工作。我添加了键绑定<A>-add，<E>-edit，<D>-deleting。显示添加对话框后，用户输入新项目的名称并按 Ctrl-S 或按保存按钮。这是保存代码：

```
saveItem: function(wnd) {
    rec = wnd.getRecord();
    var store = this.getProductCategoryStore();

    if (wnd.parent) {
        parent = wnd.parent
        parent.data.leaf = false;
        parent.set('loaded', false);
    } else
        parent = this.getCategoryTree().getRootNode();

    if (rec.phantom)
        parent.appendChild( rec );
    store.sync();
    wnd.close();

    if (wnd.parent)
        parent.expand();

    this.getCategoryTree().focus();
    this.getCategoryTree().selectPath( rec.getPath() );
}, 
```

所以，最后两行是我试图专注于树，但它不起作用。< A >、< E >、< D > - 工作，但箭头不起作用。如果我手动单击树，它会再次起作用。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-17T12:41:37.097

解决了。使用 Ext.FocusManager 了解焦点在应用程序中是如何工作的很酷。在树中正确聚焦：

```
tree.getView().focus() 
```

# ios - 从自动续订切换到可续订订阅

> ID：10180728
> 
> 赞同：1
> 
> 时间：2012-04-16T19:55:35.357
> 
> 标签：ios, in-app-purchase, app-store-connect, auto-renewing

我的客户在 App Store 中有一个使用自动续订订阅类型的应用。在重新提交应用程序后，它被拒绝了，因为他们声称他们没有定期内容（即使他们有......但这个问题目前似乎无处不在）。我想知道处理非续订订阅的最佳方法是什么。具体处理的问题：

1.  丢失您的设备并恢复您的订阅
2.  恢复对多台设备的订阅（Apple 强制要求）
3.  防止用户滥用系统。

到目前为止，我想出的是以下内容：

当用户购买 1 个月的订阅时，此信息将存储在本地（例如在 NSUserDefaults 中）。此外，还会生成一个唯一 ID 并将其发送到我的客户端服务器。当订阅结束时，系统会询问用户是否希望被引导至购买屏幕。如果用户希望保存订阅以防他们需要恢复设备或丢失设备，他们可以选择将唯一标识符发送到他们的电子邮件地址（系统会提示他们输入，表明此信息将不得使用）。该应用程序有一个地方可以输入此 ID。它将从服务器检索订阅信息并再次将其存储在 NSUserDefaults 中。每次还原完成时，都会增加一个计数器。当它达到 5 时，用户无法再恢复。上述相同原理适用于在多个设备上共享订阅的情况。这似乎是一个合理的解决方案（Apple 会接受）？

谢谢你的时间！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-16T20:50:21.127

你为什么不想用苹果的`restoreCompletedTransactions`？它只是为您随时在任何设备上提供有关所有先前购买的信息。 [http://developer.apple.com/library/mac/#documentation/StoreKit/Reference/SKPaymentQueue_Class/Reference/Reference.html#//apple_ref/occ/instm/SKPaymentQueue/restoreCompletedTransactions](http://developer.apple.com/library/mac/#documentation/StoreKit/Reference/SKPaymentQueue_Class/Reference/Reference.html#//apple_ref/occ/instm/SKPaymentQueue/restoreCompletedTransactions)

# php - 拆分包含字母和数字的字符串，在 PHP 中不被任何特定分隔符分隔

> ID：10180730
> 
> 赞同：6
> 
> 时间：2012-04-16T19:55:40.373
> 
> 标签：php, regex, string, algorithm, nlp

目前我正在开发一个 Web 应用程序来获取 Twitter 流并尝试自己创建一个自然语言处理。

由于我的数据来自 Twitter（限制为 140 个字符），因此缩短了许多单词，或者在这种情况下，**省略了空格**。

例如：

```
"Hi, my name is Bob. I m 19yo and 170cm tall" 
```

应标记为：

```
- hi
- my
- name
- bob
- i
- 19
- yo
- 170
- cm
- tall 
```

请注意，`19`它们`yo`之间`19yo`没有**空格**。我主要用它来提取带有单位的数字。

简单地说，我需要的是一种方法，可以通过**没有**分隔符的数字或字母块来“分解”每个包含数字的标记。

`'123abc'`将会`['123', 'abc']`

`'abc123'`将会`['abc', '123']`

`'abc123xyz'`将会`['abc', '123', 'xyz']`

等等。

在 PHP 中实现它的最佳方法是什么？

* * *

我发现了一些接近它的东西，但它是 C# 并且特别适用于日/月拆分。[如何在 C# 中根据字母和数字拆分字符串](https://stackoverflow.com/q/2362153/670623)

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-04-16T19:59:58.373

您可以使用[preg_split](http://de3.php.net/preg-split)

```
$string = "Hi, my name is Bob. I m 19yo and 170cm tall";
$parts = preg_split("/(,?\s+)|((?<=[a-z])(?=\d))|((?<=\d)(?=[a-z]))/i", $string);
var_dump ($parts); 
```

匹配数字字母边界时，正则表达式匹配必须是零宽度。字符本身不得包含在匹配中。为此，[零宽度环视](http://www.regular-expressions.info/lookaround.html)很有用。

[http://codepad.org/i4Y6r6VS](http://codepad.org/i4Y6r6VS)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-16T20:08:50.360

这个怎么样：

您使用正则表达式从字符串中提取数字，将它们存储在数组中，用某种特殊字符替换字符串中的数字，这将“保持”它们的位置。在解析仅由您的特殊字符和普通字符创建的字符串后，您会将数组中的数字输入到他们的保留位置。

只是一个想法，但恕我直言可能对你有用。

编辑：尝试运行这个短代码，希望你能在输出中看到我的观点。（此代码在键盘上不起作用，不知道为什么）

```
<?php
$str = "Hi, my name is Bob. I m 19yo and 170cm tall";
preg_match_all("#\d+#", $str, $matches);
$str = preg_replace("!\d+!", "#SPEC#", $str);

print_r($matches[0]);
print $str; 
```

# c# - 如何将gridview控件var声明为对象

> ID：10180734
> 
> 赞同：0
> 
> 时间：2012-04-16T19:55:49.060
> 
> 标签：c#, asp.net, visual-studio, object, gridview

我对面向对象领域很陌生，我有点困惑如何声明一个 gridview 控件并将其设置为一个对象的实例。我遇到了空引用异常错误的问题，那是因为它没有被正确引用。

```
 protected void GridView1_RowUpdating(object sender, GridViewUpdateEventArgs e)
    {
       var MyLabel = (Label) GridView1.FindControl("lblTest");

       cmd.Parameters.Add("@X", SqlDbType.Char).Value = MyLabel.Text;
} 
```

lblTest 是gridview 中标签控件的名称。但我需要在全球范围内声明这一点，我不太确定如何。如果有人能指出我正确的方向并帮助我使用语法，将不胜感激！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-16T20:00:00.497

如果您在带有 lblTest 的 aspx 页面上有 gridview 控件，那么您需要在特定行上找到控件。在 GridView1_RowUpdating 做：

```
GridViewRow row = GridView1.Rows[e.RowIndex];
var MyLabel = row.FindControl("lblTest"); 
```

在这里你可以这样做：

```
Label MyLabel = row.FindControl("lblTest"); 
```

Var 用于隐式类型变量。你会发现这个链接对[var很有趣](http://msdn.microsoft.com/en-us/library/bb383973.aspx)

# c# - 为什么我的自定义控件的 Text 属性不会显示在“属性”窗口中？

> ID：10180736
> 
> 赞同：9
> 
> 时间：2012-04-16T19:55:55.193
> 
> 标签：c#, winforms, visual-studio-2010, properties, user-controls

我有一个继承自 UserControl 的用户控件。它是一个按钮，所以我试图让按钮中的文本，通过像真正的按钮一样使用 Text 属性来更改，而不是像 _Text 一样命名我自己的。我有以下代码，但它不起作用（即它没有出现在属性窗口中）。标签的名称是 ContentPresenter

```
public override string Text
{
    get
    {
        return ContentPresenter.Text;
    }
    set
    {
        ContentPresenter.Text = value;
    }
} 
```

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2012-04-16T20:14:07.537

UserControl 付出了巨大的努力来隐藏 Text 属性。从元数据：

```
 [Browsable(false)]
    [DesignerSerializationVisibility(DesignerSerializationVisibility.Hidden)]
    [EditorBrowsable(EditorBrowsableState.Never)]
    [Bindable(false)]
    public override string Text { get; set; } 
```

您可以通过覆盖代码中的这些属性来使其可见：

```
 [Browsable(true)]
    [DesignerSerializationVisibility(DesignerSerializationVisibility.Visible)]
    [EditorBrowsable(EditorBrowsableState.Always)]
    [Bindable(true)]
    public override string Text 
    { 
        get { return ContentPresenter.Text; } 
        set { ContentPresenter.Text = value; } 
    } 
```

我不保证这足以让它工作，但它可能是。

# javascript - 如果图像尚未完全加载，插入加载器图标的最佳方法是什么？

> ID：10180744
> 
> 赞同：1
> 
> 时间：2012-04-16T19:56:40.510
> 
> 标签：javascript, jquery

给定html结构：

```
<div class="image-container">
    <img id="firstslide" src="img/verybig.jpg">
</div> 
```

我想知道是否有一种简单易行的方法来检查

1.  如果当前正在加载图像并在 div 中插入一个加载图标和
2.  已完成加载并显示完全加载的图片

有什么提示吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-16T20:01:05.380

我会从 CSS 中做到这一点，将加载器动画图像设置为所选图像的背景：

CSS：

```
img.loader {
  background: url(loader.gif) 50% 50% no-repeat;
} 
```

HTML：

```
<div class="image-container">
  <img id="firstslide" class="loader" style="width: 100px; height: 100px;" src="img/verybig.jpg" alt=""/>
</div> 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-16T20:02:47.863

jsfiddle：http: [//jsfiddle.net/FjfvZ/60/](http://jsfiddle.net/FjfvZ/60/)

如果您使用 jQuery：

```
<div id="loading">Loading</div>
<img id="image" src="image.png" style="display:none"/>

<script>
    $('#image').load(function()
    {
        $('#loading').hide();
        $(this).show();
    });
</script> 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-16T19:59:03.537

我使用图像预加载器插件：

[http://www.farinspace.com/jquery-image-preload-plugin/](http://www.farinspace.com/jquery-image-preload-plugin/)

这将使您可以控制做任何您想做的事情。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-04-16T19:59:46.393

您可以使用一个小的加载图像作为背景图像，一旦加载，它就会被实际图像覆盖。

这是一个**[jsFiddle 示例](http://jsfiddle.net/j08691/2QtJw/)**。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-04-16T20:00:21.973

这提供了一个简单的很好的解决方案：

[http://www.appelsiini.net/projects/lazyload](http://www.appelsiini.net/projects/lazyload)

# .net - .Net WebBrowser 控件使用 IE10

> ID：10180747
> 
> 赞同：0
> 
> 时间：2012-04-16T19:56:54.790
> 
> 标签：.net, webbrowser-control, internet-explorer-10

有什么方法（目前）可以在 Internet Explorer 10 预览中使用 WebBrowser 控件吗？

在 Windows 7 上更可取，但对于初学者来说，Windows 8 会很棒。

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-10T06:19:43.597

最新的 IE10 预览版仅适用于 Windows 8，但据说发布版本也可以在 Windows 7 上运行。通过将以下行添加到 html 文件中，我能够在 IE 10 预览模式下使用 WebBrowser 控件。" meta http-equiv="X-UA-Compatible" 内容="IE=10" "

# git - 列出影响文件的合并提交

> ID：10180751
> 
> 赞同：26
> 
> 时间：2012-04-16T19:57:04.697
> 
> 标签：git, git-branch, git-merge, git-log

我想找到影响或涉及给定文件的所有合并提交。

作为背景，有人在合并时错误解决了冲突，并且几天没有被团队注意到。那时，已经提交了许多其他不相关的合并（我们中的一些人一直更喜欢不使用 rebase，否则事情会更简单）。我需要找到“坏”的合并提交，以便检查它以确定其他可能已恢复的内容（当然，识别和惩罚有罪的人）。

场景是这样的：

```
$ echo First > a.txt && git add a.txt && git commit -m 'First commit'
$ git branch branch1
$ echo "Second: main-branch" >> a.txt && git commit -a -m 'Commit on master'
$ git tag a1
$ echo "Third: main" >> a.txt && git commit -a -m 'Other commit on master'
$ git checkout branch1
$ echo "Second: on branch1" >> a.txt && git commit -a -m 'Commit on branch'
$ git tag b1 
```

...所以现在master和branch1中的a.txt发生了冲突的变化。

```
$ git checkout master
$ git merge branch1 
Auto-merging a.txt
CONFLICT (content): Merge conflict in a.txt
Automatic merge failed; fix conflicts and then commit the result.
$ cat a.txt 
First
<<<<<<< HEAD:a.txt
Second: main-branch
Third: main
=======
Second: on branch1
>>>>>>> branch1:a.txt
$ vi a.txt
# ...
$ cat a.txt 
First
Second: on branch1
$ git add a.txt
$ git commit -m 'Merge commit' 
```

...换句话说，决议是“拿他们的”。该图现在看起来像这样：

```
$ git log --graph --branches --format='%h %s %d' 
*   fefb623 Merge commit  (refs/heads/master)
|\  
| * 93e065e Commit on branch  (refs/tags/b1, refs/heads/branch1)
* | cf4d12b Other commit on master 
* | 6fade67 Commit on master  (refs/tags/a1)
|/  
* 07545ea First commit 
```

此时错误版本的 a.txt 在 master 上。a1 中的版本是我们想要的，但 b1 版本已提交。到目前为止，我已经尝试过：

```
$ git log --decorate --oneline a.txt
93e065e (refs/tags/b1, refs/heads/branch1) Commit on branch
07545ea First commit 
```

好的，所以 a1 和合并提交都没有出现。

```
$ git log --decorate --oneline --follow a.txt
... 
```

这向我展示了两个分支上的所有内容，但仍然省略了合并提交。

```
$ git log --oneline --graph --decorate a1..master
... 
```

这当然是“master not in a1 中的所有内容”，它在这个玩具示例中有效，但在我的真实案例中，为我提供了最近完成的所有合并（并且没有迹象表明哪一个接触了 a.txt）。

我可以合理化 a1 从文件历史记录中的消失，因为合并选择忽略该更改（至少在 git 关心的意义上，我认为）。但是如何找到影响 a.txt 的所有合并提交？如果不手动检查所有候选合并提交，这甚至可能吗？

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2012-04-16T21:02:51.070

你的问题是合并提交是空的，因为你只从一个分支中获取东西，所以 git 通过删除那些“空”提交来简化历史。

因此，为了让您的合并提交显示在日志中，您需要告诉 git 更改历史简化，方法是告诉`--simplify-merges`. 如果您想了解为什么必须使用它，请继续`git log`阅读手册页，但我已经不在了 :) 无论如何，在这种情况下，合并提交通过 a.txt 过滤正确显示，所以这就是您想要的。

最后，您想显示 diff 两次，每个父级，使用`-m`.

所以这给了

```
git log -U -m --simplify-merges --merges -- a.txt 
```

带输出

```
commit a7340d6e91deedff6f52c8ec8da932245f73e5f6 (from d577e6c4dcbff5485ded666c89f38
Merge: d577e6c fe3c4d2

    merge commit

diff --git a/a.txt b/a.txt
index 319137b..1aa6dc4 100644
--- a/a.txt
+++ b/a.txt
@@ -1,3 +1,2 @@
 First
-Second: main-branch
-Third: main
+Second: on branch1 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-16T20:08:31.670

您可以添加`--merges`到日志命令。这只会列出合并提交。此外，您可以指定`--first-parent`只关注分支历史，而不考虑合并到其中的分支的历史。

# mysql - 尝试在 XAMPP 上创建 mysql 表时出错

> ID：10180762
> 
> 赞同：0
> 
> 时间：2012-04-16T19:58:20.960
> 
> 标签：mysql, sql, xampp, create-table

当我尝试在数据库中的 phpmyadmin 中创建新表时遇到问题。代码是：

```
DROP TABLE IF EXISTS phpcrawler_links;
CREATE TABLE phpcrawler_links (
  id           int(11) NOT NULL auto_increment,
  site_id      int(11) NOT NULL default 0,
  depth        int(11) NOT NULL default 0,
  url          text NOT NULL,
  url_title    text,
  url_md5      varchar(255) NOT NULL,

  content      text NOT NULL,
  content_md5  varchar(255) NOT NULL,

  last_crawled datetime,
  crawl_now    int(11) NOT NULL default 1,

  PRIMARY KEY (id),
  KEY idx_site_id(site_id),
  KEY idx_url (url(255)),
  KEY idx_content_md5(content_md5),
  FULLTEXT ft_content(content),
  KEY idx_last_crawled(last_crawled)
);

DROP TABLE IF EXISTS words;
CREATE TABLE words (
  id     int(11) NOT NULL,
  word   varchar(255) NOT NULL
); 
```

问题似乎出在这一行：

```
last_crawled datetime, 
```

我得到的错误是：

> #1214 - 使用的表类型不支持 FULLTEXT 索引

如果有人可以帮助我解决这个问题，我会很高兴的！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-16T20:00:22.697

谷歌规则！只有 MyISAM 表支持全文索引。 [http://forums.mysql.com/read.php?107,194405,194677](http://forums.mysql.com/read.php?107,194405,194677)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-16T20:20:45.137

如果表是 Innodb，则无法向该数据库添加索引，必须将引擎更改为 MyISAM 或将数据类型更改为 int

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-12-12T10:27:46.930

似乎您使用的是旧版本的 MySQL，从 MySQL 5.6 开始，InnoDB 已经支持全文索引。

# python - Django 身份验证/登录问题

> ID：10180764
> 
> 赞同：1
> 
> 时间：2012-04-16T19:58:30.497
> 
> 标签：python, django, login, authentication

我是 Django 新手，正在尝试使用`django.contrib.auth.views.login`Django 1.4 为我的网页构建一个简单的登录系统。我有一个包含以下登录表单的基本模板，然后由我网站上的其他模板页面扩展：

```
<form method="post" action="/accounts/login/">
{% csrf_token %}
<p><label for="id_username">Username:</label> <input id="id_username" type="text" name="username" maxlength="30" /></p>
<p><label for="id_password">Password:</label> <input type="password" name="password" id="id_password" /></p>
<input type="submit" value="Log in" />
<input type="hidden" name="next" value="{{ request.get_full_path }}" />
</form> 
```

但是，当我尝试登录时，我收到以下消息：

> “禁止 (403) CSRF 验证失败。请求中止。失败原因：CSRF 令牌丢失或不正确。”

来自 urls.py 的相关片段：

```
url(r'^accounts/login/$', 'django.contrib.auth.views.login') 
```

和settings.py：

```
TEMPLATE_CONTEXT_PROCESSORS = (
'django.core.context_processors.request',
)

.....

INSTALLED_APPS = (
'django.contrib.auth',
'django.contrib.contenttypes',
'django.contrib.sessions',
'django.contrib.sites',
'django.contrib.messages',
'django.contrib.staticfiles',
)
.....
MIDDLEWARE_CLASSES = (
'django.middleware.common.CommonMiddleware',
'django.contrib.sessions.middleware.SessionMiddleware',
'django.middleware.csrf.CsrfViewMiddleware',
'django.contrib.auth.middleware.AuthenticationMiddleware',
'django.contrib.messages.middleware.MessageMiddleware',
) 
```

有什么建议么？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-01-17T17:16:50.213

## 可以在[这里找到简单的登录/注销系统](https://github.com/michaelarshinov/django_simple_backend_user_model)

让我简单解释一下如何通过Django中的**用户模型使用****标准身份验证：**

 *****应用程序名/views.py：***

```
from django.http import HttpResponse
from django.contrib.auth import authenticate, login
from django.contrib.auth.decorators import login_required
from django.template import Context, loader, RequestContext
from django.shortcuts import render_to_response
from django.template import 

@login_required
def stat_info(request):
return render_to_response('stat_info.html',
  {'is_auth':request.user.is_authenticated()},
  context_instance=RequestContext(request))

@login_required
def mainmenu(request):
return render_to_response('mainmenu.html',{},
  context_instance=RequestContext(request)) 
```

***网址.py：***

```
from django.conf.urls import patterns, include, url
from django.contrib import admin
admin.autodiscover()

urlpatterns = patterns('',
    url(r'^admin/', include(admin.site.urls)),
    (r'^statinfo/$', 'appname.views.stat_info'),
    (r'^accounts/login/$', 'django.contrib.auth.views.login'),
    (r'^accounts/logout/$', 'django.contrib.auth.views.logout', {'next_page' : '/accounts/login'}),
    (r'^mainmenu/$', 'appname.views.mainmenu')
) 
```

***设置.py：***

```
...        
LOGIN_REDIRECT_URL='/mainmenu/'
... 
```

***模板/注册/login.html：***

```
{% extends "base.html" %}
{% block content %}
    {% if form.errors %}
    <p>Your username and password didn't match. Please try again.</p>
    {% endif %}
    <form method="post" action="{% url django.contrib.auth.views.login %}">
    {% csrf_token %}
    <table>
        <tr>
            <td>{{ form.username.label_tag }}</td>
            <td>{{ form.username }}</td>
        </tr>
        <tr>
            <td>{{ form.password.label_tag }}</td>
            <td>{{ form.password }}</td>
        </tr>
    </table>
    <input type="submit" value="login" />
    <input type="hidden" name="next" value="{{ next }}" />
    </form>
{% endblock %} 
```

***模板/base.html：***

```
<!DOCTYPE html>
<html lang="en">
<head>
    <link rel="stylesheet" href="style.css" />
    <title>{% block title %}templates/base.html{% endblock %}</title>
</head>
<body>
<div id="sidebar">
    {% block sidebar %}
    <ul>
        <li><a href="/">Home</a></li>

        {% if user.is_authenticated %}
            <li><a href="/accounts/logout">Logout</a></li>
        {% else %}
            <li><a href="/accounts/login">Login</a></li>
        {% endif %}
    </ul>
    {% endblock %}
</div>
<div id="content">
    {% block content %}{% endblock %}
</div>
</body>
</html> 
```

***模板/mainmenu.html：***

```
<!DOCTYPE html>
{% extends "base.html" %}
<html>
<head>
    <title>{% block title %}templates/mainmenu.html{% endblock %}</title>
</head>
<body>

<div id="content">
    {% block content %}
    Mainmenu
    <a href="/statinfo/">stat info</a>
    {% endblock %}

</div>

</body>
</html> 
```

**模板/stat_info.html：**

```
<!DOCTYPE html>
{% extends "base.html" %}
<html>
<head>
    <title>{% block title %}templates/mainmenu.html{% endblock %}</title>
</head>
<body>

<div id="content">
    {% block content %}
    Mainmenu
    <a href="/statinfo/">stat info</a>
    {% endblock %}

</div>

</body>
</html> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-30T15:11:11.093

楷模：

类 UserProf(models.Model):

```
"""
Create  ``RegistrationProfile for User``
"""
user = models.OneToOneField(User)

""" Other fields here """
address1 = models.CharField(max_length=100,blank=True)
address2 = models.CharField(max_length=100,blank=True)
city = models.CharField(max_length=40,blank=True)
country = models.CharField(max_length=40,blank=True)
age = models.IntegerField(blank=True) 
```

意见：

从 django.contrib.auth 导入身份验证，登录

def user_authenticate（请求）：

```
"""
    check username and password and displays its appr. user_profile page
"""

username = password = ''
if request.POST:
    username = request.POST.get('username')
    password = request.POST.get('Password')

    user = authenticate(username=username, password=password)
    if user is not None:
        if user.is_active:
            login(request,user)
            return HttpResponseRedirect('/profile/')

    else:
        return HttpResponseRedirect('/qioness/connect/')
else:
    return HttpResponseRedirect('/qioness/connect/') 
```

网址：

url(r'^profile/$',show_detail),

模板：

```
 <form action="/qioness/" method="post">
                       <label>

                        <strong class="email-label">Username</strong>

                        <input type="text"  id="Email" name="username">

                        <span class="login_error"></span>

                      </label>

                      <label>
                          <strong class="passwd-label">Password</strong>
                          <input type="password" id="Passwd" name="Password">

                          <span class="login_error">  </span>
                      </label>

                   <input name="Add" type="submit" value="Log" class="Submit_btn" />

                          <label class="remember">
                              <input type="checkbox" value="yes" id="PersistentCookie" name="PersistentCookie">
                              <strong class="remember-label">
                                   Remember Me
                              </strong>
                          </label>
         </form>

       </div> 
```

为我工作了 4 个 :)**

# python - 使用 unicode 文件名打开文件？

> ID：10180765
> 
> 赞同：12
> 
> 时间：2012-04-16T19:58:35.033
> 
> 标签：python, file, unicode

我似乎无法打开具有 unicode 文件名的文件。假设我这样做：

```
for i in os.listdir():
    open(i, 'r') 
```

当我尝试寻找一些解决方案时，我总是得到关于如何读取和写入文件的 unicode 字符串的页面，而不是如何打开具有 unicode 名称`file()`或`open()`具有 unicode 名称的文件。

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2012-04-16T20:00:57.220

只需为文件名传递`open()`一个 unicode 字符串：

在 Python 2.x 中：

```
>>> open(u'someUnicodeFilenameλ')
<open file u'someUnicodeFilename\u03bb', mode 'r' at 0x7f1b97e70780> 
```

在 Python 3.x 中，所有字符串都是 Unicode，所以它实际上没有任何意义。

与往常一样，请注意，打开文件的最佳方式始终是将[`with`语句](http://docs.python.org/reference/compound_stmts.html#the-with-statement)与`open()`.

编辑：关于`os.listdir()`建议再次变化，在 Python 2.x 下，你必须小心：

> 返回文件名的 os.listdir() 引发了一个问题：它应该返回文件名的 Unicode 版本，还是应该返回包含编码版本的 8 位字符串？os.listdir() 将同时执行这两种操作，具体取决于您将目录路径提供为 8 位字符串还是 Unicode 字符串。如果您将 Unicode 字符串作为路径传递，文件名将使用文件系统的编码进行解码并返回 Unicode 字符串列表，而传递 8 位路径将返回 8 位版本的文件名。

[资源](http://docs.python.org/howto/unicode.html#unicode-filenames)

所以简而言之，如果你想要 Unicode，请将 Unicode 放入：

```
>>> os.listdir(".")
['someUnicodeFilename\xce\xbb', 'old', 'Dropbox', 'gdrb']
>>> os.listdir(u".")
[u'someUnicodeFilename\u03bb', u'old', u'Dropbox', u'gdrb'] 
```

请注意，该文件仍会以任何一种方式打开 - 它不会在 Python 中很好地表示，因为它将是一个 8 位字符串，但它仍然可以工作。

```
open('someUnicodeFilename\xce\xbb')
<open file 'someUnicodeFilenameλ', mode 'r' at 0x7f1b97e70660> 
```

在 3.x 下，一如既往，它始终是 Unicode。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2012-04-16T20:10:32.303

你可以试试这个：

```
import os
import sys

for filename in os.listdir(u"/your-direcory-path/"):
  open(filename.encode(sys.getfilesystemencoding()), "r") 
```

# sql - 使用 EF Code First 4.3 针对普通 sql db 编写代码然后切换到 azure 有多容易？

> ID：10180767
> 
> 赞同：0
> 
> 时间：2012-04-16T19:58:43.357
> 
> 标签：sql, azure-sql-database

Sql 数据库的实现与 Azure SQL 数据库有区别吗？如果我现在使用 Sql 编写我的应用程序，我可以稍后将其扩展吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-18T04:28:05.183

I would say yes. SQL Azure is running on top of SQL 2012 and contains most of the functionality. I have not used EF 4.3 but with NHibernate I have a large application that can run pretty painlessly on SQL Azure or a local SQL Server.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-17T09:10:37.743

通常，SQL Azure 实现了 SQL Server 功能的一个子集。SQL Azure 自动为我们管理服务器。本培训课程将为您提供有关如何从 SQL Server 迁移到 SQL Azure 的更多详细信息：http: [//msdn.microsoft.com/en-us/WAZPlatformTrainingCourse_MigratingDatabasestoSQLAzure](http://msdn.microsoft.com/en-us/WAZPlatformTrainingCourse_MigratingDatabasestoSQLAzure)。请检查它，看看它是否有帮助。

此致，

明旭。

# sql - Ruby on Rails：基本的参数化查询和 URL 形成

> ID：10180769
> 
> 赞同：1
> 
> 时间：2012-04-16T19:58:51.900
> 
> 标签：sql, ruby-on-rails, json, url-routing, parameterized-query

我正在尝试学习如何查询 Rails 数据库并将结果作为 JSON 返回。在我的示例中，我想使用参数城市和州查询数据。

到目前为止，在我的控制器中，我已经完成了以下操作。

```
 def state
    @bathrooms = Bathroom.where("state = ?" ,params[:state])
    respond_to do |format|
      format.json  { render :json => @bathrooms }
      format.js   { render :nothing => true } 

    end
  end 
```

这也是我的路由条目。

```
 match '/bathrooms/state/:state',
              :controller => "bathrooms",
              :action => "state" 
```

我可以使用以下 URL 调用此资源：

```
http://localhost:3000/bathrooms/state/CA.json 
```

这一切都很好，但我不知道如何通过多个参数进行查询。在控制器中添加 AND 子句似乎很容易。

但是....我不知道该怎么做

a.) 正确编写路由条目？b.) 如果我在浏览器中测试 URL 会是什么样子？

我试图了解 rake 路线，但我一定遗漏了一些东西。

有人可以提供一个基本示例来说明该操作应该是什么样子吗？路由条目应该是什么样的，访问资源的 URL 是什么样的？

同样，如果用 SQL 编写，这就是我想要返回的内容。

```
SELECT * from bathrooms WHERE city='Chicago' AND state = 'IL' 
```

任何帮助表示赞赏。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-16T20:38:41.867

您不必通过路由传递*所有内容*`GET`- URL 也支持参数 - 这些是您通常在 URL 中的问号后看到的参数。`GET`您可以在不更改路线的情况下添加这些参数： `http://localhost:3000/bathrooms/state/IL.json?city=Chicago`. 然后您可以通过 访问`city`参数`params[:city]`。但在你的情况下，我认为使用 . 会更好`http://localhost:3000/bathrooms/index.json?state=IL&city=Chicago`。您还需要将路由更改为

```
match '/bathrooms/index',
    :controller=>:bathrooms,
    :action=>:index 
```

并将代码放在`index`. `BathroomsController`您访问参数相同 - 但概念不同 - 您无需输入州并按城市查找浴室，您只需按州和城市查找浴室。

无论如何，您不想手动编写 URL - 您想要一个 Rails 助手或 HTML 表单生成它：

```
link_to "bathroom in Chicago, IL",:controller=>:bathrooms,:action=>:index,:state=>'IL',:city=>'Chicago' 
```

如果要使用表单（让用户选择自己的州和城市），则需要将其方法设置为`GET`：

```
form_tag {:controller=>:bathrooms,:action=>:index},:method=>:get do 
```

并将`state`和`city`作为字段。

还值得注意的是，虽然您可以使用 SQL`AND`执行多个字段的搜索，但您也可以链接`where`方法：`Bathroom.where(:state=>params[:state]).where(:city=>params[:city])`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-16T20:34:42.457

您可以在查询字符串中放置任意参数。

例如：

[http://localhost:3000/bathrooms/state/CA.json?city=Chicago](http://localhost:3000/bathrooms/state/CA.json?city=Chicago)

您的查询如下所示：

```
@bathrooms = Bathroom.where("state = ? and city= ?" ,params[:state], params[:city]) 
```

# c - 将文本读入 C。得到一个错误的 exec 错误

> ID：10180771
> 
> 赞同：0
> 
> 时间：2012-04-16T19:58:57.347
> 
> 标签：c

想学C。想读一个文本文件的第一行，我的代码是：

```
#include <stdio.h>
int main()
{

    FILE *in = fopen("test.txt", "rt");
    // read the first line from the file
    char buffer[100];
    fgets(buffer, 20, in);
    printf("first line of \"test.txt\": %s\n", buffer);
    fclose(in);
    return 0;
} 
```

我在 xCode 中这样做。我收到一个非常糟糕的访问错误。test.txt 肯定存在。它有一行写着“这是一个文本文件”

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-16T20:11:21.637

打电话后试试这个`fopen()`：

```
if(in == NULL){
    printf("Can't read teste.txt because: %s.\n", strerror(errno));
    return 1;
 } 
```

并添加标题：

```
#include <errno.h>
#include <string.h> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-16T20:01:23.647

您不检查是否`FILE`为NULL。由于多种原因，它可能无法打开。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-16T20:02:52.333

代码看起来不错，所以我的猜测是程序没有在与文件相同的工作目录中运行。尝试将文件放入，例如，`/tmp/test.txt`并在`fopen`.

# iphone - iOS - 在 iPad 上测试时出现白屏

> ID：10180772
> 
> 赞同：0
> 
> 时间：2012-04-16T19:58:57.237
> 
> 标签：iphone, ios, ipad, ios-simulator

我正在构建一个 iPhone 应用程序，当我在模拟器中测试它时它运行良好。我没有用于测试的 iPhone，但我的应用程序被配置为仅 iPhone，所以我试图在 iPad 上运行它。当我在 iPad 模拟器或 iPad 本身中运行它时，我得到的只是一个空白屏幕，知道会发生什么吗？

我的应用程序曾经是通用应用程序，但我将其切换到 iPhone 只是为了在 iPad 上进行测试，因为我没有 iPhone 可以测试。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-16T20:06:12.323

检查您的构建设置。

`Targeted Device Family`将“ ”从“ ”更改`iPhone/iPad`为“ `iPhone`”，您将在 iPad 上的小型 iPhone“模拟器”中看到它。

检查我的截图：

![在此处输入图像描述](../Images/b6ffe95753f014c31ce73248bc6cfb41.png)

# php - 检测字符串是否在PHP中的多维数组中

> ID：10180775
> 
> 赞同：1
> 
> 时间：2012-04-16T19:59:09.817
> 
> 标签：php, arrays

我有一个看起来像这样的数组：

```
Array
(
[0] => Array
(
    [Product] =>  Amazing Widget
    [Value] => 200
)

[1] => Array
(
    [Product] => Super Amazing Widget
    [Value] => 400
)

[2] => Array
(
    [Product] =>  Promising Widget 
    [Value] => 300
)

[3] => Array
(
    [Product] => Superb Widget
    [Value] => 400
)
) 
```

我相信这是一个嵌套的多维数组。

无论如何，我正在尝试检测数组中是否已经存在产品名称。这就是我想要做的

```
if('Super Amazing Widget' is in the array) {
    echo 'In the Array';
} 
```

我试过这个：

```
if(in_array('Super Amazing Widget', $array)){
    echo 'In The Array';
} 
```

但它不起作用，我不知道为什么。

编辑：

这里的一些函数效果很好：[in_array() 和多维数组](https://stackoverflow.com/questions/4128323/in-array-and-multidimensional-array)

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-16T20:00:57.157

[`in_array`](http://codepad.viper-7.com/XovZwg)不会进行递归搜索，即在子数组中搜索。您需要遍历您的数组并手动检查您的值。

```
$found = false;
foreach($arr as $item) {
    if ($item['Product'] == 'Super Amazing Widget') {
        $found = true;
        break;
    }
}
if ($found)
    echo 'found!'; //do something 
```

**[活生生的例子](http://codepad.viper-7.com/XovZwg)**

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-16T20:04:02.617

```
foreach ($array as $item) {
    if ($item["Product"] == "Super Amazing Widget") {
        echo "in the array";
        break;
    }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-16T21:04:26.773

使用类似于先前答案的 array_filter，但使用较新的匿名函数而不是较旧的 create_function()：

```
if(array_filter(
    $array, 
    function($val) { return $val['Product'] === 'Super Amazing Widget'; }
    )) {
    echo 'In the array' . PHP_EOL;
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-16T20:12:22.543

这是不使用循环：

```
$filt = array_filter($array, create_function('$val',
                                'return $val["Product"] === "Super Amazing Widget";'));
if (!empty($filt)) {
    echo "In The Array\n";
} 
```

# php - Left Join 在 CMD Prompt 中工作，而不是 PHP

> ID：10180778
> 
> 赞同：1
> 
> 时间：2012-04-16T19:59:18.903
> 
> 标签：php, mysql, left-join

我有一个 LEFT JOIN SELECT 语句，如下所示：

```
SELECT submissions.subid, submissions.title, submissions.date, files.file
FROM submissions
LEFT JOIN files ON submissions.subid=files.subid
WHERE uid='1'
ORDER BY subid DESC; 
```

当从 MySQL 命令提示符运行时，此查询完全返回我想要的结果，但是当尝试使用以下代码在 PHP 中显示结果时，它什么也不返回：

```
$subResult=mysql_query($querySub, $connection);

while($sub = mysql_fetch_assoc($subResult)){

    $subs[] = $sub;

}

foreach($subs as $k => $v) {

    foreach($v as $key => $val) {

    echo $k." ".$v."<br />";

    }

} 
```

有谁知道为什么这会在命令行中返回一个完美的结果，而不是在 php 中？我知道这不是我的数据库连接，因为它适用于同一代码页上的其他任务。我应该提到其中一个返回的字段包含存储在 BLOB 中的二进制数据。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-16T20:09:30.780

你有两个循环 - 内部的一个是：

`foreach($v as $key => $val) {`

您没有使用 $key 或 $value - 如果删除该循环会发生什么？

# printing - 在 RuggedJet 打印机上打印条形码

> ID：10180779
> 
> 赞同：0
> 
> 时间：2012-04-16T19:59:21.710
> 
> 标签：printing, windows-mobile, barcode

我需要通过 Window Mobile 设备在 Brother RuggedJet 打印机上打印条形码。兄弟提供的SDK没有办法做到这一点。

然而，大多数打印机都有一个本机模式，您可以将它们放入其中，然后发送转义序列来执行诸如打印条形码之类的操作。我已经用其他打印机做到了这一点。

有人知道 Brother RuggedJet 的本地打印机语言吗？如果是这样，打印 Code 123 条码的转义码是什么。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-17T13:35:14.507

您应该联系 Brother 的客户支持，看看他们是否可以让您联系处理其产品的 SDK 或技术文档的部门。

我为我们的条形码使用 Code 128，为了让它们打印出来，我使用 OnPaint 事件使用 e.Graphics 进行写入。如果您可以使用 Code 128，我可以在这里发布其中的一些代码，但其中大部分是我从其他人那里找到的，老实说，我从来没有花时间去了解它在做什么。

# python - Python/ElementTree：解析内联元素与周围文本有关吗？

> ID：10180781
> 
> 赞同：4
> 
> 时间：2012-04-16T19:59:28.627
> 
> 标签：python, text, elementtree

我需要解析一些包含*内联*元素的 XML。例如，XML 看起来像这样：

`<section> Fubar, I'm so fubar, fubar and even more <fref bar="baz">fubare</fref>. And yet more fubar. </section>`

如果我现在迭代这个结构，`for elem in list(parent): ...`我只能访问 fref。如果我现在处理 fref，周围的文本当然会丢失，因为文本不是真正的元素。

有人知道正确解决此问题的方法吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-16T20:27:28.923

下面展示了如何使用`lxml`.

```
>>> from lxml.etree import fromstring
>>> tree = fromstring('''<section> Fubar, I'm so fubar, fubar and even more <fref bar="baz">fubare</fref>. And yet more fubar. </section>''')
>>> elem = tree.xpath('/section/fref')[0]
>>> elem.text
'fubare'
>>> elem.tail
'. And yet more fubar. '
>>> elem.getparent().text
" Fubar, I'm so fubar, fubar and even more " 
```

从`lxml.etree` [教程](http://lxml.de/tutorial.html#elements-contain-text)：

> 如果您只想读取文本，即没有任何中间标签，您必须以正确的顺序递归连接所有文本和尾部属性。再次， tostring() 函数来救援，这次使用 method 关键字：

```
>>> from lxml.etree import tostring
>>> tostring(html, method="text")
" Fubar, I'm so fubar, fubar and even more fubare. And yet more fubar. " 
```

还有一种 XPath 方法可以做到这一点，它在链接页面中进行了描述。

# javascript - jQuery resize() 使用浏览器最大化按钮

> ID：10180782
> 
> 赞同：16
> 
> 时间：2012-04-16T19:59:42.227
> 
> 标签：javascript, jquery

这是我在调整窗口大小时触发的代码：

```
$(window).resize(function()
{   
    setDisplayBoardSize();
}); 
```

当我调整窗口大小并正常运行我的功能时触发正常，正如预期的那样。

如果我点击最大化按钮虽然它不能正常工作。

这是 setDisplayBoardSize() 函数：

```
function setDisplayBoardSize()
{
    var width = $(".display_container").width();

    for (i=min_columns; i<=max_columns; i++)
    {
        if ((width > (i*(item_width + gap))) && (width < ((i+1) * (item_width + gap))) )
        {
            $("#display_board").css("width",(i*(item_width + gap))+ "px");
        }
    }
} 
```

我认为问题在于，当单击浏览器最大化按钮时，它会触发读取在调整大小*之前*获取 .display_container 宽度的函数，然后将窗口调整为最大值，这意味着我的 display_board 大小不正确。

如果我是对的，如何在窗口调整到最大值*后获得 .display_container 元素的大小？*

应该注意我已经在 Chrome 和 Firefox 中测试过了

谢谢

* * *

## 回答 #1

> 赞同：36
> 
> 时间：2015-04-22T21:41:32.423

这对我也有影响，但我不知道为什么，直到我读了你的帖子。好像你是对的，在我按下最大化之前函数被触发，所以为了解决这个问题，我使用了一点延迟。

```
$(window).resize(function()
{   
setTimeout(function() {
    setDisplayBoardSize();
}, 100);
});
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2013-06-12T18:04:41.677

我在响应式站点上遇到了类似的问题，除了图像幻灯片之外，每个资产都会适当地调整大小和移动。这仅发生在 IE 中，并且仅发生在您从平板电脑断点处开始，然后单击最大化按钮并进入桌面断点时。

最终解决问题的是使用 Paul Irish 提供的这个方便的代码来限制调整大小触发器：

```
(function($,sr){

  // debouncing function from John Hann
  // http://unscriptable.com/index.php/2009/03/20/debouncing-javascript-methods/
  var debounce = function (func, threshold, execAsap) {
      var timeout;

      return function debounced () {
          var obj = this, args = arguments;
          function delayed () {
              if (!execAsap)
                  func.apply(obj, args);
              timeout = null;
          };

          if (timeout)
              clearTimeout(timeout);
          else if (execAsap)
              func.apply(obj, args);

          timeout = setTimeout(delayed, threshold || 100);
      };
  }
  // smartresize 
  jQuery.fn[sr] = function(fn){  return fn ? this.bind('resize', debounce(fn)) : this.trigger(sr); };

})(jQuery,'smartresize');

// usage:
$(window).smartresize(function(){
  // code that takes it easy...
}); 
```

您可以在此处查看他的完整帖子（从 2009 年开始）：http: [//www.paulirish.com/2009/throttled-smartresize-jquery-event-handler/](http://www.paulirish.com/2009/throttled-smartresize-jquery-event-handler/)

希望对那里的人有所帮助。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-04-16T20:05:43.437

***编辑建议的修复：***

这是[工作的 jsFiddle](http://jsfiddle.net/DotNetScott/DfKym/) ，这里是[只有结果的演示](http://jsfiddle.net/DotNetScott/DfKym/embedded/result)。

如您所见，我完全重构了您原来的 jQuery 代码。我从 Global 中删除了所有内容并删除了这些功能。 [`.resize()`](http://api.jquery.com/resize)已经需要一个函数，所以我只是在该函数中执行所有操作，然后立即调用[`.resize()`](http://api.jquery.com/resize)以在初始页面加载时调用它。

我做的另一个改变是向后增加你的 for 循环，从你允许的最宽的宽度尺寸开始 (5)，一直到你允许的最小的宽度尺寸 (2)。

此外，在您的 for 循环中，我创建了`j`变量`k`，以便更容易阅读这些条件。

主要变化是 if 语句。如果我们正在进行 max_column 迭代并且容器的宽度较宽`k`，我们希望将板的宽度设置为`k`并跳出 for 循环，否则我们评估您拥有的原始 if 语句，否则如果我们正在进行 min_column 迭代并且容器的宽度小于`j`，我们要将板的宽度设置为`j`。

我在 Chrome 中对此进行了测试，效果很好。我希望这可以帮助你。

```
$(document).ready(function()
{    
    $(window).resize(function() 
    {
        var item_width = 200, 
            item_height = 300, 
            gap = 20,
            min_columns = 2, 
            max_columns = 5,
            min_width = min_columns * (item_width + gap), 
            max_width = max_columns * (item_width + gap),
            container_width = $(".display_container").width(),
            $display_board = $("#display_board"),
            $display_board_ol_li = $display_board.find("ol > li");

        //console.log("container width: " + container_width);

        for (var i = max_columns; i >= min_columns; i--)
        {
            var j = i * (item_width + gap),
                k = (i+1) * (item_width + gap);

            //console.log("j: " + j);
            //console.log("k: " + k);
            //console.log("display_board width (before): " + $display_board.css("width"));

            if (i === max_columns && container_width > k) 
            {
                $display_board.css("width", max_width + "px");
                //console.log("display_board width (after): " + $display_board.css("width"));
                break;                
            } 
            else if (container_width > j && container_width < k)
            {
                $display_board.css("width", j + "px");
                //console.log("display_board width (after): " + $display_board.css("width"));
                break;
            }
            else if (i === min_columns && container_width < j) 
            {
                $display_board.css("width", min_width + "px");
                //console.log("display_board width (after): " + $display_board.css("width"));
            }
        }

        $display_board_ol_li.css({

            "width" : item_width + "px",
            "height": item_height + "px",
            "margin": gap/2 + "px"

        });

    }).resize();

});​ 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2014-10-29T06:13:30.153

```
var window_width_check_big = false, // flag true if window bigger than my_width
window_width_check_small = false,   // flag true if window smaller than my_width
my_width = 1221; // Change to your width

function get_window_size() {
    if(window.innerWidth > my_width) {
        window_width_check_big = true;
    }
    if(window.innerWidth < my_width) {
        window_width_check_small = true;
    }   
}

get_window_size();

$(window).resize(function() {

    if(window.innerWidth > my_width) {
        window_width_check_big = true;
    }
    if(window.innerWidth < my_width) {
        window_width_check_small = true;
    }
    if( window_width_check_small && window_width_check_big ) {
        window_width_check_big = false;
        window_width_check_small = false;
        get_window_size();
        // Start function that you need
    }
}); 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-04-16T20:15:50.890

一些浏览器如 ie 和 opera 触发这个事件有一些限制，这个插件可以解决这个问题：

[http://benalman.com/projects/jquery-resize-plugin/](http://benalman.com/projects/jquery-resize-plugin/)

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2017-10-03T05:48:18.267

以下代码在 Chrome 和 IE11 中都适用于我：（javascript 和 jQuery）。

```
function setWindowResizeEndEvent() {

    $(window).on('resize', setTimerForResizeEnd);
}

var mResizeTimer;
function setTimerForResizeEnd() {
    clearTimeout(mResizeTimer);
    mResizeTimer = setTimeout(onResizeEnd, 100);
}

function onResizeEnd() {
    $(window).off('resize', setTimerForResizeEnd);
    $(window).resize();

    setWindowResizeEndEvent();
} 
```

说明：我正在触发原生 window.resize 事件，在调整大小结束后。这在最大化窗口结束后重新触发调整大小事件。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2017-10-03T05:35:05.303

以下代码在 Chrome 和 IE11 中都适用于我：（javascript 和 jQuery）。

```
var mResizeTimer;
function setWindowResizeEndEvent() {

    $(window).on('resize', setTimerForResizeEnd);
}

function setTimerForResizeEnd() {
    clearTimeout(mResizeTimer);
    mResizeTimer = setTimeout(onResizeEnd, 100);
}

function onResizeEnd() {
    $(window).off('resize', setTimerForResizeEnd);
    $(window).resize();

    setWindowResizeEndEvent();
} 
```

说明：我正在触发原生 window.resize 事件，在调整大小结束后。这在最大化窗口结束后重新触发调整大小事件。

# uitableview - 设置标识符时的表视图单元格错误

> ID：10180790
> 
> 赞同：1
> 
> 时间：2012-04-16T20:00:01.990
> 
> 标签：uitableview, xcode4.2, storyboard, identifier

在 xCode 4.2 中，当我将`identifier`属性设置为情节提要中的原型单元格时，`Uncategorized - Compilation Failed`在尝试构建项目时出现错误。

我不确定你需要什么所有信息，所以我会提出我认为相关的信息......

首先，我有一个视图控制器，我在 Storyboard 中设置了一个表格视图。在表格视图中，我放置了一个原型单元格。在原型单元格中，我放置了一个 UIImageView 和 3 个标签。

我有一个名为`DOR_SearchCustomCell`.h 和 .m 文件的自定义单元类。这是.h文件：

```
@interface DOR_SearchCustomCell : UITableViewCell {

    __weak IBOutlet UIImageView *cellImage;
    __weak IBOutlet UILabel *cellTitle;
    __weak IBOutlet UILabel *cellText;
    __weak IBOutlet UILabel *cellDistance;
}

@property (weak, nonatomic) IBOutlet UIImageView *cellImage;
@property (weak, nonatomic) IBOutlet UILabel *cellTitle;
@property (weak, nonatomic) IBOutlet UILabel *cellText;
@property (weak, nonatomic) IBOutlet UILabel *cellDistance;

@end 
```

和 .m 文件：

```
#import "DOR_SearchCustomCell.h"

@implementation DOR_SearchCustomCell

@synthesize cellImage;
@synthesize cellTitle;
@synthesize cellText;
@synthesize cellDistance;

- (id)initWithStyle:(UITableViewCellStyle)style reuseIdentifier:(NSString *)reuseIdentifier
{
    self = [super initWithStyle:style reuseIdentifier:reuseIdentifier];
    if (self) {
        // Initialization code
    }
    return self;
}

- (void)setSelected:(BOOL)selected animated:(BOOL)animated
{
    [super setSelected:selected animated:animated];

    // Configure the view for the selected state
}

@end 
```

我的原型单元将此类设置为自定义类，样式设置为自定义，标识符设置为`specialsCell`，并且图像和标签与类文件中的变量相关联。

控制视图控制器的类`DOR_SearchViewController`带有 .h 和 .m 文件。.h 文件是：

```
#import <UIKit/UIKit.h>
#import <sqlite3.h>
#import "DOR_RestaurantClass.h"
#import "DOR_SearchCustomCell.h"

@class Reachability;

@interface DOR_SearchViewController : UIViewController <UIActionSheetDelegate, NSURLProtocolClient, NSXMLParserDelegate, UITableViewDelegate, UITableViewDataSource> {

    __weak IBOutlet UITableView *tblView;

    NSMutableData *receivedData;
    NSXMLParser* parser;
    NSString *currentElement;
    NSMutableString *currentElementValue;
    NSMutableArray *listItems;
    NSMutableArray *listOfIds;
    NSMutableArray *listOfNames;
    NSMutableArray *listOfDistances;
    NSMutableArray *listOfImages;
    NSMutableArray *listOfAddresses;
    NSMutableArray *listOfAddresses2;
    NSMutableArray *listOfAddresses3;
    NSMutableArray *listOfDescriptions;
    NSMutableArray *listOfPhones;
}

@property (weak, nonatomic) IBOutlet UITableView *tblView;

@property (nonatomic, retain) NSMutableData *receivedData;
@property (nonatomic, retain) NSXMLParser *parser;
@property (nonatomic, retain) NSString *currentElement;
@property (nonatomic, retain) NSMutableString *currentElementValue;
@property (nonatomic, retain) NSMutableArray *listItems;
@property (nonatomic, retain) NSMutableArray *listOfIds;
@property (nonatomic, retain) NSMutableArray *listOfNames;
@property (nonatomic, retain) NSMutableArray *listOfDistances;
@property (nonatomic, retain) NSMutableArray *listOfImages;
@property (nonatomic, retain) NSMutableArray *listOfAddresses;
@property (nonatomic, retain) NSMutableArray *listOfAddresses2;
@property (nonatomic, retain) NSMutableArray *listOfAddresses3;
@property (nonatomic, retain) NSMutableArray *listOfDescriptions;
@property (nonatomic, retain) NSMutableArray *listOfPhones;

- (void)get_table_data;

@end 
```

和 .m 文件：

```
#import "DOR_SearchViewController.h"
#import "Reachability.h"

@implementation DOR_SearchViewController

@synthesize tblView;

@synthesize receivedData;
@synthesize parser;
@synthesize currentElement;
@synthesize currentElementValue;
@synthesize listItems;
@synthesize listOfIds;
@synthesize listOfNames;
@synthesize listOfDistances;
@synthesize listOfImages;
@synthesize listOfAddresses;
@synthesize listOfAddresses2;
@synthesize listOfAddresses3;
@synthesize listOfDescriptions;
@synthesize listOfPhones;

- (void)viewWillAppear:(BOOL)animated {
    [super viewWillAppear:animated];

    if (![[self loadSettings:@"view"] isEqualToString: @""]){
        [sortButton setTitle:[self loadSettings:@"view"] forState: (UIControlState)UIControlStateNormal];
    }

    listItems = [[NSMutableArray alloc] init];
    listOfIds = [[NSMutableArray alloc] init];
    listOfNames = [[NSMutableArray alloc] init];
    listOfDistances = [[NSMutableArray alloc] init];
    listOfImages = [[NSMutableArray alloc] init];
    listOfAddresses = [[NSMutableArray alloc] init];
    listOfAddresses2 = [[NSMutableArray alloc] init];
    listOfAddresses3 = [[NSMutableArray alloc] init];
    listOfDescriptions = [[NSMutableArray alloc] init];
    listOfPhones = [[NSMutableArray alloc] init];
    [self get_table_data];
}

- (id)initWithNibName:(NSString *)nibNameOrNil bundle:(NSBundle *)nibBundleOrNil
{
    self = [super initWithNibName:nibNameOrNil bundle:nibBundleOrNil];
    if (self) {
        // Custom initialization
    }
    return self;
}

- (void)didReceiveMemoryWarning
{
    // Releases the view if it doesn't have a superview.
    [super didReceiveMemoryWarning];

    // Release any cached data, images, etc that aren't in use.
}

- (void)get_table_data {
    NSURLRequest *theRequest = [NSURLRequest requestWithURL:[NSURL URLWithString:@"http://www.url.com/"] cachePolicy:NSURLRequestUseProtocolCachePolicy timeoutInterval:60.0];
    NSURLConnection *theConnection = [[NSURLConnection alloc] initWithRequest:theRequest delegate:self];

    if (theConnection) {
        //NSLog (@"At connection");
        receivedData = [NSMutableData data];
    }
}

- (void)connection:(NSURLConnection *)connection didReceiveResponse:(NSURLResponse *)response {
    [receivedData setLength:0];
}

- (void)connection:(NSURLConnection *)connection didReceiveData:(NSData *)data {
    [receivedData appendData:data];
}

- (void)connection:(NSURLConnection *)connection didFailWithError:(NSError *)error {

}

-(void)connectionDidFinishLoading:(NSURLConnection *)connection {  
    if(parser){
        parser = nil;
    }

    parser = [[NSXMLParser alloc] initWithData: receivedData];
    [parser setDelegate: self];
    [parser setShouldResolveExternalEntities: YES];
    [parser parse];

    [tblView reloadData];
}

- (void)parser:(NSXMLParser *)parser didStartElement:(NSString *)elementName namespaceURI:(NSString *)namespaceURI qualifiedName:(NSString *)qualifiedName attributes:(NSDictionary *)attributeDict{
    //NSLog (@"At parser");
    currentElement = elementName;

    if ([currentElement isEqualToString:@"restaurant_details"]) {
        if ([currentElement isEqualToString:@"total_results"]) {
            //NSLog(@"Element: %@", currentElement);
        }else if ([currentElement isEqualToString:@"restaurant"]) {
            restaurantObj = [[DOR_RestaurantClass alloc]init];
        }
    }
}

- (void)parser:(NSXMLParser *)parser foundCharacters:(NSString *)string{
    //NSLog (@"At parser2");
    if(!currentElementValue)
        currentElementValue=[[NSMutableString alloc] initWithString:string];
    else
        [currentElementValue appendString:string];

    //NSLog(@"Name to be saved in Array :- %@",currentElement);

    //NSLog(@"the parser just found this text in a tag:%@",currentElementValue);
    if([currentElement isEqualToString:@"name"]) {
        restaurantObj.name=[NSString stringWithFormat:@"%@",currentElementValue];
        [listOfNames addObject:currentElementValue];
        //NSLog(@"At Name | Array = %@", listOfNames);
    }else{
        restaurantObj.name=@"";
    }
    if([currentElement isEqualToString:@"distance_from_current_location"]) {
        restaurantObj.distance=[NSString stringWithFormat:@"%@",currentElementValue];
        [listOfDistances addObject:string];
    }else{
        restaurantObj.distance=@"";
    }
    if([currentElement isEqualToString:@"restaurant_id"]) {
        restaurantObj.restId=[NSString stringWithFormat:@"%@",currentElementValue];
        [listOfIds addObject:string];
    }else{
        restaurantObj.restId=@"";
    }
    if([currentElement isEqualToString:@"address"]) {
        NSArray *stringArray = [currentElementValue componentsSeparatedByString:@" | "];
        restaurantObj.address=[stringArray objectAtIndex:0];
        restaurantObj.address2=[stringArray objectAtIndex:1];
        restaurantObj.address3=[stringArray objectAtIndex:2];
        [listOfAddresses addObject:[stringArray objectAtIndex:0]];
        [listOfAddresses2 addObject:[stringArray objectAtIndex:1]];
        [listOfAddresses3 addObject:[stringArray objectAtIndex:2]];
    }else{
        restaurantObj.address=@"";
        restaurantObj.address2=@"";
        restaurantObj.address3=@"";
    }
    if([currentElement isEqualToString:@"phone_number"]) {
        restaurantObj.phone=[NSString stringWithFormat:@"%@",currentElementValue];
        [listOfPhones addObject:string];
    }else{
        restaurantObj.phone=@"";
    }
    if([currentElement isEqualToString:@"description"]) {
        restaurantObj.description=[NSString stringWithFormat:@"%@",currentElementValue];
        [listOfDescriptions addObject:string];
    }else{
        restaurantObj.description=@"";
    }
    if([currentElement isEqualToString:@"image_url"]) {
        restaurantObj.image=[NSString stringWithFormat:@"%@",currentElementValue];
        [listOfImages addObject:string];
    }else{
        restaurantObj.image=@"";
    }
    if([currentElement isEqualToString:@"restaurant_type"]) {
        //restaurantObj.Name=[NSString stringWithFormat:@"%@",currentElementValue];
    }else{
        //restaurantObj.name=@"";
    }
    restaurantObj.expires=@"";

    //NSLog (@"ID Array: %@", restaurantObj);
}

-(void)parser:(NSXMLParser*)parser didEndElement:(NSString*)elementName namespaceURI:(NSString*)namespaceURI qualifiedName:(NSString*)qualifiedName {
    //NSLog(@"Current element in End Element Category:- %@",currentElement);
    if([elementName isEqualToString:@"restaurant"]) {
        //NSLog(@"Array: %@", restaurantObj);
        //[listItems addObject:restaurantObj];
    }else{
        currentElementValue=nil;
    }

}

// Implement viewDidLoad to do additional setup after loading the view, typically from a nib.
- (void)viewDidLoad
{
    [super viewDidLoad];
}

- (void)viewDidUnload
{
    [super viewDidUnload];
    [[NSNotificationCenter defaultCenter] removeObserver:self];
}

- (BOOL)shouldAutorotateToInterfaceOrientation:(UIInterfaceOrientation)interfaceOrientation
{
    // Return YES for supported orientations
    return (interfaceOrientation == UIInterfaceOrientationPortrait);
}

- (NSInteger)tableView:(UITableView *)tableView numberOfRowsInSection:(NSInteger)section
{
    NSLog (@"Table Cells: %d",[listOfIds count]);
    return [listOfIds count];
}

- (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath
{
    static NSString *cellID = @"specialsCell";

    DOR_SearchCustomCell *cell = [tableView dequeueReusableCellWithIdentifier:cellID];

    if (cell == nil){
        cell = [[DOR_SearchCustomCell alloc] initWithStyle:UITableViewCellStyleDefault reuseIdentifier:cellID];
    }

    NSLog (@"Name: %@", [listOfNames objectAtIndex:indexPath.row]);

    cell.cellTitle.text = [listOfNames objectAtIndex:indexPath.row];
    cell.cellText.text = [listOfDescriptions objectAtIndex:indexPath.row];
    cell.cellDistance.text = [listOfDistances objectAtIndex:indexPath.row];

    cell.textLabel.text = [listOfNames objectAtIndex:indexPath.row];

    return cell;
}

@end 
```

如果我没有在故事板中输入单元格标识符名称，我的项目将编译并且我确实获得了默认单元格样式（设置时`cell == nil`），这就是为什么我`cell.textLabel.text`在底部添加了该部分以用于测试目的。

我真的不太了解 iPhone 编程。任何帮助将不胜感激。我发现的所有教程似乎都不适合我的项目（在视图控制器中包含表格视图），并且在我尝试实现它们时都不起作用。感谢所有回复。如果您需要更多信息，请与我们联系。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-15T14:24:57.073

问题是来自原型单元的 UIImageView 和 UILabel 出口。

原型细胞不是实际细胞；它作为真实实例的蓝图。**当您将 UIImageViews 放置在此蓝图单元格中然后**通过插座将它们绑定到您的类时，Storyboard 会不高兴。您基本上是在尝试将抽象的事物与具体的事物联系起来。那时，故事板失败并出现了这个不友好的构建错误。

此线程中的更多详细信息：[“无法编译连接：”错误是什么意思？](https://stackoverflow.com/questions/9236621/what-does-the-couldnt-compile-connection-error-mean)

# javascript - 悬停时如何使文本显示在图像顶部？

> ID：10180791
> 
> 赞同：0
> 
> 时间：2012-04-16T20:00:02.650
> 
> 标签：javascript, html, css

当鼠标悬停在图像上时，图像会变得模糊，并且会在图像顶部显示文本。我使用下面的代码自己尝试过，但似乎“文本”在悬停时移到了图像之外……谁能告诉我为什么？

代码：

html:

```
<span class ="row_1">
<a href="#">
<div class = "caption"> testing </div>
<img class = "img_link" src="image/food/food1.jpg" />
</a>
</span> 
```

CSS：

```
.caption
{
display: none;
} 
```

查询：

```
 $('a').hover(
    function(){
    var image = $(this).find('img'),
     caption = $(this).find('div');
     caption.width(image.width());
     caption.height(image.height());
     caption.fadeIn();
    },
    function(){
     var image= $(this).find('img'),
        caption = $(this).find('div');

    caption.width(image.width());
    caption.height(image.height());
    caption.fadeOut();
}); 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-16T20:33:19.183

首先，我必须更正您的 HTML。A `div`（块级元素）*不是*a`span`或`a`元素（两者都是行内元素）的有效子元素。因此，将您的 HTML 修改为以下内容：

```
<span class="row_1">
    <a href="#">
        <span class="caption">testing</span>
        <img class="img_link" src="http://davidrhysthomas.co.uk/img/dexter.png" />
    </a>
</span>​ 
```

也就是说，如果可能的话，我建议为此使用纯 CSS：

```
a {
    display: inline-block;
    position: relative;
}
.caption {
    display: none;
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    background-color: #333; /* for browsers that don't understand rgba() notation */
    background-color: rgba(0,0,0,0.6);
    color: #f90;
    font-weight: bold;
    line-height: 1.1em;
}
a:hover .caption {
    display: block;
}​ 
```

[JS 小提琴演示](http://jsfiddle.net/davidThomas/J8r34/1/)。

您甚至可以使用 CSS3 转换，甚至实现淡入转换（对于那些不理解/实现转换的浏览器，它会优雅地降级，尽管在此示例中，您可能必须使用 Microsoft 专有过滤器来满足旧版 IE 合规性):

```
a {
    display: inline-block;
    position: relative;
}
.caption {
    opacity: 0;
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    background-color: #333; /* for browsers that don't understand rgba() notation */
    background-color: rgba(0,0,0,0.6);
    color: #f90;
    font-weight: bold;
    line-height: 1.1em;
    -webkit-transition: all 1s linear;
    -o-transition: all 1s linear;
    -ms-transition: all 1s linear;
    -moz-transition: all 1s linear;
    transition: all 1s linear;
}
a:hover .caption {
    opacity: 1;
    -webkit-transition: all 1s linear;
    -o-transition: all 1s linear;
    -ms-transition: all 1s linear;
    -moz-transition: all 1s linear;
    transition: all 1s linear;
}​ 
```

[JS 小提琴演示](http://jsfiddle.net/davidThomas/J8r34/2/)。

如果您必须使用 jQuery，那么我建议您保持非常非常简单：

```
​$('.row_1 a').hover(
    function(){
        $(this).find('.caption').fadeIn(1000);
    },
    function(){
        $(this).find('.caption').fadeOut(1000);
    });​​​​​​​​ 
```

[JS 小提琴演示](http://jsfiddle.net/davidThomas/J8r34/3/)。

参考：

*   [CSS`transition`](http://www.w3.org/TR/css3-transitions/)。
*   [`fadeIn()`](http://api.juery.com/fadeIn/).
*   [`fadeOut()`](http://api.juery.com/fadeOut/).
*   [`find()`](http://api.juery.com/find/).

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-16T20:36:22.257

您不需要为此使用 Javascript。下面的这段代码足以显​​示标题。

```
a:hover .caption { display: block; } 
```

但标题必须首先正确定位。

### [演示](http://jsfiddle.net/Starx/9MshR/)

# mysql - SQL 对列中的重复值分组

> ID：10180793
> 
> 赞同：0
> 
> 时间：2012-04-16T20:00:09.437
> 
> 标签：mysql, sql, group-by, sql-order-by

我在 MySQL 中有一个如下所示的 SQL 表：

```
id  technician_id  actionDate  station_id
1     10           1317909863      1
2     10           1317909864      1
3     10           1317909865      1
4     10           1317909866      2
5     10           1317909867      2
6     10           1317909868      2
7     10           1317909869      2
8     10           1317909870      2
9     10           1317909871      3
10    10           1317909872      1
11    10           1317909873      1 
```

该数据用于跟踪现场的技术人员。id 列是一个自动增量键。actionDate 列是自 1970 年以来的秒数，station_id 是技术人员正在执行操作的场地上的工作站 ID。

我想从这些数据中确定一些“统计数据”。例如，我想确定技术人员走的路线（从 1 号站到 2 号站，然后从 2 号站到 3 号站，然后从 3 号站回到 1 号站）。还想确定他每次去一个车站花了多少时间（例如：他去1号站，停留3分钟，然后坐他的车30分钟去2号站，停留15分钟，然后坐他的车在 20 分钟内到 3 号站，停留 10 分钟然后回到 1）。

如您所知，这是一个跟踪系统。我需要按actionDate 排序，然后按station_id 分组。但由于技术人员可以访问超过 1 次的站点，因此无法按该列对其进行分组。

任何指针？

我有这个，但它重新组合了所有具有相同 station_id 的行：

```
select station_id, min(actionDate), max(actionDate) 
from Action
where technician_id = 10
group by station_id
order by actionDate; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-16T20:06:22.113

我讨厌推荐游标，但看着它，它似乎是一个候选者。游标可以在该数据中压缩一次，同时填充一个临时表。

我花了很多时间来寻找重叠的时间范围等类似的问题，并且已经意识到在某些情况下运行游标是一个更好更快的选择。

也许这里有人可以提出其他建议......

如果你需要一个例子，请告诉我。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-16T20:25:13.983

这在 mssql 中会更容易，但这篇文章可能会有所帮助，[http://www.explodybits.com/2011/11/mysql-row-number/](http://www.explodybits.com/2011/11/mysql-row-number/)

对于您想要查询的第一部分，其中行号是 1 按站 ID 分区。

# regex - 正则表达式 IPv6 验证和可选方括号？

> ID：10180798
> 
> 赞同：3
> 
> 时间：2012-04-16T20:00:26.363
> 
> 标签：regex, ipv6

大家好，这里的正则表达式新手。，

我正在尝试编写一个验证 IPv6 地址的正则表达式。我还没有添加端口部分，我想先让地址部分工作。

这是我到目前为止所拥有的：

```
\\[?(?:[:0-9A-Fa-f]+)\\]? 
```

这使得打开和关闭括号是可选的。但正如您所见，它们是独立可选的。正则表达式有没有办法同时要求左*括号和右括号*，或者*两者都不*要求？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-16T20:28:33.233

正则表达式是一个很好的字符串模式匹配工具，但是您在这里遇到了它的一个弱点。匹配括号对可能会变得棘手。

在更复杂的情况下——即尝试读取程序代码时——解决方案根本不使用正则表达式，而是使用适当的代码解析器。

即使是相当简单的情况也可能难以回答，因为所涉及的正则表达式语法可能非常复杂，而且还因为像这样的更高级的正则表达式功能，不同的实现可能使用不同的语法。[这个问题](https://stackoverflow.com/questions/3349999/converting-pcre-recursive-regex-pattern-to-net-balancing-groups-definition)可能会提供一些关于如何去做的提示，以及您可能使用的不同语法。

但是，在您的情况下，问题并不太复杂，并且出现了一个相当简单的解决方案：只需将整个表达式与所需的两个括号匹配，或者将整个表达式与两个括号都不匹配。换句话说，将表达式的主要部分重复两次，一次带括号，一次不带括号，并`or`在它们之间使用管道：

```
\(\[(?:[:0-9A-Fa-f]+)\])|(?:[:0-9A-Fa-f]+)\ 
```

希望有帮助。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2019-08-21T13:24:20.390

我看到这是一个老问题......但你也可以在这个正则表达式中使用： ^([0-9a-fA-F]+:){7}[0-9a-fA-F]+$ 或这个: ^[0-9a-fA-F]{1,4}:[0-9a-fA-F]{1,4}:[0-9a-fA-F]{1,4}:[0- 9a-fA-F]{1,4}:[0-9a-fA-F]{1,4}:[0-9a-fA-F]{1,4}:[0-9a-fA-F ]{1,4}:[0-9a-fA-F]{1,4}$

# drupal-7 - 在 Drupal 7 中，如何使用“搜索视图”模块将搜索词过滤器添加到我的视图中？

> ID：10180799
> 
> 赞同：2
> 
> 时间：2012-04-16T20:00:32.820
> 
> 标签：drupal-7, drupal-views, drupal-modules, drupal-search

在我的 Drupal 7 站点上，我试图从使用核心搜索模块切换到搜索 API 模块。

如何使用“搜索视图”模块将搜索词过滤器添加到我的视图中？“搜索视图”模块声称它将搜索 API 模块与视图模块集成在一起，但是当我编辑视图时，我找不到任何要添加的搜索词过滤器。我怎样才能让它工作？

我在 Drupal 7 上安装了以下模块：

*   搜索 API (7.x-1.0)
*   数据库搜索 (7.x-1.0-beta2)
*   搜索页面 (7.x-1.0-beta2)
*   搜索视图 (7.x-1.0)
*   视图 (7.x-3.3) 视图 UI (7.x.3.3)

我禁用了以下核心模块：

*   搜索 (7.12)

在搜索 API 中，我创建了一个服务器（使用数据库搜索模块）和两个索引。我多次运行 cron 作业，创建了一个搜索页面（使用搜索页面模块），并测试了我的索引。他们似乎工作。那么如何使用“搜索视图”将我的视图连接到搜索 API？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-17T23:51:17.933

我花了一段时间才弄清楚，因为我将搜索索引命名为“内容”，这是一个坏主意。此后，我将其重命名为“内容索引”。

在搜索 api 中创建服务器和索引后，它将自动创建一个新的视图类型。她是基本步骤

1.  添加新视图
2.  在“显示”下，您应该看到“内容索引”或您的搜索 API 索引的名称。
3.  现在添加适用的字段（标题、描述、作者、相关性等）
4.  过滤条件添加“搜索：全文搜索”并公开它以允许您的用户输入搜索词。
5.  给页面一个 url 和一个标题
6.  尝试新的搜索页面。

我还发现这个视频演练很有帮助，因为它是用早期版本的搜索 API 和视图拍摄的，所以并不准确。 [https://vimeo.com/15556855](https://vimeo.com/15556855)

# tfs - tfs 工作项字段自定义

> ID：10180800
> 
> 赞同：2
> 
> 时间：2012-04-16T20:00:36.140
> 
> 标签：tfs, tfs-workitem

团队基础服务器 2010 中是否有办法根据另一个字段的日期值将工作项字段设为只读？

例如，如果截止日期已过，我需要将其中一个工作项字段设为只读。我试图避免客户端部署此功能并尝试从服务器运行所有内容。是否可以使用工作流程、自定义字段？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-17T16:13:57.337

这不可能。实现此目的的解决方法是不使用特定日期，而是使用迭代。当工作项处于特定迭代中时，您可以将其设为只读。这不完全是你想要的，但它可能对你有用。

请参阅[游侠定制指南](http://vsartfsptguide.codeplex.com/releases/view/83765)如何实现这一点。

# perforce - Perforce 变更列表摘要

> ID：10180803
> 
> 赞同：3
> 
> 时间：2012-04-16T20:00:41.433
> 
> 标签：perforce, changelist, revision-history

有谁知道如何获得 perforce 以生成文件历史记录的详细信息和描述表？

GUI 或命令行解决方案都可以。在 P4V GUI windows 客户端上，当您在工作空间树状视图中右键单击文件，并选择“文件历史记录”时，您可以看到每个修订的列表，其中描述是该列表的最后一列。我很想以打印机友好的格式打印这个列表（因为如果有很长的描述，它永远不会出现在屏幕上）。

基本上，我需要一个漂亮的、整洁的文件列表，其中包含对文件的每次更改、日期和更改说明。除了在“文件历史记录”中之外，我还没有找到一种让 perforce 生成此可打印列表的方法，但除了使用我不想使用的截图工具或打印屏幕之外，这是不可打印的。

最好的情况是包含日期和描述的列表，以及差异分析的摘要，以准确显示特定文件的每个修订版中的更改内容。

对此的任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-16T21:41:56.017

您可以尝试使用[P4Report](http://www.perforce.com/product/components/tools_utilities/tools_utilities) * 创建一个直接从 Perforce 查询此信息的报告。它通过提供集成到许多报告程序（例如 Crystal Reports、Microsoft Excel 等）中的 ODBC 数据源来实现这一点。

我自己以前没有使用过它，但是如果有机会我会在编写自定义脚本时这样做。

[Perforce 手册中](http://www.perforce.com/perforce/doc.current/manuals/p4report/01_install.html)有一些关于如何设置它的文档，并且有大量关于在 Microsoft Excel 中使用数据源的教程/信息。

从您的其他问题/答案中，我可以看到您知道如何使用 ODBC 数据源，因此*P4Reports*应该为您提供所需的内容。至于您需要的实际 p4 命令，请参阅[Karl Bielefeldt 的回答](https://stackoverflow.com/a/10181412/73025)。

[* 它位于其他*工具和实用程序中页面的一半左右*]

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-16T20:44:21.520

`p4 changes -l <filename>`将在 CLI 上为您提供此信息。我相信获得个人差异信息的唯一方法是编写一个`p4 describe`在每个相关变更列表上运行的脚本。

# ios - UILabel 数组

> ID：10180809
> 
> 赞同：0
> 
> 时间：2012-04-16T20:01:02.717
> 
> 标签：ios, uilabel

我正在开发一个应用程序，我想创建一个 UILabels 数组。你能帮我么？

我应该创建标签编写代码还是可以使用界面构建器？

提前致谢 ！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-16T20:58:23.080

您可以在代码或界面生成器中执行此操作。在界面生成器中，您可以将所有 UILabel 连接到 IBOutletCollection - 显然，在代码中，您可以创建和填充自己的 NSArray。

IBOutletCollection 属性应该类似于：

```
@property (retain, nonatomic) IBOutletCollection(UILabel) NSArray *test; 
```

请记住，数组的顺序不一定与您在 IB 中将 UILabel 连接到它的顺序相同。如果这很重要，您应该根据需要对数组进行排序，`viewDidLoad`或者选择手动创建数组。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-16T20:42:48.780

在IB中，这将是最简单的。这样的结构称为 IBOutletCollection，正是您所描述的，一个标签数组。

# php - PHP 从表单传递和接收二维数组

> ID：10180810
> 
> 赞同：2
> 
> 时间：2012-04-16T20:01:04.193
> 
> 标签：php, forms, multidimensional-array

我正在尝试将两个成对的变量、一个类别及其用于多个用户创建的类别的 id 从 web 表单传递到文件进行处理。我想让它们保持链接，因此如果有人更改名称字段，我们很清楚他们正在更改的记录，因为该记录通过 id 链接到其他表。

本来尝试二维数组...已经放弃了这种方法。现在尝试按照下面的建议使用两个一维数组。我将使用数组，因为表单上的条目数取决于用户创建了多少类别。类别表具有 id(int)、cat(text) 和 userid(int) 字段

传递两个数组的难点在于如何将两者联系起来。如果我将类别作为数组传递给接收页面，我可以遍历值以生成 sql 语句来更改每个条目。但是，我不知道如何获得识别记录所需的正确 id。如果我在 foreach(catsarray as $val) 中使用 foreach($idarray as $id)，我将为每只猫获得多个 id。如何在遍历猫的同时遍历 id？非常感谢您的帮助，因为我现在已经花了两天时间来解决这个问题:(

```
//I am working with $catsarray and $idarray, each with identical indexes, 1,2,3 etc.
//How do I get appropriate id for each cat
foreach($catsarray as $val) {
$sql = "UPDATE cats, set name = $val WHERE (userid ='$userid' AND id=??????)";
mysql_query($sql);
} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-16T20:06:01.243

用于创建二维数组的良好且单一的语法；

```
 <input type="text" name="cat[]" value="cat1">
  <input type="text" name="cat[]" value="cat2">
    ... 
```

接猫时；

```
echo $_POST['cat'][0] // echoes cat1
echo $_POST['cat'][1] // echoes cat2 
```

进一步的例子；

根据这个定义，

```
<input type="text" name="cat[$cat][$id]" value="cat1">

foreach ($_POST['cat'] as $a=>$b){
    // $a == $cat
    foreach($b as $c=>$d) {
       // $c == $id
    }
} 
```

# php - 在数组中搜索并插入值

> ID：10180811
> 
> 赞同：0
> 
> 时间：2012-04-16T20:01:05.233
> 
> 标签：php, multidimensional-array

我有一个像这样的数组：

```
> Array
> (
>>    [trilha] => 1
>>    [0] => Array
>>>        (
>>>            [trilha] => 1,5
>>>            )
> ) 
```

我想与关键 TRILHA 交叉，插入相关值：

```
> Array
> (
>> [1] => A 
>> [1,5] => B
>> [1,5,4] => C
> ) 
```

可能吗？

结果应该是：

```
> Array
> (
>>    [trilha] => 1
>>    [INSERTED] => A
>>    [0] => Array
>>>        (
>>>            [trilha] => 1,5
>>>            [INSERTED] => B
>>>            )
> ) 
```

我将辅助数组中的值插入到第一个数组中。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-17T00:55:29.760

一些工作示例，基于堆栈的递归迭代和使用 PHP 变量别名的修改：

```
// to be modified:
$base = array(
    'trilha' => '1',
    array(
        'trilha' => '1,5',
    ),
);

// data for modification, binding value is key
$insert = Array(
    1 => 'A',
    '1,5' => 'B',
    '1,5,4' => 'C',
);

/*
 * stack based traversal and modifcation
 */
$stack = array();
$stack[] = &$base;
$first = 0;
while ($stack)
{
    $proc = & $stack[$first];
    unset($stack[$first++]);

    foreach ($proc as &$val) {
        if (is_array($val)) {
            $stack[] = &$val;
        }
    }

    if (!isset($proc['trilha'])) {
        continue;
    }
    $trilha = $proc['trilha'];
    if (!isset($insert[$trilha])) {
        continue;
    }
    $proc['INSERTED'] = $insert[$trilha];
}
unset($proc);

var_dump($base); 
```

# java - 学习多线程Java爬虫的好开始

> ID：10180813
> 
> 赞同：0
> 
> 时间：2012-04-16T20:01:14.063
> 
> 标签：java, multithreading, web-crawler

我正在用 Java 开发一个网络爬虫。我正在寻找一个好的项目来开发基于它的爬虫。然而，实际上有超过几百个用 Java 编写的爬虫。我正在寻找的是一个**相当简单**的爬虫，它具有：

*   多线程功能
*   很棒的表演
*   **基于最新的 Java 构建和新技术实现**
*   一个很好的文档
*   没有很多不必要的功能（膨胀）
*   能够轻松集成到我的项目中

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-17T20:39:34.300

> 我正在寻找的是一个相当简单的爬虫......

你不会真的发现，爬虫没有什么简单的！案例和要点，拥有这些功能并不简单（尤其是最后一个要点）：

*   多线程功能
*   很棒的表演
*   基于最新的 Java 构建和新技术实现
*   一个很好的文档
*   没有很多不必要的功能（膨胀）
*   能够轻松集成到我的项目中

Nutch 是一个功能齐全的 Java 爬虫，可以满足您的大部分需求： http: [//nutch.apache.org/](http://nutch.apache.org/)

此外，我建议您查看这个问题：[https ://stackoverflow.com/questions/2495289/what-is-a-good-java-web-crawler-library](https://stackoverflow.com/questions/2495289/what-is-a-good-java-web-crawler-library)

# modx - MODx 中特定内容类型的多个条目？

> ID：10180817
> 
> 赞同：0
> 
> 时间：2012-04-16T20:01:33.070
> 
> 标签：modx, modx-revolution

我是 MODx 的新手，我只是在寻找前进的方向。基本上我正在寻找一种方法来管理许多相同类型的内容，例如，我有一个显示所有客户评论的页面，我想网站管理员有一种方法可以将个人评论添加到评论页面?

想法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-16T20:38:57.827

非常非常简单，将您的“评论”创建为容器资源，将您的评论创建为子资源 [of 'reviews'] ~ 将它们从您的菜单中隐藏，然后使用 getResources extra 将内容从子资源中提取到自定义中块。您甚至可以使用模板变量或嵌套文件夹来进一步组织它们，甚至“评价”它们。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-21T01:50:04.213

最简单的方法是使用容器资源，并根据需要使用 getResources 聚合和列出它们。基本上是肖恩所说的。

或者，您也可以（如果您是开发人员或有预算聘请）构建[自定义资源类](http://rtfm.modx.com/display/revolution20/Custom+Resource+Classes)，这是 MODX Revolution 2.2+ 中的新功能。这将允许您自定义管理界面和几乎任何底层流程，以制作真正定制的解决方案。对大多数人来说，这可能是矫枉过正，但如果做得好，它可以改善管理体验。[这里有一个教程](http://rtfm.modx.com/display/revolution20/Creating+a+Resource+Class)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-03T09:53:37.893

除了将评论创建为普通子资源或自定义资源类之外，您还可以查看额外的[MIGX](http://modx.com/extras/package/migx)。

它为您提供了一台电视，可以非常轻松地管理无限数量的条目列表。您可以对这些条目进行任意排序，让条目包含多个不同的电视（甚至在不同的选项卡上），您可以快速完成并保持资源树的清洁。

为了帮助您入门，请查看[文档](http://rtfm.modx.com/display/addon/MIGX)或阅读 Mark Hamstra 关于使用 MIGX 构建图像库的[教程](http://www.markhamstra.com/modx-blog/2012/04/managing-galleries-with-migx/)。

# oracle - 如何从服务器上的本地驱动器运行 SQL 脚本？

> ID：10180822
> 
> 赞同：3
> 
> 时间：2012-04-16T20:01:53.283
> 
> 标签：oracle, command-line, sqlplus

我用 sql 连接到服务器，

我做到了，

```
SQL>@/path/to/file.sql 
```

但出现`SP2-0310: unable to open file`错误。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-16T20:06:07.607

在 @ 符号 @"..." 之后尝试将整个内容用双引号引起来

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-16T20:18:00.500

尝试先转到脚本所在的文件夹，然后连接到服务器并运行 SQL>file.sql。使用 MySQL 这可以工作。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-16T21:56:01.893

.sql 文件是在服务器上还是在您的客户端系统上？它必须驻留在客户端系统上才能正常工作。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-12-17T22:45:04.303

我不确定如何在 Unix 中执行此操作，但如果您在 Windows 中启动，请进入用于启动 SQL*Plus 的图标的属性并设置“开始于：”字段以包含脚本的路径. 假设文件在 Dive A：对于这个例子，你可以把 A:\Path\to\File 然后在提示符处使用@file.sql（或者只使用@file，因为默认扩展名是“.sql”）。

# python - 如何使用 django-tracking 包

> ID：10180824
> 
> 赞同：0
> 
> 时间：2012-04-16T20:02:03.397
> 
> 标签：python, django, tracking

我正在尝试 django_tracking 包（[https://github.com/codekoala/django-tracking](https://github.com/codekoala/django-tracking)），我得到了安装。

但我无法导入de模型..我正在尝试这样：

```
from tracking.models import Visitor 
```

它为我返回“未使用的导入：访客。未解决的导入：访客”。我在做什么？对不起，我是 Django 的初学者。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-18T16:48:45.720

我在 Eclipse 中重新加载了 python 解释器。它现在正在工作。谢谢。

# awk - AWK - 如何在 60 秒后结束此命令？

> ID：10180828
> 
> 赞同：1
> 
> 时间：2012-04-16T20:02:24.910
> 
> 标签：awk, system

我有这个命令：

```
awk 'BEGIN {system ("mplayer mms :// xx.xx.xx -dumpstream -dumpfile xxx.wmv")}' 
```

如何在 60 秒后结束此命令？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-16T20:06:07.030

您可以通过查询来获取 bash 子进程的 pid `$!`。存储 awk 进程的值，休眠 60 秒并杀死 awk 进程。

```
awk 'BEGIN {system ("mplayer mms :// xx.xx.xx -dumpstream -dumpfile xxx.wmv")}' &
pid=$!
sleep 60
kill $pid 
```

这要求您将 awk 进程作为后台进程运行，`&`以便父控件继续运行。

# facebook - FQL Multi查询IN子句中的多个SELECT语句

> ID：10180830
> 
> 赞同：1
> 
> 时间：2012-04-16T20:02:32.773
> 
> 标签：facebook, select, facebook-fql

我正在使用[FQL 多](https://developers.facebook.com/docs/reference/rest/fql.multiquery/)查询，我只需要类似他们的`query2`示例，除了我需要从两个不同的查询中选择 uid。

换句话说，他们有：

```
"query2":"SELECT name, url, pic FROM profile WHERE id IN (SELECT uid FROM #query1)" 
```

我想要类似的东西：

```
"query3":"SELECT name, url, pic FROM profile WHERE id IN (SELECT uid FROM #query1, SELECT uid FROM #query2)" 
```

但显然`(SELECT uid FROM #query1, SELECT uid FROM #query2)`这里使用的语法不正确，因为 Facebook 返回错误。什么是正确的语法？我试过谷歌搜索，但谷歌很难做到这一点。

是的，我知道我可以添加 a并在and之间`query4`拆分，但这感觉更优雅。`(SELECT uid FROM #query1, SELECT uid FROM #query2)``query3``query4`

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-16T20:13:34.010

您可以同时加入查询 1 和查询 2，因此您只能获得一张表，我认为这是实现您想要做的事情的最佳方式。

```
SELECT xxx FROM xxx WHERE xxx IN(
    SELECT q1.uid,q2.uid
    FROM (query1) as q1, (query2) as q2
    WHERE "joining clause"
) 
```

来源： [加入两个sql查询](https://stackoverflow.com/questions/564997/join-two-sql-queries)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-17T15:03:33.023

我最终只是`query4`为第二个查询（）`SELECT uid FROM #query2`，因为看起来 Facebook 不完全支持我最初想要的。

# .net - Visual Studio 中的 MSTest 项目：将哪些文件提交到版本控制？

> ID：10180833
> 
> 赞同：5
> 
> 时间：2012-04-16T20:02:36.250
> 
> 标签：.net, visual-studio-2010, version-control, mstest

我第一次在我的 Visual Studio 解决方案中添加了一个 MSTest 项目，以便进行一些单元测试。我想将解决方案提交到我们的源代码存储库，但是有一堆新的文件类型 - 我不确定是否将它们添加到存储库。你能帮助我吗？

新文件：

*   本地.testsettings
*   项目名称.vsmdi
*   TraceAndTestImpact.testsettings
*   一些TestResults/machinename.trx

谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-16T20:07:20.363

您只需要检查运行测试所需的内容，例如在 CI（持续集成）环境中自动运行单元测试或在开发人员的机器上手动运行。为了那个原因

*   本地.testsettings
*   项目名称.vsmdi
*   TraceAndTestImpact.testsettings

是必需的，否则如果在 CI 服务器上运行 MSTest（例如，至少对于 Cruise Control 将 MSTest 作为`exec`构建的一部分运行）或静默生成这些文件（如果在开发人员的盒子上运行与 Visual Studio 集成的 MSTest），则 MSTest 将失败。

实际的历史测试结果数据对于版本控制并没有真正有用，特别是如果您只是对“所有测试都是绿色的”感兴趣 - 否则您的构建无论如何都会被破坏。

# jquery - 围绕我的 html 标签创建标签

> ID：10180846
> 
> 赞同：0
> 
> 时间：2012-04-16T20:03:21.963
> 
> 标签：jquery, tags

我想在 jquery 中创建一个插件。

这是我的 html 代码：

```
<div class="popup">
  <div class="bc_top">
    <div class="bc_tl"></div>
    <div class="bc_tm"></div>
    <div class="bc_tr"></div>
  </div>
  <div class="bc_middle">
    <div class="bc_ml">
      <div class="bc_mr">
        <div class="bc_cnt">

        </div>
      </div>
    </div>
  </div>
  <div class="bc_bottom">
    <div class="bc_bl"></div>
    <div class="bc_bm"></div>
    <div class="bc_br"></div>
  </div>
</div> 
```

我想在我的标签周围插入上面的代码，我的标签 html 内容应该插入到 div.bc_cnt 中，所以我编写了一个 jQuery 插件：

```
$.fn.popup = function() {
    $(this).before('<div class="popup">\
                      <div class="bc_top">\
                        <div class="bc_tl"></div>\
                        <div class="bc_tm"></div>\
                        <div class="bc_tr"></div>\
                      </div>\
                      <div class="bc_middle">\
                        <div class="bc_ml">\
                          <div class="bc_mr">\
                            <div class="bc_cnt">'+$(this).html()+'</div>\
                          </div>\
                        </div>\
                      </div>\
                      <div class="bc_bottom">\
                        <div class="bc_bl"></div>\
                        <div class="bc_bm"></div>\
                        <div class="bc_br"></div>\
                      </div>\
                    </div>');   

} 
```

我这样使用：

```
<scritp>
    $('div#pop').popup();
</script>

    <div id="pop">
        this is a test
    </div> 
```

一切正常，但这段代码只插入所选标签的 html 内容以使用 $(this).html() 弹出，我想在弹出窗口中插入完整的标签（我的意思是`<div id="pop">this is a test</div>`）

我该怎么办？

PS：对不起我的英语不好。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-16T20:16:52.253

您应该尝试使用 $(this).text()

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-16T20:24:41.453

您可以克隆 orig 元素，将其附加到临时 div 并获取 div 的 html。见下文，

```
$('<div>').append($(this).clone()).html() 
```

[**演示**](http://jsfiddle.net/skram/VpGwR/)

如果要删除原始文件，可以`.remove`在函数末尾使用 as`$(this).remove()`

# ios - 我们如何确保第三方库不会在我的 iOS 应用程序中发送用户数据？

> ID：10180850
> 
> 赞同：1
> 
> 时间：2012-04-16T20:03:31.633
> 
> 标签：ios, security, memory-management

如果我需要包含第 3 方 SDK 以从我的 iOS 应用程序中连接到无线打印机，我想它在我的代码的同一内存空间中运行。我如何确保 SDK 不会在后台做任何偷偷摸摸的事情来窃取应用程序内的用户数据？我可以使用任何网络监控来验证应用程序的网络流量吗？谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-16T20:13:05.447

这很难检测（除非您可以分析源代码）。

1.  您可以在 iOS 模拟器中运行它并使用 [network sniffer] 分析网络流量。但仍然如此：应用程序只能在满足某些条件时上传数据（比如在晚上 01:00 到 04:00 之间或其他任何时间）。

2.  您可以使用[IDAPro](http://www.hex-rays.com/products/ida/index.shtml)或其他支持 arm 的反汇编程序对您的库进行逆向工程并分析该库的确切功能。

如果您很懒惰，您可以在十六进制编辑器中打开库并在文本“http://”之后搜索并查找可能的 url。但是图书馆可以隐藏/加密网址！所以。这仅用于懒惰的快速检查。

请记住：如果不查看源代码，您永远无法完全确定这一点。所以。去开源库！:)

[1](http://www.hex-rays.com/products/ida/index.shtml) .

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-16T20:15:54.463

对于一般流量嗅探，请查看 WireShark。对于 HTTP 嗅探，我发现 Charles 更方便。

但是，您永远无法确定 3rd 方代码会做什么。例如，可以编写一个例程，该例程仅在特定日期之后的生产版本上执行。

# python - 如何使用 Python 中的 boto 库获取 Amazon SQS 队列中的所有消息？

> ID：10180851
> 
> 赞同：20
> 
> 时间：2012-04-16T20:03:34.190
> 
> 标签：python, boto, amazon-sqs

我正在开发一个应用程序，其工作流是通过使用 boto 在 SQS 中传递消息来管理的。

我的 SQS 队列正在逐渐增长，我无法检查它应该包含多少元素。

现在我有一个定期轮询队列的守护进程，并检查我是否有一组固定大小的元素。例如，考虑以下“队列”：

```
q = ["msg1_comp1", "msg2_comp1", "msg1_comp2", "msg3_comp1", "msg2_comp2"] 
```

现在我想在某个时间点检查队列中是否有“msg1_comp1”、“msg2_comp1”和“msg3_comp1”，但我不知道队列的大小。

查看 API 后，您似乎只能获得 1 个元素，或者队列中的元素数量固定，但不是全部：

```
>>> rs = q.get_messages()
>>> len(rs)
1
>>> rs = q.get_messages(10)
>>> len(rs)
10 
```

答案中提出的一个建议是在一个循环中获取例如 10 条消息，直到我什么也得不到，但是 SQS 中的消息有可见性超时，这意味着如果我从队列中轮询元素，它们不会被真正删除，它们只会在短时间内不可见。

有没有一种简单的方法来获取队列中的所有消息，而不知道有多少？

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2012-04-16T20:06:24.347

把你的电话`q.get_messages(n)`放在while循环里面：

```
all_messages=[]
rs=q.get_messages(10)
while len(rs)>0:
    all_messages.extend(rs)
    rs=q.get_messages(10) 
```

此外，[转储也不支持超过 10 条消息](https://github.com/boto/boto/blob/develop/boto/sqs/queue.py)：

```
def dump(self, file_name, page_size=10, vtimeout=10, sep='\n'):
    """Utility function to dump the messages in a queue to a file
    NOTE: Page size must be < 10 else SQS errors""" 
```

* * *

## 回答 #2

> 赞同：22
> 
> 时间：2015-10-15T18:36:27.380

我一直在使用 AWS SQS 队列来提供即时通知，因此我需要实时处理所有消息。以下代码将帮助您有效地使（所有）消息出队并在删除时处理任何错误。

注意：要从队列中删除消息，您需要删除它们。我正在使用更新的 boto3 AWS python SDK、json 库和以下默认值：

```
import boto3
import json

region_name = 'us-east-1'
queue_name = 'example-queue-12345'
max_queue_messages = 10
message_bodies = []
aws_access_key_id = '<YOUR AWS ACCESS KEY ID>'
aws_secret_access_key = '<YOUR AWS SECRET ACCESS KEY>'
sqs = boto3.resource('sqs', region_name=region_name,
        aws_access_key_id=aws_access_key_id,
        aws_secret_access_key=aws_secret_access_key)
queue = sqs.get_queue_by_name(QueueName=queue_name)
while True:
    messages_to_delete = []
    for message in queue.receive_messages(
            MaxNumberOfMessages=max_queue_messages):
        # process message body
        body = json.loads(message.body)
        message_bodies.append(body)
        # add message to delete
        messages_to_delete.append({
            'Id': message.message_id,
            'ReceiptHandle': message.receipt_handle
        })

    # if you don't receive any notifications the
    # messages_to_delete list will be empty
    if len(messages_to_delete) == 0:
        break
    # delete messages to remove them from SQS queue
    # handle any errors
    else:
        delete_response = queue.delete_messages(
                Entries=messages_to_delete) 
```

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2012-04-21T23:11:19.517

我的理解是，SQS 服务的分布式特性几乎使您的设计不可行。每次调用 get_messages 时，您都在与一组不同的服务器通信，这些服务器将包含您的一些但不是全部消息。因此，不可能“不时签入”来设置一组特定的消息是否准备好，然后就接受这些消息。

您需要做的是不断地轮询，在所有消息到达时获取它们，并将它们本地存储在您自己的数据结构中。每次成功获取后，您可以检查您的数据结构以查看是否收集了完整的消息集。

请记住，消息*将*无序到达，并且某些消息*将*被传递两次，因为删除必须传播到所有 SQS 服务器，但随后的获取请求有时会击败删除消息。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2017-06-21T15:02:40.893

我在 cronjob 中执行这个

```
from django.core.mail import EmailMessage
from django.conf import settings
import boto3
import json

sqs = boto3.resource('sqs', aws_access_key_id=settings.AWS_ACCESS_KEY_ID,
         aws_secret_access_key=settings.AWS_SECRET_ACCESS_KEY,
         region_name=settings.AWS_REGION)

queue = sqs.get_queue_by_name(QueueName='email')
messages = queue.receive_messages(MaxNumberOfMessages=10, WaitTimeSeconds=1)

while len(messages) > 0:
    for message in messages:
        mail_body = json.loads(message.body)
        print("E-mail sent to: %s" % mail_body['to'])
        email = EmailMessage(mail_body['subject'], mail_body['message'], to=[mail_body['to']])
        email.send()
        message.delete()

    messages = queue.receive_messages(MaxNumberOfMessages=10, WaitTimeSeconds=1) 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2016-11-16T17:10:12.503

**注意：这不是对问题的直接回答。** 相反，它是对[@TimothyLiu 答案](https://stackoverflow.com/a/33156030/4228193)的补充，假设最终用户使用的`Boto`不是包（又名 Boto2）`Boto3`。[此代码是他的回答](https://stackoverflow.com/a/33156030/4228193)`delete_messages`中提到的调用的“Boto-2 化”

* * *

`Boto`(2) 调用`delete_message_batch(messages_to_delete)`where`messages_to_delete`是一个 对象`dict`，其 key:value 对应于`id`: `receipt_handle`pair 返回

> AttributeError：“dict”对象没有属性“id”。

似乎`delete_message_batch`需要一个`Message`类对象；如果您一次删除超过 10 条“消息”，则复制[Boto 源`delete_message_batch`](https://github.com/boto/boto/blob/develop/boto/sqs/connection.py)并允许它使用非`Message`对象（ala [boto3 ）也会失败。](http://boto3.readthedocs.io/en/latest/reference/services/sqs.html#SQS.Client.delete_message_batch)所以，我不得不使用以下解决方法。

从[这里打印代码](https://stackoverflow.com/a/14981125/4228193)

```
from __future__ import print_function
import sys
from itertools import islice

def eprint(*args, **kwargs):
    print(*args, file=sys.stderr, **kwargs)

@static_vars(counter=0)
def take(n, iterable, reset=False):
    "Return next n items of the iterable as same type"
    if reset: take.counter = 0
    take.counter += n
    bob = islice(iterable, take.counter-n, take.counter)
    if isinstance(iterable, dict): return dict(bob)
    elif isinstance(iterable, list): return list(bob)
    elif isinstance(iterable, tuple): return tuple(bob)
    elif isinstance(iterable, set): return set(bob)
    elif isinstance(iterable, file): return file(bob)
    else: return bob

def delete_message_batch2(cx, queue, messages): #returns a string reflecting level of success rather than throwing an exception or True/False
  """
  Deletes a list of messages from a queue in a single request.
  :param cx: A boto connection object.
  :param queue: The :class:`boto.sqs.queue.Queue` from which the messages will be deleted
  :param messages: List of any object or structure with id and receipt_handle attributes such as :class:`boto.sqs.message.Message` objects.
  """
  listof10s = []
  asSuc, asErr, acS, acE = "","",0,0
  res = []
  it = tuple(enumerate(messages))
  params = {}
  tenmsg = take(10,it,True)
  while len(tenmsg)>0:
    listof10s.append(tenmsg)
    tenmsg = take(10,it)
  while len(listof10s)>0:
    tenmsg = listof10s.pop()
    params.clear()
    for i, msg in tenmsg: #enumerate(tenmsg):
      prefix = 'DeleteMessageBatchRequestEntry'
      numb = (i%10)+1
      p_name = '%s.%i.Id' % (prefix, numb)
      params[p_name] = msg.get('id')
      p_name = '%s.%i.ReceiptHandle' % (prefix, numb)
      params[p_name] = msg.get('receipt_handle')
    try:
      go = cx.get_object('DeleteMessageBatch', params, BatchResults, queue.id, verb='POST')
      (sSuc,cS),(sErr,cE) = tup_result_messages(go)
      if cS:
        asSuc += ","+sSuc
        acS += cS
      if cE:
        asErr += ","+sErr
        acE += cE
    except cx.ResponseError:
      eprint("Error in batch delete for queue {}({})\nParams ({}) list: {} ".format(queue.name, queue.id, len(params), params))
    except:
      eprint("Error of unknown type in batch delete for queue {}({})\nParams ({}) list: {} ".format(queue.name, queue.id, len(params), params))
  return stringify_final_tup(asSuc, asErr, acS, acE, expect=len(messages)) #mdel #res

def stringify_final_tup(sSuc="", sErr="", cS=0, cE=0, expect=0):
  if sSuc == "": sSuc="None"
  if sErr == "": sErr="None"
  if cS == expect: sSuc="All"
  if cE == expect: sErr="All"
  return "Up to {} messages removed [{}]\t\tMessages remaining ({}) [{}]".format(cS,sSuc,cE,sErr) 
```

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2015-02-07T00:31:21.427

类似下面的代码应该可以解决问题。抱歉，它在 C# 中，但转换为 python 应该不难。字典用于清除重复项。

```
 public Dictionary<string, Message> GetAllMessages(int pollSeconds)
    {
        var msgs = new Dictionary<string, Message>();
        var end = DateTime.Now.AddSeconds(pollSeconds);

        while (DateTime.Now <= end)
        {
            var request = new ReceiveMessageRequest(Url);
            request.MaxNumberOfMessages = 10;

            var response = GetClient().ReceiveMessage(request);

            foreach (var msg in response.Messages)
            {
                if (!msgs.ContainsKey(msg.MessageId))
                {
                    msgs.Add(msg.MessageId, msg);
                }
            }
        }

        return msgs;
    } 
```

# asp.net - 使用 ItemDataBound 我只得到每隔一行。为什么？

> ID：10180853
> 
> 赞同：4
> 
> 时间：2012-04-16T20:03:38.187
> 
> 标签：asp.net, itemdatabound

我使用如下代码在绑定后对表中的每一行进行操作：

```
 protected void dtlImages_ItemDataBound(object sender, DataListItemEventArgs e)
    {
        if (e.Item.ItemType == ListItemType.Item)
        {
            LinkButton button = (LinkButton)e.Item.FindControl("lbDeleteImage");
            button.Visible = false;
        }
    } 
```

表格中每个图像旁边都有一个按钮，可让我删除图像（行）。这似乎运作良好，但实际发生的是它使每隔一行的项目（删除按钮）不可见。什么会导致这种情况发生？这很难在 Google 中找到要搜索的正确单词。:)

如果您看到我的表格，它看起来像是一个带有描述的漂亮图像列表，图像和图像旁边的每一行都有一个删除按钮。在这个简单的例子中（为了清楚起见，我省略了条件）我认为它们应该都消失了。

有什么建议么？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-16T20:13:41.677

我认为您很可能也需要检查[`ListItemType.AlternatingItem`](http://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.listitemtype.aspx)，如下所示：

```
if (e.Item.ItemType == ListItemType.Item || e.Item.ItemType == ListItemType.AlternatingItem) 
```

特别是考虑到它只捕获每隔一行的事实。

# javascript - 是否可以捕获对 jstree 上下文菜单项的单击？

> ID：10180854
> 
> 赞同：1
> 
> 时间：2012-04-16T20:03:38.527
> 
> 标签：javascript, jquery, json, eval, jstree

是否可以捕获对 jstree 上下文菜单项的单击？

我从json的文件中加载了一个这样的上下文菜单

```
{
    "item1" : {
        "label" : "item 1",
        "action" : "function(){alert('item 1')}"

     },
    "item2" : {
        "label" : "item 2",
        "action" : "function(){alert('item 2')}"
    }
} 
```

我想捕获对上下文菜单项的单击，以评估函数并执行它。有可能做这个吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-20T21:20:19.810

我是这样解决的：

```
$("#tree").jstree({ 
    "plugins" : [ "json_data"],
    "json_data" : {
        "ajax" : {
        "type": 'GET',
         "url": "json_data.json";
         "success": function (new_data) {   
                  return new_data;
          }
         }
       },
       "contextmenu" : {
        "items" : customMenu
        }
});

function customMenu(node) {
    var items = {};

    $.ajax({
       url: "contextmenu.json",
       dataType: 'script',
       async : false,
       success : function( script ){    
           eval(script)
           items = menuItems;                   
       } 
    });

    return items;
} 

// file: "contextmenu.json"
var menuItems = {
    "item1" : {
        "label" : "item 1",
        "action" : function(){alert('item 1')}

     },
    "item2" : {
        "label" : "item 2",
        "action" : function(){alert('item 2')}
    }
} 
```

# google-analytics - Google Analytics 侧边栏未在 Chrome 中加载

> ID：10180856
> 
> 赞同：1
> 
> 时间：2012-04-16T20:03:43.377
> 
> 标签：google-analytics

当我登录我的谷歌分析时，我在页面顶部看到加载的东西并没有消失。侧边栏`tr#ID-navPanelContainer`也不显示任何内容（保持空白）。

页面的其余部分工作正常。

这只发生在谷歌浏览器中。

有人对这个有经验么？有解决办法吗？

我需要侧边栏来访问流量和事件等功能

编辑：这是我看到的一些截图。登录时 ![在此处输入图像描述](../Images/595a40481f779e7d96abeca456c5f2da.png)

然后，如果我单击`All Accounts`：![在此处输入图像描述](../Images/3749c755929e09f8c8bca3d90d65bbc5.png)

然后如果我点击我的帐户：![在此处输入图像描述](../Images/031b8602aa976f7521906721acf81aad.png)

编辑2：

我在开发人员工具中收到此错误：

```
/analytics/web/#home/a29378725w55476325p56482285/:1GET https://stats.g.doubleclick.net/dc.js 
chrome-extension://babchocnjjcibnldbhddhlmdilchnabd/script.js:104Uncaught TypeError: Cannot read property 'parentNode' of null
analytics.js:1Uncaught Error: setEnhancedReportLoadingScreenEnabled called more than once
chrome-extension://babchocnjjcibnldbhddhlmdilchnabd/script.js:104Uncaught TypeError: Cannot read property 'parentNode' of null
analytics.js:1705Uncaught TypeError: Cannot set property 'innerHTML' of null 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-17T09:08:06.447

嗯，这是一些奇怪的东西，你的网站有什么奇怪的网址吗？

*   输入 URL 时只能使用 UTF-8 字符。您不能使用以下 UTF-8 字符： & = 。$ %20 ? ^ #
*   如果您输入的 URL 格式不正确，Google Analytics 会阻止您继续操作，直到您解决错误为止。
*   如果您网站的 URL 包含非 UTF-8 字符（例如，西里尔字母中的字符），请参阅以下文章： http: [//support.google.com/googleanalytics/bin/answer.py ?answer=1082131](http://support.google.com/googleanalytics/bin/answer.py?answer=1082131)

这是一个新事件，你刚刚安装了谷歌分析吗？您可以尝试使用网站的新跟踪 ID 创建个人资料

# .net - 如何在 .NET 应用程序中使用 Web 服务？

> ID：10180857
> 
> 赞同：0
> 
> 时间：2012-04-16T20:03:44.893
> 
> 标签：.net, web-services, delphi-xe, smartphone, delphi-prism

例如，我的冰箱里有一个温度传感器，它连接到计算机并可以访问互联网。我希望能够通过我的智能手机远程（从我的办公室）向计算机查询我的冰箱温度读数（比如说）。因此，传感器读数可以显示在我的智能手机或任何手持设备上。您可以在此类场景中使用 Web 服务吗？只是试图了解 Web 服务如何适应现实世界的场景。我习惯于编写大部分独立的应用程序。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-16T20:18:08.413

简短的回答是：是的，你可以。长答案是：只要您可以在您的智能手机和您的设备之间建立一个 http 连接，您就可以使用 Web 服务来做您想做的事情。在这种情况下，我怀疑找到一种简单的方法来处理通过一个或多个防火墙（假设您在办公室使用 wi-fi，将有 2 个，您的办公室和您家的）将是一个更大的挑战。

# ruby-on-rails - Rails 表单发布到 /new 而不是 /create？

> ID：10180862
> 
> 赞同：4
> 
> 时间：2012-04-16T20:04:15.013
> 
> 标签：ruby-on-rails, ruby

我有一个使用 Rails 3.1.x 应用程序的简单表单视图：

```
<%= form_for(:mymodel) do |f| %>
  <% if @mymodel.errors.any? %>
    <div id="error_explanation">
      <h2><%= pluralize(@mymodel.errors.count, "error") %> prohibited this model from being saved:</h2>

      <ul>
      <% @mymodel.errors.full_messages.each do |msg| %>
        <li><%= msg %></li>
      <% end %>
      </ul>
    </div>
  <% end %>

  <div class="field">
    Amount:
    <%= f.text_field :count %><br /><br />
  </div>
  <div class="actions">
    <%= f.submit %>
  </div>
<% end %> 
```

当在此处点击提交时，它会发布到`/mymodels/new`. 如何强制它为 mymodels_controller.rb 执行正确的创建操作？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-16T20:07:04.243

**选项 1：**遵循约定并向`form_for`助手提供新的未保存记录。您可能已经在控制器`@mymodel`的操作上设置了这样的对象。`new`所以下面的代码片段应该可以很好地工作：

```
<%= form_for(@mymodel) do |f| %> 
```

如果它不起作用，您可以`@mymodel`像这样设置您的操作：

```
class MyModelsController
  def new
    @mymodel = MyModel.new
  end
end 
```

**选项 2：**明确说明您的 URL 和方法：

```
<%= form_for(:mymodel, :url => create_mymodel_path, :method => :post) do |f| %> 
```

# c# - 将字节数组转换为字符串在c#中不起作用

> ID：10180864
> 
> 赞同：1
> 
> 时间：2012-04-16T20:04:26.180
> 
> 标签：c#, encoding, varbinary

我在数据库中有一个带有 varbinary 数据的 AttachmentFile 列。在 c# 中，我将它存储在一个 byte[] 数组中。我需要将此内容作为字符串显示给用户。我尝试了几种不同的方法将此字节数组转换为字符串，但似乎没有任何效果。

### 这就是我想要做的 -

```
while (rdr.Read())
{
    string name = rdr["AttachmentFileName"].ToString();
    string mime = rdr["AttachmentMIMEType"].ToString();
    byte[] content = (byte[])rdr["AttachmentFile"];

    string contentStr = (???)ConvertToString(content);
    r.AddHeader("Content-Disposition", "attachment; filename=" + name);
    r.ContentType = mime;
    r.Write(contentStr);
} 
```

### 这是我迄今为止尝试过的 -

```
string contentStr = Encoding.Default.GetString(content, 0, 10000);
string contentStr = Encoding.UTF8.GetString(content, 0, 10000);

content = Encoding.Convert(Encoding.GetEncoding("iso-8859-1"), Encoding.UTF8, content);
string contentStr = Encoding.UTF8.GetString(content, 0, 10000);

System.Text.Encoding enc = System.Text.Encoding.ASCII;
string contentStr = enc.GetString(content);

string contentStr = System.Convert.ToBase64String(content); 
```

但以上都没有给我一个清晰的字符串。有任何想法吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-04-16T20:07:55.810

看起来您正在寻找对象`BinaryWrite`上的方法`Response`。

又名：

```
 Response.BinaryWrite(content); 
```

# android - Android：浮动 - 摆脱尾随点零

> ID：10180868
> 
> 赞同：1
> 
> 时间：2012-04-16T20:04:38.680
> 
> 标签：android

我在互联网上进行了很多搜索，但找不到令人满意的解决方案。我做的最好的是：

```
String b = new BigDecimal(floatNumber.stripTrailingZeros().toPlainString(); 
```

但它有一些讨厌的错误，例如，如果数字是 1.6，我得到 1.600000744（或类似的）。

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-16T22:16:48.427

您所看到的实际上不是错误，它只是使用精度有限的浮点数的结果。它不能准确地表示 1.6。

如果您希望打印在某个点之后截断数字，您可以使用前面提到的 DecimalFormat 执行此操作：

`String result = new DecimalFormat("#.##").format(floatNumber).toString()`

这将打印两位小数，在小数点后添加任意数量的#'s 以被截断。但是从技术上讲，您看到的是 floatNumber 的正确值，即使您不想要那么高的精度。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-16T21:31:04.517

试试这个，

```
DecimalFormat twoDecForm = new DecimalFormat("#.##");

String b = twoDecForm.format(Double.parseDouble(Float.toString(floatNumber))); 
```

# sql-server-2008 - T-SQL 查询：展平表

> ID：10180878
> 
> 赞同：3
> 
> 时间：2012-04-16T20:05:28.650
> 
> 标签：sql-server-2008, tsql

我需要构建一个查询来解决下面的这种情况：

父表：

```
ParentId  Name
1         Parent A
2         Parent B 
```

子表：

```
ChildId   ParentId  Name 
10        1         Child X
11        1         Child Y
12        1         Child Z
13        2         Child Q 
```

单亲可以链接到多个孩子。然后查询将给出以下结果：

```
Parent Name    1st-Child   2nd-Child   3rd-Child  4th-Child  5th-Child  
Parent A       Child X     Child Y     Child Z
Parent B       Child Q 
```

这在 MS SQL 2008 中可行吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-16T20:12:46.513

假设您只需要列出 5 个孩子，则此查询将起作用：

```
with T as (
    select P.Name as ParentName,
           C.Name as ChildName,
           row_number() over (partition by P.ParentId order by C.ChildId) as N
    from ParentTable P join ChildTable C on P.ParentId = C.ParentId
) 
select ParentName,
    max(case when N = 1 then ChildName else '' end) as '1st-child',
    max(case when N = 2 then ChildName else '' end) as '2nd-child',
    max(case when N = 3 then ChildName else '' end) as '3rd-child',
    max(case when N = 4 then ChildName else '' end) as '4th-child',
    max(case when N = 5 then ChildName else '' end) as '5th-child'
from T
group by ParentName 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-18T21:09:23.540

`PIVOT`专为您的场景而设计。

```
SELECT * FROM
(
    SELECT [Parent] = P.Name,
        [Child] = C.Name, 
        [Field] = 'Child ' + LTRIM(STR(
        ROW_NUMBER() OVER (PARTITION BY C.ParentId ORDER BY C.ChildId)))
    FROM ChildTable C
    JOIN ParentTable P ON P.ParentId = C.ParentId
) A
PIVOT (MAX([Child])
       FOR [Field] IN ([Child 1], [Child 2], [Child 3], [Child 4], [Child 5])) B 
```

# django - 使用 django 模板呈现可变数量的文本字段/输入对

> ID：10180882
> 
> 赞同：1
> 
> 时间：2012-04-16T20:05:43.723
> 
> 标签：django, django-templates

我正在尝试使用 django (v 1.3) 模板呈现可变数量的字段名称/输入框。在我看来，我查找了一个表来获取列名，然后创建一个相同大小的 forms.CharFields() 列表，并将它们压缩在一起，如下所示：

```
ua_data = [forms.CharField(required=False) for i in range(len(ua_data_field_names))]
ua_fields = zip(ua_data_field_names, ua_data)
ua_field1 = forms.CharField(required=False) # temp field for testing 
```

所以在它的最后，上下文包含这样的东西（只有一个字段）：

```
>>> ua_fields
[(u'Test field', <django.forms.fields.CharField object at 0x108386b50>)] 
```

在我的模板中，我正在运行以下循环：

```
 {% for field in form.ua_fields %}
  <tr>
      <td>{{ field.0 }}</td>
      <td>{{ field.1 }} {{ field.1.errors }}</td>
      {#<td>{{ form.ua_field1 }} {{ form.ua_field1.errors }}</td>#}
  </tr>
  {% endfor %} 
```

这会在呈现的 HTML 中喷出以下内容：

```
Test field  <django.forms.fields.CharField object at 0x1081f1c50> 
```

而如果我将`<td>`上面的第二个与注释掉的行交换，我实际上会得到一个呈现的输入字段（ua_field1 是一个直接`forms.CharField`对象）

是什么阻止了列表查找字段进行神奇的 HTML 渲染？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-17T04:23:08.010

所渲染的`{{ form.field1 }}`不是同一个对象`form.fields['field1']`。它是特殊的 BoundField，它与一些数据绑定并准备渲染。

`field1`因此，您实际上应该在创建表单时使用...填充表单`fieldN`，然后`ua_fields()`将成对的 "'text_name', value of `self.__getitem__('fieldX')`"压缩在一起

# mysql - 什么时候在 MySQL 中使用关键字 INNER 和 OUTER？

> ID：10180883
> 
> 赞同：0
> 
> 时间：2012-04-16T20:05:45.813
> 
> 标签：mysql

我对 MySQL 还很陌生，我不了解**关键字** `INNER`和`OUTER`. 我理解它们的意思，但我不明白什么时候会在查询中实际输入关键字。似乎 a`JOIN`总是 an`INNER`并且 a `LEFT`or `RIGHT`join 总是`OUTER`。

因此，在哪些情况下会使用关键字而不是简单地编写`JOIN`(always `INNER`?) 和`LEFT JOIN`(always `OUTER`?)

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-16T20:12:49.863

除了为了清楚起见之外，使用`INNER`and关键字实际上没有任何功能上的原因。`OUTER`

此外，并不是真正的重复，但这个问题也涵盖了相同的基础：

[在 SQL 中编写左/右 JOIN 时是否使用 OUTER 关键字？](https://stackoverflow.com/questions/1741604/do-you-use-the-outer-keyword-when-writing-left-right-joins-in-sql)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-16T20:10:31.440

左外连接将显示第一个（左侧）定义的表的所有元素以及第二个表（右侧）中满足连接条件的元素。

如果未定义连接类型，则将其视为内连接。

一个很好的解释在这里：[http](http://en.wikipedia.org/wiki/Join_(SQL) ://en.wikipedia.org/wiki/Join_(SQL )

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-16T20:13:24.030

内部是更多的内部交集，外部是“不是”交集，看看这个链接： http: [//www.codeproject.com/Articles/33052/Visual-Representation-of-SQL-Joins](http://www.codeproject.com/Articles/33052/Visual-Representation-of-SQL-Joins)这里他们解释了内部和外，左，右等

# seo - SEO优化和DNS

> ID：10180891
> 
> 赞同：-1
> 
> 时间：2012-04-16T20:06:18.377
> 
> 标签：seo

我们正在创建一个网站，我们希望在其中对域名进行 SEO 优化。因此，当人们访问tutorsNewYork.com 时，他们应该会在我们的网站上看到所有与纽约相关的内容。如果他们访问utorBoston.com，他们应该会看到所有与波士顿相关的内容。我们如何使用 DNS 来实现这一点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-16T20:13:29.873

使用 DNS，您只能指定将处理您的请求的服务器。因此，这不是您要寻找的东西。

您可以将所有域指向同一服务器（甚至是目录），然后使用服务器端应用程序（例如 PHP），您可以决定要显示哪些内容。

```
<?php
  switch($_SERVER['SERVER_NAME']) {
    case "tutorsNewYork.com":
    case "www.tutorsNewYork.com":
      $query = "SELECT * FROM `tutors` WHERE `city` = 'NY';";
    break;
   case "tutorsNewYork.com":
   case "www.tutorsBoston.com":
     $query = "SELECT * FROM `tutors` WHERE `city` = 'Boston';";
   break;
 }
 ?> 
```

# .net - 如何使用 SMO 运行具有不同参数的 SQL 代理作业，而无需更改 JobStep 定义？

> ID：10180892
> 
> 赞同：0
> 
> 时间：2012-04-16T20:06:18.500
> 
> 标签：.net, sql-server-2008, ssis, smo, sql-server-agent

我有一些存储在 SQL Server 中并通过 SQL 代理作业公开的 SSIS 包

我编写了一个组件，允许我为包含 SSIS 包的作业步骤动态构建正确的命令行，它允许我使用 /SET 命令覆盖包变量

不幸的是，在 SMO 中，我需要执行以下操作：

```
jobStep.Command = MyNewComandString;
jobStep.Alter();
parentJob.Start(); 
```

这种方法的问题是它需要我调用 .Alter() 以使新命令行生效，这会更新 SQL Server 代理上的 JobStep 定义。如果我不调用 Alter() 而只是调用 Start() 那么它不会生效

这显然是一个 PITA，因为现在我需要担心“恢复”原始命令行......有什么方法可以将自定义命令字符串传递给 JobStep，让它执行而无需调用 Alter() 从而成为负责恢复原来的命令行？

顺便说一句 xp_cmdshell 不是一个选项

# android - 如何在 Android 中启用 A2DP 接收器功能？

> ID：10180895
> 
> 赞同：19
> 
> 时间：2012-04-16T20:06:22.113
> 
> 标签：android, android-ndk, bluetooth, a2dp

我正在开发一个使用*Gingerbread 2.3.4*作为操作系统的定制嵌入式设备。现在该设备应该能够播放来自其他支持**A2DP**的设备（例如 iPhone 或其他 Android 设备）的音频流。我知道 Gingerbread 包含`Bluez`堆栈 4.69，它具有 A2DP 接收器功能。但是，我怀疑 Android 是否公开了这些 API。

您对我如何实现此功能有任何想法吗？由于我不是在开发通用的 Android 应用程序，因此将不胜感激任何类型的非标准方法。我认为`Bluez`即使在Android中也可以通过DBus接口直接访问堆栈。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-27T09:03:23.537

Bluez 可以支持 A2DP 接收器。但 Android 框架不启用此配置文件。

您可以使用硬编码实践来实现蓝牙设备路径

# vb.net - vb.net threading.thread 传递变量的地址

> ID：10180898
> 
> 赞同：0
> 
> 时间：2012-04-16T20:06:32.367
> 
> 标签：vb.net, parameter-passing, addressof

我正在尝试将共享子中的 IP 呼叫中的某些状态传递给表单上的标签。

这是我正在使用的当前代码：

```
Class Server
    <STAThread()> Public Shared Sub Main()
        Dim aTcpMessaging As IMessagingSystemFactory = New TcpMessagingSystemFactory()
        Dim anInputChannel As IInputChannel = aTcpMessaging.CreateInputChannel(theIPforLocal & ":" & thePort)
        Dim aStringMessagesFactory As IStringMessagesFactory = New StringMessagesFactory()
        Dim aStringMessageReceiver As IStringMessageReceiver = aStringMessagesFactory.CreateStringMessageReceiver()
        AddHandler aStringMessageReceiver.MessageReceived, AddressOf StringMessageReceived

        aStringMessageReceiver.AttachInputChannel(anInputChannel)
    End Sub

    Private Shared Sub StringMessageReceived(ByVal sender As Object, ByVal e As StringMessageEventArgs)
        LANResponse = Convert.ToString(e.Message)
        Dim lanSent As String() = Nothing
        Dim sep(3) As Char
        Dim s As String = ""

        sep(0) = "~"
        'sep(1) = ","
        lanSent = LANResponse.Split(sep, 2)

        Dim a As New Threading.Thread(AddressOf getStatus)

        a.SetApartmentState(Threading.ApartmentState.STA)
        a.Start(Trim(lanSent(0)) & Trim(lanSent(1)))
  End Sub
End Class

Private Shared Sub getStatus(ByVal data As Object)
    lblStatus.text = ("Static: " & data)
End Sub 
```

它给我的错误是在**lblStatus.text = ("Static: " & data)**

> 错误 1 ​​如果没有类的显式实例，则无法从共享方法或共享成员初始化程序中引用类的实例成员。

任何帮助都会很棒！

大卫

**更新**

添加后：

```
Private Sub getStatus(ByVal data As Object)
    If InvokeRequired Then
        Invoke(New Action(Of Object)(AddressOf getStatus), data)
    Else
        lblStatus.Text = ("Static: " & data)
    End If
End Sub 
```

我收到此错误 no one line **Dim a As New Threading.Thread(AddressOf getStatus)**

> 错误 1 ​​重载解析失败，因为无法使用以下参数调用可访问的“New”：“Public Sub New(start As System.Threading.ParameterizedThreadStart)”：对非共享成员的引用需要对象引用。“Public Sub New(start As System.Threading.ThreadStart)”：方法“Private Sub getStatus(data As Object)”没有与委托“Delegate Sub ThreadStart()”兼容的签名。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-16T21:16:15.260

我注意到您正在尝试使用`Shared`成员来完成这项工作。这可能是有问题的，原因如下：

(1) 没有`Shared`，在幕后会创建一个引用变量，并调用它`Me`。`Me`可以通过，`lblStatus`比如`Me.lblStatus`，其实不一定需要放入`Me`，可以`lblStatus`自己指定。但是，即使它本身`Me`也隐含在其中，并且仍在使用。

(2) 有`Shared`，没有`Me`。如果没有`Me`，则`lblStatus`编译器无法识别实例 - 因此会出现错误。您将需要找到某种方法来传递对您的 Form 的引用，以便从中访问`lblStatus`。不过，我需要警告您，直接从主线程以外的线程更新标签或其他用户界面类被认为是不好的 - 这是因为 WinForms 不是线程安全的。从 .NET Framework 2 开始，如果您尝试，您会收到一个错误（尽管您可以选择退出此错误，但后果自负）。

这些是针对 C# 的，但它可能会给你一些关于如何继续的想法：

[如何从 C# 中的另一个线程更新 GUI？](https://stackoverflow.com/questions/661561/how-to-update-gui-from-another-thread-in-c)

[http://www.codeproject.com/Articles/23517/How-to-Properly-Handle-Cross-thread-Events-and-Upd](http://www.codeproject.com/Articles/23517/How-to-Properly-Handle-Cross-thread-Events-and-Upd)

所以第一步是让 getStatus 不是共享成员——这将带回`Me`.

第二步，将getStatus重新设计成线程安全的形式，用于获取文本到Label中，例如：

```
Private Sub getStatus(ByVal data As Object)
    If InvokeRequired Then
        Invoke(New Action(Of Object)(AddressOf getStatus), data)
    Else
        lblStatus.Text = ("Static: " & data)
    End If
End Sub 
```

第三步是找到某种方法来获取对表单的引用`Server`——可能是通过共享的 ArrayList？或者只是对表单的一些共享引用？

第四步是对 StringMessageReceived 的重新设计，因此该`AddressOf`部分现在是`AddressOf refToMyForm.getStatus`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-05-17T18:06:04.373

您需要为您的案例使用委托示例：

```
Public Delegate Sub AddLabelTextDelegate(ByVal label As LabelControl, ByVal value As String)

Public Sub AddLabelText(ByVal label As LabelControl, ByVal value As String)
    label.Text = value
End Sub 
```

然后从您需要调用的其他线程：

```
 Me.lblStatus.Invoke(New AddLabelTextDelegate(AddressOf AddLabelText), New Object(){lblStatus, "Value"}) 
```

# wordpress - 在 wordpress 中显示最近的搜索词

> ID：10180900
> 
> 赞同：0
> 
> 时间：2012-04-16T20:06:38.760
> 
> 标签：wordpress, search

有没有办法显示在我的网站上完成的最新搜索词？我想显示我的访问者完成的最后 3-5 个搜索词，以便鼓励其他用户也搜索某些内容。

**编辑：**在这种情况下，如果有人搜索了新内容，刷新页面可能会显示一组新的搜索词。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-16T22:27:59.650

我相信至少有一些插件可以帮助你。

我会推荐[最近搜索小部件](http://wordpress.org/extend/plugins/recent-searches-widget/)，它是一个获得很多好评的插件。它允许您将一个小部件添加到您的侧边栏（或任何地方），以显示您网站上使用的最新搜索词。我不相信它会显示在激活之前进行的任何搜索，但是一旦安装并激活它，它将跟踪所做的每个搜索。

# c# - 自定义类中的 LINQ 匿名类型到 ObservableCollection

> ID：10180903
> 
> 赞同：1
> 
> 时间：2012-04-16T20:06:51.473
> 
> 标签：c#, wpf, linq, observablecollection

我正在努力将返回匿名类型的 LINQ 语句转换为带有自定义类的 ObservableCollection，我对 LINQ 语句和类定义感到满意，问题（我认为）与我如何实现我的匿名类型和类本身之间的 IQueryable 接口。

```
public class CatSummary : INotifyPropertyChanged
{
    private string _catName;
    public string CatName
    {
        get { return _catName; }
        set { if (_catName != value) { _catName = value; NotifyPropertyChanged("CatName"); } }
    }

    private string _catAmount;
    public string CatAmount
    {
        get { return _catAmount; }
        set { if (_catAmount != value) { _catAmount = value; NotifyPropertyChanged("CatAmount"); } }
    }

    public event PropertyChangedEventHandler PropertyChanged;

    // Used to notify Silverlight that a property has changed.
    private void NotifyPropertyChanged(string propertyName)
    {
        if (PropertyChanged != null)
        {
            PropertyChanged(this, new PropertyChangedEventArgs(propertyName));

            //MessageBox.Show("NotifyPropertyChanged: " + propertyName);

        }
    }

}

private void GetCategoryAmounts()
{
    var myOC = new ObservableCollection<CatSummary>();

    var myQuery = BoughtItemDB.BoughtItems
                        .GroupBy(item => item.ItemCategory)
                        .Select(g => new 
                        { 
                            _catName = g.Key, 
                            _catAmount = g.Sum(x => x.ItemAmount)
                        });

    foreach (var item in myQuery) myOC.Add(item);
} 
```

我得到的错误在最后一行，是
`"Argument 1: cannot convert from 'AnonymousType#1' to 'CatSummary'"`

我对 c# 比较陌生，需要指出正确的方向——如果有人有任何关于这类事情的教程也会有所帮助。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-16T20:11:16.243

这是因为您创建的匿名对象与 没有类型关系`CatSummary`。如果你想将这些项目添加到你的 ObservableCollection 中，你需要`CatSummary`像这样构造一个：

```
BoughtItemDB.BoughtItems.GroupBy(item => item.Category)
       .Select(x => new CatSummary
       {
           CatName = x.Key,
           CatAmount = x.Sum(amt => amt.ItemAmount)
       }); 
```

这样，您的查询将创建一个`IEnumerable<CatSummary>`而不是`IEnumerable<a'>`. 与其他语言及其鸭子类型不同，仅仅因为您新创建的匿名对象具有 CatName 和 CatAmount 属性并不意味着它可以代表实际类型。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-16T20:12:05.027

`new { ...`您可以选择一个 CatSummary 实例，而不是选择一个匿名类型`new CatSummary(...`（或任何其他可用的构造 CatSummary 实例的方法）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-16T20:15:36.447

尝试这个：

```
 foreach (var item in myQuery) 
 {
     // You will need to create a new constructor
     var catsummary = new CatSummary(item.CatName, item.CatAmount);
     myOC.Add(catsummary); 
  } 
```

# html - 如何使菜单居中？CSS

> ID：10180904
> 
> 赞同：0
> 
> 时间：2012-04-16T20:07:00.863
> 
> 标签：html, css, menu

如何使菜单居中？我还想在鼠标放在菜单按钮上时改变颜色吗？谢谢你的帮助。

```
 div.menu {
    list-style:none;
    margin:20px;
    padding:0;
    width:100% }
 div.menu ul{
    font-family: Verdana;
    font-size:14px;
    margin:0 auto;
    padding:0;}
    div.menu li{
    display:inline; }
 div.menu li a{
    text-decoration:none;
    padding:5px 0;
    width:100px;
    background:#FBB117;
    color:#4C4646;
    float:left;
    text-align:center;
    border-left:1px solid #fff; }

 div.menu lia:hover{
    background:#a2b3a1;
    color:#000 } 
```

我工作得很好，但我改变了一些东西，它不再在中心了。有点偏左。我找不到问题所在。能否请你帮忙？

```
 div.menu {
    list-style:none; 
    margin:0; 
    padding:0; 
    width:100%;
    text-align:center;} 
div.menu ul{
    font-family: Verdana;
    font-size:14px;
    margin:20px;
    padding:0;
    display:inline-block;}
 div.menu li{
    display:inline;}
 div.menu li a{
    text-decoration:none;
    padding:5px 0;
    width:100px;
    background:#FBB117;
    color:#4C4646;
    float:left;
    text-align:center;
    border-left:1px solid #fff; }
 div.menu li a:hover{
    background:#a2b3a1;
    color:#000 } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-16T20:15:22.180

就像在[这个示例小提琴](http://jsfiddle.net/c86dZ/)中一样。

1.  `text-align:center`在 div 和列表上居中菜单`display:inline-block`，并将 20px 边距从 div 移动到列表。
2.  要在悬停时更改颜色：在`li`和之间添加一个空格`a`。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-16T20:17:28.863

看看这些文章。他们有你需要的一切：

*   [http://matthewjamestaylor.com/blog/beautiful-css-centered-menus-no-hacks-full-cross-browser-support](http://matthewjamestaylor.com/blog/beautiful-css-centered-menus-no-hacks-full-cross-browser-support)

或者

*   [http://matthewjamestaylor.com/blog/centered-dropdown-menus](http://matthewjamestaylor.com/blog/centered-dropdown-menus)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-16T20:10:06.310

要使任何 div 居中，您必须使用绝对位置和相对位置，或者以 px、em 或英寸为单位指定宽度，然后使用另一个 div 并使用 %。你可以说得更详细点吗？？？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-16T20:29:10.733

试试这个三个链接（33.3% 宽度）：[示例](http://jsfiddle.net/u5y8w/)

```
.menu {
    list-style:none;
    margin:0 auto;
    padding:0;
    width:100%;
}

.menu ul {
    font-family:Verdana;
    font-size:14px;
    padding:0;
    width:100%;
}

.menu li {
    float:left;
    width:33.3%; 
}

.menu a {
    text-decoration:none;
    background:#FBB117;
    color:#4C4646;
    float:left;
    width:100%;
    height:100%;
    text-align:center;
    border-left:1px solid #fff; 
}

.menu a:hover {
    background:#a2b3a1;
    color:#000; 
} 
```

*   你不需要在这些样式之前使用“div”选择器，所以我把它们去掉了。
*   div.menu **lia** :hover 有错字，应该是**li a** :hover{}

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-04-16T20:08:05.320

浮动带有自动边距的菜单。

使用 onmouseover 事件更改按钮的颜色。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-04-16T20:17:33.247

大约一年前，我整理了一些 CSS，我几乎可以在我从事的每个项目中使用它……随意使用它。要使用它，您需要做的就是像这样设置列表的样式：

```
<ul id="mylist" class="linearlist center"><li>Link or something</li></ul> 
```

这将允许您非常轻松地居中对齐菜单，而无需使用浮动和处理折叠容器问题。样式类有几个选项 - 中心、左侧、右侧、分隔符、内部、外部。玩一玩。只要确保 (a) 你给它一个类“linearlist”并确保 HTML 中没有空格是一些浏览器呈现它。

```
/*************************************
FLAT LIST LAYOUT

    This can be called into use using the following classes:

            required        : linearlist
            select either   : centre / left / right
            optional        : separators
            outers / inners : adds or removes outermost borders

    Example usage:

            eg 1:  <ul class="linearlist right separators">
            eg 2:  <ul class="linearlist centre separators">
            eg 3:  <ul class="linearlist left">

    Support:
            IE6 :   :first-child and :last-child pseudoclasses are not supported
                    .inners and .outers will not work
            IE7 :   :last-child pseudoclass is not supported
                    .outers will not work but .inners will
            Note browser-sniffing is required to make list items full height in IE6 and IE7

    Remember - you will need to remove whitespace between list items for true rendering.

*************************************/
ul.linearlist, .linearlist ul          {list-style-type: none; padding: 0; margin: 0;}
ul.linearlist li,.linearlist ul li     {display: inline-block; padding: 0; margin: 0;}
*ul.linearlist li,*.linearlist ul li   {display: inline !important;}
ul.linearlist li a,.linearlist ul li a {display: inline-block;}

ul.separators li,.separators ul li                         {border-left-width: 1px; border-left-style: solid;}
ul.inners li:first-child,.inners ul li:first-child {border-left-width: 0;} /* removes border from left-most list item  */
ul.outers,.outers ul {border-right-width: 1px; border-right-style: solid;} /* adds border to right-most list item  */

ul.centre,ul.center,.centre ul,.center ul {text-align: center;}
ul.left,.left ul                          {text-align: left;}
ul.right,.right ul                        {text-align: right;} 
```

哦，是的，你的 CSS 中有一个小错字会阻止鼠标悬停时的颜色变化......你的最后一个声明应该是

```
div.menu li a:hover{
    background:#a2b3a1;
    color:#000 } 
```

但是，您可以稍微简化它，因为嵌套这么多选择器是不好的做法……试试这个：

```
.menu a:hover{
    background:#a2b3a1;
    color:#000 } 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-04-16T20:18:46.233

看看这个 JS Fiddle

[http://jsfiddle.net/7zk8E/](http://jsfiddle.net/7zk8E/)

通过将 text-align:center 应用于外部 div（您称为其类菜单），您可以使菜单居中。我还将`.menu ul`显示属性更改为内联块，因为内联元素没有任何填充或边距。

你的悬停不起作用的原因是你的 CSS 有一个错字`div.menu lia:hover`

它应该是`div.menu li a:hover`

# java - 如何找出我的 android 2.3 应用程序正在使用的堆内存量？

> ID：10180909
> 
> 赞同：1
> 
> 时间：2012-04-16T20:07:36.287
> 
> 标签：java, android, heap-memory

我为 android 2.3.4 制作了一个 java 应用程序，想知道它使用了多少可用堆内存。

原因是 dalvik vm 有一个堆大小限制，在我当前的设备上该限制是 32mb，但我也想在堆大小仅为 16mb 的设备上运行它，并且需要确定我是否必须制作内存优化。

如何找出当前使用了多少堆大小？

* * *

编辑：我确实在这里找到了一些有用的指针（在答案的帮助下）：

[http://android-developers.blogspot.jp/2011/03/memory-analysis-for-android.html](http://android-developers.blogspot.jp/2011/03/memory-analysis-for-android.html)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-16T20:13:29.283

DDMS 支持跟踪堆大小。[在“查看进程的堆使用情况”下查看](http://developer.android.com/guide/developing/debugging/ddms.html)此处

# regex - 在flex和bison中解析函数作为参数的函数

> ID：10180911
> 
> 赞同：0
> 
> 时间：2012-04-16T20:07:38.887
> 
> 标签：regex, parsing, bison, flex-lexer

我一直在网上查看 flex 和 bison 教程，试图通过它们都使用非常简单的示例来解决我的问题，而我的则更复杂。我需要解析一个可能包含如下输入的文件：

```
f(x,g(x)) 
```

这些函数也可以有任意数量的参数。

问题是我需要 f 和 g 都被解析器视为函数，而不是 f 作为函数，g 作为 x 的参数。换句话说，我需要如下所示的输出：

```
[f,x,[g,x]] 
```

不喜欢：

```
[f, x, g(x)] 
```

有人可以告诉我如何最好地做到这一点并可能提供正则表达式（因为我对他们不太擅长）？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-16T20:26:35.513

在词法 (flex) 级别，您将识别四个标记作为标识符：f、x、g 和 x。在语法 (bison) 级别，您会将 g(x) 和 f(x, g(x)) 识别为表达式。非常示意性：

```
expression -> numeric-literal | 
              identifier |
              identifier left-parenthesis arguments right-parenthesis

arguments -> argument | 
             argument comma arguments

argument -> expression 
```

这个小例子将让您了解识别标记和解析之间的区别。

您还可以将参数解析为：

```
arguments -> argument | 
             arguments comma argument 
```

两者之间存在一些细微的差异，这可能与您的问题相关，也可能不相关。

在词法级别识别标识符的正则表达式是任何你喜欢的。也许

```
[a-zA-Z][a-zA-Z0-9]* 
```

换句话说，一个字母后跟可选的数字和字母。

一本好书是 John Levine 的**lex & yacc**。我没有使用过他的**flex & bison，**但我会根据早期书籍的优势推荐它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-17T02:31:10.220

如果它很简单，可能是递归正则表达式（这是在 Perl 中）。我敢肯定，使用彻底完成它的语言解析器可以更好地处理它。

```
$str = 'some stuff  F( g(x), tx, , 44, Y(hh()) , 99, b())';

$open      = '\b\w+\s*';

$regex = qr~
  (                                                 # 1
     ($open)                                        # 2
     [(]
        (                                           # 3                       
           (?:  (?> (?: (?!$open[(] | [)] ) . )+ ) 
              | (?1)                                         
           )*                                               
        )                                                   
     [)]
   )                                                 
~xs;

print "Before:  ", $str, "\n";
print "After:   ", parse_func ( $str ), "\n";

###
sub parse_func {
  my ($core) = @_;
  $core =~ s/$regex/ "[$2," . (parse_func( $3 )) . "]" /eg;
  return $core;
} 
```

输出

```
Before:  some stuff  F( g(x), tx, , 44, Y(hh()) , 99, b())
After:   some stuff  [F, [g,x], tx, , 44, [Y,[hh,]] , 99, [b,]] 
```

# makefile - Makefile 中是否可能依赖符号链接？

> ID：10180912
> 
> 赞同：8
> 
> 时间：2012-04-16T20:07:40.223
> 
> 标签：makefile, gnu-make, symlink

我的项目中需要几个符号链接。

来自`src/openlayers`, 文件夹`img`并且`theme`必须在`contrib/openlayers`. 该`contrib/openlayers`文件夹也应该自动创建。

```
.PHONY: run
run: contrib/openlayers/theme contrib/openlayers/img
   ../bin/pserve development.ini --reload

contrib/openlayers/theme:
    ln -s src/openlayers/theme $@

contrib/openlayers/img:
    ln -s src/openlayers/img $@ 
```

但是这个规则每次都尝试创建符号链接。（我把`-f`标志放到`ln`，所以它每次都重新创建符号链接。）

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2013-10-02T13:32:49.947

万一您遇到了这个问题，尽管您的符号链接正确指向现有文件：还要记住，“make”查看符号链接目标文件的 mtime，而*不是*符号链接的 mtime本身。

因此，如果调用“ln -s”的规则有任何比符号链接指向的文件*更新*的依赖项，那么“make”每次都必须重新运行该规则中的命令。它将一次又一次地这样做，因为创建指向文件的符号链接不会更新该文件的 mtime。

您可以使用“touch”命令来确保您的链接目标的 mtime 比您的依赖项更新。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-16T21:21:17.807

当然，这可以工作。Make 将所有内容都视为文件，包括符号链接。它将检查文件是否存在（由于您没有列出任何先决条件，因此没有时间戳比较）。在符号链接的情况下，它实际上是在检查链接指向的任何内容，当然，不是链接本身。

您没有显示执行此操作时会发生什么，但根据您的描述，正在发生两件事之一：（a）contrib/openlayers 目录不存在，因此 ln 命令生成错误而不是创建符号链接所以当然，make 会在下次运行时尝试重新创建它，或者 (b) 您的符号链接创建不正确并且指向任何内容，这意味着当 make 尝试查看它是否存在时失败并且 make 将尝试重新创建它。

例如，如果您的`src`目录是您的目录的兄弟`contrib`，那么您的符号链接就是错误的；你会得到：

```
contrib/openlayers/theme -> src/openlayers/theme 
```

或者，当内核尝试解决它时：

```
contrib/openlayers/src/openlayers/theme 
```

这不太可能是你想要的。我建议你使用这样的东西：

```
contrib/openlayers/theme:
        mkdir -p contrib/openlayers
        ln -s ../../src/openlayers/theme contrib/openlayers/theme 
```

然后验证符号链接在创建后是否实际指向您希望它去的位置。

# python - 使用 python urllib2 和正则表达式来获取类似的命名远程文件

> ID：10180914
> 
> 赞同：0
> 
> 时间：2012-04-16T20:07:53.917
> 
> 标签：python, urllib2

我正在尝试从具有以下名称模式的远程文件下载每日文件转储：`somename.yyyymmdd_HHmm.zip`. `yyyymmdd`是 4 位数的年份、2 位数的月份和 2 位数的日期，HH 是 2 位数的小时，最后一个 mm 是 2 位数的分钟。如果文件是今天生成的，它可能是`somename.20120416_0423.zip`. '_0423' 也可能是 0412'，这取决于它是在凌晨 4:23 还是凌晨 4:12 完成倾倒。

我的问题是，如果知道我们上面知道的内容，如何使用正则表达式下载这个文件？或者，还有更好的方法？

```
import urllib2

ref = regexedFilename # this would be the (sort of) unknown file name
f = urllib2.openfile(ref) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-16T20:09:27.497

除非您想使用蛮力找出文件名，否则在远程站点上没有目录列表是不可能的。

如果目录列表可用，请打开目录索引页面，例如使用 BeautifulSoup 解析它，提取文件列表，然后使用您的正则表达式查找与您正在寻找的格式匹配的文件。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-16T22:10:33.013

假设您可以看到目录列表，并且无论如何您都必须使用正则表达式，那么没有理由在 BeautifulSoup 上浪费您的时间。

```
import re
file_list = re.findall('.*?\.(\d+)_(\d+)\.zip', directory_page_text)
sorted_file_list = sorted(file_list, key=lambda x: (x[0], x[1])) 
```

当然，这可能需要根据目录列表的实际输出进行调整。

# php - 对谷歌翻译 API 的多个请求使网站太慢

> ID：10180916
> 
> 赞同：0
> 
> 时间：2012-04-16T20:08:00.427
> 
> 标签：php, google-api, google-translator-toolkit

我正在使用谷歌翻译 API 在一些网站上翻译我的网站：

我这样做：

```
function translate($from_lan, $to_lan, $text){
    $json = json_decode(file_get_contents('https://ajax.googleapis.com/ajax/services/language/translate?v=1.0&q=' . urlencode($text) . '&langpair=' . $from_lan . '|' . $to_lan));
    $translated_text = $json->responseData->translatedText;

    return $translated_text;
} 
```

如前所述[，使用谷歌翻译 API 翻译 PHP $string](https://stackoverflow.com/questions/4640378/translate-a-php-string-using-google-translator-api)

Wich 工作正常（不要关注翻译质量），问题是大约 20/30 的请求（或更多）会使网站无法使用.. 太慢了。如果你想检查就去

[http://funcook.com/](http://funcook.com/)并用法语测试[http://funcook.com/?lan=3](http://funcook.com/?lan=3)或德语 [http://funcook.com/?lan=4](http://funcook.com/?lan=4)

我还尝试循环我网站的所有字符串，翻译它们并保存翻译后的字符串，这样我就不需要多次请求，

但他们大约是 300 并且在这个过程中失败了（大约 50%）我猜是因为延迟

所以问题是：¿更好的选择？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-16T20:37:33.817

没有更好的选择。**您需要做的是缓存您从谷歌翻译获得的结果，**而不是每次都从谷歌翻译加载。将翻译写入文件或数据库并从那里加载它们。如果关键字不存在，请从谷歌翻译中询问。如果您认为翻译及时更改，则不时刷新/重置缓存。

永远不要在没有缓存的情况下向外部服务发出多个请求。您基本上是在浪费自己的资源，并且最终可能会被 Google 屏蔽。

# tomcat6 - 在 STS 2.9.1 上安装 Tomcat 6

> ID：10180924
> 
> 赞同：1
> 
> 时间：2012-04-16T20:08:43.910
> 
> 标签：tomcat6, sts-springsourcetoolsuite

我在 Ubuntu 11.10 上运行的 SpringSource 工具套件 (STS) 下安装 Tomcat 6 时遇到困难。当我尝试使用 STS 安装 Tomcat 6 时，服务器似乎安装正确（我可以将 Tomcat 6 视为服务器），当我从 STS 运行 Tomcat 6 时，控制台显示它正在正确启动。

但是，我无法在该服务器上运行我的 grails 应用程序，因为尽管该服务器在服务器窗格中可用并且可以从该窗格启动，但该服务器并未作为选项显示。另一个奇怪的是，当我从服务器窗格运行服务器并且可以从控制台看到它在端口 8080 上运行时，我无法调出默认的 tomcat 根目录。Tomcat 正在运行，但它正在其他地方寻找战争（在 /target ？？？）。

然后我尝试安装一个本地的 tomcat 实例并让 STS 使用它。我跑了：

sudo apt-get install tomcat6-user tomcat6-instance-create ~/tomcat6

然后尝试通过指向 ~/tomcat6 将服务器添加到 STS。在这种情况下，STS 甚至无法识别服务器以将其放入可用于运行我的 grails 应用程序的服务器列表中。

有人对此有任何想法吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-16T20:47:27.423

您需要将 Dynamic Web Module facet 添加到您的项目中才能看到 Run on Server 选项。为此，右键单击项目 -> 属性 -> 项目构面 -> 检查动态 Web 模块。

如果您在 Eclipse/STS 等 IDE 中安装 Tomcat，那么您将无法看到默认的 Tomcat 主页为“C:\workspace\.metadata\.plugins\org.eclipse.wst.server.core\tmp0\ wtpwebapps\ROOT" 没有欢迎页面。与独立的 tomcat 7 安装相比，“C:\tomcat7\webapps\ROOT”中有 index.jsp。

因此，您始终需要在 Web 应用程序中指向您自己的页面，例如“http://localhost:8080/MyWebApp/index.jsp”

[更新] 根据评论

将安装位置 JRE 更改为“/usr/lib/jvm/java-6-openjdk”。这应该足够了，不需要安装Oracle Java。为此，请转到 Window->Preferences->Java->Installed JREs -> Add。

更多信息[在这里](https://help.ubuntu.com/community/EclipseIDE#No_Java_Virtual_Machine_found)

# asp.net-mvc-4 - 当 AuthorizeAttribute 与角色一起应用时，自定义 RoleProvider 失败

> ID：10180925
> 
> 赞同：2
> 
> 时间：2012-04-16T20:08:45.147
> 
> 标签：asp.net-mvc-4, acs

我在 ASP.net MVC4 中遇到了自定义角色提供程序的问题。我实现了一个非常轻量级的 RoleProvider，它在我改变之前似乎工作正常

```
[Authorize]
public class BlahController:....
} 
```

到

```
[Authorize(Roles="Administrator")]
public class BlahController:....
} 
```

一旦我进行了更改，用户就不再经过身份验证，并且出现 401 错误。这很奇怪，因为我的 RoleProvider 基本上为 IsUSerInRole 返回 true，并且为 GetUserRoles 返回一个包含“Administrator”的列表。我在自定义 RoleProvider 中的每个方法上都设置了断点，但发现没有一个被调用。

接下来我实现了我自己的从 AuthorizeAttribute 继承的授权属性。在这我设置了断点，这样我就可以看到发生了什么。事实证明，底层属性调用的 User.IsInRole() 返回 false。

我相信角色提供者已正确设置。我的配置文件中有这个

```
<roleManager enabled="true" defaultProvider="SimplicityRoleProvider">
  <providers>
    <clear />
    <add name="SimplicityRoleProvider" type="Simplicity.Authentication.SimplicityRoleProvider" applicationName="Simplicity" />
  </providers>
</roleManager> 
```

并使用此处描述的方法检查哪个角色提供者是当前角色提供者：[参考当前 RoleProvider 实例？](https://stackoverflow.com/questions/4976215/reference-current-roleprovider-instance)产生正确的结果。但是 User.IsInRole 坚持返回 false。

我正在使用 Azure 访问控制服务，但我看不出这与自定义角色提供程序有何不兼容。

我可以做些什么来更正 IPrincipal 用户，以便 IsInRole 从我的自定义 RoleProvider 返回值？

* * *

角色提供者来源：

公共类 SimplicityRoleProvider : RoleProvider { private ILog log { get; 放; }

```
 public SimplicityRoleProvider()
    {
        log = LogManager.GetLogger("ff");
    }        

    public override void AddUsersToRoles(string[] usernames, string[] roleNames)
    {
        log.Warn(usernames);
        log.Warn(roleNames);
    }

    public override string ApplicationName
    {
        get
        {
            return "Simplicity";
        }
        set
        {

        }
    }

    public override void CreateRole(string roleName)
    {

    }

    public override bool DeleteRole(string roleName, bool throwOnPopulatedRole)
    {
        return true;
    }

    public override string[] FindUsersInRole(string roleName, string usernameToMatch)
    {
        log.Warn(roleName);
        log.Warn(usernameToMatch);
        return new string[0];
    }

    public override string[] GetAllRoles()
    {
        log.Warn("all roles");
        return new string[0];
    }

    public override string[] GetRolesForUser(string username)
    {
        log.Warn(username);
        return new String[] { "Administrator" };
    }

    public override string[] GetUsersInRole(string roleName)
    {
        log.Warn(roleName);
        return new string[0];
    }

    public override bool IsUserInRole(string username, string roleName)
    {
        log.Warn(username);
        log.Warn(roleName);
        return true;
    }

    public override void RemoveUsersFromRoles(string[] usernames, string[] roleNames)
    {

    }

    public override bool RoleExists(string roleName)
    {
        log.Warn(roleName);
        return true;
    }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-12T04:58:40.873

当您有自定义 AuthorizeAttribute 和自定义 RoleProvider 时，似乎 System.Web.Security.Roles.GetRolesForUser(Username) 不会自动连接。

因此，在您的自定义 AuthorizeAttribute 中，您需要从数据源中检索角色列表，然后将它们与作为参数传入 AuthorizeAttribute 的角色进行比较。

我在一些博客文章中看到暗示手动比较角色是不必要的，但是当我们覆盖 AuthorizeAttribute 时，似乎我们正在抑制这种行为并且需要自己提供它。

* * *

无论如何，我将介绍对我有用的方法。希望它会有所帮助。

我欢迎就是否有更好的方法来实现这一点发表评论。

请注意，在我的情况下， AuthorizeAttribute 被应用于 ApiController 尽管我不确定这是一条相关的信息。

```
 public class RequestHashAuthorizeAttribute : AuthorizeAttribute
    {
        bool requireSsl = true;

        public bool RequireSsl
        {
            get { return requireSsl; }
            set { requireSsl = value; }
        }

        bool requireAuthentication = true;

        public bool RequireAuthentication
        {
            get { return requireAuthentication; }
            set { requireAuthentication = value; }
        }

        public override void OnAuthorization(System.Web.Http.Controllers.HttpActionContext ActionContext)
        {
            if (Authenticate(ActionContext) || !RequireAuthentication)
            {
                return;
            }
            else
            {
                HandleUnauthorizedRequest(ActionContext);
            }
        }

        protected override void HandleUnauthorizedRequest(HttpActionContext ActionContext)
        {
            var challengeMessage = new System.Net.Http.HttpResponseMessage(HttpStatusCode.Unauthorized);
            challengeMessage.Headers.Add("WWW-Authenticate", "Basic");
            throw new HttpResponseException(challengeMessage);
        }

        private bool Authenticate(System.Web.Http.Controllers.HttpActionContext ActionContext)
        {
            if (RequireSsl && !HttpContext.Current.Request.IsSecureConnection && !HttpContext.Current.Request.IsLocal)
            {
                //TODO: Return false to require SSL in production - disabled for testing before cert is purchased
                //return false;
            }

            if (!HttpContext.Current.Request.Headers.AllKeys.Contains("Authorization")) return false;

            string authHeader = HttpContext.Current.Request.Headers["Authorization"];

            IPrincipal principal;
            if (TryGetPrincipal(authHeader, out principal))
            {
                HttpContext.Current.User = principal;
                return true;
            }
            return false;
        }

        private bool TryGetPrincipal(string AuthHeader, out IPrincipal Principal)
        {
            var creds = ParseAuthHeader(AuthHeader);
            if (creds != null)
            {
                if (TryGetPrincipal(creds[0], creds[1], creds[2], out Principal)) return true;
            }

            Principal = null;
            return false;
        }

        private string[] ParseAuthHeader(string authHeader)
        {
            if (authHeader == null || authHeader.Length == 0 || !authHeader.StartsWith("Basic")) return null;

            string base64Credentials = authHeader.Substring(6);
            string[] credentials = Encoding.ASCII.GetString(Convert.FromBase64String(base64Credentials)).Split(new char[] { ':' });

            if (credentials.Length != 3 || string.IsNullOrEmpty(credentials[0]) || string.IsNullOrEmpty(credentials[1]) || string.IsNullOrEmpty(credentials[2])) return null;

            return credentials;
        }

        private bool TryGetPrincipal(string Username, string ApiKey, string RequestHash, out IPrincipal Principal)
        {
            Username = Username.Trim();
            ApiKey = ApiKey.Trim();
            RequestHash = RequestHash.Trim();

            //is valid username?
            IUserRepository userRepository = new UserRepository();
            UserModel user = null;
            try
            {
                user = userRepository.GetUserByUsername(Username);
            }
            catch (UserNotFoundException)
            {
                throw new HttpResponseException(new HttpResponseMessage(HttpStatusCode.Unauthorized));
            }

            //is valid apikey?
            IApiRepository apiRepository = new ApiRepository();
            ApiModel api = null;
            try
            {
                api = apiRepository.GetApi(new Guid(ApiKey));
            }
            catch (ApiNotFoundException)
            {
                throw new HttpResponseException(new HttpResponseMessage(HttpStatusCode.Unauthorized));
            }

            if (user != null)
            {
                //check if in allowed role
                bool isAllowedRole = false;
                string[] userRoles = System.Web.Security.Roles.GetRolesForUser(user.Username);
                string[] allowedRoles = Roles.Split(',');  //Roles is the inherited AuthorizeAttribute.Roles member
                foreach(string userRole in userRoles)
                {
                    foreach (string allowedRole in allowedRoles)
                    {
                        if (userRole == allowedRole)
                        {
                            isAllowedRole = true;
                        }
                    }
                }

                if (!isAllowedRole)
                {
                    throw new HttpResponseException(new HttpResponseMessage(HttpStatusCode.Unauthorized));
                }

                Principal = new GenericPrincipal(new GenericIdentity(user.Username), userRoles);                
                Thread.CurrentPrincipal = Principal;

                return true;
            }
            else
            {
                Principal = null;
                throw new HttpResponseException(new HttpResponseMessage(HttpStatusCode.Unauthorized));
            }
        }
    } 
```

自定义授权属性管理以下控制器：

```
public class RequestKeyAuthorizeTestController : ApiController
{
    [RequestKeyAuthorizeAttribute(Roles="Admin,Bob,Administrator,Clue")]
    public HttpResponseMessage Get()
    {
        return Request.CreateResponse(HttpStatusCode.OK, "RequestKeyAuthorizeTestController");
    }
} 
```

在自定义 RoleProvider 中，我有这个方法：

```
public override string[] GetRolesForUser(string Username)
{
    IRoleRepository roleRepository = new RoleRepository();
    RoleModel[] roleModels = roleRepository.GetRolesForUser(Username);

    List<string> roles = new List<string>();

    foreach (RoleModel roleModel in roleModels)
    {
        roles.Add(roleModel.Name);
    }

    return roles.ToArray<string>();
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-18T07:59:28.097

所以问题不在于你如何实现角色提供者，而在于你如何配置你的应用程序来使用它。不过，我在您的配置中找不到任何问题。请确保这确实是您配置应用程序的方式。这篇文章可能会有所帮助：[http](http://brianlegg.com/post/2011/05/09/Implementing-your-own-RoleProvider-and-MembershipProvider-in-MVC-3.aspx) ://brianlegg.com/post/2011/05/09/Implementing-your-own-RoleProvider-and-MembershipProvider-in-MVC-3.aspx 。如果您使用默认的 MVC 模板创建项目，请检查 AccountController。根据该帖子，您可能需要进行一些修改才能使自定义会员提供程序正常工作。但这不会影响角色提供者。

最好的祝福，

明旭。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-02-24T17:28:50.100

我不喜欢自定义授权属性，因为我必须提醒人们使用它。我选择实现我自己的`IIdentity`/`IPrincipal`类并在授权时将其连接起来。

`UserIdentity`调用默认值的自定义`RoleProvider`：

```
public class UserIdentity : IIdentity, IPrincipal
{
    private readonly IPrincipal _original;

    public UserIdentity(IPrincipal original){
        _original = original;
    }

    public string UserId
    {
        get
        {
            return _original.Identity.Name;
        }
    }

    public string AuthenticationType
    {
        get
        {
            return _original.Identity.AuthenticationType;
        }
    }

    public bool IsAuthenticated
    {
        get
        {
            return _original.Identity.IsAuthenticated;
        }
    }

    public string Name
    {
        get
        {
            return _original.Identity.Name;
        }
    }

    public IIdentity Identity
    {
        get
        {
            return this;
        }
    }

    public bool IsInRole(string role){
        return Roles.IsUserInRole(role);
    }
} 
```

并将其添加到 global.asax.cs：

```
void Application_PostAuthenticateRequest(object sender, EventArgs e)
{                                   
    if(false == HttpContext.Current.User is UserIdentity){
        HttpContext.Current.User = new UserIdentity(HttpContext.Current.User);
    }
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2016-07-06T12:27:50.927

在他的评论中`stimms`写道：“我看到的是 IPrincipal 似乎没有设置正确的 RoleProvider”让我看到了我的自定义身份验证属性的实现，该属性继承自`Attribute`and `IAuthenticationFilter`。

```
using System.Web.Security;

....

protected override async Task<IPrincipal> AuthenticateAsync(string userName, string password, CancellationToken cancellationToken)
{
    if (string.IsNullOrWhiteSpace(userName) || string.IsNullOrWhiteSpace(password))
    {
        // No user with userName/password exists.
        return null;
    }

    var membershipProvider = Membership.Providers["CustomMembershipProvider"];
    if (membershipProvider != null && membershipProvider.ValidateUser(userName, password))
    {
         ClaimsIdentity identity = new GenericIdentity(userName, "Basic");
         return new RolePrincipal("CustomRoleProvider", identity);
    }

    return null;           
} 
```

关键在于返回`RolePrincipal`，它指向您的自定义角色提供者。

最初我返回`new ClaimsPrincipal(identity)`了，这给了我在 OP 中描述的问题。

# validation - Backbone.js 模型验证方法

> ID：10180927
> 
> 赞同：0
> 
> 时间：2012-04-16T20:08:46.993
> 
> 标签：validation, backbone.js

如何仅验证模型上的某些属性？目前我检查传递给验证的对象中是否存在该属性：

```
validate: function(attrs) {

        // Number
        if (attrs.minimum) {
          if (isNaN(attrs.minimum)) {
            return -1;
          }
        }
        if (attrs.maximum) {
          if (isNaN(attrs.maximum)) {
            return -1;
          }
        }
} 
```

但如果我想验证字符串值，那么：

```
if (attrs.mystring) {
 // Do validation
} 
```

会失败，验证永远不会发生。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2015-02-01T18:18:02.010

Backbone 现在支持 has 属性。所以你可以做这样的事情：

```
 var Person = Backbone.Model.extend({
        defaults: {
            "name": "Kevin",
            "age" : 26,
            "job" : "web"
        },

        validate: function(attrs, options) {
            for(k in attrs) {
                if(!this.has(k)) {
                    return  k + ' attribute is not exist';
                }
            }
        }
    });

    var person = new Person;

    person.on("invalid", function(model, error) {
        console.log(error);
    }); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-16T20:15:42.767

我对你的措辞有点困惑，但我想你想先检查它是否不是空字符串？并找出它未定义的可能性..如果是这样，那么这就是您想要做的..

```
validate: function(attrs) {
    // Number
    if (attrs.minimum) {
      if (isNaN(attrs.minimum)) {
        return -1;
      }
    }
    if (attrs.maximum) {
      if (isNaN(attrs.maximum)) {
        return -1;
      }
    }
    if (typeof(attrs.mystring) != "undefined"){
      if (!attrs.mystring){
        return -1;
      }
    }
} 
```

如果你只想验证你的一个属性，你应该编写你的验证函数来适应相应的选项

```
validate: function(attrs, option) {
  if (!option){
    // Number
    if (attrs.minimum) {
      if (isNaN(attrs.minimum)) {
        return -1;
      }
    }
    if (attrs.maximum) {
      if (isNaN(attrs.maximum)) {
        return -1;
      }
    }
    if (!attrs.mystring){
      return -1;
    }
  }else{
    switch(option){
      case("string"):
        if (!attrs.mystring){
          return -1;
        }
      break;
      case("number"):
        // Number
        if (attrs.minimum) {
          if (isNaN(attrs.minimum)) {
            return -1;
          }
        }
        if (attrs.maximum) {
          if (isNaN(attrs.maximum)) {
            return -1;
          }
        }
      break;
    }
  }
} 
```

有很多方法可以做到这一点，这可能是效率最低的大声笑，但使用你的例子，它会完成这项工作。

另外，这并不是一个真正的backbone.js问题...但是一般的js

# asp.net - ASP.net 单击按钮打开新的网络表单

> ID：10180930
> 
> 赞同：1
> 
> 时间：2012-04-16T20:08:59.287
> 
> 标签：asp.net, webforms

我正在使用 C# ASP.net，并且相对较新，需要在下面完成。

在我的 VS2010 Web 应用程序项目中，我有 default.aspx、form1.aspx 和 button1 和 form2.aspx。

1-我想将 form1 设置为我的主页（运行应用程序时打开的第一页） 2-想在单击 form1 上的按钮时打开 form2

另外，你能推荐一下涵盖上述项目的好书吗？

谢谢杰

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-04-16T20:13:03.107

快速启动是在设计器视图中双击“button1”，这将生成一个 button1_click(...) 事件处理程序。在这个例程中，您可以编写一行代码：

```
Response.Redirect("~/form2.aspx"); 
```

要将 Form1.aspx 设置为您的“主页”，将其重命名为“default.aspx”是有意义的，这通常是 IIS 寻找的起始页面。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-16T20:15:19.917

希望能帮助到你，

1.  发布时，您必须在 IIS 中将默认页面设为 form1.aspx 页面。在您的 VS2010 中，只需右键单击该文件并将其设置为起始页。

2.  是的，发布的 Response.Redirect 答案是正确的。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-16T20:14:18.160

我发现 ASP.NET Unleashed 对初学者非常有帮助。你可以在亚马逊上找到它：

[http://www.amazon.com/ASP-NET-4-Unleashed-Stephen-Walther/dp/0672331128](https://rads.stackoverflow.com/amzn/click/com/0672331128)

# objective-c - 主函数上的 Exc_Bad_Access 并且无法通过类传递实例变量

> ID：10180934
> 
> 赞同：0
> 
> 时间：2012-04-16T20:09:10.717
> 
> 标签：objective-c, cocoa, memory-management, exc-bad-access, init

**更新帖子**

现在，我在 7 次中有 2 次主要有 EXC_BAD_ACCESS，我不知道为什么当 pumpViewHeight 的结果为 607 时，pumpCustomView 类的 heightOfPumpView 结果为 0。

PumpViewController.m

```
#import "PumpViewController.h"
#import "PumpModel.h"
#import "PumpCustomView.h"

@implementation PumpViewController

@synthesize labels;
@synthesize heightOfPumpView;
- (id)init
{

if (self = [super init]) 
{
    labels = [[PumpModel alloc]init];

    PumpCustomView* pumpView = [PumpCustomView alloc];
    heightOfPumpView = [pumpView pumpViewHeight];
    [labels pumpCreateLabel:heightOfPumpView];
    labelsArray = [[NSMutableArray alloc]initWithArray:[labels labelsGroup]];

    [labels release];

        if (labelsArray!=nil) 
        {
            [pumpView addSubview:[labelsArray objectAtIndex:2]];
        }

    [labelsArray release];
    [pumpView release];
}

return self;
}

-(void) dealloc
{
[super dealloc];

}

@end 
```

泵模型.m

```
#import "PumpModel.h"
#import "PumpViewController.h"
#import "PumpCustomView.h"

@implementation PumpModel
@synthesize labelsGroup;

-(id)init
{
self = [super init];
return self;
}

-(void)pumpCreateLabel:(float)pumpViewHeight
{
theNumberOfPump = 8;
PumpViewController* pumpViewControllerAlloc = [PumpViewController alloc];
labelsGroup = [[NSMutableArray alloc]init];

for (int i = 0;i < theNumberOfPump; i++) 
{
    int pumpViewHeight = [pumpViewControllerAlloc heightOfPumpView];
    int pumpViewWidthA = 259;

    int resultHeight = pumpViewHeight/theNumberOfPump;
    CGFloat resultWidth = pumpViewWidthA/2;
    positionChart[i] = resultHeight * i;        

    newLabel[i] = [[NSTextField alloc] init] ;

    [newLabel[i] setIntValue:i];

    newLabel[i].frame = CGRectMake(resultWidth, positionChart[i], 300, 100);
    newLabel[i].font= [NSFont fontWithName:@"Arial" size:12];
    newLabel[i].textColor= [NSColor blackColor];
    newLabel[i].backgroundColor= [NSColor whiteColor];

    [labelsGroup addObject:newLabel[i]];
    [newLabel[i] release];

    NSLog(@"%@ %d",[[labelsGroup objectAtIndex:i] stringValue],positionChart[i]);
}
[pumpViewControllerAlloc release];

}

-(void) dealloc
{    
[labelsGroup release];
[super dealloc];
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-16T20:12:45.107

您不应该在之前向对象发送消息`[super init]`，例如：

```
- (id)init
{
    if (self = [super init]) 
    {
        [self setNumberOfPump:8];
    }
    return self;
} 
```

这也适用于：

```
-(id)initWithNumberOfPump:(int)numberOfPump
{
    if (self = [super init]) {
        theNumberOfPump = numberOfPump;
        [self pumpCreateLabel];
    }
    return self ; 
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-16T20:49:32.350

如果发生崩溃，请发布崩溃的回溯。

看你的`setNumberOfPump:`方法，似乎很不对劲。

*   标签被分配，然后被释放，可能将实例变量作为悬空引用，稍后会崩溃

*   `labelsArray`被泄露

*   你`dealloc`不会释放任何记忆

您应该尝试在您的代码上运行构建和分析，修复任何错误。上述问题与有关`init`模式的评论相结合，表明您可能应该查看 Objective-C 文档以更好地理解初始化和内存管理模式。

# java - Eclipse插件中的Postgres驱动程序不断出现Class Not Found异常

> ID：10180939
> 
> 赞同：0
> 
> 时间：2012-04-16T20:09:31.383
> 
> 标签：java, eclipse, postgresql, eclipse-plugin

我正在为 Eclipse 开发一个简单的插件，它有一个连接到 Postgres 的视图。我已经安装了运行良好的 postgres。我有一个驱动程序：postgresql-9.0-801.jdbc4.jar，它是随安装包提供的。

现在我正在尝试使用代码连接到数据库：

```
try {
    Class.forName("org.postgresql.Driver");
} catch (ClassNotFoundException cnfe) {
    cnfe.printStackTrace();
    return false;
} 
```

当然，我已经在类路径中添加了提到的 JAR：右键单击项目 > 首选项 > Java 构建路径它被添加到“库”中。

我仍然收到一个错误：

```
java.lang.ClassNotFoundException: org.postgresql.Driver 
```

我还选中了“订购和导出”选项卡中的复选框。

我究竟做错了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-16T21:00:10.370

你说是插件？那么你不应该像这样直接将它添加到 lib 路径中。您正在开发一个 OSGi 包，您必须在清单编辑器中打开 MANIFEST.MF，然后在 Runtime 选项卡的 Classpath 部分添加您的 JAR。还要在 Build 选项卡上检查它是否包含在构建中。是的，OSGi，简单起见的另一个名字。享受。

# php - 如何在 aws php sdk 中设置 DeleteOnTermination？

> ID：10180940
> 
> 赞同：2
> 
> 时间：2012-04-16T20:09:45.063
> 
> 标签：php, amazon-ec2

我正在处理这个文档：[http ://docs.amazonwebservices.com/AWSSDKforPHP/latest/#m=AmazonEC2/modify_instance_attribute](http://docs.amazonwebservices.com/AWSSDKforPHP/latest/#m=AmazonEC2/modify_instance_attribute)

这是我能理解的最好的文档：

```
$instance_id = 'i-XXXXXXXX';
$volume_id = 'vol-XXXXXXXX';

$ec2->modify_instance_attribute ( $instance_id, array(
    'Attribute' => 'blockDeviceMapping',
    'BlockDeviceMapping' => array(
            array(
                    'DeviceName' => '/dev/sdh',
                    'Ebs' => array(
                            array(
                                    'VolumeId' => $volume_id,
                                    'DeleteOnTermination' => true
                            )
                    )
            )
    )
)); 
```

但是调用返回

```
[Error] => CFSimpleXML Object
(
    [Code] => InvalidParameterCombination
    [Message] => No attributes specified.
) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-17T00:06:24.700

您的代码是正确的：我逐字复制它，除了`$instance_id`和`$volume_id`（以及[Amazon EC2](http://aws.amazon.com/ec2/)`DeviceName`测试实例上的现有代码）之外什么都没改变，它正确返回 HTTP 状态 200。

您确定您正在运行最新[的适用于 PHP 的 AWS 开发工具包](http://aws.amazon.com/sdkforphp/)（不是说我知道某个特定问题，但那是现在对我有用的问题）？

# python - 在 OS X 上使用 MacPorts 安装的 Python 包和 Enthought（或其他）Python？

> ID：10180941
> 
> 赞同：2
> 
> 时间：2012-04-16T20:09:46.257
> 
> 标签：python, macos, emacs, macports, enthought

我在我的 Mac 上安装了两个 Python 2.7.2——来自 MacPorts 和 Enthought。我使用 Enthought Python 作为主要的；但是，MacPorts 发行版有几个额外的包，如 pymacs、rope 等，我想将它们提供给 Enthought Python。（我实际上是在尝试使用带有 Enthought Python 的 Emacs，但也使用 MacPorts 安装的 Rope，Pymacs 在 Emacs 中完成代码）。

有没有一种干净的方法可以在不破坏任何东西的情况下让 Enthought Python 可以使用 MacPorts 包？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-08T00:41:25.560

尝试组合这两个发行版是有风险的，因为您可能会遇到冲突（特别是对于链接到略有不同版本的共享库的 C 扩展）。这是 EPD 出现问题的常见原因：

[https://support.enthought.com/entries/22094157-OS-X-Conflict-with-installed-packages-in-earlier-Python-installation](https://support.enthought.com/entries/22094157-OS-X-Conflict-with-installed-packages-in-earlier-Python-installation)

在 EPD 中安装新软件包的推荐方法是使用该`enpkg`工具。`enpkg --help`您可以通过本文或在本文中了解有关 enpkg 的更多信息：

[https://support.enthought.com/entries/22415022-Using-enpkg-to-update-EPD-packages](https://support.enthought.com/entries/22415022-Using-enpkg-to-update-EPD-packages)

如果您的软件包无法通过 enpkg 获得（在您的情况下，它看起来好像`rope`不是`pymacs`，假设您有适当的订阅），EPD 是一个非常标准的 python 发行版，您可以通过正常方式在其中安装软件包，例如`pip`或通过抓住源头并运行`python setup.py install`. 看：

[https://support.enthought.com/entries/22914233-Using-non-EPD-package-installers-such-as-pip](https://support.enthought.com/entries/22914233-Using-non-EPD-package-installers-such-as-pip)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-02T20:18:43.313

再次为 Enthought Python 安装额外的软件包会更干净。尝试重用来自另一个安装的软件包对我来说既不干净也不安全。

# objective-c - 用于在整个应用程序中更新数据的委托和观察者设计

> ID：10180948
> 
> 赞同：1
> 
> 时间：2012-04-16T20:10:09.057
> 
> 标签：objective-c, design-patterns, delegates

我正在构建一个 iPhone 应用程序，它有一个中心类 M，它从 Web API 获取大量数据。每当此类获取数据时，它必须更新两个控制器，例如 A 和 B。为了支持这一点，A 和 B 都列在具有更新命令的接口下。A 和 B 还需要能够从类 M 中查询数据，所以我在 A 和 B 中都添加了 M 的句柄。

问题是设置不是很模块化。我正在寻找清理设计的方法。

编辑 - 此外，M 类对 A 类和 B 类的确切类型没有任何先入为主的概念。

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-16T22:20:44.050

就像你在标题上提出的那样做：使用*观察者*模式。`A`并且`B`是 的*观察者*（实现*观察者*协议）`M`，这是*主题*。当你更新观察者时，也通过更新方法提供*事件*数据，可能作为实现的*主题*协议的句柄`M`。通过这种方式，`A`并且通过*观察者*和*主题*协议`B`分离。`M`

# cuda - CUDA 编程 - L1 和 L2 缓存

> ID：10180949
> 
> 赞同：7
> 
> 时间：2012-04-16T20:10:12.027
> 
> 标签：cuda, coalescing

您能否解释在 CUDA 编程中同时使用“L1 和 L2”缓存或“仅 L2”缓存之间的区别？在时间执行中我应该期待什么？我什么时候可以期待更小的 GPU 时间？当我同时启用 L1 和 L2 缓存或仅启用 L2 时？谢谢

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-04-16T21:50:03.453

通常，您会同时启用 L1 和 L2 缓存。您应该尝试尽可能多地合并您的内存访问，即，warp 中的线程应该尽可能多地访问同一 128B 段内的数据（有关此主题的更多信息，请参阅[CUDA 编程指南](http://developer.nvidia.com/nvidia-gpu-computing-documentation)）。

有些程序无法以这种方式进行优化，例如它们的内存访问是完全随机的。对于这些情况，绕过 L1 缓存可能是有益的，从而避免在您只需要例如 4 个字节时加载整个 128B 行（您仍将加载 32B，因为这是最小值）。显然有效率提升：4 个有用字节从 128 提高到 4 从 32。

# ruby-on-rails-3 - 同时验证多个对象

> ID：10180953
> 
> 赞同：1
> 
> 时间：2012-04-16T20:10:26.467
> 
> 标签：ruby-on-rails-3, validation, model

假设我有一个名为`SchoolYear`. 这个模型有很多时期。当我想创建一个评估结构时，它会自动创建三个具有默认值的时段。

```
class SchoolYear < ActiveRecord::Base

  has_many :periods, :dependent => :destroy

  ...

end 
```

稍后，我有一个视图，用户可以在其中更新所有这 3 个时期以及学年（表格基于学年）。期间有一个状态字段，它可以是活动的、非活动的或已完成的。创建学年时，其期间状态的默认值为非活动

```
class Period < ActiveRecord::Base

  ACTIVE = 1
  INACTIVE = 2
  FINISHED = 3

  belongs_to :school_year

  validates_inclusion_of :status, :in => [ACTIVE, INACTIVE, FINISHED]

end 
```

更新学年时，至少有一个学年期间需要处于活动状态。我怎样才能验证这一点？如果我尝试在`SchoolYear`模型中执行此操作，其所有周期仍将具有默认值。在`Period`模型中，只有当前期间 ( `self`) 具有其新值。检查其他期间时，它们都具有默认值。它们确实得到了更新，但我的意思是当我尝试验证我想要的东西时，它们仍然显示它们的旧值，因为它们还没有在数据库中更新，而且 Rails 没有在内存中寻找它们的值。

例如，如果我想在`SchoolYear`模型中做这个验证，我可能会有这样的事情：

```
class SchoolYear < ActiveRecord::Base

  validate :at_least_one_active_period, :on => :update

  def at_least_one_active_period
    self.errors.add(:periods_error, "Period Error") unless self.periods.where(:status => Period::ACTIVE).count == 1
  end

end 
```

结尾

这行不通，因为正如我所说，Rails 直接从数据库中检索这些值，并且没有考虑表单传递的内容。你能帮助我吗？谢谢！

# .net - .NET ImageList 实现中的 ImageList 容量错误？

> ID：10180954
> 
> 赞同：4
> 
> 时间：2012-04-16T20:10:26.530
> 
> 标签：.net, image, imagelist

我在 .net 应用程序中为我的 ListView 使用 ImageList 时遇到了一些问题。在我的实现中，这个 ImageList 可以根据使用情况保存几千张图像。这个问题最初是在我尝试处理大量图像时出现的。一旦超过 5K+ 图像，我在尝试添加图像时遇到了一个通用的“图像无法添加到 ImageList”异常。发生此故障的确切数字略有跳跃。

因此，在尝试解决此问题时，我尝试使用本机 ImageList_SetImageCount 函数扩展 ImageList 的容量。这很好，解决了我眼前的问题。我必须使用 ImageList[index] = image 而不是 .Add() 方法填充列表。这一切都很好，但是当需要拉出图像时，问题就出现了。现在，每当我通过索引引用该 ImageList 中的图像时，我都会收到内存不足异常。Bitmap x = ImageList[any index] 会崩溃。

我尝试过很多不同的方法，但仍然遇到 ImageList 的问题。

在我最后一次尝试进一步探索这个问题时，我整理了以下仍然表现奇怪的测试代码！

```
 private void Form1_Load(object sender, EventArgs e)
    {
        list = new ImageList();
        list.ImageSize = new Size(128, 128);
        list.ColorDepth = ColorDepth.Depth32Bit;
        Image[] images = new Image[10];
        for (int y = 0; y < 10; y++)
        {
            images[y] = new Bitmap(@"Path to loading_photo.png");
        }
        for (int x = 0; x < 750; x++)
        {
            list.Images.AddRange(images);
        }

        list.Images[12] = new Bitmap(@"Path to another.png"); 
```

最后一行因“无法将图像添加到 ImageList”错误而崩溃。奇怪的是，将第二个循环设置为较低的迭代次数（即添加 2000 张图像时为 200 次），它的表现还不错。

我不知道.net 中的 ImageList 是否有一定的阈值？任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-17T00:30:06.217

对于发布的代码，我无法得到任何重现。然而，重要的是要意识到 ImageList 会*复制*位图。所以你应该在添加位图后调用它的 Dispose() 方法。如果您不这样做，那么您将面临一个严重的风险，即您将耗尽非托管内存，被位图数据消耗，并且当垃圾收集器没有足够频繁地运行以在您之后清理时致命。这不适用于片段，因为只有 10 个位图。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-16T20:46:34.653

当您使用 Reflector 查看最后一行代码的作用时，您会看到 ImageList 的设置器实际上在这一行上失败了：

```
bool flag2 = SafeNativeMethods.ImageList_Replace(new HandleRef(this.owner, this.owner.Handle), index, new HandleRef(null, handle), new HandleRef(null, monochromeMask)); 
```

它涉及使用句柄，这些句柄在 Windows 中是有限的（如果我没记错的话，每个进程 10000 个）。因此，尽管您有很多可用内存，但您可能已达到句柄限制。

# python - 映射到最大数量的列表

> ID：10180958
> 
> 赞同：0
> 
> 时间：2012-04-16T20:10:37.850
> 
> 标签：python

我有可变数量的列表，我想从所有列表中找到每个数字的最大值。

我正在尝试使用 map 函数来映射所有列表的最大值，我需要使用生成器表达式来传递 map 函数中的参数。

我正在使用这样的东西，但它不起作用：

```
map(max,x[c] for c in x.keys()) 
```

例如，我的列表在字典中：

```
{1: [0, 1, 0, 0, 3, 0],
 2: [1, 0, 0, 0, 0, 4, 5],
 3: [0, 5, 6, 0, 1, 1]} 
```

您可能注意到这些列表的大小并不相同，这就是我希望它们的大小，因为我拥有需要解析的数据的方式。

结果应该是：`[1, 5, 6, 0, 3, 4, 5]`

请建议是否有其他方法可以做到这一点。

以上是列表的示例。由于我的实际字典的设置方式，我无法使用 x.values() 来检索列表。列表嵌入在层次结构的底部，我需要遍历层次结构的顶部以检索要比较的列表。我必须使用生成器表达式来检索所有列表，因此请提供不使用 x.values() 的解决方案

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-16T20:18:23.420

要使`max`s 超过最短值的末尾，您需要`izip_longest`：

```
from itertools import izip_longest

d={1: [0, 1, 0, 0, 3, 0],
 2: [1, 0, 0, 0, 0, 4, 5],
 3: [0, 5, 6, 0, 1, 1]}

# there are other variations like
# [max(column) for column in izip_longest(*d.itervalues())]
print map(max, izip_longest(*d.values()))
# [1, 5, 6, 0, 3, 4, 5] 
```

`zip_longest`它在 Python 3上被称为。

* * *

即使您没有访问所有列表的简单方法，这仍然是一种方法。您可以根据需要获取列表：

```
d = {1: {'a': [0, 1, 0, 0, 3, 0]},
     2: {'a': [1, 0, 0, 0, 0, 4, 5]},
     3: {'a': [0, 5, 6, 0, 1, 1]}}

def value_gen(obj):
    for key in obj:
        yield obj[key]['a'] 
```

然后使用：

```
map(max, izip_longest(*value_gen(d))) 
```

# validation - 获取失败约束的名称

> ID：10180964
> 
> 赞同：0
> 
> 时间：2012-04-16T20:11:06.050
> 
> 标签：validation, grails, groovy, grails-orm

假设我有一个具有属性的`User`类，`username`并且在该字段上定义了几个约束。

```
class User {
    String username

    static constraints = {
        username blank: false, unique: true, email: true
    }
} 
```

如果我打电话

```
user.save() 
```

然后我可以通过以下方式确定该字段上的任何约束是否`username`失败

```
user.errors['username'] != null 
```

但是有没有办法可以找出哪些约束失败了？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-16T20:36:21.233

该值`user.errors['username'].codes`将包含许多用于在 中查找验证消息的键`messages.properties`。您可以使用这些来确定哪些约束被破坏。

例如，`user.errors['username'].codes[-1]`将包含键的约束部分`messages.properties`：

```
assert user.errors['username'].codes[-1] == 'blank' // if blank constraint fails
assert user.errors['username'].codes[-1] == 'unique' // if unique constraint fails 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-16T21:16:55.020

是的，您可以使用`code`错误对象上的属性检查错误代码：

```
def user = new User(email: '')
user.validate()
assert user.errors['email'].code == 'blank'

user.email = 'asdasd'
user.validate()
assert user.errors['email'].code == 'email.invalid' 
```

如果您在一个属性中可能有多个错误，我发现获取该属性的所有错误的唯一方法是迭代该`allErrors`属性：

```
class Foo {
    String bar, baz
    static constraints = {
        bar blank: false
        baz email: true, notEqual: 'foobar'
    }
}

def foo = new Foo(bar: '', baz: 'foobar')
foo.validate()
foo.errors.allErrors.each {
    println "$it.field: $it.code"
} 
```

应该输出如下内容：

```
bar: blank
baz: notEqual
baz: email.invalid 
```

# java - 根据 HttpGet 使用 Apache 的 HttpClient 返回的内容发布到表单

> ID：10180965
> 
> 赞同：0
> 
> 时间：2012-04-16T20:11:15.437
> 
> 标签：java, forms, apache, post, httpclient

我正在使用 Apache 的 HttpClient 类将数据发布到网站表单。使用以下代码行检索表单：

```
HttpGet get = new HttpGet(url);
HttpResponse response = client.execute(get); 
```

我从中检索表单的网站需要身份验证才能访问表单。如果请求未通过身份验证，则网站会将请求重定向到登录表单页面，该页面随后将在成功验证后重定向回原始页面。

我想干净地检测 GET 请求是否返回登录页面或所需的表单页面，以便我可以发布登录数据或表单数据。我能想到的唯一方法是从响应实体的内容 InputStream 中读取并解析每一行。但这似乎有些令人费解。我以前没有使用过 Apache HttpComponents api，所以我不确定这是否是完成我想要完成的唯一和最好的方法。

编辑：为了澄清问题，我问是否有一套方法来处理使用 Apache 的 HttpClient 的表单。我有点知道如何实现我想要做的事情，但它看起来很丑陋，我希望有一种更简单、更快捷的方法来实现它。例如，如果有某种方法可以执行以下操作：

```
HttpGet get = new HttpGet(url);
HttpResponse response = client.execute(get);
if(parseElements(response.getEntity()).hasFormWithId("login")) {
    // post authentication data    
} else {
    // post actual form data
} 
```

由于我对 Apache 的 HttpClient api 缺乏经验，我不确定我在 API 中寻找的内容对于 API 的意图是否过于抽象。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-16T20:55:32.210

您可以通过设置 HttpClient 参数来修改 HttpClient 的行为

```
DefaultHttpClient client = new DefaultHttpClient();
client.setDefaultHttpParams(client.getParams().setBoolean(ClientPNames.HANDLE_REDIRECTS, false)); 
```

这会禁用自动处理重定向。

也可以看看：

*   [自动重定向处理](http://hc.apache.org/httpcomponents-client-ga/tutorial/html/httpagent.html#d5e1248)
*   [HTTP 身份验证](http://hc.apache.org/httpcomponents-client-ga/tutorial/html/authentication.html)
*   [默认HttpClient API](http://hc.apache.org/httpcomponents-client-ga/httpclient/apidocs/org/apache/http/impl/client/DefaultHttpClient.html)

# xcode - 有什么方法可以防止 iOS Enterprise 应用程序在崩溃后完全终止？

> ID：10180969
> 
> 赞同：1
> 
> 时间：2012-04-16T20:11:23.827
> 
> 标签：xcode, ios5, crash

前言：我为博物馆编写 iPad 应用程序，将其用作“永久”信息亭。他们需要一直运行 1 个应用程序。我的问题与这种情况有关，而不是 App Store 分发或担心外部用户，因为这些是企业应用程序。我是唯一的开发人员，并且对应用程序开发还是新手，在严格的期限内操作，并且不能总是在应用程序必须上线之前修复每个错误。我们的客人有时是应用程序的初始测试人员。这些是运行 iOS 5.1 的 iPad 2 和新设备。一些应用程序正在运行 Cocos2d ver 2.0 框架。

我需要阻止博物馆的客人使用 iPad 的桌面。在了解`SBStoreDemoAppLock`并使用金属框架外壳后，我使用 mobileconfig 文件禁用了主页按钮。显然，我希望并努力使我的应用程序永远不会崩溃。然而，当 iPad 24/7 全天候运行时，有时每天要处理 2000 多名儿童敲击、滑动和殴打它们时，该应用程序确实偶尔会崩溃。

当我致力于更好的编码以防止崩溃甚至发生时，有什么方法可以防止应用程序在遇到崩溃时完全关闭？意思是如果它需要崩溃，可以显示一个简单的 imageView 说“联系 IT”吗？我知道这听起来很矛盾，因为如果一个应用程序需要崩溃，它就会崩溃，但我不知道该怎么说。

或者，更不可能的是，有没有办法在崩溃后自动重新启动应用程序？我研究了 URL 方案方法并将其添加到`applicationWillTerminate`，但是自从 iOS 4 出现以来，这种方法已被弃用。我更喜欢避免越狱，但如果有人知道使用 Cydia 应用程序执行此操作的简单方法，我想听听它作为最后的选择。

就设置选项卡下的可用范围而言，我对 iPad 进行了完全限制，但今天的孩子（和成人）可以找到各种各样的事情，例如反转颜色、打开辅助缩放等。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-16T20:20:13.130

首先想到的是使用 NSSetUncaughtExceptionHandler 来拦截应用程序中的任何错误。无论您在处理程序中做什么，都应该尽可能少地使用代码，预先加载所需的任何资源，并经过良好测试，因为异常处理期间的错误是一个**坏**主意。

# iphone - 如何在我的应用程序中处理西班牙语字符？

> ID：10180971
> 
> 赞同：0
> 
> 时间：2012-04-16T20:11:37.507
> 
> 标签：iphone, objective-c, encoding

在我的应用程序中，我有一项支持西班牙语并以西班牙语返回结果的服务。现在我正在尝试将一些搜索词传递给该服务以获取结果，但它失败了，因为在发送编译器时将这个词转换为一些带有不明字符的有趣词。我正在这样做：这里的名称是西班牙语，但是当我在配置字典中添加它时，它会再次转换为一些有趣的东西。

```
-(void)perfromLocationSearchWithName:(NSString *)name{

    NSData * nameCode = [[NSData alloc]init];
    nameCode = [name dataUsingEncoding:NSUTF8StringEncoding allowLossyConversion:YES];
    NSString * namePass = [[NSString alloc]initWithData:nameCode encoding:NSUTF8StringEncoding];
    NSLog(@"Name:%@",namePass);

    NSMutableDictionary *config = [[[NSMutableDictionary alloc] initWithCapacity:4] autorelease];
    NSString * strAction = [NSString stringWithFormat:@"vendorSearchByName"];
    if (namePass !=nil){
        [config setObject:namePass forKey:@"vendorName"];
        //[config setObject:@"001" forKey:@"MakeCode"];
        [config setObject:@"5" forKey:@"maxCount"];
        [config setObject:strAction forKey:@"action"];
    }
    NSLog(@"Dict%@",[config description]);
    comm = [[CommManager alloc] init];
    [comm searchDealerLocationWithOptions:config withDelegate:self];
    [namePass release];
} 
```

请帮忙谢谢，

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-17T14:10:37.013

尝试使用`NSISOLatin1StringEncoding`. 在我们的应用程序中帮助我们。

# android - Android OpenGL ES 纹理未在三星手机上显示

> ID：10180974
> 
> 赞同：2
> 
> 时间：2012-04-16T20:11:39.430
> 
> 标签：android, opengl-es, textures

我是一个长期阅读者，第一次发帖，最近我发现我的 Android 游戏有一个奇怪的问题。我使用我的 HTC Desire Z 和模拟器一起测试我的游戏，一切正常，但我的朋友最近告诉我，在三星手机上（至少 Galaxy S2 和普通 Galaxy 有症状）屏幕只是保持白色。在用朋友的手机进行了一些调试后，我发现游戏运行正常，但纹理不只是显示出来。我尝试搜索该问题，但并没有真正发现任何有用的东西。

纹理是 .png、方形和 POT。以下是从位图加载开始的相关代码位：

```
private boolean LoadTextures(GL10 gl) {
   if(DEBUG)
      Log.d(TAG, "Loading textures.");
   bitmaps[0] = R.raw.game;
   bitmaps[1] = R.raw.splash;
   bitmaps[2] = R.raw.menu;
   bitmaps[3] = R.raw.font01;
   bitmaps[4] = R.raw.bg;
   bitmaps[5] = R.raw.gameover;
   bitmaps[6] = R.raw.helpc;
   bitmaps[7] = R.raw.helptag;      

   gl.glGenTextures(NUM_TEXTURES, textures, 0);

   for(int i=0; i<NUM_TEXTURES; i++) {
      bitmap = BitmapFactory.decodeResource(context.getResources(), bitmaps[i]);
      if(bitmap == null)
      {
         if(DEBUG)
         {
            Log.w(TAG, "Bitmap decoding failed, aborting.");
            return false;
         }
      }

      gl.glBindTexture(GL10.GL_TEXTURE_2D, textures[i]);
      gl.glTexParameterf(GL10.GL_TEXTURE_2D, GL10.GL_TEXTURE_MAG_FILTER, 
                         GL10.GL_LINEAR);
      gl.glTexParameterf(GL10.GL_TEXTURE_2D, GL10.GL_TEXTURE_MIN_FILTER, 
                         GL10.GL_LINEAR);
      gl.glTexParameterf(GL10.GL_TEXTURE_2D, GL10.GL_TEXTURE_WRAP_S, 
                         GL10.GL_CLAMP_TO_EDGE);
      gl.glTexParameterf(GL10.GL_TEXTURE_2D, GL10.GL_TEXTURE_WRAP_T, 
                         GL10.GL_CLAMP_TO_EDGE);
      GLUtils.texImage2D(GL10.GL_TEXTURE_2D, 0, bitmap, 0);
      bitmap.recycle();
   }
return true;
} 
```

我的 onSurfaceCreated 函数：

```
public void onSurfaceCreated(GL10 gl, EGLConfig config) {
   gl.glEnable(GL10.GL_TEXTURE_2D);
   gl.glClearDepthf(1.0f);
   gl.glEnable(GL10.GL_DEPTH_TEST);
   gl.glDepthFunc(GL10.GL_LEQUAL);
   gl.glHint(GL10.GL_PERSPECTIVE_CORRECTION_HINT, GL10.GL_NICEST);  
   if(DEBUG) 
      Log.d(TAG, "GLRenderer: Surface created.");
} 
```

我的 onSurfaceChanged 函数

```
public void onSurfaceChanged(GL10 gl, int width, int height) {
   if(LoadTextures(gl)) // load textures
   {
      if(DEBUG)
         Log.d(TAG, "Textures loaded succesfully.");
   }
   else
   {
      if(DEBUG)
         Log.w(TAG, "Texture loading failed.");
   }
   gl.glViewport(0, 0, width, height);
   gl.glMatrixMode(GL10.GL_PROJECTION);
   gl.glEnableClientState(GL10.GL_VERTEX_ARRAY);
   gl.glEnableClientState(GL10.GL_TEXTURE_COORD_ARRAY);
   gl.glLoadIdentity();
   gl.glOrthof(-width/2f, width/2f, -height/2f, height/2f, -1, 1);
   gl.glMatrixMode(GL10.GL_MODELVIEW);
   gl.glFrontFace(GL10.GL_CCW);
   gl.glEnable(GL10.GL_CULL_FACE);
   gl.glCullFace(GL10.GL_BACK);     
   gl.glEnable(GL10.GL_TEXTURE_2D);
   gl.glEnable(GL10.GL_BLEND);
   gl.glBlendFunc(GL10.GL_ONE, GL10.GL_ONE_MINUS_SRC_ALPHA);
   gl.glLoadIdentity();
   Log.d(TAG, "Set GL modes succesfully.");
} 
```

来自 OnDrawFrame 的相关绘图：

```
gl.glClearColor(0f, 0f, 0f, 1.0f);
gl.glClear(GL10.GL_COLOR_BUFFER_BIT | GL10.GL_DEPTH_BUFFER_BIT);
gl.glPushMatrix();
gl.glVertexPointer(3, GL10.GL_FLOAT, 0, i.GetBuffers().GetVertexBuffer());      
gl.glTranslatef(i.GetXCoordinate(),i.GetYCoordinate(), i.GetZCoordinate());
gl.glBindTexture(GL10.GL_TEXTURE_2D, textures[i.GetBuffers().GetTextureId()]);
gl.glTexCoordPointer(2, GL10.GL_FLOAT, 0, i.GetBuffers().GetTextureBuffer());
gl.glDrawElements(GL10.GL_TRIANGLES, i.GetBuffers().GetIndicesCount(),   
                  GL10.GL_UNSIGNED_SHORT, i.GetBuffers().GetIndexBuffer());                          
gl.glPopMatrix(); 
```

任何关于为什么这在三星手机上不起作用的提示将不胜感激。

# c - 当 va_list 的长度由局部变量设置时，vsprintf_s() 不起作用

> ID：10180975
> 
> 赞同：0
> 
> 时间：2012-04-16T20:11:42.420
> 
> 标签：c, visual-c++

我有一个可以正常工作的实用程序 C 函数：

```
void UtilDisplayMessage(char* strCaption, char* strMessageFormat, int iArgCount, ...)
{
    // Initialize the variable arg list
    va_list lstArgs;
    va_start(lstArgs, iArgCount);

    // Format the message
    vsprintf_s(g_strMessage, UTIL_DEF_MESSAGE_SIZE, strMessageFormat, lstArgs);

    // Destroy the variable arg list
    va_end(lstArgs);

    // Use formatted string here...
} 
```

但我想删除“iArgCount”参数，所以我做了一个如下所示的测试函数：

```
void UtilDisplayMessageEasy(char* strCaption, char* strMessageFormat, ...)
{
    // Initialize the variable arg list
    va_list lstArgs;

    int iParamCount = 1;
    va_start(lstArgs, iParamCount);

    // Format the message
    vsprintf_s(g_strMessage, UTIL_DEF_MESSAGE_SIZE, strMessageFormat, lstArgs);

    // Destroy the variable arg list
    va_end(lstArgs);

    // Use formatted string here...
} 
```

但是如果我通过这个调用传入一个整数值，我会得到虚假的结果：

```
UtilDisplayMessageEasy("TEST", "The value is %i.", 1); 
```

当我通过这个调用传入一个字符串时，我得到一个访问冲突异常：

```
UtilDisplayMessageEasy("TEST", "This is only a %s.", "TEST"); 
```

然而，如果我像这样调用我的原始函数，它工作正常：

```
UtilDisplayMessage("TEST", "This is only a %s.", 1, "TEST"); 
```

我是否将参数参数或本地参数传递给 va_start() 真的有这么根本的区别吗？

另外我知道可变参数不是很安全，应该小心使用，但这种无害的东西肯定不应该让警报响起。

感谢您对此问题的任何意见。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-16T21:00:52.627

va_list 变量用于从它之前的参数导出 ... 的起始地址。这是一个要求。你不能使用本地的，你可能想做

```
va_start(lstArgs, strMessageFormat); 
```

反而。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-16T20:39:33.557

的第二个参数`va_start`需要是`...`函数声明中的最后一个参数。所以它需要`iArgCount`在第一种情况和`strMessageFormat`第二种情况下。在第二个参数中使用其他任何东西（例如局部变量）会给您带来未定义的行为——希望编译器会给您一个错误，但它可能只是默默地接受它并做一些随机的事情。

# android - 带旋转支持的异步

> ID：10180987
> 
> 赞同：0
> 
> 时间：2012-04-16T20:12:27.637
> 
> 标签：android, android-asynctask, orientation

编辑：所以我尝试应用旋转支持，但每次我旋转我的设备时，对话框都会弹出任何关于我做错了什么的想法，或者为什么它不能阻止对话框在方向改变时显示？

```
 package com.ondrovic.bbym;

 import java.io.File;
 import java.io.FileOutputStream;
 import java.io.InputStream;
 import java.net.HttpURLConnection;
 import java.net.URL;

 import android.app.Activity;
 import android.app.Dialog;
 import android.app.ProgressDialog;
 import android.content.Context;
 import android.content.Intent;
 import android.content.res.Configuration;
 import android.os.AsyncTask;
 import android.os.Bundle;
 import android.os.Environment;
 import android.view.LayoutInflater;
 import android.view.View;
 import android.view.ViewGroup;
 import android.widget.LinearLayout;
 import android.widget.TextView;

 public abstract class Dashboard extends Activity {
public static final boolean usePrettyGoodSolution = false;
private ProgressDialog PROGRESS_BAR;
private Download task = null;
private static final int PROGRESS = 0;
public static File rDIR = Environment.getExternalStorageDirectory();
public static final String fDIR = "/Android/data/Bestbuy Mobile/database/";
public static final String fNAME = "bestbuy.db";
public static final String fURL = "http://db.tt/5JTRpA8q";

@Override
protected void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);

    task = (Download) getLastNonConfigurationInstance();

}

@Override
public Object onRetainNonConfigurationInstance() {
    task.detach();
    return (task);
}

@Override
public void onDestroy() {
    super.onDestroy();
}

@Override
public void onPause() {
    super.onPause();
}

@Override
public void onRestart() {
    super.onRestart();
}

@Override
public void onResume() {
    super.onResume();
}

@Override
public void onStart() {
    super.onStart();
}

@Override
public void onStop() {
    super.onStop();
}

public void onClickHome(View v) {
    goHome(this);
}

public void onClickUpdate(View v) {
    dbDIR(fDIR);
    //new Download().execute(fURL);
    if (task == null) {
        task = new Download(this);
        task.execute(fURL);
    } else {
        task.attach(this);
    }
}

public void onClickEmail(View v) {
    // title_bar email : price quotes :-)

    if (getTitle().toString().equals("Individual")) {
        try {
            Intent email = new Intent(Intent.ACTION_SEND);
            email.setType("message/rfc822");
            email.putExtra(Intent.EXTRA_SUBJECT,
                    "BBYM Individual Plan Comparison");
            email.putExtra(Intent.EXTRA_TEXT, "\nAT&T Individual Plan"
                    + "\nMinutes Package: " + Individual_ATT.packageTalk
                    + "\nMessage Package: " + Individual_ATT.packageText
                    + "\nData Package: " + Individual_ATT.packageData
                    + "\nPrice: " + Individual_ATT.packagePrice
                    + "\n\nSprint Individual Plan" + "\nPackage: "
                    + Individual_SPRINT.packageInfo + "\nPrice: "
                    + Individual_SPRINT.packagePrice
                    + "\n\nVerizon Individual Plan" + "\nPackage: "
                    + Individual_VERIZON.packageTalk + "\nData: "
                    + Individual_VERIZON.packageData + "\nPrice: "
                    + Individual_VERIZON.packagePrice);

            try {
                startActivity(Intent
                        .createChooser(email, "Send Comparison"));
            } catch (android.content.ActivityNotFoundException ex) {

            }
        } catch (Exception e) {

        }
    }

    if (getTitle().toString().equals("Family")) {
        try {
            Intent email = new Intent(Intent.ACTION_SEND);
            email.setType("message/rfc822");
            email.putExtra(Intent.EXTRA_SUBJECT,
                    "BBYM Family Plan Comparison");
            email.putExtra(Intent.EXTRA_TEXT, "\nAT&T Family Plan"
                    + "\nMinutes Pacakge: "
                    + Family_ATT.packageTalk
                    + "\nMessage Package: "
                    + Family_ATT.packageText
                    + "\nAdditional Lines: "
                    + Family_ATT.packageXtraLn
                    + "\nData Package Line 1: "
                    + Family_ATT.packageData1
                    + "\nData Package Line 2: "
                    + Family_ATT.packageData2
                    + "\nData Package Line 3: "
                    + Family_ATT.packageData3
                    + "\nData Pacakge Line 4: "
                    + Family_ATT.packageData4
                    + "\nData Package Line 5: "
                    + Family_ATT.packageData5
                    + "\nPrice: "
                    + Family_ATT.packagePrice
                    + "\n\nSprint Family Plan"
                    + "\nPacakge: "
                    + Family_SPRINT.packageInfo
                    + "\nAdditional Lines: "
                    + Family_SPRINT.packageXtraLn
                    + "\nLine 1 Type: "
                    + Family_SPRINT.packageLine1
                    + "\nLine 1 Data: "
                    + Family_SPRINT.dataPriceL1
                    + "\nLine 2 Type: "
                    + Family_SPRINT.packageLine2
                    + "\nLine 2 Data: "
                    + Family_SPRINT.dataPriceL2
                    + "\nLine 3 Type: "
                    + Family_SPRINT.packageLine3
                    + "\nLine 3 Data: "
                    + Family_SPRINT.dataPriceL3
                    + "\nLine 4 Type: "
                    + Family_SPRINT.packageLine4
                    + "\nLine 4 Data: "
                    + Family_SPRINT.dataPriceL4
                    + "\nLine 5 Type: "
                    + Family_SPRINT.packageLine5
                    + "\nLine 5 Data: "
                    + Family_SPRINT.dataPriceL5
                    + "\nPrice: "
                    + Family_SPRINT.packagePrice
                    + "\n\nVerzon Family Plan"
                    + "\nPackage: "
                    + Family_VERIZON.packageTalk
                    + "\nAdditional Lines: "
                    + Family_VERIZON.packageXtraLn
                    + "\nData Pacakge Line 1: "
                    + Family_VERIZON.packageData1
                    + "\nData Pacakge Line 2: "
                    + Family_VERIZON.packageData2
                    + "\nData Pacakge Line 3: "
                    + Family_VERIZON.packageData3
                    + "\nData Pacakge Line 4: "
                    + Family_VERIZON.packageData4
                    + "\nData Pacakge Line 5: "
                    + Family_VERIZON.packageData5
                    + "\nPrice: "
                    + Family_VERIZON.packagePrice);

            try {
                startActivity(Intent
                        .createChooser(email, "Send Comparison"));
            } catch (android.content.ActivityNotFoundException ex) {

            }
        } catch (Exception e) {

        }
    }

    if (getTitle().toString().equals("Broadband")) {
        try {
            Intent email = new Intent(Intent.ACTION_SEND);
            email.setType("message/rfc822");
            email.putExtra(Intent.EXTRA_SUBJECT,
                    "BBYM Broadband Plan Comparison");
            email.putExtra(Intent.EXTRA_TEXT, "\nAT&T Broadband Plan"
                    + "\nPackage: " + Broadband_ATT.pacakgeData
                    + "\nPrice: " + Broadband_ATT.packagePrice
                    + "\n\nSprint Broadband Plan" + "\nPackage: "
                    + Broadband_SPRINT.pacakgeData + "\nPrice: "
                    + Broadband_SPRINT.packagePrice
                    + "\n\nVerizon Broadband Plans" + "\nPacakge: "
                    + Broadband_VERIZON.pacakgeData + "\nPrice: "
                    + Broadband_VERIZON.packagePrice);

            try {
                startActivity(Intent
                        .createChooser(email, "Send Comparison"));
            } catch (android.content.ActivityNotFoundException ex) {

            }
        } catch (Exception e) {

        }
    }

    if (getTitle().toString().equals("Embedded")) {
        try {
            Intent email = new Intent(Intent.ACTION_SEND);
            email.setType("message/rfc822");
            email.putExtra(Intent.EXTRA_SUBJECT,
                    "BBYM Embedded Plan Comparison");
            // email.putExtra(Intent.EXTRA_TEXT, Html.fromHtml(new
            // StringBuilder()
            // .append("<p><b>BBYM Embedded Plan Comparison</b></p>")
            // .append("<p>This is a test</>") .toString()));

            try {
                startActivity(Intent
                        .createChooser(email, "Send Comparison"));
            } catch (android.content.ActivityNotFoundException ex) {

            }
        } catch (Exception e) {

        }
    }
}

public void goHome(Context context) {
    final Intent intent = new Intent(context, Home.class);
    intent.setFlags(Intent.FLAG_ACTIVITY_CLEAR_TOP);
    context.startActivity(intent);
}

@Override
public void setContentView(int layoutID) {
    if (!usePrettyGoodSolution) {
        super.setContentView(layoutID);
        return;
    }

    @SuppressWarnings("unused")
    Configuration c = getResources().getConfiguration();
    int size = c.screenLayout & Configuration.SCREENLAYOUT_SIZE_MASK;
    boolean isLarge = (size == Configuration.SCREENLAYOUT_SIZE_LARGE);
    boolean isXLarge = (size == Configuration.SCREENLAYOUT_SIZE_XLARGE);
    boolean addFrame = isLarge || isXLarge;

    // if (isLarge) System.out.println ("Large screen");
    // if (isXLarge) System.out.println ("XLarge screen");

    int finalLayoutId = addFrame ? R.layout.large : layoutID;
    super.setContentView(finalLayoutId);

    if (addFrame) {
        LinearLayout frameView = (LinearLayout) findViewById(R.id.frame);
        if (frameView != null) {

            // If the frameView is there, inflate the layout given as an
            // argument.
            // Attach it as a child to the frameView.
            LayoutInflater li = ((Activity) this).getLayoutInflater();
            View childView = li.inflate(layoutID, null);
            if (childView != null) {
                LinearLayout.LayoutParams lp = new LinearLayout.LayoutParams(
                        ViewGroup.LayoutParams.MATCH_PARENT,
                        ViewGroup.LayoutParams.MATCH_PARENT, 1.0F);
                frameView.addView(childView, lp);
                // childView.setBackgroundResource (R.color.background1);
            }

        }
    }
}

public void setTitleFromActivityLabel(int textViewID) {

    TextView tv = (TextView) findViewById(textViewID);
    if (tv != null) {
        tv.setText(getTitle());
    }

}

@Override
protected Dialog onCreateDialog(int id) {
    switch (id) {
    case PROGRESS:
        PROGRESS_BAR = new ProgressDialog(this);
        PROGRESS_BAR.setTitle("Updater");
        PROGRESS_BAR.setMessage("Updating database");
        PROGRESS_BAR.setIndeterminate(false);
        PROGRESS_BAR.setMax(100);
        PROGRESS_BAR.setProgressStyle(ProgressDialog.STYLE_HORIZONTAL);
        PROGRESS_BAR.setCancelable(false);
        PROGRESS_BAR.show();
        return PROGRESS_BAR;
    default:
        return null;
    }
}

class Download extends AsyncTask<String, String, String> {
    Dashboard activity = null;

    Download(Dashboard activity) {
        attach(activity);
    }

    @Override
    protected void onPreExecute() {
        super.onPreExecute();
        showDialog(PROGRESS);
    }

    @Override
    protected String doInBackground(String... aurl) {
        try {
            URL url = new URL(fURL);
            HttpURLConnection con = (HttpURLConnection) url
                    .openConnection();
            con.setRequestMethod("GET");
            con.setDoOutput(true);
            con.connect();

            int fSIZE = con.getContentLength();

            FileOutputStream out = new FileOutputStream(new File(rDIR
                    + fDIR, fNAME));

            InputStream in = con.getInputStream();

            byte[] buffer = new byte[1024];
            int len = 0;
            long total = 0;

            while ((len = in.read(buffer)) > 0) {
                total += len;
                publishProgress("" + (int) ((total * 100) / fSIZE));
                out.write(buffer, 0, len);
            }
            out.close();
        } catch (Exception e) {

        }
        return null;
    }

    @Override
    protected void onProgressUpdate(String... progress) {
        if (activity == null) {

        } else {
            PROGRESS_BAR.setProgress(Integer.parseInt(progress[0]));
        }

        //PROGRESS_BAR.setProgress(Integer.parseInt(progress[0]));
    }

    @Override
    protected void onPostExecute(String fURL) {
        dismissDialog(PROGRESS);
    }

    void detach() {
        activity = null;
    }

    void attach(Dashboard activity) {
        this.activity = activity;
    }
}

public void dbDIR(String dirName) {
    File nDIR = new File(rDIR + dirName);
    if (!nDIR.exists()) {
        nDIR.mkdirs();
    }
}
 } 
```

# git - Git grep：即使单词存在于文件中，有时也会出现空结果

> ID：10180988
> 
> 赞同：1
> 
> 时间：2012-04-16T20:12:30.350
> 
> 标签：git, ubuntu, grep, response

我之前一直在寻找这个，但我找不到它。使用：Ubuntu 11.10 64 位

我想找到一个前一段时间制作的源文件，但找不到。所以我用 git grep 找到它：

```
git rev-list --all | (
    while read revision; do
        git grep -F 'leaderboard' $revision
    done
) 
```

但结果是一个空洞的回应！这真的很奇怪，因为“排行榜”实际上是在存储库中，它在当前版本中，但也在旧版本中（在 XML 文件中）：

```
<query name="leaderboard.getById"> 
```

其他搜索会给出结果，例如消息或某些东西会起作用。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-10T18:50:23.660

您的语法会导致 shell 中的重定向不明确。这应该适合你：

```
git grep -F 'leaderboard' $(git rev-list --all) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2018-06-03T23:01:04.697

注意：即使使用正确的 shell 语法，答案仍然可能是空的……当索引损坏时。

Git 2.18（2018 年第二季度，6 年后）现在避免了空洞的答案。

" " 无法读取索引时的错误行为`git grep`与其他使用该索引的命令不一致，已更正为提前报错。

请参阅[Stefan Beller ( ) 的](https://github.com/stefanbeller)[提交 b2aa84c](https://github.com/git/git/commit/b2aa84c789a032c60b81d6ad68527e3a9076b99b)（2018 年 5 月 15 日[）](https://github.com/stefanbeller)。^(（由)^([Junio C Hamano 合并 --](https://github.com/gitster)) ^([--](https://github.com/gitster))^在^([6ac5aca 提交中](https://github.com/git/git/commit/6ac5acae2d93f49f169d9b10dd9fcbce3fd874e2))^(，2018 年 5 月 30 日）)[`stefanbeller`](https://github.com/stefanbeller)
^([`gitster`](https://github.com/gitster))

> ## `grep`: 尽早处理损坏的索引文件
> 
> ' 的任何其他调用者都会`'repo_read_index`在它的负返回时死亡，所以 grep 也应该如此。

# php - 对对象数组进行排序

> ID：10180989
> 
> 赞同：0
> 
> 时间：2012-04-16T20:12:37.583
> 
> 标签：php, arrays, sorting, foreach

我已经阅读了一些不同的主题（[比如这个和关于](https://stackoverflow.com/questions/2146749/how-do-i-sort-the-following-array-stdclass-object-in-php)[uasort()](http://php.net/manual/en/function.uasort.php)的一般文档信息- 我相信这是我正在寻找的），但数组仍然有点固执（在我的使用中 -案子）。

这是我所拥有的：

```
// This sets an array of values to a variable
$collection_rows = get_field('collection_profiles'); 
```

这`print_r`是`$collection_rows`：

```
Array
(
    [0] => Array
        (
            [collection_profile] => Array
                (
                    [0] => stdClass Object
                        (
                            [ID] => 273
                            [post_author] => 1
                            [post_date] => 2012-03-26 07:53:45
                            [post_date_gmt] => 2012-03-26 13:53:45
                            [post_content] => 
                            [post_title] => Profile 1
                            [post_excerpt] => 
                            [post_status] => publish
                            [comment_status] => closed
                            [ping_status] => closed
                            [post_password] => 
                            [post_name] => profile-1
                            [to_ping] => 
                            [pinged] => 
                            [post_modified] => 2012-04-12 08:07:35
                            [post_modified_gmt] => 2012-04-12 14:07:35
                            [post_content_filtered] => 
                            [post_parent] => 0
                            [guid] => http://domain.com/?post_type=moulding_profiles&#038;p=273
                            [menu_order] => 0
                            [post_type] => moulding_profiles
                            [post_mime_type] => 
                            [comment_count] => 0
                            [ancestors] => Array
                                (
                                )

                            [filter] => raw
                        )

                )

            [collection_profile_note] => 1
        )

    [1] => Array
        (
            [collection_profile] => Array
                (
                    [0] => stdClass Object
                        (
                            [ID] => 188
                            [post_author] => 1
                            [post_date] => 2012-02-17 15:24:24
                            [post_date_gmt] => 2012-02-17 21:24:24
                            [post_content] => 
                            [post_title] => Test Profile
                            [post_excerpt] => 
                            [post_status] => publish
                            [comment_status] => closed
                            [ping_status] => closed
                            [post_password] => 
                            [post_name] => test-profile
                            [to_ping] => 
                            [pinged] => 
                            [post_modified] => 2012-02-28 14:13:32
                            [post_modified_gmt] => 2012-02-28 20:13:32
                            [post_content_filtered] => 
                            [post_parent] => 0
                            [guid] => http://domain.com/?post_type=moulding_profiles&#038;p=188
                            [menu_order] => 0
                            [post_type] => moulding_profiles
                            [post_mime_type] => 
                            [comment_count] => 0
                            [ancestors] => Array
                                (
                                )

                            [filter] => raw
                        )

                )

            [collection_profile_note] => 3
        )

    [2] => Array
        (
            [collection_profile] => Array
                (
                    [0] => stdClass Object
                        (
                            [ID] => 207
                            [post_author] => 1
                            [post_date] => 2012-02-23 13:35:55
                            [post_date_gmt] => 2012-02-23 19:35:55
                            [post_content] => 
                            [post_title] => Casing Test Profile
                            [post_excerpt] => 
                            [post_status] => publish
                            [comment_status] => closed
                            [ping_status] => closed
                            [post_password] => 
                            [post_name] => casing-test-profile
                            [to_ping] => 
                            [pinged] => 
                            [post_modified] => 2012-02-23 13:35:55
                            [post_modified_gmt] => 2012-02-23 19:35:55
                            [post_content_filtered] => 
                            [post_parent] => 0
                            [guid] => http://domain.com/?post_type=moulding_profiles&#038;p=207
                            [menu_order] => 0
                            [post_type] => moulding_profiles
                            [post_mime_type] => 
                            [comment_count] => 0
                            [ancestors] => Array
                                (
                                )

                            [filter] => raw
                        )

                )

            [collection_profile_note] => 2
        )

) 
```

（相当笨拙）

我正在寻找按数组键/值排序`collection_profile_note`。我尝试过的（到目前为止）是：

```
$collection_rows = get_field('collection_profiles');
print_r($collection_rows);
if ($collection_rows) {
    echo '<h2>'.__('Profiles in Collection','roots').'</h2>';
    echo '<ul>';
    function cmp($a, $b) {
        if ($a->collection_profile_note == $b->collection_profile_note) {
            return 0;
        } else {
            return $a->collection_profile_note < $b->collection_profile_note ? 1 : -1;
        }
    }
    usort($collection_rows, 'cmp');

    foreach($collection_rows as $collection_row) {
        // Extract single post value
        $collection_profile_field = $collection_row['collection_profile'];
        $collection_profile_page = isset($collection_profile_field[0]) ? $collection_profile_field[0]->ID : NULL;
        ?>
        <li><a href="<?php echo get_permalink($collection_profile_page); ?>"><?php echo get_the_title($collection_profile_page); ?></a> <?php echo $collection_row['collection_profile_note']; ?></li>
    <?php }
    echo '</ul>';
} 
```

虽然它确实改变了没有它显示的顺序，但`uasort()`它并没有按照我想要的方式排列它们 - > 使用函数 (2, 3, 1)，没有函数 (1, 3, 2)

任何帮助将不胜感激。谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-16T21:21:24.530

好吧，您已经向后实现了排序逻辑：

```
function cmp($a, $b) {
    if ($a->collection_profile_note == $b->collection_profile_note) {
        return 0;
    } else {
        return $a->collection_profile_note < $b->collection_profile_note ? 1 : -1;
    }
} 
```

从[文档中`uasort()`](http://us3.php.net/manual/en/function.uasort.php)：

```
function cmp($a, $b) {
    if ($a == $b) {
        return 0;
    }
    return ($a < $b) ? -1 : 1;
} 
```

请注意，您正在使用此逻辑：

*   如果a < b，则返回1（本质上是告诉排序函数a > b）
*   如果a > b，则返回-1（本质上是告诉排序函数a < b）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-16T21:22:55.977

你有必要对数组进行排序吗？分解您正在排序的键和值可能更容易，对它们进行排序，然后遍历该数组（像这样）：

```
$sortme=array();
foreach( $collection_rows as $key=>$profile )
{
    $sortme[$key] = $profile['collection_profile_note'];
}

asort($sortme);

foreach( $sortme as $node=>$ignore ) 
{
    print_r($collection_rows[$node]);
} 
```

承认这几乎使排序时间增加了一倍，但也许足以满足您的需求？

# perl - awk 笛卡尔积

> ID：10180990
> 
> 赞同：1
> 
> 时间：2012-04-16T20:12:40.247
> 
> 标签：perl, awk, normalize

我有大的制表符分隔的两列文本文件，如下所示：

```
...
"001R_FRG3G"    "81941549; 47060116; 49237298"
"002L_FRG3G"    "49237299; 47060117; 81941548"
"002R_IIV3" "106073503; 123808694; 109287880"
... 
```

如您所见，第二列不包含原子值。这就是为什么我想“规范化”这个文件，使其具有以下内容：

```
...
"001R_FRG3G"    "81941549"
"001R_FRG3G"    "47060116"
"001R_FRG3G"    "49237298"
"002L_FRG3G"    "49237299"
"002L_FRG3G"    "47060117"
"002L_FRG3G"    "81941548"
"002R_IIV3" "106073503"
"002R_IIV3" "123808694"
"002R_IIV3" "109287880"
... 
```

任何人都知道如何有效地做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-17T07:05:28.867

珀尔：

```
perl -lne '
s/[";]//g;
($a, @b) = split;
print qq("$a" "$_") for @b;
' FILE 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-16T21:08:22.527

```
awk '{for (i=2; i<=NF; i++) {gsub(/[";]/, "", $i); printf "%s%s\"%s\"", $1, OFS, $i; printf "%s", "\n"}}' inputfile 
```

对于 之后的每个字段`$1`，去掉引号和分号，然后打印`$1`后跟用引号括起来的字段内容。对输入文件中的每一行执行此操作。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-17T06:53:04.367

这可能对您有用（GNU awk）：

```
awk '{while(/;/) $0=gensub(/^((.*[ \t]").*);[ \t]*/,"\\1\"\n\\2",1)};1' file
"001R_FRG3G"    "81941549"
"001R_FRG3G"    "47060116"
"001R_FRG3G"    "49237298"
"002L_FRG3G"    "49237299"
"002L_FRG3G"    "47060117"
"002L_FRG3G"    "81941548"
"002R_IIV3" "106073503"
"002R_IIV3" "123808694"
"002R_IIV3" "109287880" 
```

或者，它不是 awk，但它优雅地解决了问题。

```
sed -i ':a;s/\(\(.*\s"\).*\);\s*/\1"\n\2/;ta' file
"001R_FRG3G"    "81941549"
"001R_FRG3G"    "47060116"
"001R_FRG3G"    "49237298"
"002L_FRG3G"    "49237299"
"002L_FRG3G"    "47060117"
"002L_FRG3G"    "81941548"
"002R_IIV3" "106073503"
"002R_IIV3" "123808694"
"002R_IIV3" "109287880" 
```

# opengl - 在渲染可能显示或不显示的网格时如何处理 VBO？

> ID：10180996
> 
> 赞同：0
> 
> 时间：2012-04-16T20:12:51.270
> 
> 标签：opengl, vbo

我正在开发一款多人游戏，并将在玩家附近显示其他玩家。玩家附近最多可以有 16 个玩家，但也可能有 0 个。我想做的是设置 16 个空 VBO，以便在客户端接收到它们时准备好加载角色的位置。创建空的 VBO 是否有效？如果不是，我应该如何根据服务器向客户端发送的内容来渲染可能存在或不存在的数据？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-16T20:21:25.190

你的问题让我很困惑。为什么使用 VBO 来存储位置？VBO 可以只拥有您正在绘制的任何顶点，并且您可以在绘制时根据 modelMatrix 移动位置。

简单的伪代码：

```
LoadVBO(player_model);

for(int i=0;i<16;i++){
  if(player[i].visible) {
    modelMatrix = player[i].position;
    glUniform(modelMatrix);
    DrawVBO(player_model);
  }
} 
```

如果这还不够，请提供更多信息。为什么要尝试绘制一个空的 vbo，而不仅仅是设置一个跳过绘制调用的标志？