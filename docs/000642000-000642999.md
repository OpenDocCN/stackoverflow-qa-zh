# StackOverflow 问答 000642000-000642999

# sql - 弃用数据库模式中的列的最佳方法是什么？

> ID：642000
> 
> 赞同：13
> 
> 时间：2009-03-13T09:55:28.567
> 
> 标签：sql, mysql, database

在阅读了这里关于数据库模式迁移和版本的许多问题之后，我想出了一个在更新过程中安全更新数据库模式的方案。基本思想是，在更新期间，我们将数据库导出到文件，删除并重新创建所有表，然后重新导入所有内容。那里没有什么太花哨或冒险的东西。

问题是这个系统有点“病毒”，这意味着只有*添加*列或表是安全的，因为删除它们会在重新导入数据时导致问题。通常，我可以忽略这些列，但问题是许多已删除的项目实际上已被重构，代码中旧项目的存在使其他程序员误以为他们可以使用它们。

所以，我想找到一种方法来将列或表标记为已弃用。在理想情况下，不推荐使用的对象将在更新架构时被标记，但在下一次更新期间，我们的备份脚本将根本不选择以这种方式标记的对象，从而允许我们最终逐步淘汰架构的这些部分.

我发现 MySQL（可能还有其他数据库平台，但这是我们正在使用的平台）支持字段和表的 COLUMN 属性。这将是完美的，除了我无法弄清楚如何以有意义的方式实际使用它。我将如何编写 SQL 查询来获取所有*不*包含包含“已弃用”一词的注释匹配文本的列名？还是我看这个问题全错了，错过了更好的方法来做到这一点？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-03-13T10:10:35.783

也许您应该重构以在表上使用视图，其中视图永远不会包含已弃用的列。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-13T12:51:38.063

“[弃用](http://en.wikipedia.org/wiki/Deprecation)”通常意味着（至少对我而言）某些东西被标记为在将来某个日期删除，不应该被新功能使用，并且将在现有代码中被删除/更改。

我不知道“标记”已弃用的列的好方法，除了重命名它，这可能会破坏事情！即使有这样的设施，它究竟有多大用处？

那么您真的要弃用或删除吗？从你的问题的内容来看，我猜是后者。

我有一种令人讨厌的感觉，您可能处于“如果我想到达那里，我不会从这里开始”的情况之一。然而，这里有一些想法浮现在脑海：

1.  阅读[持续数据库集成的食谱，](http://databaserefactoring.com/)这似乎解决了您的大部分问题领域

2.  显式删除该列。在 MySQL 5.0（甚至更早版本？）中，该工具作为 DDL 的一部分存在：请参阅[ALTER TABLE](http://dev.mysql.com/doc/refman/5.0/en/alter-table.html)语法。

3.  看看[ActiveRecord::Migration](http://api.rubyonrails.org/classes/ActiveRecord/Migration.html)在 Ruby 中是如何工作的。迁移可以包含“remove_column”指令，它将以适合平台的方式处理问题。从个人经验来看，它绝对适用于 MySQL。

4.  针对您的导出运行脚本以从 INSERT 语句（列和值列表）中删除该列。如果您的数据库相当小，可能非常可行，我猜如果您按照描述导出并重新导入它，它一定是可行的。

# c# - 为什么 RhinoMock 没有通过这个测试？

> ID：642005
> 
> 赞同：0
> 
> 时间：2009-03-13T09:58:53.753
> 
> 标签：c#, rhino-mocks

我现在有一堂课是这样的：

```
public class MyClass {

    public void Method1(){
        if (false) {
            Method2();
        }
    }

    public void Method2(){
        //do something here
    }
} 
```

所以 Method2 永远不会被调用（我的代码看起来有点不同，但我有这个 if 子句的计算结果为 false，因此不执行 Method2。通过调试检查它以确定）。我想告诉 RhinoMocks 我希望 Method2 被调用并且测试失败：

```
MockRepository mock = new MockRepository();
MyClass presenter = mock.PartialMock<MyClass>();

Expect.Call(() => presenter.Method2()).IgnoreArguments();

mock.ReplayAll();
presenter.Method1();
mock.VerifyAll(); 
```

...但是测试通过了。

（Expect.Call 中 lambda 表达式的原因是，我的实际 Method2 有参数）

我的问题：

*   这是在这种情况下进行测试的常用方法吗？（我只是从 RhinoMocks 和一般的模拟框架开始）
*   为什么测试会通过？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-13T10:06:41.987

正如 Jakob 的评论所证实的那样，`PartialMock`仅模拟抽象/虚拟方法，因此您的期望实际上并没有做任何事情。

就我个人而言，我通常不会在我正在测试的类中模拟方法。我只是模拟了依赖关系，并通过接口而不是具体的类来表达它们，从而避免了这个问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-13T13:41:34.310

我认为部分模拟具体类有很多价值。例如，假设您有几个在类中被调用的私有方法。您显然需要在测试之前将它们设为“内部”，但您希望有一种方法来测试它——无需创建新类（在很多情况下这不是正确的解决方案）。

要使此测试失败，您只需使用方法 2 的签名即可：

公共虚拟 void Method2(){}

# php - 在 wordpress 中创建的 cookie（最新）

> ID：642007
> 
> 赞同：1
> 
> 时间：2009-03-13T09:58:59.290
> 
> 标签：php, security, authentication, wordpress, cookies

我刚刚安装了 wordpress（最新的）并且我试图研究 wordpress 以使我的创作像 wordpress 那样安全或达到它的水平。

我注意到登录 wordpress 时，它创建了 3 个 cookie。

我想弄清楚的是 - 在登录 wordpress 并为用户创建 cookie 之后。插入 cookie 的哈希值，该值如何验证用户是谁？我将存储在 cookie 中的值与存储在名为 wp_users 的数据库表中的值进行匹配，但它不匹配..

我通常在注册时验证用户时做的是我将在表中有一列称为 tbl_users 称为 hash 并且该列中的值将是用户名的 sha1 转换（用户在注册时创建） . 并在登录页面登录并通过检查用户是否存在于数据库中等方式对用户进行身份验证后。我会为那个用户创建一个 cookie。在 cookie 中，我将插入数据库中存在的哈希并将其存储在 cookie 中。这就是我通过页面跟踪用户的方式。有人知道wordpress是怎么做的吗？或者我做错了？我不知道..

提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-13T10:24:30.353

如果用户身份验证哈希在 cookie 中，则可以读取它，并且由于它已经直接匹配数据库中的内容，因此任何知道如何查看 cookie 的人都可以使用它。Wordpress 对用户哈希应用了一点后处理，我认为它在 wp_settings.php 中。

我认为它将用户哈希与您写入 wp_config.php 中的变量之一的唯一键相结合。之后，您将拥有一个唯一的密钥，该密钥由公开可用的内容（例如用户名哈希或其他任何内容）以及仅在脚本中可用的内容（即。不公开。正是这种组合与数据库中的内容相匹配并对用户进行身份验证。

希望这是有道理的。其他一些人可能能够就 PHP 安全性向您提供更好的建议，因此您可能想让您的问题更笼统。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-23T20:48:44.673

我会查看 MD5 加密，然后尝试使用它在您的 wordPress 数据库中进行验证。我没有尝试过，但我想做同样的事情。

只是给你一个便条。当我在创建 web 应用程序时遇到同样的问题时，我避免处理这个问题，只是决定使用 wordpress 作为我的应用程序的包装器。您可以直接登录到您选择的模板，该模板可以是一个 PHP 页面，因此一旦进入，您就可以做任何您喜欢的事情，但您的应用程序将受到 Wordpress 的保护，并且它们会随着事情的变化而更新其安全性。到目前为止，对我来说，这是一个双赢的安排。

我使用 wordPress 本身验证我的用户。您可以调用 Wordpress 中存在的函数来验证谁已登录并使用您的应用程序。然后，您可以利用 wordpress 所提供的一切。我喜欢在 wordPress 管理面板中使用 PHPMyAdmin。这让我最近的生活变得异常轻松，我不必担心我对安全性的不了解。如果您在没有安全专家的情况下进行开发，这对您来说可能是一个不错的选择。如果您想了解更多关于我如何设置它的信息，请告诉我。

# c# - WPF 丢失数据绑定

> ID：642010
> 
> 赞同：1
> 
> 时间：2009-03-13T09:59:22.800
> 
> 标签：c#, .net, wpf, data-binding

我是 WPF 及其数据绑定的新手，但我偶然发现了一种我自己无法解决的奇怪行为。

在一个对话框中，我有一个带有用户的列表框和一个用于用户名的文本框。两者都绑定到 UserLogonLogic，其中发布了一个`CurrentUser`属性。

当我单击 ListBox 中的名称时，我希望 TextBox 更新其文本。`SelectedItem`当我将用户名直接输入到 TextBox 时，我还希望更新 ListBox 中的 。TextBox 中的部分名称将被解析为列表框中的第一个匹配值，如果没有，则为 null。

起初，每次单击 ListBox 时，TextBox 都会更新。调试告诉我，每次触发`PropertyChangeEvent`for时都会调用方法方法。只有在我在文本框中输入了一些内容之后，TextBox 的内容才似乎丢失了。当我单击列表框时，文本框不会有进一步的更新。Debug 现在向我显示，在触发后不再调用该方法。`CurrentUser``txtName_TextChanged``DataBinding``txtName_TextChanged``CurrentUser` `PropertyChangeEvent`

有人知道我哪里出错了吗？

非常感谢
茹

用户登录.xaml：

```
 <ListBox Grid.Column="0" Grid.Row="1" Grid.RowSpan="4" MinWidth="100" Margin="5" Name="lstUser" MouseUp="lstUser_MouseUp"
             ItemsSource="{Binding Path=Users}" SelectedItem="{Binding Path=CurrentUser, Mode=TwoWay}"/>
    <TextBox Grid.Column="1" Grid.Row="1" Margin="3" Name="txtName" TextChanged="txtName_TextChanged"
             Text="{Binding Path=CurrentUser, Mode=OneWay}" /> 
```

UserLogon.xaml.cs：

```
 public UserLogon()
    {
        InitializeComponent();

        _logic = new UserLogonLogic();
        TopLevelContainer.DataContext = _logic;
    }

    private int _internalChange = 0;
    private void txtName_TextChanged(object sender, TextChangedEventArgs e)
    {
        if (_internalChange > 0)
        {
            return;
        }

        _internalChange++;
        string oldName = txtName.Text;
        User user = _logic.SelectByPartialUserName(oldName);
        string newName = (user == null) ? "" : user.Name;

        if (oldName != newName)
        {
            txtName.Text = (newName == "") ? oldName : newName;
            txtName.Select(oldName.Length, newName.Length);
        }
        _internalChange--;
    } 
```

UserLogon.Logic.cs：

```
public class UserLogonLogic : INotifyPropertyChanged
{
    private User _currentUser;
    public User CurrentUser
    {
        get { return _currentUser; }
        set
        {
            if (value != CurrentUser)
            {
                _currentUser = value;
                OnPropertyChanged("CurrentUser");
            }
        }

    private IEnumerable<User> _users;
    public IEnumerable<User> Users
    {
        get
        {
            if (_users == null)
            {
                List<User> _users = Database.GetAllUsers();
            }
            return _users;
        }
    }

    public event PropertyChangedEventHandler PropertyChanged;
    public void OnPropertyChanged(string prop)
    {
        if (PropertyChanged != null)
        {
            PropertyChanged(this, new PropertyChangedEventArgs(prop));
        }
    }

    public User SelectByPartialUserName(string value)
    {
        if (value != "")
        {
            IEnumerable<User> allUser = GetAllUserByName(value);
            if (allUser.Count() > 0)
            {
                CurrentUser = allUser.First();
            }
            else
            {
                CurrentUser = null;
            }
        }
        else
        {
            CurrentUser = null;
        }

        return CurrentUser;
    }

    private IEnumerable<User> GetAllUserByName(string name)
    {
        return from user in Users
               where user.Name.ToLower().StartsWith(name.ToLower())
               select user;
    }
} 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-03-13T10:42:57.797

这是一个好的视图模型的工作。在视图模型上定义两个属性：

*   `SelectedUser : User`
*   `UserEntry : string`

`ListBox`将's绑定`SelectedItem`到`SelectedUser`属性，并将`TextBox`'属性绑定`Text`到`UserEntry`属性。然后，在您的视图模型中，您可以进行工作以使它们保持同步： - 如果`SelectedUser`更改，则设置`UserEntry`为该用户的`Name` - 如果`UserEntry`更改，则对所有用户进行智能搜索并设置`SelectedUser`为`null`如果未找到匹配项，或者设置为第一个匹配项`User`

这是一个完整且有效的示例。我希望我现在可以轻松地附加一个 zip 文件。

首先，*ViewModel.cs*：

```
public abstract class ViewModel : INotifyPropertyChanged
{
    private readonly Dispatcher _dispatcher;

    protected ViewModel()
    {
        if (Application.Current != null)
        {
            _dispatcher = Application.Current.Dispatcher;
        }
        else
        {
            _dispatcher = Dispatcher.CurrentDispatcher;
        }
    }

    public event PropertyChangedEventHandler PropertyChanged;

    protected Dispatcher Dispatcher
    {
        get { return _dispatcher; }
    }

    protected virtual void OnPropertyChanged(PropertyChangedEventArgs e)
    {
        var handler = PropertyChanged;

        if (handler != null)
        {
            handler(this, e);
        }
    }

    protected void OnPropertyChanged(string propertyName)
    {
        OnPropertyChanged(new PropertyChangedEventArgs(propertyName));
    }
} 
```

*用户.cs*：

```
public class User : ViewModel
{
    private readonly string _name;

    public User(string name)
    {
        _name = name;
    }

    public string Name
    {
        get { return _name; }
    }
} 
```

*登录视图模型.cs*：

```
public class LogonViewModel : ViewModel
{
    private readonly ICollection<User> _users;
    private User _selectedUser;
    private string _userEntry;

    public LogonViewModel()
    {
        _users = new List<User>();
        //fake data
        _users.Add(new User("Kent"));
        _users.Add(new User("Tempany"));
    }

    public ICollection<User> Users
    {
        get { return _users; }
    }

    public User SelectedUser
    {
        get { return _selectedUser; }
        set
        {
            if (_selectedUser != value)
            {
                _selectedUser = value;
                OnPropertyChanged("SelectedUser");
                UserEntry = value == null ? null : value.Name;
            }
        }
    }

    public string UserEntry
    {
        get { return _userEntry; }
        set
        {
            if (_userEntry != value)
            {
                _userEntry = value;
                OnPropertyChanged("UserEntry");
                DoSearch();
            }
        }
    }

    private void DoSearch()
    {
        //do whatever fuzzy logic you want here - I'm just doing a simple match
        SelectedUser = Users.FirstOrDefault(user => user.Name.StartsWith(UserEntry, StringComparison.OrdinalIgnoreCase));
    }
} 
```

*用户登录.xaml*：

```
<UserControl x:Class="WpfApplication1.UserLogon"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    Height="300" Width="300">
    <StackPanel>
        <ListBox ItemsSource="{Binding Users}" SelectedItem="{Binding SelectedUser}" DisplayMemberPath="Name"/>
        <TextBox Text="{Binding UserEntry, UpdateSourceTrigger=PropertyChanged}"/>
    </StackPanel>
</UserControl> 
```

*UserLogon.xaml.cs*：

```
public partial class UserLogon : UserControl
{
    public UserLogon()
    {
        InitializeComponent();
        //would normally map view model to view with a DataTemplate, not manually like this
        DataContext = new LogonViewModel();
    }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-13T10:12:48.023

你的文本框不应该有双向绑定吗？

# c# - 组合框改回 SelectedIndex C#

> ID：642011
> 
> 赞同：1
> 
> 时间：2009-03-13T09:59:38.850
> 
> 标签：c#, combobox

在我的 comboBox2_SelectedIndexChanged 事件中，我进行了一些处理，在某些情况下，我想将 SelectedIndex 更改回更改之前的状态。我看到 sender.selectedIndex 是我使用的最后一个索引，但是我无法访问该 var。我如何告诉组合框回到原来的状态？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-13T10:11:53.580

请参阅下面的代码。如果情况满足您将所选索引设置为 lastIndex，则在设置 lastIndex 时，请确保取消订阅选择事件，设置并重新订阅。每次通过将 lastIndex 设置为 selectedIndex 来跟踪它。

```
 int lastIndex=0;
    void comboBox2_SelectedIndexChanged(object sender, EventArgs e)
    {            
        if (isItTheCase) 
        {
            comboBox2.SelectedIndexChanged -= new EventHandler(comboBox2_SelectedIndexChanged);
            comboBox2.SelectedIndex = lastIndex;
            comboBox2.SelectedIndexChanged += new EventHandler(comboBox2_SelectedIndexChanged);
        }
        lastIndex = comboBox2.SelectedIndex;
    } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-03T07:16:31.697

请检查您多次注册 SelectedIndexChanged 的​​任何地方。通常情况下，您在设计时注册事件，该事件进入 Initilizecomponent() 方法，然后在构造函数中注册。

谢谢

# c# - 使用 COM 和 C# 的多线程应用程序中的内存泄漏

> ID：642015
> 
> 赞同：0
> 
> 时间：2009-03-13T10:00:54.730
> 
> 标签：c#, multithreading, com, interop, memory-leaks

我编写了一个多线程非托管应用程序，它在其工作线程中使用 COM 对象。一切都很顺利，直到我开始使用导出为 COM 的 .NET 对象来完成这项工作。

玩弄代码并注释掉部分 .NET 对象功能，我设法将其归结为在 .NET 对象中使用 COM 对象。总结一下：

1.  我的程序启动了几个工作线程。
2.  每个工作线程初始化一个基于 .NET 的 COM 对象来完成工作。
3.  基于 .NET 的 COM 对象在内部使用非托管 COM 对象。

令我惊讶的是，应用程序的内存消耗开始稳步上升，直到 OutOfMemory 异常开始出现。

这是我的 .NET 实现：

```
void DoSomeWork()
{
    IComObject O = new ComObjectClass();
    try
    {
        // do something
    }
    finally
    {
        Marshal.ReleaseComObject(O);
    }

} 
```

如果我注释掉这个函数，内存泄漏就会消失。如果我在其中调用 GC.Collect() ，内存泄漏仍然会发生。

关于可能发生的事情的任何想法？

编辑：基于评论和答案的更多信息：

1.  创建的所有线程都在 MTA 中运行。
2.  所有 COM 对象都实现 IMarshal 并使用 Free Threaded Marshaler。
3.  做什么都没关系 - 甚至是 int i=0;i++; 产生泄漏。
4.  ComObjetClass 指出的对象是旧的并且经过测试。这并不意味着它没有故障，但不是什么明显的东西。
5.  我尝试在主线程和另一个创建的线程上从 C# 程序重复创建 COM 对象。在这两种情况下，内存泄漏都消失了。似乎从非托管代码到托管代码的交叉是必不可少的。删除它的任何部分都会导致问题消失。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-13T10:21:01.843

可能是您的 COM 包装器对象需要切换到 STA 线程才能完成。如果您的 STA 不发送消息，这将永远不会发生，因此永远不会调用 finalize，这反过来会导致内存泄漏。

[此 KB](http://support.microsoft.com/kb/828988)中有更多信息。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-08-05T23:59:36.673

嗨，建议您使用以下代码和平。

```
 if (feature != null) 
        { 
            while (Marshal.ReleaseComObject(feature) > 0) 
            { }
            feature=null;
        } 
```

如果您使用 com 对象作为引用类型。前任。光标。如果你只是在做 Marshal.ReleaseComObject(O);

比它只释放一个引用，其余的引用将保留在内存中，这样更好地释放所有引用。

# asp.net - 我的 default.aspx.vb 无法在同一文件夹中看到另一个 myclass.cs 文件！

> ID：642020
> 
> 赞同：0
> 
> 时间：2009-03-13T10:02:54.100
> 
> 标签：asp.net, vb.net

我正在尝试使用 aspx.vb 中的 myclass.cs，但是当我发出命令时收到错误“myclass not declared”：

导入 myclass

任何想法如何做参考？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-13T10:11:52.363

1.  确保您宣布您的班级**public**。

2.  将您的 C# 类放入 App_Code 文件夹。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-13T10:07:57.130

将 .cs 文件复制到 App_Code 文件夹，您应该可以导入它。[您可以在此处](http://msdn.microsoft.com/en-us/library/t990ks23.aspx)阅读有关 App_Code 文件夹的更多信息。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-13T10:08:46.007

您不能在同一个项目中混合使用 C# 和 VB.NET 代码文件。您需要添加一个包含 myclass.cs 的新 C# 类库项目，然后从您的 VB 项目中添加对该项目的引用。

* * *

编辑：显然我错了。如果您将 .cs 文件放在 App_Code 文件夹中，您实际上可以在 Web 项目中混合使用 VB 和 C#。你每天学习新的东西 ：-）

# c# - 在c#中调用我自己的事件代码和自定义事件代码

> ID：642025
> 
> 赞同：1
> 
> 时间：2009-03-13T10:04:54.080
> 
> 标签：c#, events, controls

我制作了一个带有自定义富文本框控件的 WinForms 应用程序。

我在我的项目中将它称为 Windows 控件（一个 dll 文件）。在我的richtextbox 程序中，我在它的textchanged 事件中编写了功能。

我只想在触发 textchanged 事件后或以其他方式将文本添加到文本框后做额外的工作。像我想在 text_changedevent 中调用函数 foo() 之类的东西。它只调用 foo 并且无法处理底层的 textchanged 事件。

在 C# 中，我可以让它首先处理内部 textchanged 事件，然后查看我的文本更改事件吗？

想想我为 mytextbox_textchanged 编写代码的场景

```
private void txt_code_TextChanged(object sender, EventArgs e)
    {
        //some code which will always be called whenever textchanged event occurs.
    } 
```

现在我在我的项目中继承了这个控件，比如 MyApp1。在这里，我有一个标签，我想在其中显示文本框中包含的行数。所以我会写

```
private void my_inherited_txt_code_TextChanged(object sender, EventArgs e)
    {
        //code to update the label with my_inherited_txt_code.lines.length
    } 
```

所以我的问题是，我首先希望调用 txt_code_TextChanged 事件，然后执行 my_inherited_txt_code_TextChanged 中编写的代码。通过写作解决了

```
private void my_inherited_txt_code_TextChanged(object sender, EventArgs e)
    {
        base.OnTextChanged(e);
        MessageBox.Show("foo");
    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-13T10:08:07.410

你的意思是：

```
protected override void OnTextChanged(EventArgs e)
{
    base.OnTextChanged(e);
    // your code here...
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-13T10:07:25.680

我不明白为什么你不能从 text_changed 事件中调用方法？您是否收到任何错误或究竟发生了什么？

# java - 使用 Netbeans / ant 部署 java（命令行）应用程序

> ID：642028
> 
> 赞同：1
> 
> 时间：2009-03-13T10:05:19.040
> 
> 标签：java, deployment, netbeans, ant

我终于设法从一个旧的独立（不是 Web-）Java 应用程序创建了一个 Netbeans 项目，该应用程序只包含单个 .java 源。现在我基本上有两个关于 Netbeans Subversion 交互和应用程序部署的问题：

1.  您是否通常将所有 Netbeans 项目文件签入到存储库中？

2.  如果我使用 Netbeans（或 ant）构建项目，我会得到一个 .jar 文件和一些额外的 jar 库。为了使应用程序在服务器上正常运行，需要一些额外的配置文件和目录（例如 log/）。应用程序本身是一个 J2SE 应用程序（无框架），它从 Linux 平台上的命令行运行。您将如何部署和安装这样的应用程序？如果我能看到当前安装了哪个版本的应用程序（也许通过将版本号附加到已安装的应用程序路径），那也很好。

感谢您的任何提示。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-13T18:34:30.923

1.  不，通常不会。任何特定于 NetBeans（或 Eclipse、IntelliJ 等）的东西，我都不会检查；尝试使用您的 ant 脚本从命令行构建它并准确生成您想要的内容。build.xml 可以用于其他 IDE，或者与 Anthill 或 CruiseControl 一起用于自动构建/持续集成，因此应该签入。签入生成/创建工件所需的内容。

2.  您不指定什么类型的服务器，或什么确切类型的应用程序。一些应用程序通过 JNLP/WebStart 部署以供多个用户下载，并且与独立部署的应用程序具有不同的规则，以便服务器上的一个用户在没有 GUI 的情况下作为监控应用程序运行。除非您可以提供有关您的应用程序、服务器环境等的更多详细信息，否则我无法为您提供更多帮助。关于配置文件，您如何访问这些文件？它们是静态的并且永远不会改变（您可以使用 ResourceBundle 加载的东西）？? 您可以将它们添加到 jar 文件中以在 ResourceBundle 中查找它们，但这完全取决于您在那里执行的操作。如果它们必须在 jar 文件之外进行修改而不重新编译，请使用安装程序脚本将它们复制。至于目录，它们必须已经存在吗？或者应用程序是否检查它们的存在，并在必要时创建它们？如果应用程序可以在不存在的情况下创建它们，则您无需创建它们。如果它们需要在那里，您可以将其作为安装脚本的一部分，以便在安装 jar 文件之前创建这些文件夹。版本号可以像在应用程序的某处添加关于框一样简单，然后在 config/properties 文件中查找版本字符串。它必须被维护，但至少你可以访问一些东西，让你知道你已经部署了构建 9876.5.4.321（或你使用的任何版本编号方案）。您可以将其作为安装脚本的一部分，以便在安装 jar 文件之前创建这些文件夹。版本号可以像在应用程序的某处添加关于框一样简单，然后在 config/properties 文件中查找版本字符串。它必须被维护，但至少你可以访问一些东西，让你知道你已经部署了构建 9876.5.4.321（或你使用的任何版本编号方案）。您可以将其作为安装脚本的一部分，以便在安装 jar 文件之前创建这些文件夹。版本号可以像在应用程序的某处添加关于框一样简单，然后在 config/properties 文件中查找版本字符串。它必须被维护，但至少你可以访问一些东西，让你知道你已经部署了构建 9876.5.4.321（或你使用的任何版本编号方案）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-13T12:33:21.697

理想情况下，您不应将应用程序源和配置绑定到特定的 IDE。

提问式，

*   我建议你不要。使您的存储库结构独立于 IDE
*   您可能必须更改您的应用程序，使其结构非常通用，并且可以在任何 IDE 中进行编辑。

    这是一个网络应用程序吗？一个独立的 Java 应用程序？如果您澄清这些，将更容易回答您的问题。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-13T12:48:29.460

我们不检查 /build 或 /dist 目录。

我们倾向于在 SVN 中为我们的 Netbeans 项目使用这种结构：

```
 /project1/
          /trunk
          /tags/
               /1.0
               /1.1
          /binaries/
                   /1.0
                   /1.1 
```

当需要更改时，我们从 trunk/ 签出 netbeans 项目并对其进行更改并重新签入。一旦需要发布项目，我们将 netbeans 项目文件的 SVN 副本复制到下一个标记版本。我们还获取可部署（JAR 或 WAR）的副本，并将其与任何依赖项和配置文件一起放在二进制文件下的版本目录中。

通过这样做，我们有一个干净的、版本化的可部署，它与源代码是分开的。可部署项是名称中的版本 - project1-1.0.jar、project1-1.1jar 等等。

我不同意 talonx 关于保持您的源代码非 IDE 特定的观点——通过不将 IDE 文件与您的源代码一起存储在 SVN 中，您会为签出、更改、签入、部署周期增加额外的复杂性。如果您将 IDE 项目文件存储在 SVN 中，您可以简单地签出项目，启动 IDE 并点击构建。您不必经历在 IDE 中设置新项目的步骤，包括您 SVNed 的文件、设置依赖项等。它节省了时间，意味着所有开发人员都使用相同的设置，从而减少了错误和差异. 您最不希望的事情是让开发人员检查项目以进行小错误修复，并且必须花时间查找依赖项并进行设置。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2010-03-20T02:35:49.353

回答问题 #2——谁是这个应用程序的消费者？如果它是一个内部应用程序并且只有您（或其他开发人员）将部署它，那么您所拥有的一切都很好。放入解释所需目录的 README 文件。

如果您将其发送给客户端进行安装，那是一个不同的问题，您应该使用安装程序。有一些安装程序可以包装 ant 脚本和您的资源，这是一个很好的方法，特别是如果您不需要 GUI……只需编写一个简单的 ant 脚本即可将所有内容放在正确的位置。

版本号由您决定——命名 JAR 并不是一个坏主意。我也有开机打印版本号的习惯，可以派上用场。

# spring-webflow - 是否必须将“模型”声明为“var”才能在 Spring Webflow 2 中绑定到它？

> ID：642033
> 
> 赞同：1
> 
> 时间：2009-03-13T10:07:37.273
> 
> 标签：spring-webflow

我目前正在使用 Spring Webflow 2，并且在实际为流编写所有 JSP 之前，我一直在为流编写单元测试。出于某种原因，我的 requestParameters 没有绑定到我的模型对象。我在进入绑定到它的视图状态之前创建模型对象（而不是在流中将其声明为“var”）。我已经仔细检查了所有参数名称/模型对象属性，一切正常，但由于某种原因，它只是没有绑定。有人知道为什么吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-13T12:22:19.070

您是指[参考文献第 14 章中](http://static.springframework.org/spring-webflow/docs/2.0.x/reference/html/ch14.html)的单元测试吗？如果是这样，由于我尚未理解的原因，该模型不会在这些测试中绑定。Spring Web Flow 模拟不模拟绑定部分。

另请参阅[此类似问题](https://stackoverflow.com/questions/227532/how-do-i-pass-model-data-beween-a-view-state-and-action-state-in-spring-web-flow)。

在他们解决此问题之前，您只需在测试中自己进行绑定，将对象的字段设置为您在流程中设置的参数。但我知道，这不是一个非常令人满意的测试。

# oracle - dblink 上的 Oracle sql 类型

> ID：642035
> 
> 赞同：1
> 
> 时间：2009-03-13T10:07:39.300
> 
> 标签：oracle, collections, user-defined-types, dblink

我有两个模式：A 和 B (Oracle 9)。在 A 处有一个到 B 的 dblink。在 B 处有一个包，我从 A 调用它。B 包中的过程可以返回不同的计数结果，因此我认为返回一个集合是更好的方法。

```
create type B.tr_rad as object (
  name     varchar2(64)
 ,code     number
 ,vendor   number
 ,val      varchar2(255)
 ,num      number
);

create type B.tt_rad as varray(256) of B.tr_rad; 
```

但是从 A 方案我不能使用 tt_rad 类型，因为不支持通过 dblink 使用 SQL 类型。DBMS_SQL 不支持游标。创建具有相同 OID 的类型是不可能的。

我认为使用临时表。但首先它不是那么好（远程函数返回值后，调用方必须从远程表中选择集合）。人们担心临时表的工作会放缓。

也许谁知道替代交互？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-13T21:40:13.193

我过去也遇到过类似的问题。然后我得出结论，从根本上来说，Oracle 的数据库链接除了简单的 SQL 类型（尤其是 UDT、CLOBS 可能有问题，XMLType 也可能有问题）之外的任何东西都“损坏”了。如果您可以使 OID 解决方案正常工作，那么祝您好运。

我采用的解决方案是使用 Java 存储过程，而不是 DB Link。

Java存储过程的特点：

1.  可以返回“丰富的类型集”，几乎所有的复杂类型（UDT、表/数组/变量）请参阅[Oracle 在线文档](http://download.oracle.com/docs/cd/B28359_01/java.111/b31225/chsix.htm#BABEBDGB)了解详细信息。与从 DBLink 相比，Oracle 在从 java 编组复杂（或丰富）类型方面做得更好。
2.  存储的 Java 可以获得“默认连接”（在与数据库的 SQL 连接相同的会话中运行 - 没有身份验证问题）。
3.  存储的 Java 调用远程 DB 上的 PL/SQL 过程，Java JDBC 层从远程 DB 进行编组。
4.  存储的 Java 将结果打包并将结果返回给 SQL 或 PL/SQL 层。

这有点工作，但如果你有一点 java 知识，你应该能够从 Oracle 文档和示例中“剪切和粘贴”一个解决方案。

我希望这有帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-13T11:36:21.520

看到这个现有的讨论

[通过 dblink 引用 oracle 用户定义的类型](https://stackoverflow.com/questions/378299/referencing-oracle-user-defined-types-over-dblink)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-13T13:35:48.740

另一种交互方式是拥有**一个**具有模式 A 和 B 的数据库，而不是两个具有数据库链接的数据库。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-17T09:03:25.873

我的解决方案。在**B**侧，我创建了临时表，例如收集记录。在**A**端，我有一个 DBMS_SQL 包装器，它通过 dblink 调用过程。此过程将结果集合写入临时表中。成功完成远程过程后，我从远程临时表中选择结果并将其转换为本地集合类型。

限制 1\. 需要永久对象同步。2\. SQL查询中不可能使用A端过程（即调用远程过程）。3.使用的复杂性。

# javascript - Firefox onkeydown 检测按下的键

> ID：642040
> 
> 赞同：9
> 
> 时间：2009-03-13T10:08:27.677
> 
> 标签：javascript, html, firefox

从输入文本中，我需要调用一个函数来捕获 onkeydown 事件，并且我需要将参数传递给该事件，例如：

```
<input type="text" onkeydown="TextOnKeyDown('myPrefix');" />... 
```

然后在那个函数中我需要知道按下了什么键。我用

```
function TextOnKeyDown(prefix) {
    var key = event.keyCode; 
    ...
} 
```

这在 IE 中就像一个魅力，但在 Firefox 中却不是。我已经读过，对于 Firefox，您必须将参数传递给处理程序，然后使用它来获取密钥，类似于：

```
<input type="text" onkeydown="detectKey(event)"/>
...
function detectKey(e){
     var key = (document.all) ? e.keyCode : e.which; 
     ...    
} 
```

但是我无法传递我的参数和firefox所需的事件参数。有什么建议么？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-03-13T10:34:26.240

我昨天写的，在 FF 和 IE 中都可以使用 =>

```
//execute this during initialization
document.onkeydown = function(event) {
    var holder;
    //IE uses this
    if(window.event) {
        holder = window.event.keyCode;
    }
    //FF uses this
    else {
        holder = event.which;
    } 
    keyz(holder);
}

function keyz(key) {
    if(key === /*desired code*/) {
        /*execute stuff*/
    }
} 
```

你会想用 [你的输入].onkeydown 替换 document.onkeydown

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-03-13T10:14:13.153

我在Firefox中使用它并且它有效：

```
<input .... onkeypress="return isNumberKey(event);"> 
```

然后是js函数：

```
function isNumberKey(evt)
{
    var charCode = (evt.which) ? evt.which : evt.keyCode
    if(charCode==37||charCode==39||charCode==46)return true;
    if (charCode > 31 && (charCode < 48 || charCode > 57))
    return false;

    return true;
} 
```

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2009-03-13T12:20:59.760

所提出的解决方案都没有起作用，因为我需要的是添加**我自己的参数**，除了 Firefox 获取 keyCode 所需的“事件”参数。无论如何帮助，谢谢大家。我为未来的读者提供了最终解决方案：

最后，我只需要向调用者添加“事件”参数：

```
<input type="text" onkeydown="TextOnKeyDown('myPrefix', event);" /> 
```

和处理程序：

```
function TextOnKeyDown(prefix, evt) {    
   var key = (evt.which) ? evt.which : evt.keyCode;
...
} 
```

不知何故，它以前不起作用，我不知道为什么。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2011-04-06T17:51:37.597

这里还有一个转折点，它结合了获取事件和 keyCode：

```
function calledOnKeypress(winEvent) {
    var keyCode;
    // event passed as param in Firefox, not IE where it's defined as window.event
    if(!winEvent) {
        winEvent = window.event;
        keyCode = winEvent.keyCode;
    }
    else { // ff
        keyCode = winEvent.which;
    }
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-13T10:11:39.230

您可以使用`arguments[0]`：

```
<input type="text" onkeydown="detectKey(arguments[0])"/> 
```

要在那里获得 IE 事件，您可以执行以下操作：

```
<input type="text" onkeydown="detectKey(arguments[0] ? arguments[0] : event)"/> 
```

或更改您的`detectKey(e)`功能以检查是否`e`已设置，`event`如果未设置则使用。

# c# - MVVM WPF 中的 ICommand

> ID：642043
> 
> 赞同：3
> 
> 时间：2009-03-13T10:09:28.873
> 
> 标签：c#, wpf, mvvm

我正在查看这个 MVVM 的东西，我遇到了一个问题。

情况很简单。

我的 index.xaml 页面中有以下代码

```
 <Grid>
    <ItemsControl ItemsSource="{Binding}">
        <ItemsControl.ItemTemplate>
            <DataTemplate>
                <view:MovieView ></view:MovieView>
            </DataTemplate>
        </ItemsControl.ItemTemplate>
    </ItemsControl>
</Grid> 
```

在我的 index.xaml.cs

...

初始化组件（）；base.DataContext = new MovieViewModel(ent.Movies.ToList()); ……

这是我的 MoveViewModel

```
 public class MovieViewModel
{
    readonly List<Movies> _m;
    public ICommand TestCommand { get; set; }
    public MovieViewModel(List<Movies> m)
    {
        this.TestCommand = new TestCommand(this);
        _m = m;
    }
    public List<Movies> lm
    {
        get
        {
            return _m;
        }
    }
} 
```

最后

这是我的控制 xaml MovieView

```
 <Grid>
    <Grid.RowDefinitions>
        <RowDefinition Height="Auto" />
        <RowDefinition Height="Auto" />
        <RowDefinition Height="Auto" />
    </Grid.RowDefinitions>
    <Grid.ColumnDefinitions>
        <ColumnDefinition Width="Auto"></ColumnDefinition>
        <ColumnDefinition Width="Auto"></ColumnDefinition>
    </Grid.ColumnDefinitions>
    <Label VerticalAlignment="Center" Grid.Row="0" Grid.Column="0">Title :</Label><TextBlock VerticalAlignment="Center" Grid.Row="0" Grid.Column="1" Text="{Binding Title}"></TextBlock>  
    <Label VerticalAlignment="Center" Grid.Row="1" Grid.Column="0">Director :</Label><TextBlock VerticalAlignment="Center" Grid.Row="1" Grid.Column="1" Text="{Binding Director}"></TextBlock>
    <Button Grid.Row="2" Height="20" Command="{Binding Path=TestCommand}" Content="Edit" Margin="0,4,5,4" VerticalAlignment="Stretch" FontSize="10"/>
</Grid> 
```

所以我遇到的问题是，如果我在 Binding 设置 ItemsSource

它什么也没做

如果我设置 ItemsSource="{Binding lm}"

它填充了我的 itemsControl 但命令 (Command="{Binding Path=TestCommand}" ) 不起作用。

当然它不起作用，因为 TestCommand 不属于我的实体对象 Movies。

所以最后我的问题是，

我需要将什么传递给 ItemsControl 才能使其正常工作？

提前谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-13T14:13:27.760

渲染项目后，每个项目都会设置为其所代表的特定行的 DataContext，因此您不再能够引用您的第一个 DataContext。此外，由于您在 DataTemplate 中，您的当需要该模板时，绑定将开始工作。所以在这种情况下，您需要通过 RelativeSource 绑定来查找您的父控件...

希望能解释一些事情..

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-13T10:16:09.203

尝试实现 INotifyPropertyChanged 接口：

```
public class MovieViewModel : INotifyPropertyChanged
{
    readonly List<Movies> _m;
    private ICommand _testCommand = null;
    public ICommand TestCommand { get { return _testCommand; } set { _testCommand = value; NotifyPropertyChanged("TestCommand"); } }
    public MovieViewModel(List<Movies> m)
    {
        this.TestCommand = new TestCommand(this);
        _m = m;        
    }
    public List<Movies> lm
    {
        get
        {
            return _m;
        }
    }

    public event PropertyChangedEventHandler PropertyChanged;

    protected void NotifyPropertyChanged(string sProp)
    {
        if (PropertyChanged != null)
        {
            PropertyChanged(this, new PropertyChangedEventArgs(sProp));
        }
    }    
} 
```

发生的情况是 TestCommand 有一个值，并且 UI 没有收到发生更改的通知。在控件上，您使用 Dependency 属性解决此问题，在数据对象上，您可以使用 INotifyPropertyChanged 接口。

其次，电影对象没有对父对象的引用。

您可以通过三种不同的方式解决此问题：

1.  在 Movie 上有一个对模型的引用，并使 Bind 路径如下所示：即.. 如果您的属性名为 ParentMovieModel，那么您的 Binding 将如下所示：

    {绑定路径=ParentMovieModel.TestCommand}

2.  像这样基于 ElementName 进行绑定：查找设置 DataContext 的父控件，并为其命名：即 Root。现在基于 ElementName 创建一个绑定，如下所示：

    {绑定元素名=根，路径=DataContext.TextCommand}

3.  像这样基于RelativeSource进行绑定：按类型查找父控件，并使用与上述相同的路径...

    {绑定RelativeSource={RelativeSource FindAncestor, AncestorType={x:Type yourparentwindowtype}}, Path=DataContext.TextCommand}

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-13T11:15:50.120

得到它的工作

这是事情

```
 <ItemsControl DataContext="{Binding}" ItemsSource="{Binding lm}">

 Command="{Binding Path=DataContext.TestCommand, RelativeSource={RelativeSource AncestorType={x:Type ItemsControl}}}" 
```

所以RelativeSource 是我错过的东西。

如果有人对此有很好的解释，我肯定会很高兴。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2010-10-02T05:48:49.343

```
//include namespace
using Microsoft.Practices.Composite.Wpf.Commands;

readonly List<Movies> _m;
    public ICommand TestCommand { get; set; }
    public MovieViewModel(List<Movies> m)
    {
        this.TestCommand = new DelegateCommand<object>(TestcommandHandler);
        _m = m;
    }
    public List<Movies> lm
    {
        get
        {
            return _m;
        }
    }

void TestcommandHandler(object obj)
{
      // add your logic here
}
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-13T10:54:58.000

怎么样`<ItemsControl ItemsSource="{Binding Path=lm}">`？

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-13T11:02:49.793

在 ItemsSource="{Binding Path=lm}"> 的情况下

itemsControl 运行良好，但我完全绕过了我的 MovieViewModel

我在输出窗口中得到了这个

System.Windows.Data 错误：39：BindingExpression 路径错误：在“对象”“电影”（HashCode=1031007）上找不到“TestCommand”属性。绑定表达式：路径=测试命令；DataItem='电影' (HashCode=1031007); 目标元素是 'Button' (Name=''); 目标属性是“命令”（类型“ICommand”）

Movies 是我的实体对象，仅拥有 Title 和 Director 属性

# javascript - 在 Javascript 数组中查找元素的有效方法

> ID：642046
> 
> 赞同：7
> 
> 时间：2009-03-13T10:10:39.370
> 
> 标签：javascript, search, complexity-theory, big-o, associative-array

我正在使用带有标题的数组。每个标题索引对应于数据库中的一个 id，其中包含该给定标题的 html。

假设我有一个包含其中一个标题的字符串。

```
title = "why-birds-fly";
titles[] // an array which contains all the titles 
```

要使用字符串“title”来获取相应的 id，我可以这样做：

```
for (i = 0; i < titles.length-1; i++) {
  if (titles[i] == title)
    return i+1;
} 
```

我可以使用的另一种方法是创建一个关联数组以及与标题完全相反的标题数组。也就是说，它使用字符串作为索引并返回数字。

```
titles_id {blah:0,why-birds-fly:1,blah2:2} 
```

然后我可以通过以下方式访问 ID：

```
return titles_id[title]+1; 
```

考虑到 CPU、内存等，什么最有效？

另外，如果我的逻辑完全错误，请告诉我。

谢谢威廉

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-03-13T10:40:42.870

线性搜索方法的[复杂度](http://en.wikipedia.org/wiki/Big_O_notation)为 O(n)，我认为关联数组方法的最坏情况可能是 O(log n)，（如果 JS 引擎使用哈希并获取，*最好*的情况可能是 O(1)没有碰撞）。这将取决于 JS 引擎通常如何实现[关联数组/对象](http://en.wikipedia.org/wiki/Associative_array#Data_structures_for_associative_arrays)，但您可以确定它会击败 O(n)。

所以，第二种方法会更快，但当然会使用更多的内存。这是一个非常典型的[权衡](http://en.wikipedia.org/wiki/Time-space_tradeoff)，获得更快的速度，但使用更多的内存，只有您可以决定是否要进行该交易。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-13T17:18:52.743

考虑您需要存储的键值对的数量也很重要。如果它小于〜50（取决于实现），那么进行线性搜索将与进行哈希表查找一样有效，因为计算哈希值和解决冲突的成本。一个例外是 Google chrome v8 JavaScript 引擎保留了所有对象的一种缓存版本，允许它直接查找对象的属性，因此使用 Object 类作为哈希表可能会更快，尽管我'不确定创建此缓存版本的成本是否会超过较小列表的好处。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-13T17:21:11.550

您可以在第一种方法中使用 Array 的 indexOf 函数。

以下是来自 Mozilla 开发者的信息： [https ://developer.mozilla.org/En/Core_JavaScript_1.5_Reference:Objects:Array:indexOf](https://developer.mozilla.org/En/Core_JavaScript_1.5_Reference:Objects:Array:indexOf)

indexOf 是对 ECMA-262 标准的 JavaScript 扩展；因此，它可能不会出现在该标准的其他实现中。您可以通过在脚本开头插入以下代码来解决此问题，允许在本机不支持它的 ECMA-262 实现中使用 indexOf。该算法正是 Firefox 和 SpiderMonkey 中使用的算法。

```
if (!Array.prototype.indexOf)
{
  Array.prototype.indexOf = function(elt /*, from*/)
  {
    var len = this.length >>> 0;

    var from = Number(arguments[1]) || 0;
    from = (from < 0)
         ? Math.ceil(from)
         : Math.floor(from);
    if (from < 0)
      from += len;

    for (; from < len; from++)
    {
      if (from in this &&
          this[from] === elt)
        return from;
    }
    return -1;
   };
} 
```

* * *

## 回答 #4

> 赞同：-2
> 
> 时间：2009-03-13T16:17:46.633

Javascript 数组可以使用诸如标题“why-birds-fly”之类的值作为索引。

示例： var title = "why-birds-fly";

var TitleArray[] = new Array();

TitleArray[title] = id;

然后您可以通过标题直接访问 id：

返回标题数组[标题]；

# oracle - Oracle SYS_GUID 不会改变

> ID：642055
> 
> 赞同：12
> 
> 时间：2009-03-13T10:14:55.430
> 
> 标签：oracle, guid

我有一个非常适合使用 GUID 作为键的 Oracle 项目。我找到了以下片段

```
SET SERVEROUTPUT ON
BEGIN
FOR indx IN 1 .. 5
LOOP
DBMS_OUTPUT.put_line ( SYS_GUID );
END LOOP;
END;
/ 
```

来自[http://feuerthoughts.blogspot.com/2006/02/watch-out-for-sequential-oracle-guids.html](http://feuerthoughts.blogspot.com/2006/02/watch-out-for-sequential-oracle-guids.html)

当我对我的数据库运行它时（我在版本 10g 和版本 11 上尝试过），我得到如下输出

```
64FE4083D6BA7CB4E0400F0A0E0A18B0
64FE4083D6BB7CB4E0400F0A0E0A18B0
64FE4083D6BC7CB4E0400F0A0E0A18B0
64FE4083D6BD7CB4E0400F0A0E0A18B0
64FE4083D6BE7CB4E0400F0A0E0A18B0 
```

即价值永远不会改变！我需要做些什么来设置它按预期工作吗？

编辑：我不是很细心 - GUID 正在改变，但看起来我遇到了上面链接所讨论的顺序 GUID 问题。

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2009-03-13T10:22:09.873

似乎还可以。从描述：

> SYS_GUID 生成并返回一个由 16 个字节组成的全局唯一标识符（RAW 值）。在大多数平台上，生成的标识符由主机标识符、调用函数的进程或线程的进程或线程标识符以及该进程或线程的**非重复**值（字节序列）组成。

从你的例子：

```
64FE4083D6B A 7CB4E0400F0A0E0A18B0
64FE4083D6B B 7CB4E0400F0A0E0A18B0
64FE4083D6B C 7CB4E0400F0A0E0A18B0
64FE4083D6B D 7CB4E0400F0A0E0A18B0
64FE4083D6B E 7CB4E0400F0A0E0A18B0

```

没有人提及这些 GUID 值的分布。它们应该是不重复的，而且确实如此。除非你每次都得到完全相同的输出。

* * *

## 回答 #2

> 赞同：17
> 
> 时间：2009-03-13T10:39:50.393

值确实发生了变化......

```
 *
64FE4083D6BA7CB4E0400F0A0E0A18B0
64FE4083D6BB7CB4E0400F0A0E0A18B0
64FE4083D6BC7CB4E0400F0A0E0A18B0
64FE4083D6BD7CB4E0400F0A0E0A18B0
64FE4083D6BE7CB4E0400F0A0E0A18B0
           * 
```

# .net - 长按电源键如何拒绝关机？

> ID：642058
> 
> 赞同：8
> 
> 时间：2009-03-13T10:15:58.343
> 
> 标签：.net, windows, winapi, hardware, acpi

在大多数较新的计算机上，您可以通过按住电源按钮几秒钟来硬关机。但我想完全防止这种情况。

您可以防止 Windows 控制面板中的一些软事件，如睡眠、暂停、休眠和“按下电源按钮”事件；您还可以使用一些 Win32 和 WDI 编程来捕获和处理/拒绝这些事件，但是当您长时间按住按钮时，它似乎并没有停止*机械电源关闭。*

我猜电源按钮是硬连线到电源的，当你按住它几秒钟时，它永远不会等待操作系统？或者有什么方法可以通过代码来防止这种情况？

我是一名 .NET 开发人员。

> **哇哦……！你们中的许多人真的主张不要这样做——“你不拥有我的电脑或我的操作系统”，——“你在开发 SkyNet”等等 :) 对于某些客户来说，这个应用程序是一个高度定制和封闭的解决方案。它是在 Windows XP Embedded 上运行并使用触摸屏的定制硬件上的信息亭应用程序。这不是公开的。**

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-03-13T10:19:15.043

我*希望*你不能这样做。我多次遇到无法以任何其他方式重新启动计算机的情况。在这种情况下，您真的要强制笔记本电脑用户在运行时拔下电源并取出电池吗？

给出这个警告后，您可能正在为更有意义的不同情况编写软件。您能否详细说明这样做的动机？

如果用户能够按住电源按钮（表明他们真的非常想关闭机器），他们是否无法物理移除电源？

编辑：回应 magsto 的评论：

如果每个参与的人都非常非常想要这个 - 向他们解释说如果出现问题并且他们需要硬重置计算机，他们将不得不采用更直接的关机方式，我怀疑这更有可能比“按住电源”方法损坏硬件...与设备制造商交谈。听起来您可能正在使用特定设备，因此他们可能能够为您调整 BIOS 中的某些内容，即使它不是公开可用的选项。

鉴于这几乎总是一个非常糟糕的主意，我并不感到惊讶，它没有简单的支持，但如果你问制造商，可能会有一些隐藏的方式来做你想做的事。不过，我仍然鼓励您让*每个人都*参与进来，思考所有潜在的后果。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-03-13T11:15:47.903

有关 4 秒规则，请参阅 ACPI 规范的第 62 页 ( [http://www.acpi.info/DOWNLOADS/ACPIspec30b.pdf](http://www.acpi.info/DOWNLOADS/ACPIspec30b.pdf) )

总而言之，逻辑是在硬件中。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-03-13T10:18:54.640

确实是机械断电，所以会有点难以规避。

如果它真的很重要，您可以断开电源按钮并使用网络唤醒来打开/关闭计算机。远程关机。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2012-12-21T05:48:49.710

使用脉冲发生器开关。我不确定这是否是正确的术语，但我已经在目录中看到了它们。这是一个速动开关，当您按下而不是松开它时，它只会“使”一秒钟。停在中间是行不通的。一旦达到阈值，该机构就会开始移动以关闭触点，并且在触点再次打开之前不会停止移动。这将允许您正常启动和正常停止，但无法保持电路闭合 4 秒。（当然不用打开机箱）

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2009-03-13T10:18:31.147

这是不可能的，因为此关机发生在操作系统级别以下，因此就操作系统而言，这就像拔掉插头一样！

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2009-03-13T10:19:18.400

据我所知，您说操作系统甚至没有参与这种类型的“关闭”是正确的。按住电源按钮一会儿只是向硬件发出信号，立即关闭计算机内所有设备的电源。正如您所说，正常的关机/睡眠/休眠事件当然可以使用 WinAPI 捕获和处理。

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2009-03-13T11:02:01.370

从主板上拔下电源线，并用硬接线将其始终打开。:)

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2009-03-13T10:19:14.530

我相信您可以更改此设置的唯一方法是手动更改 BIOS 中的设置。这可能无法被编程语言捕获。如果你真的需要，你可以从主板上拔下连接电源按钮的细线。

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2009-03-13T10:58:01.193

您是否更接近开发天网？

很抱歉这个问题，但正如很多人所建议的那样，我也相信这不应该成为可能，如果有可能设计的话。

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2009-03-27T22:09:13.830

好的，所以禁用电源按钮可能很疯狂。但是我们有一个软件应用程序，它使用数据库并使用一组昂贵的许可证。这家大型德国供应商使用许可证管理器在驱动器周围物理移动许可证。碎片整理、某些防病毒应用程序和切断电源会破坏许可证。如果机器电源被切断，我们有一个 UPS 可以优雅地关机。现在似乎某些服务人员或操作员使用电源按钮破坏了许可证，从而关闭了 PC。这些设备位于世界各地的偏远地区，培训操作员可能并不总是能防止这种情况发生。似乎解决方案选项是 1）与供应商合作禁用电源按钮，2）尝试捕获它并警告用户可能的厄运，

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2009-03-13T10:54:22.590

您不能也不应该弄乱此功能。

我可以设想两种情况，这可能是一个问题：

1.  您不希望未经授权的用户以任何方式关闭机器 - 在这种情况下，物理上保护机器并锁定操作系统。
2.  您不希望机器在关键过程中关闭 - 在这种情况下，在您的应用程序中构建弹性，以便强制关闭或环境电源故障等事件不会危及应用程序。

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2015-02-27T09:16:46.453

当计算机用户是孩子并且电源按钮变成游戏而不是紧急操作时，这确实有意义。孩子学习通过软件关闭机器的更好方法是禁用机械关闭。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2009-03-13T11:30:22.520

我建议以某种方式将电源按钮从用户手中拿走。也许完全删除它。并确保计算机在通电或其他东西时自动打开（不确定，但在 BIOS 中可能吗？）。

无论如何，对于一个永远在线的信息亭来说，这确实是有道理的。至少它适用于许多其他硬件。关闭它的唯一方法是切断电源。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2020-08-11T16:07:53.547

我也想实现同样的目标。在这里阅读答案时，我决定打开我的电脑。我拥有一台 HP All-In-One，就我而言，我只能禁用电源按钮。要部分禁用它只能通过硬件摆弄和调整来实现。

# java - 提交响应 java.io.IOException 时出错：sun.nio.ch.FileDispatcher.write0 处的管道损坏（本机方法）

> ID：642061
> 
> 赞同：8
> 
> 时间：2009-03-13T10:16:41.493
> 
> 标签：java, ssl

我在多次 https 请求后遇到此错误。有人知道可能是什么原因吗？它似乎与 SSL 有关。但以前它工作正常。我真的不明白是什么导致了这个问题

> 提交 responsejava.io.IOException 时出错：sun.nio.ch.IOUtil 的 sun.nio.ch.SocketDispatcher.write(SocketDispatcher.java:29) 的 sun.nio.ch.FileDispatcher.write0(Native Method) 的管道损坏。 writeFromNativeBuffer(IOUtil.java:104) 在 sun.nio.ch.IOUtil.write(IOUtil.java:75) 在 sun.nio.ch.SocketChannelImpl.write(SocketChannelImpl.java:302) 在 com.sun.enterprise.server .ss.ASOutputStream.write(ASOutputStream.java:120) 在 com.sun.net.ssl.internal.ssl.OutputRecord.writeBuffer(OutputRecord.java:283) 在 com.sun.net.ssl.internal.ssl.OutputRecord .write(OutputRecord.java:272) 在 com.sun.net.ssl.internal.ssl.SSLSocketImpl.writeRecord(SSLSocketImpl.java:666) 在 com.sun.net.ssl.internal.ssl.AppOutputStream.write(AppOutputStream .java:59) 在 org.apache.coyote.http11.InternalOutputBuffer.commit(InternalOutputBuffer.java:602) 在 com.sun.enterprise.web.connector.grizzly.ProcessorTask.action(ProcessorTask.java:721) 在 org.apache.coyote.Response.action(Response.java:188) 在 org.apache.coyote.Response .sendHeaders(Response.java:380) 在 org.apache.coyote.tomcat5.OutputBuffer.doFlush(OutputBuffer.java:357) 在 org.apache.coyote.tomcat5.OutputBuffer.close(OutputBuffer.java:318) 在 org. apache.coyote.tomcat5.CoyoteResponse.finishResponse(CoyoteResponse.java:528) 在 com.sun.enterprise.web.connector.grizzly.ProcessorTask 的 org.apache.coyote.tomcat5.CoyoteAdapter.service(CoyoteAdapter.java:192)。 doProcess(ProcessorTask.java:604) 在 com.sun.enterprise.web.connector.grizzly.ProcessorTask.process(ProcessorTask.java:475) 在 com.sun.enterprise.web.connector.grizzly.ProcessorTask.doTask(ProcessorTask. java:426) 在 com.sun.enterprise.web.connector。com.sun.enterprise.web.connector.grizzly.WorkerThread.run(WorkerThread.java:83 上的 grizzly.TaskBase.run(TaskBase.java:281)

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-04-02T15:41:24.877

我不知道 sun.nio.ch。但...

这是您有时在 Java Web 应用程序中遇到的标准恼人错误。当您请求一个 URL，然后在您的浏览器中点击停止或点击另一个 URL 时，您会收到此错误。该应用程序抱怨它无法向您发送完整的回复。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2020-12-24T17:53:35.183

在我的情况下，当我在服务器上生成 Excel 或 csv 文件以供本地下载时发生这种情况（在 HttpServletResponse getOutputStream().flush() 处崩溃）但是它与浏览器配置有关，在我的情况下，Windows 7 上的 Chrome 32 位. 服务器端什么都没有。3 天来，我深入调查了我的 Web 应用程序，寻找问题的原因，检查了许多 apache 库等。然后我尝试从另一台计算机执行相同的操作，最后使用 FireFox 从同一台计算机执行相同的操作。没问题。最后我发现原因是 Chrome 的默认缓存大小。我用 -disk-cache-size-2147483648 （在快捷方式目标的末尾）更改了它，问题就消失了。我希望它可以为某人节省时间。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2015-08-19T11:18:07.243

Java NIO 管道是两个线程之间的单向数据连接。Pipe 有一个源通道和一个接收器通道。您将数据写入接收器通道。然后可以从源通道读取此数据。

现在来解决问题。只要接收器通道已满（读取速度不够快，无法在缓冲区中留下一些空间），管道就会关闭！因此，此后的任何写入都将失败。

# visual-studio - 在release模式下编译的问题--VC++

> ID：642062
> 
> 赞同：1
> 
> 时间：2009-03-13T10:17:07.513
> 
> 标签：visual-studio, visual-c++, compilation, release-mode

我正在 VC++ 中以发布模式编译我的项目。我有一个 .def 文件，我在其中声明了 setLog，现在我收到以下错误

链接... 创建库 Release/HKL.lib 和对象 Release/HKL.exp HKL_libinterface.obj：错误 LNK2001：未解析的外部符号 _SCTP_setLog@8

请帮助我解决上述问题。

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-14T06:05:20.683

在我看来，您在调试版本中配置了一个不在发布版本中的 lib 文件。您的`setLog()`函数似乎不是链接器抱怨的函数 - 听起来它没有找到名为`SCTP_setLog()`.

查看您在项目的调试配置中配置的库列表，并确保它们也在发布配置中进行了配置。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-13T12:05:45.117

正如Sharptooth 提到的，您很可能没有在您的发布版本中编译上述功能。除了查找“从构建中排除”之外，请检查您是否有任何定义集（或未设置）会从发布构建中排除缺少的功能。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-13T10:20:28.177

如果这在调试模式下编译，最可能的原因是不知何故，实现此功能的代码未包含在构建中 - 例如，实现它的 cpp 文件已设置“从构建中排除”。

# vb.net - Labelsize 在 VB.Net 中显得更大

> ID：642063
> 
> 赞同：0
> 
> 时间：2009-03-13T10:17:28.293
> 
> 标签：vb.net, winforms, controls

我正在尝试将一些列表堆叠在一起。但是 label.size.height 似乎比标签本身大。

当我将borderstyle 设置为fixedsingle 时，我看到了文本周围的边框。但是高度更大，所以一个标签和下一个标签之间有一个空间。

我试图将边距和填充设置为 0 而没有结果。

示例：label.size.height 返回 23，而高度实际上是 15 左右。

有人知道我如何获得合适的尺寸吗？

**编辑：** 当我明确设置标签的高度时，问题就解决了。这是自动调整大小的问题吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-13T10:46:36.070

我之前也遇到过这种问题。标签高度在 17 到 23 之间波动。但是，我的标签放置在 TableLayoutPanel 内，所以我如何修复它:)，通过在 Designer.cs 中进行更改

高温高压

# c++ - g ++未定义对构造函数的引用

> ID：642066
> 
> 赞同：1
> 
> 时间：2009-03-13T10:18:45.060
> 
> 标签：c++, constructor, linker, g++, undefined-reference

我正在针对预编译的库编译和链接 cpp 文件，并且收到“未定义的引用”错误。

首先，这是命令（有问题的库是 quicknet3，我正在编译的程序是 trapper）：

`g++ -w -g -I. -g -O3 -pipe -Wall -I/home/install/x86_64/include/quicknet3 -L/home/install/x86_64/lib -lquicknet3 -lintvec -lfltvec -o trapper trapper.cpp CMyException.cpp`

这是未定义的参考错误：

`/tmp/ccFuVczF.o: In function 'main': trapper.cpp:1731: undefined reference to 'QN_InFtrLabStream_PFile::QN_InFtrLabStream_PFile(int, char const*, _IO_FILE*, int)'`

trapper.cpp（第 1731 行）中的调用是：

`IN_PFILE = new QN_InFtrLabStream_PFile(0, "", fp, 1);`

其中`fp`a 是预先`FILE *`分配为调用的结果。`fopen`

被调用的构造函数在相关的头文件（QN_Pfile.h）中定义，如下：

`class QN_InFtrLabStream_PFile : public QN_InFtrLabStream
{
public:
QN_InFtrLabStream_PFile(int a_debug, const char* a_dbgname, FILE* a_file, int a_indexed);
(... other declarations ...) }`

QN_Pfile.cc中确实给出了构造函数的定义：

`QN_InFtrLabStream_PFile::QN_InFtrLabStream_PFile(int a_debug,const char* a_dbgname, FILE* a_file, int a_indexed) : log(a_debug, "QN_InFtrLabStream_PFile", a_dbgname),file(a_file),indexed(a_indexed),buffer(NULL),sentind(NULL) {
(... the usual constructor stuff :P ...) }`

我自己编译了quicknet3库，没有报错，安装到/home/install/x86_64/lib/libquicknet3.a

所以，我不明白为什么来自 trapper.cpp 的调用无法找到对这个构造函数定义的引用。的 g++ 参数`-L/home/install/x86_64/lib -lquicknet3`应该可以解决问题，对吧？

有任何想法吗？

谢谢，罗伊

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-13T10:30:16.517

我注意到你正在混合`FILE*`和`_IO_FILE*`. 我对后者不熟悉，你确定它们是同一个人吗？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-13T12:23:05.230

FILE 是`_IO_FILE`. 您的链接器将其视为唯一类型。

你可以试试：

```
IN_PFILE = new QN_InFtrLabStream_PFile(0, "", (FILE *)fp, 1); 
```

看看这是否解决了您的构造函数。

（FILE 在 stdio.h 中定义，如果您有兴趣，_IO_FILE 在 libio.h 中定义）

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-13T13:02:21.020

一个快速的解决方法是将 /home/install/x86_64/lib/libquicknet3.a 添加到 g++ 命令行。

我想进一步调查，如果 g++ 正在选择 libquicknet3 的另一个副本，您可以将 -v 传递给 g++，以便它输出其搜索路径。

# regex - 如何从正则表达式中获取所有匹配项？

> ID：642067
> 
> 赞同：7
> 
> 时间：2009-03-13T10:18:47.573
> 
> 标签：regex, bash, shell

我想`[0-9A-Z]+?`稍后处理所有出现的 。我有

```
if [[ `cat file` =~ '[0-9A-Z]+?' ]]; then
  echo $BASH_REMATCH;
fi 
```

这给了我第一个匹配项，但是我如何处理文件中的所有匹配项？

谢谢

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-03-13T10:41:44.227

如果您只想获取正则表达式的匹配文本，我会使用

```
grep -o 'regex' file 
```

本着您的代码的精神，我会将其修改为

```
while read line; do
    [[ $line =~ regex ]] || continue
    # do somethinw with $line or $BASH_REMATCH, perhaps put it in an array.
done < file 
```

如果你想在同一行匹配多个正则表达式，这里有一种方法。

```
while read line; do
    # do somethinw with $line
done < <(grep -o 'regex' file) 
```

我假设您的正则表达式应该是您真正在做什么的简化示例。这 ？没有帮助，您的引号与文字字符串匹配。

# c# - 截取自定义列表类的屏幕截图

> ID：642075
> 
> 赞同：0
> 
> 时间：2009-03-13T10:20:08.553
> 
> 标签：c#, custom-controls, screenshot

有一个程序很长，我想从中截取屏幕截图。问题是，显示的大约 100 个中只有 14 个。如何截取整个列表的屏幕截图？

我想到的一种方法基本上是将 PG-Down 单击发送到此列表，拍摄新的屏幕截图并将它们合并在一起。有没有更简单快捷的解决方案？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-13T10:49:12.633

您可以从

[http://www.codeproject.com/KB/graphics/IECCapture.aspx](http://www.codeproject.com/KB/graphics/IECapture.aspx) &

[http://www.codeproject.com/KB/dialog/windowsnapshot.aspx](http://www.codeproject.com/KB/dialog/windowsnapshot.aspx)

并将 IE 的窗口句柄替换为自定义 listClass 窗口

# android - 如何在android中将短信保存到收件箱？

> ID：642076
> 
> 赞同：41
> 
> 时间：2009-03-13T10:20:17.960
> 
> 标签：android, sms

我编写了以下用于发送 SMS 消息的代码。

```
SmsManager smsManager = SmsManager.getDefault();
smsManager.sendTextMessage(destAddr, null, mMessageText, il, null); 
```

但这不是在我的收件箱中更新，我需要在收件箱中保存相同的消息，或者有什么方法可以调用本机短信应用程序来发送短信？

* * *

## 回答 #1

> 赞同：60
> 
> 时间：2009-05-16T10:19:18.287

您可以使用短信内容提供程序来读取和写入短信：

```
ContentValues values = new ContentValues();
values.put("address", "123456789");
values.put("body", "foo bar");
getContentResolver().insert(Uri.parse("content://sms/sent"), values); 
```

我不知道您为什么要写一条消息*发送*到*收件箱*，但如果这是您想要的，只需将上面的 uri 更改为`"content://sms/inbox"`.

或者，您可以通过启动具有类似于以下意图的活动来移交给消息传递应用程序：

```
Intent sendIntent = new Intent(Intent.ACTION_SENDTO, Uri.parse("sms://"));
sendIntent.putExtra("address", "123456789");
sendIntent.putExtra("sms_body", "foo bar");
startActivity(sendIntent); 
```

**编辑：**然而，`sms://`内容提供者不是 SDK 的一部分，所以我强烈建议*不要*在公共应用程序中使用这样的代码，[原因有几个](http://android-developers.blogspot.com/2010/05/be-careful-with-content-providers.html)。

* * *

## 回答 #2

> 赞同：28
> 
> 时间：2012-12-07T06:36:31.190

如果您想手动将一些带有发件人姓名的短信发送到您的收件箱，

```
 ContentValues values = new ContentValues();
  values.put("address", "+923359110795");//sender name
  values.put("body", "this is my text");
  getContentResolver().insert(Uri.parse("content://sms/inbox"), values); 
```

还将这些添加到清单中。

```
 <uses-permission android:name="android.permission.READ_SMS"/>
 <uses-permission android:name="android.permission.WRITE_SMS"/> 
```

现在此代码将使用定义的发件人名称将短信添加到收件箱，因此您可以轻松处理此解决方案的问题，

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2012-12-18T16:05:53.777

此代码适用于所有 Android 版本，包括上述 kitkat (19)

```
public boolean saveSms(String phoneNumber, String message, String readState, String time, String folderName) {
        boolean ret = false;
        try {
            ContentValues values = new ContentValues();
            values.put("address", phoneNumber);
            values.put("body", message);
            values.put("read", readState); //"0" for have not read sms and "1" for have read sms
            values.put("date", time);

            if (Build.VERSION.SDK_INT >= Build.VERSION_CODES.KITKAT) {
                Uri uri = Telephony.Sms.Sent.CONTENT_URI;
                if(folderName.equals("inbox")){
                    uri = Telephony.Sms.Inbox.CONTENT_URI;
                }
                mActivity.getContentResolver().insert(uri, values);
            }
            else {
                mActivity.getContentResolver().insert(Uri.parse("content://sms/" + folderName), values);
            }

            ret = true;
        } catch (Exception ex) {
            ex.printStackTrace();
            ret = false;
        }
        return ret;
    } 
```

**如何打电话**

```
 if (Build.VERSION.SDK_INT >= Build.VERSION_CODES.KITKAT) {
        final String myPackageName = getPackageName();
        if (!Telephony.Sms.getDefaultSmsPackage(this).equals(myPackageName)) {

            Intent intent = new Intent(Telephony.Sms.Intents.ACTION_CHANGE_DEFAULT);
            intent.putExtra(Telephony.Sms.Intents.EXTRA_PACKAGE_NAME, myPackageName);
            startActivityForResult(intent, 1);
        }else {
            saveSms("111111", "mmmmssssggggg", "0", "", "inbox");
        }
    }else {
        saveSms("111111", "mmmmssssggggg", "0", "", "inbox");
    } 
```

**onActivityResult**

```
@Override
protected void onActivityResult(int requestCode, int resultCode, Intent data) {

    if (requestCode == 1) {
        if (resultCode == RESULT_OK) {

            if (Build.VERSION.SDK_INT >= Build.VERSION_CODES.KITKAT) {
                final String myPackageName = getPackageName();
                if (Telephony.Sms.getDefaultSmsPackage(mActivity).equals(myPackageName)) {

                    //Write to the default sms app
                    saveSms("111111", "mmmmssssggggg", "0", "", "inbox");
                }
            }
        }
    }
} 
```

有关更多详细信息或示例应用程序，请点击链接： [http ://wisdomitsol.com/blog/android/sms/how-to-programmatically-save-sms-to-inbox-or-sent-in-android](http://wisdomitsol.com/blog/android/sms/how-to-programmatically-save-sms-to-inbox-or-sent-in-android)

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2010-01-28T06:22:22.713

```
Intent sendIntent = new Intent(Intent.ACTION_VIEW);
sendIntent.putExtra("sms_body", "Content of the SMS goes here...");
sendIntent.setType("vnd.android-dir/mms-sms");
startActivity(sendIntent); 
```

使用内容调用本机 SMS 应用程序

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2017-06-04T18:55:40.000

```
ContentValues values = new ContentValues();
values.put("address", phoneNumber);
values.put("body", multimessage);
values.put("read", 1); //"0" for have not read sms and "1" for have read sms
Uri uri = Telephony.Sms.Sent.CONTENT_URI;
Activity ctx = this.cordova.getActivity();
ctx.getContentResolver().insert(uri, values); 
```

# variables - Maven 中是否存在包含当前目标的变量？

> ID：642078
> 
> 赞同：4
> 
> 时间：2009-03-13T10:20:48.333
> 
> 标签：variables, maven-2

为了以与我的 uber-pom 中当前运行的相同目标调用 Maven 调用程序插件，我需要一种方法将当前目标传递到调用程序插件的配置中。

有点像

```
 <plugin>
    <groupId>org.apache.maven.plugins</groupId>
    <artifactId>maven-invoker-plugin</artifactId>
        ...
        <configuration>
          <goals>
            <goal>${maven.goal}</goal>
          </goals>
        ... 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-13T13:55:10.580

[Maven 帮助插件](http://maven.apache.org/plugins/maven-help-plugin/)可能会帮助您[到达您想去的](http://maven.apache.org/plugins/maven-help-plugin/usage.html)地方。${reactorProjects} 变量包含您要查找的内容，但可能不是您希望重用它的格式。

您可以通过以下方式查看[所有可用的表达式](http://maven.apache.org/plugins/maven-help-plugin/expressions-mojo.html)：

```
mvn help:expressions 
```

然后您可以[通过评估测试其中一个，而无需繁琐的 pom](http://maven.apache.org/plugins/maven-help-plugin/evaluate-mojo.html)：

```
mvn help:evaluate 
```

它将带您进入可用于尝试表达式的提示。

如果我使用 help:evaluate 并键入 ${reactorProjects}，我会得到很多输出，但其中一部分包括您所追求的数据：

```
<plugins>
  <plugin>
    <inheritanceApplied>true</inheritanceApplied>
    <groupId>org.apache.maven.plugins</groupId>
    <artifactId>maven-help-plugin</artifactId>
    <version>2.1</version>
    <extensions>false</extensions>
    <dependencies/>
  </plugin>
</plugins>
<pluginMap class="linked-hash-map">
  <entry>
    <string>org.apache.maven.plugins:maven-help-plugin</string>
    <plugin reference="../../../plugins/plugin"/>
  </entry>
</pluginMap> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-02-15T16:02:22.547

我添加了以下依赖项：

```
<dependency>
  <groupId>org.apache.maven</groupId>
  <artifactId>maven-core</artifactId>
  <version>3.0.3</version>
</dependency> 
```

然后在我的 MOJO 中：

```
import org.apache.maven.execution.MavenExecutionRequest;
import org.apache.maven.execution.MavenSession;
...
@Parameter(defaultValue = "${session}", readonly = true)
private MavenSession session; 
```

最后，我能够得到当前的目标：

```
MavenExecutionRequest executionRequest = session.getRequest();
List<String> goals = executionRequest.getGoals(); 
```

# c++ - 如何在非托管 ATL GUI 中嵌入 Windows 窗体？

> ID：642082
> 
> 赞同：1
> 
> 时间：2009-03-13T10:21:09.020
> 
> 标签：c++, winforms, atl

我有一个使 COM 可见的 Windows 窗体用户控件。现在我想将该控件嵌入到 ATL 对话框 GUI 中。

ATL 项目（非托管 C++）只能获取 winform 的 progID 并在运行时动态创建和嵌入它。

这可能吗？如果可以，我该怎么做？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-13T10:31:28.493

我不确定 ATL，但这可以在 MFC 中使用 CWinFormsView 和 CWinFormsControl 类轻松完成。

我认为没有bulitin 支持在ATL 窗口中托管WinForm 控件，但我认为您可以通过简单地获取winform 控件的HWND 并将您的ATL 控件设置为其父级来实现。不过，这可能是一条艰难的道路。

这似乎是一种类似的事情。虽然我自己没有测试过。

[关联](http://www.ondotnet.com/pub/a/dotnet/2003/01/20/winformshosting.html)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-18T08:07:38.940

我想出了一个让它工作的方法。
下面的代码使用了一个名为 m_Control 的 CWnd，它通过 CreateControl 的一个小文档版本来托管一个 winform。到目前为止似乎工作正常。如果有人看到任何缺点，请发表评论或回复。

```
AfxEnableControlContainer();
Microsoft::VisualC::MFC::CControlCreationInfoEx i;
i.Init(System::Type::GetTypeFromProgID(gcnew System::String(sProgID)),
       CControlCreationInfo::ReflectionType);
i.m_clsid = CLSID_WinFormsControl;
POINT pt;
pt.x = pt.y = 0;
SIZE sz;
sz.cx = sz.cy = 100;
m_Control.CreateControl(i, WS_CHILD | WS_VISIBLE | WS_CLIPCHILDREN,
                        &pt, &sz, CWnd::FromHandle(m_hWnd), ID_CONTROL); 
```

# sql-server - Hibernate Query 在系统中运行缓慢，但直接运行时很快

> ID：642093
> 
> 赞同：5
> 
> 时间：2009-03-13T10:25:01.397
> 
> 标签：sql-server, sql-server-2005, hibernate, performance

我有一个类似于本周播客中的问题。

我们有一个使用带有 Sql Server 2005 的休眠的 Java 应用程序。

Hibernate 正在为我们生成一个查询，这需要将近 20 分钟才能完成。

如果我们使用 show_sql 进行相同的查询并将问号替换为常量值，则立即返回答案。

我认为我们需要选项（重新编译），但我不知道如何用 HQL 做到这一点。

请帮忙！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-25T13:43:16.383

从您的问题描述来看，听起来您遇到了参数嗅探。从本质上讲，SQL Server 正在根据传入的一组较旧的参数值创建查询计划，这些参数值不会为当前运行的查询创建有效的执行计划。

通常，我通过将参数值传递给局部变量并在查询中使用这些值或使用 OPTION (RECOMPILE) 来解决此问题。但是，由于您使用的是 Hibernate，因此我通常的解决方案不适合您。据我了解，最好的选择是使用 Hibernate 使用 prepareStatement() 或 createSQLQuery() 运行本机 SQL 查询，不幸的是，这消除了使用 Hibernate 的一些好处。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-15T15:24:28.113

根据我的经验，Hibernate 中复杂查询的主要问题不是查询本身，而是代表结果集的所有对象的创建。

在我的工作案例中，我们有一个非常大的域模型，有很多耦合，因此即使从数据库中获取一个对象也非常昂贵，因为该对象链接到其他对象，而这些对象又链接到其他对象，并且很快。

对我们来说，更多地使用延迟加载至少解决了部分问题。智能缓存的帮助更大。我学到的是，在未来，我将允许域类之间更松散的耦合。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-15T15:14:07.637

您应该发布您的映射和 HQL 语句。如果您在 HQL 中使用“join”，您可能想看看 Hibernate 究竟获取了什么。事实证明，请求本身很简单，但 Hibernate 会在它到达之前获取大量数据。

# vb.net - 铸造接口和 MEF

> ID：642103
> 
> 赞同：0
> 
> 时间：2009-03-13T10:28:58.437
> 
> 标签：vb.net, interface, mef

我对 MEF 有以下问题：

主机使用的接口定义：

```
Public Interface IExecuteDoSomething
   Inherits IAddinSettings

   Event DataReceived As EventHandler(Of DataReceivedEventArgs)
   Function DoSomething() As Boolean

End Interface

Public Class DataReceivedEventArgs
   Inherits EventArgs

   Public Sub New(ByVal message As String)
      Me.Message = message
   End Sub

   Public Message As String
End Class 
```

主机内的一些其他代码所需的额外接口：

```
 Public Interface IAddinSettings
        ReadOnly Property Setting() As AddinSettings
    End Interface

    Public Class AddinSettings
        Private _Name As String
        Public Property Name() As String
            Get
                Return _Name
            End Get
            Set(ByVal value As String)
                _Name = value
            End Set
        End Property

        Public Sub New(ByVal name As String)
            Me.Name = name
        End Sub
    End Class 
```

提供导出的类：

```
 <Export(GetType(SharedLibrary.IExecuteDoSomething))> Public Class Class1
        Implements SharedLibrary.IExecuteDoSomething
        Implements SharedLibrary.IAddinSettings

        Private _Addinsettings As New SharedLibrary.Addinsettings("Test")

        Public Function DoSomething() As Boolean Implements SharedLibrary.IExecuteDoSomething.DoSomething
            MsgBox("i did something")
            Return True
        End Function

        Public Event DataReceived(ByVal sender As Object, ByVal e As SharedLibrary.DataReceivedEventArgs) Implements SharedLibrary.IExecuteDoSomething.DataReceived

        Public ReadOnly Property Setting() As SharedLibrary.AddinSettings Implements SharedLibrary.IAddinSettings.Setting
            Get
                Return  _Addinsettings
            End Get
        End Property
    End Class 
```

主人：

```
Public Class Form1

    Private Sub Form1_Load(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles MyBase.Load
        Dim catalog As New Hosting.AggregateCatalog
        Dim d As New Hosting.DirectoryCatalog("..path to dlll..")
        catalog.Catalogs.Add(d)
        Dim container = New Hosting.CompositionContainer(catalog)
        Dim batch As New Hosting.CompositionBatch
        batch.AddPart(Me)
        container.Compose(batch)
        For Each dd In dos
            AddHandler dd.DataReceived, AddressOf testevent
        Next
    End Sub

    <Import()> Public dos As IEnumerable(Of SharedLibrary.IExecuteDoSomething)

    Private Sub Button1_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles Button1.Click
        For Each d In dos
            d.DoSomething()
        Next
    End Sub

    Private Sub testevent(ByVal sender As Object, ByVal e As SharedLibrary.DataReceivedEventArgs)
        MsgBox("Event received: " & e.Message)
    End Sub

    Private Sub Button2_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles Button2.Click
        Dosomethingelse(DirectCast(dos, System.Collections.Generic.List(Of SharedLibrary.IAddinSettings))) 
    End Sub
    Private Sub Dosomethingelse(byval settings as IEnumerable(Of SharedLibrary.IAddinSettings))
    End Sub 

End Class 
```

在执行 Button2_Click 例程之前，一切似乎都运行良好，然后抛出 InvalidCastException 并显示以下信息：
无法转换类型为“System.Collections.Generic.List `1[SharedLibrary.IExecuteDoSomething]' to type 'System.Collections.Generic.List`1[SharedLibrary.IAddinSettings]”的对象。

我该如何解决这个问题，因为导入的对象实现了这两个接口？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-13T10:38:12.160

我怀疑您实际上遇到了协方差问题 - 这是此类问题的典型原因。A`List<IFoo>`不是a即使extends 。*_*`List<IBar>``IBar``IFoo`

如果您使用的是 .NET 3.5，在您的情况下解决此问题的最简单方法是删除`DirectCast`并改为使用[`Enumerable.Cast`](http://msdn.microsoft.com/en-us/library/bb341406.aspx)：

```
Dosomethingelse(dos.Cast(Of SharedLibrary.IAddinSettings)) 
```

# windows - 如何获取存储在主机中的文件？

> ID：642119
> 
> 赞同：3
> 
> 时间：2009-03-13T10:39:58.380
> 
> 标签：windows, linux, filesystems, vmware

我在 VMWare 上安装了 Linux 系统，VMWare 是 Windows XP 操作系统的来宾。

在 Linux 环境下工作时，如何直接获取存储在 XP 文件系统中的文件？

谢谢。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-03-13T10:53:54.557

你有两种方法：

1.  [VMware 共享文件夹](http://www.vmware.com/support/ws5/doc/ws_running_shared_folders.html)。这些内置于 VMware 并且运行良好，但您需要安装[VMware 工具](http://www.vmware.com/support/ws55/doc/new_guest_tools_ws.html)并在来宾操作系统上运行。
2.  只需在 Windows 中共享一个文件夹，然后[使用 Samba 将其安装在 Linux 客户机中](http://cri.ch/linux/docs/sk0001.html)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-14T18:47:27.773

如果您想从主机访问来宾文件，VMWare 提供了允许您挂载 VMWare 虚拟磁盘的用户级工具。

请参阅：[VMWare 磁盘安装 [pdf]](http://www.vmware.com/pdf/VMwareDiskMount.pdf)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-17T00:18:55.340

如果做不到这一切，您可以使用通用文件传输实用程序，如 FTP 或 SCP :-)

# c# - 时间戳为 UTC 整数

> ID：642123
> 
> 赞同：0
> 
> 时间：2009-03-13T10:41:14.120
> 
> 标签：c#, utc

我有一个旧数据库，其中包含一个表示 UTC 日期时间的整数的字段

来自文档：“CDR 中的时间戳以通用协调时间 (UTC) 显示。此值保持独立于夏令时更改”

值的一个示例是 1236772829。

我的问题是将其转换为 .NET DateTime（在 CLR 代码中，而不是在 DB 中）的最佳方法是什么，既作为 UTC 值又作为本地时间值。

曾尝试用谷歌搜索，但没有任何运气。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-13T10:43:10.370

您需要知道整数的真正含义。这通常包括：

*   一个纪元/偏移量（即 0 的含义） - 例如“1970 年 1 月 1 日午夜”
*   一个刻度，例如秒、毫秒、滴答声。

如果您可以获得两个值以及它们在 UTC 方面的含义，那么其余的应该很容易。最简单的方法可能是将 a `DateTime`(or `DateTimeOffset`) 作为 epoch，然后`TimeSpan`从整数构造 a，例如`TimeSpan.FromMilliseconds`等。将两者加在一起就完成了。编辑：使用`AddSeconds`或`AddMilliseconds`按照[aakashm 的回答](https://stackoverflow.com/questions/642123/timestamp-as-utc-integer/642161#642161)是一种更简单的方法:)

或者，自己做算术并调用[`DateTime`构造函数，该构造函数需要一些 ticks](http://msdn.microsoft.com/en-us/library/z2xf7zzk.aspx)。（可以说，采用 a 的版本`DateTimeKind`会更好，因此您可以明确声明它是 UTC。）

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-13T10:56:22.273

谷歌搜索那个确切的短语给了我[这个 Cicso 页面](http://www.cisco.com/en/US/docs/voice_ip_comm/cucm/service/7_0_1/cdr-defs/cdrcallinfo.html)，它继续说“该字段指定了一个从操作系统获得的 time_t 值。”

[time_t](http://en.wikipedia.org/wiki/Time_t)是一个 C 库概念，严格来说不必是任何特定的实现，但对于 UNIX-y 系统，*通常*是自 Unix 纪元 1970 年 1 月 1 日 00:00 开始以来的秒数。

假设这是正确的，此代码将为您提供来自 int 的 DateTime：

```
 DateTime epochStart = new DateTime(1970, 1, 1);

        int cdrTimestamp = 1236772829;

        DateTime result = epochStart.AddSeconds(cdrTimestamp);

        // Now result is 2009 March 11 12:00:29 
```

您应该理智地检查您得到的结果，以确认这是对这些`time_t`s 的正确解释。

# c# - 使用单引号和双引号对 XPath 表达式进行编码

> ID：642125
> 
> 赞同：30
> 
> 时间：2009-03-13T10:42:00.433
> 
> 标签：c#, xml, xpath, xpath-1.0

XPath (v1) 不包含对表达式进行编码的方法。

如果您只有单引号或双引号，那么您可以使用表达式，例如

```
//review[@name="Bob's Pizza"]
//review[@name='"Pizza" Pam'] 
```

[但是如果你有两个，例如[Fred's "Fancy Pizza"]，那么你必须在 XPath (C++)](http://www.deez.info/sengelha/category/programming/xml/xpath/)中使用这样的转义字符串来生成

```
//review[@name=Concat("Fred's ",'"Fancy Pizza"')] 
```

有人在c#中有一个函数可以做到这一点吗？

一些关闭的链接

*   [使用 MVP.XML 库和 XPathVariable](http://www.tkachenko.com/blog/archives/000627.html)（一个非常好的解决方案，但对我的需要来说有点重量级）。
*   [不编码同时存在 " 和 ' 的位置](http://www.webtips.co.in/c/c-sharp-function-to-escape-single-quote-on-xpath-expression.aspx)
*   [向 Concat 操作添加不必要的参数，](http://kushalm.com/the-perils-of-xpath-expressions-specifically-escaping-quotes) 例如返回 //review[@name=concat('Fred', "'", 's ', '"', 'Fancy Pizza', '"', '') ]

编辑：一些答案建议转义 ' with`&apos;`和 " with`&quot;`但虽然这是有道理但它不起作用；尝试使用 XML 片段：

```
<review name="Bob's Pizza"/> 
```

和 xpath

```
//review[@name='Bob&apos;s Pizza'] 
```

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2016-07-07T20:27:07.017

哇，你们肯定让事情变得复杂了。为什么不这样做呢？

```
public static string XpathExpression(string value)
{
    if (!value.Contains("'"))
        return '\'' + value + '\'';

    else if (!value.Contains("\""))
        return '"' + value + '"';

    else
        return "concat('" + value.Replace("'", "',\"'\",'") + "')";
} 
```

[.NET 小提琴和测试](https://dotnetfiddle.net/hDFP1E)

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2009-03-13T18:12:51.723

虽然它肯定不会在所有情况下都有效，但这里有一种回避问题的方法：

```
doc.DocumentElement.SetAttribute("searchName", name);
XmlNode n = doc.SelectNodes("//review[@name=/*/@searchName]"); 
```

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2009-03-17T21:06:09.157

我需要这个，所以我为 C# 创建了这个解决方案。

```
 /// <summary>
    /// Returns a valid XPath statement to use for searching attribute values regardless of 's or "s
    /// </summary>
    /// <param name="attributeValue">Attribute value to parse</param>
    /// <returns>Parsed attribute value in concat() if needed</returns>
    public static string GetXpathStringForAttributeValue(string attributeValue)
    {
        bool hasApos = attributeValue.Contains("'");
        bool hasQuote = attributeValue.Contains("\"");

        if (!hasApos)
        {
            return "'" + attributeValue + "'";
        }
        if (!hasQuote)
        {
            return "\"" + attributeValue + "\"";
        }

        StringBuilder result = new StringBuilder("concat(");
        StringBuilder currentArgument = new StringBuilder();
        for (int pos = 0; pos < attributeValue.Length; pos++)
        {
            switch (attributeValue[pos])
            {
                case '\'':
                    result.Append('\"');
                    result.Append(currentArgument.ToString());
                    result.Append("'\",");
                    currentArgument.Length = 0;
                    break;
                case '\"':
                    result.Append('\'');
                    result.Append(currentArgument.ToString());
                    result.Append("\"\',");
                    currentArgument.Length = 0;
                    break;
                default:
                    currentArgument.Append(attributeValue[pos]);
                    break;
            }
        }
        if (currentArgument.Length == 0)
        {
            result[result.Length - 1] = ')';
        }
        else
        {
            result.Append("'");
            result.Append(currentArgument.ToString());
            result.Append("')");
        }
        return result.ToString();
    } 
```

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2009-03-13T13:52:29.040

这就是我想出的

```
public static string EncaseXpathString(string input)
{         
    // If we don't have any " then encase string in "
    if (!input.Contains("\""))
        return String.Format("\"{0}\"", input);

    // If we have some " but no ' then encase in '
    if (!input.Contains("'"))
        return String.Format("'{0}'", input);

    // If we get here we have both " and ' in the string so must use Concat
    StringBuilder sb = new StringBuilder("concat(");           

    // Going to look for " as they are LESS likely than ' in our data so will minimise
    // number of arguments to concat.
    int lastPos = 0;
    int nextPos = input.IndexOf("\"");
    while (nextPos != -1)
    {
        // If this is not the first time through the loop then seperate arguments with ,
        if (lastPos != 0)
            sb.Append(",");

        sb.AppendFormat("\"{0}\",'\"'", input.Substring(lastPos, nextPos - lastPos));
        lastPos = ++nextPos;

        // Find next occurance
        nextPos = input.IndexOf("\"", lastPos);
    }

    sb.Append(")");
    return sb.ToString();
} 
```

使用类似的东西调用

```
XmlNode node = doc.SelectSingleNode("//review[@name=" + EncaseXpathString("Fred's \"Fancy Pizza\"" + "]") 
```

所以我们得到以下结果

```
EncaseXpathString("Pizza Shed") == "'Pizza Shed'";
EncaseXpathString("Bob's pizza") == "\"Bob's Pizza\"";
EncaseXpathString("\"Pizza\" Pam" == "'\"Pizza\" Pam'";
EncaseXpathString("Fred's \"Fancy Pizza\"") == "concat(\"Fred's \",'\"',\"Fancy Pizza\",'\"')"; 
```

所以它只在必要时使用 concat （字符串中的 " 和 ' ）

最后一个结果表明 concat 操作并不像它可能的那么短（请参阅问题），但它足够接近并且任何更优化的东西都将非常复杂，因为您必须寻找匹配的“或”对。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2011-07-10T23:45:21.750

到目前为止，我对所有解决方案都有问题。一个有额外的文本部分（例如'“'或“'”），这会破坏你正在寻找的内容。一个会在最后一个引号/dblquote 之后删除所有文本，这也会中断。

这是来自愚蠢的 vb 开发人员的愚蠢而快速的解决方案：

```
Function ParseXpathString(ByVal input As String) As String
    input = Replace(input, "'", Chr(1))
    input = Replace(input, """", Chr(2))
    input = Replace(input, Chr(1), "',""'"",'")
    input = Replace(input, Chr(2), "','""','")
    input = "concat('','" + input + "')"
    Return input
End Function 
```

用法（与前面的示例相同）：

```
x.SelectNodes("/path[@attr=" & ParseXpathString(attrvalue) & "]") 
```

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-06-02T20:27:03.133

另一种变化......我的 concat() 部分有点懒惰，但至少它使用了整个值。

```
 /// <summary>
    /// Returns an XPath string literal to use for searching attribute values (wraped in apostrophes, quotes, or as a concat function).
    /// </summary>
    /// <param name="attributeValue">Attribute value to encode and wrap.</param>
    public static string CreateXpathLiteral(string attributeValue)
    {
        if (!attributeValue.Contains("\""))
        {
            // if we don't have any quotes, then wrap string in quotes...
            return string.Format("\"{0}\"", attributeValue);
        }
        else if (!attributeValue.Contains("'"))
        {
            // if we have some quotes, but no apostrophes, then wrap in apostrophes...
            return string.Format("'{0}'", attributeValue);
        }
        else
        {
            // must use concat so the literal in the XPath will find a match...
            return string.Format("concat(\"{0}\")", attributeValue.Replace("\"", "\",'\"',\""));
        }
    } 
```

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2011-04-26T15:03:21.933

我需要在 XSLT 本身中执行此操作，因此根据此页面上的答案提出以下内容：

```
<xsl:template name="escape-string">
  <xsl:param name="string"/>
  <xsl:param name="concat" select="true()"/>
  <xsl:variable name="quote">"</xsl:variable>
  <xsl:variable name="apos">'</xsl:variable>
  <xsl:choose>
    <xsl:when test="not(contains($string, $apos))">'<xsl:value-of select="$string"/>'</xsl:when>
    <xsl:when test="not(contains($string, $quote))">"<xsl:value-of select="$string"/>"</xsl:when>
    <xsl:otherwise>
      <xsl:if test="$concat">concat(</xsl:if>
      <xsl:call-template name="escape-string">
        <xsl:with-param name="string" select="substring-before($string, $apos)"/>
        <xsl:with-param name="concat" select="false()"/>
      </xsl:call-template>
      <xsl:text>, "'", </xsl:text>
      <xsl:call-template name="escape-string">
        <xsl:with-param name="string" select="substring-after($string, $apos)"/>
        <xsl:with-param name="concat" select="false()"/>
      </xsl:call-template>
      <xsl:if test="$concat">)</xsl:if>
    </xsl:otherwise>
  </xsl:choose>
</xsl:template> 
```

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2010-09-28T22:39:41.627

加入乐趣

```
public string XPathLiteral(string text) {

    const string APOS = "'";
    const string QUOTE = @"""";

    int pos = 0;

    int posApos;
    int posQuote;

    posQuote = text.IndexOf(QUOTE, pos);

    if (posQuote < 0) {
        return QUOTE + text + QUOTE;
    }//if

    posApos = text.IndexOf(APOS, pos);

    if (posApos < 0) {
        return APOS + text + APOS;
    }//if

    bool containsApos = posApos < posQuote;

    StringBuilder sb = new StringBuilder("concat(", text.Length * 2);

    bool loop = true;
    bool comma = false;

    while (loop) {

        if (posApos < 0) {
            posApos = text.Length;
            loop = false;
        }//if

        if (posQuote < 0) {
            posQuote = text.Length;
            loop = false;
        }//if

        if (comma) {
            sb.Append(",");
        } else {
            comma = true;
        }//if

        if (containsApos) {
            sb.Append(QUOTE);
            sb.Append(text.Substring(pos, posQuote - pos));
            sb.Append(QUOTE);
            pos = posQuote;
            if (loop) posApos = text.IndexOf(APOS, pos + 1);
        } else {
            sb.Append(APOS);
            sb.Append(text.Substring(pos, posApos - pos));
            sb.Append(APOS);
            pos = posApos;
            if (loop) posQuote = text.IndexOf(QUOTE, pos + 1);
        }//if

        // Toggle
        containsApos = !containsApos;

    }//while

    sb.Append(")");

    return sb.ToString();

}//method 
```

# html - 半透明图片边框

> ID：642130
> 
> 赞同：0
> 
> 时间：2009-03-13T10:45:39.320
> 
> 标签：html, css, transparency

我希望图像渗入容器 div.imgborder 并且我希望出血是半透明的（就像不透明的玻璃效果）。有没有办法通过 CSS 实现这一点，或者在 div.imgborder 上设置一个不透明的图像背景？

```
<!DOCTYPE HTML PUBLIC '-//W3C//DTD HTML 4.01//EN'
        'http://www.w3.org/TR/html4/strict.dtd'>
<html>
<head>
<title></title>

<meta name='keyword' content=''>
<meta name='description' content=''>

<link rel='stylesheet' href='reset.css'>

<style type='text/css'>
    body {
      background-color: #ccc;   
    }

    div#container {
      width: 960px;
      margin-left: auto; 
      margin-right: auto;
      margin-top: 50px;
    }

    img#myimg {
      overflow: visible;
    }

    div.imgborder {
      background-color: #222;
      opacity: 0.9;
      width: 160px;
      height: 160px;
      padding: 10px;
    }

</style>

</head>
<body>
    <div id='container'>

        <div class='imgborder' align='center'>
            <img src='bar.jpg' alt='' width='160' height='160' id='myimg' />
        </div>

    </div>
</body>
</html> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-13T10:55:59.683

Gecko 和 WebKit 支持将 rgba() 设置为边框颜色属性，因此您可以设置：

```
border-color: rgba(255,255,255,0.42); 
```

..并且有一个半透明的边框。

然而，要完成出血，您可能需要在图像上覆盖一个透明 div，并为其设置一个宽度和高度，该宽度和高度等于图像的宽度和高度减去边框的宽度。因此，如果图像是 200x200，并且您想要一个 2px 的边框，您可能必须将 div 设置为 196x196，因为框模型规定边框宽度被添加到宽度/高度尺寸中。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-13T10:50:32.303

您可以创建一个具有您喜欢的半透明效果的 PNG 文件并将其添加为背景。任何现代浏览器都会正确呈现并创建您想要的效果。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-13T11:00:56.880

这是 js & css 解决方案，但值得一提

[GlassBox-JS](http://www.glassbox-js.com/)

# vb.net - 我将如何在我的项目中构建安装程序？

> ID：642132
> 
> 赞同：0
> 
> 时间：2009-03-13T10:46:35.057
> 
> 标签：vb.net

在我的程序中制作安装程序时出现错误。我在调试文件夹中有图像，我在我的程序中使用这些图像。我成功创建了安装程序，问题是当我运行它时，它会给我一条错误消息，正在寻找我的图像文件夹。

我该如何解决这个问题？谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-13T11:12:25.447

如果这是一个 VisualStudio 安装项目，请确保：

*   在您的解决方案中包含您的图像文件夹和其中的图像
*   确保为您需要的所有图像设置 BuildAction 属性`Content`
*   让您的安装项目还将内容从正确的项目安装到文件系统中您的应用程序需要这些图像的正确位置
*   构建您的设置项目并测试安装程序是否按预期安装图像

（这只是一个快速的答案，也许可以让您朝着正确的方向开始。您的问题似乎并不那么清楚，所以也许我完全误解了您遇到的问题。）

# jquery - 使用 jQuery UI Datepicker 可编辑

> ID：642136
> 
> 赞同：9
> 
> 时间：2009-03-13T10:47:23.450
> 
> 标签：jquery, forms, calendar, datepicker, jeditable

我需要单击以编辑页面上的元素，这将反过来调用 jQuery UI Datepicker 的实例。

目前，我正在使用 JEditable 提供就地编辑，效果很好。但是，我有一个日期控制输入，我希望它显示为日历，这就是有趣的开始。

我在Calle Kabo的这篇[博客中找到了一条评论（不幸的是，该页面有点混乱），其中详细介绍了一种方法：](http://www.appelsiini.net/2008/2/creating-inline-timepicker-with-javascript)

```
$.editable.addInputType("datepicker", {
        element:  function(settings, original) {
            var input = $("<input type=\"text\" name=\"value\" />");
            $(this).append(input);
            return(input);
        },
        plugin:  function(settings, original) {
            var form = this;
            $("input", this).filter(":text").datepicker({
                onSelect: function(dateText) { $(this).hide(); $(form).trigger("submit"); }
            });
        }
    }); 
```

但是，我无法让上述工作 - 没有错误，但也没有效果。我已经尝试将它放在 jQuery 文档就绪函数中以及它之外 - 不高兴。

我的 UI Datepicker 类是 date-picker 而我的 Jeditable 类是 ajaxedit，我确信上述不作为是由于需要在代码中以某种方式引用它们，但我不知道如何。此外，Jeditable 控件是许多元素 id 之一，如果有影响的话。

有更多知情人士的想法吗？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-09-10T18:18:12.163

我看了上面提到的源代码，但它似乎有点错误。我认为它可能是为旧版本的日期选择器设计的，而不是为 jQuery UI 日期选择器设计的。我对代码进行了一些修改，经过修改后，它至少可以在 Firefox 3、Safari 4、Opera 9.5 和 IE6+ 中运行。仍然可能需要在其他浏览器中进行更多测试。

这是我使用的代码（保存在名为*jquery.jeditable.datepicker.js*的文件中）

```
$.editable.addInputType('datepicker', {
    element : function(settings, original) {
        var input = $('<input>');
        if (settings.width  != 'none') { input.width(settings.width);  }
        if (settings.height != 'none') { input.height(settings.height); }
        input.attr('autocomplete','off');
        $(this).append(input);
        return(input);
    },
    plugin : function(settings, original) {
        /* Workaround for missing parentNode in IE */
        var form = this;
        settings.onblur = 'ignore';
        $(this).find('input').datepicker().bind('click', function() {
            $(this).datepicker('show');
            return false;
        }).bind('dateSelected', function(e, selectedDate, $td) {
            $(form).submit();
        });
    }
}); 
```

示例实现代码：

```
$(".datepicker-initiative").editable('inc/ajax/saveInitiative.php', {
     type: 'datepicker',
     tooltip: 'Double-click to edit...',
     event: 'dblclick',
     submit: 'OK',
     cancel: 'Cancel',
     width: '100px'
}); 
```

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2011-05-07T17:36:17.143

jeditable [-datepicker](https://github.com/qertoip/jeditable-datepicker)插件似乎完全符合您的需要。

它在 Jeditable 中启用 jQuery UI Datepicker。这是[演示](http://thesingularity.pl/jeditable-datepicker-demo)。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-10-22T13:48:01.007

这是我的解决方案。我使用自定义日期格式并在 datepicker 关闭时重置输入表单并应用 cssdecoration（我的可编辑改进）。使用 jQuery UI 1.5.2

```
$.editable.addInputType('datepicker', {
element : function(settings, original) {
    var input = $('<input>');
    if (settings.width  != 'none') { input.width(settings.width);  }
    if (settings.height != 'none') { input.height(settings.height); }
    input.attr('autocomplete','off');
    $(this).append(input);
    return(input);
},
plugin : function(settings, original) {
    /* Workaround for missing parentNode in IE */
    var form = this;
    settings.onblur = 'ignore';
    $(this).find('input').datepicker({
        firstDay: 1,
        dateFormat: 'dd/mm/yy',
        closeText: 'X',
        onSelect: function(dateText) { $(this).hide(); $(form).trigger("submit"); },
        onClose: function(dateText) {
            original.reset.apply(form, [settings, original]);
            $(original).addClass( settings.cssdecoration );
            },
    });
}}); 
```

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-03-26T10:11:00.380

我有同样的问题。[在http://www.appelsiini.net/projects/jeditable/custom.html](http://www.appelsiini.net/projects/jeditable/custom.html)的源代码中搜索让我找到了解决方案。

有一个“jquery.jeditable.datepicker.js”。把它放在我的代码中并添加了一个新函数“datepicker”（也在源代码中）。

我不知道您的脚本是如何工作的，但在我的情况下，该功能还需要：

> id : '元素id',
> 
> 名称：'编辑'

将数据存储在数据库中。

hth :)

达贝柳

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2010-01-13T05:18:18.620

这是我的解决方案，但不是完整的可编辑输入类型。

```
$.editable.addInputType('date', {
    element : function(settings, original) {
        var input = $('<input type="text" readonly="readonly" name="value" size="10 />');
        $(this).append(input);
        return(input);
    },
    plugin : function(settings, original) {
        var form = this;
        settings.onblur = 'cancel';
        $(this).find('input').datepicker({
            dateFormat: 'yy-mm-dd',
            onSelect: function(dateText) { $(this).hide(); $(form).trigger("submit"); },
            onClose: function(dateText) { $(this).hide(); $(form).trigger("submit");}
        });            
    },
    submit  : function(settings, original) { },
    reset   : function(settings, original) { }
}); 
```

# html - 在 HTML 中保留换行符但换行：可能吗？

> ID：642140
> 
> 赞同：6
> 
> 时间：2009-03-13T10:48:02.777
> 
> 标签：html, css, layout

我今天遇到了一个有趣的问题。我有一封从网页发送的文本电子邮件。我正在显示预览，并希望将预览放在保留空白的固定字体中，因为这是纯文本电子邮件的显示方式。

基本上我想要一些像记事本一样的东西：换行符会发出换行符的信号，但文本会换行以适应它的容器。

不幸的是，除非我遗漏了一些非常明显的东西，否则这很困难。我试过了：

1.  CSS `white-space: pre`。这会保留空白但不会换行文本，因此它们会超出长行的边界；

2.  将 textarea 元素设置为只读且没有边框，因此它基本上看起来像`div`. 这里的问题是 IE 不喜欢严格模式下 textareas 的 100% 高度。奇怪的是，他们在怪癖模式下没问题，但这对我来说不是一个选择。

3.  CSS `white-space: prewrap`。这是 CSS 2.1，所以可能没有得到广泛支持（不过，如果 IE7 和 FF3 支持它，我很高兴；我不关心 IE6，因为它是一种管理功能，没有人会运行 IE6 来使用这个页面） .

还有其他建议吗？这真的有那么难吗？

编辑：无法评论更多信息。是的，目前我正在使用字体 Courier New（即固定宽度）并在服务器端使用正则表达式用`<br>`标签替换换行符，但现在我需要编辑内容，这让我觉得很尴尬，你需要去掉并添加`<br>`s 使其工作。

没有更好的办法吗？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-03-13T18:26:55.573

尝试

```
selector {
  word-wrap: break-word; /* IE>=5.5 */
  white-space: pre; /* IE>=6 */
  white-space: -moz-pre-wrap; /* For Fx<=2 */
  white-space: pre-wrap; /* Fx>3, Opera>8, Safari>3*/
} 
```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2009-03-13T10:57:54.297

只需用所需的宽度替换所有硬换行符`<br/>`并将文本放入 a中。`div`您可以对空格执行相同操作：将它们替换为`&nbsp;`.

确保在将特殊字符转义为 HTML*后*
执行此操作，否则不会被解释而是打印在页面上。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2009-03-13T11:27:23.617

尝试用 - 替换任何双空格，`&nbsp;``&nbsp;`这应该可以让你看起来像双空格。

破解所有那些新的线路并用`<br />`.

使用 font-family 设置文本输出的样式，使其看起来像一个固定宽度：

```
font-family:monospace; 
```

您可能需要适当地调整它的大小，使其比周围的文本更小，但这会给您一个 PRE 的外观，以及纯文本电子邮件的外观。

把它全部放在一个带有固定的 DIV 中，这可能值得一看。

* * *

## 回答 #4

> 赞同：-2
> 
> 时间：2009-03-13T10:58:29.380

创建一个`<pre></pre>`标签或使用
`<p style="width:800px"> .... </p>`

固定宽度的东西，我认为文本被包装

# python - 如何将字符串转换为整数？

> ID：642154
> 
> 赞同：455
> 
> 时间：2009-03-13T10:53:59.407
> 
> 标签：python, string, integer

我有一个来自 MySQL 查询的元组，如下所示：

```
T1 = (('13', '17', '18', '21', '32'),
      ('07', '11', '13', '14', '28'),
      ('01', '05', '06', '08', '15', '16')) 
```

我想将所有字符串元素转换为整数并将它们放回列表列表中：

```
T2 = [[13, 17, 18, 21, 32], [7, 11, 13, 14, 28], [1, 5, 6, 8, 15, 16]] 
```

我试图用它来实现它，`eval`但还没有得到任何体面的结果。

* * *

## 回答 #1

> 赞同：650
> 
> 时间：2009-03-13T10:58:42.220

[`int()`](https://docs.python.org/3/library/functions.html#int)是将字符串转换为整数值的 Python 标准内置函数。您使用包含数字作为参数的字符串调用它，它返回转换为整数的数字：

```
>>> int("1") + 1
2 
```

如果您知道列表的结构 T1（它只包含列表，只有一层），您可以在 Python 3 中执行此操作：

```
T2 = [list(map(int, x)) for x in T1] 
```

在 Python 2 中：

```
T2 = [map(int, x) for x in T1] 
```

* * *

## 回答 #2

> 赞同：28
> 
> 时间：2009-03-13T11:02:30.573

您可以通过列表理解来做到这一点：

```
T2 = [[int(column) for column in row] for row in T1] 
```

内部列表推导 ( )从一系列-able 对象（如十进制字符串`[int(column) for column in row]`）中构建 a `list`of s 。外部列表推导 ( ) 构建应用到中每个项目的内部列表推导结果的列表。`int``int``row``[... for row in T1])``T1`

如果任何行包含无法转换的对象，则代码片段将失败`int`。如果要处理包含非十进制字符串的行，则需要一个更智能的函数。

如果您知道行的结构，则可以将内部列表推导替换为对行的函数的调用。例如。

```
T2 = [parse_a_row_of_T1(row) for row in T1] 
```

* * *

## 回答 #3

> 赞同：17
> 
> 时间：2009-05-12T23:33:41.440

我宁愿只使用理解列表：

```
[[int(y) for y in x] for x in T1] 
```

* * *

## 回答 #4

> 赞同：11
> 
> 时间：2014-01-24T22:56:32.900

而不是 put `int( )`， put`float( )`可以让你使用小数和整数。

* * *

## 回答 #5

> 赞同：10
> 
> 时间：2009-03-13T14:05:10.867

到目前为止，我同意每个人的答案，但问题是，如果你没有所有整数，它们会崩溃。

如果您想排除非整数，那么

```
T1 = (('13', '17', '18', '21', '32'),
      ('07', '11', '13', '14', '28'),
      ('01', '05', '06', '08', '15', '16'))
new_list = list(list(int(a) for a in b) for b in T1 if a.isdigit()) 
```

这仅产生实际数字。我不使用直接列表推导的原因是因为列表推导泄露了它们的内部变量。

* * *

## 回答 #6

> 赞同：9
> 
> 时间：2015-05-30T17:38:14.753

试试这个。

```
x = "1" 
```

x 是一个字符串，因为它有引号，但它有一个数字。

```
x = int(x) 
```

因为 x 里面有数字 1，所以我可以把它变成一个整数。

要查看字符串是否为数字，您可以执行此操作。

```
def is_number(var):
    try:
        if var == int(var):
            return True
    except Exception:
        return False

x = "1"

y = "test"

x_test = is_number(x)

print(x_test) 
```

它应该打印到 IDLE True 因为 x 是一个数字。

```
y_test = is_number(y)

print(y_test) 
```

它应该打印为 IDLE False，因为 y 不是数字。

* * *

## 回答 #7

> 赞同：8
> 
> 时间：2011-03-24T22:53:40.640

```
T3=[]

for i in range(0,len(T1)):
    T3.append([])
    for j in range(0,len(T1[i])):
        b=int(T1[i][j])
        T3[i].append(b)

print T3 
```

* * *

## 回答 #8

> 赞同：4
> 
> 时间：2009-03-13T11:06:14.590

使用列表推导：

```
t2 = [map(int, list(l)) for l in t1] 
```

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2016-08-04T23:22:12.187

Python 2 的另一个功能解决方案：

```
from functools import partial

map(partial(map, int), T1) 
```

Python 3 会有点混乱：

```
list(map(list, map(partial(map, int), T1))) 
```

我们可以用包装器解决这个问题

```
def oldmap(f, iterable):
    return list(map(f, iterable))

oldmap(partial(oldmap, int), T1) 
```

* * *

## 回答 #10

> 赞同：3
> 
> 时间：2017-07-13T06:22:58.080

看到这个功能

```
def parse_int(s):
    try:
        res = int(eval(str(s)))
        if type(res) == int:
            return res
    except:
        return 
```

然后

```
val = parse_int('10')  # Return 10
val = parse_int('0')  # Return 0
val = parse_int('10.5')  # Return 10
val = parse_int('0.0')  # Return 0
val = parse_int('Ten')  # Return None 
```

你也可以检查

```
if val == None:  # True if input value can not be converted
    pass  # Note: Don't use 'if not val:' 
```

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2016-05-27T17:17:22.480

在 Python 3.5.1 中，类似这样的工作：

```
c = input('Enter number:')
print (int(float(c)))
print (round(float(c))) 
```

和

```
Enter number:  4.7
4
5 
```

乔治。

* * *

## 回答 #12

> 赞同：2
> 
> 时间：2020-06-22T11:31:39.990

Python 内置了函数 int(string) 和可选参数库。

如果您的字符串包含一个整数值，它会将其转换为相应的整数值。但是，如果您将十进制数字作为字符串，则需要 float() 来转换它。

用法：

```
a = '22'
b = int(a) 
```

和

```
if a = '22.22'
b = int(a) '''will give error, invalid literal for int().'''
b = float(a) '''will convert the string.''' 
```

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2009-03-13T11:04:40.863

如果它只是一个元组的元组，那么类似的东西`rows=[map(int, row) for row in rows]`就可以了。（其中有一个列表理解和一个​​对 map(f, lst) 的调用，它等于 [f(a) for a in lst]。）

Eval*不是*您想要做的，以防由于`__import__("os").unlink("importantsystemfile")`某种原因在您的数据库中有类似的东西。始终验证您的输入（如果没有其他内容，如果输入错误，将引发异常 int()）。

* * *

## 回答 #14

> 赞同：-2
> 
> 时间：2018-05-01T13:23:44.813

你可以这样做：

```
T1 = (('13', '17', '18', '21', '32'),  
     ('07', '11', '13', '14', '28'),  
     ('01', '05', '06', '08', '15', '16'))  
new_list = list(list(int(a) for a in b if a.isdigit()) for b in T1)  
print(new_list) 
```

* * *

## 回答 #15

> 赞同：-2
> 
> 时间：2019-01-24T15:39:20.490

我想分享一个这里似乎还没有提到的可用选项：

```
rumpy.random.permutation(x) 
```

将生成数组 x 的随机排列。不*完全*是您所要求的，但它是类似问题的潜在解决方案。

# objective-c - 从主线程终止辅助线程（可可）

> ID：642163
> 
> 赞同：6
> 
> 时间：2009-03-13T10:56:58.153
> 
> 标签：objective-c, cocoa, multithreading

我正在可可框架的帮助下开发一个用objective-c编写的小应用程序，但我遇到了多线程问题。如果有人可以帮助我就如何从主线程终止辅助（工作）线程提供一些指导，我将非常感激？

```
- (IBAction)startWorking:(id)sender {
     [NSThread detachNewThreadSelector:@selector(threadMain:) toTarget:self withObject:nil];
}

- (void)threadMain
{
  // do a lot of boring, time consuming I/O here..
}

- (IBAction)stop:(id)sender {
  // what now?
} 
```

我在[苹果的文档](http://developer.apple.com/documentation/Cocoa/Conceptual/Multithreading/CreatingThreads/CreatingThreads.html#//apple_ref/doc/uid/10000057i-CH15-SW10 "苹果的文档")上找到了一些东西，但是这个例子中缺少的是 runloop 输入源更改*exitNow*值的部分。

另外，我不会在我的应用程序中使用很多线程，所以我更喜欢一个简单的解决方案（开销更少）而不是一个能够轻松管理多个线程但产生更多开销的更复杂的解决方案（例如使用锁也许（？）而不是运行循环）

提前致谢

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-03-13T11:04:29.477

我认为最简单的方法是使用 NSThread 的[-(void)cancel 方法](http://developer.apple.com/DOCUMENTATION/Cocoa/Reference/Foundation/Classes/NSThread_Class/Reference/Reference.html)。您还需要对您创建的线程的引用。如果您可以将工作线程作为循环执行，您的示例代码将如下所示：

```
- (IBAction)startWorking:(id)sender {
     myThread = [[NSThread alloc] initWithTarget:self selector:@selector(threadMain:) object:nil];
     [myThread start];
}

- (void)threadMain
{
    while(1)
    {
        // do IO here
        if([[NSThread currentThread] isCancelled])
            break;
    }
}

- (IBAction)stop:(id)sender {
   [myThread cancel];
   [myThread release];
   myThread = nil; 
} 
```

当然，这只会取消循环迭代之间的线程。因此，如果您正在进行一些长时间的阻塞计算，您必须找到一种方法将其分解为多个部分，以便您可以定期检查 isCancelled。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-13T23:47:26.227

还要看看 NSOperation 和 NSOperationQueue 类。这是另一组线程类，使开发工作线程模型变得非常容易。

# delphi - 在 Delphi 中创建 TCustomComboBox 后代

> ID：642165
> 
> 赞同：2
> 
> 时间：2009-03-13T10:57:28.417
> 
> 标签：delphi

我正在尝试基于 Delphi 2007 中的 TCustomComboBox 创建自定义控件，但我被困在第一个障碍上。

我正在尝试覆盖下拉列表的显示方式，主要是显示的文本，查看 stdctrls.pas 中 TCustomComboBox 的源代码，看起来我只需要覆盖 DrawItem 但它不起作用，因为我的代码被覆盖的方法永远不会被执行。

我查看了几个开源组件源代码，看看他们是如何做到的，但我仍然不知所措。

这是我到目前为止所拥有的（承认不多）

```
type
  TKeyValueComboBox = class(TCustomComboBox)
  private
    { Private declarations }
    //FColumns:Integer;
  protected
    { Protected declarations }
    procedure DrawItem(Index: Integer; Rect: TRect; State: TOwnerDrawState);override; 
  public
    { Public declarations }
    constructor Create(AOwner: TComponent); override;
    destructor Destroy; override;
  published
end; 
```

和

```
procedure TKeyValueComboBox.DrawItem(Index: Integer; Rect: TRect;
  State: TOwnerDrawState);
begin
  TControlCanvas(Canvas).UpdateTextFlags;
  if Assigned(OnDrawItem) then OnDrawItem(Self, Index, Rect, State)
  else
  begin
    Canvas.FillRect(Rect);
    Canvas.TextOut(Rect.Left + 2, Rect.Top, Items[Index]+'-HELLO');
  end;
end; 
```

有谁知道我需要使用什么方法来获得我的覆盖版本的火？或者我做错了什么？

任何帮助，将不胜感激。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-13T11:03:09.637

还有一个必须设置的属性，从内存中它是 DrawingStyle := dsCustomDraw 将它放在构造函数中或加载。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-13T11:01:40.590

您是否启用了所有者绘图？默认情况下，它已停用。尝试使用标准组合框进行自定义绘图工作，然后创建自定义控件，应用所有必要的设置。

# .net - 调整窗口大小时，为什么我的 Windows 窗体没有重绘？

> ID：642171
> 
> 赞同：1
> 
> 时间：2009-03-13T11:00:06.740
> 
> 标签：.net, winforms

我有一个简单的表格，如下所示：

```
using System;
using System.Drawing;
using System.Windows.Forms;

namespace PaintTest
{
   class PaintTest : Form
   {
      int _counter = 0;

      [STAThread]
      static void Main()
      {
         Application.Run(new PaintTest());
      }

      protected override void OnPaint(PaintEventArgs e)
      {
         e.Graphics.DrawString(_counter.ToString(), new Font(FontFamily.GenericSerif, 10.0f), Brushes.Blue, 10.0f, 10.0f);
         _counter++;
      }
   }
} 
```

调整窗口大小时，计数器似乎不会在屏幕上更新，即使`OnPaint()`被调用并且计数器递增。如何在调整窗口大小时使表单重新绘制自身？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-13T11:00:54.367

将以下内容添加到您的类中，例如在其构造函数中：

`SetStyle(ControlStyles.ResizeRedraw, true);`

# iphone - iPhone 应用程序在第 3.3.3 节被拒绝（但这意味着什么？）

> ID：642188
> 
> 赞同：4
> 
> 时间：2009-03-13T11:05:57.787
> 
> 标签：iphone, app-store

我制作了一个 iPhone 应用程序，它显示了几张来自互联网的图片，您可以在其中发表评论（iPhone 短信气泡样式）

我的应用被拒绝的原因是：

> 1.  我们不能将此版本的 iPhone 应用程序发布到 App Store，因为它违反了 iPhone SDK 协议第 3.3.3 节；
> 
> “未经 Apple 事先书面批准，应用程序不得通过 iTunes Store 以外的分发机制提供、解锁或启用其他特性或功能。”
> 
> 如果您想向一群朋友提供仅限邀请的应用程序的预发布版本，那么我们鼓励您使用 Ad Hoc 应用程序分发方法。请转到 iPhone 开发人员门户中的分发选项卡以获取有关 Ad Hoc 分发的完整信息。

但是这是什么意思？我在网上浏览了一下，发现这涵盖了与 Apple 的应用程序相似的应用程序？

有没有人有这方面的经验？并且知道如何解决这个问题？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-17T08:05:26.230

我得到了苹果的官方回应

> 该应用程序的网站组件目前不向公众开放。如果您想向一群朋友提供仅限邀请的应用程序的预发布版本，那么我们鼓励您使用 Ad Hoc 应用程序分发方法。
> 
> 请转到 iPhone 开发人员门户中的分发选项卡以获取有关 Ad Hoc 分发的完整信息。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-13T11:09:04.287

第 3.3.3 节

> 未经 Apple 事先书面批准，应用程序不得通过 App Store 以外的分发机制提供、解锁或启用其他特性或功能。

这意味着，例如，您不允许您的应用程序下载音乐或播客文件。苹果希望 iPhone 的所有者为此目的使用 iTunes。

您似乎违反了该部分，因为您提供的内容来自您的网站，即使您只下载图片也是如此。

请参阅[有关 PodCaster 应用程序的博客条目](http://www.roughlydrafted.com/2008/09/15/sdk-333-the-iphone-podcaster-surprise-myth/)：

> Podcaster 显然可以使用 iTunes Store 之外的分发机制来解锁一项功能。此限制还包括旨在安装独立于 iTunes 的其他应用程序的应用程序（例如 Cydia 越狱应用程序 - 它也不在 Apps Store 中），或任何其他分发歌曲、电视或电影下载或播客的应用程序。

另请参阅 Stack Overflow 上的此答案：[Apple 商店拒绝 iPhone 应用程序的原因](https://stackoverflow.com/questions/308479/reasons-for-rejecting-iphone-application-by-apple-store/308488#308488)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-13T14:35:14.650

或者他们认为您使用开放式 SDK 来重用 SMS 应用程序中的气泡控件。

可以发截图吗？

# project-management - 用于估计发货日期的简单工具，没有不确定性

> ID：642192
> 
> 赞同：-1
> 
> 时间：2009-03-13T11:07:15.303
> 
> 标签：project-management, estimation, fogbugz

我正在寻找的东西非常简单：我想要一个工具来计算计算的，而不是基于置信区间估计的，发货日期给定一个任务列表，其中包含总估计和当前进度，而不会像我想要的那样引入进一步的不确定性从外部处理。

我希望它考虑工作日持续时间和用户输入的假期等。

我知道 Fogbugz 的 Evidence Base Scheduling 做的事情非常接近，但我希望它没有统计方面和相关的置信区间。我知道这是一个极大的简化，统计估计是 EBS 的本质，但我不是在这里寻找主观讨论，我只是希望能够在任何给定的情况下访问这个简单的信息（所谓的确切发货日期）项目期间的时间，而不必自己计算。

所以我正在寻找以下三件事之一：1）一种自定义 Fogbugz（6.0）的方法，以向我展示除置信区间之外我想要的信息 2）一种自定义 Fogbugz 以将估计不确定性设置为 0 3）另一种工具（免费) 这正是我想要的。

**编辑：**我所说的“假定准确”或“经过计算”，并不是指实际将要发生的事情，这确实是在试图预测未来。我的意思是关于输入的信息，以及它明显的不确定性。在这种情况下，我想对单个任务的估计应该更多地被视为支出限制或上限。我希望能够计算出的信息非常简单：如果一切都完全按照规定进行，那么它将带我们去哪里？然后，通过有关如何进行估计的信息，例如每个开发人员做出良好估计的能力，我可以推导出置信区间。EBS 会自动执行此操作，毫无疑问，这非常好，这就是我使用它的原因。我想要的是再获得一点点信息，

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-13T23:04:39.073

FogBugz 将在 LIST 页面底部显示估计总和，标记为“总估计剩余时间”。这是估算的原始总和，没有任何 EBS 计算。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-13T11:17:26.980

你无法预测未来。因此，任何计算出的发货日期都只能是猜测。该猜测取决于进入其中的每个单独数字的置信区间。这是一个定义问题——即使你可能不喜欢它。

您可能希望有一个“100% 自信”的日期，但这样的事情（根据定义）不可能存在。除非您想要一个无限远的日期，否则您的不确定性不能为零。这是统计的本质：分布实际上是无限的，但数据更有可能聚集在平均值附近。

你唯一能做的就是选择一个非常大的置信区间（99.7%）。您可以随意忽略有关置信区间的支持性统计事实，并假装它的不确定性为零。出于所有实际目的，0.3% 的不确定性足够小，您不会对那个日期不满意。

然而，所有基于统计的未来预测都必须具有不确定性。这是一条法律。

# c# - 如何从excel表中只获取所需的表格

> ID：642193
> 
> 赞同：0
> 
> 时间：2009-03-13T11:07:41.123
> 
> 标签：c#

我正在尝试从 Excel 工作表中检索数据。我正在获取表格数据以及其他额外数据。那么如何只从 Excel 工作表中检索表格。这是我得到的：

我不想要前 3 行。

```
 sdfdsfdsf   
                       dfg      hjk

Sl No   Name    Code    Date    Time    Door Name   Shift   Department  Grade
1   Channabasappa   535 01/Dec/08   9:37    WORK CENTER IN  General Shift   Payroll A
2   Channabasappa   535 01/Dec/08   13:42   WORK CENTER OUT General Shift   Payroll A
3   Channabasappa   535 01/Dec/08   15:40   WORK CENTER OUT General Shift   Payroll A
4   Channabasappa   535 01/Dec/08   16:09   WORK CENTER IN  General Shift   Payroll A
5   Channabasappa   535 01/Dec/08   17:42   WORK CENTER OUT General Shift   Payroll A
6   Channabasappa   535 01/Dec/08   17:43   WORK CENTER IN  General Shift   Payroll A
7 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-13T11:20:33.930

我们需要查看您的代码才能传递评论。

但我认为您会发现[这篇博](http://blog.lab49.com/archives/196)文非常有用，它解释了使用 ADO.NET 阅读 Excel 工作表时需要注意的一些怪癖。

# apache-flex - 更改 NativeMenuItem 的标签

> ID：642195
> 
> 赞同：0
> 
> 时间：2009-03-13T11:08:08.907
> 
> 标签：apache-flex, flash, actionscript-3, air

我正在 Flex Builder 中试验 Adob​​e AIR 和 Google Maps API。问题是，我正在制作一个 NativeMenu，并且想知道，当舞台处于全屏状态时，如何将“全屏”项目的标签更改为“退出全屏”？

如果您在代码中看到任何可以/应该写得更好的东西，请告诉我；）

这是我的代码：

```
<?xml version="1.0" encoding="utf-8"?>
<mx:WindowedApplication 
xmlns:mx="http://www.adobe.com/2006/mxml" 
layout="absolute"
height="600"
width="700"
minHeight="100"
minWidth="100"
showStatusBar="false"
title="Gmaps 0.002"
>
<maps:Map 
xmlns:maps="com.google.maps.*" 
id="map" 
mapevent_mapready="onMapReady(event)" 
width="100%" 
height="100%" 
url="" 
key=""
/>

   <mx:Button id="fullscreenButton" click="toggleFullScreen()"/>
<mx:Script>
<![CDATA[

import com.google.maps.LatLng;
import com.google.maps.Map;
import com.google.maps.MapEvent;
import com.google.maps.MapType;
import com.google.maps.MapMouseEvent;
import com.google.maps.controls.MapTypeControl;
import com.google.maps.controls.ZoomControl;
import com.google.maps.controls.PositionControl;
import flash.display.NativeMenu;
import flash.display.NativeMenuItem;
import flash.events.Event;
import mx.core.Window;
import flash.display.StageDisplayState;

private function onMapReady(event:Event):void {
  map.setCenter(new LatLng(59.908165,10.742719), 14, MapType.NORMAL_MAP_TYPE);

        stage.addEventListener(KeyboardEvent.KEY_DOWN, keyDownHandler);
    function keyDownHandler(event:KeyboardEvent):void {
    if (event.keyCode == 70) {
        toggleFullScreen();
        }
    }

    createMenu();

  map.enableScrollWheelZoom();
  map.enableContinuousZoom();
  map.enableControlByKeyboard();

   systemManager.stage.addEventListener(FullScreenEvent.FULL_SCREEN, fullScreenHandler);

  map.addEventListener(MapMouseEvent.ROLL_OVER, function(event:MapMouseEvent):void {
    map.addControl(new ZoomControl());
    map.addControl(new PositionControl());
    map.addControl(new MapTypeControl());
  });

  map.addEventListener(MapMouseEvent.ROLL_OUT, function(event:MapMouseEvent):void {
    map.removeControl(new ZoomControl());
    map.removeControl(new PositionControl());
    map.removeControl(new MapTypeControl());
  });

}

private function createMenu():void{
      var mainMenu:NativeMenu = new NativeMenu();
            var fullscreenMenu:NativeMenuItem = new NativeMenuItem("Fullscreen");
            var maximizeMenu:NativeMenuItem = new NativeMenuItem("Maximize");
            var restoreMenu:NativeMenuItem = new NativeMenuItem("Restore");
            var separatorA:NativeMenuItem = new NativeMenuItem("A", true); 
            var closeMenu:NativeMenuItem = new NativeMenuItem("Close");
            fullscreenMenu.addEventListener(Event.SELECT, handleMenuClick);
            maximizeMenu.addEventListener(Event.SELECT, handleMenuClick);
            restoreMenu.addEventListener(Event.SELECT, handleMenuClick);
            closeMenu.addEventListener(Event.SELECT, handleMenuClick);
            mainMenu.addItem(fullscreenMenu);
            mainMenu.addItem(maximizeMenu);
            mainMenu.addItem(restoreMenu);
            mainMenu.addItem(separatorA);
            mainMenu.addItem(closeMenu);

            //fullscreenMenu.enabled = false;
            //fullscreenMenu.label = "Test";

            this.contextMenu=mainMenu;
     }

     private function handleMenuClick(e:Event):void{
      var menuItem:NativeMenuItem = e.target as NativeMenuItem;
            if(menuItem.label == "Fullscreen") toggleFullScreen();
            if(menuItem.label == "Maximize") this.maximize();
            if(menuItem.label == "Restore") this.restore();
            if(menuItem.label == "Close") this.close();
     }

     private function fullScreenHandler(evt:FullScreenEvent):void {
  if (evt.fullScreen) {
    //fullscreenMenu.label = "Test";

  } else {

  }
}

     private function toggleFullScreen():void {
  try {
    switch (systemManager.stage.displayState) {
      case StageDisplayState.FULL_SCREEN_INTERACTIVE:
        systemManager.stage.displayState = StageDisplayState.NORMAL;
        break;
      default:
        systemManager.stage.displayState = StageDisplayState.FULL_SCREEN_INTERACTIVE;
        break;
    }
  } catch (err:SecurityError) {
  // ignore
  }
}

]]>
  </mx:Script>
  </mx:WindowedApplication> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-13T11:17:21.177

为了将标签更改为 NativeMenu，您可以试试这个

```
yourNativeMenu.getItemAt(0).label="new_label"; 
```

返回 NativeMenu中`getItemAt(0)`的第一项

# apache-flex - Intellij 无法确定 JDK 的版本

> ID：642198
> 
> 赞同：1
> 
> 时间：2009-03-13T11:10:33.113
> 
> 标签：apache-flex, intellij-idea, java

为什么我在 intellij 中出现错误：

无法确定 JDK flex_sdk_3 的版本。更新 JDK 配置。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-13T11:11:16.730

如果源代码树中有 java 类，就会出现这个问题。删除它们，错误应该消失。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-13T12:08:10.493

在 IntelliJ IDEA 中加载项目时，项目文件的一部分是项目使用的 JDK 的名称。如果您没有使用该名称安装 JDK，IDEA 会抱怨。我们发现需要对我们组中的 JDK 名称进行标准化。

要添加或编辑 JDK（至少在我正在使用的 IDEA 7.0.4 中），请进入文件/设置/项目设置。平台设置下有一个“JDK”，您可以在其中添加 JDK 版本，项目设置下的“常规”允许您选择要用于项目的 JDK。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2010-08-20T08:18:14.973

我刚刚遇到了同样的问题。在我的想法工作区中，我有两种项目：flex 项目和 java 项目。默认情况下，所有项目都使用可通过文件>项目结构菜单编辑的“常规项目设置”。

将默认项目 sdk 更改为最适合您的项目，然后为其他项目应用特定设置。在我的情况下，因为我想从 intellij 运行 JBoss，所以我选择默认为 java sdk。

# c++ - 重载算术运算符

> ID：642205
> 
> 赞同：1
> 
> 时间：2009-03-13T11:12:35.430
> 
> 标签：c++, operator-overloading

赋值运算符可以声明为

T& 运算符= (const t&);

在一个类中，但不能以这种方式定义算术运算符。它必须是朋友功能。我不明白为什么？你能解释一下吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-13T12:17:42.500

算术运算符不应该是友元

那么你可以这样定义：

```
MyClass MyClass::operator + (const MyClass& t) const
{
  MyClass ret(*this);
  ret += t;
  return ret;
} 
```

这`a + b`实际上是一个语法糖，编译器会将其扩展为`a.operator+(b)`. 如果你的所有对象都是 MyClass 实例，前面的例子可以工作，但如果你必须与其他类型一起操作`1 + a`，则不能工作，即不能工作，这个可以通过朋友解决。

```
MyClass operator + (int i, const MyClass& t)
{
  MyClass ret(i);
  ret += t;
  return ret;
} 
```

当 + 运算符的左侧不是一个类，或者它是一个类但您不能将运算符 + 添加到其定义中时，必须这样做。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-13T11:19:47.693

理想情况下，它们应该是全局变量而不一定是朋友，这样您就可以编写：

```
yourtype v = 1;
yourtype w = 1 + v; 
```

因为， 1 不是 的对象`yourtype`，如果`operator+`是成员，它会抛出一个合适的。但是，使其成为全局使其将 1 转换为`yourtype`然后执行操作。使其成为朋友有助于根据需要提取和操纵成员`yourtype`- 尽管不是必需的。例如：您可以实现成员函数`operator+=`并在`operator+`.

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-13T11:27:07.487

我认为[C++ FAQ Lite](http://www.parashift.com/c++-faq-lite/operator-overloading.html)会给你一个明确的答案。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-13T16:16:58.897

问题是，如果您执行以下操作：

```
class A
{
    A& operator+(int n);
    // ...
}

int main()
{
    A my_var;
    int integer = 1;
    A + integer; // compiles
    integer + A // error: no function operator+(int, A) defined
} 
```

它不会编译。一个解决方案是将 operator+(int, A) 和 operator+(A, int) 定义为 A 的朋友。作为旁注，Boost Operators 库使这个过程非常容易。

# c++ - 如何在 C++ 中实现自然排序算法？

> ID：642213
> 
> 赞同：17
> 
> 时间：2009-03-13T11:16:36.593
> 
> 标签：c++, sorting, natural-sort

我正在对由文本和数字组成的字符串进行排序。我希望排序将数字部分排序为数字，而不是字母数字。

例如我想要：abc1def, ..., abc9def, abc10def

而不是：abc10def，abc1def，...，abc9def

有谁知道这方面的算法（特别是在 C++ 中）

谢谢

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2009-03-13T11:31:41.907

我问[了这个确切的问题（尽管是在 Java 中）](https://stackoverflow.com/questions/104599/sort-on-a-string-that-may-contain-a-number)并被指向[http://www.davekoelle.com/alphanum.html](http://www.davekoelle.com/alphanum.html)，它有一个算法和多种语言的实现。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2014-11-05T19:43:49.840

有几种 C++ 的自然排序实现可用。简要回顾：

*   [`natural_sort<>`](http://web.archive.org/web/20071217040157/http://www.boostcookbook.com/Recipe:/1235053)- 基于 Boost.Regex。
    *   在我的测试中，它比其他选项慢大约 20 倍。
*   Dirk Jagdmann 的[`alnum.hpp`](http://www.davekoelle.com/files/alphanum.hpp)，基于 Dave Koelle 的[alphanum 算法](http://www.davekoelle.com/alphanum.html)
    *   超过 MAXINT 的值的潜在整数过低问题
*   Martin Pool's [`natsort`](http://sourcefrog.net/projects/natsort/)- 用 C 编写，但在 C++ 中可以轻松使用。
    *   我见过的唯一 C/C++ 实现提供不区分大小写的版本，这似乎是“自然”排序的高优先级。
    *   与其他实现一样，它实际上并不解析小数点，但它会处理特殊情况下的前导零（任何带有前导 0 的东西都被假定为分数），这有点奇怪但可能很有用。
    *   PHP 使用这种算法。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-03-13T11:18:54.853

这称为自然排序。[这里](http://web.archive.org/web/20071217040157/http://www.boostcookbook.com/Recipe:/1235053)有一个看起来很有希望的算法。

小心非 ASCII 字符的问题（请参阅[Jeff 的博客条目](https://blog.codinghorror.com/sorting-for-humans-natural-sort-order/)）。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2015-11-15T20:36:53.183

部分转贴[我的另一个答案](https://stackoverflow.com/a/33495791/3744681)：

```
bool compareNat(const std::string& a, const std::string& b){
    if (a.empty())
        return true;
    if (b.empty())
        return false;
    if (std::isdigit(a[0]) && !std::isdigit(b[0]))
        return true;
    if (!std::isdigit(a[0]) && std::isdigit(b[0]))
        return false;
    if (!std::isdigit(a[0]) && !std::isdigit(b[0]))
    {
        if (a[0] == b[0])
            return compareNat(a.substr(1), b.substr(1));
        return (toUpper(a) < toUpper(b));
        //toUpper() is a function to convert a std::string to uppercase.
    }

    // Both strings begin with digit --> parse both numbers
    std::istringstream issa(a);
    std::istringstream issb(b);
    int ia, ib;
    issa >> ia;
    issb >> ib;
    if (ia != ib)
        return ia < ib;

    // Numbers are the same --> remove numbers and recurse
    std::string anew, bnew;
    std::getline(issa, anew);
    std::getline(issb, bnew);
    return (compareNat(anew, bnew));
} 
```

`toUpper()`功能：

```
std::string toUpper(std::string s){
    for(int i=0;i<(int)s.length();i++){s[i]=toupper(s[i]);}
    return s;
    } 
```

用法：

```
std::vector<std::string> str;
str.push_back("abc1def");
str.push_back("abc10def");
...
std::sort(str.begin(), str.end(), compareNat); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2015-12-29T16:04:52.790

为了解决本质上是解析问题，状态机（又名[有限状态自动机](https://en.wikipedia.org/wiki/Finite-state_machine)）是要走的路。对上述解决方案不满意，我编写了一个简单的一次性早期救助算法，该算法在性能方面优于上面建议的 C/C++ 变体，不会出现数值数据类型溢出错误，并且在需要时易于修改以添加不区分大小写.

来源可以在[这里找到](https://www.o-rho.com/naturalsort)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2020-08-05T15:48:10.713

对于那些到达这里并且已经在他们的项目中使用 Qt 的人，您可以使用该`QCollator`课程。有关详细信息，请参阅[此问题](https://stackoverflow.com/questions/11933883/sort-filenames-naturally-with-qt)。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2020-08-08T06:43:33.510

Avalanchesort 是自然排序的递归变体，它运行合并，同时探索排序数据的堆栈。即使您在算法运行/排序时将数据添加到排序堆，算法也会稳定排序。

搜索原理很简单。**仅合并具有相同排名的运行。**

在找到前两个自然运行（秩为 0）后，雪崩排序将它们合并为秩为 1 的运行。然后它调用雪崩排序，以生成第二次运行的秩为 1 并将两次运行合并为秩为 2 的运行。然后它调用avalancheSort 在未排序的数据上生成排名为 2 的运行....

我的实现[porthd/avalanchesort](https://github.com/porthd/avalanchesort)将排序与使用接口注入的数据处理分开。您可以将算法用于数组、关联数组或列表等数据结构。

```
 /**
 * @param DataListAvalancheSortInterface $dataList
 * @param DataRangeInterface $beginRange
 * @param int $avalancheIndex
 * @return bool
 */
public function startAvalancheSort(DataListAvalancheSortInterface $dataList)
{
    $avalancheIndex = 0;
    $rangeResult = $this->avalancheSort($dataList, $dataList->getFirstIdent(), $avalancheIndex);
    if (!$dataList->isLastIdent($rangeResult->getStop())) {
        do {
            $avalancheIndex++;
            $lastIdent = $rangeResult->getStop();
            if ($dataList->isLastIdent($lastIdent)) {
                $rangeResult = new $this->rangeClass();
                $rangeResult->setStart($dataList->getFirstIdent());
                $rangeResult->setStop($dataList->getLastIdent());
                break;
            }
            $nextIdent = $dataList->getNextIdent($lastIdent);
            $rangeFollow = $this->avalancheSort($dataList, $nextIdent, $avalancheIndex);
            $rangeResult = $this->mergeAvalanche($dataList, $rangeResult, $rangeFollow);
        } while (true);
    }
    return $rangeResult;
}

/**
 * @param DataListAvalancheSortInterface $dataList
 * @param DataRangeInterface $range
 * @return DataRangeInterface
 */
protected function findRun(DataListAvalancheSortInterface $dataList,
                           $startIdent)
{
    $result = new $this->rangeClass();
    $result->setStart($startIdent);
    $result->setStop($startIdent);
    do {
        if ($dataList->isLastIdent($result->getStop())) {
            break;
        }
        $nextIdent = $dataList->getNextIdent($result->getStop());
        if ($dataList->oddLowerEqualThanEven(
            $dataList->getDataItem($result->getStop()),
            $dataList->getDataItem($nextIdent)
        )) {
            $result->setStop($nextIdent);
        } else {
            break;
        }
    } while (true);
    return $result;
}

/**
 * @param DataListAvalancheSortInterface $dataList
 * @param $beginIdent
 * @param int $avalancheIndex
 * @return DataRangeInterface|mixed
 */
protected function avalancheSort(DataListAvalancheSortInterface $dataList,
                                 $beginIdent,
                                 int $avalancheIndex = 0)
{
    if ($avalancheIndex === 0) {
        $rangeFirst = $this->findRun($dataList, $beginIdent);
        if ($dataList->isLastIdent($rangeFirst->getStop())) {
            // it is the last run
            $rangeResult = $rangeFirst;
        } else {
            $nextIdent = $dataList->getNextIdent($rangeFirst->getStop());
            $rangeSecond = $this->findRun($dataList, $nextIdent);
            $rangeResult = $this->mergeAvalanche($dataList, $rangeFirst, $rangeSecond);
        }
    } else {
        $rangeFirst = $this->avalancheSort($dataList,
            $beginIdent,
            ($avalancheIndex - 1)
        );
        if ($dataList->isLastIdent($rangeFirst->getStop())) {
            $rangeResult = $rangeFirst;
        } else {
            $nextIdent = $dataList->getNextIdent($rangeFirst->getStop());
            $rangeSecond = $this->avalancheSort($dataList,
                $nextIdent,
                ($avalancheIndex - 1)
            );
            $rangeResult = $this->mergeAvalanche($dataList, $rangeFirst, $rangeSecond);
        }
    }
    return $rangeResult;
}

protected function mergeAvalanche(DataListAvalancheSortInterface $dataList, $oddListRange, $evenListRange)
{
    $resultRange = new $this->rangeClass();
    $oddNextIdent = $oddListRange->getStart();
    $oddStopIdent = $oddListRange->getStop();
    $evenNextIdent = $evenListRange->getStart();
    $evenStopIdent = $evenListRange->getStop();
    $dataList->initNewListPart($oddListRange, $evenListRange);
    do {
        if ($dataList->oddLowerEqualThanEven(
            $dataList->getDataItem($oddNextIdent),
            $dataList->getDataItem($evenNextIdent)
        )) {
            $dataList->addListPart($oddNextIdent);
            if ($oddNextIdent === $oddStopIdent) {
                $restTail = $evenNextIdent;
                $stopTail = $evenStopIdent;
                break;
            }
            $oddNextIdent = $dataList->getNextIdent($oddNextIdent);
        } else {
            $dataList->addListPart($evenNextIdent);
            if ($evenNextIdent === $evenStopIdent) {
                $restTail = $oddNextIdent;
                $stopTail = $oddStopIdent;
                break;
            }
            $evenNextIdent = $dataList->getNextIdent($evenNextIdent);

        }
    } while (true);
    while ($stopTail !== $restTail) {
        $dataList->addListPart($restTail);
        $restTail = $dataList->getNextIdent($restTail);
    }
    $dataList->addListPart($restTail);
    $dataList->cascadeDataListChange($resultRange);
    return $resultRange;

} 
```

}

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2021-07-01T02:43:56.950

我的算法带有java版本的测试代码。如果你想在你的项目中使用它，你可以自己定义一个比较器。

```
import java.io.File;
import java.io.IOException;
import java.util.ArrayList;
import java.util.Arrays;
import java.util.Comparator;
import java.util.List;
import java.util.function.Consumer;

public class FileNameSortTest {

    private static List<String> names = Arrays.asList(
            "A__01__02",
            "A__2__02",
            "A__1__23",
            "A__11__23",
            "A__3++++",
            "B__1__02",
            "B__22_13",
            "1_22_2222",
            "12_222_222",
            "2222222222",
            "1.sadasdsadsa",
            "11.asdasdasdasdasd",
            "2.sadsadasdsad",
            "22.sadasdasdsadsa",
            "3.asdasdsadsadsa",
            "adsadsadsasd1",
            "adsadsadsasd10",
            "adsadsadsasd3",
            "adsadsadsasd02"
    );

    public static void main(String...args) {
        List<File> files = new ArrayList<>();
        names.forEach(s -> {
            File f = new File(s);
            try {
                if (!f.exists()) {
                    f.createNewFile();
                }
                files.add(f);
            } catch (IOException e) {
                e.printStackTrace();
            }
        });
        files.sort(Comparator.comparing(File::getName));
        files.forEach(f -> System.out.print(f.getName() + " "));
        System.out.println();

        files.sort(new Comparator<File>() {

            boolean caseSensitive = false;
            int SPAN_OF_CASES = 'a' - 'A';

            @Override
            public int compare(File left, File right) {
                char[] csLeft = left.getName().toCharArray(), csRight = right.getName().toCharArray();
                boolean isNumberRegion = false;
                int diff=0, i=0, j=0, lenLeft=csLeft.length, lenRight=csRight.length;
                char cLeft = 0, cRight = 0;
                for (; i<lenLeft && j<lenRight; i++, j++) {
                    cLeft = getCharByCaseSensitive(csLeft[i]);
                    cRight = getCharByCaseSensitive(csRight[j]);
                    boolean isNumericLeft = isNumeric(cLeft), isNumericRight = isNumeric(cRight);
                    if (isNumericLeft && isNumericRight) {
                        // Number start!
                        if (!isNumberRegion) {
                            isNumberRegion = true;
                            // Remove prefix '0'
                            while (i < lenLeft && cLeft == '0') i++;
                            while (j < lenRight && cRight == '0') j++;
                            if (i == lenLeft || j == lenRight) break;
                        }
                        // Diff start: calculate the diff value.
                        if (cLeft != cRight && diff == 0)
                            diff = cLeft - cRight;
                    } else {
                        if (isNumericLeft != isNumericRight) {
                            // One numeric and one char.
                            if (isNumberRegion)
                                return isNumericLeft ? 1 : -1;
                            return cLeft - cRight;
                        } else {
                            // Two chars: if (number) diff don't equal 0 return it.
                            if (diff != 0)
                                return diff;
                            // Calculate chars diff.
                            diff = cLeft - cRight;
                            if (diff != 0)
                                return diff;
                            // Reset!
                            isNumberRegion = false;
                            diff = 0;
                        }
                    }
                }
                // The longer one will be put backwards.
                return (i == lenLeft && j == lenRight) ? cLeft - cRight : (i == lenLeft ? -1 : 1) ;
            }

            private boolean isNumeric(char c) {
                return c >= '0' && c <= '9';
            }

            private char getCharByCaseSensitive(char c) {
                return caseSensitive ? c : (c >= 'A' && c <= 'Z' ? (char) (c + SPAN_OF_CASES) : c);
            }
        });
        files.forEach(f -> System.out.print(f.getName() + " "));
    }
} 
```

输出是，

```
1.sadasdsadsa 11.asdasdasdasdasd 12_222_222 1_22_2222 2.sadsadasdsad 22.sadasdasdsadsa 2222222222 3.asdasdsadsadsa A__01__02 A__11__23 A__1__23 A__2__02 A__3++++ B__1__02 B__22_13 adsadsadsasd02 adsadsadsasd1 adsadsadsasd10 adsadsadsasd3 
1.sadasdsadsa 1_22_2222 2.sadsadasdsad 3.asdasdsadsadsa 11.asdasdasdasdasd 12_222_222 22.sadasdasdsadsa 2222222222 A__01__02 A__1__23 A__2__02 A__3++++ A__11__23 adsadsadsasd02 adsadsadsasd1 adsadsadsasd3 adsadsadsasd10 B__1__02 B__22_13 
Process finished with exit code 0 
```

* * *

## 回答 #9

> 赞同：-1
> 
> 时间：2011-01-09T15:00:42.437

```
// -1: s0 < s1; 0: s0 == s1; 1: s0 > s1
static int numericCompare(const string &s0, const string &s1) {
    size_t i = 0, j = 0;
    for (; i < s0.size() && j < s1.size();) {
        string t0(1, s0[i++]);
        while (i < s0.size() && !(isdigit(t0[0]) ^ isdigit(s0[i]))) {
            t0.push_back(s0[i++]);
        }
        string t1(1, s1[j++]);
        while (j < s1.size() && !(isdigit(t1[0]) ^ isdigit(s1[j]))) {
            t1.push_back(s1[j++]);
        }
        if (isdigit(t0[0]) && isdigit(t1[0])) {
            size_t p0 = t0.find_first_not_of('0');
            size_t p1 = t1.find_first_not_of('0');
            t0 = p0 == string::npos ? "" : t0.substr(p0);
            t1 = p1 == string::npos ? "" : t1.substr(p1);
            if (t0.size() != t1.size()) {
                return t0.size() < t1.size() ? -1 : 1;
            }
        }
        if (t0 != t1) {
            return t0 < t1 ? -1 : 1;
        }
    }
    return i == s0.size() && j == s1.size() ? 0 : i != s0.size() ? 1 : -1;
} 
```

我不太确定是不是你想要的，反正你可以试试:-)

# view - 如果删除表，现有 DB2 视图会发生什么情况？

> ID：642218
> 
> 赞同：1
> 
> 时间：2009-03-13T11:17:52.487
> 
> 标签：view, db2, sql-drop

如果我们在现有 DB2 表上创建了一个视图，然后删除了该表。视图会发生什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-13T15:31:55.433

视图变得无效/无效。尝试从中选择将失败。

尝试一下：

```
create table TEST_TABLE (
TEST_COL INTEGER
);

INSERT INTO TEST_TABLE VALUES(1);

SELECT * FROM TEST_TABLE;

create view TEST_VIEW AS
SELECT * FROM TEST_TABLE;

SELECT * FROM TEST_VIEW;

DROP TABLE TEST_TABLE;

SELECT * FROM TEST_VIEW; 
```

最后一条语句给出了错误：

```
[IBM][CLI Driver][DB2/NT] SQL0575N  View or materialized query table
"TEST_VIEW" cannot be used because it has been marked inoperative.
SQLSTATE=51024 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-11-26T08:08:50.773

没啥事儿。只是不要使用那个视图。您可以再次重新创建表，以便稍后再次使用该视图。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-18T03:31:45.417

当视图失效时，如上例所示，DB2 将允许您重新创建该视图而无需先删除它。这使得重新运行您的视图 DDL 文件成为可能（或者简单地转储 SYSCAT.VIEWS 的 TEXT 列并执行它）。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-06-08T11:49:06.240

它变得不起作用。可以使用以下查询找到相同的信息：

```
SELECT viewscheama,viewname,valid FROM syscat.views 
```

. 对于特定视图，如果“有效”列具有除 'Y' 之外的任何值，则该视图将无效。

# ant - 将命令行参数传递给 Hudson 中的 Ant

> ID：642219
> 
> 赞同：2
> 
> 时间：2009-03-13T11:18:04.327
> 
> 标签：ant, continuous-integration, build-automation, hudson

我正在尝试将 -lib 参数作为使用 Hudson 的自动构建的一部分传递给 ant，但看不到这样做的方法。我可以将相关库添加到 ant/lib 文件夹，但这意味着相同版本的库必须由该机器上的所有构建共享。

非常感谢任何帮助。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-03-13T11:44:08.430

在您的 Hudson 作业配置中，您可以在 Targets 字段中指定 ant 参数，例如 -lib。查看单击 时打开的帮助消息？目标字段旁边。

# sql - 针对 Excel 工作簿运行的 SQL 查询返回截断的文本字段

> ID：642227
> 
> 赞同：0
> 
> 时间：2009-03-13T11:22:09.527
> 
> 标签：sql, excel-2007, ado

我正在使用以下代码通过 ADO 连接到 Excel 2007 工作簿运行 SQL SELECT 查询（使用自定义版本的 VBScript）

```
dim ado, rs
set ado = CreateObject("ADODB.Connection")
ado.ConnectionString = "Provider=Microsoft.ACE.OLEDB.12.0;Data Source=workbook.xlsx;Extended Properties=""Excel 12.0 Xml;HDR=YES;IMEX=1"";"
ado.open()
set rs = ado.execute("SELECT * FROM [sheet1$]") 
```

这是直截了当的。问题是任何文本长度超过 255 个字符的单元格都会被截断；有没有办法解决？连接字符串中是否有支持此功能的属性，还是我需要在 excel 文档本身中更改的选项？我已经尝试过 MSSQL 的 CAST() 函数，但这只会在执行时导致错误。

任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-13T13:14:01.460

我认为您遇到了 Excel 数据访问提供程序中长期存在的限制的变体。有关示例，请参阅[http://support.microsoft.com/default.aspx?scid=kb;EN-US;189897或谷歌了解更多。](http://support.microsoft.com/default.aspx?scid=kb;EN-US;189897)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-13T11:25:17.727

您是否尝试过使用 CONVERT() 函数，而不是尝试使用 CAST()？

# c++ - 为什么我需要在 g++ 中使用 typedef typename 而不是 VS？

> ID：642229
> 
> 赞同：51
> 
> 时间：2009-03-13T11:22:25.440
> 
> 标签：c++, g++, typedef, typename

自从 GCC 发现我已经有一段时间了，但它就发生在今天。但我从来不明白为什么 GCC 需要在模板中使用 typedef typename，而 VS 和我猜想 ICC 不需要。typedef typename 是“错误”还是过于严格的标准，还是留给编译器编写者的东西？

对于那些不知道我的意思的人，这里有一个示例：

```
template<typename KEY, typename VALUE>
bool find(const std::map<KEY,VALUE>& container, const KEY& key)
{
    std::map<KEY,VALUE>::const_iterator iter = container.find(key);
    return iter!=container.end();
} 
```

上面的代码在 VS 中编译（可能在 ICC 中），但在 GCC 中失败，因为它想要这样：

```
template<typename KEY, typename VALUE>
bool find(const std::map<KEY,VALUE>& container, const KEY& key)
{
    typedef typename std::map<KEY,VALUE>::const_iterator iterator; //typedef typename
    iterator iter = container.find(key);
    return iter!=container.end();
} 
```

注意：这不是我正在使用的实际功能，而只是演示问题的一些愚蠢的东西。

* * *

## 回答 #1

> 赞同：57
> 
> 时间：2009-03-13T12:25:51.417

标准要求类型名。模板编译需要两步验证。在第一次通过期间，编译器必须验证模板语法而不实际提供类型替换。在这一步中，std::map::iterator 被假定为一个值。如果它确实表示一个类型，则 typename 关键字是必需的。

为什么这是必要的？在替换实际的 KEY 和 VALUE 类型之前，编译器不能保证模板不是特化的，并且特化不会将*迭代器*关键字重新定义为其他东西。

您可以使用以下代码检查它：

```
class X {};
template <typename T>
struct Test
{
   typedef T value;
};
template <>
struct Test<X>
{
   static int value;
};
int Test<X>::value = 0;
template <typename T>
void f( T const & )
{
   Test<T>::value; // during first pass, Test<T>::value is interpreted as a value
}
int main()
{
  f( 5 );  // compilation error
  X x; f( x ); // compiles fine f: Test<T>::value is an integer
} 
```

最后一次调用失败并出现错误，表明在 f() Test::value 的第一个模板编译步骤中，Test::value 被解释为一个值，但类型 X 的 Test<> 模板的实例化产生了一个类型。

* * *

## 回答 #2

> 赞同：32
> 
> 时间：2009-03-13T11:31:26.853

好吧，GCC 实际上并不*需要*`typedef`--`typename`就足够了。这有效：

```
#include <iostream>
#include <map>

template<typename KEY, typename VALUE>
bool find(const std::map<KEY,VALUE>& container, const KEY& key)
{
    typename std::map<KEY,VALUE>::const_iterator iter = container.find(key);
    return iter!=container.end();
}

int main() {
    std::map<int, int> m;
    m[5] = 10;
    std::cout << find(m, 5) << std::endl;
    std::cout << find(m, 6) << std::endl;
    return 0;
} 
```

这是一个上下文敏感的解析问题的例子。仅从该函数中的语法来看，所讨论的行的含义并不明显——您需要知道是否`std::map<KEY,VALUE>::const_iterator`是类型。

现在，我似乎想不出一个例子来说明......`::const_iterator`除了一个类型之外，这也不会是一个错误。所以我猜编译器可以发现它*必须*是一种类型，但对于可怜的编译器（作者）来说可能很难。

该标准要求在`typename`此处使用，根据标准第 14.6/3 节的 litb。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-03-13T11:32:24.527

看起来 VS/ICC在它*认为*需要的`typename`地方提供了关键字。请注意，这是一件坏事（TM）——让编译器决定*你*想要什么。通过灌输在需要时跳过的坏习惯，这进一步使问题复杂化，并且是可移植性的噩梦。这绝对不是标准行为。在严格的标准模式或 Comeau 下尝试。**`typename`**

 *** * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-03-13T12:11:10.563

这是 Microsoft C++ 编译器中的一个错误 - 在您的示例中， std::map::iterator 可能不是一种类型（您可以在 KEY,VALUE 上专门化 std::map 以便 std::map::iterator 是例如变量）。

GCC 强制您编写正确的代码（即使您的意思很明显），而 Microsoft 编译器会正确猜测您的意思（即使您编写的代码不正确）。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2010-11-30T17:25:57.107

需要注意的是，值/类型类型的问题并不是根本问题。主要问题是**解析**。考虑

```
template<class T>
void f() { (T::x)(1); } 
```

除非 typename 关键字是强制性的，否则无法判断这是强制转换还是函数调用。在这种情况下，上面的代码包含一个函数调用。一般来说，如果不完全放弃解析，就不能延迟选择，只需考虑片段

```
(a)(b)(c) 
```

如果您不记得，cast 的优先级高于 C 中的函数调用，这是 Bjarne 想要函数样式强制转换的原因之一。因此无法判断上述是否意味着

```
(a)(b)  (c)   // a is a typename 
```

或者

```
(a) (b)(c)    // a is not a typename , b is 
```

或者

```
(a)(b) (c)    // neither a nor b is a typename 
```

我在其中插入空格以指示分组。

还要注意“templatename”关键字是必需的，原因与“typename”相同，如果不知道 C/C++ 中的类型，就无法解析事物。

# asp.net-mvc - 什么是 ASP.NET MVC 初学者的良好在线资源？

> ID：642231
> 
> 赞同：13
> 
> 时间：2009-03-13T11:23:16.047
> 
> 标签：asp.net-mvc, reference

我有 3 天的时间来学习 ASP.NET MVC 的基础知识并用它创建一个非常小的 PoC Web 应用程序。

目前最好的在线资源是什么：

1.  以类似教程的方式学习基础知识
2.  有关 ASP.NET MVC 的参考资料
3.  关于使用 ASP.NET MVC 的最佳实践

我不是在寻找有关 MVC 模式的一般信息，因为我在过去的（桌面）应用程序中一直在使用它。

### 请注意：

这个问题之前已经在 SO 上提出过，但是我看到的大线程已经有大约半年的历史了，看到 ASP.NET 的发展速度我不确定这些是否仍然是最新的，如果没有现在更好的选择。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-03-13T11:39:49.080

对于 ASP.net MVC 4，微软发布了入门指南：

[http://www.asp.net/mvc/tutorials/mvc-4/getting-started-with-aspnet-mvc4/intro-to-aspnet-mvc-4](http://www.asp.net/mvc/tutorials/mvc-4/getting-started-with-aspnet-mvc4/intro-to-aspnet-mvc-4)

对于 ASP.net MVC 1，还有一本由 Scott Hanselman、Phil Haack、Scott Guthrie 和 Rob Conery 发布的免费电子书。这现在已经过时了，但可能仍然会引起一些人的兴趣：

[http://weblogs.asp.net/scottgu/archive/2009/03/10/free-asp-net-mvc-ebook-tutorial.aspx](http://weblogs.asp.net/scottgu/archive/2009/03/10/free-asp-net-mvc-ebook-tutorial.aspx)

不过，这更像是一个具体的项目演练，而不是标准教程。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-03-13T11:27:03.680

几乎所有 ASP.NET MVC 框架问题（包括文本和视频格式的教程）的最佳来源将来自官方来源[http://www.asp.net/mvc](http://www.asp.net/mvc)

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-03-13T11:27:00.327

我将从[ASP.NET MVC How-Do-I 开始。](http://www.asp.net/learn/mvc-videos/)ASP.NET MVC Storefront Starter Kit 和 ASP.NET MVC Pair Programming 都非常适合逐步学习。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-03-28T16:18:56.590

这是[Scott Allen](http://odetocode.com/blogs/scott/)的一段精彩视频。这是免费的

[http://www.pluralsight-training.net/microsoft/players/PSODPlayer?author=scott-allen&name=mvc3-building-intro&mode=live&clip=0&course=aspdotnet-mvc3-intro](http://www.pluralsight-training.net/microsoft/players/PSODPlayer?author=scott-allen&name=mvc3-building-intro&mode=live&clip=0&course=aspdotnet-mvc3-intro)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-13T12:13:07.080

[Stephan Walther 的博客](http://stephenwalther.com/blog/Default.aspx)是另一个很好的链接和信息来源（最能解决这里建议的问题）。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-10-28T22:20:57.393

我刚刚找到了你的问题 - 我也一直在搜索并找到了这个网站，我认为这是一个很好的、简单的英文指南：

[http://www.howmvcworks.net/](http://www.howmvcworks.net/)

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2009-03-13T11:33:22.183

[Scott Gu](http://weblogs.asp.net/scottgu/)和[Phil Haack](http://haacked.com/)为您提供了一些直截了当的“提示”。确实旧帖子使用过时的 MVC 版本，但大部分内容仍然有效。您需要的基础知识（如何以及*为什么*）可以在那里找到。

* * *

## 回答 #8

> 赞同：-1
> 
> 时间：2011-05-23T10:52:14.033

这些链接可能很有用：

[Asp.net 和 C#：MVC](http://asp-net-csharp-vb.blogspot.com/search/label/MVC%20%28Model%20View%20Controller%29)

[Asp.net 和 C#：为 Visual Studio 开发人员介绍带有 Razor 视图引擎的 MVC 开发](http://asp-net-csharp-vb.blogspot.com/2011/05/introducing-mvc-development-wthe-razor.html)

# c# - 在 Sitecore CMS.NET 中递归删除子项

> ID：642232
> 
> 赞同：1
> 
> 时间：2009-03-13T11:24:44.483
> 
> 标签：c#, recursion, sitecore

我的 Sitecore 媒体库中有以下结构

> 图片/部门/子部门/产品/

我想一次删除一个部门代码中的所有图像。目前我有

```
Item[] items = database.SelectItems("/sitecore/media library/images/department1//*");            

Sitecore.Data.Engines.DataEngine engine = new Sitecore.Data.Engines.DataEngine(database);

using (new SecurityDisabler())
{
    foreach (Item item in items)
    {
        engine.DeleteItem(item))
    }
} 
```

问题是它只删除了 department1 的子图像，下面什么都没有？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-03-13T13:16:51.467

DataEngine 是一个非常低级的 API，不应无故使用。

同时删除所有子项很容易：

Item department1 = database.GetItem("/sitecore/media library/images/department1"); 部门1.DeleteChildren();

这将留下 department1 项目，但它下面的所有内容都将被删除。

# class - UML 类图 关系类型

> ID：642233
> 
> 赞同：0
> 
> 时间：2009-03-13T11:24:55.107
> 
> 标签：class, uml, diagram, relation

我有两个班级，但不应该使用什么样的关系。我有一个类 Document 有很多属性但没有方法。第二类是我所说的 DocumentFact（Fact - Factory）。此类包含返回 Document 对象集合的不同方法。

因此，Document 类对 DocumentFact 类一无所知，因为它与它无关。另一方面，DocumentFact 创建多个 Document 对象。这是一种什么样的UML关系？我在想这样的事情：

```
--------------           ------------
|DocumentFact|  -------> | Document |
--------------       2.* ------------ 
```

或者：

```
--------------            ------------
|DocumentFact|  ------- []| Document |         // Composition
--------------            ------------ 
```

你怎么看？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-13T13:43:09.843

只是我的意见 - 如果 DocumentFact 真的是一个工厂，我会花费额外的三个按键并将其拼写出来。当您的班级用户第一次阅读班级名称时，您会迫使他们弄清楚您的意思是“文档工厂”还是“关于文档的事实”。不确定性是不必要的，特别是如果您可以触摸类型。我建议使名称更具自我记录性且不那么模棱两可。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-13T12:17:03.000

听起来更像是[“实例化”](http://publib.boulder.ibm.com/infocenter/rsmhelp/v7r0m0/index.jsp?topic=/com.ibm.xtools.modeler.doc/topics/cinstantiate.html)依赖关系？

[实例化图 http://publib.boulder.ibm.com/infocenter/rsmhelp/v7r0m0/topic/com.ibm.xtools.modeler.doc/images/instantiation.gif](http://publib.boulder.ibm.com/infocenter/rsmhelp/v7r0m0/topic/com.ibm.xtools.modeler.doc/images/instantiation.gif)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-13T12:30:35.853

我同意工具包，工厂->产品是实例化关系 - 多重性描述符不适用，除非工厂还打算维护对产品对象的引用，在这种情况下它是 1:* 或 1:n (multiton)

# algorithm - 是否有一种算法可以计算不需要 BigInteger 类型的 x 模 y（对于 y < 1000）的乘法阶数？

> ID：642234
> 
> 赞同：4
> 
> 时间：2009-03-13T11:25:08.600
> 
> 标签：algorithm, math, discrete-mathematics

我目前使用的算法很快就会遇到非常高的数字。我要在算法中的一个步骤将**x**提高到应用于**y**的 totient 函数的结果。结果是您可能会遇到非常大的数字。

例如。计算10 模 53的[乘法阶数时：](http://en.wikipedia.org/wiki/Multiplicative_order)

```
10^totient(53) == 10^52 == 1 * 10^52 
```

以下算法在避免大数字方面表现更好，但在**10^mOrder**大于数据类型的容量时仍然失败：

```
 mOrder = 1
  while 10^mOrder % 53 != 1
      if mOrder >= i
          mOrder = 0;
          break
      else
          mOrder = mOrder + 1 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-03-13T11:36:39.850

使用模幂运算，可以计算 (10 ^ mOrder % 53) 或一般情况下的任何 (a ^ b mod c)，而不会得到比 c 大得多的值。有关详细信息，请参阅[Wikipedia](http://en.wikipedia.org/wiki/Modular_exponentiation)，也有此示例代码：

```
Bignum modpow(Bignum base, Bignum exponent, Bignum modulus) {

    Bignum result = 1;

    while (exponent > 0) {
        if ((exponent & 1) == 1) {
            // multiply in this bit's contribution while using modulus to keep result small
            result = (result * base) % modulus;
        }
        // move to the next bit of the exponent, square (and mod) the base accordingly
        exponent >>= 1;
        base = (base * base) % modulus;
    }

    return result;
} 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-03-13T12:51:16.037

为什么要取幂？你不能在一个循环中乘以模*n吗？*

```
(defun 乘法阶数 (an)
  （如果（>（gcd an）1）
      0
      （做（（订单1（+订单1））
           (mod-exp (mod an) (mod (* mod-exp a) n)))
          ((= mod-exp 1) 顺序))))

```

或者，在 ptheudo (sic) 代码中：

```
def multiplicative_order (a, n) :
    if gcd (a, n) > 1 :
        return 0
      else:
        order = 1
        mod_exp = a mod n
        while mod_exp != 1 :
            order += 1
            mod_exp = (mod_exp * a) mod n
        return order 
```

# c# - 如何防止按键更新 MaskedTextBox 的文本？

> ID：642237
> 
> 赞同：1
> 
> 时间：2009-03-13T11:26:25.210
> 
> 标签：c#, .net, winforms, maskedtextbox

我需要验证用户在`MaskedTextBox`. 哪些字符有效取决于已输入的字符。我试过使用`IsInputChar`and `OnKeyPress`，但是无论我在 OnKeyPress 中返回 false`IsInputChar`还是设置`e.Handled`为 true，框的文本仍然设置为无效值。

如何防止按键更新 a`MaskedTextBox`的文本？

更新：MaskedTextBox 不是 TextBox。我不认为这应该有所作为，但从告诉我`e.Handled`应该有效的人数来看，也许确实有效。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-13T11:29:58.963

这不会在 textbox1 中键入字符“x”。

```
 char mychar='x'; // your particular character
    private void textBox1_KeyPress(object sender, KeyPressEventArgs e)
    {
        if (e.KeyChar == mychar)
            e.Handled = true;
    } 
```

**编辑**：它也适用于 MaskedTextBox。

高温高压

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-13T11:32:01.407

[http://msdn.microsoft.com/en-us/library/system.windows.forms.control.keydown.aspx](http://msdn.microsoft.com/en-us/library/system.windows.forms.control.keydown.aspx)可能有帮助，KeyDown 事件？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-13T11:31:18.133

应该这样`KeyPress`做；你在表格上这样做吗？还是在控制？例如：

```
static void Main() {
    TextBox tb = new TextBox();
    tb.KeyPress += (s, a) =>
    {
        string txt = tb.Text;
        if (char.IsLetterOrDigit(a.KeyChar)
            && txt.Length > 0 &&
            a.KeyChar <= txt[txt.Length-1])
        {
            a.Handled = true;
        }
    };
    Form form = new Form();
    form.Controls.Add(tb);
    Application.Run(form);
} 
```

（只允许“升序”字符）

请注意，这不会保护您免受复制/粘贴 - 您可能还需要查看 TextChanged 和/或 Validate。

# java - 最佳实践：如何通过 JDBC 检查 SQL.DATE 中的特定 java.util.Calendar/Date？

> ID：642241
> 
> 赞同：4
> 
> 时间：2009-03-13T11:27:11.950
> 
> 标签：java, sql, database, jdbc

这是我昨天以来一直在努力的事情。

我有约会要保存在数据库中。它们由日期和时间组成，例如：

```
01.02.1970 14:00 
```

（德文格式，在美文中，我认为它类似于 02/01/1970 2:00pm）。

第一个想法：将其保存为 SQL.DATE！

所以我创建了一个表：

```
CREATE TABLE appointments (id NUMBER(10) NOT NULL, datum DATE NOT NULL, PRIMARY KEY id) 
```

到现在为止还挺好。

现在我写了一个 DAO 来保存我通过网络表单输入的约会。之后我想编写一个单元测试，以检查约会是否正确保存。

相关测试部分如下：

```
JdbcDao myDao = new JdbcDao();
myDao.setDataSource(jdbcTemplate.getDataSource());      
myDao.saveAppointment(appointmentModel);

// Not needed but I saw, the appointment is saved in the database
setComplete();

// And now for the (sorry for the harsh words) pain in the *** part

String sql = "SELECT id, datum FROM appointments WHERE datum ... // <-- 
```

<--: 这只是一部分，我不知道要输入什么来查看特定日期是否已经在数据库中。

我试过：

```
datum = ? 
```

以下调用

```
jdbcTemplate.query(sql, args, rowMapper); 
```

在 args 数组中有一个 java.util.Date、一个 java.util.Calendar 或一个 java.lang.String ('dd.MM.yyyy')，它保存了替换 ? 在准备好的声明中。

当然，这是一个坏主意，因为数据库有类似的东西

```
DD.MM.YYYY HH:MI 
```

在表格行中（DD=天，MM=月，YY=年，HH=小时，MI=分钟）。

所以我找到了 BETWEEN sql 命令，重构（并尝试各种格式、输入、字符串、对象以在 args-array 中传递）SELECT 命令：

```
String sql = "SELECT id, datum FROM appointments WHERE datum BETWEEN to_date( ?, 'DD.MM.YYYY HH24:MI:SS') AND to_date( ?, 'DD.MM.YYYY HH24:MI:SS') 
```

与许多其他尝试一样，如果我直接通过 sql-tool 输入它，例如

```
SELECT * FROM appointments WHERE datum BETWEEN to_date('01.02.1970 00:00:00', 'DD.MM.YYYY HH24:MI:SS') AND to_date('01.02.1970 23:59:59', 'DD.MM.YYYY HH24:MI:SS') 
```

输出例如：

```
ID                      DATUM                   
----------------------  -------------------
70                      01.02.1970 11:11:11 
```

但是我在 java 中的 jdbc-call 总是导致一个空的结果集。

长话短说：

如果由 java 对象表示的日期存在于数据库的 sql.DATE 列中，与给定时间无关，那么查询数据库的最佳做法是什么？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-13T11:43:29.197

像这样的东西：

```
PreparedStatement ps = conn.prepareCall("SELECT * FROM table WHERE someDate = ?");
ps.setDate(1, javaDate) 
```

（根据记忆，语法可能不太正确）

不过，您必须将 java.util.Date 对象转换为 java.sql.Date 对象。

这很简单：

```
java.sql.Date myDate = new java.sql.Date(oldDate.getTime()); 
```

`oldDate`java.util.Date 对象在哪里。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2017-04-28T05:44:15.940

# java - 如何使用 qtj 和 java 从一组图像中创建电影？

> ID：642242
> 
> 赞同：6
> 
> 时间：2009-03-13T11:27:21.700
> 
> 标签：java, video, quicktime

我有一组图像，我想一个接一个地添加并创建一部电影。我将为此使用 Quicktime for java（我在 Mac 上）。

我在网上搜索了很多示例，这些示例展示了如何使用 qtj 播放电影，但是我找不到任何代码片段或教程来展示如何使用 qtj 逐帧创建电影？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-03-30T03:15:02.250

我已经通过 QTJ 使用[处理](http://processing.org)库 (GPL)中的[MovieMaker](http://processing.org/reference/libraries/video/MovieMaker.html)类完成了这项工作。处理是纯java，虽然它可以为初学者隐藏它。

**小教程：** 下载 Processing，打开它，转到 Sketch -> Show Sketch Folder，创建一个名为“data”的文件夹，并将所有图像放入该文件夹中，命名为“filename01.gif”到“filename09.gif”。将以下代码粘贴到编辑器中，然后点击播放：

```
/**
 * Makes a QuickTime movie out of an array of images.
 */

import processing.video.*;

MovieMaker mm;
PImage[] imageFrames;
int index;

void setup() {
  size(320, 240);
  int numFrames = 9;
  imageFrames = new PImage[numFrames];
  for( int i = 0; i < imageFrames.length; i++ )
  {
    imageFrames[i] = loadImage( "filename" + nf(i+1,2) + ".gif" );
  }
  // Save uncompressed, at 15 frames per second
  mm = new MovieMaker(this, width, height, "drawing.mov");
  // Or, set specific compression and frame rate options
  //mm = new MovieMaker(this, width, height, "drawing.mov", 30, 
  //                    MovieMaker.ANIMATION, MovieMaker.HIGH);
}

void draw() {
  if( index < imageFrames.length )
  {
    // show the image
    image( imageFrames[index], 0, 0 );
    // Add window's pixels to movie
    mm.addFrame();
    index++;
  }
  else
  {
    mm.finish();
    // Quit running the sketch once the file is written
    exit();    
  }
} 
```

这将从草图文件夹中的图像创建一个文件“drawing.mov”。如果您转到文件 --> 导出应用程序，然后打开草图文件夹并导航到文件夹 application.macosx/source 或 application.windows/source，应该有一个包含实际代码的 .java 文件，应该看起来像这样：

```
import processing.core.*; 
import processing.xml.*; 

import processing.video.*; 

import java.applet.*; 
import java.awt.*; 
import java.awt.image.*; 
import java.awt.event.*; 
import java.io.*; 
import java.net.*; 
import java.text.*; 
import java.util.*; 
import java.util.zip.*; 
import java.util.regex.*; 

public class movie2 extends PApplet {

/**
 * Makes a QuickTime movie out of an array of images.
 */

MovieMaker mm;
PImage[] imageFrames;
int index;

public void setup() {
  size(320, 240);
  int numFrames = 9;
  imageFrames = new PImage[numFrames];
  for( int i = 0; i < imageFrames.length; i++ )
  {
    imageFrames[i] = loadImage( "filename" + nf(i+1,2) + ".gif" );
  }
  // Save uncompressed, at 15 frames per second
  mm = new MovieMaker(this, width, height, "drawing.mov");
  // Or, set specific compression and frame rate options
  //mm = new MovieMaker(this, width, height, "drawing.mov", 30, 
  //                    MovieMaker.ANIMATION, MovieMaker.HIGH);
}

public void draw() {
  if( index < imageFrames.length )
  {
    // show the image
    image( imageFrames[index], 0, 0 );
    // Add window's pixels to movie
    mm.addFrame();
    index++;
  }
  else
  {
    mm.finish();
    // Quit running the sketch once the file is written
    //exit();    
    println( "done" );
  }
}

  static public void main(String args[]) {
    PApplet.main(new String[] { "--bgcolor=#e0dfe3", "movie2" });
  }
} 
```

要使用纯 java，您需要使用类路径上处理应用程序文件夹中的 core.jar 和 video.jar，然后编译此 java 代码。这是处理库的[函数参考](http://processing.org/reference/)和[javadoc](http://dev.processing.org/reference/core/index.html)。 [这是 MovieMaker 类的 javadocs](http://dev.processing.org/reference/everything/javadoc/processing/video/MovieMaker.html)。如果需要，您可以查看MovieMaker 类的[源代码。](http://dev.processing.org/source/index.cgi/trunk/processing/video/src/processing/video/MovieMaker.java?view=markup)

高温高压

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-17T11:16:26.023

这里有一段与导出相关的示例代码：

[http://developer.apple.com/samplecode/ImportExport/listing1.html](http://developer.apple.com/samplecode/ImportExport/listing1.html)

它展示了如何打开单个原生 QuickTime 影片进行阅读，然后将其传递给 MovieExporter 组件以从中创建新的 QuickTime 影片。

有关导入文件作为编写源的代码，请参阅

```
void importMedia() 
```

有关将源导出到 QuickTime 影片的代码，请参阅

```
void run() 
```

不过，只要 QuickTime 支持输入文件的文件格式（如 fe BMP），就应该可以使用相同的方法打开图像文件。

您也应该能够使用大部分代码编写一系列图像文件。您必须调查的唯一一点是您必须调用哪种方法才能将其他帧*附加*到现有电影。它可能使用相同的 API 工作，但很可能您需要使用另一个调用。

如果您必须挖掘另一种方法，您应该能够在位于此处的 QT Java 参考文档中找到它：

[http://developer.apple.com/Java/Reference/1.4/Java14API_QTJ/](http://developer.apple.com/Java/Reference/1.4/Java14API_QTJ/)

这是一种 hack，性能很可能很差，但它可能确实有效。

而且...我从来没有尝试过这个（我是 Windows 的 QuickTime 人）所以：对不起，没有保修 = ）。

* * *

**编辑**：如果您正在寻找一种使用现有输入缓冲区将帧写入 QT 电影的方法，而不是使用 QT API 从文件中读取数据，那么也应该有用于此的 API。只需查看参考文档即可。

* * *

**编辑 2**：实际上可能值得在这里查看 C/C++ API 文档，因为组件和调用的命名似乎遵循大致相同的命名约定（即，这可能有助于挖掘所需的 Java API 调用）*并且*C/C++ 文档在提供指南和如何作为起点方面似乎更加彻底。C/C++ 文档可以在这里找到：

[http://developer.apple.com/referencelibrary/QuickTime/index.html](http://developer.apple.com/referencelibrary/QuickTime/index.html)

最有趣的部分应该是

1.  *进出口*
2.  *压缩和解压*

玩得开心！

* * *

# c++ - C/C++ Windows 流量拦截器

> ID：642245
> 
> 赞同：0
> 
> 时间：2009-03-13T11:27:50.467
> 
> 标签：c++, c, windows, network-programming, ndis

我想为我的机器后面的网络开发一个带宽分配器。

现在，我已经阅读了有关 NDIS 的信息，但我不确定既不是来自我的机器也不是发往我的机器的网络流量是否会进入我的 TCP/IP 堆栈，以便我可以通过 NDIS 阻止/取消阻止数据包窗户机。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-13T16:59:43.100

NDIS（内核）驱动程序存在于 Windows 网络堆栈中，因此只能拦截由该堆栈处理的数据包。

您无法过滤未发送到您计算机的数据包。

（当计算机充当路由器时，数据包被发送到计算机，计算机将数据包转发给实际的接收者，如果这是问题的话）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-22T17:34:22.303

在正常操作模式下，不相关的流量将被 NIC 驱动程序/固件丢弃，如上所述。但是，这是一个软件问题，因此可以通过在设备驱动程序和/或固件中添加适当的逻辑来更改此行为。例如，这就是嗅探器的工作方式。

# asp.net - 现有 ASP.NET 网站中的 ASP.NET Ajax 功能

> ID：642247
> 
> 赞同：1
> 
> 时间：2009-03-13T11:28:28.060
> 
> 标签：asp.net, ajax

我有一个用 ASP.NET 2.0 开发的 ASP.NET 网站。

现在我想向项目添加一个新页面，该页面将利用 ASP.NET AJAX 功能，如部分页面更新。

有什么选择吗？我是否需要在我现有的项目中为此更改任何设置`/Solution`？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-13T11:30:45.373

如果您不进入并注册 asp.net ajax 程序集，您可能会遇到的唯一问题是在您的 web.config 文件中。

除此之外，您应该能够添加脚本管理器控件并像使用任何其他 asp.net ajax 页面一样使用该页面。

编辑：这里有一些文档可以帮助您将 ASP.NET AJAX 配置到现有网站。

[http://www.asp.net/AJAX/documentation/live/ConfiguringASPNETAJAX.aspx](http://www.asp.net/AJAX/documentation/live/ConfiguringASPNETAJAX.aspx)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-13T12:43:57.223

关于如何在常规 ASP.NET 网站上实现 AJAX 有一个很棒的教程。

[http://www.asp.net/learn/ajax-videos/video-81.aspx](http://www.asp.net/learn/ajax-videos/video-81.aspx)

嗯...

# java - 如何将 JDBC ResultSet 检索为 ArrayList？

> ID：642249
> 
> 赞同：15
> 
> 时间：2009-03-13T11:28:54.863
> 
> 标签：java, performance, jdbc, arraylist, resultset

我正在执行查询以检索大量 ID（整数）。与其通过 ResultSet 迭代数百万次并将所有内容一个接一个地复制到 ArrayList 中，有什么方法可以简单地将所有内容作为 ArrayList 检索吗？

我知道 ResultSet 应该被迭代，因为底层实现可能是缓存的东西，但在我的情况下，我只需要所有的 ID。我知道我可以将 FetchSize 设置为一个很大的数字，但是我仍然必须一个接一个地检索 ID。

澄清：我想这样做的原因是性能。分析向我展示了数百万次执行 ResultSet.next()、ResultSet.getInt() 和 ArrayList.add() 需要相当长的时间。我认为数据库（我使用的是用 Java 编写的 H2）可能在内存中的某处有数组或列表，所以我正在寻找一种方法将其直接复制给我，而不是通过 ResultSet 迭代接口.

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2009-03-13T11:38:51.343

使用 Apache [DbUtils](http://commons.apache.org/dbutils/)库，您可以轻松地将 ResultSet 作为地图列表返回。

```
public List query(String query) {
    List result = null;
    try {
        QueryRunner qrun = new QueryRunner();
        result = (List) qrun.query(connection, query, new MapListHandler());
    } catch (Exception ex) {
        ex.printStackTrace();
    }
    return result;
} 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-03-13T11:38:16.167

将代码放入方法中。调用方法很简单...

在我的头顶上：

```
public static List<Integer> readInts(
     PreparedStatement statement
) throws SQLException {
     ResultSet results = statement.executeQuery();
     try {
         assert results.getMetaData().getColumnCount() == 1;

         List<Integer> ints = new ArrayList<Integer>();
         while (results.next()) {
             ints.add(Integer.valueOf(results.getInt(1)));
         }
         return ints;
     } finally {
         results.close();
     }
} 
```

然后将其称为：

```
List<Integer> ids = readInts(myStatemnet); 
```

完毕。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-03-13T16:16:46.013

如果您的问题是性能不佳，请在执行之前调整语句

```
java.sql.Statement.setFetchSize(int) 
```

尝试 100、1000、10000，.. 这将避免不必要的往返，这可能是您提到的缓慢的原因。

此外，如果必须多次调整内部数组的大小，ArrayList.add() 可能会很慢，因为它会创建一个新数组并将所有数据复制到那里。改用 LinkedList。

# asp.net - 使用 VB.NET 从纯字符串解析 URL ?a=b 参数

> ID：642252
> 
> 赞同：2
> 
> 时间：2009-03-13T11:30:26.183
> 
> 标签：asp.net, vb.net

我正在使用一个字符串来存储 key=value 对，它与 QueryString 具有相同的格式

如何轻松将其解析为数组？还是我可以以某种方式使用内部类 QueryString("paramname") 来访问它？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-13T12:06:11.980

你可以使用[System.Web.HttpUtility.ParseQueryString](http://msdn.microsoft.com/en-us/library/ms150046.aspx#)，这会给你一个`NameValueCollection`. 然后，您可以轻松访问您的值

```
Dim keynameValue As String = nameValueCollection.Get("Keyname") 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-13T11:51:36.367

`String.Split()`可能会为你工作....

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-13T11:52:43.447

```
' parse to pairs
                Dim resultarray As Array = allresultdata.Split("&")
                Dim result1 As String
                Dim keyvals2 As Array
                For Each result1 In resultarray
                    keyvals2 = result1.Split()
                    keyvals.Set(keyvals2(0), keyvals2(1))
                Next 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-13T12:22:08.790

> 还是我可以以某种方式使用内部类 QueryString("paramname") 来访问它？

如果您需要从后面的页面代码以外的另一个类访问查询字符串，请使用：

```
HttpContext.Current.Request.QueryString("parameterName") 
```

# upgrade - 在安装之前强制 Installshield 卸载

> ID：642260
> 
> 赞同：1
> 
> 时间：2009-03-13T11:31:56.290
> 
> 标签：upgrade, installshield, uninstallation, installscript

我有一个 InstallShield 12 安装脚本。我想在安装新版本之前卸载旧版本。我将保持包的名称不变。我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2010-01-21T02:44:31.397

假设这不是一个 MSI 项目并且您保留了相同的项目 GUID，您可以简单地调用`ComponentUninstall()`该`OnMaintUIBefore`函数。如果项目 GUID 不同，您可以查看注册表中的卸载字符串，`HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Uninstall\{PROJECT_GUID}`然后使用它执行 LaunchApp。

希望能帮助到你。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-05T16:35:53.790

对于基于 MSI 的项目，这将通过为您的项目配置主要升级来完成。InstallScript 项目不存在升级，但没有 Windows Installer 限制可防止您同时运行多个安装。您应该能够简单地在您的 InstallScript 代码中手动运行先前版本的卸载（可能在 OnFirstUIBefore 函数中）。

# git - 撤消 git 中的更改（不重写历史记录）

> ID：642264
> 
> 赞同：51
> 
> 时间：2009-03-13T11:32:39.377
> 
> 标签：git, git-revert

我对脚本进行了更改并提交了它。然后我做了一些其他的更改，并将它们推送到远程存储库等。

然后我意识到我提到的第一个更改是愚蠢的，并且想要撤消它。我可以“取消应用”该提交，而无需手动复制/粘贴差异吗？

例如：我有两个文件，`a.py`并且`b.py`：

```
Commit 1:
I delete a function in a.py

Commit 2:
I change a few lines in b.py

Commit 3:
I change the docstring in a.py 
```

我可以撤消该功能删除，并使其显示为“提交 4”（而不是删除提交 1）

* * *

## 回答 #1

> 赞同：67
> 
> 时间：2009-03-13T11:40:17.003

是的，您可以为此使用*git revert*。有关更多信息，请参阅[git 手册部分。](https://git-scm.com/docs/user-manual#reverting-a-commit)

要点是你可以说：

```
git revert 4f4k2a 
```

其中 4f4k2a 是您要撤消的提交的 id，它会尝试撤消它。

* * *

## 回答 #2

> 赞同：36
> 
> 时间：2009-03-13T13:51:47.717

只是一个评论：

```
git revert aCommit 
```

确实恢复*所有*提交（如“提交的*所有文件*部分”）：
它计算一个反向补丁，将其应用于 HEAD 并提交。

所以这里有两个问题（第一个很容易解决）：

*   它总是提交，因此您可能需要添加**`-no-commit`**选项：“ `git revert --no-commit aCommit`”：这在将多个提交的效果连续恢复到您的索引时很有用。
*   它不适用于特定文件（如果您的 a.py 是提交的一部分，并且您可能不想恢复 1000 个其他更改）？
    为此，如果您想像在另一个提交中一样提取特定文件，您应该看到[**`git-checkout`**](http://git-scm.com/docs/git-checkout)，特别是**`git checkout <commit> <filename>`**语法（尽管在这种情况下，这并不是您所需要的）

* * *

[Easy Git](http://www.gnome.org/~newren/eg/) (Elijah Newren) 试图为[Git 邮件列表](http://lists.zerezo.com/git/msg667784.html)带来更“完整的还原” ；但没有多大成功：

> 人们偶尔想要“还原更改”。
> 
> 现在，这可能是：
> 
> *   32 和 29 版本之前的变化，
> *   可能是自上次提交以来的所有更改，
> *   可能是自 3 次提交以来的更改，或者
> *   它可能只是一个特定的提交。
> *   **用户可能希望将此类还原子集化为特定**文件，

（`eg revert`在[此处记录](http://www.gnome.org/~newren/eg/documentation/revert.html)，但我不确定它是否是当前发行版的一部分，尽管如此）

> 但这最终归结为“还原更改”。

```
eg revert --since HEAD~3  # Undo all changes since HEAD~3
eg revert --in HEAD~8     # much like git revert HEAD~8, but nocommit by default
eg revert --since HEAD foo.py  # Undo changes to foo.py since last commit
eg revert foo.py               # Same as above
eg revert --in trial~7 bar.c baz.  # Undo changes made in trial~7 to bar.[ch] 
```

> 这些类型的“恢复数据”是否真的如此不同以至于需要不同的命令，或者简单的恢复命令不应该支持其中一些操作？
> 当然，大多数用户大部分时间可能会使用“ `eg revert FILE1 FILE2...`”形式，但我没有看到支持额外功能的危害。
> 
> 另外……有什么基本的东西可以阻止核心 git 采用这种行为吗？
> 
> 以利亚
> 
> `revert`注意：默认情况下，提交对通用命令没有意义，并且“ `git revert REVISION`”会错误地显示指令（告诉用户添加 --in 标志）。

* * *

假设您有 50 个提交的文件，有 20 个文件您意识到旧的提交 X 引入了不应该发生的更改。
一个小管道是为了。
您需要的是一种列出您需要**恢复**
的所有特定文件的方法 （如**“取消提交 X 中所做的更改，同时保留所有后续更改”**），
然后，对于每个文件：

```
git-merge-file -p a.py X X^ 
```

这里的问题是恢复丢失的功能，而不会删除您可能想要保留的 a.py 中的所有后续更改。
这种技术有时被称为“负合并”。

由于[表示](http://www.kernel.org/pub/software/scm/git/docs/git-merge-file.html):包含从**to****导致的所有更改，因此**您可以通过说要合并所有更改来*恢复已删除的功能。）***`git merge-file <current-file> <base-file> <other-file>`**
**`<base-file>``<other-file>`**`<current-file>`

 **   来自：X（函数已被删除的地方）
*   to: X^（X 之前的上一次提交，该函数仍然存在）

注意：**' `-p`'**参数允许您在不对当前文件执行任何操作的情况下首先查看更改。确定后，删除该选项。

**注意**：并不是**`git merge-file`**那么[简单](http://marc.info/?l=git&m=123545839206803&w=2)：您不能像那样引用文件的以前版本。
（您会一遍又一遍地收到令人沮丧的消息：） **`error: Could not stat X`**您
必须：

```
git cat-file blob a.py > tmp/ori # current file before any modification
git cat-file blob HEAD~2:a.py > tmp/X # file with the function deleted
git cat-file blob HEAD~3:a.py > tmp/F # file with the function which was still there

git merge-file a.py tmp/X tmp/F # basically a RCS-style merge
                                 # note the inversed commit order: X as based, then F
                                 # that is why is is a "negative merge"
diff -u a.py tmp/ori # eyeball the merge result
git add a.py 
git commit -m "function restored" # and any other changes made from X are preserved! 
```

如果要对先前提交中的大量文件执行此操作...一些脚本是有序的；）

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-03-14T16:01:08.860

[正如VonC](https://stackoverflow.com/questions/642264/undo-change-in-git-not-rewriting-history/642809#642809)指出的那样，要在提交中仅恢复对一个文件的更改，我将`checkout`分支（主干或主干或其他），然后`checkout`是我想要恢复的文件版本并将其视为新提交：

```
$ git checkout trunk
$ git checkout 4f4k2a^ a.py
$ git add a.py
$ git diff              #verify I'm only changing what I want; edit as needed
$ git commit -m 'recover function deleted from a.py in 4f4k2a' 
```

可能有一个管道命令可以直接执行此操作，但如果我知道它，我不会使用它。不是我不信任 Git，而是我不信任自己——我不会相信如果不查看该文件在该提交中以及从那以后发生的更改，我就知道了。一旦我看，通过编辑`diff`. 也许这只是个人的工作方式。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-04-15T13:27:25.020

看看[这个 git revert 问题](https://stackoverflow.com/questions/10159775/use-git-revert-to-back-out-a-change-adding-a-line)。如果不是在包括最近提交的连续序列中，恢复旧提交似乎存在问题。

# windows - 在 Firefox 中用作文件类型处理程序时，“开始”在 bat 文件中不起作用

> ID：642265
> 
> 赞同：0
> 
> 时间：2009-03-13T11:32:53.543
> 
> 标签：windows, firefox, batch-file

我有一个批处理（bat / cmd）文件，它应该作为 Firefox 中 jpeg 文件的文件类型处理程序，我只是希望它将文件复制到另一个文件夹，然后在 Picasa 查看器中打开文件。当我从命令行运行它时，即使我是从另一个文件夹运行它，它也可以正常工作，并打开 Picasa Viewer。但是，在 Firefox 中将其设置为 jpeg 文件的处理程序时，它只复制文件，而不启动 Picasa。

这是脚本（我不是批处理程序员，所以这可能要简单得多，只是从各种stackoverflow帖子中拼凑起来的......）：

```
set topath=%~DP0
copy %1 "%topath%"
@echo off

set picpath=%1
set picpath=%picpath:\=;%
set picpath=%picpath: =:%

for /F "tokens=* delims=;" %%i IN (%picpath%) DO call :LAST_FOLDER %%i
goto :EOF

:LAST_FOLDER
if "%1"=="" (
  set LAST2=%LAST::= %
  start explorer "%topath%"
  start "C:\Programfiler\Google\Picasa3\PicasaPhotoViewer.exe" "%topath%\%LAST2%"
  goto :EOF
)

set LAST=%1
SHIFT

goto :LAST_FOLDER 
```

（我也尝试在文件夹中只打开资源管理器，如上所示。）所以，任何人都知道为什么从 Firefox 运行时资源管理器和 Picasa 都没有启动，但都从控制台启动？（此外，在脚本上拖放文件时会启动资源管理器，但 Picasa 不会...）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-22T13:56:59.667

我在使用 start 命令时已经多次看到这个“功能/错误”。

start 命令将第一个参数解释为 "title" 。

试试这个，例如： start "c:\windows\system32\calc.exe" "c:\windows\system32\notepad.exe"

它将启动记事本，而不是计算器

所以只需像这样添加一个虚拟参数：start "some dummy title" "c:\windows\system32\calc.exe"

它会正常工作...

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-08-20T12:35:44.690

查看您的代码（该死，有没有办法在此站点上以正确的对齐方式复制/粘贴？:(）这样的事情可能会有所帮助：

jpgviewer.cmd

```
@echo off
set topath=%~dp0
copy %1 "%topath%"
set file=%~nx1
start explorer "%topath%"
start "-" "%Programfiles%\Google\Picasa3\PicasaPhotoViewer.exe" "%topath%%file%" 
```

希望这可以帮助。

**%~nx0**：获取给定变量的文件名+ext（此处为 0） 太糟糕了，您没有看到它，它不在您获得**~dp**部分的相同位置（**for 的**帮助）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-13T11:39:08.130

我读得不够透彻，无法理解它，但你到 picasa 的路径看起来是错误的，而不是 c:\program files\ 你有 c:\programfiler\

高温高压

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-13T16:07:11.993

您可以尝试替换`start`为`cmd /c start`. 也许这有帮助。

# php - 在 Windows 上使用 PHP 获取共享驱动器列表？

> ID：642266
> 
> 赞同：2
> 
> 时间：2009-03-13T11:33:21.403
> 
> 标签：php, windows

我想显示连接到运行 Windows 的系统的共享驱动器列表。有这方面的教程吗？

我在 PHP 中尝试了以下代码：

```
echo "<select id = 'drives'><option>Drives</option>";
for ($ii=66;$ii<92;$ii++) 
{
    $char = chr($ii);
    if (opendir($char.":/"))
        echo "<option>".$char."</option>";
}
echo "</select>"; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-23T12:56:15.267

您必须在 PHP 中使用实验性 Win32 API 函数：

1.  `GetDriveType`使用[w32api-register-function](http://php.net/manual/en/function.w32api-register-function.php)注册 API函数函数。
2.  之后，您可以使用[w32api-invoke-function](http://www.php.net/manual/en/function.w32api-invoke-function.php)或直接调用`GetDriveType`. 这取决于您的 PHP 版本。[（请参阅w32api-invoke-function](http://www.php.net/manual/en/function.w32api-invoke-function.php)文档底部的用户贡献说明！）
3.  如果是，请检查返回值`DRIVE_REMOTE`。[您可以在GetDriveType](http://msdn.microsoft.com/en-us/library/aa364939.aspx)的 MSDN 文档中找到所需的参数和其他返回值的列表。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-18T13:05:42.197

[您可以通过PHP 的 COM API](http://docs.php.net/manual/en/book.com.php)枚举 Windows 共享资源：

```
$wmi = new COM('WinMgmts:{impersonationLevel=impersonate}!root/cimv2');
$result = $wmi->ExecQuery('Select Path from Win32_Share where Type = 0');
foreach ($result as $share) {
    echo $share->Path, PHP_EOL;
} 
```

输出将列出机器上的所有共享文件夹。类型`0`是磁盘驱动器。

[`Win32_Share`](http://msdn.microsoft.com/en-us/library/windows/desktop/aa394435%28v=vs.85%29.aspx)有关可以查询的其他属性，请参阅 MSDN 文档。

**注意：**如果您正在寻找*Mapped Network Drives*，请将查询更改为

```
Select ProviderName From Win32_LogicalDisk Where DriveType = 4 
```

并更改`$share->Path`为`$share->ProviderName`

有关详细信息，请参阅此[Technet 文章](https://blogs.technet.com/b/heyscriptingguy/archive/2005/10/27/how-can-i-determine-which-drives-are-mapped-to-network-shares.aspx)。

* * *

使用 COM 的替代方法是使用以下`wmic`命令：

```
exec('wmic Share where Type=0 get Path', $shares);
print_r($shares); 
```

相当于上面的第一个例子。有关更多详细信息`WMIC`，请参阅

*   [WMIC - 对 WMI 进行命令行控制](http://technet.microsoft.com/en-us/library/bb742610.aspx)和
*   [Windows 管理规范命令](http://ss64.com/nt/wmic.html)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-13T15:22:51.697

这可能有助于在 c# 下执行此操作。[http://www.codeproject.com/KB/IP/networkshares.aspx](http://www.codeproject.com/KB/IP/networkshares.aspx) 我找不到任何方法可以直接在 php 下进行。

要将它与您的 php 一起使用，您可能需要将其作为 dll 并使用 Win32 api 函数从 php 调用它。

# apache - 我需要将 .CER 转换为 .CRT 以获得 Apache SSL 证书吗？如果是这样，怎么做？

> ID：642284
> 
> 赞同：152
> 
> 时间：2009-03-13T11:40:01.280
> 
> 标签：apache, ssl

我需要使用 SSL 设置 Apache 2 服务器。

我有我的 *.key 文件，但是我在网上找到的所有文档、*.crt 文件都已指定，而我的 CA 只为我提供了一个 *.cer 文件。

*.cer 文件是否与 *.crt 相同？如果不是，如何将 CER 转换为 CRT 格式？

* * *

## 回答 #1

> 赞同：133
> 
> 时间：2009-03-13T12:01:20.650

加密证书的文件扩展名并不像您期望的那样标准化。默认情况下，Windows 将双击`.crt`文件视为将证书导入 Windows 根证书存储的请求，但将`.cer`文件视为仅查看证书的请求。因此，它们在某种意义上是不同的，Windows 对于双击每种类型的文件时发生的事情有一些固有的不同含义。

但是，当您双击它们时，Windows 处理它们的方式大约是两者之间的唯一区别。这两个扩展都只是表示它包含一个公共证书。您可以重命名证书文件以使用一个扩展名代替我见过的任何系统或配置文件中的另一个扩展名。在非 Windows 平台上（甚至在 Windows 上），人们并不特别注意他们使用的扩展名，并且可以互换地对待它们，因为只要文件的内容正确，它们之间就没有区别。

更令人困惑的是，在文件中存储证书数据有两种标准方式：一种是“二进制”X.509 编码，另一种是通常以“”开头的“文本”base64 编码`-----BEGIN CERTIFICATE-----`。它们对相同的数据进行编码，但采用不同的方式。大多数系统都接受这两种格式，但如果需要，您可以通过 openssl 或其他工具将一种格式转换为另一种格式。证书文件中的编码实际上与某人为该文件提供的扩展名无关。

* * *

## 回答 #2

> 赞同：89
> 
> 时间：2016-05-16T11:30:29.533

基本上有两种 CER 证书编码类型，DER 和 Base64。当类型 DER 返回错误加载证书（asn1 编码例程）时，尝试 PEM，它应该可以工作。

`openssl x509 -inform DER -in certificate.cer -out certificate.crt`

`openssl x509 -inform PEM -in certificate.cer -out certificate.crt`

* * *

## 回答 #3

> 赞同：56
> 
> 时间：2015-01-31T12:54:22.373

根据文档[mod_ssl](http://www.modssl.org/docs/2.8/ssl_reference.html)：

```
SSLCertificateFile: 
   Name: SSLCertificateFile
   Description: Server PEM-encoded X.509 certificate file 
```

证书文件应该是 PEM 编码的 X.509 证书文件：

```
openssl x509 -inform DER -in certificate.cer -out certificate.pem 
```

* * *

## 回答 #4

> 赞同：34
> 
> 时间：2013-05-16T12:39:20.940

**CER**是二进制形式的 X.509 证书，**DER**编码。
**CRT**是二进制 X.509 证书，封装在文本 ( **base-64** ) 编码中。

它不是相同的编码。

* * *

## 回答 #5

> 赞同：32
> 
> 时间：2011-03-29T21:03:46.847

我假设您有一个包含 PKCS#7 编码的证书数据的 .cer 文件，并且您希望将其转换为 PEM 编码的证书数据（通常是 .crt 或 .pem 文件）。例如，包含 PKCS#7 编码数据的 .cer 文件如下所示：

```
-----开始PKCS7-----
MIIW4gYJKoZIhvcNAQcCoIIW0zCCFs8CAQExADALBgkqhkiG9w0BBwGggha1MIIH
...
POI9n9cd2cNgQ4xYDiKWL2KjLB+6rQXvqzJ4h6BUcxm1XAX5Uj5tLUUL9wqT6u0G
+bKhADEA
-----结束PKCS7-----

```

PEM 证书数据如下所示：

```
-----开始证书-----
MIIHNjCCBh6gAwIBAgIQAlBxtqKazsxUSR9QdWWxaDANBgkqhkiG9w0BAQUFADBm
...
nv72c/OV4nlyrvBLPoaS5JFUJvFUG8RfAEY=
-----结束证书-----

```

有一个 OpenSSL 命令可以将 .cer 文件（带有 PKCS#7 数据）转换为您可能会遇到的 PEM 数据（上`BEGIN CERTIFICATE`例中的块）。您可以通过此命令在我们称为 certfile.cer 的文件上将 PKCS#7 数据强制转换为 PEM 格式：

`openssl pkcs7 -text -in certfile.cer -print_certs -outform PEM -out certfile.pem`

请注意，.cer 或 .pem 文件可能包含一个或多个证书（可能是整个证书链）。

* * *

## 回答 #6

> 赞同：28
> 
> 时间：2018-08-27T09:10:42.600

我使用命令：

`openssl x509 -inform PEM -in certificate.cer -out certificate.crt`

但 CER 是二进制形式的 X.509 证书，DER 编码。CRT 是二进制 X.509 证书，封装在文本（base-64）编码中。

因此，您可能应该使用：

`openssl x509 -inform DER -in certificate.cer -out certificate.crt`

然后导入您的证书：

将您的 CA 复制到目录：

`/usr/local/share/ca-certificates/`

使用命令：

`sudo cp foo.crt /usr/local/share/ca-certificates/foo.crt`

更新 CA 存储：

`sudo update-ca-certificates`

* * *

## 回答 #7

> 赞同：17
> 
> 时间：2014-02-17T15:32:04.653

如何将 .cer 文件转换为 .crt 文件（它们的编码不同！）的问题的答案是：

```
openssl pkcs7 -print_certs -in certificate.cer -out certificate.crt 
```

* * *

## 回答 #8

> 赞同：7
> 
> 时间：2016-05-05T12:53:36.553

如果您的 cer 文件具有二进制格式，则必须将其转换为

```
openssl x509 -inform DER -in YOUR_CERTIFICATE.cer -out YOUR_CERTIFICATE.crt 
```

* * *

## 回答 #9

> 赞同：4
> 
> 时间：2009-03-13T12:37:44.977

.cer 和 .crt 文件应该可以互换，只要将它们导入密钥库。

查看 .cer 文件的内容。擦除行前和`-----BEGIN CERTIFICATE-----`行后的任何内容`-----END CERTIFICATE-----`。您将留下 BEGIN/END 行，它们之间有一堆 Base64 编码的东西。

```
-----BEGIN CERTIFICATE-----
MIIDQTCCAqqgAwIBAgIJALQea21f1bVjMA0GCSqGSIb3DQEBBQUAMIG1MQswCQYD
...
pfDACIDHTrwCk5OefMwArfEkSBo/
-----END CERTIFICATE----- 
```

然后只需使用 keytool 将其导入到您的密钥文件中。

```
keytool -import -alias myalias -keystore my.keystore -trustcacerts -file mycert.cer 
```

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2021-02-26T11:42:24.730

如果我们需要将 .cer 转换为 .crt，这是一个对我有用的案例，尽管它们在上下文上是相同的

```
openssl pkcs12 -in identity.p12 -nokeys -out mycertificate.crt 
```

我们应该有一个有效的私钥（identity.p12）PKCS 12 格式，这是我从创建我的证书的 CA（认证机构）提供的密钥库（.jks 文件）生成的。

* * *

## 回答 #11

> 赞同：-2
> 
> 时间：2014-12-09T11:16:25.047

做就是了

```
openssl x509 -req -days 365 -in server.cer -signkey server.key -out server.crt 
```

# dynamics-crm - Microsoft CRM 4.0 公告：如何自定义收件人？

> ID：642288
> 
> 赞同：0
> 
> 时间：2009-03-13T11:40:35.613
> 
> 标签：dynamics-crm, dynamics-crm-4

我只想向我组织中的特定收件人发送通知。可能吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-07-01T13:30:24.740

根据[businessunitnewsarticle](http://msdn.microsoft.com/en-us/library/bb889160.aspx)实体的文档，只有一个名为organizationid 的属性，用于将特定businessunitnewsarticle 的目标受众仅限于某个组织。

或者，如果您只想将收件人限制在特定范围内，您可以发送电子邮件活动。

问候，

哈迪

# php - 如何在 xslt 中使用 php 会话？

> ID：642291
> 
> 赞同：1
> 
> 时间：2009-03-13T11:41:01.883
> 
> 标签：php, xslt, session

如何在 XSLT 中使用 php 会话，例如为网上商店制作购物车？

用户可以浏览该站点并在多个项目上单击“添加到购物车”。然后应将每个项目存储在会话变量中。用户可以随时查看通过单击“查看购物车”选择的项目。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-13T11:55:43.720

如果您在 PHP 中使用 XSLT，您可以通过[`XSLTProcessor::setParameter()`](http://www.php.net/manual/en/xsltprocessor.setparameter.php). 您必须在 XSL 中声明该参数

```
<xsl:param name="«param name»"/> 
```

例如...

PHP：

```
// $xsl, $xml -- DOMDocument objects
$proc = new XSLTProcessor;
$proc->importStyleSheet($xsl);
$proc->setParameter(''/*default namespace*/, 'test_param', $aValue);
$proc->setParameter('', 'session_name', session_name());
$proc->setParameter('', 'session_id', session_id());
echo $proc->transformToXML($xml); 
```

XSL：

```
<?xml version="1.0"?>
<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
    <xsl:param name="test_param"/>
    <xsl:param name="session_name"/>
    <xsl:param name="session_id"/>
    <xsl:template match="/">
        <p>Your test parameter is: <xsl:value-of select="$test_param"/></p>
        <p>Your session name is: <xsl:value-of select="$session_name"/></p>
        <p>Your session ID is: <xsl:value-of select="$session_id"/></p>
        <p>
         <a>
          <xsl:attribute name="href">
            <xsl:value-of select="concat('http://example.com/index.php?',$session_name,'=',$session_id)"/>
          </xsl:attribute>
          Link with session
        </a>
       </p> 
    </xsl:template>
</xsl:stylesheet> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-13T12:48:56.947

您可能在某些 XML 上调用 xslt 处理器，为什么不将会话数据添加到该 xml 中？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-05-05T23:59:30.613

早就回答了，但记录在案......

直接从 xsl 中获取会话变量：

```
<xsl:text disable-output-escaping="yes">&lt;?php echo 'SESSION Name: ' . $_SESSION['session_name']; ?&gt;</xsl:text> 
```

进行转换时，不要回显转换，而是将其包括在内：

```
$output_file = 'new_file.php';
$xslt->transformToUri( $xml_dom,  $output_file);
include ('new_file.php'); 
```

# c# - 如何在 C# 中读取和解析 XML 文件？

> ID：642293
> 
> 赞同：426
> 
> 时间：2009-03-13T11:41:36.423
> 
> 标签：c#, xml

如何在 C# 中读取和解析 XML 文件？

* * *

## 回答 #1

> 赞同：551
> 
> 时间：2009-03-13T11:47:05.083

XmlDocument 从字符串或文件中读取 XML。

```
using System.Xml;

XmlDocument doc = new XmlDocument();
doc.Load("c:\\temp.xml"); 
```

或者

```
doc.LoadXml("<xml>something</xml>"); 
```

然后在它下面找到一个节点，就像这样

```
XmlNode node = doc.DocumentElement.SelectSingleNode("/book/title"); 
```

或者

```
foreach(XmlNode node in doc.DocumentElement.ChildNodes){
   string text = node.InnerText; //or loop through its children as well
} 
```

然后像这样读取该节点内的文本

```
string text = node.InnerText; 
```

或读取属性

```
string attr = node.Attributes["theattributename"]?.InnerText 
```

始终在 Attributes["something"] 上检查 null，因为如果属性不存在，它将为 null。

* * *

## 回答 #2

> 赞同：243
> 
> 时间：2009-03-26T12:38:19.013

### **[LINQ to XML](https://docs.microsoft.com/en-us/dotnet/csharp/programming-guide/concepts/linq/linq-to-xml-overview)**示例：

```
// Loading from a file, you can also load from a stream
var xml = XDocument.Load(@"C:\contacts.xml");

// Query the data and write out a subset of contacts
var query = from c in xml.Root.Descendants("contact")
            where (int)c.Attribute("id") < 4
            select c.Element("firstName").Value + " " +
                   c.Element("lastName").Value;

foreach (string name in query)
{
    Console.WriteLine("Contact's Full Name: {0}", name);
} 
```

**参考**：MSDN 上的[LINQ to XML](https://docs.microsoft.com/en-us/dotnet/csharp/programming-guide/concepts/linq/linq-to-xml-overview)

* * *

## 回答 #3

> 赞同：21
> 
> 时间：2013-05-13T18:05:50.937

这是我为读取 xml 站点地图而编写的应用程序：

```
using System;
using System.Collections.Generic;
using System.Windows.Forms; 
using System.Linq;
using System.Text;
using System.Threading.Tasks;
using System.IO;
using System.Data;
using System.Xml;

namespace SiteMapReader
{
    class Program
    {
        static void Main(string[] args)
        {
            Console.WriteLine("Please Enter the Location of the file");

            // get the location we want to get the sitemaps from 
            string dirLoc = Console.ReadLine();

            // get all the sitemaps 
            string[] sitemaps = Directory.GetFiles(dirLoc);
            StreamWriter sw = new StreamWriter(Application.StartupPath + @"\locs.txt", true);

            // loop through each file 
            foreach (string sitemap in sitemaps)
            {
                try
                {
                    // new xdoc instance 
                    XmlDocument xDoc = new XmlDocument();

                    //load up the xml from the location 
                    xDoc.Load(sitemap);

                    // cycle through each child noed 
                    foreach (XmlNode node in xDoc.DocumentElement.ChildNodes)
                    {
                        // first node is the url ... have to go to nexted loc node 
                        foreach (XmlNode locNode in node)
                        {
                            // thereare a couple child nodes here so only take data from node named loc 
                            if (locNode.Name == "loc")
                            {
                                // get the content of the loc node 
                                string loc = locNode.InnerText;

                                // write it to the console so you can see its working 
                                Console.WriteLine(loc + Environment.NewLine);

                                // write it to the file 
                                sw.Write(loc + Environment.NewLine);
                            }
                        }
                    }
                }
                catch { }
            }
            Console.WriteLine("All Done :-)"); 
            Console.ReadLine(); 
        }

        static void readSitemap()
        {
        }
    }
} 
```

粘贴箱上的代码 [http://pastebin.com/yK7cSNeY](http://pastebin.com/yK7cSNeY)

* * *

## 回答 #4

> 赞同：17
> 
> 时间：2009-03-13T11:44:16.527

有很多方法，一些：

*   XmlSerializer。使用具有要读取的目标架构的类 - 使用 XmlSerializer 将 Xml 中的数据加载到类的实例中。
*   林克 2 xml
*   XmlTextReader。
*   xml文档
*   XPathDocument（只读访问）

* * *

## 回答 #5

> 赞同：9
> 
> 时间：2017-02-03T19:55:09.597

您可以使用 DataSet 来读取 XML 字符串。

```
var xmlString = File.ReadAllText(FILE_PATH);
var stringReader = new StringReader(xmlString);
var dsSet = new DataSet();
dsSet.ReadXml(stringReader); 
```

发布此信息是为了提供信息。

* * *

## 回答 #6

> 赞同：7
> 
> 时间：2009-03-13T11:44:18.007

您可以：

*   使用[XmlSerializer 类](http://msdn.microsoft.com/en-us/library/system.xml.serialization.xmlserializer.aspx)
*   使用[XmlDocument 类](http://msdn.microsoft.com/en-us/library/system.xml.xmldocument.aspx)

示例在提供的 msdn 页面上

* * *

## 回答 #7

> 赞同：6
> 
> 时间：2009-03-13T11:51:56.133

[LINQ转XML。](http://msdn.microsoft.com/en-us/library/bb308960.aspx)

此外，VB.NET 通过编译器对 xml 解析的支持比 C# 好得多。如果您有选择和愿望，[请检查一下。](http://msdn.microsoft.com/en-us/library/ms364068.aspx#vb9overview_topic6)

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2009-03-13T11:43:06.730

例如，查看[XmlTextReader](https://msdn.microsoft.com/en-us/library/system.xml.xmltextreader(v=vs.110).aspx)类。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2017-03-21T13:14:15.217

有不同的方法，取决于你想去哪里。XmlDocument 比 XDocument 轻量级，但如果您希望简单地验证字符串是否包含 XML，那么正则表达式可能是您可以做出的最快和最轻量级的选择。例如，我已经使用 SpecFlow 为我的 API 实现了冒烟测试，我希望测试其中一个结果是否为任何有效的 XML - 然后我将使用正则表达式。但是，如果我需要从这个 XML 中提取值，那么我会使用 XDocument 对其进行解析，以更快地使用更少的代码来完成它。或者，如果我必须使用大型 XML（有时我使用大约 1M 行的 XML，甚至更多），我会使用 XmlDocument；然后我什至可以逐行阅读。为什么？尝试在 Visual Studio 中打开超过 800MB 的私有字节；即使在生产中，您也不应该拥有大于 2GB 的对象。你可以用twerk，但你不应该。如果您必须解析包含很多行的文档，那么该文档可能是 CSV。

我写了这个评论，因为我看到了很多 XDocument 的例子。XDocument 不适用于大文档，或者当您只想验证内容是否为 XML 有效时。如果您想检查 XML 本身是否有意义，那么您需要 Schema。

我也对建议的答案投了反对票，因为我相信它本身需要上述信息。想象一下，我需要验证 200M 的 XML（每小时 10 次）是否是有效的 XML。XDocument 会浪费大量资源。

prasanna venkatesh 还指出您可以尝试将字符串填充到数据集，它也会指示有效的 XML。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2015-08-17T14:26:39.910

```
 public void ReadXmlFile()
    {
        string path = HttpContext.Current.Server.MapPath("~/App_Data"); // Finds the location of App_Data on server.
        XmlTextReader reader = new XmlTextReader(System.IO.Path.Combine(path, "XMLFile7.xml")); //Combines the location of App_Data and the file name
        while (reader.Read())
        {
            switch (reader.NodeType)
            {
                case XmlNodeType.Element:
                    break;
                case XmlNodeType.Text:
                    columnNames.Add(reader.Value);
                    break;
                case XmlNodeType.EndElement:
                    break;
            }
        }
    } 
```

您可以避免使用第一条语句，只需在 XmlTextReader 的构造函数中指定路径名。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2020-10-12T11:51:31.453

如果要从 XML 文件中检索特定值

```
 XmlDocument _LocalInfo_Xml = new XmlDocument();
            _LocalInfo_Xml.Load(fileName);
            XmlElement _XmlElement;
            _XmlElement = _LocalInfo_Xml.GetElementsByTagName("UserId")[0] as XmlElement;
            string Value = _XmlElement.InnerText; 
```

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2021-12-01T15:01:26.240

这是使用[Cinchoo ETL](https://www.nuget.org/packages/ChoETL.NETStandard)的另一种方法- 一个用几行代码解析 xml 文件的开源库。

```
using (var r = ChoXmlReader<Item>.LoadText(xml)
       .WithXPath("//item")
      )
{
    foreach (var rec in r)
        rec.Print();
}

public class Item
{
    public string Name { get; set; }
    public string ProtectionLevel { get; set; }
    public string Description { get; set; }
} 
```

小提琴示例：[https ://dotnetfiddle.net/otYq5j](https://dotnetfiddle.net/otYq5j)

免责声明：我是这个库的作者。

# .net - 如何强制 csc / mcs 使用特定版本的程序集引用？

> ID：642299
> 
> 赞同：2
> 
> 时间：2009-03-13T11:43:25.437
> 
> 标签：.net, compiler-construction, mono, nant, assembly-resolution

我需要引用已签名程序集的特定版本。因为它存在于 GAC 中，所以编译器会选择“供应商”版本而不是我提供的版本（GAC 版本号更高，即使它是较旧的 API）。基本编译器选项是否有某种扩展`/reference=Library.dll`允许指定强名称？

我正在使用 NAnt 进行编译，因此`<csc>`基于任务的解决方案将是最佳的，但编译器命令行（csc 和 mcs）也可以。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-13T13:40:32.067

我找到了一个特定于 NAnt 的解决方法。在任务`<references>`的一部分中`<csc>`，使用目录路径为程序集指定单个`<include>`元素，这样它就不会匹配 GAC 中的程序集。因此，当编译器指定程序集的完整路径时，同样适用于编译器。这不完全是我的想法，但它确实有效。

# asp.net-mvc - EFExtensions 与 MVC ~ Materializer

> ID：642304
> 
> 赞同：0
> 
> 时间：2009-03-13T11:44:01.207
> 
> 标签：asp.net-mvc, entity-framework

我在 mvc 中使用带有类型视图的 EFExtensions 并且得到

传入字典的模型项的类型为“Microsoft.Data.Extensions.Materializer`1+d__0[MvcCms.Web.Models.User]”，但此字典需要类型为“MvcCms.Web.Models.ViewData”的模型项。站点管理模型”。

'MvcCms.Web.Models.ViewData.SiteAdminModel' 包含 User 的定义，这里是 SiteAdminModel 中的代码

```
public class SiteAdminModel
{
    public StateProvince SelectedState { get; set; }

    public IEnumerable<StateProvince> States { get; set; }

    public IEnumerable<Organization> Organizations { get; set; }

    public IEnumerable<User> Users { get; set; }

} 
```

解决此问题的最佳方法是什么。可能使用代码隐藏来投射物化版本或在控制器中这样做？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-13T12:04:51.373

出现问题是因为我在渲染部分中传递模型并且不需要在那里传递它，因为没有它控件可以访问。

# wpf - 在 TreeView 中查找 ItemTemplate 控件

> ID：642311
> 
> 赞同：3
> 
> 时间：2009-03-13T11:46:06.677
> 
> 标签：wpf, treeview, itemtemplate, findname

我的树定义是：

```
<TreeView Name="tree" ItemsSource="{Binding Children}" >
    <TreeView.ItemTemplate>
        <HierarchicalDataTemplate ItemsSource="{Binding Children}">
            <CheckBox Name="foo"></CheckBox>
        </HierarchicalDataTemplate>
    </TreeView.ItemTemplate>
</TreeView> 
```

有一个 TreeViewItem 元素，我尝试找到相应的 CheckBox，但是

```
tree.Template.FindName("foo", item); 
```

投掷

```
[System.InvalidOperationException] = {"This operation is valid only on elements that have this template applied."} 
```

和

```
item.Template.FindName("foo", item) 
```

给我*null*。什么是正确的解决方案？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-13T11:53:34.770

尝试 x:Name 属性，而不是 Name 属性...

其次，需要引用ItemTemplate，而不是TreeView的Template

此外，第二个参数必须是 ListItem 的容器，而不是数据项：

```
ContentPresenter container = (ContentPresenter) tree.ItemContainerGenerator.ContainerFromItem(item);
CheckBox box = (CheckBox) container.ContentTemplate.FindName("Foo", container); 
```

# iphone - 检查 UIViewController 是否即将从导航堆栈中弹出？

> ID：642312
> 
> 赞同：63
> 
> 时间：2009-03-13T11:46:32.387
> 
> 标签：iphone, objective-c, uikit, uiviewcontroller, uinavigationbar

我需要知道我的视图控制器何时将从导航堆栈中弹出，以便我可以执行操作。

我不能使用 -viewWillDisappear，因为当视图控制器出于任何原因移出屏幕时会调用它（比如将新的视图控制器推到顶部）。

我特别需要知道控制器何时会自行弹出。

任何想法都会很棒，在此先感谢。

* * *

## 回答 #1

> 赞同：87
> 
> 时间：2012-03-07T15:23:41.357

覆盖`viewWillDisappear`提供的 VC 中的方法，然后检查`isMovingFromParentViewController`覆盖中的标志并执行特定逻辑。就我而言，我隐藏了导航控制器工具栏。仍然需要您介绍的 VC 了解它是被推动的，尽管它并不完美。

* * *

## 回答 #2

> 赞同：31
> 
> 时间：2013-06-29T19:54:26.327

幸运的是，当 viewWillDisappear 方法被调用时，viewController 已经从堆栈中移除了，所以我们知道 viewController 正在弹出，因为它不再在**self.navigationController.viewControllers中**

**斯威夫特 4**

```
override func viewWillDisappear(_ animated: Bool) {
    super.viewWillDisappear(animated)

    if let nav = self.navigationController {
        let isPopping = !nav.viewControllers.contains(self)
        if isPopping {
            // popping off nav
        } else {
            // on nav, not popping off (pushing past, being presented over, etc.)
        }
    } else {
        // not on nav at all
    }
} 
```

**原始代码**

```
- (void)viewWillDisappear:(BOOL)animated {
    [super viewWillDisappear:animated];
    if ((self.navigationController) && 
        (![self.navigationController.viewControllers containsObject:self])) {
        NSLog(@"I've been popped!");
    }
} 
```

* * *

## 回答 #3

> 赞同：26
> 
> 时间：2013-10-25T05:04:46.390

尝试在您的自定义子类中覆盖[`willMoveToParentViewController:`](https://developer.apple.com/library/ios/documentation/uikit/reference/UIViewController_Class/Reference/Reference.html#//apple_ref/occ/instm/UIViewController/willMoveToParentViewController:)（而不是） .`viewWillDisappear:``UIViewController`

> 在从容器视图控制器中添加或删除视图控制器之前调用。

```
- (void)willMoveToParentViewController:(UIViewController *)parent
{
    [super willMoveToParentViewController:parent];
    if (!parent) {
        // `self` is about to get popped.
    }
} 
```

* * *

## 回答 #4

> 赞同：15
> 
> 时间：2009-03-13T12:00:13.383

我认为没有明确的消息，但您可以继承 UINavigationController 并覆盖 - popViewControllerAnimated（尽管我自己之前没有尝试过）。

或者，如果没有其他对视图控制器的引用，您可以添加到它的-dealloc 吗？

* * *

## 回答 #5

> 赞同：14
> 
> 时间：2010-02-10T01:15:41.127

这对我有用。

```
- (void)viewDidDisappear:(BOOL)animated
{
    if (self.parentViewController == nil) {
        NSLog(@"viewDidDisappear doesn't have parent so it's been popped");
        //release stuff here
    } else {
        NSLog(@"PersonViewController view just hidden");
    }
} 
```

* * *

## 回答 #6

> 赞同：9
> 
> 时间：2009-05-03T08:18:55.263

你可以在这里抓住它。

```
- (void)navigationController:(UINavigationController *)navigationController willShowViewController:(UIViewController *)viewController animated:(BOOL)animated {

    if (viewController == YourAboutToAppearController) {
            // do something
    }
} 
```

这将在新视图显示之前触发。还没有人动。我一直在 asinine NavigationController 前做魔术。您可以设置标题和按钮标题并在那里做任何事情。

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2010-09-18T04:18:13.023

我也有同样的问题。我尝试使用 viewDisDisappear，但我没有调用该函数 :(（不知道为什么，可能是因为我所有的 VC 都是 UITableViewController）。Alex 的建议工作正常，但如果您的导航控制器显示在更多选项卡。在这种情况下，您的导航控制器的所有 VC 的导航控制器都为 UIMoreNavigationController，而不是您已子类化的导航控制器，因此当 VC 即将弹出时，导航不会通知您。
最后，我解决了问题使用 UINavigationController 的类别，只需重写 - (UIViewController *)popViewControllerAnimated:(BOOL)animated

```
- (UIViewController *)popViewControllerAnimated:(BOOL)animated{
   NSLog(@"UINavigationController(Magic)");
   UIViewController *vc = self.topViewController;
   if ([vc respondsToSelector:@selector(viewControllerWillBePopped)]) {
      [vc performSelector:@selector(viewControllerWillBePopped)];
   }
   NSArray *vcs = self.viewControllers;
   UIViewController *vcc = [vcs objectAtIndex:[vcs count] - 2];
   [self popToViewController:vcc animated:YES];
   return vcc;} 
```

它对我很有效：D

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2011-03-31T10:24:57.450

我试过这个：

```
- (void) viewWillDisappear:(BOOL)animated {
    // If we are disappearing because we were removed from navigation stack
    if (self.navigationController == nil) {
        // YOUR CODE HERE
    }

    [super viewWillDisappear:animated];
} 
```

这个想法是在弹出时，视图控制器的 navigationController 设置为 nil。因此，如果视图要消失，并且它不再有一个导航控制器，我得出的结论是它被弹出了。（在其他情况下可能不起作用）。

不能保证 viewWillDisappear 会在弹出时被调用，因为文档中没有提到它。当视图是顶视图和顶视图下方时，我尝试了它 - 它在两者中都有效。

祝你好运，奥德。

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2017-01-28T17:00:57.977

子类`UINavigationController`和覆盖`popViewController`：

### 斯威夫特 3

```
protocol CanPreventPopProtocol {
    func shouldBePopped() -> Bool
}

class MyNavigationController: UINavigationController {
    override func popViewController(animated: Bool) -> UIViewController? {
        let viewController = self.topViewController

        if let canPreventPop = viewController as? CanPreventPopProtocol {
            if !canPreventPop.shouldBePopped() {
                return nil
            }
        }
        return super.popViewController(animated: animated)
    }

    //important to prevent UI thread from freezing
    //
    //if popViewController is called by gesture recognizer and prevented by returning nil
    //UI will freeze after calling super.popViewController
    //so that, in order to solve the problem we should not return nil from popViewController
    //we interrupt the call made by gesture recognizer to popViewController through
    //returning false on gestureRecognizerShouldBegin
    //
    //tested on iOS 9.3.2 not others
    func gestureRecognizerShouldBegin(_ gestureRecognizer: UIGestureRecognizer) -> Bool {
        let viewController = self.topViewController

        if let canPreventPop = viewController as? CanPreventPopProtocol {
            if !canPreventPop.shouldBePopped() {
                return false
            }
        }

        return true
    }

} 
```

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2015-07-03T07:51:29.113

你可以使用这个：

```
if(self.isMovingToParentViewController)
{
    NSLog(@"Pushed");
}
else
{
    NSLog(@"Popped");
} 
```

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-03-13T20:43:57.023

也许你可以使用 UINavigationBarDelegate 的 navigationBar:shouldPopItem 协议方法。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2014-02-21T08:38:31.140

尝试在 viewwilldisappear 中进行此检查 if ([self.navigationController.viewControllers indexOfObject:self] == NSNotFound) { //这个视图的弹出已经发生。}

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2019-10-03T07:20:00.657

我有时还需要防止弹出，所以对我来说最好的答案是由 Orkhan Alikhanov 写的。但是因为没有设置delegate所以不起作用，所以我做了最终版本：

```
import UIKit

class CustomActionsNavigationController: UINavigationController, 
                                         UIGestureRecognizerDelegate {
    override func viewDidLoad() {
        super.viewDidLoad()
        interactivePopGestureRecognizer?.delegate = self
    }

    override func popViewController(animated: Bool) -> UIViewController? {
        if let delegate = topViewController as? CustomActionsNavigationControllerDelegate {
            guard delegate.shouldPop() else { return nil }
        }
        return super.popViewController(animated: animated)
    }

    // important to prevent UI thread from freezing
    //
    // if popViewController is called by gesture recognizer and prevented by returning nil
    // UI will freeze after calling super.popViewController
    // so that, in order to solve the problem we should not return nil from popViewController
    // we interrupt the call made by gesture recognizer to popViewController through
    // returning false on gestureRecognizerShouldBegin
    func gestureRecognizerShouldBegin(_ gestureRecognizer: UIGestureRecognizer) -> Bool {
        if let delegate = topViewController as? CustomActionsNavigationControllerDelegate {
            if !delegate.shouldPop() {
                return false
            }
        }

        // This if statement prevents navigation controller to pop when there is only one view controller
        if viewControllers.count == 1 {
            return false
        }

        return true
    }
}

protocol CustomActionsNavigationControllerDelegate {
    func shouldPop() -> Bool
} 
```

**更新**

我添加了`viewControllers.count == 1`案例，因为如果堆栈中有一个控制器并且用户做出手势，它将冻结您的应用程序的 UI。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2019-10-05T22:45:04.623

您可以观察通知：

```
- (void)viewDidLoad{
    [super viewDidLoad];
    [NSNotificationCenter.defaultCenter addObserver:self selector:@selector(navigationControllerWillShowViewController:) name:@"UINavigationControllerWillShowViewControllerNotification" object:nil];
}

- (void)navigationControllerDidShowViewController:(NSNotification *)notification{
    UIViewController *lastVisible = notification.userInfo[@"UINavigationControllerLastVisibleViewController"];
    if(lastVisible == self){
        // we are being popped
    }
} 
```

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2020-10-24T14:14:53.460

```
- (void)viewDidDisappear:(BOOL)animated {
    [super viewDidDisappear:animated];

    const BOOL removingFromParent = ![self.navigationController.viewControllers containsObject:self.parentViewController];
    if ( removingFromParent ) {
        // cleanup
    }
} 
```

# linq-to-sql - 用于将 DAL 特定类（例如 LINQ to SQL 类）投影到 POCO 的模式名称

> ID：642315
> 
> 赞同：0
> 
> 时间：2009-03-13T11:47:51.773
> 
> 标签：linq-to-sql, design-patterns

我正在研究Codeplex 上的[Oxite 项目。](http://www.codeplex.com/oxite)它具有存储库接口和使用 LINQ to SQL 的实现。LINQ to SQL 结果被投影到存储库实现中的 POCO 对象。它看起来像：

```
public IQueryable<Post> GetPosts()
{
    return projectPosts(excludeNotYetPublished(getPostsQuery(siteID)));
} 
```

这是一个有趣的模式，所以我想知道它是否有一个特定的名称。

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-13T11:51:26.243

数据映射器。请参阅此处提到的[http://www.martinfowler.com/eaaCatalog/repository.html](http://www.martinfowler.com/eaaCatalog/repository.html)

“在这样的系统中，在查询构造代码集中的映射层上构建另一层抽象是值得的”。

请注意，对此有不同的看法。我会说那些订阅这样做的人，声称 linq2sql 类是特定于数据访问技术的，所以我猜他们将其视为存储库的实现细节。

也许您的意思是在返回 IQueryable 的“存储库”上询问名称。我认为没有一个普遍认可的名称。Rob Connery 在他的 asp.net mvc 店面系列中使用了这个：http: [//blog.wekeroad.com/mvc-storefront](http://blog.wekeroad.com/mvc-storefront)。如果您查看其上的旧博客文章，您会发现调用存储库实际上是有争议的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-13T12:03:06.793

我认为这更像是数据传输对象 (DTO) 模式，其中结果被转换为 DTO 以进行跨层传输。请参阅[数据传输对象](http://www.martinfowler.com/eaaCatalog/dataTransferObject.html)。

# sql - 如何强制 SQL Server 以特定顺序执行查询

> ID：642318
> 
> 赞同：3
> 
> 时间：2009-03-13T11:49:59.710
> 
> 标签：sql, sql-server, query-optimization

我有以下查询

```

声明 @userId INT  
声明 @siteId INT

设置@siteId = -1  
设置@userId = 1828  

选择 a.id 作为 alertId，  
        a.location_id,  
        a.alert_type_id,  
        a.event_id,  
        a.user_id,  
        a.site_id,  
        a.accepted_by  
FROM 警报作为    
加入 alert_types AS ats ON a.alert_type_id = ats.id
加入事件 AS tr ON a.event_id = tr.event_id
WHERE tr.end_Time 为空
AND tr.status_id = 0
和 ats.code = 'E'
AND a.site_id in (SELECT * FROM dbo.udf_get_event_sitelist(@siteId, @userId))

```

此查询需要 5 到 17 秒才能运行，但是在许多情况下，函数 dbo.udf_get_event_sitelist(@siteId, @userId) 不返回任何行，因此查询不会找到任何数据。

如何强制 SQL Server 首先执行用户定义的函数。我很欣赏我可以将查询重写为存储过程并首先执行子选择，但是如果可能的话，我想在单个 SQL 语句中执行此操作。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-13T13:19:57.653

使“FROM”表成为函数的结果集并将其他表连接到它

```
DECLARE @userId INT  
DECLARE @siteId INT

SET @siteId = -1  
SET @userId = 1828  

SELECT  a.id AS alertId,  
        a.location_id,  
        a.alert_type_id,  
        a.event_id,  
        a.user_id,  
        a.site_id,  
        a.accepted_by  
FROM    (SELECT * FROM dbo.udf_get_event_sitelist(@siteId, @userId)) dt
JOIN    alerts AS a ON dt.site_id=a.site_id
JOIN    alert_types AS ats ON a.alert_type_id = ats.id 
JOIN    events AS tr ON a.event_id = tr.event_id 
WHERE   tr.end_Time IS null
AND     tr.status_id = 0
AND     ats.code = 'E' 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-13T11:53:28.970

您可以将 udf_get_event_sitelist 的结果选择到表变量中，并且仅在 @@rowcount > 0 时继续进行大查询

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-13T12:00:03.867

使用内联函数时遇到的问题是，可以为 SELECT 中返回的每一行重新评估它们。这意味着，如果 SELECT 语句返回 100 行，则该函数可以执行 100 次。

您应该真正遵循 Sambo99 的建议并将其提取到表变量（如果您认为它需要索引，则为临时表）。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-13T11:56:33.390

另外，修改你的UDF只返回site_ID，因为我猜你不需要所有（*）列

```
SELECT * FROM dbo.udf_get_event_sitelist(@siteId, @userId) 
```

到

```
SELECT site_id FROM dbo.udf_get_event_sitelist(@siteId, @userId) 
```

# antivirus - What are the most common virus file types currently circulating?

> ID：642327
> 
> 赞同：1
> 
> 时间：2009-03-13T11:52:49.530
> 
> 标签：antivirus, virus, file-type

I am working on a project that will involve file upload to a server. I am interested in understanding what kinds of files virus writers currently tend to target. I am aware of the following threads:

[How would you programmatically test a file for viruses ?](https://stackoverflow.com/questions/602670/how-would-you-programmatically-test-a-file-for-viruses) [ensuring uploaded files are safe](https://stackoverflow.com/questions/33086/ensuring-uploaded-files-are-safe) [How can I determine a file’s true extension/type programatically?](https://stackoverflow.com/questions/481743/how-can-i-determine-a-files-true-extension-type-programatically) [Server side virus scanning](https://stackoverflow.com/questions/152003/server-side-virus-scanning)

But am interested in general in finding out about common attack vectors.

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-13T12:48:35.420

All of them. There aren't any "safe" file types when [a JPG image can infect you with a virus](http://www.tech-recipes.com/rx/690/jpeg-jpg-exploit-looking-at-picture-installs-spyware-and-viruses/) and you can even [trick the browser to execute JavaScript in any file](http://www.tech-recipes.com/rx/690/jpeg-jpg-exploit-looking-at-picture-installs-spyware-and-viruses/) no matter its declared type.

But the biggest and most widespread danger doesn't even involve uploaded files - ANY text that is entered by users and displayed on your page is a potential vector of [Cross-Site-Scripting](http://en.wikipedia.org/wiki/Cross-site_scripting) attacks.

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-13T12:57:00.750

I ran an "upload file" form for a little while and a few things I found:

*   All sorts of PHP scripts (shells, redirects, various "owned by $LAMER", you name it)
*   I think I had a few browser exploits (.html, .jpgs)
*   A bunch of files with the wrong extensions (ie, PHP scripts with the extension .rar, hoping that the server's mime-type guesser did the wrong thing)
*   Zip files full of all of the above

Anyway, those are just a few things I found. Hope they are helpful.

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-13T12:11:00.003

.exe and .scr are most common filetypes. Also, there are "tricks" with double extensions like readme.txt.scr or readme.doc.exe

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-13T12:05:27.037

exe is probably the most common

# perl - 你能回顾一下我对 Cucumber 的 Perl 重写吗？

> ID：642329
> 
> 赞同：1
> 
> 时间：2009-03-13T11:53:30.933
> 
> 标签：perl, unit-testing, cucumber, acceptance-testing

我们公司有一个团队致力于 X11 GUI 应用程序的验收测试，他们创建了一个巨大的验收测试框架来驱动 GUI 以及运行场景。

该框架是使用 Perl 5 编写的，与验收测试相比，场景文件看起来更像是非常复杂的 Perl 程序（具有过程编程风格的数千行代码）。

我最近学习了 Ruby 的 Cucumber，并且通常已经使用 Ruby 很长时间了。但不幸的是，我不能仅仅推动 Ruby 取代 Perl，因为编写所有这些的人并不了解 Ruby，而且他们肯定不会想要“这种”类型的中断。

因此，为了使 Ruby 的 Cucumber 更接近他们的工作，我使用 Perl 5 重写了它。不幸的是，我真的不是 Perl 程序员，并且很想获得代码审查并听取同时了解 Perl 和 Cucumber 的人的建议。

嗨 Perl/Cucumber StackOverflow 用户 - 请帮助我创建这个“开源”尝试为 Perl 重新创建 Cucumber！我很想听听您的意见，并会接受任何可接受的帮助。

最小的源代码在这里：

```
http://github.com/kesor/p5-cucumber 
```

感谢您的关注。

对于那些不熟悉黄瓜的人 - 请花一点时间来看看这个小页面：[http ://cukes.info/](http://cukes.info/)

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-14T07:58:22.770

你可能会在[Perlmonks](http://perlmonks.perl.org)上得到很好的帮助。该网站面向此类帖子，而 Stackoverflow 更多的是关于直接和可回答的问题。

祝你好运， ：）

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-03-19T06:40:55.430

在 Perl 上有一个更完整的 Cucumber 实现，形式为[Test::BDD::Cucumber](https://metacpan.org/release/Test-BDD-Cucumber)。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-13T14:32:33.377

[Test::A8N](http://search.cpan.org/dist/Test-A8N/)是否符合您的要求？

[如果没有， CPAN](http://search.cpan.org)上还有很多其他的[Test::](http://search.cpan.org/search?mode=module&query=test%3A%3A%2A&complete=1)模块可以满足您的需求。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2010-04-14T07:58:50.377

> 你能回顾一下我对 Cucumber 的 Perl 重写吗？

回答：是的。

我已经阅读了您发布的 github 代码。它看起来很不错。

我很好奇 Parser::Parser.yp::ERROR 的以下片段。为什么你选择使用“and do {}”而不是“if( ){ }”？风格？范围？其他？

```
 exists $parser->YYData->{ERRMSG}
  and do {
    print $parser->YYData->{ERRMSG};
    delete $parser->YYData->{ERRMSG};
    return;
  }; 
```

我还没有使用过黄瓜，并且仍在尝试围绕使用模型进行思考。有人将如何验证/运行您的计算器示例？

如果您计划将代码发布到 CPAN（并且应该），那么您需要将此 git 源代码捆绑到可安装的 tarball 中。您需要包含其中一个模块安装工具：ExtUtils::MakeMaker、Module::Build 等。我最近开始使用[Dist::Zilla](http://search.cpan.org/dist/Dist-Zilla)，并且对它非常满意。它让我克服了释放我的第一个 cpan 模块的激活能量。

Dist::Zilla 20 秒游览：

1.  下载并安装 Dist::Zilla 及其要求（有很多，因为它是开发人员专用工具）
2.  在包的顶层创建一个 dist.ini 文件（'dzil new MyPackage'）
3.  运行“dzil test”、“dzil build”和“dzil release”，进行测试，（构建和测试），（构建、测试和发布）

请参阅[Dist::Zilla::Tutorial](http://search.cpan.org/perldoc?Dist::Zilla::Tutorial)

# css - asp.net mvc默认项目中的html css

> ID：642337
> 
> 赞同：2
> 
> 时间：2009-03-13T11:56:57.570
> 
> 标签：css, asp.net-mvc

默认代码显示向右对齐的主菜单项。我更改了 ul:menu 并添加了属性 float:left 以使“主页”菜单也与页面左侧对齐，但无济于事。

有没有办法将“主页”菜单显示在页面的左端。我正在尝试创建一个类似于 SO 的菜单栏作为学习项目

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-13T12:21:12.443

这是一个 CSS 问题，但在 site.css 中，您可以进行以下更改：

```
#menucontainer
{
    margin-top:40px;
    clear: both; /* Add this*/
}

and also

ul#menu
{
    border-bottom: 1px #5C87B2 solid;
    padding: 0 0 2px;
    position: relative;
    margin: 0;
    text-align: left; /* Change from right to left */
} 
```

为本网站工作。大师

```
<%@ Master Language="C#" Inherits="System.Web.Mvc.ViewMasterPage" %>

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head runat="server">
    <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" />
    <asp:ContentPlaceHolder ID="head" runat="server">
        <title></title>
    </asp:ContentPlaceHolder>
    <link href="../../Content/Site.css" rel="stylesheet" type="text/css" />
</head>

<body>
    <div class="page">
        <div id="header">
            <div id="title">
                <h1>My MVC Application</h1>
            </div>
            <div id="logindisplay">
                <% Html.RenderPartial("LogOnUserControl"); %>
            </div> 
            <div id="menucontainer">
                <ul id="menu">              
                    <li><%= Html.ActionLink("Home", "Index", "Home")%></li>
                    <li><%= Html.ActionLink("About", "About", "Home")%></li>
                </ul>
            </div>
        </div>
        <div id="main">
            <asp:ContentPlaceHolder ID="MainContent" runat="server" />
            <div id="footer">
            </div>
        </div>
    </div>
</body>
</html> 
```

# firebird - 了解查询的执行计划

> ID：642339
> 
> 赞同：1
> 
> 时间：2009-03-13T11:59:35.723
> 
> 标签：firebird, firebird1.5

我有这个 SQL：

```
SELECT
  *
FROM
  Requisicao r
  join convenio c on c.idconvenio = r.idconvenio
  join empresa e on e.idempresa = c.idempresa 
```

当我执行它时，我得到了这个执行计划：

```
PLAN JOIN (C NATURAL,E INDEX (INTEG_160),R INDEX (INTEG_318)) 
```

什么是Convenio的索引没有被使用（每个表都有它的索引）

我想更好地理解它，这样我就可以改善我在使用这个系统时遇到的一些性能问题。

谢谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-13T14:06:03.033

你觉得哪里不对劲？因为您没有任何条件（WHERE 子句），服务器会自然地读取一个表，即从第一行到最后一行。考虑到所服务的索引的选择性，决定从 c 读取并从 e 和 r 连接记录会更好。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-13T14:41:58.830

我同意安德烈的观点。如果 convenio.idconvenio 的选择性较低，则该计划很好。

# c# - C#，WinForms：当我调用 Refresh() 时，为什么不调用 OnPaintBackground？

> ID：642343
> 
> 赞同：1
> 
> 时间：2009-03-13T12:00:30.247
> 
> 标签：c#, winforms

我刚刚找到了一个覆盖 OnPaintBackground 的表单。奇怪的是它从来没有被调用过！就像，完全一样。为什么是这样？表单被刷新、移动、调整大小等，所以它应该做*一些*重绘吧？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-13T12:20:10.650

是否设置了 SetStyle(ControlStyles.UserPaint, True)？或者，它是否具有将 Dock 设置为 Fill 的控件？

# c++ - GetSystemInfo 是否为您提供虚拟 CPU 的总数（即超线程）？

> ID：642348
> 
> 赞同：3
> 
> 时间：2009-03-13T12:03:00.443
> 
> 标签：c++, windows, multithreading, winapi

GetSystemInfo 将为您提供物理 CPU/内核的数量，但我想知道虚拟 CPU 的总数。即在新的 Nahelam 芯片上，它们有 4 个内核，但显示为 8 个 CPU。

如果 GetSystemInfo 没有提供此信息，我需要什么 API（我见过一个用于获取逻辑处理器数量的函数，但它只是 Vista。我需要支持 XP）？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-13T12:10:57.163

[GetLogicalProcessorInformation](http://msdn.microsoft.com/en-us/library/ms683194(VS.85).aspx)函数（Windows Vista、Windows XP Professional x64 Edition、Windows XP with SP3）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-13T14:46:38.677

使用 NAPI（Win32 常见问题解答）

# asp.net-mvc - 无法从视图中访问实体

> ID：642350
> 
> 赞同：0
> 
> 时间：2009-03-13T12:04:03.250
> 
> 标签：asp.net-mvc, linq-to-sql

我正在传递`IList<Post>`给`View(posts)`.
`Post`是`linqToSql`生成的模型类。与表
`Post`有`FK`关系。`Category``Id`

`IList<Post>`当我在我的内部迭代`View`并尝试访问时`post.Category.Title`，我收到一个错误：

> System.ObjectDisposedException：无法访问已处置的对象。对象名称：“Dispose 后访问的 DataContext。”。

我怎样才能获得我`Category.Title`的每一项`Posts`权利`View`？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-13T12:16:41.377

是的，实际上错误告诉你什么！换句话说，保持你的 DataContext 打开直到你处理完数据。

以前我只是为每个页面请求创建一个 DataContext，并在请求结束时将其处理掉。工作相对较好。

# javascript - 动态滚动文本区域

> ID：642353
> 
> 赞同：14
> 
> 时间：2009-03-13T12:04:29.580
> 
> 标签：javascript, ajax, xhtml, textarea

我的页面上有一个通过 ajax 重新加载的 textarea html 元素。每次都返回整个文本区域，而不仅仅是它的内容，而且内容会随着时间的推移而增长。连同 textarea 我返回以下一段 javascript：

```
<script type="text/javascript" >

var textArea = document.getElementById('outputTextResultsArea');
textArea.scrollTop = textArea.scrollHeight;
</script> 
```

在 Firefox 3.0.7 中，这会将滚动条放在 textArea 的底部，让我可以看到最新的输出。但是在 IE 7 中我看到了不同的行为。滚动条按预期随着内容向下移动，但是一旦内容大于文本区域高度，滚动条就不再向下移动。似乎 IE 正在记住元素的原始滚动高度，而不是新高度。

如果有帮助，我正在使用 xhtml 过渡文档类型。此外，如果这可以通过 jQuery 实现，那很好，因为我可以访问它。

提前致谢

尼尔

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2009-03-13T12:09:24.733

作为一个快速破解，你可以这样做：

```
textArea.scrollTop = 99999; 
```

另一种选择是在计时器中尝试：

```
setTimeout(function()
{
    var textArea = document.getElementById('outputTextResultsArea');
    textArea.scrollTop = textArea.scrollHeight;
}, 10); 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2010-11-08T03:46:26.237

使用 jQuery，$("textarea").scrollHeight(99999) 在 Firefox 和 Chrome 上效果很好，但在 IE 上不行。它似乎将其设置为文本区域中的最大行数，而 scrollHeight 应该是像素数。（真棒展示了伟大的工作IE）。不过，这似乎可行：

```
 $("textarea").scrollTop(99999)
      $("textarea").scrollTop($("textarea").scrollTop()*12) 
```

我认为这假设字体高度为 12px。我很想找到一种更强大/更直接的方法来做到这一点。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-03-13T12:22:44.110

不要使用超时，而是在每个 AJAX 响应上调用该函数 - 只要您可以调整它。

这将使您的浏览器免于不必要的超时。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-03-30T15:19:59.133

我最终将它用于 Internet Explorer：

```
textArea.createTextRange().scrollIntoView(false); 
```

这对于其他浏览器：

```
textArea.scrollTop = textArea.scrollHeight; 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2020-06-13T10:48:18.213

对于在您的示例中使用 like textarea，请为您的 textarea 命名为“ **id=LiveTextArea** ”

然后添加你的 javascript 的按钮（LiveTextArea 是 id 名称）：

**LiveTextArea.scrollTop = LiveTextArea.scrollHeight;**

所以看起来像：

**var textArea = document.getElementById('outputTextResultsArea');**

**textArea.scrollTop = textArea.scrollHeight;**

现在 textarea 将在任何新条目上动态滚动插入符号/向下。

# language-agnostic - 数据和代码有什么区别？

> ID：642357
> 
> 赞同：18
> 
> 时间：2009-03-13T12:05:05.820
> 
> 标签：language-agnostic, data-structures, oop, functional-programming

举个例子，考虑一组超市购物者可获得的折扣。

我们可以以某种标准方式将这些规则定义为数据（合格项目列表、适用日期、优惠券代码）并编写通用代码来处理这些。或者，我们可以将每个代码写成一段代码，根据客户的购物清单检查适当的东西并返回任何适用的折扣。

您可以合理地将规则存储为对象、序列化为 Blob 或存储在代码文件中，以便每个规则可以选择自己的数据和代码划分，以允许将来的规则不适合上面考虑的通用处理器类型。

批评混合数据的代码通常很容易，通过 if 语句检查文件或数据库中应该存在的 6 种不同的东西，但是有一个规则可以在边缘情况下有所帮助吗？

或者这是面向对象设计的重点，以阻止我们担心数据和代码之间的界限？

澄清一下，根本问题是：您将如何编写上述示例？是否有经验法则让您决定什么是数据，什么是代码？

（注意：我知道，代码可以编译，但在动态语言和 JIT 编译的世界中，即使这是一个模糊的概念。）

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-03-13T12:35:28.930

从根本上说，数据和代码之间当然没有区别，但对于真正的软件基础设施，可能会有很大的不同。除了明显的事情，如你提到的，编译，最大的问题是：

大多数足够大的项目旨在生成一个大捆绑包的“发布”，在 3 个月（或更长）的周期内生成，经过广泛测试，之后除非以严格控制的方式进行更改，否则无法更改。“代码”绝对不能更改，因此任何需要更改的内容都必须被分解并制作为“配置数据”，以便更改它成为可口的那些工作是确保发布有效的人。

当然，在大多数情况下，糟糕的配置数据可以像糟糕的代码一样彻底破坏发布，所以整个事情在很大程度上是一种错觉——实际上，改变的是代码还是“配置数据”并不重要，重要的是主系统和更改部分之间的接口是狭窄且定义明确的，足以让您有很好的机会让进行更改的人了解他所做的所有后果。

这已经比大多数人想象的要难，因为它实际上只是配置了几个字符串和数字（​​我亲眼目睹了生产大型机系统崩溃，因为它的一个布尔值设置与它正在与之通信的另一个系统不同）。当您的“配置数据”包含复杂的逻辑时，几乎不可能实现。但是情况不会好转，因为您使用了设计糟糕的临时“规则配置”语言而不是“真实”代码。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-03-13T12:17:43.527

这是一个相当哲学的问题（我喜欢），所以我将以哲学的方式回答它：没有什么可以支持的。;)

数据是系统中可以改变的部分。代码定义行为；数据可以更改为新数据的方式。

更准确地说：数据可以由两个组成部分*描述*：对数据应该表示的内容的描述（例如，具有名称和类型的变量）和*值*。变量的值可以根据代码中定义的规则而改变。当然，描述不会改变，因为如果改变了，我们就有了全新的信息。代码本身不会改变，除非需求（我们对系统的期望）发生变化。

对于编译器（或虚拟机）来说，代码实际上是它执行操作的数据。但是，要编译的代码并没有为编译器指定行为，编译器自己的代码会这样做。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-13T12:10:48.990

这一切都取决于要求。如果数据就像查找数据并且经常更改，那么您真的不想在代码中执行它，但是像星期几这样的事情在接下来的 200 年左右不应该改变，所以编写代码。

您可能会考虑更改您的主题，因为我看到它时首先想到的是古老的 LISP 对代码与数据的讨论。幸运的是，Scheme 代码和数据看起来相同，但仅此而已，您永远不会意外地将代码与数据混合在一起，这在 LISP 中很可能与不卫生的宏一起使用。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-03-13T12:14:37.653

数据是由称为代码的指令处理的信息。我不确定我是否觉得 OOD 中存在模糊，仍然存在属性（数据）和方法（代码）。OO 理论将两者封装到称为类的格式塔实体中，但它们在类中仍然是离散的。

你想让你的代码在一个选择问题上有多灵活。在不重新处理源的情况下包含常量值（您通过使用上述 if 语句所做的事情）是不灵活的，而使用动态来源的数据则更加灵活。两种方法都是错误的吗？我会说这真的取决于具体情况。正如 Leppie 所说，某些“数据”点是不变的，例如可以硬编码的星期几，但即使在那里，在某些情况下动态进行编码也可能是有利的。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-13T12:12:32.307

> 在 Lisp 中，你的代码就是数据，你的数据就是代码
> 
> 在 Prolog 中，条款是条款，条款是条款。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-03-13T12:18:15.837

重要的注意事项是，您希望将每次执行相同的代码部分（即应用折扣）与可能更改的代码部分（即要打折的产品或百分比折扣等）

这只是为了安全。如果折扣发生变化，您无需重新编写折扣代码，您只需进入折扣存储库（数据库、应用程序文件或 xml 文件，或者您选择实施它）并制作一个数字的小改动。

此外，如果折扣代码被分离到一个 XML 文件中，那么您可以将整个应用程序交给经理，并且只要有足够的说明，他们就不需要在想要更改折扣率时纠缠您。

当你混合数据和代码时，当任何事情发生变化时，你就会成倍地增加中断的几率。所以，正如[leppie](https://stackoverflow.com/questions/642357/whats-the-difference-between-data-and-code/642377#642377)所说，你需要提取不断变化的部分，并将它们放在一个单独的地方。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2019-05-22T21:07:01.327

巨大的差异。数据是系统的一部分，而代码是系统的一部分。

错误的数据是没有意义的：我们的代码===处理程序很好，你放什么你拿什么，你的意思不是系统的问题。但是如果代码不好 - 系统就是坏的。

例如，让我们考虑一些 JSON，我编写的一些糟糕的代码 parser.js，让我们说好的 V8。对于我的系统来说，parser.js 是一个代码错误，我的系统工作错误。但是对于 Google 系统，我的错误解析器是无法说明 V8 质量的数据。

这个问题非常实际，没有复杂性。 [https://en.wikipedia.org/wiki/Systems_engineering](https://en.wikipedia.org/wiki/Systems_engineering)试图做出好的答案和金钱。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-03-13T12:11:48.347

代码是可以执行的任何数据。现在，由于所有数据在某个时间点都用作某个程序的输入，因此可以说这些数据是由程序执行的！因此，您的程序充当数据的虚拟机。因此理论上数据和代码之间没有区别！

最后，重要的是软件工程/开发考虑因素，如性能、效率等。例如，数据驱动程序可能不如硬编码（因此很脆弱）条件语句的程序高效。因此，我选择将代码定义为可以有效执行的任何数据，而其他所有数据都是纯数据。

这是灵活性和效率之间的权衡。可执行数据（如 XML 规则）提供了更大的灵活性（有时），而将相同的数据/规则编码为应用程序的一部分时将更有效地运行，但频繁更改它会变得很麻烦。换句话说，可执行数据易于部署但效率低下，反之亦然。所以最终决定权在你——软件设计师。

如果我错了，请纠正我。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-03-13T12:13:40.933

数据和代码（程序）之间的界限很模糊。归根结底，这只是一个**术语**问题——例如，您可以说数据就是非代码的一切。但是，正如您所写，它们*可以*愉快地混合在一起（尽管通常最好将它们分开）。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-03-13T12:18:31.623

数据就是信息。这与您决定将其放在哪里无关，无论是数据库、配置文件、通过代码配置还是在类内部。

行为/代码也是如此。这与您决定将其放置在何处或如何选择表示它无关。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-03-13T12:18:33.557

我想说数据、代码和配置之间的区别是在特定组件的上下文中进行的。有时很明显，有时不太明显。

例如，对于编译器来说，它使用的源代码和它创建的目标代码都是数据——应该与编译器自己的代码分开。

在您的情况下，您似乎正在描述一个特别强大的配置文件的选项，该文件可以包含代码。例如，GIMP 允许您使用 Scheme 来“配置”插件。作为读取此配置的组件的开发人员，您会将其视为数据。在不同级别工作时——编写配置——你会认为它是代码。

这是一种非常强大的设计方式。

将此应用于基本问题（“您将如何对上述示例进行编码？”），一种选择可能是采用或设计一种高级域特定语言（DSL）来指定规则。在启动时或第一次需要时，服务器读取规则并执行它。

提供一个管理界面，允许管理员

*   测试一个新的规则文件
*   用新规则文件中的配置替换当前配置

...所有这些都将在运行时发生。

DSL 可能像表解析器或 XML 解析器一样简单，也可能像脚本语言一样复杂。在 C 中，很容易嵌入 Python 或 Lua。从 Java 中嵌入 Groovy 或 Clojure 很容易。

您可以在运行时通过巧妙的链接或类加载器技巧切换编译代码。在我看来，这似乎比嵌入式 DSL 选项更困难且价值更低。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2009-03-13T12:47:01.553

代码与数据的关系如下：

编译为程序后的代码在执行时处理数据

程序可以提取数据、转换数据、加载数据、生成数据......

程序还可以提取代码、转换代码、加载代码、生成代码......

因此，没有编译或interperator的代码是无用的，数据总是值得的......，但编译后的代码可以完成上述所有活动......

例如）

Sourcecontrol系统流程Sourcecodes

这里源代码本身就是代码

备份脚本进程文件

这里的文件是一个数据等等......

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2014-10-10T12:40:55.697

我发现这个问题的最佳实际答案是：任何需要序列化的类，无论是现在还是在任何可预见的未来，都是数据。其他一切都是代码。这就是为什么，例如，Java 的 HashMap 是数据的原因——尽管它有很多代码、API 方法和特定实现（即，乍一看它**可能看起来像代码）。**

# visual-studio - 如何从 Visual Studio 2005 的“最近项目”窗口中删除项目/解决方案

> ID：642380
> 
> 赞同：7
> 
> 时间：2009-03-13T12:11:10.377
> 
> 标签：visual-studio, visual-studio-2005

在 Visual Studio 起始页的左上角，有一个最近的项目部分，列出了标准的 10 个上次打开的项目。我知道可以使用**Tools->Options->Environment->General**更改此编号，然后在最近的文件部分修改编号

但我的问题是如何从最近的列表中删除一些项目？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-03-13T12:14:52.927

这篇[博](http://aspnetcoe.wordpress.com/2007/02/06/how-to-remove-recent-projects-from-visual-studio-start-page/)文很好地回答了你的问题。我不会在这里复制作者的作品。

### 删除最近项目的步骤

1.  如果 Visual Studio 正在运行，请关闭它。
2.  启动注册表编辑器（开始...运行...类型`regedit`）。
3.  导航到此注册表项：`HKEY_CURRENT_USER\Software\Microsoft\VisualStudio\8.0\ProjectMRUList`
4.  然后删除具有您不想保留在列表中的项目的密钥。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2011-11-09T23:16:10.810

右键单击解决方案资源管理器窗口中的解决方案图标，将解决方案的名称更改为其他名称。然后在最近的项目窗口中双击该项目。Visual Studio 将询问您是否需要删除该项目。单击确定以摆脱它。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2019-02-01T21:40:08.480

我将为使用 Visual Studio for Mac 的人添加一个答案：

> 在菜单栏中，选择*文件*➞*最近的解决方案*➞*清除*。

来源：[https ://forums.xamarin.com/discussion/67203/how-do-remove-projects-from-welcome-page-xamrian-studio-for-mac](https://forums.xamarin.com/discussion/67203/how-do-remove-projects-from-welcome-page-xamrian-studio-for-mac)

# php - 如何在变量类上调用静态方法？

> ID：642391
> 
> 赞同：42
> 
> 时间：2009-03-13T12:13:43.087
> 
> 标签：php, oop, class, function, instance

我正在尝试制作某种从给定变量加载和实例化类的函数。像这样的东西：

```
<?php
function loadClass($class) {
  $sClassPath = SYSPATH."/classes/{$class}.php";
  if (file_exists($sClassPath)) {
    require_once($sClassPath);
    $class = $class::getInstance();
  }
}
?> 
```

如果我这样使用它：

```
<?php
  loadClass('session');
?> 
```

它应该包括并实例化会话类。

顺便说一句：静态 getInstance 函数来自此代码：

```
<?php
  function getCallingClass() {
    $backtrace = debug_backtrace();
    $method    = $backtrace[1]['function'];
    $file      = file($backtrace[1]['file']);
    $line      = $file[($backtrace[1]['line'] - 1)];
    $class     = trim(preg_replace("/^.+?([A-Za-z0-9_]*)::{$method}\(.*$/s", "\\1\\2", $line));

    if(! class_exists($class)) {
      return false;
    } return $class;
  }

  class Core {

    protected static $instances = array();

    public static function getInstance() {
      $class = getCallingClass();

      if (!isset(self::$instances[$class])) {
        self::$instances[$class] = new $class();
      } return self::$instances[$class];
    }

  }

?> 
```

* * *

问题是，现在在类中使用函数的方式是这样的：

```
<?php
  $session = session::getInstance();
?> 
```

但是现在我想将它构建到一个函数中，这样我就再也不用使用那行代码了。我只是说 loadClass('session'); 而且我可以使用 $session->blablablafunction();

* * *

## 回答 #1

> 赞同：54
> 
> 时间：2010-06-25T21:27:03.980

在变量类名上调用静态函数显然在 PHP 5.3 中可用：

```
Foo::aStaticMethod();
$classname = 'Foo';
$classname::aStaticMethod(); // As of PHP 5.3.0 
```

[http://php.net/manual/en/language.oop5.static.php](http://php.net/manual/en/language.oop5.static.php)

我自己现在绝对可以使用它。

在那之前，您不能真正假设您正在加载的每个类都被设计为单例。只要您使用的是< 5.3，您就必须加载类并通过构造函数进行实例化：

```
function loadClass($class) {
  $sClassPath = SYSPATH."/classes/{$class}.php";
  if (file_exists($sClassPath)) {
    require_once($sClassPath);
    $class = new $class;
  } 
```

}

或者

只需加载类而不从中创建对象。然后从 loadClass() 函数之外对那些意味着单例的调用“::getInstance()”，对那些不是单例的调用“new”。

尽管正如其他人之前指出的那样， __autoload() 可能对您很有效。

* * *

## 回答 #2

> 赞同：38
> 
> 时间：2009-03-13T12:16:46.043

您可以使用[`call_user_func()`](http://www.php.net/call_user_func)：

```
$class = call_user_func(array($class, 'getInstance')); 
```

在这种情况下，第一个参数是[`callback`](http://www.php.net/manual/en/language.pseudo-types.php#language.types.callback)包含类名和方法名的类型。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-13T12:18:36.177

为什么不使用 __autoload() 函数？

[http://www.php.net/autoload](http://www.php.net/autoload)

然后您只需在需要时实例化对象。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-13T18:19:34.733

Off the top of my head, needs testing, validation etc:

```
<?php

    function loadClass($className) {
        if (is_object($GLOBALS[$className]))
            return;

        $sClassPath = SYSPATH."/classes/{$className}.php";
        if (file_exists($sClassPath)) {
            require_once($sClassPath);

            $reflect = new ReflectionClass($className);
            $classObj = $reflect->newInstanceArgs();
            $GLOBALS[$className] = $classObj;
        }
    }

?> 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-13T14:10:23.633

看起来您正在与 PHP 的当前实现静态绑定作斗争，这就是您使用 getCallingClass 跳过箍的原因。我可以根据经验告诉你，你可能应该放弃尝试通过静态方法将实例化放在父类中。它最终会给你带来更多的问题。PHP 5.3 将实现[“后期静态绑定”](http://us2.php.net/oop5.late-static-bindings)并且应该可以解决您的问题，但现在显然没有帮助。

您可能最好使用 kodisha 提到的自动加载功能并结合可靠的 Singleton 实现。我不确定你的目标是否是语法糖，但它认为从长远来看你会做得更好，以避免试图保存几个字符。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-07-26T16:16:27.270

我认为后期静态绑定对你有用。在每个类的构造中执行：

```
class ClassName
{
    public static $instances = array();

    public function __construct()
    {
        self::$instances[] = $this;
    }
} 
```

然后... 这是我创建的自动加载器。看看这是否解决了你的困境。

```
// Shorten constants for convenience
define ('DS', DIRECTORY_SEPARATOR);
define ('PS', PATH_SEPARATOR);
$template = "default";

// Define an application path constants
define ('APP_ROOT', realpath('.').DS);
define ('VIEW', APP_ROOT . 'Views' . DS);
define ('MODEL', APP_ROOT . 'Models' . DS);
define ('CONTROLLER', APP_ROOT . 'Controllers' . DS);
define ('TEMPLATE', VIEW."templates".DS.$template.DS);
define ('CONTENT', VIEW."content".DS);
define ('HELPERS', MODEL."helpers".DS);

// Check if application is in development stage and set error reporting and
// logging accordingly

error_reporting(E_ALL);
if (defined('DEVELOPMENT')) {
    ini_set('display_errors', 1);
} else {
    ini_set('display_errors', 0);
    ini_set('log_errors', 'On');
    ini_set('error_log', APP_ROOT.'error.log');
}

$paths = array(APP_ROOT, VIEW, MODEL, CONTROLLER, TEMPLATE, CONTENT, HELPERS);

// Set the include path from Config Object
set_include_path(implode(PS, $paths));

// Autoloader
function __autoload($class)
{
    require_once $class.'.php';
    return;
} 
```

那么你所要做的就是

```
$var = new ClassName(); 
```

但是您必须在路径中有一个名为 ClassName.php 的 php 文件，其中 ClassName 与您要实例化的类的名称相同。

# .net - .NET MVC - 全局设置类 - 这些方法中哪个最好：

> ID：642392
> 
> 赞同：1
> 
> 时间：2009-03-13T12:13:45.410
> 
> 标签：.net, asp.net-mvc, settings, global

好的，所以我试图创建一个设置类来存储我需要在整个系统中访问的某些字符串。我使用以下代码创建了一个 globalSettings.cs：

```
public class GlobalSettings
{
    private readonly Hashtable myHT;

    public GlobalSettings()
    {
        //Hashtable used to store global strings
        myHT = new Hashtable();
        myHT.Add("logCategory","TMBC"); //event log category
        myHT.Add("logSource", "MVC"); //event log source

        //setup required options

        //Create log source if required
        if (!EventLog.SourceExists(myHT["logSource"].ToString()))
        {
            EventLog.CreateEventSource(myHT["logSource"].ToString(), myHT["logCategory"].ToString());
        }

    }

    public string getSetting(string key)
    {
        return myHT.ContainsKey(key) ? myHT[key].ToString() : null;
    }
} 
```

目前我已经在我的每个控制器中初始化了这个类，如下所示：

```
protected GlobalSettings globalSettings = new GlobalSettings(); 
```

**我应该将构造函数设置为私有并实现单例模式，因为它毕竟是一个设置类并且只需要一个实例吗？

使用其中的设置信息扩展控制器类会更好吗？

**

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-13T12:23:40.440

就个人而言，我宁愿把这些东西分开。例如，为什么你所有的控制器都需要知道写事件日志？我有一个 LogWriter 类和 ILogWriter 接口，并使用依赖注入（参见 MVCContrib 示例） - 即

```
class FooController : Controller {
    private readonly ILogWriter logWriter;
    public FooController(ILogWriter logWriter) {
        this.logWriter = logWriter; // <==== edited for clarity
    }
} 
```

（并使用基于 DI 的控制器工厂）

这允许您通过模拟日志编写器来对日志编写进行单元测试。然后这些设置将非常适合 LogWriter 类中的常量（或从配置中获取）。

* * *

重新提出具体问题；如果所有值都是常量，请使用常量（或者可能是静态属性）：

```
public static GlobalSettings
{
    public static const string LogCategory = "TMBC"; //event log category
    public static const string LogSource = "MVC"; //event log source
} 
```

如果它们是从配置中获取的，那么字典会很有用；如果它们确实是全局的，那么静态字典就足够了——实例只有在印象之间发生变化时才有用。单例在这里毫无用处；改用静态成员。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-17T14:35:46.607

@Marc Gravell

到目前为止，我有我的主控制器：

```
 public class TasksController : Controller
{
    private tasklistDataContext db = new tasklistDataContext();

    public TasksController(ILogWriter myWriter)
    {
        /* constructor */
    }

    //displays list of tasks
    public ActionResult Index()
    {
        ViewData["Message"] = "Task List";

        IOrderedQueryable<task> tasks = from t in db.tasks orderby t.entryDate descending select t;

        return View(tasks.ToList());
    }

} 
```

到目前为止的 ILogWriter 类如下：

```
 public class ILogWriter
{
    public static string logCategory;
    public static string logSource;

    public ILogWriter()
    {

        logCategory = "TMBC";
        logSource = "MVC";

        //Create log source if required
        if (!EventLog.SourceExists(logSource))
        {
            EventLog.CreateEventSource(logSource, logCategory);
        }

    }

    public void writeLog(string eventMsg)
    {
        EventLog.WriteEntry(logSource, eventMsg, EventLogEntryType.Error);
    }

} 
```

我知道这应该很简单，但我对 .NET 太不熟悉了，我现在觉得它有点挑战 :)

# c# - 在 Win Forms 应用程序中获得焦点？

> ID：642393
> 
> 赞同：0
> 
> 时间：2009-03-13T12:13:51.073
> 
> 标签：c#, focus

我觉得通过询问如何做到这一点，我犯了大罪，因为在大多数情况下，这将是错误和邪恶的。但...

我有一个 winforms 应用程序，它在不使用时最小化到系统托盘我想让它弹出并在它收到来自服务器的消息时成为最顶层的窗口。

我可以让它出现，但我不能让它成为最顶层的窗口。（设置 topmost 不会改变它，但是一旦获得焦点，它确实会使它成为最顶层）

有谁知道该怎么做？，我通常不会这样做，但客户要求这种行为，所以我必须实施它...... :(

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-13T12:42:00.177

如果 .Net 的 'topmost' 功能不起作用，您可以尝试直接从 Windows 的 'SetWindowPos()' API 获取此服务。有关详细信息，请参阅[此](http://support.microsoft.com/kb/195516)页面。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-13T12:44:32.620

在微软的论坛上有一篇[关于这个问题的帖子。](http://social.msdn.microsoft.com/forums/en-US/winforms/thread/bf3117f8-d83d-4b00-8e4f-7398b559a2dd/)

通常，如果窗口在您的应用程序中，调用它的 BringToFront 方法应该可以解决问题。

所以正常的操作顺序：

1.  让它可见
2.  调用 BringToFront()
3.  设置为 TopMost

# c# - C#关于线程安全的问题

> ID：642395
> 
> 赞同：2
> 
> 时间：2009-03-13T12:13:56.890
> 
> 标签：c#, sql, multithreading, thread-safety

我正在使用线程池进行一些繁重的处理以及一些 sql。目前，我在需要时打开 sql 连接，运行查询然后关闭它们。这工作正常。该应用程序一直在运行，没有任何问题。随着此应用程序正在完成更多工作，它正在使用更多线程。更多线程意味着更多打开/关闭 SQL 连接。在 SQL 2005 中，这实际上会影响服务器。我的测试服务器每秒处理大约 175 个事务。其中大约 150 个正在主数据库中运行，并且是“ValidateSQLLogin”。

我将更改应用程序，以便每个线程都有自己的连接，然后这个连接在线程周围传递。

所以我的问题是：

如果 SQL 连接对象是在线程中本地创建的，然后通过 ref 传递给另一个类的静态函数，这会不安全吗？

```
void ThreadA()
{
    SqlConnection a = new SqlConnection(....);
    MyStaticClass.DoStuff(ref a);
}

void ThreadB()
{
    SqlConnection b = new SqlConnection(....);
    MyStaticClass.DoStuff(ref b);
}

static void MyStaticClass.DoStuff(ref SqlConnection sql)
{
    // Do stuff with sql
} 
```

我最初的想法是这将是不安全的，因为 10 个线程可以同时调用同一个静态函数，每个线程都传递自己的连接对象。

以前，静态函数会打开自己的连接，并在完成后关闭它们。

如果不安全，那么解决此问题的最佳方法是什么。我需要尝试最小化 Sql 连接的打开/关闭。

谢谢

加雷斯

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-13T12:17:50.657

静态函数的参数与静态字段不同。静态函数的每次执行都将使用不同的连接副本。您甚至不需要将参数作为参考（仅当您想更改参考参数时才需要参考参数）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-13T12:23:14.577

每个线程都有自己的堆栈，参数和局部变量都存储在堆栈上，因此多个线程调用同一个静态方法是没有问题的。每个方法调用都有自己的参数和局部变量。

但是，没有理由`SqlConnection`通过引用传递该方法。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-13T12:32:37.923

正如其他人所说，从多个线程调用静态方法本身并不危险。但是，如果静态方法修改/访问静态字段*，而不是仅使用您传递的参数，则需要使其成为线程安全的。

*   例外：某些值类型使用原子操作进行访问/写入，并且对于这些操作是隐式线程安全的。但是，在检索和更新这些的逻辑中仍可能出现竞争条件。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-13T13:02:12.610

如果您有大量事务，我建议您保持一个静态连接，当您有此事务时保持打开状态，当负载大大减少或为空时，它会自动关闭，并在有新请求时再次打开。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-13T13:12:42.507

尝试以下操作：

您可以使用[lock](http://msdn.microsoft.com/en-us/library/c5kehkcz(VS.80).aspx)语句来防止其他线程进入您正在使用此连接的代码块，其他线程会自动等待前一个线程完成后再进入此段。只需确保您锁定的对象对您的静态类是私有的。

* * *

## 回答 #6

> 赞同：-2
> 
> 时间：2009-03-13T12:34:15.423

在 .Net 中，所有静态成员都是线程安全的。

# c - I2C ISR 和中断

> ID：642400
> 
> 赞同：2
> 
> 时间：2009-03-13T12:15:54.610
> 
> 标签：c, embedded, arm, i2c

平台 - ARM9

我有一个通过 I2C 连接到 ARM9 的第三方设备。我的问题是 I2C 读/写发生了变化。看起来 IRQ 线已被断言，但在有数据要读取时从未被取消断言。由于第三方设备对地址包进行 NACK，读取失败。所以任何后续的写入都会失败。

我想知道我的中断处理是否正常。在为 IRQ 提供服务的 ISR 中，我禁用中断，取消注册中断处理程序，然后向任务发出信号以从 I2C 总线读取。最后，我重新启用中断。

当任务为上面发布的信号提供服务时，我尝试从 I2C 总线读取数据，但这失败了。最后，我总是在读取尝试后重新注册 ISR。在处理读取信号期间不会发生中断禁用/启用。

我的问题是读取/写入 I2C 总线时是否需要禁用中断？

选择的编程语言是使用专有 RTOS 的 c。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-13T12:47:31.693

重要的是您的 RTOS/系统是否准备好支持嵌套异常。除非有充分的理由这样做，否则如果避免嵌套异常并在进入 ISR 时禁用所有中断并在离开时重新启用，事情会变得更简单。

如果您希望在为 I2C 中断提供服务时允许其他更高优先级的中断发生，则仅禁用 I2C 中断。在进入 ISR 时注销中断处理程序是相当不寻常的。这可能会导致意外的行为，当没有注册的处理程序时，中断本身被启用并发生中断。因此，与其取消注册处理程序，不如简单地禁用 I2C 中断（也许您已经这样做了，但正如我所见，注册处理程序和启用中断是两件不同的事情）。

解决问题的一个好策略是尝试在不中断的情况下与设备通信。尝试以串行方式读取/写入它，如果一切都阻塞并不重要 - 它只是测试。这更容易调试，成功后您可以转到中断版本。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-13T23:40:32.123

大多数中断需要被确认或清除。您提到启用/禁用、注册/注销和处理中断。只需检查中断是否被确认和/或清除/重置。这通常涉及将中断号或位写回中断挂起寄存器。检查特定的 ARM 手册或您的 RTOS 手册。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-13T19:01:27.660

您是否需要为您的目标平台启用/禁用中断取决于您的特定硬件/RTOS 实现。不幸的是，每个 ARM 微控制器供应商（STMicro、Freescale、Oki 等）都有能力以不同的方式实现其 I2C 硬件，并且可能对如何清除 IRQ 有不同的要求。

我建议您找到硬件数据表的副本（和/或在此处发布特定的硬件部件号，以便我们可以帮助您倾注供应商文档）。

# c# - 如何使用 C# 删除 windows 用户帐户

> ID：642406
> 
> 赞同：14
> 
> 时间：2009-03-13T12:17:37.833
> 
> 标签：c#, windows

如何使用 C# 删除 Windows 用户帐户？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-03-13T12:45:56.533

条款 Thomsen 很接近，您需要将 DirectoryEntry.Remove 方法传递给 DirectoryEntry 参数而不是字符串，例如：

```
DirectoryEntry localDirectory = new DirectoryEntry("WinNT://" + Environment.MachineName.ToString());
DirectoryEntries users = localDirectory.Children;
DirectoryEntry user = users.Find("userName");
users.Remove(user); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-13T12:40:48.340

像这样的东西应该可以解决问题（未经测试）：

```
DirectoryEntry localMachine = new DirectoryEntry("WinNT://" +  Environment.MachineName);

DirectoryEntries entries = localMachine.Children;
DirectoryEntry user = entries.Remove("User");
entries.CommitChanges(); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-07-28T09:04:42.857

或者在 .NET 3.5 中使用 System.DirectoryServices.AccountManagement：-

[http://msdn.microsoft.com/en-us/library/bb924557.aspx](http://msdn.microsoft.com/en-us/library/bb924557.aspx)

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2020-03-05T06:29:48.273

```
using System;
using System.DirectoryServices.AccountManagement;

namespace AdministratorsGroupSample
{
    class Program
    {
        static void Main(string[] args)
        {

            PrincipalContext ctx = new PrincipalContext(ContextType.Machine);
            GroupPrincipal grpp = new GroupPrincipal(ctx);
            UserPrincipal usrp = new UserPrincipal(ctx);

            PrincipalSearcher ps_usr = new PrincipalSearcher(usrp);
            PrincipalSearchResult<Principal> fr_usr = ps_usr.FindAll();

            PrincipalSearcher ps_grp = new PrincipalSearcher(grpp);
            PrincipalSearchResult<Principal> fr_grp = ps_grp.FindAll();

            foreach (var usr in fr_usr)
            {
                Console.WriteLine($"Name:{usr.Name} SID:{usr.Sid} Desc:{usr.Description}");
                Console.WriteLine("\t Groups:");
                foreach (var grp in usr.GetGroups())
                {
                    Console.WriteLine("\t" + $"Name:{grp.Name} SID:{grp.Sid} Desc:{grp.Description}");
                }
                Console.WriteLine();
            }

            Console.WriteLine();

            foreach (var grp in fr_grp)
            {
                Console.WriteLine($"{grp.Name} {grp.Description}");
            }

            Console.ReadLine();
        }

        private void Delete(string userName)
        {
            PrincipalContext ctx = new PrincipalContext(ContextType.Machine);
            UserPrincipal usrp = new UserPrincipal(ctx);
            usrp.Name = userName;
            PrincipalSearcher ps_usr = new PrincipalSearcher(usrp);
            var user = ps_usr.FindOne();
            user.Delete();
        }
    }
} 
```

# .net - 如何使用 VB.NET 将十六进制转换为十进制？

> ID：642417
> 
> 赞同：11
> 
> 时间：2009-03-13T12:19:26.957
> 
> 标签：.net, vb.net

[我需要在VB.NET](http://en.wikipedia.org/wiki/Visual_Basic_.NET)中将十六进制转换为十进制。在 C# 中找到了几个示例，但是当我尝试转换为 VB.NET 时，我没有成功。我尝试转换的十六进制数的一个示例是“A14152464C203230304232323020572F544947455234352E”。

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2009-03-14T15:36:18.340

对于实际上不需要使用 bignum 类的十六进制值，您可以使用正常的转换函数，但在数字前加上“&H”。VB 将文本中的“&H”解释为“这是一个十六进制数”，就像它在代码中所做的那样。

```
dim n = Cint("&H" & text) 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-03-13T12:33:20.730

那是一个 24 字节（192 位）的数字；你期望什么价值？

请注意，您可以`Convert`在这里做很多蹩脚的工作 - 例如（在 C# 中）：

```
 string hex = "A14152464C203230304232323020572F544947455234352E";
    byte[] raw = new byte[hex.Length / 2];
    for (int i = 0; i < raw.Length ; i++)
    {
        raw[i] = Convert.ToByte(hex.Substring(i * 2,2), 16);
    } 
```

你如何得到`raw`一个数字取决于你认为这个数字是什么......

[.NET Reflector](http://en.wikipedia.org/wiki/.NET_Reflector)提供的 Visual Basic 翻译（尽管“-1”看起来很奇怪）：

```
Dim hex As String = "A14152464C203230304232323020572F544947455234352E"
Dim raw As Byte() = New Byte((hex.Length / 2)  - 1) {}
Dim i As Integer
For i = 0 To raw.Length - 1
    raw(i) = Convert.ToByte(hex.Substring((i * 2), 2), &H10)
Next i 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2011-06-29T08:47:31.253

您可以使用`Val`Visual Basic 中的函数将十六进制值转换为十进制值。这是通过在字符串前面加上`"&H"`, 来告诉 Visual Basic 这是一个十六进制值，然后将其转换为数字来完成的。

```
Dim Value As Integer = Val("&H" & YourHexadecimalStringHere) 
```

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2018-01-15T16:22:29.900

尝试了其他回复，这是对我有用的回复：

```
 Convert.ToInt32(yourHEXString, 16) 
```

[文档](https://msdn.microsoft.com/pt-br/library/1k20k614(v=vs.110).aspx)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-13T12:24:46.693

自己写一个。

您将需要对字符串进行标记，然后从右侧开始，然后向左工作。

```
int weight = 1;
While Looping
{

  If (token(i) == "F") { DecimalValue += 15 * weight; }
  If (token(i) == "E") { DecimalValue += 14 * weight; }
  If (token(i) == "D") { DecimalValue += 13 * weight; }
  If (token(i) == "C") { DecimalValue += 12 * weight; }
  If (token(i) == "B") { DecimalValue += 11 * weight; }
  If (token(i) == "A") { DecimalValue += 10 * weight; }
  else { DecimalValue += token(i) * weight; }

  weight = weight * 16;
} 
```

类似的东西。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-03-13T12:25:40.437

```
 Dim hex As String
    hex = "A14152464C203230304232323020572F544947455234352E"

    Dim dec As Long
    Dim hexpart As String
    For x As Integer = 1 To (hex.Length / 2)

        hexpart = hex.Substring((x * 2) - 2, 2)
        dec = Int32.Parse(hexpart, System.Globalization.NumberStyles.HexNumber)

        Debug.Print("Hex = " + hex + ",HexPart = " + hexpart + ", Dec = " + dec.ToString + Environment.NewLine)
    Next 
```

这对十进制不起作用，十六进制对于整数来说太长了……但你明白了。您可以将其拆分并重新组合。

```
Hex = A14152464C203230304232323020572F544947455234352E,HexPart = A1, Dec = 161
Hex = A14152464C203230304232323020572F544947455234352E,HexPart = 41, Dec = 65
Hex = A14152464C203230304232323020572F544947455234352E,HexPart = 52, Dec = 82
Hex = A14152464C203230304232323020572F544947455234352E,HexPart = 46, Dec = 70
Hex = A14152464C203230304232323020572F544947455234352E,HexPart = 4C, Dec = 76
Hex = A14152464C203230304232323020572F544947455234352E,HexPart = 20, Dec = 32
Hex = A14152464C203230304232323020572F544947455234352E,HexPart = 32, Dec = 50
Hex = A14152464C203230304232323020572F544947455234352E,HexPart = 30, Dec = 48
Hex = A14152464C203230304232323020572F544947455234352E,HexPart = 30, Dec = 48
Hex = A14152464C203230304232323020572F544947455234352E,HexPart = 42, Dec = 66
Hex = A14152464C203230304232323020572F544947455234352E,HexPart = 32, Dec = 50
Hex = A14152464C203230304232323020572F544947455234352E,HexPart = 32, Dec = 50
Hex = A14152464C203230304232323020572F544947455234352E,HexPart = 30, Dec = 48
Hex = A14152464C203230304232323020572F544947455234352E,HexPart = 20, Dec = 32
Hex = A14152464C203230304232323020572F544947455234352E,HexPart = 57, Dec = 87
Hex = A14152464C203230304232323020572F544947455234352E,HexPart = 2F, Dec = 47
Hex = A14152464C203230304232323020572F544947455234352E,HexPart = 54, Dec = 84
Hex = A14152464C203230304232323020572F544947455234352E,HexPart = 49, Dec = 73
Hex = A14152464C203230304232323020572F544947455234352E,HexPart = 47, Dec = 71 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-03-13T12:38:16.553

这会将您的字符串转换为字节数组：

```
Dim hex As String = "A14152464C203230304232323020572F544947455234352E"

Dim len As Integer = hex.Length \ 2
Dim data(len - 1) As Byte
For i As Integer = 0 to len - 1
   data(i) = Convert.ToByte(hex.Substring(i * 2, 2), 16)
Next 
```

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-03-14T15:29:25.940

```
Private Function toByte(ByVal Shex As String) As List(Of Byte)
    Const cvtCH As Integer = 2
    Dim retval As New List(Of Byte)
    Dim rmndr As Integer
    rmndr = Shex.Length Mod cvtCH
    If rmndr <> 0 Then Shex = Shex.PadLeft(Shex.Length + cvtCH - rmndr, "0"c)
    For x As Integer = 0 To Shex.Length - 1 Step cvtCH
        retval.Add(Convert.ToByte(Shex.Substring(x, cvtCH), 16))
    Next
    Return retval
End Function
Private Function toU32(ByVal Shex As String) As List(Of UInt32)
    Const cvtCH As Integer = 8
    Dim retval As New List(Of UInt32)
    Dim rmndr As Integer
    rmndr = Shex.Length Mod cvtCH
    If rmndr <> 0 Then Shex = Shex.PadLeft(Shex.Length + cvtCH - rmndr, "0"c)
    For x As Integer = 0 To Shex.Length - 1 Step cvtCH
        retval.Add(Convert.ToUInt32(Shex.Substring(x, cvtCH), 16))
    Next
    Return retval
End Function
Private Function toU64(ByVal Shex As String) As List(Of UInt64)
    Const cvtCH As Integer = 16
    Dim retval As New List(Of UInt64)
    Dim rmndr As Integer
    rmndr = Shex.Length Mod cvtCH
    If rmndr <> 0 Then Shex = Shex.PadLeft(Shex.Length + cvtCH - rmndr, "0"c)
    For x As Integer = 0 To Shex.Length - 1 Step cvtCH
        retval.Add(Convert.ToUInt64(Shex.Substring(x, cvtCH), 16))
    Next
    Return retval
End Function
Private Sub Button1_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles Button1.Click
    'unsigned 32 bit max = FFFFFFFF
    'unsigned 64 bit max = FFFFFFFF
    'signed 32 bit max = 7FFFFFFF
    'signed 64 bit max = 7FFFFFFF
    Dim hexS As String = "A14152464C203230304232323020572F544947455234352E"
    Dim hexS2 As String = "A14152464C203230304232323020572F54494745523435"
    toByte(hexS)
    toU32(hexS)
    toU64(hexS)
End Sub 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2016-08-17T05:26:53.053

```
Dim hex As String = "A1B2C3D4"
Dim int As Integer = Val("&H" & hex) 
```

# vb.net - VB.NET 缺少 isNull()？

> ID：642435
> 
> 赞同：6
> 
> 时间：2009-03-13T12:23:14.497
> 
> 标签：vb.net

我想确认创建了数组，怎么做？没有nul关键字？

```
Dim items As Array = str.Split("|")
if (items=null)  then ??? 
```

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2009-03-13T12:26:42.227

要在 VB.Net 中检查对象是否为空，您需要使用 Nothing 关键字。例如

```
If (items is Nothing) Then
    'do stuff
End If 
```

但是 string.Split() 永远不会返回 null，因此您应该检查输入字符串是否为 null 而不是 items 数组。您的代码可以更改为：

```
If Not String.IsNullOrEmpty(str) Then
    Dim items As Array = str.Split("|")
    'do stuff
End If 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-03-13T12:25:08.800

`String.IsNullOrEmpty`在拆分之前尝试在您的字符串变量上使用。如果您尝试拆分字符串中没有任何内容的变量，则数组中仍将有一项（空字符串），因此您`IsNothing`对数组的检查将返回 false。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-03-13T12:33:46.517

String.Split 永远不能返回 null。在最坏的情况下，它可以返回一个没有元素的数组。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-03-13T12:26:34.943

在 VB.NET 中使用“Is Nothing”测试 Null。

```
If items Is Nothing Then

End If 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-13T12:29:53.967

VB 中 null 的关键字是`Nothing`.

但是，在这种情况下，这不是您想要使用的。该`Split`方法从不返回空引用。它总是返回一个包含至少一项的字符串数组。如果您拆分的字符串为空，您将获得一个包含一个长度为零的字符串的数组。

所以，要检查你是否得到了结果，你会这样做：

```
Dim items As String() = str.Split("|")
If items.Length = 1 and items(0).Length = 0 Then ... 
```

首先检查输入当然更容易：

```
If str.Length = 0 Then ... 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2015-03-16T16:51:03.983

对于一个班轮这样做：

```
destinationVariable = if(myvar is nothing, "", myvar) 
```

# ruby-on-rails - 重用另一个 Rails 应用程序的代码

> ID：642437
> 
> 赞同：0
> 
> 时间：2009-03-13T12:23:35.963
> 
> 标签：ruby-on-rails, ruby, reusability

我正在尝试重用我之前工作过的另一个 Rails 应用程序中的一些代码。我复制了所有模型/视图/控制器/迁移并运行 rake db:create and migrate。现在，当我尝试运行应用程序时，该视图的初始页面（具有列表编辑/删除的页面）加载正常并显示有 0 条记录。但是，当我单击新建时，它会在我的其他应用程序中的脚手架创建的一些代码上显示一条错误消息...

```
<%= link_to 'New comment', new_comment_path %>

undefined local variable or method `new_comment_path' for #<ActionView::Base:0xb67c9690> 
```

我应该能够重用这段代码还是我需要做的其他事情来确保我把所有的东西都搬过来了。我尝试使用 grep 来查找在我的另一个项目中定义“new_comment_path”的位置，但我只看到它在与上面列出的内容类似的上下文中使用。任何帮助，将不胜感激。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-03-13T12:26:19.390

此错误表明您缺少路线。

签入您要从中复制的应用程序中的 conf/routes.rb 文件。

很可能您需要做的就是添加

```
map.resources :comments 
```

到你的 routes.rb

并为您复制的所有控制器添加它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-13T14:08:49.063

如果您有时间，或者希望再次这样做，您可以考虑将重用候选者制作成插件，或使用 2.3 中的引擎功能（或为稍旧的版本安装[rails_engines 插件）](http://rails-engines.org/)

# php - 如何从字符串中删除 NULL 字符

> ID：642438
> 
> 赞同：22
> 
> 时间：2009-03-13T12:23:37.040
> 
> 标签：php

我有一个 PHP 变量，其中包含一个表示 XML 结构的字符串。此字符串包含不允许我从该字符串构建新的 SimpleXMLElement 对象的非法字符。我没有办法让内容的来源修改他们的响应，所以我需要在创建 SimpleXMLElement 对象之前对这个字符串执行一些清理。

我相信导致问题的字符是一个 � (0x00 (00) HEX) 字符，它位于此字符串 XML 的文本节点之一中。

删除此字符或其他可能破坏 SimpleXMLElement 对象的字符的最佳方法是什么。

* * *

## 回答 #1

> 赞同：53
> 
> 时间：2009-03-13T12:35:26.963

```
$text = str_replace("\0", "", $text); 
```

将替换字符串中的所有空字符`$text`。如果要进行多次替换，还可以为前两个参数提供数组。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2012-03-01T21:14:19.287

trim() 还将从源字符串的任一端（但不在内部）删除空字符。

```
$text = trim($text); 
```

我发现这对套接字服务器通信很有用，尤其是在传递 JSON 时，因为空字符会导致 json_decode() 返回空值。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2014-02-04T21:31:43.623

虽然它可能不是您问题的主要目标，但请查看 PHP 的过滤器功能：[http ://www.php.net/manual/en/intro.filter.php](http://www.php.net/manual/en/intro.filter.php)

过滤器函数验证和清理值。形成 PHP 站点：

```
$a = 'joe@example.org';
$b = 'bogus - at - example dot org';
$c = '(bogus@example.org)';

$sanitized_a = filter_var($a, FILTER_SANITIZE_EMAIL);
if (filter_var($sanitized_a, FILTER_VALIDATE_EMAIL)) {
    echo "This (a) sanitized email address is considered valid.\n";
}

$sanitized_b = filter_var($b, FILTER_SANITIZE_EMAIL);
if (filter_var($sanitized_b, FILTER_VALIDATE_EMAIL)) {
    echo "This sanitized email address is considered valid.";
} else {
    echo "This (b) sanitized email address is considered invalid.\n";
}

$sanitized_c = filter_var($c, FILTER_SANITIZE_EMAIL);
if (filter_var($sanitized_c, FILTER_VALIDATE_EMAIL)) {
    echo "This (c) sanitized email address is considered valid.\n";
    echo "Before: $c\n";
    echo "After:  $sanitized_c\n";    
} 
```

结果：

> 这个 (a) 净化的电子邮件地址被认为是有效的。
> 
> 此 (b) 已清理的电子邮件地址被视为**无效**。
> 
> 此 (C) 已清理的电子邮件地址被视为有效。
> 
> 之前：（bogus@example.org）
> 
> 之后：bogus@example.org

# c# - 从 Windows 客户端应用程序管理远程 *NIX 服务器上的文件的方法

> ID：642443
> 
> 赞同：1
> 
> 时间：2009-03-13T12:25:05.117
> 
> 标签：c#, mysql, web-services, ssh, webdav

我的 Windows 客户端应用程序（用 C# 编写）与部署在 *NIX 服务器上的远程 MySQL 数据库一起工作。

我将添加在服务器上存储文件的功能。我从不喜欢将文件存储在数据库中，因此文件将存储在文件系统中。应用程序需要从服务器上传、下载和删除文件。

我能想到的任何方法都需要在服务器上部署额外的服务。到目前为止，我最喜欢的是 SFTP*，但还有其他 IMO 较差的解决方案：

1.  Web 服务 - 有吗？没有做过这方面的研究。

2.  FTP 服务器 - 至少带来与协议本身相关的所有问题

3.  WebDAV - 有趣的选项，考虑到有 Apache 模块和 .NET 库

4.  一些临时脚本（显然是最糟糕的解决方案）

*我打算使用 SharpSSH 库和公钥认证来访问服务器上的特殊帐户，该帐户将仅限于 SSH 操作

编辑：纠正了一些术语混淆，感谢@vartec

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-14T20:35:03.083

我会在 *NIX 服务器端使用[vsftpd](http://vsftpd.beasts.org/)：它体积小且易于配置，而且自从我大约 6 个月前最初设置它以来，我没有遇到任何问题，因此它也很可靠。我只使用常规 FTP，但如果您担心安全性，可以使用 vsftpd 进行 SSL。

在客户端有这个[免费的、开源的、C# 的 FTP 客户端库，由 Dan 在 C-SharpCorner.com 制作](http://www.c-sharpcorner.com/uploadfile/danglass/ftpclient12062005053849am/ftpclient.aspx)。它可以工作，并且很容易扩展它的功能来做更多的事情。例如，我添加了一个更改远程服务器上文件权限的功能。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-13T12:43:31.470

SCP 的功能相当有限。[SFTP](http://en.wikipedia.org/wiki/SSH_File_Transfer_Protocol)和[FISH](http://en.wikipedia.org/wiki/Files_transferred_over_shell_protocol)为您提供了比普通 SCP 更多的功能。（请注意，不应将 SFTP 与[FTPS](http://en.wikipedia.org/wiki/FTPS)混淆）

[SFTP C# 实现示例](http://www.jscape.com/articles/sftp_using_csharp.html)。

优于其他选项 - 无需在服务器端进行额外配置。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-14T20:38:54.417

putty 和 winscp 是你所需要的。

# c# - url 无法在 C# 中使用 request[] 正确解码

> ID：642460
> 
> 赞同：1
> 
> 时间：2009-03-13T12:32:08.127
> 
> 标签：c#, url, request

我有一个这样的对象：

```
public class adapterContext {
    public HttpRequest Request;
}
adapterContext ac = new adapterContext();
ac.Response = context.Response; 
```

我将此对象传递给我的函数并使用 ac.Request[""] 获取我的 url 变量。然而，这不知何故不能正确翻译国家/特殊字符。当我使用 f.ex 作为 URL 的一部分时：prospectName=Tester+%e6+%f8+%e5

我得到“测试员？？？”

从调试器我得到： ac.Request["prospectName"][7] 65533 '�' char

任何人都知道我应该如何解决这个问题？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-13T12:33:07.250

有一个很好的功能，您应该注意：[HttpUtility.UrlDecode(string, Encoding)](http://msdn.microsoft.com/en-us/library/system.web.httputility.urldecode.aspx) ...否则您需要调整 web.config 中的[全球化设置](http://msdn.microsoft.com/en-us/library/hy4kkhe0.aspx)（requestEncoding，responseEncoding ...）

# unix - 将 Unix 路径转换为 DOS 路径

> ID：642464
> 
> 赞同：2
> 
> 时间：2009-03-13T12:33:08.780
> 
> 标签：unix, shell, string, dos, ksh

我有一个存储 Unix 路径的变量，例如：

```
typeset unixpath=/foo/bar/ 
```

我必须使用 KornShell (ksh) 脚本将其转换为 DOS 路径：

```
dospath=\\\\foo\\\\bar\\\\ 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-13T12:49:01.317

尝试：

```
dospath=`echo $unixpath | sed 's/\//\\\\/g'` 
```

[感谢[David Wolever](https://stackoverflow.com/users/71522/david-wolever)提醒我使用 $ 来访问变量的值！]

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-13T14:04:09.903

如果您有*ksh93*：

```
ksh-M 93t 2008-11-04$ unixpath=/foo/bar/            
ksh-M 93t 2008-11-04$ print ${unixpath//\//\\\\\\\\}
\\foo\\bar\\ 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2011-03-20T01:42:17.407

用于 Windows 的 AT&T ksh93 允许您使用 'typeset -H' 标记变量以进行自动转换：

$ typeset -H home=$HOME && print $home=$HOME C:\users\Henk=/home/Henk

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-16T17:05:40.777

我会作为评论添加到 1181 的答案，但我没有要点

为了使其更具可读性，如何使用替代 sed 分隔符

IE

```
dospath=`echo $unixpath | sed 's./.\\\\.g'` 
```

# asp.net - ASP.NET Web 服务中的静态字段

> ID：642465
> 
> 赞同：4
> 
> 时间：2009-03-13T12:33:15.270
> 
> 标签：asp.net, web-services, multithreading, synchronization, static-members

Web 服务中的静态变量是否在服务器上所有正在运行的 Web 服务调用之间共享？

在我的情况下，我想要一个服务器范围的同步锁，我相信我可以通过一个单一的

```
private static Object syncHandle = new Object(); 
```

那是对的吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-13T12:43:32.607

是的，它们都是按 AppDomain 共享的，这就是为什么通常不应该使用它们的原因！

一般来说，它们不应该被使用，因为它们不太可能被正确使用。也因为有更安全的选择，比如 HttpContext.Cache，甚至是 Session 状态。

尽管如此，如果您封装对这些静态成员的所有访问，并且如果您正确处理锁定，那么您将拥有一个安全的实现，然后可能会成为瓶颈，所有线程都在争夺共享资源。没有它真的更好。

此外，您似乎指的是 ASMX Web 服务，但您应该指定 ASMX 或 WCF。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-13T12:45:45.723

我相信只要它们在同一个进程中运行，它们就会被共享。因此，从同一服务器请求的两个人将拥有相同的对象实例。但是，您可以在 IIS 上不同进程的计算机上运行不同的应用程序，在这种情况下，我很确定不会共享对象的实例。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-13T12:49:00.223

除非您有网络花园，否则它们都是共享的。网络花园是处理单个应用程序的多个主机进程。在这种情况下，每个主机都有自己的静态数据。

# c# - 如何将另一个对象添加到已定义的 IQueryable 对象？

> ID：642470
> 
> 赞同：0
> 
> 时间：2009-03-13T12:34:05.720
> 
> 标签：c#

我有 IQueryable 产品。现在我想向这个 IQueryable 对象添加新产品。那么我该怎么做呢？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-13T12:42:24.793

我从来没有试过这个，但试试 products.Union(moreProducts)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-13T12:42:55.730

IQueryable 没有任何添加方法。[请参阅 MSDN](http://msdn.microsoft.com/en-us/library/system.linq.iqueryable_members.aspx)。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-13T12:44:15.790

IQueryable 接口本身不提供添加到项目集的操作。你在使用 ORM 吗？哪一个？Microsoft 的实体框架通过 System.Data.Linq.Table<TEntity> 类实现 IQueryable，该类还具有添加实体的方法（Attach、AttachAll）。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-13T12:44:55.960

您将不得不转换回实现 IQueryable 的类型。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-13T12:45:13.103

IQueryable 不提供任何添加项目的方法的保证；为了添加项目，您需要访问 IQueryable 后面的数据存储。如果您使用的是 Linq to SQL，这将是该表。在这种情况下，您的代码将类似于 DataContext.GetTable().InsertOnSubmit(aProduct)。

# objective-c - NSRangeException - 为什么？

> ID：642472
> 
> 赞同：0
> 
> 时间：2009-03-13T12:34:20.290
> 
> 标签：objective-c, cocoa, cocoa-touch

这似乎是一个基本问题.. 但我的数组大小是 64，我正在替换索引 63 处的对象。像这样：

```
[myMutableArray replaceObjectAtIndex:myIndex withObject:myObj]; 
```

所以我不知道为什么 gdb 告诉我这个：

```
*** Terminating app due to uncaught exception 'NSRangeException', reason: '*** -[NSCFArray objectAtIndex:]: index (64) beyond bounds (64)' 
```

为什么它说我的索引是64？我是63级的。

谢谢。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-03-13T12:38:04.557

在调用之前尝试 NSLog'ing myIndex 的值，或者寻找可能导致此异常的其他地方。

尝试在 Xcode 中设置一个“异常断点”（这相当于中断`-[NSException raise]`和/或`objc_exception_throw`）以查看它的来源。（有关异常断点，请参见[此处。）](http://chanson.livejournal.com/171198.html)

# sql - 选择列信息并加入约束信息

> ID：642473
> 
> 赞同：1
> 
> 时间：2009-03-13T12:34:50.867
> 
> 标签：sql

如何加入这 2 个查询以在一个结果中获取所有表信息？

**A - 获取属于表客户的所有列及其数据类型**

```
select COLUMN_NAME, DATA_TYPE from INFORMATION_SCHEMA.COLUMNS where TABLE_NAME = 'Customers' 
```

**B - 获取表客户上的所有约束**

```
SELECT        KCU1.CONSTRAINT_NAME AS 'ConstraintName', KCU1.COLUMN_NAME AS 'ColumnName', KCU2.TABLE_NAME AS 'ForeignTableName', 
                             KCU2.COLUMN_NAME AS 'ForeignColumnName'
    FROM            INFORMATION_SCHEMA.REFERENTIAL_CONSTRAINTS AS RC INNER JOIN
                             INFORMATION_SCHEMA.KEY_COLUMN_USAGE AS KCU1 ON KCU1.CONSTRAINT_CATALOG = RC.CONSTRAINT_CATALOG AND 
                             KCU1.CONSTRAINT_SCHEMA = RC.CONSTRAINT_SCHEMA AND KCU1.CONSTRAINT_NAME = RC.CONSTRAINT_NAME INNER JOIN
                             INFORMATION_SCHEMA.KEY_COLUMN_USAGE AS KCU2 ON KCU2.CONSTRAINT_CATALOG = RC.UNIQUE_CONSTRAINT_CATALOG AND 
                             KCU2.CONSTRAINT_SCHEMA = RC.UNIQUE_CONSTRAINT_SCHEMA AND KCU2.CONSTRAINT_NAME = RC.UNIQUE_CONSTRAINT_NAME AND 
                             KCU2.ORDINAL_POSITION = KCU1.ORDINAL_POSITION AND KCU1.TABLE_NAME = 'Customers' 
```

我想要的结果是所有列的列表，那些与另一个表有外键连接的列应该这样表示。（抱歉我的术语不好）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-13T12:51:32.730

啊! 知道了 ！这里是：

```
SELECT        CL.COLUMN_NAME AS 'ColumnName', CL.DATA_TYPE AS 'DataType', CL.CHARACTER_MAXIMUM_LENGTH AS 'MaxLength', 
                         KCU1.CONSTRAINT_NAME AS 'ConstraintName', KCU2.TABLE_NAME AS 'ForeignTableName', KCU2.COLUMN_NAME AS 'ForeignColumnName'
FROM            INFORMATION_SCHEMA.REFERENTIAL_CONSTRAINTS AS RC INNER JOIN
                         INFORMATION_SCHEMA.KEY_COLUMN_USAGE AS KCU1 ON KCU1.CONSTRAINT_CATALOG = RC.CONSTRAINT_CATALOG AND 
                         KCU1.CONSTRAINT_SCHEMA = RC.CONSTRAINT_SCHEMA AND KCU1.CONSTRAINT_NAME = RC.CONSTRAINT_NAME INNER JOIN
                         INFORMATION_SCHEMA.KEY_COLUMN_USAGE AS KCU2 ON KCU2.CONSTRAINT_CATALOG = RC.UNIQUE_CONSTRAINT_CATALOG AND 
                         KCU2.CONSTRAINT_SCHEMA = RC.UNIQUE_CONSTRAINT_SCHEMA AND KCU2.CONSTRAINT_NAME = RC.UNIQUE_CONSTRAINT_NAME AND 
                         KCU2.ORDINAL_POSITION = KCU1.ORDINAL_POSITION AND KCU1.TABLE_NAME = 'Customers' RIGHT OUTER JOIN
                         INFORMATION_SCHEMA.COLUMNS AS CL ON KCU1.TABLE_NAME = CL.TABLE_NAME AND KCU1.COLUMN_NAME = CL.COLUMN_NAME
WHERE        (CL.TABLE_NAME = N'Customers')
ORDER BY CL.ORDINAL_POSITION 
```

# sql - 在数字字符串上使用通配符的 Mysql 查询

> ID：642474
> 
> 赞同：1
> 
> 时间：2009-03-13T12:35:21.473
> 
> 标签：sql, mysql, wildcard

我正在尝试查询一个包含数字字符串（即'1,2,3,4,5'）的mysql表。

如果它是 '9,10' '9%' 不起作用，我如何搜索以查看它是否有 '1' 但不是 '11'？

固定的！

```
(field like '10' OR field like '%,10,%' OR field like '%,10' OR field like '10,%') 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-13T12:41:39.710

你可以试试 find_in_set 函数

```
select find_in_set('1','1,2,3,11,12') 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-13T12:40:36.360

您需要功能[FIND_IN_SET](http://dev.mysql.com/doc/refman/5.1/de/string-functions.html#id1242404)。顺便说一句，'9%' 应该可以工作，如果该列包含您指定的值，您确定要查询吗

```
SELECT * FROM table WHERE field LIKE '9%'? 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-13T12:52:23.587

标准 SQL 也可以做到这一点：

```
...
WHERE 
  ',' + SetValue + ',' LIKE '%,1,%' 
  AND ',' + SetValue + ',' NOT LIKE '%,11,%' 
```

此表达式无法使用索引，因此随着表大小的增加，性能会迅速下降。

为了获得更好的性能，您的表格应该被正确规范化，例如

```
SetId  SetValue
    1  1
    1  2
    1  3
    1  4
    1  5 
```

代替

```
SetId  SetValue
    1  '1,2,3,4,5' 
```

# algorithm - 解析文本并返回相似性

> ID：642477
> 
> 赞同：1
> 
> 时间：2009-03-13T12:36:48.147
> 
> 标签：algorithm, parsing

假设我有几个 URL，我从每个 URL 返回基本名称，如下所示；

```
http://www.test.com/the.code.r00 
```

会回来

```
the.code.r00 
```

我有几个从几个 URL 中提取的基本名称来处理

```
the.code.r00
the.code.r01
..
...
the.code.r12 
```

连同那些我也有来自其他 URL 的以下基本名称

```
the.matrix.r00
the.matrix.r01
..
...
the.matrix.r14 
```

我想知道是否有一种已知算法已经过测试并证明可以返回

```
the.code.r
the.matrix.r 
```

在解析了我上面列出的基本名称之后。

此外，如果相反，有一些 *nix 工具可以做同样的事情，那就太棒了。

请注意，格式并不总是像上面那样，否则我可以做一个简单的 substr。这些数字并不总是列在字符串中的某个特定位置。其他一些例子；

```
the.code.part01.rar
the.code.001
..
.... 
```

我可以实现我自己的算法来做到这一点，但它可能是一堆错误，没有一些繁重的测试，所以如果已经定义了一个已知的算法，我宁愿使用一个已知的算法。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-13T12:41:01.630

您可能正在寻找[最长公共子串问题](http://en.wikipedia.org/wiki/Longest_common_substring)的锚定实现。对字符串列表进行排序，并对相邻元素执行锚定 LCS。将 LCS 插入一个多值 hashmap，其中 LCS 作为键，两个字符串作为值。

一旦你有了它，对 LCS 字符串做同样的事情，直到你达到某个阈值。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-13T13:04:25.070

查看列表中的每一对字符串并计算它们之间的[Levenshtein 距离](https://stackoverflow.com/questions/642477/parse-text-and-return-similarities)（又名字符串编辑距离）。这将为您提供将一个字符串更改为另一个字符串所需的最少更改次数。

现在从 Levenshtein 实现中获取字符串之间的实际更改集（通过跟踪动态程序中的反向指针）。如果该组更改仅包括用数字替换其他数字，那么您已经找到了一种模式。复制其中一个字符串，删除这些数字，将其存储在您的模式集中，然后继续处理其他字符串对。

# asp.net - 创建过期的 ASP.NET 会话值

> ID：642478
> 
> 赞同：5
> 
> 时间：2009-03-13T12:36:53.310
> 
> 标签：asp.net, vb.net

我喜欢创建一个 5 分钟后过期的会话值。

怎么做，我阅读时是否需要手动比较创建时间？

```
Session("sessionval") = myvariable
Session("sessioncreated") = now 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-03-13T12:41:33.237

如果您询问如何在单个变量上执行此操作，我认为这是不可能的，但您可以使用 web.config 定义会话超时时间

```
<system.web>  
    <sessionState timeout="5" />
<system.web> 
```

这将影响您的所有会话对象，而不仅仅是一个。

我为单个项目提供自定义到期日期的建议是创建一个 cookie，这样您就可以实际设置它的到期值。

```
Response.Cookies.Add(New Web.HttpCookie("AdminID", admin.AdminID))
Response.Cookies("AdminID").Expires = Now.AddMinutes(5) 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-03-13T12:40:37.437

您不能为会话变量定义自定义超时。

也许您可以为此使用缓存，并使用依赖于会话的唯一键。

您可以将超时设置为缓存项。

```
Cache.Insert("key_dependent_to_session", value, Nothing, 
  DateTime.Now.AddMinutes(5), TimeSpan.Zero) 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-03-13T13:05:28.407

如果您想使用 SessionState，您可以创建自己的包装器，因此您可以缓存包装器，而不是缓存实际项目。这是一个快速肮脏的未经测试的包装器示例，它检查项目是否为空，或者它是否已过期，它将调用一个 Func，您可以提供一个刷新的项目。

Func 采用最后设置的值，因此如果您可以确定该值是否仍然有效，则可以避免重新加载它。

```
public class TimeExpirationItem<T>
{
    private T _item=default(T);
    private TimeSpan _expirationDuration;
    private Func<T> _getItemFunc;
    private DateTime _expiresTime;
    public TimeExpirationItem(TimeSpan expirationDuration, Func<T, T> getItemFunc)
    {
        this._getItemFunc = getItemFunc;
        this._expirationDuration = expirationDuration;
    }
    public T Item
    {
        get
        {
            if (_item == null || ItemIsExpired())
            {
                _item = _getItemFunc(_item);
                _expiresTime = DateTime.Now.Add(_expirationDuration);
            }
            return _item;
        }
    }
    public bool ItemIsExpired()
    {
        return DateTime.Now > _expiresTime;
    }
} 
```

同样，此代码按原样提供，不提供任何保证，并且未经测试，但它是您可以做的事情的一个示例。

使用它将类似于以下内容：

`Session.Add("ObjectKey",new TimeExpirationItem<MyObject>(new TimeSpan(0,0,5),mo=>MyObjectRepository.GetItemByLogin(Request.User.Identity.Name));`

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-03-13T12:41:00.163

那是对的。会话状态没有过期概念。

如果您的数据不是每个用户的，您可以改用缓存。您甚至可以使用缓存，但将用户名作为密钥的一部分包含在内，这会给您一个即将到期的会话状态。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-13T12:56:32.670

我倾向于同意 TheTXI。

尽管不能为单个 Session 项分配自定义超时，但您应该注意，在 InProc 会话模式下，Sessionstate 本身作为一项添加到 ASP.NET 缓存中。这使它有一个“超时”。

在您的特定场景中，缓存对象是最适合的解决方案。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2011-04-01T10:43:58.530

很抱歉重新提出一个老问题，但我遇到了完全相同的问题，不得不为 HttpSession 对象创建一个扩展类。

[这是我的博客文章](http://blog.jitbit.com/2011/04/aspnet-session-caching-expiring-values.html)

PS。编码：

```
public static class SessionExtender
{
    public static void AddWithTimeout(this HttpSessionState session,
        string name,
        object value,
        TimeSpan expireAfter)
    {
        session[name] = value;
        session[name + "ExpDate"] = DateTime.Now.Add(expireAfter);
    }

    public static object GetWithTimeout(
        this HttpSessionState session,
        string name)
    {
        object value = session[name];
        if (value == null) return null;

        DateTime? expDate = session[name + "ExpDate"] as DateTime?;
        if (expDate == null) return null;

        if (expDate < DateTime.Now)
        {
            session.Remove(name);
            session.Remove(name + "ExpDate");
            return null;
        }

        return value;
    }
} 
```

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2009-03-13T12:44:53.277

1）把它放在web.config

```
<configuration>
   <system.web>
     <sessionState mode="InProc" timeout="5">
     </sessionState>
   </system.web> 
</configuration> 
```

2) 设置 System.Web.SessionState.HttpSessionState.Timeout = 5 分钟。

# database - 字段的数据类型

> ID：642493
> 
> 赞同：1
> 
> 时间：2009-03-13T12:42:13.733
> 
> 标签：database, database-design, datetime, types, nvarchar

我在表中有一个字段，我将在其中存储不同类型的数据，例如：X-Large、Medium、Small....或者我可能存储：2009 年 3 月 22 日、1 年、2 年、3年...或 06 个月、12 个月、1 年，或者我可能会存储：“33-36”、“37-40”...并且该数据不固定，我将来可能需要添加新类别。 ..

数据类型的明显选择是 nvarchar(length)，但还有其他建议吗？有没有办法解决这个问题？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-13T12:47:33.237

听起来您正在尝试存储“大小”。也许您需要一个“大小”表，其中包含这些值（X-Large、Medium、Small、1 Year 等）和另一个表中的 ID 字段。

为什么你还想在同一个字段中存储一个日期让我有点困惑。你确定你不应该有两个不同的领域吗？

**ETA：** 根据您的评论，我建议创建几个额外的表：

SizeType - 定义您正在使用的“尺寸”类型（例如童装、童鞋、男鞋、女鞋、男衬衫、男裤、女衬衫、女裤等）。将有两列 - 一个 ID 和一个描述。

尺码 - 定义个人尺码（例如“尺码 5”、XL、33-34、0-6 个月等）。将有三列 - 和 ID、描述以及来自 SizeType 的相应 SizeType id。

现在在您的产品表上，您将输入尺码表中的 ID。这为您在添加新尺寸、确定哪种尺寸与哪种类型的产品搭配等方面提供了一些灵活性。您也可以进一步分解它以使设计更好，但我不想在这里使事情过于复杂.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-13T12:46:53.177

不管你做什么，这样的数据库设计都不好看。

不过，您可以使用 BLOB 数据类型将任何数据存储在列中，或者如果它是文本则使用 Text 类型（这样搜索会更好，理解大小写等）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-13T12:45:19.623

nvarchar(max) 会起作用。否则，您可能有多个列，每种可能的类型之一。这将使您无法将诸如双精度数字之类的内容转换为字符串并返回。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-13T12:46:16.190

*   nvarchar(max) 如果数据被限制为小于 2Gb 的字符串。
*   ntext 如果您需要允许超过 2Gb 的字符串。
*   如果您需要存储二进制数据，请使用二进制或图像。

# c# - 不集中时如何保持WPF文本框选择？

> ID：642498
> 
> 赞同：24
> 
> 时间：2009-03-13T12:43:48.113
> 
> 标签：c#, wpf, textbox

我想在 WPF 文本框中显示一个选择，即使它不在焦点上。我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2009-03-13T14:53:32.670

我已将此解决方案用于 RichTextBox，但我认为它也适用于标准文本框。基本上，您需要处理 LostFocus 事件并将其标记为已处理。

```
 protected void MyTextBox_LostFocus(object sender, RoutedEventArgs e)
  {    
     // When the RichTextBox loses focus the user can no longer see the selection.
     // This is a hack to make the RichTextBox think it did not lose focus.
     e.Handled = true;
  } 
```

TextBox 不会意识到它失去了焦点，仍然会显示突出显示的选择。

在这种情况下，我没有使用数据绑定，因此这可能会弄乱双向绑定。您可能必须在 LostFocus 事件处理程序中强制绑定。像这样的东西：

```
 Binding binding = BindingOperations.GetBinding(this, TextProperty);
     if (binding.UpdateSourceTrigger == UpdateSourceTrigger.Default ||
         binding.UpdateSourceTrigger == UpdateSourceTrigger.LostFocus)
     {
        BindingOperations.GetBindingExpression(this, TextProperty).UpdateSource();
     } 
```

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2010-08-21T16:10:01.853

另一种选择是在 XAML 中定义一个单独的焦点范围，以维护第一个 TextBox 中的选择。

```
<Grid>
  <Grid.RowDefinitions>
    <RowDefinition/>
    <RowDefinition/>
  </Grid.RowDefinitions>

  <TextBox Grid.Row="0" Text="Text that does not loose selection."/>
  <StackPanel Grid.Row="1" FocusManager.IsFocusScope="True">
    <TextBox Text="Some more text here." />
    <Button  Content="Run" />
    <Button Content="Review" />
  </StackPanel>
</Grid> 
```

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2018-05-07T14:12:04.933

[TextBoxBase.IsInactiveSelectionHighlightEnabled](https://msdn.microsoft.com/en-us/library/system.windows.controls.primitives.textboxbase.isinactiveselectionhighlightenabled(v=vs.110).aspx)属性自 .NET Framework 4.5 起可用

```
public bool IsInactiveSelectionHighlightEnabled { get; set; } 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2011-06-18T16:33:52.873

```
public class CustomRichTextBox : RichTextBox
{
     protected override void OnLostFocus(RoutedEventArgs e)
     {

     }
} 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-05-21T14:26:34.097

我发现列出的建议（添加 LostFocus 处理程序，定义 FocusScope）不起作用，但我确实遇到了此处列出的代码：http: [//naracea.com/2011/06/26/selection-highlight-and- focus-on-wpf-textbox/](http://naracea.com/2011/06/26/selection-highlight-and-focus-on-wpf-textbox/)，它创建一个自定义的装饰器，在没有聚焦时突出显示文本。

# algorithm - 在滑动窗口中查找字符串匹配的算法

> ID：642507
> 
> 赞同：3
> 
> 时间：2009-03-13T12:45:19.233
> 
> 标签：algorithm, compression, zip, gzip

ZIP 等文件压缩的​​核心步骤之一是使用先前解码的文本作为参考源。例如，编码流可能会说“接下来的 219 个输出字符与 5161 字节前解码流中的字符相同”。这使您可以仅用 3 个字节左右来表示 219 个字符。（ZIP 不仅如此，比如霍夫曼压缩，但我只是在谈论参考匹配。）

我的问题是字符串匹配算法的策略是什么。即使查看来自 zlib 的源代码等似乎也不能很好地描述压缩匹配算法。

问题可以表述为：给定一个文本块，比如 30K 和一个输入字符串，在 30K 文本中找到与输入字符串前面完全匹配的**最长**引用。” 算法在迭代时必须高效，即，将通过从前面删除一些字节并在后面添加新字节并执行新匹配来更新 30K 文本块。

我对讨论执行此操作的算法更感兴趣，**而不是**源代码或库。（zlib 有很好的来源！）我怀疑可能有几种不同的权衡方法。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-22T01:24:21.973

好吧，我注意到您详细介绍了该问题，但没有提及[RFC 1951](https://www.rfc-editor.org/rfc/rfc1951 "RFC 1951")（DEFLATE 压缩数据格式的规范，即 ZIP 中使用的格式）第 4 节中提供的信息，这使我相信您可能错过了这个资源。

他们的基本方法是使用三字节序列作为键的链式哈希表。只要链不为空，就会扫描它的所有条目，以 a) 消除错误冲突，b) 消除太旧的匹配，以及 c) 从剩余的匹配中挑选最长的匹配。

（请注意，他们的建议是由专利因素决定的；可能是他们知道一种更有效的技术，但不能确定它是否不在某人的专利范围内。就个人而言，我一直想知道为什么一个人不能通过检查从传入数据的第二个字节、第三个字节等开始的三字节序列的匹配项，并清除不匹配的匹配项，找到最长的匹配项。即，如果您的传入数据是“ ABCDEFG...”，并且您在偏移量 100、302 和 416 处获得了“ABC”的哈希匹配，但“BCD”的唯一哈希匹配位于偏移量 301，您知道除非您有两个完全巧合的重叠哈希匹配 - - 不太可能 - 那么 302 是你最长的匹配。）

还要注意他们对可选“惰性匹配”的建议（具有讽刺意味的是，它做了更多的工作）：压缩器不会自动获取从传入数据的第一个字节开始的最长匹配，而是从下一个字节开始检查更长的匹配。如果您的传入数据是“ABCDE ...”并且您在滑动窗口中的唯一匹配项是“ABC”和“BCDE”，那么您最好将“A”编码为文字字节，将“BCDE”编码为一场比赛。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-13T12:50:01.423

我认为您正在描述[Longest Common Substring Problem](http://en.wikipedia.org/wiki/Longest_common_substring_problem)的修改版本。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-13T14:05:18.510

您可以查看[7-zip](http://www.7-zip.org/)使用的[LZMA 算法](http://en.wikipedia.org/wiki/LZMA)的详细信息。7-zip 作者声称改进了 zlib 等人使用的算法。

# c# - 授权 Asp.net web.config

> ID：642515
> 
> 赞同：12
> 
> 时间：2009-03-13T12:46:59.980
> 
> 标签：c#, asp.net, security, web-config, roles

我有一个有后台的应用程序。这个后台是通过使用这样的角色来隔离的：

```
<location path="backoffice">
    <system.web>
        <authorization>
            <allow roles="admin"/>
            <deny users="*"/>
        </authorization>
    </system.web>
</location> 
```

但是现在我们有另一种需要访问的角色。公司管理员角色。

我可以说吗？：

```
 <location path="backoffice">
        <system.web>
            <authorization>
                <allow roles="admin,companyadmin"/>
                <deny users="*"/>
            </authorization>
        </system.web>
    </location> 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-03-13T12:51:44.290

是的，正是如此（假设您正确验证了您的用户，并相应地设置了他们的角色）。

查看 MSDN 文章：[https://docs.microsoft.com/en-us/previous-versions/dotnet/netframework-1.1/8d82143t(v=vs.71)](https://docs.microsoft.com/en-us/previous-versions/dotnet/netframework-1.1/8d82143t(v=vs.71))

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-03-13T12:48:14.967

是的，您可以添加 n 个这样的角色。

如果您愿意，您还可以：

```
<allow roles="admin"/>
<allow roles="admin1"/>
<deny users="*"/> 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-03-13T12:52:33.880

是的，角色、用户和动词采用逗号分隔值。

[MSDN 参考](http://msdn.microsoft.com/en-us/library/acsd09b0(VS.80).aspx)

# .net - 是否有第 3 方 .NET 库/程序集可以使用元数据驱动的方法解析和导入文件？

> ID：642521
> 
> 赞同：0
> 
> 时间：2009-03-13T12:48:00.537
> 
> 标签：.net, metadata, data-importer, file-processing

我需要解析一堆分隔的平面文件并将它们导入数据库。我可以构建自己的简单元数据驱动的解析器和导入器，但我认为肯定已经有类似的东西了？

谢谢，戴夫。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-13T12:53:30.930

您是否研究过 SQL Server 集成服务 (SSIS)？它将执行此操作，以及解析平面文件后经常需要的各种清理或其他操作。

# svn - 如何将文件添加到谷歌代码上的项目？

> ID：642529
> 
> 赞同：6
> 
> 时间：2009-03-13T12:49:44.903
> 
> 标签：svn, project-management, google-code

我通常将我的项目组织在多个文件中。现在，我第一次在 code.google.com/hosting 创建了一个项目。

如何将文件添加到项目中？

该项目具有目录结构和许多文件。我希望它们在**主干**下可见（就像在其他项目中一样）。

注意：我是这方面的新手（我不知道该怎么做）。我正在寻找一个上传按钮。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-03-13T12:53:36.687

您需要有一个源代码管理系统才能做到这一点。谷歌代码通常使用颠覆。下载命令行版本或像[TortoiseSVN](http://tortoisesvn.tigris.org/)这样的 GUI 包装器。然后，您可以上传所有项目文件。

*   [入门](http://code.google.com/p/support/wiki/GettingStarted)
*   [项目托管常见问题](http://code.google.com/p/support/wiki/FAQ)
*   [谷歌代码博客](http://google-opensource.blogspot.com/search/label/project%20hosting)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-13T12:54:38.510

Google Code 使用 Subversion 进行源代码控制：

[http://code.google.com/p/support/wiki/GettingStarted#Working_with_your_Source_Repository_on_the_Source_Tab](http://code.google.com/p/support/wiki/GettingStarted#Working_with_your_Source_Repository_on_the_Source_Tab)

# wpf - WPF - 页面函数。为什么需要它们？

> ID：642531
> 
> 赞同：4
> 
> 时间：2009-03-13T12:50:27.287
> 
> 标签：wpf, pagefunction

我已经涉足 WPF 几个月了，我已经设法掌握了大部分内容以及使用它的原因/时间，但我仍在努力了解 PageFunction 类的价值。

有人可以给我一个简单但具体的例子，说明 PageFunction 何时可能是该工作的正确工具？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-13T13:01:52.610

PageFunction in a page = 桌面应用程序中的对话框（无 Page）。

每次在桌面应用程序中使用对话框并且想要为程序开发类似网络导航的行为时，都可以使用 PageFunction。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-03-13T13:03:22.530

主要是，它似乎是一种在基于任务的 UI 中形式化分支的模式。

假设您有一个带有可选功能复选标记的表单，但此功能需要额外的信息，这些信息太复杂而无法放在同一页面上。使用此模式允许将信息收集委托给另一个组件。

此外，还应用了一种策略模式，因为您可以让各种子系统能够收集相同的信息，所有子系统都继承了 PageFunction(of T)，因此实际调用它们的代码不需要知道任何细节它。

这些只是一些想法，我没有仔细研究过。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-10-09T13:41:03.423

页面功能启用的主要功能是使用子任务实现工作流并管理返回堆栈。

如果你只是依赖页面到页面的导航，很难暂停当前的导航路径，做其他事情，然后再回来继续。PageFunctions 通过返回和展开导航堆栈的概念来实现这一点。

我在这里提供了一些真实的例子：http: [//www.paulstovell.com/wpf-navigation](http://www.paulstovell.com/wpf-navigation)

# java - 在不使用 getDeclaredMethod 的情况下接收 Java 方法

> ID：642532
> 
> 赞同：2
> 
> 时间：2009-03-13T12:50:42.123
> 
> 标签：java, reflection, initialization

我希望在子类中初始化一个java方法数组，像这样**的类字段**

```
void callme() {System.out.println("hi!");}
Method[] actions = new Method[] {&callme,&callme}; 
```

并在父类中调用此数组中的所有方法，如下所示：

```
for (meth:actions) {meth.invoke();} 
```

但是目前我找不到隐式初始化动作数组的方法，而不是通过构造函数。由于未处理的异常，以下给了我一个错误：

```
Method[] actions = new Method[] {
    this.getClass().getDeclaredMethod("count")
}; 
```

如前所述，当将此数组显式初始化为字段而不是在构造函数中时，我无法捕获异常。

我是 java 反射的新手，所以这可能是一个显而易见的问题，但我仍然在谷歌找不到答案，任何帮助将不胜感激。

谢谢

附言

正如下面的斯科特猜测的那样，我“想要一个超类来调用子类中定义的一组特定方法”。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-13T12:58:01.637

你确定反思是正确的做法吗？通常，具有多个实现它的匿名类的接口会更好。

您可以编写一个初始化程序块，以便能够在初始化期间捕获异常。

为什么不使用 getMethod()？

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-13T13:28:03.873

[注意：下面的代码尚未编译，但应该可以理解]

我应该回应——你想要完成什么？

如果您希望超类调用子类中定义的一组特定方法，您可以做一些事情。

**使用反射**，我建议使用注释：

1）定义一个注解HeySuperclassCallMe（确保保留是RUNTIME）

2) 用 HeySuperclassCallMe 注释要调用的方法

```
@HeySuperclassCallMe public void foo... 
```

3）在你的超类中做类似的事情

```
for (Method m : getClass().getMethods())
  if (m.getAnnotation(HeySuperclassCallMe.class) != null)
     m.invoke(...) 
```

这是一个很好的反思手段。

对于**非反射**（应该更快一点，但更多的代码）：

1) 定义一个代表调用的接口

```
 public interface Call {
     void go();
 } 
```

2）在你的超类中，定义一个

```
 private List<Call> calls
 protected void addCall(Call call) 
```

3）在子类中，使用addCall：

```
 addCall(new Call() {public void go() {foo();}} ); 
```

4）在超类中

```
 for (Call call : calls)
    call.go(); 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-13T12:57:36.490

查看[Apache Commons - Beanutils](http://commons.apache.org/beanutils/)！它就像所有反射的包装器，非常易于使用。它包装了方法调用、修改属性、查找...

如果你想为 Java 引入动态，你应该看看动态 JVM 语言，它可以通过简单的 .jar 库来使用！其中之一是[Groovy](http://groovy.codehaus.org/)，它包含 java 语法并引入了许多动态功能（脚本、快速原型设计、元对象协议、运行时方法替换、动态代理......）。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-13T12:58:46.533

只要您的方法确实在 this.getClass() 中声明，这应该可以工作。如果它是继承的，你应该使用 Class.getMethod() 代替。

但是，不是使用函数指针，而是在 java 中定义一个带有要调用的方法的接口，并让该接口由目标对象实现。

还可以考虑使用 ArrayList 或其他集合类而不是数组。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-13T13:32:54.300

我可以从你的 & 号看出你在用 C 语言思考。我们并没有真正使用指向 java 函数的指针。

通常，您不会为此使用 java 反射。正如其他海报之一所说 - 您将创建一个接口，并拥有实现该接口的对象 - 通过直接实现它，或者使用适配器或匿名类：

```
interface Callable { void callme(); }

Callable[] foo = new Callable[] {
  new Callable() { public void callme() {System.out.println("foo!");}},
  new Callable() { public void callme() {System.out.println("bar!");}}
};

for(Callable c: foo) {
  c.callme();
} 
```

* * *

## 回答 #6

> 赞同：-2
> 
> 时间：2009-03-13T12:58:23.447

在您的类中创建一个静态方法，该方法将返回一组声明的方法并正确处理异常。

```
private static Method[] declaredMethods(Class<T> clazz, String methodName) {
  Method[] result = new Method[1];
  try{
    result[0] = clazz.getDeclaredMethod(methodName);
  } catch (NoSuchMethodException nsme) {
    // respond to the error
  } catch (SecurityException se)  {
    // Respond to the error
  }

  return result;
}

Method[] actions = declaredMethods("count"); 
```

# c++ - 如何避免在 C++ 中意外地重新声明全局常量？

> ID：642539
> 
> 赞同：4
> 
> 时间：2009-03-13T12:52:24.567
> 
> 标签：c++, global-variables, constants

我在名为“Matrix.h”的标头中定义了一个模板矩阵类类。

在我的程序中重复使用某些矩阵。我以为我会在“Matrix.h”头文件中定义这些，如下所示：

```
const Matrix<GLfloat> B_SPLINE_TO_BEZIER_MATRIX(4, 4, values); 
```

当我这样做时，g++ 抱怨我重新定义了有问题的常量。发生这种情况是因为我将 Matrix.h 包含在两个不同的源文件中。编译这些的目标文件时，两者都以上述矩阵的定义结束，从而导致错误消息。

我的问题是如何避免这种情况？我想要一个可以被多个文件访问的常量，但我不知道把它放在哪里。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-03-13T12:55:40.113

您可以通过以下方式避免它：

*   `extern`在标题中声明它。一个符号可以被声明任意次数。
*   在实现中定义它，只有一次。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-03-13T12:56:02.767

如果您不想在头文件和实现文件之间拆分它，

1.  声明您的常量`static`（或在匿名命名空间中声明）以使定义私有。链接器不会抱怨，但它会导致跨编译单元的多个私有副本。

    ```
    static Matrix<GLfloat> B_SPLINE_TO_BEZIER_MATRIX(4, 4, values); 
    ```

2.  创建一个返回常量的内联函数。内联函数定义在目标文件中产生“弱”符号，因此链接器将消除重复并选择一个。

    ```
    inline const Matrix<GLfloat>&
    GET_B_SPLINE_TO_BEZIER_MATRIX() {
        const static Matrix<GLfloat> B_SPLINE_TO_BEZIER_MATRIX(4, 4, values);
        return B_SPLINE_TO_BEZIER_MATRIX;
    } 
    ```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-13T12:58:28.093

像这样写你的头文件

#ifndef HEADER_FILE_NAME_H

#define HEADER_FILE_NAME_H

// 你的头文件代码

＃万一

这将确保它不会被多次声明

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-13T13:02:03.827

在预处理器条件中包装头文件 (.h) 以防止它们被两次包含在编译器的符号表中：

```
#ifndef HEADER_NAME
#define HEADER_NAME
// code...
#endif//HEADER_NAME 
```

HEADER_NAME 实际上可以是任何东西，但最好确保它与文件相关以防止更多冲突，因为这只是定义一个空的预处理器宏（也最终在符号表中）。

# c# - 如何在 C# 中获取下一个（或上一个）枚举值

> ID：642542
> 
> 赞同：66
> 
> 时间：2009-03-13T12:52:59.310
> 
> 标签：c#, .net, enums

我有一个这样定义的枚举：

```
public enum eRat { A = 0, B=3, C=5, D=8 }; 
```

所以给定价值`eRat.B`，我想得到下一个`eRat.C`

我看到的解决方案是（没有范围检查）

```
Array a = Enum.GetValues(typeof(eRat));
int i=0 ;
for (i = 0; i < a.GetLength(); i++)
{
       if (a.GetValue(i) == eRat.B)
            break;
}
return (eRat)a.GetValue(i+1): 
```

现在这太复杂了，对于这么简单的事情。你知道更好的解决方案吗？？像`eRat.B+1`or的东西`Enum.Next(Erat.B)`？

谢谢

* * *

## 回答 #1

> 赞同：93
> 
> 时间：2009-03-13T16:08:23.537

感谢大家的回答和反馈。我很惊讶得到这么多。看着它们并使用一些想法，我想出了这个解决方案，它最适合我：

```
public static class Extensions
{

    public static T Next<T>(this T src) where T : struct
    {
        if (!typeof(T).IsEnum) throw new ArgumentException(String.Format("Argument {0} is not an Enum", typeof(T).FullName));

        T[] Arr = (T[])Enum.GetValues(src.GetType());
        int j = Array.IndexOf<T>(Arr, src) + 1;
        return (Arr.Length==j) ? Arr[0] : Arr[j];            
    }
} 
```

这种方法的美妙之处在于它使用简单且通用。作为通用扩展方法实现，您可以通过以下方式在任何枚举上调用它：

```
return eRat.B.Next(); 
```

请注意，我使用的是通用扩展方法，因此我不需要在调用时指定类型，只需`.Next()`.

* * *

## 回答 #2

> 赞同：37
> 
> 时间：2009-03-13T13:11:15.647

可能有点矫枉过正，但是：

```
eRat value = eRat.B;
eRat nextValue = Enum.GetValues(typeof(eRat)).Cast<eRat>()
        .SkipWhile(e => e != value).Skip(1).First(); 
```

或者如果你想要第一个数字更大的：

```
eRat nextValue = Enum.GetValues(typeof(eRat)).Cast<eRat>()
        .First(e => (int)e > (int)value); 
```

或下一个更大的数字（自己进行排序）：

```
eRat nextValue = Enum.GetValues(typeof(eRat)).Cast<eRat>()
        .Where(e => (int)e > (int)value).OrderBy(e => e).First(); 
```

嘿，用 LINQ 作为你的锤子，世界上到处都是钉子；-p

* * *

## 回答 #3

> 赞同：19
> 
> 时间：2009-03-13T13:27:46.043

你*真的*需要概括这个问题吗？你可以这样做吗？

```
public void SomeMethod(MyEnum myEnum)
{
    MyEnum? nextMyEnum = myEnum.Next();

    if (nextMyEnum.HasValue)
    {
        ...
    }
}

public static MyEnum? Next(this MyEnum myEnum)
{
    switch (myEnum)
    {
        case MyEnum.A:
            return MyEnum.B;
        case MyEnum.B:
            return MyEnum.C;
        case MyEnum.C:
            return MyEnum.D;
        default:
            return null;
    }
} 
```

* * *

## 回答 #4

> 赞同：12
> 
> 时间：2009-03-13T13:08:31.923

工作到“C”，因为没有关于“D”之后返回什么的答案。

**[update1]**：根据 Marc Gravell 的建议更新。

**[update2]**：根据 husayt 的要求进行更新 - 返回“A”作为“D”的下一个值。

```
public class Program
{
    public static void Main(string[] args)
    {
        Console.WriteLine("Next enum of A = {0}", eRatEnumHelper.GetNextEnumValueOf(eRat.A));
        Console.WriteLine("Next enum of B = {0}", eRatEnumHelper.GetNextEnumValueOf(eRat.B));
        Console.WriteLine("Next enum of C = {0}", eRatEnumHelper.GetNextEnumValueOf(eRat.C));
    }
}

public enum eRat { A = 0, B = 3, C = 5, D = 8 };

public class eRatEnumHelper
{
    public static eRat GetNextEnumValueOf(eRat value)
    {
        return (from eRat val in Enum.GetValues(typeof (eRat)) 
                where val > value 
                orderby val 
                select val).DefaultIfEmpty().First();
    }
} 
```

**结果**

> A = B 的
> 下一个枚举 B = C
> 的下一个枚举 C = D
> 的下一个枚举 D = A 的下一个枚举

* * *

## 回答 #5

> 赞同：12
> 
> 时间：2009-03-13T13:39:58.417

你正在处理的问题是因为你试图让一个枚举做它不应该做的事情。它们应该是类型安全的。允许将整数值分配给枚举，以便您可以组合它们，但如果您希望它们表示整数值，请使用类或结构。这是一个可能的替代方案：

```
public static class eRat
{
    public static readonly eRatValue A;
    public static readonly eRatValue B;
    public static readonly eRatValue C;
    public static readonly eRatValue D;

    static eRat()
    {
        D = new eRatValue(8, null);
        C = new eRatValue(5, D);
        B = new eRatValue(3, C);
        A = new eRatValue(0, B);
    }

    #region Nested type: ERatValue
    public class eRatValue
    {
        private readonly eRatValue next;
        private readonly int value;

        public eRatValue(int value, eRatValue next)
        {
            this.value = value;
            this.next = next;
        }

        public int Value
        {
            get { return value; }
        }

        public eRatValue Next
        {
            get { return next; }
        }

        public static implicit operator int(eRatValue eRatValue)
        {
            return eRatValue.Value;
        }
    }
    #endregion
} 
```

这使您可以这样做：

```
int something = eRat.A + eRat.B; 
```

还有这个

```
eRat.eRatValue current = eRat.A;
while (current != null)
{
    Console.WriteLine(current.Value);
    current = current.Next;
} 
```

当您可以从类型安全中受益时，您真的应该只使用枚举。如果您依赖它们来表示一种类型，请切换到常量或类。

**编辑**

我建议您查看有关[枚举设计](http://msdn.microsoft.com/en-us/library/ms229058.aspx)的 MSDN 页面。第一个最佳实践是：

> 务必使用枚举来强类型化参数、属性和表示值集的返回值。

我尽量不争论教条，所以我不会，但这是你将要面对的问题。Microsoft 不希望你做你想做的事。他们明确要求你不要做你想做的事。这让你很难做你想做的事。为了完成您想要做的事情，您必须构建实用程序代码以强制它看起来可以工作。

您不止一次称您的解决方案*优雅，如果枚举以不同的方式设计，可能是这样，但由于枚举就是它们，您的解决方案并不优雅。*我认为室内乐是优雅的，但如果音乐家没有合适的乐器，不得不用锯片和水壶演奏维瓦尔第，无论他们作为音乐家的能力如何，音乐有多好，它都不再优雅在纸上。

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2019-07-13T23:46:16.017

谢谢大家，您的灵感和解决方案。

这是我的结果，作为扩展。

```
using System; 
using System.Linq;

public static class Enums
{
    public static T Next<T>(this T v) where T : struct
    {
        return Enum.GetValues(v.GetType()).Cast<T>().Concat(new[] { default(T) }).SkipWhile(e => !v.Equals(e)).Skip(1).First();
    }

    public static T Previous<T>(this T v) where T : struct
    {
        return Enum.GetValues(v.GetType()).Cast<T>().Concat(new[] { default(T) }).Reverse().SkipWhile(e => !v.Equals(e)).Skip(1).First();
    }
} 
```

采用：

```
using System; 
using System.Linq;

public enum Test { F1, F2, F3 }

public class Program
{
    public static void Main()
    {
        Test t = Test.F3;   

        Console.WriteLine(t);
        Console.WriteLine(t.Next());
        Console.WriteLine(t.Previous());

        Console.WriteLine("\n");

        t = Test.F1;    
        Console.WriteLine(t);
        Console.WriteLine(t.Next());
        Console.WriteLine(t.Previous());
    }
} 
```

结果：

```
F3
F1
F2

F1
F2
F3 
```

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2009-03-13T13:40:55.137

您是否因无法控制的事情而使用枚举？

如果你不是，我建议使用替代方案，可能`Dictionary<string, int> rat;`

如果您创建一个`Dictionary`并用您的数据填充它，那么枚举它会更简单一些。此外，它是更清晰的意图映射——您正在使用此枚举将数字映射到字符串，并且您正在尝试利用该映射。

如果您必须使用枚举，我建议您使用其他方法：

```
var rats = new List<eRat>() {eRat.A, eRat.B, eRat.C, eRat.D}; 
```

只要您按顺序添加值并使其保持同步，就可以大大简化检索下一个 eRat 的操作。

* * *

## 回答 #8

> 赞同：4
> 
> 时间：2009-03-13T13:54:15.433

从您的描述来看，您并不真正**想要**枚举。您正在将枚举扩展到其功能之外。为什么不创建一个自定义类，将您需要的值作为属性公开，同时将它们保存在 OrderedDictionary 中。然后获得下一个/上一个将是微不足道的。 - 更新

如果您想根据上下文对集合进行不同的枚举，请将该明确的部分作为您的设计。将项目封装在一个类中，并且每个返回 IEnumerable 的方法很少，其中 T 是您想要的类型。

例如

```
IEnumerable<Foo> GetFoosByBar()
IEnumerable<Foo> GetFoosByBaz() 
```

ETC...

* * *

## 回答 #9

> 赞同：4
> 
> 时间：2009-03-13T14:15:01.093

对于简单的解决方案，您可能只是从枚举中提取数组。

```
eRat[] list = (eRat[])Enum.GetValues(typeof(eRat)); 
```

然后你可以枚举

```
foreach (eRat item in list)
    //Do something 
```

或查找下一项

```
int index = Array.IndexOf<eRat>(list, eRat.B);
eRat nextItem = list[index + 1]; 
```

存储数组比每次需要下一个值时从枚举中提取要好。

但是，如果您想要更漂亮的解决方案，请创建类。

```
public class EnumEnumerator<T> : IEnumerator<T>, IEnumerable<T> {
    int _index;
    T[] _list;

    public EnumEnumerator() {
        if (!typeof(T).IsEnum)
            throw new NotSupportedException();
        _list = (T[])Enum.GetValues(typeof(T));
    }
    public T Current {
        get { return _list[_index]; }
    }
    public bool MoveNext() {
        if (_index + 1 >= _list.Length)
            return false;
        _index++;
        return true;
    }
    public bool MovePrevious() {
        if (_index <= 0)
            return false;
        _index--;
        return true;
    }
    public bool Seek(T item) {
        int i = Array.IndexOf<T>(_list, item);
        if (i >= 0) {
            _index = i;
            return true;
        } else
            return false;
    }
    public void Reset() {
        _index = 0;
    }
    public IEnumerator<T> GetEnumerator() {
        return ((IEnumerable<T>)_list).GetEnumerator();
    }
    void IDisposable.Dispose() { }
    object System.Collections.IEnumerator.Current {
        get { return Current; }
    }
    System.Collections.IEnumerator System.Collections.IEnumerable.GetEnumerator() {
        return _list.GetEnumerator();
    }
} 
```

实例化

```
var eRatEnum = new EnumEnumerator<eRat>(); 
```

迭代

```
foreach (eRat item in eRatEnum)
    //Do something 
```

移动下一个

```
eRatEnum.Seek(eRat.B);
eRatEnum.MoveNext();
eRat nextItem = eRatEnum.Current; 
```

* * *

## 回答 #10

> 赞同：3
> 
> 时间：2009-03-13T13:11:33.943

您可以对其进行简化并对其进行概括：

```
static Enum GetNextValue(Enum e){
    Array all = Enum.GetValues(e.GetType());
    int i = Array.IndexOf(all, e);
    if(i < 0)
        throw new InvalidEnumArgumentException();
    if(i == all.Length - 1)
        throw new ArgumentException("No more values", "e");
    return (Enum)all.GetValue(i + 1);
} 
```

**编辑**：请注意，如果您的枚举包含重复值（同义条目），那么在给定其中一个值的情况下，此（*或此处列出的任何其他技术*）将失败。例如：

```
enum BRUSHSTYLE{
    SOLID         = 0,
    HOLLOW        = 1,
    NULL          = 1,
    HATCHED       = 2,
    PATTERN       = 3,
    DIBPATTERN    = 5,
    DIBPATTERNPT  = 6,
    PATTERN8X8    = 7,
    DIBPATTERN8X8 = 8
} 
```

给定`BRUSHSTYLE.NULL`或`BRUSHSTYLE.HOLLOW`，返回值将是`BRUSHSTYLE.HOLLOW`。

<leppie>

> 更新：泛型版本：
> 
> ```
> static T GetNextValue<T>(T e)
> {
>   T[] all = (T[]) Enum.GetValues(typeof(T));
>   int i = Array.IndexOf(all, e);
>   if (i < 0)
>     throw new InvalidEnumArgumentException();
>   if (i == all.Length - 1)
>     throw new ArgumentException("No more values", "e");
>   return all[i + 1];
> } 
> ```

</leppie>

**@leppie**：

您的通用版本允许您意外传递一个非枚举值，该值仅在运行时被捕获。我最初将它写为泛型，但是当编译器拒绝时`where T : Enum`，我将其取出并意识到无论如何我并没有从泛型中获得太多收益。唯一真正的缺点是您必须将结果转换回您的特定枚举类型。

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2011-06-17T16:49:54.457

希望我的这部分代码对您有所帮助：

```
public enum EGroupedBy
{
    Type,
    InterfaceAndType,
    Alpha,
    _max
}

private void _btnViewUnit_Click(object sender, EventArgs e)
{
    int i = (int)GroupedBy;

    i = (i + 1) % (int)EGroupedBy._max;

    GroupedBy = (EGroupedBy) i;

    RefreshUnit();
} 
```

* * *

## 回答 #12

> 赞同：2
> 
> 时间：2014-10-15T19:01:26.727

旧帖子，但我有一个替代解决方案

```
//Next with looping    
public static Enum Next(this Enum input)
{
    Array Arr = Enum.GetValues(input.GetType());
    int j = Array.IndexOf(Arr, input) + 1;
    return (Arr.Length == j) ? (Enum)Arr.GetValue(0) : (Enum)Arr.GetValue(j);
}

//Previous with looping
public static Enum Prev(this Enum input)
{
   Array Arr = Enum.GetValues(input.GetType());
   int j = Array.IndexOf(Arr, input) - 1;
   return (j == -1) ? (Enum)Arr.GetValue(Arr.Length -1) : (Enum)Arr.GetValue(j);
} 
```

当你需要使用它时，只需做一个演员表

```
BootstrapThemeEnum theme = BootstrapThemeEnum.Info;
var next = (BootstrapThemeEnum)theme.Next(); 
```

我的枚举

```
public enum BootstrapThemeEnum
{
    [Description("white")]
    White = 0,
    [Description("default")]
    Default = 1,
    [Description("info")]
    Info = 2,
    [Description("primary")]
    Primary = 3,
    [Description("success")]
    Success = 4,
    [Description("warning")]
    Warning = 5,
    [Description("danger")]
    Danger = 6,
    [Description("inverse")]
    Inverse = 7

} 
```

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2009-03-13T12:59:32.570

我能想到两件事：

*   大鼠.B+3
*   Enum.Parse(typeof(((int)eRat.B)+3)

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2009-03-13T13:01:50.707

var next = (eRat)((int)someRat + 3);

* * *

## 回答 #15

> 赞同：1
> 
> 时间：2009-03-13T14:06:16.980

对我来说，这似乎是对 enum 类的滥用——但这会做到（假设在最后一个值上调用 Next 会导致回绕）：

```
public static eRat Next(this eRat target)
{
    var nextValueQuery = Enum.GetValues(typeof(eRat)).Cast<eRat>().SkipWhile(e => e != target).Skip(1);
    if (nextValueQuery.Count() != 0)
    {
        return (eRat)nextValueQuery.First();
    }
    else
    {
        return eRat.A;
    }
} 
```

这将在相同的基础上为您提供先前的值：

```
public static eRat Previous(this eRat target)
{
    var nextValueQuery = Enum.GetValues(typeof(eRat)).Cast<eRat>().Reverse().SkipWhile(e => e != target).Skip(1);
    if (nextValueQuery.Count() != 0)
    {
        return (eRat)nextValueQuery.First();
    }
    else
    {
        return eRat.D;
    }
} 
```

* * *

## 回答 #16

> 赞同：1
> 
> 时间：2013-07-15T09:32:30.857

我正在使用这个，非常适合我的。

```
 //===================================================================================
// NEXT VALUE IN ENUM 
// ex: E_CamModes eNew =  kGlobalsVars.eGetNextValue< E_CamModes >( geCmMode );
public static T eGetNextValue< T >( T eIn ){
    T[] aiAllValues = ( T[] ) Enum.GetValues( typeof( T ));
    int iVal = System.Array.IndexOf( aiAllValues, eIn );
    return aiAllValues[ ( iVal + 1 ) % aiAllValues.Length ];
} 
```

* * *

## 回答 #17

> 赞同：1
> 
> 时间：2016-02-25T14:45:07.550

有一个非常简单的解决方案*（如果您可以更改整数值）*专门设计用于处理数字。您的号码是 , 的事实`enum`不是问题。它仍然是`integer`（或您分配的任何基础数字类型）。`Enum`只是增加了演员要求的复杂性。

假设您`enum`的定义如下：

```
 public enum ItemStatus
    {
        New = 0,
        Draft = 1,
        Received = 2,
        Review = 4,
        Rejected = 8,
        Approved = 16
    }

ItemStatus myStatus = ItemStatus.Draft; 
```

对`Enum`. 例如：

```
myStatus = (ItemStatus)(((int)myStatus) << 1) 
```

myStatus 的结果是：**ItemStatus.Received**。

`Enum`您还可以通过将按位运算符从 更改为`<<`来倒退`>>`。

```
myStatus = (ItemStatus)(((int)myStatus) >> 1) 
```

myStatus 的结果是：**ItemStatus.New**。

您应该始终添加代码来测试两个方向的“越界”情况。

您可以在此处了解有关按位运算的更多信息：http: [//code.tutsplus.com/articles/understanding-bitwise-operators--active-11301](http://code.tutsplus.com/articles/understanding-bitwise-operators--active-11301)

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2009-03-13T13:14:19.023

我会接受 Sung Meister 的回答，但这是另一种选择：

```
MyEnum initial = MyEnum.B, next;

for (int i = ((int) initial) + 1, i < int.MaxValue; i++)
{
  if (Enum.IsDefined(typeof(MyEnum), (MyEnum) i))
  {
     next = (MyEnum) i;
     break;
  }
} 
```

注意：许多假设假设:)

* * *

## 回答 #19

> 赞同：0
> 
> 时间：2009-03-13T16:34:07.843

从评论中我有很多问题，比如：“你为什么要以这种方式使用枚举。” 既然你们这么多人问，让我给你我的用例，看看你是否同意：

我有一个固定的项目数组`int[n]`。根据情况，我想以不同的方式枚举这个数组。所以我定义：

```
int[] Arr= {1,2,34,5,6,78,9,90,30};
enum eRat1 { A = 0, B=3, C=5, D=8 }; 
enum eRat2 { A, AA,AAA,B,BB,C,C,CC,D }; 

void walk(Type enumType) 
{ 
   foreach (Type t in Enum.GetValues(enumType)) 
   { 
      write(t.ToString() + " = " + Arr[(int)t)]; 
   }
} 
```

并致电`walk(typeof(eRAt1))`或`walk(typeof(eRAt2))`

然后我得到所需的输出

1）步行（类型（eRAt1））

```
A = 1
B = 5
C = 78
D = 30 
```

2)`walk(typeof(eRAt2))`

```
A = 1
AA = 2
AAA = 34
B = 5
BB = 6
C = 78
CC = 90
D = 30 
```

这是非常简化的。但我希望，这可以解释。这还有其他一些优点，例如具有 enum.toString()。所以基本上我使用枚举作为索引器。

所以使用这个解决方案我现在可以做这样的事情。

在顺序 eRat1 中，B 的下一个值是 C，但在 eRat2 中它是 BB。因此，根据我感兴趣的序列，我可以执行 e.next 并且根据 enumType，我将获得 C 或 BB。使用字典如何实现这一目标？

我认为这是对枚举的一种相当优雅的使用。

* * *

## 回答 #20

> 赞同：0
> 
> 时间：2014-07-18T02:38:38.360

我在这里使用这个：

```
public MyEnum getNext() {
    return this.ordinal() < MyEnum.values().length - 1 ? 
                            MyEnum.values()[this.ordinal() + 1] : 
                            MyEnum.values()[0];
} 
```

* * *

## 回答 #21

> 赞同：0
> 
> 时间：2014-11-18T08:54:33.357

LINQ 解决方案不会在最后一个元素上中断，但会再次以默认值继续：

```
var nextValue = Enum.GetValues(typeof(EnumT)).Cast<EnumT>().Concat(new[]{default(EnumT)}).SkipWhile(_ => _ != value).Skip(1).First(); 
```

* * *

## 回答 #22

> 赞同：0
> 
> 时间：2018-11-22T11:26:38.313

我尝试了第一个解决方案，但它对我不起作用。以下是我的解决方案：

```
 public  object NextEnumItem(object currentEnumItem) 
    {
        if (!currentEnumItem.GetType().IsEnum) throw new 
                ArgumentException(String.Format("Argument is not an Enum"));
        Array Arr = Enum.GetValues(currentEnumItem.GetType());
        int j = Array.IndexOf(Arr,currentEnumItem) + 1;
        return (Arr.Length == j) ? currentEnumItem : Arr.GetValue(j);
    }

    public object PreviousEnumItem(object currentEnumItem)
    {
        if (!currentEnumItem.GetType().IsEnum)
            throw new ArgumentException(String.Format("Argument is not an Enum"));
        Array Arr = Enum.GetValues(currentEnumItem.GetType());
        int j = Array.IndexOf(Arr, currentEnumItem) - 1;
        return (j==-1) ? currentEnumItem : Arr.GetValue(j);
    } 
```

* * *

## 回答 #23

> 赞同：0
> 
> 时间：2019-05-07T11:17:56.103

我用不同的枚举做了类似的事情。这是一款游戏，玩家有机会切换颜色。

```
public enum PlayerColor {
    Red = 0, Green, Blue, Cyan, Yellow, Orange, Purple, Magenta
}

public PlayerColor GetNextFreeColor(PlayerColor oldColor) {

    PlayerColor newColor = (PlayerColor)((int)(oldColor + 1) % 8);
    return newColor;
} 
```

这个解决方案对我有用。

* * *

## 回答 #24

> 赞同：0
> 
> 时间：2020-06-02T15:52:02.393

*您可以向枚举*添加和删除整数以获得下一个值。唯一的问题是枚举上的整数运算*不会*检查*枚举*本身的有效性，因此可能会设置“无效”值。

但是您可以将*++enum*和*Enum.IsDefined()*结合起来，以获得一种简单的方法来获取枚举的下一个和上一个值。在您的情况下，这将是低效的，因为整数值不是连续的，但是如果您有连续的整数，那么它可以很好地工作，并且可以检查*++enum*何时超出范围。检查下一个示例。

```
 public enum level
    {
        a = 0,
        b = 1,
        c = 2,
        d = 3,
        e = 4
    }

private static void Main(string[] args)
    {
        var levelValue = level.a;
        Console.WriteLine(levelValue);
        ++levelValue;
        Console.WriteLine(levelValue);
        ++levelValue;
        Console.WriteLine(levelValue);
        ++levelValue;
        Console.WriteLine(levelValue);
        ++levelValue;
        Console.WriteLine(levelValue);
        ++levelValue;
        Console.WriteLine(Enum.IsDefined(typeof(Program.level), levelValue));
        Console.WriteLine(levelValue);
        --levelValue;
        Console.WriteLine(levelValue);
        --levelValue;
        Console.WriteLine(levelValue);
        --levelValue;
        Console.WriteLine(levelValue);
        --levelValue;
        Console.WriteLine(levelValue);
        --levelValue;
        Console.WriteLine(Enum.IsDefined(typeof(Program.level), levelValue));
        Console.WriteLine(levelValue);
        --levelValue;
        Console.WriteLine(Enum.IsDefined(typeof(Program.level), levelValue));
        Console.WriteLine(levelValue);
    } 
```

输出将是：

```
a
b
c
d
e
False
5
e
d
c
b
True
a
False
-1 
```

# asp.net - ASP.NET MVC - 开始的理由

> ID：642553
> 
> 赞同：4
> 
> 时间：2009-03-13T12:56:28.223
> 
> 标签：asp.net, asp.net-mvc

我正在考虑进入**ASP.NET MVC**场景。

[我在http://asp.net/learn](http://asp.net/learn)看过这些视频，但它们并没有给我留下深刻的印象。

所以你能回答我，是什么让 MVC “如此令人印象深刻”，为什么它让生活变得更好、更轻松？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-03-13T13:17:48.563

ASP.NET MVC 与它所基于的技术更加协调。ASP.NET Forms 试图假装像标准 WinForms 应用程序中那样有一个很好的胖状态基础设施。然而，HTTP 和 Web 服务器不喜欢胖有状态的应用程序。

ASP.NET MVC 允许关注点分离。请求由控制器而不是“网页”处理，它选择如何响应以及呈现该响应所需的 UI。控制器构建其选择的视图所需的结构化数据集，然后将该数据移交给视图。

这种划分允许更容易的测试，视图只是呈现应该是一个完整的数据块的一种手段。它更容易为接受结构化数据并用结构化数据响应的东西构建测试。

ASP.NET Forms 几乎不可能以这种方式进行测试（尤其是在没有声称可以实现它的昂贵工具的情况下）。因此，通过持续运行现有测试，MVC 应用程序更容易正确，并且更容易确保它保持正确。

**警告**：目前 ASP.NET MVC 的主要缺点是缺乏可靠的文档。我得到保证，文档“很快”就会出现。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-13T13:03:35.743

你有没有做过一个大项目，一开始就有很好的意图，但 3 年后一团糟？

[MVC](http://en.wikipedia.org/wiki/Model%E2%80%93view%E2%80%93controller)是一种公正的模式，它可以被滥用，就像 ASP.NET 被滥用一样。只是更难做到。

> 模型-视图-控制器 (MVC) 是一种用于软件工程的架构模式。该模式的成功使用将业务逻辑与用户界面考虑隔离开来，从而使应用程序更容易修改应用程序的视觉外观或底层业务规则，而不会影响另一个。

它允许您以对大多数人有意义的方式分离您的逻辑。同时它也很适合测试。

# delphi - 如何计算两个 WGS84 坐标之间的方位角（向北的角度）

> ID：642555
> 
> 赞同：10
> 
> 时间：2009-03-13T12:56:51.530
> 
> 标签：delphi, geolocation, geospatial

我有两个 WGS84 坐标，以度为单位的纬度和经度。这些点相当靠近，例如仅相隔一米。

有没有一种简单的方法来计算这些点之间的线的方位角，即向北的角度？

天真的方法是假设笛卡尔坐标系（因为这些点非常靠近）并使用

sin(a) = abs(L2-L1) / sqrt(sqr(L2-L1) + sqr(B2-B1))

a = 方位角 L1, L2 = 经度 B1, B2 = 纬度

随着坐标远离赤道，误差会更大，因为两个经度之间的距离变得越来越小于两个纬度之间的距离（保持不变）。

我发现了一些我真的不想实现的非常复杂的公式，因为它们对于那些靠得很近的点来说似乎有点矫枉过正，我不需要非常高的精度（两位小数就足够了，一个可能也可以，因为那里无论如何都会降低精度的其他因素，例如 GPS 返回的因素）。

也许我可以根据纬度确定一个近似的纵向校正因子并使用这样的东西：

sin(a) = abs(L2*f-L1*f) / sqrt(sqr(L2*f-L1*f) + sqr(B2-B1))

其中 f 是校正因子

有什么提示吗？

（我不想为此使用任何库，尤其是不需要运行时许可证的库。任何 MPLed Delphi Source 都会很棒。）

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-03-17T04:33:23.480

您在文本中引用的公式是计算 2 点之间的大圆距离。这是我计算点之间角度的方法：

```
uses Math, ...;
...

const
  cNO_ANGLE=-999;

...

function getAngleBetweenPoints(X1,Y1,X2,Y2:double):double;
var
  dx,dy:double;
begin
  dx := X2 - X1;
  dy := Y2 - Y1;

  if (dx > 0) then  result := (Pi*0.5) - ArcTan(dy/dx)   else
  if (dx < 0) then  result := (Pi*1.5) - ArcTan(dy/dx)   else
  if (dy > 0) then  result := 0                          else
  if (dy < 0) then  result := Pi                         else
                    result := cNO_ANGLE; // the 2 points are equal

  result := RadToDeg(result);
end; 
```

*   记得处理2点相等的情况（检查结果是否等于cNO_ANGLE，或者修改函数抛出异常）；

*   此功能假定您在平坦的表面上。对于您提到的小距离，这一切都很好，但是如果您要计算世界各地城市之间的航向，您可能需要研究一下地球形状的东西；

*   最好为这个函数提供已经映射到平面的坐标。您可以将 WGS84 Latitude 直接输入 Y（并将 lon 输入 X）以获得粗略的近似值。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-06-26T19:48:26.930

这是 C# 解决方案。测试 0、45、90、135、180、225、270 和 315 角度。

**编辑**我用 Wouter 解决方案的 C# 翻译替换了我以前丑陋的解决方案：

```
public double GetAzimuth(LatLng destination)
{
    var longitudinalDifference = destination.Lng - this.Lng;
    var latitudinalDifference = destination.Lat - this.Lat;
    var azimuth = (Math.PI * .5d) - Math.Atan(latitudinalDifference / longitudinalDifference);
    if (longitudinalDifference > 0) return azimuth;
    else if (longitudinalDifference < 0) return azimuth + Math.PI;
    else if (latitudinalDifference < 0) return Math.PI;
    return 0d;
} 
```

```
public double GetDegreesAzimuth(LatLng destination)
{
    return RadiansToDegreesConversionFactor * GetAzimuth(destination);
} 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-03-13T19:07:56.210

我找到了这个链接

[http://williams.best.vwh.net/avform.htm](http://williams.best.vwh.net/avform.htm)

在答案中给出

[纬度/经度 + 距离 + 航向 --> 纬度/经度](https://stackoverflow.com/questions/378281/lat-lon-distance-heading-lat-lon)

这看起来很有希望，尤其是在接近尾声时给出的平坦地球近似值。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-09-14T09:43:15.413

这仅适用于小的差异。否则你不能只是“纬度差异/纵向差异”。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-13T16:22:54.593

我建议根据经度实施校正因子。我实施了一次类似的例程，以返回特定地点 x 英里内的所有地理编码记录，并遇到了类似的问题。不幸的是，我没有代码了，而且似乎不记得我是如何得到更正号码的，但你在正确的轨道上。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2019-02-09T18:51:53.867

有没有人测试过这个？它不返回正确的答案

*此功能假定您在平坦的表面上。对于您提到的小距离，这一切都很好，但是如果您要计算世界各地城市之间的航向，您可能需要研究一下地球形状的东西；*

你平坦的地球与此无关。正如您所说，该错误是因为您正在计算一个点的初始方位角。除非你直奔电线杆，否则你与电线杆的关系会随着距离而改变。无论如何，上述程序不会返回正确的结果。

# c# - 如何从多个类库中引用配置信息？

> ID：642563
> 
> 赞同：3
> 
> 时间：2009-03-13T12:58:12.010
> 
> 标签：c#, .net, vb.net, .net-3.5, .net-2.0

我有一堆 DLL 项目要拉入我的应用程序，每个项目都包含自己的 Settings.settings/app.config。当我编译应用程序并运行调试时，一切正常，但在部署时我无法让我的 DLL 读取它们自己的设置文件。

我一直在阅读，很明显有几种方法可以让每个 dll 读取自己的配置 - 一种是将 .dll.config 专用于库，另一种是将 dll 的配置嵌入进程.exe.config。

我在尝试实施任何一个方面都遇到了重大问题，我想知道是否有人对此有任何好的文档 - 网络上似乎存在短缺。

如果可能的话，我希望每个库都有一个单独的 .dll.config，但在紧要关头，让我的每个库读取它们自己的 process.exe.config 部分就可以了。

谁能指出我正确的方向，因为我非常接近推出这个应用程序，但是这个绊脚石让我非常头疼。

**编辑：**当我合并配置文件时，当我使用我的库初始化对象时，我开始收到 TypeInitializer 异常。这可能只是我被智障了，但是有人有一个合并配置文件的工作示例和一些用于从多个程序集中读取它的基本演示代码吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-13T13:08:39.177

您遇到的“重大问题”是什么？我开始将 dll 的配置嵌入到 exe 的配置中，这很有效，但很麻烦。我现在在一个 dll 项目中拥有所有配置内容。为了使这项工作（除了复制设置），我唯一需要做的就是将 Settings 类更改为 public。

这是一个合并的 app.config 的例子：

```
 <?xml version="1.0" encoding="utf-8" ?>
  <configuration>
    <configSections>
      <sectionGroup name="applicationSettings" type="System.Configuration.ApplicationSettingsGroup, System, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089" >
        <section name="SharedConfig.Client.Properties.Settings" type="System.Configuration.ClientSettingsSection, System, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089" requirePermission="false" />
        <!-- Begin copy from library app.config -->
        <section name="SharedConfig.Library.Properties.Settings" type="System.Configuration.ClientSettingsSection, System, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089" requirePermission="false" />
        <!-- End copy from library app.config -->
      </sectionGroup>
    </configSections>
    <applicationSettings>
      <SharedConfig.Client.Properties.Settings>
        <setting name="Bar" serializeAs="String">
          <value>BarFromClient</value>
        </setting>
      </SharedConfig.Client.Properties.Settings>
      <!-- Begin copy from library app.config -->
      <SharedConfig.Library.Properties.Settings>
        <setting name="Bar" serializeAs="String">
          <value>BarFromLibrary</value>
        </setting>
      </SharedConfig.Library.Properties.Settings>
      <!-- End copy from library app.config -->
    </applicationSettings>
  </configuration> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-13T13:04:19.267

让每个类库在自定义 ConfigurationSection 中定义配置设置。

然后将自定义部分处理程序添加到您的 process.exe.config 文件。

[这篇 MSDN 文章](http://msdn.microsoft.com/en-us/library/2tw134k3.aspx)的解释非常全面，包括 VB 和 C# 中的示例。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-13T13:10:26.677

请参阅[如果 DLL 的 app.config 应该在“主配置”中……我们如何处理 DLL 中的 WCF 引用？](https://stackoverflow.com/questions/634439/if-app-config-for-a-dll-should-be-in-the-main-config-what-do-we-do-with-wcf-refe). 真正的答案是“复制和粘贴”。不幸的是，这是微软想到的通用解决方案。在某些情况下，可以使用 .NET 2.0 设置机制，因为它将默认值烘焙到 DLL 本身中。在运行时，DLL 可以将更新的设置保存到 .exe.config 中。

# c - 我怎么知道 gcc 是否同意某些东西是易变的？

> ID：642568
> 
> 赞同：8
> 
> 时间：2009-03-13T12:59:15.520
> 
> 标签：c, gcc, assembly, volatile

考虑以下：

```
volatile uint32_t i; 
```

我如何知道 gcc 是否将 i 视为 volatile？它将被声明为这样，因为附近没有代码会修改它，并且修改它很可能是由于一些中断。

我不是世界上最差的汇编程序员，但我在电视上玩过一个。有人可以帮我理解它会有什么不同吗？

如果您采用以下愚蠢的代码：

```
#include <stdio.h>
#include <inttypes.h>

volatile uint32_t i;

int main(void)
{
        if (i == 64738)
                return 0;
        else
                return 1;
} 
```

编译成object格式，通过objdump反汇编，去掉'volatile'后也一样，没有区别（根据diff）。volatile 声明是否太接近其检查或修改的位置，还是在声明 volatile 时我应该总是使用某种原子类型？一些优化标志会影响这一点吗？

请注意，我的愚蠢样本与我的问题不完全匹配，我意识到这一点。我只是想知道 gcc 是否将变量视为 volatile，因此我正在研究小型转储以尝试找出差异。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-03-13T13:05:09.140

在某些情况下，许多编译器不会按应有的方式处理 volatile。如果您经常处理 volatiles 以避免令人讨厌的意外，请参阅这篇论文：[Volatiles 被错误编译，以及如何处理它](http://www.cs.utah.edu/~regehr/papers/emsoft08-preprint.pdf)。它还包含以标准引用为后盾的对 volatile 的很好描述。

100% 确定，对于这样一个简单的示例，请查看汇编输出。

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2009-03-13T13:03:53.853

尝试在循环外设置变量并在循环内读取它。在非易失性情况下，编译器可能（或可能不会）将其放入寄存器或使其成为编译时间常数或循环之前的其他内容，因为它“知道”它不会改变，而如果它是易失性的，它会每次通过循环从变量空间中读取它。

基本上，当您将某些内容声明为 volatile 时，您是在告诉编译器不要进行某些优化。如果它决定不做这些优化，你不*知道*它没有做这些优化是因为它被声明为 volatile，或者只是它决定它需要这些寄存器来做其他事情，或者它没有注意到它可以转向它变成一个编译时间常数。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-03-13T13:05:56.360

据我所知， volatile 有助于优化器。例如，如果您的代码如下所示：

```
int foo() {
    int x = 0;
    while (x);
    return 42;
} 
```

“while”循环将从二进制文件中优化。

但是，如果您将“x”定义为易失性（即`volatile int x;`），那么编译器将不理会循环。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2009-03-13T13:50:50.870

你的小样本不足以显示任何东西。volatile 变量和非 volatile 变量之间的区别在于，代码中的每次加载或存储都必须在可执行文件中为 volatile 变量精确生成一次加载或存储，而编译器可以自由优化非-易失性变量。如果您的样本中有一个 i 负载，这就是我对易失性和非易失性的期望。

为了显示差异，您将不得不有多余的负载和/或存储。尝试类似的东西

```
int i = 5;
int j = i + 2;
i = 5;
i = 5;
printf("%d %d\n", i, j); 
```

在非易失性和易失性之间改变 i。您可能必须启用某种程度的优化才能看到差异。

那里的代码有三个存储和两个 i 加载，可以优化为一个存储，如果 i 不是易失性的，可能会加载一个。如果 i 被声明为 volatile，则无论进行何种优化，所有存储和加载都应按顺序显示在目标代码中。如果他们不这样做，你就有一个编译器错误。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2009-03-13T13:04:35.007

在错误引用或否决之前阅读标准。这是来自 n2798 的引述：

> **7.1.6.1 cv 限定符**
> 
> 7 注意： volatile 是对实现的提示，以避免涉及对象的激进优化，因为对象的值可能会通过实现无法检测的方式进行更改。详细语义见 1.9。通常，volatile 的语义在 C++ 中与在 C 中的语义相同。

关键字`volatile`充当提示。很像`register`关键字。但是，`volatile`要求编译器保留所有优化。这样，它不会在寄存器或缓存中保留变量的副本（以优化访问速度），而是在每次请求时从内存中获取它。

既然有这么多的混乱：更多。实际上，C99 标准确实说每次读取 volatile 限定对象时都必须对其进行查找，等等，正如其他人所指出的那样。但是，还有另一部分说构成可变访问的内容是实现定义的。因此，一个对硬件了如指掌的编译器会知道，例如，当您有一个自动 volatile 限定变量并且其地址从未被占用时，它不会被放入内存的敏感区域并且几乎肯定会忽略提示并优化它。

此关键字查找错误处理的用法`setjmp`和`longjmp`类型。您唯一需要记住的是：当您认为变量可能会更改时，您提供 volatile 关键字。也就是说，您可以获取一个普通对象并通过几次强制转换来管理。

要记住的另一件事是，什么构成易失性访问的定义由标准留给实现。

如果您*真的*想要不同的程序集进行优化编译

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2009-03-13T13:06:02.727

它应该*始终*将其视为易失性。

代码相同的原因是 volatile 只是指示编译器在每次访问它时从内存中加载变量。即使启用了优化，编译器仍然需要在您编写的代码中从内存中加载 i 一次，因为它无法在编译时推断 i 的值。如果您反复访问它，您会发现不同。

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2009-03-13T13:35:37.833

任何现代编译器都有多个阶段。一个相当简单但有趣的问题是变量本身的声明是否被正确解析。这很容易，因为 C++ 名称修饰应该根据易失性而有所不同。因此，如果你编译两次，一次定义了 volatile，符号表应该略有不同。

# php - PHP：在对象内创建伪连接方法

> ID：642582
> 
> 赞同：0
> 
> 时间：2009-03-13T13:02:43.280
> 
> 标签：php, oop, logic, conditional

我正在尝试创建一个能够处理类似查询的条件语句的对象。这样我就可以将两个条件“连接”在一起，以根据所使用的“连接”类型在它们之间创建依赖关系。我目前有一个包含以下方法的简单对象：

```
public function addCondition ( Condition $condition, $join = null )
{
    $this->conditions[] = $condition;
}

public function validate ( )
{
    foreach ( $this->conditions as $condition )
    {
        $result = $condition->validate( );
        [...]
    }
} 
```

问题是，我需要能够在两个语句之间执行条件连接，这将影响 validate 方法的返回值。这个想法是您可以提供如下条件：

```
$this->addCondition($condition_1);
$this->addCondition($condition_2, 'AND');
$this->addCondition($condition_3, 'NOT'); 
```

然后，这将生成指定第三个条件的结果将反向链接以影响第一个条件的结果所需的逻辑。

在示例中，让我们说：

```
条件_1 = 苹果是红色的
condition_2 = 苹果成熟了
condition_3 = 苹果是金冠

```

使用这个我应该假设如果我要传递一个成熟的、红色和金色的美味苹果，那么 validate() 的结果将是错误的。该方法应该失败，因为 condition_3 的“加入”不是。

但是，目前还没有办法告诉代码整个方法的结果取决于前一个条件的结果以及它与它的连接方式。

任何帮助是极大的赞赏！谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-13T13:16:43.730

将逻辑放在 Condition 子类中。

创建一个 Condition_And 类，该类接受两个（或更多） Condition 对象，并且仅当它们都为 true 时才返回 true。

创建一个接受两个（或更多） Condition 对象的 Condition_Or 类，如果其中任何一个为真，则返回假。

如果您认为有必要，请创建一个 Condition_Not 类（Apple 不是 Golden Delicious）。

将这些串在一起应该可以为您提供所需的任何查询。由于它们都是同一类型的子类，因此您可以构建它们，将 NOT 放在 OR 内，将 AND 放在 OR 内，以此类推。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-13T13:16:53.510

涉及两者`AND`并且`OR`本质上是嵌套的条件。你的班级似乎没有办法表达这一点。

没有嵌套意味着您的条件必须全部与 连接`AND`，或全部与 连接`OR`。无论如何-您不能同时使用两者。

对于您的示例，`AND`这似乎是自然的选择，因此您只需要`NOT`为每个条件设置一个标志：

```
$this->addCondition($condition_1, true);   // e.g.: must be true to succeed
$this->addCondition($condition_2, true);
$this->addCondition($condition_3, false);  // e.g.: must be false to succeed 
```

然后你会这样做：

```
$valid = true;

foreach ( $this->conditions as $condition )
{
  $valid = $valid && $condition->validate();
  if (!$valid) 
  {
    // react to "validation failed at $condition"
  }
}

return $valid; 
```

# wpf - WPF Grid 问题，我可以确定在 WPF Grid 中自动定位的某物的绝对位置吗？

> ID：642584
> 
> 赞同：3
> 
> 时间：2009-03-13T13:03:15.073
> 
> 标签：wpf

我喜欢使用网格来定位 WPF 中的一些对象，因为它关心位置和内容。此外，我还希望能够使用 Canvas 跨单元格进行绘制。

我发现这可以通过将网格嵌入画布来完成。但是为了连接两个元素，我需要以像素为单位的绝对位置..有什么想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-13T13:08:18.430

从代码中，您可以使用该[`UIElement.TranslatePoint()`](http://msdn.microsoft.com/en-us/library/system.windows.uielement.translatepoint.aspx)方法。

# authentication - 认证组合 OpenID & Facebook

> ID：642593
> 
> 赞同：5
> 
> 时间：2009-03-13T13:04:47.113
> 
> 标签：authentication, openid, facebook, web-applications

是否可以在 Web 应用程序中使用身份验证系统的组合？

我想使用 OpenId，但我认为我的潜在客户实际上更有可能拥有 Facebook ID。

因此我想知道是否可以提供两种类型的身份验证？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-13T13:14:40.350

[Facebook 已加入 OpenID 基金会](http://openid.net/2009/02/05/facebook-joins-openid-foundation-board/)，因此他们可能很快就会实施 OpenID（在这种情况下，最好只使用 OpenID）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-13T13:12:47.810

几乎每种语言都应该有一个框架！您可以链接/包装该框架的功能来满足您的需求！

在伪代码中：

```
if(IsUserValidViaOpenId() || IsUserValidByOwnAuthDB()) ...  user auth successful 
```

如果您使用 java，Acegi/Spring Security 可能是最好的方法（不可逆的安全性 - 通过 AOP）。在那里，您可以使用 openID 并为您自己的 userdb 定义自己的第二个验证器！

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-13T15:06:43.357

你想要[RPX](http://www.rpxnow.com)。它从您和您的访问者那里抽象出 OpenID 的整个混乱。除了 OpenID 提供商之外，它还允许他们通过 Facebook 或 MySpace 进行身份验证。

它提供的登录界面与您在 Stack Overflow 上看到的非常相似。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-13T13:18:40.463

在您的表单处理逻辑中是这样的：

```
def authenticate(form_info):
    url = form_info['url']
    if (is_facebook_url(url)):
        return perform_facebook_authentication(form_info)
    else:
        return perform_open_id_authentication(form_info) 
```

# c# - 解析邮寄地址的正则表达式

> ID：642602
> 
> 赞同：10
> 
> 时间：2009-03-13T13:06:04.147
> 
> 标签：c#, regex

我有一个地址类，它使用正则表达式从地址的第一行解析门牌号、街道名称和街道类型。这段代码通常运行良好，但我在这里发布与社区分享，看看是否有人有改进建议。

注意： STREETTYPES 和 QUADRANT 常量分别包含所有相关的街道类型和象限。

我在这里包含了一个子集：

```
private const string STREETTYPES = @"ALLEY|ALY|ANNEX|AX|ARCADE|ARC|AVENUE|AV|AVE|BAYOU|BYU|BEACH|...";

private const string QUADRANTS = "N|NORTH|S|SOUTH|E|EAST|W|WEST|NE|NORTHEAST|NW|NORTHWEST|SE|SOUTHEAST|SW|SOUTHWEST"; 
```

HouseNumber、Quadrant、StreetName 和 StreetType 都是该类的属性。

```
 private void Parse(string line1)
    {
        HouseNumber = string.Empty;
        Quadrant = string.Empty;
        StreetName = string.Empty;
        StreetType = string.Empty;

        if (!String.IsNullOrEmpty(line1))
        {
            string noPeriodsLine1 = String.Copy(line1);
            noPeriodsLine1 = noPeriodsLine1.Replace(".", "");

            string addressParseRegEx =
                @"(?ix)
            ^
            \s*
            (?:
               (?<housenumber>\d+)
               (?:(?:\s+|-)(?<quadrant>" +
                QUADRANTS +
                @"))?
               (?:(?:\s+|-)(?<streetname>\S+(?:\s+\S+)*?))??
               (?:(?:\s+|-)(?<quadrant>" +
                QUADRANTS + @"))?
               (?:(?:\s+|-)(?<streettype>" + STREETTYPES +
                @"))?
               (?:(?:\s+|-)(?<streettypequalifier>(?!(?:" +
                QUADRANTS +
                @"))(?:\d+|\S+)))?
               (?:(?:\s+|-)(?<streettypequadrant>(" +
                QUADRANTS + @")))??
               (?:(?:\s+|-)(?<suffix>(?:ste|suite|po\sbox|apt)\s*\S*))?
            |
               (?:(?:po|postoffice|post\s+office)\s+box\s+(?<postofficebox>\S+))
            )
            \s*
            $
            ";
            Match match = Regex.Match(noPeriodsLine1, addressParseRegEx);
            if (match.Success)
            {
                HouseNumber = match.Groups["housenumber"].Value;
                Quadrant = (string.IsNullOrEmpty(match.Groups["quadrant"].Value)) ? match.Groups["streettypequadrant"].Value : match.Groups["quadrant"].Value;
                if (match.Groups["streetname"].Captures.Count > 1)
                {
                    foreach (Capture capture in match.Groups["streetname"].Captures)
                    {
                        StreetName += capture.Value + " ";
                    }
                    StreetName = StreetName.Trim();
                }
                else
                {
                    StreetName = (string.IsNullOrEmpty(match.Groups["streetname"].Value)) ? match.Groups["streettypequalifier"].Value : match.Groups["streetname"].Value;
                }
                StreetType = match.Groups["streettype"].Value;

                //if the matched street type is found
                //use the abbreviated version...especially for credit bureau calls
                string streetTypeAbbreviation;
                if (StreetTypes.TryGetValue(StreetType.ToUpper(), out streetTypeAbbreviation))
                {
                    StreetType = streetTypeAbbreviation;
                }
            }
        }

    } 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-05-01T20:41:21.500

享受地址和正则表达式的乐趣，您将经历漫长而可怕的旅程。

你正试图在混乱中建立秩序。

对于每个“123 Simple Way”，都有一个“14 1/2 South”。

然后，为了额外的笑声，还有盐湖城：“855 South 1300 East”。

玩得开心。

在街道地址方面，例外多于规则。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-03-13T13:31:40.497

我不知道你在哪个国家，但是如果你在美国并且想花一些钱在地址验证上，你可以[在这里](http://www.usps.com/ncsc/addressinfo/addressinfomenu.htm?from=zclsearch&page=ais&WT.z_zip4link=AIS)购买相关的 USPS 产品。这里是从 USPS 查找预期单词和缩写的免费单词列表的好地方[。](http://www.usps.com/ncsc/lookups/usps_abbreviations.htm)我确信其他国家也有类似的页面。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-03-14T08:57:47.137

我认为你应该澄清你的使用场景。

除非您处于非常非常有限的情况下，您知道地址是按照严格的模式输入的，否则解析内容地址是一个非常难以解决的问题，而且通常是徒劳的（除非这是存在的*理由*你的申请）。

如果您仅限于具有非常具体的地址书写约定的特定国家/地区，那么使用这些正则表达式可能会帮助您完成 90% 的工作。
然而，一旦你必须开始接受外国地址，你就完蛋了。
即使您是一个以美国为中心的网站，您也很有可能必须能够接受来自居住在国外的美国公民的地址。

同样，在一个非常狭窄的领域中可能还可以，但验证或拆分在用户输入时未经过严格验证和约束的地址几乎总是一个坏主意。
当您确实为用户输入他们的地址强制执行一些严格的规则时，这些最终在一小部分情况下是不够的，即使在最好的地址验证组件中也是如此。

只是一些搞砸地址解析的事情：

*   邮政编码（邮政编码）有时会放在前面、后面，甚至可能根本不存在。
*   邮政编码遵循严格的规则：10 位数的邮政编码可能很容易被视为无效，但不存在的邮政编码怎么办？更多的代码（例如在英国使用的代码）呢？
*   像香港这样可以用英文、繁体中文或普通话写地址的地方怎么样？
*   如果拆分您的地址并将其乱序写入完全没问题怎么办？
*   即使您只是解析美国地址，也至少有几种描述邮政信箱的方法：您也可以使用*poste restante*，*一般交付*，然后需要在邮政编码中添加一个 4 位代码，这将通常可能根本不存在...

**底线是**

如果以可解析的格式获取地址真的很重要，请 100% 确保您可以正确获取所有可能的组合，否则您将遇到一定比例的失败，这将意味着用户沮丧和销售损失。
如果您没有 100% 的案例覆盖率，则不要对用户执行严格的规则。
我无法计算我放弃购买的网站的数量，因为当我居住的地方没有邮政编码时，它们需要邮政编码。

很抱歉，我认为想要进行地址验证和解析的人认真思考他们正在做什么是很重要的。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2010-06-02T13:06:16.137

这实际上工作得很好，只是它不提取公寓号码。我们正在努力。当我们的地址是 769 Branch Ave 时，它​​也有点咳嗽。当然，“branch”是它要寻找的街道类型之一。这一切都可以追溯到从混乱中整理出来的事情。我们知道它会在这里和那里打破。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-12-18T17:51:02.707

如果有人在 2013/2014 年遇到此问题 :) 您可以使用 google geocode API。它提供了比正则表达式更多的功能——您甚至可以获取地址的纬度/经度。而且它是免费的

对于地址示例-

[http://maps.googleapis.com/maps/api/geocode/xml?address=2520%20Cohasset%20Rd%20-%20Chico%2C%20CA%2095973-1307%20530-893-1300%20%20&sensor=false](http://maps.googleapis.com/maps/api/geocode/xml?address=2520%20Cohasset%20Rd%20-%20Chico%2C%20CA%2095973-1307%20530-893-1300%20%20&sensor=false)

![在此处输入图像描述](https://i.stack.imgur.com/T0PhY.png)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-01T20:12:31.820

我试图让它工作，但似乎你有一个未包含的 StreetTypes 类的静态成员。除此之外它似乎工作，但没有它我不能做太多的测试。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-09-20T19:33:10.337

我同意你的严格会成为一个问题。我正在编写一个地址解析器，旨在从分类广告中删除地址，格式几乎可以是任何东西。例如，对于您的象限匹配，您完全忽略了标点符号。我必须以所有这些不同的方式搜索可以代表 NE 的数据：

“NE”、“NE”、“NE”、“NE”、“NE”、“东北”、“东北”

所以我正在使用以下模式匹配，它应该捕获所有方向限定符，无论它们如何表达：

```
\b(?:(?:[nesw]\.? ?){0,2}|(?:north|no\.|east|south|so\.|west){0,2})\b 
```

当然，上下文也很重要，因为“否”将与之匹配。但是内布拉斯加州的“NE”会与其中任何一个匹配，所以你真的必须小心你更大的表达式中的左边和右边。我必须编译通常散布在地址文本中的单词列表，这些单词不是地址组件，例如“near，x-street，in，cross”等。

这是一个非常棘手的问题，我同意盐湖城是个婊子。除了具有双向/坐标格式之外，他们还通过引用诸如“3700 North 5300 East Arborville Way”之类的东西来复合它，其中街道可以通过名称、编号或两者来引用。

# c# - C# 正则表达式匹配具有分隔符的字符串

> ID：642604
> 
> 赞同：0
> 
> 时间：2009-03-13T13:06:53.240
> 
> 标签：c#, regex, parsing, csv

我想使用正则表达式在两个特定单词之间获取其中有分隔符的字符串。

例如，我需要一个匹配的正则表达式：

> Statements1 开始 Statements2 ; Statements3结束乐趣；

`;`在“开始”和“结束”之间可以多次出现“ ”。

语句是多个单词，其中 (.*) 可以在正则表达式中用于一个单词。

`;`但是，如果“开始”和“结束”之间没有“”，则正则表达式不应匹配。

此外，“结束”应该是“开始”之后遇到的第一个“结束”

所以，正则表达式不应该匹配

> Statements1 开始 Statements2 结束 Statements3 ; 结束乐趣

我希望比赛为

1.  “开始”之前的陈述
2.  关键词
3.  “开始”后的陈述

因此，在这种情况下，它将是一个组（对于第一个字符串，因为 2nd 不应该匹配）为：

1.  声明1
2.  开始
3.  声明2；Statements3结束乐趣；

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-13T13:34:35.933

因此，下面的正则表达式将匹配您的肯定情况并失败否定情况并将结果放入第 1、2 和 3 组。

`(.*?) (start) ((?:(?:.*?) ;)+ (?:.*?) end fun)`

如果您不熟悉 (?:) 语法 - 它们表示非捕获括号。查看[Mastering Regular Expressions](http://oreilly.com/catalog/9780596002893/)，这是本主题的一个很好的参考！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-13T13:10:07.193

```
start ((Statements) ;)+ (Statements) end fun 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-13T13:16:47.113

使用起来可能会更快

```
 string[] Strings = stringToSplit.Split(new char[] { ';' });
    if (Strings.Count() > 1)
    {
        // Do your stuff
    } 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-13T13:29:17.723

听起来你想要的很简单：

```
(.*)(start)(.*;.*end.*) 
```

这将返回您列出的组。

# jsp - 如何将 SQL 查询结果发送到 jsp 页面？

> ID：642606
> 
> 赞同：1
> 
> 时间：2009-03-13T13:07:18.620
> 
> 标签：jsp, jdbc

我有一个包含字段 id(number)、name(string)、address(string) 的数据库。

我编写了一个 java 程序 EmployeeDAO 来执行查询。我将它存储在 ResultSet 对象`rs`中。我需要将此结果集显示为 JSP 页面中的表格。如何将其发送`rs`到 JSP 页面？

```
public class EmployeeDAO 
{
    public _____ list() throws Exception
    {
        try
        {
            Class.forName("sun.jdbc.odbc.JdbcOdbcDriver").newInstance();
            String url = "jdbc:odbc:employee_dsn";
            Connection con = DriverManager.getConnection(url);
            Statement stmt = con.createStatement();
            ResultSet rs = stmt.executeQuery("Select * from emp_table");
        }
            catch (Exception e)
        {   
             System.out.println(e);
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-13T13:27:39.927

首先创建具有与 emp_table 中的列相同的字段的 Java 模型类 Employee。例如：

```
public class Employee {
  private String name;
  private String lastName;
  public void setName(String name) {
    this.name = name;
  }
  public String getName() {
    return this.name;
  }
  public String getLastName() {
    return this.lastName;
  }
  public void setLastName(String lastName) {
    this.lastName = lastName;
  }
} 
```

然后在您的方法 _list() 中迭代结果集，如下所示：

```
public List<Employee> _ list() throws Exception {
     Connection con = null;
     ResultSet rs = null;
     List<Employee> result = new ArrayList<Employee>();
     try
       {
         Class.forName("sun.jdbc.odbc.JdbcOdbcDriver").newInstance();
         String url = "jdbc:odbc:employee_dsn";
         con = DriverManager.getConnection(url);
         Statement stmt = con.createStatement();
         rs = stmt.executeQuery("Select * from emp_table");
         while (rs.next()) {
           Employee emp = new Employee();
          emp.setName(rs.getString("emp_name"));
          emp.setLastName(rs.getString("emp_last_name"));
          result.add(emp);
         }

        }
        catch (Exception e)
        {       
            System.out.println(e);
        } finally {
            if (null != rs) {
              try { rs.close()} catch(Exception ex) {};
            }
            if (null != con) {
              try { con.close()} catch(Exception ex) {};
            }
        }
return result;
  } 
```

在您的 JSP 中，您可以像这样遍历集合：

```
<table>
  <c:forEach var="emp" items="${empDao._list}">
    <tr>
      <td>${emp.name}</td>
      <td>${emp.lastName}</td>
    </tr>
  </c:forEach>
</table> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-13T13:17:29.483

优雅的解决方案是将您的结果集映射到对象列表。查看 springs [RowMapper](http://static.springframework.org/spring/docs/2.5.x/api/org/springframework/jdbc/core/RowMapper.html)以了解如何处理此问题。

在您的 jsp 中，您可以使用`<c:forEach/>`循环来写出此列表。

# c# - 像 C# 一样进行 VB.NET 调试

> ID：642610
> 
> 赞同：0
> 
> 时间：2009-03-13T13:08:20.693
> 
> 标签：c#, vb.net, debugging, c#-to-vb.net

在我的 .NET 职业生涯的大部分时间里，我都在用 C# 进行编程——现在我正在开发一个 VB.net 项目——在调试时，它让我对调试工作方式的差异感到疯狂。

我头顶上的两个是

1) 必须在我的即时窗口查询前加上 ?

2) 无法将鼠标悬停在 GUID 上，我必须 ?myGuid.ToString() 才能实际看到该值

有没有办法让它表现得像 C#？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-13T13:26:48.417

VB 和 C# 都支持 1。当您在即时窗口查询前加上 ? 时，您是在说“请评估一个表达式”。在没有 ? 的情况下，您将键入的任何内容都将被评估为语句。这在以下两行中有很大的不同

```
? a = b
a = b 
```

第一个是比较操作，第二个是赋值。

至于第二个问题。是的，这对于当前版本的 VS 来说是一种不幸的体验。VS 的下一个版本修复了这个问题（以及调试空间中的其他几个问题）。

有一个针对 VS2008（可能还有 VS2005）的解决方法，可以让您解决该问题。您可以为在对象上调用 .ToString 的 GUID 添加自定义 DebuggerDisplay。不久前我写了一篇关于如何实现这一目标的博客文章

[http://blogs.msdn.com/jaredpar/archive/2007/09/28/customzing-displays-in-the-debugger-for-system-types.aspx](http://blogs.msdn.com/jaredpar/archive/2007/09/28/customzing-displays-in-the-debugger-for-system-types.aspx)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-14T02:37:25.740

这 ？是原始 BASIC 语言的保留在哪里？是 PRINT 语句的快捷方式。我想 PRINTing 变量的值就像查询结果（或提出问题），因此是问号。

我一直希望有几个版本的 Visual Basic 过时的关键字，如 ?、PRINT 和 REM 会默默地消失，但它们还没有……还没有。

# sql-server - 使用 SSIS 迁移和规范化数据库

> ID：642614
> 
> 赞同：4
> 
> 时间：2009-03-13T13:09:57.850
> 
> 标签：sql-server, ms-access, ssis, data-migration

我们有一个 MS Access 数据库，我们希望将其迁移到具有新数据库设计的 SQL Server 数据库。已经编写了使用 SQL Server DB 的应用程序的一部分。

我四处寻找如何最轻松地完成迁移步骤，并从 Microsoft 的 SQL Server 集成服务 (SSIS) 开始。现在，出于规范化的原因，我想垂直拆分表格。

一个虚构的例子看起来像这样

MS Access 表**人**

```
ID
Name
Street 
```

SQL Server 表**人**

```
id
name 
```

SQL Server 表**地址**

```
id
person_id
street 
```

如何使用 SSIS 最好地完成这项任务？id 列是标识（自动增量）列，因此我无法插入旧 ID。如何在地址表中放入正确的 person_id 外键？

甚至可能有一个表必须分成三个表，其中 table2 中的一行属于 table1，table3 中的一行属于 table2 行。

SSIS 是合适的方法吗？

**编辑** 虽然这是一次性迁移，但我们需要一个自动化且可重复的过程，因为生产数据库的使用量很大，我们正在开发环境中使用最新但不是最新的数据进行迁移. 我们计划对迁移进行一次测试运行，并让客户审查行为。*如果一切正常*，我们将进行真正的迁移。

大多数给定的解决方案都包含许多手动步骤，因此不合适。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-13T13:20:46.700

使用执行 SQL 任务并自己编写语句。

对于父表，`Select into table from table...`然后随着您的进展对其余表执行相同的操作。确保您将父表的身份插入设置为 ON 并重用您的旧 ID。这将帮助您保持数据完整性。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-14T02:29:55.180

要将 Access 表迁移到 SQL Server，请使用[SSMA，而不是 Access 中的升迁向导](https://stackoverflow.com/questions/559394/ms-access-application-convert-data-storage-from-access-to-sql-server/559889#559889)。
您将获得更多可用的工具。

然后，您可以从 SQL Server 中一张一张地分解您的表。
我不确定是否有任何工具可以帮助您自动拆分表格，至少我找不到任何工具，但是手动完成并不难，尽管需要多少工作取决于您使用原始表格的方式首先在您的 VBA 代码和表单中。

**旁注**

关于规范化，不要过火：我知道你的例子就是这样，但并不总是（很少？）需要规范化客户地址。

一个人可以拥有多少个地址？
如果您计算家庭地址、公司地址、送货地址、帐单地址，这可能是您最需要的。
在这种情况下，最好将它们放在同一张表中。规范化这些数据只需要更多的工作来重组并且没有任何好处。
当然，在某些情况下标准化是有意义的，但我看到人们对这个概念过分了（我也犯了罪），然后发现自己在努力构建更复杂的查询来加入所有分裂数据，使开发和维护更加困难，并且经常在此过程中遭受性能损失。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-14T22:46:08.807

Access 是如此的用户友好，为什么不在 Access 中规范化您的表，然后从那里升级完成的结构呢？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-18T10:16:39.660

我找到了一个尚未提及的不同解决方案，它允许我们使用数据流任务的所有舒适性和选项：

如果目标数据库位于**本地**SQL Server 上，则可以将数据流任务与 SQL Server 目标一起使用，而不是使用 OLE DB 目标。对于 SQL Server 目标，您可以标记“保留身份”选项。（我不知道英文名称是否正确，因为我们有德语版本。）有了这个你可以写到身份列

我们发现我们不能在任何地方都使用旧的主键，因为我们有一些表从多个表中获取记录的联合。

我们通过构建一个带有列的临时映射表来开始这个过程

```
new_id (identity)
old_id (int)
old_tablename (string) 
```

我们首先为新模式中的外键引用的每个表填写所有 old_id 。new_id 值由 SQL Server 自动生成。

因此，我们可以在需要的地方使用连接将 old_id 转换为 new_id。我们使用 new_id 值通过“保留身份”选项填充新表中的身份（主键）列，并且可以通过连接在我们的映射表中简单地查找它们以获取外键。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-27T23:44:25.743

您还可以查看[Jamie Thomson](http://blogs.conchango.com/jamiethomson/default.aspx)的[SSIS Normalizer](http://blogs.conchango.com/jamiethomson/archive/2009/04/23/normaliser-component-v2-ssis.aspx)组件。我今天才发现它（实际上还没有尝试过）。他发布的示例看起来很像您问题中的示例。

# c++ - 使用此 cpp 代码的 cl.exe (Visual Studio 2008) 编译错误

> ID：642618
> 
> 赞同：0
> 
> 时间：2009-03-13T13:10:50.653
> 
> 标签：c++, visual-studio, compiler-construction

我在这段代码中遇到编译错误

```
 #include<iostream>
    #include<cstdio>
    #include<string>
    using namespace std;
    void main(int argc,char *argv[])
    {
        int i;
        for(i = 0;i<10;i++)
           fprintf(cout,"%d\n",i);
        fprintf(cout,"abc:\n");
        string s;
        cin>>s;
        if(s == "resume") { 
            for(i = 0;i<10;i++)
            fprintf(cout,"%d\n",i);
        }
   } 
```

Microsoft (R) 32 位 C/C++ 优化编译器版本 15.00.21022.08，适用于 80x86 版权所有 (C) Microsoft Corporation。版权所有。

try.cpp C:\Program Files\Microsoft Visual Studio 9.0\VC\INCLUDE\xlocale(342)：警告 C 4530：使用了 C++ 异常处理程序，但未启用展开语义。指定 /EHsc

try.cpp(9) : 错误 C2664: 'fprintf' : 无法将参数 1 从 'std::ostr eam' 转换为 'FILE *' 没有可以执行此转换的用户定义转换运算符，或者该运算符不能叫做

try.cpp(10) : 错误 C2664: 'fprintf' : 无法将参数 1 从 'std::ost ream' 转换为 'FILE *' 没有可以执行此转换的用户定义转换运算符，或者该运算符不能叫做

try.cpp(16) : 错误 C2664: 'fprintf' : 无法将参数 1 从 'std::ost ream' 转换为 'FILE *' 没有可以执行此转换的用户定义转换运算符，或者该运算符不能叫做

怎么了？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-03-13T13:17:18.080

您正在混合 C++ 和 C 输出样式。将您的 fprintfs 更改为：

```
cout << "value is: " << i << "\n"; 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-03-13T13:20:01.770

```
std::fprintf(stdout, ) 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-13T13:19:01.103

std::cout 没有 FILE* 类型。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-13T13:20:56.480

或者，将您的包含更改为：

```
#include <stdio.h>
#include <string.h> 
```

和`fprintf()`呼吁

```
fprintf(stdout,"abc:\n"); 
```

那你在说话`C`。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-13T13:17:50.247

您错误地混合了 C 和 C++。只使用 1，并坚持下去，直到您了解类型之间的区别。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-13T13:39:23.240

这是没有编译错误的代码：

```
#include <iostream>
#include <string>

int main()
{
  using namespace std;

  for(int i = 0; i < 10; i++)
    cout << i << '\n';
  cout << "abc" << endl;

  string s;
  cin >> s;
  if(s == "resume") 
    for(int i = 0; i < 10; i++)
      cout << i << '\n';

  return 0;
} 
```

# .net - 为 .Net 选择模拟框架时应该考虑什么

> ID：642620
> 
> 赞同：32
> 
> 时间：2009-03-13T13:11:13.633
> 
> 标签：.net, unit-testing, tdd, mocking

.Net 有很多模拟框架。没有明确的赢家在各个方面都取代了其他人。领先的模拟框架也有许多不同的使用*风格*。

学习所有模拟框架以决定使用哪个框架所花费的时间是不合理的。我不相信我们还没有达到可以谈论*最好的*模拟框架的阶段。那么我应该问关于项目和我自己的哪些问题，以帮助决定在特定情况下使用的最佳模拟框架？

了解您选择当前正在使用的模拟框架的原因以及您是否仍然对该选择感到满意也很有用。

在比较模拟框架的风格时，是否有有用的词汇可供使用？

（**注意：**我将这个问题限制在 .Net 上，因为 Java 没有属性或 lambda 表达式，所以我希望模拟框架对于 .Net 来说比 Java 更好）

**到目前为止的总结：**

*   如果你需要模拟静态方法，或者没有虚拟方法，那么唯一合理的选择是[TypeMock](http://typemock.com/)，但是它不是免费的，也不会推动你走向一个好的设计。
*   [如果您正在执行 TDD， Rhino Mocks](http://ayende.com/projects/rhino-mocks.aspx)是一个非常好的选择，例如，您希望模拟的对象实现接口。目前它似乎是“市场领导者”
*   如果您使用 .NET 3.5，则应考虑起订量（[介绍）起订量](http://www.codethinked.com/post/2009/03/13/Beginning-Mocking-With-Moq-3-Part-1.aspx)*可能会在 Rhino* [Mocks](http://code.google.com/p/moq/)上获得新项目

我从这个总结中遗漏了什么？

**那么，如果您使用的是 .NET 3.5，是什么推动了[Rhino Mocks](http://ayende.com/projects/rhino-mocks.aspx)和[Moq之间的选择？](http://code.google.com/p/moq/)**

* * *

也可以看看：

*   [使用什么 C# 模拟框架？](https://stackoverflow.com/questions/37359/what-c-mocking-framework-to-use)
*   [Moq 和 Rhino.mocks 的功能是什么？](https://stackoverflow.com/questions/690769/what-are-the-capabilities-of-moq-and-rhino-mocks)
*   [每个主要的模拟框架在现实世界中的优缺点是什么？](https://stackoverflow.com/questions/1718463/what-are-the-real-world-pros-and-cons-of-each-of-the-major-mocking-frameworks)

“<a href="https://stackoverflow.com/questions/1267567/what-should-i-consider-when-choosing-a-dependency-injection-framework-for-net">选择一个.NET 的依赖注入框架？” 当它问到问题的“另一面”时，它也可能很有趣。

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2009-03-13T14:42:02.650

*那么我应该通过询问项目和我自己的哪些问题来帮助决定在给定案例中使用的最佳模拟框架？*

关于该项目，您应该问的问题是：该项目是否是根据 SOLID 原则开发的？这是一个松耦合、高内聚的项目吗？在构建项目时是否使用了良好的 OO 原则？是否使用了依赖注入容器？系统是否以按合同设计的方法进行编码（彻底利用接口）？

如果您对这些问题的回答是肯定的，那么您可以使用像 RhinoMocks 这样的模拟框架，这就是某些人所说的“自以为是”的框架。RhinoMocks 和其他一些模拟框架对于如何设计系统以便模拟对象有非常强烈的意见。像 RhinoMocks 这样的框架希望您的项目以某种方式设计。当您以正确的方式构建代码（没有密封类、没有静态、大量使用接口、类上的虚拟方法等）时，使用 RhinoMocks 进行模拟肯定会容易得多

如果您对这些问题的回答是否定的，或者如果您正在处理具有许多高度耦合类的遗留系统，那么您唯一的选择就是 TypeMock，它可以模拟任何东西。

*了解您选择当前使用的模拟框架的原因以及您是否仍然满意该选择也很有用。*

我之所以选择 RhinoMocks，是因为在当时（3 年多以前），它显然是最成熟、功能最多的模拟框架。我一直在使用它，因为它已经进化了，这让我的生活变得更加轻松（AutoMocking 容器的出现是朝着效率迈出的一大步）。

除了功能集和易用性之外，我喜欢 RhinoMocks 的地方在于它引导我在代码中进行更好的设计。我不是一个完美的程序员，我会在设计上犯错误。但是像 RhinoMocks 和 NHibernate 这样的工具可以帮助我做出更好的设计，因为当我确实犯了错误并创建了糟糕的设计时，使用这些工具会变得很痛苦。例如，如果您有一个糟糕的数据库设计，那么使用 NHibernate 会很痛苦。如果你有一个糟糕的类设计，不使用接口，不使用 IoC 等等，使用 RhinoMocks 会非常痛苦。

我喜欢 RhinoMocks 因为它最终帮助我成为一个更好的开发人员，不仅仅是因为我正在测试我的代码，还因为我正在以更好的方式塑造我的代码——设计它。

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2009-03-13T14:04:40.150

我更喜欢[.NET](https://github.com/Moq/moq4) 3.5 项目的起订量。它使用简单，根据我的经验，它有助于生成干净清晰的单元测试。

您不能在同一个项目中使用多个模拟框架，没有技术原因。当然，标准化很好，但某些测试可能更适合某些框架。

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2009-04-21T16:02:19.460

免责声明——我为[Typemock工作](http://www.typemock.com)

我不同意“Typemock 不会驱使你做出好的设计”。是您，即推动设计好坏的开发人员，而不是您使用的工具。获得完成工作并提高生产力的工具，但良好设计的责任是你自己的。如果你认为在你的代码中包含所有类型的抽象只是为了测试，那就去做吧，但你可能不会想出一个“好的”设计。它可能比你现在的设计更复杂。

* * *

## 回答 #4

> 赞同：9
> 
> 时间：2011-02-18T08:22:55.507

*为 .Net 选择模拟框架时应该考虑什么*

除了要测试的代码库的设计之外，要考虑的另一个方面是使用模拟时测试的可读性。

在这方面，我对[NSubstitute](http://nsubstitute.github.com/)投了票——这是一个较新的模拟框架之一，具有非常富有表现力的 API（无 lambdas）和与 Moq 和 Rhino Mocks 相当的功能。它最近达到了 1.0 版本。

一个使用示例（来自 NSubstitute 主页）：

```
//Create:
var calculator = Substitute.For<ICalculator>();

//Set a return value:
calculator.Add(1, 2).Returns(3);
Assert.AreEqual(3, calculator.Add(1, 2));

//Check received calls:
calculator.Received().Add(1, Arg.Any<int>());
calculator.DidNotReceive().Add(2, 2);

//Raise events
calculator.PoweringUp += Raise.Event(); 
```

[这里给出了使用](http://www.richard-banks.org/2010/07/mocking-comparison-part-1-basics.html)[RhinoMocks](http://www.ayende.com/projects/rhino-mocks.aspx)、[Moq](http://code.google.com/p/moq/)和 NSubstitute的测试可读性的详细比较。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-11-05T10:17:38.930

[存根](http://research.microsoft.com/en-us/projects/stubs/)看起来很有趣，我认为它可能随 .NET V4 一起提供。我不知道开发者工作室的女巫版你需要使用它。目前您可以从上面的链接下载它。

> Stubs 是一个轻量级的框架，用于测试 .NET 中的存根和弯路，它完全基于委托、类型安全、可重构和生成的源代码。Stubs 旨在支持 Code Contracts 运行时编写器，并为 Pex 白盒分析提供最小的开销。存根可用于任何 .NET 方法，包括密封类型中的非虚拟/静态方法。

（我已将其发布为 answser 而不是将其添加到问题中，因为我从未使用过 Stabs 并且只花了几分钟时间查看它）

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-03-13T13:12:09.357

RhinoMock 几乎是 .NET 的最先进的模拟框架。不能出错。如果您愿意，我想您可以将其“风格”视为“万事通”。

从他们的[网站](http://ayende.com/wiki/Rhino+Mocks.ashx)：

Rhino Mocks 提供什么？

*   用于期望的显式记录和回放模型。
*   自然排列、动作、断言语法
*   支持 .Net 2.0 和 .Net 3.5
*   使用强类型模拟。
*   对方法设置操作、返回特定值或抛出异常。
*   预期基于：
    *   参数匹配
    *   约束匹配
    *   使用您自己的代码验证预期参数的自定义回调

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-05-03T10:37:53.807

我会推荐 FakeItEasy。这是一个真正描述性的模拟框架，允许非常容易地阅读和模拟接口。它有一个活跃的开源社区并且运行良好。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2012-06-03T18:55:38.247

我使用**Telerik JustMock**，它是一个非常专业且简单的模拟框架，具有良好的文档。

# c# - 监视器类的 C# 多线程问题 - 可能的生命锁？

> ID：642624
> 
> 赞同：1
> 
> 时间：2009-03-13T13:11:48.157
> 
> 标签：c#, multithreading, deadlock, monitor

我有一些代码，我无法正确理解。问题是程序是多线程的，其中有一些代码应该同步，所以我写了这个：

```
lock (lockObject)
{
   if (!Monitor.TryEnter(lockObject))
     Monitor.Wait(lockObject);

   //do stuff...
   Monitor.PulseAll(lockObject);
}
Monitor.Exit(lockObject); 
```

我遇到的问题是，在某个时间点，所有线程似乎都在睡觉——有人能说出原因吗？该程序一直在无休止地运行，几乎没有消耗cpu，但没有完成任何工作——在跟踪程序时，我发现在某些时候没有线程处于活动状态，但其中很多都在休眠。我知道大部分错误（如果是开发人员 - 总是）位于显示器前面 0.5m 处 - 但我自己无法弄清楚......也许在几分钟内;）

有人可以向我解释一下 - 在此先感谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-13T13:22:53.950

我假设第一个 lock 语句是一个错字，你的意思是 lock(lockObject) （小写）。

我认为你在这里对锁有点误解。代码中的 if 块永远不会是真的。原因是 lock(lockObject) 实际上扩展到以下

```
Monitor.Enter(lockObject);
try {
...
} finally{ 
Monitor.Exit(lockObject); 
```

因此，当您点击 if 块时，您已经拥有锁并且 TryEnter 应该总是成功。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-13T13:23:36.990

`LockObject`和有区别`lockObject`吗？不清楚...

然而！如果它们是不同的对象，那么首先：您不能使用您没有`Wait`的锁......并且`TryEnter`只有在您指定超时时才会返回 false。这段代码到底想做什么？

没有更多上下文，并不完全清楚`PulseAll`and`Wait`的目的是什么。例如，[在这里](https://stackoverflow.com/questions/530211/creating-a-blocking-queuet-in-net/530228#530228)它们用于在队列太满时阻塞（`Wait`），或者在空间可用时释放它（`PulseAll`）等。如果没有线程之间的完全交互，很难调试线程代码。

听起来您可能只需要：

```
lock (lockObject)
{
    // do stuff
} 
```

* * *

我可以看到两个直接的问题；首先，你总是释放你使用的锁（即异常）并不明显。尝试只使用`lock`-`Enter/Exit`它会得到它的权利。

第二; 如果所有线程都调用`Wait`......谁来唤醒它们？他们还在等**什么**？如前所述：是的，他们都会无限期地睡觉。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-13T13:25:55.097

这是一个奇怪的设置。“LockObject”和“lockObject”一样吗？或者这是一个错字？如果它们相同，那么您的设置是多余的，因为不需要在您已经锁定的东西上调用 Monitor.TryEnter。如果“LockObject”是一个不同的对象，那么为什么不将 Monitor.Exit 移到 lock 语句中呢？

# macos - 是否有类似 Microsoft 的 TechNet 或 Apple 的 MSDN 订阅？

> ID：642627
> 
> 赞同：2
> 
> 时间：2009-03-13T13:12:16.143
> 
> 标签：macos

我想测试设计为在 Mac 上运行的软件，并且需要几个操作系统版本（也是旧版本），也许还有其他 Mac 软件来设置我的（虚拟）测试机器。

对于 Windows 上的相同场景，我可以使用通过 TechNet 或 MSDN 订阅提供的许可证。在[ADC Mac 开发中心](http://developer.apple.com/mac/)，我找不到任何关于可用内容的具体信息。ADC 会员资格是否可以让我下载要测试的软件/操作系统？如果没有，有什么可用的？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-13T13:24:28.297

请记住，我不相信任何版本的 Mac OS（除了 OS X 服务器）都被许可在 VM 中使用。理论上，如果你想测试不同版本的操作系统，你需要在一个系统上进行多次安装（我的第一台 iMac 带有 OS 9 和 OS X 以这种方式安装，不确定你是否可以获得多个 OS X 版本安装在一个盒子上）或有很多盒子。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-13T13:18:15.490

是的，它确实。您可以下载操作系统以及测试版（尽管不像“适当的”测试版测试人员那么早）。

# c# - LINQ to SQL - 一对一关联的问题

> ID：642630
> 
> 赞同：3
> 
> 时间：2009-03-13T13:12:58.450
> 
> 标签：c#, linq, linq-to-sql, oop, orm

在 L2S 设计器中，我删除了一个表和一个视图。我尝试在它们的主键上添加 2 之间的关联。这应该是一对一的关系，所以我将关联的基数属性设置为这样。

但是，在编码时我无法访问子属性。

有什么建议么？

# 编辑

我刚刚在 sql server 中创建了一个视图，其中包含我想要的字段，并将其放入 L2S。简单得多。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-13T13:32:34.050

根据我的经验，Linq To SQL 需要在数据库中建立主键/外键关系。否则，您将不得不加入。

不确定这是否适用于您的情况，但它可能...

[没有显式外键关系的 Linq To SQL](https://stackoverflow.com/questions/619231/linq-to-sql-without-explicit-foreign-key-relationships)

**更新：**

看来您无需在数据库中建立主键/外键关系即可获得所需的内容。在 LinqToSQL 设计器中，在每个表的两列上设置主键。我还必须关闭我指定为主键的父表列上的自动同步。

此处描述了自动同步。 *指示公共语言运行时 (CLR) 在插入或更新操作后检索值。*

链接：http: [//msdn.microsoft.com/en-us/library/bb386971.aspx](http://msdn.microsoft.com/en-us/library/bb386971.aspx)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-10-21T15:07:18.807

我们在视图中遇到了这个问题。我们只是在 DBML 编辑器中定义了键，最后定义了属性。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-13T13:20:28.150

您是否禁用（设置为 false）子属性或父属性？

您是否可能以错误的方式映射了一对一的关系（就像我在不到一个小时前所做的那样）？

# email - 拦截 QMail SMTP 邮件

> ID：642632
> 
> 赞同：-1
> 
> 时间：2009-03-13T13:13:39.697
> 
> 标签：email, smtp, plesk, qmail

情况就是这样，我们有一个运行 Plesk 的 linux Web 服务器，我需要一种方法来拦截发送到服务器和从服务器发送的电子邮件。Plesk 使用 qmail 发送和接收电子邮件。

我们通过将邮件组添加到每个包含“archive@”地址的电子邮件地址来对接收电子邮件问题进行排序。然后我们使用 PHP 脚本读取“archive@”邮箱并将电子邮件放入 MySQL 数据库。

我目前的问题是如何捕获从服务器发送的消息。有没有人有这样做的经验？

谢谢彼得

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-13T13:51:30.433

这可以通过 QUEUE_EXTRA ( [http://www.google.com/search?q=queue_extra](http://www.google.com/search?q=queue_extra) ) 完成，您需要为此重新编译 qmail。在 plesk 上执行此操作的一些提示 ( [http://translate.google.com/translate?hl=en&sl=pt&u=http://www.maglione.com.br/artigos/artigostecnicos/pleskqextrahowto](http://translate.google.com/translate?hl=en&sl=pt&u=http://www.maglione.com.br/artigos/artigostecnicos/pleskqextrahowto) )。

# apache-flex - 如何强制用户加载新版本的.SWF flash 文件？

> ID：642636
> 
> 赞同：1
> 
> 时间：2009-03-13T13:14:33.533
> 
> 标签：apache-flex, flash

我不想重命名实际的 CODE（类），但我怎样才能重命名 .SWF 文件以及需要在哪个标签中更新这个新名称？我喜欢在名称中使用例如内部版本号。

例如 myflash2.swf

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-13T15:07:46.943

一种方法是将内部版本号添加为查询字符串：

```
myflash2.swf?build=1237 
```

但是，如果不使用构建脚本，就没有简单的方法可以做到这一点，并且假设您使用的东西比常规的 Flash 创作工具更先进一些。

我通常有一个小的 php 片段，它将服务器上文件的最后更改日期附加到末尾，以便能够轻松地将新内容发送给客户端，而无需让他们清除缓存。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-20T04:43:26.863

与前面的答案一样，我通过在检查 .swf 的修改日期的包装器中使用一点 PHP 成功地做到了这一点。这是代码...

在包装器的顶部：

```
<?php 

$appDate = filemtime("MyApp.swf");

 ?> 
```

然后当 src 变量被构建时

```
else if (hasRequestedVersion) {
// if we've detected an acceptable version
// embed the Flash Content SWF when all tests are passed
AC_FL_RunContent(
        "src", "MyApp?version=<?= $appDate ?>",
        "width", "100%",
        "height", "100%",
        "align", "middle",
        "id", "MyApp", 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-20T04:46:01.147

您还可以校验 SWF 文件并将其附加到文件名

# asp.net - 组的客户端验证

> ID：642643
> 
> 赞同：1
> 
> 时间：2009-03-13T13:16:22.733
> 
> 标签：asp.net, client-side, validation

我有几个通过 ajax 加载的选项卡，每个选项卡都有一组验证器。我只想在选项卡有效时才允许用户更改选项卡

我认为为验证器设置一个验证组，然后像这样检查特定的组，会起作用：

```
function validatePage(group) {
    return Page_ClientValidate(group);
} 
```

但是，当我调用该函数时，它总是返回 true。谁能看到我做错了什么？

我这样检查

```
alert(validatePage("presentaciones")); 
```

我有一些验证器：

```
// (...)
<asp:TextBox ValidationGroup="presentaciones" id="txtDescription" runat="server" Text='<%# Eval("Description") %>' MaxLength="50" />
<asp:RequiredFieldValidator ID="DescriptionRequiredFieldValidator" runat="server" ControlToValidate="txtDescription" SetFocusOnError="true" ValidationGroup="presentaciones" ErrorMessage="Debe ingresar una descripción" Display="Dynamic" />
// (...) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-13T13:42:49.703

我已经让组在服务器端工作，`Page.Validate(group)`但我不知道这可以在客户端完成。也许您需要实现一个自定义验证控件来检查每个选项卡的状态。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-13T14:17:22.930

我的猜测是验证脚本没有连接。在您的函数中执行 alert((typeof(Page_Validators) == "undefined")) 并查看它是否显示为 true。您说您正在通过 ajax 加载选项卡。您可能想看看在页面上的某处放置验证器是否有助于连接验证脚本。

另一件需要注意的是 Firefox 和传统渲染模式......客户端只是普通的在那种情况下不起作用。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-21T18:51:31.870

这可以在客户端完成。像这样：

```
 $('.buttonWithSameValidationGroup').bind('click', function () {
                if (Page_ClientValidate($(this).attr('validationgroup'))) {
    //do stuff
  }
}); 
```

有时您可能需要在 Page Pre_Render 方法中添加以下服务器端代码

```
button1.AddAttributes("validationgriup","group1"); 
```

# python - 如何使用 Python 的 optparse 格式化位置参数帮助？

> ID：642648
> 
> 赞同：25
> 
> 时间：2009-03-13T13:16:56.647
> 
> 标签：python, command-line, formatting, command-line-arguments, optparse

如[文档](http://docs.python.org/library/optparse.html?highlight=indentedhelpformatter#creating-the-parser)中所述，`optparse.OptionParser`使用`IndentedHelpFormatter`输出格式化选项帮助，为此我找到了一些[API 文档](http://corebio.googlecode.com/svn/tags/0.5.0/apidocs/optparse.IndentedHelpFormatter-class.html)。

**我想**在用法文本中为所需的位置参数显示类似格式的帮助文本。是否有可用于类似位置参数格式的适配器或简单的使用模式？

### 澄清

最好只使用标准库。Optparse 做得很好，除了这个格式的细微差别，我觉得我们应该能够在不导入整个其他包的情况下修复它。:-)

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2009-03-20T00:57:55.767

最好的办法是给 optparse 模块写一个补丁。同时，您可以通过稍微修改的 OptionParser 类来完成此操作。这并不完美，但它会得到你想要的。

```
#!/usr/bin/env python
from optparse import OptionParser, Option, IndentedHelpFormatter

class PosOptionParser(OptionParser):
    def format_help(self, formatter=None):
        class Positional(object):
            def __init__(self, args):
                self.option_groups = []
                self.option_list = args

        positional = Positional(self.positional)
        formatter = IndentedHelpFormatter()
        formatter.store_option_strings(positional)
        output = ['\n', formatter.format_heading("Positional Arguments")]
        formatter.indent()
        pos_help = [formatter.format_option(opt) for opt in self.positional]
        pos_help = [line.replace('--','') for line in pos_help]
        output += pos_help
        return OptionParser.format_help(self, formatter) + ''.join(output)

    def add_positional_argument(self, option):
        try:
            args = self.positional
        except AttributeError:
            args = []
        args.append(option)
        self.positional = args

    def set_out(self, out):
        self.out = out
def main():
    usage = "usage: %prog [options] bar baz"
    parser = PosOptionParser(usage)
    parser.add_option('-f', '--foo', dest='foo',
                      help='Enable foo')
    parser.add_positional_argument(Option('--bar', action='store_true',
                                   help='The bar positional argument'))
    parser.add_positional_argument(Option('--baz', action='store_true',
                                   help='The baz positional argument'))
    (options, args) = parser.parse_args()
    if len(args) != 2:
        parser.error("incorrect number of arguments")
    pass

if __name__ == '__main__':
    main() 
```

你从运行这个得到的输出：

```
Usage: test.py [options] bar baz

  Options:
    -h, --help         show this help message and exit
    -f FOO, --foo=FOO  Enable foo

Positional Arguments:
  bar  The bar positional argument
  baz  The baz positional argument 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-03-13T17:34:22.503

试着看看[argparse](https://docs.python.org/3/library/argparse.html)。文档说它支持位置参数和更好看的帮助信息。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-13T13:46:09.213

我会对这个问题的干净解决方案感兴趣；我想不出一个。OptionParser 真的完全专注于选项；据我所知，它没有给你任何使用位置参数的东西。

我所做的是为我的每个位置参数生成一个小文档块列表，使用`\t`s 来获得正确的间距。然后我用换行符加入它们，并将其附加到传递给 OptionParser 的“使用”字符串中。

它看起来不错，但感觉很傻，当然，文档最终出现在选项列表的上方。我还没有找到解决这个问题的任何方法，或者如何做任何复杂的事情，即在位置参数的描述下方描述了一组给定的选项，因为它们仅适用于该参数。

我查看了猴子修补 OptionParser 的方法，我记得（大约一年前）它不会那么困难，但我不想走那条路。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-13T13:32:27.653

大多数位置参数的帮助文本类似于 *NIX 框的手册页中经常使用的格式。看看['cp' 命令是如何记录的](http://www.linuxmanpages.com/man1/cp.1.php)。您的帮助文本应该与此类似。

否则，只要您在使用解析器时填写“帮助”参数，文档就会自行生成。

# javascript - 如何在 JavaScript 中将字符串转换为浮点数？

> ID：642650
> 
> 赞同：296
> 
> 时间：2009-03-13T13:17:20.467
> 
> 标签：javascript, parsing, floating-point

我正在尝试从数据网格中解析两个值。这些字段是数字的，当它们有逗号时（例如 554,20），我无法得到逗号后面的数字。我试过`parseInt`和`parseFloat`。我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：417
> 
> 时间：2009-03-13T13:21:13.673

如果它们是单独的值，请尝试以下操作：

```
var values = "554,20".split(",")
var v1 = parseFloat(values[0])
var v2 = parseFloat(values[1]) 
```

如果它们是一个单一的值（比如在法语中，一半写为 0,5）

```
var value = parseFloat("554,20".replace(",", ".")); 
```

* * *

## 回答 #2

> 赞同：59
> 
> 时间：2011-04-14T09:50:24.467

你有没有试过这样做？:p

```
var str = '3.8';ie
alert( +(str) + 0.2 ); 
```

+(string) 将字符串转换为浮点数。

便利！

因此，为了解决您的问题，您可以执行以下操作：

```
var floatValue = +(str.replace(/,/,'.')); 
```

* * *

## 回答 #3

> 赞同：41
> 
> 时间：2009-03-13T13:19:45.190

用点替换逗号。

这只会返回 554：

```
var value = parseFloat("554,20") 
```

这将返回 554.20：

```
var value = parseFloat("554.20") 
```

所以最后，你可以简单地使用：

```
var fValue = parseFloat(document.getElementById("textfield").value.replace(",",".")) 
```

不要忘记它`parseInt()`应该只用于解析整数（没有浮点数）。在您的情况下，它只会返回 554。此外，在浮点数上调用 parseInt() 不会对数字进行四舍五入：它将占据其下限（最接近的较低整数）。

* * *

从评论中回答 Pedro Ferreira 问题的扩展示例：

如果文本字段包含数千个分隔点，例如`1.234.567,99`可以用另一个预先消除`replace`：

```
var fValue = parseFloat(document.getElementById("textfield").value.replace(/\./g,"").replace(",",".")) 
```

* * *

## 回答 #4

> 赞同：17
> 
> 时间：2012-07-13T21:29:27.763

如果你像这样扩展 String 对象..

```
String.prototype.float = function() { 
  return parseFloat(this.replace(',', '.')); 
} 
```

..你可以这样运行

```
"554,20".float()
> 554.20 
```

也适用于点

```
"554.20".float()
> 554.20

typeof "554,20".float()
> "number" 
```

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2014-01-13T22:19:36.560

@GusDeCool 或任何其他试图替换超过一千个分隔符的人，一种方法是正则表达式全局替换：`/foo/g`。请记住这`.`是一个元字符，因此您必须对其进行转义或将其放在括号（`\.`或`[.]`）中。这是一个选项：

```
var str = '6.000.000';
str.replace(/[.]/g,","); 
```

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2016-02-25T08:56:48.660

您可以使用此功能。它将用 ' ' 替换逗号，然后它将 parseFlaot 值，然后再次调整值中的逗号。

```
function convertToFloat(val) {
        if (val != '') {
            if (val.indexOf(',') !== -1)
                val.replace(',', '');
            val = parseFloat(val);
            while (/(\d+)(\d{3})/.test(val.toString())) {
                val = val.toString().replace(/(\d+)(\d{3})/, '$1' + ',' + '$2');
            }
        }
        return val;
    } 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2020-12-24T10:31:33.690

如果有人正在寻找一种从任意字符串解析**浮点数的方法，**

可以这样做：

```
function extractFloat(text) {
  const match = text.match(/\d+((\.|,)\d+)?/)
  return match && match[0]
}

extractFloat('some text with float 5.25') // 5.25 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2015-05-03T21:50:31.343

我遇到了同样的问题，只是我事先不知道千位分隔符和小数点分隔符是什么。我最终写了一个库来做到这一点。如果您对它感兴趣，它是：[https ://github.com/GuillaumeLeclerc/number-parsing](https://github.com/GuillaumeLeclerc/number-parsing)

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2019-04-23T09:30:58.653

尝试

```
let str ="554,20";
let float = +str.replace(',','.');
let int = str.split(',').map(x=>+x);

console.log({float,int});
```

# mysql - 如何在 2 列而不是 1 列中查找重复项

> ID：642656
> 
> 赞同：125
> 
> 时间：2009-03-13T13:18:10.857
> 
> 标签：mysql, duplicates

我有一个 MySQL 数据库表，其中包含我感兴趣的两列。单独地，他们每个人都可以有重复项，但他们永远不应该有两个具有相同值的重复项。

`stone_id`只要每个`upsharge`标题不同，就可以有重复，反之亦然。但是例如说`stone_id`= 412 和`upcharge_title`= "sapphire" 组合应该只出现一次。

还行吧：

```
stone_id = 412 upcharge_title = "sapphire"
stone_id = 412 upcharge_title = "ruby" 
```

这是不行的：

```
stone_id = 412 upcharge_title = "sapphire"
stone_id = 412 upcharge_title = "sapphire" 
```

是否有一个查询可以在两个字段中找到重复项？如果可能的话，有没有办法将我的数据库设置为不允许这样做？

我正在使用 MySQL 版本 4.1.22

* * *

## 回答 #1

> 赞同：234
> 
> 时间：2009-03-13T13:20:26.967

您应该在两个字段之间设置一个复合键。这将需要每行都有一个唯一的 stone_id 和 upcharge_title。

至于找到现有的重复，试试这个：

```
select   stone_id,
         upcharge_title,
         count(*)
from     your_table
group by stone_id,
         upcharge_title
having   count(*) > 1 
```

* * *

## 回答 #2

> 赞同：36
> 
> 时间：2012-06-14T22:44:46.260

我发现使用“ALTER IGNORE”添加一个 unqiue 索引很有帮助，它可以删除重复项并强制执行听起来像您想做的唯一记录。所以语法是：

```
ALTER IGNORE TABLE `table` ADD UNIQUE INDEX(`id`, `another_id`, `one_more_id`); 
```

这有效地添加了唯一约束，这意味着您将永远不会有重复的记录，并且 IGNORE 会删除现有的重复项。

您可以在此处阅读有关 eh ALTER IGNORE 的更多信息：http: [//mediakey.dk/~cc/mysql-remove-duplicate-entries/](http://mediakey.dk/~cc/mysql-remove-duplicate-entries/)

更新：@Inquisitive 通知我，这在 MySql> 5.5 版本中可能会失败：

> 它在 MySQL > 5.5 和 InnoDB 表以及 Percona 中失败，因为它们的 InnoDB 快速索引创建功能 [ [http://bugs.mysql.com/bug.php?id=40344]](http://bugs.mysql.com/bug.php?id=40344])。在这种情况下，首先运行`set session old_alter_table=1`，然后上面的命令将正常工作

**更新 -`ALTER IGNORE`在 5.7 中删除**

从[文档](https://dev.mysql.com/doc/refman/5.6/en/alter-table.html)

> 从 MySQL 5.6.17 开始，不推荐使用 IGNORE 子句，并且它的使用会产生警告。IGNORE 在 MySQL 5.7 中被删除。

MySQL 开发人员之一提供[了两种选择](http://www.tocker.ca/2013/11/06/the-future-of-alter-ignore-table-syntax.html)：

*   按唯一字段分组并删除，如上所示
*   创建一个新表，添加一个唯一索引，使用`INSERT IGNORE`，例如：

```
CREATE TABLE duplicate_row_table LIKE regular_row_table;
ALTER TABLE duplicate_row_table ADD UNIQUE INDEX (id, another_id);
INSERT IGNORE INTO duplicate_row_table SELECT * FROM regular_row_table;
DROP TABLE regular_row_table;
RENAME TABLE duplicate_row_table TO regular_row_table; 
```

但是根据您的桌子的大小，这可能不实用

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2009-03-13T13:22:05.323

你可以找到这样的重复..

```
Select
    stone_id, upcharge_title, count(*)
from 
    particulartable
group by 
    stone_id, upcharge_title
having 
    count(*) > 1 
```

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2009-03-13T13:21:46.090

要查找重复项：

```
select stone_id, upcharge_title from tablename group by stone_id, upcharge_title having count(*)>1 
```

为了避免将来发生这种情况，请在这两个字段上创建一个复合唯一键。

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2009-03-13T13:36:04.493

顺便说一句，表上的复合唯一约束将首先防止这种情况发生。

```
ALTER TABLE table
    ADD UNIQUE(stone_id, charge_title) 
```

（这是有效的 T-SQL。不确定 MySQL。）

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2010-08-19T21:34:46.363

这篇 SO 帖子对我有帮助，但我也想知道如何删除和保留其中一行……这是一个 PHP 解决方案，用于删除重复行并保留一个（在我的情况下只有 2 列，它位于清除重复类别关联的功能）

```
$dupes = $db->query('select *, count(*) as NUM_DUPES from PRODUCT_CATEGORY_PRODUCT group by fkPRODUCT_CATEGORY_ID, fkPRODUCT_ID having count(*) > 1');
if (!is_array($dupes))
    return true;
foreach ($dupes as $dupe) {
    $db->query('delete from PRODUCT_CATEGORY_PRODUCT where fkPRODUCT_ID = ' . $dupe['fkPRODUCT_ID'] . ' and fkPRODUCT_CATEGORY_ID = ' . $dupe['fkPRODUCT_CATEGORY_ID'] . ' limit ' . ($dupe['NUM_DUPES'] - 1);
} 
```

(limit NUM_DUPES - 1) 是保留单行的原因...

谢谢大家

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2021-05-03T00:02:42.310

这对我有用（忽略 null 和空白）。两个不同的电子邮件栏：

```
SELECT * 
FROM   members 
WHERE  email IN (SELECT soemail 
                 FROM   members 
                 WHERE  NOT Isnull(soemail) 
                        AND soemail <> ''); 
```

# sql-server - 根据 SP 的结果集动态创建临时表

> ID：642666
> 
> 赞同：2
> 
> 时间：2009-03-13T13:20:04.080
> 
> 标签：sql-server, sql-server-2005, tsql

我有一个调用另一个 SP 的 SP，结果集需要过滤到我感兴趣的列。

```
DECLARE @myTable TABLE
(
  Field1 INT,
  Field2 INT,
  Field3 INT
)

--If someSP returns say 30 params and I need only 3 params, I don't want to declare all 30 in my temp table @myTable

INSERT INTO @myTable
(Field1, Field2, Field3)   
EXEC someSP          --Need to selectively filter recordset from SP
  @InputParam1 = 'test' 
```

如果我不能这样做，我想根据 someSP 的结果集动态创建临时表（这样可以在修改 someSP 以添加新参数时减轻维护问题，我也不需要修改这个过程

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-29T23:29:09.313

简短的回答：不，你不能那样做。

您必须使用将从存储过程返回的确切列数预先声明您的临时表。

解决方法是使用持久表。例如，您可以在数据库中有一个名为 someSPResults 的永久表。每当 someSP 更改为具有不同数量的输出列时，请在部署过程中更改 someSPResults 的格式。

然后你可以这样做：

```
insert into dbo.someSPresults
exec someSP 
```

或者在 someSP 中，您可以将结果直接插入到 someSPresults 表中，作为执行的正常部分。您只需确保准确识别 someSPresults 表中的哪些记录来自 someSP 的每次执行，因为该存储过程可以同时触发多次，从而将大量数据转储到 someSPresults 中。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-13T15:06:04.590

cmsjr 声明，“表变量不能成为另一个存储过程的结果集的目标。”

我也认为这是真的，但后来我测试了它。此代码适用于 2005 年和 2008 年：

```
CREATE PROCEDURE someSP (@InputParam1 varchar(100)) AS
SELECT LEN(@InputParam1), DATALENGTH(@InputParam1), @@SPID
GO

DECLARE @myTable TABLE (
    Field1 INT,
    Field2 INT,
    Field3 INT
)

INSERT INTO @myTable (Field1, Field2, Field3)   
EXEC someSP
    @InputParam1 = 'test'

SELECT * FROM @myTable 
```

我知道这适用于#temp 表，但我认为它不适用于@temp 表。

但这并不能回答 DotnetDude 的问题。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-13T13:27:27.713

表变量不能成为另一个存储过程的结果集的目标，也不能在表变量声明后对表变量执行 DDL，它们将始终具有与声明时相同的定义。临时表是您最好的选择。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-13T17:30:13.747

我可以想到两个选项，但我没有时间测试它们：将 SP 转换为用户定义函数并使用 SELECT * FROM {function} INTO {table}，或者使用 OPENROWSET：

```
SELECT *
FROM OPENROWSET('SQLOLEDB',
                'servername';'username';'password',
                'exec dbname.{owner}.yourstoredproc') AS spResult
INTO {tablename} 
```

两种解决方案都应该即时创建表，然后您可以简单地从中进行选择。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-13T18:49:58.950

根据上面的评论，我建议你考虑一个表值函数。这可以参数化，你可以这样做：

```
INSERT @foo (col1, col14, col29)
SELECT col1, col14, col29 FROM dbo.ufnTVF (@p1, @p2) 
```

否则，它是 OPENROWSET 作为“最干净的”（我松散地使用这个）解决方案

或者，您修改存储过程的结果集以仅返回您想要的列。这意味着动态 SQL 或大量 IF 语句。在某些情况下无法正确解析（使用 SET FMTONLY 等）。

您可能正在尝试针对 3rd 方应用程序或系统存储的过程进行编码（我们没有完整的详细信息），但感觉很混乱和错误。SQL Server 2005 有大量的 DMV 和目录（或目录，取决于您在大西洋的哪一边）视图，无需系统 proc 调用。

如果您试图模仿 OO 设计的某些方面（一个 proc 为每个男孩做某事），那么我不会。如果您需要一个返回 3 列 30 列的查询，请执行此操作。这将运行得更好，因为未使用的表和列将在计划中被忽略，实际上不需要包括在内。

# sql-server - 我可以从 SQL Server 中删除 sa 登录吗？

> ID：642673
> 
> 赞同：15
> 
> 时间：2009-03-13T13:20:56.480
> 
> 标签：sql-server, database, security

我是数据库领域的初学者，这个问题听起来可能太愚蠢了，但我想知道为什么有一个名为 sa 的登录名，我可以删除它吗？

我想删除它，因为它似乎在数据库服务器上有相当严重的权限！

如果重要的话，我使用的是 SQL Server Express 2008。

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2009-03-13T13:26:17.403

您不能删除该`sa`帐户，但可以[重命名和/或禁用它](http://www.andreas-kraus.net/blog/security-advise-rename-your-sql-server-2005-sa-account/)。可以说这是一种很好的做法，否则你有一个已知的用户名，攻击者可以对其发起暴力密码攻击。

只要确保如果您禁用该`sa`帐户，您就拥有另一个具有管理员权限的帐户。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-03-13T13:22:29.567

sa 是管理员帐户！不要删除它，给它一个强密码，除了数据库管理员和备份人员之外，你不提供给任何人。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-13T13:45:57.840

sa 是主管理员帐户，它是 master 数据库的所有者（保存用户角色、模式等数据），因此无法删除。

只需更改密码（我认为它是在安装过程中询问的）并创建具有更多限制权限的访客/公共帐户以用于您的应用程序，也就是不要在您的应用程序中使用 sa（您开发的应用程序）

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-13T13:52:10.400

此外，根据您的环境，您可以关闭 SQL Server 身份验证。

SQL Server 支持两种类型的身份验证 - Windows 身份验证和 SQL 身份验证 - 您可以同时启用这两种身份验证或其中一种。如果您关闭 SQL 身份验证，则只有有效的 Windows（如系统中定义）用户才能使用服务器（正常权限仍然适用，因此每个帐户也必须添加到 SQL Server，事实上有人拥有系统中的帐户并不意味着他们可以访问 SQL Server 实例）。

您可以在 Management Studio 的服务器设置中进行配置。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-06-11T11:09:53.070

永远不要这样做。要更恰当地了解，请参阅[http://blog.sqlauthority.com/2008/12/24/sql-server-disable-and-enable-user-sa/](http://blog.sqlauthority.com/2008/12/24/sql-server-disable-and-enable-user-sa/)

# asp.net-membership - .NET 会员登录 ReturnUrl 覆盖

> ID：642676
> 
> 赞同：1
> 
> 时间：2009-03-13T13:21:42.813
> 
> 标签：asp.net-membership

我想知道是否有人知道在您成功登录后覆盖页面将您带到何处的 URL 的正确/最佳实践方法。

我试过这个：

```
 protected void Login1_LoggedIn(object sender, EventArgs e)
        {
           if (Roles.IsUserInRole(Login1.UserName, "Other"))
            {
                Response.Redirect("/User/");
            }
            else if (Roles.IsUserInRole(Login1.UserName, "Administrator"))
            {
                Response.Redirect("/Admin/");

            }
        } 
```

有没有人有任何其他建议？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-13T13:43:18.033

您可以将以下元素添加到 Web.config 中。所以它只会设置在一个地方：

```
<loginRedirectByRole>
  <roleRedirects>
      <add role="Administrator" url="~/Admin/Page.aspx" />
      <add role="User" url="~/User/Page.aspx" />
  </roleRedirects>
</loginRedirectByRole> 
```

您仍然需要在代码中进行重定向 - 请参阅完整[文章](http://www.primaryobjects.com/CMS/Article97.aspx)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-13T13:28:25.107

我所做的是将它们发送到一个页面，该页面将重定向到 Init (Page_Init) 上的正确位置

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-13T13:44:41.713

```
HttpContext.Current.Response.RedirectLocation 
```

“获取或设置 HTTP 标头‘位置’中的重定向位置”

这最初由查询字符串中的“ReturnUrl”设置。

# audio - 从 mciSendString 返回的奇怪错误 - 任何人都可以帮忙吗？

> ID：642691
> 
> 赞同：0
> 
> 时间：2009-03-13T13:25:33.567
> 
> 标签：audio, mcisendstring

几个月前，我将录音添加到我正在开发的 MFC 应用程序中。结果证明这很容易，一两个小时后，代码就可以在我的 PC 和几台客户测试机器上运行（一台运行 XP，另一台运行 Vista）。然而，最近他们的一台测试机器升级了，现在录音功能无法正常工作。

开始录制的基本代码是..

```
mcierr=mciSendString("open new type waveaudio alias mysound",tmpstr,80,NULL);
mcierr=mciSendString("set mysound time format ms bitspersample 8 samplespersec 11025",tmpstr,80,NULL);
mcierr=mciSendString("record mysound",tmpstr,80,NULL); 
```

这似乎工作正常。要停止录制，请执行以下代码..

```
mcierr=mciSendString("stop mysound",tmpstr,80,NULL);
mcierr=mciSendString("save mysound C:\\filename.wav",tmpstr,80,NULL);   
mcierr=mciSendString("close mysound",tmpstr,80,NULL); 
```

发送“save mysound C:\filename.wav”指令时出现以下错误。返回的错误是..

```
MCI Error A parameter or value was specified twice.  Only specify it once. 
```

但是我在发送的内容中看不到任何错误，并且该错误没有意义。该错误是否可能是因为程序正在尝试使用 PC 不支持的格式进行录制？

谢谢你的时间

伊恩

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-02T19:30:30.980

需要更多细节才能使其正常工作。请注意`""`文件名前后的双精度：

```
mcierr=mciSendString("save mysound ""C:\\filename.wav""",tmpstr,80,NULL); 
```

这也很好：

```
mcierr=mciSendString(@"save mysound ""C:\filename.wav""",tmpstr,80,NULL); 
```

使用这些双引号，代码现在可以在我的 Windows 7 上运行。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-17T07:46:33.070

好的，我设法找到了解决方案。代码中的这一行..

```
mcierr=mciSendString("save mysound C:\\filename.wav",tmpstr,80,NULL); 
```

在我的运行 XP 的开发 PC 上运行良好，但在一些运行 XP 的测试 PC 和所有运行 Vista 的 PC 上会导致错误。但是，如果将文件名本身放在像这样的引号内，错误就会消失。

```
mcierr=mciSendString("save mysound "C:\\filename.wav"",tmpstr,80,NULL); 
```

现在，该代码在所有经过测试的 XP 和 Vista PC 上运行良好。

伊恩

# tfs - 为什么将 Visual Studio 解决方案添加到 TFS 时空文件夹会消失？

> ID：642695
> 
> 赞同：3
> 
> 时间：2009-03-13T13:26:37.513
> 
> 标签：tfs, directory

我有这个 Visual Studio 解决方案，其中包含一个项目，该项目具有一个由几个空文件夹组成的模板文件夹树。当我使用“Source Control -> Add Solution to Source Control”菜单项将此解决方案添加到 Team Foundation Server (TFS) 时，它不会将空文件夹添加到 TFS 存储库！当从 TFS 下载代码时，我真的需要这些文件夹。

现在，我知道我可以使用源代码管理资源管理器创建文件夹结构，但是由于整个项目是在 Visual Studio 中管理的，因此以单独的方式创建这些文件夹感觉有点不对。

是否需要调整一些设置，以便 Visual Studio 也会为空项目文件夹创建 TFS 文件夹？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-03-13T13:36:10.203

显然这是一个功能，而不是一个错误：

> “在将文件添加到源代码控制中，我们不支持添加空文件夹，但在我们的研究中，我们的用户更喜欢 SCE 工具栏按钮来实际创建他们的空树结构，而不是转到文件系统，在那里执行然后添加到源头控制。”

[http://connect.microsoft.com/VisualStudio/feedback/ViewFeedback.aspx?FeedbackID=119974](http://connect.microsoft.com/VisualStudio/feedback/ViewFeedback.aspx?FeedbackID=119974)

在 TFS2008 中，您可以将文件夹从 Windows 资源管理器拖放到源代码管理资源管理器中，并在签入时创建空子文件夹。不确定这是否适用于 TFS2005，我没有方便的实例来测试它 - 任何人？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-03T10:20:46.917

拖放文件夹在 TFS 2008 上对我有用，尽管它在 TFS 2005 上不起作用。

# user-interface - 从 Windows 服务中编写 GUI 脚本？

> ID：642698
> 
> 赞同：1
> 
> 时间：2009-03-13T13:27:18.947
> 
> 标签：user-interface, windows-services, automation, autoit

我想自动化一个仅作为 GUI 应用程序提供的 Windows 应用程序（不支持命令行）。[AutoIt](http://www.autoitscript.com/)的自动化本身相对简单。

然而，我想知道，是否可以使用 Windows 服务（只需调用 AutoIt 脚本）启动 Windows 应用程序？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-13T13:36:39.970

即使 Auto-it 可以与 UAC 一起使用，您很可能会遇到会话隔离问题 - 即服务和桌面不会混合并相互发送消息，除非明确编码通过它。

所以这是可能的，但也不是小菜一碟。

您可能想看看：[从服务以交互方式启动 .Net winforms 应用程序](https://stackoverflow.com/questions/564829/launching-a-net-winforms-application-interactively-from-a-service/564874#564874)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2011-10-06T04:09:43.573

尽管由于与最新版本的 Windows 中的 Session 0 隔离相关的复杂性，根本不建议这样做，但 AutoIt 脚本当然可以从 Windows 服务中调用。[有关从 Windows 服务调用时按预期工作的一些示例脚本，](http://www.coretechnologies.com/products/AlwaysUp/AutoIt/)请参阅此页面。

不幸的是，并非所有 AutoIt 功能似乎都可以在 Session 0 中工作。我们遇到了“Win*”例程（WinActivate、WinExists）的问题，因此您应该尽可能避免使用这些例程。而且由于文档没有突出显示有问题的功能，因此请务必彻底测试！

# java - Java 在单独的机器上写入/读取文件的最佳方式？

> ID：642706
> 
> 赞同：0
> 
> 时间：2009-03-13T13:28:36.230
> 
> 标签：java, windows, solaris, admin

我们有一个在 Sun Solaris 上运行的 Java 应用服务器。我们现在需要能够向/从运行 WindowsXP 的单独机器写入文件和读取文件。这 2 台机器由同一​​防火墙内的 2 个独立组管理。如果更容易，我们可以使用 Java 将文件写入 Solaris，然后使用一些 3rd 方程序将文件移入/移出 Windows 机器。

处理这个问题的最佳方法是什么？

还有一条信息：我们的团队管理着 Solaris 机器，如有必要，我们可以向该机器添加软件。但试图让另一组人在 Windows 机器上添加任何软件将是一个很大的痛苦。所以我更喜欢不需要在 Windows 机器上安装任何东西的解决方案。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-13T13:34:32.627

可能最简单的方法是在 windows 机器上设置一个共享并使用 Samba 将其挂载到 Solaris 机器上。然后，您的 Java 应用程序将看到该目录，就像文件系统上的任何其他本地目录一样。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-13T13:33:39.617

[使用Rsync](http://samba.anu.edu.au/rsync/)之类的工具同步机器的数据存储/文件系统（文件夹）

> > [在 Windows 机器上安装 ssh 和 rsync：极简方法](http://optics.ph.unimelb.edu.au/help/rsync/rsync_pc1.html)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-13T13:34:31.223

如果您不想更改您的应用程序，您可以使 Windows XP 系统上的文件在操作系统级别的 Solaris 系统上可用，这样您的应用程序就可以像处理本地文件一样使用 XP 系统上的文件。

您可以通过两种方式做到这一点：

1.  使用[适用于 Unix 的 Windows 服务](http://technet.microsoft.com/en-us/interopmigration/bb380242.aspx)在 Windows XP 系统上创建一个 NFS 共享，您可以在 Solaris 系统上正常挂载该共享。
2.  创建一个普通的 Windows 共享并使用[Samba](http://us3.samba.org/samba/)将其安装在 Solaris 系统上。

但是，这两个选项都需要在其中一个系统上安装额外的软件，因此可能不实用。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-13T13:35:24.590

安全的 FTP 服务器/客户端和[Apache Commons VFS](http://commons.apache.org/vfs/filesystems.html)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-13T13:38:30.213

我在机器之间移动文件的首选是`scp`（通过 SSL 进行远程文件复制）。[PuTTY](http://www.chiark.greenend.org.uk/~sgtatham/putty/)中有一个 Windows 版本。大概有一个Java库可以在某处执行 scp 。

# bash - 使用 netcat 编写 HTTP 标头请求脚本

> ID：642707
> 
> 赞同：20
> 
> 时间：2009-03-13T13:28:45.713
> 
> 标签：bash, echo, netcat

我正在尝试使用 netcat 来了解有关 HTTP 工作原理的更多信息。我想用 bash 或 Perl 编写其中的一些脚本，但我在测试的早期就遇到了一个绊脚石。

如果我直接从提示符运行 netcat 并输入 HEAD 请求，它会起作用，并且我会收到我正在探测的 Web 服务器的标头。

这有效：

```
    [romandas@localhost ~]$ nc 10.1.1.2 80
    头/HTTP/1.0

    HTTP/1.1 200 正常
    MIME 版本：1.0
    服务器：已编辑
    内容长度：0
    缓存控制：公共
    过期：2050 年 1 月 1 日星期六 18:00:00 GMT

    [romandas@localhost ~]$
```

但是，当我将相同的信息放入文本文件并通过管道或重定向将其提供给 netcat 以准备编写脚本时，它不会返回标头。
文本文件由 HEAD 请求和两个换行符组成：

```
头/HTTP/1.0

```

**通过echo**或**printf**发送相同的信息也不起作用。

```
$ printf "HEAD / HTTP/1.0\r\n"; |nc -n 10.1.1.2 80
$ /bin/echo -ne 'HEAD / HTTP/1.0\n\n' |nc 10.1.1.2 80
```

任何想法我做错了什么？不确定是 bash 问题、echo 问题还是 netcat 问题。

我通过 Wireshark 检查了流量，成功的请求（手动输入）在第二个数据包中发送尾随换行符，而 echo、printf 和文本文件方法将换行符保留在同一个数据包中，但我不确定是什么原因这种行为。

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2009-03-13T13:34:25.620

您需要两批“\r\n”，并告诉 netcat 等待响应。`printf "HEAD / HTTP/1.0\r\n\r\n" |nc -n -i 1 10.1.1.2 80`或类似的应该工作。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2012-01-23T23:09:20.700

另一种方法是使用所谓的“heredoc”约定。

```
$ nc -n -i 1 10.1.1.2 80 <<EOF
> HEAD / HTTP/1.0
>
> EOF 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2015-11-10T18:08:26.253

让 nc 等待响应的另一种方法是在输入中添加睡眠。例如

```
(printf 'GET / HTTP/1.0\r\n\r\n'; sleep 1) | nc HOST 80 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2016-07-07T05:37:50.200

您可以使用下面的 netcat 命令来创建您的实例网络服务器：

```
MYIP=$(ifconfig eth0|grep 'inet addr'|awk -F: '{print $2}'| awk '{print $1}')
while true; do echo -e "HTTP/1.0 200 OK\r\n\r\nWelcome to $MYIP" | sudo nc -l -p 80 ; done& 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2016-10-05T07:44:59.030

这条线也可以等效地工作：

```
echo -e "HEAD / HTTP/1.1\nHost: 10.1.1.2\nConnection: close\n\n\n\n" | netcat 10.1.1.2 80 
```

# iphone - iPhone SDK：上传图片到 TwitPic.com

> ID：642709
> 
> 赞同：1
> 
> 时间：2009-03-13T13:29:11.937
> 
> 标签：iphone, objective-c

有什么方法可以将选定的图像上传到 TwitPic.com 并获取图像页面 URL？

这是 TwitPic.com 的 API 页面：

[http://twitpic.com/api.do](http://twitpic.com/api.do)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-13T13:39:22.240

API 表明它在 XML 文档中返回 URI。您可以使用[NSURLRequest](http://developer.apple.com/DOCUMENTATION/Cocoa/Reference/Foundation/Classes/NSURLRequest_Class/Reference/Reference.html)发布图像数据，并使用[NSXMLParser](http://developer.apple.com/documentation/Cocoa/Reference/Foundation/Classes/NSXMLParser_Class/Reference/Reference.html)获取结果 URL。

# tsql - 电子商务的 SQL 事务？（应用程序使用 .Net 3.5）

> ID：642711
> 
> 赞同：0
> 
> 时间：2009-03-13T13:29:27.240
> 
> 标签：tsql, .net-3.5

我有一个我正在处理的应用程序需要使用事务。我熟悉它们的工作方式，但需要一些关于当前实现的建议。这是场景...

用户正在我们系统中的一个项目上工作。为了在我们的系统上发布项目，他们必须先支付一些费用才能发布项目。当用户单击发布时，他们将被带到购物车。购物车有两个行项目。行项目代表与发布相关的成本。付款完成后，我运行我的存储过程来更新项目并插入带有详细信息的订单。我目前如何拥有它不在交易中。我有 3 个独立的 SP 来处理流程。首先更新项目数据，然后插入一个订单，然后我使用订单插入生成的ID插入数据作为明细。我目前正在遍历购物车并分别执行每个细节插入。

我开始创建一个可以执行所有存储过程的存储过程，但是我对如何处理订单行项目或详细信息感到困惑。

将所有这些任务捆绑到一个事务中的好的解决方案是什么？

谢谢

丹尼尔

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-13T13:35:40.300

System.Transactions 是要走的路[http://msdn.microsoft.com/en-us/library/ms973865.aspx](http://msdn.microsoft.com/en-us/library/ms973865.aspx)

您可以将操作包装在 using 语句中，然后如果出现任何问题，您只需不提交事务 - 非常非常简单

# php - 如何将变量传递给 PHP 类中包含的文件？

> ID：642715
> 
> 赞同：0
> 
> 时间：2009-03-13T13:31:00.887
> 
> 标签：php, templates, variable-assignment

因此，我正在开发自己的小型 MVC 框架作为学习练习。它工作得很好，但我希望能够在没有 $this 的情况下在我的视图文件中引用变量。

因此，例如，我有一个实例化视图对象的控制器对象。从控制器我将变量传递给这样的视图

```
$this->view->foo = "bar"; 
```

然后视图对象包含视图的相关代码（例如：myView.phtml）。所以要访问视图文件中的“foo”，我使用这个

```
echo $this->foo; 
```

但是我想做的是，我不知道这是否可能，或者我是否遗漏了一些明显的东西，但我想做的是引用这样的变量

```
echo $foo; 
```

如果没有我发布整个源代码，有人能指出我正确的方向吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-13T13:37:33.413

您可以编写一些代码来解析您的 html 视图输入并自动将您的条目从 $foo 或 [foo] 修改为 $this->foo。

所以你可以在你的 html 视图中放这样的东西：

```
<p>[foo]</p> 
```

然后让一些视图代码解析文件并将 [foo] 的所有实例更改为 $this->foo 的值。所以你的输出变成：

```
<p>I'm the foo value</p> 
```

或者，您可以使用[Smarty](http://www.smarty.net/)之类的东西——它会为您做到这一点，并且还有许多其他使用它的理由。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-13T13:46:19.697

你试过[提取](http://php.net/manual/en/function.extract.php)吗？您必须添加一个方法来将所有变量放入一个数组中。唯一真正的限制是这使变量只读。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-13T13:48:37.490

如果您希望视图对象中的每个变量在视图中都可用，您可以将变量添加到视图对象的属性中，该属性是一个数组，然后使用[extract()](http://us.php.net/extract)使它们可用：

```
$this->view->variables['foo'] = 'bar';

extract($this->view->variables); // now $foo = 'bar'; 
```

我不是 extract() 的忠实拥护者，但这会完成你正在寻找的东西。

# svn - 为什么 svn import 不起作用？

> ID：642719
> 
> 赞同：1
> 
> 时间：2009-03-13T13:32:44.067
> 
> 标签：svn, macos, version-control

我在 Mac OS X 10.5.6 上进行了颠覆设置。当我做

```
svn import myproject file:///library/subversion/myproject/trunk -m "initial import"

Committed revision 2. 
```

什么都没发生。我回到命令提示符并且没有导入任何文件。有什么建议么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-14T04:24:33.190

这不是答案，但我不能坚持评论。（如果版主有更好的方法，请告诉我）。

这是我为第二个帐户所做的步骤，效果很好。repo、repo2 和 testdocs 位于根文件夹中。

登录用户帐户打开终端并....

```
MacBook:/ usera$ svnadmin create repo2
MacBook:/ usera$ chmod -R a+rwX repo2
MacBook:/ usera$ cd testdocs
MacBook:testdocs usera$ svn import file:///repo2 -m "initial import"
Adding         questions.rtf
Adding         UsingStatement.txt
Adding         questions2.txt
Adding         iPhone.rtf

Committed revision 1.
MacBook:testdocs usera$ 
```

然后我在 svnX 中打开 repo2。所有文件都在那里。我注销用户并登录到我的帐户。我已经完成了上述操作，但使用了“repo”。这些是我已经发布的结果，显示导入不起作用。我用 svnX 打开 repo2。所有文件都还在。我用 svnX 打开 repo。没有文件。为什么它在一个帐户中有效，而在另一个帐户中无效？

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-13T13:42:04.463

您确定吗？它说[导入](http://svnbook.red-bean.com/en/1.5/svn.tour.importing.html#svn.tour.importing.import)已提交...尝试结帐！（并阅读这[本书](http://svnbook.org)：）

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-13T13:41:24.357

你期待发生什么？myproject 中的文件（如果有）将被添加到存储库中。myproject 本身不会有任何变化 - 要获得工作副本，您需要进行结帐。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-13T14:46:51.017

欲了解更多信息，请参阅此处的 svn 电子书！-> [http://svnbook.red-bean.com/en/1.5/svn-book.pdf](http://svnbook.red-bean.com/en/1.5/svn-book.pdf)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-13T14:59:47.850

在提交之前，您需要告诉 SVN 要将当前目录中的哪些文件添加到存储库中。

```
svn add [filename] 
```

- 编辑

OK 快速课程

导航到您希望成为存储库“工作副本”的目录。

```
SVN CHECKOUT [my_repository_address] 
```

创建要添加到存储库的文件，然后添加它们

```
SVN ADD [my_file] 
```

将您的更改提交回存储库

```
SVN COMMIT 
```

完成后，请阅读可在线免费获得的 SVN 书籍：http: [//svnbook.red-bean.com/en/1.5/index.html](http://svnbook.red-bean.com/en/1.5/index.html)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-13T13:37:31.073

您应该导入到：

```
file:///Library/... 
```

不是

```
file:///library/... 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-12-01T10:51:45.707

用户权限？您可能无权访问重现文件。

# sql-server - 将行批量插入 sql server 的最快方法

> ID：642724
> 
> 赞同：9
> 
> 时间：2009-03-13T13:33:51.427
> 
> 标签：sql-server, sql-server-2008

通过 Web 服务，远程计算机将发送一组行以插入到我们的中央 sql 服务器中。

插入这些行的最佳方法（性能方面）是什么？每次可以插入 50-500 行。

我知道我可以进行批量插入或将数据格式化为以这种方式插入的 XML，但我以前从未在企业环境中这样做过。

**使用 wcf Web 服务（或者可能还不确定）和 SQL Server 2008 标准进行**更新。****

 *** * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-03-13T13:36:42.840

除非你在一台 10 年前的计算机上运行，​​否则 50-500 行并不是很多；您可以直接发送 SQL 语句并将它们直接通过管道传输到数据库中并获得出色的性能。当然，假设您信任向您发送数据的服务:-)

如果性能确实是一个问题，那么通过 bcp 文件发送绝对是在数据库中阻塞数据的最快方法。从你的问题听起来你已经知道如何做到这一点。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-03-13T13:38:23.833

仅仅 50-500 条记录并不构成“批量插入”。批量插入机制专为真正大量导入数据而设计，这些数据将立即进行备份。

在 Web 服务中，我只需将 XML 传递到 SQL 服务器。细节将取决于版本。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-03-13T13:36:07.303

这是什么类型的网络服务？

如果是 .Net，通常最好的方法是将输入加载到 DataTable 中，然后使用[SqlBulkCopy](http://msdn.microsoft.com/en-us/library/system.data.sqlclient.sqlbulkcopy.aspx)类将其上传到 SQL 服务器

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-03-13T13:37:51.930

50-500 行应该不是问题！无需进行性能调优！在您的应用程序中执行普通（准备好的）SQL 语句。

不要用复杂性和过度设计来扼杀它。

当您应该插入超过 250.000 行时，您应该考虑缩放！

不要关闭约束，您可能会杀死数据库。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-03-13T13:50:35.503

为了回应所有其他答案，500 行对于 SQL 服务器来说是没有问题的。如果确实需要插入大量记录，最快的方法是使用名为 BulkInsert 的内置存储过程，

[批量插入](http://msdn.microsoft.com/en-us/library/ms188365.aspx)

其中（我相信）是专门为此设计的 SQL Server 实用程序的入口点，称为 bcp.exe

[bcp](http://msdn.microsoft.com/en-us/library/ms162802.aspx)

# wcf - 如何编写可以将图像数据发布到的 WCF REST 服务？

> ID：642734
> 
> 赞同：1
> 
> 时间：2009-03-13T13:35:49.753
> 
> 标签：wcf, rest, image, post

我一直在寻找有关如何编写允许将图像数据发布到的 WCF REST 服务的示例。我可能遗漏了一些东西（我通常是），但有人知道该怎么做吗？是否像从 WCF REST 服务中获取 HTTP 请求并提取二进制数据一样简单？如果是这样，有没有关于如何做到这一点的例子？我可以使用 WebOperationContext.IncomingRequest 做到这一点吗？

或者，有没有办法做这样的事情......

```
[ServiceContract]
public interface IImage
{
    [OperationContract]
    [WebInvoke(
        Method = "POST",
        UriTemplate = "/images")]
    void StoreImage(byte[] imageData);
} 
```

有任何想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-18T13:45:20.690

[这篇文章](http://blogs.msdn.com/carlosfigueira/archive/2008/04/17/wcf-raw-programming-model-receiving-arbitrary-data.aspx)或多或少是我正在寻找的答案。

# sharepoint - 使用活动目录用户名作为过滤器的共享点中的自定义数据库查询

> ID：642738
> 
> 赞同：0
> 
> 时间：2009-03-13T13:36:30.093
> 
> 标签：sharepoint, active-directory, filter, performancepoint

我在数据库中有一个自定义查询，我想通过 performancepoint webpart 在 MOSS 中向用户显示该查询。

我需要根据登录用户的用户名过滤报告。如何将 AD 用户名传递给 performancepoint webpart？

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-25T03:42:05.793

您需要将 web.config 文件（PPS 网站以及任何使用 PPS webpart 的 SharePoint 网站）中的 BPM.ServerConnectionPerUser 属性更改为 True。在你这样做之后做一个 IISReset，你应该很聪明。

原因是 PPS 的默认行为是使用应用程序池标识来访问所有数据源，如果您的源是多维数据集，这是一场噩梦（成员级别的安全性发生了什么？！？）。幸运的是，将 ServerConnectionPerUser 属性更改为 True 可以实现这一点。尼克巴克莱在他关于这个主题的[博客文章中很好地阐述了这一点。](http://nickbarclay.blogspot.com/2008/01/pps-data-connection-security-with.html)

干杯，
埃里克

# visual-studio - 在 Visual Studio 2005 中保存时格式化源代码

> ID：642741
> 
> 赞同：4
> 
> 时间：2009-03-13T13:37:09.547
> 
> 标签：visual-studio, code-formatting

我希望 Visual Studio 每次保存时都格式化我的源代码。我可以在 Eclipse 中做到这一点。可以在 Visual Studio 2005 中完成吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-13T13:40:56.777

可以使用 VS.NET 的 Powercommands 插件，但是，我担心这个插件仅适用于 VS.NET 2008。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-03-13T13:49:59.233

你可以用宏来做到这一点。

这是宏的代码，可以映射到工具栏中的按钮和/或键盘快捷键

```
Public Module SaveAndFormat
    Sub SaveAndFormat()
        DTE.ExecuteCommand("Edit.FormatDocument")
        DTE.ActiveDocument.Save()
    End Sub
End Module 
```

# string - 在查询字符串值中使用的分隔符

> ID：642758
> 
> 赞同：25
> 
> 时间：2009-03-13T13:41:34.543
> 
> 标签：string, query-string, delimiter

我需要接受查询字符串中的文件名列表。IE：

```
http://someSite/someApp/myUtil.ashx?files=file1.txt|file2.bmp|file3.doc 
```

你对使用什么分隔符有什么建议吗？

* * *

## 回答 #1

> 赞同：29
> 
> 时间：2013-01-09T07:48:47.370

多次使用查询参数是合法的，并且是保证在所有情况下都没有解析问题的唯一方法：

```
http://someSite/someApp/myUtil.ashx?file=file1.txt&file=file2.bmp&file=file3.doc 
```

`;`如果分号是文件名的一部分（变成），则分号必须是 URI 编码的`%3B`，但如果它用于分隔查询参数（这是它的保留用途）则不是。

[请参阅此 rfc](https://www.rfc-editor.org/rfc/rfc3986)的第 2.2 节：

> 2.2\. 保留字符
> 
> URI 包括由“保留”集中的字符分隔的组件和子组件。这些字符被称为“保留”，因为它们可能（或可能不）被通用语法、每个特定于方案的语法或 URI 的解引用算法的特定于实现的语法定义为分隔符。如果 URI 组件的数据与保留字符作为分隔符的用途发生冲突，则必须在形成 URI 之前对冲突数据进行百分比编码。
> 
> ```
>  reserved    = gen-delims / sub-delims
> 
>  gen-delims  = ":" / "/" / "?" / "#" / "[" / "]" / "@"
> 
>  sub-delims  = "!" / "$" / "&" / "'" / "(" / ")"
>              / "*" / "+" / "," / ";" / "=" 
> ```

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2009-03-13T14:08:34.043

如果它们是文件名，一个不错的选择是文件名中不允许使用的字符。迄今为止所包含的建议`, | &`通常在文件名中被允许，因此可能会导致歧义。`/`另一方面，通常是不允许的，即使在 Windows 上也是如此。它在 URI 中是允许的，并且在查询字符串中没有特殊含义。

例子：

`http://someSite/someApp/myUtil.ashx?files=file1.txt|file2.bmp|file3.doc`不好，因为它可能引用了有效的文件`file1.txt|file2.bmp`。

`http://someSite/someApp/myUtil.ashx?files=file1.txt/file2.bmp/file3.doc`明确指 3 个文件。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2009-03-13T13:50:37.033

我建议让每个文件都有自己的查询参数，即

```
myUtil.ashx?file1=file1.txt&file2=file2.bmp&file3=file3.doc 
```

这样你就可以使用标准的查询解析和循环

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2009-03-13T13:52:03.927

您是否需要将文件名列为字符串？大多数语言都接受查询字符串中的数组，所以你可以这样写

```
http://someSite/someApp/myUtil.ashx?files[]=file1.txt&files[]=file2.bmp&files[]=file3.doc 
```

如果没有，或者由于其他原因您不能使用，您应该坚持使用文件名中不允许或不寻常的分隔符。管道 (|) 是一个很好的选择，否则您可以对不可见的字符进行 urlencode，因为它们在编码中很容易使用，但实际上很难包含在文件名中。

我通常尽可能使用数组，否则使用管道。

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2009-03-13T13:47:02.690

我一直使用双管“||”。除了 10 年的 Web 编程之外，我没有任何好的证据来支持为什么这是一个不错的选择，而且它从来都不是问题。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2016-01-25T17:00:47.723

这是一个常见的问题。我的处理方式是：我创建了一个接受字符串列表的方法，然后找到了一个不在任何字符串中的字符。（我通过简单的字符串连接来完成此操作，然后测试各种字符。）一旦找到一个字符，将所有字符串连接在一起，但也在字符串前面加上分隔字符。所以在给定的问题中，一个例子是： [http://someSite/someApp/myUtil.ashx?files=|file1.txt|file2.bmp|file3.doc](http://someSite/someApp/myUtil.ashx?files=|file1.txt|file2.bmp|file3.doc) 另一个例子是： [http://someSite/someApp/ myUtil.ashx?files=,file1.txt,file2.bmp,file3.doc](http://someSite/someApp/myUtil.ashx?files=,file1.txt,file2.bmp,file3.doc) 但是因为我实际上使用了一种方法来保证我的分隔符不在其余的字符串中，所以它是安全的。第一次创建有点工作，但我已经在各种应用程序中多次使用它。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-03-13T13:46:30.820

我想我会考虑使用逗号或分号。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2012-12-21T16:56:26.610

我会在 MSalters 回答的基础上说，概括地说，最好的分隔符是对列表中的项目无效的分隔符。例如，如果您的列表是价格，则逗号是不好的分隔符，因为它可能与值混淆。出于这个原因，正如大多数这些答案所暗示的那样，我认为一个好的通用分隔符可能是“|” 因为它很少是有效值。“/”通常可能不是最好的分隔符，因为它有时对路径有效。

# c# - 控件的命名约定

> ID：642759
> 
> 赞同：39
> 
> 时间：2009-03-13T13:41:38.443
> 
> 标签：c#, .net, naming-conventions

Microsoft 在其网站（[此处](http://msdn.microsoft.com/en-us/library/xzf533w0(VS.71).aspx)）上有命名指南。我还有《框架设计指南》一书。

我找不到关于命名控件的指南。

例如，一个按钮，当拖放到一个表单时，获取类型名 + 数字，驼峰大小写作为默认名称，例如“button1”。

这就是我所做的：我删除数字并在之后添加有意义的描述。例如“buttonDelete”或“buttonSave”。

这样，您不必在某处的指南中维护大量控件及其缩写名称。

你同意？

* * *

## 回答 #1

> 赞同：29
> 
> 时间：2009-03-13T15:00:29.847

***警告：****以下内容更针对**WinForm/WPF**开发。Patrick Peters 正确地指出，在处理 ASP.NET 控件时存在带宽/性能问题。*

这里没有真正的标准，我相信这是因为它是最**随意的命名场景**之一。在大多数情况下，控件是类私有的，并且仅在事件处理程序中少量使用。

像其他回答者一样，我也**曾经花费大量时间“修复”控件名称**。我会做诸如“btnSave”、“tbxName”（用于 TextBox 的 tbx）之类的事情。但是，当向其他人解释我的方案时，我意识到这是多么随意。“cbx”是组合框还是复选框？

这使我重新审视了设计师自动执行的操作，并意识到如果让设计师完成工作，我可以清晰、一致、快速地命名控件。它实际上与问题海报的建议非常相似：

我用控件的语义替换控件号。因此“button1”（设计器默认）将是“buttonSave”，而“listBox3”将成为“listBoxWidgets”。如果只有一个该类型的控件，**我只需删除数字**：“errorProvider1”变为“errorProvider”。

**那么这如何更好呢？**

*   如果它是一个内部变量，那么精心**“修复”变量名是浪费时间**
*   如果它缩短了一大堆东西，你的命名方案**可能会模棱两可（CheckBox 与 ComboBox）**
*   设计师提供了一个良好、一致的起点，易于（且快速）进行专业化
*   使用 Intellisense 时变量名的**长度无关紧要**
*   控件名称以它们的类型开头时可以很好且直观地分组（在 Intellisense 中）。当您的表单上有 15 个 TextBox 时，您只需首先记住您想要一个 TextBox ，输入“textBox”，然后从列表中选择名称。
*   任何不熟悉您的“方案”的人都可以立即看到它并比其他任何东西更快地采用它。
*   提供有用的控件名称非常快……只需很少的键盘/鼠标操作即可执行此操作……如此高的生产力和直观的结果。有什么不喜欢的？

PS。这是一个关于自行车棚的问题，但是因为我可以画自行车棚，所以我继续参加了讨论。;)

* * *

## 回答 #2

> 赞同：27
> 
> 时间：2009-03-13T17:04:00.937

以下是一些常见的：

```
frm  Form
mnu  Form menu
cmd  Command button
chk  Check button
opt  Radio button
lbl  Text label
txt  Text edit box
pb   Picture box
pic  Picture
lst  List box
cbo  Combo box
tmr  Timer 
```

A longer list is at *[INFO: Object Hungarian Notation Naming Conventions for VB](http://support.microsoft.com/kb/173738)*.

* * *

## 回答 #3

> 赞同：22
> 
> 时间：2009-03-13T13:53:25.170

我没有这样的约定，但我确实尝试使用名称的“类型”部分非常广泛。例如按钮、链接按钮、图像按钮往往被命名为“somethingButton”。组合框、单选按钮列表都以“somethingSelector”结尾。文本框和日历是 'somethingInput'。这样我就可以粗略地了解它是什么类型的控制，而无需将名称与实际实现联系起来。如果我决定用下拉列表替换选项按钮组，则无需重命名！

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-03-13T13:49:11.687

我有一段时间不做 WinForms，但我做的是两件事。

*   取消选中标签等内容的“生成成员”（或无论如何调用它）。基本上确保我只保留我需要的东西作为字段。
*   对于我需要的人，设置描述性名称。如有必要，*附加*控件的名称（即 saveButton）。如果我不想添加控件名称添加任何值，我不会附加“按钮”并将名称简单地保留为“保存”。

基本上大多数时候我根本不会为保存按钮创建一个成员。（如果您有一些保存逻辑，您仍然只能让 OnSaving 事件处理程序订阅按钮的 Click 事件）。

[https://msdn.microsoft.com/en-us/library/ms233630(v=vs.110).aspx](https://msdn.microsoft.com/en-us/library/ms233630(v=vs.110).aspx)

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-03-13T13:46:34.720

是的，改变那些名字

为了我：

*   `Button btnDescription`

*   `TextBox txtDescription`

*   `ComboBox cboDescription`

ETC...

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-03-13T13:59:04.720

当涉及到各种约定时，GUI 编程就成了短板。有关我用于命名的准则，请参阅我[对另一个问题的回答。](https://stackoverflow.com/questions/440163/textboxemployeename-vs-employeenametextbox/442897#442897)

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-03-13T13:45:59.727

是的，您需要任何变量的有意义的标识符 - 控制与否 - 默认名称只是因为您的 IDE 对您的问题域一无所知，因此不能总是“猜测”一个更好的名称。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-03-13T14:40:01.750

我可能是最后几个仍然使用匈牙利符号的人之一。我知道IDE可以告诉您变量类型的论点，但是当我在Notepad ++中编码或查看打印输出时，这对我没有帮助......无论如何，我使用“btnSave”，“cbOptions”， “txtFirstName”、“lblTitle”、“ddlCardType”等... IDE。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-03-13T13:44:55.830

是的，我完全同意（但我将其重命名为 ButtonDelete），因此在我的情况下，小写名称用于变量 :)

就个人而言，我认为只要您保持一致，即使其他人正在阅读您的代码，您也不会遇到问题。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-03-13T13:45:25.470

我不确定，但我认为[Windows 窗体](http://en.wikipedia.org/wiki/Windows_Forms)中的控件命名是我可以看到使用[Hungarian notation](http://en.wikipedia.org/wiki/Hungarian_notation)的唯一地方之一。所以我觉得你很好。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-03-13T13:48:57.130

我相信当前的想法不赞成在名称中包含控件类型。我倾向于将它们视为我正在使用的另一个对象并遵循相同的命名约定。

当然要使用有意义的命名，这是不言而喻的 :) 但是，归根结底，如果您在几个月后重新访问代码时您的命名约定仍然对您有意义，那么我可能会坚持使用它。

* * *

## 回答 #12

> 赞同：-1
> 
> 时间：2009-03-13T14:46:34.653

[这](http://doquocduy.wordpress.com/2008/05/16/c-naming-convention/)就是我们正在使用的

简而言之，我们在控件前面加上控件的缩写。IE

按钮 = btnDelete、btnSubmit、btnReturn

文本框 = txtUsername、txtPassword 等

这样，通过键入缩写，您将在完成键入缩写时获得所有类似的控件，即键入 btn，智能感知将列出您迄今为止添加的所有按钮。

# javascript - Javascript和表单重复问题

> ID：642761
> 
> 赞同：0
> 
> 时间：2009-03-13T13:42:13.763
> 
> 标签：javascript, html, forms

我有一个类似这样的 HTML 代码：

```
< tr id="500" >
 < form id="500" onsubmit="DoThis()">
  < td>Info< /td>
    etc...
    etc...
  < td>Info< /td>
 < /form> 
< /tr> 
```

我在 Javascript 中尝试做的是复制元素并将其添加到父表中：

var TrElement = document.getElementById("500")

```
var parent    = TrElement.parent;
var NewTr     = TrElement.cloneNode(true);
    parent.appendChild(NewTr); 
```

这段代码生成了一个新副本，它完美地放在桌子上。问题是我不能提交任何东西，因为新元素已经关闭了它的表单：现在看起来像这样：

```
< tr id="500">
 < form id="500" onsubmit="DoThis()" />   <----- end tag on the form :/
  < td>Info< /td>
    etc...
    etc...
  < td>Info< /td>
< /tr> 
```

有谁知道我可以如何强制表单不关闭，或者有其他解决这个问题的方法？

谢谢...

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-13T13:53:07.947

我认为您遇到问题是因为您的 HTML 无效。表单不能是表格行的子元素，它必须位于表格元素内。此外，您不能为行和表单本身提供相同的 id 值。所有元素 id 必须是[唯一的](http://www.w3.org/TR/REC-html40/struct/global.html#h-7.5.2)并且[以字母开头](http://www.w3.org/TR/REC-html40/types.html#type-name)。

由于我不确定您到底要做什么，因此很难知道建议什么来解决它。您可以尝试在不使用表格的情况下进行新布局——除非您有表格数据，否则这可能是可行的方法。否则，您可以尝试将您的表单嵌套在一个表格元素中，然后在此表单中创建一个实际包含您的列数据的表格，尽管您可能必须修复列宽以使其看起来像一个单一的数据表。

就 id 冲突而言，您可能希望在 id 前添加一个像“row_”或“form_”这样的字符串来区分它们。

如果您可以提供有关您要完成的工作的更多信息，我也许可以改进此答案。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-13T16:32:19.453

这里有不少问题。

```
<tr id="500">
    <form id="500" onsubmit="DoThis()"> 
```

你不能有一个以数字开头的“id”。在同一个文档中不能有两个相同的 'id' 值。您不能将 <form> 直接放在 <tr> 中，这就是导致问题的原因。对我来说，即使是第一种形式也行不通。

```
var TrElement = document.getElementById("500") 
```

哪一个？

```
var parent    = TrElement.parent; 
```

应该是父节点。

```
var NewTr     = TrElement.cloneNode(true);
parent.appendChild(NewTr); 
```

您现在有了*另外*两个 id="500" 的元素！您应该在将克隆元素附加到文档之前更改它们的 ID。

您可以在这里采取一些方法。如果所有表单字段都在一个单元格中，您可以将表单放在单元格中。但是，如果您需要跨多个单元格的字段，则表单必须位于表格之外。

在这种情况下，您可以在整个表格之外有一个表格，或者一个表格前行，每个表格都包含一个单独的 <table>。您可以使用指定宽度的列和 CSS 规则“table-layout:fixed”使所有表格的列对齐。

（您甚至需要一个表单吗？您的示例中可能缺少代码，但实际上您甚至没有使用表单提交到任何地方。如果您的页面应该是纯 javascript，您可以完全省略表单，只需将 onclick 事件放在按钮上。）

假设您确实需要多种形式，这里有一些示例代码：

```
<div>
    <form method="post" action="setThing.script" class="setform" id="setform-500">
        <table><tr>
            <td>Info</td>
            <td><input type="text" name="setting" value="" /></td>
            <td><input type="submit" value="Set" /></td>
        </tr></table>
     </form> 
</div>
<button id="addrow">Another one, please!</button>

<script type="text/javascript">
    function doThing() {
        alert('validating form or something');
        return false;
    }

    var rownum= 500;
    document.getElementById('setform-'+rownum).onsubmit= doThing;

    document.getElementById('addrow').onclick= function() {
        var f500= document.getElementById('setform-'+rownum);
        var fnew= f500.cloneNode(true);
        rownum++;
        fnew.id= 'setform-'+rownum;
        fnew.onsubmit= doThing;
        f500.parentNode.appendChild(fnew);
    }
</script> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-13T14:06:56.840

我应该做什么：我的桌子上有很多行。这些行包含有关项目的信息。像这样说：<td>< input type="text" id="item_ ">
< input type="text" id="date_
< input type="submit" value="submit"/>

当用户模糊“日期字段”时，Javascript 将检查数据库中是否存在任何具有相同日期的项目。（并非所有数据都在行中表示，有些仍在数据库中）

如果已经存在具有相同日期的项目，我想复制一个元素并将其子元素的属性和值更改为我们发现已经存在的项目。

新行也应该能够提交编辑过的数据。

但由于 <form> 自行关闭，我无法提交任何数据。

很难解释，但希望你能理解

# python - 是否可以在运行时替换 Python 函数/方法装饰器？

> ID：642762
> 
> 赞同：20
> 
> 时间：2009-03-13T13:42:33.543
> 
> 标签：python, runtime, language-features, decorator

如果我有一个功能：

```
 @aDecorator
def myfunc1():
  # do something here

if __name__ = "__main__":
  # this will call the function and will use the decorator @aDecorator
  myfunc1() 
  # now I want the @aDecorator to be replaced with the decorator @otherDecorator
  # so that when this code executes, the function no longer goes through
  # @aDecorator, but instead through @otherDecorator. How can I do this?
  myfunc1() 
```

是否可以在运行时替换装饰器？

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2009-03-13T13:55:56.350

正如 Miya 所提到的，您可以在解释器到达该函数声明之前的任何时候用另一个函数替换装饰器。但是，一旦将装饰器应用于函数，我认为没有办法用不同的装饰器动态替换装饰器。例如：

```
@aDecorator
def myfunc1():
    pass

# Oops! I didn't want that decorator after all!

myfunc1 = bDecorator(myfunc1) 
```

不起作用，因为 myfunc1 不再是您最初定义的函数；它已经被包裹了。这里最好的方法是手动应用装饰器，oldskool 风格，即：

```
def myfunc1():
    pass

myfunc2 = aDecorator(myfunc1)
myfunc3 = bDecorator(myfunc1) 
```

编辑：或者，更清楚一点，

```
def _tempFunc():
    pass

myfunc1 = aDecorator(_tempFunc)
myfunc1()
myfunc1 = bDecorator(_tempFunc)
myfunc1() 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-03-13T14:55:06.770

我不知道是否有办法在应用装饰器后“替换”它，但我想可能没有，因为功能已经改变。

无论如何，您可能会根据某些条件在运行时应用装饰器：

```
#!/usr/bin/env python

class PrintCallInfo:
    def __init__(self,f):
        self.f = f
    def __call__(self,*args,**kwargs):
        print "-->",self.f.__name__,args,kwargs
        r = self.f(*args,**kwargs)
        print "<--",self.f.__name__,"returned: ",r
        return r

# the condition to modify the function...
some_condition=True

def my_decorator(f):
    if (some_condition): # modify the function
        return PrintCallInfo(f)
    else: # leave it as it is
        return f

@my_decorator
def foo():
    print "foo"

@my_decorator
def bar(s):
    print "hello",s
    return s

@my_decorator
def foobar(x=1,y=2):
    print x,y
    return x + y

foo()
bar("world")
foobar(y=5) 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-03-13T13:59:40.710

这是一个很棒的[食谱，可以帮助您入门](http://code.activestate.com/recipes/528929/)。基本上，这个想法是将一个类实例传递给装饰器。然后，您可以在类实例上设置属性（如果您愿意，可以将其设为 Borg）并使用它来控制装饰器本身的行为。

这是一个例子：

```
class Foo:
    def __init__(self, do_apply):
        self.do_apply = do_apply

def dec(foo):
    def wrap(f):
        def func(*args, **kwargs):
            if foo.do_apply:
                # Do something!
                pass 
            return f(*args, **kwargs)
        return func
    return wrap

foo = Foo(False)
@dec(foo)
def bar(x):
    return x

bar('bar') 
foo.do_apply = True 
# Decorator now active!
bar('baz') 
```

当然，你也可以合并“装饰器装饰器”来保存签名等。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-03-13T13:53:41.440

如果要显式更改装饰器，不妨选择更显式的方法，而不是创建装饰函数：

```
deco1(myfunc1, arg1, arg2)
deco2(myfunc1, arg2, arg3) 
```

deco1() 和 deco2() 将应用装饰器提供的功能并使用参数调用 myfunc1()。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2010-11-16T23:26:59.363

当然——你可以得到函数对象并用它做任何你想做的事情：

```
# Bypass a decorator

import types

class decorator_test(object):

    def __init__(self, f):
        self.f = f

    def __call__(self):
        print "In decorator ... entering: ", self.f.__name__
        self.f()
        print "In decorator ... exiting: ", self.f.__name__

@decorator_test
def func1():
    print "inside func1()"

print "\nCalling func1 with decorator..."
func1()

print "\nBypassing decorator..."
for value in func1.__dict__.values():
    if isinstance(value, types.FunctionType) and value.func_name == "func1":
        value.__call__() 
```

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2017-11-18T04:42:22.673

我知道这是一个旧线程，但我玩得很开心

```
def change_deco(name, deco, placeholder='    #'):
with open(name + '.py', 'r') as file:
    lines = file.readlines()
for idx, string in enumerate(lines):
    if placeholder in string and repr(placeholder) not in string:
        lines[idx] = f'    @{deco}\r\n'
exec(''.join(lines))
return locals()[name] 
```

* * *

## 回答 #7

> 赞同：-3
> 
> 时间：2009-03-13T13:43:58.673

如果装饰器是一个函数，只需替换它。

```
aDecorator = otherDecorator 
```

# python - 查找两个嵌套列表的交集？

> ID：642763
> 
> 赞同：475
> 
> 时间：2009-03-13T13:42:44.680
> 
> 标签：python, list, intersection

我知道如何获得两个平面列表的交集：

```
b1 = [1,2,3,4,5,9,11,15]
b2 = [4,5,6,7,8]
b3 = [val for val in b1 if val in b2] 
```

或者

```
def intersect(a, b):
    return list(set(a) & set(b))

print intersect(b1, b2) 
```

但是当我必须找到嵌套列表的交集时，我的问题就开始了：

```
c1 = [1, 6, 7, 10, 13, 28, 32, 41, 58, 63]
c2 = [[13, 17, 18, 21, 32], [7, 11, 13, 14, 28], [1, 5, 6, 8, 15, 16]] 
```

最后我想收到：

```
c3 = [[13,32],[7,13,28],[1,6]] 
```

你们能帮我解决这个问题吗？

### 有关的

*   [在python中展平一个浅表](https://stackoverflow.com/questions/406121/flattening-a-shallow-list-in-python)

* * *

## 回答 #1

> 赞同：896
> 
> 时间：2009-03-13T14:16:46.673

您不需要定义交集。它已经是套装的一流部分。

```
>>> b1 = [1,2,3,4,5,9,11,15]
>>> b2 = [4,5,6,7,8]
>>> set(b1).intersection(b2)
set([4, 5]) 
```

* * *

## 回答 #2

> 赞同：179
> 
> 时间：2009-03-13T14:11:13.707

**如果你想：**

```
c1 = [1, 6, 7, 10, 13, 28, 32, 41, 58, 63]
c2 = [[13, 17, 18, 21, 32], [7, 11, 13, 14, 28], [1, 5, 6, 8, 15, 16]]
c3 = [[13, 32], [7, 13, 28], [1,6]] 
```

**那么这里是 Python 2 的解决方案：**

```
c3 = [filter(lambda x: x in c1, sublist) for sublist in c2] 
```

**在 Python 3`filter`中返回一个 iterable 而不是`list`，因此您需要使用 包装`filter`调用`list()`：**

```
c3 = [list(filter(lambda x: x in c1, sublist)) for sublist in c2] 
```

**解释：**

过滤器部分获取每个子列表的项目并检查它是否在源列表 c1 中。对 c2 中的每个子列表执行列表推导。

* * *

## 回答 #3

> 赞同：61
> 
> 时间：2009-12-09T17:26:06.410

对于只想找到两个列表的交集的人，Asker 提供了两种方法：

> ```
> b1 = [1,2,3,4,5,9,11,15]
> b2 = [4,5,6,7,8]
> b3 = [val for val in b1 if val in b2] 
> ```
> 
> 和
> 
> ```
> def intersect(a, b):
>      return list(set(a) & set(b))
> 
> print intersect(b1, b2) 
> ```

但是有一种更有效的混合方法，因为您只需在列表/集合之间进行一次转换，而不是三个：

```
b1 = [1,2,3,4,5]
b2 = [3,4,5,6]
s2 = set(b2)
b3 = [val for val in b1 if val in s2] 
```

这将在 O(n) 中运行，而他涉及列表理解的原始方法将在 O(n^2) 中运行

* * *

## 回答 #4

> 赞同：30
> 
> 时间：2009-09-10T08:50:21.770

函数式方法：

```
input_list = [[1, 2, 3, 4, 5], [2, 3, 4, 5, 6], [3, 4, 5, 6, 7]]

result = reduce(set.intersection, map(set, input_list)) 
```

它可以应用于1+列表的更一般情况

* * *

## 回答 #5

> 赞同：27
> 
> 时间：2009-03-13T14:35:58.813

### 纯列表理解版

```
>>> c1 = [1, 6, 7, 10, 13, 28, 32, 41, 58, 63]
>>> c2 = [[13, 17, 18, 21, 32], [7, 11, 13, 14, 28], [1, 5, 6, 8, 15, 16]]
>>> c1set = frozenset(c1) 
```

展平变体：

```
>>> [n for lst in c2 for n in lst if n in c1set]
[13, 32, 7, 13, 28, 1, 6] 
```

嵌套变体：

```
>>> [[n for n in lst if n in c1set] for lst in c2]
[[13, 32], [7, 13, 28], [1, 6]] 
```

* * *

## 回答 #6

> 赞同：21
> 
> 时间：2016-12-16T11:09:47.363

& 运算符取两个集合的交集。

```
{1, 2, 3} & {2, 3, 4}
Out[1]: {2, 3} 
```

* * *

## 回答 #7

> 赞同：13
> 
> 时间：2017-01-27T00:18:43.937

采用 2 个列表的交集的 Pythonic 方式是：

```
[x for x in list1 if x in list2] 
```

* * *

## 回答 #8

> 赞同：8
> 
> 时间：2009-03-13T13:47:08.150

您应该使用此代码进行展平（取自[http://kogs-www.informatik.uni-hamburg.de/~meine/python_tricks](http://kogs-www.informatik.uni-hamburg.de/~meine/python_tricks)），该代码未经测试，但我很确定它有效：

```
 def flatten(x):
    """flatten(sequence) -> list

    Returns a single, flat list which contains all elements retrieved
    from the sequence and all recursively contained sub-sequences
    (iterables).

    Examples:
    >>> [1, 2, [3,4], (5,6)]
    [1, 2, [3, 4], (5, 6)]
    >>> flatten([[[1,2,3], (42,None)], [4,5], [6], 7, MyVector(8,9,10)])
    [1, 2, 3, 42, None, 4, 5, 6, 7, 8, 9, 10]"""

    result = []
    for el in x:
        #if isinstance(el, (list, tuple)):
        if hasattr(el, "__iter__") and not isinstance(el, basestring):
            result.extend(flatten(el))
        else:
            result.append(el)
    return result 
```

展平列表后，以通常的方式执行交集：

```
 c1 = [1, 6, 7, 10, 13, 28, 32, 41, 58, 63]
c2 = [[13, 17, 18, 21, 32], [7, 11, 13, 14, 28], [1, 5, 6, 8, 15, 16]]

def intersect(a, b):
     return list(set(a) & set(b))

print intersect(flatten(c1), flatten(c2)) 
```

* * *

## 回答 #9

> 赞同：8
> 
> 时间：2012-02-21T11:38:00.057

既然`intersect`定义了，一个基本的列表理解就足够了：

```
>>> c3 = [intersect(c1, i) for i in c2]
>>> c3
[[32, 13], [28, 13, 7], [1, 6]] 
```

由于 S. Lott 的评论和 TM. 的相关评论，改进：

```
>>> c3 = [list(set(c1).intersection(i)) for i in c2]
>>> c3
[[32, 13], [28, 13, 7], [1, 6]] 
```

* * *

## 回答 #10

> 赞同：5
> 
> 时间：2014-04-12T08:21:15.613

鉴于：

```
> c1 = [1, 6, 7, 10, 13, 28, 32, 41, 58, 63]

> c2 = [[13, 17, 18, 21, 32], [7, 11, 13, 14, 28], [1, 5, 6, 8, 15, 16]] 
```

我发现以下代码运行良好，如果使用 set 操作可能更简洁：

```
> c3 = [list(set(f)&set(c1)) for f in c2] 
```

它得到：

```
> [[32, 13], [28, 13, 7], [1, 6]] 
```

如果需要订购：

```
> c3 = [sorted(list(set(f)&set(c1))) for f in c2] 
```

我们有：

```
> [[13, 32], [7, 13, 28], [1, 6]] 
```

顺便说一句，对于更 Python 的风格，这个也很好：

```
> c3 = [ [i for i in set(f) if i in c1] for f in c2] 
```

* * *

## 回答 #11

> 赞同：3
> 
> 时间：2012-06-30T23:23:23.130

我不知道我是否迟到了回答你的问题。在阅读了您的问题后，我想出了一个可以在列表和嵌套列表上工作的函数 intersect()。我用递归来定义这个函数，很直观。希望它是您正在寻找的：

```
def intersect(a, b):
    result=[]
    for i in b:
        if isinstance(i,list):
            result.append(intersect(a,i))
        else:
            if i in a:
                 result.append(i)
    return result 
```

例子：

```
>>> c1 = [1, 6, 7, 10, 13, 28, 32, 41, 58, 63]
>>> c2 = [[13, 17, 18, 21, 32], [7, 11, 13, 14, 28], [1, 5, 6, 8, 15, 16]]
>>> print intersect(c1,c2)
[[13, 32], [7, 13, 28], [1, 6]]

>>> b1 = [1,2,3,4,5,9,11,15]
>>> b2 = [4,5,6,7,8]
>>> print intersect(b1,b2)
[4, 5] 
```

* * *

## 回答 #12

> 赞同：2
> 
> 时间：2009-03-13T13:45:14.957

您是否考虑`[1,2]`与 相交`[1, [2]]`？也就是说，你关心的只是数字，还是列表结构？

如果只有数字，请研究如何“扁平化”列表，然后使用该`set()`方法。

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2016-11-29T14:40:50.280

我也在寻找一种方法来做到这一点，最终结果是这样的：

```
def compareLists(a,b):
    removed = [x for x in a if x not in b]
    added = [x for x in b if x not in a]
    overlap = [x for x in a if x in b]
    return [removed,added,overlap] 
```

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2014-11-21T08:59:50.800

```
c1 = [1, 6, 7, 10, 13, 28, 32, 41, 58, 63]

c2 = [[13, 17, 18, 21, 32], [7, 11, 13, 14, 28], [1, 5, 6, 8, 15, 16]]

c3 = [list(set(c2[i]).intersection(set(c1))) for i in xrange(len(c2))]

c3
->[[32, 13], [28, 13, 7], [1, 6]] 
```

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2015-05-05T12:05:52.380

我们可以为此使用 set 方法：

```
c1 = [1, 6, 7, 10, 13, 28, 32, 41, 58, 63]
c2 = [[13, 17, 18, 21, 32], [7, 11, 13, 14, 28], [1, 5, 6, 8, 15, 16]]

   result = [] 
   for li in c2:
       res = set(li) & set(c1)
       result.append(list(res))

   print result 
```

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2017-05-18T06:39:17.213

要定义正确考虑元素基数的交集，请使用`Counter`：

```
from collections import Counter

>>> c1 = [1, 2, 2, 3, 4, 4, 4]
>>> c2 = [1, 2, 4, 4, 4, 4, 5]
>>> list((Counter(c1) & Counter(c2)).elements())
[1, 2, 4, 4, 4] 
```

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2017-08-24T20:19:39.337

```
# Problem:  Given c1 and c2:
c1 = [1, 6, 7, 10, 13, 28, 32, 41, 58, 63]
c2 = [[13, 17, 18, 21, 32], [7, 11, 13, 14, 28], [1, 5, 6, 8, 15, 16]]
# how do you get c3 to be [[13, 32], [7, 13, 28], [1, 6]] ? 
```

这是一种`c3`不涉及集合的设置方法：

```
c3 = []
for sublist in c2:
    c3.append([val for val in c1 if val in sublist]) 
```

但如果你喜欢只使用一行，你可以这样做：

```
c3 = [[val for val in c1 if val in sublist]  for sublist in c2] 
```

这是列表推导中的列表推导，这有点不寻常，但我认为你应该不会有太多麻烦。

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2018-05-21T09:47:02.817

```
c1 = [1, 6, 7, 10, 13, 28, 32, 41, 58, 63]
c2 = [[13, 17, 18, 21, 32], [7, 11, 13, 14, 28], [1, 5, 6, 8, 15, 16]]
c3 = [list(set(i) & set(c1)) for i in c2]
c3
[[32, 13], [28, 13, 7], [1, 6]] 
```

对我来说，这是一种非常优雅和快速的方法:)

* * *

## 回答 #19

> 赞同：0
> 
> 时间：2019-07-01T22:25:06.183

## 可以`reduce`轻松制作平面列表。

您只需要使用*初始化程序*- 函数中的第三个参数`reduce`。

```
reduce(
   lambda result, _list: result.append(
       list(set(_list)&set(c1)) 
     ) or result, 
   c2, 
   []) 
```

以上代码适用于 python2 和 python3，但您需要将 reduce 模块导入为`from functools import reduce`. 有关详细信息，请参阅下面的链接。

*   [对于python2](https://docs.python.org/2/library/functions.html#reduce)

*   [对于python3](https://docs.python.org/3/library/functools.html#functools.reduce)

* * *

## 回答 #20

> 赞同：-1
> 
> 时间：2020-03-20T20:47:52.480

# 查找可迭代对象之间差异和交集的简单方法

如果重复很重要，请使用此方法

```
from collections import Counter

def intersection(a, b):
    """
    Find the intersection of two iterables

    >>> intersection((1,2,3), (2,3,4))
    (2, 3)

    >>> intersection((1,2,3,3), (2,3,3,4))
    (2, 3, 3)

    >>> intersection((1,2,3,3), (2,3,4,4))
    (2, 3)

    >>> intersection((1,2,3,3), (2,3,4,4))
    (2, 3)
    """
    return tuple(n for n, count in (Counter(a) & Counter(b)).items() for _ in range(count))

def difference(a, b):
    """
    Find the symmetric difference of two iterables

    >>> difference((1,2,3), (2,3,4))
    (1, 4)

    >>> difference((1,2,3,3), (2,3,4))
    (1, 3, 4)

    >>> difference((1,2,3,3), (2,3,4,4))
    (1, 3, 4, 4)
    """
    diff = lambda x, y: tuple(n for n, count in (Counter(x) - Counter(y)).items() for _ in range(count))
    return diff(a, b) + diff(b, a) 
```

* * *

## 回答 #21

> 赞同：-1
> 
> 时间：2022-01-11T22:30:00.013

```
from random import *

a = sample(range(0, 1000), 100)
b = sample(range(0, 1000), 100)
print(a)
print(b)
print(set(a).intersection(set(b))) 
```

# linux - 如何调试远程 linux 二进制文件？

> ID：642768
> 
> 赞同：3
> 
> 时间：2009-03-13T13:43:31.950
> 
> 标签：linux, gdb, remote-debugging

情况如下：

我有一个崩溃的 linux 二进制文件。没有日志文件、跟踪文件等。我需要能够将调试器附加到它（我在本地有源）并跟踪错误。

解决这个问题的最简单、最好的方法是什么？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-03-14T11:53:33.540

远程调试相当简单：在目标平台上，使用 GDBserver 启动应用程序，同时指定用于侦听传入 TCP 连接的主机和端口：

```
 gdbserver HOST:PORT PROG [ARGS ...] 
```

在开发工作站上，启动跨目标 GDB：

```
 powerpc-7450-linux-gnu-gdb PROG 
```

请务必指定未剥离的可执行文件。在 GDB 控制台中，键入：

```
 target remote HOST:PORT
  break main
  continue 
```

[使用 GDB 和 GDBserver 进行远程跨目标调试](http://www.linux.com/feature/121735)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-13T13:53:30.973

看起来 gdb 支持远程调试。

我从未使用过它，但[http://davis.lbl.gov/Manuals/GDB/gdb_17.html](http://davis.lbl.gov/Manuals/GDB/gdb_17.html)看起来像是一个开始。

基本上，您在目标机器上的 gdbserver 下运行程序，gdb 连接（通过 TCP 或串行）到 gdbserver。

# javascript - 你最喜欢的测试 javascript 代码片段的方法是什么？

> ID：642769
> 
> 赞同：6
> 
> 时间：2009-03-13T13:43:42.980
> 
> 标签：javascript, debugging, testing

你最喜欢的测试 javascript 代码片段的方法是什么？

我喜欢直接使用浏览器的地址字段：

```
javascript:void(document.getElementById("textbox").style.display='none'))
javascript:void(document.write("Testing"))
javascript:alert(parseFloat("33.33")) 
```

如果使用后一种技巧，不要忘记将所有内容包装在一个`void()`调用或`alert()`调用中，以免页面被空白。

或者，firefox 上有 Firebug 扩展，您可以在其中任意编辑 javascript 代码。

还有其他有趣的方法吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-03-13T14:31:48.557

您可以使用[JSBin](http://jsbin.com/)来测试带有 html 片段和一些 js 框架的代码片段。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-03-13T13:51:16.923

[Firebug 控制台日志记录](http://getfirebug.com/console.html)

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-11-22T02:03:09.217

JSFiddle 快速、简单、社交！ [http://jsfiddle.net/](http://jsfiddle.net/)

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-03-13T13:45:59.260

我对几乎所有 JavaScript 都使用 Firebug。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-03-13T13:55:05.633

到目前为止，我使用[Firebug](http://getfirebug.com/)的次数最多。
否则我使用地址栏，或者只是在页面上添加一个按钮或链接。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-03-13T13:54:38.740

如果你想在 IE 上调试和运行 Javascript，你也可以试试[Debugbar](http://www.debugbar.com/)。它工作得很好。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-03-13T14:29:05.367

[我在 w3school 上的链接文本](http://www.w3schools.com/html/tryit.asp?filename=tryhtml_input)上使用 tryit.asp， 因为我通常使用该站点检查我的 html。它还允许我在走远之前尝试变化。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-03-13T14:21:45.727

为了在不同的浏览器上测试小脚本，我有一个 html 文件，它只包含

```
<pre><script>
</script></pre> 
```

日志记录通过`document.writeln()`.

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2012-09-19T15:42:42.247

我喜欢[JavaScript eval 控制台](http://blogorama.nerdworks.in/entry-JavaScriptevalconsole.aspx)。

该工具的作者也提供了代码，因此您也可以在本地使用它。

# sql-server - WHERE 子句中列的顺序是否重要？

> ID：642784
> 
> 赞同：36
> 
> 时间：2009-03-13T13:46:27.963
> 
> 标签：sql-server, performance

WHERE 子句中列的顺序会影响性能吗？

例如

假设我首先放置一个具有更高独特性潜力的列，反之亦然？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-03-13T13:48:36.897

使用一个不错的查询优化器：它不应该。

但在实践中，我怀疑它可能会。

您只能通过测量来判断您的情况。并且测量值可能会随着数据库中数据分布的变化而变化。

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2009-03-13T14:15:02.857

对于 Transact-SQL ，在 WHERE 子句的[条件](http://technet.microsoft.com/en-us/library/ms173545.aspx)中定义了运算符的优先级。优化器可能会重新排序此评估，因此您不应依赖短路行为来确保正确性。顺序通常是从左到右，但索引的选择性/可用性可能也很重要。简化您的搜索条件应该会提高优化器处理它的能力。

前任：

```
 WHERE (a OR b) AND (b OR c) 
```

可以简化为

```
 WHERE b OR (a AND c) 
```

显然，在这种情况下，如果可以构造查询以查找 b 是否首先成立，则它可能能够跳过 a 和 c 的评估，从而运行得更快。优化器是否可以进行这种简单的转换我无法回答（它可能可以），但关键是它可能无法进行任意复杂的转换，您可以通过重新安排条件来影响查询性能。如果 b 更具选择性或具有索引，则优化器可能会首先使用它来构造查询。

**编辑**：关于您关于基于唯一性排序的问题，我假设您可以根据您对数据的了解（实际，非假设）向优化器提供的任何提示都不会受到伤害。假设它不会进行任何优化并构造您的查询，就好像您需要从最高到最低选择性定义它一样，但在性能真正成为问题之前不要执着于它。

引用上面的参考资料：

> 逻辑运算符的优先顺序是 NOT（最高），然后是 AND，然后是 OR。括号可用于在搜索条件中覆盖此优先级。逻辑运算符的求值顺序可能因查询优化器的选择而异。

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2009-03-13T15:31:46.213

对于 SQL Server 2000 / 20005 / 2008，无论您如何排列 WHERE 子句中的列，查询优化器通常都会为您提供相同的结果。话虽如此，多年来编写了数千个 T-SQL 命令，我发现了一些特殊情况，其中命令改变了性能。以下是似乎受此问题影响的查询的一些特征：

1.  如果您的查询中有大量表（10 个或更多）。

2.  如果 WHERE 子句中有多个 EXISTS、IN、NOT EXISTS 或 NOT IN 语句

3.  如果您使用嵌套 CTE（公用表表达式）或大量 CTE。

4.  如果您的 FROM 子句中有大量子查询。

以下是有关尝试评估快速解决性能问题的最佳方法的一些提示：

1.  如果问题与 1 或 2 有关，则尝试重新排序 WHERE 子句并比较估计查询计划中查询的子树成本。

2.  如果问题与 3 或 4 有关，则尝试将子查询和 CTE 移出查询并让它们加载临时表。如果从 T-SQL 语句的主体中减少复杂连接和子查询的数量，查询计划优化器在估计查询计划方面的效率会更高。

3.  如果您使用临时表，请确保您已为临时表指定主键。这意味着避免使用 SELECT INTO FROM 来生成表。相反，在使用 INSERT INTO SELECT 语句之前显式创建表并指定主键。

4.  如果您正在使用临时表并且服务器上的许多进程也使用临时表，那么您可能希望创建一个更永久的临时表，该表在查询过程中被截断并重新加载。如果您使用 TempDB 存储工作表/临时表，则更有可能遇到磁盘争用问题。

5.  将 WHERE 子句中将过滤最多数据的语句移到 WHERE 子句的开头。请注意，如果这是您对问题的解决方案，那么当查询计划再次对生成和选择最佳执行计划感到困惑时，您可能会再次表现不佳。您最好找到一种方法来降低查询的复杂性，以便 WHERE 子句的顺序不再相关。

我希望这些信息对您有所帮助。祝你好运！

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-03-13T13:55:29.237

这一切都取决于 DBMS、查询优化器和规则，但通常它确实会影响性能。

如果一个 where 子句的排序使得第一个条件显着减少了结果集，那么剩下的条件只需要针对较小的集合进行评估。按照该逻辑，您可以根据 where 子句中的条件顺序优化查询。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2011-04-11T11:38:18.193

**理论上**，任何两个等效的查询都应该产生相同的查询计划。由于`WHERE`子句的顺序对查询的逻辑意义没有影响，这应该意味着`WHERE`子句的顺序应该没有影响。

这是因为查询优化器的工作方式。在一个*大大简化*的概述中：

1.  首先 SQL Server 解析查询并构建逻辑运算符树（例如`JOIN`or `SELECT`）。
2.  然后它将这些逻辑运算符转换为“物理操作树”（例如“嵌套循环”或“索引扫描”，即执行计划）
3.  接下来，它通过交换等效的操作，在一组等效的“物理操作树”（即执行计划）中进行置换，估计每个计划的成本，直到找到最佳计划。

第二步完成是一种完全简单的方式 - 它只是选择它可以选择的第一个/最明显的物理树，但是在第三步中，查询优化器能够查看**所有**等效的物理树（即执行计划），所以只要查询实际上是等效的，我们在步骤 2 中获得的初始计划并不重要，在步骤 3 中要考虑的所有计划的计划集都是相同的。

（我不记得逻辑/物理树的真实名称，它们在一本书中，但不幸的是，这本书现在离我在世界的另一边）

有关优化器内部的更多详细信息，请参阅以下系列博客文章[：构建计划 - 第 1 部分](http://sqlblog.com/blogs/paul_white/archive/2010/07/29/inside-the-optimiser-constructing-a-plan.aspx)

**然而实际上**，查询优化器通常没有机会在步骤 3 中考虑**所有**等效树（对于复杂查询，可能存在大量可能的计划），因此在某个截止时间之后，步骤 3 被缩短，并且查询优化器必须选择迄今为止找到的最佳计划 - 在这种情况下，不会考虑**所有**计划。

有很多幕后魔术可以确保查询优化器有选择地和智能地选择要考虑的计划，因此大多数时候计划选择是“足够好”——即使它不是绝对最快的计划，它可能不会比理论上最快的速度慢多少，

然而，这意味着如果我们在步骤 2 中有不同的启动计划（如果我们以不同的方式编写查询，这可能会发生），这可能意味着在步骤 3 中考虑了不同的计划子集，因此**理论上**SQL Server 可以根据编写方式，为等效查询提出不同的查询计划。

然而实际上 99% 的时间你不会注意到差异（对于许多简单的计划不会**有**任何差异，因为优化器实际上会考虑所有计划）。此外，您无法预测其中的任何一项将如何发挥作用，因此看似合理的事情（例如将`WHERE`条款按特定顺序排列）可能不会产生预期效果。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-03-13T15:07:47.457

在*绝大多数*情况下，查询优化器将确定选择您请求的数据的最有效方式，而与 WHERE 子句中定义的 SARGS 的顺序无关。

排序由诸如相关列的选择性（SQL Server 根据统计信息知道）以及是否可以使用索引等因素决定。

* * *

## 回答 #7

> 赞同：-5
> 
> 时间：2009-03-13T13:49:02.857

如果你是 ANDing 条件，第一个 not true 将返回 false，因此顺序会影响性能。

# php - 如何使用 PHP 和 JavaScript 验证句子？

> ID：642794
> 
> 赞同：0
> 
> 时间：2009-03-13T13:48:50.657
> 
> 标签：php, javascript

我目前正在尝试验证用户输入的句子是否与预期的句子匹配。预期的句子存储在 PHP 变量`$rebuiltSentence`中，例如“the cat sat”。

问题是当我尝试调用我的 JavaScript 函数时，`formSubmit()`我需要给它一个要检查的句子，因此理想情况下我会调用 formSubmit($rebuiltSentence)。我认为这行不通，因为它认为它正在传递几个单独的字符串。

这是我所拥有的：

```
//sentence.php

<input type='button' value='Submit' onClick=formSubmit('$rebuiltSentence') 
```

和

```
//validate.js
function formSubmit(correct)
{
var contents = document.getElementById('sentenceBuilder').value;
if(contents==correct){

    alert('The Sentences Match');
}else{
    alert('The Sentences Dont Match');
}

window.location.reload(true);
} 
```

有什么想法可以解决这个问题吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-13T14:03:27.940

您应该引用该属性并正确转义它：

```
echo '<... onClick="formSubmit(' . htmlspecialchars(json_encode($rebuiltSentence)) . ');">' 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-13T14:40:50.033

您可以将句子添加为隐藏字段以进行验证。

```
//sentence.php

<input type='hidden' id=rebuiltSentence value='$rebuildSentence'>
<input type='button' value='Submit' onClick=formSubmit()> 
```

并验证您可以轻松使用

```
//validate.js
function formSubmit()
{
  var contents = document.getElementById('sentenceBuilder').value;
  var correct  = document.getElementById('rebuiltSentence').value;
  if(contents==correct)
  {
    alert('The Sentences Match');
  }else{
    alert('The Sentences Dont Match');
  }

  window.location.reload(true);
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-13T13:59:54.000

看起来您正在传递字符串 $rebuiltSentence 而不是此参数在 PHP 中保存的句子。

更改为以下内容

//句子.php

```
echo "<input type='button' value='Submit' onClick=formSubmit('".$rebuiltSentence."')"; 
```

它会回显 $rebuiltSentence 的内容。

# unit-testing - Rhino Mocks - 如何断言一个模拟方法被调用了 n 次？

> ID：642801
> 
> 赞同：15
> 
> 时间：2009-03-13T13:50:30.747
> 
> 标签：unit-testing, tdd, rhino-mocks

我如何断言模拟对象上的方法被准确地调用了 n 次？

这是来自控制器操作的代码片段，我喜欢测试：

```
for (int i = 0; i <= newMatchCommand.NumberOfMatchesToCreate; i++) {
    serviceFacade.CreateNewMatch("tester", Side.White);
} 
```

“服务外观”对象是（严格的）模拟，将被注入到控制器中。单元测试应该断言操作中的 CreateNewMatch 方法被调用了 n 次。（例如 5 个）

* * *

## 回答 #1

> 赞同：42
> 
> 时间：2009-03-16T02:24:54.110

更好的是：

```
mockObject.AssertWasCalled(x => x.SomeMethod(), opt => opt.Repeat.Times(n)); 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-03-13T14:19:40.303

试试`Expect.Call(method).Repeat.Times(n)`。

# sql - 如何使用 sql server 执行 BEFORE UPDATED 触发器？

> ID：642822
> 
> 赞同：50
> 
> 时间：2009-03-13T13:54:05.030
> 
> 标签：sql, sql-server, database, triggers, sql-server-express

我正在使用 Sqlserver express，但无法`before updated`触发。还有其他方法可以做到吗？

* * *

## 回答 #1

> 赞同：45
> 
> 时间：2011-01-07T15:25:54.953

确实，MSSQL 中没有“前触发器”。但是，您仍然可以通过同时使用“插入”和“删除”表来跟踪对表所做的更改。当更新导致触发器触发时，“插入”表存储新值，“删除”表存储旧值。一旦有了这些信息，您就可以相对容易地模拟“触发前”行为。

* * *

## 回答 #2

> 赞同：44
> 
> 时间：2009-03-13T14:02:48.160

MSSQL 不支持`BEFORE`触​​发器。您拥有的最接近的是`INSTEAD OF`触发器，但它们的行为与`BEFORE`MySQL 中的触发器不同。

[您可以在此处](http://msdn.microsoft.com/en-us/library/aa258254(SQL.80).aspx)了解有关它们的更多信息，并注意`INSTEAD OF`triggers “指定执行触发器而不是触发 SQL 语句，从而覆盖触发语句的操作。” 因此，如果未正确写入/处理触发器，则可能不会发生更新操作。级联动作也会受到影响。

相反，您可能想要使用不同的方法来实现您想要实现的目标。

* * *

## 回答 #3

> 赞同：14
> 
> 时间：2016-01-19T11:57:54.797

无法确定这是否适用于 SQL Server *Express*，但即使您的触发器在更新之后发生，您仍然可以访问“之前”数据。您需要从表更改时动态创建的**已删除**或已**插入表中读取数据。**这基本上是@Stamen 所说的，但我仍然需要进一步探索以理解这个（有用的！）答案。

> **删除**的表在 DELETE 和 UPDATE 语句期间存储受影响行的副本。在执行 DELETE 或 UPDATE 语句期间，行会从触发器表中删除并转移到已删除的表中...
> 
> **插入**的表在 INSERT 和 UPDATE 语句期间存储受影响行的副本。在插入或更新事务期间，新行将添加到插入表和触发器表中......
> 
> [https://msdn.microsoft.com/en-us/library/ms191300.aspx](https://msdn.microsoft.com/en-us/library/ms191300.aspx)

因此，您可以创建触发器以从其中一个表中读取数据，例如

```
CREATE TRIGGER <TriggerName> ON <TableName>
AFTER UPDATE
AS
  BEGIN
    INSERT INTO <HistoryTable> ( <columns...>, DateChanged )
    SELECT <columns...>, getdate()
    FROM deleted;
  END; 
```

我的示例基于此处的示例：

[http://www.seemoredata.com/en/showthread.php?134-Example-of-BEFORE-UPDATE-trigger-in-Sql-Server-good-for-Type-2-dimension-table-updates](http://www.seemoredata.com/en/showthread.php?134-Example-of-BEFORE-UPDATE-trigger-in-Sql-Server-good-for-Type-2-dimension-table-updates)

[sql-server](/questions/tagged/sql-server "显示标记为“sql-server”的问题") [触发器](/questions/tagged/triggers "显示标记为“触发器”的问题")

* * *

## 回答 #4

> 赞同：9
> 
> 时间：2009-03-13T13:57:35.533

T-SQL 仅支持 AFTER 和 INSTEAD OF 触发器，它不具有 BEFORE 触发器，这在其他一些 RDBMS 中可以找到。

我相信您会想要使用 INSTEAD OF 触发器。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2009-03-13T13:58:45.440

SQL Server 中的所有“正常”触发器都是“AFTER ...”触发器。没有“BEFORE ...”触发器。

要在更新之前做一些事情，请查看[INSTEAD OF UPDATE 触发器](http://msdn.microsoft.com/en-us/library/ms188601.aspx)。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2012-05-03T14:16:44.663

为了`BEFORE UPDATE`在 SQL Server 中做一个，我使用了一个技巧。我对记录 ( `UPDATE Table SET Field = Field`) 进行了错误更新，这样我就得到了记录的先前图像。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-03-13T14:37:47.920

请记住，当您使用替代触发器时，它不会提交插入，除非您在触发器中明确告诉它。而不是真的意味着这样做而不是你通常做的事情，所以不会发生任何正常的插入操作。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2019-03-26T17:17:51.567

完整示例：

```
CREATE TRIGGER [dbo].[trig_020_Original_010_010_Gamechanger]
   ON  [dbo].[T_Original]
   AFTER UPDATE
AS 
BEGIN
    -- SET NOCOUNT ON added to prevent extra result sets from
    -- interfering with SELECT statements.
    SET NOCOUNT ON;
    DECLARE @Old_Gamechanger int;
    DECLARE @New_Gamechanger int;

    -- Insert statements for trigger here
    SELECT @Old_Gamechanger = Gamechanger from DELETED;
    SELECT @New_Gamechanger = Gamechanger from INSERTED;

    IF @Old_Gamechanger != @New_Gamechanger

        BEGIN

            INSERT INTO [dbo].T_History(ChangeDate, Reason, Callcenter_ID, Old_Gamechanger, New_Gamechanger)
            SELECT GETDATE(), 'Time for a change', Callcenter_ID, @Old_Gamechanger, @New_Gamechanger
                FROM deleted
            ;

        END

END 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2020-07-13T11:04:52.840

更新或删除的值存储在**DELETED**中。我们可以通过下面的方法在触发器中得到它

完整的例子，

```
CREATE TRIGGER PRODUCT_UPDATE ON PRODUCTS
FOR UPDATE 
AS
BEGIN
DECLARE @PRODUCT_NAME_OLD VARCHAR(100)
DECLARE @PRODUCT_NAME_NEW VARCHAR(100)

SELECT @PRODUCT_NAME_OLD = product_name from DELETED
SELECT @PRODUCT_NAME_NEW = product_name from INSERTED

END 
```

# .net - 会话项目在被删除后返回

> ID：642833
> 
> 赞同：0
> 
> 时间：2009-03-13T13:56:14.180
> 
> 标签：.net, asp.net, .net-3.5, asp.net-3.5

我使用 Session.Remove() 从会话中删除一个项目，然后重定向到另一个页面。如果我单击返回，然后重新加载，该项目会突然回到会话中。Session.Remove() 不应该把它从会话中删除吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-13T14:17:17.297

Remove 方法确实删除了该项目，并且它不能自行重新出现。

您正在查看页面的缓存版本，或者您在某处有代码再次将项目添加到 Session 对象。

您可以在页面的某处显示当前时间，以确定您是否看到缓存页面。

重新加载页面时按 ctrl 将告诉浏览器不要使用缓存数据。

# c# - 表单认证

> ID：642834
> 
> 赞同：5
> 
> 时间：2009-03-13T13:56:22.730
> 
> 标签：c#, .net, asp.net, authentication

我已经编程很长时间了，但我不是世界上最有经验的.Net 开发人员。我最近挑选了一个项目，该项目正在为他们的网站使用表单身份验证。我首先查看了 .Net 1.1 中的表单身份验证，当时它有一些限制，使我决定不将其用作我的主要身份验证形式。

该项目要求用户具有角色（我理解表单身份验证支持）和组成员身份。例如，“用户 A”是“公司 A”的“管理员”。表单身份验证现在是否支持这种用户结构？

我还读过表单身份验证将密码以纯文本形式发回。此客户端不使用 SSL。这是真的？

当前代码库使用表单身份验证，但不支持组（它支持角色）。因此，我需要修改表单身份验证以支持所需的组，或者删除表单身份验证并使用我通常使用的身份验证框架。如果表单身份验证确实支持组并且足够安全，那么我应该坚持下去。如果表单身份验证存在安全问题或不支持组，那么我需要删除该身份验证形式。

我在互联网上搜索了一篇优缺点文章，但没有运气。你们有什么感想？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-13T15:32:16.900

为了满足您的要求，您将使用 Forms Authentication with [Membership](http://msdn.microsoft.com/en-us/library/yh26yfzy.aspx)。如果您的应用程序使用 SQL Server 数据库，您可以使用 [SQLMembershipProvider](http://msdn.microsoft.com/en-us/library/system.web.security.sqlmembershipprovider.aspx)作为成员资格提供程序来实现此目的。

[检查 ASP.NET 2.0 的成员资格、角色和配置文件](http://aspnet.4guysfromrolla.com/articles/120705-1.aspx)可能是一个很好的开始参考。

关于您对在连接不安全时以纯文本形式发送密码的担忧。

实际上，发送的密码通常是经过哈希处理的（算法将取决于所选的成员资格提供者），并且最终会被存储。当然，如果连接不安全，则可以检索散列密码并用于破解应用程序，但至少您消除了普通用户密码被盗并用于访问其他服务的可能性（如您所知，许多人使用相同的密码）跨多个服务的密码）。所以为了安全起见，你真的需要在这里使用 https。

作为警告，我远非该领域的专家，但最近我遇到了您所描述的类似问题，因此我认为您可能会发现其中一些有用。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-13T14:06:34.827

表单身份验证不会将密码以纯文本形式发回。只要您确保登录/密码在接收时受到保护（即使用 https ... ssl），就没有安全风险。

如果您确实需要以这种方式进行授权，则可以依靠表单身份验证进行...身份验证，并使用自己的机制进行授权。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-13T14:29:12.777

Forms Auth 是您所追求的绝佳选择。它确实支持角色，但不支持组。但是，它确实内置了对活动目录集成的支持，如有必要，您可以使用它来缓解组问题。就个人而言，我会坚持你所拥有的并了解更多。如果您想使用 Forms Auth 的 Forms 模式而不是 AD auth 模式，我会考虑使用现有的 forms auth 数据库构建组支持。

我强烈建议您观看[这些](http://www.asp.net/learn/security-videos/)来自 Microsoft 的有关表单身份验证的视频。你会发现它使用起来非常简单。诚然，它不是你可以拼凑起来的东西，因为它是一个相当健壮和灵活的框架。你会想要阅读它并观看这些视频。但是，当您熟悉它时，您会发现它是安全的、受支持的，并且很受开发社区的欢迎。

哎呀，我刚刚再次查看了您的问题，您说他们不使用 SSL。这个网站需要有多安全？对我来说，这将是我的首要任务是迁移到 SSL！

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-13T14:58:51.440

Forms Authentication 本身不支持组。我们所做的是使用它来“验证”用户（证明他们是谁），然后我们使用我们自己的数据存储来“授权”用户（描述他们可以做什么）。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-13T14:49:22.383

db不存储它使用md5或其他一些散列方式的纯密码文本......我知道他们正在将2个散列字符串相互匹配以验证他们是否转换字符串客户端或服务器端我不确定..它可能是浏览器...如果您正在考虑使用 ssl，我认为您不应该使用 ASP.net 表单身份验证...是时候让您自己进行基于表单的身份验证并进行一些广告挖掘了...。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-13T19:40:31.357

感谢所有输入。虽然我认为我会继续在其他项目中使用我自己的身份验证库，但我认为对这个客户最好的做法是坚持使用他们已经部分实施的表单身份验证。

尽管我使用 Visual Studio 和 .Net 平台进行开发，但我并不总是喜欢以“微软”的方式做事。我发现很多时候“微软”的方式会引入很多开销，如果你知道自己在做什么，这些开销是可以避免的。

再次感谢您的输入。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2011-01-04T21:43:46.510

如果您不使用 SSL，则必须通过网络以明文形式传递密码。因此需要 SSL。

.Net Forms Authentication 将正确地散列密码并将密码存储到数据库，但这不会保护网络上的凭据。但这适用于所有 Web 框架。

至于这部分你必须在你的应用程序中实现它或找到一些库来帮助你。

# sql - SQL Cache Dependency 的性能问题

> ID：642848
> 
> 赞同：23
> 
> 时间：2009-03-13T14:00:07.447
> 
> 标签：sql, sql-server-2005, sql-server-2008, sqlcachedependency

我正在做一个项目，我们正在考虑将 SQLCacheDependency 与 SQL Server 2005/2008 一起使用，我们想知道这将如何影响系统的性能。

所以我们想知道以下问题

SQLCacheDependency 对象（查询通知）的数量是否会对 SQL Server 性能产生负面影响，即对受影响表的插入、更新和删除操作？

例如，在 SQL Server 2005/2008 中，单个表上的 50000 个不同查询通知对该表的插入和删除会产生什么影响（性能方面）。

有没有关于如何使用 SQLCacheDependencies 的建议？有什么官方的注意事项吗？我们在 Internet 上找到了一些信息，但没有找到有关性能影响的信息。

如果这里有人对这些问题有一些答案，那就太好了。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2010-03-25T13:45:44.857

使用轮询机制的 SQL Cache 依赖不应该是 sql server 或 application server 的负载。

让我们看看 sqlcachedependency 工作和分析它们的所有步骤：

1.  为 sqlcachedependency 启用数据库。
2.  一个表说 'Employee' 为 sqlcachedependency 启用。（可以是任意数量的表）
3.  Web.config 已更新以启用 sqlcachedependency。
4.  配置了使用 sql 缓存依赖项的页面。而已。

内部：

*   步骤 1\. 在数据库中创建一个表“ASPnet_sqlcachetablesforchangenotification”，该表将存储启用了 sqlcachedependency 的“Employee”表名。并添加一些存储过程。
*   步骤 2\. 在“ASPnet_sqlcachetablesforchangenotification”表中插入一个“Employee”表条目。还在此“员工”表上创建插入更新删除触发器。
*   步骤 3\. 通过提供连接字符串和 polltime 启用 sqlcachedependency 应用程序。

每当“Employee”表发生变化时，就会触发触发器，进而更新“ASPnet_sqlcachetablesforchangenotification”表。现在应用程序每 5000 毫秒轮询一次数据库，并检查对“ASPnet_sqlcachetablesforchangenotification”表的任何更改。如果有 r 任何更改，则相应的缓存将从内存中删除。

缓存与数据新鲜度相结合的巨大好处（最多数据可以陈旧 5 秒）。轮询由后台进程负责，不应成为性能障碍。因为正如您从上面的列表中看到的那样，该任务对 CPU 的要求最低。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-07-21T14:22:20.273

SQLCacheDependency 实现为索引视图，每次修改表时，此视图索引都会更改。同一张表上有这么多视图（SQLCacheDependency 对象）意味着修改的性能相当不错。但是，如果每个表有 1 个视图（SQLCacheDependency 对象），则应该没有问题。

缓存更改通知是异步的，并在服务器有资源时触发。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-10-10T16:32:44.270

你是对的，没有提供太多关于这方面的信息，但在这个页面中有一个与你的问题相关的短语[http://msdn.microsoft.com/en-us/library/ms178604%28VS.80%29.aspx](http://msdn.microsoft.com/en-us/library/ms178604%28VS.80%29.aspx)

“与 SQL 缓存依赖相关的数据库操作很简单，因此不会在服务器上产生沉重的处理成本。”

希望这对您有所帮助，尽管您的问题已经有点老了。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-08-10T04:57:21.220

我所能提供的只是有关性能的轶事证据，但我们使用 SqlCacheDependency 作为一种“消息传递解决方案”，适用于每小时处理一万条消息的大型企业应用程序。

基本架构是我们公司使用 Perforce 进行源代码控制，并且我们有一个“订阅服务”，它从触发 Web 服务调用接收消息，然后在每次 p4 提交时调用并将一条记录插入 SQL 数据库。我们的应用程序具有依赖项设置，可以为影响您正在监视的分支或路径的每个更改发送订阅通知。

表现还不错。触发器运行大约 200 毫秒，我们从未抱怨过将消息中继给最终用户的延迟。

与往常一样，您的里程可能会有所不同。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-31T04:20:15.237

[这个页面](http://www.asp.net/learn/data-access/tutorial-61-cs.aspx)似乎有一些关于设置使用哪种技术的好信息（当然我只是略过它）。

# .net - 发布 ASP.NET 应用程序时，是否应该在 Visual Studio 配置管理器中将构建类型更改为发布？

> ID：642851
> 
> 赞同：14
> 
> 时间：2009-03-13T14:00:48.647
> 
> 标签：.net, asp.net, visual-studio, debugging, publishing

对于我的生产站点，我通常将 Web.Config 中的“调试”标志更改为“假”。但是我总是在将配置管理器设置为“调试”的情况下发布我的站点。我也应该更改此设置吗？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-04-06T17:32:07.027

是的，你应该 - 虽然它是否有所作为取决于你的网站是如何编码的。只有同一个解决方案中的预编译站点（Web 应用程序项目）或类库才会关心。ASP.NET 站点（网站项目）将在服务器上编译，并将检查 web.config 的调试设置。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-03-13T14:13:43.390

是的，正如[MSDN](http://msdn.microsoft.com/en-us/library/e8z01xdh(VS.71).aspx)中所建议的那样：

> 启用调试模式将极大地影响 ASP.NET 应用程序的性能。请记住在部署发布应用程序或进行性能测量之前禁用调试模式。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-03-13T14:06:50.287

是的，一点没错。将其设置为 release 将编译代码而无需调试符号并使用正确的条件编译（即#if DEBUG）。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-03-13T14:08:08.940

是的 Release 将编译一个更小的 DLL

# python - 带有 wxPython 的 WinXP 按钮样式

> ID：642853
> 
> 赞同：3
> 
> 时间：2009-03-13T14:01:28.770
> 
> 标签：python, coding-style, wxpython

我注意到我用 wxPython 编写的程序具有 Win98 按钮样式。但是 Boa Constructor（也是用 wxPython 编写的）有漂亮的按钮。

如何使按钮看起来像当前的 Windows 按钮样式？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-13T15:12:38.693

您是否使用 py2exe 打包应用程序？

如果是这样，您可能需要指定一个清单文件以使 Python 使用 WinXP(Vista?) 主题/通用控件：

[http://wiki.wxpython.org/DistributingYourApplication](http://wiki.wxpython.org/DistributingYourApplication)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-13T15:15:26.597

扩展[John 的答案](https://stackoverflow.com/questions/642853/winxp-button-style-with-wxpython/643165#643165)，您还可以创建清单文件`python.exe`并`pythonw.exe`查看新样式，而无需先使用 py2exe 打包。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-08T20:44:54.420

到目前为止的答案处理将包分发为可执行文件（例如py2exe），其中已经给出了答案。

`.py`但是由于（我认为）python 2.6 刚从命令行（Vista 和 Windows7）启动文件时，您会遇到同样的问题。Robin Dunn 建议使用`update_manifest.py`它与 wxPython 一起分发并将其放在与 python.exe 相同的目录中。

在`update_manifest.py`使用 python.exe 的复制版本应用后，wxPython 应用程序具有正确的主题外观，是的，它也可以使用 windows7 RC1。

* * *

## 回答 #4

> 赞同：-2
> 
> 时间：2009-03-13T14:26:00.083

您是否尝试过使用 pythonw.exe 而不是 python.exe 运行脚本？

# asp.net - 在 ASP.net C# 中伪造浏览器请求

> ID：642860
> 
> 赞同：7
> 
> 时间：2009-03-13T14:02:53.773
> 
> 标签：asp.net, http-headers, c#-2.0

我正在使用下面的代码来拉入我们的第 3 方开发页面之一，以便我可以将其解析为 XML 以用于我的随机工作。

令人恼火的是，我们仍然在服务器上设置了浏览器检测级别，只允许某些浏览器访问该站点；所以问题是我将如何伪造它以便服务器认为它是浏览器请求？

```
 static string GetHtmlPage(string strURL)
    {

        String strResult;
        System.Net.WebResponse objResponse;

        System.Net.WebRequest objRequest = System.Net.HttpWebRequest.Create(strURL);

        objResponse = objRequest.GetResponse();
        using (System.IO.StreamReader sr = new System.IO.StreamReader(objResponse.GetResponseStream()))
        {
            strResult = sr.ReadToEnd();
            sr.Close();
        }
        return strResult;
    } 
```

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-03-13T14:15:51.607

浏览器检测是基于对服务器的请求中的标头完成的。您需要做的就是设置该标题。但是，使用 HttpWebRequest 您不是通过 headers 集合设置它，而是使用 .UserAgent 属性。

```
...
System.Net.WebRequest objRequest = 
   System.Net.HttpWebRequest.Create(strURL);

//Pretend to be IE7
((System.Net.HttpWebRequest)objRequest).UserAgent = 
   "Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 6.0)";

objResponse = objRequest.GetResponse();
... 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-06-02T03:43:46.557

您可以在 Page 中使用 ClientTarget 属性。例如

[http://msdn.microsoft.com/en-us/library/system.web.ui.page.clienttarget.aspx](http://msdn.microsoft.com/en-us/library/system.web.ui.page.clienttarget.aspx)

[http://msdn.microsoft.com/en-sg/library/6379d90d(v=vs.85).aspx](http://msdn.microsoft.com/en-sg/library/6379d90d(v=vs.85).aspx)

根据需要设置配置...

例如

```
<configuration>
   <system.web>
      <clientTarget>
         <add alias="ie5" userAgent="Mozilla/4.0 (compatible;MSIE 5.5;Windows NT 4.0)"/>
         <add alias="ie4" userAgent="Mozilla/4.0 (compatible;MSIE 4.0;Windows NT 4.0)"/>
         <add alias="uplevel" userAgent="Mozilla/4.0 (compatible;MSIE 4.0;Windows NT 4.0)"/>
         <add alias="downlevel" userAgent="Unknown"/>
      </clientTarget>
   </system.web>
</configuration> 
```

然后您可以按如下方式使用它。

```
<asp:Page ClientTarget="downlevel" /> 
```

这将伪造请求！

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-13T14:10:39.950

我认为大多数（如果不是全部）浏览器检测是基于由 HttpRequest.UserAgent 属性设置的 User-Agent 标头。我看到有一个用于各种浏览器的用户代理字符串的网站：[http ://www.user-agents.org/](http://www.user-agents.org/)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-13T14:28:06.803

**与上面的瓦尔登湖一样，但必须更换**

```
objRequest.UserAgent = 
   "Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 6.0)"; 
```

**和**

```
((System.Net.HttpWebRequest)objRequest).UserAgent = "Mozilla/5.0 (compatible; Googlebot/2.1; http://www.google.com/bot.html)"; 
```

**不然就倒了。（我将浏览器更改为 googlebot 以逃避我们的 cookie 服务器）**

# php - 动态获取驱动器内容

> ID：642864
> 
> 赞同：0
> 
> 时间：2009-03-13T14:04:07.330
> 
> 标签：php

在我的项目中，我有一种情况，当我选择驱动器号时，它会显示共享驱动器中的相应文件。为此，我使用以下代码找到与我的系统连接的驱动器

```
echo "<select id = 'drives'><option>Drives</option>";
for ($ii=66;$ii<92;$ii++) {
    $char = chr($ii);
    if(opendir($char.":/")) echo "<option>".$char."</option>";
}
echo "</select>";` 
```

但我选择的驱动器号对应的文件不显示。请帮我取文件。提前致谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-13T14:09:18.377

一个巧妙的方法是使用[`DirectoryIterator`](http://www.php.net/DirectoryIterator)：

```
$it = new DirectoryIterator($char . ':/');
foreach ($it as $file)
    echo $file->getFilename(); 
```

另请参阅[`SPLFileInfo`](http://www.php.net/SplFileInfo)。

# ruby-on-rails - 急切加载最后一个从属记录

> ID：642869
> 
> 赞同：4
> 
> 时间：2009-03-13T14:04:47.700
> 
> 标签：ruby-on-rails, activerecord

假设模型 X 有_many Ys 和模型 Y 属于_to X。每个 Y 都有一个插入数据库的日期。现在，是否可以为每个 X 加载所有 X 并急切加载最后一个 Y（仅最后一个，因为每个 X 都有无数个 Y）？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-03-13T23:24:01.337

是的，

让我们举这个例子

```
class Song < ActiveRecord::Base
   has_many :votes
end

class Vote < ActiveRecord::Base
  belongs_to :song
end 
```

为歌曲添加新关联

```
# for Rails version <4:
has_one :last_vote, :class_name => 'Vote', :order => 'created_at DESC'

# for Rails version 4+
has_one :last_vote, -> { order(created_at: :desc) }, class_name: 'Vote' 
```

这个新的关联总是会返回最近创建的对歌曲的投票。

急切地加载它

```
# for Rails version <3:
songs = Song.find(:all, :conditions => 'artist_name = "frank"', :include => :last_vote)

# for Rails version 3+:
songs = Song.includes(:last_vote).where(artist_name: 'frank') 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-14T11:19:13.490

以前的解决方案真的很棒！但是，我正在寻找更多功能：是否可以在特定日期之前急切加载最后一个从属记录？这是必需的，以便我的用户可以浏览歌曲投票的历史记录（带有前几天和后几天的链接）。

# python - Visual C++ 2005 构建步骤中的 Python 脚本未产生其他进程

> ID：642877
> 
> 赞同：2
> 
> 时间：2009-03-13T14:06:30.787
> 
> 标签：python, visual-c++, post-build-event, spawn, spawning

我在调用 Python 2.5.1 脚本的 VC++ 2005 项目中有以下构建后步骤：

```
postbuild.py 
```

postbuild.py 会：

```
import os
os.system('cd') # cd is just a test, could be anything 
```

该进程永远不会启动，并且与我尝试的任何其他进程相同，即使使用 subprocess.call 或 Popen 而不是 os.system。

有谁知道与 Python 2.5.1 中的此类问题或 Visual C++ 2005 SP1 中的构建事件相关的任何事情？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-13T14:39:37.197

解决了。出于某种原因，使用“postbuild.py”作为后期构建步骤会阻止 python 脚本生成其他进程，其中“python.exe postbuild.py”没有问题，“pythonw.exe postbuild.py”也没有问题。我不确定为什么会发生这种情况，因为从 cmd.exe 使用所有三种方法都有效。

但我想知道是否有人对此有解释。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-13T14:27:07.477

请注意，构建后事件只会在构建完成后立即运行。如果项目已经构建（因此不需要再次构建），则构建后步骤根本不会运行。

如果您正在编辑 python 脚本，然后尝试通过构建项目来使其运行，那么除非您每次都在项目中编辑文件以强制构建，否则它不会做任何事情。

# winforms - 如何在字符串数组中插入和显示新行？

> ID：642886
> 
> 赞同：0
> 
> 时间：2009-03-13T14:08:51.903
> 
> 标签：winforms, listbox, arrays

我想在我的 winform 的列表框中显示一个新行。我的反手课上有这样的代码。

```
 string[] a = new string[att]; //String array contains the attributes.
        if (attCol != null)
            for (int i = 0; i < att; i++)    //Loop through entire attributes
            {
                a[i] = " Attribute name:  " + attCol[i].Name + " , " + "Attribute value: " + attCol[i].Value; //Retrieving attribute name and values from the array.
            }
        return a; //returning the string array to be displayed in listbox 
```

这里**返回一个**字符串 [] 数组将返回给 UI 类，其中包含这样的代码

```
string[] attributecoll = new string[xNode.Attributes.Count];   //Declaration of String array where all the attributes of selected node are returned
            attributecoll = classObj.selectedNode(xNode);    //calling the selectedNode method from backend class and store it in a string array
            foreach (string c in attributecoll)
            {
                listBox1.Items.Add(c);     //adding the name and values of Attribute in the Listbox
            } 
```

xml 文件元素的示例

```
enter code here
<person name="John"/> 
```

这会在单行的列表框中显示属性名称和值，如下所示：

属性名称：name ，属性值：John

但我希望它在 listboxas 中像这样显示：

属性名称：名称

属性值：约翰

你能告诉我我哪里出错了吗？谢谢你的帮助...

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-13T14:25:14.767

您可以尝试在字符串中添加“\n”

但是您也可以使用带有字符串的向量/列表，这样您就可以在单独的行中添加名称和值属性

编辑：这可能更好，保留两倍的字符串 (*2) 并为每个属性使用 2 行

```
string[] a = new string[att*2]; //String array contains the attributes.
if (attCol != null)
{
    int aIterator = 0;
    for (int i = 0; i < att; i++)    //Loop through entire attributes
    {
        a[aIterator++]  = " Attribute name: " + attCol[i].Name;
        a[aIterator++]  = "Attribute value: " + attCol[i].Value;
    }
}
return a; //returning the string array to be displayed in listbox 
```

# asp.net - 将时间戳存储到会话并计算时间差会导致问题

> ID：642889
> 
> 赞同：0
> 
> 时间：2009-03-13T14:09:20.110
> 
> 标签：asp.net, vb.net

我正在计算从 aspx 第 1 页到第 2 页需要多少秒。这个时间没有反映真正的时钟。错误在哪里？

在第 1 页我有：

```
Session("sessioncreated") = Now.Ticks 
```

在第 2 页我有：

```
Dim diff As Long = 0
If Not Session("sessioncreated") Is Nothing Then
  diff = Now.Ticks - Session("sessioncreated")
End If
Dim timediff As Integer = TimeSpan.FromTicks(diff).Seconds 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-13T14:17:35.347

了解您遇到的问题会有所帮助...无论如何，我认为您应该更改：

```
Dim timediff As Integer = TimeSpan.FromTicks(diff).Seconds 
```

到

```
Dim timediff As Integer = TimeSpan.FromTicks(diff).TotalSeconds 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-13T14:24:09.357

采用：-

```
Session("sessioncreated") = Now
Dim diff as TimeSpan

If Not Session("sessioncreated") Is Nothing Then
   diff = Now - DirectCast(Session("sessioncreated"), DateTime)
End If
Dim timediff As Integer = diff.TotalSeconds 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-15T17:05:30.990

把事情简单化

```
 Dim stpw As New Stopwatch 'declare in the class

    'on page 1
    stpw.Reset()
    stpw.Start()

    'on page 2
    stpw.Stop()
    'stpw.Elapsed.TotalSeconds 'will contain seconds between the two 
```

# datetime - 如何使用 XSLT 将刻度转换为可读的日期时间？

> ID：642891
> 
> 赞同：14
> 
> 时间：2009-03-13T14:09:38.593
> 
> 标签：datetime, xslt, xslt-2.0

我有一个带有这样时间戳的 XML：

```
<node stamp="1236888746689" /> 
```

我想在结果 HTML 中将它们显示为日期和时间。有没有办法用 XSLT（任何版本）来做到这一点？

**编辑：** 我将 XSLT2.0 与 Saxon9 一起使用。基准日期是 1970-01-01 0:00。

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2009-03-13T14:31:02.333

您获取日期`1970-01-01T00:00:00`并添加邮票的值告诉您的毫秒数：

```
<xsl:stylesheet version="2.0" 
    xmlns:xsl="http://www.w3.org/1999/XSL/Transform"
    xmlns:xs="http://www.w3.org/2001/XMLSchema"
    xmlns="http://www.w3.org/TR/xhtml1/strict">

    <xsl:template match="node">
        <xsl:value-of
select='xs:dateTime("1970-01-01T00:00:00") + @stamp * xs:dayTimeDuration("PT0.001S")'/>
    </xsl:template>

</xsl:stylesheet> 
```

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-03-13T14:54:10.407

如果您使用的是支持[EXSLT 日期函数](http://exslt.org/date/index.html)的 XSLT 1.0 处理器（我刚刚在 PHP 中使用[libxslt](http://www.xmlsoft.org/XSLT/)[`date:add()`](http://exslt.org/date/functions/add/index.html)进行了测试），您可以使用and [`date:duration()`](http://exslt.org/date/functions/duration/index.html)：

```
<xsl:value-of select="date:add('1970-01-01T00:00:00Z', date:duration(@stamp div 1000))"/> 
```

该`date:duration()`函数需要几秒钟（因此您必须将毫秒除以 1000）并将其转换为“持续时间”（在本例中为“ `P14315DT20H12M26.6889998912811S`”），然后将其添加到您的纪元的开头（看起来像标准纪元，对于这个邮票)`date:add()`来获得一个 " `2009-03-12T20:12:26.6889998912811Z`" 的邮票。然后，您可以使用 EXSLT 日期函数或仅[`substring()`](http://www.w3.org/TR/xpath.html#function-substring)根据您的需要格式化它。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2011-03-02T23:33:07.257

迟到的答案，是的，我知道，但我在这里找不到我要找的那个，所以我想我会用我的解决方案来支付它。

我的 XML 是使用 export_node 和 drush 从 Drupal 转储的几个节点。我在 PHP5 中使用 xslt 处理器，它只支持 xslt 1.0。某些 EXSLT 函数似乎受支持，但我不知道是我的语法错误还是我尝试使用的函数不受支持。无论如何，以下对我有用。我使用了来自 w3schools.com 的示例代码，但在声明 xsltprocessor 之后添加了一行，如下所示：

$xp = 新 XsltProcessor();
$xp->registerPHPFunctions();

PHP 有一个简单的日期转换功能，所以我作弊并使用了 PHP 处理器，因为我已经在使用它来转换我的 xsl。

```
<xsl:for-each select="node_export/node">
  <xsl:value-of select="php:function('date', 'n-j-y', number(timestamp))"/>
</xsl:for-each> 
```

希望这可以帮助那里的人。当我解决这个问题时，我敲了很长时间。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-13T14:53:22.873

如果您想使用不支持[EXSLT 日期和时间函数](http://www.exslt.org/date/index.html)的 XSL 1.0 处理器，这并非易事，但已经完成。

您可以查看[Katy Coe 的“iso-from-unix”函数的 XSLT 1.0 实现](http://www.djkaty.com/xsl-date-time)。这是她创建的一组相当庞大的“免费用于非商业用途”的日期和时间函数的一部分。

但是，您的 XSL 处理器必须支持[`"http://exslt.org/functions"`](http://www.exslt.org/func/index.html)命名空间才能使此实现工作。除此之外，不依赖于 EXSLT。

PS：我知道 Unix 时间戳和刻度并不*完全相同*。不过，它们已经足够近了。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-13T14:13:19.693

XSLT 是[图灵完备](http://en.wikipedia.org/wiki/Turing_complete)的，所以一定有办法。:) 至少了解一点 XSLT，它可能会涉及递归。

您没有指定“滴答声”的确切解释，我猜自某个时代以来的毫秒数，但是哪个？1970 年？

# windows-services - IPC远程问题

> ID：642892
> 
> 赞同：2
> 
> 时间：2009-03-13T14:09:45.333
> 
> 标签：windows-services, ipc

我们使用 IPC 收到以下错误。
“无法连接到 IPC 端口：系统找不到指定的文件。” 该问题发生在 Windows 2003 服务器上。

当然，它只发生在生产中。我们无法在我们的开发环境中重现这一点。

尝试使用 IPC 的 Windows 服务正在作为本地系统运行。

是否有某种需要更改的权限？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-07T12:54:38.667

我们试图在频道启动之前访问它。所以我们会收到“未找到”错误。将访问代码包装在一些“是否真的准备好”代码中解决了这个问题。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-02T17:34:39.950

对我来说，DTA 工作正常。但突然我开始遇到同样的错误。

对我来说，修复是这样的：

```
-> Go To Task Manager
-> Go To Processes Tab
-> Find and kill the DTA process. For me this process is named as 'DTASHELL.exe' 
```

现在尝试启动 DTA。它现在应该可以工作了:-)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-09T15:05:11.430

我们在生产代码中遇到了这个问题。它在一小部分用户系统上失败了。

错误结果出现在我们使用的微软代码中。它使用用户名生成 IPC 通道。

ipc://APP_USER_000:SingeInstanceIPCChannel/SingleInstanceApplicationService

如果用户名中包含某些字符，则会生成无效的频道 URL，因此接收应用程序首先无法创建频道。

我们的解决方法是使用用户名的哈希，而不是用户名中的第一个字符。

（我们在这里使用代码：http: [//blogs.microsoft.co.il/blogs/arik/archive/2010/05/28/wpf-single-instance-application.aspx](http://blogs.microsoft.co.il/blogs/arik/archive/2010/05/28/wpf-single-instance-application.aspx)）

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-30T09:36:19.557

请发布您用于初始化服务器通道和发布对象的代码，以及您在尝试访问远程对象时使用的 uri 的客户端代码。

一个常见的陷阱是当您使用字典初始化通道，并使用设置通道的名称时

```
dic["name"] = "channelName";  
//used for retrieving the channel - ChannelServices.GetChannel("channelName"); 
```

代替

```
dic["portName"] = "channelName";
//used as the identifier for the named pipe - 
//The client should get the object from the uri : ipc://channelName/objectName 
```

# java - 从数组中删除元素（Java）

> ID：642897
> 
> 赞同：163
> 
> 时间：2009-03-13T14:11:47.920
> 
> 标签：java, arrays, element

是否有任何快速（且美观）的方法可以从 Java 中的数组中删除元素？

* * *

## 回答 #1

> 赞同：259
> 
> 时间：2009-03-13T21:40:26.030

您可以使用 commons lang 的 ArrayUtils。

```
array = ArrayUtils.removeElement(array, element) 
```

[commons.apache.org 库：Javadocs](http://commons.apache.org/proper/commons-lang/javadocs/api-2.6/org/apache/commons/lang/ArrayUtils.html)

* * *

## 回答 #2

> 赞同：47
> 
> 时间：2009-03-13T22:36:41.013

你的问题不是很清楚。从您自己的回答中，我可以更好地说明您要做什么：

```
public static String[] removeElements(String[] input, String deleteMe) {
    List result = new LinkedList();

    for(String item : input)
        if(!deleteMe.equals(item))
            result.add(item);

    return result.toArray(input);
} 
```

注意：这是未经测试的。错误检查留给读者作为练习（`IllegalArgumentException`如果其中一个`input`或`deleteMe`为空，我会抛出；空列表输入上的空列表没有意义。从数组中删除空字符串可能有意义，但我会留下它作为一个练习；目前，`NPE`当它尝试在`deleteMe`if`deleteMe`为 null 时调用 equals 时，它会抛出一个。）

我在这里做出的选择：

我用了一个`LinkedList`. 迭代应该同样快，并且避免任何调整大小，或在最终删除大量元素时分配太大的列表。您可以使用`ArrayList`, 并将初始大小设置为输入的长度。它可能不会有太大的不同。

* * *

## 回答 #3

> 赞同：46
> 
> 时间：2009-03-13T21:55:20.333

最好的选择是使用集合，但如果由于某种原因不可用，请使用[`arraycopy`](https://docs.oracle.com/javase/7/docs/api/java/lang/System.html#arraycopy(java.lang.Object,%20int,%20java.lang.Object,%20int,%20int)). 您可以使用它以稍微不同的偏移量从同一个数组复制到同一个数组。

例如：

```
public void removeElement(Object[] arr, int removedIdx) {
    System.arraycopy(arr, removedIdx + 1, arr, removedIdx, arr.length - 1 - removedIdx);
} 
```

* * *

编辑以回应评论：

这不是另一种好方法，它确实是唯一可接受的方法——任何允许此功能的工具（如 Java.ArrayList 或 apache utils）都将在幕后使用此方法。此外，你真的应该使用 ArrayList （或者如果你从中间删除了很多链接列表）所以这甚至不应该是一个问题，除非你把它作为家庭作业。

要分配一个集合（创建一个新数组），然后删除一个元素（该集合将使用 arraycopy 执行此操作），然后在其上调用 toArray（创建一个 SECOND 新数组），每次删除都会将我们带到不是优化问题的地步，这是非常糟糕的编程。

假设您有一个阵列占用了 100mb 的内存。现在您要遍历它并删除 20 个元素。

试试看...

我知道你假设它不会那么大，或者如果你一次删除那么多你会以不同的方式编码它，但我已经修复了很多代码，其中有人做出了这样的假设。

* * *

## 回答 #4

> 赞同：40
> 
> 时间：2009-03-13T14:13:57.523

您不能从基本 Java 数组中删除元素。请查看各种 Collections 和 ArrayList。

* * *

## 回答 #5

> 赞同：16
> 
> 时间：2009-03-13T14:15:29.640

看起来不错的解决方案是首先使用列表而不是数组。

```
List.remove(index) 
```

如果您*必须*使用数组，两次调用`System.arraycopy`很可能是最快的。

```
Foo[] result = new Foo[source.length - 1];
System.arraycopy(source, 0, result, 0, index);
if (source.length != index) {
    System.arraycopy(source, index + 1, result, index, source.length - index - 1);
} 
```

（`Arrays.asList`也是使用数组的好候选，但它似乎不支持`remove`。）

* * *

## 回答 #6

> 赞同：13
> 
> 时间：2010-08-13T12:40:17.547

*我认为问题是在不*使用 Collections API 的情况下寻求解决方案。一种将数组用于性能很重要的低级别细节，或者用于松散耦合的 SOA 集成。在后面，可以将它们转换为 Collections 并将它们传递给业务逻辑。

对于低级性能的东西，它通常已经被 for 循环等快速而肮脏的命令式状态混合所混淆。在这种情况下，在集合和数组之间来回转换是麻烦的、不可读的，甚至是资源密集型的。

顺便说一句，TopCoder，有人吗？总是那些数组参数！因此，请准备好在竞技场中处理它们。

以下是我对问题的解释和解决方案。它与[Bill K](https://stackoverflow.com/a/644764/244935)和[jelovirt](https://stackoverflow.com/a/642913/244935)给出的功能不同。此外，它可以优雅地处理元素不在数组中的情况。

希望有帮助！

```
public char[] remove(char[] symbols, char c)
{
    for (int i = 0; i < symbols.length; i++)
    {
        if (symbols[i] == c)
        {
            char[] copy = new char[symbols.length-1];
            System.arraycopy(symbols, 0, copy, 0, i);
            System.arraycopy(symbols, i+1, copy, i, symbols.length-i-1);
            return copy;
        }
    }
    return symbols;
} 
```

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2009-03-14T17:33:30.400

您可以使用[ArrayUtils API](http://commons.apache.org/lang/api-release/org/apache/commons/lang3/ArrayUtils.html)以“美观的方式”将其删除。它在数组上实现了许多操作（删除、查找、添加、包含等）。
看一看。它让我的生活变得更简单。

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2009-03-13T14:44:34.813

好的，谢谢，现在我用这样的东西：

```
public static String[] removeElements(String[] input, String deleteMe) {
    if (input != null) {
        List<String> list = new ArrayList<String>(Arrays.asList(input));
        for (int i = 0; i < list.size(); i++) {
            if (list.get(i).equals(deleteMe)) {
                list.remove(i);
            }
        }
        return list.toArray(new String[0]);
    } else {
        return new String[0];
    }
} 
```

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2010-09-09T09:31:57.173

Bill K 和 dadinn 写的那些还需要一些前置条件

```
Object[] newArray = new Object[src.length - 1];
if (i > 0){
    System.arraycopy(src, 0, newArray, 0, i);
}

if (newArray.length > i){
    System.arraycopy(src, i + 1, newArray, i, newArray.length - i);
}

return newArray; 
```

* * *

## 回答 #10

> 赞同：3
> 
> 时间：2012-10-28T18:17:55.800

您不能更改数组的长度，但您可以通过复制新值并将它们存储到现有索引号来更改索引保存的值。1=mike , 2=jeff // 10 = george 11 去 1 覆盖 mike 。

```
Object[] array = new Object[10];
int count = -1;

public void myFunction(String string) {
    count++;
    if(count == array.length) { 
        count = 0;  // overwrite first
    }
    array[count] = string;    
} 
```

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-03-13T14:16:02.840

我希望你使用java collection/java commons collections！

使用 java.util.ArrayList 您可以执行以下操作：

```
yourArrayList.remove(someObject);

yourArrayList.add(someObject); 
```

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2009-03-13T14:17:25.707

[将](http://java.sun.com/j2se/1.5.0/docs/api/java/lang/System.html#arraycopy(java.lang.Object,%20int,%20java.lang.Object,%20int,%20int))原始数组复制到另一个数组中，而不删除要删除的元素。

一种更简单的方法是使用 List、Set... 并使用 remove() 方法。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2009-03-13T14:26:01.660

如果对调整数组大小不感兴趣，则将要删除的项目与最后一个项目交换。

* * *

## 回答 #14

> 赞同：-4
> 
> 时间：2009-03-13T14:15:37.753

使用`ArrayList`：

```
alist.remove(1); //removes the element at position 1 
```

* * *

## 回答 #15

> 赞同：-6
> 
> 时间：2009-03-13T14:14:52.640

当然，创建另一个数组:)

# algorithm - 一点瓷砖

> ID：642901
> 
> 赞同：2
> 
> 时间：2009-03-13T14:13:42.017
> 
> 标签：algorithm, language-agnostic, optimization

我刚写完一个小脚本，将很多 png 图片组合成一个更大的 CSS Sprite 图片。

所以基本上，我有一个尺寸列表 [(w1,h2), ..., (wn,hn)]，我需要将它们放入一个尺寸为 (W,H) 且 WH 尽可能小的框架中。（当然不能重叠）

我使用的启发式显然不是最优的。我想知道你对这个主题有什么想法吗？您是否认为一些更智能的约束，例如将具有相似直方图的图像分组会使 png 更小？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-13T14:21:41.170

关于使生成的 png 更小：

确保使用最佳压缩级别（级别 9），如果可能，使用[PNGOUT](http://www.advsys.net/ken/utils.htm)更好地压缩 PNG（IrfanView 也有一个PNGOUT[插件](http://www.irfanview.net/)[）](http://www.irfanview.net/plugins.htm)。

将具有相似直方图的图像分组可能会很好，请注意 PNG 使用 zLib，它使用滑动窗口，因此如果将图像水平分组，效果最好。

编辑：可用空间相同。最好在图像的顶部或底部留出空闲空间，而不是在左侧或右侧。自由空间的颜色并不重要，一些颜色或黑色或白色应该没问题。

顺便说一句，zLib 滑动窗口的大小是 32K，所以如果图像很大，它对于检测图像重复不是很好。在这种情况下，您最好使用自己的算法自己处理图像，并使用一些重复删除或 delta 过滤器。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-13T19:40:08.190

从您如何提出问题来看，您想要优化的是图片的尺寸还是 PNG 文件的大小并不明显，因为图片直方图不会影响它们的尺寸（宽度和高度）。

然而，找到最小的 K 使得 max(W, H) < K，这样你的所有图片都可以适合一个宽 W 高 H 的矩形区域，这是一个 NP 完全问题，这意味着很难总体来说很好解决。例如，请参见[此处](http://www-rcf.usc.edu/~skoenig/icaps/icaps04/icapspapers/ICAPS04KorfR.pdf)。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-13T19:44:48.477

脚本的输出与[ImageMagick](http://www.imagemagick.org/)的输出相比如何？

# java - 部署后是否可以直接调用会话 bean 的方法？

> ID：642905
> 
> 赞同：0
> 
> 时间：2009-03-13T14:14:14.030
> 
> 标签：java, glassfish

我正在使用 GlassFish。这就是我想做的。我有不同的 ejb 模块，它们可以相互独立部署。但我想要一个中央 ejb 模块，所有部署的模块都必须注册。这是因为并非所有模块都必须部署。

我认为最好的方法是如果每个 ejb 模块都包含一个会话 bean（或其他任何东西），该会话 bean 具有特定方法，该方法将在模块部署后立即调用。但我发现没有这样的功能。整个过程应该在部署之后发生，因为那时客户端可以询问中央 ejb 模块的会话 bean，哪些模块目前已注册。

我已经尝试了生命周期功能，但是我必须创建一个自己的 jar 文件，该文件必须放在应用程序服务器的 lib 目录中，这并不是我真正想要的。此外，如果我调用中央 ejb 模块的 register 方法，则会抛出不允许此操作的异常。

有人知道我该如何管理吗？谢谢你的帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-13T17:23:38.970

您不能通过尝试在 JNDI 中查找它们来完成此操作吗？如果他们没有部署，他们就不会在那里。这是一种注册和查找机制，它只是将资源绑定到名称，但您可以假设如果找不到名称，则不会部署它。

# .net - 用于聊天框 (.net) 的表单控件

> ID：642918
> 
> 赞同：1
> 
> 时间：2009-03-13T14:16:18.470
> 
> 标签：.net, vb.net, winforms, chat

当我在 vb.net（windows 窗体）中做一个小型聊天应用程序时，我的聊天框设计有问题。我希望可以选择短信，以便用户可以复制（ctrl+v）它，但不能复制显示谁发送消息的用户名。我应该使用哪些表单控件来完成此操作以及从中更改哪些属性？谢谢你。另请记住，用户名及其消息必须正确对齐。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-13T14:21:32.590

抓住 ctrl+c 并解析用户名的选定文本并删除它们

（也许您可以制作用户名图像以防止标准文本复制粘贴）

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-23T06:08:17.290

您是否考虑过使用[DataGridView](http://msdn.microsoft.com/en-us/library/e0ywh3cz.aspx)控件？

您可以为用户名和消息设置单独的列，并且只允许从消息列复制。

如今，DataGridView 控件非常强大，可以让您根据需要自定义外观（例如，隐藏网格线使其看起来更像文本框）。

There are tips and hints all over the place, but [this page](http://www.dotnetcurry.com/ShowArticle.aspx?ID=132&AspxAutoDetectCookieSupport=1) shows how to change gridline colours.

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-21T13:33:18.360

好吧，这是一个非常酷的想法，但我对您的要求知之甚少，无法知道它是否适合您。我首先想到的是，如果我使用的是聊天应用程序，我想简单地单击一条消息并将其复制到剪贴板中。毕竟，我想不出还有什么需要点击消息的。因此，如果将鼠标悬停在一条消息上会使其突出显示，然后单击会导致它被复制，那就太好了。

如果这适用于您的情况，那么问题是如何实现这一目标。我认为您可以使用标签来显示发送消息的用户名，并使用只读文本框来显示消息本身。每次向聊天中添加新消息时，您都会插入一个新标签和一个新文本框（通过将这些控件添加到页面的控件集合中）。可能应该将标签和文本框包装在一个 div 中，以便在它们悬停时突出显示整个 div。

现在，如何使单击导致消息文本被复制到剪贴板？这将需要一些 JavaScript。如果您使用的是 JavaScript 库，请查看它提供的内容。如果没有，这里有一些链接。Javascript 代码只需要获取文本框的内容，它可以通过查找正确的 css 类或正确的 id 来完成。然后，按照这些链接中的说明将该文本复制到剪贴板：

[用于复制到剪贴板的 Javascript](http://www.dynamic-tools.net/toolbox/copyToClipboard/)

[关于用于复制到剪贴板的 Javascript 的第二个链接](http://www.frontpagewebmaster.com/m-185852/tm.htm)

[关于用于复制到剪贴板的 Javascript 的第三个链接](http://www.htmlgoodies.com/beyond/javascript/article.php/3458851)

[关于用于复制到剪贴板的 Javascript 的第四个链接](http://www.geekpedia.com/tutorial126_Clipboard-cut-copy-and-paste-with-JavaScript.html)

顺便说一句，也许您有要求用户应该能够选择许多消息的文本。在这种情况下，也许单击一条消息会“选择”它，并且您可以选择多个。然后，有一个“复制所有选定的消息”按钮。唯一不能处理的是选择消息文本的一部分。因此，它可能适合也可能不适合您的需求。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-23T06:45:30.557

By selecting the two text boxes and validating the username and password for two different users and take the list boxes for seeing the messages, in code open a socket connection to chat between the users.

# java - Swing：按下 ESC 键时如何关闭对话框？

> ID：642925
> 
> 赞同：62
> 
> 时间：2009-03-13T14:17:47.063
> 
> 标签：java, user-interface, swing

使用 Swing 进行 GUI 开发。

我有一个自定义对话框，用于选择要在我的应用程序中打开的文件；它的类扩展`javax.swing.JDialog`并包含除其他组件之外的 a `JFileChooser`，它可以切换为显示或隐藏。

该`JFileChooser`组件已经自行处理了 ESC 键：当显示文件选择器（嵌入在我的对话框中）并且我按下 ESC 时，文件选择器会自行隐藏。

现在我希望我的对话框也这样做：当我按 ESC 时，我希望对话框关闭。请注意，当显示嵌入式文件选择器时，ESC 键应该只隐藏它。

有任何想法吗 ？

* * *

## 回答 #1

> 赞同：72
> 
> 时间：2009-03-19T06:36:55.517

您可以使用以下代码段。这更好，因为 rootPane 将从对话框中的任何组件获取事件。如果需要，您可以将 setVisible(false) 替换为 dispose()。

```
public static void addEscapeListener(final JDialog dialog) {
    ActionListener escListener = new ActionListener() {

        @Override
        public void actionPerformed(ActionEvent e) {
            dialog.setVisible(false);
        }
    };

    dialog.getRootPane().registerKeyboardAction(escListener,
            KeyStroke.getKeyStroke(KeyEvent.VK_ESCAPE, 0),
            JComponent.WHEN_IN_FOCUSED_WINDOW);

} 
```

* * *

## 回答 #2

> 赞同：63
> 
> 时间：2009-03-13T14:21:02.297

用于处理 Swing 中的关键操作`InputMap`。`ActionMap`要干净地关闭对话框，请向它发送一个窗口关闭事件。

从我现在已经不复存在的博客中：

```
private static final KeyStroke escapeStroke = 
    KeyStroke.getKeyStroke(KeyEvent.VK_ESCAPE, 0); 
public static final String dispatchWindowClosingActionMapKey = 
    "com.spodding.tackline.dispatch:WINDOW_CLOSING"; 
public static void installEscapeCloseOperation(final JDialog dialog) { 
    Action dispatchClosing = new AbstractAction() { 
        public void actionPerformed(ActionEvent event) { 
            dialog.dispatchEvent(new WindowEvent( 
                dialog, WindowEvent.WINDOW_CLOSING 
            )); 
        } 
    }; 
    JRootPane root = dialog.getRootPane(); 
    root.getInputMap(JComponent.WHEN_IN_FOCUSED_WINDOW).put( 
        escapeStroke, dispatchWindowClosingActionMapKey 
    ); 
    root.getActionMap().put( dispatchWindowClosingActionMapKey, dispatchClosing 
    ); 
} 
```

* * *

## 回答 #3

> 赞同：16
> 
> 时间：2014-06-20T16:38:15.587

如果您正在寻找使用 Java 8 新特性的技术，请尝试使用 lambda 表达式：

```
dialog.getRootPane().registerKeyboardAction(e -> {
    window.dispose();
}, KeyStroke.getKeyStroke(KeyEvent.VK_ESCAPE, 0), JComponent.WHEN_IN_FOCUSED_WINDOW); 
```

或者

```
KeyStroke k = KeyStroke.getKeyStroke(KeyEvent.VK_ESCAPE, 0);
int w = JComponent.WHEN_IN_FOCUSED_WINDOW;
dialog.getRootPane().registerKeyboardAction(e -> window.dispose(), k, w); 
```

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2014-08-10T20:51:08.507

我在实现两个最佳答案时遇到了问题。这是一个相当紧凑的版本，`AbstractAction`用于自动实现大多数`Action`'s 方法，它适用于基于文本的字段（根据@pratikabu 的请求）：

```
final AbstractAction escapeAction = new AbstractAction() {
    private static final long serialVersionUID = 1L;

    @Override
    public void actionPerformed(ActionEvent ae) {
        dispose();
    }
};

getRootPane().getInputMap(JComponent.WHEN_IN_FOCUSED_WINDOW)
        .put(KeyStroke.getKeyStroke(KeyEvent.VK_ESCAPE, 0), "ESCAPE_KEY");
getRootPane().getActionMap().put("ESCAPE_KEY", escapeAction); 
```

### 参考

*   以上回答
*   [http://www.coderanch.com/t/335357/GUI/java/KeyPressed-JDialog](http://www.coderanch.com/t/335357/GUI/java/KeyPressed-JDialog)

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2017-05-11T03:00:57.503

这是我的，我也添加`Ctrl``W`为关闭快捷方式

```
 Action closeAction = new AbstractAction(){
        public void actionPerformed(ActionEvent e){
            dispose();
        }
    };

    KeyStroke esc = KeyStroke.getKeyStroke(KeyEvent.VK_ESCAPE,0);
    getRootPane().getInputMap(JComponent.WHEN_IN_FOCUSED_WINDOW).put(esc, "closex");
    getRootPane().getActionMap().put("closex", closeAction);

    KeyStroke ctrlW = KeyStroke.getKeyStroke("control W");
    getRootPane().getInputMap(JComponent.WHEN_IN_FOCUSED_WINDOW).put(ctrlW, "close");
    getRootPane().getActionMap().put("close", closeAction); 
```

# c# - 使用 C# 中的 Scripting.Dictionary

> ID：642928
> 
> 赞同：2
> 
> 时间：2009-03-13T14:19:16.357
> 
> 标签：c#, com, interop, activex

我需要在我的 C# 应用程序和另一个应用程序之间传递一个 Scripting.Dictionary。我希望能够在我的 C# 应用程序中创建和修改字典的实例。

一般来说，我对 Scripting.Dictionary 和 ActiveX 知之甚少。各种论坛建议我应该使用 System.Type.GetTypeFromProgID() 和 System.Activator.CreateInstance() 之类的函数来创建实例。不幸的是，这意味着它对我的其余代码来说是一个不透明的对象。

这真的是应该如何完成还是有更好的方法？理想情况下，我想导入一个编译时类型，然后像任何其他类型一样使用它。这可能吗？

[本文](http://asp.dotnetheaven.com/howto/doc/Interop/Building_Samples_NET2COM.aspx)建议我从供应商处获取“元数据程序集”——有谁知道 Scripting.Dictionary 是否存在这样的程序集？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-03-16T09:26:00.197

我刚刚尝试了最简单的方法，它似乎有效：

在 Visual Studio 中添加对 scrrun.dll 的 COM 引用（它应该显示在“添加引用”对话框的 COM 选项卡中），Visual Studio 将自动为您创建互操作文件。然后，您可以编写如下代码：

```
Scripting.Dictionary d = new Scripting.DictionaryClass();
d.Add( ref myKey, ref myValue );
MyComType.Method( d ); 
```

如果您对此有任何疑问，我可以发布更多示例，或者澄清一下。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-13T14:52:11.270

创建一个实现 IDictionary 并使用 Scripting.Dictionary 作为其内部存储实现的包装字典类。在您的 .NET 代码中使用包装器并通过 COM 将内部 Scripting.Dictionary 传递给其他应用程序。

# asp.net - 阻止访问者打开某些页面

> ID：642932
> 
> 赞同：2
> 
> 时间：2009-03-13T14:20:18.413
> 
> 标签：asp.net, forms-authentication, verification, sessionid

我有 ASP.Net 2.0 网站，其中 SQL Server 作为数据库，C# 2005 作为编程语言。该网站几乎已完成，所有链接都可以正常工作。但我想阻止普通用户打开几页。当任何用户单击这些特定链接时，将打开另一个页面，其中包含一个 ASP 登录控件。用户必须提供有效的用户名和密码才能显示指向限制性页面的链接。但作为一个新手，我不知道如何利用 ASP 登录控件的全部功能。因为，如果用户知道受限页面的确切 url，那么他/她可以绕过登录控制，通过在地址栏中输入 url 直接访问这些页面。我想防止这种情况。如果用户直接在地址栏中键入 url，我希望页面本身应该检查，

我如何实现这个功能？

谢谢你。

拉利特·库马尔·巴里克

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-03-13T14:29:52.120

您需要查看web 配置的[位置部分。](http://msdn.microsoft.com/en-us/library/b6x6shw7.aspx)

在该部分中，您可以将访问权限定义到页面级别，因此用户是否知道受保护页面的 URL 无关紧要，ASP.NET 不会让他们进入。

所以你会添加类似的东西：

```
<location path="SecuredPage.aspx">
  <system.web>
     <authorization>
        <deny users="?"/>
     </authorization>
  </system.web>
</location> 
```

"deny users="?"" 位表示“拒绝所有匿名用户”。

如果您正在使用某些角色，您还可以将其设置为仅允许某些角色。

可以在此处找到有关授权部分的更多信息：

> [授权元素](http://msdn.microsoft.com/en-us/library/8d82143t.aspx)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-13T14:52:01.927

这是 ASP.Net 会员服务的食物。看看[这篇文章](http://msdn.microsoft.com/en-us/library/yh26yfzy.aspx)以及4GuysFromRolla[上的精彩系列](http://aspnet.4guysfromrolla.com/articles/120705-1.aspx)。

成员资格允许您存储登录控件使用的用户/密码信息。再加上授权配置，您将能够直接将对特定页面的访问范围缩小到特定用户或角色。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-13T14:29:49.030

您将需要一种方法来管理每个用户的登录会话。以下是一些可以帮助您的教程：

[http://www.codeproject.com/KB/session/NoCookieSessionLogin.aspx](http://www.codeproject.com/KB/session/NoCookieSessionLogin.aspx)

[http://www.dotnetspider.com/resources/5597-Handling-Session-for-Login-Logout.aspx](http://www.dotnetspider.com/resources/5597-Handling-Session-for-Login-Logout.aspx)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-13T14:33:31.970

您应该在必须控制权限的页面上的每个事件中验证用户的登录状态`Page_Load()`，或者简单地将身份验证代码放入将包含在所有其他文件中的 CS 文件中。

根据您选择的身份验证架构（只需使用会话变量，或使用 cookie 创建会话 id），您必须相应地调整您的代码。

最简单的方法是通过会话对象管理登录。当用户使用正确的凭据正确登录时，您可以设置`Session["logged_in"] = true`. 在您要保护的页面的每个`Page_Load()`事件上，您都需要进行以下检查。

在 Page_Load() 函数的开头添加此代码：

```
 if (Session["logged_in"] != null && (bool)Session["logged_in"] == true){
    Response.Write("I'm logged in!");
  }else{
    Response.Write("I'm not logged in.");
  } 
```

请记住，这对于简单的 Intranet 应用程序来说是可以的，但是如果您想进入更安全的登录架构，请阅读有关该主题的更多信息，因为仅依赖会话变量是不安全的，因为会话可能被劫持。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-16T12:49:06.447

我会为用户制作一个角色表。每个登录的人都会获得“正常”角色。您通过其凭据指定的特殊用途将获得分配角色以访问您网站的页面或部分。某些用户（例如您自己）将获得管理员角色，自动允许他们访问所有内容。

触发一个名为 CheckIsInRoles('Admin', 'Normal', 'WhateverRoleYouChoose') 的函数，它返回一个布尔值。如果为真，则加载页面；如果没有，不要。

如果角色不正确，最好不要显示链接。

这有一个额外的好处，即每个人都登录一次，然后访问他们需要的所有页面，而不必每次都登录。

# c# - C# 泛型函数

> ID：642933
> 
> 赞同：13
> 
> 时间：2009-03-13T14:20:49.863
> 
> 标签：c#, generics

有人可以在泛型中解释这种行为吗？

我在 C# 中有一个通用函数

```
protected virtual void LoadFieldDataEditor <T> (ref T control, string strFieldName) where T : Control
{
  //T can be different types of controls inheriting from System.Web.UI.Control
  if (control is TextBox)
  {
   //This line gives an error
   //((TextBox)control).Text = "test";

   //This line works! 
   (control as TextBox).Text = "Test";
  }
} 
```

附带说明一下，当我进行“控件是文本框”类型的检查时，我可以使用开关盒吗？

编辑：

忘记添加错误信息对不起！

干得好：

```
Error   3   Cannot convert type 'T' to 'TextBox' 
```

编辑：

当我们谈论泛型时，我还有另一个问题。（不确定我是否必须开始新帖子）

该方法已扩展为包含另一种泛型类型

```
protected virtual void LoadFieldDataEditor <T1, T2> (T1 control, T2 objData, string strFieldName) where T1 : Control where T2 : BaseDataType
{
  //I will need to access field1\. 
  //I don't know at compile time if this would be SomeType1 or 
 //SomeType2 but all of them inherit from BaseDataType. 

  //Is this possible using generics?
}

public abstract class BaseDataType {}

public class SomeType1 : BaseDataType
{
   string field1;
   string field2;
} 
```

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2009-03-13T14:30:18.077

泛型类型可以转换为什么的规则非常棘手，并且有时违反直觉，就像在这种情况下一样。有关详细信息，请参阅 C# 规范的第 6.2.6 节。有些地方他们可以更宽松，我认为这就是其中之一。你*可以*向上投射`object`然后再次向下投射，但这很丑陋。

在这种情况下，更好的解决方案是：

```
protected virtual void LoadFieldDataEditor <T> (ref T control,
                                                string strFieldName) 
    where T : Control
{
    TextBox textBox = control as TextBox;
    if (textBox != null)
    {
        textBox.Text = "test";
    }
} 
```

除此之外，这只需要一次执行时间检查，而不是两次。

旁注：不，您不能在类型上使用开关/大小写。（您可以获取类型名称并打开它，但这会很糟糕。）

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-13T15:07:38.080

我强烈建议将其重构为：

```
protected virtual void LoadFieldDataEditor(Control control, string strFieldName) 
```

正如一些评论中提到的，这种方法根本不需要泛型。

由于您限制为 Control，因此您知道基类，并且它是引用类型 (Control)，因此您可以避免泛型和 ref 参数声明。

由于 Control 是一个引用类型，您可以在方法中随意更改它的属性，这将正常工作。设置 .Text 等将完全按照您的要求进行，但要简单得多。

您可能需要它的可能性很小：

```
protected virtual void LoadFieldDataEditor(ref Control control, string strFieldName) 
```

但这只有在您要在方法中重新分配控制权时才需要（即：）`control = new TextBox();`。我强烈建议不要这样做，因为它会导致一些非常意外的行为并且不会很明显。如果您尝试创建一个新控件，使用 out 参数，或者只是返回新控件，那么一切都会变得更加清晰。

此外，一般来说，避免泛型方法是个好主意，除非有充分的理由包含它们。FxCop 团队添加（后来删除）了一些规则，试图阻止它们的使用，因为从长远来看，它们往往会使代码更难理解。使用泛型方法有很多很好的理由，但这不需要使用它们，所以我建议避免使用它们。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-13T14:31:16.453

第一行给出编译器错误：“无法将类型 T 转换为 TextBox。” 只有当编译器知道可以将起始类转换为结束类时，这种转换才是合法的。因为 T 可以是任何东西，所以编译器无法知道。即使您在运行时进行检查，这也不能安抚编译器。第二种类型的转换是可以的，因为如果转换不起作用，它只会返回 null。编辑：正如 tuinstoel 指出的，铸造规则比我描述的要复杂。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-13T14:50:23.443

回应@rossfabricant。

没那么简单，第一种方法可以编译，第二种方法不行。

```
void Test(Control control)
{
    if (control is TextBox)
    {
       ((TextBox)control).Text = "test";
    }
}

void Test<T>(T control) where T : Control
{
    if (control is TextBox)
    {
        ((TextBox)control).Text = "test";
    }
} 
```

# asp.net-mvc - MVC UpdateModel 复杂类型

> ID：642939
> 
> 赞同：4
> 
> 时间：2009-03-13T14:23:47.470
> 
> 标签：asp.net-mvc, updatemodel

如果你有以下类型。

```
public class Person
{
    public string FirstName { get; set; }
    public string LastName { get; set; }
    public List<TheParameters> Parameters { get; set; }
    public Address Address { get; set; }
}
public class Address
{
    public string Street { get; set; }
    public string City { get; set; }
    public string State { get; set; }
}
public class TheParameters
{
    public string Parameter { get; set; }
} 
```

您将页面强类型化为 Person。

```
"System.Web.Mvc.ViewPage<Person>"

<form action="/Home/Save" method="post">  

    <b>Your Name</b> 
    <label for="FirstName">  
        <span>First Name</span>  
        <%=Html.TextBox("Person.FirstName", ViewData.Model.FirstName) %>  
    </label>  

    <label for="LastName">  
        <span>Last Name</span>  
        <%=Html.TextBox("Person.LastName", ViewData.Model.LastName)%>  
    </label>  

    <b>Your Address</b>  

    <label for="Street">  
        <span>Street</span>  
        <%=Html.TextBox("Person.Address.Street", ViewData.Model.Address.Street)%>  
    </label>  

    <label for="City">  
        <span>City</span>  
        <%=Html.TextBox("Person.Address.City", ViewData.Model.Address.City)%>  
    </label>  

    <label for="State">  
        <span>State</span>  
        <%=Html.TextBox("Person.Address.State", ViewData.Model.Address.State)%>  
    </label>  

    <label for="Parameters">
        <span>Parameters</span>
        <%
            int index = 0;
            foreach (TheParameters parameter in ViewData.Model.Parameters)
            {
                Response.Write(Html.TextBox("Person.Parameters.Parameter[" + index + "]", parameter.Parameter));
                index++;
            }
         %>
    </label>

    <input id="submit" type="submit" value="submit" />  

</form> 
```

在控制器中：

```
 public ActionResult Index()
    {
        Person p = new Person();
        p.FirstName = "Name";
        p.LastName = "Last";
        p.Address = new Address();
        p.Address.City = "city";
        p.Address.State = "state";
        p.Address.Street = "street";

        p.Parameters = new List<TheParameters>();
        p.Parameters.Add(new TheParameters(){ Parameter = "P1" });
        p.Parameters.Add(new TheParameters(){ Parameter = "p2" });

        ViewData.Model = p;

        return View();
    }

    public ActionResult Save(FormCollection form)   
    {
        Person p = new Person();

        UpdateModel(p, "Person", form.ToValueProvider());

        return RedirectToAction("Index");

    } 
```

我称之为 UpdateModel。除 Person.Parameters 外，所有属性均已正确填写。在 updateModel 之后，这始终为空。

是否有解决方案或解决方法？

问候，史蒂夫

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-02-08T12:39:20.567

在您看来：

```
"Person.Parameters.Parameter[" + index + "]" 
```

应该

```
"Person.Parameters[" + index + "].Parameter" 
```

# javascript - 在框架中设置 location.hash

> ID：642947
> 
> 赞同：6
> 
> 时间：2009-03-13T14:25:40.757
> 
> 标签：javascript, ajax, google-chrome, frameset, fragment-identifier

我正在使用 ajax 来更新框架中页面的位置。但是在设置哈希的位置时（特别是在 Chrome 和某些版本的 IE（5.5）上，但偶尔在 IE7 上）页面正在重新加载。

以下 html 演示了该问题。

主框架.... frame.html 是

```
<html><head>
<frameset rows="*">
<frame src=sethash.html frameborder=0 scrolling=auto name=somebody>
</frameset>
</head></html> 
```

sethash.html 页面是 .

```
<html><head>
<script language=JavaScript>
var Count = 0;
function sethash()
{  
  top.document.location.hash = "hash" + Count;  
  Count++;
}
</script>
</head>
<body onload="alert('loaded')">
<h1>Hello</h1>
<input type='button' onClick='sethash()' value='Set Hash'>
</body>
</html>` 
```

在大多数浏览器上，加载 frame.html 会在页面加载时显示一次加载的警报。然后，当按下设置哈希按钮时，url 将被更改，但加载的警报的哈希不会再次显示。在 chrome 和某些版本的 IE 上

[Microsoft 报告 Internet Explorer 5.5链接文本](http://support.microsoft.com/kb/274586)可能存在相同问题

我不能使用微软建议的解决方案，即捕获事件而不触发它，而只是滚动到视图中，就像使用将 top.location.hash 设置为 onLoad 事件的一部分一样。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-04-03T00:54:52.363

Webkit（以及扩展，Chrome）对 location.hash 的行为很奇怪。有一些关于它的开放错误，最相关的可能是这个：[https](https://bugs.webkit.org/show_bug.cgi?id=24578) ://bugs.webkit.org/show_bug.cgi?id=24578记录了您在 location.hash 更改时刷新页面的问题。看起来您现在最好的选择是交叉手指并希望它得到及时修复。

虽然我无法重现 IE7 中的错误，而且你是我见过的第一个支持 IE5.5 的人，所以我无法真正帮助你；）

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-02-07T07:54:47.837

您还可以使用 HTML5 [history.pushState()](https://developer.mozilla.org/en/DOM/Manipulating_the_browser_history#The_pushState%28%29.C2.A0method)更改哈希，而无需在 Chrome 中重新加载页面。像这样的东西：

```
// frameset hash change function
function changeHash(win, hash) {
    if(history.pushState) {
        win.history.replaceState(null, win.document.title, '#'+hash);
    } else {
        win.location.hash = hash;
    }
} 
```

在第一个参数中，您需要传递框架集顶部窗口。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2010-01-30T22:45:31.433

我也有这个问题。我的情况允许我创建一个窗口解除绑定事件，该事件将哈希设置为我想要的值，因为用户浏览器到下一页或刷新。这对我有用，但不确定它是否对你有用。

使用 jquery，我做了：

```
如果（$.browser.webkit）{
    $(窗口).unload(函数() {
        top.window.location.hash = hash_value;
    });
}别的{
    top.window.location.hash = hash_value;
}

```

从技术上讲，您不需要进行 webkit 检查，但我认为对于使用 firefox 的人来说，在刷新框架集之前查看正确的哈希值可能会很好。

-雅各布

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2011-04-05T13:04:22.203

对于 chrome 和 safari，您需要使用 window.location.href 来使哈希工作而不是 window.location.hash

见下面的代码

```
function loadHash(varHash)
{
  if(varHash != undefined) {
    var strBrowser = navigator.userAgent.toLowerCase();

    if (strBrowser.indexOf('chrome') > 0 || strBrowser.indexOf('safari') > 0) {
        this.location.href = "#" + varHash;
    }
    else {
        this.window.location.hash = "#" + varHash;
    }
  }
} 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2011-05-27T19:03:59.707

我有一个解决方法，它涉及一个带有嵌入式 iframe 的整页表。我用一个占据 100% 高度和 100% 宽度并且有两行的表格替换了我的框架集。然后，在每个表格单元格中，我放置了一个 iframe，它为每个单元格占用 100% 的高度和宽度。从本质上讲，这模仿了一个框架集，而不是一个框架集。最重要的是，哈希更改无需重新加载！

这是我的旧代码：

```
<html>
<head>
<title>Title</title>
</head>
<frameset rows="48,*" frameborder="yes" border="1">
    <frame name="header" noresize="noresize" scrolling="no" src="http://header" target="_top">
    <frame name="main" src="http://body" target="_top">
    <noframes>
    <body>
    <p>This page uses frames, but your browser doesn&#39;t support them.</p>
    </body>
    </noframes>
</frameset>
</html> 
```

...这是我的新代码：

```
<html>
<head>
<title>Title</title>
<style type="text/css">
body { margin: 0px; padding: 0px; border: none; height: 100%; }
table { height:100%; width:100% }
td { padding: 0px; margin: 0px; border: none; }
td.header { height: 48px; background-color: black; }
td.body { background-color: silver; }
iframe.header { border: none; width: 100%; height: 100%; }
iframe.body { border: none; width: 100%; height: 100%; }
</style>
</head>
<body>
<table cellpadding="0" cellspacing="0">
  <tr><td class="header"><iframe class="header" src="http://header" target="_top" scrolling="no"></iframe></td></tr>
  <tr><td class="body"><iframe class="body" src="http://body" scrolling="no"></iframe></td></tr>
</table>
</body>
</html> 
```

希望这可以帮助。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-04-03T21:43:49.130

您是否尝试过创建指向哈希的隐藏链接并在它们上触发点击？

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-04-29T02:26:09.793

怎么办`location.href = '#yourhash';`也许它绕过了这个错误。

# http - 如何在 Windows 中检测防火墙？

> ID：642950
> 
> 赞同：2
> 
> 时间：2009-03-13T14:26:02.783
> 
> 标签：http, winapi, firewall, http-get, windows-firewall

我的应用需要向网站发出 GET 请求，我想知道它是否被防火墙阻止，并要求用户添加例外。

我怎样才能发现我的获取请求由于防火墙而不是其他原因而失败？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-03-13T14:29:30.340

如果它是一个好的防火墙，你就不能。在其他选项中，防火墙可以：

*   回复几个不同的[ICMP](http://en.wikipedia.org/wiki/Internet_Control_Message_Protocol)消息之一，指示目的地不可访问，或
*   默默地丢弃请求，导致超时。

一个合理的选择是解释为什么应用程序无法访问该网站，并提供一些有用的建议：

```
    www.site.com 没有回应：
    * 您的计算机可能未连接到 Internet。
    * 该网站可能已关闭。
    * 该网站可能被防火墙阻止。

```

```
    该网络表示无法访问 www.site.com：
    * 有用的信息在这里。

```

重要的一点是区分失败的*类型*及其背后的*原因，也许比我上面所做的更好。*例如，“无响应”故障排除步骤与“设备告诉我它没有在该端口上侦听”故障排除步骤不同。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-13T14:39:49.427

尝试以短暂的超时时间访问互联网...如果命令失败，您可以假设机器有防火墙，需要用户交互。

如果防火墙是好的，你就无法检测到它。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-13T14:48:48.877

使用 Win32 防火墙 api（经典）

# c# - 在异步 BeginExecuteReader 中检测命令取消

> ID：642951
> 
> 赞同：7
> 
> 时间：2009-03-13T14:26:14.530
> 
> 标签：c#, ado.net

我正在异步调用 sql 命令的 beingexecutereader 方法，用户可以取消该方法。当取消发生时，我取消了 sqlcommand 对象，这将终止 sql server 上正在执行的作业。

但是，一旦我取消它，就会调用 BeginExecute 查询中指定的回调方法，并且在尝试调用 endexecutequery 时会出错。result.Iscompleted 为真，直到调用 endexecute 查询，此时它变为假。

有没有办法在回调方法中检测到命令被取消？还是我必须跟踪...

谢谢

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-04-21T21:37:29.903

我已经删除并重新开始了我的整个答案：你偶然发现了一个很好的相互矛盾的文档和警告的案例......

根据[SqlCommand.Cancel 的 .NET 2.0 MSDN 文档，](http://msdn.microsoft.com/en-us/library/system.data.sqlclient.sqlcommand.cancel(VS.80).aspx) “不能使用 Cancel 方法取消挂起的异步操作。” 但是，[.NET 3.5](http://msdn.microsoft.com/en-us/library/system.data.sqlclient.sqlcommand.cancel.aspx)的相同文档不包含此警告——尽管在其他方面与 2.0 文档相同。

我建议遵循以 Delegate.BeginInvoke（不是 Control.BeginInvoke！）和 Delegate.EndInvoke 为目标的[异步调用同步方法](http://msdn.microsoft.com/en-us/library/2e08f6yc.aspx "异步调用同步方法")中概述的约定，但可能与您的情况相关。

名为“Begin...Async”的方法返回 IAsyncResult 并具有相应的“End...”方法，可能会造成 ThreadPool 泄漏。防止泄漏的最简单方法是确保始终调用相应的“End...”方法。

原因是当 Begin...Async 被调用时，它会从 ThreadPool 中获取一个线程，并且（通常）在工作线程上执行该方法的同步版本；在你的情况下 ExecuteReader()。该调用的返回值或在该调用期间发生的任何异常都不会带回主线程，直到 End... 被调用 - 如果您从不调用 End 则永远不会返回结果/异常并且 ThreadPool 线程永远不会被释放。

长话短说，只要您确保调用 EndExecuteReader() 并处理预期的异常，您就很可能是安全的。由于文档相互矛盾且含糊不清，我已开始[在 MSDN 反馈论坛上进行讨论](http://social.msdn.microsoft.com/Forums/en-US/msdnfeedback/thread/97d70f9a-2d4a-4320-913c-1b3113c0ea62)。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-04T08:42:35.227

快速查看[http://connect.microsoft.com/VisualStudio/feedback/ViewFeedback.aspx?FeedbackID=98217](http://connect.microsoft.com/VisualStudio/feedback/ViewFeedback.aspx?FeedbackID=98217)报告了此行为的确切位置。

所以看起来你应该只捕获 EndExecuteReader 中抛出的这个特定异常并忽略它。

# c# - 获取 TemplateField 中的当前行颜色？

> ID：642953
> 
> 赞同：0
> 
> 时间：2009-03-13T14:26:47.510
> 
> 标签：c#, asp.net, templates, gridview

我有一种情况，我需要知道 GridView 的 TemplateField 中交替行的当前颜色。

更新：

如何在`<%# ??? %>`.

（或者我得到行号的解决方法）。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-13T14:58:34.577

要从模板字段本身的 <% %> 标记内部获取颜色，您可以使用此代码...

```
<asp:TemplateField>
    <ItemTemplate>
        <%# ((GridViewRow)Container).RowState == DataControlRowState.Alternate ? ((GridView)((GridViewRow)Container).Parent.Parent).AlternatingRowStyle.BackColor : ((GridView)((GridViewRow)Container).Parent.Parent).RowStyle.BackColor%>
    </ItemTemplate>
</asp:TemplateField> 
```

您也可以在 GridView 的 RowDataBound 事件中执行此操作。在 RowDataBound 命令中，您可以查询 e.Row.RowState 以找出您所在的行类型。值包括 DataControlRowState.Alternate 和 DataControlRowState.Normal。您可以使用发件人根据该行类型获取颜色...

```
protected void MyGridView_RowDataBound(object sender, GridViewRowEventArgs e)
{

    // set first cell in the row to color just for demonstration purpose.
    if (e.Row.RowType == DataControlRowType.DataRow && e.Row.RowState == DataControlRowState.Alternate)
    {
        e.Row.Cells[0].Text = ((GridView)sender).AlternatingRowStyle.BackColor.ToString();
    }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-13T15:58:16.477

在代码隐藏页面（或 .aspx 页面的某个部分）中创建此函数：

```
protected string GetColor(object container)
        {
            int ordinal = 0;
            try
            {
                ordinal = int.Parse(DataBinder.Eval(container, "DataItemIndex").ToString());
            }
            catch (Exception)
            {
                ordinal = int.Parse(DataBinder.Eval(container, "ItemIndex").ToString());
            }
            return (ordinal % 2) == 0 ? "Row" : "Alternate Row";
        } 
```

然后在您的标记中，您可以这样称呼它：

```
<%# GetOrdinal(Container) %> 
```

（注意大写的“Container”）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2011-02-26T04:21:19.797

```
protected void GridView1_RowDataBound(object sender, GridViewRowEventArgs e)
    {
        e.Row.Attributes.Add("style", "cursor:help;");
        if (e.Row.RowType == DataControlRowType.DataRow && e.Row.RowState == DataControlRowState.Alternate)
        { 
            if (e.Row.RowType == DataControlRowType.DataRow)
            {                
                e.Row.Attributes.Add("onmouseover", "this.style.backgroundColor='orange'");
                e.Row.Attributes.Add("onmouseout", "this.style.backgroundColor='#E56E94'");
                e.Row.BackColor = Color.FromName("#E56E94");                
           }           
        }
        else
        {
            if (e.Row.RowType == DataControlRowType.DataRow)
            {
                e.Row.Attributes.Add("onmouseover", "this.style.backgroundColor='orange'");
                e.Row.Attributes.Add("onmouseout", "this.style.backgroundColor='gray'");
                e.Row.BackColor = Color.FromName("gray");                
            }
            //e.Row.Cells[0].BackColor = Color.FromName("gray");
            //e.Row.Cells[1].BackColor = Color.FromName("gray");
            //e.Row.Cells[2].BackColor = Color.FromName("gray");
            //e.Row.Cells[3].BackColor = Color.FromName("gray");
            //e.Row.Cells[4].BackColor = Color.FromName("gray");
            //e.Row.BorderWidth = 2;
            //e.Row.BorderColor = Color.FromName("#43C6DB");
        }
    } 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-13T14:40:40.423

这可能是一个奇怪的解决方法，但您始终可以检查您要检查的行是奇数行还是偶数行。如果是偶数，则很可能使用了 AlternatingRow 模板中设置的颜色。如果是偶数，它应该使用常规的 Row 模板。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-13T14:53:38.210

GridView 如何改变颜色 - 每隔一行或 X 块？还是以某种更“随机”的方式设置？

如果是每隔一行，您可以简单地检查该行是“正常”行还是“交替”行。

我不记得它是如何写的，我只找到了这个 VB 示例，但它可能会有所帮助：

```
If e.Row.RowState = DataControlRowState.Normal Then
 //do stuff
ElseIf e.Row.RowState = DataControlRowState.Alternate Then
 //do other stuff 
```

其中 e 是 GridView 对象。不过，这不会检查行的实际颜色。我想你应该能够做类似的事情：

```
if(System.Drawing.Color.Red == e.Row.BackColor) 
```

如果可以，请更详细地说明如何在每行上设置颜色。

# asp.net - IIS7 缓存控制

> ID：642954
> 
> 赞同：99
> 
> 时间：2009-03-13T14:27:03.623
> 
> 标签：asp.net, iis, caching, iis-7

我正在尝试做一些我认为相当简单的事情。让 IIS 7 告诉客户他们可以将我网站上的所有图像缓存一段时间，比如说 24 小时。

我已经尝试了[http://www.galcho.com/Blog/post/2008/02/27/IIS7-How-to-set-cache-control-for-static-content.aspx](http://www.galcho.com/Blog/post/2008/02/27/IIS7-How-to-set-cache-control-for-static-content.aspx)上的步骤，但无济于事。我仍然收到发送到服务器的请求，并返回 304。

有没有人有办法做到这一点？我有一个图形密集型站点，每次请求页面时，我的用户都会受到打击（我的服务器也是如此）。奇怪的是，图像似乎在 Firebug 中显示了“Cache-Control private,max-age=3600”，但是当我按 F5 时浏览器仍在请求它们。

* * *

## 回答 #1

> 赞同：131
> 
> 时间：2009-08-20T08:42:17.243

如果您想设置 Cache-Control 标头，遗憾的是，IIS7 UI 中没有任何内容可以执行此操作。

但是，您可以将此 web.config 放在要设置它的文件夹或站点的根目录中：

```
<?xml version="1.0" encoding="UTF-8"?>
<configuration>
  <system.webServer>
    <staticContent>
      <clientCache cacheControlMode="UseMaxAge" cacheControlMaxAge="7.00:00:00" />
    </staticContent>
  </system.webServer>
</configuration> 
```

这将通知客户端将该文件夹和所有子文件夹中的内容缓存 7 天。

您也可以通过编辑 IIS7 元数据库来做到这一点`appcmd.exe`，如下所示：

```
\Windows\system32\inetsrv\appcmd.exe
  设置配置“默认网站/文件夹”
  -section:system.webServer/staticContent
  -clientCache.cacheControlMode:UseMaxAge

\Windows\system32\inetsrv\appcmd.exe
  设置配置“默认网站/文件夹”
  -section:system.webServer/staticContent
  -clientCache.cacheControlMaxAge:"7.00:00:00"

```

* * *

## 回答 #2

> 赞同：116
> 
> 时间：2009-10-14T13:08:18.187

这不是真的杰夫。

您只需在 IIS 7 管理器 UI 中选择一个文件夹（例如图像或事件默认 Web 应用程序文件夹），然后单击“HTTP 响应标头”。然后你必须点击右窗格中的“Set Common Header..”并选择“Expire Web content”。在那里，您可以通过选择“之后：”，在文本框中输入“24”并在组合框中选择“小时”来轻松配置 24 小时的最长期限。

您关于 web.config 条目的第一段是正确的。我会添加 cacheControlCustom 属性以将缓存控制标头设置为“公共”或在这种情况下需要的任何内容。

当然，您可以通过根据需要提供 web.config 条目（或文件）来实现相同的目的。

编辑：删除了一个令人困惑的句子:)

* * *

## 回答 #3

> 赞同：28
> 
> 时间：2011-03-23T10:34:03.970

我用这个

```
<staticContent>
<clientCache cacheControlCustom="public" cacheControlMode="UseMaxAge" cacheControlMaxAge="500.00:00:00" />
</staticContent> 
```

使用公共缓存控制标头缓存静态内容 500 天。

* * *

## 回答 #4

> 赞同：20
> 
> 时间：2013-03-25T19:37:05.073

> 补充埃尔默的回答，因为我的编辑被回滚了。

**要使用 public cache-control header**缓存静态内容 365 天，可以使用以下配置 IIS

```
<staticContent>
    <clientCache cacheControlCustom="public" cacheControlMode="UseMaxAge" cacheControlMaxAge="365.00:00:00" />
</staticContent> 
```

这将转换为这样的标题：

```
Cache-Control: public,max-age=31536000 
```

请注意，max-age 是以秒为单位的增量，由[RFC 2616 第 14.9.3 和 14.9.4 节](http://www.w3.org/Protocols/rfc2616/rfc2616-sec14.html)中所述的 32 位正整数表示。这表示最大值为 2^31 或 2,147,483,648 秒（超过 68 年）。但是，为了更好地确保客户端和服务器之间的兼容性，我们建议最长为 365 天（一年）。

如其他答案所述，您也可以在网站的 web.config 上使用这些指令来获取所有静态内容。作为替代方案，您也可以仅将其用于**特定位置的内容**（在示例中，“cdn”文件夹中的内容的 30 天公共缓存）：

```
<location path="cdn">
   <system.webServer>
        <staticContent>
             <clientCache cacheControlCustom="public" cacheControlMode="UseMaxAge" cacheControlMaxAge="30.00:00:00"/>
        </staticContent>
   </system.webServer>
</location> 
```

* * *

## 回答 #5

> 赞同：19
> 
> 时间：2009-03-13T14:30:47.327

F5 Refresh 具有“请重新加载当前 HTML 及其直接依赖项”的 **语义**。因此，您应该期望看到 HTML 直接引用的任何 imgs、css 和 js 资源也被重新获取。当然，304 是可以接受的响应，但 F5 刷新意味着浏览器将发出请求，而不是依赖于新的缓存内容。

而是尝试简单地导航到其他地方，然后导航回来。

您可以通过在大多数浏览器中按住 ctrl 的同时按 f5 来强制刷新，超过 304。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2016-02-25T01:35:00.013

有一个简单的方法：1.使用网站的web.config 2.在“staticContent”部分删除特定的fileExtension并添加mimeMap 3.添加“clientCache”

```
<configuration>
  <system.webServer>
    <urlCompression doStaticCompression="true" doDynamicCompression="true" />
    <staticContent>
      <remove fileExtension=".ipa" />
      <remove fileExtension=".apk" />
      <mimeMap fileExtension=".ipa" mimeType="application/iphone" />
      <mimeMap fileExtension=".apk" mimeType="application/vnd.android.package-archive" />
      <clientCache cacheControlMode="UseMaxAge" cacheControlMaxAge="777.00:00:00" />
    </staticContent>
  </system.webServer>
</configuration> 
```

# vb6 - VB6 Web 应用程序 - RM 或非 RM - 真的很重要吗？

> ID：642957
> 
> 赞同：0
> 
> 时间：2009-03-13T14:27:43.327
> 
> 标签：vb6, asp-classic, retained-in-memory

我支持旧版 VB6 Web 应用程序。我们通常尝试使用 Retained in Memory (RM) 组件。但是，某些组件是从 Windows 应用程序“借来的”。由于这些组件包含表单，因此不能将它们标记为 RM。因此，我们目前混合使用了 RM 和非 RM 组件。

已经提出了一个问题，“可以使用所有组件的非 RM 版本吗？”

似乎走这条路可能会导致可扩展性和性能问题。有人对此有经验吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-19T22:55:00.557

随着时间的推移，它变得有点迟钝，但我记得大量使用未标记为保留在内存中的组件在过去给我造成了非常严重的问题，例如应用程序崩溃。

如果可以将这些非“RM”组件与网站的其余部分隔离，我会倾向于将这些非“RM”组件添加到单独的 COM+ 应用程序中。

在轻负载下，您可能会侥幸成功，但我不建议您认真使用它。这些组件指定什么线程模型？

# c# - 分区程序集和命名空间的策略提示

> ID：642958
> 
> 赞同：5
> 
> 时间：2009-03-13T14:27:46.680
> 
> 标签：c#, .net

对于技术架构师来说，一个非常常见的复杂性是将应用程序划分为程序集和命名空间。

*   程序集可以根据：部署、性能和安全边界进行划分。
*   命名空间可以根据逻辑应用程序边界进行分区。

另外：命名空间可以跨越多个程序集。

我曾经在一个项目中遇到过糟糕的经历，我们根据应用程序的逻辑单元对程序集进行分区。这个决定最终得到了包含 30 或 40 个项目的解决方案文件！主解决方案文件加载时间约为。5分钟！！！这最终浪费了很多时间，pff...

相反的情况是在真正需要时将所有代码保存在 1 个程序集中和分区中。

您是否有关于此问题的其他提示或最佳实践？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-13T14:34:18.100

仅当我需要将代码重用于两个不同的应用程序（几乎）时，我才将代码拆分为单独的程序集。因此，我从一个项目中的所有内容开始，当重用代码的需求变得明显时，我创建一个新程序集并移动代码（有时从一开始就很明显，例如，当您需要一个 Web 应用程序并赢得表单做同样的事情时事物）。

关于。命名空间，我更喜欢在程序集中对其进行很好的分区，因此每个类的所属位置和用途都很清楚。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-13T14:38:23.643

如果您想将源文件组合在一起以便于维护，您可以使用命名空间对类进行分区并使用文件**夹**。如果您有安全要求并且某些程序集需要经过特殊处理（例如混淆），那么您可能需要将它们分离到一个单独的项目中。

在考虑逻辑单元是否需要获得自己的项目时，可重用性也是您可能需要考虑的一个因素，因为您可能还需要在另一个解决方案中使用该项目。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-13T14:44:56.700

对我来说效果很好的是按代码类型进行大级别分组，但比您拆分的逻辑单元更宏观。例如，

*   引擎 - 任何不可见的东西。支持类，基础架构代码。一切都与此有关。
*   EngineUI - 依赖于 Engine，显然用于 UI，但没有特定于任何一个应用程序。
*   EngineServer - 依赖于引擎，由（通常是 Web）服务器构建使用。
*   AppCore - 应用特定的核心功能，没有 UI。
*   AppUI - 应用特定的 UI
*   AppClient - 使用 AppUI、AppCore、EngineUI、引擎。实际的客户端应用程序。
*   AppServer - 使用 AppServer、EngineServer、Engine。服务器应用程序。

每个项目都有一个命名空间层次结构，有时我发现将大量代码分叉到另一个程序集中很有用，但通常这些代码可以使事情合理地组织和管理，即使涉及数百个文件。太多的项目绝对是我尽量避免的事情。将这些项目保持在最低限度的一个好处是，它可以更容易地在后续项目中实际重用这些库（例如自动化测试构建）。

我不太担心从这些库中部署未使用的代码，因为我可以使用一个[实用程序](http://www.smartassembly.com/index.aspx)来去除未使用的函数以进行最终构建，从而将文件大小保持在最低限度。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-14T10:38:29.827

我发现将命名空间组织成层次结构并让程序集名称与它们所贡献的子命名空间相匹配很有帮助。例如，一个名为 Womble 的项目将有一个顶级命名空间 Womble，然后可能会有名为：

```
Womble.ClientLibrary.dll
Womble.Controls.dll
Womble.Util.dll
Womble.Interop.dll 
```

在这里，外部 Womble 命名空间跨越多个程序集，但每个程序集都有一个唯一的子命名空间，只有它可以贡献，您可以通过从末尾删除 .dll 来找到它。它使记住您需要参考的内容和查找内容变得更加容易。

对于非常大量的程序集，最终您不需要将它们全部保存在一个解决方案中。在大规模开发中，将大型产品分解为子系统会有所帮助，这些子系统本身可能由多个组件组成，每个子系统最终可能由不同的团队维护，并且可以拥有自己的解决方案文件。各个团队通过源代码控制相互“发布”新版本，将彼此视为第三方库。

我不认为有一种硬性和快速的方法来决定如何将软件分解成组件。这里有一个普遍的原则：因不同原因而改变的事物应该分开。

非常大的项目可以从这样一个事实中获益，即通过将东西放在单独的程序集中，您可以单独修补它们。您可以针对 Womble.Interop.dll 中的问题生成修补程序，然后针对 Womble.Controls.dll 中的问题单独生成修补程序，并将两者提供给同一客户，这样理论上，这两个程序集可以完全由不同的团队维护和支持，而无需直接协调他们的活动。

单独的程序集还使代码之间的依赖关系更加清晰。您可以在非常高的层次上看到（仅查看引用列表）一段代码如何依赖于另一段代码，以及如何重用它。如果你把所有东西都放在一个程序集中，它可能是一大团乱七八糟的乱七八糟的东西，没有任何合理的模式。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2016-08-25T09:04:11.733

**动机**

我发布这个迟到的答案的原因是所有以前的答案都是更多的建议，而不是一致的最佳实践。

多年来我一直在一个非常大的 .NET 项目中工作，只有在战略和技术上都具有良好动机的一致最佳实践是 NDepend 团队提出的。

**简而言之**

NDepend 建议通常与您不根据体系结构构建程序集的经验一致。它还包含考虑何时有单独的程序集以及为什么。经验法则是**出于物理原因使用程序集结构化，****出于逻辑原因**使用名称空间。

NDepend最佳实践总结：

> 对于装配体和项目
> 
> *   大幅减少代码库的程序集数量。
> *   仅当物理分离的特定要求证明这是合理的时才创建新装配。
> *   在 Visual Studio 项目中，使用“程序集引用”而不是“Visual Studio 项目引用”。
> *   永远不要使用 Visual Studio 引用选项“Copy Local = True”。
> *   将所有 VS 解决方案和构建操作 .bat 文件放在 $rootDir$ 目录中。
> *   编译目录中的所有程序集：$rootDir$\bin\Debug 和 $rootDir$\bin\Release
> *   使用目录 $rootDir$\bin 来托管测试程序集。
> 
> 对于命名空间
> 
> *   使用命名空间的概念来定义组件的边界。
> *   一个命名空间通常包含一到两个几十种类型，并且具有适合 500 到 2.000 LoC 范围的合理大小。
> *   花点时间对代码库组件进行分级，这肯定比预期的要便宜，因此投资回报率会很高。
> *   不断检查组件内组件的依赖关系图是否是非循环的。
> *   如果一个组件太大（> 2.000 LoC），则使用子命名空间将其划分为一组较小的相关组件。
> *   在任何规模上，对高级中介、中级独立特征、低级基础/域之间的组件进行分类。
> *   拥有一组“水平化”的组件可以消除大多数设计决策的需要。

**详细阅读**

[通过 .NET 程序集和 Visual Studio 项目对代码库进行分区](http://www.ndepend.com/Res/NDependWhiteBook_Assembly.pdf)

[使用命名空间定义 .NET 组件](http://www.ndepend.com/Res/NDependWhiteBook_Namespace.pdf)

# asp.net - 是否可以确定客户端是否安装了某个 ActiveX 控件？

> ID：642962
> 
> 赞同：0
> 
> 时间：2009-03-13T14:28:32.823
> 
> 标签：asp.net, activex

我有一个将图像文件推送到客户端的 ASP.Net 网站。由于我们多样化用户群的古怪需求，一些客户端工作站有一个 ActiveX 组件，他们需要在本网站中使用该组件来操作此图像，但由于成本原因，并非所有用户都具有此控制权。我想做的是确定客户端是否安装了这个 ActiveX 控件，然后根据这个测试的结果编写标签。

我一直在彻底探索 Request 对象，但没有找到任何完全符合我需要的东西。Request.Browser.ActiveXControls 很高兴知道，但我需要进一步深入。我应该查看另一个命名空间吗？这甚至可能吗？

提前致谢。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-13T16:07:36.267

您不能从服务器端询问 ActiveX 的可用性。甚至 Browser.ActiveXControls 标志也是来自 UA 字符串的猜测，这很容易出错。

您所能做的就是尝试从 JavaScript 实例化对象，并根据该对象采取客户端操作：

```
var obj;
try {
    obj= new ActiveXObject('Control.ProgID');
} catch (e) {
    obj= null;
}
if (obj) {
    doActiveXEnhancedVersionOfPageThings();
} 
```

# c# - 您如何衡量 Silverlight 应用程序的性能？

> ID：642963
> 
> 赞同：2
> 
> 时间：2009-03-13T14:28:48.033
> 
> 标签：c#, silverlight, performance, profiler

有哪些用于衡量 Silverlight 性能的工具/实践？

我对渲染某些 xaml 对象的性能成本以及我编写的算法感兴趣。我正要开始为此编写自己的课程，但我想我会先在这里问。

先感谢您。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-13T14:40:28.053

看看 Silverlight Spy 2。有事件、网络和性能选项卡可以为您提供一些您正在寻找的信息。

[银光间谍 2](http://silverlightspy.com/silverlightspy/download-silverlight-spy/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-13T14:41:28.813

[JetBrains 的dotTrace](http://www.jetbrains.com/profiler/)是衡量 ASP.NET 应用程序性能的好工具。不确定 Silverlight 对您有多大帮助，但至少会分析您的后端代码

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-13T14:53:55.727

有一些免费的分析器，[EQATEC](http://www.eqatec.com/tools/profiler)还不错，它可能会满足您的需求。如果你能负担得起，[AQTime](http://www.automatedqa.com/products/aqtime/)已经成为我最喜欢的商业分析工具，我希望它会做得很好。他们有一个演示。如果您有时间，我确实建议您在购买其中任何一个之前尝试所有的分析器，如果只是想知道您在任何特定选择中缺少什么，因为它们之间有一些*本质*上不同的功能，而且它们似乎都没有一切。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-13T14:36:41.307

目前，只需构建它，然后使用它。由于它的客户端只要它的合理响应，工作就完成了。

# git - 如何通过 git 与其他拥有 Android 存储库的人共享代码？

> ID：642974
> 
> 赞同：5
> 
> 时间：2009-03-13T14:31:15.110
> 
> 标签：git, android, repository

我想与其他人一起处理一些[Android](http://source.android.com/)代码，并且需要设置存储库以在团队中本地使用。但是，似乎`repo`不允许我这样做。在 android repo 中克隆 git 存储库也不会像这样：

```
$ git clone /var/android/.repo/projects/bionic.git/ 
```

我收到以下错误消息：

```
Initialized empty Git repository in /home/user/mydroid/bionic/.git/
0 blocks
Warning: Remote HEAD refers to nonexistent ref, unable to checkout. 
```

有没有人尝试成功地与其他人一起在 Android 中的 git 存储库上工作，而无需发送到 Android 项目本身？

* * *

我还尝试执行以下操作，我在共享计算机上和本地计算机上启动了一个客户端，如下所示：

```
$ repo init -u git://android.git.kernel.org/platform/manifest.git 
```

我还尝试像这样将单独项目（例如仿生）的遥控器添加到共享计算机，但出现错误：

```
$ git clone /initech/android/bionic
fatal: cannot clone empty repository 
```

我也尝试这样做：

```
$ git clone /initech/android/.repo/projects/bionic.git/
Initialized empty Git repository in /home/user/mydroid/bionic/.git/
0 blocks
Warning: Remote HEAD refers to nonexistent ref, unable to checkout. 
```

它找到一个 git 存储库，克隆它，但即使远程中有一个主题分支，也找不到任何对 checkout 的引用。是什么赋予了？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-13T14:59:07.557

我不确定 Repo 是什么或做什么，但在我看来你想克隆`git://android.git.kernel.org/platform/bionic.git`：

```
git clone --bare git://android.git.kernel.org/platform/bionic.git 
```

然后可以再次克隆此克隆：

```
git clone bionic.git bionic-jim
cd bionic-jim
#edit
git commit -a -m "foo"
git push 
```

更改将推送到`../bionic.git`. 然后必须有人进入`bionic.git`并推送到某个上游存储库。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-13T18:22:06.193

消息“警告：远程 HEAD 引用不存在的参考，无法结帐。” 仅告诉您 HEAD 链接不存在，因此 Git 不知道要检出哪个修订版到您的本地工作目录。但是，.git 目录是正常创建和填充的。只需做一个`git checkout <whatever-branch-you-want>`并开始破解。

# asp.net - 如何使用另一个控件的 ID 将另一个控件作为参数传递到用户创建的 ASP.NET 控件中？

> ID：642977
> 
> 赞同：0
> 
> 时间：2009-03-13T14:31:51.023
> 
> 标签：asp.net, user-controls, parameter-passing

我正在尝试创建一个控件 ( `MyControl`)，它对其所在页面上的其他控件执行操作。它有一个属性：

```
public property System.Web.UI.Control SomeOtherControl; 
```

我希望能够从使用该控件的 ASPX 页面设置此属性。现在，我能做到的唯一方法是在`Page_Load`代码隐藏中：

```
MyControl.SomeOtherControl = TheOtherControl; 
```

不必在使用的每个页面的代码隐藏上`MyControl`执行此操作，我只想在 ASPX 页面上执行此操作：

```
<xyz:MyControl SomeOtherControl="TheOtherControlsID" /> 
```

为了做到这一点，我尝试在初始化`Page.FindControl()`时使用 ID 字符串上的方法来查找引用的控件`MyControl`，但它只搜索页面的顶级控件。我可以编写自己的 recursive `FindControl()`，但我认为必须有更好的方法来做到这一点，而且我担心这样的性能。有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-13T14:39:04.327

递归 FindControl 可能比您想象的要快得多。即使有数百个控件，我什至无法测量处理时间的毫秒值差异。

# .net - 从托管 dll 中查找可执行文件名称，com-visible

> ID：642978
> 
> 赞同：3
> 
> 时间：2009-03-13T14:31:55.937
> 
> 标签：.net, reflection

我已经创建了一个托管 dll，我想获取它附加到的可执行文件名称.... 我已经阅读了这个：[如何从托管 DLL 获取可执行文件路径](https://stackoverflow.com/questions/121116/how-to-get-the-executable-path-from-a-managed-dll)

它适用于 .net 可执行文件......但是当 dll 在 com 进程下运行时，我没有 .Net 程序集......所以 Assembly.GetEntryAssembly() 将不返回任何内容......

有任何想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-13T14:39:42.687

怎么样：

```
using System.Diagnostics;
...
Process process = Process.GetCurrentProcess();
string name = process.ProcessName;
ProcessModule module = process.MainModule;
string path = module == null ? null : module.FileName; 
```

# cocoa - Cocoa/OpenGL 坐标变换

> ID：642986
> 
> 赞同：1
> 
> 时间：2009-03-13T14:34:05.727
> 
> 标签：cocoa, opengl, coordinates

我试图在 NSOpenGLView 中按时间戳绘制一些数据。我还想在数据上方覆盖一些非 OpenGL 的 Cocoa 元素，例如高亮框。我的困难在于让坐标系对齐。

自纪元以来，我的数据时间戳以秒为单位。值从 -2 到 2。我可以通过在 OpenGL 中轻松绘制原始数据`gluOrtho(startTime, endTime, -2, 2)`。当我尝试将其与缩放和 Cocoa 绘图相结合时，困难就来了。

为简单起见，我将使用线条的示例。`(2/18/09 at 13:00:08, -1.5)`这是从to`(2/18/09 13:00:13, 1.7)`或`(1234980008, -1.5)`to`(1234980013, 1.7)`以秒为单位绘制的一条线（使用 OpenGL） ：

[比例=1 http://ccg.cc.gt.atl.ga.us/~anjiro/tmp/scale1.png](http://ccg.cc.gt.atl.ga.us/~anjiro/tmp/scale1.png)

为了便于讨论，假设我现在想使用 Cocoa 在 OpenGL 线的顶部覆盖一条完全相同的线。我希望能够使用完全相同的坐标，即`(1234980008, -1.5) -> (1234980013, 1.7)`.

所以这是第一个问题。现在我想看到更多细节，所以我想缩放：

[比例=2 http://ccg.cc.gt.atl.ga.us/~anjiro/tmp/scale2.png](http://ccg.cc.gt.atl.ga.us/~anjiro/tmp/scale2.png)

我仍然想绘制相同的 Cocoa 线，但我还需要知道，在数据坐标中，此窗口中可见什么，因此我不必绘制额外的数据。

我尝试了多种解决方案，但无法完全发挥作用。我可以这样做吗？如果是这样，怎么做？如果没有，我应该怎么做？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-13T20:46:36.237

我猜你已经知道你使用 -[NSView bounds] 获得了视图的矩形。因此，您会得到以下对应关系：

*   startTime <-> bounds.origin.x
*   endTime <-> bounds.origin.x + bounds.size.width
*   (-2) <-> bounds.origin.y
*   (+2) <-> bounds.origin.y + bounds.size.height

如果我没记错的话，这个方法应该将 NSOpenGL 点转换为视点：

```
- (NSPoint) pointWithTime:(long)time value:(float)value
{
    NSPoint point;

    point.x = [self bounds].origin.x 
        + [self bounds].size.width * ((time - startTime) / (endTime - startTime));
    point.y = [self bounds].origin.y
        + [self bounds].size.height * ((value - minValue) / (maxValue - minValue));

    return point;
} 
```

（minValue = -2 和 maxValue = 2。）

对于您问题的第二部分：使用提供给 -[NSView drawRect:] 方法的*矩形*来了解要刷新视图的哪一部分。在 Cocoa Drawing Guide 中设置详细信息，该指南对这一点很啰嗦。该方法可能会被多次调用以绘制视图的不同部分。

# agile - 共享代码和界面有哪些社交和技术解决方案？

> ID：642989
> 
> 赞同：4
> 
> 时间：2009-03-13T14:35:09.157
> 
> 标签：agile, scrum, extreme-programming

### 背景：

我是一家中型网络托管公司的产品经理，除了网络托管之外，我们还提供各种补充服务。

今天，我们公司有大约 3-6 个开发团队，每个团队致力于不同方面的网络托管（即 DNS 注册、共享托管、云计算、专用服务器、转售等）。

我们已经非常有机地成长，因此用户界面极大地反映了我们公司的组织，而不是我们的客户会觉得直观的内容组织。

除了这个问题，许多后端系统属于每个团队的领域，但也需要被其他团队使用。例如，共享主机团队需要在其面板上使用 DNS 注册服务。另一个例子，一键式网络应用程序安装程序等网络托管功能是由共享托管团队开发的，但我们也希望将它们提供给专门的托管客户。

仅供参考，我们有一个非常注重敏捷方法和极限编程 (XP) 的编程环境。

### 问题：

对于那些拥有与我类似的公司工作/编程环境的人，您有什么解决方案/建议可以使这种安排发挥作用，以便我们可以改善用户体验以及代码的协调和共享，同时也让团队保持独立?

即这里有人用过Scrum of Scrums。如果是这样，您对实施它有什么建议？

Scrum of scrums 的任何替代解决方案？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-18T18:57:30.067

在编写代码之前，应明确定义接口。如有必要，可以稍后更改接口定义，但这只能通过开发和使用该接口的所有团队的协作来完成。拥有一致的、定义良好的接口有助于封装系统的各个部分，并且可以更容易地重用通用组件或库。良好的封装和模块化是独立团队之间有效代码重用的必要先决条件（我假设使用了某种版本控制系统）。

必须轻松访问最新文档。对于敏捷/XP 环境，我个人的建议是建立一个项目 wiki 以用于中央文档中心。在创建或修改特性/接口/功能时，开发过程的一部分应该是创建或更新该组件的文档。一个开发人员花半个小时来充分记录某件事可以为其他六个开发人员节省半个小时，每个开发人员都试图自己弄清楚。使用 wiki 作为文档可以更轻松地进行快速编辑，允许多个编辑器对一个页面进行编辑，并确保每个人都使用最新的文档（没有可能过时的“本地”文档副本）。

> 我们已经非常有机地成长，因此用户界面极大地反映了我们公司的组织，而不是我们的客户会觉得直观的内容组织。

当接口不被视为单独的模块化组件时，就会发生这种情况。接口应该插入它下面的功能，但不一定代表底层组织的结构。当通过“黑客”构建界面时，我经常看到这种事情；也就是说，开发人员构建一个新功能并修改 UI 以支持他们的功能，然后下一个开发人员做同样的事情，等等，直到整个 UI 拼凑在一起，没有总体设计目标或原则。不要低估用户界面的重要性或创建高质量、一致的界面的难度。从客户的角度来看，让工程师（或大型项目中的小团队）来设计和维护用户界面可以极大地提高产品的价值。由于客户通常只看到用户界面而看不到任何内部工作，因此界面应该超过团队 1% 的劳动成果。

如果您让所有单独的团队都在同一条轨道上，那么实施“scrum of scrums”结构是相当容易的。每天，每个小组/团队都会举行简短的状态报告/scrum 会议，之后每个小组指定的“领导者”会在“食物链上游”的下一个级别举行另一个 scrum。由于这可以在多个层次结构中重复，因此当小组 scrums 发生在早上的第一件事时，它往往效果最好，并且每个级别的 scrum 都有一个严格而快速的时间限制（通常是 15 分钟，或 2-3 分钟）每个人就足够了）。时间限制有助于防止一个团队超时并延迟他们的领导者参加下一级别的 Scrum 会议等。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-13T14:38:06.310

我遇到了一些成功运行 Scrum of Scrums 的 CSM，但除非你已经熟悉 Scrum，否则很难管理。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-19T13:45:01.243

**“scrum of scrums 的任何替代解决方案？”**

是的。一位建筑师。

架构师的工作——在这种情况下——不是决定架构。

架构师的工作是在团队之间进行协调。定期与大家见面。参加 Scrums，在需要帮助的地方提供帮助。

最重要的是：

*   充当对变更请求的治理。

*   在各个团队之间建立共同的愿景。

这需要技术深度来了解正在发生的一切，以及确保每个人都被听到的政治技能。

最后，它需要管理层的支持来执行决策。例如，如果所有开发团队之间的共识是技术 X，而一个团队坚持技术 Y，那么可能是时候让一个团队在另一家公司找到新工作了。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-19T14:28:09.797

*   让团队开会讨论他们的工作。至少如果每个人都知道主题专家是谁，他们就可以利用这种经验。
*   如果您太大而无法满足，请拥有一个公司 wiki 并鼓励人们使用它来共享解决方案。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-13T15:57:09.617

让每个开发人员不断地分配到系统的同一部分会增加产品之间的差异。通过在这些团队中移动开发人员来减少这种情况。它还将减少信息孤岛，并增加他们对他们正在开发的作品如何适应业务的理解。你也不应该过度这样做。

关于系统集成。这些是具有不同需求的不同服务，它们都有自己的上下文。这些应用程序可以专注于自己的上下文，因为这可以减少很多其他问题。

您要做的是确保服务之间有明确定义的集成点。它是关于系统将如何交互以及所涉及的信息合同达成一致。这应该在应用程序级别运行，而不是在数据库级别。它还与操作和信息/情报有关，而不是数据。[这](http://msdn.microsoft.com/en-us/architecture/aa479371.aspx#)是一篇关于企业架构的非常好的文章。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-16T08:53:54.143

首先，您需要一个版本控制（我假设您已经在使用一个）。确保为每个开发人员设置正确的权限，这样他们就不会“意外”破坏事情。这应该使团队 A 的开发人员能够访问团队 B 的代码。

其次，为了确保 A 团队没有使用来自 A 团队的不可用/不完整的代码，A 团队需要发布一个“可用/良好”的代码供其他团队使用。这可以通过从特定的“可用/良好”修订版分支或仅发送“可用/良好”修订号来完成。

最后，这一切都是为了在团队之间建立诚实和开放的沟通。确保明确定义所有接口和角色。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-03-19T14:49:28.297

我同意 S. Lott 的观点。你需要一个有能力的信息/用户体验架构师。这个人应该因为以前从事过创新项目而受到开发人员的尊重。

# javascript - 跨浏览器 HTML 布局的正确方法是什么？

> ID：642991
> 
> 赞同：0
> 
> 时间：2009-03-13T14:35:48.797
> 
> 标签：javascript, html, dom, layout, css-tables

我刚刚阅读了应该支持多种现代浏览器（包括 FireFox 3.X、Safari 3.X 和 IE7+，但不包括 IE6-）的网络产品的代码。HTML 代码使用***div***而不是***table***来创建类似表格的效果。实际上，***div***的组织方式如下：

```
 <div>
         <div>
              <div style="float:left" id="header1">...</div>
              <div style="float:left">...</div>
              <div style="float:left">...</div>
         </div>
         <div>
              <div style="float:left" id="header2">...</div>
              <div style="float:left">...</div>
              <div style="float:left">...</div>
         </div> 
```

有一段 onload JavaScript 代码可以读取所有“headerX”元素，计算它们的最大***offsetWidth***。然后将最大***offsetWidth***分配给它们中的每一个。这样，div 就可以很好地对齐，就像表格一样。

实际上，我认为这不是一个好方法，但有人告诉我，该产品是这样设计的，以使其***支持跨浏览器***，因为**表**在不同浏览器中的行为不同。

我不相信。所以，问题。除了上面提到的方法之外，还有什么更好的方法可以为所有流行的浏览器制作类似表格的布局？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-03-13T15:22:54.940

看起来几乎每个人都误解了你的问题（或者我可能误解了）。

听起来网络产品正在尝试使用 div 显示表格数据，其原因是它是使其跨浏览器兼容的最佳方式。这不仅是错误的，通过将 javascript 引入等式，它们会立即降低它在您的用户之间的兼容性。如果用户禁用了 javascript，则 div 将一团糟。最好在`<table>`这种情况下使用它，因为它实际上在浏览器中运行得相当好，这就是为什么它过去设计布局如此吸引人的原因。

大多数人在他们的答案中所指的是使用表格制作网站布局的旧罪，我认为您的问题并未真正涵盖。无论如何，这是不恰当的，因为`<table>`标签在语义上与保存布局内容无关。最好始终保持 HTML 文档的语义。这个网络产品正在做同样的事情，但以相反的方式：他们使用`<div>`标签来显示表格数据，当它在`<table>`那里时。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-13T15:22:19.373

> 有人告诉我，该产品是这样设计的，以使其支持跨浏览器，因为表在不同的浏览器中表现不同。

噗。表格在浏览器中的行为与任何其他功能没有什么不同。

使用 JavaScript 来模拟表格布局而不是仅仅使用表格确实是不正当的。它会比让浏览器更慢更笨重，它会在没有启用 JS 的情况下分崩离析，并且它可能无法很好地响应缩放（在某些情况下会破坏 offsetWidth）或百分比宽度舍入错误。

在某些情况下，使用 JavaScript 来增强布局可能是合适的，因为表格和 CSS 布局都无法单独完成，但这并不是其中之一。

> 有没有更好的为所有流行的浏览器制作类似表格的布局？

是的，使用一张桌子。“这个标记是否真的代表一个表格”的语义问题在很大程度上是一个学术问题。（并且您的标记谈论标题，听起来您甚至可能正在使用真正的语义表！）

只要从上到下的阅读顺序有意义，避免使用简单的表格进行布局几乎没有实际危害。“表格本质上是邪恶的”的想法是对大多数网站使用嵌套、跨区和固定表格的可怕混乱创作的时代的反应，导致无法阅读和无法访问标记。

当然，如果您可以将每个页面元素放在一个 div 中并使用 CSS 来定位每个元素之间的相对位置、页面大小等，那将是理想的。但现实情况是 CSS 并没有那么强大，有些东西可以稍微保守的表使用就可以更简单地实现。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-13T14:38:10.477

我知道这不能回答您的问题，但尽量避免使用表格布局，并**学习如何编写跨浏览器兼容的 CSS 来定位您的页面内容**。

[在csszengarden 了解](http://www.csszengarden.com)CSS 布局的可能性

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-03-13T14:46:41.237

你在做什么叫做 div-soup。阅读[语义 HTML](http://en.wikipedia.org/wiki/HTML#Semantic_HTML)和 CSS 属性`display`。

另外，如果数据是表格的，那么使用表格也没有什么问题。要在不同浏览器中获得相同的布局，您可能必须设置 CSS-property`border-collapse: collapse`或 HTML 属性`cellspacing="0"`

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-13T14:50:23.770

您必须使用 JavaScript 进行格式化/设计的情况并不多。我现在唯一记得的例外是当用户调整窗口大小时重新格式化页面。

这种事情可以用纯 HTML + CSS 100% 完成。它可能需要 IE6 和移动平台的条件样式表，但到目前为止，我制作的每个网站都有相同的 IE7 和 FF3 样式表，并且可以使用 DIV 而不是表格。您只需要思考、谷歌和即兴创作（按此顺序；）。

但是，我认为如果没有每个表、行和单元格的 DIV 就无法实现这种特殊情况，这意味着您将做与`<table>, <tr> and <td>`. 在表格中显示表格数据在语义上很好，所以如果你真的需要它作为表格，而不是作为 Web 布局，只需省去麻烦并使用 HTML 表格标记。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-13T14:55:08.860

甚至我对使用表格进行布局也有类似的想法。但后来我发现很多流行的网站都在使用基于 div 的布局。所以我认为这就是现在的做法。您不必从头开始构建一个。网络上有很多可用的 css 框架，可以轻松使用。请在下面找到列表。

[http://developer.yahoo.com/yui/](http://developer.yahoo.com/yui/)
[http://code.google.com/p/blueprintcss/](http://code.google.com/p/blueprintcss/)

**这里有 css 框架列表**
[http://speckyboy.com/2008/03/28/top- 12-css-frameworks-and-how-to-understand-them/](http://speckyboy.com/2008/03/28/top-12-css-frameworks-and-how-to-understand-them/)

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-03-13T15:14:44.693

这是一个很好的例子，说明有人忽略了避免使用表格进行布局的全部要点。使用表格进行布局的主要问题是，以后在站点范围内更改任何内容变得非常困难和乏味。

通过将 CSS 规则放入 HTML 中，他们将表格的不灵活与狡猾和重复的 CSS 结合起来。最重要的是，他们滥用 javascript 来重新创建表中已经存在的功能。

这个问题没有简单或“正确”的答案。在不了解您的具体情况的情况下，我所能做的就是列出一些基础知识：

*   更少的代码几乎总是更好。
*   如果您发现自己尝试使用 css（或特别是 javascript）复制表行为，您可能只想使用表。
*   更少的代码几乎总是更好。
*   如果您发现自己将表格嵌套在其他表格中，则可能有更好的方法来实现您的目标。
*   更少的代码几乎总是更好。
*   如果它可以让你大大简化你的代码，不要害怕改变你的设计。

事实是，没有灵丹妙药。那里有大量资源，但与任何有价值的追求一样，它需要时间和奉献精神。使用隐藏复杂性的工具可能会在短期内有所帮助，但请注意，您不再能够控制在幕后代表您做出的权衡取舍。

几个地方开始：

*   [http://www.456bereastreet.com/archive/200410/bring_on_the_tables/](http://www.456bereastreet.com/archive/200410/bring_on_the_tables/)
*   [http://www.alistapart.com/topics/code/css/](http://www.alistapart.com/topics/code/css/)
*   [http://getfirebug.com/](http://getfirebug.com/)

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-03-13T15:31:14.700

没有这样的事情。

每个浏览器都有自己的怪癖。你需要与他们反复斗争，并学会绕过他们。

说 CSS 布局比表格布局更跨浏览器或更可靠只是*盲目*的。不，不是。相信 CSS 标记比表格标记更语义化和更酷是一个宗教问题，与这两种方法的实际技术方面无关。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-03-13T14:44:10.727

> HTML 代码使用**div**而不是**table**来创建类似表格的效果。

这是一个常见的误解 - 许多人过去使用表格进行布局的旧方法是使用**表格**而不是**div**来实现类似 div 的效果。:)

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-03-13T14:48:24.103

我认为这是不可能的。

但是请注意，如果行的高度已知，您可以通过第一列定义表格 - 第一行，第二行，...第二列 - ...。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-03-13T15:16:01.477

我发现 div/table 辩论最好留给其他人浪费时间。在设计跨浏览器布局时，我发现最有效的理念是将 table 和 div 都视为独特的元素，每个元素在网页上都有自己的位置。如果你发现自己能够有效地使用 div，那就太好了（如果你能让它们在所有浏览器中正常工作，那么对你来说就更强大了。）然而，对于更复杂的布局，我发现表格也很有用，当您注意指定单元格填充、单元格间距、边框等时。我最近完成了一个项目，我们的最终设计策略使用了一系列 div 元素，每个元素都封装了一个表格设置，以获得我们想要的设计。页面是[http://www.kafuka.org](http://www.kafuka.org)，如果您想知道我的意思。

# javascript - 奇怪的html错误

> ID：642994
> 
> 赞同：0
> 
> 时间：2009-03-13T14:36:24.287
> 
> 标签：javascript, html, css

我有一个链接列表，这些链接表现出一些非常奇怪的行为。代码是：

```
<ul id="home" class="panel" title="title_here" selected="true">
   <li><a href="#search">Search for Name</a></li>
   <li><a href="#browse">Browse by Department</a></li>
</ul> 
```

它是 iPhone 网站的一部分，使用 iUI 框架。我知道uiUI更好，但是我的老板更喜欢iUI框架的外观，所以我不得不使用它。该框架通过使用'selected="true"' attr 工作，当链接将您带到不同的id 时，使用js 将'selected="true"' 添加到您链接到的id。

我的问题是：当您点击一个链接，然后“返回”时，可点击部分仅变为链接的背景图像，而不是整个“li”。这是CSS：

```
body > ul > li > a {
display: block;
margin: -8px 0 -8px -10px;
padding: 8px 32px 8px 10px;
text-decoration: none;
color: inherit;
background: url(listArrow.png) no-repeat right center;
} 
```

扩大实际图像尺寸（在 PS、绘画等中）会解决这个问题吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-13T23:11:54.733

如果可以，请尽可能避免负边距。他们会变得非常非常讨厌。

黑暗中的镜头：

*   您是否为 a:link、a:visited、a:hover 设置了任何样式？如果没有，则将它们添加到当前样式并再次检查

例子：

```
body > ul > li > a,
body > ul > li > a:link,
body > ul > li > a:visited,
body > ul > li > a:hover,
body > ul > li > a:active {
  display: block;
  margin: -8px 0 -8px -10px;
  padding: 8px 32px 8px 10px;
  text-decoration: none;
  color: inherit;
  background: url(listArrow.png) no-repeat right center;
} 
```

*   尝试为 LI 设置填充，而不是为 A 设置负边距；

*   尝试将背景设置为 LI 而不是 A，如果设计允许这样做，并摆脱 A 中的填充。

在我看来，这实际上是 iPhone / iUI 中的一个错误；很明显，它一次可以正常工作，但下一次就不行了，那里发生了一些有趣的事情。*****