# StackOverflow 问答 000410000-000410999

# php - 修复 PHP 空函数

> ID：410002
> 
> 赞同：34
> 
> 时间：2009-01-03T22:30:21.387
> 
> 标签：php, function, object

`empty()`PHP 有在使用函数时将 (int)0 和 (string)"0" 评估为空的习惯。如果您期望数值或字符串值为 0，这可能会产生意想不到的结果。如何“修复”它以仅对空对象、数组、字符串等返回 true？

* * *

## 回答 #1

> 赞同：43
> 
> 时间：2009-01-04T00:59:37.590

这对我不起作用。

```
if (empty($variable) && '0' != $variable) {
  // Do something
} 
```

我改为使用：

```
if (empty($variable) && strlen($variable) == 0) {
  // Do something
} 
```

* * *

## 回答 #2

> 赞同：19
> 
> 时间：2009-01-03T22:52:26.380

`empty()`由于您描述的原因，我很少使用。它混淆了合法价值与空虚。也许是因为我在 SQL 中做了很多工作，但我更喜欢用它`NULL`来表示没有值。

PHP 有一个函数`is_null()`可以测试变量或表达式是否为`NULL`.

```
$foo = 0;
if (is_null($foo)) print "integer 0 is null!\n"; 
else print "integer 0 foo is not null!\n";

$foo = "0";
if (is_null($foo)) print "string '0' is null!\n"; 
else print "string '0' is not null!\n";

$foo = "";
if (is_null($foo)) print "string '' is null!\n"; 
else print "string '' is not null!\n";

$foo = false;
if (is_null($foo)) print "boolean false is null!\n"; 
else print "boolean false is not null!\n"; 
```

您还可以使用完全等于运算符`===`进行类似的测试：

```
if ($foo === null) print "foo is null!\n"; 
```

如果`$foo`is则为真`NULL`，但如果为`false`、零`""`、等则不成立。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2009-01-03T23:03:04.440

“0”在 PHP 中[总是被认为是假](http://www.php.net/manual/en/language.types.boolean.php#language.types.boolean.casting)的（或空的），它确实很有意义（我不会在这里争论）。如果您也想让零评估为真，请使用`strlen($value)`.

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2011-05-08T01:01:44.337

我总是添加到我的代码库中

```
function is_blank($value) {
    return empty($value) && !is_numeric($value);
} 
```

并使用它而不是empty()。它解决了将零（int、float 或 string）保持为非空的问题。

请参阅2011 年 5 月添加的[http://www.php.net/manual/en/function.empty.php#103756 。](http://www.php.net/manual/en/function.empty.php#103756)

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2009-01-03T22:35:10.223

“固定”是一种观点。另一种方法是假设它没有“损坏”，并学会按照有意设计的方式使用它。

鉴于您描述的问题，最好的办法是收紧您的代码，这样变量就不能进入不确定的类型状态。否则，您需要使用 gettype() 来测试数据类型。

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2009-01-03T22:53:44.460

一般来说，您希望使用三等号运算符来确定值何时真正为空或假。这更具体，结果**总是**完全按预期返回。

创建一个单独的函数来执行您可以在一行代码中执行但使用不同的运算符似乎过于复杂并增加了额外的混淆。

此外，许多程序员倾向于使用 0 或空字符串来表示不存在的值，但使用空值表示真正不存在的任何值（无论类型如何）更正确（我觉得更好的做法） -存在。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-01-05T06:23:58.340

您正在尝试将`empty()`其用于不打算用于的东西。就个人而言，我认为它的行为来自 PHP 中较旧的编程范例，它可能会被淘汰。

相反，让您的检查更加明确。与其检查该值是否无用，不如检查它是否有用。例如，如果您想要一个数组，请检查它是否为数组 ( `is_array()`) 而不是检查它是否为字符串。

此外，您可以依靠 all`$_POST`和`$_GET`variables 都是字符串这一事实，因此您可以与 "" 进行比较，或检查`strlen() == 0`.

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2016-04-05T08:37:30.117

我用它来检测空虚：

```
''  --> true
'0' --> false
0   --> false 
```

功能：

```
function is_empty_or_zero($str) {
 return (is_null($str) || ($str === ''));
} 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-01-03T22:31:08.560

我创建了`IsEmpty()`一个简洁的快速函数。

```
function IsEmpty($mData) {
    return is_int($mData) ? false : 
        is_string($mData) ? $mData=="" : 
        empty($mData);
} 
```

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2014-01-09T07:26:55.700

```
if ( is_int($val) || !empty($val) ) {;} 
```

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2016-05-06T03:40:41.447

我使用[`ord`](http://php.net/manual/en/function.ord.php)函数来检查传递的值是否为空。

```
/*
* SPACE is not empty - Please do trim before using this function for your own purpose
*  var_dump(is_having_value(0));        // true
   var_dump(is_having_value(0000));     // true
   var_dump(is_having_value("    0"));  // true
   var_dump(is_having_value(""));       // false
   var_dump(is_having_value("  "));     // true
   var_dump(is_having_value('\t'));     // true
   var_dump(is_having_value(''));       // false
   var_dump(is_having_value('o'));      // true
   var_dump(is_having_value('O'));      // true
   var_dump(is_having_value('0'));      //true
   var_dump(is_having_value(null));     //false
   var_dump(is_having_value());         //false
*/
function is_having_value($val = null) {
    if (is_array($val) || is_object($val)):
        $logic_empty = empty($val);
        return !$logic_empty;
    else:
        $ascii = ord($val);
        if ($ascii == 48 || $ascii = 0 || $ascii == 32):
            return true;
        else:
            $logic_empty = empty($val);
            return !$logic_empty;
        endif;
    endif;
} 
```

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2020-11-11T01:03:35.933

如果你想要一个等价的`empty($var)`which 在 var 是字符串“0”时返回 false，你可以使用：

```
if (($var ?? 0) != '') 
```

这样做的原因是：

*   `$var ?? 0`是 ternery 的快捷方式`isset($var) ? $var : 0`。也就是说，如果左边的变量不存在，它会取右边的值，而不发出警告或通知，就像 isset() 或 empty() 一样。

*   `<value> != ''`当左值不是字符串时，对空字符串进行隐式转换。对于任何类似假的值，`<value>`例如 null、false 或（数字）0，这将返回 false。但是，对于字符串“0”，这将返回 true，因为不会执行强制转换并且`"0" != ""`为 true。

* * *

## 回答 #13

> 赞同：-3
> 
> 时间：2009-01-03T23:22:35.883

这个问题最有效的解决方案是测试变量是否为假，例如

```
 if (!$variable_name) {echo $variable_name;} 
```

变量是空还是空都没有关系，放入if条件时都等于false。

# c++ - 在 Windows 环境中从 C 或 C++ 访问 COM 接口

> ID：410005
> 
> 赞同：3
> 
> 时间：2009-01-03T22:33:47.230
> 
> 标签：c++, c, windows, com

我对组件对象模型规范比较陌生 - 我有一个简单的问题：

*   如何从 C 或 C++ 应用程序 访问**COM 接口**

例如，访问 Microsoft Excel COM 接口以执行基本操作，无需用户干预。

亲切的问候

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-03T22:39:40.150

如果您使用 C++，我建议您研究 ATL，如果使用 C，则使用 C++。使用#import 构造访问 DLL 或 EXE 中的 COM 对象非常容易。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-03T22:43:10.173

实际上，您需要使用 COM 接口实例化对象。

这是相当复杂的，我们不能在这里回答。

这是一个很好的入门： http: [//www.codeproject.com/KB/COM/comintro.aspx](http://www.codeproject.com/KB/COM/comintro.aspx)

另一个： http: [//www.codeguru.com/cpp/com-tech/activex/tutorials/article.php/c5567](http://www.codeguru.com/cpp/com-tech/activex/tutorials/article.php/c5567)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-03T22:46:55.317

微软有一篇精彩的文章似乎解决了这个确切的问题。如果你想坚持使用直接的 C++（即 MFC/ATL），你应该查看这篇文章，因为它有大量的示例代码：

[如何在不使用 MFC 或 #import 的情况下从 C++ 自动化 Excel](http://support.microsoft.com/kb/216686/EN-US/)

# flash - 在 AS3 中快速设置关键帧上的实例名称

> ID：410011
> 
> 赞同：3
> 
> 时间：2009-01-03T22:37:57.970
> 
> 标签：flash, actionscript-3, timeline

现在在 Flash CS3 及更高版本（使用 Actionscript 3）中，如果您在一个图层的多个关键帧中使用了相同的实例，并且您决定稍后分配或更改实例名称，则必须转到每个关键帧并设置实例名称。这是一个大麻烦。有没有更快或更好的方法来做到这一点？

注意：在 AS2 中，您可以通过在 MovieClip 类的 onLoad 处理程序的代码中使用 MovieClip 的 name 属性来设置名称，这样一劳永逸。不幸的是，在 AS3 中，您不能再设置 name 属性。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-01-04T10:07:05.847

您可以使用 JSFL（一种基于 javascript 的 Flash 自动化语言）来自动执行此类任务。

*   单击文件 > 新建
*   从列表中选择“Flash JavaScript 文件”
*   粘贴以下脚本
*   确保在 FLA 文件中选择了实例
*   单击 JSFL 脚本文件中的运行（播放）按钮

然后，您可以使用以下代码使用前缀和索引号命名所有选定的实例：

```
var prefix:String = "myInstance_";
for(i in fl.getDocumentDOM().selection)
{
    fl.getDocumentDOM().selection[i].name = prefix + i.toString();
} 
```

这将导致您的实例被命名为 myInstance_1、myInstance_2 等。这主要是您扩展特定需求的示例。

*（需要注意的一件事 fl.trace() 是在调试时如何在 JSFL 中打印跟踪消息，我花了一段时间才弄清楚）*

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-04T05:13:38.187

**查找和替换实例名称**的半自动方法是：

1.  Flash 主菜单 > 编辑 >**查找和替换**(CTRL+F)
2.  在**“当前文档”中搜索**
3.  对于**“符号”**
4.  名称***[您的实例的符号]***
5.  确保未选中**实时编辑**。
6.  在某处写下您的**新**实例名称，然后将其**复制**到剪贴板。

*每个实例重复以下操作：*

1.  按查找和替换面板上的**查找下一个**
2.  双击“属性”面板中的“**实例名称**”文本字段，以选择“全部”
3.  **粘贴**您的新实例名称，覆盖原始实例名称
4.  按**ENTER**提交您的更改。

玩得开心！这是使用 Flash IDE 中工具的最佳方式

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-04T05:05:16.067

在将它们复制到多个关键帧**之前**命名您的实例！*（在按 F6 之前 - 插入新关键帧）*这始终是最好的解决方案。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-04T05:42:39.157

如果所有实例帧都是串行的，那么您只需首先指定名称。否则“查找和替换实例名称”可能是最好的解决方案。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-10T20:35:10.963

改变乘法框架的最好方法（但不是最骗人的）

1.  选择该时间线中的所有帧

2.  单击“编辑多帧”
    按钮此按钮位于洋葱皮附近的时间线下方

3.  更改实例名称

这将更改所有框架的实例名称

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2010-03-31T03:00:12.657

此扩展将在多个关键帧上设置实例名称：http: [//ajarproductions.com/blog/2010/03/30/set-instance-name-on-multiple-frames/](http://ajarproductions.com/blog/2010/03/30/set-instance-name-on-multiple-frames/)

# macos - OSX 应用程序通常在哪里存储用户配置数据？

> ID：410013
> 
> 赞同：61
> 
> 时间：2009-01-03T22:38:29.170
> 
> 标签：macos, installation

我在 OSX 上注意到，安装通常是拖放一个文件有点交易。我假设该文件是所有应用程序必要位的存档，并且应用程序直接从它运行。应用程序在哪里存储配置数据，尤其是当有多个用户时，每个用户的设置？在 Windows 上，此类内容可能会保存在 HKLU 或 HKLM 下的注册表中，或者保存在用户或所有用户的 Application Data 文件夹中。

* * *

## 回答 #1

> 赞同：96
> 
> 时间：2009-01-03T22:43:07.757

在`/Users/username/Library/Preferences`.

您还会看到一些东西被放置在`/Users/username/Library/Application Support`.

这两个文件夹在外部都有对应的全局位置`/Users`，即在`/Library`. 然而，出于显而易见的原因，这些似乎很少被应用程序使用。

OSX 原生应用程序的首选项格式通常是 .plist（属性列表）文件，其名称以反向域名语法给出。有一个名为 Property List Editor 的独立应用程序，它允许您查看和编辑此类文件。（我认为它是 XCode/developer-tools 下载的一部分。）当然，没有什么可以阻止您使用自己的偏好存储系统，并且大多数跨平台的应用程序自然会倾向于这样做，但是偏好应该仍然放在`/Users/username/Library/Preferences`目录中。

**编辑：**如果您正在为 Mac 编写软件并且您正在使用 Cocoa 框架，那么 Apple 为处理存储和检索首选项设置的 Cocoa API 部分提供了此文档：[用户默认编程](https://developer.apple.com/library/mac/documentation/Cocoa/Conceptual/UserDefaults/Introduction/Introduction.html)

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2016-04-19T17:16:46.387

也是 寻找的地方`/Users/username/Library/Containers`。`/Users/username/Library/Group Containers`

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2009-01-05T19:36:16.260

作为harms 答案的补充，我会注意到，与windows 注册表一样，OS X 首选项在删除应用程序时不会被故意删除，但与Windows 注册表不同，当您升级Mac 时，首选项可以在机器之间迁移，并且使用“用户迁移”工具。

这可能会导致令人惊讶的结果，例如安装“NeatoApp 2008”并发现它知道您为“NeatoApp 2003”选择的所有设置，即使您当前的计算机上从未安装过 2003 版本。

# c# - 从 XML Web 服务模式创建对象的工具

> ID：410018
> 
> 赞同：0
> 
> 时间：2009-01-03T22:39:19.497
> 
> 标签：c#, asp.net, xsd

我经常使用外部 Web 服务，我需要基于该文档创建一个对象（类），以便我可以在我的 Web 应用程序中使用该对象。

我的问题很简单，有没有一种方法可以仅使用架构提供的 XML 创建/生成对象？

kind'a [wscompile 工具](http://huihoo.org/openweb/java_web_services_tutorial/JAXRPC6.html)

将为每个人节省很多时间:)

**在前 2 个回复后添加：**

也许你是对的，但无法测试

也许是我，但我该怎么做：

[http://obo.par.se/jboss-net/services/DocumentFactory?WSDL](http://obo.par.se/jboss-net/services/DocumentFactory?WSDL)

在手册中它说

> “如果您从 Visual Studio 构建 Web 服务，则必须使用以下内容作为 WSDL 源：“OBO - 已修改为使用 Visual Studio.wsdl”

“Web 服务”不应该与我们选择创建和使用它的任何语言相同吗？这不是 Web 服务的重点吗？

我什至复制了 Schema 并保存[在这里](http://www.balexandre.com/temp/xmlShemaTest.xml)，这样我就可以从 VS 导入，但是当我作为 Web Reference 导入时，我没有得到对象，我错过了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-03T22:45:59.483

通过在 Visual Studio 中创建 Web 引用，将为您创建代理类。这可能是你需要的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-03T22:43:16.897

假设我理解你的问题.... Visual Studio 已经能够为几个版本创建 WSDL 的代理类 .. google：visual studio wsdl proxy

# c# - 如何获取复选框列表的值（未选中或未选中）

> ID：410021
> 
> 赞同：1
> 
> 时间：2009-01-03T22:42:19.303
> 
> 标签：c#, .net, winforms

我正在开发一个 winform 应用程序，并且正在通过一个复选框列表进行交互以查看已检查的内容。如果它被选中，我需要知道它的值成员或值属性是什么，因为我在绑定复选框列表时分配了它。

我怎么能得到那个？

这是我现在拥有的：

```
 for (int i = 0; i < clbIncludes.Items.Count; i++)

                if (clbIncludes.GetItemCheckState(i) == CheckState.Checked)
                {
                    //need the values of the checked checkbox here
                }"); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-04T05:22:46.687

```
foreach(object itemChecked in checkedListBox1.CheckedItems)
{
    MyItem item = itemChecked as MyItem;

    if (item != null)
    {
       // use item...
    } 
} 
```

MSDN[参考](http://msdn.microsoft.com/en-us/library/system.windows.forms.checkedlistbox.checkeditems.aspx)。

# php - 发送和接收短信到 PHP 脚本？

> ID：410022
> 
> 赞同：11
> 
> 时间：2009-01-03T22:42:51.470
> 
> 标签：php, sms, bulksms, cellular-network

**PHP 脚本**（可以与 MySQL 数据库一起使用）可以使用某种服务器端解决方案**发送和/或接收 SMS吗？**

是否需要任何特殊的服务器端**应用程序**或特殊**硬件**？和兼容性？窗户，**Linux？**

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-01-03T22:45:34.617

有很多像[Esendex](http://www.esendex.co.uk/)这样的公司提供用于发送/接收 SMS 消息的 API。我不确定您是否希望直接从您的硬件发送它们？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-03T23:53:51.593

您可以将 usb 连接到 gsm 调制解调器并从 php 或任何其他语言发送消息，或者您可以在手机上开发 J2EE 程序来做同样的事情（这是 hackier）。

最便宜的方法（我的经验是这样）是花 50 美元买一个 MultiTech GSM 模块，安装一个无限文本的 GSM 卡并开始使用串口通信，非常简单的命令允许您发送文本和模块使所有的协议连接和东西......

基本上你最终会使用 AT 命令（它们从调制解调器变为调制解调器），但它们就像 AT#T/"555031231" 示例文本消息 //

当然，使用 gsm 芯片的缺点是您实际上必须做一些电子设备，如果您选择高端 gsm 调制解调器，它们已经解决了所有问题，您可以即插即用！

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-04T07:52:47.117

如果您在英国，txtlocal 是一个不错的选择。他们已经在他们的网站上提供了示例代码来帮助您启动和运行。很简单，使用 curl 函数。

[http://www.txtlocal.co.uk/](http://www.txtlocal.co.uk/)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2017-08-29T07:16:08.430

**发送短信**：

1.  CURL 应该安装在您的服务器上。（或者你可以使用 php_file_get_contents 函数，但我推荐 CURL ）
2.  来自短信网关服务器提供商的短信 API。

这是一个使用 CURL 发送短信的简单函数：

```
function CURLsendsms($number, $message_body){
 $api_params = $api_element.'?apikey='.$apikey.'&sender='.$sender.'&to='.$mobileno.'&message='.$textmessage;
 $smsGatewayUrl = "http://springedge.com";
 $smsgatewaydata = $smsGatewayUrl.$api_params;
 $ch = curl_init();
 curl_setopt($ch, CURLOPT_POST, false);
 curl_setopt($ch, CURLOPT_URL, smsgatewaydata);
 curl_setopt($ch, CURLOPT_RETURNTRANSFER, true);
 $output = curl_exec($ch);
 curl_close($ch);
 // Use file get contents when CURL is not installed on server.
 if(!$output){
 $output =  file_get_contents($smsgatewaydata);  
 }
} 
```

您也可以使用 php 类发送短信[http://www.phpclasses.org/package/9522-PHP-Send-SMS-messages-with-Spring-Edge-API.html](http://www.phpclasses.org/package/9522-PHP-Send-SMS-messages-with-Spring-Edge-API.html)

上面的类中有两个文件： sendms.php - 调用短信网关的类文件 restAPI test.php - 测试短信功能的示例文件。此类使用 spring edge[短信网关提供程序 API](https://www.springedge.com)

**接收短信**：

您需要购买一个虚拟号码，可以是 10 位虚拟手机号码或短代码号码。

虚拟号码可以使用带有参数作为查询字符串的 HTTP URL 进行配置

> 前任。example.com/receivesms.php?from=%number%&smstext=%text%

在虚拟号码上收到的所有消息都将触发到配置的 URL，因此您可以根据需要在脚本中进一步处理它（例如，存储对 DB 的回复或发送短信作为响应）。

虚拟手机号码（2路短信号码）可以与任何短信服务提供商进行配置

# c# - 正确使用“收益回报”

> ID：410026
> 
> 赞同：946
> 
> 时间：2009-01-03T22:43:35.353
> 
> 标签：c#, yield-return

[yield](https://docs.microsoft.com/en-us/dotnet/csharp/language-reference/keywords/yield)关键字是C# 中一直让我感到迷惑的[关键字](https://docs.microsoft.com/en-us/dotnet/csharp/language-reference/keywords/)之一，而且我从来没有信心自己正确地使用它。

在以下两段代码中，哪个是首选，为什么？

**版本 1：**使用收益回报

```
public static IEnumerable<Product> GetAllProducts()
{
    using (AdventureWorksEntities db = new AdventureWorksEntities())
    {
        var products = from product in db.Product
                       select product;

        foreach (Product product in products)
        {
            yield return product;
        }
    }
} 
```

**版本 2：**返回列表

```
public static IEnumerable<Product> GetAllProducts()
{
    using (AdventureWorksEntities db = new AdventureWorksEntities())
    {
        var products = from product in db.Product
                       select product;

        return products.ToList<Product>();
    }
} 
```

* * *

## 回答 #1

> 赞同：838
> 
> 时间：2009-01-03T23:01:41.247

当我计算列表中的下一个项目（甚至是下一组项目）时，我倾向于使用 yield-return。

使用您的第 2 版，您必须在返回之前拥有完整的列表。通过使用yield-return，您实际上只需要在返回之前拥有下一个项目。

除其他外，这有助于将复杂计算的计算成本分散到更大的时间范围内。例如，如果列表连接到 GUI 并且用户从未进入最后一页，则您永远不会计算列表中的最终项目。

另一种优选收益回报的情况是 IEnumerable 表示无限集。考虑素数列表，或无限的随机数列表。您永远无法一次返回完整的 IEnumerable，因此您使用 yield-return 逐步返回列表。

在您的特定示例中，您拥有完整的产品列表，因此我将使用版本 2。

* * *

## 回答 #2

> 赞同：696
> 
> 时间：2013-07-08T14:14:09.470

填充临时列表就像下载整个视频，而使用`yield`就像流式传输该视频。

* * *

## 回答 #3

> 赞同：79
> 
> 时间：2012-10-09T21:45:30.133

作为理解何时应该使用 的概念示例`yield`，假设该方法`ConsumeLoop()`处理返回/产生的项目`ProduceList()`：

```
void ConsumeLoop() {
    foreach (Consumable item in ProduceList())        // might have to wait here
        item.Consume();
}

IEnumerable<Consumable> ProduceList() {
    while (KeepProducing())
        yield return ProduceExpensiveConsumable();    // expensive
} 
```

如果没有`yield`，调用`ProduceList()`可能需要很长时间，因为您必须在返回之前完成列表：

```
//pseudo-assembly
Produce consumable[0]                   // expensive operation, e.g. disk I/O
Produce consumable[1]                   // waiting...
Produce consumable[2]                   // waiting...
Produce consumable[3]                   // completed the consumable list
Consume consumable[0]                   // start consuming
Consume consumable[1]
Consume consumable[2]
Consume consumable[3] 
```

使用`yield`，它会重新排列，有点交错：

```
//pseudo-assembly
Produce consumable[0]
Consume consumable[0]                   // immediately yield & Consume
Produce consumable[1]                   // ConsumeLoop iterates, requesting next item
Consume consumable[1]                   // consume next
Produce consumable[2]
Consume consumable[2]                   // consume next
Produce consumable[3]
Consume consumable[3]                   // consume next 
```

最后，正如之前许多人已经建议的那样，您应该使用第 2 版，因为无论如何您已经有了完整的列表。

* * *

## 回答 #4

> 赞同：35
> 
> 时间：2011-05-18T04:36:41.410

我知道这是一个老问题，但我想提供一个示例，说明如何创造性地使用 yield 关键字。我*真的*从这项技术中受益匪浅。希望这对偶然发现这个问题的其他人有所帮助。

注意：不要认为 yield 关键字仅仅是构建集合的另一种方式。yield 的强大功能的很大一部分在于，在调用代码迭代下一个值之前，您的方法或属性中的执行会**暂停。**这是我的例子：

使用 yield 关键字（与 Rob Eisenburg 的[Caliburn.Micro 协程](http://devlicio.us/blogs/rob_eisenberg/archive/2010/08/21/caliburn-micro-soup-to-nuts-part-5-iresult-and-coroutines.aspx)实现一起）允许我表达对 Web 服务的异步调用，如下所示：

```
public IEnumerable<IResult> HandleButtonClick() {
    yield return Show.Busy();

    var loginCall = new LoginResult(wsClient, Username, Password);
    yield return loginCall;
    this.IsLoggedIn = loginCall.Success;

    yield return Show.NotBusy();
} 
```

这将打开我的 BusyIndi​​cator，在我的 Web 服务上调用 Login 方法，将我的 IsLoggedIn 标志设置为返回值，然后关闭 BusyIndi​​cator。

以下是它的工作原理： IResult 有一个 Execute 方法和一个 Completed 事件。Caliburn.Micro 从对 HandleButtonClick() 的调用中获取 IEnumerator 并将其传递给 Coroutine.BeginExecute 方法。BeginExecute 方法开始遍历 IResults。当返回第一个 IResult 时，在 HandleButtonClick() 中暂停执行，BeginExecute() 将事件处理程序附加到 Completed 事件并调用 Execute()。IResult.Execute() 可以执行同步或异步任务，并在完成时触发 Completed 事件。

LoginResult 看起来像这样：

```
public LoginResult : IResult {
    // Constructor to set private members...

    public void Execute(ActionExecutionContext context) {
        wsClient.LoginCompleted += (sender, e) => {
            this.Success = e.Result;
            Completed(this, new ResultCompletionEventArgs());
        };
        wsClient.Login(username, password);
    }

    public event EventHandler<ResultCompletionEventArgs> Completed = delegate { };
    public bool Success { get; private set; }
} 
```

设置这样的东西并逐步执行以观察正在发生的事情可能会有所帮助。

希望这可以帮助某人！我真的很喜欢探索使用 yield 的不同方式。

* * *

## 回答 #5

> 赞同：20
> 
> 时间：2016-11-22T16:35:09.957

对于需要迭代数百万个对象的算法，收益回报可能非常强大。考虑以下示例，您需要计算可能的拼车行程。首先我们生成可能的行程：

```
 static IEnumerable<Trip> CreatePossibleTrips()
    {
        for (int i = 0; i < 1000000; i++)
        {
            yield return new Trip
            {
                Id = i.ToString(),
                Driver = new Driver { Id = i.ToString() }
            };
        }
    } 
```

然后遍历每个行程：

```
 static void Main(string[] args)
    {
        foreach (var trip in CreatePossibleTrips())
        {
            // possible trip is actually calculated only at this point, because of yield
            if (IsTripGood(trip))
            {
                // match good trip
            }
        }
    } 
```

如果使用 List 而不是 yield，则需要将 100 万个对象分配到内存（~190mb），这个简单的示例将需要 ~1400ms 才能运行。但是，如果您使用 yield，则不需要将所有这些临时对象放入内存，并且您将获得显着更快的算法速度：此示例运行只需约 400 毫秒，完全没有内存消耗。

* * *

## 回答 #6

> 赞同：13
> 
> 时间：2009-01-03T23:30:21.920

这两段代码实际上是在做两件不同的事情。第一个版本将根据需要拉取成员。第二个版本将在您开始使用它*之前将所有结果加载到内存中。*

这个问题没有正确或错误的答案。哪个更可取取决于情况。例如，如果您必须完成查询的时间有限，并且您需要对结果做一些半复杂的事情，那么第二个版本可能更可取。但要注意大型结果集，尤其是在 32 位模式下运行此代码时。在执行此方法时，我多次被 OutOfMemory 异常所困扰。

但是要记住的关键是：差异在于效率。因此，您可能应该选择使您的代码更简单的任何一个，并且仅在分析后更改它。

* * *

## 回答 #7

> 赞同：12
> 
> 时间：2015-05-27T20:18:43.287

这就是[Chris Sells在](https://twitter.com/csells)[The C# Programming Language](https://rads.stackoverflow.com/amzn/click/com/0321741765)中讲述这些语句的内容；

> 我有时会忘记 yield return 与 return 不同，因为 yield return 之后的代码可以执行。比如这里第一次return之后的代码永远无法执行：
> 
> ```
> int F() {
>     return 1;
>     return 2; // Can never be executed
> } 
> ```
> 
> 相比之下，这里第一次yield return之后的代码可以执行：
> 
> ```
> IEnumerable<int> F() {
>     yield return 1;
>     yield return 2; // Can be executed
> } 
> ```
> 
> 这经常在 if 语句中咬我：
> 
> ```
> IEnumerable<int> F() {
>     if(...) {
>         yield return 1; // I mean this to be the only thing returned
>     }
>     yield return 2; // Oops!
> } 
> ```
> 
> 在这些情况下，记住 yield return 不像 return 那样“最终”是有帮助的。

* * *

## 回答 #8

> 赞同：11
> 
> 时间：2014-04-05T18:48:34.933

产量有两个很好的用途

它有助于在不创建临时集合的情况下提供自定义迭代。（加载所有数据并循环）

它有助于进行有状态的迭代。（流媒体）

下面是一个简单的视频，我制作了完整的演示，以支持上述两点

[http://www.youtube.com/watch?v=4fju3xcm21M](http://www.youtube.com/watch?v=4fju3xcm21M)

* * *

## 回答 #9

> 赞同：8
> 
> 时间：2009-01-03T22:58:29.380

假设您的产品 LINQ 类使用类似的产量进行枚举/迭代，第一个版本更有效，因为它每次迭代时只产生一个值。

第二个示例是使用 ToList() 方法将枚举器/迭代器转换为列表。这意味着它手动迭代枚举器中的所有项目，然后返回一个平面列表。

* * *

## 回答 #10

> 赞同：8
> 
> 时间：2009-01-03T23:30:25.493

这有点无关紧要，但由于这个问题被标记为最佳实践，我会继续投入我的两分钱。对于这种类型的东西，我非常喜欢将它变成一个属性：

```
public static IEnumerable<Product> AllProducts
{
    get {
        using (AdventureWorksEntities db = new AdventureWorksEntities()) {
            var products = from product in db.Product
                           select product;

            return products;
        }
    }
} 
```

当然，它有点样板，但使用它的代码看起来会更干净：

```
prices = Whatever.AllProducts.Select (product => product.price); 
```

对比

```
prices = Whatever.GetAllProducts().Select (product => product.price); 
```

**注意：**对于任何可能需要一段时间才能完成工作的方法，我不会这样做。

* * *

## 回答 #11

> 赞同：6
> 
> 时间：2009-01-03T22:54:27.063

那这个呢？

```
public static IEnumerable<Product> GetAllProducts()
{
    using (AdventureWorksEntities db = new AdventureWorksEntities())
    {
        var products = from product in db.Product
                       select product;

        return products.ToList();
    }
} 
```

我想这更干净。不过，我手头没有 VS2008 可供检查。在任何情况下，如果 Products 实现了 IEnumerable （看起来 - 它在 foreach 语句中使用），我会直接返回它。

* * *

## 回答 #12

> 赞同：5
> 
> 时间：2012-03-10T00:36:09.940

在这种情况下，我会使用代码的第 2 版。由于您拥有可用产品的完整列表，并且这是此方法调用的“消费者”所期望的，因此需要将完整信息发送回调用者。

如果这个方法的调用者一次需要“一个”信息，而下一个信息的消费是按需的，那么使用yield return是有益的，它可以确保执行命令在何时返回给调用者一个信息单元可用。

可以使用 yield return 的一些示例是：

1.  复杂的分步计算，其中调用者一次等待一个步骤的数据
2.  GUI 中的分页 - 用户可能永远不会到达最后一页，并且只需要在当前页面上披露信息的子集

为了回答你的问题，我会使用版本 2。

* * *

## 回答 #13

> 赞同：4
> 
> 时间：2009-01-03T23:01:52.010

直接返回列表。好处：

*   更清楚
*   ~~该列表是可重复使用的。（迭代器不是）~~实际上不是真的，谢谢乔恩

当您认为您可能不必一直迭代到列表末尾或当它没有结尾时，您应该使用迭代器（yield）。例如，客户端调用将搜索满足某个谓词的第一个产品，您可能会考虑使用迭代器，尽管这是一个人为的示例，并且可能有更好的方法来完成它。基本上，如果您事先知道需要计算整个列表，请提前进行。如果您认为不会，请考虑使用迭代器版本。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2021-08-19T17:41:33.707

鉴于确切的两个代码片段，我认为版本 1 更好，因为它可以更有效。假设有很多产品，调用者想要转换为 DTO。

```
var dtos = GetAllProducts().Select(ConvertToDto).ToList(); 
```

在版本 2 中，首先会创建一个 Product 对象列表，然后是另一个 ProductDto 对象列表。在版本 1 中，没有 Product 对象列表，只构建了所需的 ProductDto 对象列表。

即使没有转换，我认为版本 2 也存在一个问题：列表作为 IEnumerable 返回。GetAllProducts() 的调用者不知道枚举结果的代价有多大。如果调用者需要多次迭代，她可能会使用 ToList() 实现一次（ReSharper 等工具也建议这样做）。这会导致已经在 GetAllProducts() 中创建的列表的不必要副本。因此，如果应使用版本 2，则返回类型应为 List 而不是 IEnumerable。

* * *

## 回答 #15

> 赞同：-4
> 
> 时间：2017-04-04T02:28:02.317

**yield**的用法与关键字**return**类似，只是它将返回一个[**生成器**](https://wiki.python.org/moin/Generators)。并且**生成器**对象只会遍历**一次**。

**产量**有两个好处：

1.  您不需要读取这些值两次；
2.  您可以获得许多子节点，但不必将它们全部放在内存中。

还有另一个明确的[解释](https://jeffknupp.com/blog/2013/04/07/improve-your-python-yield-and-generators-explained/)可能对您有所帮助。

# textmate - 最喜欢的 Textmate 命令、片段、捆绑包等

> ID：410027
> 
> 赞同：2
> 
> 时间：2009-01-03T22:43:57.507
> 
> 标签：textmate

这不是一个具体的一般编程问题，但我认识的很多 textmate 用户最终构建了一个 textmate 命令来做他们经常做的事情，但因为它本身就永远不会真正发布它。下面的地雷：

**Objective-C 构建和运行**

因为当我只是快速编写一个小的 Objective-C 命令行程序时，将它放在一个新命令中；将输入设置为整个文档，输出为 HTML 并根据需要设置激活（我使用 [apple] + [shift] + R）。

```
gcc "$TM_FILEPATH" -o "$TM_DIRECTORY"tmpTextMateRunObjectiveC -l objc
"$TM_DIRECTORY"tmpTextMateRunObjectiveC
rm "$TM_DIRECTORY"tmpTextMateRunObjectiveC 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-03T23:00:47.707

我使用的唯一真正的 TextMate 增强功能（除了语言包）[ProjectPlus](http://ciaranwal.sh/projectplus)插件。它用项目面板取代了烦人的项目抽屉，增加了对 SVN、Git、Mercurial、Bazaar 和 Svk 的支持，并添加了许多其他小东西。

这是项目页面的功能列表：

*   SCM 状态徽章：

    *   支持 SVN、Git、Mercurial、Bazaar 和 Svk
    *   显示在项目文件列表和窗口代理图标中
*   将项目抽屉交换为面板

    *   保留对 ⌃⌥⌘D 和 ⌃⌘R 的支持
    *   侧边栏可以放置在窗口的任一侧
    *   因为我创建了这个，所以有人用这些特性更新了 MissingDrawer 插件，如果你想使用这个插件，那么你可以禁用这个特性
*   Finder 颜色标签

    *   带标签的文件显示在项目抽屉中
    *   可以通过上下文菜单设置标签
*   重新打开项目时可以保留项目树状态
*   通过上下文菜单快速查看项目文件列表中的文件（或文件列表聚焦时的⌥␣）
*   通过项目文件列表上下文菜单排序选项
*   在顶部显示文件夹
*   按文件扩展名排序
*   “打开方式”选项

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-12-13T23:02:16.857

**修改语法突出显示**（例如，用您选择的语言教授 TextMate 新关键字）。

例如，要使 TM 在 Python 中突出显示“eval”和“compile”：

(i) 选择“Bundles”>“Bundle Editor”>“Edit Languages”；

(ii) 从 Bundle Editor 的 LHS 上的 Bundles 中选择“Python”；

(iii) 点击“Python”，您会看到下拉选项（前面有“L”）；

(iv) 点击“Python”选项；

(v) 确保在 B/E 的右上角切换“编辑”；

(vi) 在 RHS 上，您将看到所选语言的完整语法；

(vii) 向下滚动大约 100 行，直到你看到，'comment = "keywords that have not fit into other groups (yet).";

(viii) 许多语言包都属于此类别，您想要进行的许多更改可能属于此处；

(ix) 现在转到下一行（以 'match' 开头）并在 ')\b' 之前的最后一项之后添加一个竖线字符 ('|')，然后键入 'exec'，然后键入另一个 '| ' 然后输入“编译”——就是这样。

现在 TM 会识别这两个词，但是是什么？即，它如何为它们着色？
在这种情况下，我们告诉 TM 它们是关键字，所以转到 TextMate > Preferences > Fonts & Colors，然后向下滚动，直到在 Element 字段中找到“Comment”。在那里你会看到它的颜色，但这只是你目前使用的主题的一个功能。

总之，您可以更改 TM 识别的单词（通过相关的语言语法）**以及**TM 如何通过字体和颜色选项卡为该单词着色，这又取决于主题。

现在完全不同：如果您厌倦了紫色，请查看替代 GUI，它（DL 和安装大约需要 2 分钟或更短时间）：[http](http://wiki.macromates.com/Main/AlternativeGUIs) ://wiki.macromates.com/Main/AlternativeGUIs 。Jason Evers 的最后一款名为“Green Moleskine”是我唯一使用过的一款。如您所见，华丽，加上 DL 和安装需要大约 2 分钟。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-08-05T01:48:53.087

一篇关于[Alex Payne 如何使用 TextMate](http://al3x.net/2008/12/03/how-i-use-textmate.html)的精彩博文。我强烈建议使用 GetBundles 包来管理和更新 TextMate 中的包。非常适合浏览新捆绑包和现有捆绑包的更新。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-08-05T01:56:30.707

我通常发现自己只是添加自己的自定义语言片段。我什至还没有弄清楚如何在 Textmate 中编辑语法着色或其他更复杂的东西。我也没有发现自己需要知道如何做这些事情。虽然我确实使用了 ProjectPlus，但主要是添加我自己的片段的能力是让我喜欢 Textmate 的 90%。

Martin，我很想听听你用 Quicksilver 和 Textmate 做的一些事情，因为 Quicksilver 是另一个我想学习“滥用和过度使用”的应用程序。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-09T17:38:13.350

我制作了一堆片段/命令/宏，但它们大多是特定于语言的，并且在一定程度上是特定于马丁的。我所做的很多事情是对操作系统的其余部分进行编程，使其与 TextMate 很好地配合使用，通常是通过 QuickSilver（或者有时当我无法让 QS 完成这项工作时；QuicKeys）。

在 TextMate 中的 Firefox 中打开“查看源代码”窗口只需 google 搜索即可，在[这篇文章](http://parallaxdenigrate.net/?p=645)（由我撰写）中，有一些 AppleScripts 可以派上用场。当然，您应该安装“在 TextMate 中编辑”插件，它可以让您在 TM 的任何 Cocoa 应用程序中编辑任何文本字段，保存并继续使用它。

不过，要回答您的实际问题，我觉得在大多数情况下，人们非常慷慨地分享他们发现可能具有公共利益的内容，而在大多数情况下，TextMate 往往会成为一种非常个人化的工具，并随着用户的增长而发展。意义; 如果我向您发送了我尚未公开分享的命令和片段，您可能不会喜欢它们。

# c++ - 在 Visual Studio 2008 中调试时如何管道输出？

> ID：410029
> 
> 赞同：3
> 
> 时间：2009-01-03T22:44:25.960
> 
> 标签：c++, visual-studio

我尝试去项目属性，在配置属性下选择调试，并将命令参数设置为“> out.txt”（当然不带引号）。但是，当我运行程序（使用 F5）时，我仍然在控制台上看到输出，并且没有创建 out.txt 文件。这只是一个简单的 C++ Hello World 程序。这些步骤对我的朋友有效，但对我无效（他也在使用 VS2008）。我听说过禁用托管进程，但似乎这仅适用于 Visual Studio 2005。

似乎 "> out.txt" 作为参数传入。argc 为 3，argv[1] 为“>”，argv[2] 为“out.txt”。这不应该发生吗？我能做些什么来修复它？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-03T23:57:58.010

根据Microsoft Connect 网站上的[此错误报告](http://connect.microsoft.com/VisualStudio/feedback/ViewFeedback.aspx?FeedbackID=343812)，此问题已在 Visual Studio 2008 Service Pack 1 中修复。我在我的系统上运行 VS2008 SP1，并且输出重定向对我来说可以正常工作。[您可以在此处](http://www.microsoft.com/downloads/details.aspx?FamilyId=FBEE1648-7106-44A7-9649-6D9F6D58056E)下载 SP1 。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-03T23:43:14.470

我的结果与您相同：重定向在 2008 年对我来说也不起作用，但在 2005 年确实有效。正如@ChrisN 所提到的，这是 VS 2008 的一个错误，它已在 VS 2008 SP1 中修复。

要修复，您可以安装 VS2008 SP1 或使用此解决方法。

**这是解决方法：**

*   通过 freopen 重定向代码中的输出，[此链接说明了如何](http://support.microsoft.com/kb/58667)
*   将此代码包装在 #ifdef REDIRECT_OUTPUT_TO_FILE 和 #endif
*   转到 C/C++ 选项卡，然后是预处理器选项卡，并设置 REDIRECT_OUTPUT_TO_FILE

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-03T23:17:36.033

在 vs 2005 中非常适合我。也许检查 main() 中的参数以查看 "> out.txt" 是否作为参数传入，而不是在 cmd.exe 级别进行评估

# c - 使用 POSIX 消息队列而不是 TCP 套接字 - 如何建立“连接”？

> ID：410039
> 
> 赞同：14
> 
> 时间：2009-01-03T22:48:54.483
> 
> 标签：c, connection, client-server, posix, message-queue

我有现在通过 TCP 通信的客户端和服务器程序。我正在尝试使用 POSIX 消息队列（当然，在客户端和服务器在同一台机器上的情况下）。我希望它能提高性能（特别是通过减少延迟）。

我已经解决了大部分问题，但不确定一件事：如何建立“连接”。服务器同时接受来自多个客户端的连接，所以我很想模拟 TCP 连接建立过程，如下所示：

1.  服务器打开一个具有已知名称的队列并连续读取它（它可以`select(2)`与 TCP 一起使用）。
2.  客户端打开三个队列：两个具有任意名称（包括一些唯一性，例如 PID 以避免冲突），一个具有服务器使用的众所周知的名称。
3.  客户端向服务器的队列发布一条“连接”消息，包括客户端的队列名称（一个指定用于客户端到服务器的流量，另一个用于相反的流量）。
4.  服务器打开客户端连接消息中指定的队列，并开始从客户端到服务器的队列中读取（选择）。
5.  客户端使用众所周知的名称关闭服务器队列。双向通信使用客户端命名的两个队列（每个方向一个）进行。

您可能会看到该方案与常见的 TCP 方法有何相似之处，这绝非偶然。但是，我想知道：

1.  你能想出更好的方法吗？
2.  你看到我的方法有什么潜在的问题吗？
3.  您是否还有其他想法，包括在同一台机器上使用消息队列而不是 TCP 是否会真正提高性能（延迟）？

请记住，我之前没有使用过 POSIX 消息队列（我之前确实使用过 IBM WebSphere MQ，但那是相当不同的）。平台是Linux。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-01-03T23:40:59.840

1.  > 你能想出更好的方法吗？

    也许看看fifos（又名命名管道）。它们就像网络套接字，但用于本地机器。它们是单向的，因此您可能需要创建两个，每个方向一个。您的问题确实没有任何理由说明您*为什么*要专门进行此更改。使用套接字进行进程处理通信没有任何问题。它们是双向的、高效的、受到广泛支持的，并且确实让您可以自由地在以后分离机器之间的进程。

2.  > 你看到我的方法有什么潜在的问题吗？

    System V 消息队列和 fifo 命名管道都非常好。Fifo 管道就像常规管道一样，因此您可以通过最少的代码更改来读取（）和写入（）。System V 消息队列需要将数据放入结构中并调用 msgsnd()。然而，任何一种方法都可以。

3.  > 您是否还有其他想法，包括在同一台机器上使用消息队列而不是 TCP 是否会真正提高性能（延迟）？

    我的其他想法是，正如您所说，您需要开发一种技术，以便每个客户都有一个唯一的标识符。一种方法是将pid添加到您传递的结构中，或者在开始时与父/主协商一个唯一的ID。要注意的另一件事是 System V 消息队列的好处是您可以侦听“选择性”消息，因此您可以理想地使用从服务器到所有客户端的一个队列，每个客户端等待不同的消息。

    我不知道哪种技术可以为您的软件提供最佳吞吐量。确实可能不值得使用 System V 消息队列，但只有您可以做出决定。

菲尔米蒂

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-01-28T04:03:14.200

我最终基本上按照我的描述实现了它，并进行了一些改进：

*   在第 2 步中，我使用 GUID 作为队列名称，而不是合并客户端的 PID。
*   在第 4 步中，我添加了从服务器向客户端发送“接受”消息。
*   当任何一方希望结束通信时，它会发送一个“断开连接”消息。

握手比 TCP 简单，但似乎足够了。

至于延迟：它要好得多。在同一台机器上使用 POSIX 消息队列而不是 TCP 大约减少了 75% 的延迟。我的消息每条大约 100 个字节。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-05-03T02:44:07.933

我比较了 posix MQ 和一对 TCP/IP 套接字的性能。

演示程序有两个线程，一个用于写入，另一个用于读取。

结果是posix MQ更快，

*   MQ 460000 tps
*   套接字对 400000 tps

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-11-11T09:21:58.807

我遇到过类似的问题，我开发实时应用程序，需要具有类似于套接字功能和最小延迟的 IPC 技术。

您是否仅将基于 POSIX-MQ 的解决方案与 UNIX 本地套接字或 TCP 套接字进行了比较？

谢谢

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-14T22:17:36.517

当 select() 不适用于消息队列时，您是如何做到这一点的？什么是 Sys V 或 POSIX？当 PID 保证是唯一的并且是较小的存储（整数）时，为什么还要花额外的精力来创建 GUID 到 PID 查找表？

/哭泣/

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2013-04-05T10:20:36.260

您也可以在驻留在不同机器上的程序中使用 Message Queues for IPC，在这种情况下您可以使用 ZeroMQ( [http://www.zeromq.org](http://www.zeromq.org) ) 或其他消息队列 API，我也建议您考虑它们并测试他们也是。

# actionscript-3 - 如何在 ActionScript 3 函数中模拟关键字参数

> ID：410062
> 
> 赞同：7
> 
> 时间：2009-01-03T23:03:44.517
> 
> 标签：actionscript-3, arguments, keyword

Python中的函数可以使用keyword = value形式的关键字参数调用。例如，以下函数：

```
def parrot(voltage, state='a stiff', action='voom', type='Norwegian Blue'):
    print "-- This parrot wouldn't", action,
    print "if you put", voltage, "volts through it."
    print "-- Lovely plumage, the", type
    print "-- It's", state, "!" 
```

可以通过以下任何一种方式调用：

```
parrot(1000)
    parrot(action = 'VOOOOOM', voltage = 1000000)
    parrot('a thousand', state = 'pushing up the daisies')
    parrot('a million', 'bereft of life', 'jump') 
```

ActionScript 3 没有此功能。我将如何最好地模仿它？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-01-03T23:47:31.620

如果你搞砸了，它不会在编译时抛出任何错误，但你可以这样做：

```
public function awesomefunction(input:Object):void {
    if (input.foo) trace("got foo");
    if (input.bar) trace("got bar");
} 
```

然后当这样调用它时：

```
awesomefunction( { foo : 23, bar : 99 } ); 
```

{} 括号创建一个内联对象。上面代码的冗长版本可以这样写：

```
var obj:Object = new Object();
obj.foo = 23;
obj.bar = 99;
awesomefunction( obj ); 
```

如果你给它一个数组：

```
awesomefunction( [23, 99 ] ); 
```

（ [] 是数组 btw 的简写）

索引将可以这样访问：

```
public function awesomefunction(input:Object):void {
    if (input[0]) trace("got foo");
    if (input[1]) trace("got bar");
} 
```

因此，要将所有内容结合在一起，您可以使用 || 运算符返回首先评估为 true 的对象的值，而不仅仅是*true*：

```
public function awesomefunction(input:Object):void {
    var foo:int = input.foo || input[0];
    var bar:int = input.bar || input[1];
    if (foo) trace("got foo:", foo);
    if (bar) trace("got bar:", bar);
} 
```

因此，上述函数将为所有这三个调用提供相同的输出：

```
awesomefunction( { foo : 23, bar :55 } );
awesomefunction( { bar : 55, foo : 23 } );
awesomefunction( [ 23, 55 ] ); 
```

但是，这将不允许您混合命名和编号，但您可以这样做：

```
awesomefunction( { foo : 23, 1 : 55 } ); 
```

它不是很漂亮，但它有效！

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-01-06T04:47:19.377

简短的回答是，在 Actionscript 中，参数的顺序是函数签名的一部分。要绕过这个事实，您要么必须做额外的工作，要么沉迷于糟糕的编码实践，这会在以后给您带来麻烦。我会说你有两个“好”的选择来获得类似于你正在寻找的灵活性。正式的方法是定义一个数据类作为函数的参数。那是：

```
public class ComplaintData {
    public var state:String = "a stiff";
    public var action:String = "voom";
    public var type:String = "Norwegian Blue";
    public var voltage:String;

    public function ComplaintData( v:String ) {
        voltage = v;
    }
}

// somewhere else....

function parrot( cd:ComplaintData ) {
    trace "-- This parrot wouldn't " + cd.action;
    // etc.
}

var cd:ComplaintData = new ComplaintData( "a million" );
cd.action = "jump";
parrot( cd ); 
```

如果情况比较特殊，一种不太正式的方法是自由使用可选参数，并允许调用者为他们想要省略的任何非尾随参数传递 null。这为您提供了灵活性，但您牺牲了相当多的清洁度：

```
function parrot( voltage:String, 
                 state:String=null, 
                 action:String=null, 
                 type:String=null)  {
    if (state==null) { state = 'a stiff'; }
    if (action==null) { action = 'voom'; }
    if (type==null) { type = 'Norwegian Blue'; }
    // ....
}
parrot('1000')
parrot('1000000', null, 'jump') 
```

但是，如果这两个选项都显得笨拙，那是因为它们确实如此。从长远来看，我认为最终最好将有序参数列表是 Actionscript 语法的一部分的想法内化，并且您最好不要试图避免它们。这样做要么牺牲简单性（如上所述），要么导致不良实践（如使用非结构化对象作为参数，正如其他答案中所建议的那样，这牺牲了类型和错误检查的许多好处）。

使用语法最平衡的方法是尽可能简单地使用可选参数，因此：

```
function parrot( voltage:String, 
                 state:String='a stiff', 
                 action:String='voom', 
                 type:String='Norwegian Blue')  {
    // ...
}
parrot('1000');
parrot('1000000', 'pushing up the daisies');
parrot('a million', 'bereft of life', 'jump') 
```

您仍然必须接受只能省略尾随参数的事实，但这就是语言的制作方式（以及其本机方法的定义和使用方式）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-04T01:04:55.647

actionscript 3.0 中有一种特殊类型，称为*...(rest)*。将此类型放入函数的参数列表中，然后该函数可以接受任意数量的参数。正确的 sytanx 是：*...arrayName*，其中*arrayName*是将保存参数的数组的名称。

```
公共函数 forYou( ...args ) : void{
   for(var i : int = 0; 我
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-03T23:26:02.757

您可以对[此处](http://www.flex888.com/574/can-i-have-a-variable-number-of-arguments-in-as3.html)显示的函数使用可变数量的参数来实现类似的功能。

# asp.net-mvc - LINQ 匿名类型 + MVC 视图

> ID：410073
> 
> 赞同：6
> 
> 时间：2009-01-03T23:20:16.870
> 
> 标签：asp.net-mvc, linq, anonymous-types, viewdata

我见过很多关于这个的问题，但我从来没有真正得到我需要的答案。

我正在将一个相当大的 Web 应用程序从 Web 窗体转换为 MVC，过了一会儿我遇到了将数据传递到视图的问题。在我执行代码的操作中：

`//This is just an example ViewData["QProducts"] = from p in db.Products select new{Name = p.Name, Date = p.ToShortDateString() } ViewData["QUsers"] = from u in db.Users select u;`

我使用 foreach 循环遍历 html 中的对象，如下所示：

```
foreach(var q in (IEnumerable)ViewData["QEvents"])
{ 
    /*Print the data here*/
} 
```

在使用 MVC 之前我只使用了一个`asp:Repeater`，但由于这是 MVC 我不能使用 ASP.NET 控件。

我应该如何将这些数据传递给视图？我真的没有选择不在这里使用匿名类型。`<%#ViewData.Eval()%>`显然行不通。

有任何想法吗？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-01-04T00:52:59.133

创建一个类型来保存名称和日期，而不是匿名类型：

```
public class NameDate
{
  public string Name { get; set; }
  public DateTime Date { get; set; }
} 
```

然后在您的 Linq 查询中使用它：

```
from p in db.Products select new NameDate { Name = p.Name, Date = p.Date } 
```

强烈键入您的视图`MyView<IEnumerable<NameDate>>`，然后执行`foreach ( var nameDate in ViewData.Model )...`

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-27T21:50:16.767

如果你觉得有点懒，你可以在这里使用这段代码......它有点长，但基本上它是反射的包装......

```
var something = { Name = "Jim", Age = 25 };
AnonymousType type = AnonymousType.Create(something);

//then used...
string name = type.Get<string>("Name");
int age = type.Get<int>("Age", -1 /* optional default value */); 
```

这是代码...

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Reflection;

namespace Code {

    /// <summary>
    /// A convenient method of accessing the values of an 
    /// anonymous type without needing to define a separate class
    /// </summary>
    public class AnonymousType {

        #region Constants

        private const string EXCEPTION_MISSING_PARAMETER_INFORMATION = 
            "Unable to match the parameter '{0}' to a property in the AnonymousType. This could be due to a casting problem or a Property that does not exist.";
        private const string EXCEPTION_COULD_NOT_ACCESS_FIELD =
            "Unable to find a field named '{0}' (of type {1})";
        private const string EXCEPTION_COULD_NOT_ACCESS_FIELD_AT_INDEX =
            "Unable to find a field named '{0}' at the requested index (of type {1})";

        #endregion

        #region Constructors

        /// <summary>
        /// Creates a new AutoType for methods that return Anonymus types
        /// </summary>
        public AnonymousType(object type) {
            this._Init(type, false);
        }

        /// <summary>
        /// Creates a new AutoType for methods that return Anonymus types and
        /// detetrmins if exceptions should be thrown if a type is missing
        /// </summary>
        public AnonymousType(object type, bool supressErrors) {
            this._Init(type, supressErrors);
        }

        /// <summary>
        /// Initalizes the data for the is type
        /// </summary>
        private void _Init(object type, bool supressErrors) {
            this.SupressExceptions = supressErrors;
            this.m_Type = type.GetType();
            this.m_TypeData = type; 
        }

        #endregion

        #region Static Routines

        /// <summary>
        /// Creates a new Anonymous Type from the provided object data
        /// </summary>
        public static AnonymousType Create(object data) {
            return new AnonymousType(data);
        }

        /// <summary>
        /// Creates a new Anonymous Type from the provided object data
        /// </summary>
        public static AnonymousType Create(object data, bool supressErrors) {
            return new AnonymousType(data, supressErrors);
        }

        #endregion

        #region Private Members

        /// <summary>
        /// The type that will be accessed via reflection
        /// </summary>
        private Type m_Type;

        /// <summary>
        /// The actual typs that is being used
        /// </summary>
        private object m_TypeData;

        #endregion

        #region Properties

        /// <summary>
        /// Determines if errors should be thrown if any casting errors take place
        /// </summary>
        public bool SupressExceptions { get; set; }

        /// <summary>
        /// Accessess a property by name and returns an object
        /// </summary>
        public object this[string property] {
            get {
                return this.Get<object>(property);
            }
        }

        #endregion

        #region Public Methods

        /// <summary>
        /// Checks if this Anonymous Type has the specified property
        /// </summary>
        public bool Has(string property) {
            return ((m_Type.GetProperty(property) as PropertyInfo) != null);
        }

        /// <summary>
        /// Returns if this Anonymous type has the specified property and that
        /// the value matches the type specified
        /// </summary>
        public bool Has(string property, Type isType) {

            //try and get the property
            PropertyInfo prop = m_Type.GetProperty(property) as PropertyInfo;

            //If this type doesn't exist at all, just return false
            if (prop == null) { return false; }

            //if it does exist, verify the type
            if (prop.PropertyType.Equals(isType)) { return true; }
            return false;

        }

        /// <summary>
        /// Returns a type value using the specified type
        /// </summary>
        public T Get<T>(string property) {

            //return this value if needed            
            PropertyInfo prop = m_Type.GetProperty(property) as PropertyInfo;
            try {
                return (T)prop.GetValue(this.m_TypeData, null);
            }
            catch (Exception ex) {
                if (this.SupressExceptions) { return default(T); }
                throw new Exception(
                    string.Format(EXCEPTION_COULD_NOT_ACCESS_FIELD, property, typeof(T).Name),
                    ex
                    );
            }
        }

        /// <summary>
        /// Returns a type value using the specified type
        /// </summary>
        public T Get<T>(string property, object[] index) {

            //return this value if needed
            PropertyInfo prop = m_Type.GetProperty(property) as PropertyInfo;
            try {
                return (T)prop.GetValue(this.m_TypeData, index);
            }
            catch (Exception ex) {
                if (this.SupressExceptions) { return default(T); }
                throw new Exception(
                    string.Format(EXCEPTION_COULD_NOT_ACCESS_FIELD_AT_INDEX, property, typeof(T).Name),
                    ex
                    );
            }
        }

        /// <summary>
        /// Returns a type value using the specified type but includes a default value
        /// if one it missing
        /// </summary>
        public T Get<T>(string property, T defaultValue) {
            //return this value if needed
            PropertyInfo prop = m_Type.GetProperty(property) as PropertyInfo;
            if (prop == null) { return defaultValue; }
            try {
                return (T)prop.GetValue(this.m_TypeData, null);
            }
            catch (Exception ex) {
                if (this.SupressExceptions) { return defaultValue; }
                throw new Exception(
                    string.Format(EXCEPTION_COULD_NOT_ACCESS_FIELD, prop, typeof(T).Name),
                    ex
                    );
            }

        }

        /// <summary>
        /// Accepts a delegate that will use the names of the passed in
        /// parameters as properties to map to. If the property does not
        /// exist, then the method will fail.
        /// </summary>
        public void Use<T1>(Action<T1> with) {

            //set a default for each of the params
            T1 param1 = default(T1);

            //get the parameters for this method
            var paramList = with.Method.GetParameters();

            //update each of the parameters            
            string paramName = string.Empty;
            try {
                for (int i = 0; i < paramList.Length; i++) {

                    //find the correct matching property for this parameter
                    paramName = paramList[i].Name;
                    switch (i + 1) {
                        case 1:
                            param1 = this.Get<T1>(paramName);
                            break;
                    }
                }

            }
            catch (Exception ex) {
                throw new ArgumentException(
                    string.Format(EXCEPTION_MISSING_PARAMETER_INFORMATION, paramName),
                    ex
                    );
            }

            //otherwise, execute the method provided
            with(param1);

        }

        /// <summary>
        /// Accepts a delegate that will use the names of the passed in
        /// parameters as properties to map to. If the property does not
        /// exist, then the method will fail.
        /// </summary>
        public void Use<T1, T2>(Action<T1, T2> with) {

            //set a default for each of the params
            T1 param1 = default(T1);
            T2 param2 = default(T2);

            //get the parameters for this method
            var paramList = with.Method.GetParameters();

            //update each of the parameters            
            string paramName = string.Empty;
            try {
                for (int i = 0; i < paramList.Length; i++) {

                    //find the correct matching property for this parameter
                    paramName = paramList[i].Name;
                    switch (i + 1) {
                        case 1:
                            param1 = this.Get<T1>(paramName);
                            break;

                        case 2:
                            param2 = this.Get<T2>(paramName);
                            break;
                    }
                }

            }
            catch (Exception ex) {
                throw new ArgumentException(
                    string.Format(EXCEPTION_MISSING_PARAMETER_INFORMATION, paramName),
                    ex
                    );
            }

            //otherwise, execute the method provided
            with(param1, param2);

        }

        /// <summary>
        /// Accepts a delegate that will use the names of the passed in
        /// parameters as properties to map to. If the property does not
        /// exist, then the method will fail.
        /// </summary>
        public void Use<T1, T2, T3>(Action<T1, T2, T3> with) {

            //set a default for each of the params
            T1 param1 = default(T1);
            T2 param2 = default(T2);
            T3 param3 = default(T3);

            //get the parameters for this method
            var paramList = with.Method.GetParameters();

            //update each of the parameters            
            string paramName = string.Empty;
            try {
                for (int i = 0; i < paramList.Length; i++) {

                    //find the correct matching property for this parameter
                    paramName = paramList[i].Name;
                    switch (i + 1) {
                        case 1:
                            param1 = this.Get<T1>(paramName);
                            break;

                        case 2:
                            param2 = this.Get<T2>(paramName);
                            break;

                        case 3:
                            param3 = this.Get<T3>(paramName);
                            break;
                    }
                }

            }
            catch (Exception ex) {
                throw new ArgumentException(
                    string.Format(EXCEPTION_MISSING_PARAMETER_INFORMATION, paramName),
                    ex
                    );
            }

            //otherwise, execute the method provided
            with(param1, param2, param3);

        }

        /// <summary>
        /// Accepts a delegate that will use the names of the passed in
        /// parameters as properties to map to. If the property does not
        /// exist, then the method will fail.
        /// </summary>
        public void Use<T1, T2, T3, T4>(Action<T1, T2, T3, T4> with) {

            //set a default for each of the params
            T1 param1 = default(T1);
            T2 param2 = default(T2);
            T3 param3 = default(T3);
            T4 param4 = default(T4);

            //get the parameters for this method
            var paramList = with.Method.GetParameters();

            //update each of the parameters            
            string paramName = string.Empty;
            try {
                for (int i = 0; i < paramList.Length; i++) {

                    //find the correct matching property for this parameter
                    paramName = paramList[i].Name;
                    switch (i + 1) {
                        case 1:
                            param1 = this.Get<T1>(paramName);
                            break;

                        case 2:
                            param2 = this.Get<T2>(paramName);
                            break;

                        case 3:
                            param3 = this.Get<T3>(paramName);
                            break;

                        case 4:
                            param4 = this.Get<T4>(paramName);
                            break;
                    }
                }

            }
            catch (Exception ex) {
                throw new ArgumentException(
                    string.Format(EXCEPTION_MISSING_PARAMETER_INFORMATION, paramName),
                    ex
                    );
            }

            //otherwise, execute the method provided
            with(param1, param2, param3, param4);

        }

        #endregion

        #region Working With Arrays

        /// <summary>
        /// Returns the specified property as an array of AnonymousTypes
        /// </summary>
        public AnonymousType[] AsArray(string property) {
            object[] values = this.Get<object[]>(property);
            return values.Select(o => {
                if (o is AnonymousType) { return (AnonymousType)o; }
                return new AnonymousType(o);
            }).ToArray();
        }

        /// <summary>
        /// Performs the specified action on each value in an array of AnonymousTypes
        /// </summary>
        public void WithEach(string property, Action<AnonymousType> action) {
            foreach (AnonymousType value in this.AsArray(property)) {
                action(value);
            }
        }

        #endregion

        #region Static Methods

        /// <summary>
        /// Returns the type of data for the provided object
        /// </summary>
        public static T Get<T>(object data, string property) {
            return new AnonymousType(data).Get<T>(property);
        }

        /// <summary>
        /// Returns the type of data for the provided object
        /// </summary>
        public static T Get<T>(object data, string property, T defaultValue) {
            return new AnonymousType(data).Get<T>(property, defaultValue);
        }

        /// <summary>
        /// Returns the type of data for the provided object
        /// </summary>
        public static AnonymousType[] AsArray(object data, string property) {
            return new AnonymousType(data).AsArray(property);
        }

        /// <summary>
        /// Performs the following action on each of the values in the specified
        /// property value for a user
        /// </summary>
        public static void WithEach(object data, string property, Action<AnonymousType> action) {
            new AnonymousType(data).WithEach(property, action);
        }

        #endregion

    }
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-04T00:14:53.720

考虑显式转换为列表并转换 ViewData：

```
ViewData["QUsers"] = (from u in db.Users select u).ToList();

foreach(Users u in (List<Users>)ViewData["QUsers"]){ 

    /*Print the data here*/

} 
```

您可以通过几种方式传递数据，使用上面的 ViewData 或 TempData 在 Action 之间传递。您还可以使用 ViewData.Model 来包含强类型模型。请注意，您必须将视图的定义更改为类似

```
ViewPage<User> 
```

至于一个不错的中继器替换尝试[http://www.codeplex.com/MVCContrib](http://www.codeplex.com/MVCContrib)。他们有一个 Grid Html Helper 可能会有所帮助。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-27T21:34:51.080

如果你想避免创建一个单独的类来显示你的一个投影，你也可以求助于使用字典，如下所示：

```
from person in personList select new Dictionary<string, string>
{ 
    { "Name", person.Firstname + " " + person.Lastname },
    { "Id", person.Id.ToString() }
}; 
```

然后，您可以输入您的 viewpage 到

```
ViewPage<IEnumerable<Dictionary<string, string>>> 
```

最后迭代视图中的列表，如下所示：

```
<% foreach (Dictionary<string, string> p in (IEnumerable)ViewData.Model) 
{ %>
   <li> <%=p["Id"] %> - <%= p["Name"] %> </li>
<% } %> 
```

不用说，缺点是您的代码现在充满了“魔术字符串”，由于缺少编译时检查，因此更容易出错。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2010-10-27T13:17:55.373

你不能只使用 MVC 中的 RouteValueDictionary 吗？

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-11-20T07:52:30.373

我怀疑您正在寻找的是 ViewModel：http: [//msdn.microsoft.com/en-us/vs2010trainingcourse_aspnetmvc3fundamentals_topic7.aspx](http://msdn.microsoft.com/en-us/vs2010trainingcourse_aspnetmvc3fundamentals_topic7.aspx)

# security - 有什么理由不使用 OpenID？

> ID：410085
> 
> 赞同：57
> 
> 时间：2009-01-03T23:32:59.387
> 
> 标签：security, web-applications, openid

您会看到很多关于 OpenID 的信息（无论如何，在 Geek 社区中）。这似乎是个好主意。我正在开发一个网站，该网站将针对不那么极客的受众（但也不完全是妈妈和流行音乐），所以我不得不怀疑 OpenID 对某些受众来说是否“太难”了。

你怎么看？除此之外，还有其他不使用 OpenID 的技术或非技术原因吗？

* * *

## 回答 #1

> 赞同：70
> 
> 时间：2009-03-01T15:52:32.610

说一般人不懂 OpenID 可能有点不准确。

在大多数情况下，通过一些有说服力的营销（即“在所有站点上使用一个登录名！！！11！）他们可以理解它允许他们使用一个登录名登录站点，而不是在站点上使用一堆不同的用户名和密码。不同的网站。

然而，问题在于，对于普通用户而言，整个 OpenID 体验与他们认为的在线安全背道而驰。

*   **用户不会自动信任它**

    通过正常的用户名/密码登录，用户明白密码应该保密，这就是在他们登录网站时保护他们的隐私的方法。他们如何理解 OpenID 客户端站点和他们的 OpenID 提供者之间进行的交换？他们所知道的是他们不必输入密码（假设他们在他们的 OpenID 提供商处“始终登录”） - 所以它不安全，对吧？我的意思是，在用户的眼中，如果他们不提供密码，怎么能安全呢？这可能导致用户不信任。

*   **它使网络钓鱼变得容易**

    （许多）用户知道为不同的帐户重复使用相同的密码是错误的，但这似乎正是 OpenID 正在做的事情。如果用户只是假设他们所有的 OpenID 提供商正在与所有参与的站点共享他们的密码怎么办？我的意思是，OpenID 还能如何在所有这些网站上“为他们登录”？如果用户假设通过 OpenID，所有参与的 OpenID 站点都知道他们的密码，他们可能会认为向任何这些站点提供此密码是非常合理的。这是网络钓鱼的噩梦。想象一下将这句话放在您的网站上：“请输入您的（某些 OpenID 提供商）用户名 [ ] 和密码 [ ]”。你已经在钓鱼了。

    我们也不能忘记，即使出于稍微不同的原因，用户在某一方面的怀疑也是*正确*的：如果有人获得了他们的 OpenID 提供者的访问权限，他们就可以在他们使用过的所有站点上访问他们的身份。身份，这与在多个站点使用相同密码的缺点相同。

*   **与用户理解的偏差太大**

    在不同站点拥有多个用户名/密码对于用户来说并不难理解。用户很了解用户名和密码的概念，因为他们已经习惯了，而且安全性（密码是秘密的事实）对他们来说非常明显。密码的工作原理非常清楚。拥有多个用户名和密码组合不会使这变得更加混乱或复杂 - 它只是同一件事，但不止一个。虽然记住多个密码可能很困难，但用户至少知道*如何*做到这一点，以及它是如何工作的。

    OpenID 试图解决记住多个密码的问题，但在此过程中，它创建了一种全新的范式，对用户完全不透明。与密码的安全性是显而易见的（它必须是秘密的）不同，OpenID 的所有安全性都在幕后进行，站点相互通信、密钥和哈希等。用户不再完全了解他们的隐私受到保护或对谁保密，因为他们不了解系统是如何工作的。因此，为了解决记住多个密码的问题，OpenID 创建了一个神秘的密钥交换系统，这违反了用户对身份验证如何工作以及为什么它是安全的整体理解。

* * *

## 回答 #2

> 赞同：44
> 
> 时间：2009-01-04T00:10:30.000

普通用户仍然不了解 OpenId 是什么，它的用途，或者如何使用它。例如，我的父母将无法登录 Stack Overflow。

话虽这么说，这主要是关于用户界面。没有什么本质上阻止他们使用 OpenId - 他们只需要一个从他们那里抽象出 OpenId 的用户界面，并让他们使用他们的 Google 帐户登录（例如）。

* * *

## 回答 #3

> 赞同：19
> 
> 时间：2009-01-04T18:19:41.517

OpenID 非常容易受到网络钓鱼的攻击。如果您运行 OpenID 站点，请尝试在一天内更改登录页面以请求标识符**和**密码，而不是仅请求标识符并重定向到 OpenID 提供程序以请求用户密码的正常方法。我敢打赌，您可以通过这种方式获得超过四分之一的用户密码。

* * *

## 回答 #4

> 赞同：12
> 
> 时间：2009-01-03T23:37:44.993

是的安全。使用 OpenId 会让您任由他们管理他们的帐户。您无法控制密码安全性和用户 ID。您信任某个其他组织来验证访问您网站的人是否是他们所说的人。如果您需要真正验证某人是否是他们所说的人。如果不自己进行某种二次验证，您将无法通过 open id 获得该信息。在这种情况下，您最好不要使用 OpenId。

[http://www.computerworld.com/s/article/9179224/Researchers_Password_crack_could_affect_millions](http://www.computerworld.com/s/article/9179224/Researchers_Password_crack_could_affect_millions)

* * *

## 回答 #5

> 赞同：9
> 
> 时间：2009-03-01T16:07:50.233

这经常出现。

一个好的规则：

> 如果您需要收集和保留私人的个人身份信息，请不要使用 OpenID。
> 
> 如果您不需要收集和保留私人的个人身份信息，请继续提供 OpenID 作为登录方法。

对于电子商务或其他任何需要遵守 PCI/DSS 认证的地方，我不会使用 OpenID。

我不介意 SO 完全是 OpenID，但是我不会创建一个专门使用它的网站。

* * *

## 回答 #6

> 赞同：6
> 
> 时间：2009-09-30T18:03:38.753

1.  界面很糟糕。

    一种。使用 OpenID 注册需要更多​​时间和技巧。正常注册需要很少的时间或精明。注册只进行*一次，*但这是一笔巨大的前期投资，因此该网站必须*非常*引人注目。

    湾。登录涉及：三条数据而不是两条；两个网页而不是一个（实际上是 StackOverflow 的三个）；和一个外部网站。每次。

    C。这种解决方案有更好的接口。例如，我使用 KeePass。

2.  名称冲突。没有办法确保名称的唯一性。

3.  安全是可怕的。

    一种。它鼓励类似网络钓鱼的行为。它不像“Visa验证”那么糟糕，但它已经接近了。

    湾。单点故障：如果你失去*任何东西，*你就会失去*一切。*KeePass 至少允许我对密码进行物理保护（您必须拥有带有加密数据库的硬盘驱动器）。

    C。跨站点跟踪。信用卡公司实际上已经制定了规则来管理他们允许进行多少跟踪。在现代浏览器中可以选择性地禁用或阻止 Cookie。OpenID 没有规则，也没有管理者。

4.  它实际上不是通用的。谷歌提供 OpenID ......但不*使用*它们。雅虎也一样。对于美国在线。OpenID 提供者没有动机允许使用来自其他提供者的 OpenID。

5.  OpenID 可用于身份验证，但不适用于*授权，*特别是对于任何敏感的事物（例如信用卡）。

就我个人而言，我为每个站点使用一个登录名/密码，并使用 KeePass（我可以对其进行物理保护，并使用必须破解的两层密码）来维护一次登录无处不在的抽象。

这包括 StackOverflow：我*专门为你们创建了一个 OpenID，*我永远不会在其他任何地方使用它。我这样做了，我*忍受了*登录的痛苦，因为内容很吸引人。

但是，如果曾经为 StackOverflow 提供了一个*真正的*身份验证方法，我会立即跳上它，只是为了便于使用。

* * *

## 回答 #7

> 赞同：5
> 
> 时间：2009-01-05T08:07:31.487

OpenID 仍然与其他所有基于密码的身份验证方法一样不安全。事实上，更糟糕的是，如果有人获得了您的 OpenID 的访问权限，他们现在拥有的不仅仅是一个帐户。当然也有网络钓鱼攻击，但我们都是精明的程序员、数据库和系统管理员，所以我们不会上当，对吧？

身份验证安全性基于信任。正如其他人指出的那样，您为什么要信任第三方来获取潜在的敏感信息？当然，您可以自己设置 OpenID 服务器，但这与在多个系统上维护单独的密码相比有多少麻烦？当然，您可以创建长且充满非字母数字字符的安全密码，甚至将它们全部存储在密码管理器中（我这样做），但有些网站存在缺陷，因为可以填写简单的密码恢复表格以获得访问以重置密码。

如果 OpenID 确实保护了基于私钥的身份验证（如 SSH 或 PGP），我可能会倾向于支持甚至宣传它。也许这是提供这种方法的提供商的问题 - 我还没有调查过它。

最后，虽然我们都足够信任 OpenID 以使用它在 Stack Overflow 上进行身份验证，但我的 OpenID 是一个“一次性”，它不像我将它用作专业声誉建设工具（即，我的真实姓名不参与其中;-))。我敢肯定我不是唯一一个（就像这个网站一样酷和棒！）。

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2009-01-03T23:38:12.357

如果所有站点都使用 OpenID，它就很好。但是注册 OpenID 只是为了使用一个站点，这有点过分了。注册到 OpenID 不像直接在站点中注册（从消费者的角度来看）那么简单。

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2010-01-02T13:27:07.713

阅读这个主题对我来说很有趣，它完全反映了我对 OpenID 的体验：

StackOverflow.com 是我获得 OpenID 的原因。
许多谷歌搜索把我带到了这个网站，我永远无法发表评论。
想了很多次注册，但是因为OpenID没有注册。我不清楚它到底是什么。
但是有一天，我决定注册并花了我一段时间，但我不后悔，因为我每天都在使用它。它给了我一种更安全的感觉，尽管我知道它只是一个帐户，如果它被网络钓鱼会导致很多问题。

所以对我来说，OpenID 是一种在我不知道的网站上快速登录的好方法，但也可以在 StackOverflow.com 等更大的网站上
登录OpenID实际上是。

* * *

## 回答 #10

> 赞同：3
> 
> 时间：2010-11-17T21:27:54.947

我今天看到一篇文章，这篇文章为跳过 OpenID 提供了一个非常有力的理由，这篇文章最初是对它充满热情的人。

> **开放 ID 是一场噩梦**
> 
> 我一直是 Open ID 的主要支持者。我喜欢这个想法和意图——它是解决长期存在的问题的一个很好的解决方案，并为开发人员解决了很多问题。不幸的是，它为企业主创造了更多。

在此处阅读其余内容：[http ://www.wekeroad.com/2010/11/17/open-id-is-a-party-that-happened/](http://www.wekeroad.com/2010/11/17/open-id-is-a-party-that-happened/)

这不是我的故事，所以我不认为它有任何功劳。

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2009-01-04T17:37:25.783

它可以作为正常注册的补充，但如果它是登录您网站的唯一方式，则使用起来并不容易。查看在 stackoverflow 上的注册 - 特别提到了所有网站，以帮助人们了解这一切。这个网站是为极客准备的 :) 所以缺点是复杂性。

另请参阅[此链接](http://www.shoemoney.com/2007/02/20/11-reasons-why-openid-rockssucks/)

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2009-03-01T16:03:14.737

如果您有一个需要高级别安全性的站点，您不希望将您的登录凭据的处理留给您无法控制访问的外部提供商。如果 OpenID 提供商遭到黑客攻击，您将把安全留给他们。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2009-01-03T23:41:26.187

使用 OpenID 时，每个人都可以将我在一个站点上所做的事情与我在其他站点上所做的事情联系起来，因为它在任何地方都是一样的。因此，例如，我不会使用我在这里用于色情网站的相同 ID。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2009-01-03T23:42:38.400

有很多原因就是一个帐户可以访问所有人。如果这受到损害，您就会遇到麻烦。

如果您正在设置一个使用 openid 的页面，那么您应该知道每个人都可以设置一个 openid 服务器（垃圾邮件发送者也可以这样做）。

--

但是 openid 有很好的想法，我喜欢使用它！

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2009-01-09T05:54:27.493

我很惊讶使用 Stack Overflow 的人想不出不使用 OpenId 的理由——因为它很烦人？！

[Ted Dziuba 在翻录 OpenId](http://teddziuba.com/2008/09/openid-is-why-i-hate-the-inter.html)方面做得比我好得多，所以请阅读他所写的内容。

另一个很好的理由[——Facebook Connect](http://developers.facebook.com/connect.php)似乎已经做得很好了。随着 Facebook 会员人数的不断增长，这将使 Facebook Connect 支持变得更有价值。

在某些时候，我认为 Facebook 可以让 Connect 成为 OpenId 提供商……但实际上，他们为什么要这样做？

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2009-09-27T02:54:36.830

据我所知，OpenID 提供商似乎不需要提供帐户持有人的电子邮件地址，尽管有些人会这样做。

如果您的服务需要一个电子邮件地址来与它的用户交流（例如，发送新闻通讯 - 许多从未听说过 RSS 的人更喜欢这种方式），那么您可能需要捕获一个 OpenID 并验证一个电子邮件地址。

只需要电子邮件地址和密码并使用激活电子邮件消息的系统对用户来说工作量较小。

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2010-04-12T13:34:23.220

您拥有的 OpenID 帐户提供商（google、yahoo、twitter 等）的数量等于您可以自动用于登录 OpenID 支持的网站的帐户数量。这当然不是一个优势，但它可能是一个很大的劣势。

# c# - C#如何将数组中的前一项附加到数组中的下一项以获取未知数量的项？

> ID：410089
> 
> 赞同：0
> 
> 时间：2009-01-03T23:37:10.517
> 
> 标签：c#, arrays

对于未知数量的项目，如何将数组中的前一项附加到数组中的下一项？

这就是我想要做的。我有一个包含 LDAP 路径的字符串，例如“OU=3,OU=2,OU=1,DC=Internal,DC=Net”，我想在上面的 LDAP 路径中创建每个容器，所以我需要上面的字符串创建一个包含以下内容的数组，以便我可以创建每个容器。需要先创建第一个数组项，然后才能创建第二个等。

“OU=1，DC=内部，DC=网络”

"OU=2,OU=1,DC=内部,DC=Net"

"OU=3,OU=2,OU=1,DC=内部,DC=Net"

我的字符串示例只是一个示例，因此路径可能更长或更短，并且可能包含 1 个数组项或 10+ 我只是不知道所以我不知道有多少数组项需要循环遍历它们所以我有数组中的所有路径。

另一个例子：

从“OU=Test4,OU=Number3,OU=Item2,OU=1,DC=Internal,DC=Net”我需要：

"OU=1,DC=Internal,DC=Net" "OU=Item2,OU=1,DC=Internal,DC=Net" "OU=Number3,OU=Item2,OU=1,DC=Internal,DC=Net " "OU=Test4,OU=Number3,OU=Item2,OU=1,DC=Internal,DC=Net"

感谢您对此的帮助。

Ĵ

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-04T00:01:12.247

我不确定我是否理解正确。你需要这样的东西：

```
string input = "OU=3,OU=2,OU=1,DC=Internal,DC=Net";
string[] split = input.Split(',');

string path = "";
for (int i=split.Length-1; i>=0; i--)
{
    path = ((path == "") ? split[i] : split[i] + "," + path);
    if (path.StartsWith("OU"))
        DoSomething(path);
} 
```

对于以下字符串，这将调用 DoSomething() 三次：

*   OU=1,DC=内部,DC=Net
*   OU=2,OU=1,DC=内部,DC=Net
*   OU=3,OU=2,OU=1,DC=内部,DC=Net

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-03T23:58:35.607

如果字符串总是以“,DC=Internal,DC=Net”结尾，那么下面的解决方案应该可以帮助您。

```
static string[] Split(string path)
{
    const string postfix = ",DC=Internal,DC=Net";
    string shortPath = path.Substring(0, path.Length - postfix.Length);
    return shortPath.Split(',').Select(x => x + postfix).ToArray();
} 
```

编辑2.0解决方案

```
static string[] Split(string path)
{
    const string postfix = ",DC=Internal,DC=Net";
    string shortPath = path.Substring(0, path.Length - postfix.Length);
    string[] items = shortPath.Split(',');
    List<string> final = new List<string>();
    foreach ( string item in items ) { 
      final.Add(item + postfix);
    }
    return final.ToArray();

} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-04T00:01:18.147

下面是代码示例（假设您有 .NET 3.5）：

```
// First we need to split up the initial string
string[] items = initialString.Split("'");

// Then we filter it so that we have a list of OU and non-OU items
string[] ouItems = items.Where(s=>s.StartsWith("OU=")).ToArray();
string[] nonOuItems = items.Where(s=>!s.StartsWith("OU=")).ToArray();

List<string> mainList = new List<string>();

// Our main loop
for (int i = 0; i < ouItems.Length; i++)
{
    List<string> localList = new List<string>();

    // We loop through all the previous items including the current one
    for (int j = 0; j <= i; j++)
    {
        localList.Add(ouItems[i]);
    }
    // Then we add all of the non-OU items
    localList.AddRange(nonOuItems);

    // Then we build the string itself
    bool first = true;
    StringBuilder sb = new StringBuilder();
    foreach (string s in localList)
    {
        if (first) first = false;
        else sb.Append (","); // Separating the items with commas
        sb.Append(s);
    }
    mainList.Add(sb.ToString());
}

// Now we only have to convert it back to an array
string[] finalArray = mainList.ToArray(); 
```

即使您没有 .NET 3.5，将其移植回 .NET 2.0 也应该非常简单。另外，我还没有对此进行测试，因此可能存在错误或拼写错误。此外，这绝对不是最有效的方法，但我认为这很明显并且可能会起作用。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-04T00:08:18.460

这应该以正确的顺序为您提供一个数组，因为它是一个实际的控制台应用程序，所以要长一点：

```
using System;
using System.Text;

namespace Splitomatic
{
    public class Program
    {
        /// <summary>
        /// Sample Input: 
        ///    arg[0]: OU=Test4,OU=Number3,OU=Item2,OU=1
        ///    arg[1]: DC=Internal,DC=Net
        /// </summary>
        /// <param name="args"></param>
        public static void Main(string[] args)
        {
            StringBuilder builder;
            string[] containers;
            string[] parts;

            if (args.Length != 2)
            {
                Console.WriteLine("Usage: <exe> <containers> <append");
            }

            builder = new StringBuilder(args[1]);
            parts = args[0].Split(',');
            containers = new string[parts.Length];

            for (int i = parts.Length - 1; i >= 0; --i)
            {
                builder.Insert(0, ",");
                builder.Insert(0, parts[i]);
                containers[Math.Abs(i - parts.Length + 1)] = builder.ToString();
            }

            Console.WriteLine("Dumping containers[]:");
            for (int i = 0; i < containers.Length; ++i)
            {
                Console.WriteLine("containers[{0}]: {1}", i, containers[i]);
            }

            Console.WriteLine("Press enter to quit");
            Console.ReadLine();
        }
    }
} 
```

样本输出：

```
倾倒容器[]：
容器[0]：OU=1，DC=内部，DC=Net
容器[1]：OU=Item2,OU=1,DC=Internal,DC=Net
容器[2]：OU=Number3,OU=Item2,OU=1,DC=Internal,DC=Net
容器[3]：OU=Test4,OU=Number3,OU=Item2,OU=1,DC=Internal,DC=Net
按回车退出

```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-04T00:09:05.790

一种方法。这也将为每个 DC 创建一个字符串。

```
string[] GetArray(string input)
{
    string[] vals = input.Split(',');

    List<string> entries = new List<string>();

    string s;
    for(int i=vals.Length - 1; i > 0; i--)
    {
        s = vals[i];

        if(i < vals.Length - 1)
           s += "," +  entries[(vals.Length - 2) - i];

        entries.Add(s);
    }

   return entries.ToArray();
} 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-04T00:20:30.557

我的代码几乎就像 Martin 的代码，但他的代码在所有路径对象的末尾输出一个逗号。

这是正确的功能：

```
static string[] SplitLDAPPath(string input)
{
    List<String> r = new List<string>();
    string[] split = input.Split(',');

    string path = "";
    for (int i = split.Length - 1; i >= 0; i--)
    {
        path = split[i] + "," + path;
        if (path.StartsWith("OU"))
            r.Add(path.Substring(0, path.Length-1));
    }
    return r.ToArray();
} 
```

使用：

```
 String s = "OU=Test4,OU=Number3,OU=Item2,OU=1,DC=Internal,DC=Net";
    String[] r = SplitLDAPPath(s);

    foreach (String ss in r)
        lt.Text += ss + "<br/>"; 
```

输出：

```
OU=1,DC=Internal,DC=Net
OU=Item2,OU=1,DC=Internal,DC=Net
OU=Number3,OU=Item2,OU=1,DC=Internal,DC=Net
OU=Test4,OU=Number3,OU=Item2,OU=1,DC=Internal,DC=Net 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-01-04T00:27:07.423

如果我正确理解您的问题：

*   用分号拆分字符串，生成 N 个项目
*   方法的结果应该是多个字符串
*   第一个字符串应该是最后一项，用分号分割后
*   下一项应该是最后一项之前的任何内容，分号和最后一项
*   下一项应该是上一项之前的任何内容，分号，然后是上一项

那么实现应该相当简单：

```
public static IEnumerable<String> LastToFirstOrSomething(String s)
{
    String[] parts = s.Split(';');
    String result = String.Empty;
    for (Int32 index = parts.Length - 1; index >= 0; index--)
    {
        if (result.Length > 0)
            result = ";" + result;
        result = parts[index] + result;
        yield return result;
    }
} 
```

当然，这可以通过使用 StringBuilder 在性能方面得到改进。

现在，说了这么多，我知道您的问题与我的回答 100% 不匹配，因为您没有说明为什么不提供第一个 X 元素，您跳过这些。这是为什么？

您需要提供更多信息以获得更好的答案。

# php - PHP 读取 cookie 文件

> ID：410109
> 
> 赞同：10
> 
> 时间：2009-01-03T23:52:43.060
> 
> 标签：php, cookies

是否有任何帮助库来读取 php.ini 中的 cookie 文件。我的本地磁盘上有一个 cookie 文件，我想要一种更好的阅读方式。我目前只是按行读取文件并解析值。

* * *

## 回答 #1

> 赞同：30
> 
> 时间：2011-05-17T00:51:20.810

如果您打算阅读 Netscape 的格式，这非常简单（例如 curl 以这种格式将 cookie 保存在 COOKIEJAR 中）。

首先是一个示例（此处添加了管道和行号，并且不会出现在实际文件中）：

```
01 | # Netscape HTTP Cookie File
02 | # http://curl.haxx.se/rfc/cookie_spec.html
03 | # This file was generated by libcurl! Edit at your own risk.
04 | 
05 | .google.com    TRUE    /   FALSE   1305843382  cookiename  the value
06 | .yahoo.com TRUE    /   FALSE   1305843382  another_cookie  it's value
07 | 
```

如你看到的：

1.  我们可能会将注释行用`#`第一个字符表示。
2.  我们可能有空行

然后，每条粗线都有 7 个标记，用制表符 ( `\t`) 分隔。这些在[这里](http://www.cookiecentral.com/faq/#3.5)定义：

1.  domain - 创建并且可以读取变量的域。
2.  flag - 一个 TRUE/FALSE 值，指示给定域内的所有机器是否都可以访问该变量。此值由浏览器自动设置，具体取决于您为域设置的值。
3.  path - 变量有效的域中的路径。
4.  安全 - 一个 TRUE/FALSE 值，指示是否需要与域的安全连接才能访问变量。
5.  expiration - 变量到期的 UNIX 时间。UNIX 时间定义为自 1970 年 1 月 1 日 00:00:00 GMT 以来的秒数。
6.  name - 变量的名称。
7.  value - 变量的值。

所以，现在让我们制作我们的 cookie 文件解析器。

```
// read the file
$lines = file('path/to/cookies.txt');

// var to hold output
$trows = '';

// iterate over lines
foreach($lines as $line) {

  // we only care for valid cookie def lines
  if($line[0] != '#' && substr_count($line, "\t") == 6) {

    // get tokens in an array
    $tokens = explode("\t", $line);

    // trim the tokens
    $tokens = array_map('trim', $tokens);

    // let's convert the expiration to something readable
    $tokens[4] = date('Y-m-d h:i:s', $tokens[4]);

    // we can do different things with the tokens, here we build a table row
    $trows .= '<tr></td>' . implode('</td><td>', $tokens) . '</td></tr>' . PHP_EOL;

    // another option, make arrays to do things with later,
    // we'd have to define the arrays beforehand to use this
    // $domains[] = $tokens[0];
    // flags[] = $tokens[1];
    // and so on, and so forth

  }

}

// complete table and send output
// not very useful as it is almost like the original data, but then ...
echo '<table>'.PHP_EOL.'<tbody>'.PHP_EOL.$trows.'</tbody>'.PHP_EOL.'</table>'; 
```

最后，[这](http://codepad.org/MxbDs6Xn)是一个演示。

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2014-10-23T04:27:47.680

我找不到适合现在非常流行的**HttpOnly** cookie 记录的代码 - 例如在[http://www.google.com/](http://www.google.com/)中使用的代码。HttpOnly cookie 只能由浏览器读取，并且对所有客户端脚本（如 java 脚本）保持隐藏。[您可以在此处](https://en.wikipedia.org/wiki/HTTP_cookie#Secure_and_HttpOnly)找到有关 HttpOnly cookie 的更多详细信息。

忽略 Netscape cookie 文件中这些 cookie 的格式，将导致解析不正确。这些记录以“#HttpOnly_”字符串为前缀。

我们还应该为几乎所有应用程序“urldecode”参数名称及其值。

以下函数是[Majid Fouladpour](https://stackoverflow.com/users/66580/majid-fouladpour)和[Philip Norton](http://www.hashbangcode.com/blog/netscape-http-cooke-file-parser-php)的示例代码的组合和更新版本，它考虑 HttpOnly cookie 并在数组中返回所有 cookie 及其属性：

```
/**
 * Extract any cookies found from the cookie file. This function expects to get
 * a string containing the contents of the cookie file which it will then
 * attempt to extract and return any cookies found within.
 *
 * @param string $string The contents of the cookie file.
 * 
 * @return array The array of cookies as extracted from the string.
 *
 */
function extractCookies($string) {

    $lines = explode(PHP_EOL, $string);

    foreach ($lines as $line) {

        $cookie = array();

        // detect httponly cookies and remove #HttpOnly prefix
        if (substr($line, 0, 10) == '#HttpOnly_') {
            $line = substr($line, 10);
            $cookie['httponly'] = true;
        } else {
            $cookie['httponly'] = false;
        } 

        // we only care for valid cookie def lines
        if( strlen( $line ) > 0 && $line[0] != '#' && substr_count($line, "\t") == 6) {

            // get tokens in an array
            $tokens = explode("\t", $line);

            // trim the tokens
            $tokens = array_map('trim', $tokens);

            // Extract the data
            $cookie['domain'] = $tokens[0]; // The domain that created AND can read the variable.
            $cookie['flag'] = $tokens[1];   // A TRUE/FALSE value indicating if all machines within a given domain can access the variable. 
            $cookie['path'] = $tokens[2];   // The path within the domain that the variable is valid for.
            $cookie['secure'] = $tokens[3]; // A TRUE/FALSE value indicating if a secure connection with the domain is needed to access the variable.

            $cookie['expiration-epoch'] = $tokens[4];  // The UNIX time that the variable will expire on.   
            $cookie['name'] = urldecode($tokens[5]);   // The name of the variable.
            $cookie['value'] = urldecode($tokens[6]);  // The value of the variable.

            // Convert date to a readable format
            $cookie['expiration'] = date('Y-m-d h:i:s', $tokens[4]);

            // Record the cookie.
            $cookies[] = $cookie;
        }
    }

    return $cookies;
} 
```

这是功能的[演示](http://codepad.org/d1POiPIx)。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2017-11-29T21:28:08.883

该库允许您操作（添加、删除、更新……）Netscape Cookie 文件（例如，由 CURL 生成的 Cookie）：

[https://github.com/kegi/netscape-cookie-file-handler](https://github.com/kegi/netscape-cookie-file-handler)

读取+写入cookie的简单示例：

```
/*Open and parse the cookie file*/

$configuration = (new Configuration())->setCookieDir('cookies/');
$cookieJar = (new CookieFileHandler($configuration))->parseFile('my_cookie_file');

/*Add (and save) a cookie*/

$cookieJar->add(
    (new Cookie())
        ->setHttpOnly(true)
        ->setPath('/foo')
        ->setSecure(true)
        ->setExpire(new DateTime('2020-02-20 20:20:02'))
        ->setName('foo')
        ->setValue('bar')
)->persist(); 
```

PS这个项目很棒，但是我不知道为什么现在它的星星这么低！;-)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-04T00:29:52.440

我认为 $_COOKIE 是你要找的。

这个超全局可以用来读取cookie数据...设置它你需要使用`setcookie()`更多可以在PHP网站上的[$_COOKIE superglobal下找到](http://us3.php.net/manual/en/reserved.variables.cookies.php)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-04T00:30:43.547

我不确定我是否正确理解您，因为[`setcookie`](http://php.net/manual/en/function.setcookie.php)从您的脚本中设置（使用）和读取 PHP 中的 cookie 通常非常简单：

```
$value = $_COOKIE['mycookie']; 
```

如果您正在寻找一种直接从文件系统读取原始 cookie 的方法，而无需通过浏览器，您需要指定它们写入的格式/浏览器。这些值可能已经从许多不同的语言中序列化并且文件的最终结果可能因浏览器而异。

**// 编辑：**

更多关于浏览器差异的信息：例如，Mozilla 有这样的[格式，](http://xiix.wordpress.com/2006/03/23/mozillafirefox-cookie-format/)而 IE则[更像这样](http://seclists.org/basics/2006/Mar/0427.html)。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2017-05-03T13:49:29.107

快速展示方式：

```
 cat sess_qe3qq1164dnggru0m1j7fpbr23 | tr ';' '\n' 
```

* * *

## 回答 #7

> 赞同：-2
> 
> 时间：2009-01-04T23:26:47.607

如果您在 PHP 中使用会话，并且实际上是在尝试解析磁盘上的会话数据，则可以`unserialize()`对该文件的内容使用该函数。

# c# - C#/.Net 相当于 NSNotification

> ID：410111
> 
> 赞同：8
> 
> 时间：2009-01-03T23:54:03.120
> 
> 标签：c#, objective-c, notifications, message-passing

我是一名将应用程序移植到 .Net 世界的 Objective-C 开发人员。在我的 Obj-C 应用程序中，我使用 NSNotification 对象在少数对象之间进行异步通信。有没有办法在 .Net 世界中做类似的事情（更具体地说，使用 C# 语言）？基本方法是一个对象发布一个或多个对象监听的通知。

可能有一种明显的方法可以做到这一点，但我还没有找到它......

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-01-04T00:09:26.443

在 C# 或 VB.NET 中使用委托是等效的语言集成功能。您可以通过定义或使用预定义的 Delegate 来定义可以发布和订阅的“通知”来创建事件。然后在您可以订阅和引发的类上定义一个事件。一旦您在[此处](http://msdn.microsoft.com/en-us/library/edzehd2t.aspx)找到 MSDN 文档，它就有一个很好的概述。一个很好的例子是[here](http://msdn.microsoft.com/en-us/library/9aackb16.aspx)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-08-06T16:17:27.350

您可能将 NSNotification 与 NSNotificationCenter 一起使用，它是[Event Aggregator 模式](http://martinfowler.com/eaaDev/EventAggregator.html)的实现，它[在 Prism 库中实现](http://msdn.microsoft.com/en-us/library/ff921122%28v=pandp.20%29.aspx)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-09-11T12:48:42.680

使用 xcode 的 NSNotification，您可以发布任何类都可以接收的消息，只要您在类中实现了用于监听帖子的 NSNotification 对象......并声明观察者；）

这是您可以尝试的我的理论...在 C# 中，您可以尝试通过构造包含静态事件的静态类来创建自己的通知中心。然后在您的其他类中，您只需创建事件的一个实例。通过这样做，您可以重新创建与 Xcode 的 NSNotificationCenter 相同的行为。

你也试过这个吗？[http://www.codeproject.com/Tips/438582/Csharp-NotificationCenter?msg=4398005#xx4398005xx](http://www.codeproject.com/Tips/438582/Csharp-NotificationCenter?msg=4398005#xx4398005xx)

对不起任何错字！电话回复很尴尬！

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2018-03-04T21:12:14.107

`NotificationCenter`在 Nuget 包管理器中使用库。这个库的工作方式类似于 Objective-C 和 Swift NSNotificationCenter。一种通知分发机制，可以将信息广播给注册的观察者。

```
PM> Install-Package NotificationCenter 
```

GitHub：

[https://github.com/Husseinhj/NotificationCenter](https://github.com/Husseinhj/NotificationCenter)

# linq - win32 DELPHI中的LINQ

> ID：410112
> 
> 赞同：11
> 
> 时间：2009-01-03T23:55:18.983
> 
> 标签：linq, delphi, winapi

是否可以在 win32 DELPHI 应用程序中使用 LINQ

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2009-01-04T00:46:01.520

Delphi 2009支持**泛型**、**类助手**和**匿名方法**，但不支持*lambda*、*扩展方法*或*类型推断*。Lambda 表达式可能会出现在 Delphi 的未来版本中，但它们还没有出现在官方路线图上（希望很快就会出现一个新的）。此外，Delphi for Win32 也无法访问所有 LINQ 库。

所以简短的回答是否定的，你不能在 Win32 Delphi 中做 LINQ。您可以做一些类似的事情，从技术上讲，您甚至可以通过 COM 访问 LINQ（就像您可以使用任何 .NET 类一样），但是如果没有酷炫的 LINQ 语法，它会有点失败。

LINQ 实际上是一种 .NET 技术。虽然 Delphi 很可能会开发使 LINQ 成为可能的语言功能，但底层 .NET 库仅用于 .NET 开发。

我建议使用[RemObject Data Abstract](http://www.remobjects.com/da.aspx)或类似的。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-04T00:03:44.490

Yes and No. LINQ 真的可以被认为是两个不同的项目。

第一个是类似 SQL 的查询语法。它允许您在 C# 中编写以下内容。

```
var query = from it in "foobar" select Char.ToUpper(it); 
```

delphi 要使用此版本的 LINQ，需要添加显式语法支持。AFAIK 这不存在。

但在底层，所有 LINQ 查询都被转换为一组查询表达式。这些通常涉及大量使用 lambda 表达式和闭包。上面的代码等价于下面的非 SQL 语法版本。

```
var query = "foobar".Select(x => Char.ToUpper(x)); 
```

我不知道 Delphi 中 lambda 或委托支持的级别，但应该可以从 Delphi 以这种方法访问 LINQ。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2011-06-26T04:32:46.190

我不知道它出现在哪个版本的 Delphi 中，但在 XE 中我们有“对象函数”，可以作为闭包或接近相等的 lambda 表达式。

因此，从今天（2011 年 6 月 26 日）开始，在 Delphi（第二种形式）中*几乎*可以使用类似 LINQ 的表达式。

# c# - C#如何使用代码检查列表框中的选定项目？

> ID：410113
> 
> 赞同：0
> 
> 时间：2009-01-03T23:56:22.070
> 
> 标签：c#, winforms, listbox

我有一个带有复选框的列表框，如何检查所选项目的复选框？

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-04T00:01:59.063

假设 Windows 窗体，clb.SetItemChecked(clb.SelectedIndex,true) 其中 clb 是 CheckedListBox 对象。

# windows-xp - 降低运行 WinXP 的低负载服务器的功耗？

> ID：410122
> 
> 赞同：-1
> 
> 时间：2009-01-04T00:02:15.087
> 
> 标签：windows-xp

我在我的办公室中使用基于 Windows XP 的四核 Dell Machine 机器作为我正在开发的应用程序的服务器，以及偶尔使用远程桌面连接进行工作。

这台机器通常处于非常轻的负载下，运行一个连接很少的 MySQL 服务器和几个 Java 进程，每隔几分钟就会建立一个数据库连接。

当我登录它或偶尔用户向服务器提交请求时，需要更多的处理能力。

有什么方法可以让它消耗更少的电量，但仍然可以 24x7 继续运行？例如，在我的 Mac Pro 上，我可以（手动）关闭一些我注意到会影响功耗的 CPU。我在 XP 上有哪些选择？

我意识到这不是一个直接的编程问题，但我敢肯定这里有人有一台运行在类似使用配置文件上的计算机。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-04T00:52:05.250

第一步是使用控制面板中的 Power 工具 (powercfg.cpl) 制作自定义配置文件，该配置文件将在合理的空闲期后关闭屏幕、磁盘等。不要让时间太短，否则重新启动设备可能会浪费更多的电量，而不是关闭它所节省的电量；对硬盘尤其重要。

禁用配置中不需要的任何服务（可能还有设备）（例如 Content Indexer、WebClient）。

还要确保您的 BIOS 设置允许您的处理器时钟尽可能慢。一些主板设备驱动程序从 BIOS 中获取它们的设置。关闭任何超频软件并将这些设置重置为“自动”或“默认”。

使用 devmgmt.msc 检查每个设备驱动程序的电源设置。有些驱动程序很笨，不允许控制设备的电源，但大多数 USB 主机/集线器都可以。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-14T19:32:58.923

有一些来自不同制造商的主板提供可在 Windows 中使用的电源管理工具。也许这将是最好的起点。发布有关您的系统规格的更多信息，也许我可以更具体。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-03T21:38:43.230

我知道这篇文章已经晚了，但希望它在未来的某个时候对某人有所帮助......

In response to turning off cores in XP to conserve power, there is a built-in solution from MS. Go to Start, Run and then type msconfig and hit enter. After the system configuration utility window opens, click on the BOOT.INI tab and click the Advanced Options button. You can effectively limit the amount of active cores by checking the box next to "/NUMPROC=" and entering a number in the field to the right. The number that you enter will be the new number of active cores on your processor (after a reboot of course...). Set it to whatever you like and reboot the PC. After the reboot open up task manager and under the Performance tab you should see fewer graphs on the CPU Usage History window (each window represents an active core. check this before you make the initial change and it will show all cores that your system is using. check task manager (after you make the change in msconfig and reboot the PC) again to verify that the change you made in msconfig has taken effect.

Again, I know this is an old post but I figured that someone eventually will come looking at this page and hopefully it will be of some service to them.

# deployment - 您首选的软件版本命名方法是什么？

> ID：410126
> 
> 赞同：10
> 
> 时间：2009-01-04T00:05:03.193
> 
> 标签：deployment, release, release-management

您首选的软件版本命名方法是什么？像 Microsoft：alpha - beta - final - service pack... 像 Google：gmail beta - beta - beta - beta - :) 像一些软件：0.2 - 0.3 - 0.9999 ...

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2009-01-04T00:23:36.570

Major.Minor.Release.Build

虽然发布和构建增量不应包含“重大更改”（例如具有不同的文件格式来存储文档），但我不确定是否允许次要版本。

alpha、beta 后缀的含义对我来说是：

Alpha/Preview：嘿，我有一些我想展示的东西。

Beta：功能集目前已完成，但仍存在一些错误。

发布候选：我认为没有任何（主要）错误。

最后：可能仍然存在错误，但我必须在某个时候发布;-)。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-01-04T00:10:22.307

我们不向客户发布 alpha/beta 软件。因此我们简单地使用：

*   x.0（对于主要版本，包含重要/许多新功能）
*   x.1、x.2 等（用于包含次要新功能和增强功能的次要版本）
*   xy1、xy2 等（用于错误修复/维护版本）

（其中 x,y = 1,2,...）

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-01-04T03:29:48.333

Microsoft 使用版本编号以及 alpha、beta、GA 名称。

我认为版本命名很大程度上取决于您要完成的工作。如果你发布的东西是为了消费，而不是试图从测试期收集数据，不要称之为测试版。如果您不想预览该技术，请不要将其称为 alpha。

我目前主要使用 Web 应用程序，我们只是在部署时将版本编号为递增整数（1、2、3、4、5 等）。如果没有人关心版本，没有理由必须进入复杂的命名逻辑。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-01-04T00:07:44.497

我更喜欢prototype、alpha、beta、GA方法。这使我可以将软件的当前状态传达给用户/客户。除此之外，我还提供版本号 .2、.3、.4。

*   第一个数字代表主要里程碑。
*   第二个数字代表增加发布（我一般每周发布一次，所以我增加第二个数字）。
*   第三位数字用于补丁，因此如果代码中存在在正常发布计划之外修复的错误，我将使用第三位数字。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-05-30T10:53:47.907

一些开源软件项目名称在发布日期之后发布。例如 Ubuntu 8.04 于 2008 年 4 月发布，Ubuntu 6.06 于 2006 年 6 月发布。但 Ubuntu 并不是唯一使用这种方法的 Linux 发行版。

当然，每个 Ubuntu 版本也有一个代号，每次都是不同的动物，加上一个头韵形容词（形容词也可以作为内部人士的可爱速记）。每个版本都按字母顺序排列，因此人们可以轻松记住在稳定流中放置版本的位置。例如：

例如 6.06、dapper drake 6.10、edgy eft 7.04、feisty fawn 7.10、gussy gibbon

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-04T00:42:46.673

对于小型软件，只需 Major.Minor。如果重大更改 - 某些输入文件与以前的版本不兼容。我们不会向客户预发布软件，因此相同版本用于测试和最终发布。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-01-04T16:28:59.557

我们命名发布的方式通常是阶段编号。由于我们的大部分合同都是政府项目，我们将推出第一个版本，然后执行第 2 阶段、第 3 阶段、第 4 阶段，因为实体决定根据新功能请求进行移动（并为上述未来开发获得资金）。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-05-30T11:19:20.053

我更喜欢 Linux 内核符号：major.minor.release.build，但我很少使用 .build 部分，而且我不使用偶数/奇数表示稳定/开发次要。

# linux - Renaming the trash command of trash-cli?

> ID：410127
> 
> 赞同：4
> 
> 时间：2009-01-04T00:07:25.607
> 
> 标签：linux, shell, user-interface, command-line-interface

I'm the developer of the trash-cli project.

The trash-cli project is a opensource implementation of the FreeDesktop.org Trash Specification that provides a command line interface to manage the trashcan.

Ideally trash-cli provides these commands:

*   trash *(trashes files and directories)*
*   trash-empty *(empty the trashcan(s))*
*   trash-list *(list trashed files)*
*   trash-restore *(restore a trashed file)*

But I must rename the 'trash' command because the name is too generic to let the trash-cli added in Fedora (see full discussion [here](https://bugzilla.redhat.com/show_bug.cgi?id=448122))

I chose the 'trash' name because I think is the better name you could use (is short and intuitive), but, as I stated before, I can't use this name.

In any case I think a good choice keep the trash-* form because it exploit the shell TAB completion.

In the beginning I was persuaded to rename the 'trash' command in 'trash-file' but I don't like it very much, and as Christoph Bloch [pointed out](https://bugs.launchpad.net/ubuntu/+source/trash-cli/+bug/310088/comments/3):

> My arguments against "trash-file": * It is not intuitive and therefore unnecessarily difficult to memorise. * It is unnecessarily long. * Every change in the name of programs causes confusion, so the new solution should be a clear improvement (which it isn't). * It is even wrong: Directories can be trashed, too.
> 
> Just "trash" was much better.

I collected some ideas for renamng the 'trash' command. Would you like help me to choose the best one? Do you know a better name?

Here the alternatives (some of them are ugly, I know it, but maybe they help you to find a better name) :

*   trash-put
*   trash-put-in
*   trash-trash
*   trash-throw
*   trash-f
*   trash-rm
*   trash-recycle
*   trash-do
*   trash-to

*   trash-

*   trash-now
*   trash-!
*   trash2
*   trash
*   trashit

*   trash-item

*   trash-entry
*   trash-elem
*   trash-path
*   trash-data

*   trash-this

*   trash-it
*   trash-that

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-01-04T00:26:41.463

Perhaps go the 'UNIX way' and adopt as short a name as possible.

`tf`? - although the objection that it also handles directories remains.

Note that the word 'trash' is perceived in Britain to be an Americanism. I'm not sure about other English speaking countries. Apple clearly didn't care about non-American sensibilities when they named the Trash Can. I guess Red Hat didn't either (or just followed Apple's cue).

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-04T01:06:01.807

Why not have a single command with different arguments for the actions you want?

trash list
trash empty
trash restore {<file>}*

I realize this goes against the UNIX-way in the strictest sense, however, they are all operations on a single object, so I'd make the argument there should be one command for this rather than a group of commands.

* * *

As far as renaming "trash" to something else, really? Wow, I think "trash" is actually pretty intuitive compared to the alternatives. Some alternatives:

*   **trashcan**, or simply **tc**
*   **wastebasket**, or simply **wb**

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-04T00:30:17.510

How about just:

trashcan-put trashcan-*

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-04T13:33:40.550

`trash-put` (for brevity and clarity) or `trash-this` (for ease of typing, as `this` is made up of readily-typed characters -- especially to an OO programmer ;-)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-04T00:14:14.250

Perhaps a different synonym altogether would be better?

*   discard
*   fling
*   toss
*   chuck
*   dispose
*   scrap
*   junk
*   recycle

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-04T15:15:02.387

Thanks to all.

I seems that -put is the preferred one. Also in the distributions@lists.freedesktop.org mailing list I received the positive feedback for this command.

Probably the command names will be:

*   trash-put (put files (or directories) in the trashcan)
*   trash-empty (empty the trashcan(s))
*   trash-list (list trashed files)
*   trash-restore (restore a trashed file)

# c# - 当我在列表框中移动时，为什么我的选中项变为未选中？

> ID：410131
> 
> 赞同：0
> 
> 时间：2009-01-04T00:09:01.733
> 
> 标签：c#, winforms, listbox, checkedlistbox

下面的代码将列表框中的选定项目向下移动到列表框中的下一个项目，但如果选中了它，它将取消选中选定的项目。我怎样才能防止这种情况？

```
private void buttonMoveDown_Click(object sender, EventArgs e)
{
   int iIndex = checkedListBox1.SelectedIndex;
   if (iIndex == -1)
   {
      return;
   }
   moveListboxItem(checkedListBox1,  iIndex, iIndex + 1);
} 
```

谢谢

moveListboxItem 的代码如下：

```
 private void moveListboxItem(CheckedListBox ctl, int fromIndex,int toIndex)
        {
            if(fromIndex == toIndex)
            {
                return;
            }
            if(fromIndex < 0 )
            {
                fromIndex = ctl.SelectedIndex;
            }
            if(toIndex < 0 || toIndex > ctl.Items.Count - 1)
            {
                return;
            }

            object data = ctl.Items[fromIndex];
            ctl.Items.RemoveAt(fromIndex);
            ctl.Items.Insert(toIndex, data);
            ctl.SelectedIndex = toIndex;
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-04T00:18:15.100

您需要发布 moveListBoxItem 的代码，以便我们能够提供帮助。

我怀疑 moveListBoxItem 看起来像这样。

```
void moveListBoxItem(CheckedListBox list, int oldIndex, int newIndex ) {
  object old = list.Items[oldIndex];
  list.Items.RemoveAt(oldIndex);
  list.Items.Insert(newIndex, old);
} 
```

如果是这种情况，它不工作的原因是因为一旦你删除了对象，CheckedListBox 就不再跟踪特定索引的检查状态。您需要稍后重新添加它。

```
void moveListBoxItem(CheckedListBox list, int oldIndex, int newIndex ) {
  var state = list.GetItemCheckedState(oldIndex);
  object old = list.Items[oldIndex];
  list.Items.RemoveAt(oldIndex);
  list.Items.Insert(newIndex, old);
  list.SetItemCheckedState(newIndex, state);
} 
```

编辑：更新实际 moveListBoxItem 代码。您还需要将 CheckState 传播到新索引。从集合中删除它实质上会清除存储的状态。

```
private void moveListboxItem(CheckedListBox ctl, int fromIndex,int toIndex)
        {
            if(fromIndex == toIndex)
            {
                return;
            }
            if(fromIndex < 0 )
            {
                fromIndex = ctl.SelectedIndex;
            }
            if(toIndex < 0 || toIndex > ctl.Items.Count - 1)
            {
                return;
            }

            object data = ctl.Items[fromIndex];
            CheckState state = ctl.GetItemCheckState(fromIndex);
            ctl.Items.RemoveAt(fromIndex);
            ctl.Items.Insert(toIndex, data);
            ctl.SetItemCheckState(toIndex, state);
            ctl.SelectedIndex = toIndex;
} 
```

# image - 如何创建矢量图形，然后从中生成图标？

> ID：410141
> 
> 赞同：4
> 
> 时间：2009-01-04T00:17:47.533
> 
> 标签：image, icons, vector-graphics

对于我正在开发的网站，我需要创建一些图形。我还没有锁定尺寸，所以我不想直接生成图像文件（PNG、GIF、JPG），以防在我进一步了解布局和 UI 后改变主意，看看哪些有效，哪些无效.

这让我想到：也许我应该将它们生成为矢量图形（例如 SVG），然后生成一组图像文件以在我的站点上使用。我以前从未玩过矢量图形，所以我追求的是：

*   一些工具以某种可接受的格式创建（最好是图形化的）一些矢量图形；
*   一种创建矢量图形的程序化方式。例如，假设我有一个网格，我不一定要手动绘制它。“对齐网格”和类似功能将涵盖这种情况，但不包括其他情况；和
*   我可以通过某种方式以编程方式（例如作为构建任务）获取一组矢量图形并生成一组图像，并且最好对命名约定、输出格式、大小等内容进行一些控制（例如从命令行）。我不想进入程序并单独对 100 多个文件执行“另存为...”以生成我的图标。

什么样的工具和工作流程适合这种情况？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-04T00:44:27.747

由于有几种不同的商业矢量图形包，因此有不同的方法。我使用的是 Adob​​e Illustrator、Adobe Fireworks、Adobe Photoshop。不可否认，Fireworks 和 Photoshop 是具有矢量支持的位图图形包。

我发现 Fireworks 处理矢量更容易，因为它们是“一流”对象，而在 Photoshop 中，它们实际上是矢量蒙版和颜色填充的组合。使用矢量在位图包中进行设计的好处是更容易通过放大文档来预览光栅化结果，这样您就可以看到各个像素。Illustrator 也添加了“像素预览”模式来实现这一点。

这三个包都具有脚本功能，可让您自动执行重复任务，例如多重导出、命名等。然而，Photoshop 也有动作；一个简化的宏系统，可让您记录和回放简单的批处理活动。

我倾向于构建我的图标包的方式是在一个文档中设计所有图标。我使用“组”（在 Illustrator 中）或“文件夹”（Fireworks 或 Photoshop）将每个图标彼此隔离，但让我保持组成图标的所有单独图层不平整。

当我去导出时，我运行一个脚本，它遍历顶级组/文件夹，一次隐藏除一个以外的所有组/文件夹，并将结果导出到所有主要分辨率的位图；16x16、24x24、32x32、48x48、128x128 和 256x256。

这是微软关于如何为 Vista 和 XP 设计图标的优秀[风格指南。](http://msdn.microsoft.com/en-us/library/aa511280.aspx)它专注于使用 Photoshop 完成大部分工作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-04T00:47:01.330

看看[开罗](http://www.cairographics.org/)及其各种绑定。事实上，甚至还有一个可用于将 SVG 转换为 Cairo 命令的[方法。](http://www.cairographics.org/svgtopycairo/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-23T14:45:08.827

如果您需要一个可靠的免费工具来创建 SVG，然后在确定所需尺寸后将其转储为位图图像，[Inkscape](http://inkscape.org)将是一个不错的选择。UI 看起来不如 Illustrator 精致，但在 Windows、Mac 和 Linux 上运行良好。限制是颜色管理不如 Illustrator 强大，并且如果您不在 Linux 机器上，则对压力敏感图形输入板的支持不太好。

# javascript - Javascript中的矢量图形？

> ID：410146
> 
> 赞同：17
> 
> 时间：2009-01-04T00:20:40.587
> 
> 标签：javascript, html, vector-graphics

Flash/Flex 的优点之一是您可以使用矢量图形 (SVG)，这很好。我做了一些搜索，发现了这个[Javascript 矢量图形库](http://www.walterzorn.com/jsgraphics/jsgraphics_e.htm)。这是非常简单的东西，但它让我思考：是否有可能使用带有 Javascript/HTML 的 SVG 等矢量图形文件，或者无法合理地完成或完成？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2011-07-07T01:40:46.970

我知道这是一个很老的问题，但如果有人遇到这个问题，我在 JavaScript 中看到的最令人印象深刻的矢量图形是[Paper.js](http://paperjs.org/)。

希望有帮助。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-01-04T00:25:11.403

我使用过[Raphaël Javascript Library](http://raphaeljs.com/)，它运行良好。目前该库支持 Firefox 3.0+、Safari 3.0+、Opera 9.5+ 和 Internet Explorer 6.0+。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-01-04T00:30:37.710

看看[Cake](http://glimr.rubyforge.org/cake/canvas.html#SVGParserTest)、[Processing.js](http://ejohn.org/blog/processingjs/)和[jQuery SVG 集成插件](http://plugins.jquery.com/project/svg)。

还要检查[Canvas 元素](https://developer.mozilla.org/en/Drawing_Graphics_with_Canvas)参考。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-04T18:21:06.537

看看[dojox.gfx](http://docs.dojocampus.org/dojox/gfx)。[我在Recommend javascript graphics tutorials](https://stackoverflow.com/questions/385405/recommend-javascript-graphics-tutorials#385444)中发布了更多冗长的答案，介绍了浏览器中可用的图形选项，包括 2D 和 3D 案例。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2010-01-07T16:29:46.193

查看[谷歌关闭](http://code.google.com/closure/)。[矢量图形支持](http://closure-library.googlecode.com/svn/trunk/closure/goog/docs/class_goog_graphics_AbstractGraphics.html)做得很好，IMO 。如果您以前使用过 Java2D，那么这应该看起来很熟悉。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2013-04-22T10:49:51.503

查看 PixelCut 的 WebCode 应用程序。它从矢量图生成 JS、SVG、HTML。 [http://www.webcodeapp.com](http://www.webcodeapp.com)

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2019-03-02T15:17:40.573

只是为了添加一个额外的答案。流行矢量 js 之一的创建者 (Raphaël) 加入了 Adob​​e，并在此 ( [http://snapsvg.io/](http://snapsvg.io/) ) 上工作了几年。

虽然最后一个版本是从 2017 年开始的，但它比这里提到的其他库维护得更多，更新也更多。希望这对在 js 中寻找 svg 矢量图形库的人有所帮助。

如果你正在寻找一个为 snap 构建的 meteorjs，你可以在这里（[https://atmospherejs.com/mirageglobe/snapsvgcdn](https://atmospherejs.com/mirageglobe/snapsvgcdn)）得到它

```
$ meteor add mirageglobe:snapsvgcdn 
```

# c# - 如何根据两个表过滤 TableAdapter 的 FillBy？

> ID：410148
> 
> 赞同：2
> 
> 时间：2009-01-04T00:24:54.277
> 
> 标签：c#, filter, strongly-typed-dataset, tableadapter

我在 Windows 窗体应用程序上使用 VS2008 C# Express 和 Northwind 数据库。

我使用拖放设置两个数据网格视图的主详细信息绑定（我使用了订单和订单详细信息）。在这一点上，一切都按预期工作。为了不返回表中的每一行，我想根据 Orders 表的过滤器和 Orders Details 表中的字段过滤 Orders 表。在 TableAdapter 配置向导中，我使用查询生成器添加了一个新的 FillByMyFilter，它创建了以下查询：

SELECT Orders.[Order ID]、Orders.[Customer ID]、Orders.[Employee ID]、Orders.[Ship Name]、Orders.[Ship Address]、Orders.[Ship City]、Orders.[Ship Region]、 Orders.[Ship Postal Code]、Orders.[Ship Country]、Orders.[Ship Via]、Orders.[Order Date]、Orders.[Required Date]、Orders.[Shipped Date]、Orders.Freight FROM Orders INNER JOIN [Order Details] ON Orders.[Order ID] = [Order Details].[Order ID] WHERE (Orders.[Ship Name] LIKE N'A%') AND ([Order Details].Quantity < 20)

我通过添加两个表得到了这个，但没有检查 Order Details 表中的任何字段框，因此它只会返回原始 Fill 查询中使用的列。我现在只是试图过滤主表中的数据集，而不是返回不同数量的列。订单详细信息的子行仍应像默认的未过滤结果集一样工作。

现在的问题：当我单击执行查询按钮时，它工作正常。我从上面的查询中得到 53 行，而不是使用设计器创建的默认填充的 1078 行。它返回与原始填充查询相同的列。但是，当我尝试运行应用程序时，出现以下约束错误：

“未能启用约束。一行或多行包含违反非空、唯一或外键约束的值。”

我究竟做错了什么？

更新：我认为由于向导创建的 INNER JOIN 导致约束错误。如果我编辑查询以使用 LEFT JOIN，则向导将其更改回 INNER JOIN。

我的问题仍然是如何根据父表和子表中的条件过滤父表（订单）中的记录。我的下一个测试是尝试使用存储过程，但想知道仅使用 TableAdapter 自定义 FillBy 方法。

问候，

调试

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-04T00:54:59.457

本文包含一些故障排除建议，以查明导致问题的确切行：

[数据集地狱 - “无法启用约束。一行或多行包含值......”](http://osherove.com/blog/2004/10/3/dataset-hell-failed-to-enable-constraints-one-or-more-rows-c.html)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-05T22:15:01.573

如果您查看 Orders.Designer.cs（猜测，因为我在 VB 中工作），您可能会看到 Orders 上定义的唯一约束（用于主键）。

我怀疑问题是，当您运行查询时，您将获得一个或多个具有> 1 OrderDetails.Quantity > 20 ....的单个订单。因此，该订单将在您的结果集中返回两次，这违反了主键。

尝试： SELECT * from orders where [Ship Name] LIKE '%whatever% AND OrderID in（从 OrderDetails 中选择 OrderID，其中 Quantity < 20）

这可能是一种非常低效的方法，在 oracle 中您将使用 EXISTS() 而不是 IN() 但我不知道 sql server 等价物。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-06T03:12:47.727

感谢所有发布答案的人。下面是我使用 TableAdapter 向导和 Northwind 类型数据集的方法。

1）右键单击xsd设计器中的父表添加或配置查询。2) 单击向导中的“下一步”按钮，直到看到“查询生成器”按钮。单击查询构建器按钮以进入查询构建器模式。3）右键单击并在设计窗格中添加子表。您应该有两个表和连接它们的默认约束。4) 单击要过滤的子表上的列（此复选标记稍后将被删除），以便将其添加到条件窗格中，以便您可以过滤它。5) 为父列和子列添加过滤器。在此示例中，我过滤了 Ship Name LIKE 'A%' 和 Order Quantity < 20。

请注意，此时您可以通过单击“执行查询”按钮来测试您的查询。使用 Northwind DB for SQL 2008 精简版我得到 53 行返回。如果此时要保存它，它会在运行时失败，因为结果集中有重复的主键。所以接下来的几个步骤将摆脱它们。

6) 在条件窗格中，取消选中您之前添加的子表列。过滤器将保留，现在在设计窗格中也将取消选中同一列。如果您运行查询，您仍将有 53 行，但没有子表列。7）右键单击设计窗格并添加“分组依据”。此时，当您执行此查询时，订单 ID 中应该没有重复项。我正好返回了 29 行。8) 单击确定，然后单击“下一步”按钮，直到您保存新的 FillBy 查询。9) 更改您的源代码以使用新的 FillBy。

当我运行应用程序时，我得到了过滤后的父表，其中包含与执行查询按钮返回的相同的 29 行。子表按预期工作，并且至少包含一个数量小于 20 的子行。

对于现实世界的应用程序，我认为使用存储过程或 LINQ 会更好。但是这个问题让我摸不着头脑，所以我“让它适应”只是因为它是一个挑战（至少对我来说）。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-05T14:43:11.423

希望你得到这个答案，但如果没有，请考虑一下。

在您的数据集中，如果 Order 和 OrderDetail DataTables 之间存在关系，那么它的工作方式有点像 FK 约束。因此，子表 (OrderDetail) 中不能有没有对应父 (Order) 记录的记录。因此，可能发生的情况是，当您使用上面提到的查询刷新 Order DataTable 时，OrderDetail 表中仍有子行将引用刷新后将不再存在的父（订单）记录。也就是说，如果您刷新 Order DataTable，您还需要刷新 OrderDetail 数据表，或者删除两个 DataTable 之间的关系。

希望这可以帮助...

# php - 使用 Apache 保护您的图像、CSS 和 Javascript 文件不被外部站点使用？

> ID：410150
> 
> 赞同：0
> 
> 时间：2009-01-04T00:25:29.250
> 
> 标签：php, security, apache

我遇到了一个展示 Javascript 库的网站，它要求您不要直接从您的网站链接到 Javascript 文件。这是一个合理的要求。事实上，我不会想到这样做而不是自己托管它，但我想会尝试以任何方式节省带宽。

这让我开始思考：Apache（在共享托管环境中）是否有任何简单的方法来防止这种情况，或者至少通过查看 HTTP_REFERRER 或类似的东西来使它变得更加困难？或者甚至只是确保您有一个 PHP 会话？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-01-04T00:33:15.727

使用 htaccess 文件，您可以做到这一点。

只需在要保护的文件目录中创建一个 .htaccess 文件，其中包含以下内容：

```
RewriteEngine on
RewriteCond %{HTTP_REFERER} !^$
RewriteCond %{HTTP_REFERER} !^http://(www\.)?yourdomain.com(/)?.*$ [NC] 
```

有关更多信息和您可以采取的其他一些措施来防止 Web 服务器级别的热链接，请参阅有关防止热链接的[开发论文文章](http://www.devpapers.com/article/242)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-04T00:30:33.000

[这](http://www.cyberciti.biz/faq/apache-mod_rewrite-hot-linking-images-leeching-howto/)是一个很棒的教程，我一直收藏。它可能描述了如何防止图像上的热链接，但它很容易适应其他类型的文件，例如 javascript 或 CSS。

看看这是不是你需要的。:)

# c++ - 我应该为 Visual C++ 游戏开发项目使用哪个项目模板？

> ID：410154
> 
> 赞同：4
> 
> 时间：2009-01-04T00:27:28.747
> 
> 标签：c++, visual-studio

我应该为 Visual C++ 游戏开发项目使用哪个项目模板？我对 Visual Studio 真的很陌生，我对所有这些 Windows 窗体应用程序、Win32 控制台应用程序、CLR 控制台应用程序等东西有点困惑。我以前在 Linux 中编写过游戏，现在我想做一个纯 Windows 应用程序。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-04T00:33:04.663

您可以在 Visual C++ 项目下打开一个空项目。我不知道你将使用什么库等等。在这种情况下，我怀疑您是否要走 .NET 路线，绝对不想要基于 CLR 的应用程序。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-04T01:09:09.723

最简单的方法确实是使用 Empty Project 选项并自己设置设置。

如果您想要一个启动应用程序，请使用 Win32 项目，而**不是**Win32 控制台应用程序，因为它会在您运行它时为您生成一个控制台窗口，这是不可取的。

如果您想使用 XNA 工具包进行游戏开发，那么它有自己的项目选项，但为此您将使用 C# 而不是 C++。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-04T00:34:51.027

最简单的方法是使用 Win32 控制台应用程序。您可以使用 GLUT 进行渲染。

我会推荐使用 FreeGLUT 库进行渲染。

[http://freeglut.sourceforge.net/](http://freeglut.sourceforge.net/) - 在 Visual Studio 上设置非常简单

[http://www.lighthouse3d.com/opengl/glut/](http://www.lighthouse3d.com/opengl/glut/) - 设置使用 glut 的分步说明。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-01-07T12:57:37.843

我自己对包括游戏在内的大多数项目都使用了一个空的项目模板。原因？

1.  更多控制
2.  更容易集成
3.  没有添加不必要的东西

缺点：

1.  您可以编写更多代码（或重用已编写的代码）
2.  你会更关心内部结构

# python - 对于 Python 程序员来说，有什么与 Perl 的 CPAN 等效的东西吗？

> ID：410163
> 
> 赞同：35
> 
> 时间：2009-01-04T00:30:37.180
> 
> 标签：python, perl

由于 Django 框架，我现在正在学习 Python。我从事 Perl 程序员已经很多年了，我已经习惯了 Perl 的工具。我真正怀念的一件事是 Perl 的 CPAN 及其工具。Python中有什么等价的吗？我希望能够像 CPAN 一样简单地搜索、安装和维护 Python 模块。此外，一个可以自动处理依赖关系的系统。我尝试通过从网站下载一个 zip 文件，解压缩它，然后执行以下操作，在 Python 中安装一个模块：

`sudo python setup.py install`

但它正在寻找另一个模块。现在，虽然我很懒，我不喜欢追逐依赖等，有没有简单的方法？

* * *

## 回答 #1

> 赞同：33
> 
> 时间：2009-01-04T00:34:17.890

sammy，看看[pip](http://pip.openplans.org/)，它可以让你执行“pip install foo”，并将下载并安装它的依赖项（只要它们在[PyPI](http://pypi.python.org/)上）。还有[EasyInstall](http://peak.telecommunity.com/DevCenter/EasyInstall)，但 pip 旨在取代它。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2009-01-05T03:32:27.157

请注意 pip 和 easy_install 都使用[Python 包索引 (PyPI)](http://pypi.python.org/pypi)（有时称为“Cheeseshop”）来搜索包可能很有用。Easy_install 目前是最普遍支持的，因为它完全适用于 setuptools 和 distutils 风格的包装。有关使用 pip 的充分理由，请参阅[James Bennett 对 python 打包的评论，以及](http://www.b-list.org/weblog/2008/dec/14/packaging/)[Ian Bicking 的回复](http://blog.ianbicking.org/2008/12/14/a-few-corrections-to-on-packaging/)以澄清差异。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-17T10:09:16.027

如果您确实使用`easy_install`，我建议您通过执行来安装软件包..

```
easy_install -v -Z package_name  |  tee date-package.log 
```

`-Z`（缩写`--always-unzip`）将文件解压缩`.egg`到目录，这样您就可以..

```
less *.egg/EGG-INFO/requires.txt  
less *.egg/EGG-INFO/PKG-INFO  
egrep '^(Name|Version|Sum|...)'  *.egg/EGG-INFO/PKG-INFO 
```

在 Sammy 的原始问题上，除了 PyPI 之外，还有几个包索引是：
[Scipy](http://www.scipy.org/Topical_Software) 和[Scipy docs](http://docs.scipy.org/scipy/docs/scipy) for Scientific Computing
[ohloh](http://www.ohloh.net/tags/python) with code metrics。

# .net - 有人在 .NET 中使用类型化数据集吗？

> ID：410178
> 
> 赞同：4
> 
> 时间：2009-01-04T00:45:52.627
> 
> 标签：.net, strongly-typed-dataset

我曾经尝试在一个相对较小的生产应用程序中使用类型化的 DateSet。最初它看起来是一个不错的主意，但结果却有所不同。对于一些基本任务来说这还不错，但是一旦需要更高级的东西，它就会受到限制并且惨遭失败。幸运的是，该项目被取消了，从现在开始，我尝试坚持使用像 NHibernate 这样的适当 ORM。

但我仍然想知道——它们是有原因的。也许我只是不明白如何正确使用它们？有没有人在生产系统中成功使用它们？

**添加：**

您能否快速解释一下您是如何使用它们的？

我试图将它们用作我的 DAL——它是一个 Windows 窗体应用程序，它会从表中获取数据到 DataSet 中，然后在调用 TableManager 的分层更新事物之前使用数据进行操作（不记得确切的名称）。DataSet 为 DB 的每个物理表提供一个表。当我不得不做一些类似主/细节关系的事情时，问题就开始了，我必须一次将一堆记录（一个主记录和几个细节记录）插入到几个表中，同时还要保持外键正确。

**添加2：**

哦，如果您使用它们，那么您将业务逻辑放在哪里？（验证、计算等）

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-04T00:54:16.057

我们一直使用类型化数据集，实际上我们将它们用作最佳实践。我们这样做的原因是在编译时捕获错误，而不是使用基于字符串的列名查找可能会在运行时引入错误。

我想，和往常一样，这取决于场景以及您是否获得使用它们的任何优势。

正常行参考：

```
`oRow["row_pk"]`
```

`在类型化数据集中，它现在变为：`

```
``oRow.row_pk``
```

``我们的数据集通常与数据库场景匹配，我们使用 DataAdapters 使用存储过程更新对数据库的更改。输出参数使用从数据库生成的键更新数据集。``

 ``显然，您需要以正确的顺序运行适配器更新，以便以正确的顺序生成所有密钥。删除父/子行时还必须小心，并确保这些删除以正确的顺序进行，以防止数据库异常。

当 .NET 还是 1.1 时，我读了[David Sceppa 的 ADO.NET](http://www.microsoft.com/learning/en/us/Books/5354.aspx)书，这让我看到了实际可以实现的目标，并大大简化了我的 DAL（使用类型化数据集）。那里有很多技术可以真正帮助改进您的代码，我强烈推荐它。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-04T18:49:30.037

I use them when: 1) Writing a "1-offs" that are ditched once the project we are working on is complete. 2) Using XML files to swap data with other vendors. 3) Prototyping and testing,

I have had trouble with typed dataset when: 1) Complex queries are required to filter and save the data. (at least for me) 2) Not knowing enough of what the Visual Studio designer writes on my behalf so that I can extend the derived class that is created for typed datasets.

I've never had a speed issue with typed datasets and the users seem happy with the applications built with them. To be honest, I have not benchmarked the different methods that could replace typed datasets. Lastly, I have been saved more than once by the design time type checking that would have been missed by a novice programmer like myself by using typed datasets.

Regards,

DeBug

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-01-04T00:51:18.030

它们对我创建 XML 文档以发送到 Web 服务很有用。客户端将预期数据定义为类型化的 DataSet，这使得在内存中创建 DataTable 并获取 XML 表示变得非常简单。

现在，对于真正的数据库访问......我使用我自己的 DAL，我同意你的看法 - 数据集非常有限。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-01-04T00:53:19.100

我正在使用它们。也许只是因为我没有尝试过 NHibernate，但我不能使用 LINQ，因为我仅限于 Windows 2000，它不运行 .NET 3。起初它们看起来很理想，但我发现了足够多的奇怪怪癖关于他们开始让我失望。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-01-04T02:09:54.843

我使用它们，但不是通常意义上的。它类似于 ocdecio 的答案，尽管在我的情况下它是 asp.net 中的演示模型（没有表格适配器）

“客户端服务”层将它们（作为合同的**一部分**）用于任何获取或返回数据的方法。底层业务服务使用更传统的 poco 方法，客户端服务只需进行一些映射即可为给定的 ui 生成强类型数据集。

工具支持使新开发人员（他们可以关注 asp.net/learn 视频以加快速度）更容易使用他们需要的服务。UI 构建者还可以快速“设计”一组他们想要检索的新数据，并让相关服务的团队从那里着手。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-01-04T01:08:26.013

如果您相信软件编写软件和静态类型（软件捕获软件错误）的好处，它们正是所需要的，但代价是复杂性（肯定）、开发开销（可能）和效率（可能但有争议）——这是 C# 和 java 等语言的基本前提。

然而，这还不是一场完全胜利的战斗。

编辑（要求解释）：

复杂。

使用 C# 或 java，您最终会得到大量用于配置、类型声明、强制转换、类型检查和验证的代码。有些是您自己编写的，有些是 IDE 为您编写的。但这是开发人员负责的所有代码。主要好处是 IDE/编译器 - 指出可能的软件错误和自动完成。我可以肯定地说，不采取任何一方的立场，行业讨论大量的代码行是否值得。这至少明显违反了 YAGNI。在 VS 中，我经常遇到由 IDE 编写的整个代码文件，其中有我最终需要弄清楚的错误。我不喜欢弄清楚不是我写的代码。

开发开销。

同上。Java 以您需要编写和维护以使应用程序组合在一起的所有各种 XML 配置文件而闻名。RoR 的许多吸引力在于“按惯例配置”，只是为了避免这种情况。

效率。

与编译语言相比，解释或 JIT 编译语言效率极低的断言长期以来被认为是不言而喻的。出于更多的原因，我在这里没有时间，这个假设受到质疑。例如，一些更新、更快的 javascript 引擎。

在这个网站和谷歌上搜索的最明显的东西是“后期绑定”、“动态类型”、“JIT 编译器”。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2010-07-31T21:11:06.507

我仍然比我希望的更多地使用它们......它们绝对比无类型数据集更好，但你必须小心可空值类型字段。如果您有一个可以包含空值的 Int 字段，则当该字段为空时，您不能尝试访问该字段，否则将引发异常。您必须首先调用 IsMyIntFieldNull() 来检查它是否为空。这意味着您的代码在任何地方引用这些字段之一，您需要先进行此检查...这很容易增加大量额外的代码。如果类型化数据集支持这些列的可空值字段会更好，但不幸的是它们不支持。

# php - 对 Web 的集体编程感兴趣——Ruby、Python 或 PHP？

> ID：410183
> 
> 赞同：0
> 
> 时间：2009-01-04T00:49:35.223
> 
> 标签：php, python, ruby, artificial-intelligence, recommendation-engine

对于个人推荐系统，网站上的机器学习类型的东西，哪种语言最好？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2009-01-04T00:54:15.697

你最熟悉的语言会是最好的。

我的意思是半认真的。鉴于您的项目的简要描述，没有理由相信您列出的任何语言都会比其他语言更好或更差。这三种语言足以完成大致相似的任务，因此您应该选择您最熟悉的一种并继续。

任何其他建议都是对一种语言或另一种语言的宣传，没有真正的评估依据。你的描述太模糊了。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-09T00:21:09.850

1.  [编程集体智能](https://rads.stackoverflow.com/amzn/click/com/0596529325)- 构建智能 Web 2.0 应用程序

2.  [集体智慧在行动](https://rads.stackoverflow.com/amzn/click/com/1933988312)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-11T22:30:52.367

比尔·卡尔文提出的所有观点都是完全正确的：你应该真正按照自己最舒服的方式进行操作。

如果这不是一个因素，我个人建议使用 Ruby。它是一种非常强大的语言，它与 Lisp 有很多共同点，并且对于 AI 编程来说可能与 Lisp 一样好，甚至更好，原因与 Lisp 相同：它是一种极其动态、可自我修改的语言。作为一个额外的好处，Ruby 有一个非常好的标准库，包括一些很棒的库，比如分布式计算库“dRuby”。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2011-10-01T12:01:50.883

我碰巧认识一位世界级的机器学习专家。他喜欢 Prolog，尤其是对于系统的更高层次的逻辑。很久没有听到有人提起这件事了。就个人而言，我喜欢 Java。但是如果你要进行密集的机器学习，你应该关注数学处理的速度。在我看来，C++ 用于数学。

* * *

## 回答 #5

> 赞同：-2
> 
> 时间：2009-03-11T22:44:44.937

我最近在我的日常工作中为一个项目对此进行了一些研究。这是一个推荐系统，选项是 php、perl 或 python。

PHP 几乎立刻就出来了，没有好的第 3 方开源库，而且语言本身也不太适合任何类型的复杂实际编程。

Python 有一些我想尝试的库，而 Perl 没有，所以我选择了 Python。最后，这些库对我来说都没有用，但除了库支持之外，我个人更喜欢 python，所以这是正确的决定。

因为您的问题非常模糊，所以我只能建议您*不要*使用 PHP，并根据您的特定问题领域的库支持和您对该语言的舒适度来选择语言。我想说图书馆支持是您做出决定的最大因素，语言熟悉度/偏好紧随其后。

# c++ - 使用 C++ 或 C 访问应用程序的 COM 接口

> ID：410184
> 
> 赞同：1
> 
> 时间：2009-01-04T00:50:31.103
> 
> 标签：c++, c, com, interface

在回答问题时，我如何（或找到更多信息）在没有用户干预的情况下从 C++（或 C）**自动化**某些**功能，使用：**

*   ATL
*   或直接在 C/C++ 中的自动化代码

问候

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-04T08:22:58.693

如果应用程序公开了一个类型库（Microsoft Office 应用程序也公开了），那么您可以通过使用#import 关键字从 Microsoft C++ 获取它。这将为应用程序公开的 COM 接口创建 C++ 包装器。

类型库通常是 .TLB 文件，但它们通常作为 Win32 资源嵌入在可执行文件中。

要确定应用程序是否以这种方式公开其功能，您可能需要查阅特定应用程序的文档，因为发现（和理解）类型库非常复杂。

Windows SDK 包括一个工具，“OLE/COM 查看器”，它可以显示注册表中 COM 对象或来自 .TLB 文件或资源的类型库信息。

如果您想使用应用程序，VBScript（或 JScript）为您提供了一种快速的试验方法。它们都能够使用 OLE 自动化接口。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-04T01:32:18.897

通过自动化，您的意思是能够拥有一个运行应用程序、与之通信并执行某些功能的脚本。类似于某种自动化测试脚本之类的东西。

为此，最简单的方法（如果应用程序已经存在，例如 Word、Excel、Visual Studio 等）是用支持 DCOM 的语言（例如 Ruby 及其 WIN32OLE 库）编写脚本并使用它来调用应用。

如果您正在开发一个应用程序，那么这会变得更加棘手，您可能会将现有的脚本语言嵌入到您的可执行文件中，并提供一种与之交互的方法。也许有一个命令行选项可以在应用程序的上下文中自动运行脚本。或者如果你想做一些严肃的开发工作，你可以尝试在 DCOM 中添加（我没有尝试过，所以我不知道涉及多少工作）。

# ruby - 更改源代码后如何重新加载正在运行的 Shoes 应用程序？

> ID：410185
> 
> 赞同：6
> 
> 时间：2009-01-04T00:50:38.560
> 
> 标签：ruby, shoes

我想开始修补[Shoes](http://shoooes.net/)。有一件事我想不通。保存对源代码的更改后，如何重新加载正在运行的 Shoes 应用程序？我已经找到了打开帮助、控制台和新应用程序的热键。

对我来说，每次进行更改时，开发人员都会被迫关闭并重新启动鞋子应用程序，这似乎很奇怪。对于一个以类似 web 为荣的开发环境，对应的“F5 键”在哪里？

也许我错过了一些东西或看错了地方。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-09T07:29:06.553

目前没有这样的捷径。该文档仅提及您提到的三个快捷方式（用于控制台的 alt+slash、用于帮助的 alt+question 和用于新应用程序的 alt+句号），实际上代码仅包含这些快捷方式。确实，`shoes/app.c`有以下几行：

```
shoes_code
shoes_app_keypress(shoes_app *app, VALUE key)
{
  if (key == symAltSlash)
    rb_eval_string("Shoes.show_log");
  else if (key == symAltQuest)
    rb_eval_string("Shoes.show_manual");
  else if (key == symAltDot)
    rb_eval_string("Shoes.show_selector");
  else
    shoes_canvas_send_keypress(app->canvas, key);
  return SHOES_OK;
} 
```

换句话说，三个已知的快捷键被捕获并进行特殊处理，而任何其他按键都被发送到相关的应用程序。

但是，可以编写自己的“包装器”来完成您想要的任务。

# ruby - ruby 序列化（编组）如何工作？

> ID：410186
> 
> 赞同：10
> 
> 时间：2009-01-04T00:50:54.583
> 
> 标签：ruby, serialization

我找到了一些关于这个主题的信息（[比如这个链接）](http://rubylearning.com/satishtalim/object_serialization.html)，但没有什么能告诉我它在幕后实际上是如何工作的。如果您不想阅读下面的文章，以下是真正的问题：

1.  我应该如何实现`marshal_dump`和`marshal_load`方法？即使是一个简单的例子也可以。

2.  当`marshal_load`被调用时，它如何“知道”要创建哪种类型的对象？如果文件中有多个相同类型的对象，你怎么知道哪个是哪个？我显然很困惑...

3.  如果我有一个代表图像的对象，是否有不同的方法将其写入磁盘？

**我的具体问题是这样的：**

这有点复杂，因为我没有想要序列化的对象的源代码。

我正在开发游戏引擎的模组（使用 RGSS2 游戏库的 RPG Maker VX）。有一个名为 Bitmap 的类属于（闭源）API。我想在游戏之间保存这个对象/图像，所以我需要将它序列化到保存文件中。我不是 ruby​​ 专业人士，但我知道我可以定义两个方法（`marshal_dump`和`marshal_load`），当我尝试序列化对象时，“Marshal”模块将调用它们。

问题是我不知道如何实现所需的两种方法。我实际上可以将它们保留为空方法，它*似乎*可以工作，但实际上已处置对象并且图像数据已消失。除此之外，我不明白它在内部做什么，显然创建空方法是错误的。

那么谁能告诉我这些东西在内部是​​如何工作的？我认为这将帮助我解决我的问题。除此之外，是否有另一种我可以使用的图像格式，我可以将其保存到文件中并避免自己进行序列化？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-01-04T02:10:54.997

Ruby 编组方法存储它们正在编码的对象的类型。这两个钩子的工作方式是这样的：

*   `marshal_dump`必须返回一些描述对象状态的数据。Ruby 并不关心这些数据的格式——它必须是你的`marshal_load`方法可以用来重建对象状态的东西。

*   `marshal_load`在重新创建后立即在编组对象上调用它。它基本上是编组对象的初始化方法。它传递了返回的任何对象`marshal_dump`，并且必须使用该数据来重建其状态。

这是一个例子：

```
class Messenger

  attr_accessor :name, :message

  def marshal_dump
    {'name' => name, 'message' => message}
  end

  def marshal_load(data)
    self.name = data['name']
    self.message = data['message']
  end

end 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-10-17T09:21:50.593

您可以使用 NArray 序列化原始数值数据，如下所示：

```
require 'narray'

class NArray
  def _dump level
    Marshal.dump [to_s, typecode] + shape
  end

  def self._load arg
    NArray.to_na *Marshal.load(arg)
  end
end

describe NArray do
  let(:arr) { NArray[[2, 3, 5], [7, 11, 13]] }

  it 'should load and save an array' do
    dumped = Marshal.dump arr
    expect(Marshal.load(dumped)).to eq arr
  end
end 
```

# asp.net - 您是否计划从 ASP.Net Web 表单迁移到 ASP.Net MVC？

> ID：410202
> 
> 赞同：6
> 
> 时间：2009-01-04T00:59:52.630
> 
> 标签：asp.net, asp.net-mvc, migration

如果是，什么时候？以及您认为迁移您当前项目的过程需要多长时间（如果是这样的话）？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-01-04T01:46:16.357

ASP.NET MVC**并不是要取代 WebForms**。它们是不同的技术，是为不同的目的而设计的。

笼统地说我只会使用一种而不使用另一种是一种非常狭隘的方法，因为您错过了每种技术的优缺点。

Microsoft 致力于这两种技术的发展，并且在 WebForms 4.0 中提供了很多不错的新功能。

我将使用 WebForms 和 ASP.NET MVC，但会考虑当前项目的需求，以便*为当前的实现做出正确的决定*

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2009-01-04T01:51:02.213

我已经使用了几个月了。我绝对喜欢 MVC。转换现有项目可能不现实，具体取决于可用时间。正如我所看到的，Web 窗体模拟了旧 VB 人群的 Windows 窗体开发。虽然 MVC 并没有假装它不是它，但它更紧​​密地遵循 Http 过程。

我在 MVC 中看到的一些优点

1) 可通过单元测试进行测试

2）直接控制Html。我们做网站，我们如何接受无法控制我们所有的html？

3) 没有视图状态包

4）没有控制树浪费时间渲染

5) 从表单帖子自动绑定模态

6）它可能相当性感

还有一些缺点

1) 不再有网络控件（并且丢失了许多丰富的第 3 方控件）

2）发展较慢

3) 大的学习曲线

4) 仍处于 Beta 阶段（不过 CTP 很快）

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2009-01-04T01:34:52.340

是的，对于我的新项目。但不适用于当前的生产软件。

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2009-01-04T01:50:48.487

是的，以尽可能有序的方式进行。

MVC 为 .NET 开启了敏捷开发最佳实践的世界。它专门解决了对关注点分离和耦合/内聚的担忧。它还允许我们编写更便携的软件，而无需创建对任何供应商特定参考或组件的依赖。

毫无疑问，它**是 WebForms 以及 WPF 的继任者**，无论您阅读什么 PR。

[维基百科条目](http://en.wikipedia.org/wiki/Windows_Forms)非常清楚，甚至在为微软的 MVC 更新之前。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-01-04T01:45:00.777

假设您更喜欢 ASP.NET MVC 而不是 Web 窗体，那么对于处于积极开发/维护中的系统来说，这是值得的。

它们可以并行共存，因此可以迁移应用程序的某些部分（新的或选定的旧的）并查看它是如何工作的。如果成功，请继续。

不过，“全有或全无”迁移可能是灾难性的——在没有快速反馈的情况下进行大量投资是一个巨大的风险。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-01-04T04:58:48.013

> WebForms 用于丰富的 UI

这些可以用 MVC 或 Webforms 完成。一年后，丰富的基于 MVC 的工具包将会出现（从技术上讲，如果你喜欢 YUI、ExtJS 等，它们已经在这里了）并使这个论点无效。

> 迁移您当前的项目

将现有的 WebForms 项目迁移到 MVC 并没有多大意义。你会得到什么？但是，根据您的要求，将 MVC 用于新项目可能会很有意义。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-01-04T14:31:58.340

我已经使用 ASP.NET MVC 几个月了，我更喜欢它而不是 Web 窗体。但是，我没有看到自己将现有项目迁移到 MVC。对我来说，这将毫无意义。但是，我所有的新 ASP.NET 项目都将（或应该）使用 MVC 开发，因为它是一个更好（并且更灵活）的框架。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2009-01-04T16:10:17.580

我从一开始就不太喜欢 WebForms，所以开始使用 MVC 对我来说就像呼吸新鲜空气。我一直更喜欢关注点分离，因为我可以处理我真正擅长开发的块、逻辑和数据访问，并将演示工作留给具有这种天生能力的团队成员。我认为 MVC 库使团队更容易在各个页面上一起工作，因为一个人可以在控制器上工作，而另一个人可以在视图上工作。

话虽如此，当我从事不需要过多关注编码并且更面向显示的项目时，我仍然会回到 WebForms，因为它们更容易实现和启动和运行。两者都有自己的位置，我认为一个永远不会取代另一个。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-01-04T02:05:12.560

我个人将 ASP.NET MVC 限制为轻量级前台网站。

但仍将 ASP.NET WebForms 用于 Righ BackOffice 应用程序，以利用丰富的自定义控件和 Web 窗体的其他一些不错的功能。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2009-01-04T15:52:06.353

mvc 的另一个优点是像 jquery 这样的 javascript 更容易实现，所以如果你打算使用大量 js，mvc 可能是要走的路。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-01-04T01:31:08.620

不，没有理由这样做。这是另一种风格，我不喜欢。但那只是我的个人意见; 很多人喜欢它，我希望它对他们有用。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2009-01-04T03:39:13.337

如前所述，它们并不相互排斥，我玩游戏是为了充分利用两者。

IMO MVC 更适合**网站**，而 WebForms 更适合 Web**应用程序**。

例如，这个站点完美地展示了 ASP.NET MVC 是一个不错的选择，因为站点的性质和需要完成的任务；其他很好的例子是网上商店、项目管理网站（如 Basecamp）或社交网络。

但是，如果您正在开发企业 CRM/ERP 系统，我会坚持使用 WebForms 来获得丰富的控件和更“类似桌面”的编程模型，因为 CRM 应用程序传统上是桌面应用程序的领域。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2009-01-05T02:35:08.397

ASP.NET MVC 更适合我想要的开发风格，但我对信任自己持谨慎态度，因为它不是 RTM。它也足够不同，以至于我们的遗留代码无法使用它。如果我们一直在练习领域驱动开发，事情可能会更容易，但是......

# python - Python中的自然/相对天数

> ID：410221
> 
> 赞同：37
> 
> 时间：2009-01-04T01:20:55.333
> 
> 标签：python, datetime, human-readable, datetime-parsing, humanize

我想要一种在 Python 中显示过时项目的自然时间的方法。类似于 Twitter 如何显示来自“片刻前”、“几分钟前”、“两小时前”、“三天前”等的消息。

Django 1.0 在 django.contrib 中有一个“humanize”方法。我没有使用 Django 框架，即使我使用了，它也比我想要的更受限制。

请让我（以及未来的几代搜索者）知道是否已经有一个好的工作解决方案。由于这是一项足够普遍的任务，我想一定有什么。

* * *

## 回答 #1

> 赞同：38
> 
> 时间：2011-03-02T06:09:12.097

Twitter 的具体日期很有趣，因为它们仅在第一天是相对的。24 小时后，它们只显示月份和日期。一年后，他们开始显示一年的最后两位数字。这是一个示例函数，它的作用更类似于 Twitter 相对日期，尽管它也总是在 24 小时后显示年份。它仅适用于美国语言环境，但您始终可以根据需要更改它。

```
# tested in Python 2.7
import datetime
def prettydate(d):
    diff = datetime.datetime.utcnow() - d
    s = diff.seconds
    if diff.days > 7 or diff.days < 0:
        return d.strftime('%d %b %y')
    elif diff.days == 1:
        return '1 day ago'
    elif diff.days > 1:
        return '{} days ago'.format(diff.days)
    elif s <= 1:
        return 'just now'
    elif s < 60:
        return '{} seconds ago'.format(s)
    elif s < 120:
        return '1 minute ago'
    elif s < 3600:
        return '{} minutes ago'.format(s/60)
    elif s < 7200:
        return '1 hour ago'
    else:
        return '{} hours ago'.format(s/3600) 
```

* * *

## 回答 #2

> 赞同：18
> 
> 时间：2009-01-04T04:52:36.340

虽然此时对你没有用，但对未来的搜索者可能有用：babel 模块，它处理各种语言环境的东西，有一个功能可以或多或少地做你想做的事。目前它只在他们的主干中，而不是在最新的公开版本（版本 0.9.4）中。一旦功能发布到版本中，您可以执行以下操作：

```
from datetime import timedelta
from babel.dates import format_timedelta
delta = timedelta(days=6)
format_timedelta(delta, locale='en_US')
u'1 week' 
```

这直接取自[关于时间增量格式的 babel 文档](http://babel.edgewall.org/wiki/Documentation/dates.html#time-delta-formatting)。这至少会让你部分获得成功。它不会模糊到“片刻前”之类的水平，但它会正确地复数化“n分钟”等。

值得一提的是，babel 模块还包含根据语言环境格式化日期和时间的函数，这在时间增量很大时可能很有用。

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2015-05-05T09:17:37.317

有人性[化包](https://pypi.python.org/pypi/humanize/)：

```
>>> import humanize
>>> import datetime
>>> humanize.naturalday(datetime.datetime.now())
'today'
>>> humanize.naturalday(datetime.datetime.now() - datetime.timedelta(days=1))
'yesterday'
>>> humanize.naturalday(datetime.date(2007, 6, 5))
'Jun 05'
>>> humanize.naturaldate(datetime.date(2007, 6, 5))
'Jun 05 2007'
>>> humanize.naturaltime(datetime.datetime.now() - datetime.timedelta(seconds=1))
'a second ago'
>>> humanize.naturaltime(datetime.datetime.now() - datetime.timedelta(seconds=3600))
'an hour ago' 
```

您的用例示例：

```
>>> humanize.naturaltime(datetime.datetime.now() - datetime.timedelta(seconds=36000))
'10 hours ago'
>>> humanize.naturaltime(datetime.datetime.now() - datetime.timedelta(seconds=360000))
'4 days ago'
>>> humanize.naturaltime(datetime.datetime.now() - datetime.timedelta(seconds=3600000))
'a month ago' 
```

此外（见上面的链接）它还支持人性化：

*   整数
*   文件大小
*   浮点数（小数）

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2009-01-04T03:02:03.693

或者，您可以轻松地从 Django 中调整[timesince.py](http://code.djangoproject.com/browser/django/trunk/django/utils/timesince.py)，它只有 2 个其他依赖项：一个用于翻译（您可能不需要），一个用于时区（可以轻松调整）。

顺便说一句，[Django 有一个](http://code.djangoproject.com/browser/django/trunk/LICENSE)非常灵活的 BSD 许可证，您可以在当前使用的任何项目中使用它。

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2009-01-04T02:52:41.513

您是否正在寻找类似的[东西](http://jehiah.cz/archive/printing-relative-dates-in-python)（在 Python 中打印相对日期）？

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2020-05-18T16:44:15.603

发现obe可以`maya`这样使用

```
pip install maya
>>> maya.when("3 week ago").datetime().strftime("%Y-%m-%d")
'2020-04-27' 
```

# c# - 处理命令并直接在命令上定义连接时连接是否关闭？

> ID：410222
> 
> 赞同：8
> 
> 时间：2009-01-04T01:21:44.880
> 
> 标签：c#, using, using-statement

我知道存在很多示例，其中定义了 SqlConnection，然后定义了 SqlCommand，两者都在 Using 块中：

```
using (var conn = new SqlConnection(connString)) {
      using (var cmd = new SqlCommand()) {
        cmd.Connection = conn;
        //open the connection
      }
} 
```

我的问题：如果我直接在 SqlCommand 上定义连接，那么在释放命令时连接会关闭吗？

```
using (var cmd = new SqlCommand()) {
      cmd.Connection = new SqlConnection(connString);
      //open the connection
} 
```

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-01-04T01:26:46.193

不，SqlCommand 从不尝试关闭/处理连接。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-01-04T01:29:28.793

不，连接对象在您明确处置之前不会被处置。但我的建议是尽可能使用**using 块**。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-01-04T01:33:05.933

它不会关闭连接，您需要自己关闭它或将其放入自己的 using 语句中。

这里还有一个提示，可以让你的`using`块更具可读性：

```
using (var conn = new SqlConnection(connString))
using (var cmd = new SqlCommand())
{
    cmd.Connection = conn;
} 
```

* * *

## 回答 #4

> 赞同：-2
> 
> 时间：2009-01-04T01:59:09.857

@milot

> 但我的建议是尽可能使用 using 块。

在使用非 IDisposable 对象时使用 Using Blocks 很好，但无用，因此如果您在任何地方使用 Using Blocks，这可能会造成混淆。

请小心，因为如果您的对象不实现 IDisposable，它们可能不会被处置。

希望这可以帮助。

# iphone - 在 iPhone 上创建具有更高单元格的 UITableView

> ID：410224
> 
> 赞同：4
> 
> 时间：2009-01-04T01:23:50.427
> 
> 标签：iphone, objective-c, cocoa-touch, uitableview

我该如何创建一个具有更高单元格的 UITableView？基本上，我想创建一个只有四个单元格的全屏表格，但它们应该占据整个屏幕（每个 1/4）。

假设使用 UITableView 可以做到这一点，是否可以在代码和 Interface Builder 中完成？而且，每个单元格可以有自己的高度吗？

--蒂姆

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-01-04T06:50:35.493

只需使用`-tableView:heightForRowAtIndexPath:`UITableViewDelegate 协议中的方法来自定义每个单元格的高度。像这样的东西很好用：

```
- (CGFloat)tableView:(UITableView *)tv heightForRowAtIndexPath:(NSIndexPath *)indexPath {
    return 70.0f;
} 
```

希望有帮助。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-01-04T11:04:14.530

为获得最佳性能，如果所有行的高度相同，请使用 rowHeight 属性。它可以从代码和 Interface Builder 中访问。

如果要自定义单个行高，则需要实现 -tableView:heightForRowAtIndexPath: 委托方法。它的执行速度稍慢，但更灵活。

# c# - 测试对象是否实现接口

> ID：410227
> 
> 赞同：392
> 
> 时间：2009-01-04T01:25:10.487
> 
> 标签：c#, reflection, interface

测试对象是否在 C# 中实现给定接口的最简单方法是什么？[（用Java](https://stackoverflow.com/questions/766106/test-if-object-implements-interface)回答这个问题 ）

* * *

## 回答 #1

> 赞同：626
> 
> 时间：2009-01-04T01:28:01.293

```
if (object is IBlah) 
```

或者

```
IBlah myTest = originalObject as IBlah

if (myTest != null) 
```

* * *

## 回答 #2

> 赞同：239
> 
> 时间：2009-01-07T00:06:01.830

如果您在编译时知道接口类型并且拥有您正在测试的类型的实例，则使用`is`or运算符是正确的方法。`as`其他人似乎没有提到的是`Type.IsAssignableFrom`：

```
if( typeof(IMyInterface).IsAssignableFrom(someOtherType) )
{
} 
```

我认为这比查看返回的数组要整洁得多，`GetInterfaces`并且还具有为类工作的优势。

* * *

## 回答 #3

> 赞同：36
> 
> 时间：2018-06-27T12:41:10.213

如果要在检查后使用类型转换的对象：
自 C# 7.0 起：

```
if (obj is IMyInterface myObj) 
```

这与

```
IMyInterface myObj = obj as IMyInterface;
if (myObj != null) 
```

请参阅 .NET 文档：[模式匹配概述](https://docs.microsoft.com/en-us/dotnet/csharp/fundamentals/functional/pattern-matching)

* * *

## 回答 #4

> 赞同：25
> 
> 时间：2009-01-04T01:29:45.597

例如：

```
if (obj is IMyInterface) {} 
```

对于班级：

检查是否`typeof(MyClass).GetInterfaces()`包含接口。

* * *

## 回答 #5

> 赞同：16
> 
> 时间：2012-11-14T06:31:23.380

@AndrewKennan 的答案的一个变体我最近最终使用了在运行时获得的类型：

```
if (serviceType.IsInstanceOfType(service))
{
    // 'service' does implement the 'serviceType' type
} 
```

* * *

## 回答 #6

> 赞同：11
> 
> 时间：2017-07-23T17:11:16.533

这个[帖子](https://stackoverflow.com/questions/4963160/how-to-determine-if-a-type-implements-an-interface-with-c-sharp-reflection)是一个很好的答案。

```
public interface IMyInterface {}

public class MyType : IMyInterface {} 
```

这是一个简单的示例：

```
typeof(IMyInterface).IsAssignableFrom(typeof(MyType)) 
```

或者

```
typeof(MyType).GetInterfaces().Contains(typeof(IMyInterface)) 
```

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2016-09-16T12:55:13.463

对我有用的是：

`Assert.IsNotNull(typeof (YourClass).GetInterfaces().SingleOrDefault(i => i == typeof (ISomeInterface)));`

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2021-08-14T07:13:51.857

我通过使用`is`关键字实现了这一点。

但我还需要一个新对象来使用接口属性。为此，您需要在接口之后添加新变量。

```
objectToCheck is Interface newVariableWithInterfaceProperties 
```

.

```
 public async Task<TResponse> Handle(TRequest request, CancellationToken cancellationToken,
            RequestHandlerDelegate<TResponse> next)
        {
            if (request is ICacheableQuery cachableRequest)
            {
             // here cachableRequest now has the interface properties.
             }
        } 
```

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2009-01-06T23:57:14.580

除了使用“is”运算符进行测试之外，您还可以装饰您的方法以确保传递给它的变量实现特定的接口，如下所示：

```
public static void BubbleSort<T>(ref IList<T> unsorted_list) where T : IComparable
{
     //Some bubbly sorting
} 
```

我不确定这是在哪个版本的 .Net 中实现的，因此它可能不适用于您的版本。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2014-11-06T12:55:06.937

最近我尝试使用 Andrew Kennan 的答案，但由于某种原因它对我不起作用。我改用它并且它有效（注意：可能需要编写命名空间）。

```
if (typeof(someObject).GetInterface("MyNamespace.IMyInterface") != null) 
```

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2021-10-19T01:48:41.997

```
 interface IItem
    {

    }

    class ItemImp : IItem
    {

    }

    class Program
    {
        static void Main(string[] args)
        {
            Type t = typeof(ItemImp);

            Console.WriteLine("t == typeof(IItem) -> {0}", t == typeof(IItem));
            Console.WriteLine("typeof(IItem).IsAssignableFrom(t) -> {0}", typeof(IItem).IsAssignableFrom(t));
            Console.WriteLine("t is IItem -> {0}", t is IItem);
            Console.WriteLine("new ItemImp() is IItem -> {0}", new ItemImp() is IItem);
        }
    }

// Here are outputs:
// t == typeof(IItem) -> False
// typeof(IItem).IsAssignableFrom(t) -> True
// t is IItem -> False
// new ItemImp() is IItem -> True 
```

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2014-07-11T09:52:08.983

我用了

`Assert.IsTrue(myObject is ImyInterface);`

对于我的单元测试中的一个测试，它测试 myObject 是一个实现了我的接口 ImyInterface 的对象。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2018-07-24T19:08:36.500

我有一种情况，我将一个变量传递给一个方法，但不确定它是一个接口还是一个对象。

目标是：

1.  如果 item 是一个接口，则基于该接口实例化一个对象，该接口是构造函数调用中的参数。
2.  如果该项目是一个对象，则返回 null，因为我的调用的构造函数需要一个接口，而我不希望代码陷入困境。

我通过以下方式实现了这一点：

```
 if(!typeof(T).IsClass)
    {
       // If your constructor needs arguments...
       object[] args = new object[] { my_constructor_param };
       return (T)Activator.CreateInstance(typeof(T), args, null);
    }
    else
       return default(T); 
```

* * *

## 回答 #14

> 赞同：-13
> 
> 时间：2009-01-04T02:02:27.697

这应该工作：

```
MyInstace.GetType().GetInterfaces(); 
```

但也很好：

```
if (obj is IMyInterface) 
```

甚至（不是很优雅）：

```
if (obj.GetType() == typeof(IMyInterface)) 
```

# java - 如何确保 hashCode() 与 equals() 一致？

> ID：410236
> 
> 赞同：23
> 
> 时间：2009-01-04T01:32:35.933
> 
> 标签：java, object, equals, hashcode

当覆盖 java.lang.Object 的 equals() 函数时，javadocs 建议，

> 每当重写该方法时，通常都需要重写 hashCode 方法，以维护 hashCode 方法的一般约定，即相等的对象必须具有相等的哈希码。

hashCode() 方法必须为每个对象返回一个**唯一的整数**（这在根据内存位置比较对象时很容易做到，只需返回对象的**唯一整数**地址）

应该如何覆盖 hashCode() 方法，以便它仅基于该对象的属性为每个对象返回一个**唯一的整数？**

```
 public class People{
   public String name;
   public int age;

   public int hashCode(){
      // How to get a unique integer based on name and age?
   }
}
/*******************************/
public class App{
   public static void main( String args[] ){
       People mike = new People();
       People melissa = new People();
       mike.name = "mike";
       mike.age = 23;
       melissa.name = "melissa";
       melissa.age = 24;
       System.out.println( mike.hasCode() );  // output?
       System.out.println( melissa.hashCode(); // output?
   }
} 
```

* * *

## 回答 #1

> 赞同：29
> 
> 时间：2009-01-04T01:39:43.970

它并不是说一个对象的哈希码必须是完全唯一的，只是说两个相等对象的哈希码返回相同的哈希码。让两个不相等的对象返回相同的哈希码是完全合法的。但是，哈希码分布在一组对象上的唯一性越强，您从 HashMap 和其他使用哈希码的操作中获得的性能就越好。

IntelliJ Idea 等 IDE 具有内置的 equals 和 hashCode 生成器，通常可以很好地为大多数对象提供“足够好”的代码（并且可能比一些手工制作的过于聪明的哈希函数更好）。

例如，这是 Idea 为您的 People 类生成的 hashCode 函数：

```
public int hashCode() {
    int result = name != null ? name.hashCode() : 0;
    result = 31 * result + age;
    return result;
} 
```

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-01-04T01:48:43.047

我不会深入讨论 hashCode 唯一性的细节，因为 Marc 已经解决了它。对于您的`People`班级，您首先需要确定一个人的平等意味着什么。也许平等仅仅基于他们的名字，也许它基于名字和年龄。它将是特定领域的。假设平等基于姓名和年龄。你的覆盖`equals`看起来像

```
public boolean equals(Object obj) {
    if (this==obj) return true;
    if (obj==null) return false;
    if (!(getClass().equals(obj.getClass())) return false;
    Person other = (Person)obj;
    return (name==null ? other.name==null : name.equals(other.name)) &&
        age==other.age;
} 
```

任何时候你覆盖`equals`你都必须覆盖`hashCode`。此外，`hashCode`在计算中不能使用更多的字段`equals`。大多数情况下，您必须添加或排除各个字段的哈希码（hashCode 计算速度应该很快）。所以一个有效的`hashCode`方法可能看起来像：

```
public int hashCode() {
    return (name==null ? 17 : name.hashCode()) ^ age;
} 
```

请注意，以下内容**无效**，因为它使用了一个`equals`没有（高度）的字段。在这种情况下，两个“等于”对象可能有不同的哈希码。

```
public int hashCode() {
    return (name==null ? 17 : name.hashCode()) ^ age ^ height;
} 
```

此外，两个不相等的对象具有相同的哈希码是完全有效的：

```
public int hashCode() {    
    return age;    
} 
```

在这种情况下，Jane 的 30 岁不等于 Bob 的 30 岁，但它们的哈希码都是 30。虽然有效，但对于基于哈希的集合的性能而言，这是不可取的。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2009-01-04T03:23:53.040

另一个问题询问是否有一些所有程序员都应该知道的基本低级事物，我认为哈希查找就是其中之一。所以这里。

哈希表（注意我没有使用实际的类名）基本上是一个链表数组。要在表中查找某些内容，您首先计算该内容的哈希码，然后根据表的大小对其进行修改。这是数组的索引，您会在该索引处获得一个链表。然后遍历列表，直到找到对象。

由于数组检索是 O(1)，而链表遍历是 O(n)，因此您需要一个散列函数来创建尽可能随机的分布，以便将对象散列到不同的列表中。每个对象都可以返回值 0 作为其哈希码，哈希表仍然可以工作，但它本质上是数组元素 0 处的长链表。

您通常还希望数组很大，这会增加对象位于长度为 1 的列表中的机会。例如，当映射中的条目数大于 75 时，Java HashMap 会增加数组的大小数组大小的 %。这里有一个权衡：你可以有一个巨大的数组，只有很少的条目并浪费内存，或者一个较小的数组，其中数组中的每个元素都是一个具有 > 1 个条目的列表，并且浪费时间遍历。完美的散列会将每个对象分配到数组中的唯一位置，不会浪费空间。

术语“完美散列”是一个真正的术语，在某些情况下，您可以创建一个散列函数，为每个对象提供一个唯一编号。这只有在您知道所有可能值的集合时才有可能。在一般情况下，您无法实现这一点，并且会有一些值返回相同的哈希码。这是简单的数学运算：如果您的字符串长度超过 4 个字节，则无法创建唯一的 4 字节哈希码。

一个有趣的花絮：哈希数组的大小通常基于质数，以便在您修改结果时为随机分配提供最佳机会，而不管哈希码的真正随机性如何。

根据评论编辑：

1) 链表不是表示具有相同哈希码的对象的唯一方法，尽管这是 JDK 1.5 HashMap 使用的方法。尽管内存效率比简单数组低，但可以说它在重新散列时确实会产生更少的流失（因为条目可以从一个存储桶中取消链接并重新链接到另一个存储桶）。

2) 从 JDK 1.4 开始，HashMap 类使用大小为 2 的幂的数组；在此之前，它使用 2^N+1，我认为它是 N <= 32 的质数。这本身并不能加速数组索引，但确实允许使用按位与而不是除法来计算数组索引，正如尼尔科菲所指出的那样。就个人而言，我认为这是过早的优化，但鉴于 HashMap 上的作者列表，我会假设有一些真正的好处。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-04T08:48:43.103

一般来说，哈希码不能是唯一的，因为有比可能的哈希码（整数）更多的值。一个好的哈希码可以很好地将值分布在整数上。一个坏的总是可以给出相同的值并且在逻辑上仍然是正确的，它只会导致不可接受的低效哈希表。

相等的值必须具有相同的哈希值，哈希表才能正常工作。否则，您可以向哈希表添加一个键，然后尝试通过具有不同哈希码的相等值来查找它，但找不到它。或者您可以使用不同的哈希码放置一个相等的值，并在哈希表的不同位置有两个相等的值。

在实践中，您通常会在 hashCode() 和 equals() 方法中选择要考虑的字段子集。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-04T01:46:50.723

我想你误会了。哈希码不必对每个对象都是唯一的（毕竟，它是一个哈希码），尽管您显然不希望它对所有对象都相同。但是，您确实需要它与所有相等的对象相同，否则标准集合之类的东西将不起作用（例如，您会在哈希集中查找某些内容但找不到它）。

对于简单的属性，一些 IDE 具有哈希码函数构建器。

如果您不使用 IDE，请考虑使用 Apahce Commons 和 HashCodeBuilder 类

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-10-18T22:33:08.093

hashCode 的唯一合同义务是使其**保持一致**。用于创建 hashCode 值的字段必须与 equals 方法中使用的字段相同或子集。这意味着为所有值返回 0 是有效的，尽管效率不高。

可以通过单元测试检查 hashCode 是否一致。我编写了一个名为[EqualityTestCase](http://www.theeggeadventure.com/wikimedia/index.php/EqualityTestCase)的抽象类，它执行一些 hashCode 检查。只需扩展测试用例并实现两三个工厂方法即可。该测试对 hashCode 是否有效进行了非常粗略的测试。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2010-01-02T15:17:24.240

这就是文档告诉我们的哈希码方法

@javadoc

> Whenever it is invoked on the same object more than once during an execution of a Java application, the hashCode method must consistently return the same integer, provided no information used in equals comparisons on the object is modified. This integer need not remain consistent from one execution of an application to another execution of the same application.

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2010-12-18T19:58:00.237

There is a notion of business key, which determines uniqueness of separate instances of the same type. Each specific type (class) that models a separate entity from the target domain (e.g. vehicle in a fleet system) should have a business key, which is represented by one or more class fields. Methods equals() and hasCode() should both be implemented using the fields, which make up a business key. This ensures that both methods consistent with each other.

# c# - 从表单中检索数据的适当方法

> ID：410241
> 
> 赞同：0
> 
> 时间：2009-01-04T01:35:51.230
> 
> 标签：c#, .net

C# 和 .NET 的新手。

在 Windows 应用程序中，我放置了一个表单来查询用户的某些输入。用户填写表格并按“确定”。

从表单中检索数据的“正确”或“适当”方法是什么？表格有退货声明吗？我要发消息吗？

提前致谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-04T01:45:32.490

这个问题在 SO 上的提问形式略有不同；请[在此处](https://stackoverflow.com/questions/280579/c-beginner-help-how-do-i-pass-a-value-from-a-child-back-to-the-parent-form#280586)查看我的答案。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-04T01:43:33.697

您可以让父表单订阅来自子表单的事件并仍然执行相同的操作或将表单结果放入事件 arg 语句

你应该听按钮的点击事件，你会得到一个回调，你可以简单地从表单对象（txtBox.Text等）中读取属性

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-04T01:46:12.647

在他们按下 OK 后，表单将关闭，但是（只要表单变量仍在范围内），其成员仍将包含所有数据。将输入保存到成员变量并使用访问器从主程序访问它。如果表单不是模态的，您的主程序可以订阅表单关闭事件并获取信息。

# mysql - 允许一台服务器上的 MySQL 侦听来自其他两台不同服务器的请求的最佳方法是什么？

> ID：410243
> 
> 赞同：1
> 
> 时间：2009-01-04T01:36:28.857
> 
> 标签：mysql, my.cnf

我在服务器 1 上有我的 MySQL 数据库服务器。我想让我的 Rails 应用程序在另外两台服务器上——比如 A 和 B 能够连接到服务器 1。最好的方法是什么？

在 my.cnf 文件中，我似乎可以使用绑定地址绑定到一个且只有一个 IP 地址。我无法在 my.cnf 中指定 A 和 B 的 IP 地址。

另一方面，如果我评论跳过网络，大门是敞开的。

有中庸之道吗？你们在做什么来允许数据库服务器监听来自多个应用服务器的请求并仍然保持安全？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-01-04T03:28:22.703

如果 MySQL 在 Linux 上运行：

我非常倾向于使用 iptables（又名 netfilter，Linux 防火墙）来控制传入各种端口的流量。它使用简单且非常强大。

```
iptables -A INPUT -p tcp -s server1address/32 --dport 3306 -j ACCEPT
iptables -A INPUT -p tcp -s server2address/32 --dport 3306 -j ACCEPT
iptables -A INPUT -p tcp --dport 3306 -j DROP 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-04T01:38:11.880

绑定地址是*服务器*的本地 IP 地址，而不是允许的客户端地址。在您的情况下，您可以提供服务器的静态地址（代替 localhost），或者，如果您的 IP 可能更改，只需将其注释掉。

再次澄清一下：这`bind-address`是服务器侦听客户端连接的地址（您可以有多个 NIC，或多个 IP 地址等）。也可以更改`port`您希望 mysql 收听的内容。

如果您尚未配置 root 密码，则需要确保：

```
mysql> SET PASSWORD FOR 'root'@'localhost' = PASSWORD('yourpassword'); 
```

然后，您将使用其他方法来限制对 MySql 的访问，例如本地网络（即您的防火墙）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-04T23:37:21.470

有关 iptables 的更多信息：

上面的 iptables 命令必须要么插入到现有的 iptables 表中，否则你必须删除现有的东西并从头开始使用上面的命令。

插入并不难，但它有点取决于您使用的 Linux 发行版，所以我不确定该推荐什么。

要从头开始，您需要先刷新和清除现有表：

```
iptables -F
iptables -X 
```

然后按照我之前的回答中指出的模型，插入你需要使用的 iptables 防火墙规则。

然后保存 iptables 规则。这又取决于分布。在大多数 Red Hat 衍生产品（Red Hat、Fedora、CentOS）上，运行以下代码就足够了：

```
service iptables save 
```

瞧，您的自定义规则已保存。如果启用了 iptables 服务（使用“chkconfig --list iptables”检查，根据您的情况，它必须在运行级别 3 和 5 上为“:on”，但在 3 和 5 上都设置为“:on”是安全的无论如何）那么您的规则将在重新启动后继续存在。

您可以随时查看当前运行的 iptables 规则。以下是一些执行此操作的命令，其详细程度各不相同：

```
iptables -L
iptables -L -n
iptables -L -n -v 
```

如果没有 -n，它将尝试查找域名并显示它们而不是 IP 地址 - 如果 DNS 无法 100% 完美运行，这可能是不可取的。所以这就是为什么我几乎总是使用-n。

-v 表示“冗长”，有点难以阅读，但它提供了更多信息。

注意：如果您从头开始，该机器上运行的其他服务可能不再受 iptables 保护。花一些时间弄清楚如何在现有表中插入 MySQL 规则。这对您的系统安全性更好。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-04T01:40:48.817

数据库服务器将监听无限数量的客户端。

每个客户端 Rails 应用程序都标识数据库服务器。

DB 服务器耐心等待连接。它不知道有多少客户端或连接来自哪里。

**编辑**

“你如何安全地配置数据库 wrt 接受来自哪些服务器的请求？”

这就是网络、防火墙和路由器的用途。

这就是数据库需要来自 Rail 应用程序的凭据的原因。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-04T01:43:16.427

除了获得正确的绑定地址之外，您还需要打开正确的端口、创建或配置用户以及其他一些细节。[这](http://www.cyberciti.biz/tips/how-do-i-enable-remote-access-to-mysql-database-server.html)解释得很清楚。

# linux - 如何在嵌入式设备上实现 Web 服务？

> ID：410253
> 
> 赞同：1
> 
> 时间：2009-01-04T01:44:47.327
> 
> 标签：linux, security, soap, embedded, gsoap

我们有一个需要与企业软件系统交互的嵌入式设备。

企业系统当前使用许多不同的机制在其组件之间进行通信：ODBC、RPC、基于 TCP/IP 的专有协议，并且正在转向 .Net 实现的 Web 服务。

嵌入式设备运行 *nix 风格，所以我们正在研究最好的交互机制是什么。

通讯要求如下：

*   必须通过 TCP/IP 运行。*   还必须通过 RS-232 或 USB 运行。*   必须是安全的（例如 HTTPS 或 SSL）。*   必须能够传输约 32MB 的数据。

    [我们目前最好的选择是 gSOAP](http://www.cs.fsu.edu/~engelen/soap.html)。

    有没有人在 SO-land 有任何其他建议？

    **编辑：**史蒂文的回答给了我最新的指示。谢谢大家！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-04T01:54:57.870

您可以定义使用 HTTPS（根据定义使用 TCP/IP）的 RESTful 服务，并且能够传输任意数量的数据。

REST 优于 SOAP 的优势在于 REST 更简单。它可以使用 JSON 而不是更简单的 XML。

它的开销比 SOAP 协议少。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-04T02:50:33.983

你不能只使用 SSL over TCP 吗？

如果您有某种 *nix（我猜？它是 QNX 或嵌入式 linux，对吗？）它应该可以通过以太网、USB 和 RS232 开箱即用地工作。保持简单。

32mb 对于这项任务来说已经足够了。我会分配 2 到 4 mb 的内存用于网络和加密（代码 + 数据）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-04T03:21:31.237

目前还不清楚为什么要将它与 SOAP 之类的远程过程调用协议联系起来。还有其他你没有提到的要求吗？

不过，一般来说，使用普通的基于 Web 的服务可以很容易地处理这类事情。您可以获得用 C 编写的非常轻量级的 http 处理器；[有关其中一些的比较，请参阅此 Wikipedia 文章](http://en.wikipedia.org/wiki/Tiny_web_servers)。然后一个 REST 接口就可以正常工作了。也有将 USB 视为 TCP 连接的网络接口。

如果您必须能够通过 RS232 运行，您可能想看看其他地方；在这种情况下，像 sftp 这样的东西可能会做得更好。或者编写一个可以在加密连接上运行的简单应用层协议。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-05T12:43:47.293

如果您打算使用 RS232 连接您的应用程序，我假设您将使用 PPP 将设备连接到互联网。但是，您建议传输的数据量有些令人担忧。大多数 RS232 连接限制为 115200 波特，忽略 TCP/IP/PPP 帧所需的开销将产生最多每秒 11,000 字节的传输速率。这意味着至少需要大约 2800 秒或 46 分钟才能进行您想要的任何传输。

# c# - 你能锁定一个通用字典吗？

> ID：410270
> 
> 赞同：6
> 
> 时间：2009-01-04T01:51:32.447
> 
> 标签：c#, multithreading, generics, dictionary, locking

或者你应该总是创建一些其他的锁对象？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-01-04T01:54:43.843

是的，将其转换为 IDictionary 并锁定`.SyncRoot`：

```
Generic.Dictionary<int, int> dic = new Generic.Dictionary<int, int>();

lock (((IDictionary)dic).SyncRoot)
{
    // code
} 
```

感谢此信息[来源](http://en.csharp-online.net/CSharp_Generics_Recipes%E2%80%94Replacing_the_Hashtable_with_Its_Generic_Counterpart)。

当然，正如其他人所建议的那样，线程安全字典也会很好。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-04T01:55:42.907

您可以锁定您希望的任何对象（值类型除外）。**建议**锁定 .SyncRoot 对象。

# python - 在 Python 中实现类似缓冲区的结构

> ID：410273
> 
> 赞同：2
> 
> 时间：2009-01-04T01:53:27.733
> 
> 标签：python, multithreading, data-structures, message-queue

我正在尝试编写一个小型 wsgi 应用程序，它将在每次请求后将一些对象放入外部队列。我想批量制作，即。使网络服务器将对象放入内存中的类似缓冲区的结构中，并在缓冲区足够大或特定超时后将这些对象批量发送到队列的另一个线程和/或进程，并清除缓冲区。我不想陷入 NIH 综合症，也不想打扰线程的东西，但是我找不到适合这项工作的代码。有什么建议么？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-01-04T02:03:01.520

检查[https://docs.python.org/library/queue.html](https://docs.python.org/library/queue.html)以查看它是否满足您的需求。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-04T02:48:00.290

由于您编写“线程和/或*进程*”，另请参阅2.6 中的[multiprocessing.Queue 和 multiprocessing.JoinableQueue](http://docs.python.org/library/multiprocessing.html#pipes-and-queues)。这些是队列的进程间变体。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-06T18:00:00.603

如果您使用的是 python 3.0，请使用[缓冲流。](http://docs.python.org/3.0/library/io.html#io.BufferedIOBase)

# iphone - 将 CGPoint 从 UIView 坐标系转换为 CALayer 坐标系

> ID：410278
> 
> 赞同：11
> 
> 时间：2009-01-04T01:57:21.657
> 
> 标签：iphone, cocoa-touch, core-animation

有一些方法可以将 CGPoint 从一个 UIView 传输到另一个 UIView 以及从一个 CALayer 传输到另一个。我找不到将 CGPoint 从 UIView 的坐标系更改为 CALayer 的坐标系的方法。

图层和它的宿主视图是否具有相同的坐标系？我需要在它们之间转换点吗？

谢谢，科里

[编辑]

感谢你的回答！很难找到有关 iPhone 和 Mac 上 CA 之间差异/相似之处的信息。我很惊讶我无法在任何 Apple 文档中直接解决这个问题。

我一直在寻求这个答案以帮助解决我正在排除故障的错误，这是迄今为止我最好的猜测，但我想我是在叫错树。如果坐标系相同，那么我还有另一个问题......

我遇到的实际问题可以在 Stack Overflow 上找到： [层命中测试仅在触摸层的下半部分时返回层](https://stackoverflow.com/questions/401040/layer-hit-test-only-returning-layer-when-bottom-half-of-layer-is-touched#414024)

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-02-25T20:05:46.403

hitTest 的文档说：

```
/* Returns the farthest descendant of the layer containing point 'p'.
 * Siblings are searched in top-to-bottom order. 'p' is in the
 * coordinate system of the receiver's superlayer. */ 
```

所以你需要做（这样的事情）：

```
CGPoint thePoint = [touch locationInView:self];
thePoint = [self.layer convertPoint:thePoint toLayer:self.layer.superlayer];
CALayer *theLayer = [self.layer hitTest:thePoint]; 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-07-30T20:11:56.243

在 Apple 文档方面，我在[Core Animation Programming Guide](http://developer.apple.com/iphone/library/documentation/Cocoa/Conceptual/CoreAnimation_guide/Articles/Layers.html "核心动画编程指南") (2008-11-13) 的 Layer Coordinate System 部分找到了“iPhone OS Note”。

> UIView 实例的默认根层使用与 UIView 实例的默认坐标系匹配的翻转坐标系——原点在左上角，值向下和向右增加。通过实例化 CALayer 创建的图层直接使用标准的核心动画坐标系。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-01-05T01:56:39.427

`transform`如果要翻转坐标系，可以将 CALayers 的属性设置为适当的变换，但请注意，这也可能会翻转他们的绘图`contents`（我没有测试过，但这是有道理的） . 我断言与 UIView 关联的 CALayer 共享相同的坐标系实际上可能是完全错误的。也可能是 CALayers 使用与 UIViews 相同的坐标系（即它们从不垂直翻转），但我认为它们是因为 CoreGraphics 使用相对于 UIKit 的翻转坐标系。

一个简单的测试方法是添加一个屏幕大小的 CALayer 作为视图层的子层，然后添加另一个小的 CALayer 作为其子层。您可以将其设置为显示在 (0, 0, 320, 100) 并查看它是显示在 iPhone 屏幕的顶部还是底部。这将告诉您 CoreAnimation 的 Y 轴方向。

```
- (void)viewDidLoad {
  [super viewDidLoad];
  CALayer *rootLayer = [CALayer layer];
  rootLayer.frame = self.view.layer.bounds;
  CALayer *smallLayer = [CALayer layer];
  smallLayer.frame = CGRectMake(0, 0, rootLayer.bounds.size.width, 50);
  smallLayer.backgroundColor = [UIColor blueColor].CGColor;
  [rootLayer addSublayer:smallLayer];
  [self.view.layer addSublayer:rootLayer];
} 
```

我自己刚刚进行了这个测试，看起来 CALayer 实际上使用与 UIViews 相同的坐标系，所以我断言 CALayer 翻转 Y 轴肯定是错误的。但是，如果您直接使用 CoreGraphics 进行绘图，请注意 CoreGraphics*确实*使用翻转的 Y 轴（尽管在 UIView 子类或我假设 CALayer 委托中绘制时，CoreGraphics 上下文已经被翻转以匹配 UIView 的（或CALayer 的）坐标系）。

所以简短的回答，如果你做到了这一步，CALayer 的坐标系应该与其对应的 UIView 的坐标系相匹配。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-03-30T15:08:35.843

从我的测试中，我发现子图层与其父图层共享相同的坐标系，因此如果您将子图层添加到 UIView 图层，那么它们将共享相同的坐标系。

如果您仍想翻转坐标系，使其原点位于左上角，则应使用翻转 y 轴的转换。(x,y,1) = (x', y', 1) * [1 0 0],[0 -1 0],[0 高度 1]

翻译成代码的是：[your_layer setAffineTransform:CGAffineTransformMake(1,0,0,-1,0,heigth)];

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-05T00:02:54.583

我相信 UIView 及其关联层的坐标系应该是相同的。但是，如果您自己创建图层，则坐标系会垂直翻转。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-07-05T14:30:07.713

```
Methods that fixing frames and points
- (CGRect) fixRect:(CGRect)rect inRect:(CGRect)container
{
    CGRect frame = rect;
    frame.origin.y = container.size.height - frame.origin.y - frame.size.height;
    return frame;
}
- (CGPoint) fixPoint:(CGPoint)point fromPoint:(CGSize)containerSize
{
    CGPoint frame = point;
    frame.y = size.height - frame.y;
    return frame;
} 
```

# gwt - Google Web Tookit 用户扩展缺少 Spinner？

> ID：410279
> 
> 赞同：1
> 
> 时间：2009-01-04T01:57:41.217
> 
> 标签：gwt, gwt-ext

当我查看 GWT-Ext 的用户扩展示例时，我将 Spinner 视为用户扩展： http: [//www.gwt-ext.com/demo-ux/#spinner](http://www.gwt-ext.com/demo-ux/#spinner)

[当我从http://code.google.com/p/gwt-ext-ux/downloads/list](http://code.google.com/p/gwt-ext-ux/downloads/list)下载库（我下载了最新版本——0.3.0）时，它似乎不包含 Spinner 类。

谁能指出我如何使用它的正确方向？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-01-07T21:03:15.007

这是讨论 Spinner 的线程。第一篇文章底部有一些下载链接。

[http://extjs.com/forum/showthread.php?t=16352](http://extjs.com/forum/showthread.php?t=16352)

# ssl - Windows 2000/ASP/IIS 的愚蠢 SSL 证书问题

> ID：410302
> 
> 赞同：1
> 
> 时间：2009-01-04T02:17:30.773
> 
> 标签：ssl, windows-server-2000

我有一个我认为是我的域的 ssl 证书，我想将它应用于该域中的两个单独的应用程序，这些应用程序在 Windows 2000 上的 IIS 中的 ASP 经典下运行。

我有以下愚蠢的问题：

1.  是否为 URL 或域颁发了证书？还是子域？
2.  我可以为该域中的多个网站（应用程序）使用相同的证书，还是需要一个单独的证书？
3.  我可以检查证书文件以确定它是颁发给什么或颁发给谁的吗？

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-04T02:31:44.800

1) Web 证书颁发给域。具体来说，证书的 CN 属性必须与用于访问您的站点的域匹配。

2）证书通常是按主机（或虚拟主机）安装的。如果您拥有域 wwwapps.domain.tld 的证书，您可以在 /calendar 拥有一个应用程序，在 /contacts 拥有一个应用程序。

3) 是的，根据格式和位置，这可能容易或困难。如果你有一个 crt 文件并且你在 windows 下运行，只需点击它。你应该看到细节。

如果要检查安装在站点上的证书，通常必须单击挂锁图标。

在 Windows 上，您还可以打开 MMC，添加证书管理单元并查看本地计算机上的任何/所有已安装证书或您的配置文件。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-04T02:30:23.430

1.  它们是为域发行的。子域需要自己的证书。您可以为您的域购买一个特殊的通配符证书，以便为您的子域创建证书，但它们更昂贵。

2.  [如果您为 mydomain.com 购买证书，则可以将其用于以https://mydomain.com/](https://mydomain.com/)开头的任何内容

3.  是的。您可以对任何证书执行此操作。查看浏览器地址栏中的锁定图标。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-04T03:09:57.220

它通常发布到单个 Web 服务器主机（基本上是计算机 cname 或记录），例如 foo.bar.com，其中 foo 是为其生成证书请求的主机的一个名称，而 bar.com 是其域。

因此，它适用于任何响应[https://foo.bar.com](https://foo.bar.com)的应用程序或虚拟目录- 例如[https://foo.bar.com/planner/](https://foo.bar.com/planner/) - 但仅此而已。

对于 https://*.bar.com，您可以获得通配符证书，让您无需任何麻烦即可处理任意数量的主机 - 成本更高。

还有多个 SAN (UCC) 证书可以在单个证书中包含特定数量的主机名，例如 webmail.bar.com 和 autodiscover.bar.com，用于同时提供 Web 访问和 Outlook Anywhere 的 Exchange 2007 服务器物理机和网卡。

如果它是 .cer 格式，只需在 Windows 中打开它就会显示详细信息，如果它是 pfx 或其他传输格式，则需要导入它。

您基本上将证书安装在 IIS 中的网站节点上，并且您可以在该节点下安装的任何内容（或使用其前面的现代防火墙进行修改以仍响应已发布的通用名称 foo.bar.com）都将起作用。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-04T03:10:05.923

谢谢！我在证书上为域中的站点启用了端口 443，通过 IIS 中的目录安全性为每个子文件夹加载了证书，并启用了 128 位加密。像冠军一样工作！

# iphone - 如何使用 Core Graphics 渲染到屏幕外位图然后 blit 到屏幕

> ID：410313
> 
> 赞同：19
> 
> 时间：2009-01-04T02:30:53.023
> 
> 标签：iphone, bitmap, core-graphics, bitblit

我想渲染到屏幕外位图（或 RGBA 值数组），然后`UIView`在视图`drawRect`函数中将这些位图 blit 到 a during 。我更愿意进行完整的 32 位渲染（包括 alpha 通道），但也对 24 位渲染感到满意。

有人介意用一些代码片段或相关 API 为我指明正确的方向吗？

此外，我确切地知道如何使用 OpenGL 来完成这项工作——我更愿意在 Core Graphics 本身中完成这项工作。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-12-26T09:17:49.257

要渲染到屏幕外上下文并将其保存为 CGImageRef：

```
void *bitmapData = calloc(height, bytesPerLine);
CGContextRef offscreen = CGBitmapContextCreate(..., bitmapData, ...)
// draw stuff into offscreen
CGImageRef image = CGBitmapContextCreateImage(offscreen);
CFRelease(offscreen);
free(bitmapData); 
```

在屏幕上绘制它：

```
- (void)drawRect:(CGRect)rect {
    CGContextRef context = UIGraphicsGetCurrentContext();
    CGContextDrawImage(context, rect, image);
} 
```

您也可以将图像保存在视图层的内容属性 ( `view.layer.contents = image`) 中，或使用 UIImageView。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-04T04:41:39.263

您可以使用[CGBitmapContext](http://developer.apple.com/documentation/GraphicsImaging/Reference/CGBitmapContext/Reference/reference.html)。您可以从 CGBitmapContext 生成图像并在 drawRect 期间绘制它。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-18T07:53:40.300

如果您不需要位图上下文而只`CGDataProviderCreateWithData`需要.`CGImageCreate``CGImageRef`

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2016-08-24T09:19:11.423

为了将来参考，这里是 Swift 2.1 中渲染到屏幕外位图并将其显示在屏幕上的完整示例。

请注意，一旦创建了位图上下文，您就可以继续在其中绘制更多内容，并在需要时更新视图。如果您想在后台线程上执行冗长的绘图操作并定期向用户显示进度，这非常有用。

**视图控制器：**

```
import UIKit

class ViewController: UIViewController {
    @IBOutlet var myView: MyView!
    var bitmapContext: CGContext?

    override func viewDidLoad() {
        super.viewDidLoad()
        createBitmapContext()
        drawContentIntoBitmap()
        myView.update(from: bitmapContext)
        releaseBitmapContext()
    }

    func createBitmapContext() {
        bitmapContext = CGBitmapContextCreate(
            nil,                                                        // auto-assign memory for the bitmap
            Int (myView.bounds.width * UIScreen.mainScreen().scale),    // width of the view in pixels
            Int (myView.bounds.height * UIScreen.mainScreen().scale),   // height of the view in pixels
            8,                                                          // 8 bits per colour component
            0,                                                          // auto-calculate bytes per row
            CGColorSpaceCreateDeviceRGB(),                              // create a suitable colour space
            CGImageAlphaInfo.PremultipliedFirst.rawValue)               // use quartz-friendly byte ordering
    }

    func drawContentIntoBitmap() {
        CGContextScaleCTM(bitmapContext, UIScreen.mainScreen().scale, UIScreen.mainScreen().scale)  // convert to points dimensions
        CGContextSetStrokeColorWithColor (bitmapContext, UIColor.redColor().CGColor)
        CGContextSetLineWidth (bitmapContext, 5.0)
        CGContextStrokeEllipseInRect (bitmapContext, CGRectMake(50, 50, 100, 100))
    }

    func releaseBitmapContext() {
        bitmapContext = nil // in Swift, CGContext and CGColorSpace objects are memory managed by automatic reference counting
    }
} 
```

**UIView 的子类：**

```
import UIKit

class MyView: UIView {     
    var cgImage: CGImage?

    func update(from bitmapContext: CGContext?) {
        cgImage = CGBitmapContextCreateImage(bitmapContext)
        setNeedsDisplay()
    }

    override func drawRect(rect: CGRect) {
        let displayContext = UIGraphicsGetCurrentContext()
        CGContextDrawImage(displayContext, bounds, cgImage)
    }

} 
```

# java - Java是用什么写的？

> ID：410320
> 
> 赞同：48
> 
> 时间：2009-01-04T02:47:08.607
> 
> 标签：java, jvm

Sun 是用什么语言`JVM`写的？

* * *

## 回答 #1

> 赞同：41
> 
> 时间：2009-01-04T13:23:01.147

Sun 实际上有多个 JVM。[HotSpot JVM](http://OpenJDK.Java.Net/groups/hotspot/)主要是用 C++ 编写的，因为 HotSpot 很大程度上基于[用 C++ 编写的](http://Code.Google.Com/p/strongtalk/source/browse/#svn/trunk/vm)[Animorphic Smalltalk VM](http://Strongtalk.Org/)。

恕我直言，比 HotSpot 更有趣的是[Maxine Research VM](http://Research.Sun.Com/projects/maxine/)，它[（几乎）完全用 Java 编写](http://Kenai.Com/projects/maxine/sources/maxine/show)。

* * *

## 回答 #2

> 赞同：25
> 
> 时间：2009-01-04T04:06:21.130

严格来说，C++（JVM 代码确实使用了 C++ OO 工具）。

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2009-01-04T08:22:23.733

您可以通过以下网址自行了解：http: [//www.sun.com/software/opensource/java/](http://www.sun.com/software/opensource/java/)。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2009-01-04T02:48:45.263

C。

Sun 不是 Java 商店。这是一家C店。这就是 Solaris 的编写方式。

# c# - 将文本写入文件中间

> ID：410324
> 
> 赞同：4
> 
> 时间：2009-01-04T02:50:26.540
> 
> 标签：c#

有没有办法可以从文件中的某个点将文本写入文件？

例如，我打开一个包含 10 行文本的文件，但我想在第 5 行写入一行文本。

我想一种方法是使用 readalllines 方法将文件中的文本行作为数组返回，然后在数组中的某个索引处添加一行。

但是有一个区别，有些集合只能将成员添加到末尾，而有些则可以添加到任何目的地。仔细检查一下，数组总是允许我在任何索引处添加一个值，对吧？（我敢肯定我的一本书说的是其他明智的）。

另外，有没有更好的方法来解决这个问题？

谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-04T02:56:20.803

唉，叹息。查找“主文件更新”算法。

这是伪代码：

```
open master file for reading.
count := 0
while not EOF do
    read line from master file into buffer
    write line to output file    
    count := count + 1
    if count = 5 then
       write added line to output file
    fi
od
rename output file to replace input file 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-04T02:54:51.133

如果您正在读取/写入小文件（例如，小于 20 兆字节——是的，我认为 20M“小”）并且不经常写入它们（例如，不是每秒几次），那么只需读取/写入整个文件。

像文本文档这样的串行文件不是为随机访问而设计的。这就是数据库的用途。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-04T04:50:36.143

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;

public class Class1
{                     
    static void Main()
    {
        var beatles = new LinkedList<string>();
        beatles.AddFirst("John");                        
        LinkedListNode<string> nextBeatles = beatles.AddAfter(beatles.First, "Paul");
        nextBeatles = beatles.AddAfter(nextBeatles, "George");
        nextBeatles = beatles.AddAfter(nextBeatles, "Ringo");

        // change the 1 to your 5th line
        LinkedListNode<string> paulsNode = beatles.NodeAt(1); 
        LinkedListNode<string> recentHindrance = beatles.AddBefore(paulsNode, "Yoko");
        recentHindrance = beatles.AddBefore(recentHindrance, "Aunt Mimi");
        beatles.AddBefore(recentHindrance, "Father Jim");

        Console.WriteLine("{0}", string.Join("\n", beatles.ToArray()));
        Console.ReadLine();                       
    }
}

public static class Helper
{
    public static LinkedListNode<T> NodeAt<T>(this LinkedList<T> l, int index)
    {
        LinkedListNode<T> x = l.First;

        while ((index--) > 0) x = x.Next;

        return x;
    }
} 
```

# web-applications - 注册过程中的图像到文本

> ID：410339
> 
> 赞同：4
> 
> 时间：2009-01-04T03:10:02.320
> 
> 标签：web-applications

我正在接受网络开发的培训。我在大多数网站上看到注册新用户时它显示一个图像并告诉用户输入图像中的字符。我不知道这个过程有什么用？这背后有什么原因吗？

谢谢。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-01-04T03:14:18.740

这个想法是验证登录到网站的实体实际上是一个人而不是一个程序。这个*东西*被称为[CAPTCHA](http://en.wikipedia.org/wiki/Captcha)，代表“完全自动化的公共图灵测试，以区分计算机和人类”。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-04T03:14:38.223

它避免了自动过程。仅此而已。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-04T16:31:10.970

验证码（如上所述）用作防止网络爬虫和垃圾邮件机器人在遍历网络时自动提交表单的方法。验证码旨在确保它实际上是键盘后面输入表单的人，因为自动机器人通常无法破译图像中的文本。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-04T16:36:12.880

实施 CAPTCHA 时，一定不要像这个网站一样：http: [//bebotechnologies.com/apply1.php](http://bebotechnologies.com/apply1.php)

如果您查看源代码，您可以在纯文本中看到它！

# windows-xp - 活动桌面恢复

> ID：410342
> 
> 赞同：0
> 
> 时间：2009-01-04T03:10:37.030
> 
> 标签：windows-xp

这对我来说是新的。

我下载并安装了 VB.Net 3.5 版更新，并收到了一些关于我的打印机驱动程序的投诉，但我忽略了这些。我的系统在没有询问的情况下自动重启，然后出现了“Active Desktop Recovery”背景屏幕（一切仍然正常）。因此，当我尝试“恢复我的活动桌面”（背景屏幕上的一个按钮）时，它声称脚本错误。

好吧，好吧，反正我没有使用活动桌面，所以我决定把它关掉。转到显示属性窗口，然后 WTF！桌面选项卡不见了！

有人知道解决方法，甚至是解决方法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-01-04T03:24:21.963

听起来像是恶意软件，可能试图隐藏它对您的桌面所做的任何更改并阻止您撤消它们。试一试您最喜欢的反恶意软件。

之后，要恢复选项卡并修复恢复按钮，有几个 MSKB：[929200](http://support.microsoft.com/kb/922370)和[929200](http://support.microsoft.com/?kbid=929200)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-08-18T00:36:15.290

将键 HKEY_CURRENT_USER\Software\Microsoft\Internet Explorer\Desktop\SafeMode\Components 中的值 DeskHtmlVersion 下的十进制值设置为 0。

# java - 在 Java 中验证反射方法返回类型和参数

> ID：410343
> 
> 赞同：0
> 
> 时间：2009-01-04T03:10:55.813
> 
> 标签：java, reflection, types, closures, callback

我有一个通用的回调对象，它为 Java 提供（原始）回调功能，在没有闭包的情况下。Callback 对象包含一个 Method，并通过几个访问器方法返回该方法的参数和返回类型，这些访问器方法只是委托给 Method 中的等效方法。

我正在尝试验证为我提供的回调是否指向有效方法。我需要与 Number 兼容的返回类型赋值以及与 Double 兼容的所有参数。我的验证方法如下所示：

```
static public void checkFunctionSpec(Callback cbk) {
    Class[]                             prms=cbk.getParmTypes();
    Class                               ret =cbk.getReturnType();

    if(!Number.class.isAssignableFrom(ret)) {
        throw new IllegalArgumentException(
           "A function callback must return a Number type " + 
           "(any Number object or numeric primitive) - function '" +
           cbk + "' is not permitted");
        }
    for(Class prm: prms) {
        if(!Double.class.isAssignableFrom(prm)) {
            throw new IllegalArgumentException(
               "A function callback must take parameters of " +
               "assignment compatible with double " +
               "(a Double or Float object or a double or float primitive) " +
               "- function '" + cbk + "' is not permitted");
            }
        }
    } 
```

我遇到的问题是，当我尝试使用例如 Math.abs() 时，它会为返回类型抛出异常，如下所示：

```
java.lang.IllegalArgumentException:
A function callback must return a Number type (any Number object or numeric primitive)
- function 'public static double java.lang.Math.abs(double)' is not permitted 
```

这让我感到惊讶，因为我希望原语能够简单地工作，因为 (a) 它们使用它们的包装类来反映，并且 (b) Double.TYPE 被声明为 Class<Double> 类型。

有谁知道我如何在不修改我的支票的情况下实现这一目标：

```
if(!Number.class.isAssignableFrom(ret)
     && ret!=Double.TYPE
     && ret!=Float.TYPE
     && ret!=...) { 
```

* * *

## 澄清

当您`double abs(double)`使用 Method.invoke() 调用该方法时，您传入一个 Object[]{Double} 并返回一个 Double。但是，我的验证似乎失败了，因为 Double.TYPE 不能分配给 Double。由于我要求所有这些回调返回某种数字，这将由 invoke() 作为数字返回，因此我试图验证提供的方法是否返回数字或数字原语。

参数的验证也是如此。

换句话说，当使用反射时，参数和返回类型 Double 和 double 是相同的，我想这样*轻松地*验证它们。

编辑：进一步澄清：我想验证一个方法是否会在调用 invoke() 时返回一个 Number 类型的对象（我可以从中调用 obj.doubleValue() 来获得我想要的双精度）。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-04T03:17:36.330

为什么不让编译器来做呢？

```
public interface F<A, B> {
   public B $(A a);
} 
```

然后，您可以将 an 传递`F<Double, Double>`给需要`F<? extends Number, ? extends Number>`.

**编辑：**

您说您想为具有任意数量参数的函数类型提供单个类。这*可以*通过 Java 类型系统来完成。从概念上讲，每个函数只有一个参数。具有两个参数的函数等效于返回另一个函数的函数。所以这里有一个变量，它的值是一个接受两个双精度值的函数：

```
F<Double, F<Double, Double>> f; 
```

这是一个将两个双精度值传递给给定函数的方法：

```
public Double operate(F<Double, F<Double, Double>> f, double a, double b) {
   return f.$(a).$(b);
} 
```

或者，考虑一个`L<A extends L>`具有两个子类的类型，分别`C<E, T extends L<T>>`代表一个“cons”和一个终结器类型`N`：

```
public abstract class L<A extends L<A>> {  
 private L() {}  

 private static final N nil = new N();  

 public static N nil() {  
   return nil;  
 }  

 public static final class N extends L<N> {  
   private N() {}  

   public <E> C<E, N> cons(final E e) {  
     return new C<E, L>(e, this);  
   }  
 }  

 public static final class C<E, L extends L<L>> extends L<C<E, L>> {  
   private E e;  
   private L l;  

   private C(final E e, final L l) {  
     this.e = e;  
     this.l = l;  
   }  

   public E head() {  
     return e;  
   }  

   public L tail() {  
     return l;  
   }  

   public <E> C<E, C<E, L>> cons(final E e) {
     return new C<E, C<E, L>>(e, this);
   }  
 }  

} 
```

在这种情况下，您可以这样实现一个函数类型：

```
public interface F<A extends L<A>, B> {
   public B $(A args);
} 
```

以下方法需要一个带有两个`Double`参数的函数（并返回 a `Double`），以及`double`将其应用于的两个 s：

```
public Double operate(F<C<Double, C<Double, N>>, Double> f, double a, double b) {
   return f.$(N.nil().cons(b).cons(a));
} 
```

接口的实现`F`必须使用`head`和从列表中获取参数`tail`。因此，实际上，您是在 Java 中实现 LISP。:)

话虽如此，请查看[Functional Java](http://functionaljava.org/)，这是一个已经包含很多此类内容的库。我敢肯定还有一个使用反射的，所以你不必自己写。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-04T06:38:42.867

更仔细地查看 Class.isAssignableFrom() 的文档，它明确指出基元的类型不匹配除自身之外的任何类。因此，我需要专门检查 == 与 Byte.TYPE、Double.TYPE、Float.TYPE、Integer.TYPE、Long.TYPE 和 Short.TYPE 的返回类型是否相等。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-04T04:22:07.400

Math.abs() 的参数是双原语。我不太确定基元与对象“赋值兼容”是什么意思（反射 API 本质上的意思是“可以转换”）。但是，如果您的意思是“可以传递给 Double 构造函数”，那么这本质上是一个原始双精度（或字符串）！也许您需要澄清一下您需要做什么？

# ruby-on-rails - 从视图中将照片添加到模型的 has_many 模型

> ID：410355
> 
> 赞同：1
> 
> 时间：2009-01-04T03:18:08.903
> 
> 标签：ruby-on-rails

我有一个模型，Thing，它有一个带 ThingPhoto 的 has_many，使用 Paperclip 来管理所有内容。在事物的“显示”视图中，我想要上传文件，并让它与事物模型相关。

出于某种原因，我完全不知道该怎么做。我试过这样做（Haml）：

```
- form_for @thing.thing_photos, :html => {:multipart => true} do |f|
  = f.file_field :photo
  = f.submit 
```

...我得到这个错误：

```
undefined method `array_path' for #<ActionView::Base:0x24d42b4> 
```

谷歌让我失望了。我确信这非常容易，但我就是无法理解它。

编辑：我应该提到，如果我将@thing.thing_photos 更改为@thing，它可以正常工作，因为它会显示表单，但当然它与正确的模型无关。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-04T05:19:36.693

尝试`@thing.thing_photos.new`

这应该实例化一个新的 thing_photos 模型。如果您不使用嵌套路由，则必须将 thing_id 添加为隐藏字段。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-04T03:27:03.457

如果你不依赖于 Paperclip（如果你只是在做图像），那么我在[fleximage上](http://github.com/Squeegy/fleximage/tree/master)*很*幸运。它为图像上传、操作和显示提供了非常好的文档（具有各种简洁的效果，如水印和其他东西）。

它不能完全回答你的问题，但它可能是一件很酷的事情。

但我敢打赌，您的问题与您正在为一组对象（通过关联）创建表单这一事实有关。我敢打赌，正在查找对象的类型（应该是“thing_photo”，但在您的示例中是“array”），并将“路径”附加到它以编写表单发布 URL。也许您应该添加`.first`或创建部分？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2010-01-16T20:16:06.990

该表单应该用于@thing_photo，并且应该传入 thing_id 或者如果它是嵌套路由，您可以从中获取它

然后在你的 thing_photos 控制器中

```
@thing_photo = Photo.new(params[:thing_photo])
#if using nested route
@thing = Thing.find(params[:thing_id])

#if using hidden field
@thing = Thing.find(params[:thing_photo][:thing_id])

if @thing_photo.save
  #this is what ties the thing photo to the thing
  @thing.thing_photos << @thing_photo
end 
```

如果我正确理解了这个问题，这可能会有所帮助。

# perl - 如何学习用 Perl 编写结构良好的程序？

> ID：410359
> 
> 赞同：13
> 
> 时间：2009-01-04T03:22:08.880
> 
> 标签：perl, structure

我已经开始学习 Perl，但我以前的大部分编程经验都是使用强调面向对象编程的语言，例如 C# 和 Java。我发现的所有 Perl 示例往往都是很长的单函数程序，而且我发现自己编写代码的方式也是如此。是否有任何资源或教程可用于编写可维护的结构良好的程序？

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2009-01-04T06:04:27.630

首先，无论您在做什么类型的 Perl 编程，您都可能会发现[Perl::Critic](http://search.cpan.org/perldoc?Perl::Critic)是无价的。到目前为止，命令行工具是获取代码反馈最方便的工具，但您也有一个[Web 界面](http://perlcritic.com/)，您可以在其中上传您的 Perl 代码并接收即时的自动反馈。请注意，Perl::Critic 不会教你良好的*结构*，但它会总体上帮助改进你的*风格*，并引导你远离一些常见的错误。

要使用 Perl::Critic，我建议获取一份[Perl Best Practices](http://oreilly.com/catalog/9780596001735/) (PBP)。它包含许多 Perl::Critic 所基于的详细信息。即使你不同意书中的特定指导方针，它也会让你*思考*如何编码，这是非常非常有价值的。您不必花钱买一本书，但两者非常相得益彰，而且您会在 PBP 中找到 Perl::Critic 所没有的冗长讨论。

如果您已经使用过其他 OO 语言和 OO 设计，您可能会发现[Moose](http://moose.perl.org/)是一个舒适的过渡。Moose 非常稳定，得到很好的支持，并且拥有庞大而活跃的社区（尤其是通过 IRC）。Moose 取代了几乎所有现有的 OO Perl 建议，包括我自己的建议。面向对象的设计很常见是有原因的。它对很多项目都很有意义，而且没有理由*不在*Perl 中使用它。

就个人而言，当我转向测试驱动的开发模型时，我发现自己的程序结构有了很大的改进。在这样的模型下，将问题分解成小的、易于测试的单元是必不可少的。如果您不熟悉Perl 测试，请从[Test::Tutorial](http://search.cpan.org/perldoc?Test::Tutorial)开始，如果您想了解更多信息，请查看其他一些[测试资源](http://qa.perl.org/)或[书籍。](http://books.perl.org/book/236)使用像[Devel::Cover](http://search.cpan.org/perldoc?Devel::Cover)或[Devel::NYTProf](http://search.cpan.org/perldoc?Devel::NYTProf)这样的工具来查看您的测试用例正在命中什么以及没有命中什么。拥有难以测试的代码通常是结构不佳的标志。

说了这么多，到目前为止，最好的老师是与经验丰富的贡献者一起参与现有的 Perl 项目。看看他们是如何做事的，当你做出贡献时，想想他们的建议。如果你想要一个真正的应用程序，它具有超棒的价值，似乎已经吸引了 Perl 社区中最优秀和最聪明的人，那么我建议你加入[Padre，Perl 编辑器](http://padre.perlide.org/)。

如果（无论出于何种原因）您无法参与另一个项目，请考虑将代码示例发布到 Stack Overflow 或[PerlMonks](http://perlmonks.org/)等社区。更好的是，如果你可以让你的代码开源，那么就这样做，并征求反馈。所有编程语言都最好与已经熟悉它们的其他人一起学习，Perl 也不例外。

愿你用 Perl 做善事，

*保罗*

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2009-01-04T03:33:13.163

[Perl 最佳实践](http://oreilly.com/catalog/9780596001735/index.html)

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2009-01-04T03:30:51.793

如果您正在学习 OO Perl，您不妨继续学习下一件大事并开始学习[Moose](http://www.iinteractive.com/moose/)。

Moose 是一个用于 Perl 5 的后现代对象系统，它使编写面向对象的 Perl 变得乏味。它借鉴了 Perl 6、[CLOS](http://en.wikipedia.org/wiki/Common_Lisp_Object_System) ( [Lisp](http://en.wikipedia.org/wiki/Lisp_%28programming_language%29) )、[Smalltalk](http://en.wikipedia.org/wiki/Smalltalk)、Java、[BETA](http://en.wikipedia.org/wiki/BETA)、[OCaml](http://en.wikipedia.org/wiki/Objective_Caml)、Ruby 等的所有最佳特性，同时仍然忠实于其 Perl 5 根源。

Moose 已 100% 投入生产，并在许多系统中大量使用，并且每天都在增长。

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2009-01-04T15:56:18.233

如果您已经知道如何编写结构良好的程序并且想要编写结构良好的 Perl，那么唯一的障碍是大量古老、粗俗、意大利面条式的代码示例散布在网络上并且拒绝死亡。 ..

忽略示例。或者至少忽略它们糟糕的结构，只关注你需要学习的小的句法部分。

Perl 中没有任何东西会促使您编写糟糕的代码。如果您已经知道如何用其他语言编写好的代码，那么您可以在 Perl 中应用完全相同的原则和实践。这只是纪律问题，就像任何其他语言一样。

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2009-01-04T09:22:08.857

除了上面提到的资料，我强烈推荐 Mark Jason Dominus 的书“Higher-Order Perl”。如果你买得起，就买吧，否则作者把这本书免费放在他的网站上，就像免费啤酒一样，[Free Higher Order Perl](http://hop.perl.plover.com/#free)。对于 PDF 版本：[直接下载 URL](http://hop.perl.plover.com/book/pdf/HigherOrderPerl.pdf) (1.9 MB)。

编辑：

我忘了提到 Perl 设计模式。PerlDesignPatterns[站点](http://perldesignpatterns.com/)是学习 Perl 设计模式的非常好的资源或参考。

* * *

## 回答 #6

> 赞同：6
> 
> 时间：2009-01-04T10:55:55.967

如果您觉得您已经在学习基础知识并想改进程序结构，那么我建议您阅读这些书籍，最好按以下顺序阅读：

*   [中级 Perl](https://rads.stackoverflow.com/amzn/click/com/0596102062) —— 这可能是您要问的问题的起点；涵盖开发和使用 Perl 模块（良好结构所必需的）、引用、复杂数据结构、OO 等

*   [Perl Medic: Transforming Legacy Code](https://rads.stackoverflow.com/amzn/click/com/0201795264) -- 通过展示如何修复结构不良的 Perl 来演示结构良好的 Perl

*   [有效的 Perl 编程：用 Perl 编写更好](https://rads.stackoverflow.com/amzn/click/com/0201419750)的程序——经典，但仍然有用；充满 Perl 习语，可以帮助您编写更多 Perl 风格的 Perl；面向对象的内容不多，但涵盖了更基本的编码结构，以使您的代码更简洁，更具表现力。我认为这是一本让我从 Perl 读写到 Perl 流利的书

一旦您熟悉了基本的 Perl 语法，这三个都是最好的，但是如果您仍然开始使用 Perl 但已经有合理的其他语言编程经验，那么它们都不会深入到深奥的高级概念中。

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2009-01-04T03:28:10.067

[面向对象的 Perl](http://www.manning.com/conway/)

[http://perl.about.com/od/objectorientedperl/Object_Oriented_Perl.htm](http://perl.about.com/od/objectorientedperl/Object_Oriented_Perl.htm)

[http://www.codeproject.com/KB/perl/camel_poop.aspx](http://www.codeproject.com/KB/perl/camel_poop.aspx)

[http://www.tutorialspoint.com/perl/perl_oo_perl.htm](http://www.tutorialspoint.com/perl/perl_oo_perl.htm)

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2009-01-04T09:01:54.247

就个人而言，在我开始学习 Java 之前，我并没有写出好的 OO Perl。我建议您花少量时间用真正的 OO 语言学习 OO，并将您所学的应用到 Perl。

对于一个需要指导的地方，[PerlMonks 非常棒](http://perlmonks.org/)。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-01-04T03:37:08.303

以编写 C 的方式编写 Perl，尽管您应该利用 BEGIN 块和模块的一些东西。它应该被格式化，使它看起来或多或少像老式的 K&R C 代码。

至于结构，请跳过 OO 的东西并将其样式化为 ADT：

[http://en.wikipedia.org/wiki/Abstract_data_type](http://en.wikipedia.org/wiki/Abstract_data_type)

基本上，您通过使用在 OO 中使用对象的数据结构来做到这一点（并将算法分离到它们自己的函数中）。

然后，只选择一种方式做事并坚持下去，一致性对于可读性至关重要。

如果你能做到这一点，代码既可读又容易理解。

保罗。

# .net - 带有 .NET 连接器问题的 mySQL 存储过程

> ID：410360
> 
> 赞同：1
> 
> 时间：2009-01-04T03:22:25.477
> 
> 标签：.net, mysql, stored-procedures, parameters, collections

我已经看到其他处理此错误的主题，但似乎没有一个与我的情况相对应。

首先，我的代码在本地运行时完全正常。

但是当我将它上传到服务器时，我得到了错误：

在集合中找不到参数“?PuserName”。

这是 C# 代码：

```
public DataSet GetEmployeeByUsername(string username)
        {
            string proc = "schema.GetEmployeeByUsername";
            MySqlParameter[] args = new MySqlParameter[1];
            args[0] = new MySqlParameter("?PuserName", MySqlDbType.VarChar);
            args[0].Value = username;
            return SQLDatasetCall(args, proc);
        }

 protected DataSet SQLDatasetCall(MySqlParameter[] sqlparams, string call)
        {
            string myConString = ConfigurationManager.AppSettings["mySql"];
            MySqlConnection MyConnection = new MySqlConnection(myConString);
            MySqlDataAdapter adapter = new MySqlDataAdapter();
            MyConnection.Open();
            MySqlCommand command = new MySqlCommand(call, MyConnection);
            command.CommandType = CommandType.StoredProcedure;
            if (sqlparams != null)
            {
                foreach (MySqlParameter param in sqlparams)
                {
                    command.Parameters.Add(param);
                }
            }
            DataSet ds = new DataSet();
            adapter.SelectCommand = command;
            adapter.Fill(ds);
            adapter.Dispose();
            MyConnection.Close();
            return ds;
        } 
```

SQL 代码：

```
delimiter |
create procedure GetEmployeeByUsername(in PuserName varchar(45))
begin
  select id,
      firstName,
      lastName,
      phone,
      address1,
      address2,
      city,
      state,
      zip,
      username,
      password,
      emptypeid
  from schema.tblemployees
  where
      username=PuserName;
end |
delimiter; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-04T18:48:28.463

结果证明微软 Visual Web Developer 在“发布”方法期间没有正确地对我的文件进行 ftp 处理。我下载了filezilla并再次对文件进行了ftp-ed并且它起作用了....

# c# - 跨 .NET 语言性能

> ID：410374
> 
> 赞同：2
> 
> 时间：2009-01-04T03:27:42.643
> 
> 标签：c#, .net

**例如，与完整的 C# 应用程序**相比，在同一个应用程序（但当然在不同的类库中）使用多种 .NET 语言（Delphi、VB.NET、C#）是否会**降低性能**？

 *** * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-01-04T03:31:52.323

我不是 CLR 方面的专家，但我猜你会有非常相似的性能。所有语言都编译为在 CLR 上运行的 MSIL。根据编译器生成的 MSIL，性能可能会有所不同。即 VB.NET 中的类似代码可能会编译为比 C# 编译器更少（或更多）优化的 MSIL。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-04T03:34:02.380

尽管我手头没有任何基准，但我会说在大多数情况下它不应该。那些不同的语言都将代码编译成 CIL，所以你应该没问题。

一个不同的地方是在 DLR 上运行的语言（IronPython、IronRuby 等）。他们正在使用 CLR 中不存在的一些功能进行编译，这些功能成本更高。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-04T03:31:20.997

没有任何确凿的证据来证明这一点，我只会做出有根据的猜测并说不。由于您的程序集被编译为几乎相同的 IL，因此您确实不会看到使用 CLR 语言的不同实现导致性能下降。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-04T04:21:20.833

正如其他答案所提到的，所有代码最终都编译为 CIL，因此如果代码在不同语言中一致地完成（并且您没有启用编译器优化），则生成的 IL 将非常相同。现在，如果您拥有相同的代码并使用编译器优化，您可能会得到一组不同的 IL，这会对性能产生影响。

正如[这个答案](https://stackoverflow.com/questions/410374/cross-net-languages-performances#410388)所提出的，DLR 可能会对性能产生影响。尽管我听到/读到的大部分内容都表示性能影响几乎可以忽略不计。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-04T12:25:56.927

我同意其他答案。唯一可能影响性能的是，如果您正在加载许多程序集，您将看到开销。但是，开销与用于创建程序集的语言无关，但是如果您混合了许多不同的组件，您最终可能会得到比其他方式更多的程序集。如果您的应用程序不是这种情况，那么您应该没问题。

# php - WAMP 服务器不工作

> ID：410391
> 
> 赞同：18
> 
> 时间：2009-01-04T03:37:21.313
> 
> 标签：php, localhost, wamp

好的，这是[这个问题](https://stackoverflow.com/questions/409913/can-php-be-installed-on-a-local-machine)的继续，您的专家向我介绍了[WAMP](http://www.wampserver.com/en/presentation.php)，它基本上可以在 Windows XP 环境中执行 PHP。

所以现在我已经安装了它，但是**托盘图标永远显示 YELLOW**，当我在浏览器中访问任何 PHP 页面时，它只会显示 PHP 源代码！

此外，当我在 IE7 中访问“ [http://localhost/ ”时，它给了我一个](http://localhost/)**404 Not Found**，FF3 只显示一个**空白**页面。

* * *

顺便说一句，我已经尝试“重新启动所有服务”并重新启动我的机器，但它仍然无法正常工作。

有任何想法吗？你们中有人遇到过这个问题并**解决了吗？**请在这里帮助我，我迫切希望执行 PHP 客户端，我现在只是恢复到服务器上的测试！

* * *

## 回答 #1

> 赞同：55
> 
> 时间：2009-01-31T12:15:46.680

Skype 为其与 WAMP 冲突的传入连接保留端口 80，因此只需通过执行以下操作将 Skype 配置为使用另一个端口：

在 Skype 中转到工具|选项|高级|连接取消选中该选项-> 使用端口 80 和 443 作为传入连接的替代方案，就是这样

要使此更改生效，请执行以下操作，重新启动 Skype 并重新启动 WAMP 上的所有服务：

左键单击 WAMP 托盘图标 > 重新启动所有服务”

现在 Wamp 和 Skype 可以共存了，希望这能解决你的问题！！

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-01-04T03:51:31.723

知道了！在**WAMP 托盘图标**下，左键单击上下文菜单 > **Apache** > **Service** > **Test Port 80**，它说：

> “您的**80 端口实际被使用**- 信息不可用，必须是**Skype** ”

好吧，所以**关闭**Skype, **WAMP > Restart All Services**，并且[Localhost](http://localhost/)显示[“WAMP5 Homepage”：](http://www.wampserver.com/en/data/image_accueil_wamp.gif)

[![本地主机 WAMP CP](https://i.stack.imgur.com/eEUEd.gif)](https://i.stack.imgur.com/eEUEd.gif)
[（来源：[wampserver.com](http://www.wampserver.com/en/data/image_accueil_wamp.gif)）]

而且，[phpMyAdmin](http://www.phpmyadmin.net/)有效，**PHP 脚本**也可以执行。**哇！**

所以现在我可以以适当的方式进行复制了！谢谢[StackOverflow！](https://stackoverflow.com/questions/409913/can-php-be-installed-on-a-local-machine)

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2012-12-07T15:34:00.003

试试这个，我遇到了同样的问题，这对我有帮助：

1.  Wamp 服务器图标 => Appache => 服务 => 安装服务
2.  Wamp 服务器图标 => Appache => 服务 => 启动/恢复服务
3.  Wamp 服务器图标 => MySql => 服务 => 安装服务
4.  Wamp 服务器图标 => MySql => 服务 => 启动/恢复服务

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2011-08-24T14:06:37.843

只需转到 wamp>bin>apache>apache 2.2.17>conf>httpd.conf (file) 更改`Listen 80`以`Listen 8080` 保存文件 n 这次重新启动服务键入[http://localhost:8080](http://localhost:8080)

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-01-10T17:56:57.933

很高兴你把它整理好了 - Skype 是臭名昭著的。

如果您想同时使用 Skype 和 WAMP，您可以编辑您的 httpd.conf 文件 - 将“listen”值从 80 更改为其他值并重新启动所有服务。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2011-04-28T04:19:30.267

Teamviewer 也可能导致此问题。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2010-02-18T09:33:50.740

您可以在 wamp 在线后启动 Skype 或将 Skype 端口更改为不使用 80

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2012-12-07T15:39:40.613

我想扩展一下其他人在这里所做的贡献——因为 Skype 并不总是罪魁祸首。

您还可以通过在命令提示符下运行以下命令来准确检查哪个进程占用了您的端口 80：

`netstat -ao`

这将列出所有使用端口及其 PID 的进程。您可以将这些与任务管理器中的流程相关联，并从那里采取适当的措施。底线是 - 您正在寻找占用端口 80 和/或 443 的内容（如果您通过 SSL 连接），因为这是默认的浏览器端口。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2014-01-20T12:31:20.550

对我来说，当我打开 httpd.conf 文件时，我发现我有如下两条 Listen 语句：

```
Listen 80
Listen 169.254.96.77:80 
```

当我评论第二行时（在行首添加“#”）我重新启动了所有 wamp 服务（左键单击任务栏中的 wamp 图标），wamp 图标变为绿色！

希望这对其他人有帮助。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2011-01-06T19:47:57.490

好吧，如果上述方法仍然对我没有帮助，请按照以下步骤操作：

*   在文件中出现端口 80 的两个位置将您的 apache 端口（从 httpd.conf）更改为其他端口，例如 8056
*   然后适当地更改您的浏览器代理。即“localhost”的代理和“8056”的端口。
*   保存文件并重新启动 Wamp 服务
*   在浏览器中启动 localhost

希望它有效！确实需要更好的方法。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2013-09-07T11:35:31.683

大多数情况下，由于 apachi 服务器或端口之间的冲突或 wamp 安装的重复而发生此问题

所以要解决这个问题：

首先，如果您使用的是 SKYPE，请尝试通过打开 Skype 来更改端口，然后：

*   工具菜单
*   选项
*   高级选项
*   连接
*   然后取消选中“使用端口 80 和 443 ......”
*   节省
*   重新启动 Skype

其次，如果问题仍然存在，请尝试查找您是否正在使用 - 或正在使用 - 其他 Apache 服务器（例如 XAMPP 服务器），如果是，请尝试将其删除，并在删除后通过以下方式转到 regedit：

*   按键盘上的“windows”按钮+“r”按钮，这将打开运行命令
*   键入“regedit”（不带“”）
*   打开编辑菜单然后查找（您可以按“CTRL”按钮+“F”按钮）
*   搜索属于其他 apache 服务器的任何内容并将其删除（执行此步骤时应小心）

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2013-12-17T06:06:06.853

**在Skype中：**

转到工具 -> 选项 -> 高级 -> 连接并取消选中“使用端口 80 和 443 作为替代”框。

这应该会有所帮助。

# python - 使用 AD 作为 Django 的身份验证

> ID：410392
> 
> 赞同：29
> 
> 时间：2009-01-04T03:37:29.160
> 
> 标签：python, django, active-directory, ldap

我正在公司环境中开发基于 Django 的应用程序，并希望使用现有的 Active Directory 系统对用户进行身份验证（因此他们不会再获得另一个登录名/密码组合）。我还想继续使用 Django 的用户授权/权限系统来管理用户能力。

有没有人有一个很好的例子？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-01-04T14:42:18.460

这是另一个更新的片段（2008 年 7 月，2015 年 12 月更新）：

[通过 SSL 对 Active Directory (LDAP) 进行身份验证](http://djangosnippets.org/snippets/901/)

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2011-10-27T09:55:43.177

Jeff 提供的链接确实有效，尽管它假设您有一个默认组，用户被添加到其中。我只是替换：

```
group=Group.objects.get(pk=1) 
```

经过

```
group,created=Group.objects.get_or_create(name="everyone") 
```

如果您想要更紧密的集成和更多功能，还有[django-auth-ldap](http://packages.python.org/django-auth-ldap/)可以让您更好地控制 ldap 用户/组如何映射到 django 用户/组。

为了调试 ldap 连接，我发现[这篇博](http://www.djm.org.uk/using-django-auth-ldap-active-directory-ldaps/)文很有用，特别是使用 ldap-utils 测试 ldap 连接的命令：

```
ldapsearch -H ldaps://ldap-x.companygroup.local:636 -D "CN=Something LDAP,OU=Random Group,DC=companygroup,DC=local" -w "p4ssw0rd" -v -d 1 
```

如果您使用的是 ssl，那么获取证书的问题也会很好解决。您可以从服务器中提取它，也可以按照[这些说明](http://support.microsoft.com/kb/321051)生成您自己的。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-01-04T03:44:56.040

那个怎么样？你试过那个吗？

[http://www.djangosnippets.org/snippets/501/](http://www.djangosnippets.org/snippets/501/)

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2014-08-29T13:44:53.327

我遇到了同样的问题，并注意到 django-auth-ldap 根本不支持 SASL -> 如果 TSL 不可用，则连接上的纯文本密码。

这是我为这个问题所做的： [https ://github.com/susundberg/django-auth-ldap-ad](https://github.com/susundberg/django-auth-ldap-ad)

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2018-08-19T15:27:30.907

您可以对`django-auth-ldap`后端进行子类化，以使用 SASL 或 Kerberos 或其他方式添加 AD 功能。这是一个在 Django 2.1 中工作的 2018 年示例：

[https://partofthething.com/thoughts/authenticating-and-populating-users-in-django-using-a-windows-active-directory-and-sasl/](https://partofthething.com/thoughts/authenticating-and-populating-users-in-django-using-a-windows-active-directory-and-sasl/)

# git - Git 准备好被推荐给我的老板了吗？

> ID：410393
> 
> 赞同：22
> 
> 时间：2009-01-04T03:38:20.937
> 
> 标签：git, version-control, devtools

我想向我的老板推荐 Git 作为一个新的源代码控制系统，因为我们被 VSS 困在 90 年代（哎呀），但是工具和 3rd 方支持是否足够好呢？

具体来说，我说的是类似于 TortoiseSVN 的 GUI 前端、不错的视觉差异/合并支持，以及电子邮件提交通知和来自 IDE 和构建系统等第三方的一般支持。

尽管这将被程序员使用，但我们的团队中确实需要这种东西。我不想让每个人都坚持使用新工具，甚至是新的源代码控制范例（分布式），只有命令行应用程序和一些在线教程。这将是一个倒退。

那么你觉得... Git 准备好了吗？Git 有哪些不错的工具，哪些第三方开发应用程序支持它？

编辑：我最初的问题非常含糊，所以我正在更新它以专门要求提供可用工具列表和对 Git 的第 3 方支持。也许我们可以得到一个包含内容列表的社区 wiki 帖子。

我也不认为“使用颠覆”是一个充分的答案。除了离线编辑之外，还有其他使用分布式源代码控制系统的原因——私人和廉价的分支就是其中之一。

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2009-01-04T03:45:09.877

取决于团队。如果你是一个精通技术的团队的一员，那么 git 是很棒的（而且通常不仅仅是很棒）。但是如果有些人在命令行上不习惯，可能会有一些麻烦（因为[tortoisegit](http://code.google.com/p/tortoisegit/)还处于起步阶段，坦率地说，我遇到的所有其他 GUI 都很糟糕）。

如果你要处理技术不高的人（设计师、高层管理人员等），我会选择颠覆之类的东西。[TortoiseSVN](http://tortoisesvn.tigris.org/)非常棒（而且相当容易使用），svn 可能拥有 80% 的 git。

* * *

## 回答 #2

> 赞同：25
> 
> 时间：2009-01-04T05:04:46.567

一个更简单的方法（我已经成功地做到了）是建立一个中央 Subversion 存储库，它为每个人提供了像 TortoiseSVN 这样的好工具。然后，想要将`git-svn`完整的 Git 环境用作 Subversion 客户端的开发人员。

这非常有效，因为仍然有一个中央存储库，每个人都知道给定的更改要么已提交，要么尚未提交。然后，在边缘，人们可以使用他们想要的工具（Git）来完成他们的工作。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2009-01-04T03:50:15.593

我们在我的公司使用 git，根据您对可视化工具的要求，我会拒绝。tortoisegit 来了，但还没有到。GitX 和 GitNub 之类的工具在 OS X 中很棒，但它们并不能完全涵盖您所描述的所有内容。

不过，给它时间。Git 正在以相当快的速度发展，并且由于这种增长，对可视化工具的需求也在增加。

您可能会遇到的最大问题是范式转变。这不是最容易掌握的东西，而且你的团队中的一些人会感到沮丧，因为他们已经习惯了使用 Git 及其更分布式的特性（尽管我不喜欢称它们为分布式 SCM）。

话虽如此，使用 Git 和我的公司都很棒，我很乐意看到另一家公司加入其中。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-01-04T07:38:03.480

从 VSS 迁移到 Subversion 已经是一个很好的升级。Subversion 将为您提供出色的功能，例如原子提交、出色的 GUI、与 IDE 的集成、出色的 Windows 体验、变更集的概念、可靠的存储库等。对于具有中小型团队的典型 Windows 公司，我认为 subversion 是一个很棒的工具。

如果您对分布式 VCS 感兴趣，那么您应该关注 git、hg、bzr。就 Windows 支持而言，hg 和 bzr 领先于 git。但是，有一个用于 Windows (msysgit) 的移植命令行版本的 git，它将更改合并回主 git。git 社区也在快速增长，因此我希望 Windows 体验会有所改善。

Git支持混合场景，服务器可以是CVS/SVN，个人开发者可以使用git-svn在本地工作，管理本地分支。这种设置提供了两全其美的效果。然而，由于对 Perl SVN 库的依赖，git-svn 在 Windows 上是不稳定的。在这种情况下，使用 git 的好功能并不像开发人员共享分支等那么容易。

鉴于您的项目不是开源的，我认为 Subversion 可能会提供您需要的所有功能。一旦 Git 达到您需要的 Windows 可用性栏，您就可以将您的 SVN 存储库导入 Git。

除非您的公司对分支和合并很重视，否则我会选择 SVN，否则，您将需要仔细考虑 DVCS。

我一直在做一个开源项目，存储库存储在 CVS 中，然后迁移到 SVN，然后迁移到 Git。每一步都是一次重大升级。SVN 迁移到 Git 的主要动机是让贡献者更容易维护他们自己的分支，让它们保持最新，将它们推送给开发人员，并让开发人员轻松地以最少的努力应用它们。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-01-04T08:04:54.910

当谈到[git](http://git.or.cz/)的图形工具时，到目前为止我使用的唯一有用的工具是 gitk（它为您可视化修订树），我自己在过去半年一直在使用 git，正如其他人所说的那样, [TortoiseGit](http://code.google.com/p/tortoisegit/)还很早，还有一些问题需要解决。

在工作中，我们一直在评估三种不同的 DVCS（即 git、[mercurial (hg)](http://www.selenic.com/mercurial/wiki/)和[bazaar](http://bazaar-vcs.org/)），并在一个人满为患的晚上向公司的其他人展示了它们。Mercurial 收到了最积极的回应，并且它有一个[Tortoise](http://tortoisehg.sourceforge.net/)变体。

我建议你做同样的事情。**找一个**可以提供 git 替代方案的人（例如 mercurial 或 bazaar） ，并在您的公司一起在**DVCS上****进行演示。**告诉你的同事 DVCS 有多棒比告诉老板更重要，因为他们最终会使用它。因此，如果他们接触过这些工具并亲自体验一下，就会更有教育意义。

 **当我们介绍它时，我们还假设人们没有进行版本控制，因此我们快速解释了基本概念，例如**checkin-checkout**与**commit-merge**以及**为什么人们进行版本控制**。基本上，它就像[Eric Sink 关于版本控制的文章，](http://www.ericsink.com/scm/source_control.html)但被精简为基本要素。

由于您来自 VSS（我很*抱歉*），您可能想看看[SVN](http://tortoisesvn.tigris.org/)。然而，在我看来，分布式和集中式方法之间的唯一区别是通过对等网络共享代码增加了复杂性。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-01-04T05:48:56.180

Windows 的默认 git GUI 很糟糕，并且容易陷入重新扫描循环。我现在使用命令行客户端，只要您可以处理使用 vi 来制作日志条目，这似乎很好。我刚开始使用 github，这还可以，但导航很糟糕。

就个人而言，我所做的几乎所有事情都使用 Subversion 和 Apache。Subversion 效果很好，文档齐全，易于设置且免费。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-01-04T06:34:19.147

大多数典型规模的**公司**真的需要**分布式**源代码控制吗？

Git 非常适用于开源项目，在这些项目中，来自世界各地的人们在截然不同的时间就一个项目进行协作，其中签入的有效性取决于绩效和信任网络。

在一家公司，例如，提交需要 QA 分析或配置经理的批准和/或文档，或者为了使修订号与错误报告中的一致，我会提交 Git 等分布式控制确实没有意义，从某种意义上说，范式转变是没有必要的；它还不能很好地适应现有的 CM 流程（一个社会问题）；它不能很好地与现有工具、第三方和其他工具集成；并且它对 Windows 的支持很差。

不是说不好；我非常怀疑它是否适合大多数企业环境。我期待其他一些回应以获得洞察力。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-01-04T08:52:15.157

我是 GIT 的新手，在使用了几周后不得不说它真的很棒，一旦你掌握了命令行提示符。

回答您的问题“Git 准备好了吗？” => 我认为是（命令行学习曲线除外。）

我认为你和你的团队/公司应该问自己“你准备好使用 git 了吗？”。一旦开始使用它，您显然将拥有触手可及的强大功能。

学习 git 的第一步是：

*   在 github 上阅读 git 指南。
*   前往[Pragmatic Programmer](http://www.pragprog.com/) s 并将“免费” [Insder 下载到 Github](http://www.pragprog.com/screencasts/v-scgithub/insider-guide-to-github)
*   您还可以[使用 Git 学习实用版本控制](http://www.pragprog.com/titles/tsgit/pragmatic-version-control-using-git)

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-01-05T00:43:47.293

就在 Spoike 提到 TortoiseHg for Mercurial 之后，Bazaar 的 Windows 独立下载最近确实包括 TortoiseBzr，尽管它被标记为实验性的。

我在很多版本之前尝试过它，发现它不稳定，但从那时起它可能已经有了很大的改进（特别是如果他们愿意将它与官方 Bazaar 版本打包在一起）。

如果你真的想要一个像乌龟一样的界面的去中心化版本控制，我会试一试，看看它们是如何公平的。

E.

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2009-01-10T02:25:53.460

当我第一次接触 Git 时，我的第一反应是“我就是不 Git”。我看到了许多强大的工具，但它们不是很直观。当我习惯使用 Git 时，我意识到我真正喜欢的唯一功能是快速便宜且简单的分支。

我尝试了一些图形前端，包括 Git 附带的 GTK。我发现这些比命令行操作更令人困惑。

如果您的公司习惯于 Subversion，并且您需要更改为 DVCS，请尝试 Mercurial。Subversion 用户很快就会有宾至如归的感觉。然而，很少有人能真正理解 Mercurial 关于分支应该是什么的想法......首先在脚上使用 DVCS 进行哪种射击（除非能够在本地提交并在推送之前推/拉其他人到主存储库）。

我每天都使用 Subversion 和 Mercurial，它们非常适合我的所有项目。我认为，除非你需要 Git 的分支能力和编辑以前版本的能力...... Subversion 或 HG 将是你最好的选择。我不会推荐 Git 作为任何人第一次接触 DVCS，而只是我的意见和经验。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-01-04T08:20:40.337

[有一个关于GIT](http://web20show.com/episodes/web20show-ep45-github)的非常好的播客。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2009-01-18T18:33:58.467

当然，我认为 Git 已经准备好了。只需确保您在项目计划中有时间让人们在切换时习惯它......

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2010-04-10T07:16:48.787

大多数第 3 方应用程序（Eclipse 除外）中是否支持 Git？对我见过的很多人来说都不是。

Git 可能不会完全取代 SVN——它们的不同之处足以让每个人都可能在一段时间内扮演自己的角色。无论如何要回答整个问题：不，它还没有准备好进入商业世界的黄金时段。也许有一天，在某些情况下（可能不是所有情况），但当然它仍然太新——很多人甚至还没有听说过！只是建议您对其进行演示以获得支持这一事实应该是一个危险信号。如果你现在去开发者那里说你想搬到 SVN，唯一不会立即理解的是那些生活在岩石下的人，谁在乎他们？

此外，更新并不总是更好。这种类型的范式转变需要时间才能被确认为一种改进——看看随着时间的推移对 Maven 的强烈反对。不要这么快就从一个经过验证的解决方案跳槽，当你的工作和声誉受到威胁时不要这么快——如果 Git 不成功，你不会推荐它。至少对于像 SVN 这样的产品，你有一个事实，它不是新的，它肯定会随着时间的推移得到证明，即使存在问题，也不能过于严厉地质疑建议，因为它仍然是大多数开发人员的*默认*答案。转向行业标准比转向新的和非标准的东西更难攻击建议。

不是你想听到的答案（看来你已经做出了决定），而是问问自己，好处（和分支是应该避免的，而不是鼓励的）是否真的超过了风险。

# sql-server - SQL Server 中的“公共”角色访问

> ID：410396
> 
> 赞同：18
> 
> 时间：2009-01-04T03:40:48.030
> 
> 标签：sql-server, permissions

任何人都可以让我知道 public 在 sql server 中有什么权限。

谢谢

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-01-04T04:05:38.743

默认情况下，公共角色不能做任何事情*。如果希望每个人都拥有这些权限，一些 DBA 将授予公共角色额外的权限（查看或更改数据或运行存储过程）。

`*`——嗯，几乎任何东西。他们可以查看一些系统视图并运行不涉及任何数据的查询（例如“select 'a'”）。

要查看特定权限，请右键单击角色（在 SQL 2005 中，它是数据库 > {您的数据库} > 安全 > 角色 > 数据库角色）并选择属性。

编辑：您可能还想查看服务器级公共角色。位于 Security > Server Roles > public

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2015-09-25T06:33:40.957

每个数据库用户都属于公共数据库角色。

当用户没有被授予或拒绝对安全对象的特定权限时，用户将继承授予该对象的公共权限。

公共服务器角色被授予 VIEW ANY DATABASE 权限和默认端点上的 CONNECT 权限。

实际上，公共服务器角色并不是一个固定的服务器角色，因为权限是可以改变的，但是每个用户都默认属于公共数据库角色。

你可以在这里查看：[https ://msdn.microsoft.com/en-us/library/ms188659.aspx](https://msdn.microsoft.com/en-us/library/ms188659.aspx)

# xul - 什么是 xul 跑步者？

> ID：410399
> 
> 赞同：0
> 
> 时间：2009-01-04T03:44:53.310
> 
> 标签：xul, xulrunner

我问的原因是因为我收到的每封附有链接的电子邮件都会收到“平台版本 1.9.0.4 与最低版本不兼容>=1.9.0.5 最高版本<=1.9.0.5。

我不知道如何摆脱 xul runner 或者我需要做什么才能让我的计算机接受 xul 或我需要做的任何事情。有人可以一步一步地（我的意思是一步一步地非常明确）指导我如何做我需要做的任何事情来解决这个问题吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-04T03:55:38.220

XUL 是由 Mozilla 公司（制造 Firefox 和 Thunderbird 的人）创建的工具，可以让编写他们的应用程序更像是为 Web 编写应用程序。

话虽如此，如果您在遇到此问题时使用 Firefox 查看网络邮件或使用 Thunderbird 并遇到此问题，我会卸载您已安装的所有插件并检查它。如果仍然无法解决问题，请尝试卸载并重新安装您用于查看消息的应用程序。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-15T02:38:53.697

虽然这是这个问题的错误地方，但您可以尝试在 mozilla 支持中询问：http: [//support.mozilla.com/en-US/kb/Ask+a+question](http://support.mozilla.com/en-US/kb/Ask+a+question)

# firefox - 从 Firefox 侧边栏扩展获取当前页面 URL

> ID：410411
> 
> 赞同：23
> 
> 时间：2009-01-04T03:53:46.913
> 
> 标签：firefox, url, xul, sidebar

我正在为 Firefox 编写侧边栏扩展，需要一种方法来获取当前页面的 URL，以便我可以对照数据库检查它并显示结果。我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2010-06-20T19:32:25.123

我在寻找同一个问题的答案时偶然发现了这篇文章。

其实我认为这很容易

```
alert(window.content.location.href) 
```

另请参阅[https://developer.mozilla.org/en/DOM/window.content](https://developer.mozilla.org/en/DOM/window.content)

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2009-01-04T12:27:27.873

```
window.top.getBrowser().selectedBrowser.contentWindow.location.href; 
```

可能会起作用，否则我认为您需要使用：

```
var mainWindow = window.QueryInterface(Components.interfaces.nsIInterfaceRequestor)
                   .getInterface(Components.interfaces.nsIWebNavigation)
                   .QueryInterface(Components.interfaces.nsIDocShellTreeItem)
                   .rootTreeItem
                   .QueryInterface(Components.interfaces.nsIInterfaceRequestor)
                   .getInterface(Components.interfaces.nsIDOMWindow);

mainWindow.getBrowser().selectedBrowser.contentWindow.location.href; 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2010-07-28T19:02:04.617

这对我来说似乎很好用

```
function getCurrentURL(){

    var currentWindow = Components.classes["@mozilla.org/appshell/window-mediator;1"].getService(Components.interfaces.nsIWindowMediator).getMostRecentWindow("navigator:browser");

    var currBrowser = currentWindow.getBrowser();
    var currURL = currBrowser.currentURI.spec;

    return currURL;
} 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-01-15T02:10:46.793

[https://developer.mozilla.org/En/Working_with_windows_in_chrome_code](https://developer.mozilla.org/En/Working_with_windows_in_chrome_code)

如果您需要从运行在侧边栏中的代码访问主浏览器，您将类似于 Wimmel 发布的内容，除了最后一行可以简化为

```
mainWindow.content.location.href 
```

（或者，您可以使用返回 nsIURI 的 API）。

根据您的任务，在浏览器窗口中运行代码可能是有意义的（例如在页面加载处理程序中），然后它可以通过`content`快捷方式访问当前页面，并通过`document.getElementById("sidebar").contentDocument`或侧边栏访问`.contentWindow`。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2011-11-15T12:26:01.520

如果您只需要**domain**和**subdomain**；

用法;

```
PageDomain.getDomain(); // stackoverflow.com
PageDomain.getSubDomain(); //  abc.stackoverflow.com 
```

代码;

```
PageDomain = {

getDomain : function() {
    var docum = Components.classes["@mozilla.org/appshell/window-mediator;1"].getService(Components.interfaces.nsIWindowMediator).getMostRecentWindow("navigator:browser");
    var domain = PageDomain.extractDomain(new String(docum.location));
    return domain;
},
getSubDomain : function() {
    var docum = Components.classes["@mozilla.org/appshell/window-mediator;1"].getService(Components.interfaces.nsIWindowMediator).getMostRecentWindow("navigator:browser");
    var subDomain = PageDomain.extractSubDomain(new String(docum.location));
    return subDomain;
},
 extractDomain: function(host) {
        var s;

        // Credits to Chris Zarate
        host=host.replace('http:\/\/','');
        host=host.replace('https:\/\/','');
        re=new RegExp("([^/]+)");
        host=host.match(re)[1];
        host=host.split('.');

        if(host[2]!=null) {
          s=host[host.length-2]+'.'+host[host.length-1];
          domains='ab.ca|ac.ac|ac.at|ac.be|ac.cn|ac.il|ac.in|ac.jp|ac.kr|ac.nz|ac.th|ac.uk|ac.za|adm.br|adv.br|agro.pl|ah.cn|aid.pl|alt.za|am.br|arq.br|art.br|arts.ro|asn.au|asso.fr|asso.mc|atm.pl|auto.pl|bbs.tr|bc.ca|bio.br|biz.pl|bj.cn|br.com|cn.com|cng.br|cnt.br|co.ac|co.at|co.il|co.in|co.jp|co.kr|co.nz|co.th|co.uk|co.za|com.au|com.br|com.cn|com.ec|com.fr|com.hk|com.mm|com.mx|com.pl|com.ro|com.ru|com.sg|com.tr|com.tw|cq.cn|cri.nz|de.com|ecn.br|edu.au|edu.cn|edu.hk|edu.mm|edu.mx|edu.pl|edu.tr|edu.za|eng.br|ernet.in|esp.br|etc.br|eti.br|eu.com|eu.lv|fin.ec|firm.ro|fm.br|fot.br|fst.br|g12.br|gb.com|gb.net|gd.cn|gen.nz|gmina.pl|go.jp|go.kr|go.th|gob.mx|gov.br|gov.cn|gov.ec|gov.il|gov.in|gov.mm|gov.mx|gov.sg|gov.tr|gov.za|govt.nz|gs.cn|gsm.pl|gv.ac|gv.at|gx.cn|gz.cn|hb.cn|he.cn|hi.cn|hk.cn|hl.cn|hn.cn|hu.com|idv.tw|ind.br|inf.br|info.pl|info.ro|iwi.nz|jl.cn|jor.br|jpn.com|js.cn|k12.il|k12.tr|lel.br|ln.cn|ltd.uk|mail.pl|maori.nz|mb.ca|me.uk|med.br|med.ec|media.pl|mi.th|miasta.pl|mil.br|mil.ec|mil.nz|mil.pl|mil.tr|mil.za|mo.cn|muni.il|nb.ca|ne.jp|ne.kr|net.au|net.br|net.cn|net.ec|net.hk|net.il|net.in|net.mm|net.mx|net.nz|net.pl|net.ru|net.sg|net.th|net.tr|net.tw|net.za|nf.ca|ngo.za|nm.cn|nm.kr|no.com|nom.br|nom.pl|nom.ro|nom.za|ns.ca|nt.ca|nt.ro|ntr.br|nx.cn|odo.br|on.ca|or.ac|or.at|or.jp|or.kr|or.th|org.au|org.br|org.cn|org.ec|org.hk|org.il|org.mm|org.mx|org.nz|org.pl|org.ro|org.ru|org.sg|org.tr|org.tw|org.uk|org.za|pc.pl|pe.ca|plc.uk|ppg.br|presse.fr|priv.pl|pro.br|psc.br|psi.br|qc.ca|qc.com|qh.cn|re.kr|realestate.pl|rec.br|rec.ro|rel.pl|res.in|ru.com|sa.com|sc.cn|school.nz|school.za|se.com|se.net|sh.cn|shop.pl|sk.ca|sklep.pl|slg.br|sn.cn|sos.pl|store.ro|targi.pl|tj.cn|tm.fr|tm.mc|tm.pl|tm.ro|tm.za|tmp.br|tourism.pl|travel.pl|tur.br|turystyka.pl|tv.br|tw.cn|uk.co|uk.com|uk.net|us.com|uy.com|vet.br|web.za|web.com|www.ro|xj.cn|xz.cn|yk.ca|yn.cn|za.com';
          domains=domains.split('|');
          for(var i=0;i<domains.length;i++) {
            if(s==domains[i]) {
              s=host[host.length-3]+'.'+s;
              break;
            }
          }
        } else {
          s=host.join('.');
        }
        // Thanks Chris
        return s;
      },

      extractSubDomain:function(host){
          host=host.replace('http:\/\/','');
          host=host.replace('https:\/\/','');
          re=new RegExp("([^/]+)");
          host=host.match(re)[1];
          return host;
      }
} 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2019-08-03T20:56:35.453

**从 Firefox 扩展弹出窗口；**

你需要

```
"permissions": [
  "activeTab"
] 
```

在您的清单中或可能`tabs`代替`activeTab`

```
async function getCurrentTabUrl(){
    let tabs = await browser.tabs.query({active: true, currentWindow: true}) ;
    return tabs[0].url ;
}

let hostUrl = await getCurrentTab();
alert(hostUrl); 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2021-01-03T20:52:58.787

这适用于 Firefox“弹出”扩展。

```
browser.tabs.query({active: true, windowId: browser.windows.WINDOW_ID_CURRENT})
    .then(tabs => browser.tabs.get(tabs[0].id))
    .then(tab => {
    console.log(tab);    
    }); 
```

* * *

## 回答 #8

> 赞同：-1
> 
> 时间：2009-09-09T16:04:40.943

你好，

我试图在 JavaScript 中实现它，因为我的项目中也需要它，但是所有三种可能的解决方案都不起作用。我还实现了一个小站点来测试它，但这也没有用。

下面是小站点的源代码：

```
<html>
<head>
<title>Test</title>
<script type="text/javascript">
function Fall1 () {

    alert(window.top.getBrowser().selectedBrowser.contentWindow.location.href);
}

function Fall2() {
var mainWindow = window.QueryInterface(Components.interfaces.nsIInterfaceRequestor)
                   .getInterface(Components.interfaces.nsIWebNavigation)
                   .QueryInterface(Components.interfaces.nsIDocShellTreeItem)
                   .rootTreeItem
                   .QueryInterface(Components.interfaces.nsIInterfaceRequestor)
                   .getInterface(Components.interfaces.nsIDOMWindow);

alert(mainWindow.getBrowser().selectedBrowser.contentWindow.location.href);
}

function Fall3() {
alert(document.getElementById("sidebar").contentWindow.location.href);
}

</script>
</head>
<body>
<form name="Probe" action="">

<input type="button" value="Fall1"
onclick="Fall1()">

<input type="button" value="Fall2"
onclick="Fall2()">

<input type="button" value="Fall3"
onclick="Fall13()">
</form>
</body>
</html> 
```

# c# - 为什么不是 System...Stack 实现为链接列表？

> ID：410417
> 
> 赞同：4
> 
> 时间：2009-01-04T03:59:05.357
> 
> 标签：c#, .net, data-structures

我正在查看我的代码，发现了一些我编写的扩展方法，用于从 System.Collections.Generic.Stack 中删除项目。我很好奇，所以我查看了 Stack with Reflector 的源代码，我可以看到他们将它实现为数组而不是链表，我只是想知道为什么？使用链表就不需要调整内部数组的大小......

这是我的扩展，欢迎任何批评或建议。谢谢。

```
public static Stack<T> Remove<T>(this Stack<T> stack, T item)
{
    Stack<T> newStack = new Stack<T>();

    EqualityComparer<T> eqc = EqualityComparer<T>.Default;

    foreach( T newItem in stack.Reverse() )
    {
        if( !eqc.Equals(newItem, item) )
        {
            newStack.Push(newItem);
        }
    }

    return newStack;
}
/// <summary>
/// Returns a new Stack{T} with one or more items removed, based on the given predicate.
/// </summary>
/// <typeparam name="T"></typeparam>
/// <param name="stack"></param>
/// <param name="fnRemove"></param>
/// <returns>The new stack.</returns>
/// <remarks>
/// We have to turn tricks in order to save the LIFO order of the pool
/// since there is no built-in remove method since they implement a Stack internally
/// as an array instead of a linked list. Maybe they have a good reason, I don't know...
/// 
/// So, to fix this I'm just using a LINQ extension method to enumerate in reverse.
/// </remarks>
public static Stack<T> RemoveWhere<T>(this Stack<T> stack, Predicate<T> fnRemove)
{
    Stack<T> newStack = new Stack<T>();

    foreach( T newItem in stack.Reverse() )
    {
        /// Check using the caller's method.
        if( fnRemove(newItem) )
        {
            /// It's not allowed in the new stack.
            continue;
        }
        newStack.Push(newItem);
    }

    return newStack;
} 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-01-04T04:10:25.910

LIFO 队列（堆栈）通常对数组最有效，因为您将项目推送到数组的末尾并从数组的同一端拉出项目。所以数组运行良好，没有链表的内存和分配开销。通过不需要创建和垃圾收集列表项包装对象来抵消创建和调整数组大小的成本。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-01-04T08:50:52.210

考虑`Stack<byte>`具有 1,000,000 个项目的 a 的大小。

*   使用数组，大小 ~= 1,000,000 字节。通常更多是由于备用容量，但可能不会超过两倍。
*   对于链表，每个条目都需要自己的对象、数据本身和至少一个引用（对于单链表，这可能是堆栈所需的全部内容）。填充到 4 个字节后，总大小可能约为 16,000,000 字节。哎哟。

再加上引用的局部性和减少的 GC 压力，我认为使用数组作为堆栈、队列和双端队列的底层数据结构是非常有意义的——当然，最后两个将数组用作循环缓冲区。唯一明显的缺点是浪费了“备用容量”，并且在容量耗尽时需要复制所有内容。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-01-04T04:09:57.287

当您运行基准测试时，由于局部性，您最终几乎总是会在 Array 中看到巨大的性能优势。ArrayList 将所有内容放入一个数组中，该数组存储在一个大的连续内存块中。链接列表通过链接存储它们的数据，因此最终会分配更多的内存，并且还会在内存中跳转更多。

# web-applications - 学习 Web 应用程序的网页设计的最佳资源是什么？

> ID：410418
> 
> 赞同：2
> 
> 时间：2009-01-04T04:00:32.077
> 
> 标签：web-applications, user-interface

我现在已经建造了它，我该如何创造一个半体面的设计？对于信息密集型 Web 应用程序，我需要一些技术、资源、示例、书籍等。

PS - 我刚从 Pragmatic Programmers 购买了 Web Design for Developers，它不是很好！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-04T04:09:54.367

我认为这是一个相当受欢迎的问题：

[开始学习网络应用程序设计的最佳方式](https://stackoverflow.com/questions/18284/best-way-to-begin-learning-web-application-design)

[提高网页设计技能](https://stackoverflow.com/questions/133341/improve-web-design-skills)

对于书籍：

[学习设计的最佳书籍](https://stackoverflow.com/questions/158769/best-books-to-learn-about-design)

[面向程序员的用户界面设计书籍资源](https://stackoverflow.com/questions/221966/user-interface-design-books-resources-for-programmers)

如果您还没有阅读它，请阅读[不要让我思考](https://rads.stackoverflow.com/amzn/click/com/0789723107)和[非设计师的设计书籍](https://rads.stackoverflow.com/amzn/click/com/0321534042)，以获得良好的页面布局设计。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-04T04:13:10.897

我很久以前读过 Designing with Web Standards 并喜欢它。不过，我最幸运的是聘请了一名设计师。如果你找到一个好的，他们是非常值得的钱。

# iphone - 在 iPhone 上显示格式化文本

> ID：410419
> 
> 赞同：2
> 
> 时间：2009-01-04T04:02:13.527
> 
> 标签：iphone, cocoa-touch

我需要在 iPhone 应用程序中显示文本，类似于显示书籍的方式，例如：

# 标题

## 副标题

本书的实际文本。废话。废话。废话。

我该怎么做呢？我找到了 UITextView 和 UITextField 和 UIScrollView 对象，但我不知道如何正确使用它们......有什么建议吗？

我希望这是有道理的...

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-01-04T04:13:25.577

您可以在 UIWebView 中使用 HTML。或者为特定字体/大小/属性设置多个 UILabel 布局视图。然后将 UITextField 用于其余未格式化的文本。在桌面可可中，您可以使用属性字符串，但我认为这些字符串不适用于 iphone。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-05T00:00:17.680

正如 Ryan 所说，您可以将 HTML 与 WebView 一起使用，但如果您想坚持使用原生文本绘制，您将不得不下拉到 CoreGraphics 并手动绘制所有文本。这是很多工作，但如果做得好，它会比使用 WebView 更高效并且内存占用更少。

编辑：再次查看您的要求，如果只有标题和副标题需要更改样式，那么我建议只使用单独的 UILabels。您还可以`-sizeToFit`在分配其文本/字体属性后调用 UILabel，以便它们适合其文本，这将让您处理包装的标题/子标题。

# java - 秒表基准测试是否可以接受？

> ID：410437
> 
> 赞同：78
> 
> 时间：2009-01-04T04:12:47.590
> 
> 标签：java, benchmarking

有没有人使用过秒表基准测试，还是应该始终使用性能工具？是否有任何适用于 Java 的好的免费工具？你用什么工具？

为了澄清我的担忧，秒表基准测试会因操作系统调度而出错。在您的程序的给定运行中，操作系统可能会在您正在计时的功能中间安排另一个（或多个）进程。在 Java 中，如果您尝试为线程应用程序计时，情况会更糟，因为 JVM 调度程序会在混合中加入更多随机性。

基准测试时如何解决操作系统调度问题？

* * *

## 回答 #1

> 赞同：52
> 
> 时间：2009-01-04T04:28:30.057

秒表基准测试很好，只要您测量**足够**多的迭代是有意义的。通常，我需要一些个位数秒的总经过时间。否则，您的结果很容易因调度和流程的其他 O/S 中断而显着偏差。

为此，我使用了一些我很久以前构建的静态方法，它们基于`System.currentTimeMillis()`.

对于分析工作，我使用[jProfiler](http://www.ej-technologies.com/products/jprofiler/overview.html)多年，发现它非常好。我最近查看了[YourKit](http://www.yourkit.com/)，这在网站上看起来很棒，但我个人根本没有使用过它。

为了回答有关调度中断的问题，我发现重复运行直到达到/观察到一致性在实践中可以清除进程调度中的异常结果。我还发现线程调度对于 5 到 30 秒的运行没有实际影响。最后，根据我的经验，在您通过几秒阈值之后，调度对结果的影响可以忽略不计 - 我发现 5 秒的运行始终与 5 分钟的时间/迭代运行相同。

您可能还需要考虑预先运行大约 10,000 次测试代码以“预热”JIT，具体取决于您期望测试代码在现实生活中随时间运行的次数。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-01-04T06:34:56.167

只要您测量足够大的时间间隔，它就完全有效。我会执行 20-30 次您打算测试的运行，以便总经过时间超过 1 秒。我注意到基于 System.currentTimeMillis() 的时间计算往往是 0ms 或 ~30ms；我不认为你能得到比这更精确的东西。如果你真的需要测量一个小的时间间隔，你可能想试试 System.nanoTime()：

*   文档： http: [//java.sun.com/javase/6/docs/api/java/lang/System.html#nanoTime()](http://java.sun.com/javase/6/docs/api/java/lang/System.html#nanoTime())
*   关于测量小时间跨度的问题，因为 System.nanoTime() 也有一些问题：[如何在 Java 中以微秒精度测量时间？](https://stackoverflow.com/q/503877/750378)

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-01-06T08:38:32.953

秒表实际上是最好的基准！

真正的端到端用户响应时间是真正重要的时间。

使用可用工具并不总是可以获得这个时间，例如大多数测试工具不包括浏览器呈现页面所花费的时间，因此具有糟糕 css 编写的过于复杂的页面将显示对测试的亚秒响应时间工具，但是，5 秒加上对用户的响应时间。

这些工具非常适合自动化测试和问题确定，但不要忽视您真正想要测量的内容。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2009-01-04T04:31:06.477

分析器为您提供更详细的信息，有助于诊断和修复性能问题。

在实际测量方面，秒表时间是用户注意到的，所以如果你想验证事情是否在可接受的范围内，秒表时间就可以了。

但是，当您想实际解决问题时，分析器会非常有用。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2009-01-24T07:35:47.793

您需要测试实际数量的迭代，因为根据您测试时间的方式，您会得到不同的答案。如果您只执行一次操作，那么取多次迭代的平均值可能会产生误导。如果您想知道 JVM 预热后所花费的时间，您可能会运行许多（例如 10,000 次）迭代，这些迭代不包括在计时中。

我还建议您使用`System.nanoTime()`它，因为它更准确。如果您的测试时间大约为 10 微秒或更短，您不想太频繁地调用它，否则它会改变您的结果。（例如，如果我正在测试 5 秒并且我想知道它什么时候结束，如果我知道迭代非常快，我只会每 1000 次迭代获得 nanoTime）

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-01-04T08:31:35.650

分析器可能会妨碍计时，因此我会结合使用秒表计时来识别整体性能问题，然后使用分析器来确定时间花费在哪里。根据需要重复该过程。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-01-24T07:56:42.010

> 基准测试时如何解决操作系统调度问题？

在代表您将使用的机器的系统上进行**足够长的**基准测试。如果您的操作系统降低了您的应用程序的速度，那么这应该是结果的一部分。

毫无意义，如果我没有操作系统，我的程序会更快。

如果您正在使用`Linux`，您可以使用 和 等工具来`numactl`控制CPU 的使用方式和调度。`chrt``taskset`

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-01-04T04:35:54.377

我今天运行了一个程序，它从一堆 dBase 文件中搜索并收集信息，运行只花了**一个多小时**。我看了一下代码，有根据地猜测瓶颈是什么，对算法进行了小幅改进，然后重新运行程序，这次它在**2.5 分钟内**完成。

我不需要任何花哨的分析工具或基准套件来告诉我新版本是一个重大改进。如果我需要进一步优化运行时间，我可能会做一些更复杂的分析，但这不是必需的。我发现这种“秒表基准测试”在很多情况下都是可以接受的解决方案，在这些情况下使用更高级的工具实际上会更耗时。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-01-04T06:41:26.230

毕竟，它可能是第二大流行的基准测试形式，就在“无手表基准测试”之后——我们说“这个活动看起来很慢，那个看起来很快”。

通常最重要的优化是干扰用户体验的因素——这通常取决于您执行操作的频率，以及同时发生的任何其他事情。其他形式的基准测试通常只是帮助将这些归零。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2009-01-04T08:40:22.870

我认为一个关键问题是操作的复杂性和时间长度。

有时我什至使用物理秒表测量来查看是否需要几分钟、几小时、几天甚至几周的时间来计算（我正在使用一个应用程序，其中几天的运行时间并非闻所未闻，即使秒和分钟是最常见的时间跨度）。

但是，调用计算机上任何类型的时钟系统（如链接文章中提到的 java millis 调用）所提供的自动化显然优于手动查看某项运行的时间。

探查器在工作时很好用，但我在将它们应用到我们的应用程序时遇到了问题，这通常涉及动态代码生成、动态加载 DLL 以及在两种内置的即时编译脚本语言中执行的工作我的应用程序。它们通常仅限于假设单一源语言和对复杂软件的其他不切实际的期望。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-01-04T04:15:07.523

我总是使用秒表基准测试，因为它更容易。不过，结果对我来说不需要非常准确。如果您需要准确的结果，则不应使用秒表基准测试。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2009-01-04T04:18:42.633

我不认为秒表基准测试太可怕了，但是如果您可以使用 Solaris 或 OS X 机器，您应该查看 DTrace。我用它来获取有关我的应用程序中计时的一些重要信息。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2009-01-04T05:11:37.427

我一直都这样做。我更愿意使用分析器，但我正在使用的特定领域语言的供应商没有提供。

# erlang - 打印命名参数

> ID：410450
> 
> 赞同：6
> 
> 时间：2009-01-04T04:21:19.540
> 
> 标签：erlang

Archaelus 在[这篇文章](https://stackoverflow.com/questions/383407/what-are-some-interesting-projects-to-solve-in-erlang-for-learning-purposes#383456)中建议，编写一个新的格式例程来处理命名参数可能是一个很好的学习练习。因此，本着学习语言的精神，我编写了一个处理命名参数的格式化例程。

**一个例子：**

```
1> fout:format("hello ~s{name}, ~p{one}, ~p{two}, ~p{three}~n",[{one,1},{three,3},{name,"Mike"},{two,2}]).
hello Mike, 1, 2, 3
ok 
```

**基准：**

```
1> timer:tc(fout,benchmark_format_overhead,["hello ~s{name}, ~p{one}, ~p{two}, ~p{three}~n",[{one,1},{name,"Mike"},{three,3},{two,2}],100000]).
{421000,true}
= 4.21us per call 
```

虽然我怀疑大部分开销是由于循环造成的，因为使用一个循环调用函数会在 < 1us 内产生响应。

```
1> timer:tc(fout,benchmark_format_overhead,["hello ~s{name}, ~p{one}, ~p{two}, ~p{three}~n",[{one,1},{name,"Mike"},{three,3},{two,2}],1]).
{1,true} 
```

如果在 erlang 中有更好的基准测试方法，请告诉我。

**守则：（** 已根据 Doug 的建议进行了修订）

```
-module(fout).

-export([format/2,benchmark_format_overhead/3]).

benchmark_format_overhead(_,_,0)->
    true;
benchmark_format_overhead(OString,OList,Loops) ->
    {FString,FNames}=parse_string(OString,ONames),
    benchmark_format_overhead(OString,OList,Loops-1).

format(OString,ONames) ->
    {FString,FNames}=parse_string(OString,ONames),
    io:format(FString,FNames).

parse_string(FormatString,Names) ->
    {F,N}=parse_format(FormatString),
    {F,substitute_names(N,Names)}.

parse_format(FS) ->
    parse_format(FS,"",[],"").

parse_format("",FormatString,ParamList,"")->
    {lists:reverse(FormatString),lists:reverse(ParamList)};
parse_format([${|FS],FormatString,ParamList,"")->
    parse_name(FS,FormatString,ParamList,"");
parse_format([$}|_FS],FormatString,_,_) ->
    throw({'unmatched } found',lists:reverse(FormatString)});
parse_format([C|FS],FormatString,ParamList,"") ->
    parse_format(FS,[C|FormatString],ParamList,"").

parse_name([$}|FS],FormatString,ParamList,ParamName) ->
    parse_format(FS,FormatString,[list_to_atom(lists:reverse(ParamName))|ParamList],"");
parse_name([${|_FS],FormatString,_,_) ->
    throw({'additional { found',lists:reverse(FormatString)});
parse_name([C|FS],FormatString,ParamList,ParamName) ->
    parse_name(FS,FormatString,ParamList,[C|ParamName]).

substitute_names(Positioned,Values) ->
    lists:map(fun(CN)->
                        case lists:keysearch(CN,1,Values) of
                            false ->
                                throw({'named parameter not found',CN,Values});
                            {_,{_,V}} ->
                                V
                        end end,
              Positioned). 
```

由于这是一个学习练习，我希望那些对 erlang 更有经验的人可以给我一些关于如何改进我的代码的提示。

干杯，迈克

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-04T05:37:28.187

没有评论算法，或者使用适当的库函数......

我本来希望看到更多使用模式匹配和递归；例如 parse_character （不再折叠）可能会被替换为：

```
parse_in_format ([], FmtStr, ParmStrs, ParmName) -> {FmtStr, ParmStrs};
parse_in_format ([${ | Vr], FmtStr, ParmStrs, ParmName) -> parse_in_name (Vr, FmtStr, ParmStrs, ParmName);
parse_in_format ([$} | Vr], FmtStr, ParmStrs, ParmName) -> throw() % etc.
parse_in_format ([V | Vr], FmtStr, ParmStrs, ParmName) -> parse_in_format (Vr, [V | FmtStr], ParmStrs, ParmName).

parse_in_name ([], FmtStr, ParmStrs, ParmName) -> throw() % etc.
parse_in_name ([$} | Vr], FmtStr, ParmStrs, ParmName) -> parse_in_format (Vr, FmtStr, [list_to_atom(lists:reverse(ParmName))|ParmStrs], "");
parse_in_name ([${ | Vr], FmtStr, ParmStrs, ParmName) -> throw() % etc.
parse_in_name ([V | Vr], FmtStr, ParmStrs, ParmName) -> parse_in_name (Vr, FmtStr, ParmStrs, [V | ParmName]). 
```

以一个开场

```
parse_in_format (FormatStr,  [], [], ""); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-06T22:57:30.253

除了 doug 的建议之外，我会避免`atom_to_list/1`在这里使用 - 替代名称代码不需要它们，并且在运行时生成原子几乎总是一个坏主意。字符串会很好地工作。

```
parse_name([$}|FS],FormatString,ParamList,ParamName) ->
    parse_format(FS,FormatString,[lists:reverse(ParamName)|ParamList],"");
parse_name([${|_FS],FormatString,_,_) ->
    throw({'additional { found',lists:reverse(FormatString)});
parse_name([C|FS],FormatString,ParamList,ParamName) ->
    parse_name(FS,FormatString,ParamList,[C|ParamName]). 
```

我也会使用 proplists:get_value 而不是`lists:keysearch/3`- 当你有一个包含两个元素元组的列表时，`{Name, Value}`就像我们在这里所做的那样，使用`proplists`代码是要走的路 - 它仍然有点混乱，因为我们需要 case 语句来检查缺失值所以我们可以因更好的错误而崩溃。

```
substitute_names(Positioned,Values) ->
    [ case proplists:get_value(Name, Values) of
          undefined -> erlang:exit({missing_parameter, Name});
          V -> V
      end
      || Name <- Positioned ]. 
```

由于这是一个库，它应该是替代品`io_lib`，而不是`io`. 这样我们就不必提供所有备选方案`io`（可选`IoDevice`参数等）。

```
format(OString,ONames) ->
    {FString,FNames}=parse_string(OString,ONames),
    io_lib:format(FString,FNames). 
```

总而言之，可靠的代码。如果你愿意在 BSD 或类似的东西下许可它，我很想将它添加到我的 web 框架代码[Ejango](http://github.com/archaelus/ejango/tree/master)中。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-04T08:17:03.603

如果你不知道循环开销是否会影响你的代码，你应该测量它。这很简单。

```
-define(COLOOPS, 1000000).

-export([call_overhead/1,measure_call_overhead/0, measure_call_overhead/1]).

% returns overhead in us 
measure_call_overhead() -> measure_call_overhead(?COLOOPS).
measure_call_overhead(N) -> element(1, timer:tc(?MODULE, call_overhead, [N]))/N.

call_overhead(0)->ok;
call_overhead(N)->
    ok=nop(),
    call_overhead(N-1).

nop()->ok. 
```

在我的笔记本电脑上大约是 50ns。我认为这不应该对您当前的代码产生太大影响。

另一种测量方法是直接使用统计信息（wall_clock）或统计信息（运行时间），它以毫秒为单位返回时间。好处是您不需要导出测量功能。这只是化妆品的改进。

# fonts - Web 的字体（字体）选择？

> ID：410461
> 
> 赞同：4
> 
> 时间：2009-01-04T04:28:50.540
> 
> 标签：fonts

我今天开始考虑字体（字体）选择。我为工作做的一个网站附带了这个专业完成的风格指南，详细的颜色选择、字体选择、间距等。这是我第一次看到这样的东西，但我不得不承认，他们选择的东西看起来不错.

现在我之前读过颜色理论，所以我知道互补色和选择 1、2 或 3 种不同颜色的配色方案。所以无论如何，我对我的宠物项目的那方面都很好。

但是我还没有真正看到任何关于 Web 上下文中字体选择的内容。我发现了一些关于打印字体的讨论，您可以选择下载和包含自定义字体。这不是 Web 上的选项。您仅限于浏览器（或者更确切地说，操作系统）支持的内容。我有兴趣阅读有关 IE 和 Firefox 在 Windows 和 Mac 上的支持（抱歉，Linux 太边缘化，不能考虑 CSS 字体系列后备之外的任何内容）以及这些字体传达的内容：它们是否是认真的，正式的，休闲的，邀请的等。

有人知道这样的事情吗？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-01-04T04:35:59.823

此链接似乎有您要查找的图表：

[http://www.upsdel​​l.com/BrowserNews/res_fonts.htm#a01](http://www.upsdell.com/BrowserNews/res_fonts.htm#a01)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-04T04:47:21.063

[这是](http://www.webtypography.net/)我不断回顾的关于网络排版的极好参考。涵盖排版的基础知识以及它们如何应用于网络。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-04T05:33:53.170

[http://www.typetester.org/](http://www.typetester.org/)真的很有用。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-04T05:42:11.857

如果您打算跨操作系统兼容，那么您在网络上的字体种类真的不多。.您基本上仅限于少数令人鼓舞的选择。

如果您想获得一些“严肃、正式、随意、诱人”的字体，那么您将需要在图形编辑器中创建位图图像——如果您的内容不是静态的，这当然不会有太大帮助。

对于具有“无限”范围字体处理的动态内容，我可能会尝试一些 PHP + GD 或 ImageMagick 的优点来动态生成位图。

# python - 在 Linux 上使用多处理时不出现 TKinter 窗口

> ID：410469
> 
> 赞同：4
> 
> 时间：2009-01-04T04:36:34.937
> 
> 标签：python, linux, tkinter, multiprocessing

我想在应用程序的其余部分继续运行时生成另一个进程以异步显示错误消息。

我正在使用`multiprocessing`Python 2.6 中的模块来创建进程，并尝试使用`TKinter`.

此代码在 Windows 上运行良好，但在 Linux 上运行它，`TKinter`如果我调用`'showerror("MyApp Error", "Something bad happened.")'`. 如果我通过直接调用在同一进程中运行它，它*确实*`showerrorprocess`会出现。鉴于此，它似乎`TKinter`工作正常。我可以打印到控制台并从 生成的进程中执行其他操作`multiprocessing`，因此它似乎也可以正常工作。

他们只是似乎没有一起工作。我需要做一些特别的事情来允许衍生的子进程创建窗口吗？

```
from multiprocessing import Process
from Tkinter import Tk, Text, END, BOTH, DISABLED
import sys
import traceback

def showerrorprocess(title,text):
    """Pop up a window with the given title and text. The
       text will be selectable (so you can copy it to the
       clipboard) but not editable. Returns when the
       window is closed."""
    root = Tk()
    root.title(title)
    text_box = Text(root,width=80,height=15)
    text_box.pack(fill=BOTH)
    text_box.insert(END,text)
    text_box.config(state=DISABLED)
    def quit():
        root.destroy()
        root.quit()
    root.protocol("WM_DELETE_WINDOW", quit)
    root.mainloop()

def showerror(title,text):
    """Pop up a window with the given title and text. The
       text will be selectable (so you can copy it to the
       clipboard) but not editable. Runs asynchronously in
       a new child process."""
    process = Process(target=showerrorprocess,args=(title,text))
    process.start() 
```

* * *

**编辑**

问题似乎`TKinter`是由父进程导入，并“继承”到子进程中，但不知何故，它的状态与父进程密不可分，无法在子进程中工作。只要您确保`TKinter`在生成子进程之前不导入，它就会起作用，因为这是第一次导入它的子进程。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-12T01:43:08.473

这个[讨论](http://pyinsci.blogspot.com/2008/09/python-processing.html)可能会有所帮助。

> 这是我发现的一些示例问题：
> 
> 1.  虽然多处理模块密切关注线程，但它绝对不是完全匹配的。一个例子：因为一个进程的参数必须是*pickleable*，我不得不经历很多代码更改以避免传递`Tkinter`对象，因为这些是不可 *pickleable*。线程模块不会发生这种情况。
>     
>     
> 2.  `process.terminate()`第一次尝试后并没有真正起作用。第二次或第三次尝试只是挂起解释器，可能是因为数据结构已损坏（在 API 中提到，但这没什么安慰）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-04T06:54:20.060

也许`xhost +`在从同一个 shell 调用你的程序之前调用 shell 命令会起作用？

我猜你的问题在于X-server。

# iphone - 如何从 UINavigationController 弹出视图并在一次操作中将其替换为另一个视图？

> ID：410471
> 
> 赞同：84
> 
> 时间：2009-01-04T04:38:35.760
> 
> 标签：iphone, cocoa-touch, uinavigationcontroller, uiviewanimation

我有一个应用程序，我需要从 UINavigationController 的堆栈中删除一个视图并将其替换为另一个视图。情况是第一个视图创建了一个可编辑的项目，然后用该项目的编辑器替换了它自己。当我在第一个视图中执行明显的解决方案时：

```
MyEditViewController *mevc = [[MYEditViewController alloc] initWithGizmo: gizmo];

[self retain];
[self.navigationController popViewControllerAnimated: NO];
[self.navigationController pushViewController: mevc animated: YES];
[self release]; 
```

我得到非常奇怪的行为。通常会出现编辑器视图，但如果我尝试使用导航栏上的后退按钮，我会得到额外的屏幕，有些是空白的，有些只是搞砸了。标题也变得随机。就像导航堆栈完全被冲洗了一样。

解决这个问题的更好方法是什么？

谢谢，马特

* * *

## 回答 #1

> 赞同：137
> 
> 时间：2009-11-24T01:59:36.797

I've discovered you don't need to manually mess with the `viewControllers` property at all. Basically there are 2 tricky things about this.

1.  `self.navigationController` will return `nil` if `self` is not currently on the navigation controller's stack. So save it to a local variable before you lose access to it.
2.  You must `retain` (and properly `release`) `self` or the object who owns the method you are in will be deallocated, causing strangeness.

Once you do that prep, then just pop and push as normal. This code will instantly replace the top controller with another.

```
// locally store the navigation controller since
// self.navigationController will be nil once we are popped
UINavigationController *navController = self.navigationController;

// retain ourselves so that the controller will still exist once it's popped off
[[self retain] autorelease];

// Pop this controller and replace with another
[navController popViewControllerAnimated:NO];
[navController pushViewController:someViewController animated:NO]; 
```

In that last line if you change the `animated` to `YES`, then the new screen will actually animate in and the controller you just popped will animate out. Looks pretty nice!

* * *

## 回答 #2

> 赞同：56
> 
> 时间：2012-01-04T11:11:25.513

以下方法对我来说似乎更好，并且也适用于 ARC：

```
UIViewController *newVC = [[UIViewController alloc] init];
// Replace the current view controller
NSMutableArray *viewControllers = [NSMutableArray arrayWithArray:[[self navigationController] viewControllers]];
[viewControllers removeLastObject];
[viewControllers addObject:newVC];
[[self navigationController] setViewControllers:viewControllers animated:YES]; 
```

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2009-01-04T23:57:09.433

根据经验，您将不得不直接摆弄 UINavigationController 的`viewControllers`属性。像这样的东西应该工作：

```
MyEditViewController *mevc = [[MYEditViewController alloc] initWithGizmo: gizmo];

[[self retain] autorelease];
NSMutableArray *controllers = [[self.navigationController.viewControllers mutableCopy] autorelease];
[controllers removeLastObject];
self.navigationController.viewControllers = controllers;
[self.navigationController pushViewController:mevc animated: YES]; 
```

注意：我将保留/释放更改为保留/自动释放，因为这通常更健壮 - 如果保留/释放之间发生异常，您将泄漏自我，但自动释放会处理这一点。

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2009-01-10T01:10:31.443

After much effort (and tweaking the code from Kevin), I finally figured out how to do this in the view controller that is being popped from the stack. The problem that I was having was that self.navigationController was returning nil after I removed the last object from the controllers array. I think it was due to this line in the documentation for UIViewController on the instance method navigationController "Only returns a navigation controller if the view controller is in its stack."

I think that once the current view controller is removed from the stack, its navigationController method will return nil.

Here is the adjusted code that works:

```
UINavigationController *navController = self.navigationController;
MyEditViewController *mevc = [[MYEditViewController alloc] initWithGizmo: gizmo];

NSMutableArray *controllers = [[self.navigationController.viewControllers mutableCopy] autorelease];
[controllers removeLastObject];
navController.viewControllers = controllers;
[navController pushViewController:mevc animated: YES]; 
```

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2010-06-23T14:50:51.903

谢谢，这正是我需要的。我还将它放在动画中以获取页面卷曲：

```
 MyEditViewController *mevc = [[MYEditViewController alloc] initWithGizmo: gizmo];

    UINavigationController *navController = self.navigationController;      
    [[self retain] autorelease];

    [UIView beginAnimations:nil context:NULL]; [UIView setAnimationDuration: 0.7];
    [UIView setAnimationTransition:<#UIViewAnimationTransitionCurlDown#> forView:navController.view cache:NO];

    [navController popViewControllerAnimated:NO];
    [navController pushViewController:mevc animated:NO];

    [UIView commitAnimations]; 
```

0.6 的持续时间很快，对 3GS 和更新版本有好处，0.8 对 3G 来说还是有点太快了。

约翰

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2014-01-08T13:20:14.963

如果您想通过 popToRootViewController 显示任何其他视图控制器，那么您需要执行以下操作：

```
 UIViewController *newVC = [[WelcomeScreenVC alloc] initWithNibName:@"WelcomeScreenVC" bundle:[NSBundle mainBundle]];
            NSMutableArray *viewControllers = [NSMutableArray arrayWithArray:[[self navigationController] viewControllers]];
            [viewControllers removeAllObjects];
            [viewControllers addObject:newVC];
            [[self navigationController] setViewControllers:viewControllers animated:NO]; 
```

现在，您之前的所有堆栈都将被删除，并且将使用您所需的 rootViewController 创建新堆栈。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2011-03-24T04:06:50.763

我最近不得不做类似的事情，并将我的解决方案基于迈克尔斯的回答。在我的情况下，我必须从导航堆栈中删除两个视图控制器，然后添加一个新的视图控制器。打电话

```
[控制器 removeLastObject];
```

两次，在我的情况下工作得很好。 `````
UINavigationController *navController = self.navigationController;

// retain ourselves so that the controller will still exist once it's popped off
[[self retain] autorelease];

searchViewController = [[SearchViewController alloc] init];    
NSMutableArray *controllers = [[self.navigationController.viewControllers mutableCopy] autorelease];

[controllers removeLastObject];
// In my case I want to go up two, then push one..
[controllers removeLastObject];
navController.viewControllers = controllers;

NSLog(@"controllers: %@",controllers);
controllers = nil;

[navController pushViewController:searchViewController animated: NO]; 
````  `* * *

## 回答 #8

> 赞同：1
> 
> 时间：2013-04-22T20:15:46.197

我最喜欢的方法是使用 UINavigationController 上的类别。以下应该有效：

**UINavigationController+Helpers.h** #import

```
@interface UINavigationController (Helpers)

- (UIViewController*) replaceTopViewControllerWithViewController: (UIViewController*) controller;

@end 
```

**UINavigationController+Helpers.m**
#import "UINavigationController+Helpers.h"

```
@implementation UINavigationController (Helpers)

- (UIViewController*) replaceTopViewControllerWithViewController: (UIViewController*) controller {
    UIViewController* topController = self.viewControllers.lastObject;
    [[topController retain] autorelease];
    UIViewController* poppedViewController = [self popViewControllerAnimated:NO];
    [self pushViewController:controller animated:NO];
    return poppedViewController;
}

@end 
```

然后从您的视图控制器中，您可以像这样用新的替换顶视图：

```
[self.navigationController replaceTopViewControllerWithViewController: newController]; 
```

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2012-06-01T14:36:26.643

这是另一种不需要直接弄乱 viewControllers 数组的方法。检查控制器是否已经弹出，如果是，请推送它。

```
TasksViewController *taskViewController = [[TasksViewController alloc] initWithNibName:nil bundle:nil];

if ([navigationController.viewControllers indexOfObject:taskViewController] == NSNotFound)
{
    [navigationController pushViewController:taskViewController animated:animated];
}
else
{
    [navigationController popToViewController:taskViewController animated:animated];
} 
```

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2009-01-04T05:03:16.303

此`UINavigationController`实例方法可能有效...

弹出视图控制器，直到指定的视图控制器是顶视图控制器，然后更新显示。

```
- (NSArray *)popToViewController:(UIViewController *)viewController animated:(BOOL)animated 
```

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2012-11-23T07:18:17.220

```
NSMutableArray *controllers = [self.navigationController.viewControllers mutableCopy];
    for(int i=0;i<controllers.count;i++){
       [controllers removeLastObject];
    }
 self.navigationController.viewControllers = controllers; 
```

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2012-09-25T11:15:49.067

您可以检查导航视图控制器数组，该数组为您提供了在导航堆栈中添加的所有视图控制器。通过使用该数组，您可以返回导航到特定的视图控制器。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2013-08-20T05:27:15.353

或者，

你可以`category`用来避免`self.navigationController`被`nil`追`popViewControllerAnimated`

只需弹出和推送，很容易理解，不需要访问`viewControllers`....

```
// UINavigationController+Helper.h
@interface UINavigationController (Helper)

- (UIViewController*) popThenPushViewController:(UIViewController *)viewController animated:(BOOL)animated;

@end

// UINavigationController+Helper.m
@implementation UINavigationController (Helper)

- (UIViewController*) popThenPushViewController:(UIViewController *)viewController animated:(BOOL)animated
{
    UIViewController *v =[self popViewControllerAnimated:NO];

    [self pushViewController:viewController animated:animated];

    return v;
}
@end 
```

在您的视图控制器中

```
// #import "UINavigationController+Helper.h"
// invoke in your code
UIViewController *v= [[MyNewViewController alloc] init];

[self.navigationController popThenPushViewController:v animated:YES];

RELEASE_SAFELY(v); 
```

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2013-06-25T22:05:49.683

对于 monotouch / xamarin IOS：

在 UISplitViewController 类里面；

```
UINavigationController mainNav = this._navController; 
//List<UIViewController> controllers = mainNav.ViewControllers.ToList();
mainNav.ViewControllers = new UIViewController[] { }; 
mainNav.PushViewController(detail, true);//to have the animation 
```

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2015-06-24T17:14:42.617

不完全是答案，但在某些情况下可能会有所帮助（例如我的）：

如果您需要弹出视图控制器 C 并转到 B（堆栈外）而不是 A（C 下方的那个），则可以将 B 推到 C 之前，并将所有 3 个都放在堆栈上。通过保持 B 推送不可见，并选择仅弹出 C 或同时弹出 C 和 B，您可以达到相同的效果。

初始问题 A -> C（我想弹出 C 并显示 B，出栈）

可能的解决方案 A -> B（推到不可见）-> C（当我弹出 C 时，我选择显示 B 或同时弹出它）

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2018-02-27T04:28:00.467

我使用此解决方案来保留动画。

```
[self.navigationController pushViewController:controller animated:YES];
NSMutableArray *newControllers = [NSMutableArray arrayWithArray:self.navigationController.viewControllers];
[newControllers removeObject:newControllers[newControllers.count - 2]];
[self.navigationController setViewControllers:newControllers]; 
```

# python - reddit URL 中的字母数字 ID 是什么？

> ID：410485
> 
> 赞同：15
> 
> 时间：2009-01-04T05:00:52.253
> 
> 标签：python, url, slug, reddit

`7n5lu`reddit URL 中的内容是什么

> [http://www.reddit.com/r/reddit.com/comments/7n5lu/man_can_fly_if_you_watch_one_video_in_2](http://www.reddit.com/r/reddit.com/comments/7n5lu/man_can_fly_if_you_watch_one_video_in_2)

...它是如何产生的？

更新：@Gerald，我最初认为这是对 id 的一些混淆。它只是将整数转换为更紧凑的表示。我在想，为什么要这样做？为什么不使用原始整数本身！

```
>>> to36(4000)
'334'
>>> to36(4001)
'335' 
```

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2009-01-04T05:21:43.973

reddit 源代码[可用](https://github.com/reddit/reddit)！这是我发现生成该字符串的内容：

```
def to_base(q, alphabet):
    if q < 0: raise ValueError, "must supply a positive integer"
    l = len(alphabet)
    converted = []
    while q != 0:
        q, r = divmod(q, l)
        converted.insert(0, alphabet[r])
    return "".join(converted) or '0'

def to36(q):
    return to_base(q, '0123456789abcdefghijklmnopqrstuvwxyz') 
```

和其他地方，在“链接”类下：

```
@property
def _id36(self):
    return to36(self._id) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-04T05:13:45.377

这看起来像是线程的唯一 ID。它最有可能用于在数据库中查找线程。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2019-06-05T21:06:33.530

它是一个整数，以 36 为基数。id 是按顺序生成的。例如， id 之后的评论`89`是 id`8a`等。鉴于此，您不需要 URL 中的任何其他信息。

理论上，评论、帖子、消息、用户和 subreddit 可以具有相同的 ID 并计数。您可以通过它们的“全名”来区分它们，即事物的类型、下划线，然后是下划线。

`t1`是评论，`t2`是用户，`t3`是提交，`t4`是消息，`t5`是 subreddit，`t6`是奖励，`ModAction`是主持人操作，`ModmailConversation`是 modmail 对话等。

有关更多信息，请参阅[API 文档](https://www.reddit.com/dev/api)。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2009-01-04T07:56:11.603

一点评论。

对于这个例子来说这还不够，但通常附加到列表中

```
a = []
for i in range(NNN): a.append(i)
a.reverse() 
```

确实比在头部插入更有效。

```
a = []
for i in range(NNN): a.insert(0,i) 
```

.

# .net - 用户需要什么来运行 WPF 浏览器应用程序？

> ID：410495
> 
> 赞同：1
> 
> 时间：2009-01-04T05:12:28.970
> 
> 标签：.net, wpf, browser

自过去 4 年以来，我一直在开发 WinForms 和 WebForms。直到现在我还没有考虑迁移到 WPF，但我现在正在考虑。请告诉我客户端需要什么才能在浏览器中正确运行 WPF 应用程序。它与哪些平台兼容？

用户是否需要安装任何特殊插件？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-04T06:28:29.517

来自 MSDN：

> 要运行 WPF 应用程序，必须在客户端上安装 Microsoft .NET Framework。当浏览 WPF 浏览器托管的应用程序时，Internet Explorer 7 会自动检测客户端是否安装了 .NET Framework。如果未安装，Internet Explorer 7 会提示用户安装它。
> 
> 为了检测是否安装了 .NET Framework，Internet Explorer 7 包含一个引导应用程序，该应用程序注册为具有以下扩展名的内容文件的备用多用途 Internet 邮件扩展 (MIME) 处理程序：.xaml、.xps、.xbap 和 .application . 当导航到这些文件类型并且客户端上未安装 .NET Framework 时，引导程序应用程序会请求安装它的权限。如果未提供权限，则不会安装 .NET Framework 和应用程序。
> 
> 如果授予权限，Internet Explorer 7 将使用 Microsoft 后台智能传输服务 (BITS) 下载并安装 .NET Framework。成功安装 .NET Framework 后，最初请求的文件将在新的浏览器窗口中启动。
> 
> .NET Framework 自动检测可在安装了 Internet Explorer 7 的 Windows Vista、Microsoft Windows XP Service Pack 2 (SP2) 和 Microsoft Windows Server 2003 (SP1) 客户端上使用。

我认为此时您的 WPF 浏览器应用程序的受众可能会受到一定程度的限制。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-04T06:02:48.977

在客户端上，您需要安装 3.5 版本的 .net 框架和 IE6+ 或 Firefox。

# reflection - 使用反射来实例化“构建器模式”（Joshua Bloch）

> ID：410500
> 
> 赞同：1
> 
> 时间：2009-01-04T05:15:39.820
> 
> 标签：reflection, builder

当尝试使用 Joshua Bloch 的“Builder Pattern”[ *Effective Java Second Edition*中的第 2 项] 和反射 [ **object = constructors[index].newInstance(constructorParameterValues);** ] 发生以下异常：

java.lang.IllegalAccessException：类 info.soaj.core.util.SjUtilReflection 无法使用修饰符“private”访问类 info.soaj.core.attribute.SjAttributesForThrowable 的成员

注意：这已解决。可访问（私有）构造函数正在被丢弃，并且正在尝试不可访问（覆盖 = false）。底线：程序员错误

一个示例生成器类如下：

```
package info.soaj.core.attribute;

import info.soaj.core.attribute.internal.SjAttributesForStronglyTypedWrappers;
import info.soaj.core.internal.string.SjPopulatedClassName;
import info.soaj.core.internal.string.SjPopulatedMethodName;
import info.soaj.core.util.internal.SjUtilThrowable;

import java.io.Serializable;

/**
 * <p>
 * The "Builder" pattern as documented by Joshua Bloch ("Effective Java" -
 * Second Edition) is utilized to handle the variable number of required and
 * optional parameters.
 * </p>
 * 
 * <p style="font-family:Verdana; font-size:10px; font-style:italic"> Copyright
 * (c) 2006 - 2008 by Global Technology Consulting Group, Inc. at <a
 * href="http://gtcGroup.com">gtcGroup.com </a>. </p>
 * 
 * @author MarvinToll@gtcGroup.com
 * @since v. 1.0
 */

public class SjAttributesExample implements Serializable {

    /** UID */
    private static final long serialVersionUID = 1L;

    /** The name of class throwing the exception. */
    protected final SjPopulatedClassName classname;

    /** The name of method throwing the exception. */
    protected final SjPopulatedMethodName methodname;

    /**
     * Suppresses logging; default is <code>false</code>.
     */
    protected final boolean suppressLoggingOnly;

    /**
     * Constructor - private
     * 
     * @param builderThrowable
     */
    private SjAttributesExample(final BuilderThrowable builderThrowable) {
        this.classname = builderThrowable.classname;
        this.methodname = builderThrowable.methodname;
        this.suppressLoggingOnly = builderThrowable.suppressLoggingOnly;
    }

    /**
     * This static member immutable class is used to implement the builder
     * pattern.
     * 
     * @author MarvinToll@gtcGroup.com
     * @since v. 1.0
     */
    public static class BuilderThrowable {

        /** Class name. */
        private static final String CLASS_NAME = BuilderThrowable.class
                .getName();

        // Required attributes.

        /** The name of class throwing the exception. */
        protected final SjPopulatedClassName classname;

        /** The name of method throwing the exception. */
        protected final SjPopulatedMethodName methodname;

        // Optional attributes.

        /** Prevents action from occurring. Default is false. */
        protected boolean suppressLoggingOnly = false;

        /**
         * Constructor
         * 
         * @param classname
         * @param methodname
         */
        public BuilderThrowable(final String classname, final String methodname) {

            super();

            final String Method_Name = "BuilderThrowable";

            // What happens when handling an exception throws an exception?
            try {

                this.classname = new SjPopulatedClassName(classname,
                        new SjAttributesForStronglyTypedWrappers(CLASS_NAME,
                                Method_Name));

                this.methodname = new SjPopulatedMethodName(methodname,
                        new SjAttributesForStronglyTypedWrappers(CLASS_NAME,
                                Method_Name));

            } catch (final RuntimeException e) {

                // Log the contextual details.
                SjUtilThrowable.logExceptionOccuredWhileThrowingException(
                        CLASS_NAME, Method_Name, e);

                throw e;
            }

            return;
        }

        /**
         * This method sets a flag to suppress logging.
         * 
         * @param isLoggingSuppressed
         * @return BuilderThrowable
         */
        public BuilderThrowable suppressLoggingOnly(
                final boolean isLoggingSuppressed) {

            this.suppressLoggingOnly = isLoggingSuppressed;

            return this;
        }

        /**
         * This method is used for instantiating this class.
         * 
         * @return SjAttributesForThrowable
         */
        @SuppressWarnings("synthetic-access")
        public SjAttributesExample build() {

            return new SjAttributesExample(this);
        }
    }

    /**
     * This method returns an attribute.
     * 
     * @return String - Returns the <code>classname</code> attribute.
     */
    public String getClassname() {
        return this.classname.getString();
    }

    /**
     * This method returns an attribute.
     * 
     * @return String - Returns the <code>methodname</code> attribute.
     */
    public String getMethodname() {
        return this.methodname.getString();
    }

    /**
     * This method returns an attribute.
     * 
     * @return boolean - Returns the <code>suppressLoggingOnly</code> attribute.
     */
    public boolean isLoggingSuppressed() {
        return this.suppressLoggingOnly;
    }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-01-04T13:19:18.143

注意：这已解决。可访问（私有）构造函数正在被丢弃，并且正在尝试不可访问（覆盖 = false）。底线：程序员错误

# winapi - Win32 文件名比较

> ID：410502
> 
> 赞同：18
> 
> 时间：2009-01-04T05:18:35.697
> 
> 标签：winapi, case-insensitive

有谁知道 Win32 在处理不区分大小写的文件名时使用什么文化设置？

这是根据用户的文化而变化的东西，还是 Win32 使用文化不变的大小写规则？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-01-04T06:30:30.497

一个近似的答案是 [正确比较 Unicode 文件名](http://web.archive.org/web/20130528052217/http://blogs.msdn.com:80/b/michkap/archive/2005/10/17/481600.aspx)。

基本上，建议将两个字符串都大写（使用[`CharUpper`](https://msdn.microsoft.com/en-us/library/windows/desktop/ms647474(v=vs.85).aspx)、、[`CharUpperBuff`](https://msdn.microsoft.com/en-us/library/windows/desktop/ms647475(v=vs.85).aspx)或[`LCMapString`](https://msdn.microsoft.com/en-us/library/windows/desktop/dd318700(v=vs.85).aspx)），然后使用二进制比较（即 memcmp 或 wmemcmp，而不是具有不变语言环境的 CompareString）进行比较。文件系统不进行 Unicode 规范化，大小写规则不依赖于区域设置。

不幸的是，在处理大小写规则在不同版本的 Unicode 中发生变化的字符时会出现模棱两可的情况，但它几乎可以做到。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-01-04T07:14:49.317

[比较本机代码中的文件名](https://docs.microsoft.com/en-us/archive/blogs/greggm/comparing-file-names-in-native-code)和[不比较文件名](https://docs.microsoft.com/en-us/archive/blogs/greggm/dont-compare-file-names)是关于这个主题的几篇很好的博客文章。第一个有用于 OrdinalIgnoreCaseCompareStrings 的 C/C++ 代码，第二个告诉您这并不总是适用于文件名以及如何缓解这种情况。

> 然后是Unicode问题。虽然这些新的`OrdinalIgnoreCase`字符串比较算法非常适合您的本地 NTFS 驱动器，但它们可能无法在您的 FAT 驱动器或网络共享上产生正确的答案。
> 
> 那么答案是什么？如果可能，让文件系统告诉您。[`CreateFile`](http://msdn.microsoft.com/library/default.asp?url=/library/en-us/fileio/fs/createfile.asp)可以告诉你给定的文件名是否存在。只需选择正确的创作倾向。如果需要与句柄进行比较，可以经常使用[`GetFileInformationByHandle`](http://msdn.microsoft.com/library/default.asp?url=/library/en-us/fileio/fs/getfileinformationbyhandle.asp); 看`dwVolumeSerialNumber`/ `nFileIndexHigh`/ `nFileIndexLow`。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2014-12-21T12:40:56.957

如果您使用的是**.NET**，Microsoft 的官方建议是[`StringComparison.OrdinalIgnoreCase`](http://msdn.microsoft.com/en-us/library/system.stringcomparison.aspx)用于比较和[`ToUpperInvariant`](http://msdn.microsoft.com/en-us/library/system.string.toupperinvariant.aspx)规范化（稍后使用比较进行`Ordinal`比较）。这也适用于注册表项和值、环境变量等。

有关更多详细信息，请参阅[Microsoft .NET 2.0 中使用字符串的新建议。](http://msdn.microsoft.com/en-us/library/ms973919.aspx)

请注意，虽然它在 NTFS 上是可靠的，但它可能会因网络共享而失败，例如。请参阅@SteveSteiner 的答案和他的帖子中的链接以获取解决方案。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2022-02-10T21:36:20.223

根据[Windows Driver Samples](https://github.com/microsoft/Windows-driver-samples/tree/master/filesys) FastFAT 和 CDFS，它用于`RtlUpcaseUnicodeString`将字符串转换为大写。根据 Ghidra 的简要介绍，它使用名为 的内部函数`NLS_UPCASE`，其行为**基于您当前的系统代码页**。

# ruby-on-rails - 为什么 ActiveRecord 为每个连接发出单独的查询？

> ID：410512
> 
> 赞同：2
> 
> 时间：2009-01-04T05:33:14.467
> 
> 标签：ruby-on-rails, ruby, database, performance, activerecord

我正在执行 ActiveRecord 查找操作（通过“will_paginate”库），如下所示：

```
 contacts = Contact.paginate(:all,
    :conditions => conditions_specified,
    :select => "DISTINCT contacts.*",
    :joins => joins,
    :include => [:addresses, :emails, :phone_numbers, {:addresses => :organization}],
    :page => page,
    :per_page => @@PAGE_SIZE,
    :order => 'last_name, first_name, middle_name') 
```

在控制台中，我得到如下所示的输出。通过设置`include`参数，我希望这只会导致一个查询。但是在输出中我看到了很多查询。例如，我很惊讶地看到这条线......

```
 Address Load (2.5ms)   SELECT `addresses`.* FROM `addresses` WHERE (`addresses`.contact_id IN (94,106,104,108,121,55,40,75,62,4,67,36,77,64,7,35,24,68,57,117,8,30,85)) 
```

在下面的输出中。（我知道`SHOW FIELDS FROM`查询在生产中被缓存，所以这不是问题。这是我试图弄清楚的所有额外的选择。）

```
Processing ContactController#index (for 127.0.0.1 at 2009-01-03 21:21:18) [GET]
  Session ID: d453897c2f67c29c9a68d3fbc7b94f7b
  ContactSearch Columns (4.4ms)   SHOW FIELDS FROM `contact_searches`
  Contact Load (1.1ms)   SELECT DISTINCT contacts.* FROM `contacts` WHERE (contacts.last_name LIKE '%n%') ORDER BY last_name, first_name, middle_name LIMIT 0, 35
  Contact Columns (2.3ms)   SHOW FIELDS FROM `contacts`
  Address Load (2.5ms)   SELECT `addresses`.* FROM `addresses` WHERE (`addresses`.contact_id IN (94,106,104,108,121,55,40,75,62,4,67,36,77,64,7,35,24,68,57,117,8,30,85))
  Address Columns (2.7ms)   SHOW FIELDS FROM `addresses`
  Email Load (1.7ms)   SELECT `emails`.* FROM `emails` WHERE (`emails`.contact_id IN (94,106,104,108,121,55,40,75,62,4,67,36,77,64,7,35,24,68,57,117,8,30,85))
  Email Columns (1.8ms)   SHOW FIELDS FROM `emails`
  PhoneNumber Load (3.3ms)   SELECT `phone_numbers`.* FROM `phone_numbers` WHERE (`phone_numbers`.contact_id IN (94,106,104,108,121,55,40,75,62,4,67,36,77,64,7,35,24,68,57,117,8,30,85))
  PhoneNumber Columns (3.0ms)   SHOW FIELDS FROM `phone_numbers`
  Organization Columns (2.9ms)   SHOW FIELDS FROM `organizations`
  Organization Load (0.9ms)   SELECT * FROM `organizations` WHERE (`organizations`.`id` IN (99,116,44,6,23,78,107,91,79,119,14,120,71,26,59,94,27,100,62,1,51,29,30,2,65,76,5))
Rendering template within layouts/main
Rendering contact/index
Rendered contact/_field_function_specifier (0.9ms)
Rendered contact/_field_function_specifier (0.6ms)
Rendered contact/_field_function_specifier (0.6ms)
Rendered contact/_field_function_specifier (0.6ms)
Rendered contact/_field_function_specifier (0.6ms)
Rendered contact/_field_function_specifier (0.6ms)
Rendered contact/_field_function_specifier (0.6ms)
Rendered contact/_field_function_specifier (0.6ms)
Rendered contact/_field_function_specifier (0.6ms)
Rendered contact/_field_function_specifier (0.6ms)
Rendered contact/_search_form (14.1ms)
Rendered contact/_quick_view_contact_info (3.2ms)
Rendered contact/_quick_view_contact_info (2.1ms)
Rendered contact/_quick_view_contact_info (1.9ms)
Rendered contact/_quick_view_contact_info (1.9ms)
Rendered contact/_quick_view_contact_info (0.8ms)
Rendered contact/_quick_view_contact_info (2.0ms)
Rendered contact/_quick_view_contact_info (2.4ms)
Rendered contact/_quick_view_contact_info (1.7ms)
Rendered contact/_quick_view_contact_info (1.4ms)
Rendered contact/_quick_view_contact_info (1.7ms)
Rendered contact/_quick_view_contact_info (2.2ms)
Rendered contact/_quick_view_contact_info (1.5ms)
Rendered contact/_quick_view_contact_info (2.0ms)
Rendered contact/_quick_view_contact_info (1.7ms)
Rendered contact/_quick_view_contact_info (1.8ms)
Rendered contact/_quick_view_contact_info (3.6ms)
Rendered contact/_quick_view_contact_info (2.2ms)
Rendered contact/_quick_view_contact_info (2.2ms)
Rendered contact/_quick_view_contact_info (1.9ms)
Rendered contact/_quick_view_contact_info (1.7ms)
Rendered contact/_quick_view_contact_info (2.0ms)
Rendered contact/_quick_view_contact_info (2.1ms)
Rendered contact/_quick_view_contact_info (1.9ms)
Completed in 308ms (View: 104, DB: 27) | 200 OK [http://localhost/contact] 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-04T06:07:45.940

我做了更多的研究并找到了答案。我正在为稍后搜索的人更新此内容。长答案在[这篇博](http://darwinweb.net/articles/66-optimizing_and_simplifying_limited_eager_loading_in_activerecord)文中。

看来，当您执行同时具有连接和限制的查找时，ActiveRecord 必须首先查询主表以获取要返回的行的 ID，然后仅使用 ID 重做查询以应用限制。

由于我使用的是`will_paginate`，这就是`will_paginate`使用`limit`ed 查询进行分页时发生的情况。

# c++ - 使用 C++ 头文件的最佳实践

> ID：410516
> 
> 赞同：23
> 
> 时间：2009-01-04T05:38:36.920
> 
> 标签：c++, header-files

我对头文件的使用有以下疑问。

**1 - 包括在评论后放置的守卫**

```
/* Copyright Note and licence information (multiple lines) */
#ifndef FOO_H
#define FOO_H
// Header file contents
#endif 
```

Herb Sutter 在他的“C++ 编码标准”一书中说，像上面这样的代码是有问题的。他说“#ifndef”语句应该出现在头文件的第一行。我觉得这没有说服力。这是你们/女孩在头文件中的后续吗？

**2 - 在头文件中使用命名空间**

```
#ifndef FOO_H
#define FOO_H
namespace FooNameSpace{
    // Header file contents
}
#endif 
```

上面的代码是否使用正确的做法？我的意思是，你在头文件中使用命名空间吗？我知道为什么在头文件中导入命名空间是没有意义的，但是像上面这样的声明呢？

如果上述方法是正确的，您如何对另一个命名空间中的类进行“*前向声明”？*是不是像

```
#ifndef FOO_H
#define FOO_H
namespace AnotherNameSpace{
    class AnotherFoo; // forward declaration
}

namespace FooNameSpace{
    // Use AnotherFoo here
}
#endif 
```

“*前向声明*”是避免“*循环依赖*”的唯一方法，对吗？

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2009-01-04T05:49:17.617

1.  包含守卫和注释的顺序纯粹是风格问题 - 它不会对编译速度产生任何可衡量的影响。

2.  命名空间绝对应该在头文件中用于声明函数、类、全局变量等。你不应该*做*的是在头文件中使用`using`语句——不可能在包含它的源文件中取消使用某些东西，你不应该强制包含器将额外的东西添加到全局范围。如果您需要在标头中使用来自其他命名空间的内容，请完全限定每个名称。有时可能会很痛苦，但这确实是正确的做法。

例子：

```
// WRONG!
using namespace std;
class MyClass
{
    string stringVar;
};

// RIGHT
class MyClass
{
    std::string stringVar;
}; 
```

至于其他命名空间中的类的前向声明，您完全正确。`AnotherFoo`只要记住`AnotherNameSpace::AnotherFoo`在标题中引用它时始终符合条件。事实上，前向声明是打破循环依赖的唯一方法。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-01-04T05:59:56.673

1.  我听说在包含保护之前有注释会导致一些编译器错过优化。如果守卫是第一件事，编译器可能会识别成语，甚至不会费心打开标题以进行后续包含。在我自己的代码中，注释通常在包含保护之前。我从来没有费心测试过这是否有任何影响。而且我可能永远不会（但如果其他人这样做，我会对结果感兴趣）。

2.  当然，标头应该包含命名空间——否则命名空间内不可能有任何有用的东西。但是，正如您所提到的，标头不应使用“ `using`”指令将名称空间“导入”（为了更好的词）到编译单元中。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-01-04T05:54:08.103

关于#1，我不知道有任何具体的支持或反对的论据。许多公司都有这样的政策，即版权声明必须是文件中的第一项，然后是其他任何内容或任何有意义的代码（也许假设您会在吸收任何代码之前阅读版权）。为此，#IFNDEF 已经是代码。从可用性的角度来看，将版权放在首位是有意义的，因为眼睛会忽略它们。但是，在我看来，任何描述该模块的内容都应该出现在#ifndef 之后。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-01-04T05:54:59.570

1）由于评论实际上并没有做任何事情，我怀疑它很重要。但从技术上讲，#include 复制和粘贴，因此将注释放在标头保护之外可能意味着预处理器需要做更多的工作。我不知道大多数编译器是否足够聪明以对此进行优化（即，如果它们在预处理器步骤之前去除注释），但您可能不会注意到，直到您达到数以万计的头文件。

2）这是正确的。如果您想将一个类放在命名空间中，并且该类将在头文件中声明，那么它应该在命名空间中声明，因此应该在头文件中。是的，这就是您转发声明的方式。是的，它是避免循环依赖的主要工具（您也可以更改您的设计，但原则上循环没有任何问题，前提是所讨论的两个类仅通过引用或指针相互引用而不调用任何方法） .

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-01-04T06:03:02.113

1.  正如亚当对这篇文章的回答所指出的那样，我认为添加评论不会对性能产生任何影响。

2.  我在头文件中使用了自己的命名空间，如果你定义自己的字符串类怎么办，所以它会与 std 命名空间字符串类发生冲突。

准确地使用“using”关键字并没有错（因为它为您提供了很多便利，并且在所有变量之前输入的内容更少）

# xhtml - 将页面标题栏链接到主页 - 最佳实践？

> ID：410530
> 
> 赞同：4
> 
> 时间：2009-01-04T05:59:44.083
> 
> 标签：xhtml

如果不是所有网站，我都会使用页面标题栏（通常是我的页面上的样式 h1）链接回主页。

这应该链接在第一页，即主页上吗？我读到这不应该被链接，但是当我第一次进入一个页面时，我做的一件事就是将鼠标悬停在标题上以检查状态栏，看看它是否会把我送回家。

我要问的是最佳实践......主页的标题是否应该链接回自身以供用户将来参考？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-04T07:11:35.623

查看 facebook 等网站 - facebook 徽标始终链接到主页。

这是一个强大的约定，我会尝试在可行的情况下使用它。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-04T08:05:48.883

虽然我理解页面不链接到自身的逻辑，但我个人认为标题栏是一个可辩护的例外。所以我认为你应该把它链接到主页，即使是在主页上。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-04T06:06:58.297

页面上不应该有链接到自身的链接。根据[Jakob Nielsen](http://www.useit.com/)的研究，这是一个坏主意。进一步阅读[here](http://www.useit.com/alertbox/20031222.html)（#10）和[here](http://www.useit.com/alertbox/20031110.html)（也是该列表中的#10）。

# c# - 什么是失控 switch 语句的最佳替代方案？

> ID：410532
> 
> 赞同：11
> 
> 时间：2009-01-04T06:00:37.390
> 
> 标签：c#, javascript, refactoring, switch-statement

我继承了一个项目，该项目有一些巨大的 switch 语句块，其中一些包含多达 20 个案例。重写这些的好方法是什么？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2009-01-04T06:06:57.207

为什么要以不同的结构重写它们？如果你真的有 20 个案例需要单独处理，那么 switch/case 就是要走的路。一大串 if/then 逻辑很难维护。

如果您使用面向对象的语言，多态是另一种选择。每个子类都会在方法中实现它自己的功能。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-01-04T06:05:08.893

多态性。但这可能不是一个微不足道的重构。

一些例子和参考：

[重构（谷歌书籍）](http://books.google.com.au/books?id=1MsETFPD3I0C&pg=PA82&lpg=PA82&dq=Polymorphism+switch+statement&source=web&ots=pKO-k1YCdd&sig=PD19V8Revm2kwRQk2yF8bF9wGPs&hl=en&sa=X&oi=book_result&resnum=7&ct=result)

[Switch 语句代码异味和多态性](http://hanuska.blogspot.com/2006/08/swich-statement-code-smell-and.html)

[重构 switch 语句](http://sourcemaking.com/refactoring/switch-statements)

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-01-04T11:36:58.100

正如其他人指出的那样，这取决于 switch 语句。但是，过去我通过以下方式重构了 switch 语句。假设我们有一个这样的 switch 语句，有很多重复的代码

```
switch(x){
   case 1:
     makeitso("foo");
     globalLog += "foo";
   case 2:
     makeitso("bar");
     globalLog += "bar";
   case 3:
     makeitso("baz");
     globalLog += "baz";
   ...
   default:
      throw("input error");
} 
```

首先要做的是识别共同的部分（在现实世界中，这可能会*更*重要）

```
makeitso([some string]);
globalLog += [some string]; 
```

并把它变成一个函数

```
function transformInput(somestring) {
     makeitso(somestring);
     globalLog += somestring;
} 
```

然后对于在每种情况下发生变化的部分，使用散列或数组；

```
var transformvalues = ["foo", "bar", "baz"]; 
```

从这里我们可以这样做：

```
var tvals = ["foo", "bar", "baz" ... ];
function transformInput(somestring) {
     makeitso(somestring);
     globalLog += somestring;
}
var tval = tvals[x];
if(tval!==undefined) {
     transformInput(tval);
} else {
    throw ("invalid input");
} 
```

并且将 tvals 排除在 switch 语句之外，甚至可以在外部提供它以扩展您可以处理的案例数量。或者您可以动态构建它。然而，在现实世界中，switch 语句通常会有特殊情况。我把它作为练习留给读者。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-01-04T11:51:02.173

三个建议（与已经给出的一些建议相呼应）：

1.  也许开关没有你想象的那么糟糕。如果案例块很大，它可能会很难看。通过将逻辑提取到方法中来缩短它们。

2.  正如许多人所指出的，在 OO 语言中，多态性可能是答案。

3.  在函数式语言（如 Javascript）中，编写一个函数，该函数返回您需要为任何输入运行的函数。这可能使用 switch 语句本身，或者它可能使用查找表。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-01-04T11:40:35.503

一般来说，我认为你应该只在需要时进行重构，例如当你想添加更多功能时，但当前的设计不能胜任这项任务。然后，您应该在不添加新功能的情况下进行重构，然后才添加新功能。

在其他情况下，不要费心重构。当你需要的时候去做，否则可能有更重要的事情要做。

如果你真的需要，那么[访问者设计模式](http://en.wikipedia.org/wiki/Visitor_pattern)是一种常见的 switch-case 替换，尽管你应该注意到它确实有缺点。（即，查看[www.objectmentor.com/resources/articles/acv.pdf](http://www.objectmentor.com/resources/articles/acv.pdf)）

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-01-04T06:10:30.100

在 switch 语句中包含 20 个 case 并没有错。您可以通过重构来整理代码，并且至少将案例处理移动到方法/函数中。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-01-04T06:15:18.513

根据 switch 语句正在评估的内容，您可能希望使用策略模式对其进行重构。查看[这篇文章](http://jeremyjarrell.com/archive/2007/10/28/64.aspx)，了解使用单独的类替换枚举值上的开关以处理每个函数的示例。

也可能是使用带有 20 个案例的开关实际上可能是它的最佳操作方案。只要它是可读的并且每个结果都清楚地传达了动作是什么，就不需要真正重构它。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2009-01-04T06:06:13.773

您总是可以使用[查找表](http://en.wikipedia.org/wiki/Lookup_table)。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-01-04T06:15:15.520

这取决于 switch 语句在做什么。

如果它匹配字符或字符串，比如在解析器中，并且您没有在代码中到处重复相同的模式集，那么 switch 语句可能没问题。

如果它匹配（例如）一个整数与允许值列表，您可以为每个值创建一个基类和一组派生类。然后，首先生成整数数据的任何东西都可以使用所有 switch 语句“答案”创建派生类的实例。

第三种选择是创建将模式映射到操作（即，具有虚拟方法的函数或对象）的数据结构。您可以在此数据结构中查找开关值，并执行相应的操作。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-01-04T07:58:40.583

如果它在没有重大错误的情况下工作（不是重大错误，我的意思是它们不会让你把头发拉出来）为什么还要重构它呢？不要重构一切。

如果您愿意，您可以将其更改为多态，但这将是一次霰弹枪手术，您可能需要重构的不仅仅是这个开关块。

* * *

## 回答 #11

> 赞同：-1
> 
> 时间：2017-03-11T11:47:35.933

访问[https://github.com/Pedram-Ahmadpour/Switch-Case](https://github.com/Pedram-Ahmadpour/Switch-Case)

## 客户端

创建**Condition的实例，然后通过***Switch()*函数将条件传递给**Condition**对象。

 *```
 int sense = 2;
    ConditionSense conditionSense = new ConditionSense();
    conditionSense.Switch(sense); 
```

## 服务器端

1.  创建*条件动作*。该接口定义了如何执行**Condition**。

    ```
    public interface IAction
    {
        void Do();
    } 
    ```

2.  创建您想要的案例列表。这些类必须实现*条件动作*和**ICase**；让它们保持轻盈。

    ```
     public class CaseCry : IAction, ICase<int?>
        {
            public int? Key { get { return 2; } }

            public void Do()
            {
                Sense.Cry cry = new Sense.Cry();
                cry.Act();
            }
        } 
    ```

    *   **ICase**只保存一个**Key**，*Switch()*函数使用它来导航案例。

        ```
        public interface ICase<TCase>
        {
            TCase Key { get; }
        } 
        ```

3.  创建一个继承**SwitchCase**通用抽象类的**Condition类。**

     ***   将您想要的所有案例添加到**案例**属性。
    *   定义一个*Switch()*函数并导航**Cases**属性以查找匹配案例，然后将它们作为*条件操作*执行。

        ```
        public class ConditionSense : SwitchCase<int?>
        {
            public ConditionSense()
            {
                Cases = new List<ICase<int?>>
                {
                    new CaseSmile(),
                    new CaseCry()
                };

                DefaultCases = new List<ICase<int?>> {
                    new CaseNoSense()
                };
            }

            public void Switch(int? key)
            {
                IEnumerable<IAction> matches = Cases.Where(p => p.Key.Equals(key))
                    .Select(p => p as IAction);
                if (matches.Count() > 0)
                    foreach (IAction match in matches)
                        match.Do();
                else
                    foreach (IAction defaultCase in DefaultCases)
                        defaultCase.Do();
            }
        } 
        ```** 

 ****微笑**、**哭泣**……可以很大，不用担心它们的大小；*条件动作*和**ICase**使它们保持延迟加载。

```
 public class Sense
        {
            public class Smile
            {
                public void Act()
                {
                    Console.WriteLine("I'm smiling :-)");
                }
            }

            public class Cry
            {
                public void Act()
                {
                    Console.WriteLine("I'm crying :-(");
                }
            }

            public class NoSense
            {
                public void Act()
                {
                    Console.WriteLine("I've no sense :-|");
                }
            }
        } 
```

# wiki - 用户提供内容的标准/通用标记语言？

> ID：410544
> 
> 赞同：0
> 
> 时间：2009-01-04T06:07:05.740
> 
> 标签：wiki, markup

我想这可能类似于[这个问题](https://stackoverflow.com/questions/342961/what-markup-language-for-richly-formated-content)，但我想知道是否有标准/流行的标记语言用于 wiki 和类似风格的用户提供的内容。随着不同标记语法的扩散，似乎一种可以实现。似乎至少有[一个团体](http://www.usemod.com/cgi-bin/mb.pl?WikiMarkupStandardWorkingGroup)想要创建一个标准（和一个 RFC），但他们似乎在 2005 年中期左右失败了。

那么有人知道标准/最受欢迎的是什么吗？如果没有，什么是对用户最简单但对高级用户具有良好灵活性的？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-04T06:21:38.953

[Markdown](http://daringfireball.net/projects/markdown/)在一些圈子里很流行。除了 Perl 中的原始版本之外，还有一个名为[Discount](http://www.pell.portland.or.us/~orc/Code/markdown/)的 C 版本和其他几个实现，包括[Lua](http://www.frykholm.se/files/markdown.lua)中的一个。

[这里](http://en.wikipedia.org/wiki/List_of_lightweight_markup_languages)有一个轻量级标记语言列表。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-04T06:22:36.910

没有我知道的标准。

我想说最近最受欢迎的（嗯，至少在我倾向于关注的项目中）似乎倾向于[Markdown](http://daringfireball.net/projects/markdown/)和[Textile](http://www.textism.com/tools/textile/)。

这通常是一个偏好问题。我更喜欢 Markdown，但如果有人更喜欢另一种标记，就没有那么多争论了。

# wcf - 带有 WCF 的结构映射？

> ID：410552
> 
> 赞同：3
> 
> 时间：2009-01-04T06:15:40.057
> 
> 标签：wcf, dependency-injection, structuremap

有人有幸将 StructureMap（DI 框架）与 WCF 集成在一起吗？

我可以像这样在我的 WCF 服务的构造函数中返回默认实例，但显然它并不理想。

```
public MemberService()
{
     this.memberRepository = StructureMap.ObjectFactory.GetInstance<IMemberRepository>();
} 
```

我看过这个（[http://www.lostechies.com/blogs/jimmy_bogard/archive/2008/07/29/integrating-structuremap-with-wcf.aspx](http://www.lostechies.com/blogs/jimmy_bogard/archive/2008/07/29/integrating-structuremap-with-wcf.aspx)）但没有运气设置它，因为我认为它与最新的 2.5+ 不兼容StructureMap 的发布。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-01-04T08:41:31.747

这已经在[这里](https://stackoverflow.com/questions/399072/wcf-service-instantiation-via-ioc-container)讨论过了。您在提供的示例中遇到了哪些问题？无需在服务的构造函数中编写代码，而是在[IInstanceProvider实现的](http://msdn.microsoft.com/en-us/library/system.servicemodel.dispatcher.iinstanceprovider.aspx)[GetInstance](http://msdn.microsoft.com/en-us/library/ms587089.aspx)方法中编写代码。

# exception - 为什么说异常对输入验证如此不利？

> ID：410558
> 
> 赞同：49
> 
> 时间：2009-01-04T06:25:32.753
> 
> 标签：exception, error-handling, validation

我知道“例外是针对例外情况”[a]，但除了一遍[又一](https://stackoverflow.com/questions/88541/business-objects-validation-and-exceptions#88917)遍地[重复](https://stackoverflow.com/questions/77127/when-to-throw-an-exception#77227)之外，我从来没有找到这个事实的真正原因。

由于它们会停止执行，因此您不希望它们用于简单的条件逻辑是有道理的，但为什么不输入验证呢？

假设您要遍历一组输入并捕获每个异常以将它们组合在一起以通知用户...我不断发现这在某种程度上是“错误的”，因为用户一直输入错误的输入，但这似乎是[基于关于语义](https://stackoverflow.com/questions/77127/when-to-throw-an-exception#77164)。

输入不是预期的，因此是例外的。抛出异常允许我准确定义错误，例如 StringValueTooLong 或 IntegerValueTooLow 或 InvalidDateValue 等。为什么这被认为是错误的？

抛出异常的替代方法是返回（并最终收集）错误代码或更糟的是错误字符串。然后我要么直接显示这些错误字符串，要么解析错误代码，然后向用户显示相应的错误消息。异常不会被视为可延展的错误代码吗？为什么要创建一个单独的错误代码和消息表，当这些可以通过我的语言中已经内置的异常功能进行概括时？

另外，我[发现 Martin Fowler](http://www.martinfowler.com/eaaDev/Notification.html)的这篇文章是关于如何处理这些事情的——通知模式。我不确定我如何将其视为不停止执行的异常以外的任何内容。

答：我在任何地方都阅读过有关异常的任何内容。

- - 编辑 - -

已经提出了许多重要的观点。我评论了大部分内容，并为其中的优点加了分，但我还没有完全相信。

我并不是要提倡将异常作为解决输入验证的正确方法，但我想找到很好的理由说明为什么这种做法被认为如此邪恶，因为大多数替代解决方案似乎只是变相的异常。

* * *

## 回答 #1

> 赞同：31
> 
> 时间：2009-01-04T13:12:21.513

阅读这些答案，我发现说“例外只应用于例外情况”是非常无益的。这就引出了什么是“异常情况”的整个问题。这是一个主观术语，其最佳定义是“您的正常逻辑流程无法处理的任何条件”。换句话说，异常条件是您使用异常处理的任何条件。

我对这个定义很好，我不知道我们会比这更接近。但是您应该知道这就是您使用的定义。

如果您要在特定情况下反对例外，您必须解释如何将条件范围划分为“例外”和“非例外”。

在某些方面，这类似于回答“程序之间的界限在哪里？”这个问题。答案是，“无论你把开始和结束放在哪里”，然后我们就可以讨论经验法则和确定将它们放在哪里的不同风格。没有硬性规定。

* * *

## 回答 #2

> 赞同：22
> 
> 时间：2009-01-04T06:27:54.993

用户输入“错误”输入也不例外：这是意料之中的。

异常不应用于正常的控制流。

过去，许多作者都说过异常本质上是昂贵的。Jon Skeet 的博客与此相反（并在 SO 的答案中提到了几次），说它们并不像报道的那样昂贵（尽管我不提倡在紧密循环中使用它们！）

使用它们的最大原因是“意向声明”，即如果您看到异常处理块，您会立即看到在正常流程之外处理的异常情况。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2009-01-04T07:08:50.967

除了已经提到的原因之外，还有一个*重要的原因：*

如果您**仅**在异常情况下使用异常，您可以在调试器中运行调试器设置“抛出异常时停止”。这非常方便，因为您可以在导致问题的确切行上放入调试器。*使用此功能每天*可为您节省大量时间。

在 C# 中这是可能的（我全心全意地推荐它），尤其是在他们将 TryParse 方法添加到所有数字类之后。一般来说，没有一个标准库需要或使用“坏”异常处理。当我处理一个没有按照这个标准编写的 C# 代码库时，我总是最终将它转换为无异常的常规情况，因为 stop-om-throw 非常有价值。

在 firebug javascript 调试器中，您也可以这样做，前提是您的库没有严重使用异常。

当我编写 Java 时，这实际上是不可能的，因为很多事情都在非异常情况下使用异常，包括许多标准 Java 库。所以这个省时的特性在java中并不能真正使用。我相信这是由于检查的异常，但我不会开始抱怨它们是多么邪恶。

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2014-07-10T13:14:44.000

## 错误和异常——什么、何时、何地？

异常旨在报告错误，从而使代码更加健壮。要了解何时使用异常，首先必须了解什么是错误，什么不是错误。

功能是一个工作单元，故障应该被视为错误或基于它们对功能的影响。在函数**f中，当且仅当它阻止****f**满足其被调用者的任何*先决条件*、实现**f**自己的任何*后置条件*或重新建立**f**共同负责维护的任何*不变量*时，失败才是错误。

 **错误分为三种：

*   阻止函数满足必须调用的另一个函数的前提条件（例如，参数限制）的条件；
*   阻止函数建立它自己的后置条件之一的条件（例如，产生一个有效的返回值是一个后置条件）；和
*   阻止函数重新建立它负责维护的不变量的条件。这是一种特殊的后置条件，特别适用于成员函数。每个非私有成员函数的一个基本后置条件是它必须重新建立其类的不变量。

**任何其他情况*都不*是错误，不应报告为错误。**

## 为什么说异常对输入验证如此不利？

我猜这是因为对“输入”的理解有些模棱两可，要么是*函数的输入*，要么是*字段*的值，后者不应该抛出异常，除非它是失败函数的一部分。

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2009-01-04T06:34:01.613

1.  **可维护性**- 异常会创建奇怪的代码路径，与 GOTO 不同。
2.  **易于使用**（对于其他类） - 其他类可以相信从您的用户输入类引发的异常是实际错误
3.  **性能**- 在大多数语言中，异常会导致性能和内存使用损失。
4.  **语义**- 单词的含义确实很重要。错误的输入不是“例外”。

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2009-01-04T10:14:46.377

我认为差异取决于特定班级的合同，即

对于旨在处理用户输入的代码，并为它进行防御性编程（即清理它），为无效输入抛出异常是错误的 - 这是预期的。

对于旨在处理可能源自用户的已清理和验证输入的代码，如果您发现某些本应被禁止的输入，则抛出异常将是有效的。在这种情况下，调用代码违反了合同，这表明清理和/或调用代码中存在错误。

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2009-01-04T08:52:50.583

使用异常时，**错误处理代码与导致错误的代码分开**。这是异常处理的意图——作为一种异常情况，错误不能在本地处理，所以异常被抛出到更高（和未知）的范围。如果未处理，应用程序将在完成任何更多操作之前退出。

如果您在执行简单的逻辑操作（例如验证用户输入）时曾经抛出异常，那么您正在做非常非常非常错误的事情。

> 输入不是预期的，因此是例外的。

这种说法根本不适合我。UI 限制用户输入（例如，使用限制最小值/最大值的滑块），您现在可以断言某些条件 - 不需要错误处理。或者，用户可以输入垃圾，而您希望这会发生并且必须处理它。一个或另一个 - 这里没有任何例外。

> 抛出异常允许我准确定义错误，例如 StringValueTooLong 或 IntegerValueTooLow 或 InvalidDateValue 等。为什么这被认为是错误的？

我认为这超越了——更接近于邪恶。您可以定义一个抽象的 ErrorProvider 接口，或者返回一个表示错误的复杂对象而不是简单的代码。关于如何检索错误报告有很多很多选项。使用异常是因为*方便***，所以是错误**的。光写这一段就觉得脏。

将抛出异常视为希望。最后一次机会。一个祈祷者。验证用户输入不应导致任何这些情况。

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2009-01-04T11:05:07.447

一些分歧是否可能是由于对“用户输入”的含义缺乏共识？事实上，你在哪一层编码。

如果您正在编写 GUI 用户界面或 Web 表单处理程序，您可能会期待无效输入，因为它直接来自人类的打字手指。

如果您正在编写 MVC 应用程序的模型部分，您可能已经设计了一些东西，以便控制器为您清理输入。就模型而言，无效输入确实是一个例外，并且可以这样对待。

如果您在协议级别编写服务器，您可能有理由期望客户端检查用户输入。同样，这里的无效输入确实是一个例外。这与 100% 信任客户端完全不同（这确实很愚蠢）——但与直接用户输入不同，您预测大多数时间输入都可以。这里的线条有些模糊。事情发生的可能性越大，您就越不想使用异常来处理它。

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2010-12-31T16:18:26.910

*这是关于此事的语言观点。*

# 为什么说异常对输入验证如此不利？

## 结论 ：

*   异常定义不够清楚，所以有不同的意见。
*   错误的输入被视为正常的事情，而不是例外。

## 想法？

这可能归结为人们对所创建代码的期望。

*   客户不能被信任
    *   验证*必须*在服务器端进行。 **更强：** *每次*验证都发生在服务器端。
    *   因为验证发生在服务器端，所以*预计*会在那里完成，并且预期不是例外，因为它是预期的。

然而，

*   客户的**输入**不能被信任
*   客户的**输入验证** *是*可信 的
    *   如果验证是可信的，则可以*预期*它会产生有效的输入
    *   现在每个输入都应该是有效的
    *   无效输入现在是意外的，一个例外

.

异常可能是退出代码的好方法。

提到要考虑的一件事是您的代码是否处于适当的状态。我不知道什么会使我的代码处于不正确的状态。连接自动关闭，剩余变量被垃圾收集，有什么问题？

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2009-01-04T09:11:00.983

另一票反对对非异常进行异常处理！

1.  在 .NET 中，即使未引发异常，JIT 编译器在某些情况下也不会执行优化。以下文章很好地解释了它。 [http://msmvps.com/blogs/peterritchie/archive/2007/06/22/performance-implications-of-try-catch-finally.aspx](http://msmvps.com/blogs/peterritchie/archive/2007/06/22/performance-implications-of-try-catch-finally.aspx) [http://msmvps.com/blogs/peterritchie/archive/2007/07 /12/performance-impplications-of-try-catch-finally-part-two.aspx](http://msmvps.com/blogs/peterritchie/archive/2007/07/12/performance-implications-of-try-catch-finally-part-two.aspx)

2.  当抛出异常时，它会为堆栈跟踪生成一大堆信息，如果您实际上“预期”异常，则可能不需要这些信息，就像将字符串转换为 int 等时经常发生的情况一样......

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2009-01-04T06:40:24.050

一般来说，库会抛出异常，客户端会捕获它们并用它们做一些智能的事情。对于用户输入，我只编写验证函数而不是抛出异常。对于这样的事情，例外似乎过分了。

异常存在性能问题，但在 GUI 代码中您通常不必担心它们。那么如果验证需要额外的 100 毫秒来运行呢？用户不会注意到这一点。

在某些方面，这是一个艰难的决定 - 一方面，您可能不希望整个应用程序崩溃，因为用户在邮政编码文本框中输入了一个额外的数字并且您忘记了处理异常。另一方面，“尽早失败，坚决失败”的方法可确保快速发现和修复错误，并保持您宝贵的数据库健全。一般来说，我认为大多数框架建议您不要对 UI 错误检查使用异常处理，而某些框架（如 .NET Windows 窗体）提供了很好的方法来执行此操作（ErrorProviders 和 Validation 事件）而不会出现异常。

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2009-01-04T13:45:35.890

异常不应该用于输入验证，因为异常不仅应该在异常情况下使用（正如已经指出的那样，不正确的用户输入不是），而且它们会创建异常代码（不是在出色的意义上）。

大多数语言中异常的问题是它们改变了程序流的规则，这在真正特殊的情况下是可以的，在这种情况下，我们不一定能确定有效的流应该是什么，因此只需抛出一个异常并退出，但是在哪里您知道流程应该是什么，您应该创建该流程（在列出的情况下，它将向用户发出一条消息，告诉他们他们需要重新输入一些信息）。

在我每天工作的应用程序中，异常确实被过度使用，甚至在用户登录时输入错误密码的情况下，根据您的逻辑，这将是异常结果，因为它不是应用程序想要的。但是，当一个过程具有正确或不正确的两种结果之一时，我认为我们不能说不正确，无论多么错误，都是例外的。

我在使用此代码时发现的主要问题之一是试图遵循代码的逻辑而不深入参与调试器。尽管调试器很棒，但应该可以为用户输入错误密码时发生的情况添加逻辑，而无需启动它。

为真正的异常执行保留异常，而不仅仅是错误。在我强调密码错误的情况下并不例外，但可能无法联系到域服务器！

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2009-01-27T17:49:31.473

当我看到因验证错误而引发异常时，我经常看到引发异常的方法同时执行大量验证。例如

```
public bool isValidDate(string date)
{
    bool retVal = true;
    //check for 4 digit year
    throw new FourDigitYearRequiredException();
    retVal = false;

    //check for leap years
    throw new NoFeb29InANonLeapYearException();
    retVal = false;
    return retVal;
} 
```

随着规则在数月和数年内堆积起来，此代码往往非常脆弱且难以维护。我通常更喜欢将我的验证分解为返回布尔值的较小方法。它使调整规则变得更容易。

```
public bool isValidDate(string date)
{
    bool retVal = false;
    retVal = doesDateContainAFourDigitYear(date);
    retVal = isDateInALeapYear(date);
    return retVal;
}

public bool isDateInALeapYear(string date){}

public bool doesDateContainAFourDigitYear(string date){} 
```

正如已经提到的，返回一个包含错误信息的错误结构/对象是一个好主意。最明显的优势是您可以收集它们并立即向用户显示所有错误消息，而不是让他们通过验证玩 Whack-A-Mole。

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2013-05-15T10:40:26.790

我使用了两种解决方案的组合：对于每个验证功能，我传递了一条记录，我用验证状态（错误代码）填充。在函数结束时，如果存在验证错误，我会抛出异常，这样我不会为每个字段抛出异常，而只会抛出一次。我还利用抛出异常将停止执行，因为我不希望在数据无效时继续执行。

例如

```
procedure Validate(var R:TValidationRecord);
begin
  if Field1 is not valid then
  begin
    R.Field1ErrorCode=SomeErrorCode;
    ErrorFlag := True; 
  end; 
  if Field2 is not valid then
  begin
    R.Field2ErrorCode=SomeErrorCode;
    ErrorFlag := True; 
  end;
  if Field3 is not valid then
  begin
    R.Field3ErrorCode=SomeErrorCode;
    ErrorFlag := True; 
  end;

  if ErrorFlag then
    ThrowException
end; 
```

如果只依赖布尔值，使用我的函数的开发人员应该考虑到这一点：

```
if not Validate() then
  DoNotContinue(); 
```

但他可能会忘记并且只调用 Validate() （我知道他不应该，但也许他可能会）。

因此，在上面的代码中，我获得了两个优点： 1-验证函数中只有一个异常。2-异常，即使未被捕获，也会停止执行，并在测试时出现。

* * *

## 回答 #15

> 赞同：1
> 
> 时间：2017-09-19T17:42:26.737

8 年后，我在尝试应用 CQS 模式时遇到了同样的困境。我站在输入验证可以抛出异常的一边，但有一个额外的约束。如果任何输入失败，您需要抛出一种类型的异常：ValidationException、BrokenRuleException 等。不要抛出一堆不同的类型，因为不可能全部处理。这样，您可以在一个地方获得所有违反规则的列表。您创建一个负责执行验证 (SRP) 的类，如果至少有 1 条规则被破坏，则抛出异常。这样一来，您就可以一次处理一种情况，并且您知道自己很好。无论调用什么代码，您都可以处理这种情况。这使下游的所有代码更加清晰，因为您知道它处于有效状态，否则它不会到达那里。

对我来说，从用户那里获取无效数据并不是您通常所期望的。（如果每个用户第一次向您发送无效数据，我会再次查看您的 UI。）任何阻止您处理真实意图的数据，无论是用户还是来自其他地方的数据都需要中止处理。如果它是用户输入而不是类上的一个字段，那么它与从单个数据中抛出 ArgumentNullException 有什么不同，说这是必需的。

当然，您可以先进行验证，然后在每个“命令”上编写相同的样板代码，但我认为这是一场维护噩梦，而不是在顶部的一个地方捕获无效的用户输入，无论如何都会以相同的方式处理。（更少的代码！）只有当用户提供无效数据时，性能才会受到影响，这种情况不应该经常发生（或者你的 UI 很糟糕）。无论如何，客户端的所有规则都必须在服务器上重新编写，因此您只需编写一次，进行 AJAX 调用，< 500 毫秒的延迟将为您节省大量的编码时间（仅 1放置所有验证逻辑的地方）。

此外，虽然您可以使用开箱即用的 ASP.NET 进行一些简洁的验证，但如果您想在其他 UI 中重用您的验证逻辑，则不能，因为它已融入 ASP.NET。无论使用什么 UI，你最好在下面创建一些东西并在上面处理它。（至少我的 2 美分。）

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2009-01-04T06:32:51.663

我同意 Mitch 的观点，即“异常不应用于正常的控制流”。我只想从我的计算机科学课上的记忆中补充一点，捕获异常是昂贵的。我从来没有真正尝试过进行基准测试，但是比较 if/else 与 try/catch 之间的性能会很有趣。

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2009-01-04T11:47:07.363

使用异常的一个问题是倾向于一次只检测一个问题。用户修复并重新提交，却发现另一个问题！返回需要解决的问题列表的接口更加友好（尽管它可以包含在异常中）。

# ruby-on-rails - 我可以在我的 rails 应用程序中读取但不能设置 cookie

> ID：410576
> 
> 赞同：2
> 
> 时间：2009-01-04T06:42:34.217
> 
> 标签：ruby-on-rails, cookies, variable-assignment

这是最奇怪的事情。当我昨天运行 Rails WEBrick 调试器时，我可以做类似的事情

```
cookies[uid] = s.session_id 
```

其中 'uid' 是一个传递的参数，其中包含一个用户 ID，然后期望

```
cookies[uid] 
```

把我还给我，说：

```
29b93443d9ec18168a26e1ab12957b0dd0b799ff 
```

今天，我总是返回“零”。我可以很好地读取现有值。中列出的任何键

```
cookies.keys 
```

工作得很好。

有没有人对此行为有可能的解释。这非常令人抓狂，谷歌搜索还没有得到答案。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-04T09:26:37.020

原始提问者，在这里。事实证明，我可以设置那些 cookie。问题是当你输入

```
cookies[:key] 
```

在调试器中，它似乎总是为您提供从浏览器读取的 cookie 的值。我不知道同时该值存储在哪里，但检查浏览器中的 cookie 可以确认我的更改确实存在。有用的是，cookies[:key] 返回赋值的值，所以你可以做类似的事情

```
@future_value = cookies[:key] = {
                                 :value => 'new value',
                                 :expires => @really_soon
                                } 
```

我不知道是什么让我觉得我以前可以看到它们！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-23T22:52:44.387

此外，您需要使用字符串而不是符号来读取 cookie，因为 Rails 在设置键时会将它们转换为字符串。

```
cookies[:key] = "value"
cookies[:key]  # => nil
cookies['key'] # => "value" 
```

# wpf - WPF 样式的绑定

> ID：410579
> 
> 赞同：36
> 
> 时间：2009-01-04T06:47:53.863
> 
> 标签：wpf, data-binding, styles

我正在尝试创建一个自定义控件 - 一个按钮 - 根据数据上下文中属性的值，它将应用多种样式。

我在想的是使用类似的东西：

```
<Button Style="{Binding Path=ButtonStyleProperty, Converter={StaticResource styleConverter}}" Text="{Binding Path=TextProp}" /> 
```

在代码中......实现一个 IValueConverter，它在方法中执行类似于以下代码的操作`ConvertTo`：

```
switch(value as ValueEnums)
{
    case ValueEnums.Enum1:
        FindResource("Enum1ButtonStyle") as Style;
    break;

    ... and so on.
} 
```

但是，我不完全确定如何拉出样式对象，即使这是可能的......

同时我正在做的是处理`DataContextChanged`事件，然后将处理程序附加到`PropertyChanged`绑定到按钮的对象的事件 - 然后在那里运行 switch 语句。

它不是很完美，但在我找到更好的解决方案之前，这似乎是我必须使用的。

* * *

## 回答 #1

> 赞同：40
> 
> 时间：2009-01-04T08:45:18.570

如果您想替换整个样式（而不仅仅是其中的元素），那么您可能会将这些样式存储在资源中。您应该能够按照以下方式做一些事情：

```
<Button>
    <Button.Style>
        <MultiBinding Converter="{StaticResource StyleConverter}">
            <MultiBinding.Bindings>
                <Binding RelativeSource="{RelativeSource Self}"/>
                <Binding Path="MyStyleString"/>
            </MultiBinding.Bindings>
        </MultiBinding>
    </Button.Style>
</Button> 
```

通过使用 MultiBinding 并使用 Self 作为第一个绑定，我们可以在转换器中查找资源。转换器需要实现 IMultiValueConverter（而不是 IValueConverter）并且看起来像这样：

```
class StyleConverter : IMultiValueConverter 
{
    public object Convert(object[] values, Type targetType, object parameter, System.Globalization.CultureInfo culture)
    {
        FrameworkElement targetElement = values[0] as FrameworkElement; 
        string styleName = values[1] as string;

        if (styleName == null)
            return null;

        Style newStyle = (Style)targetElement.TryFindResource(styleName);

        if (newStyle == null)
            newStyle = (Style)targetElement.TryFindResource("MyDefaultStyleName");

        return newStyle;
    }

    public object[] ConvertBack(object value, Type[] targetTypes, object parameter, System.Globalization.CultureInfo culture)
    {
        throw new NotImplementedException();
    }
} 
```

这不是我经常做的事情，但这应该从记忆中起作用:)

* * *

## 回答 #2

> 赞同：18
> 
> 时间：2009-01-04T07:16:50.293

看来您需要使用[DataTrigger](http://msdn.microsoft.com/en-us/library/system.windows.datatrigger.aspx)类。它允许您根据按钮的内容将不同的样式应用于按钮。

例如以下样式将根据数据上下文对象的属性值将按钮的背景属性更改为红色

```
<Style x:Key="ButtonStyle" TargetType="{x:Type Button}">
    <Style.Triggers>
        <DataTrigger Binding="{Binding Path="Some property"}" 
                     Value="some property value">
            <Setter Property="Background" Value="Red"/>
        </DataTrigger>
    </Style.Triggers>
</Style> 
```

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2011-05-27T08:04:03.090

对于我们这些不能使用多值转换器的人（我在看你 SL4 和 WP7 :)，感谢 Steven 的回答，我找到了一种使用普通值转换器的方法。

唯一的假设是样式值包含在所设置样式的属性中。

因此，如果您使用 MVVM 模式，那么样式值（例如 TextSmall、TextMedium、TextLarge）被假定为视图模型的一部分，您所要做的就是传递定义样式名称的转换器参数。

例如，假设您的视图模型具有属性：

```
public string ProjectNameStyle
{
    get { return string.Format("ProjectNameStyle{0}", _displaySize.ToString()); }
} 
```

申请风格：

```
<Application.Resources>
    <Style x:Key="ProjectNameStyleSmall" TargetType="TextBlock">
        <Setter Property="FontSize" Value="40" />
    </Style>
    <Style x:Key="ProjectNameStyleMedium" TargetType="TextBlock">
        <Setter Property="FontSize" Value="64" />
    </Style>
    <Style x:Key="ProjectNameStyleLarge" TargetType="TextBlock">
        <Setter Property="FontSize" Value="90" />
    </Style> 
```

XAML 视图：

```
 <TextBlock 
        Text="{Binding Name}"
        Style="{Binding ., Mode=OneWay, Converter={cv:StyleConverter}, ConverterParameter=ProjectNameStyle}"> 
```

使用实现 IValueConverter 的 StyleConverter 类：

```
public object Convert(object value, Type targetType, object parameter, CultureInfo culture)
{
    if (targetType != typeof(Style))
    {
        throw new InvalidOperationException("The target must be a Style");
    }

    var styleProperty = parameter as string;
    if (value == null || styleProperty == null)
    {
        return null;
    }

    string styleValue = value.GetType()
        .GetProperty(styleProperty)
        .GetValue(value, null)
        .ToString();
    if (styleValue == null)
    {
        return null;
    }

    Style newStyle = (Style)Application.Current.TryFindResource(styleValue);
    return newStyle;
} 
```

请注意，这是 WPF 代码，因为转换器是从 MarkupExtension 和 IValueConverter 派生的，但如果您使用静态资源并添加更多的腿部工作，因为 TryFindResource 方法不存在，它将在 SL4 和 WP7 中工作。

希望对某人有所帮助，再次感谢史蒂文！

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2013-06-13T13:24:34.733

**视图模型**

```
private Style _dynamicStyle = (Style)Application.Current.FindResource("Style1");
        public Style DynamicStyle
        {
            get { return _dynamicStyle; }
            set
            {
                _dynamicStyle = value;
                OnPropertyChanged("DynamicStyle");
            }

        }

public event PropertyChangedEventHandler PropertyChanged;

    private void OnPropertyChanged(string propertyName)
    {
        if (PropertyChanged != null)
        {
            PropertyChanged(this, new PropertyChangedEventArgs(propertyName));
        }
    } 
```

在您的 ViewModel 中实现一个属性，然后在您想要的任何位置动态更改样式，如下所示。

```
DynamicStyle=(Style)Application.Current.FindResource("Style2");// you can place this code where the action get fired 
```

**看法**

然后设置**DataContext**值，然后在您的视图中实现以下代码

```
 <Button Style="{Binding DynamicStyle,Mode=TwoWay}"/> 
```

# macos - 如何在 Mac OS X 上自动运行 USB 连接或 CD 插入上的应用程序？

> ID：410583
> 
> 赞同：24
> 
> 时间：2009-01-04T06:49:34.967
> 
> 标签：macos, usb, autorun

有什么方法可以在 Mac OS X 上自动启动 USB 连接或 CD 插入上的应用程序？在 Windows 上很容易，但我发现这`AutoRun.Inf`在 Mac 上根本不起作用。

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2009-01-04T07:02:04.007

你不能。在 Mac OS X 下自动启动应用程序是不可能的。

下一个最好的方法是打开 CD 文件夹并显示安装程序图标，可以通过使用（[AutoOpen 1.0 版](http://autoopen.nibfile.com/)）制作一个`.dmg`然后可以将其刻录到 CD 来完成。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2009-01-05T19:42:19.617

基本上，自动运行被认为是一个安全问题，因此在 OSX 中不受支持。Sophie Alpert 的回答也有点矫枉过正。大多数 OSX 安装程序只是打开一个文件夹来显示应用程序，可能还有自述文件。通过将应用程序拖到您的应用程序文件夹来完成安装。

对于 CD 上的其他类型的应用程序（例如幻灯片放映或类似的东西），开发人员通常使用隐藏文件夹来隐藏支持数据，以确保用户在打开 CD 时看到的唯一内容是他们的单个图标重新应该双击启动应用程序。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2014-07-16T09:44:01.913

可以安装一个后台服务，在插入 USB 设备时进行监控，然后启动应用程序。Google 的“Android 文件传输代理”就是这样一种服务，它在后台运行，并在您插入 Android 设备时启动“Android 文件传输”。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2011-03-27T14:02:16.787

如果您正在为自己寻找东西，您可以编写一个在后台运行的小型 Mac 应用程序，并监视要连接的特定 USB 设备（通过 id），然后运行该程序。理想情况下，可以使用一个小的 XML plist 将设备 ID 映射到要运行的正确程序。XCode SDK 具有示例代码，用于监控设备的添加和移除，以帮助您入门。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2018-09-06T14:47:22.037

我同意 JavaCoderEx。我会 crontab 一个查找 /Volumes/*/autorun.sh 的任务，然后运行一次。也许触摸 /tmp/ 中的文件，以便您知道它已经运行，然后在卷消失时将其删除。

# optimization - postgres中的Seq Scan和Bitmap堆扫描有什么区别？

> ID：410586
> 
> 赞同：61
> 
> 时间：2009-01-04T06:52:44.523
> 
> 标签：optimization, postgresql, query-optimization, sql-execution-plan

在解释命令的输出中，我发现了两个术语“序列扫描”和“位图堆扫描”。有人能告诉我这两种扫描有什么区别吗？（我正在使用 PostgreSql）

* * *

## 回答 #1

> 赞同：86
> 
> 时间：2009-01-04T08:23:54.073

[http://www.postgresql.org/docs/8.2/static/using-explain.html](http://www.postgresql.org/docs/8.2/static/using-explain.html)

基本上，顺序扫描将转到实际行，并从第 1 行开始读取，并继续直到满足查询（这可能不是整个表，例如，在限制的情况下）

位图堆扫描意味着 PostgreSQL 找到了一小部分要获取的行（例如，从索引中），并且将只获取那些行。这当然会有更多的搜索，所以只有当它需要一小部分行时才会更快。

举个例子：

```
create table test (a int primary key, b int unique, c int);
insert into test values (1,1,1), (2,2,2), (3,3,3), (4,4,4), (5,5,5); 
```

现在，我们可以轻松获得 seq 扫描：

```
explain select * from test where a != 4

                       QUERY PLAN                        
---------------------------------------------------------
 Seq Scan on test  (cost=0.00..34.25 rows=1930 width=12)
   Filter: (a <> 4) 
```

它进行了顺序扫描，因为它估计它将抢占表的绝大多数；试图做到这一点（而不是大量的、无意义的阅读）将是愚蠢的。

现在，我们可以使用索引：

```
explain select * from test where a = 4 ;
                              QUERY PLAN                              
----------------------------------------------------------------------
 Index Scan using test_pkey on test  (cost=0.00..8.27 rows=1 width=4)
   Index Cond: (a = 4) 
```

最后，我们可以得到一些位图操作：

```
explain select * from test where a = 4 or a = 3;
                                  QUERY PLAN                                  
------------------------------------------------------------------------------
 Bitmap Heap Scan on test  (cost=8.52..13.86 rows=2 width=12)
   Recheck Cond: ((a = 4) OR (a = 3))
   ->  BitmapOr  (cost=8.52..8.52 rows=2 width=0)
         ->  Bitmap Index Scan on test_pkey  (cost=0.00..4.26 rows=1 width=0)
               Index Cond: (a = 4)
         ->  Bitmap Index Scan on test_pkey  (cost=0.00..4.26 rows=1 width=0)
               Index Cond: (a = 3) 
```

我们可以这样理解：

1.  为 a=4 构建我们想要的行的位图。（位图索引扫描）
2.  为 a=3 构建我们想要的行的位图。（位图索引扫描）
3.  或将两个位图放在一起 (BitmapOr)
4.  在表中查找这些行（位图堆扫描）并检查以确保 a=4 或 a=3（重新检查 cond）

[是的，这些查询计划很愚蠢，但那是因为我们没有分析`test`如果我们分析了它，它们都是顺序扫描，因为有 5 个小行]

# c++ - 在 C++ 中通过引用/值传递

> ID：410593
> 
> 赞同：40
> 
> 时间：2009-01-04T07:08:36.037
> 
> 标签：c++, pass-by-reference, pass-by-value

我想澄清按值和按引用之间的区别。

我画了一幅画

![在此处输入图像描述](https://i.stack.imgur.com/fNEsL.jpg)

因此，对于按值传递，

使用不同的引用创建相同对象的副本，并为局部变量分配新引用，因此指向新副本

如何理解这句话：“如果函数修改了该值，则修改也出现在调用函数的范围内，无论是通过值传递还是通过引用传递”

谢谢！

* * *

## 回答 #1

> 赞同：66
> 
> 时间：2009-01-04T11:36:01.987

*我认为不传达引用传递的*含义会产生很多混乱。当有些人说*通过引用传递*时，他们通常不是指参数本身，而是*被引用的对象*。其他人说通过引用传递意味着对象不能在被调用者中更改。例子：

```
struct Object {
    int i;
};

void sample(Object* o) { // 1
    o->i++;
}

void sample(Object const& o) { // 2
    // nothing useful here :)
}

void sample(Object & o) { // 3
    o.i++;
}

void sample1(Object o) { // 4
    o.i++;
}

int main() {
    Object obj = { 10 };
    Object const obj_c = { 10 };

    sample(&obj); // calls 1
    sample(obj) // calls 3
    sample(obj_c); // calls 2
    sample1(obj); // calls 4
} 
```

有些人会声称 1 和 3 是通过引用传递，而 2 是通过值传递。另一组人说除了最后一个之外都是按引用传递，因为对象本身没有被复制。

我想在这里定义我声称*通过引用传递的*内容。可以在此处找到对其的一般概述：[按引用传递和按值传递之间的区别](https://stackoverflow.com/questions/373419/whats-the-difference-between-a-parameter-passed-by-reference-vs-passed-by-value#373429)。第一个和最后一个是值传递，中间两个是引用传递：

```
 sample(&obj);
       // yields a `Object*`. Passes a *pointer* to the object by value. 
       // The caller can change the pointer (the parameter), but that 
       // won't change the temporary pointer created on the call side (the argument). 

    sample(obj)
       // passes the object by *reference*. It denotes the object itself. The callee
       // has got a reference parameter.

    sample(obj_c);
       // also passes *by reference*. the reference parameter references the
       // same object like the argument expression. 

    sample1(obj);
       // pass by value. The parameter object denotes a different object than the 
       // one passed in. 
```

我投票支持以下定义：

> *当且仅当被调用函数的相应参数具有引用类型并且*引用参数直接绑定到参数表达式 (8.5.3/4)时，参数 (1.3.1) 才通过引用传递。在所有其他情况下，我们都必须通过值传递。

这意味着以下内容是按值传递的：

```
void f1(Object const& o);
f1(Object()); // 1

void f2(int const& i);
f2(42); // 2

void f3(Object o);
f3(Object());     // 3
Object o1; f3(o1); // 4

void f4(Object *o);
Object o1; f4(&o1); // 5 
```

`1`是按值传递，因为它没有直接绑定。实现可以复制临时文件，然后将该临时文件绑定到引用。`2`是按值传递，因为实现会初始化文字的临时值，然后绑定到引用。`3`是传值，因为参数没有引用类型。`4`出于同样的原因，是按值传递。`5`是按值传递，因为参数没有引用类型。以下情况通过引用传递（根据 8.5.3/4 和其他规则）：

```
void f1(Object *& op);
Object a; Object *op1 = &a; f1(op1); // 1

void f2(Object const& op);
Object b; f2(b); // 2

struct A { };
struct B { operator A&() { static A a; return a; } };
void f3(A &);
B b; f3(b); // passes the static a by reference 
```

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-01-04T07:21:43.670

按值传递时：

```
void func(Object o); 
```

然后打电话

```
func(a); 
```

您将`Object`在堆栈上构造一个，并在其实现中`func`被`o`. 这可能仍然是一个浅拷贝（内部`a`和`o`可能指向相同的数据），因此`a`可能会被更改。但是，如果`o`是深拷贝`a`，则`a`不会改变。

通过引用传递时：

```
void func2(Object& o); 
```

然后打电话

```
func2(a); 
```

您只会提供一种新的参考方式`a`。" `a`" 和 " `o`" 是同一个对象的两个名称。更改`o`内部`func2`将使这些更改对调用者可见，调用者通过名称“ `a`”知道对象。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-01-04T19:59:15.700

非常感谢大家的所有这些投入！

我从网上的讲义中引用了这句话： [http ://www.cs.cornell.edu/courses/cs213/2002fa/lectures/Lecture02/Lecture02.pdf](http://www.cs.cornell.edu/courses/cs213/2002fa/lectures/Lecture02/Lecture02.pdf)

第一页第六张幻灯片

" 通过 VALUE 传递变量的值将传递给函数如果函数修改了该值，则修改将保留在该函数的范围内。

通过 REFERENCE 传递 对变量的引用传递给函数 如果函数修改了该值，则修改也会出现在调用函数的范围内。

"

再次非常感谢！

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2009-01-04T07:43:30.817

我不确定我是否正确理解了您的问题。这有点不清楚。但是，可能会让您感到困惑的是以下内容：

1.  通过引用传递时，对同一对象的引用将传递给被调用的函数。对对象的任何更改都将反映在原始对象中，因此调用者将看到它。

2.  按值传递时，将调用复制构造函数。默认的复制构造函数只会做浅拷贝，因此，如果被调用函数修改了对象中的整数，调用函数将不会看到，但如果函数更改了对象内指针指向的数据结构, 那么这将被调用者看到由于浅拷贝。

我可能误解了你的问题，但我想无论如何我都会给它一个刺。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-01-04T07:21:13.407

当我解析它时，这些话是错误的。它应为“如果函数修改了该值，则在通过引用传递时，修改也会出现在调用函数的范围内，但在通过值传递时不会出现。”

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-01-04T09:15:20.163

我对“如果函数修改了该值，修改也出现在调用函数的范围内，通过值传递和引用传递”这句话的理解是它们是**错误的**。

通过值传递时，在被调用函数中所做的修改**不在调用函数的范围内。**

要么你打错了引用的词，要么它们是从任何上下文中提取出来的，这似乎是错误的，对。

您能否确保您正确引用了您的来源，如果没有错误，请在源材料中提供更多围绕该声明的文本。

# fonts - 便携式网络字体技术

> ID：410608
> 
> 赞同：2
> 
> 时间：2009-01-04T07:28:11.160
> 
> 标签：fonts, typography

在阅读了关于[网络字体字体选择](https://stackoverflow.com/questions/410461/font-typeface-selection-for-the-web)的问题后，我想到便携式网络字体就是答案。我们曾经使用 Bitstream 的包来生成嵌入网页所需的字体子集，以便在每个平台上的每个浏览器中看起来都一样。当我在谷歌上搜索这个时，我发现了一个 RFC，看起来它是由 Bitstream 拥有的，而不是其他的。

这项技术怎么了？我只是没看到吗？还是因为它是专有的而消失了？如果是这样，这项技术的前景如何？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-04T07:42:51.443

大多数基于 Web 的字体嵌入技术都在痛苦中死去。例如，微软对它的看法是，你猜怎么着，只支持 IE，所以其他浏览器无法呈现它。自然，网页设计师不想走这条路。

新的 CSS 标准支持字体嵌入 IIRC。到目前为止，没有浏览器支持它。

如果您只想使用特定字体完成*标题*，我建议使用 sIFR 或 SVG 预渲染它们（我使用动态渲染的 SVG，但我的标题通常大小为 2Mb）。

如果你想用你的字体完成整个文本，那么，运气不好 - 目前没有简单的方法可以做到这一点。不过，如果您考虑到大多数用户仍然使用 IE =sigh=，那么您可以尝试使用 Microsoft 的 WEFT，看看它是否适合您。但是请记住，许多用于打印的字体没有像 Georgia 这样的字体那样具有相同的暗示质量。

祝你好运！

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-04T11:58:19.117

您可能会对此链接感兴趣： http: [//typeface.neocracy.org/](http://typeface.neocracy.org/)

它使用的是 javascript，所以它只能在支持和启用 javascript 的情况下工作。但在大多数情况下，这是一个很高的百分比。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-04T16:23:54.340

Bitstream PFR 技术仅在 Netscape 4 中得到支持，幸好很久以前就死了。

微软对网络字体的尝试从未得到广泛接受，原因是：

*   仅限 IE；
*   转换为 EOT 的不便；
*   尤其是 WEFT 工具的糟糕之处；
*   在屏幕上呈现良好的字体很少，尤其是当 ClearType 可能不可用/禁用时；
*   许可证允许您将它们嵌入网络的字体很少。

正在推动制作 TrueType/OpenType 字体文件 Just Work on web，这可能会出现在 Firefox 3.1、Opera 10 和 Safari 中。不过，这方面存在一些政治辩论，主要是出于版权原因。就我个人而言，我认为在这一点上，可能需要一点点猖獗的盗版才能将字体许可从其当前可悲的默认位置“你不能将我们的字体用于任何事情”中唤醒。

因此，与此同时，如果您真的很介意的话，您可以在 IE 上使用 EOT/WEFT，但情况可能很快就会改变。

# c# - 超过 16 字节的结构的最佳解决方案

> ID：410611
> 
> 赞同：3
> 
> 时间：2009-01-04T07:32:04.053
> 
> 标签：c#, optimization, class, struct

我有一种我认为将其用作结构的类型。

*   它代表单个值
*   它是不可变的

但问题是，它有 6 个 int 字段。

那么我应该为这种类型使用哪种解决方案？

1.  继续使用结构？
2.  换班？
3.  或者将 6 个整数打包成一个 int 数组，所以它只有一个字段

**编辑**

具有 6 个整数字段的结构的大小为 24 字节，这对于传递来说是巨大的。struct 的推荐大小不超过 16 字节

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-01-04T07:51:00.147

这取决于您将如何使用它？

1.  你会分配很多还是传递很多？
2.  它会被第 3 方代码消耗吗？在这种情况下，类通常会给您更大的灵活性。
3.  你想要结构与类语义吗？例如，不可为空？
4.  您是否会从该类的几个预先创建的实例中受益，这些实例可以重用于表示特殊情况？类似于 String.Empty。在这种情况下，您将从课程中受益。

仅从您在问题中提供的信息很难回答。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-04T08:13:38.353

小心拳击。如果您的结构将被需要一个对象的方法所使用，它将被强制转换为一个对象，并且您将受到潜在的性能影响。

这是一个更详细地解释它的[参考。](http://www.c-sharpcorner.com/UploadFile/stuart_fujitani/BoxNUnbox11192005055746AM/BoxNUnbox.aspx)

我会把它变成一门课（#2），然后你就不用担心了。

使用六个整数的数组（#3）可能会使您的代码更难阅读。每个 int 都有描述性标识符的类会好得多。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-04T07:40:13.007

没有看到你的结构，很难明确地说出任何东西。但我怀疑你应该把它作为一个结构。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-04T07:44:35.200

怎么样`WriteOnce<int[]>`？

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2010-06-30T19:36:03.163

我建议编写一个小基准来衡量不同选项的性能，这是确定的唯一方法。你可能会对结果感到惊讶（我经常这样）。

（我假设您在这里关心的是性能。）

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2011-10-06T16:38:50.877

如果数据持有者将是不可变的，那么结构与类的问题很可能取决于每个实例存在的平均引用数。如果有一个 TwentyFourByteStruct[1000] 数组，则该数组将占用 24,000 个字节，无论每个元素是否具有不同的值、所有元素是否具有相同的值或介于两者之间。如果有一个 TwentyFourByteClass[1000] 数组，则该数组将占用 4,000 或 8,000 个字节（对于 32/64 位系统），并且创建的每个不同的 TwentyFourByteClass 实例将占用大约 48 个字节。如果所有数组元素碰巧持有对同一个 TwentyFourByteClass 对象的引用，那么总数将是 4,048 或 8,048 字节。如果所有数组元素都包含对不同 TwentyFourByteClass 对象的引用，则总数将为 52,000 或 56,000 字节。

至于运行时性能，您可以获得的最佳性能通常是通过引用传递结构。通过值传递结构将需要复制它们，这对于大于 16 字节的结构可能会变得昂贵（.net 包括对 16 字节或更小的结构的优化），但是通过引用的值类型的成本是相同的，无论是 1 字节还是16,000 字节。

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2009-01-04T09:04:12.060

一般来说，当存储多于两条相关数据时，我喜欢创建一个将它们绑定在一起的类。特别是如果我将它们作为一个单元传递。

# signal-handling - 为共享库或 DLL 编写信号处理程序？

> ID：410614
> 
> 赞同：2
> 
> 时间：2009-01-04T07:35:00.430
> 
> 标签：signal-handling

我有一个应用程序 A（某公司 X）。这个应用程序允许我通过编写自己的函数来扩展功能。

我告诉应用程序 A 在应用程序 A 的配置文件中调用我的用户函数（这是它知道应用程序 A 必须调用用户编写的函数的方式）。appl A 使用函数指针，我必须在调用我的用户编写的函数之前向 Application A 注册。

如果我的用户在生产中编写的函数出现错误或故障，Appl A 将停止运行。例如，如果我的用户编写的函数中有分段错误。

所以应用程序 A 将从共享的 DLL 文件中加载我的用户编写的函数。这意味着我的用户编写的函数将在应用程序 A 的进程地址空间中运行。

我希望处理某些信号，如分段错误、除以零和堆栈溢出，但应用程序 A 有自己为此编写的信号处理程序，

如何编写自己的信号处理程序来捕获用户编写的函数中的异常，以便我可以优雅地清理而不影响应用程序 A 的大部分内容？由于我的用户函数将在应用程序 A 的进程中调用，因此操作系统将调用在应用程序 A 中编写的信号处理程序，而不是我的用户函数。

我怎样才能改变这个？我希望操作系统调用在我的函数中编写的信号处理程序，但仅用于由我的函数引发的信号，这本质上是异步的。

注意：我没有应用程序 A 的源代码，我无法对其进行任何更改，因为它由不同的公司控制。

我将在 Linux、solaris 和可能的 Windows 平台上使用 C，并且仅使用 C。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-04T08:18:06.253

你没有指定你正在使用哪个平台，所以我会为 Linux 回答，它也应该对 Windows 有效。

当您设置信号处理程序时，您使用的系统调用会返回前一个处理程序。它这样做是为了在您不再对处理该信号感兴趣时将其返回。

[信号MSDN 条目的](http://msdn.microsoft.com/en-us/library/xdkz3x12.aspx)[Linux 手册页](http://linux.die.net/man/2/signal)

由于您是加载到应用程序中的共享库，因此操作信号处理程序应该没有问题。只需确保覆盖您需要的最小值，以减少中断应用程序本身的机会（某些应用程序使用信号进行异步通知）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2016-11-01T16:12:02.110

最简洁的方法是在一个单独的进程中运行您的应用程序代码，该进程通过某种 IPC 机制与嵌入式共享 DLL 代码进行通信。您可以在流程中处理您想要的任何信号，而不会影响其他流程。通常，您提到的条件（段错误、除以零、堆栈溢出）表示程序中的错误并将导致终止。除了修复错误的根本原因之外，您无能为力“处理”这些问题。

* * *

## 回答 #3

> 赞同：-5
> 
> 时间：2009-01-04T07:53:19.237

在 C++ 中，您可以通过将代码放入 try-catch 中来捕获这些：

```
try
{
   // here goes your code
}
catch ( ... )
{
   // handle segfaults
} 
```

# c# - 如何使用 ASP.NET TreeView 显示信息

> ID：410615
> 
> 赞同：0
> 
> 时间：2009-01-04T07:35:02.363
> 
> 标签：c#, asp.net, treeview

我正在尝试使用 ASP.NET TreeView 控件来显示某些网站的信息。例如： http: [//www.codeproject.com/KB/webforms/ClientSideTreeView.aspx](http://www.codeproject.com/KB/webforms/ClientSideTreeView.aspx)

上面链接的站点有一些可以折叠或展开的代码片段，显示一个带有代码片段的矩形。

第一个问题是：这是一个 TreeView 控件吗？

如果是阳性，我该怎么做？否则，这个控制是什么？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-04T08:02:39.640

是的，它是一个 TreeView 控件。（就像它说的“使用 C# 和 ASP.NET 来自 Microsoft 的 TreeView 控件”）

更多信息：

[http://msdn.microsoft.com/en-us/library/ms529261.aspx](http://msdn.microsoft.com/en-us/library/ms529261.aspx) [http://www.codeguru.com/csharp/.net/net_asp/controls/article.php/c12285](http://www.codeguru.com/csharp/.net/net_asp/controls/article.php/c12285)

# linux - 在 Linux 中增加最大 TCP/IP 连接数

> ID：410616
> 
> 赞同：235
> 
> 时间：2009-01-04T07:35:46.933
> 
> 标签：linux, networking, linux-kernel

我正在对服务器进行编程，我的连接数似乎受到了限制，因为即使我将连接数设置为“无限”，我的带宽也没有饱和。

如何增加或消除我的 Ubuntu Linux 机器一次可以打开的最大连接数？操作系统是否限制了这一点，还是路由器或 ISP？或者是别的什么？

* * *

## 回答 #1

> 赞同：456
> 
> 时间：2010-10-13T12:49:44.110

最大连接数受到客户端和服务器端的某些限制的影响，尽管略有不同。

**在客户端：** 增加临时端口范围，并减少`tcp_fin_timeout`

要找出默认值：

```
sysctl net.ipv4.ip_local_port_range
sysctl net.ipv4.tcp_fin_timeout 
```

临时端口范围定义主机可以从特定 IP 地址创建的最大出站套接字数。`fin_timeout`定义这些套接字保持状态的最短时间（`TIME_WAIT`使用一次后不可用）。通常的系统默认值是：

*   `net.ipv4.ip_local_port_range = 32768 61000`
*   `net.ipv4.tcp_fin_timeout = 60`

`(61000 - 32768) / 60 = 470`这基本上意味着您的系统不能始终保证每秒超过套接字。如果您对此不满意，可以从增加`port_range`. 如今，将范围设置`15000 61000`为非常普遍。您可以通过减少`fin_timeout`. 假设您两者都做，您应该更容易看到每秒超过 1500 个出站连接。

**要更改值**：

```
sysctl net.ipv4.ip_local_port_range="15000 61000"
sysctl net.ipv4.tcp_fin_timeout=30 
```

以上不应解释为影响系统每秒建立出站连接能力的因素。但是，这些因素会影响系统在大量“活动”期间以可持续的方式处理并发连接的能力。

典型 Linux 机器上`tcp_tw_recycle`&的默认 Sysctl 值`tcp_tw_reuse`是

```
net.ipv4.tcp_tw_recycle=0
net.ipv4.tcp_tw_reuse=0 
```

这些不允许来自“已使用”套接字（处于等待状态）的连接，并强制套接字持续整个`time_wait`周期。我建议设置：

```
sysctl net.ipv4.tcp_tw_recycle=1
sysctl net.ipv4.tcp_tw_reuse=1 
```

这允许快速循环处于`time_wait`状态的套接字并重新使用它们。但在您进行此更改之前，请确保这不会与您将用于需要这些套接字的应用程序的协议冲突。请务必阅读[文森特·伯纳特 (Vincent Bernat) 的文章“应对 TCP TIME-WAIT”](https://vincent.bernat.ch/en/blog/2014-tcp-time-wait-state-linux)以了解其含义。该`net.ipv4.tcp_tw_recycle` **选项对于面向公众的服务器来说是相当有问题的，因为它不会处理来自同一 NAT 设备后面的两台不同计算机的连接**，这是一个难以检测并等待咬你的问题。请注意，`net.ipv4.tcp_tw_recycle`已从Linux 4.12中[删除。](https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/commit/?id=4396e46187ca5070219b81773c4e65088dac50cc)

**在服务器端：** 值`net.core.somaxconn`具有重要作用。它限制排队到侦听套接字的最大请求数。如果您确定服务器应用程序的能力，请将其从默认的 128 提高到 128 到 1024 之类的值。现在您可以通过将应用程序的侦听调用中的侦听积压变量修改为相等或更高的整数来利用这种增加。

```
sysctl net.core.somaxconn=1024 
```

`txqueuelen`您的以太网卡的参数也可以发挥作用。默认值为 1000，因此如果您的系统可以处理，请将它们提高到 5000 甚至更多。

```
ifconfig eth0 txqueuelen 5000
echo "/sbin/ifconfig eth0 txqueuelen 5000" >> /etc/rc.local 
```

同样提高 和 的`net.core.netdev_max_backlog`值`net.ipv4.tcp_max_syn_backlog`。它们的默认值分别为 1000 和 1024。

```
sysctl net.core.netdev_max_backlog=2000
sysctl net.ipv4.tcp_max_syn_backlog=2048 
```

现在请记住通过在 shell 中增加 FD ulimts 来启动客户端和服务器端应用程序。

除了上述之外，程序员使用的一种更流行的技术是减少*tcp write*调用的数量。我自己的偏好是使用缓冲区，在其中我将希望发送到客户端的数据推送到客户端，然后在适当的点将缓冲的数据写出到实际的套接字中。这种技术允许我使用大数据包，减少碎片，降低我在用户空间和内核级别的 CPU 利用率。

* * *

## 回答 #2

> 赞同：70
> 
> 时间：2009-01-04T08:02:32.010

有几个变量可以设置最大连接数。最有可能的是，您首先用完了文件编号。检查`ulimit -n`。之后，里面有设置`/proc`，但默认都是几万。

更重要的是，听起来你做错了什么。单个 TCP 连接应该能够使用两方之间的所有带宽；如果不是：

*   检查您的 TCP 窗口设置是否足够大。Linux 默认值适用于除真正快速的 inet 链接（数百 mbps）或快速卫星链接之外的所有内容。您的带宽*延迟积是多少？
*   使用 ping 大数据包检查数据包丢失 ( `ping -s 1472`...)
*   检查速率限制。在 Linux 上，这是配置为`tc`
*   使用例如确认您认为存在的带宽确实存在，`iperf`
*   确认您的协议是健全的。记住延迟。
*   如果这是一个千兆+ LAN，您可以使用巨型数据包吗？你是？

可能我理解错了。也许你正在做类似 Bittorrent 的东西，你需要大量的连接。如果是这样，您需要弄清楚您实际使用了多少个连接（尝试`netstat`或`lsof`）。如果这个数字很大，您可以：

*   有很多带宽，例如 100mbps+。在这种情况下，您实际上可能需要升级`ulimit -n`. 尽管如此，大约 1000 个连接（我的系统上的默认值）还是相当多的。
*   有网络问题会减慢您的连接速度（例如，数据包丢失）
*   有其他东西会减慢您的速度，例如 IO 带宽，特别是如果您正在寻找。你检查过`iostat -x`吗？

此外，如果您使用的是消费级 NAT 路由器（Linksys、Netgear、DLink 等），请注意，您可能会因数千个连接而超出其能力。

我希望这能提供一些帮助。你真的在问一个网络问题。

* * *

## 回答 #3

> 赞同：19
> 
> 时间：2012-10-12T18:36:35.707

为了改进derobert给出的答案，

您可以通过 catting nf_conntrack_max 确定您的操作系统连接限制。

例如：cat /proc/sys/net/netfilter/nf_conntrack_max

您可以使用以下脚本来计算与给定 tcp 端口范围的 tcp 连接数。默认为 1-65535。

这将确认您是否正在最大化您的操作系统连接限制。

这是脚本。

```
#!/bin/bash
OS=$(uname)

case "$OS" in
    'SunOS')
            AWK=/usr/bin/nawk
            ;;
    'Linux')
            AWK=/bin/awk
            ;;
    'AIX')
            AWK=/usr/bin/awk
            ;;
esac

netstat -an | $AWK -v start=1 -v end=65535 ' $NF ~ /TIME_WAIT|ESTABLISHED/ && $4 !~ /127\.0\.0\.1/ {
    if ($1 ~ /\./)
            {sip=$1}
    else {sip=$4}

    if ( sip ~ /:/ )
            {d=2}
    else {d=5}

    split( sip, a, /:|\./ )

    if ( a[d] >= start && a[d] <= end ) {
            ++connections;
            }
    }
    END {print connections}' 
```

* * *

## 回答 #4

> 赞同：10
> 
> 时间：2014-11-19T21:26:44.953

在应用程序级别，开发人员可以执行以下操作：

**从服务器端：**

1.  检查负载均衡器（如果有）是否正常工作。

2.  将慢速 TCP 超时转换为 503 快速即时响应，如果您的负载均衡器正常工作，它应该选择工作资源来提供服务，这比挂在那里有意外的错误消息要好。

例如：如果你使用的是节点服务器，你可以从 npm 使用 toobusy。实现类似：

```
var toobusy = require('toobusy');
app.use(function(req, res, next) {
  if (toobusy()) res.send(503, "I'm busy right now, sorry.");
  else next();
}); 
```

为什么是 503？以下是一些关于过载的好见解：http: [//ferd.ca/queues-don-t-fix-overload.html](http://ferd.ca/queues-don-t-fix-overload.html)

**我们也可以在客户端做一些工作：**

1.  尝试对呼叫进行批量分组，减少客户端和服务器的流量和总请求数。

2.  尝试构建一个缓存中间层来处理不必要的重复请求。

# gcc - 在 gcc 构建中禁用 gcov

> ID：410617
> 
> 赞同：2
> 
> 时间：2009-01-04T07:37:44.557
> 
> 标签：gcc, build-process, gcov

任何人都知道如何在制作 GCC 时告诉它不要构建 gcov？它给我的目标（powerpc-wrs-vxworks）带来了很多错误。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-04T08:51:16.517

我在 gcc/Makefile.in 中找到了这一行：

```
LANGUAGES = c gcov$(exeext) gcov-dump$(exeext) $(CONFIG_LANGUAGES) 
```

尝试删除 gcov 部件并重新运行配置。

# arrays - 在 Ruby 中将数组转换为索引哈希

> ID：410623
> 
> 赞同：44
> 
> 时间：2009-01-04T07:43:25.717
> 
> 标签：arrays, ruby, hash, set

我有一个数组，我想做一个散列，这样我就可以快速询问“数组中有 X 吗？”。

在 perl 中，有一种简单（快速）的方法可以做到这一点：

```
my @array = qw( 1 2 3 );
my %hash;
@hash{@array} = undef; 
```

这会生成一个看起来像这样的哈希：

```
{
    1 => undef,
    2 => undef,
    3 => undef,
} 
```

我在 Ruby 中想出的最好的方法是：

```
array = [1, 2, 3]
hash = Hash[array.map {|x| [x, nil]}] 
```

这使：

```
{1=>nil, 2=>nil, 3=>nil} 
```

有更好的 Ruby 方法吗？

## 编辑 1

不，Array.include？这不是一个好主意。它的**慢**。它在 O(n) 而不是 O(1) 中进行查询。为简洁起见，我的示例数组包含三个元素；假设实际有一百万个元素。让我们做一些基准测试：

```
#!/usr/bin/ruby -w
require 'benchmark'

array = (1..1_000_000).to_a
hash = Hash[array.map {|x| [x, nil]}]

Benchmark.bm(15) do |x|
    x.report("Array.include?") { 1000.times { array.include?(500_000) } }
    x.report("Hash.include?") { 1000.times { hash.include?(500_000) } }
end 
```

产生：

```
 user     system      total        real
Array.include?  46.190000   0.160000  46.350000 ( 46.593477)
Hash.include?    0.000000   0.000000   0.000000 (  0.000523) 
```

* * *

## 回答 #1

> 赞同：44
> 
> 时间：2009-01-04T15:45:07.663

如果您只需要成员资格，请考虑使用[`Set`](http://ruby-doc.org/stdlib/libdoc/set/rdoc/Set.html)：

> # 放
> 
> [Set](http://ruby-doc.org/stdlib/libdoc/set/rdoc/Set.html)实现了一组无重复的无序值。这是 Array 的直观互操作设施和 Hash 的快速查找的混合体。
> 
> [Set](http://ruby-doc.org/stdlib/libdoc/set/rdoc/Set.html)易于与[Enumerable](http://ruby-doc.org/core/Enumerable.html)对象一起使用（实现 `each`）。除了集合和数组之外，大多数初始化方法和二元运算符都接受通用的[Enumerable对象。](http://ruby-doc.org/core/Enumerable.html)可以使用该 方法将 [Enumerable](http://ruby-doc.org/core/Enumerable.html)对象转换为[Set 。](http://ruby-doc.org/stdlib/libdoc/set/rdoc/Set.html)[`to_set`](http://ruby-doc.org/stdlib-2.2.1/libdoc/set/rdoc/Enumerable.html#method-i-to_set)
> 
> [Set](http://ruby-doc.org/stdlib/libdoc/set/rdoc/Set.html)使用Hash作为存储，所以必须注意以下几点：
> 
> *   元素的相等性根据`Object#eql?`和确定`Object#hash`。
> *   Set 假设每个元素的标识在存储时不会改变。修改集合中的元素会使集合处于不可靠状态。
> *   当要存储字符串时，将存储该字符串的冻结副本，除非原始字符串已被冻结。
> 
> ## 比较
> 
> 比较运算符`<`、`>`和被实现为 {proper_,}{subset?,superset?} 方法的简写`<=`。`>=`然而， `<=>`操作符被故意排除在外，因为不是每一对集合都是可比的。（例如 {x,y} 与 {x,z}）
> 
> ## 例子
> 
> ```
> require 'set'
> s1 = Set.new [1, 2]                   # -> #<Set: {1, 2}>
> s2 = [1, 2].to_set                    # -> #<Set: {1, 2}>
> s1 == s2                              # -> true
> s1.add("foo")                         # -> #<Set: {1, 2, "foo"}>
> s1.merge([2, 6])                      # -> #<Set: {1, 2, "foo", 6}>
> s1.subset? s2                         # -> false
> s2.subset? s1                         # -> true 
> ```
> 
> [...]
> 
> ## 公共类方法
> 
> ### 新的（枚举 = 无）
> 
> 创建一个包含给定可枚举对象的元素的新集合。
> 
> 如果给定一个块，则枚举的元素由给定的块预处理。

* * *

## 回答 #2

> 赞同：24
> 
> 时间：2013-01-06T12:34:35.383

试试这个：

```
a=[1,2,3]
Hash[a.zip] 
```

* * *

## 回答 #3

> 赞同：14
> 
> 时间：2012-08-02T07:27:48.077

你可以做这个非常方便的技巧：

```
Hash[*[1, 2, 3, 4].map {|k| [k, nil]}.flatten]
=> {1=>nil, 2=>nil, 3=>nil, 4=>nil} 
```

* * *

## 回答 #4

> 赞同：9
> 
> 时间：2009-01-04T08:08:39.643

如果你想快速询问“数组中有X吗？” 你应该使用[`Array#include?`](http://www.ruby-doc.org/core/classes/Array.html#M002226).

**编辑（响应 OP 中的添加）：**

如果您想要快速查找时间，请使用 Set。拥有一个指向所有`nil`s 的 Hash 是愚蠢的。转换也是一个简单的过程`Array#to_set`。

```
require 'benchmark'
require 'set'

array = (1..1_000_000).to_a
set = array.to_set

Benchmark.bm(15) do |x|
    x.report("Array.include?") { 1000.times { array.include?(500_000) } }
    x.report("Set.include?") { 1000.times { set.include?(500_000) } }
end 
```

我的机器上的结果：

```
 user     system      total        real
Array.include?  36.200000   0.140000  36.340000 ( 36.740605)
Set.include?     0.000000   0.000000   0.000000 (  0.000515) 
```

您应该考虑只使用一个集合，而不是一个数组，这样就不需要进行转换。

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2009-01-04T14:16:18.263

我相当确定没有一种一次性的聪明方法来构造这个散列。我的倾向是明确说明我在做什么：

```
hash = {}
array.each{|x| hash[x] = nil} 
```

它看起来不是特别优雅，但它很清晰，并且可以完成工作。

FWIW，您最初的建议（至少在 Ruby 1.8.6 下）似乎不起作用。我收到“ArgumentError：Hash 的奇数个参数”错误。Hash.[] 需要一个文字的、偶数长度的值列表：

```
Hash[a, 1, b, 2] # => {a => 1, b => 2} 
```

所以我尝试将您的代码更改为：

```
hash = Hash[*array.map {|x| [x, nil]}.flatten] 
```

但表现很糟糕：

```
#!/usr/bin/ruby -w
require 'benchmark'

array = (1..100_000).to_a

Benchmark.bm(15) do |x|
  x.report("assignment loop") {hash = {}; array.each{|e| hash[e] = nil}}
  x.report("hash constructor") {hash = Hash[*array.map {|e| [e, nil]}.flatten]}
end 
```

给

```
 user     system      total        real
assignment loop  0.440000   0.200000   0.640000 (  0.657287)
hash constructor  4.440000   0.250000   4.690000 (  4.758663) 
```

除非我在这里遗漏了什么，否则一个简单的赋值循环似乎是构造这个散列的最清晰和最有效的方法。

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2009-01-04T16:01:02.530

Rampion 打败了我。设置可能是答案。

你可以做：

```
require 'set'
set = array.to_set
set.include?(x) 
```

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2009-01-04T09:24:48.693

您创建哈希的方式看起来不错。我在 irb 周围乱七八糟，这是另一种方式

```
>> [1,2,3,4].inject(Hash.new) { |h,i| {i => nil}.merge(h) }
=> {1=>nil, 2=>nil, 3=>nil, 4=>nil} 
```

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2009-01-04T15:24:02.730

我认为[chrissear](https://stackoverflow.com/questions/410623/convert-an-array-into-an-index-hash-in-ruby#411031)关于使用分配而不是创造的观点很棒。不过，为了让整个事情更像 Ruby 风格，我可能会建议为每个元素分配其他内容*：*`nil`

```
hash = {}
array.each { |x| hash[x] = 1 } # or true or something else "truthy"
...
if hash[376]                   # instead of if hash.has_key?(376)
  ...
end 
```

分配给的问题`nil`是您必须使用`has_key?`而不是`[]`，因为如果没有指定的键，则`[]`给您`nil`（您的标记值） 。`Hash`您*可以*通过使用不同的默认值来解决这个问题，但为什么要进行额外的工作呢？

```
# much less elegant than above:
hash = Hash.new(42)
array.each { |x| hash[x] = nil }
...
unless hash[376]
  ...
end 
```

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-01-04T08:08:55.663

也许我误解了这里的目标；如果你想知道 X 是否在数组中，为什么不做 array.include?("X") ？

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2009-01-05T08:29:16.433

到目前为止，对建议进行一些基准测试表明 chrismear 和 Gaius 的基于赋值的哈希创建比我的 map 方法稍快（并且赋值 nil 比赋值 true 稍快）。mtyaka 和 rampion 的 Set 建议的创建速度要慢 35%。

就查找而言，`hash.include?(x)`比`hash[x]`;快一点。两者的速度都是 的两倍`set.include?(x)`。

```
 user     system      total        real
chrismear   6.050000   0.850000   6.900000 (  6.959355)
derobert    6.010000   1.060000   7.070000 (  7.113237)
Gaius       6.210000   0.810000   7.020000 (  7.049815)
mtyaka      8.750000   1.190000   9.940000 (  9.967548)
rampion     8.700000   1.210000   9.910000 (  9.962281)

                user     system      total        real
times      10.880000   0.000000  10.880000 ( 10.921315)
set        93.030000  17.490000 110.520000 (110.817044)
hash-i     45.820000   8.040000  53.860000 ( 53.981141)
hash-e     47.070000   8.280000  55.350000 ( 55.487760) 
```

基准代码是：

```
#!/usr/bin/ruby -w
require 'benchmark'
require 'set'

array = (1..5_000_000).to_a

Benchmark.bmbm(10) do |bm|
    bm.report('chrismear') { hash = {}; array.each{|x| hash[x] = nil} }
    bm.report('derobert')  { hash = Hash[array.map {|x| [x, nil]}] }
    bm.report('Gaius')     { hash = {}; array.each{|x| hash[x] = true} }
    bm.report('mtyaka')    { set = array.to_set }
    bm.report('rampion')   { set = Set.new(array) }
end

hash = Hash[array.map {|x| [x, true]}]
set = array.to_set
array = nil
GC.start

GC.disable
Benchmark.bmbm(10) do |bm|
    bm.report('times')  { 100_000_000.times { } }
    bm.report('set')    { 100_000_000.times { set.include?(500_000) } }
    bm.report('hash-i') { 100_000_000.times { hash.include?(500_000) } }
    bm.report('hash-e') { 100_000_000.times { hash[500_000] } }
end
GC.enable 
```

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2010-08-13T14:34:47.327

如果您不介意哈希值是什么

```
irb(main):031:0> a=(1..1_000_000).to_a ; a.length
=> 1000000
irb(main):032:0> h=Hash[a.zip a] ; h.keys.length
=> 1000000 
```

在我的桌面上花费一秒钟左右。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2009-01-04T08:18:52.337

如果您正在寻找与此 Perl 代码等效的代码：

```
grep {$_ eq $element} @array 
```

您可以只使用简单的 Ruby 代码：

```
array.include?(element) 
```

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2009-01-04T15:46:30.873

这是使用哈希缓存查找的一种巧妙方法：

```
a = (1..1000000).to_a
h = Hash.new{|hash,key| hash[key] = true if a.include? key} 
```

它所做的几乎就是为新的哈希值创建一个默认构造函数，然后如果它在数组中，则将“true”存储在缓存中（否则为零）。这允许延迟加载到缓存中，以防万一您不使用每个元素。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2014-04-21T12:17:46.500

如果您的哈希是，这将保留 0`[0,0,0,1,0]`

```
 hash = {}
  arr.each_with_index{|el, idx| hash.merge!({(idx + 1 )=> el }) } 
```

返回：

```
 # {1=>0, 2=>0, 3=>0, 4=>1, 5=>0} 
```

# xml - 如何声明特殊的 XML 模式 (XSD) 案例

> ID：410628
> 
> 赞同：4
> 
> 时间：2009-01-04T07:45:19.910
> 
> 标签：xml, xsd

我需要您的帮助来定义 XML 模式中的特殊情况：包含两个元素的序列：“x”和“y”，而：

*   `<x>`元素可以在序列中出现 0 到未绑定的次数

*   `<y>`元素可以在序列中出现 0 到 1 次

*   `<x>`并且`<y>`位置可以在任何地方——也就是说，可以有未绑定乘以`<x>`元素，然后是单个`<y>`元素，然后是未绑定乘以`<x>`元素。

此问题的 XML 示例：

## 示例 #1

```
<x>stuff</x>
<y>stuff</y>
<x>stuff</x> 
```

## 示例 #2

```
<y>stuff</y>
<x>stuff</x>
<x>stuff</x> 
```

## 示例#3

```
<x>stuff</x> 
<x>stuff</x>
<y>stuff</y>
<x>stuff</x> 
```

谢谢！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-01-04T12:15:14.123

由于各种原因，Yuval、Mo 或 davidsheldon 的样本都不起作用。这是一个。

```
 <xs:complexType name="myComplexType">
    <xs:sequence>
        <xs:element name="x" type="xs:string" minOccurs="0" maxOccurs="unbounded"/>
        <xs:sequence minOccurs="0">
            <xs:element name="y" type="xs:string"/>
            <xs:element name="x" type="xs:string" minOccurs="0" maxOccurs="unbounded"/>
        </xs:sequence>
    </xs:sequence>
    </xs:complexType> 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-04T11:04:39.100

编辑：正如 Alohci 提到的，我的解决方案不正确。根据规范，xs:all 中的元素只能出现零次或一次。任何不便敬请谅解

我认为你想要的不是一个序列。序列不仅定义了元素，还定义了顺序。在你的情况下，订单可能会改变。你试过 xs:all 吗？

```
<xs:complexType name="myComplexType">
  <xs:all>
    <xs:element name="x" type="xs:string" maxOccurs="unbounded"/>
    <xs:element name="y" type="xs:string" maxOccurs="1"/>
  </xs:all>
</xs:complexType> 
```

另一种方法可能是使其成为一个序列，但将序列标记为`maxOccurs="unbounded"`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-04T08:16:14.527

不太复杂。在我的脑海中，它应该是这样的：

```
<xs:element name="x" type="xs:string" minOccurs="0" maxOccurs="unbounded"/>
<xs:element name="y" type="xs:string" minOccurs="0" maxOccurs="1"/>
<xs:element name="x" type="xs:string" minOccurs="0" maxOccurs="unbounded"/> 
```

由于默认情况下 XSD 中的每个元素都是可选的，因此该 XSD 将匹配您定义的 XML 结构，该`y`元素出现在元素之前、之后或之间的任何位置，`x`最多出现 1 次

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-04T11:05:13.920

自从我使用模式以来已经有一段时间了，但我认为序列是你的答案。

您需要在 (an x) 或 (ay 后跟 x) 之间有无限数量的选择。

```
<xsd:element name="parent">
  <xsd:complexType>
    <xsd:choice maxOccurs="unbounded">
      <xsd:element name="x" type="xs:string"/>
      <xsd:sequence>
        <xsd:element name="y" type="xsd:string" />
        <xsd:element name="x" type="xsd:string" />
      </xsd:sequence>
    </xsd:choice>
  </xsd:complexType>  
</xsd:element> 
```

# hibernate - Hibernate 中每个具体类层次结构的表

> ID：410630
> 
> 赞同：3
> 
> 时间：2009-01-04T07:47:25.507
> 
> 标签：hibernate, class-hierarchy

我有以下休眠映射，必须使用每个具体类层次结构的表进行映射：

```
<hibernate-mapping package='dao'>
    <meta attribute='class-description'></meta>
    <class name='PropertyDAO'>
        <id name='id' column='id_property'>
            <generator class='assigned'/>
        </id>
        <property name='address' column='address' type='string'/>
        <union-subclass name='HouseDAO' table='house'>
            <property name='noOfRooms' column='noOfRooms'/>
            <property name='totalArea' column='totalArea'/>
            <property name='price' column='price'/>
        </union-subclass>
        <union-subclass name='LandDAO' table='land'>
            <property name='area' column='area'/>
            <property name='unitPrice' column='unitPrice'/>
        </union-subclass>
    </class>
</hibernate-mapping> 
```

这意味着在数据库中我只有 2 个表：

*   房子（id_property（PK），地址，noOfRooms，totalArea，价格）
*   土地（id_property（PK），地址，面积，单价）

据我了解，在这种情况下，需要在调用 .save() 之前显式生成 id，所以我的问题是：如何创建自动生成 id 的策略，以便来自具体类的 id加入时形成一个连续的域。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-04T11:03:21.850

恕我直言，您在数据库中的模型是错误的，因为您在多个相关的表中有冗余信息。

每个具体类的表是一种继承模型，它在运行时会出现问题，因为您可能会遇到这样的情况：当它们相同（语义上）时更新 Land 的地址而不是 House 的地址。Iow：删除此模型并引入每个子类的表，因此您有一个带有 id 和地址的属性基表和两个带有 PK 的分隔表，PK 是属性基础 pk 的 FK，一个是带有房屋特定字段的房屋，另一个是具有土地特定领域的土地。

这会给您带来最少的问题，因为它是将实体类型之间的继承转换为关系表的方式（参见 Nijssen/Halpin 关于 NIAM/ORM 的书籍）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-04T08:01:25.227

我将以下内容与joined-subclass一起使用

```
<key column="id"/> 
```

这应该使子类使用属性表中的 id，因为这依赖于它。（超）列是指子类中的列，它是对超的外部引用。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-29T21:02:54.213

The solution is to create another table that stores the next id; this value should be modified each time a user wants to insert a new entity. In this way, the domain is continuous

# jquery - 使用 jQuery 操作列表项

> ID：410632
> 
> 赞同：0
> 
> 时间：2009-01-04T07:49:39.603
> 
> 标签：jquery

我目前正在尝试使用 jQuery 操作无序列表，本质上我在无序列表中有一个链接列表，某些用户只能访问（全部设置服务器端）某些文件/页面。

我希望使用一些 jQuery 从 DOM 中删除一些列表项，只是因为不让用户单击链接、加载页面然后因为访问权限不足而显示错误对我更有吸引力。

我已经有一个对象设置，并且已经成功地从 DOM 中删除了一个独立的链接，尽管我似乎无法让选择器正确地删除列表项。

列表 HTML：

```
<div id="browse" class="bubble"> 
<blockquote>
<ul id="browses">
<li><a href="browse.php?id=15" class="browse">Access</a><br /></li> //trying to remove
<li><a href="browse.php?id=1" class="browse">Accounts</a><br /></li> //trying to remove
<li><a href="browse.php?id=2" class="browse">Browse's</a><br /></li> //trying to remove
<li><a href="browse.php?id=7" class="browse">Commands</a><br /></li> //trying to remove
<li><a href="browse.php?id=4" class="browse">Content</a><br /></li>
<li><a href="browse.php?id=8" class="browse">Logs</a><br /></li>
<li><a href="browse.php?id=10" class="browse">Sessions</a><br /></li>
<li><a href="browse.php?id=11" class="browse">Settings</a><br /></li> //trying to remove
<li><a href="browse.php?id=12" class="browse">Sites</a><br /></li> //trying to remove
</ul>   
</blockquote>
<cite>Browse and manage the currently active sites data</cite>
</div> 
```

到目前为止的对象：

```
Session = function(){
    this.init(phpdev_session);
}

$.extend(Session.prototype, {
    // object variables
    vars: '',

    init: function(phpdev_session){
        // do initialization here
        this.vars = phpdev_session;
    },

    restrict: function() {
        if (this.vars.account_class == '40') {
            //access client or less, remove manage another site link and a few browses from #browse ul
            //note: its all restricted server side, so its just a presentation layer.
            $('a#activate').remove();
            $('#browses').remove('li:eq(0)').remove('li:eq(1)').remove('li:eq(2)').remove('li:eq(3)').remove('li:eq(7)').remove('li:eq(8)');
        }
    }
});

$(document).ready(function() {
    var session = new Session(phpdev_session);
    session.restrict();
}); 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-04T07:59:18.523

我不认为 jQuery 是正确的工具（我会在服务器端做），但我会在他们无权访问的项目中添加一个类服务器端，然后就做

```
$(".noAccess").remove(); 
```

If you're going to do that though, just remove them server-side since you'll have the code in place.

# c# - 如何在进度条上显示刻度线？

> ID：410651
> 
> 赞同：1
> 
> 时间：2009-01-04T08:12:59.400
> 
> 标签：c#, winforms, progress-bar

我正在下载一组文件，我想在进度条中显示进度。通过将进度条的最大值设置为所有文件的总大小，并将当前位置设置为到目前为止下载的大小，可以简单地显示整体进度。

我想做的是将进度条分成多个部分，每个部分代表集合中的不同文件。

这可能吗？我该怎么做？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-04T08:30:20.847

我认为最简单的方法是制作一个 UserControl，在其上放置一个 ProgressBar，覆盖 UserControl 的 OnPaint() 并绘制线条。

我认为 UserControl 会比直接在表单上绘制更容易处理。坐标会更容易处理，而且更容易在另一个应用程序中重用它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-04T08:15:27.400

如果您知道要下载的文件的总大小，并且您知道到目前为止下载的文件的总大小，那么您可以将 .Maximum 设置为文件的总大小，并将 .Position 设置为到目前为止的总下载量. 无需担心文件之间的大小是如何分割的。

还是您的意思是要根据每个文件的大小在进度条上打勾？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-04T08:38:59.223

将最大值设置为 100。然后对下载的每个文件执行 100*(file_size/total_download_size) 并将它们加在一起。将它们的值加在一起后，设置进度条的值。每次文件完成下载时更新该值。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-04T08:56:25.413

您可以使用两个进度条，一个用于每个文件，一个用于总计。或者，如果您想要刻度线：简单的解决方案是在该栏下方或上方添加一些线条。

# database - 测试用户数据（假数据）

> ID：410653
> 
> 赞同：55
> 
> 时间：2009-01-04T08:14:30.770
> 
> 标签：database, testing, test-data

我可以从哪里获得，或者如何生成可用于测试应用程序的大量虚假用户数据（姓名、电子邮件地址、位置等）的大格式集合？

它可以明显是假的，这将仅限于开发服务器。但我敢肯定，任何事情都会比我想出的要好。

* * *

## 回答 #1

> 赞同：74
> 
> 时间：2009-01-04T08:23:07.307

有一些专门为此而构建的工具。我之前使用[http://www.generatedata.com/](http://www.generatedata.com/)为 MySql 数据库生成数据。[RedGate 有一个很好的工具，可以用称为SQL 数据生成器](http://www.red-gate.com/products/SQL_Data_Generator/index.htm)的测试数据填充您的 SQL Server 数据库。RedGate 工具的价格约为 300 美元，但有免费试用版。

更新： [Faker.js](https://github.com/marak/Faker.js/)现在可用。这是一个基于 node.js 构建的项目，看起来非常全面。

另一个更新：[Mockaroo](https://www.mockaroo.com)很棒！

如果您想要伪造用户数据的 HTTP API，请查看[随机用户生成器](https://randomuser.me/)

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-01-04T08:23:53.793

这是一个用于生成各种类型测试数据的开源工具。[http://www.generateddata.com](http://www.generatedata.com/#about)

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2010-02-01T22:06:58.850

[http://www.fakenamegenerator.com/](http://www.fakenamegenerator.com/)是一个很好的资源，用于创建具有真实外观的用户的测试数据，包括 SSN、电子邮件地址……他们也有批量下载选项。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-07-04T06:28:22.810

看看这个“有趣的名字”列表，其中一些是经典的

[http://www.ethanwiner.com/funnames.html](http://www.ethanwiner.com/funnames.html)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2010-02-01T22:13:32.593

另一个开源测试生成器工具是我自己的[http://code.google.com/p/csvtest](http://code.google.com/p/csvtest)。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-02-28T17:24:09.097

对于正在寻找此问题的更新解决方案的任何人...我为 Data Synchronization Studio 编写了一个测试数据生成器项目。它可以生成一个大型数据集，范围从 1 到 100 几百万行实际测试数据（那里有很多 OF :D）无论如何，这里有一篇关于它的博客文章。[http://www.simego.com/Blog/2012/02/Test-Data-Generator-Download-for-Data-Sync](http://www.simego.com/Blog/2012/02/Test-Data-Generator-Download-for-Data-Sync)

# c# - 我可以从 C# 中的 const char 初始化 const 字符串吗？

> ID：410692
> 
> 赞同：8
> 
> 时间：2009-01-04T08:53:24.623
> 
> 标签：c#, string, constants

我正在尝试以某种方式执行以下操作：

```
const char EscapeChar = '\\';
const string EscapeString = EscapeChar.ToString(); // or ("" + EscapeChar) 
```

这不编译。还有另一种方法可以使它工作吗？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-01-04T10:01:38.060

来自[C# 语言规范](http://guide.opendns.com/track/click.php?q=c%23+specification&curl=http%3A%2F%2Fwww.ecma-international.org%2Fpublications%2Fstandards%2FEcma-334.htm&search_grp=MAINRESULTS&search_pos=2)（§ 17.3 和 14.16）：

> **17.3 常数**
> 
> 常量是表示常量值的类成员：可以在编译时计算的值。

和

> **14.16 常量表达式**
> 
> 常量表达式是应*在编译时完全求值*的表达式。如果表达式需要是常量，则在语法中通过使用常量表达式来指示。*[...]常量表达式*中允许使用以下结构：
> 
> *   文字（包括空文字）
> *   对类和结构类型的 const 成员的引用。
> *   对枚举类型成员的引用。
> *   带括号的子表达式，它们本身就是常量表达式。
> *   转换表达式，前提是目标类型是上面列出的类型之一。
> *   预定义的选中和未选中、+、–、! 和 ~ 一元运算符。
> *   预定义的 +、–、*、/、%、<<、>>、&、|、^、&&、||、==、!=、<、>、<= 和 >= 二元运算符，提供每个操作数属于上面列出的类型。
> *   ?: 条件运算符。
> *   sizeof 表达式，前提是非托管类型是第 14.5.12 节中指定的类型之一。
> *   默认值表达式，前提是类型是上面列出的类型之一，或者类型是引用类型或已知为引用类型的类型参数（第 25.7 节）。
> 
> 常量表达式中允许进行以下转换：
> 
> *   身份转换
> *   数值转换
> *   枚举转换

实现您想要的另一种方法是使用静态只读成员。只读成员在运行时评估，而不是在编译时评估。因此，您可以使用 ToString() 方法。

```
private static readonly EscapeString = EscapeChar.ToString(); 
```

**注意：**因为只读字段可以在类的声明或构造函数中初始化，所以只读字段可以具有*不同的值，具体取决于使用的构造函数*。

[这是一篇关于const 和 readonly 成员之间区别](http://en.csharp-online.net/const,_static_and_readonly)的好文章。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-01-04T08:56:21.920

我看不出有什么办法，我同意这有点可惜——但你真的*需要*它来`const`代替`static readonly`吗？后者将具有*几乎*相同的语义。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-04T09:00:05.093

我能想到的唯一方法（都不理想）是：

```
const string EscapeString = "\\";
private static readonly EscapeString = EscapeChar.ToString(); 
```

或者，只要您需要字符串版本，您就可以坚持使用 char 版本和 ToString() :)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2014-12-15T13:11:51.087

C#.Net const 需要在编译时初始化其值。这就是原因，您的代码没有编译。您可以使用只读字段来分配运行时间值。

但是，以下代码将起作用：

```
const char EscapeChar = '\\';
readonly string EscapeString = EscapeChar.ToString(); // or ("" + EscapeChar) 
```

# php - PHP 的 json_encode 中的西里尔字符

> ID：410704
> 
> 赞同：19
> 
> 时间：2009-01-04T09:04:22.323
> 
> 标签：php, utf-8, json

我正在尝试使用 php 的函数 json_encode 将 Cyrillic UTF-8 数组编码为 JSON 字符串。示例代码如下所示：

```
<?php
  $arr = array(
     'едно' => 'първи',
     'две' => 'втори'
  );
  $str = json_encode($arr);
  echo $str;
?> 
```

它工作正常，但脚本的结果表示为：

```
{"\u0435\u0434\u043d\u043e":"\u043f\u044a\u0440\u0432\u0438","\u0434\u0432\u0435":"\u0432\u0442\u043e\u0440\u0438"} 
```

每个西里尔字符有 6 个字符。有没有办法获取键/值对的原始字符而不是编码字符？

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2011-09-23T12:12:46.953

你不能在这里使用[JSON_UNESCAPED_UNICODE](http://php.net/manual/en/function.json-encode.php)常量吗？

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2009-08-04T18:28:57.693

我在 Zend 框架的代码中发现了这一点：

[http://framework.zend.com/svn/framework/standard/trunk/library/Zend/Json/Decoder.php](http://framework.zend.com/svn/framework/standard/trunk/library/Zend/Json/Decoder.php)

看一下函数 decodeUnicodeString（第 474 行）：

```
 /**
     * Decode Unicode Characters from \u0000 ASCII syntax.
     *
     * This algorithm was originally developed for the
     * Solar Framework by Paul M. Jones
     *
     * @link   http://solarphp.com/
     * @link   http://svn.solarphp.com/core/trunk/Solar/Json.php
     * @param  string $value
     * @return string
     */
    public static function decodeUnicodeString($chrs) 
```

它是静态的，您可以轻松提取它 - 只需替换以下行：

```
490:           $utf8 .= self::_utf162utf8($utf16); 
```

和：

```
490:           $utf8 .= mb_convert_encoding($utf16, 'UTF-8', 'UTF-16'); 
```

不是一个理想的解决方案，但为我完成了工作:o)

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2014-08-14T05:49:01.190

```
$str = json_encode($arr, JSON_UNESCAPED_UNICODE); 
```

这个解决方案的使用对我来说适用于拉丁字母和西里尔字母，PHP 5.5

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2017-02-21T10:25:16.913

这是一个非常古老的问题，但我认为它没有得到正确回答。

使用这样的东西：

```
print json_encode($array, JSON_UNESCAPED_UNICODE); 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-01-04T09:12:23.273

看起来 PHP 的内置`json_encode`仅适用于`UTF-8`，而没有其他花里胡哨的东西可以调整它在编码方面的工作方式。

我在 Google 上找到[了一个完全公平和平衡的 php json 库比较。](http://gggeek.altervista.org/sw/article_20061113.html)它可能会帮助你。如果可能，您可以尝试基于此处的表的另一个库。[json.org](http://json.org/)上列出了其他 PHP 库，您可以进行试验。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-01-04T09:58:15.040

它适用于[http://pear.php.net/pepr/pepr-proposal-show.php?id=198](http://pear.php.net/pepr/pepr-proposal-show.php?id=198)

在 JSON.php 中使用讨厌的绕过，第 298 行..

```
$char = pack('C*', $ord_var_c, ord($var{$c + 1}));
$c += 1;
//$utf16 = $this->utf82utf16($char);
//$ascii .= sprintf('\u%04s', bin2hex($utf16));
$ascii .= $char; 
```

谢谢！

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2012-11-15T15:25:16.277

我正在为土耳其语处理同样的问题......事实上，我们不需要做任何事情，浏览器会自动将它们转换为 JS 代码块。因此，让它们解码的最简单方法是通过 javascript 获取它们。（阿贾克斯等...）

[Json 用非 ascii 字符编码？](https://stackoverflow.com/questions/13400242/json-encode-for-with-non-ascii-characters#comment18306188_13400242)

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2020-06-06T13:47:41.600

您可以使用以下选项：

```
json_encode($json, JSON_UNESCAPED_SLASHES | JSON_UNESCAPED_UNICODE); 
```

# c# - 在 C# 中确定两个路径是否引用同一文件的最佳方法

> ID：410705
> 
> 赞同：39
> 
> 时间：2009-01-04T09:05:01.777
> 
> 标签：c#, api, filesystems

在即将到来的 Java7 中，有一个[新的 API](http://docs.oracle.com/javase/7/docs/api/java/nio/file/Files.html#isSameFile(java.nio.file.Path,%20java.nio.file.Path))来检查两个文件对象是否是相同的文件引用。

.NET 框架中是否提供了类似的 API？

我在 MSDN 上搜索过它，但没有任何启发。

我希望它简单，但我不想按文件名进行比较，这会导致硬/符号链接和不同样式的路径出现问题。（例如`\\?\C:\`，`C:\`）。

我要做的只是防止重复的文件被拖放到我的链接列表中。

* * *

## 回答 #1

> 赞同：34
> 
> 时间：2009-01-04T10:24:08.683

据我所见[(1)](http://hg.openjdk.java.net/nio/nio/jdk/file/d5e2831c01c4/src/windows/native/sun/nio/ch/FileKey.c) [(2)](http://hg.openjdk.java.net/nio/nio/jdk/file/d5e2831c01c4/src/windows/classes/sun/nio/fs/WindowsFileAttributes.java) [(3)](http://hg.openjdk.java.net/nio/nio/jdk/file/d5e2831c01c4/src/windows/classes/sun/nio/fs/WindowsPath.java) [(4)](http://hg.openjdk.java.net/nio/nio/jdk/file/d5e2831c01c4/src/share/classes/java/nio/file/FileRef.java)，JDK7 的做法是对文件调用[GetFileInformationByHandle](http://msdn.microsoft.com/en-us/library/aa364952(VS.85).aspx)并比较 dwVolumeSerialNumber、nFileIndexHigh 和 nFileIndexLow。

根据 MSDN：

> 您可以比较 BY_HANDLE_FILE_INFORMATION 结构中返回的 VolumeSerialNumber 和 FileIndex 成员，以确定两个路径是否映射到同一个目标；例如，您可以比较两个文件路径并确定它们是否映射到同一目录。

我不认为这个函数是由 .NET 包装的，所以你必须使用[P/Invoke](http://www.pinvoke.net/default.aspx/kernel32/GetFileInformationByHandle.html)。

它可能适用于网络文件，也可能不适用于网络文件。根据 MSDN：

> 根据操作系统的底层网络组件和连接的服务器类型，GetFileInformationByHandle 函数可能会失败，返回给定文件的部分信息或完整信息。

快速测试表明，它在使用 SMB/Samba 连接的 Linux 系统上使用符号链接按预期工作（相同的值），但是当使用指向同一文件的不同共享访问时，它无法检测到文件是相同的（ FileIndex 相同，但 VolumeSerialNumber 不同）。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-01-04T09:29:29.980

**编辑**：请注意[@Rasmus Faber](https://stackoverflow.com/users/5542/rasmus-faber)在 Win32 api 中提到了[GetFileInformationByHandle](http://msdn.microsoft.com/en-us/library/aa364952(VS.85%29.aspx)函数，这可以满足您的需求，请检查并支持他的[答案](https://stackoverflow.com/questions/410705/best-way-to-determine-if-two-path-reference-to-same-file-in-c#410794)以获取更多信息。

* * *

我认为您需要一个操作系统功能来为您提供所需的信息，否则无论您做什么都会有一些误报。

例如，这些是指同一个文件吗？

*   \server\share\path\filename.txt
*   \server\d$\temp\path\filename.txt

我会检查您的列表中没有重复文件的重要性，然后尽最大努力。

话虽如此，在 Path 类中有一个方法可以做一些工作：[Path.GetFullPath](http://msdn.microsoft.com/en-us/library/system.io.path.getfullpath.aspx)，它至少会根据现有结构将路径扩展为长名称。之后，您只需比较字符串。但它不会是万无一失的，并且在我的示例中不会处理上面的两个链接。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2015-08-04T16:54:23.747

这是`IsSameFile`using的 C# 实现`GetFileInformationByHandle`：

NativeMethods.cs

```
public static class NativeMethods
{
  [StructLayout(LayoutKind.Explicit)]
  public struct BY_HANDLE_FILE_INFORMATION
  {
    [FieldOffset(0)]
    public uint FileAttributes;

    [FieldOffset(4)]
    public FILETIME CreationTime;

    [FieldOffset(12)]
    public FILETIME LastAccessTime;

    [FieldOffset(20)]
    public FILETIME LastWriteTime;

    [FieldOffset(28)]
    public uint VolumeSerialNumber;

    [FieldOffset(32)]
    public uint FileSizeHigh;

    [FieldOffset(36)]
    public uint FileSizeLow;

    [FieldOffset(40)]
    public uint NumberOfLinks;

    [FieldOffset(44)]
    public uint FileIndexHigh;

    [FieldOffset(48)]
    public uint FileIndexLow;
  }

  [DllImport("kernel32.dll", SetLastError = true)]
  public static extern bool GetFileInformationByHandle(SafeFileHandle hFile, out BY_HANDLE_FILE_INFORMATION lpFileInformation);

  [DllImport("kernel32.dll", CharSet = CharSet.Auto, SetLastError = true)]
  public static extern SafeFileHandle CreateFile([MarshalAs(UnmanagedType.LPTStr)] string filename,
    [MarshalAs(UnmanagedType.U4)] FileAccess access,
    [MarshalAs(UnmanagedType.U4)] FileShare share,
    IntPtr securityAttributes,
    [MarshalAs(UnmanagedType.U4)] FileMode creationDisposition,
    [MarshalAs(UnmanagedType.U4)] FileAttributes flagsAndAttributes,
    IntPtr templateFile);
} 
```

PathUtility.cs

```
public static bool IsSameFile(string path1, string path2)
{
  using (SafeFileHandle sfh1 = NativeMethods.CreateFile(path1, FileAccess.Read, FileShare.ReadWrite, 
      IntPtr.Zero, FileMode.Open, 0, IntPtr.Zero))
  {
    if (sfh1.IsInvalid)
      Marshal.ThrowExceptionForHR(Marshal.GetHRForLastWin32Error());

    using (SafeFileHandle sfh2 = NativeMethods.CreateFile(path2, FileAccess.Read, FileShare.ReadWrite,
      IntPtr.Zero, FileMode.Open, 0, IntPtr.Zero))
    {
      if (sfh2.IsInvalid)
        Marshal.ThrowExceptionForHR(Marshal.GetHRForLastWin32Error());

      NativeMethods.BY_HANDLE_FILE_INFORMATION fileInfo1;
      bool result1 = NativeMethods.GetFileInformationByHandle(sfh1, out fileInfo1);
      if (!result1)
        throw new IOException(string.Format("GetFileInformationByHandle has failed on {0}", path1));

      NativeMethods.BY_HANDLE_FILE_INFORMATION fileInfo2;
      bool result2 = NativeMethods.GetFileInformationByHandle(sfh2, out fileInfo2);
      if (!result2)
        throw new IOException(string.Format("GetFileInformationByHandle has failed on {0}", path2));

      return fileInfo1.VolumeSerialNumber == fileInfo2.VolumeSerialNumber
        && fileInfo1.FileIndexHigh == fileInfo2.FileIndexHigh
        && fileInfo1.FileIndexLow == fileInfo2.FileIndexLow;
    }
  }
} 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-01-04T16:31:10.377

答：没有万无一失的方法可以与字符串基本路径进行比较以确定它们是否指向同一个文件。

主要原因是看似不相关的路径可以指向与文件系统重定向（联结、符号链接等）完全相同的文件。例如

"d:\temp\foo.txt" "c:\othertemp\foo.txt"

这些路径可能指向同一个文件。这种情况清楚地消除了任何字符串比较函数作为确定两个路径是否指向同一个文件的基础。

下一个级别是比较操作系统文件信息。打开两个路径的文件并比较句柄信息。在 Windows 中，这可以通过 GetFileInformationByHandle 完成。Lucian Wischik在这里就这个主题 发表了一篇出色[的文章。](http://blogs.msdn.com/vbteam/archive/2008/09/22/to-compare-two-filenames-lucian-wischik.aspx)

但是，这种方法仍然存在问题。仅当执行检查的用户帐户能够打开两个文件进行读取时，它才有效。有许多项目可以阻止用户打开一个或两个文件。包括但不仅限于 ...

*   缺乏足够的归档权限
*   对文件路径中的目录缺乏足够的权限
*   在打开第一个文件和打开第二个文件之间发生的文件系统更改，例如网络断开。

当您开始查看所有这些问题时，您就会开始理解为什么 Windows 不提供确定两条路径是否相同的方法。这不是一个容易/可能回答的问题。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-01-04T09:35:50.747

首先，我认为这很容易，但这**不起作用**：

```
 string fileName1 = @"c:\vobp.log";
  string fileName2 = @"c:\vobp.log".ToUpper();
  FileInfo fileInfo1 = new FileInfo(fileName1);
  FileInfo fileInfo2 = new FileInfo(fileName2);

  if (!fileInfo1.Exists || !fileInfo2.Exists)
  {
    throw new Exception("one of the files does not exist");
  }

  if (fileInfo1.FullName == fileInfo2.FullName)
  {
    MessageBox.Show("equal"); 
  } 
```

也许这个库有助于[http://www.codeplex.com/FileDirectoryPath](http://www.codeplex.com/FileDirectoryPath)。我自己没用过。

**编辑：**请参阅该站点上的此示例：

```
 //
  // Path comparison
  //
  filePathAbsolute1 = new FilePathAbsolute(@"C:/Dir1\\File.txt");
  filePathAbsolute2 = new FilePathAbsolute(@"C:\DIR1\FILE.TXT");
  Debug.Assert(filePathAbsolute1.Equals(filePathAbsolute2));
  Debug.Assert(filePathAbsolute1 == filePathAbsolute2); 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-09-18T18:51:04.870

如果您需要一遍又一遍地比较相同的文件名，我建议您考虑规范化这些名称。

在 Unix 系统下，有一个[realpath()](http://www.kernel.org/doc/man-pages/online/pages/man3/realpath.3.html)函数可以规范您的路径。*我认为如果你有一条复杂*的路径，这通常是最好的选择。但是，它可能会在通过网络连接挂载的卷上失败。

但是，基于 realpath() 方法，如果您想支持多个卷，包括网络卷，您可以编写自己的函数来检查路径中的每个目录名称，如果它引用一个卷，则确定两个路径中的卷引用是否是一样的。话虽这么说，挂载点可能不同（即目标卷上的路径可能不是该卷的根），因此解决所有问题并不容易，但绝对有可能（否则如何它首先会起作用吗？！）

一旦文件名正确规范化，一个简单的字符串比较会给你正确的答案。

如果您不需要一遍又一遍地比较相同的文件名，Rasmus 的回答可能是最快的方法。

* * *

## 回答 #7

> 赞同：-4
> 
> 时间：2009-01-04T09:34:43.137

您始终可以对两者执行 MD5 编码并比较结果。效率不高，但比自己手动比较文件更容易。

这是一篇关于[如何在 C# 中对字符串进行 MD5](http://www.ibt4im.com/?guid=20040923142406)处理的帖子。

# c# - 在 C# 中为 IEnumerable 实现的 F# Seq 模块？

> ID：410717
> 
> 赞同：12
> 
> 时间：2009-01-04T09:15:56.387
> 
> 标签：c#, f#

F# 有一堆标准的序列运算符，我从 Mathematica 的经验中开始了解和喜爱。F#现在引起了我的很多关注，当它普遍发布时，我打算经常使用它。

现在，由于 F# 还没有正式发布，我不能真正在生产代码中使用它。LINQ 使用类似 SQL 的名称实现了其中一些运算符（例如，“select”是“map”，“where”是“filter”），但我找不到“fold”、“iter”或“partition”的实现。

有没有人见过标准序列运算符的任何 C# 实现？这是有人应该写的东西吗？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2009-01-19T18:16:57.813

如果你仔细看，许多 Seq 操作都有 LINQ 等价物，或者可以很容易地派生出来。只看[清单](http://research.microsoft.com/en-us/um/cambridge/projects/fsharp/manual/fsharp.core/Microsoft.FSharp.Collections.Seq.html)...

*   `Seq.append = Concat<TSource>(IEnumerable<TSource> second)`

*   `Seq.concat = SelectMany<IEnumerable<TSource>, TResult>(s => s)`

*   `Seq.distinct_by = GroupBy(keySelector).Select(g => g.First())`

*   `Seq.exists = Any<TSource>(Func<TSource, bool> predicate)`

*   `Seq.mapi = Select<TSource, TResult>(Func<TSource, Int32, TResult> selector)`

*   `Seq.fold = Aggregate<TSource, TAccumulate>(TAccumulate seed, Func<TAccumulate, TSource, TAccumulate> func)`

`List.partition`定义如下：

> 将集合拆分为两个集合，分别包含给定谓词返回的元素`true`和`false`

我们可以使用 GroupBy 和一个二元素数组作为穷人的元组来实现：

```
public static IEnumerable<TSource>[] Partition<TSource>(this IEnumerable<TSource> source, Func<TSource, bool> predicate)
{
    return source.GroupBy(predicate).OrderByDescending(g => g.Key).ToArray();
} 
```

元素 0 保存真实值；1 保存错误值。GroupBy 本质上是类固醇上的分区。

最后，`Seq.iter`轻松`Seq.iteri`映射到 foreach：

```
public static void Iter<TSource>(this IEnumerable<TSource> source, Action<TSource> action)
{
    foreach (var item in source)
        action(item);
}

public static void IterI<TSource>(this IEnumerable<TSource> source, Action<Int32, TSource> action)
{
    int i = 0;
    foreach (var item in source)
        action(i++, item);
} 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-01-04T09:43:01.527

*   折叠 =`Aggregate`

告诉使用什么`iter`和`partition`做什么，我们可能会填补空白。我猜 iter=`SelectMany`和 partition 可能涉及`Skip`/ `Take`？

* * *

（更新）我查找了[分区](http://documents.wolfram.com/mathematica/functions/Partition)- 这是一个粗略的实现，其中一些：

```
using System;
using System.Collections.Generic;
static class Program { // formatted for space
    // usage
    static void Main() {
        int[] data = { 1, 2, 3, 4, 5, 6 };
        var qry = data.Partition(2);

        foreach (var grp in qry) {
            Console.WriteLine("---");
            foreach (var item in grp) {
                Console.WriteLine(item);
            }
        }
    }

    static IEnumerable<IEnumerable<T>> Partition<T>(
            this IEnumerable<T> source, int size) {

        int count = 0;
        T[] group = null; // use arrays as buffer
        foreach (T item in source) {
            if (group == null) group = new T[size];
            group[count++] = item;
            if (count == size) {
                yield return group;
                group = null;
                count = 0;
            }
        }
        if (count > 0) {
            Array.Resize(ref group, count);
            yield return group;
        }
    }
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-17T14:28:16.610

ToLookup 可能更适合 List.partition：

```
IEnumerable<T> sequence = SomeSequence();
ILookup<bool, T> lookup = sequence.ToLookup(x => SomeCondition(x));
IEnumerable<T> trueValues = lookup[true];
IEnumerable<T> falseValues = lookup[false]; 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-04T10:38:32.010

iter exists as a method in the List class which is ForEach

otherwise :

```
public static void iter<T>(this IEnumerable<T> source, Action<T> act) 
        {
            foreach (var item in source)
            {
                act(item);                
            }
        } 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-01-19T18:38:57.347

这是[dahlbyk](/a/458589/97846) `partition`解决方案的更新。

它返回了一个`array[]`where “元素 0 包含真值；1 包含假值”——但是当所有元素都匹配或全部失败谓词时，这并不成立，在这种情况下，你有一个单例数组和一个疼痛。

```
public static Tuple<IEnumerable<T>, IEnumerable<T>> Partition<T>(this IEnumerable<T> source, Func<T, bool> predicate)
{
    var partition = source.GroupBy(predicate);
    IEnumerable<T> matches = partition.FirstOrDefault(g => g.Key) ?? Enumerable.Empty<T>();
    IEnumerable<T> rejects = partition.FirstOrDefault(g => !g.Key) ?? Enumerable.Empty<T>();
    return Tuple.Create(matches, rejects);
} 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-05T12:51:14.300

在 C# 中滚动你自己是一个有趣的练习，这里有一些我的。（另见[此处](https://stackoverflow.com/questions/336775/pipe-forwards-in-c)）

请注意， IEnumerable 上的 iter/foreach 略有争议 - 我认为因为您必须“最终确定”（或任何单词） IEnumerable 才能真正发生任何事情。

```
 //mimic fsharp map function (it's select in c#)
    public static IEnumerable<TResult> Map<T, TResult>(this IEnumerable<T> input, Func<T, TResult> func)
    {
        foreach (T val in input)
            yield return func(val);
    }

    //mimic fsharp mapi function (doens't exist in C#, I think)
    public static IEnumerable<TResult> MapI<T, TResult>(this IEnumerable<T> input, Func<int, T, TResult> func)
    {
        int i = 0;
        foreach (T val in input)
        {
            yield return func(i, val);
            i++;
        }
    }

    //mimic fsharp fold function (it's Aggregate in c#)
    public static TResult Fold<T, TResult>(this IEnumerable<T> input, Func<T, TResult, TResult> func, TResult seed)
    {
        TResult ret = seed;
        foreach (T val in input)
            ret = func(val, ret);
        return ret;
    }

    //mimic fsharp foldi function (doens't exist in C#, I think)
    public static TResult FoldI<T, TResult>(this IEnumerable<T> input, Func<int, T, TResult, TResult> func, TResult seed)
    {
        int i = 0;
        TResult ret = seed;
        foreach (T val in input)
        {
            ret = func(i, val, ret);
            i++;
        }
        return ret;
    }

    //mimic fsharp iter function
    public static void Iter<T>(this IEnumerable<T> input, Action<T> action)
    {
        input.ToList().ForEach(action);
    } 
```

# .net - 为什么存在 NotImplementedException？

> ID：410719
> 
> 赞同：65
> 
> 时间：2009-01-04T09:18:57.130
> 
> 标签：.net, exception, exception-handling, notimplementedexception, notsupportedexception

这真的，真的让我很生气，所以我希望有人能给我一个合理的理由来解释为什么事情是这样的。

**未实现异常。** 你在拉我的腿，对吧？

不，我不会轻描淡写地说：“等一下，该方法已实现 - 它会抛出 NotImplementedException。” 是的，没错，您必须实现抛出 NotImplementedException 的方法（与 C++ 中的纯虚函数调用不同——现在这很有意义！）。虽然这非常有趣，但我的脑海里还有一个更严重的问题。

我只是想知道，在存在 NotImplementedException 的情况下，任何人都可以用 .Net 做任何事情吗？您是否希望使用 try catch 块包装每个抽象方法调用以防止可能未实现的方法？如果你捕捉到这样的异常，你到底应该用它做什么？

我看不到在不调用方法的情况下测试方法是否实际实现的方法。由于调用它可能会产生副作用，因此我无法预先进行所有检查然后运行我的算法。我必须运行我的算法，捕捉 NotImplementedExceptions 和一些如何将我的应用程序回滚到某个理智状态。

这很疯狂。疯狂的。疯狂的。所以问题是： **为什么 NotImplementedException 存在**？

作为先发制人，我不希望任何人回应，“因为设计师需要将其放入自动生成的代码中。” 这太可怕了。我宁愿在您提供实现之前不编译自动生成的代码。例如，自动生成的实现可以是“throw NotImplementedException;” NotImplementedException 未定义的地方！

有没有人捕获并处理过 NotImplementedException？你有没有在你的代码中留下 NotImplementedException ？如果是这样，这是否代表了一个定时炸弹（即，您不小心把它留在了那里），还是一个设计缺陷（该方法不应该被实现并且永远不会被调用）？

我也很怀疑 NotSupportedException ......不支持？什么？如果不支持，为什么它是您界面的一部分？Microsoft 的任何人都可以拼写不正确的继承吗？但是，如果我没有为此受到太多滥用，我可能会为此提出另一个问题。

附加信息：

[这](http://www.lostechies.com/blogs/jimmy_bogard/archive/2008/10/12/notimplementedexception-and-the-interface-segregation-principle.aspx)是有关该主题的有趣读物。

似乎与[Brad Abrams](http://blogs.msdn.com/brada/archive/2004/07/29/201354.aspx)达成了强烈的共识，即“NotImplementedException 适用于尚未实现但确实应该（并且将会）实现的功能。就像您在构建类时可能会*开始*的那样，获取所有方法那里抛出 NotImplementedException，然后用真正的代码将它们清除掉……”

[Jared Parsons](http://blogs.msdn.com/jaredpar/archive/2008/12/12/notimplementedexception-vs-notsupportedexception.aspx)的评论很弱，可能应该被忽略： NotImplementedException：当一个类型由于任何其他原因没有实现方法时抛出这个异常。

[MSDN](http://msdn.microsoft.com/en-us/library/system.notimplementedexception.aspx)在这个主题上甚至更弱，只是声明“当请求的方法或操作未实现时引发的异常”。

* * *

## 回答 #1

> 赞同：142
> 
> 时间：2009-01-04T10:34:43.530

在一种情况下我觉得它很有用：TDD。

我编写测试，然后创建存根以便编译测试。这些存根除了`throw new NotImplementedException();`. 这样测试将默认失败，无论如何。如果我使用了一些虚拟返回值，它可能会产生误报。现在所有测试都编译并失败了，因为没有实现，我解决了那些存根。

因为我从不`NotImplementedException`在任何其他情况下使用 a，所以 no`NotImplementedException`永远不会传递到发布代码，因为它总是会使某些测试失败。

你不需要到处抓它。好的 API 会记录抛出的异常。这些是你应该寻找的。

编辑：我写了一个 FxCop 规则来找到它们。

这是代码：

```
using System;
using Microsoft.FxCop.Sdk;

/// <summary>
/// An FxCop rule to ensure no <see cref="NotImplementedException"/> is
/// left behind on production code.
/// </summary>
internal class DoNotRaiseNotImplementedException : BaseIntrospectionRule
{
    private TypeNode _notImplementedException;
    private Member _currentMember;

    public DoNotRaiseNotImplementedException()
        : base("DoNotRaiseNotImplementedException",
               // The following string must be the assembly name (here
               // Bevonn.CodeAnalysis) followed by a dot and then the
               // metadata file name without the xml extension (here
               // DesignRules). See the note at the end for more details.
               "Bevonn.CodeAnalysis.DesignRules",
               typeof (DoNotRaiseNotImplementedException).Assembly) { }

    public override void BeforeAnalysis()
    {
        base.BeforeAnalysis();
        _notImplementedException = FrameworkAssemblies.Mscorlib.GetType(
            Identifier.For("System"),
            Identifier.For("NotImplementedException"));
    }

    public override ProblemCollection Check(Member member)
    {
        var method = member as Method;
        if (method != null)
        {
            _currentMember = member;
            VisitStatements(method.Body.Statements);
        }
        return Problems;
    }

    public override void VisitThrow(ThrowNode throwInstruction)
    {
        if (throwInstruction.Expression != null &&
            throwInstruction.Expression.Type.IsAssignableTo(_notImplementedException))
        {
            var problem = new Problem(
                GetResolution(),
                throwInstruction.SourceContext,
                _currentMember.Name.Name);
            Problems.Add(problem);
        }
    }
} 
```

这是规则元数据：

```
<?xml version="1.0" encoding="utf-8" ?>
<Rules FriendlyName="Bevonn Design Rules">
  <Rule TypeName="DoNotRaiseNotImplementedException" Category="Bevonn.Design" CheckId="BCA0001">
    <Name>Do not raise NotImplementedException</Name>
    <Description>NotImplementedException should not be used in production code.</Description>
    <Url>http://stackoverflow.com/questions/410719/notimplementedexception-are-they-kidding-me</Url>
    <Resolution>Implement the method or property accessor.</Resolution>
    <MessageLevel Certainty="100">CriticalError</MessageLevel>
    <Email></Email>
    <FixCategories>NonBreaking</FixCategories>
    <Owner></Owner>
  </Rule>
</Rules> 
```

要构建它，您需要：

*   参考`Microsoft.FxCop.Sdk.dll`和`Microsoft.Cci.dll`

*   将元数据放在一个名为的文件中`DesignRules.xml`，并将其作为嵌入式资源添加到您的程序集中

*   命名您的程序集`Bevonn.CodeAnalysis`。如果要对元数据或程序集文件使用不同的名称，请确保将第二个参数相应地更改为基本构造函数。

然后只需将生成的程序集添加到您的 FxCop 规则中，并从您宝贵的代码中删除那些该死的异常。在某些极端情况下，当抛出一个 NotImplementedException 时它不会报告，但我真的认为如果你真的在编写这样的 cthulhian 代码，你是没有希望的。对于正常使用，即`throw new NotImplementedException();`，它可以工作，这就是最重要的。

* * *

## 回答 #2

> 赞同：40
> 
> 时间：2009-01-04T09:32:31.377

它用于支持一个相当常见的用例，一个有效但仅部分完成的 API。假设我想让开发人员测试和评估我的 API -`WashDishes()`至少在我的机器上有效，但我还没有开始编码`DryDishes()`，更不用说`PutAwayDishes()`。与其默默地失败，或者给出一些神秘的错误信息，我可以很清楚为什么`DryDishes()`不起作用——我还没有实现它。

它的姊妹例外`NotSupportedException`主要对提供者模型有意义。很多洗碗机都有烘干功能，所以属于界面，但我的折扣洗碗机不支持。我可以通过`NotSupportedException`

* * *

## 回答 #3

> 赞同：28
> 
> 时间：2009-01-04T12:02:57.563

我将在一个地方总结我对此的看法，因为它们分散在一些评论中：

1.  您用于`NotImplementedException`指示接口成员尚未实现，但将会实现。您将其与自动化单元测试或 QA 测试相结合，以确定仍需要实现的功能。

2.  实现该功能后，您将删除`NotImplementedException`. 为该功能编写了新的单元测试，以确保其正常工作。

3.  `NotSupportedException`通常用于不支持对特定类型没有意义的功能的提供者。在这些情况下，特定类型会抛出异常，客户端会捕获它们并酌情处理它们。

4.  `NotImplementedException`和两者`NotSupportedException`存在于框架中的原因很简单：导致它们的情况很常见，因此在框架中定义它们是有意义的，这样开发人员就不必不断地重新定义它们。此外，它使客户端很容易知道要捕获哪个异常（尤其是在单元测试的上下文中）。如果您必须定义自己的异常，他们必须弄清楚要捕获哪个异常，这至少会适得其反，而且经常是不正确的。

* * *

## 回答 #4

> 赞同：19
> 
> 时间：2009-01-04T09:36:19.297

> 为什么存在 NotImplementedException？

NotImplementedException 是一个很好的方式来说明一些事情还没有准备好。为什么它还没有准备好是方法作者的一个单独问题。在生产代码中你不太可能捕捉到这个异常，但如果你捕捉到了，你可以立即看到发生了什么，这比试图弄清楚为什么调用方法但什么也没发生甚至更糟要好得多——接收一些“临时”结果并得到“有趣”的副作用。

> NotImplementedException 是 Java 的 UnsupportedOperationException 的 C# 等价物吗？

不，.NET 有 NotSupportedException

> 我必须运行我的算法，捕捉 NotImplementedExceptions 和一些如何将我的应用程序回滚到某个理智状态

好的 API 具有描述可能异常的 XML 方法文档。

> 我也很怀疑 NotSupportedException ......不支持？什么？如果不支持，为什么它是您界面的一部分？

可能有数百万个原因。例如，您可以引入新版本的 API 并且不想/不能支持旧方法。同样，最好查看描述性异常，而不是深入研究文档或调试第 3 方代码。

* * *

## 回答 #5

> 赞同：12
> 
> 时间：2009-01-04T09:30:30.430

NotImplementedException 异常的主要用途是在生成的存根代码中：这样您就不会忘记实现它！例如，Visual Studio 将显式实现接口的方法/属性，其中主体抛出 NotImplementedException。

* * *

## 回答 #6

> 赞同：8
> 
> 时间：2009-01-04T09:32:39.723

Re `NotImplementedException`- 这有一些用途；它提供了一个例外，（例如）您的单元测试可以锁定不完整的工作。而且，它确实做到了所说的：这根本不存在（还）。例如，对于 MS 库中存在但尚未编写的方法，“mono”会到处乱扔。

重新`NotSupportedException`- 并非一切都可用。例如，许多接口都支持一对“你能做到吗？” / “做这个”。如果“你能做到吗？” 返回 false，“这样做”抛出 是完全合理的`NotSupportedException`。示例可能是`IBindingList.SupportsSearching`/`IBindingList.Find()`等。

* * *

## 回答 #7

> 赞同：6
> 
> 时间：2009-01-04T09:34:39.843

Microsoft 的大多数开发人员都熟悉适合 NotImplementedException 的设计模式。这实际上相当普遍。

一个很好的例子是[复合模式](http://en.wikipedia.org/wiki/Composite_pattern)，其中许多对象可以被视为一个对象的单个实例。组件用作（正确）继承的叶类的基本抽象类。例如，文件和目录类可能继承自同一个抽象基类，因为它们是非常相似的类型。这样，它们可以被视为单个对象（当您考虑文件和目录是什么时，这是有道理的——例如，在 Unix 中，一切都是文件）。

所以在这个例子中，Directory 类会有一个 GetFiles() 方法，但是 File 类不会实现这个方法，因为这样做没有意义。相反，您会得到一个 NotImplementedException ，因为 File 不像 Directory 那样有子级。

请注意，这不仅限于 .NET - 您会在许多 OO 语言和平台中遇到这种模式。

* * *

## 回答 #8

> 赞同：5
> 
> 时间：2009-01-04T10:39:27.110

为什么你觉得有必要捕捉每一个可能的异常？你是否也包装了每个方法调用`catch (NullReferenceException ex)`？

存根代码抛出`NotImplementedException`是一个占位符，如果它让它释放它应该是错误，就像`NullReferenceException`.

* * *

## 回答 #9

> 赞同：5
> 
> 时间：2009-01-04T12:00:32.170

我认为 MS 在框架中添加 NotImplementedException 的原因有很多：

*   为方便起见；既然许多开发人员在开发过程中都会需要它，为什么每个人都必须自己动手呢？
*   这样工具就可以依赖它的存在；例如，Visual Studio 的“实现接口”命令生成抛出 NotImplementedException 的方法存根。如果它不在框架中，这是不可能的，或者至少相当尴尬（例如，它可能会生成在您添加自己的 NotImplementedException 之前无法编译的代码）
*   鼓励一致的“标准做法”

Frankodwyer 将 NotImplementedException 视为潜在的定时炸弹。我会说任何未完成的代码都是定时炸弹，但 NotImplementedException 比替代方案更容易解除。例如，您可以让构建服务器扫描该类的所有用途的源代码，并将它们报告为警告。如果你想真正禁止它，你甚至可以在你的源代码控制系统中添加一个预提交钩子，以防止签入此类代码。

当然，如果您推出自己的 NotImplementedException，您可以将其从最终构建中移除，以确保不留下任何定时炸弹。但这只有在您在整个团队中始终如一地使用自己的实现时才有效，并且您必须确保在发布之前不要忘记将其删除。此外，您可能会发现无法删除它；也许有一些可接受的用途，例如测试未交付给客户的代码。

* * *

## 回答 #10

> 赞同：5
> 
> 时间：2009-01-04T23:15:04.557

实际上没有理由实际*捕获*NotImplementedException。当被击中时，它应该会杀死你的应用程序，并且这样做非常痛苦。修复它的唯一方法不是捕获它，而是更改源代码（实现被调用方法或更改调用代码）。

* * *

## 回答 #11

> 赞同：4
> 
> 时间：2010-01-13T23:35:26.253

两个原因：

1.  方法在开发过程中被存根，并抛出异常以提醒开发人员他们的代码编写尚未完成。

2.  实现一个子类接口，按照设计，它不实现继承的基类或接口的一个或多个方法。（有些接口太笼统了。）

* * *

## 回答 #12

> 赞同：3
> 
> 时间：2009-01-04T10:24:50.273

对我来说，这听起来像是一个潜在的雷区。在遥远的过去，我曾经在一个遗留网络系统上工作，该系统已经连续运行多年，一天就崩溃了。当我们追查问题时，我们发现一些代码显然还没有完成并且永远不会工作 - 从字面上看，就像程序员在编码过程中被打断了一样。很明显，这个特定的代码路径以前从未被采用过。

墨菲定律说类似的事情只是乞求在 NotImplementedException 的情况下发生。在 TDD 等的这些日子里，它应该在发布之前被拾起，至少你可以在发布之前为那个异常进行 grep 代码，但仍然如此。

在测试时，很难保证覆盖所有情况，这听起来会使您的工作变得更加困难，因为运行时问题可能是编译时问题。（我认为类似的“技术债务”伴随着严重依赖“鸭子打字”的系统，虽然我承认它们非常有用）。

* * *

## 回答 #13

> 赞同：3
> 
> 时间：2009-01-05T15:53:19.643

COM 互操作需要此异常。[它是 E_NOTIMPL](http://blogs.msdn.com/jaredpar/archive/2008/12/12/notimplementedexception-vs-notsupportedexception.aspx)。链接的博客还显示了其他原因

* * *

## 回答 #14

> 赞同：3
> 
> 时间：2010-01-13T22:59:36.403

抛出`NotImplementedException`是 IDE 生成编译存根代码的最合乎逻辑的方式。就像你扩展接口并让 Visual Studio 为你存根一样。

如果你做了一点 C++/COM，那也存在，除了它被称为`E_NOTIMPL`.

它有一个有效的用例。如果您正在处理接口的特定方法，您希望您的代码能够编译，以便您可以调试和测试它。根据您的逻辑，您需要从接口中删除该方法并注释掉非编译存根代码。这是一种非常原教旨主义的方法，虽然它有优点，但并不是每个人都会或应该坚持这一点。此外，大多数时候您希望界面是完整的。

拥有 NotImplementedException 可以很好地识别哪些方法尚未准备好，归根结底，很容易`Ctrl+Shift+F`找到它们，我也确信静态代码分析工具也会选择它。

您不打算发布有`NotImplementedException`异常的代码。如果您认为不使用它可以使您的代码变得更好，请继续前进，但是您可以做更多富有成效的事情来提高源代码质量。

* * *

## 回答 #15

> 赞同：2
> 
> 时间：2009-01-04T11:29:11.830

**未实现异常**

当请求的方法或操作未实现时抛出异常。

将此作为 .NET 核心中定义的单个异常可以更轻松地找到和消除它们。如果每个开发人员都应该创建自己的开发人员`ACME.EmaNymton.NotImplementedException`，那么很难找到所有开发人员。

**不支持异常**

当调用的方法不受支持时，将引发异常。

例如，当尝试读取、查找或写入不支持调用功能的流时。

例如生成的迭代器（使用`yield`关键字） is-a `IEnumerator`，但`IEnumerator.Reset`方法 throws `NotSupportedException`。

* * *

## 回答 #16

> 赞同：2
> 
> 时间：2009-07-30T15:39:34.187

从 ECMA-335，CLI 规范，特别是 CLI 库类型，System.NotImplementedException，备注部分：

“本标准其他地方指定的许多类型和构造对于仅符合内核配置文件的 CLI 实现不是必需的。例如，浮点功能集由浮点数据类型 System.Single 和System.Double。如果实现中省略了对这些的支持，则任何引用包含浮点数据类型的签名的尝试都会导致 System.NotImplementedException 类型的异常。

因此，该例外适用于仅实现最低一致性配置文件的实现。最低要求的配置文件是内核配置文件（参见 ECMA-335 第 4 版 - 第 IV 部分，第 3 节），其中包括 BCL，这就是为什么异常包含在“核心 API”中，而不是其他位置的原因。

使用异常来表示存根方法，或者设计人员生成的方法缺乏实现是误解了异常的意图。

至于为什么此信息未包含在 MS 的 CLI 实现的 MSDN 文档中，我无法理解。

* * *

## 回答 #17

> 赞同：2
> 
> 时间：2010-01-13T22:46:13.550

我不能保证 NotImplementedException（我基本同意你的观点），但我在工作中使用的核心库中广泛使用了 NotSupportedException。例如，DatabaseController 允许您创建任何受支持类型的数据库，然后在整个代码的其余部分中使用 DatabaseController 类，而无需过多关心下面的数据库类型。相当基本的东西，对吧？NotSupportedException 派上用场的地方（如果不存在，我会使用我自己的实现）是两个主要实例：

1) 将应用程序迁移到不同的数据库 人们通常认为这种情况很少发生或不需要。胡说八道。多出去走走。

2) 相同的数据库，不同的驱动程序 最近的例子是当一个使用 Access 支持的应用程序的客户端从 WinXP 升级到 Win7 x64 时。由于没有 64 位 JET 驱动程序，他们的 IT 人员安装了 AccessDatabaseEngine。当我们的应用程序崩溃时，我们可以很容易地从日志中看到它是 DB.Connect 崩溃并出现 NotSupportedException - 我们很快就能够解决这个问题。另一个最近的例子是我们的一个程序员试图在 Access 数据库上使用事务。尽管 Access 支持事务，但我们的库不支持 Access 事务（出于本文范围之外的原因）。NotSupportedException，现在是你大放异彩的时候了！

3) 通用函数我想不出一个简洁的“经验”示例，但如果您考虑类似向电子邮件添加附件的函数，您希望它能够获取一些常见文件，如 JPEG，从各种流类派生的任何东西，以及几乎任何具有“.ToString”方法的东西。对于后一部分，您当然不能考虑所有可能的类型，因此您将其设为通用。当用户传递 OurCrazyDataTypeForContainingProprietarySpreadsheetData 时，使用反射来测试是否存在 ToString 方法并返回 NotSupportedException 以指示不支持不支持 ToString 的所述数据类型。

NotSupportedException 绝不是一个关键功能，但我发现自己在处理大型项目时使用得更多。

* * *

## 回答 #18

> 赞同：2
> 
> 时间：2011-08-23T08:03:04.430

假设您的生产代码中有这种方法

```
public void DoSomething() 
```

如果你想让它稍后完成，你会拿哪一个？

```
public void DoSomething()
{
} 
```

或者

```
public void DoSomething()
{
    throw new NotImplementedException();
} 
```

我当然会选择第二个。再加上 Elmah 或您拥有的任何错误记录机制（作为整个应用程序的一个方面实现）。与日志/异常过滤一起，在被捕获时触发严重错误电子邮件通知。

NotImplementedException == unfinished 的论点也不正确。(1) 捕获未实现的方法应该留给单元测试/集成测试。如果你有 100% 的覆盖率（你现在应该这样做，有这么多模拟/存根/代码生成工具）没有 NotImplementedException，你担心什么？(2) 代码生成。简单明了。同样，如果我生成代码，并且只使用生成的代码的一半，为什么在生成的存根的其余部分中没有 NotImplementedException？

这就像说代码不应该编译，除非每个可为空的输入都应该检查/处理是否为空。（AKA 万亿美元的错误，如果不是更多的话）。语言应该是灵活的，而测试/合同应该是可靠的。

* * *

## 回答 #19

> 赞同：1
> 
> 时间：2009-01-04T09:35:13.277

NotImplementedException 为 .NET 的某些方法引发（请参阅代码 DOM 中未实现的解析器 C#，但该方法存在！）您可以使用此方法 Microsoft.CSharp.CSharpCodeProvider.Parse 进行验证

* * *

## 回答 #20

> 赞同：1
> 
> 时间：2009-01-04T10:38:40.323

我很少将它用于接口修复。假设您有一个需要遵守的接口，但某些方法永远不会被任何人调用，所以只需坚持一个 NotImplementedException，如果有人调用它，他们就会知道他们做错了什么。

* * *

## 回答 #21

> 赞同：1
> 
> 时间：2009-01-04T15:24:46.690

它们都是针对两个常见问题的技巧。

NotImplementedException 是一种解决方法，适用于架构宇航员并喜欢先写下 API，然后再编写代码的开发人员。显然，由于这不是一个增量过程，因此您无法一次全部实现，因此您想通过抛出 NotImplementedException 来假装您已经完成了一半。

NotSupportedException 是对 C# 和 Java 等类型系统限制的一种破解。在这些类型系统中，如果 Rectangle 继承了所有 Shapes 特征（包括成员函数 + 变量），则您说 Rectangle 是一个 Shape。然而，在实践中，情况并非如此。例如，Square 是 Rectangle，但 Square 是 Rectangle 的限制，而不是概括。

因此，当您想要继承和限制父类的行为时，您可以在对限制没有意义的方法上抛出 NotSupported。

* * *

## 回答 #22

> 赞同：0
> 
> 时间：2009-01-04T09:24:33.173

原型或未完成的项目呢？

我认为使用异常并不是一个非常糟糕的主意（尽管在这种情况下我使用了消息框）。

* * *

## 回答 #23

> 赞同：0
> 
> 时间：2009-01-04T09:38:32.787

嗯，我有点同意。如果一个接口的制作方式并非所有类都可以实现它的所有部分，那么我认为它应该被分解。

如果 IList 可以或不能被修改，它应该被分解成两个，一个用于不可修改的部分（getter、lookup 等），一个用于可修改的部分（setter、add、remove 等）。

* * *

## 回答 #24

> 赞同：0
> 
> 时间：2009-01-04T11:05:51.703

我的代码中有一些 NotImplementedExceptions。通常它来自接口或抽象类的一部分。我觉得我将来可能需要一些方法，它们作为课程的一部分是有意义的，但我只是不想花时间添加，除非我真的需要它。例如，我为游戏中的所有单独类型的统计数据提供了一个界面。其中一种是 ModStat，它是基本属性加上所有修饰符（即武器、盔甲、法术）的总和。我的 stat 接口有一个 OnChanged 事件，但我的 ModStat 通过计算它每次调用时引用的所有统计信息的总和来工作。因此，每次统计数据更改时都会引发大量 ModStat.OnChange 事件的开销，如果有人尝试添加/删除 OnChange 的侦听器，我只会抛出 NotImplementedException。

.NET 语言都是关于生产力的，那么为什么要花时间编写一些你甚至不会使用的东西呢？

* * *

## 回答 #25

> 赞同：0
> 
> 时间：2009-01-04T14:46:44.583

这是一个例子：在Java中，每当你实现接口时`Iterator`，你必须重写明显的方法`hasNext()`和`next()`，但也有`delete()`。在我拥有的 99% 的用例中，我不需要这个，所以我只是抛出一个`NotImplementedException`. 这比默默地什么都不做要好得多。

* * *

## 回答 #26

> 赞同：0
> 
> 时间：2010-12-15T07:29:11.530

NotImplementedException 的存在只是为了促进开发。想象一下，您开始实现一个接口。您希望至少能够在完成一种方法的实现后进行构建，然后再进行下一种方法。*使用 NotImplementedExceptions 对 NotImplemented 方法进行存根是一种很好的方式来处理未完成的代码，以后非常容易发现它。否则，您将冒着快速实施某些您可能忘记修复的风险。*

* * *

## 回答 #27

> 赞同：-1
> 
> 时间：2010-06-25T14:22:41.857

如果您不想使用它，请忽略它。如果你有一个代码块，它的成功取决于它的每一部分是否成功，但它可能会在两者之间失败，那么你唯一的选择是捕获基础`Exception`并回滚需要回滚的内容。忘了`NotImplementedException`。可能会抛出大量异常，例如`MyRandomException`and`GtfoException`和`OmgLolException`。在您最初编写代码后，我可以从您正在调用的 API 中抛出另一个异常类型。编写代码时不存在的一种。处理你知道如何处理的那些，并为任何其他人回滚，即`catch(Exception)`. 这很简单，我想......我发现它也很方便。尤其是当您尝试使用偶尔会强迫您做一些事情的语言/框架来做一些花哨的事情时。

我的一个例子是序列化。我在我的 .NET 库中添加了数据库中不存在的属性（例如，对现有“哑”属性的方便包装，例如`FullName`组合`FirstName`、`MiddleName`和的属性`LastName`）。然后我想将这些数据类型序列化为 XML 以通过网络发送它们（例如，从 ASP.NET 应用程序发送到 JavaScript），但序列化框架仅使用`get`和`set`访问器序列化公共属性。我不希望你能够设置`FullName`，因为那样我必须解析它，并且可能有一些我错误地解析的不可预见的格式并且数据完整性超出了窗口。只使用底层属性更容易，但由于语言和 API 要求我有一个`set`访问器，我会抛出一个`NotImplementedException`（直到我阅读这个线程我才知道`NotSupportedException`，但任何一个都有效），这样如果某个程序员在路上确实尝试设置`FullName`，他会在测试期间遇到异常并意识到他的错误。

# mfc - 我可以使用 MFC 更改窗口边框的粗细吗？

> ID：410720
> 
> 赞同：4
> 
> 时间：2009-01-04T09:21:33.740
> 
> 标签：mfc, border, thickness

通常，一个窗口的厚度为 4 个像素，可以通过 GetSystemMetrics 方法获取。我可以更改它的值，例如 2 个像素吗？

非常感谢！

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-01-04T09:35:30.780

简单的回答：不。不适用于特定的窗口。

复杂的答案：边框是作为窗口“非客户端”区域的一部分绘制的。这一切都由默认处理（即 DefWindowProc）以及标题、最小化、最大化按钮等（在后台）处理。您可以通过处理 WM_NCPAINT 消息来覆盖它。然后，您将负责绘制窗口的整个非客户区。您还需要处理 WM_NCCALCSIZE 消息，以便 Windows 知道有多少剩余空间可以分配给您的客户区。

或者，您可以将窗口的边框样式设置为无。这将允许 Windows 为您绘制标题，尽管看起来可能会略有不同。不幸的是，这样做会失去拖动调整大小的功能。为此，您需要处理 WM_NCHITTEST 消息。

# c# - C# 中的私有 const 和私有只读变量之间有区别吗？

> ID：410723
> 
> 赞同：34
> 
> 时间：2009-01-04T09:24:03.500
> 
> 标签：c#, constants, readonly

`private const`在 C# 中具有变量或变量之间是否有区别`private static readonly`（除了必须分配`const`编译时表达式）？

由于它们都是私有的，因此没有与其他库的链接。那么它会有什么不同吗？例如，它可以产生性能差异吗？实习字符串？有什么类似的吗？

* * *

## 回答 #1

> 赞同：34
> 
> 时间：2009-01-04T09:37:56.920

好吧，您可以在属性中使用 const，因为它们作为编译时存在。您无法预测静态只读变量的值，因为`.cctor`可以从配置等初始化它。

在使用方面，常量被烧录到调用代码中。这意味着如果您重新编译*库*dll 以更改**公共**常量，但不更改消费者，那么消费者仍将使用原始值。使用只读变量不会发生这种情况。与此相反的是，常量（非常非常轻微）更快，因为它只是加载值（而不是必须取消引用它）。

重新实习；尽管您可以手动执行此操作，但这通常是文字的编译器/运行时功能；如果您通过文字初始化只读字段：

```
someField = "abc"; 
```

然后`"abc"`将被拘留。如果您从配置中读取它，则不会。因为常量字符串必须是文字，它也将被实习，但访问方式不同：再次，从字段中读取是取消引用，而不是[`ldstr`](http://msdn.microsoft.com/en-us/library/system.reflection.emit.opcodes.ldstr.aspx).

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2009-01-04T10:09:31.007

确实，这两种类型在初始化后就无法更改，但是它们之间还是有一些区别的：

*   'const' 必须在声明它们的地方初始化（在编译时），而 'readonly' 可以在声明它的地方或在构造函数内部（ar 运行时）初始化。

例如 const 可以在这种情况下使用：

```
public class MathValues
{
  public const double PI = 3.14159;
} 
```

对于这种情况， readonly 会更好：

```
public class Person
{
    public readonly DateTime birthDate;

    public Person(DateTime birthDate)
    {
        this.birthDate = birthDate;
    }
} 
```

或者

```
public class Person
{
    public readonly DateTime birthDate = new DateTime(1986, 1, 24);
} 
```

*   'const' 是静态的，因此它在该类的所有实例之间共享并且可以直接访问（如 MathValues.PI），而 'readonly' 不是静态的。因此，像 'static const' 这样的声明是非法的，因为 const 是静态的，但 'static readonly' 是合法的

*   'const' 只能包含整数类型（sbyte、byte、short、ushort、int、uint、long、ulong、char、float、double、decimal、bool 或 string）、枚举或对 null 的引用（不是类或结构，因为它们是在运行时使用'new'关键字初始化的），而'readonly'可以保存复杂的类型、结构或类（通过在初始化时使用new关键字）但不能保存枚举

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-01-04T09:31:27.807

关于常量需要注意的是它们实际上存储在您的可执行文件中，因此声明其中的大量常量*会*增加您的可执行文件大小。

通常，这不是一个大问题，但我的一个朋友在公司工作，该公司强制执行“一切都必须是 const”规则并设法显着增加其编译的可执行文件大小。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2009-01-04T14:31:31.117

*以下是 C# .NET const*、*readonly*和*static readonly*字段之间的区别（来自[这篇文章](http://rabdullin.com/journal/2008/10/22/const-vs-readonly-vs-static-readonly-in-c-net.html)）。

**常数**：

*   默认为静态
*   必须有编译时值（即：你可以有“A”+“B”但不能有方法调用）
*   可用于属性
*   被复制到使用它们的每个程序集中（每个程序集都获得值的本地副本）
*   可以在函数中声明

**只读实例字段**：

*   在创建实例时进行评估
*   必须在构造函数退出时设置值

**静态只读字段**：

*   在代码执行命中类引用时进行评估（即：创建新实例或执行静态方法）
*   必须在静态构造函数完成时评估值
*   您真的不想将 ThreadStaticAttribute 放在这些上（因为静态构造函数将仅在一个线程中执行，并且它将为其线程设置值；所有其他线程都将具有未初始化的此值）

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2014-12-15T12:54:48.587

C#.Net 中的**const**和**readonly**字段之间存在显着差异

const 默认是静态的，需要用常量值初始化，以后不能修改。构造函数中也不允许更改值。它不能用于所有数据类型。对于前日期时间。它不能与 DateTime 数据类型一起使用。

```
public const DateTime dt = DateTime.Today;  //throws compilation error
public const string Name = string.Empty;    //throws compilation error
public readonly string Name = string.Empty; //No error, legal 
```

readonly 可以声明为静态的，但不是必需的。声明时无需初始化。可以使用构造函数分配或更改其值。因此，它在用作实例类成员时具有优势。两个不同的实例化可能具有不同的只读字段值。对于前 -

```
class A
{
    public readonly int Id;

    public A(int i)
    {
        Id = i;
    }
} 
```

然后可以使用即时特定值初始化只读字段，如下所示：

```
A objOne = new A(5);
A objTwo = new A(10); 
```

在这里，实例 objOne 的只读字段值为 5，而 objTwo 的值为 10。使用 const 是不可能的。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-01-04T09:28:46.783

正在使用？并不真地。Consts 在编译时评估，而 readonly 在运行时评估。您还可以在构造函数中为只读变量赋值。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-04-16T12:45:03.167

还有一件事。我在上面的评论中没有看到这一点，尽管我可能错过了。您不能创建常量数组。

```
private const int[] values = new int[] { 1, 2, 3 }; 
```

但是您*可以*使用静态只读字段创建它。

```
private static readonly int[] values = new int[] { 1, 2, 3 }; 
```

因此，如果您需要一个数组常量，例如允许值的列表，并且枚举不合适，那么静态只读是唯一的方法。例如，如果数组是可为空的整数，如下所示：

```
private static readonly int?[] values = new int?[] { null, 1, 2, 3 }; 
```

不能用常数做到*这一点，可以吗？*

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-04-03T08:55:47.213

不同之处在于静态只读字段的值是在运行时设置的，因此可以由包含类修改，而 const 字段的值设置为编译时常量。

在静态只读情况下，只允许包含类修改它

在变量声明中（通过变量初始值设定项） 在静态构造函数中（实例构造函数，如果它不是静态的） 如果在 const 声明中不允许字段的类型，或者当值未知时，通常使用静态只读编译时间。

也允许实例只读字段。

请记住，对于引用类型，在两种情况下（静态和实例），只读修饰符只会阻止您为该字段分配新引用。它特别不会使引用指向的对象不可变。

```
class Program

{

  public static readonly Test test = new Test();

  static void Main(string[] args)

  {

     test.Name = "Program";

     test = new Test(); // Error: A static readonly field cannot be assigned to (except in a static constructor or a variable initializer)

  }

}

class Test

{

   public string Name;

} 
```

* * *

不同之处在于包含类可以修改静态只读，但永远不能修改 const，必须将其初始化为编译时常量。为了稍微扩展静态只读情况，包含类只能修改它：

-- 在变量声明中（通过变量初始化器）。

-- 在静态构造函数中（实例构造函数，如果它不是静态的）。

* * *

**C# .NET 中的 const 关键字**

示例：`public const string abc = “xyz”;` 仅在声明时初始化。值在编译时评估，不能在运行时更改。尝试更改它会导致编译错误。Const 已经是一种静态的了。由于类和结构是在运行时使用 new 关键字初始化的，因此您不能为类或结构设置常量。但是，它必须是整数类型之一。C# .NET 中的只读关键字

示例：`public readonly string abc;` 可以在声明代码或构造函数代码中初始化。在运行时评估值。可以声明为静态或实例级属性。只读字段可以通过在运行时使用 new 关键字来保存复杂对象。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-01-04T10:10:39.413

只读字段可以在*声明*或类的*构造函数*中初始化。因此，只读字段**可以有不同的值，具体取决于使用的构造函数**。

只读成员也可**用于运行时常**量，如下例所示：

```
public static readonly uint currentTicks = (uint)DateTime.Now.Ticks; 
```

只读字段*不是*隐式静态的，因此如果需要，**静态关键字**可以（必须）显式应用于只读字段。这对于隐式静态的 const 字段是不允许的。

只读成员可以通过*在初始化时使用 new 关键字*来保存复杂对象。

# castle-windsor - 使用 Castle Windsor 注入多个服务实现

> ID：410739
> 
> 赞同：9
> 
> 时间：2009-01-04T09:33:39.987
> 
> 标签：castle-windsor

我想让 Windsor 将服务的多个实现注入到构造函数中。

我的场景是我有多个实现通用接口的搜索提供程序。我想用 windsor 注册每个这些，然后将它们注入我的搜索服务，以便它可以依次查询每个。

温莎可以做到这一点吗？有没有比将多个实现注入构造函数更好的方法？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-01-04T09:39:33.127

请参阅DotNetSlackers[上的 Castle Windsor 容器的控制反转和依赖注入 - 第二部分](http://dotnetslackers.com/articles/designpatterns/InversionOfControlAndDependencyInjectionWithCastleWindsorContainerPart2.aspx)。它展示了如何将相同服务接口的数组传递给对象。

# svn - 解决svn二进制冲突

> ID：410749
> 
> 赞同：5
> 
> 时间：2009-01-04T09:38:17.683
> 
> 标签：svn, conflict

我将 svn 用于我与其他几个开发人员合作的项目。Svn 可以很好地用于源代码控制，但是当我们提交 dll 时，我们总是会遇到冲突。

当我这样做时，我解决了冲突（由于 diff 程序无法处理二进制文件而删除了我的 dll），然后必须重新构建才能提交。你打算如何解决这样的冲突？

编辑：

dll 位于单独的 svn 文件夹中，因为该项目是一个游戏模组，非程序员需要访问最新版本。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-01-04T09:45:37.653

如果它是您正在构建的 DLL（而不是您没有源代码的外部），那么源代码应该在源代码控制中，而不是二进制文件。

如果您不想将其包含在该特定存储库中，则可以将其包含为 svn:external。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-01-04T09:50:45.803

正如此处的其他答案所述：您不应该首先对生成的 dll 进行版本控制。但是，如果您真的**必须**对它们进行版本控制，那么您可以在不使用删除 dll 文件的 diff 工具的情况下解决冲突：

对于每个冲突的文件，Subversion 会在你的工作副本中放置三个额外的未版本控制的文件：

文件名.mine

这是您在更新工作副本之前存在于工作副本中的文件，即没有冲突标记。该文件仅包含您的最新更改。（如果 Subversion 认为该文件不可合并，则不会创建 .mine 文件，因为它与工作文件相同。）

文件名.rOLDREV

这是更新工作副本之前的基本修订文件。也就是说，您在进行最新编辑之前签出的文件。

文件名.rNEWREV

这是您的 Subversion 客户端在您更新工作副本时刚刚从服务器收到的文件。此文件对应于存储库的 HEAD 修订版。

这里 OLDREV 是 .svn 目录中文件的修订号，NEWREV 是存储库 HEAD 的修订号。

现在，要解决此类冲突，请删除您不想要的其他文件：

*   如果您想保留自己的 dll，请删除文件 filename.rOLDREV、filename.rNEWREV
*   如果要保留存储库中的 dll，请删除文件 filename.rOLDREV 和 filename.mine，然后将 filename.rNEWREV 复制到文件名

之后，执行

```
svn resolved filename 
```

告诉 Subversion 你自己解决了冲突。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-01-04T09:41:47.787

通常，您根本不会将自己编译的 DLL 存储在源代码管理中。您是否有特定的理由需要这样做？

我设置了我的开发环境，以便任何人都可以独立于其他人构建我的任何项目组件。这样，我的源代码控制系统中唯一的东西就是我的*源*代码。这有很多好处：

*   在尝试签入 DLL 或 EXE 时避免二进制文件冲突
*   源代码控制系统跟踪的数据量要小得多，速度更快
*   当开发人员总是构建自己的 DLL 时，他们可以合理地确定他们拥有的源代码与编译后的文件相匹配。如果您使用的是其他人构建的东西，那么您永远无法确定。

正如评论中提到的，将第三方 DLL 存储在您的源代码控制系统中是完全合理的，特别是如果您实际上没有它们的源代码。我还参与过一些项目，我们`.tar.gz`在源代码控制中为各种开源库存储分发文件（等），然后拥有一个完整的`Makefile`s系统，将*这些*库构建为 build-everything 目标的一部分。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2018-10-17T13:30:45.890

对于二进制文件，大多数时候，您希望接受它的任一版本。例如，如果所讨论的文件是一个可执行工具，那么通常一个版本可能比另一个版本新，而这可能就是您想要使用的那个。

要接受您要合并的分支中的版本，请使用：

```
svn resolve --accept=theirs-full path/to/filename 
```

要接受以前在当前分支中的版本，请使用：

```
svn resolve --accept=mine-full path/to/filename 
```

有时，SVN 会拒绝使用`theirs-full`并发出警告：

`svn: warning: W195024: Inapplicable conflict resolution option given for conflicted path`

因为SVN在合并方面是一团糟。在这种情况下，您必须像在接受的答案[https://stackoverflow.com/a/410767/2279059](https://stackoverflow.com/a/410767/2279059)中那样手动复制文件，而不是使用适用于您要执行的操作的命令行选项。如果您知道这两个文件是相同的（但由于已经说明的原因，SVN 仍将它们标记为冲突），您也可以使用

```
svn resolve --accept=working path/to/filename 
```

虽然在相同文件的情况下，这实际上与所有其他命令相同，但 SVN 不会怯懦地拒绝执行它。这有意义吗？不，它没有。处理它。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-01-04T10:18:51.487

在版本控制中也有二进制文件是合理的：

*   它避免了只使用二进制文件的人重建的麻烦。

*   当您发布时，二进制文件已确定。

为了完成这项工作，二进制文件需要始终与源相对应。因此，如果您已合并源，则需要从中重建二进制文件，从合并版本中选择一个二进制文件是行不通的。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-04T10:17:58.087

确保您的 dll 将`svn:mime-type`属性设置为`application/octet-stream`或其他一些非文本类型。

```
svn propget *.dll
svn propset svn:mime-type application/octet-stream *.dll 
```

当冲突发生时，您仍然必须实际*解决冲突。*

并检查文档的[文件内容类型](http://svnbook.red-bean.com/en/1.5/svn.advanced.props.file-portability.html#svn.advanced.props.special.mime-type)章节。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2017-08-16T09:44:47.367

因此，如果您将 *.dlls 放在单独的文件夹中，则更容易执行以下操作：

1.  直接在您构建更改之前更新您的 *.dll 文件夹，如果您相信您的同事只提交可编译的源代码，最好也更新您的源代码。（如果发生冲突（此时您的错是什么，因为您在更新到最新版本之前更改了某些内容））
2.  做你的构建。
3.  直接提交结果。

或者：

不要构建到目录中的路径，构建到外部的某个地方，直到您对结果感到满意为止。

然后进行如下操作：

1.  更新您的 dlls 文件夹的工作副本（如果有任何冲突是您的错，并通过“保留他们的”来解决冲突）
2.  将您的工作 .dll 复制到工作副本
3.  通知你的同事你将提交一个新的修订（你可以放弃这一步）
4.  如果有任何冲突，请提交您的工作，这应该是他们的错。

你现在有两种可能：

5a。你是一个非常可恨的人，并通过保留我的来解决问题。

5b。您按照应有的工作方式工作...阅读日志文件并找出在您需要将工作复制到文件夹并按下提交的短时间内还提交了谁。和那个同事谈谈。同意进一步的行动方案。

# mercurial - 是否可以在线浏览 OpenJDK 的源码？

> ID：410756
> 
> 赞同：84
> 
> 时间：2009-01-04T09:41:23.917
> 
> 标签：mercurial, openjdk

是否可以像浏览 SourceForge 的项目一样在线浏览 OpenJDK 的源代码？我以前从未使用过 Mercury，所以我感到很困惑。

（注：我不想下载源码，只是想上网浏览一下，看看有些方法是怎么实现的。）

* * *

## 回答 #1

> 赞同：98
> 
> 时间：2009-01-04T10:05:31.497

OpenJDK 现在在 GitHub 上：[https ://github.com/openjdk/jdk](https://github.com/openjdk/jdk)

这是一个大型项目，但您会在[jdk/src/java.base/share/](https://github.com/openjdk/jdk/blob/master/src/java.base/share/classes) classes 下找到核心类的实现。

例如，您可以在[此处找到](https://github.com/openjdk/jdk/blob/master/src/java.base/share/classes/java/util/List.java)[实现`java.util.List`](https://github.com/openjdk/jdk/blob/master/src/java.base/share/classes/java/util/List.java)。

* * *

如果您需要浏览旧版本，您仍然需要使用[旧的 Mercurial 界面](http://hg.openjdk.java.net/)。

如果您不习惯，那里的 Mercurial 界面会非常混乱，而且由于这是一个大型项目，因此很难找到您要查找的内容。

这是一个例子：

要查找 JDK6 实现`java.util.List`，请选择`jdk6`, `jdk`，然后选择浏览。然后浏览到`src/share/classes/java/util/List.java`。

你应该最终在[http://hg.openjdk.java.net/jdk6/jdk6/jdk/file/tip/src/share/classes/java/util/List.java](http://hg.openjdk.java.net/jdk6/jdk6/jdk/file/tip/src/share/classes/java/util/List.java)

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2013-07-20T12:25:09.313

最新的**JDK 8** OpenJDK *Java 类库*源代码可以在这里找到：http: [//hg.openjdk.java.net/jdk8u/jdk8u/jdk/file/tip/src/share/classes/](http://hg.openjdk.java.net/jdk8u/jdk8u/jdk/file/tip/src/share/classes/)

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2016-03-18T08:13:18.000

这是获取**最新**或**任何已发布版本**（`Openjdk 8`或任何现有 java 版本）源代码的基本步骤，并在`Eclipse`.

**步骤**：

*   ***[浏览源码]***
*   jdk 的打开 url，例如[http://hg.openjdk.java.net/jdk8u/jdk8u/jdk/](http://hg.openjdk.java.net/jdk8u/jdk8u/jdk/)
*   点击`tags`
*   选择合适的标签，例如`jdk8u73-b02`
*   然后点击`browse`,
*   然后浏览到文件夹`src/share/classes`，
*   ***[下载源]***
*   然后单击`bz2`/ `zip`/之一`gz`，以下载相关压缩格式的源，（*例如对于`jdk8u73-b02`格式`zip`，URL将为：[http ://hg.openjdk.java.net/jdk8u/jdk8u/jdk/archive/2ab13901d6f1.zip/ src/share/classes/](http://hg.openjdk.java.net/jdk8u/jdk8u/jdk/archive/2ab13901d6f1.zip/src/share/classes/)* )
*   ***[在日食中使用]***
*   解压它，
*   压缩文件夹“classes/”，将“classes/”作为 .zip 文件的根目录，（例如 first `cd jdk-2ab13901d6f1/src/share/`，then `zip -r openjdk_8u73_b2_src.zip classes/`）
*   将创建的 zip 文件移动到适当的位置，它会在那里停留一段时间，（例如`mv openjdk_8u73_b2_src.zip /media/Eric/software/java/jdk/openjdk/openjdk8u73-b02/source/`）
*   在eclipse中，为已安装jre的jar指定源文件，可以分别为已安装jre的每个jar指定源附件，最常见的jar大概是`rt.jar`，
*   可选地，可能需要刷新项目以使其完全生效，不确定是否有必要，
*   测试一下：在eclipse中`ctrl + shift + t`，，然后输入`Cancellable`，选择`sun.nio.fs.Cancellable`对应安装的jre的，如果有源代码就可以了，因为这个源在中没有`jdk_home/src.zip`，必须是从附加的openjdk源，
*   切换回源：可以切换回使用“jdk_home/src.zip”，如果不想使用外部openjdk源，
*   行

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2009-01-04T09:48:38.380

这是一种浏览存储库并只查看您想要的位的方法。 [http://hg.openjdk.java.net/](http://hg.openjdk.java.net/) 这就是你要问的吗？

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2013-09-12T22:40:27.773

将“/file”附加到根 URL 以查看浏览器，如下所示：

*   [http://hg.openjdk.java.net/jdk7/jdk7/jdk/file/](http://hg.openjdk.java.net/jdk7/jdk7/jdk/file/)
*   [http://hg.openjdk.java.net/jdk7/jdk7/hotspot/file](http://hg.openjdk.java.net/jdk7/jdk7/hotspot/file)

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2014-09-16T17:04:47.363

**Grepcode.com**非常适合类似的事情 - 不仅是 OpenJDK 源代码，还可以直接在突出显示的代码中搜索类/方法和类之间的链接：

[http://grepcode.com/file/repository.grepcode.com/java/root/jdk/openjdk/8-b132/java/net/Socket.java](http://grepcode.com/file/repository.grepcode.com/java/root/jdk/openjdk/8-b132/java/net/Socket.java)

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2019-04-20T14:10:06.857

如其他答案中所述，源代码存储库位于[https://hg.openjdk.java.net](https://hg.openjdk.java.net)

但是，OpenJDK 团队镜像了 GitHub 上的一些项目：[https ://github.com/openjdk](https://github.com/openjdk)

包括最新的Java版本[项目](https://github.com/openjdk/jdk)（[https://hg.openjdk.java.net/jdk/jdk）：https://github.com/openjdk/jdk](https://hg.openjdk.java.net/jdk/jdk)

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2018-07-27T20:42:49.467

当然[http://hg.openjdk.java.net](http://hg.openjdk.java.net)是一个不错的选择。另一个同样好的来源是[zGrepCode](https://zgrepcode.com/) [https://zgrepcode.com/java/openjdk/](https://zgrepcode.com/java/openjdk/)。它有 Open JDK 和 Oracle java 版本。

# gcc - Code Sourcery GCC vs Vanilla GCC Compiler，有什么区别？

> ID：410771
> 
> 赞同：1
> 
> 时间：2009-01-04T09:57:50.873
> 
> 标签：gcc

我找到了一家为 ARM、MIPS 提供基于 GCC 的工具链的公司，但我不知道它们与普通 GCC 有什么不同，当然，它们带来了其他软件，例如 Eclipse，但只看 GCC 和Binutils，它们是不同的还是一样的？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-01-04T10:44:31.717

预编译工具链（如[Code Sourcery](http://www.codesourcery.com/)、[MontaVista](http://www.mvista.com/)、[Wind River](http://www.windriver.com/)等提供的工具链）和从源代码构建的工具链之间的一大区别是方便。从头开始构建工具链，尤其是用于交叉编译的目的，是乏味的，并且可能是一个完全的痛苦。此外，最新版本的[glibc](http://www.gnu.org/software/libc/)（或[uClibc](http://www.uclibc.org/)）、[gcc](http://gcc.gnu.org/)和[binutils](http://www.gnu.org/software/binutils/)并不总是兼容，因为它们是独立开发的。有一些开源工具可以让这个过程更容易（比如[crosstool-NG](http://ymorin.is-a-geek.org/dokuwiki/projects/crosstool))，但是拥有针对特定平台优化的经过验证的工具链可以节省大量时间和麻烦。在新项目开始时尤其如此。当事情变得棘手时，获得技术支持也很有帮助。当然……你大部分时间都必须为此付出代价。

话虽如此，编译您自己的工具链很可能会为您节省资金，并且可以在以后提供更大的灵活性。据我所知，MontaVista 在其最新的工具链版本中不包括对旧平台的支持。例如，如果您购买了 MontaVista Pro 4.X，并且它包含一个带有 gcc 3.3.X 的工具链，那么这就是您在项目的整个生命周期中最有可能被卡住的工具链。很可能不会选择使用 gcc 4.X 升级到工具链。

希望有帮助。

# spam-prevention - 在网页上进行基本视图跟踪的最佳方法是什么？

> ID：410785
> 
> 赞同：1
> 
> 时间：2009-01-04T10:12:43.123
> 
> 标签：spam-prevention, usagepatterns

我有一个面向网络、可匿名访问的博客目录和博客，我想跟踪每篇博客文章收到的浏览量。

我想让这个尽可能简单，准确度只需要一个近似值。这不适用于分析（我们有谷歌），我不想做任何日志分析来提取统计数据，因为在这种环境中运行后台任务很棘手，我希望数字尽可能新鲜。

我目前的解决方案如下：

1.  一个 Web 控件，它只是在表中为每个 GET 记录一个视图。
2.  使用正则表达式和 UserAgent 字符串排除已知网络爬虫列表
3.  规定排除某些 IP 地址（已知的垃圾邮件发送者）
4.  提供锁定一些帖子（当垃圾邮件发送者来找它时）

这实际上似乎做得很好，但有几件事让我烦恼。垃圾邮件发送者仍然点击一些帖子，从而扭曲了观点。我仍然必须手动监控视图以更新我的“坏”IP 地址列表。

有人对我有更好的建议吗？有人知道如何跟踪 StackOverflow 问题的观点吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-04T01:52:42.457

听起来您当前的解决方案实际上相当不错。

我们实现了一个，其中传递视图内容的服务器代码还更新了一个数据库表，该表存储了 URL（实际上是 URL 的特殊 ID 代码，因为 URL 可能会随着时间而改变）和视图计数。

这实际上是针对具有其他人可以评论的用户撰写帖子的系统，但它同样适用于您是唯一创建帖子的用户的情况（如果我正确理解您的描述）。

我们必须执行以下操作来最小化（不幸的是，不是消除）偏斜。

*   对于已登录的用户，每个用户只能在帖子中添加一个观点。曾经。没有例外。
*   对于匿名用户，每个 IP 地址每个月只能为帖子添加一个观点。这稍微不太可靠，因为从我们的角度来看，IP 地址可以“共享”（NAT 等）。我们放宽上述“EVER”要求的原因就是出于这个共享的原因。
*   帖子本身仅限于每个时间段添加一个观点（该时间段开始时间较短（例如 10 秒）并逐渐增加（例如 5 分钟），因此新帖子由于其新颖性而可以更快地获得观看次数）。这解决了大多数垃圾邮件机器人，因为我们发现它们往往会在帖子创建后很长时间内进行攻击。
*   删除帖子上的垃圾评论，或尝试绕过验证码失败（见下文），会自动将该 IP 添加到黑名单并减少该帖子的查看次数。
*   如果列入黑名单的 IP 在 N 天（可配置）内未尝试发表评论，则会将其从黑名单中删除。这条规则和之前的规则，最大限度地减少了维护黑名单的人工干预，我们只需要监控垃圾邮件内容的响应。
*   验证码。这解决了我们的*很多*垃圾邮件问题，特别是因为我们不仅仅依赖于 OCR 类型的东西（比如“这个词是什么 -> '可选'”）；我们实际上提出了一些问题（比如“2 乘以 8 的一半是多少？ ”），它打破了愚蠢的字符识别机器人。它不会击败成群的廉价劳动力 CAPTCHA 破解者（除非他们的数学真的很糟糕 :-) 但无 CAPTCHA 的改进令人印象深刻。
*   登录用户不受验证码的约束，但垃圾邮件立即删除了该帐户，将 IP 列入黑名单，并从帖子中减去他们的视图。
*   我很惭愧地承认我们实际上并没有打折网络爬虫（我希望客户没有阅读此内容:-)。老实说，由于我们的 IP 地址规则，他们每个月可能只会添加最少数量的视点（除非他们用多个 IP 地址蜂拥而至）。

所以基本上，我建议以下作为可能的改进。当然，您应该始终监控他们如何去查看他们是否在工作。

*   验证码。
*   根据用户行为自动更新黑名单。
*   限制视图计数从相同的 IP 地址增加。
*   限制视图计数增加到一定的速率。

您选择的任何方案都不会是完美的（例如，我们的一个月规则），但只要所有帖子都遵循相同的规则集，您仍然可以获得很好的比较价值。正如你所说，准确度只需要一个近似值。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-04T01:53:42.813

建议：

1.  将点击计数逻辑从用户控件移动到基​​ Page 类。
2.  将排除列表重新设计为可动态更新（即，将其存储在数据库中，甚至存储在 xml 文件中）
3.  记录所有点击。定期让 cron 作业运行新命中并确定它们是包含还是排除。如果您对每个命中进行排除，则每个用户都必须等待匹配逻辑发生。
4.  想出一些算法来自动检测垃圾邮件发送者/机器人并将它们添加到您的黑名单中。和/或订阅第 3 方黑名单。

# c# - 避免数组重复

> ID：410787
> 
> 赞同：2
> 
> 时间：2009-01-04T10:14:12.667
> 
> 标签：c#, performance, arrays, memory-leaks, memory-management

根据 [MSDN：阵列使用指南]（[http://msdn.microsoft.com/en-us/library/k2604h5s(VS.71).aspx）](http://msdn.microsoft.com/en-us/library/k2604h5s(VS.71).aspx))：

数组值属性

> 您应该使用集合来避免代码效率低下。在以下代码示例中，每次调用 myObj 属性都会创建一个数组副本。结果，将在以下循环中创建数组的 2n+1 个副本。

```
[Visual Basic]

Dim i As Integer
For i = 0 To obj.myObj.Count - 1
   DoSomething(obj.myObj(i))
Next i

[C#]
for (int i = 0; i < obj.myObj.Count; i++)
      DoSomething(obj.myObj[i]); 
```

除了从 myObj[] 更改为 ICollection myObj 之外，您还有什么推荐的？刚刚意识到我当前的应用程序正在泄漏内存:(

谢谢;

编辑：强制 C# 传递带 ref 的引用（安全除外）会提高性能和/或内存使用吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-01-04T10:16:23.350

不，它没有**泄漏**内存——它只是让垃圾收集器比它可能更努力地工作。实际上，MSDN 文章有点误导：如果属性在每次调用时都创建一个新**集合**，那么它与数组一样糟糕（内存方面）。可能更糟糕的是，由于大多数集合实现通常过大。

如果您知道方法/属性确实有效，则始终可以最小化调用次数：

```
var arr = obj.myObj; // var since I don't know the type!
for (int i = 0; i < arr.Length; i++) {
  DoSomething(arr[i]);
} 
```

甚至更简单，使用`foreach`：

```
foreach(var value in obj.myObj) {
  DoSomething(value);
} 
```

两种方法都只调用一次该属性。第二个是更清晰的IMO。

其他想法; 将其命名为方法！ie `obj.SomeMethod()`- 这设定了它确实有效的期望，并避免了不受欢迎`obj.Foo != obj.Foo`的情况（数组就是这种情况）。

最后，Eric Lippert 有[一篇关于这个主题的好文章](http://blogs.msdn.com/ericlippert/archive/2008/09/22/arrays-considered-somewhat-harmful.aspx)。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-04T12:38:15.107

就像对那些没有使用某些答案中提到的 ReadOnlyCollection 的人的提示：

```
[C#]

class XY
{
  private X[] array;

  public ReadOnlyCollection<X> myObj
  {
    get
    {
      return Array.AsReadOnly(array);
    }
  }
} 
```

希望这可能会有所帮助。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-04T10:35:45.493

每当我拥有昂贵的属性（例如在调用时重新创建集合）时，我要么记录属性，说明每次调用都会产生成本，要么将值缓存为私有字段。昂贵的属性 getter 应该写成方法。通常，我尝试将集合公开为 IEnumerable 而不是数组，从而迫使消费者使用 foreach（或枚举器）。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-04T10:47:35.127

除非您这样做，否则它不会复制数组。然而，简单地将引用传递给对象私有的数组会有一些讨厌的副作用。接收到引用的人基本上可以自由地对数组做任何他喜欢的事情，包括以无法由其所有者控制的方式更改内容。

防止未经授权干预数组的一种方法是返回内容的副本。另一个（稍微好一点）是返回一个只读集合。

尽管如此，在做任何这些事情之前，你应该问问自己是否要泄露太多信息。在某些情况下（实际上，很多时候），最好将数组保持私有，而是让提供对拥有它的对象进行操作的方法。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-04T10:56:00.133

myobj 不会创建新项目，除非您明确创建一个。所以为了更好地使用内存，我建议使用私有集合（列表或任何）并公开索引器，它将从私有集合中返回指定的值

# sql - 大型数据库的优化技术

> ID：410796
> 
> 赞同：2
> 
> 时间：2009-01-04T10:28:03.637
> 
> 标签：sql, performance, optimization

您在超大型数据库上使用了哪些优化技术？如果我们的估计是正确的，我们的应用程序将有数十亿条记录存储在数据库中（MS SQL Server 2005），其中大部分是用于统计的日志。数据包含数字（主要是整数）和文本（错误消息文本、URL）等。

我对任何类型的提示、技巧、解决方案感兴趣。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-01-04T10:37:50.077

这个问题有点模糊，但这里有一些提示：

*   为您的数据库使用适当的硬件。我也会选择 64 位操作系统。
*   为数据库配备专用机器。使用为获得最佳性能而配置的快速磁盘。您可以跨越的磁盘越多，性能就越好。
*   针对将要执行的查询类型优化数据库。更多 SELECT 或 INSERT 会发生什么？
*   负载会持续一整天，还是只持续几个小时？你能推迟一些要在晚上运行的事情吗？
*   有增量备份。
*   如果您考虑使用 Oracle 而不是 SQL Server，则可以使用网格和表分区等功能，这可能会大大提高性能。
*   考虑在数据库服务器之间使用一些负载平衡解决方案。
*   预先设计方案和表，以便尽可能快地执行查询。还要考虑适当的索引。

您将不得不更具体地了解存储这些日志的方式。它们是数据库中的 LOB 吗？简单的文本记录？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-04T10:37:51.853

我自己不使用它，但我读过可以将 Hadoop 与 hbase 结合使用来进行分布式存储和分布式数据分析，例如日志。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-04T14:06:20.593

[邓肯的](https://stackoverflow.com/questions/410796/optimization-techniques-for-large-databases#410806)链接有一套很好的提示。这里还有一些提示：

如果您不需要查询完全最新的数据（即，如果可以接受截至最后一小时或昨天营业结束的数据），请考虑为分析构建一个单独的数据集市。这使您可以针对快速分析查询进行优化。

SQL Server 查询优化器有一个星形转换运算符。如果查询优化器识别出这种类型的查询，它可以通过在接触事实表之前基于维度表进行过滤来选择您想要的数据切片。这减少了查询所需的 I/O 量。

对于涉及大型表扫描的 VLDB 应用程序，请考虑使用尽可能多的控制器而不是 SAN 的直接附加存储。您可以更便宜地获得更多带宽。但是，如果您的数据集小于（例如）1TB 左右，它可能不会产生很大的不同。

如果您在查询访问中具有引用的局部性，则具有大量 RAM 的 64 位服务器非常适合缓存。但是，表扫描没有参考位置，因此一旦它变得比服务器上的 RAM 大得多，额外的内存就没有多大帮助。

如果您对事实表进行分区，请考虑将每个分区放在单独的磁盘阵列上 - 如果您有带有端口复制的 SAS 阵列，则至少是一个单独的 SAS 或 SCSI 通道。请注意，只有在您经常跨多个分区进行查询时，这才会有所作为。

# asp.net-mvc - ASP.Net MVC 和 N 层

> ID：410797
> 
> 赞同：4
> 
> 时间：2009-01-04T10:32:29.400
> 
> 标签：asp.net-mvc, nhibernate, data-structures, n-tier-architecture, presentation-layer

问候，

提前道歉，我没有认真研究这个问题来自己回答这个问题，但我想这需要一些时间，我宁愿现在知道，然后再投入更多时间来学习它。我在最初的研究中找不到任何东西..

如果您已经在使用多层架构（数据层、逻辑层、表示层），为什么还要使用 ASP.Net MVC？除了控制器比逻辑层拥有更多权力之外。

我是否认为我可以在 MVC 的模型部分中使用 nHibernate 和我的所有数据访问类、实体和映射？

使用控制器时，是否最好将大量逻辑分离到一个单独的类中，以便我可以从多个控制器中调用它？或者我可以从控制器本身调用它们，考虑到我不希望它们都是动作，只是普通方法。

谢谢

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-01-04T11:05:20.783

MVC 并不是要取代 N-Tier，它是一种组织表现层的方式。

我不会说控制器比逻辑层更强大。相反，控制器（作为表示层的一部分）仍应调用逻辑层。

控制器应该只为视图准备数据并处理来自视图的操作。你仍然应该使用你的 BLL。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-04T12:17:27.770

> 是的，NHibernate 实体可以（并且应该）被传递给视图。

这会给你带来一些麻烦。您应该使用扁平的、空安全的 DTO，也就是视图模型。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-04T12:57:12.230

Damien，您可能想阅读以下 2 篇文章：

[胖控制器](http://codebetter.com/blogs/ian_cooper/archive/2008/12/03/the-fat-controller.aspx)

[ASP.NET MVC 框架的架构视图](http://dotnetslackers.com/articles/aspnet/AnArchitecturalViewOfTheASPNETMVCFramework.aspx)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2010-03-29T22:41:22.443

N 层是一种**架构模式**，可实现应用程序关键区域的重用、关注点分离和可扩展性。非 UI 层（业务、数据、外观等）应该进行单元测试并且与 UI 无关。

UI 层只是这些层之一，它可以是 Silverlight、ASP.NET MVC、Web 表单等。

与 MVP 一样，MVC 是一种**设计模式**，可以更好地测试 UI 层。ASP.Net MVC 是一个开箱即用的框架，支持并强制执行此模式。该模式早在此框架之前就已被使用。

但这只是一个 UI 层的选择，控制器中不应该与数据库、服务等交互，它们使用模型控制视图的状态，不应该控制业务逻辑、持久性、事务等。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-04T14:36:08.473

如果您已经使用多层，要回答您为什么要使用的问题是，它可以使 URL 更有条理且对搜索引擎友好。此外，与 ASP.Net 中的其他模式相比，它更像是一种标准模式。这使得它对那些已经在其他平台上使用 MVC 的开发人员更加友好。

# apache - 网址中带有空格的 mod_rewrite

> ID：410811
> 
> 赞同：37
> 
> 时间：2009-01-04T10:42:39.397
> 
> 标签：apache, url, mod-rewrite

我需要设置一些 RewriteRules 来重定向其中有空格的 URL。我试过这个：

```
RewriteRule ^article/with%20spaces.html$ /article/without_spaces.html [R=301,L] 
```

...但它不起作用。放入空格而不是 %20 会导致 500 内部服务器错误。如何添加空间？

* * *

## 回答 #1

> 赞同：57
> 
> 时间：2009-01-04T10:45:40.980

尝试在你的空间前面放一个 \ 来逃避它。

```
RewriteRule ^article/with\ spaces.html$ /article/without_spaces.html [R=301,L] 
```

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2009-01-04T10:46:09.093

您可以使用 \ 来逃避空间

```
RewriteRule ^article/with\ spaces.html$ /article/without_spaces.html [R=301,L] 
```

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2013-01-14T16:15:07.503

如果您想避免转义每个空格的复杂性（例如，如果您计划自动生成此文件），您可以简单地使用引号：

```
RewriteRule "^article/with spaces.html$" /article/without_spaces.html [R=301,L] 
```

此外，这些引号可用于包含任何一个预期的参数：

```
RewriteRule "^article/with spaces.html$" "/article/without_spaces.html" [R=301,L] 
```

* * *

## 回答 #4

> 赞同：9
> 
> 时间：2012-04-29T17:44:28.553

```
RewriteRule ^article/with[\ |%2520]spaces.html$ /article/without_spaces.html [R=301,L] 
```

第一个选项替换空格，而第二个选项替换 url 中硬编码的 %20。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-01-04T10:45:07.550

啊，我找到了解决方案：使用正则表达式样式显示空格：

```
RewriteRule ^article/with\sspaces.html$ ... 
```

虽然，我怀疑这也会匹配所有其他空白字符（制表符等），但我认为这不会有太大问题。

# javascript - 用 JS 调整 jquery UI 对话框的大小？

> ID：410819
> 
> 赞同：12
> 
> 时间：2009-01-04T10:49:23.203
> 
> 标签：javascript, jquery-ui, modal-dialog, jquery-ui-dialog

`autoResize`如果在最新的分支中能按预期工作会更好，但到那时问题很简单：**一旦创建对话框，如何调整它的大小？**

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2009-01-04T14:04:46.977

来自 Soviut 的答案对于为每个插件`v1.5\. 1.6`添加一个方法是正确的：`option`

```
$(document).ready(function(){
    var d = $("#example").dialog();
    d.dialog("option", "width", 700);
}); 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-08-14T13:17:11.167

```
$('#dialog').dialog().animate({width: "700px"}, 400); 
```

我用它来动态调整对话框的大小。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-04T11:47:32.790

所有 JQuery UI 插件都可以使用 .data() 更新其属性：

```
$(document).ready(function(){
    var d = $("#example").dialog();
    d.data("width.dialog", 700);
}); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-01T09:19:04.560

但是对话框的内容（.ui-dialog-content）不跟风。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2010-01-19T18:31:53.897

我喜欢在创建对话框时根据内容调整大小，所以我使用它：

```
var dlg = $("#dialog");
dlg.dialog( {
    width: 600,
    height: dlg.height() + 100
    }); 
```

# .net - 如何为我的网站制作像“Digg it”这样的按钮？

> ID：410820
> 
> 赞同：2
> 
> 时间：2009-01-04T10:49:49.507
> 
> 标签：.net, javascript, web-services

我有一个博客站点托管在 Windows Sever、ASP.Net 3.5、ASP.Net AJAX、后台 SQL Server 上。

我想给博主一个像“digg-it”这样的按钮，他们可以把它放在他们的博客上，如果他们喜欢的话，读者可以点击来点赞这篇文章。

我知道我将使用 Javascript 来做到这一点。我能做些什么：-

1.  从我的网站检索代码，该代码将显示当前点赞数。
2.  如果用户竖起大拇指，请增加我网站上的计数。

由于这些博客大部分都在 blogger.com/wordpress.com 上，因此插件代码将嵌入博客主题中。我想我将使用博客文章的 URL 作为唯一 ID。我的问题是如何让我的网站和 blogger.com 上的 javascript 说话。

您的帮助将不胜感激。

谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-04T10:59:10.110

您可以考虑使用 SCRIPT 回调加载 JSON 数据，而不是使用 XmlHttpRequest 来解决跨域问题。

```
function dynScript(url){
    var script=document.createElement('script');
    script.src=url;
    script.type="text/javascript";
    document.getElementsByTagName('head')[0].appendChild(script);
}
function handleYourData(json) {
    // Do something with your response data if you need to, like alter
    // dom.
}
function thumbUp(postId) {
    dynScript('http://yourdomain.com/path/to/thumbHandler?callback=handleYourData&thumbs=up&postId=' + postId);
}
function thumbDown(postId) {
    dynScript('http://yourdomain.com/path/to/thumbHandler?callback=handleYourData&thumbs=down&postId=' + postId);
} 
```

您可以在 HTML 中像这样使用它。

```
<a onClick="thumbUp(521);">Thumb up</a> | <a onClick="thumbDown(521);">Thumb Down</a> 
```

您的`thumbHandler`代码必须输出带有`handleYourData()`包裹的 JSON，以便使用 JSON 数据作为参数调用您的回调。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-05T15:16:49.357

好的，我得到了一个答案，当我尝试这种方法时，我发现了一些更简单的方法。

我要使用的是 iframe。iframe 就像浏览器中的浏览器窗口。我在 iframe 中呈现的代码将在内部访问我的网站，就好像它是一个常规的网页请求一样。所以我可以使用我的 Web 服务、我的后台 ASP.Net 代码以及我想要的一切，而不必担心会弄乱主机网站。

当我完成开发时，我会在这里发布一些代码。同时，如果你们知道这种方法的任何陷阱，请告诉我。

这是我编写的一些示例 iframe 代码

```
<script type="text/javascript">
    window.onload = function() {
        alert("http://mysite.com?url=" + window.location.href);
        document.all.blogvaniframe.src = "http://blogvani.com";
    }
</script>
<iframe id="blogvaniframe" height="100" width="100" scrolling="no" frameborder="0">

</iframe> 
```

我正在使用 javascript 加载 iframe 中的内容，因为我想将参数传递给 url 的查询字符串（虽然还没有测试过。

谢谢

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-05T15:20:17.027

试试这个。我在雅虎上找到它！搜索，因为我知道，这个脚本有一个德语版本：

英文版： http: [//www.socialbookmarkscript.com/](http://www.socialbookmarkscript.com/)

德语脚本： http: [//www.social-bookmark-script.de/](http://www.social-bookmark-script.de/)

祝你好运！

# ruby-on-rails - 我使用 Ruby on Rails 会招致什么（如果有的话）技术债务？

> ID：410822
> 
> 赞同：2
> 
> 时间：2009-01-04T10:54:39.667
> 
> 标签：ruby-on-rails, technical-debt

我是 ruby​​ on rails 的忠实粉丝，它似乎融合了许多 Web 应用程序编程技术的“最热门”。在我看来，约定优于配置尤其是一个巨大的胜利。

然而，我也有一种感觉，我得到的一些便利是以需要在未来偿还的[技术债务为代价的。](http://en.wikipedia.org/wiki/Technical_debt)并不是我认为 ROR 又快又脏，因为我认为它在许多情况下包含了许多最佳实践和良好的默认选项。然而，在我看来，这还没有涵盖一些东西（特别是框架中几乎没有对安全性的直接支持，而且我看到的插件质量参差不齐）。

我不是在这里寻找宗教观点或激战，但我很想知道社区对 Rails 需要改进的领域的看法，和/或 Rails 用户需要自己注意的事情，因为框架不会牵着他们的手引导他们做正确的事。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-04T11:02:23.130

无论框架如何，程序员都需要知道她在做什么。我想说，使用像 Ruby on Rails 这样成熟、设计良好和广泛适用的东西来构建安全的 Web 应用程序比不使用框架支持要容易得多。

注意插件并了解它们是如何工作的（再次了解您的工作）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-04T11:47:21.463

我也喜欢 Rails，但了解我们使用的框架的缺点对我们很重要。尽管解决这些问题可能是一个广泛的话题，但不会伤害任何人。

除了安全问题，另一个大问题是在共享主机上部署。PHP 在共享托管环境中蓬勃发展，但 Rails 仍然落后。

当然，大多数专业的 Rails 开发人员都知道他们的应用程序需要经过微调的服务器用于生产，他们显然会部署在特定于 Rails 的主机上。

为了让 Rails 继续成功，核心团队应该解决这个问题，尤其是随着 Rails 3.0 (Merb +Rails) 的到来。

一个简单的例子：我有一个 bluehost 帐户，我注意到我的 cpanel 中有 Rails 图标。我与 bluehost 支持人员进行了交谈，他们说它或多或少是一个虚拟图标，并且无法正常运行。

话虽如此，任何想要部署 Rails 应用程序的专业人士都不会使用 bluehost。，但它确实伤害了 Rails，当主机说他们支持它然后用户遇到他们的支持一无所知的问题时..

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-04T12:20:12.180

您引用的文章将技术债务定义为

> [the] 邋遢的软件架构和仓促的软件开发的最终后果

使用 Rails，任何非测试驱动的开发都会招致技术债务。但任何平台都是如此。

在架构层面，Rails 提供了一些部署挑战。繁忙的站点必须使用大量硬件进行扩展或使用智能缓存策略。

我对任何适应 Rails 的人的建议是：

*   使用 TDD 进行所有开发
*   通过阅读其测试来验证您使用的任何插件的质量。如果它们不清晰和完整，请避免使用插件
*   阅读“Rails Recipes”和“Advanced Rails Recipes”（Advanced Rails Recipes 有一个很好的方法可以以 RESTful 方式添加身份验证）
*   准备好支付硬件来扩展您的站点（硬件比开发时间便宜）

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-04T12:51:19.153

根据我的经验，到目前为止，您最终为 RoR 支付的最大费用是：

*   相当大的默认堆栈（不包括您可能正在使用的插件）
*   更新模型往往是一件让人头疼的事情，至少在生产服务器中是这样。
*   更新 Rails 或 Ruby 本身比它应该的要复杂一些，但这取决于您的服务器设置。
*   正如 ewalshe 所提到的，部署有时是一种拖累，而且如果您需要它，那么扩展会变得有点不确定，就像大多数开发框架一样。

话虽如此，对于某些项目，我是 RoR 的狂热用户，并且根据硬件的实际状态，即使您最终为使用它付出了一些技术债务，它几乎可以忽略不计。人们可以希望这些问题最终会得到审查并得到解决。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-06T04:55:11.250

对于任何级别的抽象，您都会付出一些代价 - 泛型方法不如那些专门为您的目的而构建的方法那么快。不过幸运的是，您可以进行更改。不喜欢动态查找方法产生的查询计划？自己写，好走。

上面有人说得好-硬件比开发人员便宜。我会添加“以足够低的硬件数量”

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-12-09T04:04:40.767

我正在阅读[Deploying Rails Applications](http://www.pragprog.com/titles/fr_deploy/deploying-rails-applications)并强烈推荐它来回答您的问题。

这本书充满了使生活更轻松的建议，从头开始采用部署感知方法进行 Rails 开发，而不是将其留到以后。

我不认为选择 RoR 意味着技术债务，但仅阅读前几章就提醒我应该遵循的做法，特别是在共享主机上，例如*冻结核心 Rails 宝石*，这样你就不会被升级打断在主机上。

关于共享主机的 30 页一章包括内存引用提示，例如使用多个帐户（如果可能），每个帐户一个 Rails 应用程序。它还警告诸如 RMagick 之类的流行库可能会将您的内存大小推到您的进程被终止的程度（例如 100MB 限制，它建议某些主机定期应用）。

# c++ - 工厂方法实现 - C++

> ID：410823
> 
> 赞同：3
> 
> 时间：2009-01-04T10:55:44.377
> 
> 标签：c++, templates, design-patterns, factory

我有以下用于“工厂”设计模式实现的代码。

```
class Pen{
public:
     virtual void Draw() = 0;
};

class RedPen : public Pen{
public:
     virtual void Draw(){
         cout << "Drawing with red pen" << endl;
     }
};

class BluePen : public Pen{
public:
     virtual void Draw(){
         cout << "Drawing with blue pen" << endl;
     }
};

auto_ptr<Pen> createPen(const std::string color){
     if(color == "red")
         return auto_ptr<Pen>(new RedPen);
     else if(color == "blue")
         return auto_ptr<Pen>(new BluePen);
} 
```

但我听说可以使用“C++ 模板”以更好的方式完成。任何人都可以帮助它如何完成以及模板方法比这更好吗？

有什么想法吗

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-02-10T21:57:08.910

*另一种方法是将创建者*函数动态注册到动态工厂对象。

```
BluePen *create_BluePen() { return new BluePen; }
static bool BluePen_creator_registered = 
                       Factory::instance()->registerCreator("BluePen", 
                                                            create_BluePen); 
```

这样做的一个有趣效果是静态 bool 变量`BluePen-creator-registered`将在`main()`开始之前设置，从而使注册自动化。

这些行有时是通过普通宏制作的，即

```
#define METAIMPL( _name ) \
_name *create_ ## _name() { return new _name; } \
static bool _name ## _creator_registered = \
                        Factory::instance()->registerCreator(# _name, \
                                                             create_ ## _name) 
```

...并在构造函数附近使用

```
METAIMPL( BluePen ); // auto registers to the Factory

BluePen::BluePen() : Pen() {
   // something
} 
```

然后工厂的任务将是存储和查找这些*创建者*函数。我把剩下的留作*练习*；）即使用 METADECL 宏

如果您想了解更多信息，请参阅第*4.1*章元信息下的[此处](http://www.pervasive.jku.at/Research/Publications/_Documents/DesignPatternsProcessAutomationSystemsPhD-narzt2000.pdf)，其中还包括一种扩展方法以包括*检查*器功能的可能性

 **我从使用[ET++](http://www.ubilab.org/publications/wei94.html)中学到了这一点，这是一个将旧 MacApp 移植到 C++ 和 X11 的项目。在此过程中，Eric Gamma 等人开始考虑*设计模式*

并且...（2011 年 5 月 7 日）终于来推一个例子到 github
[https://github.com/epatel/cpp-factory](https://github.com/epatel/cpp-factory)

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-01-25T23:03:25.353

你的工厂很好。我认为它`BluePen`等等只是示例类名。如果满足以下条件，您可以使用模板：

> 当您在编译时（即编写代码时）知道要返回特定类型时，请使用模板。否则，你不能。

这意味着在代码中，您可以这样做：

```
template<typename PenType>
auto_ptr<Pen> createPen(){
    return auto_ptr<Pen>(new PenType);
} 
```

有了它，你就可以像这样使用它了

```
...
auto_ptr<Pen> p = createPen<BluePen>();
... 
```

但是该模板参数 ,`BluePen`不能是在运行时设置为类型的变量。在您的示例中，您传递了一个字符串，该字符串当然可以在运行时设置。因此，当您阅读到可以使用 C++ 模板时，该建议仅在条件下为真 - 然后，当您决定创建哪支笔时，已经在编译时完成。如果该条件适合，那么模板解决方案就是*正确*的做法。它在运行时不会花费您任何费用，并且正是您所需要的。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-01-04T11:34:37.730

在您发布的示例中，工厂或模板方法对我来说都没有意义。我的解决方案涉及 Pen 类中的数据成员。

```
class Pen {
public:
    Pen() : m_color(0,0,0,0) /* the default colour is black */
    {            
    }

    Pen(const Color& c) : m_color(c)
    {
    }

    Pen(const Pen& other) : m_color(other.color())
    {
    }

    virtual void Draw()
    {
        cout << "Drawing with a pen of color " << m_color.hex();
    }
    void setColor(const Color& c) { m_color = c; }
    const Color& color() const { return m_color; }
private:
    Color m_color;
};

class Color {
public:
    Color(int r, int g, int b, int a = 0) :
        m_red(r), m_green(g), m_blue(other.blue()), m_alpha(a)  
    {
    }

    Color(const Color& other) : 
        m_red(other.red()), m_green(other.green()), 
        m_blue(other.blue()), m_alpha(other.alpha())
    {
    }

    int red() const { return m_red; }
    int green() const  { return m_green; }
    int blue() const { return m_blue; }
    int alpha() const { return m_alpha; }

    std::string hex() const
    {
        std::ostringstream os;
        char buf[3];
        os << "#";

        sprintf(buf, "%2X", red());
        os << buf;

        sprintf(buf, "%2X", green());
        os << buf;

        sprintf(buf, "%2X", blue());
        os << buf;

        sprintf(buf, "%2X", alpha());
        os << buf;

        return os.str();
    }

private:
    int m_red;
    int m_green;
    int m_blue;
    int m_alpha;
} 
```

当然，颜色类必须根据您使用的绘图 API 进行调整——并且可能比这个更高级（不同的颜色空间等）。

## 为什么不是模板？

使用模板没有意义的原因是（可能）不同绘图操作之间的唯一区别是颜色变量。因此，通过使用模板（或像您一样手动声明不同的类），您将复制类似的代码。这将使您的程序变大，并减慢它的速度。

因此，draw 函数应该将颜色作为参数，或者（如在我的示例中）将颜色作为类数据成员。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-01-30T11:21:34.060

通过为颜色声明特殊的空类，您可以使用模板完成所有操作。这需要在编译时提供每种颜色选择。通过这样做，您可以避免使用带有虚拟方法的基类。

```
struct Red{};
struct Blue{};

template < typename Color >
class Pen{};

template <>
class Pen< Red >
{
     void Draw(){
         cout << "Drawing with red pen" << endl;
     }
};

template <>
class Pen< Blue >
{
     void Draw(){
         cout << "Drawing with blue pen" << endl;
     }
};

template < typename Color >
std::auto_ptr< Pen< Color > > createPen()
{
     return auto_ptr< Pen< Color > >(new Pen< Color >());
} 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-02-01T05:43:06.260

您可以将通用对象工厂类编写为模板类（或使用本[gamedev.net 文章](http://www.gamedev.net/page/resources/_/technical/general-programming/creating-a-generic-object-factory-r2097)中详细描述的类）。

这样，如果您的代码中有多个工厂，则定义每个工厂的工作量就会减少。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-04T11:43:27.603

作为我其他答案的补充，仅讨论工厂模式与模板用法：

使用模板的主要（也是最简单的）原因是您的代码在每种情况下都是相同的，除了它所处理的数据类型。这里的例子是 STL 容器。可以编写一个工厂函数 createVector("string")，然后手动输入每个容器——但这显然不是最理想的。

即使代码不同，不仅是数据类型，也可以使用模板特化——但在许多情况下，工厂函数会更有意义。

例如，考虑一个数据库抽象库。可以使用模板特化，这样库就可以像“db::driver”一样使用。但这会迫使您在代码中的任何地方输入数据库类型（首先使库有点无用......），或者对接口类型 db::driver 类执行案例。

在这个例子中，更直观的是说 db::get_driver(odbc) 并将正确的类转换为接口类型。

# php - 引导 PHP 中的所有函数

> ID：410841
> 
> 赞同：2
> 
> 时间：2009-01-04T11:12:16.077
> 
> 标签：php

这是一个有点疯狂的想法，但是有没有一种方法可以在不使用辅助函数调用函数的情况下引导 php 具有的所有函数。

我的意思实际上是在每个基本函数调用之前和之后调用一些代码或函数。

例子：

```
<?php
echo "Hello";
?> 
```

但是这些函数会在 echo 之前和 echo 之后调用：

```
<?php
function pre_echo()
{
  do_something();
}

function post_echo()
{
  do_something_else();
}
?> 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-01-04T11:19:32.597

“引导”在这里不是正确的术语 - 您想要做的是称为[面向方面的编程](http://en.wikipedia.org/wiki/Aspect-oriented_programming)，[是的，它可以在 PHP 中完成](http://sebastian-bergmann.de/archives/573-Current-State-of-AOP-for-PHP.html)。但是，它似乎需要对您通常使用 PHP 的方式进行重大更改。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-04T11:18:02.180

就像仅供参考一样，您的示例选择了一些在最严格意义上实际上并不是函数的东西，[echo](http://uk.php.net/echo)是一种语言构造，并且由 PHP 内部以不同方式处理。

我认为只有两种方法可以实现您所追求的目标：

*   预处理您的 PHP 代码以使用重写的函数调用对其进行扩充
*   或者，修改 PHP 内部以支持挂钩所有函数调用

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-04T11:21:57.320

你为什么要这样做？如果你想分析你的代码，那么使用像 [Xdebug这样的分析器](http://www.xdebug.org/docs/profiler)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-04T16:54:23.733

这就是为什么您编写自己的类并封装您希望针对特定情况拥有的功能的原因。为什么要让其他程序员更难理解你的东西？

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-06T22:06:35.630

你可以这样做。您需要更改 php.ini 文件

在指令

```
auto_prepend_file
auto_append_file 
```

例如

```
auto_prepend_file=/home/php/run_before.php
auto_prepend_file=/home/php/run_after.php 
```

然后

```
<?php echo('hi'); ?> 
```

输出将是：

```
# something before
hi
# something after 
```

# apache-flex - Flex/Accordion：有条件地隐藏一个孩子

> ID：410842
> 
> 赞同：2
> 
> 时间：2009-01-04T11:12:28.727
> 
> 标签：apache-flex, actionscript-3

如何将孩子藏在手风琴里？使用可见似乎不起作用并且启用不是我所追求的。

```
<mx:Accordion>
<mx:VBox width="100%" height="100%" label="Foo" id="viewOverview" visible="false">
...
</mx:VBox>
...
</mx:Accordion> 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-01-04T11:41:37.343

我认为你无法隐藏它。奇怪的是可见属性不起作用......无论如何，我会通过代码控制孩子们并根据应用程序的需要删除和插入它们。隐藏：

```
function hideFoo():void {
    this.theAccordion.removeChild(this.vboxFoo);
} 
```

您可能希望保留对“隐藏”子项的引用，以便稍后再次添加它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-06T18:58:05.197

这不是答案，只是我在尝试找到解决此问题的另一种方法时发现的一些奇怪的事情：

Accordion 标头有一个可见属性和一个 setActualSize 方法。后者采用高度和宽度，并将每个设置为零......

acc.getHeaderAt(0).setActualSize(0,0);

...完成与设置 visible = false 相同的事情，即隐藏标题的内容，但不会从手风琴中删除其区域。我希望能欺骗手风琴把孩子藏起来，但没有这样的运气……尽管如此，这可能是继续尝试的途径。如果我有更多时间，我将继续探索，但目前我的带宽不足......

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-12-07T11:51:27.240

您还可以使用 showHeader、hideHeader、isHeaderHidden 等方法创建手风琴的后代，其中包含哈希表以跟踪类似于下面的隐藏元素：

```
public class AccordionHideHeader extends Accordion
    {
        private var _hiddenHeader:Dictionary=new Dictionary();

        public function AccordionHideHeader()
        {
            super();
        }

        public function hideHeader(header:DisplayObject):void
        {
            if (contains(header))
            {
                _hiddenHeader[header]=getChildIndex(header);
                removeChild(header);
            }

        }

        public function showHeader(header:DisplayObject):void
        {
            if (!contains(header))
            {
                addChildAt(header, _hiddenHeader[header]);
                delete _hiddenHeader[header]
            }
        }

        public function isHeaderHidden(header:DisplayObject):Boolean
    {                       
        for (var key:Object in _hiddenHeader)
        {
            if (key==header)
                return true;                
        }

        return false;
    }
    } 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2010-10-01T05:09:13.957

抱歉，我不同意删除孩子，因为在将其按确切顺序添加回其位置时会遇到问题。

示例：如果您在手风琴中有 5 页，则删除子 1 和 3，现在在任何情况下您都希望将数字 3 放回手风琴，您如何将其放回？因为索引不再是 3（记住 1 也被删除了）。

[我在这里](http://blog.flexexamples.com/2008/05/30/preventing-users-from-clicking-on-an-accordion-containers-header-in-flex/)找到了一个很好的解决方案。简而言之，您可以使用 enalbe 和 disable 功能制作自己的手风琴，其中启用和禁用在子容器上定义。

在这里我粘贴手风琴代码：

```
/**
 * http://blog.flexexamples.com/2008/05/30/preventing-users-from-clicking-on-an-accordion-containers-header-in-flex/
 */
package comps {
    import mx.containers.accordionClasses.AccordionHeader;
    import mx.events.FlexEvent;

    public class MyAccHeader extends AccordionHeader {
        public function MyAccHeader() {
            super();
            addEventListener(FlexEvent.INITIALIZE, accordionHeader_initialize);
        }

        private function accordionHeader_initialize(evt:FlexEvent):void {
            enabled = data.enabled;
        }
    }
} 
```

也许我的回答与您不再相关，但我希望可以帮助面临同样问题的其他人。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2011-05-10T14:56:30.430

您可以覆盖 Accordion 逻辑和用户 includeInLayout 属性来控制子项的可见性。

如果您在 MXML 中设置所有子项，这将起作用。

```
import flash.events.Event;

import mx.containers.Accordion;
import mx.core.UIComponent;

public class DynamicAccordion extends Accordion
{
public function DynamicAccordion()
{
}

private var allChildern:Array;

override protected function childrenCreated():void
{
    allChildern = new Array();
    for (var i:int = numChildren - 1; i >= 0 ; i--)
    {
        var child:UIComponent = getChildAt(i) as UIComponent;
        if (child)
        {
            child.addEventListener("includeInLayoutChanged",  childIncludeLayoutChangedHandler);
            if (!child.includeInLayout)
            {
                removeChild(child);
            }
            allChildern.push(child);
        }
    }
    allChildern = allChildern.reverse();

    super.childrenCreated();
}

private function childIncludeLayoutChangedHandler(event:Event):void
{
    var child:UIComponent = event.currentTarget as UIComponent;
    if (child.includeInLayout)
    {
        var index:int = allChildern.indexOf(child);
        addChildAt(child, index);
    }
    else
    {
        removeChild(child);
    }
}
} 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-06T23:07:51.997

我认为您可能必须实际删除手风琴子项本身（例如，使用 State removeChild() 机制）。如果您需要保留对象本身，只需在全局变量中保留对它的引用。

干杯

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-01-06T23:21:42.670

手风琴控件始终打开 1 个子项。通过打开另一个孩子，当前的孩子将关闭。

如果您想一次打开 1 个以上的孩子或关闭所有孩子，您可以使用 VStack 组件，网址为：[http ://weblogs.macromedia.com/pent/archives/2007/04/the_stack_compo.html](http://weblogs.macromedia.com/pent/archives/2007/04/the_stack_compo.html)

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-12-16T07:47:10.110

```
<mx:Script>
    <![CDATA[

        private function hideFn():void
        {
            acc.removeChildAt(0);                   
        }

        private function showFn():void
        {
            acc.addChildAt(helloBox  , 0);              
        } 

    ]]>
</mx:Script>
<mx:VBox>
<mx:Accordion id="acc" width="200" height="200">    

    <mx:VBox id="helloBox" label="Test">

        <mx:Label text="hello"/>

    </mx:VBox>

    <mx:VBox label="Test2">

        <mx:Label text="hello again"/>

    </mx:VBox>

</mx:Accordion>

<mx:Button label="hide" click="hideFn()"/>
<mx:Button label="show" click="showFn()"/>
</mx:VBox> 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2010-03-04T12:36:16.667

试试这个

```
accrod.getHeaderAt(0).enabled=false;
accrod.getHeaderAt(0).visible=false; 
```

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2011-01-25T16:20:43.433

这是我的解决方案：

[http://weflex.wordpress.com/2011/01/25/flex-accordion-hideshow-headers/](http://weflex.wordpress.com/2011/01/25/flex-accordion-hideshow-headers/)

我复制并修改了 Accordion 的代码，所以如果孩子的“includeInLayout”属性为 false，则不会显示。

* * *

## 回答 #11

> 赞同：-1
> 
> 时间：2012-08-18T18:10:28.030

这是解决方案，如何在单击标题时折叠手风琴。

```
<mx:Script>
    <![CDATA[
        import mx.events.IndexChangedEvent;

        private var isAccordionClosed:Boolean;

        private function myAccordion_clickHandler(event:MouseEvent):void
        {
            trace(event.currentTarget.label);
            var selIdx:int = myAccordion.selectedIndex;

            isAccordionClosed = (isAccordionClosed) ? false : true; 
            if (isAccordionClosed)
            {
                collapseAccordion(selIdx, !isAccordionClosed);
            }
            else
            {
                collapseAccordion(selIdx, !isAccordionClosed);
            }
        }

        private function collapseAccordion(idx:int, showHide:Boolean):void
        {
            switch(idx)
            {
                case 0:
                    vb1.scaleX = vb1.scaleY = int(showHide); 
                    break;

                case 1:
                    vb2.scaleX = vb2.scaleY = int(showHide);
                    break;

                case 2:
                    vb3.scaleX = vb3.scaleY = int(showHide);
                    break;

                case 3:
                    vb4.scaleX = vb4.scaleY = int(showHide); 
                    break;

                case 4:
                    vb5.scaleX = vb5.scaleY = int(showHide);
                    break;
            }
        }

        private function myAccordion_changeHandler(event:IndexChangedEvent):void
        {
            isAccordionClosed = true;
        }

    ]]>
</mx:Script>

<mx:Accordion id="myAccordion" x="200" y="200" click="myAccordion_clickHandler(event)" resizeToContent="true" 
              width="399" verticalGap="0" change="myAccordion_changeHandler(event)">
    <mx:VBox id="vb1" label="Chapter 1">
        <mx:Label text="Accordion 1"  width="397" textAlign="center" height="38"/>
    </mx:VBox>

    <mx:VBox id="vb2" label="Chapter 2">
        <mx:Label text="Accordion 2" width="397" textAlign="center" height="43"/>
    </mx:VBox>

    <mx:VBox id="vb3" label="Chapter 3">
        <mx:Label text="Accordion 3" width="397" textAlign="center" height="43"/>
    </mx:VBox>

    <mx:VBox id="vb4" label="Chapter 4">
        <mx:Label text="Accordion 4" width="397" textAlign="center" height="43"/>
    </mx:VBox>

    <mx:VBox id="vb5" label="Chapter 5">
        <mx:Label text="Accordion 5" width="397" textAlign="center" height="43"/>
    </mx:VBox>
</mx:Accordion> 
```

# svn - TortoiseSVN 无法连接到 SlikSVN Subversion 服务器

> ID：410844
> 
> 赞同：5
> 
> 时间：2009-01-04T11:13:54.340
> 
> 标签：svn, version-control, tortoisesvn

我在我的工作组中的一台机器上创建了一个 SubVersion 服务器。从我的开发框中，我可以毫无问题地访问存储库并签入/签出文件。

我刚刚安装了 TortoiseSVN，无论我做什么，它都不会连接到服务器上的存储库。我收到臭名昭著的错误“无法建立连接，因为目标机器主动拒绝了它”。

有谁知道为什么这可能是..？据我所知，龟壳扩展是在我的用户凭据下运行的。SVN 命令行工具可以正常工作，但 Tortoise 不能正常工作，这似乎很奇怪。

两台机器都运行Vista

*注意：在这两种情况下，我都使用 svn 协议进行连接*

*终于，我修好了……！问题似乎出在我下载的 Subversion 包上。我下载了最新版本的 SlikSVN (1.5.5) 并将其安装在我的客户端和服务器上。TortoiseSVN 似乎不喜欢这个构建/版本。我刚刚在两台机器上卸载了 SlickSVN 并从 CollabNet 获取了最新版本，现在一切正常！*

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2011-03-02T22:20:39.703

只需添加`--listen-host 0.0.0.0`到您的 SVN 服务命令。问题是您正在创建正在侦听的服务，`IPv6`并且您正在尝试使用`IPv4`. 看这个：

[http://www.renaissance-design.net/code/installing-and-configuring-svnserve-and-tortoisesvn-on-windows/](http://www.renaissance-design.net/code/installing-and-configuring-svnserve-and-tortoisesvn-on-windows/)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-04T12:18:50.433

您可能想在 TSVN 邮件列表上问这个问题：

请参阅[http://tortoisesvn.net/community](http://tortoisesvn.net/community)或[http://groups.google.com/group/tortoisesvn](http://groups.google.com/group/tortoisesvn)

您通常会很快得到答复。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-04T18:12:47.863

终于，我修好了……！

问题似乎出在我下载的 Subversion 包上。我下载了最新版本的 SlikSVN (1.5.5) 并将其安装在我的客户端和服务器上。TortoiseSVN 似乎不喜欢这个构建/版本。我刚刚在两台机器上卸载了 SlickSVN 并从 CollabNet 获取了最新版本，现在一切正常！

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-04T11:32:06.003

请检查以下内容：

*   您的防火墙是否配置为允许流量通过（端口 3690，默认情况下，或您可能已配置 svnserve 运行的任何其他端口）。检查客户端机器和运行 svnserve 的机器上的防火墙。
*   许多病毒扫描程序也会干扰“不寻常”的网络端口
*   svnserve 正在侦听的默认主机是“localhost”，这意味着您将无法从另一台机器连接到它。您是否使用“--listen-host serverhostname”参数启动 svnserve？

编辑：如果您使用的是 collab.net 服务器，则必须手动启动该服务：

```
net start svnserve 
```

这也可能有帮助：[http ://subversion.open.collab.net/articles/svnserve-service.htm](http://subversion.open.collab.net/articles/svnserve-service.htm)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-01-04T12:00:23.107

可能值得检查 Tortoise 没有选择代理设置（Tortoise 配置中的网络设置）。在同一个屏幕上，您可以打开 SVN 服务器文件并查看其中是否发生了任何奇怪的事情。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-04T11:19:42.817

您使用什么协议来访问服务器端存储库？如果不是`file://`协议，你确认对应的服务器确实在运行吗？尝试手动连接到它，例如通过运行

`telnet target.machine.ip.address target_port`

（当然，替换`target.machine.ip.address`为实际 IP 地址和`target_port`数字服务器端口）。如果那个端口是开放的，屏幕会清空，否则 telnet 会挂起一段时间然后报错。

如果它使用 IP 地址而不是机器名称工作，则您的名称解析有问题（检查您的 DNS 和/或 WINS 设置。）

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-02-08T23:29:13.737

我对 SlickSVN 1.5.5 也有同样的问题。但在我的情况下，它是以守护模式运行的本地颠覆服务器。CollabNet 包在相同的配置下工作正常。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-03-06T13:13:26.227

Slik Subversion 客户端支持 IPv6 和 IPv4，因此如果您的系统表示它更喜欢 IPv6。使用 --listen-host 参数，您可以选择它应该如何收听。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2012-01-10T06:43:16.737

我重新运行了命令`svnserve --daemon --root D:\Subversion\Repo`，这解决了这个错误。

这个错误突然出现了。我们前一分钟工作正常，接下来我们看到了这个错误。不知道为什么。

# c++ - 如何在 C++ 中检查无限和不确定的值？

> ID：410853
> 
> 赞同：33
> 
> 时间：2009-01-04T11:31:22.963
> 
> 标签：c++, visual-c++, floating-point, nan, infinity

在我的程序中，当一个值被零除时，通常会出现无穷大。当我将零除以零时，我变得不确定。如何在 C++ 中检查无限和不确定的值？

在 C++ 中，无穷大由 1.#INF 表示。不确定由 -1.#IND 表示。问题是如何测试一个变量是无限的还是不确定的。检查无穷大相对简单：您可以在特定的 C++ 中找到无穷大定义。对于我的情况（VS2003），它是 std::numeric_limits::infinity()。您必须包含“限制”才能使用它。您可以将此无限值分配给变量，然后将其与某个值进行比较，以检查该值是否为无限。

Indeterminate 有点棘手，因为您无法将不确定的值与其他值进行比较。任何比较都返回 false。您可以使用此属性通过将其与自身进行比较来检测不确定的值。假设您有一个名为 aVal 的双变量。在正常情况下，aVal != aVal 返回 false。但如果值不确定，aIndVal != aIndVal 返回真。无限值不存在这种奇怪的情况，即 aInfVal != aInfVal 总是返回 false。

以下是两个可用于检查不确定值和无限值的函数：

```
#include "limits.h"
#include "math.h"

bool isIndeterminate(const double pV)
{
    return (pV != pV);
} 

bool isInfinite(const double pV)
{
    return (fabs(pV) == std::numeric_limits::infinity())
} 
```

这些检查有没有更好的方法，我错过了什么吗？

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2009-01-04T11:45:34.980

对于 Visual Studio，我会使用[`_isnan`](http://msdn.microsoft.com/en-us/library/aa298428(VS.60).aspx)and[`_finite`](http://msdn.microsoft.com/en-us/library/aa246875(VS.60).aspx)或者[`_fpclass`](http://msdn.microsoft.com/en-us/library/aa246882(VS.60).aspx).

但是，如果您可以访问支持 C++11 的标准库和编译器，则可以使用[`std::isnan`](http://en.cppreference.com/w/cpp/numeric/math/isnan)和[`std::isinf`](http://en.cppreference.com/w/cpp/numeric/math/isinf).

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2013-07-18T12:50:11.377

虽然 C++03 没有提供 C99 的[isnan](http://en.cppreference.com/w/c/numeric/math/isnan)和[isinf](http://en.cppreference.com/w/c/numeric/math/isinf) *宏*，但 C++11 将它们标准化为[函数](http://en.cppreference.com/w/cpp/numeric/math)。如果您可以使用 C++11，而不是严格的 C++03，那么这些将是更简洁的选择，避免使用宏、[编译器内置](http://en.wikipedia.org/wiki/Intrinsic_function)函数和依赖于平台的函数。

C++11对除and之外的所有值的[`std::isfinite`](http://en.cppreference.com/w/cpp/numeric/math/isfinite)返回；所以应该一次检查无限和不确定的值。`true``inf``nan``!isfinite`

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-01-04T11:42:28.807

虽然不是严格意义上的 C++03 的一部分，但如果您的编译器提供标准 <math.h> 头文件的一些新 C99 功能，那么您可以访问以下“类似函数的宏”：`isfinite`、`isinf`、`isnan`。如果是这样，这些将是执行这些检查的最简单和最安全的方法。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-01-04T22:08:37.263

您也可以将它们用作严格的仅限 C++ 的解决方案。除了通过使用类型特征来增加安全性之外，它们并没有真正提供比 OP 的解决方案更多的东西，而且在`is_inf`.

```
template <bool> struct static_assert;
template <> struct static_assert<true> { };

template<typename T>
inline bool is_NaN(T const& x) {
    static_cast<void>(sizeof(static_assert<std::numeric_limits<T>::has_quiet_NaN>));
    return std::numeric_limits<T>::has_quiet_NaN and (x != x);
}

template <typename T>
inline bool is_inf(T const& x) {
    static_cast<void>(sizeof(static_assert<std::numeric_limits<T>::has_infinity>));
    return x == std::numeric_limits<T>::infinity() or x == -std::numeric_limits<T>::infinity();
} 
```

（谨防自制`static_assert`）

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2013-11-08T17:05:21.020

有`isfinite`来自 C99 或 POSIX 或我认为的东西。

一种骇人听闻的方法是测试`x-x == 0`；如果`x`是无限或NaN，那么`x-x`是NaN，所以比较失败，而如果`x`是有限的，那么`x-x`是`0`并且比较成功。不过，我建议使用`isfinite`，或者将此测试打包到一个函数/宏中，称为类似的东西，`isfinite`以便您可以在时机成熟时摆脱它。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-11-08T16:45:12.937

```
if (x!=x)              ... then x is nan
if (x>0 && x/x != x/x) ... then x is +inf
if (x<0 && x/x != x/x) ... then x is -inf 
```

这也可能有效（但涉及调用 exp() 和测试双打的相等性）：

```
if (exp(-x)==0.) ... then x is inf
if (exp(x)==0.)  ... then x is -inf 
```

# .net - 为什么 .NET 的条件属性会导致副作用被移除？

> ID：410865
> 
> 赞同：3
> 
> 时间：2009-01-04T11:43:20.320
> 
> 标签：.net, conditional

我今天读到了这个`Conditional`属性。根据 MSDN：

> 应用于`ConditionalAttribute`方法向编译器表明，除非定义了与之关联的条件编译符号，否则不应将对该方法的调用编译为 Microsoft 中间语言 (MSIL) `ConditionalAttribute`。

好的。这很清楚。所以对*方法的调用*不会被编译。但是副作用呢？

```
[Conditional("UndefinedCondition")]
static void f1(int x) { Console.WriteLine(x); }

static int a = 0;
static void f2() { f1(++a); } 
```

因此，当`f2`被调用时，`f1`应该删除对的调用。但是为什么也被`++a`删除了？这对我来说没有任何意义！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-01-04T12:37:28.853

是的，参数所需的任何调用也被删除。这意味着对于典型的用例（调试构建），您删除了整个表达式，这通常是预期的。

`[Conditional]`基本上，在使用任何一种方法时都需要非常小心，**或者**同样（在 C# 3.0 中）*分部方法*- 如果分部方法的另一半未实现，它们具有非常相似的行为。作为示例（对于部分方法），请参见下文。请注意，调用`HasSideEffect()`已删除（取消注释另一半`Bar`以查看它的工作）：

```
using System;
partial class Foo {
    partial void Bar(string value);
    static void Main() {
        Foo foo = new Foo();
        foo.Bar(HasSideEffect());
    }
    static string HasSideEffect() {
        Console.WriteLine("hello");
        return "world";
    }
}

partial class Foo {
    /* uncomment this
    partial void Bar(string value) {
        Console.WriteLine(value);
    }*/ 
} 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-01-04T15:47:34.570

扩展马克的答案。

这绝对是“设计”。理解这一点的合理化的最好方法是考虑这段代码取代了什么。这个特性以许多更简洁的方式采用了条件编译代码的方式。

例如，

```
#if DEBUG
f1(++a);
#endif 
```

或者其他版本

```
#define f1(x) ... 
```

在非调试情况下，显然没有副作用。这与 [Conditional] 代码的行为相同。我同意这绝对不像第一个例子那么清楚，但它和第二个例子一样清楚。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-04T11:49:09.370

我想这是由于编译器实现的容易性。

无论如何我都会害怕这样的代码（即使它按你的预期工作）并将它写成

```
++a;
f1(a); 
```

为了清楚起见。你总能看到什么被执行，什么没有被执行。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-04T13:48:11.360

我还怀疑这种行为被设计为与 C 预处理器宏相同，通常设置为在不使用时不评估参数。

# c - Simple way to extract part of a file path?

> ID：410889
> 
> 赞同：1
> 
> 时间：2009-01-04T12:10:09.047
> 
> 标签：c, string

I'm not very good at C, and I always get stuck on simple string manipulation tasks (that's why I love Perl!).

I have a string that contains a file path like "/Volumes/Media/Music/Arcade Fire/Black Mirror.aac". I need to extract the drive name ("Media" or preferably "/Volumes/Media") from that path.

Any help would be greatly appreciated, just as I try to return the favor on the Perl questions!

*   Jim

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-04T12:28:40.540

I think sscanf could be appropriate:

```
#include <stdlib.h>
#include <string.h>
#include <stdio.h>

void test(char const* path) {
    int len;
    if(sscanf(path, "/Volumes/%*[^/]%n", &len) != EOF) {
        char *drive = malloc(len + 1);
        strncpy(drive, path, len);
        drive[len] = '\0';

        printf("drive is %s\n", drive);
        free(drive);
    } else {
        printf("match failure\n");
    }
}

int main() {
    test("/Volumes/Media/Foo");
    test("/Volumes/Media");
    test("/Volumes");
} 
```

Output:

```
drive is /Volumes/Media
drive is /Volumes/Media
match failure 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-04T12:17:11.670

I think that you need to be a little more exact in the specification of your problem.

When you say that you want to extract "Media", do you mean everything between the second and third '/' character, or is there a more complex heuristic at work?

Also, is the string in a buffer that's suitable to be modified?

Typically the way to do this would be to use `strchr` or `strstr` one or more times to find a pointer to where you want to extract the substring from (say `p`), and a pointer to the character after the last character that you need to extract (say `q`), if the buffer is a temporary buffer that you don't mind destroying then you can just do `*q = 0` and `p` will be a pointer to the required string. Otherwise you need to have a buffer of at least `q - p + 1` chars ( `+1` is to include space for the null terminator as well as the `q - p` interesting characters. e.g. `char *buffer = malloc(q - p + 1);` ) and you can extract the string with `memcpy`. e.g. `memcpy(buffer, p, q - p + 1)`.

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-04T12:23:42.997

```
#include <stdio.h>
#include <stdlib.h>
#include <string.h>

char * extractDriveName(const char *path, char separator, int maxLen)
{
    char *outBuffer;
    int outBufferSize, i, j;
    int sepOcur;

    outBufferSize = strlen(path) + 1;
    outBufferSize = outBufferSize > maxLen ? maxLen : outBufferSize;

    outBuffer = (char *) malloc(outBufferSize);

    // Error allocating memory.
    if(outBuffer == NULL)
        return NULL;

    memset(outBuffer, 0, outBufferSize);

    for(i = 0, sepOcur = 0, j = 0; i < outBufferSize; i++)
    {
        if(path[i] == separator)
            sepOcur ++;

        if(sepOcur >= 0 && sepOcur < 3)
            outBuffer[j++] = path[i];
        else if(sepOcur == 3)
            break;      
    }

    // Don't forget to free the buffer if 
    return outBuffer;           
}

int main(void)
{
    char path [] = "/Volumes/Media/Music/Arcade Fire/Black Mirror.aac";

    char * driveName = extractDriveName(path, '/', strlen(path) + 1);

    if(driveName != NULL)
    {
        printf("Path location: '%s'\n", path);
        printf("Drive name: '%s'\n", driveName);
        free(driveName);
    }
    else
    {
        printf("Error allocating memory\n");
    }
} 
```

Output:

```
Path location: '/Volumes/Media/Music/Arcade Fire/Black Mirror.aac'
Drive name: '/Volumes/Media' 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-04T13:45:29.837

I think that the easiest way is to use **strtok()**. This function will split a string in tokens separated by one of the characters in the separators string.

If your original path is in **str** and you want the second part in **part**:

```
strtok(str, "/");        /* To get the first token */
part=strtok(NULL, "/");  /* To get the second token that you want */ 
```

Note that **strtok()** will change **str**, so it should not be a **const**. If you have a **const** string, you might use **stdrup()**, which is not standard but normally available, to create a copy.

Also note that **strtok()** is not thread safe.

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-04T14:50:01.020

You example makes it appear that you are working in a Macintosh environment. I suspect that there is an Apple API to get the volume on which a particular file resides.

Any reason not to use that?

**Edit:** Looking at your profile, I suspect I guessed wrong about your environment. I can't help you for windows. Good luck. I'll leave this here in case anyone is looking for the same answer on a Mac.

* * *

From Mac Forums I find "[Getting the current working Volume name?](http://forums.macrumors.com/archive/index.php/t-249274.html)" which seems to be the same question. There is a nice discussion there, but they dpn't seem to come to a single answer.

Google is your friend.

* * *

Another possibility: [BSD Path to Volume Name & Vice-Versa](http://cocoadev.com/forums/comments.php?DiscussionID=176) at CocoaDev Forums.

# java - 如何在 getter 链中跟踪 NullPointerException

> ID：410890
> 
> 赞同：28
> 
> 时间：2009-01-04T12:10:46.457
> 
> 标签：java, debugging, nullpointerexception, getter

如果我在这样的调用中收到 NullPointerException：

```
someObject.getSomething().getSomethingElse().
    getAnotherThing().getYetAnotherObject().getValue(); 
```

我得到一个相当无用的异常文本，例如：

```
Exception in thread "main" java.lang.NullPointerException
at package.SomeClass.someMethod(SomeClass.java:12) 
```

我发现很难找出哪个调用实际上返回了 null，经常发现自己将代码重构为如下所示：

```
Foo ret1 = someObject.getSomething();
Bar ret2 = ret1.getSomethingElse();
Baz ret3 = ret2.getAnotherThing();
Bam ret4 = ret3.getYetAnotherOject();
int ret5 = ret4.getValue(); 
```

然后等待一个更具描述性的 NullPointerException 告诉我要查找哪一行。

你们中的一些人可能会争辩说连接 getter 是不好的风格，无论如何都应该避免，但我的问题是：我可以在不更改代码的情况下找到错误吗？

提示：我正在使用 eclipse，我知道调试器是什么，但我不知道如何将其应用于问题。

**我对答案的结论：**
一些答案告诉我，我不应该一个接一个地链接吸气剂，一些答案向我展示了如果我不遵守该建议如何调试我的代码。

我已经接受了一个答案，该答案准确地教会了我何时链接吸气剂：

*   如果它们不能返回 null，请随意链接它们。无需检查！= null，无需担心 NullPointerExceptions（*请注意链接仍然违反 Demeter 法则，但我可以忍受*）
*   如果它们可能返回 null，永远不要，永远不要链接它们，并检查每个可能返回 null 的 null 值

这使得任何关于实际调试的好建议都毫无用处。

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2009-01-05T06:33:49.287

NPE 是 Java 中最没用的异常。它似乎总是被懒惰地实现并且从不确切地说明是什么原因造成的，即使像“xyZ 类为空”这样简单，在调试这种情况下也会有很大帮助。

无论如何，我发现在这些情况下找到 NPE thrower 的唯一好方法是以下类型的重构：

```
someObject.getSomething()
          .getSomethingElse()
          .getAnotherThing()
          .getYetAnotherObject()
          .getValue(); 
```

有了它，现在 NPE 指向正确的行，从而正确的方法抛出了实际的 NPE。不像我想要的那样优雅的解决方案，但它确实有效。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2009-01-04T12:33:05.287

答案取决于你如何看待你的吸气剂（合同）。如果他们可能会返回`null`，您应该每次都检查返回值。如果 getter 不应该 return `null`，getter 应该包含一个检查并抛出一个异常（`IllegalStateException`？）而不是返回`null`，你承诺永远不会返回。堆栈跟踪将指向确切的吸气剂。您甚至可以将您的 getter 发现的意外状态放在异常消息中。

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2009-01-04T12:35:11.383

在 IntelliJ IDEA 中，您可以设置*异常*断点。每当抛出指定的异常时，这些断点就会触发（您可以将其范围限定为包或类）。

这样应该很容易找到 NPE 的来源。

我会假设，你可以在 netbeans 或 eclipse 中做类似的事情。

编辑：[这](http://help.eclipse.org/help32/index.jsp?topic=/org.eclipse.jdt.doc.user/reference/views/breakpoints/ref-addexception_viewaction.htm)是关于如何在 eclipse 中添加异常断点的解释

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2009-01-04T17:27:34.117

如果你发现自己经常写：

```
a.getB().getC().getD().getE(); 
```

这可能是代码异味，应该避免。例如，您可以重构为`a.getE()`哪些调用`b.getE()`哪些调用`c.getE()`哪些调用`d.getE()`。（此示例可能对您的特定用例没有意义，但它是修复此代码异味的一种模式。）

另[见得墨忒耳法则](http://c2.com/cgi/wiki?LawOfDemeter)，其中说：

*   您的方法可以直接调用其类中的其他方法
*   您的方法可以直接在其自己的字段上调用方法（但不能在字段的字段上）
*   当您的方法接受参数时，您的方法可以直接调用这些参数的方法。
*   当您的方法创建本地对象时，该方法可以调用本地对象的方法。

因此，一个人不应该有一个消息链，例如`a.getB().getC().doSomething()`。除了使 NullPointerExceptions 更易于调试之外，遵循此“法律”还有更多好处。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-01-04T12:19:39.760

我通常不会在有多个可空 getter 的情况下像这样链接 getter。

如果您在 ide 中运行，您可以设置一个断点并在每个元素上连续使用 ide 的“评估表达式”功能。

但是，当您从生产服务器日志中收到此错误消息时，您会摸不着头脑。所以最好每行最多保留一个可为空的项目。

同时我们可以梦想[groovy 的安全导航操作符](http://groovy.codehaus.org/Operators#Operators-SafeNavigationOperator(%3F.))

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-01-04T12:35:18.670

早期失败也是一种选择。

在代码中可以返回空值的任何地方，考虑引入对空返回值的检查。

```
public Foo getSomething()
{
  Foo result;
  ...
  if (result == null) {
    throw new IllegalStateException("Something is missing");
  }
  return result;
} 
```

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-01-04T15:49:24.237

下面介绍如何使用 Eclipse 查找错误。

首先，在行上设置断点：

```
someObject.getSomething().getSomethingElse().
getAnotherThing().getYetAnotherObject().getValue(); 
```

在调试模式下运行程序，当行被命中时允许调试器切换到它的透视图。

现在，突出显示“someObject”并按 CTRL+SHIFT+I（或右键单击并说“检查”）。

它是空的吗？你找到了你的 NPE。它是非空的吗？然后突出显示 someObject.getSomething() （包括括号）并检查它。它是空的吗？等等。继续沿着链条找出你的 NPE 发生在哪里，而不必更改你的代码。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-01-04T12:31:28.693

您可能想参考[这个关于避免 != null](https://stackoverflow.com/questions/271526/how-to-avoid-null-statements-in-java#271874)的问题。

基本上，如果 null 是一个有效的响应，你必须检查它。如果没有，请断言它（如果可以的话）。但无论您做什么，都应尽量减少 null 出于此原因而成为有效响应的情况。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-01-04T20:07:27.947

如果你不得不分道扬镳或进行复杂的调试以发现问题，那么这通常是上帝告诉你代码没有足够早地检查空值的方式。

如果您有一个采用对象参数的方法或构造函数，并且所讨论的对象/方法无法合理地处理该参数为空，那么只需检查并在那里抛出 NullPointerException。

我已经看到人们发明了“编码风格”规则来尝试解决这个问题，例如“一行上不允许有多个点”。但这只会鼓励在错误位置发现错误的编程。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-01-04T14:36:22.310

像这样的链式表达式对于 NullPointerExceptions（以及可能发生的大多数其他问题）来说是一种痛苦的调试，所以我建议你尽量避免它。不过，您可能已经听够了，就像之前提到的海报一样，您可以在实际的 NullPointerException 上添加断点以查看它发生的位置。

在 Eclipse（和大多数 IDE）中，您还可以使用监视表达式来评估在调试器中运行的代码。您可以通过选择代码并使用内容菜单添加新手表来执行此操作。

如果您可以控制返回 null 的方法，那么如果 null 是要返回的有效值，您也可以考虑使用 Null Object 模式。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-01-04T17:07:52.363

将每个 getter 放在自己的行上并进行调试。跳过 (F6) 每个方法以查找哪个调用返回 null

# javascript - 第一次使用jQuery，简单的问题！

> ID：410898
> 
> 赞同：0
> 
> 时间：2009-01-04T12:17:45.710
> 
> 标签：javascript, jquery

我有一些这样的标记：

```
<p><a id="1" href="#">Link 1</a></p>
<p id="1show" class="starthidden">Hi! I get shown when link 1 is clicked</p>

<p><a id="2" href="#">Link 2</a></p>
<p id="2show" class="starthidden">Hi! I get shown when link 2 is clicked</p>

<p><a id="3" href="#">Link 3</a></p>
<p id="3show" class="starthidden">Hi! I get shown when link 3 is clicked</p> 
```

还有一些像这样的javascript：

```
$(document).ready(function(){

    $("#maincontent a").click(function () {
        var id = '#' + $(this).attr("id");
        var show = id + 'show';

        $("id").click(function () {
            $("show").slideToggle("slow");
            return false;
        });

        return false;
    });

}); 
```

现在， id 和 show 都是我在运行时所期望的，但下一行不起作用。我猜这是 $("id") 位 - 尽管将其更改为 $(id) 也不起作用。

我该如何解决？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-04T12:27:37.373

首先，数字 ID 不是有效的 HTML。ID 属性必须以 az 开头。我建议像这样更改您的 HTML：

```
<p><a href="#msg1">Link 1</a></p>
<p id="msg1" class="starthidden">Hi! I get shown when link 1 is clicked</p>

<p><a href="#msg2">Link 2</a></p>
<p id="msg2" class="starthidden">Hi! I get shown when link 2 is clicked</p>

<p><a href="#msg3">Link 3</a></p>
<p id="msg3" class="starthidden">Hi! I get shown when link 3 is clicked</p> 
```

这既有效又清晰。在没有 javascript/css 的设备上，它还会将焦点移到正确的位置。

然后，您可以在点击发生时简单地从链接中提取 href：

```
$(document).ready(function(){

    $("#maincontent a").click(function () {

        var id = $( this ).attr( 'href' );
        $( id ).slideToggle( 'slow' );
        return false;

    });

}); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-04T12:24:48.597

双字符串中的变量不会像在 PHP 中那样被解析，所以你必须这样做`$(show)`。此外，内部`click()`绑定是不必要的 - 您可以运行`slideToggle()`：

```
$(document).ready(function(){

    $("#maincontent a").click(function () {
        var id = '#' + $(this).attr("id");
        var show = id + 'show';

        $(show).slideToggle("slow");

        return false;
    });

}); 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-04T12:27:23.083

你不需要身份证！试试这个：

```
$(function(){
    $("a").click(function(){
        $(this).parents("p").slice(0,1).next("p").slideToggle("slow");
    });
}); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-04T12:25:18.767

好吧，我在列出的代码中没有看到任何 ID 为 maincontent 的元素。无论如何。我在您的代码中看到了这一行

```
$("id").click 
```

如果要访问变量，为什么要使用双引号？

# c++ - 在 C++ 中使用 const 覆盖两个参数的运算符

> ID：410924
> 
> 赞同：0
> 
> 时间：2009-01-04T12:34:32.540
> 
> 标签：c++, operator-overloading, overriding, overloading

我正在尝试使用两个 const 参数创建一个重写的运算符函数，但我不知道该怎么做。这是一个简单的例子：

```
class Number
{
    Number()
    {
        value = 1;
    };

    inline Number operator + (const Number& n)
    {
        Number result;

        result.value = value + n.value;
        return result;
    }

    int value;
} 
```

我在这里要做的是将两个参数传递给加法函数，它们都是 const 并返回结果而不更改类中的任何内容：

```
const Number a = Number();
const Number b = Number();
Number c = a + b; 
```

这可能吗？我将如何去做？

谢谢，

担

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-01-04T12:40:10.610

`inline`在类声明中可以理解，因此您无需指定它。

最惯用的做法`operator+`是，在类定义之外声明一个非成员函数，如下所示：

```
Number operator+( const Number& left, const Number& right ); 
```

`friend`如果它需要访问`Number`的内部，您可能需要将其设为类。

如果必须将其作为成员函数，则需要使函数本身为 const：

```
Number operator+( const Number& n ) const
{ // ... 
```

对于像 , 这样的类`Number`，`operator+`通常按照`operator+=`您希望所有常用运算符按预期工作的方式`operator+=`来实现，并且通常更容易实现，并且`operator+`不会比单独实现它失去任何效率。

课堂内：

```
Number& operator+=( const Number& n ); 
```

课外：

```
Number operator+( const Number& left, const Number& right )
{
    return Number( left ) += right;
} 
```

甚至：

```
Number operator+( Number left, const Number& right )
{
    return left += right;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-04T12:37:24.390

```
class Number
{
    Number()
    {
        value = 1;
    };

    inline Number operator + (const Number& n) const
    {
        Number result;

        result = value + n.value;
        return result;
    }

    int value;
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-04T12:38:27.337

怎么样：

```
inline Number operator + (const Number& n) const 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-04T13:30:10.493

虽然我觉得以前的答案已经足够好，但我认为需要进行一些澄清。

## 运算符（通常）有两种风格

第一个是非成员函数，第二个是成员函数，其参数是操作的“右操作数”，通常返回当前修改的对象。

例如，假设有`§`一个类的运算符`T`。它可以写成**非成员函数**：

```
T operator § (const T & lhs, const T & rhs)
{
   T result ;
   // do the lhs § rhs operation, and puts the result into "result"
   return result ;
} 
```

或作为**成员函数**：

```
T & T::operator § (const T & rhs)
{
   // do the "this § rhs" operation, and puts the result into "this"
   return *this ;
} 
```

甚至（非常不寻常）作为另一个**成员函数**：

```
T T::operator § (const T & rhs) const
{
   T result ;
   // do the "this § rhs" operation, and puts the result into "result"
   return result ;
} 
```

通常，您应该更喜欢非成员函数，如果只是因为您不应该将其声明为朋友。因此，使用非成员非朋友函数增强了对象的封装。

*免责声明：还有其他风格，但我将自己限制为算术运算符，如`+`, `*`, `/`,`-`等，以及“可信”运算符原型。*

## 分析你对算子的使用

在这种情况下`+`：

1.  每个操作数都必须是常量，因为`a = b + c`不能改变`b`，也不能`c`。
2.  `+`您可以像 in 一样累积，`a = b + c + d + e`因此必须存在临时对象。

```
T operator § (const T & lhs, const T & rhs)
{
   T result ;
   // do the lhs § rhs operation, and puts the result into "result"
   return result ;
} 
```

在这种情况下`+=`：

1.  您知道左操作数 A（来自 A += B）将被修改。
2.  你知道左操作数 A（来自 A += B）是它自己的结果。

所以你应该使用：

```
T & T::operator += (const T & rhs)
{
   // do the "this § rhs" operation, and puts the result into "this"
   return *this ;
} 
```

## 一如既往，过早的优化是万恶之源

我在生产代码中看到过这种代码，所以它**确实**发生了：

```
T & operator + (const T & lhs, const T & rhs)
{
   static T result ; // result is STATIC !!!!
   // do the lhs + rhs operation, and puts the result into "result"
   return result ;
} 
```

作者希望节省一个临时的。使用这种代码，编写`a = b + c + d`会导致有趣（和错误）的结果。

^_^

## 最后但并非最不重要的

我确实在[这个页面](http://www.augias.org/paercebal/tech_doc/doc.en/cpp.basic.operator_overloading_prototype.html)上写了一个运算符重载原型的列表。该页面仍在建设中，但它的主要用途（易于复制/粘贴工作原型）可能非常有用......

# php - 使用两种不同的一揽子重定向的 URL 重写（一个用于 WordPress 永久链接）

> ID：410933
> 
> 赞同：0
> 
> 时间：2009-01-04T12:39:18.630
> 
> 标签：php, apache, wordpress, mod-rewrite, redirect

我有一个相对复杂的 .htaccess 文件来控制页面请求，目前这会将所有文件请求（具有某些类型排除项）重定向到索引文件，但一个包含 WordPress 安装的目录除外。

我现在需要启用 WordPress PermaLink 支持，但我在修改 .htaccess 以使其工作时遇到了一些困难。

PermaLinks 需要生成对 SEO 更友好的 URL，它们通常由 WordPress 专门处理 - 但在我的情况下，似乎需要一个 mod-rewrite 规则，如此处详述[（](http://perishablepress.com/press/2006/06/14/the-htaccess-rules-for-all-wordpress-permalinks/)否则，启用时它会给出404 响应）。

这是当前的 .htaccess 内容：

```
RewriteEngine ON

RewriteCond %{HTTP_HOST} !^www\..*
RewriteCond %{HTTP_HOST}   !^$
RewriteCond %{HTTP_HOST} ^([^.]*)\.(co\.uk)
RewriteRule ^.*$     http://www.%1.%2%{REQUEST_URI} [R=permanent,L]

AddHandler application/x-httpd-php .phtml

#RewriteBase /blog/
#RewriteCond %{REQUEST_FILENAME} !-f
#RewriteCond %{REQUEST_FILENAME} !-d
#RewriteRule . /blog/index.php [L]

RewriteBase /
RewriteRule  ^blog/  -  [L]
RewriteRule !\.(js|ico|gif|jpg|JPG|png|css|php|phtml|pdf|txt|xml|swf|flv)$ index.phtml 
```

注释掉的部分是我尝试为 WordPress PermaLink 功能添加规则但未能成功的地方。

最初，我认为这段代码可以正常工作，但实际上一些非 WordPress 请求仍被路由到 blog/index.php 文件，当尝试从博客中跟随链接到其他站点区域时，这些请求再次被路由回博客索引.php。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-04T14:17:00.570

好吧，我相信我现在已经解决了这个问题——事后看来，答案是显而易见的。我在 /blog/ 目录中创建了另一个 .htaccess 文件并将相关规则放在那里 - 似乎工作得很好。

# python - 开发简单的窗口 3D 建模应用程序的最佳模块？

> ID：410941
> 
> 赞同：3
> 
> 时间：2009-01-04T12:52:23.533
> 
> 标签：python, opengl, 3d, wxpython

我想创建一个非常基本的 3D 建模工具。该应用程序应该是窗口化的，并且需要响应 3D 视口中的鼠标单击和拖动事件。

我已经决定将 wxPython 用于实际窗口，因为我已经相当熟悉它了。但是，我需要生成一个可以响应各种鼠标事件的 OpenGL 视口。将“相机空间”中的 2D 鼠标位置转换为世界空间坐标以使选择任务更容易进行一些方便的数学运算不会有什么坏处。

我正在寻找关于我应该查看哪些模块的建议。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-04T15:44:54.560

有什么理由不使用 wx 的[GLCanvas](http://wiki.wxpython.org/GLCanvas)吗？[这是](http://code.activestate.com/recipes/325392/)一个绘制球体的示例。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-04T15:54:16.007

作为一个非常基本的 3D 建模工具，我推荐[VPython](https://stackoverflow.com/questions/3088/best-ways-to-teach-a-beginner-to-program#50351)。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-04T15:00:04.727

我不知道有任何提供该功能的盒装模块，但您可以从[Blender 3D](http://www.blender.org/)中获得一些灵感，它具有您描述的所有功能：它是一个 3D 建模工具，它是用 Python 编写的，有一个 OpenGL 视口，其中响应鼠标事件，并且它的[开源](http://projects.blender.org/).

您可能可以从 Blender 中获取灵感并将其应用到您自己的项目中。

# c - 将文本文件读入c中的数组

> ID：410943
> 
> 赞同：18
> 
> 时间：2009-01-04T12:57:01.387
> 
> 标签：c, arrays

将文本文件读入动态一维数组的最有效方法是什么？在每次读取字符后重新分配似乎很愚蠢，在每次读取后重新分配似乎并没有好多少。我想将整个文件读入数组。你会怎么做？

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2009-01-04T13:04:49.233

我不太明白你想要什么。您是否要增量处理文件，从中读取一行，然后放弃它并处理下一行？还是要将整个文件读入缓冲区？如果你想要后者，我认为这是合适的（在实际代码中检查 malloc 和 fopen 的 NULL 返回，以确定文件是否存在以及是否有足够的内存）：

```
FILE *f = fopen("text.txt", "rb");
fseek(f, 0, SEEK_END);
long pos = ftell(f);
fseek(f, 0, SEEK_SET);

char *bytes = malloc(pos);
fread(bytes, pos, 1, f);
fclose(f);

hexdump(bytes); // do some stuff with it
free(bytes); // free allocated memory 
```

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2009-01-04T14:21:55.240

如果您的系统上有[mmap(2)](http://linux.die.net/man/2/mmap)，您可以打开该文件并将其映射到内存中。这样，你就没有内存要分配了，你甚至不必读取文件，系统会做。~~您可以使用 litb 提供的 fseek() 技巧来获取 size~~。

```
void *mmap(void *start, size_t length, int prot, int flags, int fd, off_t offset); 
```

**编辑**：您必须使用**`lseek()`**来获取文件的大小，.

```
int fd = open("filename", O_RDONLY);
int nbytes = lseek(fd, 0, SEEK_END);
void *content = mmap(NULL, nbytes, PROT_READ | PROT_WRITE, MAP_PRIVATE, fd, 0); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-04T17:16:21.240

如果要使用 ISO C，请使用[此功能](https://stackoverflow.com/questions/381300/how-can-i-read-an-xml-file-into-a-buffer-in-c#382610)。

这是 litb 的答案，包含一些错误处理......

# mfc - 我可以使用 MFC 在窗口的任何矩形区域中绘制菜单（不是弹出菜单）吗？

> ID：410946
> 
> 赞同：0
> 
> 时间：2009-01-04T13:00:34.220
> 
> 标签：mfc, menu

我重写 OnNcPaint() 方法以及 OnNcLButtonDown() 和 OnNcMouseMove() 以及 OnNcHitTest() 方法。所以窗口的原始菜单不存在。我想添加一个带有标题栏区域的菜单。我怎样才能做到这一点？

非常感谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-05T19:58:07.667

菜单被绘制为非客户区的一部分。因此，如果您正在做自己的非客户端绘画，您还必须自己绘制窗口。您可能可以使用 TrackPopupMenu 破解一些东西来绘制实际的菜单，而您只需要自己处理菜单栏和顶级菜单项。

自己绘制非客户区域充满了危险。您确定您不只是想使用[所有者绘制的菜单](http://www.codeguru.com/cpp/controls/menu/article.php/c3721/)吗？

调整 UI 对话框以适应您的确切需求可能很诱人，但请记住，这对已经习惯于 Windows 外观的用户来说是不和谐的。

# oracle - 如何更改 Oracle XE 实例的 SID

> ID：410951
> 
> 赞同：13
> 
> 时间：2009-01-04T13:04:16.270
> 
> 标签：oracle, oracle-xe, sid, service-name

我需要更改 Oracle XE 数据库的 SID（不是服务名称）以匹配生产数据库。

当我尝试在线搜索时，大部分页面都在描述通过 tnsnames.ora 更改或添加服务名称；那不是我需要做的。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2010-08-06T14:08:37.197

[asktom](http://asktom.oracle.com/pls/asktom/f?p=100:11:0::::P11_QUESTION_ID:963124000346653522)文章有答案，但格式和冗长让人难以理解，所以这里有一个总结：

[XE_HOME] 表示 Oracle XE 的安装位置。通常这是`C:\oraclexe\app\oracle\product\10.2.0\server`.

确保您具有管理员权限，否则该过程将失败。

1.  配置 SPFILE（如果需要，您可以删除旧文件）
    1.  `copy [XE_HOME]\dbs\spfileXE.ora [XE_HOME]\dbs\spfileNEW_SID_NAME.ora`
    2.  `copy [XE_HOME]\database\initXE.ora [XE_HOME]\database\initNEW_SID_NAME.ora`
    3.  编辑`[XE_HOME]\database\initNEW_SID_NAME.ora`：它应该包含这样的一行：`SPFILE='[XE_HOME]\server\dbs/spfileNEW_SID_NAME.ora'`
2.  关闭并用新服务替换旧服务：
    1.  `sqlplus / as sysdba`并执行`shutdown`
    2.  `lsnrctl stop`
    3.  `oradim -new -sid NEW_SID_NAME -startmode auto -pfile [XE_HOME]\database\initNEW_SID_NAME.ora`
    4.  `oradim -delete -sid XE`
    5.  `lsnrctl start`
3.  更新 ORACLE_SID 环境属性（系统设置 > 高级 > 环境）
4.  强制 Oracle 向侦听器注册
    *   `sqlplus / as sysdba`并执行`alter system register;`

您可以通过执行以下查询来验证 SID 是否已更改：`select instance_name from v$instance;`

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-05T13:57:30.760

我对 Johannes 发布的解决方案有一些问题，所以我不得不做一些额外的步骤。当尝试通过执行**sqlplus / as sysdba**连接到 oracle（步骤 4）时，我得到：

```
ERROR: ORA-12560: TNS:protocol adapter error 
```

解决方案是执行以下行：

```
oradim -start -sid NEW_SID_NAME 
```

然后连接 / 工作正常，但尝试使用系统或 HR 连接到 NEW_SID_NAME 给我带来了另一个问题：

```
ERROR: ORA-12514: TNS:listener does not currently know of service requested in connect descriptor 
```

我检查`select instance_name from v$instance;`了侦听器将是 NEW_SID_NAME 的查询，所以也这样做了。但是`lsnrctl status`在命令行中运行或查询`select name from dba_services;`并没有将 NEW_SID_NAME 显示为侦听器。这个问题的解决方法是在sqlplus上执行如下语句：

```
alter system set service_names='NEW_SID_NAME'; 
```

也许您还需要`alter system register;`在此之后执行。

完成这两个步骤后，我可以使用系统和 HR 连接到 NEW_SID_NAME。

希望能帮助到你

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2018-03-16T21:39:09.300

在版本 11g 中，所有以前的解决方案都不起作用......尝试执行 **sqlplus / as sysdba**时，我总是收到以下错误：

错误：ORA-12560：TNS：协议适配器错误

幸运的是，我在 [XE_HOME]\config\scripts 下找到了一个脚本来做我想做的事。该脚本名为 XE.bat，它将从头开始实例化一个新数据库，并在整个过程中询问您的 sysPassword。所以我所做的是：

1.  停止并删除现有服务（如果有）：

> oradim -delete -sid XE

2.  停止监听器
3.  按照 Johannes 的说明配置 SPFILE
4.  制作脚本 XE.bat 的副本，您可以随意命名
5.  编辑脚本的副本如下：

    1.  将“设置 ORACLE_SID=XE”行更改为“设置 ORACLE_SID=NEW_SID_NAME”
    2.  将您看到的“-sid XE”更改为“-sid NEW_SID_NAME”
    3.  更新它调用“orapwd.exe”命令的行以指向一个名为 PWDNEW_SID_NAME.ora 的文件，而不是 PWDXE.ora
    4.  更新将 spfileXE.ora 回显到 initXE.ora 的行，以将 spfileNEW_SID_NAME.ora 回显到 initNEW_SID_NAME.ora 中（这部分可能会使步骤 3 无用，但我还是更愿意这样做，以防万一......）
6.  执行脚本...它会提示您输入系统密码几次说

> 输入 1 的值：

或者

> 输入 2 的值：

就是这样，带有您 NEW_SID_NAME 的新数据库已启动并正在运行！

# python - 如何解析来自 Google App Engine 应用程序的 XML？

> ID：410954
> 
> 赞同：14
> 
> 时间：2009-01-04T13:05:41.837
> 
> 标签：python, xml, google-app-engine, parsing

如何解析来自 Google App Engine 应用程序的 XML？有什么例子吗？

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2009-04-02T19:09:49.197

自从提出问题以来，Google 已将 pyexpat 列入白名单，其中包括 minidom，因此您可以使用以下代码而无需上传任何库：

```
from xml.dom import minidom

dom = minidom.parseString('<eg>example text</eg>') 
```

更多信息： [http ://docs.python.org/library/xml.dom.minidom.html](http://docs.python.org/library/xml.dom.minidom.html)

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-01-04T13:27:43.383

查看[有关 XML 和 Python 的现有答案](https://stackoverflow.com/search?q=iterparse)。

像这样的东西可以工作：

```
from cStringIO   import StringIO
from xml.etree   import cElementTree as etree

xml = "<a>aaa<b>bbb</b></a>"

for event, elem in etree.iterparse(StringIO(xml)):
    print elem.text 
```

它打印：

```
bbb
aaa 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-01-04T13:14:25.703

AFAIK Google App Engine 提供了一个相当完整的 Python 环境供您使用。由于 Python 带有“包含电池”，您可能需要评估 vanilla Python 为您提供的不同 API：http: [//docs.python.org/library/markup.html](http://docs.python.org/library/markup.html)

# architecture - 有人在企业场景中使用过 Google Gears 吗？

> ID：410959
> 
> 赞同：15
> 
> 时间：2009-01-04T13:09:45.963
> 
> 标签：architecture, enterprise, google-gears

我想创建一个具有客户端和服务器组件的应用程序。客户端可能不会一直连接到互联网，因此必须在本地存储数据，然后在互联网连接可用时与服务器同步。数据同步将是双向的：客户端到服务器和服务器到客户端。

最初我想为 ado.net 使用 SQL Server Merge 复制/Microsoft 同步框架，并使用 C# windows 窗体创建客户端应用程序。

但是 Google Gears 似乎是一个非常好的选择，因为它与 JavaScript 一起工作，我们只需要构建一个 asp.net Web 应用程序，然后它可以在客户端和服务器上使用。此外，它还可以在 Windows mobile 5 和 6 上使用，因此也可以在移动设备上使用。

但是有人在企业场景中使用过 Google Gears 吗？有人在使用 Google Gears 时遇到过任何问题吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2011-01-24T14:38:55.280

Google 已将 Gears 置于休眠模式以支持 HTML5： http: [//gearsblog.blogspot.com/2010/02/hello-html5.html](http://gearsblog.blogspot.com/2010/02/hello-html5.html)。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-03T21:27:06.817

我正在评估它在我在以前的公司工作的文档审查应用程序的离线文档存储中的用途。我们确实决定使用它，但公司被收购了，项目陷入了空白。

但目前我知道 google 刚刚开始使用 google gears for gmail。我要补充一点，我不认为这是一个坏举动，但我会担心整体渗透，你能强迫用户安装它吗？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-10T00:45:25.907

你认为gmail不是企业吗？我知道 gmail 可以告诉 google 任何问题，但再举一个例子：myspace 或记住牛奶。我喜欢记住牛奶，我认为这是一种企业产品。

我们的“项目队列”中有制作和离线应用程序，选项有：齿轮或空气，我们选择齿轮是因为我们认为您可以使用许多其他资源。像原型、jquery 等。这也是你应该考虑的事情。

# c# - 环境选择器

> ID：410961
> 
> 赞同：2
> 
> 时间：2009-01-04T13:13:32.710
> 
> 标签：c#, environment

dotnet 中是否有任何开源或使用环境选择器，它允许我简单地创建一组环境（无论这对我的应用程序意味着什么），然后在启动时有一个选择器。

构建一个简单的定制化并不难，但我想这在每家公司都会一遍又一遍地完成，所以想看看是否有一个放在一起。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-04T20:36:06.483

查看 app.config 文件。它们是包含用户或应用程序设置的 XML 文件。您将能够在编译时指定不同的应用程序（只读）设置。此外，您将能够在运行时指定用户设置。

我使用 app.config 文件来保存和加载诸如窗口位置和其他用户首选项之类的内容。我知道很多人在 app.config 中存储数据库连接字符串、文件路径等内容。

这是一个简单的[例子](http://geekswithblogs.net/akraus1/articles/64871.aspx)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-27T21:28:47.680

您极不可能找到这样的预构建功能，或者如果您确实找到了它会让您满意。

你可能会发现这个[答案](https://stackoverflow.com/questions/350377/deploy-an-app-config-based-on-build-configuration#350571)很相关。

底线：您可能会更快乐，并且发现自己构建起来会更快。

但是，有人刚刚提到了 Spring for .NET，您应该对此进行调查。

# windows - 如何防止 IE 在访问本地网站时使用我的 windows 身份？

> ID：410963
> 
> 赞同：1
> 
> 时间：2009-01-04T13:15:27.027
> 
> 标签：windows, internet-explorer

我正在 Windows Server 2008 上进行一些测试。

当我出于测试目的尝试访问 URL（例如 TFS Web 服务 URL）时，它会自动使用我的 Windows 身份（即管理员）

如何强制 IE 显示登录弹出窗口，以便我可以尝试使用“标准”用户登录？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-01-04T13:19:21.967

控制面板 - Internet 属性 - 安全设置 - 用户验证 - 登录 - 提示输入用户名和密码

# c# - 存储对象的 XML/CSV/其他表示的最佳位置是什么

> ID：410966
> 
> 赞同：3
> 
> 时间：2009-01-04T13:20:40.980
> 
> 标签：c#, .net, architecture

当一个对象具有各种格式（XML、CSV）时，它可以被表示，应该在哪里存储这些格式的知识。

对象是否应该知道它在 XML 中的表示方式（即让对象通过对象上的某种方法进行自我转换，例如`GetXML()`）。这对对象来说是否有太多的知识，是否应该将其存储在外部存储库/服务/其他层中？

如果它存储在存储库中，在对象的 XML 表示必须与其他信息一起保存到数据库的用例中会发生什么，例如：-

`insert into order values(1, '2004', <order><amount>2</amount><price>19.99</price></order>)`;

...对象的 XML 结构的知识将在 XML 存储库中，但是 SQL 存储库也需要这些知识，这似乎是重复的。

我不确定服务层是否也应该持有对象表示，因为这似乎不是业务逻辑。

这个用例的推荐实现是什么？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-01-04T15:03:36.030

一般来说，您希望对象的 XML（或其他...）格式化代码与对象本身分开。这样做的实际原因是希望有多个 XML 表示（比如摘要和详细表示）。如果这些方法包含对象 API 的所有部分，那么您将开始拥有：

```
public String GetShortXml(){ ... }
public String GetFullXml(){ ... }
public String GetCsv(){ ... }
public String GetJson(){ ... } 
```

作为每个单个业务对象的 API 的一部分，它很快就会变得丑陋。此外，这违反了[单一责任原则](http://en.wikipedia.org/wiki/Single_responsibility_principle)，因为每个类都负责 id 所做的事情以及将自己表示为 XML、JSON、CSV 等。

因此，最好有一个知道如何格式化您关心的业务对象的类，并拥有一个 SummaryXmlFormatter、DetailedXmlFormatter、CsvFormatter、JsonFormater 等。

你可以更进一步，让你的对象实现一个 IFormattable 接口（以下是对[访问者模式](http://en.wikipedia.org/wiki/Visitor_pattern)的改编，它为我们提供了双重调度优势）：

```
public interface IFormattable {
    public String Format(IFormatter formatter);
} 
```

实现如下：

```
public String Format(IFormatter formatter){
    return formatter.FormatBusinessObjectOne(this);
} 
```

使用这样定义的 IFormatter 接口：

```
public interface IFormatter{
    public String FormatBuisinessObjectOne(BusinessObjectOne boo);
    public String FormatBuisinessObjectTwo(BusinessObjectTwo bot);
    ...
} 
```

这将允许以多态方式分派您的格式化调用。根据您的要求，可能有用也可能没用（您是否曾经拥有不同类型的集合，因此需要多态调度或是否足够重载？）。

您对 format 的调用将如下所示：

```
IFormatter formatter = new XmlFormatter();
BusinessObjectOne boo = new BusinessObjectOne(...);

// With visitor like double dispatch
String xml = boo.Format(formatter);

// Without 
String xml = formatter.FormatBusinessObjectOne(boo);

// With overloading
String xml = formatter.Format(boo); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-04T15:36:07.540

你想在数据库中存储什么？

```
insert into order 
values(1, '2004', '<order><amount>2</amount><price>19.99</price></order>'); 
```

或者

```
insert into order values(1, '2004', 2, 19.99); 
```

?

# java - 如何获取已安装打印机的列表？

> ID：410967
> 
> 赞同：33
> 
> 时间：2009-01-04T13:21:22.523
> 
> 标签：java

我正在寻找获取已安装打印机列表的可能性。我正在使用带有 Windows 操作系统的 JDK 1.6。有谁知道解决方案？

先感谢您。

* * *

## 回答 #1

> 赞同：72
> 
> 时间：2009-01-04T13:45:36.547

只是想添加一个小片段：

```
import javax.print.*;

class Test {

    public static void main (String [] args)
    {
        PrintService[] printServices = PrintServiceLookup.lookupPrintServices(null, null);
        System.out.println("Number of print services: " + printServices.length);

        for (PrintService printer : printServices)
            System.out.println("Printer: " + printer.getName()); 
    }
} 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-01-04T13:28:59.280

我自己没有使用过这个，但可能[`javax.print.PrintServiceLookup`](http://java.sun.com/javase/6/docs/api/javax/print/PrintServiceLookup.html)包含您正在寻找的内容。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-01T10:09:10.787

更新较新的 Java 包

只需修改：

```
import javax.print.PrintService;

import javax.print.PrintServiceLookup; 
```

# c# - 以编程方式生成树视图节点

> ID：410978
> 
> 赞同：1
> 
> 时间：2009-01-04T13:35:00.437
> 
> 标签：c#, treeview

如何以编程方式为此集合生成树视图节点

```
node id          parent node id

-------          --------------

100                 null           //this is the root node

101                 100

123                 101

124                 101

126                 101

103                 100

104                 100

109                 100

128                 109

122                 100

127                 122

129                 127

130                 129 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-04T14:10:32.487

这是一些可能有助于您入门的伪代码

```
AddChildNodes(TreeNode parentNode)
{
   var childNodeIds GetChildNodeIds(parentNode.Id);
   foreach (int childNodeId in childNodeIds)
   {
      TreeNode childNode = new TreeNode();
      //set other properties...

      //add to parent          
      parentNode.Nodes.Add(childNode);

      //call same function recursively
      AddChildNodes(childNode);
   } 
```

}

然后在您的程序中，您首先获取所有没有父节点 ID（根节点）的项目，为它们创建一个节点，然后调用上面的递归函数。

# c - "#include" C 程序中的文本文件作为 char[]

> ID：410980
> 
> 赞同：149
> 
> 时间：2009-01-04T13:37:56.560
> 
> 标签：c, include, c-preprocessor

有没有办法在编译时将整个文本文件作为字符串包含在 C 程序中？

就像是：

*   文件.txt：

    ```
    This is
    a little
    text file 
    ```

*   主.c：

    ```
    #include <stdio.h>
    int main(void) {
       #blackmagicinclude("file.txt", content)
       /*
       equiv: char[] content = "This is\na little\ntext file";
       */
       printf("%s", content);
    } 
    ```

获得一个在标准输出上打印的小程序“这是一个小文本文件”

目前我使用了一个 hackish python 脚本，但它很丑陋，并且仅限于一个变量名，你能告诉我另一种方法吗？

* * *

## 回答 #1

> 赞同：148
> 
> 时间：2009-01-04T13:56:22.530

我建议为此使用 (unix util) [xxd](http://www.manpagez.com/man/1/xxd/)。你可以像这样使用它

```
$ echo hello world > a
$ xxd -i a 
```

输出：

```
unsigned char a[] = {
  0x68, 0x65, 0x6c, 0x6c, 0x6f, 0x20, 0x77, 0x6f, 0x72, 0x6c, 0x64, 0x0a
};
unsigned int a_len = 12; 
```

* * *

## 回答 #2

> 赞同：124
> 
> 时间：2014-07-29T17:32:52.093

问题是关于 C 的，但如果有人试图用 C++11 来做，那么由于新的[原始字符串文字](http://www.stroustrup.com/C++11FAQ.html#raw-strings)，只需对包含的文本文件进行少量更改即可完成：

在 C++ 中这样做：

```
const char *s =
#include "test.txt"
; 
```

在文本文件中执行以下操作：

```
R"(Line 1
Line 2
Line 3
Line 4
Line 5
Line 6)" 
```

所以文件的顶部必须只有一个前缀，文件末尾有一个后缀。在它之间你可以做你想做的事，只要你不需要字符序列就不需要特殊的转义`)"`。但是，如果您指定自己的自定义分隔符，即使这样也可以工作：

```
R"=====(Line 1
Line 2
Line 3
Now you can use "( and )" in the text file, too.
Line 5
Line 6)=====" 
```

* * *

## 回答 #3

> 赞同：15
> 
> 时间：2017-12-13T19:52:40.907

我喜欢kayahr的回答。**但是，如果您不想触摸输入文件**，并且使用的是**CMake**，则可以在文件上添加分隔符字符序列。例如，以下 CMake 代码复制输入文件并相应地包装其内容：

```
function(make_includable input_file output_file)
    file(READ ${input_file} content)
    set(delim "for_c++_include")
    set(content "R\"${delim}(\n${content})${delim}\"")
    file(WRITE ${output_file} "${content}")
endfunction(make_includable)

# Use like
make_includable(external/shaders/cool.frag generated/cool.frag) 
```

然后像这样包含在c ++中：

```
constexpr char *test =
#include "generated/cool.frag"
; 
```

* * *

## 回答 #4

> 赞同：14
> 
> 时间：2009-01-04T13:57:55.930

你有两种可能：

1.  利用编译器/链接器扩展将文件转换为二进制文件，并使用适当的符号指向二进制数据的开头和结尾。请参阅此答案：[Include binary file with GNU ld linker script](https://stackoverflow.com/questions/327609/include-binary-file-with-gnu-ld-linker-script)。
2.  将您的文件转换为可以初始化数组的字符常量序列。请注意，您不能只执行 "" 并跨越多行。您将需要一个续行字符 ( `\`)、转义`"`字符和其他字符来完成这项工作。更容易编写一个小程序来将字节转换为类似的序列`'\xFF', '\xAB', ...., '\0'`（或者使用另一个答案描述的 unix 工具`xxd`，如果你有它可用的话！）：

代码：

```
#include <stdio.h>

int main() {
    int c;
    while((c = fgetc(stdin)) != EOF) {
        printf("'\\x%X',", (unsigned)c);
    }
    printf("'\\0'"); // put terminating zero
} 
```

（未测试）。然后做：

```
char my_file[] = {
#include "data.h"
}; 
```

其中 data.h 由

```
cat file.bin | ./bin2c > data.h 
```

* * *

## 回答 #5

> 赞同：9
> 
> 时间：2009-01-04T21:33:40.860

好的，受[Daemin](https://stackoverflow.com/questions/410980/include-a-text-file-in-a-c-program-as-a-char#410988)帖子的启发，我测试了以下简单示例：

a.数据：

```
"this is test\n file\n" 
```

测试.c：

```
int main(void)
{
    char *test = 
#include "a.data"
    ;
    return 0;
} 
```

gcc -E test.c 输出：

```
# 1 "test.c"
# 1 "<built-in>"
# 1 "<command line>"
# 1 "test.c"

int main(void)
{
    char *test =
# 1 "a.data" 1
"this is test\n file\n"
# 6 "test.c" 2
    ;
    return 0;
} 
```

所以它可以工作，但需要用引号括起来的数据。

* * *

## 回答 #6

> 赞同：8
> 
> 时间：2017-09-14T14:37:24.803

您可以使用以下方法执行此操作`objcopy`：

```
objcopy --input binary --output elf64-x86-64 myfile.txt myfile.o 
```

现在你有了一个目标文件，你可以链接到你的可执行文件中，其中包含了内容的开始、结束和大小的符号`myfile.txt`。

* * *

## 回答 #7

> 赞同：6
> 
> 时间：2019-03-04T01:39:37.950

如果您愿意使用一些肮脏的技巧，您可以使用原始字符串文字和`#include`某些类型的文件来发挥创意。

例如，假设我想在我的项目中包含一些 SQLite 的 SQL 脚本，并且我想获得语法高亮但不想要任何特殊的构建基础设施。我可以拥有这个`test.sql`对 SQLite 有效的 SQL 文件，其中`--`开始注释：

```
--x, R"(--
SELECT * from TestTable
WHERE field = 5
--)" 
```

然后在我的 C++ 代码中，我可以拥有：

```
int main()
{
    auto x = 0;
    const char* mysql = (
#include "test.sql"
    );

    cout << mysql << endl;
} 
```

输出是：

```
--
SELECT * from TestTable
WHERE field = 5
-- 
```

或者从`test.py`一个有效的 Python 脚本文件中包含一些 Python 代码（因为`#`在 Python 中开始注释并且`pass`是无操作的）：

```
#define pass R"(
pass
def myfunc():
    print("Some Python code")

myfunc()
#undef pass
#define pass )"
pass 
```

然后在 C++ 代码中：

```
int main()
{
    const char* mypython = (
#include "test.py"
    );

    cout << mypython << endl;
} 
```

这将输出：

```
pass
def myfunc():
    print("Some Python code")

myfunc()
#undef pass
#define pass 
```

对于您可能希望包含为字符串的各种其他类型的代码，应该可以使用类似的技巧。我不确定这是否是个好主意。这是一种巧妙的技巧，但可能不是您在实际生产代码中想要的东西。不过对于周末的黑客项目来说可能没问题。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2012-12-10T03:48:42.420

您需要我的`xtr`实用程序，但您可以使用`bash script`. 这是我调用的脚本`bin2inc`。第一个参数是结果的名称`char[] variable`。第二个参数是名称`file`。输出是 C `include file`，文件内容编码（小写`hex`）作为给定的变量名。`char array`是, 数据的`zero terminated`长度存放在`$variableName_length`

```
#!/bin/bash

fileSize ()

{

    [ -e "$1" ]  && {

        set -- `ls -l "$1"`;

        echo $5;

    }

}

echo unsigned char $1'[] = {'
./xtr -fhex -p 0x -s ', ' < "$2";
echo '0x00'
echo '};';
echo '';
echo unsigned long int ${1}_length = $(fileSize "$2")';' 
```

**[您可以在此处获取 XTR](http://pastebin.com/67H6Us9V) xtr（字符 eXTRapolator）是 GPLV3**

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2014-09-11T05:24:18.297

为什么不将文本链接到程序中并将其用作全局变量！[这是一个例子。](http://www.linuxjournal.com/content/embedding-file-executable-aka-hello-world-version-5967)我正在考虑使用它在可执行文件中包含 Open GL 着色器文件，因为需要在运行时为 GPU 编译 GL 着色器。

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2017-10-10T14:46:10.173

我在 python3 中重新实现了 xxd，修复了 xxd 的所有烦恼：

*   常量正确性
*   字符串长度数据类型：int → size_t
*   空终止（如果您可能需要）
*   C 字符串兼容：`unsigned`放在数组上。
*   更小的，可读的输出，就像你写的那样：Printable ascii is output as-is; 其他字节是十六进制编码的。

这是脚本，它自己过滤，所以你可以看到它的作用：

pyxxd.c

```
#include <stddef.h>

extern const char pyxxd[];
extern const size_t pyxxd_len;

const char pyxxd[] =
"#!/usr/bin/env python3\n"
"\n"
"import sys\n"
"import re\n"
"\n"
"def is_printable_ascii(byte):\n"
"    return byte >= ord(' ') and byte <= ord('~')\n"
"\n"
"def needs_escaping(byte):\n"
"    return byte == ord('\\\"') or byte == ord('\\\\')\n"
"\n"
"def stringify_nibble(nibble):\n"
"    if nibble < 10:\n"
"        return chr(nibble + ord('0'))\n"
"    return chr(nibble - 10 + ord('a'))\n"
"\n"
"def write_byte(of, byte):\n"
"    if is_printable_ascii(byte):\n"
"        if needs_escaping(byte):\n"
"            of.write('\\\\')\n"
"        of.write(chr(byte))\n"
"    elif byte == ord('\\n'):\n"
"        of.write('\\\\n\"\\n\"')\n"
"    else:\n"
"        of.write('\\\\x')\n"
"        of.write(stringify_nibble(byte >> 4))\n"
"        of.write(stringify_nibble(byte & 0xf))\n"
"\n"
"def mk_valid_identifier(s):\n"
"    s = re.sub('^[^_a-z]', '_', s)\n"
"    s = re.sub('[^_a-z0-9]', '_', s)\n"
"    return s\n"
"\n"
"def main():\n"
"    # `xxd -i` compatibility\n"
"    if len(sys.argv) != 4 or sys.argv[1] != \"-i\":\n"
"        print(\"Usage: xxd -i infile outfile\")\n"
"        exit(2)\n"
"\n"
"    with open(sys.argv[2], \"rb\") as infile:\n"
"        with open(sys.argv[3], \"w\") as outfile:\n"
"\n"
"            identifier = mk_valid_identifier(sys.argv[2]);\n"
"            outfile.write('#include <stddef.h>\\n\\n');\n"
"            outfile.write('extern const char {}[];\\n'.format(identifier));\n"
"            outfile.write('extern const size_t {}_len;\\n\\n'.format(identifier));\n"
"            outfile.write('const char {}[] =\\n\"'.format(identifier));\n"
"\n"
"            while True:\n"
"                byte = infile.read(1)\n"
"                if byte == b\"\":\n"
"                    break\n"
"                write_byte(outfile, ord(byte))\n"
"\n"
"            outfile.write('\";\\n\\n');\n"
"            outfile.write('const size_t {}_len = sizeof({}) - 1;\\n'.format(identifier, identifier));\n"
"\n"
"if __name__ == '__main__':\n"
"    main()\n"
"";

const size_t pyxxd_len = sizeof(pyxxd) - 1; 
```

用法（这会提取脚本）：

```
#include <stdio.h>

extern const char pyxxd[];
extern const size_t pyxxd_len;

int main()
{
    fwrite(pyxxd, 1, pyxxd_len, stdout);
} 
```

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2020-12-06T09:47:28.740

这是我用于 Visual C++ 的 hack。我添加了以下 Pre-Build Event（其中 file.txt 是输入，file_txt.h 是输出）：

```
@(
  echo const char text[] = R"***(
  type file.txt
  echo ^^^)***";
) > file_txt.h 
```

然后我在需要的地方包含 file_txt.h。

这并不完美，因为它在开头添加 \n 并在结尾添加 \n^，但这不是处理问题，我喜欢这个解决方案的简单性。如果任何人都可以改进以消除多余的字符，那就太好了。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2009-01-04T13:45:10.837

如果您执行以下操作，**可能会起作用：**

```
int main()
{
    const char* text = "
#include "file.txt"
";
    printf("%s", text);
    return 0;
} 
```

当然，您必须**小心文件中的实际内容**，确保没有双引号，所有适当的字符都被转义等。

因此，如果您**只是在运行时从文件中加载文本**，或者将文本直接嵌入到代码中，可能会更容易。

如果你仍然想要另一个文件中的文本，你可以把它放在那里，但它必须在那里表示为一个字符串。您将使用上面的代码，但其中没有双引号。例如：

文件.txt

```
"Something evil\n"\
"this way comes!" 
```

主文件

```
int main()
{
    const char* text =
#include "file.txt"
;
    printf("%s", text);
    return 0;
} 
```

所以基本上在你包含的文本文件中有一个 C 或 C++ 样式的字符串。它会使代码更整洁，因为文件开头没有这么多的文本。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2009-01-04T13:54:40.070

即使它可以在编译时完成（我认为一般来说不能），文本也可能是预处理的标题而不是文件内容。我希望您必须在运行时从文件中加载文本或执行令人讨厌的剪切粘贴工作。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2013-04-13T16:36:21.167

Hasturkun 使用 xxd -i 选项的答案非常好。如果您想将转换过程（文本 -> 十六进制包含文件）直接合并到您的构建中，则 hexdump.c 工具/库最近添加了类似于 xxd 的 -i 选项的功能（它不会为您提供完整的标题 - 您需要提供 char 数组定义 - 但这样做的好处是可以让您选择 char 数组的名称）：

[http://25thandclement.com/~william/projects/hexdump.c.html](http://25thandclement.com/~william/projects/hexdump.c.html)

它的许可证比 xxd 更“标准”并且非常自由 - 使用它在程序中嵌入 init 文件的示例可以在此处的 CMakeLists.txt 和 scheme.c 文件中看到：

[https://github.com/starseeker/tinyscheme-cmake](https://github.com/starseeker/tinyscheme-cmake)

将生成的文件包含在源代码树和捆绑实用程序中都有利有弊 - 如何处理它取决于项目的特定目标和需求。hexdump.c 为这个应用程序打开了捆绑选项。

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2014-04-15T13:59:29.057

我认为单独使用编译器和预处理器是不可能的。gcc 允许这样做：

```
#define _STRGF(x) # x
#define STRGF(x) _STRGF(x)

    printk ( MODULE_NAME " built " __DATE__ " at " __TIME__ " on host "
            STRGF(
#               define hostname my_dear_hostname
                hostname
            )
            "\n" ); 
```

但不幸的是不是这样：

```
#define _STRGF(x) # x
#define STRGF(x) _STRGF(x)

    printk ( MODULE_NAME " built " __DATE__ " at " __TIME__ " on host "
            STRGF(
#               include "/etc/hostname"
            )
            "\n" ); 
```

错误是：

```
/etc/hostname: In function ‘init_module’:
/etc/hostname:1:0: error: unterminated argument list invoking macro "STRGF" 
```

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2017-03-30T22:41:42.603

我有类似的问题，对于小文件，上述 Johannes Schaub 的解决方案对我来说就像一个魅力。

但是，对于稍大一些的文件，它会遇到编译器的字符数组限制问题。因此，我编写了一个小型编码器应用程序，将文件内容转换为大小相等的块（可能还有填充零）的二维字符数组。它生成带有二维数组数据的输出文本文件，如下所示：

```
const char main_js_file_data[8][4]= {
    {'\x69','\x73','\x20','\0'},
    {'\x69','\x73','\x20','\0'},
    {'\x61','\x20','\x74','\0'},
    {'\x65','\x73','\x74','\0'},
    {'\x20','\x66','\x6f','\0'},
    {'\x72','\x20','\x79','\0'},
    {'\x6f','\x75','\xd','\0'},
    {'\xa','\0','\0','\0'}}; 
```

其中 4 实际上是编码器中的变量 MAX_CHARS_PER_ARRAY。带有生成的 C 代码的文件（例如“main_js_file_data.h”）可以轻松内联到 C++ 应用程序中，例如：

```
#include "main_js_file_data.h" 
```

这是编码器的源代码：

```
#include <fstream>
#include <iterator>
#include <vector>
#include <algorithm>

#define MAX_CHARS_PER_ARRAY 2048

int main(int argc, char * argv[])
{
    // three parameters: input filename, output filename, variable name
    if (argc < 4)
    {
        return 1;
    }

    // buffer data, packaged into chunks
    std::vector<char> bufferedData;

    // open input file, in binary mode
    {    
        std::ifstream fStr(argv[1], std::ios::binary);
        if (!fStr.is_open())
        {
            return 1;
        }

        bufferedData.assign(std::istreambuf_iterator<char>(fStr), 
                            std::istreambuf_iterator<char>()     );
    }

    // write output text file, containing a variable declaration,
    // which will be a fixed-size two-dimensional plain array
    {
        std::ofstream fStr(argv[2]);
        if (!fStr.is_open())
        {
            return 1;
        }
        const std::size_t numChunks = std::size_t(std::ceil(double(bufferedData.size()) / (MAX_CHARS_PER_ARRAY - 1)));
        fStr << "const char " << argv[3] << "[" << numChunks           << "]"    <<
                                            "[" << MAX_CHARS_PER_ARRAY << "]= {" << std::endl;
        std::size_t count = 0;
        fStr << std::hex;
        while (count < bufferedData.size())
        {
            std::size_t n = 0;
            fStr << "{";
            for (; n < MAX_CHARS_PER_ARRAY - 1 && count < bufferedData.size(); ++n)
            {
                fStr << "'\\x" << int(unsigned char(bufferedData[count++])) << "',";
            }
            // fill missing part to reach fixed chunk size with zero entries
            for (std::size_t j = 0; j < (MAX_CHARS_PER_ARRAY - 1) - n; ++j)
            {
                fStr << "'\\0',";
            }
            fStr << "'\\0'}";
            if (count < bufferedData.size())
            {
                fStr << ",\n";
            }
        }
        fStr << "};\n";
    }

    return 0;
} 
```

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2019-12-02T21:29:18.320

这个问题让我很恼火，并且 xxd 不适用于我的用例，因为当我尝试编写脚本时它使变量称为 __home_myname_build_prog_cmakelists_src_autogen 之类的东西，所以我制作了一个实用程序来解决这个确切的问题：

[https://github.com/Exaeta/brcc](https://github.com/Exaeta/brcc)

它生成一个源文件和头文件，并允许您显式设置每个变量的名称，以便您可以通过 std::begin(arrayname) 和 std::end(arrayname) 使用它们。

我将它合并到我的 cmake 项目中，如下所示：

```
add_custom_command(
  OUTPUT ${CMAKE_CURRENT_BINARY_DIR}/binary_resources.hpp ${CMAKE_CURRENT_BINARY_DIR}/binary_resources.cpp
  COMMAND brcc ${CMAKE_CURRENT_BINARY_DIR}/binary_resources RGAME_BINARY_RESOURCES_HH txt_vertex_shader ${CMAKE_CURRENT_BINARY_DIR}/src/vertex_shader1.glsl
  DEPENDS src/vertex_shader1.glsl) 
```

通过小的调整，我想它也可以适用于 C。

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2020-11-04T00:04:12.427

如果您正在使用`CMake`，您可能对编写`CMake`如下预处理脚本感兴趣：

**cmake/ConvertLayout.cmake**

```
function(convert_layout file include_dir)
    get_filename_component(name ${file} NAME_WE)
    get_filename_component(directory ${file} DIRECTORY)
    get_filename_component(directory ${directory} NAME)
    string(TOUPPER ${name} NAME)
    string(TOUPPER ${directory} DIRECTORY)

    set(new_file ${include_dir}/${directory}/${name}.h)

    if (${file} IS_NEWER_THAN  ${new_file})
        file(READ ${file} content)

        string(REGEX REPLACE "\"" "\\\\\"" content "${content}")
        string(REGEX REPLACE "[\r\n]" "\\\\n\"\\\\\n\"" content "${content}")
        set(content "\"${content}\"")
        set(content "#ifndef ${DIRECTORY}_${NAME}\n#define ${DIRECTORY}_${NAME} ${content} \n#endif")
        message(STATUS "${content}")

        file(WRITE ${new_file} "${content}")

        message(STATUS "Generated layout include file ${new_file} from ${file}")
    endif()
endfunction()

function(convert_layout_directory layout_dir include_dir)
    file(GLOB layouts ${layout_dir}/*)
    foreach(layout ${layouts})
        convert_layout(${layout} ${include_dir})
    endforeach()
endfunction() 
```

**你的 CMakeLists.txt**

```
include(cmake/ConvertLayout.cmake)
convert_layout_directory(layout ${CMAKE_BINARY_DIR}/include)
include_directories(${CMAKE_BINARY_DIR}/include) 
```

**在 C++ 中的某个地方**

```
#include "layout/menu.h"
Glib::ustring ui_info = LAYOUT_MENU; 
```

* * *

## 回答 #19

> 赞同：0
> 
> 时间：2021-11-21T20:45:38.403

我喜欢@Martin R. 的回答，因为正如它所说，它不会触及输入文件并使过程自动化。为了改进这一点，我添加了自动拆分超出编译器限制的大文件的功能。输出文件被写成一个较小的字符串数组，然后可以在代码中重新组合。生成的脚本基于@Martin R. 的版本，此处包含一个示例：

[https://github.com/skillcheck/cmaketools.git](https://github.com/skillcheck/cmaketools.git)

相关的 CMake 设置是：

```
make_includable( LargeFile.h
    ${CMAKE_CURRENT_BINARY_DIR}/generated/LargeFile.h
    "c++-include" "L" LINE_COUNT FILE_SIZE
) 
```

那么源代码是：

```
static std::vector<std::wstring> const chunks = {
#include "generated/LargeFile.h"
};

std::string contents =
    std::accumulate( chunks.begin(), chunks.end(), std::wstring() ); 
```

* * *

## 回答 #20

> 赞同：0
> 
> 时间：2022-02-07T18:50:50.640

您可以为此使用程序集：

```
asm("fileData:    .incbin \"filename.ext\"");
asm("fileDataEnd: db 0x00");

extern char fileData[];
extern char fileDataEnd[];
const int fileDataSize = fileDataEnd - fileData + 1; 
```

* * *

## 回答 #21

> 赞同：-1
> 
> 时间：2009-01-04T21:58:26.693

在 xh

```
"this is a "
"buncha text" 
```

在 main.c

```
#include <stdio.h>
int main(void)
{
    char *textFileContents =
#include "x.h"
    ;

    printf("%s\n", textFileContents);

    return 0
} 
```

应该做的工作。

# c++ - 在编译 boost 时定义 BOOST_DISABLE_ABI_HEADERS 会带来什么危害？

> ID：410981
> 
> 赞同：0
> 
> 时间：2009-01-04T13:38:21.740
> 
> 标签：c++, boost, packing, bjam

在编译 boost 时定义 BOOST_DISABLE_ABI_HEADERS 会带来什么危害？

从升压文件：boost_1_37_0\boost\config\user.hpp

```
// BOOST_DISABLE_ABI_HEADERS: Stops boost headers from including any 
// prefix/suffix headers that normally control things like struct 
// packing and alignment. 
//#define BOOST_DISABLE_ABI_HEADERS 
```

为什么 boost 觉得需要控制结构的打包和对齐？

它可能与提升序列化并确保它在所有平台上都相同吗？如果我只运行 Windows，我可以安全地定义它吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-04T13:46:13.177

该定义确保 ABI（[应用程序二进制接口](http://en.wikipedia.org/wiki/Application_binary_interface)）在版本和编译器之间保持兼容。没有它，您的应用程序将无法使用由另一个应用程序安装的 boost dll（可能是使用与您不同的编译器编译的）。

如果您要静态链接到 boost，或者如果您可以确保您的应用程序只使用您自己编译的 boost dll，那么是的，您可以安全地定义它。但是，如果你不能保证，你就不能定义它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-04T14:11:42.423

这是我在 Boost 文档中可以找到的内容：http: [//www.boost.org/doc/libs/1_31_0/libs/config/config.htm](http://www.boost.org/doc/libs/1_31_0/libs/config/config.htm)

这是一个相当旧的版本，但大概，#define 的含义没有改变。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-04T15:08:32.230

下面是定义 BOOST_DISABLE_ABI_HEADERS 的概要：

*   如果你使用一些共享的 boost dll，你会得到未定义的行为
*   如果您静态链接到您的 boost 库，或者您确定您只使用自己的 dll，那么您可能是安全的，请继续阅读我为什么说可能。
*   如果您在项目中的多个 .lib 中使用 boost，它们都必须具有相同的编译器设置，因为编译器设置的更改会使打包和对齐方式不同。
*   我怀疑不同操作系统和平台（x86 与 x64）之间的兼容性可能不适用于提升序列化之类的东西。

总的来说，定义它不是很安全，而不管它更安全。

# iphone - iPhone上的“unsigned int”和“int”在性能方面有区别吗？

> ID：410982
> 
> 赞同：5
> 
> 时间：2009-01-04T13:40:28.740
> 
> 标签：iphone, objective-c, performance

或者重新提出问题：使用无符号值是否会降低性能？

总的来说：iPhone ARM 处理器上性能最高的类型（16 位签名？、32 位签名？等）是什么？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-01-04T14:08:43.973

C99 标准允许您回答一般问题；目标系统上超过特定所需宽度的最快类型在`stdint.h`. 想象一下，我至少需要一个 8 位宽的整数：

```
#include <stdio.h>
#include <stdint.h>

int main (int argc, char **argv)
{
    uint_fast8_t i;
    printf("Width of uint_fast8_t is %d\n", sizeof(i));
    return 0;
} 
```

关于有符号或无符号的使用，除了性能之外还有其他要求，比如你是否真的需要使用无符号类型，或者你想在溢出的情况下发生什么。鉴于我对自己的代码的了解，我敢打赌，除了原始整数类型的选择之外，您的代码中还有其他的减速；-)。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2009-01-04T14:18:33.110

它总是取决于：

对于循环，有符号整数作为计数器和限制要快一点，因为在 C 中，编译器可以自由地假设不会发生溢出。

考虑一下：您有一个带有无符号循环计数器的循环，如下所示：

```
void function (unsigned int first, unsigned int last)
{
  unsigned int i;
  for (i=first; i!=last; i++)
  {
     // do something here...
  }
} 
```

在这个循环中，编译器必须确保即使 first 大于 last 循环也会终止，因为我会在溢出时从 UINT_MAX 换行到 0（仅举一个例子 - 还有其他情况）。这消除了一些循环优化的机会。使用带符号的循环计数器，编译器假定不会发生回绕，并且*可能会*生成更好的代码。

对于整数除法，无符号整数在 ARM 上要快一点。ARM 没有硬件除法单元，因此除法是在软件中完成的，并且总是在无符号值上完成。您将为将有符号除法转换为无符号除法所需的额外代码节省一些周期。

对于算术、逻辑、加载和写入内存等所有其他事情，符号的选择不会有**任何**区别。

* * *

关于数据大小：正如 Rune 指出的那样，它们或多或少具有相同的速度，32 位类型是最快的。字节和字有时需要在处理后进行调整，因为它们驻留在 32 位寄存器中，并且高位（未使用）位需要进行符号或零扩展。

但是，ARM CPU 的数据缓存相对较小，并且通常连接到相对较慢的内存。如果您能够通过选择较小的数据类型来更有效地利用缓存，那么即使理论上的循环计数上升，代码也可能执行得更快。

你必须在这里进行实验。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-01-04T16:47:09.580

ARM 是 32 位架构，因此 32 位整数是最快的。但是，16 位整数和 8 位整数只是稍微慢一些。签名与未签名无关紧要，除非在特殊情况下（如此处的其他答案所述）。64 位整数将由两个或更多 32 位操作模拟，因此速度较慢。

在浮点类型方面，在 iPhone 处理器（ARM11 与 VFP 硬件浮点）中，32 位浮点数比 64 位双精度浮点数要快一些。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-01-04T15:59:19.163

*我对尼尔斯的回答很好奇，所以这些问题都是针对他的。这不是对原始问题的回答。*

> 在这个循环中，编译器必须确保如果 first 大于 last 循环甚至终止，因为我会在溢出时从 UINT_MAX 换行到 0

```
 for (i=first; i!=last; i++)
  {
     // do something here...
  } 
```

我认为不会。编译器只需要`i!=last`在每次循环迭代开始时检查：

```
i=first;
if (i == last) goto END;
START:
// do sth
++i;
if (i != last) goto START;
END: 
```

变量的符号不会改变代码，所以我认为这个例子是错误的。我什至用 msvc08/release 编译了代码并比较了汇编程序的结果——在所有有符号/无符号和 !=/< 组合中基本相同（除了跳转类型）。

现在，我确实同意编译器在某些情况下可以优化代码，但我想不出任何好的例子——如果有人可以，请回复。

我只能想到一个“坏”的例子：

```
signed i, j, k;
if (i > k)
{
  i += j;
  if (i > k)
  {
  }
} 
```

可能溢出，但有符号溢出在 C 中是未定义的`i+= j`，所以一切都会发生。可能会发生两件事：

*   编译器可以假设有符号溢出到 INT_MIN
*   编译器还不如说这是未定义的行为，所有依赖于它的代码都有未定义的行为，让我们将未定义定义为“它永远不会发生”，如果完全删除第二个。当然，代码更少，因此代码被“优化”了。

正如我所说，我确信 Nils 指出可能存在合法的优化，但据我所知，发布的循环不在其中。

至于原来的问题：

*   使用 typedef
*   测试 ：）

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-01-12T02:12:28.523

由于 unsigned 和 signed int 具有相同的大小和基本相同的性能，因此在此阶段担心任何可能的此类优化（如果可能，但不是）是邪恶的过早优化（在 Google 上搜索以了解更多信息） )，即使在 iPhone 上也是如此。关于正确性和思想经济性的争论是第一位的，除非这是您最重要的执行热点并且您已经测量了实际显着的性能差异。否则，这只是浪费您本可以通过其他方式获得 2 倍加速的时间。

* * *

编辑：确实，有符号溢出的行为是未定义的，编译器可以（现在确实）利用它进行优化，正如 Hrvoje Prgeša 在他的回答中和@martinkunev 在他的评论中所指出的那样。

# .net - 如何制作动态智能的地址和时区联系表

> ID：410986
> 
> 赞同：0
> 
> 时间：2009-01-04T13:44:44.177
> 
> 标签：.net, contact

Microsoft 的实时服务在其“帐户”>“注册信息”页面中有一个惊人的联系方式表格。首先会询问您所在的国家/地区，然后联系表的其余部分会相应更改。例如，如果您选择“美国”，表单字段将更改为：地址 1、地址 2、城市、州（美国各州的下拉菜单）、邮政编码、时区（用户中美国时区的下拉菜单） - 友好的形式，例如“东部时间 (EST)”）。

如果您选择“英国”，表单字段将更改为：地址 1、地址 2、地址 3、第二城市、城市、国家/地区、邮政编码、组成国家（下拉）和时区（下拉）。

此联系表单提供了我在联系表单中遇到的最佳用户体验（我可能在这里过于敏感，但增强的用户体验让我兴奋，我想为我的用户提供相同的体验）。

有没有办法使用 VS 2008/.NET 3.5 创建这样的表单？是否有合法的方式来获取他们的信息数据库？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-01-04T14:44:48.313

关于获取他们的数据库，我不确定。也许这在某处被编目，每个国家通常使用哪些字段。

在为不同的国家/地区实施这种不同的形式时，有一些解决方案。一种是拥有不同的用户控件或自定义控件，每个国家/地区都需要提供不同的表单。这些用户控件中的每一个都是一个表单，带有文本框等，并且知道如何保存其数据。

另一种方法是在某种存储库（数据库、xml 文件等）中拥有该信息（哪个国家/地区需要哪种类型的控件和标签）并动态创建这些表单。

不过，这可能会变得非常复杂并且“元”非常快，因此这是一个问题，即您希望它在成本/收益方面有多复杂。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-04T14:55:49.353

在使用过类似“技巧”的系统后，大部分时间它是基于可以通过细致搜索获得的信息，或者可以从政府机构以少量费用购买的信息。例如，我使用的一个系统有一个方便的功能，如果您输入美国地址的邮政编码，它会从从美国邮政服务购买的列表中填充的数据库表中查找值。

就他们在 Windows Live 帐户页面上的内容而言，我猜想这与此类似。他们只是建立了国家与城市之间的关系，等等。如果有这样的模型供人们使用，那就太好了，但据我所知，它已针对每个应用程序进行了重新设计。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-04T15:17:45.673

大多数地址数据分解为世界上任何地方的类似信息——巧妙的技巧是将其标记为目的地区域设置（“邮政编码”与“邮政编码”）并隐藏不敬的字段的 UI（“组成国家”例如，对卢森堡来说意义不大）。

制定“相关”领域/等。[并且在您的代码中为每个国家](http://www.upu.int/post_code/en/postal_addressing_systems_member_countries.shtml)/地区建立交叉引用应该是相对微不足道的

# django - django解决url中特殊字符的问题

> ID：410993
> 
> 赞同：7
> 
> 时间：2009-01-04T13:46:43.253
> 
> 标签：django, django-urls

我们有一个由 Django 制作的网站。在本地工作环境访问以下网址时没有问题：

```
http://site/tags/c%23/ 
```

"c%23" 是 "c#" 的 urlencode，在本地运行良好。但是在我们将它部署在 Bluehost 托管服务器（apache+fastcgi）上之后，这个 URL 已经被解析为一个新地址，如下所示：

```
http://site/t/tags/c/ 
```

这太奇怪了。可能不是Django的问题，而是与Apache url的重写有关。如果您对如何解决此问题有任何想法或建议，请告诉我。提前致谢。

这是可以考虑的.htaccess文件：

```
AddHandler fcgid-script .fcgi 
#AddHandler fastcgi-script .fcgi 
#AddHandler application/cgi .fcgi 
#AddHandler cgi-script .fcgi 
RewriteEngine On 
RewriteBase / 
#static file setting 
RewriteRule ^(media/.*)$ - [L] 
RewriteRule ^(static/.*)$ - [L] 
RewriteCond %{REQUEST_URI} !(dispatch.fcgi) 
RewriteRule ^(.*)$ dispatch.fcgi/$1 [L] 
```

和 dispatch.fcgi 文件：

```
#!/home/***/python/bin/python 
import sys, os 
# Add a custom Python path. 
sys.path.insert(0, "/home/***/python") 
sys.path.insert(0, "/home/***/working/Django-1.0") 
os.chdir("/home/***/working/Django-1.0/project") 
os.environ['DJANGO_SETTINGS_MODULE'] = "project.settings" 
from django.core.servers.fastcgi import runfastcgi 
runfastcgi(["method=threaded", "daemonize=false"]) 
```

**UPDAET：**如果这是由 httpd.conf 中的设置引起的，我如何在没有权限的情况下覆盖 .htaccess 文件？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-01-04T16:29:10.787

在继续之前只是一些提示：

您是否尝试过使用其他字符，例如空格 (%20) 或重音 ASCII 字符？另外，您是否尝试在 %23 之后放置其他字符（斜杠除外）以查看它们是否也被剥离？

一种猜测可能是，由于 # 被视为当前页面上的锚点，因此 # 以及之后的任何内容都将在重写中被剥离。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-23T18:50:07.823

我必须同意第一个答案 - 如果无法访问 apache 配置，您可能会不走运。使用“CSharp”或类似的东西可能是要走的路。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-19T14:23:44.427

# 在 URI 中具有特殊含义，与 / 或 ? 做。您是否对其他符号有此问题？最终，您不应该在 URI 中使用 # 符号，除非您指的是页面上的锚点。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-24T13:01:58.410

[http://httpd.apache.org/docs/2.2/rewrite/rewrite_guide.html](http://httpd.apache.org/docs/2.2/rewrite/rewrite_guide.html)

阅读锚重写部分。

# https - 客户端防火墙阻止除 80 和 443 以外的所有端口，需要将端口 443 上的请求转发到 SSH 或 HTTPS

> ID：410995
> 
> 赞同：5
> 
> 时间：2009-01-04T13:47:28.197
> 
> 标签：https, ssh, firewall, port, forwarding

我目前在一个客户端工作，他们已经锁定了网络，除了端口 80 和 443。我需要使用 SSH 连接到我们的服务器，但同一台服务器也运行我们的网站。我们不想投资新服务器或放置第二张网卡。

我一直在互联网上搜索以设置我们的 linux 服务器（运行 CentOS 5），以便在端口 443 上侦听一个守护进程，该守护进程根据客户端协议将请求转发到正确的内部端口（SSH 22 或 HTTPS 移动到一个不同的端口_。

互联网上有很多人在寻找这种解决方案，但没有明确的说明如何做到这一点。

任何人都有想法/明确的说明如何做到这一点？

问候，尼德基尔

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-01-05T13:23:47.883

sslh：[http ://www.rutschle.net/tech/sslh.shtml](http://www.rutschle.net/tech/sslh.shtml)

我正在使用 1.5；我还没试过1.6b，1.3有一个问题，就是让僵尸到处乱跑。

在端口 443 上运行它；如果 2 秒（默认）没有发送数据，它会转发到 ssh。否则，它会转发到您的 Web 服务器。

我在我的网站 ( [http://mikeage.net](http://mikeage.net) ) 上运行它——如果你想看到两个登录横幅，你可以 netcat in。

就我而言，它还有另一个目的。我们的设置比您更严格：所有端口都被阻止，但可以通过代理访问 80 和 443。我可以让 SSH 使用类似 corkscrew（或本地 putty）的程序通过公司代理将我的 SSH 连接代理到我的服务器：443，在短暂延迟后，我的 SSH 服务器用它的登录横幅响应。我还可以通过标准 HTTPS 提供网页服务（事实上也是如此）。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-04T14:34:30.253

防火墙限制的存在是有原因的。它们可能不是好的，但它们对实施它或促使它实施的人来说是有意义的。我不会试图违反公司关于外部连接的政策。

如果您的需要是合法的，我会要求向您需要的地址开放端口或替代端口。如果这不起作用，那么也许可以接受 VPN 解决方案。

如果网络人员只是疯狂地保护、不愿回应理由或完全无能，我想确保我得到了一位愿意在成为问题时为我效力的经理的签字在我实施解决方法之前。其他任何事情都可能导致您的工作被终止。毕竟，您是在谈论违反公司安全政策。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-01-04T14:07:28.967

解决您的问题的一个简单方法可能是为您的机器分配多个 IP 地址，并将您的 SSH 绑定到单独 IP 上的端口 443；[您通常可以为单个适配器分配多个 IP 地址](http://www.xenocafe.com/tutorials/linux/redhat/bind_multiple_ip_addresses_to_single_nic/index.php)，无需添加第二个网卡。否则，我不知道您想要做什么的任何开箱即用的解决方案。您可能必须为此创建一个自定义守护程序，这有点棘手但可行。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-04T14:26:43.797

您可以构建一个小型 Web 应用程序，侦听端口 443，使用公钥身份验证启用反向 SSH shell 到传入连接的 IP。说：

*   您在 Web 应用程序上进行身份验证；Web 应用程序检索您的 IP
*   应用程序启动从其 IP 到您的 IP 的 SSH 隧道（在端口 22）
*   您机器上的 SSH 服务器结束隧道并在 localhost:8080 进行侦听
*   然后，您使用 localhost:8080 启动 SSH 会话。以下交互式会话中的命令被重定向到远程主机。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-04T16:00:48.193

如果您在我们的 centos 机器上安装了 apache，您可以使用 mod_proxy 将请求从一个端口重定向到另一个端口。我用它来将请求重定向到[http://webmin.myserver.com](http://webmin.myserver.com)到[http://myserver.com:10000](http://myserver.com:10000)（webmin 在不可访问的端口上运行）

```
ServerName webmin.myserver.co.uk
SSLProxyEngine On

ProxyRequests Off
ProxyPass / https://myserver.co.uk:10000/
ProxyPassReverse / https://myserver.co.uk:10000/ 
```

将上述内容放在您的虚拟服务器指令中，您就可以开始了。这可能不适用于 Putty，但如果您安装 webmin，它有一个 SSH 模块，您可以通过浏览器访问。*******``****``