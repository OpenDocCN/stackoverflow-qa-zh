# StackOverflow 问答 000664000-000664999

# asp.net - 在gridview中禁用图像按钮

> ID：664004
> 
> 赞同：1
> 
> 时间：2009-03-19T20:52:15.623
> 
> 标签：asp.net, gridview

这是代码：

```
<asp:GridView ID="MyGridView" runat="server">
    <Columns>
        <asp:BoundField Text="Name" DataField="Name" />
        <asp:TemplateField HeaderText="Delete">
            <ItemTemplate>
                <asp:ImageButton ID="DeleteButton" runat="server" ImageUrl="~/images/delete.png" CommandName="DeleteItem" CommandArgument='<%# Eval("Id") %>' />
                <ajax:ConfirmButtonExtender ID="DeleteCbe" runat="server" TargetControlID="DeleteButton"  ConfirmText="Continue with delete?" />
            </ItemTemplate>
        </asp:TemplateField>
    </Columns>
</asp:GridView> 
```

单击“确定”时，我想禁用 DeleteButton。这将防止用户在删除数据库中的数据时多次单击图像。这可能吗？我该怎么做？谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-19T21:04:38.697

我的博客上有一个脚本，一旦回发开始，它将禁用表单上的*所有*按钮。这样，在回发完成之前，他们将无法触发*任何*其他回发。

[如何禁用 Web 表单的提交按钮](http://blog.josh420.com/archives/2008/02/how-to-disable-the-submit-button-ofweb-form.aspx)

该解决方案很容易集成到您的应用程序中。

# linux - 是否值得开始一个新的开源项目或加入？

> ID：664005
> 
> 赞同：3
> 
> 时间：2009-03-19T20:52:25.483
> 
> 标签：linux, open-source, audio, pulseaudio

有一些我不是特别满意的各种开源项目，例如，我觉得与 Windows 相比，Linux 上声音的各个方面简直令人震惊。我知道这是因为声卡制造商为 Windows 制造了他们的硬件，而支持如此糟糕可能是他们的错。但我相信我们可以做得更好，对吧？

例如，我发现 pulseaudio 非常有问题。我试图让pulseaudio在我的网络上工作（这样我就可以分享我的扬声器）但是，由于已经存在多年的大量“已知错误”，这并没有奏效。

此外，另一个抱怨是 Skype 将 Skype 糟糕的支持归咎于 pulseaudio。

我的问题是，是否值得开始一个新的 Linux 声音项目（并可能增加混乱），或者通过提交补丁来帮助 pulseaudio？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-03-19T20:56:39.950

参与开源项目内部和周围的讨论是做出贡献的好方法 - 如果您以任何方式做出积极贡献，您的补丁将被更认真地考虑。加入现有项目意味着其他人已经感兴趣，并且已经投入了大量时间，他们可能更不愿意转移到新项目。利用现有的兴趣并加入已经在进行中的事情！

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-03-19T20:57:10.493

纯粹是我的观点：开源在很大程度上依赖于社区的支持（对我来说关键词是“社区”），所以启动一个类似于已经存在的项目实际上是在分裂社区，而不是把它聚集在一起。所以简而言之，潜入并将你的知识奉献给现有的项目。我相信每个人都会很高兴有一个受过良好教育和技术娴熟的人加入。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-03-19T20:58:11.490

我会选择在pulseaudio 方面提供帮助，因为这样你就可以建立他们现有的基础设施，而不是通过竞争削弱它。重新发明轮子（或轮子制造过程）毫无意义。

对于 FOSS，我只建议在现有软件项目完全崩溃的情况下开始一个新项目，您认为它们没有任何希望。（当然，或者作为一种教育经历）

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-03-19T20:55:21.933

开始一个新项目的时间是当*你*看到一个未解决的问题并知道如何解决它时......

当您的域是 Linux 音频时，在您声称“知道如何修复它”之前，需要了解*很多。*负责 ALSA、PulseAudio 和其他项目的人已经考虑过这个问题。

很有可能有聪明有能力的人已经在考虑你所感知的问题。你几乎肯定会更好地帮助他们重新开始。

另请注意，*真正的*问题可能是配置和部署之一，而不是底层代码。这可能是一个更简单的问题。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-03-23T18:26:44.410

请不要启动又一个 Linux 音频系统。在编写任何代码之前，请阅读[Linux 音频：一团糟](http://lwn.net/Articles/299211/)，[欢迎来到丛林。](http://blogs.adobe.com/penguin.swf/2007/05/welcome_to_the_jungle.html)

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-03-19T20:58:42.923

我会提交补丁。否则，您可能会发明轮子并加剧混乱。

[乔尔间接地](http://www.joelonsoftware.com/articles/fog0000000069.html)写了这篇文章。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-03-19T21:20:52.730

当您不知道是否必须这样做时，先发制人地分叉项目是很愚蠢的。提交你的补丁。如果它们没有得到响应处理（或者整个设计需要重做）*，那么*考虑可能的分叉。

# wpf - 避免 TextBox 垂直拉伸

> ID：664012
> 
> 赞同：1
> 
> 时间：2009-03-19T20:54:10.503
> 
> 标签：wpf, height, stretching

在以下示例中如何避免 TextBox 垂直拉伸：

```
<StackPanel Orientation="Horizontal">
  <Button Height="40">OK</Button>
  <TextBox Width="200"></TextBox>
</StackPanel> 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-19T20:59:03.190

使用 VerticalAlignment 属性

```
<StackPanel Orientation="Horizontal">
  <Button Height="40">OK</Button>
  <TextBox Width="200" VerticalAlignment="Center"></TextBox>
</StackPanel> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-19T20:58:25.703

```
 <StackPanel Orientation="Horizontal">
        <Button Height="40">OK</Button>
        <TextBox Height="40" Width="200"></TextBox>
    </StackPanel> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-19T20:59:15.793

来自 MSDN：

> 将 TextWrapping 属性设置为 Wrap 会导致输入的文本在到达 TextBox 控件的边缘时换行，并在必要时自动扩展 TextBox 控件的高度以包含新行的空间。

所以，要修复它，我认为你可以设置`TextWrapping = TextWrapping.NoWrap`

# c - 接受整数散列键的整数散列函数是好的？

> ID：664014
> 
> 赞同：119
> 
> 时间：2009-03-19T20:54:39.423
> 
> 标签：c, algorithm, hash

接受整数散列键的整数散列函数是好的？

* * *

## 回答 #1

> 赞同：178
> 
> 时间：2012-10-21T08:01:25.683

我发现以下算法提供了非常好的统计分布。每个输入位以大约 50% 的概率影响每个输出位。没有冲突（每个输入导致不同的输出）。该算法速度很快，除非 CPU 没有内置整数乘法单元。C 代码，假设`int`是 32 位（对于 Java，替换`>>`为`>>>`和删除`unsigned`）：

```
unsigned int hash(unsigned int x) {
    x = ((x >> 16) ^ x) * 0x45d9f3b;
    x = ((x >> 16) ^ x) * 0x45d9f3b;
    x = (x >> 16) ^ x;
    return x;
} 
```

幻数是使用运行了多个小时的[特殊多线程测试程序](https://github.com/h2database/h2database/blob/master/h2/src/test/org/h2/test/store/CalculateHashConstant.java)计算得出的，该程序计算雪崩效应（如果单个输入位发生变化，输出位的数量会发生变化；平均应该接近 16），独立性输出位变化（输出位不应相互依赖），以及任何输入位发生变化时每个输出位发生变化的概率。计算值优于[MurmurHash使用的 32 位终结器，并且几乎与使用](https://code.google.com/p/smhasher/wiki/MurmurHash3)[AES](http://en.wikipedia.org/wiki/Advanced_Encryption_Standard)时一样好（不完全）。一个轻微的优势是相同的常数被使用了两次（它确实使它在我上次测试时稍微快一点，不确定它是否仍然如此）。

如果将 替换为（乘法逆），则可以反转该过程（从哈希中获取`0x45d9f3b`输入`0x119de1f3`值[）](https://lemire.me/blog/2017/09/18/computing-the-inverse-of-odd-integers/)：

```
unsigned int unhash(unsigned int x) {
    x = ((x >> 16) ^ x) * 0x119de1f3;
    x = ((x >> 16) ^ x) * 0x119de1f3;
    x = (x >> 16) ^ x;
    return x;
} 
```

对于 64 位数字，我建议使用以下，即使它可能不是最快的。这个是基于[splitmix64](http://xorshift.di.unimi.it/splitmix64.c)的，它似乎是基于博客文章[Better Bit Mixing](http://zimbry.blogspot.it/2011/09/better-bit-mixing-improving-on.html) (mix 13)。

```
uint64_t hash(uint64_t x) {
    x = (x ^ (x >> 30)) * UINT64_C(0xbf58476d1ce4e5b9);
    x = (x ^ (x >> 27)) * UINT64_C(0x94d049bb133111eb);
    x = x ^ (x >> 31);
    return x;
} 
```

对于 Java，使用`long`、添加`L`到常量、替换`>>`为`>>>`和删除`unsigned`。在这种情况下，反转更复杂：

```
uint64_t unhash(uint64_t x) {
    x = (x ^ (x >> 31) ^ (x >> 62)) * UINT64_C(0x319642b2d24d8ec3);
    x = (x ^ (x >> 27) ^ (x >> 54)) * UINT64_C(0x96de1b173f119089);
    x = x ^ (x >> 30) ^ (x >> 60);
    return x;
} 
```

更新：您可能还想查看[Hash Function Prospector](https://github.com/skeeto/hash-prospector)项目，其中列出了其他（可能更好的）常量。

* * *

## 回答 #2

> 赞同：53
> 
> 时间：2009-03-20T09:59:34.653

Knuth 的乘法方法：

```
hash(i)=i*2654435761 mod 2^32 
```

一般来说，您应该选择一个与您的哈希大小（`2^32`在示例中）顺序相同且没有公因数的乘数。这样，散列函数均匀地覆盖了所有散列空间。

编辑：这个散列函数的最大缺点是它保留了可分性，所以如果你的整数都可以被 2 或 4 整除（这并不罕见），它们的散列也会如此。这是哈希表中的一个问题 - 您最终只能使用 1/2 或 1/4 的存储桶。

* * *

## 回答 #3

> 赞同：31
> 
> 时间：2009-03-19T20:57:45.063

取决于你的数据是如何分布的。对于一个简单的计数器，最简单的功能

```
f(i) = i 
```

会很好（我怀疑是最优的，但我无法证明）。

* * *

## 回答 #4

> 赞同：19
> 
> 时间：2019-08-19T12:14:01.763

快速且良好的哈希函数可以由质量较差的快速排列组合而成，例如

*   与不均​​匀整数相乘
*   二进制旋转
*   异或移位

产生具有卓越品质的散列函数，如[PCG](http://www.pcg-random.org/pdf/hmc-cs-2014-0905.pdf)用于随机数生成的演示。

这实际上也是 rrxmrrxmsx_0 和 murmur hash 有意或无意地使用的配方。

我个人发现

```
uint64_t xorshift(const uint64_t& n,int i){
  return n^(n>>i);
}
uint64_t hash(const uint64_t& n){
  uint64_t p = 0x5555555555555555ull; // pattern of alternating 0 and 1
  uint64_t c = 17316035218449499591ull;// random uneven integer constant; 
  return c*xorshift(p*xorshift(n,32),32);
} 
```

要足够好。

一个好的散列函数应该

1.  如果可能，双射不丢失信息，并且冲突最少
2.  尽可能多且均匀地级联，即每个输入位应该以 0.5 的概率翻转每个输出位。

我们先来看看恒等函数。它满足 1\. 但不满足 2\. ：

[![身份功能](https://i.stack.imgur.com/YgcxN.png)](https://i.stack.imgur.com/YgcxN.png)

输入位 n 确定输出位 n 的相关性为 100%（红色）并且没有其他相关性，因此它们是蓝色的，给出了一条完美的红线。

xorshift(n,32) 也好不到哪里去，只产生一行半。仍然满足 1.，因为它在第二个应用程序中是可逆的。

[![异或移位](https://i.stack.imgur.com/8V7z2.png)](https://i.stack.imgur.com/8V7z2.png)

与无符号整数相乘（[“Knuth 的乘法方法”](https://stackoverflow.com/a/665545/2119377)）要好得多，级联更强烈，并且以 0.5 的概率翻转更多输出位，这就是你想要的，用绿色表示。它满足 1。对于每个不均匀的整数，都有一个乘法逆元。

[![克努特](https://i.stack.imgur.com/xz54T.png)](https://i.stack.imgur.com/xz54T.png)

将两者结合得到以下输出，仍然满足 1\. 因为两个双射函数的组合产生另一个双射函数。

[![knuth•xorshift](https://i.stack.imgur.com/lpKUG.png)](https://i.stack.imgur.com/lpKUG.png)

乘法和 xorshift 的第二次应用将产生以下结果：

[![建议的哈希](https://i.stack.imgur.com/kSa2a.png)](https://i.stack.imgur.com/kSa2a.png)

或者你可以使用像[GHash](http://citeseerx.ist.psu.edu/viewdoc/download?doi=10.1.1.693.7686&rep=rep1&type=pdf)这样的伽罗瓦域乘法，它们在现代 CPU 上已经变得相当快，并且一步就具有卓越的品质。

```
 uint64_t const inline gfmul(const uint64_t& i,const uint64_t& j){           
     __m128i I{};I[0]^=i;                                                          
     __m128i J{};J[0]^=j;                                                          
     __m128i M{};M[0]^=0xb000000000000000ull;                                      
     __m128i X = _mm_clmulepi64_si128(I,J,0);                                      
     __m128i A = _mm_clmulepi64_si128(X,M,0);                                      
     __m128i B = _mm_clmulepi64_si128(A,M,0);                                      
     return A[0]^A[1]^B[1]^X[0]^X[1];                                              
   } 
```

* * *

## 回答 #5

> 赞同：7
> 
> 时间：2009-06-14T10:03:52.730

*   32 位乘法方法（非常快）见 @rafal

    ```
    #define hash32(x) ((x)*2654435761)
    #define H_BITS 24 // Hashtable size
    #define H_SHIFT (32-H_BITS)
    unsigned hashtab[1<<H_BITS]  
    .... 
    unsigned slot = hash32(x) >> H_SHIFT 
    ```

*   32 位和 64 位（良好分布）在：[MurmurHash](http://murmurhash.googlepages.com/)

*   [整数哈希函数](https://gist.github.com/badboy/6267743)

* * *

## 回答 #6

> 赞同：6
> 
> 时间：2009-03-19T21:02:03.073

[这个页面](http://www.cs.hmc.edu/~geoff/classes/hmc.cs070.200101/homework10/hashfuncs.html)列出了一些简单的散列函数，这些函数通常都很好，但是任何简单的散列都有病态的情况，它不能很好地工作。

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2009-03-19T21:31:48.867

[在Eternally Confuzzled](http://eternallyconfuzzled.com/tuts/algorithms/jsw_tut_hashing.aspx)上有一些哈希算法的很好的概述。我推荐 Bob Jenkins 的一次一个哈希，它很快就会达到雪崩，因此可以用于高效的哈希表查找。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2009-03-19T21:02:49.560

答案取决于很多事情，例如：

*   你打算在哪里使用它？
*   你想用哈希做什么？
*   你需要一个密码安全的哈希函数吗？

我建议你看看[Merkle-Damgard](http://en.wikipedia.org/wiki/Merkle-Damg%C3%A5rd_construction)系列的哈希函数，如 SHA-1 等

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2019-06-07T21:37:12.163

自从我找到这个线程以来，我一直在使用`splitmix64`（在 Thomas Mueller 的[回答中指出）。](https://stackoverflow.com/questions/664014/what-integer-hash-function-are-good-that-accepts-an-integer-hash-key/12996028#12996028)然而，我最近偶然发现了 Pelle Evensen 的[rrxmrrxmsx_0](http://mostlymangling.blogspot.com/2019/01/better-stronger-mixer-and-test-procedure.html)，它产生的统计分布比原始的 MurmurHash3 终结器及其后继者（`splitmix64`和其他混合）要好得多。以下是 C 语言中的代码片段：

```
#include <stdint.h>

static inline uint64_t ror64(uint64_t v, int r) {
    return (v >> r) | (v << (64 - r));
}

uint64_t rrxmrrxmsx_0(uint64_t v) {
    v ^= ror64(v, 25) ^ ror64(v, 50);
    v *= 0xA24BAED4963EE407UL;
    v ^= ror64(v, 24) ^ ror64(v, 49);
    v *= 0x9FB21C651E98DF25UL;
    return v ^ v >> 28;
} 
```

Pelle 还提供了对最后一步中使用的 64 位混频器和更新变体[的深入分析。](http://mostlymangling.blogspot.com/2018/07/on-mixing-functions-in-fast-splittable.html)`MurmurHash3`

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2014-10-25T20:20:37.367

我认为我们不能在事先不知道您的数据的情况下说哈希函数是“好”的！并且不知道你将如何处理它。

对于未知数据大小，有比散列表更好的数据结构（我假设您在这里为散列表进行散列）。当我知道我有“有限”数量的元素需要存储在有限的内存中时，我会亲自使用哈希表。在我开始考虑我的哈希函数之前，我会尝试对我的数据进行快速统计分析，看看它是如何分布的等。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2019-02-15T11:48:06.620

对于随机散列值，有工程师说黄金比例素数（2654435761）是一个不好的选择，我的测试结果发现不是真的；相反， 2654435761 可以很好地分配散列值。

```
#define MCR_HashTableSize 2^10

unsigned int
Hash_UInt_GRPrimeNumber(unsigned int key)
{
  key = key*2654435761 & (MCR_HashTableSize - 1)
  return key;
} 
```

哈希表大小必须是 2 的幂。

我编写了一个测试程序来评估整数的许多哈希函数，结果表明 GRPrimeNumber 是一个不错的选择。

我试过了：

1.  total_data_entry_number / total_bucket_number = 2、3、4；其中 total_bucket_number = 哈希表大小；
2.  将哈希值域映射到桶索引域；即用(hash_table_size - 1)进行逻辑与运算将哈希值转化为桶索引，如Hash_UInt_GRPrimeNumber()所示；
3.  计算每个桶的碰撞次数；
4.  记录未被映射的bucket，即空bucket；
5.  找出所有桶的最大碰撞次数；即最长链长；

根据我的测试结果，我发现黄金比例素数总是具有较少的空桶或零空桶和最短的碰撞链长度。

一些整数的哈希函数号称好，但测试结果表明，当total_data_entry / total_bucket_number = 3时，最长链长度大于10（最大碰撞数> 10），并且很多桶没有映射（空桶)，与黄金比例素数散列的零空桶和最长链长3的结果相比，这是非常糟糕的。

顺便说一句，根据我的测试结果，我发现一个版本的移位异或哈希函数非常好（它由 mikera 共享）。

```
unsigned int Hash_UInt_M3(unsigned int key)
{
  key ^= (key << 13);
  key ^= (key >> 17);    
  key ^= (key << 5); 
  return key;
} 
```

# c - Windows 上的 %lld 问题

> ID：664015
> 
> 赞同：6
> 
> 时间：2009-03-19T20:54:52.653
> 
> 标签：c, windows

为什么这段代码：

```
#include <stdio.h>

int main(int argc, char** argv) {
    printf("%lld\n", 4294967296LL);
} 
```

为 Windows 发出这个：

```
0 
```

但这对于 Linux：

```
4294967296 
```

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-03-19T20:56:15.053

这是因为 Visual Studio C++ 2003 和更早版本不支持 %lld。但是这段代码可以工作：

```
#include <stdio.h>

int main(int argc, char** argv) {
    printf("%I64d\n", 4294967296LL);
} 
```

[大小和距离规范 (Visual Studio C++ 2003)](http://msdn.microsoft.com/en-us/library/tcxf1dw6(VS.71).aspx)

[大小和距离规范 (Visual Studio C++ 2005)](http://msdn.microsoft.com/en-us/library/tcxf1dw6(VS.80).aspx)

# sql - Sql中列命名的最佳实践

> ID：664017
> 
> 赞同：23
> 
> 时间：2009-03-19T20:55:07.363
> 
> 标签：sql

假设我有一张名为 Student 的表。对于列，您更喜欢以下哪种命名约定？您也可以提出自己的建议。

```
Student
-------
StudentID
StudentName
MentorID

Student
-------
StudentID
Name
MentorID

Student
-------
ID
Name
MentorID 
```

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2009-03-19T20:57:16.627

我会选择第二个。

```
Student
-------
StudentID
Name
MentorID 
```

我喜欢在主键中有表的名称，但它不需要在每个字段上。MentorID 也是我命名外键的方式（假设 Mentor 是它指向的表的名称）。

这样，Student 表中的 MentorID 字段与 Mentor 表中的 MentorID 字段具有相同的名称。有些人不喜欢它，因为它在连接表时可能会有点混乱，但我更喜欢明确命名连接中字段的表，

* * *

## 回答 #2

> 赞同：18
> 
> 时间：2009-03-19T20:59:18.680

由于常规 RDBMS 是分层的，因此 DBMS 包含一个数据库 - 一个数据库包含一个表 - 一个表包含一个列 - 一个列包含一个值，我不喜欢在列名中迭代使用表名。

我的投票是：

```
Student
--------
id (pk)
name
mentor (fk) (alt. mentorId) 
```

选择正确的字段相当容易，并且在表之间连接的情况下，我经常重命名列名，即：

```
SELECT s.id AS StudentID, s.name AS StudentName, m.id AS MentorId, m.name AS MentorName
FROM Studens AS s
INNER JOIN Mentors AS m ON m.id=s.mentor 
```

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2009-03-19T21:02:37.017

由于一些 sql 格式化程序大写的东西，我选择了以下内容：

```
student
-------
id
name
mentor_id 
```

这样我就可以在数据库中保持单词分离。

在 OO 代码中，我使用相应的驼峰式名称

导师身份，获取导师身份（）

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2009-03-19T21:07:39.237

我个人会选择：

```
Students
--------
student_id
first_name
last_name
mentor_id 
```

我更喜欢使用下划线，因为研究表明，与驼背符号相比，它们极大地提高了代码的可读性。

我也可以理解仅使用“id”而不是“student_id”的论点，所以我不反对。

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2009-03-19T20:59:44.920

我更喜欢最后一个，以便表​​之间的连接看起来像：

```
 SELECT blah blah blah
 FROM Student INNER JOIN Mentor
      ON Student.MentorID = Mentor.ID 
```

但这几乎和“你喜欢骆驼案吗？”一样主观。:P

最重要的是要保持一致。过去我不得不处理一些他们永远无法决定标准的数据库。因此，在某些表中，PK 将是 StudentID、其他 Student_ID 和其他 ID。或者它们在用作外键时没有一致地使用名称。哎，我开始吐槽了……

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2009-03-19T20:57:14.410

我更喜欢第二个：

```
Students
-------
StudentID
Name
MentorID 
```

在哪里：

*   所有外键都`ID`在 columnname 的末尾标识。
*   其余列的名称易于理解。
*   也可以使用`EndDate`,`BeginDate`作为日期。

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2009-03-19T21:18:29.930

我更喜欢第一个。

通过为字段指定一个比`Id`or更具体的名称`Name`，可以更轻松地查看您是否正确加入，并且如果您从多个表中选择字段，则不必为字段使用别名：

```
select s.StudentId, s.StudentName, m.MentorId, m.MentorName
from Student s
inner join Mentor m on m.MentorId = s.MentorId 
```

对比

```
select s.Id as StudentId, s.Name as StudentName, m.Id as MentorId, m.Name as MentorName
from Student s
inner join Mentor m on m.Id = s.MentorId 
```

此外，该词`Name`在某些数据库（例如 SQL Server）中是保留关键字，因此将其用作字段名称并不总是实用的。

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2009-03-19T21:01:35.197

尽管我讨厌它，但我会选择选项 1：

```
Student
-------
StudentID
StudentName
MentorID 
```

这样做的原因是当与其他具有“名称”列的表连接时，例如课程或学位或其他内容，连接要求您重命名列以避免名称歧义。处理包含表名的长名称很烦人，但从长远来看，它可以节省您的工作量。

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2011-09-17T13:03:54.900

我会选择 1 号：

避免保留名称，如“名称”。为字段提供独特的名称。我必须重复表名，就这样吧，尽管我不喜欢在所有字段中看到表名。

避免只使用 ID，因为你不知道 ID 是什么表。让它明确，然后你无论如何都必须对其进行限定。学生 ID = 导师 ID 比 a.id = b.id 更易读。那没有用，难以阅读，然后必须弄清楚 a 和 b 是什么，而不是敏捷实践。代码/SQL 应该易于阅读，无需注释。

下划线的用户有助于提高可读性，除了驼峰式大小写（就像我在 C# 中使用的那样）我总是将 PK 作为第一个字段名称，将关联的 FK 作为第二个、第三个等字段。

不要以 _s 或 _d 结束字段名称来区分字符串或日期。

我喜欢整洁和明确的事情，因为我想体谅身后的其他人，他们必须在 DB 上进行维护。太多人将坏习惯从 Access 拖到 SQL 中。主要是因为他们没有导师帮助他们学习！:-)

请记住，持续维护总是比原始开发更大的持续任务。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2009-03-19T20:59:48.243

我*可能会*使用 StudentName 而不是 Name，因为它会使连接更容易。我经常发现我有很多很多带有“名称”和“描述”列的表。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2009-03-19T21:00:44.527

我会选择几乎第三个：

```
Student
-------
Id
Name
Mentor_Id

SELECT Student.Name, 
  Student_Mentor.Name
FROM Student
  INNER JOIN Mentor AS Student_Mentor ON Student.Mentor_Id = Student_Mentor.Id 
```

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2009-03-19T21:03:02.493

我通常做3号

```
Student-------
ID
Name
MentorID 
```

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2012-01-13T09:51:32.927

作为旁注，就像将 Company、Brother 和 Number 这样的词缩短为 Co、Bro 和 No，我建议将 Identity 缩短为 'Id' 而不是 'ID'，因为字母 'd' 的大写表明“Id”是首字母缩写词，而不是缩写词。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2009-03-20T00:25:43.177

对此没有“正确”的答案。只需选择您喜欢的任何命名约定（以及将使用您的数据库的其他所有人）并坚持下去。互联网上有很多精心设计的命名约定。只需在“SQL 命名约定”上搜索 Google。

根据我的经验，人们使用完全不同的风格，但只要整个应用程序（或同一组织中的所有项目）使用相同的约定就可以了。

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2009-04-06T20:45:16.203

我其实很喜欢：

```
Student
-------
Id
Name
IdMentor 
```

我猜它有点模仿匈牙利符号。和之间的视觉差异也`IdMentor`比`Mentor.Id`和`MentorId`之间更大`Mentor.Id`。

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2009-03-19T21:21:21.560

名称可能是一个保留字，我永远不会将它用作列名。我也不会考虑将名称存储在一个字段中。您确实需要 first_name、Middle_name、last_name、Suffix（用于 III、Jr 等）。当您希望所有客户都命名为“Smith”时，请考虑您必须执行哪些操作来查询名称字段。

我也永远不会命名一个 id 字段 ID。我更喜欢我的 id 字段在所有子表中具有相同的名称，因为它可以更容易地看到你在说什么，尤其是当你有一个涉及许多不同 id 的复杂查询时。

只有一个人可以担任导师吗？很可能。Mentor 应该是一个单独的表，并且应该有一个包含 StudentID 和 MentorID 的连接表

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2009-03-22T19:01:06.410

我更喜欢使用这种模式：

```
student
-------
id
name
mentor_id

_id for foreign keys 
```

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2011-11-04T15:02:50.623

```
Student
-------
Id
Name
MentorId 
```

这对我有用。

* * *

## 回答 #19

> 赞同：0
> 
> 时间：2012-08-10T12:15:08.370

```
Student
-------
Id
Name
Mentor_Id

inner join Mentor m on m.Id = s.Mentor_Id 
```

*   容易看出哪个键是外键
*   更短的查询
*   不需要别名

# c# - 比较 DataTable 中的所有行 - 识别重复记录

> ID：664021
> 
> 赞同：1
> 
> 时间：2009-03-19T20:55:46.380
> 
> 标签：c#, .net, asp.net, linq, normalization

我想在`DataTable insertRows`没有密钥的情况下规范化数据。为此，我需要通过查找它们的 ID ( `import_id`) 来识别和标记重复记录。之后，我将只选择不同的。我正在考虑的方法是将每一行与该 DataTable 中的所有行进行比较 `insertRows`

DataTable 中的列在设计时是未知的，并且没有键。性能方面，该表将有多达 10k 到 20k 条记录和大约 40 列

我如何在不牺牲太多性能的情况下做到这一点？

我尝试使用 linq 但我不知道如何动态指定 where 条件在这里我在循环中比较每一行的名字和姓氏

> ````
> foreach (System.Data.DataRow lrows in importDataTable.Rows)
> {
>     IEnumerable<System.Data.DataRow> insertRows = importDataTable.Rows.Cast<System.Data.DataRow>();
> 
>     var col_matches =
>     from irows in insertRows
>     where
>     String.Compare(irows["fname"].ToString(), lrows["fname"].ToString(), true).Equals(0)
>     &&
>     String.Compare(irows["last_name"].ToString(), lrows["last_name"].ToString(),true).Equals(0)
> 
>     select new { import_id = irows["import_id"].ToString() };
> } 
> ````

 `欢迎任何想法。如何使用 linq 找到类似的列名？>我的类似问题

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-20T14:27:44.073

在没有 O(n ² ) 复杂性的情况下完成此操作的最简单方法是使用有效实现 Set 操作的数据结构，特别是 Contains 操作。幸运的是 .NET（从 3.0 开始）包含为您执行此操作的[HashSet对象。](http://msdn.microsoft.com/en-us/library/bb359438.aspx)为了利用这一点，您将需要一个在 DataTable 中封装一行的对象。

如果 DataRow 不起作用，我建议将相关记录转换为字符串，将它们连接起来，然后将它们放入 HashSet。在插入行之前，请检查 HashSet 是否已经包含它（使用 Contains）。如果是这样，则您找到了重复项。

**编辑：**

这种方法是 O(n)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-19T21:56:32.130

我不确定我是否正确理解了这个问题，但是在处理 System.Data.DataTable 时，以下应该可以工作。

```
for (Int32 r0 = 0; r0 < dataTable.Rows.Count; r0++)
{
   for (Int32 r1 = r0 + 1; r1 < dataTable.Rows.Count; r1++)
   {
      Boolean rowsEqual = true;

      for (Int32 c = 0; c < dataTable.Columns.Count; c++)
      {
         if (!Object.Equals(dataTable.Rows[r0][c], dataTable.Rows[r1][c])
         {
            rowsEqual = false;
            break;
         }
      }

      if (rowsEqual)
      {
         Console.WriteLine(
            String.Format("Row {0} is a duplicate of row {1}.", r0, r1))
      }
   }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-20T14:23:10.293

我对 LINQ 不太了解，但是您可以使用 .Distinct() 运算符吗？

[http://blogs.msdn.com/charlie/archive/2006/11/19/linq-farm-group-and-distinct.aspx](http://blogs.msdn.com/charlie/archive/2006/11/19/linq-farm-group-and-distinct.aspx)

您的问题并不清楚您是否需要专门识别重复的行，或者您是否只是想从查询中删除它们。添加“不同”会删除额外的实例，尽管它不一定会告诉你它们是什么。

# .net - 在不使用 Word 自动化的情况下将 Word 2003 批量转换为 Word 2007？

> ID：664022
> 
> 赞同：0
> 
> 时间：2009-03-19T20:56:02.073
> 
> 标签：.net, automation, ms-word

有没有办法在不使用 ole 自动化的情况下有效地将 Word 2003 文档转换为 Word 2007？如果可能，我想使用 DotNet。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-19T20:58:55.107

那里有几个 3rd 方库（例如 Aspose.Words 或 Syncfusion），它们可以在本地进行这种转换读取和写入 Word 2003 和 2007 等...

我只能代表我在多个项目中拥有丰富经验的 Aspose 发言。

# xslt - 使用 XSL 将节点列表分组到节点树中

> ID：664025
> 
> 赞同：3
> 
> 时间：2009-03-19T20:56:36.283
> 
> 标签：xslt, grouping

我正在用测试描述解析一个巨大的单词文件，并且有节点范围的问题。Word 基本上会创建一个段落列表，我想将它们分组到一个父节点中。因此，对于每个节点“A”，我想将所有以下节点分组到下一个节点“A”到“A”中。

XSL 如何做到这一点？

示例：我已经得到：

```
<A/>
<ab/>
<ac/>
<A/>
<ab/>
<ac/> 
```

但需要：

```
<A>
<ab/>
<ac/>
</A>
<A>
<ab/>
<ac/>
</A> 
```

谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-20T03:37:52.090

**有一个使用键的简单且非常强大的解决方案。**

**这种转变：**

```
<xsl:stylesheet version="1.0"
 xmlns:xsl="http://www.w3.org/1999/XSL/Transform">

 <xsl:output omit-xml-declaration="yes" indent="yes"/>

 <xsl:key name="kFollowing" match="*[not(self::A)]"
  use="generate-id(preceding-sibling::A[1])"/>

    <xsl:template match="/*">
     <t>
       <xsl:apply-templates select="A"/>
     </t>
    </xsl:template>

    <xsl:template match="A">
     <A>
       <xsl:copy-of select=
          "key('kFollowing',generate-id())"/>
     </A>
    </xsl:template>
</xsl:stylesheet> 
```

**应用于原始 XML 文档时：**

```
<t>
    <A/>
    <ab/>
    <ac/>
    <A/>
    <ab/>
    <ac/>
</t> 
```

**产生想要的结果：**

```
<t>
   <A>
      <ab/>
      <ac/>
   </A>
   <A>
      <ab/>
      <ac/>
   </A>
</t> 
```

**请注意**的定义以及函数[**`<xsl:key>`**](http://www.w3.org/TR/xslt#element-key)的使用如何[**`key()`**](http://www.w3.org/TR/xslt#function-key)使收集两个相邻元素之间的所有兄弟元素最容易和自然`<A/>`。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-19T21:24:10.320

如果你的意思是匹配所有节点之后`<A>`，但在下一个之前`<A>`，我认为你可以使用这样的东西：

```
<xsl:template match="A">
  <xsl:copy>
    <!-- start of range -->
    <xsl:variable name="start" select="count(preceding-sibling::*) + 1" />
    <!-- end of range -->
    <xsl:variable name="stop">
      <xsl:choose>
        <!-- either just before the next A node -->
        <xsl:when test="following-sibling::A">
          <xsl:value-of select="count(following-sibling::A[1]/preceding-sibling::*) + 1" />
        </xsl:when>
        <!-- or all the rest -->
        <xsl:otherwise>
          <xsl:value-of select="count(../*) + 1" />
        </xsl:otherwise>
      </xsl:choose>
    </xsl:variable>

    <!-- this for debugging only -->
    <xsl:attribute name="range">
      <xsl:value-of select="concat($start + 1, '-', $stop - 1)" />
    </xsl:attribute>

    <!-- copy all nodes in the calculated range -->
    <xsl:for-each select="../*[position() &gt; $start and position() &lt; $stop]">
      <xsl:copy-of select="." />
    </xsl:for-each>
  </xsl:copy>
</xsl:template> 
```

对于您的输入：

```
<root>
  <A />
  <ab />
  <ac />
  <A />
  <ab />
  <ac />
</root> 
```

我得到（我留下了“范围”属性以使计算可见）：

```
<A range="2-3">
  <ab />
  <ac />
</A>
<A range="5-6">
  <ab />
  <ac />
</A> 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-03-20T07:03:06.093

XSLT 2.0 解决方案：

```
<xsl:for-each-group select="*" group-starting-with="A">
  <xsl:element name="{name(current-group()[1])}">
    <xsl:copy-of select="current-group()[position() gt 1]"/>  
  </xsl:element>
</xsl:for-each-group> 
```

# asp-classic - 经典 ASP RSS 阅读器无法在内部服务器上运行

> ID：664027
> 
> 赞同：0
> 
> 时间：2009-03-19T20:56:51.620
> 
> 标签：asp-classic, rss, msxml

我有一个用 Classic ASP 编写的基于 Web 的 RSS 阅读器，我在过去的公共项目中成功使用过它。但是，它不想在这个内部项目上进行合作。

相关代码：

```
set xmlDoc = createObject("Msxml.DOMDocument")
xmlDoc.async = false
xmlDoc.setProperty "ServerHTTPRequest", true
xmlDoc.load(extURL)

If (xmlDoc.parseError.errorCode <> 0) then
    Response.Write "XML error #" & xmlDoc.parseError.errorCode & ": " & xmlDoc.parseError.reason
Else
    'Not pertinent as it never gets here...
End If 
```

我收到以下错误：

```
XML error #-2146697208: The download of the specified resource has failed. 
```

它在其他地方工作得很好，只是不适用于这个特定的项目。它是一个内部项目，所以我无法链接到它。饲料形成正确，一切都很有趣。

不，我不能放弃它并使用编程语言 [在此处插入反 CLASP 咆哮]。如果这就是您要添加的全部内容，请不要发布。

它在 Server 2003 上运行，如果我需要查找任何配置信息等，我确实可以访问服务器。

**编辑**- 回答几个问题：

*   我一直在测试这个，extURL 暂时是同一服务器上的一个页面。
*   我已将 URL 手动输入到 IE6 和 IE7 中（根据公司政策没有 Fx），并且加载正常。
*   我已经通过家里的验证器运行了生成的 RSS 提要，它验证得很好。
*   我保存了生成的 XML 文件并尝试加载它，但得到了同样的错误。
*   可能应该早点提到这一点，但由于我无法与另一台服务器进行测试，所以我在不同的端口上运行测试站点 - [http://subdomain.maindomain.com:5150/rss.asp](http://subdomain.maindomain.com:5150/rss.asp)其他一切我已发布仍然适用。

最后一个随机想法：我确实打开了基本身份验证，因此我可以根据 NT Logon 等限制对站点某些部分的访问。这会是问题吗？我不能把它关掉，因为这会否定一些安全代码......

多谢你们。:)

**再次编辑**- 结果是导致问题的身份验证。部分原因是食物链上游的某个人更改了一些组策略，部分原因是我自己对作为服务器管理员的新角色（除了作为开发人员）缺乏经验。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-19T21:11:35.157

您能否确保可以通过浏览器或 ping 从服务器访问外部 URL？该错误表明下载失败，所以这是我要检查的第一件事。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-19T21:18:08.213

此时我会检查服务器。

1.  验证它发送的内容类型是 text/xml - 你可以通过在 Firefox 中加载你的 extURL 变量值来做到这一点
2.  尝试将文件下载到磁盘并重新编写代码以从磁盘读取文件。这行得通吗？

在您回答这些问题后更新：

> 我确实打开了基本身份验证，因此我可以根据 NT Logon 等限制对站点某些部分的访问。这会是问题吗？

嗯，是的！明确地。您的 ASP 脚本无法在正在运行的身份验证对话框中输入您的用户名和密码，因此它永远无法下载您的资源。

但是您还说您将 xml 放在本地文件中并修改了代码以加载它。如果你得到同样的错误，那么它绝对是 XML 的格式（一个坏字符，或者没有根元素，或者其他奇怪的东西）......但是你说 IE 可以打开它，对吗？

一些截图怎么样？

# c# - 让用户在 C# 中选择子目录的最佳方法是什么？

> ID：664031
> 
> 赞同：3
> 
> 时间：2009-03-19T20:57:34.910
> 
> 标签：c#

让用户在 C# 中选择子目录的最佳方法是什么？

例如，一个允许用户组织他保存的所有 html 收据的应用程序。他很可能希望能够选择程序应该搜索保存的网页（收据）的根子目录。

复制：

*   [在 C# 中浏览目录](https://stackoverflow.com/questions/11767/browse-for-a-directory-in-c)

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-03-19T20:59:35.090

[文件夹浏览器对话框](http://msdn.microsoft.com/en-us/library/system.windows.forms.folderbrowserdialog.aspx)是要走的路。

如果要设置初始文件夹路径，可以将其添加到表单加载事件中：

```
// Sets "My Documents" as the initial folder path
string myDocsPath = Environment.GetFolderPath(Environment.SpecialFolder.MyDocuments);
FolderBrowserDialog1.SelectedPath = myDocsPath; 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-03-19T21:00:33.373

检查[FolderBrowserDialog](http://msdn.microsoft.com/en-us/library/system.windows.forms.folderbrowserdialog.aspx)类。

```
// ...    
if (folderBrowserDialog1.ShowDialog() == DialogResult.OK) 
{
    textBox1.Text = folderBrowserDialog1.SelectedPath;
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-19T21:00:55.227

[FolderBrowserDialog](http://msdn.microsoft.com/en-us/library/system.windows.forms.folderbrowserdialog.aspx)为此目的工作得很好。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-03-19T21:23:44.550

FolderBrowserDialog 有效，但提供的自定义很少。

如果您想要一个用户可以在其中输入路径的文本框，[请查看此处](https://stackoverflow.com/questions/576741/customising-the-browse-for-folder-dialog-to-show-the-path)

受骗： [在 C# 中浏览目录](https://stackoverflow.com/questions/11767/browse-for-a-directory-in-c)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-19T21:22:49.683

无论您做什么，都不要使用`FolderBrowserDialog`.

只是在开玩笑。用那个。

# java - 你如何在你的 web.xml 中的标签？

> ID：664059
> 
> 赞同：59
> 
> 时间：2009-03-19T21:01:22.857
> 
> 标签：java, tomcat, jboss, jetty

我想在我的 WAR 文件中指定我的 Java Web 应用程序的根上下文。如何`web-app`在文件中使用有效的 XML 来做到这一点`web.xml`？

哦，是的，我想以与应用程序服务器无关的方式执行此操作。

* * *

## 回答 #1

> 赞同：107
> 
> 时间：2009-03-19T21:11:14.987

这不能以与应用服务器无关的方式完成。上下文根不是标准 web.xml 文件的一部分。它可以在您部署应用程序时指定，也可以在应用服务器特定的描述符中指定。

*   Glassfish：[sun-web.xml](http://72.5.124.55/javaee/5/docs/tutorial/doc/bnadx.html#bnaeb)；
*   JBoss：[jboss-web.xml](http://docs.jboss.org/jbossas/jboss4guide/r4/html/ch9.chapt.html)；
*   网络逻辑：[weblogic.xml](http://edocs.bea.com/wls/docs70/webapp/weblogic_xml.html#1037343)；
*   Tomcat：[上下文.xml](http://tomcat.apache.org/tomcat-7.0-doc/config/context.html)；
*   WebSphere：[ibm-web-ext.xml](http://orebmann.blogspot.fr/2015/02/set-context-root-for-web-application.html)。

**注意：**以上适用于部署 WAR 文件。EAR 文件是另一回事，上下文可以指定为[application.xml 部署描述符](http://www.theserverside.com/tt/articles/content/J2EE-Deployment/chapter.html)的一部分。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2018-11-26T14:27:20.427

您可以在 web.xml 中这样使用。

```
<env-entry>
		<description>web app</description>	
		<env-entry-name>appCxtRoot</env-entry-name>
		<env-entry-type>java.lang.String</env-entry-type>		
		<env-entry-value>webapp-@context-root-value@</env-entry-value>
	</env-entry>
```

# .net - .NET 打包控制？

> ID：664060
> 
> 赞同：0
> 
> 时间：2009-03-19T21:01:23.387
> 
> 标签：.net, controls, shipping

我的任务是为从我们的在线商店购买的零件开发一种包装算法。是否有一个开源或出售的小部件或控件包含产品列表（带有尺寸/重量）和可能的包装箱列表（带有最大尺寸和重量）并返回最佳排列？我很难相信在我之前的数百万开发人员还没有想出什么东西，但如果没有，那就去实验室完成一些工作。

谢谢乔什

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-19T21:14:34.243

在我看来，您正在寻找[Bin Packing Problem](http://en.wikipedia.org/wiki/Bin_packing_problem)的实现。这是一个 NP Hard 问题，因此您找不到任何快速且正确的算法。我进行了快速搜索，找不到任何甚至为此使用启发式的组件，但发现了大量描述启发式以获得答案近似值的论文。祝你好运！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-19T21:12:28.243

我似乎记得这通常用作[NP-Hard](http://en.wikipedia.org/wiki/NP-hard)问题的示例。因此，我不知道任何算法，更不用说它的任何实现总是会给出**最好**的答案（你会得到一个合理但不是最好的答案，从最大的项目开始，然后把它放在第一个适合的盒子，重复直到你用完物品）。

# asp.net - jQuery 验证中的规则/属性

> ID：664081
> 
> 赞同：0
> 
> 时间：2009-03-19T21:06:44.917
> 
> 标签：asp.net, jquery, asp.net-mvc, jquery-validate

我正在尝试将自定义验证添加到动态创建的控件中。我可以使用 .attr() 为控件设置规则吗？

```
$.fn.addValidationExpression = function(field) {

    if (field.ValidationExpression != null) {

        $("#fld"+getFieldIdSuffix(field)).attr("validateExpression", field.ValidationExpression);

    }

    return this;
} 
```

我试图避免的是不得不做这样的事情：

```
$("#TestForm").validate(
        {
            rules: 
            {
                someControl: 
                {
                    validateExpression: true
                },
                someOtherControl: 
                {
                    validateExpression: true
                }
            }
        }); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-19T21:10:55.593

最好使用jquery的[data](http://docs.jquery.com/Data) ()选项

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-19T21:38:05.497

您可能还想在 $ 扩展中执行 this.each()

# database - 删除其他用户正在访问的数据库？

> ID：664091
> 
> 赞同：11
> 
> 时间：2009-03-19T21:11:40.477
> 
> 标签：database, postgresql

我正在尝试从 PgAdmin 3 中删除数据库，但收到以下错误消息：

```
ERROR: can't delete current database
SQL state: 55006 
```

如何强制删除/修复此数据库的此错误？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2009-03-19T21:20:06.540

PgAdmin 中的快速修复：只需创建另一个空数据库。选择它。删除第一个。瞧。

您也可以在不选择特定数据库的情况下连接到命令行，然后删除您的数据库。

这里的问题不是**其他用户**连接到数据库，而是**你**。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2020-08-19T18:32:05.597

[This post](http://www.leeladharan.com/drop-a-postgresql-database-if-there-are-active-connections-to-it) by Leeladharan Achar was helpful for me in working with this error.

It essentially boils down to:

```
SELECT pg_terminate_backend(pg_stat_activity.pid)
FROM pg_stat_activity
WHERE pg_stat_activity.datname = 'target_db'
  AND pid <> pg_backend_pid();

DROP DATABASE 'target_db'; 
```

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2017-05-29T07:39:14.143

最简单的解决方法是**重新启动 postgresql**。之后你就可以摆脱数据库了！

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-24T23:03:24.533

他可以简单地连接到 postgres 数据库，而不是创建新数据库，该数据库在所有新的 PostgreSQL 安装中默认创建。即使它不存在 - template1 也应该始终存在。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2020-10-16T13:11:09.430

If you want to use the pgAdmin4 interface, you have to first delete/drop the db, then, before waiting for the error, you have to immediatelly disconnect from the same database, then it gets deleted without problem.

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2017-01-31T09:37:11.160

**下面提到了删除用户的最佳方法**

就像我的用户名是“X”并且它具有对数据库名称的访问权限：“Test”。现在我们创建了与“测试”数据库的连接

如果我们尝试： drop user "X" 这将是 definality 显示下面提到的错误：

**错误：无法删除用户“X”，因为该用户对某些对象具有特权 SQL 状态 = 55006**

首先，不应使用“测试”数据库创建连接。因为它当前正在使用，因此我们无法删除用户。与除“测试”之外的任何数据库创建连接现在再次尝试删除用户测试它应该在我这边工作正常，如果您遇到问题，请告诉我

# asp.net - 如何从 asp.net 方法调用客户端方法？

> ID：664093
> 
> 赞同：0
> 
> 时间：2009-03-19T21:12:46.557
> 
> 标签：asp.net, jquery, jquery-ui

我有以下 javascript：

```
<script type="text/javascript">
    function showjQueryDialog() {
        $("#dialog").dialog("open");
    }

    $(document).ready(function() {
        $("#dialog").dialog({
           autoOpen: false,
           modal: true,
           buttons: { "Renew Membership": function() { $(this).dialog("close"); } }
        });
    });
</script> 
```

我在记录用户的页面上有一个 asp:Button。这是在服务器端单击按钮时我想要发生的示例：

```
protected void LoginButton_OnClick(object sender, EventArgs e)
{
    UserProfile profile = UserProfile.GetUserProfile(txtUserName.Text);

    TimeSpan ts = profile.Expiration.Subtract(DateTime.Now);

    if(ts.Days <= 30)
      //call showJQueryDialog() to open the dialog box
      Page.ClientScript.RegisterStartupScript(typeof(Login2), "showjquery",   
      "showJQueryDialog();", true);
    else
     //log the user in as normal.

} 
```

还有我如何将如下方法附加到对话框上的更新按钮

```
public void Renew()
{
    Response.Redirect("Renew.aspx");
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-19T21:15:13.713

```
if(ts.Days <= 30)
    ScriptManager.RegisterStartupScript(
        typeof(MyPage), "showjquery", 
        "$(document).ready(function() { showJQueryDialog(); };", 
        true
    )
else
     //log the user in as normal. 
```

把它放在你有的地方：//调用 showJQueryDialog() 打开对话框

**更新 1：**您似乎正在使用更新面板，在这种情况下，您需要使用 ScriptManager.RegisterStartupScript

**更新 2：**您还希望将 js 调用包装在 jquery .ready 调用中，因此在配置对话框之前不会触发它。这比连接主体 onload 更好，因为 onload 等待图像加载，因此 .ready 会更快显示（取决于加载的图像和其他信息位）。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-19T22:43:36.870

由于无法调用客户端函数，我建议在 javascript 中发出决策所需的信息，并使一切都在客户端发生。

或者，您确实需要重新加载页面，如先前评论者所建议的那样。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-19T21:58:59.003

我会保留一个隐藏的 LinkBut​​ton，然后在 javascript 中调用 __doPostBack 方法。

```
<asp:LinkButton runat="server" ID="Renew" OnClick="Renew_Click" style="display:none" /> 
```

**jQuery**

```
$(document).ready(function() {
    $("#dialog").dialog({
       autoOpen: false,
       modal: true,
       buttons: { "Renew Membership": function() { 
          $(this).dialog("close"); 
          __doPostBack('Renew', '');
         // or if inside a master page something like this
          __doPostBack('ctl00$ContentPlaceHolder1$Renew', '');
       } }
    });
}); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-19T23:29:26.290

我真的不明白弗雷迪对此的态度。我可能误解了一些东西。正如devdimi指出的那样，在我看来，这里只有两种可能性。任何一个：

a) 在客户端 onClick javascript 中执行所有逻辑。您可以调用在服务器端 OnClick 中执行操作的 AJAX 方法，然后在 AJAX 回调中调用您的 jQuery 弹出窗口。

b) 进行回发，处理服务器端 OnClick，然后为在正文 onLoad 事件中运行的页面附加 javascript：

body.Attributes.Add("onLoad", "showJQueryDialog();")

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-10-16T17:37:54.087

我对 IE8 有一些类似的问题。

We're using ASP.NET and anytime we do a Response.Redirect within the PageLoad/Control-Events IE8 sets all the base DOM objects to undefined (Image, window, document) But if we do the redirect during the PreInit event then IE8 is fine.. Lovely

# c# - 与在 C# 中隐藏和显示表单相比，关闭表单并重新加载所有数据有什么好处？

> ID：664098
> 
> 赞同：2
> 
> 时间：2009-03-19T21:14:02.747
> 
> 标签：c#, winforms, performance

在 C# 中使用 Windows 表单时，每次完全关闭表单并在再次需要表单时重新加载数据，而不是仅仅隐藏表单并将其全部保存在内存中，是否更安全/更有益的资源？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-03-19T21:18:28.713

我从来不需要这样做来提高资源使用率。
在需要时调出表格并在达到目的后关闭它会更干净，也更安全。否则，您必须编写额外的代码来跟踪是否/哪些表单是打开的，并将它们带到最前面而不是生成一个新的。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-19T21:25:16.997

为什么要自己管理资源？如果您要保留对表单的引用并显示/隐藏它们而不是打开/关闭它们，那么您只是在给自己更多的工作。如果你问我，最好让 GC 释放任何给定表单可能持有的所有资源并关闭它。

此外，如果要显示/隐藏，您会发现很难实现任何类型的模式对话框。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-20T01:49:11.963

如果表单只是显示数据并允许用户输入的地方，并且状态信息不是保存在表单中而是保存在底层模型中，那么可能没有令人信服的理由不在您需要时创建一个新表单。

我不认为表格是保存有关您的程序的任何状态信息的地方，因此您应该能够关闭表格并制作一个新表格而不会出现任何问题。

也就是说，我并不总是遵循自己的建议，并且状态经常潜入我的表单代码中，可能是因为这样做很方便。

我想一个考虑因素是是否有必要进行重要的构造以使表单及其各种控件存在，用数据填充它并将其显示给用户。

# groovy - 重新编译不适用于 groovlet

> ID：664106
> 
> 赞同：1
> 
> 时间：2009-03-19T21:16:50.760
> 
> 标签：groovy

我是 groovy 的新手，非常喜欢它，但发现了一个编译问题。我使用 Jetty 作为网络服务器，它提供*.groovy*文件（groovlets）。

考虑两个文件：

*Test1.groovy*其中包含    

```
println new Test2().property 
```

*Test2.groovy*其中包含：

```
public class Test2 {
   String property = "print this"
} 
```

在浏览器中调用*/Test1.groovy时，它会打印**print this*。但是当我更改其他属性时，它仍然会打印*print this*，它不会重新编译。我唯一能做的就是重新启动码头。请注意，当所有代码都在一个文件中时，重新编译确实有效。

有解决方法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-19T21:56:29.947

谢谢，但不是这样。我越来越近了，编译器可能会被愚弄：在浏览器中

调用*/test2.groovy*时会出现服务器错误，因为 test2.groovy 仅包含类代码（而不是 main 方法），但是当您添加该行时
   `println ""`
对于这个文件，它实际上是在浏览器中调用它时重新编译的。

之后，*test1.groovy*也应该重新编译以使其工作。这不是一个非常整洁的解决方案，但码头不需要以这种方式重新启动......

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-19T21:20:58.660

我认为它始终显示默认值的原因是因为您将`new`其内联...或者这只是示例的问题？

# caching - ASP .Net 输出缓存和 Ajax 控制工具包

> ID：664107
> 
> 赞同：1
> 
> 时间：2009-03-19T21:17:16.063
> 
> 标签：caching, asp.net-ajax, outputcache

我想知道是否有一种特殊的方式来实现输出缓存和使用来自 ajax 控件工具包的控件。我在带有输出缓存的页面上不断收到 javascript 错误，并且选项卡控件显示：ajaxtoolkit（我的程序集前缀）未定义。

这是我添加的指令：

```
<%@ OutputCache Duration="3600" VaryByParam="none" %> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-19T21:34:48.313

> Microsoft 不支持将输出缓存与需要 ScriptReferences 的 ScriptControls、Extender 或 ScriptManagerProxies 结合使用。该问题的解决方法是在输出缓存控件之外的主脚本管理器中包含这些资源所需的脚本引用。

更多信息[在这里](http://connect.microsoft.com/VisualStudio/feedback/ViewFeedback.aspx?FeedbackID=389102)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-28T07:58:46.110

由于输出缓存还不能与 AJAX 框架生成的脚本相结合（希望在未来的版本中可以使用*交叉手指*），因此必须采用其他类型的优化方法，例如将 ScriptManager 替换为 ToolScriptManager。

[http://blog.creonfx.com/performance/howto-optimize-rendering-speed-of-aspnet-ajax-websites](http://blog.creonfx.com/performance/howto-optimize-rendering-speed-of-aspnet-ajax-websites)

# .net - 使用 LINQ 插入后如何检索标识列值

> ID：664109
> 
> 赞同：3
> 
> 时间：2009-03-19T21:17:31.320
> 
> 标签：.net, linq, linq-to-sql

谁能告诉我如何完成以下任务？

```
// Prepare object to be saved
// Note that MasterTable has MasterTableId as a Primary Key and it is an indentity column

MasterTable masterTable = new MasterTable();
masterTable.Column1 = "Column 1 Value";
masterTable.Column2 = 111;

// Instantiate DataContext
DataContext myDataContext = new DataContext("<<ConnectionStrin>>");

// Save the record
myDataContext.MasterTables.InsertOnSubmit(masterTable);
myDataContext.SubmitChanges();

// ?QUESTION?
// Now I need to retrieve the value of MasterTableId for the record just inserted above. 
```

亲切的问候

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-19T21:19:34.013

标识值在您调用 SubmitChanges 后立即分配给插入的对象。

只需访问：

```
masterTable.MasterTableId 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2010-04-12T22:18:39.073

我知道 LINQ to SQL 会自动包装数据库事务中的所有更改。因此，如果我想将返回的 ID 用于另一个插入（我的用户表有一个 AddressID，所以我添加一个新的地址记录，然后添加一个具有该 ID 的新用户记录）并且插入用户时出现问题，地址插入不会回滚。您是否应该将两个 SubmitChanges 都包装在另一个事务中？

# sockets - 如何在 Java 套接字编程中从客户端向服务器发送和接收整数数组？

> ID：664116
> 
> 赞同：0
> 
> 时间：2009-03-19T21:18:34.390
> 
> 标签：sockets, client-server

我在通过套接字连接以两个不同的包将作业（整数数组）从客户端发送到服务器时遇到问题。请问有什么想法吗？

如果我的问题不够清楚，我可以进一步解释。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-19T21:29:03.477

要回答您标题中的问题，我会将 a 包装`SocketOutputStream`在 a`BufferedOutputStream`中并重复`DataOutputStream`使用后者的方法。`writeInt()`或者您可以使用`ObjectOutputStream`代替`DataOutputStream`，并序列化数组：`objOutStream.writeObject(theArray)`。要在另一端再次读取它，只需将`SocketInputStream`in (1) a包装`DataInputStream`并`readInt()`重复使用，或 (2) a`ObjectInputStream`并使用`readObject()`。

（如果您不必与其他语言互操作，`Object*Stream`对您来说更容易）

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-19T21:27:54.540

您必须将其作为数组发送吗？它使整个过程复杂化。为什么不将它包装在一个集合或某种列表中？IE：

```
ObjectOutputStream oos = new ObjectOutputStream(...);
oos.writeObject(integerCollection);

ObjectInputStream ois = new ObjectInputStream(...);
Collection integerCollection = (Collection)ois.readObject(); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2011-06-08T14:39:42.857

您使用什么协议通过您的链接发送这些数据？您可以将数组包装在可以序列化为输出流的对象中。

***TCP：***在这种情况下，事情应该很简单。传输层将负责分割您的对象并在链接的另一端正确处理它。

***UDP：***事情会变得有点复杂；如果您尝试序列化的对象大于 UDP 缓冲区（以字节计），那么您可能无法获取数据。在这种情况下，您可以以小于默认 UDP 缓冲区大小的块发送数据。

问候，

* * *

## 回答 #4

> 赞同：-3
> 
> 时间：2009-11-28T09:08:26.477

使用

```
ArrayList a=new ArrayList(n)    //n represents size 
```

或者

```
List a=new List() 
```

我们可以发送到服务器

# python - dict() 和 {} 有什么区别？

> ID：664118
> 
> 赞同：70
> 
> 时间：2009-03-19T21:19:58.660
> 
> 标签：python, initialization, instantiation

假设我想做一本字典。我们会调用它`d`。但是有多种方法可以在 Python 中初始化字典！例如，我可以这样做：

```
d = {'hash': 'bang', 'slash': 'dot'} 
```

或者我可以这样做：

```
d = dict(hash='bang', slash='dot') 
```

或者这个，奇怪的是：

```
d = dict({'hash': 'bang', 'slash': 'dot'}) 
```

或这个：

```
d = dict([['hash', 'bang'], ['slash', 'dot']]) 
```

以及具有该`dict()`功能的其他多种方式。所以很明显，其中一件事`dict()`是语法和初始化的灵活性。但这不是我要问的。

假设我`d`只做一本空字典。`d = {}`当我做vs时，Python 解释器的幕后发生了什么`d = dict()`？只是做同一件事的两种方法吗？using 是否`{}`有*额外*的调用`dict()`？一个有（甚至可以忽略不计）比另一个更多的开销？虽然这个问题真的完全不重要，但我很想回答这个问题。

* * *

## 回答 #1

> 赞同：78
> 
> 时间：2009-03-19T21:25:14.607

```
>>> def f():
...     return {'a' : 1, 'b' : 2}
... 
>>> def g():
...     return dict(a=1, b=2)
... 
>>> g()
{'a': 1, 'b': 2}
>>> f()
{'a': 1, 'b': 2}
>>> import dis
>>> dis.dis(f)
  2           0 BUILD_MAP                0
              3 DUP_TOP             
              4 LOAD_CONST               1 ('a')
              7 LOAD_CONST               2 (1)
             10 ROT_THREE           
             11 STORE_SUBSCR        
             12 DUP_TOP             
             13 LOAD_CONST               3 ('b')
             16 LOAD_CONST               4 (2)
             19 ROT_THREE           
             20 STORE_SUBSCR        
             21 RETURN_VALUE        
>>> dis.dis(g)
  2           0 LOAD_GLOBAL              0 (dict)
              3 LOAD_CONST               1 ('a')
              6 LOAD_CONST               2 (1)
              9 LOAD_CONST               3 ('b')
             12 LOAD_CONST               4 (2)
             15 CALL_FUNCTION          512
             18 RETURN_VALUE 
```

dict() 显然是一些 C 内置的。一个非常聪明或敬业的人（不是我）可以查看解释器源并告诉您更多信息。我只是想炫耀一下dis.dis。:)

* * *

## 回答 #2

> 赞同：42
> 
> 时间：2009-03-19T21:41:00.827

就性能而言：

```
>>> from timeit import timeit
>>> timeit("a = {'a': 1, 'b': 2}")
0.424...
>>> timeit("a = dict(a = 1, b = 2)")
0.889... 
```

* * *

## 回答 #3

> 赞同：29
> 
> 时间：2009-03-25T12:28:03.537

@Jacob：对象的分配方式有所不同，但它们不是写时复制。Python 分配一个固定大小的“空闲列表”，它可以在其中快速分配字典对象（直到填满）。`{}`通过语法（或 C 调用）分配的字典`PyDict_New`可以来自这个空闲列表。当字典不再被引用时，它会返回到空闲列表，并且可以重用该内存块（尽管首先重置字段）。

第一个字典立即返回到空闲列表，下一个将重用其内存空间：

```
>>> id({})
340160
>>> id({1: 2})
340160 
```

如果你保留一个引用，下一个字典将来自下一个空闲槽：

```
>>> x = {}
>>> id(x)
340160
>>> id({})
340016 
```

但是我们可以删除对该字典的引用并再次释放它的槽：

```
>>> del x
>>> id({})
340160 
```

由于`{}`语法是在字节码中处理的，它可以使用上面提到的这种优化。另一方面，`dict()`它像常规类构造函数一样处理，Python 使用通用内存分配器，它不像上面的空闲列表那样遵循易于预测的模式。

此外，查看 Python 2.6 中的 compile.c，它的`{}`语法似乎是根据解析时已知的它存储的项目数来预先调整哈希表的大小。

* * *

## 回答 #4

> 赞同：9
> 
> 时间：2009-03-19T23:15:01.613

基本上，{} 是一种语法，并在语言和字节码级别进行处理。dict() 只是另一个具有更灵活初始化语法的内置函数。请注意，dict() 仅在 2.x 系列的中间添加。

* * *

## 回答 #5

> 赞同：7
> 
> 时间：2009-03-20T18:44:30.367

*更新*：感谢您的回复。删除了关于写时复制的猜测。

`{}`和之间的另一个区别`dict`是它`dict`总是分配一个新字典（即使内容是静态的），而`{}`并不*总是*这样做（参见[mgood 的回答](https://stackoverflow.com/questions/664118/whats-the-difference-between-dict-and/681358#681358)何时和为什么）：

```
def dict1():
    return {'a':'b'}

def dict2():
    return dict(a='b')

print id(dict1()), id(dict1())
print id(dict2()), id(dict2()) 
```

产生：

```
$ ./mumble.py
11642752 11642752
11867168 11867456

```

我并不是建议您尝试利用这一点，这取决于特定情况，只是指出来。（如果您了解操作码，[反汇编](https://stackoverflow.com/questions/664118/whats-the-difference-between-dict-and/664143#664143)也可能很明显）。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2011-04-29T21:50:46.820

当您想从可迭代对象创建字典时使用 dict()，例如：

```
dict( generator which yields (key,value) pairs )
dict( list of (key,value) pairs ) 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2018-02-06T14:32:34.877

有趣的用法：

```
def func(**kwargs):
      for e in kwargs:
        print(e)
    a = 'I want to be printed'
    kwargs={a:True}
    func(**kwargs)
    a = 'I dont want to be printed'
    kwargs=dict(a=True)
    func(**kwargs) 
```

输出：

```
I want to be printed
a 
```

* * *

## 回答 #8

> 赞同：-1
> 
> 时间：2016-05-31T14:30:01.837

为了创建一个空集，我们应该在它之前使用关键字 set ，即`set()`这会创建一个空集，其中在 dicts 中只有花括号可以创建一个空 dict

让我们举个例子

```
print isinstance({},dict) 
True 
print isinstance({},set) 
False 
print isinstance(set(),set) 
True 
```

# c++ - 'default' 作为变量名

> ID：664123
> 
> 赞同：12
> 
> 时间：2009-03-19T21:20:58.520
> 
> 标签：c++, keyword, names

在调试一些代码时，我遇到了一个名为`default`. 我认为关键字不允许作为变量名。

```
#include "stdafx.h"
#include <stdio.h>

int main()
{
 int default = 5;
 printf("%d\n", default);
 return 0;
} 
```

现在，上面的代码在 VS 2008 上可以顺利编译。'default' 不是关键字吗？它如何作为变量名起作用？副作用？

**PS：** `Infragistics::Win::UltraWinToolbars::ToolbarsCollection`有这个名字的属性！

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2009-03-19T21:23:21.180

这是 VC++ 中的一个[已知问题](http://connect.microsoft.com/VisualStudio/feedback/ViewFeedback.aspx?FeedbackID=382138)。基本上是为了 C++/CLI 兼容性而设计的。

# windows - 如何获取可以在Windows本地登录的用户列表？

> ID：664138
> 
> 赞同：1
> 
> 时间：2009-03-19T21:24:04.643
> 
> 标签：windows, login

有没有办法枚举可以在本地登录的本地（基于 NT）Windows 框上的所有用户？基本上，我需要一个非系统用户列表——这包括管理员，但不包括系统、本地服务和网络服务。

编辑：是的，我需要从代码中执行此操作。由于这是一个编程网站，我认为这是隐含的。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-19T21:42:20.963

```
NET USER
[username [password | *] [options]] [/DOMAIN]
         username {password | *} /ADD [options] [/DOMAIN]
         username [/DELETE] [/DOMAIN]

NET USER creates and modifies user accounts on computers. When used
without switches, it lists the user accounts for the computer. The
user account information is stored in the user accounts database. 
```

你想用代码来做吗？以下讨论可能会有所帮助： http: [//www.codeproject.com/KB/system/EnumerateLocalUser.aspx](http://www.codeproject.com/KB/system/EnumerateLocalUser.aspx)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-20T13:33:36.230

只需使用网络 API。请参阅 MSDN 示例

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-12-17T04:14:01.497

您可以使用 NetQueryDisplayInformation API，结合按位检查用户信息标志。我有完全相同的要求，所以我编写了一个示例代码（从 MSDN GROUP 查询修改）。

我使用的用户标志是 UF_NORMAL_ACCOUNT UF_ACCOUNTDISABLE UF_PASSWD_NOTREQD ---> 这确保我们获得人工账户，人工账户总是需要密码。

工作代码：[http ://www.cceye.com/list-system-normal-user-account-only/](http://www.cceye.com/list-system-normal-user-account-only/)

# gpl - GPL 等许可证如何处理代码的复制？

> ID：664141
> 
> 赞同：8
> 
> 时间：2009-03-19T21:24:26.247
> 
> 标签：gpl

我知道最好尽可能实现其他库（而不是复制代码），但在某些情况下，复制代码更方便。

复制代码的正确礼仪是什么？在您的文件顶部，靠近使用的代码？如果代码被重构得面目全非怎么办？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-03-19T21:30:40.290

GNU GPL 对如何使用通过该许可证获得的代码非常具体。（请注意：如果您对相关代码的许可不是 GPL，而是例如 LGPL，则适用不同的规则。）基本上 GPL 归结为：

*   如果您为自己保留代码并且不将其重新分发给其他任何人，那么您可以使用它做任何您想做的事情而无需承担任何义务。
*   如果您打算与其他人共享您的代码，您只能在 GPL 许可下这样做。这包括您在您的发行版中提供完整的源代码（包括您自己的代码！），您向另一方明确声明此代码是根据 GPL 授权给他们的（包括您自己的代码！），并提供关于您如何更改原始代码。

即使代码被重构得面目全非：如果你想分发它，你必须遵守这些条款并让对方理解你改变了哪些部分（面目全非;-)）。一定不要忘记：**这不是礼仪，这是版权法！**

其他许可证（例如 BSD 许可证）具有不同的条款。例如，如果您使用 BSD 许可下的代码，您只需要保留版权声明，但可以很乐意根据您喜欢选择的任何许可重新分发代码，无论是否带有源代码。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-19T21:28:21.857

这取决于许可证的类型。

一般来说，许可证希望保护它们不是您的作品，而是对所有人免费的事实。这通常包括在您的项目中某处的许可证。

您可以在以下位置找到许多开源许可证及其条款的列表：[http ://www.opensource.org/licenses/alphabetical](http://www.opensource.org/licenses/alphabetical)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-19T21:37:20.930

将代码复制到您正在做的事情中是合法地创建衍生作品，因此您必须遵守许可要求。我看过的所有开源/自由软件许可证都要求保留归属，所以这不仅仅是礼仪问题。

如果您在某处有一份信用清单，则应确保许可人在该清单中。如果它在自己的单独部分中（它自己的文件或较大文件的一部分），最好标记它并（当然）对其进行归因。

如果它被重构得面目全非，它仍然是衍生作品，而且你还在使用别人的代码，所以在法律和道德上你必须给予信任。

您当然必须遵守所有其他限制。你提到了 GPL；在这种情况下，整个产品必须根据 GPL 重新分发，或者根本不重新分发。代码是否被重构得面目全非并在文件中拆分并不重要，只要您在代码中直接使用该代码即可。代码的不同部分当然可能需要额外的许可，只要它们与 GPL 兼容，但您必须遵守 GPL 的要求才能重新分发。

# php - 如何在 PHP 中访问 POST 数据？

> ID：664148
> 
> 赞同：26
> 
> 时间：2009-03-19T21:27:17.613
> 
> 标签：php, http, post

我需要编写一个 PHP 页面来接受通过 POST 请求发送的 XML 文档，如下所示：

```
POST /mypage.php HTTP/1.1
Host: myhost.com
Content-Type: application/xml
Content-Length: ...

<?xml version="1.0" encoding="utf-8"?>
<data>
 ...
</data> 
```

这不是来自某些 HTML 表单的数据，只是一个普通的 XML 文档。

如何在我的 PHP 代码中访问此 XML？

* * *

## 回答 #1

> 赞同：39
> 
> 时间：2009-03-19T21:30:02.630

从 读取[`php://input`](http://php.net/wrappers.php)。例如，您可以使用：

```
$rawdata = file_get_contents('php://input'); 
```

或者

```
$rootNode = simplexml_load_file('php://input'); 
```

替代方法 using[`$HTTP_RAW_POST_DATA`](http://php.net/manual/en/reserved.variables.httprawpostdata.php)也可以使用 - 但速度较慢并且需要 PHP 配置[`always_populate_raw_post_data`](http://php.net/manual/en/ini.core.php#ini.always-populate-raw-post-data)。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-03-19T21:29:49.760

尝试[`$HTTP_RAW_POST_DATA`变量](http://docs.php.net/manual/en/reserved.variables.httprawpostdata.php)或[`php://input`流](http://docs.php.net/manual/en/wrappers.php.php)。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-19T21:30:09.353

[http://us.php.net/manual/en/reserved.variables.httprawpostdata.php](http://us.php.net/manual/en/reserved.variables.httprawpostdata.php)

假设请求的内容类型不是 multipart/form-data，则 $HTTP_RAW_POST_DATA 应该可用

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-03-19T21:31:04.907

[$HTTP_RAW_POST_DATA](http://www.php.net/manual/en/reserved.variables.httprawpostdata.php)

或者

[php://输入](http://www.php.net/wrappers.php)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-19T21:33:40.687

您可能想要使用[PHP 输入](http://us2.php.net/wrappers.php)。就像是

```
$postText = trim(file_get_contents('php://input')); 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2014-11-04T14:06:00.873

这些中的任何一个都可以：

```
$HTTP_RAW_POST_DATA variable or the php://input stream. 
```

然而，对于

```
$HTTP_RAW_POST_DATA variable 
```

要工作，您可能需要更改配置文件中的 .ini 设置

* * *

## 回答 #7

> 赞同：-2
> 
> 时间：2009-03-19T21:30:13.847

如果你使用 print_r($_POST); 你将能够看到你得到了什么。除非我遗漏了什么......编辑：nvm，完全忘记了原始数据：/

# java - 使用 JMS，有没有办法将消息存储在间歇性断开的客户端上，并在网络可用时将它们转发到代理？

> ID：664154
> 
> 赞同：2
> 
> 时间：2009-03-19T21:29:38.997
> 
> 标签：java, networking, jakarta-ee, jms, disconnected

我正在考虑一种架构，其中我的客户端间歇性地连接到网络。当网络不可用时，我想将在这些客户端上创建的消息存储在 JMS 队列中，并在客户端在网络上时将这些消息转发到中央消息代理。（用户可以控制网络，例如拨入，所以它不是像手机那样的断断续续的连接。）

是否有任何提供此功能的 JMS 实现？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-20T10:01:40.483

您可以将 activeMQ 代理嵌入到您的应用程序中

[http://activemq.apache.org/how-do-i-embed-a-broker-inside-a-connection.html](http://activemq.apache.org/how-do-i-embed-a-broker-inside-a-connection.html)

然后，我想（没有测试）您可以使用 ActiveMQ 功能，这些功能允许您使用代理发现功能在代理网络中发送消息，

[http://activemq.apache.org/clustering.html](http://activemq.apache.org/clustering.html)

或者简单地通过添加队列消费者服务器端，然后通过此消费者通过其他代理进行调度。

希望能帮助到你。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-22T11:19:25.100

Glassfish Open Message Queue 可以在 4.4 版中嵌入（或独立运行）（支持代理与任何客户端“在进程中”运行的能力。）。它非常轻量级，并且将在 4.4 版中通过 STOMP 协议支持其他客户端语言 - 除了 Java 和 C。 - [https://mq.dev.java.net/4.4.html](https://mq.dev.java.net/4.4.html)

# java - 如何在启动时在 JVM 中预加载 Web 应用程序类？

> ID：664161
> 
> 赞同：4
> 
> 时间：2009-03-19T21:30:49.807
> 
> 标签：java, performance, web-applications, jvm, classloader

在我们的 Web 应用程序中，由于类加载，某些页面的第一次加载需要花费少量但值得注意的额外时间。有没有人有任何聪明的方法在启动时在 JVM 中预加载 Web 应用程序类？

* * *

*更新*：我们现在要做的是在 db 表中存储一堆（700）完整的类名。我们在启动时读取表格并执行 Class.forName()。它工作正常，但我认为可能有更聪明的方法。我们使用分析器确定了启动时引用的 700 个类。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-21T13:48:46.847

您可以尝试在单个虚拟类中编写静态初始化程序代码，然后在启动时加载该类。它的静态初始化器将创建一些关键对象，这些对象会导致加载其他类（您可以递归地执行此操作以提高代码模块化）。我敢打赌，这会更短更简单（而且您无需担心数据库问题）。

更好的方法可能是编写一个 servlet，它在启动时会遇到一些加载缓慢的页面并丢弃结果。这会强制加载类。**多次**加载这些页面将增加完成的即时编译量（加速您的代码并减少 JIT 编译成本）。还有其他优点：这是一种“开机自检”，它会导致一次性启动任务完成，并且它还可以在一定程度上启动各种缓存。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-19T21:37:55.967

`load-on-startup`好吧，它不是很聪明，因为它是规范的一部分，但是您可以通过将元素添加到 servlet 定义中来让您的 servlet 在 Web 应用程序启动时启动`web.xml`：

```
<servlet>
  <description>....</description>
  <display-name>....</display-name>
  <servlet-name>....</servlet-name>
  <servlet-class>....t</servlet-class>
  <load-on-startup>1</load-on-startup>
</servlet> 
```

如果您为一组有代表性的服务执行此操作——或者可能只是一个可以预加载所需所有内容的 servlet——那么您将实现您的目标。

如果这还不够，例如，如果您想从 JAR 文件中加载类，而不是以有意义的方式实际初始化它们，并且如果您知道您的 JAR 文件在哪里或者可以找出您的 JAR 文件在哪里，那么您可以使用类似于[此 JCP 论坛帖子“列出包中的类”](http://forums.sun.com/thread.jspa?messageID=4316764#4316764)或该线程中的一些后续帖子中的代码。从类列表中，您可以获取 Class 对象，这将有助于加载类而无需实际实例化实例。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-20T00:03:05.837

线程内的 Class.forName 可能会加快速度。从第一页上可能被点击的那些开始。

线程化它应该使启动更快（它会更早返回），并且由于您首先开始加载更有可能的类，因此它们有望在页面被点击时被加载。对于其他相同的交易，希望在页面被点击之前加载。

您还可以更进一步并为每组类启动一个线程（给定页面上需要的那些类将是一个组）。这可能会加快速度，因为您可以并行化从磁盘读取（但这也可能会减慢速度）。

这并不能保证在第一次加载页面时速度不会变慢，但值得研究。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-19T21:35:50.980

Class.forName() 是我唯一能想到的。我当然有兴趣听到更聪明的选择。

另一种选择是选择一组 URL 并在启动时运行脚本来访问这些 URL。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-20T07:11:08.007

也许您可以尝试将 700 个类转换为 jar 文件并应用一些方法进行预加载，可能是将 jar 放在引导类路径中（我不确定它是否有效..但只是给出一个提示）。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-19T21:36:44.190

您始终可以使用第三方 jsp 编译器（例如 Jasper）在部署 JSP 页面之前对其进行预编译。

# ms-access - 如何检查 VBA DAO 记录集中的空值？

> ID：664162
> 
> 赞同：18
> 
> 时间：2009-03-19T21:30:54.830
> 
> 标签：ms-access, null, vba, dao

我在使用 DAO 记录集提取的数据库中有一个可选字段。在将其与其他字段连接之前，我需要检查该字段是否已设置。到目前为止，我已经尝试了以下代码片段，`Is`并且`=`（这显然是错误的语法`[[Is | =]]`）无济于事。看来，如果我使用`=`它将无法正确比较，`Null`如果我使用`Is`它，它会抱怨它没有与对象进行比较。

```
While Not rs.EOF
    If rs.Fields("MiddleInitial") [[Is | =]] Null Then thisMiddleInitial = "" Else thisMiddleInitial = rs.Fields("MiddleInitial")
    If prettyName(myLastName, myFirstName, myMiddleInitial) = prettyName(rs.Fields("LastName"), rs.Fields("FirstName"), thisMiddleInitial) Then
        MsgBox "Yay!"
    End If
    rs.MoveNext
Wend 
```

如果有更简单的方法可以做到这一点，我完全愿意接受。prettyName 将 3 个字符串作为参数，最初我只是试图直接传递 rs.Fields("MiddleName") 但它以 Null 值抛出。我宁愿做一些更直接的事情，但这是我能想到的最好的。

* * *

## 回答 #1

> 赞同：37
> 
> 时间：2009-03-19T21:37:13.050

怎么样：

```
IsNull(rs.Fields("MiddleInitial").Value) 
```

您还可以查看[这篇文章](https://web.archive.org/web/1/http://articles.techrepublic%2ecom%2ecom/5100-10878_11-5034252.html)，其中对 Access VBA 应用程序中的 Null 值以及如何处理它们进行了一些解释。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-03-19T22:02:21.413

对于您展示的示例， Nz 可以工作：

```
 thisMiddleInitial = Nz(rs!MiddleInitial,"") 
```

或者简单地将字符串与空字符串连接：

```
 thisMiddleInitial = rs!MiddleInitial & "" 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-20T00:05:04.350

在我看来，Remou 已经回答了您的问题，但在我看来，您可能只是在尝试正确连接名称字段。在这种情况下，您可以在 VBA 中使用 Mid() 和 Null 传播来获得结果。

我不使用单独的中间初始字段，所以我通常的名称连接公式是：

```
Mid(("12" + LastName) & (", " + FirstName), 3) 
```

如果 LastName 为 Not Null，则开头的“12”字符串将被丢弃，如果*为*null，则将被忽略，因为 + 连接运算符传播 Null。

要将其扩展为包括中间字母，如下所示：

```
Mid(("12" + LastName) & (", " + FirstName) & (" " + MiddleInitial), 3) 
```

假设您的 UDF 没有对昵称/缩写/等进行某种复杂的清理，在我看来，这可以完全取代它。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-12-12T19:08:11.580

`If rst.Fields("MiddleInitial").Value = "Null" Then`

这对我有用。我使用 MS SQL 数据库。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2018-06-29T13:51:12.163

我认为 NoMatch 选项可能适用于这种情况：

如果 rs.NoMatch = True 那么

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2018-10-18T01:15:05.973

我更喜欢使用下面的方法来解释 Null 和 Empty 字符串值。使用表单从用户那里收集值是一个很好的检查。

```
If Trim(rs.Fields("MiddleInitial") & "") = "" then 
```

# javascript - 为什么我的代码在 JavaScript 中返回错误“missing : after property id”？

> ID：664166
> 
> 赞同：4
> 
> 时间：2009-03-19T21:32:50.300
> 
> 标签：javascript, arrays, json

这应该如何编写才能真正起作用？

```
saveBuyerInfo( 
    { 'save_'+$("#textAreaXMLPostRequest").attr('name') :
    $("#textAreaXMLPostRequest").val() } ); 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-03-19T21:38:17.947

您不能将表达式作为对象文字中的键。相反，首先创建您的对象：

```
var save = {};
save['save_' + $("#textAreaXMLPostRequest").attr('name')] = $("#textAreaXMLPostRequest").val();
saveBuyerInfo(save); 
```

# .net - 如何制作一个类型安全的项目包，它们都实现了一个通用接口？

> ID：664172
> 
> 赞同：2
> 
> 时间：2009-03-19T21:35:58.187
> 
> 标签：.net, generics

需要有一个**类型安全**的项目包，它们都实现了一个通用接口。

愿望是做类似的事情：

```
var stringItem = new IItem<string>();
var numberItem = new IItem<int>();
var items = new List<IItem<T>>(); //T of course doesn't accomplish what I want

items.Add(stringItem);
items.Add(numberItem); 
```

就像是：

```
interface IItem
{
   object Value { get; set; }
}

//Update: 2009-03-19 03:08 PM MST
//Added the following interface for clarity of my question

interface IItem<T> : IItem
{
   new T Value { get; set; }
} 
```

然后，我可以：

```
var items = new List<IItem>(); 
```

但是，我在我的包里失去了类型安全。所以，我想到了`Dictionary`：

```
var dict = new Dictionary<Type, List<IItem<T>>>(); //T is wrong again

dict.Add(typeof(string), new List<IItem<string>>); //that sure looks nice 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-19T21:46:20.533

我认为您无法逃避`IItem<int>`和`IItem<string>`不同的事实；通常的方法是基本接口：

```
interface IItem {
   object Value {get;}
}
interface IItem<T> : IItem {
   new T Value {get;}
} 
```

这样，您对 进行编码`IItem`，但实际实例（通常`IItem<T>`为 some实现`T`）在内部仍然是强类型的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-19T21:45:41.597

[在此处](http://www.removingalldoubt.com/permalink.aspx/a2934e63-8a08-4fcf-9f5b-88ba1f50f7c7)查看 PolyDictionary 实现。

```
class Key<T> { public Key() { } }

class PolyDictionary {
    private Dictionary<object, object> _table;

    public PolyDictionary() {
        _table = new Dictionary<object, object>();
    }

    public void Add<T>(Key<T> key, T value) {
        _table.Add(key, value);
    }

    public bool Contains<T>(Key<T> key) {
        return _table.ContainsKey(key);
    }

    public void Remove<T>(Key<T> key) {
        _table.Remove(key);
    }

    public bool TryGetValue<T>(Key<T> key, out T value) {
        object objValue;
        if (_table.TryGetValue(key, out objValue)) {
            value = (T)objValue;
            return true;
        }
        value = default(T);
        return false;
    }

    public T Get<T>(Key<T> key) {
        T value;
        if (!TryGetValue(key, out value))
            throw new KeyNotFoundException();
        return value;
    }

    public void Set<T>(Key<T> key, T value) {
        _table[key] = value;
    }
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-19T21:46:00.860

您应该能够摆脱执行以下操作

```
interface IItem { object Value {get; set;}}

interface IItem<T> : IItem { T Value {get; set;}}

var items = new List<IItem>();

items.add(new IItem<string>());
items.add(new IItem<int>()); 
```

但是当你把它拉出来时，你仍然需要做一些铸造。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-19T23:23:54.837

创建一个新类，其唯一目的是将您感兴趣的值装箱。 - 该类应接受 StringItem 或 NumberItem。- 该类应允许您访问字符串或数字项成员。

当您将对象添加到列表中时，您需要将对象装箱，然后在再次取出时将它们拆箱。

如果这是 C++，那么这个设计的开销不应该超过一个额外的指针解引用，这取决于你如何实现它，但是这里的关键短语是“装箱”和“拆箱”。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-20T17:46:04.750

```
public class GrabBag<T>
{
    private ArrayList inner = new ArrayList();

    public void Add(T item)
    {
        inner.Add(item);
    }

    public IEnumerable<U> Get<U>() where U : T
    {
        return inner.OfType<U>();
    }
} 
```

或者，您可以只使用通用列表并调用 OfType。这更有意义。

# iphone - 如何使用 UIActionSheet 传递参数？

> ID：664188
> 
> 赞同：8
> 
> 时间：2009-03-19T21:43:31.553
> 
> 标签：iphone, objective-c

我弹出了一个操作表，我想将某个参数传递给按钮处理方法。

### 例如：

我有一个表，我想传递给在表中选择的按钮处理方法行号。

我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-03-19T22:08:17.563

您必须提前在您的委托中设置它。然后，当您的代理收到按钮按下通知时，您可以使用此值。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2011-04-22T23:59:22.423

如果是整数参数，则将其作为`tag`操作表的属性。否则，您可以子类化操作表并将变量放在那里，或使用关联引用。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-11-08T07:38:42.680

如果要传递整数，请使用 UIActionSheet.tag。如果要传递 NSString，请使用 UIActionSheet.accessibilityValue。

这些简单易行。无需创建实例变量。

# silverlight - SilverLight 3 Out of Browser 体验参数传递

> ID：664189
> 
> 赞同：1
> 
> 时间：2009-03-19T21:43:44.050
> 
> 标签：silverlight, silverlight-3.0

我有一个使用 Silverlight 2 制作的视频播放器，要传递参数，我将在 SilverLight 对象标签内托管它的 html 文件中包含以下内容：

```
<param name="initParams" value="path=http://foo.bar/pathToVid.wmv,
                                                autoplay=false" /> 
```

这在浏览器中有效，但在 SilverLight 3 中具有“浏览器外”体验，HTML 文件在内部自动生成：

> AppData\LocalLow\Microsoft\Silverlight\Offline{{主机名}}.n\index.html

或 OS X 上的等价物；所以这真的行不通。

我想在应用程序启动后使用命令行参数并将其用作视频源，将我的 SilverLight 应用程序变成通用视频播放器。有没有办法用浏览器 SilverLight 来做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-01T01:22:24.190

在 Silverlight 3 Beta 的当前状态下，无法在启动时将参数传递给应用程序。

如果您希望应用程序在浏览器之外运行，您可能需要重新考虑应用程序的功能。如果您的最终用户可以选择他们想要播放的视频的位置，您应该让他们能够在您的应用程序中输入该 URL，而不是将其作为参数传递。另一方面，如果您希望 URL 是动态的但由第三方提供，您可以构建一个在您的站点上运行的服务，该服务在运行时向您的 Silverlight 应用程序提供 URL。

请记住，如果您正在谈论第二个，您需要构建某种连接检查，以便应用程序在启动时不会坐在那里旋转它的轮子......

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-24T01:41:29.193

对于一些小信息，您可能会将一些数据写入隔离存储，然后从浏览器外的应用程序中读取。

# java - 如何在 Java 中使用正则表达式查找重复字符？

> ID：664194
> 
> 赞同：22
> 
> 时间：2009-03-19T21:45:28.553
> 
> 标签：java, regex

谁能给我一个 Java 正则表达式来识别字符串中的重复字符？我只寻找立即重复的字符，它们可以是字母或数字。

### 例子：

> abccde <- 寻找这个（立即重复 c）
> 
> abcdce <- 不是这个（c 由另一个字符分隔）

* * *

## 回答 #1

> 赞同：40
> 
> 时间：2009-03-19T21:50:23.550

尝试`"(\\w)\\1+"`

`\\w`匹配任何单词字符（字母、数字或下划线）并匹配第一组括号中的`\\1+`任何内容，一次或多次。因此，您最终会匹配任何出现的单词字符，然后立即再次匹配一个或多个相同的单词字符。

（请注意，我将正则表达式作为 Java 字符串提供，即反斜杠已经为您加倍了）

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2009-03-19T22:15:49.353

```
String stringToMatch = "abccdef";
Pattern p = Pattern.compile("(\\w)\\1+");
Matcher m = p.matcher(stringToMatch);
if (m.find())
{
    System.out.println("Duplicate character " + m.group(1));
} 
```

* * *

## 回答 #3

> 赞同：-6
> 
> 时间：2009-03-19T21:59:58.487

正则表达式很昂贵。最好只存储最后一个字符并检查下一个字符是否相同。类似于以下内容：

```
String s;
char c1, c2;
c1 = s.charAt(0);
for(int i=1;i<s.length(); i++){
    char c2 = s.charAt(i);

    // Check if they are equal here

    c1=c2;
} 
```

# php - 对于最佳实践/维护，您会在我的代码中进行哪些更改？

> ID：664200
> 
> 赞同：1
> 
> 时间：2009-03-19T21:47:37.877
> 
> 标签：php

我在下面有一小段代码，我很好奇你会在最佳实践/代码可维护性等方面改变什么类型的东西。

```
function _setAccountStatus($Username, $AccountStatus)
{
if ($Username == '' || ($AccountStatus != 'Active' || $AccountStatus != 'Banned' || $AccountStatus != 'Suspended')) {
    // TODO: throw error here.
}

$c1 = new Criteria();

$c1->add(UsersPeer::USERNAME,$Username);

$rs = UsersPeer::doSelect($c1);

if (count($rs) > 0) {
    $UserRow = array_pop($rs);

    $UserRow->setAccountStatus($AccountStatus);

    try {
        $UserRow->save();
    } catch ( PropelException $e ) {
        return false;
    }

    return true;
}

return false;
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-19T23:00:26.657

我会在你的 if 语句中使用[empty()](http://us.php.net/manual/en/function.empty.php)而不是 $Username == '' 。我以前没有使用过推进器，但我更愿意将此方法放在我的用户对象本身上，并由单独的对象执行用户对象的获取和保存。伪代码将是这样的。

$user = userManager->getUser($username); $user->setAccountStatus($accountStatus); $userManager->saveUser($user);

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-21T01:42:01.393

最后一个 return false 之前的 else 子句将是首选，只是为了使代码更具可读性。

# php - 如何使用 SimpleXML 解析 XML 以获取多个文本块？

> ID：664202
> 
> 赞同：1
> 
> 时间：2009-03-19T21:48:01.823
> 
> 标签：php, xml, parsing, simplexml

我想解析一些看起来像这样的 XML：

```
<node>
  This is
  <child>
    blah
  </child>
  some
  <child>
    foo
  </child>
  text
</node> 
```

如何访问 Simple XML 中的文本节点子节点？

我可以按正确的文本和元素子项顺序访问它们吗？

我需要一些其他的包吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-19T23:34:12.893

我强烈建议通过 SimpleXML切换到[DOM 函数。](http://au2.php.net/manual/en/book.dom.php)前段时间我有一个这样的答案，[它不是很受欢迎](https://stackoverflow.com/questions/68565/what-xml-parser-do-you-use-for-php/68615#68615)，但我仍然坚持。DOM 函数非常强大：额外的冗长是值得的。

```
$doc = new DOMDocument();
$doc->loadXML($xmlString);

foreach ($doc->documentElement->childNodes as $node) {
    if ($node->nodeType === XML_TEXT_NODE) {
        echo $node->nodeValue . "\n";
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-19T21:56:22.880

```
foreach($this->xml->xpath('/node/child') as $child){
   ...
} 
```

# asp.net-mvc - ViewModel 最佳实践

> ID：664205
> 
> 赞同：240
> 
> 时间：2009-03-19T21:48:58.123
> 
> 标签：asp.net-mvc, asp.net-mvc-viewmodel

从[这个问题来看，让控制器创建一个更准确地反映视图试图显示的模型的](https://stackoverflow.com/questions/526641/what-to-put-in-your-viewmodel)**ViewModel**似乎是有意义的，但我对一些约定很好奇（我是 MVC 模式的新手，如果它还不是很明显）。

基本上，我有以下问题：

1.  我通常喜欢有一个类/文件。**如果创建ViewModel**只是为了将数据从控制器传递到视图，这对它有意义吗？
2.  如果**ViewModel**确实属于它自己的文件，并且您使用目录/项目结构来保持独立，那么**ViewModel**文件属于哪里？在**控制器**目录中？

目前基本上就是这样。我可能还有一些问题要问，但这在过去一个小时左右一直困扰着我，我似乎可以在其他地方找到一致的指导。

**编辑：** 查看 CodePlex 上的示例[NerdDinner 应用程序](http://nerddinner.codeplex.com/)，看起来 ViewModels 是[Controllers](http://nerddinner.codeplex.com/SourceControl/changeset/view/18010#439996)的一部分，但它们不在自己的文件中仍然让我感到不舒服。

* * *

## 回答 #1

> 赞同：213
> 
> 时间：2009-03-29T05:55:07.943

我为每个视图创建了我称之为“ViewModel”的东西。我将它们放在我的 MVC Web 项目中名为 ViewModels 的文件夹中。我以它们所代表的控制器和操作（或视图）来命名它们。因此，如果我需要将数据传递给 Membership 控制器上的 SignUp 视图，我会创建一个 MembershipSignUpViewModel.cs 类并将其放入 ViewModels 文件夹中。

然后我添加了必要的属性和方法，以方便将数据从控制器传输到视图。我使用 Automapper 从我的 ViewModel 到 Domain Model 并在必要时再次返回。

这也适用于包含其他 ViewModel 类型的属性的复合 ViewModel。例如，如果您在成员控制器的索引页面上有 5 个小部件，并且您为每个局部视图创建了一个 ViewModel - 您如何将数据从索引操作传递给局部视图？您向 MyPartialViewModel 类型的 MembershipIndexViewModel 添加一个属性，并且在渲染局部时您将传入 Model.MyPartialViewModel。

这样做可以让您调整部分 ViewModel 属性，而无需更改索引视图。它仍然只是在 Model.MyPartialViewModel 中传递，因此当您所做的只是向部分 ViewModel 添加属性时，您必须通过整个部分链来修复某些东西的可能性较小。

我还将命名空间“MyProject.Web.ViewModels”添加到 web.config，以便允许我在任何视图中引用它们，而无需在每个视图上添加显式导入语句。只是让它更干净一点。

* * *

## 回答 #2

> 赞同：129
> 
> 时间：2009-10-06T23:07:42.260

按类别（控制器、视图模型、过滤器等）分离类是无稽之谈。

如果您想为网站的 Home 部分 (/) 编写代码，则创建一个名为 Home 的文件夹，并将 HomeController、IndexViewModel、AboutViewModel 等以及 Home 操作使用的所有相关类放在那里。

如果您有共享类，例如 ApplicationController，您可以将它放在项目的根目录中。

为什么要将相关的东西（HomeController、IndexViewModel）分开，而把完全没有关系的东西（HomeController、AccountController）放在一起？

* * *

我写了[一篇](http://maxtoroq.github.io/2013/02/aspnet-mvc-workflow-per-controller.html)关于这个主题的博客文章。

* * *

## 回答 #3

> 赞同：21
> 
> 时间：2009-03-25T21:53:06.503

我将我的应用程序类保存在一个名为“Core”（或单独的类库）的子文件夹中，并使用与[KIGG](http://www.codeplex.com/Kigg)示例应用程序相同的方法，但稍作改动以使我的应用程序更加干燥。

我在 /Core/ViewData/ 中创建了一个 BaseViewData 类，其中存储了常见的站点范围属性。

在此之后，我还在同一个文件夹中创建了所有视图 ViewData 类，然后从 BaseViewData 派生并具有视图特定属性。

然后我创建了一个 ApplicationController，我的所有控制器都从它派生。ApplicationController 有一个通用的 GetViewData 方法，如下所示：

```
protected T GetViewData<T>() where T : BaseViewData, new()
    {
        var viewData = new T
        {
           Property1 = "value1",
           Property2 = this.Method() // in the ApplicationController
        };
        return viewData;
    } 
```

最后，在我的控制器操作中，我执行以下操作来构建我的 ViewData 模型

```
public ActionResult Index(int? id)
    {
        var viewData = this.GetViewData<PageViewData>();
        viewData.Page = this.DataContext.getPage(id); // ApplicationController
        ViewData.Model = viewData;
        return View();
    } 
```

我认为这非常有效，它可以让你的视图保持整洁，让你的控制器保持精简。

* * *

## 回答 #4

> 赞同：13
> 
> 时间：2009-03-19T22:34:00.700

ViewModel 类用于将由类实例表示的多条数据封装到一个易于管理的对象中，您可以将其传递给您的视图。

将 ViewModel 类放在自己的文件中，在自己的目录中是有意义的。在我的项目中，我有一个名为 ViewModels 的 Models 文件夹的子文件夹。这就是我的 ViewModel（例如`ProductViewModel.cs`）所在的位置。

* * *

## 回答 #5

> 赞同：13
> 
> 时间：2009-03-25T21:47:59.510

没有保存模型的好地方。如果项目很大并且有很多 ViewModel（数据传输对象），您可以将它们保存在单独的组件中。您也可以将它们保存在站点项目的单独文件夹中。例如，在[Oxite](http://www.codeplex.com/oxite)中，它们被放置在 Oxite 项目中，该项目也包含许多不同的类。Oxite 中的控制器被移动到单独的项目中，并且视图也在单独的项目中。
在[CodeCampServer](http://code.google.com/p/codecampserver/)中，ViewModel 被命名为 *Form，它们被放置在 UI 项目的 Models 文件夹中。
在[MvcPress](http://www.codeplex.com/mvcpress)项目中，它们被放置在 Data 项目中，该项目还包含所有与数据库一起使用的代码等等（但我不推荐这种方法，它只是一个示例）
所以你可以看到有很多观点。我通常将我的 ViewModel（DTO 对象）保存在站点项目中。但是当我有超过 10 个模型时，我更喜欢将它们移动到单独的装配中。通常在这种情况下，我也会将控制器移动到单独的组件中。
另一个问题是如何轻松地将所有数据从模型映射到您的 ViewModel。我建议看看[AutoMapper](http://www.codeplex.com/AutoMapper)库。我非常喜欢它，它为我做了所有肮脏的工作。
我也建议看看[SharpArchitecture](http://code.google.com/p/sharp-architecture/)项目。它为项目提供了非常好的架构，并且包含许多很酷的框架和指南以及很棒的社区。

* * *

## 回答 #6

> 赞同：6
> 
> 时间：2010-07-08T06:31:38.060

这是我的最佳实践中的代码片段：

```
 public class UserController : Controller
    {
        private readonly IUserService userService;
        private readonly IBuilder<User, UserCreateInput> createBuilder;
        private readonly IBuilder<User, UserEditInput> editBuilder;

        public UserController(IUserService userService, IBuilder<User, UserCreateInput> createBuilder, IBuilder<User, UserEditInput> editBuilder)
        {
            this.userService = userService;
            this.editBuilder = editBuilder;
            this.createBuilder = createBuilder;
        }

        public ActionResult Index(int? page)
        {
            return View(userService.GetPage(page ?? 1, 5));
        }

        public ActionResult Create()
        {
            return View(createBuilder.BuildInput(new User()));
        }

        [HttpPost]
        public ActionResult Create(UserCreateInput input)
        {
            if (input.Roles == null) ModelState.AddModelError("roles", "selectati macar un rol");

            if (!ModelState.IsValid)
                return View(createBuilder.RebuildInput(input));

            userService.Create(createBuilder.BuilEntity(input));
            return RedirectToAction("Index");
        }

        public ActionResult Edit(long id)
        {
            return View(editBuilder.BuildInput(userService.GetFull(id)));
        }

        [HttpPost]
        public ActionResult Edit(UserEditInput input)
        {           
            if (!ModelState.IsValid)
                return View(editBuilder.RebuildInput(input));

            userService.Save(editBuilder.BuilEntity(input));
            return RedirectToAction("Index");
        }
} 
```

* * *

## 回答 #7

> 赞同：5
> 
> 时间：2009-09-23T04:07:18.937

我们将所有的 ViewModel 都放在 Models 文件夹中（我们所有的业务逻辑都在一个单独的 ServiceLayer 项目中）

* * *

## 回答 #8

> 赞同：4
> 
> 时间：2009-03-19T22:21:48.560

就个人而言，我建议如果 ViewModel 不是微不足道的，那么请使用单独的类。

如果您有多个视图模型，那么我建议将其至少分区到一个目录中是有意义的。如果稍后共享视图模型，则目录中隐含的名称空间可以更轻松地移动到新程序集。

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2009-05-21T15:49:20.257

在我们的例子中，我们在一个与视图分开的项目中拥有模型和控制器。

根据经验，我们尝试将大部分 ViewData["..."] 内容移动并避免到 ViewModel 中，因此我们避免了强制转换和魔术字符串，这是一件好事。

ViewModel 还包含一些常见属性，例如列表的分页信息或用于绘制面包屑和标题的页面标题信息。目前基类在我看来包含的信息太多，我们可以将它分为三部分，基本视图模型上 99% 页面的最基本和必要的信息，然后是列表模型和模型对于包含该场景的特定数据并从基础数据继承的表单。

最后，我们为每个实体实现一个视图模型来处理特定的信息。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2010-01-18T04:10:03.820

控制器中的代码：

```
 [HttpGet]
        public ActionResult EntryEdit(int? entryId)
        {
            ViewData["BodyClass"] = "page-entryEdit";
            EntryEditViewModel viewMode = new EntryEditViewModel(entryId);
            return View(viewMode);
        }

    [HttpPost]
    public ActionResult EntryEdit(Entry entry)
    {
        ViewData["BodyClass"] = "page-entryEdit";            

        #region save

        if (ModelState.IsValid)
        {
            if (EntryManager.Update(entry) == 1)
            {
                return RedirectToAction("EntryEditSuccess", "Dictionary");
            }
            else
            {
                return RedirectToAction("EntryEditFailed", "Dictionary");
            }
        }
        else
        {
            EntryEditViewModel viewModel = new EntryEditViewModel(entry);
            return View(viewModel);
        }

        #endregion
    } 
```

视图模型中的代码：

```
public class EntryEditViewModel
    {
        #region Private Variables for Properties

        private Entry _entry = new Entry();
        private StatusList _statusList = new StatusList();        

        #endregion

        #region Public Properties

        public Entry Entry
        {
            get { return _entry; }
            set { _entry = value; }
        }

        public StatusList StatusList
        {
            get { return _statusList; }
        }

        #endregion

        #region constructor(s)

        /// <summary>
        /// for Get action
        /// </summary>
        /// <param name="entryId"></param>
        public EntryEditViewModel(int? entryId)
        {
            this.Entry = EntryManager.GetDetail(entryId.Value);                 
        }

        /// <summary>
        /// for Post action
        /// </summary>
        /// <param name="entry"></param>
        public EntryEditViewModel(Entry entry)
        {
            this.Entry = entry;
        }

        #endregion       
    } 
```

项目：

*   DevJet.Web（ASP.NET MVC Web 项目）

*   DevJet.Web.App.Dictionary（一个单独的类库项目）

    在这个项目中，我创建了一些文件夹，例如：DAL、BLL、BO、VM（视图模型的文件夹）

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2014-07-06T06:49:53.117

创建一个视图模型基类，它具有操作结果和上下文数据等常用属性，您还可以放置当前用户数据和角色

```
class ViewModelBase 
{
  public bool HasError {get;set;} 
  public string ErrorMessage {get;set;}
  public List<string> UserRoles{get;set;}
} 
```

在基本控制器类中有一个类似 PopulateViewModelBase() 的方法，该方法将填充上下文数据和用户角色。HasError 和 ErrorMessage ，如果在从 service/db 提取数据时出现异常，请设置这些属性。在视图上绑定这些属性以显示错误。用户角色可用于根据角色在视图上显示隐藏部分。

要在不同的 get 操作中填充视图模型，可以通过具有抽象方法 FillModel 的基本控制器来使其保持一致。

```
class BaseController :BaseController 
{
   public PopulateViewModelBase(ViewModelBase model) 
{
   //fill up common data. 
}
abstract ViewModelBase FillModel();
} 
```

在控制器中

```
class MyController :Controller 
{

 public ActionResult Index() 
{
   return View(FillModel()); 
}

ViewModelBase FillModel() 
{ 
    ViewModelBase  model=;
    string currentAction = HttpContext.Current.Request.RequestContext.RouteData.Values["action"].ToString(); 
 try 
{ 
   switch(currentAction) 
{  
   case "Index": 
   model= GetCustomerData(); 
   break;
   // fill model logic for other actions 
}
}
catch(Exception ex) 
{
   model.HasError=true;
   model.ErrorMessage=ex.Message;
}
//fill common properties 
base.PopulateViewModelBase(model);
return model;
}
} 
```

# database - 将 J2ME 连接到数据库

> ID：664206
> 
> 赞同：0
> 
> 时间：2009-03-19T21:49:50.447
> 
> 标签：database, java-me

我需要一些与[J2ME](http://en.wikipedia.org/wiki/Java_Platform,_Micro_Edition)相关的帮助。

我对 J2ME 了解不多，现在我需要做一个移动应用程序（它是一个课程项目）。

我的应用程序必须连接到数据库，所以我不知道我该怎么做这个项目！

有同学说我应该做一个web server，连接到数据库，手机应用程序会和web server通信，从数据库中获取信息。

“我真的很想知道如何通过数据库连接应用程序（在手机中）”？

我可以遵循哪些步骤来设计应用程序？比如先做数据库再做应用？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-20T07:00:03.463

J2ME 平台不支持数据库。但是，如果您想在手机中存储数据，即使容量较小，也可以使用 Record Store（称为[RMS ）。](http://www.ibm.com/developerworks/library/wi-rms/)

如果您真的想使用数据库，则必须使用基于 HTTP 协议的 Web 服务器，或者您必须编写基于套接字的应用程序，该应用程序在 TCP 上运行。

如果它是一个面向数据库的应用程序，那么您已经根据您计划从应用程序获取的所有数据作为输入来设计数据库。

# visual-studio-2008 - IE8 和 VS2008：如何禁用脚本调试？

> ID：664208
> 
> 赞同：9
> 
> 时间：2009-03-19T21:50:01.630
> 
> 标签：visual-studio-2008, internet-explorer-8

IE8 已经过时了，很明显，只要您在调试模式下启动项目，它就会自动打开脚本 (JavaScript) 调试。有谁知道如何关闭这个？我搜索了 IE8/VS2008 设置，但什么也没看到。

**编辑：**您不能只进入 Internet 选项并禁用调试：http: [//blogs.msdn.com/webdevtools/archive/2008/03/05/jscript-debugging-made-easy-with-ie8.aspx](http://blogs.msdn.com/webdevtools/archive/2008/03/05/jscript-debugging-made-easy-with-ie8.aspx)这是因此您可以在常规 Web 浏览时关闭调试，但在调试时自动开启。我希望脚本调试永远关闭。

***真正的答案：***即使有人已经赢得了赏金，但他们并没有真正回答这个问题。我直接找到了源代码（Microsoft）并最终在[此处](http://blogs.msdn.com/greggm/archive/2009/04/06/disabling-script-debugging-in-vs-2008-ie8.aspx)获得了包含一些解决方法的博客文章。甜的！

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-03-19T21:53:39.440

这很烦人，但您可以在每个会话中执行此操作：

1.  开始调试你的网站，F5
2.  在顶部菜单中，转到调试；Windows；进程
3.  在我的进程窗口中，有两个进程，一个用于 IExplore:script，另一个用于 WebDev.WebServer.EXE:Managed。右键单击 IExplore:script lineitem 并选择 Detach Process。

**更新**

[Nicholas 提供的链接](http://blogs.msdn.com/greggm/archive/2009/04/06/disabling-script-debugging-in-vs-2008-ie8.aspx)解释说，安装[Silverlight SDK](http://www.microsoft.com/downloads/details.aspx?familyid=C22D6A7B-546F-4407-8EF6-D60C8EE221ED&displaylang=en)然后为您的 Web 项目启用 Silverlight 调试（属性页中“Web”选项卡底部的复选框）将阻止脚本调​​试器附加到 IE 进程。基本上，您不能同时调试两者，Silverlight 选项优先。该链接还提供了一些注册表调整，以部分或完全禁用脚本调试。

发布此答案后，我开始使用 Silverlight 解决方法技术，因此当我看到 OP 找到相同的解决方案时，我回来更新它。由于这个答案被接受并获得了赏金，但并没有真正回答这个问题，我希望这个更新能给答案带来更多的价值。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-20T15:41:34.270

当我按照上面的“每个会话”解决方案中的描述分离 iexplore.exe 进程时，它也会分离 aspnet_wp.exe 进程并将我转储出调试。

选项 | 高级 | 禁用脚本调试”也不起作用。原因如下：http: [//blogs.msdn.com/webdevtools/archive/2008/03/05/jscript-debugging-made-easy-with-ie8.aspx](http://blogs.msdn.com/webdevtools/archive/2008/03/05/jscript-debugging-made-easy-with-ie8.aspx)

显然 VS2008 会为您打开它，无论 IE8 中的高级设置如何。

我发现的唯一解决方法是首先启动 IE8 会话（例如使用解决方案资源管理器中的“在浏览器中查看”），然后选择调试 | 在VS2008中附加到进程并附加到aspnet_wp.exe进程。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2011-02-24T00:40:35.553

这是一个允许您正常调试 asp.net 代码但禁用 javascript 的解决方案。

设置两个注册表值：

[HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Internet Explorer\MAIN] "TabProcGrowth"=dword:00000001

如果您使用 x64 窗口，您还必须设置此 [HKEY_LOCAL_MACHINE\SOFTWARE\Wow6432Node\Microsoft\Internet Explorer\MAIN] "TabProcGrowth"=dword:00000001

解决方案位于：
[http ://social.msdn.microsoft.com/Forums/en/vsdebug/thread/e179672e-5a33-41ec-abc6-08c0b429af61](http://social.msdn.microsoft.com/Forums/en/vsdebug/thread/e179672e-5a33-41ec-abc6-08c0b429af61)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2014-01-03T22:56:02.910

简单的解决方法：

将 Visual Studio 项目中的默认浏览器（通过使用“浏览...”更改默认值）更改为 Google Chrome，例如。比当你点击 F5 时它会打开谷歌浏览器。

手动打开您的 Interent Exploerer 并导航到您要调试的页面。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-19T21:57:36.230

您是否尝试过，在 IE8 中，打开 Internet 选项 > 高级 > 为 Internet Explorer 和其他选择“禁用脚本调试”？

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-27T01:53:15.750

您是否尝试过使用 IIS 进行调试，而不是使用内置的 Web 服务器 (Cassini)？

我主要使用 IIS 进行调试，并没有注意到 IE 8 的这种行为。

可能不是最理想的解决方案，但它确实比每次都必须手动附加/分离到进程中胜出。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-03-29T07:25:05.170

正如 Jimmie R Houts 建议的那样，首先使用 IIS 而不是 Cassini。

最重要的是稍微不同的工作流程怎么样，而不是一直按 F5，您可以使用 Attach/Detach 来控制 VS 将调试的内容。

1.  构建您的解决方案
2.  启动您选择的网络浏览器。
3.  导航到您使用的页面。
4.  在 Visual Studio 中：调试 -> 附加到进程...
5.  根据您的操作系统/IIS 版本选择 aspnet_wp.exe 或 w3wp.exe。
6.  选择要调试的内容（托管代码/Sql）
7.  在页面上做任何你想调试的事情。
8.  当您需要更改代码时，请分离调试器（按停止） - 请注意您选择的浏览器不会关闭。
9.  更改代码、重建解决方案、重新连接调试器并继续使用您选择的浏览器。

我觉得这很方便，因为如果您必须在到达您正在调试的区域之前执行几个步骤 - 使用这种方法您不需要重做所有步骤。当然是一直按 F5 :)

如果要在 Visual Studio 中调试 JS，请附加到 iexplore 进程和调试脚本。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-05-10T19:22:38.827

将项目的“启动操作”设置为“启动外部程序”，然后选择 IE8 可执行文件并作为命令行参数提供项目的 url。

当您使用 F5 启动项目时，javascript 调试将被禁用。

# iphone - 用数组填充操作表

> ID：664217
> 
> 赞同：5
> 
> 时间：2009-03-19T21:53:10.017
> 
> 标签：iphone

我的 iphone 应用程序中有一个操作表弹出窗口。我想用数组中的字符串而不是预定值填充它。

我在网上找不到任何东西可以做到这一点！也许操作表不是正确使用的东西？

现在这是我用来构建它的：

```
roomspopup = [ [ UIActionSheet alloc ]  
                  initWithTitle: alertname  
                  delegate: self 
                  cancelButtonTitle: @"Cancel" 
                  destructiveButtonTitle: nil 
                  otherButtonTitles: @"Kitchen", "Dining Room", nil ]; 
```

但是，我希望它不是“厨房”和“餐厅”，而是从一个数组中填充。数组的大小（即房间数）不是一个固定的数字。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-08-09T22:49:55.547

@吉姆特雷尔

解决这个问题的方法是在没有取消按钮的情况下初始化 UIActionSheet，并在添加其他按钮后添加此取消按钮。

首先用一堆 nil 初始化工作表：

```
UIActionSheet *actionSheet = [[UIActionSheet alloc] initWithTitle:@"Choose" 
                        delegate:self
                        cancelButtonTitle:nil
                        destructiveButtonTitle:nil
                        otherButtonTitles:nil]; 
```

然后遍历你的数组，`addButtonWithTitle:`最后添加取消按钮并设置它的索引：

```
[actionSheet addButtonWithTitle:@"Cancel"];
[actionSheet setCancelButtonIndex:[yourArray count]]; 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-03-19T22:05:07.307

你不能在一行中做到这一点。您必须`initWithTitle`使用一组空按钮进行调用，然后使用循环添加其他按钮[`addButtonWithTitle:`](http://developer.apple.com/iphone/library/documentation/UIKit/Reference/UIActionSheet_Class/Reference/Reference.html#//apple_ref/occ/instm/UIActionSheet/addButtonWithTitle:)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-10-29T09:13:43.817

我可以使用以下代码在底部设置取消按钮：

```
anActionSheet = [[UIActionSheet alloc] initWithTitle:@"Change A/C" delegate:self
  cancelButtonTitle:nil destructiveButtonTitle:nil otherButtonTitles:nil, nil];

for (int i = 0; i < [arraylist count]; i++)    
  [anActionSheet addButtonWithTitle:[arraylist objectAtIndex:i]];

anActionSheet.cancelButtonIndex = [arraylist count];    
[anActionSheet addButtonWithTitle:@"Cancel"]; 
```

# python - Python中的未初始化值？

> ID：664219
> 
> 赞同：3
> 
> 时间：2009-03-19T21:53:47.753
> 
> 标签：python

Python中未初始化的值是什么，所以我可以比较是否初始化了某些东西，例如：

```
val

if val == undefined ? 
```

编辑：添加了一个伪关键字。

EDIT2：我想我没有说清楚，但说 val 已经在那里，但没有分配任何东西。

### 重复：[只是在 Python 中声明一个变量？](https://stackoverflow.com/questions/664294/just-declaring-a-variable-in-python)

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-03-19T21:54:54.007

会抛出`NameError`异常：

```
>>> val
Traceback (most recent call last):
  File "<stdin>", line 1, in <module>
NameError: name 'val' is not defined 
```

您可以抓住它或使用`'val' in dir()`，即：

```
try:
    val
except NameError:
    print("val not set") 
```

或者

```
if 'val' in dir():
    print('val set')
else:
    print('val not set') 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-03-19T21:57:05.717

在 python 中，变量要么引用一个对象，要么不存在。如果它们不存在，您将收到 NameError。当然，他们可能引用的对象之一是`None`.

```
try:
   val
except NameError:
   print "val is not set"

if val is None:
   print "val is None" 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-03-19T22:06:40.233

名称不存在，除非为其分配了值。有None，一般代表没有可用的价值，但它本身就是一个价值。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-03-19T23:54:06.607

这个问题导致了一些关于 python 对象的性质和它的垃圾收集器的有趣转移：

理解python中的所有变量实际上都是指针可能会有所帮助，也就是说它们是命名空间中的名称（实现为哈希表），指向对象实际所在的内存地址。

询问未初始化变量的值与询问尚未创建指针时指针指向的事物的值相同......这显然是无稽之谈，这就是为什么 Python 可以做的最明智的事情就是 throw一个有意义的 NameError。

python 语言的另一个奇怪之处在于，一个对象可能在你执行赋值语句之前很久就存在了。考虑：

```
a = 1 
```

您是否在这里神奇地创建了一个 int(1) 对象？不——它已经存在了。由于 int(1) 是一个不可变的单例，因此已经有几百个指向它的指针：

```
>>> sys.getrefcount(a)
592
>>> 
```

好玩，嗯？

**编辑：** JFS 的评论（张贴在这里显示代码）

```
>>> a = 1 + 1
>>> sys.getrefcount(a) # integers less than 256 (or so) are cached
145
>>> b = 1000 + 1000
>>> sys.getrefcount(b) 
2
>>> sys.getrefcount(2000)
3
>>> sys.getrefcount(1000+1000)
2 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-19T22:06:50.217

在 Python 中，要存在一个变量，必须为它分配一些东西。你可以把你的变量名想象成一个字典键，它必须有一些与之关联的值（即使那个值是无）。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-03-19T23:19:25.987

**问：如何发现变量是否在我的代码中的某个点定义？**

**答：在源文件中阅读，直到看到定义该变量的行。**

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-03-20T08:19:26.877

通常一个值`None`用于将某些东西标记为“已声明但尚未初始化；我会认为未初始化的变量是代码中的缺陷

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-03-19T21:56:54.127

```
try:
    print val
except NameError:
    print "val wasn't set." 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-03-19T21:59:16.010

要添加到[phihag 的答案](https://stackoverflow.com/questions/664219/uninitialized-value-of-python/664222#664222)：您可以使用[`dir()`](http://docs.python.org/library/functions.html#dir)获取当前范围内所有变量的列表，因此如果您想测试是否`var`在当前范围内而不使用异常，您可以执行以下操作：

```
if 'var' in dir():
    # var is in scope 
```

# php - Simple XML 如何使用 [] 运算符？

> ID：664221
> 
> 赞同：1
> 
> 时间：2009-03-19T21:54:43.680
> 
> 标签：php, arrays, operators, simplexml

在 PHP 中，您可以在元素上使用方括号来访问属性：

```
$node = /* SimpleXMLElement */
$id = $node['id']; 
```

奇怪的是，这`$id`不是一个字符串，而是另一个`SimpleXMLElement`. 为什么不是字符串？我发现自己`strval()`到处都在使用它。

方括号是如何工作的？我可以用自己的课程做到这一点吗？我在文档中没有看到任何关于此的内容。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-19T21:59:35.180

[您可以通过实现ArrayAccess 接口](http://us3.php.net/ArrayAccess)（它是 PHP 标准库的一部分）来提供对对象的类似 Array 的访问。这个接口是“即使你没有安装完整的 PHP 标准库扩展，你仍然可以在 PHP 5 中使用这个接口”的东西之一。

通过实现这个接口，并为你的类定义四个方法

```
public boolean offsetExists  ( string $offset  )
public mixed offsetGet ( string $offset )
public void offsetSet ( string $offset , string $value )
public void offsetUnset ( string $offset ) 
```

您应该能够在实例化对象中使用方括号。

至于 SimpleXML 本身，我不确定它是否真的实现了 ArrayAccess 接口，或者是否在 PHP 源代码的幕后发生了其他事情，赋予了它这些超能力。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-21T02:06:54.393

我相信您可以扩展 SimpleXML 类，并在其中实现 ArrayAccess。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-05T13:43:50.453

至于 SimpleXML 本身，它是一个内部类。它为 PHP 用户空间实现的唯一接口是[`Traversable`](http://php.net/Traversable).

在内部使用方括号访问时，SimpleXML 根据索引/键的值和类型查找内容。

如果类型是整数（长整数），则尝试查找零索引、编号的元素并提供其值。如果您有一个具体的节点元素，例如`$root`根元素，`$root[0]`将表示该元素的值：

```
$root = new SimpleXMLElement('<root a="vala"></root>');
$root[0] = 'hello'; 
# <root a="vala">hello</root>
#                ^^^^^- changed value 
```

根元素有点无趣，因为只存在一个。有父元素的元素更有趣。

```
$root = new SimpleXMLElement('<root a="vala"><child /></root>');
$root->child[0] = 'hello'; 
# <root a="vala"><child>hello</child></root>
#                       ^^^^^- changed value 
```

设置第一个`child`元素的节点值。一个 index up-one 将添加一个新的孩子：

```
$root = new SimpleXMLElement('<root a="vala"><child /></root>');
$root->child[1] = 'hello'; 
# <root a="vala"><child/><child>hello</child></root>
#                        ^--  added child --^ 
```

这几乎与数组一样工作。整数字符串，就像整数一样工作：

```
$root->child['1'] = 'hello'; 
# <root a="vala"><child/><child>hello</child></root>
#                        ^--  added child --^ 
```

并将括号留空，将在末尾添加一个新元素：

```
$root->child[] = 'hello';
$root->child[] = 'world';
# <root a="vala"><child/><child>hello</child><child>world</child></root> 
```

到目前为止，对于整数和“无”偏移。与标准 PHP 数组一样，这不能与传递`NULL`. 它将被转换为空字符串`""`。

对于任何字符串，SimpleXML 将查找属性节点而不是子元素节点：

```
$root = new SimpleXMLElement('<root a="vala"></root>');
echo $root['a'], "\n"; # vala 
```

这也适用于添加属性：

```
$root = new SimpleXMLElement('<root a="vala"></root>');
$root['b'] = 'hello'; # <root a="vala" b="hello"/> 
```

一个极端情况是使用一个空字符串 ( `""`) 或者`NULL`因为 simplexml 然后错误地指出没有名称的属性是无效的。有意义，因为属性必须有一个名称：

> 警告：main()：无法在...中写入或创建未命名属性

另一个更特殊的情况是[`__toString`魔术方法](http://php.net/language.oop5.magic#object.tostring)的支持。如果您将对象作为偏移量传递，SimpleXML 将尝试通过魔术方法将其转换为字符串。然后它将使用返回的字符串，如上所述。

* * *

*总结：*该类`SimpleXMLElement`没有实现[`ArrayAccess`](http://php.net/ArrayAccess)接口，但由于它是一个内部类，它可以添加类似数组的行为。而 SimpleXML 正是这样做的。

PHP 源代码中的实用程序函数称为[`sxe_prop_dim_read`](http://lxr.php.net/s?refs=sxe_prop_dim_read&project=PHP_5_4).

* * *

但是当你想对你的类做类似的事情时呢？

这就是`ArrayAccess`接口的用途。在您自己的类中实现它。PHP 已经在内部为您完成了一些工作，以使偏移量更像数组：整数保持整数；像整数这样的字符串被转换为整数，布尔值被转换为整数。

然而`ArrayAccess`，允许的不仅仅是标准数组：有效的偏移量是浮点数、NULL、数组和对象。

特别是使用`NULL`，您无法区分设置偏移量`NULL`或设置新元素 - 两种情况都将提供`NULL`偏移量。

另一个问题提供了接口的示例实现：[PHP、SPL、ArrayAccess 接口](https://stackoverflow.com/q/11333531/367456)。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-19T21:59:36.443

我想这是魔术方法[__get()](http://de.php.net/manual/en/language.oop5.overloading.php#language.oop5.overloading.members)

编辑：我想我猜错了。还不知道数组访问接口。

# c# - 需要用另一个构造它的类覆盖 namspace 中的方法

> ID：664229
> 
> 赞同：0
> 
> 时间：2009-03-19T21:56:59.510
> 
> 标签：c#, .net, oop, inheritance, community-server

我正在尝试覆盖社区服务器 SDK 中名为“InlineTagsContainerTagEditor”的控件上的方法。

当我找到此控件的源时，它位于另一个名为“TaggableContentTagEditableList”的类的文件中。

以下是我认为相关部分的内容：

```
namespace CommunityServer.Controls
{
    public class TaggableContentTagEditableList : WrappedContentBase, ICallbackEventHandler
    {
       protected virtual InlineTagsContainerTagEditor GetInlineTagEditor(ITagsContainer container)
        {
            return new InlineTagsContainerTagEditor(container);
        }

    }
    public class InlineTagsContainerTagEditor : TWC.InlineEditor
    {
        ITagsContainer _container;

        public InlineTagsContainerTagEditor(ITagsContainer container)
            : base()
        {
            _container = container;
        }

    }
} 
```

我只是想创建一个删除某些“标签”的 TaggableContentEditableList 版本。我试图在下面覆盖的方法 - 但我很迷茫。我是否必须重写 TaggableContentTagEditableList 的构造函数才能让构造函数使用我的重写方法查找正确的类型？

```
public partial class TaggableContentEditableListExclude : TaggableContentTagEditableList
{
    protected override InlineTagsContainerTagEditor GetInlineTagEditor(ITagsContainer container)
    {
        return new TagExcludeOption(container);
    }
}

public partial class TagExcludeOption : InlineTagsContainerTagEditor
{
    ITagsContainer _container;

    public TagExcludeOption(ITagsContainer container) : base(container)
     {
        _container = container;
    }

    public override string FormatTags(string[] tagList)
    {
        // strip special tags
        string[] newTagList = stripTags(tagList);
        return base.FormatTags(newTagList);
    }

    private string[] stripTags(string[] tagList)
    {
        //doing something here
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-19T22:49:21.707

您的问题似乎出在您的覆盖 FormatTags

您正在使用剥离的标签创建一个新字符串，但随后将旧字符串发送到基础。

旧字符串尚未更改，因此您的覆盖没有做任何事情。

尝试

```
public override string FormatTags(string[] tagList)
{
    // strip special tags
    string[] newTagList = stripTags(tagList);
    return base.FormatTags(newTagList);
} 
```

# visual-studio-2005 - 是否有与 Visual Studio C++ Makefile 项目等效的 Visual Studio C#

> ID：664242
> 
> 赞同：4
> 
> 时间：2009-03-19T22:02:45.610
> 
> 标签：visual-studio-2005

在 Visual Studio 中的 Visual C++ 中，项目子类型之一是“ *Makefile 项目*”。

但是在 Visual Studio 中似乎没有 Visual C# 的等价物？

* * *

顺便说一句，Makefile 项目是：

> 如果您有一个使用 makefile 从命令行构建的项目，则 Visual Studio 开发环境将无法识别您的项目。要使用 Visual Studio 打开和构建项目，首先使用 Makefile 项目向导创建一个包含适当构建设置的空项目。然后，您可以使用此项目从 Visual Studio 开发环境构建您的项目。
> 
> 该项目在解决方案资源管理器中不显示任何文件。项目指定构建设置，这些设置反映在项目的属性页中。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-03-19T22:05:43.090

`make`在 Visual Studio 世界中相当于`msbuild`. Visual Studio 不使用`make`. `.csproj`等`.vbproj`是 . 的输入文件`msbuild`。您可以在其中执行与传统 makefile 中几乎相同的操作，包括命令行构建、自定义目标等。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-12T20:16:48.373

Makefile 项目类型没有任何特定于 C++ 的内容。它只是运行一个命令行。只是它与 Visual C++ 项目类型一起列出。您可以将一个添加到仅包含 C# 项目的解决方案中。

或者，您可以在您的 C# 项目中设置一个预构建步骤，直接运行 nmake、msbuild 甚至 NAnt。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-08-03T16:28:09.167

当您点击 Play 按钮时，Msbuild 用于构建您的项目。就我个人而言，我喜欢[NAnt](http://nant.sourceforge.net/) + [NantContrib](http://nantcontrib.sourceforge.net/)，它让我更容易上手并立即开始使用。[对于我使用树外科医生](http://www.codeplex.com/treesurgeon)的所有新项目，此工具会创建一个默认构建脚本和正确的构建树，其中包含测试项目和代码覆盖率报告。

# bluetooth - S60 的 Python：在独立线程中侦听套接字

> ID：664244
> 
> 赞同：1
> 
> 时间：2009-03-19T22:03:09.213
> 
> 标签：bluetooth, symbian, pys60

我正在为基于 S60 的诺基亚设备用 Python 开发蓝牙游戏。S60 中的蓝牙插座被证明是相当棘手的。有两个原因：

1.  我不能在 Python 中对多个从属套接字进行主控，听说不能在 Python 中完成，所以我已经离开了这个，反正也不做。

2.  另一部分是我不能只在一个单独的线程中监听一个套接字，然后就可以正常执行我的应用程序。我在这里尝试了一个示例代码：

[http://pastebin.com/f76189841](http://pastebin.com/f76189841)

请注意，我在线程之间共享套接字时使用了 ao_callgate()。

* * *

帖子（仍然没有回答：-（）可以在这里找到： [http ://discussion.forum.nokia.com/forum/showthread.php?t=162260](http://discussion.forum.nokia.com/forum/showthread.php?t=162260)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-21T11:47:58.660

我了解了一些关于 Active 对象的知识。读写请求被发送到蓝牙服务器。但是一次只能请求一个请求。

我创建了一个新线程（比如 t1）并使用 ao_e32.callgate() 在主线程的上下文中调用它。在那里我等待传入的消息。当我想通过蓝牙发送消息时，我应该停止该线程，发送消息并再次启动该线程。但现在的问题是如何停止 Python 中的线程。

PS thread 模块在 Python for S60 中可用，并且可以使用 PC 版 Python 中的 threading.py 在其上安装 threding

# bindable-linq - BindableAttribute、Combobox、Selectedvalue 属性 - WinForms

> ID：664248
> 
> 赞同：0
> 
> 时间：2009-03-19T22:04:41.487
> 
> 标签：bindable-linq

我来自组合框（WinForms），并为 Selectedvalue 属性提供了一个新的实现。

它可以正常工作，但是对 selectedvalue 属性的任何更改都不会更新绑定到相同“绑定上下文”的其他控件以相应地更改它们的值。

我确实尝试将 BindableAttribute(true) 添加到属性中，但它仍然不会触发其他链接控件的值更改。

控件的 DataBindings.add(...) 全部设置完毕。并且其他控件也绑定到相同数据源上的相同数据字段。

任何想法我做错了什么。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2010-03-09T00:00:22.407

您是否调用了基类的重写方法实现？未能调用基类实现可能会意外绕过触发各种事件管道的代码。

# java - JFrame 标题重绘

> ID：664255
> 
> 赞同：0
> 
> 时间：2009-03-19T22:06:38.580
> 
> 标签：java, swing, jframe

在我的 JFrame 中，它循环执行一些任务，我想查看 JFrame 标题中的状态，所以我有这样的东西：

frame.setTitle("当前状态["+Auto_Count_Id+"/"+Auto_Count_Total+" ]");

但它并没有像我需要的那样重新粉刷。所以我尝试了以下方法：

```
<1>

    SwingUtilities.invokeLater(new Runnable() 
    {
      public void run()
      {
        frame.setTitle("Current status [ "+Auto_Count_Id+"/"+Auto_Count_Total+" ]");
      }
    }); 
```

和

```
 <2>
    // repaint(long time, int x, int y, int width, int height) 
    frame.repaint(10,0,0,500,300) 
```

他们也不工作，它只是在任务完成后重新绘制，我该怎么办？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-19T22:12:06.070

不要在 Swing 的事件线程中做繁重的工作。为您的计算创建一个新线程，以便 Swing 可以使用它的线程重新绘制 GUI。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-20T17:15:26.043

是的，SwingWorker 是要走的路。

如果您使用的是 Java 6，它会附带一个包含 publish() 和 process() 方法的 SwingWorker 版本。这些方法让您可以在执行长时间运行的任务时发布数据，然后您可以在 Event Dispatch Thread 中发布该数据。

您可以做的是创建一个 SwingWorker 子类，其中定义了长时间运行的任务。然后，在那个长时间运行的任务中，使用 publish() 方法发布 JFrame 标题字符串。覆盖 process 方法以设置 JFrame 的标题。

[这是 Java 6 的 SwingWorker API 文档](http://java.sun.com/javase/6/docs/api/javax/swing/SwingWorker.html)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-19T22:30:33.733

看一下[SwingWorker](https://swingworker.dev.java.net/)类。

# jquery - 奇怪的 jQuery 行为 - slide()

> ID：664260
> 
> 赞同：1
> 
> 时间：2009-03-19T22:07:49.420
> 
> 标签：jquery, css

如果您转到此页面并点击左侧下拉菜单之一 - [http://ryancoughlin.com/hp/index.php?c=about](http://ryancoughlin.com/hp/index.php?c=about) - 一旦它到达底部或骑行，它几乎看起来就像是故障/颠簸备份顶部。

有可能解决这个问题吗？或者这是它在 jQuery 中的行为方式？

代码：

```
$(".menu-header").click(function() {
    $(this).next().toggle('slow');
    return false;
}).next().hide(); 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-03-19T22:23:05.827

在你的 CSS 中，改变

```
#left ul li{
    font-size:.7em;
    margin:5px 0;
} 
```

到

```
#left ul li{
    font-size:.7em;
    padding:2px 0 3px 0;
} 
```

问题是您的边距与动画开始和结束时的边距一起折叠，但不是`h2`在动画期间，因为`overflow`不是*，防止折叠。没有折叠会增加.`ul``visible``ul`

*[盒子模型上的 W3 和边距折叠](http://www.w3.org/TR/CSS21/box.html#collapsing-margins)：

> 具有“溢出”而不是“可见”的元素的垂直边距不会与其流入的子元素一起折叠。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-19T22:12:44.680

这与保证金有关。尝试同时为 {"margin": toggle} 设置动画，这应该可以消除颠簸：

```
$(".menu-header").click(function() {
  $(this).next().animate({"margin": "toggle", "height": "toggle"});
  return false;
}); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-19T22:14:07.737

看起来它可能与您在`h2`标题链接上设置的边距和填充有关。如果您使用萤火虫检查页面，并在标题上设置`padding`and`margin`为 0，则“凹凸”消失。`ul`此外，显示或隐藏的时间旁边似乎计算了许多样式。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-19T22:45:36.117

几天前我用类似的代码遇到了同样的问题。

根据我的阅读，问题是您需要在所有浏览器中触发“hasLayout”。当然，这不是真实`hasLayout`的事情，但您需要执行以下操作之一：

*   Float elements. Both titles and lists and add clear:left for both. this should do the trick;
*   Set width/height for `UL` elements (hidden stuff);
*   add `position:relative` for `UL` elements

Usually, those should do the trick ;)

# visual-studio - 类似于 String.Format 粘贴的 Visual Studio 宏

> ID：664263
> 
> 赞同：2
> 
> 时间：2009-03-19T22:08:30.073
> 
> 标签：visual-studio, macros

例如，我希望能够剪切/复制像“<strong>{0}</strong>”这样的字符串。

然后我想选择一些代码，例如“Hello, World”，然后调用一个宏，这将导致“<strong>Hello, World</strong>”。

你怎么能这样？

**更新：**我为什么要这样做？

我可以制作一个宏或快捷方式来添加特定的东西，如 <strong> 标记到选择中。但是，我的想法是动态创建任何类型的“环绕”粘贴行为。

我经常粘贴字段或属性列表。所以我从其他地方得到

```
PersonID
FirstName
LastName 
```

举个例子，我知道我想将它们设置为

```
FieldName = dataRow("FieldName").Value 
```

使用我的魔术宏，我可以选择以下内容并按 CTRL+C 将其放入我的剪贴板：

```
{0} = dataRow("{0}").Value 
```

然后我所要做的就是一行一行地涂抹我的魔法膏。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-20T15:25:13.047

有趣的小项目。

```
Option Strict Off
Option Explicit Off
Imports System
Imports EnvDTE
Imports EnvDTE80
Imports EnvDTE90
Imports System.Diagnostics

Public Module StringFormatModule

    Private clipText As String

    Public Property ClipboardText() As String
        Get
            RunThread(AddressOf GetClipboardText)
            Return clipText
        End Get
        Set(ByVal value As String)
            clipText = value
            RunThread(AddressOf CopyToClipboard)
        End Set
    End Property

    Private Function RunThread(ByVal fct As Threading.ThreadStart)
        Dim thread As New Threading.Thread(fct)
        thread.ApartmentState = Threading.ApartmentState.STA

        thread.Start()
        thread.Join()
    End Function

    Private Sub GetClipboardText()
        clipText = My.Computer.Clipboard.GetText()
    End Sub

    Private Sub CopyToClipboard()
        My.Computer.Clipboard.SetText(clipText)
    End Sub

    Sub FormatSelectedTextWithCopiedText()
        Dim formatString As String

        formatString = ClipboardText

        Dim token As String
        Dim selectedText As TextSelection
        selectedText = DTE.ActiveDocument.Selection
        token = selectedText.Text
        selectedText.Text = String.Format(formatString, token)
    End Sub
End Module 
```

[我从这里](http://svenmaes.blogspot.com/2007/03/access-clipboard-from-visual-studio.html)借了剪贴板代码。

这确实有效。我在一个文本文件上对其进行了测试，将您的格式字符串复制到剪贴板（ctrl-c），突出显示要格式化的文本，然后运行宏（我只是从宏资源管理器中双击它，但您可以制作键盘快捷键） .

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-19T22:27:16.767

定义一个在所选文本周围添加“强”标签的宏不是更好吗？然后你可以将它分配给 Ctrl+B 或其他。

必须选择两个文本块并两次调用宏对我来说似乎太辛苦了。

（也许您需要解释**为什么**要这样做）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-09-03T17:44:07.130

我使用 & 而不是 {0}。将宏分配给 Ctrl+Q，一切就绪！

```
' Wraps the current selection with the specified text. Use the & character as the anchor for the selected text.
Public Sub WrapSelection()
    Dim selection As TextSelection = DirectCast(DTE.ActiveDocument.Selection, TextSelection)
    DTE.UndoContext.Open("Wrap Selection")

    Try
        Dim sInput As String = InputBox("Wrap(&&, state)")
        If Len(sInput) > 0 Then
            Dim sContent As String = selection.Text
            Dim iStart As Integer = InStr(sInput, "&") - 1
            Dim iEnd As Integer = InStrRev(sInput, "&")
            selection.Insert(sInput.Substring(0, iStart) + sContent + sInput.Substring(iEnd), vsInsertFlags.vsInsertFlagsContainNewText)
            'selection.Insert(sInput.Substring(iEnd), vsInsertFlags.vsInsertFlagsInsertAtEnd)
        End If

    Catch ex As Exception
        DTE.UndoContext.SetAborted()
        MsgBox(ex.Message)

    Finally
        'If an error occured, then need to make sure that the undo context is cleaned up.
        'Otherwise, the editor can be left in a perpetual undo context
        DTE.UndoContext.Close()

    End Try

End Sub 
```

# c# - 在 C# 中序列化数组列表

> ID：664267
> 
> 赞同：3
> 
> 时间：2009-03-19T22:09:57.310
> 
> 标签：c#

我有一个包含许多标准字段和一个数组列表的类。

有没有办法使用 XmlSerializer 序列化类？

到目前为止的尝试会导致一条错误消息：

```
未处理的异常：System.InvalidOperationException：出现错误
生成 XML 文档。---> System.InvalidOperationException：类型
XMLSerialization.DataPoints 不是预期的。使用 XmlInclude 或
SoapInclude 属性指定静态未知的类型。
```

类的一些缩减表示如下所示：

```
public class StationData
{
  private DateTime _CollectionDate;
  private string _StationID;
  private ArrayList _PolledData;

  public StationData()
  {
  }
  public DateTime CollectionDate
  {
    get { return _CollectionDate; }
    set { _CollectionDate = value; }
  }
  public string StationID
  {
    get { return _StationID; }
    set { _StationID = value; }
  }
  [XmlInclude(typeof(DataPoints))]
  public ArrayList PolledData
  {
    get { return _PolledData; }
    set { _PolledData = value; }
  }
}

public class DataPoints
{
  private string _SubStationID;
  private int _PointValue;

  public DataPoints
  {
  }
  public string SubStationID
  {
    get { return _SubStationID; }
    set { _SubStationID = value; }
  }
  public int PointValue
  {
    get { return _PointValue; }
    set { _PointValue = value; }
  }
} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-20T00:00:25.843

我在以下方面取得了成功：

```
[XmlArray("HasTypeSpecialisations")]
[XmlArrayItem("TypeObject", typeof(TypeObject), IsNullable = false)]
public List<TypeObject> TypeSpecialisations 
```

这导致：

```
<HasTypeSpecialisations>
    <TypeObject />
    <TypeObject />
</HasTypeSpecialisations> 
```

在您的情况下，我会尝试以下方法：

```
[XmlArrayItem(typeof(DataPoints))]
public ArrayList PolledData 
```

基于这个链接[http://msdn.microsoft.com/en-us/library/2baksw0z(VS.85).aspx](http://msdn.microsoft.com/en-us/library/2baksw0z(VS.85).aspx)你也应该能够使用这个

```
[XmlElement(Type = typeof(DataPoints))]
public ArrayList PolledData 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-19T22:19:44.807

XmlSerializer 在运行时生成一些代码来序列化您的类。这个类有必要知道所有可能发生的类型。

ArrayList 不提供此信息，但您可以通过在返回 ArrayList 的属性上使用[XmlInclude属性来提供此信息。](http://msdn.microsoft.com/en-us/library/system.xml.serialization.xmlincludeattribute.aspx)

```
[XmlInclude(typeof(DataPoints))]
public ArrayList Points {
   ...
} 
```

您还可以使用通用 List<> 类。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-19T22:22:56.060

我认为您可以通过使用泛型列表 (List<>) 而不是 ArrayList 来解决此问题，但是，我假设您出于某种原因不能使用泛型。

您需要告诉编译器 ArrayList 中包含什么类型，以便它可以序列化它，因为它知道它包含对象。

将此添加到您的属性上方，它应该清除它。[System.Xml.Serialization.XmlInclude(typeof(XMLSerialization.DataPoints))]

当然，用 ArrayList 中包含的任何类替换 XMLSerialization.DataPoints。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-19T22:21:07.533

看看[这篇文章](http://www.codeproject.com/KB/XML/xmlserializerforunknown.aspx)，它描述了你遇到的基本问题和解决方案（比如使用 XmlInclude 属性）。基本上说的是序列化程序遇到了一种它不知道如何序列化的类型。如果您发布一些代码，它也会有很大帮助。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-19T23:32:31.120

我一直用来序列化列表的方法是将它们转换为数组（它具有必要的类型信息）。我承认这有点脏，但是如果您无法获得正确的序列化列表，这将起作用。

# silverlight - Silverlight 上的 Google App Engine

> ID：664270
> 
> 赞同：7
> 
> 时间：2009-03-19T22:12:42.653
> 
> 标签：silverlight, google-app-engine

有没有关于如何使用 Silverlight 的 Google App Engine 的好例子，最好不编写自定义网络服务？

干杯

尼克

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-07-13T14:39:16.697

这是我的方法主要基于[Scott Seely 的帖子](http://www.informit.com/articles/article.aspx?p=1354698) 简单地传递 XML，.xap 也由 GAE 提供。我昨天才开始工作，所以它仍在进行中。

**谷歌：**

应用程序.yaml

```
 application: wowbosscards
version: 1
runtime: python
api_version: 1

handlers:
- url: /WowBossCards.html
  static_files: WowBossCards.html
  upload: WowBossCards.html
  mime_type: text/html
- url: /clientaccesspolicy.xml
  static_files: clientaccesspolicy.xml
  upload: clientaccesspolicy.xml
  mime_type: text/xml
- url: /WowBossCards.xap
  static_files: WowBossCards.xap
  upload: WowBossCards.xap
  mime_type: application/x-silverlight-app
- url: .*
  script: wowbosscards.py 
```

wowbosscards.py

```
#!/usr/bin/env python

import cgi
import datetime
import wsgiref.handlers
import os
import logging
import string
import urllib

from google.appengine.ext import db
from google.appengine.api import users
from google.appengine.ext import webapp
from google.appengine.ext.webapp import template

class Xml(db.Model):
  xmlContent = db.TextProperty()
  date = db.DateTimeProperty(auto_now_add=True)

class XmlCrud(webapp.RequestHandler):
  def get(self, xmlType):

    xmlKey = string.capitalize(xmlType)
    xml = Xml.get_by_key_name(xmlKey)
    self.response.headers['Content-Type'] = "application/xml"

    self.response.out.write(xml.xmlContent)

  def post(self, xmlType):

    logging.debug("XmlCrud POST")
    xmlKey = string.capitalize(xmlType)
    xml = Xml.get_by_key_name(xmlKey)
    if len(self.request.get('content')) > 0 :
        xml.xmlContent = self.request.get('content')
    else:
        xml.xmlContent = self.request.body
    xml.put()

    self.redirect('/upload/' + xmlType)

def main():
  Xml.get_or_insert("Bosses", xmlContent="<a>Bosses go here</a>")
  Xml.get_or_insert("Dungeons", xmlContent="<a>Dungeons go here</a>")
  application = webapp.WSGIApplication([
                                          (r'/xml/(.*)', XmlCrud),
                                        ], debug=True)
  wsgiref.handlers.CGIHandler().run(application)

if __name__ == '__main__':
  main() 
```

**银光：**

```
private class RequestExtended
{
    public VoidCall CallBack;
    public WebRequest Request;
    public Uri Host;

    public RequestExtended(WebRequest request, VoidCall callBack, Uri host)
    {
        Request = request;
        CallBack = callBack;
        Host = host;
    }
}

public static void ImportFromGoogle(Uri host, VoidCall callBack)
{
    try
    {
        if (host.Host == "localhost")
        {
            host = new Uri(host.Scheme + @"://" + host.Host + ":8080");
        }
        var bossesCrud = new Uri(host, "/xml/bosses");
        var bossesRequest = WebRequest.Create(bossesCrud);
        bossesRequest.BeginGetResponse(BossesResponse, new RequestExtended(bossesRequest, callBack, host));
    }
    catch (Exception ex)
    {

    }
}

public static void BossesResponse(IAsyncResult result)
{
    var requestExtended = result.AsyncState as RequestExtended;
    try
    {
        WebResponse response = requestExtended.Request.EndGetResponse(result);
        Stream responseStream = response.GetResponseStream();

        byte[] bytes = new byte[response.ContentLength];
        responseStream.Read(bytes, 0, bytes.Length);
        responseStream.Close();

        var enc = new System.Text.UTF8Encoding();
        string xml = enc.GetString(bytes, 0, bytes.Length);

        bosses = GetCollectionFromXmlString<BossCollection>(xml);

        if (requestExtended.CallBack != null) requestExtended.CallBack();
    }
    catch (WebException we)
    {
        HttpWebResponse response = (HttpWebResponse)we.Response;
        response.Close();
    }
    catch (Exception e)
    {
    }
}

public static void SaveBossesToGoogle(Uri host)
{
    if (host.Host == "localhost")
    {
        host = new Uri(host.Scheme + @"://" + host.Host + ":8080");
    }
    var bossesCrud = new Uri(host, "/xml/bosses");
    var request = WebRequest.Create(bossesCrud);
    request.Method = "POST";
    request.ContentType = "text/xml"; //"application/x-www-form-urlencoded";

    request.BeginGetRequestStream(GetSaveBossesRequestStreamCallback, new RequestExtended(request, null, host));
}

static void GetSaveBossesRequestStreamCallback(IAsyncResult result)
{
    var requestExtended = result.AsyncState as RequestExtended;
    try
    {
        Stream stream = requestExtended.Request.EndGetRequestStream(result);
        var xmlSerializer = new XmlSerializer(typeof(BossCollection));
        var xmlText = new StringBuilder();

        using (TextWriter textWriter = new StringWriter(xmlText))
        {
            xmlSerializer.Serialize(textWriter, Store.Bosses);
            textWriter.Close();
        }

        var enc = new System.Text.UTF8Encoding();
        var bytes = enc.GetBytes(xmlText.ToString());

        stream.Write(bytes, 0, bytes.Length);
        stream.Close();
        requestExtended.Request.BeginGetResponse(SaveResponse, requestExtended);
    }
    catch (WebException we)
    {
        HttpWebResponse response = (HttpWebResponse)we.Response;
        response.Close();
    }
}

static void SaveResponse(IAsyncResult result)
{
    var requestExtended = result.AsyncState as RequestExtended;
    try
    {
        WebResponse response = requestExtended.Request.EndGetResponse(result);
        if (requestExtended.CallBack != null) requestExtended.CallBack();
    }
    catch (WebException we)
    {
        HttpWebResponse response = (HttpWebResponse)we.Response;
        response.Close();
    }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-08-02T19:19:27.747

I couldn't find any examples getting Silverlight to work with google app's Java SDK, so [here is my post](http://yoawsconsult.blogspot.com/2009/07/how-to-host-silverlight-xap-on-google.html).

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-28T04:30:47.110

我也在看这个。GAE 有几个 REST 项目，我还没有尝试过，但希望在下周左右。

[http://code.google.com/p/app3/](http://code.google.com/p/app3/)

[http://code.google.com/p/gae-json-rest/](http://code.google.com/p/gae-json-rest/)

[http://code.google.com/p/appengine-rest-server/](http://code.google.com/p/appengine-rest-server/)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-21T14:24:31.513

我正在考虑做同样的事情，但我还没有遇到任何事情。

我正在考虑使用 JSON.net 进行通信，所以基本上在 GAE 中编写一个 REST 服务供客户端调用，也许 OAuth.NET 进行身份验证（除非我能找到 google 的 .NET 端口，我'还没看）

Silverlight 基本上只是 .NET，它的精简版，所以如果你能找到 .NET 代码来做某事，它应该可以工作，至少在某种程度上，在 SL :)

但这就是我所知道的——考虑一下。抱歉，还不能提供更多帮助！

* * *

## 回答 #5

> 赞同：-3
> 
> 时间：2009-07-08T12:45:23.710

下载[Expression Blend](http://www.google.com/url?sa=t&source=web&ct=res&cd=1&url=http%3A%2F%2Fwww.microsoft.com%2Fexpression%2Fproducts%2FOverview.aspx%3Fkey%3Dblend&ei=u5NUSoa8K42MjAeyrvSLCQ&rct=j&q=expression+blend+&usg=AFQjCNHTFxrKKd_AVer-w76u8D92TQ26_Q&sig2=r9EvhBRZQnfks3N65uAgVw)的演示。查看包含的教程，该教程展示了如何在 GUI 模式下创建华丽的 Silverlight 界面并将其与 Bing 搜索 Web 服务集成。将此示例操作为 Google 示例应该是微不足道的。祝你好运！:)

# c++ - 增强 lambda 困惑

> ID：664273
> 
> 赞同：3
> 
> 时间：2009-03-19T22:14:09.687
> 
> 标签：c++, boost-bind, boost-lambda

为什么回调只调用一次？

```
bool callback()
{
    static bool res = false;
    res = !res;
    return res;
}

int main(int argc, char* argv[])
{
    vector<int> x(10);

    bool result=false;
    for_each(x.begin(),x.end(),var(result)=var(result)||bind(callback));

    return 0;
} 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-03-19T22:20:15.100

第一次后[**短路**](http://en.wikipedia.org/wiki/Short-circuit_evaluation)的`||`表达式返回。[](http://en.wikipedia.org/wiki/Short-circuit_evaluation)**`bind``true`**

 **第一次评价

```
result = result || bind(...)  // result is false at this point 
```

`bind`被调用，因为这是确定 的值的唯一方法`false || bind(...)`。因为`bind(...)`返回`true`，`result`被设置为`true`。

每次你说

```
result = result || bind(...)  // result is true at this point 
```

...不**计算`bind(...)`表达式，因为它返回什么并不重要**；表达式`true || anything`总是`true`,`||`表达式[**短路**](http://en.wikipedia.org/wiki/Short-circuit_evaluation).

确保`bind`始终调用的一种方法是将其移动到 的左侧`||`，或将 更改`||`为`&&`，具体取决于您要完成的任务`result`。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-19T22:41:44.223

在您的特定示例中，Boost.Lambda 并没有真正为您带来任何好处。去掉 lambda 部分，也许你会更清楚地看到发生了什么：

```
for (int i = 0; i < 10; ++i)
  result = result || callback(); 
```

[正如丹尼尔解释](https://stackoverflow.com/questions/664273/boost-lambda-bewilderment/664289#664289)的那样，这仍然取决于您知道`||`操作员是否短路。

# .net - 需要：.NET 中的文件系统接口和实现

> ID：664277
> 
> 赞同：13
> 
> 时间：2009-03-19T22:15:54.907
> 
> 标签：.net, unit-testing, file-io, dependency-injection, mocking

> **可能重复：**
> [如何在 C# 中模拟文件系统以进行单元测试？](https://stackoverflow.com/questions/1087351/how-do-you-mock-out-the-file-system-in-c-sharp-for-unit-testing)

我使用 Moq 作为模拟框架为我的代码编写单元测试。
我的代码包括对文件系统的调用，使用对`System.IO`类的直接调用。例如，`File.Exists(...)`等等。
我想将该代码更改为更具可测试性，所以我应该有一个接口，比如说`IFile`，以及一个相关的方法，比如说`Exists(string path)`。
我知道我可以从头开始编写它，但我认为也许有一个完整、健壮的框架，它同时具有文件系统的接口和实现。这个（期望的）框架也可能是某种“服务”，因此它的 API 不必是`System.IO`命名空间的“接口等价物”。
请注意，我真的很想拥有接口（而**不是**静态方法），这样我的代码就可以进行依赖注入了

## 到目前为止我得到了什么：

*   在stackoverflow中提出了一个类似但[不相同的问题](https://stackoverflow.com/questions/266776/mock-file-methods-in-net-like-file-copy1-txt-2-txt)
*   在[codeplex.com](http://www.codeplex.com/)中有一个名为*CodePlex Source Control Client* ([链接](http://codeplexclient.codeplex.com/)) 的项目，它的源代码中有这样的类（`/Source/TfsLibrary/Utility/`具体细节请参见源代码）

还有其他建议吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-03-20T02:46:12.077

[我已经](http://bugsquash.blogspot.com/2008/03/injectable-file-adapters.html)为静态`System.IO.File`和`Directory`方法编写了适配器。然后在我的课程中，我执行以下操作：

```
public class MyService {
  public IFile File {private get;set;}
  public MyService() {
    File = new FileImpl();
  }
  public void DoSomething() {
    File.ReadAllText("somefile");
  }
} 
```

然后你可以注入一个模拟作为 IFile 进行测试。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-03-20T02:29:17.170

好吧，我没有您想要的文件系统模拟库（尽管它可能在某个地方并且很酷），但这可能会有所帮助。单元测试思想的“行为主义者”学派提出的有趣概念之一是“传出接口”的概念。在某些情况下，将一个对象对自身之外的整个事物进行调用并将它们转换为接口，这似乎与为外部方法创建接口的典型行为一样有价值世界可以调用你**的**对象）。

在这种情况下，您可能会考虑，而不是模拟整个文件系统，而是为您的对象从外部世界需要的答案和服务创建一个或多个逻辑一致的接口。这些电话只会回答您需要回答的问题……而不是要求实施。然后，您可以使用前面提到的依赖注入来注入测试所需的实现。由于您熟悉 Moq，因此您可能会使用 Moq 来执行此操作。

因此，您的“传出接口”可能有一个名为 DoesFileExist() 的方法。它可能会接受一条路径。或者，如果您的对象试图回答“更高级别”的业务问题，并且查看文件是否存在仅仅是回答该问题的**方式**，那么您的传出接口可能根本没有关于文件存在的方法。相反，它可能类似于“DoIAppearToHaveAccessToTheFileServer”，甚至是“IsThereAPreviouslySavedGame”。

这是一些工作，但可能更符合良好单元测试的原则......让您的被测对象表达它想要做什么，并让您的单元测试只测试它。只是一个想法......希望它有所帮助。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-07-06T23:39:21.437

我在 CodePlex 上维护[Jolt.NET](http://jolt.codeplex.com)项目，其中包含一个库，可以为您生成此类接口及其实现。有关更多信息，请参阅[Jolt.Testing](http://jolt.codeplex.com/Wiki/View.aspx?title=Jolt.Testing)库。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2010-11-18T15:32:52.507

[http://systemwrapper.codeplex.com/](http://systemwrapper.codeplex.com/)提供了很好的选择，虽然我还没有尝试过。看起来作者可以在完成项目时使用一些帮助。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-19T22:24:11.673

我知道[Typemock](http://www.typemock.com/)包可以做这样的事情。

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2009-03-19T22:33:45.567

而不是模拟文件系统接口，我传统上选择模拟文件系统本身。在任何严肃的操作系统上，这都是一项相对容易的任务。[您可以使用Mono.Fuse](http://www.jprl.com/Projects/mono-fuse.html)非常轻松地构建用户空间文件系统，它是[FUSE](http://fuse.sourceforge.net/)的 C# 实现，用户空间中的文件系统。我不确定是否需要进行任何移植才能获得[Dokan](http://dokan-dev.net/en/)、FUSE for Windows，但 FUSE 在 Linux、OSX 和 Solaris 上运行良好。

# c# - 如何在 XNA 中调整和保存 Texture2D 的大小？

> ID：664279
> 
> 赞同：5
> 
> 时间：2009-03-19T22:18:26.057
> 
> 标签：c#, .net, xna, image-manipulation

在我为 XNA 游戏制作的关卡编辑器中（编辑器也在 XNA 中），我允许缩放[Texture2D](http://msdn.microsoft.com/en-us/library/microsoft.xna.framework.graphics.texture2d_members.aspx)对象。

当用户尝试保存关卡时，我想实际调整磁盘上的图像文件大小，以便它不需要在游戏中缩放。

有没有一种简单的方法可以从缩放的 Texture2D 对象创建图像文件（首选 PNG）？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-04-01T13:24:32.413

您可以通过以所需大小渲染到渲染目标然后保存渲染目标纹理来缩放纹理。

这个简单的例子展示了如何做到这一点。忽略GraphicsDevice的设置，这只是做一个自包含的小例子。有趣的是创建渲染目标并绘制缩放的纹理。您应该尽可能重用渲染目标（所有相同大小的图像都可以重用渲染目标）。

```
using System;
using System.Runtime.InteropServices;
using Microsoft.Xna.Framework;
using Microsoft.Xna.Framework.Graphics;

class Program
{
    [DllImport("kernel32.dll", SetLastError = true)]
    private static extern IntPtr GetConsoleWindow();

    static void Main(string[] args)
    {
        string sourceImagePath = args[0];
        string destinationImagePath = args[1];
        int desiredWidth = int.Parse(args[2]);
        int desiredHeight = int.Parse(args[3]);

        GraphicsDevice graphicsDevice = new GraphicsDevice(
            GraphicsAdapter.DefaultAdapter,
            DeviceType.Hardware,
            GetConsoleWindow(),
            new PresentationParameters());
        SpriteBatch batch = new SpriteBatch(graphicsDevice);

        Texture2D sourceImage = Texture2D.FromFile(
            graphicsDevice, sourceImagePath);

        RenderTarget2D renderTarget = new RenderTarget2D(
            graphicsDevice, 
            desiredWidth, desiredHeight, 1, 
            SurfaceFormat.Color);

        Rectangle destinationRectangle = new Rectangle(
            0, 0, desiredWidth, desiredHeight);

        graphicsDevice.SetRenderTarget(0, renderTarget);

        batch.Begin();
        batch.Draw(sourceImage, destinationRectangle, Color.White);
        batch.End();

        graphicsDevice.SetRenderTarget(0, null);

        Texture2D scaledImage = renderTarget.GetTexture();
        scaledImage.Save(destinationImagePath, ImageFileFormat.Png);
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-19T22:27:03.040

你试过[Texture2D.Save()](http://msdn.microsoft.com/en-us/library/microsoft.xna.framework.graphics.texture.save.aspx)吗？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-19T22:31:55.277

缩放图像通常不会产生太多开销，另外，您不希望将相同纹理的不同大小加载到内存中，因为这会浪费。

当然，您可能正在编写 Zune 游戏，这意味着我可能对那里的缩放不感兴趣，但是，无论如何。

我不认为您可以直接从 XNA 保存缩放后的图像，但是，您可以使用 WinForms Image 类加载图像，然后将其缩放到关卡编辑器中的尺寸并将其保存回磁盘。

但是，如果您的纹理不是 BMP 或 PNG，则可能必须使用 Texture2D.Save() 命令将其转换为可在 Image 类中使用的格式。

该线程可能会帮助您使用 Image 类。 [http://social.msdn.microsoft.com/Forums/en-US/winforms/thread/6fe3d353-0b09-440b-95c9-701efdc9e20a/](http://social.msdn.microsoft.com/Forums/en-US/winforms/thread/6fe3d353-0b09-440b-95c9-701efdc9e20a/)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-09-27T20:09:47.913

我有这样的代码，可以制作更大/更小的纹理副本，但一段时间后出现错误。在 30 次调整大小之后，我得到了异常，而不是第一次。

似乎是一个渲染目标问题，但我不确定。想知道如果您也经常运行此代码，您是否也会遇到这些异常？

# sql - 可扩展的数据库标记模式

> ID：664283
> 
> 赞同：6
> 
> 时间：2009-03-19T22:18:42.327
> 
> 标签：sql, database, performance, tags, scalability

**编辑**：对于构建标记系统的人。不要读这个。这不是你要找的。当我不知道RDBMS都有自己的优化方法时，我问了这个问题，只需使用简单的多对多方案即可。

我有一个拥有数百万个帖子的发布系统。每个帖子可以有无数个与之关联的标签。

用户可以创建包含注释、创建日期、所有者等的标签。标签几乎就像帖子本身，因为人们可以发布关于标签的注释。

每个标签关联都有一个所有者和日期，因此我们可以看到谁添加了标签以及何时添加。

我的问题是如何实现这一点？它必须通过标签或标签快速搜索帖子。此外，用户可以通过在字段中输入名称来为帖子添加标签，有点像谷歌搜索栏，它必须为您填写标签名称的其余部分。

我目前有 3 个解决方案，但不确定哪个是最好的，或者是否有更好的方法。

请注意，我没有显示笔记的布局，因为一旦我获得了适当的标签解决方案，这将是微不足道的。

方法一、链表

post中的tagId指向tag_assoc中的一个链表，应用程序必须遍历链表直到flink=0

```
post:           id, content, ownerId, date, tagId, notesId
tag_assoc:      id, tagId, ownerId, flink
tag:            id, name, notesId 
```

方法 2\. 非规范化

tags 只是一个 VARCHAR 或 TEXT 字段，其中包含一个制表符分隔的 tagId:ownerId 数组。它不能是固定大小。

```
post:           id, content, ownerId, date, tags, notesId
tag:            id, name, notesId 
```

方法 3\. 毒物

（来自：[http](http://www.pui.ch/phred/archives/2005/04/tags-database-schemas.html) ://www.pui.ch/phred/archives/2005/04/tags-database-schemas.html ，这里也一样：[标签或标记的推荐 SQL 数据库设计](https://stackoverflow.com/questions/20856/how-do-you-recommend-implementing-tags-or-tagging)）

```
post:          id, content, ownerId, date, notesId
tag_assoc:     ownerId, tagId, postId
tag:           id, name, notesId 
```

方法 3 提出了一个问题，遍历 tag_assoc 中的每一行的速度有多快？

方法 1 和 2 对于按帖子返回标签应该很快，但是对于按标签的帖子，必须制作另一个查找表。

我要担心的最后一件事是按名称优化搜索标签，我还没有解决这个问题。

我在这里做了一个ASCII图：http: [//pastebin.com/f1c4e0e53](http://pastebin.com/f1c4e0e53)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-21T01:47:17.607

这是我的做法：

```
posts:          [postId], content, ownerId, date, noteId, noteType='post'
tag_assoc:      [postId, tagName], ownerId, date, noteId, noteType='tagAssoc'
tags:           [tagName], ownerId, date, noteId, noteType='tag'
notes:          [noteId, noteType], ownerId, date, content 
```

方括号中的字段是相应表的主键。

`noteType`在每个表中定义一个约束： `posts`、`tag_assoc`和`tags`。例如，这可以防止给定的注释同时应用于 a`post`和 a `tag`。

将标签名称存储为短字符串，而不是整数`id`。这样您就可以使用表中的覆盖索引 [ `postId`, `tagName`] `tag_assoc`。

使用 AJAX 调用完成标记完成。如果用户为标签键入“datab”，您的网页会进行 AJAX 调用，并且在服务器端，应用程序会查询：`SELECT tagName FROM tags WHERE tagName LIKE ?||'%'`。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-19T22:49:38.367

“标签几乎就像一个帖子本身，因为人们可以发布关于标签的注释。” - 这句话让我觉得你真的只想要一个用于 POST 的表，带有一个主键和一个引用 POST 表的外键。现在，您可以在磁盘空间允许的范围内为每个帖子添加尽可能多的标签。

我假设 POST 和标签之间不需要多对多，因为标签不会在帖子之间共享，基于此：

“用户可以创建包含注释、创建日期、所有者等的标签。”

如果创建日期和所有者是共享的，那将是两个额外的外键关系，IMO。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-21T17:59:00.110

链表几乎可以肯定是错误的方法。这当然意味着您的查询将是复杂的或次优的 - 这具有讽刺意味，因为使用链表的最可能原因是将数据保持在正确的排序顺序中。但是，我没有看到一种简单的方法来避免迭代地获取一行，然后使用检索到的 flink 值来调整下一行的选择操作。

因此，请使用基于表的方法，将普通外键用于主键引用。比尔卡尔文概述的那个看起来与我概述的相似。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-22T01:43:20.027

比尔，我想我有点把你甩了，笔记就在另一张桌子上，还有一张单独的桌子，上面有不同人张贴的笔记。帖子有注释和标签，但标签也有注释，这就是标签是唯一的原因。

Jonathan 对链表的看法是正确的，我根本不会使用它们。我决定以最简单的规范化方式实现标签，以满足我的需求：

```
DROP TABLE IF EXISTS `tags`;
CREATE TABLE IF NOT EXISTS `tags` (
  `id` int(10) unsigned NOT NULL AUTO_INCREMENT,
  `owner` int(10) unsigned NOT NULL,
  `date` int(10) unsigned NOT NULL,
  `name` varchar(255) NOT NULL,
  PRIMARY KEY (`id`),
  UNIQUE KEY `name` (`name`)
) ENGINE=InnoDB  DEFAULT CHARSET=utf8 AUTO_INCREMENT=1 ;

DROP TABLE IF EXISTS `posts`;
CREATE TABLE IF NOT EXISTS `posts` (
  `id` int(10) unsigned NOT NULL AUTO_INCREMENT,
  `owner` int(10) unsigned NOT NULL,
  `date` int(10) unsigned NOT NULL,
  `name` varchar(255) NOT NULL,
  `content` TEXT NOT NULL,
  PRIMARY KEY (`id`)
) ENGINE=InnoDB  DEFAULT CHARSET=utf8 AUTO_INCREMENT=1 ;

DROP TABLE IF EXISTS `posts_notes`;
CREATE TABLE IF NOT EXISTS `posts_notes` (
  `id` int(10) unsigned NOT NULL AUTO_INCREMENT,
  `owner` int(10) unsigned NOT NULL,
  `date` int(10) unsigned NOT NULL,
  `postId` int(10) unsigned NOT NULL,
  `note` TEXT NOT NULL,
  PRIMARY KEY (`id`),
  FOREIGN KEY (`postId`) REFERENCES posts(`id`) ON DELETE CASCADE
) ENGINE=InnoDB  DEFAULT CHARSET=utf8 AUTO_INCREMENT=1 ;

DROP TABLE IF EXISTS `posts_tags`;
CREATE TABLE IF NOT EXISTS `posts_tags` (
  `id` int(10) unsigned NOT NULL AUTO_INCREMENT,
  `owner` int(10) unsigned NOT NULL,
  `tagId` int(10) unsigned NOT NULL,
  `postId` int(10) unsigned NOT NULL,
  PRIMARY KEY (`id`),
  FOREIGN KEY (`postId`) REFERENCES posts(`id`) ON DELETE CASCADE,
  FOREIGN KEY (`tagId`) REFERENCES tags(`id`) ON DELETE CASCADE
) ENGINE=InnoDB  DEFAULT CHARSET=utf8 AUTO_INCREMENT=1 ; 
```

我不确定这在未来会有多快，但在一段时间内应该没问题，因为只有几个人使用数据库。

# apache - 使用 Apache/mod_proxy 重定向 URL 路径以转发到 tomcat servlet

> ID：664287
> 
> 赞同：4
> 
> 时间：2009-03-19T22:20:06.973
> 
> 标签：apache, tomcat, mod-proxy

我目前有一个在 ROOT 下运行的 tomcat servlet 1：

api1.myhost.com:8080/

我正在使用 mod_proxy 并将所有请求从 api1.myhost.com 转发到此实例。这是从今天开始工作的。

我现在安装了第二个 servlet 2，它在同一个 tomcat 实例（相同的 IP 地址）下运行：

www.myhost.com:8080/servlet2

我希望对新 URL api2 的所有请求都转到第二个 servlet，这样：

**api2** .myhost.com

现在被转发到第二个 servlet 实例。

我创建了一个 A 记录，这样 api2.myhost.com 指向我的服务器 IP。你如何让 api2.myhost.com 转发到 www.myhost.com:8080/servlet2 ？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-20T06:53:06.833

您需要使两个 VirtualHost 指向第一个 webapp，另一个指向第二个。

```
<VirtualHost *:80>
    ServerName api1.myhost.com
    ProxyPass / http://api1.myhost.com:8080/
    ProxyPassReverse / http://api1.myhost.com:8080/
</VirtualHost>

<VirtualHost *:80>
        ServerName api2.myhost.com
        ProxyPass / http://www.myhost.com:8080/servlet2
        ProxyPassReverse / http://www.myhost.com:8080/servlet2
</VirtualHost> 
```

请注意，由于 tomcat 上的路径与 apache 上的路径不同，因此您需要在应用程序中使用相对 URL。

# lisp - 如何判断列表是否包含第三项？

> ID：664288
> 
> 赞同：6
> 
> 时间：2009-03-19T22:20:07.410
> 
> 标签：lisp, scheme

我有一个函数，它接受一个包含两个或三个元素的列表。

```
;; expecting either ((a b c) d) or ((a b c) d e)
(define (has-third-item ls)
      (if (null? (caddr ls))
          false
          true)
      ) 
```

但是这段代码失败了

```
mcar: expects argument of type <mutable-pair>; given () 
```

在 (null? (caddr ls)) 表达式上。

我也试过

```
(eq? '() (caddr ls)) 
```

但它也没有用。如何判断是否有第三项？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-03-19T22:30:14.110

您不想要 caddr，您想要 (if (null? (cddr ls)) ... 或者只是使用 length 来查找列表的长度，并将其与您感兴趣的值进行比较。

终止列表的 '() 将始终位于一对的 cdr 位置，因此在 car 位置（cad+r 会这样做）寻找它不会有成效。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-03-19T22:31:51.767

问题是，如果您有一个包含两个或更少项目的列表，则无法获取它的 caddr。试试这个：

```
(define (has-third-item lst)
  (<= 3 (length lst))) 
```

在某些情况下，获取列表的长度可能效率低下（例如包含数百万个项目的列表）；在这种情况下，我们可以手动测试列表的长度是零、一还是二：

```
(define (has-third-item lst)
  (not (or (null? lst)
           (null? (cdr lst))
           (null? (cddr lst))))) 
```

**编辑：**关于[其他](https://stackoverflow.com/questions/664288/how-can-i-tell-if-a-list-has-a-third-item/664308#664308)[两个](https://stackoverflow.com/questions/664288/how-can-i-tell-if-a-list-has-a-third-item/664321#664321) 答案，虽然在这种情况下使用 cddr 可能会起作用，因为输入域由具有两个或三个元素的列表组成，对于具有零或一的列表，has-third-item 仍然会失败。为了通用性，我建议使用适用于任何领域的解决方案。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-06T12:37:38.543

如果您知道您的列表有两个或三个元素（正如您所说的那样），您可以这样做

```
(define (has-third-item? l)
  (not (null? (cddr l)))) 
```

您正在检查第二个 cons 单元格`(cddr l)`是否有 a `cdr`。您不必检查 l 本身是否为 null 或 l 是否只有一个元素，除非您想要更通用的函数。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-08T11:56:22.747

尝试...

```
(and l (cdr l)(cddr l)) 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-08T13:42:11.603

为什么不使用（第三个ls）

如果不存在，将返回第三个元素或 NIL。

# .net - 是否可以在 Access 2003 中使用 .NET 程序集？

> ID：664292
> 
> 赞同：0
> 
> 时间：2009-03-19T22:21:23.117
> 
> 标签：.net, ms-access

是否可以？

如果可能的话，我该怎么做，是否有问题？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-19T22:28:23.240

Access 2003 支持 COM，因此您应该能够使用 COM 互操作来访问它们，我会想到的。这里似乎有视频[声称](http://whitepapers.zdnet.com/abstract.aspx?docid=84974)要做到这一点。

# python - 是否可以只声明一个变量而不在 Python 中分配任何值？

> ID：664294
> 
> 赞同：353
> 
> 时间：2009-03-19T22:21:53.270
> 
> 标签：python, variable-assignment, variable-declaration

是否可以像这样在 Python 中声明一个变量？：

```
var 
```

使其初始化为无？似乎 Python 允许这样做，但是一旦您访问它，它就会崩溃。这可能吗？如果不是，为什么？

编辑：我想在这样的情况下这样做：

```
value

for index in sequence:

   if value == None and conditionMet:
       value = index
       break 
```

### 复制

*   [python中的未初始化值](https://stackoverflow.com/questions/664219/uninitialized-value-in-python)（同一作者）
*   [Python中有声明关键字吗？](https://stackoverflow.com/questions/571514/are-there-any-declaration-keywords-in-python)（同一作者）

### 有关的

*   [Python：变量范围和函数调用](https://stackoverflow.com/questions/575196/python-variable-scope-and-function-calls)
*   [其他语言有“变量”](http://python.net/~goodger/projects/pycon/2007/idiomatic/handout.html#other-languages-have-variables)

* * *

## 回答 #1

> 赞同：438
> 
> 时间：2009-03-19T22:23:05.373

为什么不这样做：

```
var = None 
```

Python是动态的，所以你不需要声明东西；它们自动存在于分配它们的第一个范围内。因此，您所需要的只是上面的常规旧赋值语句。

这很好，因为你永远不会得到一个未初始化的变量。但要小心——这并不意味着你最终不会得到*错误*初始化的变量。如果你初始化一些东西`None`，确保那是你真正想要的，如果可以的话，分配一些更有意义的东西。

* * *

## 回答 #2

> 赞同：61
> 
> 时间：2017-11-08T21:14:32.330

在 Python 3.6+ 中，您可以为此使用变量注释：

[https://www.python.org/dev/peps/pep-0526/#abstract](https://www.python.org/dev/peps/pep-0526/#abstract)

PEP 484 引入了类型提示，也就是类型注释。虽然它的主要重点是函数注释，但它还引入了类型注释的概念来注释变量：

```
# 'captain' is a string (Note: initial value is a problem)
captain = ...  # type: str 
```

PEP 526 旨在为 Python 添加用于注释变量类型（包括类变量和实例变量）的语法，而不是通过注释来表达它们：

```
captain: str  # Note: no initial value! 
```

它似乎更直接地符合您所问的“是否可以只声明一个变量而不在 Python 中分配任何值？”

* * *

## 回答 #3

> 赞同：60
> 
> 时间：2009-03-19T22:47:39.950

我衷心建议您阅读[其他语言有“变量”](http://python.net/~goodger/projects/pycon/2007/idiomatic/handout.html#other-languages-have-variables)（我将其添加为相关链接）——在两分钟内您就会知道 Python 有“名称”，而不是“变量”。

```
val = None
# ...
if val is None:
   val = any_object 
```

* * *

## 回答 #4

> 赞同：16
> 
> 时间：2009-03-19T22:24:10.643

我不确定你想做什么。Python 是一种非常动态的语言；在实际分配或使用变量之前，通常不需要声明变量。我想你想做的只是

```
foo = None 
```

这会将值分配给`None`变量`foo`。

编辑：你*真正*想做的就是这样：

```
#note how I don't do *anything* with value here
#we can just start using it right inside the loop

for index in sequence:
   if conditionMet:
       value = index
       break

try:
    doSomething(value)
except NameError:
    print "Didn't find anything" 
```

从这么短的代码示例中判断这是否真的是正确的风格有点困难，但它*是*一种更“Pythonic”的工作方式。

编辑：下面是 JFS 的评论（张贴在这里显示代码）

### 与OP的问题无关，但上面的代码可以重写为：

```
for item in sequence:
    if some_condition(item): 
       found = True
       break
else: # no break or len(sequence) == 0
    found = False

if found:
   do_something(item) 
```

注意：如果`some_condition()`引发异常则`found`未绑定。
注意：如果 len(sequence) == 0 则`item`未绑定。

上面的代码是不可取的。其目的是说明局部变量是如何工作的，即“变量”是否“定义”在这种情况下只能在运行时确定。首选方式：

```
for item in sequence:
    if some_condition(item):
       do_something(item)
       break 
```

或者

```
found = False
for item in sequence:
    if some_condition(item):
       found = True
       break

if found:
   do_something(item) 
```

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-11-02T13:00:57.530

好吧，如果你想检查一个变量是否被定义，那么为什么不检查它是否在 locals() 或 globals() 数组中呢？您的代码重写：

```
for index in sequence:
   if 'value' not in globals() and conditionMet:
       value = index
       break 
```

如果它是您要查找的局部变量，则将 globals() 替换为 locals()。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-03-19T22:24:31.267

我通常将变量初始化为表示类型的东西

```
var = "" 
```

或者

```
var = 0 
```

如果它将成为一个对象，那么在实例化它之前不要初始化它：

```
var = Var() 
```

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-03-19T22:59:51.917

首先，我对您最初提出的问题的回答

**问：如何发现变量是否在我的代码中的某个点定义？**

**答：在源文件中阅读，直到看到定义该变量的行。**

但更进一步，您已经给出了一个代码示例，其中有各种非常 Pythonic 的排列。您正在寻找一种扫描序列以查找匹配条件的元素的方法，因此这里有一些解决方案：

```
def findFirstMatch(sequence):
    for value in sequence:
        if matchCondition(value):
            return value

    raise LookupError("Could not find match in sequence") 
```

显然，在此示例中，您可以根据您想要实现的目标将 替换为`raise`a 。`return None`

如果你想要所有符合条件的东西，你可以这样做：

```
def findAllMatches(sequence):
    matches = []
    for value in sequence:
        if matchCondition(value):
            matches.append(value)

    return matches 
```

还有另一种方法`yield`，我不会费心向你展示，因为它的工作方式相当复杂。

此外，有一种方法可以实现这一点：

```
all_matches = [value for value in sequence if matchCondition(value)] 
```

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2009-03-19T23:04:45.150

如果我正确理解了您的示例，则无论如何您都不需要在 if 语句中引用“值”。只要可以将其设置为任何内容，您就会跳出循环。

```
value = None
for index in sequence:
   doSomethingHere
   if conditionMet:
       value = index
       break 
```

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-03-19T23:03:49.957

您看起来像是在尝试用 Python 编写 C。如果你想在一个序列中找到一些东西，Python 有内置函数可以做到这一点，比如

```
value = sequence.index(blarg) 
```

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2016-10-12T09:13:59.603

如果`None`是一个有效的数据值，那么你需要以另一种方式来改变变量。你可以使用：

```
var = object() 
```

这个哨兵是由[Nick Coghlan](http://python-notes.curiousefficiency.org/en/latest/python_concepts/break_else.html)建议的。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2016-11-16T15:59:21.553

这是一个很好的问题，不幸的是，因为`var = None`已经分配了一个值，所以答案很糟糕，如果您的脚本多次运行，它`None`每次都会被覆盖。

它与没有赋值的定义不同。我仍在试图弄清楚如何绕过这个问题。

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2019-11-11T07:20:19.873

是否可以在 Python 中声明一个变量（var=None）：

```
def decl_var(var=None):
if var is None:
    var = []
var.append(1)
return var 
```

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2014-09-12T07:51:37.257

```
var_str = str()
var_int = int() 
```

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2018-01-15T02:13:37.433

你可以用这个丑陋的 oneliner 来欺骗解释器它除了向局部变量字典`if None: var = None` 添加一个变量，而不是初始化它之外什么都不做。`var`如果您之后尝试在函数中使用此变量，解释器将抛出 UnboundLocalError 异常。这也适用于非常古老的 python 版本。不简单，也不漂亮，但不要对 python 期望太多。

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2021-12-19T09:01:53.063

我知道它来晚了，但使用 python3，你可以通过使用声明一个未初始化的值

```
uninitialized_value:str

# some code logic

uninitialized_value = "Value" 
```

但是要非常小心这个技巧，因为

```
uninitialized_value:str

# some code logic

# WILL NOT WORK
uninitialized_value += "Extra value\n" 
```

# .net - .NET 秒表类限制

> ID：664301
> 
> 赞同：2
> 
> 时间：2009-03-19T22:24:22.563
> 
> 标签：.net, windows, hardware-interface, stopwatch

这可能不是一个完全不与 .NET 相关的问题。我正在编写一个 .NET 应用程序来控制一些小工具。我定期向小工具发送命令（比如每 500 毫秒）。一旦我发送命令，我就会启动一个计时器。（.NET 秒表类）

如果小工具在 10 毫秒内没有响应，我会再次发送命令。如果它确实响应，我将继续通过发送更多命令并处理响应来监视小工具状态。

我有 2 或 3 个秒表计时器并行运行，为这个小工具做其他事情。

现在，我想监视和控制可能有数千个这样的小工具（可能高达 5000 个）。如果我为一个小工具创建一个对象，我将查看 10000 到 15000 个并行运行的秒表对象。我不确定秒表是如何工作的，但我认为它们依靠硬件计时器或类似的东西来跟踪时间。

我的问题是，windows 可以同时处理如此大量的秒表吗？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-03-19T22:29:42.783

我建议重新考虑这个设计。首先，秒表只是按照它所说的去做——它就像一个秒表。如果您希望某个事件以特定的时间间隔触发，您需要查看各种 Timer 类。

话虽如此，我建议在小工具之间共享您的计时器。您会发现一切都执行得更好，如果您创建的单个调度程序使用的计时器更少，并且调度程序管理小工具，则可能更容易编写和理解。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-03-19T22:32:51.530

秒表只不过是一个保存 Windows API 调用结果的变量`QueryPerformanceCounter()`，它在“运行”时没有开销。停止它`QueryPerformanceCounter()`再次调用，所以性能应该没问题。也就是说，我同意 Reed Copsey，你需要重新考虑你的设计。有了这么多的小工具，我会开始考虑设备驱动程序。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-19T22:49:35.140

考虑保存小工具响应的全局队列和一个或几个查询队列并在需要时重新发送消息的线程。它会表现得更好。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-19T22:52:29.767

使用一个时间源以指定的时间间隔安排事件

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-10-10T09:11:44.647

秒表类非常简单。它不是一直在“运行”的东西。当你告诉它开始时，它会查看系统时间，而当你告诉它暂停、停止、重置等时，它只是在每次执行此操作时查看系统时间。询问 ElapsedMilliseconds 相当于说 (Processor.CurrentTicks - StartTicks) / TicksPerMillisecond。这很简单，真的。该系统可以处理非常大量的这些。

我不会评论这是否适合您的问题，只是回答您的问题：该系统可以毫无问题地处理数千个秒表。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-19T22:35:03.257

我认为问题应该是您是否可以处理多个计时器；您将浪费大量时间阅读数千个计时器并且不执行任何功能。

我不知道 Stopwatch 类背后的实现，但我可以想象他们只是在开始和停止时读取计时器的值。所以一个 Stopwatch 实例可能几乎不需要任何资源。

但只是尝试一下；在一个循环中生成一个包含数千个实例的数组，启动它们，看看会发生什么。

# c# - C# 构造参数查询 SQL - LIKE %

> ID：664314
> 
> 赞同：17
> 
> 时间：2009-03-19T22:33:10.093
> 
> 标签：c#, sql, parameters, firebird

我正在尝试为 C# 中的参数查询构建 SQL，以获取包含该`LIKE %%`命令的查询。

这是我想要实现的（请注意数据库是 Firebird）

```
var SQL = string.format("SELECT * FROM {0} WHERE {1} LIKE '%?%'", TABLE, NAME);
 cmd.Parameters.AddWithValue(NAME, "JOHN"); 
```

现在我已经尝试了每一种排列以使参数起作用，我已经尝试过；

*   将`%`字符添加到参数中，

    ```
    cmd.Parameters.AddWithValue(NAME, "%" + "JOHN" + "%"); 
    ```

*   或者

    ```
    cmd.Parameters.AddWithValue(NAME, "'%" + "JOHN" + "%'"); 
    ```

我似乎无法让它工作，我怎样才能使用 LIKE 查询的参数来工作。

欢迎提出建议！

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2009-03-19T22:38:43.557

查询中的字符串文字内不能有参数。将整个值设为参数，并将通配符添加到字符串中：

```
var SQL = string.format("SELECT * FROM {0} WHERE {1} LIKE ?", TABLE, NAME);
Cmd.Parameters.AddWithValue(NAME, "%" + "JOHN" + "%"); 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-03-19T22:54:39.260

```
var SQL = string.Format("SELECT * FROM {0} WHERE {1} LIKE '%' + ? + '%'", TABLE, NAME);
Cmd.CommandText = SQL;
Cmd.Parameters.Add("?", SqlDbType.VarChar, 50).Value = "JOHN"; 
```

* * *

## 回答 #3

> 赞同：-5
> 
> 时间：2009-03-19T22:36:21.613

在过去这样做时，我只是将它集成到 sql 中，确保我用问号替换单引号来处理 sql 注入。例如：

```
var SQL = string.format("SELECT * FROM {0} WHERE {1} LIKE '%{2}%'",
  TABLE,
  NAME,
  JOHN.Replace("'","?")); 
```

# javascript - Internet Explorer 8 原型和 XMLHttpRequest

> ID：664315
> 
> 赞同：3
> 
> 时间：2009-03-19T22:33:38.343
> 
> 标签：javascript, html, internet-explorer, internet-explorer-8, xmlhttprequest

这部分是对解决方法的请求，部分是为了让人们知道 Internet Explorer 的原型实现仍然存在错误。

以下代码在 Internet Explorer 上不起作用。

```
XMLHttpRequest.prototype.old = XMLHttpRequest.prototype.open;
var x = new XMLHttpRequest();
x.old("POST", "test", false); 
```

对于 IE 8 测试版和所有以前的版本，XMLHttpRequest.prototype 属性从一开始就不存在。在 IE8 中，它确实存在，但您会收到“无效的过程调用或参数”错误。Internet Explorer 不喜欢装饰。

有谁知道这个的解决方法？

**更新**：

有人指出，我可以用新的函数和构造函数覆盖整个 XMLHttpRequest，然后创建一个包装脚本 ala XMLHttpRequest.js。原型方法要短得多，所以我还是更喜欢将它用于非 IE 浏览器。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-23T20:25:24.477

The problem seems to be that IE 8 recognizes XMLHttpRequest, but not as a function. Active X objects still seem to work. Instead of testing for the existance of window.XMLHtppRequest, I test for the typeof window.XMLHtppRequest. seems to work OK.

I recoded my get request as follows:

```
FG.ajax.getxhr = function(){
var xhr;
if (typeof window.XMLHttpRequest === 'function') {
    xhr  = XMLHttpRequest();
}
else {
    xhr = new ActiveXObject("Microsoft.XMLHTTP");
}
return xhr; 
```

# paypal - 如何在拍卖风格的 Web 应用程序中进行 PayPal/Google Checkout？

> ID：664318
> 
> 赞同：2
> 
> 时间：2009-03-19T22:34:21.930
> 
> 标签：paypal, transactions, payment-gateway, google-checkout

我很好奇是否有一种方法可以在我的网站上处理/连接买家和卖家，而无需网站向买家收费并贷记卖家。换句话说，我不想*碰*钱，但我确实想在我的网站上尽可能多地整合这个过程。

我想我要问的是拍卖网站如何管理买卖双方之间的交易？我真的不希望我的网站求助于通过电子邮件向买家发送卖家的联系信息并说......“这是卖家信息。祝你好运。”

Ebay 似乎允许买家去 PayPal 向卖家付款，但在确认付款后返回 Ebay。即使交易是在买方和卖方之间进行的，Ebay 也能够检索有关该交易的一些详细信息。这仅仅是因为 Ebay 拥有 PayPal，还是其他网站也可以这样做？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-30T21:02:57.697

- 这是一个老问题，但信息有点不对，所以我会尝试重新回答。

这一切都是可行的。没有像codingspace建议的那样自定义代码。

Paypal 有多种结帐类型，我在快速结帐方面有一些不错的经验，所以我将尝试用这些电话的例子来回答。

`SetExpressCheckout`您可以使用回拨 uri（以便您查看客户是否确认）和请求中的卖家信息（您需要卖家提供适当的信息）来设置付款。

这样，一旦他们确认，您就可以`DoExpressCheckoutPayment`使用卖家和信息以及返回的信息向他们收费`SetExpressCheckout`。

这就是有效的过程。真的很简单。

就收取佣金而言，您无法通过该特定交易进行。大多数大型零售商所做的是记录所有佣金并在月底向卖家开具账单。另一种选择是强迫卖家购买预付信用，然后将其用于每次销售的佣金，这就是 trademe.co.nz 所做的（新西兰的 ebay）。

让我知道任何问题。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-19T23:12:02.480

我猜您那时不想从您网站上的每笔销售中收取佣金。唯一想到的是让卖家在销售后提供自己的贝宝“立即购买”按钮，然后您可以将其提供给买家。

# c++ - 我可以将 C++ 字符串传递给流样式的方法吗？

> ID：664320
> 
> 赞同：2
> 
> 时间：2009-03-19T22:35:07.157
> 
> 标签：c++, string, stringstream

我想这样做：

```
MyClass mc = MyClass("Some string" << anotherString); 
```

感谢您的回答，我决定根据您告诉我的内容重新编写这个问题，因为它变得有点混乱。最终，我阅读了[C++ 格式的宏/内联 ostringstream](https://stackoverflow.com/questions/303562/c-format-macro-inline-ostringstream)，并决定使用宏，因为使用构造函数实际上不可能做到这一点。有些答案我不再相关。

现在，我实际上可以做的是：

```
MY_CLASS("Some string" << anotherString << " more string!"); 
```

使用这个宏：

```
#include <sstream>

#define MY_CLASS(stream) \
MyClass( ( dynamic_cast<std::ostringstream &> ( \
    std::ostringstream() . seekp( 0, std::ios_base::cur ) << stream ) \
) . str() ) 
```

MyClass 构造函数采用字符串的位置：

```
MyClass::MyClass(string s) { /* ... */ } 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-19T23:23:54.463

重新设计您的解决方案。如果您的 c-tor 需要字符串，它应该接受字符串。
如果您的构造函数接受 const 引用，那么在这种情况和类似情况下也会更好。

```
no matching function for call to ‘MyClass(std::basic_ostream <..>&) 
```

发生错误是因为 operator<< 定义并返回 std::basic_ostream 而不是 std::stringstream 对象。当然你可以使用

```
dynamic_cast< const std::stringstream& >( s << "hello" << "world" ) 
```

但是你的团队负责人可能会因为这段代码解雇你:)

**顺便提一句：**

```
MyClass mc = MyClass("Some string" << anotherString); 
```

可以重写为

```
MyClass mc("Some string" << anotherString); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-19T22:38:46.227

您的编译错误看起来像已包含

```
<iosfwd> 
```

在你班级的头文件中，但你没有包括

```
<sstream> 
```

在 cxx 文件中。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-19T22:50:11.987

我认为您应该查看[这个](https://stackoverflow.com/questions/303562/303675#303675)问题以获取有关获得所需行为所需的一些提示。

这种事情似乎有点困难。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-19T22:50:23.513

<< 运算符返回 ostream &，而不是 streamstream &，因此您必须进行动态转换：

```
MyClass::MyClass(ostream &stream)
{
    string myString = dynamic_cast<stringstream &>(stream.str());
}

stringstream s;
MyClass *mc = new MyClass(s << "Some string" << anotherString); 
```

但这确实是一件可怕的事情。尝试这样的事情：

```
class Streamer
{
stringstream stream;
public:
    template <class T>
    Streamer &operator <<(const T &object) { stream << object; return *this;}
    operator string() { return stream.str(); }
};    

class MyClass
{
public:
    MyClass(const string &s) : MyString(s) {}
    string MyString;
};

int main()
{
    MyClass myClass(Streamer() << "something" << "world");
    cout << myClass.MyString;
} 
```

# pdf - 将 PCL 转换为 PDF

> ID：664330
> 
> 赞同：7
> 
> 时间：2009-03-19T22:38:49.767
> 
> 标签：pdf, ocaml, ghostscript, printer-control-language

我希望创建（作为概念验证）一个将 PCL 代码转换为 PDF 格式的 OCaml（最好）程序。我不知道从哪里开始。是否有这样做的标准化算法？是否有任何其他建议可用于完成此任务？

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2011-02-12T11:57:24.323

Ghostscript 开发人员最近将他们的姊妹产品 GhostXPS、GhostPCL 和 GhostSVG 集成到他们的[Ghostscript 源代码树](http://svn.ghostscript.com/ghostscript/trunk/ghostpdl)中。（现在称为*GhostPDL*。）所以所有这些附加功能（加载、渲染和转换 XPS、PCL 和 SVG）现在都可以从那里获得。

这意味着你可以建立他们的*语言切换*二进制文件。理论上，这可以使用 PCL、PDF 和 PostScript 并将其转换为许多其他格式。虽然它在我需要时对我有用，但 Ghostscript 开发人员建议停止使用语言切换二进制文件（因为它“几乎不受支持”——请参阅 KenS 对此答案的评论），而是改用显式二进制文件`pcl6.exe`（PCL 输入)、`gsvg.exe`（SVG 输入，也“几乎不支持”）和`gxps.exe`（我不清楚支持状态）。

**因此，*要将 PCL 代码转换为 PDF 格式*作为请求区域，您可以使用** `pcl6` **命令行实用程序，它是 Ghostscript 的** `gs/gswin32c.exe`.

示例命令行：

```
 pcl6.exe  \
  -o output.pdf  \
  -sDEVICE=pdfwrite  \
   [...more parameters as required (optional)...]  \
  -f input.pcl 
```

* * *

**更新**根据 KenS 在评论中的提示进行了

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-24T15:38:39.407

PCL 到 PDF 的转换可能非常复杂（假设您需要它是通用的，而不仅仅是简单的 PCL）。我们已经对此进行了多次投资，最终总是恢复使用其他工具。我们一直在调查，因为我们是一家开发商店，我们非常详细地使用和理解 PCL 的所有元素。如果您对 PCL 不是很熟悉，那将是一项艰巨的任务。主要问题之一是加班，打印机在很大程度上已经成为格式错误的 PCL 的容忍者，因此，创建符合法律条文的规则并不总是足够的。如果; 但是，您可以控制 PCL，您可能会取得一定程度的成功。

我并不是要让你关闭它，我意识到你来这里是为了寻找编程答案，但我不得不说，这远非简单的任务，并且没有“标准化算法”可以解决这个问题（即我知道）。

如果这被设计为与您正在构建的其他东西一起工作的工具，我强烈建议您看看这些人：

[PageTech](http://www.pagetech.com)

这是迄今为止处理此问题的最完整的工具集 (Windows)。还有一些其他的，但根据我们多年来对 PCL 和转换工具的广泛使用，这是唯一一直有效的。

**编辑：**最近我们一直在使用 LincPDF ( [http://www.lincolnco.com/](http://www.lincolnco.com/) )。这也是一款优秀的产品，有一个很大的好处，部署简单。其他一些工具具有复杂的软件安装。这个解决方案对我们来说很容易部署为应用程序中的一个功能。它也比我们迄今为止测试过的任何工具都更快（至少使用我们从应用程序生成的 PCL，因为它们包含专门的字体和宏，所以相当复杂）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-19T23:19:09.670

有一系列来自惠普的参考书；您可以重新实现 PCL 解析器并输出相应的 PDF。

您可以从“PCL 5 打印机语言技术参考手册”（[http://h20000.www2.hp.com/bc/docs/support/SupportManual/bpl13210/bpl13210.pdf](http://h20000.www2.hp.com/bc/docs/support/SupportManual/bpl13210/bpl13210.pdf)）开始。搜索 HP 了解更多信息 ( [http://search.hp.com/query.html?qt=PCL+reference](http://search.hp.com/query.html?qt=PCL+reference) )。

或者您可以从 GhostPCL ( [http://www.ghostscript.com/GhostPCL.html](http://www.ghostscript.com/GhostPCL.html) )窃取代码或想法

# java - JAVA 的流中何时会出现 EOFException

> ID：664331
> 
> 赞同：17
> 
> 时间：2009-03-19T22:38:59.860
> 
> 标签：java, input, stream, eofexception

我正在使用 DataInputStream 并且有一个关于 EOFExceptions 的问题。

根据java文档：

> 表示输入期间意外到达文件结尾或流结尾。
> 
> 此异常主要由数据输入流用来表示流结束。请注意，许多其他输入操作在流结束时返回一个特殊值，而不是引发异常。

这是否意味着当生成 EOFException 时，流将永远不会再次打开？这是否意味着您永远不应该期望从中获得更多数据？

如果输出流连接到输入流并调用了 outputstream.close()，输入流会收到 EOFException 还是 IOException？

IOException 描述为：

> 表示发生了某种 I/O 异常。此类是由失败或中断的 I/O 操作产生的一般异常类。

输出流的关闭是否会在数据输入流端产生 EOFException 或 IOException？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-03-19T22:44:07.570

关键词出乎意料。

如果您使用 DataInputStream 并读取一个 4 字节整数，但流中只剩下 3 个字节，您将收到 EOFException。

但是如果你在流的末尾调用 read() 你只会得到 -1 并且没有例外。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2014-01-04T00:36:07.637

当您到达流的末尾（文件末尾或对等方关闭连接）时：

*   `read()`返回 -1
*   `readLine()`返回空
*   `readXXX()`对于任何其他 X throws `EOFException`。

流仍处于打开状态，但您应该停止读取并关闭它。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-03-19T22:48:29.620

回答您问题的另一部分：是的，EOF 意味着不会在流上看到更多数据；你应该关闭它。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-03-19T22:45:10.250

EOFException 是 IOException 的子类。如果您尝试从流中读取并且没有要读取的数据（例如，因为您的 DataInputStream 被包裹在 FileInputStream 周围并且您尝试读取的字节数多于文件中剩余的字节数），它将被抛出。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2010-10-13T18:00:26.267

EOFException is thrown:

1.  if there is no data in a **STREAM** but you are trying to read...eg read methods of chain streams like DataInputStream, ObjectInputStream, RandomAccessFile throw EOFException if they are trying to read from FileInputStream but the FileInputStream is empty
2.  or if the formats are not matching...eg if int is present and you are using readFloat() of DataInputStream

# linux - Server Permits 脚本中的更改不起作用。这可能是由于 PHP.ini 不同吗？

> ID：664332
> 
> 赞同：0
> 
> 时间：2009-03-19T22:39:05.600
> 
> 标签：linux, php

这是我的网站不可移植的证据。我有一些在我的旧服务器上完美运行的正则表达式。我现在已将我的网站转移到新服务器，但它不起作用。

```
$handle = popen('/usr/bin/python '.YOUTUBEDL.'youtube-dl.py -o '.VIDEOPATH.$fileName.'.flv '.$url.' 2>&1', 'rb');

while(!feof($handle))
{
    $progress = fread($handle, 8192);
    $pattern = '/(?<percent>[0-9]{1,3}\.[0-9]{1,2})% of (?<filesize>.+) at/';
    ///######Does not execute this if - no matches
    if(preg_match_all($pattern, $progress, $matches)){
    fwrite($fh, $matches[0][0]."\r\n");
    }
} 
```

shell 的输出是这样的，正则表达式应该匹配文件大小和百分比。

```
[download]  56.8% of 4.40M at  142.40k/s ETA 00:13 
```

正则表达式在前一个服务器上工作，但不是这个。为什么？我该如何调试呢？

服务器的不同之处在于，以前的服务器是 Fedora，现在是 Centos。我还将 shell 指定为 /bin/bash。

PHP.ini 中是否有任何可能导致更改的内容？

请帮忙。

## 更新

$progress 的输出是这样的：（只是一个小样本）

```
[download] 87.1% of 4.40M at 107.90k/s ETA 00:05 
[download] 89.0% of 4.40M at 107.88k/s ETA 00:04 
[download] 91.4% of 4.40M at 106.09k/s ETA 00:03 
[download] 92.9% of 4.40M at 105.55k/s ETA 00:03 
```

## 更新 2

由于输出中的额外间距，该正则表达式会失败吗？

Also would a different shell make a difference??

## [SOLVED]

This was solved and it was due to the regex requiring a P - see here for more details: [Does this regex in PHP actually work?](https://stackoverflow.com/questions/669178/does-this-regex-in-php-actually-work)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-20T04:36:06.007

Is the output from the working or non working server? It's possible safe mode is enabled on the second and the script is refusing to execute. Check the Notes section on this page for more information [http://us.php.net/popen](http://us.php.net/popen)

To verify, and I do see the comments where you placed the output of the python command, print out the $progress variable in the php script. I'm not sure if the output you supplied is when you ran the python command from cli or got that from the php script itself. But if it's from the python script outputting that $progress variable will help determine if popen() is really executing that command.

(You should be able to tell if safe mode is enabled by running phpinfo() in your script)

Or you could do this

```
if( ini_get('safe_mode') ){
    print "safe mode on\n";
}else{
    print "safe mode off\n";
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-19T22:51:55.070

I've never heard of regexps breaking while switching PHP configs, so I'm wondering if it's the python that might be breaking. This might be a silly question, but have you checked that your exec line works from a terminal?

# visual-c++ - 如何在 VC++ 6.0 中自动链接调试/发布库？

> ID：664333
> 
> 赞同：2
> 
> 时间：2009-03-19T22:39:06.177
> 
> 标签：visual-c++, linker, release-builds, debug-build

我正在尝试维护一个 5 年前用 VC++ 6.0 编写的程序。它使用我们的“通用”库。我遇到的问题是，它要么链接到这些库的调试版本，要么链接到发布版本，这取决于我是否将 [库文件] 的 [目录] 设置为 [工具]->[选项]。

如何在构建调试版本时链接到 [common\debug\common.lib]，在构建发布版本时链接到 [common\release\common.lib]？如果我在库目录中有两个路径，它似乎链接到它找到的第一个。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-01T04:18:05.000

而不是指定包含文件夹中的路径，我用来根据配置包含库的所有最佳方法是使用#pragma

试试这个，非常有用

```
#ifdef _DEBUG
#pragma comment(lib, "..\\DllTest\\Debug\\DllTest.lib")

#else 
#pragma comment(lib, "..\\DllTest\\Release\\DllTest.lib")

#endif 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-19T22:46:08.190

在 [Project Properties]->[Linker]->[Input]->[Additional Dependencies] 中，您可以使用 $(ConfigurationName) 占位符，如下所示：

```
c:\common\$(ConfigurationName)\common.lib 
```

* * *

在调试配置中，这将更改为：

```
c:\common\Debug\common.lib 
```

在 Release 中，它将更改为：

```
c:\common\Release\common.lib 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-19T22:53:18.750

> 如果我在库目录中有两个路径，它似乎链接到它找到的第一个。

只需添加调试设置的调试文件夹和发布设置的发布文件夹。

几乎所有编译器、链接等设置都是每个配置（如果调试和发布不同，项目属性将在“所有配置”中显示设置为空白（如果我记得正确的文本）。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-19T22:42:11.867

您可以在 Additional Dependancies 字段中指定要链接到的库的完整路径，这对于调试和发布版本可以有不同的值。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-20T09:49:40.170

我找到的解决方案有点像理查德和“1800 信息”的......

我从`Tools->Options`. 这里的路径对于在 MSVS VC++ 6.0 中运行的所有项目的所有配置都是全局的。

`Project->Settings`然后，我为每个配置添加了相应库的完整路径。因此调试配置有`D:\VSS\Common\Debug\Common.lib`，发布配置有`D:\VSS\Common\Release\Common.lib`。这似乎有效，而且我第一次没有构建警告！

感谢所有为我指明正确方向的建议。

--- 阿利斯泰尔。

# ruby - ruby 的 object_id 方法是否引用内存位置？

> ID：664334
> 
> 赞同：8
> 
> 时间：2009-03-19T22:39:15.163
> 
> 标签：ruby

或者这个方法只是表示每个对象都有一个唯一的整数？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-03-19T22:52:10.920

它是许多参数、值、对象类型、在内存中的位置的组合。
更多可以在[这里阅读](http://www.oreillynet.com/ruby/blog/2006/02/ruby_values_and_object_ids.html)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-03-19T23:12:28.407

它不是对内存位置的直接引用，并且“编码”特定于特定的 Ruby 实现。如果您能阅读 C 代码，您可能会发现查看Ruby 1.8.6 源代码中的`rb_obj_id`和`id2ref`方法很有启发性。[您还可以在Ruby Hacking Guide 第 2 章](http://rhg.rubyforge.org/chapter02.html)`gc.c`的部分翻译的“嵌入在 VALUE 中的对象”部分中阅读有关“编码”的更多信息。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2010-11-16T03:22:23.213

值得注意的是，您可以使用以下方法执行对象 ID 的反向查找：

```
ObjectSpace._id2ref(object_id) 
```

例如：

```
ObjectSpace._id2ref(0) #=> false
ObjectSpace._id2ref(1) #=> 0
ObjectSpace._id2ref(2) #=> true
ObjectSpace._id2ref(3) #=> 1
ObjectSpace._id2ref(4) #=> nil 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-19T22:48:20.367

好吧，这取决于您所说的“ruby”的含义；）据我所知，在jruby中，它只是一个唯一的整数。

此外，数字之类的东西不是内存位置。我忘记了所有细节，我相信有人会给你。

```
irb(main):020:0> 1.object_id
=> 3 
irb(main):021:0> (2-1).object_id
=> 3 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-19T22:49:39.477

在“普通”红宝石（MRI 1.8.x 和 1.9.x）中，它只是一个独特的值。

IronRuby 中也是如此

# c# - 如何使用 Linq 从 ViewData.ModelState 中获取异常？

> ID：664336
> 
> 赞同：2
> 
> 时间：2009-03-19T22:40:08.033
> 
> 标签：c#, asp.net, asp.net-mvc, linq

我编写了以下代码来提取异常以及引用来自 ASP.Net MVC 中的 ViewData.Modelstate 属性的属性的字符串键。我认为应该可以用 Linq 表达式来做到这一点，但这让我完全摸不着头脑。

```
 var exceptions = new Dictionary<string, Exception>();
       foreach (KeyValuePair<string, ModelState> propertyErrorsPair in ViewData.ModelState)
       {
           foreach (var error in propertyErrorsPair.Value.Errors)
           {
               if (error.Exception != null)
               {
                   exceptions.Add(propertyErrorsPair.Key, error.Exception);
               }
           }
       } 
```

那么有没有一种 Linq 方法可以做到这一点？我猜这可能与 SelectMany 有关，但正如我所说，我无法完全弄清楚如何实现这一目标。

谢谢

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-19T22:53:14.397

这是等效的 LINQ 表达式：

```
var result = ViewData.ModelState.SelectMany(x => x.Value.Errors
   .Where(error => error.Exception != null)
   .Select(error => new KeyValuePair<string, Exception>(x.Key, error.Exception))); 
```

# c# - LINQ to objects 'where' 子句在幕后做什么？

> ID：664337
> 
> 赞同：5
> 
> 时间：2009-03-19T22:40:20.123
> 
> 标签：c#, .net, linq, performance, where-clause

我刚刚替换了这段代码：

```
foreach( var source in m_sources )
{
    if( !source.IsExhausted )
    {
        ....
    }
} 
```

有了这个：

```
foreach( var source in m_sources.Where( src => !src.IsExhausted ) )
{
   ...
} 
```

现在代码看起来更好（对我来说），但我想知道这里到底发生了什么。我担心这种情况下的性能，如果应用此过滤器意味着会发生某种编译器魔法，那将是个坏消息。

这两段代码基本上是在做“相同”的事情吗？是否创建了临时容器来进行过滤，然后将它们传递给我的 foreach？

任何有关该主题的帮助将不胜感激。谢谢。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-03-19T22:59:49.513

关键字和 lambda 确实涉及在`yield return`编译时创建隐藏类和在运行时分配额外对象，如果您的背景是 C 或 C++，那么关心性能是很自然的。

自然，但错误！

[我尝试通过局部变量的闭包来测量 lambdas 的开销](http://incrediblejourneysintotheknown.blogspot.com/2009/03/amazing-speed-of-net-garbage-collector.html)，发现它非常小（仅几纳秒），几乎在所有应用程序中都没有意义。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-19T22:46:42.260

这取决于 m_sources 的类型。

如果它是来自 LINQ to SQL 或实体框架的数据上下文，则您传递的参数将被编译为 Expression 的实例并被解析以创建 SQL（在数据模型的帮助下）。在此过程中有一些实际成本，但可能（在大多数情况下）由数据库的往返行程所支配。

如果它是 IEnumerable 那么 Where 几乎实现为：

```
public static IEnumnerable<T> Where(this IEnumerable<T> input, Func<T, bool> predicate) {
  foreach (var v in input) {
    if (predicate(v)) {
      yield return v;
    }
  }
} 
```

这非常有效并且执行得很慢（因此，如果您提前退出循环，则谓词将不会应用于整个集合）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-19T22:43:59.223

基本上，是的，它是相同的，O(n)。

where 子句将在您遍历列表时执行（即，如果您在第一个项目之后中断，则不会测试以下项目）。

# django - 如何传递 Q 列表以过滤 OR 查找？

> ID：664345
> 
> 赞同：4
> 
> 时间：2009-03-19T22:44:39.393
> 
> 标签：django, orm, django-models, lookup

如何传递 Q 列表以过滤 OR 查找？就像是：

```
q_list = [Q(xyz__isnull=True), Q(x__startswith='x')]? 
```

如果没有清单，我会这样做：

```
Model.objects.filter(Q(xyz__isnull=True) | Q(x__startswith='x')) 
```

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-03-19T22:47:14.490

使用 python 的 reduce() 函数：

```
import operator
reduced_q = reduce(operator.or_, q_list)
Model.objects.filter(reduced_q) 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-10-02T15:50:08.563

Q 对象也有一个`add`方法，它接受另一个 Q 对象和一个 Q 连接器（AND 或 OR）。

```
q_object = Q(xyz__isnull=True)
q_object.add(Q(x__startswith='x'), Q.OR) 
```

我发现这在构建 OR 过滤器时很有帮助，并且我在我的博客上写了一个更长的示例：[“在 Django 中添加”Q 对象](http://bradmontgomery.blogspot.com/2009/06/adding-q-objects-in-django.html)

# vb6 - 您最喜欢的 Visual Basic 6.0 工具和技巧

> ID：664370
> 
> 赞同：30
> 
> 时间：2009-03-19T22:53:34.520
> 
> 标签：vb6

这与类似[的帖子](https://stackoverflow.com/questions/147339/visual-studio-6-tips-and-tricks)有些相关，但该帖子通常是 Visual Studio 6，并且很多建议不适用于 Visual Basic 6.0。

建议或投票选择工具/技巧。每个帖子请一个工具/提示，以便每个人都可以单独投票。包括对工具功能的简要说明。

* * *

## 回答 #1

> 赞同：72
> 
> 时间：2009-03-19T23:18:00.767

在 VB6 中启用鼠标滚轮：

[微软：启用鼠标滚轮](http://support.microsoft.com/?id=837910)

* * *

## 回答 #2

> 赞同：37
> 
> 时间：2009-03-19T22:54:43.130

**MZ 工具。**

自由。IDE 的许多额外工具，例如“Favorite Procedures”和“Add error routine to prodedure”等等。

[http://www.mztools.com/v3/mztools3.aspx](http://www.mztools.com/v3/mztools3.aspx)

* * *

## 回答 #3

> 赞同：36
> 
> 时间：2009-03-20T17:47:56.387

安装 VB6 后，我总是在 Tools-Options 上进行这些自定义。

*   **在编辑器选项卡上**关闭自动语法检查。**当您键入语法错误时，您不需要消息框 - 您只希望问题行显示为红色，以便稍后修复它。**

***   **在编辑器选项卡**上打开需要变量声明。**不要想，就去做吧。**

    ***   **在 General 选项卡上**关闭 Compile On Demand 。**您希望在运行代码时立即被告知语法错误，而不仅仅是在实际调用狡猾的例程时。**

    ***   编辑：在程序启动时**提示保存更改**，在环境选项卡上。（感谢wqw在评论中提醒我。）

    *   **在常规选项卡上将错误捕获**设置为“中断未处理的错误”。实际上，这是个人喜好 - 但您应该选择适合您的设置。希望您已经为 VB6 程序制定了错误处理策略？

    *   我有一个 LCD 屏幕，默认颜色效果不太好，所以我将它们更改为较浅的颜色。我也在使用[Consolas](http://www.microsoft.com/DOWNLOADS/details.aspx?familyid=22E69AE4-7E40-4807-8A86-B3D36FAB68D3&displaylang=en)字体。无论如何，让我的 VB6 代码看起来像 21 世纪 :)****** 

 ***** * *

## 回答 #4

> 赞同：15
> 
> 时间：2009-03-20T18:17:23.663

令人惊讶的是，有多少人不使用 IDE 按钮来注释和取消注释源代码块。它们位于“**编辑**”工具栏上，如下所示：[alt text http://img231.imageshack.us/img231/1949/vb6commentbuttons.gif](http://img231.imageshack.us/img231/1949/vb6commentbuttons.gif "按钮的图像")。右键单击工具栏区域的未占用部分并勾选“编辑”选项以显示工具栏。

我曾经参加过一个“高级VB6”课程，讲师不知道这些按钮。

* * *

编辑： AngryHacker 有一种[方法](http://www.angryhacker.com/blog/archive/2009/02/10/5-ways-to-be-a-more-efficient-developer-in-5.aspx)可以将快捷键与这些按钮相关联，以便在击键时评论和取消注释代码块。

* * *

## 回答 #5

> 赞同：11
> 
> 时间：2009-06-15T09:12:21.857

我不敢相信还没有人发布[Bruce McKinney 的 Hardcore Visual Basic（现在在 mvps.org 上免费在线）](http://vb.mvps.org/hcvb.asp)！好吧，它是一本书而不是一个软件，但它扩展为一个名副其实的工具和技巧聚宝盆。

* * *

## 回答 #6

> 赞同：11
> 
> 时间：2009-06-25T18:30:41.667

**SmartIndenter**负责所有的自动缩进。它只做一件事，而且做得非常好。它是免费的。

[http://www.oaltd.co.uk/Indenter/Default.htm](http://www.oaltd.co.uk/Indenter/Default.htm)

[SmartIndenter http://img151.imageshack.us/img151/1392/screencaps1.jpg](http://img151.imageshack.us/img151/1392/screencaps1.jpg)

* * *

## 回答 #7

> 赞同：7
> 
> 时间：2009-04-29T12:59:09.180

vbAccelerator[网站](http://www.vbaccelerator.com)。它有很多很棒的示例和完整源代码的免费控件。该网站已经有几年没有更新了，但它仍然在运行，当我在 VB6 中工作时，我仍然会回到它。

* * *

## 回答 #8

> 赞同：6
> 
> 时间：2009-03-19T23:23:35.463

我真的很讨厌通过将数组传递给尝试执行 UBound 并在发生错误时捕获错误的帮助函数来检查数组是否未初始化。

解决方案？

使用 VarPtr 获取数组的地址，将地址传递给 CopyMemory 获取数组的 SafeArray 结构，如果 SafeArray 结构指示 0 维，则数组未初始化。

**编辑**感谢 Lance 与示例的良好链接

[http://vbnet.mvps.org/index.html?code/helpers/getarraydims.htm](http://vbnet.mvps.org/index.html?code/helpers/getarraydims.htm)

* * *

## 回答 #9

> 赞同：6
> 
> 时间：2009-03-20T13:25:57.403

[GoF 的设计模式](https://rads.stackoverflow.com/amzn/click/com/0201633612)。虽然它似乎并不特定于 VB6，但大多数模式都是基于接口实现和聚合对象（与继承相反）这一事实使其非常适合与 VB6 一起使用。他们在第 16 至 18 页讨论了这一点，并在一份声明中加以总结。*编程到接口，而不是实现*如果 VB6 和 COM 做得好的一件事就是处理接口。

* * *

## 回答 #10

> 赞同：6
> 
> 时间：2009-03-20T16:30:39.533

整个 mvps.org 网站[在这里](http://www.mvps.org/)

我推荐 Karl Peterson 的 One stop source 和 Randy Birch 的 VBnet（与 VB.NET 无关）和 Common Controls Replacement Project。

* * *

## 回答 #11

> 赞同：5
> 
> 时间：2009-04-08T18:46:12.247

[Make My Manifest](http://mmm4vb6.atom5.com/)可以生成无注册的 COM 清单（根据需要插入“样式”等）。这允许 XCopy 将许多 VB6 EXE 部署到 WinXP 或更高版本。

不再有“依赖”恐惧或 DLL 地狱！

* * *

## 回答 #12

> 赞同：5
> 
> 时间：2009-06-23T22:08:10.913

VB6 IDE 不记得您对最大化代码窗口的偏好。要启动 VB6 代码窗口最大化，请设置此字符串注册表项：

[HKEY_CURRENT_USER\Software\Microsoft\Visual Basic\6.0]

"MdiMaximized"="1"

* * *

## 回答 #13

> 赞同：4
> 
> 时间：2009-03-21T05:13:11.557

查看[http://angryhacker.com/blog/archive/2008/05/01/vb6-swiss-army-knife.aspx](http://angryhacker.com/blog/archive/2008/05/01/vb6-swiss-army-knife.aspx)

每当我必须深入研究 VB6 时，它都有我使用的大多数工具，以及对它们所做工作的描述。除了这里提到的工具外，它还具有以下功能：

[PDSA 属性创建器](http://www.angryhacker.com/download/pdsaclassbuilder.zip)

[ADO 存储过程生成器插件](http://www.vbrad.com/article.aspx?id=103)

[集合类主加载项](http://www.angryhacker.com/download/colclassmaster.zip)

* * *

## 回答 #14

> 赞同：3
> 
> 时间：2009-03-19T22:59:06.973

Matt Curlands Power VB 书籍和随附的 VBoost 工具，尤其是类型库编辑器。

请注意不符合 DEP 的技术。

* * *

## 回答 #15

> 赞同：3
> 
> 时间：2009-04-08T09:05:08.803

vbAdvance[加载](http://vb.mvps.org/tools/vbAdvance/)项现在是免费的。

vbAdvance 是一个 Visual Basic 插件，可让您访问高级构建功能和许多 IDE 便利功能。创建控制台应用程序、创建导出函数的标准 DLL、在 DLL 中创建 DllMain 入口点、XP 样式的 XP Manifest 编译器、终端服务器等。

* * *

## 回答 #16

> 赞同：2
> 
> 时间：2009-03-19T22:56:25.857

**用于 VB6 的 CodeSmart 2009**

我没有试过这个。

[http://www.axtools.com/products/cs2k3vb_screenshots.htm](http://www.axtools.com/products/cs2k3vb_screenshots.htm)

* * *

## 回答 #17

> 赞同：2
> 
> 时间：2009-03-19T23:48:33.017

当我第一次学习使用向导制作表单/小型应用程序，然后检查它们输出的代码时，我发现了很多东西。

* * *

## 回答 #18

> 赞同：2
> 
> 时间：2009-05-04T21:42:54.527

我用过的一个很棒的工具叫做 CodeFixer。我相信我首先在这里偶然发现了[CodeFixer](http://www.planet-source-code.com/vb/scripts/ShowCode.asp?txtCodeId=59247&lngWId=1)。

它甚至是开源的。我与作者罗杰·吉尔克里斯特（Roger Gilchrist）进行了一些接触，他似乎仍在利用他有限的空闲时间来研究它。

* * *

## 回答 #19

> 赞同：1
> 
> 时间：2009-03-20T19:02:27.877

我自己还没有尝试过，但[CodeShine](http://www.wsdesigns.com/CodeShine/default.htm)是 VB6 的廉价重构插件。显然，它可以进行有用的*[提取方法](http://www.refactoring.com/catalog/extractMethod.html)*重构。

我必须停止在这里浪费时间并下载[免费试用版](http://www.wsdesigns.com/download.htm)进行试用。

* * *

## 回答 #20

> 赞同：1
> 
> 时间：2009-03-20T19:20:52.340

VB6 错误处理很糟糕。所以我采用了这些模式来使它更容易：

Try-Catch 块：

```
 'Try
        On Error Goto catchX

        ...

    'Catch
catchX: if err.number then
            ...
            resume resumX
resumX: end if
        On Error Goto outside_catch_label_name
    'End Try 
```

在错误中包含堆栈跟踪：

```
sub rethrow(byval source as string)
    Err.Source = Err.Source & vbNewLine & vbTab & "@ " & Source
    Err.Raise Err.Number, Err.Source, Err.Description
end sub

sub some_sub: on error goto throw
    ...
throw: if err.number then rethrow("some_sub")
end sub 
```

* * *

## 回答 #21

> 赞同：1
> 
> 时间：2009-05-30T07:54:55.677

Aivosto 的项目分析器[http://www.aivosto.com/project/project.html](http://www.aivosto.com/project/project.html)

* * *

## 回答 #22

> 赞同：1
> 
> 时间：2009-06-22T02:02:55.557

## 蜘蛛眼弹性袋

[来自Spider Eye](http://www.spidereye.com)的名为[Spider Eye Flexbag](http://www.spidereye.com/software/flexbag)的集合类替代品是绝对必须的。它比 VB 附带的集合类好 100%，与原始集合相比，它的速度非常快。Flexbag 系列由“Carl 'n Gary's Visual Basic Home Page”名声的 Gary Wisniewski 编写。

不幸的是，Spider Eye 网站目前似乎没有指向 Flex Bag 的链接，但我敢肯定，如果您与他们联系，他们会很乐意为您解决问题。如果您正在做任何基于收藏的工作，那么这将是非常值得的。

## AVE 代码查找器

[AVE Code Finder](http://www.devx.com/vb2themax/CodeDownload/19738)很方便，因为 VB6 IDE 中的 Find 功能不可信。AVE Code Finder 也比内置的 Find 快得多。它是由 www.ave.com.pl 的 Jarek Zwierz 编写的，[但](http://www.ave.com.pl)该站点似乎不再存在，因此我链接到的版本位于 VB2TheMax。

* * *

## 回答 #23

> 赞同：1
> 
> 时间：2010-09-22T11:46:20.763

列出开发团队的 VB6 Credits Easter Egg :)

要显示 VB6 Program Credits，请在标准工具栏上创建一个“About”按钮，并将其标题重命名为“Show VB Credits”。这里有更多细节：

1.  右键单击工具栏并选择“自定义”
2.  在“命令”选项卡中选择“帮助”类别
3.  将“关于 Microsoft Visual Basic”命令（对话框的右侧窗口）拖动到标准工具栏的末尾。
4.  在不关闭“自定义”对话框的情况下，右键单击刚刚创建的按钮并将其名称更改为“显示 VB Credits”
5.  关闭“自定义”并单击新按钮。

[发现名人的](http://rads.stackoverflow.com/amzn/click/0201707128) [奖励](http://rads.stackoverflow.com/amzn/click/0321169514)积分。

* * *

## 回答 #24

> 赞同：0
> 
> 时间：2011-07-07T10:57:45.800

我为我的公司购买了[Codejock SuitePro](http://www.codejock.com)。它们有许多要在 VB6 和 C++ 中使用的组件，包括在控件中对 XAML 的支持，这是 WPF 的轻量级版本。

# html - 在网页上显示额外信息哪个更好？单击或悬停时弹出？

> ID：664371
> 
> 赞同：3
> 
> 时间：2009-03-19T22:53:35.300
> 
> 标签：html, user-interface, usability

我喜欢在网页中显示有关某些关键字的更多信息。我不想将访问者转到另一个页面，我更喜欢在当前页面顶部显示额外信息。

关键字位于 html 列表中。它基本上是一个功能列表，我想提供有关这些功能的更多信息。所以我有两个基于“更多信息”或“？”的想法。超链接。

1.  用户将鼠标悬停在链接上，一个弹出窗口会显示信息，并在他们悬停时消失。
2.  他们单击链接，会出现一个带有“X”的弹出窗口，然后单击 X 关闭。

哪一个提供更好更友好的用户体验？

我喜欢#1，因为他们不必点击打开和点击关闭，但缺点是当他们将鼠标悬停在页面上时，窗口可能会无意中打开。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-19T22:58:05.213

两者都很烦人，但如果我不得不选择两个邪恶中的较小者，我会选择正确完成的鼠标悬停。

您可以在页面上设置 Javascript 来处理意外的鼠标悬停，而是在显示弹出窗口之前等待几秒钟。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-19T22:59:25.583

你的用户会期待什么？尽量不要打破这些期望。

也许可以尝试一个走廊可用性研究，当他们走过办公室时抓住少数用户，然后让他们告诉你他们的期望。:)

询问 Stack Overflow 也是一个好主意，但你不会获得上下文的优势，这对于可用性测试非常重要。

作为一个用户，当我移动鼠标并意外弹出一些东西时，我觉得很烦人。即使有javascript延迟（更好），我仍然认为当我没有明确点击它时会弹出一些东西是出乎意料的。

但是，这可能会因应用程序的上下文而异。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-19T23:04:10.033

人们不希望悬停时弹出窗口 - 我肯定会点击。

**编辑/添加：**想想你每天访问的网站——文本和图片（通常）是静态的，悬停最多可以改变颜色或为链接添加下划线，或显示可点击链接的小菜单。

单击链接时，您期望会发生一些事情 - 重定向到另一个页面、包含信息的弹出框、正在提交的表单等。

我并不是说这是最好的做事方式，但它**是**99% 的网络工作的方式，并且要求用户处理悬停时的弹出框等是拒绝它们的好方法。我知道我个人不阅读任何带有双下划线链接的页面；这是一个很好的迹象，表明滚动阅读内容时意外中断可能最终导致我的鼠标悬停在带有广告的链接上。

在可点击的文本旁边放一个小图形，或者以其他方式表示点击会带来更多信息，这是提供上下文信息而不会让人们感到沮丧的好方法。对于世界上大部分地区，无需点击的弹出窗口仍然 == 广告或间谍软件。

**编辑/澄清：**我不是指**新窗口**意义上的弹出窗口，只是一个灯箱样式的 javascript 弹出窗口。不要让用户离开页面，并给他们一个非常明显的按钮来单击以关闭弹出窗口。我想我的意思是人们不希望在不点击的情况下发生某些事情，尤其是如果它会占用屏幕上的更多空间。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-19T23:29:10.973

就个人而言，我会选择点击选项。网络上有一个标准的工作方式，它说悬停是关于链接本身的信息以及点击它会做什么（“查看更多评论”、“点击寻求帮助”等），而点击实际上是什么执行动作。

如果您决定使用悬停选项，请确保对其进行编码，以便用户可以选择弹出窗口中的文本。当您只想在某处复制一些有用的信息而 GUI 在您到达它之前将其隐藏时，这真的很烦人。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-19T23:54:27.760

除了其他人所说的，我也更喜欢点击选项。

悬停选项的问题是，也许这只是我，如果可悬停区域偏小，我很难让鼠标保持足够的静止以保持悬停。在阅读过程中，光标往往会从链接上移开，而我漂亮的帮助文本也会消失。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-04-07T16:08:16.503

作为另外几个需要考虑的先例，您可能需要考虑[acronym](http://www.w3schools.com/tags/tag_acronym.asp)和[abbr](http://www.w3schools.com/tags/tag_abbr.asp) HTML 标记的功能。两者都允许您提供有关页面中特定文本的额外信息，并且都基于“悬停”原则。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-04-07T16:13:55.553

思考点：

*   如果项目太密集以至于你在任何地方移动鼠标都会在悬停时弹出一些东西，那么不要悬停！
*   你可以让悬停显示非常简短的信息，并点击显示更多详细信息吗？如果它适合你，这可能是两全其美的。
*   你能有一个专门的盒子在你悬停时显示信息吗？这可能比任何弹出窗口都要好。意见不一...

最后，从用户的角度来看，它适用于您的应用程序。

# python - 在 python 中使用挪威字母æøå

> ID：664372
> 
> 赞同：5
> 
> 时间：2009-03-19T22:54:03.537
> 
> 标签：python, utf-8

我现在正在学习 python 和 PyGTK，并创建了一个简单的音乐管理器。 [http://pastebin.com/m2b596852](http://pastebin.com/m2b596852) 但是，当它用挪威字母 æ、ø 和 å 编辑歌曲时，它只是将它们更改为一个奇怪的字符。

那么有什么好的方法可以将名称打开或编码为 utf-8 字符吗？

### 上述代码中的两个相关地方：

从文件中读取信息：

```
def __parse(self, filename):
    "parse ID3v1.0 tags from MP3 file"
    self.clear()
    self['artist'] = 'Unknown'
    self['title'] = 'Unknown'
    try:
        fsock = open(filename, "rb", 0)
        try:
            fsock.seek(-128, 2)
            tagdata = fsock.read(128)
        finally:
            fsock.close()
        if tagdata[:3] == 'TAG':
            for tag, (start, end, parseFunc) in self.tagDataMap.items():
                self[tag] = parseFunc(tagdata[start:end])
    except IOError:
        pass 
```

打印到 sys.stdout 信息：

```
for info in files:
    try:
        os.rename(info['name'], 
            os.path.join(self.dir, info['artist'])+' - '+info['title']+'.mp3')

        print 'From: '+ info['name'].replace(os.path.join(self.dir, ''), '')
        print 'To:   '+ info['artist'] +' - '+info['title']+'.mp3'
        print
        self.progressbar.set_fraction(i/num)
        self.progressbar.set_text('File %d of %d' % (i, num))
        i += 1
    except IOError:
        print 'Rename fail' 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-03-19T23:57:53.227

您想首先将输入从它所在的字符集解码为 utf-8（在 Python 中，编码意味着“将其从 unicode/utf-8 转换为其他字符集”）。

一些谷歌搜索表明挪威字符集是plain-ole 'iso-8859-1'......如果我在这个细节上错了，我希望有人能纠正我。无论如何，以下示例中的字符集名称是什么：

```
tagdata[start:end].decode('iso-8859-1') 
```

在现实世界的应用程序中，我意识到您不能保证输入是挪威语或任何其他字符集。在这种情况下，您可能希望通过一系列可能的字符集来查看可以成功转换的字符集。SO 和 Google 都对在 Python 中有效执行此操作的算法提出了一些建议。这听起来比实际上更可怕。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-19T23:06:49.903

您需要将从文件中读取的字节字符串转换为 Unicode 字符串。查看您的代码，我会在解析函数中执行此操作，即替换`stripnulls`为这样的内容

```
def stripnulls_and_decode(data):
    return codecs.utf_8_decode(data.replace("\00", "")).strip() 
```

请注意，这仅在文件中的字符串实际上以 UTF-8 编码时才有效 - 如果它们采用不同的编码，则必须使用`codecs`模块中相应的解码功能。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-19T23:33:04.240

我不知道 mp3 标签使用什么编码，但如果您确定它是 UTF-8，那么：

```
 tagdata[start:end].decode("utf-8") 
```

该行`# -*- coding: utf-8 -*-`定义了您的源代码编码，并没有定义用于读取或写入文件的编码。

# lisp - 您可以从 Scheme 中的函数中返回任何内容吗？

> ID：664373
> 
> 赞同：11
> 
> 时间：2009-03-19T22:54:22.367
> 
> 标签：lisp, scheme

我正在编写一个方案解释器，如果是 if 语句，例如：

```
(if (< 1 0) 'true) 
```

我尝试过的任何解释器都会返回一个新的提示。但是当我编写这个代码时，我有一个 if 是否有替代表达式。如果没有打印任何内容，我可以返回什么？

```
(if (has-alternative if-expr)
  (eval (alternative if-expr))
  #f) ;; what do I return here? 
```

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-03-20T06:30:29.650

根据[R6RS 规范](http://www.r6rs.org/final/html/r6rs/r6rs-Z-H-14.html#node_idx_368)：

> 如果 <test> 产生 #f 并且没有指定 <alternate>，则表达式的结果是未指定的。

所以去狂野吧，返回任何你想要的东西！虽然#f 或'() 是我个人所期望的。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-03-20T09:56:57.110

Scheme 确实可以不返回任何值：

```
 > (values) 
```

在 R5RS 中，if 的单臂形式被指定为返回一个未指定的值。这意味着由您决定返回哪个值。相当多的方案选择引入称为“未指定值”的特定值并返回该值。其他人返回“不可见的值” #<void> 并且 REPL 被写入以便它不打印它。

```
 > (void) 
```

一开始可能会认为，这与 (values) 相同，但请注意区别：

```
 > (length (list (void)))
  1

  > (length (list (values)))
  error>  context expected 1 value, received 0 values
  (Here (list ...) expected 1 value, but received nothing) 
```

如果 #<void> 是列表的一部分，则打印：

```
 > (list (void))
  (#<void>) 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-20T03:01:18.950

许多方案（PLT、Ikarus、Chicken）都有一个 void 类型，您可以使用 (void) 生成它。

至少在 PLT 中，void 是你做的时候得到的（当 (< 1 0) #t 时）。

（PLT v4 不允许 if 没有 else 子句。）

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-03-27T18:38:43.227

当返回值未指定时，你可以返回你喜欢的；用户不能依赖该值存在、永远存在或跨实现。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-19T23:04:53.807

首先，可以要求 if 有一个 else 子句，如果它让你更容易。其次，Scheme 支持从函数返回多个值，因此如果要将返回值实现为列表，则可以有一个空列表表示没有给出返回值。

```
(if (has-alternative if-expr)
  (eval (alternative if-expr)) ; make sure eval returns a list
  '()) 
```

这里有一个重要的区别：如果没有 else 子句，我不会返回一个空列表。空列表表示没有返回值。如果一个表达式有一个返回值（比如说它是 3），那么您将有 (3) 作为幕后 eval 的返回值。同样，从表达式返回多个值会导致 eval 返回列表具有多个元素。

最后，实际上，如果条件失败并且没有其他条件，您实际上可以返回*任何*内容，因为在程序中尝试捕获不返回任何内容的函数的值将是错误的。因此，捕获此错误将是程序员而不是语言的工作。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-04-06T12:32:24.203

奇怪的人会返回`'nil`或`'||`（空符号）。问题是返回一个不能返回的符号`(eval (alternative if-expr))`以避免混淆。

如果可以返回任何内容，`(eval (alternative if-expr))`并且您仍然想知道您是否选择了此替代方案，则必须在结果中包含更多信息：

```
(if (has-alternative if-expr)
  (cons #t (eval (alternative if-expr)))
  (cons #f #f)) 
```

因此，结果是一个 cons 单元格。如果它的车是#t，那么你评估了一些东西。如果它是#f，你没有。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-03-19T23:58:16.533

只是有什么问题：

```
(if (has-alternative if-expr) (eval (alternative if-expr))) 
```

?

# java - java中未知长度的字节数组

> ID：664389
> 
> 赞同：72
> 
> 时间：2009-03-19T23:00:58.263
> 
> 标签：java, buffer, byte

我在 java 中构造一个字节数组，但我不知道数组会有多长。

我想要一些像 Java 的 StringBuffer 这样的工具，你可以调用 .append(byte b) 或 .append(byte[] buf) 并让它缓冲我所有的字节，并在我完成后返回给我一个字节数组。是否有一个类可以像 StringBuffer 一样为字节做字符串？它看起来不像 ByteBuffer 类是我正在寻找的。

有人有好的解决方案吗？

* * *

## 回答 #1

> 赞同：121
> 
> 时间：2009-03-19T23:04:18.770

试试[`ByteArrayOutputStream`](http://java.sun.com/javase/6/docs/api/java/io/ByteArrayOutputStream.html)。您可以使用`write( byte[] )`，它会根据需要增长。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2013-09-28T11:27:12.370

只是为了扩展前面的答案，您可以使用[ByteArrayOutputStream](http://docs.oracle.com/javase/6/docs/api/java/io/ByteArrayOutputStream.html)及其方法`public void write(byte[] b, int off, int len)`，其中参数为：

> b - 数据
> 
> off - 数据中的起始偏移量
> 
> len - 要写入的字节数

如果您想将其用作“字节构建器”并逐字节插入，您可以使用以下命令：

```
byte byteToInsert = 100;
ByteArrayOutputStream baos = new ByteArrayOutputStream();
baos.write(new byte[]{byteToInsert}, 0, 1); 
```

然后您可以使用`baos.toString()`方法将数组转换为字符串。优点是当您需要设置输入的编码时，您可以简单地使用 ie：

```
baos.toString("Windows-1250") 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-10-24T05:21:07.403

我写了一个非常容易使用并且避免大量字节数组缓冲区复制的。

它有一种称为add的方法。

您可以向其添加字符串、字节、字节、长整数、整数、双精度、浮点数、短整数和字符。

该 API 易于使用且具有一定的故障安全性。它不允许您复制缓冲区，也不会促进拥有两个阅读器。

它有一个边界检查模式和一个我知道我在做什么模式，没有边界检查。

边界检查模式会自动增长它，所以没有麻烦。

[https://github.com/RichardHightower/boon/wiki/Auto-Growable-Byte-Buffer-like-a-ByteBuilder](https://github.com/RichardHightower/boon/wiki/Auto-Growable-Byte-Buffer-like-a-ByteBuilder)

这是有关如何使用它的完整分步指南。它在 github 上。

# Java Boon - 像 ByteBuilder 一样的自动增长字节缓冲区

你有没有想要一个易于使用的自动增长的缓冲区数组和/或你可以给它一个固定的大小并添加东西？我有。我也写了一篇。

看..我可以向它写入字符串（它将它们转换为 UTF-8）。

```
 ByteBuf buf = new ByteBuf();
    buf.add(bytes("0123456789\n"));
    buf.add("0123456789\n");
    buf.add("0123456789\n");
    buf.add("0123456789\n");
    buf.add("0123456789\n");
    buf.add("0123456END\n"); 
```

然后稍后我可以从缓冲区中读取字符串：

```
 String out = new String(buf.readAndReset(), 0, buf.len());
    assertEquals(66, buf.len());
    assertTrue(out.endsWith("END\n")); 
```

我永远不必设置数组的大小。它将根据需要以有效的方式自动增长。

如果我确切地知道我的数据将有多大，那么我可以使用**createExact**来保存一些边界检查。

```
 ByteBuf buf = ByteBuf.createExact(66);
    buf.add(bytes("0123456789\n"));
    buf.add("0123456789\n");
    buf.add("0123456789\n");
    buf.add("0123456789\n");
    buf.add("0123456789\n");
    buf.add("0123456END\n");
    assertEquals(66, buf.len()); 
```

如果我使用 create exact，那么我是在说……嘿……我确切地知道它可以长到多大，而且它永远不会超过这个数字，如果是这样……你可以用麻袋打我的头岩石！

以下用一袋石头击中你的头！抛出异常！！！！

```
 ByteBuf buf = ByteBuf.createExact(22);
    buf.add(bytes("0123456789\n"));
    buf.add("0123456789\n");
    buf.add("0123456789\n");
    buf.add("0123456789\n");
    buf.add("0123456789\n");
    buf.add("0123456END\n"); 
```

**它适用于双打。**

```
 ByteBuf buf = ByteBuf.createExact(8);

    //add the double
    buf.add(10.0000000000001);

    byte[] bytes = buf.readAndReset();
    boolean worked = true;

    worked |= idxDouble(bytes, 0) == 10.0000000000001 || die("Double worked"); 
```

**它适用于浮动。**

```
 ByteBuf buf = ByteBuf.createExact(8);

    //add the float
    buf.add(10.001f);

    byte[] bytes = buf.readAndReset();
    boolean worked = true;

    worked |= buf.len() == 4 || die("Float worked");

    //read the float
    float flt = idxFloat(bytes, 0);

    worked |= flt == 10.001f || die("Float worked"); 
```

**它适用于 int。**

```
 ByteBuf buf = ByteBuf.createExact(8);

    //Add the int to the array
    buf.add(99);

    byte[] bytes = buf.readAndReset();
    boolean worked = true;

    //Read the int back
    int value = idxInt(bytes, 0);

    worked |= buf.len() == 4 || die("Int worked length = 4");
    worked |= value == 99 || die("Int worked value was 99"); 
```

**它适用于字符。**

```
 ByteBuf buf = ByteBuf.createExact(8);

    //Add the char to the array
    buf.add('c');

    byte[] bytes = buf.readAndReset();
    boolean worked = true;

    //Read the char back
    int value = idxChar(bytes, 0);

    worked |= buf.len() == 2 || die("char worked length = 4");
    worked |= value == 'c' || die("char worked value was 'c'"); 
```

**它适用于短。**

```
 ByteBuf buf = ByteBuf.createExact(8);

    //Add the short to the array
    buf.add((short)77);

    byte[] bytes = buf.readAndReset();
    boolean worked = true;

    //Read the short back
    int value = idxShort(bytes, 0);

    worked |= buf.len() == 2 || die("short worked length = 2");
    worked |= value == 77 || die("short worked value was 77"); 
```

**它甚至适用于字节。**

```
 ByteBuf buf = ByteBuf.createExact(8);

    //Add the byte to the array
    buf.add( (byte)33 );

    byte[] bytes = buf.readAndReset();
    boolean worked = true;

    //Read the byte back
    int value = idx(bytes, 0);

    worked |= buf.len() == 1 || die("byte worked length = 1");
    worked |= value == 33 || die("byte worked value was 33"); 
```

您可以将各种原语添加到字节数组中。

```
 boolean worked = true;
    ByteBuf buf = ByteBuf.create(1);

    //Add the various to the array
    buf.add( (byte)  1 );
    buf.add( (short) 2 );
    buf.add( (char)  3 );
    buf.add(         4 );
    buf.add( (float) 5 );
    buf.add( (long)  6 );
    buf.add( (double)7 );

    worked |= buf.len() == 29 || die("length = 29");

    byte[] bytes = buf.readAndReset();

    byte myByte;
    short myShort;
    char myChar;
    int myInt;
    float myFloat;
    long myLong;
    double myDouble; 
```

现在我们只需验证我们可以读回所有内容。

```
 myByte    =   idx       ( bytes, 0 );
    myShort   =   idxShort  ( bytes, 1 );
    myChar    =   idxChar   ( bytes, 3 );
    myInt     =   idxInt    ( bytes, 5 );
    myFloat   =   idxFloat  ( bytes, 9 );
    myLong   =    idxLong   ( bytes, 13 );
    myDouble  =   idxDouble ( bytes, 21 );

    worked |= myByte   == 1 || die("value was 1");
    worked |= myShort  == 2 || die("value was 2");
    worked |= myChar   == 3 || die("value was 3");
    worked |= myInt    == 4 || die("value was 4");
    worked |= myFloat  == 5 || die("value was 5");
    worked |= myLong   == 6 || die("value was 6");
    worked |= myDouble == 7 || die("value was 7"); 
```

一旦你打电话

```
 byte[] bytes = buf.readAndReset() 
```

那么你是说你已经完成了 ByteBuffer！

一旦你请求字节，它就变得毫无用处，因为它将内部字节数组设置为空。

当您调用 readAndReset 时，它会为您提供缓冲区。这是我的内部状态，你可以拥有它，但我会将它设置为 null，这样其他人就不会使用它了。

没关系。如果您确定一次只有一个实例正在使用缓冲区（字节 []），请创建另一个。

您甚至可以使用刚刚使用的缓冲区

```
ByteBuf buf2 = new ByteBuf.create(bytes); 
```

这是因为没有缓冲区被复制。ByteBuf 写入你给它的缓冲区。如果您希望将另一个副本提供给 ByteBuf，请执行以下操作：

```
ByteBuf buf2 = new ByteBuf.create( copy(bytes) ); 
```

毕竟这是福音。:)

快来看看恩赐。您可以免费获得上述类和 idx，以及 idxInt 和 idxLong！

[https://github.com/RichardHightower/boon/](https://github.com/RichardHightower/boon/)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-10-20T11:22:24.983

让我们来看看。Java中有ByteBuffer类。

[http://docs.oracle.com/javase/7/docs/api/java/nio/ByteBuffer.html](http://docs.oracle.com/javase/7/docs/api/java/nio/ByteBuffer.html)

它具有将连续字节序列从字节数组传输到硬件缓冲区的批量方法。它会成功的。

它还具有绝对和相对 get 和 put 方法，用于读取和写入 byte[]s 和其他原语到 / 用于字节缓冲区。

它还具有压缩、复制和切片字节缓冲区的方法。

```
// Creates an empty ByteBuffer with a 1024 byte capacity
ByteBuffer buf = ByteBuffer.allocate(1024);

// Get the buffer's capacity
int capacity = buf.capacity(); // 10

buf.put((byte)0xAA); // position=0

// Set the position
buf.position(500);

buf.put((byte)0xFF);

// Read the position 501
int pos = buf.position(); 

// Get remaining byte count
int remaining = buf.remaining(); (capacity - position) 
```

它还有一个批量放置来放置一个数组，这非常接近您要求的附加：

```
public final ByteBuffer put(byte[] src) 
```

请参阅：http://docs.oracle.com/javase/7/docs/api/java/nio/ByteBuffer.html#put(byte[])

我编写了自己的小库来操作字节数组。:)

你可以像这样添加它们

```
byte [] a = ...
byte [] b = ...
byte [] c = ...

a = add(a, b);
a = add(a, c); 
```

这将为您提供 b 的所有内容，并在 a 的内容之后为您提供 c。

如果您想将 a 增长到 21，您可以执行以下操作：

```
a = grow( letters,  21); 
```

如果您想将 a 的大小加倍，可以执行以下操作：

```
a = grow( letters,  21); 
```

看...

[https://github.com/RichardHightower/boon/blob/master/src/main/java/org/boon/core/primitive/Byt.java](https://github.com/RichardHightower/boon/blob/master/src/main/java/org/boon/core/primitive/Byt.java)

```
 byte[] letters =
            arrayOfByte(500);

    assertEquals(
            500,
            len(letters)
    ); 
```

创造

```
 byte[] letters =
            array((byte)0, (byte)1, (byte)2, (byte)3);

    assertEquals(
            4,
            len(letters)
    ); 
```

指数

```
 byte[] letters =
            array((byte)'a', (byte)'b', (byte)'c', (byte)'d');

    assertEquals(
            'a',
            idx(letters, 0)
    );

    assertEquals(
            'd',
            idx(letters, -1)
    );

    assertEquals(
            'd',
            idx(letters, letters.length - 1)
    );

    idx(letters, 1, (byte)'z');

    assertEquals(
            (byte)'z',
            idx(letters, 1)
    ); 
```

包含

```
 byte[] letters =
            array((byte)'a',(byte) 'b', (byte)'c', (byte)'d');

    assertTrue(
            in((byte)'a', letters)
    );

    assertFalse(
            in((byte)'z', letters)
    ); 
```

片：

```
 byte[] letters =
            array((byte)'a', (byte)'b', (byte)'c', (byte)'d');

    assertArrayEquals(
            array((byte)'a', (byte)'b'),
            slc(letters, 0, 2)
    );

    assertArrayEquals(
            array((byte)'b', (byte)'c'),
            slc(letters, 1, -1)
    );

    //>>> letters[2:]
    //['c', 'd']
    //>>> letters[-2:]
    //['c', 'd']

    assertArrayEquals(
            array((byte)'c', (byte)'d'),
            slc(letters, -2)
    );

    assertArrayEquals(
            array((byte)'c', (byte)'d'),
            slc(letters, 2)
    );

    //>>> letters[:-2]
    //     ['a', 'b']
    assertArrayEquals(
            array((byte)'a', (byte)'b'),
            slcEnd(letters, -2)
    );

    //>>> letters[:-2]
    //     ['a', 'b']
    assertArrayEquals(
            array((byte)'a',(byte) 'b'),
            slcEnd(letters, 2)
    ); 
```

生长

```
 byte[] letters =
            array((byte)'a', (byte)'b', (byte)'c', (byte)'d', (byte)'e');

    letters = grow( letters,  21);

    assertEquals(
            'e',
            idx(letters, 4)
    );

    assertEquals(
            'a',
            idx(letters, 0)
    );

    assertEquals(
            len(letters),
            26
    );

    assertEquals(
            '\0',
            idx(letters, 20)
    ); 
```

收缩：

```
 letters =  shrink ( letters, 23 );

    assertArrayEquals(
            array((byte)'a', (byte)'b', (byte)'c'),
            letters

    ); 
```

复制：

```
 assertArrayEquals(
            array((byte)'a', (byte)'b', (byte)'c', (byte)'d', (byte)'e'),
            copy(array((byte)'a', (byte)'b', (byte)'c', (byte)'d', (byte)'e'))

    ); 
```

添加：

```
 assertArrayEquals(
            array((byte)'a', (byte)'b', (byte)'c', (byte)'d', (byte)'e', (byte)'f'),
            add(array((byte)'a', (byte)'b', (byte)'c', (byte)'d', (byte)'e'), (byte)'f') ); 
```

add 实际上是通过使用 System.arraycopy 将它们添加在一起的（考虑到 Unsafe，但还没有）。

将一个数组添加到另一个数组：

```
 assertArrayEquals(
            array(     (byte)'a', (byte)'b', (byte)'c', (byte)'d', (byte)'e', (byte)'f'),
            add( array((byte)'a', (byte)'b', (byte)'c', (byte)'d'), array((byte)'e', (byte)'f') )

    ); 
```

插入：

```
 assertArrayEquals(
            array((byte)'a', (byte)'b', (byte)'c', (byte)'d', (byte)'e', (byte)'f', (byte)'g'),
            insert( array((byte)'a', (byte)'b', (byte)'d', (byte)'e', (byte)'f', (byte)'g'), 2, (byte)'c' )

    );

    assertArrayEquals(
            array((byte)'a', (byte)'b', (byte)'c', (byte)'d', (byte)'e', (byte)'f', (byte)'g'),
            insert( array((byte)'b', (byte)'c', (byte)'d', (byte)'e', (byte)'f', (byte)'g'), 0, (byte)'a' )

    );

    assertArrayEquals(
            array((byte)'a', (byte)'b', (byte)'c', (byte)'d', (byte)'e', (byte)'f', (byte)'g'),
            insert( array((byte)'a', (byte)'b', (byte)'c', (byte)'d', (byte)'e', (byte)'g'), 5, (byte)'f' )

    ); 
```

以下是一些方法：

```
public static byte[] grow(byte [] array, final int size) {
    Objects.requireNonNull(array);

    byte [] newArray  = new byte[array.length + size];
    System.arraycopy(array, 0, newArray, 0, array.length);
    return newArray;
}

public static byte[] grow(byte [] array) {
    Objects.requireNonNull(array);

    byte [] newArray  = new byte[array.length *2];
    System.arraycopy(array, 0, newArray, 0, array.length);
    return newArray;
}

public static byte[] shrink(byte[] array, int size) {
    Objects.requireNonNull(array);

    byte[] newArray = new byte[array.length - size];

    System.arraycopy(array, 0, newArray, 0, array.length-size);
    return newArray;
}

public static byte[] copy(byte[] array) {
    Objects.requireNonNull(array);
    byte[] newArray = new byte[array.length];
    System.arraycopy(array, 0, newArray, 0, array.length);
    return newArray;
}

public static byte[] add(byte[] array, byte v) {
    Objects.requireNonNull(array);
    byte[] newArray = new byte[array.length + 1];
    System.arraycopy(array, 0, newArray, 0, array.length);
    newArray[array.length] = v;
    return newArray;
}

public static byte[] add(byte[] array, byte[] array2) {
    Objects.requireNonNull(array);
    byte[] newArray = new byte[array.length + array2.length];
    System.arraycopy(array, 0, newArray, 0, array.length);
    System.arraycopy(array2, 0, newArray, array.length, array2.length);
    return newArray;
}

public static byte[] insert(final byte[] array, final int idx, final byte v) {
    Objects.requireNonNull(array);

    if (idx >= array.length) {
        return add(array, v);
    }

    final int index = calculateIndex(array, idx);

    //Object newArray = Array.newInstance(array.getClass().getComponentType(), array.length+1);
    byte [] newArray = new byte[array.length+1];

    if (index != 0) {
        /* Copy up to the location in the array before the index. */
        /*                 src     sbegin  dst       dbegin   length of copy */
        System.arraycopy( array,   0,      newArray, 0,       index );
    }

    boolean lastIndex = index == array.length -1;
    int remainingIndex = array.length - index;

    if (lastIndex ) {
        /* Copy the area after the insert. Make sure we don't write over the end. */
        /*                 src  sbegin   dst       dbegin     length of copy */
        System.arraycopy(array, index,   newArray, index + 1, remainingIndex );

    } else {
        /* Copy the area after the insert.  */
        /*                 src  sbegin   dst       dbegin     length of copy */
        System.arraycopy(array, index,   newArray, index + 1, remainingIndex );

    }

    newArray[index] = v;
    return  newArray;
}

public static byte[] insert(final byte[] array, final int fromIndex, final byte[] values) {
    Objects.requireNonNull(array);

    if (fromIndex >= array.length) {
        return add(array, values);
    }

    final int index = calculateIndex(array, fromIndex);

    //Object newArray = Array.newInstance(array.getClass().getComponentType(), array.length+1);
    byte [] newArray = new byte[array.length +  values.length];

    if (index != 0) {
        /* Copy up to the location in the array before the index. */
        /*                 src     sbegin  dst       dbegin   length of copy */
        System.arraycopy( array,   0,      newArray, 0,       index );
    }

    boolean lastIndex = index == array.length -1;

    int toIndex = index + values.length;
    int remainingIndex = newArray.length - toIndex;

    if (lastIndex ) {
        /* Copy the area after the insert. Make sure we don't write over the end. */
        /*                 src  sbegin   dst       dbegin     length of copy */
        System.arraycopy(array, index,   newArray, index + values.length, remainingIndex );

    } else {
        /* Copy the area after the insert.  */
        /*                 src  sbegin   dst       dbegin     length of copy */
        System.arraycopy(array, index,   newArray, index + values.length, remainingIndex );

    }

    for (int i = index, j=0; i < toIndex; i++, j++) {
        newArray[ i ] = values[ j ];
    }
    return  newArray;
} 
```

更多的....

# sql - SQL IN 子句比单个查询慢

> ID：664405
> 
> 赞同：4
> 
> 时间：2009-03-19T23:09:41.113
> 
> 标签：sql, mysql, performance, hibernate, jpa

我在 MySQL 5.0.67 中使用 Hibernate 的 JPA 实现。MySQL 配置为使用 InnoDB。

在执行 JPA 查询（转换为 SQL）时，我发现使用该`IN`子句比执行单个查询要慢。例子：

```
SELECT p FROM Person p WHERE p.name IN ('Joe', 'Jane', 'Bob', 'Alice') 
```

比四个单独的查询慢：

```
SELECT p FROM Person p WHERE p.name = 'Joe'
SELECT p FROM Person p WHERE p.name = 'Jane'
SELECT p FROM Person p WHERE p.name = 'Bob'
SELECT p FROM Person p WHERE p.name = 'Alice' 
```

为什么是这样？这是 MySQL 的性能限制吗？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-03-19T23:45:35.253

这是 MySQL 中的一个已知缺陷。

通常情况下， using`UNION`的性能比您展示的范围查询更好。对于使用`IN (...)`. 布尔表达式的优化器中存在一个类似的漏洞`OR`。

有关一些解释和详细基准，请参阅[http://www.mysqlperformanceblog.com/2006/08/10/using-union-to-implement-loose-index-scan-to-mysql/](http://www.mysqlperformanceblog.com/2006/08/10/using-union-to-implement-loose-index-scan-to-mysql/)。

优化器一直在改进。一个版本的 MySQL 的缺陷可能会在后续版本中得到改进。因此，值得在不同版本上测试您的查询。

`UNION ALL`使用而不是简单地使用也是有利的`UNION`。两个查询都使用一个临时表来存储结果，但不同之处在于它`UNION`适用`DISTINCT`于结果集，这会导致额外的未索引排序。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-19T23:15:51.923

如果您使用的是 IN 运算符，则与说：

```
(p.name = 'Joe' OR p.name = 'Jane' OR p.name = 'Bob' OR p.name = 'Alice') 
```

这些是查询必须考虑的每一行都必须检查的四个条件。当然，您引用的每个其他查询只有一个条件。我不相信在大多数实际场景中执行四个这样的查询会更快，因为您必须考虑您的客户读取结果集并对其进行处理所花费的时间。在这种情况下，IN 看起来很不错；如果它可以使用索引就更好了。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-20T01:24:07.983

像 IN 演示的那样简单的查询不应该有优化器选择使用索引的问题。Bill 提到的 UNION 工作只是在您有更复杂的查询时才偶尔需要。这可能是索引统计的问题。

您是否对有问题的桌子进行了分析？

表中有多少行，有多少行匹配 IN 子句？

EXPLAIN 对有问题的查询说了什么？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-19T23:29:19.350

您是在测量挂钟时间还是查询执行时间？我的猜测是，四个单独查询中的每一个的实际执行时间加起来可能少于执行 IN 查询的时间，但是四个查询的总挂钟时间会长得多。

这将有助于在名称列上建立索引。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-20T14:36:30.167

对我来说，因为 IN 子句可以释放数据库和表以供其他连接使用，并且使用它有应用程序结构的好处，所以 IN 子句是一个非常宝贵的工具，即使对单个查询有轻微的滞后。

在我构建的几乎每个 PHP/MySQL 应用程序中都使用了以下技术。

我在 IN 子句中经常使用数字键：

例如

抓取五个主项目，所有子项目可能是：

```
$master_arr = mysql_query(
 select * from master table where master_id in (1,7,9,10)
); 
```

然后：

```
$subitem_arr = mysql_query(
   select * from subitems table where par_master_id in (1,7,9,10)
); 
```

将子数组添加到主项：

```
foreach($subitem_arr AS $sv){
     $m_key = $sv['par_master_id'];
     $s_key = $sv['subitem_id'];
     $master_arr[$m_key]['subitem'][$s_key] = $sv;
} 
```

这做了两件事：1.）表不是通过连接一次全部保存 2.）只有两个 mysql 查询产生一棵数据树

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-03-24T15:35:37.403

如果先获取值然后将值嵌入到 in 子句中，而不是将 sql 查询嵌入到 sql 语句中，则可以使 in 子句更快

这是[使用 in 子句的示例](http://developer-tricks.com/use-php-to-make-sql-in-clause-execution-faster/)

# sql-server - 将 null 导出到 .csv

> ID：664406
> 
> 赞同：2
> 
> 时间：2009-03-19T23:10:36.820
> 
> 标签：sql-server, ssis

我在 sql server 2005 中使用导出数据向导。

我在许多字段中都有一个包含空值的表。我想在导出到 .csv 时保留这些字段，但它们被替换为空字符串。

我尝试更改向导中字段的“可为空”复选框，但这似乎没有任何作用。还尝试使用 " 作为分隔符，因为没有分隔符，NULL 将被解释为字符串。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-03-19T23:17:08.910

.csv 文件中没有 null 这样的东西。就像您说的那样， `null`, `"null"`or的值`""`都将被解释为字符串值。考虑更改您的源，以便将“ColumnXIsNull”值添加到导出的记录中。

# gcc - 为什么 gcc 会为局部变量而不是全局变量提供未使用变量的错误？

> ID：664414
> 
> 赞同：3
> 
> 时间：2009-03-19T23:14:45.343
> 
> 标签：gcc, global, local

我有一个关于 gcc 的问题。为什么当我在函数中本地定义变量时出现未使用变量的错误，但当变量在唯一文件中是全局时却没有？

我可以理解它可以用于其他人，但要做到这一点，我需要把外部词正确吗？

提前致谢。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-03-19T23:17:58.800

编译器无法知道是否使用了全局变量——例如，它可以从用完全不同的语言编写的编译单元中使用。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-03-19T23:20:49.073

如果“唯一文件中的全局”是指`"int x;"`在任何函数之外，则编译器的工作不是检测该变量，该变量需要对链接器可用，以防另一个编译单元需要它（例如 errno）。

如果您的意思`"static int x"`是链接器无法使用它，那么这可能只是 GCC 做出的选择。我认为编译器**不需要**通知这一点，除了在地址空间中浪费几个字节之外，它并没有真正的损害。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-03-19T23:18:07.457

因为全局变量可以在编译器不知道的任何其他地方使用。例如在外部库 o 程序上。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-03-19T23:18:16.023

未使用的局部变量可以由编译器确定。未使用的全局变量只能由链接器确定，因为它们可以在目标文件之间共享。

通常，链接器不会对代码生成发出警告。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-03-19T23:19:20.123

当变量是全局变量时，编译器对项目中的所有编译单元都没有完全可见性 - 可以在另一个编译单元中修改变量。链接器能够判断它未使用，可能会将其从目标文件中删除。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-03-19T23:18:12.573

因为如果它是全局的，它可以被稍后链接的另一个模块使用。

将所有全局变量定义在一个文件中是一种常见的习惯用法。该文件甚至可能没有任何代码，更不用说使用所有变量的代码了。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2011-02-28T11:33:05.367

我在android2.3中构建dalvikVM时遇到了同样的问题，我得到了重点。是因为编译器的参数太严格了：

**LOCAL_CFLAGS += -Werror**。

# cucumber - 如何访问 Cucumber 中的场景和示例名称？

> ID：664415
> 
> 赞同：9
> 
> 时间：2009-03-19T23:14:59.167
> 
> 标签：cucumber

我正在使用 cucumber 生成可以由工具或人类执行的测试脚本......所以不是标准用途。

但是，我想将场景和示例名称传递给我的输出。

这可能吗？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-03-21T12:18:47.260

找到了..（在蒂姆·沃克的帮助下）

```
Before do |scenario|
 puts "Before Scenario: #{scenario.to_sexp[2]}"
 .
 .
 .
end 
```

您的 SExpression 可能会有所不同，因此值得一试看看那`scenario.to_sexp.inspect`棵树是什么。

Aslak 热衷于避免在他的类上暴露属性（这是我碰巧同意的决定，所以我很乐意解决这个问题）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-20T06:26:14.510

一个更严肃的答案（或者至少是建议）：利用 ruby​​ 的反射来尝试找到你正在寻找的东西。抓住可能的对象，找出他们有什么方法，看看你能不能找到它。例如：

```
File.open('happy_hunting.log','a') { |f|
    f.print "Scenario supports: #{(scenario.methods - Object.methods).inspect}\n"
    } 
```

然后重复它以找出什么在哪里。

另一个建议，看源码。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-04-22T09:17:33.040

我做了一些草率的事情。由于我仅将此信息用于调试，因此现在可以使用，直到我找到更好的东西。

```
@Before
public void printTestInfoBeforeScenario(Scenario scenario) {
    LOGGER.info("Upcoming Test: "+scenario.getSourceTagNames());
}

@After
public void printTestInfoAfterScenario(Scenario scenario) {
    LOGGER.info("Test Complete: " + scenario.getSourceTagNames() + " Status: " + scenario.getStatus());
} 
```

# asp.net - 站点地图修剪不起作用

> ID：664421
> 
> 赞同：0
> 
> 时间：2009-03-19T23:16:54.137
> 
> 标签：asp.net, web-config, sitemap

我已经阅读了文章并进行了大量研究，但这让我很头疼，而且应该很容易。我希望它很容易修复。

我试图根据角色修剪我的站点地图，但是菜单控件永远不会改变。

**网站地图：**

```
<?xml version="1.0" encoding="utf-8" ?>  
<siteMap xmlns="http://schemas.microsoft.com/AspNet/SiteMap-File-1.0">  
    <siteMapNode url="#" title="Home" description="Home">  
        <siteMapNode url="~/default.aspx" title="Dashboard"  description="" roles="Administrator, Tech, Basic" />  
        <siteMapNode url="Referrel" title="Referral"  description="" roles="Administrator, Tech, Basic">  
            <siteMapNode url="referral-new.aspx" title="New"  description="" roles="Administrator, Tech" />        
            <siteMapNode url="referrals-all.aspx" title="All"  description="" roles="Administrator, Tech, Basic" />  
        </siteMapNode>  
        <siteMapNode url="~/reports/default.aspx" title="Reports" description="" roles="CEO" />  
    </siteMapNode>  
</siteMap> 
```

**网络配置：**

```
<?xml version="1.0"?>
<configuration>
  <configSections>
    <sectionGroup name="system.web.extensions" type="System.Web.Configuration.SystemWebExtensionsSectionGroup, System.Web.Extensions, Version=3.5.0.0, Culture=neutral, PublicKeyToken=31BF3856AD364E35">
      <sectionGroup name="scripting" type="System.Web.Configuration.ScriptingSectionGroup, System.Web.Extensions, Version=3.5.0.0, Culture=neutral, PublicKeyToken=31BF3856AD364E35">
        <section name="scriptResourceHandler" type="System.Web.Configuration.ScriptingScriptResourceHandlerSection, System.Web.Extensions, Version=3.5.0.0, Culture=neutral, PublicKeyToken=31BF3856AD364E35" requirePermission="false" allowDefinition="MachineToApplication"/>
        <sectionGroup name="webServices" type="System.Web.Configuration.ScriptingWebServicesSectionGroup, System.Web.Extensions, Version=3.5.0.0, Culture=neutral, PublicKeyToken=31BF3856AD364E35">
          <section name="jsonSerialization" type="System.Web.Configuration.ScriptingJsonSerializationSection, System.Web.Extensions, Version=3.5.0.0, Culture=neutral, PublicKeyToken=31BF3856AD364E35" requirePermission="false" allowDefinition="Everywhere"/>
          <section name="profileService" type="System.Web.Configuration.ScriptingProfileServiceSection, System.Web.Extensions, Version=3.5.0.0, Culture=neutral, PublicKeyToken=31BF3856AD364E35" requirePermission="false" allowDefinition="MachineToApplication"/>
          <section name="authenticationService" type="System.Web.Configuration.ScriptingAuthenticationServiceSection, System.Web.Extensions, Version=3.5.0.0, Culture=neutral, PublicKeyToken=31BF3856AD364E35" requirePermission="false" allowDefinition="MachineToApplication"/>
          <section name="roleService" type="System.Web.Configuration.ScriptingRoleServiceSection, System.Web.Extensions, Version=3.5.0.0, Culture=neutral, PublicKeyToken=31BF3856AD364E35" requirePermission="false" allowDefinition="MachineToApplication"/>
        </sectionGroup>
      </sectionGroup>
    </sectionGroup>

  </configSections>

  <appSettings>

    <add key="ChartImageHandler" value="storage=file;timeout=20;url=~/temp"/>
  </appSettings>
  <connectionStrings>
    <add name="ConnectionString" connectionString="Server=localhost;Database=;User ID=;Password=;" providerName="System.Data.SqlClient"/>
  </connectionStrings>
  <system.web>
    <!--
Set compilation debug="true" to insert debugging
symbols into the compiled page. Because this
affects performance, set this value to true only
during development.
-->
    <httpRuntime executionTimeout="90" maxRequestLength="20000" useFullyQualifiedRedirectUrl="false" requestLengthDiskThreshold="8192"/>
    <customErrors mode="Off"/>
    <compilation debug="true">
      <assemblies>
        <add assembly="System.Core, Version=3.5.0.0, Culture=neutral, PublicKeyToken=B77A5C561934E089"/>
        <add assembly="System.Data.DataSetExtensions, Version=3.5.0.0, Culture=neutral, PublicKeyToken=B77A5C561934E089"/>
        <add assembly="System.Web.Extensions, Version=3.5.0.0, Culture=neutral, PublicKeyToken=31BF3856AD364E35"/>
        <add assembly="System.Xml.Linq, Version=3.5.0.0, Culture=neutral, PublicKeyToken=B77A5C561934E089"/>
        <add assembly="System.Design, Version=2.0.0.0, Culture=neutral, PublicKeyToken=B03F5F7F11D50A3A"/>
        <add assembly="System.Web.Extensions, Version=1.0.61025.0, Culture=neutral, PublicKeyToken=31BF3856AD364E35"/>
        <add assembly="System.Web.Extensions.Design, Version=1.0.61025.0, Culture=neutral, PublicKeyToken=31BF3856AD364E35"/>
        <add assembly="System.Web.DataVisualization, Version=3.5.0.0, Culture=neutral, PublicKeyToken=31BF3856AD364E35"/>
        <add assembly="System.Windows.Forms, Version=2.0.0.0, Culture=neutral, PublicKeyToken=B77A5C561934E089"/>
      </assemblies>
    </compilation>
    <authentication mode="Forms">
      <forms loginUrl="Login.aspx" timeout="20" name="eReferral" requireSSL="false" defaultUrl="default.aspx"/>
    </authentication>
    <authorization>
      <deny users = "?"/>
    </authorization>
    <membership>
      <providers>
        <clear/>
        <add name="AspNetSqlMembershipProvider" connectionStringName="ConnectionString" applicationName="/" type="System.Web.Security.SqlMembershipProvider, System.Web, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a"/>
      </providers>
    </membership>
    <roleManager enabled="true">
      <providers>
        <clear/>
        <add name="AspNetSqlRoleProvider" connectionStringName="ConnectionString" applicationName="/" type="System.Web.Security.SqlRoleProvider, System.Web, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a"/>
      </providers>
    </roleManager>
    <siteMap defaultProvider="XmlSiteMapProvider" enabled="true">
      <providers>
        <add name="XmlSiteMapProvider" description="Default SiteMap provider." type="System.Web.XmlSiteMapProvider" siteMapFile="web.sitemap" securityTrimmingEnabled="true"/>
      </providers>
    </siteMap>

    <!--
The <customErrors> section enables configuration
of what to do if/when an unhandled error occurs
during the execution of a request. Specifically,
it enables developers to configure html error pages
to be displayed in place of a error stack trace.

<customErrors mode="RemoteOnly" defaultRedirect="GenericErrorPage.htm">
<error statusCode="403" redirect="NoAccess.htm" />
<error statusCode="404" redirect="FileNotFound.htm" />
</customErrors>
-->
    <pages theme="Clean">
      <controls>
        <add tagPrefix="asp" namespace="System.Web.UI" assembly="System.Web.Extensions, Version=3.5.0.0, Culture=neutral, PublicKeyToken=31BF3856AD364E35"/>
        <add tagPrefix="asp" namespace="System.Web.UI.WebControls" assembly="System.Web.Extensions, Version=3.5.0.0, Culture=neutral, PublicKeyToken=31BF3856AD364E35"/>
        <add tagPrefix="asp" namespace="System.Web.UI.DataVisualization.Charting" assembly="System.Web.DataVisualization, Version=3.5.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35"/>
      </controls>
    </pages>
    <httpHandlers>
      <remove path="*.asmx" verb="*"/>
      <add path="*.asmx" verb="*" type="System.Web.Script.Services.ScriptHandlerFactory, System.Web.Extensions, Version=3.5.0.0, Culture=neutral, PublicKeyToken=31BF3856AD364E35" validate="false"/>
      <add path="*_AppService.axd" verb="*" type="System.Web.Script.Services.ScriptHandlerFactory, System.Web.Extensions, Version=3.5.0.0, Culture=neutral, PublicKeyToken=31BF3856AD364E35" validate="false"/>
      <add path="ScriptResource.axd" verb="GET,HEAD" type="System.Web.Handlers.ScriptResourceHandler, System.Web.Extensions, Version=3.5.0.0, Culture=neutral, PublicKeyToken=31BF3856AD364E35" validate="false"/>
      <add path="BarcodeGen.axd" verb="*" type="Neodynamic.WebControls.BarcodeProfessional.BarcodeProfessional, Neodynamic.WebControls.BarcodeProfessional"/>
      <add path="ChartImg.axd" verb="GET,HEAD" type="System.Web.UI.DataVisualization.Charting.ChartHttpHandler, System.Web.DataVisualization, Version=3.5.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35" validate="false"/>
    </httpHandlers>
    <httpModules>
      <add name="ScriptModule" type="System.Web.Handlers.ScriptModule, System.Web.Extensions, Version=3.5.0.0, Culture=neutral, PublicKeyToken=31BF3856AD364E35"/>
    </httpModules>
  </system.web>

  <!-- This section gives the unauthenticated user access -->

  <location path="forgot-password.aspx">
    <system.web>
      <authorization>
        <allow users="*"/>
      </authorization>
    </system.web>
  </location>

  <!-- Referral Folder -->
  <location path="referral/referral-new.aspx">
    <system.web>
      <authorization>
        <allow roles="Tech"/>
        <deny users="?" />
      </authorization>
    </system.web>
  </location>
  <location path="referral/referral-details.aspx">
    <system.web>
      <authorization>
        <allow roles="Administrator, Basic, Tech, Physician"/>
        <deny users="?" />
      </authorization>
    </system.web>
  </location>
  <location path="referral/referral-new.aspx">
    <system.web>
      <authorization>
        <allow roles="Administrator, Basic, Tech, Physician"/>
        <deny users="?" />
      </authorization>
    </system.web>
  </location>

  <location path="Reports/default.aspx">
    <system.web>
      <authorization>
        <allow roles="CEO"/>
        <deny users="?" />
      </authorization>
    </system.web>
  </location>

  <system.codedom>
    <compilers>
      <compiler language="c#;cs;csharp" extension=".cs" warningLevel="4" type="Microsoft.CSharp.CSharpCodeProvider, System, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089">
        <providerOption name="CompilerVersion" value="v3.5"/>
        <providerOption name="WarnAsError" value="false"/>
      </compiler>
    </compilers>
  </system.codedom>
  <!--
The system.webServer section is required for running ASP.NET AJAX under Internet
Information Services 7.0\. It is not necessary for previous version of IIS.
-->
  <system.webServer>
    <validation validateIntegratedModeConfiguration="false"/>
    <modules>
      <remove name="ScriptModule"/>
      <add name="ScriptModule" preCondition="managedHandler" type="System.Web.Handlers.ScriptModule, System.Web.Extensions, Version=3.5.0.0, Culture=neutral, PublicKeyToken=31BF3856AD364E35"/>
    </modules>
    <handlers>
      <remove name="WebServiceHandlerFactory-Integrated"/>
      <remove name="ScriptHandlerFactory"/>
      <remove name="ScriptHandlerFactoryAppServices"/>
      <remove name="ScriptResource"/>
      <remove name="ChartImageHandler"/>
      <add name="ScriptHandlerFactory" verb="*" path="*.asmx" preCondition="integratedMode" type="System.Web.Script.Services.ScriptHandlerFactory, System.Web.Extensions, Version=3.5.0.0, Culture=neutral, PublicKeyToken=31BF3856AD364E35"/>
      <add name="ScriptHandlerFactoryAppServices" verb="*" path="*_AppService.axd" preCondition="integratedMode" type="System.Web.Script.Services.ScriptHandlerFactory, System.Web.Extensions, Version=3.5.0.0, Culture=neutral, PublicKeyToken=31BF3856AD364E35"/>
      <add name="ScriptResource" preCondition="integratedMode" verb="GET,HEAD" path="ScriptResource.axd" type="System.Web.Handlers.ScriptResourceHandler, System.Web.Extensions, Version=3.5.0.0, Culture=neutral, PublicKeyToken=31BF3856AD364E35"/>
      <add name="ChartImageHandler" preCondition="integratedMode" verb="GET,HEAD" path="ChartImg.axd" type="System.Web.UI.DataVisualization.Charting.ChartHttpHandler, System.Web.DataVisualization, Version=3.5.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35"/>
      <add name="BarcodeGen" path="BarcodeGen.axd" verb="*" type="Neodynamic.WebControls.BarcodeProfessional.BarcodeProfessional, Neodynamic.WebControls.BarcodeProfessional"/>
    </handlers>
  </system.webServer>
  <runtime>
    <assemblyBinding xmlns="urn:schemas-microsoft-com:asm.v1">
      <dependentAssembly>
        <assemblyIdentity name="System.Web.Extensions" publicKeyToken="31bf3856ad364e35"/>
        <bindingRedirect oldVersion="1.0.0.0-1.1.0.0" newVersion="3.5.0.0"/>
      </dependentAssembly>
      <dependentAssembly>
        <assemblyIdentity name="System.Web.Extensions.Design" publicKeyToken="31bf3856ad364e35"/>
        <bindingRedirect oldVersion="1.0.0.0-1.1.0.0" newVersion="3.5.0.0"/>
      </dependentAssembly>
    </assemblyBinding>
  </runtime>
  <system.net>
    <settings>
      <httpWebRequest useUnsafeHeaderParsing="true"/>
    </settings>
  </system.net>
</configuration> 
```

可能是什么问题呢？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-19T23:23:53.590

您为什么不尝试将其也放入站点地图中：

```
<?xml version="1.0" encoding="utf-8" ?> 
```

```
 <siteMapNode url="" title="Secciones"  description="" roles="Admin,Users">
    <siteMapNode url="~/p_Site/Cursos.aspx" title="Cursos"  description="Information" />
    <siteMapNode url="~/p_Site/Precios.aspx" title="Prices"  description="All the Prices" />
  </siteMapNode>

  <siteMapNode url="" title="Administration"  description="" roles="Admin">
    <siteMapNode url="~/p_Admin/Alumnos.aspx" title="Debt List"/>
    <siteMapNode url="~/p_Admin/Pagos.aspx" title="Pay List"  description="" />
  </siteMapNode>

</siteMapNode> 
```

我已经指定了 site.map 的每个部分所允许的角色，再加上你拥有的 Web.Config 条目，应该可以工作；）

最好的祝福！！！

C

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-20T21:13:46.820

我有同样的问题，解决方案：在我的情况下，我没有提供外部 siteMapNode 角色:)

```
<siteMapNode roles ="admin"> this is outer 
<siteMapNode roles ="admin" /> inner
<siteMapNode roles ="admin"/> inner
</siteMapNode> 
```

# java - 如何以编程方式更改文件权限？

> ID：664432
> 
> 赞同：140
> 
> 时间：2009-03-19T23:21:21.833
> 
> 标签：java, filesystems

在 Java 中，我正在动态创建一组文件，并且我想在 linux/unix 文件系统上更改这些文件的文件权限。我希望能够执行 Java 等效的`chmod`. 那可能是Java 5吗？如果是这样，怎么做？

我知道在 Java 6 中`File`对象有`setReadable()`/`setWritable()`方法。我也知道我可以进行系统调用来执行此操作，但如果可能的话，我想避免这种情况。

* * *

## 回答 #1

> 赞同：128
> 
> 时间：2009-03-19T23:24:45.990

作为“新”新 IO 工具 ( [NIO.2](http://jcp.org/en/jsr/detail?id=203) ) 的一部分，Java 7 提供了对文件属性的完全控制。例如，可以使用 POSIX 权限在现有文件上设置[`setPosixFilePermissions()`，](http://docs.oracle.com/javase/7/docs/api/java/nio/file/Files.html#setPosixFilePermissions%28java.nio.file.Path,%20java.util.Set%29)[`createFile()`](https://docs.oracle.com/javase/7/docs/api/java/nio/file/Files.html#createFile(java.nio.file.Path,%20java.nio.file.attribute.FileAttribute...))或者在创建文件时使用或等方法以原子方式设置[`newByteChannel()`。](https://docs.oracle.com/javase/7/docs/api/java/nio/file/Files.html#newByteChannel(java.nio.file.Path,%20java.util.Set,%20java.nio.file.attribute.FileAttribute...))

您可以使用 创建一组权限`EnumSet.of()`，但辅助方法[`PosixFilePermissions.fromString()`](https://docs.oracle.com/javase/7/docs/api/java/nio/file/attribute/PosixFilePermissions.html#fromString(java.lang.String))将使用对许多开发人员来说更具可读性的常规格式。对于接受 a 的 API `FileAttribute`，您可以使用 with 包装权限集[`PosixFilePermissions.asFileAttribute()`。](https://docs.oracle.com/javase/7/docs/api/java/nio/file/attribute/PosixFilePermissions.html#asFileAttribute(java.util.Set))

```
Set<PosixFilePermission> ownerWritable = PosixFilePermissions.fromString("rw-r--r--");
FileAttribute<?> permissions = PosixFilePermissions.asFileAttribute(ownerWritable);
Files.createFile(path, permissions); 
```

在早期版本的 Java 中，使用您自己的本机代码或`exec`-ing 命令行实用程序是常见的方法。

* * *

## 回答 #2

> 赞同：45
> 
> 时间：2009-03-19T23:30:45.290

除了 erickson 的建议之外，还有[jna](https://github.com/twall/jna/)，它可以让你在不使用 jni 的情况下调用原生库。它使用起来非常简单，我已经在几个项目中使用它并取得了巨大的成功。

唯一需要注意的是它比 jni 慢，所以如果你对大量文件执行此操作，这可能对你来说是个问题。

（编辑添加示例）

这是一个完整的 jna chmod 示例：

```
import com.sun.jna.Library;
import com.sun.jna.Native;

public class Main {
    private static CLibrary libc = (CLibrary) Native.loadLibrary("c", CLibrary.class);

    public static void main(String[] args) {
        libc.chmod("/path/to/file", 0755);
    }
}

interface CLibrary extends Library {
    public int chmod(String path, int mode);
} 
```

* * *

## 回答 #3

> 赞同：43
> 
> 时间：2015-09-01T12:18:13.217

在 Java 6 之前，Java 级别不支持文件权限更新。您必须实现自己的本机方法或调用`Runtime.exec()`以执行操作系统级别的命令，例如**chmod**。

从 Java 6 开始，您可以使用`File.setReadable()/File.setWritable()/File.setExecutable()`来设置文件权限。但它不模拟允许为不同用户设置权限的 POSIX 文件系统。File.setXXX() 只允许为所有者和其他所有人设置权限。

从 Java 7 开始，引入了 POSIX 文件权限。您可以像在 *nix 系统上所做的那样设置文件权限。语法是：

```
File file = new File("file4.txt");
file.createNewFile();

Set<PosixFilePermission> perms = new HashSet<>();
perms.add(PosixFilePermission.OWNER_READ);
perms.add(PosixFilePermission.OWNER_WRITE);

Files.setPosixFilePermissions(file.toPath(), perms); 
```

此方法只能在 POSIX 文件系统上使用，这意味着您不能在 Windows 系统上调用它。

有关文件权限管理的详细信息，建议您阅读[这篇文章](http://www.pixelstech.net/article/1440837434-Set-file-permission-in-Java)。

* * *

## 回答 #4

> 赞同：20
> 
> 时间：2012-12-15T14:10:24.843

对于带有 NIO 2 的 Windows 7：

```
public static void main(String[] args) throws IOException {
    Path file = Paths.get("c:/touch.txt");
    AclFileAttributeView aclAttr = Files.getFileAttributeView(file, AclFileAttributeView.class);
    System.out.println(aclAttr.getOwner());
    for (AclEntry aclEntry : aclAttr.getAcl()) {
        System.out.println(aclEntry);
    }
    System.out.println();

    UserPrincipalLookupService upls = file.getFileSystem().getUserPrincipalLookupService();
    UserPrincipal user = upls.lookupPrincipalByName(System.getProperty("user.name"));
    AclEntry.Builder builder = AclEntry.newBuilder();       
    builder.setPermissions( EnumSet.of(AclEntryPermission.READ_DATA, AclEntryPermission.EXECUTE, 
            AclEntryPermission.READ_ACL, AclEntryPermission.READ_ATTRIBUTES, AclEntryPermission.READ_NAMED_ATTRS,
            AclEntryPermission.WRITE_ACL, AclEntryPermission.DELETE
    ));
    builder.setPrincipal(user);
    builder.setType(AclEntryType.ALLOW);
    aclAttr.setAcl(Collections.singletonList(builder.build()));
} 
```

* * *

## 回答 #5

> 赞同：12
> 
> 时间：2017-03-29T10:18:25.980

如果要为创建的文件设置 777 权限，则可以使用以下方法：

```
public void setPermission(File file) throws IOException{
    Set<PosixFilePermission> perms = new HashSet<>();
    perms.add(PosixFilePermission.OWNER_READ);
    perms.add(PosixFilePermission.OWNER_WRITE);
    perms.add(PosixFilePermission.OWNER_EXECUTE);

    perms.add(PosixFilePermission.OTHERS_READ);
    perms.add(PosixFilePermission.OTHERS_WRITE);
    perms.add(PosixFilePermission.OTHERS_EXECUTE);

    perms.add(PosixFilePermission.GROUP_READ);
    perms.add(PosixFilePermission.GROUP_WRITE);
    perms.add(PosixFilePermission.GROUP_EXECUTE);

    Files.setPosixFilePermissions(file.toPath(), perms);
} 
```

* * *

## 回答 #6

> 赞同：12
> 
> 时间：2019-04-11T03:22:00.230

只是为了更新这个答案，除非以后有人遇到这个问题，因为你可以使用 JDK 6

```
File file = new File('/directory/to/file');
file.setWritable(boolean);
file.setReadable(boolean);
file.setExecutable(boolean); 
```

您可以在 Oracle [File(Java Platform SE 7)](https://docs.oracle.com/javase/7/docs/api/java/io/File.html)上找到文档。请记住，这些命令仅在当前工作用户拥有该文件的所有权或写入权限时才有效。我知道 OP 想要 chmod 类型访问以进行更复杂的用户配置。这些将为所有用户全面设置选项。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2011-09-26T06:23:15.203

您可以使用 File 类的方法：http: [//docs.oracle.com/javase/7/docs/api/java/io/File.html](http://docs.oracle.com/javase/7/docs/api/java/io/File.html)

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2013-12-15T08:18:36.633

与@msorsky 共享的 Apache ant chmod（不是很优雅，添加它是为了完整性）

```
 Chmod chmod = new Chmod();
    chmod.setProject(new Project());
    FileSet mySet = new FileSet();
    mySet.setDir(new File("/my/path"));
    mySet.setIncludes("**");
    chmod.addFileset(mySet);
    chmod.setPerm("+w");
    chmod.setType(new FileDirBoth());
    chmod.execute(); 
```

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2013-03-31T18:00:59.507

对于 Oralce Java 6：

```
private static int chmod(String filename, int mode) {
    try {
        Class<?> fspClass = Class.forName("java.util.prefs.FileSystemPreferences");
        Method chmodMethod = fspClass.getDeclaredMethod("chmod", String.class, Integer.TYPE);
        chmodMethod.setAccessible(true);
        return (Integer)chmodMethod.invoke(null, filename, mode);
    } catch (Throwable ex) {
        return -1;
    }
} 
```

在 solaris/linux 下工作。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2015-09-16T08:51:15.973

[Oracle Docs 上](https://docs.oracle.com/javase/tutorial/essential/io/examples/Chmod.java)有一个示例类，其工作方式与 UNIX chmod 非常相似。它适用于java se 7+。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2015-11-19T17:06:11.813

```
simple java code  for change file permission in java  

   String path="D:\\file\\read.txt";
        File file=new File(path);
        if (file.exists()) {
            System.out.println("read="+file.canRead());
            System.out.println("write="+file.canWrite());
            System.out.println("Execute="+file.canExecute());
            file.setReadOnly();
        } 
```

参考：[如何在java中更改文件权限](http://www.javavogue.com/2015/02/how-to-change-file-permission-using-java.html)

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2020-08-03T20:00:14.697

```
import java.io.File;
import java.io.IOException;
import java.nio.file.Files;
import java.nio.file.Path;
import java.nio.file.Paths;
import java.nio.file.attribute.FileAttribute;
import java.nio.file.attribute.PosixFileAttributes;
import java.nio.file.attribute.PosixFilePermission;
import java.nio.file.attribute.PosixFilePermissions;
import java.util.Set;

public class FileAndDirectory1 {
    public static void main(String[] args) {

        File file = new File("fileTest1.txt");
        System.out.println(file.getAbsoluteFile());
        try {
            //file.createNewFile();
            if(!file.exists())
            {
                //PosixFilePermission is an enum class, PosixFilePermissions is a final class

                //create file permissions from string
                Set<PosixFilePermission> filePermissions = PosixFilePermissions.fromString("---------"/* "rwxrwxrwx" */);
                FileAttribute<?> permissions = PosixFilePermissions.asFileAttribute(filePermissions);
                Files.createFile(file.toPath(), permissions);
                // printing the permissions associated with the file
                System.out.println("Executable: " + file.canExecute());
                System.out.println("Readable: " + file.canRead());
                System.out.println("Writable: "+ file.canWrite());

                file.setExecutable(true);
                file.setReadable(true);
                file.setWritable(true);
            }
            else
            {
                //modify permissions

                //get the permission using file attributes
                Set<PosixFilePermission> perms = Files.readAttributes(file.toPath(), PosixFileAttributes.class).permissions();
                perms.remove(PosixFilePermission.OWNER_WRITE);

                perms.add(PosixFilePermission.OWNER_READ);
                perms.add(PosixFilePermission.OWNER_EXECUTE);
                perms.add(PosixFilePermission.GROUP_WRITE);
                perms.add(PosixFilePermission.GROUP_READ);
                perms.add(PosixFilePermission.GROUP_EXECUTE);
                perms.add(PosixFilePermission.OTHERS_WRITE);
                perms.add(PosixFilePermission.OTHERS_READ);
                perms.add(PosixFilePermission.OTHERS_EXECUTE);
                Files.setPosixFilePermissions(file.toPath(), perms);

                System.out.println("Executable: " + file.canExecute());
                System.out.println("Readable: " + file.canRead());
                System.out.println("Writable: "+ file.canWrite());

                file.delete();
            }
        } catch (IOException e) {
            e.printStackTrace();
        }
        Path path = Paths.get(String.valueOf(file));
        System.out.println(path);
    }
} 
```

# ruby - Ruby 中的符号表与其他语言中的符号表有什么不同

> ID：664433
> 
> 赞同：2
> 
> 时间：2009-03-19T23:22:45.277
> 
> 标签：ruby, symbol-tables

符号表上的维基百科条目是一个很好的参考：

[http://en.wikipedia.org/wiki/Symbol_table](http://en.wikipedia.org/wiki/Symbol_table)

但是当我尝试理解 Ruby 中的符号以及它们在符号数组中的表示方式（由`Symbol.all_symbols`方法返回）时，

我想知道 Ruby 的符号表方法与其他语言是否有任何重要区别？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-03-19T23:34:04.503

从这个意义上说，Ruby 并没有真正的“符号表”。它有绑定和符号（lispers 称之为[atom](http://en.wikipedia.org/wiki/Lisp_(programming_language)#Atoms)），但它并没有真正按照文章描述的方式进行操作。

因此，在回答您的问题时：ruby 并没有以不同的方式完成相同的事情，而是它做了两个不同的事情（`:xxx`符号-> 范围内的唯一 ID 和绑定）并为它们使用相似/重叠的术语.

澄清：

您链接到的文章给出了符号表的常规定义，即

> 其中程序源代码中的每个标识符都与与其在源代码中的声明或外观相关的信息相关联，例如它的类型、范围级别，有时还有它的位置

但这不是 ruby​​ 的符号表所做的。它只是为特定类别的对象提供全局唯一标识，这些对象可以像`:something`在源代码中一样编写，包括诸如标识符之类的东西`:+`和`:"Hi bob!"`不是标识符的东西。此外，仅使用标识符不会创建相应的符号。最后，以上段落中列出的信息都没有存储在 ruby​​ 的符号列表中。

这是命名的巧合，阅读那篇文章不会帮助您理解红宝石的符号。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-20T00:00:43.690

最大的不同是（像 Lisp 一样）Ruby 实际上有符号语法，而且很容易在运行时自己添加/删除东西。如果你说：balloon（或“balloon”.intern）它会为你实习。即使您在源代码中按名称引用它，但在内部它只是符号表中的一个指针。如果你比较符号，它只是一个指针比较，而不是字符串比较。

像 C 这样的语言并没有办法在运行时简单地说“为我创建一个新符号”。您可以通过定义一个函数在编译时隐式执行它，但这实际上是它的唯一用途。由于 C 语言没有符号语法，如果您想在程序中说出 Balloon，但又想将其与单个机器指令进行比较，您可以使用枚举（或 #defines）。

在 Ruby 中，一个符号只需要一个字符，所以你可以用它来做各种事情（比如哈希键）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-20T00:43:24.820

Ruby 中的符号用于其他语言倾向于使用枚举、定义、常量等的地方。它们也经常用于关联键。它们的使用与那篇文章中讨论的符号表几乎没有关系，除了它们显然存在于一个中。

# c# - 如何以更清洁的方式处理大型工厂

> ID：664440
> 
> 赞同：3
> 
> 时间：2009-03-19T23:24:04.777
> 
> 标签：c#, design-patterns, oop, factory

我的开发团队遇到了设计问题。我希望有人可以帮我清理一下架构的这一部分。

在我的系统中，我有一个包含 250 个成员的枚举 [一个成员代表一个不同的下拉列表]。为了在任何给定窗口上填充下拉列表，该表单发送与所需下拉列表相关的枚举成员，并返回下拉信息。

换句话说，例如，我们有 3 个窗口。窗口 A 有下拉 X、Y 和 Z。窗口 B 有下拉 W、X 和 Y，窗口 C 有下拉 T、U 和 W。我的 DropDownType 枚举将由 T、U、W、X、Y、Y 组成和 Z。因此，对于指定的窗口，给定该窗口上的下拉菜单，我查询要出现在这些下拉菜单中的数据。

这是一个简化的示例，因为我的应用程序包含超过 250 个不同的下拉菜单。

你可以想象，我有一个工厂设置来返回每个下拉菜单的数据。每个请求的下拉菜单都会调用这个工厂。

```
 switch (dropDownType)
    {
        case DropDownType.T:
            return (from t in dataContext.GetTable<TableOne>() 
                    select new DropDownDto 
                               { 
                                   DropDownDisplayName = t.ColumnA,
                                   DropDownValue = t.ColumnB
                               }).ToList();
        case DropDownType.U:
            return (from u in dataContext.GetTable<TableTwo>() 
                    select new DropDownDto 
                               { 
                                   DropDownDisplayName = u.ColumnC,
                                   DropDownValue = u.ColumnD
                               }).ToList();
        // etc...
    } 
```

由于我在这个枚举中有这么多成员，有没有人知道一种更优雅的编码方式？您认为将其转换为工厂方法会有所帮助吗（但是我们不得不担心源代码中有 250 个单独的文件......）？还有另一种更有用的模式吗？仅仅拥有这个巨大的 switch 语句就变得难以管理。

任何帮助是极大的赞赏。提前致谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-19T23:36:20.253

您可以创建一个`Dictionary<DropDownType, DropDownDtoDelegate>`每个条目，其中包含一个枚举条目作为键和一个委托来检索下拉数据作为值。这将允许您将返回下拉列表的每个方法保持在巨大的 switch 语句之外。然后，您将有一种方法来检索委托、执行委托并返回下拉列表数据。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-19T23:38:42.477

这些问题有一些解决方案。

1.  您可以使用字典从下拉列表映射到您的数据。

2.  您甚至可以考虑将此映射数据移动到数据库中。数据量可能证明这个决定是正确的。

3.  要删除枚举形式的附加键，请考虑使用下拉列表的名称作为键。

这是一个非常好的博客，处理相关问题并提出类似的解决方案。

[回归基础 - If、For 和 Switch 之后的生活 - 就像，数据结构提醒](http://www.hanselman.com/blog/BackToBasicsLifeAfterIfForAndSwitchLikeADataStructuresReminder.aspx)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-19T23:43:00.487

一种选择可能是使用反射来处理枚举值。如果您对所涉及的所有类都有一致的命名标准，则可能有一种方法可以动态生成要查询的表/集合的名称和要返回的 DTO 的名称。它需要一些“开销”代码才能使其工作，但一旦你这样做，它可能适用于所有不同的表。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-20T05:27:00.253

我将使用 DynamicMethod 在运行时为枚举中的每个项目生成代码。这应该缓存在字典中，并按需生成。

使用属性，您可以设置每个枚举上使用的实体，以及所需的这 2 个属性。

我可以想象这样的事情。

```
enum DropDownType
{
   [Configuration(Type = typeof(TableOne), DisplayNameProperty = "ColumnA", ValueProperty = "ColumnB")]
   T,

   [Configuration(Type = typeof(TableTwo), DisplayNameProperty = "ColumnC", ValueProperty = "ColumnD")]
   U
} 
```

当你有一个枚举值时，你检查缓存方法的字典，如果不存在，你生成它。

使用反射您可以获得这些属性信息，并且通过一些 IL 技能，这可以轻松完成。

# c# - 增加存储库实例范围的优点/缺点？

> ID：664441
> 
> 赞同：0
> 
> 时间：2009-03-19T23:24:28.863
> 
> 标签：c#, asp.net, performance

这个问题的标题写得不是很好。对不起。

我很好奇将方法中的对象实例的范围扩大到类级别的优点或缺点。

作为一个具体的例子，我有一个非静态服务类，它封装了对存储库类的访问，该存储库类用于管理 CRUD 活动以及一些不一定与其他业务逻辑很好地混合的其他任务。在我构建它时，每个方法都会创建它自己的存储库实例。假设平均流量（不大），我想知道在服务类的构造函数中创建此存储库的类级别实例是否有任何好处，而不是我目前使用的方法级别范围。此应用程序当前未使用 DI，尽管这可能是一个选项。我也在考虑将课程设为静态，但在此之前我还有其他一些障碍需要克服。

提前致谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-19T23:41:27.400

你的代码甚至还不能工作，你已经在优化了。停止！让您的代码工作，然后分析性能并针对您*实际*遇到的性能问题进行优化，而不是您认为可能会遇到的问题。

不要猜错并解决错误的问题，否则会使事情变得更糟！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-20T00:20:48.897

+1[约翰桑德斯](https://stackoverflow.com/questions/664441/pros-cons-to-increasing-the-scope-of-a-repository-instance/664470#664470)

除此之外，让我评论一下：

> 我想知道在服务类的构造函数中创建此存储库的类级别实例是否有任何好处，而不是我当前使用的方法级别范围

创建存储库类是否昂贵？我所说的“昂贵”是指有一个分析器向您展示它对您的应用程序的运行时间做出了显着的贡献。

如果是这样，您可能希望将其缓存在实例变量中。如果没有，请将其保留在本地。一旦将其提升为实例变量，就会给自己带来许多问题，例如

*   谁先创造它？
*   当 2 个线程访问同一个实例时会发生什么？
*   谁清理它？有没有人？（该`using`语句不再是一种选择）
*   这是否意味着您需要为您的课程编写终结器？（啊）
*   如果它需要参数来创建它，谁提供它们？
*   如果需要在方法调用之间更改或重新创建它会发生什么？

旧的“全局变量是邪恶的”引用是恕我直言，只是“共享状态是邪恶的”最常见的情况，这是实际问题。

# python - 如何恢复损坏的 python“cPickle”转储？

> ID：664444
> 
> 赞同：3
> 
> 时间：2009-03-19T23:25:03.977
> 
> 标签：python, rss, pickle

我正在使用`rss2email`将一些 RSS 提要转换为邮件以便于使用。也就是说，我使用它*是*因为它今天以一种可怕的方式坏了：每次运行时，它只给我这个回溯：

```
Traceback (most recent call last):
  File "/usr/share/rss2email/rss2email.py", line 740, in <module>
    elif action == "list": list()
  File "/usr/share/rss2email/rss2email.py", line 681, in list
    feeds, feedfileObject = load(lock=0)
  File "/usr/share/rss2email/rss2email.py", line 422, in load
    feeds = pickle.load(feedfileObject)
TypeError: ("'str' object is not callable", 'sxOYAAuyzSx0WqN3BVPjE+6pgPU', ((2009, 3, 19, 1, 19, 31, 3, 78, 0), {})) 
```

我能够从这个回溯中构建的唯一有用的事实是，保存其所有配置和运行时状态的文件以某种方式损坏`~/.rss2email/feeds.dat`。`rss2email`显然，`rss2email`读取它的状态并`cPickle`在每次运行时将其转储回去。

我什`'sxOYAAuyzSx0WqN3BVPjE+6pgPU'`至在巨型 (>12MB)`feeds.dat`文件中找到了包含上述字符串的行。在我未经训练的眼睛看来，转储似乎没有被截断或以其他方式损坏。

我可以尝试什么方法来重建文件？

Python 版本在 Debian/unstable 系统上为 2.5.4。

**编辑**

Peter Gibson 和 JF Sebastian 建议直接从 pickle 文件加载，我之前尝试过。显然，需要一个`Feed`在 中定义的类`rss2email.py`，所以这是我的脚本：

```
#!/usr/bin/python

import sys
# import pickle
import cPickle as pickle
sys.path.insert(0,"/usr/share/rss2email")
from rss2email import Feed

feedfile = open("feeds.dat", 'rb')
feeds = pickle.load(feedfile) 
```

“普通”泡菜变体产生以下回溯：

```
Traceback (most recent call last):
  File "./r2e-rescue.py", line 8, in <module>
    feeds = pickle.load(feedfile)
  File "/usr/lib/python2.5/pickle.py", line 1370, in load
    return Unpickler(file).load()
  File "/usr/lib/python2.5/pickle.py", line 858, in load
    dispatch[key](self)
  File "/usr/lib/python2.5/pickle.py", line 1133, in load_reduce
    value = func(*args)
TypeError: 'str' object is not callable 
```

该变体产生与调用自身`cPickle`基本相同的东西 ：`r2e`

```
Traceback (most recent call last):
  File "./r2e-rescue.py", line 10, in <module>
    feeds = pickle.load(feedfile)
TypeError: ("'str' object is not callable", 'sxOYAAuyzSx0WqN3BVPjE+6pgPU', ((2009, 3, 19, 1, 19, 31, 3, 78, 0), {})) 
```

**编辑 2**

按照 JF Sebastian 的建议，将“printf 调试”放入`Feed.__setstate__`我的测试脚本中，这些是 Python 退出前的最后几行。

```
 u'http:/com/news.ars/post/20080924-everyone-declares-victory-in-smutfree-wireless-broadband-test.html': u'http:/com/news.ars/post/20080924-everyone-declares-victory-in-smutfree-wireless-broadband-test.html'},
 'to': None,
 'url': 'http://arstechnica.com/'}
Traceback (most recent call last):
  File "./r2e-rescue.py", line 23, in ?
    feeds = pickle.load(feedfile)
TypeError: ("'str' object is not callable", 'sxOYAAuyzSx0WqN3BVPjE+6pgPU', ((2009, 3, 19, 1, 19, 31, 3, 78, 0), {})) 
```

同样的事情发生在使用 python 2.4.4-2 的 Debian/etch 盒子上。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-04-05T18:49:16.087

# 我如何解决我的问题

## Perl 端口`pickle.py`

在 JF Sebastian 关于`pickle` 格式简单的评论之后，我开始将部分内容移植`pickle.py`到 Perl。几个快速的正则表达式本来是访问我的数据的一种更快的方法，但我觉得 hack 的价值和学习更多关于 Python 的机会是值得的。另外，我仍然觉得使用 Perl（和调试代码）比使用 Python 更舒服。

大多数移植工作（简单类型、元组、列表、字典）都非常简单。到目前为止，Perl 和 Python 的类和对象的不同概念是唯一需要不仅仅是简单翻译成语的问题。结果是一个名为的模块`Pickle::Parse`，经过一些改进后将在 CPAN 上发布。

在 CPAN 上存在一个名为的模块`Python::Serialise::Pickle`，但我发现它缺乏解析能力：它会到处喷出调试输出，而且似乎不支持类/对象。

## 解析、转换数据、检测流中的实际错误

基于`Pickle::Parse`，我尝试解析`feeds.dat`文件。在我的解析代码中修复了一些微不足道的错误之后，我收到了一条错误消息，该错误消息与`pickle.py`'s original *object not callable*错误消息惊人地相似：

```
Can't use string ("sxOYAAuyzSx0WqN3BVPjE+6pgPU") as a subroutine
ref while "strict refs" in use at lib/Pickle/Parse.pm line 489,
<STDIN> line 187102. 
```

哈！现在我们处于实际数据流很可能被破坏的地步。另外，我们知道它*在哪里*坏了。

原来下面这个序列的第一行是错误的：

```
g7724
((I2009
I3
I19
I1
I19
I31
I3
I78
I0
t(dtRp62457 
```

“备忘录”中的位置 7724 指向该字符串 `"sxOYAAuyzSx0WqN3BVPjE+6pgPU"`。从流早期的类似记录中，很明显需要一个`time.struct_time`对象。后来的所有记录都共享了这个错误的指针。通过简单的搜索/替换操作，解决这个问题很简单。

我发现具有讽刺意味的是，我通过 Perl 的功能意外找到了错误的根源，该功能告诉用户它在输入数据流中的位置，当它死了。

## 结论

1.  `rss2email`一旦我有时间将其腌制配置/状态混乱自动转换为另一种工具的格式，我就会离开。
2.  `pickle.py`需要更有意义的错误消息来告诉用户数据流的位置（而不是它自己的代码中的位置）哪里出错了。
3.  将部件移植`pickle.py`到 Perl 很有趣，而且最终也很有收获。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-20T00:40:19.880

您是否尝试过使用 cPickle 和 pickle 手动加载 feeds.dat 文件？如果输出不同，则可能暗示错误。

类似于（来自您的主目录）：

```
import cPickle, pickle
f = open('.rss2email/feeds.dat', 'r')
obj1 = cPickle.load(f)
obj2 = pickle.load(f) 
```

（如果 rss2email 没有在 ascii 中腌制，您可能需要以二进制模式“rb”打开）。

皮特

编辑： cPickle 和 pickle 给出相同错误的事实表明 feeds.dat 文件是问题所在。正如 Ubuntu bug JF Sebastian 链接中所建议的那样，可能是 rss2email 版本之间的 Feed 类发生了变化。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-20T00:46:26.030

听起来 cPickle 的内部结构变得复杂起来。该线程（[http://bytes.com/groups/python/565085-cpickle-problems](http://bytes.com/groups/python/565085-cpickle-problems)）看起来可能有线索..

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-03-20T01:01:15.977

1.  `'sxOYAAuyzSx0WqN3BVPjE+6pgPU'`很可能与泡菜的问题无关
2.  发布错误回溯（以确定哪个类定义了无法调用的属性（导致 TypeError 的属性）：

    ```
    python -c "import pickle; pickle.load(open('feeds.dat'))" 
    ```

**编辑：**

将以下内容添加到您的代码中并运行（将 stderr 重定向到文件，然后`'tail -2'`在其上使用以打印最后 2 行）：

```
from pprint import pprint
def setstate(self, dict_):
    pprint(dict_, stream=sys.stderr, depth=None)
    self.__dict__.update(dict_)
Feed.__setstate__ = setstate 
```

如果上面没有产生有趣的输出，那么使用一般的故障排除策略：

确认`'feeds.dat'`是问题所在：

*   备份`~/.rss2email`目录
*   将 rss2email 安装到 virtualenv/pip 沙箱中（或使用 zc.buildout）以隔离环境（确保您使用的是来自主干的 feedparser.py）。
*   添加几个提要，添加提要直到`'feeds.dat'`大小大于当前大小。运行一些测试。
*   尝试旧的“feeds.dat”
*   在现有的 rss2email 安装上尝试新的“feeds.dat”

请参阅[r2e](https://bugs.launchpad.net/ubuntu/+source/rss2email/+bug/244953)在 Ubuntu 上出现 TypeError 错误。

# asp.net - Asp.Net WebForms 上的 MVP

> ID：664446
> 
> 赞同：4
> 
> 时间：2009-03-19T23:27:33.270
> 
> 标签：asp.net, design-patterns, gridview, mvp

这个我不是很清楚......

当在视图上有一个网格视图时，控制器是否必须设置数据源、列等？或者我只需要公开 DataBinding 的东西，从控制器触发它，让视图上的 html/codebehind 处理所有的渲染和连接？

更准确地说：关于我应该有的观点

```
private GridView _gv
public _IList<Poco> Source { 
    get {_gv.DataSource;}
    set {_gv.DataSource = value;
         _gv.DataBind();}
} 
```

或者应该是（来自[MVP 模式 - Passive View 并通过 IView (Asp.Net, Web Forms) 公开复杂类型](https://stackoverflow.com/questions/153222/mvp-pattern-passive-view-and-exposing-complex-types-through-iview-asp-net-web)）

```
private GridView _datasource;
public DataSource 
{
  get { return _datasource; }
  set 
  { 
    _datasource = value; 
    _datasource.DataBind(); 
  }
} 
```

也许我完全错了......

我在哪里可以找到一个不是 ASP.Net MVP 的“Hello world”示例的示例？？？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-20T03:44:02.793

您的控制器应该负责设置数据绑定的“结果”。视图负责正确显示它。

例如，您的 webform/usercontrol (View) 可以将数据源公开为对象属性，您的 View 在收到它时应该知道如何处理：

```
public MyObject DataSource 
{
  set 
  { 
    _datasource = value; 
    _datasource.DataBind(); 
  } 
} 
```

所以如果你需要一个 ItemDataBound 事件，我仍然会在视图中处理它。即使事件中可能存在业务逻辑。如果您需要在事件中包含业务逻辑，我会将其放入 MyObject 结果中，然后再将其传递给视图。

因此，一个示例是将“MyObject”的属性设置为“AllowDelete”，并且在您的 ItemDataBound 中，此属性的值确定是否启用了 GridView 中的列。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2010-03-13T12:38:05.007

刚刚听了最近关于这个主题的 Hanselminutes，可能值得看看[http://webformsmvp.com/](http://webformsmvp.com/)项目，它似乎给 WebForms 中的关注点分离带来了一些僵化。

# .net - 数据驱动的状态机应用

> ID：664460
> 
> 赞同：3
> 
> 时间：2009-03-19T23:34:12.833
> 
> 标签：.net, workflow, state-machine, data-driven

我们目前正在开发一个“数据驱动”的状态机应用程序。目前，状态流都在数据库中配置，但在我们当前的设计中，没有任何决策/业务逻辑可以在数据库中配置。正因为如此，代码也必须基本上“知道”状态流，所以在数据库中配置流真的没有意义。

我想到了一个设计，它允许我们使用依赖注入（Spring.NET）将状态模式连接在一起，但我不确定使这种数据驱动的最佳方法。我不是在数据库中配置类似代码的东西（如类或方法名称）的忠实粉丝，但我想到的设计需要我们在数据库中连接应用程序（类似于在 Spring XML 中的连接文件），所以这看起来很糟糕。

我们已经研究过使用 Windows WF，但我认为我们有点担心 WF 的未来，以及现在是否是采用它的好时机。我从来没有处理过规则引擎，所以我想知道这在这里是否有用。有没有人对如何实现这一点有任何建议？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-19T23:40:46.187

您最好的选择可能是将数据存储的行为与用于实现它们的技术分离。

实现这一点的方法是 DSL（领域特定语言）。提出一种可以抽象地表示业务逻辑的格式（即一种微语言），将其字符串存储在您的表中，并在代码中为它实现一个解释器。这样，如果你的底层技术发生变化，你只需要重新实现解释器。

我在 1980 年代中期开发了一个使用这种技术的应用程序，它被移植了好几次，只对所需的业务规则进行了微小的（和自动化的）更改。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-20T00:14:15.077

有关特定领域的语言支持，请查看[MSDN 中的此处](http://msdn.microsoft.com/en-us/library/bb126235.aspx)。你也可以看看[Irony](http://www.codeplex.com/irony/)，但这可能还不是生产代码的解决方案。

# asp-classic - 经典 ASP Twitter 库

> ID：664462
> 
> 赞同：3
> 
> 时间：2009-03-19T23:35:59.740
> 
> 标签：asp-classic, vbscript, twitter

有谁知道任何经典 ASP (VBScript) Twitter 库？谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2010-04-17T00:17:27.227

[http://scottdesapio.com/VBScriptOAuth/](http://scottdesapio.com/VBScriptOAuth/)

不是 twitter 库，而是真正的 VBScript OAuth 接口。这种帮助？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-07-24T18:45:24.830

在 VbScript 中也做了一个[http://sitejunction.awardspace.com/vbscript_tweets/](http://sitejunction.awardspace.com/vbscript_tweets/)

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2009-09-28T10:19:18.993

我用 VBScript 编写了自己的 Twitter API 实现， [http://asp.web.id/asp-twitter](http://asp.web.id/asp-twitter "asp 推特库")

目前支持

*   用户展示
*   用户时间线
*   朋友时间线
*   状态提及
*   状态更新

我打算添加更多 api 方法的实现，尤其是 twitter 搜索

* * *

## 回答 #4

> 赞同：-2
> 
> 时间：2009-11-24T16:42:36.643

请查看以下内容：

[http://code.google.com/p/twitter-oauth-in-classic-asp/](http://code.google.com/p/twitter-oauth-in-classic-asp/)
[http://groups.google.com/group/twitter-oauth-in-classic-asp/](http://groups.google.com/group/twitter-oauth-in-classic-asp)

# c# - 在gridview中使用超链接列并在page_load中出现“当前上下文中不存在”错误

> ID：664465
> 
> 赞同：0
> 
> 时间：2009-03-19T23:38:16.427
> 
> 标签：c#, asp.net, gridview, hyperlink, navigateurl

嗨，我在 gridview 中有一个 HyperLink 列，单击该列时应将用户导航到另一个页面。我使用查询字符串将参数传递给页面。我在网格的 onrowdatabound 事件中实现了这个动作。这是代码：

```
 HyperLink btnDetails = (HyperLink)ea.Row.FindControl("btnDetails");
            btnDetails.NavigateUrl = "ManageFlaggedSecurities.aspx?portfolioID=" + obPortfolioId.ToString() + "&testID=" + obTstId.ToString(); 
```

我可以在 ManageFlaggedSecurities 页面的 page_load 事件中设置断点，但是当我想检查我设置的某些字符串参数的值时，我得到的变量是“在当前上下文中不存在”。我什至尝试了一些简单的东西，比如

字符串 strTest = "测试";

并得到了错误。我究竟做错了什么？

麦克风

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-20T01:47:55.850

听起来您正在尝试访问在事件处理程序中声明的变量，同时在 Page_Load 上有一个断点，因此使它们超出范围，或者尝试访问在堆栈中调用者中声明的变量。

显示一些代码...

# stored-procedures - 存储函数获取输出

> ID：664467
> 
> 赞同：0
> 
> 时间：2009-03-19T23:40:01.803
> 
> 标签：stored-procedures

有谁知道存储函数执行后如何获取输出？？？

谢谢你

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-20T00:15:53.077

不确定您使用的是什么语言，也不确定您正在寻找什么输出，但在 C#/ADO.NET 中，您可以通过执行以下操作将选择查询输出抓取到 DataSet 中：

```
SqlConnection sqlConnection = new SqlConnection(
    "server=localhost\SQLEXPRESS;Integrated Security=SSPI;database=Northwind");

SqlDataAdapter sqlDataAdapter = new SqlDataAdapter("[MyStoredProc]", sqlConnection);
sqlDataAdapter.SelectCommand.CommandType = CommandType.StoredProcedure;

// Whatever selects your stored proc does will become tables in the DataSet
DataSet northwindDataSet = new DataSet("Northwind");

sqlConnection.Open();

sqlDataAdapter.Fill(northwindDataSet);

sqlConnection.Close();

// data now available in: dsNorthwind.Tables[0];, etc. depending on how many selects your query ran 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-20T08:45:54.440

假设您想要 T-SQL 中的 OUTPUT 参数的值，您可以执行以下操作：

```
CREATE PROC pTestProc (@in int, @out int OUTPUT)
AS
    SET @Out = @In
    SELECT 'Done'
    RETURN 1
GO

DECLARE @Output INT
EXEC pTestProc  46, @Output OUTPUT
SELECT @Output 
```

-Edoode

# wpf - 在 WPF/XAML 中，如何使用滚动条更改一段文本的大小？

> ID：664476
> 
> 赞同：0
> 
> 时间：2009-03-19T23:43:35.477
> 
> 标签：wpf, visual-studio, xaml

我是 WPF/XAML 的新手，目前正在做一个培训练习。

我有一个点头应用程序，我想根据滚动条的位置更改标签中文本的大小。

文本由以下代码定义：

```
<FlowDocumentScrollViewer Grid.Row="1">
    <FlowDocument>
        <Paragraph>
            Text goes here
        </Paragraph>
    </FlowDocument>
</FlowDocumentScrollViewer> 
```

我正在尝试定义一个 Setter，我已经做到了：

```
<Style TargetType="{x:Type Paragraph}">
    <Setter Property="FontSize" Value="???" />
</Style> 
```

但我不知道需要什么“？？？”。我试过用谷歌搜索这个问题的答案，但我想我一定是使用了错误的搜索词，因为我还没有找到答案。

我猜这会很明显，但我不得不承认我被难住了。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-19T23:57:54.693

您可以使用如下绑定表达式设置字体大小：

```
<Paragraph FontSize="{Binding ElementName=scroll1, Path=Value}" />
<ScrollBar x:Name="scroll1"></ScrollBar> 
```

您要研究的是绑定表达式语法，因为那里目前不支持智能感知。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-21T12:07:01.890

我实现的代码是这样的：

```
<Style TargetType="{x:Type Paragraph}">
    <Setter Property="FontSize" Value="{Binding ElementName=FontSizeScroll, Path=Value}" />
</Style> 
```

这是一种享受。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-20T00:03:45.040

FontSize 的值只是一个描述大小的数字（我认为以点为单位）：

```
<Style TargetType="{x:Type Paragraph}">
     <Setter Property="FontSize" Value="12"/>
</Style> 
```

我不知道这是否是您想要的答案，因为它感觉非常明显。

# scala - scala 将 Iterator[Option[T]] 转换为 Iterator[T]

> ID：664486
> 
> 赞同：12
> 
> 时间：2009-03-19T23:51:51.713
> 
> 标签：scala, scala-collections

我有一个`Iterator[Option[T]]`，我想`Iterator[T]`为那些`Option`s where获得一个`T` `isDefined`。一定有比这更好的方法：

```
it filter { _ isDefined} map { _ get } 
```

我原以为在一个构造中是可能的……有人有什么想法吗？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-03-20T22:11:35.813

如果`it`是`Iterable`

```
val it:Iterable[Option[T]] = ...
it.flatMap( x => x )                //returns an Iterable[T] 
```

如果`it`是`Iterator`

```
val it:Iterator[Option[T]] = ...
it.flatMap( x => x elements )       //returns an Iterator[T]
it.flatMap( _ elements)             //equivalent 
```

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2011-02-21T13:15:42.223

在较新的版本中，这现在是可能的：

```
val it: Iterator[Option[T]] = ...
val flatIt = it.flatten 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2011-02-24T19:17:29.047

这对我有用（Scala 2.8）：

```
it.collect {case Some(s) => s} 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2011-04-25T14:19:48.107

对我来说，这是 monadic UI 的经典用例。

```
for {
  opt <- iterable
  t   <- opt
} yield t 
```

它只是上述`flatMap`解决方案的糖，它产生相同的字节码。但是，语法很重要，我认为使用 Scala 的一元`for`语法的最佳时机之一是在使用 . 时`Option`，尤其是与集合一起使用时。

我认为这个公式更具可读性，特别是对于那些不太熟悉函数式编程的人。我经常尝试循环的一元表达式和函数表达式，看看哪个看起来更直接。我认为*flatMap*对于大多数人来说是一个很难理解的名字（实际上，称呼它对`>>=`我来说更直观）。

# connection-pooling - 如何找出连接泄漏？

> ID：664495
> 
> 赞同：0
> 
> 时间：2009-03-19T23:55:08.540
> 
> 标签：connection-pooling

我们有一个部署在 sun 应用程序服务器上的 struts Web 应用程序，尽管在开发环境中进行了负载测试/系统集成测试。没有连接泄漏的情况。

但是在生产环境中。随着使用的连接不断增加，可以看到连接泄漏。

除了应用程序代码，还有哪些场景会导致连接泄漏？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-20T00:08:50.940

你如何衡量这个？您是否正在查看数据库中的连接数？应用服务器中池的大小？您使用的是哪个数据库？

我不明白“没有连接 [原文如此] 泄漏的情况。” 如果您没有正确关闭所有结果集、语句和连接（在方法范围内的 finally 块中的单个 try/catch 块中，以实例化的相反顺序），您可能会遇到泄漏。

除非有另一个应用程序使用相同的数据库，否则它必须是您的代码或应用程序服务器。如果您对自己的代码深表否认，请尝试切换应用服务器，看看是否有帮助。

我建议您的测试场景不现实。如果您在生产中未观察到此行为，则可能是您的测试未触发该行为，或者测试和产品部署不完全相同。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-23T18:40:52.690

连接泄漏是最常见的问题之一。造成这种情况的主要原因是未关闭结果集，使用后连接。

```
try{
//perform jdbc operations
}catch(Exception e){
//perform error operations
}finally{
//close the connections 
} 
```

还有一些方法可以启用连接泄漏日志记录，但这会影响性能。

# php - 关闭网站并踢出用户进行升级的最佳方法是什么？

> ID：664503
> 
> 赞同：9
> 
> 时间：2009-03-19T23:59:00.933
> 
> 标签：php, authentication

我想知道当您想要进行升级并且您有已登录的用户时，人们是如何将人们踢出或阻止访问网站的。

我的一个想法是将布尔设置放入全局文件（例如设置文件）中，以判断站点是否不可用。True 可用，而 false 不可用。如果为 false，则下次用户尝试访问该站点时，他们将被注销或仅显示不可用消息。

使用此方法我可以看到 2 个问题：

1.  如果用户刚刚完成填写长表单或编写大量文本（例如关于 SO 的新问题或答案），则一旦提交表单，他们就会丢失该信息。（不能总是保存它，因为该表的数据库更改或代码可能已经更改。）

2.  可能：在繁忙的站点上，如果编辑全局文件超过几行，如果该页面在部分上传或保存时加载，可能会导致 PHP 解析错误。根据配置，文件也可能存在锁定问题。

另一种选择是在数据库中有一个具有相同设置的字段。目前，我通常没有设置表格，所以这将是表格中唯一的内容，但我可以看到它更快，因为它避免了第二个问题。

有没有你用过的东西效果很好或有其他想法？

我正在使用 LAMP。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-20T00:05:52.943

提前通知用户您的站点将在指定时间停机，然后根据您的日志文件在您最不忙的时间执行升级。如果您的网站对您的用户至关重要，那么周末非常适合升级。周日早上凌晨 3 点左右的一点停机时间可能不会激怒太多用户。只需确保在升级之前准备好所需的一切，就可以最大限度地减少停机时间。您甚至可以考虑在测试服务器上进行试运行。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-20T00:14:49.317

您可以实现一个状态字段，也许是 AJAX 样式的，例如 StackOverflow 页面顶部的橙色条，它通知用户该站点将在 10-15 分钟内关闭，或者您有什么。您也可以在此期间禁用登录。然后将站点完全关闭，进行升级，然后重新上线。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-03-20T00:37:16.533

您可能想要利用网络服务器重定向。在 Apache 的情况下，`.htaccess`将用户重定向（或重写 url）到静态维护页面的文件：

```
RewriteRule ^updating.*$ $0 [NC,U,QSA,L]
RewriteRule .* /updating/ [NC,U,QSA,R=307,L] 
```

如果您想在维护模式下自己访问该站点，您可以将一个特定且希望唯一的字符串附加到 useragent 标头：

```
RewriteRule ^updating.*$ $0 [NC,U,QSA,L]
RewriteCond %{HTTP:User-Agent} !MY-CUSTOM-UA-STRING [NC]
RewriteRule .* /updating/ [NC,U,QSA,R=307,L] 
```

以下是在 Firefox 中操作用户代理的方法：

创建一个`about:config`名为的新密钥并将`general.useragent.extra.XYZ`其设置为**“MY-CUSTOM-UA-STRING”**或您希望的任何其他内容。Firefox 会将字符串附加到 UA。

如果使用 Chrome，请尝试新的**Mobile Emulation**功能，该功能允许您直接从 devtools 修改用户代理字符串。

正如您自己提到的，另一种解决方案可能是在服务器端设置配置标志。在做之前，我建议你把用户在网站上的所有正在进行的操作保存下来，让她在维护期后恢复它们。另外，请让他们事先知道确切的维护时间。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-20T00:01:07.697

不让新用户登录，监控登录用户数，直到达到0，然后才能升级？

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-20T02:55:59.400

这与 Bobby 的建议类似。我实现相同目的的方法是将几个值放入数据库中的“配置”表中，一个是关闭系统的日期/时间，另一个是消息。

一旦日期字段不为空，然后阻止所有登录，并且在每次页面刷新时，只需使用 javascript 警报向用户显示消息，说明该站点将在 X 分钟内因 Y 原因而被关闭，并且应该重新上线在 Z 分钟内。这是一种烦人且直接的方式，但他们意识到他们不应该开始填写非常长的表格，这一点非常重要。

一旦在维护开始时间之后，然后在他们的下一页刷新时引导所有用户。...当然，除了管理员。

让所有客户端定期轮询服务器以检查即将到来的维护期是过度的，IMO。如果您确实有几个页面的表单很长，那么也许只在这些页面上添加 AJAX 轮询。

在数据库中包含这些类型的值很容易实现，非常灵活，非常适合这种情况。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-20T02:39:41.637

如果您的系统是基于会话的，一个简单的方法是更改​​会话名称。cookie 名称将更改，并且在再次登录之前没有人会得到新的。

# django - 如何修改 Django 中特定类型的所有内置表单字段的默认小部件？

> ID：664511
> 
> 赞同：4
> 
> 时间：2009-03-20T00:03:39.703
> 
> 标签：django, django-forms, widget, django-widget

这是关于[如何更改 ModelForm 中所有 Django 日期字段的默认小部件的后续内容？](https://stackoverflow.com/questions/660929).

假设您有大量模型（例如 A-ZZZ）随着其他开发人员的输入而增长，而您无法控制，并且您想要更改所有日期字段的输入方式（即通过使用 jQueryUI）。确保使用该新小部件填写所有日期字段的最佳方法是什么？

引用问题的一个建议是：

```
def make_custom_datefield(f):
   if isinstance(f, models.DateField):
       # return form field with your custom widget here...
   else:
       return f.formfield()

class SomeForm(forms.ModelForm): 
   formfield_callback = make_custom_datefield

   class Meta:
       # normal modelform stuff here... 
```

但是，这是否可以在您没有明确的 ModelForm，但 url 模式直接来自模型的情况下进行？即你的 url 配置是这样的：

```
url(r'^A/?$', 'list_detail.object_list', SomeModelA) 
```

其中 SomeModelA 是由 Django 在后台转换为 ModelForm 的模型（不是表单）。

目前在我的系统中，每个模型都没有表格。显式创建表单的唯一要点是添加先前解决方案中建议的 formfield_callback，但这违反了 DRY 原则，并且容易出错且劳动强度大。

我考虑过（如上一个线程中所建议的）创建我自己的具有特殊小部件的字段并使用它而不是内置的。它不是劳动密集型的，但它可能会出现错误（不过，没有什么是一个好的 grep 无法修复的）。

建议和想法表示赞赏。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-03-20T00:31:47.187

听起来您想在整个项目范围内执行此操作（即：您不是在某些情况下尝试执行此操作，而是在所有正在运行的应用程序中尝试执行此操作）。

一种可能性是替换 DateField 类本身的小部件属性。您需要在某个中心位置执行此操作......保证由 django 应用程序的每个运行实例加载的内容。中间件可以帮助解决这个问题。否则，只需将其放入`__init__`您的应用程序的文件中。

您要做的是为 forms.DateField 类本身重新分配小部件属性。创建新的 DateField 时，Django 会检查代码是否在字段属性定义中指定了任何特定的小部件。如果不是，它使用 DateField 的默认值。我假设如果您的场景中的用户确实定义了一个特定的小部件，那么尽管您的全局 API 发生了变化，您仍希望尊重这一点。

试试这个作为强制默认其他一些小部件的例子......在这种情况下是一个隐藏输入：

```
from django import forms
forms.DateField.widget = forms.HiddenInput

class Foo(forms.Form):
    a = forms.DateField()

f = Foo()
print f.fields['a'].widget
# results in <django.forms.widgets.HiddenInput object at 0x16bd910> 
```

# asp.net - 这可以通过站点地图修剪来解决吗？

> ID：664514
> 
> 赞同：1
> 
> 时间：2009-03-20T00:04:22.557
> 
> 标签：asp.net, sitemap

看起来这应该有效，但它没有。

我以超级用户身份登录，应该看到 1 个报告，但我实际上看到了 2 个。

```
<siteMapNode url="Reports" title="Reports"  description="" roles="Administrator, Power">
  <siteMapNode url="default.aspx" title="Default"  description="" roles="Administrator" />
  <siteMapNode url="custom.aspx" title="Custom"  description="" roles="Administrator, Power" />
</siteMapNode> 
```

这应该有效吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-24T00:43:37.233

抱歉，如果您已经检查过（您没有提及）但您是否在 web.config 中启用了修剪？

`securityTrimmingEnabled="true"`

[MSDN 上的 ASP.NET Site-Map Security Trimming](http://msdn.microsoft.com/en-us/library/ms178428.aspx)显示了这个“示例”web.config

```
<system.web>
<!-- …other configuration settings -->
  <siteMap defaultProvider="XmlSiteMapProvider" enabled="true">
    <providers>
      <add name="XmlSiteMapProvider"
        description="Default SiteMap provider."
        type="System.Web.XmlSiteMapProvider "
        siteMapFile="Web.sitemap"
        securityTrimmingEnabled="true" />
    </providers>
  </siteMap>
</system.web> 
```

高温高压

# c# - 后台工作者事件处理

> ID：664530
> 
> 赞同：5
> 
> 时间：2009-03-20T00:18:30.947
> 
> 标签：c#, multithreading, debugging, backgroundworker

我一直在努力处理后台工作线程中的事件。

我遇到的所有文档都让我相信，当 DoWork 事件处理程序引发异常时，应该在 RunWorkerCompleted 处理程序中处理该异常，并且该异常将在 RunWorkerCompletedEventArgs 的 Error 属性中可用。

这很好，但在调试期间，我总是看到用户代码消息未处理的异常。这让我相信我的方法有问题。

我应该采取什么步骤来解决这个问题？

问候，乔纳森

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-20T00:47:24.107

`System.Diagnostics.DebuggerNonUserCode`我以前见过这种行为，我通过使用属性装饰 DoWork 处理程序来解决它：

```
[System.Diagnostics.DebuggerNonUserCode]
void bw_DoWork(object sender, DoWorkEventArgs e)
{ ... } 
```

请注意，只有在调试器中运行时才能看到此信息；即使没有该属性，从 shell 运行时也应该如此。

我再次查看了这个，我仍然看不出你需要这样做的任何充分理由。我称其为调试器错误功能。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-20T00:35:03.327

我以前遇到过这个问题。仅当您不在调试模式下运行时才会设置 e.Error。如果您在 Debug 中运行，则执行会在异常处停止。但是，在非调试模式下运行相同的程序（在 VS Debug -> Start without Debugging 或 Ctrl+F5 中）并且讨厌的异常对话框不会出现，并且 e.Error 将是异常。不知道为什么，但这就是它的工作原理......

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-20T00:32:14.940

你的方法是正确的。只需在消息上按继续并继续。如果有疑问，请在调试会话之外对其进行测试。

# estimation - 我只是被要求克隆一个类似 youtube 的网站..

> ID：664531
> 
> 赞同：0
> 
> 时间：2009-03-20T00:18:51.757
> 
> 标签：estimation

我被要求对此进行克隆：[http](http://www.bragster.com/) : //www.bragster.com/ 好吧，本身不是克隆，而是具有类似功能且预算较低的网站！有人会问多低？低于 10K，可能低于 5K。

我的问题：我如何向不懂技术的朋友解释这是不可能的，用最好的术语来说，并说服他们不要去rentacoder.com 并尝试付钱给别人不要为他们做这件事。

你有没有遇到过这样的事情，你是怎么处理的？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-20T02:05:35.887

人们永远不想听到“那是不可能的”，尤其是企业家类型，这只会让他们更加顽固。因此，只需向他们展示 10k 的可能性，并让他们得出自己的结论。

因此，虽然从其他网站上汲取灵感是可以的，但“重新创建 X”并不是一个范围，它通常意味着客户还没有考虑清楚。首先，您不知道该网站的哪些部分真正让客户脱颖而出。

所以和他们坐下来好好计划一下，让他们从头开始布置他们想要的东西，而不是诉诸“不管吹牛/youtube/ebay怎么做”。

只是要点它，真的又快又脏。然后，您将对真实范围有所了解。

*   我想要漂亮的设计
    *   我要上传视频
    *   我想要视频流
    *   我要评论
    *   收视率
    *   分享
    *   比赛
    *   博客
    *   店铺
    *   排行榜
    *   等等等等

然后你可以在每个数字旁边放一些数字，然后看着它们加起来超过 10k。这将说明您的观点，并比“相信我，不要打扰这是不可能的”更好地帮助您的朋友/客户

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-20T00:41:38.693

稍微扩展凯尔的答案——也许可以为他们的业务做一个类比。

例如，如果他们参与建设，询问他们是否有可能以 50 万美元建造一座横跨河流的 1 公里桥梁（不知道实际成本是多少）。

IT 的困难显然在于它是一种无形的东西。做一个有形的类比。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-20T00:20:53.377

找到一个看起来价值 5,000 美元的网站，然后给你的朋友发送一个链接。

每个人都知道一个好的网站需要[六到八周](https://stackoverflow.com/questions/266348/how-much-total-time-and-resources-did-it-take-to-develop-stackoverflow-com)的时间来开发。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-03-20T00:42:44.120

我是一个类似的情况。一位朋友向我提出了一个社交网站的商业创意。我问她，“听起来很有趣，但与所有拥有完善用户群的网站相比，这将如何竞争？”

诚然，我没想到这个问题会有一个好的答案，所以也许它不是非常好。尽管如此，她还是想了想，并认为这个想法不会赚钱，而且她低估了这项工作的难度。我不必以任何居高临下的、说教的方式告诉她，所以我并不觉得这件事太混蛋了。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-20T00:22:50.063

想出几个比喻来指出你认为这个请求是多么不合时宜，并反复使用它们，直到提出这一点。蛮力攻击为胜利！

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-03-20T00:41:56.820

一般来说，不建议进行粗略的估计，因为结果会是错误的。由于很多事情，您会低估。

在这种情况下（并且仅仅因为您确定考虑到成本要求该任务是不可能的），您可以进行粗略的估计，将项目划分为特定任务，也许是里程碑，每个任务都需要时间和资源。把这个估计交给你的朋友，告诉他这是第一种方法/非常粗略的估计/非常冒险的，因为缺乏正式的分析。

SO中的其他帖子可能会为您提供一些指导：[https ://stackoverflow.com/questions/tagged/estimation](https://stackoverflow.com/questions/tagged/estimation)

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-03-20T00:50:13.163

我应该转发我从使用 Rentacoder 等服务的人那里得到的所有恐怖故事吗？哎呀。

我们都知道，如果他们走那条路，大致相当于把 5000 美元扔进碎纸机。也许您可以建议他们找一个可以进行编码的合作伙伴一起开展业务。如果他们让某人对此感到兴奋，并为他们提供股权，a）他们不会超过 5000 美元，b）他们至少有机会获得不糟糕的代码。

至少在海湾地区，有很多黑客马拉松和聚会，开发人员在寻找项目的地方。如果这个想法很好，并且推广它的人足够热情和风度翩翩，就会有人感兴趣。

* * *

## 回答 #8

> 赞同：-1
> 
> 时间：2009-03-20T00:38:59.510

检查 Clipshare，[http:](http://www.clip-share.com/) //www.clip-share.com/ 你需要“设置”一个 ffmpeg 或其他引擎来编码你想要在服务器中的视频、flix 或其他引擎，但它通常很容易设置并且也很便宜.

# c# - 在 MVC 项目的强类型视图中使用模型引用时出错

> ID：664532
> 
> 赞同：0
> 
> 时间：2009-03-20T00:19:08.620
> 
> 标签：c#, asp.net-mvc

我正在尝试为 MVC 项目创建一个新的强类型视图。

我尝试从Controller类（右键单击->添加视图）或直接从视图（右键单击->添加视图）创建它，并将其选择为强类型视图。从下拉列表中，我选择了它应该引用的模型和数据类。

在填写我的视图内容时，我需要将其声明为：

```
<p>
   Title:
   <%= Html.Encode(Model.Title) %>
</p> 
```

出于某种原因，我只是收到此错误：“当前上下文中不存在名称‘模型’”。

我一定错过了一些东西...... :-(
任何评论或想法都会很棒！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-26T20:44:14.727

它应该是 <%= Html.Encode(ViewData.Model.Title) %>

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-20T00:25:54.347

您的类后面的代码是否继承自 ViewPage<ModelType>？

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2010-01-18T21:53:00.530

在将 MVC 视图添加到现有的 WebForms 应用程序时，我遇到了类似的问题。我通过将 Web.config 文件添加到 Views 文件夹并从另一个 MVC 项目复制内容来解决它。

# php - 带有 sql 的远程 tar.gz 运行本地服务器

> ID：664545
> 
> 赞同：0
> 
> 时间：2009-03-20T00:24:13.210
> 
> 标签：php, mysql

我有一个带有完整 mysql 数据库更新的 tar.gz，我可以通过 ftp 访问它。

这个 tar.gz 每天更新，我想创建一个到该 ftp 帐户的 php 和/或 mysql 连接，这将允许我在我的本地 mysql 服务器上运行那个大型 sql 查询。

有什么想法吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-20T00:40:28.507

（我要冒个险，假设您想从某种 unix 盒子中执行此操作……）

抛出这个：

```
#!/bin/bash

wget                        \
    -O -                    \
    --ftp-user=username     \
    --ftp-password=password \
    "ftp://wherever/whatever.tar.gz" | tar xzOf - | mysql --user=whoever --password=secret dbname 
```

在一个文件中（`update-db.sh`例如）然后`chmod`它：

```
chmod 755 update-db.sh 
```

那么你可以：

```
./update-db.sh 
```

每当你想下载更新。或者，您可以将其放入 cron 作业 ( `man crontab`)。

**编辑：**添加`O`标志`tar`以便提取到标准输出。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-20T00:37:28.687

首先 PHP 支持从 FTP 读取，只需使用 fopen 和指定的 ftp 协议，就像这样

```
<?php
$handle = fopen("ftp://user:password@example.com/somefile.txt", "w");
?> 
```

那么您将需要解压缩存档。这里来自 Pear 存储库的[File_Archive将非常方便](http://pear.php.net/package/File_Archive)

# .net - 确定文件是否可以移动或复制

> ID：664554
> 
> 赞同：3
> 
> 时间：2009-03-20T00:30:37.737
> 
> 标签：.net, file, copy, move

除了尝试操作和捕获异常之外，是否有一种方法可以确定文件是否可以移动或复制？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-20T00:33:39.227

无法知道文件移动或复制是否会保证成功。

但是你可以检查很多东西，看看它是否会失败：

*   检查目标位置的磁盘空间（您至少需要文件的大小）
*   检查目标位置已存在的文件
*   打开一个文件，请求对源文件的读取访问权限，以确保 1）您对它有权限，2）它没有被使用。
*   您可以阅读整个源文件以确保文件内没有锁。
*   Windows 资源管理器在复制文件（或跨卷移动）时使用的技巧是首先创建一个空白文件，然后将文件扩展为完整大小。只有在文件完全分配后，才会开始写入文件。
*   分配要复制的数据大小的文件还将告诉您是否已经达到了文件系统报价。
*   如果一个文件正在使用中，并且您想走这么远，您可以使用卷影复制 (VSS)。

**更多关于文件锁定：**

[请在此处查看我的答案，以获取有关linux](https://stackoverflow.com/questions/575328/fcntl-lockf-which-is-better-to-use-for-file-locking/575349#575349)中文件锁定和权限的更多信息。

[请在此处查看我的答案，以获取有关Windows 中文件锁定和权限的](https://stackoverflow.com/questions/203837/can-i-simply-read-a-file-that-is-in-use/203839#203839)更多信息。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-20T00:34:35.993

一般情况下，查看文件是否存在，当前用户是否有读取文件的权限（或删除文件进行移动），是否对目标目录有相应的权限。同样，对于复制，您应该检查是否有可用的磁盘空间。当然，在此之前，请确保原始文件和目标目录甚至存在。

当然，这并不能保证操作一定会成功。很多事情都可能发生。甚至文件的权限也可能在您检查和执行操作之间发生变化。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2009-03-20T00:49:20.967

如果文件可以读取，则可以移动或复制。您是在问如何检查移动或复制是否会成功？

# delphi - 在 Delphi 中制作选项表单

> ID：664569
> 
> 赞同：1
> 
> 时间：2009-03-20T00:37:33.523
> 
> 标签：delphi, forms

我希望我的 Form1 有一个打开 Form2 的选项按钮。在 Form2 中，将有 3 个单选按钮。当按下单选按钮时，我需要我的一个程序来检查使用：

```
if (RadioButton1.Pushed) then begin 
```

让它继续执行代码的一部分，或者如果按下 Radiobutton2，则执行不同的部分，依此类推。问题是，我不知道从哪里开始。有什么建议么？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-20T01:08:38.707

使用 RadioGroup 可能更容易。然后，您可以通过添加到对象检查器中的项目列表来设置您的选项。您可以通过查看 ItemIndex 来判断已设置的按钮，例如：

```
Case MyRadioGroup.ItemIndex of
  1: DoSomething;
  2: DoSomethingElse;
  3: DoAnotherThing;
End; 
```

您不必使用 RadioGroup。任何窗口控件中的所有按钮都将具有您希望一组 RadioButtons 具有的互斥属性。

杰克

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-20T08:01:12.207

您可以使用此代码段：

```
if Form2.RadioButton1.Checked then
begin
  // Do something
end else
if Form2.RadioButton2.Checked then
begin
  // Do something else
end; 
```

如果这将是一个更大的应用程序，您应该考虑创建一个全局*设置对象*，它可以通过您的选项屏幕进行更改，并由需要了解某些设置的程序读取。

**重要提示：**从整个代码中直接访问表单只会增加耦合度。当您的应用程序变得有点大时，维护它将是一场噩梦。

```
// Form2
Config.DoSomething = RadioButton1.Checked
Config.DoSomethingElse = RadioButton2.Checked

// Form1
if Config.DoSomething then
begin
  // Do something
end else
if Config.DoSomethingElse then
begin
  // Do something else
end; 
```

您还可以向`config`uration 对象添加方法以将设置保存到磁盘并在下次应用程序启动时重新加载它们。

其他人建议使用**RadioGroup**，但我个人不喜欢将它们作为长期解决方案，因为我发现它们很难适应我的个人 UI 需求。（主要是边界和距离）如果有一天你想重新排序物品或在结尾以外的任何地方插入新物品，它们也可能会成为问题：突然`ItemIndex`2 意味着完全不同的东西:) 但作为一种快速而肮脏的解决方案，它们肯定是有用。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-20T01:22:15.273

所以稍微重新表述你的问题，你是说

> 按下单选按钮会使我的应用程序进入某种状态。稍后，基于该状态，我希望运行一些特定的代码。

当这样表达时，它变得非常简单。在杰克的回答中，他建议（非常正确）一种简单的方法（查询状态）是使用无线电组。ItemIndex 属性告诉您按钮的状态。

# groovy - Groovy 元编程中的“this”

> ID：664579
> 
> 赞同：2
> 
> 时间：2009-03-20T00:40:43.547
> 
> 标签：groovy, metaprogramming

`fileAsString`在以下为类添加方法的Groovy 代码中`String`，有人可以解释一下“this”到底指的是什么。我认为它`fileAsString`是调用方法的对象，但显然这实际上是委托所指的。

```
String.metaClass.fileAsString = {
    this.class.getResourceAsStream(delegate).getText()
} 
```

谢谢，唐

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-20T05:46:22.343

新定义的方法是一个闭包，因此“this”的含义与定义该方法时的含义相同。通常“this”将引用定义该方法的对象，如下所示：

```
class Foo {
    def meta() {
        String.metaClass.bar = {
            println(this.class)   // 'this' refers to the instance of Foo
        }
    }

    def main() {
        meta()
        new String().bar()
    }
}
new Foo().main()                  // prints "class Foo" 
```

# internet-explorer-8 - Web开发人员应该知道的IE7和IE8之间的主要区别是什么？

> ID：664582
> 
> 赞同：15
> 
> 时间：2009-03-20T00:42:16.460
> 
> 标签：internet-explorer-8

我刚刚下载了 IE8，它取代了我的 IE7，但这没关系，因为 IE8 有一个“兼容性视图”，旨在呈现像 IE7 这样的页面（不确定 JavaScript）。

我想知道互联网上是否列出了开发人员应该知道的版本之间的所有主要差异。我在 Google 上搜索了一下，但没有找到令人满意的列表。

那么，关于让我的网站在 IE8 上以最佳方式运行，我（或任何其他 Web 开发人员）应该知道什么，两者之间的主要区别是什么？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-03-20T00:59:32.190

我将从这里开始：

[Internet Explorer 8 准备工具包](http://www.microsoft.com/windows/internet-explorer/readiness/developers-new.aspx)

[IE8兼容性视图和IE7的区别](http://blogs.msdn.com/ie/archive/2009/03/12/site-compatibility-and-ie8.aspx)

[IE8 开发者资源](http://msdn.microsoft.com/en-au/ie/default.aspx)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-20T01:00:01.223

我认为在更多人安装它之前，您不会找到一个全面的渲染怪癖“陷阱”列表。有许多新功能，例如加速器，您可以开发这些新功能来将新功能构建到 IE8 中。 [这](http://weblogs.asp.net/lduveau/archive/2008/11/22/developing-for-ie8-accelerators-and-web-slices.aspx)看起来是一个好的开始。

# javascript - JavaScript 正则表达式查找实例

> ID：664589
> 
> 赞同：0
> 
> 时间：2009-03-20T00:44:23.507
> 
> 标签：javascript, regex, string

我有一个很长的字符串，我现在需要找到以下实例`'#!#'+some text+'#!#'`：

```
string.replace(/(#!#*#!#)/g, 
      function (m) {....}); 
```

我需要将整个东西传递给这样的函数，以便我可以正确替换它们。

但是，我只想`m`等于两者之间的`#!#`

```
#!#I want this part#!# 
```

但我返回的需要替换整个`'#!#'+some text+'#!#'`.

如果重要的话，两个`#!#`s 之间的文本将是一个整数或一个句子，但它`#!#`当然不包含模式。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-20T00:50:13.257

```
/(#!#*#!#)/ 
```

关闭，但`*`它的意思是“的多个实例`#`，这可能不是你的意思。尝试：

```
/#!#(.*?)#!#/ 
```

（`*?`means 尽可能少地匹配到`#!#`。否则，如果有两个`#!#`序列，则表达式将匹配`greedily`到最后一个。）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-20T01:09:21.777

当你得到“大”字时再次尝试解析，就像这样

```
"llala #!#11#!# asdad".replace(/#!#(.*?)#!#/gi, function(m) { return m.match(/#!#(.*?)#!#/)[1];}) 
```

# makefile - 在 GNU Make 中，如何将变量转换为小写？

> ID：664601
> 
> 赞同：62
> 
> 时间：2009-03-20T00:51:03.567
> 
> 标签：makefile

这是一个愚蠢的问题，但是.... 使用 GNU Make：

```
VAR = MixedCaseText
LOWER_VAR = $(VAR,lc)

default:
        @echo $(VAR)
        @echo $(LOWER_VAR) 
```

在上面的示例中，将 VAR 的内容转换为小写的正确语法是什么？显示的语法（以及我遇到的所有其他内容）导致 LOWER_VAR 是一个空字符串。

* * *

## 回答 #1

> 赞同：62
> 
> 时间：2009-03-20T01:04:54.487

你总是可以产生 tr

```
LOWER_VAR = `echo $(VAR) | tr A-Z a-z` 
```

或者

```
LOWER_VAR  = $(shell echo $(VAR) | tr A-Z a-z) 
```

您尝试调用的“lc”函数来自[GNU Make 标准库](http://gmsl.sourceforge.net/)

假设已安装，正确的语法是

```
LOWER_VAR  = $(call lc,$(VAR)) 
```

* * *

## 回答 #2

> 赞同：58
> 
> 时间：2009-03-20T05:02:48.440

您可以直接在 gmake 中执行此操作，而无需使用 GNU Make 标准库：

```
lc = $(subst A,a,$(subst B,b,$(subst C,c,$(subst D,d,$(subst E,e,$(subst F,f,$(subst G,g,$(subst H,h,$(subst I,i,$(subst J,j,$(subst K,k,$(subst L,l,$(subst M,m,$(subst N,n,$(subst O,o,$(subst P,p,$(subst Q,q,$(subst R,r,$(subst S,s,$(subst T,t,$(subst U,u,$(subst V,v,$(subst W,w,$(subst X,x,$(subst Y,y,$(subst Z,z,$1))))))))))))))))))))))))))

VAR = MixedCaseText
LOWER_VAR = $(call lc,$(VAR))

all:
        @echo $(VAR)
        @echo $(LOWER_VAR) 
```

它看起来有点笨拙，但它可以完成工作。

如果您确实使用 $(shell) 变体，请使用`:=`而不是 just `=`，如`LOWER_VAR := $(shell echo $VAR | tr A-Z a-z)`. 这样，您只需在声明变量时调用一次 shell，而不是每次引用变量时！

希望有帮助。

* * *

## 回答 #3

> 赞同：22
> 
> 时间：2012-06-09T15:05:33.263

要处理带重音的大写字母：

```
LOWER_VAR  = $(shell echo $VAR | tr '[:upper:]' '[:lower:]') 
```

结果：

```
$ VAR="Éclipse"
$ echo $VAR | tr A-Z a-z
Éclipse
$ echo $VAR | tr '[:upper:]' '[:lower:]'
éclipse 
```

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2013-07-25T22:17:36.877

我觉得这个稍微干净一点...

```
$(shell tr '[:upper:]' '[:lower:]' <<< $(VAR)) 
```

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2020-05-05T06:15:30.113

如果安装了 Python，它甚至可以在 Windows 上运行：

```
$(shell python -c "print('$(VAR)'.lower())") 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2021-05-19T10:11:10.527

GNU make 不包括用于大小写转换的字符串函数。`lc`因此，默认情况下没有定义函数。

但 GNU Make 通常会启用 GNU Guile 支持（例如 Fedora 33 就是这种情况）。

因此，您可以调用 Guile 函数来转换大小写：

```
VAR = MixedCaseText
LOWER_VAR = $(guile (string-downcase "$(VAR)"))

default:
        @echo $(VAR)
        @echo $(LOWER_VAR) 
```

或者，如果您想封装 Guile 调用：

```
VAR = MixedCaseText
LOWER_VAR = $(call to_lower,$(VAR))

define to_lower
$(guile (string-downcase "$(1)"))
endef

default:
        @echo $(VAR)
        @echo $(LOWER_VAR) 
```

# php - 如何从另一个变量名创建变量？

> ID：664606
> 
> 赞同：2
> 
> 时间：2009-03-20T00:53:19.180
> 
> 标签：php, variables, loops

好的...在 php 中我该怎么做？给定以下情况：

```
// array of letters
var $letters = array('a', 'b', 'c');
// loop through array and create empty arrays with names like $a, $b, $c
foreach($letters as $letter) {
    var $$letter = array();
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-20T01:09:56.800

您的代码几乎是正确的。您只需要删除第 2 行和第 5 行的“var”。

```
// array of letters
$letters = array('a', 'b', 'c');
// loop through array and create empty arrays with names like $a, $b, $c
foreach($letters as $letter) {
    $$letter = array();
} 
```

这可以正常工作（如您所述）。我测试了它。

[关于变量变量的](http://au.php.net/language.variables.variable)更多信息在这里。

*顺便说一句，我建议不要在你的 PHP 中使用 eval()。*

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-20T18:57:47.263

你可能不想这样做。想要使用可变变量通常表明无法理解数据结构和/或过于聪明。如果你真的想这样做，你可以说...

```
extract(array_fill_keys($letters, array())); 
```

……不过最好不要。使用嵌套数组可能是一个更好的主意 - 特别是因为您可以说`$nested['a'][] = 5`PHP 会将值附加到数组中，如果没有则创建一个。或者，您可以说`$varname['key'] = 123`，PHP 会再次为您自动创建数组。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-20T00:56:36.440

查看 eval() 函数： [Eval](http://www.w3schools.com/php/func_misc_eval.asp)

# programming-languages - Lego Mindstorms Programming - 您使用/推荐哪种语言/IDE？

> ID：664615
> 
> 赞同：32
> 
> 时间：2009-03-20T00:57:58.527
> 
> 标签：programming-languages, robotics, mindstorms, lego, nxt

我是新手，目前正在使用 Lego Mindstorms IDE 使用的可视化流程图之类的语言。我对图表语言的可读性印象深刻，但缺少实际代码的灵活性。我正在想象我想尝试的复杂项目，但我并不想将它们实现为一个巨大的流程图！哈哈 ：）

我知道您可以使用其他语言/IDE，但不确定它们是什么或使用哪个。对于 Lego Mindstorms 项目的编程，你推荐什么 IDE/语言？

我更喜欢一个仍然允许我点击运行并通过蓝牙将程序发送到 NXT 砖并立即运行的 IDE。

**更新**：我最终选择了[lejos](http://lejos.sourceforge.net/)。主要是因为我刚开始在工作中学习 Java，这与我已经熟悉的 C# 非常相似。**我会推荐 Lejos**，因为 Java 是一种很棒的高级、功能丰富的语言，并且有很好的 IDE。Eclipse 是一个很棒的 IDE，lejos 有一个插件，并且 ant 构建脚本使构建您的项目，将其加载到 NXT 砖并在设备上运行它是一步过程。Lejos 确实需要在您的 NXT 积木上安装特殊固件，但效果很好，如果您愿意，以后可以随时重新打开旧的 Mindstorms 固件。

如果您想查看其他语言和 IDE 选项，我**强烈推荐我偶然发现的这张图表**：[http ://www.teamhassenplug.org/NXT/NXTSoftware.html](http://www.teamhassenplug.org/NXT/NXTSoftware.html)

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-07-05T00:58:39.677

仅供参考，我遇到了这个非常有用的不同语言的功能比较图表，您可以在其中对 NXT 进行编程：

[http://www.teamhassenplug.org/NXT/NXTSoftware.html](http://www.teamhassenplug.org/NXT/NXTSoftware.html)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-20T11:00:46.737

[我认为这是一本关于使用NXC](http://bricxcc.sourceforge.net/nbc/)（不是 eXactly C）语言对 Mindstorm NXT 进行编程的好书。

[John C. Hansen 的“LEGO Mindstorms NXT Power Programming: Robotics in C”](http://www.amazon.co.uk/LEGO-Mindstorms-NXT-Power-Programming/dp/0973864923)

只需进行少量修改，您就可以让 NXC 与您最喜欢的 IDE 一起工作。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-04-20T23:37:19.437

另一种选择是[Microsoft Robotics Studio](http://msdn.microsoft.com/en-us/robotics/default.aspx)。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-03-24T13:31:21.600

我们使用 NQC 对 Lego Mindstorms 进行编程。我们要建造一个四轮机器人来收集人造垃圾（珠子和纸片）参加比赛。在测试了不同的编程和 IDE 之后，我得出结论 NQC 对我来说是正确的。（因为我知道 C 和 NQC 有很多很好的教程材料）。关键是您可以使用 NQC 轻松修改您的代码。例如，在比赛中，我们应该更改代码以应对机器人环境中的新挑战（他们将 MDF 改为地毯！）

顺便说一句，我们取得了不错的成绩（第三名）:)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-24T13:55:43.587

如果您对使用 MATLAB 有兴趣，MATLAB 实际上有一个[LEGO MINDSTORMS NXT 工具包。](http://www.mathworks.com/programs/mindstorms/)您可以通过蓝牙连接发送命令或创建下载到机器人的嵌入式控件。我在一些[MathWorks 博客](http://blogs.mathworks.com/loren/2008/06/30/lego-mindstorms-nxt-in-teaching/)上看到了它的讨论，并且在 MathWorks 文件交换上发布了一些演示（[这里是一个](http://www.mathworks.com/matlabcentral/fileexchange/13399)）。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-07-06T07:10:54.830

您可以使用[nxtOSEK](http://lejos-osek.sourceforge.net/)作为 NXT 上的操作系统。然后你可以使用纯 C 来编写你的代码。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-03-20T02:06:24.057

回到过去，NQC 是要走的路；一个很好的 C 风格编程介绍，陷阱更少。

# c - “重新传递”函数参数

> ID：664625
> 
> 赞同：1
> 
> 时间：2009-03-20T01:04:02.977
> 
> 标签：c, variadic-functions, tree-traversal

我正在使用经典的 C 进行此类分配，并且遇到了关于采用可变参数计数和类型的回调函数的问题。

基本上，我正在研究一个散列树（每个节点都是一个散列树的树），并且我有一个特定的遍历策略，将多次用于不同的目的，所以我将它实现为`ht_walk(HashTree tree, (*callback)(Element e))`，这样称为回调的函数将以任何必要的方式处理元素。

问题是，在我的问题中的大多数情况下，回调函数必须采用不同的参数。我知道如何使用“可变参数”函数（使用 stdarg、printf-way）设计一个带有可变参数列表的函数，但我不知道如何将这些参数“重新传递”给回调函数。

让我提供一个具体的例子：假设我有一个名为 的回调函数`addToList(Element e, List list)`，并且我的 ht_walk 声明是 now `ht_walk(HashTree tree, (*callback)(Element e), ...)`。考虑我想在以下代码段中使用 ht_walk ：

```
HashTree my_tree = ht_create();
/* run some algorithm that populates the tree somehow */
List my_list = list_create();
ht_walk(my_tree, addToList, my_list); 
```

有没有办法做到这一点？提前致谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-20T01:17:15.127

您可以使用以下两种方法之一来解决此问题。

最常见、易于理解和干净的方法是使用“用户”结构：

```
void ht_walk(HashTree tree, void (*callback)(Element e, void *user), void *user);

void addToList(Element e, void *arg)
{
    STATIC_ASSERT(sizeof(void *) >= sizeof(List));

    List list = arg;

    /* ... */
}

HashTree my_tree = ht_create();
/* run some algorithm that populates the tree somehow */
List my_list = list_create();
ht_walk(my_tree, addToList, my_list); 
```

* * *

另一种方法是接受`va_list`：

```
#include <stdarg.h>

void ht_walk(HashTree tree, void (*callback)(Element e, va_list args), ...)
{
    for(..)
    {
        va_list args;
        va_start(args, callback);
        callback(element, args);
        va_end(args);
    }
}

void addToList(Element e, va_list args)
{
    List list = va_arg(args, List);

    /* ... */
}

HashTree my_tree = ht_create();
/* run some algorithm that populates the tree somehow */
List my_list = list_create();
ht_walk(my_tree, addToList, my_list); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-20T01:11:33.113

有一系列函数和宏用于处理可变参数（例如 va_start） GNU 有一个[很好的指南here](http://www.gnu.org/software/libtool/manual/libc/Variadic-Functions.html)

话虽如此，您似乎在描述一种访问者模式。我不确定我是否喜欢在这里使用可变参数列表。如果您通常无法确定您的回调将为所有节点一致地获取哪些参数，那么您一开始就有麻烦了。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-20T01:17:47.247

我不认为你想要做的是传递任意数量的参数。我认为您在这里遇到的情况是您有多种类型的回调。在您的示例中，您传递了一个列表，但您有时也会提到您将传递一个元素。所以在我看来，你真正想要做的是声明你的回调采用 void* 和一个标志来指示它是什么。就像是：

```
void callback(void* arg, int type) {
    switch (type) {
    case ARG_TYPE_LIST:
        List* list = (List*)arg;
        ...
        break;
    case ARG_TYPE_ELEMENT:
        Element* ele = (Element*)arg;
        ...
        break;
    ...
} 
```

如果您将事物作为列表传递，则列表应该知道计数，因此您不必担心传递它。

或者，您可以定义多种类型的回调，并始终根据您需要执行的处理类型来回调正确的类型。

如果您不拘泥于纯 C（即您可以使用 C++），您可以使用[boost::bind](http://www.boost.org/doc/libs/1_38_0/libs/bind/bind.html)进行调查，因为它对这类事情非常有用。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-20T01:10:32.007

我相信你使用`va_list`宏。请参阅[stdarg 的手册页](http://www.manpagez.com/man/3/stdarg/)。

虽然我已经有一段时间没有尝试过了......

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-20T01:11:09.107

我会传入一个 void *，因为我认为您不能在回调函数中使用可变数量的参数。不过我可能是错的。

```
typedef void (*tree_walk_callback)(Element e, void *data);

add_element(Element e, void *data)
{
    List *list = (List *)data;
    add_element_to_list(list, e);
}

...in your function...
List my_list;
ht_walk(my_tree, &add_element, (void *)&my_list); 
```

如果用户想要传递多个参数，那么他们将传递一个包含他们需要的任何内容的结构。

# javascript - 在 IE 中使用 javascript 禁用退格键和删除键

> ID：664631
> 
> 赞同：13
> 
> 时间：2009-03-20T01:07:39.830
> 
> 标签：javascript

任何人都知道如何在 IE 中使用 Javascript 禁用退格键和删除键？这是我下面的代码，但它似乎不适用于 IE，但适用于 Mozilla。

```
onkeydown="return isNumberKey(event,this)"

function isNumberKey(evt, obj)
{

    var charCode = (evt.which) ? evt.which : evt.keyCode
    if (charCode == 8 || charCode == 46) return false;

    return true;
} 
```

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-03-20T01:12:48.023

此事件处理程序适用于所有主要浏览器。

```
function onkeyup(e) {
    var code;
    if (!e) var e = window.event; // some browsers don't pass e, so get it from the window
    if (e.keyCode) code = e.keyCode; // some browsers use e.keyCode
    else if (e.which) code = e.which;  // others use e.which

    if (code == 8 || code == 46)
        return false;
} 
```

您可以将事件附加到此函数，例如：

```
<input onkeyup="return onkeyup()" /> 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-03-20T07:58:06.083

**根据**@JoeCoder的评论和我的回答的“过时性”**[进行](https://stackoverflow.com/users/187523/joecoder)更新，我对其进行了修改。**

 **```
document.querySelector([text input element]).onkeydown = checkKey;
function checkKey(e) {
    e = e || event;
    return !([8, 46].indexOf(e.which || e.keyCode || e.charCode) > -1);
} 
```

另请参阅[**此 jsFiddle**](http://jsfiddle.net/KooiInc/9r6bvaLd/)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2011-11-21T11:26:27.447

```
$(document).keydown(function(e) {
    if (e.keyCode === 8) {
        var element = e.target.nodeName.toLowerCase();
        if ((element != 'input' && element != 'textarea') || $(e.target).attr("readonly")) {
            return false;
        }
    }
}); 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2014-06-01T08:25:58.060

此代码取消退格操作。

```
window.onkeydown = function (event) {

    if (event.which == 8) { 

         event.preventDefault();   // turn off browser transition to the previous page 

                 // put here code you need 

        }; 

}; 
```

# wpf - 在 WPF 中突出显示整个 TreeViewItem 行

> ID：664632
> 
> 赞同：64
> 
> 时间：2009-03-20T01:08:06.537
> 
> 标签：wpf, templates, treeviewitem

如果我设置 TreeViewItem Background 它仅突出显示标题。如何突出显示整行？

我发现一个帖子几乎解决了一个问题[http://social.msdn.microsoft.com/Forums/en-US/wpf/thread/b04f73e2-0b10-4d97-a6da-64df2e30c21d/](http://social.msdn.microsoft.com/Forums/en-US/wpf/thread/b04f73e2-0b10-4d97-a6da-64df2e30c21d/)

但是有一些问题： 1\. 没有突出显示整行 2\. 树在 Vista 上有 XP 风格。我希望它在 Vista 上看起来和原来一样，但是如果用户将主题更改为 XP - 它应该是 XP 方式。3\. 这么多 XAML...

任何想法，我应该寻找什么？

* * *

## 回答 #1

> 赞同：107
> 
> 时间：2009-03-23T03:16:53.240

我们来了，第三次魅力。如果你想要看起来像这样的东西。

[![全宽树视图](https://i.stack.imgur.com/8WlfP.png)](https://i.stack.imgur.com/8WlfP.png)

这需要更多的工作。我确信有很多方法可以做到这一点，但这种方法使用 Length Converter 和 TreeViewItem 扩展方法来获取 Depth。这两者都与 TreeViewItem 可视化树紧密耦合，因此如果您开始弄乱模板，那么您可能会遇到麻烦。同样，这是重要的部分，下面是完整的代码。

```
<ControlTemplate TargetType="{x:Type TreeViewItem}">
  <ControlTemplate.Resources>
      <local:LeftMarginMultiplierConverter Length="19" x:Key="lengthConverter" />
  </ControlTemplate.Resources>
  <StackPanel>
        <Border Name="Bd"
          Background="{TemplateBinding Background}"
          BorderBrush="{TemplateBinding BorderBrush}"
          BorderThickness="{TemplateBinding BorderThickness}"
          Padding="{TemplateBinding Padding}">
            <Grid Margin="{Binding Converter={StaticResource lengthConverter},
                    RelativeSource={RelativeSource TemplatedParent}}">

                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="19" />
                    <ColumnDefinition />
                </Grid.ColumnDefinitions>
                <ToggleButton x:Name="Expander"
                    Style="{StaticResource ExpandCollapseToggleStyle}"
                    IsChecked="{Binding Path=IsExpanded,
                    RelativeSource={RelativeSource TemplatedParent}}"
                    ClickMode="Press"/>

                <ContentPresenter x:Name="PART_Header"
                    Grid.Column="1"
                    ContentSource="Header"
                    HorizontalAlignment="{TemplateBinding HorizontalContentAlignment}"/>
            </Grid>
      </Border>
      <ItemsPresenter x:Name="ItemsHost" />
    </StackPanel>
    <!-- Triggers -->
</ControlTemplate> 
```

**树视图深度扩展**

```
public static class TreeViewItemExtensions
{
    public static int GetDepth(this TreeViewItem item)
    {
        TreeViewItem parent;
        while ((parent = GetParent(item)) != null)
        {
            return GetDepth(parent) + 1;
        }
        return 0;
    }

    private static TreeViewItem GetParent(TreeViewItem item)
    {
        var parent = VisualTreeHelper.GetParent(item);
        while (!(parent is TreeViewItem || parent is TreeView))
        {
            parent = VisualTreeHelper.GetParent(parent);
        }
        return parent as TreeViewItem;
    }
} 
```

**LeftMarginMultiplierConverter**

```
public class LeftMarginMultiplierConverter : IValueConverter
{
    public double Length { get; set; }

    public object Convert(object value, Type targetType, object parameter, CultureInfo culture)
    {
        var item = value as TreeViewItem;
        if (item == null)
            return new Thickness(0);

        return new Thickness(Length * item.GetDepth(), 0, 0, 0);
    }

    public object ConvertBack(object value, Type targetType, object parameter, CultureInfo culture)
    {
        throw new System.NotImplementedException();
    }
} 
```

**控制**

```
<TreeView Margin="50" HorizontalContentAlignment="Stretch">
    <TreeViewItem Header="test2"/>
    <TreeViewItem Header="test2">
        <TreeViewItem Header="sub test">
            <TreeViewItem Header="sub test1-1"/>
            <TreeViewItem Header="sub test1-2"/>
        </TreeViewItem>
        <TreeViewItem Header="sub test2"/>
    </TreeViewItem>
    <TreeViewItem Header="test3"/>
</TreeView> 
```

**完整的 TreeViewItem 样式**

```
<SolidColorBrush x:Key="GlyphBrush" Color="#444" />

<!--=================================================================
     TreeViewItem
  ==================================================================-->
<Style x:Key="ExpandCollapseToggleStyle" TargetType="ToggleButton">
  <Setter Property="Focusable" Value="False"/>
  <Setter Property="Template">
    <Setter.Value>
      <ControlTemplate TargetType="ToggleButton">
        <Grid
          Width="15"
          Height="13"
          Background="Transparent">
          <Path x:Name="ExpandPath"
            HorizontalAlignment="Left" 
            VerticalAlignment="Center" 
            Margin="1,1,1,1"
            Fill="{StaticResource GlyphBrush}"
            Data="M 4 0 L 8 4 L 4 8 Z"/>
        </Grid>
        <ControlTemplate.Triggers>
          <Trigger Property="IsChecked"
               Value="True">
            <Setter Property="Data"
                TargetName="ExpandPath"
                Value="M 0 4 L 8 4 L 4 8 Z"/>
          </Trigger>
        </ControlTemplate.Triggers>
      </ControlTemplate>
    </Setter.Value>
  </Setter>
</Style>
<Style x:Key="TreeViewItemFocusVisual">
  <Setter Property="Control.Template">
    <Setter.Value>
      <ControlTemplate>
        <Border>
          <Rectangle Margin="0,0,0,0"
                 StrokeThickness="5"
                 Stroke="Black"
                 StrokeDashArray="1 2"
                 Opacity="0"/>
        </Border>
      </ControlTemplate>
    </Setter.Value>
  </Setter>
</Style>

<Style x:Key="{x:Type TreeViewItem}"
     TargetType="{x:Type TreeViewItem}">
  <Setter Property="Background"
      Value="Transparent"/>
  <Setter Property="HorizontalContentAlignment"
      Value="{Binding Path=HorizontalContentAlignment,
              RelativeSource={RelativeSource AncestorType={x:Type ItemsControl}}}"/>
  <Setter Property="VerticalContentAlignment"
      Value="{Binding Path=VerticalContentAlignment,
              RelativeSource={RelativeSource AncestorType={x:Type ItemsControl}}}"/>
  <Setter Property="Padding"
      Value="1,0,0,0"/>
  <Setter Property="Foreground"
      Value="{DynamicResource {x:Static SystemColors.ControlTextBrushKey}}"/>
  <Setter Property="FocusVisualStyle"
      Value="{StaticResource TreeViewItemFocusVisual}"/>
  <Setter Property="Template">
    <Setter.Value>
      <ControlTemplate TargetType="{x:Type TreeViewItem}">
        <ControlTemplate.Resources>
            <local:LeftMarginMultiplierConverter Length="19" x:Key="lengthConverter" />
        </ControlTemplate.Resources>
        <StackPanel>
        <Border Name="Bd"
              Background="{TemplateBinding Background}"
              BorderBrush="{TemplateBinding BorderBrush}"
              BorderThickness="{TemplateBinding BorderThickness}"
              Padding="{TemplateBinding Padding}">
            <Grid Margin="{Binding Converter={StaticResource lengthConverter},
                              RelativeSource={RelativeSource TemplatedParent}}">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="19" />
                <ColumnDefinition />
            </Grid.ColumnDefinitions>
          <ToggleButton x:Name="Expander"
                  Style="{StaticResource ExpandCollapseToggleStyle}"
                  IsChecked="{Binding Path=IsExpanded,
                              RelativeSource={RelativeSource TemplatedParent}}"
                  ClickMode="Press"/>

            <ContentPresenter x:Name="PART_Header"
            Grid.Column="1"
                      ContentSource="Header"
                      HorizontalAlignment="{TemplateBinding HorizontalContentAlignment}"/>
            </Grid>
          </Border>
          <ItemsPresenter x:Name="ItemsHost" />
        </StackPanel>
        <ControlTemplate.Triggers>
          <Trigger Property="IsExpanded"
               Value="false">
            <Setter TargetName="ItemsHost"
                Property="Visibility"
                Value="Collapsed"/>
          </Trigger>
          <Trigger Property="HasItems"
               Value="false">
            <Setter TargetName="Expander"
                Property="Visibility"
                Value="Hidden"/>
          </Trigger>
          <MultiTrigger>
            <MultiTrigger.Conditions>
              <Condition Property="HasHeader"
                     Value="false"/>
              <Condition Property="Width"
                     Value="Auto"/>
            </MultiTrigger.Conditions>
            <Setter TargetName="PART_Header"
                Property="MinWidth"
                Value="75"/>
          </MultiTrigger>
          <MultiTrigger>
            <MultiTrigger.Conditions>
              <Condition Property="HasHeader"
                     Value="false"/>
              <Condition Property="Height"
                     Value="Auto"/>
            </MultiTrigger.Conditions>
            <Setter TargetName="PART_Header"
                Property="MinHeight"
                Value="19"/>
          </MultiTrigger>
          <Trigger Property="IsSelected"
               Value="true">
            <Setter TargetName="Bd"
                Property="Background"
                Value="{DynamicResource {x:Static SystemColors.HighlightBrushKey}}"/>
            <Setter Property="Foreground"
                Value="{DynamicResource {x:Static SystemColors.HighlightTextBrushKey}}"/>
          </Trigger>
          <MultiTrigger>
            <MultiTrigger.Conditions>
              <Condition Property="IsSelected"
                     Value="true"/>
              <Condition Property="IsSelectionActive"
                     Value="false"/>
            </MultiTrigger.Conditions>
            <Setter TargetName="Bd"
                Property="Background"
                Value="{DynamicResource {x:Static SystemColors.ControlBrushKey}}"/>
            <Setter Property="Foreground"
                Value="{DynamicResource {x:Static SystemColors.ControlTextBrushKey}}"/>
          </MultiTrigger>
          <Trigger Property="IsEnabled"
               Value="false">
            <Setter Property="Foreground"
                Value="{DynamicResource {x:Static SystemColors.GrayTextBrushKey}}"/>
          </Trigger>
        </ControlTemplate.Triggers>
      </ControlTemplate>
    </Setter.Value>
  </Setter>
</Style> 
```

* * *

## 回答 #2

> 赞同：20
> 
> 时间：2015-06-14T13:10:38.410

**TreeViewItem Header 不会拉伸？**

出现此问题是因为 WPF 的默认模板`TreeViewItem`设置为 3-column by 2-row `Grid`。第一行是“标题”（实际上是 a `Border`），第二行是`ItemsPresenter`. 这两行根据需要变为可见或隐藏，以便在单击小三角形时完成树扩展 - 它占据`Grid`.

这两行实际上只需要一列。例如，在第二行中，我们必须在 col-0、row-1 处没有任何内容，因为当`IsExpanded`为 true 时，该空白部分应该缩进。但是当我们注意到`ItemsPresenter`基于 col-1, row-1 的 指定时，谜团就开始了**`Grid.ColumnSpan=2`**。

不幸的是，在第一行，`Border`保存标题的 设置为`Grid.Column=1`...但没有 ColumnSpan。由于 的 col-2`Grid`这`Width=*`意味着标题/边框不会水平拉伸。

换句话说，我似乎认为 3 列网格设计除了专门防止标题拉伸之外没有其他目的。据我所知，一个简单的 2x2 排列会更灵活[编辑：参见脚注 #2]，并通过常规对齐机制支持完全拉伸**或**“锯齿状”标题非拉伸。`WPF`

理想情况下，我们会将 更改`Grid`为只有 2 列而不是 3 列。因为这不是那么容易，所以我们将***让标题跨 2 列***，就像所做的`ItemsPresenter`那样。

好的，这是一个**小型、完整、自包含（仅 XAML）的工作程序**，它演示并修复了问题：

```
<Window x:Class="WpfApplication1.MainWindow"
    xmlns="http://schemas.microsoft.com/netfx/2007/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:r="clr-namespace:System.Reflection;assembly=mscorlib"
    xmlns:sys="clr-namespace:System;assembly=mscorlib"
    Width="800" SizeToContent="Manual">

  <TreeView ItemsSource="{Binding Source={StaticResource data}}"
            VirtualizingStackPanel.VirtualizationMode="Recycling"
            VirtualizingStackPanel.IsVirtualizing="True"
            VirtualizingPanel.ScrollUnit="Item">

    <TreeView.Resources>
        <ObjectDataProvider x:Key="data" ObjectInstance="{x:Static sys:AppDomain.CurrentDomain}" MethodName="GetAssemblies" />

        <HierarchicalDataTemplate DataType="{x:Type r:Assembly}" ItemsSource="{Binding Path=DefinedTypes}" >
            <TextBlock Text="{Binding Path=Location}" />
        </HierarchicalDataTemplate>
        <HierarchicalDataTemplate DataType="{x:Type sys:Type}" ItemsSource="{Binding Path=CustomAttributes}">
            <TextBlock Text="{Binding Path=Name}" />
        </HierarchicalDataTemplate>
        <HierarchicalDataTemplate DataType="{x:Type r:CustomAttributeData}" ItemsSource="{Binding Path=ConstructorArguments}">
            <TextBlock Text="{Binding Path=AttributeType.Name}" />
        </HierarchicalDataTemplate>
    </TreeView.Resources>

    <TreeView.ItemContainerStyle>
        <Style TargetType="{x:Type TreeViewItem}">

            <!-- == == BEGIN HERE == == -->
            <Style.Resources>
                <Style TargetType="{x:Type Border}">
                    <Setter Property="Grid.ColumnSpan" Value="2" />
                </Style>
            </Style.Resources>
            <!-- == == == END == == == -->

            <Setter Property="Background" Value="LightBlue" />

        </Style>
    </TreeView.ItemContainerStyle>
  </TreeView>
</Window> 
```

如果你如图所示运行这个程序，你会看到类似这样的东西。这是改变（修改）的行为，它允许您重新完全控制`TreeViewItem`标题的拉伸行为：

![在此处输入图像描述](https://i.stack.imgur.com/D9iK0.png)

请注意 XAML 源中带有虚线的 BEGIN/END 部分。基本上，我只是设置`Grid.ColumnSpan=2`了有问题的`Border`，这样它就会填充`Grid`. 该元素由`TreeViewItem`模板发出，因此我发现更改其属性的有效方法是通过's`Style`的*资源字典*中的目标。是的，令人困惑。这是通过访问。`TreeViewItem``Style``Style``TreeViewItem.ItemContainerStyle`

要查看（现有）损坏的行为，您可以注释掉虚线之间的部分：

![在此处输入图像描述](https://i.stack.imgur.com/2jBN3.png)

您还可以在一些资源字典中设置这些样式，而不是`ItemContainerStyle`像我在这里那样使用属性。我这样做是因为它最小化了修复的范围，因此不相关的`Border`控件不会受到影响。如果您确实需要一种更具辨别力的方式来仅针对此控件，则可以利用它具有`Name='Bd'`.

* * *

[编辑：]*此解决方案不**使用**反射！*不要被无意义的演示数据吓到——它与这个问题无关；这只是为了演示目的而获取一些分层数据的最简单方法，同时保持整个程序很小。

* * *

[edit #2:] 我刚刚意识到，设计师试图通过 3x2 网格排列来避免以下难看的效果（此处通过放大的屏幕截图夸大了）。因此，如果您采用此页面中的一种解决方案，请注意您可能不希望这样：

![在此处输入图像描述](https://i.stack.imgur.com/YylfX.png)

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2009-03-20T23:47:26.507

如果你的意思是这样的截图

[![全宽 TreeViewItem](https://i.stack.imgur.com/iMXV3.png)](https://i.stack.imgur.com/iMXV3.png)
[（来源：[bendewey.com](http://www.bendewey.com/code/treeViewFullWidth2.png)）]

**更新** 如前所述，此示例的缺点是在子项上缩进

[![全宽 TreeViewItem](https://i.stack.imgur.com/T6Q0W.png)](https://i.stack.imgur.com/T6Q0W.png)
[（来源：[bendewey.com](http://www.bendewey.com/code/treeViewFullWidth2a.png)）]

那么这应该可以帮助你。它也基于[http://msdn.microsoft.com/en-us/library/ms788727.aspx](http://msdn.microsoft.com/en-us/library/ms788727.aspx)您可以将 TreeViewItem 的模板更改为 StackPanel 并将 ItemsPanel 的左边距设置为 19。然后在 TreeView 中设置 Horizo​​ntalContentAlignment= “拉紧”。我在下面附上了整个资源，但这是重要的部分。

```
<ControlTemplate TargetType="{x:Type TreeViewItem}">
<StackPanel>
    <Border Name="Bd"
      Background="{TemplateBinding Background}"
      BorderBrush="{TemplateBinding BorderBrush}"
      BorderThickness="{TemplateBinding BorderThickness}"
      Padding="{TemplateBinding Padding}">
        <Grid>
        <Grid.ColumnDefinitions>
            <ColumnDefinition Width="19" />
            <ColumnDefinition />
        </Grid.ColumnDefinitions>
              <ToggleButton x:Name="Expander"
                      Style="{StaticResource ExpandCollapseToggleStyle}"
                      IsChecked="{Binding Path=IsExpanded,
                                  RelativeSource={RelativeSource TemplatedParent}}"
                      ClickMode="Press"/>
              <ContentPresenter x:Name="PART_Header"
                    Grid.Column="1"
                        ContentSource="Header"
                        HorizontalAlignment="{TemplateBinding HorizontalContentAlignment}"/>
        </Grid>
  </Border>
  <ItemsPresenter x:Name="ItemsHost" Margin="19,0,0,0" />
</StackPanel>
<!-- Triggers -->
</ControlTemplate> 
```

**控制**

```
<TreeView Margin="50" HorizontalContentAlignment="Stretch">
    <TreeViewItem Header="test2"/>
    <TreeViewItem Header="test2">
        <TreeViewItem Header="sub test"/>
        <TreeViewItem Header="sub test2"/>
    </TreeViewItem>
    <TreeViewItem Header="test3"/>
</TreeView> 
```

**资源**

```
<SolidColorBrush x:Key="GlyphBrush" Color="#444" />

<!--=================================================================
      TreeViewItem
  ==================================================================-->
<Style x:Key="ExpandCollapseToggleStyle" TargetType="ToggleButton">
  <Setter Property="Focusable" Value="False"/>
  <Setter Property="Template">
    <Setter.Value>
      <ControlTemplate TargetType="ToggleButton">
        <Grid
          Width="15"
          Height="13"
          Background="Transparent">
          <Path x:Name="ExpandPath"
            HorizontalAlignment="Left" 
            VerticalAlignment="Center" 
            Margin="1,1,1,1"
            Fill="{StaticResource GlyphBrush}"
            Data="M 4 0 L 8 4 L 4 8 Z"/>
        </Grid>
        <ControlTemplate.Triggers>
          <Trigger Property="IsChecked"
               Value="True">
            <Setter Property="Data"
                TargetName="ExpandPath"
                Value="M 0 4 L 8 4 L 4 8 Z"/>
          </Trigger>
        </ControlTemplate.Triggers>
      </ControlTemplate>
    </Setter.Value>
  </Setter>
</Style>
<Style x:Key="TreeViewItemFocusVisual">
  <Setter Property="Control.Template">
    <Setter.Value>
      <ControlTemplate>
        <Border>
          <Rectangle Margin="0,0,0,0"
                 StrokeThickness="5"
                 Stroke="Black"
                 StrokeDashArray="1 2"
                 Opacity="0"/>
        </Border>
      </ControlTemplate>
    </Setter.Value>
  </Setter>
</Style>

<Style x:Key="{x:Type TreeViewItem}"
     TargetType="{x:Type TreeViewItem}">
  <Setter Property="Background"
      Value="Transparent"/>
  <Setter Property="HorizontalContentAlignment"
      Value="{Binding Path=HorizontalContentAlignment,
              RelativeSource={RelativeSource AncestorType={x:Type ItemsControl}}}"/>
  <Setter Property="VerticalContentAlignment"
      Value="{Binding Path=VerticalContentAlignment,
              RelativeSource={RelativeSource AncestorType={x:Type ItemsControl}}}"/>
  <Setter Property="Padding"
      Value="1,0,0,0"/>
  <Setter Property="Foreground"
      Value="{DynamicResource {x:Static SystemColors.ControlTextBrushKey}}"/>
  <Setter Property="FocusVisualStyle"
      Value="{StaticResource TreeViewItemFocusVisual}"/>
  <Setter Property="Template">
    <Setter.Value>
      <ControlTemplate TargetType="{x:Type TreeViewItem}">
        <StackPanel>
            <Border Name="Bd"
              Background="{TemplateBinding Background}"
              BorderBrush="{TemplateBinding BorderBrush}"
              BorderThickness="{TemplateBinding BorderThickness}"
              Padding="{TemplateBinding Padding}">
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="19" />
                    <ColumnDefinition />
                </Grid.ColumnDefinitions>
                  <ToggleButton x:Name="Expander"
                          Style="{StaticResource ExpandCollapseToggleStyle}"
                          IsChecked="{Binding Path=IsExpanded,
                                      RelativeSource={RelativeSource TemplatedParent}}"
                          ClickMode="Press"/>
                <ContentPresenter x:Name="PART_Header"
                            Grid.Column="1"
                          ContentSource="Header"
                          HorizontalAlignment="{TemplateBinding HorizontalContentAlignment}"/>
            </Grid>
          </Border>
          <ItemsPresenter x:Name="ItemsHost" Margin="19,0,0,0" />
        </StackPanel>
        <ControlTemplate.Triggers>
          <Trigger Property="IsExpanded"
               Value="false">
            <Setter TargetName="ItemsHost"
                Property="Visibility"
                Value="Collapsed"/>
          </Trigger>
          <Trigger Property="HasItems"
               Value="false">
            <Setter TargetName="Expander"
                Property="Visibility"
                Value="Hidden"/>
          </Trigger>
          <MultiTrigger>
            <MultiTrigger.Conditions>
              <Condition Property="HasHeader"
                     Value="false"/>
              <Condition Property="Width"
                     Value="Auto"/>
            </MultiTrigger.Conditions>
            <Setter TargetName="PART_Header"
                Property="MinWidth"
                Value="75"/>
          </MultiTrigger>
          <MultiTrigger>
            <MultiTrigger.Conditions>
              <Condition Property="HasHeader"
                     Value="false"/>
              <Condition Property="Height"
                     Value="Auto"/>
            </MultiTrigger.Conditions>
            <Setter TargetName="PART_Header"
                Property="MinHeight"
                Value="19"/>
          </MultiTrigger>
          <Trigger Property="IsSelected"
               Value="true">
            <Setter TargetName="Bd"
                Property="Background"
                Value="{DynamicResource {x:Static SystemColors.HighlightBrushKey}}"/>
            <Setter Property="Foreground"
                Value="{DynamicResource {x:Static SystemColors.HighlightTextBrushKey}}"/>
          </Trigger>
          <MultiTrigger>
            <MultiTrigger.Conditions>
              <Condition Property="IsSelected"
                     Value="true"/>
              <Condition Property="IsSelectionActive"
                     Value="false"/>
            </MultiTrigger.Conditions>
            <Setter TargetName="Bd"
                Property="Background"
                Value="{DynamicResource {x:Static SystemColors.ControlBrushKey}}"/>
            <Setter Property="Foreground"
                Value="{DynamicResource {x:Static SystemColors.ControlTextBrushKey}}"/>
          </MultiTrigger>
          <Trigger Property="IsEnabled"
               Value="false">
            <Setter Property="Foreground"
                Value="{DynamicResource {x:Static SystemColors.GrayTextBrushKey}}"/>
          </Trigger>
        </ControlTemplate.Triggers>
      </ControlTemplate>
    </Setter.Value>
  </Setter>
</Style> 
```

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-03-20T02:13:12.293

如果你的意思是这样的截图

[![TreeView 中的 LineItem 突出显示](https://i.stack.imgur.com/JFr6P.png)](https://i.stack.imgur.com/JFr6P.png)
[（来源：[bendewey.com](http://www.bendewey.com/code/treeViewFullWidth.png)）]

那么这应该可以帮助你。它基于[http://msdn.microsoft.com/en-us/library/ms788727.aspx](http://msdn.microsoft.com/en-us/library/ms788727.aspx)，您可以对 TreeViewItem 的网格布局进行一些更改。基本上你删除第三列。然后在 TreeView 中设置 Horizo​​ntalContentAlignment="Stretch"。我在下面附上了整个资源，但这是重要的部分。

```
<!-- ... -->
<ControlTemplate TargetType="{x:Type TreeViewItem}">
  <Grid>
    <Grid.ColumnDefinitions>
      <ColumnDefinition MinWidth="19"
                Width="Auto"/>
      <ColumnDefinition Width="*"/>
    </Grid.ColumnDefinitions>
    <Grid.RowDefinitions>
      <RowDefinition Height="Auto"/>
      <RowDefinition/>
    </Grid.RowDefinitions>
    <!-- ... --> 
```

**控制**

```
<TreeView Margin="50" HorizontalContentAlignment="Stretch">
    <TreeViewItem Header="test2"/>
    <TreeViewItem Header="test2">
        <TreeViewItem Header="sub test"/>
        <TreeViewItem Header="sub test2"/>
    </TreeViewItem>
    <TreeViewItem Header="test3"/>
</TreeView> 
```

**资源**

```
<SolidColorBrush x:Key="GlyphBrush" Color="#444" />

<!--=================================================================
   TreeViewItem
==================================================================-->
<Style x:Key="ExpandCollapseToggleStyle" TargetType="ToggleButton">
  <Setter Property="Focusable" Value="False"/>
  <Setter Property="Template">
    <Setter.Value>
      <ControlTemplate TargetType="ToggleButton">
        <Grid
          Width="15"
          Height="13"
          Background="Transparent">
          <Path x:Name="ExpandPath"
            HorizontalAlignment="Left" 
            VerticalAlignment="Center" 
            Margin="1,1,1,1"
            Fill="{StaticResource GlyphBrush}"
            Data="M 4 0 L 8 4 L 4 8 Z"/>
        </Grid>
        <ControlTemplate.Triggers>
          <Trigger Property="IsChecked"
               Value="True">
            <Setter Property="Data"
                TargetName="ExpandPath"
                Value="M 0 4 L 8 4 L 4 8 Z"/>
          </Trigger>
        </ControlTemplate.Triggers>
      </ControlTemplate>
    </Setter.Value>
  </Setter>
</Style>
<Style x:Key="TreeViewItemFocusVisual">
  <Setter Property="Control.Template">
    <Setter.Value>
      <ControlTemplate>
        <Border>
          <Rectangle Margin="0,0,0,0"
                 StrokeThickness="5"
                 Stroke="Black"
                 StrokeDashArray="1 2"
                 Opacity="0"/>
        </Border>
      </ControlTemplate>
    </Setter.Value>
  </Setter>
</Style>

<Style x:Key="{x:Type TreeViewItem}"
     TargetType="{x:Type TreeViewItem}">
  <Setter Property="Background"
      Value="Transparent"/>
  <Setter Property="HorizontalContentAlignment"
      Value="{Binding Path=HorizontalContentAlignment,
              RelativeSource={RelativeSource AncestorType={x:Type ItemsControl}}}"/>
  <Setter Property="VerticalContentAlignment"
      Value="{Binding Path=VerticalContentAlignment,
              RelativeSource={RelativeSource AncestorType={x:Type ItemsControl}}}"/>
  <Setter Property="Padding"
      Value="1,0,0,0"/>
  <Setter Property="Foreground"
      Value="{DynamicResource {x:Static SystemColors.ControlTextBrushKey}}"/>
  <Setter Property="FocusVisualStyle"
      Value="{StaticResource TreeViewItemFocusVisual}"/>
  <Setter Property="Template">
    <Setter.Value>
      <ControlTemplate TargetType="{x:Type TreeViewItem}">
        <Grid>
          <Grid.ColumnDefinitions>
            <ColumnDefinition MinWidth="19"
                      Width="Auto"/>
            <ColumnDefinition Width="*"/>
          </Grid.ColumnDefinitions>
          <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition/>
          </Grid.RowDefinitions>
          <ToggleButton x:Name="Expander"
                  Style="{StaticResource ExpandCollapseToggleStyle}"
                  IsChecked="{Binding Path=IsExpanded,
                              RelativeSource={RelativeSource TemplatedParent}}"
                  ClickMode="Press"/>
          <Border Name="Bd"
              Grid.Column="1"
              Background="{TemplateBinding Background}"
              BorderBrush="{TemplateBinding BorderBrush}"
              BorderThickness="{TemplateBinding BorderThickness}"
              Padding="{TemplateBinding Padding}">
            <ContentPresenter x:Name="PART_Header"
                      ContentSource="Header"
                      HorizontalAlignment="{TemplateBinding HorizontalContentAlignment}"/>
          </Border>
          <ItemsPresenter x:Name="ItemsHost"
                  Grid.Row="1"
                  Grid.Column="1"/>
        </Grid>
        <ControlTemplate.Triggers>
          <Trigger Property="IsExpanded" Value="false">
            <Setter TargetName="ItemsHost" Property="Visibility" Value="Collapsed"/>
          </Trigger>
          <Trigger Property="HasItems" Value="false">
            <Setter TargetName="Expander" Property="Visibility" Value="Hidden"/>
          </Trigger>
          <MultiTrigger>
            <MultiTrigger.Conditions>
              <Condition Property="HasHeader" Value="false"/>
              <Condition Property="Width" Value="Auto"/>
            </MultiTrigger.Conditions>
            <Setter TargetName="PART_Header" Property="MinWidth" Value="75"/>
          </MultiTrigger>
          <MultiTrigger>
            <MultiTrigger.Conditions>
              <Condition Property="HasHeader" Value="false"/>
              <Condition Property="Height" Value="Auto"/>
            </MultiTrigger.Conditions>
            <Setter TargetName="PART_Header" Property="MinHeight" Value="19"/>
          </MultiTrigger>
          <Trigger Property="IsSelected" Value="true">
            <Setter TargetName="Bd" Property="Background" Value="{DynamicResource {x:Static SystemColors.HighlightBrushKey}}"/>
            <Setter Property="Foreground" Value="{DynamicResource {x:Static SystemColors.HighlightTextBrushKey}}"/>
          </Trigger>
          <MultiTrigger>
            <MultiTrigger.Conditions>
              <Condition Property="IsSelected" Value="true"/>
              <Condition Property="IsSelectionActive" Value="false"/>
            </MultiTrigger.Conditions>
            <Setter TargetName="Bd" Property="Background" Value="{DynamicResource {x:Static SystemColors.ControlBrushKey}}"/>
            <Setter Property="Foreground" Value="{DynamicResource {x:Static SystemColors.ControlTextBrushKey}}"/>
          </MultiTrigger>
          <Trigger Property="IsEnabled" Value="false">
            <Setter Property="Foreground" Value="{DynamicResource {x:Static SystemColors.GrayTextBrushKey}}"/>
          </Trigger>
        </ControlTemplate.Triggers>
      </ControlTemplate>
    </Setter.Value>
  </Setter>
</Style> 
```

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2009-10-26T21:33:49.740

这是迄今为止最简单的解决方案。只需创建一个矩形，将其命名为 Hb，并将其边距设置为 -100 像素且不可见。仅当您选择它或将鼠标悬停时才将其设置为可见。这是一个 hack，但您最多可以使用 5 个级别的嵌套 TreeViewItems (100 > 19*5)

```
 <ControlTemplate TargetType="{x:Type TreeViewItem}">
  <Grid>
   <Grid.ColumnDefinitions>
    <ColumnDefinition MinWidth="19" Width="Auto"/>
    <ColumnDefinition Width="*"/>
   </Grid.ColumnDefinitions>
   <Grid.RowDefinitions>
    <RowDefinition Height="Auto"/>
    <RowDefinition/>
   </Grid.RowDefinitions>
                        <ToggleButton x:Name="Expander" Style="{StaticResource ExpandCollapseToggleStyle}" IsChecked="{Binding IsExpanded, RelativeSource={RelativeSource TemplatedParent}}" ClickMode="Press" VerticalAlignment="Top" Panel.ZIndex="1"/>
   <Rectangle x:Name="Hb" Width="Auto" Height="Auto" Grid.ColumnSpan="2" Margin="-100,0,0,0" Panel.ZIndex="-1" Visibility="Hidden" />
                        <Border x:Name="Bd" SnapsToDevicePixels="true" BorderThickness="{TemplateBinding BorderThickness}" Padding="{TemplateBinding Padding}" Grid.Column="1" Panel.ZIndex="0">
    <ContentPresenter x:Name="PART_Header" SnapsToDevicePixels="{TemplateBinding SnapsToDevicePixels}" ContentSource="Header" HorizontalAlignment="Stretch"/>
   </Border>
   <ItemsPresenter x:Name="ItemsHost" Grid.Column="0" Grid.Row="1" Grid.ColumnSpan="2" Margin="19,0,0,0"/>
  </Grid> 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-09-24T04:58:05.130

将 TreeView 与 ItemsSource 一起使用时问题的根源是，参考[链接文本](http://social.msdn.microsoft.com/Forums/en-US/wpf/thread/332833fc-11c9-44d7-8d09-ab081ac0f28a)，我更改了 TreeViewItemExtensions 类的一些代码：

```
public static class TreeViewItemExtensions
{
    public static int GetDepth(this TreeViewItem item)
    {
        while (GetSelectedTreeViewItemParent(item) != null)
        {
            var parent = GetSelectedTreeViewItemParent(item);
            if (parent != null)
                return parent.GetDepth() + 1;

            item = parent;
        }
        return 0;
 }

 public static TreeViewItem GetSelectedTreeViewItemParent(this TreeViewItem item)
 {
        DependencyObject parent = VisualTreeHelper.GetParent(item);
        while (!(parent is TreeViewItem || parent is TreeView))
        {
            parent = VisualTreeHelper.GetParent(parent);
        }

        return parent as TreeViewItem;
  }
} 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2010-08-06T21:14:05.643

使用了 theseven7 之类的东西来促进将 Bendewey 的代码与模板化的 TreeViewItems 一起使用......

```
 public static int GetDepth(this TreeViewItem item)
    {
        FrameworkElement elem = item;
        var parent = VisualTreeHelper.GetParent(item);
        var count = 0;
        while (parent != null && !(parent is TreeView))
        {
            var tvi = parent as TreeViewItem;
            if (parent is TreeViewItem)
                count++;
            parent = VisualTreeHelper.GetParent(parent);
        }
        return count;
    } 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2017-09-19T06:41:58.027

对于仅 XAML 的方法，我采用了 Bendewey 的解决方案之一，并将其​​分解为更基本的解决方案：

下面的样式应该允许 Treeview 项目跨越：

```
<Style TargetType="{x:Type TreeViewItem}">           
    <Setter Property="Template">
        <Setter.Value>
            <ControlTemplate TargetType="{x:Type TreeViewItem}">                    
                <Grid>
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition MinWidth="19"
                  Width="Auto"/>
                        <ColumnDefinition Width="*"/>
                    </Grid.ColumnDefinitions>
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition/>
                    </Grid.RowDefinitions>
                    <ToggleButton x:Name="Expander"
              Content="..." 
              IsChecked="{Binding Path=IsExpanded,
                          RelativeSource={RelativeSource TemplatedParent}}"
              ClickMode="Press"/>
                    <Border Name="Bd" Grid.Column="1" Background="Red" Padding="3">
                        <ContentPresenter x:Name="PART_Header"   ContentSource="Header"
                  HorizontalAlignment="{TemplateBinding HorizontalContentAlignment}"/>
                    </Border>
                    <ItemsPresenter x:Name="ItemsHost"  Grid.Row="1"   Grid.Column="1"/>
                </Grid>  
      <!-- ADD TRIGGERS HERE -->                                  
            </ControlTemplate>
        </Setter.Value>
    </Setter>
</Style> 
```

为了让它像正确的 Treeview 一样操作和折叠，下面的触发器应该允许这样做：

```
<ControlTemplate.Triggers>                                          
                    <MultiTrigger>
                        <MultiTrigger.Conditions>
                            <Condition Property="HasHeader" Value="false"/>
                            <Condition Property="Width" Value="Auto"/>
                        </MultiTrigger.Conditions>                            
                    </MultiTrigger>
                    <MultiTrigger>
                        <MultiTrigger.Conditions>
                            <Condition Property="HasHeader" Value="false"/>
                            <Condition Property="Height" Value="Auto"/>
                        </MultiTrigger.Conditions>                          
                    </MultiTrigger>                        
                    <MultiTrigger>
                        <MultiTrigger.Conditions>
                            <Condition Property="IsSelected" Value="true"/>
                            <Condition Property="IsSelectionActive" Value="false"/>
                        </MultiTrigger.Conditions>                                             
                    </MultiTrigger>
                    <Trigger Property="IsSelected" Value="true">
                        <Setter TargetName="Bd" Property="Background" Value="Blue"/>                           
                    </Trigger>
                    <Trigger Property="HasItems" Value="false">
                        <Setter TargetName="Expander" Property="Visibility" Value="Hidden"/>
                    </Trigger>
                    <Trigger Property="IsExpanded"   Value="false">
                        <Setter TargetName="ItemsHost"
                                Property="Visibility"
                                Value="Collapsed"/>
                    </Trigger>
</ControlTemplate.Triggers> 
```

只需将触发器嵌套在控制模板中。颜色/填充/设计将需要调整以适合您自己的需求，但以上应该是仅基于 XAML 的一个非常基本的想法。

* * *

## 回答 #9

> 赞同：-1
> 
> 时间：2013-04-10T17:26:43.737

我通过使用 blend 复制 ItemContainerStyle 来管理这个，为放置项目的网格命名，然后设置网格的背景。

# language-agnostic - 电影和剧集的基类有什么好名字？

> ID：664644
> 
> 赞同：1
> 
> 时间：2009-03-20T01:11:29.120
> 
> 标签：language-agnostic, refactoring

我一直在重构媒体浏览器并开始为我们的域对象定义一个适当的继承模型

所以我有

```
BaseItem
-> Video
--> <Need a name for this>
---> Episode
---> Movie
-> Folder
--> Season 
```

本质上，电视节目剧集和电影有一些共同的属性（如演员或导演列表），所以我需要这个通用基类的名称。

我不想在 Video 基类中放弃它，因为你在相机上录制的 mpeg 之类的东西没有演员或导演，所以它们只是视频......

任何有关名称的帮助将不胜感激..

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-20T01:16:52.930

生产？

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-20T01:28:03.620

好吧，用简单的英语，我总是把它们叫做节目。“要去剧院看一场演出。” “你在历史频道上看到那个节目了吗？”

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-20T01:15:29.250

我相当确定电视/有线电视行业对此有一个术语，因为为特定日期安排频道的阵容涉及安排这些 X（故事片和节目剧集）。我不确定这个词在英语中是什么意思。我以为是节目或广播，但我认为它更笼统。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-20T02:41:35.423

我绝对同意@Richard，但我建议您跳过额外级别的“视频”并将其替换为“节目”......如果主要方面是保持用户友好。

但是，我认为主要问题是您混淆了**文件夹结构**（用户界面结构）和**类继承**（内部结构）。

如果仅用于代码，您可以拥有类似的东西（仅作为示例，这些术语可能只是编造的）：

```
Media (ICollectionItem)
    Video
        Film
        Program
    Sound
        Sample
        Recording

Collection (ICollection) 
```

但是您仍然可以将其显示给用户：

```
Shows [Collection]
    Film [Film]
    Series [Collection]
        Episode [Program]
Music [Collection]
    Recordings [Collection]
        CDS [Recording]
        Vinyls [Recording]
    Sample Compilations [Collection]
        Sample [Sample] 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-20T03:19:16.567

来自电视行业的常用术语通常是：

*   广播公司（YTV、Teletoon 等）
    *   系列（Ben 10、Total Drama Island 等）
        *   情节（1：飞行员，2：最大的错误，3：落水等）
            *   特点
                *   演员（扮演或配音角色）
            *   导向器
            *   等等

在我看来，将你的演员存储在剧集中并不是什么大不了的事，因为你总是可以使用 Series 上的方法或属性来整合它们以获取所有演员。例如：

```
allActorsInSeries = Series.Actors; 
```

这种格式仍然可以应用于故事片，因为剧集只是代表电影及其续集。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-20T01:17:04.987

剧集和电影具有共同的专业制作，而不是您个人制作的视频的外部案例。ReleaseVideo 或 CommercialVideo 怎么样？

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-03-20T01:22:53.447

媒体项目？

甚至可以交换 MediaItem 和 Video，以便您可以将其扩展到音频？

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-03-20T01:24:54.937

想到什么：

*   分发（这也可以让您拥有专业和电枢）
*   广播（不是真的，但可能会让你有其他想法）

# ruby - 您可以为现有的 gem 安装文档吗？

> ID：664651
> 
> 赞同：12
> 
> 时间：2009-03-20T01:13:41.673
> 
> 标签：ruby, rubygems, rdoc

Rubyinside 提到[了一篇](http://buddingrubyist.com/2009/02/14/how-to-speed-up-gem-installs-10x/)关于如何通过不安装 RI 或 RDoc 来加速 gem 安装的博客文章。

是否可以安装一个 gem，然后在以后安装文档，这样您就可以在闲暇时匆忙破解和 RTFM？

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2009-03-20T01:37:05.597

```
> gem help rdoc

Usage: gem rdoc [args] [options]
Options:
      --all                        Generate RDoc/RI documentation for all
                                   installed gems
      --[no-]rdoc                  Include RDoc generated documents
      --[no-]ri                    Include RI generated documents
  -v, --version VERSION            Specify version of gem to rdoc
Arguments:
  GEMNAME       gem to generate documentation for (unless --all)
Summary:
  Generates RDoc for pre-installed gems
Defaults:
  --version '>= 0' --rdoc --ri 
```

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2012-10-24T12:14:33.880

如果您运行`gem rdoc --all`它，它将为您的所有 gem 生成文档。

您还可以使用以下命令为捆绑包中的 gem 生成文档：

```
bundle list | egrep '\*' | sed -e 's/* \(.*\) (.*)/\1/g' | xargs -n 1 gem rdoc 
```

您可能需要适应您的需求，以及如果 bundle 更改其输出格式。

# iphone - 备份 2-4 个以前的视图

> ID：664653
> 
> 赞同：2
> 
> 时间：2009-03-20T01:16:01.183
> 
> 标签：iphone, uitableview

我正在编写一个标准的表格视图应用程序，其中包含层次结构中的多个视图。当我点击了 3-4 个视图时，有没有办法回到顶视图？我尝试加载它，但后来我失去了层次结构。

我知道这个命令会让我返回 1 个视图，这就是“返回”按钮的作用：

```
[self.navigationController popViewControllerAnimated:YES]; 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-20T06:37:21.270

您可以使用 popToRootViewControllerAnimated: 或 popToViewController:animated: 方法。

要获取需要跳转到的viewcontroller，从数组中的navcontroller 中获取所有viewcontroller 的列表，然后从这个数组中选择viewcontroller。

即，如果您的层次结构是 svc->svc2->vc1->vc2->vc3->vc4 并且您想从 vc4 回到 vc1，请执行此操作

```
NSArray *viewControllers = [[self navigationController] viewControllers];
UIViewController *controller = [viewControllers objectAtIndex:2];
[[self navigationController] popToViewController:controller animated:YES]; 
```

# asp.net-mvc - 在页面开始呈现之前注入 JQuery 的任何巧妙而巧妙的方法？

> ID：664659
> 
> 赞同：0
> 
> 时间：2009-03-20T01:17:02.117
> 
> 标签：asp.net-mvc, webforms, web-config

我希望以某种方式将 jQuery 插入到每个页面中，并且编写*最少*的代码......换句话说，我不想`<script language="javascript" src="PATH TO JQUERY"></script>`在每个 aspx 页面上编写。

到目前为止，我已经考虑过使用基类并将“Response.Write”插入“页面加载”事件。除此之外，我的其他选择是什么... web.config？别的东西？

Webforms/MVC 解决方案的奖励积分。感谢您的任何建议。

[编辑：在http://www.codeproject.com/KB/aspnet/scriptregister.aspx](http://www.codeproject.com/KB/aspnet/scriptregister.aspx)找到了我喜欢的答案 作者和我一样，由于各种原因不喜欢 ClientScript.RegisterClientScriptBlock 的标准实现（比如 MSFT 坚持FORM runat=server 标签）并构建了一个更好的捕鼠器。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-20T02:21:42.650

Use MasterPages and put it **at the top**. Some people say put it at the bottom but after the first time it's loaded it cached anyways and if you are going to manipulate the DOM I personally would rather do it before my user really starts to see the page being rendered. Having it at the bottom could definitely cause this to happen and could be confusing to the user and result in a bad user experience.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-20T02:20:44.413

You can hook to any event of the page life cycle in the global asax:

```
void Application_PreRequestHandlerExecute(object sender, EventArgs e)
{
    Page page = this.Context.CurrentHandler as Page;
    if( page != null )
        page.Load += new EventHandler(page_Load);
}

void page_Load(object sender, EventArgs e)
{
    Page page = (Page)this.Context.CurrentHandler;
    page.ClientScript.RegisterClientScriptInclude("jquery", jqueryurl);
} 
```

Ps. I think you can do this with an http module as well.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-20T01:26:07.167

如果您已经包括

```
<html><head><title>Title</title></head><body>...</body></html> 
```

在每一页，我相信你可以挤进一个

```
<script ...></script> 
```

但我仍然同意 Ken 的观点：看看母版页。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-20T01:29:54.770

不知道您是架构师，这可能很难笼统地回答。

但是，我可以建议，如果您最终不得不修改所有页面，将它们设置为使用包含，您是否必须更新您的 jquery 版本或添加 $(document).ready() 函数或添加任何 jquery插件的，你可以修改包含而不必重新修改所有页面。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-20T02:16:33.707

The [best practice](http://developer.yahoo.net/blog/archives/2007/07/high_performanc_5.html) is to load javascript at the **bottom** of your pages to prevent your script slowing your initial page load.

Since you've also specifically mentioned jquery I would recommend using this code towards the end of your masterpage:

```
<script src="http://www.google.com/jsapi"></script>
<script>
  // Load jQuery
    google.load("jquery", "1");
</script> 
```

The advantage of this is that your users will probably already have this copy of jquery cached in their browser, and you'll always be using the latest version to boot :)

If you're using a masterpage, you won't need to have the script "inserted into every page".

# .net - WCF 中的 MSMQ 绑定与 WsHttp 有何不同？

> ID：664664
> 
> 赞同：1
> 
> 时间：2009-03-20T01:18:31.803
> 
> 标签：.net, wcf, msmq, wcf-binding

我正在尝试了解 WCF 中的 MSMQ 绑定，并想知道它与 BasicHttp 或 WsHttp 的配置有何不同？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-20T03:13:44.067

最大的区别是对服务的请求必须是单向的（即发即弃），因为不能保证它们会在另一端得到处理。另一个明显的区别是您需要确保在使用前配置队列。

查看MSDN 上的[“在 WCF 中排队”以获取更多信息。](http://msdn.microsoft.com/en-us/library/ms789048.aspx)

# c# - 如何实施密码重置？

> ID：664673
> 
> 赞同：81
> 
> 时间：2009-03-20T01:23:20.013
> 
> 标签：c#, asp.net, asp.net-mvc, security

我正在 ASP.NET 中开发一个应用程序，并且想知道`Password Reset`如果我想自己实现一个功能，我该如何实现。

具体来说，我有以下问题：

*   生成难以破解的唯一 ID 的好方法是什么？
*   它应该有一个计时器吗？如果是这样，应该多长时间？
*   我应该记录IP地址吗？这还重要吗？
*   我应该在“密码重置”屏幕下询问哪些信息？只是电子邮件地址？或者可能是电子邮件地址加上他们“知道”的一些信息？（最喜欢的球队，小狗的名字等）

还有其他需要注意的事项吗？

> **注意**：[其他问题](https://stackoverflow.com/questions/522967/forgot-password-what-is-the-best-method-of-implementing-a-forgot-password-functi)完全[掩盖了](https://stackoverflow.com/questions/270485/password-management-best-practices-soup-to-nuts-not-just-storage-or-generation)技术实施。事实上，公认的答案掩盖了血腥的细节。我希望这个问题和随后的答案将进入血腥的细节，我希望通过更狭窄地表述这个问题，答案是更少的“绒毛”和更多的“血腥”。

**编辑**：还涉及如何在 SQL Server 或任何 ASP.NET MVC 链接中对此类表进行建模和处理的答案将不胜感激。

* * *

## 回答 #1

> 赞同：67
> 
> 时间：2009-03-30T20:29:21.127

编辑 2012/05/22：作为这个流行答案的后续，我自己在这个过程中不再使用 GUID。像其他流行的答案一样，我现在使用自己的散列算法来生成要在 URL 中发送的密钥。这也具有更短的优点。查看 System.Security.Cryptography 来生成它们，我通常也使用 SALT。

## 首先，不要立即重置用户密码。

首先，不要在用户请求时立即重置用户密码。这是一个安全漏洞，因为有人可能会猜测电子邮件地址（即您在公司的电子邮件地址）并随心所欲地重置密码。这些天的最佳实践通常包括发送到用户电子邮件地址的“确认”链接，确认他们想要重置它。此链接是您要发送唯一密钥链接的位置。我用如下链接发送我的：`domain.com/User/PasswordReset/xjdk2ms92`

是的，在链接上设置一个超时并将密钥和超时存储在您的后端（如果您使用的是盐，则保存）。3 天的超时是常态，请确保在用户请求重置时在 Web 级别通知用户 3 天。

## 使用唯一的哈希键

我之前的回答说要使用 GUID。我现在正在编辑它以建议大家使用随机生成的哈希，例如使用`RNGCryptoServiceProvider`. 并且，确保从散列中消除任何“真实单词”。我记得早上 6 点的一个特殊电话，一位女士在她的“假设是随机的”散列密钥中收到了某个“c”字，这是开发人员所做的。嗬！

## 整个过程

*   用户点击“重置”密码。
*   要求用户提供电子邮件。
*   用户输入电子邮件并单击发送。不要确认或拒绝电子邮件，因为这也是不好的做法。简单地说，“如果电子邮件经过验证，我们已发送密码重置请求。” 或类似的神秘事物。
*   您从 中创建哈希`RNGCryptoServiceProvider`，将其作为单独的实体存储在`ut_UserPasswordRequests`表中并链接回用户。因此，您可以跟踪旧请求并通知用户旧链接已过期。
*   将链接发送到电子邮件。

用户获取链接，如`http://domain.com/User/PasswordReset/xjdk2ms92`，并单击它。

如果链接经过验证，您将要求输入新密码。很简单，用户可以设置自己的密码。或者，在此处设置您自己的密码，并在此处告知他们的新密码（并通过电子邮件发送给他们）。

* * *

## 回答 #2

> 赞同：66
> 
> 时间：2009-04-02T21:55:24.103

这里有很多好的答案，我不会费心重复这一切......

除了一个问题，这里几乎每个答案都重复了这个问题，即使它是错误的：

> 指南（实际上）是唯一的，并且在统计上是无法猜测的。

这不是真的，GUID 是非常弱的标识符，**不**应该用于允许访问用户的帐户。
如果您检查结构，您最多可以得到 128 位......现在这并不多。
其中前半部分是典型的不变（对于生成系统），剩下的一半是时间相关的（或其他类似的）。
总而言之，它是一个非常薄弱且容易被暴力破解的机制。

所以不要用那个！

相反，只需使用加密强的随机数生成器 ( `System.Security.Cryptography.RNGCryptoServiceProvider`)，并获得至少 256 位的原始熵。

其余所有，正如提供的许多其他答案一样。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2009-03-30T19:58:25.740

首先，我们需要知道您对用户的了解。显然，您有一个用户名和一个旧密码。你还知道什么？你有电子邮件地址吗？你有关于用户最喜欢的花的数据吗？

假设您有一个用户名、密码和工作电子邮件地址，您需要向您的用户表（假设它是一个数据库表）添加两个字段：一个名为 new_passwd_expire 的日期和一个字符串 new_passwd_id。

假设您有用户的电子邮件地址，当有人请求重置密码时，您更新用户表如下：

```
new_passwd_expire = now() + some number of days
new_passwd_id = some random string of characters (see below) 
```

接下来，您向该地址的用户发送电子邮件：

> 亲爱的某某
> 
> 有人在 <您的网站名称> 处请求用户帐户 <用户名> 的新密码。如果您确实要求重置密码，请点击以下链接：
> 
> [http://example.com/yourscript.lang?update=<new_password_id](http://example.com/yourscript.lang?update=<new_password_id) >
> 
> 如果该链接不起作用，您可以访问[http://example.com/yourscript.lang](http://example.com/yourscript.lang)并在表单中输入以下内容：<new_password_id>
> 
> 如果您没有请求重置密码，您可以忽略此电子邮件。
> 
> 谢谢，亚达亚达

现在，编码 yourscript.lang：这个脚本需要一个表单。如果 var 更新在 URL 上传递，则表单只询问用户的用户名和电子邮件地址。如果更新没有通过，它会询问用户名、电子邮件地址和电子邮件中发送的 id 代码。您还要求输入新密码（当然是两次）。

要验证用户的新密码，您需要验证用户名、电子邮件地址和 id 代码都匹配、请求未过期以及两个新密码匹配。如果成功，您将用户密码更改为新密码并从用户表中清除密码重置字段。还要确保注销用户/清除任何与登录相关的 cookie 并将用户重定向到登录页面。

本质上，new_passwd_id 字段是一个仅在密码重置页面上有效的密码。

一项潜在的改进：您可以从电子邮件中删除 <username>。“有人请求重置此电子邮件地址的帐户的密码......”因此，如果电子邮件被截获，则只有用户知道用户名。我不是这样开始的，因为如果有人在攻击该帐户，他们已经知道用户名。这种增加的隐蔽性可以阻止中间人攻击机会，以防有人恶意拦截电子邮件。

至于你的问题：

生成随机字符串：它不需要非常随机。任何 GUID 生成器甚至 md5(concat(salt,current_timestamp())) 就足够了，其中 salt 是用户记录上的内容，例如创建时间戳帐户。它必须是用户看不到的东西。

计时器：是的，你需要这个只是为了保持你的数据库健全。不超过一周确实是必要的，但至少需要 2 天，因为您永远不知道电子邮件延迟可能会持续多长时间。

IP 地址：由于电子邮件可能会延迟几天，因此 IP 地址仅用于记录，不用于验证。如果你想记录它，就这样做，否则你不需要它。

重置屏幕：见上文。

希望涵盖它。祝你好运。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-03-20T17:55:38.097

发送到记录的电子邮件地址的 GUID 可能足以满足大多数普通应用程序的需要 - 超时甚至更好。

毕竟，如果用户的邮箱被盗（即黑客拥有该电子邮件地址的登录名/密码），您对此无能为力。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-03-20T01:29:47.953

您可以通过链接向用户发送电子邮件。此链接将包含一些难以猜测的字符串（如 GUID）。在服务器端，您还将存储与发送给用户相同的字符串。现在，当用户按下链接时，您可以在您的数据库条目中找到具有相同秘密字符串并重置其密码。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-03-30T20:11:50.700

1) 要生成唯一 id，您可以使用安全哈希算法。2) 附定时器？您的意思是重置密码链接的到期吗？是的，您可以设置 Expiry 3）您可以要求提供除 emailId 以外的更多信息来验证。例如出生日期或一些安全问题 4）您还可以生成随机字符并要求与请求一起输入..确保密码请求不会被某些间谍软件或类似的东西自动生成..

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2018-09-17T14:41:20.180

我认为 Microsoft ASP.NET Identity 指南是一个好的开始。

[https://docs.microsoft.com/en-us/aspnet/identity/overview/features-api/account-confirmation-and-password-recovery-with-aspnet-identity](https://docs.microsoft.com/en-us/aspnet/identity/overview/features-api/account-confirmation-and-password-recovery-with-aspnet-identity)

我用于 ASP.NET 标识的代码：

网络配置：

```
<add key="AllowedHosts" value="example.com,example2.com" /> 
```

AccountController.cs：

```
[Route("RequestResetPasswordToken/{email}/")]
[HttpGet]
[AllowAnonymous]
public async Task<IHttpActionResult> GetResetPasswordToken([FromUri]string email)
{
    if (!ModelState.IsValid)
        return BadRequest(ModelState);

    var user = await UserManager.FindByEmailAsync(email);
    if (user == null)
    {
        Logger.Warn("Password reset token requested for non existing email");
        // Don't reveal that the user does not exist
        return NoContent();
    }

    //Prevent Host Header Attack -> Password Reset Poisoning. 
    //If the IIS has a binding to accept connections on 80/443 the host parameter can be changed.
    //See https://security.stackexchange.com/a/170759/67046
    if (!ConfigurationManager.AppSettings["AllowedHosts"].Split(',').Contains(Request.RequestUri.Host)) {
            Logger.Warn($"Non allowed host detected for password reset {Request.RequestUri.Scheme}://{Request.Headers.Host}");
            return BadRequest();
    }

    Logger.Info("Creating password reset token for user id {0}", user.Id);

    var host = $"{Request.RequestUri.Scheme}://{Request.Headers.Host}";
    var token = await UserManager.GeneratePasswordResetTokenAsync(user.Id);
    var callbackUrl = $"{host}/resetPassword/{HttpContext.Current.Server.UrlEncode(user.Email)}/{HttpContext.Current.Server.UrlEncode(token)}";

    var subject = "Client - Password reset.";
    var body = "<html><body>" +
               "<h2>Password reset</h2>" +
               $"<p>Hi {user.FullName}, <a href=\"{callbackUrl}\"> please click this link to reset your password </a></p>" +
               "</body></html>";

    var message = new IdentityMessage
    {
        Body = body,
        Destination = user.Email,
        Subject = subject
    };

    await UserManager.EmailService.SendAsync(message);

    return NoContent();
}

[HttpPost]
[Route("ResetPassword/")]
[AllowAnonymous]
public async Task<IHttpActionResult> ResetPasswordAsync(ResetPasswordRequestModel model)
{
    if (!ModelState.IsValid)
        return NoContent();

    var user = await UserManager.FindByEmailAsync(model.Email);
    if (user == null)
    {
        Logger.Warn("Reset password request for non existing email");
        return NoContent();
    }            

    if (!await UserManager.UserTokenProvider.ValidateAsync("ResetPassword", model.Token, UserManager, user))
    {
        Logger.Warn("Reset password requested with wrong token");
        return NoContent();
    }

    var result = await UserManager.ResetPasswordAsync(user.Id, model.Token, model.NewPassword);

    if (result.Succeeded)
    {
        Logger.Info("Creating password reset token for user id {0}", user.Id);

        const string subject = "Client - Password reset success.";
        var body = "<html><body>" +
                   "<h1>Your password for Client was reset</h1>" +
                   $"<p>Hi {user.FullName}!</p>" +
                   "<p>Your password for Client was reset. Please inform us if you did not request this change.</p>" +
                   "</body></html>";

        var message = new IdentityMessage
        {
            Body = body,
            Destination = user.Email,
            Subject = subject
        };

        await UserManager.EmailService.SendAsync(message);
    }

    return NoContent();
}

public class ResetPasswordRequestModel
{
    [Required]
    [Display(Name = "Token")]
    public string Token { get; set; }

    [Required]
    [Display(Name = "Email")]
    public string Email { get; set; }

    [Required]
    [StringLength(100, ErrorMessage = "The {0} must be at least {2} characters long.", MinimumLength = 10)]
    [DataType(DataType.Password)]
    [Display(Name = "New password")]
    public string NewPassword { get; set; }

    [DataType(DataType.Password)]
    [Display(Name = "Confirm new password")]
    [Compare("NewPassword", ErrorMessage = "The new password and confirmation password do not match.")]
    public string ConfirmPassword { get; set; }
} 
```

# c# - C# 4 可选参数

> ID：664678
> 
> 赞同：1
> 
> 时间：2009-03-20T01:25:53.517
> 
> 标签：c#, optional-parameters

C# 4 可选参数实现是否与 VB.NET 一样，可选参数是在调用站点编译的（会导致版本控制问题）？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-20T01:33:14.573

[是](http://bartdesmet.net/blogs/bart/archive/2008/10/31/c-4-0-feature-focus-part-1-optional-parameters.aspx)的。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-20T01:31:56.933

根据 SamNg 的说法，[C# 的默认参数是在调用站点编译的](http://blogs.msdn.com/samng/archive/2009/02/03/named-arguments-optional-arguments-and-default-values.aspx)，类似于 C++ 中的默认参数。

是的，它会导致版本控制问题。但是，应该在有意义的地方使用可选参数。在许多情况下，这意味着将`null`类或默认构造的类传递给方法或构造函数。

# c# - 我应该在 LINQ 查询中使用两个“where”子句还是“&&”？

> ID：664683
> 
> 赞同：79
> 
> 时间：2009-03-20T01:27:56.973
> 
> 标签：c#, .net, linq

在编写具有多个“和”条件的 LINQ 查询时，我应该编写一个`where`包含多个子句的子句`&&`还是多个`where`子句，每个条件一个子句？

```
static void Main(string[] args)
{
    var ints = new List<int>(Enumerable.Range(-10, 20));

    var positiveEvensA = from i in ints
                         where (i > 0) && ((i % 2) == 0)
                         select i;

    var positiveEvensB = from i in ints
                         where i > 0
                         where (i % 2) == 0
                         select i;

    System.Diagnostics.Debug.Assert(positiveEvensA.Count() == 
                                         positiveEvensB.Count());
} 
```

*positiveEvensA*和*positiveEvensB*之间除了个人偏好或编码风格（长线、可读性等）之外还有什么不同吗？

想到的一个可能的区别是，不同的 LINQ 提供程序可能能够更好地处理多个`where`s 而不是更复杂的表达式；这是真的？

* * *

## 回答 #1

> 赞同：55
> 
> 时间：2009-03-20T02:33:27.347

只要不会使语句难以理解，我个人总是会使用 && 与两个 where 子句。

在您的情况下，它可能根本不会引起注意，但是如果您有一个大型集合，并且如果您使用此查询的所有结果，那么拥有 2 个 where 子句肯定会对性能产生影响。例如，如果您对结果调用 .Count() 或遍历整个列表，则第一个 where 子句将运行，创建一个新的 IEnumerable<T> ，它将再次被完全枚举，并带有第二个委托。

将 2 个子句链接在一起会导致查询形成单个委托，该委托在枚举集合时运行。这会导致对集合进行一次枚举，并在每次返回结果时调用一次委托。

如果你把它们分开，事情就会改变。当您的第一个 where 子句枚举原始集合时，第二个 where 子句枚举其结果。这可能会导致（最坏的情况）通过您的集合进行 2 个完整的枚举，并且每个成员调用 2 个委托，这可能意味着该语句（理论上）可能需要 2 倍的运行时速度。

如果您决定使用 2 个 where 子句，首先放置限制性更强的子句会有很大帮助，因为第二个 where 子句仅在通过第一个 where 子句的元素上运行。

现在，在你的情况下，这无关紧要。在大型收藏中，它可以。作为一般经验法则，我选择：

1.  可读性和可维护性

2.  表现

在这种情况下，我认为这两个选项都同样可维护，所以我会选择性能更高的选项。

* * *

## 回答 #2

> 赞同：25
> 
> 时间：2009-03-20T01:31:58.400

这主要是个人风格问题。就个人而言，只要`where`条款适合一行，我就会将条款分组。

使用多个`where`s 往往会降低性能，因为它需要对每个元素进行额外的委托调用，使其达到那么远。然而，这可能是一个无关紧要的问题，只有在分析器显示它是一个问题时才应考虑。

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2016-02-26T16:48:53.720

性能问题仅适用于基于内存的集合... Linq to SQL 生成延迟执行的表达式树。更多细节在这里：

[具有 LINQ 扩展方法的多个 WHERE 子句](https://stackoverflow.com/questions/8791540/multiple-where-clauses-with-linq-extension-methods)

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2021-07-09T17:09:38.373

正如 Jared Par 已经说过的：这取决于您的个人偏好、可读性和用例。例如，如果您的方法有一些可选参数，并且您想在给定的情况下过滤集合，那么`Where`完美：

```
IEnumerable<SomeClass> matchingItems = allItems;
if(!string.IsNullOrWhiteSpace(name))
    matchingItems = matchingItems
       .Where(c => c.Name == name);
if(date.HasValue)
    matchingItems = matchingItems
       .Where(c => c.Date == date.Value);
if(typeId.HasValue)
    matchingItems = matchingItems
       .Where(c => c.TypeId == typeId.Value);
return matchingItems; 
```

如果你想这样做`&&`，玩得开心；）

我不同意[Jared](https://stackoverflow.com/a/664692/284240)和[Reed](https://stackoverflow.com/a/664805/284240)的地方是多个`Where`应该有的性能问题。实际上，它以一种将多个谓词组合为一个的方式进行了优化，如您[在此处](https://referencesource.microsoft.com/#System.Core/System/Linq/Enumerable.cs,e11d6842eee7c2e6)（在 中）`Where`所见。`CombinePredicates`

但是我想知道如果集合很大并且有多个`Where`都必须进行评估，它是否真的没有太大影响。我很惊讶下面的[基准测试](https://benchmarkdotnet.org/)显示，即使是多重`Where`方法也稍微更有效。摘要：

| 方法 | 意思是 | 错误 | 标准差 |
| --- | --- | --- | --- |
| 多处 | 1.555 秒 | 0.0310 秒 | 0.0392 秒 |
| 多重与 | 1.571 秒 | 0.0308 秒 | 0.0649 秒 |

这是基准代码，我认为它对于这个测试来说已经足够了：

```
#LINQPad optimize+

void Main()
{
    var summary = BenchmarkRunner.Run<WhereBenchmark>();
}

public class WhereBenchmark
{
    string[] fruits = new string[] { "apple", "mango", "papaya", "banana", "guava", "pineapple" };
    private IList<string> longFruitList;

    [GlobalSetup]
    public void Setup()
    {
        Random rnd = new Random();
        int size = 1_000_000;
        longFruitList = new List<string>(size);
        for (int i = 1; i < size; i++)
            longFruitList.Add(GetRandomFruit());

        string GetRandomFruit()
        {
            return fruits[rnd.Next(0, fruits.Length)];
        }
    }

    [Benchmark]
    public void MultipleWhere()
    {
        int count = longFruitList
            .Where(f => f.EndsWith("le"))
            .Where(f => f.Contains("app"))
            .Where(f => f.StartsWith("pine"))
            .Count(); // counting pineapples
    }

    [Benchmark]
    public void MultipleAnd()
    {
        int count = longFruitList
            .Where(f => f.EndsWith("le") && f.Contains("app") && f.StartsWith("pine"))
            .Count(); // counting pineapples
    }
} 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-27T13:40:32.147

就像其他人建议的那样，这更多是个人喜好。我喜欢 && 的使用，因为它更具可读性并且模仿了其他主流语言的语法。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2021-09-19T19:19:58.157

如果您运行 SQL Profiler 并检查生成的查询，您可以看到两种查询在性能方面没有区别。所以，只是你对代码风格的品味。

# javascript - 来自 Bookmarklet 的 Ajax 调用

> ID：664689
> 
> 赞同：9
> 
> 时间：2009-03-20T01:31:08.090
> 
> 标签：javascript, ajax, bookmarklet

我正在尝试创建一个书签，单击该书签会向用户请求一些信息（在这种情况下为 url 和几个其他字段），然后将该数据发送到我服务器上的 php 页面，然后显示结果。

我想为此做一个 Ajax 调用，这样我实际上就不会重定向到新页面，只是获取数据，但我认为我会遇到 Ajax 的“同源策略”限制......有没有基本上做同样事情的已知方法？

另外，传递参数的最佳方法是什么？我已经有一种机制可以从表单中接收参数作为发布消息...有什么办法可以重用它吗？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-03-22T11:08:33.973

您可以通过创建书签来设置书签，并在下面的位置添加该段代码，但是，根据[同源策略限制](https://developer.mozilla.org/En/Same_origin_policy_for_JavaScript)，这仅在当前标签位于同一位置时才有效，此处为[www.google.com](http://www.google.com)。

如果我很好地理解了您的需求，那应该可以解决您的问题。

```
var request = new XMLHttpRequest();
request.open("GET", "http://www.google.com", true);
request.onreadystatechange = function() {
  var done = 4, ok = 200;
  if (request.readyState == done && request.status == ok) {
    if (request.responseText) {
      alert(request.responseText);
    }
  }
};
request.send(null); 
```

我不知道 POST 是否可行。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-20T01:41:04.960

您将无法发布帖子，但 GET 可以正常工作。如果您使用 jQuery 之类的东西，它会简单地创建一个带有 src URL 的脚本标签，该标签将发送您要提交的数据。

您必须返回 JSON 样式数据。

请参阅：[http ://docs.jquery.com/Ajax/jQuery.getJSON](http://docs.jquery.com/Ajax/jQuery.getJSON)

或者，您的书签可以在页面上创建一个 iframe，如果您不想在 iframe 和页面本身之间进行通信，而只是使用 user输入提交。

# unix - 您如何解决命名管道的问题？

> ID：664694
> 
> 赞同：0
> 
> 时间：2009-03-20T01:33:13.420
> 
> 标签：unix, shell, named-pipes, svm

我有一个二进制程序*，它获取所提供文件的内容，对其进行处理，并通过标准输出在屏幕上打印结果。对于自动化脚本，我想使用命名管道将数据发送到该程序并自己处理输出。在尝试让脚本工作后，我意识到二进制程序从命名管道接受数据存在问题。为了说明这个问题，我概述了几个使用 unix shell 的测试。

1.  很容易证明程序通过处理实际数据文件来工作。

    ```
    $ binprog file.txt > output.txt 
    ```

    这将导致 output.txt 包含来自 file.txt 的已处理信息。

2.  如本演示所示，命名管道 (pipe.txt) 的工作原理。

    ```
    $ cat pipe.txt > output.txt
    $ cat file.txt > pipe.txt 
    ```

    这将导致 output.txt 在通过管道发送后包含来自 file.txt 的数据。

3.  当二进制程序从命名管道而不是文件读取时，事情不能正常工作。

    ```
    $ binprog pipe.txt > output.txt
    $ cat file.txt > pipe.txt 
    ```

    在这种情况下，即使 cat 和 binprog 终止， output.txt 也不包含任何数据。使用 top 和 ps，我可以看到 binprog “运行”并且似乎在工作。一切都执行没有错误。

为什么在第三个示例中 binprog 没有输出？

我可以尝试哪些事情来使它正常工作？

[[*] 有问题的程序是来自libsvm](http://www.csie.ntu.edu.tw/~cjlin/libsvm/ "libsvm")的 svm-scale 。我选择概括示例以保持它们的简洁。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-20T01:48:42.633

您确定该程序可以使用管道吗？如果它需要随机访问输入文件，它将无法工作。每当程序尝试在输入文件中查找时，都会出错。

如果您知道该程序旨在使用管道，并且您正在使用 bash，则可以使用进程替换来避免必须显式创建命名管道。

```
binprog <(cat file.txt) > output.txt 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-20T01:38:40.333

binprog 是否也接受标准输入上的输入？如果是这样，这可能对你有用。

```
cat pipe.txt | binprog > output.txt
cat file.txt > pipe.txt 
```

**编辑：**简要扫描了 svm-scale 的联机帮助页。试一试：

```
cat pipe.txt | svm-scale - > output.txt 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-20T03:16:17.557

如果`binprog`除了终端作为输入之外的任何东西都不能很好地工作，也许你需要给它一个（伪）终端（pty）作为它的输入。这更难组织，但该`expect`程序是相对容易地做到这一点的一种方式。W Richard Stevens 和 Stephen A Rago的[Advanced Programming in the Unix Env​​ironment, 3rd Edn](https://rads.stackoverflow.com/amzn/click/com/0321637739)和Marc J Rochkind的[Advanced Unix Programming, 2nd Edn](https://rads.stackoverflow.com/amzn/click/com/0131411543)中讨论了使用 pty 进行 编程。

要查看的其他内容是`truss`or`strace`或本地等效项的输出。这些程序记录一个进程进行的所有系统调用。在 Solaris 上，我会运行：

```
truss -o binprog.truss binprog 
```

交互式地，看看它做了什么。然后我会尝试使用 i/o 重定向，然后使用来自命名管道的 i/o 重定向；它的作用可能存在一些显着差异，或者您可能会看到挂起的系统调用。如果您在 truss 日志文件中看到分叉，则需要添加一个 ' `-f`' 标志来跟随子级。

# c# - 静态方法在调试中很好，但在发布时抛出 TypeInitializationException

> ID：664696
> 
> 赞同：1
> 
> 时间：2009-03-20T01:33:18.990
> 
> 标签：c#, static, debugging, release

把我的头撞到这个上。我有一个静态方法，其类中的字段类似于：

```
public MyClass
{
   private static string m_myString;

   public static MyClass()
   {
       m_myString = "hello world";
   }

   public static void MyUsefulMethod(Foo bar)
   {
       DoStuffTo(bar);
   }

} 
```

在调试模式下，我没有问题，但是一旦我去发布，我就会得到**TypeInitializationExceptions**。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-20T01:42:17.393

你不应该说：

```
private static string m_myString = "hello world"; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-20T01:44:48.197

这通常是由于静态构造函数运行的顺序造成的。

顺便说一句：我认为非静态类的公共静态构造函数不是一个好主意，尝试将其设为私有。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-20T01:59:59.377

@jeffamaphone .. 是的，我的代码示例中有错字。

@Mitch Wheat：是的，这就是它的样子，我的错是你不能向静态构造函数添加访问修饰符。

无论如何，我现在可以使用它，看起来更像这样，为示例代码中的混乱道歉。

```
public MyClass
{
   private static Object m_object;

   static MyClass()
   {
      m_object = new Object();
   }  

   public static void MyUsefulMethod(Foo bar)
  {
      DoStuffTo(bar);
   }

} 
```

现在生活又好起来了。虽然如果我明白为什么我会更开心。

感谢您的回复。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-20T02:11:15.263

静态的问题之一是您无法控制在加载程序时实例化它们的时间。在 DEBUG 模式下，编译器做的许多事情都与 RELEASE 模式下不同。其中之一是它如何管理内存。

很可能您只是在 DEBUG 中很幸运，您的内存没有被其他进程覆盖，并且当您的程序需要它时，该值就在那里。

我使用的一种效果很好的方法是 Meyers Singleton 的一种变体。[（这在C++ In Theory: The Singleton Pattern - J. Nakamura 中](http://www.devarticles.com/c/a/Cplusplus/C-plus-plus-In-Theory-The-Singleton-Pattern-Part-I)有非常详细的介绍

虽然您不是单身人士，但该方法可用于解决您的问题，如下所示：

```
class MySample
{
    MySample() {}
    <etc.>

    static const std::string& GetStaticValue() 
    {
        static std::string my_val = "Hello World";
        return my_val;
    }
} 
```

Nakamura 先生在上面的文章中很好地解释了主要好处：

*这种构造依赖于函数静态对象仅在函数第一次被调用时才被初始化的事实。因此我们保持了动态初始化的好处。（函数静态原始变量，如 static int number=100；但是在编译期间会被翻译！）*

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-20T03:40:13.957

是否`TypeInitializationException`发生在`MyClass`或其他类中？抛出异常时是否获得堆栈跟踪？

您显示的小代码并不表示错误，但我们看不到`Bar`该类或其他可能相关的代码。

# c++ - 如何在OpenGL中将像素作为纹理绘制到多边形？

> ID：664698
> 
> 赞同：4
> 
> 时间：2009-03-20T01:34:59.673
> 
> 标签：c++, opengl, textures

在 C++ OpenGL 中，我想手动将每个像素（作为我假设的纹理）绘制到一个简单的正方形图元上，或者实际上是 2 个多边形形成一个正方形。

我不知道从哪里开始，或者要寻找什么短语。我是在寻找纹理映射还是创建纹理？大多数示例是从文件加载，但我不想这样做。

我试过阅读我的 OpenGL 编程指南书，但它只是一个迷宫，因为我对 OpenGL 还很陌生。请帮忙。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-03-20T02:14:13.103

仔细看看 glTexImage2D。这是在 OpenGL 中为 2D 纹理加载图像的调用。

glTexImage2D 实际上采用指向图像中像素数据的原始指针。你可以自己分配内存，直接设置图片数据（随便你），然后调用这个函数把图片传给OpenGL。

创建纹理后，您可以将其绑定到状态，以便您的三角形使用该纹理。

OpenGL 中没有直接要求从文件中加载用作纹理的图像。可以[在这篇 GameDev 文章中找到一个很好的纹理资源。](http://www.gamedev.net/reference/articles/article947.asp)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-20T07:20:25.223

如果您要绘制的正方形是二维的且未旋转，则您可能正在寻找[glDrawPixels](http://www.glprogramming.com/red/chapter08.html#name6)。它允许您在不使用任何多边形的情况下直接将像素的矩形区域绘制到缓冲区。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-20T03:34:19.777

如果您是新手，那么我建议您从[NeHe](http://nehe.gamedev.net/)的教程一开始。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-20T07:15:04.177

请注意，虽然`[glTexImage2D()](http://www.opengl.org/documentation/specs/man_pages/hardcopy/GL/html/gl/teximage2d.html)`需要一个指向要加载的像素的指针，但它并不关心调用后对该数据的任何更改。也就是说，数据实际上是从您指定的内存区域加载的，OpenGL 会创建自己的副本。

这意味着如果数据发生变化，您将需要重新调用 glTexImage2D() 或使用类似`[glTexSubImage2D()](http://www.opengl.org/documentation/specs/man_pages/hardcopy/GL/html/gl/texsubimage2d.html)`的方法进行部分更新。我建议测试和分析以查看子纹理更新是否快速，不确定实际驱动程序如何针对这种情况进行优化。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-29T01:34:44.827

感谢 Reed Copsey 将我指向[`glTexImage2D`](http://www.opengl.org/sdk/docs/man/xhtml/glTexImage2D.xml). 事实证明这很简单；只需将 GLubyte 数组传递给`glTexImage2D`函数（以及绑定纹理所需的所有函数等）。还没有尝试过这个确切的代码片段，但它应该可以正常工作。数组元素表示行、列和通道的串行版本。

```
int pixelIndex = 0;
GLubyte pixels[400];

for (int x = 0; x < 10; x++)
{
    for (int y = 0; y < 10; x++)
    {
         for (int channel = 0; channel < 4; channel++)
         {
             // 0 = black, 255 = white
             pixels[pixelIndex++] = 255;
         }
    }
}

glTexImage2D(
    GL_TEXTURE_2D, 0, GL_RGBA, SIZE, SIZE, 0,
    GL_RGBA, GL_UNSIGNED_BYTE, pixels); 
```

我在 OpenGL 书中读过，您可以将 2D 数组用于单色图像，因此我假设您也可以使用 3D 数组。

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2009-03-20T06:56:41.537

您正在寻找的内容通常称为“渲染到纹理”。

[http://developer.nvidia.com/object/gdc_oglrtt.html](http://developer.nvidia.com/object/gdc_oglrtt.html)

那个教程很老了。我猜这些扩展中的一些实际上并不是新版本的 OGL 中的扩展。抱歉，我无法提供更多帮助。我不再直接使用图形 API，如果可以的话，我会使用 D3D（为了避免扩展汤，出于其他原因，我不会在这里让你厌烦。）

# objective-c - 如何在 XCode 中关闭 GNU gdb 的启动文本

> ID：664699
> 
> 赞同：7
> 
> 时间：2009-03-20T01:35:55.800
> 
> 标签：objective-c, xcode

我是 XCode 3.1.2 和 Objective-C 2.0 的新手。我刚刚发现使用断点进行日志记录，而不是用数百万个 NSLog() 语句乱扔代码。问题是，当调试器启动时，它会喷出半屏的状态并将信息记入控制台。

**有什么办法可以压制这段文字吗？**

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-03-20T01:41:19.673

XCode 调试器是 GDB 的前端。如果 Xcode 允许您自定义 GDB 启动的命令行，请使用`"-quiet"`选项。

如果没有，您可以使用不那么漂亮的 hack 来“自定义”它：将 gdb 可执行文件移动到另一个文件，并将其替换为 shell 脚本，该脚本将使用`"-quiet"`选项调用可执行文件。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-20T04:04:59.407

~~在 Mac OS X 上，/usr/bin/gdb 恰好是一个 shell 脚本。只需替换此文件末尾看起来像的两行~~

 ~~```
exec $translate_binary "$gdb" ... 
```~~ 

和

```
exec $translate_binary "$gdb" -q ... 
```

~~像这样修改系统文件可能不是一个好主意，但对我来说它看起来足够无害。~~

我说得太早了。我刚刚尝试了一下，看起来 Xcode 直接调用了 gdb 二进制文件（我系统上的 /Developer/usr/libexec/gdb/gdb-powerpc-apple-darwin）。因此，Checkers 最初的建议是可行的方法。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2010-04-11T19:52:49.137

根据这个问题的提示，您可以创建自己的 gdb 包装器： [How to specify which GDB I can use in XCode on MacOS](https://stackoverflow.com/questions/668069/how-to-specify-which-gdb-i-can-use-in-xcode-on-macos)

这些方面的东西：

```
#!/bin/sh
echo "Wrapped GDB executed with $@"
gdb -quiet "$@" 
```

进入 /usr/local/bin/mygdb ：

```
defaults write com.apple.Xcode PBXGDBPath /usr/local/bin/mygdb 
```

但是 -quiet 参数在我的 10.6.4 系统上被忽略（XCode 3.2.3，GNU gdb 6.3.50-20050815（Apple 版本 gdb-1463）（Fri Mar 5 14:24:01 UTC 2010））

# mysql - 在 MySQL 中计算运行总计

> ID：664700
> 
> 赞同：60
> 
> 时间：2009-03-20T01:36:09.857
> 
> 标签：mysql, sql

我有这个 MySQL 查询：

```
SELECT DAYOFYEAR(`date`)  AS d, COUNT(*) 
FROM  `orders` 
WHERE  `hasPaid` > 0
GROUP  BY d
ORDER  BY d 
```

它返回如下内容：

```
d  | COUNT(*) |
20 |  5       |
21 |  7       |
22 | 12       |
23 |  4       | 
```

我真正想要的是最后的另一列显示运行总数：

```
d  | COUNT(*) | ??? |
20 |  5       |   5 |
21 |  7       |  12 |
22 | 12       |  24 |
23 |  4       |  28 | 
```

这可能吗？

* * *

## 回答 #1

> 赞同：117
> 
> 时间：2009-08-17T22:53:26.273

也许对您来说是一个更简单的解决方案，并且可以防止数据库执行大量查询。这仅执行一个查询，然后在一次通过中对结果进行一些数学运算。

```
SET @runtot:=0;
SELECT
   q1.d,
   q1.c,
   (@runtot := @runtot + q1.c) AS rt
FROM
   (SELECT
       DAYOFYEAR(`date`) AS d,
       COUNT(*) AS c
    FROM  `orders`
    WHERE  `hasPaid` > 0
    GROUP  BY d
    ORDER  BY d) AS q1 
```

这将为您提供额外的 RT（运行总计）列。不要错过顶部的 SET 语句以首先初始化运行的总变量，否则您只会得到一列 NULL 值。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2009-03-20T01:47:36.037

```
SELECT 
   DAYOFYEAR(O.`date`)  AS d, 
   COUNT(*),
   (select count(*) from `orders` 
       where  DAYOFYEAR(`date`) <= d and   `hasPaid` > 0)
FROM  
  `orders` as O
WHERE  
  O.`hasPaid` > 0
GROUP  BY d
ORDER  BY d 
```

这将需要一些语法调整（我没有 MySQL 来测试它），但它向您展示了这个想法。子查询只需要返回并添加您已经包含在外部查询中的所有新鲜事物，并且它必须对每一行都这样做。

看看[这个问题](https://stackoverflow.com/questions/439138/running-total-by-grouped-records-in-table)，了解如何使用连接来完成同样的任务。

为了解决随着数据增长而导致性能下降的问题：因为有最大值。一年 366 天，并且我假设您没有针对多年运行此查询，子查询将被评估多达 366 次。有了正确的日期索引和 hasPaid 标志，你会没事的。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2018-09-18T19:44:25.117

从 MySQL 8 开始，您将使用[窗口函数](https://blog.jooq.org/2013/11/03/probably-the-coolest-sql-feature-window-functions/)进行此类查询：

```
SELECT dayofyear(`date`) AS d, count(*), sum(count(*)) OVER (ORDER BY dayofyear(`date`))
FROM `orders`
WHERE `hasPaid` > 0
GROUP BY d
ORDER BY d 
```

在上面的查询中，聚合函数`count(*)`嵌套在窗口函数`sum(..) OVER (..)`中，这是可能的，因为[SQL 中操作的逻辑顺序](https://blog.jooq.org/2016/12/09/a-beginners-guide-to-the-true-order-of-sql-operations/)。如果这太令人困惑，您可以轻松地使用派生表或[`WITH`子句](https://dev.mysql.com/doc/refman/8.0/en/with.html)来更好地构建查询：

```
WITH daily (d, c) AS (
  SELECT dayofyear(`date`) AS d, count(*)
  FROM `orders`
  WHERE `hasPaid` > 0
  GROUP BY d
)
SELECT d, c, sum(c) OVER (ORDER BY d)
ORDER BY d 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2019-06-26T05:44:02.843

可以使用 MySQL 中的临时表计算运行余额。以下查询应该有效：

```
CREATE TEMPORARY table orders_temp1 (SELECT id, DAYOFYEAR(`date`)  AS d, COUNT(*) as total FROM  `orders` WHERE  `hasPaid` > 0 GROUP BY d ORDER  BY d);
CREATE TEMPORARY table orders_temp2 (SELECT * FROM orders_temp1);
SELECT d, total, (SELECT SUM(t2.total) FROM orders_temp2 t2 WHERE t2.id<=t1.id) as running_total FROM orders_temp1 t1; 
```

临时表用于组织查询。请注意，临时表仅在连接到 MySQL 服务器期间存在

上面的查询使用子查询，它返回临时表中所有行的余额，包括当前行。余额分配到实际表中的当前行

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2009-03-20T01:42:30.247

我会说这是不可能的，每个结果行都应该是独立的。使用编程语言获取这些值

# iphone - Cheetah 3d 模型 > XCode Open GL 应用程序

> ID：664711
> 
> 赞同：1
> 
> 时间：2009-03-20T01:42:00.403
> 
> 标签：iphone, opengl

我想将我在 Cheetah 3D 中创建的对象导入我打开的 GL iphone 应用程序。有人可以告诉我如何做到这一点吗？我可以将我的对象导出为任意数量的文件格式，但我认为 obj 是正确的。我需要做什么才能在我的 opengl 画布中呈现它？

谢谢，从外部文件加载内容时，我完全是 n00b！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-20T01:50:20.307

虽然我没有专门做过任何 GLE 工作，但我至少可以告诉你，obj 是一般来说最便携和使用最广泛的格式。

[FBX](http://usa.autodesk.com/adsk/servlet/index?siteID=123112&id=6837478) (Filmbox) 是一种相对较新且有趣的格式，似乎正在获得一些关注，但您会发现 obj 将满足您的大部分需求。

OpenGL 不支持读取 3d 文件格式 - 您需要使用像[GLUT](http://www.opengl.org/resources/libraries/glut/)这样的库，可以将 obj 中的数据转换为 OpenGL 原语。

下载 GLUT 并找到 progs/demos/smooth/glm.c，它提供了解析 obj 的方法。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-03-12T00:51:16.050

我为 Cheetah 3D 的原生文件格式 .jas 构建了一个加载器，并[解释了我选择 .jas 的原因以及我如何弄清楚如何从文件中读取我想要的内容](http://themobiledude.tumblr.com/post/51208387132/a-cheetah-3d-loader-for-ios-part-1)。随着我在游戏中的进展，加载器正在发生变化，所以它还没有完成，但它已经能够读取顶点和多边形数据、模型上的任何变换、动态四边形的镶嵌、计算顶点法线、读取 UV 和投掷一切越过栅栏到 GPU。

我还没有添加到加载器的是读取动画骨骼和蒙皮数据的能力。我会尽快添加。

# c# - RESTful WCF服务图片上传问题

> ID：664712
> 
> 赞同：7
> 
> 时间：2009-03-20T01:42:07.643
> 
> 标签：c#, wcf, rest

```
1 namespace Uploader  
2 {  
3     using System;  
4     using System.IO;  
5     using System.ServiceModel;  
6     using System.ServiceModel.Description;  
7     using System.ServiceModel.Web;  
8     using System.Drawing;  
9     using System.Drawing.Imaging;  
10     using System.Net;  
11     using System.Xml;  
12   
13     [ServiceContract(Namespace = "http://Uploader")]  
14     public interface IUploaderService  
15     {  
16         [OperationContract, WebInvoke(Method = "POST",UriTemplate = "File/{fileName}")]  
17         bool UploadFile(string fileName, Stream fileContents);  
18     }  
19   
20     [ServiceBehavior(InstanceContextMode = InstanceContextMode.PerCall)]  
21     public class UploaderService : IUploaderService  
22     {  
23         public bool UploadFile(string fileName, Stream fileContents)  
24         {  
25             return true;  
26         }  
27     }  
28   
29     class Program  
30     {  
31         static void Main()  
32         {  
33             var host = new   
34                 ServiceHost(typeof (UploaderService),   
35                 new Uri("http://localhost:8080/Uploader"));  
36             host.AddServiceEndpoint("Uploader.IUploaderService",   
37                 new WebHttpBinding(), "").Behaviors.Add(new WebHttpBehavior());  
38             try  
39             {  
40                 host.Open();  
41                 Console.WriteLine(host.BaseAddresses[0].AbsoluteUri + " running.");  
42                 Console.WriteLine();  
43                 var uri = "http://localhost:8080/Uploader/file.jpg";  
44                 var req = WebRequest.Create(uri) as HttpWebRequest;  
45                 if (req != null)  
46                 {  
47                     req.Method = "POST";  
48                     req.ContentType = "image/jpeg";  
49                     var reqStream = req.GetRequestStream();  
50                   
51                     var imageStream = new MemoryStream();  
52                     using (var i = Image.FromFile(@"c:\photo.jpg"))   
53                         i.Save(imageStream, ImageFormat.Jpeg);  
54                       
55                     var imageArray = imageStream.ToArray();  
56                     reqStream.Write(imageArray, 0, imageArray.Length);  
57                     reqStream.Close();  
58                     var resp = (HttpWebResponse)req.GetResponse();  
59                     var r = new XmlTextReader(resp.GetResponseStream());  
60                     if (r.Read())  
61                     {  
62                         Console.WriteLine(r.ReadString());      
63                     }  
64                 }  
65                 Console.WriteLine("Press <ENTER> to quit.");  
66                 Console.ReadLine();  
67             }  
68             catch (Exception ex)  
69             {  
70                 Console.WriteLine(ex.Message);  
71                 Console.ReadKey();  
72             }  
73             finally  
74             {  
75                 if (host.State == CommunicationState.Faulted)  
76                     host.Abort();  
77                 else  
78                     host.Close();  
79             }  
80         }  
81     }  
82 }  
83   
84 
```

你好，希望能帮到你......

我正在创建一个简单的应用程序（可能是网页），它将有一个简单的 UI 并从外部设备上传文件，当用户将设备插入 PC 时，应用程序/网页将通过 autorun.inf 启动。Web服务将执行将文件链接到管理系统等的复杂工作。这将使无法使用文件探索的IT文盲用户将文件提交到管理系统......！

我遇到的问题是，当内容类型为图像/jpeg 时，我的 RESTful 服务给了我一个 400 错误。它适用于 text/plain 或 text/xml（请参阅博客文章）

谢谢J

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-03-20T02:48:10.277

您可以尝试覆盖任何内容类型并将所有文件上传为应用程序/八位字节流，或使用 IOperationBehavior 的文本/纯文本。

```
public class WebContentTypeAttribute : Attribute, IOperationBehavior, IDispatchMessageFormatter
{
    private IDispatchMessageFormatter innerFormatter;
    public string ContentTypeOverride { get; set; }

    public WebContentTypeAttribute(string contentTypeOverride)
    {
        this.ContentTypeOverride = contentTypeOverride;
    }

    // IOperationBehavior
    public void Validate(OperationDescription operationDescription)
    {

    }

    public void ApplyDispatchBehavior(OperationDescription operationDescription, DispatchOperation dispatchOperation)
    {
        innerFormatter = dispatchOperation.Formatter;
        dispatchOperation.Formatter = this;
    }

    public void ApplyClientBehavior(OperationDescription operationDescription, ClientOperation clientOperation)
    {

    }

    public void AddBindingParameters(OperationDescription operationDescription, BindingParameterCollection bindingParameters)
    {

    }

    // IDispatchMessageFormatter
    public void DeserializeRequest(Message message, object[] parameters)
    {
        if (message == null)
            return;

        if (string.IsNullOrEmpty(ContentTypeOverride))
            return;

        var httpRequest = (HttpRequestMessageProperty)message.Properties[HttpRequestMessageProperty.Name];
        httpRequest.Headers["Content-Type"] = ContentTypeOverride;
    }

    public Message SerializeReply(MessageVersion messageVersion, object[] parameters, object result)
    {
        return innerFormatter.SerializeReply(messageVersion, parameters, result);
    }
} 
```

而且您必须修改您的服务合同，使其看起来像这样

```
[OperationContract]
[WebInvoke(Method = "POST",UriTemplate = "File/{fileName}")]
[WebContentType("application/octet-stream")]
bool UploadFile(string fileName, Stream fileContents); 
```

虽然，如果您从网页上传，数据不会以多部分/表单数据格式发布吗？

# iphone - iPhone UIImagePickerController didFinishPickingImage：视图控制器之间的UIImage传输？

> ID：664717
> 
> 赞同：4
> 
> 时间：2009-03-20T01:42:37.250
> 
> 标签：iphone, uiviewcontroller, uiimage, uiimagepickercontroller

在我的应用程序中，我有一个 UIImagePickerController。选择图像后，我的视图控制器需要获取图像并将其传递给另一个视图控制器，该视图控制器被推送到 self.navigationController。但我总是得到 SEGFAULTS 或 nil 参数，诸如此类。如果您能告诉我这段代码有什么问题，我将不胜感激：

FirstViewController.m:

```
- (void)imagePickerController:(UIImagePickerController *)picker didFinishPickingImage:(UIImage *)img editingInfo:(NSDictionary *)editInfo {
 self.currentpicture = [img copy];
 [self dismissModalViewControllerAnimated:YES];
 [self goNext];
}
-(void)goNext{
 SecondViewController *vc = [[SecondViewController alloc] initWithNibName:@"Second" bundle:nil];
 [vc giveMePicture:currentpicture];
 [self.navigationController pushViewController:vc animated:YES];
} 
```

SecondViewController.m：

```
-(void)giveMePicture:(UIImage *)data {
 self.currentpicture=[data copy];
} 
```

它们都将 currentpicture 定义为 UIImage *currentpicture;
我现在*应该*有 currentpicture 作为一些数据，但它每次都崩溃！我尝试了很多不同的事情，但我无法弄清楚。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-03-20T12:44:56.973

如果我错了，请纠正我，但 UIImage 不符合 NSCopying，因此您无法成功复制它。

您可能想要做的是保留图像。如果 self.currentpicture 是一个 'retain' 属性，它会自动释放前一个对象并保留新对象，所以只需这样做：

```
self.currentpicture = img; 
```

否则自己做：

```
[self.currentpicture release];
self.currentpicture = [img retain]; 
```

在这两种情况下，当您不再需要图像时，您仍然必须调用 [self.currentpicture release]。通常你会在'self'对象的dealloc方法中这样做。

* * *

## 回答 #2

> 赞同：-2
> 
> 时间：2009-03-20T02:28:48.123

在不同的视图控制器类之间共享数据的一种方法是通过应用程序委托。

例如，您可以`UIImage *currentPicture`在您的应用程序委托中定义，然后在您的两个视图控制器类中访问，如下所示：

```
MyAppDelegate *appDelegate = (MyAppDelegate*)[[UIApplication sharedApplication]delegate];
UIImage *i = [appDelegate.currentPicture]; 
```

# c - 基本 C 文件 I/O 程序的指针问题

> ID：664718
> 
> 赞同：2
> 
> 时间：2009-03-20T01:43:51.820
> 
> 标签：c, pointers, segmentation-fault

```
#include <stdio.h>
#include <stdlib.h>

int main() 
{
     FILE *fp = fopen("lr.txt", "r");
     fseek(fp, 0L, SEEK_END);
     int size = ftell(fp);
     fseek(fp, 0L, SEEK_SET);

     char *lorem_ipsum;

     int i = 0;
     lorem_ipsum = (char*) malloc(sizeof(char) * size);
     while(fscanf(fp, "%s\n", lorem_ipsum) != EOF)
     {
      printf("%s", lorem_ipsum[i]);
      i++;

     }
     fclose(fp);
     return 0;
} 
```

这个程序编译并运行，但是，发生的事情是我遇到了段错误，我不太清楚这个程序有什么问题。有人可以帮我解决我得到的指针错误吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-03-20T01:46:08.053

您正在尝试`lorem_ipsum[i]`像字符串一样打印。`lorem_ipsum`是一个字符串，所以`lorem_ipsum[i]`只是一个字符。

发生段错误是因为 printf 查看字符的值 at`lorem_ipsum[i]`并将其解释为 char* 指针（字符串）。自然地，字符的值不对应于有效的分配内存地址。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-20T01:48:42.917

您将 a `char`( `lorem_ipsum[i]`) 传递给`fscanf`函数，该函数需要 a`char*`作为参数。

您可能想要使用`lorem_ipsum`，或者`lorem_ipsum+i`如果您真的想去掉第一个`i`字符。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-20T01:49:27.860

你能解释一下你在 for 循环中要做什么吗？

在我看来，您正在尝试逐行读取文件，然后打印该行。但是，当您执行 printf("%s", lorem_ipsum[i]) 时，您发送的是一个字符，而不是字符串。

# xml - 在 Actionscript 3 中遍历 XML 时出现无限循环

> ID：664722
> 
> 赞同：0
> 
> 时间：2009-03-20T01:44:55.483
> 
> 标签：xml, actionscript-3, traversal, infinite-loop

我已将代码范围缩小到此（忽略着色）：

```
var theXML:XML = 
    <xml>
        word
    </xml>;

for each (var i:XML in theXML.*) {
    trace(i);
} 
```

出于某种原因，这会无限期地一遍又一遍地打印出“单词”。关于为什么的任何想法？我有点不习惯，感觉这很明显，但我很难过。

谢谢，卡梅伦

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-20T02:00:36.927

发现它很有趣，我刚刚测试过。正如预期的那样，结果只是**一个**“单词”。

可能您已将其放置在 ENTER_FRAME/TIMER 事件处理程序中，或者最终放置在时间轴上循环的帧中。

# mysql - 有人让 Ruby 与 MySQL 5.1 一起工作吗？

> ID：664725
> 
> 赞同：1
> 
> 时间：2009-03-20T01:47:02.153
> 
> 标签：mysql, ruby

以前有人问过这个问题，但方式不完全相同（其他用户有 Rails/服务器问题，我没有 OLD_PASSWORDS 问题）

我正在尝试使用[Ruby-MySQL](http://www.tmtm.org/en/ruby/mysql/)使我的 Ruby 应用程序与 MySQL 一起工作，

设置应该非常简单：

```
% ruby ./setup.rb
% ruby ./test.rb hostname user passwd
# ruby ./install.rb 
```

但是，当我尝试使用 localhost 和 root 运行 test.rb 时，出现以下错误：

*连接............./Users/turbovince/Desktop/ruby-mysql-0.2.6/mysql.rb:1019:in `read': Packets out of order: 0<> (RuntimeError )*

但是，我可以毫无问题地使用 /usr/local/mysql/bin/mysql 连接到 MySQL 服务器。

我正在运行 MySQL 5.1.32 和 Ruby 1.9

任何提示将不胜感激。

编辑：我也尝试使用 127.0.0.1 而不是 localhost。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-09-22T15:07:19.213

我已经从这个地址复制了 libmysql.dll：http: [//instantrails.rubyforge.org/svn/trunk/InstantRails-win/InstantRails/mysql/bin/](http://instantrails.rubyforge.org/svn/trunk/InstantRails-win/InstantRails/mysql/bin/) 到 ruby​​/bin，它适用于 mysql 版本：5.1.30。

我在 Windows 机器上使用 ruby​​ 1.8.6 并且之前安装了 mysql gem：gem install mysql。在复制这个 dll 之前，我也遇到了 mysql 5.1.30 版本的问题，所以我想这可能会解决你在 ruby​​ 1.9.1 上遇到的问题。

希望这会有所帮助。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-21T01:05:55.350

可能这与 1.9 尚不兼容，许多 Ruby gems 和库尚不兼容 Ruby 1.9 中的更改

编辑：正如所指出的，它现在正在工作，但我在三月份没有回答这个问题，所以当时的答案是准确的。这种事情的最佳选择是你去检查[isitruby19](http://isitruby19.com/)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-08-29T16:31:33.433

ruby 1.9 的 mysql gem 已经存在并且工作正常。您可以使用安装 gem

> 宝石安装 mysql

并检查这是否解决了您的问题。但是这个 gem 的自述文档声明与这个版本的 gem 兼容的 MySQL 版本是 5.0.83。因此，让 5.1.x 版本与 ruby​​ 1.9.1 一起正常工作可能需要一些时间。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-20T12:20:42.693

您是否尝试过使用 127.0.0.1 而不是 localhost？

# java - firefox缓存散列密钥生成算法错误

> ID：664729
> 
> 赞同：7
> 
> 时间：2009-03-20T01:48:05.833
> 
> 标签：java, c++, algorithm, firefox, hash

[Firefox 中](https://bugzilla.mozilla.org/show_bug.cgi?id=355567#c28)存在一个错误（即使在新的 beta 和 minefield 版本中），由于在其缓存哈希中创建密钥的算法，该错误会阻止某些文件的缓存。 [这是函数源代码的链接](http://hg.mozilla.org/mozilla-central/annotate/e74b36d547de/netwerk/cache/src/nsDiskCacheDevice.cpp#l249)。

我想确保可以缓存我网站的所有文件。但是，我不明白为什么他们的散列函数无法为不同的 url 创建唯一键。我希望有人可以用伪代码或 java 来描述这个*恶意函数。*

在修复此错误之前，最好为开发人员创建一个实用程序以确保唯一的 url。

* * *

**编辑：**有一些非常有用的答案，但是，我需要更多的分步帮助来创建一个实用程序来检查这些缓存混淆。获得一些可以重现 Firefox 正在创建的密钥的 java 代码会很棒。因此，在这个问题上开悬赏。

* * *

**编辑 2：**这是一个部分工作的 java 端口（使用[processing](http://processing.org)编写）。注意底部的测试；前三个按预期工作，但其他人没有。我怀疑有关签名/未签名整数的一些事情。建议？

```
//
// the bad collision function
// http://mxr.mozilla.org/mozilla/source/netwerk/cache/src/nsDiskCacheDevice.cpp#240
//

//248 PLDHashNumber
//249 nsDiskCache::Hash(const char * key)
//250 {
//251     PLDHashNumber h = 0;
//252     for (const PRUint8* s = (PRUint8*) key; *s != '\0'; ++s)
//253         h = PR_ROTATE_LEFT32(h, 4) ^ *s;
//254     return (h == 0 ? ULONG_MAX : h);
//255 }

//
//  a java port...
//

String getHash( String url )
{

//get the char array for the url string
char[] cs = getCharArray( url );

int h = 0;

//for (const PRUint8* s = (PRUint8*) key; *s != '\0'; ++s)
for ( int i=0; i < cs.length; i++ )
{  h = PR_ROTATE_LEFT32(h, 4) ^ cs[i];
}

//looks like the examples above return something in hex.
//if we get matching ints, that is ok by me.
//but for fun, lets try to hex the return vals?
String hexVal = hex( h );
return hexVal;
}

char[] getCharArray( String s )
{
  char[] cs = new char[s.length()];
  for (int i=0; i<s.length(); i++)
  { 
    char c = s.charAt(i);
    cs[i] = c;
  } 

  return cs;
}

//
// how to PR_ROTATE_LEFT32
//

//110 /*
//111 ** Macros for rotate left and right. The argument 'a' must be an unsigned
//112 ** 32-bit integer type such as PRUint32.
//113 **
//114 ** There is no rotate operation in the C Language, so the construct
//115 ** (a << 4) | (a >> 28) is frequently used instead. Most compilers convert
//116 ** this to a rotate instruction, but MSVC doesn't without a little help.
//117 ** To get MSVC to generate a rotate instruction, we have to use the _rotl
//118 ** or _rotr intrinsic and use a pragma to make it inline.
//119 **
//120 ** Note: MSVC in VS2005 will do an inline rotate instruction on the above
//121 ** construct.
//122 */
//...
//128 #define PR_ROTATE_LEFT32(a, bits) _rotl(a, bits)

//return an int (32 bit).  what do we do with the 'bits' parameter?  ignore?
int PR_ROTATE_LEFT32( int a, int bits )
{    return (a << 4) | (a >> (32-bits)); 
}

//
// examples of some colliding hashes
// https://bugzilla.mozilla.org/show_bug.cgi?id=290032#c5
//

//$ ./hashit "ABA/xxx.aba"
//8ffac222
//$ ./hashit "XyZ/xxx.xYz"
//8ffac222
//$ ./hashit "CSS/xxx.css"
//8ffac222
//$ ./hashit "JPG/xxx.jpg"
//8ffac222

//$ ./hashit modules_newsfeeds/MenuBar/MenuBar.css
//15c23729
//$ ./hashit modules_newsfeeds/ListBar/ListBar.css
//15c23729

//$ ./hashit modules_newsfeeds/MenuBar/MenuBar.js
//a15c23e5
//$ ./hashit modules_newsfeeds/ListBar/ListBar.js
//a15c23e5

//
// our attempt at porting this algorithm to java...
//

void setup( )
{

String a = "ABA/xxx.aba";
String b = "CSS/xxx.css";
String c = "CSS/xxx.css";
String d = "JPG/xxx.jpg";

println( getHash(a) ); //yes 8ffac222
println( getHash(b) ); //yes 8ffac222
println( getHash(c) ); //yes 8ffac222
println( getHash(d) ); //no [??] FFFFFF98, not 8ffac222

println( "-----" );

String e = "modules_newsfeeds/MenuBar/MenuBar.css";
String f = "modules_newsfeeds/ListBar/ListBar.css";

println( getHash(e) ); //no [??] FFFFFF8C, not 15c23729
println( getHash(f) ); //no [??] FFFFFF8C, not 15c23729

println( "-----" );

String g = "modules_newsfeeds/MenuBar/MenuBar.js";
String h = "modules_newsfeeds/ListBar/ListBar.js";

println( getHash(g) ); //yes [??] FFFFFF8C, not a15c23e5
println( getHash(h) ); //yes [??] FFFFFF8C, not a15c23e5

} 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-03-20T01:58:22.657

根据我对阅读 bugzilla 条目的理解，当出现两个不同的问题时，该错误就会显现：

1.  他们的哈希算法会为“足够相似”的 url 生成冲突。从错误“足够相似”似乎意味着每 4 个字符（或者可能是 8 个）的 url 是相同的，并且
2.  他们处理哈希冲突的逻辑失败了，因为他们还没有将具有相同哈希值的先前 url 刷新到磁盘。

所以基本上，如果你的页面有两个非常相似的 url，这可能会发生在某些版本的 Firefox 上。我希望它通常不会发生在不同的页面上，因为那时 FF 将有时间将条目刷新到磁盘以避免时间问题。

因此，如果您有多个从同一页面加载的资源（脚本、图像等），请确保它们包含 9 个完全不同的字符。您可以确保这一点的一种方法是通过附加一个带有随机数据位的查询字符串（您忽略），例如：

*   [http://foo.com/resource.js](http://foo.com/resource.js) **?r=dn#@JdsK#**

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-03-20T02:20:57.097

以下是该算法的工作原理：

```
initialize hash to 0
for each byte
    shift hash 4 bits to left (with rotate)
    hash = hash XOR character 
```

视觉上（16 位版本）：

```
00110000             = '0'
    00110001         = '1'
        00110010     = '2'
            00110011 = '3'
0100            0011 = '4'
00110101             = '5'
====================
01000110001000010000  (and then this will be 'rotated'
                       so that it lines up with the end)
giving:
        00100001000001000110 
```

这意味着如果您有相同长度的字符串并且大部分相同，那么至少在一种情况下，一个 char 的低 4 位和下一个 char 的高 4 位相互异或必须是唯一的。但是，将 32 位数字粘贴到表中的方法可能会越来越弱，这意味着它要求字符串中特定位置（mod 8 字符）的 lower4 xor upper4 是唯一的。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-20T13:50:30.423

这个错误是我网站的一个主要问题：[http ://worldofsolitaire.com](http://worldofsolitaire.com)

很久以前，我通过在 .htaccess 文件中使用条件规则来解决它，该规则将禁用 Firefox 用户在站点上的所有图像缓存。这是一件可怕的事情，但当时我无法找到 Firefox 中的错误，并且让网站稍微慢一点比显示重复/损坏的图像要好。

当我在链接的错误中读到它已在最新的 Firefox 版本中修复时，我在 2009 年 4 月 19 日（昨天）更改了条件，只为 Firefox 2 用户禁用缓存。

几个小时后，我收到了 10 多封来自 Firefox 3 用户的电子邮件（确认），他们看到了重复的图像。所以这个问题在 Firefox 3 中仍然是一个问题。

我决定创建一个简单的 Linux 测试程序，它允许我检查 URL 以查看它们是否生成相同的缓存哈希键。

在任何 Linux 系统中编译： g++ -o ffgenhash ffgenhash.cpp

这是代码（保存到文件 ffgenhash.cpp）

```
#include <stdio.h>
#include <string.h>
#include <stdlib.h>

#define ULONG_MAX 0xFFFFFFFF
#define PR_ROTATE_LEFT32(a, bits) (((a) << (bits)) | ((a) >> (32 - (bits))))

unsigned long ffgenhash(const char * key)
{
    unsigned long h=0;

    for(const unsigned char * s = (unsigned char *) key; *s != '\0'; ++s)
    {
        h = PR_ROTATE_LEFT32(h, 4) ^ *s;
    }

    return (h==0 ? ULONG_MAX : h);
}

int main(int argc, char ** argv)
{
    printf("%d\n", ffgenhash(argv[1]));
    return 0;
} 
```

如您所见，这里有两个生成相同缓存哈希键的真实 URL：

```
./ffgenhash "http://worldofsolitaire.com/decks/paris/5/12c.png"
1087949033
./ffgenhash "http://worldofsolitaire.com/decks/paris/5/13s.png"
1087949033 
```

由于我在 Javascript 循环中预加载了这些图像，因此在这里无法尝试使用某种空的 <script> 标记解决方法。

事实上，我认为我唯一真正的解决方案是以某种方式修改 Firefox 用户的 URL 以生成唯一的缓存哈希键。这就是我将使用的方法。

顺便说一句，我很想创建一个 Firebug 添加，它将检查站点加载的所有资源，如果站点上的两个资源共享一个公共哈希键，那么开发人员就会知道，它会给出一个大错误。通过这个来运行像谷歌地图这样的网站会很棒，因为在过去的几年里我看到这些图像有奇怪的东西:)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-20T02:02:03.443

首先，您不能将所有字符串唯一地散列为整数（显然，字符串多于（固定大小）整数，因此必须存在冲突）。您可以拥有一个可以保存所有数据集（例如所有文件）的哈希表，但要获得它，您需要更改哈希表的代码，而不是哈希函数。

其次，我看到您发布的散列函数存在问题，在这部分：

```
PR_ROTATE_LEFT32(h, 4) 
```

如果它确实旋转`h`（我还没有检查过），旋转 4 意味着具有两个 8 字节（我假设是 32 位散列）部分交换的字符串（例如`xxxxxxxxyyyyyyyy`vs. `yyyyyyyyxxxxxxxx`）将具有相等的散列。如果将其更改为与哈希大小相对质数的值（例如 5），则这只发生在长度为 32 的交换部分。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2010-03-10T00:35:02.373

这是 Sembiance 哈希生成器的修改版本，即使在 64 位平台上编译也能正常工作：

```
#include <stdio.h>
#include <string.h>
#include <stdlib.h>

#define ULONG_MAX 0xFFFFFFFF
#define PR_ROTATE_LEFT32(a, bits) (((a) << (bits)) | ((a) >> (32 - (bits))))

unsigned int ffgenhash(const char * key) {
    unsigned int h=0;
    for(const unsigned char * s = (unsigned char *) key; *s != '\0'; ++s) {
        h = PR_ROTATE_LEFT32(h, 4) ^ *s;
    }
    return (h==0 ? ULONG_MAX : h);
}

int main(int argc, char ** argv) {
    printf("%u\n", ffgenhash(argv[1]));
    return 0;
} 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-04-01T10:16:57.947

您显然误解了真正的错误。当然，由于哈希算法的选择非常糟糕，会出现哈希冲突。但即使 hash(x)=1 也不会导致所描述的问题。它只会通过第一个存储桶将 O(1) 查找转换为 O(N) 链表搜索。

真正的问题是 Firefox 无法处理哈希冲突。因此，它需要所有 URL 的完美散列。不幸的是，“所有 URL”是您无法控制的集合。

# c# - .NET 2.0 可空类型和数据库空值

> ID：664738
> 
> 赞同：3
> 
> 时间：2009-03-20T01:52:28.040
> 
> 标签：c#, .net, database, null

如果 .NET 2.0 可空类型从版本 1 开始存在，那么首先不需要 DBNull.Value 吗？

还是 RDBMS 的 null 与 .NET 的 null 无关？无论如何，仍然需要 DBNull.Value，无论 .NET 版本 1 是否已经具有可为空的类型。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-03-20T01:58:41.580

.NET 中的可空类型允许相关变量实际上为空。DBNull 是一种说法，“在另一个环境中，这个值被认为是空的”。由于我们需要一种方法来区分*实际*的null - 或“本机” null，如我们当前运行时的本机 - 和我们与之通信的另一个系统中的 null，可空类型和 DBNull 服务于完全不同的目的。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-03-20T01:58:34.047

`null`在任何 .NET 版本中[`DBNull.Value`](http://msdn.microsoft.com/en-us/library/system.dbnull.value.aspx)都是两个不同的东西。

例如：

```
public string CustomerName(int Id)
{
   SqlCommand cmd = 
         new SqlCommand("SELECT Name FROM Customer WHERE id = " + custId, conn);

   object result = cmd.ExecuteScalar();

   if (result == null)
      return "Customer not found";

   if (result == System.DBNull.Value)
      return "Customer found but name is null";

   return (string) result;
} 
```

[参考](http://codebetter.com/petervanooijen/2004/04/12/system-dbnull-value-null/)。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-03-21T00:00:01.763

如果[System.Data.DataSetExtensions.dll](http://msdn.microsoft.com/en-us/library/bb360891.aspx)可以通过，我猜如果当时可以使用可空值类型，那么 DBNull.Value 可能不会存在。

在“foo”列设置为 DBNull.Value 的 DataRow 上使用该库的扩展方法，您将获得...

```
row.Field<int?>("foo");  // returns a nullable int set to null
row.Field<int>("foo");   // throws an InvalidCastException 
```

当然，与 C# 结合使用时，这非常方便 ?? 运算符，当您想要提供默认值来代替数据库 null 时。就个人而言，我没有浪费时间在 IDataReader/IDataRecord 上实现类似的扩展方法。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-20T02:24:14.983

我真的不同意这一点。

> .NET 中的可空类型允许相关变量实际上为空。DBNull 是一种说法，“在另一个环境中，这个值被认为是空的”。由于我们需要一种方法来区分实际的 null - 或“本机” null，如我们当前运行时的本机 - 和我们与之通信的另一个系统中的 null，可空类型和 DBNull 服务于完全不同的目的。

仅当您不知道您的局部变量是否已从数据库中获取时才需要这种区别。如果您知道变量已从数据库中获取，则可以识别 null 和 DBNull。

但不同的是，编程语言中的 null 表示没有值，而 null == null 为真。在数据库中，null 表示更像是未知值。因此 null == null 在数据库中为假；null 根本不等于任何内容，因为您无法判断未知值是否等于另一个未知值。我不确定 DBNull 是否以这种方式实现并且 DBNull.Value == DBNull.Value 评估为假。

**编辑**

我刚刚对其进行了测试，但 DBNull 的行为并不像预期的那样。DBNull.Value == DBNull.Value 的计算结果为 true，但应在数据库 null 的语义下产生 false。

# javascript - 是否建议加密 javascript？

> ID：664741
> 
> 赞同：0
> 
> 时间：2009-03-20T01:56:39.510
> 
> 标签：javascript

我目前正在获得一份 IT 开发业务的工作（请注意，我已经做了我的自由职业并且薪水足够好），这份工作听起来不错，它可以让我在做另一份工作的同时保住我目前的工作。问题是，他们想把我外包，但不给我任何开发的功劳，只给我全额付款。

在获得报酬方面听起来不错，但在仅帮助另一家公司使用我的工作建立自己的声誉方面我不太喜欢它（主要是自我，是的我知道），所以我开始思考并想出了可能会加密我的 javascriptps、php 等。我在网上找到了一些工具可以做到这一点，但是我不确定实际这样做有多好，我的意思是，它会影响功能或加载速度吗？我这样做真的值得推荐吗？我不知道现在该怎么想……你们介意告诉我你对此事的看法吗？

* * *

**编辑澄清**

这里的事情不是我被一家企业签约，所以我专门为他们开发他们只是想外包我所做的事情，也就是说，当他们告诉客户他们做了这件事时，这家 IT 企业会付钱给我他们自己......然后你可以认为“他们将无法自己复制它”或“如果他们尝试复制它至少他​​们将需要一些时间来理解代码”但让我们最终面对它如果他们愿意，他们将能够理解和复制我的代码（或类似的东西）......

现在这里的问题是我有兴趣与他们合作，因为它可以让我在国外找到工作（注意我在墨西哥，工作将在另一个国家）而且我真的很想在那里被人知道，但是这个 IT 业务不会同意给我一些荣誉……而且我目前没有很多其他选择可以在那里被人知道。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-03-20T02:01:45.583

你必须事先就谁拥有代码的版权达成某种协议。他们是雇用您来创建产品，还是雇用您来创建他们将根据需要拥有和维护的代码库？如果他们认为自己是代码的所有者，那么对其进行加密会给您带来各种麻烦，例如获得报酬。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-03-20T02:27:09.937

你编码的越多，你得到的越好（我希望如此）。做好工作，变得更好，不要对你的代码贪婪。很多人会很高兴得到任何工作。如果我们都加密我们的代码以向其他社区隐藏它，那么这样的社区就不会存在。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-03-20T02:00:37.927

如果他们为此付出代价，最终的结果就不是你的。如果您不喜欢他们的条款，请不要接受该职位。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-03-20T02:13:07.473

您可能想咨询您所在司法管辖区的合格律师，并询问他有关“受雇工作”的问题。在大多数领域，别人付钱给你写的代码将归他们所有，而不是你所有，除非你可以让他们同意另有规定的合同。无论您是实际员工、代理提供的承包商还是自由职业者，这都适用。

如果他们拥有该代码，那么他们完全有权要求您以一种允许他们在以后进一步修改它而不需要您的帮助的形式向他们提供该代码 - 即，不加密。就个人而言，如果我聘请某人为我写东西，并且他们以加密（甚至轻微混淆）的形式提供，我会将其视为恶意的标志，即使他们确实应要求立即提供了清晰的版本，我以后不太可能再和他们做生意了。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-20T02:14:56.300

我喜欢“以代码为人质”的策略。

我相信他们会立即看到你的方式。不可能有六名称职的程序员可以调整开源包来替换您的代码。

我敢肯定，一旦他们发现代码被锁定，他们会立即询问您的要求是什么，立即给您想要的一切。

这么巧妙的策略，不知道为什么大家不这样做。

# assembly - 大多数现代系统中堆栈增长的方向是什么？

> ID：664744
> 
> 赞同：109
> 
> 时间：2009-03-20T01:58:39.320
> 
> 标签：assembly, stack, callstack, abi, stack-frame

我正在准备一些 C 语言培训材料，我希望我的示例适合典型的堆栈模型。

C 堆栈在 Linux、Windows、Mac OSX（PPC 和 x86）、Solaris 和最新的 Unix 中的发展方向是什么？

* * *

## 回答 #1

> 赞同：153
> 
> 时间：2009-03-20T02:15:55.267

堆栈增长通常不取决于操作系统本身，而是取决于运行它的处理器。例如，Solaris 在 x86 和 SPARC 上运行。Mac OSX（如您所述）在 PPC 和 x86 上运行。Linux 可以在任何东西上运行，从我在工作中的大喇叭 System z 到一个[微不足道的小手表](http://web.archive.org/web/20090322124254/http://www.research.ibm.com/WearableComputing/linuxwatch/linuxwatch.html)。

如果 CPU 提供任何类型的选择，操作系统使用的 ABI / 调用约定指定如果您希望您的代码调用其他所有人的代码，您需要做出哪种选择。

处理器及其方向是：

*   x86：下降。
*   SPARC：可选。标准 ABI 使用羽绒。
*   PPC：下来，我想。
*   System z：在链表中，我没有骗你（但仍然下降，至少对于 zLinux）。
*   ARM：可选，但 Thumb2 仅对向下进行紧凑编码（LDMIA = 之后递增，STMDB = 之前递减）。
*   6502：下降（但只有 256 个字节）。
*   RCA 1802A：任何你想要的方式，取决于 SCRT 的实施。
*   PDP11：下降。
*   8051：上。

* * *

显示我的年龄，1802 是用于控制早期航天飞机的芯片（我怀疑，根据它的处理能力来感应门是否打开 :-) 和我的第二台计算机[COMX-35](http://en.wikipedia.org/wiki/Comx-35)（跟随我的[ZX80](http://en.wikipedia.org/wiki/Zx80)）。

PDP11 细节从[这里](http://en.wikipedia.org/wiki/PDP-11_architecture)收集，8051 细节从[这里](http://what-when-how.com/8051-microcontroller/8051-register-banks-and-stack/)收集。

SPARC 体系结构使用滑动窗口寄存器模型。架构上可见的细节还包括寄存器窗口的循环缓冲区，这些缓冲区在内部有效并缓存，当溢出/下溢时会出现陷阱。有关详细信息，请参见[此处](http://icps.u-strasbg.fr/people/loechner/public_html/enseignement/SPARC/sparcstack.html)。正如[SPARCv8 手册所解释的](http://www.gaisler.com/doc/sparcv8.pdf#page=53)，SAVE 和 RESTORE 指令就像 ADD 指令加上寄存器窗口旋转。使用正常数而不是通常的负常数会产生向上增长的堆栈。

上述 SCRT 技术是另一种 - 1802 使用了一些或它的 16 个 16 位寄存器用于 SCRT（标准调用和返回技术）。`SEP Rn`一个是程序计数器，您可以使用任何寄存器作为带有指令的 PC 。一个是堆栈指针，两个被设置为始终指向 SCRT 代码地址，一个用于调用，一个用于返回。*没有*寄存器被以特殊方式处理。请记住，这些细节来自记忆，它们可能并不完全正确。

例如，如果 R3 是 PC，R4 是 SCRT 调用地址，R5 是 SCRT 返回地址，R2 是“堆栈”（在软件中实现的引号），`SEP R4`则将 R4 设置为 PC 并开始运行 SCRT调用代码。

然后它将 R3 存储在 R2“堆栈”上（我认为 R6 用于临时存储），向上或向下调整它，抓取 R3 后面的两个字节，将它们加载*到*R3 中，然后`SEP R3`在新地址上运行并运行。

要返回，它将`SEP R5`从 R2 堆栈中拉出旧地址，向其添加两个（以跳过调用的地址字节），将其加载到 R3 并`SEP R3`开始运行先前的代码。

在所有基于 6502/6809/z80 堆栈的代码之后，最初很难绕开你的脑袋，但仍然以一种撞墙的方式优雅。此外，该芯片的一大卖点是一整套 16 个 16 位寄存器，尽管您立即丢失了其中的 7 个（5 个用于 SCRT，2 个用于 DMA 和内存中断）。啊，营销对现实的胜利:-)

System z 实际上非常相似，使用它的 R14 和 R15 寄存器进行调用/返回。

* * *

## 回答 #2

> 赞同：24
> 
> 时间：2009-03-20T02:51:11.330

在 C++（适用于 C）[中 stack.cc](http://www.google.com/codesearch/p?hl=en#T6HTRewW1Ro/aegis-4.22/common/stack.cc&q=stack%20direction&l=27)：

```
static int
find_stack_direction ()
{
    static char *addr = 0;
    auto char dummy;
    if (addr == 0)
    {
        addr = &dummy;
        return find_stack_direction ();
    }
    else
    {
        return ((&dummy > addr) ? 1 : -1);
    }
} 
```

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2009-04-19T09:12:26.763

向下增长的优势在于，在旧系统中，堆栈通常位于内存的顶部。程序通常从底部开始填充内存，因此这种内存管理最大限度地减少了测量堆栈底部并将其放置在合理位置的需要。

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2009-03-20T02:02:06.893

堆栈在 x86 上向下增长（由架构定义，pop 递增堆栈指针，push 递减。）

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2019-04-20T10:35:05.220

只是对其他答案的一个小补充，据我所知，这还没有触及这一点：

让堆栈向下增长使堆栈内的所有地址都具有相对于堆栈指针的正偏移量。不需要负偏移，因为它们只会指向未使用的堆栈空间。当处理器支持堆栈指针相对寻址时，这简化了访问堆栈位置。

许多处理器的指令允许使用相对于某个寄存器的仅正偏移量进行访问。其中包括许多现代建筑，以及一些古老的建筑。例如，ARM Thumb ABI 为堆栈指针相关访问提供了在单个 16 位指令字中编码的正偏移量。

如果堆栈向上增长，所有相对于堆栈指针的有用偏移量都将为负数，这不太直观且不太方便。它也与寄存器相对寻址的其他应用程序不一致，例如访问结构的字段。

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2013-07-29T13:29:01.583

在 MIPS 和许多现代[RISC 架构](https://en.wikipedia.org/wiki/Reduced_instruction_set_computer)（如 PowerPC、RISC-V、SPARC...）中没有`push`和`pop`指令。这些操作是通过手动调整堆栈指针显式完成的，然后相对于调整后的指针加载/存储值。所有寄存器（除了零寄存器）都是通用的，所以理论上*任何寄存器*都可以是堆栈指针，堆栈可以向程序员想要的*任何方向增长*

也就是说，堆栈通常在大多数体系结构上增长，可能是为了避免堆栈和程序数据或堆数据增长并相互冲突的情况。还有提到[sh-'s answer](https://stackoverflow.com/a/55772636/995714)的重要解决原因。一些例子：MIPS ABI 向下增长并使用`$29`(AKA `$sp`) 作为堆栈指针，RISC-V ABI 也向下增长并使用 x2 作为堆栈指针

在 Intel 8051 中，堆栈增长，可能是因为内存空间非常小（原始版本为 128 字节）以至于没有堆，并且您不需要将堆栈放在顶部，以便将其与堆增长分开从底部

[您可以在https://en.wikipedia.org/wiki/Calling_convention](https://en.wikipedia.org/wiki/Calling_convention)中找到有关各种架构中堆栈使用的更多信息

也可以看看

*   [为什么堆栈向下增长？](https://softwareengineering.stackexchange.com/q/137640/98103)
*   [堆栈向下增长有什么好处？](https://www.reddit.com/r/AskComputerScience/comments/y4n1p/what_are_the_advantages_to_having_the_stack_grow/)
*   [为什么堆栈通常会向下增长？](https://stackoverflow.com/q/2035568/995714)
*   [堆栈是向上还是向下增长？](https://stackoverflow.com/q/1677415/995714)

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2014-01-25T14:23:13.553

在大多数系统上，堆栈会变小，我在[https://gist.github.com/cpq/8598782](https://gist.github.com/cpq/8598782)上的文章解释了为什么它会变小。很简单：如何在一块固定的内存中布局两个不断增长的内存块（堆和栈）？最好的解决方案是把它们放在相反的两端，让它们相互生长。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-03-20T02:20:20.687

它会增长，因为分配给程序的内存有“永久数据”，即程序本身的代码在底部，然后是堆在中间。您需要另一个固定点来引用堆栈，这样您就可以在顶部。这意味着堆栈会向下增长，直到它可能与堆上的对象相邻。

* * *

## 回答 #9

> 赞同：-1
> 
> 时间：2019-02-01T12:35:05.980

这个宏应该在没有 UB 的情况下在运行时检测到它：

```
#define stk_grows_up_eh() stk_grows_up__(&(char){0})
_Bool stk_grows_up__(char *ParentsLocal);

__attribute((__noinline__))
_Bool stk_grows_up__(char *ParentsLocal) { 
    return (uintptr_t)ParentsLocal < (uintptr_t)&ParentsLocal;
} 
```

# ruby-on-rails - 使用 Rspec 对链式方法进行存根

> ID：664755
> 
> 赞同：11
> 
> 时间：2009-03-20T02:03:36.857
> 
> 标签：ruby-on-rails, ruby, rspec, tdd, bdd

我想调用一个只返回一条记录的named_scope，但是named_scope返回一个数组，这没什么大不了的，因为我可以用.first链接它：

```
Model.named_scope(param).first 
```

这很有效，我正在努力解决的是如何存根链式调用。有没有人对我将如何通过 Rspec 模拟实现这一目标提供参考或答案？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2009-03-20T02:44:52.047

我想通了。

```
Client.stub!(:named_scope).and_return(@clients = mock([Client]))
@clients.stub!(:first).and_return(@client = mock(Client)) 
```

这允许我调用我的控制器：

```
@client = Client.named_scope(param).first 
```

它有效，但有更好的解决方案吗？

编辑：

rspec 1.2.6 的发布允许我们使用 stub_chain 意味着它现在可以是：

```
Client.stub_chain(:named_scope, :chained_call).and_return(@clients = [mock(Client)]) 
```

这是我的头等大事，一如既往地检查 api 的细节:)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2011-07-06T11:03:03.313

更好的版本

```
Client.stub!(:named_scope).and_return(@clients = mock([Client]))
@clients.stub!(:first).and_return(@client = mock(Client)) 
```

将会：

```
Client.should_receive(:named_scope).with(param).and_return do
  record = mock_model(Comm)
  record.should_receive(:do_something_else)
  [record]  
end 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-07-10T12:07:48.023

这个问题已经很老了，因此在如何进行存根方面几乎没有改进。现在您可以使用 stub_chain 方法来存根方法调用链。例如：

`@client = Client.named_scope(param).first`

可以存根：

`Client.stub_chain(:named_scope,:first).and_return(@client = mock(Client))`

stub_chaining 的更多示例：

```
describe "stubbing a chain of methods" do
  subject { Object.new }

  context "given symbols representing methods" do
    it "returns the correct value" do
      subject.stub_chain(:one, :two, :three).and_return(:four)
      subject.one.two.three.should eq(:four)
    end
  end

  context "given a string of methods separated by dots" do
    it "returns the correct value" do
      subject.stub_chain("one.two.three").and_return(:four)
      subject.one.two.three.should eq(:four)
    end
  end
end 
```

[或者请看一下：](https://www.relishapp.com/rspec/rspec-mocks/v/2-0/docs/stubs/stub-a-chain-of-methods#stub-a-chain-of-methods)

rspecs 万岁！！！:)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-20T11:41:39.213

我想这是在控制器规范中？

您自己的建议应该可以正常工作。另一种可能性是在模型中移动 named_scope 调用，以完全避免该问题。这也符合“胖模型，瘦控制器”的建议。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-20T20:34:14.613

我认为您已经通过将查询放入可以重用的命名范围来完成瘦控制器的工作。这是我开始使用命名范围之前使用的一些代码。

```
 def mock_comm(stubs={})
    @mock_comm ||= mock_model(Comm, stubs)
  end

  describe "responding to GET index" do

    it "should expose all comms as @comms" do
      Comm.should_receive(:find).with(:all).and_return([mock_comm])
      get :index
      assigns[:comms].should == [mock_comm]
    end
# ... 
```

我可能会编写与您已经编写的代码非常相似的代码，但可能会将其放在允许我重用它的帮助程序中。另一件事是使用不同的模拟框架，它可能会给你更多的控制权。看看 Ryan Bates 在 RSpec 上的 railscast——它现在有点老了，但仍然有一些好主意。

# smtp - 是否所有 SMTP 通信都发生在 25 岁以上？

> ID：664758
> 
> 赞同：13
> 
> 时间：2009-03-20T02:04:59.927
> 
> 标签：smtp

所有 SMTP 通信是否在端口 25 上的域之间发送电子邮件？所有的通信都是不安全的吗？了解使用类似 Gmail 的通信对 Gmail 服务器是安全的，但之后必须使用不安全的端口 25，对吗？

SMTP 可以在任何端口上，但这不是我要说的。我不是在谈论连接到 Gmail、Yahoo 或 ISP SMTP 服务器。这些是 SMTP 中继，它们在希望为用户加密/未加密的任何端口上接受 SMTP 请求。

但是一旦 SMTP 中继服务器收到请求，邮件服务器会根据域名 MX 记录将其转发给电子邮件。它只在端口 25 上使用 SMTP 吗？邮件服务器只知道域名，然后转发。它无法知道他们正在监听哪个端口。

例如，我正在为我的域托管 Exchange server 2007。我连接到我的 Exchange 服务器以向 xyz@gmail.com 发送邮件。我的交换服务器必须通过行业标准协议进行通信，对吧？那是端口 25（因为我的 Exchange 服务器没有端口 25 就无法工作）。

* * *

## 回答 #1

> 赞同：34
> 
> 时间：2009-03-20T15:00:36.130

以为我会介入这里，因为我以编写电子邮件软件为生。

SMTP 流量有两种常见情况：1）服务器到服务器和 2）客户端到服务器。

1）服务器到服务器 所有公共服务器到服务器的电子邮件通信都通过端口 25 进行。如果您希望您的域接收来自其他域的电子邮件，那么您必须在端口 25 接受 SMTP 流量。这是不安全的。它以明文形式发送。有多种编码特定消息的方法，但就流量而言，它以 ascii 文本（显然是二进制格式）发送。但是，它不是通过 SSL 发送的。

还有一些私人服务器到服务器的通信可以发生。这可能发生在大型组织中，他们可能拥有每个人都使用的内部公司服务器。当您发送电子邮件时，它会被发送到公司服务器，但随后该公司服务器会将电子邮件转发到面向公众的服务器。该面向公众的服务器将电子邮件发送到接收服务器。该接收服务器正在端口 25 接受电子邮件。

2）客户端到服务器。这有更多的选择。在服务器上，您可以配置不同的提交端口（打开您将接受电子邮件的端口）。这些可以是您希望它们成为的任何东西。您只需要记住告诉您的用户正确配置客户端软件。最常见的端口是 25 和 587。许多 ISP 会阻止传出端口 25（因为这是垃圾邮件机器人使用的端口——发送到公共邮件服务器）。但是，他们打开了 587，因此您可以将电子邮件发送到您的 SMTP 服务器。SMTP over SSL 的通用端口是 465。

显然，这可能会变得更加复杂，并且我遗漏了一些细节，但简而言之就是这样。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-03-20T02:10:04.080

不可以。SMTP 可以设置为使用 25 以外的端口，尽管这是使用的标准端口。

[SMTP](http://en.wikipedia.org/wiki/Simple_Mail_Transfer_Protocol)是一种协议——它指定如何传输信息。另一方面，SMTP 服务器是执行传输的软件（独立于协议本身）。SMTP 端口实际上是一个监听端口——客户端连接到这个端口是为了使用服务器——但它与协议本身是分开的。许多邮件服务器设置为使用其他端口。例如，Dreamhost 将其邮件服务器设置为同时使用端口 25 和 465。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-03-20T02:10:41.520

你可以使用任何端口，真的。端口 25 是一个约定，仅此而已。我听说一些提供商会阻止 25 端口的传出流量（以控制垃圾邮件机器人），人们不得不切换到其他端口。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-03-20T06:35:31.853

Internet 上邮件服务器之间的几乎所有通信都在端口 25 上完成。这是众所周知的端口。

请参阅[rfc4409](http://www.ietf.org/rfc/rfc4409.txt)，它保留 tcp/587 作为 SMTP 的备用提交端口。端口 25 和 587 保留用于 SMTP，并通过 IANA [http://www.iana.org/assignments/port-numbers](http://www.iana.org/assignments/port-numbers)提交。

SMTP 可以通过端口 25 上的 TLS 进行保护，但这似乎并未广泛用于 Internet 电子邮件，但我知道它用于某些网络上的一些内部通信。

许多 ISP 似乎也接受在 tcp/465 上提交，但此端口并未为此目的正式注册。

当然，任何邮件服务器都可以在任何端口上侦听 SMTP，但是发送服务器没有任何方法可以发现备用端口，并且必须假定它在端口 25 上。

我知道有些组织接受邮件客户端在其他不寻常端口（如 2525 等）上提交的邮件。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-20T02:12:55.073

大多数当前的电子邮件软件（客户端和服务器）都可以将 SSL/TLS 用于 SMTP。这通常意味着端口 25 是未加密的 SMTP，端口 465 是加密的。实际的端口号可以更改，只有按照惯例，端口 25 是 SMTP。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-20T02:12:47.210

SMTP 默认使用端口 25，但可以使用任何端口。

Gmail SMTP 服务器需要端口 465 上的加密连接 (SSL)。

# python - 如何使图像亮度均匀（使用 Python/PIL）

> ID：664760
> 
> 赞同：5
> 
> 时间：2009-03-20T02:05:35.947
> 
> 标签：python, image, image-processing, python-imaging-library, brightness

我想为已拍摄的文档拍摄图像，并使其看起来像是经过扫描的。由于扫描仪会在整个文档上放置一个恒定的光源，我想在文档的照片上实现这种效果。所需的效果是消除任何阴影或低光区域（或至少使它们不那么明显）并使整张照片相当明亮。

我的第一个想法是找到目标图像中最亮的部分，然后它们使整个图像变得如此明亮。假设这甚至是正确的算法，我将如何在 PIL 中做到这一点？有没有获取亮度的方法？ETC？

[（这是这个早先问题](https://stackoverflow.com/questions/662638/how-to-alter-photographed-document-to-look-scanned)的后续。）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-20T02:33:23.963

作为第一次尝试，尝试对图像进行阈值处理。暗区变为黑色，亮区变为白色。我没有使用过 PIL，但我想有任何简单的方法可以做到这一点。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-20T02:54:27.687

使用 2 个图像副本尝试 ImageChops.screen(image1, image2)。如果不满意，请尝试 ImageChops 模块中的其他一些功能。

此外，您可能需要先将其转换为灰度：ImageOps.grayscale(image)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-24T10:12:01.160

首先在图像编辑程序中手动尝试，如 GIMP。我认为您正在寻找的是调整亮度和对比度。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-12T02:55:33.223

什么类型的图像？如果它应该是理想的纯黑白，就像文本页面一样，那么您的原始数据可能类似于灰度渐变，其中包含不同级别的非全黑字母。对常数设置阈值可能会产生良好的结果，但如果照明太不均匀或镜头眩光干扰则不会。对图像本身的平滑版本进行阈值处理。使用 PIL_usm.gblur(image, radius) 对其进行平滑处理，其中半径（以像素为单位）类似于十、二十或与字母元素宽度相当的某个值。旧笔记中的快速黑客代码仅用于说明：

```
import Image
import PIL_usm
# see http://www.cazabon.com/pyCMS/PIL_usm.html for PIL_usm

img = Image.open(...)
sm = PIL_usm(img, 10)
thr = Image.ImageChops.subtract(img,sm, .001, 128)  
# or whatever works 4u... 
```

OTOH，如果这些文件有照片或其他非双层图形，你需要更聪明。

# svn - TortoiseSVN 不要求身份验证？

> ID：664761
> 
> 赞同：25
> 
> 时间：2009-03-20T02:06:17.677
> 
> 标签：svn, authentication, tortoisesvn

我在 conf 文件中设置了一个新的 SVN 存储库，运行 SVNServe，anon-access = none。

SVNServe 忠实地做到了这一点，但是当我尝试使用 TortoiseSVN 浏览存储库时，它只是说不允许访问。它不应该问我用户名和密码吗？

如何让 TortoiseSVN 询问我的登录信息？

运行 SVN 1.5.6、TortoiseSVN 1.5.9

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2009-03-20T02:12:30.393

它可能保存了一些身份验证数据，请尝试：

右键->乌龟->设置->保存数据->验证数据-清除。

在某些情况下，“清除”-身份验证数据按钮保持禁用状态，然后重命名保存证书的文件夹。下次SVN会自动询问密码。

* * *

## 回答 #2

> 赞同：23
> 
> 时间：2009-03-20T02:20:46.707

抱歉，没有取消注释配置中的以下行：

密码-db = passwd

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-04-23T10:00:10.930

我在使用 beanstalkapp.com 时遇到了同样的问题，并且在指定 svn checkout url 时能够通过使用 http* *s * 而不是 http 来解决它。*

这就是我不复制和粘贴的结果。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2015-10-23T15:03:36.000

只是想添加一个额外的解决方案，可能会阻止 TortoiseSVN 要求身份验证。我遇到的情况是用户可以从其他机器上进行身份验证，但是在这台机器上它会失败，并出现“意外的 HTTP 状态 503 '服务不可用'”并且不要求进行身份验证。Tortoise Settings > Saved Data > Authentication Data 是明确的，我们可以删除 %APPDATA%\Roaming\subversion\ 文件无济于事。事实证明，在某些时候，用户试图通过设置网络代理来“修复”问题。

*   **解决方案：Tortoise > 设置 > 网络 > 取消选中启用代理服务器**

干杯，希望这对某人有所帮助。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2011-08-29T16:28:08.243

如果“清除”-身份验证数据按钮仍然禁用，尽管保存证书，但只需重命名保存证书的文件夹。下次SVN会自动询问密码。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2016-09-23T05:16:35.607

有人认为我刚刚发现，svnserve 配置中有一个 -R（对所有 repos 都是只读的）在安装时放在那里 - 一件简单的事情，但这对我来说是全新的......

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2016-09-28T08:18:13.257

如果你通过 DirectAccess 连接，你应该下载 TortoiseSVN 的 IPv6 版本。[您可以在此处](https://sourceforge.net/projects/tortoisesvn/files/)找到最新版本。

它可以在文件夹*版本*/Application/ipv6下找到

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2017-04-05T05:50:50.950

更新密码后重新启动系统。重启后 SVN 将重新配置自身并要求身份验证而不是使用以前存储的密码

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2017-04-06T04:00:45.160

设置 - 高级 - AllowAuthSave = true

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2019-07-31T17:04:30.790

如果您更改 Windows 密码以使 Tortoise SVN 正常工作，您必须关闭并重新打开 PC。清除身份验证令牌不起作用，重新安装软件也不起作用。但是，重新启动并重新登录到 Windows 帐户确实有效。我想这与它集成到您​​的域帐户的方式有关。重启后它没有要求输入新密码。

# java - 使用 Java 抓取最近播放的 iTunes 歌曲

> ID：664771
> 
> 赞同：1
> 
> 时间：2009-03-20T02:13:00.050
> 
> 标签：java, com, itunes

将有关在 iTunes 中播放的最后一首歌曲的信息获取到 Java 程序中的最简单方法是什么？我看过 JACOB 和 iTunes COM，但它们看起来有点矫枉过正。如果这是唯一的方法，有人可以在第一个谷歌结果旁边提供一个很好的例子吗？“hack”方法也是可以接受的！

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-20T05:35:55.083

iTunes is pretty callable from AppleScript, I'd start there.

Looks like Apple's stuff is deprecated, [jasconn](https://jasconn.dev.java.net/) looks like it's the way forward.

EDIT - Point taken about the mention of COM, points the finger at Windows rather than a Mac. My suggestion for the super hack approach would be to fire up [Process Monitor](http://technet.microsoft.com/en-us/sysinternals/bb896645.aspx) and see what iTunes writes out and to where when you play a song.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-20T10:13:03.810

在 Windows 下，您必须使用 COM 与 iTunes 通信。

有一个 iTunes SDK 可用，它提供了您可以使用的胶水。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-21T03:16:12.587

或者，您可以使用 lastfm 网络服务。它将在 xml 提要中包含所有最近播放的歌曲。

当你播放歌曲时，你只需要连接到互联网

# sql - 使用 MySQL 将任务分配给工作进程的正确方法

> ID：664774
> 
> 赞同：0
> 
> 时间：2009-03-20T02:13:40.250
> 
> 标签：sql, mysql, transactions, innodb

我在 MySQL InnoDB 表中有一个巨大的 URL 列表，以及查询 MySQL 以获取一组要处理的 URL 的工作进程。URL 应立即标记为正在处理，以便其他工作进程不会因为开始处理相同的工作进程而浪费资源。

目前我首先这样做是为了获取一些 URL：

```
SELECT DISTINCT url FROM urls WHERE task_assigned is NULL ORDER BY id LIMIT 100 
```

然后在代码中，我天真地遍历每个 URL 以将其标记为正在处理：

```
UPDATE urls SET task_assigned = NOW() WHERE url = ? COLLATE utf8_bin 
```

我非常清楚这是多么愚蠢和低效。更重要的是，不能保证另一个工作进程不会尝试在我的 UPDATE 中间获取列表。这样做的美丽方法是什么？我是否应该进行交易，如何？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-20T02:22:10.853

以下出现（通过快速浏览 MySQL 5 手册）在 MySQL 中可用；我不确定这是否是最好的方法，但我之前在 PostgreSQL 中使用过：

```
BEGIN TRANSACTION;
SELECT DISTINCT url FROM urls WHERE task_assigned is NULL ORDER BY id LIMIT 100 FOR UPDATE;
UPDATE urls SET task_assigned = NOW() WHERE url IN [list of URLs] COLLATE utf8_bin;
COMMIT; 
```

实际上，在 PostgreSQL 中，我会使用*单个*UPDATE 语句，其中 UPDATE 的 RETURNING 子句代替 SELECT，但这是特定于 PostgreSQL 的扩展。

我在您的方法中看到的一个潜在问题是 URL 重复：如果 url`http://www.example.com/`在您的表中出现两次，例如 ID 为 23 和 42，则 SELECT 将返回这两个 ID 之一，但 UPDATE 会影响这两行。我不知道这种行为在您的应用程序中是否有意义；我可能会对 URL 施加某种 UNIQUE 约束，这样它就不会发生，然后在`IN`子句中使用 ID 列表，而不是 URL（应该更快）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-20T02:21:21.043

也许您应该先选择所有 URL，然后使用线程异步解析它们？

# ios - 更改 UITableView 节标题的默认滚动行为

> ID：664781
> 
> 赞同：152
> 
> 时间：2009-03-20T02:19:47.897
> 
> 标签：ios, iphone, uitableview, cocoa-touch

我有一个包含两个部分的 UITableView。这是一个简单的表格视图。我正在使用 viewForHeaderInSection 为这些标题创建自定义视图。到目前为止，一切都很好。

默认滚动行为是，当遇到一个部分时，部分标题保持锚定在导航栏下方，直到下一个部分滚动到视图中。

我的问题是：我可以更改默认行为，以便节标题不会停留在顶部，而是在导航栏下滚动其余部分行？

我错过了一些明显的东西吗？

谢谢。

* * *

## 回答 #1

> 赞同：175
> 
> 时间：2010-10-21T05:36:49.160

我解决这个问题的方法是`contentOffset`根据（扩展）`contentInset`中的调整如下：`UITableViewControllerDelegate``UIScrollViewDelegate`

```
- (void)scrollViewDidScroll:(UIScrollView *)scrollView {
       CGFloat sectionHeaderHeight = 40;
   if (scrollView.contentOffset.y<=sectionHeaderHeight&&scrollView.contentOffset.y>=0) {
       scrollView.contentInset = UIEdgeInsetsMake(-scrollView.contentOffset.y, 0, 0, 0);
   } else if (scrollView.contentOffset.y>=sectionHeaderHeight) {
       scrollView.contentInset = UIEdgeInsetsMake(-sectionHeaderHeight, 0, 0, 0);
   }
} 
```

这里唯一的问题是它在滚动回顶部时会失去一点反弹。

* * *

*{注意：“40”应该是您的第 0 节标题的确切高度。如果您使用大于第 0 节标题高度的数字，您会看到手指感觉受到影响（尝试像“1000”，您会看到弹跳行为在顶部有点奇怪）。如果数字与您的第 0 节标题高度匹配，则手指感觉似乎是完美或接近完美。}*

* * *

## 回答 #2

> 赞同：86
> 
> 时间：2011-02-26T15:14:03.477

您还可以在顶部添加一个零行的部分，只需将上一部分的页脚用作下一部分的页眉。

* * *

## 回答 #3

> 赞同：36
> 
> 时间：2009-12-20T08:54:04.330

如果是我这样做，我会利用 Plain 样式的 UITableViews 具有粘性标题而 Grouped 样式的 UITableViews 没有这一事实。我可能至少会尝试使用自定义表格单元格来模仿分组表格中普通单元格的外观。

我实际上还没有尝试过，所以它可能不起作用，但这就是我建议做的。

* * *

## 回答 #4

> 赞同：28
> 
> 时间：2011-12-02T00:28:47.500

我知道它来晚了，但我找到了最终的解决方案！

您想要做的是，如果您有 10 个部分，让 dataSource 返回 20。部分标题使用偶数，部分内容使用奇数。像这样的东西

```
- (NSInteger)tableView:(UITableView *)tableView numberOfRowsInSection:(NSInteger)section {
    if (section%2 == 0) {
        return 0;
    }else {
        return 5;
    }
}

-(NSString *)tableView:(UITableView *)tableView titleForHeaderInSection:(NSInteger)section {
    if (section%2 == 0) {
        return [NSString stringWithFormat:@"%i", section+1];
    }else {
        return nil;
    }
} 
```

瞧！:D

* * *

## 回答 #5

> 赞同：16
> 
> 时间：2013-01-30T17:12:02.373

最初发布[在这里](https://stackoverflow.com/a/4295687/1669034 "由@samvermette 回答")，使用 IB 的快速解决方案。虽然很简单，但同样可以通过编程方式完成。

> 实现此目的的一种可能更简单的方法（使用 IB）：
> 
> 将 UIView 拖到 TableView 上以使其成为标题视图。
> 
> 1.  将该标题视图高度设置为 100px
> 2.  将 tableview contentInset (top) 设置为 -100
> 3.  部分标题现在将像任何常规单元格一样滚动。

有人评论说这个解决方案隐藏了第一个标题，但是我没有注意到任何这样的问题。它对我来说非常有效，是迄今为止我见过的最简单的解决方案。

* * *

## 回答 #6

> 赞同：15
> 
> 时间：2011-08-01T16:13:47.353

需要做几件事来以一种非 hacky 的方式解决这个问题：

1.  将表格视图样式设置为`UITableViewStyleGrouped`
2.  将表格视图设置`backgroundColor`为`[UIColor clearColor]`
3.  将`backgroundView`每个表视图单元格上的设置为空视图`backgroundColor [UIColor clearColor]`
4.  如有必要，适当设置表格视图`rowHeight`，或者`tableView:heightForRowAtIndexPath:`在各个行具有不同高度时覆盖。

* * *

## 回答 #7

> 赞同：15
> 
> 时间：2013-02-28T18:50:28.887

到目前为止，我对这里描述的解决方案并不满意，所以我尝试将它们结合起来。结果是以下代码，灵感来自@awulf 和@cescofry。它对我有用，因为我没有真正的表格视图标题。如果您已经有一个表格视图标题，您可能需要调整高度。

```
// Set the edge inset
self.tableView.contentInset = UIEdgeInsetsMake(-23.0f, 0, 0, 0);

// Add a transparent UIView with the height of the section header (ARC enabled)
[self.tableView setTableHeaderView:[[UIView alloc] initWithFrame:CGRectMake(0.0f, 0.0f, 100.0f, 23.0f)]]; 
```

* * *

## 回答 #8

> 赞同：15
> 
> 时间：2015-07-14T21:36:00.883

**只需更改 TableView 样式：**

```
self.tableview = [[UITableView alloc] initwithFrame:frame style:UITableViewStyleGrouped]; 
```

[UITableViewStyle 文档](https://developer.apple.com/documentation/uikit/uitableviewstyle)：

> UITableViewStylePlain - 一个普通的表格视图。滚动表格视图时，任何部分的页眉或页脚都显示为内联分隔符并浮动。
> 
> UITableViewStyleGrouped - 一个表格视图，其部分呈现不同的行组。部分页眉和页脚不浮动。

* * *

## 回答 #9

> 赞同：11
> 
> 时间：2017-04-04T04:35:09.963

[![选择分组的 TableView 样式](https://i.stack.imgur.com/168As.png)](https://i.stack.imgur.com/168As.png)

从情节提要中的 tableView 的 Attribute Inspector 中选择 Grouped Table View 样式。

* * *

## 回答 #10

> 赞同：5
> 
> 时间：2011-08-11T14:37:09.363

将表格的 headerView 设置为与剖面视图中的标题相同高度的透明视图。还要在 -height 处使用 ay 框架初始化 tableview。

```
self.tableview = [[UITableView alloc] initWithFrame:CGRectMake(0, - height, 300, 400)];

UIView *headerView = [[[UIView alloc] initWithFrame:CGRectMake(0, 0, width, height)] autorelease];
[self.tableView setTableHeaderView:headerView]; 
```

* * *

## 回答 #11

> 赞同：5
> 
> 时间：2016-05-08T02:30:39.357

更改您的 TableView 样式：

```
self.tableview = [[UITableView alloc] initwithFrame:frame style:UITableViewStyleGrouped]; 
```

根据 UITableView 的苹果文档：

> UITableViewStylePlain - 一个普通的表格视图。滚动表格视图时，任何部分的页眉或页脚都显示为内联分隔符并浮动。
> 
> UITableViewStyleGrouped - 一个表格视图，其部分呈现不同的行组。部分页眉和页脚不浮动。希望这个小小的改变能帮助你..

* * *

## 回答 #12

> 赞同：4
> 
> 时间：2012-10-19T16:46:08.053

我找到了一个替代解决方案，使用每个部分的第一个单元格而不是真正的标题部分，这个解决方案看起来不那么干净，但工作得很好，您可以为标题部分使用定义的原型单元格，并在方法**cellForRowAtIndexPath**要求 indexPath.row==0，如果为真，则使用标题部分原型单元格，否则使用您的默认原型单元格。

* * *

## 回答 #13

> 赞同：2
> 
> 时间：2014-04-09T00:40:48.490

现在，分组样式看起来与 iOS 7 中的普通样式基本相同（在平整度和背景方面），对我们来说，最好和最简单（即最少 hacky）的解决方法是简单地将表格视图的样式更改为分组。当我们在顶部集成滚动导航栏时，使用 contentInsets 一直是个问题。使用分组表视图样式，它看起来完全一样（与我们的单元格），并且节标题保持固定。没有滚动怪异。

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2010-10-08T22:22:32.797

为您的 tableView 分配一个负插图。如果您有 22px 高的部分标题，并且您不希望它们变得粘稠，请在 reloadData 添加后立即添加：

```
self.tableView.contentInset = UIEdgeInsetsMake(-22, 0, 0, 0); 
self.tableView.contentSize = CGSizeMake(self.tableView.contentSize.width, self.tableView.contentSize.height+22); 
```

对我来说就像一个魅力。也适用于部分页脚，只需在底部分配负插图。

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2012-12-06T01:23:30.273

[在这里](https://stackoverflow.com/a/13735238/1880899)检查我的答案。这是在没有任何技巧的情况下实现非浮动节标题的最简单方法。

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2010-05-10T00:11:43.223

我将表格添加到滚动视图中，这似乎运作良好。

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2013-04-21T16:39:01.467

@LocoMike 的答案最适合我的 tableView，但是在使用页脚时它也坏了。因此，这是使用页眉和页脚时的更正解决方案：

```
- (NSInteger)numberOfSectionsInTableView:(UITableView *)tableView
{
    return (self.sections.count + 1) * 3;
}

- (NSInteger)tableView:(UITableView *)tableView numberOfRowsInSection:(NSInteger)section
{
    if (section % 3 != 1) {
        return 0;
    }
    section = section / 3;
    ...
}

- (NSString *)tableView:(UITableView *)tableView titleForHeaderInSection:(NSInteger)section
{
    if (section % 3 != 0) {
        return nil;
    }
    section = section / 3;
    ...
}

- (CGFloat)tableView:(UITableView *)tableView heightForHeaderInSection:(NSInteger)section
{
    if (section % 3 != 0) {
        return 0;
    }
    section = section / 3;
    ...
}

- (CGFloat)tableView:(UITableView *)tableView heightForFooterInSection:(NSInteger)section
{
    if (section % 3 != 2) {
        return 0;
    }
    section = section / 3;
    ...
}

- (UIView *)tableView:(UITableView *)tableView viewForHeaderInSection:(NSInteger)section
{
    if (section % 3 != 0) {
        return nil;
    }
    section = section / 3;
    ...
}

- (UIView *)tableView:(UITableView *)tableView viewForFooterInSection:(NSInteger)section
{
    if (section % 3 != 2) {
        return nil;
    }
    section = section / 3;
    ...
}

- (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath
{
    int section = indexPath.section;
    section = section / 3;
    ...
} 
```

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2016-09-07T16:50:15.620

@awulf 答案的 Swift 版本，效果很好！

```
func scrollViewDidScroll(scrollView: UIScrollView) {
    let sectionHeight: CGFloat = 80
    if scrollView.contentOffset.y <= sectionHeight {
        scrollView.contentInset = UIEdgeInsetsMake( -scrollView.contentOffset.y, 0, 0, 0)
    }else if scrollView.contentOffset.y >= sectionHeight {
        scrollView.contentInset = UIEdgeInsetsMake(-sectionHeight, 0, 0, 0)
    }
} 
```

* * *

## 回答 #19

> 赞同：-2
> 
> 时间：2012-01-23T12:19:34.693

我了解到，只需设置 tableHeaderView 属性就可以了，即：

```
 tableView.tableHeaderView = customView; 
```

就是这样。

# latex - LaTeX中矩阵的行和列标记

> ID：664798
> 
> 赞同：21
> 
> 时间：2009-03-20T02:28:44.333
> 
> 标签：latex, matrix

如何将标签添加到矩阵上方和左侧（均在外部）但明显与所述列和行对齐的列和行（例如`a`、`b`、`c`等）？`d`

一个示例矩阵：

```
\[
\begin{pmatrix}
t   & 1-t &  -1 &  0  &  0  \\
0   &  t  & 1-t &  -1 &  0  \\
0   &  0  &  t  & 1-t &  -1 \\
-1  &  0  &  0  &  t  & 1-t \\
1-t &  -1 &  0  &  0  &  t
\end{pmatrix}
\] 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-01-15T19:16:56.657

您可能想尝试**kbordermatrix**包。它的文档可以在[这里](http://www.hss.caltech.edu/~kcb/TeX/kbordermatrix.pdf)找到（注意这个包不是 CTAN 的一部分）。它比老式的边界矩阵更现代和**先进**。下面是一个示例：

```
\usepackage{kbordermatrix} % include package @ document preamble
\renewcommand{\kbldelim}{(} % change default array delimiters to parentheses
\renewcommand{\kbrdelim}{)}

% ...

\[
\kbordermatrix{
    \mbox{corner_text}&\alpha & \beta & \gamma & \delta \\ % column indices
    1 & t   & 1-t &  -1 &  0  &  0  \\
    2 & 0   &  t  & 1-t &  -1 &  0  \\
    3 & 0   &  0  &  t  & 1-t &  -1 \\
    4 & -1  &  0  &  0  &  t  & 1-t \\
    5 & 1-t &  -1 &  0  &  0  &  t
    % 1, 2, 3, 4, 5 are row indices
}
\] 
```

# javascript - JQuery 在没有插件的情况下对表格进行排序

> ID：664802
> 
> 赞同：4
> 
> 时间：2009-03-20T02:32:32.670
> 
> 标签：javascript, jquery

是否有一个 jquery 函数来对表进行排序。我知道 JQuery Tablesorter 插件，但我想尽可能避免使用它。

作为一个仅供参考 - 我有一个带有自定义图像的表头来指示升序和降序。数据类型几乎可以是任何类型。

编辑：我可以在 Javascript 中对表格进行排序吗？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-08-29T05:34:36.377

It is very much possible. You can do it like this

```
function sortTable(table, col, reverse) {
    var tb = table.tBodies[0], // use `<tbody>` to ignore `<thead>` and `<tfoot>` rows
        tr = Array.prototype.slice.call(tb.rows, 0), // put rows into array
        i;
    reverse = -((+reverse) || -1);
    tr = tr.sort(function (a, b) { // sort rows
        return reverse // `-1 *` if want opposite order
            * (a.cells[col].textContent.trim() // using `.textContent.trim()` for test
                .localeCompare(b.cells[col].textContent.trim())
               );
    });
    for(i = 0; i < tr.length; ++i) tb.appendChild(tr[i]); // append each row in order
}

function makeSortable(table) {
    var th = table.tHead, i;
    th && (th = th.rows[0]) && (th = th.cells);
    if (th) i = th.length;
    else return; // if no `<thead>` then do nothing
    while (--i >= 0) (function (i) {
        var dir = 1;
        th[i].addEventListener('click', function () {sortTable(table, i, (dir = 1 - dir))});
    }(i));
}

function makeAllSortable(parent) {
    parent = parent || document.body;
    var t = parent.getElementsByTagName('table'), i = t.length;
    while (--i >= 0) makeSortable(t[i]);
}

window.onload = function () {makeAllSortable();}; 
```

Take a look at this [Fiddle](http://jsfiddle.net/zscQy/)

(I am not the author of code above or that fiddle, I just found it while searching for the solution.)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-20T15:43:45.107

Javascript 大师 Stuart Langridge 有一个很好的替代 jQuery 的方法，叫做 tablesorter.js

[http://www.kryogenix.org/code/browser/sorttable/](http://www.kryogenix.org/code/browser/sorttable/)

我以前用过它；效果很好，而且非常轻巧。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-06-02T23:06:02.797

我不得不稍微更改排序功能，以便它忽略非数字字符，希望这可以节省一些时间......

```
function sortTable(table, col, reverse) {
    var tb = table.tBodies[0], // use `<tbody>` to ignore `<thead>` and `<tfoot>` rows
    tr = Array.prototype.slice.call(tb.rows, 0), // put rows into array
    i;

    reverse = ((+reverse) || -1);

    tr = tr.sort(function (a, b) { // sort rows
        return reverse * (Number(a.cells[col].textContent.replace(/[^\d.-]/g, ''))
             - Number(b.cells[col].textContent.replace(/[^\d.-]/g, '')));
    });

    for(i = 0; i < tr.length; ++i) tb.appendChild(tr[i]); // append each row in order
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2018-09-29T01:55:53.403

[https://www.w3schools.com/howto/howto_js_sort_table.asp](https://www.w3schools.com/howto/howto_js_sort_table.asp)

```
function sortTable() {
  var table, rows, switching, i, x, y, shouldSwitch;
  table = document.getElementById("myTable");
  switching = true;
  /* Make a loop that will continue until
  no switching has been done: */
  while (switching) {
    // Start by saying: no switching is done:
    switching = false;
    rows = table.rows;
    /* Loop through all table rows (except the 
    first, which contains table headers): */
    for (i = 1; i < (rows.length - 1); i++) {
      // Start by saying there should be no switching:
      shouldSwitch = false;
      /* Get the two elements you want to compare,
      one from current row and one from the next: */
      x = rows[i].getElementsByTagName("TD")[0];
      y = rows[i + 1].getElementsByTagName("TD")[0];
      // Check if the two rows should switch place:
      if (x.innerHTML.toLowerCase() > y.innerHTML.toLowerCase()) {
        // If so, mark as a switch and break the loop:
        shouldSwitch = true;
        break;
      }   
    }   
    if (shouldSwitch) {
      /* If a switch has been marked, make the switch
      and mark that a switch has been done: */
      rows[i].parentNode.insertBefore(rows[i + 1], rows[i]);
      switching = true;
    }   
  }   
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2015-06-09T00:11:53.683

**对于小桌子，我这样做......**

```
sortTable = function(tableName, rowClass, columnNumber, ascending) {
    var row, cell, cellContent;
    var comparisonRow, comparisonCell, comparisonContent;

    $("#" + tableName + " tr." + rowClass).each(function(i) {
        row = $("#" + tableName + " tr." + rowClass + ":eq(" + i + ")");
        cell = $(row).find("td:eq(" + columnNumber + ")");
        cellContent = $(cell).html();

        $("#" + tableName + " tr." + rowClass).each(function(j) {
            comparisonRow = $("#" + tableName + " tr." + rowClass + ":eq(" + j + ")");
            comparisonCell = $(comparisonRow).find("td:eq(" + columnNumber + ")");
            comparisonContent = $(comparisonCell).html();

            if ( (ascending && cellContent < comparisonContent) || (!ascending && cellContent > comparisonContent) ) {
                $(row).insertBefore(comparisonRow);
                return false;
            }
        });
    });
}; 
```

*说明：*该函数遍历指定表的每一行（指定类），记录 HTML 内容（从指定列的单元格），然后遍历表的所有行比较单元格内容（再次从指定的列）。当单元格内容更少或更多时（基于“升序”是否设置为 true），该行将插入到与之比较的那一行之前。

**一个示例调用将是...**

```
sortTable("sample_table", "data_row", 0, true); 
```

...它将根据第一列（即列索引 0）中的单元格按升序对名为“sample table”的表中具有“data_row”类的行进行排序。

**对于更大的表格和附加功能，我使用...**

*   [数据表](https://www.datatables.net/)

在盒子的右边，我发现 DataTables 比 TableSorter 更容易使用（例如，除非你愿意，否则不需要引用或合并额外的 CSS 和艺术品），并且文档非常好。我也喜欢默认功能（例如，它的搜索功能）。

# javascript - 你认为视频内容可以用 JavaScript 编码吗？

> ID：664806
> 
> 赞同：1
> 
> 时间：2009-03-20T02:35:47.733
> 
> 标签：javascript, video, video-streaming

我知道这听起来会怎样。

[看了http://www.chromeexperiments.com/](http://www.chromeexperiments.com/)后忍不住问了这个问题

关于可能的实施方法的任何想法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-20T02:41:52.257

视频编码现在是一个比较成熟的领域。将已知方法应用于 JavaScript 仅意味着将不切实际数量的部分图像和关键帧数据作为原始二进制 blob 转储到 JS 文件中。JavaScript 没有任何特性可以提供任何优势，甚至可以与现有方法相提并论。

当然，这并不是说不会开发新的方法。但我非常怀疑未来的创作者会在网站上免费发布它们:)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-20T02:43:55.233

我想困难的部分是找到一种合适的方法来显示图形，而不是编码。提供一个可以转储图形的原始内存地址并不是真正的画布风格。

# ruby-on-rails - 在rails中使用acts_as_list和has_many:through

> ID：664807
> 
> 赞同：5
> 
> 时间：2009-03-20T02:35:49.853
> 
> 标签：ruby-on-rails, ruby, ajax

我有一个rails 应用程序，我正在尝试使用acts_as_list 插件设置可排序列表。数据库中的位置字段正在更新，但是在呈现页面时，不考虑顺序。我在寻求帮助，我猜。

这是我的模型...

```
class QuestionMembership < ActiveRecord::Base
  belongs_to :form
  belongs_to :question
  acts_as_list
end

class Form < ActiveRecord::Base
  has_many :question_memberships
  has_many :questions, :through => :question_memberships
end

class Question < ActiveRecord::Base
  has_many :question_memberships
  has_many :forms, :through => :question_memberships
  acts_as_list
end 
```

以及给我列表的草率视图代码......

```
<% @form.question_memberships.each do |qm| %>
  <% q_id = "question_#{qm.id}" %>
  <li class="question" id=<%= q_id %> >
    <div style="color: #999; font-size: 8pt">
      <%=h qm.question.content %>
    </div>
  </li>
  <%= draggable_element(q_id, :revert=>true) %>
<% end %> 
```

拖放适用于重新排序。QuestionMembership 对象的位置值在数据库中更新，页面实际上正确显示了重新排序。问题是在页面重新加载时，它默认返回到它感觉的任何顺序。我认为它默认为订单的问题 ID，而不是 question_membership 位置，但我不确定。

关于如何通过 QuestionMembership 的位置字段使其在初始渲染中实际排序的任何想法？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-03-23T17:27:46.657

最终版本：

```
class QuestionMembership < ActiveRecord::Base
  belongs_to :form
  belongs_to :question
  acts_as_list :scope => :form
end

class Form < ActiveRecord::Base
  has_many :question_memberships, :order => "position"
  has_many :questions, :through => :question_memberships
end

class Question < ActiveRecord::Base
  has_many :question_memberships, :order => "position"
  has_many :forms, :through => :question_memberships
  acts_as_list :scope => :form
end 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-20T02:39:13.760

只要我发布问题，我就会找到答案。我缺少模型上的 :order 和 :scope 属性。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2010-07-23T20:43:44.010

我在解决这个问题时度过了一段糟糕的时光。在我找到这个例子之前，我一直只是在“问题”模型上使用acts_as_list。它会起作用，但是当我尝试创建新问题时，Rails 感到困惑。

我以这种方式尝试过，并且可以创建新对象，但似乎我的应用程序对“位置”字段应该使用哪个模型感到困惑。

最后，我意识到，就我而言，仅使用连接模型作为具有位置字段的模型是完全合适的，因为这正是 :scope 关键字的用途！它将“问题”的排序范围限定为每个“表单”，每个表单*可能不同*。在此之后，我只是从“question”模型中删除了acts_as_list，并根据抓取“QuestionMembership”实例（然后使用它们的子项来显示数据）来处理排序。

我知道我在这里没有添加太多，但是灯亮了，也许这个评论会帮助其他人。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-20T19:51:59.753

使用 Rails 2.3，您可以将默认范围设置为始终按位置排序：

```
acts_as_list :scope => <scope clause>
default_scope :order => :position 
```

请注意，范围的这种用法与 的用法不同`acts_as_list`，后者决定了列表的范围。

# ms-project - MS Project 2007 是否需要 SharePoint？MS Project 对您的开发团队有多大用处？

> ID：664809
> 
> 赞同：2
> 
> 时间：2009-03-20T02:38:44.497
> 
> 标签：ms-project

让我们再试一次。我发布这个是为了回答 2 个问题

1.  MS Project 2007 是否需要 SharePoint（我希望不需要）？
2.  你喜欢你的开发团队的 MS Project - 它是有用的还是痛苦的？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-20T02:46:06.397

它不需要共享点，但有很多功能只能通过共享点公开。

MS项目的最大问题是IMO依赖于一个单一的管理点（项目经理），所有信息都被提交，然后项目计划等从那里更新。然后项目经理必须重新分发信息。其他项目管理软件（如fogbugz）允许所有用户提交信息，并具有高度可见的项目视图。我发现这是管理项目的一种更有用的方法，并且可以更轻松地评估项目的实际状态。

# sql - 其他数据库产品中是否有与 MS SQL 'FOR XML PATH' 等效的功能？

> ID：664815
> 
> 赞同：7
> 
> 时间：2009-03-20T02:43:37.947
> 
> 标签：sql, xml

我目前正在使用 Microsoft 的 FOR XML PATH 功能以 XML 格式从 MS SQL Server 中提取数据。我真的很喜欢这个功能，但总是对使用供应商特定的功能感到不舒服。

其他主要的数据库供应商是否有类似的东西？

## 编辑

让我更具体地了解我正在寻找的功能类型

在 MS SQL 中，您可以使用此查询

```
SELECT so.id AS '@Id',
       so.Code AS '@Code',  
       cu.Code AS 'Customer/@Code',
       cu.Name AS 'Customer/@Name',
       (SELECT Item_Num AS '@Item',
                pa.Code AS '@PartCode'
        FROM tblSalesItem si
            LEFT JOIN tblPart pa ON pa.Id = si.Part_Id
        WHERE si.SalesOrder_ID = so.Id 
        FOR XML PATH('SalesItem') , type) 
FROM tblSalesOrder so
    JOIN tblCustomer cu ON so.customer_id = cu.ID
FOR XML PATH('SalesOrder'), ROOT('SalesOrders') 
```

生成此 XML

```
<SalesOrders>
  <SalesOrder Id="13" Code="C1002     ">
    <Customer Code="ROBERTS   " Name="Roberts Equipment  Inc." />
    <SalesItem Item="1" PartCode="FP-0001" />
    <SalesItem Item="2" PartCode="FP-0003" />
  </SalesOrder>
  <SalesOrder Id="15" Code="C1004     ">
    <Customer Code="EXBEL-LIFTS" Name="Exbel Lifts Inc." />
    <SalesItem Item="1" />
  </SalesOrder>
</SalesOrders> 
```

我可以逐列控制元素和属性的使用。我可以创建元素的属性来将相关的列组合在一起。我可以使用子查询来生成嵌套元素。您甚至可以使用返回 XML 的函数来生成任意深度的树。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-20T02:51:21.750

`FOR XML PATH`不在 ANSI SQL-92 标准中，因此取决于各个供应商。我不知道 Oracle 或 MySQL 中有任何等价物。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-20T02:57:07.277

PostgreSQL 8.3 没有特别的`FOR XML PATH`，但它的 XML 函数（参见[手册的第 9.14 节](http://www.postgresql.org/docs/8.3/static/functions-xml.html)，特别是[9.14.3](http://www.postgresql.org/docs/8.3/static/functions-xml.html#FUNCTIONS-XML-MAPPING)）似乎提供了非常相似的功能。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-20T03:09:53.720

Oracle 在其数据库中有一个完整的 XML 处理包。您甚至可以将 XML 直接存储到数据库中（没有 INSERTS ）并进行查询。有关示例，请参阅：[如何使用 oracle 格式化 xml 。](http://www.dba-oracle.com/t_format_output_html_xml.htm)

以下是其中一个示例：

```
 SQL> select dbms_xmlgen.getxml('select employee_id, first_name,
  2  last_name, phone_number from employees where rownum < 6') xml
  3  from dual

<?xml version="1.0"?>
<ROWSET>
 <ROW>
  <EMPLOYEE_ID>100</EMPLOYEE_ID>
  <FIRST_NAME>Steven</FIRST_NAME>
  <LAST_NAME>King</LAST_NAME>
  <PHONE_NUMBER>515.123.4567</PHONE_NUMBER>
 </ROW>
 <ROW>
  <EMPLOYEE_ID>103</EMPLOYEE_ID>
  <FIRST_NAME>Alexander</FIRST_NAME>
  <LAST_NAME>Hunold</LAST_NAME>
  <PHONE_NUMBER>590.423.4567</PHONE_NUMBER>
 </ROW>
 <ROW>
  <EMPLOYEE_ID>104</EMPLOYEE_ID>
  <FIRST_NAME>Bruce</FIRST_NAME>
  <LAST_NAME>Ernst</LAST_NAME>
  <PHONE_NUMBER>590.423.4568</PHONE_NUMBER>
   </ROW>
  </ROWSET> 
```

# c# - C# Windows Mobile 数据网格数据

> ID：664819
> 
> 赞同：0
> 
> 时间：2009-03-20T02:45:06.260
> 
> 标签：c#, windows-mobile, datagrid

我有一个有两列的数据网格。数据网格的 DataSource 是“myTable”，它是一个 DataTable。我要做的就是向 DataTable 添加一行，并在数据网格中显示新行。这是我编写的将项目添加到 DataTable 的简单代码：

```
DataRow dRow = myTable.NewRow();
dRow.ItemArray.SetValue("test", 0);
dRow.ItemArray.SetValue("test1", 1); 
```

在数据网格中显示新数据行时我缺少什么？

谢谢！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-20T03:07:23.943

.NewRow() 方法不会将该行添加到表中，它只返回一行，其中包含相应的字段。您仍然需要将该行添加到表中。

```
myTable.Rows.Add(dRow); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-20T03:13:55.003

以下工作没有任何问题 - 向表中添加一行是您缺少的步骤。

```
 DataTable dt = new DataTable();
        private void Form1_Load(object sender, EventArgs e)
        {
            dt.Columns.Add("a");
            dt.Columns.Add("b");
            dt.Rows.Add("aaa", "bbb");
            dataGrid1.DataSource = dt;
        }

        private void button1_Click(object sender, EventArgs e)
        {
            dt.Rows.Add("111", "222");
        } 
```

# javascript - Javascript：最终/不可变的全局变量？

> ID：664829
> 
> 赞同：45
> 
> 时间：2009-03-20T02:50:19.710
> 
> 标签：javascript

我想我知道答案，但是......有什么办法可以防止全局变量被稍后执行修改`<script>`？我知道全局变量首先是不好的，但是在必要时，有没有办法让它“最终”或“不可变”？欢迎使用黑客/创造性解决方案。谢谢

* * *

## 回答 #1

> 赞同：57
> 
> 时间：2009-03-20T03:09:18.620

const**[关键字](https://developer.mozilla.org/en/Core_JavaScript_1.5_Guide/Core_Language_Features#Constants)**？

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2011-07-10T05:24:04.323

我知道这个问题很老，但你可以使用 Object.freeze(yourGlobalObjectHere); [我刚刚在这里](http://tripleequals.blogspot.com/2011/07/how-do-you-make-object-final-in.html)写了一篇关于它的博客文章。

* * *

## 回答 #3

> 赞同：15
> 
> 时间：2009-03-20T03:35:56.120

您可以使用闭包技术，MYGLOBALS 是一个对象，该对象具有一个名为 getValue 的函数，该函数针对“全局”关联数组，该数组超出了除 MYGLOBALS 实例之外的所有内容的范围。

```
var MYGLOBALS = function() {
    var globals = {
        foo : "bar",
        batz : "blah"       
    }
    return { getValue : function(s) {
            return globals[s];
        }
    }
}();
alert(MYGLOBALS.getValue("foo"));  // returns "bar"
alert(MYGLOBALS.getValue("notthere")); // returns undefined
MYGLOBALS.globals["batz"] = 'hardeehar'; // this will throw an exception as it should 
```

* * *

## 回答 #4

> 赞同：9
> 
> 时间：2009-12-15T04:55:48.967

是的 const 在某些语言中是常​​量或最终的缩写。谷歌“javascript变量const”或常数加倍我什至自己测试过

```
const yourVar = 'your value'; 
```

这就是你要找的。

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2009-03-20T04:14:18.383

This would be much cleaner approach

```
 var CONSTANTS = function() {
        var constants = { } ; //Initialize Global Space Here
        return {
            defineConstant: function(name,value)
            {
                if(constants[name])
                {
                   throw "Redeclaration of constant Not Allowed";
                }
            },
            getValue(name)
            {
               return constants[name];
            }
        } ;
    }() ;
    CONSTANTS.defineConstant('FOO','bar') ;
    console.log(CONSTANTS.getValue('FOO')) ; //Returns bar
    CONSTANTS.defineConstant('FOO','xyz') ; // throws exception as constant already defined
    CONSTANTS.getValue('XYZ') ; //returns undefined 
```

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2009-12-15T04:22:13.403

尝试这个：

```
const whatEver = 'Hello World!!!';

function foo(value){
 whatEver = value;
} 
```

那么你会这样称呼它......

```
<div onclick="foo('New Value');">Change Me First</div>
<div onclick="alert(whatEver);">Then click me After: Should Be alert "Hello World!!!"</div> 
```

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2015-02-16T00:55:58.470

```
Object.defineProperty(window, 'CONSTANT_NAME', {value: CONSTANT_VALUE});

// usage
console.log(CONSTANT_NAME); 
```

[`Object.defineProperty()`](https://developer.mozilla.org/en/docs/Web/JavaScript/Reference/Global_Objects/Object/defineProperty)创建具有以下默认属性的属性：

*   **`configurable`**当且仅当此属性描述符的类型可以更改并且可以从相应对象中删除该属性时才为 true。 **默认为假。**

*   **`enumerable`**当且仅当在枚举相应对象的属性期间显示此属性时才为 true。**默认为假。**

*   **`writable`**当且仅当与属性关联的值可以使用赋值运算符更改时才为真。**默认为假。**

如果“常量”是一个对象，您可能还想通过冻结它使其不可变。`obj =`[`Object.freeze(obj)`](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object/freeze). 请记住，子属性对象不会自动冻结。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2013-05-23T19:22:33.730

[http://ejohn.org/](http://ejohn.org/) @ [http://ejohn.org/blog/ecmascript-5-objects-and-properties/](http://ejohn.org/blog/ecmascript-5-objects-and-properties/)的这段代码怎么样

看起来这确实有效......我运行了一些“小”测试并冻结变量和属性。

> 冻结对象是锁定的最终形式。一旦一个物体被冻结，它就不能被解冻——也不能以任何方式被篡改。这是确保您的对象无限期地保持原样的最佳方法。

```
Object.freeze = function( obj ) {
  var props = Object.getOwnPropertyNames( obj );

  for ( var i = 0; i < props.length; i++ ) {
    var desc = Object.getOwnPropertyDescriptor( obj, props[i] );

    if ( "value" in desc ) {
      desc.writable = false;
    }

    desc.configurable = false;
    Object.defineProperty( obj, props[i], desc );
  }

  return Object.preventExtensions( obj );
}; 
```

小例子

```
var config = (function (__name) {
    name: __name
    var _local = {
        Server: "SomeText",
        ServerDate: "SomeServerDate",
        JSDate : Util.today(),
        User : {
            user: "1stUser",
            name: "",
            email: ""
        },        
    }

    /*Private Methods*/
    function freezing(__array) {
        $.each(__array, function (_index, _item) {
            Object.freeze(_item);
        });
    }

    /*Public Methods*/
    var $r = {};

    $r.info = function () {
        return _local;
    }

    freezing([
        _local,
        _local.User
    ]);

    _local.User.user = "newUser"; //Trying to assing new value

    //Remain with the same value as first declaration
    console.log(_local.User.user); //--> "1stUser"           
    return $r;
})("config"); 
```

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2009-03-20T13:13:13.520

选择一个不太可能被意外覆盖的变量名，并相信程序员不会做愚蠢的事情。JavaScript 不是 Java，所以不要假装它是。

此外，如果您真正想做的是命名空间，请使用自执行函数文字：

```
var myLibName = (function() {
    var aPrivateVar;

    function aPrivateFunction() {}

    function accessorForPrivateVar() {
        return aPrivateVar;
    }

    // public interface:
    return {
        getPrivateVar : accessorForPrivateVar
    }
})(); 
```

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2009-03-20T03:10:07.867

**约定和良好的文档。**

您可以在您的“不可变”变量前加上两个（或更多）下划线，以表明该变量不应被其他人使用，并避免其他人的变量与您的变量发生冲突。

也许创建一个像`__GLOBALNAMESPACE`（丑陋的名字，我知道）这样的“命名空间”，然后将你的变量添加到其中（例如`__GLOBALNAMESPACE.my_var`）并创建一个像这样的方法来检索它们：

```
getVariable(string name){
  return __GLOBALNAMESPACE[name]
} 
```

只是我的2美分。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2016-06-11T07:41:44.527

除了在全局范围内声明所有此类变量，您还可以让一个全局对象环绕这些变量。使用`Object.defineProperty()`和/或`Object.defineProperties()`将`writable`标志设置为`false`，您可以拥有一个不可变变量。

```
var myObj = {};

Object.defineProperty(myObj, 'myVar', {
    value: someValue,
    writable: false
}); 
```

或者你可以只使用[const 关键字](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Statements/const)

```
const MY_VAR = 10; 
```

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2011-08-10T20:34:43.470

Javascript 是面向对象的，与其将变量*$public 设为静态*，不如考虑将其设为私有，然后适当地提供一个访问方法来获取，但不要设置它。

例如

```
private var myGlobal : myType;
function GetMyGlobal() : myType
{
return myGlobal;
} 
```

> 有十种不同的方法可以解决任何给定的问题，你的方法和正确的方法。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2011-04-06T12:58:19.567

你可能想试试这个[jquery 插件](http://dreamerslab.com/blog/en/hide-javascript-global-objects-with-jquery-secret-plugin/)。它会阻止您在 javascript 中创建全局对象 :)

### 示例代码

存储数据

```
// 'val' can be a string, integer, hash table, array, object
$.secret( 'in', 'secretName', val );

// or a function
$.secret( 'in', 'secretName', function( arg1, arg2, arg3 ){
  // do something here
}); 
```

使用数据；您甚至可以在不同的文件中使用它。

```
var lang = $.secret( 'out', 'lang' ); 
```

调出一个函数

```
$.secret( 'call', 'secretName', [ arg1, arg2, arg3 ]);
// or
$.secret( 'call', 'secretName', arg ); 
```

清除数据

```
$.secret( 'clear', 'lang' ); 
```

源代码在[github上](https://github.com/dreamerslab/jquery.secret)

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2016-10-13T19:39:46.387

如果可以使用打字稿，则可以将属性标记为`readonly`

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2021-10-13T11:07:47.053

以下示例代码使**全局**可用的变量**不可变**

```
Object.defineProperty(window, `env`, {
    value: Object.freeze({
        API: "https://api.mywebsite.com",
    }),
}); 
```

`window.env`它可以被任一或只是引用`env`。

# nhibernate - NHibernate 单表继承

> ID：664832
> 
> 赞同：1
> 
> 时间：2009-03-20T02:51:44.963
> 
> 标签：nhibernate, hibernate, nhibernate-mapping

我在使用继承和 NHibernate 设置基于角色的结构时遇到问题。

基本上我想要一个名为 ObjectInRole 的抽象类。这个类（和相应的数据库表）包含一个 RoleId、一个 ObjectId 和一个 ObjectType（这将是鉴别器列）。鉴别器列将是获得角色的对象类型。

为简单起见，假设有一个包含角色列表（包）的用户对象。我想要它，这样我就可以拥有一个 UserInRole 类，它是 ObjectInRole 的子类。

我已经像这样创建了这个包：

```
<bag name="Roles" table="ObjectInRole" where="ObjectType = 'AthletesCafe.Core.Domain.System.Users.User, AthletesCafe.Core'" generic="true"
     access="field.pascalcase-underscore" lazy="true">
  <key column="ObjectId" />
  <many-to-many class="AthletesCafe.Core.Domain.System.Roles.Role, AthletesCafe.Core" column="RoleId" />
</bag> 
```

我已将 ObjectInRole 的映射设置为：

```
<hibernate-mapping xmlns="urn:nhibernate-mapping-2.2" namespace="AthletesCafe.Core.Domain.System.Roles" assembly="AthletesCafe.Core">
  <class name="ObjectInRole" table="ObjectInRole" lazy="true" abstract="true">
<id name="ID" type="Int32" unsaved-value="0">
  <column name="ID" not-null="true" unique="true" index="PK_ObjectInRole"/>
  <generator class="identity" />
</id>
<discriminator column="ObjectType" type="String" insert="true" force="true"/>
<property name="ApplicationName" column="ApplicationName" type="String" not-null="false" length="255" />
<property name="ObjectId" column="ObjectId" type="int" not-null="true" />
<property name="ObjectType" column="ObjectType" type="String" />

<many-to-one name="Role" column="RoleId" class="AthletesCafe.Core.Domain.System.Roles.Role, AthletesCafe.Core" not-null="true" cascade="none" />

<subclass name="AthletesCafe.Core.Domain.System.Roles.UserInRole" 
          discriminator-value="AthletesCafe.Core.Domain.System.Users.User, AthletesCafe.Core">
  <many-to-one name="User" column="ObjectId" class="AthletesCafe.Core.Domain.System.Users.User, AthletesCafe.Core" not-null="false" cascade="none" />
</subclass> 
```

进行此设置并运行它后，当我将新角色添加到用户对象的集合中时，我无法保存要保存的 ObjectType 字段。它在 ObjectToRole 表中保存了一个新条目，但 ObjectType 为空。看着袋子，它不会将它加载到集合中。我想我已经把它缩小到设置不正确的子类结构或者包设置不正确。我倾向于这个包，因为我认为它可能只是将集合视为一堆抽象类而不是子类 UserInRole。

请提供您对任一领域的看法。谢谢！

编辑：

因此，我决定直接将对象添加到表中，而不是尝试添加到包 (User.Roles.add(Role)) 并让多对多持久化链接对象。我收到一个新错误：

```
null id in AthletesCafe.Core.Domain.System.Roles.UserInRole entry (don't flush the Session after an exception occurs) 
```

如果查看上面的类，我已经设置了 User 对象和 Role 对象。id 是一个身份字段，并且是这样指定的。我完全不知所措。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-21T01:07:55.423

好的！在玩了很多映射文件之后，我发现了一个未记录的问题（至少我找不到提到我所犯的错误）。

使用子类化时，父类不能包含作为鉴别器列的属性的映射。如果您查看我发布的第二个映射文档，它会显示超类和子类。超类的鉴别器是 ObjectType 列。我还将它作为一个属性映射到抽象类 ObjectInRole。你不可以做这个。一旦这条线被删除，一切正常（不保存袋子）。

The bag seems to be an issue that is not controllable through anything I have found in documentation. I cannot find another instance of where the abstract class is saved through the mapping. It appears that NHibernate does not know that the linking class is a UserInRole object and not a ObjectInRole object. Researching all the options that are provided for the bag node there was no apparent way to tell NHibernate what type of class it was linking through to make the many-to-many association. From what I can tell it doesn't care, but more or less treats the table as just a table, not a mapped object. If there was a way to tell it append something for the insert then maybe it would be possible, but I have not seen any information regarding this.

# c# - 如何使用 .NET 捕获我的桌面视频？

> ID：664841
> 
> 赞同：4
> 
> 时间：2009-03-20T03:04:30.207
> 
> 标签：c#, .net, screenshot

我想知道是否有任何方法可以使用 .NET 捕获我的桌面的视频（截屏）？我不是在寻找截屏软件，而只是一种可以让我自己生成桌面视频的技术。

我想拍摄多个屏幕截图，但我不确定如何以编程方式生成带有一系列图像的视频......

有人有想法吗？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-20T03:07:30.697

是的，有很多方法可以做到这一点。这是使用 WPF 的一种非常简单的方法。好用，我以前用过。

[http://www.sythe.org/showthread.php?t=175353](http://www.sythe.org/showthread.php?t=175353)

从网站：

创建一个新的 WPF 应用程序，添加对 System.Drawing.dll 和 System.Windows.Forms.dll 的引用。使用您所期望的方法，Stat、Stop 和 Save。

```
Public Class ScreenRecorder

    Private Shared tempDir As String = My.Computer.FileSystem.SpecialDirectories.Temp & "\snapshot\"
    Private Shared snap As New System.Threading.Thread(AddressOf Snapshot)
    Private Shared _Bounds As System.Drawing.Rectangle = System.Windows.Forms.Screen.PrimaryScreen.Bounds
    Public Shared Property Bounds() As System.Drawing.Rectangle
        Get
            Return _Bounds
        End Get
        Set(ByVal value As System.Drawing.Rectangle)
            _Bounds = value
        End Set
    End Property
    Private Shared Sub Snapshot()
        If Not My.Computer.FileSystem.DirectoryExists(tempDir) Then _
            My.Computer.FileSystem.CreateDirectory(tempDir)
        Dim Co As Integer = 0
        Do
            Co += 1
            System.Threading.Thread.Sleep(50)
            Dim X As New System.Drawing.Bitmap(_Bounds.Width, _Bounds.Height, System.Drawing.Imaging.PixelFormat.Format32bppArgb)
            Using G = System.Drawing.Graphics.FromImage(X)
                G.CopyFromScreen(_Bounds.Location, New System.Drawing.Point(), _Bounds.Size)
                Dim CurBounds As New System.Drawing.Rectangle(System.Windows.Forms.Cursor.Position - Bounds.Location, System.Windows.Forms.Cursor.Current.Size)
                Forms.Cursors.Default.Draw(G, CurBounds)
            End Using
            Dim FS As New IO.FileStream(tempDir & FormatString(Co.ToString, 5, "0"c) & ".png", IO.FileMode.OpenOrCreate)
            X.Save(FS, System.Drawing.Imaging.ImageFormat.Png)
            X.Dispose()
            FS.Close()
        Loop
    End Sub
    Public Shared Sub ClearRecording()
        If My.Computer.FileSystem.DirectoryExists(tempDir) Then _
        My.Computer.FileSystem.DeleteDirectory(tempDir, FileIO.DeleteDirectoryOption.DeleteAllContents)
        My.Computer.FileSystem.CreateDirectory(tempDir)
    End Sub
    Public Shared Sub Save(ByVal Output As String)
        Dim G As New Windows.Media.Imaging.GifBitmapEncoder

        Dim X As New List(Of IO.FileStream)
        For Each Fi As String In My.Computer.FileSystem.GetFiles(tempDir, FileIO.SearchOption.SearchTopLevelOnly, "*.png")
            Dim TempStream As New IO.FileStream(Fi, IO.FileMode.Open)
            Dim Frame = Imaging.BitmapFrame.Create(TempStream)
            X.Add(TempStream)
            G.Frames.Add(Frame)
        Next
        Dim FS As New IO.FileStream(Output, IO.FileMode.OpenOrCreate)
        G.Save(FS)
        FS.Close()

        For Each St As IO.FileStream In X
            St.Close()

        Next

    End Sub
    Public Shared Sub Start()
        snap = New System.Threading.Thread(AddressOf Snapshot)
        snap.Start()
    End Sub
    Public Shared Sub [Stop]()
        snap.Abort()
    End Sub
    Private Shared Function FormatString(ByVal S As String, ByVal places As Integer, ByVal character As Char) As String
        If S.Length >= places Then Return S
        For X As Integer = S.Length To places
            S = character & S
        Next
        Return S
    End Function

End Class 
```

* * *

这是使用托管 DirectX 的另一种方法

[http://www.mdxinfo.com/resources/screencapture.php](http://www.mdxinfo.com/resources/screencapture.php)

另一个资源：

[http://www.codeproject.com/KB/audio-video/CaptureScreenAsVideo.aspx](http://www.codeproject.com/KB/audio-video/CaptureScreenAsVideo.aspx)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-20T03:07:46.267

[我相信我不久前使用DirectShowNet 库](http://directshownet.sourceforge.net/)做了类似的事情。它可能会帮助你。

# android - 无法在 Eclipse 中设置断点

> ID：664851
> 
> 赞同：8
> 
> 时间：2009-03-20T03:10:30.923
> 
> 标签：android, eclipse, macos, breakpoints

遵循在 OSX 10.5.6 上使用 Eclipse 3.4.2 的 Android 记事本教程。

我被指示以下列方式之一设置断点：

1.  双击编辑器窗格左侧的灰色栏。

    *   这只是调出“添加书签”窗口
2.  在上下文菜单中选择“切换断点”

    *   上下文菜单中的唯一选项是“Go to Annotation...”（已禁用）、“Add Bookmark”、“Add Task”、“Quick Diff”、“Show line numbers”、“Folding”和“Preferences”

我的猜测是编辑器处于某种不允许设置断点的模式，但我只是一个 Eclipse 新手。任何人都可以在这里提供任何建议吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-03-20T03:29:38.977

当您双击灰色条时，会出现一个蓝色球？如果出现，尝试将鼠标悬停在它上面，它可能会显示“Line Breakpoint:Blablabla”

否则，请尝试检查您是否使用 java 编辑器打开文件。要检查此右键单击要打开的文件，转到打开方式条目并检查是否选择了 Java 编辑器，如果没有这样的选项，则表示您尚未安装 JDT，可能最好下载 Java 版本来自其官方网站的日食。

如果前面的选项都没有帮助，它可能是一个错误，如果你愿意的话，你应该将它报告给[eclipse 错误系统](https://bugs.eclipse.org/bugs/)。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2011-09-01T14:25:10.920

1.  右键单击文件（即 example.js）
2.  去打开方式
3.  点击其他
4.  单击内部编辑器单选按钮
5.  从列表中选择 Java 编辑器

现在您可以通过右键单击并从可用方法中选择一个来设置断点，即切换断点/行/方法等。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-03T16:48:25.703

我有完全相同的错误。我重新启动了eclipse，但它没有用。然后我关闭了所有文件，然后重新打开了感兴趣的文件，但它没有用。最后，我进入 Debug 透视图，并尝试设置 Break-point，最后它对我有用。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-07-09T20:20:57.073

我所有的断点都有一条对角线穿过它。我遇到了这个问题，但原因是前一天我在调试视图中单击了“跳过所有断点”。您必须取消选中此选项。您可以在“运行”菜单中访问它。

也许这个答案对某人有用。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2016-05-09T14:29:29.513

当您尝试将调试点放在 .jsp 文件中时，也会发生这种情况。Eclipse 不允许您调试 .jsp 文件，这就是为什么您会收到添加书签弹出窗口的原因。

请检查您正在处理的文件类型并相应地放置断点。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2020-12-09T11:05:47.450

我在 Eclipse 中遇到问题，我无法使用快捷键或*Run → Toggle Breakpoint*选项在 Java 文件中放置断点，但我可以通过双击灰色边距来放置断点。问题是我处于“JavaScript”的角度。解决方案是更改为“Java 透视图”。

# algorithm - 哪个是获得数字绝对值的最快方法

> ID：664852
> 
> 赞同：48
> 
> 时间：2009-03-20T03:11:15.167
> 
> 标签：algorithm, performance, theory, absolute-value

实现返回数字绝对值的运算的最快方法是什么？

```
x=root(x²) 
```

或者

```
if !isPositive(x):
    x=x*(-1) 
```

实际上这个问题可以翻译为，多快`if`（以及为什么）。

我的大学编程教授总是告诉我要避免`if`使用 s，因为它们非常慢，但我总是忘记问有多慢以及为什么。这里有人知道吗？

* * *

## 回答 #1

> 赞同：88
> 
> 时间：2010-01-15T19:59:26.887

在不使用 if 语句的情况下计算 2s 补码整数的绝对值有一个很好的技巧。理论上讲，如果值为负，则您希望切换位并加一，否则您希望按原样传递位。XOR 1 恰好触发了 A，而 A XOR 0 恰好使 A 保持不变。所以你想做这样的事情：

```
 uint32_t temp = value >> 31;     // make a mask of the sign bit
  value ^= temp;                   // toggle the bits if value is negative
  value += temp & 1;               // add one if value was negative 
```

原则上，您可以用最少三个汇编指令（没有分支）来完成。并且您想认为您使用 math.h 获得的 abs() 函数可以实现最佳效果。

没有分支 == 更好的性能。与上面@paxdiablo 的回复相反，这在深层管道中确实很重要，因为代码中的分支越多，分支预测器出错并不得不回滚的可能性就越大，等等。如果你避免在哪里分支有可能，事情会在你的核心中全速前进:)。

* * *

## 回答 #2

> 赞同：75
> 
> 时间：2009-03-20T03:18:31.187

条件比普通的算术运算要慢，但比计算平方根这样愚蠢的运算要快得多。

我组装日的经验法则：

*   整数或按位运算：1 个周期
*   浮点加/减/乘：4 个周期
*   浮点 div：~30 个周期
*   浮点取幂：~200 个周期
*   浮点 sqrt：约 60 个周期，具体取决于实现
*   条件分支：avg. 10 个周期，如果预测良好则更好，如果预测错误则更糟

* * *

## 回答 #3

> 赞同：20
> 
> 时间：2009-03-20T03:32:06.350

计算平方根可能是你能做的最糟糕的事情之一，因为它真的很慢。通常有一个库函数可以做到这一点；像 Math.Abs​​() 之类的东西。乘以 -1 也是不必要的；只需返回-x。因此，一个好的解决方案如下。

```
(x >= 0) ? x : -x 
```

编译器可能会将其优化为单个指令。由于执行管道很长，现代处理器的条件可能非常昂贵——如果分支预测错误并且处理器开始从错误的代码路径执行指令，则必须丢弃计算。但是由于提到的编译器优化，在这种情况下你不需要关心。

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2012-07-26T16:08:51.753

为了完整起见，这里有一种在 C++ 中为 x86 系统上的 IEEE 浮点数执行此操作的方法：

```
*(reinterpret_cast<uint32_t*>(&foo)) &= 0xffffffff >> 1; 
```

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2015-07-13T20:13:14.973

> 哪个是获得数字绝对值的最快方法

我认为“正确”的答案实际上并不在这里。获得绝对数字的最快方法可能是使用 Intel Intrinsic。请参阅[https://software.intel.com/sites/landingpage/IntrinsicsGuide/](https://software.intel.com/sites/landingpage/IntrinsicsGuide/)并查找“vpabs”（或为您的 CPU 完成工作的其他内在函数）。我很确定它会在这里击败所有其他解决方案。

如果您不喜欢内在函数（或不能使用它们或......），您可能需要检查编译器是否足够聪明，以确定对“本机绝对值”（`std::abs`在 C++ 或`Math.Abs(x)`C# 中）的调用是否会改变自动进入内在 - 基本上涉及查看反汇编（编译）代码。如果您在 JIT 中，请确保未禁用 JIT 优化。

如果这也没有为您提供优化的说明，您可以使用此处描述的方法：[https](https://graphics.stanford.edu/~seander/bithacks.html#IntegerAbs) ://graphics.stanford.edu/~seander/bithacks.html#IntegerAbs 。

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2009-03-20T03:19:20.857

与平方根相比，该`if`变体几乎肯定会快得*令人眼花缭乱*，因为它通常会转换为机器代码级别的条件跳转指令（在表达式的评估之后，这可能很复杂，但在这种情况下并非如此，因为它很简单检查是否小于 0）。

取数字的平方根可能要慢得多（例如，牛顿的方法将在机器代码级别使用*许多语句）。* `if`

混淆的可能来源是`if`总是导致以非顺序方式更改指令指针的事实。这可能会减慢将指令预取到流水线中的处理器，因为当地址意外更改时它们必须重新填充流水线。

但是，与执行平方根运算而不是简单的检查和取反相比，这样做的成本将是微不足道的。

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2009-03-20T03:17:20.270

模运算用于求余数，即绝对值。我修改了这个问题，因为它应该是 if !pos(x) then x = x*-1。（没有丢失）

我不会担心 if 语句的效率。而是专注于代码的可读性。如果您发现存在效率问题，则专注于分析您的代码以找到真正的瓶颈。

如果您想在编写代码时注意效率，您应该只担心算法的大 O 复杂性。

如果语句非常有效，它会评估任何表达式，然后根据该条件简单地更改[程序计数器。](http://en.wikipedia.org/wiki/Program_counter)程序计数器存储要执行的下一条指令的地址。

乘以 -1 和检查值是否大于 0 都可以简化为一条汇编指令。

找到一个数字的根并首先对该数字进行平方肯定比带有否定的 if 更多的操作。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-03-20T03:35:00.430

做一个平方根的时间比做一个条件的时间要长得多。如果你被教导要避免条件句，因为它们很慢，那么你就被误导了。它们比诸如加减整数或位移之类的琐碎操作要慢得多——这就是为什么展开循环只有在执行此类琐碎操作时才有用。但在事物的宏伟计划中，条件句是好的和快的，不是坏的和慢的。做一些复杂的事情，比如调用函数或计算平方根来避免条件语句是疯狂的。

另外，为什么不使用（x = x * -1）而不是（x = 0 - x）？也许编译器会对它们进行同样的优化，但是第二个不是更简单吗？

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-03-20T04:23:33.260

你用的是8086汇编吗？;-)

```
 ; abs value of AX
   cwd          ; replicate the high bit into DX
   xor  ax, dx  ; take 1's complement if negative; no change if positive
   sub  ax, dx  ; AX is 2's complement if it was negative The standard
                : absolute value method works on any register but is much
                ; slower:

   or   bx, bx  ; see if number is negative
   jge  notneg  ; if it is negative...
   neg  bx      ; ...make it positive
notneg:         ; jump to here if positive 
```

（公然[盗用](http://support.microsoft.com/kb/31810)）

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2014-10-21T15:25:32.457

如果您只是比较两个数字的绝对值（例如，在比较之后您不需要任何一个的绝对值），那么只需将两个值平方以使两者都为正（删除每个值的符号），较大的平方将是大于较小的正方形。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2015-03-18T16:29:40.467

更快的速度很大程度上取决于您所针对的编译器和 CPU。在大多数 CPU 和所有编译器上 x = (x>=0)？x:-x; 是获得绝对值的最快方法，但实际上，通常标准函数已经提供了这种解决方案（例如 fabs()）。它被编译成比较后跟条件赋值指令（CMOV），而不是条件跳转。不过，有些平台缺少该指令。虽然，英特尔（但不是微软或 GCC）编译器会自动将 if() 转换为条件赋值，甚至会尝试优化循环（如果可能的话）。

如果 CPU 使用统计预测，则分支代码通常比条件赋值慢。如果操作重复多次并且条件结果不断变化，则 if() 平均可能会变慢。像 Intel 这样的 CPU 会开始计算*两个*分支，并会丢弃无效的分支，以防出现较大的 if() 主体或可能很关键的大量周期。

现代英特尔 CPU 上的 sqr() 和 sqrt() 是单个内置指令，并不慢，但它们不精确，加载寄存器也需要时间。

相关问题：[为什么 CPU 分支指令很慢？](https://stackoverflow.com/questions/9820319/why-is-a-cpu-branch-instruction-slow)

最有可能的是，教授希望学生对这个问题进行研究，这是一个半挑衅性的问题\任务，只有当学生学会独立思考并寻找额外的资源时才会有好处。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2016-11-21T23:08:13.740

我正在用 C 语言为 8088/8086 进行一些复古图形编程，并且调用`abs()`很耗时，所以我将其替换为：

```
/* assuming 'i' is int; this WILL NOT WORK on floating point */
if (i < 0) {
    i = ~i + 1;
} 
```

这更快的原因是因为它本质上是`CALL`在汇编中将 a换成`JNE`. 调用一个方法会更改几个寄存器，再推送几个，将参数推送到堆栈上，并且可以刷新预取队列。此外，这些操作需要在函数结束时反转，所有这些对 CPU 来说都是非常昂贵的。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2020-07-30T23:43:16.957

为了完整起见，如果您正在处理浮点数，您总是可以执行类似的操作`n * sign(n)`，`sign`如果数字为正，则返回 +1，如果为负，则返回 -1。在 C 中，这类似于`copysign(1.0, n)`or `(n > 0) - (n < 0)`。

现在大多数机器都使用 IEEE 754 作为浮点格式，因此您可以直接清除符号位：

```
float fabs(float x) {
    char *c = &x;
    c[0] &= 7;
    return *(float *)c;
} 
```

鉴于该`abs`功能可能会执行此操作，因此最好的选择是在可用时使用它。如果你幸运的话，这个函数将是几个指令，并且会被内联。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2021-04-22T11:36:20.787

我想知道，这个解决方案是否有问题。有

*   没有分支
*   不依赖位宽的移位
*   没有一点玩弄
*   没有架构依赖
*   没有编译器依赖
*   可选：没有未定义的行为`INT_MIN`

可能指令太多了？

**我的解决方案**

```
xabs = (x < 0)*(-x) + (x >=0)*x 
```

*   2个整数比较
*   2 次乘法

**旧解决方案**

 ~~~~```
xtest = (x < 0)*x;           // xtest = x if is negative, otherwise zero
xabs = (x - xtest) - xtest;  // Order of instructions taken into account 
```~~ 

**未定义的否定行为`INT_MIN`**

`INT_MIN`如果您的值在之前某处的算法中不受限制，则可以添加对未定义行为（对 的否定）的检查。但这使它变得更复杂一些。也许，有人发现了一个更简单的逻辑。

```
xabs =   (x < -INT_MAX)*INT_MAX            //  x < -INT_MAX < 0  --> xabs = INT_MAX
       + ((x >= -INT_MAX)&&(x < 0))*(-x)   // -INT_MAX =< x < 0  --> xabs = -x
       + (x >= 0)*x                        // 0 <= x             --> xabs = +x 
```

*   5 个整数比较
*   3个整数乘法

不幸的是，我从未做过速度比较。所以我不知道它是否真的比

```
if ( x < 0 )
{
  if ( x >= -INT_MAX )
  {
    x = -x;
  }
  else
  {
    x = INT_MAX;
  }
} 
```

* * *

## 回答 #15

> 赞同：-1
> 
> 时间：2019-09-08T16:37:51.877

对于负数列表：

如果您在内存中存储了零，只需使用`0 - x`，其中`x`是负数。

或者，如果您没有零存储在内存中：

`x-x-x`, 哪里`x`是负数。

或者，为了清楚起见，用括号：

`(x) - (x) - (x)` **=>** `(-n) - (-n) - (-n)`，其中`x = -n`

即从自身减去负数得到零，然后从零减去它。

# sharepoint - 查看预定发布页面的请求和到期通知电子邮件

> ID：664856
> 
> 赞同：0
> 
> 时间：2009-03-20T03:15:12.537
> 
> 标签：sharepoint, moss

我目前正在小型服务器场环境中运行发布门户。使用用于发布页面的页面设置和计划表，我们已将我们的内容配置为“向页面联系人发送内容审查请求邮件”。我们已经为电子邮件的频率尝试了多种不同的配置，但无论我们选择什么，都不会发送任何电子邮件。到期通知似乎也发生了同样的事情。

我们检查了农场的电子邮件设置，它们似乎是正确的。警报和欢迎电子邮件都正常运行。有谁知道如何让这些工作？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-06-01T03:45:27.970

在对 Reflector 进行了一些调查后，我们最终发现了电子邮件没有发送出去的原因（以及为什么无论我们在设置中进行什么更改，它们都不会发送出去）

审查和到期通知通过事件处理程序、共享点计时器作业定义和称为通知页面/通知列表的自定义列表的组合进行操作。事件的基本顺序如下：

1.  在自动生成新内容页面的过程中，用户选择在特定时间点向他们发送评论或到期通知。随后签入并发布内容页面。
2.  事件处理程序 (ScheduledItemEventReceiver) 被触发并验证有问题的项目是一个 ScheduledItem 并且它正在被批准的过程中。如果是这种情况，那么它将告诉项目注册它的时间表（ScheduledItem.Schedule(...)）。
3.  此过程负责为项目指定的计划开始和结束日期，确保它在正确的时间可用。此外，它应该将一个项目添加到通知列表（[http://[Site](http://[Site) Name]/Notification Pages/）。
4.  Timer Job (NotificationJobDefinition) 将定期查询通知列表中的项目，如果交货日期已过，它将向页面联系人发送审查或到期通知电子邮件。

所以这一切听起来都很好，理论上应该可以完美运行，但是有一个问题。为了将项目添加到通知列表，ScheduledItem.Schedule 方法调用 HandleScheduling 方法。

PublishingPage（从 ScheduledItem 继承）的 HandleScheduling 方法将调用 UpdateNotificationList，后者又将项目添加到通知列表。基础 ScheduledItem 类的 HandleScheduling 方法为空。

问题似乎在于 ScheduledItemEventReceiver 类将其对象实例化为 ScheduledItem（基类），因此无论何时调用 HandleScheduling，都不会发生任何事情。您可以浏览到通知列表（/Notification Pages/AllItems.aspx - 需要网站集管理员权限），它是完全空的。

我们目前有一个解决方法。我们开发并部署了一个自定义事件接收器，它取代了 ScheduledItemEventReceiver。它检查项目是否为发布页面，如果是，则使用一些反射以直接调用 UpdateNotificationList 方法。有了这个，我们开始看到项目按预期添加到通知列表中。

```
public class ScheduledPageEventReceiver : SPItemEventReceiver
{
    protected void HandleScheduling(PublishingPage page)
    {
        Type t = typeof(PublishingPage);
        MethodInfo notificationMethod = t.GetMethod("UpdateNotificationList",BindingFlags.NonPublic | BindingFlags.Instance | BindingFlags.InvokeMethod);
        if (notificationMethod != null)
        {
            notificationMethod.Invoke(page, null);
        }
    }

    public override void ItemUpdating(SPItemEventProperties properties)
    {
        if (properties == null)
        {
            throw new ArgumentNullException("properties");
        }
        if (properties.AfterProperties == null)
        {
            throw new ArgumentNullException("properties.AfterProperties");
        }
        object status = properties.AfterProperties["vti_doclibmodstat"];
        if ((status != null) && (Convert.ToInt32(status, CultureInfo.InvariantCulture) == 0)) //Approved
        {
            using (SPWeb web = properties.OpenWeb())
            {
                SPListItem item = web.GetFile(properties.BeforeUrl).Item;
                if (PublishingPage.IsPublishingPage(item) && PublishingPage.IsScheduledItem(item))
                {
                    PublishingPage page = PublishingPage.GetPublishingPage(item);
                    HandleScheduling(page);
                    return; 
                }
            }
        }
    }
} 
```

# java - 如何使用可移植 JRE 打包可执行 jar？

> ID：664858
> 
> 赞同：13
> 
> 时间：2009-03-20T03:16:56.370
> 
> 标签：java, executable-jar

我希望能够通过可执行 JAR 分发，而不必让用户升级到最新版本的 JRE。如何将 JRE 打包到 JAR 中，以便他们可以在系统上未安装 JRE 的情况下运行 jar？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2010-08-03T05:23:40.493

将[Java Portable](http://portableapps.com/apps/utilities/java_portable)放在一个子目录中，然后使用批处理/bash 脚本或[Launch4j](http://launch4j.sourceforge.net/)启动您的 jar 。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-20T06:33:16.490

由于您需要一个 jre 来执行一个 jar，恐怕这是不可能的。

我曾经使用[izpack](http://izpack.org/)和[launch4j](http://launch4j.sourceforge.net/)来制作一个 Windows EXE，它可以在我的应用程序中安装 jre。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2019-10-02T06:20:23.113

十年后我遇到了同样的问题，经过几天的寻找，显然仍然没有解决方案，这是我发现的最好的事情：

捆绑 Java（JRE）并使用 7zip SFX 启动 Java 应用程序：将 Java 应用程序转换为可执行文件[https://mark.koli.ch/bundle-java-the-jre-and-launch-a-java-app-with -7zip-sfx](https://mark.koli.ch/bundle-java-the-jre-and-launch-a-java-app-with-7zip-sfx)

## **编辑**

我找到了另一种方法，基于 Inno Setup 和 NetBeans，它经常出现在关于将 jar 转换为 exe 的搜索结果中。一切都是使用[NetBeans IDE 中的本机打包](https://netbeans.org/kb/docs/java/native_pkg.html)完成的。

结果是一个独立的 .exe 安装程序 (YourProjectName.exe)，它在***AppData\Local\YourProjectName***中创建了一个文件夹。在该文件夹中，您将找到启动器（一个 .exe）以及在不安装 Java 的情况下运行软件所需的所有文件。

您应该使用与文章中所说的完全相同的工具版本，否则它不起作用，至少对我来说不起作用。另一个不清楚的是，你的项目必须是带有 Ant proyect 的 Java，至少我没有找到使用 Gradle 或 Maven 的方法。

另外，我必须安装一个旧的**i586**版本的 Java（我尝试了 JDK 1.8 i586 并且它工作），因为 JDK 13 在尝试运行该软件时会导致错误（缺少 dll）。虽然我只尝试使用 JDK 13 x64，但也许架构是问题而不是版本。不管怎样，NetBeans 11 也发生了类似的情况，.exe 启动器不起作用，但是在定位和执行 .jar 时它确实起作用了。所以我最终使用了 NetBeans 8。

# winapi - GDI裁剪的实现细节

> ID：664859
> 
> 赞同：2
> 
> 时间：2009-03-20T03:17:05.137
> 
> 标签：winapi, windows-mobile, gdi

考虑以下代码片段：

```
HRGN clip = ::CreateRectRgn(50, 50, 100, 100);
::SelectClipRgn(context, clip);
::Rectangle(context, 0, 0, 50, 50); 
```

**微软的裁剪实现是否足够智能，可以立即从对 Rectangle 的调用中返回而无需尝试绘制任何内容？**我怀疑它可能是但无法在任何地方找到确认。[用于剪辑](http://msdn.microsoft.com/en-us/library/dd183435(VS.85).aspx)的 MSDN 文档在幕后细节上很少见，而谷歌搜索除了如何使用 GDI 剪辑之外什么也没找到。

**编辑：**我突然意识到我没有指出这是在 Windows Mobile 上运行的，所以我用于分析的工具集是有限的。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-20T03:27:29.667

实际上，我从书架上拿出了我的 Petzold（第 2 版），并毫不奇怪地发现，剪辑是 Windows SDK 早期版本中的一个重要功能。当时出于性能原因，有必要不绘制不可见的对象。我会说 GDI 剪裁实际上足够聪明，当您在剪裁区域之外绘制时，它什么也不做。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-27T02:11:10.793

测试一下。

附加您喜欢的调试器（Windbg、CDB）并使用[WT 命令](http://msdn.microsoft.com/en-us/library/cc266752.aspx)跟踪执行路径统计信息。比较 ::Rectangle(context, 0, 0, 50, 50); 与 ::Rectangle(context, 0, 0, 51, 51);

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-20T13:26:33.237

可以看SelectClipRgn()的源码（Win32 api Group，多年前，16位或32位）

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-27T02:24:21.820

我的估计是它只是在引擎盖下使用了一个简单的 Cohen-Sutherland 线剪裁，尽管我不确定。但是，如果您有很多数据在屏幕之外（并且不应该被绘制），您可能最好使用基于例如四叉树的更高级别的剔除算法，这样您就可以跳过那些在早期阶段将所有对象放在一起。

# c# - 关闭 WCF 线程的最佳方法是什么？

> ID：664865
> 
> 赞同：2
> 
> 时间：2009-03-20T03:23:28.943
> 
> 标签：c#, wcf, multithreading

我有一个需要很长时间才能关闭的应用程序。当我关闭应用程序时，它会尝试处理一些执行 TCP 扫描、WCF P2P 尝试等的线程。问题在于 WCF 线程在一个方法上停止了大约 17 秒。

```
IP2PAuthenticationService server;
ChannelFactory<IP2PAuthenticationService> channelFactory;
channelFactory = new ChannelFactory<IP2PAuthenticationService>(binding, endpointAddress);

server = channelFactory.CreateChannel();
string result = server.SendMyDetails(myContract, "foo"); 
```

所以这一切都发生在一个线程内。当表单关闭时，它会尝试处理线程

```
 if (prospectCrawlerThread != null)
 {
      prospectCrawlerThread.Abort();
      //prospectCrawlerThread.Join();
      prospectCrawlerThread = null;
  } 
```

我已经通过取消注释来确认这一点`.Join()`，并且还通过暂停调试并查看仍在运行的线程。

摆脱这个线程的最佳方法是什么？

编辑：将线程设置为背景似乎使它更快 `prospectCrawlerThread.IsBackground = true;`

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-20T10:47:07.847

值得指出的是，这`Thread.Abort`通常是一种不好的做法，应该避免：

> “中止线程是纯粹的邪恶。尽量不要这样做！”
>    ——Eric  [*Lippert，《编码的奇妙冒险》*](http://blogs.msdn.com/ericlippert/archive/2009/03/06/locks-and-exceptions-do-not-mix.aspx)
> 
>    “Thread.Abort 是程序设计不佳的标志”  ——Peter [*Ritchie 的 MVP 博客*](http://msmvps.com/blogs/peterritchie/archive/2007/08/22/thead-abort-is-a-sign-of-a-poorly-designed-program.aspx)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-20T03:29:34.263

IsBackgroundThread = true 将在表单关闭时自动中止线程，所以我认为如果您只想杀死它，这就是您要寻找的。

# objective-c - Objective-C 中实例变量上的协议如何工作？

> ID：664866
> 
> 赞同：5
> 
> 时间：2009-03-20T03:23:40.487
> 
> 标签：objective-c

我最近看到很多代码，例如以下代码：

```
id<foo> aBar; 
```

通常这是我在类声明中看到的，例如：

```
@interface bar : UIViewController <UITableViewDelegate, UITableViewDataSource> 
```

以上是否意味着 aBar 可能是类 bar 的一个实例，并承诺拥有 foo 协议中声明的所有方法？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2009-03-20T05:17:11.603

关闭。这意味着`aBar`它将是一个符合协议的类的实例`foo`。它可能是`bar`（如果该类符合`foo`）或另一个符合 的类`foo`。从该声明中您所知道的只是`aBar`符合协议。

此外，这些仅在编译时检查，而不是运行时检查。可以将一个对象放入`aBar`不是符合`foo`. 但在大多数情况下，编译器会警告你。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-20T04:08:44.623

确切地。协议意味着您不继承该类，而是获取该类的方法原型。这样，当您尝试与需要这些方法的对象进行交互时，您将知道方法存根是什么。想想 C# 中的浅接口。

我说 C# 因为那是我的主要语言。:)

# jquery - 前后滚动 jQuery 动画

> ID：664867
> 
> 赞同：5
> 
> 时间：2009-03-20T03:23:51.533
> 
> 标签：jquery, jquery-ui, animation, jquery-animate

我正在制作一个五人制足球（室内足球）教练应用程序，它允许教练在屏幕上添加球员，设置他们的移动方向（通过使用 HTML5 画布绘制箭头），然后按“播放”以移动屏幕上的所有球员。播放器由带有播放器背景图像的 div 组成。

动画是通过使用`jquery .animate()`函数来完成的。

我所做的就是更改播放器`div's` `left`和`top`css 位置属性。

我想做两件事，但不确定如何做到：

1.  我想创建一个 jQuery 滑块并随着动画的发生逐渐移动它。我猜我会通过在开始之前计算动画的总长度来做到这一点？

2.  我想来回移动上面的 jQuery 滑块 - 以反转动画并在需要时暂停它。考虑到我们正在为动画移动 div，而不是进行逐帧序列动画，这是否可能。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-22T02:45:54.213

在动画开始之前，保存开始位置怎么样？

```
startpostion = $(playerdiv).position(); //Or offset, I keep forgetting which
$(playerdiv).data("startTop",startposition.top);
$(playerdiv).data("startLeft",startposition.left); 
```

稍后您可以使用

```
left = $(playerdiv).data("startTop") 
```

等等

您始终可以使用 step 选项为动画提供回调，这样您就可以相应地更新滑块。

```
$(playerdiv).animate({ 
    top : targetTop,
    left : targetLeft, 
    step, function(){ magic happens here
}) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-20T10:46:41.500

我会这样做：

1.  如果用户单击“播放”，则开始将 div 从其当前位置动画到其目的地。您可以根据滑块的位置轻松计算剩余时间和 div 位置：

    *   startDivTop = initialDivTop + (finalDivTop - initialDivTop) * sliderPosition;
    *   startDivLeft = initialDivLeft + (finalDivLeft - initialDivLeft) * sliderPosition;
    *   开始时间 = 总持续时间 * 滑块位置；

    （或类似的东西，sliderPosition 介于 0 和 1 之间）

2.  如果用户再次单击滑块，请在所有 div 上调用 .stop() 方法：这样它们将停止动画并且您将能够静态设置它们：计算 div 应位于的位置并将它们静态移动到那一点。

3.  如果用户“放下”滑块并且“播放”仍然被激活，那么动画应该从滑块被放下的点继续向前。

这听起来像是你正在做的一个不错的项目:)

# c# - 通过 C# 备份 SQL Server

> ID：664869
> 
> 赞同：5
> 
> 时间：2009-03-20T03:26:24.617
> 
> 标签：c#, sql, sql-server, backup

通过 C# 代码备份 SQL Server 数据库有多容易？

我看到很多相关的问题，但没有真正的答案。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-20T03:45:21.357

或者：在 Management Studio 中生成备份脚本，将其放入存储过程中，从 C# 代码运行过程。

```
CREATE PROCEDURE sp_backup
AS
BEGIN
    BACKUP DATABASE [YourDatabase] TO  DISK = N'C:\YourPathAndFile.bak' 
    WITH NOFORMAT, NOINIT,  
    NAME = N'Full Database Backup', SKIP, NOREWIND, NOUNLOAD,  STATS = 10
END
GO 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-20T09:14:52.483

请参阅 [使用 C# 中的 SMO 库](http://msdn.microsoft.com/en-us/magazine/cc163409.aspx)

关于如何使用 C# 中的 SMO 库来执行管理员任务，例如备份和恢复。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-03-20T03:38:24.057

SQL 管理对象 - Microsoft.SqlServer.Management.Smo

它具有完成该操作所需的方法。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2012-02-07T17:00:45.907

这是一个将数据库备份内容放入流中的脚本（作为“选择”结果），这对于在没有任何共享文件夹的情况下以编程方式创建备份很有**用**。您唯一需要的是与服务器的连接。针对 MSSQL 2008 R2 进行了测试。

```
-- переменные
DECLARE @dbName nvarchar(MAX);
SET @dbName = N'AdventureWorks';

DECLARE @backupFileName nvarchar(MAX);
SET @backupFileName = N'C:\Temp\' + @dbName + N'.bak';
--EXECUTE (N'PRINT N''Создание бэкапа '+ @backupFileName + '''')
-- создание временной папки
EXEC xp_cmdshell N'mkdir C:\Temp', no_output;
-- бэкап с перетиранием имеющегося файла
DECLARE @sqlScript nvarchar(MAX);
SET @sqlScript = N'BACKUP DATABASE ['
    + @dbName
    + '] TO  DISK = N'''
    + @backupFileName
    + ''' WITH NOFORMAT, INIT, NAME = N'''
    + @dbName
    + '-Full Database Backup'', SKIP, NOREWIND, NOUNLOAD, STATS = 10';
--SELECT @sqlScript AS backupScript
EXECUTE (@sqlScript);
-- похоже, файл в 3ГБ можно вычитать... но памяти на это уходит ОЧЕНЬ МНОГО
-- вычитывание файла
SET @sqlScript = N'
SELECT N''' + @backupFileName + ''' AS [backupFileName], BulkColumn AS [backupContent]
FROM OPENROWSET (BULK ''' + @backupFileName + ''', SINGLE_BLOB) MyFile';
--SELECT @sqlScript AS openRowsetScript
EXECUTE (@sqlScript);
-- удаление файла
SET @sqlScript = N'EXEC xp_cmdshell ''del "' + @backupFileName + '"'', no_output';
EXECUTE (@sqlScript); 
```

结果如下：

```
 backupFileName  backupContent
C:\Temp\AdventureWorks.bak  0x54415045000003008C000E01000000000000000000000000000... 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-03-20T03:46:37.110

如果您拥有正确的权限，应该很容易。

想到的 2 种方法，已经提到的 SQL 管理对象，我发现了一个很好的项目，可以[在这里使用这些](http://www.geekpedia.com/tutorial180_Backup-and-restore-SQL-databases.html)

您也可以随时通过 ADO.Net 对象向服务器发送 T-SQL 备份命令。Msdn 参考您在[此处需要的主要命令](http://msdn.microsoft.com/en-us/library/aa225964(SQL.80).aspx)

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-11-24T01:26:53.773

如果您想在 C# 中使用字节流，例如在写入磁盘之前压缩流，欢迎您查看我的项目[SQL Server Compressed Backup](https://sourceforge.net/projects/mssqlcompressed/)中的代码。它有一个用 C++ 编写的小型 VDI（SQL Server 虚拟设备 API）DLL 包装器，忠实地将每个 VDI 选项暴露给 .Net，其余（大部分）代码是用 C# 编写的。

# c# - 我应该在帖子或网址中存储 _method=PUT/DELETE

> ID：664873
> 
> 赞同：4
> 
> 时间：2009-03-20T03:28:46.840
> 
> 标签：c#, asp.net-mvc, http, rest

我正在使用 ASP.NET MVC 来构建一个 RESTful Web 应用程序，并且我计划通过 POST 传输 PUT 和 DELETE 请求，因为这似乎是最实用的解决方法。

我想知道的是，我是否应该像这样通过 url 传输信息：

```
<form method='post' action='resource?_method=DELETE'>
    <!-- fields -->
</form> 
```

或者我应该像这样通过发布的表单数据对其进行隧道传输：

```
<form method='post' action='resource'>
    <input type='hidden' name='_method' value='DELETE' />
    <!-- fields -->
</form> 
```

以及各自的优缺点是什么？

**编辑：**我问这个问题的原因之一是我在某处读到，将这样的信息放在 url 中是一件好事，因为发布数据通常会丢失，但 url 会到处存在（在日志文件等中） - 不幸的是它使网址看起来很难看

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-20T03:37:29.270

你见过[这个](https://stackoverflow.com/questions/467535/is-it-possible-to-implement-x-http-method-override-in-asp-net-mvc)问题吗？据我了解， x-http-method-override 标头是此问题的首选解决方案。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-26T18:57:47.477

这更多的是个人喜好。Restful Web Services，OReilly，在某种程度上可以互换地描述两者。

话虽如此，出于程序员的意图，我更喜欢第一种方法。在休息时，当我查看代码时，我会在脑海中阅读

动词[http://someuri.com/someresource/id](http://someuri.com/someresource/id)

动词和资源紧密相连。

使用 PUT 和 DELETE，您必须使用您所展示的解决方法。在第一个示例中，资源和动词仍然紧靠在同一行上。

但是，在您的第二个示例中，资源被分成两行。动词与资源 ID 位于同一行，但远离资源名称。这是非常非常次要的，但对我来说，这使得第二个示例的可读性降低。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-20T03:55:58.630

不是我有，但你不应该使用：

```
<form method="put" action="resource">
    <!-- fields -->
</form> 
```

和/或

```
<form method="delete" action="resource">
    <!-- fields -->
</form> 
```

...？

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2009-03-20T03:36:39.847

它们是等价的。

虽然如果按下，我更愿意自己在帖子中发送，但这是主观的。

# drupal - 在线尝试 Joomla、Drupal 和其他 PHP CMS 包？

> ID：664876
> 
> 赞同：3
> 
> 时间：2009-03-20T03:30:02.703
> 
> 标签：drupal, joomla

有没有任何网站可以让我在线试用 joomla 或 drupal？

基本上我想学习 Joomla 和 Drupal，但不想下载整个源代码并将其安装在我的计算机上并开始配置它。我更喜欢允许我这样做的在线服务（最好是免费的！）。

有没有这样的网站可用？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-20T03:33:13.397

每个单独的网站通常都有一个演示！

Joomla：[http](http://demo.joomla.org/) ://demo.joomla.org/ Drupal：[http ://php.opensourcecms.com/scripts/details.php?scriptid=191](http://php.opensourcecms.com/scripts/details.php?scriptid=191)

Opensourcecms.com 上也有许多 CMS，并且大多数都有指向其演示的链接。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-20T16:26:29.327

快速尝试各种 Web 应用程序的一种便捷方法是使用预构建的虚拟机。这是获取它们的一个地方：

[http://www.vmware.com/appliances/directory/cat/502](http://www.vmware.com/appliances/directory/cat/502)

只需下载 VM 并启动它。每一个都是一个完全配置的系统，已经安装了应用程序。您可以使用 Drupal、Joomla、WordPress 等等。当您完成尝试或者如果您想重新开始时，只需将它扔到一边，然后再找一个新的。

但是，一旦您通过虚拟机获得了一些东西，绝对值得花时间练习安装和配置它。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-09-05T15:22:58.120

对于 Drupal 使用：使用[http://simplytest.me/](http://simplytest.me/)

它允许您安装和评估任何贡献的模块、主题、发行版。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-11-09T10:56:54.523

我创建了一个应用程序，您可以在其中尝试不同的 CMS / 网上商店：http://opstack.info:3000 [-](http://opstack.info:3000) 它甚至不需要您注册，只要您想让它保持更长时间。目前 Joomla、Drupal、Wordpress、Magento、Opencart、Typo3 可用，但由于易于扩展，该列表将会增加。

# c - 我需要在 C 中实现一个 Butterworth 过滤器。是否更容易获得具有此功能的库或编写代码？

> ID：664877
> 
> 赞同：8
> 
> 时间：2009-03-20T03:30:41.920
> 
> 标签：c, codeblocks

我的项目是 C 语言，CodeBlocks 是我的 IDE，我在 Windows Vista 上运行。我需要对我的数据应用巴特沃斯过滤器。我可以使用 Matlab 自动执行此操作，因为它具有这个（和其他）过滤器作为内置函数。计算机和编程并不完全是我的领域，我从未“导入”一个新库，也不知道如何做到这一点。复杂吗？我最好做什么？把巴特沃斯滤波器的代码写成一个函数？或“导入”一个库来为我做这件事？（就个人而言，如果不是那么复杂，我更喜欢获得一个库，因为它可能有其他类型的过滤器，我也可以测试）

* * *

## 回答 #1

> 赞同：33
> 
> 时间：2009-03-20T04:27:33.970

我们必须对我最近参与的一个项目的一些数据应用巴特沃斯过滤器。（压力测量会随着时间的推移而漂移，因为测量仪器会升温。）它实际上比包含一个库更简单。您实际上只需要包含一个函数并将其添加到您需要使用它的任何 C 文件中。

这是我们用来生成过滤器的站点：

[http://www-users.cs.york.ac.uk/~fisher/mkfilter/](http://www-users.cs.york.ac.uk/~fisher/mkfilter/)

如果您指定参数，它将为您生成函数。这是我们在应用程序中使用的函数的示例，基于上述网站生成的代码。（我们 typedef DOUBLE 是因为它是在 PC 上开发的，但针对的是嵌入式平台——我们需要确保大小不会改变。）

我喜欢阅读这个网站，很高兴终于有东西可以贡献了！

```
/* Butterworth filter constants */

#define NZEROS 4
#define NPOLES 4
static DOUBLE xv[NZEROS+1], yv[NPOLES+1];

/* Sampling rate 3000 for testing existing */
/* raw data.  Change to 300 for final product */
#define SAMPLING_RATE 3000

/*******************************************************************************
 * Function:      ButterworthFilter
 *
 * Description:   This function uses the Butterworth filter and returns a new
 *                value for an individual floating point value.
 *
 * Access:        PRIVATE
 *
 * Parameters:    DOUBLE input - value to be converted
 *
 * Globals:       None
 *
 * Returns:       DOUBLE - new value that has been converted
 ******************************************************************************/
static DOUBLE ButterworthFilter (DOUBLE input)
{ 
    /* http://www-users.cs.york.ac.uk/~fisher/cgi-bin/mkfscript */
    /* Butterworth Bandpass filter */
    /* 2nd order */
    /* sample rate - choice of 300 or 3000 Hz */
    /* corner1 freq. = 0.5 or 1 Hz */
    /* corner2 freq. = 20 Hz */
    /* removes high and low frequency noise */

    DOUBLE dCoefficient1 = 0.0;
    DOUBLE dCoefficient2 = 0.0;
    DOUBLE dCoefficient3 = 0.0;
    DOUBLE dCoefficient4 = 0.0;
    DOUBLE dCoefficient5 = 0.0;
    DOUBLE dGain = 0.0;

    /* coefficients will vary depending on sampling rate */
    /* and cornering frequencies                         */
    switch(SAMPLING_RATE)
    {
        case 300:
            /* 1 to 20 Hz */
            dCoefficient1 = 2.0;
            dCoefficient2 = -0.5698403540;
            dCoefficient3 = 2.5753677309;
            dCoefficient4 = -4.4374523505;
            dCoefficient5 = 3.4318654424;
            dGain = 3.198027802e+01;
            break; 

        case 3000:
        default:
            /* 0.5 to 20 Hz */ 
            dCoefficient1 = 2.0;
            dCoefficient2 = -0.9438788347;
            dCoefficient3 = 3.8299315572;
            dCoefficient4 = -5.8282241502;
            dCoefficient5 = 3.9421714258;
            dGain = 2.406930558e+03;
            break;  
    } 

    xv[0] = xv[1]; 
    xv[1] = xv[2]; 
    xv[2] = xv[3]; 
    xv[3] = xv[4]; 
    xv[4] = (DOUBLE)(input / dGain);
    yv[0] = yv[1]; 
    yv[1] = yv[2]; 
    yv[2] = yv[3]; 
    yv[3] = yv[4]; 
    yv[4] = (DOUBLE)((xv[0] + xv[4]) - (dCoefficient1 * xv[2]) + (dCoefficient2 * yv[0]) +
                    (dCoefficient3 * yv[1]) + (dCoefficient4 * yv[2]) +
                    (dCoefficient5 * yv[3]));

    return (yv[4]);
} 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-03-20T03:37:39.907

几乎可以肯定，使用经过良好测试的外部库（假设您可以找到一个....尝试过 Google 吗？）比自己编写一个重要的过滤器更简单、更安全。

但是，由于您没有提及您的应用程序、您的数据格式等，我们可以告诉您的信息不多。

* * *

我对您的 IDE (CodeBlocks) 的工作原理一无所知，但导入通常采用以下三种形式之一，具体取决于您如何使用该库（详细信息如下）：

1.  **您获得**一个或多个功能的源代码（希望有好的文档）：阅读文档，将代码复制到适当的目录，将文件添加到项目中，尝试编译，修复丢失的预处理器符号等...
2.  **您为您的平台获得了一个普通的二进制库和头文件**（可能来自您的操作系统包管理系统）：阅读文档，告诉 IDE 在哪里可以找到头文件和库，尝试链接，修复问题......
3.  **您获得了一个提供功能的框架**：这有点麻烦，但它也是从阅读文档开始的，然后可能会像库案例一样进行，但要编写更多代码......

无论如何，你会在某个时候做

```
#include "library.h" 
```

在您的一些源文件中，使外部功能对您的代码可见。

可能你想先找到一个候选库，看看它以什么形式提供，然后阅读更多关于你的 IDE 的信息，看看你从那里去哪里。

* * *

另一个可能与您的需求相关的 SO 问题：[模拟电路仿真库？](https://stackoverflow.com/questions/607297/analog-circuit-simulation-library).

* * *

我已经很久没有使用 matlab 了，但如果这是你的基本编程经验，你应该知道matlab 提供给你*的很多*功能不是普通的 vanilla c。你几乎肯定想使用一些框架或另一个来给你一些支持。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-03-20T04:25:59.247

如果您使用的是 Matlab，从您的 C 代码链接到 Matlab 是否禁忌？ [这](http://www.mathworks.com/access/helpdesk/help/techdoc/index.html?/access/helpdesk/help/techdoc/matlab_external/f38569.html)是一个起点。实际上，您可以通过从 C 调用 Matlab 引擎来要求 Matlab 引擎执行您可以在 Matlab 接口中执行的任何操作。

Butterworth 滤波器是递归的，所以它应该被实现为 IIR 滤波器。一旦您从 Matlab 测试中获得了稳定的滤波器系数，您就可以简单地将它们提供给通用 IIR 算法（非常简单）。您可以使用大型 FIR 滤波器和卷积来近似滤波器响应，可以将其移至频域以解决相位问题，但如果您这样做，它就不是真正的巴特沃斯。

我建议从头开始构建一个算法作为学习练习，但如果您需要尽快使用它，可能有许多库可以帮助您。 [这](http://freshmeat.net/projects/libfilth)是在搜索中出现的。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-10-16T22:23:19.230

史蒂夫哈里斯的 SWH LADSPA 插件包中有巴特沃斯过滤器，位于

[http://plugin.org.uk](http://plugin.org.uk)

编辑：除了现在我记得 C 代码由于各种原因嵌入在 RDF 中并自动生成。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-05-27T16:23:47.190

这是最好的过滤器生成器 [http://www-users.cs.york.ac.uk/~fisher/mkfilter/trad.html](http://www-users.cs.york.ac.uk/~fisher/mkfilter/trad.html)

不幸的是，它在 C 代码生成时开始失败。但是，它以接近 C 代码的形式发出了足够的信息，以便您可以重现类似于[Mike 提出](https://stackoverflow.com/a/664982/1083704)的程序。您不需要任何额外的库。当您想要更新系数（可变截止频率）时，库可能很有用。我不知道在您的程序中计算这些系数的算法。

# eclipse - 无法连接到 Eclipse 中的队列管理器运行时异常

> ID：664878
> 
> 赞同：0
> 
> 时间：2009-03-20T03:31:37.613
> 
> 标签：eclipse, exception, ibm-midrange, iseries-navigator

我正在使用 Eclipse 和 i-series Navigator 作为数据库。当我运行我的应用程序时，它显示：

```
Exception=Exception001{Id=0,Message=java.lang.RuntimeException:
     Failed to connect to queue manager,Severity=2}],
     ServiceID=GetCustomerProfile2,Status=2,TransactionID=1} 
```

是什么原因造成的，我该如何解决？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-20T04:43:05.897

我不知道您的具体问题是什么，但所有 IBM 产品问题的第一个呼叫端口是文档站点（[此处](http://www-03.ibm.com/systems/i/software/navigator/index.html)`publib`为iSeries 资料）或[此处](http://publib.boulder.ibm.com/infocenter/iseries/v5r3/index.jsp?topic=/rzahg/icmain.htm)的“Navigator for i”支持站点。

我要做的第一件事是联系您的 iSeries 支持人员，看看他们的 MQ 设备是否存在问题。如果他们说不，那么您需要弄清楚 iSeries Navigator 将其日志存储在本地机器上的什么位置（因为那里更有可能出现问题）。

iSeries 机箱与您以前从未见过的任何东西都不同（即使是使用 System z 的人也认为它们有点奇怪 :-)。最好从了解他们的人那里获得帮助。

# c# - 如何找到空端口来启动 WCF web ServiceHost

> ID：664879
> 
> 赞同：1
> 
> 时间：2009-03-20T03:31:50.157
> 
> 标签：c#, .net, wcf, networking, port

如何确定未使用的端口来启动 WCF ServiceHost 以在其上托管 localhost Web 服务器？

我目前正在[http://localhost:XXXX](http://localhost:XXXX)上静态启动我的服务，其中 XXXX 是我的代码中的静态值。

我想用 GetUnusedPort() 调用替换 XXXX...

有什么想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-22T01:39:28.223

我能找到的最好的方法是尝试直到你找到一个开放的选项......

[http://forums.devshed.com/net-development-87/c-how-to-determine-if-a-port-is-in-use-371148.html](http://forums.devshed.com/net-development-87/c-how-to-determine-if-a-port-is-in-use-371148.html)

```
 public static bool TryPortNumber(int port)
    {
        try
        {

            using (var client = new System.Net.Sockets.TcpClient(new System.Net.IPEndPoint(System.Net.IPAddress.Any, port)))
            {
                return true;
            }
        }
        catch (System.Net.Sockets.SocketException error)
        {
            if (error.SocketErrorCode == System.Net.Sockets.SocketError.AddressAlreadyInUse /* check this is the one you get */ )
                return false;
            /* unexpected error that we DON'T have handling for here */
            throw error;
        }
    } 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-20T03:45:51.260

为什么不让用户选择他们想在哪个端口上托管服务呢？例如，将一个值添加到您的应用程序的配置文件中，该文件将传递给您的 ServiceHost。您还可以尝试随机生成一个端口号并测试它是否打开，然后如果另一个应用程序已经在使用它，则重复该过程。

# c# - 我可以使用 get 和 set 代码创建自动属性（无私有成员）吗？

> ID：664883
> 
> 赞同：1
> 
> 时间：2009-03-20T03:33:13.350
> 
> 标签：c#, properties, automatic-properties

在 c# 中，我可以这样做：

```
public int Foo { get; set; } 
```

这很好。但是，一旦我想在 getter 或 setter 中做任何事情，我就必须将其更改为：

```
private int foo;
public int Foo {
    get { return foo; }
    set {
        foo = value;
        DoSomething();  // all that other code, just to add this line!
    }
} 
```

有可能避免这种情况吗？我希望能够做这样的事情：

```
public int Foo {
    get;
    set {           
       DoSomething();
    }
} 
```

我能离上面多近？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-03-20T03:35:26.933

不，没有办法对现有版本的 C# 或 C# 4.0 中的属性执行此操作。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-20T03:55:52.780

正如其他人所说，没有内置的方法可以做到这一点。

您可以使用[PostSharp](http://www.postsharp.org/)实现类似的效果。但我不确定它是否值得努力。

```
[AfterSet(DoSomething)]
public int Foo {
    get;
    set;
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-20T03:49:46.853

使用自动属性，编译器会为您生成一个支持字段。自定义 getter/setter 要求您手动创建一个支持字段来使用。在自动属性上指定自定义 getter/setter 的能力本质上使它就像一个方法一样，因为没有任何东西可以获取或设置。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-20T03:50:32.607

简短的回答？不，长答案？对不起，还是不行。:) 我感觉到你的痛苦，但事实就是这样。

# javascript - 在 Javascript 中， == " " 评估为真。为什么会这样？

> ID：664886
> 
> 赞同：11
> 
> 时间：2009-03-20T03:34:29.667
> 
> 标签：javascript, variables, comparison

如果我做 0 == "0" 它评估为真。尝试，

```
if( -777 == "-777" ) alert("same"); 
```

警报发生。

而且，还值得注意的是 true == "true" 不会评估为 true。尝试，

```
if( false == "false" ) alert("same"); 
```

警报不会发生。

为什么会这样？

* * *

## 回答 #1

> 赞同：33
> 
> 时间：2009-03-20T05:08:57.130

== 的行为有点冗长，但在[ecma-262 规范](http://www.ecma-international.org/publications/standards/Ecma-262.htm)中明确定义：

> 11.9.3 抽象等式比较算法
> 
> 比较 x == y，其中 x 和 y 是值，产生真或假。如下进行这样的比较：
> 
> 1.  如果 Type(x) 与 Type(y) 不同，则转到步骤 14。
> 2.  如果 Type(x) 未定义，则返回 true。
> 3.  如果 Type(x) 为 Null，则返回 true。
> 4.  如果 Type(x) 不是 Number，则转到步骤 11。
> 5.  如果 x 是 NaN，则返回 false。
> 6.  如果 y 是 NaN，则返回 false。
> 7.  如果 x 与 y 的数值相同，则返回 true。
> 8.  如果 x 为 +0 且 y 为 -0，则返回 true。
> 9.  如果 x 为 -0 且 y 为 +0，则返回 true。
> 10.  返回假。
> 11.  如果 Type(x) 是 String，则如果 x 和 y 是完全相同的字符序列（相同长度和对应位置的相同字符），则返回 true。否则，返回假。
> 12.  如果 Type(x) 是布尔值，如果 x 和 y 都为真或都为假，则返回真。否则，返回假。
> 13.  如果 x 和 y 指的是同一个对象或者如果它们指的是相互连接的对象，则返回 true（参见 13.1.2）。否则，返回假。
> 14.  如果 x 为 null 且 y 未定义，则返回 true。
> 15.  如果 x 未定义且 y 为空，则返回 true。
> 16.  如果 Type(x) 是 Number 并且 Type(y) 是 String，则返回比较结果 x == ToNumber(y)。
> 17.  如果 Type(x) 是 String 并且 Type(y) 是 Number，则返回比较结果 ToNumber(x) == y。
> 18.  如果 Type(x) 是 Boolean，则返回比较 ToNumber(x) == y 的结果。
> 19.  如果 Type(y) 是 Boolean，则返回比较结果 x == ToNumber(y)。
> 20.  如果 Type(x) 是 String 或 Number 且 Type(y) 是 Object，则返回比较结果 x == ToPrimitive(y)。
> 21.  如果 Type(x) 是 Object 并且 Type(y) 是 String 或 Number，则返回 ToPrimitive(x) == y 的比较结果。
> 22.  返回假。

第 16 步适用于您之前的示例：

```
 0 == "0"            // apply 16
≡  0 == toNumber("0")
≡  0 == 0              // apply 7
≡  true 
```

步骤 18，然后是步骤 16，适用于后者：

```
 true == "true"            // apply 18
≡  toNumber(true) == "true"
≡  1 == "true"               // apply 16
≡  1 == toNumber("true")
≡  1 == NaN                  // apply 6
≡  false 
```

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2009-03-20T03:36:20.940

这样做：

```
if(5 == "5") 
```

使 javascript 将前 5 个转换为字符串。试试这个：

```
if(5 === "5") 
```

这`===`也使得 Javascript 评估类型。

这实际上是这个的副本[`question`](https://stackoverflow.com/questions/359494/javascript-vs)，它解释得很好。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2009-03-20T03:39:56.797

因为 Javascript 是松散类型的，它会根据操作和操作中其他变量的类型默默地转换您的变量。

```
alert ("5" - 1);  // 4  (int)
alert ("5" + 1);  // "51" (string) "+" is a string operator, too
alert ("5" == 5); // true 
```

您可能想要查看的是**身份**检查 ( `===`)。这确保变量是*相同*的，而不仅仅是*相等*。

```
alert("5" == 5);  // true, these are equal
alert("5" === 5); // false, these are not identical. 
```

另请参阅此问题：[相等和身份比较运算符有何不同？](https://stackoverflow.com/questions/80646/how-do-the-equality-and-identity-comparison-operators-differ)PHP 的实现与 javascript 非常相似。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-03-20T03:54:53.783

JavaScript 有两组相等运算符：

*   `=== and !==`（严格相等运算符）
*   `== and !=`（标准相等运算符）

如果两个操作数的类型相同，标准的相等运算符将进行正确的比较，但如果它们不是相同的类型，您可能会得到一些意想不到的结果，例如：

```
'' == '0' // false
0 == '' // true
0 == '0' // true
false == 'false' // false
false == '0' // true
false == undefined // false
false == null // false
null == undefined // true
' \t\r\n ' == 0 // true 
```

为此，我始终建议使用严格的相等运算符（===，！==）。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-20T03:36:17.167

Javascript 不会将“false”转换为布尔值 false，只会转换为字符串“false”。

您可以将字符串值松散地转换为等效的整数，因此您的第一个示例有效。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-03-20T03:40:01.867

Javascript 是一种松散类型的语言，因此只要解释器​​认为需要，就会在运行时进行类型转换。如果将整数与字符串进行比较，则表明它们应该是相同的类型，例如，“34” == 34 为真，因为在比较之前整数可能会被类型转换为字符串。

字符串 "false" 没有被类型转换为 bool，而是 bool false 被类型转换为一个字符串，它实际上将具有值 "0"，即包含数字 0 的字符串，给出 "0" == " false”，这显然是错误的。

如果要在不进行自动类型转换的情况下比较值，有效地比较类型和值，请使用三等号：

5 === "5" 假 "字符串" === "字符串" 真

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-03-20T11:37:30.863

> 为什么会这样？

因为 JavaScript 既是松散类型的，又是非常不一致的。并非所有设计功能都经过深思熟虑。与任何其他编程语言相比，它的创建、实现和部署速度都非常快，急于推出 Netscape 2.0。直到不久之后，它才稳定下来，丢失了一些更严重的错误并变得半标准化。

为诸如隐式类型转换规则之类的事情寻找某种哲学原理可能是徒劳的。JavaScript 坚持的唯一真正一致的原则是[DWIM](http://www.catb.org/~esr/jargon/html/D/DWIM.html)，非常消极。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2011-01-02T08:47:31.170

JavaScript 将 falsey 值定义为 0、布尔 false 和未定义。“0”之外的任何字符串都将为真，即使该字符串为“假”。

有点烦，真的。

# java - 从java中的任意char获取VK int

> ID：664896
> 
> 赞同：8
> 
> 时间：2009-03-20T03:37:12.530
> 
> 标签：java, unit-testing, keyboard, awtrobot, fest

您如何从字母字符中获取 VK 代码？似乎您应该能够执行类似的操作`javax.swing.KeyStroke.getKeyStroke('c').getKeyCode()`，但这不起作用（结果为零）。如果您已经有了 KeyEvent，每个人都知道如何获取密钥代码，但是如果您只想将 chars 转换为 VK int 怎么办？我对获取奇怪字符的 FK 代码不感兴趣，只有 [AZ]、[az]、[0-9]。

这个问题的背景--------我见过的所有机器人教程都假设程序员喜欢通过发送带有VK代码的按键来拼写单词：

> ```
> int keyInput[] = {
>       KeyEvent.VK_D,
>       KeyEvent.VK_O,
>       KeyEvent.VK_N,
>       KeyEvent.VK_E
>   };//end keyInput array 
> ```

叫我懒惰，但即使使用 Eclipse，也无法在 GUI 上使用 TDD。如果有人碰巧知道一个类似于 Robot 的类，它接受字符串然后模拟这些字符串的用户输入（我正在使用[FEST](http://www.javaworld.com/javaworld/jw-07-2007/jw-07-fest.html)），我很想知道。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2010-11-05T20:40:41.247

```
AWTKeyStroke.getAWTKeyStroke('c').getKeyCode(); 
```

稍微澄清[佩斯的回答](https://stackoverflow.com/a/4001177/369977)。它应该是单引号（代表一个字符），而不是双引号（代表一个字符串）。

使用双引号会抛出 java.lang.IllegalArgumentException（字符串格式不正确）。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-03-20T07:43:25.713

也许这个丑陋的黑客：

```
Map<String, Integer> keyTextToCode = new HashMap<String, Integer>(256);
Field[] fields = KeyEvent.class.getDeclaredFields();
for (Field field : fields) {
    String name = field.getName();
    if (name.startsWith("VK_")) {
        keyTextToCode.put(name.substring("VK_".length()).toUpperCase(),
                          field.getInt(null));
    }
} 
```

keyTextToCode 将包含从字符串（例如“A”或“PAGE_UP”）到 vk 代码的映射。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2010-10-22T21:41:28.943

```
AWTKeyStroke.getAWTKeyStroke("C").getKeyCode(); 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2011-06-29T16:44:35.730

我在为扩展 Robot 而编写的类中将以下代码用于大写字母和数字：

```
 public void typeLetterOrNumber(char c) {
    if(Character.isLetter(c)) {
        keyPress((int)c);
        keyRelease((int)c);
    }
    else if(Character.isDigit(c)) {
        keyPress(48+(int)c);
        keyRelease(48+(int)c);
    }
} 
```

基本上，我只是查看了*KeyEvent.VK_whatever*值并进行了适当的数学运算以在我的代码中进行补偿。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-20T05:11:51.477

我不认为有一个简单的答案。

首先意识到 java 有两个字节字符，而不是近 2^16 KeyEvent.VK_ 的定义。所以会有一些字符不能生成任何 KeyEvent 来获得该输出。

此外，C 和 c 以及 Ç 和 ç 都具有相同的`KeyEvent.getKeyCode() == KeyEvent.VK_C`.

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2011-04-29T10:45:27.813

Adam Paynter 的答案（对[Convert String to KeyEvents](https://stackoverflow.com/questions/1248510/convert-string-to-keyevents)问题的回答）也应该在这里起作用。简单但可行的想法是有一个大开关，如下所示：

```
public void type(char character) {
    switch (character) {
    case 'a': doType(VK_A); break;
    case 'b': doType(VK_B); break;
    case 'c': doType(VK_C); break;
    case 'd': doType(VK_D); break;
    case 'e': doType(VK_E); break;
    // ...
    case 'A': doType(VK_SHIFT, VK_A); break;
    case 'B': doType(VK_SHIFT, VK_B); break;
    case 'C': doType(VK_SHIFT, VK_C); break;
    // ...
    }
} 
```

请参阅整个清单（包括周围的实用程序类）的原始答案。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2015-01-25T06:29:06.567

如果您的主要目标是尽可能快地写出字母，您可以像我所做的那样将字符串写入剪贴板，然后只需使用`Robot`类输入 Ctrl+V。

```
static void type(String s) {
    Toolkit.getDefaultToolkit().getSystemClipboard().setContents(new StringSelection(s), null);
    robot.setAutoDelay(30);
    robot.keyPress(VK_CONTROL);
    robot.keyPress(VK_V);
    robot.keyRelease(VK_CONTROL);
    robot.keyRelease(VK_V);
} 
```

系统剪贴板中还有一些其他功能可以让您在需要时保存和恢复剪贴板上的任何数据。同样，如果您想控制每个字符之间的速度，您可以`robot.delay(n);`使用 foreach 循环一次将每个字母放在剪贴板上，并在它们之间插入一个。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2011-10-09T14:58:34.110

我找到了两种方法：

A. 使用 JButton.setMnemonic 的解决方法，getMnemonic：

```
javax.swing.JButton but = new javax.swing.JButton();
but.setMnemonic(charVkValue);
int intVkValue = but.getMnemonic()); 
```

B. 下载打开的jdk源码，看看它的AbstractButton.setMnemonic(char)方法。此代码在 GPL2 下获得许可，但这 4 行通常与“keyPress(48+(int)c)”的答案相同。

[http://www.java2s.com/Open-Source/Java-Document/6.0-JDK-Core/swing/javax/swing/AbstractButton.java.htm](http://www.java2s.com/Open-Source/Java-Document/6.0-JDK-Core/swing/javax/swing/AbstractButton.java.htm)

# python - Python的层次结构遍历和比较模块？

> ID：664898
> 
> 赞同：5
> 
> 时间：2009-03-20T03:37:34.777
> 
> 标签：python, tree, module, hierarchy, traversal

我在日常开发中处理了很多层次结构。Autodesk Maya 中的文件系统、嵌套 DAG 节点等。

我想知道，有没有专门设计用于遍历和比较对象层次结构的 Python 模块？

特别感兴趣的是在两个*几乎*相同的层次结构之间进行“模糊”比较的方法。这样做的一些原因是为了在 Maya 中匹配来自两个不同角色的两个节点层次结构，以便将动画从一个角色转移到另一个角色。

根据我一直在阅读的内容，我可能需要具有名称阈值的东西（我可以自己构建）来比较两个节点名称彼此之间的接近程度。然后，我需要一种方法来选择性地忽略子节点出现在层次结构中的顺序。最后，我需要处理深度阈值，以防节点可能在层次结构中略微向上或向下移动。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-20T10:00:05.137

我不确定我是否需要一个完整的模块——层次结构是一种设计模式，每个层次结构都有足够的独特功能，很难一概而论。

```
class Node( object ):
    def __init__( self, myData, children=None )
        self.myData= myData
        self.children= children if children is not None else []
    def visit( self, aVisitor ):
        aVisitor.at( self )
        aVisitor.down()
        for c in self.children:
            aVisitor.at( c )
        aVisitor.up()

class Visitor( object ):
    def __init__( self ):
        self.depth= 0
    def down( self ):
        self.depth += 1
    def up( self ):
        self.depth -= 1 
```

我发现这就是我所需要的。而且我发现很难用它来制作一个可重用的模块，因为（a）这里的代码太少了，（b）每个应用程序都添加或更改了很多代码。

此外，我发现最常用的层次结构是文件系统，为此我有`os`模块。第二个最常用的层次结构是 XML 消息，我有 ElementTree（通常通过 lxml）。在这两个之后，我将上述结构用作我的类的模板，而不是作为文字可重用模块。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-22T03:06:05.117

我建议挖掘 xmldifff [http://www.logilab.org/859](http://www.logilab.org/859)并查看它们如何比较节点和处理并行树。或者，尝试编写一个 [recursive] 生成器，生成树中的每个 [significant] 节点，例如`f(t)`，然后用于`itertools.izip(f(t1),f(t2))`将节点对收集在一起进行比较。

我处理的大多数层次结构都有多个“轴”，例如 XML 中的元素和属性，并且一些节点比其他节点更重要。

对于更奇怪的解决方案，将两棵树序列化为文本文件，请注意 #n 行来自树中的节点 #x。对两棵树都这样做，将文件输入 diff，然后扫描结果以注意树的哪些部分发生了变化。您可以映射文件 1 中的 #n 行（因此第一棵树中的节点 #x）和文件 2 中的 #m 行（因此第二棵树的节点 #y）意味着每棵树的某些部分是相同的或不同的。

对于任何解决方案，您都必须建立树的“规范形式”，它可能会从比较过程中删除所有可忽略的空白、显示属性、可选节点等。这也可能意味着对树进行广度优先与深度优先遍历。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-20T03:53:27.640

[http://code.google.com/p/pytree/](http://code.google.com/p/pytree/)

这些可能会矫枉过正或根本不适合您的需要：

[http://networkx.lanl.gov/](http://networkx.lanl.gov/)

[http://www.osl.iu.edu/~dgregor/bgl-python/](http://www.osl.iu.edu/~dgregor/bgl-python/)

# sql-server - T-SQL 中的睡眠命令？

> ID：664902
> 
> 赞同：391
> 
> 时间：2009-03-20T03:39:52.320
> 
> 标签：sql-server, tsql, asynchronous, sleep

有没有办法编写一个 T-SQL 命令让它休眠一段时间？我正在异步编写 Web 服务，我希望能够运行一些测试以查看异步模式是否真的会使其更具可扩展性。为了“模拟”缓慢的外部服务，我希望能够使用运行缓慢但实际上并没有处理大量内容的脚本调用 SQL 服务器。

* * *

## 回答 #1

> 赞同：677
> 
> 时间：2009-03-20T03:41:13.940

查看[WAITFOR](http://msdn.microsoft.com/en-us/library/ms187331.aspx)命令。

例如

```
-- wait for 1 minute
WAITFOR DELAY '00:01'

-- wait for 1 second
WAITFOR DELAY '00:00:01' 
```

此命令允许您获得高精度，但在典型机器上[仅在 10ms - 16ms 内准确，](https://docs.microsoft.com/en-gb/archive/blogs/psssql/how-it-works-sql-server-timings-and-timer-output-gettickcount-timegettime-queryperformancecounter-rdtsc)因为它依赖于[GetTickCount](http://msdn.microsoft.com/en-us/library/ms724408(VS.85).aspx)。因此，例如，调用`WAITFOR DELAY '00:00:00:001'`很可能根本不需要等待。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2015-09-24T14:17:06.343

```
WAITFOR DELAY 'HH:MM:SS' 
```

我相信这可以等待的最长时间是 23 小时 59 分 59 秒。

这是一个标量值函数来展示它的用途；下面的函数将采用秒的整数参数，然后将其转换为 HH:MM:SS 并使用`EXEC sp_executesql @sqlcode`查询命令执行它。下面的函数仅用于演示，我知道它不适合用作标量值函数！:-)

```
 CREATE FUNCTION [dbo].[ufn_DelayFor_MaxTimeIs24Hours]
    (
    @sec int
    )
    RETURNS
    nvarchar(4)
    AS
    BEGIN

    declare @hours int = @sec / 60 / 60
    declare @mins int = (@sec / 60) - (@hours * 60)
    declare @secs int = (@sec - ((@hours * 60) * 60)) - (@mins * 60)

    IF @hours > 23 
    BEGIN
    select @hours = 23
    select @mins = 59
    select @secs = 59
    -- 'maximum wait time is 23 hours, 59 minutes and 59 seconds.'
    END

    declare @sql nvarchar(24) = 'WAITFOR DELAY '+char(39)+cast(@hours as nvarchar(2))+':'+CAST(@mins as nvarchar(2))+':'+CAST(@secs as nvarchar(2))+char(39)

    exec sp_executesql @sql

    return ''
    END 
```

如果您希望延迟超过 24 小时，我建议您使用 @Days 参数持续几天并将可执行的函数包装在一个循环中......例如。

```
 Declare @Days int = 5
    Declare @CurrentDay int = 1

    WHILE @CurrentDay <= @Days
    BEGIN

    --24 hours, function will run for 23 hours, 59 minutes, 59 seconds per run.
    [ufn_DelayFor_MaxTimeIs24Hours] 86400

    SELECT @CurrentDay = @CurrentDay + 1
    END 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2016-04-05T20:43:51.277

你也可以“等待”一个“时间”：

```
 RAISERROR('Im about to wait for a certain time...', 0, 1) WITH NOWAIT
    WAITFOR TIME '16:43:30.000'
    RAISERROR('I waited!', 0, 1) WITH NOWAIT 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-20T18:35:40.510

这是一段非常简单的 C# 代码，用于测试 CommandTimeout。它会创建一个等待 2 秒的新命令。将 CommandTimeout 设置为 1 秒，运行时会看到异常。将 CommandTimeout 设置为 0 或高于 2 的值将运行良好。顺便说一句，默认的 CommandTimeout 是 30 秒。

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Threading.Tasks;

using System.Data.SqlClient;

namespace ConsoleApplication1
{
  class Program
  {
    static void Main(string[] args)
    {
      var builder = new SqlConnectionStringBuilder();
      builder.DataSource = "localhost";
      builder.IntegratedSecurity = true;
      builder.InitialCatalog = "master";

      var connectionString = builder.ConnectionString;

      using (var connection = new SqlConnection(connectionString))
      {
        connection.Open();

        using (var command = connection.CreateCommand())
        {
          command.CommandText = "WAITFOR DELAY '00:00:02'";
          command.CommandTimeout = 1;

          command.ExecuteNonQuery();
        }
      }
    }
  }
} 
```

# java - 如何将一维数组转换为二维数组

> ID：664927
> 
> 赞同：1
> 
> 时间：2009-03-20T03:54:00.867
> 
> 标签：java, arrays

我已经有了如何将二维一维转换为一维的代码，但我不知道如何反之亦然。这是我的代码：

```
package laboratorio9;

import java.util.Scanner;
public class Main {
  public static void main(String[] args) {
    Scanner entrada = new Scanner(System.in);
    int A[][];
    int B[];
    int n;
    int m;
    int nb = 0;

    System.out.println("Enter the number of lines in your array.");
    n = entrada.nextInt();

    System.out.println("Enter the number of columns in your array.");
    m = entrada.nextInt();

    A = new int[m][n];
    B = new int[m*n];

    for (int i = 0; i < m; i++) {
      for (int j = 0; j < n; j++) {
        System.out.println("Enter A["+i+"]["+j+"]");
        A[i][j] = entrada.nextInt();
      }
    }
    System.out.println();

    for (int i = 0; i < m;i++) {
      for (int j = 0; j < n; j++) {
        B[nb] = A[i][j];
        nb++;
      }
    }

    for (int i = 0; i < m*n; i++) {
      System.out.println(B[i] + "  ");
    }
    System.out.println();

    Boolean Swap = false;

    do {
      Swap = false;
      for (int i=0;i<B.length-1;i++)
        if (B[i] > B[i + 1]) {
          int Temp = B[i];
          B[i] = B[i + 1];
          B[i + 1] = Temp;
          Swap = true;            
        }
    } while (Swap);

    for (int i=0;i<B.length;i++)
      System.out.println(B[i]);
  }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-20T04:15:05.810

you're looking for something like:

```
int j = 0;
int k = 0;
for ( int i = 0; i < nb;i++)
{
    C[j][k] = B[i];
    k++;
    if( k >= n )
    {
        j++;
        k = 0;
        if( j >= m )
            throw Error();
    } 
} 
```

which is the same as:

```
int k = 0;
for ( int i = 0; i < m;i++)
{
    for ( int j = 0; j < n;j++)
    {
        C[i][j] = B[k++];
    }
} 
```

but with trying to help explain the concept more.

# iphone - UIBarButtonItem 有颜色？

> ID：664930
> 
> 赞同：50
> 
> 时间：2009-03-20T03:55:00.443
> 
> 标签：iphone, cocoa-touch

是否有可能有一个红色的 UIBarButtonItem？

* * *

## 回答 #1

> 赞同：63
> 
> 时间：2011-05-13T06:09:16.760

如果有人正在寻找完全复制简单 UIBarButtonItem 的代码：

```
UIButton *button = [UIButton buttonWithType:UIButtonTypeCustom];
[button setBackgroundImage:[UIImage imageNamed:@"delete.png"] forState:UIControlStateNormal];
[button setTitle:@"Delete" forState:UIControlStateNormal];
button.titleLabel.font = [UIFont fontWithName:@"Helvetica-Bold" size:12.0f];
[button.layer setCornerRadius:4.0f];
[button.layer setMasksToBounds:YES];
[button.layer setBorderWidth:1.0f];
[button.layer setBorderColor: [[UIColor grayColor] CGColor]];
button.frame=CGRectMake(0.0, 100.0, 60.0, 30.0);
[button addTarget:self action:@selector(batchDelete) forControlEvents:UIControlEventTouchUpInside];

UIBarButtonItem* deleteItem = [[UIBarButtonItem alloc] initWithCustomView:button]; 
```

而 delete.png 是：

![删除.png](https://i.stack.imgur.com/P0xJO.png)

* * *

## 回答 #2

> 赞同：36
> 
> 时间：2012-07-23T05:58:51.590

为什么不只是：

```
[[self editButtonItem] setTintColor:[UIColor redColor]]; 
```

（在 sdk 4.* 、ios 5 及更高版本上）

* * *

## 回答 #3

> 赞同：27
> 
> 时间：2009-06-03T12:06:33.423

您可以创建具有所需外观的自定义 UIButton，并将您的 UIBarButtonItem 初始化为自定义视图。

```
UIButton *button = [UIButton buttonWithType:....];
...(customize your button)...

UIBarButtonItem *barButton = [[UIBarButtonItem alloc] initWithCustomView:button]; 
```

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2011-10-16T22:30:08.360

您可以在 iOS 5 中设置 UIBarButtonItem 的 tintColor 属性。如果您需要支持 iOS 4，请查看[此博客文章](http://fredandrandall.com/blog/2011/03/31/how-to-change-the-color-of-a-uibarbuttonitem/)。它使用 UISegmentedControl 进行详细说明，该控件的样式看起来像单个按钮。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-06-03T05:39:09.750

使用自定义图像不起作用，因为它只是使用 alpha 来呈现按钮。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2011-10-11T15:37:51.663

好的，在我看来，实际上有一个更好的解决方案，它涉及更少的代码并使用本机 UI 控件。

诀窍是使用 UISegmentedControl，并删除除一个之外的所有段。（不能在 IB 中完成，必须以编程方式完成）。

完成后，设置色调颜色，然后创建一个 UIBarButtonItem 将 UISegmentedControl 作为自定义视图传递给它。

这个人使用该技术创建了一个 UIBarButtonItem 类别，效果非常好：

[http://fredandrandall.com/blog/2011/03/31/how-to-change-the-color-of-a-uibarbuttonitem/](http://fredandrandall.com/blog/2011/03/31/how-to-change-the-color-of-a-uibarbuttonitem/)

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-03-20T06:29:23.380

您可以为按钮创建自定义图像并使用它。否则，如果您将导航栏或工具栏的 tintColor 设置为红色，则这些上的按钮项也将显示为红色。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2011-05-31T14:41:36.660

如果它是 UIToolbar 的 UIBarButtonItem

在您想要此代码的文件中实现之前设置它

```
@class UIToolbarTextButton; 
```

然后更改工具栏按钮：

```
 for (UIView *view in self.navigationController.toolbar.subviews) {
        NSLog(@"%@", [[view class] description]);
        if ([[[view class] description] isEqualToString:@"UIToolbarTextButton"]) {
            [(UIToolbarTextButton *)view setTintColor:yourcolor];
        }
    } 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2010-09-29T18:50:49.470

如果使用 IB (Interface Builder)，将 a`UIView`从 Library 拖到 上`UIToolBar`，它将生成`UIBarButtonItem`带有自定义视图的 a。然后，您可以添加您想要的任何其他控件，例如`UIButton`, `UILabel`, `UIActivityIndicatorView`。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2012-02-23T17:40:56.247

我想在突出显示的解决方案中添加一些内容。如果您执行此子类化，它将不会执行分配给 UIBarButtonItem 的故事板定义的 segue 和选择器。此外，UIBarButtonItem 中未设置“目标”和“操作”属性，因此您无法从子类访问它们并将它们分配给您的 UIButton。

我通过向我的子类（使用 ARC）添加 2 个属性来解决这个问题：

```
@property (nonatomic, weak) id targetViewController;
@property (nonatomic, strong) NSString *segueIdentifier; 
```

接下来，在您的子类的 init 中，将这样的内容添加到接受的答案代码中：

```
[button addTarget:self action:@selector(performAction) forControlEvents:UIControlEventTouchUpInside]; 
```

和一个功能：

```
- (void)performAction {
    if (_targetViewController && _segueIdentifier) {
        [_targetViewController performSegueWithIdentifier:_segueIdentifier sender:self];
    } else {
        NSLog(@"Requires targetViewController and segueIdentifier to be set");
    }
} 
```

最后，在托管所有这些的主视图控制器中，在“viewDidLoad”中，添加以下内容：

```
_fancyBarButtonItem.segueIdentifier = @"NewTransaction";
_fancyBarButtonItem.targetViewController = self; 
```

希望这可以帮助其他人在使用 Storyboards/iOS5 开始这条道路时节省时间

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2016-04-22T07:49:28.813

当您在**Storyboard**中设置 UIBarButtonItem 时，您必须在or方法中设置**tintColor**（将其放入 viewDidLoad() 对我不起作用......）：`viewWillAppear()``viewDidAppear()`

```
- (void)viewWillAppear {
    [super viewWillAppear];
    [[self editButtonItem] setTintColor:[UIColor redColor]];
} 
```

或者在 Swift 中：

```
override func viewWillAppear(animated: Bool) {
    super.viewWillAppear(animated)
    editButtonItem.tintColor = UIColor.redColor()
} 
```

**注意：在****iOS 8/9**上测试。

# c# - 用于查找抑制异常的工具？

> ID：664935
> 
> 赞同：3
> 
> 时间：2009-03-20T03:57:17.583
> 
> 标签：c#, .net, exception, exception-handling

我从事一个相当复杂的开源项目（[opensimulator.org](http://opensimulator.org/wiki/Main_Page)）。它目前大约有 300 KLOC 的 C#，并且在许多地方构建了代码来捕获和忽略异常，最终掩盖了细微的错误。

我想知道有哪些工具可以生成过于笼统的异常捕获报告，以及是否有可用的工具可以记录每个抛出的异常，无论它是否被抑制，以便稍后检查。

如果可以将这些工具引入我们的 CI 构建和测试脚本中，那将是理想的，以便可以制作每日报告，但这不是必需的。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-20T04:01:42.673

使用 FxCop 或 Visual Studio Team System Developer Edition 的代码分析功能。

此外，我发现 ReSharper 对此很有用。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-20T04:07:54.703

好吧，我同意[@John Saunders](https://stackoverflow.com/questions/664935/tools-to-use-to-find-supressed-exceptions/664942#664942)，但如果有很多代码，您可以编写一个简单的分析器或使用一些现有代码来用日志代码替换所有吞下的异常模式。很简单，比如替换：

```
catch(Exception ex)
{
} 
```

和：

```
catch(Exception ex)
{
    System.Diagnostics.Debug.WriteLine(ex.ToString());
} 
```

请注意，您还想检查 catch(Exception)，可能只使用一些正则表达式，这一点也不难。我明白，因为它有很多代码，你可能想要一种自动化的方式来获取基本的登录。将 Debug.WriteLine() 替换为您想要的任何内容。这有点粗略但简单。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-20T05:47:36.210

Visual Studio 已内置此功能，[请阅读如何启用它](http://jeremyjarrell.com/archive/2007/02/15/4.aspx "博客文章")。

# python - 如何在 Django 中改进这个“注册”视图？

> ID：664937
> 
> 赞同：3
> 
> 时间：2009-03-20T03:59:12.680
> 
> 标签：python, django, user-registration

我有一个基于 Django 的站点，允许用户注册（但需要管理员批准该帐户才能查看站点的某些部分）。我基于它`django.contrib.auth`。我要求用户使用来自某个域名的电子邮件地址进行注册，因此我覆盖了`UserCreationForm`'s`save()`和`clean_email()`方法。

我的注册页面使用以下视图。我有兴趣了解如何改进这个视图——代码改进或流程改进（或其他任何东西，真的）。

```
def register(request):
    if request.method == 'POST':
        form = UserCreationForm(request.POST)

        if form.is_valid():
            message = None

            form.save()

            username = form.cleaned_data['username']
            password = form.cleaned_data['password1']

            user = authenticate(username=username, password=password)

            first_name = form.cleaned_data['first_name']
            last_name = form.cleaned_data['last_name']
            email = user.email

            # If valid new user account
            if (user is not None) and (user.is_active):
                login(request, user)
                message = "<strong>Congratulations!</strong> You have been registered."

                # Send emails
                try:
                    # Admin email
                    pk = None
                    try: pk = User.objects.filter(username=username)[0].pk
                    except: pass

                    admin_email_template = loader.get_template('accounts/email_notify_admin_of_registration.txt')
                    admin_email_context = Context({
                        'first_name': first_name,
                        'last_name': last_name,
                        'username': username,
                        'email': email,
                        'pk': pk,
                    })
                    admin_email_body = admin_email_template.render(admin_email_context)
                    mail_admins("New User Registration", admin_email_body)

                    # User email
                    user_email_template = loader.get_template('accounts/email_registration_success.txt')
                    user_email_context = Context({
                        'first_name': form.cleaned_data['first_name'],
                        'username': username,
                        'password': password,
                    })
                    user_email_body = user_email_template.render(user_email_context)
                    user.email_user("Successfully Registered at example.com", user_email_body)
                except:
                    message = "There was an error sending you the confirmation email. You should still be able to login normally."
            else:
                message = "There was an error automatically logging you in. Try <a href=\"/login/\">logging in</a> manually."

            # Display success page
            return render_to_response('accounts/register_success.html', {
                    'username': username,
                    'message': message,
                },
                context_instance=RequestContext(request)
            )
    else: # If not POST
        form = UserCreationForm()

    return render_to_response('accounts/register.html', {
            'form': form,
        },
        context_instance=RequestContext(request)
    ) 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-20T06:16:29.463

你甚至不需要这段代码，但我认为风格：

```
pk = None
try: pk = User.objects.filter(username=username)[0].pk
except: pass 
```

更自然地写成：

```
try:
    user = User.objects.get(username=username)
except User.DoesNotExist:
    user = None 
```

然后在您的管理员通知模板中使用`{{ user.id }}`而不是`{{ pk }}`.

但是，就像我说的那样，您根本不需要该代码，因为您在调用`authenticate()`.

通常在 Python 中，将 try/except 块中的异常处理程序设为空是一种不好的做法。换句话说，总是捕获一个特定的异常，例如`User.DoesNotExist`这种情况。

`try`在 try/except 块的一部分内有很多行也是不好的做法。以这种方式编码是更好的形式：

```
try:
    ... a line of code that can generate exceptions to be handled ...
except SomeException:
    ... handle this particular exception ...
else:
    ... the rest of the code to execute if there were no exceptions ... 
```

最后的次要建议是不要直接在您的视图中发送电子邮件，因为如果您的网站开始看到大量的注册请求，这将无法扩展。最好在[django-mailer](http://code.google.com/p/django-mailer/)应用程序中添加以将工作卸载到由另一个进程处理的队列中。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-20T09:59:39.803

我个人尝试将 if-else 语句的短分支放在首位。特别是如果它返回。这是为了避免在难以看到什么结束的地方获得大分支。许多其他人确实像您所做的那样，并在 else 语句中发表评论。但是python并不总是有一个块语句的结尾——比如一个表单对你无效。

例如：

```
def register(request):
    if request.method != 'POST':
       form = UserCreationForm()
       return render_to_response('accounts/register.html', 
                                 { 'form': form, },
                                 context_instance=RequestContext(request)
                                 )

    form = UserCreationForm(request.POST)
    if not form.is_valid():
       return render_to_response('accounts/register.html', 
                                 { 'form': form, },
                                 context_instance=RequestContext(request)
                                 )
    ... 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-20T05:17:32.647

第一反应：它看起来比 95% 的“改进我的代码”问题要好得多。

你有什么特别不满意的地方吗？

# datagrid - 数据网格分页：无效的 CurrentPageIndex 值。它必须 >= 0

> ID：664940
> 
> 赞同：3
> 
> 时间：2009-03-20T04:01:19.117
> 
> 标签：datagrid, paging

我有一个启用分页的数据网格。我根据过滤条件在数据网格中显示结果。我已经过滤了数据，现在它有 2 页。当我转到第 2 页时。我正在再次执行搜索功能以缩小结果范围。然后我收到一个错误，例如“无效的 CurrentPageIndex 值。它必须 >= 0 并且 < PageCount+datagrid 分页”我确信第二次搜索只会产生比前一次更少的页数。如何解决这个问题？提前致谢

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-20T04:03:22.547

当您进行某些更改时，您需要重置到第 1 页。这包括过滤更改。几乎，每当您更改网格可能可用的行数时，请返回第 1 页。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-03-22T08:32:44.230

我有一个启用分页的数据网格。我根据过滤条件在数据网格中显示结果。我已经过滤了数据，现在它有 2 页。当我转到第 2 页并再次执行搜索功能以缩小结果范围时。然后我收到一个错误

> “无效的 CurrentPageIndex 值。它必须 >= 0 并且 < PageCount+datagrid 分页”

我确信第二次搜索只会产生比前一次更少的页数。如何解决这个问题呢 ？错误显示：

> 当前页面索引值。它必须 >= 0 并且 < PageCount。

我解决了问题

```
protected void btnSearchLibrary_Click(object sender, EventArgs e)
{
    if(!String.IsNullOrEmpty(txtSearchLibraryNo.Text.Trim()))
    oBookReceiptDTO.LibraryCardNo = txtSearchLibraryNo.Text.Trim();
    gvBooksReceiptList.CurrentPageIndex = 0;
    FillGridViewBookReceiptList(oBookReceiptDTO);
} 
```

注意：`gvBooksReceiptList.CurrentPageIndex = 0;`这是我用来解决问题的行。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2010-11-05T12:00:04.313

另一个建议是仅在 PageCount 已更改并导致 HttpException 时重置 CurrentPageIndex。代码片段基于 Les Smith 的[示例](http://www.knowdotnet.com/articles/invalidcurrentpageindex.html)。

```
 Try
        dataGrid1.DataBind()
    Catch
        ' We possibly don't have the correct PageCount.
        dataGrid1.CurrentPageIndex = 0
        dataGrid1.DataBind()
    End Try 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-20T21:15:38.987

您可以转到第一页或捕获异常并移至您喜欢的任何页面。如果您要从最后一页删除一条记录，您可能希望移至上一条记录。

```
 try
    {
       grid.DataSource = dao.PopulateGrid();
       grid.DataBind();
    }
     catch
    {
     if (grid.CurrentPageIndex >= grid.PageCount)
      {
        grid.CurrentPageIndex -= 1;
        grid.DataSource = dao.PopulateGrid();
        grid.DataBind();
      }
    } 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-08-28T09:48:44.347

就我而言，我所做的是每次在数据网格控件上加载的数据发生更改时，始终应用重置当前页面索引的行。

> DataGrid.CurrentPageIndex = 0
> 
> DataGrid.DataSource = 数据表/数据集
> 
> DataGrid.DataBind()

这是因为将数据源绑定到数据网格时引发的异常并非总是页数不一致。

# cocoa - 获取 NSBitmapImageRep 的像素大小？

> ID：664944
> 
> 赞同：2
> 
> 时间：2009-03-20T04:04:18.953
> 
> 标签：cocoa

获取 NSBitmapImageRep 的大小（宽度和高度）的最佳方法是什么？

这就是我现在正在做的事情：

```
NSBitmapImageRep *bitmap;

NSInteger samplesPerPixel = [bitmap samplesPerPixel];
NSInteger bytesPerPlane = [bitmap bytesPerPlane];
NSInteger bytesPerRow = [bitmap bytesPerRow];
NSInteger numberOfPlanes = [bitmap numberOfPlanes];

NSUInteger numPixels = numberOfPlanes * bytesPerPlane / samplesPerPixel;
NSUInteger width = bytesPerRow / samplesPerPixel;
NSUInteger height = numPixels / width; 
```

对于应该像 [bitmap getWidth] 一样简单的东西，似乎需要大量输入......

我在互联网上看到了一些这样查询大小的帖子（这不在文档中）：

```
NSSize imageSize = [bitmap size]; 
```

但是这些值似乎并不代表图像的像素尺寸（例如，我得到一个浮点值 122.869835 而不是 256，这是图像的实际像素宽度）。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-03-20T05:13:43.437

*   [`[rep pixelsWide]`](http://developer.apple.com/documentation/Cocoa/Reference/ApplicationKit/Classes/NSImageRep_Class/Reference/Reference.html#//apple_ref/occ/instm/NSImageRep/pixelsWide)
*   [`[rep pixelsHigh]`](http://developer.apple.com/documentation/Cocoa/Reference/ApplicationKit/Classes/NSImageRep_Class/Reference/Reference.html#//apple_ref/occ/instm/NSImageRep/pixelsHigh)

# xcode - Xcode pbxstrings 文件有什么用？

> ID：664947
> 
> 赞同：3
> 
> 时间：2009-03-20T04:06:01.337
> 
> 标签：xcode, macos

我有一个 Xcode 项目，需要更改它构建的产品的名称。我用细齿梳子浏览了项目文件，并认为我已经使所有更改成为可能。最后一步是 grep 项目文件夹中的所有文件以查找旧名称的出现。它干净。

但是在构建之后 grep 找到一个包含多次出现旧名称的文件。它位于以下位置：MyProjectFolder/build/MyProject.build/MyProject.pbxindex/strings.pbxstrings/strings

我无法想象它的旧名称是从哪里来的。另外，我不知道这个文件是做什么用的。但我担心显然我还没有在所有地方清除旧名称。

谁能告诉我 ...pbxstrings/strings 文件的用途以及它是如何构建的？如果我明白了，我可能可以追踪旧名称的最后残余并清除它们。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-20T04:16:01.097

MyProject.pbxindex 仅用于 CodeSense。:) 关闭 Xcode 并删除 MyProject.pbxindex 目录（如果您持怀疑态度，请复制一份），然后重新打开 Xcode。它将重建它。

如果您愿意，可以从命令行执行此操作：

xcodeindex -project /path/to/your/project clean build

不过我只会做第一个。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-20T16:25:25.087

单击项目检查器的常规窗格中的“重建 CodeSense 索引”按钮可能比发出执行相同操作的命令行命令更容易。

索引器不会立即清除已删除条目的索引条目，但这不会影响您的构建。

# macos - OS X 上 iTunes API 的文档在哪里？

> ID：664949
> 
> 赞同：12
> 
> 时间：2009-03-20T04:07:32.097
> 
> 标签：macos, itunes

我正在尝试找到一个 API 来控制 OS X 上的 iTunes。我发现了以下内容：

[http://developer.apple.com/sdk/itunescomsdk.html](http://developer.apple.com/sdk/itunescomsdk.html)

我想在 OS X 上，我需要的是内置的，但我不知道 API 记录在哪里？

提前感谢您的帮助。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-03-20T04:24:46.223

如果您使用的是 Cocoa，那么我会推荐（非苹果）框架[EyeTunes](http://www.liquidx.net/eyetunes/)。

Applescript 可能是您最好的选择，无论是通过直接调用脚本还是可用于[Ruby、Python](http://developer.apple.com/documentation/Cocoa/Conceptual/RubyPythonCocoa/Articles/UsingScriptingBridge.html)和[Objective C](http://developer.apple.com/documentation/Cocoa/Conceptual/ScriptingBridgeConcepts/Introduction/Introduction.html)的 ScriptingBridge 框架。

有关文档，请查看 iTunes 脚本字典（将 iTunes 图标拖到脚本编辑器图标上）。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-03-20T04:15:46.713

AFAIK，Windows 只有一个 SDK（通过 COM）。

在 Mac OS 中，iTunes 是通过 AppleScript 控制的。

有很多教程在运行，但我对任何官方都不熟悉。事实上，我上次查看时，他们提供了第三方的链接。

例如，[教程](http://dougscripts.com/itunes/itinfo/info01.php)

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-06-26T00:30:38.200

如果您正在寻找 OSX applescript 接口的 API 规范，请运行 AppleScript Editor（OSX 附带）并选择 File->Open Dictionary 并从列表中选择 iTunes。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-06-30T13:05:13.197

还有[Karelia 的 iMedia 浏览器](http://www.karelia.com/imedia/)。在 BSD 风格的许可下可用的[源代码。](https://github.com/karelia/imedia)

# perl - 如何将 Perl 代码从 mod_perl 移植到 FastCGI？

> ID：664951
> 
> 赞同：5
> 
> 时间：2009-03-20T04:07:45.093
> 
> 标签：perl, fastcgi, mod-perl

我们有一个现有的 Perl 应用程序，它支持`mod_perl`. 但是，我们的新主机（Dreamhost）不支持 mod_perl，只支持 FastCGI；因此需要港口。

现有代码不使用任何 Apache 特定的东西，只是普通的 Perl 代码，以`mod_perl`.

阅读文档和在线教程，似乎添加 FastCGI 支持涉及将现有代码包装在特定类型的循环中。以下是最常见的骨架代码：

**A. 使用 FCGI**

```
use FCGI;
while (FCGI::accept >= 0)
{
    #Run existing code.
} 
```

**B. 使用 CGI::Fast**

```
use CGI::Fast
while (my $cgi = CGI::Fast->new()) 
{  
   #Run existing code.
} 
```

**子问题：**

1.  方法**A**和**B**是添加 FastCGI 支持的等效方法吗？
2.  如果**A**和**B**不同，那么使用其中一个的优缺点是什么？
3.  `mod_perl`从FastCGI移植时，是否有任何最佳实践或陷阱？

谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-20T04:34:09.180

一般而言，FastCGI 应用程序与 CGI 非常相似。主要区别在于您可以利用您的流程能够持久这一事实。您可以利用它在应用程序中获得速度优势——例如，您可以在正在运行的进程中缓存数据库数据。本质上，您将应用程序更改为它自己的应用程序服务器，在 Web 服务器提供的 FastCGI 网关后面运行。

这个想法是弄清楚如何使您的应用程序的处理方式适用于 FastCGI 网关。您是否使用任何 mod-perl 特定功能？如果是这样，请远离它。如果没有，那么就开始通过 FastCGI 进行对话。您的优势在于有可用于 Perl 的 FastCGI 接口。我假设您正在使用某种版本控制系统，所以只需创建一个用于移植到 FastCGI 的分支。然后，开始将 POST 和 PUT 视为从标准输入读取，将应用程序的响应视为写入标准输出。

您可能还想通读一个为应用程序实现 FastCGI 接口的库。[您可以在fastcgi.com](http://www.fastcgi.com/)上找到其中的一些。这可能有助于您了解与当前正在执行的操作相比，您的应用程序将以不同方式执行的操作。

祝你好运！

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-20T05:32:20.100

通过快速查看 CPAN 文档，看起来 CGI::Fast 是 FCGI 的包装器；来自 CGI::Fast 页面：

> 为了使用 CGI::Fast 你需要 FCGI 模块

我的看法是，它基本上让您可以使用 CGI.pm 的标准功能和 FastCGI 的速度优势（标题创建和参数访问是您可能已经在使用的 CGI.pm 的主要方面）。

我没有使用过这两种方法，这就是我从文档中看到的样子，所以我很可能是错的。

# drupal - Drupal, or Joomla Form Builder

> ID：664954
> 
> 赞同：2
> 
> 时间：2009-03-20T04:08:47.073
> 
> 标签：drupal, content-management-system, joomla1.5

I am evaluating Drupal and Joomla, and one of the requirements I have is how well supported it is when comes to Form Building, storing the information in the database, and the showing of those information upon query.

I don't know which one is better in this regard, Drupal or Joomla? Is there any third party extension I have to install for this purpose?

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-20T04:16:13.153

Drupal has the [Content Construction Kit](http://drupal.org/project/cck) module, commonly known in the community as CCK. Combining the functionality of CCK with the [Views](http://drupal.org/project/views) module is a common way of getting the functionality you're after.

The terminology involved with this in the Drupal world might take some getting used to but there is plenty of documentation around. A quick [Google search on the terms: drupal cck views](http://www.google.co.nz/search?q=drupal+cck+views) reveals a ton of useful results.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-20T04:24:39.187

CCK 允许您在 Drupal 节点中定义任意字段。这些字段中的每一个都配置有特定的类型和输入小部件（选择框、文本字段、复选框等）以及权重（从上到下的呈现顺序）。还有诸如默认值、帮助文本、文本和标签位置之类的东西——几乎所有你需要的东西。

如果这不是 enuf，Drupal 还包括大量的钩子函数，包括 form_alter() ，连同一些精心设计的页面/节点模板和 CSS 样式，几乎可以让您更改几乎任何关于外观的节点的介绍。您列出的所有其他内容 - 存储和检索表单值几乎都是免费为您处理的，这是任何 CMS 所期望的。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-22T13:41:00.930

Drupal 有一个 Forms API，您可以通过它构建表单、更改现有表单甚至创建新的小部件。它的设计比 Joomla 的更强大。

*   [表单 API 快速入门指南](http://api.drupal.org/api/file/developer/topics/forms_api_reference.html/6)
*   [表单 API 参考](http://api.drupal.org/api/file/developer/topics/forms_api.html/6)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-20T20:33:08.787

对于 Joomla 看看[http://www.joomla-forms.com](http://www.joomla-forms.com) :-)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-10T15:19:11.877

Joomla 有几个类似 CCK 的扩展，其中一些是在过去两个月内发布的：[k2](http://k2.joomlaworks.gr/)和[zoo](http://zoo.yootheme.com/)。[Fabrik](http://fabrikar.com/)也值得一提。

您可能可以使用它们中的任何一个来做您需要的事情。

如果您想建立一个房地产或分类广告网站，[JED](http://extensions.joomla.org/)中的所有内容都有适当的扩展名。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-06-11T10:55:52.430

作为新手开发人员，您可以通过查看[joomla-builder.com](http://joomla-builder.com)和[lhttp://drupal-builder.net](http://drupal-builder.net)来估计两者。两者都是在线网站建设者，并包含最流行的模块列表。

在 Joomla 中，您可以使用[ChronoForms](http://extensions.joomla.org/extensions/1508/details) ChronoForms 构建自定义表单。要构建房地产页面，您可以使用[HotProperty](http://extensions.joomla.org/extensions/vertical-markets/real-estate/232/details)组件。还可以查看[EZRealty](http://extensions.joomla.org/extensions/vertical-markets/real-estate/614/details) - 也很受欢迎。

在 Drupal 中，您可以一起使用一些更通用和抽象的模块来实现您所需要的。一般来说，这些模块是 CCK 和 Views。

此外，有些人在 CodeCharge Studio 中生成非常[CodeCharge Studio](http://yessoftware.com)定制的数据库驱动页面，然后将它们作为单独的页面或作为内联页面集成到 Joomla 或 Drupal 中。

# asp.net-mvc - 如何在 ASP.NET MVC 中设置通用控制器？

> ID：664955
> 
> 赞同：0
> 
> 时间：2009-03-20T04:10:25.353
> 
> 标签：asp.net-mvc, routing, asp.net-mvc-routing, maproute

我知道这可能不是 MVC 的真正精神，但我只想拥有一个全局控制器，无论 url 看起来如何，它总是被*调用*。例如，它可能是：

[http://myserver.com/anything/at/all/here.fun?happy=yes&sad=no#yippie](http://myserver.com/anything/at/all/here.fun?happy=yes&sad=no#yippie)

...并且我希望将其传递给我的单个控制器。我打算以编程方式获取路径并自己处理它——换句话说，我根本不想要任何路由。

我打开了 global.asax 文件并找到了路由注册的位置，但我只是不知道在 MapRoute 中为 'url' 参数放置什么：

```
routes.MapRoute( "Global", "", new { controller = "Global", action = "Index" } ); 
```

*这（带有空白的“url”）适用于“/”的默认路径，但是如果我将其更改为任何内容，当我希望它处理任何*url时，我会找不到文件。我也试过“*”等，但没有奏效。

我找不到对 url 参数采用的格式的任何明确参考。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-20T09:57:35.237

怎么样：

```
routes.MapRoute("Global", "{*url}", new { controller = "Global", action = "Index" } ); 
```

从[这个](https://stackoverflow.com/questions/19941/aspnet-mvc-catch-exception-when-non-existant-controller-is-requested)问题

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-20T04:16:04.183

你没有删除默认有吗？你需要保留那个。也许尝试：

```
routes.MapRoute("Global", "/", new { controller = "Global", action = "Index" }); 
```

# batch-file - 我可以屏蔽 bat 文件中的输入文本吗？

> ID：664957
> 
> 赞同：103
> 
> 时间：2009-03-20T04:14:00.100
> 
> 标签：batch-file, cmd, command-prompt

我正在编写一个批处理文件来执行一些其他程序。在这种情况下，我需要提示输入密码。我有什么方法可以屏蔽输入文本吗？我不需要打印 ******* 字符而不是输入字符。Linux 的密码提示行为（键入时不打印）就足够了。

```
@echo off
SET /P variable=Password : 
echo %variable%
Pause 
```

这将读取输入，但我无法使用这种方法屏蔽文本。

* * *

## 回答 #1

> 赞同：166
> 
> 时间：2013-12-03T04:46:43.303

是的 - 我晚了 4 年。

但是我找到了一种无需创建外部脚本即可在一行中完成此操作的方法；通过从批处理文件中调用 powershell 命令。

感谢 TessellatingHeckler - 无需输出到文本文件（我将 powershell 命令设置在一个变量中，因为它在 for 循环内的一长行中非常混乱）。

```
@echo off
set "psCommand=powershell -Command "$pword = read-host 'Enter Password' -AsSecureString ; ^
    $BSTR=[System.Runtime.InteropServices.Marshal]::SecureStringToBSTR($pword); ^
        [System.Runtime.InteropServices.Marshal]::PtrToStringAuto($BSTR)""
for /f "usebackq delims=" %%p in (`%psCommand%`) do set password=%%p
echo %password% 
```

最初我把它写成输出到一个文本文件，然后从那个文本文件中读取。但是上面的方法更好。在一条非常长，几乎难以理解的行中：

```
@echo off
powershell -Command $pword = read-host "Enter password" -AsSecureString ; $BSTR=[System.Runtime.InteropServices.Marshal]::SecureStringToBSTR($pword) ; [System.Runtime.InteropServices.Marshal]::PtrToStringAuto($BSTR) > .tmp.txt & set /p password=<.tmp.txt & del .tmp.txt
echo %password% 
```

我将把它分解 - 你可以使用 caret 将它分成几行`^`，这更好......

```
@echo off
powershell -Command $pword = read-host "Enter password" -AsSecureString ; ^
    $BSTR=[System.Runtime.InteropServices.Marshal]::SecureStringToBSTR($pword) ; ^
        [System.Runtime.InteropServices.Marshal]::PtrToStringAuto($BSTR) > .tmp.txt 
set /p password=<.tmp.txt & del .tmp.txt
echo %password% 
```

[本文](http://social.technet.microsoft.com/wiki/contents/articles/4546.working-with-passwords-secure-strings-and-credentials-in-windows-powershell.aspx)解释了 powershell 命令的作用；本质上它使用输入`Read-Host -AsSecureString`- 以下两行将该安全字符串转换回纯文本，然后将输出（纯文本密码）发送到使用`>.tmp.txt`. 然后将该文件读入变量并删除。

* * *

## 回答 #2

> 赞同：51
> 
> 时间：2009-03-20T06:40:11.297

在 XP 和 Server 2003 之前，您可以使用另一个包含的工具 (VBScript) - 以下两个脚本可以完成您想要的工作。

首先，`getpwd.cmd`：

```
@echo off
<nul: set /p passwd=Password: 
for /f "delims=" %%i in ('cscript /nologo getpwd.vbs') do set passwd=%%i
echo. 
```

然后，`getpwd.vbs`：

```
Set oScriptPW = CreateObject("ScriptPW.Password")
strPassword = oScriptPW.GetPassword()
Wscript.StdOut.WriteLine strPassword 
```

简单地使用密码对象从用户那里输入密码，然后将`getpwd.vbs`其打印到标准输出（下一段将解释为什么它不会显示在终端中）。

`getpwd.cmd`命令脚本有点棘手，但它基本上按如下方式工作。

该`"<nul: set /p passwd=Password: "`命令的效果是输出没有尾随换行符的提示 - 这是 从shell模拟`"echo -n"`命令的一种偷偷摸摸的方式。`bash`它设置`passwd`为一个空字符串作为不相关的副作用，并且不等待输入，因为它从`nul:`设备获取输入。

该`"for /f "delims=" %%i in ('cscript /nologo getpwd.vbs') do set passwd=%%i"`声明是最棘手的部分。它运行没有微软“广告”的 VBScript，因此唯一的行输出是密码（来自 VBscript `"Wscript.StdOut.WriteLine strPassword"`.

将分隔符设置为空需要捕获带有空格的整个输入行，否则您只会得到第一个单词。该`"for ... do set ..."`位设置`passwd`为从 VBScript 输出的实际密码。

然后我们回显一个空行（以终止该`"Password: "`行），并且在代码运行后密码将在`passwd`环境变量中。

* * *

现在，如前所述，`scriptpw.dll`仅在 XP/2003 之前可用。为了解决这个问题，您可以简单地将`scriptpw.dll`文件从`Windows\System32`XP/2003 系统的文件夹中复制到您自己系统上的`Winnt\System32`or文件夹中。`Windows\System32`复制 DLL 后，您需要通过运行以下命令来注册它：

```
regsvr32 scriptpw.dll 
```

要在 Vista 及更高版本上成功注册 DLL，您将需要管理员权限。我还没有检查过这种举动的合法性，所以洞穴讲师。

* * *

如果您不太*热衷*于尝试追踪和注册较旧的 DLL 文件（出于方便或法律原因），还有另一种方法。更高版本的 Windows（*没有*所需 DLL 的版本）应该有 Powershell 可供您使用。

而且，事实上，您确实应该考虑升级您的脚本以充分使用它，因为它是一种比`cmd.exe`. 但是，如果您想将大部分代码保留为`cmd.exe`脚本（例如，如果您有*很多*不想转换的代码），您可以使用相同的技巧。

首先，修改`cmd`脚本，使其调用 Powershell 而不是 CScript：

```
@echo off
for /f "delims=" %%i in ('powershell -file getpwd.ps1') do set passwd=%%i 
```

Powershell 脚本同样简单：

```
$password = Read-Host "Enter password" -AsSecureString
$password = [Runtime.InteropServices.Marshal]::SecureStringToBSTR($password)
$password = [Runtime.InteropServices.Marshal]::PtrToStringAuto($password)
echo $password 
```

尽管进行了一些编组以获取实际的密码文本。

请记住，要在您的计算机上运行本地未签名的 Powershell 脚本，您可能需要从（严厉，但非常安全）默认值修改执行策略，例如：

```
set-executionpolicy remotesigned 
```

来自 Powershell 本身。

* * *

## 回答 #3

> 赞同：26
> 
> 时间：2014-06-24T20:58:32.437

**1.纯批处理解决方案**，（ab）使用`XCOPY`命令及其在[此处](https://groups.google.com/forum/#!topic/alt.msdos.batch.nt/f7mb_f99lYI)`/P /L`找到的开关（可以[在此处](http://www.dostips.com/forum/viewtopic.php?f=3&t=4664&start=15)找到一些改进）：

```
:: Hidden.cmd
::Tom Lavedas, 02/05/2013, 02/20/2013
::Carlos, 02/22/2013
::https://groups.google.com/forum/#!topic/alt.msdos.batch.nt/f7mb_f99lYI

@Echo Off
:HInput
SetLocal EnableExtensions EnableDelayedExpansion
Set "FILE=%Temp%.\T"
Set "FILE=.\T"
Keys List >"%File%"
Set /P "=Hidden text ending with Ctrl-C?: " <Nul
Echo.
Set "HInput="
:HInput_
For /F "tokens=1* delims=?" %%A In (
 '"Xcopy /P /L "%FILE%" "%FILE%" 2>Nul"'
) Do (
  Set "Text=%%B"
  If Defined Text (
    Set "Char=!Text:~1,1!"
    Set "Intro=1"
    For /F delims^=^ eol^= %%Z in ("!Char!") Do Set "Intro=0"
    Rem If press Intro
    If 1 Equ !Intro! Goto :HInput#
    Set "HInput=!HInput!!Char!"
  )
)
Goto :HInput_
:HInput#
Echo(!HInput!
Goto :Eof 
```

**1.2[基于replace命令的另一种方式](http://www.dostips.com/forum/viewtopic.php?f=3&t=6382)**

```
@Echo Off
SetLocal EnableExtensions EnableDelayedExpansion

Set /P "=Enter a Password:" < Nul
Call :PasswordInput
Echo(Your input was:!Line!

Goto :Eof

:PasswordInput
::Author: Carlos Montiers Aguilera
::Last updated: 20150401\. Created: 20150401.
::Set in variable Line a input password
For /F skip^=1^ delims^=^ eol^= %%# in (
'"Echo(|Replace.exe "%~f0" . /U /W"') Do Set "CR=%%#"
For /F %%# In (
'"Prompt $H &For %%_ In (_) Do Rem"') Do Set "BS=%%#"
Set "Line="
:_PasswordInput_Kbd
Set "CHR=" & For /F skip^=1^ delims^=^ eol^= %%# in (
'Replace.exe "%~f0" . /U /W') Do Set "CHR=%%#"
If !CHR!==!CR! Echo(&Goto :Eof
If !CHR!==!BS! (If Defined Line (Set /P "=!BS! !BS!" <Nul
Set "Line=!Line:~0,-1!"
)
) Else (Set /P "=*" <Nul
If !CHR!==! (Set "Line=!Line!^!"
) Else Set "Line=!Line!!CHR!"
)
Goto :_PasswordInput_Kbd 
```

**2.使用HTA弹窗的密码提交者** 。[这是一个混合 .bat/jscript/mshta](http://www.dostips.com/forum/viewtopic.php?f=3&t=5543)文件，应保存为[.bat](https://github.com/npocmaka/batch.scripts/blob/master/hybrids/mshta/ui.extensions/passwordSubmiter.bat)：

```
<!-- :
:: PasswordSubmitter.bat
@echo off
for /f "tokens=* delims=" %%p in ('mshta.exe "%~f0"') do (
    set "pass=%%p"
)

echo your password is %pass%
exit /b
-->

<html>
<head><title>Password submitter</title></head>
<body>

    <script language='javascript' >
        window.resizeTo(300,150);
        function entperPressed(e){
                if (e.keyCode == 13) {
                    pipePass();
                }
        }
        function pipePass() {
            var pass=document.getElementById('pass').value;
            var fso= new ActiveXObject('Scripting.FileSystemObject').GetStandardStream(1);
            close(fso.Write(pass));

        }
    </script>

    <input type='password' name='pass' size='15' onkeypress="return entperPressed(event)" ></input>
    <hr>
    <button onclick='pipePass()'>Submit</button>

</body>
</html> 
```

**3.[自编译的 .net 混合](http://www.dostips.com/forum/viewtopic.php?f=3&t=5260)**.Again 应另存为[`.bat`](https://github.com/npocmaka/batch.scripts/blob/master/hybrids/.net/passHidder.bat)。与其他解决方案不同，它将创建/编译一个小的 .exe 文件，该文件将被调用（如果您希望可以删除它）。还需要安装 .net 框架，但这不是问题：

```
@if (@X)==(@Y) @end /* JScript comment
@echo off
setlocal enableDelayedExpansion

for /f "tokens=* delims=" %%v in ('dir /b /s /a:-d  /o:-n "%SystemRoot%\Microsoft.NET\Framework\*jsc.exe"') do (
   set "jsc=%%v"
)

if not exist "%~n0.exe" (
    "%jsc%" /nologo /out:"%~n0.exe" "%~dpsfnx0"
)

for /f "tokens=* delims=" %%p in ('"%~n0.exe"') do (
    set "pass=%%p"
)

echo your password is !pass!

endlocal & exit /b %errorlevel%

*/

import System;

var pwd = "";
var key;

Console.Error.Write("Enter password: ");

        do {
           key = Console.ReadKey(true);

           if ( (key.KeyChar.ToString().charCodeAt(0)) >= 20 && (key.KeyChar.ToString().charCodeAt(0) <= 126) ) {
              pwd=pwd+(key.KeyChar.ToString());
              Console.Error.Write("*");
           }

           if ( key.Key == ConsoleKey.Backspace && pwd.Length > 0 ) {
               pwd=pwd.Remove(pwd.Length-1);
               Console.Error.Write("\b \b");
           }

        } while (key.Key != ConsoleKey.Enter);
        Console.Error.WriteLine();
        Console.WriteLine(pwd); 
```

* * *

## 回答 #4

> 赞同：17
> 
> 时间：2009-03-20T05:48:11.373

我可能会这样做：

```
..
echo Before you enter your password, make sure no-one is looking!
set /P password=Password:  
cls
echo Thanks, got that.
.. 
```

所以你得到一个提示，然后屏幕在输入后清除。

请注意，如果从命令提示符处执行批处理文件，输入的密码将存储在 CMD 历史记录中（感谢[@Mark K Cowan](https://stackoverflow.com/questions/664957/can-i-mask-an-input-text-in-a-bat-file/665107?noredirect=1#comment38302913_665107)）。

如果这还不够好，我会切换到 python，或者编写一个可执行文件而不是脚本。

我知道这些都不是完美的解决方案，但也许一个对你来说已经足够了:)

* * *

## 回答 #5

> 赞同：13
> 
> 时间：2014-07-16T22:43:53.943

您可以将 ReadFormattedLine 子例程用于所有类型的格式化输入。例如，下面的命令读取 8 个字符的密码，在屏幕上显示星号，无需按 Enter 即可自动继续：

```
call :ReadFormattedLine password="********" /M "Enter password (8 chars): " 
```

这个子程序是用纯 Batch 编写的，所以它不需要任何额外的程序，并且它允许多种格式化输入操作，例如读取数字，将字母转换为大写等。您可以从 ReadFormattedLine 子程序下载[Read a line with specific format](http://www.dostips.com/forum/viewtopic.php?f=3&t=5775)。

* * *

**编辑 2018-08-18**：*输入“隐形”密码的新方法*

FINDSTR 命令有一个奇怪的错误，当该命令用于显示彩色字符并且此类命令的输出被重定向到 CON 设备时会发生这种错误。有关如何使用 FINDSTR 命令以彩色显示文本的详细信息，请参阅[此主题](https://stackoverflow.com/questions/4339649/how-to-have-multiple-colors-in-a-windows-batch-file#5344911)。

当这种形式的 FINDSTR 命令的输出被重定向到 CON 时，在以所需颜色输出文本后发生了一些奇怪的事情：它之后的所有文本都作为“不可见”字符输出，尽管更准确的描述是文本是输出为黑色背景上的黑色文本。如果您使用 COLOR 命令重置整个屏幕的前景色和背景色，则会出现原始文本。但是，当文本“不可见”时，我们可以执行 SET /P 命令，因此输入的所有字符都不会出现在屏幕上。

```
@echo off
setlocal

set /P "=_" < NUL > "Enter password"
findstr /A:1E /V "^$" "Enter password" NUL > CON
del "Enter password"
set /P "password="
cls
color 07
echo The password read is: "%password%" 
```

* * *

## 回答 #6

> 赞同：6
> 
> 时间：2009-05-27T18:01:42.803

另一种选择是我的 EditV32 (x86) 或 EditV64 (x64) 命令行工具。例如：

```
editv32 -m -p "Password: " PWD 
```

-m 表示“屏蔽输入”，-p 是提示符。用户的输入存储在 PWD 环境变量中。你可以在这里得到它：

[https://westmesatech.com/?page_id=19](https://westmesatech.com/?page_id=19)

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2014-05-17T02:56:48.360

如果缺少源代码困扰您，我还有另一种选择。

```
@echo off
for /f "delims=" %%p in ('ReadLine -h -p "Enter password: "') do set PWD=%%p
echo You entered: %PWD% 
```

您可以从[https://westmesatech.com/?page_id=49](https://westmesatech.com/?page_id=49)获取。源代码包括在内。

* * *

## 回答 #8

> 赞同：4
> 
> 时间：2015-09-14T14:03:42.190

如果你安装了 Python，你可以使用：

```
for /f "delims=" %%A in ('python -c "import getpass; print(getpass.getpass('Enter the CVS password: '));"') do @set CVSPASS=%%A
echo PASS: %CVSPASS% 
```

输出：

```
Enter the CVS password:
PASS: 123 
```

* * *

## 回答 #9

> 赞同：4
> 
> 时间：2020-09-11T12:27:15.820

您可以将前景色设置为黑色，例如：

```
:: see https://stackoverflow.com/questions/33293220/what-is-the-fastest-color-function-in-batch
@echo off
for /F %%a in ('echo prompt $E ^| cmd') do set "ESC=%%a"
set color_white=%ESC%[37m
set color_black=%ESC%[30m
echo(
set /p user=Username:
set /p pass=password:%color_black%
echo %color_white%
echo blablablba 
```

享受！！！C。

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2012-04-12T14:08:13.597

我使用了 Blorgbeard 的上述解决方案，我认为这实际上很棒。然后我将其增强如下：

1.  Google for **ansicon**
2.  下载 zip 文件和示例文本文件。
3.  安装（这意味着将 2 个文件复制到 system32 中）

像这样使用它：

```
@echo off
ansicon -p
set /p pwd=Password:ESC[0;37;47m
echo ESC[0m 
```

这会将控制台切换为灰色以供您输入密码，并在您完成后切换回来。ESC 实际上应该是一个不可打印的字符，您可以将其从下载的示例文本文件（在记事本中显示为左箭头）复制到您的批处理文件中。您可以使用示例文本文件查找所有颜色组合的代码。

如果您不是机器的管理员，您可能能够将文件安装在非系统目录中，那么您必须在调用程序和使用转义序列之前将该目录附加到脚本中的 PATH 中。如果您需要一个仅包含几个文件的非管理员可分发包，这甚至可能是当前目录。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2013-02-10T06:40:25.973

制作一个调用不可见字符所需的批处理文件，然后为正在调用的批处理文件创建一个快捷方式。

右键点击

特性

颜色

文字==黑色

背景 == 黑色

申请

行

希望对你有帮助！！！！！！！！！

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2014-07-18T18:54:30.593

**更新：**
我添加了两个新方法，它们不是利用 cls 来隐藏输入，而是创建一个仅包含一行的新弹出窗口。

缺点是一种方法（方法 2）会在注册表中留下垃圾 - “如果在没有适当权限的情况下运行”，而另一种（方法三）会在脚本中附加一些垃圾。不用说它可以很容易地写入任何 tmp 文件并删除我只是想提出一个替代方案。

**限制：**密码只能是字母数字 - 不能是其他字符！

```
@echo off
if "%1"=="method%choice%" goto :method%choice%
::::::::::::::::::
::Your code here::
::::::::::::::::::
cls
echo :::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::
echo ::::                   Batch script to prompt for password!                 :::
echo :::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::
:choice
echo.
echo 1\. First method
echo.
echo 2\. Second method
echo.
echo 3\. Third method
echo.
set/p choice=Choose a method: 
if "%choice%" gtr "3" echo. & echo invalid option & echo. & pause & goto choice

call :vars
    set options= %num%%smAlph%%cpAlph%
    set pwdLen=6

if "%choice%" == "1" (
    set /p=Password: <nul 
    for /l %%i in (1,1,%pwdLen%) do call :password
) else (
    start /wait cmd /c call "%~f0" method%choice%
    )

call :result%choice%

::just to see if it worked!
echo.
echo The Password you entered is: "%pwd%"&pause>nul

::::::::::::::::::
::More code here::
::::::::::::::::::
exit /b

:vars
set num=1234567890
set smAlph=abcdefghijklmnopqrstuvwxyz
set cpAlph=ABCDEFGHIJKLMNOPQRSTUVWXYZ
    set pwd=
goto :EOF

:method2
call :popUp
setx result %pwd% >nul
goto :EOF

:method3
call :popUp
    >> "%~f0" echo.
    >> "%~f0" echo :result%choice%
    >> "%~f0" echo set pwd=%pwd%
goto :EOF

:popUp
title Password
mode con lines=1 cols=30
color 5a
set /p=Password: <nul
for /l %%i in (1,1,%pwdLen%) do call :password
goto :EOF

:password
:: If you don't want case sensative remove "/cs" but remember to remove %cpAlph% from the %options%
choice /c %options% /n /cs >nul
    call SET pwd=%pwd%%%options:~%errorlevel%,1%%
    set /p =*<nul
GOTO :EOF

:result2
for /f "tokens=3" %%a in ('reg query hkcu\environment /v result') do set pwd=%%a
    setx result "" >nul
    reg delete hkcu\environment /v result /f >nul 2>&1
:result1
goto :EOF   
::You can delete from here whenever you want. 
```

**更新：** 我发现[sachadee 的帖子非常完美](https://stackoverflow.com/questions/22893172/how-can-i-mask-input-by-using-batch-file-without-extra-file/)，我只是在其中添加了我的“弹出式”怪癖。

```
@Echo Off  
  SetLocal EnableDelayedExpansion
  if "%1"==":HInput" goto :HInput
  set r=r%random%
  start /wait cmd /c call "%~f0" :HInput

For /f "tokens=2,13 delims=, " %%a in (
    'tasklist /v /fo csv /fi "imagename eq cmd.exe"
    ^|findstr /v "Windows\\system32\\cmd.exe"
    ^|findstr "set /p=%r%"'
     ) do (
        set pid=%%a
        set Line=%%b
        set Line=!Line:%r%=!
        set Line=!Line:~,-2!
        )       
taskkill /pid %pid:"=%>nul
  goto :HIEnd

  :HInput
  SetLocal DisableDelayedExpansion
  title Password
  mode con lines=2 cols=30

Echo Enter your Code :
   Set "Line="
   For /F %%# In (
   '"Prompt;$H&For %%# in (1) Do Rem"'
   ) Do Set "BS=%%#"

  :HILoop
   Set "Key="
   For /F "delims=" %%# In (
   'Xcopy /W "%~f0" "%~f0" 2^>Nul'
   ) Do If Not Defined Key Set "Key=%%#"
   Set "Key=%Key:~-1%"
   SetLocal EnableDelayedExpansion
   If Not Defined Key start /min cmd /k mode con lines=1 cols=14 ^&set/p %r%!Line!=&exit
  If %BS%==^%Key% (Set /P "=%BS% %BS%" <Nul
   Set "Key="
   If Defined Line Set "Line=!Line:~0,-1!"
   ) Else Set /P "=*" <Nul
   If Not Defined Line (EndLocal &Set "Line=%Key%"
   ) Else For /F delims^=^ eol^= %%# In (
   "!Line!") Do EndLocal &Set "Line=%%#%Key%"
  Goto :HILoop

  :HIEnd
   Echo(
Echo Your code is :  "!Line!"
   Pause
   Goto :Eof 
```

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2020-07-16T15:57:37.290

我编写了一个名为的开源程序`editenv`来替换我的旧`editv32`/`editv64`实用程序：

[https://github.com/Bill-Stewart/editenv](https://github.com/Bill-Stewart/editenv)

( ) 选项[*] 允许您隐藏`--maskinput`（`-m`屏蔽）键入的输入，并具有可配置的字符（默认字符为`*`）；例如：

```
editenv -m -p "Password: " PWD 
```

( `--prompt`)`-p`选项允许您指定输入提示。上面会显示一个`Password:`提示，等待你输入一些东西。键入的字符将显示为`*`。按`Ctrl`+`C`将结束程序，退出代码为 1223。

下载地址在这里：

[https://github.com/Bill-Stewart/editenv/releases](https://github.com/Bill-Stewart/editenv/releases)

[*] 注意`--maskinput`( `-m`) 选项**不安全**——输入的字符串在环境中以纯文本形式输入。此功能仅为方便起见。

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2021-02-26T11:26:55.920

好的，所以我刚刚找到了一个非常体面的工作来解决这个问题。CMDKEY 适用于 Windows 7+ 并允许您从 cmd 提示符将详细信息输入到 Windows 凭据管理器中，如果您使用 /pass 开关，它会提供自己的密码条目而不会暴露密码。它不会在您键入时显示 *****，但密码是隐藏的。

下面的脚本正常请求用户名并创建一个名为“%username%”的变量，然后检查凭据管理器是否已经有目标服务器的条目。如果是这样，它只是将驱动器映射到用户名并且不请求密码。如果没有条目，则使用 CMDKEY 提示输入密码并将其存储在凭据管理器中。

```
 set /p username="Enter School Username: "
    CMDKEY /list:SERVERNAME | FIND "NONE" > nul 2>&1
    IF %ERRORLEVEL% NEQ 0 GOTO MAPDRIVES
    CMDKEY /ADD:SERVERNAME /username:%username% /pass
    :MAPDRIVES
    NET USE Y: \\SERVERNAME\SHARE\%username% 
```

* * *

## 回答 #15

> 赞同：1
> 
> 时间：2021-10-12T09:45:34.083

不幸的是，我无法得到[@unclemeat](https://stackoverflow.com/users/2844742/unclemeat)在 Windows 10 21H1 系统上工作的答案。我刚得到：`[System.Runtime.InteropServices.Marshal]::PtrToStringAuto($BSTR)"" was unexpected at this time.`

但他让我走上了正轨。

所以这是我的变种：

脚本顶部的配置：

```
@ECHO OFF
:: Don't leak variables to command shell
SETLOCAL

    REM service user for backend services - comment out to default to LOCALSYSTEM
SET WINDOWS_SVC_USERNAME=svcadmin 
```

检查管理员权限并创建服务后，在底部某处：

```
SETLOCAL ENABLEDELAYEDEXPANSION

:: Read password for service user
IF DEFINED WINDOWS_SVC_USERNAME (
    SET PWR=powershell -Command "$secureString = Read-Host 'Enter password for service user \".\%WINDOWS_SVC_USERNAME%\"' -AsSecureString -ErrorAction Stop; $ptr = [System.Runtime.InteropServices.Marshal]::SecureStringToGlobalAllocUnicode($secureString); $plain = [System.Runtime.InteropServices.Marshal]::PtrToStringUni($ptr); [System.Runtime.InteropServices.Marshal]::ZeroFreeGlobalAllocUnicode($ptr); Write-Host $plain;"
    FOR /F "usebackq delims=" %%P IN (`!PWR!`) DO SET WINDOWS_SVC_PASSWORD=%%P
    IF DEFINED WINDOWS_SVC_PASSWORD (
        IF ["!WINDOWS_SVC_PASSWORD!"] NEQ [""] (
            IF ["!WINDOWS_SVC_PASSWORD!"] NEQ [" "] (
                :: The password is now set correctly
                ECHO "Using ".\%WINDOWS_SVC_USERNAME%" as service user..."
                sc config  prod!WINDOWS_SVC_INFIX!rest!INDEX! obj= ".\!WINDOWS_SVC_USERNAME!" password= "!WINDOWS_SVC_PASSWORD!"
            ) ELSE (
                ECHO "ERROR -- Password possibly empty or PowerShell threw an exception."
                SET "WINDOWS_SVC_USERNAME="
            )
        ) ELSE (
            ECHO "ERROR -- Could not retrieve password! Password is possibly empty."
            SET "WINDOWS_SVC_USERNAME="
        )
    ) ELSE (
        ECHO "ERROR -- No password given or PowerShell is not available."
        SET "WINDOWS_SVC_USERNAME="
    )
) ELSE (
    ECHO "No service user specified - keeping default "LOCALSYSTEM" user..."
) 
```

当然，`sc config prod!WINDOWS_SVC_INFIX!rest!INDEX!`它只是从我的 for 循环中复制而来，需要适应您的具体情况。改为用于`ECHO password read: "!WINDOWS_SVC_PASSWORD!"`调试。

这还没有在野外测试，所以请小心处理。

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2013-03-21T02:48:34.127

这可能是一个较老的话题，但如果您使用的是 Windows Vista 或 7，我有一个非常有效的解决方案。我在这里制作了一段视频：[http ://www.youtube.com/watch?v=mk8uAa6PIFM](http://www.youtube.com/watch?v=mk8uAa6PIFM)

批处理文件的 Pastebin 在[这里](http://pastebin.com/WErALcGB)

* * *

## 回答 #17

> 赞同：-1
> 
> 时间：2014-11-01T11:17:14.237

```
@echo off
color 0f
MODE CON COLS=132 LINES=50
:start
cls
choice /C ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789!?.# /N /CS /M Please enter your password to continue. (Valid characters include all letters, numbers, and ! ? .) Press # to submit: 
SET ecode=%ERRORLEVEL%
IF %ecode% EQU 66 goto submit
IF %ecode% EQU 1 SET out=A
IF %ecode% EQU 2 SET out=B
IF %ecode% EQU 3 SET out=C
IF %ecode% EQU 4 SET out=D
IF %ecode% EQU 5 SET out=E
IF %ecode% EQU 6 SET out=F
IF %ecode% EQU 7 SET out=G
IF %ecode% EQU 8 SET out=H
IF %ecode% EQU 9 SET out=I
IF %ecode% EQU 10 SET out=J
IF %ecode% EQU 11 SET out=K
IF %ecode% EQU 12 SET out=L
IF %ecode% EQU 13 SET out=M
IF %ecode% EQU 14 SET out=N
IF %ecode% EQU 15 SET out=O
IF %ecode% EQU 16 SET out=P
IF %ecode% EQU 17 SET out=Q
IF %ecode% EQU 18 SET out=R
IF %ecode% EQU 19 SET out=S
IF %ecode% EQU 20 SET out=T
IF %ecode% EQU 21 SET out=U
IF %ecode% EQU 22 SET out=V
IF %ecode% EQU 23 SET out=W
IF %ecode% EQU 24 SET out=X
IF %ecode% EQU 25 SET out=Y
IF %ecode% EQU 26 SET out=Z
IF %ecode% EQU 27 SET out=a
IF %ecode% EQU 28 SET out=b
IF %ecode% EQU 29 SET out=c
IF %ecode% EQU 30 SET out=d
IF %ecode% EQU 31 SET out=e
IF %ecode% EQU 32 SET out=f
IF %ecode% EQU 33 SET out=g
IF %ecode% EQU 34 SET out=h
IF %ecode% EQU 35 SET out=i
IF %ecode% EQU 36 SET out=j
IF %ecode% EQU 37 SET out=k
IF %ecode% EQU 38 SET out=l
IF %ecode% EQU 39 SET out=m
IF %ecode% EQU 40 SET out=n
IF %ecode% EQU 41 SET out=o
IF %ecode% EQU 42 SET out=p
IF %ecode% EQU 43 SET out=q
IF %ecode% EQU 44 SET out=r
IF %ecode% EQU 45 SET out=s
IF %ecode% EQU 46 SET out=t
IF %ecode% EQU 47 SET out=u
IF %ecode% EQU 48 SET out=v
IF %ecode% EQU 49 SET out=w
IF %ecode% EQU 50 SET out=x
IF %ecode% EQU 51 SET out=y
IF %ecode% EQU 52 SET out=z
IF %ecode% EQU 53 SET out=0
IF %ecode% EQU 54 SET out=1
IF %ecode% EQU 55 SET out=2
IF %ecode% EQU 56 SET out=3
IF %ecode% EQU 57 SET out=4
IF %ecode% EQU 58 SET out=5
IF %ecode% EQU 59 SET out=6
IF %ecode% EQU 60 SET out=7
IF %ecode% EQU 61 SET out=8
IF %ecode% EQU 62 SET out=9
IF %ecode% EQU 63 SET out=!
IF %ecode% EQU 64 SET out=?
IF %ecode% EQU 65 SET out=.
SET code=%out%
SET show=*
:loop
cls
choice /C ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789!?.# /N /CS /M Please enter your password to continue. (Valid characters include all letters, numbers, and ! ? .) Press # to submit: %code%
SET ecode=%ERRORLEVEL%
IF %ecode% EQU 66 goto submit
IF %ecode% EQU 1 SET out=A
IF %ecode% EQU 2 SET out=B
IF %ecode% EQU 3 SET out=C
IF %ecode% EQU 4 SET out=D
IF %ecode% EQU 5 SET out=E
IF %ecode% EQU 6 SET out=F
IF %ecode% EQU 7 SET out=G
IF %ecode% EQU 8 SET out=H
IF %ecode% EQU 9 SET out=I
IF %ecode% EQU 10 SET out=J
IF %ecode% EQU 11 SET out=K
IF %ecode% EQU 12 SET out=L
IF %ecode% EQU 13 SET out=M
IF %ecode% EQU 14 SET out=N
IF %ecode% EQU 15 SET out=O
IF %ecode% EQU 16 SET out=P
IF %ecode% EQU 17 SET out=Q
IF %ecode% EQU 18 SET out=R
IF %ecode% EQU 19 SET out=S
IF %ecode% EQU 20 SET out=T
IF %ecode% EQU 21 SET out=U
IF %ecode% EQU 22 SET out=V
IF %ecode% EQU 23 SET out=W
IF %ecode% EQU 24 SET out=X
IF %ecode% EQU 25 SET out=Y
IF %ecode% EQU 26 SET out=Z
IF %ecode% EQU 27 SET out=a
IF %ecode% EQU 28 SET out=b
IF %ecode% EQU 29 SET out=c
IF %ecode% EQU 30 SET out=d
IF %ecode% EQU 31 SET out=e
IF %ecode% EQU 32 SET out=f
IF %ecode% EQU 33 SET out=g
IF %ecode% EQU 34 SET out=h
IF %ecode% EQU 35 SET out=i
IF %ecode% EQU 36 SET out=j
IF %ecode% EQU 37 SET out=k
IF %ecode% EQU 38 SET out=l
IF %ecode% EQU 39 SET out=m
IF %ecode% EQU 40 SET out=n
IF %ecode% EQU 41 SET out=o
IF %ecode% EQU 42 SET out=p
IF %ecode% EQU 43 SET out=q
IF %ecode% EQU 44 SET out=r
IF %ecode% EQU 45 SET out=s
IF %ecode% EQU 46 SET out=t
IF %ecode% EQU 47 SET out=u
IF %ecode% EQU 48 SET out=v
IF %ecode% EQU 49 SET out=w
IF %ecode% EQU 50 SET out=x
IF %ecode% EQU 51 SET out=y
IF %ecode% EQU 52 SET out=z
IF %ecode% EQU 53 SET out=0
IF %ecode% EQU 54 SET out=1
IF %ecode% EQU 55 SET out=2
IF %ecode% EQU 56 SET out=3
IF %ecode% EQU 57 SET out=4
IF %ecode% EQU 58 SET out=5
IF %ecode% EQU 59 SET out=6
IF %ecode% EQU 60 SET out=7
IF %ecode% EQU 61 SET out=8
IF %ecode% EQU 62 SET out=9
IF %ecode% EQU 63 SET out=!
IF %ecode% EQU 64 SET out=?
IF %ecode% EQU 65 SET out=.
SET code=%code%%out%
SET show=%show%*
goto loop
:submit
cls
SET password=%code%
IF %password% EQU 0cZrocks! SET result=1
IF ELSE SET result=2
IF %result% EQU 1 echo password correct
IF %result% EQU 2 echo password incorrect
timeout /T 2 /NOBREAK >nul
cls
IF %result% EQU 1 goto end
IF ELSE goto start
:end 
```

* * *

## 回答 #18

> 赞同：-3
> 
> 时间：2010-03-31T16:15:35.880

我阅读了网上所有关于如何在批处理文件中屏蔽密码的笨拙解决方案，使用 hide.com 解决方案的解决方案，甚至是使文本和背景颜色相同的解决方案。hide.com 解决方案运行良好，但不是很安全，并且在 64 位 Windows 中无法运行。所以无论如何，使用 100% Microsoft 实用程序，有办法！

首先，让我解释一下我的用途。我有大约 20 个自动登录到 Windows 的工作站。他们的桌面上有一个快捷方式——一个临床应用程序。机器被锁定，无法右键单击，只能访问桌面上的一个快捷方式。有时技术人员需要启动一些调试应用程序、浏览 Windows 资源管理器并查看日志文件，而无需注销自动登录用户帐户。

所以这就是我所做的。

随心所欲地做，但我将我的两个批处理文件放在锁定计算机可以访问的网络共享上。

我的解决方案利用了 Windows 的 1 个主要组件 - runas。在客户端上为您将要创建的 runas.bat 放置一个快捷方式。仅供参考，在我的客户上，我重命名了快捷方式以便更好地查看并更改了图标。

您将需要创建两个批处理文件。

我将批处理文件命名为**runas.bat**和**Debug Support.bat**

**runas.bat 包含以下代码：**

```
cls
@echo off
TITLE CHECK CREDENTIALS 
goto menu

:menu
cls
echo.
echo           ....................................
echo            ~Written by Cajun Wonder 4/1/2010~
echo           ....................................
echo.
@set /p un=What is your domain username? 
if "%un%"=="PUT-YOUR-DOMAIN-USERNAME-HERE" goto debugsupport
if not "%un%"=="PUT-YOUR-DOMAIN-USERNAME-HERE" goto noaccess
echo.
:debugsupport
"%SYSTEMROOT%\system32\runas" /netonly /user:PUT-YOUR-DOMAIN-NAME-HERE\%un% "\\PUT-YOUR-NETWORK-SHARE-PATH-HERE\Debug Support.bat"
@echo ACCESS GRANTED! LAUNCHING THE DEBUG UTILITIES....
@ping -n 4 127.0.0.1 > NUL
goto quit
:noaccess
cls
@echo.
@echo.
@echo.
@echo.
@echo   \\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\
@echo   \\                                   \\
@echo   \\    Insufficient privileges         \\  
@echo   \\                                    \\
@echo   \\      Call Cajun Wonder             \\
@echo   \\                                    \\
@echo   \\              At                    \\
@echo   \\                                    \\
@echo   \\        555-555-5555                \\
@echo   \\                                    \\
@echo   \\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\
@ping -n 4 127.0.0.1 > NUL
goto quit
@pause
:quit
@exit 
```

**如果“%un%”**，如果不是“%un%”，您可以为要授予访问权限的所有用户添加尽可能多的数量。@ping 是我制作秒计时器的笨拙方式。

这样就可以处理第一个批处理文件 - 很简单吧？

这是 Debug Support.bat 的代码：

```
cls
@echo off
TITLE SUPPORT UTILITIES
goto menu

:menu
cls
@echo %username%
echo.
echo           .....................................
echo            ~Written by Cajun Wonder 4/1/2010~
echo           .....................................
echo.
echo What do you want to do? 
echo.
echo [1]  Launch notepad
echo.

:choice
set /P C=[Option]? 
if "%C%"=="1" goto notepad
goto choice

:notepad
echo.
@echo starting notepad....
@ping -n 3 127.0.0.1 > NUL
start notepad
cls
goto menu 
```

我不是编码员，实际上大约一年前才开始使用批处理脚本，而我发现在批处理文件中屏蔽密码的这一轮方式非常棒！

我希望听到除了我之外的其他人能够从中得到一些用处！

# sql - 如何在 LINQ 中编写我的 SQL 查询？

> ID：664968
> 
> 赞同：0
> 
> 时间：2009-03-20T04:18:34.130
> 
> 标签：sql, linq

我有一张看起来像这样的桌子。查询需要返回每个位置的最后日期条目。我将如何在 SQL 和 LINQ 中编写它？

```
Id  Location        Salary  Date
1   Los Angeles     $1500   Jan-05-1999 
2   San Diego       $250    Jan-07-1999 
3   Los Angeles     $300    Jan-08-1999
4   Boston          $700    Jan-08-1999
5   Los Angeles     $300    Jan-08-1999 
```

结果将是：

```
2   San Diego       $250    Jan-07-1999
4   Boston          $700    Jan-08-1999
5   Los Angeles     $300    Jan-08-1999 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-20T18:23:38.250

If your dates included time, then you could:

```
var locations = 
   from l in mycontext.Locations
   where l.Date = mycontext.Locations
         .Where(l2=>l.Location == l2.Location)
         .Max(l2.Date)
   select l; 
```

Alternatively, assuming ID is an identity and the records are inserted in the table when they occurred(your example seems to hint so), you can do:

```
var locations = 
   from l in mycontext.Locations
   where l.ID = mycontext.Locations
         .Where(l2=>l.Location == l2.Location)
         .Max(l2.ID)
   select l; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-20T04:25:40.090

请记住，我对链接很陌生，我认为这不是最好的方法：

```
var collection = from d in <TABLE> select d;
collection = collection.GroupBy(x => x.Date).Select(x => x.Last()); 
```

基本上只是按日期分组并拿最后一个。我想不出在 LINQ 命令中执行此操作的好方法，所以我只选择了所有行 - 有人知道合并这些行吗？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-20T06:13:58.910

实际上，如果我正确阅读了这个问题，这并不是那么简单。因为 Los Angeles 在 Max date 上有 2 个条目，所以似乎还有一条进一步的规则，即在这种情况下应该选择最大 ID。

在这种情况下，SQL 会变得更复杂一些，需要 2 个分组......

```
select id, location, salary, date from 
locations where id in
(select  max(id) as MaxID
from locations where date in (
Select Max(Date) as MaxDate from Locations group by Location)
Group by location) 
```

相应的 Linq 查询也需要 2 个分组...

```
 var qry = from a in locations
            group a by a.Location into grp
            from b in grp
            where b.Date == grp.Max(o => o.Date)
            group b by b.Location into grp2
            from c in grp2
            where c.ID == grp2.Max(obj => obj.ID)
            orderby c.ID
            select c; 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-20T04:20:52.347

```
SELECT location, max(date)

FROM yourtable

GROUP BY location 
```

编辑：我没有看到要求的结果或不确定它最初是否存在：

```
SELECT yourtable.id, yourtable.location, yourtable.salary, yourtable.date
FROM yourtable INNER JOIN
  (SELECT yourtable.location, MAX(yourtable.date) as thedate
   FROM yourtable
   GROUP BY yourtable.location) AS MYRESULT 
   on MYRESULT.thedate = yourtable.date  
      AND MYRESULT.location = yourtable.location 
```

虽然没有测试过这个。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-20T04:27:35.047

@Bobby Shaftoe

我相信他正在寻找最新的条目，而不是每个位置的最新日期。如果我的假设是正确的，它会更像

```
SELECT max(ID),location,date
FROM tablename
GROUP BY location 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-20T04:34:44.670

为了获得每个位置的最大日期的整行，我认为 SQL 是：

```
SELECT t1.Id, t1.Location, t1.Salary, t1.Date
FROM YourTable t1, 
    (SELECT Location, MAX(Date) AS MaxDate
    FROM YourTable
    GROUP BY Location) t2
WHERE t1.Location = t2.Location
AND t1.Date = t2.MaxDate 
```

如果我错了，请纠正我！

# javascript - Onkeydown() 不适用于 IE 中的删除和退格

> ID：664977
> 
> 赞同：0
> 
> 时间：2009-03-20T04:25:01.057
> 
> 标签：javascript, events, event-handling, dom-events

有谁知道为什么该`onkeydown()`事件不适用于IE`delete`并`backspace`键入 IE？它适用于数字和字符键。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-20T04:36:27.223

你确定吗？.. 以下在 IE 上看到 delete 和 backspace 很好：

```
<html>
<head>
<script type="text/javascript">
function keypress(e)
{
    var keycode;
    if (window.event) // IE
    {
        keycode = e.keyCode;
    }
    else if (e.which) // Netscape/FF/Op
    {
        keycode = e.which;
    }
    alert(keycode);
}
</script>
</head>
<body>
<form>
    <input type="text" onkeydown="return keypress(event)" />
</form>
</body>
</html> 
```

# ruby - Ruby 中的 << 运算符用于附加内容时，你怎么称呼它？

> ID：664978
> 
> 赞同：11
> 
> 时间：2009-03-20T04:25:24.397
> 
> 标签：ruby, operators, append

在其他情况下，我知道这 << 被称为位移运算符。当它仅用于附加操作时，它是否有名称，就像您在数组或字符串中所做的那样（不确定您还可以附加什么）？

我希望能够使用一个英文单词来指代它，而不是说“你知道，带有两个左箭头的运算符并不是真正的左移位运算符”。

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2009-03-20T04:28:52.517

实际上，我认为*附加运算符*是首选术语。这是在[**p 上使用的。104**](http://books.google.com/books?id=jcUbTcr5XWwC&pg=PA104&lpg=PA104&dq=ruby+%22%3C%3C%22+append+operator&source=bl&ots=fHDnwb5tiB&sig=iqFi9SaQm7u45QFj_jrMpkFUigg&hl=en&ei=UxvDScH8BsLgnQfztdCWDg&sa=X&oi=book_result&resnum=8&ct=result)的[Ruby 编程语言](https://rads.stackoverflow.com/amzn/click/com/0596516177)。

# c# - 发送列表 到 wcf 服务

> ID：664981
> 
> 赞同：0
> 
> 时间：2009-03-20T04:26:39.807
> 
> 标签：c#, wcf

我试图到处寻找这个问题的答案，但没有运气..所以我向这里的专家寻求帮助！

我在 c# 中有一个 wcf 服务正在完全工作......它做了一些魔法并将一个列表发送到服务器。服务器可以很好地读取这些 PO 对象。但是，当 PO 内部有一个列表时，我现在遇到了问题......

```
public class PO
{
    /* omitted */
    [DataMember]
    public Object BasicContent { get; set; }
} 
```

当 BasicContent 是列表时，我收到以下错误：

*“尝试序列化参数[http://tempuri.org/:objectToPersist](http://tempuri.org/:objectToPersist)时出错。InnerException 消息是 'Type 'System.String[]'，数据合同名称为 'ArrayOfstring: [http://schemas.microsoft.com /2003/10/Serialization/Arrays](http://schemas.microsoft.com/2003/10/Serialization/Arrays) '不是预期的。将任何静态未知的类型添加到已知类型列表中 - 例如，通过使用 KnownTypeAttribute 属性或将它们添加到传递给 DataContractSerializer 的已知类型列表中。'。有关详细信息，请参阅 InnerException。”*

我试过添加`[ServiceKnownType(typeof(List<string>))]`或`[ServiceKnownType(typeof(string[]))]`到处都无济于事......

谁能帮我看看我能做什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-20T05:38:45.780

Have you tried changing the type to String or String[] or List depending on what your setting it to.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-20T05:20:01.037

Try adding a ServiceKnownType for just String

```
[ServiceKnownType(typeof(string))] 
```

# silverlight - Silverlight 代码混淆

> ID：664989
> 
> 赞同：5
> 
> 时间：2009-03-20T04:30:26.990
> 
> 标签：silverlight, obfuscation

我正在寻找任何可用于 Silverlight 代码混淆的免费工具的建议。混淆器专业版支持 Silverlight，但混淆器社区版不支持。

来自 Google Code 的 Obfuscar 需要手动指定不应混淆的每个项目，因此必须手动列出 XAML 中引用的每个控件和属性。没有选项可以不混淆任何公共类型和成员的名称。即使我手动指定每个公共类和成员，我也不知道是否还有其他 Silverlight 问题潜伏。

我没有兴趣开始另一个关于代码混淆的智慧或缺乏的讨论。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2010-11-23T04:44:03.780

.NET Reactor 是浪费钱。几乎所有版本的程序都有自动解包工具，作者不回复电子邮件。在我对许多混淆器的评估和测试过程中，我提出了以下列表：

*   CodeFort - 非常有前途。在撰写本文时缺少一些功能，但作者已经在研究它们并且对电子邮件非常敏感。与其他人相比也便宜。

*   CLISecure - 良好的支持和产品，但非常非常昂贵

*   SmartAssembly - 受保护的程序崩溃了也可以使用反混淆器，但它们不时更改小东西以阻止它们，所以它是一个不错的选择。

*   9Rays - 几乎没有混淆任何东西。（我检查了设置）太浪费钱了。

*   DeapSea - 比 CodeFort 更昂贵，功能更少。

*   CryptoObfuscator - 中档定价和功能丰富。但我不确定保护有多强。根据一些帖子，在某一时刻很容易破解。不确定是否仍然如此。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2010-04-26T19:47:25.470

我很高兴地告诉您，您不再需要手动从 Silverlight 程序集的混淆中排除类型和成员。事实上，您根本不必排除任何东西。

CodeFort 是第一个引入 XAML 和 BAML 重命名的混淆器。这意味着对 XAML 和 BAML 代码中的类型和成员的引用将与其余的混淆同步更新 - 通过这样做，不需要像今天所有其他混淆器那样使大部分代码不受保护。

如果您想亲自看看，请从我们的网站下载 CodeFort 免费版：http: [//codefort.org/download](http://codefort.org/download)

希望这可以帮助，

基督教

codefort.org

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-11-03T17:36:11.437

到目前为止，我还没有看到一个好的免费的 Silverlight 混淆器。这是对一些便宜的混淆器的不错评论： [http](http://www.olsonsoft.com/blogs/stefanolson/post/Selecting-an-obfuscator-for-Silverlight.aspx) ://www.olsonsoft.com/blogs/stefanolson/post/Selecting-an-obfuscator-for-Silverlight.aspx 。作者选择了 .NET Reactor 作为最喜欢的混淆器。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2010-06-21T19:18:31.817

PreEmptive Solutions 处于对最新 Dotfuscator 版本进行 beta 测试的最后阶段，该版本将保护扩展到 Silverlight 程序集之外，也扩展到 XAML 资源。（这种支持已经在生产中用于 WPF/BAML）。这有三个好处；您的更多程序集受到保护，您的 XAML 受到保护，并且您可以节省时间，因为配置现在更加简单（不再有排除项）。

如果您有兴趣成为测试版候选人，请给我发电子邮件 (sebastian@preemptive.com)，我会让我们的支持团队向您发送凭据。请记住，这是测试版——不收取任何费用——您将获得我们的支持——但您不能将此版本用于任何生产工作。

唯一的软件要求是 .NET 1.1 或更高版本以及 Silverlight 2 或更高版本。（是的 - 在 Windows Mobile 7、Windows Azure 中进行测试...）

其他一些需要考虑的事情：

• 分析（功能和使用跟踪）也可以在编译后注入

• 分析还支持Expression Blend Silverlight 分析框架（允许设计时Web 分析和编译后检测合二为一）。

• Dotfuscator 使用 XAP 文件而不是程序集，并自动对其重新签名，从而使您的构建更加简单。

• Dotfuscator 还是一个高效的“修剪器”，可以一路缩减 Silverlight 应用程序……</p>

有关我们“通用 Silverlight 支持”的更多信息，请参阅我们的 TechEd 公告，网址为[http://www.preemptive.com/news-events/press-releases/307](http://www.preemptive.com/news-events/press-releases/307)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-04-23T23:34:21.513

随 Visual Studio 2010 提供的 Dotfuscator Community Edition 版本将支持 Silverlight 2 和 Silverlight 3 程序集的混淆。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-08-12T05:20:33.637

[http://code.google.com/p/babelobfuscator/](http://code.google.com/p/babelobfuscator/)现在免费又酷的一个 :)

# python - python中的方框图

> ID：664991
> 
> 赞同：7
> 
> 时间：2009-03-20T04:31:03.447
> 
> 标签：python, windows, unicode

平台：WinXP SP2，python 2.5.4.3。（活动状态分布）

有没有人成功地在 python中写出画框[字符？](http://en.wikipedia.org/wiki/Box_drawing_characters)当我尝试运行它时：

```
print u'\u2500'
print u'\u2501'
print u'\u2502'
print u'\u2503'
print u'\u2504' 
```

所有提示表示赞赏。我究竟做错了什么 ？python是否支持完整的unicode？是否有可能让这些字符打印出来。

### 有关的

*   [标准错误的python的默认编码？](https://stackoverflow.com/questions/637396/default-encoding-for-python-for-stderr)

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-03-20T08:51:40.387

您的问题不在 Python 中，而是在 cmd.exe 中。它必须设置为支持 UTF-8。不幸的是，将 Windows 控制台 (cmd.exe) 切换为 UTF-8“Python 兼容”方式并不容易。

您可以使用命令（在 cmd.exe 中）切换到 UTF8：

```
chcp 65001 
```

但 Python (2.5) 无法识别该编码。无论如何，您必须设置支持 unicode 的正确字体！

对于方框图，我建议使用旧的 dos 代码页 437，因此您需要在运行 python 脚本之前进行设置：

```
chcp 437 
```

然后您可以将 cp437 编码的字符直接打印到标准输出或将字符解码为 un​​icode 并打印 unicode，试试这个脚本：

```
# -*- coding: utf-8 -*- 
for i in range(0xB3, 0xDA):
    print chr(i).decode('cp437'),

# without decoding (see comment by J.F.Sebastian)
print ''.join(map(chr, range(0xb3, 0xda))) 
```

但是，您可以使用绘图字符，但由于 cp437 的限制，您不能使用您可能需要的其他字符。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-20T05:08:09.143

This varies greatly based on what your terminal supports. If it uses UTF-8, and if Python can detect it, then it works just fine.

```
>>> print u'\u2500'
─
>>> print u'\u2501'
━
>>> print u'\u2502'
│
>>> print u'\u2503'
┃
>>> print u'\u2504'
┄ 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-20T04:44:41.977

打印它们将以默认字符编码打印，这可能不是您终端的正确编码。

您是否尝试过先将它们转码为 utf-8？

```
print u'\u2500'.encode('utf-8')
print u'\u2501'.encode('utf-8')
print u'\u2502'.encode('utf-8')
print u'\u2503'.encode('utf-8')
print u'\u2504'.encode('utf-8') 
```

这适用于支持 utf-8 编码数据的终端中的 linux 上的我。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-20T09:04:22.523

Python 支持 Unicode。可以打印这些字符。

例如，请参阅[我](https://stackoverflow.com/questions/637396/default-encoding-for-python-for-stderr/638823#638823)对[“stderr 的 python 的默认编码？”的回答。](https://stackoverflow.com/questions/637396/default-encoding-for-python-for-stderr)我已经展示了如何将 Unicode 打印到`sys.stderr`（将其替换`sys.stdout`为裸`print`语句）。

# xml - 只要 XHTML 实体编码包含在 CDATA 标记中，它们在 XML 文档中是否有效？

> ID：664992
> 
> 赞同：4
> 
> 时间：2009-03-20T04:31:37.250
> 
> 标签：xml, unicode, utf-8, cdata

这是一个有效的（格式良好的）XML 文档吗？

```
<?xml version="1.0" encoding="UTF-8" ?> 
<outer>
  <inner>&copy;</inner>
</outer> 
```

问题在于 HTML/XHTML“©”实体编码在没有 DTD 或模式来定义它的 XML 文档中是否有效。表达上述内容的另一种方式是这样说：

```
<?xml version="1.0" encoding="UTF-8" ?> 
<outer>
  <inner>&#169;</inner>
</outer> 
```

这似乎是具有 UTF-8 编码的有效 XML。

但这是否有效：

```
<?xml version="1.0" encoding="UTF-8" ?> 
<outer>
  <inner><![CDATA[&copy;]]></inner>
</outer> 
```

上面的作者打算向XML解析器表明它应该通过上面的版权符号作为字符串“©” 而不是作为正确的 Unicode 字符。

在这方面我觉得这句话有点令人困惑：'XML 文档的新作者经常误解 CDATA 部分的目的，错误地认为它的目的是“保护”数据在处理过程中不被视为普通字符数据。[但是] 字符数据是字符数据，无论它是通过 CDATA 部分还是通过普通标记表示的。”（来自[维基百科](http://en.wikipedia.org/wiki/CDATA)）

我正在单独查看第二位作者提出的 XML 格式，他将*每个*标签都包装在 CDATA 部分中，即使标签只能包含数字。

希望 XML 大师可以帮助消除对 CDATA 目的的困惑。

谢谢！

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-03-20T04:41:58.943

CDATA 部分的目的是允许通常在 XML 文档中以特殊方式解释的文字文本。也就是说，看起来像实体引用的东西，或者看起来像 XML 标记的东西。CDATA 部分中的任何内容都可以在没有 CDATA 部分的有效 XML 中；您只需要使用实体引用来编码各种特殊字符，这样它们就不会被视为 XML 标记，而是作为标记值的字符数据。

所以是的，以下是完全有效的，只要它是你想要的：

```
<?xml version="1.0" encoding="UTF-8" ?> 
<outer>
  <inner><![CDATA[&copy;]]></inner>
</outer> 
```

这里，`inner`元素的值`&copy;`是不会被 XML 解析器解释为版权符号的实体引用的值。您还可以执行以下操作：

```
<?xml version="1.0" encoding="UTF-8" ?> 
<outer>
  <inner><![CDATA[<normally> this looks <like/> &amp; xml </normally>]]></inner>
</outer> 
```

其中`inner`元素的值为

```
<normally> this looks <like/> &amp; xml </normally> 
```

要在没有 CDATA 部分的情况下执行此操作：

```
<?xml version="1.0" encoding="UTF-8" ?> 
<outer>
  <inner>&lt;normally&gt; this looks &lt;like/&gt; &amp;amp; xml &lt;/normally&gt;</inner>
</outer> 
```

它的可读性要差得多，但就 XML 解析器而言是等效的。如果您这样做（假设`inner`元素被定义为包含字符串而不是 XML 的模式或 DTD），那么您的 XML 解析器将报错：

```
<?xml version="1.0" encoding="UTF-8" ?> 
<outer>
  <inner><normally> this looks <like/> &amp; xml </normally></inner>
</outer> 
```

因此您使用 CDATA 或实体转义来保护 XML 解析器中的特殊字符，以便 XML 数据的客户端可以获取`inner` 恰好包含 XML 标记字符的值。

注意：为了清楚起见，上面的示例是*格式良好*的 XML，但如果架构或 DTD 表明该元素`inner`包含 xsd:string 或等效项，则它是*无效*的XML 文档。

不，没有定义为 XML 本身一部分的 HTML 或 XHTML 实体不是有效的 XML，除非它们被定义。您的 XML 解析器将返回错误。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-03-20T16:16:44.000

Eddie给了一个很好的答复，我只是补充了一些他显然没有提到的点。

```
<?xml version="1.0" encoding="UTF-8" ?> 
<outer>
  <inner>&copy;></inner>
</outer> 
```

不合法（实体“副本”未预定义，在 XML 中只有“lt”、“gt”和“quot”）。

```
<?xml version="1.0" encoding="UTF-8" ?> 
<outer>
  <inner>&#169;</inner>
</outer> 
```

是完全合法的，并且可能会提供您想要的东西（版权符号）。

```
<?xml version="1.0" encoding="UTF-8" ?> 
<outer>
  <inner><![CDATA[&copy;]]></inner>
</outer> 
```

也是完全合法的，但会产生完全不同的结果（该元素`<inner>`将包含六个 Unicode 字符，而不是前面示例中的一个）。

```
<?xml version="1.0" encoding="UTF-8" ?> 
<!DOCTYPE outer[
<!ENTITY copy "&#169;">
]>
<outer>
  <inner>&copy;></inner>
</outer> 
```

也是合法的，并且给出与第二个示例相同的结果。它可以让您免于输入一些您使用但不容易用键盘/编辑器生成的字符。

```
<?xml version="1.0" encoding="UTF-8" ?> 
<outer>
  <inner>©</inner>
</outer> 
```

也是合法的（因为 encoding="UTF-8"，使用 encoding="US-ASCII"，这是不可能的），并给出相同的结果。如果您的键盘/编辑器允许您直接使用此字符。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-20T04:36:32.840

XML 解析器会忽略 CDATA 块的内容，因此关于验证和可解析性，您可以将任何您喜欢的内容放入 CDATA。

当然，这也伴随着 CDATA 被视为*任意*的事实，因此如果您想要在 XML 中使用实际的 ©，这将不起作用。我们假设您计划将 CDATA 的内容加载到 X/HTML 解析器中，就像您可能将图像中的 base64 编码二进制数据块加载到图像解析器中一样。XML 解析器不会尝试从 CDATA 块的内容中获取含义；它也可以像它所说的那样说“foo” `&copy;`。

维基百科的引文似乎确实措辞令人困惑。~~********`