# StackOverflow 问答 10392000-10392999

# asp.net - 测试ControllerFactory（预启动初始化阶段）

> ID：10392002
> 
> 赞同：4
> 
> 时间：2012-04-30T23:55:02.047
> 
> 标签：asp.net, asp.net-mvc, asp.net-mvc-3, unit-testing

我想编写一个单元测试来验证我的路由注册和 ControllerFactory 以便给定特定的 URL，将创建一个特定的控制器。像这样的东西：

```
Assert.UrlMapsToController("~/Home/Index",typeof(HomeController)); 
```

我已经修改了取自“Pro ASP.NET MVC 3 Framework”一书的代码，除了 ControllerFactory.CreateController() 调用抛出 InvalidOperationException 并说之外，这似乎是完美的`This method cannot be called during the application's pre-start initialization stage.`

于是我下载了MVC源码并调试进去，寻找问题的根源。它源自 ControllerFactory 寻找所有引用的程序集 - 以便它可以找到潜在的控制器。在 CreateController 调用堆栈的某处，特定的麻烦制造者调用是这样的：

```
internal sealed class BuildManagerWrapper : IBuildManager {
    //...

    ICollection IBuildManager.GetReferencedAssemblies() {
        // This bails with InvalidOperationException with the message
        // "This method cannot be called during the application's pre-start 
        // initialization stage."
        return BuildManager.GetReferencedAssemblies();
    }

    //...
} 
```

[我发现了一个关于这个的评论](https://stackoverflow.com/a/3419815/284758)。我仍然想知道是否有可以手动初始化的东西来让上面的代码快乐。任何人？

但是在没有那个的情况下......我不禁注意到调用来自 IBuildManager 的实现。我探索[了注入自己的 IBuildManager 的可能性](http://blog.semanticsworks.com/2010/01/test-example-in-systemwebmvc.html)，但遇到了以下问题：

*   IBuildManager 被标记`internal`，所以我需要一些其他的授权派生。事实证明，该程序集`System.Web.Mvc.Test`有一个名为 的类`MockBuildManager`，专为测试场景而设计，非常完美！！！这导致了第二个问题。
*   据我所知，MVC 可分发文件不附带 System.Web.Mvc.Test 程序集（DOH！）。
*   即使 MVC 可分发确实随 System.Web.Mvc.Test 程序集一起提供，拥有 的实例`MockBuildManager`也只是解决方案的一半。还需要将该实例提供给`DefaultControllerFactory`. 不幸的是，完成此操作的属性设置器也被标记为`internal`（DOH！）。

简而言之，除非我找到另一种方法来“初始化”MVC 框架，否则我现在的选择是：

*   完全复制 DefaultControllerFactory 及其依赖项的源代码，这样我就可以绕过原始`GetReferencedAssemblies()`问题。（啊！）
*   基于 MVC 源代码，用我自己构建的 MVC 完全替换 MVC 可分发 - 只`internal`删除了几个修饰符。（双啊！）

顺便说一句，我知道 MvcContrib“TestHelper”看起来可以实现我的目标，但我认为它只是使用反射来查找控制器——而不是使用实际的 IControllerFactory 来检索控制器类型/实例。

我想要这个测试功能的一个重要原因是我已经制作了一个基于 DefaultControllerFactory 的自定义控制器工厂，我想验证它的行为。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-23T07:22:16.113

我不太确定您要在这里完成什么。如果它只是测试您的路线设置；你最好只测试它而不是侵入内部结构。TDD 的第一条规则：只测试您编写的代码（在这种情况下，这是路由设置，而不是 MVC 完成的实际路由解析技术）。

有大量关于测试路由设置的帖子/博客（只是谷歌的'mvc test route'）。这一切都归结为在 httpcontext 中模拟一个请求并调用 GetRouteData。

如果您真的需要一些忍者技能来模拟 buildmanager：有一种方法可以绕过内部接口，我将其用于（LinqPad）实验测试。现在大多数 .net 程序集都有 InternalsVisibleToAttribute 集，很可能指向另一个签名的测试程序集。通过扫描该属性的目标程序集并动态创建与名称（和公钥令牌）匹配的程序集，您可以轻松访问内部。

请注意，我个人不会在生产测试代码中使用这种技术；但这是隔离一些复杂想法的好方法。

```
void Main()
{
    var bm = BuildManagerMockBase.CreateMock<MyBuildManager>();
    bm.FileExists("IsCool?").Dump();
}

public class MyBuildManager : BuildManagerMockBase
{
    public override bool FileExists(string virtualPath) { return true; }
}

public abstract class BuildManagerMockBase
{
    public static T CreateMock<T>() 
        where T : BuildManagerMockBase
    {
        // Locate the mvc assembly
        Assembly mvcAssembly = Assembly.GetAssembly(typeof(Controller));

        // Get the type of the buildmanager interface
        var buildManagerInterface = mvcAssembly.GetType("System.Web.Mvc.IBuildManager",true);

        // Locate the "internals visible to" attribute and create a public key token that matches the one specified.
        var internalsVisisbleTo = mvcAssembly.GetCustomAttributes(typeof (InternalsVisibleToAttribute), true).FirstOrDefault() as InternalsVisibleToAttribute;
        var publicKeyString = internalsVisisbleTo.AssemblyName.Split("=".ToCharArray())[1];
        var publicKey = ToBytes(publicKeyString);

        // Create a fake System.Web.Mvc.Test assembly with the public key token set
        AssemblyName assemblyName = new AssemblyName();
        assemblyName.Name = "System.Web.Mvc.Test";
        assemblyName.SetPublicKey(publicKey);

        // Get the domain of our current thread to host the new fake assembly
        var domain = Thread.GetDomain();
        var assemblyBuilder = domain.DefineDynamicAssembly(assemblyName, AssemblyBuilderAccess.RunAndSave);
        moduleBuilder = assemblyBuilder.DefineDynamicModule("System.Web.Mvc.Test", "System.Web.Mvc.Test.dll");
        AppDomain currentDom = domain;
        currentDom.TypeResolve += ResolveEvent;

        // Create a new type that inherits from the provided generic and implements the IBuildManager interface
        var typeBuilder = moduleBuilder.DefineType("Cheat", TypeAttributes.NotPublic | TypeAttributes.Class, typeof(T), new Type[] { buildManagerInterface });      
        Type cheatType = typeBuilder.CreateType();

        // Magic!
        var ret = Activator.CreateInstance(cheatType) as T;

        return ret;
    }

    private static byte[] ToBytes(string str)
    {
        List<Byte> bytes = new List<Byte>();

        while(str.Length > 0)
        {
            var bstr = str.Substring(0, 2);
            bytes.Add(Convert.ToByte(bstr, 16));
            str = str.Substring(2);
        }

        return bytes.ToArray();
    }

    private static ModuleBuilder moduleBuilder;

    private static Assembly ResolveEvent(Object sender, ResolveEventArgs args)
    {
        return moduleBuilder.Assembly;
    }

    public virtual bool FileExists(string virtualPath)      { throw new NotImplementedException(); }
    public virtual Type GetCompiledType(string virtualPath) { throw new NotImplementedException(); }
    public virtual ICollection GetReferencedAssemblies()    { throw new NotImplementedException(); }
    public virtual Stream ReadCachedFile(string fileName)   { throw new NotImplementedException(); }
    public virtual Stream CreateCachedFile(string fileName) { throw new NotImplementedException(); }
} 
```

# c++ - 使用dirent.h阅读时如何跳过目录

> ID：10392006
> 
> 赞同：0
> 
> 时间：2012-04-30T23:55:36.643
> 
> 标签：c++, c, opendir, dirent.h

我正在尝试使用**dirent.h中提供的功能递归打开文件**

我的问题是：我无法跳过无法打开的目录。我希望它打开它可以打开的目录并跳过它不能打开的目录并移动到下一个目录而不是失败退出。我应该怎么做才能解决这个问题？

这是我尝试使用的简单代码

```
int acessdirs(const char *path)
{
    struct dirent *entry;
    DIR *dp;
    char fpath[300];
    if(dp=opendir(path))
    {
        while((entry=readdir(dp)))
            do things here
    }
    else
    {
        std::cout<<"error opening directory";
        return 0;
    }
    return 1;
} 
```

我使用了相同的样式`windows 7`，它工作正常。但是它崩溃了`windows xp`，当我调试它时，我发现它在尝试打开时崩溃了`"system volume information"`。我真的不需要访问这个文件夹，我希望是否有任何方法可以跳过它。

这是我的真实代码：

它有点长。

```
int listdir(const char *path) 
{
  struct dirent *entry;
  DIR *dp;

  if(dp = opendir(path))
  {
    struct stat buf ;

    while((entry = readdir(dp)))
    {
        std::string p(path);
        p += "\\";
        p += entry->d_name;
         char fpath[300];
        if(!stat(p.c_str(), &buf))
        {
            if(S_ISREG(buf.st_mode))
            {  
                sprintf(fpath,"%s\\%s",path,entry->d_name);
                stat(fpath, &buf);
                std::cout<<"\n Size of \t"<<fpath<<"\t"<<buf.st_size;
                fmd5=MDFile (fpath);        
            }//inner second if
            if(S_ISDIR(buf.st_mode) &&  
         // the following is to ensure we do not dive into directories "." and ".."
                      strcmp(entry->d_name, ".")  && strcmp(entry->d_name, "..") )
            {
                listdir(p.c_str());
            }
        }//inner first if
        else
            std::cout << "ERROR in stat\n";
    }//end while
    closedir(dp);
  }//first if
  else
  {
      std::cout << "ERROR in opendir\n";
      return 0;
  }
  return 1;   

 }//listdir() 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-01T02:54:04.030

你最大的问题似乎在这里：

```
sprintf(fpath,"%s\\%s",path,entry->d_name);
stat(fpath, &buf); 
```

没有看到`fpath`'s declaration，很难确定，但你要么

*   `fpath`在调用中溢出`sprintf`，导致未定义的行为。“系统卷信息”是一个长名称。你真的应该使用`snprintf`.

*   不检查调用的返回值`stat`。如果它返回`-1`，我不确定它的内容是什么`buf`。

更重要的是，如果您可以使用 POSIX 的东西，那么该功能[`ftw`](http://pubs.opengroup.org/onlinepubs/009604599/functions/ftw.html)是标准的，并且应该提供您在此处尝试实现的大部分功能。

# javascript - 如何在它所属的行中附加文件名？

> ID：10392007
> 
> 赞同：0
> 
> 时间：2012-04-30T23:55:51.653
> 
> 标签：javascript, jquery

我有一个应用程序，您可以访问 [这里][1]。当您打开应用程序时，您会在顶部看到一个“添加”按钮，单击此按钮两次，您将看到 2 个表格行出现，每行包含它自己的文件输入。

问题是：假设您尝试在第二行的文件输入中上传一个文件（用于快速上传的小文件）。上传文件后，已上传文件的名称会附加到第一行和第二行。这是不正确的，它应该只在第二行附加文件名，因为您使用第二行的文件输入来上传该文件。

如何在用于上传文件的文件输入的同一行中附加文件名？

以下是包含文件输入的表单的代码：

```
 function insertQuestion(form) {  

  var $tbody = $('#qandatbl > tbody'); 
  var $tr = $("<tr class='optionAndAnswer' align='center'></tr>");
  var $image = $("<td class='image'></td>"); 

    var $fileImage = $("<form action='imageupload.php' method='post' enctype='multipart/form-data' target='upload_target' onsubmit='return imageClickHandler(this);' class='imageuploadform' >" + 
    "Image File: <input name='fileImage' type='file' class='fileImage' /></label><br/><label class='imagelbl'>" + 
    "<input type='submit' name='submitImageBtn' class='sbtnimage' value='Upload' /></label>" + 
    "<label><input type='button' name='imageClear' class='imageClear' value='Clear File'/></label>" +
    "</p><ul class='listImage' align='left'></ul>" +
    "<iframe class='upload_target' name='upload_target' src='#' style='width:0;height:0;border:0px;solid;#fff;'></iframe></form>");

    $image.append($fileImage);

    $tr.append($image);  
    $tbody.append($tr);

    }; 
```

以下是单击时表单指向的处理程序：

```
 function imageClickHandler(imageuploadform){ 
      if(imageValidation(imageuploadform)){ 
          return startImageUpload(imageuploadform); 
      } 
      return false;
  } 
```

以下是文件上传开始和停止的位置：

```
function startImageUpload(imageuploadform){

  $(imageuploadform).find('.imagef1_upload_process').css('visibility','visible');

      return true;
}

    function htmlEncode(value) { return $('<div/>').text(value).html(); }

    function stopImageUpload(success, imagefilename){

          var result = '';

          if (success == 1){
             result = '<span class="msg">The file was uploaded successfully!</span><br/><br/>';      
              $('.listImage').append('<div>' + htmlEncode(imagefilename) + '<button type="button" class="deletefileimage">Delete</button><br/><hr/></div>'); 
          }
          else {
             result = '<span class="emsg">There was an error during file upload!</span><br/><br/>';
          }

  $(".deletefileimage").on("click", function(event) {

    $(this).parent().remove();

});

    return true;

    } 
```

正确的解决方案：

```
 function imageClickHandler(imageuploadform){ 
          if(imageValidation(imageuploadform)){ 
 window.lastUploadImageIndex = $('.imageuploadform').index(imageuploadform); 
              return startImageUpload(imageuploadform); 
          } 
          return false;
      }

         $('.listImage').eq(window.lastUploadImageIndex).append('<div>' + htmlEncode(imagefilename) + '<button type="button" class="deletefileimage">Delete</button><br/><hr/></div>'); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-01T00:12:36.703

你的基本问题是：

> $('.listImage')

那是“任何具有类'listImage'的元素”的选择器。由于您单击了两次添加，因此此类有两个元素，并且您的选择器匹配（并附加）到这两个元素。

为您的追加使用更具体的选择器，您应该已准备就绪。

不幸的是，我不能推荐一种具体的方法，因为我不知道你的`stopImageUpload`函数是如何被调用的。如果它是由 jQuery 事件处理程序触发的，那么您可以在函数中引用“this”来获取触发事件的元素，并且您应该能够使用它来确定要附加到哪个 .listImage 。

如果它不是由事件处理程序触发的，那么我会想象任何调用它的函数都知道哪个文件输入触发了事情。

一旦你知道你真正想要附加到哪个元素，你就可以使用 jQuery 的 eq 方法/选择器来定位它。这里有几个例子：

```
$('.listImage:eq(0)') // selects the first listImage only
$('.listImage').eq(2) // selects the third listImage only 
```

# regex - 从 MS Access 中的字符串中提取/转换日期

> ID：10392009
> 
> 赞同：2
> 
> 时间：2012-04-30T23:55:55.583
> 
> 标签：regex, ms-access, vba

我正在尝试从具有以下模式的字符串中提取日期/时间，并将它们转换为 Access 中的日期类型。

1.  “2012 年 4 月 8 日 21:26:49”

2.  “......由 SMITH, MD, JOHN (123) 于 2012 年 4 月 2 日上午 11:11:01 确认；”

任何人都可以帮忙吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-01T00:09:10.657

试试这个

```
 Dim d As Date
    d = CDate("08-Apr-2012 21:26:49")
    Debug.Print Format(d, "dd-MMM-yyyy")
    Debug.Print Format(d, "h:m:s") 
```

会给

```
08-Apr-2012
21:26:49 
```

使用此正则表达式获取“on”（即空间上的空间）和“;”之间的日期时间 （之后的第一个分号）。

```
(?<=\ on )(.*?)(?=\;) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-01T10:52:26.153

正如罗密欧在[他的回答](https://stackoverflow.com/a/10392077/6884)中已经提到的那样，您需要使用`CDate()`将具有有效日期值的字符串转换为`Date`变量。

您可以像这样从字符串中获取日期值：（
假设字符串总是看起来像示例中的字符串，“on”（带空格）在日期之前和“;”之后）：

```
Public Function Test()

    Dim Source As String
    Dim Tmp As String
    Dim DateStart As Integer
    Dim DateEnd As Integer
    Dim DateValue As Date

    Source = "...Confirmed by SMITH, MD, JOHN (123) on 4/2/2012 11:11:01 AM;"

    'find the place in the source string where " on " ends
    DateStart = InStr(1, Source, " on ") + 4

    'find first semicolon after the date)
    DateEnd = InStr(DateStart, Source, ";")

    'get the part with the date
    Tmp = Mid(Source, DateStart, DateEnd - DateStart)

    'convert to date
    DateValue = CDate(Tmp)

End Function 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-01T12:16:59.933

将此函数添加到 VBA 模块：

```
' ----------------------------------------------------------------------'
' Return a Date object or Null if no date could be extracted            '
' ----------------------------------------------------------------------'
Public Function ExtractDate(value As Variant) As Variant
    If IsNull(value) Then
        ExtractDate = Null
        Exit Function
    End If

    ' Using a static, we avoid re-creating the same regex object for every call '
    Static regex As Object
    ' Initialise the Regex object '
    If regex Is Nothing Then
        Set regex = CreateObject("vbscript.regexp")
        With regex
            .Global = True
            .IgnoreCase = True
            .MultiLine = True
            .pattern = "(\d+\/\d+/\d+\s+\d+:\d+:\d+\s+\w+|\d+-\w+-\d+\s+\d+:\d+:\d+)"
        End With
    End If
    ' Test the value against the pattern '
    Dim matches As Object
    Set matches = regex.Execute(value)
    If matches.count > 0 Then
        ' Convert the match to a Date if we can '
        ExtractDate = CDate(matches(0).value)
    Else
        ' No match found, jsut return Null '
        ExtractDate = Null
    End If
End Function 
```

然后像这样使用它，例如在查询中：

```
SELECT ID, LogData, ExtractDate(LogData) as LogDate
FROM   MyLog 
```

确保检查返回的日期格式是否正确并且对您有意义。 `CDate()`根据您的语言环境以不同的方式解释日期字符串。

如果您没有得到想要的结果，您将需要修改代码以分离日期的各个组件并使用`DateSerial()`例如重建它们。

# java - 我怎样才能让这个 JButton 重新绘制我的模具图形？

> ID：10392010
> 
> 赞同：1
> 
> 时间：2012-04-30T23:56:20.387
> 
> 标签：java, swing, graphics, jbutton, graphics2d

这是我要实现鼠标按钮的主要类。我在 actionPerformed 区域中的代码有问题，让骰子获得一个新值并在按钮单击时在同一位置重新绘制自身

* * *

```
import java.awt.BorderLayout;
import java.awt.event.ActionEvent;
import java.awt.event.ActionListener;

import javax.swing.JButton;
import javax.swing.JFrame;
import javax.swing.JPanel;

public class Game 
{
private static Die die;
public static void main(String[] agrs)
{
    JFrame frame = new JFrame();

    JPanel panel = new JPanel();
    panel.setLayout(new BorderLayout());

    JButton roll = new JButton("roll");
    class RollListener implements ActionListener
    {
        public void actionPerformed(ActionEvent e)
        {
          die.roll();
                            //This is where it is just replacing the first die
                      die2.roll2();
        }
    }
    RollListener listener = new RollListener();
    roll.addActionListener(listener);
    panel.add(roll,BorderLayout.NORTH);

    die = new Die(20,20, Roll.die1());
    panel.add(die, BorderLayout.CENTER);

                //This im pretty sure wont add correctly its just overlapping the first die
                //but from what iv seen if i use different layouts it draws different and sometimes not at all.
                die2 = new Die(75,20,Roll.die2());
                panel.add(die2, BorderLayout.CENTER);

    frame.add(panel);

    //When program closed it terminates program execution
    frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
    //Makes frame visible
    frame.setVisible(true);
}
} 
```

这是我创建模具的模具类

* * *

```
import java.awt.Color;
import java.awt.Graphics;
import java.awt.Graphics2D;
import java.awt.Rectangle;
import java.awt.geom.Ellipse2D;

import javax.swing.JComponent;

public class Die extends JComponent
{
private static final long serialVersionUID = 1L;

//Variable for creating the die background
private Rectangle dieBorder;
//private int number = Roll.die1();
//Variable for creating the number of circles on die
private Ellipse2D numCircle;
private Ellipse2D numCircle2;
private Ellipse2D numCircle3;
private Ellipse2D numCircle4;
private Ellipse2D numCircle5;
private Ellipse2D numCircle6;
private Ellipse2D numCircle7;

      private int width = 50;
      private int height = 50;

/*
 * This constructs the DieComponent
 * with @param number. 
 */
public Die(int xPos, int yPos, int number1)
{
    number = number1;
    dieBorder = new Rectangle(xPos, yPos, width, height);

    numCircle = new Ellipse2D.Double(locationX(xPos, 2, 0), locationY(yPos, 2, 0), 8, 8);
    numCircle2 = new Ellipse2D.Double(locationX(xPos, 1, -7), locationY(yPos, 1, -7), 8, 8);
    numCircle3 = new Ellipse2D.Double(locationX(xPos, 1, -43), locationY(yPos, 1, -43), 8, 8);
    numCircle4 = new Ellipse2D.Double(locationX(xPos, 1, -7), locationY(yPos, 1, -43), 8, 8);
    numCircle5 = new Ellipse2D.Double(locationX(xPos, 1, -43), locationY(yPos, 1, -7), 8, 8);
    numCircle7 = new Ellipse2D.Double(locationX(xPos, 2, -18), locationY(yPos, 2, 0), 8, 8);
    numCircle6 = new Ellipse2D.Double(locationX(xPos, 2, 18), locationY(yPos, 2, 0), 8, 8);
}

/*
 * This will create the die graphics for 
 * the game. With @param g.
 */
public void paintComponent(Graphics g)
{
    Graphics2D g2 = (Graphics2D) g;
    super.paintComponent(g2);

    //Sets color of field
    g2.setColor(Color.RED);
    //Draws the die background
    g2.draw(dieBorder);
    //Fills in the background
    g2.fill(dieBorder);

    if(number == 1)
    {
    //Sets color to draw the circle with
    g2.setColor(Color.WHITE);
    //Draws the circle
    g2.draw(numCircle);
    //Fills in the circle
    g2.fill(numCircle);
    }

    if(number == 2)
    {
        g2.setColor(Color.WHITE);
        g2.draw(numCircle2);
        g2.draw(numCircle3);
        g2.fill(numCircle3);
        g2.fill(numCircle2);
    }

    if(number == 3)
    {
        g2.setColor(Color.WHITE);
        g2.draw(numCircle2);
        g2.draw(numCircle3);
        g2.draw(numCircle);
        g2.fill(numCircle3);
        g2.fill(numCircle2);
        g2.fill(numCircle);
    }

    if(number == 4)
    {
        g2.setColor(Color.WHITE);
        g2.draw(numCircle2);
        g2.draw(numCircle3);
        g2.draw(numCircle4);
        g2.draw(numCircle5);
        g2.fill(numCircle3);
        g2.fill(numCircle2);
        g2.fill(numCircle4);
        g2.fill(numCircle5);

    }

    if(number == 5)
    {
        g2.setColor(Color.WHITE);
        g2.draw(numCircle);
        g2.draw(numCircle2);
        g2.draw(numCircle3);
        g2.draw(numCircle4);
        g2.draw(numCircle5);
        g2.fill(numCircle3);
        g2.fill(numCircle2);
        g2.fill(numCircle4);
        g2.fill(numCircle);
        g2.fill(numCircle5);
    }

    if(number == 6)
    {
        g2.setColor(Color.WHITE);
        g2.draw(numCircle2);
        g2.draw(numCircle3);
        g2.draw(numCircle4);
        g2.draw(numCircle5);
        g2.draw(numCircle6);
        g2.draw(numCircle7);
        g2.fill(numCircle3);
        g2.fill(numCircle2);
        g2.fill(numCircle4);
        g2.fill(numCircle5);
        g2.fill(numCircle6);
        g2.fill(numCircle7);
    }
}

public static int locationX(int xPos, int spot, int move)
{
    int xPosition = (xPos + 50 / spot) - 4 + move;

    //Returns the x position of where the circle should be
    return xPosition;
}

/*
 * This method will get the height of 
 * the border of the die and formulate where
 * to place the y position of the numCircle based
 * on value of die and uses spot to determine where
 * to draw circle.
 */
public static int locationY(int yPos, int spot, int move)
{
    //Formula to calculate position of circle
    int yPosition = (yPos + 50 / spot) - 4 + move;

    //Returns the y position of where circle should be
    return yPosition;
}

      public void roll()
      {
         number = Roll.die1();
         repaint();
      }
      //This is where i think im messing up cuz it just replaces the first die
      public void roll2()
      {
        number = Roll.die2();
        repaint();
      }
} 
```

这是我的掷骰子类别，可以获得骰子的价值

* * *

```
import java.util.Random;

/*
* This class sets up methods that 
* retrieve what random number is to
* be displayed on the die for each 
* one.
*/
public class Roll 
{
//Sets up var for die1
private static int die1;
//Sets up var for die2
private static int die2;

/*
 * This method creates the die1
 * and it assigns a random number
 * between 1-6 to the die.
 */
public static int die1()
{
    //Create random number generator
    Random gen = new Random();

    //Uses generator to assign number
    die1 = gen.nextInt(6) + 1;

    //Returns die1 value
    return die1;
}

/*
 * This method creates die2 and 
 * assigns a random number between
 * 1-6 to the die.
 */
public static int die2()
{
    //Create random number generator
    Random gen2 = new Random();

    //Uses generator to assign number
    die2 = gen2.nextInt(6) + 1;

    //Returns die2 value
    return die2;
}

/*
 * This method gets the value of both
 * die1 and die2 and adds them together.
 * This will allow the game to decide
 * what bets win and what bets lose.
 */
public static int total()
{
    //Gets die1 and die2 and adds them
    int total = die1 + die2;
    //Returns total value
    return total;
}
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-01T01:59:27.313

我认为你需要改变你的 Die 类并给它一个 roll() 方法，它调用 Roe 的 die1() 方法并将 number 字段设置为这个值并调用 repaint。在半伪代码中：

```
public void roll() {
   Use Roll to get a new int value
   set number field to this new int value
   call repaint on itself
} 
```

然后在ActionListener的`actionPerformed(...)`调用这个新方法上显示的Die对象。

# objective-c - Cocos2d 内存管理的推荐限制？

> ID：10392027
> 
> 赞同：4
> 
> 时间：2012-04-30T23:59:57.650
> 
> 标签：objective-c, memory-management, cocos2d-iphone

Cocos2d中的图片有没有推荐的限制，是否太大，占用太多内存？是否有一些规则，无论是尺寸还是 Kb，以避免减慢游戏速度？（对于背景图像，或我的角色图形（即使我使用批处理节点）？）

感谢您的回答

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-05-02T20:25:02.273

首先，内存使用与性能的关系非常非常小。您可以用纹理填充整个内存，游戏不会在意。当您渲染它们时，它们会有所不同。然后只关心你用纹理填充了多少屏幕区域，它们被覆盖、批处理、旋转、缩放、着色和 alpha 混合的程度。这些是纹理渲染性能的主要因素。内存使用起着非常微不足道的作用。

你可能对我做的[cocos2d sprite-batch 性能测试](http://www.learn-cocos2d.com/2011/09/cocos2d-spritebatch-performance-test/)和一般[cocos2d 性能分析](http://www.learn-cocos2d.com/2011/11/depth-ios-cocos2d-performance-analysis-test-project/)感兴趣。两者都带有测试项目。

至于最大纹理尺寸，请查看我的[Learn Cocos2D](http://www.learn-cocos2d.com/store/book-learn-cocos2d/)书中的表格： ![在此处输入图像描述](../Images/e6e8bda9b47dbcd79d87142d1e49a928.png)

请注意，iPhone 和 iPhone 3G 设备的纹理内存限制为 24 MB。第 3 代 (iPhone 3GS) 和更新的设备不再有这个限制。另请记住，虽然设备可能安装了 256 MB 内存，但可供应用程序使用的内存将大大减少。

例如，在 iPad（第 1 代）上，建议不要使用超过 100 MB 的内存，最大可用内存在 125 MB 左右达到峰值，并且内存警告开始显示早在 80-90 MB 内存使用量左右。

在 iOS 5.1 中，Apple 还增加了 iPad 2 的最大纹理大小。最安全和最常用的纹理大小是 Retina 纹理的 2048x2048，标准分辨率纹理的 1024x1024。

表中没有 iPod touch 设备，因为它们实际上与同一代 iPhone 型号相同，但不那么容易识别。例如，第 3 代 iPod touch 包括具有 8、16 和 32GB 闪存的设备，但 8GB 型号实际上是第 2 代硬件。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-01T08:01:38.323

图像和纹理的尺寸取决于您支持的设备。较旧的设备支持小层，我认为大小为 2048x2048。我认为当前设备上不存在这种限制。

对于大图像，您肯定希望使用批处理节点，因为它们已经过测试，以展示在处理大图像时最大的性能增益。虽然一般来说尽可能多地使用它们是个好主意。

至于你能加载多少，这真的取决于设备。新 iPad 具有 1 GB 内存，旨在为大图像提供更多可用内存。第一代 iPad 有 1/4 的内存量，根据我的经验，当它使用大约 100 MB 内存时我开始看到应用程序崩溃（使用 Instruments 确认）。

诀窍是只使用当前应用程序操作所需的内存，然后在您移动到新场景或新的图像/精灵/纹理集时释放它。例如，您可以拥有非常大的平铺纹理，其中只有最靠近视口的平铺被加载到内存中。如果您从内存中删除那些在屏幕上不可见的视图部分，从技术上讲，您可以拥有一个无限大小的视图，该视图将永远延伸。

当然，在处理大量资源时，请确保您的应用程序委托对其内存警告做出适当响应。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-01T05:04:29.053

据我所知.. 大小为 1024x1024 的批处理节点占用大约 4 MB 的空间，这只是纹理内存.. 应用程序的最大限制为 24 MB。因此，当您达到这 24 MB 空间时，游戏会变慢并在此之后崩溃。为了避免速度变慢，我一次最多使用 4 个批处理节点，即 16 MB。剩下 8 MB 用于变量和其他数据。在使用更多批处理节点之前，我曾经清理内存并删除未使用的批处理节点。我不知道 4 秒内的内存限制，但对于 iPhone 4，这是我学到的。考虑到这个逻辑，我曾经流畅地运行我的游戏。

# connection - 使用 JDBC 或 ODBC 连接到多个 SQL Anywhere 11 服务器

> ID：10392028
> 
> 赞同：1
> 
> 时间：2012-04-30T23:59:58.763
> 
> 标签：connection, odbc, sqlanywhere, database-server

这是我的情况。我有一个应用程序 (Mirth Connect) 在与 SQL Anywhere 11 相同的服务器上运行。同一网络上还有另一台服务器在运行 SQL Anywhere 11。我需要连接到它们。它们都使用相同的 SQL Anywhere“服务器名称”。

我需要在任何给定时刻使用 JDBC 连接来连接它们中的任何一个。我可以很好地连接到本地实例。

我尝试建立到远程服务器的 ODBC 连接。当我测试连接时，它说一切都很好。然后，当我尝试运行查询时，我注意到我已连接到本地服务器。这一定是因为两个 SQL Anywhere 服务器都使用相同的“服务器名称”。

如何强制 ODBC 连接连接到远程服务器？

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-02T02:22:01.357

您需要在连接字符串中指定 IP 地址（和端口，如果不使用默认值）。您的连接字符串必须包含 LINKS 参数，并带有（至少）以下选项：

```
LINKS=tcpip(HOST=<remote IP address>;PORT=<remote port>;DoBroadcast=None) 
```

如果远程服务器使用默认端口号 2638，则无需在连接字符串中指定端口号。`DoBroadcast=None`告诉客户端库它应该直接连接到该主机。默认（对于版本 11 和更早版本）是在网络上广播以查找该服务器名称，并且首先响应的服务器获胜。由于本地机器上有服务器，所以很有可能先响应。

对于版本 12 及更高版本，您可以将整个 LINKS 参数替换为新的 HOST 参数：

```
HOST=<remote IP address>:<remote port> 
```

这将与上面的 LINKS 参数具有相同的行为。

PS 建议您给每个服务器一个唯一的服务器名称，从而避免硬编码主机的 IP 地址。更不用说您必须使用一些技巧来欺骗第二台服务器（a）认为它的名称是唯一的，或者（b）不检查它是否是唯一的，默认情况下它会这样做。如果您使用唯一的服务器名称，则不需要这些额外的东西。

*免责声明：我在 Sybase 的 SQL Anywhere 工程部门工作。*

# sql-server-2008 - 分组，有排名和总和 - 没有得到正确的输出

> ID：10392029
> 
> 赞同：0
> 
> 时间：2012-05-01T00:00:14.490
> 
> 标签：sql-server-2008, sql-server-2005

我正在尝试用排名函数和按月分组的列求和，我的代码是

```
 select  dbo.UpCase( REPLACE( p.Agent_name,'.',' '))as Agent_name, SUM(convert ( float ,   
  p.Amount))as amount,   
  RANK() over( order by  SUM(convert ( float ,Amount )) desc ) as arank 
  from  dbo.T_Client_Pc_Reg p  
  group by   p.Agent_name ,p.Sale_status ,MONTH(Reg_date)
  having [p].Sale_status='Activated' 
```

目前，我正在获取该列的所有总价值，而不是按月计算

```
Name  amount rank 
a     100    1
b     80     2
c     50     3 
```

100 是到目前为止的总金额，但是，我想获得当前月份的总金额，而不是上个月的总金额..

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-01T00:19:35.577

也许您只需要添加一个 WHERE 子句？这是一个小的重写，我认为通常效果更好。tempdb 中的一些设置：

```
USE tempdb;
GO

CREATE TABLE dbo.T_Client_Pc_Reg
(
  Agent_name VARCHAR(32),
  Amount INT,
  Sale_Status VARCHAR(32),
  Reg_date DATETIME
);

INSERT dbo.T_Client_Pc_Reg 
          SELECT 'a', 50, 'Activated', GETDATE()
UNION ALL SELECT 'a', 50, 'Activated', GETDATE()
UNION ALL SELECT 'b', 20, 'Activated', GETDATE()
UNION ALL SELECT 'b', 20, 'Activated', GETDATE()
UNION ALL SELECT 'b', 20, 'Activated', GETDATE()
UNION ALL SELECT 'b', 20, 'Activated', GETDATE()
UNION ALL SELECT 'b', 20, 'NotActivated', GETDATE()
UNION ALL SELECT 'c', 25, 'Activated', GETDATE()
UNION ALL SELECT 'c', 25, 'Activated', GETDATE()
UNION ALL SELECT 'c', 25, 'Activated', GETDATE()-40; 
```

然后查询：

```
SELECT 
  Agent_name = UPPER(REPLACE(Agent_name, '.', '')),
  Amount = SUM(CONVERT(FLOAT, Amount)),
  arank = RANK() OVER (ORDER BY SUM(CONVERT(FLOAT, Amount)) DESC)
FROM dbo.T_Client_Pc_Reg
WHERE Reg_date >= DATEADD(MONTH, DATEDIFF(MONTH, 0, CURRENT_TIMESTAMP), 0)
  AND Reg_date <  DATEADD(MONTH, DATEDIFF(MONTH, 0, CURRENT_TIMESTAMP) + 1, 0)
  AND Sale_status = 'Activated'
GROUP BY UPPER(REPLACE(Agent_name, '.', ''))
ORDER BY arank; 
```

现在清理：

```
USE tempdb;
GO
DROP TABLE dbo.T_Client_Pc_Reg; 
```

# sql - 更改数据库架构但保持数据访问兼容

> ID：10392030
> 
> 赞同：0
> 
> 时间：2012-05-01T00:00:18.937
> 
> 标签：sql, triggers

我正在开发一个相当大的项目，将软件重写为 .Net C#。原始软件是用 Visual DataFlex for DOS 编写的，用于将数据存储在每个表的单独文件中，我们现在为原始软件使用驱动程序，这意味着数据库现在是 SQL。但我认为真正需要在数据库模式中进行更改。我想知道的是我们是否可以为数据库编写 SQL 触发器，这样当驱动程序尝试访问旧的数据库模式时，我们也会将数据设置到新的数据库模式中，这样我们就可以更改它但保持一切正常. 我以前不必使用触发器，所以我不确定这是否可行，或者它可能有什么缺点或问题。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-07-16T00:42:17.270

我离开了正在重写这个系统的项目，但从那时起我就使用 Views 来改变数据结构的显示方式，并且更多地使用了触发器，我同意关于这个问题的评论，因为改变架构是一项艰巨的工作最好先专注于重写代码，然后以以后可以处理模式更改的方式编写代码。

# clipboard - 使用 Sikuli 或 Jython 时清除 Windows 的剪贴板

> ID：10392033
> 
> 赞同：3
> 
> 时间：2012-05-01T00:00:47.530
> 
> 标签：clipboard, jython, sikuli

我正在尝试使用 Sikuli 或 Jython 清除 Windows 的剪贴板。

我目前正在使用剪贴板从文本框中获取用户输入的文本。我使用剪贴板检查用户是否在单击按钮之前输入了文本。我想检查在单击按钮之前文本框是否为空。

我遇到的问题是，一旦使用剪贴板，我就无法清除它。因此，每次单击按钮时，剪贴板中的值都会返回到我的脚本中。

我需要能够在抓取用户输入的文本后清除剪贴板，或者找到一种不使用剪贴板来读取文本框的方法。

帮助。

提前致谢，

马旺

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-05-01T04:03:52.930

使用 Jython，您可以执行以下操作将剪贴板的内容设置为空字符串，这类似于清除它。

```
from java.awt.datatransfer import StringSelection
from java.awt.datatransfer import Clipboard
from java.awt import Toolkit

toolkit = Toolkit.getDefaultToolkit()
clipboard = toolkit.getSystemClipboard()
clipboard.setContents(StringSelection(""), None) 
```

并如下以字符串形式读取剪贴板的内容：

```
from java.awt.datatransfer import DataFlavor
contents = clipboard.getContents(None)
print contents.getTransferData(DataFlavor.stringFlavor) 
```

# windows - AWS CloudFormation 和 Windows Server 2008 R2 用于引导文件下载

> ID：10392037
> 
> 赞同：1
> 
> 时间：2012-05-01T00:01:24.267
> 
> 标签：windows, download, bootstrapping, amazon-cloudformation

AWS 最近发布了一个新的 AMI，它在其 Windows Server 2008 R2 上默认安装了 CloudFormation 工具。AMI 本身可以在这里找到：[ [https://aws.amazon.com/amis/microsoft-windows-server-2008-r2-base-cloudformation]](https://aws.amazon.com/amis/microsoft-windows-server-2008-r2-base-cloudformation])

当直接在 CloudFormation 模板中使用此 AMI 并启动堆栈时，我可以轻松启动我的堆栈，并且实例在启动过程中毫无问题地下载位于 S3 中的文件，所有由 cfn-init 命令创建的文件夹也可以是正如预期的那样。

但是，如果我修改 AMI 以对其进行自定义（仅启用 IIS）并重新创建一个新的 AMI 并在模板中使用此 AMI，则文件不会被下载，其他文件夹也不会被 cfn-init 命令创建可见。

有什么建议么 ？！我错过了什么吗？！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-02T16:16:47.360

最可能的原因是自定义 AMI 是在未使用[EC2Config 服务的](http://docs.amazonwebservices.com/AWSEC2/latest/WindowsGuide/UsingConfig_WinAMI.html)捆绑选项卡的情况下创建的。

Windows 上的 CloudFormaion 支持取决于 EC2Config 服务在首次启动时运行用户数据中指定的命令的功能。此功能在首次启动后自动禁用，以便后续启动不会导致重新运行相同的命令。

如果自定义 AMI 是使用 EC2Config 的 Bundle 选项卡创建的，它可以确保生成的 AMI 启用了用户数据命令执行功能。因此，有必要（并且始终推荐）使用 EC2Config 的 Bundle 选项卡创建自定义 AMI。

希望这可以帮助。

问候， 肖恩

# sql - 如何使此 SQL 代码更快？

> ID：10392044
> 
> 赞同：0
> 
> 时间：2012-05-01T00:03:01.913
> 
> 标签：sql, ms-access, asp-classic, vbscript

每个人都希望我更具体。我正在尝试使用 asp classic 和 ms-access 数据库进行分页。这是我用来获取第 2 页的项目的查询。每页有 25 个项目，当查询返回更大的数据集（例如大约 500+）时，执行大约需要 20+ 秒，是的，我已将 sku 编入索引更快的查询。有什么建议么。

```
SELECT TOP 25 *
FROM catalog
WHERE sku LIKE '1W%'
AND sku NOT IN (SELECT TOP 25 sku
                FROM catalog
                WHERE sku LIKE '1W%' ORDER BY price DESC ) ORDER BY price DESC 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-01T01:50:40.987

`TOP`without`ORDER BY`看起来没用或至少很奇怪。我猜你打算使用这个子查询：

```
( SELECT TOP 25 sku
  FROM catalog
  WHERE sku LIKE '1W%' 
  ORDER BY sku
) 
```

* * *

`sku`如果没有，请在 上添加索引。

对于 Access，可能会重写查询：

```
SELECT *
FROM catalog
WHERE sku LIKE '1W%'
AND sku >= ( SELECT MAX(sku)
             FROM ( SELECT TOP 26 sku
                    FROM catalog
                    WHERE sku LIKE '1W%' 
                    ORDER BY sku 
                  )
           ) 
```

如果您使用的是 SQL-Server，则可以对此类查询使用窗口函数。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-08T06:51:54.477

一些指示：

*   `SELECT BOTTOM (n)`您可以通过使用`TOP (n)`和反转 ORDER BY来模拟 a
*   您可以使用嵌套 SELECT（创建临时表）

因此，“分页”查询的最终结果是（后续页面将 50 替换为 75、100、125，...）：

```
SELECT TOP 25 *
FROM
(
SELECT TOP 50 *
FROM  catalog
WHERE sku LIKE '1W%'
ORDER BY price desc
)
TEMP
ORDER BY price asc; 
```

尽管您提到您已经为您的数据建立了索引，但是为了完全清楚，为了获得最佳性能，您应该确保您的所有表都为您的查询建立了充分的索引。在这种情况下，我建议**至少**查询中涉及的两列：

```
CREATE INDEX IX_CATALOG ON CATALOG (SKU, PRICE); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-01T00:24:24.673

您要做的是从表中选择满足特定条件的所有行，而不是前 25 行。不幸的是，不同的数据库管理系统有自己的语法来做这种事情。

在[Wikipedia 页面上对 SQL select 语句](http://en.wikipedia.org/wiki/Select_%28SQL%29#Limiting_result_rows)的不同语法进行了很好的调查。

举个例子，在 MySQL 中，您可以使用[SELECT 语句的 LIMIT 子句](http://dev.mysql.com/doc/refman/5.5/en/select.html)来指定要返回的行数和偏移量：

```
SELECT *
FROM catalog
WHERE sku LIKE '1W%'
ORDER by id
LIMIT 25, 9999999999 
```

它返回查询结果的第 26 行到第 9999999999 行。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-01T01:20:43.353

在 sku 列上创建索引（如果有效，使其唯一）。表中有多少行？

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-05-01T02:21:16.340

```
SELECT sku
FROM catalog
WHER sku LIKE '1W%
ORDER BY __SOME COLUMN __
LIMIT 10000 OFFSET 25 
```

这将返回数据库中第 25 行 ( ) 之后的所有行`OFFSET 25`。

*`LIMIT 10000`将生成的查询限制为 10000 个元组（行）。

为确保您没有得到 random `OFFSET`，您需要按某个列排序。

# objective-c - Telnet IAC 命令（NSStream 套接字）

> ID：10392045
> 
> 赞同：1
> 
> 时间：2012-05-01T00:03:03.540
> 
> 标签：objective-c, cocoa, telnet

我已经制作了一个`NSStream`套接字来连接到远程登录服务器。实际上，它可以很好地连接到服务器；我得到了`inputStream`服务器的“第一句话”，但我不明白。我正在寻找有关 telnet IAC 命令的一些解释。

这是我从服务器接收的代码：

```
 case NSStreamEventHasBytesAvailable:

            if (theStream == inputStream) {

                uint8_t buffer[1024];
                int len;

                while ([inputStream hasBytesAvailable]) {
                    len = [inputStream read:buffer maxLength:sizeof(buffer)];
                    if (len > 0) {

                        NSString * serverSaid = [[NSString alloc] initWithBytes:buffer length:len encoding:NSASCIIStringEncoding];

                        if (nil != serverSaid) {
                            NSLog(@"The server said: %@", serverSaid);
                            [connectLog insertText:serverSaid];
                            [connectLog insertText:@"\r"];
                        }
                    }
                }
            }

            break; 
```

它基于 EventHasBytesAvailable。它工作正常（通过登录提示从服务器获得你好）。

现在，要发送到服务器，我这样做：

```
NSString * theMsg  = [NSString stringWithFormat:@"root"];
NSData * msgToSend = [[NSData alloc] initWithData:[theMsg dataUsingEncoding:NSUTF8StringEncoding]];
[outputStream write:[msgToSend bytes] maxLength:[msgToSend length]]; 
```

我在一个按钮上编写了输出脚本，看看当我使用输出流时会发生什么： EventHasBytesAvailable 捕获我的输出有输入......服务器告诉我我告诉他的内容！

有人可以向我解释 IAC 命令和/或如何继续登录服务器并发送命令吗？

# c# - 需要实体框架来忽略模型成员

> ID：10392052
> 
> 赞同：1
> 
> 时间：2012-05-01T00:04:29.443
> 
> 标签：c#, vb.net, asp.net-mvc-3, entity-framework

我们需要存储从另一个表中提取的与我们的模型之一相关的数据列表。（我们构建得太深，无法将此关系添加到我们的数据库中应该在的位置。）当我们尝试将此列表加载到需要它的模型的属性中时。

我们将此列表加载到视图中的下拉列表中。尝试将此列表加载到控制器中的模型时发生错误。真正需要注意的是，我们在视图中的表中的每条记录都有一个唯一的下拉列表。

我们班：

```
Public class OurModel
  public property ID As Integer
  Public property First As Integer
  Public property Last As Integer
  Public property myList As List(Of SelectListItem)//This is our problem member
End class 
```

控制器：

```
 //This ViewModel is what we pass around from page to page to populate the various elements we need that is not tied to a specific model
Public Function LoadList(myViewModel As ViewModel) As Action Result
   Using db //our database resource 
    For i As Integer = 0 to myViewModel.OurModel
       //Assume table select statement previously declared and initialized into dbGet
       **NOTE: dbGet is retieving data from a different table that is tied to this Model**
       dbGet = dbGet.Where(Function(x) x.ID = myViewModel.OurModel.ID)
       myViewModel.OurModel.myList = dbGet.ToList().[Select](Function(x) New SelectListItem() With {.Value = x.number, .Text = x.number})//ERROR IS HERE
    Next
   End Using
End Function 
```

错误：

**LINQ to Entities 无法识别方法“DB.ModelTable get_Item(Int32)”方法，并且该方法无法转换为存储表达式。**

**更新：**问题似乎是 LINQ 正在尝试对我之前在此控制器中执行的查询的 DBContext 执行某些操作。错误引用`DB.Employee`不是`DB.Position`我要查询的内容。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-01T00:11:53.890

我在 VB.Net 中几乎什么都没做，但听起来 get_Item(Int32) 可能与 C# 中的索引器相同。

有一个众所周知的缺点，即 Entity Framework 不支持包含索引器的类（即使您使用 装饰该属性`NotMapped`）。

我遇到了类似的问题，即实现可锁定的 ObservableCollection。我发现`IList<T>`由于[EF 中的索引器问题](https://stackoverflow.com/questions/8351303/entity-framework-code-first-and-classes-that-implement-ilistt)我无法实现，但我可以实现`ICollection<T>`。

[锁定/解锁 ObservableCollection<T>](https://stackoverflow.com/questions/9013060/lock-unlock-observablecollectiont/9013479#9013479)

如果您可以用集合的语义替换列表的语义，那应该可以解决这个问题。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-05-01T20:28:10.713

我最终不得不编写连接到实体框架之外的数据库的新类。如果您想使用实体框架，请在开始构建应用程序之前确保您的数据库设计是完美的，祝您好运。

# python - 使用空字符串查找方法

> ID：10392054
> 
> 赞同：0
> 
> 时间：2012-05-01T00:04:46.747
> 
> 标签：python, string, substring

为了更好地理解它，我正在玩一个任务的函数。它旨在查找字符串中子字符串的最后一次出现。该函数应该返回子字符串最后一次出现的开始位置，或者如果根本没有找到子字符串，它必须返回 -1。“标准”方式如下：

```
def find_last(full, sub):
    start = -1
    while True:
        new = full.find(sub, start + 1)
        if new == -1:
            break
        else:
            start = new
    return start 
```

我想尝试让它反向搜索，因为这似乎是更有效的方式。所以我尝试了这个：

```
def find_last(full, sub):
    start = -1
    while True:
        new = full.find(sub, start)
        if new == -1 and abs(start) <= len(full): #evals to False when beginning of string is reached
            start -= 1
        else:
            break
    return new 
```

我们得到了一些需要通过的测试用例，而我的反向函数只通过了一个：

```
print find_last('aaaa', 'a')
>>>3
print find_last('aaaaa', 'aa')
>>>3
print find_last('aaaa', 'b')
>>>-1
print find_last("111111111", "1")
>>>8
print find_last("222222222", "")
>>>8 #should be 9
print find_last("", "3")
>>>-1
print find_last("", "")
>>>0 
```

有人可以解释一下为什么 find 在负索引的情况下会这样吗？或者这只是我的代码中的一些明显错误？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-01T00:08:59.477

可以在任何位置找到空字符串。初始化`start`使`-1`您的算法从倒数第二个位置开始搜索，而不是最后一个。

最后一个位置*在*字符串的最后一个字符之后，但您开始查看字符串*的*最后一个字符。

# c# - 我怎么知道midi输入是否连接到midi输出？

> ID：10392056
> 
> 赞同：1
> 
> 时间：2012-05-01T00:05:14.127
> 
> 标签：c#, api, winapi, audio, midi

我正在制作一个 midi 编辑器，它有一个用于连接/断开 midi 输入到输出的对话框，因此用户可以让其他程序运行 midi，并通过虚拟 midi 端口（如 maple）回显相同的输入。

它使用 midiConnect 功能，但我想在 UI 中显示已经存在的当前 midi 连接。

我能想到的唯一方法是尝试将每个输入连接到每个输出，如果函数返回错误，则表示连接已经存在，但这有点混乱，它可以改变当前连接的状态明显地。

有没有办法检索哪个输入连接到哪个输出？

# python - 要求一个人保存一个文件

> ID：10392061
> 
> 赞同：0
> 
> 时间：2012-05-01T00:06:29.617
> 
> 标签：python

我想做的是向用户询问要制作的文件的名称，然后在该文件中保存一些内容。

我的程序部分如下所示：

```
 if saving == 1:
        ask=raw_input("Type the name file: ")
        fileout=open(ask.csv,"w")
        fileout.write(output) 
```

我希望格式为 .csv，我尝试了不同的选项，但似乎无法正常工作。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-01T00:08:43.973

这里的问题是您需要传递`open()`一个字符串。`ask`是一个包含字符串的变量，但我们还想将另一个字符串附加`".csv"`到它以使其成为文件名。在 python`+`中是字符串的连接运算符，所以`ask+".csv"`表示*ask 的内容，后跟 .csv*。您当前所拥有的是寻找变量的`csv`属性`ask`，这将引发错误。

```
with open(ask+".csv", "w") as file:
    file.write(output) 
```

如果用户已经输入了扩展名，您可能还想先检查一下：

```
ask = ask if ask.endswith(".csv") else ask+".csv"
with open(ask, "w") as file:
        file.write(output) 
```

请注意我在打开文件时使用[该`with`语句。](http://docs.python.org/py3k/reference/compound_stmts.html#the-with-statement)这是一种很好的做法，因为它更具可读性并确保文件正确关闭，即使出现异常也是如此。

我在这里也使用python[三元运算符](http://docs.python.org/py3k/reference/expressions.html#conditional-expressions)来根据条件进行简单的变量赋值（如果它已经以 结尾，则设置询问自身`".csv"`，否则将其连接起来）。

此外，这是假设您的输出已经适合 CSV 文件，仅扩展名不会使其成为 CSV。通常在处理 CSV 数据时，您可能需要查看[csv 模块](http://docs.python.org/py3k/library/csv.html)。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-01T00:08:51.783

您需要使用`ask+'.csv'`将所需的扩展名连接到用户输入的末尾。

但是，仅使用扩展名命名文件`.csv`不足以使其成为逗号分隔的文件。您需要格式化输出。用来[`csvwriter`](http://docs.python.org/library/csv.html)做那个。python 文档有一些关于如何执行此操作的[简单示例。](http://docs.python.org/library/csv.html#examples)

我建议您不要尝试自己生成格式化的逗号分隔输出。这是一项非常艰巨的任务，而且在内置功能的情况下完全没有意义。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-01T00:09:49.850

您的变量`ask`将`string`在`raw_input`. 因此，如果您想将扩展名 .csv 附加到它，您应该这样做：

```
fileout = open(ask + ".csv", "w") 
```

那应该行得通。

# c++ - 使用范围解析运算符时的语法错误

> ID：10392069
> 
> 赞同：0
> 
> 时间：2012-05-01T00:08:05.263
> 
> 标签：c++, syntax, scope, operator-keyword, nested

我不断收到语法错误

```
“错误：预期';' 在“一个”之前
```

就行了 `AVL_Tree<val_type>::node_type a;` 使用Netbeans下的Cygwin gcc编译器。

在“MyMap.h”类中

```
#include "AVL_Tree.h"
template <class key_type,class mapped_type>
class MyMap
{
public:
    class iterator
    {
        private:
            AVL_Tree<val_type>::node_type a;
    };
}; 
```

在文件“AVL_Tree.h”中

```
 template <class T>

 class AVL_Tree
 {
 public:
    struct AVLNode
    {
        int balanceFactor;
        T element;
        AVLNode * left;
        AVLNode * right;

        AVLNode(T key)
        {
            left = 0;
            right = 0;
            element = key;
            balanceFactor = 0;
        }
       typedef AVLNode * node_type;
    }; 
```

我的印象是我能够使用范围运算符访问“node_type”，因为 AVL_Tree 中的 typedef 是公共的。语法错误对于说明到底发生了什么并没有多大帮助。非常感谢任何帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-01T00:13:33.203

您需要使用`typename`因为`node_type`是依赖类型。另外，`node_type`在里面`AVLNode`：

```
typename AVL_Tree<val_type>::AVLNode::node_type a; 
```

# c# - 如何在模型中查询数据库？

> ID：10392076
> 
> 赞同：1
> 
> 时间：2012-05-01T00:09:04.567
> 
> 标签：c#, asp.net-mvc, entity-framework

**注意：**这是对上一个问题的完整重写。

我有一个模型。

```
class Paragraph
{
    public int Id { get; set; }

    public int SectionId { get; set; }
    public virtual Section Section { get; set; }

    public int Major { get; set; }
    public int Option { get; set; }

    public ICollection<Paragraph> Options
    {
        get
        {
            // What I'm trying to return is:
            //
            //     Section.Paragraphs
            //     .Where(p => p.Major == Major && p.Option != Option)
            //     .ToList()
        }
    }
} 
```

它涉及`one to many`关系；每个`Section`都有很多`Paragraphs`。我要返回的是一个段落列表，其中它们`Major`与实体的相同，`Major`而`Option`不同。基本上。

```
Where(p => p.Major == Major && p.Option != Option) 
```

关于如何做到这一点的任何建议？谢谢你。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-01T00:14:26.740

您希望您的`Section`属性不为空。大概您有一个`Section`具有 type`List<Paragraph>`或类似属性的类，因为您将这种情况描述为一个模型“属于”另一个模型。

如果您认为仅仅因为您的段落包含在一个部分中，您将免费获得某种互惠，那您就错了。你必须自己去维护这种关系。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-03T02:01:10.473

我解决了。呜呜！我所做的只是检查是否`Section`为空，如果是，我返回一个空白`List<Paragraph>`。就这样`Options`变成了。

```
 public ICollection<Paragraph> Options
    {
        get
        {
            if (Section != null)
            {
                return Section.Paragraphs
                    .Where(p => p.Major == Major && p.Option != Option)
                    .ToList();
            }
            else
            {
                return new List<Paragraph>();
            }
        }
    } 
```

# iphone - 从 iPhone 到 Python/Django 的表情符号

> ID：10392079
> 
> 赞同：5
> 
> 时间：2012-05-01T00:10:09.930
> 
> 标签：iphone, python, django, emoticons

我正在尝试保存 iPhone 应用程序中的评论，该应用程序可能并且现在最有可能*包含*表情符号。无论我做什么，我都无法将表情符号保存到 MySQL 数据库中……不断出现 Unicode 错误。

*   Python 2.6.5
*   Django 1.2.1
*   MySQL 数据库（表和行设置为 utf8 字符集）
*   将数据保存到 VARCHAR(255) 字段

我不断收到的错误是：

```
Incorrect string value: '\xF0\x9F\x97\xBC \xF0...' for column 'body' at row 1 
```

我传入数据库的字符串是：

```
test_txt = u"Emoji - \U0001f5fc \U0001f60c \U0001f47b ...".encode('utf-8') 
```

**更新**：这是我正在使用的模型：

```
class ItemComment(db.Model):
  item = db.ForeignKey(Item)
  user = db.ForeignKey(Profile)
  body = db.CharField(max_length=255, blank=True, null=True)

  active = db.BooleanField(default=True)
  date_added = db.DateTimeField(auto_now_add=True)

  def __unicode__(self):
    return "%s" % (self.item) 
```

奇怪的是，如果我尝试将其传递给我在 MySQL 而不是 Django models.py 中创建的字段，它可以正常工作。但是，一旦我在 Django 模型中注册了该字段，它就会死掉。有没有另一种方法来存储这些可能？

任何想法都会很棒。
我不能更坚持这一点......

**更新 2**：使用以下 UPDATE 语句在终端中跟踪它（注意 U0001f5fc）

```
UPDATE 'table' SET 'body' = '', WHERE 'table'.'id' = 1 ; args=(u'\U0001f5fc') 
```

尽可能使用核心来传递价值：

```
force_unicode(smart_str(value), encoding='utf-8', strings_only=False, errors='ignore') 
```

但错误仍然抛出：

```
_mysql_exceptions.Warning: Incorrect string value: '\xF0\x9F\x97\xBC' for column 'body' at row 1 
```

彻底输了！！！

干杯，

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-04T05:10:33.383

更改 MySQL 服务器的字符集 utf8mb4（5.5.3 以后的版本）

在`my.ini`( `my.cnf`)

```
[mysqld]
character_set_server = utf8mb4
collation-server = utf8mb4_unicode_ci 
```

或 SQL 查询

```
SET NAMES 'utf8mb4'; 
```

另见[http://dev.mysql.com/doc/refman/5.5/en/charset-connection.html](http://dev.mysql.com/doc/refman/5.5/en/charset-connection.html)

或删除角色来执行此操作。

Python

```
import re
# emoji_text is unicode
no_emoji_text = re.sub('[\xF0-\xF7][\x80-\xBF][\x80-\xBF][\x80-\xBF]', '', str(emoji_text)) 
```

谢谢你。

另见 [MySQL throws Incorrect string value error](https://stackoverflow.com/questions/8709892/mysql-throws-incorrect-string-value-error)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-11-06T09:40:53.427

我使用 Django 1.11 及以下版本`setting.py`，创建`sql`可以很好地存储表情符号，

```
DATABASES = {
    'default': {
        'ENGINE': 'django.db.backends.mysql',
        'NAME': 'db_name',
        'USER': 'db_user',
        'PASSWORD': 'your_password',
        'OPTIONS': {'charset': 'utf8mb4'},   # note here!!!
    }
} 
```

`sql`来自这个[答案](https://dba.stackexchange.com/questions/76788/create-a-database-with-charset-utf-8/76789#76789)，

```
CREATE DATABASE db_name CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci; 
```

# ogg - 如何从 OGG 文件中去除初始偏移量？

> ID：10392081
> 
> 赞同：0
> 
> 时间：2012-05-01T00:10:16.987
> 
> 标签：ogg, oggvorbis

=== 背景 ===

前段时间，我从一个互联网广播电台翻录了很多音乐。不幸的是，似乎出了点问题，因为大多数文件的长度显示为几个小时，但它们开始在正确的位置播放。

示例：如果一个文件确实有 3 分钟长并且显示为 3 小时，则播放将从 2 小时 57 分钟开始。

在我升级我的系统之前，gstreamer 是一个旧版本，它的行为会和上面描述的一样，所以我没有太注意。现在我有一个新版本的 gstreamer，它不能正确处理这些文件：它“播放”整个初始偏移量。

=== /背景===

所以这是我的问题：如何修改 OGG/Vorbis 文件以消除无用的初始偏移量？尽管我尝试了几个标签编辑程序，但它们都不允许我编辑这些值。（有趣的是，easytag 两次都会显示我，但写错了……）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-17T20:56:55.147

我终于找到了解决办法！虽然和我想象的不太一样...

在尝试了其他几个选项后，我最终得到了以下代码：

```
#!/bin/sh

cd "${1}"

OUTDIR="../`basename "${1}"`.new"

IFS="
"
find . -wholename '*.ogg' | while read filepath;
do
    # Create destination directory
    mkdir -p "${OUTDIR}/`dirname "${filepath}"`"

    # Convert OGG to OGG
    avconv -i "${filepath}" -f ogg -acodec libvorbis -vn "${OUTDIR}/${filepath}"

    # Copy tags
    vorbiscomment -el "${filepath}" | vorbiscomment -ew "${OUTDIR}/${filepath}"
done 
```

此代码递归地重新编码所有 OGG 文件，然后复制所有 vorbis 注释。这不是一个非常有效的解决方案，但它仍然有效......

问题是什么：我想这与以下输出有关`ogginfo`：

> ...
> New logical stream (#1, serial: 74a4ca90): type vorbis
> **WARNING: Vorbis stream 1 does not have headers correctly framed. Terminal header page contains additional packets or has non-zero granulepos**
> Vorbis headers parsed for stream 1, information follows... Version: 0
> Vendor: Xiph.Org libVorbis I 20101101 (Schaufenugget)
> ...

Which disappears after reencoding the file...

At the rate at which I'm currently encoding it will probably take several hours until my whole media library will be completely reencoded... but at least I verified with several samples that it works :)

# c# - MS Access，OleDbAdapter 不删除记录但没有错误

> ID：10392085
> 
> 赞同：0
> 
> 时间：2012-05-01T00:10:55.723
> 
> 标签：c#, ms-access, oledbdataadapter

我正在尝试删除包含在 datagridview 中显示的匹配文本的记录。我得到了字符串，似乎没有任何问题，但没有任何记录被删除。

```
String text;
int i = dataGridView1.CurrentRow.Index;
text = (string)dataGridView1[0, i].Value.ToString();
String deleteSql = "DELETE FROM [Sugg] WHERE sugg_text='"+text+"'";
MessageBox.Show(text);
if (MessageBox.Show("Are you sure you want to delete this suggestion?", "Title", MessageBoxButtons.YesNo) == DialogResult.Yes)
{
    try
    {
        oleDbConnection1.Open();
        oleDbDataAdapter1.DeleteCommand = oleDbConnection1.CreateCommand();
        oleDbDataAdapter1.DeleteCommand.CommandText = deleteSql;

        oleDbDataAdapter1.DeleteCommand.ExecuteNonQuery();
        oleDbConnection1.Close(); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-01T06:40:39.423

**尝试删除 try/catch 块，看看是否真的没有错误。**

您没有收到错误的事实可能意味着您的`text`变量的内容是错误的，或者错误在您的 try/catch 块中丢失了。（我们无法完全看到）

正如蒂姆所说，不要`text`直接在 SQL 语句中插入你的值，而是使用**命令参数**来处理这些事情。它将防止意外的事情发生，例如`text`.

```
String deleteSql = "DELETE FROM [Sugg] WHERE sugg_text=@SUGG_TEXT";
var cmd = oleDbConnection1.CreateCommand();
cmd.CommandText = deleteSql;
cmd.Parameters.AddWithValue("SUGG_TEXT", text); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-01T02:20:25.447

我会尝试使用以下语法。using 块确保您正在清理连接/命令。

```
public void TestMethod()
        {
            string connectionstring = "someconnectionstring";
            string deletesql = "delete from table where something = somethingelse";
            using(OleDbConnection con = new OleDbConnection(connectionstring))
            {
                con.Open();
                using(OleDbCommand com = new OleDbCommand(deletesql, con))
                {
                    com.ExecuteNonQuery();
                }
                con.Close();
            }
        } 
```

当然，您需要添加您的 try / catch 块以及包装事务才能完成，但这应该为您提供一个开始的地方。

# c++ - For Loop 只有两件事包括 C++

> ID：10392086
> 
> 赞同：2
> 
> 时间：2012-05-01T00:10:58.010
> 
> 标签：c++, loops

可以说我有

```
int j = 23;
for (j < 20; j++) {
    //do stuff
} 
```

我知道在这种情况下这似乎很愚蠢，但这可能吗？或者你必须做

```
int j = 23;
for (j; j < 20; j++) {
    //do stuff
} 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-05-01T00:12:45.100

您通常会使用一个空的初始化程序：

```
for (; j < 20; ++j) 
```

当然，这只是一个例子，但如果`j`是 initialized `23`，`for`循环将永远不会执行。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-05-01T00:12:37.337

你总是有三个组件，但其中任何一个都可能是空白的。所以你的第一个例子可以写成：

```
int j = 23;
for (; j < 20; j++) {
    // do stuff
} 
```

（当然，这根本不做任何事情，因为 的初始值`j`大于 23，所以循环立即终止）。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2012-05-01T00:13:09.757

您只能做两件事，但需要两个分号，因为 for 循环由初始化程序、条件和在每个循环上执行的操作组成。您当然可以将其中任何一项留空

```
for (; j < 20; j++) { 
     // do stuff
} 
```

例如，您甚至可以有一个仍然递增 j 的无限循环

```
for (int j = 0; ; j++) { 
     // do stuff
} 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-05-01T00:15:22.500

您不能在此处省略分号。它应该是：

```
int j = 23;
for (; j < 20; j++) {
  //do stuff
} 
```

# c++ - 将字符串存储在向量中会导致错误

> ID：10392088
> 
> 赞同：0
> 
> 时间：2012-05-01T00:12:06.397
> 
> 标签：c++, string, vector

我正在尝试将从文件中读取的字符串存储在 std::vector 中，但出现了一个奇怪的错误...

所以我有容器：

```
std::vector<std::string> m_Strings; 
```

然后我从流中读取字符串：

```
ifstream inStream;
char word[100];
//[...]
inStream >> word;
m_Strings.push_back(word); 
```

即使向量是空的，当我插入第一个字符串时，向量会调整大小以容纳 8 个字符串，索引 0 处的字符串包含随机字符，索引 1 处包含正确的单词，其他索引包含无效指针......

知道什么可能导致这种情况吗？

编辑：在这种情况下，我正在阅读字符串“DIRECTIONAL_LIGHT”，因此它适合`char word[100]`

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-01T00:42:30.210

刚刚更改`char word[100];`为`std::string word;`，错误消失了。

# jquery - 无法根据隐藏页面内容将参数传递给 jQuery 函数

> ID：10392090
> 
> 赞同：1
> 
> 时间：2012-05-01T00:12:23.293
> 
> 标签：jquery, jqplot

我正在使用 jqplot 绘制四个图表，我想在页面上一次显示一个图表，即可以使用按钮在它们之间进行切换。我已经查询了页面加载时所有图表的所有数据。我想存储数据以在隐藏的 div 中生成 3 个备用图表，然后根据需要将它们换出。

例如，我有一个 id='weight_chart' 的按钮，我想用它来切换 id='chartdiv' 的图表 div 中的内容。所以我的 .js 中有以下函数：

```
    $('#weight_chart').click(函数(事件) {

       $('#chartdiv').html(""); // 清除 div         
       graph_data = $('#weight-graph-data').html();
       $.jqplot('chartdiv', graph_data);

    });

```

参数都以 html 的形式存储在一个隐藏的 div id='weight-graph-data' 中。

现在我有点明白为什么它不起作用了。尝试使用字符串变量替换我的参数是问题所在。如果我只是用硬代码替换实际参数......

```
    $.jqplot('chartdiv', [[['2012-03-30',30.80],['2012-03-31',30.59]]],{ title:'身体质量指数',axes:{xaxis: {renderer:$.jqplot.DateAxisRenderer}}}）；

```

代替...

```
    $.jqplot('chartdiv', graph_data);

```

...然后它工作正常。

那么，当事件触发时，我如何传递稍后在页面加载时计算的参数。我不想在这个阶段进行另一个数据库调用。我只想获取我已经收集的部分参数......

IE

```
[[['2012-03-30',30.80],['2012-03-31',30.59]]],{ title:'Body Mass Index',axes:{xaxis:{renderer:$.jqplot.DateAxisRenderer}}} 
```

...然后将其传递给函数。

我是客户端的新手，所以请耐心等待。在此先感谢您的帮助。

.................. 更新

根据最初的反馈，我尝试使用 JSON 并将参数放入 javascript 变量中，但由于变量作为一个整体包括分隔符等，它似乎不起作用。

所以我尝试了一种完全不同的方法，目的是通过 ajax 动态地重新查询数据库。我现在正确地生成了值对（第二个 jqPlot 参数），并且我只是尝试插入该部分，同时对其余部分进行硬编码。但它仍然行不通。请看下面的代码。我已经测试了“results_list”的值，它很好。如果我只是在函数调用中替换该位置的值，那么它可以正常工作并生成图形，但编码如图所示图形是空白的。当然，必须有一种方法来处理这种事情。再次感谢。

```
    $('.btn-graph').click(function(event) {

                var member_id = $('#member_id').val();
                var dataString = 'graph_type=' + this.id + '&member_id=' + member_id;
                //警报（数据字符串）；

                    //alert (dataString);return false;  
                    $.ajax({  
                      类型：“发布”，  
                      url: "/ajax_handler/graph_data.php",  
                      数据：数据字符串，
                      数据类型：'json'，
                      成功：函数（数据）{
                        //警报（数据）；
                        var results_list = "";
                        $.each（数据，函数（i，结果）{

                            results_list = results_list + "['" + result.date + "'," + result.bmi + "],";

                        });
                        results_list = results_list.slice(0, -1)
                        $('#chartdiv').html("");

                        $.jqplot('chartdiv',[[ results_list ]],{ title:'我的体重',axes:{xaxis:{renderer:$.jqplot.DateAxisRenderer}}});

                      }  
                    });
          });

```

.....................更新 2

谢谢 beetroot-beetroot - 我在看到你的更新之前就知道了。我认为您的方式也可以，但这是我现在可以使用的解决方案：

根据这里[的 dee38 - jqPlot 的 JSON](https://stackoverflow.com/questions/6693579/json-for-jqplot) - 必须在 php 中创建名称/值对。然后将小数组组合成一个大数组。json_encode 并通过 ajax 返回。然后在 ajax 成功函数中使用 eval(data) ，一切正常。这是最终的jquery函数：

```
 $('.btn-graph').click(function(event) {

            var member_id = $('#member_id').val(); 
            var dataString = 'graph_type=' + this.id + '&member_id=' + member_id;
            //alert(dataString);

                //alert (dataString);return false;  
                $.ajax({  
                  type: "POST",  
                  url: "/ajax_handler/graph_data.php",  
                  data: dataString,
                  success: function(data) {

                    $('#chartdiv').html("");

                    $.jqplot('chartdiv',eval(data),{ title:'BMI',axes:{xaxis:{renderer:$.jqplot.DateAxisRenderer}}});

                  }  
                }); 
  }); 
```

我在后端的 php 是......

```
$sql = mysql_query("SELECT * FROM stats WHERE id = '".$mid."'");

//Create an array with the results
$pairs=array();
while($v = mysql_fetch_object($sql)){
    $pairs[$v->date] = (float) $v->bmi;
}

$result = array();

foreach ($pairs as $label => $value) {
    $result[] = array($label,$value); // make a "small" array for each pair
}

echo json_encode(array($result)); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-01T01:20:23.683

Will Domaine 的建议听起来不错，但另一种方法是将三组图形数据存储为 javascript 变量而不是 DOM 中的字符串。

例如，

```
var graphData = [
    [[['2012-03-30',30.80],['2012-03-31',30.59]]],{ title:'Body Mass Index',axes:{xaxis:{renderer:$.jqplot.DateAxisRenderer}}},
    [[['2012-03-30',30.80],['2012-03-31',30.59]]],{ title:'Body Mass Index',axes:{xaxis:{renderer:$.jqplot.DateAxisRenderer}}},
    [[['2012-03-30',30.80],['2012-03-31',30.59]]],{ title:'Body Mass Index',axes:{xaxis:{renderer:$.jqplot.DateAxisRenderer}}},
]; 
```

（我使用了相同的数据 x3，但你的三个会有所不同）。

然后按如下方式构建您的按钮：

```
<button class="weightChart" data-index="0">Weight Chart 1</button>
<button class="weightChart" data-index="1">Weight Chart 2</button>
<button class="weightChart" data-index="2">Weight Chart 3</button> 
```

然后使用 为按钮设置动画：

```
$('.weightChart').click(function(event) {
    $('#chartdiv').empty();
    $.jqplot('chartdiv', graphData[Number($(this).attr('data-index'))]);
}); 
```

编辑 ....

更详细地查看数据，我发现每个数据集都包含两个变量，而不是一个。无论您尝试什么，这可能都是让您搞砸的原因。

我的js方法修改了：

```
var graphData = [
    {
        coords: [[['2012-03-30',30.80],['2012-03-31',30.59]]],
        options: { title:'Body Mass Index',axes:{xaxis:{renderer:$.jqplot.DateAxisRenderer}}}
    },
    {
        coords: [[['2012-03-30',30.80],['2012-03-31',30.59]]],
        options: { title:'Body Mass Index',axes:{xaxis:{renderer:$.jqplot.DateAxisRenderer}}}
    },
    {
        coords: [[['2012-03-30',30.80],['2012-03-31',30.59]]],
        options: { title:'Body Mass Index',axes:{xaxis:{renderer:$.jqplot.DateAxisRenderer}}}
    }
]; 
```

（再次，相同的数据 x3）

现在为按钮设置动画：

```
$('.weightChart').click(function(event) {
    $('#chartdiv').empty();
    var data = graphData[Number($(this).attr('data-index'))];
    $.jqplot('chartdiv', data.coords, data.options);
}); 
```

如果选项总是相同的，那么这将简化如下。

```
var graphOptions = { title:'Body Mass Index',axes:{xaxis:{renderer:$.jqplot.DateAxisRenderer}}};
var graphData = [
    [[['2012-03-30',30.80],['2012-03-31',30.59]]],
    [[['2012-03-30',30.80],['2012-03-31',30.59]]],
    [[['2012-03-30',30.80],['2012-03-31',30.59]]]
]; 
```

和 ：

```
$('.weightChart').click(function(event) {
    $('#chartdiv').empty();
    var data = graphData[Number($(this).attr('data-index'))];
    $.jqplot('chartdiv', data, graphOptions);
}); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-01T00:20:40.653

如果您的 JSON 字符串仅在元素的 HTML 中表示，您可能需要使用 jQuery 的 parseJSON 函数：

```
graph_data = $.parseJSON($('#weight-graph-data').html()); 
```

# iphone - 子类 UIButton 似乎没有初始化

> ID：10392100
> 
> 赞同：0
> 
> 时间：2012-05-01T00:14:06.343
> 
> 标签：iphone, objective-c, uibutton, subclass

这开始是一个简单的问题，但我无法解决。我已经对 UIButton 进行了子类化（我知道，有争议），但我似乎无法让它正常工作。我的 UIButton 子类如下所示：

。H

```
@interface SocialButton : UIButton 

 @property (nonatomic, strong) CustomClass *cust;

 - (id)initWithObject:(CustomClass *)custom andFrame:(CGRect)frame; 

@end 
```

.m

```
@implementation SocialButton

@synthesize custom=_custom;

 - (id)initWithObject:(CustomClass *)custom andFrame:(CGRect)frame; 
 {
   self = [self initWithFrame:frame];
   if (self) 
   {        
     [self addTarget:self action:@selector(buttonTouchUpInside:)  forControlEvents:UIControlEventTouchUpInside];
     self.backgroundColor = [UIColor blueColor];
     self.cust = custom;
   }

   return self;
  }

@end 
```

后来，当我尝试从此类创建一个按钮时，如下所示：

```
 SocialButton *social = [[SocialButton alloc] initWithObject:object andFrame:frame]; 
```

它似乎不起作用。有什么建议么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-01T00:15:57.157

好像你忘记打电话了`super`。改变：

```
self = [self initWithFrame:frame]; 
```

至：

```
self = [super initWithFrame:frame]; 
```

# html - :Hover 伪选择器不适用于 IE 中的 Select 元素

> ID：10392104
> 
> 赞同：2
> 
> 时间：2012-05-01T00:14:37.420
> 
> 标签：html, css

我似乎无法使 :hover 伪选择器在 IE 7、8 和 9 中的 Select 元素上工作，即使我发现的文档说 IE7+ 支持它。

据此，它应该在 IE7+ 中得到完全支持：http: [//msdn.microsoft.com/en-us/library/cc351024 (v=vs.85).aspx#pseudoclasses](http://msdn.microsoft.com/en-us/library/cc351024(v=vs.85).aspx#pseudoclasses)

Quirksmode 说“几乎” [http://www.quirksmode.org/css/contents.html](http://www.quirksmode.org/css/contents.html)

我尝试过使用严格的文档类型，但没有区别。

有谁知道使 :hover 选择器适用于 CSS 中的 Select 元素的方法？

我只是想更改:hover 上的边框颜色，但在 IE7 中似乎甚至不支持设置边框。它在 IE8+ 中受支持，但 :hover 似乎不是。更改文本的颜色甚至不起作用。

这是一个示例（在 Chrome 和 FF 中都可以完美运行）：http: [//jsfiddle.net/6VrfW/5/](http://jsfiddle.net/6VrfW/5/)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-01T00:32:44.410

您可以将其包装`<select>`在 a 中`<div>`并将悬停附加到 div。这很糟糕，但IE也是如此。

# javascript - 带有自定义编码类型的 Ext.Ajax.request

> ID：10392107
> 
> 赞同：2
> 
> 时间：2012-05-01T00:15:03.040
> 
> 标签：javascript, extjs

我现在必须与自定义后端通信，它只接受“multipart/html”的编码类型。我想看看是否有一种简单的方法可以通过 Ext.Ajax 类向服务器提交数据但使用自定义编码？

我试过了：

```
Ext.Ajax.request({
  ...
  enctype: 'multipart/form-data',
}) 
```

并且

```
Ext.Ajax.request({
  ...
  extraParams: {
    enctype: 'multipart/form-data'
  }
}) 
```

两者都不起作用。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-01T01:25:10.373

使用`headers`：[http ://docs.sencha.com/ext-js/4-0/#!/api/Ext.data.proxy.Ajax-cfg-headers](http://docs.sencha.com/ext-js/4-0/#!/api/Ext.data.proxy.Ajax-cfg-headers)

添加类似：

```
...
headers: [{ Content-Type: 'multipart/form-data' }]
... 
```

注意：我自己从未使用过这样的东西。我只是查看了`Ext.data.proxy.Ajax`源代码，发现他们使用此属性将其传递到`request()`函数内部。文档对此有些简洁-因此您最终可能会尝试几种不同的东西。

# iphone - iOS：图标在应用程序中可见，尽管它们实际上并不存在

> ID：10392113
> 
> 赞同：-2
> 
> 时间：2012-05-01T00:15:59.747
> 
> 标签：iphone, objective-c, ios

好吧，我有一个带有图标的文件夹，昨天我删除了它并清理了应用程序。但是，这些图标从未从我的应用程序中消失。

*   检查图像是否在其他地方。不，从我的 Mac 中删除。
*   是否重置了 iPhone 模拟器。
*   已从设备中删除此应用。

有人可以阐明这个问题吗？

编辑：2012 年 5 月 1 日

今天，再次重置和清理项目后，我已经摆脱了模拟器中的图标。同样，我已经从设备中删除了我的应用程序并再次运行它。我有该死的图标。为什么在设备中它看起来不像在模拟器中。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-01T03:47:02.797

您必须重置您的 iphone 模拟器并清理项目。或者你应该检查一下，点击有两个选项，第一个只有引用，第二个移动到垃圾箱，你点击了哪个选项？

# javascript - 为什么这些警报会成倍增加？

> ID：10392114
> 
> 赞同：2
> 
> 时间：2012-05-01T00:16:05.203
> 
> 标签：javascript, jquery, html

好的，我有几个输入。我有这段代码来验证它们。

```
$("#form1").submit(function(){
    var isFormValid = true;

    $("#first_name").each(function(){
        if ($.trim($(this).val()).length == 0){
            isFormValid = false;
        }
    });

    if (!isFormValid) alert("Please Enter Your First Name");
    return isFormValid;
});

$("#form1").submit(function(){
    var isFormValid = true;

    $("#last_name").each(function(){
        if ($.trim($(this).val()).length == 0){
            isFormValid = false;
        }
    });

    if (!isFormValid) alert("Please Enter Your Last Name");
    return isFormValid;
});    

    $("#form1").submit(function(){
    var isFormValid = true;

    $("#dropdown").each(function(){
        if ($.trim($(this).val()).length == 0){
            isFormValid = false;
        }
    });

    if (!isFormValid) alert("Please Select Your Volunteer Choice");
    return isFormValid;
}); 
```

出于某种原因，我收到一条消息后收到一条消息。我的目标是它只向我展示下一个尚未被淘汰的字段，而不是同时显示所有字段。如果您有任何问题，请发表评论，这很难解释……在您给我机会更好地解释之前，请不要投反对票。​</p>

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-01T00:25:31.643

我不熟悉 JQuery，但我认为正在发生的事情是您将 3 个函数绑定到您的表单，这意味着它们都被调用

当您想要做的是创建 1 个函数 validate 调用您的子验证函数。

我还建议您更改子验证方法以返回消息而不是布尔值，这样您就可以在 1 个警报中显示所有错误。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-01T00:26:22.490

您有多个警报，因为您将不同的函数绑定到表单的提交事件：每个函数检查不同的字段并在该字段为空时触发警报。

您只需将三个验证步骤移动到一个函数中，并将该函数绑定到提交事件。

就像是：

```
$("#form1").submit(check);

function check() {
    var isFormValid = true;
    var errors = array();

    $("#first_name").each(function(){
        if ($.trim($(this).val()).length == 0){
            isFormValid = false;
            errors.push("Please Enter Your First Name");
        }
    });

    $("#last_name").each(function(){
        if ($.trim($(this).val()).length == 0){
            isFormValid = false;
            errors.push("Please Enter Your Last Name");
        }
    });

    $("#dropdown").each(function(){
        if ($.trim($(this).val()).length == 0){
            isFormValid = false;
            errors.push("Please Select Your Volunteer Choice");
        }
    });

    if (!isFormValid) {
        var errorMsg = "";
        for (var i = 0; i < errors.length; i++) {
            errorMsg += errors[i] +  "\n";  
        }
        alert(errorMsg);    
    }

} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-05-01T00:29:50.120

这是简化代码并使其按预期工作的方法。

首先，由于您使用相同的方法来验证所有字段，因此将其包装在一个函数中，而不是重复代码：

```
function isFieldEmpty(jQuerySelector) {
    return $.trim($(jQuerySelector).val()).length == 0
} 
```

其次，使用单个`submit`处理程序检查所有内容，以及`return false`是否有任何字段未通过验证：

```
$("#form1").submit(function(){

    if(isFieldEmpty('#first_name')) {
        alert("Please Enter Your First Name");
        return false;
    }

    if(isFieldEmpty('#last_name')) {
        alert("Please Enter Your Last Name");
        return false;
    }

    if(isFieldEmpty('#dropdown')) {
        alert("Please Select Your Volunteer Choice");
        return false;
    }

    // Will return true only if all fields passed
    return true;
}); 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-05-01T00:39:31.363

这是因为您的代码冗余，相同的*功能*，相同的*标识符*，相同的*逻辑*，相同的事件*处理程序*，***每个都***没有**id 选择器**。

唯一不同的是主题。这是我的建议。

```
$("#form1").submit(function(){
    var errors = [];
    if($("#first_name").val().length == 0){
       errors.push("Please Enter Your First Name");
    }

    if($("#last_name").val().length == 0){
       errors.push("Please Enter Your Last Name");
    }
    // and so on

    if(var isFormValid = errors.length > 0) { 
         alert('you have errors'); 
         //errors contains all the error message if you need them
    }
    return isFormValid;
}); 
```

# sql-server - 如何根据先前 SQL 代理作业步骤的结果跳过作业步骤？

> ID：10392115
> 
> 赞同：6
> 
> 时间：2012-05-01T00:16:09.570
> 
> 标签：sql-server, tsql, sql-agent-job

我正在尝试创建一个将根据数据库的在线状态运行的作业。比如第1步会检查数据库是否在线；如果数据库在线，它将运行其余步骤，否则，它将报告作业成功。

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2012-05-01T01:58:40.917

好吧，您可以将第 1 步设置为：

```
DECLARE @dbState TINYINT;
SELECT @dbState = state FROM sys.databases WHERE name = N'dbname';
IF @dbState = 0
BEGIN
  RAISERROR('Database is online.', 11, 1);
END 
```

将步骤 1 的属性设置为：

*   如果成功，请转到第 2 步
*   如果失败，转到步骤 N

Step 2 -> n-1 会做他们正常的事情。步骤 n-1 可能会在成功时退出工作，或者在成功时移至步骤 N。

步骤 N 可以很简单：

```
PRINT 1; 
```

...并且会成功地辞去这份工作。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-01T01:47:35.463

通常我使用 On Success/On Failure 来控制流程。如果您有不同的分支，则在每个“分支”的末尾必须有一个 NO-OP 步骤以继续：

```
Step 1 - Some Op - On Failure Goto Step 4, On Success Go to next step
Step 2 - Some Op
Step 3 - Goto continuation step
Step 4 - Some op
...
Step n - Continnuation step
Step n+1 - finish the common processing 
```

不用说，使用 GOTO 管理这种线性流程对于复杂的逻辑流程来说并不重要。

[http://www.sqlservercentral.com/articles/Stairway+Series/72457/](http://www.sqlservercentral.com/articles/Stairway+Series/72457/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2018-11-09T11:00:00.443

将以下代码放在作业的第 1 步中。它检查它是否是主要的（指定 DAG 的名称），如果不是，则停止作业。

```
-- Do I wish this job to continue or not...
-- e.g. Is this the Primary in the DAG
-- If not, stop the job
DECLARE @rc int; 
EXEC @rc = dbo.fn_hadr_group_is_primary N'DAG_001';

IF @rc = 0
BEGIN;
    DECLARE @JobID uniqueidentifier
    SELECT @JobID = $(ESCAPE_NONE(JOBID));
    EXEC msdb.dbo.sp_stop_job @job_id = @JobID;
END; 
```

# ravendb - Raven 查询返回 0 个结果集合包含

> ID：10392119
> 
> 赞同：3
> 
> 时间：2012-05-01T00:16:58.310
> 
> 标签：ravendb

我有一个基本架构

```
Post {
    Labels: [
        { Text: "Mine" }
        { Text: "Incomplete" }
    ]
} 
```

我正在查询 raven，询问所有带有“我的”和“不完整”标签的帖子。

```
queryable.Where(candidate => candidate.Labels.Any(label => label.Text == "Mine"))
    .Where(candidate => candidate.Labels.Any(label => label.Text == "Incomplete")); 
```

这会导致 raven 查询（来自 Raven 服务器控制台）

```
Query: (Labels,Text:Incomplete) AND (Labels,Text:Mine)
Time: 3 ms
Index: Temp/XWrlnFBeq8ENRd2SCCVqUQ==
Results: 0 returned out of 0 total. 
```

为什么是这样？如果我查询包含“不完整”的 JUST，我会得到 1 个结果。如果我查询 JUST 包含“我的”，我得到相同的结果 - 那么为什么我同时查询它们，我得到 0 个结果？

编辑：

好的-所以我走得更远了。“自动生成的索引”看起来像这样

```
from doc in docs.FeedAnnouncements
from docLabelsItem in ((IEnumerable<dynamic>)doc.Labels).DefaultIfEmpty()
select new { CreationDate = doc.CreationDate, Labels_Text = docLabelsItem.Text } 
```

所以，我认为查询基本上是在测试相同标签的 2 个不同值。坏的。

我把它改成这样：

```
from doc in docs.FeedAnnouncements
from docLabelsItem1 in ((IEnumerable<dynamic>)doc.Labels).DefaultIfEmpty()
from docLabelsItem2 in ((IEnumerable<dynamic>)doc.Labels).DefaultIfEmpty()
select new { CreationDate = doc.CreationDate, Labels1_Text = docLabelsItem1.Text, Labels2_Text = docLabelsItem2.Text } 
```

现在我的查询（在 Raven Studio 中）`Labels1_Text:Mine AND Labels2_Text:Incomplete`有效！

但是，从 Linq 查询时，如何处理这些幻像字段（Labels1_Text 和 Labels2_Text）？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-01T05:00:24.680

亚当，你的理由是对的。默认索引将生成 2 个索引条目，并且您的查询在单个索引条目上执行。

你想要的是要么使用交集，要么像这样创建自己的索引：

```
from doc in docs.FeedAnnouncements
select new { Labels_Text = doc.Labels.Select(x=>x.Text)} 
```

这将在单个索引条目中为您提供所有标签的文本，您可以对其执行查询。

# ruby-on-rails - 将 Rails 地理编码器与设计集成

> ID：10392126
> 
> 赞同：1
> 
> 时间：2012-05-01T00:17:54.283
> 
> 标签：ruby-on-rails, ruby, rails-geocoder

我遇到了一个感兴趣的问题。我正在使用 ruby​​ 1.9.3 和 rails 3.2.3

我想将地理编码器 gem 与设计集成。`attr_accessible`我在设计创建的用户模型中添加了三个附加项，即“地址、纬度和经度”。我创建了一个迁移来将这些表添加到数据库中（我使用的是 sqlite3）。

我在设计注册视图中添加了一个地址字段，供人们注册时使用，并将以下内容放在我的用户模型的末尾

```
geocoded_by :address
after_validation :geocode 
```

现在，当用户注册并输入他们的电子邮件地址、密码和地址时。地理编码器成功地将正确的纬度值放入数据库中，但是将经度留空？有人遇到过这个问题吗？？我认为在注册时成功跟踪每个用户是一项非常有趣的任务。但是我需要纬度和经度地址！

任何建议请开火！:)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-02T11:48:42.653

我通过创建一个新的 rails 应用程序解决了这个问题，然后同时安装了设计和地理编码器。我将其他属性迁移到设计中，并将它们添加到用户模型中，一切似乎都运行良好。

如果有人遇到任何问题，请与我们联系！

# javascript - 如何更新和显示地图对象？

> ID：10392128
> 
> 赞同：2
> 
> 时间：2012-05-01T00:18:06.020
> 
> 标签：javascript, ember.js

如果我有一个定期更新/刷新的基本地图对象，我如何在我的视图/把手中显示地图的内容？

任何示例代码都会很棒，因为我仍然对 Ember 感到困惑。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-09T03:22:44.797

Ember 附带的`Ember.Map`对象用于高性能，主要是内部使用，因此它不实现 Observable、Ember.Array 或 Ember.Enumerable（显示自动更新对象的要求）。

`Map`实现一个支持自动更新的会非常简单。你能解释一下你的用例吗？

# c# - 如何制作从 library.dll.config 读取的 DLL ApplicationSettings 类？

> ID：10392130
> 
> 赞同：2
> 
> 时间：2012-05-01T00:18:26.317
> 
> 标签：c#, .net, app-config, application-settings

我正在为另一个应用程序创建一个插件作为 DLL，它需要具有无需重新编译 DLL 即可配置的设置。我通过 Visual Studio 创建了一个设置类，就像我通常对应用程序项目所做的那样。当我构建我的项目时，会创建一个 libraryname.dll.config 文件并将其直接复制到输出中。

但是，正如其他人可能已经发现并写过的那样，这个文件从未被使用过。相反，如果我想修改这些 DLL 设置，我需要将设置合并到使用 DLL 的任何应用程序的设置文件中。

我遇到的问题是调用应用程序不是我的应用程序，所以我宁愿插件的配置与插件的其余文件一起使用。

过去，我曾经`System.Configuration.ConfigurationManager.OpenExeConfiguration()`像这样读取 DLL 的设置文件。

```
 public static string GetSettingValue(string key)
    {
        string assemblyPath = System.Reflection.Assembly.GetExecutingAssembly().Location;
        var config = ConfigurationManager.OpenExeConfiguration(assemblyPath);
        var keyVal = config.AppSettings.Settings[key]
        return keyVal.Value;
    } 
```

将从这样的设置文件中读取

```
<?xml version="1.0" encoding="utf-8" ?>
<configuration>
  <appSettings>
    <add key="URL" value="http://www.acme.com" />
    <add key="EnableAdmin" value="False" />
  </appSettings>
</configuration> 
```

但是，我真的很喜欢由 Visual Studio 创建的较新类型的安全 ApplicationSettings 类，而不是使用`<appSettings>`只能存储字符串的类。

所以我想知道是否有某种方法可以覆盖 Visual Studio 创建的 ApplicationSettings 类中的一两个方法，以使其默认从 DLL 配置文件中读取？我不太清楚应该在哪里确定应该读取哪个配置文件。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-01T04:14:35.360

您可以尝试在调用应用程序中合并 applicationsettings 文件。这个 SO 线程很好地解释了它。

[如何动态加载单独的应用程序设置文件并与当前设置合并？](https://stackoverflow.com/questions/2389290/how-to-load-a-separate-application-settings-file-dynamically-and-merge-with-curr)

如果你不想编辑调用应用程序，你可以像你一样使用配置类。这是另一个例子。当我需要通过 COM 调用 WCF 服务时，我使用了这种方法。

[http://www.twisted-bits.com/2012/04/use-a-net-configuration-file-with-a-class-library-dll/](http://www.twisted-bits.com/2012/04/use-a-net-configuration-file-with-a-class-library-dll/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-01T00:28:04.533

将适用的部分复制到主站点的 web.config 或主可执行文件的 app.config 中，然后`ConfigurationManager.AppSettings["URL"]`就可以正常工作了。

# cakephp - 更新多个 div

> ID：10392137
> 
> 赞同：0
> 
> 时间：2012-05-01T00:19:38.237
> 
> 标签：cakephp, cakephp-1.3, cakephp-2.0, cakephp-2.1

我正在使用以下代码更新`div`

```
echo $this->Js->link($station["Company"]["name"], 
                        array('action' => 'station_users','company_id'=>$station["Company"]["id"]), 
                        array('id'=>'team_member'.$x,  'update' => '#myDIV')
                    ); 
```

但现在我需要更新多个 div。我该怎么做？我想通过单击该链接来更新多个 div。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-01T04:55:57.297

您可以直接使用 jQuery 而不是 JsHelper。JsHelper 也会将其呈现为 jQuery 脚本。

您可以在脚本块的视图中添加以下类型的代码。

```
jQuery("#id").bind('click', function(event) {
    jQuery.ajax({
        beforeSend : function(XMLHttpRequest) {
            jQuery("#sending").show();
        },
        data : jQuery("#id").closest("form").serialize(),
        dataType : "html",
        success : function(data, textStatus) {
            updateMultipleDivs(data, textStatus);
        },
        type : "post",
        url : "\/AppName\/ControllerName\/Method"
    });
    return false;
});
function updateMultipleDivs(data, textStatus) {
    jQuery('#Div1toUpdate').before(data);
    jQuery("#Div2toUpdate").hide();
} 
```

# javascript - 如何使用外部源覆盖包含 iframe 的 div？

> ID：10392138
> 
> 赞同：1
> 
> 时间：2012-05-01T00:19:52.093
> 
> 标签：javascript, jquery

我有一个页面，我想显示一个带有弹出窗口的 div 叠加层。基本上，就像彩盒。但我希望这是永久性的。他们应该无法点击 div。div 内部应该是 iframe 中来自 popsurvey.com 的内容。我需要框架的链接是这个-> [http://www.popsurvey.com/s/5gzmqc/0x5513](http://www.popsurvey.com/s/5gzmqc/0x5513) - 你建议怎么做？谢谢。

```
 <script>
$(document).ready(function() {
$.colorbox({iframe:true, width:"620", height:"591", href:"http://www.popsurvey.com/s/5gzmqc/4zk4lm?embed=true", opacity: ".3"});
});
 </script> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-01T00:50:02.960

我已经在 jquery 中创建了一个足够轻巧且足够简单以满足您的需求的解决方案（我希望），干净和简单通常是做这些事情的最佳方式，并且 99.99% 的时间使用更大的东西是多余的插件或预构建的解决方案。

*   [jsfiddle 演示](http://jsfiddle.net/eT2Lz/10/embedded/result/)

*   [jsfiddle](http://jsfiddle.net/eT2Lz/10/)

* * *

的HTML：

```
 <div id="block"></div>
<div id="iframecontainer">
    <div id="loader"></div>
    <iframe></iframe>
</div>​ 
```

的CSS：

```
#iframecontainer {width:90%; height: 90%; display: none; position: fixed;margin-top: 5%; margin-left: 5%; background:#FFF; border: 1px solid #666;border: 1px solid #555;box-shadow: 2px 2px 40px #222;z-index: 999999;}
#iframecontainer iframe {display:none; width: 100%; height: 100%; position: absolute; border: none; }
#loader {background: url('http://www.calgaryramsrugby.com/images/ajax-loader.gif');background-repeat:no-repeat;  width: 250px; height: 250px; margin:auto;}
#block {background: #000; opacity:0.6;  position: fixed; width: 100%; height: 100%; top:0; left:0; display:none;}​ 
```

js：

```
$(document).ready(function() {
    $('#block').fadeIn();
    $('#iframecontainer').fadeIn();
    $('#iframecontainer iframe').attr('src', 'http://www.popsurvey.com/s/5gzmqc/0x5513');
    $('#iframecontainer iframe').load(function() {
        $('#loader').fadeOut(function() {
            $('iframe').fadeIn();
        });
    });
}); 
```

​</p>

​</p>

# c# - 使用 Facebook C# SDK 简单登录不起作用

> ID：10392148
> 
> 赞同：1
> 
> 时间：2012-05-01T00:22:52.740
> 
> 标签：c#, asp.net, facebook-c#-sdk, facebook-login

我是 Facebook 应用程序的新手，最近阅读了可用的文档。然后，我继续从 NuGet 获取 Facebook C# SDK 并阅读[入门教程](http://csharpsdk.org/docs/web/getting-started)。

我稍微修改了一下。我有 3 页：

*   Default.aspx ：具有“使用 facebook 登录”按钮
*   Protected.aspx ：我最终希望在没有先登录的情况下无法访问的页面
*   DoSignIn.aspx ：包含对令牌的请求并重定向回 Default.aspx

*   在 Default.aspx 上，我有一个将我重定向到 Protected.aspx 页面的按钮。在它上面，我有一个标签显示我的令牌。

现在，我的问题是：

*   当我单击“使用 facebook 登录”按钮时，该按钮不会更改为显示我已登录。它仅在我刷新页面时显示我已登录。
*   如果我单击按钮将我重定向到 Protected.aspx 页面，我在标签中看不到令牌，因为从未调用过 DoSignIn.aspx 页面。

如果有人能指出我做错了什么（因为我几乎复制了教程示例），我将非常感激。在过去的 3 个小时里，我一直在摆弄这个并搜索谷歌和 SO，但不知道在哪里搜索了。

感谢您的时间。

PS。我有最新的 Facebook C# SDK 并且 App ID 似乎工作正常，因为当我手动刷新浏览器时，我确实已登录。

我添加了 3 页的代码：

**默认.aspx：**

```
<%@ Page Language="C#" AutoEventWireup="true" CodeFile="Default.aspx.cs" Inherits="_Default" %>

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head runat="server">
    <title></title>
</head>
<body>
    <div id="fb-root">
    </div>
    <script type="text/javascript">
        window.fbAsyncInit = function () {
            FB.init({
                appId: 'I_INSERTED_MY_APP_ID_HERE', // App ID
                status: true, // check login status
                cookie: true, // enable cookies to allow the server to access the session
                xfbml: true  // parse XFBML
            });

            FB.Event.subscribe('auth.authResponseChange', function (response) {
                if (response.status === 'connected') {
                    // the user is logged in and has authenticated your
                    // app, and response.authResponse supplies
                    // the user's ID, a valid access token, a signed
                    // request, and the time the access token 
                    // and signed request each expire
                    var uid = response.authResponse.userID;
                    var accessToken = response.authResponse.accessToken;

                    // - Handle the access token -
                    // Do a post to the server to finish the logon
                    // This is a form post since we don't want to use AJAX
                    var form = document.createElement("form");
                    form.setAttribute("method", 'post');
                    form.setAttribute("action", 'DoSignIn.aspx');

                    var field = document.createElement("input");
                    field.setAttribute("type", "hidden");
                    field.setAttribute("name", 'accessToken');
                    field.setAttribute("value", accessToken);
                    form.appendChild(field);

                    document.body.appendChild(form);
                    form.submit();

                } else if (response.status === 'not_authorized') {
                    // the user is logged in to Facebook, 
                    // but has not authenticated your app
                } else {
                    // the user isn't logged in to Facebook.
                }
            });
        };

        // Load the SDK Asynchronously
        (function (d) {
            var js, id = 'facebook-jssdk', ref = d.getElementsByTagName('script')[0];
            if (d.getElementById(id)) { return; }
            js = d.createElement('script'); js.id = id; js.async = true;
            js.src = "//connect.facebook.net/en_US/all.js";
            ref.parentNode.insertBefore(js, ref);
        } (document));
    </script>
    <form id="form1" runat="server">
    <div>
        <div class="fb-login-button" data-show-faces="true" data-width="400" data-max-rows="1">
            Log in with Facebook</div>
        <br />
        <asp:Button ID="Button1" runat="server" OnClick="Button1_Click" Text="Go to protected" />
    </div>
    </form>
</body>
</html> 
```

**默认.aspx.cs：**

```
public partial class _Default : System.Web.UI.Page
{
    protected void Page_Load(object sender, EventArgs e)
    {

    }
    protected void Button1_Click(object sender, EventArgs e)
    {
        Response.Redirect("Protected.aspx");
    }
} 
```

**DoSignIn.aspx.cs：**

```
public partial class DoSignIn : System.Web.UI.Page
{
    protected void Page_Load(object sender, EventArgs e)
    {
        var accessToken = Request["accessToken"];
        Session["AccessToken"] = accessToken;

        Response.Redirect("Default.aspx");
    }
} 
```

**受保护的.aspx.cs：**

```
public partial class Protected : System.Web.UI.Page
{
    protected void Page_Load(object sender, EventArgs e)
    {
        if (Session["AccessToken"] != null)
        {
            Label1.Text = Session["AccessToken"].ToString();
        }
        else
        {

            Label1.Text = "Not authenticated";
        }
    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-01T21:44:54.430

是的，我花了几个小时搜索，终于找到了为什么它不起作用。它与上面的代码无关，但与 Facebook 错误有关。实际上，似乎很多人无法在会话刷新时触发 auth.authResponseChange。我在 FB 上发现了几个描述完整问题的错误报告，其中一个在[这里](http://developers.facebook.com/bugs/351374538207243?browse=search_4f4ee2d8a15cb1913026038)。

我在 /localhost/ 上开发时遇到的这个问题。在删除上述示例之前，我尝试将其上传到域名下的实际托管服务器上时，我已经转向了一种不同的方式来集成 Facebook 登录。出于某种我无法解释的原因，它只是从那里开始工作。

[无论如何，这里](http://www.aspdotnet-suresh.com/2012/04/aspnet-integrate-facebook-login.html)解释了我目前正在追求的 Facebook 登录的实现。

# ruby - 将向量转换为整数

> ID：10392149
> 
> 赞同：0
> 
> 时间：2012-05-01T00:22:57.330
> 
> 标签：ruby, arrays, vector, multidimensional-array, narray

知道向量的多维数组的形状，我们如何将其转换为一维的新向量（通过展平多维数组）？

例如考虑以下数组：

```
arr = [
  [
    [ nil, nil ],
    [ nil, nil ],
    [ nil, nil ]
  ],
  [
    [ nil, nil ],
    [ nil, nil ],
    [ nil, nil ]
  ]
]

arr[0][0][0] = "A"
arr[1][0][1] = "B"

arr # =>
[
  [
    [ "A", nil ],
    [ nil, nil ],
    [ nil, nil ]
  ],
  [
    [ nil, "B" ],
    [ nil, nil ],
    [ nil, nil ]
  ]
] 
```

...向量`A`的起点和`B`终点在哪里。可以写：

```
shape  = [2, 3, 2]
vector = [1, 0, 1] 
```

从现在开始，假设我们 flatten `arr`，我们如何翻译向量呢？换句话说，如何将这个 3 维向量转换为新的 1 维向量？

这是一种特殊情况，因为向量的原点也是数组的第一个坐标。所以我们可以找到结果：

```
arr.flatten.index("B") # => 7 
```

这是另一个二维数组的例子：

```
arr = [
  [ "A", nil ],
  [ "B", nil ],
  [ nil, nil ],
  [ nil, nil ],
  [ nil, nil ]
] 
```

我们可以这样写：

```
shape  = [2, 5]
vector = [1, 0] 
```

而且，再一次，

```
arr.flatten.index("B") # => 2 
```

但这里有一个更复杂的例子，带有一个负向量：

```
arr = [
  [ "B", nil ],
  [ "A", nil ],
  [ nil, nil ],
  [ nil, nil ],
  [ nil, nil ]
]

shape  = [2, 5]
vector = [-1, 0] 
```

下面的方法怎么写？

```
vector2index(shape, vector) # => -2 
```

一维数组的示例（简单）：

```
arr = [ nil, "B", nil, nil, "A", nil, nil ]

shape  = [7]
vector = [-3]
vector2index(shape, vector) # => -3 
```

有没有一种简单的方法可以从任意维度的数组中扁平化一个向量？谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-01T00:59:34.687

首先，假设数组的第一个元素用于 X 轴，第二个 - 用于 Y 轴，第三个 - 用于 Z 轴，您在第二个和第三个示例中存在错误。第三个例子应该是

```
shape  = [2,5]
vector = [0,-1]
vector2index(shape, vector) # => -2 
```

如果数组的第一个元素用于 Y 轴，第二个元素用于 X 轴，则第二个和第三个示例是正确的，但第一个示例是错误的。

如果我正确理解了这个想法，我们需要在第一个示例中乘以`vector[1]`，`shape[0]`乘以`vector[2]`，`shape[0]*shape[1]`然后计算 3 个元素的总和。一般来说，我们不需要将第0个元素相乘，我们需要将第n个元素相乘`shape[0]*shape[1]*...*shape[n-1]`。

你可以这样实现它：

```
vector.each_with_index.map { 
  |v, i| i == 0? v: v * shape[0..i-1].inject(:*) 
}.inject(:+) 
```

*更新。*更新问题后，它变得更加清晰。如果要保留 Ruby 的索引顺序，则需要反转数组`shape`和`vector`.

```
vector.reverse.each_with_index.map { 
  |v, i| i == 0? v: v * shape[0..i-1].reverse.inject(:*) 
}.inject(:+) 
```

# android - 单击按钮后活动崩溃

> ID：10392150
> 
> 赞同：0
> 
> 时间：2012-05-01T00:22:57.627
> 
> 标签：android, android-activity, oncreate

我目前有这个和 android 活动，但是当单击按钮时应用程序崩溃。我找不到哪里错了。

```
public class SearchActivity extends Activity implements OnClickListener{

private ListView recipes;
Intent intent;
Button button;
EditText input;

public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);

    setContentView(R.layout.searchlist);

    button = (Button)findViewById(R.id.submit);
    input = (EditText)findViewById(R.id.recipeName);

    //recipes = (ListView)findViewById(R.id.recipes);
    //recipes.setAdapter(new ArrayAdapter<String> (this, R.layout.main, getResources().getStringArray(R.array.BaconSandwich)));
    button.setOnClickListener(this);
}

public void onClick(View clicked) {
    if(clicked.getId() == R.id.submit) {
        //recipes = (ListView)findViewById(R.array.recipes);
        String value = input.getText().toString();
        Toast.makeText(this, value, Toast.LENGTH_SHORT).show();
        Intent i = new Intent(this, RecipeMethodActivity.class);
        SearchActivity.this.startActivity(i);
    }
}

} 
```

该活动在android清单中设置，下一个活动为空白我得到的日志猫消息是：

RecipeMethodActivity onCreate() 中的错误。

我的 RecipeMethodActivity 是：

```
package com.finalyearproject.cookmefood;

import android.app.ListActivity;
import android.os.Bundle;

public class RecipeMethodActivity extends ListActivity {

public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);

    setContentView(R.layout.main);

} 
```

}

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-01T05:34:10.450

* * *

我检查了你的代码..

见下文

```
公共类 DemoActivity 扩展 Activity 实现 OnClickListener{

私人按钮按钮；

私人 EditText 输入；

    /** 在第一次创建活动时调用。*/
    @覆盖
    公共无效 onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        设置内容视图（R.layout.main）；

        button = (Button)findViewById(R.id.submit);
        输入 = (EditText)findViewById(R.id.recipeName);

        button.setOnClickListener(this);
    }

    @覆盖
    公共无效 onClick（查看 v）{
        // TODO 自动生成的方法存根
        if(v.getId() == R.id.submit) {
            //recipes = (ListView)findViewById(R.array.recipes);
            字符串值 = input.getText().toString();
            Toast.makeText(this, value, Toast.LENGTH_SHORT).show();
            Intent i = new Intent(this, RecipeMethodActivity.class);
            DemoActivity.this.startActivity(i);
        }
    }
}

```

主要的.xml

 `````
<TextView
    android:layout_width="fill_parent"
    android:layout_height="wrap_content"
    android:text="@string/hello" />
<EditText
    android:id="@+id/recipeName"
    android:layout_width="match_parent"
    android:layout_height="wrap_content" >
    <requestFocus />
</EditText>
<Button
    android:id="@+id/submit"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:text="Button" /> 
````  `食谱方法活动

`package com.Demo;`

 `import android.app.ListActivity; import android.os.Bundle;

public class RecipeMethodActivity extends ListActivity {

```
@Override
protected void onCreate(Bundle savedInstanceState) {
    // TODO Auto-generated method stub
    super.onCreate(savedInstanceState);
    setContentView(R.layout.new_layout);

} 
```

}

new_layout.xml

```
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:id="@+id/linearLayout1"
    android:layout_width="fill_parent"
    android:layout_height="fill_parent" >

    <ListView
        android:id="@+id/@android:list"
        android:layout_width="match_parent"
        android:layout_height="wrap_content"
        android:layout_weight="1" >
    </ListView>

</LinearLayout> 
```

manifest file:

```
<uses-sdk android:minSdkVersion="3" />

<application
    android:icon="@drawable/ic_launcher"
    android:label="@string/app_name" >
    <activity
        android:label="@string/app_name"
        android:name=".DemoActivity" >
        <intent-filter >
            <action android:name="android.intent.action.MAIN" />

            <category android:name="android.intent.category.LAUNCHER" />
        </intent-filter>
    </activity>
    <activity android:name=".RecipeMethodActivity"></activity>
</application> 
``````

# asp.net - asp.net MVC3 在详细信息页面上显示查询结果

> ID：10392155
> 
> 赞同：0
> 
> 时间：2012-05-01T00:24:02.480
> 
> 标签：asp.net, asp.net-mvc-3

我是 MVC3 的新手

DB 有一个名为 users (id,name,username,lat,lon) 的表。我无权访问数据库。

我使用上表创建了实体模型。然后，我创建了 SearchController 和 Search View。在索引页面上，我显示所有用户的列表。另外，我在页面上创建了一个使用用户名搜索表的表单。单击详细信息链接后，我将显示详细信息页面，其中显示了用户的详细信息。

现在我需要显示所选用户一英里内的其他用户。我已经有 sql 查询来获取所选用户一英里内的其他用户的列表（这是一个 sql 查询）。我需要在详细信息页面上显示此列表。

我创建了一个自定义类模型。

```
public class SearchDetailsViewModel
{
    public decimal id { get; set; }
    public string name { get; set; }
    public string username { get; set; }
    public Nullable<decimal> lat { get; set; }
    public Nullable<decimal> lon { get; set; }
    public string profile_img_url { get; set; }
    public IQueryable<user> usersWithinAMile { get; set; }
} 
```

我不确定这是否是正确的方法。另外，我不知道如何初始化这个类。

非常感谢任何帮助或建议。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-01T01:02:29.420

是的，你在正确的轨道上，你从你的 SQL 中获取数据到类中，然后到视图中，在 ActionResult 中，如下所示：

```
using System.Collections.Generic;

public ActionResult Index() {
    var data = new List<SearchDetailsViewModel>();
    // foreach row in your SQL
    var s = new SearchDetailsViewModel();
    s.lat = -42.00000M;
    // more data added to the s object here
    data.Add(s);
    // end loop

    return View("ThePage", data);
} 
```

然后在您的视图本身上，您将执行以下操作：

```
@foreach (var s in Model) {
    // output your values on the page
} 
```

# ruby-on-rails - 如何在rails中调用数据库表

> ID：10392158
> 
> 赞同：0
> 
> 时间：2012-05-01T00:24:35.767
> 
> 标签：ruby-on-rails, database, initialization

我试图在我的 Rails 应用程序中引用我的一张表，但出现以下错误

```
uninitialized constant UsersController::BadgesSashes 
```

我在我的用户控制器中，我的表被命名为 badges_sashes（根据我的数据库浏览器）

我不能做类似的事情......

```
BadgesSashes.first 
```

在我的控制器中？我正在使用宝石，我已经有一个

```
has_merit 
```

我的用户模型中的行。我还需要做什么吗？谢谢你

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-01T00:46:53.047

要引用表，您需要使用名称的单数版本定义模型。因此，如果您的表是名称`badges_sashes`，那么您应该创建一个文件`app/models/badges_sash.rb`：

```
class BadgesSash < ActiveRecord::Base
end 
```

请记住，通常情况相反：您生成一个模型，它将为您创建一个数据库迁移、一个类和一个单元测试。

要了解更多信息，您可以参加免费的在线课程，其中解释了所有这些内容，称为[Rails for Zombies](http://railsforzombies.org/)，或阅读《[使用 Rails 进行敏捷 Web 开发](http://pragprog.com/book/rails4/agile-web-development-with-rails)》一书或[官方指南](http://guides.rubyonrails.org/)

# android - 在 Android 的 textview [ Html.fromhtml() ] 中使用多种文本颜色

> ID：10392163
> 
> 赞同：21
> 
> 时间：2012-05-01T00:25:29.387
> 
> 标签：android, html, android-layout, formatting, textview

在一个文本视图中，我试图区分不同单词的文本样式。

到目前为止，我有：

```
textview.setText(Html.fromHtml("<i><small><font color=\"c5c5c5\">" + "Competitor ID: " + "</font></small></i>" + "<font color=\"47a842\">" + compID + "</font>")); 
```

基本上，我是说我想要`"Competitor ID:"`斜体、小号和灰色。

我希望该字符串`compID`是正常大小的，而不是斜体和绿色。

代码的斜体和小部分完美运行，但由于某种原因，整个文本视图都有灰色文本，而不仅仅是`"Competitor ID:"`.

有任何想法吗？

* * *

## 回答 #1

> 赞同：77
> 
> 时间：2012-05-01T02:59:23.770

```
textview.setText(Html.fromHtml("<i><small><font color=\"#c5c5c5\">" + "Competitor ID: " + "</font></small></i>" + "<font color=\"#47a842\">" + compID + "</font>")); 
```

试试上面的。

* * *

## 回答 #2

> 赞同：-8
> 
> 时间：2012-05-01T02:56:33.730

尝试改用这些灰色十六进制代码值之一。

```
gray1 #030303   
gray2 #050505  
gray3 #080808     
gray4 #0A0A0A   
gray5 #0D0D0D 
```

. 还尝试使用上述代码控制 xml textview 属性中的文本颜色。希望这可以帮助

# sql - 如何修复混合了 AND 和 OR 条件的查询？

> ID：10392166
> 
> 赞同：1
> 
> 时间：2012-05-01T00:25:40.060
> 
> 标签：sql, oracle, boolean-logic

我需要在三列上查询具有过滤条件的表：

```
select * 
from table a 
where a.order = car 
and a.color !=red 
or a.automatic !=auto 
```

这只是检查第一个条件并忽略第二个条件。

我只是无法理解它:(

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-01T00:37:20.897

从您的问题中不清楚，但您可能需要的只是将括号包裹在您的 OR 条件周围

鉴于下表和行

```
CREATE TABLE table_a 
    (
     id int primary key, 
     a_order varchar2(20), 
     color varchar2(40),
     automatic varchar2(10)
    )

/

INSERT INTO table_a VALUES (1,'car','red','auto')     /
INSERT INTO table_a VALUES (2,'car','red','manual')   /
INSERT INTO table_a VALUES (3,'car','blue','auto')    /
INSERT INTO table_a VALUES (4,'car','blue','manual') /
INSERT INTO table_a VALUES (5,'truck','red','auto')   /
INSERT INTO table_a VALUES (6,'truck','red','manual') /
INSERT INTO table_a VALUES (7,'truck','blue','auto') /
INSERT INTO table_a VALUES (8,'truck','blue','manual') / 
```

此 select 语句将返回记录 2、3 和 4，因为它们都是汽车并且是蓝色或手动的

```
SELECT * 
FROM   table_a a 
WHERE  a.a_order = 'car' 
       AND ( a.color != 'red' 
              OR a.automatic != 'auto' ) 
```

[演示](http://sqlfiddle.com/#!4/03a6f/4)

另一种选择是使用[德摩根定律](http://www.google.com/url?sa=t&rct=j&q=the%20negation%20of%20a%20conjunction%20is%20the%20disjunction%20of%20the%20negations&source=web&cd=1&ved=0CCUQFjAA&url=http://en.wikipedia.org/wiki/De_Morgan%27s_laws&ei=OTOfT_jNGcG46QG2kYmkAg&usg=AFQjCNEL7A8w_gruPMzeBOWR5sUn3HVYwQ)“析取的否定是否定的合取”来执行以下操作。

```
SELECT * 
FROM   table_a a 
WHERE  a.a_order = 'car' 
    AND NOT ( a.color = 'red' 
             AND a.automatic = 'auto' ) 
```

[演示](http://sqlfiddle.com/#!4/03a6f/6)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-01T19:48:26.227

AND 的优先级高于 OR 逻辑运算符。您可以在括号内使用 OR 条件。

```
SELECT * 
  FROM table_a a 
 WHERE a.a_order = 'car' 
   AND NOT ( a.color = 'red' 
        AND a.automatic = 'auto' ) 
```

# asp.net-mvc-3 - 为什么 jquery 在 mvc 3 应用程序中不起作用？

> ID：10392168
> 
> 赞同：1
> 
> 时间：2012-05-01T00:26:13.643
> 
> 标签：asp.net-mvc-3, c#-4.0, jquery

我的 _Layout.cshtml 中有一个 jquery 参考。看起来这在我的 Index.cshtml 页面中不起作用：/Home/GetSquareRoot 没有被击中？（当我取消注释 index.cshtml 中的 jquery 引用时，它可以工作）

ViewStart.cshtml

```
@{
    Layout = "~/Views/Shared/_Layout.cshtml";
} 
```

索引.cshtml

```
@{
    ViewBag.Title = "Home Page";
}
<h2>@ViewBag.Message</h2>
<p>
    To learn more about ASP.NET MVC visit <a href="http://asp.net/mvc" title="ASP.NET MVC Website">
        http://asp.net/mvc</a>.
</p>

@*<script src="../../Scripts/jquery-1.5.1.min.js" type="text/javascript"></script>*@

<script type="text/javascript">
    function calculateSquareRoot(numberToCalculate) {
        $.ajax({
            type: 'GET',
            url: '/Home/GetSquareRoot',
            data: { number: numberToCalculate },
            success: function (data) { alert(data.result); }
        });
    }

</script>

    <button type="button" onclick="calculateSquareRoot(9);">
        Calculate Square</button> 
```

_Layout.cshtml

```
<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8" />
    <title>@ViewBag.Title</title>
    <link href="@Url.Content("~/Content/Site.css")" rel="stylesheet" type="text/css" />
    <script src="@Url.Content("~/Scripts/jquery-1.5.1.min.js")" type="text/javascript"></script>
    <script src="@Url.Content("~/Scripts/modernizr-1.7.min.js")" type="text/javascript"></script>
    <script src="../../Scripts/jquery-1.5.1-vsdoc.js" type="text/javascript"></script>
</head>

<body>
    <div class="page">
        <header>
            <div id="title">
                <h1>My MVC Application</h1>
            </div>
            <div id="logindisplay">
                @Html.Partial("_LogOnPartial")
            </div>
            <nav>
                <ul id="menu">
                    <li>@Html.ActionLink("Home", "Index", "Home")</li>
                    <li>@Html.ActionLink("About", "About", "Home")</li>
                </ul>
            </nav>
        </header>
        <section id="main">
            @RenderBody()
        </section>
        <footer>
        </footer>
    </div>
</body>
</html> 
```

家庭控制器

```
 public JsonResult GetSquareRoot(long number)
        {
            var square = Math.Sqrt(number);
            return Json(new { result = square }, JsonRequestBehavior.AllowGet);
        } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-01T01:18:38.727

当您将 jQuery 引用注释掉时，它会起作用，因为您的 _Layout.cshtml 文件也有引用（只是陈述事实，我意识到您可能知道这一点）。

这也意味着您的路由设置正确，并且 URL '/Home/GetSquareRoot' 没有任何问题

代码看起来不错，我能看到的唯一未知数是 ../../Scripts/ 实际上与 ~/Scripts/ 位于同一个位置（取决于您页面的 URL 的样子）。

我会使用谷歌浏览器检查您页面上的脚本错误：转到您的页面，右键单击页面上的“检查元素”，然后检查您是否没有任何脚本错误（检查器的右下角会有一个如果你这样做，红色圆圈）。

如果您有可能阻止 AJAX 调用运行的脚本错误。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-01T02:47:02.647

在您的应用程序中引用硬编码的内容 URL 时，使用`Url.Content`.

所以代替这个：

```
<script src="../../Scripts/jquery-1.5.1-vsdoc.js" type="text/javascript"></script> 
```

用这个：

```
<script src="@Url.Content("~/Scripts/jquery-1.5.1-vsdoc.js")" type="text/javascript"></script> 
```

这样，无论页面的 URL 是什么，都将始终使用 jQuery 脚本文件的正确 URL。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-01T04:00:06.603

试试这个...

```
public JsonResult GetSquareRoot(long? number)
        {
            var square = Math.Sqrt(number);
            return Json(new { result = square }, JsonRequestBehavior.AllowGet);
        } 
```

# c# - 正则表达式（在 C# 中）以字符串开头，但匹配最后一次出现之后的所有内容...

> ID：10392172
> 
> 赞同：0
> 
> 时间：2012-05-01T00:26:46.110
> 
> 标签：c#, regex, expression

我正在尝试在 C# 中将许多文件中的一些“硬编码”变量初始化（来自自定义语言）解析到数据库中，但我遇到了问题：

**解析示例代码 #1 >>>**

```
ArrayName[ArrayIndexVariable].arrayPropertyNameHex            = $A3 
```

我正在尝试使用正则表达式：

```
string strRegExCriteria = @"^sArrayName\[ArrayIndexVariable\]\.arrayPropertyNameHex.+= ?(.+?)$"; 
```

然而，它返回.Success：

```
matchRegExCriteria.Groups[1].Value.ToString().Length.ToString(); 
```

...等于**0？**...

**解析 #2 的示例代码 >>>**

```
ArrayName[ArrayIndexVariable].arrayPropertyNameInt            = 6942 
```

我正在尝试使用正则表达式：

```
string strRegExCriteria = @"^sArrayName\[ArrayIndexVariable\]\.arrayPropertyNameInt.+?(\d+)$"; 
```

但是，它也返回 .Success：

```
matchRegExCriteria.Groups[1].Value.ToString().Length.ToString(); 
```

...等于**0？**...

有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-01T00:38:10.477

我认为您的问题是您在正则表达式中使用了贪婪的限定符。在您的正则表达式中（为便于阅读而分解）：

```
string strRegExCriteria = @"^sArrayName\[ArrayIndexVariable\]\." +
  @"arrayPropertyNameHex.+= ?(.+?)$"; 
```

您拥有`.+`after `arrayPropertyNameHex`，它“贪婪地”将所有内容匹配到行尾，因此您的捕获永远不会受到打击。只需将其更改为非贪婪匹配 ( `+?`)，它应该会更好地工作：

```
string strRegExCriteria = @"^sArrayName\[ArrayIndexVariable\]\." +
  @"arrayPropertyNameHex.+?= ?(.+?)$"; 
```

# git - 使用 git repo 和虚拟主机设置 MAMP

> ID：10392173
> 
> 赞同：1
> 
> 时间：2012-05-01T00:26:57.933
> 
> 标签：git, mamp, virtualhost

我在我的机器上设置了 MAMP 来开发一些网站内容，并且因为我想以有组织的方式分离我的项目，所以我为每个项目设置了虚拟主机，这是有效的。我在一个目录中为每个项目都有我的网络文件（javascripts、css、html、php），例如`/Users/Alex/Dropbox/code/projectX/`. 我的 MAMP 目录在其他方面与开箱即用的方式相同；所有 mysql 的东西都在`/Applications/MAMP/db`. `\projectX\`已经是一个 git 存储库，但我的 db 文件不受版本控制。

问题：如何对与每个 Web 项目关联的数据库进行版本控制？我脑子里有三种方法，不知道如何实现前两种。我更喜欢第一个，因为它看起来更简单，并且非常适合虚拟主机方案。

a) 将 projectX 的数据库目录移动到`\projectX\`文件夹中，然后就`git add`可以了。不过，我不知道如何告诉 MySQL 我这里有这个数据库，那里有那个数据库。

b）不知何故告诉git它也需要版本控制`Applications\MAMP\db\mysql\projectXdb`，就好像它在里面一样`\projectX\`

c）不要花哨，只需为数据库建立一个单独的存储库。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-01T02:46:19.413

首先，我会阅读[这篇](http://www.codinghorror.com/blog/2008/02/get-your-database-under-version-control.html)文章和他发布的链接——仅仅是因为它们是一本好书。

简而言之（这就是我可能误解了这个问题的地方），我认为将实际数据库存储到版本控制中并不是最明智的做法。相反，您需要决定一些存储数据库脚本的*系统*来控制/更改/设置数据库。因此，这些脚本可以绝对存储在代码文件结构中的任何位置。

*如果这个想法有效，那么您不必更改实际数据库的位置，并且 git 也不必关心实际数据库的位置。*

我建议的一个例子是制作这样的文件：

```
ALTER TABLE Customer
  ADD ShoeSize int NOT NULL DEFAULT 0
GO

INSERT INTO OrderStates 
   (OrderStateID, OrderState)
   VALUES(3, 'Cancelled')
GO 
```

然后将其存储到某个名为`/Users/Alex/Dropbox/code/projectX/db-scripts`或其他的目录中。在该目录中将包含随时管理/复制数据库所需的所有脚本。

编辑：

如果软件将所有信息保存在数据库本身中，则可能运行`mysqldump`（或等效）并将该脚本存储到代码中。

存储文本版本允许两件事：

a）它比存储二进制文件更有效/高效（如果我正确理解 RCS/git）

b) git 可以对文件进行差异和 grep 搜索。（如果已经有另一个工具可以做到这一点，这可能无关紧要）

# ms-access - 分层数据的自包含表格

> ID：10392179
> 
> 赞同：0
> 
> 时间：2012-05-01T00:27:52.460
> 
> 标签：ms-access

我正在尝试将立法存储在访问数据库中。由于编号和标题/副标题使用不一致，我打算将数据存储在一个平面表中，并使用“父”列将 ID 存储到标题、副标题或部分文本等。

所以 - 例如

```
ID     Section    Parent    Description
0      1                    Purposes of the act
1      a          0         The purpose of this act is to:
2      i          1         Manage data efficiently
3      ii         1         Test access
4      b          0         More data goes here 
```

将代表数据

```
1 - Purposes of the act
    a - The purpose of this act is to
        i - Manage Data Efficiently
        ii - Test Access
    b - More Data goes here 
```

我的问题是使用表单来有效地编辑数据。最好的方法（据我所见）是将一个表单作为子表单嵌入其中——这显然是不允许的。我的意图是有 2 个新按钮 - 一个用于新项目，一个用于新孩子。后者将创建一个子项并在子表单中显示它（和其他子项）。

还有另一种方法可以做到这一点吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-01T14:57:50.393

我会有一个显示整个法律/附则的连续表格（您应该能够对其进行格式化以在源查询中显示）；但是，可以双击每个部分以打开另一个表单（可能是模式）来编辑该部分。

从逻辑上讲，您可以控制插入、删除、缩进和突出特定部分。

我怀疑您还想为每个部分添加一个“订单”列。假设您要更改 1.ai 和 1.a.ii 的顺序。您不能更改 ID 列，因为它可能是自动编号。

当然，一个明显的问题是为什么不将法律/附则存储在 MS Word 中并将对其位置的引用存储在数据库中

# jquery - jquery fancybox 1.3.0 iframe

> ID：10392182
> 
> 赞同：0
> 
> 时间：2012-05-01T00:28:09.653
> 
> 标签：jquery, fancybox

我很难让 iframe 加载到覆盖中。我的用户级别能胜任html 5 css3 xhtml 并且可以阅读php 和JavaScript。我能够让 youtube 视频在 lightbox_frame 和 iframe 中播放。但不喜欢将 html 页面放入叠加层中的 iframe 中。我正在阅读fancyapps，示例是：Iframe

## 所以改编如下。

```
<div class="portfolio3_shadow">
 <a class="various" data-fancybox-type="iframe" href="page_slideshow">
<img src="../images/slideshow.png" alt=""  width="210" height="131"/></a>

<img src="../images/icon_zoom.png" style="margin-top:-30px;margin-left:86px;z-index:9999" alt=""/></div>
<div style="display:none;">
  <div id="page_slideshow" style="width:840px;height:600px">   
<iframe width="840" height="600" src="slideshow.html" frameborder="0" allowfullscreen></iframe> </div>  
    </div> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-06T05:33:25.777

除了定义 iframe 之外，您还可以提及 type: iframe 以在 fancybox 中将内容作为 iframe 来获取。

```
<a href="slideshow.html" id="popup">Open page</a> 
```

在脚本中你可以提到：

```
<script>
  $(document).ready(function(){
    $('#popup').fancybox({
        'zoomSpeedIn': 300,
        'zoomSpeedOut': 300,
        'overlayShow': false,
        'autoScale': false,
        'type': 'iframe',
        'centerOnScroll':true
      });
  });
</script> 
```

这会将页面的内容显示为覆盖中的 iframe。

# jquery - 不能抓住 img src 并将其分配给 div 作为 jquery 中的 BG？

> ID：10392183
> 
> 赞同：1
> 
> 时间：2012-05-01T00:28:30.397
> 
> 标签：jquery

嗨，这是 jquery 代码：

```
$(".c").mouseover(function() {
var colorbg = $(".c").attr("src");
$(".colortip").fadeIn(function() {
$(this).html('<img src="' + colorbg + '"/>');
return false;
});`enter code here`
}); 
```

和HTML如下：

```
img ...1
img....2
img ...3 
```

我想要做的是在鼠标悬停任何 img.c 时显示“colortip” div，同时我想将 img.c 图像源作为背景分配给 div.colortip

我编写了上面的代码，它可以显示 div，但它只为第一个 img 分配 BG，只有第一个 img src，并且没有检测到其他图像 src，当我将鼠标悬停在其他颜色的其他 div 上时，它不会改变它。 - 那么如何我可以每次将新的 img src 作为 bg 推送到 div 吗？

非常感谢您的帮助 - 谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-01T00:32:55.683

### *[jsBin 演示](http://jsbin.com/okaras/edit#javascript,html,live)*

利用`$(this)`

```
var colorbg = '';
$(".c").mouseover(function() {
   colorbg = $(this).attr("src");   // tada!
   $(".colortip").fadeIn(function() {
       $(this).html('<img src="' + colorbg + '"/>');
       return false;
   });
}); 
```

* * *

在我使用你的代码之后，这里是如何设置元素**CSS 背景**：

### *[jsBin demo（用jQ设置CSS背景）](http://jsbin.com/okaras/2/edit)*

```
var colorbg = '';
$(".c").mouseover(function() {
   colorbg = $(this).attr("src");   // tada!
   $(".colortip").fadeIn(function() {
     $(this).css({background: 'url('+colorbg+')'}); // access element CSS bG. 
       return false;
   });
}); 
```

# java - 关联缓存

> ID：10392184
> 
> 赞同：0
> 
> 时间：2012-05-01T00:28:43.740
> 
> 标签：java

我给了一个任务，我需要用 Java 模拟一个关联缓存。我们得到一组字节地址，我们需要找出每个地址是命中还是未命中。缓存由 32 个块组成，每个块为 8 个字节

所以方案如下：

*   从地址计算组地址（组地址是地址除以缓存中每个块的大小。例如地址 950 的组地址将是 950/8）
*   使用整个组地址作为标签
*   扫描整个缓存，看看标签是否已经在缓存中
*   如果找到标签，记录一次命中
*   如果未找到标签，则记录一次未命中，并将标签存储在第一个可用块中
*   如果没有可用空间，则从缓存中删除最近最少使用 (LRU) 块
*   更新缓存以存储新标签（如果有未命中）并记住此块是最近使用的最多的块。
*   将有效位设置为真，将标签存储在块中，记住最初使用的地址。

我遇到的问题是最近最少使用的位。我们被要求实现 LRU 的方式是保持块从最近使用到最近最少使用的顺序，当我们需要替换一个块时，我们从末尾删除旧块并将新块添加到开头。然后，当我们获得命中时，我们将命中移动到缓存的开头。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-01T00:36:06.453

您可以使用链表来实现这一点。当然，您需要想办法快速查找列表...

# javascript - 错误：将nodejs应用程序推送到heroku时找不到模块'mkdirp'

> ID：10392187
> 
> 赞同：1
> 
> 时间：2012-05-01T00:30:07.697
> 
> 标签：javascript, node.js, heroku, pug

我做 npm install -d，然后用 git heroku push master 推送我所有的东西。在我的 heroku 日志中，它会显示：

```
2012-05-01T00:21:37+00:00 heroku[web.1]: Starting process with command `node app.js`
2012-05-01T00:21:39+00:00 app[web.1]: 
2012-05-01T00:21:39+00:00 app[web.1]: node.js:201
2012-05-01T00:21:39+00:00 app[web.1]:               ^
2012-05-01T00:21:39+00:00 app[web.1]: Error: Cannot find module 'mkdirp'
2012-05-01T00:21:39+00:00 app[web.1]:     at Function._load (module.js:279:25)
2012-05-01T00:21:39+00:00 app[web.1]:     at Module.require (module.js:354:17)
2012-05-01T00:21:39+00:00 app[web.1]:         throw e; // process.nextTick error, or 'error' event on first tick
2012-05-01T00:21:39+00:00 app[web.1]:     at Function._resolveFilename (module.js:332:11)
2012-05-01T00:21:39+00:00 app[web.1]:     at require (module.js:370:17)
2012-05-01T00:21:39+00:00 app[web.1]:     at Object.<anonymous> (/app/node_modules/stylus/lib/middleware.js:16:14)
2012-05-01T00:21:39+00:00 app[web.1]:     at Module._compile (module.js:441:26)
2012-05-01T00:21:39+00:00 app[web.1]:     at Object..js (module.js:459:10)
2012-05-01T00:21:39+00:00 app[web.1]:     at Module.load (module.js:348:31)
2012-05-01T00:21:39+00:00 app[web.1]:     at Function._load (module.js:308:12)
2012-05-01T00:21:39+00:00 app[web.1]:     at Module.require (module.js:354:17)
2012-05-01T00:21:40+00:00 heroku[web.1]: Process exited with status 1
2012-05-01T00:21:40+00:00 heroku[web.1]: State changed from starting to crashed 
```

显然，当我在本地部署时，我没有这个问题。我的玉模块中有 mkdirp 模块，它位于我的应用程序的 node_modules 中。

我也有Procfile：

```
web: node app.js 
```

这是我的 package.json：

```
{
    "name": "gemini"
  , "version": "0.0.1"
  , "contributors": [ 
      { "name": "****", "email": "****" }
    ]
  , "private": true
  , "engines": { "node": ">= 0.2.0" }
  , "dependencies": {
      "express": "2.5.1"
    , "stylus": ">= 0.17.0"
    , "jade": "0.3.0"
  }
} 
```

有人可以请教吗？谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-01T23:25:58.633

我通过执行 npm install mkdirp 然后推送来修复它。

虽然我收到了一个警告，因为缺少 mkdirp 并默认为我刚刚安装的那个。可能是因为我知道我在玉石和手写笔的 node_modules 中也肯定有 mkdirp ？

无论如何，该应用程序现在已部署。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-01T00:54:07.873

在查看错误后，它与 Jade 无关，而与 Stylus 有关。这可能来自 Stylus 引用旧版本的问题，尽管使用`>=`应该意味着它将获取最新版本。

Heroku 推送应该列出 Heroku 检测到并安装的依赖项的模块。

~~您引用的 Jade 版本确实很旧，当前版本是**0.25.0**；你在哪里使用**0.3.0**。~~

我查看了那个版本，这是`package.json`内容：

```
{
  "name": "jade",
  "description": "Jade template engine",
  "version": "0.3.0",
  "author": "TJ Holowaychuk <tj@vision-media.ca>",
  "main": "./lib/jade.js",
  "bin": { "jade": "./bin/jade" },
  "engines": { "node": ">= 0.1.98" }
} 
```

您会注意到它没有指定 mkdirp 是一个依赖项，但它可能需要它（我没有深入研究源代码）。

~~我已经在 Heroku 上成功运行了 Jade 0.25.0，但从未尝试过旧版本。~~

# php - CSS 在 Wordpress 中显示图像的问题

> ID：10392188
> 
> 赞同：-1
> 
> 时间：2012-05-01T00:30:08.733
> 
> 标签：php, css, wordpress

我有一个博客并更改了模板的一些 php 和 css，以便它可以显示我需要的确切图像大小，如下所示：

[http://hynx.com.br/?page_id=230](http://hynx.com.br/?page_id=230)

旧模板用于每行显示 4 张图像，即使在调整大小之后，它似乎也是强制的。我试图用萤火虫改变几乎所有地方，以在“Goof Troop”图像消失之前缩小那个巨大的差距，但我就是做不到。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-01T00:37:38.427

您的循环末尾可能有这样的一行。

```
<?php if($i%4==0) : ?><?php endif; ?> 
```

如果是这样，只需将其更改为 3。

# ios - 在 Core Data 中创建新对象：先创建还是返回时创建？

> ID：10392194
> 
> 赞同：3
> 
> 时间：2012-05-01T00:32:21.440
> 
> 标签：ios, core-data, nsmanagedobject

所以我在核心数据上苦苦挣扎。我发现有很多方法可以做同样的事情，如果您尝试使用 Storyboards 和 UIManagedDocuments 构建应用程序，您需要阅读比去年更早的所有教程和示例以及翻译表。今天的问题是关于在添加新托管对象时找到最佳实践。我已经看到了两种方式的例子：

1.  在表视图控制器中创建新的托管对象（单击 + 后）并将新的闪亮托管对象提供给从属的“添加”视图控制器，以获取所有对象属性的用户输入。这看起来很简单，而且返回的对象也很容易理解，因为它包含所有单独的属性。但是我在这个“添加”视图控制器中看到了一个“取消”按钮的示例代码，该按钮删除传入的托管对象，然后在关闭自身之前调用 Save Context。功能性，但是我肩上的 MVC 培训 gnome 对我大喊大叫，让这个从属的 Add View 删除一个对象，并且*恐怖*直接调用 Save Context。Apple 的 Recipe 示例代码似乎使用了这种方法。

2.  不向添加视图控制器发送任何内容，并让它返回一个委托调用表视图控制器，该表视图控制器将每个属性作为单独的传递参数返回。所以返回方法变得很长：controller:(UIViewController *)controller didReturnFirstName:(NSString *)firstName andLastName:(NSString *)lastName andStreetAddress:(NSString *) and... and... and.. But this is SO与 MVC 教条一致，因为托管对象在接收到所有单独的属性时在表视图控制器中重新创建，并且“添加”视图永远不会触及模型（核心数据），或者在用户更改时丢弃未使用的托管对象他们的心思。
    即使使用链式委托方法，我仍在与自己争论哪种方法更好。来自使用这两种形式的人的评论和想法将是一个受欢迎的补充。

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-01T23:19:48.867

你是对的，有很多方法可以解决这个问题。

听起来好像你从一个可能无法保存的上下文开始，所以为了能够回到你的起点，我会这样处理它：

1.  首先创建一个新的 NSManagedObject 用作​​传递给“编辑”视图的临时对象。
2.  如果您正在编辑现有对象，请将现有对象中的属性复制到这个新的临时对象中（您可以使用快速 for 循环将它们全部复制）。否则继续新创建的对象。
3.  将临时对象传递给“编辑”视图控制器，让它对这两种情况一视同仁。
    一个。如果用户按下取消，则有一个协议或委托方法通知 tableview 和 tableview 然后简单地丢弃临时对象。
    湾。如果他们按下保存，通知表格视图，然后将临时副本中的属性复制回原始对象并删除临时对象（如果是编辑操作），或者如果它是“添加”，则将其保留为新创建的对象“ 手术。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-01T22:28:46.187

如果您查看 Apple[教程](https://developer.apple.com/library/ios/#documentation/iPhone/Conceptual/SecondiOSAppTutorial/CreatingAddView/CreatingAddView.html#//apple_ref/doc/uid/TP40011318-CH6-SW1)中的示例，他们通过执行以下概述的许多事情来完成此任务，在这种情况下，他们有一个模式视图来输入要添加到数据模型中的信息：

1.  在出现的模态视图中，他们创建了一个协议来处理关闭视图或保存数据以及实现该协议的类型 id 的属性作为委托，这确保了实现所需方法的任何对象

2.  在创建模态视图的视图控制器中，它们实现协议，包括将对象保存到数据模型和关闭模态视图

3.  在创建模态的视图控制器中，他们将创建模态视图的视图控制器设置为模态视图委托期间的模态视图委托

因此，总而言之，在模态视图中收集您需要的新数据：在 .h 中创建协议和属性并合成它

```
 @protocol yourProtocol <NSObject>;
 //methods that determine what happens based on what user does, it would save your core data object
 @end

 @property(nonatomic, weak) id<yourProtocol> delegate; 
```

然后，在模态视图 .m 文件中，您可能会在委托上调用这些方法，可能是在它们选择保存或完成时，因此每个方法的一个方法可能是连接到按钮的 IBAction

```
 [self.delegate myMethod]; 
```

在呈现模态视图的视图中，您在 .h 文件中实现协议

```
 @interface viewController() <yourProtocol> 
```

最后，将您的方法添加到显示模态视图的 .m 文件的视图控制器中，这应该包括删除视图并保存您的核心数据。根据Apple和其他消息来源，导致弹出/模式等的视图控制器应该是关闭它的视图控制器。然后，在使用序列缩进的序列中，将在模态视图中呈现的视图控制器设置为模态视图的委托。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-26T18:50:51.270

这不是一个真正的答案，所以可以随意忽略，但其他任何一个（到目前为止）都不是一个完整的答案，我觉得有必要在不创建新问题的情况下添加一些观点，因为我真的很想了解这也是底部。特别是答案应该处理

*   当您取消与保存时会发生什么
*   如果您想使用同一个控制器来编辑现有实体而不是创建新实体怎么办

尼克斯的答案涉及苹果（当前）传回数据的约定，但不是一个完整的答案，因为该教程不处理核心数据托管对象，而苹果自己的样本确实使用托管对象的做法有所不同。

但是在这个问题上，我发现委托约定在某些情况下很笨拙，并且很高兴从更有经验的开发人员那里阅读： [http ://robsprogramknowledge.blogspot.pt/2012/05/back-segues.html](http://robsprogramknowledge.blogspot.pt/2012/05/back-segues.html)

*Rob 详细介绍了所有同样有效*的不同机制，包括协议/委托约定（Nick's），使用没有协议的数据对象（所谓的“共享内存”） - 更像其他一些人建议的，以及 - 我的最喜欢的 - 使用块。块是一个不错的选择，因为虽然它像委托一样工作，但代码完全保留在“父”视图控制器源中的上下文中

*但是，“共享内存”更有意义，因为正如您所说，使用您已经设计*用于传递所有这些属性的数据（托管）对象以外的任何东西似乎很愚蠢。

那么我的问题是，创建这些托管对象的约定是什么，传递它们，然后要么 1\. 保存更改 2\. 取消更改 3\. 完全取消创建新实体

Inafzigers 上面的回答是这样的，但是为什么要复制所有属性呢？我*不能不保存*我的更改吗？

Apple 的 CoreDataBooks 似乎通过在 prepareForSegue 和委托方法（当它返回时）中创建*子*ManagedObjectContext 和该上下文中的新实体（insertNewObjectForEntityForName）来处理这个问题： - 如果单击“保存”，它会同时保存这个新实体ManagedObjectContext 和父 FetchedResultsContext 来存储对象 - 如果单击 Cancel 它什么也不做，有效地丢弃新的托管对象上下文，因此，大概，新对象

所以这*可能*是传统的方法，除了：

*   该示例的代码 (CoreDataBooks RootViewController.m) 中有一条注释指出两个托管上下文不是必需的，这意味着您可以只用一个来执行相同的操作。这是完整的评论： 重要提示：没有必要为此使用第二个上下文。您可以只使用现有的上下文，这将简化一些代码——例如，您不需要执行两次保存。但是，此实现说明了一种有时可能有用的模式（您想要维护一组单独的编辑）。

*   CoreDataBooks 不使用 UIManagedDocument - 不确定这是否会有所不同

我不清楚的是，我们真的要使用 insertNewObjectForEntityForName 来创建托管对象吗？如果用户点击保存，那么只创建对象然后仅在稍后插入它呢？

另外，如果我们进行编辑和取消，我们可以使用撤消管理器来消除更改吗？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-01T21:17:46.670

我认为正确的方法实际上是`NSManagedObjectContext`为您的 AddController（如果要创建新项目）或 EditController（如果要修改现有项目）创建一个新的、单独的。

根据您的 SDK 选择 A) 或 B)：

A) 然后您可以选择在该上下文中保存更改，或丢弃该上下文。

在“保存”的情况下，您可以通过 Notifications ( ) 将更改**合并**到 TableController 中。`ManagedObjectContext``NSManagedObjectDidSaveNotification`

在“取消”的情况下，您可以丢弃单独的上下文。

B) 或者，如果您使用的是 OSX 10.7(+)，您可以使用嵌套`NSManagedObjectContext`的 s，在 AddController（子上下文）中创建一个`NSManagedObjectContext`，并将它的 parentContext 设置为 TableController 的`NSManagedObjectContext`.

在“保存”的情况下，您将保存子上下文和父上下文。

在“取消”的情况下，您只需丢弃子上下文。

在 Apple 的 CoreDataBooks 示例中查看详细示例[http://developer.apple.com/library/ios/#samplecode/CoreDataBooks/Introduction/Intro.html](http://developer.apple.com/library/ios/#samplecode/CoreDataBooks/Introduction/Intro.html)

# iphone - UITableView 函数 visibleCells 是否返回自定义单元格数据？

> ID：10392196
> 
> 赞同：1
> 
> 时间：2012-05-01T00:32:44.770
> 
> 标签：iphone, objective-c, ios, tableview

我有许多自定义单元格对象（UITableViewCell 的子类），其中包含几个值，以允许在单个单元格中进行用户交互（如步进器或其他东西）。这些值存储在自定义单元格类中，因为当时调用表视图的所有者似乎是个坏主意。

我知道函数 (NSArray *) visibleCells。这将允许我访问单元格对象中的数据吗？

如果没有，怎么办？

我假设我可以使用 UITableView 的内置函数来拉取返回的 UITableViewCells，但是当我谈论一个被调用的子类时就足够了，比如 CustomizerCell？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-01T00:41:44.603

功能：

```
- (NSArray *)indexPathsForVisibleRows 
```

回答一组索引路径。这些索引路径的使用方式与 cellForRowAtIndexPath 使用传递的索引路径访问模型的方式相同。

```
MyObject *myCustomDataSupportingACell = [myDatasourceArray objectAtIndex:indexPath.row]; 
```

# mysql - MySql 查询中的 COUNT()、GROUP BY 和 NULL 值

> ID：10392197
> 
> 赞同：1
> 
> 时间：2012-05-01T00:32:52.527
> 
> 标签：mysql, count, group-by, isnull

我有这个 MySql 查询部分工作：

```
SELECT p.product_id, p.product_name, p.sales, 
   p.length, p.hits, COUNT(w.product_id) AS favorites 
   FROM `products` AS p, `products_mf_xref` AS m, 
   `wishlist_items`  AS w 
 WHERE m.manufacturer_id = '1' 
   AND p.product_id = m.product_id 
   AND m.product_id = w.product_id 
 GROUP BY m.product_id ORDER BY p.product_id ASC 
```

我正在从一个表中恢复一些字段，并试图获取这些产品在另一个表中被引用的次数（最后一个表被称为“whishlist”）。查询工作正常，但我只得到愿望清单表中至少引用一次的产品。

我读到 count(*) 没有得到有意义的 NULL 值，但我还需要愿望清单表中未引用的产品，我的意思是，COUNT(w.product_id) 等于“0”的产品。

任何想法恢复所有产品，包括空值？有什么想法可以更改我的查询吗？它会让我生气的！

提前致谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-01T00:39:13.587

使用左连接：

```
SELECT p.product_id, p.product_name, p.sales, 
   p.length, p.hits, COUNT(w.product_id) AS favorites 
   FROM `products` AS p 
   LEFT JOIN `products_mf_xref` AS m 
       ON p.product_id = m.product_id AND m.manufacturer_id = '1' 
   LEFT JOIN `wishlist_items`  AS w ON m.product_id = w.product_id 
 GROUP BY m.product_id ORDER BY p.product_id ASC 
```

顺便说一句，尽可能使用JOIN来镜像数据关系，使用WHERE作为过滤器

# .net - ClickOnce 设计了我们的可执行文件并显示“未知发布者”

> ID：10392201
> 
> 赞同：17
> 
> 时间：2012-05-01T00:33:12.300
> 
> 标签：.net, deployment, clickonce

我们正在开发一个通过 ClickOnce 部署的应用程序。我们有一个 VeriSign 代码签名证书，用于对我们的应用程序（通过`signtool.exe`后期构建）和 ClickOnce 清单进行签名。我们目前有两个与签名相关的问题：

1.  我们正在使用我们的证书签署我们的 .exe。在构建我们的应用程序之后，我们可以看到它已被签名（例如，通过“signtool verify /pa TheExecutable.exe”）。但是通过 ClickOnce 安装应用程序后，.exe 不再签名。

2.  我们正在使用我们的证书签署 ClickOnce 清单。但是当我们尝试通过 ClickOnce 安装应用程序时，ClickOnce 安装程序会显示“未知发布者”。

问题 #1 一直存在。问题 #2 有时会神秘地消失，但它总是在此后不久又回来，而且我们已经持续看到它几个星期了。

有任何想法吗？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-05-02T21:47:06.847

好的，解决了这个问题 1/2 的谜题：ClickOnce 从 获取应用程序清单`bin`，但从 获取实际的 EXE `obj`。为了分发您签名的 exe，**您必须对`obj`目录**中的文件进行签名。

**编辑：**这是另一半。安装 .NET 4.5 Beta 会中断 ClickOnce 签名/验证，即使在 VS2010 中也是如此。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-11-13T23:21:48.223

这是我处理签署清单和签署 exe 的方式。我将此添加到我的 .csproj 文件的底部（在文本编辑器中编辑它）。

```
 <Target Name="AfterBuild">
    <CallTarget Targets="SignOutput" />
    </Target>
    <Target Name="SignOutput">
    <PropertyGroup>
      <TsUrl>http://timestamp.comodoca.com/rfc3161</TsUrl>
    </PropertyGroup>
    <ItemGroup>
      <SignableFiles Include="$(ProjectDir)obj\$(ConfigurationName)\myappname.exe" />
    </ItemGroup>
    <Exec Command="signtool.exe sign /n &quot;My Company Name LLC&quot; /tr $(TsUrl) &quot;%(SignableFiles.Identity)&quot;" />
  </Target> 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-05-01T02:02:31.607

我会对你说实话，保罗。我从来没有对 ClickOnce 感到非常兴奋。除了手动发布/部署方面，该工具集似乎从未真正成熟过。通过 MSBuild 运行这些东西从来都不是一个好的体验，而且[Mage.exe](http://msdn.microsoft.com/en-us/library/acz3y3te.aspx)似乎总是对我有问题。大多数时候，我的问题都围绕着版本号设置不正确。

也就是说，我认为我们最大的麻烦来自试图通过 Visual Studio 中的设置 UI 来管理事物。尝试减少对 MSBuild“魔术”的依赖并将必要的参数传递到 MSBuild 并在 csproj 文件中进行更多控制，这对我很有帮助。

我不知道您的构建设置是什么样的，但对我们来说，我们让[Jenkins](http://en.wikipedia.org/wiki/Jenkins_%28software%29)运行一个[Rake](http://en.wikipedia.org/wiki/Rake_%28software%29)文件，该文件在解决方案上调用 MSBuild。这允许我们将特定参数从 Rake 文件发送到 MSBuild。

具体来说，我们推入`ApplicationVersion`、`ApplicationRevision`、`MinimumRequiredVersion`和 的值`OutDir`。至于 csproj 本身需要注意的事项，您要确保已设置`ManifestCertificateThumbprint`、和。我们还将默认构建目标设置为，但我不确定这是否相关。`ManifestKeyFile``GenerateManifests``SignManifests``Publish`

我无法解释为什么 ClickOnce 会“设计”您的可执行文件，除了您正在签名的可执行文件可能不是您认为打包在 ClickOnce 包中的那个。换句话说，它可能正在构建一个新的可执行文件并将其放入包中，而不是您已经签名的那个。不过，我想我必须更多地了解您的设置才能确定拨打电话。

对于它的价值，如果我可以再做一次，我不会把我的鸡蛋放在 ClickOnce 篮子里。对于运行 Internet Explorer 或已安装 Chrome 插件的用户来说，这确实是一次很棒的体验。这是更多的工作，但我目前正在研究一个模仿 Chrome 更新故事的解决方案。他们有一个供 Internet Explorer 用户使用的 ClickOnce 包，但它实际上只用于下载安装 Chrome.exe 和 Update.exe 的 Windows 安装程序包。他们在Omaha（也称为 Google 更新）[的技术文档中详细介绍了很多细节。](http://code.google.com/p/omaha/)

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2012-05-05T18:10:56.420

自己签署 setup.exe 时出现问题。我在为 MSFT 的 P&P 人员编写 ClickOnce 文章时遇到了这个问题。没有解决方法。

您的证书是否安装在您用于生成部署的用户帐户的证书存储中？它是否在 VS 解决方案本身中指定为文件？如果它是默认设置，并且您使用 msbuild 和 mage 生成部署，那么它出来签名好吗？

# php - facebook 应用程序，朋友数据访问令牌不起作用

> ID：10392203
> 
> 赞同：2
> 
> 时间：2012-05-01T00:33:29.387
> 
> 标签：php, facebook, facebook-graph-api, access-token

用户成功登录 facebook 应用程序。但是，该应用程序无法提取用户的朋友信息。它只能返回一位之前允许该应用获取她信息的朋友的信息。

我正在使用 curl 和访问令牌通过应用程序访问我朋友的 Facebook 数据。我正在本地开发我的应用程序。它适用于我以前拥有的那些帐户，但不适用于新用户。是什么原因造成的？

那是因为我现在正在本地主机上开发吗？如果是，为什么它适用于我拥有的几个帐户，而不适用于也允许我的应用程序的其他用户？我还尝试使用我拥有的访问令牌访问朋友数据，但无法访问开发人员网站上的任何数据。

```
$uri ="https://graph.facebook.com/".$friend_id."/books?access_token=".$params['access_token'];
$temp = json_decode(get_data($uri), true); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-01T00:49:39.027

在 localhost 上开发会导致 Facebook 出现问题。您将无法在 Facebook 上授权您的应用。

如果 Facebook Graph 发生任何有趣的事情，请确保您在“基本”权限选项卡中列出的同一服务器/URL 上进行开发。否则事情可能无法正常工作。

* * *

但是您的回答更恰当地与权限有关：以前的“朋友”已授予应用程序获取数据的权限。因此，即使以其他用户身份连接（甚至未连接），您也可以获取他们的数据。但是其他用户没有给权限，所以你无法获取数据。如果数据是“公开的”，则不需要，但如果数据不被视为公开，则需要它们。

检查您是否具有查询朋友数据的正确扩展权限 - 您可以要求朋友 A 授权从朋友 B 获取一些数据。在这种情况下，一位朋友授予您访问他们自己数据的权限，但请检查您可能需要哪些其他权限从未授权该应用程序的朋友那里获取详细信息 - 在某些情况下，不可能获取所有内容。

[https://developers.facebook.com/docs/authentication/permissions/](https://developers.facebook.com/docs/authentication/permissions/)

# c++ - 异或“Hello World！” 切断字符串

> ID：10392204
> 
> 赞同：19
> 
> 时间：2012-05-01T00:34:14.097
> 
> 标签：c++, c, xor

```
#include <stdio.h>
#include <string.h>

int main()
{
    char greeting[]="\nHello World!\n";
    int a;

    for(int i=0; i<strlen(greeting); i++)
        greeting[i]^=111;

    for(int i=0; i<strlen(greeting); i++)
        greeting[i]^=111;

    printf("%s\n",greeting);    
    scanf("%d",&a);

} 
```

输出：

```
Hell 
```

为什么在发现与 XOR 键的数字（在本例中为 ASCII 'w'）相对应的字母后会切断所有内容？在数理逻辑中，`N^N=0`并且`0^N=N`，不是吗？

* * *

## 回答 #1

> 赞同：56
> 
> 时间：2012-05-01T00:36:41.450

因为`'o'`是 ASCII 码 111，并且 XORing 111 与 111 产生 0, `NUL`, 并终止您的字符串。一旦发生这种情况（即使在第一个循环中，因为您每次都在通过循环评估它），`strlen`报告字符串要短得多，并且循环停止。

在通过 XOR 之前保存字符串长度将使您免于这样做。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2012-05-01T00:37:25.230

这是因为当您将一个数字与自身进行异或时，它变为零，而当 strlen 看到零时，它认为它是字符串的结尾。

如果您在第一个循环之前将长度存储在变量中，然后在第二个循环中使用保存的长度而不是 strlen，您的程序将产生预期的结果。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-05-01T09:02:19.453

`greeting[5]`是 'o'，在 ASCII 中是 111。因此 greeting[5] ^ 111 将为零（这将终止您的字符串）第二个循环中的 strlen 将返回不同的值。

要解决此问题，请使用变量 len 来存储原始 strlen。你会得到你的字符串！

**修改的：**

```
#include <stdio.h>
#include <string.h>

int main()
{
    char greeting[]="\nHello World!\n";
    int a;
    int len = strlen(greeting);

    for(int i=0; i<len; i++)
        greeting[i]^=111;

    for(int i=0; i<len; i++)
        greeting[i]^=111;

    printf("%s\n",greeting);    
    scanf("%d",&a);

} 
```

# c - 如何遍历 kmem_caches？

> ID：10392206
> 
> 赞同：0
> 
> 时间：2012-05-01T00:34:41.300
> 
> 标签：c, linux, kernel

我正在尝试做一些看起来应该非常简单的事情，遍历保存的 kmem_cache 对象`kmalloc_caches`以打印它们的名称。这总是以内核恐慌结束。我的 C 很生锈，所以如果我有什么误解，我会很感激任何照明。我添加了以下功能：

```
void *print_cachenames(void) {
    struct kmem_cache *k;
k = kmalloc_caches[0];
    printk(KERN_INFO "680: k[0] name: %s\n", k->name);
} 
```

到 mm/slub.c。它所做的只是尝试打印数组中第一个 kmem_cache 对象的名称。是什么导致它爆炸？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-01T03:45:14.273

您的函数被声明为返回 a `void *`，并且它根本没有返回任何东西。我不确定你的函数是从哪里调用的，但很可能它应该返回一些东西......

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-01T06:23:36.870

`kmalloc_caches[0]`似乎未使用。一般来说，您应该在尝试使用它之前检查您从缓存中读取的指针是否为 NULL：

```
void print_cachenames(void) {
        struct kmem_cache *k = kmalloc_caches[0];

        if (k && k->name)
                printk(KERN_INFO "680: k[0] name: %s\n", k->name);
        else 
                printk(KERN_INFO "680: k[0] == %p, has no name\n");
} 
```

# ruby-on-rails-3 - 一个动作的两个视图

> ID：10392207
> 
> 赞同：0
> 
> 时间：2012-05-01T00:35:11.833
> 
> 标签：ruby-on-rails-3

我的人员索引页面收到一个名为 city_name 的参数。如果 city_name 有效且明确，则显示该城市的所有人。但是，如果 city_name 参数匹配多个城市，我想向用户显示一个屏幕，告诉他选择所需的城市（然后他被重定向回具有明确查询的人员索引操作）。

正确的方法是什么？我是否应该在我的 PeopleController 中创建一个名为选择的操作，并在 city_name 不明确时重定向到它？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-01T06:01:05.393

我认为更好的方法是限制用户使用 select 标签仅选择一个选项。它避免了像只选择一个选项这样简单的事情的服务器之旅。如果出于某种原因您更喜欢在服务器端执行此操作，那么您只需显示 flash 消息：

```
flash[:notice] = "Please select only one city" 
```

并保持在同一个索引页面上，直到您只获得一个城市。

# java - 神奇的 System.out.println("prompt"); 不会显示输出

> ID：10392209
> 
> 赞同：-2
> 
> 时间：2012-05-01T00:35:44.737
> 
> 标签：java, println

下面显示的代码是我正在创建的迷宫游戏的主要方法。在这个主要方法中，我有一个 while 循环，一直持续到游戏结束。在 while 循环中，我打印迷宫，然后询问用户他们想要移动角色的方向。我有一个疯狂的问题，提示用户询问密钥，不会显示。输出只是打印迷宫，然后等待用户输入。

```
 do
        {               
            maze.printArray();              
            //Asks the user which direction they wish to move THIS LINE NEVER SHOWS UP!
            System.out.print ("Enter U,L,D,R to indicate move direction:   ");              
            //Gets the string from user, and changes it to a char, then converts it to an uppercase 
            direction = read.next().charAt(0);
            direction = Character.toUpperCase(direction);                   
            //Moves the character and increments the invalidMoves counter if the move was not legal
            if(maze.move(direction) == false)
                invalidMoves++;                 
            //Increment the move count regardless of its validity
            moves++;
        }
        while(maze.isFinished() == false); 
```

这是在打印之前调用的 printArray 方法。

```
public void printArray() 
{
    for (char [] x : mazeArray) 
    {
        for (char y : x) 
        {
            //Print the characters for the row
            System.out.print (y);
        }           
        //linebreak to go to next row
        System.out.println ();
    }
    System.out.println ();
} 
```

2D 数组包含一个迷宫图案，它会显示在屏幕上

```
XXXXXXXXXX
XO-------X
XX-XXX-XXX
XX---X---X
XXXX-X-X-X
X----X-XXX
X-XXXX--$X
XXXXXXXXXX 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-01T00:42:01.233

`System.out.flush();`之后试试`print()`。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-01T05:49:46.890

如果您的代码调用了 System.setOut(printStream)，您可以使用以下命令将其恢复为标准输出：

```
System.setOut(new PrintStream(new FileOutputStream(FileDescriptor.out))); 
```

如果在调用进程时 stdout 被重定向到某个地方，您可以使用以下命令指定您自己的 PrintStream：

```
System.setOut(new PrintStream(new FileOutputStream("out.txt"))); 
```

或者您可以直接写入 PrintStream：

```
PrintStream ps = new PrintStream(new FileOutputStream("out.txt"));
ps.println("hi"); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-01T00:38:04.317

尝试`println`而不是`print`...

# java - 防止递归函数导致“越界”错误

> ID：10392210
> 
> 赞同：0
> 
> 时间：2012-05-01T00:35:48.173
> 
> 标签：java

我一直在开发一个程序来计算输入文本中的元音。每次找到元音时，它使用此方法递归地添加元音计数。但是，每次达到负 1 时都会出现越界错误。一旦达到 -1 `lastPos`，我怎样才能让它停止？`lastPos`

```
static int R_countVowels(String s, int lastPos) 
{           
    switch (s.charAt(lastPos))
    {  case 'a': case 'A':
       case 'e': case 'E':
       case 'i': case 'I':
       case 'o': case 'O':
       case 'u': case 'U': return (1 + R_countVowels(s, --lastPos));
       default: return R_countVowels(s, --lastPos);
    }
} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-01T00:37:31.203

我假设这是家庭作业，所以没有代码。

递归函数需要一个[基本情况](http://en.wikipedia.org/wiki/Mathematical_induction#Description)。您需要定义基本情况以返回 0（无元音）作为空输入，并在归纳步骤（递归调用）之前检查基本情况。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-01T00:38:05.183

在:`if`之前插入一个`switch()`

```
if (lastpos < 0) {
  // stop the recursion
} 
```

# django - 为什么当我尝试登录时 django 无法识别我的管理员用户/密码？

> ID：10392214
> 
> 赞同：0
> 
> 时间：2012-05-01T00:36:20.727
> 
> 标签：django, google-app-engine, django-admin

这是我所做的：

```
> python manage.py createsuperuser
Username (Leave blank to use 'joe'): admin
E-mail address: random_email@yahoo.com
Password:
Password (again):
Superuser created successfully.
Exception AttributeError: "'NoneType' object has no attribute 'mkstemp'" in <bound method DatastoreFileStub.__del__ of <google.appengine.api.datastore_file_stub
.DatastoreFileStub object at 0x02928470>> ignored

> python manage.py shell
[1]: from django.contrib.auth.models import User
[2]: users = User.objects.all()
[3]: users
[3]: [<User: admin>]
[4]: users[0].set_password('password')
[5]: users[0].save()
[6]: exit()
Exeption AttributeError: "'NoneType' object has no attribute 'mkstemp'" in <bound method DatastoreFileStub.__del__ of <google.appengine.api.datastore_file_stub
tastoreFileStub object at 0x028D9490>> ignored

> python manage.py syncbd
Creating tables ...
Installing custom SQL ...
Installing indexes ...
No fixtures found.
Exception AttributeError: "'NoneType' object has no attribute 'mkstemp'" in <bound method DatastoreFileStub.__del__ of <google.appengine.api.datastore_file_stub
.DatastoreFileStub object at 0x02A83310>> ignored

> python manage.py validate
0 errors found
Exception AttributeError: "'NoneType' object has no attribute 'mkstemp'" in <bound method DatastoreFileStub.__del__ of <google.appengine.api.datastore_file_stub
.DatastoreFileStub object at 0x028A3310>> ignored 
```

当我尝试登录时：[http://127.0.0.1:8000/admin/](http://127.0.0.1:8000/admin/)，它一直说用户/密码组合是错误的。我需要启用管理页面的任何特定文件吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-01T13:24:17.453

就像 agf 在他的评论中所说的那样，这似乎是一个数据库设置问题。您的模型中定义的内容与 db.xml 中定义的内容之间存在差异。

检查你是否已经跑过`./manage.py syncdb`或者跑的时候会发生什么`./manage.py validate`？

**根据评论更新**

> App Engine 不支持 Django 模型。您必须使用 App Engine 的 db.models 或 ndb.models API 编写模型。

请参阅此链接：[数据存储在 localhost 但不在 gae 数据存储中？](https://stackoverflow.com/questions/10327151/data-is-stored-on-localhost-but-not-on-gae-datastore)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-01T04:50:15.530

此外，`users[0]`不会对整体`QuerySet`进行评估和缓存。您需要评估整体`QuerySet`或分配`users[0]`给某个变量并使用该变量：

```
>>> users[0] is users[0]
False
>>> user = users[0]
>>> user is user
True
>>> len(users); users[0] is users[0]
True 
```

首领难当啊～

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-01T01:59:41.967

如果您使用的是 1.6.4 SDK，则存在一个错误，即数据库不保存在 exit() 上。

我相信这在 1.6.5 上是固定的。

# ios5 - 架构 i386 的突然未定义符号

> ID：10392215
> 
> 赞同：1
> 
> 时间：2012-05-01T00:36:26.780
> 
> 标签：ios5

我有一个昨天构建并运行的项目，但今天它没有链接。我没有改变任何东西。我不知道这是什么原因造成的。我没有看到它所指的 main.o 和 _main。有任何想法吗？我尝试了清洁和构建。我在这个网站上看了几件事，但没有看到任何线索。

```
Ld /Users/michelecleary/Library/Developer/Xcode/DerivedData/Hackbook-dpdqkbplprywqfeflsbqlgpwbioo/Build/Products/Debug-iphonesimulator/Hackbook.app/Hackbook normal i386
cd /Users/michelecleary/fbPic2/facebook-ios-sdk/sample/Hackbook
setenv MACOSX_DEPLOYMENT_TARGET 10.6
setenv PATH "/Applications/Xcode.app/Contents/Developer/Platforms/iPhoneSimulator.platform/Developer/usr/bin:/Applications/Xcode.app/Contents/Developer/usr/bin:/usr/bin:/bin:/usr/sbin:/sbin"
/Applications/Xcode.app/Contents/Developer/Toolchains/XcodeDefault.xctoolchain/usr/bin/clang -arch i386 -isysroot /Applications/Xcode.app/Contents/Developer/Platforms/iPhoneSimulator.platform/Developer/SDKs/iPhoneSimulator5.0.sdk -L/Users/michelecleary/Library/Developer/Xcode/DerivedData/Hackbook-dpdqkbplprywqfeflsbqlgpwbioo/Build/Products/Debug-iphonesimulator -F/Users/michelecleary/Library/Developer/Xcode/DerivedData/Hackbook-dpdqkbplprywqfeflsbqlgpwbioo/Build/Products/Debug-iphonesimulator -filelist /Users/michelecleary/Library/Developer/Xcode/DerivedData/Hackbook-dpdqkbplprywqfeflsbqlgpwbioo/Build/Intermediates/Hackbook.build/Debug-iphonesimulator/Hackbook.build/Objects-normal/i386/Hackbook.LinkFileList -mmacosx-version-min=10.6 -Xlinker -objc_abi_version -Xlinker 2 -Xlinker -no_implicit_dylibs -D__IPHONE_OS_VERSION_MIN_REQUIRED=40000 -o /Users/michelecleary/Library/Developer/Xcode/DerivedData/Hackbook-dpdqkbplprywqfeflsbqlgpwbioo/Build/Products/Debug-iphonesimulator/Hackbook.app/Hackbook

Undefined symbols for architecture i386:
  "_objc_msgSend", referenced from:
    _main in main.o
    -[HackbookAppDelegate application:didFinishLaunchingWithOptions:] in HackbookAppDelegate.o
    -[HackbookAppDelegate applicationDidBecomeActive:] in HackbookAppDelegate.o
    -[HackbookAppDelegate application:handleOpenURL:] in HackbookAppDelegate.o
    -[HackbookAppDelegate application:openURL:sourceApplication:annotation:] in HackbookAppDelegate.o
    -[HackbookAppDelegate dealloc] in HackbookAppDelegate.o
    -[RootViewController dealloc] in RootViewController.o
  ...
  "_UIApplicationMain", referenced from:
    _main in main.o
  "_OBJC_CLASS_$_NSAutoreleasePool", referenced from:
    objc-class-ref in main.o
  "_NSLog", referenced from:
    -[HackbookAppDelegate applicationDidBecomeActive:] in HackbookAppDelegate.o
    -[RootViewController fbDidExtendToken:expiresAt:] in RootViewController.o
    -[RootViewController request:didFailWithError:] in RootViewController.o
    -[APICallsViewController apiGraphUserPhotosPost] in APICallsViewController.o
    -[APICallsViewController request:didFailWithError:] in APICallsViewController.o
    -[APICallsViewController dialogCompleteWithUrl:] in APICallsViewController.o
    -[APICallsViewController dialogDidNotComplete:] in APICallsViewController.o
    ... 
```

# performance - 从 IIS 7.5 切换到 Apache

> ID：10392216
> 
> 赞同：0
> 
> 时间：2012-05-01T00:36:39.173
> 
> 标签：performance, apache, iis, switch-statement, apc

我正在考虑从 IIS 7.5 切换到 Apache。
我已经尝试在 nginx 上运行 PHP (FastCGI)，但与 IIS 7.5 相比性能非常糟糕

因为我无法在 Windows 上找到 IIS 和 Apache 之间的性能基准 (PHP)，所以我想请您提供经验/反馈。
我在 IIS 上使用 WinCache，在 Apache 上使用 eAccelerator。APC呢？

该开关将仅用于性能增益。

**更新：**我尝试使用 mod_php 和 mod_apc 运行 Apache。但是该网站感觉明显比使用 IIS 慢。这是正常的吗？该应用程序完全支持 APC。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-01T00:41:37.430

APC 将包含在 PHP 6 中，我猜它被选中是有充分理由的 :) 尽管它的性能非常好，但不如 eAccelerator。并且它与 Zend Optimizer 存在兼容性问题。

*   资料来源：[apc vs eaccelerator vs xcache](https://stackoverflow.com/questions/930877/apc-vs-eaccelerator-vs-xcache)

# iphone - 如果 UILabel 的内容不适合，请更改文本末尾的默认“...”

> ID：10392217
> 
> 赞同：6
> 
> 时间：2012-05-01T00:36:39.983
> 
> 标签：iphone, objective-c, uilabel

我的 iPhone 项目中有一个 UILabel，它具有固定的宽度和高度，但它的内容可能会因用户正在查看的内容而异。有时文本对于 UILabel 来说太大了，那就是字符串：'...' 被添加到行尾。我想知道是否可以将此字符串更改为其他内容，例如：'(more)'。

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-01T02:36:38.720

不幸的是，根据这个类似的问题，iOS 中似乎不包含这样的选项：[如何更改 UILabel 中的截断字符？](https://stackoverflow.com/questions/4793420/how-to-change-truncate-characters-in-uilabel)

但是，正如上述问题中的答案所示，这可以自己轻松完成。您真正需要做的就是找到字符串被截断的位置并减去您选择的结束字符所需的数量。然后将其余部分放在单独的字符串中。

对于这种方法，这个答案也很有用：

> 正如Javanator所说，您必须自己进行截断。您应该在 UIKit 添加到 NSString 类时使用 sizeWithFont:forWidth:lineBreakMode: 消息来获取具有特定字体的字符串的宽度。这将处理所有类型的字体。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-01T02:44:25.343

我认为这是一个有趣的问题，所以构建并几乎没有测试过......

```
- (void)setText:(UILabel *)label withText:(NSString *)text andTruncationSuffix:(NSString *)truncationSuffix {

    // just set the text if it fits using the minimum font
    //
    CGSize size = [text sizeWithFont:[UIFont systemFontOfSize:label.minimumFontSize]];
    if (size.width <= label.bounds.size.width) {
        label.text = text;
        return;
    }

    // build a truncated version of the text (using the custom truncation text)
    // and shrink the truncated text until it fits
    NSInteger lastIndex = text.length;
    CGFloat width = MAXFLOAT;

    NSString *subtext, *ellipticalText;

    while (lastIndex > 0 && width > label.bounds.size.width)  {
        subtext = [text substringToIndex:lastIndex];
        ellipticalText = [subtext stringByAppendingString:truncationSuffix];
        width = [ellipticalText sizeWithFont:[UIFont systemFontOfSize:label.minimumFontSize]].width;
        lastIndex--;
    }
    label.text = ellipticalText;
} 
```

像这样称呼它：

```
[self setText:self.label withText:@"Now is the time for all good men to come to the aid of their country" andTruncationSuffix:@" more"]; 
```

如果这对你有用，你可以考虑添加一个 UILabel 的子类，使用它来覆盖 setText: 方法，并添加一个名为 truncatedSuffix 的属性。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2015-08-05T07:53:59.410

如果您使用的是 iOS 版本 > 8.0，则可以使用[ResponsiveLabel](https://github.com/hsusmita/ResponsiveLabel)。在这里，您可以提供自定义的截断标记以及定义操作以使其可点击。

```
NSString *expansionToken = @"Read More ...";
NSString *str = @"Lorem ipsum dolor sit er elit lamet, consectetaur cillium adipisicing pecu, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua.";
NSMutableAttributedString *attribString = [[NSMutableAttributedString alloc]initWithString:kExpansionToken attributes:@{NSForegroundColorAttributeName:[UIColor blueColor],NSFontAttributeName:self.customLabel.font}];
[self.customLabel setAttributedTruncationToken:attribString withAction:^(NSString *tappedString) {
 NSLog(@"Tap on truncation text");
}];
[self.customLabel setText:str withTruncation:YES]; 
```

# c# - 带有帮助器的 MVC 唯一 HTML ID

> ID：10392220
> 
> 赞同：0
> 
> 时间：2012-05-01T00:36:49.430
> 
> 标签：c#, asp.net-mvc-3

MVC 新手

该模型是一个列表：

```
public class person
{
[Display(Name = "ID")]
public object personID{ set; get; }
[Display(Name = "Last Name")]
public object personLastName { set; get; }
[Display(Name = "First Name")]
public object personFirstName{ set; get; }
} 
```

在观点上：

```
@model = List<person>
foreach(person member in Model)
{
Html.LabelFor(member.personLastName)
Html.EditorFor(member.personLastName) 
```

等等

每个标签都将关注第一个编辑器，我假设所有的 ID 都是相同的。在每个助手中将 id 作为“fieldname + id”传递是可行的，但是很乏味，有没有简单的方法来创建 id 或更合适的做事方式？

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-01T00:44:03.693

看起来您正试图允许编辑模型列表。我强烈建议您阅读[Phil Haacked - 模型绑定到列表](http://haacked.com/archive/2008/10/23/model-binding-to-a-list.aspx)。这是一个很好的入门资源。

# ruby-on-rails - 为什么 Foo.first 返回最后一条记录？

> ID：10392225
> 
> 赞同：4
> 
> 时间：2012-05-01T00:37:43.600
> 
> 标签：ruby-on-rails, ruby-on-rails-3, postgresql, activerecord

我有 2 条记录`Foo`，id 分别为 1 和 2。两者都是按此顺序创建的。请记住，在 Postgres 中，记录没有固有的顺序。

在 Rails 控制台中。`Foo.first`并`Foo.last`返回最后一条记录。我的印象是`Foo.first`会返回第一条记录。

这就是问题所在。SQL 查询如下所示：

```
SELECT "foos".* FROM "foos" LIMIT 1
SELECT "foos".* FROM "foos" ORDER BY "foos"."id" DESC LIMIT 1 
```

第二个查询 ( `Foo.last`) 有一个`ORDER BY DESC`. 那么为什么 AR 没有`ORDER BY ASC`for`.first`呢？这背后的逻辑是什么？似乎有点“不一致”。

我可以通过以下方式轻松解决这个问题：`Foo.order('id ASC').first`相反。而是寻求解释。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-01T01:23:00.790

它没有任何逻辑，如果有任何意义`first`（或就此而言），那么如果您忽略将显式顺序指定为当前范围链的参数或作为当前范围链的一部分，`last`它将引发异常。`first`除非明确指定了顺序，否则在关系数据库的上下文中既不`first`也没有`last`任何意义。

我的猜测是，`first`如果`order by whatever_the_pk_is`没有明确`order by`的 . 然后他们可能做了一些实验来凭经验验证他们的假设，并且它恰好与他们检查的特定表和数据库一样工作（迷你咆哮：这就是为什么你永远不会假设未指定的行为；如果一个特定的行为是'没有明确指定，即使当前实现的行为方式是这样，或者如果经验证据表明它的行为方式是那样，也不要假设它）。

如果你追踪一个简单的`M.first`，你会发现[它是这样做的](https://github.com/rails/rails/blob/90d96353e6dcd962b182e03f53f2214acde00907/activerecord/lib/active_record/relation/finder_methods.rb#L114)：

```
limit(1).to_a[0] 
```

没有显式排序，因此您可以获得数据库感觉使用的任何随机排序，这可能是`order by pk`或者它可能是磁盘上表的块顺序。如果你追溯`M.last`，你会得到[`find_last`](https://github.com/rails/rails/blob/90d96353e6dcd962b182e03f53f2214acde00907/activerecord/lib/active_record/relation/finder_methods.rb#L381)：

```
def find_last
  #...
        reverse_order.limit(1).to_a[0]
  #...
end 
```

并且[`reverse_order`](https://github.com/rails/rails/blob/90d96353e6dcd962b182e03f53f2214acde00907/activerecord/lib/active_record/relation/query_methods.rb#L253)：

```
def reverse_order
  relation = clone
  relation.reverse_order_value = !relation.reverse_order_value
  relation
end 
```

实例变量未初始化，`@reverse_order_value`因此它将以 as 开始，`nil`而 a`!`会将其转换为`true`. 如果你四处寻找如何`@reverse_order_value`使用，你会得到[`reverse_sql_order`](https://github.com/rails/rails/blob/90d96353e6dcd962b182e03f53f2214acde00907/activerecord/lib/active_record/relation/query_methods.rb#L394)：

```
def reverse_sql_order(order_query)
  order_query = ["#{quoted_table_name}.#{quoted_primary_key} ASC"] if order_query.empty?
  #... 
```

并且有作者关于订购的无效假设暴露给所有人看。那条线应该是：

```
raise 'Specify an order you foolish person!' if order_query.empty? 
```

我建议您始终使用`.order(...).limit(1).first`而不是`first`or`last`以便一切都很好且明确；当然，如果您`last`愿意，可以颠倒`.order`条件。或者你总是可以说`.first(:order => :whatever)`并`.last(:order => :whatever)`再次明确一切。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2016-02-11T12:19:11.470

对于 Rails 版本 4+，如果您不定义任何顺序，它将按主键排序。

```
# Find the first record (or first N records if a parameter is supplied).
# If no order is defined it will order by primary key.
#
#   Person.first # returns the first object fetched by SELECT * FROM people
#   Person.where(["user_name = ?", user_name]).first
#   Person.where(["user_name = :u", { u: user_name }]).first
#   Person.order("created_on DESC").offset(5).first
#   Person.first(3) # returns the first three objects fetched by SELECT * FROM people LIMIT 3
def first(limit = nil)
  if limit
    if order_values.empty? && primary_key
      order(arel_table[primary_key].asc).limit(limit).to_a
    else
      limit(limit).to_a
    end
  else
    find_first
  end
end 
```

来源：[https ://github.com/rails/rails/blob/4-0-stable/activerecord/lib/active_record/relation/finder_methods.rb#L75-L82](https://github.com/rails/rails/blob/4-0-stable/activerecord/lib/active_record/relation/finder_methods.rb#L75-L82)

# silverlight - Silverlight/ImageTools 将网络摄像头图像源转换为 Jpeg 不起作用

> ID：10392232
> 
> 赞同：0
> 
> 时间：2012-05-01T00:38:47.297
> 
> 标签：silverlight, image

我有一个实用程序，除了上传文件的另一个选项外，它还允许用户拍摄相机照片并上传。我已经完成了大部分工作，除了我必须在上传之前将网络摄像头图像转换为 jpg 的部分。下面的代码没有错误，但会产生无效的图像数据：

```
void CaptureImageCompleted(object sender, CaptureImageCompletedEventArgs e)
{
    busyIndicator.IsBusy = true;
    stopCapture();
    capturedImage.ImageSource = e.Result;

    ImageTools.ExtendedImage eimg = e.Result.ToImage();
    var encoder = new ImageTools.IO.Jpeg.JpegEncoder();

    Stream stream = eimg.ToStreamByExtension("jpg");

    //DO THIS LATER
    //if (stream.Length > 512000)
    //{
    //    eimg = ExtendedImage.Resize(eimg, 240, new NearestNeighborResizer());
    //    stream = eimg.ToStreamByExtension("jpg");
    //}

    encoder.Encode(eimg, stream);

    BitmapImage bitmap = new BitmapImage();
    bitmap.SetSource(stream);

    byte[] bytes = new byte[stream.Length];
    stream.Read(bytes, 0, (int)stream.Length);

    // picture file a class object to be used by uploader
    pictureFile.PictureName = "webcam.jpg";  // name will be changed later
    pictureFile.PictureStream = bytes;

    HtmlPage.Window.Invoke("gotDetails_WebCam", "");  // post page, then come back and do upload
} 
```

这是 PictureFile 的样子：

```
[DataContract]
public class PictureFile
{
    [DataMember]
    public string PictureName { get; set; }

    [DataMember]
    public byte[] PictureStream { get; set; }
} 
```

谁能弄清楚我在生成 jpeg 所需的字节时做错了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-02T07:16:09.063

很高兴看到你解决了，

这是我的运行代码，我使用 png 格式，还有文件大小检查。也许它可以帮助别人。

dSrvPR 是我的域服务类实例

photo 是我的 EF 中的实体对象。

```
_captureSource.CaptureImageCompleted += ((s, args) =>
        {
            if (dSrvPR.PR_PATIENTPHOTOs.Count > 0 && photo != null)
            {
                dSrvPR.PR_PATIENTPHOTOs.Remove(photo);
            }

            dSrvPR.PR_PATIENTPHOTOs.Clear();

            photo = new PR_PATIENTPHOTO();

            ImageTools.ExtendedImage eimg=args.Result.ToImage();
            var encoder=new ImageTools.IO.Png.PngEncoder();                                 

            Stream stream= eimg.ToStreamByExtension("png");
            if (stream.Length > 512000)
            {                    
                eimg= ExtendedImage.Resize(eimg, 240, new NearestNeighborResizer());                    
                stream = eimg.ToStreamByExtension("png");
            }                     
            if (stream.Length <= 512001)
            {
                BinaryReader binary = new BinaryReader(stream);
                //Read bytes from the BinaryReader and put them into a byte array.
                Byte[] file = binary.ReadBytes((int)stream.Length);
                photo.ID = Guid.NewGuid();
                photo.PHOTO = file;
                photo.PHOTODATE = DateTime.Now;
                photo.ISACTIVE = true;
                //some more unrelated fields
                dSrvPR.PR_PATIENTPHOTOs.Add(photo);
                dSrvPR.SubmitChanges();
  //Msg succedded
            }
            else
            {
                Util.alert(...,"file size exceeded! :)";
            }

        }); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-01T13:40:14.340

我的错。似乎我在那里有一些额外的代码（不必要地将流转换为位图）。这是我的工作：

```
void CaptureImageCompleted(object sender, CaptureImageCompletedEventArgs e)
{
    busyIndicator.IsBusy = true;
    stopCapture();
    capturedImage.ImageSource = e.Result;

    ImageTools.ExtendedImage eimg = e.Result.ToImage();
    var encoder = new ImageTools.IO.Jpeg.JpegEncoder();

    Stream stream = eimg.ToStreamByExtension("jpg");

    byte[] bytes = new byte[stream.Length];
    stream.Read(bytes, 0, (int)stream.Length);

    // picture file a class object to be used by uploader
    pictureFile.PictureName = "webcam.jpg";  // name will be changed later
    pictureFile.PictureStream = bytes;

    HtmlPage.Window.Invoke("gotDetails_WebCam", "");  // post page, then come back and do upload
} 
```

# module - 如何将模块添加到 WeScheme

> ID：10392237
> 
> 赞同：2
> 
> 时间：2012-05-01T00:40:16.177
> 
> 标签：module, scheme, racket, wescheme

我目前正在开发一个程序，该程序使用图像并需要添加[此问题中提到的模块](https://stackoverflow.com/questions/10318208/how-to-change-image-sizes-in-racket/10318391#10318391)

```
(require 2htdp/image) 
```

我提出了错误

```
I see a require of the module 2htdp/image,
but I don't yet know what this module is. 
```

我该如何解决这个问题？我不知道如何让 WeScheme 知道模块是什么。
提前致谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-01T02:08:51.613

[`2htdp/image`](http://docs.racket-lang.org/teachpack/2htdpimage.html)[是Racket](http://racket-lang.org/)附带的 How to Design Programs 教学包的一部分，如果你需要它，你应该使用 Racket 作为你的 Scheme 解释器。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-01T01:57:09.717

从错误消息来看，您似乎打算写`2htdp/image`，但您写的是`htdp2/image`。注意不同的位置`2`。

# javascript - 在 SVG 世界地图上叠加工具提示样式数据

> ID：10392238
> 
> 赞同：2
> 
> 时间：2012-05-01T00:40:20.620
> 
> 标签：javascript, svg, tooltip

我有一张世界的 SVG 地图（基于[来自 wikipedia 的公共域文件](http://en.wikipedia.org/wiki/File%3aBlankMap-World6.svg)），并带有生成的 CSS 以突出显示各个国家。

我需要添加鼠标悬停工具提示，其中包含有关每个国家/地区的其他数据，这些数据将由 PHP 提供。

我是一位经验丰富的网络程序员，但直到现在还没有使用过 SVG。在用户鼠标下显示文本工具提示的最佳方法是什么，以及有关鼠标光标下特定 SVG 节点的信息？

请注意，这个 SVG 充满了精美的`id`属性`class`，旨在促进这种使用。

我需要它尽可能跨浏览器，但很高兴禁用某些浏览器（旧版本的 Internet Explorer）的功能。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-01T01:15:19.473

1.  检测鼠标悬停事件
2.  访问`title`信息
3.  创建或显示一组标题元素
    *   将它们附加到 SVG 文档的末尾，以便它们[绘制在所有其他内容之上](http://www.w3.org/TR/SVG/render.html#PaintersModel)
4.  根据标题用适当的数据填充元素
5.  相应地定位元素
    *   您需要将光标点从屏幕空间转换为 SVG 空间，或计算源元素的边界框并将其从可能转换的对象空间转换为全局 SVG 空间。
6.  检测 mouseout 事件
7.  隐藏或销毁标题元素。

上面有没有你不能做的部分？

* * *

**编辑**：从以下评论中回答大量问题：

1.  您可以将脚本放置在 SVG 内部或嵌入 HTML 外部；如果它们独立于 SVG（就像你的那样），最好将它们放在这里，这样你就可以在外部嵌入你的 SVG 并让它仍然工作。

2.  查找任何内容的列表是最容易的，您可以`class="foo"`通过以下方式之一在它们上放置一个通用属性：

    ```
    var foos = document.querySelectorAll('.foo');
    var foos = document.getElementsByClassName('foo'); 
    ```

    或者可以根据结构查询；例如，如果每个国家/地区都`<path>`包含在 a 中，`<g id="countries">`那么您可以使用：

    ```
    var countries = document.querySelectorAll('#countries path'); 
    ```

    但是，如果您只有一个 ID 数组，那么您需要执行以下操作：

    ```
    var countryIDs = [ "usa", "brazil", … ];

    // Old school
    var countries = [];
    for (var i=countryIDs.length; i--; ){
      countries[i]=document.getElementById(countryIDs[i]);
    }

    // New school
    var countries = countryIDs.map(function(id){
      return document.getElementById(id);
    }); 
    ```

3.  要将事件处理程序附加到每个：

    ```
    function showTooltip(evt){
      var element = evt.target;
      // your code here
    }

    countries.forEach(function(el){
      el.addEventListener('mouseover',showTooltip,false);
    }); 
    ```

    或者，您可以将事件处理程序附加到一个共同的祖先一次，然后在那里处理它：

    ```
    svg.addEventListener('mouseover',function(evt){
      var element = evt.target;
      if (element.hasAttribute('title')){
        // your code here
      }
    } 
    ```

4.  最`<script>`简单的方法放在 . 之前`</svg>`，但如果需要，您可以将其放在顶部，并且它仅在文件加载完成时才起作用，例如：

    ```
    window.addEventListener('load',function(){
      // Put all your code here
    },false); 
    ```

5.  很容易找到嵌入 SVG 的信息，你是对的，有很多方法可以做到这一点。这是[一篇关于它的好文章](https://developer.mozilla.org/en/SVG_In_HTML_Introduction)。我个人提倡[XHTML 中的 SVG，](http://phrogz.net/svg/svg_in_xhtml5.xhtml)或者，如果必须的话，[HTML5 中的 SVG](http://www.tutorialspoint.com/html5/html5_svg.htm)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-08-21T09:55:45.347

```
You can use append svg title to view additional data.
// Here we add an SVG title element the contents of which is effectively rendered in a tooltip   
        .append("svg:title")
          .text(function(d) {return "Name:"+d.Name;}); 
We can use this tooltip along with all svg element. Here d is a json object form this we are parsing the data. 
```

[https://gist.github.com/ilyabo/1339996](https://gist.github.com/ilyabo/1339996)

# .net - 希伯来日历控件

> ID：10392239
> 
> 赞同：2
> 
> 时间：2012-05-01T00:40:42.917
> 
> 标签：.net, winforms, localization

在 asp.net 中有一个内置选项可以将日历控件更改为希伯来语，在 winForms 中也有一种简单的方法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-01T08:47:31.443

还没有找到简单的方法；需要使用（或创建）自定义控件。

尽管 System.Globalization.HebrewCalendar 很好地支持了希伯来日历。

# express - Haproxy 不匹配路径（使用 express.js 和 Socket.IO）

> ID：10392248
> 
> 赞同：0
> 
> 时间：2012-05-01T00:42:14.280
> 
> 标签：express, socket.io, haproxy

我的配置文件：

```
global
    maxconn     4096 # Total Max Connections. This is dependent on ulimit
    nbproc      2
    daemon
    log         127.0.0.1    local1 notice
defaults
    mode        http

frontend all 0.0.0.0:80
    timeout client 86400000
    default_backend www_backend
    acl is_websocket hdr(Upgrade) -i WebSocket
    acl is_websocket hdr_beg(Host) -i ws
    acl is_websocket path_beg /socket.io

    use_backend socket_backend if is_websocket

backend www_backend
    balance roundrobin
    option forwardfor # This sets X-Forwarded-For
    timeout server 30000
    timeout connect 4000
    server server1 localhost:9001 weight 1 maxconn 1024 check
    server server2 localhost:9002 weight 1 maxconn 1024 check

backend socket_backend
    balance roundrobin
    option forwardfor # This sets X-Forwarded-For
    stats enable
    timeout queue 5000
    timeout server 86400000
    timeout connect 86400000
    server server1 localhost:5000 weight 1 maxconn 1024 check 
```

据我所知， www_backend 匹配所有内容。当我的 Web 应用程序请求[http://myapp.com/socket.io/1/?t=1335831853491](http://myapp.com/socket.io/1/?t=1335831853491)时，它返回 404，并且标头显示响应来自 Express。奇怪的是当我做 curl -I [http://myapp.com/socket.io/1/?t=1335831853491](http://myapp.com/socket.io/1/?t=1335831853491)它返回：

```
HTTP/1.1 200 OK
Content-Type: text/plain
Connection: keep-alive 
```

当我运行 sudo netstat -lptu 时，我可以确认我的 socket.io 进程正在端口 5000 上运行。有什么想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-01T03:57:45.933

在这里找到答案：

[https://serverfault.com/questions/248897/haproxy-access-list-using-path-dir-having-issues-with-firefox](https://serverfault.com/questions/248897/haproxy-access-list-using-path-dir-having-issues-with-firefox)

“我们必须将“选项 http-server-close”添加到您的默认部分，它应该可以工作。”

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-06T09:33:37.980

同意楼上的回答。顺便说一句，您不应该使用 1 天的超时来建立 TCP 连接（超时连接），这根本没有意义，并且会在您的服务器出现故障时导致连接累积。应该立即建立连接（尤其是本地连接）。我倾向于为连接设置 5s 超时，即使在慢速网络上也足够了。

关于其他长时间超时，我计划实施“超时隧道”，以便用户不必为正常流量使用那么大的超时。

# vb.net - Visual Basic 特定特性

> ID：10392251
> 
> 赞同：-2
> 
> 时间：2012-05-01T00:42:54.420
> 
> 标签：vb.net

我正在寻找有关 Visual Basic 的深入信息。例如，作用域和绑定行为、子程序和包设施等。

是否有您知道的任何资源，最好是在线访问？

编辑：我正在寻找以下信息：VB 使用词法或动态范围；X 的绑定发生在编译时/加载时/运行时，并且是静态或动态的。基本上更深入地了解语言的特征。

我希望这会有所帮助。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-02T07:56:56.280

当您需要一种语言的完整描述时，请始终查阅制造商规范。[如果是 VB.NET，您可以在此处](http://www.microsoft.com/en-us/download/details.aspx?id=15751)获取语言规范(VB.NET 2003)

> Visual Basic .NET 语言规范提供了 Visual Basic .NET 语言的完整描述。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-01T00:45:26.863

它们与 C# 几乎相同。

[http://support.microsoft.com/kb/308470](http://support.microsoft.com/kb/308470)
[http://www.harding.edu/fmccown/vbnet_csharp_comparison.html](http://www.harding.edu/fmccown/vbnet_csharp_comparison.html)

如果这不是您要查找的内容，请添加有关您要查找的内容和原因的更多详细信息。

.NET 是词法范围，变量名只能在它定义的范围内访问。大多数项目在编译时绑定，除非它们是延迟加载（在需要时加载）或动态（在运行时编译）。

您可以查看[http://en.wikipedia.org/wiki/Visual_Basic](http://en.wikipedia.org/wiki/Visual_Basic)

听起来您将从介绍/教程中受益最多，然后作为介绍的情况说明书将解释每个概念。如果您已经了解一种编程语言，您可能还会寻找特定于该语言的 VB 介绍（例如[VB.Net for Java 程序员](http://www.vbdotnetheaven.com/UploadFile/ahmed.rajek/Arrays12112006232141PM/Arrays.aspx)）。另见[http://www.csharphelp.com/2005/11/net-framework-for-java-programmers/](http://www.csharphelp.com/2005/11/net-framework-for-java-programmers/)

# java - 如何清除tomcat中的PermGen空间错误

> ID：10392255
> 
> 赞同：54
> 
> 时间：2012-05-01T00:43:51.050
> 
> 标签：java, tomcat, permgen

我在 Windows 环境中工作，每次使用 tomcat 时都会收到此错误-

```
Apr 30, 2012 5:30:37 PM org.apache.catalina.core.StandardWrapperValve invoke
SEVERE: Servlet.service() for servlet default threw exception
java.lang.OutOfMemoryError: PermGen space
2012-04-30 17:30:37.719 INFO net.spy.memcached.MemcachedConnection:  Connection state changed for sun.nio.ch.SelectionKeyImpl@4ae53a99
2012-04-30 17:30:37.719 INFO net.spy.memcached.MemcachedConnection:  Reconnecting due to failure to connect to {QA sa=localhost/127.0.0.1:11211, #Rops=0, #Wops=0, #iq=0, topRop=null, topWop=null, toWrite=0, interested=0}
java.net.ConnectException: Connection refused: no further information
Apr 30, 2012 5:30:37 PM org.apache.catalina.core.StandardWrapperValve invoke
SEVERE: Servlet.service() for servlet default threw exception
java.lang.OutOfMemoryError: PermGen space
Exception in thread "Memcached IO over {MemcachedConnection to localhost/127.0.0.1:11211}" java.lang.OutOfMemoryError: PermGen space
Apr 30, 2012 5:30:38 PM org.apache.coyote.http11.Http11Processor process
SEVERE: Error processing request
java.lang.OutOfMemoryError: PermGen space
Apr 30, 2012 5:30:38 PM org.apache.coyote.http11.Http11Processor process
SEVERE: Error processing request
java.lang.OutOfMemoryError: PermGen space
Apr 30, 2012 5:30:38 PM org.apache.coyote.http11.Http11Processor process
SEVERE: Error processing request
java.lang.OutOfMemoryError: PermGen space
Apr 30, 2012 5:30:41 PM org.apache.catalina.connector.CoyoteAdapter service
SEVERE: An exception or error occurred in the container during the request processing
java.lang.OutOfMemoryError: PermGen space
Apr 30, 2012 5:30:43 PM org.apache.catalina.core.StandardHostValve custom
SEVERE: Exception Processing ErrorPage[exceptionType=java.lang.Throwable, location=/error.action]
java.lang.OutOfMemoryError: PermGen space
Apr 30, 2012 5:30:42 PM org.apache.catalina.core.StandardHostValve custom
SEVERE: Exception Processing ErrorPage[exceptionType=java.lang.Throwable, location=/error.action]
java.lang.OutOfMemoryError: PermGen space
Exception in thread "ContainerBackgroundProcessor[StandardEngine[Catalina]]" java.lang.OutOfMemoryError: PermGen space 
```

我尝试添加`JAVA_OPTS with the value as -Xms1024m -Xmx1024m`系统变量，但我仍然一次又一次地遇到相同的错误**（java.lang.OutOfMemoryError：PermGen 空间） 。**

任何帮助将不胜感激。我也阅读了 Stack Overflow 上的其他帖子，但没有成功。

* * *

## 回答 #1

> 赞同：107
> 
> 时间：2012-05-01T01:06:49.160

PermGen 空间是 Tomcat 用来存储类定义（只有定义，没有实例化）和已被实习的字符串池的地方。从经验来看，PermGen 空间问题往往在开发环境中经常发生，因为 Tomcat 必须在每次部署 WAR 或执行 jspc（编辑 jsp 文件时）时加载新类。就个人而言，我在进行开发测试时倾向于部署和重新部署战争，所以我知道我迟早会用完（主要是因为 Java 的 GC 周期仍然有点垃圾，所以如果你快速频繁地重新部署你的战争够了，空间填满的速度比他们能管理的要快）。

从理论上讲，这在生产环境中应该不是问题，因为您（希望）不要在 10 分钟的基础上更改代码库。如果它仍然发生，那只是意味着您的代码库（和相应的库依赖项）对于默认内存分配来说太大了，您只需要弄乱堆栈和堆分配。我认为标准是这样的：

```
-XX:MaxPermSize=SIZE 
```

然而，我发现最好的解决方法是让类被卸载，这样你的 PermGen 就永远不会用完：

```
-XX:+CMSClassUnloadingEnabled -XX:+CMSPermGenSweepingEnabled 
```

过去，类似的东西对我来说很神奇。有一件事，在使用这些时有一个显着的性能权衡，因为 permgen 扫描会为你提出的每个请求或类似的东西发出额外的 2 个请求。您需要在使用与权衡之间取得平衡。

* * *

## 回答 #2

> 赞同：17
> 
> 时间：2012-05-01T00:57:52.353

您必须为 tomcat JVM 的 PermGenSpace 分配更多空间。

这可以通过 JVM 参数来完成：**-XX:MaxPermSize=128m**

默认情况下，PermGen 空间是 64M（它包含所有编译的类，所以如果你的类路径中有很多 jar（类），你可能确实会填满这个空间）。

[附带说明一下，您可以使用JVisualVM](http://visualvm.java.net/)监控 PermGen 空间的大小，甚至可以使用[YourKit Java Profiler](http://www.yourkit.com/)检查其内容

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2013-10-29T10:10:38.843

为了补充迈克尔的答案，并根据[这个答案](https://stackoverflow.com/questions/3717937/cmspermgensweepingenabled-vs-cmsclassunloadingenabled/3720052#3720052)，处理该问题的一种安全方法是使用以下论点：

```
-XX:+CMSClassUnloadingEnabled -XX:+CMSPermGenSweepingEnabled -XX:+UseConcMarkSweepGC 
```

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2014-09-26T08:19:15.297

如果 tomcat 作为 Windows 服务运行，CATALINA_OPTS 和 JAVA_OPTS 似乎都没有任何效果。

您需要在 GUI 的 Java 选项中进行设置。

下面的链接很好地解释了它

[http://www.12robots.com/index.cfm/2010/10/8/Giving-more-memory-to-the-Tomcat-Service-in-Windows](http://www.12robots.com/index.cfm/2010/10/8/Giving-more-memory-to-the-Tomcat-Service-in-Windows)

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2015-12-18T07:44:15.673

在 Tomcat 7.0 Windows Service Installer Version.There 没有 catalina.bat 在 /bin 。所以你需要在 /bin 中打开 Tomcat7w.exe 并添加打击 JVM 参数

```
-XX:PermSize=256m -XX:MaxPermSize=512m 
```

在 Java 选项卡中的 Java 选项上，像这样。您还可以添加其他选项。

[![在此处输入图像描述](../Images/19438927fdeb50b8c3f4cc181e3243c1.png)](https://i.stack.imgur.com/lPmdh.png)

另一个，如果你使用 IntellijIDEA，你需要在服务器配置中添加 JVM 参数，像这样。

[![在此处输入图像描述](../Images/e8306a8fa2059f6ca753359578213aa2.png)](https://i.stack.imgur.com/WLgk9.png)

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2015-06-29T14:02:30.650

这对我有用，如果value`startup.bat`不存在，则需要在以下行中添加。完整的线路：`set JAVA_OPTS``-Xms128m -Xmx1024m -XX:PermSize=64m -XX:MaxPermSize=256`

```
set JAVA_OPTS=-Dfile.encoding=UTF-8 -Xms128m -Xmx1024m -XX:PermSize=64m -XX:MaxPermSize=256 
```

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2015-10-15T22:51:14.733

@AndreSmiley 的行代码对我有用。

唯一需要修改的是。

-XX:MaxPermSize=256**米**

“m”表示 MB。

实际上，我的应用程序有点庞大，因此建议我将其设置为 1024m 以提高性能。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2016-02-04T06:29:34.693

## 如果您将 eclipse 与 tomcat 一起使用，请按照以下步骤操作

1.  在服务器窗口上双击 tomcat，它会打开 tomcat 的概览窗口。

2.  在概述窗口中，您将在**常规信息**下找到**打开启动配置**，然后单击**打开启动配置**。

*****   在编辑配置窗口中查找**参数**并单击它。*   在 arguments 标记中查找**VM arguments**。*   只需将此 ***-Xms256m -Xmx512m -XX:PermSize=256m -XX:MaxPermSize=512m***粘贴到参数的末尾即可。****

 ****[![编辑启动配置属性](../Images/e4fea560de09fd6dfb84d1ce065a7065.png)](https://i.stack.imgur.com/lDB0V.png)

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2016-02-05T09:31:22.617

我在 CentOS 6.6 上运行 tomcat7。我尝试创建一个新的 /usr/share/tomcat/bin/setenv.sh 文件并同时设置`JAVA_OPTS`和`CATALINA_OPTS`. 但是tomcat不会在重新启动时获取值。当我将以下行放入 /etc/tomcat/tomcat.conf 时：

```
CATALINA_OPTS="-Xms128m -Xmx1024m -XX:MaxPermSize=1024m" 
```

tomcat 确实选择了新的环境变量。我通过运行验证了这一点

> ps辅助| grep tomcat

并在输出中看到新设置。这花了很长时间来诊断，我没有看到其他人提出这个建议，所以我想我会把它扔给互联网社区。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2018-03-08T19:52:07.753

我在 Intellij Ideav11 上尝试了同样的方法。

使用 grep 检查过程后，它没有选择设置。如果没有，请改为在 catalina.sh 中提供 JAVA_OPTS 的内存设置。

* * *

## 回答 #11

> 赞同：-5
> 
> 时间：2014-05-02T19:26:42.313

终止 tomcat 进程（对于 Linux，强制终止 -9）并再次启动它可以解决问题。我的猜测是，tomcat 实例没有被shutdown.bat 正确杀死。所以，我们需要强行终止进程并重新开始。****

# php - 如何从第二个表中获取会话值？

> ID：10392257
> 
> 赞同：0
> 
> 时间：2012-05-01T00:44:21.300
> 
> 标签：php

我有两个用户表；登录表和用户配置文件表。

我想将“userprofiletable”中的一个值与另一个名为帖子的表中的另一个值进行比较。如果值相等，则显示一个列表。

我有以下代码。问题是它没有将帖子表中的值与用户配置文件表中的会话值进行比较。

有人可以帮我吗？

```
<?php
$limit = '5';
$dbreq = 'SELECT * FROM `posts` ORDER BY `pos` DESC';
$dbdata = mysql_query($dbreq);
while($dbval = mysql_fetch_array($dbdata))
{
  if (($dbval['city'] == $_SESSION['student_city'])) { //checks for last 4 accomodation
    if ($limit >= '1') {
      echo '<tr><td><a href="acomod.php?view='.$dbval['id'].'">'.$dbval['title'].'</a></td></tr>';
      $limit = $limit -'1';
    }
  }
}
?> 
```

我还想获取 userprofiletable 的值并将其发布在 posts 表中。例如，当有人发布新帖子时。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-01T01:02:36.940

这个问题不清楚，但可能有两个答案：

要重现您的代码，您可以在一个 sql 查询中执行：

```
$dbreq = 'SELECT *
FROM `posts`
WHERE city="'.mysql_real_escape_string($_SESSION['student_city']).'"
ORDER BY `pos` DESC
LIMIT 4'; 
```

但是，如果有两个表，那么您需要“LEFT JOIN”将帖子表链接到 userprofile 表

```
$dbreq = 'SELECT p.*, u.*
FROM posts p
LEFT JOIN userprofiletable up ON p.UserID=up.UserID
WHERE up.city="'.mysql_real_escape_string($_SESSION['student_city']).'"
ORDER BY p.pos DESC
LIMIT 4'; 
```

（上表中的UserID是posts表和userprofiletable中连接两者的字段名。）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-01T00:56:03.253

你的帖子有点不清楚，但我认为这就是你想要的：

```
<?php
$userid = 11542;//Sample uid. You will have to figure this out and set it.
$limit = 5;
$dbreq = "SELECT * FROM `posts` WHERE `userid`=".$userid." ORDER BY `pos` DESC LIMIT=".$limit.";";
$dbdata = mysql_query($dbreq);
while($dbval = mysql_fetch_array($dbdata))
{
  if (($dbval['city'] == $_SESSION['student_city'])) { //checks for last 4 accomodation
    echo '<tr><td><a href="acomod.php?view='.$dbval['id'].'">'.$dbval['title'].'</a></td></tr>';
  }
}
?> 
```

# .htaccess - CakePHP 和 VirtualDocumentRoot 问题

> ID：10392258
> 
> 赞同：3
> 
> 时间：2012-05-01T00:44:23.250
> 
> 标签：.htaccess, cakephp, mod-rewrite, apache2

我在 Apache2 配置文件中配置了一个配置为`DocumentRoot /var/www`更改为的 LAMP 服务器`VirtualDocumentRoot /var/www/%-3/`- 这允许我自动映射`/var/www/<subdomain>`到`<subdomain>.example.com`.

我目前正在学习 CakePHP (2.x)，目录中有 Cake `/var/www/foo/`；我注意到 URL 没有正确重定向，并且正在尝试解决此问题；根据`http://bit.ly/KmEhHl`，我已将默认 .htaccess 文件修改为（除其他外）：

```
RewriteBase /cake
RewriteRule ^$ app/webroot/ [L]
RewriteRule (.*) app/webroot/$1 [L] 
```

但这会引发 500 Internal Server Error - 检查 Apache2`error.log`和`rewrite.log`，这是因为`.htaccess`导致无限重定向，并附`app/webroot`加到 URI。

据我了解，`L`此处的标志应指示“最后一条规则”-我假设此错误是由于我对 的理解不足`mod_rewrite`，但我不确定发生这种情况的确切位置。错误是否是由于此设置的其他一些潜在问题？我知道已经有几个问题，如果我能找到任何新信息，我会更新。任何帮助将不胜感激！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-09T19:09:04.467

找到答案了！

完整答案由用户 'kostasz' 在[http://bit.ly/NSDWE2](http://bit.ly/NSDWE2)的评论中提供。

提示确实是无限重定向 - 使用`RewriteBase /cake`的不是正确的基本 URL。

要解决此问题，请添加到、和`RewriteBase /`中的每个`.htaccess`文件。`/``/app/``/app/webroot/`

# eclipse - 组织 Eclipse 插件文件的导入

> ID：10392262
> 
> 赞同：0
> 
> 时间：2012-05-01T00:45:04.207
> 
> 标签：eclipse, eclipse-plugin

我一直在玩 Java 中的 Eclipse 插件开发，并注意到我的 plugin.xml 引用的类拒绝自动在我的源文件夹中包含类的导入。

plugin.xml 未引用的任何文件都可以很好地用于组织导入或快速修复。但是当plugin.xml引用文件时，我必须手动输入包导入。我猜这是一个帮助您管理依赖项的功能，但我不希望它那样工作。

是否有任何设置可以改变这种行为？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-02T14:02:55.087

一些引用的插件包将不会被导出。而不是手动导入包。

试试这个 ，

在`Runtime`引用插件 plugin.xml 的选项卡下导出包，以便在引用插件中可见。

希望这可以帮助 ！！！

# php - mySQL 需要多个文件上传文件脚本

> ID：10392267
> 
> 赞同：0
> 
> 时间：2012-05-01T00:46:18.553
> 
> 标签：php, jquery, mysql, upload, insert

任何人都可以向我推荐一个上传脚本（jquery、javascript 或 php）以将多张照片图像发布到现有记录吗？

记录将已创建。我需要客户端将多个文件上传到相应的记录。一条记录最多可包含 10 张照片。

我需要一个将发布到我在 mySQL 中的记录的脚本。

任何反馈和输入将不胜感激。

谢谢你。

埃里克

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-01T00:50:16.860

[swfupload.org](http://swfupload.org)非常酷，但根据评论，您需要做一些工作。

# c# - 序列化/反序列化为字符串 C#

> ID：10392268
> 
> 赞同：7
> 
> 时间：2012-05-01T00:46:23.123
> 
> 标签：c#, c#-4.0, serialization, deserialization

第一次在 C# 中使用序列化...任何帮助将不胜感激！以下是我的通用序列化器和反序列化器：

```
 public static string SerializeObject<T>(T objectToSerialize)
    {
        BinaryFormatter bf = new BinaryFormatter();
        MemoryStream memStr = new MemoryStream();

        try
        {
            bf.Serialize(memStr, objectToSerialize);
            memStr.Position = 0;

            return Convert.ToBase64String(memStr.ToArray());
        }
        finally
        {
            memStr.Close();
        }
    }

    public static T DeserializeObject<T>(string str)
    {
        BinaryFormatter bf = new BinaryFormatter();
        byte[] b = System.Text.Encoding.UTF8.GetBytes(str);
        MemoryStream ms = new MemoryStream(b);

        try
        {
            return (T)bf.Deserialize(ms);
        }
        finally
        {
            ms.Close();
        }
    } 
```

这是我要序列化的对象：

```
[Serializable()]
class MatrixSerializable : ISerializable
{
    private bool markerFound;
    private Matrix matrix;

    public MatrixSerializable( Matrix m, bool b)
    {
        matrix = m;
        markerFound = b;
    }

    public MatrixSerializable(SerializationInfo info, StreamingContext ctxt)
    {
        markerFound = (bool)info.GetValue("markerFound", typeof(bool));

        matrix = Matrix.Identity;

        if (markerFound)
        {

            //deserialization code
        }
    }

    public void GetObjectData(SerializationInfo info, StreamingContext ctxt)
    {
        // serialization code
    }

    public Matrix Matrix
    {
        get { return matrix; }
        set { matrix = value; }
    }

    public bool MarkerFound
    {
        get { return markerFound; }
        set { markerFound = value; }
    }
} 
```

以及如何运行它的示例：

```
 MatrixSerializable ms = new MatrixSerializable(Matrix.Identity * 5, true);

        string s = Serializer.SerializeObject<MatrixSerializable>(ms);

        Console.WriteLine("serialized: " + s);

        ms = Serializer.DeserializeObject<MatrixSerializable>(s);

        Console.WriteLine("deserialized: " + ms.Matrix + " " + ms.MarkerFound); 
```

当我尝试运行它时，我得到一个错误“SerializationException 未处理：输入流不是有效的二进制格式。起始内容（以字节为单位）是：41-41-45-41-41-41-44-2F- 2F-2F-2F-2F-41-51-41-41-41 ..."

任何关于我做错了什么或如何解决这个问题的建议将不胜感激！

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-05-01T00:59:44.500

您正在使用 Base64 将字节数组转换为字符串，并使用 GetUtf8 字节从字符串转换回字节数组。

替换`System.Text.Encoding.UTF8.GetBytes(str);`为`Convert.FromBase64String(str);`

# objective-c - 为什么叫回调函数？

> ID：10392269
> 
> 赞同：0
> 
> 时间：2012-05-01T00:46:27.330
> 
> 标签：objective-c, callback, terminology

“回调”这个名字的原因让我难以理解。这个词是什么意思？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-01T00:47:49.463

因为它为库提供了一种机制来回调您的代码。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-01T00:48:04.237

之所以调用回调，是因为当您给某个东西一个回调时，您可以让它在以后“回调”到您的代码中。

# php - 返回布尔值 PHP MongoDB

> ID：10392274
> 
> 赞同：0
> 
> 时间：2012-05-01T00:47:18.423
> 
> 标签：php, authentication, object, methods, boolean

我正在尝试对登录脚本实施防错。但是，我不能让它工作吗？我不知道发生了什么，也不知道为什么它不像我期望的那样工作。我什么都试过了，请指教。

这是我正在调用的方法：

```
public function i_exist($this_username)
{
    //$host_array = null;
    //$host_array = $this->collection->findOne(array("Username" => $this_username));
    //if ($host_array['Username'] = $this_username)
    //{
          return true;
    //}

    //return false;
} 
```

这就是我所说的：

```
if (!empty($_POST['Username']))
{           
    $host  = new Host();        
    $event = new Event();

    if ($host->i_exist($_POST['Username']))
    {
        header("Location: http://www.drink-social.com/error.php?login=duplicate");  
    } 
```

它应该检查数据库并查看该用户名是否已在使用中。但它从不指向错误页面？我什至尝试将所有内容都注释掉并返回 true，然后返回 1。什么都没有？有什么建议吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-01T09:17:57.690

当你调用 header(); 您还需要调用 exit(); 否则脚本继续运行。

# objective-c - 为什么我不能关闭我加载的视图控制器？

> ID：10392284
> 
> 赞同：2
> 
> 时间：2012-05-01T00:48:26.310
> 
> 标签：objective-c, ios

我使用单击按钮时触发的 IBAction 成功加载了一个新的视图控制器。

```
-(IBAction)changeToAnotherView:(id)sender 
{
    if (self.newController == nil)
    {
        newController = [[UIViewController alloc] initWithNibName:@"NewViewController" bundle:[NSBundle mainBundle]];
    }
    quizController.modalTransitionStyle = UIModalTransitionStyleFlipHorizontal;
    [self presentViewController:newController animated:YES completion:NULL];
} 
```

但是，我在 NewViewController.m 中返回旧视图的函数没有构建。为什么？

```
- (IBAction)goBackToOldView:(id)sender
{
    [self dismissWithClickedButtonIndex:0 animated:YES];
} 
```

我得到的构建错误是“没有可见的界面声明dismissWithClickedButtonIndex：animated：”。

* * *

更新：

lldb 现在输出

```
"2012-04-30 21:31:56.530 Project32[10105:fb03] -[UIViewController goBackToOldView:]: unrecognized selector sent to instance 0x6c57f20
2012-04-30 21:31:56.531 Project32[10105:fb03] *** Terminating app due to uncaught exception 'NSInvalidArgumentException', reason: '-[UIViewController goBackToOldView:]: unrecognized selector sent to instance 0x6c57f20'
*** First throw call stack:
(0x1649052 0x1bfdd0a 0x164aced 0x15aff00 0x15afce2 0x164aec9 0x2d05c2 0x50bd54 0x164aec9 0x2d05c2 0x2d055a 0x375b76 0x37603f 0x3752fe 0x2f5a30 0x2f5c56 0x2dc384 0x2cfaa9 0x2536fa9 0x161d1c5 0x1582022 0x158090a 0x157fdb4 0x157fccb 0x2535879 0x253593e 0x2cda9b 0x217d 0x20e5)
terminate called throwing an exception(lldb)" 
```

有趣的是，我`goBackToOldView`在 NewViewController 中实现了：

```
- (IBAction)goBackToOldView:(id)sender
{
    [self dismissModalViewControllerAnimated:YES];
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-01T00:58:15.480

因为那不是正确的功能，它应该是。

```
[self dismissViewControllerAnimated:YES completion:Nil]; 
```

（您可以在控制器被解除后替换完成时的 nil 块以执行某些操作。）

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-01T00:58:01.637

将您的代码更改为以下内容，它应该会正确关闭。

```
-(IBAction)changeToAnotherView:(id)sender 
{
    if (self.newController == nil)
    {
        newController = [[UIViewController alloc] initWithNibName:@"NewViewController" bundle:[NSBundle mainBundle]];
    }
    quizController.modalTransitionStyle = UIModalTransitionStyleFlipHorizontal;
    [self presentViewController:newController animated:YES];
}

- (IBAction)goBackToOldView:(id)sender
{
    [self dismissModalViewControllerAnimated:YES];
} 
```

希望这可以帮助！

# c# - 在 C# 中包含日期名称时，将 DateTime 字符串识别为有效

> ID：10392285
> 
> 赞同：3
> 
> 时间：2012-05-01T00:48:46.613
> 
> 标签：c#, datetime, dayofweek, tryparse

当日期字符串附加了星期几时，TryParse 失败：

```
DateTime d;
string dateString = "Tuesday May 1, 2012 9:00 AM";
return DateTime.TryParse(dateString, out d); // returns false 
```

处理此问题的最佳方法是什么，以便我可以安全地确定它是一个日期，并将其转换为日期？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-01T00:56:03.943

您需要告诉 TryParseExact 要查找的格式：

```
DateTime d;
string dateString = "Tuesday May 1, 2012 9:00 AM";
return DateTime.TryParseExact(
   dateString,
   "dddd MMMM d, yyyy h:mm tt",
   System.Globalization.CultureInfo.CurrentCulture,
   System.Globalization.DateTimeStyles.None,
   out d
); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-01T01:12:15.407

这应该可以解决问题:)

```
 // Parse date and time with custom specifier.
        string dateValue = "Tuesday May 1, 2012 9:00 AM";
        string pattern = "dddd MMMM d, yyyy h:mm tt";

        DateTime parsedDate;

        if (DateTime.TryParseExact(dateValue, pattern, null,
                               DateTimeStyles.None, out parsedDate))
            Console.WriteLine("Converted '{0}' to {1:d}.",
                              dateValue, parsedDate);
        else
            Console.WriteLine("Unable to convert '{0}' to a date and time.",
                              dateValue); 
```

参考 [http://msdn.microsoft.com/en-us/library/w2sa9yss.aspx](http://msdn.microsoft.com/en-us/library/w2sa9yss.aspx) http://msdn.microsoft.com/en-us/library/8kb3ddd4.aspx

# c# - c# 更改构建操作后未找到 XNA 内容文件

> ID：10392290
> 
> 赞同：-1
> 
> 时间：2012-05-01T00:50:18.263
> 
> 标签：c#, xna, xap

我正准备向市场提交我的第一款游戏，但我遇到了这个问题。

我今天意识到我的 XAP 文件看起来真的很小。（大约 350kb）我今天读到我的所有内容（纹理、声音、字体）都应该将它们的构建操作设置为“内容”，而不是之前设置的“编译”。我将它们全部设置为“内容”设置，现在我收到“加载“文件名”时出错。找不到文件。”

除了构建操作之外，我没有更改任何其他内容，并且我已确认未找到所有文件。更改构建操作后，我需要在加载语句中更改什么吗？目前我的加载语句看起来像这样。

`font = content.Load<SpriteFont>("menufont");`

或者

`ShipTexture = ScreenManager.Game.Content.Load<Texture2D>("Jet");`

仅供参考，我已经使用 GameStateManagement 示例从头开始构建我的游戏，以防万一。

请帮忙。谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-01T01:00:34.487

我不确定你在哪里读到的，但这不是真的。

`ContentManager`对象，如，`Game.Content`被编程为查找`xnb`文件。这些必须从源文件*编译*，如 .png、.wav 等。设置为`Content`将源文件直接复制到 XAP 中，因此您必须打开它`TitleContainer.OpenStream`才能使用它，而不是正常的`Content.Load`，因为它不会成为一个`xnb`文件。

如果您的 XAP 文件非常小，可能是因为 XAP 对整个包使用 ZIP 压缩。查看 bin\Debug 或 bin\Release 文件夹中的“Content”文件夹以查看未压缩的完整大小。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-01T00:58:39.013

您希望将其设置为`Compile`，而不是`Content`。`Build Action: Compile`意味着它将作为 XNA 内容处理到一个`.xnb`文件中，然后可以通过`ContentManager.Load<T>`调用访问该文件。`Build Action: Content`是其他不会导致您的内容被编译的东西。它要么直接复制，要么被忽略，但无论哪种方式，资产都无法从`ContentManager`.

# c# - 将 Xml Snippet 作为参数传递给 xslt

> ID：10392292
> 
> 赞同：1
> 
> 时间：2012-05-01T00:50:57.687
> 
> 标签：c#, xml, xslt

我正在尝试解决的当前问题是通过 xslt 生成两个具有差异和相似之处的 xml 文件的比较。

例如第一个 xml 文件看起来像

```
<?xml version="1.0" encoding="utf-8" ?>
<Stats Date="2011-01-01">
  <Player Rank="1">
    <GP>39</GP>
    <G>32</G>
    <A>33</A>
    <PlusMinus>20</PlusMinus>
    <PIM>29</PIM>
    <PP>10</PP>
    <SH>1</SH>
    <GW>3</GW>
    <Shots>0</Shots>
    <ShotPctg>154</ShotPctg>
    <TOIPerGame>20.8</TOIPerGame>
    <ShiftsPerGame>21:54</ShiftsPerGame>
    <FOWinPctg>22.6</FOWinPctg>
  </Player>
</Stats> 
```

第二个文件看起来像

```
<?xml version="1.0" encoding="utf-8" ?>
<Stats Date="2011-01-01">
  <Player Rank="2">
    <Name>John Smith</Name>
    <Team>NY</Team>
    <Pos>D</Pos>
    <GP>38</GP>
    <G>32</G>
    <A>33</A>
    <PlusMinus>15</PlusMinus>
    <PIM>29</PIM>
    <PP>10</PP>
    <SH>1</SH>
    <GW>4</GW>
    <Shots>0</Shots>
    <ShotPctg>158</ShotPctg>
    <TOIPerGame>20.8</TOIPerGame>
    <ShiftsPerGame>21:54</ShiftsPerGame>
    <FOWinPctg>22.6</FOWinPctg>
  </Player>
</Stats> 
```

当我将第二个文件嵌入到 xslt 文件中时，输出按预期工作：

```
<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
  <xsl:output omit-xml-declaration="yes" indent="yes"/>
  <xsl:strip-space elements="*"/>

  <xsl:param name="vrtfDoc2">
    <Stats Date="2011-01-01">
      <Player Rank="2">
        <Name>John Smith</Name>
        <Team>NY</Team>
        <Pos>D</Pos>
        <GP>38</GP>
        <G>32</G>
        <A>33</A>
        <PlusMinus>15</PlusMinus>
        <PIM>29</PIM>
        <PP>10</PP>
        <SH>1</SH>
        <GW>4</GW>
        <Shots>0</Shots>
        <ShotPctg>158</ShotPctg>
        <TOIPerGame>20.8</TOIPerGame>
        <ShiftsPerGame>21:54</ShiftsPerGame>
        <FOWinPctg>22.6</FOWinPctg>
      </Player>
    </Stats>
  </xsl:param>

  <xsl:variable name="vDoc2" select=
  "document('')/*/xsl:param[@name='vrtfDoc2']/*"/>

  <xsl:template match="node()|@*" name="identity">
    <xsl:param name="pDoc2"/>
    <xsl:copy>
      <xsl:apply-templates select="node()|@*">
        <xsl:with-param name="pDoc2" select="$pDoc2"/>
      </xsl:apply-templates>
    </xsl:copy>
  </xsl:template>

  <xsl:template match="/">
    <xsl:apply-templates select="*">
      <xsl:with-param name="pDoc2" select="$vDoc2"/>
    </xsl:apply-templates>

    -----------------------

    <xsl:apply-templates select="$vDoc2">
      <xsl:with-param name="pDoc2" select="/*"/>
    </xsl:apply-templates>
  </xsl:template>

  <xsl:template match="Player/*">
    <xsl:param name="pDoc2"/>
    <xsl:if test=
   "not(. = $pDoc2/*/*[name()=name(current())])">
      <xsl:call-template name="identity"/>
    </xsl:if>
  </xsl:template>

  <xsl:template match="Name|Team|Pos" priority="20"/>
</xsl:stylesheet> 
```

使用以下 c# 代码时：

```
private string Transform(string xml, string xml2, string xsl) {
            StringWriter writer = new StringWriter();
            XslCompiledTransform t = new XslCompiledTransform(true);
            XsltSettings settings = new XsltSettings(true, false);
            XmlTextReader xmlReader = new XmlTextReader(xml);

            XmlTextReader xslReader = new XmlTextReader(xsl);
            t.Load(xslReader, settings, null);

            t.Transform(xmlReader, null, writer);
            return writer.ToString();
        } 
```

当我从 xslt 中删除嵌入的 xml

```
<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
  <xsl:output omit-xml-declaration="yes" indent="yes"/>
  <xsl:strip-space elements="*"/>

  <xsl:param name="vrtfDoc2" />

  <xsl:variable name="vDoc2" select=
  "document('')/*/xsl:param[@name='vrtfDoc2']/*"/>

  <xsl:template match="node()|@*" name="identity">
    <xsl:param name="pDoc2"/>
    <xsl:copy>
      <xsl:apply-templates select="node()|@*">
        <xsl:with-param name="pDoc2" select="$pDoc2"/>
      </xsl:apply-templates>
    </xsl:copy>
  </xsl:template>

  <xsl:template match="/">
    <xsl:apply-templates select="*">
      <xsl:with-param name="pDoc2" select="$vDoc2"/>
    </xsl:apply-templates>

    -----------------------

    <xsl:apply-templates select="$vDoc2">
      <xsl:with-param name="pDoc2" select="/*"/>
    </xsl:apply-templates>
  </xsl:template>

  <xsl:template match="Player/*">
    <xsl:param name="pDoc2"/>
    <xsl:if test=
   "not(. = $pDoc2/*/*[name()=name(current())])">
      <xsl:call-template name="identity"/>
    </xsl:if>
  </xsl:template>

  <xsl:template match="Name|Team|Pos" priority="20"/>
</xsl:stylesheet> 
```

将 c# 方法更改为

```
private string Transform(string xml, string xml2, string xsl) {
            StringWriter writer = new StringWriter();
            XslCompiledTransform t = new XslCompiledTransform(true);
            XsltSettings settings = new XsltSettings(true, false);
            XmlTextReader xmlReader = new XmlTextReader(xml);

            XmlDocument doc1 = new XmlDocument();
            // populate as needed e.g.
            doc1.Load(xml2);

            XmlTextReader xslReader = new XmlTextReader(xsl);
            t.Load(xslReader, settings, null);

            //Pass parameter value to xslt from code
            XsltArgumentList argumentList = new XsltArgumentList();
            argumentList.AddParam("vrtfDoc2", "", doc1);
            t.Transform(xmlReader, argumentList, writer);
            return writer.ToString();
        } 
```

我从转换中得到一个空白输出，对于我的生活，我无法理解为什么。我已经使用调试器逐步完成了这两个版本，并且参数值在两种情况下看起来都相同，但是当参数传递的版本在 xslt 中遇到以下代码段时，不会发生转换：

```
<xsl:apply-templates select="$vDoc2">
      <xsl:with-param name="pDoc2" select="/*"/>
    </xsl:apply-templates>
  </xsl:template>

  <xsl:template match="Player/*">
    <xsl:param name="pDoc2"/>
    <xsl:if test=
   "not(. = $pDoc2/*/*[name()=name(current())])">
      <xsl:call-template name="identity"/>
    </xsl:if>
  </xsl:template> 
```

任何帮助或建议都会非常受欢迎。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-01T02:28:15.870

**问题出在这段代码中**：

```
 <xsl:param name="vrtfDoc2" />    

  <xsl:variable name="vDoc2" select=   
     "document('')/*/xsl:param[@name='vrtfDoc2']/*"/> 
```

这会解析包含 XSLT 样式表的文件，定位 globa；`xsl:param`具有`name`字符串值的属性`"vrtfDoc2"`并选择 this 的子元素`xsl:param`- 但是它没有子元素，因此 的值`$vDoc2`是空节点集。

**解决方案**：

**仅使用**：

```
<xsl:variable name="vDoc2" select="$vrtfDoc2/*"/> 
```

**命名注意事项**：

请重命名参数，因为它的当前名称令人困惑和误导：

1.  使用`p`以参数开头的名称和`v`以变量开头的名称。

2.  像`vrtfDoc2`通常这样的名称意味着：*此变量包含一个 RTF（并且通常需要对其应用 xxx:node-set() 函数以便从中生成常规树）*。但是，您的情况并非如此。

因此，像：这样的参数名称`pDoc2`更加精确和信息丰富。

# javascript - 字符串化（转换为 JSON）具有循环引用的 JavaScript 对象

> ID：10392293
> 
> 赞同：85
> 
> 时间：2012-05-01T00:51:01.973
> 
> 标签：javascript, jquery, json, serialization, stringify

我有一个包含循环引用的 JavaScript 对象定义：它有一个引用父对象的属性。

它还具有我不想传递给服务器的功能。我将如何序列化和反序列化这些对象？

我读过最好的方法是使用 Douglas Crockford 的 stringify。但是，我在 Chrome 中收到以下错误：

> TypeError：将循环结构转换为 JSON

编码：

```
function finger(xid, xparent){
    this.id = xid;
    this.xparent;
    //other attributes
}

function arm(xid, xparent){
    this.id = xid;
    this.parent = xparent;
    this.fingers = [];

    //other attributes

    this.moveArm = function() {
        //moveArm function details - not included in this testcase
        alert("moveArm Executed");
    }
}

 function person(xid, xparent, xname){
    this.id = xid;
    this.parent = xparent;
    this.name = xname
    this.arms = []

    this.createArms = function () {
        this.arms[this.arms.length] = new arm(this.id, this);
    }
}

function group(xid, xparent){
    this.id = xid;
    this.parent = xparent;
    this.people = [];
    that = this;

    this.createPerson = function () {
        this.people[this.people.length] = new person(this.people.length, this, "someName");
        //other commands
    }

    this.saveGroup = function () {
        alert(JSON.stringify(that.people));
    }
} 
```

这是我为这个问题创建的一个测试用例。这段代码中有错误，但本质上我在对象中有对象，并且传递给每个对象的引用以显示创建对象时父对象是什么。每个对象还包含我不希望字符串化的函数。我只想要诸如`Person.Name`.

假设将相同的 JSON 传回，我如何在发送到服务器之前进行序列化并对其进行反序列化？

* * *

## 回答 #1

> 赞同：132
> 
> 时间：2012-09-30T07:14:24.780

**当你有一个对象的属性是对象本身直接（`a -> a`）或间接（ ）时，会发生**循环结构**`a -> b -> a`错误。**

 **为避免出现错误消息，请告诉 JSON.stringify 在遇到循环引用时该怎么做。例如，如果您有一个人指向另一个人（“父母”），该人可能（或可能不）指向原始人，请执行以下操作：

```
JSON.stringify( that.person, function( key, value) {
  if( key == 'parent') { return value.id;}
  else {return value;}
}) 
```

to的第二个参数`stringify`是一个*过滤函数*。在这里，它只是将引用的对象转换为其 ID，但您可以自由地做任何您想做的事情来破坏循环引用。

您可以使用以下代码测试上述代码：

```
function Person( params) {
  this.id = params['id'];
  this.name = params['name']; 
  this.father = null;
  this.fingers = [];
  // etc.
}

var me = new Person({ id: 1, name: 'Luke'});
var him = new Person( { id:2, name: 'Darth Vader'});
me.father = him; 
JSON.stringify(me); // so far so good

him.father = me; // time travel assumed :-)
JSON.stringify(me); // "TypeError: Converting circular structure to JSON"
// But this should do the job:
JSON.stringify(me, function( key, value) {
  if(key == 'father') { 
    return value.id;
  } else {
    return value;
  };
}); 
```

顺便说一句，我会为“ `parent`”选择一个不同的属性名称，因为它是许多语言（和 DOM）中的保留字。这往往会导致混乱的道路......

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2012-05-01T03:07:03.357

看来[dojo](http://www.sitepen.com/blog/2008/06/17/json-referencing-in-dojo/)可以用以下形式表示 JSON 中的循环引用：`{"id":"1","me":{"$ref":"1"}}`

这是一个例子：

[http://jsfiddle.net/dumeG/](http://jsfiddle.net/dumeG/)

```
require(["dojox/json/ref"], function(){
    var me = {
        name:"Kris",
        father:{name:"Bill"},
        mother:{name:"Karen"}
    };
    me.father.wife = me.mother;
    var jsonMe = dojox.json.ref.toJson(me); // serialize me
    alert(jsonMe);
});​ 
```

产生：

```
{
   "name":"Kris",
   "father":{
     "name":"Bill",
     "wife":{
          "name":"Karen"
      }
   },
   "mother":{
     "$ref":"#father.wife"
   }
} 
```

*注意：您也可以使用该`dojox.json.ref.fromJson`方法反序列化这些循环引用的对象。*

其他资源：

[即使有循环引用，如何将 DOM 节点序列化为 JSON？](https://stackoverflow.com/questions/2303713/how-to-serialize-dom-node-to-json)

[JSON.stringify 不能表示循环引用](https://stackoverflow.com/a/4816258/402706)

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2020-05-12T10:48:53.553

# 无库

使用下面的[替换](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/JSON/stringify)器生成带有字符串引用的 json（类似于[json-path](https://jsonpath.com/)）以复制/循环引用的对象

```
let s = JSON.stringify(obj, refReplacer()); 
```

```
function refReplacer() {
  let m = new Map(), v= new Map(), init = null;

  return function(field, value) {
    let p= m.get(this) + (Array.isArray(this) ? `[${field}]` : '.' + field); 
    let isComplex= value===Object(value)

    if (isComplex) m.set(value, p);  

    let pp = v.get(value)||'';
    let path = p.replace(/undefined\.\.?/,'');
    let val = pp ? `#REF:${pp[0]=='[' ? '$':'$.'}${pp}` : value;

    !init ? (init=value) : (val===init ? val="#REF:$" : 0);
    if(!pp && isComplex) v.set(value, path);

    return val;
  }
}

// ---------------
// TEST
// ---------------

// gen obj with duplicate references
let a = { a1: 1, a2: 2 };
let b = { b1: 3, b2: "4" };
let obj = { o1: { o2:  a  }, b, a }; // duplicate reference
a.a3 = [1,2,b];                      // circular reference
b.b3 = a;                            // circular reference

let s = JSON.stringify(obj, refReplacer(), 4);

console.log(s);
```

并遵循解析器函数从这样的“ref-json”重新生成对象

```
function parseRefJSON(json) {
  let objToPath = new Map();
  let pathToObj = new Map();
  let o = JSON.parse(json);

  let traverse = (parent, field) => {
    let obj = parent;
    let path = '#REF:$';

    if (field !== undefined) {
      obj = parent[field];
      path = objToPath.get(parent) + (Array.isArray(parent) ? `[${field}]` : `${field?'.'+field:''}`);
    }

    objToPath.set(obj, path);
    pathToObj.set(path, obj);

    let ref = pathToObj.get(obj);
    if (ref) parent[field] = ref;

    for (let f in obj) if (obj === Object(obj)) traverse(obj, f);
  }

  traverse(o);
  return o;
}

// ------------
// TEST
// ------------

let s = `{
    "o1": {
        "o2": {
            "a1": 1,
            "a2": 2,
            "a3": [
                1,
                2,
                {
                    "b1": 3,
                    "b2": "4",
                    "b3": "#REF:$.o1.o2"
                }
            ]
        }
    },
    "b": "#REF:$.o1.o2.a3[2]",
    "a": "#REF:$.o1.o2"
}`;

console.log('Open Chrome console to see nested fields:');
let obj = parseRefJSON(s);

console.log(obj);
```

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2013-07-22T04:46:50.030

我找到了两个合适的模块来处理 JSON 中的循环引用。

1.  CircularJSON [https://github.com/WebReflection/circular-json](https://github.com/WebReflection/circular-json)其输出可用作 .parse() 的输入。它也适用于浏览器和 Node.js 另请参阅：[http ://webreflection.blogspot.com.au/2013/03/solving-cycles-recursions-and-circulars.html](http://webreflection.blogspot.com.au/2013/03/solving-cycles-recursions-and-circulars.html)
2.  Isaacs json-stringify-safe [https://github.com/isaacs/json-stringify-safe](https://github.com/isaacs/json-stringify-safe)可能更具可读性但不能用于 .parse 并且仅适用于 Node.js

这些中的任何一个都应该满足您的需求。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2017-03-30T20:20:53.277

发生在这个线程上是因为我需要将复杂的对象记录到页面上，因为在我的特定情况下无法进行远程调试。找到 Douglas Crockford（JSON 的 inceptor）自己的 cycle.js，它将循环引用注释为字符串，以便在解析后可以重新连接它们。去循环的深拷贝可以安全地通过 JSON.stringify。享受！

[https://github.com/douglascrockford/JSON-js](https://github.com/douglascrockford/JSON-js)

> cycle.js：这个文件包含两个函数，JSON.decycle 和 JSON.retrocycle，它们可以在 JSON 中编码循环结构和 dag，然后恢复它们。这是 ES5 不提供的功能。JSONPath 用于表示链接。

* * *

## 回答 #6

> 赞同：-13
> 
> 时间：2014-02-28T19:41:46.867

我使用以下内容来消除循环引用：

```
JS.dropClasses = function(o) {

    for (var p in o) {
        if (o[p] instanceof jQuery || o[p] instanceof HTMLElement) {
            o[p] = null;
        }    
        else if (typeof o[p] == 'object' )
            JS.dropClasses(o[p]);
    }
};

JSON.stringify(JS.dropClasses(e)); 
```**

# javascript - 如何在 javascript 或 jquery 中复制弹出框的内容

> ID：10392298
> 
> 赞同：1
> 
> 时间：2012-05-01T00:52:28.470
> 
> 标签：javascript, jquery, html, ajax

我想在弹出框中打开一个（另一个域的）URL，然后想将该网页内容的全部内容复制到剪贴板或变量中。这样我就可以在我的 Web 应用程序中使用它。

我的代码就像

```
function openWin()
{
    myWindow=window.open("http://www.abcxyz.com","","width=400,height=200");

    //some code for copy content
    myWindow.close();
} 
```

此功能显示我要访问的网页。我需要的是复制该内容。

笔记：

*   我无法使用 AJAX 复制 URL 的内容（由于相同的来源策略，它会产生错误）。
*   我不能使用跨域 AJAX：只有在身份验证和 cookie 存储在我的浏览器中后，web url 才会回复，因此请求必须由浏览器发起，而不是从任何服务器发起。

* * *

## 回答 #1

> 赞同：-2
> 
> 时间：2012-05-01T01:14:41.677

也许你可以试试这个：

```
function openWin(){
   m = window.open("some.url.here");
   m.addEventListener("load", function(){func(m);});
}

function func(v){
   var c = v.document.body.innerHTML;
   v.close();
} 
```

# scala - 在 Play 2 (scala) 中创建自定义字段构造函数

> ID：10392302
> 
> 赞同：21
> 
> 时间：2012-05-01T00:53:12.293
> 
> 标签：scala, playframework-2.0

我正在尝试了解[play 2 scala 教程](http://www.playframework.org/documentation/2.0/ScalaFormHelpers)中为表单模板助手提供的说明。我陷入了“编写自己的字段构造函数”部分。它提供了一个示例模板（没有说明文件的名称应该是什么）：

```
@(elements: helper.FieldElements)

<div class="@if(elements.hasErrors) {error}">
    <label for="@elements.id">@elements.label</label>
    <div class="input">
        @elements.input
        <span class="errors">@elements.errors.mkString(", ")</span>
        <span class="help">@elements.infos.mkString(", ")</span> 
    </div>
</div> 
```

然后它显示此代码：

```
object MyHelpers {
  implicit val myFields = FieldConstructor(myFieldConstructorTemplate.f)    
} 
```

我对这应该如何与模板相关感到困惑。（例如，模板文件应该被称为 myFieldConstructorTemplate.scala.html 吗？）我尝试了一些变体但没有运气。

我是 scala 和 Play 的新手，但我也知道 play 2 和它的文档是新的，所以我不确定我错过了什么非常明显的东西。

谢谢！

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2013-08-04T02:40:24.797

我刚刚遇到了同样的问题，我同意你的说法，文档根本不清楚......

**可能的错误 1**

```
not found: value FieldConstructor 
```

这意味着您尚未使用此指令导入帮助程序：

```
@import helper._ 
```

**可能的错误 2**

```
not found: value implicitConstructor 
```

这意味着您在模板中的错误位置声明了字段构造函数（即：在@helper.form 方法中）。为了解决这个问题，我在导入指令之后声明了我的字段构造函数：

```
@import form._
@import helper._

@implicitConstructor = @{ FieldConstructor(foundation_field.render) } 
```

（我的foundation_field.scala.html 文件在views.form 包中）。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2012-05-01T08:26:37.633

在本教程中，此代码与文本一起：

> 通常您需要编写自己的字段构造函数。首先编写一个模板，例如：

这意味着您必须创建自己的模板 ( `xxxx.scala.html`) 并在其中添加该代码。之后，您使用它们提供的代码将其导入模板中（请记住将其添加到使用您的自定义字段的每个 scala 模板中）：

```
@implicitField = @{ FieldConstructor(xxxx.f) } 
```

查看 Play 的示例，Forms 示例使用与 Twitter 引导程序类似的方法。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-07-31T18:41:50.937

为了遵循 Scala 隐式关键字的逻辑，文档也是隐式的；）

Scala 和 Play 现在还太不成熟，因此文档很差。

这个 SOF 答案非常好：[https ://stackoverflow.com/a/15268122/1163081](https://stackoverflow.com/a/15268122/1163081)

您还可以查看 Play 源以获取更多示例：[https ://github.com/playframework/playframework/blob/master/framework/src/play/src/main/scala/views/html/](https://github.com/playframework/playframework/blob/master/framework/src/play/src/main/scala/views/html/)

或者这些人似乎发现了解决方案：[https ://groups.google.com/forum/#!msg/play-framework/2e1EqZJ-Qks/gXD1oo0IjfcJ](https://groups.google.com/forum/#!msg/play-framework/2e1EqZJ-Qks/gXD1oo0IjfcJ)

# spring - Spring + Spring Data JPA 配置

> ID：10392307
> 
> 赞同：3
> 
> 时间：2012-05-01T00:54:33.907
> 
> 标签：spring, jakarta-ee, persistence, spring-data, spring-data-jpa

目前我正在玩 Spring 设置。我的目标是使用 JPA 访问使用其 JNDI 名称的 Websphere 数据源。我正在使用 Spring Data JPA 让我的生活更轻松，并通过一些教程来了解基本概念。

坏事：这些都不是在谈论我的 JPA 场景的 Spring 配置 + 我以前从未使用过 JPA / JDBC。所以我希望你能在这里帮助我。我有2个配置文件：

应用程序上下文.xml

```
<bean id="txManager"
    class="org.springframework.orm.jpa.JpaTransactionManager">
    <property name="sessionFactory" ref="sessionFactory" />
</bean>
<tx:annotation-driven transaction-manager="txManager" />

<bean id="eManager" class="org.springframework.orm.jpa.LocalEntityManagerFactoryBean"></bean> 
```

因为我在我的代码中使用@Transactual 注释，所以我正在为 txManager 使用注释驱动的标签。我只是不确定我应该为 txManager 配置什么以及 sessionFactory 标签在做什么。是否有所有支持的 XML 标签的文档？我是否错过了我的场景的重要标签？

eManager 也一样——不确定这是否正确。

持久性.xml

```
<persistence version="1.0"
    xmlns="http://java.sun.com/xml/ns/persistence" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xsi:schemaLocation="http://java.sun.com/xml/ns/persistence http://java.sun.com/xml/ns/persistence/persistence_1_0.xsd">
    <persistence-unit name="spring-jpa">
        <jta-data-source>jdbc/myJNDI</jta-data-source>
    </persistence-unit>
</persistence> 
```

同样的事情：真的不知道我在做什么。我知道我需要一个持久性单元/提供者。我知道很多人为此使用休眠，但如果可能的话，我想保持原生并使用纯 JavaEE / Spring。我只是不确定如何配置它。目前我的项目正在崩溃，告诉我：“JPA PersistenceProvider 返回 null”

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-01T17:16:28.520

最好的方法是`EntityManagerFactory`通过 Spring 的 JNDI 支持从 JNDI 获取：

```
<jee:jndi-lookup id="entityManagerFactory" jndi-name="persistence/myPersistenceUnit" />

<jpa:repositories base-package="com.acme.repositories" />

<tx:jta-transactionManager /> 
```

这也将导致应用服务器也使用事务管理器。您也可以尝试设置 a`JpaTransactionManager`并将`EntityManagerFactory`从 JNDI 获得的内容连接到其中。如果仅通过`<jee:jndi-lookup />`命名空间元素查找数据源并遵循 Spring Data JPA 参考文档中的进一步配置说明，则可以将更多配置拉入 Spring 配置文件。然而，如果您决定完全使用容器资源，通常最好使用您实际可以获得的容器资源。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-01T07:46:40.443

我刚开始使用 Spring、jpa mysql 等......我也许可以帮助你。我将向您展示我正确了解我的配置的方式。

顺便说一句，我正在使用休眠进行数据库连接，我从来没有这样做过，所以没有我的帮助:)

我的配置：

弹簧配置.xml：

```
<context:component-scan base-package="com.MYPACKAGE"/> 
<!-- To find all your controllers -->

<tx:annotation-driven/> 
<!-- This will pickup all your @Transactional annotations-->

<import resource="../database/DataSource.xml"/>
<import resource="../database/Hibernate.xml"/>
<!-- These are my database config files--> 
```

数据源.xml：

```
<bean id="dataSource" class="org.springframework.jdbc.datasource.DriverManagerDataSource">
    <property name="driverClassName" value="com.mysql.jdbc.Driver"/>
    <property name="url" value="jdbc:mysql://localhost:3306/DATABASENAME"/>
    <property name="username" value="USERNAME"/>
    <property name="password" value="PASSWORD"/>
</bean> 
```

休眠.xml：

```
<bean id="entityManagerFactory" class="org.springframework.orm.jpa.LocalContainerEntityManagerFactoryBean">
    <property name="dataSource" ref="dataSource"/>
    <property name="jpaVendorAdapter">
        <bean class="org.springframework.orm.jpa.vendor.HibernateJpaVendorAdapter">
            <property name="showSql" value="false"/>
            <property name="generateDdl" value="true"/>
            <property name="databasePlatform" value="org.hibernate.dialect.MySQL5Dialect"/>
        </bean>
    </property>
</bean> 
```

我遗漏了您需要在 .xml 文件顶部包含的标准 xml 文本，但我相信您自己会解决；）

这个设置对我有用，我希望它可以帮助你！如果您对这篇文章有任何疑问，请告诉我！

祝你好运！

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2014-09-26T01:37:39.940

对于使用 JBoss 的用户，可以在 persistence.xml 属性中设置 jndi 名称，如下所示：

```
 <persistence-unit name="punit" transaction-type="JTA">

      <provider>org.hibernate.ejb.HibernatePersistence</provider>
      <jta-data-source>java:/myDS/jta-data-source>

      <class>com.company.model.Document</class>
      <class>com.company.model.DocumentIndividual</class>

      <properties>
        <property name="hibernate.hbm2ddl.auto" value="create" />
        <!-- <property name="hibernate.dialect" value="org.hibernate.dialect.MySQL5Dialect"/> -->
        <property name="javax.persistence.logging.level" value="INFO" />
        <property name="hibernate.show_sql" value="true" />
        <property name="jboss.entity.manager.jndi.name" value="java:/my_em"/>
        <property name="jboss.entity.manager.factory.jndi.name" value="java:/my_emf"/>
    </properties>

</persistence-unit> 
```

如此[处](http://docs.jboss.org/ejb3/docs/reference/build/reference/en/html/entityconfig.html)第 4.4.2 节所述

# c# - 替换文本框的 InnerText

> ID：10392309
> 
> 赞同：2
> 
> 时间：2012-05-01T00:54:39.260
> 
> 标签：c#, .net, ms-office, openxml, openxml-sdk

使用 MS OpenXml Sdk，我能够将模板流复制到结果流并使用以下代码在正文末尾附加动态文本（wp>>wr>>wt）：

```
var templateStream = File.OpenRead(templatePath);
templateStream.CopyTo(resultStream);

using (var resultPackage = WordprocessingDocument.Open(resultStream, true))
{
     var document = resultPackage.MainDocumentPart.Document;

     var body = document.Body;

     // Add new text.
     var para = body.AppendChild(new Paragraph());
     var run = para.AppendChild(new Run());
     run.AppendChild(new Text(firstName));
     document.Save();
} 
```

我的下一个合乎逻辑的步骤是用 firstName 替换 resultStream 中文本框的内部文本，如下面的代码所示。

```
// replacing code in using statement from above
var document = resultPackage.MainDocumentPart.Document;
var textbox = document.Descendants<TextBox>().First();
const string firstNametag = "<<IH.FirstName>>";
if (textbox.InnerText.Contains(firstNametag))
{
   var textboxContent = textbox.Elements<TextBoxContent>().First();
   textboxContent.RemoveAllChildren();
   var paragraph = textboxContent.AppendChild(new Paragraph());
   var run = paragraph.AppendChild(new Run());
   run.AppendChild(new Text(firstName));
}
document.Save(); 
```

在第一个示例和一些附加代码中，结果流被适当地序列化为 docx，并且在 Word 中查看时，firstName 被附加到正文的末尾。在第二个示例中，尽管在调试器中进一步检查显示 textboxContent 的子项反映了上面所做的更改，但文本框及其内容保持不变。

我是 OpenXML 开发的新手，所以如果有什么明显的地方请指出。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-03T03:53:00.633

哦，哇，我什至不想认为我了解整个情况，但这里有一个快速的尝试。有更多openXml经验的人请加入...

当您在 docx 上的 word 中创建文本框时，document.xml 文件会得到以下标记：

```
<w.r>
    <mc.AlertnateContent>
        <mc.Choice Requires="wps">
            <wps:txbx>
                <w:txbxContent>
                    <w:r>
                        <w.t>
                            Text Goes Here
                        </w.t>
                    </w.r>
                </w:txbxContent>
            </wps:txbx>
        </mc.Choice>
        <mc.Fallback>
            <v.textbox>
                <w:txbxContent>
                    <w:r>
                        <w.t>
                            Text Goes Here
                        </w.t>
                    </w.r>
                </w:txbxContent>
            </v.textbox>
        </mc.Fallback>
    </mc.AlertnateContent>
</w.r> 
```

请注意 mc.AlternateContent、mc.Choice 和 mc.Fallback 标记。这些是什么鬼？？？有人在我遇到的一篇博客文章中这样说 -

“据我了解——但不要把我的话当成福音——AlternateContent 可以出现在任何地方，并提供一种机制，如果消费应用程序可以处理它，则包含增强功能，如果不能处理，则提供回退。” -Tony Jollans - [http://social.msdn.microsoft.com/Forums/en-US/worddev/thread/f8a5c277-7049-48c2-a295-199d2914f4ba/](http://social.msdn.microsoft.com/Forums/en-US/worddev/thread/f8a5c277-7049-48c2-a295-199d2914f4ba/)

在我的情况下，我只修改了后备文本框（v.txbx 不是 wps.txbx），因为我假设 Resharper 正确地要求我导入 DocumentFormat.OpenXml.Vml 命名空间以依赖于 TextBox 对象。不知道为什么在我已经包含的命名空间 DocumentFormat.OpenXml.Packaging 或 DocumentFormat.OpenXml.Wordprocessing 之一中没有文本框定义，但这超出了这个问题的范围。不用说，在意识到这一点并更新我的代码以寻找两者的共同 w.txbxContent 后，我​​实现了我想做的事情。

这是经过一些重构的更新代码，在原始问题的 using 语句中调用 ReplaceTag 方法并提供模型对象而不是字符串。此外，为方便起见，请使用 tagToValueSelector 字典。

```
private void ReplaceTags(Document document, SomeModel model)
{
    var textBoxContents = document.Descendants<TextBoxContent>().ToList();
    foreach (var textBoxContent in textBoxContents)
    {
        ReplaceTag(textBoxContent, model);
    }
}

private void ReplaceTag(TextBoxContent textBoxContent, SomeModel model)
{
    var tag = textBoxContent.InnerText.Trim();
    if (!tagsTomValues.ContainsKey(tag)) return;
    var valueSelector = tagsTomValues[tag];
    textBoxContent.RemoveAllChildren();
    var paragraph = textBoxContent.AppendChild(new Paragraph());
    var run = paragraph.AppendChild(new Run());
    run.AppendChild(new Text(valueSelector(model)));
}

// called in the ctor
private static void IntializeTags(IDictionary<string, Func<SomeModel, string>> dictionary)
{
    dictionary.Add("<<IH.Name>>", m => string.Format("{0} {1}", m.FirstName, m.LastName));
} 
```

快乐的 openXmling :)

# css - 在@font-face CSS 规则中，我们可以为'local' 定义单独的'src' 声明吗？

> ID：10392310
> 
> 赞同：2
> 
> 时间：2012-05-01T00:54:40.463
> 
> 标签：css, font-face, src

这是一个示例 @font-face CSS 规则：

```
@font-face {
  font-family: 'DroidSerifBoldItalic';
  font-weight: normal;
  font-style: normal;
  src: url('DroidSerif-BoldItalic-webfont.eot');
  src: url('DroidSerif-BoldItalic-webfont.eot?#iefix') format('embedded-opentype'),
       local('Droid Serif Bold Italic'), local('DroidSerif-BoldItalic'),
       url('DroidSerif-BoldItalic-webfont.woff') format('woff'),
       url('DroidSerif-BoldItalic-webfont.ttf') format('truetype');
} 
```

你不觉得，下面的@font-face CSS 规则更好吗？（如您所见，浏览器，在这种情况下甚至是 IE，可以在下载之前先检查用户计算机上的字体是否可用。）

```
@font-face {
  font-family: 'DroidSerifBoldItalic';
  font-weight: normal;
  font-style: normal;
  src: local('Droid Serif Bold Italic'), local('DroidSerif-BoldItalic');
  src: url('DroidSerif-BoldItalic-webfont.eot');
  src: url('DroidSerif-BoldItalic-webfont.eot?#iefix') format('embedded-opentype'),
       url('DroidSerif-BoldItalic-webfont.woff') format('woff'),
       url('DroidSerif-BoldItalic-webfont.ttf') format('truetype');
} 
```

这里有什么陷阱吗？如果不是，为什么不是每个人都使用后者？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-01T02:07:56.393

根据我对@font-face 的了解，使用本地的主要担心是字体在某人的桌面上不会被命名为相同的名称。你在那里放弃控制权，如果你错了，它就会失败。不过，您确实提出了一个有趣的问题，我并不是说您错了。您可以[在此处](http://typophile.com/node/63992)和[此处](http://paulirish.com/2009/bulletproof-font-face-implementation-syntax/#smiley)阅读更多相关信息。

* * *

**附录**

> 通常，它用作[掩码以防止](http://paulirish.com/2009/bulletproof-font-face-implementation-syntax/)IE 中不需要的 http 请求。

顺序很重要，因为 IE（至少在 IE8 之前）不支持`local`描述符，并且将`local`描述符放在 EOT 字体格式之后会阻止旧版本的 Internet Explorer 下载其他字体格式（在`src`声明中），因为它们不是t 支持，无论如何都不会使用。

* * *

@BoltClock 评论的是真的。这就是我们使用两个`local`定义的原因—— `local('Droid Serif Bold Italic'), local('DroidSerif-BoldItalic'),`. 第一个是字体的正常名称（除 Safari 之外的所有浏览器都可以识别），后者是 Safari 所需的字体的 PostScript 名称（至少在 Mac / OS X 系统上）。

为了避免两种不同字体（主要在两个不同的操作系统上）具有相同名称的问题，有些人只需使用`local('☺')`.

# visual-studio-2010 - MSBuild 多目标的工作原理

> ID：10392312
> 
> 赞同：1
> 
> 时间：2012-05-01T00:55:04.657
> 
> 标签：visual-studio-2010, msbuild, continuous-integration, msbuild-4.0, multitargeting

我会尽量解释清楚

我想完全了解 MSBuild 多目标是如何工作的。

我已经阅读了微软的几篇文章，我想我了解基本知识，但我想确保我没有遗漏任何东西。

据微软称：

> 通过使用 Visual Studio，您可以编译应用程序以在 .NET Framework 的多个版本中的任何一个上运行。例如，您可以编译一个应用程序以在 .NET Framework 2.0 版上运行，并编译同一个应用程序以在 .NET Framework 4 版上运行。编译到多个框架的能力称为多目标。
> 
> Visual Studio 在开发计算机上安装的最新版本的 .NET Framework 下运行。

[http://msdn.microsoft.com/en-us/library/ee395432.aspx](http://msdn.microsoft.com/en-us/library/ee395432.aspx)

那么这是否意味着 Visual Studio 总是从安装的最新框架调用 MSBuild？假设已安装 Visual Studio 2010，它将始终调用：`%WINDIR%\Microsoft.NET\Framework\v4.0.30319\MsBuild.exe`在构建**任何以任何 .Net Framework 版本为目标的项目**时，对吗？？？

如果是，那么针对旧 .Net Framewrok 版本的能力是基于`ToolsVersion`and/or`TargetFrameworkVersion`属性，对吗？？？

**如果再次是**，则意味着仅在我的持续集成框中安装最新的框架（以及较旧的框架，但不安装 Visual Studio），**我可以指出始终构建任何解决方案：`%WINDIR%\Microsoft.NET\Framework\v4.0.30319\MsBuild.exe`并且只需指定`ToolsVersion`参数**（如果需要，因为每个项目都可以有自己的目标版本`TargetFrameworkVersion`，这将导致针对较旧的 .Net Framework 版本）。

**在此之后，我认为我的 CI 框会像 Visual Studio 一样构建。我对吗？我错过了什么？有没有办法完全确定？**

我做了一个快速测试，*我认为它有效：p*项目是根据指定的 .Net 框架构建的，但就像我说的那样，我想确保我没有遗漏任何东西。

有什么想法吗？

顺便提一句：

想要这样做的简单原因是因为我有几个可跨项目重用的自定义 MSBuild 脚本，但这些脚本中的一些功能需要 MSBuild 4.0，而且我有几个构建在框架 4.0 之上的 MSBuild 任务，所以如果我例如，有一个针对 Framework 2.0 的解决方案，我尝试使用以下方法构建它：`%WINDIR%\Microsoft.NET\Framework\v2.0.50727\MsBuild.exe`我在尝试加载我的自定义目标时遇到 MSBuild 错误

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-26T02:48:21.700

是的，你基本上是正确的。从 4.0 目录调用 MSBuild 将对以前的版本执行正确的操作。我唯一想补充的是，必须在包装盒上安装 3.5 才能实际构建针对 2.0、3.0 和 3.5 的项目。

这个页面在这里：http: [//msdn.microsoft.com/en-us/library/bb822049.aspx](http://msdn.microsoft.com/en-us/library/bb822049.aspx)列出了 Windows 预装了哪些版本的框架。

# javascript - 执行 pushState 时是否应该更新所有 href 和 src？

> ID：10392317
> 
> 赞同：3
> 
> 时间：2012-05-01T00:55:50.227
> 
> 标签：javascript, jquery, html, pushstate

如果我要调用 a`pushState`但我想保留所有相关链接、图像、样式表等，到目前为止我会这样做：

```
$('[href]').each(function() { 
    if (!/^#/.test(this.href)) this.href = this.href;
});
$('[src]').each(function() { this.src = this.src }); 
```

我的问题是：这可以跨浏览器工作吗？我需要做`$(this).attr('href') = this.href`吗？

这是必要的吗？还有另一种方法可以做到这一点吗？这是最好的方法吗？它总是会起作用吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-03T13:41:35.230

`pushState`改变当前文档的相对路径。

您可以根据您执行相对路径的方式来破坏或避免破坏相对源。

该`./*`模式执行当前路径的相对路径，但旧计划`/*`将始终从路径根开始，并且不受`pushState`更改的影响。

```
./this/would/break.jpg

/this/wont.jpg 
```

# java - 正则表达式计算字符串中的对数

> ID：10392321
> 
> 赞同：-5
> 
> 时间：2012-05-01T00:56:08.450
> 
> 标签：java, regex

假设我有字符串

```
1122345 
```

此字符串中有两对。计算这个字符串中的对的正则表达式是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-01T01:16:10.873

试试这个：

> ^(\d)\1*$ 或试试这个 ^([0-9])\1*$

请根据您的问题修改上述正则表达式。如果用户输入相同的数字，则模式匹配。\1 匹配第一个捕获组，因此该模式匹配数字是否在字符串中重复。

# python - 从日期时间返回不同的时间范围

> ID：10392324
> 
> 赞同：0
> 
> 时间：2012-05-01T00:56:31.790
> 
> 标签：python, datetime

我正在以这种方式解析文件：

```
for d in csvReader:
    print datetime.datetime.strptime(d["Date"]+"-"+d["Time"], "%d-%b-%Y-%H:%M:%S.%f").date() 
```

date() 返回：2000-01-08，这是正确的

time() 返回：06:20:00，这也是正确的

我将如何返回诸如**“日期+时间”**或**“日期+小时+分钟”之类的信息**

**编辑**

对不起，我应该更精确，这是我想要实现的目标：

```
lmb = lambda d: datetime.datetime.strptime(d["Date"]+"-"+d["Time"], "%d-%b-%Y-%H:%M:%S.%f").date()

daily_quotes = {}
for k, g in itertools.groupby(csvReader, key = lmb):
    lowBids = []
    highBids = []
    openBids = []
    closeBids = []
    for i in g:

        lowBids.append(float(i["Low Bid"]))
        highBids.append(float(i["High Bid"]))
        openBids.append(float(i["Open Bid"]))
        closeBids.append(float(i["Close Bid"]))

    dayMin = min(lowBids)
    dayMax = max(highBids)
    open = openBids[0]
    close = closeBids[-1]

    daily_quotes[k.strftime("%Y-%m-%d")] = [dayMin,dayMax,open,close] 
```

如您所见，现在我按天对值进行分组，我想按小时（我需要 date + hour ）或分钟（ date + hour + minute ）对它们进行分组

提前致谢 ！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-01T01:18:00.380

不要使用您从中获取`date`的对象的方法。取而代之的是，直接应用到从 的返回，这使您可以访问所有成员字段，包括年、月、日、小时、分钟、秒等......`datetime``strptime``strftime``strptime`

```
d = {"Date": "01-Jan-2000", "Time": "01:02:03.456"}
dt = datetime.datetime.strptime(d["Date"]+"-"+d["Time"], "%d-%b-%Y-%H:%M:%S.%f")
print dt.strftime("%Y-%m-%d-%H-%M-%S") 
```

# android - Android - 自定义 AutoCompleteTextView CursorAdaptor - 建议行为

> ID：10392325
> 
> 赞同：5
> 
> 时间：2012-05-01T00:56:37.387
> 
> 标签：android, autocompletetextview, android-cursoradapter

我正在尝试实现自定义 AutoCompleteTextView，以便从显示联系人姓名、电话号码类型和电话号码的建议列表中选择联系人的电话号码。我创建了一个自定义 CursorAdapter，它为每个建议定义和设置我的布局和 TextView，并根据用户通过 runQueryOnBackgroundThread 输入的文本查询联系人。我遇到了一个问题，其中输入的前两个值的建议似乎正确（例如“ab”建议“abcd”和“abyz”），但除此之外的任何内容（例如“abc”建议“abyz”）。For the latter, when the "abyz" suggestion is selected, the values for "abcd" are returned.

主要活动的代码：

```
final ContactInfo cont = new ContactInfo(ctx);
    Cursor contacts = cont.getContacts2(null);
    startManagingCursor(contacts);

    ContactsAutoCompleteCursorAdapter adapter = new ContactsAutoCompleteCursorAdapter(this, contacts);
    mPersonText.setAdapter(adapter);
    mPersonText.setOnItemClickListener(new AdapterView.OnItemClickListener() {

        public void onItemClick(AdapterView<?> arg0, View arg1, int arg2,
            long arg3) {
            Cursor cursor = (Cursor) arg0.getItemAtPosition(arg2);
            String number = cursor.getString(cursor.getColumnIndexOrThrow(ContactsContract.CommonDataKinds.Phone.NUMBER));
            mPersonNum.setText(number);
        }
    }); 
```

我的联系人类的代码返回所有联系人的光标：

```
public Cursor getContacts2(String where)
{
    Uri uri = ContactsContract.CommonDataKinds.Phone.CONTENT_URI;
    String[] projection = new String[] {
            ContactsContract.CommonDataKinds.Phone._ID,
            ContactsContract.CommonDataKinds.Phone.DISPLAY_NAME,
            ContactsContract.CommonDataKinds.Phone.TYPE,
            ContactsContract.CommonDataKinds.Phone.NUMBER};

    Cursor people = ctx.getContentResolver().query(uri, projection, null, null, ContactsContract.CommonDataKinds.Phone.DISPLAY_NAME + " COLLATE LOCALIZED ASC");

    return people;
} 
```

我的 CursorAdapter 的代码：

```
public class ContactsAutoCompleteCursorAdapter extends CursorAdapter implements Filterable {

private TextView mName, mType, mNumber;
private ContentResolver mContent;

public ContactsAutoCompleteCursorAdapter(Context context, Cursor c) {
    super(context, c);
    mContent = context.getContentResolver();
}

@Override
public View newView(Context context, Cursor cursor, ViewGroup parent) {

    final LayoutInflater mInflater = LayoutInflater.from(context);
    final View ret = mInflater.inflate(R.layout.contacts_auto_list, null);

    mName = (TextView) ret.findViewById(R.id.name);
    mType = (TextView) ret.findViewById(R.id.phonetype);
    mNumber = (TextView) ret.findViewById(R.id.phonenum);

    return ret;
}

@Override
public void bindView(View view, Context context, Cursor cursor) {

    int nameIdx = cursor.getColumnIndexOrThrow(ContactsContract.CommonDataKinds.Phone.DISPLAY_NAME);
    int typeIdx = cursor.getColumnIndex(ContactsContract.CommonDataKinds.Phone.TYPE);
    int numberIdx = cursor.getColumnIndex(ContactsContract.CommonDataKinds.Phone.NUMBER);

    String name = cursor.getString(nameIdx);
    int type = cursor.getInt(typeIdx);
    String number = cursor.getString(numberIdx);

    mName.setText(name);
    if (type == 1) {mType.setText("Home");}
    else if (type == 2) {mType.setText("Mobile");}
    else if (type == 3) {mType.setText("Work");}
    else {mType.setText("Other");}
    mNumber.setText(number);

}

@Override
public String convertToString(Cursor cursor) {
    int nameCol = cursor.getColumnIndexOrThrow(ContactsContract.CommonDataKinds.Phone.DISPLAY_NAME);
    String name = cursor.getString(nameCol);
    return name;
}

@Override
public Cursor runQueryOnBackgroundThread(CharSequence constraint) {
    // this is how you query for suggestions
    // notice it is just a StringBuilder building the WHERE clause of a cursor which is the used to query for results
    if (getFilterQueryProvider() != null) { return getFilterQueryProvider().runQuery(constraint); }

    String[] projection = new String[] {
            ContactsContract.CommonDataKinds.Phone._ID,
            ContactsContract.CommonDataKinds.Phone.DISPLAY_NAME,
            ContactsContract.CommonDataKinds.Phone.TYPE,
            ContactsContract.CommonDataKinds.Phone.NUMBER};

    return mContent.query(ContactsContract.CommonDataKinds.Phone.CONTENT_URI, projection, 
            "UPPER(" + ContactsContract.CommonDataKinds.Phone.DISPLAY_NAME + ") LIKE '" + constraint.toString().toUpperCase() + "%'", null, 
            ContactsContract.Contacts.DISPLAY_NAME + " COLLATE LOCALIZED ASC");
} 
```

}

正如我上面所说，当用户在 AutoCompleteTextView 中输入“ab”时，建议是“abcd”和“abyz”，但是当用户输入“abc”时，建议只是“abyz”。在这种情况下，当用户选择“abyz”时，将返回“abcd”的值。这是两个屏幕截图，显示了我要描述的内容：

![在此处输入图像描述](../Images/e7e8650650fac0b0bd7924b05e4b85c5.png)![在此处输入图像描述](../Images/bcbf3e66036b47a5d5e8ca11e64b8343.png)

我已经阅读了在这里和其他地方可以找到的所有问题，但似乎无法弄清楚这一点。我对Android开发相当陌生，所以如果我的错误很简单，我提前道歉。提前致谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-03T03:34:25.733

I seem to have answered my own question after more research. Moving the setting of the views for my textViews from the newView function to the bindView function seems to have done the trick, which I think makes sense...

```
@Override
public View newView(Context context, Cursor cursor, ViewGroup parent) {

    final LayoutInflater mInflater = LayoutInflater.from(context);
    final View ret = mInflater.inflate(R.layout.contacts_auto_list, null);

    return ret;
}

@Override
public void bindView(View view, Context context, Cursor cursor) {

    int nameIdx = cursor.getColumnIndexOrThrow(ContactsContract.CommonDataKinds.Phone.DISPLAY_NAME);
    int typeIdx = cursor.getColumnIndex(ContactsContract.CommonDataKinds.Phone.TYPE);
    int numberIdx = cursor.getColumnIndex(ContactsContract.CommonDataKinds.Phone.NUMBER);

    String name = cursor.getString(nameIdx);
    int type = cursor.getInt(typeIdx);
    String number = cursor.getString(numberIdx);

    mName = (TextView) view.findViewById(R.id.name);
    mType = (TextView) view.findViewById(R.id.phonetype);
    mNumber = (TextView) view.findViewById(R.id.phonenum);

    mName.setText(name);
    if (type == 1) {mType.setText("Home");}
    else if (type == 2) {mType.setText("Mobile");}
    else if (type == 3) {mType.setText("Work");}
    else {mType.setText("Other");}
    mNumber.setText(number);
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-11-30T16:26:08.233

您的适配器中已经有**公共 Cursor runQueryOnBackgroundThread**函数，因此您不需要在活动中调用第二次光标

您不需要使用**getContacts2**功能

**活动**

```
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.sms_send);

    Cursor contacts = null;

    mAdapter= new ContactsAutoCompleteCursorAdapter(this, contacts);
    mTxtPhoneNo = (AutoCompleteTextView) findViewById(R.id.mmWhoNo);
    mTxtPhoneNo.setAdapter(mAdapter);

    mTxtPhoneNo.setOnItemClickListener(new OnItemClickListener() {

        @Override
        public void onItemClick(AdapterView<?> arg0, View arg1, int arg2,
                long arg3) {
            // TODO Auto-generated method stub
            Cursor cursor = (Cursor) arg0.getItemAtPosition(arg2);
            String number = cursor.getString(cursor.getColumnIndexOrThrow(ContactsContract.CommonDataKinds.Phone.NUMBER));
            mTxtPhoneNo.setText(number);

        }
    });

} 
```

适配器

```
public class ContactsAutoCompleteCursorAdapter extends CursorAdapter implements Filterable {

private TextView mName, mType, mNumber;
private ContentResolver mContent;

public ContactsAutoCompleteCursorAdapter(Context context, Cursor c) {
    super(context, c);
    mContent = context.getContentResolver();
}

@Override
public View newView(Context context, Cursor cursor, ViewGroup parent) {

    final LayoutInflater mInflater = LayoutInflater.from(context);
    final View ret = mInflater.inflate(R.layout.custcontview, null);

    return ret;
}

@Override
public void bindView(View view, Context context, Cursor cursor) {

    int nameIdx = cursor.getColumnIndexOrThrow(ContactsContract.CommonDataKinds.Phone.DISPLAY_NAME);
    int typeIdx = cursor.getColumnIndex(ContactsContract.CommonDataKinds.Phone.TYPE);
    int numberIdx = cursor.getColumnIndex(ContactsContract.CommonDataKinds.Phone.NUMBER);

    String name = cursor.getString(nameIdx);
    int type = cursor.getInt(typeIdx);
    String number = cursor.getString(numberIdx);

    mName = (TextView) view.findViewById(R.id.ccontName);
    mType = (TextView) view.findViewById(R.id.ccontType);
    mNumber = (TextView) view.findViewById(R.id.ccontNo);

    mName.setText(name);
    if (type == 1) {mType.setText("Home");}
    else if (type == 2) {mType.setText("Mobile");}
    else if (type == 3) {mType.setText("Work");}
    else {mType.setText("Other");}
    mNumber.setText(number);
}

@Override
public String convertToString(Cursor cursor) {
    int nameCol = cursor.getColumnIndexOrThrow(ContactsContract.CommonDataKinds.Phone.DISPLAY_NAME);
    String name = cursor.getString(nameCol);
    return name;
}

@Override
public Cursor runQueryOnBackgroundThread(CharSequence constraint) {
    // this is how you query for suggestions
    // notice it is just a StringBuilder building the WHERE clause of a cursor which is the used to query for results

if (constraint==null)
    return null;

    if (getFilterQueryProvider() != null) { return getFilterQueryProvider().runQuery(constraint); }

    String[] projection = new String[] {
            ContactsContract.CommonDataKinds.Phone._ID,
            ContactsContract.CommonDataKinds.Phone.DISPLAY_NAME,
            ContactsContract.CommonDataKinds.Phone.TYPE,
            ContactsContract.CommonDataKinds.Phone.NUMBER};

    return mContent.query(ContactsContract.CommonDataKinds.Phone.CONTENT_URI, projection, 
            "UPPER(" + ContactsContract.CommonDataKinds.Phone.DISPLAY_NAME + ") LIKE '%" + constraint.toString().toUpperCase() + "%' or UPPER(" + ContactsContract.CommonDataKinds.Phone.NUMBER + ") LIKE '%" + constraint.toString().toUpperCase() + "%' ", null, 
            ContactsContract.Contacts.DISPLAY_NAME + " COLLATE LOCALIZED ASC");
}

} 
```

我还在查询中添加了电话号码搜索查询

# php - 来自 db 与来自文件的用户定义常量

> ID：10392327
> 
> 赞同：1
> 
> 时间：2012-05-01T00:57:38.867
> 
> 标签：php

1.  我可以在文件中定义常量然后包含它们，或者

2.  我可以将它们存储在数据库中并播种。

根据您的经验，哪一个是更好/更快/更便宜的资源，比如说..数十、数百、数千个定义？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-01T01:26:51.227

这是一个永远存在的问题，因人而异，有点平衡。对我来说，这完全取决于假定数据集有多大和多大静态。在我的应用程序中，我有大约 10 个代码点，我将在其中引用常量，而不是通过所有开销从数据库中提取数据。

使用常量的另一个好处是，您可以在整个代码库中引用它们，这将有助于减少缺陷并改善语义，例如：

```
class Ad
{
    const ID_AD_TYPE_BANNER = 1;
    const ID_AD_TYPE_SKYSCRAPER = 2;
}

// Somewhere in app
if (array_key_exists(Ad::ID_AD_TYPE_BANNER, $array)) { 
```

但是有一些嗯缺点？我不愿称它们为缺点，因为它们不难解决。首先，如果您的常量是整数，并且您的应用程序曾经将这些常量输入到表中，您将无法加入“查找”表并将查找值视为查询结果的一部分。相反，您只需要知道`1`查询中的 id 的含义。

其次，确保将常量放置在常识位置，并尽可能尝试命名空间，这样，如果您最终忘记它们是什么，您可以轻松找到值。如果你有一个聪明的 IDE，它会为你做这件事。也知道如果一个常量发生变化，你将不得不做一个代码推送 vs 直接操作数据库数据。

如果列表相对较小（<25）并且不易发生太大变化，我会对常量说“是”，但是，如果您的数据与这些约束不匹配，我建议将它们弹出到数据库中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-01T01:04:52.610

我会说文件会更快，但可能会更大，因为数据库会更慢，必须连接并获取结果并返回它。我个人会使用文件。

# jquery - 使用 JQuery 从 WebForm 代码隐藏更改 CSS

> ID：10392332
> 
> 赞同：0
> 
> 时间：2012-05-01T00:58:10.463
> 
> 标签：jquery, css, webforms, juice-ui

我正在尝试从代码隐藏中更改 html 元素的 CSS，但它似乎没有受到影响。客户端它工作。

我可以从代码隐藏调用其他客户端函数，但 JQuery CSS 似乎只在客户端工作。

这是我正在调用的代码：

```
Page.ClientScript.RegisterStartupScript(Page.GetType(),
    "script",
    "$('.anibar .ui-progressbar-value').css('background-image', 'url(images/pbar-ani.png)');",
    true); 
```

不确定这是否会有所作为 - 我正在使用 JuiceUI 进度条 - 使用常规 div 似乎可以工作。

这是它的来源：

```
<div id="divDialog" style="display: none" class="basic-dialog" title="Uploading..." runat="server">
    <juice:ProgressBar ID="ProgressBar1" runat="server" Value="100" CssClass="anibar" />
    <p>
        <asp:Label ID="lblMessage" runat="server" Text="Please wait." />
    </p>
</div> 
```

使用 CSS：

```
.anibar
{
    height: 1.6em;
}
.anibar .ui-progressbar-value
{
    background-image: url(Images/pbar-ani.gif);
} 
```

TIA

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-01T14:54:37.820

首先，不需要您使用 RegisterStartupScript 添加的脚本，因此您可以将其删除。

这里有一个使用 JuiceUI 创建动画进度条的功能示例：http: [//juiceui.com/controls/progressbar](http://juiceui.com/controls/progressbar)。这是页面上的第二个示例（奇怪的是，标记为示例 1）

*看起来*您刚刚复制了那里的代码，这是一个好的开始。您的下一步将是验证这些 css 类是否在页面上的 <head> 中的 <style> 标记中正确定义，或者它们是否在正确加载的 css 文件中。最后，验证 pbar-ani.gif 文件的路径是否正确，相对于 css 类的声明位置。

**编辑**

根据您在下面的评论，这将是一个更可行的解决方案：

定义两个单独的 css 规则。

```
.anibar .ui-progressbar-value { background-image: url(Images/pbar-ani.gif); }
.anibar.loaded .ui-progressbar-value { background-image: url(Images/pbar-ani-other.gif); } 
```

然后在需要的地方使用 jQuery 将“已加载”（您可以将其更改为任何内容）类添加到页面上的进度条。

```
$('.anibar').addClass('loaded'); 
```

另一种选择是删除“anibar”类，这将使控件的外观返回到原始状态。

```
$('.anibar').removeClass('anibar'); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-01T02:02:24.770

您是否在浏览器中看到任何 javascript 错误？

很难说，但我会检查一些事情......

1.) 启动脚本在页面上呈现时是否已加载 jquery（是否定义了“$”）？

2.) 将脚本放在页面上时，DOM/JuicUI 是否完成渲染？如果没有，您可以将脚本包装在准备好的 jquery 文档中吗？

3.) '.ui-progressbar-value' 是正确的选择器吗？它是一个有内容的元素还是需要更多的 CSS 才能使背景图像可见（例如高度、宽度）？

4.) 你真的需要来自代码隐藏的 javascript 来应用这个 css 而不是样式表吗？

希望这可以为您指明解决方案。

# c - 函数指针混淆

> ID：10392333
> 
> 赞同：0
> 
> 时间：2012-05-01T00:58:12.423
> 
> 标签：c, pointers, structure, function-pointers, abstract-data-type

我正在尝试在 c 中使用函数指针和抽象数据类型。这是我第一次使用它，我真的很困惑。无论如何，当我试图编译这段代码时，我给了我一个错误。我第一次运行它工作。但是当我通过 switch`a`和`b`. 它给了我旧的答案，从未更新过。

```
typedef struct data_{
  void *data;
  struct data_ *next;
}data;

typedef struct buckets_{
  void *key;
}buckets;

typedef struct hash_table_ {
  /* structure definition goes here */
  int (*hash_func)(char *);
  int (*comp_func)(void*, void*);
  buckets **buckets_array;
} hash_table, *Phash_table;

main(){

  Phash_table table_p;
  char word[20]= "Hellooooo";
  int a;
  a = 5;
  int b;
  b = 10;
  /*Line 11*/
  table_p = new_hash(15, *print_test(word), *comp_func(&a, &b)); 

}

int *print_test(char *word){
  printf("%s", word);
}

int *comp_func(int *i,int *j){

  if(*i < *j){
    printf("yeeeeeeee");
  }else{
    printf("yeaaaaaaaaaaaaa");
  }
}

Phash_table new_hash(int size, int (*hash_func)(char *), int (*cmp_func)(void *, void *)){
  int i;
  Phash_table table_p;
  buckets *buckets_p;
  hash_table hash_table;

  table_p = (void *)malloc(sizeof(hash_table));

  /*Setting function pointers*/
  table_p -> hash_func = hash_func;
  table_p -> comp_func = cmp_func;

  /*Create buckets array and set to null*/
  table_p -> buckets_array = (buckets **)malloc(sizeof(buckets_p)*(size+1));

  for(i = 0; i < size; i++){
    table_p -> buckets_array[i] = NULL;
  }

  return table_p;
} 
```

这是错误消息：

```
functions.c: In function 'main':
functions.c:11:26: error: invalid type argument of unary '*' (have 'int')
functions.c:11:45: error: invalid type argument of unary '*' (have 'int')
Helloyeaaaaaaaaaaaaa 
```

新错误：

```
functions.c:11:3: warning: passing argument 2 of 'new_hash' makes pointer from integer without a cast [enabled by default]
hash.h:29:13: note: expected 'int (*)(char *)' but argument is of type 'int'
functions.c:11:3: warning: passing argument 3 of 'new_hash' makes pointer from integer without a cast [enabled by default]
hash.h:29:13: note: expected 'int (*)(void *, void *)' but argument is of type 'int' 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-01T01:03:00.597

如果要将函数作为函数指针传递，只需提供名称：

```
new_hash(15, print_test, comp_func); 
```

或者（并且等效地），使用该`&`符号来明确发生了什么：

```
new_hash(15, &print_test, &comp_func); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-01T01:04:10.203

您应该在使用之前声明函数。如果您不这样做，编译器会假定它返回`int`，并在您尝试取消引用它时给您一个错误（因为取消引用 int 是不可能的）。

编辑：您也可能误解了函数指针的概念。你不应该传递`print_test(word)`to的结果`new_hash`- 你应该传递`print_test`自己。（另外，更改其返回类型）

# android - 在指向奇怪的 Linux 包的 Android SDK 上安装包

> ID：10392334
> 
> 赞同：3
> 
> 时间：2012-05-01T00:58:15.050
> 
> 标签：android, linux, installation

默认情况下，我正在尝试安装 SDK 管理器中显示的 Android 2.3.3 API 10（不是任何外部包）。

我单击接受但无法安装，下面是 SDK 管理器溢出的整个日志：

```
Fetching https://dl-ssl.google.com/android/repository/addons_list-1.xml
Validate XML
Parse XML
Fetched Add-ons List successfully
Fetching URL: https://dl-ssl.google.com/android/repository/repository-6.xml
Validate XML: https://dl-ssl.google.com/android/repository/repository-6.xml
Parse XML:    https://dl-ssl.google.com/android/repository/repository-6.xml
  Found SDK Platform Android 1.1, API 2, revision 1 (Obsolete)
  Found SDK Platform Android 1.5, API 3, revision 4
  Found SDK Platform Android 1.6, API 4, revision 3
  Found SDK Platform Android 2.0, API 5, revision 1 (Obsolete)
  Found SDK Platform Android 2.0.1, API 6, revision 1 (Obsolete)
  Found SDK Platform Android 2.1, API 7, revision 3
  Found SDK Platform Android 2.2, API 8, revision 3
  Found SDK Platform Android 2.3.1, API 9, revision 2 (Obsolete)
  Found SDK Platform Android 2.3.3, API 10, revision 2
  Found SDK Platform Android 3.0, API 11, revision 2
  Found SDK Platform Android 3.1, API 12, revision 3
  Found SDK Platform Android 3.2, API 13, revision 1
  Found SDK Platform Android 4.0, API 14, revision 3
  Found SDK Platform Android 4.0.3, API 15, revision 3
  Found ARM EABI v7a System Image, Android API 14, revision 2
  Found ARM EABI v7a System Image, Android API 15, revision 2
  Found Samples for SDK API 7, revision 1
  Found Samples for SDK API 8, revision 1
  Found Samples for SDK API 9, revision 1 (Obsolete)
  Found Samples for SDK API 10, revision 1
  Found Samples for SDK API 11, revision 1
  Found Samples for SDK API 12, revision 1
  Found Samples for SDK API 13, revision 1
  Found Samples for SDK API 14, revision 2
  Found Samples for SDK API 15, revision 2
  Found Android SDK Platform-tools, revision 11
  Found Android SDK Tools, revision 19
  Found Documentation for Android SDK, API 15, revision 2
  Found Sources for Android SDK, API 14, revision 1
  Found Sources for Android SDK, API 15, revision 2
  Found Android Support, revision 8
Fetching URL: https://dl-ssl.google.com/android/repository/addon.xml
Validate XML: https://dl-ssl.google.com/android/repository/addon.xml
Parse XML:    https://dl-ssl.google.com/android/repository/addon.xml
  Found Google APIs, Android API 3, revision 3
  Found Google APIs, Android API 4, revision 2
  Found Google APIs, Android API 5, revision 1 (Obsolete)
  Found Google APIs, Android API 6, revision 1 (Obsolete)
  Found Google APIs, Android API 7, revision 1
  Found Google APIs, Android API 8, revision 2
  Found Google APIs, Android API 9, revision 2 (Obsolete)
  Found Google APIs, Android API 10, revision 2
  Found Google APIs, Android API 11, revision 1
  Found Google APIs, Android API 12, revision 1
  Found Google APIs, Android API 13, revision 1
  Found Google APIs, Android API 14, revision 2
  Found Google TV Addon, Android API 12, revision 2
  Found Google APIs, Android API 15, revision 2
  Found Google Play Licensing Library, revision 2
  Found Google Play APK Expansion Library, revision 1
  Found Google USB Driver, revision 4
  Found Google Play Billing Library, revision 1
  Found Google AdMob Ads SDK, revision 5
  Found Google Analytics SDK, revision 2
  Found Google Web Driver, revision 2
Fetching URL: http://dl.htcdev.com/sdk/addon.xml
Validate XML: http://dl.htcdev.com/sdk/addon.xml
Parse XML:    http://dl.htcdev.com/sdk/addon.xml
  Found OpenSense SDK for Tablets, Android API 12, revision 2
  Found OpenSense SDK for Phones, Android API 10, revision 2
Fetching URL: http://software.intel.com/sites/landingpage/android/addon.xml
Validate XML: http://software.intel.com/sites/landingpage/android/addon.xml
Parse XML:    http://software.intel.com/sites/landingpage/android/addon.xml
  Found Intel Atom x86 System Image, Android API 10, revision 1
  Found Intel Hardware Accelerated Execution Manager, revision 1
Fetching URL: http://www.echobykyocera.com/download/echo_repository.xml
Validate XML: http://www.echobykyocera.com/download/echo_repository.xml
Parse XML:    http://www.echobykyocera.com/download/echo_repository.xml
  Found Dual Screen APIs, Android API 8, revision 1
  Found Dual Screen APIs, Android API 10, revision 1
Fetching URL: http://developer.lgmobile.com/sdk/android/repository.xml
Validate XML: http://developer.lgmobile.com/sdk/android/repository.xml
Parse XML:    http://developer.lgmobile.com/sdk/android/repository.xml
  Found Real3D, Android API 10, revision 2
  Found Real3D, Android API 8, revision 1
Fetching URL: http://android-sdk-addons.motodevupdate.com/addons.xml
Validate XML: http://android-sdk-addons.motodevupdate.com/addons.xml
Parse XML:    http://android-sdk-addons.motodevupdate.com/addons.xml
  Found ADMIRAL, Android API 10, revision 5
  Found ATRIX2, Android API 10, revision 1
  Found Droid4, Android API 10, revision 2
  Found DroidRAZR, Android API 10, revision 5
  Found MT917, Android API 10, revision 1
  Found MotorolaPro+, Android API 10, revision 2
  Found XOOM2, Android API 13, revision 2
  Found XOOM2ME, Android API 13, revision 2
  Found XT882, Android API 10, revision 2
  Found XT928, Android API 10, revision 1
  Found defy+, Android API 10, revision 1
  Found Bionic, Android API 10, revision 2
  Found MT870, Android API 10, revision 2
  Found PHOTON, Android API 10, revision 1
  Found XOOM, Android API 11, revision 2
Fetching URL: http://innovator.samsungmobile.com/android/repository/repository.xml
Validate XML: http://innovator.samsungmobile.com/android/repository/repository.xml
Parse XML:    http://innovator.samsungmobile.com/android/repository/repository.xml
  Found GALAXY Tab, Android API 8, revision 1
Fetching URL: http://developer.sonymobile.com/edk/android/repository.xml
Validate XML: http://developer.sonymobile.com/edk/android/repository.xml
Parse XML:    http://developer.sonymobile.com/edk/android/repository.xml
  Found Sony Xperia Extensions EDK 2.0, Android API 10, revision 2
Done loading packages.
Preparing to install archives
Downloading SDK Platform Android 2.3.3, API 10, revision 2
File not found: C:\Program Files (x86)\Android\android-sdk\temp\android-2.3.3_r02-linux.zip (Access is denied)
Downloading Samples for SDK API 10, revision 1
File not found: C:\Program Files (x86)\Android\android-sdk\temp\samples-2.3.3_r01-linux.zip (Access is denied)
Downloading Google USB Driver, revision 4
File not found: C:\Program Files (x86)\Android\android-sdk\temp\usb_driver_r04-windows.zip (Access is denied)
Skipping 'Google APIs, Android API 10, revision 2'; it depends on 'SDK Platform Android 2.3.3, API 10, revision 2' which was not installed.
Skipping 'OpenSense SDK for Phones, Android API 10, revision 2'; it depends on 'SDK Platform Android 2.3.3, API 10, revision 2' which was not installed.
Skipping 'Intel Atom x86 System Image, Android API 10, revision 1'; it depends on 'SDK Platform Android 2.3.3, API 10, revision 2' which was not installed.
Skipping 'Dual Screen APIs, Android API 10, revision 1'; it depends on 'SDK Platform Android 2.3.3, API 10, revision 2' which was not installed.
Skipping 'Real3D, Android API 10, revision 2'; it depends on 'SDK Platform Android 2.3.3, API 10, revision 2' which was not installed.
Skipping 'ADMIRAL, Android API 10, revision 5'; it depends on 'SDK Platform Android 2.3.3, API 10, revision 2' which was not installed.
Skipping 'ATRIX2, Android API 10, revision 1'; it depends on 'SDK Platform Android 2.3.3, API 10, revision 2' which was not installed.
Skipping 'Bionic, Android API 10, revision 2'; it depends on 'SDK Platform Android 2.3.3, API 10, revision 2' which was not installed.
Skipping 'defy+, Android API 10, revision 1'; it depends on 'SDK Platform Android 2.3.3, API 10, revision 2' which was not installed.
Skipping 'Droid4, Android API 10, revision 2'; it depends on 'SDK Platform Android 2.3.3, API 10, revision 2' which was not installed.
Skipping 'DroidRAZR, Android API 10, revision 5'; it depends on 'SDK Platform Android 2.3.3, API 10, revision 2' which was not installed.
Skipping 'MotorolaPro+, Android API 10, revision 2'; it depends on 'SDK Platform Android 2.3.3, API 10, revision 2' which was not installed.
Skipping 'MT870, Android API 10, revision 2'; it depends on 'SDK Platform Android 2.3.3, API 10, revision 2' which was not installed.
Skipping 'MT917, Android API 10, revision 1'; it depends on 'SDK Platform Android 2.3.3, API 10, revision 2' which was not installed.
Skipping 'PHOTON, Android API 10, revision 1'; it depends on 'SDK Platform Android 2.3.3, API 10, revision 2' which was not installed.
Skipping 'XT882, Android API 10, revision 2'; it depends on 'SDK Platform Android 2.3.3, API 10, revision 2' which was not installed.
Skipping 'XT928, Android API 10, revision 1'; it depends on 'SDK Platform Android 2.3.3, API 10, revision 2' which was not installed.
Skipping 'Sony Xperia Extensions EDK 2.0, Android API 10, revision 2'; it depends on 'SDK Platform Android 2.3.3, API 10, revision 2' which was not installed.
Done. Nothing was installed.
Preparing to install archives
Downloading SDK Platform Android 2.3.3, API 10, revision 2
File not found: C:\Program Files (x86)\Android\android-sdk\temp\android-2.3.3_r02-linux.zip (Access is denied)
Downloading Samples for SDK API 10, revision 1
File not found: C:\Program Files (x86)\Android\android-sdk\temp\samples-2.3.3_r01-linux.zip (Access is denied)
Done. Nothing was installed. 
```

我注意到有一些参考：“找不到文件：C:\Program Files (x86)\Android\android-sdk\temp\samples-2.3.3_r01-linux.zip (Access is denied)”或某种linux.zip 的东西，但我使用的是 Windows 7 而不是 Linux 操作系统。

为什么要提出Linux？linux 二进制文件不能在 Windows 上运行不是很明显吗？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-05-01T01:08:18.517

`Access is denied`由于出现错误，您必须以管理员身份运行它。Windows（> Vista afaik）不允许在`C:\Program Files (x86)\`没有它的情况下写入。

# java - 如何在不检查每个对象的情况下检查 2D 碰撞

> ID：10392335
> 
> 赞同：9
> 
> 时间：2012-05-01T00:58:15.047
> 
> 标签：java, 2d, collision

我非常雄心勃勃，正在开发一款 2D 射击游戏，希望有数百个实体四处奔跑。

我在思考时遇到的问题是子弹如何检测它何时与物体发生碰撞，而无需检查地图上的每个物体。原因是我觉得如果屏幕上有四打子弹，每次检查与地图上每个实体的碰撞，每个循环，我都会看到一些相当显着的性能损失。

那么在不检查每个实体的情况下检测碰撞的最佳方法是什么？

当我有两个对象时，我可以处理碰撞算法，但我似乎无法找到一种方法让这两个对象互相看到而不先检查其他人。

我正在使用（即将纹理化的）QUADS 使用 Java 和 OpenGL。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-05-01T01:00:39.037

你应该研究[*四叉树*](http://en.wikipedia.org/wiki/Quadtree)；它们通常用于高效的 2D 查找。

# java - 如何仅删除字符串中大写字符的变音符号

> ID：10392339
> 
> 赞同：1
> 
> 时间：2012-05-01T00:58:55.130
> 
> 标签：java, normalization, denormalization, unicode-normalization

我需要从字符串中的大写字符中删除变音符号。示例：Électronique Caméras => Electronique Caméras（仅修改了 É，Caméras 中的 é 保持原样）

我正在使用以下方法，它仅从大写字母中删除变音符号，但重建的字符串看起来像这样 - Electronique Came?ras（é 丢失）。如何正确重建字符串？

```
public static String removeDiacriticsFromUppercaseLetters(String input)
    {
        if (input == null)
              return input;
        String normalized= Normalizer.normalize(input, Normalizer.Form.NFD);

        StringBuilder newString = new StringBuilder();
        newString.append(normalized.charAt(0));

        for (int i=1;i<normalized.length();++i)
        {
            //Check if this diacritic is for an uppercase letter, if yes, skip
            if (Character.isUpperCase(normalized= .charAt(i-1)) && Character.getType(normalized.charAt(i)) == Character.NON_SPACING_MARK){
              continue;
            }
            else{
              newString.append(normalized.charAt(i));
            }
        }
        return newString.toString();
    } 
```

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-03T21:23:11.283

试试这个：

```
public static String removeDiacriticsFromUppercaseLetters(String input) 
{ 
    if (input == null) 
        return null; 

    String normalized = Normalizer.normalize(input, Normalizer.Form.NFD); 

    StringBuilder newString = new StringBuilder(); 
    boolean checkDiacritics = false;

    for (int i = 0; i < normalized.length(); ++i) 
    { 
        char ch = normalized.charAt(i);

        if (checkDiacritics)
        {
            if (Character.getType(ch) == Character.NON_SPACING_MARK)
                continue;

            checkDiacritics = false;
        }

        if (Character.isUpperCase(ch))
            checkDiacritics = true;

        newString.append(ch); 
    } 

    //return newString.toString(); 
    return Normalizer.normalize(newString.toString(), Normalizer.Form.NFC); 
} 
```

# php - 如何从旋转/缩放中获取 SVG 变换矩阵值

> ID：10392340
> 
> 赞同：3
> 
> 时间：2012-05-01T00:58:55.467
> 
> 标签：php, matrix, svg

本质上，我正在寻找一个 PHP 函数或方程，它将输出 SVG 转换中使用的矩阵值。

我到处打猎，不幸的是一无所获。

我很清楚 rotate() 和 scale function() 但是这些不是我需要的。

我需要能够以度数为单位的旋转角度以及 x/y 比例数据，并以 SVG 变换格式矩阵（a、b、c、d、e、f）输出一系列值

理想情况下，我想在 PHP 中执行此操作，但如前所述，标准数学方程式也会有所帮助。

希望有人能指出我正确的方向。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-01T15:18:30.130

您可以通过将单个变换的矩阵相乘来计算这些值。查看[SVG 规范](http://www.w3.org/TR/SVG/coords.html#NestedTransformations)以找到它们的定义：

```
rot(a)       := matrix(cos(a), sin(a), -sin(a), cos(a), 0, 0)
scale(sx,sy) := matrix(sx, 0, 0, sy, 0, 0) 
```

根据应应用变换的顺序（缩放前的旋转与旋转前的缩放），您会得到不同的矩阵：

```
rot(a)*scale(sx,sy) = matrix(sx*cos(a), sx*sin(a), -sy*sin(a), sy*cos(a), 0, 0)
scale(sx,sy)*rot(a) = matrix(sx*cos(a), sy*sin(a), -sx*sin(a), sy*cos(a), 0, 0) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-08T06:38:53.630

```
function selectElement(evt) {
        selectedElement = evt.target;
        currentX = evt.clientX;
        currentY = evt.clientY;
        currentMatrix = selectedElement.getAttributeNS(null, "transform").slice(7, -1).split(' ');
        alert(currentMatrix );
    }`<svg><rect class="draggable" x="30" y="30" width="80" height="80" fill="blue" transform="matrix(1 0 0 1 0 0)"
        onmousedown="selectElement(evt)"</svg> />` 
```

# internet-explorer-9 - ie9 中的边框半径在元素中产生清晰的线条（图片链接以供参考）

> ID：10392341
> 
> 赞同：4
> 
> 时间：2012-05-01T00:59:01.160
> 
> 标签：internet-explorer-9, css

我正在使用 css 创建带有锚标签（下面的 css）的按钮样式，并且代码在 firefox、safari 和 chrome 中工作得很好，圆角显示得很好。但是在 ie9 中，按钮内部出现了一条奇怪的条纹。我附上了一张图片来说明我的意思，这些线条大约穿过按钮的一半。这真的很奇怪，它甚至出现在我在试图弄清楚它是否只是我时发现的教程中的按钮上。这是教程的链接：http: [//pythoughts.com/pure-css-buttons/](http://pythoughts.com/pure-css-buttons/)

有谁知道是什么原因造成的？线条实际上是透明的，您可以通过按钮中的线条看到中间 div 的黄色背景。我不知道如何纠正这个问题。

CSS：

```
.button{
    padding:1px 5px;
    background:#cbebd3;
    color:#333;
    border:1px solid #98b99e;
    -moz-border-radius: 5px; 
    -webkit-border-radius: 5px;
    border-radius: 5px;
} 
```

我正在使用这样的风格：

```
<a href="some-link.php" class="button">View Details</a> 
```

这是图像：

![按钮问题](../Images/d194a110b11f8d946e0737e6489dc3e5.png)

根据下面的建议，我尝试了 jsfiddle 中的代码，并得到了相同的结果。如下图所示。 ![jsfiddle中的问题](../Images/d5a99ec8e2482f28d3668596d977f740.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-29T23:05:43.477

在我的 IE9 (win 7) 中也很好用，我只能给你一个建议，你不必再为border-radius、box-shadow 和 text-shadow 添加前缀，border-radius box-shadow text-shadow (也许更多的东西）现在是所有最新浏览器的标准

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-05-08T10:29:22.207

您需要添加`display: block;`，`float: left;`否则标签是内联的

# mysql - 在 MySQL 中，如何创建全局/通用外部 ID？

> ID：10392344
> 
> 赞同：1
> 
> 时间：2012-05-01T00:59:31.830
> 
> 标签：mysql

# 问题：

有没有办法让外国 ID 指向比一个特定表更通用的东西？

# 细节：

我经常遇到这样的情况，我有几个彼此无关的表，但仍然需要一个公用表（在下面的示例中，引擎是`innodb`）

```
CREATE TABLE IF NOT EXISTS movies
(
   id    INT NOT NULL auto_increment,
   name  VARCHAR(100) NOT NULL ,

   PRIMARY KEY(id)
);

CREATE TABLE IF NOT EXISTS books
(
   id    INT NOT NULL auto_increment,
   name  VARCHAR(100) NOT NULL ,

   PRIMARY KEY(id)
);

CREATE TABLE IF NOT EXISTS songs
(
   id    INT NOT NULL auto_increment,
   name  VARCHAR(100) NOT NULL ,

   PRIMARY KEY(id)
);

CREATE TABLE IF NOT EXISTS news_papers
(
   id    INT NOT NULL auto_increment,
   name  VARCHAR(100) NOT NULL ,

   PRIMARY KEY(id)
);

CREATE TABLE IF NOT EXISTS scrolls
(
   id    INT NOT NULL auto_increment,
   name  VARCHAR(100) NOT NULL ,

   PRIMARY KEY(id)
);

CREATE TABLE IF NOT EXISTS sumarian_wheat_tablets
(
   id    INT NOT NULL auto_increment,
   name  VARCHAR(100) NOT NULL ,

   PRIMARY KEY(id)
); 
```

现在我想记录每次被这样查看的时间

```
CREATE TABLE IF NOT EXISTS movie_history
(
   id          INT NOT NULL auto_increment,
   foreign_id  INT NOT NULL ,
   view_date   TIMESTAMP DEFAULT now(),

   FOREIGN KEY (foreign_id) REFERENCES movies ( id ),
   PRIMARY KEY(id)
);

CREATE TABLE IF NOT EXISTS book_history
(
   id          INT NOT NULL auto_increment,
   foreign_id  INT NOT NULL ,
   view_date   TIMESTAMP DEFAULT now(),

   FOREIGN KEY (foreign_id) REFERENCES books ( id ),
   PRIMARY KEY(id)
);

CREATE TABLE IF NOT EXISTS song_history
(
   id          INT NOT NULL auto_increment,
   foreign_id  INT NOT NULL ,
   view_date   TIMESTAMP DEFAULT now(),

   FOREIGN KEY (foreign_id) REFERENCES songs ( id ),
   PRIMARY KEY(id)
);

CREATE TABLE IF NOT EXISTS news_paper_history
(
   id          INT NOT NULL auto_increment,
   foreign_id  INT NOT NULL ,
   view_date   TIMESTAMP DEFAULT now(),

   FOREIGN KEY (foreign_id) REFERENCES news_papers ( id ),
   PRIMARY KEY(id)
);

CREATE TABLE IF NOT EXISTS scroll_history
(
   id          INT NOT NULL auto_increment,
   foreign_id  INT NOT NULL ,
   view_date   TIMESTAMP DEFAULT now(),

   FOREIGN KEY (foreign_id) REFERENCES scrolls ( id ),
   PRIMARY KEY(id)
);

CREATE TABLE IF NOT EXISTS sumarian_wheat_tablet_history
(
   id          INT NOT NULL auto_increment,
   foreign_id  INT NOT NULL ,
   view_date   TIMESTAMP DEFAULT now(),

   FOREIGN KEY (foreign_id) REFERENCES sumarian_wheat_tablets ( id ),
   PRIMARY KEY(id)
); 
```

有没有更正确的方法来处理这种情况而无需创建 n 个新表？我意识到我可以制作一张`history`表格并将其复制过来，`CREATE TABLE...LIKE...`但这仍然需要制作 n 个新表格，而且我必须`ALTER`进入`foreign_id`.

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-01T01:56:09.143

我的第一个想法就是转储 fk 引用并拥有一个历史表：

```
CREATE TABLE history(
   base_table    VARCHAR,
   base_table_id INT,
   view_date     TIMESTAMP DEFAULT now()
); 
```

但是我假设您希望 fk 保持完整性（问题：这真的有必要吗，或者可以解决这个问题吗？）。我想你可以通过创建一个“正在使用的 pks”表来实现这一点。例如：

*   使用列 id (autoincrement) 和 base_table_name 创建一个表“keys”
*   创建一个表“movies”，其中 id 既是 pk 也是“keys.id”的 fk（但不是自动增量列）
*   将“插入前”触发器添加到“电影”，将记录插入“键”，返回生成的 ID，用作“电影”记录的 ID
*   创建一个带有 fk 到“keys”的历史表
*   在“电影”上创建一个“删除”触发器，如果​​您希望保持完整性或级联删除等，它也会从“键”中删除记录

因此生成的“id”在许多表中共享。有一种思想流派建议在数据库内的所有关系中使用唯一的主键（“企业键”），因此它并非史无前例。有时使用 GUID 或 UUID，而不是使用序列或自动生成的列。

这用每个基表上的触发器替换了额外的历史表，这可能不是一件好事，具体取决于您的环境。我自己没有这样做，只是把一些想法扔在那里，所以把它当作它的价值。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-01T01:04:35.430

这取决于您保留的记录。如果您只想了解命中，请在每个表中添加一个字段，每次满足您的“命中”条件时（即从网页读取），该字段就会递增。如果您想保留更多信息：

```
CREATE TABLE IF NOT EXISTS view_history
(
   id          INT NOT NULL,
   table       VARCHAR NOT NULL,
   //other relevant stats to a given view, such as ip and so on.
) 
```

id 和 table 形成了一个组合键，用于确定它所指的表。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-01T01:44:09.717

我认为没有一种方法可以在单个外键上指定多个表。

如果定义单个历史表，则不能使用单个外键强制引用完整性。您可以[按照此处的说明以编程方式强制执行它](http://dev.mysql.com/tech-resources/articles/mysql-enforcing-foreign-keys.html)

这描述了如何为不支持 FK 的其他存储引擎执行此操作，但可以用作实现所需内容的指南。它建议创建触发器来强制执行与外键相同的验证。

其他方法：

```
CREATE TABLE IF NOT EXISTS history
(
   id            INT NOT NULL auto_increment,
   movie_id      INT,
   book_id       INT,
   song_id       INT,
   news_paper_id INT,
   view_date   TIMESTAMP DEFAULT now(),

   FOREIGN KEY (movie_id) REFERENCES movie ( id ),
   FOREIGN KEY (book_id) REFERENCES book ( id ),
   FOREIGN KEY (song_id) REFERENCES song ( id ),
   FOREIGN KEY (news_paper_id) REFERENCES news_paper ( id ),
   PRIMARY KEY(id)
); 
```

# iphone - UIScrollView 应用程序（启用分页）加载仅与当前页面相关的图像

> ID：10392347
> 
> 赞同：0
> 
> 时间：2012-05-01T00:59:50.150
> 
> 标签：iphone, objective-c, xml, uiscrollview, paging

我想知道是否有人可以为解决这个问题提供任何建议。

我正在构建一个应用程序，它使用启用了分页的 UIScrollView，每个页面对应于下载和解析的 XML 数据。该 XML 数据的一部分是图像的 URL。

现在，加载一个为每个 XML 条目下载图像然后将其推送到运行时创建的相应 UIScrollView 页面以及其余 XML 数据的应用程序将花费很长时间。

有没有办法能够检测到您所在的 UIScrollView 页面，然后根据需要下载图像，并且仍然允许在运行时下载其余数据？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-01T01:07:08.020

尝试阅读[SDWebImage](https://github.com/rs/SDWebImage)或 Apple 的[LazyTableImages](http://developer.apple.com/library/ios/#samplecode/LazyTableImages/Introduction/Intro.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-22T16:26:43.770

就像参考一样，我通过将所有图像视图添加到 NSArray 中来解决它。使用滚动视图委托，我能够确定我所在的页码，并将该页码转换为我用来访问位于数组中的适当 uiimage 视图的整数。

它似乎工作得很好！

你能提供更好的解决方案吗？

# c# - 如何使标签静态化

> ID：10392348
> 
> 赞同：1
> 
> 时间：2012-05-01T01:00:14.363
> 
> 标签：c#, wpf, class, static, label

所以我有一个程序，我在其中告诉用户两个骨架是否匹配，但问题是我需要`label`通过`class`. 我不断收到的错误是

```
Error1  An object reference is required for the
non-static field, method, or property 
'WpfApplication1.MainWindow.matchLabel' 
```

这是我的代码中的内容：

### `static`标签_

```
static Label matching
    {
        get { return matchLabel; } //errors here
        set { matchLabel = value; } //and here
    } 
```

### 班上

```
private class Scan
    {
        private void Start()
        {
            Skeleton skeleton = new Skeleton();

            if (PersonDetected == true)
            {
                int SkeletonID2 = skeleton.TrackingId;

                if (SkeletonID1 == SkeletonID2)
                {
                    matching.Content = "Your IDs are Matching!";
                }

                else if (SkeletonID2 != SkeletonID1)
                {
                    matching.Content = "Your IDs don't Match.";
                }
            }
        }

        private void Stop()
        {
            if (PersonDetected == true)
            {
                matching.Content = "Scan Aborted";
            }
        }
    } 
```

基本上我想知道如何在 中制作标签`wpf` `static`，或者是否有其他方法可以做到这一点。
提前致谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-01T02:25:23.663

我认为您可以使用另一种方法，就像@Daniel 所说，在多个线程上使用 UI 元素是一个坏主意。

如果我的理解是正确的，您只想将域逻辑的结果**通知**给用户，我这样做的方式很简单，创建一个事件：

`public event Action<string> MyEvent = delegate { };`

```
 if (SkeletonID1 == SkeletonID2)
            {
                this.MyEvent("Your IDs are Matching!");
            }

            else if (SkeletonID2 != SkeletonID1)
            {
                this.MyEvent("Your IDs don't Match.");
            }

 if (PersonDetected == true)
            {
                this.MyEvent("Scan Aborted");
            } 
```

在您的 WPF 视图中

`this.MydomainComponent.MyEvent += (x) => { this.matchLabel.Content = x; };`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-01T01:02:50.003

这是一个坏主意。您不应该在多个线程上创建 UI 元素。

你真的应该考虑实现 MVVM 模式。它将使您的代码更加解耦并增加可测试性。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-01T02:12:13.993

您最好的选择是使用内置的 WPF 数据绑定。您可以使用 MVVM 模式，但这不是必需的。

窗口类 (XAML)

```
<Window x:Class="WpfApplication2.MyWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="MyWindow" Height="300" Width="300">
    <Grid>
        <Label Content="{Binding Path=MyLabelValue}" />
    </Grid>
</Window> 
```

窗口代码后面（代码）

```
using System.Windows;
using System.ComponentModel;

namespace WpfApplication2
{
    /// <summary>
    /// Interaction logic for MyWindow.xaml
    /// </summary>
    public partial class MyWindow : Window, INotifyPropertyChanged
    {
        public MyWindow()
        {
            InitializeComponent();

            DataContext = this;  // Sets context of binding to the class 
        }

        // Property for binding
        private string _mylabelvalue;
        public string MyLabelValue
        {
            get { return _mylabelvalue; }
            set 
            { 
                _mylabelvalue = value;
                if(PropertyChanged != null)
                {
                    PropertyChanged(this, new PropertyChangedEventArgs("MyLabelValue"));
                }
            }
        }

        public event PropertyChangedEventHandler PropertyChanged;
    }
} 
```

通过在设置/调用窗口上的属性时使用此方法，您可以获得标签的值。当您更改属性时 - 您通过数据绑定和 INotifyPropertyChanged 接口更新 UI 中的值。我在我的博客上有一个关于通过反射和使用 MVVM 模式的部分。

[http://tsells.wordpress.com/category/mvvm/](http://tsells.wordpress.com/category/mvvm/)

# crash - 大数据集的 CUDA 崩溃

> ID：10392349
> 
> 赞同：2
> 
> 时间：2012-05-01T01:00:28.490
> 
> 标签：crash, cuda

当我在循环中运行我的内核函数 600 多次（如果它像 50 次左右它不会崩溃）时，我的计算机崩溃（我必须手动重置它），我不确定是什么导致了崩溃。

我的主要是这样的：

```
int main()
{
    int *seam = new int [image->height];
    int width = image->width;
    int height = image->height;

    int *fMC = (int*)malloc(width*height*sizeof(int*));
    int *fNew = (int*)malloc(width*height*sizeof(int*));

    for(int i=0;i<numOfSeams;i++) 
    {
        seam = cpufindSeamV2(fMC,width,height,1);

        fMC = kernel_shiftSeam(fMC,fNew,seam,width,height,nWidth,1);

        for(int k=0;k<height;k++)
        {
            fMC[(nWidth-1)+width*k] = INT_MAX;
        }
    } 
```

我的内核是：

```
int* kernel_shiftSeam(int *MCEnergyMat, int *newE, int *seam, int width, int height, int x, int direction)
{
    //time measurement
    float elapsed_time_ms = 0;
    cudaEvent_t start, stop;      //threads per block

    dim3 threads(16,16);
    //blocks
    dim3 blocks((width+threads.x-1)/threads.x, (height+threads.y-1)/threads.y);

    //MCEnergy and Seam arrays on device
    int *device_MC, *device_new, *device_Seam;

    //MCEnergy and Seam arrays on host
    int *host_MC, *host_new, *host_Seam;

    //total number of bytes in array
    int size = width*height*sizeof(int);
    int seamSize;

    if(direction == 1)
    {
        seamSize = height*sizeof(int);
        host_Seam = (int*)malloc(seamSize);
        for(int i=0;i<height;i++)
            host_Seam[i] = seam[i];
    }
    else
    {
        seamSize = width*sizeof(int);
        host_Seam = (int*)malloc(seamSize);
        for(int i=0;i<width;i++)
            host_Seam[i] = seam[i];
    }

     cudaMallocHost((void**)&host_MC, size );
     cudaMallocHost((void**)&host_new, size );

     host_MC = MCEnergyMat;
     host_new = newE;

    //allocate 1D flat array on device
    cudaMalloc((void**)&device_MC, size);
    cudaMalloc((void**)&device_new, size);
    cudaMalloc((void**)&device_Seam, seamSize);

    //copy host array to device
    cudaMemcpy(device_MC, host_MC, size, cudaMemcpyHostToDevice);
    cudaMemcpy(device_new, host_new, size, cudaMemcpyHostToDevice);
    cudaMemcpy(device_Seam, host_Seam, seamSize, cudaMemcpyHostToDevice);

    //measure start time for cpu calculations
    cudaEventCreate(&start);
    cudaEventCreate(&stop);
    cudaEventRecord(start, 0);

    //perform gpu calculations
    if(direction == 1)
    {
      gpu_shiftSeam<<< blocks,threads >>>(device_MC, device_new, device_Seam, width, height, x);
    }

    //measure end time for cpu calcuations
    cudaEventRecord(stop, 0);
    cudaEventSynchronize(stop);
    cudaEventElapsedTime(&elapsed_time_ms, start, stop );

    execTime += elapsed_time_ms;

    //copy out the results back to host
    cudaMemcpy(newE, device_new, size, cudaMemcpyDeviceToHost);

    //free memory
    free(host_Seam);
    cudaFree(host_MC); cudaFree(host_new); 
    cudaFree(device_MC); cudaFree(device_new); cudaFree(device_Seam);

    //destroy event objects
    cudaEventDestroy(start); cudaEventDestroy(stop);

    return newE;
} 
```

所以，当我多次调用“kernel_shiftSeam”时，我的程序崩溃了，我还使用 cudaFree 释放了内存，所以我不知道它是否是内存泄漏问题。如果有人能指出我正确的方向，那就太好了。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-02T22:30:36.400

可能是堆问题。尝试将内核中的 cudaFree 语句重新排序为 LIFO。检查包含堆/泄漏修复的任何更新的 CUDA 驱动程序的发行说明。在 Windows 上尝试安装进程资源管理器 15.12 或更高版本，因为它显示 GPU 内存使用情况 - 并且很容易发现泄漏堆。

# javascript - jQuery 1.4.4 和 1.7.2 之间的 .ajax() 发生了什么导致代码中断？

> ID：10392353
> 
> 赞同：2
> 
> 时间：2012-05-01T01:01:22.913
> 
> 标签：javascript, jquery, json

我需要在当前使用 1.4.4 的网站上迁移到 jQuery 1.7.2。我有以下 ajax 调用，在 1.4.4 中运行良好，但正在回退

> 没有从文本到[对象的转换

在 1.7.2 中。（我认为这与 .parseJSON() 有更多关系，但我不确定。）

```
function ajax_update(table_value, key_value, value_value, newkey_value, newvalue_value, debug) {
$.ajax({
    type: "POST",
    url: "/index.php/ajax/updatepost/",
    data: { 
        table: table_value,
        key: key_value,
        value: value_value,
        newkey: newkey_value,
        newvalue: newvalue_value
    },
    dataType: JSON,
    success: function(data, textStatus){

        var result = jQuery.parseJSON(data);

        //both debug and flash going in two different directions
        $("div#flash > p").text(result.message);
        $("div#flash").removeClass().addClass("message").addClass(result.flavor).slideDown(500).delay(1200).slideUp(500);

        if (debug == true) {
            $("div#debugflash > p").text(result.debug);
            $("div#debugflash").removeClass().addClass("message").addClass("information").show();
        }
    },
    error: function(errorObj, textStatus, errorThrown){

        $("div#flash > p").text(errorThrown);
        $("div#flash").removeClass().addClass("message").addClass("error").slideDown(500).delay(1200).slideUp(500);

        if (debug == true) {
            $("div#debugflash > p").text(errorThrown);
            $("div#debugflash").removeClass().addClass("message").addClass("information").show();
        }
    }
}); 
```

}

json 在 jsonlint.com 中验证，由调用 json_encode(array) 的 php 脚本生成，如下所示：

```
{"message":"Updated field name with value ALAMO",
"flavor":"success",
"debug":"UPDATE `customers` SET `name` = 'ALAMO' WHERE `cust_id` = 'ALA100'" 
```

}

标题：

```
HTTP/1.1 200 OK
Date: Tue, 01 May 2012 00:00:15 GMT
Server: Apache/2.2.21 (Unix) mod_ssl/2.2.21 OpenSSL/0.9.8r DAV/2 PHP/5.3.8 with Suhosin-Patch
X-Powered-By: PHP/5.3.8
Expires: Thu, 19 Nov 1981 08:52:00 GMT
Cache-Control: no-store, no-cache, must-revalidate, post-check=0, pre-check=0
Pragma: no-cache
MS-Author-Via: DAV
Content-Length: 177
Keep-Alive: timeout=15, max=96
Connection: Keep-Alive
Content-Type: application/json 
```

任何帮助深表感谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-01T01:16:09.330

我认为这与这条线有关

```
dataType: JSON 
```

试试这个

```
dataType: 'json' 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-01T03:18:46.220

jQuery 1.5 重写了 AJAX，使其更具可扩展性。请参阅[http://encosia.com/jquery-1-5s-ajax-rewrite-and-asp-net-services-all-is-well/](http://encosia.com/jquery-1-5s-ajax-rewrite-and-asp-net-services-all-is-well/) 可能您传递给成功函数的数据已经被`JSON.parse()`编辑了。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-01T01:06:19.507

我认为您的错误可能与此行有关：

```
 var result = jQuery.parseJSON(data); 
```

尝试使用

```
alert(data); 
```

在上一行以确保您的数据变量包含数据。

# php - PHP + 正则表达式

> ID：10392359
> 
> 赞同：0
> 
> 时间：2012-05-01T01:02:19.790
> 
> 标签：php, regex, expression

下面是 2 条寻呼机警报消息，我很头疼，试图使用正则表达式将第二条消息的地址和工作详细信息提取到 php 字符串中......

以下是 2 条示例消息：

```
0571040 15:45:21 30-04-12  @@ALERT F546356345 THEB8 STRUC1 SMELL OF SMOKE AND ALARM OPERATING 900 SOME ROAD SOMESUBURB /CROSSSTREET1 RD //CROSSTREET2 AV M 99 A1 (429085) CTHEB CBOROS PT28 [THEB]

0571040 15:45:21 30-04-12  @@ALERT F546356345 THEB8 STRUC1 SMELL OF SMOKE AND ALARM OPERATING 4 / 900 SOME ROAD SOMESUBURB /CROSSSTREET1 RD //CROSSTREET2 AV M 99 A1 (429085) CTHEB CBOROS PT28 [THEB] 
```

您会注意到第二个地址的开头是 4 / 900，或者它可以说是 Unit 4 / 900... 这就是我的问题开始的地方！地址有不同的格式，我有“正常”编号的地址和在其他地方排序的“角落”地址，但这个地址在 900 someroad 没有 4 让我难过。额外的 / 搞砸了我的表情......救命！:)

在我的表达中，我使用第一个斜杠作为第一个十字路口，但在第二种情况下，第一个 / 现在是地址的一部分......以下是我到目前为止的内容：

```
function get_string_between2($string, $start, $end){
    $string = " ".$string;
    $ini = strpos($string,$start);
    if ($ini == 0) return "";
    $ini += strlen($start);
    $len = strpos($string,$end,$ini) - $ini;
    return substr($string,$ini,$len);
}

$fullstring = "$rawPage";

if ( strpos($fullstring, ' STRUC1 ')!== false )
{
$parsed = get_string_between2($fullstring, "STRUC1", "/");
}
$input = "$parsed";
preg_match('/([^0-9]+)(.*)/', $input, $matches);

$jobdet = "$matches[1]";

$jobadd = "$matches[2]"; 
```

现在这适用于最上面的消息，我得到了这个结果：

```
$jobdet =  SMELL OF SMOKE AND ALARM OPERATING

$jobadd =  900 SOME ROAD SOMESUBURB

$firstcrossstreet = /CROSSSTREET1 RD 

$secondcrossstreet = //CROSSSTREET2 AV 
```

对于第二条消息，结果完全错误：

```
$jobdet =  SMELL OF SMOKE AND ALARM OPERATING

$jobadd =  4 

$firstcrossstreet = / 900 SOME ROAD SOMESUBURB /CROSSSTREET1 RD 

$secondcrossstreet = //CROSSSTREET2 AV 
```

我知道它是 / 导致它，但我怎样才能制作一个处理这两种情况的表达式？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-01T01:17:15.603

对于正则表达式，您必须***转义***正斜杠，因为它们用作表达式的一部分。一个典型的表达式如下所示：

*/表达式/修饰符*

表达式是您的正则表达式，修饰符会更改执行和结果类型。例如：

```
/<[^>]+>/g 
```

这应该返回字符串中的所有 HTML 标记。正则表达式是 <[^>]+> 并且它位于两个正斜杠之间。因此，您转义正斜杠 - / - 以实现文字字符串正斜杠。

# vim - 如何使用 gvim 命令历史？

> ID：10392366
> 
> 赞同：2
> 
> 时间：2012-05-01T01:03:53.137
> 
> 标签：vim

当我关闭 gvim 时，我无法按向上箭头重新运行上次 vim 会话中的命令。我怎样才能做到这一点？

例如，我可以输入：

```
:set hls<CR>
:set<up arrow> 
```

我看到了：

```
:set hls 
```

但是当我关闭 vim 时，输入

```
:set<up arrow> 
```

没有显示我最后一次使用 set 命令。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2014-01-30T02:12:54.593

新安装 Xubuntu 13.10 后，我没有命令历史记录。但我注意到我的主文件夹中的 .viminfo 文件归 root 所有。将文件的所有者和组更改为我的普通用户解决了这个问题。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-22T15:01:36.427

You coud try ''set history=[number]'' in .vimrc Here is my configuration:

```
set history=50
set viminfo=%,'20,/100,:100,<500,f1,n~/.vim/viminfo 
```

History is persistent now even when you close and reopen vim.

# javascript - 打印文档中的第一个链接

> ID：10392369
> 
> 赞同：1
> 
> 时间：2012-05-01T01:03:59.650
> 
> 标签：javascript, html

我想用 JavaScript 打印页面中的第一个链接。但是当我使用以下代码时，它不起作用：

```
<html>
    <head><title></title></head>
    <body>
        <a id="mylink" href="http://google.com">Google</a><br />
        <script>            
            a=$('mylink').href;
            document.write(document.links[0]);                  
        </script>
    </body>
</html> 
```

然后我把代码“ ”注释掉了`a=$('mylink').href`，突然就可以了，为什么？变量为什么`a`对下一个语句有影响？

任何答案表示赞赏。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-01T01:09:24.473

有几种可能：

1.  该对象`$`未定义并导致 JavaScript 错误阻止您执行第二条语句
2.  `$`对象不知道如何处理传入的字符串和错误
3.  from 返回的值`$`没有没有`undefined`属性的值（即 - 它返回）`href`，导致 JavaScript 错误

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-01T01:16:03.017

该代码不起作用，因为在您的示例中 $ 对象不存在并且会导致错误。似乎您正在尝试使用像 jQuery ($ object) 这样的 JavaScript 框架，但您忘记包含它。

尝试添加以下脚本标签：

```
<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js"></script> 
```

如果您想使用 jQuery，您还应该通过 .attr("attrname") 函数访问属性。例如

```
var a = $('#mylink').attr('href'); 
```

同样，如果您想使用 jQuery，您必须将选择器从“mylink”更改为“#mylink”，以指定您正在搜索 id 为“mylink”的元素。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-01T01:14:10.483

我对您要做什么感到有些困惑，但是您不能只用 js 编写整个链接吗？前任：

```
<script>
<!--
document.write('<a href="http://google.com">Google</a>');
-->
</script>
<noscript>
<a href="http://google.com">Google</a>
</noscript> 
```

脚本中的注释标记将被忽略，并且仅存在于不支持 javacript 的浏览器中，因此不会在文档中打印它。因此`<noscript>`不支持 javascript 的浏览器具有替代内容。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-01T01:14:51.620

它不起作用，因为`a=$('mylink').href`无法执行并停止执行以下代码。代码`document.write(document.links[0])`是正确的。当您在没有先前错误行的情况下调用它时，它就可以工作。

我认为在第一行中您正在尝试使用 jQuery 库。如果你想这样做，你需要使用`<script>`标签包含 jQuery 库，然后使用以下代码：

```
document.write($('a:first').attr("href")); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-05-01T02:37:49.577

只需删除 jQuery 的东西，你不需要它。正如您已经发现的那样，有一个[document.links](http://www.w3.org/TR/DOM-Level-2-HTML/html.html#ID-7068919)集合，因此如果您想打印文档中第一个链接的 herf 值：

```
document.write(document.links[0].href) 
```

你就完成了。

# c# - C# 串行命令移动 Arduino 伺服 X 度？

> ID：10392370
> 
> 赞同：1
> 
> 时间：2012-05-01T01:04:08.597
> 
> 标签：c#, serial-port, arduino

我有一个 Arduino 与伺服（引脚 9、5.5v 和接地）连接，它将在 Arduino 上运行任何 ol' 测试；但是，当我发送串行命令来移动它时，什么也没有发生。rx 灯闪烁，所以我知道 Arduino 正在获取信息。我认为问题在于我的字节转换。

代码时间：

Arduino代码：

```
#include <Servo.h> 

Servo myservo;  // create servo object to control a servo 
                // a maximum of eight servo objects can be created 
void setup() 
{ 
    myservo.attach(9); 
    // attaches the servo on pin 9 to the servo object and sets the rotation to 0
    myservo.write(0); 
} 

int pos1= 0;
int pos2= 0;
int pos3= 0;
int totalMove = 0;

void loop() 
{ 
    if (Serial.available() > 0 && totalMove > 0)
    {
        pos1 = Serial.read() - '0'; 
        // pos2 = Serial.read() - '0'; 
        // pos3 = Serial.read() - '0'; 
        // totalMove = ((pos3) + (pos2*10) + pos1*100);

        myservo.write(pos1);
     }
} 
```

您会看到其他 pos 持有者，因为最终我希望能够发送大于 9 的值，但是现在我只需要让它响应 :)

C#代码：

```
public void moveServo()
{
    if (!serialPort1.IsOpen)
    {
        Console.WriteLine("Oops");
        serialPort1.Open();
        return;
    }

    serialPort1.DtrEnable = true;

    serialPort1.DataReceived += 
        new System.IO.Ports.SerialDataReceivedEventHandler(
            serialPort1_DataReceived);

    serialPort1.Write(new byte[] {57}, 0, 1);
} 
```

有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-01T12:21:58.677

你确定它可以使用其他软件吗？这通常是第一步，即使您必须使用超级终端。这将摆脱任何电缆问题并为您提供正确的参数。

我还推荐来自[SysInternals](http://technet.microsoft.com/en-us/sysinternals/bb896644)的 PortMon 。它允许您在应用程序运行时监控串行端口活动。

确保你设置了所有的串口参数；波特率、数据位、停止位、奇偶校验、握手和读写超时。您还可以设置用于换行符的值。

此外，您可以尝试自己阅读，而不是依赖数据接收事件。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-01T20:48:15.880

你正在发送这个字节

```
serialPort1.Write(new byte[] {57}, 0, 1); 
```

这基本上是字符`'9'`。接收代码是

```
pos1 = Serial.read() - '0'; 
```

这意味着它`pos1`具有价值`9`（注意缺少的`'`）。然后将该值直接写入`Servo`实例。

```
myservo.write(pos1); 
```

将所有部分加在一起：您可以有效地将值 0 到 9 发送到伺服。但是[参考页面](http://arduino.cc/en/Reference/ServoWrite)告诉您，`write`需要 0 到 180 的范围。仅将 0 到 9 发送到伺服器可能只会稍微摆动它。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-07T16:55:13.300

也许是因为你的逻辑水平。

lpt和串口输出为2.5v，有些驱动需要5v来设置和复位。

所以你需要一个像 max232 这样的 ic 将逻辑电平从 2.5v 转换为 5v。

# batch-file - 如何获取包含所有子目录文件的目录中的文件？

> ID：10392372
> 
> 赞同：0
> 
> 时间：2012-05-01T01:04:12.710
> 
> 标签：batch-file, directory, dos

我需要获取目录中的所有文件，包括所有目录中的文件。

我发现[这篇文章](https://stackoverflow.com/questions/180741/how-to-do-something-to-each-file-in-a-directory-with-a-batch-script)获取了目录的所有文件，但它是针对当前级别文件的，不会更深入。

也许已经有一个内置函数可以做到这一点？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-05-01T01:42:12.923

要列出当前目录和子目录中的所有文件，请使用：

```
dir /s 
```

# database - 时间戳如何导致“全局死锁”？

> ID：10392373
> 
> 赞同：8
> 
> 时间：2012-05-01T01:04:18.187
> 
> 标签：database, concurrency, timestamp, distributed-computing

我正在阅读一些关于在分布式数据库中使用时间戳进行并发控制的优点/缺点。我正在阅读的材料提到，尽管时间戳克服了可能影响锁定的传统死锁问题，但仍然存在它容易受到的“全局死锁”问题。

该材料将全局死锁描述为局部图的等待图中不存在循环但全局图中存在循环的情况。

我想知道这怎么会发生？有人可以描述时间戳系统可能导致此问题的情况吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-24T20:37:10.340

这是一个例子，可能是最简单的。我们有机器`A`和`B`. 机器A有锁`T1`且`T2`有关系`T1 < T2`。机器`B`有`T3`和`T4`有`T3 > T4`。

现在，本地图只是 T2 必须等待 T1，T3 必须等待 T4。所以没有局部循环。但是现在，假设我们有`T4 < T1`，所以 T1 必须等待 T4。同时`T2 < T3`，T3 必须等待 T2。在这种情况下，全局存在一个循环。

那么这个循环是如何发生的呢？这里的关键是你永远不会在分布式系统中拥有完整的信息。所以我们稍后可能会知道机器间的依赖关系是存在的。然后我们有一个问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-29T14:50:47.943

时间戳用于确定机器上本地进程之间的冲突解决方案。它提供了一种解决该级别死锁的方法。对于分布式进程，不同机器上的两个进程可能会相互等待。这实际上是一个常规死锁，但跨机器。这称为“全局”死锁。恕我直言，时间戳也可能在那里使用，但显然不切实际。

有关这方面的一些信息可以在[http://www.cse.scu.edu/~jholliday/dd_9_16.htm上找到](http://www.cse.scu.edu/~jholliday/dd_9_16.htm)

# ios - 在 void 函数中使用未声明的标识符“发送者”

> ID：10392381
> 
> 赞同：1
> 
> 时间：2012-05-01T01:05:30.947
> 
> 标签：ios, objective-c, segue

我正在做一个自定义`Segue`，`Storyboard`我有一个包含以下代码的按钮：

```
 [self performSegueWithIdentifier:@"line3" sender:sender]; 
```

通过单击按钮，它工作得很好。我遇到的问题是此代码仅适用于按钮功能，而不适用于 void 功能。我尝试点击按钮，效果很好。当我将它粘贴到一个 void 函数中时，它会给我一个抱怨发件人的错误。我尝试将其更改为无效，但没有任何反应。你能给我一些关于解决这个问题的见解吗？我正在检查 a`UserDefault`并且它与我正在寻找的内容相匹配，然后我想执行此代码：`[self performSegueWithIdentifier:@"line3" sender:sender];`

```
-(IBAction)LoginAttemp:(id)sender{
    [self performSegueWithIdentifier:@"line3" sender:sender];
}

-(void) LoginFailed{
    [self performSegueWithIdentifier:@"line3" sender:sender];
} 
```

**我得到的错误：**

> 使用未声明的标识符“发件人”

有什么见解吗？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-05-01T01:17:04.530

改变

```
[self performSegueWithIdentifier:@"line3" sender:sender]; 
```

到

```
[self performSegueWithIdentifier:@"line3" sender:Nil]; 
```

发件人是：

> 要用于启动 segue 的对象。在实际转场期间，此对象可用于提供信息。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-01T01:20:07.787

`void`不是问题。问题是这`sender`不是保留字。这是您的参数之一`IBAction`：

```
-(IBAction)LoginAttemp:(id)sender{ 
```

看？就在最后。这相当于 Objective-C`IBAction LoginAttemp(id sender)`

如果没有发件人，可以通过`nil`或`self`。使用`self`将是首选。

```
-(void) LoginFailed{

    [self performSegueWithIdentifier:@"line3" sender:self];
} 
```

# .net - 在 VB.net 中实现这样的工具提示？

> ID：10392383
> 
> 赞同：5
> 
> 时间：2012-05-01T01:06:19.510
> 
> 标签：.net, windows, vb.net, winforms, tooltip

当有人输入高于 32767 的副本计数时，我发现在 MS Word 2010 中弹出这个工具提示，我想知道如何（以及是否）可以在 VB.net Windows 窗体应用程序中实现这样的工具提示。

![工具提示屏幕截图 MSWord 2010](../Images/92e8c36e60dd56c3d974075d274d7325.png)

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-05-01T02:44:19.727

内置的 ToolTip 组件创建了一个看起来非常接近的工具提示。将其 IsBalloon 属性设置为 True。*完全*像 Word 一样获取它是不切实际的，该组件不提供任何方法来覆盖 TOOLINFO.uFlags 值，因此您可以指定 TTF_CENTERTIP..

![在此处输入图像描述](../Images/4116afbf5f5c178ac197de603a69cdf7.png)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-01T05:04:34.010

我尝试了气球，但无法预测它的方向。但是，以下代码可能会让您入门……我认为它不是防弹的，因此您可能需要添加更多代码。

我使用了工具菜单中的文本框和工具提示：

```
Private Sub TextBox1_TextChanged(sender As System.Object, e As System.EventArgs) Handles      TextBox1.TextChanged

If Val(TextBox1.Text) > 100 Then
        ToolTip1.Active = True
        ToolTip1.Show("Value is to Large", sender, New Drawing.Point(0, sender.Height - 50))
    Else
        ToolTip1.Active = False
    End If

End Sub 
```

我真的很喜欢这个主意...谢谢！

# sql - 根据另一个表中的键对一个表中的值求和。

> ID：10392384
> 
> 赞同：0
> 
> 时间：2012-05-01T01:06:42.057
> 
> 标签：sql, sql-update

有两张桌子。首先是基于“play”，并有一个基于其他标准的 0 和 1 列。第二个表是基于组的戏剧（系列）。我想将正确播放值列的总和添加到第二个表中的右键。

```
TABLE 1
Gamekey. Series. Playid. Value. 
111\.       1\.      1\.      0
111\.       1\.      2\.      1
111\.       1\.      3\.      1
111\.       2\.      1\.      0
111\.       3\.      1\.      1
111\.       3\.      2\.      0
112\.       1\.      1\.      0
112\.       2\.      1\.      1

TABLE 2
Gamekey.  Series.  Sum of value <-- column I need
111\.        1\.          2
111\.        2\.          0
111\.        3\.          1
112\.        1\.          0
112\.        2\.          1 
```

仅供参考 - 系列总是从 1 开始并增加 1。系列的最大数值因游戏而异。Gamekey 并不总是连续的。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-01T01:16:39.537

很难真正解析您要查找的内容，但看起来您可能想要，

```
SELECT GameKey, Series, Sum(Value) AS SumOfValue FROM Table1 GROUP BY GameKey, Series 
```

# javascript - RichCommandButton 的 ClientListener

> ID：10392388
> 
> 赞同：0
> 
> 时间：2012-05-01T01:07:35.397
> 
> 标签：javascript, dom-events, mouseover, oracle-adf, jdeveloper

`RichCommandButton`当鼠标以编程方式悬停在 a 上时，我需要调用一个方法。

```
private UIComponent ImageButton(UIComponent parent){
    RichCommandButton img = new RichCommandButton();
    String imagestyle = "width:120pt; height:120.0pt;margin:10.0pt;";
    img.setInlineStyle(imagestyle);
    ClientListenerSet set = img.getClientListeners();
    if (set == null) {
               set = new ClientListenerSet();
            }
    set.addListener("click", "handle");
    img.setClientListeners(set);
    parent.getChildren().add(img);
    AdfFacesContext adfFacesContext = AdfFacesContext.getCurrentInstance();
    adfFacesContext.addPartialTarget(parent);
    return img;  
} 
```

在我的 JSPX 页面中，

```
 <f:facet name="metaContainer">
    <af:resource type="javascript">
        function handle(evt){  
            var source = evt.getSource();
            AdfLogger.LOGGER.logMessage(AdfLogger.SEVERE, 'gangangan');
            evt.cancel();
        }
    </af:resource>
    </f:facet> 
```

它永远不会进入此功能（在 Chrome->Inspect 元素上的控制台中检查日志消息）。请让我知道如何调用方法`mouseOver`。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-01T18:37:13.220

我认为您应该将客户端侦听器添加到 mouseOver 事件而不是单击：

```
set.addListener("mouseOver", "handle"); 
```

[您可以在此页面](http://docs.oracle.com/cd/E15051_01/apirefs.1111/e12419/tagdoc/af_clientListener.html)中查看其余可用的客户端事件。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-26T21:08:01.377

你`img.setClientComponent(true)`在你的方法中使用吗？如果你的 JavaScript 需要这个组件，那么它也需要出现在客户端。

# recursion - 如何递归序言中的单个列表？

> ID：10392392
> 
> 赞同：1
> 
> 时间：2012-05-01T01:09:20.443
> 
> 标签：recursion, prolog

我正在阅读教程，我发现很难理解如何递归单个列表。有人可以快速解释一下基本情况必须是什么，为什么，以及在递归中要做什么。我的代码是：

```
type(string).

type(int).

instance(X,Y):- X, Y.

variable(_).

statement([]).

statement(A|B):- A, statement(B). 
```

代码的目的是制作一个轻型类型检查器来检查如下内容：

```
String s; int i; i = s.length(); 
```

我将其作为测试通过：

```
statement([instance(type(string), variable(s))]). 
```

我决定把它放在一个列表中并递归它，然后把它放在 if 之后。如果它符合其中一条规则，那就是真的。目前我只是确保我可以让类型实例化工作。欢迎任何帮助！提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-01T02:19:56.087

您缺少一对方括号

```
statement(A|B) 
```

它应该是

```
statement([A|B]) 
```

递归规则的其余部分看起来不错。

# iphone - iPhone SpeakHere 1 个通道上的示例录音

> ID：10392393
> 
> 赞同：0
> 
> 时间：2012-05-01T01:09:21.647
> 
> 标签：iphone, ios, audio

SpeakHere 编译良好，但仅显示和使用单个 (1) 通道来记录输入。iPhone 4 是单通道麦克风而不使用两个通道有限制吗？我似乎看不到它将用两个通道记录在哪里。有人有什么建议吗？这是音频编程概念的一个很好的例子，但需要一些帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-01T11:33:51.070

尝试检查发布的其他与 speakhere 相关的问题，有很多与您所问的问题相关的问题。检查以下问题的答案部分：- [如何修改 SpeakHere 示例应用程序以在 iPhone 上以单声道格式录制？](https://stackoverflow.com/questions/5255846/how-can-i-modify-the-speakhere-sample-app-to-record-in-mono-format-on-iphone)

# java - 在 java 中绘制密集的 3D 点云（或网格）

> ID：10392394
> 
> 赞同：1
> 
> 时间：2012-05-01T01:09:21.723
> 
> 标签：java, 3d, java-3d, jmonkeyengine

我将编写 java 代码来绘制 3D 点云。有人建议我去使用 java 3D 库，但它显然已经死了[（this reference）](https://stackoverflow.com/questions/555347/3d-scene-graph-library-for-java)，而且使用 JMonkey 也不是一个好主意[（相同的参考）](https://stackoverflow.com/questions/555347/3d-scene-graph-library-for-java)。该链接是在 2009 年发布的，而我们是在 2012 年发布的。我要做的就是绘制一个密集的 3D 点云，比如 500 万个点，并能够实时旋转/或放大它。我知道渲染算法和东西，但是我需要一组具有活跃社区和支持（如果有的话）的 3D java 库。

在建议我解决方案时，请考虑桌面和 Web 应用程序。

非常感谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-01T01:28:38.383

不是场景图，但[LWJGL](http://www.lwjgl.org/wiki/index.php?title=Main_Page#Getting_started)提供了一个简单的 OpenGL 包装器，因此您可以很容易地构建一个[四边形](http://www.lwjgl.org/wiki/index.php?title=LWJGL_Basics_3_%28The_Quad%29)列表来表示您的点并设置/修改视图以根据用户输入显示和旋转它们。

这应该在小程序中也可以覆盖您的网络目标。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-01T04:44:03.443

> 和 JMonkey 一起使用显然不是好主意（相同的参考）

你提到的东西已经有三年多的历史了，就技术而言是古老的。

从那时起，jME 大举回归。jME3 是一个非常稳定的测试版，具有 Android 支持、改进的物理支持（JBullet 和本机包装器）、带有场景编辑器的 SDK、许多用户贡献的插件以及非常活跃的社区。

也有许多成功的游戏使用了它，最著名的是 Mythruna 和 3079。

您想要做的事情在 jME 中很容易完成，我们邀请您过来尝试一下。 [http://jmonkeyengine.org](http://jmonkeyengine.org)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-01T07:50:24.780

[jzy3d](http://code.google.com/p/jzy3d/ "jzy3d") 是您正在寻找的。

> Jzy3d 是一个开源 (BSD) java 库，它允许快速显示 3d 科学数据、曲面、散点图、条形图和许多其他 3d 基元。API 支持丰富的交互式图表，包括颜色条、工具提示和覆盖。轴和图表布局可以完全自定义和增强。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2017-08-10T21:57:02.207

我会为此使用JavaFX。它已经包含在 JDK 8 中，并且该项目运行良好。

与 LWJGL 相反，有更多更好的文档。此外，LWJGL 作为一个瘦包装器，将迫使您在需要进行任何转换时立即学习 OpenGL，这将花费您一些时间。

Jzy3d 是更高级别的 API，但教程不是免费的。

JME3 太过分了，只要我有限的经验教会了我，你就需要使用 Blender 来创建模型（我可能错了）。

网上有很多关于 JavaFX 的文档。如果您不介意买一本书，“JavaFX for Dummies”虽然很基础，但还是相当不错的。

# sql - Hibernate 4.1.2.FINAL 属性 hbm2ddl.import_files 似乎不起作用

> ID：10392397
> 
> 赞同：1
> 
> 时间：2012-05-01T01:09:50.210
> 
> 标签：sql, spring, hibernate, jboss

嗨，我有一个关于 hbm2ddl.import_files 的问题，它似乎不起作用并且似乎没有出现在日志中。这是我的配置：

```
<property name="hibernateProperties">
        <value>
            hibernate.dialect=${hibernate.dialect}
            hibernate.default_schema=${hibernate.default_schema}
            hibernate.jdbc.batch_size=${hibernate.jdbc.batch_size}
            hibernate.show_sql=${hibernate.show_sql}
            hibernate.hbm2ddl.auto=${hibernate.hbm2ddl.auto}
            hibernate.id.new_generator_mappings=${hibernate.id.new_generator_mappings}
            hibernate.hbm2ddl.import_files=${hibernate.hbm2ddl.import_files}
            <!-- Auto Generated Schemas and tables not good for production
            hibernate.hbm2ddl.auto=update-->
         </value>
    </property> 
```

hibernate.hbm2ddl.import_files=/import.sql，文件为：

```
insert into DEPARTAMENTO (NOMBRE_DEPART,REFERENCIA_DEPART) values ('AMAZONAS') 
```

jdbc.properties：

```
#org.hibernate.dialect.PostgreSQLDialect
hibernate.default_schema = "DBMERCANCIAS"
hibernate.show_sql = true
hibernate.id.new_generator_mappings = true
hibernate.hbm2ddl.auto = create
hibernate.jdbc.batch_size = 5
#Default the factory to use to instantiate transactions     org.transaction.JDBCTransactionFactory
hibernate.transaction.factory_class=org.transaction.JDBCTransactionFactory
#Initialize values statements only on create-drop or create
hibernate.hbm2ddl.import_files = /import.sql 
```

数据库是postgresql 9.1.1，spring 3.1.0.RELEASE和hibernate 4.1.2.Final，hibernate.hbm2ddl.auto设置为“create”，表和schema创建但不运行sql命令插入为什么？，我可以在运行此命令的日志中看到。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-13T01:58:29.483

我的错误是休眠属性中的位置。

```
hibernate.hbm2ddl.import_files = /META-INF/spring/import.sql 
```

是正确的位置。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-07-14T13:31:28.820

您可以从休眠配置/属性`import.sql`中放入`classpath(/classes/import.sql)`和删除属性。`hibernate.hbm2ddl.import_files`

**注意：** hibernate.hbm2ddl.auto 必须创建

```
<bean id="sessionFactory"
    class="org.springframework.orm.hibernate4.LocalSessionFactoryBean">
    <property name="dataSource" ref="dataSource" />
    <property name="hibernateProperties">
        <props>
            <prop key="hibernate.dialect">${hibernate.dialect}</prop>
            <prop key="hibernate.show_sql">${hibernate.show_sql}</prop>
            <prop key="hibernate.hbm2ddl.auto">create</prop>
    </property>
</bean> 
```

# jquery - InsertionMode.Replace 如何在 Ajax.BeginForm 上工作

> ID：10392398
> 
> 赞同：4
> 
> 时间：2012-05-01T01:10:10.600
> 
> 标签：jquery, asp.net-mvc-3, ajax.beginform

我的 asp.net mvc 视图中有以下内容`Ajax.beginform`，其中 ajax 调用的结果将替换 `<div id= "searcharea">`，如下所示：-

```
@using (Ajax.BeginForm("Search", "Patient",
    new AjaxOptions
{
    HttpMethod = "GET",
    InsertionMode = InsertionMode.Replace,
    UpdateTargetId = "searcharea",
    LoadingElementId = "progress2"
}))
{
   <table >

 <tr>

        <th>
         Searching By First Name (English) :-
        </th>
        <th>
          <input type="text" name="firstname"  />
        </th></tr>
      <tr>

        <th>
         Searching By Family Name (English) :-
        </th>
        <th>
          <input type="text" name="familyname"  />
        </th></tr>

      <input type="submit" value="Search      " /></th><th></th></tr>
  </table>

}

<div id = "progress2">
<img src= "@Url.Content("~/Content/images/Ajax-loader-bar.gif") ">
</div>
<p>
<div id= "searcharea">
</div> 
```

所以一开始我虽然我只能执行一次搜索，因为`<div id= "searcharea">`它将被 ajax 调用的结果替换，之后它不会是 avilalbe，如果我尝试做另一个 ajax 调用，将不会更多`<div id= "searcharea">`替换结果。

但实际发生的是，我能够毫无问题地进行多次搜索，这是否意味着`InsertionMode.Replace`不会替换 DOM 元素，它只会在这个 DOM 中插入 ajax 调用的结果，**因为我可以不明白我怎么能多次引用一个 DOM 元素，即使它已经被我的第一个 ajax 调用替换了**？？？！！谁能解释这是怎么发生的？BR

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-05-01T03:12:56.143

你误会了`InsertionMode.Replace`。它将替换您指定的 HTML 元素中的所有**内容**`UpdateTargetId`，而不是元素本身。

这是一样的

```
$("#searcharea").html(newHTMLcontent); 
```

由于您提到的原因，破坏它所使用的元素的插入模式不会很有用：您只能使用它一次。

# php - 不是唯一的表/别名：“类别”。

> ID：10392399
> 
> 赞同：1
> 
> 时间：2012-05-01T01:10:36.503
> 
> 标签：php, mysql, sql

我有这个 mysql 代码，可以通过它们在数据库中出现的次数来检索每个类别中最流行的描述 -

它抓取了列表，但它会像这样回显数据

```
"Adidas was the most popular in category 5 with 1 occurrences" 
```

我的这个兴趣（爱好）的表结构是

```
 # interests
 CREATE TABLE `interests` (
 `interestID` int(11) NOT NULL AUTO_INCREMENT,
 `name` varchar(100) NOT NULL,
 `categoryID` int(11) NOT NULL,
 `sessionID` int(11) NOT NULL,
 `interest_desc` varchar(30) NOT NULL,
 `timestamp` timestamp NOT NULL DEFAULT CURRENT_TIMESTAMP,
 PRIMARY KEY (`interestID`)
) ENGINE=MyISAM AUTO_INCREMENT=9 DEFAULT CHARSET=utf8   

# categories
CREATE TABLE `categories` (
 `categoryID` int(11) NOT NULL AUTO_INCREMENT,
 `category_desc` varchar(100) NOT NULL,
 PRIMARY KEY (`categoryID`)
) ENGINE=MyISAM AUTO_INCREMENT=2 DEFAULT CHARSET=utf8 
```

这是我的 SQL 命令：

```
SELECT 
   interest_desc, 
   categoryID, 
   MAX(num_in_cat) AS num_in_cat,
   category_name
FROM
(
   SELECT interest_desc, categoryID, COUNT(categoryID) AS num_in_cat
   FROM interests
   GROUP BY interest_desc, categoryID
) subsel
JOIN categories ON subsel.categoryID = categories.ID 
GROUP BY interest_desc, categoryID, category_name 
```

我收到此错误：

> 不是唯一的表/别名：“类别”

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-01T01:32:26.073

对您的`categories`表进行内部连接（您提供正确的表名和列名）是完成此操作所需的全部内容：

```
SELECT 
  interest_desc, 
  categoryID, 
  MAX(num_in_cat) AS num_in_cat,
  category_name
FROM
(
   SELECT interest_desc, categoryID, COUNT(categoryID) AS num_in_cat
   FROM interests
   GROUP BY interest_desc, categoryID
) subsel
JOIN categories ON subsel.categoryID = categories.ID 
GROUP BY interest_desc, categoryID, category_name 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-01T01:32:11.860

试试这些：

1.  如果可行，则更佳，加入

    `SELECT s.interest_desc, c.name, MAX(s.num_in_cat) AS num_in_cat FROM ( SELECT interest_desc, categoryID, COUNT(categoryID) AS num_in_cat FROM interests GROUP BY interest_desc, categoryID ) s INNER JOIN categories c ON c.ID = s.categoryID GROUP BY s.interest_desc, s.categoryID`

    或者

2.  添加另一个选择作为列的最佳选择

    `SELECT s.interest_desc, (SELECT name from categories c WHERE c.ID = s.categoryID), MAX(s.num_in_cat) AS num_in_cat FROM ( SELECT interest_desc, categoryID, COUNT(categoryID) AS num_in_cat FROM interests GROUP BY interest_desc, categoryID ) s GROUP BY s.interest_desc, s.categoryID`

# backup - SkyDrive 备份问题

> ID：10392401
> 
> 赞同：2
> 
> 时间：2012-05-01T01:11:04.037
> 
> 标签：backup, cloud, sync, onedrive

我已经设置了一个 SkyDrive 帐户用作异地备份，所以当我完成一天的工作后，我将更改的文件（例如从 c:\myfiles）复制到我的 SkyDrive 文件夹（映射到 S:），然后将文件与“云”版本同步。我从不直接在 S: 中修改文件。

问题： 1\. 更新 SkyDrive 文件夹中的文件时，同步是重新发送整个文件，还是只发送文件的更改部分（即是完整更新还是增量更新？） 2\. 当我看到文件时在 Windows 资源管理器中作为 S:\ 的 SkyDrive 文件夹中，它们是原始文件的副本（例如，从 c:\myfiles 复制）还是只是对原始文件的引用以与“云”版本同步？

任何帮助，将不胜感激。

艾伦·哈里斯-里德

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-07T12:38:19.973

这可能是因为驱动器 S: 上的文件是重复的。至少这是我的经验。

# ruby - 如何在 RSpec mocked_model 中正确包含和测试 ActiveSupport::Concern？

> ID：10392403
> 
> 赞同：2
> 
> 时间：2012-05-01T01:11:17.503
> 
> 标签：ruby, activerecord, rspec, mocking

我试图通过将模块包含在基本的 mock_model 对象中来指定模块。但是，当我调用模块中定义的实例方法时，ActiveRecord 会尝试与数据库建立连接。

模块：

```
module Stuff
    module SoftDelete
        extend ActiveSupport::Concern

        def soft_delete
            puts "Called here"
        end
    end
end 
```

规格：

```
describe Stuff::SoftDelete do
    class Network < ActiveRecord::Base
        include Stuff::SoftDelete
        attr_accessor :deleted_at
    end

    before (:each) do
        @network = mock_model(Network)
    end

    context "When a record is deleted" do
        it "is marked as deleted" do
            @network.soft_delete
        end
    end
end 
```

当我运行此规范时，会发生以下错误：

```
 1) Stuff::SoftDelete When a record is deleted is marked as deleted
     Failure/Error: @network.soft_delete
     ActiveRecord::ConnectionNotEstablished:
       ActiveRecord::ConnectionNotEstablished
     # ./spec/apoc/soft_delete_spec.rb:18:in `block (3 levels) in <top (required)>' 
```

**注意**：如果我在真正的 ActiveRecord 类中包含 SoftDelete 模块，它将起作用。似乎 mock_model 无法处理该模块。

希望对此有所帮助。谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-01T03:53:03.973

你信任 ActiveRecord 吗？如果是这样，请不要继承它；单独测试你的模块。如果您的模块包含调用 ActiveRecord 方法，请将它们存根并仅测试您的代码。

# c++ - 在字符（以及字符）之后删除所有内容

> ID：10392405
> 
> 赞同：12
> 
> 时间：2012-05-01T01:11:29.083
> 
> 标签：c++, string, visual-c++, std

我有一个这样的字符串：

```
std::string string1 = "xjdfhfakdjs%54k34k.-jk34"; 
```

我只需要得到“”xjdfhfakdjs”，但字符串是动态的，不是硬编码的，所以我不知道它是什么，长度等等，所以我想删除%之后的所有内容，还有%字符。

**我怎么能这样做？**

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2012-05-01T01:18:15.197

```
std::string the_prefix_you_want = string1.substr(0, string1.find("%")); 
```

有关详细信息，请参阅：[http](http://www.cplusplus.com/reference/string/string/find/) ://www.cplusplus.com/reference/string/string/find/和[http://www.cplusplus.com/reference/string/string/substr/](http://www.cplusplus.com/reference/string/string/substr/)

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2012-05-01T01:19:17.803

我相信这会奏效。

```
std::string mystr = string1.substr(0, string1.find("%", 0)); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-02-20T06:29:59.210

做了一个类似 C 的东西，它以当前的形式工作，但肯定比上面显示的方法更笨重：

```
#include <windows.h>
void main ()
{
    int i;
    wchar_t searchString[100];
    wchar_t * stringReturn;
    memset(searchString, L'\0', sizeof(stringReturn));
    wcscpy_s(searchString, 100, L"String\\ to search");
    stringReturn = wcschr (searchString, '\\');
    if (stringReturn)
    {
        for (i = 0; i < (int)(stringReturn - searchString); i++) stringReturn[i] = searchString[i];
        stringReturn[i] = L'\0';
        wcscpy_s(searchString, 100, stringReturn);
    }
} 
```

可以轻松修改以适用于动态字符串。

# backbone.js - 如何更改 Backbone.js 应用程序中 localStorage 中的数据顺序？

> ID：10392406
> 
> 赞同：1
> 
> 时间：2012-05-01T01:11:35.693
> 
> 标签：backbone.js, local-storage

我现在正在制作一个 Backbone 应用程序并使用一个backbone.localstorage 插件来保存数据。我的应用程序有一些可排序的项目，所以我希望每次对项目进行排序时，localStorage 中的数据顺序也会发生变化。并且下次我刷新整个页面时，页面将由排序后的数据呈现。但似乎主干.localstorage 将按其创建顺序保存数据。有人可以给我一些想法吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-01T01:49:52.663

如果您希望您的模型以明确的顺序出现，则[`comparator`](http://backbonejs.org/#Collection-comparator)在您的集合中包含 a ，并且可能在每个模型中包含一个位置编号。

[本地存储是](https://developer.mozilla.org/en-US/docs/Web/Guide/API/DOM/Storage)：

> 一种可以安全地存储字符串键/值对并在以后检索以供使用的方法。

请注意*键/值对*，这意味着您正在处理或多或少的大哈希表，而这些哈希表通常是无序的。此外，从[精细规范](http://dev.w3.org/html5/webstorage/#the-storage-interface)：

> 键的顺序是用户代理定义的，但必须在对象内保持一致，只要键的数量不变。（因此，添加或删除键可能会更改键的顺序，但不能仅更改现有键的值。）

因此本地存储内部没有特定的顺序。如果你想要一个特定的订单，你必须自己安排。

在您的情况下，您的模型中可能有一个`position`or`index`属性，其行为类似于数组索引；然后，在您的收藏中：

```
comparator: function(m) { return m.get('position') } // or 'index' 
```

您还可以使用两个参数`comparator`函数：

```
comparator: function(a, b) {
    a = a.get('position');
    b = b.get('position');
    if(a < b)
        return -1;
    else if(a > b)
        return 1;
    return 0;
} 
```

当您移动模型时，您必须维护位置索引，但这应该不是非常困难。您还可以在将数据`position`从本地存储中拉出之后但在将其放入您的集合之前对数据进行排序，然后`position`在将模型写入本地存储时分配值。

# android - 在 Android 中向处理程序发送错误

> ID：10392409
> 
> 赞同：1
> 
> 时间：2012-05-01T01:11:49.160
> 
> 标签：android, runnable

我已经编写了一些代码来执行 httpGet，然后将 JSON 返回到主线程。有时虽然服务器已关闭，我想向主线程报告服务器已关闭但不知道如何使用处理程序正确执行此操作。

我的代码如下所示：

```
public class httpGet implements Runnable {

    private final Handler replyTo;
    private final String url;

    public httpGet(Handler replyTo, String url, String path, String params) {
        this.replyTo = replyTo;
        this.url = url;
    }

    @Override
    public void run() {
         try {
             // do http stuff //
         } catch (ClientProtocolException e) {
            Log.e("Uh oh", e);
            //how can I report back with the handler about the 
            //error so I can update the UI 
         }
    }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-01T01:15:59.100

向处理程序发送一条消息，带有一些错误代码，例如：

```
Message msg = new Message();
Bundle data = new Bundle();
data.putString("Error", e.toString());
msg.setData(data);
replyTo.sendMessage(msg); 
```

在处理程序的`handleMessage`实现中处理此消息。

处理程序应如下所示：

```
Handler handler = new Handler() {
     @Override
     public void handleMessage(Message msg) {
         Bundle data = msg.getData();
         if (data != null) {
              String error = data.getString("Error");
              if (error != null) {
                  // do what you want with it
              }
         }
     }
}; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-01T01:42:07.767

```
@Override
public void run() {
     try {
         // do http stuff //
     } catch (ClientProtocolException e) {
        Log.e("Uh oh", e);
        //how can I report back with the handler about the 
        //error so I can update the UI 
        // you can use handleMessage(Message msg)
        handler.sendEmptyMessage(-1) <-- sample parameter
     }
} 
```

从此处获取 Runnable 的消息，

```
Handler handler = new Handler() {
     public void handleMessage(Message msg) {
        if(msg.what == -1) {
             // report here
        }
     }
}; 
```

除了处理程序，您还可以使用 runOnUiThread，

```
@Override
public void run() {
     try {
         // do http stuff //
     } catch (ClientProtocolException e) {
        Log.e("Uh oh", e);
        //how can I report back with the handler about the 
        //error so I can update the UI 
        runOnUiThread(new Runnable() {
        @Override
        public void run() {
             // report here
            }
        }
     }
} 
```

# php - 根据 URI 段重定向

> ID：10392411
> 
> 赞同：1
> 
> 时间：2012-05-01T01:12:17.160
> 
> 标签：php, codeigniter

我正在使用 Codeigniter 并希望拥有对 SEO 友好的 URL。将有 2 种类型的 URI 段，`http://www.domain.com/view/193847`和`http://www.domain.com/view/193847-canon-5d-mark-iii`.

如果使用第一个 URL，`view_mini`则调用函数并传递产品 id `193847`。如果使用第二个，函数`view_full`将被调用并传递相同的产品 id `193847`。

**问题：**如何区分这 2 个 URL？或者这是解决问题的劣等方法？

**PHP** *if 条件应该如何构造？*

```
function view($pid) {
    if($this->uri->segment(2) == something) {
        $this->view_mini($pid);
    } else {
        $this->view_full($pid);
        }
}

function view_mini($pid) {
   // ...
}

function view_full($pid) {
   // ...
} 
```

**编辑**

我正在使用 URL 路由路由`http://www.domain.com/controllername/view/1234`到`http://www.domain.com/view/1234`

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-01T01:19:02.657

## 编辑：未经测试

```
$route["view/(\d+)"] = "class/view_mini/$1";
$route["view/(\d+)-([\w'-]*)?/g"] = "class/view_full/$1/$2"; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-01T01:25:46.673

不同的 URL 是否有明确的结构？

IE。

```
http://www.domain.com/view/[numbers]-[text] 
```

如果是这样，您可以测试数字和破折号之间的破折号的 URL？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-01T09:25:26.237

您可以使用正则表达式检查段是否有除数字以外的任何内容，然后您可以执行所需的视图，例如

```
$pattern = '\d[0-9][^a-zA-Z]';
$url = $this->uri->segment(2);
if(preg_match($pattern,$url))
{
//this will match only the numbers

$this->view_mini($pid);
    } else {
        $this->view_full($pid);
    } 
```

我希望这个能帮上忙 ..

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-01T22:29:34.027

采用

```
$result = explode('-', $this->uri->segment(1));

If(isset($result[1]))
{
    // show full view
} else {

    // show mini view

} 
```

$pid 永远是 $result[0]

# wpf - 在父控件中延迟加载用户控件

> ID：10392413
> 
> 赞同：0
> 
> 时间：2012-05-01T01:12:26.527
> 
> 标签：wpf

我有一些用户控件的场景假设它们是：

1.  创建学生
2.  创建教师

每个用户控件都有自己的视图模型。数据上下文在初始化中设置。

我有一个主 UI，可以在其中加载上述用户控件。所以设置数据上下文工作正常。

**问题陈述** 我有另一个用户控件“CreateClass”，它是选项卡的集合。从这里我可以转到上面的两个用户控件（隐藏选项卡）。

数据上下文由 CreateClassViewModel“CreateStudentManager”和“CreateTeacherManager”中的两个属性设置。

这很好用，但问题是当我默认打开 CreateClass UI 时，其他用户控件也会加载（我猜是因为它们有默认构造函数）。

因为当我打开 CreateClass 时，我不想加载其他控件。这些应该仅在从 Create Class UI 显式调用时加载。

如何做到这一点？

下面是一个“CreateStudent”的示例

```
<TabItem Header="Students" Visibility="{Binding IsStudentVisible, Converter={StaticResource BooleanToVisibilityConverter}}" >
                <Grid>
                    <local:UCCreateStudent DataContext="{Binding CreateStudentManager}"/>
                </Grid>
            </TabItem> 
```

*   吉里哈

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-12-30T09:20:33.920

关于codeproject有一篇很好的文章：http: [//www.codeproject.com/Articles/217022/Delaying-Element-Initialization-for-Collapsed-Cont](http://www.codeproject.com/Articles/217022/Delaying-Element-Initialization-for-Collapsed-Cont)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-01T07:36:13.907

最简单的方法是在代码中完成，即。将 local:UCCreateStudent 项目添加到所需事件触发器的网格中。给网格命名（例如 x:Name="MyGrid"），然后

```
 void OnTrigger(...)
 {
      UCCreateStudent NewStudent = new UCCreateStudent();
      // extra code for setting the datacontext and any other layout properties
      MyGrid.Children.Add(NewStudent);
 } 
```

# php - 每周从 sql 获取新结果

> ID：10392414
> 
> 赞同：1
> 
> 时间：2012-05-01T01:13:44.983
> 
> 标签：php, mysql, random

我有一张表，我想从中选择一行并将其展示给用户。每周我都想让网站自动随机选择另一行。所以，基本上我希望每周而不是每次用户访问页面时都获得新结果。我现在正在使用此代码：

```
$res = mysql_query("SELECT COUNT(*) FROM fruit");
$row = mysql_fetch_array($res);
$offset = rand(0, $row[0]-1);
/* the first three lines to pick a row randomly from the table */
$res = mysql_query("SELECT * FROM fruit LIMIT $offset, 1");
$row = mysql_fetch_assoc($res); 
```

每次用户访问该页面时，此代码都会获得一个新结果，并且每次刷新后都会选择另一个随机行。我想让它每周更新一次，每个用户的结果都是一样的。他们是这样做的php命令吗？如果是这样，它是如何工作的？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-01T01:16:52.280

我的建议如下：

*   存储*随机*结果`id`并且`timestamp`是某种其他类型的持久存储（文件、数据库表等）。
*   *设置一个 cron 作业或其他自动化任务来每周*更新上述记录。如果您无权访问此类解决方案，您可以编写代码在每个页面加载时执行此操作并检查`timestamp`列。然而，这是非常低效的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-01T01:18:10.713

就在这里。使用 php 中的 date 函数并使用 fwrite 将每周和相应的行写入文件。然后，使用 if 语句检查它是否是新的一周，如果它得到一个新的随机行，则将其写入文件并返回，如果不是，则返回该周的相同行。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-01T01:36:48.857

cronjob 是最好的解决方案。创建一个脚本`weeklynumber.php`，就像您已经拥有的一样，它会生成一个条目。在此之后，转到您的控制台，然后使用`crontab -e`.

在这里，您可以添加

```
0 0 * * 0 php /path/to/weeklynumber.php 
```

这意味着在每个星期日的 0:00`php /path/to/weeklynumber.php`执行。

但是所有这些都假设您使用的是 UNIX 并且您可以访问创建 cronjobs。如果没有，这里有另一个解决方案：散列周数和年份，并使用它来生成周数。

```
// Get the current week and year
$week = date('Wy'); 
 // Get the MD5 hash of this
$hash = md5($week);
// Get the amount of records in the table
$count = mysql_result(mysql_query("SELECT COUNT(*) FROM fruit"),0);
// Convert the MD5 hash to an integer
$num = base_convert($hash, 16, 10);
// Use the last 6 digits of the number and take modulus $count
$num = substr($num,-6) % $count; 
```

请注意，只要表中的记录数量没有变化，上述方法才会起作用。

最后，请注意您当前的方法。无需计算行数，从 PHP 获取随机数，并要求您的 DBMS 返回该数字，这一切都可以通过单个查询完成

```
SELECT * FROM fruit ORDER BY RAND() LIMIT 1 
```

# linux - 如何打开顶部带有特定行号的vim？

> ID：10392424
> 
> 赞同：61
> 
> 时间：2012-05-01T01:16:06.740
> 
> 标签：linux, vim, vi

我知道可以使用以下语法让 vim 打开特定行号的文件：

```
vim +500 filename 
```

但是，我希望它在编辑器窗口顶部而不是中间打开指定行。

* * *

## 回答 #1

> 赞同：35
> 
> 时间：2012-05-01T01:19:14.807

您可以`zt`在打开文件后发出问题，例如：`vim +500 filename -c 'normal zt'`.

* * *

## 回答 #2

> 赞同：19
> 
> 时间：2016-01-13T01:44:03.053

作为替代方案（因为我最终在这里搜索它），如果你想要语法`vim <filename>:<linenumber>`，例如`vim test.rb:45`，你可以使用[vim-fetch](https://github.com/kopischke/vim-fetch)和[Vundle](https://github.com/VundleVim/Vundle.vim)：

```
Plugin 'kopischke/vim-fetch' 
```

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2012-05-01T01:19:33.093

这应该这样做：

```
vim +'500|norm! zt' filename 
```

或者你可以开始习惯使用`z``t`(top), `z``z`(center), 和`z``b`(bottom); 就我而言，它是如此自动，我真的不需要额外的调用参数

# postback - 在多视图中跨回发使用视图状态传递值

> ID：10392427
> 
> 赞同：1
> 
> 时间：2012-05-01T01:16:28.270
> 
> 标签：postback, viewstate, multiview

我有一个多视图，里面有 2 个视图。我将粘贴一个示例代码。

```
<asp:MultiView ID="MultiView1" ActiveViewIndex="0" runat="server">
<asp:View ID="View1" runat="server">
    <asp:TextBox ID="TextBox1" runat="server"></asp:TextBox>
    <asp:Button ID="Button1" runat="server" Text="view1" />
    <asp:Label ID="Label2" runat="server" ></asp:Label>
</asp:View>
<asp:View ID="View2" runat="server">
    <asp:TextBox ID="TextBox3" runat="server"></asp:TextBox>
    <asp:Button ID="Button2" runat="server" Text="view2" />
</asp:View>
</asp:MultiView> 
```

我希望 txtbox1 中的值在回发中存在。虽然多视图保持状态，但我执行 response.redirect 以将查询字符串传递给 view2。由于我进行回发，因此我无法在 view2 中使用 txtbox1（在 view1 中）中的值。txtbox1 中的值在回发期间变为空。我尝试了以下代码

```
Public Partial Class viewstatetest
Inherits System.Web.UI.Page

Protected Sub Page_Load(ByVal sender As Object, ByVal e As System.EventArgs) Handles    Me.Load
If (Not Page.IsPostBack()) Then
    MultiView1.ActiveViewIndex = 0
Else
    TypedPassword = TextBox1.Text
    TextBox1.Attributes.Add("value", TypedPassword)
End If
End Sub

Protected Sub Button1_Click(ByVal sender As Object, ByVal e As EventArgs) Handles   Button1.Click
MultiView1.ActiveViewIndex = 1
End Sub

Protected Sub Button2_Click(ByVal sender As Object, ByVal e As EventArgs) Handles    Button2.Click
MultiView1.ActiveViewIndex = 0
Label1.Text = TextBox1.Text
Response.Redirect("viewstatetest.aspx")
End Sub

Public Property TypedPassword() As String
Get
    If (ViewState("TypedPassword") IsNot Nothing) Then
        Return CStr(ViewState("TypedPassword"))
    End If
    Return ""
End Get
Set(ByVal value As String)
     ViewState("TypedPassword") = value
End Set
End Property
End Class 
```

当页面第一次加载时，我在 view1 的 txtbox1 中输入一些内容并单击按钮，view2 被加载，我有一个代码获取 txtbox1 的值并将值写入 view1 中的标签 1。当我做 response.redirect 时，textbox1 变为空，视图也变为空。

为什么视图状态没有价值？

谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-26T21:03:30.247

Asp.Net viewstate 与其他系统（如 Rails、PHP 甚至 Asp.Net MVC）中的普通 get/post 浏览器请求非常不同。

这是您的场景中发生的事情：

1.  用户的浏览器第一次使用 HTTP 进入页面。这不是回发。
2.  用户填写 TextBox1 并单击 Button1。这是回发（HTTP 帖子）。
3.  在服务器上，将加密的隐藏 __VIEWSTATE 变量中的信息解包，并根据请求中的 post 数据与 TextBox1 和 Button1 的新值进行比较。
4.  Asp.Net 识别状态更改并在您的服务器代码中触发事件。这导致活动视图索引更改为 1。
5.  浏览器现在接收显示 View2 的页面。
6.  用户点击 Button2。这是回发（HTTP 帖子）。
7.  服务器执行与将视图状态与发布数据进行比较并触发 Button2 单击事件之前相同的过程。
8.  你的代码现在做了一些不同的事情。当您执行 Response.Redirect 时，服务器不会发回具有新视图状态的页面。您正在发送一个短标题，而隐藏表单变量中没有保留的视图状态信息。重定向强制浏览器立即对指定的 url 执行 HTTP get 操作。这不是 POSTBACK 并且视图状态已丢失。这与步骤 1 中从用户浏览器获取的第一个 HTTP 完全相同。

我希望这有帮助。我认为承认微软已经认识到他们在 Asp.net 中的视图状态模型的缺点是安全的。这使得实现性感的现代 ajax 应用程序变得非常困难，其中浏览器维护大部分应用程序状态并且只想从服务器发出对新数据的小请求。我认为这是放弃 Asp.Net MVC 中的视图状态模型的主要动机之一。

# c - linux用户空间中的非阻塞定时器（C语言）

> ID：10392429
> 
> 赞同：2
> 
> 时间：2012-05-01T01:16:33.273
> 
> 标签：c, timer, sleep, signals, nonblocking

实际上我想实现非阻塞定时器，当定时器到期时，一个处理程序将被调用并会做一些事情（现在它打印数据）。我谷歌并意识到[`timer_create`](http://man7.org/linux/man-pages/man2/timer_create.2.html)，[`timer_settimer`](http://man7.org/linux/man-pages/man2/timer_settime.2.html)是非阻塞计时器。但是我仍然有问题，我必须等待我的计时器到期（`sleep(MAX)`或`while(1) {;}`）。但是，如果我`start_timer`用不同的“到期”时间调用我的方法，它应该相应地工作，不应该阻止其他。例如，在这里我第一次调用计时器，并期望在 5 秒内调用处理程序，但在第二次调用之前应该打印其数据，因为我给出的间隔仅为 1 秒。当然，它的行为也不一样。任何想法？

```
#include <time.h>
#include <stdio.h>
#include <signal.h>
#include <pthread.h>
#include <unistd.h>
#include <errno.h>

typedef struct _data{
    char *name;
}data;

void handler(union sigval val)
{
    data *data_handler = val.sival_ptr;
    printf("Handler entered with value :%s\n", data_handler->name);
}

void mod_timer(timer_t timerid, struct sigevent sig, struct itimerspec in, struct itimerspec out)
{
    printf("mod_timer\n");
    timer_settime(timerid, 0, &in, &out);
    while(1)
        sleep(1);
    //delete the timer.
    timer_delete(timerid);
}

void start_timer(void* val, int interval)
{
    int Ret;
    pthread_attr_t attr;
    pthread_attr_init( &attr );

    struct sched_param parm;
    parm.sched_priority = 255;
    pthread_attr_setschedparam(&attr, &parm);

    struct sigevent sig;
    sig.sigev_notify = SIGEV_THREAD;
    sig.sigev_notify_function = handler;
//    sig.sigev_value.sival_int = val;
    sig.sigev_value.sival_ptr = val;
    sig.sigev_notify_attributes = &attr;

//create a new timer.
    timer_t timerid;
    Ret = timer_create(CLOCK_REALTIME, &sig, &timerid);
    if (Ret == 0)
    {
        struct itimerspec in, out;
        in.it_value.tv_sec = 1;
        in.it_value.tv_nsec = 0;
        in.it_interval.tv_sec = interval;
        in.it_interval.tv_nsec = 0;

       mod_timer(timerid, sig, in, out);
    }
}

void main()
{
//    start_timer(1, 5);
//    start_timer(2, 1);
    data handler_data1 = {"Handler Data 1"};
    data handler_data2 = {"Handler Data 2"};
    void *data1 = &handler_data1;
    void *data2 = &handler_data2;
    start_timer(data1, 5);
    start_timer(data2, 1);
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-10T14:06:29.570

您可以使用该[`alarm`](http://linux.die.net/man/2/alarm)函数生成信号，并使用该[`signal`](http://linux.die.net/man/2/signal)函数指定该信号的处理程序。

# python - python中的排序模式算法

> ID：10392433
> 
> 赞同：-3
> 
> 时间：2012-05-01T01:17:00.220
> 
> 标签：python

我要做的是提示用户输入排序函数类型、排序模式、数组大小、数组增量大小和测试次数。然后我希望它保存它。然而，这个程序有几个问题。

1.  不知何故，当我选择随机模式时，它给了我一些奇怪的答案，例如：

    1543 0.002

    600 0.020

    1400 0.08

它不是真正的顺序。我认为 for 循环有问题。

```
def rand_array(n):
''' returns sorted array of integers of size n'''
    R=[randint(1, 1000*n) for i in xrange(n)]
    return R

def sorted_array(n):
    ''' returns a sorted array of n integers'''
    return [i for i in xrange(1,n+1)]

def rev_array(n):
    '''returns an array of n integers in reverse order'''
    R= [i for i in reversed(xrange(1,n+1))]
    return R

 def sort_timehelp(x,f):
    ''' This times the quick sort algorithm as it must take 3 variables'''
    high=len(x)
    low=0
    t0=clock()
    f(x,low,high)
    t1=clock()
    dt=t1-t0
    return dt

def main():
    myinfo()
    info()
    while True:
        print '==================== to quit enter Control-c=================='
        sortfunction=input("Choose a sort function: ")
        s=input("Choose a pattern: ")
        n=input("Array Size: ")
        increment=input("Increment size: ")
        y=input("Number of tests: ")

        if s == 1:
            x=rand_array(n)
        elif s ==2:
            x= sorted_array(n)
        elif s==3:
            x=rev_array(n)
        if sortfunction==1:
            i=0
            output="algorith: quick sort \n input data: %s" %s
            print output
            while i<y:
                i=i+1
                ff=0.0
                array=x[increment-1:n:increment]
                for my in array:
                    ff+=sort_timehelp(x,quick_sort)
                    output="%d\t %f" %(my, ff)
                    print output

          saving=input("You want to save data ? type 0 to continue or 1 to save " )

          if saving == 0:
              continue
          if saving == 1:
              ask=raw_input("Type the name file: ")
              fileout=open(ask+".csv","w")
              fileout.write(output)
              fileout.close() 
```

第二个问题是，当我尝试保存数据时，它只保存最后一个数据，但我想保存所有内容。

我将不胜感激任何帮助。

编辑：计时函数采用数组和排序算法，我想按增量和相应的计时来保存数字。（这就是我的 for 循环）

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-01T01:30:54.020

您的随机模式实际上是一个随机模式，而不是文档字符串所建议的排序列表。

要保存所有内容，请打开输出文件以进行附加，而不仅仅是写入（正如您所发现的那样，它会覆盖以前的内容）。也就是说，使用“a”而不是“w”。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-01T01:54:42.873

有很多问题。让我们通过它们...

```
def rand_array(n):
''' returns sorted array of integers of size n'''
    R=[randint(1, 1000*n) for i in xrange(n)]
    return R 
```

这不会返回随机数的排序数组。它返回从连续更大的域中选择的随机整数列表。你可能想要：

```
def rand_array(n):
''' returns sorted array of integers of size n'''
    return sorted([randint(1, 1000) for i in xrange(n)]) 
```

* * *

```
def sorted_array(n):
    ''' returns a sorted array of n integers'''
    return [i for i in xrange(1,n+1)] 
```

这应该只是：

```
def sorted_array(n):
    ''' returns a sorted array of n integers'''
    return range(1, n + 1) 
```

* * *

```
def rev_array(n):
    '''returns an array of n integers in reverse order'''
    R= [i for i in reversed(xrange(1,n+1))]
    return R 
```

很简单：

```
def rev_array(n):
    '''returns an array of n integers in reverse order'''
    return reversed(sorted_array(n)) 
```

* * *

```
 i=0
            output="algorith: quick sort \n input data: %s" %s
            print output
            while i<y:
                i=i+1
                ff=0.0
                array=x[increment-1:n:increment]
                for my in array:
                    ff+=sort_timehelp(x,quick_sort)
                    output="%d\t %f" %(my, ff)
                    print output 
```

因此，您排序的次数（在内部循环中）与数组元素的次数一样多？不知道为什么。无论如何，业务`i`应该简单地通过一个`for`循环来完成：

```
 print "algorith: quick sort \n input data: %s" %s
            for i in range(y):
                ff = 0.0
                array = x[increment-1:n:increment]
                for my in array:
                    ff += sort_timehelp(x, quick_sort)
                    output = "%d\t %f" %(my, ff)
                    print output 
```

* * *

```
 saving=input("You want to save data ? type 0 to continue or 1 to save " )

          if saving == 0:
              continue
          if saving == 1:
              ask=raw_input("Type the name file: ")
              fileout=open(ask+".csv","w")
              fileout.write(output)
              fileout.close() 
```

该`if saving==0`子句可以删除；`saving`以外的任何值都`1`将跳过保存。

正如斯科特指出的那样，你想要`"a"`而不是`"w"`in `open`。您可以做的另一件事是将循环移出`open`和`close`移出。您可能还想使用内置的 Python`csv`模块。

# java - Java FileReader 找不到文件

> ID：10392435
> 
> 赞同：-1
> 
> 时间：2012-05-01T01:17:08.983
> 
> 标签：java, filereader

我决定开始一个新问题，以便它可以严格关注 FileReader 错误。

这是一种接受文件名和新文件所需输出名称的方法。假设输入的文件名是“hello.txt”......该方法使其类似于“/home/User/hello.txt”，它作为参数进入 FileReader。问题是我把它作为输出“/home/User/hello.txt（没有这样的文件或目录）”，即使该文件确实存在并且目录结构和权限是正确的。

我无法仅通过引用 .class 和 .java 文件的本地目录中的文件来使用该方法，因此我用谷歌搜索了我的方法，发现绝对指定不是一个坏选择。

任何输入都是有帮助的！

```
public void fileGenerator(String in, String out) {      
try {
    String current_directory = System.getProperty("user.dir");
    Scanner input = new Scanner(new FileReader(current_directory+"/"+in));
    PrintWriter output = new PrintWriter(current_directory+"/"+out);
        while(input.hasNext()) {
        String line = input.nextLine(); 
    output.println(line);
    output.close(); 
    }
  }  catch (Exception e) { System.out.println(e.getMessage()); }
} 
```

这是请求的堆栈跟踪：

```
java.io.FileNotFoundException: /home/User/hello.txt

(No such file or directory)
    at java.io.FileInputStream.open(Native Method)
    at java.io.FileInputStream.<init>(FileInputStream.java:137)
    at java.io.FileInputStream.<init>(FileInputStream.java:96)
    at java.io.FileReader.<init>(FileReader.java:58)
    at TEST.fileGenerator(TEST.java:131)
    at TEST.generateCSV_TWO(TEST.java:122)
    at TEST$4.actionPerformed(TEST.java:102)
    at javax.swing.AbstractButton.fireActionPerformed(AbstractButton.java:2012)
    at javax.swing.AbstractButton$Handler.actionPerformed(AbstractButton.java:2335)
    at javax.swing.DefaultButtonModel.fireActionPerformed(DefaultButtonModel.java:404)
    at javax.swing.DefaultButtonModel.setPressed(DefaultButtonModel.java:259)
    at javax.swing.plaf.basic.BasicButtonListener.mouseReleased(BasicButtonListener.java:253)
    at java.awt.Component.processMouseEvent(Component.java:6203)
    at javax.swing.JComponent.processMouseEvent(JComponent.java:3267)
    at java.awt.Component.processEvent(Component.java:5968)
    at java.awt.Container.processEvent(Container.java:2105)
    at java.awt.Component.dispatchEventImpl(Component.java:4564)
    at java.awt.Container.dispatchEventImpl(Container.java:2163)
    at java.awt.Component.dispatchEvent(Component.java:4390)
    at java.awt.LightweightDispatcher.retargetMouseEvent(Container.java:4461)
    at java.awt.LightweightDispatcher.processMouseEvent(Container.java:4125)
    at java.awt.LightweightDispatcher.dispatchEvent(Container.java:4055)
    at java.awt.Container.dispatchEventImpl(Container.java:2149)
    at java.awt.Window.dispatchEventImpl(Window.java:2478)
    at java.awt.Component.dispatchEvent(Component.java:4390)
    at java.awt.EventQueue.dispatchEventImpl(EventQueue.java:649)
    at java.awt.EventQueue.access$000(EventQueue.java:96)
    at java.awt.EventQueue$1.run(EventQueue.java:608)
    at java.awt.EventQueue$1.run(EventQueue.java:606)
    at java.security.AccessController.doPrivileged(Native Method)
    at java.security.AccessControlContext$1.doIntersectionPrivilege(AccessControlContext.java:105)
    at java.security.AccessControlContext$1.doIntersectionPrivilege(AccessControlContext.java:116)
    at java.awt.EventQueue$2.run(EventQueue.java:622)
    at java.awt.EventQueue$2.run(EventQueue.java:620)
    at java.security.AccessController.doPrivileged(Native Method)
    at java.security.AccessControlContext$1.doIntersectionPrivilege(AccessControlContext.java:105)
    at java.awt.EventQueue.dispatchEvent(EventQueue.java:619)
    at java.awt.EventDispatchThread.pumpOneEventForFilters(EventDispatchThread.java:275)
    at java.awt.EventDispatchThread.pumpEventsForFilter(EventDispatchThread.java:200)
    at java.awt.EventDispatchThread.pumpEventsForHierarchy(EventDispatchThread.java:190)
    at java.awt.EventDispatchThread.pumpEvents(EventDispatchThread.java:185)
    at java.awt.EventDispatchThread.pumpEvents(EventDispatchThread.java:177)
    at java.awt.EventDispatchThread.run(EventDispatchThread.java:138) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-01T01:34:08.387

没有这样的文件或目录通常意味着文件不存在。请编辑代码并使用 IDE 或添加打印语句对其进行调试。此外， current_directory 可以重命名为 currentDirectory 以符合[Java 命名约定](http://www.oracle.com/technetwork/java/javase/documentation/codeconvtoc-136057.html)。尝试运行下面的代码。

```
public static void fileGenerator(String in, String out) {      
try {
    String currentDirectory = System.getProperty("user.dir");
    System.out.println(currentDirectory);
    String inputFileName = currentDirectory+"/"+in;
    File inputFile = new File(inputFileName);
    System.out.println(inputFile.getAbsolutePath());
    FileReader inputFileReader = new FileReader(inputFile);
    Scanner input = new Scanner(inputFileReader);
    PrintWriter output = new PrintWriter(currentDirectory+"/"+out);
    while(input.hasNext()) {
        String line = input.nextLine(); 
    output.println(line);
    output.close(); 
    }
  }  catch (Exception e) { 
      e.printStackTrace();
  }
} 
```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-05-01T01:29:19.980

打印出是什么`current_directory`并确认它符合您的期望。

我还将打印出您传递给的完整文件路径`FileReader`。

大多数时候，这种行为与我的期望不符，我发现我的假设是错误的。

# iphone - 缩进 UIWebview 内容/将滚动条移回屏幕边缘

> ID：10392446
> 
> 赞同：0
> 
> 时间：2012-05-01T01:18:40.673
> 
> 标签：iphone, objective-c, ios, ipad, uiwebview

我有一个 UIWebView 来显示 HTML 中的本地内容。我希望内容在每一侧都缩进，以免触摸屏幕的一侧。问题是内容在 UiWebView 中，所以当我调整 webview 的大小时，滚动条会伸出（见下图）。

![在此处输入图像描述](../Images/3ae525faf2c6684e2e9e7d6ee95a38a9.png)

我无计可施，试图解决这个问题。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-01T02:20:26.830

使 UIWebView 边缘到边缘，然后您可以注入以下 CSS 代码，或将其直接添加到文件中（因为您说它们在应用程序包中）。

```
div.myContent {
    padding-right:50px;
    padding-left:50px;
} 
```

你当然可以改变`div.myContent`任何你想要的。这样，滚动条保持在边缘，但两侧的内容缩进。

# java - Java Thread跟踪中“新”周围的括号？

> ID：10392447
> 
> 赞同：3
> 
> 时间：2012-05-01T01:18:44.903
> 
> 标签：java, syntax

我在线程中开始了一些 Java 编码，并在 Oracle 的教程部分遇到了一行代码，我不明白，我希望这里有人可以为我澄清它为什么起作用：

```
(new Thread(new HelloRunnable())).start(); 
```

在这一行中，声明了一个新线程，但不直接应用于对象，然后立即调用 start 方法来运行该线程。这是如何运作的？为什么 new 关键字在这个括号中起作用？我很想澄清这里发生的事情，谢谢。完整来源来自： [http ://docs.oracle.com/javase/tutorial/essential/concurrency/runthread.html](http://docs.oracle.com/javase/tutorial/essential/concurrency/runthread.html)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-01T01:40:57.650

Thread 实例周围的括号不是必需的。以下将同样有效

```
new Thread(new HelloRunnable()).start(); 
```

如果展开语句，就相当于这段代码

```
Runnable myrunnable = new HelloRunnable();
Thread mythread = new Thread(myrunnable);
mythread.start(); 
```

教程很简洁。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-01T01:37:29.200

此行等效于：

```
// I have put it in block, as you don't have a reference to any of those objects afterwards
{
    // instantiate a runnable
    HelloRunnable runnable = new HelloRunnable(); 
    // instantiate a thread object that will use this runnable
    Thread thread = new Thread(runnable); 
    // start the thread (call the run method of the runnable on a new thread)
    thread.start(); 
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-01T01:25:40.143

这是有效的，因为它是一个有效的陈述。它在 Thread 对象上运行 start() 方法。Thread 对象是作为对象创建的，而不仅仅是声明为引用变量。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-01T01:25:40.480

您需要一个实现`Runnable`传递给 Thread 构造函数的对象实例；电话`new HelloRunnable()`给你。

您需要一个 Thread 对象才能运行；调用`new Thread()`给你。

你调用`start()`那个新`Thread`实例；它调用您提供给其构造函数`run()`的实例上的方法。`Runnable`

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-05-01T01:26:10.340

1.  创建一个新`Thread`对象并`start`在其上调用。
2.  为什么不呢？创建对象是与将对象存储在变量中不同的操作。看看你是如何创造`HelloRunnable`的：你在做同样的事情。

# c# - Using reflection to SetValue on property with private setter

> ID：10392448
> 
> 赞同：2
> 
> 时间：2012-05-01T01:18:55.603
> 
> 标签：c#, reflection

I ran into, what I thought was a bug is actually, a feature detailed in [This post](https://stackoverflow.com/questions/1565734/is-it-possible-to-set-private-property-via-reflection). Can anyone explain to me why this is allowed? It seems like a legacy quirk/bug that became useful.

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-01T01:58:37.393

I'm not sure which part of that you think is a bug, but it has always been possible to access the internals of a class via reflection when you cannot do so at compile time. This is by design. Numerous aspects of the CLR rely on reflection to access fields, such as serialization. The compiled IL needs to be able to access all fields of all objects, or else you couldn't set private fields from *within* your class.

The access modifiers in C# are not a security mechanism. If you are relying on a field being private to prevent anyone from setting it from the outside, you're doing something wrong. They exist to clearly delineate which parts of your class are it's public contract (and thus, in theory, stable) from those parts that are implementation details (and thus can change without notice.)

If you choose to use reflection to change the internal state of an object, despite all indications that you should leave it alone, you are taking the stability of your application into your own hands, and you get what deserve.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-01T01:57:53.597

Reflection is allowed only for Full Trust code, so the code already able to do anything (including directly poking in memory of the process). So having supported way of changing values even for private properties does not make code any less secure. It makes reflection API consistent and allows useful scenarios especially for testing.

# shell - 如何使用 Unix 将重复行添加到文件中

> ID：10392452
> 
> 赞同：0
> 
> 时间：2012-05-01T01:19:17.320
> 
> 标签：shell, unix

我想添加我尝试过但无法获得所需输出的重复行

我使用了 sed 但最终所有行都重复了（下面的代码）

```
sed 'p' Data.txt > Output.txt 
```

我尝试过 awk 但最终所有行都重复了（下面的代码）

```
while read line; do
 commacount=`echo $line|tr ',' '\n'|wc -l`
 atcount=`echo $line|tr '@' '\n'|wc -l`
 echo $commacount,$atcount
if [ "$commacount == '8' && $atcount == '3'" ]; then
{
awk '{print $0}1' Data.txt > tmp
}
else
{
awk '{print $0}' Data.txt > tmp
}
fi

 done < Data.txt 
```

数据.txt

```
2009-09-12T05:18:@00@+10:00,2303,Dump,CAM,1,1,JUNM
2009-09-12T05:24:00+10:00,2009-09-12T05:24:@00@+10:00,2303,Dump,RIV,1,1,JUNM
2009-09-12T05:25:00+10:00,2009-09-12T05:25:@00@+10:00,2303,Dump,WSN,1,1,JUNM
2009-09-12T05:27:00+10:00,2009-09-12T05:27:@00@+10:00,2303,Dump,HWL,1,1,JUNM
2009-09-12T05:29:00+10:00,2009-09-12T05:29:@00@+10:00,2303,Dump,BWD,1,1,JUNM
2009-09-12T05:31:00+10:00,2009-09-12T05:31:@00@+10:00,2303,Dump,ASH,1,1,JUNM
2009-09-12T05:33:00+10:00,,2303,Dump,ALM,1,1,JUNM
2009-09-12T05:00:@00@+10:00,2300,Up,ALM,1,1,JUNM
2009-09-12T05:01:00+10:00,2009-09-12T05:01:@00@+10:00,2300,Up,ASH,1,1,JUNM
2009-09-12T05:04:00+10:00,2009-09-12T05:04:@00@+10:00,2300,Up,BWD,1,1,JUNM
2009-09-12T05:06:00+10:00,2009-09-12T05:06:@00@+10:00,2300,Up,HWL,1,1,JUNM
2009-09-12T05:08:00+10:00,2009-09-12T05:08:@00@+10:00,2300,Up,WSN,1,1,JUNM
2009-09-12T05:10:00+10:00,2009-09-12T05:10:@00@+10:00,2300,Up,RIV,1,1,JUNM
2009-09-12T05:17:00+10:00,,2300,Up,CAM,1,1,JUNM
2009-09-12T09:25:@00@+10:00,2305,Dump,CAM,1,1,JUNM
2009-09-12T09:28:00+10:00,2009-09-12T09:28:@00@+10:00,2305,Dump,RIV,1,1,JUNM
2009-09-12T09:29:00+10:00,2009-09-12T09:29:@00@+10:00,2305,Dump,WSN,1,1,JUNM
2009-09-12T09:31:00+10:00,2009-09-12T09:31:@00@+10:00,2305,Dump,HWL,1,1,JUNM
2009-09-12T09:32:00+10:00,2009-09-12T09:32:@00@+10:00,2305,Dump,BWD,1,1,JUNM
2009-09-12T09:34:00+10:00,2009-09-12T09:34:@00@+10:00,2305,Dump,ASH,1,1,JUNM
2009-09-12T09:41:00+10:00,,2305,Dump,ALM,1,1,JUNM
,2306,Up,ALM,1,1,JUNM
,2306,Up,ASH,1,1,JUNM
,2306,Up,BWD,1,1,JUNM
,2306,Up,HWL,1,1,JUNM
,2306,Up,WSN,1,1,JUNM
,2306,Up,RIV,1,1,JUNM
,2306,Up,CAM,1,1,JUNM
2009-09-12T06:18:@00@+10:00,4505,Dump,CAR,1,1,JUNM
2009-09-12T06:21:00+10:00,2009-09-12T06:21:@00@+10:00,4505,Dump,SEA,1,1,JUNM
2009-09-12T06:24:00+10:00,2009-09-12T06:24:@00@+10:00,4505,Dump,KAN,1,1,JUNM 
```

输出应该是

```
2009-09-12T05:18:@00@+10:00,2303,Dump,CAM,1,1,JUNM
2009-09-12T05:24:00+10:00,2009-09-12T05:24:@00@+10:00,2303,Dump,RIV,1,1,JUNM
2009-09-12T05:24:00+10:00,2009-09-12T05:24:@00@+10:00,2303,Dump,RIV,1,1,JUNM
2009-09-12T05:25:00+10:00,2009-09-12T05:25:@00@+10:00,2303,Dump,WSN,1,1,JUNM
2009-09-12T05:25:00+10:00,2009-09-12T05:25:@00@+10:00,2303,Dump,WSN,1,1,JUNM
2009-09-12T05:27:00+10:00,2009-09-12T05:27:@00@+10:00,2303,Dump,HWL,1,1,JUNM
2009-09-12T05:27:00+10:00,2009-09-12T05:27:@00@+10:00,2303,Dump,HWL,1,1,JUNM
2009-09-12T05:29:00+10:00,2009-09-12T05:29:@00@+10:00,2303,Dump,BWD,1,1,JUNM
2009-09-12T05:29:00+10:00,2009-09-12T05:29:@00@+10:00,2303,Dump,BWD,1,1,JUNM
2009-09-12T05:31:00+10:00,2009-09-12T05:31:@00@+10:00,2303,Dump,ASH,1,1,JUNM
2009-09-12T05:31:00+10:00,2009-09-12T05:31:@00@+10:00,2303,Dump,ASH,1,1,JUNM
2009-09-12T05:33:00+10:00,,2303,Dump,ALM,1,1,JUNM
2009-09-12T05:00:@00@+10:00,2300,Up,ALM,1,1,JUNM
2009-09-12T05:01:00+10:00,2009-09-12T05:01:@00@+10:00,2300,Up,ASH,1,1,JUNM
2009-09-12T05:01:00+10:00,2009-09-12T05:01:@00@+10:00,2300,Up,ASH,1,1,JUNM
2009-09-12T05:04:00+10:00,2009-09-12T05:04:@00@+10:00,2300,Up,BWD,1,1,JUNM
2009-09-12T05:04:00+10:00,2009-09-12T05:04:@00@+10:00,2300,Up,BWD,1,1,JUNM
2009-09-12T05:06:00+10:00,2009-09-12T05:06:@00@+10:00,2300,Up,HWL,1,1,JUNM
2009-09-12T05:06:00+10:00,2009-09-12T05:06:@00@+10:00,2300,Up,HWL,1,1,JUNM
2009-09-12T05:08:00+10:00,2009-09-12T05:08:@00@+10:00,2300,Up,WSN,1,1,JUNM
2009-09-12T05:08:00+10:00,2009-09-12T05:08:@00@+10:00,2300,Up,WSN,1,1,JUNM
2009-09-12T05:10:00+10:00,2009-09-12T05:10:@00@+10:00,2300,Up,RIV,1,1,JUNM
2009-09-12T05:10:00+10:00,2009-09-12T05:10:@00@+10:00,2300,Up,RIV,1,1,JUNM
2009-09-12T05:17:00+10:00,,2300,Up,CAM,1,1,JUNM
2009-09-12T09:25:@00@+10:00,2305,Dump,CAM,1,1,JUNM
2009-09-12T09:28:00+10:00,2009-09-12T09:28:@00@+10:00,2305,Dump,RIV,1,1,JUNM
2009-09-12T09:28:00+10:00,2009-09-12T09:28:@00@+10:00,2305,Dump,RIV,1,1,JUNM
2009-09-12T09:29:00+10:00,2009-09-12T09:29:@00@+10:00,2305,Dump,WSN,1,1,JUNM
2009-09-12T09:29:00+10:00,2009-09-12T09:29:@00@+10:00,2305,Dump,WSN,1,1,JUNM
2009-09-12T09:31:00+10:00,2009-09-12T09:31:@00@+10:00,2305,Dump,HWL,1,1,JUNM
2009-09-12T09:31:00+10:00,2009-09-12T09:31:@00@+10:00,2305,Dump,HWL,1,1,JUNM
2009-09-12T09:32:00+10:00,2009-09-12T09:32:@00@+10:00,2305,Dump,BWD,1,1,JUNM
2009-09-12T09:32:00+10:00,2009-09-12T09:32:@00@+10:00,2305,Dump,BWD,1,1,JUNM
2009-09-12T09:34:00+10:00,2009-09-12T09:34:@00@+10:00,2305,Dump,ASH,1,1,JUNM
2009-09-12T09:34:00+10:00,2009-09-12T09:34:@00@+10:00,2305,Dump,ASH,1,1,JUNM
2009-09-12T09:41:00+10:00,,2305,Dump,ALM,1,1,JUNM
,2306,Up,ALM,1,1,JUNM
,2306,Up,ASH,1,1,JUNM
,2306,Up,BWD,1,1,JUNM
,2306,Up,HWL,1,1,JUNM
,2306,Up,WSN,1,1,JUNM
,2306,Up,RIV,1,1,JUNM
,2306,Up,CAM,1,1,JUNM
2009-09-12T06:18:@00@+10:00,4505,Dump,CAR,1,1,JUNM
2009-09-12T06:21:00+10:00,2009-09-12T06:21:@00@+10:00,4505,Dump,SEA,1,1,JUNM
2009-09-12T06:21:00+10:00,2009-09-12T06:21:@00@+10:00,4505,Dump,SEA,1,1,JUNM
2009-09-12T06:24:00+10:00,2009-09-12T06:24:@00@+10:00,4505,Dump,KAN,1,1,JUNM
2009-09-12T06:24:00+10:00,2009-09-12T06:24:@00@+10:00,4505,Dump,KAN,1,1,JUNM 
```

无论如何我可以获得上述输出。

我感谢任何帮助/建议。

谢谢斯里

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-01T01:22:12.090

你想要有 8 个非空列的重复行吗？

试试这个：

```
awk -F',+' 'NF==8;1' file.txt 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-01T01:21:03.910

这是 sed 版本：

```
 sed '/^[0-9-]\{10\}T[0-9]\{2\}:[0-9]\{2\}:00+10/p' file.txt 
```

# php - PathFinder_Exception 无法使用 setModel 包含模型/模型/

> ID：10392457
> 
> 赞同：0
> 
> 时间：2012-05-01T01:19:58.957
> 
> 标签：php, user-interface, frameworks, atk4

[我正在尝试使用http://agiletoolkit.org/doc/modeltable/reference](http://agiletoolkit.org/doc/modeltable/reference)中给出的示例手动创建从一个模型到另一个模型的引用。我正在使用以下表格和模型：

人表

*   id：主键
*   名称：字符
*   房间号：整数
*   电子邮件：char

用户表

*   id：主键
*   person_id：人表的外键（id）
*   密码：char

ATK4.2类如下：

## 人物模型

```
class Model_Person extends Model_Table {
public $entity_code='person';

function init(){
    parent::init();
    $this->addField('name');
    $this->addField('roomnumber');
    $this->addField('email');
}
} 
```

## 用户模型

# “用户”表包含密码字段。

```
class Model_User extends Model_Table {
public $entity_code='user';

function init(){
    parent::init();

    $field_ref = $this->add('Field_Reference', 'person_id');
    $field_ref->dereferenced_field = 'person_str';
    // add referenced Model
    $m = $this->add('Model_Person');
    $m->addField('name');
    // Link referenced model field name to this model field.
    $field_ref->setModel($m, 'name');

}
} 
```

但是，我收到以下错误，其中 Model_Person 类正在使用错误的路径 Model/Model/Person.php 添加

```
PathFinder_Exception

Unable to include Model/Model/Person.php

Additional information:

    type: php
    attempted_locations: Array ( [0] => /var/www/html/seqtrack/admin/lib/Model/Model/Person.php [1] => /var/www/html/seqtrack/atk4/lib/Model/Model/Person.php [2] => /var/www/html/seqtrack/admin/../lib/Model/Model/Person.php [3] => /var/www/html/seqtrack/atk4/../atk4-addons/mvc/Model/Model/Person.php [4] => /var/www/html/seqtrack/atk4/../atk4-addons/misc/lib/Model/Model/Person.php ) 

/var/www/html/seqtrack/atk4/lib/BaseException.php:38
Stack trace:
/var/www/html/seqtrack/atk4/lib/BaseException.php   :38     PathFinder_Exception    PathFinder_Exception->collectBasicData(Null, 1, 0)
/var/www/html/seqtrack/atk4/lib/PathFinder.php  :213    PathFinder_Exception    PathFinder_Exception->__construct("Unable to include Model/Model/Person.php")
/var/www/html/seqtrack/atk4/lib/PathFinder.php  :131    PathFinder_Exception    PathFinder_Exception->__construct("php", "Model/Model/Person.php", Array(5))
/var/www/html/seqtrack/atk4/lib/PathFinder.php  :195    test_pathfinder PathFinder->locate("php", "Model/Model/Person.php", "path")
/var/www/html/seqtrack/atk4/lib/AbstractObject.php  :159    test_pathfinder PathFinder->loadClass("Model_Model_Person")
/var/www/html/seqtrack/atk4/lib/Field/Reference.php :89     test_mgr_tabs_view_htmlelement_crud_model_user_person_id    Field_Reference->add("Model_Model_Person")
/   :   test_mgr_tabs_view_htmlelement_crud_model_user_person_id    Field_Reference->calculateSubQuery(Object(Model_User), Object(DB_dsql_mysql), Object(Field_Expression))
/var/www/html/seqtrack/atk4/lib/Field/Expression.php    :44         Loggercall_user_func(Array(2), Object(Model_User), Object(DB_dsql_mysql), Object(Field_Expression))
/var/www/html/seqtrack/atk4/lib/Model/Table.php :169    test_mgr_tabs_view_htmlelement_crud_model_user_person_str   Field_Expression->updateSelectQuery(Object(DB_dsql_mysql))
/var/www/html/seqtrack/atk4/lib/Model/Table.php :327    test_mgr_tabs_view_htmlelement_crud_model_user  Model_User->selectQuery()
/var/www/html/seqtrack/atk4/lib/CompleteLister.php  :104    test_mgr_tabs_view_htmlelement_crud_model_user  Model_User->rewind()
/var/www/html/seqtrack/atk4/lib/Grid/Basic.php  :175    test_mgr_tabs_view_htmlelement_crud_grid    Grid->renderRows()
/var/www/html/seqtrack/atk4/lib/CompleteLister.php  :118    test_mgr_tabs_view_htmlelement_crud_grid    Grid->renderRows()
/var/www/html/seqtrack/atk4/lib/Grid/Advanced.php   :152    test_mgr_tabs_view_htmlelement_crud_grid    Grid->render()
/var/www/html/seqtrack/atk4/lib/AbstractView.php    :214    test_mgr_tabs_view_htmlelement_crud_grid    Grid->render()
/var/www/html/seqtrack/atk4/lib/AbstractView.php    :205    test_mgr_tabs_view_htmlelement_crud_grid    Grid->recursiveRender()
/var/www/html/seqtrack/atk4/lib/AbstractView.php    :205    test_mgr_tabs_view_htmlelement_crud CRUD->recursiveRender()
/var/www/html/seqtrack/atk4/lib/AbstractView.php    :205    test_mgr_tabs_view_htmlelement  View_HtmlElement->recursiveRender()
/var/www/html/seqtrack/atk4/lib/AbstractView.php    :205    test_mgr_tabs   Tabs->recursiveRender()
/var/www/html/seqtrack/atk4/lib/AbstractView.php    :205    test_mgr    page_mgr->recursiveRender()
/var/www/html/seqtrack/atk4/lib/ApiWeb.php  :236    test    AdminFrontend->recursiveRender()
/var/www/html/seqtrack/atk4/lib/ApiFrontend.php :123    test    AdminFrontend->execute()
/var/www/html/seqtrack/atk4/lib/ApiWeb.php  :226    test    AdminFrontend->execute()
/var/www/html/seqtrack/admin/index.php  :8  test    AdminFrontend->main() 
```

在 ATK DVD 示例网页上可以看到类似的问题：

[http://example.agiletoolkit.org/examples/dvdrental/](http://example.agiletoolkit.org/examples/dvdrental/)

```
PathFinder_Exception

Unable to include Model/Model/Customer.php

Additional information:

type: php
attempted_locations: Array ( [0] => /www/agiletoolkit.org/example/examples/dvdrental/lib/Model/Model/Customer.php [1] => /www/agiletoolkit.org/example/atk4/lib/Model/Model/Customer.php [2] => /www/agiletoolkit.org/example/atk4/../atk4-addons/mvc/Model/Model/Customer.php [3] => /www/agiletoolkit.org/example/atk4/../atk4-addons/misc/lib/Model/Model/Customer.php ) 

/www/agiletoolkit.org/example/atk4/lib/BaseException.php:38
Stack trace:
/www/agiletoolkit.org/example/atk4/lib/BaseException.php    :38     PathFinder_Exception    PathFinder_Exception->collectBasicData(Null, 1, 0)
/www/agiletoolkit.org/example/atk4/lib/PathFinder.php   :209    PathFinder_Exception    PathFinder_Exception->__construct("Unable to include Model/Model/Customer.php")
/www/agiletoolkit.org/example/atk4/lib/PathFinder.php   :134    PathFinder_Exception    PathFinder_Exception->__construct("php", "Model/Model/Customer.php", Array(4))
/www/agiletoolkit.org/example/atk4/lib/PathFinder.php   :195    Frontend_pathfinder PathFinder->locate("php", "Model/Model/Customer.php", "path")
/www/agiletoolkit.org/example/atk4/lib/AbstractObject.php   :158    Frontend_pathfinder PathFinder->loadClass("Model_Model_Customer")
/www/agiletoolkit.org/example/atk4/lib/AbstractController.php   :26     Frontend    Frontend->add("Model_Model_Customer")
/www/agiletoolkit.org/example/examples/dvdrental/lib/RentalAuth.php :5  Frontend_rentalauth RentalAuth->setModel("Model_Customer")
/www/agiletoolkit.org/example/atk4/lib/AbstractObject.php   :181    Frontend_rentalauth RentalAuth->init()
/www/agiletoolkit.org/example/examples/dvdrental/lib/Frontend.php   :21     Frontend    Frontend->add("RentalAuth")
/www/agiletoolkit.org/example/atk4/lib/ApiCLI.php   :48     Frontend    Frontend->init()
/www/agiletoolkit.org/example/atk4/lib/ApiWeb.php   :38     Frontend    Frontend->__construct(Null)
/www/agiletoolkit.org/example/examples/dvdrental/index.php  :3  Frontend    Frontend->__construct() 
```

干杯。

* * *

# 更新

代码片段需要进入 User 类，所以它现在看起来像这样：

```
class Model_User extends Model_Table {
public $entity_code='user';

function init(){
    parent::init();

    $this->hasOne('Person');

    $field_ref = $this->getField('person')->rename('person_str');
    $this->getField('person_id')->dereferenced_field='person_str';

    // add referenced Model
    $m = $this->add('Model_Person');
    $m->addField('name');

    // Link referenced model field name to this model field.
    $field_ref->setModel($m, 'name');

}
} 
```

产生的 SQL 是：

select `id`, `person_id`,(select `name`from `person`where `user`. `person_id`= `person`. `id`) `person_str`from`user`

* * *

然而，下面的类也产生相同的 SQL 语句。

```
class Model_User extends Model_Table {
public $entity_code='user';

function init(){
    parent::init();

    $this->hasOne('Person');

    $this->getField('person')->rename('person_str');

}
} 
```

所以我不太了解其余代码的功能和需求： $this->getField('person_id')->dereferenced_field='person_str';

```
 // add referenced Model
    $m = $this->add('Model_Person');
    $m->addField('name');

    // Link referenced model field name to this model field.
    $field_ref->setModel($m, 'name'); 
```

我希望我们能对此得到进一步的解释，谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-01T10:38:43.707

在你的人物模型中试试这个

```
$this->hasOne('Person');
$this->getField('person')->rename('person_str');
$this->getField('person_id')->dereferenced_field='person_str'; 
```

否则“setmodel”不适用于预先创建的对象。

# c# - 动态 If 语句 - 复杂过滤

> ID：10392458
> 
> 赞同：2
> 
> 时间：2012-05-01T01:20:01.937
> 
> 标签：c#, if-statement, filter

我有一个 C# 项目，允许用户使用正则表达式对数据创建过滤器。他们可以根据需要添加任意数量的过滤器。每个过滤器都包含一个字段和一个用户输入的正则表达式。

现在它适用于所有 AND 逻辑。我遍历每个过滤器，如果不匹配，我设置 skip = true 并跳出循环。然后，如果 skip == true 我跳过该记录并且不包含它。因此，每个过滤器都必须匹配才能包含该字段。

但是，现在他们希望能够添加更复杂的逻辑规则。例如，如果他们创建了 4 个过滤规则。他们希望能够指定：1 AND 2 AND (3 OR 4) 或者他们可能希望指定 1 OR 2 OR 3 OR 4 或者他们可能希望指定 (1 AND 2 AND 3) OR 4 等等。 。我认为你说对了。

我添加了一个文本框，他们可以在其中输入他们想要的逻辑。

我一直在绞尽脑汁，不知道如何完成这项工作。我唯一的结论是能够以某种方式创建一个基于他们在文本框中键入的文本的动态 IF 语句，但我不知道这是否可能。

似乎应该有一个简单的方法来做到这一点，但我无法弄清楚。如果有人可以帮助我，我将不胜感激。

谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-01T02:37:53.663

这是一个完整的测试，可以根据需要使用正则表达式和 AND、OR 和括号。请注意，这只支持运算符`AND`和`OR`括号`(`，`)`并期望输入格式正确（正则表达式不能有空格）。解析可以改进，思路不变。

以下是整体测试：

```
var input = ".* AND [0-9]+ AND abc OR (abc AND def)";
var rpn = ParseRPN(input);  
var test = GetExpression(new Queue<string>(rpn.Reverse())).Compile();
test("abc");    // false
test("abc0");   // true
test("abcdef"); // true 
```

这是反向波兰符号的解析：

```
public Queue<string> ParseRPN(string input)
{
    // improve the parsing into tokens here
    var output = new Queue<string>();
    var ops = new Stack<string>();
    input = input.Replace("(","( ").Replace(")"," )");
    var split = input.Split(' ');

    foreach (var token in split)
    {
        if (token == "AND" || token == "OR")
        {
            while (ops.Count > 0 && (ops.Peek() == "AND" || ops.Peek() == "OR"))
            {
                output.Enqueue(ops.Pop());
            }
            ops.Push(token);
        }
        else if (token == "(") ops.Push(token);
        else if (token == ")")
        {
            while (ops.Count > 0 && ops.Peek() != "(")
            {
                output.Enqueue(ops.Pop());
            }
            ops.Pop();
        }
        else output.Enqueue(token); // it's a number        
    }

    while (ops.Count > 0)
    {
        output.Enqueue(ops.Pop());
    }

    return output;
} 
```

还有魔法`GetExpression`：

```
public Expression<Func<string,bool>> GetExpression(Queue<string> input)
{
    var exp = input.Dequeue();
    if (exp == "AND") return GetExpression(input).And(GetExpression(input));
    else if (exp == "OR") return GetExpression(input).Or(GetExpression(input));
    else return (test => Regex.IsMatch(test, exp));
} 
```

请注意，这确实依赖于[`PredicateBuilder`](http://www.albahari.com/nutshell/predicatebuilder.aspx)，但使用的扩展函数在这里是完整的：

```
public static class PredicateBuilder
{
  public static Expression<Func<T, bool>> True<T> ()  { return f => true;  }
  public static Expression<Func<T, bool>> False<T> () { return f => false; }

  public static Expression<Func<T, bool>> Or<T> (this Expression<Func<T, bool>> expr1,
                                                      Expression<Func<T, bool>> expr2)
  {
    var invokedExpr = Expression.Invoke (expr2, expr1.Parameters.Cast<Expression> ());
    return Expression.Lambda<Func<T, bool>>
          (Expression.OrElse (expr1.Body, invokedExpr), expr1.Parameters);
  }

  public static Expression<Func<T, bool>> And<T> (this Expression<Func<T, bool>> expr1,
                                                       Expression<Func<T, bool>> expr2)
  {
    var invokedExpr = Expression.Invoke (expr2, expr1.Parameters.Cast<Expression> ());
    return Expression.Lambda<Func<T, bool>>
          (Expression.AndAlso (expr1.Body, invokedExpr), expr1.Parameters);
  }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-01T01:54:10.323

如下所示 - 定义操作类来表示二元操作并构建您的树：

```
interface IFilter  
{
 bool Filter(Record r);
}

class SimpleFilter : IFilter
{ 
 bool Filter(Record r)
 {
  return RegExpMatch(r); 
 }
}

class AndFilter : IFilter
{ 
 public AndFilter(IFilter left, IFilter right) {}

 bool Filter(Record r)
 {
  return left.Filter(r) && right.Filter(r); 
 }
}

class OrFilter : IFilter
{ 
 public OrFilter(IFilter left, IFilter right) {}

 bool Filter(Record r)
 {
  return left.Filter(r) || right.Filter(r); 
 }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-01T01:58:11.040

第一步是将您的表达式解析为抽象语法树。为此，您可以使用[调车场算法](http://en.wikipedia.org/wiki/Shunting-yard_algorithm)。

完成此操作后，您可以使用虚拟方法或接口递归地评估树。例如，您可以有一个`SimpleNode`类，它代表一个简单的表达式（如`1`您的示例中）并且可以评估它。然后你有`AndNode`那个代表`AND`操作并且有两个子节点。它评估子节点并返回是否都成功。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-01T02:00:05.427

规范模式的这种解释（带有示例代码）应该会有所帮助。

[http://en.wikipedia.org/wiki/Specification_pattern#C.23](http://en.wikipedia.org/wiki/Specification_pattern#C.23)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-05-01T02:13:58.380

可能有一些库可以为你做这种事情，但在过去，我已经沿着这些思路手动滚动了一些东西，基于使用 Predicate；使用系统；使用 System.Collections.Generic；使用 System.Linq；使用 System.Text；使用 System.Text.RegularExpressions；

```
 namespace ConsoleApplication1
    {
        public enum CombineOptions
        {
            And,
            Or,
        }

        public class FilterExpression
        {
            public string Filter { get; set; }
            public CombineOptions Options { get; private set; }
            public FilterExpression(string filter, CombineOptions options)
            {
                this.Filter = filter;
                this.Options = options;
            }
        }

        public static class PredicateExtensions
        {
            public static Predicate<T> And<T>
                (this Predicate<T> original, Predicate<T> newPredicate)
            {
                return t => original(t) && newPredicate(t);
            }

            public static Predicate<T> Or<T>
                (this Predicate<T> original, Predicate<T> newPredicate)
            {
                return t => original(t) || newPredicate(t);
            }
        }

        public static class ExpressionBuilder
        {
            public static Predicate<string> BuildExpression(IEnumerable<FilterExpression> filterExpressions)
            {
                Predicate<string> predicate = (delegate
                {
                    return true;
                });

                foreach (FilterExpression expression in filterExpressions)
                {
                    string nextFilter = expression.Filter;
                    Predicate<string> nextPredicate = (o => Regex.Match(o, nextFilter).Success);

                    switch (expression.Options)
                    {
                        case CombineOptions.And:
                            predicate = predicate.And(nextPredicate);
                            break;
                        case CombineOptions.Or:
                            predicate = predicate.Or(nextPredicate);
                            break;
                    }
                }

                return predicate;
            }
        }

        class Program
        {
            static void Main(string[] args)
            {
                FilterExpression f1 = new FilterExpression(@"data([A-Za-z0-9\-]+)$", CombineOptions.And);
                FilterExpression f2 = new FilterExpression(@"otherdata([A-Za-z0-9\-]+)$", CombineOptions.And);
                FilterExpression f3 = new FilterExpression(@"otherdata([A-Za-z0-9\-]+)$", CombineOptions.Or);

                // result will be false as "data1" does not match both filters
                Predicate<string> pred2 = ExpressionBuilder.BuildExpression(new[] { f1, f2 });
                bool result = pred2.Invoke("data1");

                // result will be true as "data1" matches 1 of the 2 Or'd filters
                Predicate<string> pred3 = ExpressionBuilder.BuildExpression(new[] { f1, f3 });
                result = pred3.Invoke("data1");
            }
        }
    } 
```

您现在需要做的就是解析“括号”以确定将 FilterExpressions 发送到 BuildExpression 方法的顺序。您可能需要调整它以获得更复杂的表达式，但希望这会有所帮助。

# javascript - Javascript 错误：this.replace($foo, "");

> ID：10392461
> 
> 赞同：0
> 
> 时间：2012-05-01T01:20:22.047
> 
> 标签：javascript, jquery, replace

我的第六行代码不起作用。请帮忙。

```
function ajax() {
    $('a[class="ajax-cw"]').click( function() {
        $('#cw').load( this + "?ajax" );
        $('#nav li.current').removeClass('current');
        var $base = $("base").attr("href"),
            $link = this.replace($base, ""); //Line does not work
        alert ($link);
        return false;
    });
}; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-01T01:28:50.780

如果您尝试将当前单击的链接的部分 href 内容替换为基础对象的部分内容，则必须通过以下方式访问 href 内容

```
var currenthref = $(this).attr('href'); 
```

然后在替换行中使用 currenthref。

```
$link = currenthref.replace($base, ""); 
```

对此的替换功能将无法正常工作，因为它不是字符串，而是代表您单击的链接元素的对象（最可能是 jquery）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-01T01:24:24.107

尝试这个：

```
this.href.replace($base, ''); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-01T03:15:44.520

`this`第 6 行是`<a />`标签，而不是该标签的 href。 `$(this).attr('href').replace($base,"")`会表现更好。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2012-05-01T01:25:25.633

您需要以分号结束前一行。你用逗号结束了它。

```
var $base = $("base").attr("href"); 
```

# apache-flex - 将 Flex 连接到 SQLite

> ID：10392469
> 
> 赞同：0
> 
> 时间：2012-05-01T01:22:20.407
> 
> 标签：apache-flex, sqlite, flash-builder

在 Flash builder 中，我正在努力解决从本地数据库中检索数据的基础知识。使用 Lita，我创建了一个 SQLite 数据库，其中包含位于“DAO”文件夹中的单个基本（项目）表。它旨在填充一个列表。我有两个问题：

1.  如许多教程中所示，如何嵌入数据库（及其所有预先填充的数据）而不从头开始重新创建它？
2.  出于原型设计的目的，如何在不创建许多其他类的情况下直接在列表中链接检索到单个 MXML 文件的数据（好的，在这种情况下，所需类的数量将受到限制），例如：

```
<?xml version="1.0" encoding="utf-8"?>
<s:View xmlns:fx="http://ns.adobe.com/mxml/2009" 
      xmlns:s="library://ns.adobe.com/flex/spark" 
      title="HomeView" >

<fx:Script>

  <![CDATA[

      import flash.data.SQLConnection
      import flash.data.SQLStatement;
      import flash.filesystem.File;
      import flash.filesystem.FileMode;
      import mx.collections.ArrayCollection;`

      private function get myData():ArrayCollection 
      {
          var stmt:SQLStatement = new SQLStatement();
          stmt.sqlConnection = new SQLConnection();

          stmt.sqlConnection.open(File.applicationStorageDirectory.resolvePath("dao/MyDatabase.db"));
          stmt.text = "SELECT id, name FROM Item";

          stmt.execute();
          var result:Array = stmt.getResult().data;

          if (result)
          {
              var list:ArrayCollection = new ArrayCollection();
              list.source(result); 
              return list; 
          } else {
              return null; 
          } 
      }
      ]]>
    </fx:Script>

    <s:List id="list" top="0" bottom="0" left="0" right="0" 
           dataProvider="{myData}" >
    <s:itemRenderer>
    <fx:Component>
    <s:IconItemRenderer label="{myData.name}">
    </s:IconItemRenderer>
    </fx:Component>
    </s:itemRenderer>
    </s:List>
    </s:View> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-01T10:23:33.333

对于问题 1，您可以将数据库添加为项目的资产，在导出版本期间，它将嵌入到安装程序中，然后如果您想将其放入 localstore 文件夹中，您可以从代码中复制/移动它...

对于数字 2

```
import flash.data.SQLConnection
  import flash.data.SQLStatement;
  import flash.filesystem.File;
  import flash.filesystem.FileMode;
  import mx.collections.ArrayCollection;`

  [Bindable]private var resultArr:ArrayCollection = new ArrayCollection();

  private function getData():ArrayCollection 
  {
      var stmt:SQLStatement = new SQLStatement();
      stmt.sqlConnection = new SQLConnection();

      stmt.sqlConnection.open(File.applicationStorageDirectory.resolvePath("dao/MyDatabase.db"));
      stmt.text = "SELECT id, name FROM Item";

      stmt.execute();
      var result:Array = stmt.getResult().data;

      resultArr =  new ArrayCollection();
      if (result)
      {      
          resultArr.source = result;           
      }
  }
  ]]>
</fx:Script>

<s:List id="list" top="0" bottom="0" left="0" right="0" 
       dataProvider="{resultArr}" labelField="name" >
</s:List> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-01T14:58:35.830

感谢 Marcx 和[Marcos Placona](http://www.placona.co.uk/665/flex/sqlite-databases-and-mobile-applications-a-caveat/)在本地复制数据库的博客条目，我想出了这个：

```
<?xml version="1.0" encoding="utf-8"?>
<s:View xmlns:fx="http://ns.adobe.com/mxml/2009" 
      xmlns:s="library://ns.adobe.com/flex/spark" 
      title="HomeView" >

<fx:Script>

  <![CDATA[

      import flash.data.SQLConnection
      import flash.data.SQLStatement;
      import flash.filesystem.File;
      import flash.filesystem.FileMode;
      import mx.collections.ArrayCollection;

      private function get myData():ArrayCollection 
      {
          var myData:String = "dao/MyDatabase.db";
          var embededSessionDB:File = File.applicationDirectory.resolvePath(myData);
          var writeSessionDB:File = File.applicationStorageDirectory.resolvePath(myData);
          // If a writable DB doesn't exist, we then copy it into the app folder so it's writteable
          if (!writeSessionDB.exists) 
          {
             embededSessionDB.copyTo(writeSessionDB);
          }

          var stmt:SQLStatement = new SQLStatement();
          stmt.sqlConnection = new SQLConnection();

          stmt.sqlConnection.open(File.applicationStorageDirectory.resolvePath(myData));
          stmt.text = "SELECT id, name FROM Item";

          stmt.execute();
          var result:Array = stmt.getResult().data;

            stmt.execute();
            var result:Array = stmt.getResult().data;
            var r:ArrayCollection = new ArrayCollection();

            if (result)
            {      
                r.source = result; 
                return r;
            }else{
                return null;
            } 
      }

      [Bindable]private var resultArr:ArrayCollection = getData();

      ]]>

    </fx:Script>

    <s:List id="list" top="0" bottom="0" left="0" right="0" 
           dataProvider="{myData}" label="name">
    </s:List>
    </s:View> 
```

# html - 如何设置嵌入 youtube 视频的选项

> ID：10392470
> 
> 赞同：-2
> 
> 时间：2012-05-01T01:22:27.747
> 
> 标签：html, youtube, embed

我正在嵌入一个 youtube 视频。我想设置以下内容：

```
Control Bar:
show
hide
auto hide

AutoPlay/Use Click to Play
Loop/Play Once
Show/Hide Title Bar
Use Light Control Bar

<object width="425" height="350" data="http://www.youtube.com/v/Ahg6qcgoay4" type="application/x-shockwave-flash"><param name="src" value="http://www.youtube.com/v/Ahg6qcgoay4" /></object> 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-01T01:25:16.503

你试过用谷歌搜索吗？我找到的第一个链接： [https ://developers.google.com/youtube/player_parameters](https://developers.google.com/youtube/player_parameters)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-01T01:54:30.083

发布为单独的答案，因为我无法让代码标签在评论中工作。

好吧，只是为了让您开始，您可以将这些参数作为 GET 传递。考虑： `src="http://www.youtube.com/embed/u1zgFlCw8Aw?autoplay=1&origin=http://example.com"`
现在查看视频的 url，假设您想隐藏控件，转到链接并阅读有关参数的详细信息。您可以看到一个名为“controls”的变量，它可以有两个值，0（隐藏）和 1（显示）。因此，要简单地删除控件，请像这样更改视频的 url：
`src="http://www.youtube.com/embed/u1zgFlCw8Aw?autoplay=1&origin=http://example.com&controls=0"`注意到“&”符号后传递的变量了吗？您可以像这样传递多个变量。希望我保持简单。

# objective-c - editButtonItem 未显示

> ID：10392472
> 
> 赞同：1
> 
> 时间：2012-05-01T01:22:57.630
> 
> 标签：objective-c, ios, xcode, uitableview

**问题：**`//`当我删除注释斜杠（ ） 时，Xcode 在创建新的 UITableViewController 类时自动注释掉的内置 editButtonItem 不起作用。不起作用我的意思是编辑按钮根本不出现。滑动单元格也不起作用。

**尝试的解决方案：** 我尝试遵循已在其他 stackoverflow 线程上发布的各种解决方法，但无济于事。我发现的大多数帖子都谈到了编辑按钮不起作用的各个方面（例如，没有显示减号等），但我发现很少有帖子根本没有显示编辑按钮。

**预感：** 我有一种预感，这可能与 UITableViewController 未正确实现有关。我对面向对象编程和objective-c都很陌生，所以如果答案是非常基本的东西，我很抱歉——但是，嘿，这是学习过程的一部分。任何帮助深表感谢。

**代码：**

***_* __ *_* .h**

```
#import <UIKit/UIKit.h>
#import "IndividualRecipeViewController.h"

@class BrowsePrivateRecipeViewController;

@protocol BrowsePrivateRecipeViewControllerDelegate
- (void)browsePrivateRecipeViewControllerDidFinish:(BrowsePrivateRecipeViewController *)controller;
@end

@interface BrowsePrivateRecipeViewController : UITableViewController

@property (weak, nonatomic) id <BrowsePrivateRecipeViewControllerDelegate> delegate;
@property (assign, nonatomic) NSUInteger listLength;
@property (strong, nonatomic) NSDictionary *dictionaryOfRecipes;
@property (strong, nonatomic) NSMutableArray *arrayOfRecipeNames;

// ... methods

@end 
```

***_* __ *_* .m**

```
@interface BrowsePrivateRecipeViewController ()

@end

@implementation BrowsePrivateRecipeViewController

@synthesize delegate = _delegate;
@synthesize listLength = _listLength;
@synthesize dictionaryOfRecipes = _dictionaryOfRecipes;
@synthesize arrayOfRecipeNames = _arrayOfRecipeNames;

- (void)viewDidLoad
{
    // ... code here

    // Uncomment the following line to display an Edit button in the navigation bar for this view controller.
    self.navigationItem.rightBarButtonItem = self.editButtonItem;
}

// ... other methods 
```

**更新：**

**[链接到源代码](https://www.dropbox.com/s/k4v5oaiy11rxism/project3.zip)**

所以我决定将源代码发布到我的整个项目中。我在多个文件中遇到了这个问题，但如果我把它固定在一个文件中，我很确定其余的都会到位。

请关注文件`BrowsePrivateRecipeViewController.m/.h.`这是问题最直接的例子。

再次感谢您的耐心和帮助。

真诚的，杰森

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-01T09:22:27.803

首先，我绝对不会使用自定义按钮来编辑表格。没有必要仅仅因为已经内置了一个。

只需使用`UIViewController`s `editButtonItem`。
如果您必须在按钮按下时执行其他操作，请先覆盖`-setEditing:animated:`并调用`super`。

您上面提到的错误是因为您尝试访问不存在的`navigationBar`s引起的。`navigationItem`您应该访问您的视图控制器的`navigationItem`.

```
self.navigationItem.rightBarButtonItem = self.editButtonItem; 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-01T01:43:28.557

您需要先制作一个按钮。这将创建一个编辑按钮，然后将其添加到 rightBarButtonItem 位置。

```
// Uncomment the following line to display an Edit button in the navigation bar for this view controller.
UIBarButtonItem *editButton = [[UIBarButtonItem alloc] initWithBarButtonSystemItem:UIBarButtonSystemItemEdit target:self action:@selector(editTable)];
self.navigationItem.rightBarButtonItem = editButton; 
```

然后您需要设置一个方法来打开表格的编辑模式。

```
- (void)editTable
{
    [self.tableView setEditing:YES animated:YES];
} 
```

**更新：**

再次阅读您的问题，并注意到您也希望滑动删除。您需要添加这些方法才能将其添加到您的表格视图中。

```
// Override to support conditional editing of the table view.
- (BOOL)tableView:(UITableView *)tableView canEditRowAtIndexPath:(NSIndexPath *)indexPath
{
    // Return NO if you do not want the specified item to be editable.
    return YES;
}

// Override to support editing the table view.
- (void)tableView:(UITableView *)tableView commitEditingStyle:(UITableViewCellEditingStyle)editingStyle forRowAtIndexPath:(NSIndexPath *)indexPath
{
    if (editingStyle == UITableViewCellEditingStyleDelete) {
        // Delete the row from the data source
        [tableView deleteRowsAtIndexPaths:[NSArray arrayWithObject:indexPath] withRowAnimation:UITableViewRowAnimationFade];
    }   
    else if (editingStyle == UITableViewCellEditingStyleInsert) {
        // Create a new instance of the appropriate class, insert it into the array, and add a new row to the table view
    }   
} 
```

**更新 2**

__。H

```
@property (weak, nonatomic) IBOutlet UINavigationBar *navigationBar; 
```

__.m

```
@synthesize navigationBar;

- (void)viewDidLoad {
    //...

    UIBarButtonItem *editButton = [[UIBarButtonItem alloc] initWithBarButtonSystemItem:UIBarButtonSystemItemEdit target:self action:@selector(editTable)];
    self.navigationBar.navigationItem.rightBarButtonItem = editButton;
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-01T01:34:01.650

您不是在编辑`alloc`或`init`编辑 editButtonItem 对象，那么您怎么能期望保留它（等号），更不用说让它显示了？您基本上是在向 nil 发送消息。

# c# - 使用 tlbimp 而不需要第二次组装？

> ID：10392473
> 
> 赞同：2
> 
> 时间：2012-05-01T01:22:58.893
> 
> 标签：c#, com, com-interop, tlbimp

我正在尝试在我的 C# dll 中实现一个 COM 接口供其他人使用。我在 foo.idl 中定义了一个接口。

我已经通过 tlbimp 运行 foo.idl 来生成 foo.dll，一个 .Net 程序集。现在要实现我的接口，我可以在我的 dll 中引用 foo.dll 来实现接口。

这完美地工作，因为它有一个例外：我现在必须分发两个 dll 而不是一个。这实际上违背了我正在处理的项目的要求：交付一个 DLL。

有没有办法将 tlbimp dll 合并到我的中，或者任何其他方式来做到这一点（在没有第二个 dll 的 C# 中实现 COM 接口）？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-01T02:11:43.453

一个好的反汇编程序可以完成工作，比如 Reflector。您可以简单地反汇编互操作程序集并将生成的 C# 接口声明复制到源代码中。当然，只有在接口声明和 IID 稳定时才应该这样做。

并且绝对考虑升级到 VS2010。它的“嵌入互操作类型”功能允许您在没有互操作程序集的情况下发布您的程序集。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-01T01:29:01.920

您可能会通过使用 .tlb 而不是“胶水”dll 来作弊。

我建议您使用 MSVC++/CLR 创建一个混合模式程序集

*   [http://msdn.microsoft.com/en-us/library/k8d11d4s(v=vs.100).aspx](http://msdn.microsoft.com/en-us/library/k8d11d4s(v=vs.100).aspx)
*   [互操作（我如何在 Visual C++ 中使用）](http://msdn.microsoft.com/en-us/library/ms177552(v=vs.100).aspx)

这可能具有不能在同一个程序集中使用 C# 的缺点。如果您想将 C# 代码添加到混合中，您可以使用

*   [合并](http://www.microsoft.com/en-us/download/details.aspx?id=1763)

对于其他可能有趣的想法，请参阅我之前的回答：

*   [是否可以将控制台应用程序编译成单个 .dll 文件？](https://stackoverflow.com/questions/7135031/is-it-possible-to-compile-a-console-application-into-a-single-dll-file/7135248#7135248)

# jquery - 如何使这个 jquery 在 iOS 5.1 的 UIWebView 中工作？

> ID：10392485
> 
> 赞同：3
> 
> 时间：2012-05-01T01:25:29.407
> 
> 标签：jquery, uiwebview, mobile-safari

我有以下标记：

```
<div class="event-row-container">
    <div data-id="1" class="ios-location-name">Location Name</div>
    <div data-id="1" class="ios-location-detail" style="display: block;">
    700 S Grand Ave<br>
    Omaha<br>
    </div>
</div> 
```

和以下 jQuery：

```
$('.ios-location-name').click(function(){
  var event_id=$(this).data('id');
  alert('you clicked event_id:' + event_id);
  $('.ios-location-detail').toggle();
}); 
```

适用于所有浏览器，但不适用于 iOS5.1（模拟器或设备）上的嵌入式 UIWebView。这应该工作吗？有什么我想念的吗？

谢谢

**编辑 #1** 那么是否有一个简单的方法可以让它工作？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-03T19:19:03.900

正如您已经阅读的那样，有几个问题可能是原因：

1.  UIWebView 本身不注册`click`事件
2.  脚本在其 src/href 中不需要（并且显然不应该有）完整路径位置。

因此，对于第二个问题（在[此处](https://stackoverflow.com/questions/10393490/jquery-mobile-not-working-inside-uiwebview)找到）尝试更改：

```
<script src="js/jquery-1.7.2.min.js"></script> 
```

到

```
<script src="jquery-1.7.2.min.js"></script> 
```

（显然文件名和路径需要调整，但底线是只引用没有完整基本路径的文件名）。

首先，您已经在：[如何在 uiwebview 中实现触摸事件？](https://stackoverflow.com/questions/6260627/how-to-implement-touch-events-in-uiwebview)

没用。您是否尝试过以下推荐的开源库之一：[从 UIWebView 中的 javascript 向 ObjectiveC 发送通知](https://stackoverflow.com/questions/5671742/send-a-notification-from-javascript-in-uiwebview-to-objectivec)

具体来说，PhoneGap 对我来说看起来很时髦，但显然，无论哪个解决问题都是最好的。

但是为什么它在 Safari 移动端而不是 UIWebView 中起作用的总体问题是因为事件没有被映射/交叉引用。

最后一个想法，只是说您尝试过...尝试将您的代码更改为：

```
$('.ios-location-name').on("click", function(){ 
```

以防万一它们在某处被映射，但该`click`方法本身并未映射到触摸事件（即使单击事件可能是）。值得一试。但我会尝试前两个想法，看看生活是否容易。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-01T02:30:53.530

这是模拟器截图。它在这里工作。

![在此处输入图像描述](../Images/13a6c33ded896fc2e4478259f491d258.png)

# facebook-graph-api - 带有 FQL 批量请求的 Facebook Graphi API

> ID：10392486
> 
> 赞同：2
> 
> 时间：2012-05-01T01:25:31.543
> 
> 标签：facebook-graph-api, facebook-fql, facebook-batch-request

我正在尝试对 java 中的图形 API 使用批处理请求。实际上，它是一个 HTTPClient 正在发出图形 API 请求。

我试图构造一个这样的批处理请求数组：

```
String query2 = "SELECT --- from tableX";

    String query = "SELECT --- from tableY";

    String batch_request= "[{\"method\":\"GET\",\"relative_url\":method/fql.query?query="+query+"},"+
    "{\"method\":\"GET\",\"relative_url\":method/fql.query?query="+query2+"}]"; 
```

然后我对请求进行 URLEncode： String query = URLEncoder.encode(batch_request)

并将其传递给图形 API，如下所示： [https://graph.facebook.com/?batch=](https://graph.facebook.com/?batch=) "+query+"&access_token="+accessToken

我没有得到任何结果:(。它返回错误 500。

有什么想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-26T06:32:02.730

对于 fql 查询的批量请求，您可以这样做。我已经成功地尝试过了。

//$current_user=facebook id

```
 $query1="SELECT uid, name FROM user WHERE is_app_user=1 AND uid IN (SELECT uid2 FROM friend WHERE uid1 = $current_user)";
 $query2="SELECT uid, name, work_history FROM user WHERE uid IN (SELECT uid2 FROM friend WHERE uid1 = $current_user )";
 $query3="SELECT uid, name, work, education FROM user WHERE uid = $current_user";
 $queries = array(
           array('method'=>'GET', 'relative_url'=>'method/fql.query?query='.str_replace(' ','+',$query1)),
           array('method'=>'GET', 'relative_url'=>'method/fql.query?query='.str_replace(' ','+',$query2)),
           array('method'=>'GET', 'relative_url'=>'method/fql.query?query='.str_replace(' ','+',$query3))
            );

            $objs = $facebook->api('/?batch='.json_encode($queries), 'POST'); 
```

$objs 获取 thre 查询的整个结果的 json 数组。

来源：[https ://stackoverflow.com/a/9635233/1045444](https://stackoverflow.com/a/9635233/1045444)

# javascript - JQuery点击事件多次触发

> ID：10392489
> 
> 赞同：0
> 
> 时间：2012-05-01T01:25:44.883
> 
> 标签：javascript, jquery, event-handling, click

我知道这里已经有很多关于多个点击事件被触发的问题，我想我已经阅读了它们，但仍然看不出这里出了什么问题。

完全希望我错过了一些其他人可以轻松掌握的明显东西......

一些背景

我的代码在企业社交网络平台中运行，并创建了一个用于内容分析的 BI 仪表板（大约 1000 行内容，主要是特定于域的，因此无法完整发布）。

让我伤心的部分是构建仪表板可视化本身的功能。

开始...

```
function makePage(){
 $("#policyCount").text(policyCount);
  var docTypes=getGlobalDocTypes(polOwners); //returns a constrained vocab array
  var statusTypes=getGlobalStatusTypes(polOwners); //returns a constrained vocab array
  $.each(polOwners,function(){ // polOwners is a global array that contains the BI data to be visualised
   html=""
   var ownerName = this.name.split(":")[1]; // name is a str in format "Owner:HR"
   html += "<div id='" + ownerName + "' class='ownerData'>";
   html += "<div class='ownerHeading'>" + ownerName + "</div>";
   html += this.policies.length + " Policy documents maintained<br />"; // policies is an array of docs managed by owner

   divIDReview = "dboard_" + ownerName + "reviewchart";
   html += "<div id='" + divIDReview + "' class='dboardelement'></div>";

   divIDType = "dboard_" + ownerName + "typechart";
   html += "<div id='" + divIDType + "' class='dboardelement'></div>";

   divIDStatus = "dboard_" + ownerName + "statuschart";
   html += "<div id='" + divIDStatus + "' class='dboardelement'></div>";

   html += "<div id='" + ownerName + "ToggleTable' class='toggletable' owner='" + ownerName + "'>";
   html += "Click to display all " + ownerName + " documents<br /></div>";
   html += "<div id='" + ownerName + "polTable' class='poltable'>";
   html += getPolTable(this.policies); // Returns an HTML table of doc metadata
   html += "</div>";

   html += "</div>";
   $("#owners").append(html); // When this function is called #owners is an empty div

   $(".toggletable").mouseover(function(){
     $(this).css({'cursor':'pointer','text-decoration':'underline'});
    });

   $(".toggletable").mouseout(function(){
     $(this).css( {'cursor':'default','text-decoration':'none'});
    });

   $(".toggletable").each(function(i, elem){
    $(elem).click(function(){
      if ($(this).next(".poltable").css("display")=="none"){
       // Currently hidden - so show
       if (debug){console.log($(this).attr("id") + " was clicked")}
       $(this).html("Click to hide " + $(this).attr('owner') + " documents<br/>");
       $(this).next(".poltable").css("display","block");
       } else {
       if (debug){console.log($(this).attr("id") + " was clicked")}
       $(this).html("Click to display all " + $(this).attr('owner') + " documents<br    />");
       $(this).next(".poltable").css("display","none");
       }      
    });
   });

   // the next section calls functions that use the Google vis api to draw  pie charts

   drawPie(300,200, "Review Status", "Status", "Policies",    getReviewStatus(this.policies), ["green","orange","red"], divIDReview); 

   drawPie(300,200, "Document Types", "Type", "Docs", getDocTypes(this.policies, docTypes), [], divIDType); 

   drawPie(300,200, "Document Status", "Status", "Docs", getStatusTypes(this.policies, statusTypes), [], divIDStatus); 
 }); 
 } 
```

希望这足以说明问题。

您将看到代码为每个 polOwner 构建了一个仪表板显示，其中包含三个饼图和一个隐藏或显示基础数据表的选项。

我首先将 click 事件应用于`.toggletable`类。当它多次触发时，我使用此处另一个答案中描述的方法`.each`将唯一事件附加到类的每个实例。

那么，会发生什么？

目前有 9 个`polOwners`，乍一看，点击事件似乎只是切换每个其他表格的显示状态。然而，控制台日志显示，这是因为第一个实例触发了 9 次，第二个实例触发了 8 次，第三个实例触发了 7 次，以此类推，奇数离开表格处于备用状态（当此工作正常时，显示将变为动画`.toggle`）。

有关信息，虽然我是一名文本编辑人员，但我确实有一份 MS Expression Web 4 的副本，它是检查 HTML 错误的有用工具。我已经粘贴了整个生成的标记（近 4000 行）的副本，并且看不到任何错误的嵌套或结构错误。

有什么想法吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-05-01T01:35:01.863

你有一些嵌套循环：

```
// jQuery each on polOwners
$.each(polOwners,function(){
    // ... code that appends .toggletable class 

    // jQuery each on .toggletable class
    $(".toggletable").each(function(i, elem){
        // code that runs on the toggletable element
    });
}); 
```

对于每个 polOwner，您都在为`toggletable`该类添加一个 div。然后在里面你用一个`toggletable`类循环遍历每个 div 并添加一个点击事件。

这为第一个 polOwner 添加了 1 次点击，为第二个添加了 2 次，为第三个添加了 3 次，依此类推。

将`toggletable`每个移到每个外部，`polOwner`您应该会很好

# c# - 使用 Excel Interop c# 将单词替换为粗体字

> ID：10392494
> 
> 赞同：2
> 
> 时间：2012-05-01T01:26:18.487
> 
> 标签：c#, excel, replace, interop, bold

我正在使用以下内容搜索我的整个 Excel 工作表并将“req”替换为“requirement”：

```
oSheet.Cells.Replace("req", "requirement"); 
```

而不是替换单词req，我想加粗它。我怎样才能做到这一点？我知道这是错误的，但理论上我想做以下事情：

```
oSheet.Cells.Replace("req", "<b>req</b>"); 
```

谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-01T16:56:37.400

我假设您想将单元格中的单个文本项设置为粗体，这比第一次出现的要复杂一些。以下将解决问题：

```
 public void FindTextAndSetToBold(string text)
    {
        Excel.Range currentFind = null;
        Excel.Range firstFind = null;

        // Find the first occurrence of the passed-in text

        currentFind = oSheet.Cells.Find(text, Missing.Value, Excel.XlFindLookIn.xlValues,
            Excel.XlLookAt.xlPart, Excel.XlSearchOrder.xlByRows, Excel.XlSearchDirection.xlNext,
            false, Missing.Value, Missing.Value);

        while (currentFind != null)
        {
            // Keep track of the first range we find

            if (firstFind == null)
            {
                firstFind = currentFind;
            }
            else if (currentFind.get_Address(Missing.Value, Missing.Value, Excel.XlReferenceStyle.xlA1,
                Missing.Value, Missing.Value) ==
                firstFind.get_Address(Missing.Value, Missing.Value, Excel.XlReferenceStyle.xlA1,
                Missing.Value, Missing.Value))
            {
                // We didn't move to a new range so we're done

                break;
            }

            // We know our text is in first cell of this range, so we need to narrow down its position

            string searchResult = currentFind.get_Range("A1").Value2.ToString();
            int startPos = searchResult.IndexOf(text);

            // Set the text in the cell to bold

            currentFind.get_Range("A1").Characters[startPos + 1, text.Length].Font.Bold = true;

            // Move to the next find

            currentFind = oSheet.Cells.FindNext(currentFind);
        }
    } 
```

部分取自[这里](http://msdn.microsoft.com/en-us/library/e4x1k99a%28v=vs.100%29.aspx)并进行了修改。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-01T02:50:52.223

这是做你想做的吗？（预先设定）

```
Application.ReplaceFormat.Font.FontStyle = "Bold" 
```

# ruby - 在 mac osX (Lion) 上为 ruby 安装 libyaml

> ID：10392495
> 
> 赞同：5
> 
> 时间：2012-05-01T01:26:25.307
> 
> 标签：ruby, macos, psych

我收到此错误消息：

```
"It seems your ruby installation is missing psych (for YAML output).
To eliminate this warning, please install libyaml and reinstall your ruby." 
```

我试过输入这个命令：`rvm pkg install libyaml`

我收到此错误消息：

```
"Fetching yaml-0.1.4.tar.gz to /Users/luke/.rvm/archives
Extracting yaml-0.1.4.tar.gz to /Users/luke/.rvm/src
Error running 'tar xmzf /Users/luke/.rvm/archives/yaml-0.1.4.tar.gz -C
/Users/luke/.rvm/src ', 
   please read /Users/luke/.rvm/log/yaml/extract.log
Configuring yaml in /Users/luke/.rvm/src/yaml-0.1.4.
Error running ' ./configure --prefix="/Users/luke/.rvm/usr"  ', 
   please read /Users/luke/.rvm/log/yaml/configure.log
Compiling yaml in /Users/luke/.rvm/src/yaml-0.1.4.
Error running 'make ', please read /Users/luke/.rvm/log/yaml/make.log

Database file /Users/luke/.rvm/config/packages does not exist." 
```

有谁知道我做错了什么？谢谢！

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-05-06T04:25:23.660

当前版本 [是] LibYAML：`0.1.4 (2011-05-30)`[在 2012 年我回答了这个问题时]。

下载源包：`http://pyyaml.org/download/libyaml/yaml-0.1.4.tar.gz`.

要构建和安装 LibYAML，请运行

*   `$tar zxf yaml-0.1.4.tar.gz`*   `$cd yaml-0.1.4`*   `$ ./configure`*   `$ make`*   `$ make install`

    要不就：

    `$brew install libyaml`

    下一个， `$brew install ruby`

    祝你好运。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-09-08T02:35:14.600

这对我有用：

*   rvm 删除 1.9.3
*   下载[http://pyyaml.org/download/libyaml/yaml-0.1.4.tar.gz](http://pyyaml.org/download/libyaml/yaml-0.1.4.tar.gz)
*   cp 下载/yaml-0.1.4.tar.gz .rvm/archives/
*   rvm 安装 1.9.3

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-05-23T11:50:24.543

使用 rvm for mac osx 安装 ruby​​，使用 autolibs 安装 libyaml 并首先卸载 libyaml 有帮助。

这对我有用：

```
brew uninstall libyaml
rvm autolibs enable
rvm reinstall ruby-2.1.1 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-05-29T22:28:35.693

尝试这个...

打开一个新的终端窗口并：

```
cd .rvm/src
sudo rm -rf yaml* 
```

**（提供您的凭据）**

```
cd ~
rvm pkg install libyaml 
```

# java - 用 Java NIO 实现通用计时器（周期性事件）？

> ID：10392498
> 
> 赞同：0
> 
> 时间：2012-05-01T01:27:06.980
> 
> 标签：java, nio

是否可以在 Java 中的 NIO 选择器上接收周期性的通用事件？在`boost::asio`我之前使用过[deadline_timer](http://www.boost.org/doc/libs/1_49_0/doc/html/boost_asio/reference/deadline_timer.html)。

例如，我想在选择器正在运行的同一个线程上每秒调用一次函数，独立于选择器上活动套接字的负载量（除了特殊情况，例如花费超过一秒来处理传入套接字信息）。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-01T01:37:37.573

像这样的东西可能会起作用：

```
private final BlockingQueue<YourFunction> queue = ...

public void run() {
    while(!queue.isEmpty()) {
        queue.poll().performAction();
    }

    selector.select();

    Iterator<SelectionKey> itr = selector.selectedKeys().iterator();
    while(itr.hasNext()) {
        // etc...
    }
}

public static void main(String[] args) {
    Timer t = new Timer(name, daemon);
    t.scheduleAtFixedRate(new TimerTask() {
        public void run() {
            queue.add(new YourFunction());
            selector.wakeup();
        }
    }, 0, 1000);
} 
```

# jquery - 如何调整 ScrollPane 的大小 - 我缩小但不放大的代码。有什么建议么？

> ID：10392499
> 
> 赞同：0
> 
> 时间：2012-05-01T01:27:33.010
> 
> 标签：jquery, resize, jquery-jscrollpane

即使在 sunn0 友好地清理了我的 jquery 代码之后，当屏幕变大时，滚动窗格也没有正确重新初始化。今天终于解决了，原来这是我按 css/html 排序的

我有...

```
 <div class=”scroll-pane horizontal-only”&gt;
    <div id=”content-holder” class=”widthforeachpage”&gt;
    <div class=”content-holder”&gt;1</div>
    <div class=”content-holder”&gt;2</div>
    <div class=”content-holder”&gt;3</div>
    <div class=”content-holder”&gt;4</div>
    </div><!--end content holder-->
     </div><!--end scroll-pane--> 
```

但是一旦我将顺序更改为以下，它就可以完美运行！

```
 <div id=”content-holder” class=”scroll-pane horizontal-only”&gt;
     <div id=”widthforeachpage”&gt;
     <div class=”content-holder”&gt;1</div>
    <div class=”content-holder”&gt;2</div>
    <div class=”content-holder”&gt;3</div>
    <div class=”content-holder”&gt;4</div>
    </div><!--end widthforeachpage-->
     </div><!--end content holder--> 
```

ps div“widthforeachpage”是因为滚动窗格的宽度在滚动窗格具有的每个我的页面上都不同。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-02T00:35:13.740

尝试：

```
$('.scroll-pane').each(function(){
    $this = $(this);
    $this.jScrollPane({
        showArrows: false,
        autoReinitialise: true,
        animateScroll: true,
        horizontalDragMinWidth: 90,
        horizontalDragMaxWidth: 90
    });
    var api = $this.data('jsp');
    var throttleTimeout;
    $(window).bind( 'resize', function() {
        if ($.browser.msie) {
            if (!throttleTimeout) {
                throttleTimeout = setTimeout(
                    function(){
                        api.reinitialise();
                        throttleTimeout = null;
                    }, 
                    50
                );
            }
        } else {
            api.reinitialise();
        }
    });
}); 
```

# php - 表单中的选择字段未使用 php 发送数据

> ID：10392500
> 
> 赞同：4
> 
> 时间：2012-05-01T01:27:44.820
> 
> 标签：php, forms, select, post

所以当我发送表格时选择了第一个选项“公共”。数据被插入。但是当我尝试提交表单时选择了其他选项，即 for each 循环中的选项。不再发送数据。我检查了元素。他们正在输出所有正确的值。并且它们显示正确。他们为什么不插入数据库？当我单击提交时，没有任何反应。但是当我单击第一个选项的提交时，它工作正常吗？

```
<form method='POST' action='add.php'>

<select>    
        <option name="user_page_id" value="<?php echo $_SESSION['user_id']; ?>">Public</option>

        <?php
                    $dis=show_groups_select_list($_SESSION['user_id']);
                    foreach($dis as $key=>$list){

                        echo '<option name="user_page_id" value="'.$list['id'].'">'.$list['username'].'</option>';
                    }
        ?>
</select>
</form> 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-05-01T01:28:57.403

您需要将名称属性放在`select`标签上，而不是`option`标签上。

```
<select name="user_page_id">
    <?php foreach ($dis as $key => $list): ?>
        <option value="...">...</option>
    <?php endforeach; ?>
</select> 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2017-08-29T00:35:24.010

我知道您得到了答案，只是为那些面临同样问题但该解决方案不起作用的人提供了更多信息：
我遇到了同样的问题，结果是由 Bootstrap 解决的！
如果您使用的是[Bootstrap](http://getbootstrap.com)，则需要提供`class`select 的属性：

```
<select name="any_name" class="form-control">
    <option value="this is what would be sent if selected"> sth </option>
</select> 
```

欲了解更多信息，请查看[此](https://github.com/silviomoreto/bootstrap-select/issues/1342)讨论！

# javascript - 修复 D3 强制定向布局中的节点位置

> ID：10392505
> 
> 赞同：74
> 
> 时间：2012-05-01T01:29:00.110
> 
> 标签：javascript, d3.js, data-visualization, force-layout, d3-force-directed

我希望我的力导向布局中的一些节点忽略所有力并根据节点的属性保持在固定位置，同时仍然能够被拖动并对其他节点施加排斥并保持它们的链接线。

我认为它会像这样简单：

```
force.on("tick", function() {
    vis.selectAll("g.node")
        .attr("transform", function(d) {
            return (d.someAttribute == true) ?
               "translate(" + d.xcoordFromAttribute + "," + d.ycoordFromAttribute +")" :
               "translate(" + d.x + "," + d.y + ")"
        });
  }); 
```

我还尝试在每个刻度上手动设置节点的 x 和 y 属性，但是如果节点受到力的影响，链接会继续浮动到节点所在的位置。

显然，我对这应该如何工作有一个基本的误解。如何将节点固定在某个位置，同时保持链接并仍然允许它们可拖动？

* * *

## 回答 #1

> 赞同：83
> 
> 时间：2012-05-01T15:34:38.983

将`d.fixed`所需节点设置为 true，并初始化`d.x`并`d.y`设置到所需位置。这些节点仍然是模拟的一部分，您可以使用正常的显示代码（例如，设置一个变换属性）；但是，由于它们被标记为固定，它们只能通过拖动而不是模拟来移动。

有关更多详细信息，请参阅强制布局文档（[v3 文档](https://github.com/d3/d3-3.x-api-reference/blob/master/Force-Layout.md)，[当前文档），还可以查看](https://github.com/d3/d3-force)[此示例](http://mbostock.github.com/d3/talk/20110921/parent-foci.html)中根节点的位置。

* * *

## 回答 #2

> 赞同：44
> 
> 时间：2017-06-20T04:52:32.390

**d3v4 和 d4v5 的强制布局中的固定节点**

在 d3v3中，将在和`d.fixed`处修复节点；但是，在 d3v4/5 中不再支持此方法。[d3 文档](https://github.com/d3/d3-force#simulation_nodes)指出：`d.x``d.y`

> 要将节点固定在给定位置，您可以指定两个附加属性：
> 
> `fx - the node’s fixed x-position`

> `fy - the node’s fixed y-position`
> 
> 在每个刻度结束时，在施加任何力之后，具有定义 node.fx 的节点将 node.x 重置为该值，并将 node.vx 设置为零；同样，具有已定义 node.fy 的节点将 node.y 重置为此值，并将 node.vy 设置为零。要取消修复之前已修复的节点，请将 node.fx 和 node.fy 设置为 null，或删除这些属性。

您可以为数据源中的力节点设置`fx`和`fy`属性，也可以动态添加和删除`fx`和`fy`值。下面的代码片段在拖动事件结束时设置这些属性，只需拖动一个节点以固定其位置：

```
var data ={ 
 "nodes": 
  [{"id": "A"},{"id": "B"},{"id": "C"},{"id":"D"}], 
 "links": 
  [{"source": "A", "target": "B"}, 
   {"source": "B", "target": "C"},
   {"source": "C", "target": "A"},
   {"source": "D", "target": "A"}]
}
var height = 250;
var width = 400;

var svg = d3.select("body").append("svg")
  .attr("width",width)
  .attr("height",height);

var simulation = d3.forceSimulation()
    .force("link", d3.forceLink().id(function(d) { return d.id; }).distance(50))
    .force("charge", d3.forceManyBody())
    .force("center", d3.forceCenter(width / 2, height / 2));

var link = svg.append("g")
  .selectAll("line")
  .data(data.links)
  .enter().append("line")
  .attr("stroke","black");

var node = svg.append("g")
 .selectAll("circle")
 .data(data.nodes)
 .enter().append("circle")
 .attr("r", 5)
 .call(d3.drag()
   .on("drag", dragged)
   .on("end", dragended));

simulation
 .nodes(data.nodes)
 .on("tick", ticked)
 .alphaDecay(0);

simulation.force("link")
 .links(data.links);

function ticked() {
 link
   .attr("x1", function(d) { return d.source.x; })
   .attr("y1", function(d) { return d.source.y; })
   .attr("x2", function(d) { return d.target.x; })
   .attr("y2", function(d) { return d.target.y; });
 node
   .attr("cx", function(d) { return d.x; })
   .attr("cy", function(d) { return d.y; });
}    

function dragged(d) {
  d.fx = d3.event.x;
  d.fy = d3.event.y;
}

function dragended(d) {
  d.fx = d3.event.x;
  d.fy = d3.event.y;
}
```

```
<script src="https://cdnjs.cloudflare.com/ajax/libs/d3/4.6.0/d3.min.js"></script>
```

**d3v6 对事件监听器的更改**

在上面的代码片段中，拖动事件使用表单

```
function dragged(d) {
  d.fx = d3.event.x;
  d.fy = d3.event.y;
} 
```

`d`被拖动节点的基准在哪里。在 d3v6 中，现在的形式是：

```
function dragged(event) {
  event.subject.fx = event.x;
  event.subject.fy = event.y;
} 
```

或者：

```
function dragged(event,d) {
  d.fx = event.x;
  d.fy = event.y;
} 
```

事件现在直接传递给监听器，传递给事件监听器的第二个参数是数据。[这是](https://observablehq.com/@d3/force-directed-graph)Observable 上的规范示例。

# css - 如何将图像与名称对齐？

> ID：10392509
> 
> 赞同：0
> 
> 时间：2012-05-01T01:29:21.897
> 
> 标签：css, image, alignment

请参阅下面的代码。我正在尝试将名称与图像对齐，以使名称位于图像的右侧。我一直无法正确地做到这一点。我尝试添加 position: absolute; 但这仍然无法解决问题。

```
 <div id="contain">
    <div id="baseline">

    <div id="title2">

    <img src="http://www.marketingjava.com/wp-content/uploads/2012/01/
    new-default-twitter-avatar.jpg" id="prof_image">Ariel Smith</div>
    </div>

    CSS:

    #contain {
    width: 770px;
    min-height: 170px;    
    margin: 20px auto 60px auto;
    color: #222222;
    font-size: 15px;    
    position: relative;
    }
    #baseline {
    color: #999;
    }

    #title2 {
    color: #000;
    font-size: 30px;
    margin-left: 10px;
    padding-bottom: 5px;
    padding-top: 5px;
    width: 750px;
    } 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-01T01:43:43.670

向左浮动并使用边距调整标题以使其居中。

[http://jsfiddle.net/FBj3f/](http://jsfiddle.net/FBj3f/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-01T01:35:28.933

如果您知道图像的高度，则可以设置标题的行高，从而产生垂直居中的标题[http://jsfiddle.net/BtPwh/1/](http://jsfiddle.net/BtPwh/1/)

如果您不反对使用表格，那么您可以自动（不需要图像高度。）这样做：http: [//jsfiddle.net/tLggp/1/](http://jsfiddle.net/tLggp/1/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-01T01:32:57.853

最简单的方法是设置使用背景图像而不是图像元素。然后，您可以右对齐该块中的文本，从而实现右上角定位。

# ruby - Rhomobile 使用来自外部 Web 服务器的 CSV 或 XML 插入本地数据库

> ID：10392510
> 
> 赞同：2
> 
> 时间：2012-05-01T01:30:19.650
> 
> 标签：ruby, rhomobile, rhodes

我目前正在开发一个 Rhomobile 应用程序。我有一个保存客户信息的后端数据库。我从网络服务器获得了一个包含所有客户的 csv 字符串（或 XML - 我能够使用 REXML 解析 XML）。每次同步设备时，我都会重置设备上的客户表并重新插入后端数据库中的所有数据。我没有使用 RhoSync，设备将使用属性包。

是否可以使用 CSV 或 XML 数据插入到客户表中？如果是这样，我会怎么做？

目前，我能看到的唯一可行的选择是手动循环遍历 CSV/XML 并手动插入数据库；这不是很优雅。

任何帮助将不胜感激，如果这是一个愚蠢的问题，对不起；对这个框架来说还是比较新的。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-04T02:19:26.597

我得出的结论是，唯一的方法是遍历 csv/xml，在数据库事务的帮助下，这不会花费很长时间。

使用固定模式还可以大大提高性能，因为属性包必须进行列插入（因此，如果您有很多列 - 每条记录有很多插入）。

同样在 Rhomobile 中，垃圾收集已关闭，因此如果您尝试处理大型数据集，您的设备将很快耗尽内存：

```
GC.enable 
```

以上解决了这个问题

# python - Python中的Karatsuba算法

> ID：10392511
> 
> 赞同：2
> 
> 时间：2012-05-01T01:30:52.537
> 
> 标签：python, algorithm, multiplication

所以我在python中实现了Karatsuba的乘法算法。现在我有无限递归，无法弄清楚。有任何想法吗？如果需要，我会提供更多代码。

```
 def multiply(self, other):

  # helper function
    def split(largeInt, n):
     least = largeInt._least_significant_digits(n/2)
     most = largeInt._right_shift(n/2)
     if debug: assert least.to_int() + (most.to_int() << (LargeInt.base_bits*(n/2))) == largeInt.to_int()
     return least, most
  n = max(len(str(self)),len(str(other)))
  if (n==1):
     return self.to_int() * other.to_int()
  else:
     aR, aL = split(self,n)
     bR , bL = split(other, n)
     x1 = aL.multiply(bL)
     x2 =aR.multiply(bR)
     a = aL.add(bL)
     b = aR.add(bR)
     x3=a.multiply(b)
  # code for recursive step here
  #return 1 # change this line with your implementation
  return  x1 * 10**n + (x3-x1-x2) * 10**(n/2) + x2 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-01T09:42:21.847

一些提示：

*   我不认为你对`a`,的价值观`b`是[你想要的](https://en.wikipedia.org/wiki/Karatsuba_algorithm)。
*   一个常见的错误通常是 split 不会返回严格较小的数字：请提供`_least_significant_digits`,的来源`_right_shift`。
*   当您的一个输入的长度为 1 而另一个不是时会发生什么？在这种情况下，1 位数字的拆分返回什么？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-01T15:04:54.217

我正在计算传入数字的最大长度，以这种方式修复它。

```
 n = max(len(self.digits),len(other.digits)) 
```

# algorithm - 需要帮助提出哈希函数算法

> ID：10392513
> 
> 赞同：0
> 
> 时间：2012-05-01T01:31:04.827
> 
> 标签：algorithm, hash

我正在研究一个哈希函数，它通过将该字符串映射到一个键来为给定的字符串提供一个“ID”。我需要使用的算法描述如下：

*   给定字符串`NOTE`，我们为每个字母分配一个值，例如：

    ```
    N = 14, O =15, T = 20, E = 5 
    ```

*   然后我们相乘和相加：

    ```
    14 * 32^3 + 15 * 32^2 + 20 * 32^1 + 5 * 32^0 
    ```

*   通过分解这个表达式，我们得到：

    ```
    ((14 * 32 + 15) * 32 + 20) * 32 + 5 
    ```

*   但是这个值可能会变得太大，所以我们在每组括号之后使用 mod 除法：

    ```
    ((14 * 32 + 15)%tableSize *32 + 20)%tableSize * 32 + 5 
    ```

我怎样才能创建一个算法来完成这个？我曾尝试这样做，但我的实施效率极低。我的教授说它不应该超过7行。任何人都可以就如何有效地实现上述算法提供建议吗？

如果有人关心，我的算法是：

```
int HashDictionary::getKey(string word) const{
    int wordLength = word.length();
    int* values = new int[wordLength];
    for ( int i = 0; i < wordLength; i++ ) {
        values[i] = int(word[i]);
    }

    int productSoFar = 0;
    for(int i = 0; i < wordLength;i++){
        productSoFar *= 32;

        if(i == 0){
            productSoFar = values[i] * 32;
            productSoFar = productSoFar + values[i+1];
            productSoFar %= tableSize;
            i++;
        }
        else{
            productSoFar += values[i];
            productSoFar %= tableSize;
        }

    }
    delete [] values;
    return productSoFar;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-01T01:35:40.727

你不应该需要 2 个循环；因为第一个所做的唯一事情是将字符转换为整数，您可以根据需要翻译每个字符，并完全避免使用 values 数组。这应该加快速度并减少您的行数。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-01T01:41:57.410

尝试这个：

```
int HashDictionary::getKey(string word) const{
    int wordLength = word.length();
    int* values = new int[wordLength];
    values[0] = int(word[0]);
    values[1] = int(word[1]);

    int productSoFar = 0;
    productSoFar = values[0] * 32;
    productSoFar = productSoFar + values[1];
    productSoFar %= tableSize;

    for(int i = 1; i < wordLength;i++){
        productSoFar *= 32;
        productSoFar += values[i];
        productSoFar %= tableSize;
        values[i] = int(word[i]);
        }
    delete [] values;
    return productSoFar;
} 
```

# php - XML 到数组 - 基于一个子元素对数组结果进行分组

> ID：10392514
> 
> 赞同：0
> 
> 时间：2012-05-01T01:31:41.927
> 
> 标签：php, arrays, grouping, sorting

我有一个 XML 转换为数组没有问题，原始 XML 看起来像这样。

```
<somedata>data</somedata>
<somedata2>data2</somedata2>
<level1>
   <listings>
     <element>
        <title>AAA</title>
        <description>DescriptionA</description>
        <moredata>
          <adate>2012/12/12</adate>
        </moredata>
     </element>

     <element>
        <title>AAA</title>
        <description>DescriptionA</description>
        <moredata>
          <adate>2013/10/12</adate>
        </moredata>
     </element>

     <element>
        <title>BBB</title>
        <description>DescriptionB</description>
        <moredata>
          <adate>2012/09/01</adate>
        </moredata>
     </element>
   </listings>
<level1> 
```

当然到目前为止一切看起来都很好，我得到了包含所有子对象的漂亮数组，但我需要通过将元素分组来创建 HTML 输出，例如标题，考虑到我的输出看起来像这样。

```
Title: AAA
Description: DescriptionA
Date 1: 2012/12/12
Date 2: 2013/10/12

Title: BBB
Description: DescriptionB
Date 1: 2012/09/01 
```

请注意，我已将重复的 AAA 分组并在同一结果中列出了两个日期。

如何在 PHP 中，我认真考虑保存到 mysql 然后将它们拉回来，但这只是一个糟糕的补丁。

希望任何人都可以提供帮助。

问候

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-01T02:00:00.683

这是一个粗略的概念，我该怎么做。

您必须使用[simplexml](http://php.net/manual/en/simplexml.examples-basic.php)将 xml 解析为一个数组，然后您可以自定义您的 html 输出。

```
$result = array();

foreach($xml->element as $element){

   $line = array();
   $line['date'] = $element->date;
   $line['description'] = $element->description;

   $result[$element->title]['line'][] = $line;

} 
```

# django - Django 打印状态不起作用

> ID：10392517
> 
> 赞同：0
> 
> 时间：2012-05-01T01:32:25.200
> 
> 标签：django, django-admin, python-2.7

我已经尝试了很多，但无法弄清楚为什么会这样，

```
class FortressUserAdmin(admin.ModelAdmin):    
    list_display(. . . , get_my_schema)

    def get_my_schema(self, obj):
        sql_query = "select prop_val from customer_property where customer_id = %d and property_value like '%%%%SCHEMA%%%%'" % obj.customer_id.customer_id    
        property_value = connection.cursor().execute(sql_query).fetch_one()        
        print sql_query        
        return 1
        # return "aditya"
    get_my_schema.short_description = 'Schema Instance' 
```

*   为什么列值总是`(None)`
*   为什么`print 1`or`print 'aditya'`不会向控制台打印任何内容

专栏管理网站的屏幕截图： ![在此处输入图像描述](../Images/85a66e5f0b5cd501cbd29909a8bcce10.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-01T15:33:39.510

使用该`fetchone()`功能而不是上面使用的功能..

# ruby-on-rails-3 - Rails 3.1、JQuery UI Datepicker、Simple_Form 和日期格式

> ID：10392521
> 
> 赞同：0
> 
> 时间：2012-05-01T01:32:55.700
> 
> 标签：ruby-on-rails-3, jquery-ui, activerecord, simple-form

我正在制作一个简单的日程安排应用程序。我正在尝试 simple_form，我已经实现了一个 JQuery Datepicker，它返回一个像 04/30/2012 这样的日期。

```
#_form.html.erb
<%= simple_form_for @workout, :html => { :class => 'form-horizontal' } do |f| %>
  <%= f.input :name %>
  <%= f.input :date, :as => :date_picker%>
    <%= f.input :time %>
    <%= f.button :submit %>
    <%= link_to t('.cancel', :default => t("helpers.links.cancel")),
                workouts_path %>
<% end %>

#application.js
$("input.date_picker").datepicker(); 
```

问题是这个日期被视为 DD/MM/YYYY 而不是 MM/DD/YYYY。我想保留原始格式，因为这样可以让事情更自然，但我无法弄清楚如何接受所​​需的日期格式。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-01T02:06:17.040

我相信您正在寻找[formateDate](http://docs.jquery.com/UI/Datepicker/%24.datepicker.formatDate)方法。

# cocoa-touch - 隐式动画不起作用

> ID：10392523
> 
> 赞同：0
> 
> 时间：2012-05-01T01:33:06.573
> 
> 标签：cocoa-touch, animation, core-animation, calayer, cakeyframeanimation

当我试图覆盖`position`属性上的隐式动画时，图层会快速闪烁到目标位置，然后开始我的显式动画：

```
CAKeyframeAnimation* animation = [CAKeyframeAnimation animation];
animation.path = path; // some CGPath
animation.duration = 1.0;

[newTopLayer setPosition:CGPointMake(x, y)]; // Setting final values for stickness
[newTopLayer addAnimation:animation forKey:@"position"]; 
```

似乎`position`密钥没有被覆盖。为什么？我试过了`CATransaction`，但仍然没有运气。

**更新**
进一步的调查表明，`newTopLayer`无论如何都不是隐含的动画。有关信息：它由`UIView`.

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-04T01:56:25.057

好的，就这么简单：如果 a`CALayer`由 支持`UIView`，则所有隐式动画都被禁用。如果您需要隐式动画，请为 a 的图层创建一个子`UIView`图层。

# java - 连接表上没有主复合键的 JPA @ManyToMany 关系

> ID：10392524
> 
> 赞同：1
> 
> 时间：2012-05-01T01:33:46.763
> 
> 标签：java, sql, jpa, playframework, ebean

我有一个实体 A，与实体 B 有 am:n 关系，但是对于每个 A，不仅可以有多个 B，而且还可以有多个完全相同的 B。

我尝试定义这样的关系：

```
@Entity
class A {
    @Id
    public Long id;

    @ManyToMany
    public List<B> bs = new ArrayList<B>();
} 
```

和

```
@Entity
class B {
    @Id
    public Long id;
} 
```

这给了我以下为连接表生成的 DDL：

```
create table a_b (
a_id                         bigint not null,
b_id                        bigint not null,
constraint pk_a_b primary key (a_id, b_id))
; 
```

DDL 很好，除了主复合键，因为这意味着一个 A 一次只能有一个特定的 B。我正在使用 ebean 持久性在 play framework 2.0 上执行此操作。有什么提示吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-01T07:50:32.533

你不能使用@ManyToMany，因为根据它的定义，它不允许你想要的重复。

您想要的是元素列表（如 JPA `@ElementCollection`）或保持模型中不相关的表并使用 Query 检索与 A 关联的 B。

我会链接到 ebeans 文档，但它是 PDF ... :(

# android - 如何使用条件为 ListView 生成字符串数组以确定字符串元素是否应该在列表中？

> ID：10392529
> 
> 赞同：0
> 
> 时间：2012-05-01T01:34:53.530
> 
> 标签：android, arrays, listview, if-statement, tabview

这是我在网站上的第一个问题，我希望它不会太尴尬。我正在为一款安卓游戏制作一个库存标签。我在课程开始时声明了静态变量，并根据变量是否满足要求（变量需要至少等于一个才能显示在清单中）我想生成一个填充的字符串数组一个清单，将向您显示您的库存中的内容。当我在 Eclipse 中编写代码时，它告诉我它没有错误，但是当我尝试在 Android 模拟器中运行它时，我得到一个错误并且必须强制退出。这是供参考的代码。

（抱歉，如果代码格式关闭。Nightly 有时是一个奇怪的浏览器。）

```
 public class Inventory extends Activity {
    public static String selection = null;
    public static String IronS = "Iron";
    public static String WoodS = "Wood";
    public static String StoneS = "Stone";
    public static String WaterS = "Water";
    public static String ShieldRS = "Shield Rim";
    public static String ShieldBS = "Shield Base";
    public static String ShieldS = "Shield";
    public static String BladeS = "Blade";
    public static String SwordHS = "Sword Handle";
    public static String SwordS = "Sword";
    public static String BreastS = "Breastplate";
    public static String GauntS = "Gauntlets";
    public static String GreaveS = "Greaves";
    public static String RuneS = "Rune(s)";
    public static String FishingPS = "Fishing Pole";
    public static String PickS = "Pickaxe";
    public static String PickHS = "Pickaxe Head";
    public static int water = 1;
    public static int iron = 1;
    public static int stone = 1;
    public static int wood = 1;
    public static int shieldr, shieldb, shield, sword, swordh, blade, breast, gaunt, greave, rune, fishingp, pick, pickh;

    public static String[] CONTENTS;
    public static String[] MENU;

    public static int getWater() {
        return water;
    }
    public static void setWater(int water) {
        Inventory.water = water;
    }

    public static int getIron() {
        return iron;
    }
    public static void setIron(int iron) {
        Inventory.iron = iron;
    }

    public static int getWood() {
        return wood;
    }
    public static void setWood(int wood) {
        Inventory.wood = wood;
    }

    public static int getStone() {
        return water;
    }
    public static void setStone(int stone) {
        Inventory.stone = stone;
    }

    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
            if (getWater()>1)
                CONTENTS = new String []
                        {WaterS};
            if (getIron()>1)
                CONTENTS = new String []
                        {WaterS,IronS};
            if (getWood()>1)
                CONTENTS = new String []
                        {WaterS,IronS,WoodS};
            if (getStone()>1)
                CONTENTS = new String []
                        {WaterS,IronS,WoodS,StoneS};
            if (shieldr>1)
                CONTENTS = new String []
                        {WaterS,IronS,WoodS,WaterS,ShieldRS};
            if (shieldb>1)
                CONTENTS = new String []
                        {WaterS,IronS,WoodS,WaterS,ShieldRS,ShieldBS};
            if (shield>1)
                CONTENTS = new String []
                        {WaterS,IronS,WoodS,WaterS,ShieldRS,ShieldBS,ShieldS};
            if (sword>1)
                CONTENTS = new String []
                        {WaterS,IronS,WoodS,WaterS,ShieldRS,ShieldBS,ShieldS,SwordS};
            if (swordh>1)
                CONTENTS = new String []
                        {WaterS,IronS,WoodS,WaterS,ShieldRS,ShieldBS,ShieldS,SwordS,SwordHS};
            if (blade>1)
                CONTENTS = new String []
                        {WaterS,IronS,WoodS,WaterS,ShieldRS,ShieldBS,ShieldS,SwordS,SwordHS,BladeS};
            if (breast>1)
                CONTENTS = new String []
                        {WaterS,IronS,WoodS,WaterS,ShieldRS,ShieldBS,ShieldS,SwordS,SwordHS,BladeS,
                         BreastS};
            if (gaunt>1)
                CONTENTS = new String []
                        {WaterS,IronS,WoodS,WaterS,ShieldRS,ShieldBS,ShieldS,SwordS,SwordHS,BladeS,
                         BreastS,GauntS};
            if (greave>1)
                CONTENTS = new String []
                        {WaterS,IronS,WoodS,WaterS,ShieldRS,ShieldBS,ShieldS,SwordS,SwordHS,BladeS,
                         BreastS,GauntS,GreaveS};
            if (rune>1)
                CONTENTS = new String []
                        {WaterS,IronS,WoodS,WaterS,ShieldRS,ShieldBS,ShieldS,SwordS,SwordHS,BladeS,
                         BreastS,GauntS,GreaveS,RuneS};
            if (fishingp>1)
                CONTENTS = new String []
                        {WaterS,IronS,WoodS,WaterS,ShieldRS,ShieldBS,ShieldS,SwordS,SwordHS,BladeS,
                         BreastS,GauntS,GreaveS,RuneS,FishingPS};
            if (pick>1)
                CONTENTS = new String []
                        {WaterS,IronS,WoodS,WaterS,ShieldRS,ShieldBS,ShieldS,SwordS,SwordHS,BladeS,
                         BreastS,GauntS,GreaveS,RuneS,FishingPS,PickS};
            if (pickh>1)
                CONTENTS = new String []
                        {WaterS,IronS,WoodS,WaterS,ShieldRS,ShieldBS,ShieldS,SwordS,SwordHS,BladeS,
                         BreastS,GauntS,GreaveS,RuneS,FishingPS,PickS,PickHS};
            if (stone>1)
                CONTENTS = new String []
                        {WaterS,IronS,WoodS,WaterS,ShieldRS,ShieldBS,ShieldS,SwordS,SwordHS,BladeS,
                         BreastS,GauntS,GreaveS,RuneS,FishingPS,PickS,PickHS,StoneS};
            Arrays.sort(CONTENTS);
    }

} 
```

当我删除 if 语句并离开数组时，没有问题。它像往常一样编译，我可以将数组插入 ListView。我一直在努力解决这个问题，并尝试使用 switch/case 语句而不是 ifs，但它不能正常工作（不会将多个变量考虑在内）。if-else-if 不起作用，因为如果找到真值，语句将不会继续前面的条件。

我对此很陌生，所以我不知道如何先行。如果没有条件评估项目是否“存在”（在游戏中），我想不出另一种填充库存列表的方法。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-01T04:44:10.983

你有一个逻辑错误而不是语法错误。

这些整数为空

```
public static int shieldr, shieldb, shield, sword, swordh, blade, breast, gaunt, greave, rune, fishingp, pick, pickh; 
```

你正在尝试评估它们

```
if (shieldr>1)
                CONTENTS = new String []
                        {WaterS,IronS,WoodS,WaterS,ShieldRS};
            if (shieldb>1)
                CONTENTS = new String []
                        {WaterS,IronS,WoodS,WaterS,ShieldRS,ShieldBS};
            if (shield>1)
                CONTENTS = new String []
                        {WaterS,IronS,WoodS,WaterS,ShieldRS,ShieldBS,ShieldS};

...
... 
```

这将引发空异常，您的变量需要值才能在表达式中使用它们。

玩得开心 ！

# asp.net - AJAX 日历扩展器不工作

> ID：10392537
> 
> 赞同：1
> 
> 时间：2012-05-01T01:35:40.193
> 
> 标签：asp.net, calendarextender

我在我的网站上使用 ajax 日历扩展器。

```
 <table border="0" cellpadding="0" cellspacing="0">
                                        <tr>
                                            <td>Active From: <asp:TextBox ID="inputActiveFromDate" runat="server"></asp:TextBox> 
                                                <cc1:CalendarExtender ID="CalendarExtender1" runat="server" TargetControlID="inputActiveFromDate" PopupButtonID="btn_Calendar1"   Format="dd/MM/yyyy 00:00:00"></cc1:CalendarExtender>
                                                <asp:ImageButton runat="server" ID="btn_Calendar1" ImageUrl="../images/buttons/Lock_icon.gif" />
                                            </td>
                                            <td width="20"></td>
                                            <td>Active Until: <asp:TextBox ID="inputActiveUntilDate" runat="server"></asp:TextBox>
                                                <cc1:CalendarExtender ID="CalendarExtender2" runat="server" TargetControlID="inputActiveUntilDate"  PopupButtonID="btn_Calendar2"  Format="dd/MM/yyyy 23:59:59"></cc1:CalendarExtender>
                                                <asp:ImageButton runat="server" ID="btn_Calendar2" ImageUrl="../images/buttons/Lock_icon.gif" />
                                            </td>
                                        </tr>
                    </table> 
```

一切正常，但我在所有浏览器上都收到此错误。

```
> Unable to set value of the property 'PopupBehavior': object is null or
> undefined 
```

请帮我解决

错误来了

```
// Name:        MicrosoftAjax.debug.js
// Assembly:    AjaxControlToolkit
// Version:     4.1.50508.0
// FileVersion: 4.1.50508
// (c) 2010 CodePlex Foundation

initialize: function Behavior$initialize() {
        Sys.UI.Behavior.callBaseMethod(this, 'initialize');
        var name = this.get_name();
        if (name) this._element[name] = this;// error place <---
    }, 
```

我的 CS 代码：

```
using (SqlConnection conn = new SqlConnection(ConfigurationManager.ConnectionStrings["DBConn"].ToString())){

String  sql = "INSERT INTO tablename (SDate,EDate) VALUES ('" + Convert.ToDateTime(inputActiveFromDate.Text) + "','" + Convert.ToDateTime(inputActiveUntilDate.Text) + "'); SELECT  @@IDENTITY;";conn.Open();
                    SqlCommand comm = new SqlCommand(sql, conn);    
                    comm.ExecuteNonQuery();
                   // int lastId = Convert.ToInt32(comm.ExecuteScalar());
                    conn.Close();

                } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-01T01:39:24.810

我相信问题是因为您使用 PopupButtonID 选项并传入文本框 id

您要么需要删除此选项，要么传入实际按钮的 id

```
<asp:TextBox ID="inputActiveUntilDate" runat="server"></asp:TextBox>
<cc1:CalendarExtender ID="CalendarExtender2" runat="server" TargetControlID="inputActiveUntilDate" Format="dd/MM/yyyy 23:59:59"></cc1:CalendarExtender> 
```

或者

```
<asp:TextBox ID="inputActiveUntilDate" runat="server"></asp:TextBox>
<cc1:CalendarExtender ID="CalendarExtender2" runat="server" TargetControlID="inputActiveUntilDate" PopupButtonID="btn_Calendar" Format="dd/MM/yyyy 23:59:59"></cc1:CalendarExtender>
<asp:ImageButton runat="server" ID="btn_Calendar" ImageUrl="PathToACalendarButton" /> 
```

**编辑：**

我不太了解 sql 注入风险，但在我看来，在您的代码中绝对有可能。您可能需要考虑使用参数化查询，例如存储过程。

# php - PHP HTTP Header 发送 POST 数据

> ID：10392542
> 
> 赞同：1
> 
> 时间：2012-05-01T01:36:22.470
> 
> 标签：php, http-headers, postdata

有没有办法在没有 PHP 表单的情况下使用 HTTP 标头发送 POST 数据？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-01T01:43:46.187

当然，您可以使用 cURL 之类的库轻松创建具有指定 POST 参数的有效 http 请求。

有关curl 示例，请参见[this](http://www.electrictoolbox.com/php-curl-form-post/)

如果您仅限于纯 PHP，您可以创建自己的（有效）http 请求，请参阅[示例](http://www.ajaxapp.com/2010/03/15/php-how-to-http-post-without-using-curl/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-03T01:59:17.283

我不认为你可以。您可能想要使用会话、cookie、隐藏表单或 $_GET

# ruby-on-rails - 使用 Geocode Ruby Gem 输入用户地址

> ID：10392543
> 
> 赞同：0
> 
> 时间：2012-05-01T01:36:24.093
> 
> 标签：ruby-on-rails, geocoding

我使用 Geocode Ruby Gem 将用户输入的 zip/country 转换为格式良好的位置（例如，美国加利福尼亚州洛杉矶）。我还想在未来使用地理编码（以防你想知道为什么我要费这么多麻烦来修饰格式

我将一列“地址”迁移到用户数据库中。现在我被地理编码困住了，不知道是不是因为我没有在数据库中创建位置文件夹，而不是使用用户数据库迁移列。

**我收到路由错误：未定义的方法 `geocoded_by' for #**

我对这一切都很陌生，所以如果我没有任何意义，我很抱歉。

```
class Location < ActiveRecord::Base
  attr_accessible :address, :latitude, :longitude

 geocoded_by :full_address
 after_validation :geocode, :if => :address_changed? 
end 
```

这是我的控制器：

```
def full_address 
  @user = User.find(params[:address])
  Geocode.serach("@user")
end 
```

将我的 location.rb 更改为以下内容：

```
class Location < ActiveRecord::Base
extend ::Geocoder::Model::ActiveRecord 

  attr_accessible :address, :latitude, :longitude

  geocoded_by :address_for_geocode 
  reverse_geocoded_by :latitude, :longitude 
end 
```

导致以下错误：

```
Routing Error

uninitialized constant Location::Geocoder

Try running rake routes for more information on available routes. 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-01T21:13:41.820

很难在评论中提出建议，所以我会在回答中这样做，如果太长请见谅。请不要投反对票，我会在最后删除或编辑它。取决于它是否是真实的答案。

您收到路由错误，因为您不了解要更改什么以及如何更改代码。

第一的

```
class Location < ActiveRecord::Base

  attr_accessible :address, :latitude, :longitude
  # comment this out! => Geocoder.search("New York, NY, USA")
end 
```

在您的控制器方法中，只需尝试执行

```
def full_address 
  @user = User.find(params[:address])
  render :text => Geocoder.search("New York, NY, USA").inspect.to_s
end 
```

您将收到错误（如果您的应用程序中未加载 gem）或某些结果。

在我们尝试其他任何事情之前，让我们先弄清楚这一点。

再次运行 aaplication 并为**full_address**控制器操作执行该路由

顺便说一句，您可以在 Rails 控制台中尝试所有操作

> /path/to/project#rails c
> 
> irb> Geocoder.search("New York, NY, USA")

# == 更新 ===

尝试在定位模型中包含地理编码器

```
class Location < ActiveRecord::Base
  extend ::Geocoder::Model::ActiveRecord

  geocoded_by :address_for_geocode
  reverse_geocoded_by :latitude, :longitude
end 
```

我刚刚检查了他们 git 存储库中的源代码，他们没有扩展 ActivRecord::Base 所以你必须手动完成！！！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-12-18T07:23:36.483

请检查您的控制器

```
def full_address 
  @user = User.find(params[:address])
  Geocode.serach("@user")
end 
```

它应该是

```
def full_address 
  @user = User.find(params[:address])
  Geocode.search("@user")
end 
```

# ruby - 你如何从外部文件中提取数据，然后使用它？即访问url.txt中的5个网址

> ID：10392544
> 
> 赞同：0
> 
> 时间：2012-05-01T01:36:39.527
> 
> 标签：ruby, web-scraping, mechanize

我想访问文本文件中列出的每个 URL。

我有：

```
require 'mechanize'

File.open('sources.txt').each_line { |url|
  agent = Mechanize.new
  puts "Visiting #{url}"
  mypage = agent.get("#{url}")
  current_url = mypage.uri.to_s
  puts "The final URL is #{current_url}"
} 
```

此代码通过 中的 URL 运行`sources.txt`，告诉您它正在这样做，然后在到达页面后告诉您 URL。即如果`www.foo.com`在 中`source.txt`，但`www.foo.com`解析为`foo.com`（没有 WWW），它会告诉你。

如何将每个已解析/最终/当前 URL 保存到单个行分隔的文本文件中？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-01T15:21:14.260

知道了。

```
require 'mechanize'
agent = Mechanize.new

File.open('sources.txt').each_line do |url|
  puts "Visiting #{url}"
  mypage = agent.get("#{url}")
  @current_url = mypage.uri.to_s
  puts "The final URL is #{@current_url}"
File.open('output.txt', 'a') do |output| 
output.puts @current_url
end
 end 
```

对格式感到抱歉，我仍然对在哪里放置缩进感到尴尬。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-01T06:46:04.603

如果要附加到文件，请使用“a”标志而不是“w”。标志在这里[http://www.ruby-doc.org/core-1.9.3/IO.html](http://www.ruby-doc.org/core-1.9.3/IO.html)

```
50.times do |n|
  File.open 'destinations.txt', 'a' do |file|
    file.write "line #{n}\n"
  end
end 
```

更新（对您的代码进行一些重构）：

```
require 'mechanize'
agent = Mechanize.new

output = File.open 'output.txt', 'a'
File.open('sources.txt').each_line do |url|
  puts "Visiting #{url}"
  mypage = agent.get("#{url}")
  @current_url = mypage.uri.to_s
  puts "The final URL is #{@current_url}"
  output.puts @current_url
end
output.close 
```

这样，您将打开每个文件一次。

# java - 自定义配置文件 - 玩！框架 2.0

> ID：10392545
> 
> 赞同：7
> 
> 时间：2012-05-01T01:36:42.877
> 
> 标签：java, file, playframework-2.0, custom-configuration

我有一个关于从自定义配置文件加载属性的问题。我尝试了两种不同的方法来加载我的`oauth.properties`文件，但我都无法工作，所以我希望这里有人可以帮助我。

我尝试的第一种方法是将文件添加到 conf 目录并因此引用它：

```
String oauthPropertiesFile = ClassLoader.getSystemResource("oauth.properties").getFile(); 
```

但这才回来`NULL`。

我尝试的第二种方法是添加：

```
@include.oauthProperties = oauth.properties 
```

到该`application.conf`文件，然后在我的控制器中引用它，例如：

```
String clientId = oauthProperties.clientId; 
```

但是，这不会编译。

谁能阐明我在这里做错了什么？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2012-08-08T14:47:03.303

对我有用的文件是`/conf`：

```
import com.typesafe.config.ConfigFactory

val myConfig = ConfigFactory.load("myfile.properties").getConfig("my.config.prefix") 
```

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2012-05-01T15:31:12.523

我不确定 conf 是否是类路径的一部分。所以我会尝试`/conf/oauth.properties`或将文件放入类路径中。此外，您应该使用`Play.application.classloader()`而不是 Classloader。

关于包括：我仍然认为您需要致电`Play.application().configuration().get("clientID");`

要分析情况，您可以使用 启动应用程序`-Dconfig.trace=loads`并使用 分析配置`Play.application().configuration().root().render()`。

希望这能给您足够的提示，以便您解决问题。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2014-01-18T15:04:38.833

在一般情况下，要从“/conf”目录中获取任何文件，使用 Play 2.2 可以按如下方式完成（注意“/conf”在类路径中，因此您不应包含它）。

```
Play.application().classloader().getResource("any_file"); 
```

* * *

## 回答 #4

> 赞同：-2
> 
> 时间：2015-11-27T07:59:41.263

如果你想使用`scala.io.Source`你也可以做类似的事情

```
Source.fromFile(Play.getFile("path-in-your-play-project")) 
```

# java - 在paintComponent() 中绘制的图形立即丢失

> ID：10392547
> 
> 赞同：3
> 
> 时间：2012-05-01T01:36:57.983
> 
> 标签：java, swing, paintcomponent

我是 Java、Swing 和 GUI 编程的新手，所以我可能错过了一些关于使用 Swing 和背后的线程模型构建 GUI 的中心点。我正在尝试的练习包括一个用于在画布上创建、移动和调整图形大小的小应用程序。此外，我试图让 View 尽可能无行为，而 Presenter 对象负责注入所需的行为。换句话说，我不希望 View 知道图形或它们必须如何绘制，它只是为 Presenter 提供了一个 setUpdater() 方法来提供一个对象，该对象知道必须绘制什么才能表示一个状态模型。

但是我发现了一个问题：在某些情况下，数字会丢失。例如，如果我对应用程序窗口进行图标化然后去图标化。我以为我的画布组件的paintComponent() 没有被调用，但是断点告诉我问题是不同的：它被调用并且图形被绘制，但随后消失了。

我试图简化我的代码以在没有按钮、滑块甚至模型的情况下显示问题。但是，我为 View 和 Presenter 保留了单独的类，因为这种分离对我的目的很重要。

在我正在测试简化示例的机器中，调用paintComponent 时绘制的图形（始终是同一个圆圈）不仅在去图标化后消失，而且每次绘制时都会消失。

请帮助我了解正在发生的事情......以及如何解决它。

蒂亚。

PS1：简化代码如下：

```
import java.awt.*;
import javax.swing.*;

interface ViewUpdater {
    void updateCanvas(Graphics2D g2d);
}

class View {
    private JFrame windowFrame;
    private JPanel canvasPanel;
    private ViewUpdater updater;
    public static final Color CANVAS_COLOR = Color.white;
    public static final int CANVAS_SIDE = 500;

    public View() {
        windowFrame = new JFrame();
        windowFrame.
            setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
        canvasPanel = new JCanvas();
        canvasPanel.setBackground(CANVAS_COLOR);
        canvasPanel.
            setPreferredSize(new Dimension(CANVAS_SIDE,
                                           CANVAS_SIDE));
        windowFrame.getContentPane().add(canvasPanel);
        windowFrame.pack();
        windowFrame.setResizable(false);
    }

    public void setVisible() {
        windowFrame.setVisible(true);
    }

    public void setUpdater(ViewUpdater updater) {
        this.updater = updater;
    }

    public void updateView() {
        System.out.println("BEGIN updateView");
        Graphics2D g2d =(Graphics2D) canvasPanel.getGraphics();
        g2d.setColor(CANVAS_COLOR);
        g2d.fillRect(0, 0, CANVAS_SIDE, CANVAS_SIDE);
        if (updater != null) {
            System.out.println("GOING TO updateCanvas");
            updater.updateCanvas(g2d);
        }
        System.out.println("END updateView");
   }

    private class JCanvas extends JPanel {

        private static final long serialVersionUID =
                                    7953366724224116650L;

        @Override
        protected void paintComponent(Graphics g) {
            System.out.println("BEGIN paintComponent");
            super.paintComponent(g);
            updateView();
            System.out.println("END paintComponent");
        }
    }
}

class Presenter {
    private View view;
    private static final Color FIGURE_COLOR = Color.black;

    public Presenter(View view) {
        this.view = view;
        this.view.setUpdater(new ProjectViewUpdater());
        this.view.setVisible();
    }

    private class ProjectViewUpdater
        implements ViewUpdater {
        @Override
        public void updateCanvas(Graphics2D g2d) {
            g2d.setColor(FIGURE_COLOR);
            g2d.drawOval(100, 100, 300, 300);
            // The circle immediately disappears!
        }
    }
}

public class Main {
    public static void main(String[] args) {
        new Presenter(new View());
    }
} 
```

PS2：我正在阅读[http://www.javaworld.com/javaworld/jw-08-2007/jw-08-swingthreading.html](http://www.javaworld.com/javaworld/jw-08-2007/jw-08-swingthreading.html)以了解使用Swing所涉及的线程模型，但我仍然没有做任何特别的事情用于控制我的代码中的线程。

PS3：我没有找到我的问题的答案，最相似的问题可能是[http://www.eclipse.org/forums/index.php/t/139776/](http://www.eclipse.org/forums/index.php/t/139776/)中未回答的问题。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-01T02:03:14.803

您的问题是您通过调用`getGraphics()`JPanel 来获取 Graphics 对象，并且由此获得的任何 Graphics 对象都不会持久，因此用它绘制的任何东西同样会在下一次重绘时消失。

解决方案：不要这样做。任何一个

*   使用 JVM 提供给 paintComponent 方法的 Graphics 对象进行绘制，或者
*   在 BufferedImage 上调用`getGraphics()`或`createGraphics()`以获取其 Graphics 或 Graphics2D 对象，用 this 绘制，处理它，然后`paintComponent(...)`使用 JVM 传入的 Graphics 对象再次在 JComponent 或 JPanel 的方法中绘制 BufferedImage。

对于您的情况，我认为您最好使用 BufferedImage 或上面的第 2 点。

# php - 计算：循环中的复杂查询与 PHP 函数调用

> ID：10392555
> 
> 赞同：1
> 
> 时间：2012-05-01T01:38:28.490
> 
> 标签：php, mysql, sql

我有一个这样的查询：

```
 Select E.ID, E.NAME, 
     date_format(  CONVERT_TZ( CONVERT_TZ( E.ST, '+00:00', '+5:00' ),
     '+00:00', if( ET.GT LIKE '%.5', REPLACE( ET.GT, '.5', ':30' ) , CONCAT( ET.GT, ':00')
  ) ), '%Y-%m-%e %r'), concat( date_format(  CONVERT_TZ( CONVERT_TZ( E.ET, '+00:00', 
  '+5:00' ) ,   '+00:00', if( ET.GT LIKE '%.5', REPLACE( ET.GT, '.5', ':30' ) , CONCAT( 
  ET.GT, ':00' ) ) ), '%Y-%m-%e %r') , ' ', if ( TC is NULL, '', concat(TC, 'T'))),
  EE.CL, EC.EC, CONCAT( '##PATH##', E.ID, '/') 
```

这些字段是从 4 个不同的表中提取的。条件、格式设置等是将日期从东部转换为每个表中的每个设置的特定时区。

当然不是一个好看的查询:-)。这是原因，我正在尝试在查询中做所有这些古怪的事情。

1.  这些结果作为数组返回，然后编码为 JSON 并发送回调用者。
2.  我不必遍历 PHP 中的结果。我可以按原样传递结果。
3.  我不必担心我不需要的额外列。我只能拉出需要的列。

这对我来说非常有用！

但是，从性能和其他设计角度来看：

问题：保持原样好还是我需要考虑在 PHP 上进行处理？当我消除查询中的复杂性（If、Convert_Tz 等）时，我将不得不做两件事

1.  遍历返回的数组并调用函数来计算时区。
2.  删除不必要的数组元素。

你的意见？

编辑：

以下是联接：

```
 LEFT JOIN eeemps EER ON e.id = EER.eid
 LEFT JOIN eemp Ee ON eer.empid = ee.empid
 LEFT JOIN EclassS EC ON E.EVN = EC.E_ID 
 LEFT JOIN E_tz NE ET ON E.TZID = ET.ID

 where date between x and y, and e_id = 123 
```

这就是 cond 的所有“位置”。忽略表名和字段名。我改变了它们。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-09T14:08:07.273

您服务器的 PHP 部分可能已经完成了一些不错的工作，因此在 MySQL 中尽最大可能是处理问题的正确方法。而且，MySQL方式比PHP快100倍99倍。并且不用担心大型查询。如果可能的话，对代码进行一些生成（例如连接），并记住格式化对于使困难的事情变得更容易非常重要。

# sql - Hibernate 4.1.2.FINAL 禁用上下文 LOB 创建，因为 createClob() 方法抛出错误，Blob 字段

> ID：10392560
> 
> 赞同：3
> 
> 时间：2012-05-01T01:38:57.153
> 
> 标签：sql, hibernate, postgresql, jpa

我想用 hibernate/postgresql 9.1.1 创建一个 BLOB 字段

为什么我在日志中看到此消息：

```
INFO  [org.hibernate.engine.jdbc.internal.LobCreatorBuilder] (MSC service thread 1-5)
HHH000424: Disabling contextual LOB creation as createClob() method threw error : 
java.lang.reflect.InvocationTargetException 
```

我知道这不是错误。

休眠 4.1 文档：

```
"@Lob indicates that the property should be persisted in a Blob or a Clob depending
on the property type: java.sql.Clob, Character[], char[] and java.lang.String will be
persisted in a Clob. java.sql.Blob, Byte[], byte[] and Serializable type will be persisted in a Blob." 
```

我这样声明我的领域：

```
@Lob
@Type(type = "org.hibernate.type.MaterializedClobType")
@Basic(fetch=javax.persistence.FetchType.LAZY)
@Column(name = "`ACTA_CERTIFICACION`")
public byte[] getActacertificacion() {
    return actacertificacion;
}
/**
 * @param actacertificacion
 * @uml.property  name="actacertificacion"
 */
public void setActacertificacion(byte[] actacertificacion) {
    this.actacertificacion = actacertificacion;
} 
```

但在数据库中，它的创建就像一个文本字段：

```
"ACTA_INCREMENTOSUSTITUCION" text 
```

我能做什么？，我想创建一个字节字段或类似的东西。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-01T12:12:10.013

由于您`text`在数据库中使用，您应该`CLOB`在 POJO 类中使用类型。如果你想映射它，只需在你的 POJO 中添加一个属性，如下所示，

```
@Column(name="ACTA_INCREMENTOSUSTITUCION")
@Clob
private Clob tect; 
```

现在，根据您的要求，您可以将此**Clob**转换为**byte[]**，如此[处](https://stackoverflow.com/a/9058813/507864)所述。

# java - Java 初始化

> ID：10392561
> 
> 赞同：1
> 
> 时间：2012-05-01T01:39:18.870
> 
> 标签：java

我已经多次遇到此代码，我想知道它的含义或等效于：

```
A a = new A() {
  // declare some methods and whatever
}; 
```

以上是什么意思？它等同于什么（如果它等同于任何东西）？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-01T01:40:46.820

他们声明了一个[匿名类](http://docstore.mik.ua/orelly/java-ent/jnut/ch03_12.htm)。类`A`（可能）是接口或抽象类，必须具有实现的方法才能成为`A`. Java 允许您使用匿名类动态定义这些方法。

例如，只有一种方法可以实现 for `ActionListener`，即`actionPerformed(ActionEvent)`. 很多时候，在匿名类中定义该方法更容易，如下所示：

```
ActionListener myListener = new ActionListener() {
  @Override
  public void actionPerformed(ActionEvent e) {
    Object source = e.getSource();
    // do other stuff for action performed
  }
} 
```

***根据OP的评论进行编辑***

您当然可以为一个类创建一个类文件`ActionListener`并创建一个类的新实例，而不是创建一个匿名类。也就是说，假设您可以在单独的课程中完成您需要做的所有事情。很多时候定义了匿名类和内部类，以便您可以访问外部类的字段和方法。如果内部类“属于”外部类而不属于其他类，那么定义内部类或匿名类也是面向对象的许多倍。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-05-01T01:43:49.463

它正在创建一个匿名内部类：`a`不是`A`自身的实例，而是新创建的子类的实例`A`，就好像你写了类似的东西

```
public class MadeUpName extends A {
    ...
}
A a = new MadeUpName(); 
```

但不必编造一个`MadeUpName`并且用更少的措辞。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-05-01T02:02:59.883

这是一个匿名类。虽然我从未广泛使用过它们，但它们对于您只使用一次类或不想用不会被重用的东西“污染”您的顶级类层次结构的情况很方便.

您可以将它们放在一个类中（使用标准的*public、private、protected*关键字）或类方法（内部类）。

我找不到一个非常好的、简洁的文章/教程，但这没关系：

[简而言之，来自 java 的匿名类](http://docstore.mik.ua/orelly/java-ent/jnut/ch03_12.htm)

有关的：

*   [声明匿名内部类](https://stackoverflow.com/questions/5511864/declaring-anonymous-inner-class)
*   [匿名类问题](https://stackoverflow.com/questions/1758189/anonymous-class-question)
*   [匿名类问题](https://stackoverflow.com/questions/1758189/anonymous-class-question)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-05-01T01:40:34.987

这是扩展/实现类/接口 A 的匿名类的实例化。

# ios - 用户登录控制

> ID：10392564
> 
> 赞同：0
> 
> 时间：2012-05-01T01:40:02.227
> 
> 标签：ios, user-interface

我只是想找出处理这个问题的最佳方法。我想要的是一个用户登录控件，一旦用户登录，它就会直接将他们带到他们的“用户管理”区域。但是如果用户关闭应用程序，它会让他们重新登录。我希望他们关闭应用程序并让它直接进入用户管理页面。

是否有一个框架或 API 可以用来帮助我完成我需要的事情？如果没有，处理这个问题的最佳方法是什么？现在我正在使用带有加密的 SOAP 来处理登录连接。我是否应该在每次启动应用程序时存储用户名和密码并重新连接？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-01T01:44:46.467

对于加密数据，将用户名和密码存储在钥匙串中是您最安全的选择。然后可以通过从钥匙串中收集值并执行另一个 SOAP 请求来建立重新连接。

我承认，钥匙串文档和 API 令人困惑，但它是手机上最安全的地方。幸运的是，有很多关于这个主题的[教程。](https://developer.apple.com/library/mac/documentation/security/Conceptual/keychainServConcepts/iPhoneTasks/iPhoneTasks.html)

# postgresql - PostgreSQL 将数据从递归 CTE 传递到函数

> ID：10392567
> 
> 赞同：3
> 
> 时间：2012-05-01T01:40:41.320
> 
> 标签：postgresql, graph, transitive-closure-table, recursive-cte

我有以下问题：我正在尝试发现从源节点（**node_s**）到目标节点（**node_t**）的所有可能路径。

带有图边的原始表格的格式很简单：**| 节点_x | 节点_y | 实力 |** ，其中“node_x”->“node_y”是直接边，边的强度为“权重”。

这个想法是，如果在探索路径期间的任何时候，我们发现其子节点中的一个节点具有目标**node_t**，我们记录该路径并停止从该节点探索路径，否则继续探索。

简单的解决方案是使用 PostgreSQL 的递归 CTE，它构造图的传递闭包：

```
 WITH RECURSIVE transitive_closure (source, target, weight, path_string) AS
  ( 
   --non-recurive term
   SELECT b.node_x, b.node_y, b.strength, b.node_x || '.' || b.node_y || '.' AS path_string
   FROM best_path b
   WHERE b.node_x = node_s --source_node

   UNION

   --recurive term
   SELECT tc.source, b.node_y, least(tc.weight,b.strength), tc.path_string || b.node_y || '.' AS path_string
   FROM best_path AS b JOIN transitive_closure AS tc ON b.node_x = tc.target
   WHERE tc.path_string NOT LIKE '%' || b.node_y || '.%'
  )
  SELECT * 
  FROM transitive_closure tc
  WHERE tc.target = node_t --target_node 
```

上面的代码将从源节点**node_s**发现**所有**可能的路径。只有在传递闭包构造之后，我才能选择从源节点到目标节点的所需路径行（参见最后一个 SELECT 语句）。

 **例子：

best_path 表有以下数据：

```
 node_x | node_y | strength 
--------+--------+----------
      1 |      2 |        1
      1 |      3 |        1
      2 |      4 |        1
      2 |      5 |        1
      3 |      6 |        1
      3 |      7 |        1
      4 |      8 |        1
      4 |      9 |        1
      5 |     10 |        1
      5 |     11 |        1 
```

询问：

找到从源节点 = 1 到目标节点 = 4 的路径

结果：

```
 source | target | strength | path_string
--------+--------+----------+------------
      1 |      2 |        1 | 1.2.
      1 |      3 |        1 | 1.3.
      1 |      4 |        1 | 1.2.4.
      1 |      5 |        1 | 1.2.5.
      1 |      6 |        1 | 1.3.6.
      1 |      7 |        1 | 1.3.7.
      1 |      8 |        1 | 1.2.4.8.
      1 |      9 |        1 | 1.2.4.9.
      1 |     10 |        1 | 1.2.5.10.
      1 |     11 |        1 | 1.2.5.11. 
```

这不是我需要的。由于已经有从节点 2 到节点 4（目标）的直接边，我不需要路径 1.2.5.、1.2.4.8.、1.2.4.9.、1.2.5.10.、1.2.5.11.，路径探索对于节点 2，应该在发现从 2 到 4 的路径时停止。

总而言之，如果节点已经具有到目标节点的直接边缘，我不想发现节点的路径。这意味着在 CTE 的递归术语中，我希望有一些条件可以说明以下内容，伪代码如下：

```
 WITH RECURSIVE transitive_closure (source, target, weight, path_string) AS
  ( 
   --non-recurive term (as before)
   SELECT b.node_x, b.node_y, b.strength, b.node_x || '.' || b.node_y || '.' AS path_string
   FROM best_path b
   WHERE b.node_x = node_s --source_node

   UNION

   --recurive term
   SELECT tc.source, b.node_y, least(tc.weight,b.strength), tc.path_string || b.node_y || '.' AS path_string
   FROM best_path AS b JOIN transitive_closure AS tc ON b.node_x = tc.target
   WHERE tc.path_string NOT LIKE '%' || b.node_y || '.%'
     AND b.node_y = node_t 
     --will select only rows with direct edge to target

   UNION (second union is not allowed in CTE)

   SELECT those rows which do not have direct edge to target 
   AND which parents did not contribute to constructing the query above. 
   i.e. b.node_x = tc.target where there is no direct edge between b.node_x to node_t
  ) 
```

作为查找从源节点 = 1 到目标节点 = 4 的路径的查询的结果，我想要以下内容：

```
 source | target | strength | path_string
--------+--------+----------+------------
      1 |      2 |        1 | 1.2.
      1 |      3 |        1 | 1.3.
      1 |      4 |        1 | 1.2.4.
      1 |      6 |        1 | 1.3.6.
      1 |      7 |        1 | 1.3.7. 
```

在此先感谢您的帮助！

我已经尝试了很多方法：例如 FROM/WHERE 子句中的条件，尝试将 CTE 传递给函数，但没有成功。

任何建议将不胜感激。

我有自己的递归函数，可以实现我想要的，但是，在大量数据上它非常慢；而且 PostgreSQL 的 CTE 显然优化得很好，所以我想深入研究一下。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-01T04:51:18.993

如果从底部开始，您可以更有效地搜索路径。从孩子开始。如果从父节点开始，则需要遍历所有子节点；而如果你从孩子那里搜索，它只有一个父母，因此不会浪费时间寻找源和目标之间的路径。

```
with recursive find_parent(source, target, recentness) as
(
    select source, target, 0 
    from tbl
    where target = 9

    union all

    select i.source, i.target, fp.recentness + 1
    from tbl i
    join find_parent fp on i.target = fp.source
),
construct_path(source, target, recentness, path) as
(
  select source, target, recentness, source || '.' || target
  from find_parent 
  where recentness = (select max(recentness) from find_parent)

  union

  select dd.source, dd.target, dd.recentness, cp.path || '.' || dd.target
  from find_parent dd
  join construct_path cp on dd.recentness = cp.recentness - 1  
)
select source, target, path 
from construct_path
order by recentness desc 
```

输出：

```
SOURCE   TARGET   PATH
1        2        1.2
2        4        1.2.4
4        9        1.2.4.9 
```

现场测试：[http ://www.sqlfiddle.com/#!1/13e6b/1](http://www.sqlfiddle.com/#!1/13e6b/1)

与此类似：[How to get the parent given a child in SQL SERVER 2005](https://stackoverflow.com/questions/1104977/how-to-get-the-parent-given-a-child-in-sql-server-2005)

* * *

这是优化的，如果它已经找到特定的（源），则将递归削减到父级。

来源 = 2

目标 = 9

```
with recursive find_parent(source, target, recentness) as
(
    select source, target, 0 
    from tbl
    where target = 9

    union all

    select i.source, i.target, fp.recentness + 1
    from tbl i
    join find_parent fp on i.target = fp.source 
         -- despite the name, this target is another one's source
         and i.target <> 2
)
,construct_path(source, target, recentness, path) as
(
    select source, target, recentness, source || '.' || target
    from find_parent 
    where recentness = (select max(recentness) from find_parent)

    union

    select dd.source, dd.target, dd.recentness, cp.path || '.' || dd.target
    from find_parent dd
    join construct_path cp on dd.recentness = cp.recentness - 1  

)
select source, target, path
from construct_path
order by recentness desc 
```

输出：

```
SOURCE   TARGET  PATH
2        4       2.4
4        9       2.4.9 
```

现场测试：[http ://www.sqlfiddle.com/#!1/13e6b/16](http://www.sqlfiddle.com/#!1/13e6b/16)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-01T08:06:12.130

在重新阅读OP的问题后，我想出了这个解决方案：

**资源**

```
with recursive -- this denotes that at least one CTE is using recursion

inputs as ( select 1 as d_source, 4 as d_target )
,traverse_path(filter, source, target, path, bingo) as
(
  select bp.node_x, bp.node_x,  bp.node_y, bp.node_x || '.' || bp.node_y,

    max((bp.node_y = i.d_target)::int) over(partition by bp.node_x) ::bool  

  from best_path bp cross join inputs i
  where bp.node_x = i.d_source -- filter

  union

  select tp.filter, bp.node_x, bp.node_y, path || '.' || node_y,   

      max((bp.node_y = i.d_target)::int) over(partition by bp.node_x) ::bool   

  from best_path bp cross join inputs i
  join traverse_path tp on bp.node_x = tp.target
      and not tp.bingo
)    
select tp.*
from traverse_path tp cross join inputs i    
-- if Postgresql has Oracle KEEP windowing, 
-- we don't need to use WHERE clause here     
where 
  not tp.bingo   
  or
  (
    tp.bingo and tp.target = d_target
  ) 
```

上面的 WHERE 子句可以缩短为：

```
 WHERE not bingo or target = 4 
```

**输出：**

```
FILTER  SOURCE  TARGET  PATH    BINGO
1       1       2       1.2     0
1       1       3       1.3     0
1       2       4       1.2.4   1
1       3       6       1.3.6   0
1       3       7       1.3.7   0 
```

现场测试：[http ://www.sqlfiddle.com/#!1/cdde6/55](http://www.sqlfiddle.com/#!1/cdde6/55)

* * *

这是 Source = 2, Target = 5 的结果：

```
FILTER  SOURCE  TARGET  PATH    BINGO
2       2       5       2.5     1 
```

* * *

**数据：**

```
CREATE TABLE best_path
    (node_x int, node_y int, strength int);

INSERT INTO best_path
    (node_x, node_y, strength)
VALUES
    (1, 2, 1),
    (1, 3, 1),
    (2, 4, 1),
    (2, 5, 1),
    (3, 6, 1),
    (3, 7, 1),
    (4, 8, 1),
    (4, 9, 1),
    (5, 10, 1),
    (5, 11, 1); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-01T03:15:34.467

测试临时表：

```
CREATE TEMP TABLE best_path (node_x int, node_y int, strength int);
INSERT INTO best_path  VALUES
 (1, 2,  1)
,(1, 3,  1)
,(2, 4,  1)
,(2, 5,  1)
,(3, 6,  1)
,(3, 7,  1)
,(4, 8,  1)
,(4, 9,  1)
,(5, 10, 1)
,(5, 11, 1); 
```

查询：
[修改以容纳关于 2 - 5 的评论]

```
WITH RECURSIVE t AS (    -- for readability and convenience:
    SELECT 1 AS node_s   -- source_node
         , 4 AS node_t   -- target_node
    )
    , x AS (
    SELECT node_x
    FROM   t, best_path
    WHERE  node_y = node_t
    )
    , a AS  ( 
    SELECT b.node_x
         , b.node_y
         , b.strength AS weight
         , b.node_x || '.' || b.node_y || '.' AS path
    FROM   t, best_path b
    LEFT   JOIN x ON x.node_x = b.node_x
    WHERE  b.node_x = node_s
    AND    (x.node_x IS NULL                    -- no point with edge to target
            OR b.node_y = node_t)               -- except with target_node

    UNION ALL
    SELECT a.node_x
         , b.node_y
         , least(a.weight, b.strength)
         , a.path || b.node_y || '.' AS path
    FROM   t, a
    JOIN   best_path AS b ON b.node_x = a.node_y
    LEFT   JOIN x ON x.node_x = b.node_x
    WHERE  a.node_y <> node_t                   -- arrived at target
    AND    a.path !~~ ('%' || b.node_y || '.%') -- not visited yet
    AND    (x.node_x IS NULL                    -- no point with edge to target
            OR b.node_y = node_t)               -- except with target_node
    )
TABLE a; 
```

准确地产生所要求的结果。

我也在初始查询中添加了中断条件，因为我们只需一步即可到达目标。

这恰好很像[我对先前类似问题的回答](https://stackoverflow.com/a/8765594/939860)。所有解释和链接都适用。这里主要的附加技巧是包含一个额外的 CTE`x`来收集节点......

> (a) 对目标有直接优势。

用于在递归 CTE 的中断条件下重复使用。众所周知，无论关键字如何，您都可以在递归 CTE 之上添加额外的（非递归）CTE `RECURSIVE`。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-05-01T17:24:09.247

优化的解决方案，最终结果不再有 WHERE 子句；尽管是 Postgresql 特定的解决方案，即我们使用 DISTINCT ON 来选择特定的行：

鉴于此数据：

```
CREATE TABLE best_path
    (node_x int, node_y int, strength int);

INSERT INTO best_path
    (node_x, node_y, strength)
VALUES
    (1, 2, 1),
    (1, 3, 1),
    (2, 4, 1),
    (2, 5, 1),
    (3, 6, 1),
    (3, 7, 1),
    (4, 8, 1),
    (4, 9, 1),
    (5, 10, 1),
    (5, 11, 1),
    (5, 12, 1); 
```

查询，第一阶段，显示幕后（源 = 1，目标 = 11）：

```
with recursive -- this denotes that at least one CTE is using recursion

inputs as ( select 1 as d_source, 11 as d_target )
,traverse_path(filter, source, target, path, bingo, distincter) as
(
  select                      
      bp.node_x, bp.node_x,  bp.node_y, bp.node_x || '.' || bp.node_y      
      ,max((bp.node_y = i.d_target)::int) over(partition by bp.node_x) ::bool            
      ,coalesce(
               nullif(
                   max((bp.node_y = i.d_target)::int) 
                   over(partition by bp.node_x order by bp.node_x, bp.node_y = d_target desc, bp.node_y)
                   , 0)          
               ,bp.node_y)                           
  from best_path bp cross join inputs i
  where bp.node_x = i.d_source -- filter      
  union      
  select 
      tp.filter, bp.node_x, bp.node_y, path || '.' || node_y       
      ,max((bp.node_y = i.d_target)::int) over(partition by bp.node_x) ::bool        
      ,coalesce(
               nullif(
                   max((bp.node_y = i.d_target)::int) 
                   over(partition by bp.node_x order by bp.node_x, bp.node_y = d_target desc, bp.node_y)
                   , 0)          
               ,bp.node_y)                       
  from best_path bp cross join inputs i
  join traverse_path tp on bp.node_x = tp.target
      and not tp.bingo
)    
select tp.*
from traverse_path tp 
```

源 = 1，目标 = 11 的输出：[http ://www.sqlfiddle.com/#!1/db290/56](http://www.sqlfiddle.com/#!1/db290/56)

```
FILTER   SOURCE   TARGET   PATH     BINGO    DISTINCTER
1        1        2        1.2      0        2
1        1        3        1.3      0        3
1        2        4        1.2.4    0        4
1        2        5        1.2.5    0        5
1        3        6        1.3.6    0        6
1        3        7        1.3.7    0        7
1        4        8        1.2.4.8  0        8
1        4        9        1.2.4.9  0        9
1        5        11       1.2.5.11 1        1
1        5        10       1.2.5.10 1        1
1        5        12       1.2.5.12 1        1 
```

正如我们所见，目标 11 是源 5 中的第一行。这是怎么发生的？在我们的 DISTINCTER 列中，我们在 MAX 上使用 ORDER BY，这是对 MAX 窗口进行 ORDER 有意义的罕见情况之一。我们只是使用它来对结果进行排序。我尝试将 ORDER BY 放在查询的末尾，但数据库抱怨它不能在 CTE 上使用 ORDER。CTE 禁止放置 ORDER BY 子句。但众所周知，我们可以影响排序`OVER()`子句，这就是我们的结果如何排序。在上面的结果中，在 5 的源中，数字 11 排在 10 和 12 之前，因为 11 是我们的目标。因此，当我们执行`DISTINCT ON`（Postgresql 特定的功能）时，Postgres 将拾取第一行，因此它将拾取目标 11。

* * *

这是我们的最终查询，经过优化，虽然是针对 Postgresql 的：

```
with recursive -- this denotes that at least one CTE is using recursion    
inputs as ( select 1 as d_source, 11 as d_target )
,traverse_path(filter, source, target, path, bingo) as (
  select 
      distinct on (
        bp.node_x,            
        coalesce(
               nullif(
                   max((bp.node_y = i.d_target)::int) 
                   over(partition by bp.node_x order by bp.node_x, bp.node_y = d_target desc, bp.node_y)
                   , 0)          
               ,bp.node_y)
      )          
      bp.node_x, bp.node_x,  bp.node_y, bp.node_x || '.' || bp.node_y      
      ,max((bp.node_y = i.d_target)::int) over(partition by bp.node_x) ::bool  
  from best_path bp cross join inputs i
  where bp.node_x = i.d_source -- filter
  union
  select       
      distinct on (
        bp.node_x,            
        coalesce(
               nullif(
                   max((bp.node_y = i.d_target)::int) 
                   over(partition by bp.node_x order by bp.node_x, bp.node_y = d_target desc, bp.node_y)
                   , 0)          
               ,bp.node_y)
      )    
      tp.filter, bp.node_x, bp.node_y, path || '.' || node_y       
      ,max((bp.node_y = i.d_target)::int) over(partition by bp.node_x) ::bool  
  from best_path bp cross join inputs i
  join traverse_path tp on bp.node_x = tp.target
      and not tp.bingo
) select tp.* from traverse_path tp 
```

输出源 = 1，目标 = 11 [http://www.sqlfiddle.com/#!1/db290/55](http://www.sqlfiddle.com/#!1/db290/55)

```
FILTER   SOURCE   TARGET   PATH     BINGO
1        1        2        1.2      0
1        1        3        1.3      0
1        2        4        1.2.4    0
1        2        5        1.2.5    0
1        3        6        1.3.6    0
1        3        7        1.3.7    0
1        4        8        1.2.4.8  0
1        4        9        1.2.4.9  0
1        5        11       1.2.5.11 1 
```

* * *

源 = 1，目标 = 4 的输出：[http ://www.sqlfiddle.com/#!1/db290/53](http://www.sqlfiddle.com/#!1/db290/53)

```
FILTER  SOURCE  TARGET  PATH    BINGO
1       1       2       1.2     0
1       1       3       1.3     0
1       2       4       1.2.4   1
1       3       6       1.3.6   0
1       3       7       1.3.7   0 
```

源 = 2，目标 = 5 的输出：[http ://www.sqlfiddle.com/#!1/db290/54](http://www.sqlfiddle.com/#!1/db290/54)

```
FILTER  SOURCE  TARGET  PATH    BINGO
2       2       5       2.5     1 
```

* * *

* * *

另一种方法，而不是 BINGO 方法。使用 continue_search 作为继续遍历的逻辑。并使用 EVERY 聚合函数来确定我们是否需要继续遍历图。

这是它的工作原理：[http ://www.sqlfiddle.com/#!1/db290/84](http://www.sqlfiddle.com/#!1/db290/84)

最终查询：[http ://www.sqlfiddle.com/#!1/db290/85](http://www.sqlfiddle.com/#!1/db290/85)

有趣的是，每一个都非常像英语：

对比一下：

```
,max((bp.node_y = i.d_target)::int) over(partition by bp.node_x) ::bool 
```

使用 EVERY ：

```
,every(bp.node_y <> i.d_target) over(partition by bp.node_x) 
```

哪一个更容易阅读？

下面的输出说明了使用 EVERY 来促进 DISTINCT ON 的原理：

源 = 1，目标 = 5。**请注意，5**在属于同一源的其他数字之前首先排序，稍后将由 DISTINCT ON 选择。

```
FILTER    SOURCE    TARGET    PATH      CONTINUE_SEARCH     DISTINCTER
1         1         2         1.2       1                   2
1         1         3         1.3       1                   3
1         2         5         1.2.5     0                   0
1         2         4         1.2.4     0                   0
1         3         6         1.3.6     1                   6
1         3         7         1.3.7     1                   7 
```

这是执行该原则的查询：

```
with recursive -- this denotes that at least one CTE is using recursion

inputs as ( select 1 as d_source, 5 as d_target )
,traverse_path(filter, source, target, path, continue_search, distincter) as
(
  select                      
      bp.node_x, bp.node_x,  bp.node_y, concat(bp.node_x , '.' , bp.node_y )
      ,every(bp.node_y <> i.d_target) over(partition by bp.node_x)          
      ,coalesce(        
              cast(nullif(
                   every(bp.node_y <> i.d_target) 
                   over(partition by bp.node_x order by bp.node_x, bp.node_y = d_target desc, bp.node_y)
                   , true) as int)
               ,bp.node_y)                           
  from best_path bp cross join inputs i
  where bp.node_x = i.d_source -- filter      
  union      
  select 
      tp.filter, bp.node_x, bp.node_y, concat(path , '.' , node_y)
      ,every(bp.node_y <> i.d_target) over(partition by bp.node_x)    
      ,coalesce(
              cast(nullif(
                   every(bp.node_y <> i.d_target) 
                   over(partition by bp.node_x order by bp.node_x, bp.node_y = d_target desc, bp.node_y)
                   , true) as int)
               ,bp.node_y)                       
  from best_path bp cross join inputs i
  join traverse_path tp on bp.node_x = tp.target
     and tp.continue_search
)    
select tp.*
from traverse_path tp 
```

最终查询：

```
with recursive -- this denotes that at least one CTE is using recursion

inputs as ( select 1 as d_source, 5 as d_target )
,traverse_path(filter, source, target, path, continue_search) as
(
  select                      
      distinct on
      (
        bp.node_x
        ,coalesce(
              cast(nullif(
                   every(bp.node_y <> i.d_target) 
                   over(partition by bp.node_x order by bp.node_x, bp.node_y = d_target desc, bp.node_y)
                   , true) as int)
               ,bp.node_y)                       
      )    
      bp.node_x, bp.node_x,  bp.node_y, concat(bp.node_x , '.' , bp.node_y )
      ,every(bp.node_y <> i.d_target) over(partition by bp.node_x)          
  from best_path bp cross join inputs i
  where bp.node_x = i.d_source -- filter      
  union      
  select   
      distinct on
      (
        bp.node_x
        ,coalesce(
              cast(nullif(
                   every(bp.node_y <> i.d_target) 
                   over(partition by bp.node_x order by bp.node_x, bp.node_y = d_target desc, bp.node_y)
                   , true) as int)
               ,bp.node_y)                       
      )  
      tp.filter, bp.node_x, bp.node_y, concat(path , '.' , node_y)
      ,every(bp.node_y <> i.d_target) over(partition by bp.node_x)          
  from best_path bp cross join inputs i
  join traverse_path tp on bp.node_x = tp.target
     and tp.continue_search
)    
select tp.*
from traverse_path tp 
```

输出：

```
FILTER    SOURCE    TARGET    PATH      CONTINUE_SEARCH
1         1         2         1.2       1
1         1         3         1.3       1
1         2         5         1.2.5     0
1         3         6         1.3.6     1
1         3         7         1.3.7     1 
```**

# asp.net - ASP CSS 页面是否仍会像普通 CSS 页面一样被缓存？

> ID：10392575
> 
> 赞同：0
> 
> 时间：2012-05-01T01:41:08.027
> 
> 标签：asp.net, css, caching

我正在将样式表从 .CSS 转换为 .ASPX，因此我可以将一些颜色配置从数据库加载到我的样式表中。

在 aspx 样式表内部将是一个 DB 连接、一个用于获取颜色的小 SQL 查询，然后是我的 css 的其余部分，有时包含 ASP 变量。

这个 styles.aspx 页面是否仍会以与普通 css 文件相同的方式被缓存？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-01T01:43:42.927

只要 URL 不会因为查询字符串而不断变化，它就会像普通样式表一样被缓存。浏览器只能看到服务器发送的响应头和样式表的内容，而不是服务器上的源代码。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-01T01:45:04.863

客户端根本不关心服务器端发生了什么。它唯一关心的是响应和响应 HTTP 标头。如果它们与常规的 CSS 文件相同，那么无论响应是从文件提供、通过 ASP 动态创建还是由独角兽动态编写，都没有任何区别。

# linux-kernel - 测量Linux上程序发生的页错误数

> ID：10392581
> 
> 赞同：1
> 
> 时间：2012-05-01T01:42:01.177
> 
> 标签：linux-kernel, posix, system-calls, page-fault

我正在 Linux 调度程序上做一个项目，试图最大限度地减少页面错误的数量。

我已经完成了算法实现，我需要测量效果。我想知道Linux是否提供工具来记录整个执行过程中发生的页面错误的数量？

基本上，我想要类似的东西

```
$ pfstat ./a.out
page faults: 3
Execution Time: 1003 ms 
```

有这样的工具吗？在决定自己写一个之前，我想确定一下，这将是很多工作......

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-26T09:33:38.540

我推荐[perf-stat](https://perf.wiki.kernel.org/index.php/Tutorial#Counting_with_perf_stat)：

```
$ perf stat make

 Performance counter stats for 'make':

          4.142908 task-clock                #    0.781 CPUs utilized          
                 0 context-switches          #    0.000 K/sec                  
                 0 CPU-migrations            #    0.000 K/sec                  
               318 page-faults               #    0.077 M/sec                  
         3,111,777 cycles                    #    0.751 GHz                    
         1,956,914 stalled-cycles-frontend   #   62.89% frontend cycles idle   
         2,275,123 stalled-cycles-backend    #   73.11% backend  cycles idle   
        11,244,599 instructions              #    3.61  insns per cycle        
                                             #    0.20  stalled cycles per insn [65.87%]
     <not counted> branches                
     <not counted> branch-misses           

       0.005305316 seconds time elapsed 
```

它计算页面错误以及许多其他性能计数器。

但它需要你安装一个包`perf`。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-01T03:35:52.620

在大多数系统上`/usr/bin/time`都会报告页面错误，例如：

```
$ /usr/bin/time /bin/true
0.00user 0.00system 0:00.00elapsed 0%CPU (0avgtext+0avgdata 1632maxresident)k
40inputs+0outputs (1major+141minor)pagefaults 0swaps 
```

# javascript - 如何在 CKeditor 上传中向 POST 值添加字段

> ID：10392582
> 
> 赞同：8
> 
> 时间：2012-05-01T01:42:03.680
> 
> 标签：javascript, django, post, ckeditor

我使用*django*和*ckeditor*为 TextEdits 提供所见即所得的体验。我想使用 CKEditor 文件上传功能（在文件浏览器/图像对话框中），但是 CKEditor 上传图像的 POST 只包含文件数据。

这是 CSRF 检查的问题。我在 CKEditor 文档中找不到**更改文件上传的 POST 数据**的位置，以在 POST 数据中添加 django 的 csrf_token 。

作为一种解决方法，我可以更改 filebrowserUploadUrl 参数以在上传 URL 中包含 csrf 数据，对上传视图使用 @csrf_exempt，并检查 request.GET 参数以检查 csrf。但是这个解决方案安全吗？

无论如何，如果有人知道如何在 CKEditor 文件上传 POST 数据中直接包含 csrf 令牌，我非常感兴趣......

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-11-06T15:36:34.610

您可以注册 dialogDefinition 事件，并完全重写上传选项卡，因此：

```
CKEDITOR.on('dialogDefinition', function (ev) {
  var dialogName = ev.data.name;
  var dialogDefinition = ev.data.definition;
  if (dialogName == 'image') {
    dialogDefinition.removeContents('Upload');
    dialogDefinition.addContents({
      title: "Upload",
      id: "upload",
      label: "Upload",
      elements: [{
        type: "html",
        html: '<form><input id="imageupload" type="file" name="files[]" />{%csrf_token%}</form>'
      }]
    });
   }
}); 
```

这是对我的真实世界版本的未经测试的简化，但希望它显示了这个想法。

这不会在图像对话框中设置 URL 字段，因此单击对话框上的“确定”会给您一条错误消息。您需要在成功上传时进行设置，因此：

```
CKEDITOR.dialog.getCurrent().getContentElement('info', 'txtUrl').setValue(theURL); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2014-07-02T22:21:34.880

发送到服务器的额外数据通过 get 请求传递。我试图添加额外的数据，并最终实现了添加到用于发送数据的表单的 url 参数

```
CKEDITOR.on('dialogDefinition', function(ev)
   {
     var dialogName = ev.data.name;
     var dialogDefinition = ev.data.definition;
     if (dialogName == 'image')
     {
           dialogDefinition.contents[2].elements[0].action += '&pin=123456';
            /* 2 is the upload tab it have two elements 0=apparently is the
            and 1: is the button to perform the upload, in 0 have the action property with the parameters of the get request simply adding the new data               
              */ 

     }
   }); 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2014-10-17T20:03:01.110

在通过 CKEditor for Elgg 集成图像上传时，我遇到了类似的问题。我想出的侵入性最小的解决方案是绑定到提交按钮的 onClick 事件并直接从中修改表单：

```
CKEDITOR.on('dialogDefinition', function (ev) {
    var dialogName = ev.data.name;
    var dialogDefinition = ev.data.definition;

    if (dialogName === 'image') {
        var uploadTab = dialogDefinition.getContents('Upload');

        for (var i = 0; i < uploadTab.elements.length; i++) {
            var el = uploadTab.elements[i];

            if (el.type !== 'fileButton') {
                continue;
            }

            // add onClick for submit button to add inputs or rewrite the URL
            var onClick = el.onclick;

            el.onClick = function(evt) {
                var dialog = this.getDialog();
                var fb = dialog.getContentElement(this['for'][0], this['for'][1]);
                var action = fb.getAction();
                var editor = dialog.getParentEditor();
                editor._.filebrowserSe = this;

                // if using jQuery
                $(fb.getInputElement().getParent().$).append('<input type="hidden" name="foo" value="bar">');

                // modifying the URL
                fb.getInputElement().getParent().$.action = '/my/new/action?with&query&params=1';

                if (onClick && onClick.call(evt.sender, evt) === false) {
                        return false;
                }

                return true;
            };
        }
    }
}); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-05-04T21:31:02.577

不编辑ckeditor源代码好像没有办法给ckeditor上传数据添加数据。要修改的源代码是 plugins/dialogui/plugin.js，在 ckeditor 3.6.2 中的第 1440 行附近，其中 ckeditor 创建了上传 iframe 使用的表单。

```
// ADDED TO CKEDITOR CODE %<
var csrfitems = document.getElementsByName("csrfmiddlewaretoken")
var csrftoken = ""
if(csrfitems.length > 0)
    csrftoken = csrfitems[0].value
// >% END OF ADDED CODE
if ( elementDefinition.size )
    size = elementDefinition.size - ( CKEDITOR.env.ie  ? 7 : 0 );   // "Browse" button is bigger in IE.
frameDocument.$.write( [ '<html dir="' + langDir + '" lang="' + langCode + '"><head><title></title></head><body style="margin: 0; overflow: hidden; background: transparent;">',
'<form enctype="multipart/form-data" method="POST" dir="' + langDir + '" lang="' + langCode + '" action="',
CKEDITOR.tools.htmlEncode( elementDefinition.action ),
'">',
// ADDED TO CKEDITOR CODE
    '<input type="hidden" name="csrfmiddlewaretoken" value="',csrftoken,'"/>',
    // >% END OF ADDED CODE
'<input type="file" name="',
CKEDITOR.tools.htmlEncode( elementDefinition.id || 'cke_upload' ),
'" size="',
CKEDITOR.tools.htmlEncode( size > 0 ? size : "" ),
'" />',
'</form>', 
```

现在我们可以在 ckeditor 中使用 django 安全地上传

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2015-12-10T23:51:33.180

这个问题太老了，但是......

4.5 版您可以在任何请求中添加挂钩

```
editor.on( 'fileUploadRequest', function( evt ) {
    var xhr = evt.data.fileLoader.xhr;

    xhr.setRequestHeader( 'Cache-Control', 'no-cache' );
    xhr.setRequestHeader( 'csrf header ', 'HEADER' );
    xhr.withCredentials = true;
} ); 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2017-10-13T10:28:05.803

如果您通过 HTTPS 在 URL 中发送 CSFR 令牌，那么这样做应该没问题（从安全角度来看），而且处理起来也容易得多。

假设 django 可以读取该变量，或者您可以轻松地修改 django。这些试图改变CKeditor的答案似乎有点太多了。

只要用户浏览器以安全的方式将您的 CSFR_token 发送到服务器，无论是通过 POST 还是 GET 都没有关系。游戏中的安全问题是中间人攻击，即您不希望用户 CSFR_token 以纯文本形式广播。

严格来说，这种数据应该根据 HTTP 规范作为 POST 发送，但这似乎是一种“滥用” GET 协议可能是可以接受的情况，因为您无法以特别优雅的方式控制 CKEditor 代码。

此外，如果 CKEditor 在升级中更改内容，您可能会被抓到，通过 URL 传递令牌将始终有效。

# ruby - Ruby 哈希错误：未定义的方法 []

> ID：10392584
> 
> 赞同：9
> 
> 时间：2012-05-01T01:42:08.003
> 
> 标签：ruby, hash

我有一段这样的代码：

```
my_hash = {}
first_key = 1
second_key = 2
third_key = 3
my_hash[first_key][second_key][third_key] = 100 
```

红宝石解释器给了我一个错误说：

> nil:NilClass (NoMethodError) 的未定义方法“[]”

那么这是否意味着我不能像那样使用哈希？还是您认为此错误可能是由于其他原因？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-05-01T01:46:10.497

默认情况下，哈希不嵌套。由于`my_hash[first_key]`未设置任何内容，因此是`nil`. 并且`nil`不是哈希，因此尝试访问其中一个元素会失败。

所以：

```
my_hash = {}
first_key = 1
second_key = 2
third_key = 3

my_hash[first_key] # nil
my_hash[first_key][second_key]
# undefined method `[]' for nil:NilClass (NoMethodError)

my_hash[first_key] = {}
my_hash[first_key][second_key] # nil

my_hash[first_key][second_key] = {}

my_hash[first_key][second_key][third_key] = 100
my_hash[first_key][second_key][third_key] # 100 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2012-05-01T03:21:33.457

您使用散列的方式在 Ruby 中无效，因为必须先将每个值分配给一个散列，然后才能使用嵌套散列（我想您来自 PHP？），但您可以使用 vivified 散列：

```
my_hash = Hash.new{|h,k| h[k]=Hash.new(&h.default_proc)}
first_key = 1
second_key = 2
third_key = 3
my_hash[first_key][second_key][third_key] = 100
p my_hash

#output: {1=>{2=>{3=>100}}} 
```

这是您可能会感到舒服的方式。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-05-01T01:47:02.787

你不能使用这样的哈希值；`my_hash[first_key]`只是零，然后下一个索引操作失败。可以创建一个哈希对象，其行为方式与您正在寻找的方式相同——参见[http://taw.blogspot.co.uk/2006/07/autovivification-in-ruby.html——](http://t-a-w.blogspot.co.uk/2006/07/autovivification-in-ruby.html)但目前尚不清楚这是很好的风格。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-05-19T00:05:00.557

你可以做类似的事情

```
class NilClass

  def [] key
    nil
  end

end 
```

在初始化程序中`nil_overrides.rb`，您将能够使用`nil['xxx']`.

# iphone - 如何从 coredata 读取 NSData

> ID：10392586
> 
> 赞同：1
> 
> 时间：2012-05-01T01:42:30.563
> 
> 标签：iphone, ios, core-data

我已经在我的应用程序中设置了 coredata，我正在将一个 NSData 对象读入其中。我检查以确保一切正常并且值在那里，它们是，现在我想把那个 nsdata 拉出来并传递它到我班上的一个方法..但我不知道如何从 coredata 中读取这样的内容..

我看到的从 coredata 读取值的示例来自 XCode 生成的模板代码.. 但这是针对 objectAtIndexPath:indexPath 值... 如下所示..

```
- (void)configureCell:(UITableViewCell *)cell atIndexPath:(NSIndexPath *)indexPath
{
    NSManagedObject *object = [self.fetchedResultsController objectAtIndexPath:indexPath];
    cell.textLabel.text = [[object valueForKey:@"timeStamp"] description];
} 
```

所以我希望有一种方法可以将所有 NSData 从属性中提取出来。因为我所拥有的只是我自己解析的一团数据。

任何帮助将不胜感激。

更新：

好的，这就是我现在如何从我的 coredata 存储中读取数据的方式，这要归功于下面列出的精彩教程。

```
 NSManagedObjectContext *context = [self.fetchedResultsController managedObjectContext];
                    NSFetchRequest *fetchRequest = [[NSFetchRequest alloc] init];
                    NSEntityDescription *entity = [NSEntityDescription entityForName:@"Manz" inManagedObjectContext:context];
                    [fetchRequest setEntity:entity];
                    NSArray *fetchedObjects = [context executeFetchRequest:fetchRequest error:nil];
                    for (NSManagedObject *info in fetchedObjects) {
                        [self startTheParsingProcess:[info valueForKey:@"masters"]]; //Send to a method if you like
//                        NSLog(@"content od coredata %@", [info valueForKey:@"masters"]); // Or log it to see whats in your coredata
                    } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-01T02:07:30.937

Core Data 支持 NSData 属性。只需将一个添加到您的模型中，您就可以通过 NSFetchedResult 类保存和加载它。如果您不知道这意味着什么或如何做到这一点，那么我建议您使用 Core Data 入门，例如[这个](http://www.raywenderlich.com/934/core-data-on-ios-5-tutorial-getting-started)

# android - 在线程内启动新活动

> ID：10392590
> 
> 赞同：1
> 
> 时间：2012-05-01T01:43:33.220
> 
> 标签：android

我有一个关于线程的问题。我不确定这里发生了什么。我的理解是，在长时间的活动完成之前，进度对话框不会结束，但这不是正在发生的事情。我希望长时间的活动开始、完成、关闭微调器，然后带着意图开始新的活动。

```
 final ProgressDialog spinnerDialog = ProgressDialog.show(  
                MainScreen.this, "",  
                "Waiting for accurate (> 10 meters) GPS coordinates...Please wait. ", true);  
            new Thread(new Runnable() {  
                public void run() {  
                    //Do something that takes a while
                    spinnerDialog.dismiss();  
                    return;  
                }  
            }).start();

              Intent tvi = new Intent();
              tvi.setClass(getInstance(), TabbedView.class);
              startActivity(tvi); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-01T01:58:19.700

应在主 (UI) 线程中启动新活动。但是仅仅在启动新线程后编写代码并不能保证您拥有创建意图所需的所有信息。我建议使用处理程序

```
@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.main);
    progress = (ProgressBar) findViewById(R.id.progressBar1);
    handler = new Handler();
    startprogress();
}

public void startProgress(View view) {
    // Do something long
    Runnable runnable = new Runnable() {
        @Override
        public void run() {
            //do long stuff (like getting info for intent)
            handler.post(new Runnable() {
            @Override
            public void run() {
                //make new intent
                //start new activity with intent you just made
            }
        });
        }
    }
    };
    new Thread(runnable).start();
} 
```

}

更重要的是，这里是处理程序开发人员页面的链接：http: [//developer.android.com/reference/android/os/Handler.html](http://developer.android.com/reference/android/os/Handler.html)

# ios - 如何暂停 iPad 上的所有声音通知？

> ID：10392596
> 
> 赞同：9
> 
> 时间：2012-05-01T01:44:33.907
> 
> 标签：ios, ipad, notifications, alerts, alarms

我们正在为 iPad（仅）创建一个音频应用程序，用于现场表演。该设备将直接连接到控制台。因此，您在现场表演中最不想要的就是让设备突然发出意外的警报或提醒。

通过对 Apple SDK 的研究，您似乎可以屏蔽除日历和闹钟（以及 iPhone 上的通话）之外的所有内容。

也就是说，有谁知道如何告诉设备“当我们处于‘直播’模式时，不允许*任何*操作系统通知”？

如果没有，我们至少可以查询它们是否已打开以便我们可以警告用户吗？

Jailbeaking 不是一种选择，因为我们想通过 App Store 出售它。

**更新**

另一种选择是允许常规警报等仍然通过 iPad 的扬声器播放，但我们通过底座连接器中的线路输出发送*声音*。

当然，我们总是可以为此开发自己的硬件，但我们正在尝试尽可能多地利用设备的内置功能。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-04T02:42:20.037

它可能会使您的应用程序不符合 App Store 分发的条件，但显然有些人已经使用了一个私有 API 来执行此操作。看：

*   [如何禁用 iOS 系统声音](https://stackoverflow.com/questions/6284402/how-to-disable-ios-system-sounds)
*   [以编程方式使 iOS 设备静音/静音？](https://stackoverflow.com/questions/10371312/mute-silence-an-ios-device-programmatically)

有些人报告说，某些 API 调用具有接管所有声音输出的副产品。参见[iOS 5 Audio Alarms Don't sound without kAudioSessionProperty_OverrideCategoryMixWithOthers On](https://stackoverflow.com/questions/8202604/ios-5-audio-alarms-dont-sound-without-kaudiosessionproperty-overridecategorymix/8203430#8203430)示例。

您*最安全*的选择可能是在应用打开时提示用户更改设置。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-01T19:02:59.257

~~注意：我现在没有 iPad，但我认为它与我的 iPod 具有相同的选项。~~ **编辑**：不，它没有。

**仅限 iPod**：在“设置”=>“声音”中，您可以将“铃声和警报”音量一直向下拖动。当这个音量滑块一直向下时，我的 iPod 根本不会发出任何噪音，除了我打开的程序发出的噪音。

![iPod 设置的屏幕截图](../Images/aef3869617b840b4c82313c11c7d498b.png)

iPad 似乎不像 iPod 那样允许单独控制系统声音和程序声音的音量。

![iPad设置照片](../Images/c5a72334d2a853f70203ab57f11828e4.png)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-02T07:41:02.127

我实际上并没有尝试过，但在快速谷歌搜索后，我发现`AVAudioSession`类参考说设置模式`AVAudioSessionCategoryRecord`可能会达到你想要的效果。

关于的注释`AVAudioSessionCategoryPlayAndRecord`说：

> 如果您想确保在您的应用程序录制时不会播放诸如消息警报之类的声音，请改用该`AVAudioSessionCategoryRecord`类别。

[http://developer.apple.com/library/ios/documentation/AVFoundation/Reference/AVAudioSession_ClassReference/Reference/Reference.html#//apple_ref/c/data/AVAudioSessionCategoryRecord](http://developer.apple.com/library/ios/documentation/AVFoundation/Reference/AVAudioSession_ClassReference/Reference/Reference.html#//apple_ref/c/data/AVAudioSessionCategoryRecord)

（也可以使用 C API：http: [//developer.apple.com/library/ios/#documentation/AudioToolbox/Reference/AudioSessionServicesReference/Reference/reference.html#//apple_ref/doc/c_ref/kAudioSessionCategory_PlayAndRecord](http://developer.apple.com/library/ios/#documentation/AudioToolbox/Reference/AudioSessionServicesReference/Reference/reference.html#//apple_ref/doc/c_ref/kAudioSessionCategory_PlayAndRecord)）

# machine-learning - 使用 scikit learn 预测网站上的优质内容

> ID：10392597
> 
> 赞同：3
> 
> 时间：2012-05-01T01:44:39.120
> 
> 标签：machine-learning, scikit-learn, prediction

我有一个网站一年的数据。我想训练一种机器学习算法来根据某些变量（例如，字数、发布时间等）预测新内容的成功与否

我想获取一条新数据，输入有关它的某些特征，并获得它在网站上表现如何的概率。

此外，我想继续将未来的数据添加到训练集中，并不断训练算法以随着时间的推移变得更智能。

我的问题是：我应该如何使用 scikit-learn 来完成这项工作？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-07T20:17:05.943

你所拥有的是一个二元分类问题，即你必须决定给定的输入是否好。

尝试不同的回归算法，scikits-learn 让切换算法变得超级容易，让您看到哪些有效，哪些无效。

从我的脑海中，这里有一些我会尝试的方法：

*   支持向量机
*   随机森林（scikits 中的随机树森林）
*   回归（Ridge、Lasso、IRLS、logistic）
*   朴素贝叶斯
*   k 最近邻

如何评估给定方法的质量？使用交叉验证（如果你有足够的数据，做 10 倍，否则做 5 倍）。scikits-learn 手册中有一个完整的部分（5.1）专门用于此。

向训练集​​中添加新数据需要重新训练模型。根据您手头的计算能力，它可能是也可能不是问题。如果您有很多示例，添加一个不会有太大变化，因此请务必使用一些新示例重新训练您的算法。这将节省计算时间。

使用训练集的算法称为离线算法。另一方面，在线算法每次出现新示例时都会学习。如果你真的需要这个，试试在线方法，比如 k 个最近的邻居。

如果您需要示例代码，scikit-learn 文档非常有帮助：- [http://scikit-learn.org/0.10/auto_examples/linear_model/logistic_l1_l2_sparsity.html#example-linear-model-logistic-l1-l2-sparsity-py](http://scikit-learn.org/0.10/auto_examples/linear_model/logistic_l1_l2_sparsity.html#example-linear-model-logistic-l1-l2-sparsity-py) - [http://scikit-learn.org/0.10/modules/linear_model.html#ridge-regression](http://scikit-learn.org/0.10/modules/linear_model.html#ridge-regression)

[http://scikit-learn.org/0.10/user_guide.html](http://scikit-learn.org/0.10/user_guide.html)

# android - 通过在文本框中输入联系人的姓名来呼叫联系人

> ID：10392602
> 
> 赞同：1
> 
> 时间：2012-05-01T01:45:08.017
> 
> 标签：android, android-contacts

我想知道是否有任何方法可以通过简单地输入联系人的姓名（然后单击 a `Button`）来呼叫联系人。应用程序应直接致电联系人，而不要求任何其他确认。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-01T01:56:42.103

就在这里。看看这个库[https://github.com/mwells/android.contact.picker](https://github.com/mwells/android.contact.picker)。

# post - Coldfusion 序列化 JSON 示例

> ID：10392604
> 
> 赞同：1
> 
> 时间：2012-05-01T01:45:39.103
> 
> 标签：post, coldfusion, cfform

我希望看到一个简单的模板示例，其中 SerializeJSON 和 deserializeJSON 发布到同一个模板，并且每次通过时添加一个数组。我已经尝试了几次，但我一直对通行证感到困惑。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-01T02:27:33.713

```
<cfif structKeyExists(form,"jsonArray")>
    <cfset arrayData = deserializeJSON(form.jsonArray) />
    <cfset arrayAppend(arrayData,form.theText) />
<cfelse>
    <cfset arrayData = [] />
</cfif>
<cfoutput>
    <form name="input" action="ableto.cfm" method="post">
        <input type="hidden" value='#serializeJSON(arrayData)#' name="jsonArray" id="jsonArray" />
        Text: <input type="text" value="" name="theText" id="theText" />
        <input type="submit" value="Subby" />
    </form>
</cfoutput>

<cfdump var="#arrayData#" />
<cfdump var="#form#" /> 
```

# java - 在 adj 矩阵图中找到最大的连通分量？

> ID：10392605
> 
> 赞同：7
> 
> 时间：2012-05-01T01:45:40.223
> 
> 标签：java, algorithm, graph, matrix

我试图找出它有一种方法可以在 adj 矩阵图中找到最大的连通分量。比如这样：

```
0000000110
0001100000
0000000000
0100000010
0100000100
0000000100
0000000000
1000110000
1001000000
0000000000 
```

我已经用谷歌搜索了这个问题并且正在努力寻找任何东西，我也阅读了关于图论的 wiki 文章，但没有任何乐趣。我认为他们必须是解决这个问题的算法。任何人都可以指出我正确的方向并给我一些关于我应该做些什么来自己解决这个问题的指示吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-01T02:02:29.357

1.  应用连通分量算法。

    对于无向图，只需选择一个节点并进行广度优先搜索。如果在第一个 BFS 之后还有剩余的节点，则选择一个剩余的节点并执行另一个 BFS。（每个 BFS 都有一个连接的组件。）

    请注意，有向图需要稍强的算法来查找*强连通*分量。Kosaraju 的算法浮现在脑海中。

2.  从 (1) 计算每个连接组件中的节点数。选择最大的一个。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-05-01T01:48:45.500

选择一个起点，开始“步行”到其他节点，直到你筋疲力尽。执行此操作，直到找到所有组件。这将运行在`O(n)`哪里`n`是图形的大小。

Python中解决方案的骨架：

```
class Node(object):
    def __init__(self, index, neighbors):
        self.index = index
        # A set of indices (integers, not Nodes)
        self.neighbors = set(neighbors)

    def add_neighbor(self, neighbor):
        self.neighbors.add(neighbor)

class Component(object):
    def __init__(self, nodes):
        self.nodes = nodes
        self.adjacent_nodes = set()
        for node in nodes:
            self.adjacent_nodes.add(node.index)
            self.adjacent_nodes.update(node.neighbors)

    @property
    def size(self):
        return len(self.nodes)

    @property
    def node_indices(self):
        return set(node.index for node in self.nodes)

    @property
    def is_saturated(self):
        return self.node_indices == self.adjacent_nodes

    def add_node(self, node):
        self.nodes.append(node)
        self.adjacent_nodes.update(node.neighbors)

adj_matrix = [[0, 0, 0, 0, 0, 0, 0, 1, 1, 0],
              [0, 0, 0, 1, 1, 0, 0, 0, 0, 0],
              [0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
              [0, 1, 0, 0, 0, 0, 0, 0, 1, 0],
              [0, 1, 0, 0, 0, 0, 0, 1, 0, 0],
              [0, 0, 0, 0, 0, 0, 0, 1, 0, 0],
              [0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
              [1, 0, 0, 0, 1, 1, 0, 0, 0, 0],
              [1, 0, 0, 1, 0, 0, 0, 0, 0, 0],
              [0, 0, 0, 0, 0, 0, 0, 0, 0, 0]]
matrix_size = len(adj_matrix)

nodes = {}
for index in range(matrix_size):
    neighbors = [neighbor for neighbor, value in enumerate(adj_matrix[index])
                 if value == 1]
    nodes[index] = Node(index, neighbors)

components = []
index, node = nodes.popitem()
component = Component([node])
while nodes:
    if not component.is_saturated:
        missing_node_index = component.adjacent_nodes.difference(component.node_indices).pop()
        missing_node = nodes.pop(missing_node_index)
        component.add_node(missing_node)
    else:
        components.append(component)

        index, node = nodes.popitem()
        component = Component([node])

# Final component needs to be appended as well
components.append(component)

print max([component.size for component in components]) 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-05-25T10:56:00.580

```
#include<iostream>
#include<cstdlib>
#include<list>
using namespace std;
class GraphDfs
{
    private:
        int v;
        list<int> *adj;
        int *label;
        int DFS(int v,int size_connected)
        {

            size_connected++;
            cout<<(v+1)<<"   ";
            label[v]=1;
            list<int>::iterator i;
            for(i=adj[v].begin();i!=adj[v].end();++i)
            {
                if(label[*i]==0)
                {
                    size_connected=DFS(*i,size_connected);

                }

            }
            return size_connected;
        }
    public:
        GraphDfs(int k)
        {
            v=k;
            adj=new list<int>[v];
            label=new int[v];
            for(int i=0;i<v;i++)
            {
                label[i]=0;
            }
        }
        void DFS()
        {
            int flag=0;
            int size_connected=0;
            int max=0;
            for(int i=0;i<v;i++)
            {   
                size_connected=0;
                if(label[i]==0)
                {
                    size_connected=DFS(i,size_connected);
                    max=size_connected>max?size_connected:max;
                    cout<<size_connected<<endl;
                    flag++;
                }
            }
            cout<<endl<<"The number of connected compnenets are "<<flag<<endl;
            cout<<endl<<"The size of largest connected component is "<<max<<endl;
            //cout<<cycle;
        }

        void insert()
        {
            int u=0;int a=0;int flag=1;
            while(flag==1)
            {   cout<<"Enter the edges in (u,v) form"<<endl;

                cin>>u>>a;
                adj[a-1].push_back(u-1);
                adj[u-1].push_back(a-1);
                cout<<"Do you want to enter more??1/0 "<<endl;
                cin>>flag;

            }
        }       
};
int main()
{
    cout<<"Enter the number of vertices"<<endl;
    int v=0;
    cin>>v;
    GraphDfs g(v);
    g.insert();
    g.DFS();
    system("Pause");     
} 
```

# c# - IE6 DNS server Error in IE6 While running asp.net 解决方法

> ID：10392608
> 
> 赞同：1
> 
> 时间：2012-05-01T01:45:58.483
> 
> 标签：c#

当我在windon 7中构建的XP模式下在Virtual PC中运行我的asp解决方案时，我发现了一个IE6问题，这意味着DNS服务器错误并且无法打开页面。

我正在使用 IIS Express，它可以从 VPC 访问。我可以从 VPC 运行互联网和我的解决方案，但有时会发生 DNS 服务器错误。

问题是虽然解决方案可以正确运行，但有时我点击一个链接，IE6给我消息{页面无法打开}

在 Window7 中我使用的是 IE9，在 VPC XP 模式下我使用 IE6 进行测试。虽然相同的解决方案在 IE9 中不会发生此错误。

我希望有人能帮帮我。多谢。

# android - 在 Spinner 中覆盖 OnSelectedItemListener

> ID：10392609
> 
> 赞同：1
> 
> 时间：2012-05-01T01:46:02.297
> 
> 标签：android, android-widget

所以我有这个代码：

```
converteeUnit.setOnItemSelectedListener(new OnItemSelectedListener(){

    @Override
    public void onItemSelected(AdapterView<?> parent, View arg1,
       int arg2, long arg3) {
       // TODO Auto-generated method stub   
    }

    @Override
    public void onNothingSelected(AdapterView<?> arg0) {
        // TODO Auto-generated method stub  
    }
}) ; 
```

我正在尝试更改此设置，但我不了解该`OnItemSelected`方法的参数。对于这个例子，每一个是什么意思，我需要什么来实现名为convertedUnit的微调器？另外，在插入所需代码的同时，如何让它做与以前相同的事情？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-01T02:40:18.043

如有疑问，请务必[检查文档](http://developer.android.com/reference/android/widget/AdapterView.OnItemSelectedListener.html#onItemSelected%28android.widget.AdapterView%3C?%3E,%20android.view.View,%20int,%20long%29)。

*   AdapterView = 微调器
*   View = 选择的视图（在对话框/下拉菜单中）
*   int = 按下的位置
*   long = id（可能对你没用）

不确定您要做什么，但通常您希望使用`position`来从`Adapter`用于填充 Spinner 的值中获取值。您可以随时使用`spinner.getAdapter().getItem(position)`

# android - 在 Android 应用程序中找不到 NullPointerException

> ID：10392611
> 
> 赞同：1
> 
> 时间：2012-05-01T01:46:21.867
> 
> 标签：android, nullpointerexception

我需要帮助找出为什么会出现空指针异常。我试过进入调试模式，但如果这适用于 Eclipse 和 Android，我不知道如何使用它。第一种方法只是计算文件的行数（这将随时间变化）以初始化数组。数据实际上是在方法 setData() 中设置的。

```
public class ATS_BoxesActivity extends Activity {

private String iButtonID, iButtonName;
private String routeID, stopNum;
private String lat, lon;
private String[] dropBoxes;

public ATS_BoxesActivity() throws IOException{
    dropBoxes=new String[countLines()];

}
private int countLines() throws IOException{
BufferedReader(getResources().openRawResource(R.raw.spinner_data));
    int count=0;
    Scanner s = new Scanner(getAssets().open("spinner_data.csv"));
    while (s.hasNextLine()) {   //this is where the error is pointing       
        count++;
        s.nextLine();
    }

}

public String[] setData() throws IOException {

    Scanner s = new Scanner(getAssets().open("spinner_data.csv"));
    String line = "";
    int pointer = 0;
    while (s.hasNextLine()) {
        line=s.nextLine();
        StringTokenizer st = new StringTokenizer(line);
        iButtonID = (st.nextToken(","));
        iButtonName = (st.nextToken(","));
        routeID = (st.nextToken(","));
        stopNum = (st.nextToken());
        lat = (st.nextToken(","));
        // setLongitude(st.nextToken(","));
        System.out.println("DropBox: " + iButtonName);

        dropBoxes[pointer] = iButtonName;
        pointer += 1;           
    }
    return dropBoxes;
}

/** Called when the activity is first created. */
@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.main);

    Spinner dropSpinner = (Spinner) findViewById(R.id.dbSpinner);
    ArrayAdapter<CharSequence> adapter = new ArrayAdapter<CharSequence>(
            this, android.R.layout.simple_spinner_item);
    adapter.setDropDownViewResource(android.R.layout.simple_spinner_dropdown_item);

    try {
        String[] db = setData();
        for (int i = 0; i < db.length; i++) {
            adapter.add(db[i]);
        }
        dropSpinner.setAdapter(adapter);
    } catch (IOException e) {
        e.printStackTrace();
    }

    Spinner fillSpinner = (Spinner) findViewById(R.id.fillSpinner);
    ArrayAdapter<CharSequence> adapter1 = ArrayAdapter.createFromResource(
            this, R.array.fill_array, android.R.layout.simple_spinner_item);
    adapter1.setDropDownViewResource(android.R.layout.simple_spinner_dropdown_item);
    fillSpinner.setAdapter(adapter1);
    fillSpinner.setOnItemSelectedListener(new MyOnItemSelectedListener());

} 
```

}

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-01T01:54:32.553

调试绝对适用于 Eclipse 和 Android，并且是一个非常有用的工具，因此我绝对建议您熟悉它。

如果您检查“logcat”窗口，您应该会看到一个堆栈跟踪，它将告诉您获得空指针的确切行。如果您仍然无法从那里弄清楚，请粘贴堆栈跟踪，这里应该有人可以提供帮助。

如果在 Eclipse 中找不到 logcat 窗口，转到 Window-> Show View -> Other -> Android-> Logcat。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-01T02:32:43.673

我会在这里冒险并猜测 NPE 发生在`dropBoxes[pointer] = iButtonName;`，这是因为这条线`dropBoxes=new String[countLines()];`没有被执行。不会为活动执行无参数构造函数。

只需`dropBoxes=new String[countLines()];`在调用`setData()`您的`onCreate()`.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-01T02:34:41.037

```
Scanner s = new Scanner(getAssets().open("spinner_data.csv"));

getAssets().open("spinner_data.csv")  //returning null 
```

您的构造函数调用抛出 NullPointerException。如果传递给扫描器构造函数的对象没有实现 Readable 接口，则会抛出空指针异常。所以 open 函数调用或 getAssets 必须返回 null，导致 null 被传递给函数。

我在[这里阅读了以下内容](http://Unless%20otherwise%20mentioned,%20passing%20a%20null%20parameter%20into%20any%20method%20of%20a%20Scanner%20will%20cause%20a%20NullPointerException%20to%20be%20thrown. "这里")

> 除非另有说明，否则将 null 参数传递给 Scanner 的任何方法都会导致抛出 NullPointerException。

下面的代码产生一个 NullPointerException

```
public static void main(String[] args) {
    // TODO Auto-generated method stub
    Scanner s;
    InputStream is = null;
    s = new Scanner(is);
}

Exception in thread "main" java.lang.NullPointerException
    at java.io.Reader.<init>(Unknown Source)
    at java.io.InputStreamReader.<init>(Unknown Source)
    at java.util.Scanner.<init>(Unknown Source)
    at testing.main(testing.java:14) 
```

将 spinner_data.csv 输入流保存在 InputStream 对象中，然后检查它是否为空。如果是这种情况，那么问题可能出在文件名或文件属性上。它可读吗？它有任何权限吗？

# jquery-selectors - Jquery 多属性结束选择器 (OR)

> ID：10392612
> 
> 赞同：1
> 
> 时间：2012-05-01T01:46:49.757
> 
> 标签：jquery-selectors, attributes

有没有更好的版本：

```
$(a[href$=".jpg"],a[href$=".gif"],a[href$=".png"],a[href$=".jpeg]) 
```

我感兴趣有两个原因：

1.  由于涉及的字符数量，很难从视觉上理解这一点。
2.  以这种方式编写它可能会导致浪费周期（我假设）。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-01T02:01:42.353

你可以使用这样的东西：

```
$.expr[':'].img = function(obj) {
   return (/\.(jpg|gif|png|jpeg)$/i).test(obj.href);
} 
```

然后像这样调用图像：

```
$("a:img") 
```

# xslt - XSLT：如果满足条件，如何退出“for-each”循环

> ID：10392614
> 
> 赞同：3
> 
> 时间：2012-05-01T01:47:02.733
> 
> 标签：xslt, foreach

如果满足条件，如何退出 XSL 中的“for-each”循环？例如，假设我希望 XSL 在以下 XML 中显示具有（2 间卧室和租金 <= 1000）的公寓的地址，以下 XSL 代码：

```
<xsl:for-each select="//apartment/apartment_details">
  <xsl:if test="bedrooms=$bedrooms and rent &lt;= $budget "> 
    <!--display apartment address--> 
  </xsl:if>
</xsl:for-each> 
```

将返回相同的公寓地址两次。即使满足条件的公寓有多个，我也只想显示一次公寓地址。

XML结构：

```
<apartments>
  <apartment>
    <address>
        <street>....</street>
        <city>....</city>
    </address>
    <apartment_details>
        <bedrooms>2</bedrooms>
        <bathrooms>2</bathrooms>
        <rent>1000</rent>
    </apartment_details>
    <apartment_details>
        <bedrooms>2</bedrooms>
        <bathrooms>1</bathrooms>
        <rent>900</rent>
    </apartment_details>
    ...
  </apartment>
  ...
</apartments> 
```

谢谢你。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-01T02:16:16.077

> 如果满足条件，如何退出 XSL 中的“for-each”循环？

**这是不可能的。没有任何用于退出处理`xsl:for-each`并继续执行转换的 XSLT 指令。您可以做的是精确指定所选节点应满足的条件**。

**使用**：

```
<xsl:for-each select=
 "/*/apartment
      [apartment_details[bedrooms=$bedrooms and $budget  >= rent]]">
  <!-- output apartment address here -->  
</xsl:for-each> 
```

此代码显示任何`apartment`作为 XML 文档顶部元素的子元素且具有`apartment_details`子元素的地址，对于谁的子元素`bedrooms`，`rent`它是`true()`：`bedrooms=$bedrooms and $budget >= rent`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-01T02:02:46.720

我认为您不需要使用循环，而是尝试使用过滤器表达式：

```
<xsl:value-of select="NODE[CRITERIA][1]"> 
```

# prolog - 将 prolog 输入 `(a,z,b)` 转换为 `[a,z,b]`

> ID：10392616
> 
> 赞同：3
> 
> 时间：2012-05-01T01:47:11.893
> 
> 标签：prolog, dcg

我是序言的新手。

我需要将序言输入转换为开括号和右括号`(a,z,b)`内以逗号分隔值格式的给定变量的序言输入为形式的序言列表`[a,z,b]`。

有人可以帮忙吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-01T06:10:57.833

序列的主要函子是 ,/2，列表的主要函子是 ./2。因此，

```
% call: convert(+Sequence,-List)
convert(','(A,B), [A|B1]) :- !, convert(B,B1).
convert(A,[A]). 
```

我假设不应该转换序列的元素：

```
?- convert((1,2,3),L).
L = [1, 2, 3].

?- convert((1,(2,3),4),L).
L = [1, (2, 3), 4]. 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-01T18:41:55.207

除了上面 Alexander 所写的内容之外：在描述列表时，DCG 也很适合这种情况，特别是如果您还想在元组中展平元组：

```
tuple_list((A,B)) --> !, tuple_list(A), tuple_list(B).
tuple_list(A)     --> [A]. 
```

亚历山大提到的第二种情况现在有效（以防万一你想要这个）：

```
?- phrase(tuple_list((1,(2,3),4)), Ls).
Ls = [1, 2, 3, 4]. 
```

我想您的用例中不需要这个，但如果需要，请考虑使用此 DCG 表示法。除此之外，这个元组表示被称为“defaulty”，因为它需要一个“default”案例（第二条规则）来处理它，这不是很好，因为它会阻止您在两个方向上使用谓词。使用专用函子来描述不同的情况会更简洁。比如用triple(a,b,c)代替(a,b,c)来表示三元组，用list来表示任意长度的序列等，转换谓词会多很多声明性和可用于所有方向。

# jquery - jQuery 在 Dom + 性能中缓存 Ajax 请求

> ID：10392618
> 
> 赞同：4
> 
> 时间：2012-05-01T01:47:43.927
> 
> 标签：jquery, performance, caching, dom

我正在创建一个应用程序，当单击选项卡时，它的内容是通过 ajax 加载的。这样做的原因是为了加快初始页面加载，而不是加载不必要的选项卡内容。选项卡包含可以更改值的表单项。

为了防止数据丢失，当一个标签被加载时，我给它一个额外的“ajaxed”类。如果“ajaxed”类不存在，则单击选项卡时，将通过 ajax 加载内容，否则将先前加载的内容简单地呈现给用户。

问题：在 dom 中缓存大量 HTML 会降低性能吗？这是不好的做法吗？这适用于无限滚动和其他类型的页面，您只需不断地附加越来越多的 html。这种方法的缺点是什么？

提前致谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-01T02:02:50.747

这取决于您的应用领域。**在 DOM中缓存某些选项卡的内容肯定不会有什么坏处**，前提是这些选项卡中的 dom 元素的数量是有限的。

事实上，使用选择器在 DOM 中查找元素的脚本会越慢，元素越多。当您的访问者使用带有蹩脚 JavaScript 引擎的浏览器（如旧版本的 Internet Explorer）时，这对您的访问者来说会更加明显。此外，内存消耗会随着 DOM 元素的数量而增加。**因此，您不想向 DOM 添加无限数量的项目。**

对于无限滚动，一个好的做法是在向下滚动太远时卸载/删除项目，并在再次向上滚动时重新添加它们。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-01T01:59:10.563

你的方法没问题。您不能最小化附加 dom 的内存使用量，除非将其从父元素中删除。

您关心的第二部分，关于无限滚动，有很多理念，但重点是只缓存足够的数据以提供完美的滚动体验。但是您需要“销毁”先前创建的用于数据表示的 dom 元素，例如“太远”。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-01T02:13:59.307

像这样的一般性问题的明显答案是“视情况而定”。如果您正在尝试解决已知的性能问题，这可能是一个合适的解决方案。延迟内容的加载可以使网站对用户的响应更快。但是加载到页面中的内容越多，dom 自然就会越慢。因此，一个明显的替代方法是为每个选项卡使用单独的页面（或页面“部分”）。这样，一次只加载可见内容。Ajax 可用于呈现部分内容。请记住，浏览器和服务器也会缓存内容，因此可能不需要额外的缓存或延迟加载策略。但总会有取舍，因此这取决于您要解决的问题的性质（在不同的网站场景中将需要不同的解决方案）。可维护性可能是决定如何分区/加载页面内容的另一个因素。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-01T02:26:58.010

虽然与您的问题无关，但您使用这种方法会失去 SEO，因为您没有每个内容的唯一网址。如果您的站点是内部站点，则这可能不是问题。

# batch-file - 批处理文件如何运行程序并设置窗口的位置和大小？

> ID：10392620
> 
> 赞同：35
> 
> 时间：2012-05-01T01:47:55.203
> 
> 标签：batch-file, cmd, windows-explorer

我有批处理文件，可以在我编写代码时为我设置桌面环境。该文件名为：`SetEnv.cmd`并打开其他 3 个窗口：

1.  设置为应用服务器部署目录的 Windows 资源管理器实例。
2.  Windows 资源管理器的第二个实例，它设置为编写我的部署文件的目录。
3.  启动我的应用程序服务器的控制台窗口。

以下是 的内容`SetEnv.cmd`：

```
Explorer /n,c:\develop\jboss-4.2.3.GA\server\default\deploy
Explorer /n,c:\develop\Project\Mapping\deploy
cmd /c SetupEnvCmd.cmd 
```

以下是以下内容`SetupEnvCmd.cmd`：

```
cd C:\develop\jboss-4.2.3.GA\bin
run 
```

每次我运行它时，我都不得不浪费时间重新排列和调整窗口大小。我不想运行最小化的窗口，因为我在编写和测试代码时与每个窗口进行了多次交互。有什么方法可以控制从脚本中打开的窗口的位置和/或大小？

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2012-06-21T19:01:50.957

[这是来自http://www.nirsoft.net/utils/nircmd.html](http://www.nirsoft.net/utils/nircmd.html)的 nircmd util 的另一种方法
示例：

> nircmd win move ititle "cmd.exe" 5 5 10 10
> nircmd win setsize ititle "cmd.exe" 30 30 100 200
> nircmd cmdwait 1000 win setsize ititle "cmd.exe" 30 30 1000 600

以下是 SetEnv.cmd 的内容：

```
    资源管理器 /n,c:\develop\jboss-4.2.3.GA\server\default\deploy
    nircmd wait 1000 win setsize ititle "something" x, y, width, height
    资源管理器 /n,c:\develop\Project\Mapping\deploy
    nircmd wait 1000 win setsize ititle "something" x, y, width, height

```

其中 x，y 左上角位置和宽度，高度是窗口大小“某物”是窗口标题，通常是文件夹名称，例如。"c:\develop\jboss-4.2.3.GA\server\default\deploy" 可能需要调整 "wait" 以给应用程序窗口初始化的时间。因此，如果您有延迟的病毒扫描程序，您将增加时间。explorer.exe 或 cmd.exe 问题不大，但像 Firefox 或 java 应用程序之类的问题可能会从几秒到几十秒不等，具体取决于您的硬件和操作系统调整的速度。您还可以通过向“SetupEnvCmd.cmd”添加行来自定义 cmd.exe 窗口或“运行”应用程序，假设“运行”是异步 win32 应用程序，否则添加“启动”命令。

* * *

## 回答 #2

> 赞同：18
> 
> 时间：2013-12-09T08:43:00.387

使用几个帮助程序和一个批处理文件可以完全解决这个问题。
我有两个解决方案；一个用于单显示器计算机，另一个用于多显示器计算机。

## 解决方案 1：单显示器计算机

这个演示批处理文件将并排打开两个资源管理器窗口，并在主监视器的屏幕上居中。
阅读批处理文件中的说明。

使用的工具：
1\. Nir ​​Sofer 的**MonitorInfoView** *(41 KB)* ......[主页](http://www.nirsoft.net/utils/monitor_info_view.html)
2\. Nir ​​Sofer 的**NirCmd** *(43 KB)* ...... .............[主页](http://www.nirsoft.net/utils/nircmd.html)
3.**批处理文件** *(6 KB)* ................... .................见下文

将所有三个文件收集到一个目录中。
这是批处理文件，可以在任何 Windows 系统上*运行（运行它以进行即时演示）*：

```
@echo off
REM ----- GIVE THIS CONSOLE WINDOW TITLE A UNIQUE STRING ID
title OPEN-2-EXPLORER-WINDOWS-SIDE-BY-SIDE-AND-CENTERED-ON-SCREEN-AT-THE-PRIMARY-MONITOR___20131209084355
pushd %~dp0

REM ----- HIDE THIS CONSOLE WINDOW (HOOKS THE WINDOW TITLE)
nircmd.exe win hide ititle "OPEN-2-EXPLORER-WINDOWS-SIDE-BY-SIDE-AND-CENTERED-ON-SCREEN-AT-THE-PRIMARY-MONITOR___20131209084355"

REM ********************** DESCRIPTION ************************************
REM ** This script opens one or more windows with specified screen properties
REM ** at the primary monitor (containing the taskbar). The "X/Y position" and
REM ** "W/H size" of the windows are auto-set by this script and the monitor
REM ** resolution is auto-calculated to suit.
REM ** 'MonitorInfoView.exe' is the helper tool used to capture the resolution
REM ** info of the monitor. 
REM ** 'nircmd.exe' is the tool performing all the display trickery.
REM **
REM ** To tweak this script, go to the code section named:
REM ** >>>>> USER INPUT/PREFERENCES ARE ALL SET HERE <<<<<
REM ***********************************************************************

REM ----- CLEAR ANY PREVIOUS JOB OUTPUTS IF THEY EXIST
if exist ~TMP.TXT type NUL > ~TMP.TXT

REM ----- OUTPUT THE PRIMARY MONITOR INFORMATION TO A TEXT FILE
MonitorInfoView.exe /hideinactivemonitors 1 /stext ~TMP.TXT

REM ----- ISOLATE THE RESOLUTION LINE, REMOVING ALL THE OTHER LINES IN THE TEXT FILE
for /f "delims=" %%A in ('type "~TMP.TXT" ^|find.exe /i "Maximum Resolution"') do echo %%A>~TMP.TXT

REM ----- GET THE RESOLUTION NUMBERS, AND SET THEM AS VARIABLES
for /f "tokens=3,4 delims=:X " %%A in ('type "~TMP.TXT"') do set _SCREENW_=%%A& set _SCREENH_=%%B

REM >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>><<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
REM >>>>>>>>>> USER INPUT/PREFERENCES ARE ALL SET HERE [BEGIN] <<<<<<<<<<<<

REM ----- LEFT WINDOW PROPERTIES

    set _WINLEFT_=%SYSTEMDRIVE%
    set /a _WINLEFTW_=(%_SCREENW_% / 3) + 50
    set /a _WINLEFTH_=(%_SCREENH_% / 2) + 200
    set /a _WINLEFTX_=(%_SCREENW_% - %_WINLEFTW_%) / 5
    set /a _WINLEFTY_=(%_SCREENH_% - %_WINLEFTH_%) / 2

REM ----- RIGHT WINDOW PROPERTIES

    set _WINRIGHT_=%USERPROFILE%
    set /a _WINRIGHTW_=(%_SCREENW_% / 3) + 50
    set /a _WINRIGHTH_=(%_SCREENH_% / 2) + 200
    set /a _WINRIGHTX_=(%_WINLEFTX_%) + (%_WINLEFTW_%)
    set /a _WINRIGHTY_=(%_SCREENH_% - %_WINRIGHTH_%) / 2

REM ----- ADJUST THE WAIT TIME (MILLISECONDS) BETWEEN EACH WINDOW LAUNCH.
REM ----- IF TOO QUICK, THE FOLLOWING WINDOW WILL NOT SET IN THE CORRECT SCREEN POSITION.
REM ----- | FOR FAST SYSTEM: TRY 200 | NORMAL SYSTEM: TRY 400-600 | BLOATED SYSTEM: TRY 800-1200+

    set _WAITTIME_=400

REM ----- ON WINDOWS NT5 (XP, 2000), RUNNING EXPLORER WITH THE 'N' SWITCH WOULD RELIABLY GIVE
REM ----- YOU 1-PANE VIEW (HIDDEN LEFT NAV PANE). ALSO, SHOWING/HIDING OF THE LEFT NAV PANE WAS
REM ----- INSTANTLY TOGGLED BY AN ICON ON THE EXPLORER GUI TOOLBAR.
REM ----- ON WINDOWS NT6 (VISTA, 7), EXPLORER WILL NOT OBEY YOUR COMMANDS AT ALL TIMES AND IT
REM ----- IS A "PITA" TO CONTROL THE GRAPHIC USER INTERFACE. 
REM ----- THIS INPUT SECTION IS A WORKAROUND TO FORCE AN INSTANCE OF NT6 EXPLORER TO BE
REM ----- TOGGLED TO A SPECIFIED VIEW.
REM ----- |
REM ----- | INSERT ONE OF THESE VALUES INTO THE VARIABLE _EXPLORER_VIEW_MYPREF_
REM ----- | | FOR EXPLORER 2-PANE VIEW (SHOW LEFT NAVPANE):  150100000100000000000000E5010000
REM ----- | | FOR EXPLORER 1-PANE VIEW (HIDE LEFT NAVPANE):  1501000000000000000000007B020000

    set _EXPLORER_VIEW_MYPREF_=1501000000000000000000007B020000

REM >>>>>>>>>> USER INPUT/PREFERENCES ARE ALL SET HERE [END] <<<<<<<<<<<<<<
REM >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>><<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<

REM ----- RUN THE TASK . . .

REM ----- REGKEY 'HKCU\Software\Microsoft\Windows\CurrentVersion\Explorer\Modules' DOES NOT EXIST IN NT5 OR EARLIER
REM ----- BUT TO ELIMINATE DOUBT WE WILL PERFORM A CONDITIONAL VERSION CHECK
for /f "tokens=2 delims=[]" %%A in ('ver') do set _THIS_OS_VERSTRING_=%%A
set _THIS_OS_VERSTRING_=%_THIS_OS_VERSTRING_:Version =%
for /f "tokens=1,2,3* delims=." %%A in ("%_THIS_OS_VERSTRING_%") do set _THIS_OS_MAJORVERSION_=%%A
if %_THIS_OS_MAJORVERSION_% leq 5 goto SKIP1

set _EXPLORER_VIEW_REGKEY_=HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Explorer\Modules\GlobalSettings\Sizer
set _EXPLORER_VIEW_REGVAL_=PageSpaceControlSizer
if exist ~TMP.TXT type NUL > ~TMP.TXT
reg.exe query %_EXPLORER_VIEW_REGKEY_% > ~TMP.TXT
if %ERRORLEVEL% equ 1 goto SKIP1
for /f "delims=" %%A in ('type "~TMP.TXT" ^|find.exe /i "%_EXPLORER_VIEW_REGVAL_%"') do echo %%A>~TMP.TXT
for /f "tokens=1-3 delims= " %%A in ('type "~TMP.TXT"') do set _EXPLORER_VIEW_SYSTEMPREF_=%%C
reg.exe add %_EXPLORER_VIEW_REGKEY_% /v %_EXPLORER_VIEW_REGVAL_% /t REG_BINARY /d %_EXPLORER_VIEW_MYPREF_% /f 2>nul >nul
nircmd.exe wait %_WAITTIME_%

:SKIP1
nircmd.exe exec show "explorer.exe" /n,%_WINLEFT_%
nircmd.exe wait %_WAITTIME_%
nircmd.exe win setsize foreground %_WINLEFTX_% %_WINLEFTY_% %_WINLEFTW_% %_WINLEFTH_%
nircmd.exe wait %_WAITTIME_%
nircmd.exe exec show "explorer.exe" /n,%_WINRIGHT_%
nircmd.exe wait %_WAITTIME_%
nircmd.exe win setsize foreground %_WINRIGHTX_% %_WINRIGHTY_% %_WINRIGHTW_% %_WINRIGHTH_%

REM ----- RESET SYSTEM PREF, CLEAR MEMORY, CLEANUP, QUIT . . .

find.exe /i /c "%_EXPLORER_VIEW_REGVAL_%" ~TMP.TXT
if %ERRORLEVEL% equ 1 goto SKIP2
nircmd.exe wait %_WAITTIME_%
nircmd.exe wait %_WAITTIME_%
reg.exe add %_EXPLORER_VIEW_REGKEY_% /v %_EXPLORER_VIEW_REGVAL_% /t REG_BINARY /d %_EXPLORER_VIEW_SYSTEMPREF_% /f 2>nul >nul
:SKIP2
set _SCREENW_=
set _SCREENH_=
set _WINLEFTX_=
set _WINLEFTY_=
set _WINLEFTW_=
set _WINLEFTH_=
set _WINRIGHTX_=
set _WINRIGHTY_=
set _WINRIGHTW_=
set _WINRIGHTH_=
set _WAITTIME_=
set _THIS_OS_VERSTRING_=
set _THIS_OS_MAJORVERSION_=
set _EXPLORER_VIEW_REGKEY_=
set _EXPLORER_VIEW_REGVAL_=
set _EXPLORER_VIEW_MYPREF_=
set _EXPLORER_VIEW_SYSTEMPREF_=
del /f /q ~TMP.TXT
popd
exit 
```

## 解决方案 2：多显示器计算机

此演示批处理文件将并排打开两个资源管理器窗口，并在双显示器桌面的另一个（非主）显示器的屏幕上居中。阅读批处理文件中的说明。

*注意：对于这个演示，我假设左侧监视器是 Monitor-1（主要活动监视器，包含任务栏），右侧监视器是 Monitor-2（非主要活动监视器）。如果您的设置不同，请调整脚本。*

使用的工具：
1\. Nir ​​Sofer 的**MonitorInfoView** *(41 KB)* .................[主页](http://www.nirsoft.net/utils/monitor_info_view.html)
2\. Nir ​​Sofer 的 MultiMonitorTool **(** *102 KB)* ......[主页](http://www.nirsoft.net/utils/multi_monitor_tool.html)
3\. Nir ​​Sofer 的**NirCmd** *(43 KB)* ....................[主页](http://www.nirsoft.net/utils/nircmd.html)
4.**批处理文件** *(6 KB ) )* .................................. 见下文

将所有四个文件收集到一个目录中。
这是批处理文件，可以在任何 Windows 系统上运行（*运行它以获得即时演示*）：

```
@echo off
REM ----- GIVE THIS CONSOLE WINDOW TITLE A UNIQUE STRING ID
title OPEN-2-EXPLORER-WINDOWS-SIDE-BY-SIDE-AND-CENTERED-ON-SCREEN-AT-MONITOR-2-OF-A-MULTI-MONITOR-DESKTOP___20140101024519
pushd %~dp0

REM ----- HIDE THIS CONSOLE WINDOW (HOOKS THE WINDOW TITLE)
nircmd.exe win hide ititle "OPEN-2-EXPLORER-WINDOWS-SIDE-BY-SIDE-AND-CENTERED-ON-SCREEN-AT-MONITOR-2-OF-A-MULTI-MONITOR-DESKTOP___20140101024519"

REM ********************** DESCRIPTION ************************************
REM ** This script opens one or more windows with specified screen properties
REM ** at a chosen monitor of a multi-monitor desktop. The "X/Y position" and
REM ** "W/H size" of the windows are auto-set by this script and the monitor
REM ** resolutions are auto-calculated to suit. 
REM ** 'MonitorInfoView.exe' is the helper tool used to isolate the resolution
REM ** info of the primary monitor (containing the taskbar).
REM ** 'MultiMonitorTool.exe' is the helper tool used to capture the 
REM ** resolution info of all monitors and for isolating the resolution info
REM ** of the other (non-primary) monitor.
REM ** 'nircmd.exe' is the tool performing all the display trickery.
REM **
REM ** To tweak this script, go to the code section named:
REM ** >>>>> USER INPUT/PREFERENCES ARE ALL SET HERE <<<<<
REM ***********************************************************************

REM ----- CLEAR ANY PREVIOUS JOB OUTPUTS IF THEY EXIST
if exist ~TMP.TXT type NUL > ~TMP.TXT
if exist ~TMP2.TXT type NUL > ~TMP2.TXT

REM ----- OUTPUT THE PRIMARY MONITOR (MONITOR-1) INFORMATION TO A TEXT FILE
MonitorInfoView.exe /hideinactivemonitors 1 /stext ~TMP.TXT

REM ----- ISOLATE THE RESOLUTION LINE OF MONITOR-1, REMOVING ALL THE OTHER LINES IN THE TEXT FILE
for /f "delims=" %%A in ('type "~TMP.TXT" ^|find.exe /i "Maximum Resolution"') do echo %%A>~TMP.TXT

REM ----- GET THE RESOLUTION NUMBERS OF MONITOR-1, AND SET THEM AS VARIABLES
for /f "tokens=3,4 delims=:X " %%A in ('type "~TMP.TXT"') do (
set _M1_SCREENW_=%%A
set _M1_SCREENH_=%%B
)

REM ----- OUTPUT INFO OF ALL MONITORS TO TEXT FILE
MultiMonitorTool.exe /stext ~TMP.TXT

REM ----- TRY REMOVING MONITOR-1 RESOLUTION LINE (KEEPING MONITOR-2 RESOLUTION LINE)
find.exe /i /v "%_M1_SCREENW_% X %_M1_SCREENH_%" < ~TMP.TXT > ~TMP2.TXT

REM ----- TRY ISOLATING MONITOR-2 RESOLUTION LINE (REMOVING ALL THE OTHER LINES IN THE TEXT FILE)
for /f "delims=" %%A in ('type "~TMP2.TXT" ^|find.exe /i "Maximum Resolution"') do echo %%A>~TMP2.TXT

REM ----- CONDITIONALLY GET THE RESOLUTION NUMBERS OF MONITOR-2, AND SET THEM AS VARIABLES ...
REM ----- CASE(A): IF MONITORS HAVE SAME RESOLUTION, ASSUME NO LINES HAVE STRING "Maximum Resolution". 
REM ----- CASE(B): IF MONITORS HAVE DIFFERENT RESOLUTION, ASSUME ONE LINE HAS STRING "Maximum Resolution".
find.exe /i /c "Maximum Resolution" ~TMP2.TXT
if %ERRORLEVEL% equ 1 (
set _M2_SCREENW_=%_M1_SCREENW_%&set _M2_SCREENH_=%_M1_SCREENH_%
) else (
for /f "tokens=3,4 delims=:X " %%A in ('type "~TMP2.TXT"') do set _M2_SCREENW_=%%A&set _M2_SCREENH_=%%B
)    

REM >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>><<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
REM >>>>>>>>>> USER INPUT/PREFERENCES ARE ALL SET HERE [BEGIN] <<<<<<<<<<<<

REM ----- MONITOR-2 LEFT WINDOW PROPERTIES

    set _M2_WINLEFT_=%SYSTEMDRIVE%
    set /a _M2_WINLEFTW_=(%_M2_SCREENW_% / 3) + 50
    set /a _M2_WINLEFTH_=(%_M2_SCREENH_% / 2) + 200
    set /a _M2_WINLEFTX_=(%_M1_SCREENW_%) + (%_M2_SCREENW_% - %_M2_WINLEFTW_%) / 5
    set /a _M2_WINLEFTY_=(%_M2_SCREENH_% - %_M2_WINLEFTH_%) / 2

REM ----- MONITOR-2 RIGHT WINDOW PROPERTIES

    set _M2_WINRIGHT_=%USERPROFILE%
    set /a _M2_WINRIGHTW_=(%_M2_SCREENW_% / 3) + 50
    set /a _M2_WINRIGHTH_=(%_M2_SCREENH_% / 2) + 200
    set /a _M2_WINRIGHTX_=(%_M2_WINLEFTX_%) + (%_M2_WINLEFTW_%)
    set /a _M2_WINRIGHTY_=(%_M2_SCREENH_% - %_M2_WINRIGHTH_%) / 2

REM ----- ADJUST THE WAIT TIME (MILLISECONDS) BETWEEN EACH WINDOW LAUNCH.
REM ----- IF TOO QUICK, THE FOLLOWING WINDOW WILL NOT SET IN THE CORRECT SCREEN POSITION.
REM ----- | FOR FAST SYSTEM: TRY 200 | NORMAL SYSTEM: TRY 400-600 | BLOATED SYSTEM: TRY 800-1200+

    set _WAITTIME_=400

REM ----- ON WINDOWS NT5 (XP, 2000), RUNNING EXPLORER WITH THE 'N' SWITCH WOULD RELIABLY GIVE
REM ----- YOU 1-PANE VIEW (HIDDEN LEFT NAV PANE). ALSO, SHOWING/HIDING OF THE LEFT NAV PANE WAS
REM ----- INSTANTLY TOGGLED BY AN ICON ON THE EXPLORER GUI TOOLBAR.
REM ----- ON WINDOWS NT6 (VISTA, 7), EXPLORER WILL NOT OBEY YOUR COMMANDS AT ALL TIMES AND IT
REM ----- IS A "PITA" TO CONTROL THE GRAPHIC USER INTERFACE. 
REM ----- THIS INPUT SECTION IS A WORKAROUND TO FORCE AN INSTANCE OF NT6 EXPLORER TO BE
REM ----- TOGGLED TO A SPECIFIED VIEW.
REM ----- |
REM ----- | INSERT ONE OF THESE VALUES INTO THE VARIABLE _EXPLORER_VIEW_MYPREF_
REM ----- | | FOR EXPLORER 2-PANE VIEW (SHOW LEFT NAVPANE):  150100000100000000000000E5010000
REM ----- | | FOR EXPLORER 1-PANE VIEW (HIDE LEFT NAVPANE):  1501000000000000000000007B020000

    set _EXPLORER_VIEW_MYPREF_=1501000000000000000000007B020000

REM >>>>>>>>>> USER INPUT/PREFERENCES ARE ALL SET HERE [END] <<<<<<<<<<<<<<
REM >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>><<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<

REM ----- RUN THE TASK . . .

REM ----- REGKEY 'HKCU\Software\Microsoft\Windows\CurrentVersion\Explorer\Modules' DOES NOT EXIST IN NT5 OR EARLIER
REM ----- BUT TO ELIMINATE DOUBT WE WILL PERFORM A CONDITIONAL VERSION CHECK
for /f "tokens=2 delims=[]" %%A in ('ver') do set _THIS_OS_VERSTRING_=%%A
set _THIS_OS_VERSTRING_=%_THIS_OS_VERSTRING_:Version =%
for /f "tokens=1,2,3* delims=." %%A in ("%_THIS_OS_VERSTRING_%") do set _THIS_OS_MAJORVERSION_=%%A
if %_THIS_OS_MAJORVERSION_% leq 5 goto SKIP1

set _EXPLORER_VIEW_REGKEY_=HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Explorer\Modules\GlobalSettings\Sizer
set _EXPLORER_VIEW_REGVAL_=PageSpaceControlSizer
if exist ~TMP.TXT type NUL > ~TMP.TXT
reg.exe query %_EXPLORER_VIEW_REGKEY_% > ~TMP.TXT
if %ERRORLEVEL% equ 1 goto SKIP1
for /f "delims=" %%A in ('type "~TMP.TXT" ^|find.exe /i "%_EXPLORER_VIEW_REGVAL_%"') do echo %%A>~TMP.TXT
for /f "tokens=1-3 delims= " %%A in ('type "~TMP.TXT"') do set _EXPLORER_VIEW_SYSTEMPREF_=%%C
reg.exe add %_EXPLORER_VIEW_REGKEY_% /v %_EXPLORER_VIEW_REGVAL_% /t REG_BINARY /d %_EXPLORER_VIEW_MYPREF_% /f 2>nul >nul
nircmd.exe wait %_WAITTIME_%

:SKIP1
nircmd.exe exec show "explorer.exe" /n,%_M2_WINLEFT_%
nircmd.exe wait %_WAITTIME_%
nircmd.exe win setsize foreground %_M2_WINLEFTX_% %_M2_WINLEFTY_% %_M2_WINLEFTW_% %_M2_WINLEFTH_%
nircmd.exe wait %_WAITTIME_%
nircmd.exe exec show "explorer.exe" /n,%_M2_WINRIGHT_%
nircmd.exe wait %_WAITTIME_%
nircmd.exe win setsize foreground %_M2_WINRIGHTX_% %_M2_WINRIGHTY_% %_M2_WINRIGHTW_% %_M2_WINRIGHTH_%

REM ----- RESET SYSTEM PREF, CLEAR MEMORY, CLEANUP, QUIT . . .

find.exe /i /c "%_EXPLORER_VIEW_REGVAL_%" ~TMP.TXT
if %ERRORLEVEL% equ 1 goto SKIP2
nircmd.exe wait %_WAITTIME_%
nircmd.exe wait %_WAITTIME_%
reg.exe add %_EXPLORER_VIEW_REGKEY_% /v %_EXPLORER_VIEW_REGVAL_% /t REG_BINARY /d %_EXPLORER_VIEW_SYSTEMPREF_% /f 2>nul >nul
:SKIP2
set _M1_SCREENW_=
set _M1_SCREENH_=
set _M2_SCREENW_=
set _M2_SCREENH_=
set _M2_WINLEFT_=
set _M2_WINLEFTX_=
set _M2_WINLEFTY_=
set _M2_WINLEFTW_=
set _M2_WINLEFTH_=
set _M2_WINRIGHT_=
set _M2_WINRIGHTX_=
set _M2_WINRIGHTY_=
set _M2_WINRIGHTW_=
set _M2_WINRIGHTH_=
set _WAITTIME_=
set _THIS_OS_VERSTRING_=
set _THIS_OS_MAJORVERSION_=
set _EXPLORER_VIEW_REGKEY_=
set _EXPLORER_VIEW_REGVAL_=
set _EXPLORER_VIEW_MYPREF_=
set _EXPLORER_VIEW_SYSTEMPREF_=
del /f /q ~TMP.TXT
del /f /q ~TMP2.TXT
popd
exit 
```

* * *

 **## **更多的 。. .
运行命令行程序并设置其控制台窗口的位置/大小**

**此演示批处理文件**将运行命令行程序并设置其命令提示符控制台窗口的位置和大小。这批的大体主题与前两个解决方案相同，但有一些独特的问题和解决方法使这个工作 - 这是由“CMD.EXE”托管的命令提示符窗口，而不是像 GUI 窗口'EXPLORER.EXE'----阅读批处理文件中的所有注释以获取更多信息。也阅读描述。

使用的工具：
1\. Nir ​​Sofer 的**MonitorInfoView** *(41 KB)* ....[主页](http://www.nirsoft.net/utils/monitor_info_view.html)
2\. Nir ​​Sofer 的**NirCmd** *(43 KB)* .................... .......[主页](http://www.nirsoft.net/utils/nircmd.html)
3\. Daniel Scheibli 的**GetPIDs***(280 KB)* ....................[主页](http://www.scheibli.com/projects/getpids/)
4.**命令行程序**.................... .对于这个演示，我正在从与批处理相同的目录中运行“UPX.EXE”...[主页](http://upx.sourceforge.net/)
5.**批处理文件** *（6 KB）* ...................... ......................见下文

将所有五个文件收集到一个目录中。
这是一个批处理文件，准备在任何 Windows 系统上*运行（运行它以进行即时演示）*：

这个演示批处理将做什么，除了为您提供自定义控制台窗口之外，它是否将`upx.exe`使用命令行运行开关`--best -v -o getpids-compressed.exe getpids.exe`。我们将压缩我们的工具`GetPIDs`（即 280 KB）降至 88 KB！..........启动后，双击这个控制台窗口的标题栏，看到一个有趣的现象；这个控制台窗口的行为就像一个 GUI！

```
@echo off
setlocal enabledelayedexpansion enableextensions
pushd %~dp0%

REM ----- ADD SOME USEFUL INFORMATION TO THIS CONSOLE WINDOW TITLE.
for /f "tokens=3" %%A in ('getpids.exe') do set _PROCESS_ID_=%%A
title This batch file runs a command-line program and sets the position and size of its console window        (PROCESS ID = %_PROCESS_ID_%)

REM ********************** DESCRIPTION ************************************
REM ** This script opens a command-line program console window with specified
REM ** screen properties at the primary monitor (containing the taskbar).
REM ** The "X/Y position" and "W/H size" of the console window is auto-set by
REM ** this script and the monitor resolution is auto-calculated to suit.
REM ** 'MonitorInfoView.exe' is the helper tool used to capture the resolution
REM ** info of the monitor.
REM ** 'nircmd.exe' is the tool performing all the display trickery.
REM ** 'getpids.exe' is the helper tool used to capture the Process ID of the
REM ** working batch file, thus allowing us to identify which CMD.EXE host this
REM ** console window belongs to when looking at Task Manager.
REM **
REM ** To tweak this script, go to the code section named:
REM ** >>>>> USER INPUT/PREFERENCES ARE ALL SET HERE <<<<<
REM ***********************************************************************

REM ----- CLEAR ANY PREVIOUS JOB OUTPUTS IF THEY EXIST
if exist ~TMP.TXT type NUL > ~TMP.TXT

REM ----- OUTPUT THE PRIMARY MONITOR INFORMATION TO A TEXT FILE
MonitorInfoView.exe /hideinactivemonitors 1 /stext ~TMP.TXT

REM ----- ISOLATE THE RESOLUTION LINE, REMOVING ALL THE OTHER LINES IN THE TEXT FILE
for /f "delims=" %%A in ('type "~TMP.TXT" ^|find.exe /i "Maximum Resolution"') do echo %%A>~TMP.TXT

REM ----- GET THE RESOLUTION NUMBERS, AND SET THEM AS VARIABLES
for /f "tokens=3,4 delims=:X " %%A in ('type "~TMP.TXT"') do set _SCREENW_=%%A& set _SCREENH_=%%B

REM >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>><<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
REM >>>>>>>>>> USER INPUT/PREFERENCES ARE ALL SET HERE [BEGIN] <<<<<<<<<<<<

REM ----- ----------------------------------------
REM ----- |COMMAND-LINE PROGRAM TO BE RUN:  FILE NAME (WITH EXTENSION)
REM ----- |
REM ----- | |IF PROG TO BE RUN IS 'CMD.EXE' (WINDOWS COMMAND PROCESSOR)
REM ----- | |ALSO READ THE NEXT COMMENTS ABOUT SETTING SWITCHES

    set _MYPROGRAM_=upx.exe

REM ----- ----------------------------------------   
REM ----- |COMMAND-LINE PROGRAM TO BE RUN:  SWITCHES (TO BE PASSED TO THE PROGRAM)
REM ----- |
REM ----- | |YOU CAN LEAVE THIS VARIABLE WITH A BLANK VALUE IF RUNNING THE PROG WITHOUT ANY PARAMETERS
REM ----- | | 
REM ----- | | |IF THE VALUE CONTAINS THE CHARS  '|'  OR  '<'  OR  '>'  THIS BATCH WILL FAIL TO RUN !!!
REM ----- | | |
REM ----- | | | |YOU CAN APPEND EXTRA TEXT TO THE END OF THE COMMAND BY USING THE AMPERSAND CHARACTER '&'
REM ----- | | | | EXAMPLES:
REM ----- | | | | set _MYPROGRAMSWITCHES_=dir "%systemroot%\system32" /a/o/s/4 & this text will be ignored; useful for adding some inline comments.
REM ----- | | | | set _MYPROGRAMSWITCHES_=dir "%systemroot%\system32" /a/o/s/4         & this works too, and the extra blank spaces will also be ignored.
REM ----- | | | | 
REM ----- | | | | |IF PROG TO BE RUN IS 'CMD.EXE' (WINDOWS COMMAND PROCESSOR), PATH ARGUMENTS MUST POINT TO A SPECIFIC LOCATION
REM ----- | | | | |AND BE ABSOLUTE OR INCLUDE ENVIRONMENT VARIABLES, AND ALWAYS ENCLOSE PATHS IN QUOTES.
REM ----- | | | | | EXAMPLES:
REM ----- | | | | | set _MYPROGRAMSWITCHES_=type "C:\Folder With Spaces\File.txt"
REM ----- | | | | | set _MYPROGRAMSWITCHES_=type "C:\FolderWithoutSpaces\File.txt"
REM ----- | | | | | set _MYPROGRAMSWITCHES_=type "%SYSTEMROOT%\..\Folder With Spaces\File.txt"
REM ----- | | | | | set _MYPROGRAMSWITCHES_=type %0                                       <<<<<<<this batch file (quotes are optional; the only exception to the rule)
REM ----- | | | | | set _MYPROGRAMSWITCHES_=type "%~dp0%\..\File.txt"                     <<<<<<<goes back one Dir from this batch file
REM ----- | | | | | set _MYPROGRAMSWITCHES_=dir "%systemroot%\system32" /a/o/s/4          <<<<<<<displays directory listing of the System folder. NOTE: 'dir' by itself and
REM ----- | | | | |                                                                                without a specific path argument will resolve to the folder of this batch file.

    set _MYPROGRAMSWITCHES_=--best -v -o getpids-compressed.exe getpids.exe      &// original is 280 KB, will compress down to 88 KB

REM ----- ----------------------------------------
REM ----- |COMMAND-LINE PROGRAM TO BE RUN:  DIRECTORY PATH (OF THE PROGRAM)
REM ----- | 
REM ----- | |YOU CAN LEAVE THIS VARIABLE WITH A BLANK VALUE IF THE PROG IS AT SAME LOCATION AS BATCH
REM ----- | |THIS VARIABLE WILL BE IGNORED IF THE PROG IS 'CMD.EXE'
REM ----- | | 
REM ----- | | EXAMPLES:
REM ----- | | set _MYPROGRAMDIR_=.\                               <<<<<<<program and batch in same directory
REM ----- | |                                                                  dot backslash *OR* dot (trailing backslash is optional).
REM ----- | | set _MYPROGRAMDIR_=%dp0%                            <<<<<<<program and batch in same directory
REM ----- | |                                                                  same locatiion as previous but using environment variable.
REM ----- | | set _MYPROGRAMDIR_=..\                              <<<<<<<program is back one directory from batch
REM ----- | |                                                                  dot dot backslash *OR* dot dot (trailing backslash is optional).
REM ----- | | set _MYPROGRAMDIR_=%dp0%\..                         <<<<<<<program is back one directory from batch
REM ----- | |                                                                  same as location as previous but using environment variable.
REM ----- | | set _MYPROGRAMDIR_=%SYSTEMROOT%\..\My Utilities     <<<<<<<program is back one directory from the Windows folder
REM ----- | |                                                                  and then forwards into the folder 'My Utilities'
REM ----- | | set _MYPROGRAMDIR_=C:\My Utilities\                 <<<<<<<enclosing quotes are optional; trailing backslash is optional
REM ----- | |                                                                  same location as previous

    set _MYPROGRAMDIR_=

REM ----- ----------------------------------------
REM ----- |SET THE WANTED DIMENSIONS OF THIS CONSOLE WINDOW

    set /a _WINW_=(%_SCREENW_% / 2) + 250
    set /a _WINH_=(%_SCREENH_% / 2) + 150
    set /a _WINX_=(%_SCREENW_% - %_WINW_%) / 2
    set /a _WINY_=(%_SCREENH_% - %_WINH_%) / 2

REM ----- ----------------------------------------
REM ----- |STYLE THIS CONSOLE WINDOW   !!!IMPORTANT!!!
REM ----- |
REM ----- | |IF WE DO NOT USE THE 'MODE' COMMAND HERE ALONG WITH ITS 'COLS/LINES' VALUES THEN
REM ----- | |THE POSITIONING/SIZING OF THIS WINDOW BY 'NIRCMD.EXE' FURTHER DOWN WILL NOT WORK !!!
REM ----- | |
REM ----- | | |SOME COMMANDS WILL OUTPUT A LOT OF LINES AND AND THE CONSOLE DISPLAY WILL BE TRUNCATED
REM ----- | | |RUN THIS FOR AN EXAMPLE=====>   cmd.exe dir "%systemroot%\system32" /a/o/s/4   <=====
REM ----- | | |TO SOLVE THIS PROBLEM, SET THE 'LINES' VALUE OF 'MODE' TO A VERY HIGH NUMBER
REM ----- | | |THE MAXIMUM NUMBER IS 32000 (ON MY SYSTEM); 'MODE' WILL BE IGNORED IF THE NUMBER IS HIGHER !!!  

    color 0A
    mode.com con:cols=%_SCREENW_% lines=10000

REM ----- ----------------------------------------
REM ----- |DELETE THE TEMP TEXT FILE MADE BY 'MonitorInfoView.exe'
REM ----- |COMMENT OUT THE LINE IF YOU DON'T CARE ABOUT DELETING IT

    del /f /q ~TMP.TXT 2>nul >nul

REM >>>>>>>>>> USER INPUT/PREFERENCES ARE ALL SET HERE [END] <<<<<<<<<<<<<<
REM >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>><<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<

REM ----- RUN THE TASK . . .
nircmd.exe win setsize foreground %_WINX_% %_WINY_% %_WINW_% %_WINH_%
popd

if not defined _MYPROGRAMDIR_ set _MYPROGRAMDIR_=%~dp0
if "!_MYPROGRAMDIR_!" == "." set _MYPROGRAMDIR_=%~dp0
if "!_MYPROGRAMDIR_!" == ".\" set _MYPROGRAMDIR_=%~dp0
pushd %_MYPROGRAMDIR_%
if not exist %_MYPROGRAMDIR_% goto _SKIP_
set _CONVERT_PATH_="%CD%"
set _CONVERT_PATH_=%_CONVERT_PATH_:"=%
set _MYPROGRAMDIR_=%_CONVERT_PATH_%
:_SKIP_
popd

echo ===============================================================================
echo PROGRAM ..............: !_MYPROGRAM_!
if "!_MYPROGRAM_!"=="cmd.exe" (echo PROGRAM DIR ..........: %SYSTEMROOT%\system32) else (echo PROGRAM DIR ..........: !_MYPROGRAMDIR_!)
echo PROGRAM SWITCHES .....: !_MYPROGRAMSWITCHES_!
echo ===============================================================================

if "!_MYPROGRAM_!"=="cmd.exe" (goto _PROGRAM_IS_CMD_) else (goto _PROGRAM_IS_OTHER_)

:_PROGRAM_IS_CMD_
cd /d "%SYSTEMROOT%\system32"
!_MYPROGRAMSWITCHES_!
echo. & echo. & echo.
goto _END_

:_PROGRAM_IS_OTHER_ 
cd /d "!_MYPROGRAMDIR_!"
if "%CD%\!_MYPROGRAM_!" == "%CD%\" goto _ERRORMESSAGE_
if not exist "%CD%\!_MYPROGRAM_!" goto _ERRORMESSAGE_
"!_MYPROGRAMDIR_!\!_MYPROGRAM_!" !_MYPROGRAMSWITCHES_!
echo. & echo. & echo.
goto _END_

:_ERRORMESSAGE_
cls
color 4F
echo ===============================================================================
echo PROGRAM ..............: !_MYPROGRAM_!
echo PROGRAM DIR ..........: !_MYPROGRAMDIR_!
echo PROGRAM SWITCHES .....: !_MYPROGRAMSWITCHES_!
echo ===============================================================================
echo                        ^^!^^!^^!  E R R O R  ^^!^^!^^!
echo.
echo The program has failed to run; the path set by the above values does not exist.
echo Please exit this window and check the values you have set in this batch file.
echo.
echo This batch file is located here:
echo %0
echo. & echo. & echo. & echo. & echo.

:_END_

REM ----- CLEAR VARIABLE VALUES FROM MEMORY . . .
set _PROCESS_ID_=
set _SCREENW_=
set _SCREENH_=
set _MYPROGRAM_=
set _MYPROGRAMSWITCHES_=
set _MYPROGRAMDIR_=
set _WINW_=
set _WINH_=
set _WINX_=
set _WINY_=
set _CONVERT_PATH_=

REM ----- STOP THIS CONSOLE WINDOW FROM CLOSING   !!!IMPORTANT!!! . . .
REM ----- SEE <http://superuser.com/questions/306167/how-to-prevent-the-command-prompt-from-closing-after-execution>
cmd.exe 
```

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2018-09-23T19:36:00.357

以下方法对于不想下载第三方工具并拥有现代*PowerShell* (PS) 的新用户很有用。

脚本基于Garry Galler 的[帖子](http://www.cyberforum.ru/post7895914.html)。问题中的所有文件夹，但您可以替换为您的文件夹。

`SetPositionAndSizeForExplorerWindow.ps1`使用 PS 脚本创建文件：

```
# PowerShell script for opening Explorer windows and changing its position and size

# add .NET type
Add-Type @"
  using System;
  using System.Runtime.InteropServices;
  public class Win32 {
    [DllImport("user32.dll")]
    [return: MarshalAs(UnmanagedType.Bool)]
    public static extern bool GetWindowRect(IntPtr hWnd, out RECT lpRect);
    [DllImport("user32.dll")]
    [return: MarshalAs(UnmanagedType.Bool)]
    public static extern bool MoveWindow(IntPtr hWnd, int X, int Y, int nWidth, int nHeight, bool bRepaint);
    [DllImport("user32.dll")]
    public static extern IntPtr FindWindow(string ClassName, IntPtr  TitleApp);
  }
  public struct RECT
  {
    public int Left;        // x position of upper-left corner
    public int Top;         // y position of upper-left corner
    public int Right;       // x position of lower-right corner
    public int Bottom;      // y position of lower-right corner
  }
"@

# set variable for RECT object
$rcWindow = New-Object RECT

#----- REPLACE WITH YOUR PATHs from HERE---------

# open first folder in separate Explorer process
explorer.exe "c:\develop\jboss-4.2.3.GA\server\default\deploy"

# magic sleep =) to wait starting explorer on slow machines
sleep -Milliseconds 1500

$h1 = (Get-Process | where {$_.mainWindowTitle -match "deploy"}).MainWindowHandle

# check if there is a window with this Title, if NO - return
if ($h1 -eq [IntPtr]::Zero) {return "Cannot find window with this Title"}

# bind RECT object with our window
[void][Win32]::GetWindowRect($h1,[ref]$rcWindow)
# set new position and size for window 
[void][Win32]::MoveWindow($h1, 10, 10, 700, 345, $true)

# remember PID to exclude it for next window with the same name
$duplicate = (Get-Process | where {$_.mainWindowTitle -match "deploy"}).Id

# open second folder in separate Explorer process
explorer.exe "c:\develop\Project\Mapping\deploy"
sleep -Milliseconds 1500
$h1 = (Get-Process | where {$_.mainWindowTitle -match "deploy" -and $_.Id -ne $duplicate}).MainWindowHandle
if ($h1 -eq [IntPtr]::Zero) {return "Cannot find window with this Title"}
[void][Win32]::GetWindowRect($h1,[ref]$rcWindow)
[void][Win32]::MoveWindow($h1, 400, 20, 700, 335, $true)

# open cmd window with title SetupEnvCmd.cmd
cmd /c "start C:\develop\jboss-4.2.3.GA\bin\SetupEnvCmd.cmd"
sleep -Milliseconds 1500
# cmd.exe process has no own title, that's why we get PID searching by CommandLine process property
$process = "cmd.exe"
$cmdPID = Get-CimInstance Win32_Process -Filter "name = '$process'" | where {$_.CommandLine -match "SetupEnvCmd"} | select ProcessId
$h1 = (Get-Process | where {$_.Id -eq $cmdPID.ProcessId}).MainWindowHandle
if ($h1 -eq [IntPtr]::Zero) {return "Cannot find window with this Title"}
[void][Win32]::GetWindowRect($h1,[ref]$rcWindow)
[void][Win32]::MoveWindow($h1, 200, 400, 800, 400, $true) 
```

将其移至`C:\develop folder`. 创建`OpenDevelopEnv.bat`文件来运行这个 .ps1 脚本（为了不深入研究 PS 的安全策略）：

```
Powershell -executionpolicy RemoteSigned -File "C:\develop\SetPositionAndSizeForExplorerWindow.ps1" 
```

跑`OpenDevelopEnv.bat`

**对于多显示器配置**，您可以使用负坐标，例如：对于左显示器（相对于主显示器）打开窗口，您可以编写：

```
[void][Win32]::MoveWindow($h1, -600, 400, 800, 400, $true) 
```

**缺点：**

*   必须安装 PowerShell；
*   必须关闭所需的窗户；
*   文件夹在不同的进程中开始；
*   使用睡眠时间在慢速机器上正确工作。

*测试*：Windows 10 Pro 1803 x64/x86 和 PSVersion 5.1（管理员和普通用户）

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2012-05-01T02:03:11.070

尝试通过批处理文件从 VBS（Windows 脚本宿主）脚本启动您的程序。如果您的 VBS 如下所示：

```
'FILENAME: SetEnv.vbs
Set Shell = WScript.CreateObject("WScript.Shell")
Shell.Run "Explorer /n,c:\develop\jboss-4.2.3.GA\server\default\deploy", 4, False
Shell.Run "Explorer /n,c:\develop\Project\Mapping\deploy", 4, False 
```

`4`以最近的大小/位置启动窗口的方法 。`False`意味着它在执行脚本的下一行之前不会等待返回。不幸的是，这并不能让您完全控制确切的窗口大小/定位，但它应该记住最后的大小/定位。

更多信息在这里： http: [//www.devguru.com/Technologies/wsh/quickref/wshshell_Run.html](http://www.devguru.com/Technologies/wsh/quickref/wshshell_Run.html)

所以你的新 SetEnv.cmd 可能是：

```
@echo off
REM note there's a difference between cscript and wscript
REM wscript is usually the default launcher
cscript SetEnv.vbs
cd C:\develop\jboss-4.2.3.GA\bin
run 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2015-09-09T02:43:15.893

查看[**StartX**](http://www.naughter.com/startx.html)。我没有使用它，但看起来您可以使用它来启动具有特定位置和大小的应用程序。

> StartX，一个非常简单的实用程序，允许您从命令行调用 CreateProcess API。

它的一些命令行参数：

```
StartX ["title"] [/Dpath] [/MIN] [/MAX] [/Px,y] [/Scx1,cy1] 
```

> **x,y：** 如果创建了新窗口，则指定窗口左上角的 x 和 y 偏移量（以像素为单位）。偏移量是从屏幕的左上角开始的。
> 
> **cx1, cy2：** 如果创建了新窗口，则指定窗口的宽度和高度（以像素为单位）。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2016-09-26T16:42:18.040

作为替代方案，我建议使用[AutoHotKey](http://www.autohotkey.com/)，它可以轻松处理这个问题（我认为比 Powershell 和 Batch 更好）。

作为一个简单的示例，要启动资源管理器的两个实例，调整它们的大小（并移动）它们，然后对 cmd 窗口执行相同的操作，您可能会执行以下操作：

```
Run Explorer /n,c:\develop\jboss-4.2.3.GA\server\default\deploy
Run Explorer /n,c:\develop\Project\Mapping\deploy
WinMove, deploy, server\default, 0, 0, 200, 200
WinMove, deploy, Project\Mapping, 200, 0, 200, 200
Run cmd /c SetupEnvCmd.cmd
WinMove, C:\develop\jboss-4.2.3.GA\bin, 0, 200 
```

[WinMove 帮助文档](http://www.autohotkey.com/docs/commands/WinMove.htm)**

# visual-studio-2010 - 如何创建运行 VSIX 方法的快捷方式？

> ID：10392622
> 
> 赞同：3
> 
> 时间：2012-05-01T01:48:52.283
> 
> 标签：visual-studio-2010, vsix, vs-extensibility, visual-studio-extensions

请看[这个](https://stackoverflow.com/questions/10367439/easy-vsix-get-started/10367523)问题。

最初的问题已经解决，我的扩展中有一个方法。我希望当用户安装扩展程序时，也应该安装一个键盘快捷键，并且应该在按下时运行该方法。

我该怎么做呢？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-23T16:12:23.203

您可以将快捷方式添加到 .vsct 文件。当您生成新扩展并说它将具有菜单命令时，该文件会在向导中自动创建。手动添加：

*   创建 MyCommands.vsct
*   将文件属性设置为 VSCTCompile
*   卸载您的项目，右键单击并编辑项目：

```
<VSCTCompile Include="MyCommands.vsct">
    <ResourceName>Menus.ctmenu</ResourceName>
    <SubType>Designer</SubType>
</VSCTCompile> 
```

*   声明您的项目将有菜单和快捷方式：

```
[ProvideMenuResource("Menus.ctmenu",1)]
public sealed class MyPackage : Package 
```

*   添加键绑定部分：

```
<KeyBindings>
   <KeyBinding guid="yourCmdSet" id="cmdAwesome"
    editor="guidVSStd97"
    key1="VK_F7" mod1="Control Alt"
    key2="VK_F1">
   </KeyBinding>
</KeyBindings> 
```

*   在您的 Package.Initialize 中：

```
// Add our command handlers for menu/shortcut (commands must exist in the .vsct file)
OleMenuCommandService mcs = GetService(typeof(IMenuCommandService)) as OleMenuCommandService;
if (null != mcs)
{
    //// Create the command for the menu item.
    var menuCommandID = new CommandID(GuidList.yourCmdSet,(int)PkgCmdIDList.cmdAwesome);
    var menuItem = new MenuCommand((sender, evt) =>
    {
        // Do stuff
    }
} 
```

更多资源：

*   [http://dotneteers.net/blogs/divedeeper/archive/2008/04/17/LearnVSXNowPart18A.aspx](http://dotneteers.net/blogs/divedeeper/archive/2008/04/17/LearnVSXNowPart18A.aspx)
*   [http://msdn.microsoft.com/de-de/library/bb165138(v=vs.90).aspx](http://msdn.microsoft.com/de-de/library/bb165138(v=vs.90).aspx)
*   [http://dotneteers.net/blogs/divedeeper/archive/2008/02/22/LearnVSXNowPart13.aspx](http://dotneteers.net/blogs/divedeeper/archive/2008/02/22/LearnVSXNowPart13.aspx)

# c# - NHibernate 懒惰问题

> ID：10392624
> 
> 赞同：3
> 
> 时间：2012-05-01T01:49:30.440
> 
> 标签：c#, hibernate, nhibernate, yield, lazy-evaluation

```
public IEnumerable<UserReadNews> GetLatestUserReadNews(IEnumerable<string> userIds)
{

    IQuery query = Session.CreateQuery("from UserReadNews as j where j.FacebookUser_id in (:userIds)");
    query.SetParameterList("userIds", userIds );
    return query.List();
} 
```

我有这种方法，我想尽可能延迟地返回这些数据，因为我正在确定要显示哪些数据然后停止。我不希望针对整个表执行整个查询。

我关心的是 List() 方法。这是懒惰还是渴望？

我可以从另一个方法调用这个方法`yield break`吗？当我完成我需要的东西时？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-01T18:35:56.037

我同意@CSharper 关于只查询您绝对需要的内容的观点。

如果您在优化后仍需要使其尽可能懒惰，请使用`ICriteria.Future<T>()`代替`ICriteria.List<T>()`：

```
public IEnumerable<UserReadNews> GetLatestUserReadNews(IEnumerable<string> userIds)
{
    IQuery query = Session.CreateQuery("from UserReadNews as j where j.FacebookUser_id in (:userIds)");
    query.SetParameterList("userIds", userIds );
    return query.Future<UserReadNews>();
} 
```

`Future`将为您提供一个带有延迟查询的实际 IEnumerable，而不是立即提供整个列表。如果有机会，它有时也会优化查询。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-01T18:24:49.113

IQuery.List 总是返回整个结果集，因此使用 yield 中断提前终止消耗循环无助于变得更加懒惰。

最好的事情是（如果在这种情况下可行的话）将您真正需要的结果集中的哪些项目放在查询中，这样您就不会费力地获取不需要的数据。

# javascript - Javascript 常见任务表单库

> ID：10392625
> 
> 赞同：3
> 
> 时间：2012-05-01T01:49:41.317
> 
> 标签：javascript, forms

如果有人在操作表单时知道具有常见任务的库，我会很有趣，我需要一些高级任务，例如显示/隐藏其他字段的条件选择器、克隆字段、在父选择器更改时重置子选择器、动态地向选择器添加选项等。

我已经有使用 jquery 执行其中一些任务的自定义函数，但不是“可移植的”，因为我为特定的应用程序制作了它，我想有比我做的更好的方法来做到这一点。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-01T02:23:08.577

我建议使用[jQuery Validation 插件](http://docs.jquery.com/Plugins/Validation)。

我以前没有意识到，但是你可以用它做很多事情。它是可移植的，将帮助您实现表单的更多自定义需求。

# objective-c - 使用 google maps api v3 更改 iOS 中的位置权限对话框

> ID：10392629
> 
> 赞同：3
> 
> 时间：2012-05-01T01:51:07.500
> 
> 标签：objective-c, ios, google-maps-api-3, permissions, dialog

我正在使用 google maps javascript API v3 在 UIWebView 中显示地图。

但是，当弹出询问用户对 locationServices 权限的对话框时，我得到一个很长的、神秘的字符串。使用 CoreLocation，我可以添加一条方便的消息（目的）来显示另一条消息，但是，我不能使用 CoreLocation（由于各种原因），因为网页要求许可，尽管“应用程序可能已经拥有它”。

如何将此对话框的文本更改为对用户更友好的内容？

提前致谢！！

![在此处输入图像描述](../Images/8625ecc248bfa6c94e18868939a73224.png)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-10T10:31:55.970

我不明白为什么你不能使用 CoreLocation 服务，因为权限被授予应用程序级别，而不是域/url，即使你从之前已经加载的 webview 中使用它。因此，请求 CoreLocation 的许可将解决您的问题，并且 AFAIK 不会引入重复的消息。

除此之外，我认为您没有办法自定义此消息。javascript API 不提供此类自定义，您甚至可以尝试深入研究 Webview 的私有 API 以检查是否存在需要此信息的方法，但我想您最终会使用 CoreLocation 并且您会发现问题AppStore 审核流程。

再一次，如果您解释为什么不能使用 CoreLocation，我们将能够更好地理解问题并寻找解决方法。

# nsxmlparser - 设计NSObject类调用web方法

> ID：10392639
> 
> 赞同：1
> 
> 时间：2012-05-01T01:54:15.600
> 
> 标签：nsxmlparser, nsobject

我在由 NSObject 继承的单独类中编写我的 post 方法，我在其中发送两个参数，即用户名和密码以及 viewcontroller 的引用作为委托。我应该如何在这个类中构造初始化方法。通常我在这个类中使用本机解析器进行解析。

到目前为止，我一直在这样做：

```
-(void)initWith:(NSString *)username password:(NSString*)password delegate:(id<name>)delegate 
```

{

```
NSString *soapMessage = [[NSString alloc] initWithFormat:

                         @"<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n"
                         "<soapenv:Envelope \n"
                         "xmlns:soapenv=\"http://schemas.xmlsoap.org/soap/envelope/\" \n"
                         "xmlns:tem=\"http://tempuri.org/\"> \n"
                         "<soapenv:Header/>\n"
                         "<soapenv:Body>\n"
                         "<tem:Login>\n"

                         "<tem:username>%@</tem:username>\n"

                         "<tem:password>%@</tem:password>\n"

                         "</tem:Login>\n"

                         "</soapenv:Body>\n"

                         "</soapenv:Envelope>\n",hisUDID,myUDID];

NSURL *url = [NSURL URLWithString:kBaseURL];               
// NSMutableURLRequest *theRequest = [NSMutableURLRequest requestWithURL:url];

NSMutableURLRequest *theRequest = [[NSMutableURLRequest alloc] initWithURL:url];

NSString *msgLength = [[NSString alloc] initWithFormat:@"%d", [soapMessage length]];          
[theRequest addValue: @"text/xml; charset=utf-8" forHTTPHeaderField:@"Content-Type"];       
[theRequest addValue: @"http://tempuri.org/XXXXX/Login" forHTTPHeaderField:@"Soapaction"];
[theRequest addValue: msgLength forHTTPHeaderField:@"Content-Length"];
[theRequest setHTTPMethod:@"POST"];     
[theRequest setHTTPBody: [soapMessage dataUsingEncoding:NSUTF8StringEncoding]];
theConnection = [[NSURLConnection alloc] initWithRequest:theRequest delegate:self];
[msgLength release];
[soapMessage release];

[theRequest release];
theRequest=nil;

if(theConnection)
{
    webData = [[NSMutableData data] retain];
}
else
{
    NSLog(@"The Connection is NULL");
} 
```

}

一般来说，我已经看到初始化程序具有返回类型 id，它初始化了一些需要的 sata 结构......请提供建议，因为我想学习一种构造 init 方法的好方法！

# ajax - Django & Ajax - 没有返回语句的视图

> ID：10392645
> 
> 赞同：4
> 
> 时间：2012-05-01T01:54:44.060
> 
> 标签：ajax, django, post

在我的 Django 应用程序中，我有一个项目列表，每个项目旁边都有一个“删除”选项。我希望用户能够单击“删除”按钮，让它发送一个 $.post 到 Django 视图，在那里它将删除该实例。成功删除此实例后，我将在 javascript 中触发另一个 Ajax 请求以重绘列表而不删除已删除的实例。

我的问题：如果我实际上没有向 $.post 返回值，那么我应该使用 ajax 来执行此操作吗？Ajax 是专门用于检索信息的吗？即使我实际上没有返回任何东西，是否需要 Django 视图来返回 HttpResponse ？

处理“删除”请求和视图之类的正确方法是什么？

谢谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-01T02:20:24.507

Django 视图总是必须返回一个 HttpResponse 对象，或者它的一个[子类](https://docs.djangoproject.com/en/dev/ref/request-response/#httpresponse-subclasses)。只需尝试返回其他内容，看看 Django 是如何反应的（它应该会导致 500 错误）。

对于您描述的情况，您可以使用 jQuery 中的 $.post 方法。如果你这样做了，你肯定应该返回一个字符串来指示成功删除或错误。如果您不考虑错误，您最终可能会从用户正在查看的页面中删除某些内容，而不会实际删除服务器上的项目，这可能会给您的用户造成不一致和混乱。

然后，您的 UI 应该具有正在删除的对象的特定状态 - 即用户已按下删除但服务器尚未响应*。然后，如果出现错误（您在*成功*函数中收到一个指示错误的字符串，或者调用了*错误*函数，请参阅[有关 $.post 的 jQuery 文档](http://api.jquery.com/jQuery.post/#jqxhr-object)），您可以将其报告给用户并将项目返回到正常状态状态。如果删除成功，您可以继续从页面中删除该项目（或在它被删除时执行您打算执行的任何操作）。

*（一个项目被删除的一个很好的指标可能是降低它的不透明度（让它有点透明）并添加一个小旋转轮或另一个删除“正在进行”的指标。）

# javascript - 如何将我的屏幕尺寸放入警报中？JavaScript

> ID：10392646
> 
> 赞同：-4
> 
> 时间：2012-05-01T01:54:48.863
> 
> 标签：javascript, size, screen, alert, resolution

我希望我的警报弹出并告诉我我的屏幕分辨率是多少。

```
alert("Your Screen Resolution is ...") 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-01T01:57:55.347

```
alert( 'Your screen resolution is ' + screen.width + 'x' + screen.height ); 
```

# php - 存储敏感数据的最佳方式

> ID：10392647
> 
> 赞同：1
> 
> 时间：2012-05-01T01:54:51.850
> 
> 标签：php, mysql, file, store

存储敏感数据（例如：信用卡）的最佳方式是什么？我需要能够得到原始文本，所以我不能散列它。我有几个想法。

1.  使用 MySQL`AES_ENCRYPT()`和`AES_DECRYPT()`

2.  使用加密将其存储在文件中`fwrite()`

现在我知道 MySQL 的加密和解密功能并不安全，我可以在 PHP 中使用任何简单、快速和安全的加密吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-05-01T01:59:53.980

**不要在您的服务器上存储信用卡号码！**在您的数据库中拥有这些信息会使您成为黑客极具吸引力的目标。如果你认为你可以保护它，再想一想。黑客已经击败了具有出色安全性的公司的安全性。你的安全不会更好。

您最好的选择是使用[Authorize.Net 的客户信息管理器 (CIM) 之](http://www.authorize.net/solutions/merchantsolutions/merchantservices/cim/)类的服务，该服务允许您在他们的服务器上创建付款配置文件（即他们存储信息），然后您就可以收取费用。这样，您可以在需要时向客户收费，而不必存储他们的信用卡信息。

如果您坚持自己做，您必须遵守[本指南](https://www.pcisecuritystandards.org/documents/pci_dss_v2.pdf)中列出的 PCI 规则。但是您可能会发现[本指南](https://www.pcisecuritystandards.org/documents/pci_ssc_quick_guide.pdf)更易于理解。前往第 14 页了解您需要了解的内容。基本上您可以存储它，但必须根据 PCI 标准对其进行加密。

仅供参考，您的服务器和网络也必须是安全的。如果任何一块拼图不符合 PCI 标准，您就无法存储信用卡号。这排除了大多数共享托管公司作为解决方案。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-01T02:02:09.547

通常，您存储卡号的唯一原因是订阅/定期付款。您会发现优秀的支付服务提供商会提供一个令牌来存储而不是卡详细信息，然后您只需将其再次推送给他们。

查看 PHP mcrypt 库，但如果您确实需要加密/解密卡号并记住，永远不要在任何地方存储 3 位安全代码。曾经。

# .net - 我可以在 IE8 中显示 windows 用户控件吗

> ID：10392648
> 
> 赞同：5
> 
> 时间：2012-05-01T01:54:58.917
> 
> 标签：.net, winforms, internet-explorer

我有一个旧的 Windows 窗体应用程序，我希望像 Web 应用程序一样显示内部用户的浏览器 (IE8)。我一直在研究的一种方法是创建一个 Windows 窗体库 (dll) 并在浏览器中显示它。有很多网页告诉我如何做到这一点：

*   [http://msdn.microsoft.com/en-us/library/a7as3z1d(v=vs.90).aspx](http://msdn.microsoft.com/en-us/library/a7as3z1d(v=vs.90).aspx)
*   [http://forums.asp.net/t/1598007.aspx/1](http://forums.asp.net/t/1598007.aspx/1)
*   [http://windowsclient.net/articles/iesourcing.aspx](http://windowsclient.net/articles/iesourcing.aspx)
*   [http://www.4guysfromrolla.com/articles/052604-1.aspx](http://www.4guysfromrolla.com/articles/052604-1.aspx)
*   [http://www.codeguru.com/csharp/.net/net_general/internet/article.php/c19639/Hosting-NET-Windows-Forms-Controls-in-IE.htm](http://www.codeguru.com/csharp/.net/net_general/internet/article.php/c19639/Hosting-NET-Windows-Forms-Controls-in-IE.htm)
*   [http://weblogs.asp.net/spano/archive/2007/09/19/hosting-a-windows-form-control-in-a-web-page.aspx](http://weblogs.asp.net/spano/archive/2007/09/19/hosting-a-windows-form-control-in-a-web-page.aspx)
*   [http://codebetter.com/petervanooijen/2007/06/18/includes-a-winforms-user-control-in-an-asp-net-web-page/](http://codebetter.com/petervanooijen/2007/06/18/including-a-winforms-user-control-in-an-asp-net-web-page/)

但我无法让它工作。我制作了一个简单的 Windows 控件库，并构建了 DLL。我把它放在一个 IIS 7.5 站点的顶级目录中，还有一个像这样的 html 文件：

```
<html>
   <body>
    <object id='c' classid='http:TestWinCtrlLib.dll#TestWinCtrlLib.UserControl1' height='300' width='400'>
    </object>
  </body>
</html> 
```

我的浏览器显示一个 300x400 的框，左上角有一个小的“图片”图标。起初，IIS 拒绝提供 .dll 文件，给出 403.2 和 401.2 错误，但现在我已经正确设置了 IIS 权限属性，日志表明它已成功提供。

```
2012-05-01 01:28:50 ::1 GET /form.html - 8008 - ::1 Mozilla/4.0+(compatible;+MSIE+8.0;+Windows+NT+6.1;+WOW64;+Trident/4.0;+SLCC2;+.NET+CLR+2.0.50727;+.NET+CLR+3.5.30729;+.NET+CLR+3.0.30729;+.NET4.0C;+.NET4.0E) 200 0 0 1
2012-05-01 01:28:50 ::1 GET /TestWinCtrlLib.dll - 8008 - ::1 Mozilla/4.0+(compatible;+MSIE+8.0;+Windows+NT+6.1;+WOW64;+Trident/4.0;+SLCC2;+.NET+CLR+2.0.50727;+.NET+CLR+3.5.30729;+.NET+CLR+3.0.30729;+.NET4.0C;+.NET4.0E) 200 0 0 23 
```

我什至不知道出了什么问题。上面的第一个链接有一个关于错误报告的部分，我已将这些键添加到注册表中，但我没有看到任何错误。我尝试从 cmd 提示符启动 iexplore，以防错误可能出现在标准输出上，但什么也没有。

> 错误报告
> 
> 代码下载过程使用以下两个注册表设置来控制来自使用 Internet Explorer 部署的托管代码可执行文件的错误报告。
> 
> *   HKLM\Software\Microsoft.NETFramework\ExposeExceptionsInCOM
> *   HKCU\Software\Microsoft.NETFramework\ExposeExceptionsInCOM
> 
> ...
> 
> 调试使用 Internet Explorer 部署的托管代码时，可以使用这些设置的值来查找有关代码下载失败的详细信息。例如，这允许您在抛出异常时查看堆栈跟踪信息，而不是依赖于 Internet Explorer 提供的错误报告，它是为最终用户而不是开发人员设计的。

是否可能不再支持此功能？我发现的大多数参考资料似乎都是 2007-2010 年。也许[ClickOnce](http://msdn.microsoft.com/en-us/library/31kztyey.aspx)是现在唯一的方法。我可以让它工作，但代码在它自己的窗口中运行，而不是在浏览器内。

我尝试使用 .Net frameworks 3.5 Client Profile 和 4.0 Client Profile 编译库。但他们似乎给出了相同的结果。

欢迎任何帮助 - 谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-04T21:31:45.390

您可以考虑为此使用远程桌面服务。它在 ActiveX 上运行，因此仅支持 Internet Explorer（尽管有 3rd 方解决方案可让您通过非 IE 浏览器或手机访问 RDS）。

有关指南和文档，请访问： [http://technet.microsoft.com/en-us/library/dd647502(v=ws.10)](http://technet.microsoft.com/en-us/library/dd647502%28v=ws.10%29)

# python - 在 Couchdb 中从旧数据库复制到新数据库

> ID：10392652
> 
> 赞同：3
> 
> 时间：2012-05-01T01:56:10.017
> 
> 标签：python, database, linux, couchdb

我正在开发一个使用 couchdb 的项目。实际上，在我使用包含 1000 个文档的数据库之前，现在我已经转移到新数据库，它也有比其他数据库更多的新文档。如果我一一复制所有文档将花费太多时间，是否有其他方法可以从一个数据库中复制特定文档并将其粘贴到新数据库中。因为 couchdb 对我来说是新的，我在互联网上没有找到任何令人满意的答案。如果有人知道，请告诉我在couchdb中复制和粘贴的查询或方法？先感谢您。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-01T03:03:56.473

是的，它被称为[**复制**](http://wiki.apache.org/couchdb/Replication)。

如果您只需要复制特定文档，您可以将其与[过滤器结合使用。](http://wiki.apache.org/couchdb/Replication#Filtered_Replication)

# javascript - 通过 JavaScript 计算旋转元素的边界框的 X、Y、高度和宽度

> ID：10392658
> 
> 赞同：26
> 
> 时间：2012-05-01T01:57:29.357
> 
> 标签：javascript, css, geometry, rotation, bounding-box

基本上我问这个问题的 JavaScript：[Calculate Bounding box coordinates from a rotate rectangle](https://stackoverflow.com/questions/622140/calculate-bounding-box-coordinates-from-a-rotated-rectangle-picture-inside)

![图表](../Images/59aa63588381f6017da99698ca5bd988.png)

在这种情况下：

*   iX = 旋转（蓝色）HTML 元素的宽度
*   iY = 旋转（蓝色）HTML 元素的高度
*   bx = 边界框的宽度（红色）
*   by = 边界框的高度（红色）
*   x = Bounding Box 的 X 坐标（红色）
*   y = Bounding Box 的 Y 坐标（红色）
*   iAngle/t = HTML 元素的旋转角度（蓝色；未显示，但在下面的代码中使用），仅供参考：在此示例中为 37 度（与示例无关）

如何通过 JavaScript 计算围绕旋转的 HTML 元素（给定其宽度、高度和旋转角度）的边界框（所有红色数字）的 X、Y、高度和宽度？一个棘手的问题是让旋转的 HTML 元素（蓝色框）的原始 X/Y 坐标以某种方式用作偏移量（这在下面的代码中没有表示）。这可能得看[CSS3的transform-origin](http://www.w3schools.com/cssref/css3_pr_transform-origin.asp)来确定中心点。

我有一个部分解决方案，但 X/Y 坐标的计算无法正常运行......

```
var boundingBox = function (iX, iY, iAngle) {
    var x, y, bx, by, t;

    //# Allow for negetive iAngle's that rotate counter clockwise while always ensuring iAngle's < 360
    t = ((iAngle < 0 ? 360 - iAngle : iAngle) % 360);

    //# Calculate the width (bx) and height (by) of the .boundingBox
    //#     NOTE: See https://stackoverflow.com/questions/3231176/how-to-get-size-of-a-rotated-rectangle
    bx = (iX * Math.sin(iAngle) + iY * Math.cos(iAngle));
    by = (iX * Math.cos(iAngle) + iY * Math.sin(iAngle));

    //# This part is wrong, as it's re-calculating the iX/iY of the rotated element (blue)
    //# we want the x/y of the bounding box (red)
    //#     NOTE: See https://stackoverflow.com/questions/9971230/calculate-rotated-rectangle-size-from-known-bounding-box-coordinates
    x = (1 / (Math.pow(Math.cos(t), 2) - Math.pow(Math.sin(t), 2))) * (bx * Math.cos(t) - by * Math.sin(t));
    y = (1 / (Math.pow(Math.cos(t), 2) - Math.pow(Math.sin(t), 2))) * (-bx * Math.sin(t) + by * Math.cos(t));

    //# Return an object to the caller representing the x/y and width/height of the calculated .boundingBox
    return {
        x: parseInt(x), width: parseInt(bx),
        y: parseInt(y), height: parseInt(by)
    }
}; 
```

我觉得我很近，但又很远……

非常感谢您提供的任何帮助！

***帮助非 JAVASCRIPTERS...***

一旦 HTML 元素被旋转，浏览器会返回一个“矩阵变换”或“旋转矩阵”，看起来是这样的：`rotate(Xdeg) = matrix(cos(X), sin(X), -sin(X), cos(X), 0, 0);` [有关更多信息，请参阅此页面](http://css-tricks.com/get-value-of-css-rotation-through-javascript/)。

我有一种感觉，这将启发我们如何仅根据旋转元素（蓝色）的宽度、高度和角度来获取边界框（红色）的 X、Y。

**新信息**

嗯……有趣……

![在此处输入图像描述](../Images/cd5e5c50a4a012609f424c99117d7bfe.png)

从 X/Y 角度来看，每个浏览器似乎处理旋转的方式不同！FF 完全无视它，IE & Opera 绘制边界框（但它的属性没有暴露，即：bx & by）和 Chrome & Safari 旋转矩形！除 FF 外，所有人都正确报告了 X/Y。所以... X/Y 问题似乎只存在于 FF！多么奇怪！

另外值得注意的是，对于旋转的 X/Y 而言，似乎`$(document).ready(function () {...});`触发得太早了（这是我最初的问题的一部分！）。我在 X/Y 询问调用之前直接旋转元素，`$(document).ready(function () {...});`但它们似乎直到一段时间后才更新（！？）。

当我有更多时间时，我会用这个例子折腾一个 jFiddle，但我使用的是“jquery-css-transform.js”的修改形式，所以我在 jFiddle 之前有一点点修补......

那么... 怎么了，FireFox？这不酷，伙计！

***剧情变厚了……***

嗯，FF12 似乎解决了 FF11 的问题，现在就像 IE 和 Opera 一样。但现在我又回到了 X/Y 的方位，但至少我想我现在知道为什么了……

似乎即使浏览器正确报告了旋转对象的 X/Y，但未旋转版本上仍然存在“幽灵”X/Y。似乎这是操作的顺序：

*   从 X,Y 为 20,20 的未旋转元素开始
*   旋转所述元素，导致 X,Y 报告为 15,35
*   通过 JavaScript/CSS 将所述元素移动到 X,Y 10,10
*   浏览器在逻辑上不旋转元素回到 20,20，移动到 10,10 然后重新旋转，导致 X,Y 为 5,25

所以...我希望元素在旋转后 10,10 处结束，但由于元素（看似）在移动后重新旋转，因此生成的 X,Y 与集合 X,Y 不同。

这是我的问题！所以我真正需要的是一个函数来获取所需的目标坐标 (10,10)，并从那里向后工作以获得起始 X、Y 坐标，这将导致元素旋转到 10,10。至少我知道我现在的问题是什么，因为由于浏览器的内部工作原理，旋转元素似乎是 10=5！

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2013-07-03T16:49:25.727

我知道这有点晚了，但我已经在 HTML5 画布上为这个问题写了一个小提琴：

[http://jsfiddle.net/oscarpalacious/ZdQKg/](http://jsfiddle.net/oscarpalacious/ZdQKg/)

我希望有人觉得它有用！

我实际上并没有计算容器左上角的 x,y 。它是作为偏移量的结果计算的（来自小提琴示例的代码）：

```
this.w = Math.sin(this.angulo) * rotador.h + Math.cos(this.angulo) * rotador.w;
this.h = Math.sin(this.angulo) * rotador.w + Math.cos(this.angulo) * rotador.h;
// The offset on a canvas for the upper left corner (x, y) is
// given by the first two parameters for the rect() method:
contexto.rect(-(this.w/2), -(this.h/2), this.w, this.h); 
```

干杯

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-08-02T04:41:41.593

您是否尝试过使用**getBoundingClientRect()**？

考虑到旋转，此方法返回当前值为*“底部、高度、左侧、右侧、顶部、宽度”的对象*

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-01T02:03:38.470

将四个角从中心变成向量，旋转它们，并从中获取新的最小/最大宽度/高度。

**编辑：**

我知道你现在哪里有问题了。当您需要使用*与旋转中心的偏移量*进行计算时，您正在使用整个侧面进行计算。是的，这会产生**四个**旋转点（奇怪的是，这与您开始时的点数完全相同）。它们之间将有一个最小 X、一个最大 X、一个最小 Y 和一个最大 Y。这些是你的界限。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2018-05-18T09:41:04.500

[我的要点](https://gist.github.com/kolosovsky/b56d90ad3a507876ae2da96e5bb8ff71)可以帮助你

**多边形的边界框（矩形、三角形等）：**

现场演示[https://jsfiddle.net/Kolosovsky/tdqv6pk2/](https://jsfiddle.net/Kolosovsky/tdqv6pk2/)

```
let points = [
    { x: 125, y: 50 },
    { x: 250, y: 65 },
    { x: 300, y: 125 },
    { x: 175, y: 175 },
    { x: 100, y: 125 },
];
let minX = Math.min(...points.map(point => point.x));
let minY = Math.min(...points.map(point => point.y));
let maxX = Math.max(...points.map(point => point.x));
let maxY = Math.max(...points.map(point => point.y));
let pivot = {
    x: maxX - ((maxX - minX) / 2),
    y: maxY - ((maxY - minY) / 2)
};
let degrees = 90;
let radians = degrees * (Math.PI / 180);
let cos = Math.cos(radians);
let sin = Math.sin(radians);

function rotatePoint(pivot, point, cos, sin) {
    return {
        x: (cos * (point.x - pivot.x)) - (sin * (point.y - pivot.y)) + pivot.x,
        y: (sin * (point.x - pivot.x)) + (cos * (point.y - pivot.y)) + pivot.y
    };
}

let boundingBox = {
    x1: Number.POSITIVE_INFINITY,
    y1: Number.POSITIVE_INFINITY,
    x2: Number.NEGATIVE_INFINITY,
    y2: Number.NEGATIVE_INFINITY,
};

points.forEach((point) => {
    let rotatedPoint = rotatePoint(pivot, point, cos, sin);

    boundingBox.x1 = Math.min(boundingBox.x1, rotatedPoint.x);
    boundingBox.y1 = Math.min(boundingBox.y1, rotatedPoint.y);
    boundingBox.x2 = Math.max(boundingBox.x2, rotatedPoint.x);
    boundingBox.y2 = Math.max(boundingBox.y2, rotatedPoint.y);
}); 
```

**椭圆的边界框：**

现场演示[https://jsfiddle.net/Kolosovsky/sLc7ynd1/](https://jsfiddle.net/Kolosovsky/sLc7ynd1/)

```
let centerX = 350;
let centerY = 100;
let radiusX = 100;
let radiusY = 50;
let degrees = 200;

let radians = degrees * (Math.PI / 180);
let radians90 = radians + Math.PI / 2;
let ux = radiusX * Math.cos(radians);
let uy = radiusX * Math.sin(radians);
let vx = radiusY * Math.cos(radians90);
let vy = radiusY * Math.sin(radians90);

let width = Math.sqrt(ux * ux + vx * vx) * 2;
let height = Math.sqrt(uy * uy + vy * vy) * 2;
let x = centerX - (width / 2);
let y = centerY - (height / 2); 
```

# javascript - Lawnchair .nuke() not working after filling my storage quota

> ID：10392659
> 
> 赞同：5
> 
> 时间：2012-05-01T01:57:33.630
> 
> 标签：javascript, lawnchair

I'm using [Lawnchair](http://westcoastlogic.com/lawnchair/) to store persistent data using the "dom adapter" of my web client (Firefox 13.0) and have hit the storage quota. Console.log says

```
Persistent storage maximum size reached 
```

Fair enough; I'll just nuke it with this:

```
<script type="text/javascript" charset="utf-8">
            Lawnchair(function() {
                this.nuke();
                console.log("nuked");
            });
</script> 
```

Before I hit my storage quota, the code above worked to wipe everything out of persistent storage. But now it doesn't work. The page displays fine, but console log shows nothing. I expect it to say "nuked" as it used to.

The following code displays all of my persistent data (after trying to nuke() it with the code above).

```
<script type="text/javascript" charset="utf-8">
            Lawnchair(function() {
                this.keys(function(values) {
                        values.forEach(console.log)
                    })
            });
</script> 
```

How can I make Lawnchair.nuke() work after it's hit its storage limit?

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-16T18:45:59.350

You can use *localStorage.clear()* - just to be on the safe side. But nevertheless, open Chrome devltools and see what is the state of your localStorage... It will show you in a table (key,val) what is going on inside the local storage.

You might also want to debug the nuke and see why it's not working in your case. It might be due to some keys changes or a bug.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-23T00:25:37.050

Try this:

```
Lawnchair( function() {
this.keys( function(key) {
this.remove(key);})
}); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-09T11:24:41.993

This was a bug. I ran into the same problem. Pulling from github and running 'make build' to generate the current lawnchair in lib/ fixed the problem.

# android - 多项目 Android 应用程序的 Proguard 配置文件

> ID：10392661
> 
> 赞同：2
> 
> 时间：2012-05-01T01:57:44.127
> 
> 标签：android, proguard

我有一个多项目的 android 应用程序。

项目 A 有活动，但它依赖于项目 B UI 库项目（我也需要混淆）和项目 C 服务库（我也需要混淆）。这两个 jar 文件（uilib.jar 和 services.jar）在项目 A 的 java 构建路径下显示为“Android Dependencies”以及许多第三方库，如 commons.jar 等，我不需要混淆。我需要知道如何指定 uilib.jar 和 services.jar 以便正确混淆这些类。我还想从混淆中删除所有其他 jar，例如 common.jar，因为它们是第三方开源的，我没有编写它们。谢谢

# php - 带有 UTF8 字符的 PHP JSON

> ID：10392667
> 
> 赞同：2
> 
> 时间：2012-05-01T01:58:13.993
> 
> 标签：php, json

我正在`JSON`使用这个发送消息`PHP`：

```
$result = mysql_query("select a.id, ad.nombre, a.imagen, a.lat, a.long, ad.desc, a.url, a.email, a.tel, a.direccion, a.cp, a.poblacion, a.provincia from `bck_alrededor` a, `bck_alrededor_description` ad, `bck_alrededor_partner` ap
where a.id = ad.id_alrededor
and a.id = ap.id_alrededor
and a.id_cat = '$cat'
and ad.language = '$idioma'
and ap.id_partner = '$idp'",$link);

    while( $row = mysql_fetch_array($result) )
    {   
        $id = $row['id'];
        $nombre = $row['nombre'];
        $imagen=$row['imagen'];
        $lat=$row['lat'];
        $long=$row['long'];
        $desc=$row['desc'];
        $url=$row['url'];
        $email=$row['email'];
        $tel=$row['tel'];
        $direccion=$row['direccion'];
        $cp=$row['cp'];
        $poblacion=$row['poblacion'];
        $provincia=$row['provincia'];

        if ($imagen <>'')
        {
            $imagen = $dir.'/'.$imagen;
        }

        $posts[] = array('nid'=> $id , 'title'=> $nombre, 'image'=> $imagen ,  'latitude'=> $lat, 'longitude'=> $long, 'html'=> $desc, 'web'=> $url, 'email'=> $email, 'phone'=> $tel, 'address'=> $direccion, 'cp'=> $cp, 'poblacion'=> $poblacion, 'provincia'=> $provincia );

    }
    $response['nodes'] = $posts;

    $current_charset = 'ISO-8859-15';
    array_walk_recursive($response,function(&$value) use ($current_charset){
         $value = iconv('UTF-8//TRANSLIT',$current_charset,$value);

    });

    echo json_encode($response);

    if(!headers_sent()) header('Content-Type: application/json; charset=utf-8', true,200);
    header('Content-type: application/json'); 
```

但是我收到了带有 UTF8 转义字符的 JSON 消息：

```
{"nodes":[{"nid":"87","title":"Tienda Oficial","image":"\/tiendaoficialgbc.png","latitude":"43.3021","longitude":"-1.9721","html":"Entra y adquiere todos los productos oficiales del GBC. En 48h los tienes en casa","web":"http:\/\/www.gipuzkoabasket.com\/tienda\/tienda_es.php","email":"gipuzkoabasket@gipuzkoabasket.com.","phone":"943 44 44 28","address":"Paseo de Anoeta 22, 1a Planta","cp":"20014","poblacion":"Donostia - San Sebasti\u00e1n","provincia":"Gipuzkoa"},{"nid":"88","title":"Tienda Oficial Salaberria","image":"\/tiendaoficialgbc.png","latitude":"43.30384","longitude":"-1.9797","html":"Entra y adquiere todos los productos oficiales del GBC. En 48h los tienes en casa","web":"http:\/\/www.gipuzkoabasket.com\/tienda\/tienda_es.php","email":"gipuzkoabasket@gipuzkoabasket.com.","phone":"943 44 44 28","address":"Jos\u00e9 Maria Salaberria 88","cp":"20014","poblacion":"Donostia - San Sebasti\u00e1n","provincia":""}]} 
```

我尝试使用 echo json_encode(utf8_encode($response)); 但后来我在客户端应用程序中收到了一条空 JSON 消息。

如何获得没有字符的常规`JSON`消息？`UTF8`

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-01T02:05:10.230

`\u00e1`是在 JSON 中转义 Unicode 字符的一种完全有效的方法。它是 JSON 规范的一部分。要将其解码为 UTF-8，只需`json_decode`它。`utf8_decode`与它无关。

我不明白的是这段代码：

```
iconv('UTF-8//TRANSLIT',$current_charset,$value); 
```

这表示您正在尝试从`UTF-8//TRANSLIT`ISO-8859-15 转换，这没有多大意义。`//TRANSLIT`应该在之后，`ISO-8859-15`否则您根本不应该进行此转换。

# nsxmlparser - 从 NSXMLParser 格式化 NSString

> ID：10392668
> 
> 赞同：1
> 
> 时间：2012-05-01T01:58:14.990
> 
> 标签：nsxmlparser

所以我有一个通过 XML 文件解析的小项目。我正在尝试格式化字符串，使其前后没有缩进。

一些xml是：

```
 <master_url>
    <base_url>      http://buildmac.ee.ps.edu/~wsn/boin/    </base_url>
<request_task>
<name>request_task</name>
<field>username</field>
</request_task>
... 
```

在格式化之前，我有：

```
2012-04-30 21:42:34.684 XMLParser[33194:b303] string = 
        http://buildmac.ee.ps.edu/~wsn/boin/ 
```

这就是我尝试格式化它的方式：

```
[nodecontent appendString:[string stringByTrimmingCharactersInSet:[NSCharacterSet whitespaceAndNewlineCharacterSet]]]; 
```

之后，它在 nodecontent 中只包含一个空白字符串“”。

**它适用于除该网址之外的所有其他元素，因为它缩进很尴尬**

我对 Objective C 和 Xcode 很陌生，所以如果这是一个愚蠢的问题，我很抱歉，但我看过的帖子都没有解决我的问题。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-01T14:46:20.853

我发现了如何使它工作。我在 3 条消息中删除了制表符、换行符和空格：

```
string = [[string stringByReplacingOccurrencesOfString: @"\n" withString: @""] mutableCopy];
string = [[string stringByReplacingOccurrencesOfString: @"\t" withString: @""] mutableCopy];
string = [[string stringByReplacingOccurrencesOfString: @" " withString: @""] mutableCopy]; 
```

注意：字符串是一个 NSMutableString

# c++ - 将文件中的数据读取到类的数组中

> ID：10392674
> 
> 赞同：1
> 
> 时间：2012-05-01T01:59:03.710
> 
> 标签：c++, arrays

```
//Student file
#include <iostream>
#include <fstream>
#include <string>
#include <iomanip>
using namespace std;

#include "student.h"
#define cap 100
void main()
{       string s;
    class student student[cap],l;
    int i;
    fstream f;

    i=0;
    cout << "Enter the file name: ";    //Display to enter the file name
    cin >>s;

    f.open(s.data(),ios::in);
    if(!f.is_open()) 
        cout << "could not open file";
    while(i<cap && !f.eof())
    {       cout << "good";
        student[i].get(f);

//Display if okay
        if(f.good())
        {
            i++;
            student[i].put(cout);
            cout << i;
        }
    }
        f.close();

}
class student
{
    public:
        student(); //Constructor without parameters
        student(int,string,string,int,float); //Constructor with parameters
        ~student(); //Deconstructors
        bool get(istream &);    //Input
        void put(ostream &);    //Output
        int read_array(string,int);
    private:
        int id,age;
        float gpa;
        string last,first;
};

student::student()
{
    id = 0;
    first = "null";
    last = "null";
    age = 0;
    gpa = 0.0;
}
bool student::get(istream &in)
{

    in >> id >> first >> last >> age >> gpa;
    return(in.good());
}
void student::put(ostream &out)
{
    out << id << first << last << age << gpa;
} 
```

当我运行它时，它会一遍又一遍地显示构造函数值以及应该进入数组并显示它们的文件中的数据。我不确定我是否以正确的方式将数据正确放入类数组中。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-01T02:11:13.933

这是一个问题：

```
if (f.good())
{
  // student[i] has just been read from the file.
  i++;                   // Increment counter.
  student[i].put(cout);  // Print whatever was in the next element.
  cout << i;
} 
```

计数器首先递增*，*因此`student[i]`指的是刚刚更新的元素*之后的元素。*

# c - 文本文件中的文本词搜索 - C 编程

> ID：10392676
> 
> 赞同：2
> 
> 时间：2012-05-01T01:59:25.473
> 
> 标签：c, search, text, while-loop, fgets

我想在文本文件中搜索文本词。但是，代码不会在 while 循环内执行。fgets 定义有什么问题？我该如何解决？程序总是打印“while msg 之外”

```
char repeated_data [10] = "0123456789";
char temp[512];
FILE * fp5 = fopen("/home/eagle/Desktop/temp.txt","r");
if(fp5 == NULL)
{
     perror("temp_network.txt open failed");
     exit(EXIT_FAILURE);
}

//search the text inside the temp.txt
while(fgets(temp, 512, fp5) != NULL) 
{
     printf("while msg\n");
     if((strstr(temp, repeated_data)) != NULL) 
     {
         discard_message=1;
         printf("msg is discarded msg\n");
     }
     printf("inside of while\n");
}
fclose(fp5);
printf("outside of while msg\n"); 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-01T02:06:53.693

流程似乎是正确的，您仍然可以通过检查 feof 和 ferror 来找到问题，如此[处](http://www.cplusplus.com/reference/clibrary/cstdio/fgets/)所述：

> 如果发生错误，则返回空指针。使用 ferror 或 feof 检查是否发生错误或到达文件结尾。

作为旁注，这是：

```
char repeated_data [10] = "0123456789"; 
```

应该

```
char repeated_data [] = "0123456789"; 
```

或者

```
char repeated_data [11] = "0123456789"; 
```

您忘记了空终止符。

# php - 数据库和 php 调试器

> ID：10392679
> 
> 赞同：3
> 
> 时间：2012-05-01T01:59:46.533
> 
> 标签：php, mysql, phpmyadmin

我想知道是否有可用的工具可以用来调试他们的数据库和 php 应用程序。相当于数据库和 php 的 firebug 或 chrome 开发者扩展。（我想知道一些查询是否被执行）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-01T02:13:42.047

除了传统的和类似的技术之外，还可以使用[xdebug或类似的扩展来调试 PHP。](http://xdebug.org/)`var_dump`

打开[查询日志](http://dev.mysql.com/doc/refman/5.1/en/query-log.html)以调试您的数据库执行或不执行的操作。
要调试单个查询的执行，请让数据库为您[`EXPLAIN`提供查询](http://dev.mysql.com/doc/refman/5.5/en/explain.html)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-02T22:57:06.363

[PhpEd](http://www.google.com/aclk?sa=l&ai=CYQPZkbuhT872LYa2iAKkg-TNCqf1htEBp9Cdyhinv-K8EQgAEAFQ-eLRqgNgyZ7EjfSk0BmgAYLIh_8DyAEBqgQWT9CJsZqOFiCSmWnMmSWymuJIF9gwaQ&sig=AOD64_2lJGXXSEEZk40imN7ECsUWTRX7Ng&ved=0CAoQ0Qw&adurl=http://www.nusphere.com/products/phped.htm&rct=j&q=phped%20nusphere)太棒了！这些天没有它几乎起不了床，哈哈

# sql - SQL 查询：在一个语句中使用 DISTINCT/UNIQUE 和 SUM()

> ID：10392680
> 
> 赞同：3
> 
> 时间：2012-05-01T01:59:46.943
> 
> 标签：sql, sum, max, distinct, sql-like

**问题**
我有四台游戏服务器收集数据。将数据放入单个表中。不幸的是，这会导致一个玩家的每个统计数据有四个条目。

**我想要什么我想要**
在某些列上有一条记录和 SUM()。

我将发布一个我写的声明，它不起作用，但你会明白我想要完成的事情。

```
SELECT DISTINCT( Name ), 
               Max(Level), 
               Class, 
               Sum(Kills), 
               Sum(Deaths), 
               Sum(Points), 
               Sum(TotalTime), 
               Sum(TotalVisits), 
               CharacterID 
FROM   Characters 
WHERE  Name LIKE '$value%' 
        OR CharacterID LIKE '$value' 
ORDER  BY Name ASC; 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-01T02:04:51.223

您可以按非聚合字段（即名称、类、字符 ID）进行分组，而不是使用 distinct。这样你就可以使用你的聚合：max，sum，你仍然会有你独特的角色！

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-05-01T02:08:07.837

首先让我说数据库中的重复行确实不太理想。[完全规范化](http://en.wikipedia.org/wiki/Database_normalization)的数据库使数据更容易操作，而不会弹出随机异常。

但是，要回答您的问题，这就是 dweiss 所说的放入代码中的内容（使用[group by](http://www.w3schools.com/sql/sql_groupby.asp)）：

```
SELECT
  name,
  MAX(Level),
  Class,
  SUM(Kills),
  SUM(Deaths),
  SUM(Points),
  SUM(TotalTime),
  SUM(TotalVisits),
  CharacterID
FROM
  Characters
WHERE
  Name LIKE '$value%' OR CharacterID LIKE '$value'
GROUP BY
  name,
  class,
  characterid
ORDER BY
  Name ASC
; 
```

我假设每个玩家的姓名、职业、角色 ID 都是相同的，因为这是获取这些值的唯一方法。否则，您还必须对它们使用聚合函数。

# java - 网页保存后不显示新条目。只在刷新后出现

> ID：10392684
> 
> 赞同：1
> 
> 时间：2012-05-01T02:00:11.733
> 
> 标签：java, google-app-engine, jsp

我有一个 JSP 页面，显示系统中插入的新条目列表。

我的 myApplication.jsp 的结构如下：

```
A list of entries in the system
A form with textboxes that submits new entries. 
```

当我的 JSP 提交时，它会调用我的 servlet 类：

```
public void doPost(HttpServletRequest req, HttpServletResponse resp)
        throws IOException {
    String author = checkNull(req.getParameter("author"));
    String service = checkNull(req.getParameter("service"));
    Dao.INSTANCE.add(author, service);
    resp.sendRedirect("/myApplication.jsp");
} 
```

我的 Dao.Add 看起来像这样：

```
public void add(String author,String service) {
    synchronized (this) {
        EntityManager em = EMFService.get().createEntityManager();
        Shortly shortly = new Shortly(author, service);
        em.persist(shortly);
        em.close();
    }
} 
```

我遇到的问题是，当我被重定向回 时`myApplication.jsp`，列表不会显示我添加的新条目。当我刷新页面时，它会显示。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-01T04:39:42.390

如果您使用的是 IE（甚至是其他一些浏览器），请尝试在重定向代码段中放置一个随机数（如时间戳）作为参数：

```
 resp.sendRedirect("/myApplication.jsp?t="+timestamp); 
```

IE 在这种情况下是臭名昭著的，并且由于大量缓存，事情并不总是按预期的方式工作。这个时间戳将指示浏览器不显示缓存页面，并且总是（希望）从服务器重新获取页面。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-02T03:26:25.837

我发现问题在于 Google App Engine 的 High Replication Datastore (HDR) 是如何设计的。HDR 只能保证[最终的一致性](http://en.wikipedia.org/wiki/Eventual_consistency)结果。

我在[这里找到了更多信息](https://developers.google.com/appengine/docs/java/datastore/structuring_for_strong_consistency)

我证明这就是我看到差异的原因的方法是在添加记录之后立即计算持久性上的记录。

```
public void doPost(HttpServletRequest req, HttpServletResponse resp)
        throws IOException {
    String author = checkNull(req.getParameter("author"));
    String service = checkNull(req.getParameter("service"));
    Dao.INSTANCE.add(author, service);
    List shortlys = new ArrayList();
    shortlys = Dao.INSTANCE.getShortlys("default");
    System.out.println("Shortlys count is: " + shortlys.size());
    resp.sendRedirect("/myApplication.jsp");
} 
```

有几次，输出不增加计数，有时增加了两个（旧记录，新记录添加...）

# java - Android ListView 行布局忽略填充

> ID：10392688
> 
> 赞同：4
> 
> 时间：2012-05-01T02:02:24.567
> 
> 标签：java, android, listview, android-layout, baseadapter

我确定这是我忽略的简单事情，但我无法弄清楚。我有一个使用具有简单布局的自定义适配器的 ListView，我的填充值似乎被忽略了。这是我希望布局的方式：

```
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android" style="@style/Widget.Layout.ComponentEntry" android:padding="@dimen/preferred_padding">
    <include layout="@layout/component_entry_summary" />
</LinearLayout> 
```

但是填充被忽略了。如果我使用嵌套的 LinearLayout 则它可以工作，但内部的 LinearLayout 似乎毫无意义。这有效：

```
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android" style="@style/Widget.Layout.ComponentEntry">
    <LinearLayout android:layout_height="match_parent" android:layout_width="match_parent" android:padding="@dimen/preferred_padding">
        <include layout="@layout/component_entry_summary"  />
    </LinearLayout>
</LinearLayout> 
```

第一个布局在 ListView 之外工作，所以我很难过。此处参考使用的样式（还指定了填充）：

```
<style name="Widget">
    <item name="android:textAppearance">@style/TextAppearance</item>
</style>

<style name="Widget.Layout">
    <!-- Empty Style -->
</style>

<style name="Widget.Layout.ListViewItem">
    <item name="android:background">@drawable/listview_item_background</item>
    <item name="android:layout_height">wrap_content</item>
    <item name="android:layout_width">match_parent</item>
    <item name="android:padding">@dimen/preferred_padding</item>
</style>

<style name="Widget.Layout.ComponentEntry" parent="Widget.Layout.ListViewItem">
    <item name="android:layout_height">@dimen/listview_item_height</item>
</style> 
```

以及包含的布局：

```
<merge xmlns:android="http://schemas.android.com/apk/res/android" >
    <ImageView android:id="@+id/iconImage"
               android:layout_gravity="center_vertical"
               android:layout_height="@dimen/icon_size"
               android:layout_width="@dimen/icon_size"
               android:scaleType="fitCenter"
               android:src="@drawable/ic_launcher" />

    <LinearLayout android:layout_gravity="center_vertical"
                  android:layout_height="wrap_content"
                  android:layout_width="0dp"
                  android:layout_weight="1"
                  android:paddingLeft="@dimen/preferred_padding"
                  android:orientation="vertical">

        <TextView android:id="@+id/topText"
                  android:layout_height="wrap_content"
                  android:layout_width="wrap_content"
                  android:paddingLeft="@dimen/preferred_padding"
                  android:singleLine="true"
                  android:text="@string/app_name"
                  android:textColor="@color/header_text_enabled"
                  android:textStyle="bold" />

        <TextView android:id="@+id/bottomText"
                  android:layout_height="wrap_content"
                  android:layout_width="wrap_content"
                  android:ellipsize="marquee"
                  android:marqueeRepeatLimit="marquee_forever"
                  android:paddingLeft="@dimen/preferred_padding"
                  android:singleLine="true"
                  android:text="@string/app_name"
                  android:textColor="@color/header_text_enabled" />
    </LinearLayout>
</merge> 
```

这是布局膨胀的方式（我最初提供了一个 null 父级，并认为这是问题所在，但似乎不是：

```
public View getView(int position, View view, ViewGroup parent) {
    ViewHolder viewHolder;

    if (view == null) {
        view = _layoutInflater.inflate(_layoutResourceId, parent, false);
        ... 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-24T01:48:49.777

当我删除代码以设置填充工作的背景时，我遇到了同样的问题。

编辑：找出导致它的原因，它是 9 个补丁图像中的填充线，我想如果你把它放在绘图之外，它会使用布局 xml 中的填充。但它实际上将可拉伸区域也用作可绘制区域。

> 如果不包括填充线，Android 使用左侧和顶部线来定义这个可绘制区域，有效地定义填充。

[http://developer.android.com/guide/topics/graphics/2d-graphics.html#nine-patch](http://developer.android.com/guide/topics/graphics/2d-graphics.html#nine-patch)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-14T23:10:02.893

移除背景会导致外部 LinearLayout 上的填充开始工作。尚未深入研究原因，但至少（部分）解决了问题。

# php - PHP中后台的Apple推送通知服务

> ID：10392692
> 
> 赞同：0
> 
> 时间：2012-05-01T02:02:36.003
> 
> 标签：php, iphone, apple-push-notifications, background-process

我正在尝试向我的应用程序添加推送通知。一切正常（我收到消息），但我无法让脚本在后台运行。我想让 push.php 24/7 在后台运行以自动发送消息。我已经设法让它进入后台（它显示在 cPanel 的进程管理器中，而我没有打开它），但实际上什么也没发生。我从未收到 push.php 发送到我的设备的推送。如果我手动访问 push.php，我会在几秒钟内收到推送。

我努力了：

```
passthru("/usr/bin/php -q /path/to/push.php >> /path/to/log.log 2>&1 &"); 
```

log.log 包含：“内容类型：文本/html”一遍又一遍地打印。

```
exec ("nohup /usr/bin/php -q /path/to/push.php >/path/to/log.log &"); 
```

log.log 包含：“Content-type: text/html”打印一次。

```
exec("nohup php /path/to/push.php > /dev/null 2> /dev/null&"); 
```

它们都显示在 cPanel 进程中，但是它们都没有真正发送到我的设备。此外，有时 push.php 会多次出现在 cPanel 中。正如我上面所说，如果我手动访问 push.php，我会得到推送。

# c# - 关于如何将 UpdateSourceTrigger=Explicit 与 MVVM 一起使用的一个很好的例子

> ID：10392698
> 
> 赞同：6
> 
> 时间：2012-05-01T02:02:59.357
> 
> 标签：c#, xaml, data-binding, mvvm

我试图弄清楚如何使用 UpdateSourceTrigger=Explicit。

我有以下表格：

```
<StackPanel x:Name="LayoutRoot" Margin="10" DataContext="{Binding ElementName=Window, Mode=OneWay}">
    <DockPanel>
        <TextBlock Text="Proxy address:" VerticalAlignment="Center"/>
        <TextBox Text="{Binding User.PageAddress, Mode=TwoWay, UpdateSourceTrigger=Explicit}" Margin="28,0,0,0"/>
    </DockPanel>
    <DockPanel Margin="0,5,0,0">
        <TextBlock Text="User name:" VerticalAlignment="Center"/>
        <TextBox Text="{Binding User.UserName, Mode=TwoWay, UpdateSourceTrigger=Explicit}" Margin="46,0,0,0"/>
    </DockPanel>
    <DockPanel Margin="0,5,0,0">
        <TextBlock Text="User password:" VerticalAlignment="Center"/>
        <TextBox Text="{Binding  User.Password, Mode=TwoWay, UpdateSourceTrigger=Explicit}" Margin="26,0,0,0"/>
    </DockPanel>
    <StackPanel Orientation="Horizontal" VerticalAlignment="Center" HorizontalAlignment="Right" Margin="0,5,0,0">
        <Button Content="Ok" IsDefault="True" Width="70" Margin="0,0,15,0" Click="Ok_Click"/>
        <Button Content="Cancel" IsCancel="True" Width="70"/>
    </StackPanel>
</StackPanel> 
```

我应该调用什么方法来更新`User`属性？

我不想通过 x:Name 来处理元素来调用绑定。如果我必须通过 x:Name 来处理元素，就我而言，我也可以完全不绑定。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-05-01T06:15:33.223

您需要在后面的代码中调用[BindingExpression.UpdateSource来手动更新绑定。](http://msdn.microsoft.com/en-us/library/system.windows.data.bindingexpression.updatesource.aspx)显式绑定与 MVVM 并不真正兼容，因为您需要直接引用视图对象来执行手动更新。

```
// itemNameTextBox is an instance of a TextBox
BindingExpression be = itemNameTextBox.GetBindingExpression(TextBox.TextProperty);
be.UpdateSource(); 
```

# actionscript-3 - 使用 `getChildAt(i).mask` 用 1 个掩码掩盖许多对象不起作用

> ID：10392706
> 
> 赞同：0
> 
> 时间：2012-05-01T02:04:34.737
> 
> 标签：actionscript-3, flash, flash-cs5.5

我正在尝试为舞台上的所有对象应用蒙版，除了一对。有很多不同的对象，将来它们的数量会发生变化，所以我希望能够动态地完成遮罩。

我写了这段代码：

```
var i;

for (i = 0; i < this.numChildren; i++) {
    if (this.getChildAt(i).name!="stage_kelp_bg" && this.getChildAt(i).name!="magnifier_mask") {
        this.getChildAt(i).mask = this.magnifier_mask;
    }
} 
```

上面的代码在文档类的构造方法中。简单地说一下：

```
this.stage_kelp.mask = this.magnifier_mask; 
```

完美无瑕，但仅适用于那个对象。知道有什么问题吗？

没有错误被抛出，对象只是没有被掩盖。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-01T02:36:35.693

进一步的研究表明，我不能将 1 个蒙版应用于多个对象。我必须为每个对象设置一个遮罩，或者将所有对象放入一个容器中并遮盖该容器。

显然，您可以使用一个图层来掩盖时间轴上的多个对象，但是如果不将所有对象添加到一个容器中，就无法以编程方式进行。不幸的是，如果不重新编码整个应用程序，我就无法做到这一点，所以我将使用时间线来掩盖事情。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-01T04:48:12.120

我建议您最好将所有影片剪辑移动到单个影片剪辑中进行屏蔽。如果在您的情况下可行，这将更容易。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-01T02:12:51.400

怎么样`for each`

```
for (var mc:movieClicp in this){
                  mc.mask=mask_} 
```

# java - Java 在方法中使用 final 关键字

> ID：10392707
> 
> 赞同：2
> 
> 时间：2012-05-01T02:04:50.257
> 
> 标签：java, final

在 Java 中，关键字`final`用于表示不能重新分配变量。如果是这样，为什么在方法中声明的变量不能有`final`关键字？为什么这不合法：

```
public void method()
{ 
  final String x = "name";
} 
```

对于长方法，它可能会派上用场。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-01T02:06:20.803

你可以。

```
public void foo() {
    final String bar = "bar";
} 
```

编译就好了。

# java - 既然我们有 ConcurrentHashMap，我们还需要 Hashtable 吗？

> ID：10392711
> 
> 赞同：3
> 
> 时间：2012-05-01T02:05:38.360
> 
> 标签：java, hashtable, concurrenthashmap

Java 的`java.util.Hashtable`功能与`java.util.HashMap`. 它们的主要区别在于`Hashtable`线程安全和同步，而`HashMap`不是。从 JDK5 开始，我们就有`ConcurrentHashMap`了可用于多线程上下文的。它的性能比`Hashtable`. 那么我们有什么理由`Hashtable`在未来使用呢？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-01T02:07:52.537

反向兼容的唯一原因`Hashtable`还在JDK中。

此外，另一种替代方法`Hashtable`是[`Collections.synchronziedMap`](http://docs.oracle.com/javase/7/docs/api/java/util/Collections.html#synchronizedMap%28java.util.Map%29).

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-01T02:17:11.763

有许多[使用 HashTable](http://docs.oracle.com/javase/6/docs/api/java/util/class-use/Hashtable.html)的现有接口。在大多数情况下，如果不是所有情况，这些都无法在不破坏兼容性的情况下被替换。

# php - Facebook Like 按钮确认页面显示“未找到您请求的页面”

> ID：10392712
> 
> 赞同：0
> 
> 时间：2012-05-01T02:06:03.960
> 
> 标签：php, html, facebook, facebook-like, facebook-opengraph

刚刚在我正在开发的网站上放了一个赞按钮。一切正常，但在测试时，我想我喜欢和不喜欢太多次，并被列入点击黑名单。这很好，只是确认按钮总是显示“未找到您请求的页面”。使用了 url linter，一切似乎都很好。我已经两次和三次检查了我的元标记和 iframe。我想不通！请帮忙！这是网站：

[http://melissy.com/html/index.php](http://melissy.com/html/index.php)

这是页面的对象属性：

g:url: [http://melissy.com/html/index.php](http://melissy.com/html/index.php)
og:type: website
og:title: Melissa Davidson
og:image: （这不是空白，在调试器上显示为图片）
og:description ：南加州艺术家梅丽莎戴维森官方网站。包括绘画和照片画廊，以及活动和联系信息。
og:site_name: 梅丽莎戴维森

和开放图元数据

```
meta property="og:title" content="Melissa Davidson" 
meta property="og:type" content="website" 
meta property="og:url" content="http://melissy.com/html/index.php"
meta property="og:image" content="(removed)"
meta property="og:site_name" content="Melissa Davidson" 
meta property="fb:admins" content="(took this out for security purposes)" 
meta property="og:description" content="Southern California artist Melissa Davidsons official website. Includes painting and photo galleries, as well as event and contact information." 
```

我期待着您的建议。谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-03T06:44:27.270

问题解决了！只是发布以防其他人有这个问题。我在 facebook 上创建了类似按钮生成器的类似按钮：

[http://developers.facebook.com/docs/reference/plugins/like/](http://developers.facebook.com/docs/reference/plugins/like/)

当我生成代码时，我选择了“标准”布局。后来，我决定改为“box-count”。我更改了嵌入在我的页面上的 iframe url 中的适当变量。所有代码都是正确的。但是，除非将其设置为“标准”，否则该按钮将不起作用。我猜当您在 Facebook 上创建按钮时，他们会创建某种记录，该记录会永久链接到 url

# php - 在 PHP 中，为什么我能够以静态方式访问非静态方法？

> ID：10392713
> 
> 赞同：8
> 
> 时间：2012-05-01T02:06:04.653
> 
> 标签：php, static

在下面的代码中，nonStatic() 不是静态方法。即使这样，我也可以在不创建对象（以静态方式）的情况下访问它。谁能帮助我理解，因为这在 Java 等其他语言中是不可能的？

```
<?php
class MyClass
{
    function nonStatic() {
        echo "This can be printed";
    }
}
MyClass::nonStatic(); // This can be printed 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-01T02:19:18.713

这是允许的，**但**会产生`E_STRICT`警告：

```
Error #: 2048, Error: Non-static method MyClass::nonStatic() should not be called statically, assuming $this from incompatible context 
```

在 PHP 的早期 OO 实现中，这是默认允许的，但后来采用了更好的做法。

反之亦然：

```
class Test
{
    function foo()
    {
        echo $this->bar();
    }

    static function bar()
    {
        return "Hello world\n";
    }
}

$x = new Test;
$x->foo(); 
```

这打印`Hello world`。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-01T02:10:55.317

似乎 PHP 的开发人员没有看到禁止对非静态方法进行静态访问的任何价值。这只是 PHP 的那些特殊功能之一，它并没有真正发挥作用。静态调用非静态方法当然是不好的编程习惯，但在 PHP 中是可能的。也许在 PHP 的未来版本中，他们将不允许这样做，但现在，它只是语言的一部分。

**编辑：**

~~值得庆幸的是，相反的情况是不允许的——您不能从对象上下文中调用静态方法。~~正如 Jack 在下面指出的那样，您**可以**从对象上下文中调用静态方法——这在 OOP 范式中几乎不是最佳实践，但它是允许的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-01T02:09:55.117

不确定，可能是一些 PHP 魔法（有时有点像），但你不应该这样做。

在这里阅读更多[http://php.net/manual/en/language.oop5.static.php](http://php.net/manual/en/language.oop5.static.php)

他们也展示了一个类似的例子，但请注意：

静态调用非静态方法会生成 E_STRICT 级别的警告，这意味着这种神奇的能力可能会在未来的版本中消失。所以不要这样做:)

# cluster-analysis - Weka EM 集群在 Eclipse 中得到“错误：无法找到或加载主类测试”

> ID：10392714
> 
> 赞同：2
> 
> 时间：2012-05-01T02:06:06.050
> 
> 标签：cluster-analysis, weka, main, expectation-maximization

我想使用 weka 在 JSP 的数据库中对推文进行聚类。在 GUI 中，我发现只有 HierarchiccalClusterer 和 Filteredcluster 可用于字符串聚类。然后我从weka官网找到这个clusteringdemo示例代码：[https ://svn.scms.waikato.ac.nz/svn/weka/trunk/wekaexamples/src/main/java/wekaexamples/clusterers/ClusteringDemo.java](https://svn.scms.waikato.ac.nz/svn/weka/trunk/wekaexamples/src/main/java/wekaexamples/clusterers/ClusteringDemo.java)

但是，在 weka 目录中设置示例 arff 代码后，我收到此错误“错误：无法找到或加载主类 ClusteringDemo”。谁能帮我找出原因？我只更改语句 data = DataSource.read(filename); 中的文件名。此外，我的类路径设置正确，因为我已经做了一些分类器。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-04T11:38:12.127

1.- 也许 ClusteringDemo.class 不在您的类路径中。您应该将 jar 文件的类添加到您的项目中。

2.- 无论如何，您可以从以下网址下载 java 代码：[http](http://weka.wikispaces.com/file/detail/ClusteringDemo.java) ://weka.wikispaces.com/file/detail/ClusteringDemo.java 编译并运行它（确保 weka.jar 在您的类路径中）。

3.- 如果您已将 ClusteringDemo.java 添加到您的项目中。根据其位置，确保它具有“包”行（第一行）。否则 Java 将无法找到它。

祝你使用 EM 好运，也许你也可以试试 N-grams + Naive Bayes。

# actionscript-3 - as3 声明一个 GLOBAL 变量 - 在 TIMELINE/CLASS 之外

> ID：10392718
> 
> 赞同：0
> 
> 时间：2012-05-01T02:06:36.557
> 
> 标签：actionscript-3, flash, scope, global-variables, global

我希望在主要时间线中声明一个 GLOBAL VAR。

然后我需要从另一个外部加载的 SWF 访问该 GLOBAL VAR。

**问题：**

如何在主时间轴中创建全局变量？

如何在外部加载的 swf 文件中访问该 var？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-01T12:44:31.980

首先，您不应该使用**任何** [全局/静态状态](http://misko.hevery.com/2008/11/21/clean-code-talks-global-state-and-singletons/)。在您的情况下，情况更是如此**，**因为单例是跨不同应用程序域的皇家痛苦。

相反，您应该使用称为[Dependency Injection](http://jamesshore.com/Blog/Dependency-Injection-Demystified.html)的东西。把你的小瑞士法郎想象成饥饿的孤儿。当它们加载后，它们不会跑到您的主要 swf 并捡起它的口袋。相反，主要的瑞士法郎慷慨地将钱压在他们的小手中。

那么，我们如何做到这一点呢？一种方法是我们可以将对它们的 Document 类的引用编译到主 swf 中，然后我们可以设置一个 Class 公开的变量。但是，这可能会变得非常繁重，并且并不是真正必要的。

相反，您可以编写一个称为[Interface](http://www.developria.com/2009/10/interfaces-and-dynamic-class-i.html)的东西，它定义了孤儿的“想法”。

它可能看起来像这样：

```
public interface IOrphan {
   function get alms():Number;
   function set alms(value:Number):void;
} 
```

请注意，您必须将 getter 和 setter 与接口一起使用，因为您不能使用它们来定义 vanilla 变量。但是，这对我们实际的 Orphan 来说非常有用：

```
public class Oliver implements IOrphan {
    private var _alms:Number;
    private var _totalAlms:Number;
    public var tf:TextField;//put this on stage and allow Flash to populate automatically
    public function get alms():Number {
       return _alms;
    }
    public function set alms (value:Number):void {
      _alms = value;
      _totalAlms += _alms;
      updateAlmsMessage();
    }
    private function updateAlmsMessage():void {
       tf.text = 'That was a donation of ' + _alms + '.\n'
                 'I now have ' _totalAlms + '.\n'
                 'Please, sir, can I have some more?';
    }
} 
```

现在，您需要做的就是在加载时填充该变量。有几种方法可以做到这一点，例如[观看要加载的 IOlivers 的阶段](http://flexdiary.blogspot.com/2010/04/sample-code-for-oop-timeline-insideria.html)，或者您可以更直接地了解它：

```
private function loadSwf(url:String):void {
            var loader:Loader = new Loader();
            loader.contentLoaderInfo.addEventListener(Event.COMPLETE, completeHandler);
            var request:URLRequest = new URLRequest(url);
            loader.load(request);
            addChild(loader);
}

private function completeHandler(e:Event):void {
   ((e.target as LoaderInfo).content as IOrphan).alms = .25;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-01T02:56:40.690

如果这些是您只想设置一次并且永远不会更改的变量，您可以创建一个包含静态常量的类。

```
package
{
    public class Env
    {
        public static const WHATEVER:String = "Whatever!";

        public function Env()
        {}
    }
} 
```

然后您可以稍后在程序中访问它们，如下所示：

```
trace(Env.WHATEVER); 
```

但是，如果您想要可以更改的全局变量，我喜欢使用单例类来处理这个问题。

```
package 
{
import flash.events.EventDispatcher;

public class Control extends EventDispatcher
{
    //---------------------------------------
    // PRIVATE & PROTECTED INSTANCE VARIABLES
    //---------------------------------------

    private static var _instance:Control;

    //---------------------------------------
    // PUBLIC VARIABLES
    //---------------------------------------

    public var whatever:String = "Whatever";

    //---------------------------------------
    // PUBLIC METHODS
    //---------------------------------------

    public static function get instance():Control
    {   
        return initialize();
    }

    public static function initialize():Control
    {
        if (_instance == null)
        {
            _instance = new Control();
        }
        return _instance;
    }

    //---------------------------------------
    // CONSTRUCTOR
    //---------------------------------------

    public function Control()
    {
        super();
        if (_instance != null)
        {
            throw new Error("Error:Control already initialised.");
        }
        if (_instance == null)
        {
            _instance = this;
        }
    }

}
} 
```

这里的不同之处在于，您需要先获取单例的实例，然后才能了解其中的内容。它看起来有点像这样。

```
private var _control:Control = Control.instance;
// Reading a global variable
trace(_control.whatever);
// Change a global variable
_control.whatever = "Foobar!"; 
```

因此，无论何时更改“任何内容”，该变量都会针对所有加载的 SWF 进行更改。如果你想真正喜欢它，你可以在你的单例中使用 getter/setter 而不是简单的公共变量。

# php - PHP：如何在 MySQL 中每 10 行插入一个新行？

> ID：10392719
> 
> 赞同：0
> 
> 时间：2012-05-01T02:06:41.430
> 
> 标签：php, mysql

在填充了 10 行数据后，我想在一行中插入一个新的随机图像（全部单独）。

我想我应该输入这样的东西：

```
if($counter % 10 == 0) {
  echo 'image file';
} 
```

但不确定如何将其合并到我的代码中：

```
 echo "<table border='1' CELLPADDING=5 STYLE='font-size:13px'>";
 echo "<tr> <td><H3>No.</H3></td><td><H3>Date</H3></td>";
 echo "<td><H3>First Name</H3></td> <td><H3>Last Name</H3></td>";
 echo "<td><H3>City</H3></td><td><H3>Province</H3></td></tr>";

 //declaring counter
 $count=0;

 // keeps getting the next row until there are no more to get
 while ($row = mysql_fetch_array( $data, MYSQL_ASSOC )) {
     //counter equals
     $count=$count+1;   

     // Print out the contents of each row into a table
     echo "</td><td>";
     echo $count;
     echo "</td><td>";
     echo $row['DateIn'];
     echo "</td><td>";
     echo $row['FirstName'];
     echo "</td><td>";
     echo $row['LastName'];
     echo "</td><td>";
     echo $row['City'];
     echo "</td><td>";
     echo $row['Province_State'];
     echo "</td></tr>";
}
echo "</table>"; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-01T02:09:11.003

if($counter % 10 == 0) { echo '图像文件'; 10，而不是 100 :)。把它放在你的 $count=$count+1 语句之后，在 td colspan=however 你有多少列。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-01T02:09:46.403

```
echo "<table border='1' CELLPADDING=5 STYLE='font-size:13px'>";
echo "<tr> <td><H3>No.</H3></td><td><H3>Date</H3></td><td><H3>First Name</H3></td> <td>    <H3>Last Name</H3></td> <td><H3>City</H3></td><td><H3>Province</H3></td></tr>";

//declaring counter
$count=0;

// keeps getting the next row until there are no more to get
while ($row = mysql_fetch_array( $data, MYSQL_ASSOC )) {

//counter equals
$count++;  

//insert an image every 10 rows
if($count==10){
    $count=0;
    echo 'yourimage.jpg';
}

// Print out the contents of each row into a table
echo "</td><td>";
echo $count;
echo "</td><td>";
echo $row['DateIn'];
echo "</td><td>";
echo $row['FirstName'];
echo "</td><td>";
echo $row['LastName'];
echo "</td><td>";
echo $row['City'];
echo "</td><td>";
echo $row['Province_State'];
echo "</td></tr>";
}
echo "</table>"; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-01T19:39:16.973

感谢Here的帮助，这是完整的有效代码（但是，我仍然无法显示随机图像，但我可以获得图像:-)

```
 echo "<table border='1' CELLPADDING=5 STYLE='font-size:13px'>";
    echo "<tr> <td><H3>No.</H3></td><td><H3>Date</H3></td><td><H3>First Name</H3></td> <td><H3>Last Name</H3></td> <td><H3>City</H3></td><td><H3>Province</H3></td></tr>";

    //declaring counter for data
    $count=0;

    //declaring counter for random image
    $counter_for_image=0;

    // keeps getting the next row until there are no more to get
    while ($row = mysql_fetch_array( $data, MYSQL_ASSOC )) {

    //counter for actual count
    $count=$count+1;    

    //counter for image count
    //so I can reset count and
    //not affect actual count
    $counter_for_image++;

    /* does not work
    // start random image code
    $images = array(
    0 => '1.jpg',
    1 => '2.jpg',
    );
    $image = $images[ rand(0,(count($images)-1)) ];
    $randomimage = "<img src=\"/http://wwww.my site.com/storm/images/".$image."\" alt=\"\" border=\"0\" />";
    //print($output);
    // end random image code
    */

    // start every 10th row image display code  
    if($counter_for_image==10){
    $counter_for_image=0;

    echo '<tr><td colspan="6"><center><img src="http://www.mysite.com/storm/images/eric.jpg"/></center></td></tr>';

    /* would use this if I could get random image to work
    echo '<tr><td colspan="6"><center>';
    print($randomimage);
    echo '</center></td></tr>';
    */

    } // end every 10th row image display code  

    // Print out the contents of each row into a table
    echo "</td><td>";
    echo $count;
    echo "</td><td>";
    echo $row['DateIn'];
    echo "</td><td>";
    echo $row['FirstName'];
    echo "</td><td>";
    echo $row['LastName'];
    echo "</td><td>";
    echo $row['City'];
    echo "</td><td>";
    echo $row['Province_State'];
    echo "</td></tr>";
}
    echo "</table>"; 
```

# android - 当两者都在后台时，如何区分 Importand 应用程序和非 Importand 应用程序

> ID：10392721
> 
> 赞同：1
> 
> 时间：2012-05-01T02:07:15.060
> 
> 标签：android, background-process, discovery

我希望这个问题不会和这个问题一样[好运](https://stackoverflow.com/questions/10239728/how-to-launch-an-android-appwidgets-configuration-activity-from-another-activit)。

我想让我的用户能够通过列表关闭一些在后台的应用程序。后台应用程序是指用户启动然后按下主页按钮的应用程序，例如 Internet 浏览器。我设法通过 ActivityManager 找到了后台应用程序（getRunningAppProcesses 和 getRunningTasks 都可以完成这项工作）。然而，在后台有一些应用程序对系统工作很重要（即电话、启动器、输入法等），我不希望它们出现在我的列表中。

我的问题是：如何将它们与非重要的区别开来。我不想使用某种字符串检查/过滤（例如 contains(com.android) 等），因为我想排除一些重要的 3rd 方应用程序，例如非库存启动器、拨号器、消息传递等。

每个拥有 Galaxy S2 并使用过“节目监视器小部件”的人都会明白我的意思。

非常感谢您的时间和努力...

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-02T01:02:48.937

好吧，我终于想出了一个功能，可以检查正在运行的任务是否可以被视为“重要”任务。首先，我们必须使用 ActivityManager 中的 getRunningTasks 函数来获取一个包含 ActivityManager.RunningTaskInfo 对象的列表，然后我们将这些对象中的每一个传递给以下函数进行检查。希望这可以帮助某人...

```
public boolean isRunningTaskImportant(ActivityManager.RunningTaskInfo taskinfo) {
    //What makes a running task important is somehow "fluid" but there are a few task categories
    //on which is safe to assume that they are important. These categories are:
    //1\. If task has not any actual activities running. This is because these are not actuall running but they are frozen by the
    //   the system and they will be killed if needed. They are not Important but we do not want them in our running apps list.
    //2\. Well known namespaces including our own if we want to
    //3\. Home Launcher Applications
    //4\. Phone Handling Applications

    boolean result = false;
    ComponentName bActivity = taskinfo.baseActivity;

    if (bActivity == null) return false; //<-- The task has no base activity so we ignore it...

    String pName = bActivity.getPackageName();

    if (taskinfo.numRunning == 0) {
        result = true;
    } else {
        if (pName.equalsIgnoreCase("com.android.phone")) {
            result = true;
        } else if (pName.equalsIgnoreCase("com.android.contacts")) {
            result = true;
        } else if (pName.equalsIgnoreCase("com.chdcomputers.powerpanel")) {
            result = true;
        } else {
            //Here we are checking if out task is a home launcher application.
            //This code is based on this question: http://stackoverflow.com/questions/3293253/getting-list-of-installed-apps-easy-but-how-to-launch-one-of-them
            Log.d(TAG, "isRunningTaskImportant checking for launchers");
            Intent launchersIntent = new Intent(Intent.ACTION_MAIN, null); 
            launchersIntent.addCategory(Intent.CATEGORY_HOME);
            List<ResolveInfo> list = cx.getPackageManager().queryIntentActivities(launchersIntent,0); 
            boolean found = false;

            for (ResolveInfo ri : list){
                if (!found){
                    Log.d(TAG, "isRunningTaskImportant checking launcher app: " + ri.activityInfo.applicationInfo.packageName);
                    found = pName.equalsIgnoreCase(ri.activityInfo.applicationInfo.packageName);
                }
                if (found) break;
            }

            result = found;

            if (!found) {
                //Finaly we are going to check if out task is a Phone Handling application
                //The idea behind that is to check for what kind of permissions the application wants
                //In my opinion any "serious" phone handling app should ask for, at least, the following 9 permissions:
                //CALL_PHONE, CALL_PRIVILEGED, READ_CONTACTS, WRITE_CONTACTS, SYSTEM_ALERT_WINDOW, READ_PHONE_STATE,
                //MODIFY_PHONE_STATE, PROCESS_OUTGOING_CALLS, RECEIVE_BOOT_COMPLETED
                //So if the application asks for those permissions we can assume that is a phone handling application...

                Log.d(TAG, "isRunningTaskImportant checking possible phone app: " + pName);

                try {
                    PackageInfo pi = cx.getPackageManager().getPackageInfo(pName,PackageManager.GET_PERMISSIONS);
                    String[] perms = pi.requestedPermissions;

                    if (perms == null) {
                        result = false;
                    } else {
                        int pCount = 0;
                        for (String perm : perms) {
                            if (perm.equalsIgnoreCase("android.permission.CALL_PHONE")) {
                                pCount++;
                            } else if (perm.equalsIgnoreCase("android.permission.CALL_PRIVILEGED")) {
                                pCount++;
                            } else if (perm.equalsIgnoreCase("android.permission.READ_CONTACTS")) {
                                pCount++;
                            } else if (perm.equalsIgnoreCase("android.permission.WRITE_CONTACTS")) {
                                pCount++;
                            } else if (perm.equalsIgnoreCase("android.permission.SYSTEM_ALERT_WINDOW")) {
                                pCount++;
                            } else if (perm.equalsIgnoreCase("android.permission.READ_PHONE_STATE")) {
                                pCount++;
                            } else if (perm.equalsIgnoreCase("android.permission.MODIFY_PHONE_STATE")) {
                                pCount++;
                            } else if (perm.equalsIgnoreCase("android.permission.PROCESS_OUTGOING_CALLS")) {
                                pCount++;
                            } else if (perm.equalsIgnoreCase("android.permission.RECEIVE_BOOT_COMPLETED")) {
                                pCount++;
                            }
                        }
                        result = (pCount == 9);
                    }
                } catch (Exception ex) {
                    Log.e(TAG, "isRunningTaskImportant checking possible phone app ERROR: " + ex.getMessage());
                    result = false;
                }
            } 
        }
    }

    return result;
} 
```

# java - java中的内部类和本地内部类有什么区别？

> ID：10392725
> 
> 赞同：4
> 
> 时间：2012-05-01T02:08:00.810
> 
> 标签：java, actionlistener, inner-classes

如果一个类是本地内部类，这是否意味着它在另一个类的方法内部，或者它是否意味着它只是在某个地方的另一个方法中定义。

例如，在下面的代码中，MenuListener 是否被视为内部本地类？

```
import java.awt.*;
import java.awt.event.*;
import javax.swing.*;

public class MenuDemo extends JFrame{
private Container c;
private ImageIcon[] images = new ImageIcon[5];
private JLabel picture;
private JPanel mainPanel;
private JMenuBar menuBar;
private JMenu menu;
private JMenuItem bird,cat,dog,rabbit,pig;

public MenuDemo() {
    super("Menu Demo");

    c = getContentPane();
    c.setLayout(new BorderLayout());

    mainPanel = new JPanel();

    // Store the animal pictures in an array.
    for (int i=0; i<5; i++){
        images[i] = new ImageIcon("image" + i + ".gif");
    }
    //Set up the picture label.
    picture = new JLabel(images[0]);
    picture.setPreferredSize(new Dimension(177,122));
    mainPanel.add(picture, BorderLayout.CENTER);
    c.add(mainPanel);
    buildMenuBar();
    this.setJMenuBar(menuBar);
    pack();
    setVisible(true);
}

private void buildMenuBar(){
    MenuListener listener = new MenuListener();
    menuBar = new JMenuBar();

    menu = new JMenu("Animals");
    menu.setMnemonic(KeyEvent.VK_A);
    menuBar.add(menu);

    bird = new JMenuItem("Bird", KeyEvent.VK_B);
    bird.addActionListener(listener);
    menu.add(bird);

    cat = new JMenuItem("Cat", KeyEvent.VK_C);
    cat.addActionListener(listener);
    menu.add(cat);

    dog = new JMenuItem("Dog", KeyEvent.VK_D);
    dog.addActionListener(listener);
    menu.add(dog);

    rabbit = new JMenuItem("Rabbit", KeyEvent.VK_R);
    rabbit.addActionListener(listener);
    menu.add(rabbit);

    pig = new JMenuItem("Pig", KeyEvent.VK_P);
    pig.addActionListener(listener);
    menu.add(pig);
}

private class MenuListener implements ActionListener {
    public void actionPerformed(ActionEvent e){
        if (e.getSource() == bird)
            picture.setIcon(images[0]);
        else if (e.getSource() == cat)
            picture.setIcon(images[1]);
        else if (e.getSource() == dog)
            picture.setIcon(images[2]);
        else if (e.getSource() == rabbit)
            picture.setIcon(images[3]);
        if (e.getSource() == pig)
            picture.setIcon(images[4]);
    }
}

public static void main(String[] args){
    MenuDemo m = new MenuDemo();
    m.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
}   
} 
```

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-05-01T02:26:26.897

[根据一些官方的 Oracle Java 教程](http://docs.oracle.com/javase/tutorial/java/javaOO/innerclasses.html)，本地内部类是在代码块中定义的类，而不是另一个类定义的一部分。这意味着在方法或初始化程序块中定义的类。

按照这个定义，`MenuListener`不是本地内部类——它只是一个内部类。

所以：

```
public class Outer {

    public class Inner1 {
    }

    public static class Inner2 {
    }

    public void method(){

        class LocalInner{
        }

        LocalInner yesThisActuallyCompiles = new LocalInner();
    }
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-01T02:53:59.083

> 如果一个类是本地内部类，这是否意味着它在方法内部

是的。

> 另一类的

不属于*一个*类，但任何方法都必须在一个类中。

> 或者这是否意味着它只是在某个地方的另一种方法中定义。

是的。

这些之间没有太大区别，除了“在另一个班级”和“某处”之间的区别。目前还不清楚你实际上在问什么。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2017-05-19T06:03:46.963

**内部班/会员班**

在类内部但在方法外部创建的非静态类称为成员内部类。

```
class TestMemberOuter1{  
 private int data=30;  
 class Inner{  
  void msg(){System.out.println("data is "+data);}  
 }  
 public static void main(String args[]){  
  TestMemberOuter1 obj=new TestMemberOuter1();  
  TestMemberOuter1.Inner in=obj.new Inner();  
  in.msg();  
 }  
} 
```

**本地内部类**

在方法内部创建的类在java中称为本地内部类。如果要调用本地内部类的方法，必须在方法内部实例化这个类

```
 public class localInner1{  
     private int data=30; 
     void display(){  
      class Local{  
       void msg(){System.out.println(data);}  
      }  
      Local l=new Local();  
      l.msg();  
     }  
     public static void main(String args[]){  
      localInner1 obj=new localInner1();  
      obj.display();  
     }  
    } 
```

# orm - kohana orm 加入重复对象结果

> ID：10392727
> 
> 赞同：0
> 
> 时间：2012-05-01T02:08:28.683
> 
> 标签：orm, kohana-3

我正在尝试使用以下查询查询国家/地区表以打印具有相应城市的所有国家/地区。现在我为每个城市获得一个重复的国家对象，而不是为所有城市拥有一个国家对象。

```
$all = ORM::factory('country')->select('cities.*')->join('cities','LEFT')->on('country.id', '=', 'country_id' )->find-all();

foreach ($all as $country) {
    echo $caountry->name;
    foreach($country->cities as $city ){
        echo $city->name;
    }
} 
```

感谢您的帮助，AA

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-01T14:49:33.030

如果您使用 MySQL 并且只需要城市名称，您可以使用[GROUP_CONCAT](http://dev.mysql.com/doc/refman/5.0/en/group-by-functions.html#function_group-concat)函数，然后使用 PHP 的 explode 将其转换为数组。

```
 $all = ORM::factory('country')
    ->select('country.name',DB::epxr('GROUP_CONCAT(cities.name) AS cities'))
    ->join('cities','LEFT')
    ->on('country.id', '=', 'country_id' )
    ->group_by("country.id")
    ->find-all();

foreach ($all as $country) {
    echo $country->name;
    foreach(explode(",",$country->cities) as $city ){
        echo $city;
    }
} 
```

# jquery - Ruby rails - jquery自动完成 - 组合列表项的多个值

> ID：10392734
> 
> 赞同：0
> 
> 时间：2012-05-01T02:09:58.383
> 
> 标签：jquery, ruby, ajax, ruby-on-rails-3

如何解析 rails 实例变量的值以创建 jQuery 的自动完整列表？所以我的“/用户/搜索”返回一个实例变量，每个项目都有多个值。我想将它们组合起来并作为列表项呈现。

```
def search
  if (params[:term] =~ /[a-zA-Z]/)
    @result = User.FindLdap("sAMAccountName", params[:term])
  else
    @result = User.FindLdap("idnumber", params[:term])
  end
  respond_to do |format|
    format.html { render :partial => 'text_for_autocomplete'}
    format.js
  end
end 
```

我正在使用 jQuery 的示例代码，但它有一种方法可以按原样显示每个项目列表。在我的例子中，我检索了多个 ldap 属性，并且我想为每个列表项显示这些属性值。因此，每个列表项都应该用`""#{sAMAccountName}", "#{idnumber}""`逗号分隔，而不仅仅是在文本字段中键入的 idnumber 值。

```
$(function() {
    $("#term").autocomplete({
        source: function (request, response) {
            $.post("/users/search", request, response);
        },
        minLength: 2,
        select: function( event, ui ) {
            log( ui.item ?
                "Selected: " + ui.item.value + " aka " + ui.item.id :
                "Nothing selected, input was " + this.value );
        } #No idea how it can be done here. 
    });
}); 
```

我在列表中得到这个，部分渲染的 html -

![我在列表中得到了这个，实际的部分渲染](../Images/2715dba0d3a87c9da8e379969f3ee662.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-01T08:07:33.960

首先，您需要查看[JBuilder](https://github.com/rails/jbuilder)。JBuilder 是强大、定义明确且可靠的 json 输出解决方案。

# c++ - 我是不是太快了以至于数不清？

> ID：10392735
> 
> 赞同：3
> 
> 时间：2012-05-01T02:10:04.503
> 
> 标签：c++, linux, procfs

我在不同的数据库系统上做了一些本地实验。`/proc/status`我在执行查询之前和之后收集（总结）CPU 信息。差异应该告诉我查询运行期间的 jiffies 或 USER_HZ 的数量。`clock_gettime()`但是当（根据）查询的运行时间低于时，差异为零`0.001 seconds`。这是为了快速利用 CPU 信息还是我错过了其他东西？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-01T02:44:45.457

从 Linux 内核 2.6.0 开始，一瞬间是 1/250 秒，或 0.004 秒 [参见[time(7)]](http://www.kernel.org/doc/man-pages/online/pages/man7/time.7.html)。你永远不会得到比这更小的分辨率。

我建议您使用该`rdtsc`指令，它可能作为编译器内在函数提供。这是每 1 个 CPU 滴答声递增一次，因此通过除以频率可以得到经过的时间量。您也可以[使用内联汇编](http://www.mcs.anl.gov/~kazutomo/rdtsc.html)来实现它。

检查实际上有点荒谬，`/proc/status`因为很有可能打开文件描述符并读取内容实际上需要比您的查询执行更长的时间。`rdtsc`更可靠。

# javascript - jquery 到 javascript 的翻译

> ID：10392736
> 
> 赞同：-3
> 
> 时间：2012-05-01T02:10:05.003
> 
> 标签：javascript, jquery

有人可以把它翻译成普通的javaScript吗：

```
$("div.intro h1").hide();
$("div.intro h2").remove(); 
```

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-01T02:29:41.750

您可以首先测试对 querySelectorAll 的支持，如果找到，则使用它来创建与“div.intro h1”匹配的元素数组。

否则，使用`getElementsByTagName('div')`, 过滤具有“介绍”类的那些，然后使用`getElementByTagName('h1')`获取 H1 元素并将它们收集到一个数组中。

然后对于结果数组的每个成员，设置它们的`style.display = 'none'`.

做同样的事情来创建一个要删除的数组，然后为每个 do `el.parentNode.removeChild(el)`。

让我们看看你想出了什么。

# wordpress - 图片、CSS 和其他链接在 WAMP 虚拟主机上不起作用

> ID：10392741
> 
> 赞同：0
> 
> 时间：2012-05-01T02:11:11.537
> 
> 标签：wordpress, virtualhost, wampserver, httpd.conf

我已经使用 Windows XP 64 位专业工作站设置了 WAMP 服务器。之后，我在端口 81 和 82 上添加了两个虚拟主机。在一个虚拟主机中我安装了 CodeIgniter，而在另一个 WordPress 中。两个虚拟主机都有同样的问题：在我的本地网络之外，相对路径没有得到正确管理。

此行为仅发生在虚拟主机中，默认主机工作正常。

附上我发布了我的 httpd.conf 文件和 httpd-vhost.conf 文件。希望有人遇到同样的问题。

httpd.conf：

```
#
# This is the main Apache HTTP server configuration file.  It contains the
# configuration directives that give the server its instructions.
# See <URL:http://httpd.apache.org/docs/2.2> for detailed information.
# In particular, see 
# <URL:http://httpd.apache.org/docs/2.2/mod/directives.html>
# for a discussion of each configuration directive.
#
# Do NOT simply read the instructions in here without understanding
# what they do.  They're here only as hints or reminders.  If you are unsure
# consult the online docs. You have been warned.  
#
# Configuration and logfile names: If the filenames you specify for many
# of the server's control files begin with "/" (or "drive:/" for Win32), the
# server will use that explicit path.  If the filenames do *not* begin
# with "/", the value of ServerRoot is prepended -- so "logs/foo.log"
# with ServerRoot set to "C:/Program Files/Apache Software Foundation/Apache2.2" will be         interpreted by the
# server as "C:/Program Files/Apache Software Foundation/Apache2.2/logs/foo.log".
#
# NOTE: Where filenames are specified, you must use forward slashes
# instead of backslashes (e.g., "c:/apache" instead of "c:\apache").
# If a drive letter is omitted, the drive on which Apache.exe is located
# will be used by default.  It is recommended that you always supply
# an explicit drive letter in absolute paths to avoid confusion.

#
# ServerRoot: The top of the directory tree under which the server's
# configuration, error, and log files are kept.
#
# Do not add a slash at the end of the directory path.  If you point
# ServerRoot at a non-local disk, be sure to point the LockFile directive
# at a local disk.  If you wish to share the same ServerRoot for multiple
# httpd daemons, you will need to change at least LockFile and PidFile.
#
ServerRoot "c:/wamp/bin/apache/apache2.2.21"

#
# Listen: Allows you to bind Apache to specific IP addresses and/or
# ports, instead of the default. See also the <VirtualHost>
# directive.
#
# Change this to Listen on specific IP addresses as shown below to 
# prevent Apache from glomming onto all bound IP addresses.
#
#Listen 12.34.56.78:80
Listen *:80
Listen *:81
Listen *:82

#
# Dynamic Shared Object (DSO) Support
#
# To be able to use the functionality of a module which was built as a DSO you
# have to place corresponding `LoadModule' lines at this location so the
# directives contained in it are actually available _before_ they are used.
# Statically compiled modules (those listed by `httpd -l') do not need
# to be loaded here.
#
# Example:
# LoadModule foo_module modules/mod_foo.so
#
LoadModule actions_module modules/mod_actions.so
LoadModule alias_module modules/mod_alias.so
LoadModule asis_module modules/mod_asis.so
LoadModule auth_basic_module modules/mod_auth_basic.so
#LoadModule auth_digest_module modules/mod_auth_digest.so
#LoadModule authn_alias_module modules/mod_authn_alias.so
#LoadModule authn_anon_module modules/mod_authn_anon.so
#LoadModule authn_dbd_module modules/mod_authn_dbd.so
#LoadModule authn_dbm_module modules/mod_authn_dbm.so
LoadModule authn_default_module modules/mod_authn_default.so
LoadModule authn_file_module modules/mod_authn_file.so
#LoadModule authnz_ldap_module modules/mod_authnz_ldap.so
#LoadModule authz_dbm_module modules/mod_authz_dbm.so
LoadModule authz_default_module modules/mod_authz_default.so
LoadModule authz_groupfile_module modules/mod_authz_groupfile.so
LoadModule authz_host_module modules/mod_authz_host.so
#LoadModule authz_owner_module modules/mod_authz_owner.so
LoadModule authz_user_module modules/mod_authz_user.so
LoadModule autoindex_module modules/mod_autoindex.so
#LoadModule cache_module modules/mod_cache.so
#LoadModule cern_meta_module modules/mod_cern_meta.so
LoadModule cgi_module modules/mod_cgi.so
#LoadModule charset_lite_module modules/mod_charset_lite.so
#LoadModule dav_module modules/mod_dav.so
#LoadModule dav_fs_module modules/mod_dav_fs.so
#LoadModule dav_lock_module modules/mod_dav_lock.so
#LoadModule dbd_module modules/mod_dbd.so
#LoadModule deflate_module modules/mod_deflate.so
LoadModule dir_module modules/mod_dir.so
#LoadModule disk_cache_module modules/mod_disk_cache.so
#LoadModule dumpio_module modules/mod_dumpio.so
LoadModule env_module modules/mod_env.so
#LoadModule expires_module modules/mod_expires.so
#LoadModule ext_filter_module modules/mod_ext_filter.so
#LoadModule file_cache_module modules/mod_file_cache.so
#LoadModule filter_module modules/mod_filter.so
#LoadModule headers_module modules/mod_headers.so
#LoadModule ident_module modules/mod_ident.so
#LoadModule imagemap_module modules/mod_imagemap.so
LoadModule include_module modules/mod_include.so
#LoadModule info_module modules/mod_info.so
LoadModule isapi_module modules/mod_isapi.so
#LoadModule ldap_module modules/mod_ldap.so
#LoadModule logio_module modules/mod_logio.so
LoadModule log_config_module modules/mod_log_config.so
#LoadModule log_forensic_module modules/mod_log_forensic.so
#LoadModule mem_cache_module modules/mod_mem_cache.so
LoadModule mime_module modules/mod_mime.so
#LoadModule mime_magic_module modules/mod_mime_magic.so
LoadModule negotiation_module modules/mod_negotiation.so
#LoadModule proxy_module modules/mod_proxy.so
#LoadModule proxy_ajp_module modules/mod_proxy_ajp.so
#LoadModule proxy_balancer_module modules/mod_proxy_balancer.so
#LoadModule proxy_connect_module modules/mod_proxy_connect.so
#LoadModule proxy_ftp_module modules/mod_proxy_ftp.so
#LoadModule proxy_http_module modules/mod_proxy_http.so
#LoadModule rewrite_module modules/mod_rewrite.so
#LoadModule setenvif_module modules/mod_setenvif.so
#LoadModule speling_module modules/mod_speling.so
#LoadModule ssl_module modules/mod_ssl.so
#LoadModule status_module modules/mod_status.so
#LoadModule substitute_module modules/mod_substitute.so
#LoadModule unique_id_module modules/mod_unique_id.so
#LoadModule userdir_module modules/mod_userdir.so
#LoadModule usertrack_module modules/mod_usertrack.so
#LoadModule version_module modules/mod_version.so
#LoadModule vhost_alias_module modules/mod_vhost_alias.so
LoadModule php5_module "c:/wamp/bin/php/php5.3.10/php5apache2_2.dll"

<IfModule !mpm_netware_module>
<IfModule !mpm_winnt_module>
#
# If you wish httpd to run as a different user or group, you must run
# httpd as root initially and it will switch.  
#
# User/Group: The name (or #number) of the user/group to run httpd as.
# It is usually good practice to create a dedicated user and group for
# running httpd, as with most system services.
#
User daemon
Group daemon

</IfModule>
</IfModule>

# 'Main' server configuration
#
# The directives in this section set up the values used by the 'main'
# server, which responds to any requests that aren't handled by a
# <VirtualHost> definition.  These values also provide defaults for
# any <VirtualHost> containers you may define later in the file.
#
# All of these directives may appear inside <VirtualHost> containers,
# in which case these default settings will be overridden for the
# virtual host being defined.
#

#
# ServerAdmin: Your address, where problems with the server should be
# e-mailed.  This address appears on some server-generated pages, such
# as error documents.  e.g. admin@your-domain.com
#
ServerAdmin admin@localhost

#
# ServerName gives the name and port that the server uses to identify itself.
# This can often be determined automatically, but we recommend you specify
# it explicitly to prevent problems during startup.
#
# If your host doesn't have a registered DNS name, enter its IP address here.
#
ServerName localhost:80

#
# DocumentRoot: The directory out of which you will serve your
# documents. By default, all requests are taken from this directory, but
# symbolic links and aliases may be used to point to other locations.
#
DocumentRoot "c:/wamp/www/"

#
# Each directory to which Apache has access can be configured with respect
# to which services and features are allowed and/or disabled in that
# directory (and its subdirectories). 
#
# First, we configure the "default" to be a very restrictive set of 
# features.  
#
<Directory />
    Options FollowSymLinks
    AllowOverride None
    Order deny,allow
    Allow from all
</Directory>

#
# Note that from this point forward you must specifically allow
# particular features to be enabled - so if something's not working as
# you might expect, make sure that you have specifically enabled it
# below.
#

#
# This should be changed to whatever you set DocumentRoot to.
#
<Directory "c:/wamp/www/">
#
# Possible values for the Options directive are "None", "All",
# or any combination of:
#   Indexes Includes FollowSymLinks SymLinksifOwnerMatch ExecCGI MultiViews
#
# Note that "MultiViews" must be named *explicitly* --- "Options All"
# doesn't give it to you.
#
# The Options directive is both complicated and important.  Please see
# http://httpd.apache.org/docs/2.2/mod/core.html#options
# for more information.
#
Options Indexes FollowSymLinks

#
# AllowOverride controls what directives may be placed in .htaccess files.
# It can be "All", "None", or any combination of the keywords:
#   Options FileInfo AuthConfig Limit
#
AllowOverride all

#
# Controls who can get stuff from this server.
#

#   onlineoffline tag - don't remove
Order Deny,Allow
Deny from all
Allow from all

</Directory>

#
# DirectoryIndex: sets the file that Apache will serve if a directory
# is requested.
#
<IfModule dir_module>
    DirectoryIndex index.php index.php3 index.html index.htm
</IfModule>

#
# The following lines prevent .htaccess and .htpasswd files from being 
# viewed by Web clients. 
#
<FilesMatch "^\.ht">
    Order allow,deny
    Deny from all
    Satisfy All
</FilesMatch>

#
# ErrorLog: The location of the error log file.
# If you do not specify an ErrorLog directive within a <VirtualHost>
# container, error messages relating to that virtual host will be
# logged here.  If you *do* define an error logfile for a <VirtualHost>
# container, that host's errors will be logged there and not here.
#
ErrorLog "c:/wamp/logs/apache_error.log"

#
# LogLevel: Control the number of messages logged to the error_log.
# Possible values include: debug, info, notice, warn, error, crit,
# alert, emerg.
#
LogLevel warn

<IfModule log_config_module>
#
# The following directives define some format nicknames for use with
# a CustomLog directive (see below).
#
LogFormat "%h %l %u %t \"%r\" %>s %b \"%{Referer}i\" \"%{User-Agent}i\"" combined
LogFormat "%h %l %u %t \"%r\" %>s %b" common

<IfModule logio_module>
  # You need to enable mod_logio.c to use %I and %O
  LogFormat "%h %l %u %t \"%r\" %>s %b \"%{Referer}i\" \"%{User-Agent}i\" %I %O" combinedio
</IfModule>

#
# The location and format of the access logfile (Common Logfile Format).
# If you do not define any access logfiles within a <VirtualHost>
# container, they will be logged here.  Contrariwise, if you *do*
# define per-<VirtualHost> access logfiles, transactions will be
# logged therein and *not* in this file.
#
CustomLog "c:/wamp/logs/access.log" common

#
# If you prefer a logfile with access, agent, and referer information
# (Combined Logfile Format) you can use the following directive.
#
#CustomLog "logs/access.log" combined
</IfModule>

<IfModule alias_module>
#
# Redirect: Allows you to tell clients about documents that used to 
# exist in your server's namespace, but do not anymore. The client 
# will make a new request for the document at its new location.
# Example:
# Redirect permanent /foo http://localhost/bar

#
# Alias: Maps web paths into filesystem paths and is used to
# access content that does not live under the DocumentRoot.
# Example:
# Alias /webpath /full/filesystem/path
#
# If you include a trailing / on /webpath then the server will
# require it to be present in the URL.  You will also likely
# need to provide a <Directory> section to allow access to
# the filesystem path.

#
# ScriptAlias: This controls which directories contain server scripts. 
# ScriptAliases are essentially the same as Aliases, except that
# documents in the target directory are treated as applications and
# run by the server when requested rather than as documents sent to the
# client.  The same rules about trailing "/" apply to ScriptAlias
# directives as to Alias.
#
ScriptAlias /cgi-bin/ "cgi-bin/"

</IfModule>

<IfModule cgid_module>
#
# ScriptSock: On threaded servers, designate the path to the UNIX
# socket used to communicate with the CGI daemon of mod_cgid.
#
#Scriptsock logs/cgisock
</IfModule>

#
# "C:/Program Files/Apache Software Foundation/Apache2.2/cgi-bin" should be changed to whatever your ScriptAliased
# CGI directory exists, if you have that configured.
#
<Directory "cgi-bin">
AllowOverride None
Options None
Order allow,deny
Allow from all
</Directory>

#
# DefaultType: the default MIME type the server will use for a document
# if it cannot otherwise determine one, such as from filename extensions.
# If your server contains mostly text or HTML documents, "text/plain" is
# a good value.  If most of your content is binary, such as applications
# or images, you may want to use "application/octet-stream" instead to
# keep browsers from trying to display binary files as though they are
# text.
#
DefaultType text/plain

<IfModule mime_module>
#
# TypesConfig points to the file containing the list of mappings from
# filename extension to MIME-type.
#
TypesConfig conf/mime.types

#
# AddType allows you to add to or override the MIME configuration
# file specified in TypesConfig for specific file types.
#
#AddType application/x-gzip .tgz
#
# AddEncoding allows you to have certain browsers uncompress
# information on the fly. Note: Not all browsers support this.
#
#AddEncoding x-compress .Z
#AddEncoding x-gzip .gz .tgz
#
# If the AddEncoding directives above are commented-out, then you
# probably should define those extensions to indicate media types:
#
AddType application/x-compress .Z
AddType application/x-gzip .gz .tgz
AddType application/x-httpd-php .php
AddType application/x-httpd-php .php3

#
# AddHandler allows you to map certain file extensions to "handlers":
# actions unrelated to filetype. These can be either built into the server
# or added with the Action directive (see below)
#
# To use CGI scripts outside of ScriptAliased directories:
# (You will also need to add "ExecCGI" to the "Options" directive.)
#
#AddHandler cgi-script .cgi

# For type maps (negotiated resources):
#AddHandler type-map var

#
# Filters allow you to process content before it is sent to the client.
#
# To parse .shtml files for server-side includes (SSI):
# (You will also need to add "Includes" to the "Options" directive.)
#
#AddType text/html .shtml
#AddOutputFilter INCLUDES .shtml
</IfModule>

#
# The mod_mime_magic module allows the server to use various hints from the
# contents of the file itself to determine its type.  The MIMEMagicFile
# directive tells the module where the hint definitions are located.
#
#MIMEMagicFile conf/magic

#
# Customizable error responses come in three flavors:
# 1) plain text 2) local redirects 3) external redirects
#
# Some examples:
#ErrorDocument 500 "The server made a boo boo."
#ErrorDocument 404 /missing.html
#ErrorDocument 404 "/cgi-bin/missing_handler.pl"
#ErrorDocument 402 http://localhost/subscription_info.html
#

#
# EnableMMAP and EnableSendfile: On systems that support it, 
# memory-mapping or the sendfile syscall is used to deliver
# files.  This usually improves server performance, but must
# be turned off when serving from networked-mounted 
# filesystems or if support for these functions is otherwise
# broken on your system.
#
#EnableMMAP off
#EnableSendfile off

# Supplemental configuration
#
# The configuration files in the conf/extra/ directory can be 
# included to add extra features or to modify the default configuration of 
# the server, or you may simply copy their contents here and change as 
# necessary.

# Server-pool management (MPM specific)
#Include conf/extra/httpd-mpm.conf

# Multi-language error messages
#Include conf/extra/httpd-multilang-errordoc.conf

# Fancy directory listings
Include conf/extra/httpd-autoindex.conf

# Language settings
#Include conf/extra/httpd-languages.conf

# User home directories
#Include conf/extra/httpd-userdir.conf

# Real-time info on requests and configuration
#Include conf/extra/httpd-info.conf

# Virtual hosts
Include conf/extra/httpd-vhosts.conf

# Local access to the Apache HTTP Server Manual
#Include conf/extra/httpd-manual.conf

# Distributed authoring and versioning (WebDAV)
#Include conf/extra/httpd-dav.conf

# Various default settings
#Include conf/extra/httpd-default.conf

# Secure (SSL/TLS) connections
#Include conf/extra/httpd-ssl.conf
#
# Note: The following must must be present to support
#       starting without SSL on platforms with no /dev/random equivalent
#       but a statically compiled-in mod_ssl.
#
<IfModule ssl_module>
SSLRandomSeed startup builtin
SSLRandomSeed connect builtin
</IfModule>

Include "c:/wamp/alias/*" 
```

httpd-vhost.conf：

```
#
# Virtual Hosts
#
# If you want to maintain multiple domains/hostnames on your
# machine you can setup VirtualHost containers for them. Most configurations
# use only name-based virtual hosts so the server doesn't need to worry about
# IP addresses. This is indicated by the asterisks in the directives below.
#
# Please see the documentation at 
# <URL:http://httpd.apache.org/docs/2.2/vhosts/>
# for further details before you try to setup virtual hosts.
#
# You may use the command line option '-S' to verify your virtual host
# configuration.

#
# Use name-based virtual hosting.
#
NameVirtualHost *:80

#
# VirtualHost example:
# Almost any Apache directive may go into a VirtualHost container.
# The first VirtualHost section is used for all requests that do not
# match a ServerName or ServerAlias in any <VirtualHost> block.
#
<VirtualHost *:80>
     DocumentRoot "C:\wamp\www"
     ServerName localhost
</VirtualHost>
<VirtualHost *:81>
    DocumentRoot "c:\wamp\codeigniter"
    ServerName codeigniter
    ServerAlias codeigniter
</VirtualHost>
<VirtualHost *:82>
    DocumentRoot "c:\wamp\wordpress"
    ServerName wordpress
   ServerAlias wordpress
</VirtualHost> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-02T13:41:37.940

在您的 httpd-vhost.conf 文件中，对于 ServerName，您只有名称“codeigniter”和“wordpress”。这是否与您在浏览器中使用的地址匹配？“http://codeigniter/”？

如果 DNS 搜索路径设置正确，这可能在您的本地网络中工作，但在此之外，您需要在浏览器中使用全名“http://codeigniter.example.com/”。并且您的 VirtualHost 中的 ServerName 应该与此匹配。

将 ServerName 从“codeigniter”更改为“codeigniter.example.com”，从“wordpress”更改为“wordpress.example.com”。（当然，填写您的实际域名，而不是“示例”。）

# c++ - OpenMP 的双嵌套

> ID：10392742
> 
> 赞同：0
> 
> 时间：2012-05-01T02:11:11.967
> 
> 标签：c++, visual-studio-2010, openmp

关于 OpenMP 的快速问题：

我不确定如何使用 open MP.As in 并行实现嵌套的双 for 循环，在较大的 for 循环内有两个 for 循环。使用这种循环的算法是“双端选择排序”。

```
void project::parallelDeSelectionSort()
{
  //Printarr(arr,size);
  int comparisons = 0;
  int j = 0;
  int k = 0;

  #pragma omp parallel for private (j, k)
  for(int i = 0;  i < arrSize; i++)
  {
      int min = i;
      int max = ((arrSize-1) - i);
      int maxtemp = max;
      int mintemp = min;

  for(j = min;  j < arrSize;  j++)
  {
       if(data[min] > data[j])
       {
           min = j;
       }
       comparisons++;
       //Printarr(data,arrSize);
  }//end for

  for(k = max; k > 0; k--)
  {
       if(data[max] < data[k])
       {
           max = k;
       }
       comparisons++;
       //Printarr(data,arrSize);
  }//end for

  if(min > mintemp)
  {
      swap(data[min], data[mintemp]);
  }
  comparisons++;

  if(max < maxtemp)
  {
      swap(data[max], data[maxtemp]);
  }
  comparisons++;

  //Printarr(data,arrSize);
  }//end outer for

  //cout<<GetCounter()<<endl;
  cout<<"number of comparisons in parallel DE selection sort: "<< comparisons<<endl;
} 
```

非常感谢所有回答的人。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-01T07:05:16.740

这是关于该主题的一个很好的教程：

[http://msdn.microsoft.com/en-us/magazine/cc163717.aspx](http://msdn.microsoft.com/en-us/magazine/cc163717.aspx)

我会建议一个

```
#pragma omp parallel for 
```

对于最外部的循环，然后

```
#pragma omp for 
```

对于嵌套循环。

但是，我现在没有要测试的 OpenMP 设置。

# node.js - Node.js Amazon S3 - 下载失败并出现 SignatureDoesNotMatch 错误

> ID：10392744
> 
> 赞同：1
> 
> 时间：2012-05-01T02:11:17.820
> 
> 标签：node.js, amazon-s3, download, knox-amazon-s3-client

这是我用来下载文件的代码

```
var S3_KEY = 'xxxxxx';
var S3_SECRET = 'xxxxxx';
var S3_BUCKET = 'xxxxxx';
var s3Client = require('knox').createClient({
    "key": S3_KEY,
    "secret": S3_SECRET,
    "bucket": S3_BUCKET
});

// Pull some stuff down
s3Client.get('myFile.zip').on( 'response', function(res){
    console.log( "\n" + res.statusCode );
    console.log( "\n" + res.headers + "\n" );
    res.setEncoding( 'utf8' );
    res.on('data', function( chunk ) {
        console.log( chunk );
    });
}).end(); 
```

我收到带有 SignatureDoesNotMatch 代码的 403 错误。我究竟做错了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-07T07:18:12.580

您可能想查看 AwsSum 库。它功能齐全并得到积极维护：

*   [https://github.com/appsattic/node-awssum/](https://github.com/appsattic/node-awssum/)

在 node-awssum-scripts 存储库中有一个从 S3 下载的示例，您可能会发现它很有用：

*   [https://github.com/appsattic/node-awssum-scripts/blob/master/bin/amazon-s3-download.js](https://github.com/appsattic/node-awssum-scripts/blob/master/bin/amazon-s3-download.js)

如果您需要任何帮助，请大声告诉我。免责声明：我是 Chilts，AwsSum 的作者。:)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-05T03:03:30.353

这似乎是诺克斯的一个问题。显然问题已经解决了，但是解决方案还没有拉入主项目。

看到这个线程：[https ://github.com/LearnBoost/knox/issues/56](https://github.com/LearnBoost/knox/issues/56)

我的解决方法是删除 knox 库并将此存储库克隆到我的 node_modules 文件夹中：[https ://github.com/domenic/knox.git](https://github.com/domenic/knox.git)

# css - 如何使用 Twitter Bootstrap 将菜单项行为更改为“悬停更改背景”？

> ID：10392747
> 
> 赞同：3
> 
> 时间：2012-05-01T02:11:56.620
> 
> 标签：css, xhtml, twitter-bootstrap

正如您在默认的 twitter 引导导航栏菜单上看到的那样，只有活动菜单项的背景与其他菜单项的背景不同。我想要的是当我在菜单项上时，我希望将背景更改为另一种颜色。最重要的是，当我悬停在菜单项上时，我应该扮演活跃的角色。我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-27T02:41:14.843

这里的每个人都错了，经过一些测试你会发现这个 CSS 可以改变菜单悬停。

```
.dropdown-menu li a:hover {background-color:red;} 
```

享受

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-01T02:17:07.613

您必须为该特定**页面**上的 li 添加内联样式或不同的 id，并根据自己的喜好对其进行样式设置。如果您无权访问，则必须使用 Jquery 进行。这是否回答你的问题。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-01T02:18:14.323

在你的 CSS 中：

```
.navbar .nav > a:hover {background-color:#f60;} 
```

我希望这会有所帮助，我对您的要求感到有些困惑。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-07T01:10:29.200

检查@martincho 的答案-它在更改蓝色悬停颜色方面对我有用：

不要改变`bootstrap.css`。创建另一个`css`文件，您可以在其中覆盖它。无论如何，该行是 4572：

```
.dropdown-menu li > a:hover, .dropdown-menu li > a:focus, .dropdown-submenu:hover > a 
```

设置`background-image`为无，并设置为`background-color`您想要的任何颜色。

# android - 在android中使用AsyncTask

> ID：10392755
> 
> 赞同：-2
> 
> 时间：2012-05-01T02:14:15.730
> 
> 标签：android, android-asynctask

我在做游戏。

我想创建一个图像隐藏 20 秒，然后它出现 5 秒。我想使用 AsyncTask 但我做不到。

请帮助我，谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-01T02:18:09.827

AsyncTask 将是实现这一目标的一种非常糟糕的方法。而是使用带有,或类似的[处理程序](http://developer.android.com/reference/android/os/Handler.html)...`postDelayed``sendMessageDelayed`

# regex - R：正则表达式在此语言环境中无效

> ID：10392756
> 
> 赞同：2
> 
> 时间：2012-05-01T02:14:35.743
> 
> 标签：regex, r, unicode, locale

我在 R 脚本中有以下正则表达式：

```
grepl("\xe9", "MY TEXT", fixed = FALSE, ignore.case = TRUE, perl = FALSE) 
```

我收到以下错误：

```
Error in grepl("\xe9", "MY TEXT", fixed = FALSE, ignore.case = TRUE,  : 
regular expression is invalid in this locale 
```

"\xe9" 是 "é" 的 unicode 表示，并按原样从文件中读取。

我怎样才能解决这个问题？此外，在 R 中是否有关于语言环境 wrt 正则表达式的有用资源？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-01T02:41:24.147

我不知道为什么@joran 不只是将其发布为答案：

```
grepl("\\xe9", c("MY TEXT", "é"), fixed = FALSE, ignore.case = TRUE, perl = FALSE)
#[1] FALSE  TRUE 
```

# html - HTML 和 CSS 的 IE9 问题

> ID：10392759
> 
> 赞同：-1
> 
> 时间：2012-05-01T02:15:24.387
> 
> 标签：html, css

我在使用 IE9 时遇到问题，并且我也假设为 8 及以下版本。下面是我的.CSS。它在 Chrome、Safari 和 FireFox 中完美运行。我试图避免为 IE 创建单独的 .CSS。抱歉，这是我第一次发帖，如果您需要更多信息，请告诉我。

```
body {
    font-family: Verdana, Arial, Helvetica, sans-serif;
    font-size: 0.8em;
    background-image: url('../images/white_side.jpg');
}
#container {
    width: 1280px;
    margin: 0 auto;
    margin-top: -10px;
    align: center;
}
#masthead {
    width: 100%; 
    height: 170px;
    background-image: url('../images/header.jpg');
    background-repeat: no-repeat;
}
#content {
    float: left;
    width: 100%;
    background-image: url('../images/background.jpg');
    background-repeat: no-repeat;
}
#footer {
    text-align: center;
    clear: both;
    width: 100%;
    padding-top: 5px;
    padding-bottom: 5px;
    border-top: 1px solid #a9a9a9;
    border-bottom: 1px solid #a9a9a9;
}
#footer p {
    color: #DD7500;
    margin-top: 5px;
}
#footer a {
    color: #DD7500;
    text-decoration: underline;
}
#footer a:hover {
    color: black;
    text-decoration: none;
}
#menu{
    float: left;
    list-style-type: none;
    margin-top: 95px;
    margin-left: -40px;
}
#home{
    float: left;
    list-style-type: none;
}
#post{
    float: left;
    list-style-type: none;

}
#input{
    float: left;
    list-style-type: none;
    margin-left: 100px;
    margin-top: 15px;
}
#search{
    width: 210px;
    -moz-border-radius:6px;
    -webkit-border-radius:6px;
    border-radius:6px;
}
#deals{
    float: left;
    list-style-type: none;
    margin-left: 90px;
}
#login{
    float: left;
    list-style-type: none;
}
#registrationul{
    float: right;
    list-style-type: none;
    margin-top: -20px;
}
#welcome{
    float: left;
    list-style-type: none;
}
#register{
    float: left;
    list-style-type: none;
}
#loginContainer {
    position:relative;
    float:right;
    font-size:12px;
}
#loginButton { 
    float:right;
    position:relative;
    z-index:30;
    cursor:pointer;
}
#loginButton img {
    color: white;
    font-size:24px; 
    background-image:url(../images/login.jpg) no-repeat ;
}
#loginButton:hover {
    background-image:url(../images/loginafter.jpg);
}
#loginBox {
    position:absolute;
    top: 70px;
    right: 0px;
    display:none;
    z-index:29;
}
#loginForm {
    width:248px; 
    -moz-border-radius:3px 0 3px 3px;
    margin-top:-1px;
    padding:6px;
}
#loginForm fieldset {
    margin:0 0 12px 0;
    display:block;
    border:0;
    padding:0;
}
fieldset#body {
    background-color: rgba(0,0,0,0.4);
    -moz-border-radius:3px;
    padding:10px 13px;
    margin:0;
}
#body label {
    color: white;
    margin:9px 0 0 0;
    display:block;
    float:left;
}
#loginForm #body fieldset label {
    display:block;
    float:none;
    margin:0 0 6px 0;
}
#loginForm input {
    width:92%;
    border:1px solid #899caa;
    border-radius:3px;
    -moz-border-radius:10px;
    color:#3a454d;
    font-weight:bold;
    padding:8px 8px;
    box-shadow:inset 0px 1px 3px #bbb;
    -webkit-box-shadow:inset 0px 1px 3px #bbb;
    -moz-box-shadow:inset 0px 1px 3px #bbb;
    font-size:12px;
}
#loginForm #login {
    width:auto;
    float:left;
    color:black;
    padding:7px 10px 8px 10px;
    box-shadow:none;
    -moz-box-shadow:none;
    -webkit-box-shadow:none;
    margin:0 12px 0 0;
    cursor:pointer;
    padding:7px 2px 8px 2px; /* IE7 Fix */
}
#loginForm span {
    background-color: rgba(0,0,0,0.4);
    text-align:center;
    display:block;
    padding:7px 0 4px 0;
}
#loginForm span a {
    color:white;
    font-size:12px;
}
#rightpannel{
    float: right;
    margin-top: 20px;
    margin-right: 20px;
    width: 600px;
    height: 350px;
    background: rgba(0, 0, 0, 0.5);
}
#bottompannel{
    margin-top: 400px;
    margin-left: 20px;
    width: 1240px;
    height: 200px;
    background: rgba(0, 0, 0, 0.5);
}
#leftpannel{
    float: left;
    margin-top: 20px;
    margin-left: 20px;
    width: 600px;
    height: 350px;
    background: rgba(0, 0, 0, 0.5);
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-01T03:30:50.220

你永远不会让 IE 尝试像其他更现代的浏览器那样运行而没有 doctype。现代网页需要文档类型，如果没有文档类型，您将处于怪癖模式。将此添加为您的第一行：`<!DOCTYPE html>`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-01T03:27:01.323

您忘记在导航菜单中清除浮动...

```
<ul id="registrationul">
  <li id="welcome"></li>
  <li id="register"><a id="userButton" href="register.php"><img onmouseout="hideIt(this, 'images/register_plain.jpg')" onmouseover="showIt(this, 'images/register_hover.jpg')" id="imageshow6" alt="" src="images/register_plain.jpg"><em></em></a></li>
</ul>
<div style="clear:both;"></div><!-- clears floated elements (in this case ul#menu and ul#registrationul) --> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-01T02:34:28.040

IE 解析器的容错性远不如 Webkit (Chrome / Safari) 或 Gecko (Firefox)。通过[验证服务](http://validator.w3.org/)运行您的代码。很有可能，您忘记在某处关闭标记会弄乱标记（我是根据个人经验说的）。

# magento - Magento：删除产品并 301 重定向到相关的现有页面，例如，它的父类别

> ID：10392760
> 
> 赞同：2
> 
> 时间：2012-05-01T02:15:41.640
> 
> 标签：magento

任何人都有针对 Magento 中已删除产品的 301 永久重定向的解决方案？

我有一家商店，有 5000 种产品。4000 件已售出，并且永远不会有库存。我想删除那些产品 b/c 我不再需要它们并想清理/减少我的数据库，但我需要 301 将它们永久重定向到适当的页面以保持我建立的 SEO 汁液。

需要明确的是，我不希望已删除的产品页面继续存在，即使出现缺货消息，我也不希望出现 404 Page Not Founds。

理想情况下，我将能够导出产品 URL 及其最低级别类别页面的 URL，以便我可以通过 .htaccess 文件创建 301 重定向。但是从 Magento 导出只导出类别 ID，而不是类别名称或 URL，那么我如何以编程方式获取这些？或者其他解决方案？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-01T04:00:29.217

我将创建一个利用观察者和 Magento 的 URL 重写管理器的插件。

此插件将观察在产品删除时`catalog_controller_product_delete`返回`array(’product’ ⇒ $product)`到观察者`$event`var 的事件 - 这将在删除时创建自动重定向。

您可以使用它来获取有关产品的最新详细信息，包括其 url，然后执行以下操作以插入 url 重写：

```
Mage::getModel('core/url_rewrite')
    ->setIsSystem(0)
    ->setStoreId($storeId)   
    ->setOptions('RP')  //301 redirect perm
    ->setTargetPath($product->getUrlPath() . '.html')
    ->setRequestPath($newpage->getUrlPath() . '.html')
    ->save(); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2015-02-11T14:08:55.760

以下解决方案仅适用于您的产品只有 1 个类别。此代码将在管理产品网格和管理产品视图中删除。

此代码将重定向到产品所在的类别。除非该类别删除后没有产品，否则它将使用产品类别的父类别。这会产生一个问题，因为许多重写仍将链接到没有产品的类别。如果这对您来说不是问题，请使用以下解决方案。

在 ./app/code/local/INPUTANAME/RewriteAfterDelete/etc/config.xml 放

```
<?xml version="1.0" encoding="UTF-8"?>
<config>
    <modules>
        <INPUTANAME_RewriteAfterDelete>
            <version>0.0.1</version>
        </INPUTANAME_RewriteAfterDelete>
    </modules>
    <global>
        <models>
            <inputaname_rewriteafterdelete>
                <class>INPUTANAME_RewriteAfterDelete_Model</class>
            </inputaname_rewriteafterdelete>
        </models>
        <events>
            <catalog_product_delete_after>
                <observers>
                    <inputaname_rewriteafterdelete>
                        <class>inputaname_rewriteafterdelete/observer</class>
                        <method>rewriteDelete</method>
                        <type>singleton</type>
                    </inputaname_rewriteafterdelete>
                </observers>
            </catalog_product_delete_after>
        </events>
    </global>
</config> 
```

在 ./app/code/local/INPUTANAME/RewriteAfterDelete/Model/Observer.php

```
 <?php
class BeoService_RewriteAfterDelete_Model_Observer
{
    public function rewriteDelete(Varien_Event_Observer $observer)
    {
        $product = $observer->getEvent()->getProduct();
        $storeId = Mage::app()->getStore()->getStoreId();
        $categoryIds = $product->getCategoryIds();
        if(count($categoryIds) ){
            $firstCategoryId = $categoryIds[0];
            $category = Mage::getModel('catalog/category')->load($firstCategoryId);
            if($category->getProductCount()){
                $newpage = $category->getUrlPath();
            }else{
                $newpage = $category->getParentCategory()->getUrlPath();
            }
            Mage::getModel('core/url_rewrite')
                ->setIsSystem(0)
                ->setStoreId($storeId)   
                ->setOptions('RP')  //301 redirect perm
                ->setTargetPath($newpage . '.html')
                ->setRequestPath($product->getUrlPath() . '.html')
                ->save(); 
        }
    }
} 
```

在 ./app/etc/modules/INPUTANAME_RewriteAfterDelete.xml

```
<?xml version="1.0" encoding="UTF-8"?>
<config>
    <modules>
        <INPUTANAME_RewriteAfterDelete>
            <version>0.0.1</version>
        </INPUTANAME_RewriteAfterDelete>
    </modules>
    <global>
        <models>
            <inputaname_rewriteafterdelete>
                <class>INPUTANAME_RewriteAfterDelete_Model</class>
            </inputaname_rewriteafterdelete>
        </models>
        <events>
            <catalog_product_delete_after>
                <observers>
                    <inputaname_rewriteafterdelete>
                        <class>inputaname_rewriteafterdelete/observer</class>
                        <method>rewriteDelete</method>
                        <type>singleton</type>
                    </inputaname_rewriteafterdelete>
                </observers>
            </catalog_product_delete_after>
        </events>
    </global>
</config> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-12-23T11:32:33.647

使用这个你只能重定向活动类别这个功能保留给所有的答案。希望任何人都可以帮助完成这个。

```
<?php
class Meet_RewriteAfterDelete_Model_Observer
{
    public function rewriteDelete(Varien_Event_Observer $observer)
    {
        $product = $observer->getEvent()->getProduct();
        $storeId = Mage::app()->getStore()->getStoreId();
        $categoryIds = $product->getCategoryIds();
        if(count($categoryIds) ){
            $categoryIds = $this->getActiveCategoryIds($categoryIds);
        }
        $requestPath = '';
        if($product->getUrlPath() != ""){
            $requestPath = $product->getUrlPath();
        }else{
            $requestPath = $product->getUrlKey();
        }
        if(count($categoryIds) ){
            $firstCategoryId = $categoryIds[0];
            $category = Mage::getModel('catalog/category')->load($firstCategoryId);
            if($category->getProductCount()){
                $newpage = $category->getUrlPath();
            }else{
                $newpage = $category->getParentCategory()->getUrlPath();
            }
            Mage::getModel('core/url_rewrite')
                ->setIsSystem(0)
                ->setStoreId($storeId)   
                ->setOptions('RP') 
                ->setTargetPath($newpage)
                ->setIdPath(uniqid(delete_))
                ->setRequestPath($requestPath)
                ->save(); 
        }else{
            Mage::getModel('core/url_rewrite')
                ->setIsSystem(0)
                ->setStoreId($storeId)   
                ->setOptions('RP') 
                ->setTargetPath('index.php')
                ->setIdPath(uniqid(delete_))
                ->setRequestPath($requestPath)
                ->save(); 
        }
    }

    protected function getActiveCategoryIds($catIds){
        $catCollection = Mage::getResourceModel('catalog/category_collection')
             ->addAttributeToSelect('entity_id')
             ->addAttributeToFilter('entity_id', $catIds)
             ->addIsActiveFilter();
        return $catCollection->getAllIds();
    }

} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2017-12-21T13:22:28.017

要获取您想要的数据，您可以简单地运行此查询

```
SELECT prod.request_path, cat.request_path FROM `core_url_rewrite` prod
LEFT JOIN core_url_rewrite cat ON prod.category_id = cat.category_id AND cat.id_path LIKE 'category/%'
WHERE prod.id_path LIKE 'product/%' AND prod.category_id IS NOT NULL 
```

注意向 .htaccess 添加大量静态重定向会减慢 apache。

# nsmutablearray - 将 NSData 转换为 NSArray 时遇到问题

> ID：10392761
> 
> 赞同：0
> 
> 时间：2012-05-01T02:15:52.530
> 
> 标签：nsmutablearray, nsarray, nsdata, nsmutabledata

```
(void) connection:(NSURLConnection )connection didReceiveData:(NSData )data
{
[self.receivedData appendData:data];

// convert data to array 
// ??? the below is not working
NSMutableArray *receivedDataAsArray = [NSPropertyListSerialization         
propertyListFromData:self.receivedData      
mutabilityOption:NSPropertyListImmutable format:nil errorDescription:nil];
} 
```

我使用上面的 NSURLConnection 来获取数据（序列化数组）。我想将其转换为 NSMutableArray。虽然上面没有返回错误，但它也没有返回填充的数组（尽管我肯定在接收数据）。关于如何将 NSData/NSMutableData 正确转换为 NSArray/NSMutableArray 的任何帮助？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-15T11:40:20.877

使用 NSKeyedArchiver 将对象归档为数据。

NSKeyedUnarchiver 用于从数据中取消归档对象：

```
NSArray *object = [NSKeyedUnarchiver unarchiveObjectWithFile:self.receivedData]; 
```

# android - Android View.OnKeyListener：点击一次，执行两次

> ID：10392764
> 
> 赞同：5
> 
> 时间：2012-05-01T02:16:06.653
> 
> 标签：android, view, listener, scrollview

> **可能重复：**
> [公共布尔 onKey() 调用了两次？](https://stackoverflow.com/questions/3802887/public-boolean-onkey-called-twice)

这是我的代码

```
public class TestKeyActivity extends Activity {

private int i=1;
private ScrollView sv;
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.main);

    sv=(ScrollView) this.findViewById(R.id.read_scrollView);

    sv.setOnKeyListener(new View.OnKeyListener() {

        @Override
        public boolean onKey(View v, int keyCode, KeyEvent event) {
            if (keyCode == KeyEvent.KEYCODE_DPAD_RIGHT) {

        Toast.makeText(TestKeyActivity.this, "what is wrong！！！！"+(i++), 2).show();
            return true;
            }
            return false;
        }
    });
    }
} 
```

我用的是他的Android模拟器和Eclipse，不知道为什么，但是当我点击一次键时，toast的代码会执行两次。我的代码有问题吗？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-05-01T02:23:53.000

我刚刚回答了一个非常相似的问题（[这里](https://stackoverflow.com/questions/10377049/unwilling-edittext-ontouchlistener-function-call/10377470#10377470)）。问题是您正在激活`KeyEvent.ACTION_DOWN`和`KeyEvent.ACTION_UP`。你应该只在以下情况下执行你的代码`KeyEvent.getAction() == KeyEvent.ACTION_UP`

# c++ - 加权有向图

> ID：10392765
> 
> 赞同：0
> 
> 时间：2012-05-01T02:16:12.233
> 
> 标签：c++, graph, directed-graph

我正在尝试在加权有向图上实现递归深度优先遍历（但似乎我的输出总是关闭。如，我正在对节点进行额外访问。这就是我目前正在使用的：

```
void Dfs( int u, vector<bool> visited, vector < char > label, vector < vector < int > > adj)
{
visited[u] = true;
cout << label[u];

for ( int i = 0; i < (signed)visited.size(); i++)
    {
    if (visited[i] != true && adj[u][i] != 0)
            {
            cout << "->";
            Dfs( i, visited, label, adj);
            }
    }

} 
```

其中 label 是分配给顶点的字母（A = 0 等），visited 是一个向量，用于保存某个索引处的顶点是否已被访问，adj 是邻接矩阵。

假设我有一个图表，正确的深度优先搜索是 A->D->B->C->E，我最终得到的是 A->D->B->C->E->C-> B->E。如果它有帮助，对于这个例子，邻接矩阵看起来像：

```
 |  A  B  C  D  E
--|---------------
A |  -  -  -  6  -
B |  -  -  8  3  2
C |  -  8  -  7  -
D |  6  3  7  -  -
E |  -  2  -  -  - 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-01T02:50:00.373

函数的参数是按值传递的；所以你`visited vector`没有得到更新。此外，对其他向量使用按引用传递，以便每个递归调用都不会复制向量。

# sql - 从 excel 导入日期或访问 SQL Developer？

> ID：10392768
> 
> 赞同：1
> 
> 时间：2012-05-01T02:16:20.633
> 
> 标签：sql, oracle, excel, date, import

我在 Excel 中有一个日期字段，我正在尝试将其导入 SQL 开发人员，但我要么收到有关格式的错误消息，要么日期值来自 excel 的原始形式。有人知道如何将 Excel 或 Access 中的日期导入 SQL Developer 吗？谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-01T04:56:05.430

Excel 以不同的方式存储日期。您可以在 sql developer Tools >Preferences >Database->NLS 中更改格式我认为您可以根据您的要求将格式更改为“DD-MON-RR HH.MI.SS”。 [http://www.jasonsdevelopercorner.com/?p=209](http://www.jasonsdevelopercorner.com/?p=209)

# oracle - 有没有比 Oracle SQL Developer 更好的工具？

> ID：10392771
> 
> 赞同：13
> 
> 时间：2012-05-01T02:17:11.687
> 
> 标签：oracle, ide, plsql, editor, oracle-sqldeveloper

我刚开始学习 Oracle SQL Developer，因为我在新工作中开发 PL/SQL 代码，虽然它是一个不错的工具，但它缺少使用不同 IDE 编写程序时所需的许多便利和功能（如 IDEA）。

与 Oracle 的 SQL 开发人员 3 相比，在构建 PL/SQL 代码的大型包/过程/功能时，是否有其他工具可以真正提供帮助？获得诸如代码完成之类的功能，或者能够按住 CTRL 键单击过程名称以快速跳转到一段代码，以及这种类型的其他不错的功能，会很棒吗？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-05-01T09:08:45.037

[AllroundAutomations 的PL/SQL Developer](http://www.allroundautomations.com/plsqldev.html)非常好。提供其他工具提供的所有基本功能。在调试存储过程、函数和触发器时非常好。但它也是一个许可版本。没有。可用的附加组件使工具更强大，您可以自定义您的 Plsql 开发人员，如以下链接所示。 [这里](http://www.williamrobertson.net/documents/plsqldeveloper-setup-1.html)和[这里](http://www.williamrobertson.net/documents/plsqldeveloper-setup-2.html)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-01T07:45:07.737

我认为 Oracle SQL Developer 可以开发 PL/SQL 代码，它是 Oracle 组织出品的免费软件，它可能缺少某些特定功能。但它满足大多数常见用法和功能。

Toad 是一个功能更强大的工具，应用非常广泛。但你需要获得许可证。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-05-03T11:19:18.370

PL/SQL 开发人员在几年前尝试过很有趣，但我总是发现自己在做大量的 DBA 类型的工作，但这并没有多大帮助。我的 DBA 技能不是特别强，所以在这方面，Toad 和 SQL Developer 肯定会领先。

总的来说，我更喜欢 Toad（尽管它可能会占用大量资源，并且让一切以您想要的方式工作可能会很痛苦）。有不同的版本（一个专门针对开发人员），所以其中一个可能适合您。

我最近开始了一份新工作，并决定试一试 SQL Developer（这主要是因为 Toad 足够昂贵，以至于有些地方不会在上面花钱……就像我上一份工作一样……所以它看起来像是选择一个我知道我到处都有的工具是个好主意）。它当然有它的问题（如果查询正在运行，它似乎很固执地断开连接......但它可能是 java 的事情），但它是免费的、轻量级的，并且可以完成工作。

关于 Toad 的说明：目前（可能在可预见的未来）严格来说是一个 32 位应用程序。它将在 64 位 Windows 机器上运行并连接到 64 位 Oracle 数据库，但 Oracle 客户端必须是 32 位

# maven - 如何使用 pom.xml 创建带有日期时间和版本的 ear 文件

> ID：10392773
> 
> 赞同：0
> 
> 时间：2012-05-01T02:17:17.317
> 
> 标签：maven, build

我有一个 Maven 项目和相应的 pom.xml 文件。它只是一个耳朵文件，它是用我的项目名称生成的。但我希望它使用 pom.xml 与 projectname_datetime.ear 文件动态。您能否给我一个静态示例，它将创建一个带有当前日期和时间的内部文件，其中包含 major_minor 或其他链接。

提前致谢。

尼莱什

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-01T07:48:57.820

请参阅此答案：[https](https://stackoverflow.com/a/2077869/116509) ://stackoverflow.com/a/2077869/116509 。您还需要添加

```
<build>      
    <finalName>${project.artifactId}-${project.version}-${maven.build.timestamp}
    </finalName> 
```

但是，您可能应该在开发过程中使用 -SNAPSHOT 版本号。如果您希望能够参考最终版本，您可以发布该版本。也可以参考特定的快照，请参阅[http://mojo.codehaus.org/versions-maven-plugin/examples/lock-snapshots.html](http://mojo.codehaus.org/versions-maven-plugin/examples/lock-snapshots.html)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-01T13:27:17.140

如果您正在使用`svn`源代码管理，Codehaus 的[buildnumber-maven-plugin](http://mojo.codehaus.org/buildnumber-maven-plugin/)可用于将 svn 修订号放入您构建的任何工件的清单中，包括快照。如果您需要，该插件也有格式化时间戳的目标。

# windows-8 - 如何实现 Metro 风格应用的 UI 自动化？

> ID：10392774
> 
> 赞同：15
> 
> 时间：2012-05-01T02:17:22.313
> 
> 标签：windows-8, windows-runtime, ui-automation

我已经下载并安装了 Windows 8 消费者预览版，我想弄清楚如何使用 UI 自动化 API 从 Metro 风格应用程序中获取数据。

背景：我有很多使用[Microsoft UI 自动化 API](http://msdn.microsoft.com/en-us/library/ms726294%28VS.85%29.aspx)与应用程序交互的自动化测试。这些脚本是用 IronRuby 针对 .NET 4 编写的

最初，我只想检查开始菜单是否可见（如果是，请关闭它）

[根据 Microsoft](http://blogs.msdn.com/b/b8/archive/2012/02/14/enabling-accessibility.aspx)的说法，普通的 UI 自动化 API 应该能够访问和控制 Metro 风格的应用程序，但问题是，我无法弄清楚我的代码如何真正访问 Metro 应用程序的 UI？我们查看 UI 自动化数据的正常方式是使用[UISpy](http://msdn.microsoft.com/en-us/library/ms727247.aspx)，但是当我在 Windows 8 下运行 UI spy 并启动 Metro 应用程序时，没有提及它......似乎 Metro 应用程序（包括开始屏幕）被围起来了从桌面关闭。

如果我在 UISpy 中找不到 Metro 应用程序，我如何才能找到它们的自动化 ID，以及如何从我的自动化测试脚本中找到它们？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-03T06:59:31.757

在 Metro 风格应用程序中工作的一些关于 UI 自动化的资源：

*   这是一个演示它的[示例。](http://code.msdn.microsoft.com/UI-Automation-Document-24a37c82)

*   这是一篇解释它的[博客文章。](http://blogs.msdn.com/b/winuiautomation/archive/2011/05/18/building-ui-automation-client-applications-in-c-and-c.aspx)

*   这是关于该主题的[论坛](http://social.msdn.microsoft.com/Forums/en-US/winappswithcsharp/thread/498588ae-51c0-43c9-8f31-e3d960f00297)主题。

    该应用程序并没有阻止传统 UI 自动化正常工作。您可能必须获得更新的工具才能查看 Metro 风格的应用程序。有些附带消费者预览版。寻找inspect.exe。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-05-10T05:47:39.793

UI 自动化工具可以自动化 Metro 应用程序。例如，检查[RIATest](http://www.cogitek.com/riatest/features/technologies/windows.html)。

从 6.0 版开始，RIATest 中的一些特性专门针对 Metro 风格的应用程序自动化，特别是：

*   能够始终掌握 Metro UI，让您可以同时查看 Metro 应用程序和 RIATest IDE，并在自动化 Metro 应用程序时最大限度地减少从桌面到 Metro 屏幕的切换。

*   记录在本机 Windows GUI 元素（包括 Metro GUI）上执行的操作。记录器分析您的脚本代码并重用您的变量名称以生成更清晰的记录脚本，类似于您手动编写自动化脚本的方式。

*   Metro UI 中 Windows UI 自动化实施中[此类错误](https://connect.microsoft.com/VisualStudio/feedback/details/779279/ui-automation-tree-is-broken-for-windows-8-store-application)的无缝解决方法。

*免责声明：我在 RIATest 公司 Cogitek 工作。*

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-02T04:00:37.713

WinRT（又名“Metro Style”）应用程序在沙箱中运行。您无法穿透应用程序之间的墙，包括桌面应用程序。这包括网络隔离（例如，除非在开发环境中，否则您不能引用本地主机）。有几个例外，例如共享和搜索联系人，它们允许应用程序之间进行非常特定类型的交互。

正是这个沙盒阻止了 UISpy 在后台看到正在执行的 WinRT 应用程序。我不确定 UISpy 如何在没有消费者预览版中不可用的沙盒的某种开发环境异常（类似于网络隔离异常）的情况下解决此问题。

我也不知道有关此时/是否支持 WinRT 应用程序的 UI 自动化 API 的任何公告。

# sql - JBoss AS 7.1 上的非 jta 数据源连接

> ID：10392775
> 
> 赞同：0
> 
> 时间：2012-05-01T02:17:46.837
> 
> 标签：sql, jboss, connection, persistence

嗨，我是 Jboss:D 的新宝宝。
这个错误几天让我头疼。

> javax.persistence.PersistenceException: 异常 [EclipseLink-4003] (Eclipse Persistence Services - 2.3.1.v20111018-r10243): org.eclipse.persistence.exceptions.DatabaseException 异常描述：配置错误。找不到类 [com.microsoft.jdbc.sqlserver.SQLServerDriver]。

我的 JBoss Standalone.xml 驱动程序标签：

```
<driver name="MSSQLXA" module="com.microsoft.sqlserver">    <xa-datasource-class>com.microsoft.sqlserver.jdbc.SQLServerXADataSource</xa-datasource-class></driver> 
```

我的应用程序persistence.xml：

```
<persistence-unit name="Entities" transaction-type="RESOURCE_LOCAL">
<provider>org.eclipse.persistence.jpa.PersistenceProvider</provider>
<property name="eclipselink.ddl-generation"
            value="drop-and-create-tables"/>
  <property name="eclipselink.ddl-generation.output-mode" value="database"/>
  <property name="javax.persistence.jdbc.driver"
            value="com.microsoft.jdbc.sqlserver.SQLServerDriver"/>
  <property name="javax.persistence.jdbc.url"
            value="jdbc:sqlserver://192.168.100.5:1433;databaseName=ADiamond;"/>
  <property name="javax.persistence.jdbc.user" value="sa"/>
  <property name="javax.persistence.jdbc.password"
            value="diamond"/>
  <property name="eclipselink.jdbc.exclusive-connection.mode"
            value="Transactional"/>
  <property name="eclipselink.cache.shared.default" value="false"/>
  <property name="javax.persistence.cache.storeMode" value="REFRESH"/>
</properties> 
```

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-01T13:26:42.803

抛出一个错误，指出找不到 JDBC 驱动程序类。下载[SQL Server JDBC 驱动程序](http://www.microsoft.com/en-us/download/details.aspx?id=2505)并复制到`<JBOSS_HOME>\common\lib`文件夹并检查您的程序。

# c# - 我将控制台应用程序重新制作为 WinForm 应用程序。我现在无法从另一个控制台应用程序获取输出

> ID：10392776
> 
> 赞同：1
> 
> 时间：2012-05-01T02:17:53.003
> 
> 标签：c#, winforms, console

我有 C# 控制台应用程序，它运行另一个 Borland C 控制台应用程序。它工作正常。但是在我将第一个应用程序重新制作为 WinForm 应用程序后，我无法从 Borland C 控制台应用程序获得输出。

代码在这里：

```
Process p = new Process();    
p.StartInfo.CreateNoWindow = true;    
p.StartInfo.UseShellExecute = false;    
p.StartInfo.RedirectStandardError = true;    
p.StartInfo.RedirectStandardOutput = true;    
p.StartInfo.FileName = name1;    
p.Start();    
StreamReader sr = p.StandardOutput;    
progOutput = sr.ReadToEnd();    
//progOutput = p.StandardOutput.ReadToEnd();    
p.WaitForExit(); 
```

字符串`progOutput`为空。如果我使用 line `progOutput = p.StandardOutput.ReadToEnd();`而不是，我会得到相同的结果`StreamReader`

Borland C 控制台应用程序真正启动并正常创建了它的输出文件。
但它的输出在 WinForm 应用程序中消失了。正如我所说，这段代码在 C# 控制台应用程序中运行良好，但现在在 C# Windows 窗体应用程序中不起作用。

顺便说一句，如果我在 WinForm 应用程序中运行 C# 控制台应用程序，输出就可以了。Borland C 输出有问题？但是当我在 C# 控制台应用程序中运行 Borland C 应用程序时它起作用了。所以我很困惑。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-01T02:54:14.677

在某些情况下，我发现像这样间接启动可执行文件是有益的。

```
p.StartInfo.FileName = "cmd";
p.StartInfo.Arguments = "/C " + name1; 
```

..尤其是在出现输出重定向问题时。但是您说它可以用作控制台应用程序？！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-01T02:53:29.537

查看

```
var errorOut = p.StandardError.ReadToEnd(); 
```

你可能会得到标准错误的输出。您可以找到许多与此相关的问题，我们期望来自 StandardOutput 的输出，但它重定向到 StandardError。

# python - 参数值的变化 - web2py 应用程序

> ID：10392783
> 
> 赞同：1
> 
> 时间：2012-05-01T02:18:20.250
> 
> 标签：python, web2py

我是 web2py 的新手，正在尝试一个应用程序。`controller`相关功能及对应相关请见下文`views`。我首先将我的浏览器指向`http://127.0.0.1:8000/test/default/index`，然后我关注应用程序。我经历过，对我来说似乎很奇怪的事情：有时（不总是，大约每 5-6 次）页面上显示的 MC 和 maxWTP 的值在第一次输入价格**后**`http://127.0.0.1:8000/test/default/inandout`会发生变化。我想要做的是当一个人去的时候应该随机选择 MC 和 maxWTP ，这些被用来创建一个市场对象；但不是在那之后。一旦页面被重定向到**`http://127.0.0.1:8000/test/default/index``http://127.0.0.1:8000/test/default/inandout`我不明白为什么在输入价格后 MC 和 maxWTP 应该改变。此外，它似乎只发生在第一次输入价格之后。有人可以向我解释为什么会发生这种情况以及如何纠正吗？我正在使用 Chrome 浏览器和 web2py 和 python 2.7 的版本 1.99.7 (2012-03-04 22:12:08)。**

 **我不认为原因在于市场模块。但是，如果您想查看市场模块和它所依赖的其他模块，请告诉我。

**控制器功能**

```
import random
import market

def index():
    '''Creates a new market object and resets the price, quantity
    and profit histories'''
    session.marketobject = None
    mc = random.choice([1,1.2,1.3,1.4,1.5,1.6,1.7,1.8,1.9,2])
    maxWTP = random.choice([4,5,6,7])
    session.marketobject = market.Market(mc,maxWTP)
    session.priceHistory = []
    session.profitHistory = []
    session.quantityHistory = []
    redirect(URL('inandout'), 303)

def second():
    if request.vars.price:
        price = float(request.vars.price)
        # use the price to calculate profit and qsold
        currentprice, qsold, profit = session.marketobject.calculate_qsold_profit(price)
        # add the result to the history of prices, profits and qsold
        session.priceHistory.append(currentprice)
        session.profitHistory.append(profit)
        session.quantityHistory.append(qsold)
    redirect(URL('inandout'), 303)

def inandout():
    capacity = session.marketobject.K
    populationsize = session.marketobject.N
    mc = session.marketobject.MC
    maxWTP = session.marketobject.maxWTP    
    return dict(capacity=capacity, populationsize=populationsize,
                mc=mc, maxWTP=maxWTP, 
                priceHistory=session.priceHistory,
                profitHistory=session.profitHistory, 
                quantityHistory=session.quantityHistory) 
```

**看法：`inandout.html`**

```
<html>
<head>
    <title>First page</title>
      <link rel="stylesheet" href="{{=URL('static', 'css/testapp.css')}}">
</head>
<body>

  <h2>Seller capacity: {{=capacity}}</h2>
  <h2>Population size: {{=populationsize}}</h2>  
  <h2>MC: {{=mc}}</h2>
  <h2>Maximum WTP: {{=maxWTP}}</h2>

  <form action="second">
    Enter price: <input type="text" name="price">
    <input type="submit">
  </form>

  <table>
      {{for count in range(len(priceHistory)):}}
            <tr>
                <td>{{=priceHistory[count]}}</td>
                <td>{{=quantityHistory[count]}}</td>
                <td>{{=profitHistory[count]}}</td>
            </tr>
      {{pass}} 
  </table>
</body>
</html> 
```

**市场、消费者和业务模块**

```
#!/usr/bin/env python
# coding: utf8
import consumers
import business

class Market(object):

    def __init__(self, MC, maxWTP, N=30000, minWTP=0, 
                 FC=0, K=10000, numDecisions=3):
        self.numDecisions = numDecisions 
        self.K = K
        self.N = N
        self.MC = MC
        self.maxWTP = maxWTP

        self.consumerClass = consumers.AllConsumers(N, minWTP, maxWTP)
        self.seller = business.Seller(FC, MC, K)

    def calculate_qsold_profit(self, price):
        currentprice = price
        qtydemanded = self.consumerClass.qtyDemanded(currentprice)
        calculate_qsold_profit = \
                    self.seller.calculate_qsold_profit(currentprice,
                                                        qtydemanded)                                                   
        qSold = calculate_qsold_profit[0]
        profit = calculate_qsold_profit[1]

        return (currentprice, qSold,profit,) 
```

**消费者.py**

```
#!/usr/bin/env python
# coding: utf8

import random

##=====================================================================
# Create the class that creates all consumers
##=====================================================================

class AllConsumers(object):

    def __init__(self, N, minWTP, maxWTP):
        self.N = N
        self.minWTP = minWTP
        self.maxWTP = maxWTP
        self.listOfWTPs = sorted([random.uniform(minWTP,maxWTP) \
                                        for x in range(N)], reverse=True)

    def qtyDemanded(self, price):
        count = 0
        for wtp in self.listOfWTPs:
                if wtp >= price:
                    count += 1
                else:
                    break
        return count 
```

**业务.py**

```
#!/usr/bin/env python
# coding: utf8

##=====================================================================
# Create a seller class 
##=====================================================================

class Seller(object):

    def __init__(self, FC, MC, K):
        self.FC = FC
        self.MC = MC
        self.K = K

    def calculate_qsold_profit(self, price, qtydemanded):
        # choose minimum of quantity demanded and capacity
        # create a vector of monthly capacity (same element repeated 12 times)
        qsold = min(qtydemanded,self.K)

        # Calculate the profit vector
        profit = ((price - self.MC) * qsold) - self.FC 

        return (qsold, profit) 
```**

# php - 相同的数组值不相等？

> ID：10392785
> 
> 赞同：0
> 
> 时间：2012-05-01T02:18:46.083
> 
> 标签：php, arrays, matching

```
<?php
$bigArray = array(
    array('John','2012-03-29',1),
    array('Doe','2012-03-30',1),
    array('John','2012-03-31',2),
    array('Doe','2012-03-31',5),
    array('Tom','2012-03-31',5),
    array('John','2012-04-02',5),
    array('John','2012-04-02',21),
    array('John','2012-03-07',21)
);

$cache = array();
foreach ($bigArray as $v) {
    if (isset($cache[$v[1]])) {
        if ($cache[$v[1][1]] == $v[2]) {
            echo "Equal";
            $cache[$v[1]] = array($v[0].','.$cache[$v[1]][0], $v[2]);//append user to same value
        }
        else if ($cache[$v[1][1]] < $v[2]) {
            echo "Replacing value! ".$cache[$v[1]][0]. " to " .$v[0]."<br/>";
            $cache[$v[1]] = array($v[0], $v[2]);
        }
    } else {
        $cache[$v[1]] = array($v[0], $v[2]);
    }
}

print_r($cache);
?> 
```

此脚本查找特定日期的最大值并将其保存到新数组`$cache`

但是，当检查同一日期的最高值是否相等时，它返回 false？

```
array(
    array('Doe','2012-03-31',5),
    array('Tom','2012-03-31',5),
) 
```

数组中的上述内容让我感到困惑。不应该算比赛吗？

输出：

```
Replacing value! John to Doe
Replacing value! Doe to Tom
Replacing value! John to John
Array
(
    [2012-03-29] => Array
    (
        [0] => John
        [1] => 1
    )
    [2012-03-30] => Array
        (
        [0] => Doe
        [1] => 1
    )
    [2012-03-31] => Array
    (
        [0] => Tom
        [1] => 5
    )
    [2012-04-02] => Array
    (
        [0] => John
        [1] => 21
    )
    [2012-03-07] => Array
    (
        [0] => John
        [1] => 21
    )
) 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-01T02:26:20.290

没有过多的细节，`$v[1][1]`对我来说似乎很荒谬。它指的是原始数组中日期字符串的第二个字符。你可能的意思是：

```
$cache[$v[1]][1] 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-01T02:27:25.513

我会在这里猜测，但也许不是：

```
$cache[$v[1][1]] 
```

你应该写：

```
$cache[$v[1]][1] 
```

大括号略有不同:)

# php - 如何从 jQuery 提交表单并导航到页面？

> ID：10392787
> 
> 赞同：0
> 
> 时间：2012-05-01T02:18:49.350
> 
> 标签：php, jquery

我有两个 php 页面。第 1 页包含我使用 jQuery 提交的一个表单。第2页是表单查询页面。我想通过导航从第 1 页提交后从第 2 页读取所有数据。我的以下代码无法按预期工作。

第 1 页：

```
$.ajax({
type: "POST",
url: "requestProcessor.php",
data: "fname="+ fname +"&amp; lname="+ lname,
success: function(){

window.location.href = "requestProcessor.php";

}
}); 
```

第 2 页：requestProcessor.php

```
<?php
require("db/phpsql_info.php");

echo htmlspecialchars(trim($_POST['fname']));
echo htmlspecialchars(trim($_POST['lname']));
?> 
```

提前致谢..

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-01T02:25:17.977

首先，将您的数据参数更改为：

```
data: { fname: fname, lname: lname } 
```

它更具可读性。

第二，你在做什么没有意义。您将数据发布到 requestProcessor.php，然后将用户发送到 requestProcessor.php（然后是 GET）。这当然会丢失之前的所有 POST 数据，因为它相当于在 URL 栏中键入 requestProcessor.php。

如果您想从第 1 页转到第 2 页并查看已发布的数据，则只需将第 1 页上的表单直接提交到 requestProcessor.php。

否则，如果您想在 POST 之后显示第 2 页的结果，则将响应发送到当前页面上的某个 div。

```
success: function(response) {
    $("#some-div").html(response);
} 
```

如果我说实话，不确定你想要达到什么目标。

# ruby - rvm get latest 抛出错误

> ID：10392788
> 
> 赞同：1
> 
> 时间：2012-05-01T02:19:06.263
> 
> 标签：ruby, osx-snow-leopard, rvm

尝试在我的 OSx 上升级 RVM。我收到以下错误。

```
$ rvm get latest

Original installed RVM version:

rvm 1.2.9 by Wayne E. Seguin (wayneeseguin@gmail.com) [http://rvm.beginrescueend.com/]

rvm-<html>
% Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
                             Dload  Upload   Total   Spent    Left  Speed
100   172    0   172    0     0    210      0 --:--:-- --:--:-- --:--:--   304
ERROR:
.tar.gz downloaded does not match it's md5 checksum <html>
<head><title>400 Bad Request</title></head>
<body bgcolor="white">
<center><h1>400 Bad Request</h1></center>
<hr><center>nginx/1.0.8</center>
</body>
./html>
Aborting RVM Installation. 
```

有什么问题？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-01T02:51:13.830

尝试：

```
rvm get head
rvm reload
rvm get stable 
```

如果 `rvm get head 失败，请改用安装程序：

```
curl -L get.rvm.io | bash -s stable
rvm reload 
```

这`rvm reload`很重要，之前需要它，但现在 RVM 将自动重新加载。

另请注意，围绕`1.4`RVM 更改了`.rvmrc`信任机制，您将不得不再次信任所有项目......或使用不需要信任的新项目文件：[https ://rvm.io/workflow/projects/#ruby-versions](https://rvm.io/workflow/projects/#ruby-versions)

# emacs - 在组织模式下归档所有过去的日历项目？

> ID：10392791
> 
> 赞同：6
> 
> 时间：2012-05-01T02:19:26.040
> 
> 标签：emacs, elisp, org-mode

我开始沉迷于 Org 模式，尤其是日历项（也称为时间戳项）和 TODO 在项目树中都是同等级别的公民的方式。随着时间的推移，这些日历项目中的许多都会成为过去。

我喜欢一个单独的键绑定，它可以自动存档已经发生的任何时间戳/日历项目（nb：不是计划项目或截止项目，最好只有*没有*TODO 类型的事情）。

在 Org 模式中是否已经有类似的东西可用？谁能指出我如何写类似的东西`org-archive-past-items-in-buffer`？（我的 elisp 技能很弱。）谢谢！

（编辑：我应该注意，我的意思是存档文件意义上的存档`C-c $`，而不是存档标签/兄弟姐妹`C-c C-x a`或存档意义上的存档`C-c C-x A`。）

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-01T07:21:20.653

我会像这样创建一个新的议程自定义条目：

```
(setq org-agenda-custom-commands
  '(("P" ((tags "TIMESTAMP<=\"<now>\""))))) 
```

然后`C-c a P % . RET $`将归档结果议程视图中的所有项目（假设`C-c a`绑定到 `org-agenda'。）

相关且互补，`C-c / b RET`将创建一个稀疏树，其中包含今天（或您以交互方式输入的日期）之前的计划和截止日期项目。然后您可以使用`C-c C-n`（或者`n`如果 `org-use-speed-commands ' 是非零）并存档条目。

# linux - linux kernel 3.2中pthread是如何实现的？

> ID：10392800
> 
> 赞同：18
> 
> 时间：2012-05-01T02:20:53.497
> 
> 标签：linux, pthreads

全部，

下面的代码来自“Unix环境中的高级编程”，它创建一个新线程，并打印主线程和新线程的进程ID和线程ID。

书中说，在linux中，这段代码的输出会显示两个线程有​​不同的进程id，因为pthread使用轻量级进程来模拟线程。但是当我在 Ubuntu 12.04 中运行此代码时，它具有内核 3.2，打印了相同的 pid。

那么，新的 linux 内核是否改变了 pthread 的内部实现？

```
#include "apue.h"
#include <pthread.h>

pthread_t ntid;

void printids(const char *s) {
  pid_t     pid;
  pthread_t tid;
  pid = getpid();
  tid = pthread_self();
  printf("%s pid %u tid %u (0x%x)\n",
         s, (unsigned int)pid, (unsigned int)tid, (unsigned int)tid);
}

void *thread_fn(void* arg) {
  printids("new thread: ");
  return (void *)0;
}

int main(void) {
  int err;
  err = pthread_create(&ntid, NULL, thread_fn, NULL);
  if (err != 0)
    err_quit("can't create thread: %s\n", strerror(err));
  printids("main thread: ");
  sleep(1);
  return 0;
} 
```

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2012-05-01T02:49:24.797

在 Linux 上`pthread`使用`clone`带有特殊标志的系统调用`CLONE_THREAD`。

请参阅系统调用的[文档](http://linux.die.net/man/2/clone)。`clone`

> CLONE_THREAD（从 Linux 2.4.0-test8 开始）
> 
> 如果设置了 CLONE_THREAD，则子进程与调用进程位于同一线程组中。为了使 CLONE_THREAD 讨论的其余部分更具可读性，术语“线程”用于指代线程组中的进程。
> 
> 线程组是 Linux 2.4 中添加的一项功能，用于支持**共享单个 PID**的一组线程的 POSIX 线程概念。在内部，这个共享的 PID 是线程组的所谓线程组标识符 (TGID)。从 Linux 2.4 开始，调用 getpid(2) 返回调用者的 TGID。

事实上，Linux 确实[改变了它的线程实现](http://www.kernel.org/doc/man-pages/online/pages/man3/pthread_create.3.html)，因为[POSIX.1 要求](http://www.kernel.org/doc/man-pages/online/pages/man7/pthreads.7.html)线程共享相同的进程 ID。

> ```
>  In the obsolete LinuxThreads implementation, each of the threads in a process
>    has a different process ID.  This is in violation of the POSIX threads
>    specification, and is the source of many other nonconformances to the
>    standard; see pthreads(7). 
> ```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-06-29T02:00:05.073

Linux 通常使用 pthread 的两种实现：[LinuxThreads](http://en.wikipedia.org/wiki/LinuxThreads)和[Native POSIX Thread Library(NPTL)](http://en.wikipedia.org/wiki/Native_POSIX_Thread_Library)，尽管前者在很大程度上已经过时。2.6 的内核提供了 NPTL，它提供了更接近 SUSv3 的一致性，并且性能更好，尤其是在有很多线程时。
可以使用命令查询shell下pthreads的具体实现：

`getconf GNU_LIBPTHREAD_VERSION`

[您还可以在The Linux Programming Interface](http://man7.org/tlpi/)中获得更详细的实现差异。

# jquery - 根据事件 jquery 启用和禁用链接

> ID：10392802
> 
> 赞同：0
> 
> 时间：2012-05-01T02:21:00.553
> 
> 标签：jquery, events

我在页面上有一个链接，我想在页面加载时禁用该链接，当用户单击单选按钮时，我想启用该链接。我该怎么做。

```
<a href="go.html" id="goTo">Add</a>

<input type="radio" id="enableLink" name="selection" onclick=""> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-01T02:29:05.380

```
 <span id="add_link">Add</span>

    $('#enableLink').live('click', function() {
       $('#add_link').html('<a href="go.html" id="goTo">Add</a>');
    }); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-01T02:33:23.987

```
$(function(){
    var isEnabled=false;    
    $("#goTo").click(function(e){
       if(!isEnabled)
       {
          e.preventDefault();
       }       
    });        
    $("#enableLink").click(function(){
        isEnabled=true;        
    });
}); 
```

示例：http: [//jsfiddle.net/HyKL9/2/](http://jsfiddle.net/HyKL9/2/)

# jquery - 如果在所有页面 HTML 之后加载 jQuery 脚本，它们是否仍然需要 $(document).ready？

> ID：10392803
> 
> 赞同：19
> 
> 时间：2012-05-01T02:21:10.777
> 
> 标签：jquery, performance, footer

如果我在所有页面 HTML 下方加载我的 jQuery 脚本，我是否还需要等待`$(document).ready`能够使用 jQuery 来查找页面中的元素？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-01T02:30:35.190

否，因为文档已经被加载。Dom 从上到下加载。我个人喜欢把我所有的 js 放在页面底部而不是头部。

但是它只是 1 行代码，我建议使用它只是为了安全。你也可以让它更短。`$(function() {}`是相同的`$(document).ready(function(){})`

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-05-01T02:27:59.047

不，如果脚本放置在这些元素下方，则不需要`$(document).ready`任何与页面上的 DOM 元素交互的代码。

将它们放在结束`</body>`标记之前是一个好习惯。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-01T02:27:30.290

您*不需要*使用 jQuery 的`ready`函数，但您的代码必须牢记这一点。任何`click`或其他基于绑定的处理程序可能无法正确附加到选择器，但是，其他人喜欢`live`并且`$.ajax`可能按预期运行。

使用脚本加载器或 AMD 使用此方法时要小心。jQuery*必须*可用并且加载时必须阻塞。在 head 中加载 jQuery 和其他部门。

很好地看一下这种技术，它描述了这对于 jQuery 的功能来说不是必需的（不一定关于在页脚中的使用）：

[http://encosia.com/dont-let-jquerys-document-ready-slow-you-down/](http://encosia.com/dont-let-jquerys-document-ready-slow-you-down/)

# php - Symfony2 Twig 迭代器

> ID：10392806
> 
> 赞同：2
> 
> 时间：2012-05-01T02:21:59.117
> 
> 标签：php, symfony

我有表单 $form，每个实体**User**都有文本字段。

```
 $form = $this->createFormBuilder();
    $form->add('users', 'collection');
    foreach ($query->getResult() as $user)
    {            
        $form->get('users')->add($user->getName(), 'text', array('data' => $user->getName()));
    } 
```

我需要通过其 ID 号访问特定的输入表单。所以我必须能够做这样的事情：

```
{{ form_widget(form.users[0]) }} 
```

但它不起作用。我不能使用这个：

```
{% for user in form.users %} 
```

我需要通过他们的 id 来访问文本字段

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-01T03:07:54.257

找到了解决方案。

```
{% set interator = form.users.iterator %}
{{ interator.seek(0) }}
{{ form_widget(interator.current) }} 
```

# powershell - 应该在 Powershell 中使用什么异常类型来捕获由于无效字符导致的 XML 解析错误？

> ID：10392807
> 
> 赞同：6
> 
> 时间：2012-05-01T02:22:12.437
> 
> 标签：powershell, exception-handling, xml-parsing, powershell-2.0

下面脚本中的第 2 行生成 -

> “无法将值“System.Object[]”转换为类型“System.Xml.XmlDocument”。错误：“'→'，十六进制值 0x1A，是无效字符。第 39 行，第 23 位。”
> 
> 在 line:1 char:8 + [xml]$x <<<< = Get-Content 4517.xml + CategoryInfo : MetadataError: (:) [], ArgumentTransformationMetadataException + FullyQualifiedErrorId : RuntimeException"

应该在（脚本的）第 4 行指定什么异常来捕获上述错误？

```
try {
    [xml]$xml = Get-Content $file # line 2
}
catch [?] {                       # line 4
    echo "XML parse error!"
    # handle the parse error differently
}
catch {
    echo $error
    # some general error
} 
```

感谢您的关注（和回答）

阿德里安

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-03T04:03:00.083

这是一种发现异常的完整类型名称的方法，这里的结果给出了@Adrian Wright 给出的 System.Management.Automation.ArgumentTransformationMetadataException。

```
Clear-Host
try {
    [xml]$xml = Get-Content "c:\Temp\1.cs" # line 2
}
catch {
    # Discovering the full type name of an exception
    Write-Host $_.Exception.gettype().fullName
    Write-Host $_.Exception.message
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-01T19:49:46.563

System.Management.Automation.ArgumentTransformationMetadataException

# php - 导致解析 WSDL 的 API：无法从

> ID：10392808
> 
> 赞同：2
> 
> 时间：2012-05-01T02:22:14.060
> 
> 标签：php, soap, wsdl, fatal-error

我已经在这工作了 12 个小时的大部分时间。我不断收到连接问题。这是一个非 https 请求，尽管我尝试启用 open_ssl.dll 和其他建议。

我可以在浏览器中很好地查看 WSDL [http://www.soapclient.com/interop/interopTest.html](http://www.soapclient.com/interop/interopTest.html)也为我返回值。

我的代码：

```
<?php

function doWebService()
{
       ########################################################################
       # Do some SOAP / Call a Web Service
    $soap_url = 'http://WEBSITE/WebServices/PublicAPI.asmx?WSDL';
    //$soap_url = 'x.x.x.x/WebServices/PublicAPI.asmx?WSDL';

       $sh_param = array(
                'username' => 'admin_username',
                'password' => 'admin_password');

        $soap_client = new SoapClient($soap_url);

        $test = $soap_client->Authenticate($sh_param);

        echo $test . "\nDone";
    /*
    try
{
    $soap_url = 'http://WEBSITE/WebServices/PublicAPI.asmx?WSDL';
    //$soap_url = 'x.x.x.x/WebServices/PublicAPI.asmx?WSDL';

       $sh_param = array(
                'username' => 'admin_username',
                'password' => 'admin_password');

        $soap_client = new SoapClient($soap_url);

        $test = $soap_client->Authenticate($sh_param);

        echo $test . "\nDone";
    }
catch (Exception $e)
{
   echo "<pre>";
   print_r($e);
   echo "</pre>";
   exit;
}
*/
}

doWebService();
?> 
```

它在 $soap_client = new SoapClient($soap_url) 行上失败。我尝试在 PHP 4.0、5.2、5.3 之间进行更改。5.4 和 6.0。没有帮助。我试过启用

```
extension=php_curl.dll
extension=php_openssl.dll
extension=php_soap.dll 
```

这是在我的网站上使用主机：ntchosting.com

试图访问另一个 API。

实际错误代码

```
Fatal error: Uncaught SoapFault exception: [WSDL] SOAP-ERROR: Parsing WSDL: Couldn't load from 'http://WEBSITE.com/WebServices/PublicAPI.asmx?WSDL' : failed to load external entity "http://WEBSITE.com/WebServices/PublicAPI.asmx?WSDL" in /home/www/MY_WEBSITE.com/main_php/_test_public_api.php:13 Stack trace: #0 /home/www/MY_WEBSITE.com/main_php/_test_public_api.php(13): SoapClient->SoapClient('http://WEBSITE...') #1 /home/www/MY_WEBSITE.com/main_php/_test_public_api.php(50): doWebService() #2 {main} thrown in /home/www/MY_WEBSITE.com/main_php/_test_public_api.php on line 13 
```

我想要做的就是能够使用 API 来检索数据并在我所拥有的和另一个已建立的软件之间提供同步。每当我尝试弄湿双手时，似乎都不是一件容易的事。

谢谢，jc

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-02T19:46:56.963

我设法发现出站连接被阻止了。将 IP 强制列入允许列表，情况会好一些。

# iphone - object-c 中的浅拷贝和深拷贝

> ID：10392809
> 
> 赞同：0
> 
> 时间：2012-05-01T02:22:14.513
> 
> 标签：iphone, objective-c

我对objective-c中的“复制”有疑问，我在Car.m中的功能是这样的：

```
 - (id) copyWithZone: (NSZone *) zone
 {
    Car *carCopy;
    carCopy = [[[self class] allocWithZone: zone] init];

    carCopy.name = self.name;  //not  [name copy]

    return (carCopy);

 } // copyWithZone 
```

在 main.m 中：

```
 Car *car = [[Car alloc] init];
    car.name = @"abc";

    Car *copyCar = [car copy];

    [copyCar print];

    car.name = @"123";

    [copyCar print]; 
```

对于属性名称，我认为 car 和 copyCar 都指向同一个 NSString 对象，因此当我执行 "car.name = @"123" " 时，copyCar.name 也应该更改。但是当我在代码中两次打印 copyCar 时，它们都将名称打印为“abc”。我想知道为什么它不是浅拷贝？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-01T02:28:41.197

两件事情：

1）他们可能都开始指向同一个NSString，但是当你这样做时`car.name = @"123"`，你现在在`car.name`其他地方指出。您正在更改指针，而不是它指向的对象，并且更改指针 in`car`不会影响`copyCar`. 如果你（假设）做了类似的事情`[car.name appendString:@"xxx"]`，*那*会改变对象。但是，你不能，因为

2) `NSString`s 是不可变的——一旦创建了 NSString 对象，就无法更改它

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-01T02:25:29.317

您没有改变`name`属性的字符串。你直接换掉。因为`car`和`copyCar`实际上不是同一个对象，所以分配给`car.name`不可能影响`copyCar.name`.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-01T02:34:16.257

两者`car`和`copyCar`最初都指向同一个字符串，但它们都对同一个字符串有*不同*的引用。如果您更改一个对象中的引用，它不会影响另一个对象中的引用，所以这就是如何`car`指向新字符串而不是`carCopy`.

# php - 设置网站/应用程序时，我将 mysql config.php 文件放在哪个目录中？

> ID：10392812
> 
> 赞同：1
> 
> 时间：2012-05-01T02:24:02.403
> 
> 标签：php, directory, config

嗨，林新来建立网站。我有一个文档根目录：home/user/public_html/www.example.com/public 我所有的静态文件都应该可以公开查看。但其中许多文件都包含 config.php。这些 config.php 文件具有用户名和密码，因此将它们放在公共文件夹中似乎并不正确。

1.  这些文件应该放在哪里？

2.  如果我将配置移动到不同的目录（我已经尝试过），那么静态文件就再也找不到配置文件了。我会指向新位置吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-01T02:30:58.900

嗯，WordPress 是目前最流行和最大的平台之一，它只是将 wp-config.php 文件放入文档根目录，所以如果它对他们来说足够好，你可以说它对你来说已经足够好了 :)

您当然可以将 config.php 文件存储在您的实际文档根目录的上一级。如果给出正确的路径，PHP 仍然可以访问它。

例如[http://codex.wordpress.org/Hardening_WordPress#Securing_wp-config.php](http://codex.wordpress.org/Hardening_WordPress#Securing_wp-config.php)

每个包含 config.php 的文件都需要用正确的路径引用它。如果您只是将 config.php 存储在根目录中，则可以更改所有包含以使用

```
include_once($_SERVER['DOCUMENT_ROOT'] . '/config.php'); 
```

无论包含文件的位置如何，这都将起作用。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-01T02:34:04.713

是的，您需要更改 config.php 相对于静态文件的位置。如果我理解正确，默认情况下它们都在同一个目录中，因此
`include 'config.php';`
如果要将它们移动到新文件夹中，则必须具有，假设文件夹的名称是隐藏的，那么您必须将其更改为：
`include 'hidden/config.php';`

最后，如果您决定上移一个目录，则必须使用
`include '../config.php';`

您可以在此处详细了解相对路径： [绝对与相对链接](http://webdesign.about.com/od/beginningtutorials/a/aa040502a.htm)

# c++ - g++ 在进行复制初始化时找不到正确的复制构造函数

> ID：10392817
> 
> 赞同：0
> 
> 时间：2012-05-01T02:24:43.187
> 
> 标签：c++

使用以下代码：

```
class B{};
class A{
public: 
    A(B& b);
    A(const A& a);  
};
A::A(B& b){
}
A::A(A& a){
}
int main(){
    B b;
    A a = b;
} 
```

没有对“A::A(A)”的匹配函数调用

我查阅了一些参考资料，认为这可能是由返回值优化 (RVO) 引起的，所以我尝试通过 -fno-elide-constructor 选项禁用优化。问题依然存在。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-01T02:34:48.143

```
A a = b; 
```

在上面的代码中，从*语义上讲*`A`，创建了一个类型为¹的临时对象，该对象将被传递给 的复制构造函数`A`，但是正如您*定义*的复制构造函数一样，它通过非常量引用获取参数，但是临时对象不能绑定到非常量引用，因此会出现错误。

所以你需要做的就是*添加* `const`定义::

```
A::A(A const &a)   //const added
{
} 
```

现在你的代码应该可以编译了。

^(1\. 请注意，我在*语义*`A`上说正在创建一个临时类型的对象。编译器可能会优化这一步（事实上，任何像样的编译器都会优化这一步）并且可能会实际创建临时对象，并且可能*实际*调用复制构造函数。但即使它*实际上*没有被调用，您也需要可访问的复制构造函数仅用于语义检查。)

# ruby-on-rails - Twitter Bootstrap Typeahead 文本字段名称属性与自动完成功能混淆

> ID：10392819
> 
> 赞同：5
> 
> 时间：2012-05-01T02:25:04.193
> 
> 标签：ruby-on-rails, ruby, ruby-on-rails-3, twitter-bootstrap

我正在使用来自 twitter bootstrap 的 typeahead js 扩展作为自动完成字段。我对此有一个微妙的问题。我有一个文本字段，如：

```
<%= text_field_tag :search, params[:search], :data => { :provide => 'typeahead', :source => ...} %> 
```

问题是我必须指定 name='search' （使用 :search），以便能够获取文本输入搜索值。但是，如果我这样做，浏览器会自动创建我已经在我的文本字段中尝试过的条目的自动完成历史记录。

如果我删除 :search 并替换为 ''，浏览器将无法“保存”历史记录，因为文本字段上没有 name 属性。但是，这样，我自己无法获得输入的值。

我该如何解决这个问题？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-05-01T04:07:46.020

当我使用jquery-ui 的[自动完成功能](http://jqueryui.com/demos/autocomplete/)时，它会在输入标签中设置属性 autocomplete="off"，因此您可以尝试包含选项：autocomplete=>"off"。该字段不显示历史记录中的任何输入，只是传递给自动完成的内容。

如果这不起作用，只需尝试 jquery-ui 的自动完成功能。它绝对有效。

# android - 如何在android中的单个listpreference项目上设置点击监听器？

> ID：10392820
> 
> 赞同：0
> 
> 时间：2012-05-01T02:25:16.963
> 
> 标签：android, android-preferences

在我的应用程序中，我想在我的首选项活动中的各个首选项列表项目上设置一个点击监听器，问题是我只能找出如何在主列表首选项本身上设置一个点击监听器，有没有办法可以设置单个列表项的键，所以当我设置 OnPreferenceClickListener 时，我可以执行一些列表项特定的代码？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-01T02:29:09.050

确保您的首选项类`implements`OnPreferenceClickListener 然后覆盖`onPreferenceClick`然后检查按下了哪个首选项键

```
@Override
public boolean onPreferenceClick(Preference preference) {
    if (preference.getKey().equals("schedulestart")) {
        showDialog(0);
    } else if (preference.getKey().equals("schedulestop")) {
        showDialog(1);
    } else if (preference.getKey().equals("priority")) {

        getPreferenceManager().getSharedPreferences().edit().putInt("unreadcount", 0).commit();
    }
    return true;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2015-06-22T22:59:10.677

这个问题相对来说比较古老，但我想做类似的事情——特别是在点击任何 ListPreference 项目时加入钩子。onSharedPreferenceChanged 之类的东西对我不起作用，因为即使单击了当前选择的 ListPreference，我也需要做一些事情。我不确定我是否理解这里的另一个答案来解决问题。我的谷歌搜索没有发现任何其他解决方案。

我继续扩展 ListPreference 并覆盖 onDialogClosed()。onDialogClosed 的 ListPreference 源代码是

```
 @Override
    protected void onDialogClosed(boolean positiveResult) {
        super.onDialogClosed(positiveResult);

        if (positiveResult && mClickedDialogEntryIndex >= 0 && mEntryValues != null) {
            String value = mEntryValues[mClickedDialogEntryIndex].toString();
            if (callChangeListener(value)) {
                setValue(value);
            }
        }
    } 
```

我创建了一个工作界面来在我的新 ListPreference 中发送所选列表项的值，然后覆盖 onDialogClosed：

```
public class MyListPreference extends ListPreference {

    private ListItemClickListener mListItemClickListener;

...

    public void setOnListItemClickListener(ListItemClickListener listener) {
        mListItemClickListener = listener;
    }

    public interface ListItemClickListener {
        public void onListItemClick(String value);
    }
...

    @Override
    protected void onDialogClosed(boolean positiveResult) {
        super.onDialogClosed(positiveResult);

        if (positiveResult && getEntryValues() != null && mListItemClickListener != null) {
            String value = getValue();
            mListItemClickListener.onListItemClick(value);
        }
    } 
```

然后，在您的设置活动中（或您使用新 ListPreference 的任何地方），只需将其挂钩：

```
 @Override
    protected void onResume() {
        super.onResume();

        MyListPreference listPref = (MyListPreference)
                findPreference(getString(R.string.key_name));
        listPref.setOnListItemClickListener(this);    
    }

    ...
    public void onListItemClick(String value) { 
    // Do something
    } 
```

这适用于我的目的。

# php - PHP PDO 配置文件包括 - 全局

> ID：10392822
> 
> 赞同：4
> 
> 时间：2012-05-01T02:25:18.243
> 
> 标签：php, pdo

我正在为当前项目从使用 mysql 查询行转移到 PDO，但我遇到了一个问题。对于这项任务，我不允许使用任何课程（如果你问我，这是愚蠢的限制）

基本上我得到了一个非对象错误，因为我的主 php 文件看不到设置变量 $DBH。我通过使用 $DBH 全局设置每个函数来解决这个问题；所以可以使用它，但是我被告知这是不好的编码习惯。是这样吗？如果是这样，我怎样才能让我的函数看到我的配置变量。

**配置文件**

```
try 
{
    $DBH = new PDO("mysql:host=host;dbname=db", "username", "Password");
    $DBH->setAttribute(PDO::ATTR_ERRMODE, PDO::ERRMODE_EXCEPTION);

}
catch (PDOException $e){
    echo $e->getMessage();
} 
```

**一个php文件**

```
function concName($concID)
{   
        global $DBH; //THIS is the area that im told is bad practice - can this be eliminated?
        $stmt = $DBH->prepare("SELECT CONCAT(`Firstname`, ' ', `Surname`) AS 'Membername'     FROM `members` WHERE `MemberID`= :MemberID");
        $stmt->bindValue(":MemberID",$concID);
        $stmt->execute();

        while($row = $stmt->fetch())
        {
            return $row['Membername'];      
        }

} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-01T02:35:02.410

只需`$DBH`作为参数传递给任何需要它的函数：

```
function concName($concID, $DBH)
{   
        $stmt = $DBH->prepare("SELECT CONCAT(`Firstname`, ' ', `Surname`) AS 'Membername'     FROM `members` WHERE `MemberID`= :MemberID");
        $stmt->bindValue(":MemberID",$concID);
        $stmt->execute();

        while($row = $stmt->fetch())
        {
            return $row['Membername'];      
        }

} 
```

除了`global`关键字，您还可以从`$GLOBALS[]`数组中访问它，这在函数中使用时更明确地说明了变量的来源。不过，传递参数仍然比这更可取。

```
function concName($concID)
{   
        // Better than `global` keyword, use `$GLOBALS['DBH']` every time you access it in outside global scope
        // Still not preferred to passing a parameter though.
        $stmt = $GLOBALS['DBH']->prepare("SELECT CONCAT(`Firstname`, ' ', `Surname`) AS 'Membername'     FROM `members` WHERE `MemberID`= :MemberID");
        $stmt->bindValue(":MemberID",$concID);
        $stmt->execute();

        while($row = $stmt->fetch())
        {
            return $row['Membername'];      
        }

} 
```

如果您在配置文件中定义了多个全局变量，则可以将它们全部包装在一个数组中，然后将其传递给需要它们的函数。这将它们整齐地包装成一个配置选项包，可供任何需要它们的功能使用。

### 配置文件

```
// Global array of config options
$config = array();

// various options
$config['option1'] = 'option 1';
$config['option2'] = 12345;

try 
{
    $config['DBH'] = new PDO("mysql:host=host;dbname=db", "username", "Password");
    $config['DBH']->setAttribute(PDO::ATTR_ERRMODE, PDO::ERRMODE_EXCEPTION);

}
catch (PDOException $e){
    echo $e->getMessage();
} 
```

然后传递`$config`给函数调用

# iphone - 导出 iPhone 应用程序以提交 WWDC

> ID：10392825
> 
> 赞同：-1
> 
> 时间：2012-05-01T02:25:41.100
> 
> 标签：iphone, ios, xcode, export

我将很快申请 WWDC 学生奖学金。我一直在开发一个我想在我的应用程序中链接到的应用程序。该应用程序目前不在 App Store 上。

当我通过 Xcode 导出 .ipa 文件来导出应用程序并将其通过电子邮件发送给朋友进行测试时，他无法将应用程序从 iTunes 传输到他的 iOS 设备。

我可以为他设置一个 Ad Hoc 个人资料，以便他可以对其进行测试，但我显然没有与 iPhone 相关的信息，一旦我将应用程序提交给他们，Apple 将使用它来审查应用程序。

我必须怎么做才能让应用程序在任何 iOS 设备上运行而无需为每个设备设置 Ad-Hoc 帐户？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-01T02:34:09.460

你看过提交页面吗？需要登录：[https ://developer.apple.com/wwdc/scholarships/application/](https://developer.apple.com/wwdc/scholarships/application/)

它说您的应用程序必须在 App Store 上。首先将其提交到 App Store，然后一旦获得批准，您就可以申请学生奖学金。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-01T02:34:12.480

如果没有测试手机的设备 ID，您将无法在开发模式下分发您的应用。您可以做的一件事是设置一个免费的 TestFlight 帐户，在您的应用程序中包含 TestFlight（设置大约需要 10 分钟），然后在您的应用程序中包含 TestFlight 测试员注册链接。然后，如果他们想试用您的应用程序，他们可以点击该链接向 TestFlight 注册他们的设备，然后当他们这样做时您会收到警报，您可以使用他们的设备 ID 重新编译您的应用程序并通过 TestFlight 将其推送给他们。

# django - 有没有办法区分两个同名的模板标签？

> ID：10392827
> 
> 赞同：1
> 
> 时间：2012-05-01T02:25:54.437
> 
> 标签：django, django-templates

我有 2 个共享相同名称的不同模板标签：the_template_tag。

有什么方法可以区分这两个模板标签吗？像“source1.the_template_tag”和“source2.the_template_tag”这样的东西？

这是我的情况。我正在使用[django-timezones](https://github.com/brosner/django-timezones)。有一个名为 localtime 的模板标签，它基本上允许我以客户端本地时间显示日期。

```
{% load timezone_filters %}
... some more code
"user_localtime": "{{ serverdate|localtime:user_timezone }}", 
```

另外，我正在使用 Django 1.4 的新时区。当我需要使用客户端本地时间（使用[django-timezone](https://github.com/brosner/django-timezones)）时，我开始遇到问题。基本上，我必须关闭 django 的时区：

```
{% load tz %}
... some more code
{% localtime off %} 
```

但是模板标签是一样的。然后，当然，当我尝试同时使用这两种方法时会出现错误：

```
{% load tz %}
{% load timezone_filters %}
... some more code
{% localtime off %}
"user_localtime": "{{ serverdate|localtime:user.user_timezone }}", 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-01T04:19:53.170

你有两个选择：

1.  停止使用 django-timezones 并使用 django 1.4 的时区功能

2.  如果您必须使用 django-timezones，请编辑源代码并重命名标签。

我强烈推荐#1，强烈反对#2。

# javascript - 将自动播放添加到基本的 jquery 滑块

> ID：10392829
> 
> 赞同：0
> 
> 时间：2012-05-01T02:26:16.563
> 
> 标签：javascript, jquery-plugins, slider, jquery

我正在为类制作一个基本的 jQuery 滑块。并希望让它在 5 秒后自动播放下一张幻灯片，但在它没有做我认为应该做的事情之前没有使用计时器。它等待适当的时间间隔，然后继续触发回调函数。

```
//basic slider on click
$('.slider>ul>li').click(function()
{
    $('.slider>ul>li').removeClass('current');
    $(this).toggleClass('current');
    right=$(this).index()*745;
    $(this).parent('ul').parent('.slider').children('div').children('ul').animate({'right': right}, 1000, 'easeOutBack');
})

//attempt to use timer plugin to auto play
$('.slider>ul>li').timer(
{
        delay: 1000,
        callback: function()
        {alert($('.slider>ul>li.current').index())
            if($('.slider>ul>li.current').index()!=3)
            {
                $('.slider>ul>li.current').next('li').click();
            }else//oddly this doesn't trigger at all
            {
                $('.slider>ul').first().click();
            }
        }
}) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-01T03:31:33.590

尝试这个：

```
setInterval(function(){
  var i = $('.slider>ul>li.current').index();
  var next = (i < 3 ? i+1 : 0);
  var items = $('.slider>ul>li');
  $(items[next]).click();
}, 5000); 
```

编辑：将 setTimeout 更改为 setInterval 并将时间增加到 5 秒；现在应该循环。

# vb.net - 在 VB.NET 中使用 DataPager 的 ListView 控件

> ID：10392832
> 
> 赞同：0
> 
> 时间：2012-05-01T02:26:24.450
> 
> 标签：vb.net, listview, datapager, updatepanel

我以为这很容易。我已经看过很多关于此的帖子，但没有一个能纠正我的情况。我在更新面板中有一个带有 DataPager 的 ListView 控件。通过寻呼机创建的页码链接，第 1 页显示正常，但后续页面为空白。我的 ListView 是通过定义为 AsyncPostBackTrigger 的按钮更新的。这是我的 ASPX 页面：

```
<body>
<form id="SearchForm" runat="server">
<asp:HiddenField ID="hdnSeasonSelected" Value="" runat="server" />
<asp:HiddenField ID="hdnCategorySelected" runat="server" />
<asp:HiddenField ID="hdnCartNumItems" Value="0" runat="server" />
<div class="Order">
    <div class="OrderCart">
        <uc1:OrderCart ID="OrderCart" runat="server" />
    </div>
    <div class="OrderSearchResults">
        <h2>
            Search Items<hr />
        </h2>
        Brand:
        <asp:DropDownList ID="ddlBrands" runat="server" AppendDataBoundItems="true" onchange="PopulateBrands();">
            <asp:ListItem Text="Select Brand" Value="0"></asp:ListItem>
        </asp:DropDownList>
        Season:
        <asp:DropDownList ID="ddlSeasons" runat="server" onchange="PopulateCategories();">
            <asp:ListItem Text="Select a Brand to View Seasons" Value="0"></asp:ListItem>
        </asp:DropDownList>
        Category:
        <asp:DropDownList ID="ddlCategories" runat="server" onchange="ddlCategories_SelectedIndexChanged()">
            <asp:ListItem Text="Select a Season to View Categories" Value="0"></asp:ListItem>
        </asp:DropDownList>
        <div class="linespace">
        </div>
        <div>
            Item #:
            <asp:TextBox runat="server" ID="txtItemNumber"></asp:TextBox>
            Item Desc:
            <asp:TextBox runat="server" ID="txtItemDesc"></asp:TextBox>
            <asp:Button ID="btnSearch" runat="server" OnClientClick="return CheckSearch();" OnClick="btnSearch_Click"
                Text="Button" />
            <input id="btnReset" type="button" value="Reset" onclick="ResetSearch()" /></div>
    </div>
    <asp:ScriptManager ID="ScriptManager1" runat="server">
    </asp:ScriptManager>
    <asp:UpdatePanel ID="UpdatePanel1" runat="server">
        <ContentTemplate>
            <asp:ListView ID="lvSearchResults" runat="server" DataSourceID="SqlDataSource1" GroupItemCount="2">
                <LayoutTemplate>
                    <table>
                        <tr>
                            <td>
                                <table border="1px" style="background-color: #F3F3F3" cellpadding="5">
                                    <asp:PlaceHolder runat="server" ID="groupPlaceHolder"></asp:PlaceHolder>
                                </table>
                            </td>
                        </tr>
                    </table>
                    <asp:DataPager runat="server" ID="DataPager1" PageSize="4" PagedControlID="lvSearchResults">
                        <Fields>
                            <asp:NumericPagerField ButtonCount="3" PreviousPageText="<--" NextPageText="-->" />
                        </Fields>
                    </asp:DataPager>
                </LayoutTemplate>
                <GroupTemplate>
                    <tr>
                    </tr>
                </GroupTemplate>
                <ItemTemplate>
                    <td>
                        <img src="../Images/test.jpg" />
                    </td>
                    <td id="Td5" valign="top" align="left" runat="server">
                        <b>Item #:</b><asp:Label ID="Label4" runat="server" Text='<%#Eval("full_item_number") %>' />
                        <br />
                        <b>Desc:</b>
                        <asp:Label ID="Label5" runat="server" Text='<%#Eval("item_name") %>' />
                        <br />
                        <b>Color:</b>
                        <asp:Label ID="Label7" runat="server" Text='<%#Eval("color_name") %>' />
                        <a href="">Details</a>&nbsp;&nbsp;&nbsp;<a href="">Season / Categories</a>
                    </td>
                    <td id="Td1" valign="top" align="left" runat="server">
                        <b>Price US$:</b>
                        <asp:Label ID="Label6" runat="server" Text='<%#Eval("program_price") %>' />
                        <input id="Button2" type="button" value="Add to Cart" onclick="AddtoCart('<%#Eval("full_item_number") %>','<%#Eval("item_name") %>');" />
                    </td>
                </ItemTemplate>
            </asp:ListView>
        </ContentTemplate>
        <Triggers>
            <asp:AsyncPostBackTrigger ControlID="btnSearch" />
        </Triggers>
    </asp:UpdatePanel>
    <asp:SqlDataSource ID="SqlDataSource1" runat="server" CancelSelectOnNullParameter="false">
    </asp:SqlDataSource>
</div>
</form> 
```

有任何想法吗？在此先感谢...鲍勃

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2012-05-05T18:59:17.410

固定...只是有一些糟糕的逻辑！

# android - 通过长按在 Android WebView 中启动缩放

> ID：10392836
> 
> 赞同：0
> 
> 时间：2012-05-01T02:27:09.657
> 
> 标签：android, webview, zooming, long-press

我正在寻找一种方法来复制本机 WebView 缩放双击但通过长按触发。因为，使用双标签缩放，我希望缩放以触摸点为中心缩放，然后能够以编程方式缩小到默认缩放级别。

我在想可能有一种方法可以将双击手势欺骗到长按处理程序中的 WebView 并为其提供长按的坐标，但我无法找到一种方法来做到这一点。

这可以做到吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-01T13:45:07.013

根据这篇文章中的信息，找到了一个可行的解决方案：

[在 WebView 上以编程方式双击](https://stackoverflow.com/questions/10123166/double-tap-programmatically-on-webview)

我替换了以下内容：

```
public void simulateDoubleTap()
    {
        simulateDoubleTapEvent(0);
        simulateDoubleTapEvent(2);
        simulateDoubleTapEvent(2);
        simulateDoubleTapEvent(1);
        simulateDoubleTapEvent(0);
    } 
```

和：

```
public void simulateDoubleTap()
    {
        simulateDoubleTapEvent(MotionEvent.ACTION_DOWN);
        simulateDoubleTapEvent(MotionEvent.ACTION_UP);
        simulateDoubleTapEvent(MotionEvent.ACTION_DOWN);
        simulateDoubleTapEvent(MotionEvent.ACTION_UP);
    } 
```

然后在我的 longpress 处理程序中添加了对 simulationDoubleTap() 的调用。这似乎有效 - 但它不是 100% 一致的。可能想在事件之间添加一些小的延迟，看看是否可以消除它。我还注意到，当放大时，单个事件会起作用，但是需要两次触发双击才能缩小。这可能是因为我正在使用的手势处理程序或其他一些问题，但通常这似乎可以满足我的需要。

# url - 地址栏中的 URL/ 路径

> ID：10392842
> 
> 赞同：0
> 
> 时间：2012-05-01T02:27:53.443
> 
> 标签：url, path, address-bar

我已经看到我的网站仅在您导航到该网站中的不同网页或项目时显示如下路径，而当我创建网站时，我必须为所有内容创建一个网页，它确实显示带有文件名的路径，如 .php 而其他网站即使导航到新页面，也只显示路径。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-01T02:40:26.300

这称为 URL 路由。开发人员已将 Web 服务器（或 Web 应用程序）配置为将特定的 URL 路径映射到各个 Web 服务器页面（.php、.aspx、.mvc 或其他）。有不同的方法来实现这一点，具体取决于 webserver 平台技术，但通常是通过配置某种 url 路由映射来实现的。以这种方式组织网站 url 有几个优点，但主要是它使 URL 更一致，更易于用户理解，并隐藏了网站底层实现的细节。

# cakephp - 模型中 $_schema 变量中的每个键在 CakePHP 中的作用是什么？

> ID：10392845
> 
> 赞同：3
> 
> 时间：2012-05-01T02:28:22.470
> 
> 标签：cakephp, model, schema

CakePHP 食谱介绍了以下内容 ( [http://book.cakephp.org/2.0/en/models/model-attributes.html#schema](http://book.cakephp.org/2.0/en/models/model-attributes.html#schema) )：

> 包含描述模型的数据库表字段的元数据。每个字段由以下内容描述：
> 
> *   姓名
> *   类型（整数、字符串、日期时间等）
> *   空值
> *   默认值
> *   长度

其中一些是不言自明的，但这是我的问题：

1.  名称 - 这样做的目的是什么？蛋糕书是否只是不清楚地说明其他值将存储在字段名称下的数组中，或者这是一个可以提供不同名称的键，它的用途是什么？
2.  类型 - 我知道类型是什么，但有人可以给我一个完整的选项列表吗？如果我不知道我的选择是什么，很难说它是什么。它们是基于典型的数据库类型，还是表单类型，还是什么？
3.  Null - 这与数据库的 not null 选项相同吗？基本上只需要一个值或抛出一个错误？

出于各种原因，我想写出每个表的模式，但由于这些问题，我有点卡住了。

感谢您的帮助！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-01T09:30:23.853

您可以自己找到大部分问题的答案。要么你调试返回的数据

```
$this->Model->schema(); 
```

其中包含上述所有字段。或者您使用 cake shell 在 /Config/Schema 中创建/转储模式文件：

```
cake schema generate 
```

这样你就可以看到蛋糕创造了什么。

因此，如果您创建一个包含所有类型字段类型的虚拟表“foobars”，您将获得针对您正在使用的当前蛋糕版本的完整模式引用。此外，您将看到您的数据库反映为蛋糕看到它。含义：如果您将一个字段设置为“default not null”，将另一个字段设置为“default null”，您将看到“null”的含义。什么类型的数据库匹配什么类型的蛋糕。

是的，名称是字段名。不过，它应该是数组键本身。

# javascript - .innerHTML 函数 Javascript

> ID：10392846
> 
> 赞同：0
> 
> 时间：2012-05-01T02:28:38.150
> 
> 标签：javascript, innerhtml

这是我的代码：

```
function text(var text)
{
  var Value = document.getElementById("display").innerHTML;
  var New = Value + text;
  document.getElementById("display").innerHTML=New;
} 
```

它应该做的是从调用时获取一个字符串，然后将该字符串添加到 ID 为“display”的 div 元素的末尾。我这样称呼它：`text("hello");`

网页的 HTML 是一个空白的 div 元素，即使在代码运行后它也保持空白。我做的时候有用`document.getElementById("display").innerHTML="hello!";`，现在不行了。谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-01T02:32:34.073

不要将“var”用于函数参数 - 只需在函数括号之间列出它就足够了。所以将该函数更改为：

```
function text(text)
{
  var Value = document.getElementById("display").innerHTML;
  var New = Value + text;
  document.getElementById("display").innerHTML=New;
} 
```

它应该可以工作。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-01T02:32:42.110

取出`var`函数参数：`function text(text)...`

顺便说一句：不要将您的参数命名为与您的函数相同的名称 - 这很令人困惑。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-01T02:40:48.747

你可以这样做：

```
function text(inputText)
{
  document.getElementById("display").innerHTML = document.getElementById("display").innerHTML +" "+ inputText;
} 
```

:)

# networking - 如何将单个直接 ftp 下载拆分为同时多个部分？

> ID：10392848
> 
> 赞同：4
> 
> 时间：2012-05-01T02:29:05.007
> 
> 标签：networking, network-programming, ethernet, bandwidth-throttling

有什么方法，众所周知或纯理论，有一个指向单个文件的链接 - 例如，常规浏览器上的典型下载文件 - 但将传输本身从客户端拆分为多个部分？

本质上，我想知道计算机是否可以将单个网络文件传输分成两个（或更多），以便如果计算机有多个网卡（假设 ISP 没有造成瓶颈），他们可以有效地下载以两倍的速度归档。假设下载源没有做任何事情来监控这种可能令人愤怒的行为。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-01T02:43:51.290

FTP 通过以下`REST`命令支持此功能：[http ://www.ipswitch.com/support/ws_ftp-server/guide/v5/a_ftpref3.html#10694](http://www.ipswitch.com/support/ws_ftp-server/guide/v5/a_ftpref3.html#10694)

客户端通常会在 FTP 服务器上进行功能检测，以通过发出`FEAT`命令来查看它是否支持此功能。

HTTP 也通过`Range`请求标头支持这一点：http: [//www.w3.org/Protocols/rfc2616/rfc2616-sec14.html#sec14.35](http://www.w3.org/Protocols/rfc2616/rfc2616-sec14.html#sec14.35)

上面我最喜欢的客户端是 aria2：[http ://aria2.sourceforge.net/](http://aria2.sourceforge.net/)

# plugins - 如何在Eclipse中查看wizardDialog的源代码？

> ID：10392852
> 
> 赞同：0
> 
> 时间：2012-05-01T02:29:44.417
> 
> 标签：plugins

我在 Eclipse 中按 Ctrl+Shift+T 并尝试查看 WizardDialog 类的源代码，但出现错误：找不到源，该类文件的 JAR 属于不允许修改源的容器“外部插件”其条目上的附件...

我在哪里可以获得源代码？有网址可以下载吗？

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-01T02:39:02.927

一般有两种解决方案：

1.  在与jar文件相同的目录下创建一个名为sources的文件夹，并将源代码放入该文件夹中。然后重启eclipse。

2.  将 jar 文件添加到类路径中，然后将允许附加源代码。

# php - 带 jwplayer 的 mp4 流媒体和下载速度限制

> ID：10392853
> 
> 赞同：1
> 
> 时间：2012-05-01T02:30:03.823
> 
> 标签：php, performance, download, streaming, mp4

大家好，我的流媒体有问题。目前我已经让 jwplayer 打开一个 php 文件（例如movie2.php），这个 php 文件通过睡眠 1 秒为 jwplayer 逐个提供电影文件以限制速度（这个 php 文件还检查引用者和会话并且不显示视频路径，但这些对于问题并不重要）。直到这里一切都很完美，但问题是：我**无法**将视频搜索到未加载的部分，原因很明显。**所以谁能告诉我该怎么做？**我需要以某种方式更改此 php 文件以使其支持流式传输，或者任何人都可以给我一个支持流式传输并同时限制下载速度的脚本？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-01T06:04:02.097

检查传递给您的 php 代码的“ **start= ”值。**我以前用过JW Player，它肯定支持seek。[显然](http://www.longtailvideo.com/support/forums/jw-player/setup-issues-and-embedding/7362/pseudo-streaming-and-seeking#comment-34866)，搜索更像是重新启动，并将“开始”传递给您的 php 文件。从那里开始，您的文件才开始播放。

关于处理对象的客户端以避免几个陷阱，该线程还有一些其他评论。它可能有点过时，但应该是相关的。

# java - 生产者消费者 - ExecutorService & ArrayBlockingQueue

> ID：10392855
> 
> 赞同：3
> 
> 时间：2012-05-01T02:30:18.113
> 
> 标签：java, multithreading, concurrency, producer-consumer, blockingqueue

我想通过使用 ExecutorService 和 ArrayBlockingQueue 了解我对生产者消费者设计的理解是否正确。我知道有不同的方法来实现这个设计，但我想，最后，这取决于问题本身。

我不得不面对的问题是：我有一个从一个大文件（6GB）读取的 ONE 生产者；它逐行读取并将每一行转换为一个对象。它将对象放在 ArrayBlockingQueue 中。

消费者（少数）从 ArrayBlockingQueue 中获取对象并将其保存到数据库中。

现在，显然生产者比消费者快得多；将每一行转换为一个对象需要几分之一秒，但对于消费者来说需要更长的时间。

所以......如果我希望通过这样做来加速这个过程：我创建了 2 个分类的“ProducerThread”和“ConsumerThread”，它们共享 ArrayBlockingQueue。两者之间协调的线程如下所示：

```
@Override
public void run()
{
    try{

        ArrayBlockingQueue<Ticket> queue = new ArrayBlockingQueue<Ticket>(40);
        ExecutorService threadPool = Executors.newFixedThreadPool(8);

        threadPool.execute(new SaleConsumerThread("NEW YORK", queue)); 
        threadPool.execute(new SaleConsumerThread("PARIS", queue));
        threadPool.execute(new SaleConsumerThread("TEL AVIV", queue));
        threadPool.execute(new SaleConsumerThread("HONG KONG", queue));
        threadPool.execute(new SaleConsumerThread("LONDON", queue));
        threadPool.execute(new SaleConsumerThread("BERLIN", queue));
        threadPool.execute(new SaleConsumerThread("AMSTERDAM", queue));

        Future producerStatus = threadPool.submit(new SaleProducerThread(progressBar, file, queue)); 
        producerStatus.get(); 
        threadPool.shutdown();   

    }catch(Exception exp)
    {
        exp.printStackTrace();
    }
} 
```

我的问题是：

1.  **上面的设计实际上会同时**使用每个线程吗？我的电脑是两个 2.4GHz 四核。

2.  我不确定 Future 和 .get() 的用途是什么？

顺便说一下，结果很快（考虑到第一个版本是连续的，需要 3 小时）现在大约需要 40 分钟（但可能还有改进的余地）。

感谢任何指针

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-01T07:35:26.120

我会看看等待 IO 花费了多少时间以及在 CPU 上花费了多少时间。我怀疑您的主要瓶颈是数据库，您需要查看如何使导入更有效。您可以尝试批量更新，因为这可以提高吞吐量。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-01T05:15:53.773

答案：

1.  我不确定“同时使用每个线程”是什么意思。但当然所有线程都可以同时执行。您的性能将取决于您拥有的线程数以及数据的分区方式。您可以尝试线程数以尝试获得更好的结果，而不是为每个城市分配线程，也许您可​​以使用记录号并将每个线程分配给记录号的模数。假设您有 10 个线程，记录 1、11、21 等将转到线程 1、2、22 等到线程 2。这样，每个线程您将获得相同数量的事务，因此您将充分利用线程，直到您完成。
2.  这`Future`是为了允许代码在事件完成时阻塞。在这种情况下，该`get`方法返回结果。`SaleProducerThread`

# c++ - How string library works in C++?

> ID：10392858
> 
> 赞同：1
> 
> 时间：2012-05-01T02:30:33.663
> 
> 标签：c++, string

According to the text at [http://www.cplusplus.com/reference/string/string/](http://www.cplusplus.com/reference/string/string/), string library in C++ is a class, not just a " mere sequences of characters in a memory array". I wrote this code to find out more:

```
string s = "abcd";

cout << &s << endl; // This gives an address
cout << s[0] << endl; // This gives 'a'
cout << &s[0] << endl; // This gives "abcd" 
```

I have some questions: 1\. Is string library in C++ still an array of sequence characters? 2\. How can I get the address of each character in string? (As in the code, I can retrieve each character, but cannot get its address using `& operator`)

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-01T02:34:45.967

Much (most) of this really isn't about the string class itself.

`std::string` does store its contents as a contiguous array of characters.

`&s[0]` will yield the address of the beginning of that array -- *but* `std::ostream` has an overload of `operator<<` that takes a pointer to char, and prints it as a string.

If you want to see the addresses of the individual characters in a string, you need to take their addresses *and then* cast each address to pointer to void. `std::iostream` also has an overload of `operator<<` that takes a pointer to void, and *that* overload prints out the address instead of a string that (it assumes) is at that address.

Edit: demo code:

```
#include <iostream>
#include <string>

int main(){
    std::string x("this is a string");

    std::cout << &x[0] << "\n";
    std::cout << (void *)&x[0] << '\n';
    return 0;
} 
```

Result:

```
this is a string
00481DE0 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-01T02:33:57.870

std::string stores the string as essentially a vector of characters, see [basic_string](http://www.sgi.com/tech/stl/basic_string.html)

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-05-01T04:07:37.540

From Stroutrup's book, chapter 20 on strings, page 579 (2000 edition)

`From C, C++ inherited the notion of strings as zero terminated arrays of char....`. In C, the name of the array is same as the address of the first character. That's why you get the whole string printed when you pass `&s[0]` as it same as passing `s` itself.

# wordpress - 删除 wordpress 上的帮助选项卡

> ID：10392867
> 
> 赞同：1
> 
> 时间：2012-05-01T02:31:51.837
> 
> 标签：wordpress, unset, add-filter

有什么方法可以删除 wordpress 上的帮助标签？我希望删除这些选项卡而不是用 css 隐藏它们。

在 wp-admin/includes/screen.php 上有几行提到了这一点，但不知道如何创建一些东西来删除帮助选项卡。

有什么方法可以创建类似于：`add_filter('screen_options_show_screen', '__return_false');`但要删除帮助选项卡？

从 screen.php 文件中：

```
647      /**
 648       * Removes a help tab from the contextual help for the screen.
 649       *
 650       * @since 3.3.0
 651       *
 652       * @param string $id The help tab ID.
 653       */
 654    public function remove_help_tab( $id ) {
 655          unset( $this->_help_tabs[ $id ] );
 656      }
 657  
 658      /**
 659       * Removes all help tabs from the contextual help for the screen.
 660       *
 661       * @since 3.3.0
 662       */
 663    public function remove_help_tabs() {
 664          $this->_help_tabs = array();
 665      } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-02T09:31:32.573

您需要使用`contextual_help`帮助过滤器。

```
add_filter( 'contextual_help', 'wpse50723_remove_help', 999, 3 );
function wpse50723_remove_help($old_help, $screen_id, $screen){
    $screen->remove_help_tabs();
    return $old_help;
} 
```

过滤器用于旧的上下文帮助（3.3 之前）。（我不确定返回的内容是否重要......？）。

在任何情况下，过滤器都应该被延迟调用（因此为 999），因为插件可以将它们自己的帮助选项卡添加到页面中。这就是为什么`admin_head`不是一个理想的钩子的部分原因。

这也将起作用

```
add_action('admin_head', 'mytheme_remove_help_tabs');
function mytheme_remove_help_tabs() {
    $screen = get_current_screen();
    $screen->remove_help_tabs();
} 
```

但第一个选择是安全的

# java - 将“Short[]”元素的默认值设为 0 而不是 null？

> ID：10392868
> 
> 赞同：1
> 
> 时间：2012-05-01T02:31:55.303
> 
> 标签：java

我有一个程序可以创建列表，并且需要将任何分配的值设为 0。当我使用它时它运行良好，`int[] humpty_dumpty = new int[20];` 但是为了优化我设置它们的列表的大小，`Short[]`现在我的程序正在中断，因为它以零作为输入（并且`Short[] humpty_dumpty = new Short[20];`正在制作默认值`null`）。

有没有办法将其设置为默认零而不必遍历整个列表（我可以通过 for 循环做到这一点，但想知道是否有办法使其行为类似于 int）？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-05-01T02:34:03.067

`Short[]`a和 a之间是有区别的`short[]`。后者的元素将被初始化为，`0`因为`short`是“原始”类型并且不能为空。大写的`Short`类将被初始化，`null`因为它实际上只是一个`Object`包装`short`值。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-01T02:34:42.457

您可以创建一个原始类型的数组而不是包装器，

```
short []ar=new short[20]; 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-01T03:48:05.147

答案，按顺序：

1）需求第一，优化最后。不要使用稀疏数组，或者尝试“聪明”，除非您特别需要这样做并处理额外的代码/开销。

2) 使用通用*方法*（可能在 Instance 或 Static Helper*类*中）以避免重复通用代码。

例如。short sparseGet (Short[] array, int i) {return (array[i] != null ? array[i] : 0);}

3) 也许使用 short[] 而不是 Short[]？大写类型不是原始类型，而是 Value Wrapper 类 - 并存储为实例的对象引用（指针），因此速度较慢且内存密集。

4) 大写的“Value Wrapper”类型*适用*于您可能具有来自数据库的空值的情况。例如。Person.Age 理想情况下是整数，如果您/数据库可能没有该字段的数据。

干杯。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-05-01T02:50:48.760

Short[] 根本不“优化列表的大小”，它的默认值为 null。short[] 确实如此，并且它的默认值为零。

# ruby-on-rails-3 - 资产管道是否需要公共/资产中的文件？

> ID：10392869
> 
> 赞同：1
> 
> 时间：2012-05-01T02:31:56.030
> 
> 标签：ruby-on-rails-3, asset-pipeline

我正在将 3.0 Rails 应用程序升级到 3.1.4，包括资产管道。

我在 Heroku，所以我的 application.rb 中有这个

```
config.assets.initialize_on_precompile = false 
```

我注意到当我运行时：

```
bundle exec rake assets:precompile 
```

它在 public/assets 目录中创建文件（即使我的资产已经在 app/assets 中）。

例如，它会创建像 application-72b2779565ba79101724d7356ce7d2ee 这样的文件，以及复制我在 app/assets 中的图像。

我的问题是：（1）应该将这些文件上传到我的生产服务器吗？(2) 如果我想上传这些，我想更新每个应用程序-xxxxxxxx 还是只更新最新的？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-01T03:41:37.437

To your first question: Heroku will not allow you to modify the filesystem. So your assertion is correct- You will need to pre-compile the asset pipeline before you send it up to Heroku, so that it can be utilized in your production environment.

And the latter: You'll want to make sure you have the latest compilation. Any others wont be used. The "xxxxxxx" portion is to make sure that your users have the latest and greatest version of your assets. It's a way of versioning what the browser gets, and making sure they're not caching a bad copy of the JavaScript, when you want to set up their cache to hold on to the JS and CSS files as long as they can, instead of constantly getting it from your web server.

Take my Heroku comments with a slight grain of salt, as I have not deployed to Heroku before. I just know how their system works to some degree.

# android - 公历日历和 SQLite

> ID：10392870
> 
> 赞同：0
> 
> 时间：2012-05-01T02:32:06.403
> 
> 标签：android, sqlite, gregorian-calendar

我正在尝试设置一个可以跟踪虚拟时间的 RPG。经过一些阅读 GregorianCalendar 似乎是做到这一点的最佳方式，但我有一些问题，希望有经验的人能给我一些见解。

这就是我想要做的。游戏将从 1675 年开始，持续约 30 年。到那时，如果他们活了那么久，角色就会退休。角色将能够通过粗略的游戏从我为他们预设的动作中进行选择。有些操作会很短，需要一个小时，而其他操作可能需要一周或一个月。真正的问题来自我大量使用 SQLite。我想保存当前时间以及操作在我的数据库中需要多长时间。设置时我的第一个想法是，如果我想在 1675 年 8 月 15 日开始游戏以使我的数据库有 3 行，请将这些字段设置为 8、15、1675。然后还有 2 列时间。通过光标拉出这些 int 并用类似的东西设置它们

```
GregorianCalendar time = new GregorianCalendar();
time.set(year, month, date, hour, minute); 
```

我想我会以类似的方式拉动一个动作需要多长时间。有一个 int X，然后是一个字符串来判断这个时间是否以分钟、小时、天等为单位。然后将此 int 添加到从数据库中提取的 int 中以直接添加到日历中。

**问：**如果我直接将它添加到日历中，我将如何从日历中提取 int 值以存储在数据库中以便稍后加载（当玩家加载他们的游戏时）？

**问：**如果我将它添加到存储在数据库中的 int 并使用这个新 int 设置日历，当我添加的足够多以使 int 超出日历的范围时会发生什么（日期设置为 31，但我添加了另一天） ?

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-01T03:32:36.010

您可以将 GregorianCalendar 对象转换为 UNIX 时间，例如使用[getTimeInMillis()](https://developer.android.com/reference/java/util/Calendar.html#getTimeInMillis%28%29) [setTimeInMillis()](https://developer.android.com/reference/java/util/Calendar.html#setTimeInMillis%28long%29)。GregorianCalendar 也有一个[roll()](https://developer.android.com/reference/java/util/Calendar.html#roll%28int,%20int%29)方法：

> 将指定金额添加到指定字段，并在字段的值超出当前日期的最大值或最小值时换行。其他字段将根据需要进行调整以保持一致的日期。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-01T03:53:56.053

我建议使用[Joda Time](http://joda-time.sourceforge.net/)来代替（有些缺乏的）标准 java 日期和时间实用程序。它更加灵活。

它具有进行日期数学运算的功能，它支持几种不同的日历（ISO8601、佛教、科普特、埃塞俄比亚、公历、公历朱利安、伊斯兰、朱利安），支持间隔、持续时间和周期。它内置了格式化程序，可以让你的输出看起来像你想要的任何东西。

如果是我，我会使用 Joda 并以 Joda 提供的本机格式存储日期（我不记得那是什么），然后再次将其拉出并使用 Joda 进行所有日期数学运算将其转换为您希望用于向用户显示的任何日历。

否则，在我看来，您将重新发明轮子。

# android - 如何动态地将图像添加到android项目中的资源/drawable文件夹

> ID：10392875
> 
> 赞同：0
> 
> 时间：2012-05-01T02:33:01.510
> 
> 标签：android, android-layout

如何动态地将图像添加到android项目中的资源/可绘制文件夹？

我应该浏览 android 手机中的内置图库应用程序并将图像从图库添加到 resouse/drawable 文件夹可以完成吗？

> Intent intent = new Intent(Intent.ACTION_GET_CONTENT); intent.setType("图片/*"); startActivityForResult(intent, IMAGE_PICK);

我已经使用上面的代码从图库中挑选图像

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-01T04:32:36.270

不，您不能在编译代码后将图像或视频保存在资源文件夹中，如果您不希望用户访问一旦选择的图像，您可以将其保存在 SD 卡或内部存储器中，您可以将其保存在内部存储器中（/数据/data/Package Name/) 如果您的图像尺寸不太大，您还可以将图像保存在数据库中作为 BLOB。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-01T02:38:52.990

现在我更好地理解了你的问题，我已经编辑了答案。

当应用程序编译并安装在用户手机上时，eclipse中存在的应用程序目录结构不存在。

[但是，您可以使用数据存储](http://developer.android.com/guide/topics/data/data-storage.html)中概述的多种方法来保存它们。

因此，例如，您可以在 SD 卡（外部存储）上为您的应用程序创建一个目录，并将它们保存在其中并为其授予所需的权限。

# jquery - 打开/关闭菜单时HTML在iOS中放大/缩小

> ID：10392876
> 
> 赞同：0
> 
> 时间：2012-05-01T02:33:07.707
> 
> 标签：jquery, css, ios, html, mobile-safari

我正在使用类似于 Facebook 的菜单在移动网站上工作，除了移动 Safari 之外，一切都在运行。问题是一旦我在 iPhone 上打开菜单，其余内容会缩小以适应屏幕，然后在菜单关闭时重新放大。

为了让它更有趣，这只在浏览器中运行时才会发生 - 如果您将其添加到主屏幕，则内容不会调整大小。它也不会在 iPad 上调整大小，只是在 iPhone 上。

我在这里有代码的简化版本：http: [//jsfiddle.net/HYjEB/261/](http://jsfiddle.net/HYjEB/261/)

如果你有 iPhone，你可以在这里看到运行的问题：http: [//tfklabs.com/clients/mypr/](http://tfklabs.com/clients/mypr/)

我尝试了几件事，包括将#right div 设置为 position:fixed 而不是 position:absolute。它确实有效，但是用户无法滚动页面的内容。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-01T02:50:02.780

如果您不想缩放 div，则需要将其滑入其父级。看看这个：http: [//jsfiddle.net/HYjEB/262/](http://jsfiddle.net/HYjEB/262/)。我也对您的 html 结构和 css 进行了一些更改。

# wpf - wpf 鼠标悬停填充矩形

> ID：10392878
> 
> 赞同：2
> 
> 时间：2012-05-01T02:33:25.960
> 
> 标签：wpf, mouseover

我在 wpf 中有网格。当我在矩形上做鼠标悬停时，我可以看到颜色变化。但是当我在内容上做鼠标悬停时，我看到了矩形的原始颜色。

我应该写什么来在 ContentPresenter 上应用相同的鼠标悬停效果，或者有没有办法在内容演示者的鼠标悬停时更改矩形背景颜色。

```
<Grid Background="{TemplateBinding Background}" x:Name="dgColumnHeader">
         <Border x:Name="border" BorderBrush="Black" BorderThickness="0,0,1,1" Grid.ColumnSpan="1">
                <Rectangle Width="116" Margin="3,3,3,3" HorizontalAlignment="Center" RadiusX="7" RadiusY="7">
                    <Rectangle.Style>
                        <Style TargetType="{x:Type Rectangle}">
                            <Setter Property="Fill" Value="{DynamicResource ContentOutofFocusBrush}"></Setter>
                            <Style.Triggers>
                                <Trigger Property="IsMouseOver" Value="True">
                                    <Setter Property="Fill" Value="{DynamicResource ActiveItemBrush}" />
                                </Trigger>
                            </Style.Triggers>
                        </Style>
                    </Rectangle.Style>
                </Rectangle>
            </Border>
            <ContentPresenter x:Name="content"  HorizontalAlignment="Center"  VerticalAlignment="Center" Content="{TemplateBinding Content}" />
        </Grid> 
```

谢谢迪

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-01T06:07:17.350

如果网格是您的控件模板的一部分，那么最好将矩形样式触发器移动到 ControlTemplate.Triggers 中：

```
<Window x:Class="Presentation2.MouseOverRectangleWindow"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    Title="MouseOverRectangleWindow" Height="300" Width="300">
  <Window.Resources>
    <SolidColorBrush x:Key="ContentOutofFocusBrush" Color="Orange"/>

    <SolidColorBrush x:Key="ActiveItemBrush" Color="Blue" />

    <Style x:Key="MouseOverContentControlStyle" TargetType="{x:Type ContentControl}">
      <Setter Property="Template">
        <Setter.Value>
          <ControlTemplate TargetType="ContentControl">
            <Grid Background="{TemplateBinding Background}" x:Name="dgColumnHeader">
              <Border x:Name="border" BorderBrush="Black" BorderThickness="0,0,1,1" Grid.ColumnSpan="1">
                <Rectangle x:Name="PART_Rectangle" Width="116" Margin="3,3,3,3" HorizontalAlignment="Center" RadiusX="7" RadiusY="7">
                  <Rectangle.Style>
                    <Style TargetType="{x:Type Rectangle}">
                      <Setter Property="Fill" Value="{DynamicResource ContentOutofFocusBrush}"></Setter>
                    </Style>
                  </Rectangle.Style>
               </Rectangle>
              </Border>
             <ContentPresenter x:Name="content" HorizontalAlignment="Center"  VerticalAlignment="Center" Content="{TemplateBinding Content}" />
           </Grid>
           <ControlTemplate.Triggers>
             <Trigger Property="IsMouseOver" Value="True">
               <Setter TargetName="PART_Rectangle" Property="Fill" Value="{DynamicResource ActiveItemBrush}" />
             </Trigger>
           </ControlTemplate.Triggers>
         </ControlTemplate>
      </Setter.Value>
  </Setter>
</Style>
</Window.Resources>
   <Grid>
     <ContentControl Style="{StaticResource MouseOverContentControlStyle}">
       <TextBlock Text="Hello World!" />
     </ContentControl>
   </Grid>
</Window> 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-01T09:14:32.957

你不需要在你的边框内有一个矩形。改变边框的背景，你会得到相同的结果。然后将 ContentPresenter 放在该边框内，并在边框上设置 MouseOver 处理程序，它应该可以正常工作。

# matlab - 在matlab中修改子图轴

> ID：10392887
> 
> 赞同：1
> 
> 时间：2012-05-01T02:34:24.330
> 
> 标签：matlab, matlab-figure

我正在绘制 2 个子图，并且我希望每个子图具有不同的轴缩放比例。

我目前的代码是：

```
subplot(2,1,1)
axis([0 20 0 1])
plot(t,Ca,'-.',t,Cb,'.',t,Cc);

subplot(2,1,2)
axis([0 5 0 1]);
plot(t2,Ca2,'-.',t2,Cb2,'.',t2,Cc2); 
```

但是两个子图都像没有指定轴一样绘制。有任何想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-01T02:40:25.080

尝试：

```
subplot(2,1,1)
plot(t,Ca,'-.',t,Cb,'.',t,Cc);
axis([0 20 0 1])

subplot(2,1,2)
plot(t2,Ca2,'-.',t2,Cb2,'.',t2,Cc2);
axis([0 5 0 1]); 
```

plot 将重新调整轴，因此您必须在最后一个绘图之后调用轴。

# cpu-registers - 在调用约定中使用非易失性寄存器有什么好处？

> ID：10392895
> 
> 赞同：3
> 
> 时间：2012-05-01T02:35:19.797
> 
> 标签：cpu-registers, calling-convention

我正在编写一个 JIT 编译器，我惊讶地发现这么多 x86-64 寄存器在 Win64 调用约定中是非易失性的（被调用者保留）。在我看来，非易失性寄存器只是在所有可以使用这些寄存器的功能中完成更多的工作。在您希望在叶函数中使用许多寄存器的数值计算的情况下，这似乎尤其正确，比如某种高度优化的矩阵乘法。但是，例如，16 个 SSE 寄存器中只有 6 个是易失性的，因此如果您需要使用更多的内容，您将需要做很多溢出操作。

所以，是的，我不明白。这里的权衡是什么？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-01T02:46:14.657

如果寄存器是调用者保存的，那么调用者*总是*必须在函数调用周围保存或重新加载这些寄存器。但是如果寄存器是被调用者保存的，那么被调用者只需要保存它使用的寄存器，并且只有当它知道它们将被使用时（即在提前退出场景中可能根本不需要）。*这种*约定的缺点是被调用者不知道调用者，所以它可能会保存无论如何都死的寄存器，但我想这被视为一个较小的问题。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2017-11-09T16:30:15.027

只有 6 个调用破坏的 xmm 寄存器的 Windows x86-64 调用约定不是一个很好的设计，你是对的。大多数 SIMD（以及许多标量 FP）循环不包含任何函数调用，因此它们从将数据保存在调用保留寄存器中没有任何收获。保存/恢复是纯粹的缺点，因为它的任何调用者都很少使用这种非易失性状态。

在 x86-64 System V 中，所有向量寄存器都被调用破坏，这可能是另一种方式太远了。在许多情况下，保留 1 或 2 个调用会很好，特别是对于进行一些数学库函数调用的代码。（[用来`gcc -fno-math-errno`让简单的内联更好](https://stackoverflow.com/questions/29854256/why-does-compiler-generate-additional-sqrts-in-the-compiled-assembly-code)；有时他们不这样做的唯一原因是他们需要设置`errno`NaN。）

相关：[如何选择 x86-64 SysV 调用约定](https://stackoverflow.com/a/35619528/224132)：查看 gcc 编译 SPECint/SPECfp 的代码大小和指令数。

* * *

对于整数 regs，**每个都有一些肯定是好的**，并且所有“正常”调用约定（对于所有架构，不仅仅是 x86）实际上都有混合。 **这减少了调用者和被调用者合并完成的溢出/恢复工作总量。**

强制调用者在每个函数调用周围溢出/重新加载所有内容对代码大小或性能不利。在函数的开始/结束时保存/恢复一些调用保留的 reg 可以让非叶函数将一些东西保存在跨`call`s 的寄存器中。

考虑一些计算几件事然后执行`cout << "result: " << a << "foo" << b*c << '\n';` That's 4 函数调用的代码`std::ostream operator<<`，它们通常不会内联。将您刚刚计算的地址`cout`和本地变量保存在非易失性寄存器中意味着您只需要一些便宜`mov reg,reg`的指令来为下一次调用设置参数。（或`push`在堆栈参数调用约定中）。

但是拥有一些可以在不保存的情况下使用的调用破坏寄存器也非常重要。不需要所有架构寄存器的函数可以只使用调用破坏寄存器作为临时寄存器。这避免了在调用者的依赖链（对于非常小的被调用者）的关键路径中引入溢出/重新加载，以及保存指令。

有时，一个复杂的函数会保存/恢复一些调用保留的寄存器，只是为了获得更多的总寄存器（就像你在 XMM 中看到的数字运算一样）。这通常是值得的；保存/恢复调用者的非易失性寄存器通常比将自己的局部变量溢出/重新加载到堆栈更好，特别是如果你必须在任何循环中这样做。

* * *

call-clobbered 寄存器的另一个原因是，通常你的一些值在函数调用之后是“死的”：你只需要它们作为函数的参数。在调用破坏寄存器中计算它们意味着您不必保存/恢复任何内容来释放这些寄存器，而且您的被调用者也可以自由使用它们。这在调用在寄存器中传递 args 的约定时甚至更好：您可以直接在 arg 传递寄存器中计算输入。（如果在函数之后还需要它们，请将它们复制到保留调用的 regs 或将它们溢出到堆栈内存。）

（我喜欢 call-preserved vs. call-clobbered 这两个术语，而不是 caller-saved vs. callee-saved。后一个术语暗示有人必须保存寄存器，而不是让死值死掉。易失性/非易失性是不错，但这些术语也有其他技术含义，如 C 关键字，或闪存与 DRAM。）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-01-16T08:04:45.900

`nonvolatile`拥有寄存器的好处是：**性能**。

移动的数据越少，CPU 的效率就越高。

`volatile`寄存器越多，CPU 需要的能量就越多。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2021-03-28T19:21:51.503

被调用者只需要保存/恢复被调用者保存的（非易失性，调用保留）寄存器，它需要暂时更改值（其中一些可能不会被堆栈链/堆栈跟踪中的任何调用者使用，但被调用者没有不知道这一点），调用者只需要保存/恢复调用者保存的（易失性，调用破坏）寄存器，它在调用之后需要（未来堆栈链中的被调用者可能实际上不会修改，但调用者不会不知道这个）。

通常，[至少在 Microsoft x64 调用约定上](https://stackoverflow.com/questions/23981391/how-exactly-does-the-callstack-work/61157110#61157110)，您会在堆栈上看到很多显式保存的非易失性寄存器，但没有显式保存的易失性寄存器——我认为这个想法是编译器永远不会到达调用者需要显式保存的阶段调用前的寄存器，尤其是在程序本身中不是变量的表达式；相反，它可以提前计划并避免完全使用这些寄存器，使用寄存器但不优化堆栈中的变量后备存储，将寄存器用于传递给被调用函数的参数，这些参数在调用被调用函数后由于它们不是而死t 在程序中定义为变量，或使用易失性寄存器。

被调用者在函数序言中显式地推送它需要保持修改的任何非易失性寄存器，并在函数序言中对堆栈进行调用，并在结尾处恢复它们。它可以将它们保存在易失性寄存器中，但如果被调用函数自己调用并且不能将其存储在另一个非易失性寄存器，因为那样该寄存器也需要保存。

我同意调用者保存意味着无论调用者是否使用它都需要保存寄存器。这不是真的，即使它确实使用了寄存器，甚至可能不必保存寄存器，因为它知道在调用之后它不需要它，或者可能根本不进行调用。

有一个平衡的平衡是很好的。拥有一个而没有其他只是一个缺点，但有时最好偏向一种类型，例如非易失性，其中该寄存器可能主要用于被调用函数而不是调用者功能，就像彼得建议的`xmm`寄存器一样。

我认为拥有所有非易失性寄存器比拥有所有非易失性寄存器更有害，因为您将保存调用后可能在调用者中死亡的参数（这就是参数易失性的原因；此外，保留返回值寄存器是不可能，因此您必须为此至少有一个易失性寄存器或在堆栈上返回值，这会更慢），并且您也无法在不将值保存到堆栈的情况下暂时修改寄存器，因为有只有非易失性寄存器可用，而如果它们都是易失性寄存器，则您可以将值存储在寄存器中，直到进行调用或根本没有调用。总会有一个调用函数（除非它是基本框架），但是叶函数比基本框架要多得多，

如果所有寄存器都是易失的，这仍然是一个缺点，因为非易失寄存器可以更容易地编译您自己的应用程序，因为被调用函数的负担可能在某些单独编译的库中。此外，由于在制作*陷阱帧*时保存了*所有*易失性寄存器而不是非易失性寄存器（[至少在 Microsoft x64 调用约定中就是这种情况](https://stackoverflow.com/questions/61807325/child-ebp-vs-child-sp/66828424#66828424)，除非有异常或上下文切换），因此会有更多的时间/空间损失如果所有寄存器都是易失的，则用于常规系统调用。

# java - 确定一个球体是否被放置在它周围的其他球体完全包围

> ID：10392896
> 
> 赞同：6
> 
> 时间：2012-05-01T02:35:22.237
> 
> 标签：java, algorithm, 3d

**问题：**给定一个球体列表，找出所有被球体完全包围的空白空间。

**细节：**这是我正在研究的一个问题，我试图确定蛋白质中的空洞。我得到了组成蛋白质的原子列表（（x，y，z）坐标和半径）。然后我运行我的算法，通过检查（给定半径的）探针是否可以放置在不与其他球体碰撞的位置来查找位于蛋白质边界内的所有空白空间。有两种类型的空间，空隙空间和空腔。空隙空间是可以通向蛋白质或位于蛋白质外部的空间。空腔是完全被蛋白质原子包围的空白空间。这是我们正在使用的样本“蛋白质”的图像。

![蛋白质](../Images/1b8c5f97b8e65cf6373af300b591759f.png)

[在这里](http://samuelmaddock.com/protein/)可以从三个维度来看。

在蛋白质的中心附近有一个空腔，你看到的穿过蛋白质的隧道将被认为是一个空隙空间，因为它没有被原子完全包围。

**示例：**给定一个包含 26 个原子的列表，这些原子在 3 维网格中从 (0,0,0) 到 (1,1,1) 均匀分布。每个原子的半径为 0.25，并位于任意轴上的 0、0.5 或 1 上。在点 (0.5, 0.5, 0.5) 没有原子。如果我们要绘制这些原子的 3D 图形，它将是一个没有中心的立方体形状。空腔将指定为 (0.5,0.5,0.5)，半径为 0.25。可以假设这个空腔四面都是蛋白质。

示例图片：![图片](../Images/28a495516e90ba31c94445d06c05aadc.png)

请注意，以上只是立方体和蛋白质的二维表示。它实际上是 3D。

对于更大且形状不规则的原子组，如何确定空隙空间与空腔？

我正在考虑实现一个递归算法来检查每个方向以查看它是否可以达到图形的最大和最小边界，但我不确定这是否是正确的方法。

**额外：**是否有不同的算法会说示例中的空腔实际上是一个空隙空间，因为到达蛋白质外部的“路径”非常小？空腔必须*完全*被原子包围才能存在。任何具有通往蛋白质外部的路径（在任何方向，不一定是直的）的空隙都不会被视为空腔。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-01T03:55:50.503

很酷的问题。这是一个可以解决问题的算法：

### 符号：

*   让我们称我们的可移动球体`S`。
*   写出`diam(X)`球体的直径`X`
*   写出从到`dist(X,Y)`的距离；这与从中心到中心的距离减去半径之和相同。`X``Y``X``Y`

### 算法：

1.  对于任意两个不可移动的球`A`和`B`，检查是否`S`可以直接在和的中心之间通过`A`（`B`即是`diam(S) <= dist(A,B)`？）。
2.  如果是，则对于每个其他球体`C`，检查是否`S`可以同时接触所有三个球体`A`、`B`和`C`，如果没有其他球体存在。如果可以同时接触所有 3 个，请在、和`S`的中心之间画一个三角形。 `A``B``C`
    *   这可以通过多种方式进行检查。一种相当简单的方法：`S`同时接触两者`A`并`B`形成一个圆圈的中心的可能位置。`diam(S) + diam(C)`你想知道这个圆上是否有一个离中心小于的点`C`。这是简单的几何。
3.  现在问题归结为问题：三角形是否将中心的初始位置与`S`无穷大分开？您可以一次回答这个连接的组件。事实上，您甚至可以一次回答一个“边连接”组件，如果任何两个非顶点点可以通过不通过任何顶点的路径链接，则该组件是边连接的。您可以通过简单的图形搜索来计算这些组件。
4.  对于给定的边连接组件，您需要确定该组件是否将中心`S`与无穷大分开。有几种方法可以做到这一点：
    *   计算组件的 2-[同](http://en.wikipedia.org/wiki/Homology_%28mathematics%29)调，选择有效的生成器，并为每个生成器询问您的点和无穷大是否在循环的同一侧，这可以使用方向类进行检查。
    *   或者，开始绘制组件：
        *   从一个可以到达的三角形开始`S`，然后绘制从那里可以到达的每个面。这有点微妙，但算法只是“从任何地方开始，排列边缘，将每条边缘交叉到与该边缘形成**最小角度**的面上，并在没有边缘时停止。” 请记住，同一三角形的另一侧可能是形成最小角度的面。
        *   从无穷大做同样的事情。你有没有穿过任何彩绘的三角形？如果是，您的球体可以逃脱。如果没有，它不能。

### 为什么有效

第 3 步是正确的，因为如果您在和`C`之间“滚动”边缘时没有击中任何球体，那么您可以到达该边缘的任何一侧。换句话说，任何阻止你走向无穷远的位置都必须涉及至少接触 3 个球体。`A``B``S`

请注意，“异常”情况会产生一些微妙之处，例如`S`一次接触 4 个球体时。在执行第 3 步和第 4 步之前，您可以通过重新三角化您的形状来避免这些细微之处。

# java - 在 netty 中添加任意连接到我当前的频道

> ID：10392899
> 
> 赞同：0
> 
> 时间：2012-05-01T02:35:55.940
> 
> 标签：java, jboss, netty

我在 Netty 上运行的项目有以下场景：

*   我有一个绑定到“w”的服务器通道
*   我使用本地地址“x”连接到远程地址“y”的主机。
*   我现在需要允许来自远程地址“z”的消息到本地地址“w”，并将它们放在与我的“x”到“y”连接相同的通道/通道管道中。

我基本上需要一个现有通道的 bind('w', 'z') 方法，它将从'z'获取连接并将其包含在我现有的管道中，而不是转到已经绑定在'w'的服务器通道

这在Netty中可能吗？

我能想到的一个（肮脏）解决方案是分别存储这些绑定请求，然后当我的服务器获得相应的连接时，它只会创建一个“转发”处理程序，它将所有内容转发到我的另一个通道。Netty 是否提供了一个更简单的解决方案？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-01T10:44:10.433

我认为您需要某种类似代理的服务。查看示例 [1]。

[1] [https://github.com/netty/netty/tree/3/src/main/java/org/jboss/netty/example/proxy](https://github.com/netty/netty/tree/3/src/main/java/org/jboss/netty/example/proxy)

# c# - 如何在 c# 中管道 powershell 命令

> ID：10392901
> 
> 赞同：5
> 
> 时间：2012-05-01T02:36:21.777
> 
> 标签：c#, .net, powershell, exchange-server

目标是获得 Exchange 2010 站点的最小数据库，因此我尝试从 c# 运行以下 powershell 命令，

```
Get-MailboxDatabase -server Exchange2010 -Status | select-object Name,DatabaseSize 
```

我正在努力的问题是 - 如何管道 Select 子句命令。

这是我的尝试，

```
WSManConnectionInfo wsConnectionInfo = new WSManConnectionInfo(new Uri("https://" + ExchangeSite + "/powershell?serializationLevel=Full"),
    "http://schemas.microsoft.com/powershell/Microsoft.Exchange", getCredential());
wsConnectionInfo.AuthenticationMechanism = AuthenticationMechanism.Basic;
wsConnectionInfo.SkipCACheck = true;
wsConnectionInfo.SkipCNCheck = true;

rsRemoteRunspace = RunspaceFactory.CreateRunspace(wsConnectionInfo);
rsRemoteRunspace.Open();
Pipeline pipeLine = rsRemoteRunspace.CreatePipeline();

Collection<PSObject> DatabaSize = null;

Command myCommand = new Command("Get-MailboxDatabase");
myCommand.Parameters.Add("Server", "Exchange2010");
myCommand.Parameters.Add("Status", null);
Command myCommand2 = new Command("Select-Object");
    myCommand.Parameters.Add("Name");
myCommand.Parameters.Add("DatabaseSize");
pipeLineMB.Commands.Add(myCommand);
pipeLineMB.Commands.Add(myCommand2);
DatabaSize = pipeLine.Invoke(); 
```

但我得到，

```
"A parameter cannot be found that matches parameter name 'Name'." 
```

请记住，我不能使用 SnapIn，因为代码必须在执行 Exchange 服务器上的 cmdlet 的客户端计算机上运行。

欢迎任何建议。

**编辑**

我应用了 yamen 建议的修复程序，并且可以调用该命令，但是当我尝试获取该值时，我得到：“对象引用未设置为对象的实例。”

![例外](../Images/1e0a3d71d80c3ef70fd9fbe4f4cc1290.png)

请注意，我可以获取 Servername 和 Name 的值，但它在 DatabaseSize 中失败，所以我猜 'Status' 标志未正确设置，因为该标志是启用此值的标志。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-01T03:37:37.193

你的意思是这样的：

```
Command myCommand2 = new Command("Select-Object");
myCommand2.Parameters.Add("DatabaseSize"); 
```

而不是这个：

```
Command myCommand2 = new Command("Select-Object");
myCommand.Parameters.Add("DatabaseSize"); 
```

注意`myCommand2`第二行？

无论如何，您可能会发现您实际使用的参数是`Property`：

```
myCommand2.Parameters.Add("Property", "DatabaseSize"); 
```

不止一个：

```
var props = new string[] { "DatabaseSize", "ServerName", "Name" };
myCommand2.Parameters.Add("Property", props); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-01T03:19:05.157

我刚试过这个，有一个类似的场景

```
dir | select Name 
```

它不起作用。给我同样的错误，说“名称”不是有效参数。然后我尝试了以下方法，它有效

```
dir | select -first 3 
```

翻译成

```
 Runspace runspace = RunspaceFactory.CreateRunspace();
        runspace.Open();
        Pipeline pipeline = runspace.CreatePipeline();
        Command dir = new Command("dir");
        pipeline.Commands.Add(dir);
        Command select = new Command("select");
        select.Parameters.Add("first", 3);
        pipeline.Commands.Add(select); 
```

你需要找到参数的名称`DatabaseSize`，我猜是它的值。

# playn - html渲染和速度问题

> ID：10392902
> 
> 赞同：2
> 
> 时间：2012-05-01T02:36:22.213
> 
> 标签：playn

我正处于游戏开发的早期阶段。我正在使用图像通过在表面上绘制一块较大的图像来创建动画。这是一个代码示例：

```
void drawNextFrame() {
    //surf.canvas().clear();
    surf.clear();
    float startX = entity.flipH ? entity.width : 0;
    float endX = entity.flipH ? -entity.width : entity.width;
    float width = entity.width;
    float height = entity.height;
    //surf.canvas().drawImage(image, 0, 0,
    surf.drawImage(image, 0, 0,
            width, height, 
            (width * curFrame) + startX, 0, 
            endX, height);
} 
```

`surf`是表面，`SurfaceLayer`是`image`资产`Image`。该游戏的 Java 版本运行良好，流畅且响应迅速，不会丢帧或出现任何渲染问题。我在使用 HTML 版本时遇到了问题，它看起来很慢并且在动画中丢了很多帧。例如，我有一个循环播放器的运行动画，看起来 HTML 版本在播放器变为空白之前只播放一次动画。跳跃或触发一些其他动画可以修复它，这样我就可以再次播放运行动画，但在将角色变为空白之前，它仍然不会播放动画循环的一次迭代。我也无法`surf.clear()`持续发射，有时框架会堆叠在一起。

我已经进行了各种调试，以确保我不会太快地绘制框架。我没有触及paint() 方法。我尝试切换到`SurfaceLayer`，`CanvasLayer`虽然这似乎稍微改变了我遇到的渲染问题类型以及它们何时发生的行为，但它仍然是一种非常无法播放的体验。此外，例如，当玩家面朝后时，它无法创建我的图像的镜像。我为上面的 Canvas 版本包含了注释掉的代码——在这种情况下`surf`是`CanvasImage`. 除了绘制这些动画之外，我还在使用 Box2D，如果这会有所不同的话。

**我的问题是：这正常吗？我是唯一一个遇到这些类型问题的人吗，有没有人找到解决方法？**我只是想确保我没有做错什么并且我正在采取的方法是有效的。

我正在使用 PlayN 1.2 分支的相当现代的机器上使用 Chrome 进行测试。我使用以下命令通过 Maven 从命令行构建和测试我的项目的 HTML 版本：

```
mvn clean
mvn install
mvn test -Ptest-html 
```

然后我用 Chrome浏览到[http://localhost:8080 。](http://localhost:8080)

我遇到的另一个问题是刷新页面并不总是重新加载我的游戏。我已经实现了一个 AssetWatcher 以确保在开始之前一切都可用并且它工作一次，通常在我清除浏览器缓存并重新启动 Chrome 之后，但是在那之后如果刷新加载游戏我很幸运。通常我必须重复清除缓存的过程，重新启动浏览器再次测试。

我知道我在没有提供大量代码的情况下提出了很多问题，但是我在 SVN 在线存储库中拥有所有内容，并且很乐意向任何愿意查看的人开放它。

任何帮助表示赞赏！感谢您的时间！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-01T05:10:05.980

你看过 PlayN 样本吗？[尤其是CuteGame](http://code.google.com/p/playn-samples/source/browse/cute/core/src/main/java/playn/sample/cute/#cute/core)，似乎它可能是相关的。看：

*   [游戏类立即层渲染器](http://code.google.com/p/playn-samples/source/browse/cute/core/src/main/java/playn/sample/cute/core/CuteGame.java#127)
*   [可爱的世界绘制方法](http://code.google.com/p/playn-samples/source/browse/cute/core/src/main/java/playn/sample/cute/core/CuteWorld.java#144)（由游戏类中的渲染器调用）
*   [可爱的世界paintObjects方法](http://code.google.com/p/playn-samples/source/browse/cute/core/src/main/java/playn/sample/cute/core/CuteWorld.java#444)（由paint调用）

# asp.net-mvc - 将 ASP.NET MVC 模型绑定引入 ASP.NET WebForm

> ID：10392905
> 
> 赞同：1
> 
> 时间：2012-05-01T02:36:54.410
> 
> 标签：asp.net-mvc, webforms, dry, model-binding, single-responsibility-principle

在 ASP.NET MVC 中，在 [HttpPost] 方法上，MVC 运行时会根据字段名称自动将数据从前端的表单字段映射并传输到视图模型中。

如何在 ASP.NET WebForm 中完成同样的事情？

例如，我有一个名为 Person 的对象，具有 FirstName 和 LastName 属性。

我有一个 WebForm 页面，其中的 Textbox 控件分别带有 FirstName 和 LastName。

在表单上按下提交时，有没有办法在代码隐藏的 Button_Click 事件中自动将 FirstName 和 LastName 绑定到 Person 对象？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-01T03:03:43.540

ASP.net 4.5 实际上将内置 Web 窗体模型绑定。

顾有一个帖子和其他一些东西在这里......

[http://weblogs.asp.net/scottgu/archive/2011/09/05/web-forms-model-binding-part-1-selecting-data-asp-net-vnext-series.aspx](http://weblogs.asp.net/scottgu/archive/2011/09/05/web-forms-model-binding-part-1-selecting-data-asp-net-vnext-series.aspx)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-12-22T03:54:12.047

您可以使用模型绑定在 webforms v4.5 中执行此操作。这是一种我们称之为 Ad-Hoc 模型绑定的方式，您可以在不使用数据绑定控件（如 formview）的情况下绑定到控件。我打算写一篇关于它的博客，但下面的代码简短地描述了这个博客

以下是您的标记的外观。我的模型有 2 个属性：名称和描述

```
Name<input type="text" name="Name" value=" " id="Name"      />   
<br />

Description<input type="text" name="Description" value=" " id="Description"    />
<br />
<asp:Button Text="Submit" runat="server" OnClick="Unnamed_Click" /> 
```

以下是按钮单击处理程序中的代码。类别是我的模型。在这种情况下，模型绑定系统从表单值提供者中提取值，该提供者在表单集合中查找。

```
var category = new Category();
var formValueProvider = new FormValueProvider(ModelBindingExecutionContext);            

TryUpdateModel(category, formValueProvider);

if (ModelState.IsValid)
{
     // save changes to database
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-01T03:00:34.760

也许最简单的方法是在 Page_Load 事件中显式分配值，只要它是回发。像这样的东西：

```
if (this.IsPostBack)
{
    person.FirstName = FirstNameTextBox.Text;
    person.LastName = LastNameTextBox.Text;
} 
```

或者您是否正在寻找一种更具声明性的方法？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-12T21:19:23.473

看看[ASP.NET Web 窗体的模型绑定器](http://webformsmodelbinder.codeplex.com/)。它正在做你想做的事 - 通过应用于其属性的自定义属性将回发数据映射到类。

# javascript - 自定义 Javascript 警报？

> ID：10392906
> 
> 赞同：1
> 
> 时间：2012-05-01T02:37:08.060
> 
> 标签：javascript, jquery, html, css

是否可以自定义 javascript 警报？我想提醒我的联系表单验证。这是可能的还是我只是在做梦......如果是这样，我会很乐意帮助制作一个或一个 jsfiddle 示例！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-01T02:39:36.970

警报框是特定于浏览器的，不能修改。

你最好的选择是使用类似 jQuery UI 对话框的东西。

[http://jqueryui.com/demos/dialog/](http://jqueryui.com/demos/dialog/)

这是一个非常简单的例子......

[http://jsfiddle.net/jcreamer898/c4RNq/](http://jsfiddle.net/jcreamer898/c4RNq/)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-01T02:43:16.467

您可以重写 alert() 函数并将其放入任何 jQuery 弹出插件，例如 jQuery UI Dialog

```
window.alert = function(message){
               $( "#dialog-message" ).html("<p>"+ message + "</p>");
               $( "#dialog-message" ).dialog({
            modal: true,
            buttons: {
                Ok: function() {
                    $( this ).dialog( "close" );
                }
            }
        });

} 
```

# ruby-on-rails - Rails 应用程序部署问题

> ID：10392910
> 
> 赞同：0
> 
> 时间：2012-05-01T02:38:36.437
> 
> 标签：ruby-on-rails, apache, centos, passenger

我有一个虚拟专用服务器（centos 5），有两个 IP 地址和一个与其中一个关联的域名。我正在尝试通过 Apache + Passenger 部署 Rails 应用程序。在通常的安装和配置之后，我得到了这个奇怪的结果：1）如果我使用辅助 IP 地址浏览并激活控制器操作，一切正常。2）如果我在浏览器中使用主IP地址或域名，结果是“找不到文档”

任何可能的提示/帮助？谢谢安东尼奥

* * *

Apache虚拟主机配置：

VirtualHost *:80
ServerName www.mysitename.com
DocumentRoot /var/.../appname/public
Directory /var/......./appname/public
AllowOverride all
Options -Multiviews

Apache httpd.conf 文件中没有对辅助 IP 地址的引用。

感谢您提供有用文档的链接。

安东尼奥

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-01T03:16:29.193

应用程序的 apache 配置是什么？此行为最可能的原因是 apache 配置绑定到辅助 ip 地址。

请参阅[此](http://httpd.apache.org/docs/2.0/mod/core.html#virtualhost)更改 apache 的 ip 设置。

# android - 单击状态栏中的通知时如何启动活动“ViewMessageListActivity”

> ID：10392912
> 
> 赞同：0
> 
> 时间：2012-05-01T02:39:00.450
> 
> 标签：android

当我收到一条短信时，当我单击状态栏中的短信通知时，我在状态栏中看到短信通知，它没有打开 ViewMessageListActivity（我的对话日志）。如何打开此活动。

```
import android.content.BroadcastReceiver;
import android.content.Context;
import android.content.Intent;
import android.os.Bundle;
import android.telephony.gsm.SmsMessage;
import android.widget.Toast;

import android.app.Notification;
import android.app.NotificationManager;
import android.app.PendingIntent;

import android.app.Activity;
import android.app.Notification;
import android.app.NotificationManager;
import android.app.PendingIntent;
import android.content.Intent;
import android.os.Bundle;
import android.view.View;

public class SmsReceiver extends BroadcastReceiver {

static final String ACTION = "android.provider.Telephony.SMS_RECEIVED";
int notificationID = 1;

@Override
public void onReceive(Context context, Intent intent) 
{

       NotificationManager mNotificationManager = 
      (NotificationManager) context.getSystemService(Context.NOTIFICATION_SERVICE);
        if (intent.getAction().equals(ACTION)) {

            StringBuilder sb = new StringBuilder();
            String from = new String();
            String body = new String();

            Bundle bundle = intent.getExtras();
            if (bundle != null) {
                Object[] pdus = (Object[]) bundle.get("pdus");
                for (Object pdu : pdus){
                SmsMessage messages = SmsMessage.createFromPdu((byte[]) pdu);
                sb.append(messages.getDisplayOriginatingAddress());
                from = messages.getDisplayOriginatingAddress();
                sb.append(messages.getDisplayMessageBody());
                body= messages.getDisplayMessageBody();

                //Log.i(LOG_TAG, "[SMSApp] onReceiveIntent: " + sb);
                //abortBroadcast();
                }// end for
            }//end if

            int icon = R.drawable.stat_notify_sms;
            CharSequence tickerText = from + ": " + body;
            long when = System.currentTimeMillis();

            Notification notification = new Notification(icon, tickerText, when);
            CharSequence contentTitle = "New Cybernetx Secure Text Message";
            CharSequence contentText = from + " " + body;

            Intent notificationIntent = new Intent();
            PendingIntent contentIntent = 
            PendingIntent.getActivity(context, 0, notificationIntent, 0);

            notification.setLatestEventInfo(context, contentTitle, contentText, contentIntent);
            notification.vibrate = new long[] { 100, 250, 100, 500};
            notification.flags |= Notification.FLAG_AUTO_CANCEL;
            mNotificationManager.notify(notificationID, notification);

            //    intent.setAction(SendReceiveService.RECEIVE_SMS_ACTION);
           //     intent.setClass(arg0, ViewMessageListActivity.class);
           //     intent.putExtra("notificationID", notificationID);
           //     arg0.startService(intent);

               // PendingIntent contentIntent =
               //     PendingIntent.getActivity(arg0, 0, i, 0);

            /* Start the Main-Activity */
            Intent i = new Intent(context, ViewMessageListActivity.class);
            i.setFlags(Intent.FLAG_ACTIVITY_NEW_TASK);
            context.startActivity(i); 

        }//end if

   } 
```

}

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-01T02:47:49.890

您需要为`ViewMessageListActivity`活动创建意图。

```
Intent notificationIntent = new Intent(context,ViewMessageListActivity.class);
PendingIntent contentIntent =PendingIntent.getActivity(context, 0, notificationIntent, 0);
.... 
```

并删除最后三个语句。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-01T02:51:51.190

你`notificationIntent`是空的，这是问题所在。假设 ViewMessageListActivity 是你的尝试：

```
Intent notificationIntent = new Intent(context, ViewMessageListActivity.class); 
```

这是我在 Play 商店中的一个应用程序中的一个更完整的示例（所以我知道它有效 :-D）：

```
notification.setLatestEventInfo(NotificationService.this, getResources().getString(R.string.app_name), "Select to launch", IntentUtils.getMainActivityPendingIntent(this)); 
```

IntentUtils 是我使用的一个辅助类，最终成为：

```
public static Intent getMainActivityIntent(Context context) {
    return new Intent(context, MainActivity.class);
}

public static PendingIntent getMainActivityPendingIntent(Context context) {
    return PendingIntent.getActivity(context, 0, getMainActivityIntent(context), 0);
} 
```

这与我最初发布的内容几乎相同。

# c - gdb 中 c 数组名称的类型

> ID：10392919
> 
> 赞同：0
> 
> 时间：2012-05-01T02:40:05.003
> 
> 标签：c, arrays

```
int arr[4][2][3][6]; 
```

当运行 gdb 来检查 arr 的类型时（数组名）

```
(gdb) wha arr
type = int [4][2][3][6] 
```

据我所知，在表达式中（例如用作“sizeof”或“&”的操作数）时，编译器将数组名视为指向数组第一个元素的指针。所以，我期待`type = int (*)[2][3][6]`

有趣的是，如果我检查这个：

```
(gdb) wha arr+1
type = int (*)[2][3][6] 
```

您会看到输出符合预期！这里我想知道它只是gdb的一种显示风格还是数组名称的类型真的是`int [4][2][3][6]`？

顺便说一句，我猜为什么 gdb 说类型是`int [4][2][3][6]`，你看，

```
(gdb) wha &arr
type = int (*)[4][2][3][6] 
```

所以， is`&arr`是指向`int [4][2][3][6]`然后 arr 应该是`int [4][2][3][6]`....

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-01T03:26:28.757

当您在需要指针的上下文中使用时，编译器将该名称用作指向第一个元素的指针。但是 gdb 关于您传递的符号的实际类型是正确的。

arr+1 是 &arr[1]，它是指向所示 3 维数组的指针。

arr 本身就是一个数组；即一个4维数组。

# python - 方法中的HttpResponseRedirect，当方法不返回时，不能使用“return method(req)”作为其给出的错误

> ID：10392921
> 
> 赞同：0
> 
> 时间：2012-05-01T02:40:19.623
> 
> 标签：python, django

我的代码是这样的：

```
def check(request):
    if(success):
        #nothing should do
    if(fail):
        return HttpResponseRedirect("http://google.com")

def index(request):
    return check(request)
    #some other taskshere after checking login 
```

我在其他帖子中读到，为了`HttpResponseRedirect`工作，我们必须在调用时返回它，例如：

```
return check(request) 
```

当登录失败时，它可以，但是当登录成功时，方法检查没有返回任何内容，因此给出错误**索引** 方法没有返回`HttpResponse`Object 。有什么解决办法？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-01T02:48:22.733

为此使用 auth 装饰器。

[https://docs.djangoproject.com/en/dev/topics/auth/#the-login-required-decorator](https://docs.djangoproject.com/en/dev/topics/auth/#the-login-required-decorator)

如果您只是必须，有多种方法。您可以按照您的描述进行操作：

```
def index(request):
    auth_situation = check(request)

    if auth_situation is None:               
       # some other tasks here, render a template,
       # redirect, do something, man!
    else:
       return auth_situation 
```

# php - 监控 php://stdin 缓冲区的大小

> ID：10392925
> 
> 赞同：2
> 
> 时间：2012-05-01T02:40:31.680
> 
> 标签：php, command-line-interface, stdin

`STDIN`我有一个从.php CLI 快捷方式读取的脚本`php://input`。我可以查看流中剩余的数据量吗？

我正在将日志传送到脚本，我需要一种方法来确定脚本是否太慢以及是否存在积压的传入记录。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-03T02:43:49.213

如果您在 Windows 和 PHP <= 5.4.1 上，则不能。PHP 仅使用阻塞 Windows API，这意味着您可以在 STDIN 上进行阻塞读取，或者希望缓冲区未满，从而阻塞生产者。

有关针对它提交的 PHP 错误列表，请参阅[PHP CLI 中 STDIN 上的非阻塞。](https://stackoverflow.com/questions/9356152/non-blocking-on-stdin-in-php-cli)

# eclipse - 是否可以在“显示视图”菜单中创建子文件夹？

> ID：10392927
> 
> 赞同：0
> 
> 时间：2012-05-01T02:40:54.127
> 
> 标签：eclipse, eclipse-plugin

假设我有一些名为“我的视图”的视图。我知道我可以创建一个类别“我的类别”，并将我的视图放在其中。我想在“我的类别”中创建一个名为“子文件夹”的子文件夹/类别，并将我的视图放在其中。然后将通过“显示视图”弹出窗口找到视图，如下所示：

我的类别 -> 子文件夹 -> 我的视图

我知道你可以通过导出/导入来做到这一点，但你似乎不能通过视图来做到这一点。

这是一个示例 plugin.xml

```
<?xml version="1.0" encoding="UTF-8"?>
<?eclipse version="3.4"?>
<plugin>
   <extension
         point="org.eclipse.ui.views">
      <category
            name="My Category"
            id="My_Category">
      </category>
      <category
            id="My_Sub_Folder"
            name="Sub Folder"
            parentCategory="My_Category">
      </category>
      <view
            name="My View"
            icon="icons/sample.gif"
            category="My_Sub_Folder"
            class="sample_plugin.views.SampleView"
            id="sample_plugin.views.SampleView">
      </view>
   </extension>
</plugin> 
```

但是，当我使用上面的 plugin.xml 时，视图类别不显示，视图在“其他”类别中找到。如果我将视图类别改回“My_Category”，该视图将显示在父类别中。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-01T04:38:06.537

（修改后的答案）

您可以设置父类别层次结构，但“显示视图”菜单不会遵守这一点。

[https://bugs.eclipse.org/bugs/show_bug.cgi?id=92894](https://bugs.eclipse.org/bugs/show_bug.cgi?id=92894)

所以答案实际上是否定的。

这是有关设置无用父类别的文档：

[http://help.eclipse.org/helios/topic/org.eclipse.platform.doc.isv/reference/extension-points/org_eclipse_ui_views.html](http://help.eclipse.org/helios/topic/org.eclipse.platform.doc.isv/reference/extension-points/org_eclipse_ui_views.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-09T21:48:43.873

可能是您使用的包资源管理器。切换到导航器（window-->show view ---> other -------> Navigator）

现在您可以将项目视为文件夹而不是包。

# .htaccess - 移动重定向不适用于 Joomla 网站

> ID：10392932
> 
> 赞同：1
> 
> 时间：2012-05-01T02:41:31.987
> 
> 标签：.htaccess, joomla, seo

我有 2 个网站，一个是常规的（用于台式机），另一个是为移动设备设计的。它们都有相同的内容，但移动网站是为手机设计的（iphone、黑莓等）

这是我正在寻找的：

当用户在移动设备上到达我的站点时，将自动重定向到移动版本。在移动版本上，我有一个链接，上面写着“查看完整的 html”，当他们单击该链接时，无论他们使用什么设备（桌面、iPhone 或其他设备），他们都会被发送到该网站的完整版本

使用 Litespeed 网络服务器。

我无法通过 HTACCESS 让它工作。这是我的 .htacess 的样子：

```
Options -Indexes
RewriteEngine On
RewriteBase /

#Added the rule below so that redirecting to the index.php does not operate on the mobile site
RewriteCond %{HTTP_HOST}          !^m\.

RewriteCond %{REQUEST_URI} ^(/component/option,com) [NC,OR]
RewriteCond %{REQUEST_URI} (/|\.htm|\.php|\.html|/[^.]*)$  [NC]
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteRule (.*) index.php

# Check if mobile=1 is set and set cookie 'mobile' equal to 1
RewriteCond %{QUERY_STRING} (^|&)mobile=1(&|$)
RewriteRule ^ - [CO=mobile:1:%{HTTP_HOST},S]

# Check if mobile=0 is set and set cookie 'mobile' equal to 0
RewriteCond %{QUERY_STRING} (^|&)mobile=0(&|$)
RewriteRule ^ - [CO=mobile:0:%{HTTP_HOST},S]

# cookie can't be set and read in the same request so check
RewriteCond %{QUERY_STRING} (^|&)mobile=0(&|$)
RewriteRule ^ - [S=1]

# Check if this looks like a mobile device
RewriteCond %{HTTP:x-wap-profile} !^$ [OR]
RewriteCond %{HTTP_USER_AGENT} "android|blackberry|iphone|ipod|iemobile|opera mobile|palmos" [NC,OR]
RewriteCond %{HTTP:Profile}       !^$

# Check if we're not already on the mobile site
RewriteCond %{HTTP_HOST}          !^m\.
RewriteCond %{QUERY_STRING} !(^|&)mobile=0(&|$)
# Check to make sure we haven't set the cookie before
RewriteCond %{HTTP_COOKIE}        !\mobile=0(;|$)
# Now redirect to the mobile site
RewriteRule ^ http://m.mysite.com [R,L]

########## Begin - Rewrite rules to block out some common exploits
## If you experience problems on your site block out the operations listed below
## This attempts to block the most common type of exploit `attempts` to Joomla!
#
# Block out any script trying to set a mosConfig value through the URL
RewriteCond %{QUERY_STRING} mosConfig_[a-zA-Z_]{1,21}(=|\%3D) [OR]
# Block out any script trying to base64_encode crap to send via URL
RewriteCond %{QUERY_STRING} base64_encode.*\(.*\) [OR]
# Block out any script that includes a <script> tag in URL
RewriteCond %{QUERY_STRING} (\<|%3C).*script.*(\>|%3E) [NC,OR]
# Block out any script trying to set a PHP GLOBALS variable via URL
RewriteCond %{QUERY_STRING} GLOBALS(=|\[|\%[0-9A-Z]{0,2}) [OR]
# Block out any script trying to modify a _REQUEST variable via URL
RewriteCond %{QUERY_STRING} _REQUEST(=|\[|\%[0-9A-Z]{0,2})
# Send all blocked request to homepage with 403 Forbidden error!
RewriteRule ^(.*)$ 404.html [F,L]
# 
```

我尝试[http://www.mysite.com/?mobile=1](http://www.mysite.com/?mobile=1)并没有发送到移动网站。

这是一个基于 Joomla 1.0 的网站，我安装了 SEO 组件 (sh404sef)，但不确定它是否会导致问题。sh404sef 将 url 翻译为 seo 友好的 url。

可以帮忙吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-01T03:07:53.137

将此代码放入您的 JOOMLA 站点的 INDEX.PHP 中。这段代码可以检测到几乎所有的手机。将 MOBILE.YOURSITE.COM 更改为您想要的网址。

`<script> (function mobileRedirect(a,b){ if(/android.+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|symbian|treo|up\.(browser|link)|vodafone|wap|windows (ce|phone)|xda|xiino/i.test(a)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|e\-|e\/|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(di|rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|xda(\-|2|g)|yas\-|your|zeto|zte\-/i.test(a.substr(0,4))){ window.location=b; } })(navigator.userAgent||navigator.vendor||window.opera,'http://MOBILE.YOURSITE.COM'); </script>`

# firefox - 如何清空firefox dom localstorage

> ID：10392933
> 
> 赞同：10
> 
> 时间：2012-05-01T02:41:35.750
> 
> 标签：firefox, local-storage

我正在尝试[清除 Firefox 13.0 中的本地存储，](https://stackoverflow.com/questions/10392659/lawnchair-nuke-not-working-after-filling-my-storage-quota)以便继续使用 Lawnchair。

在 Firebug [Dom] 选项卡中，我一直在手动从键中[删除属性](https://stackoverflow.com/a/6130392/194309)`'localstorage'`，但每次删除大约需要 10 秒（只需 454 * 10 秒！）。（我希望我可以释放足够的空间让 Lawnchair.nuke() 完成它的工作，但到目前为止还没有。）

我尝试访问[about:config](https://stackoverflow.com/a/3840119/194309)以关闭并重新打开本地存储，但这并没有删除其中的内容。

如何在 Firefox 中批量删除一个网站的本地存储？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2012-05-01T07:29:06.350

打开内置控制台`Ctrl``Shift``K`（比 Firebug 快），粘贴以下代码：

```
while (localStorage.length) localStorage.removeItem(localStorage.key(0)); 
```

此代码段将删除给定网站上的**所有**localStorage 键值对。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2013-03-28T18:28:59.803

```
localStorage.clear(); // Capital S is required. 
```

这将[清除所有键值对](http://dev.w3.org/html5/webstorage/#dom-storage-clear)。

# git - 在 Git 下还原

> ID：10392935
> 
> 赞同：2
> 
> 时间：2012-05-01T02:42:17.967
> 
> 标签：git, git-checkout

当我运行“git checkout”时，我还想删除提交后创建的所有其他文件。

但我找不到路。这是我测试的东西，

我在提交后创建了一个目录`test`并创建了一个文件`test/test.txt`。

然后我运行`git add .`and `git checkout`，但是新的文件和目录没有被删除。

为什么即使我将命令`git checkout`作为回滚，新文件仍然存在？

*怎样才能完全*回到舞台？

感谢您抽出宝贵时间阅读我的问题。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-01T02:56:28.273

查看此线程：[如何将 Git 托管项目中的所有本地更改恢复到以前的状态？](https://stackoverflow.com/questions/1146973/how-to-revert-all-local-changes-in-a-git-managed-project-to-previous-state)

正如 Thr4wn 所指出的，`git reset --hard`它将解决您的特定问题。但是，如上面链接的线程中所述，它不会删除未跟踪的文件：它仅删除您的第二个文件，因为您之前运行过 git add 。

`git clean -fd`似乎是删除您在提交后添加的所有内容的解决方案（这意味着您将丢失所有这些文件）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-01T02:50:32.797

请小心确保我首先理解您的问题，但我相信

```
git reset --hard 
```

是您要查找的命令。

该命令的作用是**不可逆转地擦除**您自上次提交以来所做的所有更改。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-01T14:01:32.277

GIT 的独特和有用的方面之一是您有一个存储库和一个工作目录，它们**不需要**相同。作为开发人员，您经常会同时发生多件事情。几个准备提交的文件；几个文件几乎准备好了，几个文件在那里进行测试，几个文件带有一些注释/想法等。使用 GIT，您可以决定要保存什么以及何时保存。添加并提交您想要的内容。处理其他事情，添加并提交。等等。如果在提交你的东西的过程中你最终得到了你不需要的东西，那么有一个简单的解决方案：

```
git status
rm <trash> 
```

'git status' 让您可以**非常清楚地**看到您决定不添加所创建的内容。并且“rm垃圾”摆脱了被确认为垃圾的东西。

两步总比一步好。

# jquery - jQuery 改进显示/隐藏脚本以包含 fadeToggle

> ID：10392938
> 
> 赞同：1
> 
> 时间：2012-05-01T02:43:36.857
> 
> 标签：jquery, toggle

我有一个脚本，我在网上某处找到了基于单选按钮点击显示或隐藏 div 的脚本。

我试图通过在过渡中添加 fadeToggle() 或 slideToggle() 来改进这一点。但是，当我这样做时，该功能不像以前那样工作。当我单击另一个单选按钮时，它会显示两个 div 并再次隐藏它们。

```
// Show/Hide forms based on radio button selection
$('input[name="screen_type"]').bind('change',function(){
var showOrHide = ($(this).val() == 2) ? true : false;
$('.welcome_screen').toggle(showOrHide);
    var showOrHide = ($(this).val() == 1) ? true : false;
$('.training_screen').toggle(showOrHide);
}); 
```

请在此处查看小提琴 [http://jsfiddle.net/clintongreen/JEbFq/](http://jsfiddle.net/clintongreen/JEbFq/)

谢谢大家的帮助，加油

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-01T02:48:15.360

fadeToggle 和 slideToggle 不带参数显示或隐藏[api doc](http://api.jquery.com/fadeToggle/)

这是一种快速而肮脏的方法：http: [//jsfiddle.net/hzSnU/1/](http://jsfiddle.net/hzSnU/1/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-01T02:55:05.853

试试这个方法：http: [//jsfiddle.net/JEbFq/20/](http://jsfiddle.net/JEbFq/20/)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-01T02:58:19.410

你可以这样做：

```
// Hide lis
    $(".training_screen").hide();
    $(".welcome_screen").hide();    

// Show/Hide forms based on radio button selection
    $('input[name="screen_type"]').bind('change',function(){
        var fnTraining, fnWelcome;
        if ($(this).val() == 1) {
            fnTraining = "slideDown";
            fnWelcome = "slideUp";
        } else {
            fnTraining = "slideUp";
            fnWelcome = "slideDown";
        }
        $('.welcome_screen')[fnWelcome]();
        $('.training_screen')[fnTraining]();
 });​ 
```

工作演示：http: [//jsfiddle.net/jfriend00/4aSbG/](http://jsfiddle.net/jfriend00/4aSbG/)

或者，您可以创建一个带有 show/hide 参数的 slideToggleOption jQuery 方法，并像这样使用它：

```
// Hide lis
    $(".training_screen").hide();
    $(".welcome_screen").hide();    

jQuery.fn.slideToggleOption = function(show /* other optional args from slideToggle */) {
    var args = Array.prototype.slice.call(arguments, 1);
    if (show) {
        return(this.slideDown.apply(this, args));
    } else {
        return(this.slideUp.apply(this, args));
    }
};

// Show/Hide forms based on radio button selection
    $('input[name="screen_type"]').bind('change',function(){
        var showWelcome = ($(this).val() == 1);
        $('.welcome_screen').slideToggleOption(showWelcome);
        $('.training_screen').slideToggleOption(!showWelcome);
 });​ 
```

工作演示：http: [//jsfiddle.net/jfriend00/Lqeqe/](http://jsfiddle.net/jfriend00/Lqeqe/)

# php - 用于生成缩略图的 PHP 代码

> ID：10392939
> 
> 赞同：-3
> 
> 时间：2012-05-01T02:43:37.220
> 
> 标签：php, html

> **可能重复：**
> [如何使用 php 制作缩略图](https://stackoverflow.com/questions/1525528/how-to-make-thumbnails-with-php)

我有一个 php 上传脚本，它使用户能够将图像上传到 ftp 服务器上的文件夹。我正在（如果可能的话）为创建图像缩略图的网页编写一些代码，然后让用户单击这些图像中的每一个并显示完整图像。

我通过 google 找到了一些页面，其中包含对此效果的描述，但还没有找到一种简单的方法来做到这一点。

请帮忙

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-01T02:46:24.363

查看 Timthumb

[http://code.google.com/p/timthumb/](http://code.google.com/p/timthumb/)

例子：

[http://www.binarymoon.co.uk/demo/timthumb-basic/](http://www.binarymoon.co.uk/demo/timthumb-basic/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-01T02:48:14.960

以前没试过这个。查看[ImageMagick](http://www.php.net/manual/en/imagick.resizeimage.php)

```
$image = new Imagick();
$image->setOption('jpeg:size', '800x532');
$image->readImage('foo.jpg'); 
```

# wordpress - 插件安装后添加页面/帖子

> ID：10392947
> 
> 赞同：0
> 
> 时间：2012-05-01T02:44:35.907
> 
> 标签：wordpress

我知道有一些插件在安装后会创建页面或帖子。你怎么做到这一点？

试图研究，但找不到有用的指南。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-01T02:56:36.173

[`wp_insert_post`](http://codex.wordpress.org/Function_Reference/wp_insert_post)WordPress Codex 上的参考资料可能会有所帮助。

以下是如何以编程方式创建新帖子的示例代码：

```
// Create post object
  $my_post = array(
     'post_title' => 'My post',
     'post_content' => 'This is my post.',
     'post_status' => 'publish',
     'post_author' => 1,
     'post_category' => array(8,39)
  );

// Insert the post into the database
  wp_insert_post( $my_post ); 
```

要在激活插件时自动运行此代码，您可以将此代码包装在[`register_activation_hook`](http://codex.wordpress.org/Function_Reference/register_activation_hook)挂钩中。

# javascript - 如何在网页中隐藏敏感信息？

> ID：10392950
> 
> 赞同：2
> 
> 时间：2012-05-01T02:44:56.127
> 
> 标签：javascript, asp.net, json

我正在尝试将包含测验数据[包括答案]的json对象从我的代码发送到javascript。我用了...

```
var quizJson = <%=jsonObj%> 
```

但问题是，我的用户足够聪明，可以使用查看源代码并揭示答案。有什么建议吗？

提前致谢

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-01T02:47:26.867

唯一正确的解决方案是不要以任何形式将答案发送到浏览器。浏览器需要将用户输入的答案发送回服务器。然后您使用服务器端代码来确定答案是否正确。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-05-01T02:46:28.240

当用户选择答案时执行 AJAX 调用。这样，验证将是外部的，用户将无法查看源代码以找到答案。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-05-01T02:49:37.617

任何客户端都可以读取您发送给客户端以用于客户端脚本的任何内容。即使您以某种方式掩盖了源代码中的答案，任何人都可以调出调试器并在您“解码”它们时看到真正的答案。这就像许多经典游戏黑客一样，人们会禁用墙壁并查看过去的内容。您发送给客户的任何东西都是*易受攻击*的！

保护答案的唯一方法是将它们保存在服务器上。将尝试的答案发布到服务器，然后在那里评分并将结果返回给客户端。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-05-01T02:57:46.533

使用简单的加密（像[这样](http://simple.wikipedia.org/wiki/ROT13)）以向用户隐藏文本。如果数据不重要，那么这将推动平均检查。

但是，如果答案对隐藏很重要，那么请将它们隐藏......并且远离客户端。

# protocol-buffers - 如何在协议缓冲区中设计未来的附加枚举值？

> ID：10392952
> 
> 赞同：37
> 
> 时间：2012-05-01T02:45:38.867
> 
> 标签：protocol-buffers

协议缓冲区的吸引人的特性之一是它允许您在不破坏使用旧定义的代码的情况下扩展消息定义。[根据文档](https://developers.google.com/protocol-buffers/docs/proto#enum)，如果是枚举：

> 具有枚举类型的字段只能将指定的一组常量作为其值（如果您尝试提供不同的值，解析器会将其视为未知字段）

因此，如果您扩展枚举并使用新值，则旧代码中具有该类型的字段将未定义或具有其默认值（如果有）。

知道将来枚举可能会增加额外的值，什么是处理这个问题的好策略？

想到的一种方法是定义枚举的“未定义”成员并将其设为默认值，然后旧代码将知道它已发送无法解释的内容。这是明智的，有没有更好的方法来处理这种情况？

* * *

## 回答 #1

> 赞同：31
> 
> 时间：2013-06-18T08:52:59.027

是的，最好的方法是使枚举中的第一个值类似于`UNKNOWN = 0`. 然后旧程序读取带有他们无法识别的枚举值的 protobuf 将看到它，`UNKNOWN`并希望他们可以合理地处理它，例如通过跳过该元素。

如果你想这样做，你还想让 enum 成为`optional`not `required`。

`required`，一般来说，意思是“我宁愿程序只是中止而不是处理它不理解的东西。”

*请注意，它必须是 proto 源中声明的第一个值*- 只是零值并不能使其成为默认值。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2021-10-22T18:31:57.830

至少在proto3的java实现中，它创建了一个默认值。该值将以`"UNKNOWN_ENUM_VALUE_"`

代码参考：

*   [https://github.com/protocolbuffers/protobuf/blob/0707f2e7f556c8396d6027d0533ec3a56d1061db/java/core/src/main/java/com/google/protobuf/Descriptors.java#L640-L642](https://github.com/protocolbuffers/protobuf/blob/0707f2e7f556c8396d6027d0533ec3a56d1061db/java/core/src/main/java/com/google/protobuf/Descriptors.java#L640-L642)
*   [https://github.com/protocolbuffers/protobuf/blob/0707f2e7f556c8396d6027d0533ec3a56d1061db/java/core/src/main/java/com/google/protobuf/GeneratedMessageV3.java#L2750-L2751](https://github.com/protocolbuffers/protobuf/blob/0707f2e7f556c8396d6027d0533ec3a56d1061db/java/core/src/main/java/com/google/protobuf/GeneratedMessageV3.java#L2750-L2751)
*   [https://github.com/protocolbuffers/protobuf/blob/0707f2e7f556c8396d6027d0533ec3a56d1061db/java/core/src/main/java/com/google/protobuf/Descriptors.java#L1832](https://github.com/protocolbuffers/protobuf/blob/0707f2e7f556c8396d6027d0533ec3a56d1061db/java/core/src/main/java/com/google/protobuf/Descriptors.java#L1832)
*   [https://github.com/protocolbuffers/protobuf/blob/0707f2e7f556c8396d6027d0533ec3a56d1061db/java/core/src/main/java/com/google/protobuf/Descriptors.java#L2034-L2045](https://github.com/protocolbuffers/protobuf/blob/0707f2e7f556c8396d6027d0533ec3a56d1061db/java/core/src/main/java/com/google/protobuf/Descriptors.java#L2034-L2045)

# php - PHP 的浮点精度导致小数出现问题

> ID：10392953
> 
> 赞同：0
> 
> 时间：2012-05-01T02:45:45.643
> 
> 标签：php, numbers, floating-accuracy

我有一个 ojbect `$order`，它有一个成员函数`amount()`，它将行项目的总和（所有浮点数）相加，然后返回值（再次，作为浮点数）。

```
var_dump(array(
    $order->amount() * 100.0, 
    intval($order->amount() * 100.0),
)); 
```

结果：

```
Array
(
    [0] => 7500
    [1] => 7499
) 
```

行项目的值都在 1000 以下，并且从不超过 2 个小数点...

在 PHP 中处理十进制值的最佳方法是什么，因为缺乏精度给我带来了问题......

编辑：为了更好地说明：

```
echo "Addition: " . intval((172.45 - 72.45 - 25.0) * 100); 
```

结果：

```
Addition: 7499 
```

# ios - iOS 库/框架，如何从构建产品中排除特定类？

> ID：10392965
> 
> 赞同：4
> 
> 时间：2012-05-01T02:46:55.407
> 
> 标签：ios, xcode, linker

我正在尝试构建一个 iOS 库/框架，为了简单起见，我们会说它`A`向使用它的项目公开了一些类。现在的问题是 class`A`依赖于 class `B`，这并不意味着在库的构建输出中公开（甚至作为符号包含）。这会导致问题，因为其中还有另一个包含 class`C`的库，它也恰好依赖于 class `B`。

发生的情况是，如果我尝试在项目中包含这两个库，链接器会抱怨有多个 class 定义`B`。

解决此问题的最佳方法是什么？是否可以`B`在构建两个库（或至少两个库之一）时将类设置为弱链接，如果可以，如何？

或者应该将类`B`提取到它自己的库/框架中并修改两个库以引用它而不是将类`B`作为源文件包含？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-01T03:36:20.087

我认为最好的方法是在您的项目中制作多个**目标。**最简单的方法是在 XCode 左侧的文件列表中单击您的项目文件，右键单击中间窗格中“TARGETS”下的对象并选择*Duplicate*。然后，您可以在一个目标中包含 A 和 C，在另一个目标中包含 B 和 C。您可以单独编译它们，这基本上就像拥有两个项目，只是它们共享公共文件。这听起来像你想要的吗？

**编辑**再想一想，听起来不像。当您编译到一个库，然后将另一个项目链接到它时，您的问题就发生了，对吧？

似乎没有办法在编译库中拥有弱链接对象。您可能最好将它们拆分为单独的库（这是[本页](http://www.daveoncode.com/2011/06/25/xcode-project-dependencies-static-library-build-error-invalid-symbol-duplicate-arch-i386-armv6-armv7/)底部描述的场景中发生的情况）

# asp.net-mvc-3 - MVC 3 控制器操作中的可选字典参数

> ID：10392966
> 
> 赞同：1
> 
> 时间：2012-05-01T02:46:56.070
> 
> 标签：asp.net-mvc-3

我有一个这样定义的 MVC 3 控制器操作：

```
public ActionResult _UpdateFilter(int a, string b, List<string> c) 
```

效果很好。*有时*还需要向操作发送一个新要求`Dictionary<int, bool>`，具体取决于 UI 中的用户操作。

为了填充该字典，我将隐藏字段添加到适当的表单中，如下所示：

```
<input type="hidden" id="id-@(something)-Key" name="sometimesSet[@(idx)].Key" value="@(myIntValue)" />
<input type="hidden" id="id-@(something)-Value" name="sometimesSet[@(idx)].Value" value="@(myBoolValue)" /> 
```

我像这样扩展了我的控制器动作：

```
public ActionResult _UpdateFilter(int a, string b, List<string> c, Dictionary<int, bool> sometimesSet = null) 
```

到目前为止，一切都很好。只要我`hidden`在表单中填充至少一个键/值对。如果我不这样做，我的 Action 不会被调用，我会得到异常：

```
Value cannot be null.
Parameter name: key 
```

（问题结束时的长堆栈跟踪）。

**问题**

我收集路由映射无法确定这`sometimesSet`是可选的，但我不知道如何正确配置它。我怎么做？我没有在 Global.asax 中编辑路由定义。

**堆栈跟踪**

```
at System.Collections.Generic.Dictionary`2.FindEntry(TKey key)
at System.Collections.Generic.Dictionary`2.ContainsKey(TKey key)
at System.Web.Mvc.ValueProviderUtil.GetKeysFromPrefix(IEnumerable`1 collection, String prefix)
at System.Web.Mvc.DictionaryValueProvider`1.GetKeysFromPrefix(String prefix)
at System.Web.Mvc.ValueProviderCollection.GetKeysFromPrefixFromProvider(IValueProvider provider, String prefix)
at System.Web.Mvc.ValueProviderCollection.<>c__DisplayClass11.<GetKeysFromPrefix>b__c(IValueProvider provider)
at System.Linq.Enumerable.WhereSelectEnumerableIterator`2.MoveNext()
at System.Linq.Enumerable.WhereSelectEnumerableIterator`2.MoveNext()
at System.Linq.Enumerable.FirstOrDefault[TSource](IEnumerable`1 source)
at System.Web.Mvc.ValueProviderCollection.GetKeysFromPrefix(String prefix)
at System.Web.Mvc.DefaultModelBinder.UpdateDictionary(ControllerContext controllerContext, ModelBindingContext bindingContext, Type keyType, Type valueType)
at System.Web.Mvc.DefaultModelBinder.BindComplexModel(ControllerContext controllerContext, ModelBindingContext bindingContext)
at System.Web.Mvc.DefaultModelBinder.BindModel(ControllerContext controllerContext, ModelBindingContext bindingContext)
at System.Web.Mvc.ControllerActionInvoker.GetParameterValue(ControllerContext controllerContext, ParameterDescriptor parameterDescriptor)
at System.Web.Mvc.ControllerActionInvoker.GetParameterValues(ControllerContext controllerContext, ActionDescriptor actionDescriptor)
at System.Web.Mvc.Async.AsyncControllerActionInvoker.<>c__DisplayClass25.<BeginInvokeAction>b__1e(AsyncCallback asyncCallback, Object asyncState)
at System.Web.Mvc.Async.AsyncResultWrapper.WrappedAsyncResult`1.Begin(AsyncCallback callback, Object state, Int32 timeout)
at System.Web.Mvc.Async.AsyncControllerActionInvoker.BeginInvokeAction(ControllerContext controllerContext, String actionName, AsyncCallback callback, Object state)
at System.Web.Mvc.Controller.<>c__DisplayClass1d.<BeginExecuteCore>b__17(AsyncCallback asyncCallback, Object asyncState)
at System.Web.Mvc.Async.AsyncResultWrapper.WrappedAsyncResult`1.Begin(AsyncCallback callback, Object state, Int32 timeout)
at System.Web.Mvc.Controller.BeginExecuteCore(AsyncCallback callback, Object state)
at System.Web.Mvc.Async.AsyncResultWrapper.WrappedAsyncResult`1.Begin(AsyncCallback callback, Object state, Int32 timeout)
at System.Web.Mvc.Controller.BeginExecute(RequestContext requestContext, AsyncCallback callback, Object state)
at System.Web.Mvc.Controller.System.Web.Mvc.Async.IAsyncController.BeginExecute(RequestContext requestContext, AsyncCallback callback, Object state)
at System.Web.Mvc.MvcHandler.<>c__DisplayClass6.<>c__DisplayClassb.<BeginProcessRequest>b__3(AsyncCallback asyncCallback, Object asyncState)
at System.Web.Mvc.Async.AsyncResultWrapper.WrappedAsyncResult`1.Begin(AsyncCallback callback, Object state, Int32 timeout)
at System.Web.Mvc.MvcHandler.<>c__DisplayClass6.<BeginProcessRequest>b__2()
at System.Web.Mvc.SecurityUtil.<>c__DisplayClassb`1.<ProcessInApplicationTrust>b__a()
at System.Web.Mvc.SecurityUtil.<GetCallInAppTrustThunk>b__0(Action f)
at System.Web.Mvc.SecurityUtil.ProcessInApplicationTrust(Action action)
at System.Web.Mvc.SecurityUtil.ProcessInApplicationTrust[TResult](Func`1 func)
at System.Web.Mvc.MvcHandler.BeginProcessRequest(HttpContextBase httpContext, AsyncCallback callback, Object state)
at System.Web.Mvc.MvcHandler.BeginProcessRequest(HttpContext httpContext, AsyncCallback callback, Object state)
at System.Web.Mvc.MvcHandler.System.Web.IHttpAsyncHandler.BeginProcessRequest(HttpContext context, AsyncCallback cb, Object extraData)
at System.Web.HttpApplication.CallHandlerExecutionStep.System.Web.HttpApplication.IExecutionStep.Execute()
at System.Web.HttpApplication.ExecuteStep(IExecutionStep step, Boolean& completedSynchronously) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-01T18:37:00.960

我发现最干净的解决方案是实现我自己的 ModelBinder，它了解如何填充 a`Dictionary<K,V>`即使在线上没有找到相关值（它将返回一个空的`Dictionary<K,V>`.

这是代码

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Web;
using System.Web.Mvc;

namespace My.ModelBinders
{
    /// <summary>
    /// Binds to a generic Dictionary using the basic format outlined at 
    /// http://www.hanselman.com/blog/ASPNETWireFormatForModelBindingToArraysListsCollectionsDictionaries.aspx
    /// with the relaxation that the indices can be arbitrary integers (need not start at 0 or be sequential).
    /// Returns an empty dictionary of no matching parameters found on the wire rather than throwing
    /// an Exception as the current default binder does.
    /// </summary>
    /// <typeparam name="K">Key type</typeparam>
    /// <typeparam name="V">Value type</typeparam>
    public class OptionalDictionaryBinder<K,V> : CustomBinderBase, IModelBinder
    {
        /// <summary>
        /// Pull key/value pairs out of request.  Modified from
        /// https://github.com/loune/MVCStuff/blob/master/Extensions/DefaultDictionaryBinder.cs
        /// Files not currently supported.
        /// </summary>
        /// <param name="context"></param>
        /// <returns></returns>
        private IEnumerable<KeyValuePair<string, string>> GetValueProviderData(ControllerContext context)
        {
            foreach (var fk in context.HttpContext.Request.Form.Keys)
            {
                yield return new KeyValuePair<string, string>((string)fk, context.HttpContext.Request.Form[(string)fk]);
            }

            foreach (var rd in context.RouteData.Values)
            {
                yield return new KeyValuePair<string, string>(rd.Key, (string)rd.Value);
            }

            foreach (var qp in context.HttpContext.Request.QueryString)
            {
                yield return new KeyValuePair<string, string>((string)qp, context.HttpContext.Request.QueryString[(string)qp]);
            }
        }

        public object BindModel(ControllerContext controllerContext, ModelBindingContext bindingContext)
        {
            if (controllerContext == null) 
            {
                throw new ArgumentNullException("controllerContext");
            }
            if (bindingContext == null)
            {
                throw new ArgumentNullException("bindingContext");
            }

            Dictionary<K, V> dict = new Dictionary<K, V>();
            Dictionary<int, K> keys = new Dictionary<int, K>();
            Dictionary<int, V> values = new Dictionary<int, V>();

            foreach (KeyValuePair<string,string> formParam in GetValueProviderData(controllerContext))
            {
                if (formParam.Key.StartsWith(bindingContext.ModelName, StringComparison.InvariantCultureIgnoreCase))
                {
                    int startbracket = formParam.Key.IndexOf("[");
                    if (startbracket != bindingContext.ModelName.Length) throw new Exception("Did not find [ directly after model name");

                    int endbracket = formParam.Key.IndexOf("]", bindingContext.ModelName.Length + 1);
                    if (endbracket == -1) throw new Exception("Did not find closing bracket in " + formParam);

                    int idx;
                    string idxText = formParam.Key.Substring(bindingContext.ModelName.Length + 1, endbracket - bindingContext.ModelName.Length - 1);
                    if (!int.TryParse(idxText, out idx))
                    {
                        throw new Exception("Could not parse numeric index from " + formParam);
                    }

                    if (formParam.Key.EndsWith(".Key", StringComparison.InvariantCultureIgnoreCase))
                    {
                        if (keys.ContainsKey(idx))
                        {
                            throw new Exception("The index " + idx + " was repeated.");
                        }

                        K dictKey;
                        try
                        {
                            dictKey = (K)Convert.ChangeType(formParam.Value, typeof(K));
                            keys.Add(idx, dictKey);
                        }
                        catch (NotSupportedException)
                        {
                            throw new Exception("The given key '" + formParam.Key + "' could not be converted to type K");
                        }
                    }
                    else if (formParam.Key.EndsWith(".Value", StringComparison.InvariantCultureIgnoreCase))
                    {
                        if (values.ContainsKey(idx))
                        {
                            throw new Exception("The index " + idx + " was repeated.");
                        }

                        V dictValue;
                        try
                        {
                            dictValue = (V)Convert.ChangeType(formParam.Value, typeof(V));
                            values.Add(idx, dictValue);
                        }
                        catch (NotSupportedException)
                        {
                            throw new Exception("The given value '" + formParam.Value + "' could not be converted to type V");
                        }
                    }
                }
            }

            if (!keys.Keys.SequenceEqual(values.Keys))
            {
                throw new Exception("Keys and values do not match.");
            }

            foreach (KeyValuePair<int, K> kvp in keys)
            {
                dict.Add(kvp.Value, values[kvp.Key]);
            }

            return dict;
        }
    }
} 
```

用法：

```
public ActionResult _UpdateFilter(int a, string b, List<string> c, 
         [ModelBinder(typeof(OptionalDictionaryBinder<int, bool>))] 
         Dictionary<int, bool> sometimesSet) 
```

# android - 在 Runnable 期间 setHint 失败

> ID：10392969
> 
> 赞同：0
> 
> 时间：2012-05-01T02:47:35.747
> 
> 标签：android, android-edittext, runnable

我的代码旨在`EditText`随时间更新提示，允许用户输入不同的时间作为文本，或者如果用户没有输入类似的内容，则使用提示：

```
mTicker = new Runnable()
    {
        public void run()
        {
            time.setHint(new TimeDate().getTime());

            long now = SystemClock.uptimeMillis();
            long next = now + (1000 - now % 1000);
            spaceTimeHandler.postAtTime(mTicker, next);
        } 
```

此代码运行，但`EditText`保持空白；如果您与之交换`setHint`，`setText`则一切正常。这是一个错误吗？

我意识到我可能应该使用`DateTimePicker`or ，但我还没有解决这个问题，无论我尝试`setHint`使用什么字符串，都会出现这个问题。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-01T03:08:40.080

```
mTicker = new Runnable()
    {
        public void run()
        {
         runOnUiThread(new Runnable(){
          @Override
          public void run() {
            time.setHint(new TimeDate().getTime());

            long now = SystemClock.uptimeMillis();
            long next = now + (1000 - now % 1000);
            spaceTimeHandler.postAtTime(mTicker, next);
          }
         });

        }
} 
```

将它包含在 runOnUiThread 中，让我知道它是否有效。

# java - Bittorrent 协议中的 KeepAlive 消息

> ID：10392970
> 
> 赞同：3
> 
> 时间：2012-05-01T02:47:36.427
> 
> 标签：java, bittorrent

我在互联网上的任何地方都找不到这个问题的答案。我想知道当您在 bittorrent 协议上收到保持活动消息时会发生什么？我们是否应该发回一条保持活动状态的消息？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-01T02:52:52.870

来自[非官方的 BitTorrent 规范](http://wiki.theory.org/BitTorrentSpecification#keep-alive:_.3Clen.3D0000.3E)：

> ### 活着：`<len=0000>`
> 
> **keep-alive**消息是具有零字节的消息，指定长度前缀设置为零。没有消息 ID，也没有有效负载。如果对等点在一段时间内没有收到任何消息（**keep-alive**或任何其他消息），则可能会关闭连接，因此如果没有发送给定数量的命令，则必须发送 keep-alive 消息以保持连接处于活动状态的时间。这个时间量一般是两分钟。

我不是 BitTorrent 专家，但基于此以及我对网络协议的了解*，*这听起来像是您问题的答案

> 我们是否应该发回一条保持活动状态的消息？

是**没有。**至于

> 当您收到保持活动消息时会发生什么？

好吧，没什么——重要的是当您在提到的“给定时间”之后*没有收到保持活动（或任何其他）消息时会发生什么。*在 BitTorrent 实现中，接收保持活动消息可能会重置计时器，或更新“收到的最后一条消息”时间戳。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-01T02:55:22.837

来自[Bittorrent 规范](http://bittorrent.org/beps/bep_0003.html)：

> 长度为零的消息是keepalive，并被忽略。Keepalive 通常每两分钟发送一次，但请注意，当预期有数据时，超时可以更快地完成。

换句话说，keep-alive 实际上是一个空操作。像所有其他消息一样，它会重置超时，因此它的净效果是“保持连接活动”再过 2 分钟。

# java - 如何在JAVA中播放flv、mp4、avi格式的视频？

> ID：10392972
> 
> 赞同：0
> 
> 时间：2012-05-01T02:47:47.470
> 
> 标签：java, jmf

我可以使用 Java 媒体框架播放 .mpg 格式的视频。但我无法播放所有格式的视频。当我想播放.AVI格式的视频时，视频在播放，但没有声音。如何播放FLV、mp4、avi等其他格式？

```
public class MediaPanel extends JPanel
{
public Player mediaPlayer;
public Component video;
public Component controls;
public MediaPanel(URL mediaURl)
{

    setLayout(new BorderLayout());
    Manager.setHint(Manager.LIGHTWEIGHT_RENDERER, true);
    try
    {
        //Player
       // this. mediaPlayer.stop();
        //this.mediaPlayer.close();

        mediaPlayer=Manager.createRealizedPlayer(mediaURl);
        //Component
        video=mediaPlayer.getVisualComponent();
        //Component
        controls=mediaPlayer.getControlPanelComponent();

        if(video!=null)
            add(video,BorderLayout.CENTER);
        if(controls!=null)
            add(controls,BorderLayout.SOUTH);

        mediaPlayer.start();

    }
    catch(NoPlayerException noPlayerException)
    {
            System.err.println("No media");
    }
    catch(CannotRealizeException cannotRealizeException)
    {
            System.err.println("Could not");
    }
    catch(IOException iOException)
    {
            System.err.println("Error");

    }
}} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-01T11:03:04.883

您需要为相关编码添加[服务提供者接口](http://java.sun.com/developer/technicalArticles/javase/extensible/)。EG JMF 为 MP3 提供了一个 SPI，可以将其添加到应用程序的运行时类路径中。允许它使用 Java Sound 读取 MP3。

# objective-c - 在 Mac 应用程序中“捆绑”宝石的最佳方式是什么？

> ID：10392979
> 
> 赞同：4
> 
> 时间：2012-05-01T02:48:36.097
> 
> 标签：objective-c, ruby, gem

我继承了一个小的 obj-C 实用程序应用程序，它充当 ruby​​ 脚本的包装器（它显然作为资源包含在应用程序中）。

但是，帮助 ruby​​ 脚本需要 json gem。在应用程序中包含 gem（和 gem 的依赖项）的最佳方式是什么？

我可以让应用程序在加载时运行检查以查看是否安装了 gem，然后 gem install 它，但我认为可能有一个更优雅的解决方案。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-23T20:22:22.593

第一步是检查 json gem 是否有任何依赖项：

```
$ gem dependency json 
```

我安装的版本没有依赖项，因此您需要将 gem 的副本放入您的包中。

```
$ cd /my/project/resources
$ gem unpack json 
```

然后，要要求它，您可以使用以下行：

```
require File.join(File.dirname(__FILE__), 'json-VERSION','lib','json') 
```

用 gem 版本替换 VERSION。

# r - 更有效的方法：从列表中选择 vec

> ID：10392980
> 
> 赞同：2
> 
> 时间：2012-05-01T02:49:00.723
> 
> 标签：r, list, function, vector, max

假使，假设

```
x = c(1, 2, 3.5, 4, 6, 7.5, 8, 9, 10, 11.5, 12) 
y = c(2.5, 6.5) 
I = split(x, findInterval(x, y))
f = function(vec, x) {
        d = pmax(outer(x, vec, "-"), 0)
        colSums(d - d^2/2)
} 
```

我想计算`f(I[[i]], x)`每个间隔的每个值中的值，然后找出每个间隔中哪个`I[[i]]`实际值具有最大值`f(I[[i]], x )`。有没有比这个 for 循环更有效的方法：

```
for (i in 1:length(I)) {
    max.values[[i]] = I[[i]][which.max(f(I[[i]], x))]
} 
```

这是我想要得到的结果：

```
 > max.values
 [1]  2  6 10 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-01T03:20:57.747

如果您只是对删除 for 循环感兴趣。您可以通过以下方式将其替换为 lapply(.)：

```
max.values <- unlist( lapply( I, function(v) v[which.max(f(v, x))] ) ); 
```

这只会在长度（I）很大的情况下产生影响。为了获得更多的性能，看看你是否可以简化 f(.) 只是为了找到一个最大值。为了获得最佳优化，您应该考虑用 C、C++ 或 Fortran 重写性能关键部分。

当数据向量变大、存在冗长的循环或可用的数据结构不适合该任务时，R 可能会*非常慢。*就像轶事一样，我写了一个“for-loop”-less R 代码，在 Wall time 2 周后被杀死（输入数组：n ~ 1e6）。（R 代码在 n ~ 1e4 的输入上运行良好）。一个 C++ 等效代码需要 1 分钟。稍微优化的 C++ 代码需要 10 秒...

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-01T03:06:56.957

你可以做

```
mapply('[', I, lapply(lapply(I, f, x), which.max))
# 0  1  2 
# 2  6 10 
```

以下是中间步骤：

```
lapply(I, f, x)
# $`0`
# [1] -190.875 -142.375
# 
# $`1`
# [1] -85.75 -70.75 -26.75
# 
# $`2`
# [1] -9.500 -6.125 -1.625  0.375  0.375  0.000

lapply(lapply(I, f, x), which.max)
# $`0`
# [1] 2
# 
# $`1`
# [1] 3
# 
# $`2`
# [1] 4 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-01T03:06:14.590

这更紧凑，但我不知道它是否更有效......

```
v <- sapply(lapply(I,f,x=x),which.max)
mapply(getElement,I,v) 
```

# jquery - 可见性：可见/隐藏的 div

> ID：10392987
> 
> 赞同：18
> 
> 时间：2012-05-01T02:50:02.340
> 
> 标签：jquery, css, html, visibility

单击按钮时显示 div 然后用关闭按钮隐藏它的最佳方法是什么？

我的 Jquery 代码如下：

```
$(".imageIcon").click(function(){
$('.imageShowWrapper').css("visibility", 'visible');
});
 $(".imageShowWrapper").click(function(){
$('.imageShowWrapper').css("visibility", 'hidden');
}); 
```

除了我遇到的问题是它会自动关闭而无需任何点击。它加载一切正常，显示约 1/2 秒，然后关闭。有任何想法吗？

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2012-05-01T02:53:45.990

您可以使用`show`和`hide`方法：

```
$(".imageIcon").click(function() {
    $('.imageShowWrapper').show();
});

$(".imageShowWrapper").click(function() {
    $(this).hide();
}); 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-05-01T03:30:03.033

According to your requirement, I believe what you need is as simple as this: [http://jsfiddle.net/linmic/6Yadu/](http://jsfiddle.net/linmic/6Yadu/)

However, using the visibility is different from using show/hide function, gory details: [What is the difference between visibility:hidden and display:none?](https://stackoverflow.com/questions/133051/what-is-the-difference-between-visibilityhidden-and-displaynone)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-05-01T03:15:26.113

另外的选择：

```
$(".imageIcon, .imageShowWrapper").click(function() {  
    $(".imageShowWrapper").toggle($(this).hasClass('imageIcon'));     
}); 
```

您还可以使用`fadeToggle`和`slideToggle`

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-01T03:14:49.817

```
$(".imageIcon, .imageShowWrapper").click(function(){
    $('.imageShowWrapper').toggle();
}); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-05-01T02:54:20.627

您将使用淡入淡出方法获得更平滑的过渡：

```
var imageIcon = $(".imageIcon"),
    imageShowWrapper = $(".imageShowWrapper");

imageIcon.on("click", function(){
  imageShowWrapper.stop().fadeIn();
});

imageShowWrapper.on("click", function(){
   $(this).stop().fadeOut();
}); 
```

演示：http: [//jsbin.com/uhapom/edit#javascript,html,live](http://jsbin.com/uhapom/edit#javascript,html,live)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2019-01-16T01:31:48.593

很难说没有看到代码的 html 和 jquery 部分。但是，看起来您显示/隐藏 div 的部分受到页面重新加载的影响？您可能正在将显示/隐藏 div 的代码放在一个`$(document).ready(function() { .....})`块内。此外，另一个需要注意的相关点是，每当单击按钮、锚点等 html 元素时，单击被认为是默认类型 = 提交，并且在这种情况下页面也会重新加载。要停止这种情况，可以使用`event.preventDefault()`

# php - 连接两个表，但连接键在查询字符串中

> ID：10392989
> 
> 赞同：2
> 
> 时间：2012-05-01T02:50:11.217
> 
> 标签：php, mysql, sql, left-join

我想加入这两个表，但第二个表的连接键在查询字符串中，

`page`桌子，

```
page_id     url
1           a
2           c
3           d 
```

`system`桌子，

```
system_id       query
1               page_id=1&content=on&image=on
2               type=post&page_id=2&content=on 
```

如您所见，这`page_id`是表中**查询**字符串的一部分`system`。

那么我怎样才能像下面的标准加入表方法一样加入它们呢？

```
SELECT*
FROM page AS p

LEFT JOIN system AS s
ON p.page_id = s.page_id 
```

**编辑：**

我可以把`system`桌子改成这样，

```
system_id       page_id    query
1               1           page_id=1&content=on&image=on
2               2           type=post&page_id=2&content=on
3               NULL        type=page 
```

但我不想这样做的原因`page_id`是不需要很多特定的记录。我不想做一个太多的专栏`null`。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-01T03:02:46.803

我肯定会为`page_id`、`content`和（`image`并将`type`它们编入索引）创建列。然后数据库会更轻，工作速度也会更快。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-01T02:55:10.373

### 连接两个没有公共字段和数据类型的表，从根本上是错误的 IMO。

我建议您提取`page_id`并将其插入数据库并使用普通连接来完成您正在搜索的内容。

所以使列像

```
+------------+-----------+---------+
| system_id  |  page_id  |  query  |
------------------------------------ 
```

这是您提取 page_id 的片段。

```
$query = 'page_id=1&content=on&image=on';
$queryParts = explode('&', $query);

$params = array();
foreach ($queryParts as $param) {
    $item = explode('=', $param);
    $params[$item[0]] = $item[1];
} 
$page_id = $parems['page_id']; 
```

然后您可以继续插入并使用简单的连接语句以正确的方式解决您的问题。

* * *

**更新：**

因为您能够将架构更改为可行的架构。您不必担心某些行在此上有空行。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-01T03:53:30.713

我猜你想要这样的东西（MSSQL！）：

* * *

```
DECLARE @query VARCHAR(50)
DECLARE @Lenght INT  
DECLARE @PageID INT 

SET @query = '4kkhknmnkpage_id=231&content=on&image=on'
SET @Lenght = PATINDEX('%&%', substring(@query,PATINDEX('%page_id=%', @query),50)) - 9
SET @PageID = CAST(SUBSTRING(@query,PATINDEX('%page_id=%', @query) + 8,@Lenght) AS INT)

SELECT @PageID -- you can do as you please now :) 
```

* * *

或者：

```
SELECT*
FROM page AS p
LEFT JOIN (SELECT CAST(SUBSTRING(query,PATINDEX('%page_id=%', query) + 8,(PATINDEX('%&%', substring(query,PATINDEX('%page_id=%', query),50)) - 9)) AS INT) AS page_id
                FROM system) AS s
ON p.page_id = s.page_id 

-- Do as you please again :) 
```

* * *

**我猜你真正想要的是这样的（MYSQL！）：**

* * *

```
SET @query := '4kkhknmnkpage_id=231&content=on&image=on';
SET @Lenght := POSITION('&' IN (SUBSTR(@query,POSITION('page_id=' IN @query),50))) - 9;
SET @PageID := CAST(SUBSTR(@query,POSITION('page_id=' IN @query) + 8,@Lenght) AS  SIGNED );

SELECT @PageID 
```

* * *

**或者**

* * *

```
SELECT*
FROM page AS p
LEFT JOIN (SELECT CAST(SUBSTR(query,POSITION('page_id=' IN query) + 8,(POSITION('&' IN (SUBSTR(query,POSITION('page_id=' IN query),50))) - 9)) AS  SIGNED) AS pageID
           FROM system) AS s
ON p.page_id = s.pageID 
```

# dictionary - 当reduce任务较少时，Hadoop reduce变得更慢

> ID：10392990
> 
> 赞同：4
> 
> 时间：2012-05-01T02:50:17.693
> 
> 标签：dictionary, hadoop, configuration, reduce, shuffle

当我对 Hadoop 进行一些性能调整时，我遇到了一个非常奇怪的情况。我正在运行一个具有大量中间输出的作业（例如没有组合器的 InvertedIndex 或 WordCount），网络和计算资源都是同质的。根据 mapreduce 的工作方式，当**WAVES更多时**对于reduce任务，由于map和shuffle之间的重叠较少，因此整体运行时间应该更慢，但事实并非如此。事实证明，具有 5 WAVES 减少任务的作业比仅具有 1 个 WAVE 任务的作业快 10%。我检查了日志，结果发现当reduce任务较少时，map任务的执行时间较长，而且当任务较少时，reduce阶段的整体计算时间（不是shuffle或merge）较长。我试图通过将reduce slow-start factor设置为1来排除其他因素，这样map和shuffle之间就没有重叠，我还将它限制为同时执行一个reduce任务，所以没有重叠在 reduce 任务之间，我修改了调度程序以强制 mapper 和 reducer 定位在不同的机器上，这样就不会出现 I/O 拥塞。即使采用上述方法，同样的事情仍然会发生。（我还将映射内存缓冲区设置为足够大，并将 io.sort.factor 设置为 32 甚至更大，并且 io.sort.mb 相应地大于 320）

我真的想不出导致这个问题的任何其他原因，所以任何建议将不胜感激！

**以防万一，我遇到的问题是：**

**0\. 我正在比较在所有其他相同配置下运行同一作业的 1 个 reduce 任务与 5 个 reduce 任务的性能。减少计算只有一个任务跟踪器。**

**1.我强制所有reduce任务顺序执行，在这两种情况下只有一个tasktracker用于redcue任务，mapred.tasktracker.reduce.tasks.maximum=1，所以在reduce阶段不会有任何并行性**

**2\. 我设置了 mapred.reduce.slowstart.completed.maps=1 所以在所有 map 完成之前没有一个 reducer 会开始拉数据**

**3\. 事实证明，拥有一个 reduce 任务比拥有 5 个 SEQUENTIAL 任务要慢！**

**4\. 即使我设置了 set mapred.reduce.slowstart.completed.maps=0.05 以允许 map 和 shuffle 之间的重叠，（因此当只有一个 reduce 任务时，重叠应该更多，它应该运行得更快，因为 5 reduce 任务按顺序执行）5-reduce-task 仍然比 1-reduce 任务快，1-reduce 任务的 map 阶段变得更慢！**

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-01T13:09:22.420

如果您只有 1 个 reduce 任务，那么该 reducer 必须等待所有 mapper 完成，并且 shuffle 阶段必须收集所有中间数据以重定向到该一个 reducer。因此，如果只有一个 reducer，map 和 shuffle 时间自然会变大，总时间也会变长。

但是，如果您有更多的 reducer，您的数据会被并行处理，这会使其更快。同样，如果你有太多的 reducer，那么就会有太多的数据被打乱，导致网络流量增加。因此，您必须找到最佳数量的减速器，以达到良好的平衡。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-06-05T03:42:50.303

减少的正确数量似乎是 0.95 或 1.75 * (nodes * mapred.tasktracker.tasks.maximum)。在 0.95 时，所有 reduce 可以立即启动，并在地图完成时开始传输地图输出。在 1.75 时，更快的节点将完成其第一轮 reduce 并启动第二轮 reduce，从而更好地完成负载平衡。

礼貌：

[http://wiki.apache.org/hadoop/HowManyMapsAndReduces](http://wiki.apache.org/hadoop/HowManyMapsAndReduces)

[设置map任务和reduce任务的数量](https://stackoverflow.com/questions/6885441/setting-the-number-of-map-tasks-and-reduce-tasks)

（类似的问题与已解决的答案）

希望这可以帮助！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-01T05:39:31.327

这不是问题。您拥有的 reduce 任务越多，处理数据的速度就越快。

map阶段的输出被发送到reducers。如果您有两个减速器，负载将分布在两个减速器之间。

在 wordcount 示例中，您将有两个单独的文件，它们之间的计数分开。因此，如果您有很多 reduce 任务，您将不得不手动添加总数，或者运行另一个 map reduce 作业来计算总数。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-01T13:05:29.797

正如预期的那样，如果您只有一个 reducer，那么您的作业就会出现单点故障。您的减速器数量应设置为大约 90% 的容量。你可以通过将你的 reduce 槽数乘以你的节点总数来找到你的 reduce 容量。我发现如果适用的话，使用组合器也是一个好习惯。

# grails - Grails (GORM) 多对一级联删除行为

> ID：10392991
> 
> 赞同：5
> 
> 时间：2012-05-01T02:50:19.290
> 
> 标签：grails, grails-orm, belongs-to, cascading-deletes

我一直在努力在一个相对简单的 Grails 项目中生成正确的配置以产生级联删除行为。

假设我有以下简单的域类：

```
class Author {
    String name
    static constraints = {
    }
} 
```

和

```
class Book {
    String title
    Author author
    static constraints = {
    }
} 
```

如果我创建了一个作者，然后创建了一本由该作者撰写的书，那么如果不先手动删除该书，我就无法删除该作者。我收到“违反完整性约束”。这并不奇怪，因为 MySQL（我的底层数据库）是由 Grails 创建的，在“book”表的“author”列上具有“外键约束”作为“Restrict”（这种行为与 Grails 的预期一致据我了解的文档）。

现在，如果我要手动将 book 表的“author”列上的基础数据库约束从“Restrict”更改为“Cascade”，我会得到我想要的行为。也就是说，如果您删除作者，他们的所有书籍也会被删除。

所以，我想做的是改变我的Grails“书”类，以在作者列上创建“删除级联”的“书”表。我一直在阅读大量有关使用“belongsTo”和显式“映射”的信息和 GORM 默认值。

根据“belongsTo”的文档，执行此操作的一种方法似乎是将 Book 类中的行从：

```
Author author 
```

至

```
static belongsTo = [author:  Author] 
```

从而明确地表明作者是关系的“拥有方”。该文档似乎表明这应该产生我所追求的级联删除行为。但是，除非我在 Author 类中添加明确的“hasMany = [books:Book]”，否则它不起作用。我不想这样做。（这个愿望在我的实际业务领域中更有意义，但即使只是作为理解练习，我还不明白为什么我必须让 Author 领域类明确了解书籍）。

我只是想要一个 grails 设置来更改 Book 类以在数据库中生成“级联删除”设置，而无需更改 Author 类。我尝试使用显式映射，例如：

```
static mapping = {
        author cascade: 'all'
} 
```

以及与其他显式映射或“belongsTo”选项的组合。这没有用。

注意到对底层 SQL 数据库中的“约束”的简单更改提供了我想要的行为，有没有办法通过 Grails 实现这一点？如果不是，我是否误解了一些基本的东西，还是我试图做一些愚蠢的事情？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-02T03:27:08.573

我认为您在**Author**中缺少**Book**类型的必填字段。

 **这是示例代码，根据文档（经过测试和工作）

```
class Author {

    String name
    Book book //you are probably missing this field

    static constraints = {
    }
}

class Book {

    String name

    static belongsTo = [author: Author]

    static constraints = {
    }
} 
```

**测试用例：**

```
@TestFor(Author)
@Mock([Book])
class AuthorTests {

    @Test
    void testAuthorBookCascades() {

        Author a = new Author(name: "Douglas Adams")
        Book b = new Book(name: "So Long, and Thanks for all the Fish")
        a.book = b
        a.save()

        assert Author.count() == 1
        assert Book.count() == 1

        a.delete()

        assert Author.count() == 0
        assert Book.count() == 0
    }
} 
```

如您所见，您需要 Author 中的 Book 参数。不需要 hasMany 或 hasOne 子句。**

# svg - customAttributes 函数的参数设置为 NAN

> ID：10392997
> 
> 赞同：1
> 
> 时间：2012-05-01T02:51:00.007
> 
> 标签：svg, raphael

我正在尝试使用 Raphael 的 customAttributes。

但我的问题是 customAttributes 函数中的参数是 NAN。请看看这个[http://jsfiddle.net/5CxVW/1/](http://jsfiddle.net/5CxVW/1/)。在控制台`NAN`中记录而不是`h,s,b`值，并`undefined`为`path1`. 我期待的是`h,s,b`customAttributes 函数内部的步骤值。我也想知道如何将任何 raphael 对象传递给 customAttributes 函数

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-01T15:15:27.350

[这](http://jsfiddle.net/amadanNM/Gb4GE/)似乎有效，但我不知道为什么。我已经为路径赋予了 hsb 的初始值，然后进行动画处理。另外，我已经从 customattribute 中提取了路径参数。这是我用锤子敲打它直到它起作用，而不是通过手术解剖它并弄清楚它为什么不起作用。

所以一方面，万岁，它正在工作。另一方面，我不知道为什么。

N。

PS。等一下。您正在为 hsb 设置动画，这意味着它在动画结束之前将小数值添加到初始值。如果您没有先设置值，也许这就是它失败的原因。未定义 + .0012 = NaN？