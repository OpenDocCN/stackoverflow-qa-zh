# StackOverflow 问答 000134000-000134999

# windows - 如何将文本文件的内容加载到批处理文件变量中？

> ID：134001
> 
> 赞同：37
> 
> 时间：2008-09-25T15:29:36.630
> 
> 标签：windows, batch-file, command-line, cmd

我需要能够加载文本文件的全部内容并将其加载到变量中以进行进一步处理。

我怎样才能做到这一点？

* * *

感谢 Roman Odaisky 的回答，这就是我所做的。

```
SetLocal EnableDelayedExpansion
set content=
for /F "delims=" %%i in (test.txt) do set content=!content! %%i

echo %content%
EndLocal 
```

* * *

## 回答 #1

> 赞同：52
> 
> 时间：2013-01-31T20:30:08.140

如果您的`set`命令支持`/p`开关，那么您可以通过这种方式管道输入。

```
set /p VAR1=<test.txt
set /? |find "/P" 
```

> /P 开关允许您将变量的值设置为用户输入的一行输入。在读取输入行之前显示指定的 promptString。promptString 可以为空。

这具有为未注册的文件类型工作的额外好处（接受的答案没有）。

* * *

## 回答 #2

> 赞同：17
> 
> 时间：2008-09-25T15:49:57.733

使用`for`，类似于：

```
set content=
for /f "delims=" %%i in ('filename') do set content=%content% %%i 
```

也许你必须做`setlocal enabledelayedexpansion`和/或使用`!content!`而不是`%content%`. 我无法测试，因为我附近没有任何 MS Windows（我希望你也一样 :-)。

我所知道的最好的批处理文件黑色魔法参考是在[http://www.rsdn.ru/article/winshell/batanyca.xml](http://www.rsdn.ru/article/winshell/batanyca.xml)。如果您不懂俄语，您仍然可以使用提供的代码片段。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-09-25T16:14:30.420

你能定义进一步的处理吗？

您几乎可以使用 for 循环来执行此操作，但没有简单的方法将 CR/LF 插入环境变量，因此您可以将所有内容放在一行中。（您可以根据需要做的事情来解决这个问题。）

通过这种方式，您也被限制在少于大约 8k 的文本文件中。（您不能创建大于 8k 左右的单个 env var。）

比尔关于 for 循环的建议可能正是您所需要的。您一次处理一行文件：

（在批处理文件`%i`的命令行中使用）`%%i`

```
for /f "tokens=1 delims=" %%i in (file.txt) do echo %%i 
```

更先进：

```
for /f "tokens=1 delims=" %%i in (file.txt) do call :part2 %%i
goto :fin

:part2
echo %1
::do further processing here
goto :eof

:fin 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-09-25T16:23:42.660

您可以使用：

```
set content=
for /f "delims=" %%i in ('type text.txt') do set content=!content! %%i 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2021-03-19T19:53:58.220

要读入整个多行文件但保留换行符，您必须重新插入它们。以下（将“<...>”替换为我的文件的路径）起到了作用：

```
@echo OFF
SETLOCAL EnableDelayedExpansion
set N=^

REM These two empty lines are required
set CONTENT=
set FILE=<...>
for /f "delims=" %%x in ('type %FILE%') do set "CONTENT=!CONTENT!%%x!N!"
echo !CONTENT!

ENDLOCAL 
```

您可能想做其他事情而不是回显文件内容。

请注意，以这种方式可以读取的数据量可能会受到限制，因此您的里程可能会有所不同。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-09-25T15:58:48.040

创建一个名为“SetFile.bat”的文件，其中包含以下行，末尾**没有回车...**

```
set FileContents= 
```

然后在你的批处理文件中做这样的事情......

```
 @echo off
   copy SetFile.bat + %1 $tmp$.bat > nul
   call $tmp$.bat
   del $tmp$.bat 
```

%1 是输入文件的名称，%FileContents% 将包含调用后输入文件的内容。不过，这仅适用于单行文件（即不包含回车的文件）。如果需要，您可以在调用 %tmp%.bat 之前从文件中删除/替换回车符。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2014-08-04T15:30:39.097

```
for /f "delims=" %%i in (count.txt) do set c=%%i
echo %c%
pause 
```

# delphi - 将图形添加到 TLabel 的问题

> ID：134018
> 
> 赞同：2
> 
> 时间：2008-09-25T15:31:18.030
> 
> 标签：delphi, getclientrect, tlabel

我正在尝试使用 Delphi 创建一个从 TLabel 继承的组件，并在 TLabel.Paint 上添加了一些自定义图形。我希望图形位于文本的左侧，所以我覆盖了 GetClientRect：

```
function TMyComponent.GetClientRect: TRect;
begin
  result := inherited GetClientRect;
  result.Left := 20;
end; 
```

该解决方案有我想解决的主要问题：无法单击控件的“图形区域”，只能单击标签区域。如果标题为空字符串，则根本无法通过单击在设计器中选择组件。有任何想法吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-09-25T16:16:30.120

首先对不起我的英语不好。
我认为更改组件的 ClientRect 不是一个好主意。此属性用于许多内部方法和过程，因此您可能会意外更改该组件的功能/操作。

我认为您可以更改写入文本的点（例如，在**DoDrawText**过程中为 20 个像素），并且组件可以响应图形区域中的事件。

```
procedure TGrlabel.DoDrawText(var Rect: TRect; Flags: Integer);
begin
  Rect.Left := 20;
  inherited;
end;

procedure TGrlabel.Paint;
begin
  inherited;

  Canvas.Brush.Color := clRed;
  Canvas.Pen.Color := clRed;
  Canvas.pen.Width := 3;
  Canvas.MoveTo(5,5);
  Canvas.LineTo(15,8);

end; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-09-25T15:53:58.847

您从 TLabel 获得哪些需要此组件执行的方法/功能？

您是否会更好地制作（例如，TImage）的后代并将您的文本作为其绘制方法的一部分进行绘制？

如果它真的必须是一个 TLabel 后代（所有这些都需要），那么我认为你会被这个设计时问题困住，因为当标题为空时，TLabel 不会有这个问题吗？

我会对你得到的其他答案感兴趣！:-)

# compiler-construction - wxwidgets setup.h "没有这样的文件"

> ID：134029
> 
> 赞同：18
> 
> 时间：2008-09-25T15:33:07.040
> 
> 标签：compiler-construction, include, wxwidgets, codeblocks

对这个问题的快速谷歌搜索表明它很常见，我只是无法在我的情况下找出解决方案。

我直接从 wxWidgets 网站直接安装了适用于 Windows 的 wxWidgets 2.8.8。

每当我尝试编译任何东西（例如“wxWidgets 的第一个程序” - [http://zetcode.com/tutorials/wxwidgetstutorial/firstprograms/](http://zetcode.com/tutorials/wxwidgetstutorial/firstprograms/)中描述的示例应用程序）时，我都会得到：

wx/setup.h: 没有这样的文件或目录

我在编译器搜索列表中包含了 C:\wxWidgets-2.8.8\include 和 C:\wxWidgets-2.8.8\include\wx。

它应该很简单——但事实并非如此！:(

如果我尝试使用与 wxWidgets 集成的 IDE（例如 Code::Blocks），也会发生同样的事情——我原以为，这只是解决问题的方法......

因此，请提供一些帮助...为什么找不到 setup.h？

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2008-10-16T15:55:02.750

当您“安装” wxMSW 安装程序时，wxWidgets 没有内置到可用的库中。这是因为有太多可配置的元素，而这正是您所指的 setup.h 的用途。

如果您只想尽快使用默认选项构建它并继续前进，那么方法如下：

1.  启动“Visual Studio 命令提示符”。您可以在“Microsoft Visual Studio -> Visual Studio Tools”下的开始菜单中找到它。

2.  切换到文件夹：[WXWIN root]\build\msw

3.  构建默认调试配置：`nmake -f makefile.vc BUILD=debug`

4.  构建默认发布配置：`nmake -f makefile.vc BUILD=release`

5.  确保 DLL 在您的 PATH 中。它们会在 [WXWIN root]\lib\vc_dll 中找到

6.  在上面提到的 DLL 文件夹下，您会找到每个构建变体的子文件夹（上面的说明分为两个，调试和发布。）在每个变体文件夹中，您会找到一个包含“setup.h”文件的“wx”文件夹。你'会看到 setup.h 文件对于每个构建变体实际上是不同的。这些是您需要添加到项目构建配置的文件夹，包括路径，每个构建变体一个。因此，例如，您将添加 [WXWIN root ]\lib\vc_dll\mswud 到您的调试版本的包含路径，[WXWIN root]\lib\vc_dll\mswu 用于您的发布版本。

7.  可以构建许多其他变体组合：静态库、单一库、非 Unicode 等。请参阅 [WXWIN root]\docs\msw\install.txt 了解更多详细说明。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2011-10-03T21:16:44.453

在构建 wxWidgets 时，它会为每个构建的构建配置动态创建一个 setup.h 文件。生成的 setup.h 文件存储在 lib 文件夹下的文件夹中，例如（Windows 上的 Visual Studio）：

```
c:\wxWidgets-2.9.2\lib\vc_lib\mswu 
```

要成功构建基于 wxWidgets 的项目，项目中的每个构建配置都必须设置自己的 Additional Include 目录，该目录指向 lib 下对应的 wxWidgets 构建文件夹，例如上面列出的那个。

此外，必须将项目中所有构建配置通用的附加包含目录设置为指向 wxWidget 的主包含文件夹。此文件夹通常设置在可用于任何项目的用户属性表中。例如：

```
c:\wxWidgets-2.9.2\include 
```

对于链接，所有构建配置通用的附加库目录设置为指向 wxWidgets lib 文件夹。例如：

```
c:\wxWidgets-2.9.2\lib\vc_lib 
```

然后，特定于每个构建配置，附加依赖项被设置为包含相应 wxWidgets 库的库。例如，对于 Unicode，Debug 构建（u = Unicode，d = Debug）：

```
wxbase29ud.lib 
```

然后，要在项目中使用 wxWidgets，首先要包含生成的 setup.h 文件：

```
#include "wx/setup.h" 
```

然后包含特定 wxWidgets 功能的标题。例如：

```
#include <wx/slider.h>
#include <wx/image.h>
#include <wx/control.h> 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-09-25T15:46:49.287

您可能需要构建 wxWidgets。wxWidgets 构建过程中有一个构建后步骤，它将适当的 setup.h 复制到 C:\wxWidgets_install_dir\include\wx。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2016-07-01T13:09:52.987

为了让任何东西工作，您首先必须构建核心库（wx_vc#.sln 文件）。然后你可以处理剩下的东西。

请记住，您需要[CppUnit](https://www.freedesktop.org/wiki/Software/cppunit/)来编译测试用例。

# apache-flex - 如何在 Flex 中获取自定义组件的句柄？

> ID：134034
> 
> 赞同：0
> 
> 时间：2008-09-25T15:33:38.287
> 
> 标签：apache-flex, actionscript-3, actionscript

我在 Flex 中有一个自定义登录组件，它是一个简单的表单，当用户单击登录按钮时会调度自定义 LoginEvent：

```
 <?xml version="1.0" encoding="utf-8"?>
<mx:Form xmlns:mx="http://www.adobe.com/2006/mxml" defaultButton="{btnLogin}">

    <mx:Metadata>
        [Event(name="login",tpye="events.LoginEvent")]
    </mx:Metadata>

    <mx:Script>

        import events.LoginEvent;

        private function _loginEventTrigger():void {
            var t:LoginEvent = new LoginEvent(
                LoginEvent.LOGIN,
                txtUsername.text,
                txtPassword.text);
            dispatchEvent(t);
        }

    </mx:Script>

    <mx:FormItem label="username:">
        <mx:TextInput id="txtUsername" color="black" />
    </mx:FormItem>
    <mx:FormItem label="password:">
        <mx:TextInput id="txtPassword" displayAsPassword="true" />
    </mx:FormItem>
    <mx:FormItem>
        <mx:Button id="btnLogin" 
            label="login" 
            cornerRadius="0" 
            click="_loginEventTrigger()" />
    </mx:FormItem>
</mx:Form> 
```

然后我有一个包含 flex 应用程序的 main.mxml 文件，我将组件添加到应用程序中没有任何问题：

```
 <custom:login_form id="cLogin" /> 

```

然后我尝试在动作脚本中连接我的事件：

```
 import events.LoginEvent;
cLogin.addEventListener(LoginEvent.LOGIN,_handler);
private function _handler(event:LoginEvent):void {
    mx.controls.Alert.show("logging in...");
} 

```

一切对我来说看起来都不错，但是当我编译时，我得到一个“未定义属性 cLogin 的错误......显然我可以控制 id 为“cLogin”，但我似乎无法获得“它的句柄”......我究竟做错了什么？

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-09-25T15:54:22.967

啊！我想通了……这是对我的一个很大的疏忽……这只是那些日子之一……

我无法获取组件的句柄，因为它尚未创建...我通过简单地等待组件的 creationComplete 事件触发然后添加事件侦听器来解决此问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-09-25T17:47:03.507

我相信你也可以做这样的事情：

```
<custom:login_form id='cLogin' login='_handler' /> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-26T12:22:54.913

> 我相信你也可以做这样的事情：
> 
> ```
> <custom:login_form id='cLogin' login='_handler' /> 
> ```

细微的澄清，因为原始代码似乎有些混乱。

事实上，这样做的原因是元数据标签已被用于声明以这种方式可用的事件。

```
<mx:Metadata>
    [Event(name="login", type="events.LoginEvent")]
</mx:Metadata> 
```

`login='_handler'`但是，当使用事件侦听器而不是组件“事件”属性 () 时，无需添加事件元数据：

```
cLogin.addEventListener(LoginEvent.LOGIN,_handler); 
```

*   addEventListener -> 不需要元数据标签
*   组件标签中的事件属性 -> 需要元数据标签

# iphone - 用于 iPhone 开发的 iPod touch

> ID：134048
> 
> 赞同：19
> 
> 时间：2008-09-25T15:35:44.943
> 
> 标签：iphone, app-store, ipod

我正在考虑购买 iPod touch，以便通过开发 iPhone 应用程序来赚钱。我喜欢 App Store 的概念，并通过 iTunes 快速浏览了一下。看起来应用程序被分类为 iPhone 或 iPod 应用程序。一些免费的 iPod 应用程序似乎对 iPhone 用户收费。

两个平台有什么区别，或者为什么 App Store 将它们分开？使用 iPod touch（除了电话/位置相关的应用程序）为 iPhone 开发是否有意义？

在 developer.apple.com 上，我可以注册在 AppStore 上以 99 美元的价格出售我的应用程序。我必须期待任何进一步的费用吗？从美国以外的地方发展（在我的情况下是德国）有问题吗？

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2008-09-25T15:37:53.737

缺少 iPod touch：

*   全球定位系统
*   蓝牙*（iPod Touch 4G 有蓝牙）*
*   蜂窝网络
*   摄像头*（iPod Touch 4G 有前后摄像头）*
*   麦克风（感谢[John Topley](https://stackoverflow.com/users/1450/john-topley)）*（iPod Touch 4G 有带麦克风的耳机）*
*   振动
*   1G没有扬声器

从好的方面来说，它的重量更轻，体积更小。除此之外，它们几乎完全相同（这里没有讽刺；它仍然具有相同的处理器、操作系统、控制系统和显示器）就我个人而言，我会买一部 iPhone ，因为无论如何你可能最终会得到一个。我有一个 iPod touch（先买）和一个 iPhone。我再也不用iPod了。

iPod touch 明显比 iPhone 便宜，而且不需要合约。但是，至少在英国你可以获得免合约的 iPhone，而且你应该很快就能在美国的 AT&T 上这样做。

除了 99 美元的应用程序开发费用（按年收费）外，没有额外费用

我们是从英国发展而来的。当您最终出售您的应用程序时需要注意的一个问题是预扣税 - Apple 将保留您 30% 的收入。您需要填写一些表格 - 我在[另一个线程](https://stackoverflow.com/questions/124093/tax-on-iphone-developer-payments#127200)中处理了这个问题。这是我在那里写的：

您需要填写[W-8BEN](http://www.irs.gov/pub/irs-pdf/fw8ben.pdf)并将其交给 Apple 以避免 30% 的预扣税。这要求您有一个 SSN（社会安全号码）。当且仅当您没有 SSN 时，您才可以提供 ITIN（个人纳税人识别号）或 EIN（雇主识别号）。

要获得 ITIN，您需要填写[W7](http://www.irs.gov/pub/irs-pdf/fw7.pdf)表格并将其提交给 IRS。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-09-25T16:06:33.013

我目前使用 iPod Touch 进​​行开发测试，但我的应用程序（目前）不使用任何 iPhone 独有的功能（例如 GPS 或相机）。

除了硬件差异之外，操作系统是相同的，而且 iPhone 会从手机运营商那里收取月费。

在 AppStore 中，您可以将您的应用程序标记为 iPhone Only 或 iPod & iPhone。如果您的应用程序需要详细的 GPS、拍照功能等，您只需将其设为 iPhone。

除非您发布应用程序的两个单独版本，否则无法根据用户是 iPod 还是 iPhone 为应用程序设置单独的定价。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-10-05T10:04:04.697

iPod touch 优点：

*   重量更轻
*   尺寸更小
*   与 iPhone 相同的操作系统和处理器
*   比 iPhone 便宜

iPod touch 缺点：

*   没有全球定位系统
*   没有蓝牙（iPod Touch 4G 有蓝牙）
*   没有蜂窝网络
*   无摄像头（iPod Touch 4G 有前后摄像头）
*   无麦克风（iPod Touch 4G 有带麦克风的耳机）
*   无振动

所以，我会建议去iPhone。在我看来，为 iPhone 和 Touch 开发应用程序将增加市场。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-09-28T03:31:20.377

我使用 iPhone 3G、iPhone 2G 和（原始）iPod Touch 进​​行开发。我真的很喜欢能够在所有可用的设备上进行测试。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-06-24T14:23:51.353

我发现使用 iPod touch (2G) 的最大问题是它 比 iPhone*快。*如果您正在开发游戏，那是很严重的。我发现 iPhone 3G 比我的 iPod 慢 10fps 左右，所以在提交应用程序之前，我可能无论如何都得花钱买 iPhone。我真的不期待您的普通电信合同中的虐待狂关系。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-09-25T15:42:40.233

如果您的目标是开发，我建议您跳过 iPod Touch 而直接使用 iPhone。它具有更多功能（GPS、蓝牙、蜂窝网络和相机），这使得可能实际使用的潜在应用范围更广。

# sql - 数据库重复值问题（基于先前值过滤）

> ID：134049
> 
> 赞同：1
> 
> 时间：2008-09-25T15:35:45.833
> 
> 标签：sql, performance, triggers, filtering, duplicate-data

本周早些时候，我问了一个关于在运行时按顺序过滤掉重复值的问题。有一些很好的答案，但我要处理的数据量很慢而且不可行。

目前在我们的数据库中，事件值未被过滤。导致重复的数据值（具有不同的时间戳）。我们需要在运行时处理这些数据，并且在数据库级别处理这些数据的时间成本很高（并且不能将其拉入代码中，因为它在存储过程中被大量使用）导致查询时间长。我们需要一个我们可以查询的数据结构，它过滤掉了这个数据存储，以便在运行时不需要额外的过滤。

**目前在我们的数据库中**

*   'F07331E4-26EC-41B6-BEC5-002AACA58337', '1', '2008-05-08 04:03:47.000'
*   'F07331E4-26EC-41B6-BEC5-002AACA58337', '0', '2008-05-08 10:02:08.000'
*   'F07331E4-26EC-41B6-BEC5-002AACA58337', '0', '2008-05-09 10:03:24.000' (需要删除) **
*   'F07331E4-26EC-41B6-BEC5-002AACA58337', '1', '2008-05-10 04:05:05.000'

**我们需要的**

*   'F07331E4-26EC-41B6-BEC5-002AACA58337', '1', '2008-05-08 04:03:47.000'
*   'F07331E4-26EC-41B6-BEC5-002AACA58337', '0', '2008-05-08 10:02:08.000'
*   'F07331E4-26EC-41B6-BEC5-002AACA58337', '1', '2008-05-10 04:51:05.000'

这似乎微不足道，但我们的问题是我们从无线设备获取这些数据，导致数据包乱序，并且我们的网关是多线程的，因此我们无法保证我们获得的值是有序的。可能会出现 4 秒前的“1”和 2 秒前的“0”，但我们已经处理了“1”，因为它是第一个进入的。我们一直在思考如何实现这一点。我们无法将数据与数据库中的最新值进行比较，因为最新的值实际上可能还没有进来，所以要丢弃这些数据，我们会被搞砸，我们的序列可能会完全关闭。所以目前我们存储每个传入的值，并且数据库根据时间自行洗牌。但是单元可以发送 1,1,1,0 并且它是有效的，因为事件仍然处于活动状态，

有任何想法吗？

询问您是否需要任何进一步的信息。

[编辑] PK 不起作用 - 问题是我们的单位实际上发送了不同的时间戳。所以PK不起作用，因为1,1,1是相同的..但是有不同的时间戳。它的类似事件在时间 1 发生，事件在时间 2 仍然发生，它把我们两个都发回......相同的值不同的时间。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-09-25T16:07:52.293

如果我理解正确，您要做的只是防止受骗者进入数据库。如果是这种情况，为什么不在前两列定义 PK（或唯一索引）并让数据库为您完成繁重的工作。根据您定义的 PK 或 AK，重复插入会失败。您的代码（或存储过程）将只需要优雅地处理该异常。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-09-25T18:23:17.070

这是一个更新解决方案。性能会因索引而异。

```
DECLARE @MyTable TABLE
(
  DeviceName varchar(100),
  EventTime DateTime,
  OnOff int,
  GoodForRead int
)

INSERT INTO @MyTable(DeviceName, OnOff, EventTime)
SELECT 'F07331E4-26EC-41B6-BEC5-002AACA58337', 1, '2008-05-08 04:03:47.000' 
INSERT INTO @MyTable(DeviceName, OnOff, EventTime)
SELECT 'F07331E4-26EC-41B6-BEC5-002AACA58337', 0, '2008-05-08 10:02:08.000' 
INSERT INTO @MyTable(DeviceName, OnOff, EventTime)
SELECT 'F07331E4-26EC-41B6-BEC5-002AACA58337', 0, '2008-05-09 10:03:24.000'
INSERT INTO @MyTable(DeviceName, OnOff, EventTime)
SELECT 'F07331E4-26EC-41B6-BEC5-002AACA58337', 1, '2008-05-10 04:05:05.000' 

UPDATE mt
SET GoodForRead = 
CASE
  (SELECT top 1 OnOff
   FROM @MyTable mt2
   WHERE mt2.DeviceName = mt.DeviceName
     and mt2.EventTime < mt.EventTime
   ORDER BY mt2.EventTime desc
  )
  WHEN null THEN 1
  WHEN mt.OnOff THEN 0
  ELSE 1
END
FROM @MyTable mt
    -- Limit the update to recent data
--WHERE EventTime >= DateAdd(dd, -1, GetDate())

SELECT *
FROM @MyTable 
```

不难想象基于此的过滤解决方案。这仅取决于您希望多长时间查找每条记录的上一条记录（每次查询或偶尔一次）。

# c# - 用于 Windows x64 上大文件的良好 ISAM 库或其他简单文件管理器

> ID：134052
> 
> 赞同：1
> 
> 时间：2008-09-25T15:36:20.763
> 
> 标签：c#, windows, file-io, 64-bit, isam

我们有一些非常大的数据文件（5 gig 到 1TB），我们需要快速读/写访问。由于我们有固定的记录大小，因此某种形式的 ISAM 似乎是可行的方法。但很高兴听到其他建议。

理想情况下，该解决方案将具有 Apache 或 LGPL 风格的许可证，但如果需要，我们将付费。

必备品：

可扩展 - 至少 1 TB 文件
稳定 - 不会损坏数据或具有快速恢复过程
在 X64 Windows 上运行良好

很高兴有：

可以参与 2 阶段提交
内部压缩工具
可移植到 *nix 平台
C# API 或 Java API

谢谢，

特伦斯

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-23T05:48:19.240

您还可以使用内置于 Windows 中的 ESENT 数据库引擎。就您的要求而言：

*   可扩展：最大数据库大小为 16TB。多 TB 数据库已在生产中使用。
*   稳定：使用预写日志记录进行崩溃恢复。
*   X64 Windows：ESENT 是 Windows 的一部分，因此它存在于您的 64 位计算机上。

很高兴有：

*   2 阶段提交：否。
*   压缩：没有。
*   可移植到 *nix：否。
*   C# API 或 Java API：不是真的（Codeplex 上有一个 C# 互操作层，但还不完整）。

文档在这里：http: [//msdn.microsoft.com/en-us/library/ms684493 (VS.85).aspx](http://msdn.microsoft.com/en-us/library/ms684493(VS.85).aspx)

您可以通过下载 Windows SDK 来获取头文件和库。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-25T15:52:22.800

试试[Berkeley DB](http://www.oracle.com/technology/products/berkeley-db/index.html)。意见各不相同，但它是可扩展的、稳定的（如果您使用所有必要的层）并且 AFAIK 在 x64 窗口上运行良好。也可移植到 *nix 并具有 C 和 Java API。不了解 C# API。

# sql-server - 更改列长度

> ID：134058
> 
> 赞同：3
> 
> 时间：2008-09-25T15:37:31.790
> 
> 标签：sql-server

我需要更改`column_length`500 多个表中列的长度，并且这些表可能没有从 10 条记录到 3 或 400 万条记录的记录。

1）该列可能只是一个普通列

```
create table test(column_length varchar(10)) 
```

2) 该列上可能包含非聚集索引。

```
create table test(column_length varchar(10))

CREATE UNIQUE NONCLUSTERED INDEX column_length_ind ON test (column_length) 
```

3) 该列可能包含`PRIMARY KEY`聚集索引

创建表测试（column_length varchar（10））

alter table test 在 column_length 上添加主键聚集索引

4) 该列可能是复合主键

5) 该列可能有外键引用

简而言之，该列`column_length`可能是任何东西。

我只需要创建脚本来将 column_length 的长度`varchar(10)`从`varchar(50)`

我应该在更改之前删除索引然后重新创建它们吗？主键和外键呢？

通过我的研究和测试，我发现...

我可以在不删除主键或任何索引的情况下更改列的长度，但必须单独删除并重新创建外键。

这是一个正确的假设吗？我需要对此进行验证。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-09-25T18:11:00.920

是的，您应该能够只修改列。根据我的经验，保留索引和主键会更快。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-25T18:23:38.410

您可能还需要在外键表上进行更改列以增加大小。因此，首先您删除 fk 约束，然后修复外键 kkey 字段，然后修复主键字段，然后重新设置约束。

# .net - 为什么 .NET 中的“输出”参数是个坏主意？

> ID：134063
> 
> 赞同：38
> 
> 时间：2008-09-25T15:38:37.560
> 
> 标签：.net

为什么 .NET 中的“输出”参数是个坏主意？

我最近被问到这个问题，但我没有真正的答案，除了它只是不必要地使应用程序复杂化。还有哪些其他原因？

* * *

## 回答 #1

> 赞同：65
> 
> 时间：2008-09-25T15:41:00.783

好吧，我认为他们不是一个坏主意。 `Dictionary<K, V>`有一个`TryGetValue`方法是一个很好的例子，为什么输出参数有时是一件非常好的事情。

当然，您不应该过度使用此功能，但根据定义，这不是一个坏主意。*尤其是在 C# 中，您必须在函数声明和*调用中写下`out`关键字，这使得发生的事情一目了然。

 ** * *

## 回答 #2

> 赞同：20
> 
> 时间：2012-11-13T18:23:34.720

如果您关心通过接受不变性和消除副作用来编写可靠的代码，那么输出参数绝对是一个糟糕的主意。它迫使您创建可变变量来处理它们。（并不是说 C# 无论如何都支持只读方法级变量（至少在我使用的版本中，3.5））。

其次，它们通过强制开发人员设置和处理接收输出值的变量来减少函数的组合性。这是令人讨厌的仪式。您不能随便使用它们轻松地编写表达式。因此，调用这些函数的代码很快就变成了一大堆命令式的混乱，为错误提供了很多隐藏的地方。

* * *

## 回答 #3

> 赞同：16
> 
> 时间：2008-09-25T15:44:19.510

他们是个好主意。因为有时您只想从一个方法返回多个变量，而您不想为此创建一个“沉重”的类结构。包装类结构可以隐藏信息流动的方式。

我用它来：

*   一次调用返回密钥和 IV 数据
*   将人名拆分为不同的实体（名字、中间名、姓氏）
*   拆分地址

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2008-09-25T16:15:04.100

Out - 我认为参数是一个坏主意。它们增加了副作用的风险并且难以调试。唯一好的解决方案是函数结果，问题是：对于函数结果，您必须为每个复杂结果创建一个元组或一个新类型。现在它在 c# 中应该相当容易，使用匿名类型和泛型。

顺便说一句：我也讨厌副作用。

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2008-09-26T03:44:39.980

问题的措辞是[“*你停止打你的妻子了吗？”* 多样性](http://en.wikipedia.org/wiki/Loaded_question "请参阅维基百科上的“加载的问题”")——它假设*输出*参数一定是个坏主意。在某些情况下可能会滥用*out*参数，但是……</p>

*   它们实际上非常适合 C# 语言。它们类似于*ref*参数，只是方法保证为它分配一个值并且调用者不需要初始化变量。

*   函数的正常返回值被推送到调用和退出它们的堆栈中。当你提供一个*out*参数时，你给方法一个特定的内存地址来保存结果。这也允许多个返回值，尽管使用结构通常更有意义。

*   它们非常适合 TryParse 模式，并且还为其他事物提供元数据，例如在 SQL-CLR 的情况下，*输出*参数映射到存储过程签名的*输出参数。*

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2008-09-25T15:44:42.677

我想说你的答案是正确的；这*通常是*不必要的复杂性，通常有一个更简单的设计。您在 .NET 中使用的大多数方法都不会改变它们的输入参数，因此使用这种语法的一次性方法有点令人困惑。代码变得不那么直观了，并且在记录不佳的方法的情况下，我们无法知道该方法对输入参数做了什么。

此外，没有参数的方法签名将触发代码分析/FxCop 违规，如果这是您关心的指标。在*大多数*情况下，有更好的方法来实现使用“out”参数的方法的意图，并且可以重构该方法以返回有趣的信息。

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2008-09-25T15:48:38.050

使用 out 参数并不总是一个坏主意。通常对于尝试基于某种形式的输入创建对象的代码，最好提供一个带有 out 参数和布尔返回值的**Try**方法，而不是强制方法使用者将 try catch 块全部包装起来，更不用说更好的表现。例子：

```
bool TryGetSomeValue(out SomeValue value, [...]); 
```

在这种情况下，输出参数是一个好主意。

另一种情况是您希望避免在方法之间传递代价高昂的大型结构。例如：

```
void CreateNullProjectionMatrix(out Matrix matrix); 
```

这个版本避免了昂贵的结构复制。

但是，除非出于特定原因需要 out，否则应避免使用。

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2008-09-25T17:20:52.290

好吧，对此没有明确的答案，但是 out 参数的简单用例是`Int.TryParse("1",out myInt)`

[XXX.TryParse](https://docs.microsoft.com/en-us/dotnet/api/system.int32.tryparse?view=netframework-4.7.2#System_Int32_TryParse_System_ReadOnlySpan_System_Char__System_Globalization_NumberStyles_System_IFormatProvider_System_Int32__)方法的作用是，它将某种类型的值转换为另一种类型，它返回一个布尔标志，表示转换成功或失败，一个是转换后的值，另一个是转换后的值，携带通过该方法中的 out 参数。

这个 TryParse 方法是在 .NET 2.0 中引入的，以克服[XXX.Parse](https://docs.microsoft.com/en-us/dotnet/api/system.int32.parse?view=netframework-4.7.2)将在转换失败时抛出异常并且您必须在`try/catch`语句周围放置以捕获它的事实。

所以基本上这取决于你的方法在做什么，以及方法调用者期望什么，如果你正在做一个返回某种形式的响应代码的方法，那么`out`参数可以用来执行方法返回的结果。

无论如何，微软在他们的[设计指南（MSDN页面）中说“](http://msdn.microsoft.com/en-us/library/ms182131(VS.80).aspx)*避免使用参数”*

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2008-09-25T15:45:15.017

我不认为他们是。滥用它们是一个坏主意，但这适用于任何编码实践/技术。

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2008-09-26T03:15:10.630

我会说我避免它的原因是因为让一个方法处理数据并返回一个逻辑数据是最简单的。如果它需要返回更多数据，它可能是进一步抽象或形式化返回值的候选者。

一个例外是如果返回的数据有点三级，比如可以为空的布尔值。它可以是真/假或未定义。out 参数可以帮助解决其他逻辑类型的类似想法。

我有时使用的另一种方法是当您需要通过不允许使用“更好”方法的界面获取信息时。例如使用 .Net 数据访问库和 ORM。当您需要返回更新的对象图（在 UPDATE 之后）或新的 RDBMS 生成的标识符 (INSERT) 以及受语句影响的行数时。SQL 在一个语句中返回所有这些，因此对方法的多次调用将不起作用，因为您的数据层、库或 ORM 仅调用一个通用 INSERT/UPDATE 命令，并且无法存储值以供以后检索。

理想的做法，例如从不使用动态参数列表或输出参数，并不总是可行的。同样，如果输出参数是真正正确的方法，请三思而后行。如果是这样，那就去吧。（但一定要做好记录！）

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2008-09-25T15:39:58.537

我会说你给出的答案是最好的。如果可能，您应该始终远离`out`参数进行设计，因为它通常会使代码变得不必要地复杂。

但这几乎适用于任何模式。如果不需要它，请不要使用它。

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2008-09-25T15:53:06.557

我不得不同意 GateKiller。如果微软将它们用作基础库的一部分，我无法想象参数会太糟糕。但是，与所有事物一样，最好适度。

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2008-09-25T15:56:50.150

就像 Tanqueray 人喜欢说的那样——一切都要适度。

我肯定会强调不要过度使用，因为它会导致“在 c# 中编写 c”，就像在 Python 中编写 java 一样（你不会接受使新语言特别的模式和习语，而是只需用旧语言思考并转换为新语法）。不过，一如既往，如果它可以帮助您的代码更优雅、更有意义，那就摇摆不定。

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2008-09-25T17:46:30.683

' `out`' 太棒了！

它**清楚地**表明参数包含方法要返回的值。

编译器还强制你**初始化**它（如果我们使用作为返回参数，它应该被初始化）。

* * *

## 回答 #15

> 赞同：1
> 
> 时间：2017-05-10T23:07:51.423

它们只是稍微破坏了方法/函数的语义。一个方法通常应该接受一堆东西，然后吐出一个东西。至少，这就是大多数程序员的想法（我认为）。

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2008-09-25T15:40:06.400

我认为没有真正的原因，尽管我没有看到它经常使用（除了[P/Invoke](http://en.wikipedia.org/wiki/Platform_Invocation_Services)调用）。

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2008-09-25T15:43:04.693

out 关键字是必需的（请参阅 参考资料`SortedDictionart.TryGetValue`）。它意味着通过引用传递，并且还告诉编译器以下内容：

```
int value;
some_function (out value); 
```

没问题，`some_function`并且没有使用通常是错误的未初始化值。

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2008-09-25T15:45:35.030

我认为在某些情况下它们是一个好主意，因为它们允许从函数返回多个对象，例如：

```
DateTime NewDate = new DateTime();
if (DateTime.TryParse(UserInput, out NewDate) == false) {
    NewDate = DateTime.Now;
} 
```

很有用 ：）

* * *

## 回答 #19

> 赞同：0
> 
> 时间：2008-09-25T16:01:28.720

[.NET](http://en.wikipedia.org/wiki/.NET_Framework)之外的一些语言将它们用作无操作宏，仅向程序员提供有关如何在函数中使用参数的信息。

* * *

## 回答 #20

> 赞同：0
> 
> 时间：2008-09-25T16:04:48.353

我没有看到提到的一点是 out 关键字还要求调用者指定 out。这很重要，因为它有助于确保调用者理解调用此函数将修改他的变量。

这就是我从不喜欢在 C++ 中使用引用作为输出参数的原因之一。调用者可以很容易地调用一个方法而不知道他的参数会被修改。

* * *

## 回答 #21

> 赞同：0
> 
> 时间：2014-12-14T15:48:56.750

我认为主要原因是“......虽然返回值很常见并且被大量使用，但正确应用**out** **和**ref 参数需要**中间的设计和编码技能**。为普通观众设计的图书馆架构师**不应该期望用户掌握**使用out 或 ref 参数。”

请阅读更多信息：http: [//msdn.microsoft.com/en-us/library/ms182131.aspx](http://msdn.microsoft.com/en-us/library/ms182131.aspx)

* * *

## 回答 #22

> 赞同：-1
> 
> 时间：2019-03-13T02:15:37.883

out 变量无论如何都不错，如果我们需要从函数返回多个（特别是 2 个）变量，它真的是一个很酷的东西。有时仅仅为了返回 2 个变量而创建自定义对象真的很乏味，out 是最终的解决方案。

# .net - 添加服务引用时忽略“重用现有类型”

> ID：134064
> 
> 赞同：5
> 
> 时间：2008-09-25T15:38:41.147
> 
> 标签：.net, visual-studio-2008, web-services

我正在为 Visual Studio 2008 中的一个项目添加服务引用。在“服务引用设置”屏幕上，我选择了默认选项，即“在所有引用的程序集中重用类型”。我已经引用了我想要重用类型的项目。该类型作为参数传递给 Web 方法。

但是，在生成 References.cs 文件时，它仍会创建该类型的重复代理版本。有什么我想念的吗？你需要对引用的类型做任何特别的事情吗？也许添加一些特殊属性？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-09-25T21:35:21.273

我已经回答了我自己的问题（我认为）。我试图做的是使用服务引用来指向现有的 ASP.NET Web 服务，但旧式 Web 服务不支持重用类型。它仅适用于 WCF 服务。所以我冒险将我的 Web 服务转换为真正的 WCF 服务，现在它可以正常工作了。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-11-18T20:20:47.797

我遇到了类似的问题，直到我在代码中定义了以下属性，以便将与服务合同相关的对象的命名空间设置为与常用引用类型相同的命名空间。

```
[assembly: ContractNamespace("YOUR_NAMESPACE_HERE")] 
```

# web-applications - 是否有任何适合触摸屏 Web 应用程序的 UI 组件？

> ID：134067
> 
> 赞同：4
> 
> 时间：2008-09-25T15:39:08.773
> 
> 标签：web-applications, user-interface, touchscreen

由于各种原因，Web 应用程序最适合我正在处理的项目，但我担心用户界面。将有很多可以通过检查列表、组合框等处理的选择选项……在较小程度上，它们将是一些自由文本字段。但是，我担心标准组件的可用性，因为用户将不得不从将安装在制造环境中的壁挂式触摸屏计算机访问应用程序（即它们将非常脏且维护不善）。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-09-25T16:47:55.100

我们目前正在推出与您描述的完全一样的应用程序。您将遇到许多问题。

在某些时候，您可能需要一个“软键盘”。我们还没有找到一个像样的第三方，但他们自己写也不是太难。

如果要实现将文本写入另一个控件的任何类型的按键按钮，则需要能够调用 SetStyle() 方法以确保焦点不会改变。我们发现 Janus 按钮控件不允许我们进行此更改，因此我们恢复为标准的 winforms 按钮。

我还没有看到任何专门为触摸屏设计的现有组件库。我们使用了标准 winforms 控件和 Janus UI 组件的组合。

如果我现在重新开始，我会从 WPF 开始。这是对 Winforms 的巨大改进，对我来说将是一个简单的选择。

如果您真的坚持在 Web 浏览器中执行此操作，那么我会认为 Silverlight 是一个可行的选择。就个人而言，对于快速数据输入很重要的应用程序，我永远不会接触 HTML。

不要忘记条形码输入，迟早有人会告诉你他们想用扫描仪进行输入。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-25T15:42:48.220

当触摸转换为点击时，您可能可以使用大部分标准组件，也可以使用 javascript 来补充。即，应该可以轻松地为每个切换相关复选框的标签实现 onClick 事件。

我会更担心文本输入。触摸屏打字（尤其是壁挂式）听起来很乏味。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-10T16:47:49.507

我目前正在自己​​开发一个触摸屏 Web 应用程序，并且一直想知道我什么时候“必须”放入软键盘。目前正在开发的模块仅处理订单输入和检索/调度功能，客户希望尽可能限制呼叫中心服务员的任何输入。所以还没有数据输入。

但是，我自己一直在寻找用于触摸屏的键盘。达里尔，如果我必须写一篇，你建议我从哪里开始？

祝你们俩好运！

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2010-06-25T19:45:04.603

您可能想看看 Baobab Health 的[开源触摸屏 takeit](http://github.com/baobab/touchscreentoolkit)。仅使用 javascript 将 html 表单转换为触摸屏交互效果很好。文档有点轻，但它至少可能是一个很好的起点。

# wpf - ListBox+WrapPanel 方向键导航

> ID：134068
> 
> 赞同：5
> 
> 时间：2008-09-25T15:39:19.990
> 
> 标签：wpf, listbox, wrappanel

我正在尝试实现等效于 WinForms`ListView`的`View`属性设置为`View.List`. 从视觉上看，以下工作正常。我的文件名`Listbox`从上到下，然后换行到一个新列。

这是我正在使用的基本 XAML：

```
<ListBox Name="thelist"
    IsSynchronizedWithCurrentItem="True"
    ItemsSource="{Binding}"
    ScrollViewer.VerticalScrollBarVisibility="Disabled">
    <ListBox.ItemsPanel>
        <ItemsPanelTemplate>
            <WrapPanel IsItemsHost="True"
                Orientation="Vertical" />
        </ItemsPanelTemplate>
    </ListBox.ItemsPanel>
</ListBox> 
```

但是，默认箭头键导航不会换行。如果选择了列中的最后一项，按向下箭头不会转到下一列的第一项。

我尝试`KeyDown`像这样处理事件：

```
private void thelist_KeyDown( object sender, KeyEventArgs e ) {
    if ( object.ReferenceEquals( sender, thelist ) ) {
        if ( e.Key == Key.Down ) {
            e.Handled = true;
            thelist.Items.MoveCurrentToNext();
        }
        if ( e.Key == Key.Up ) {
            e.Handled = true;
            thelist.Items.MoveCurrentToPrevious();
        }
    }
} 
```

这会产生我想要的最后一列到第一列的行为，但也会在左右箭头处理中产生奇怪的现象。每当它使用向上/向下箭头从一列换行到下一列/上一列时，随后使用左箭头键或右箭头键将选择移动到发生换行之前选择的项目的左侧或右侧。

假设列表中填充了字符串“0001”到“0100”，每列有 10 个字符串。如果我使用向下箭头键从“0010”转到“0011”，然后按向右箭头键，选择移动到“0020”，就在“0010”的右侧。如果选择了“0011”并且我使用向上箭头键将选择移动到“0010”，然后按下右箭头键将选择移动到“0021”（在“0011”的右侧，然后按下左侧箭头键将选择移动到“0001”。

任何帮助实现所需的列换行布局和箭头键导航将不胜感激。

（编辑移至我自己的答案，因为它在技术上是一个答案。）

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-09-25T20:40:36.070

事实证明，当我处理`KeyDown`事件时，选择更改为正确的项目，但焦点在旧项目上。

这是更新的事件处理程序`KeyDown`。由于绑定，该`Items`集合返回我的实际项目而不是`ListBoxItem`s，所以我必须在接近尾声时进行调用以获取`ListBoxItem`我需要调用的实际项目`Focus()`。`MoveCurrentToLast()`通过交换and的调用可以实现从最后一项到第一项的包装，反之亦然`MoveCurrentToFirst()`。

```
private void thelist_KeyDown( object sender, KeyEventArgs e ) {
    if ( object.ReferenceEquals( sender, thelist ) ) {
        if ( thelist.Items.Count > 0 ) {
            switch ( e.Key ) {
                case Key.Down:
                    if ( !thelist.Items.MoveCurrentToNext() ) {
                        thelist.Items.MoveCurrentToLast();
                    }
                    break;

                case Key.Up:
                    if ( !thelist.Items.MoveCurrentToPrevious() ) {
                        thelist.Items.MoveCurrentToFirst();
                    }
                    break;

                default:
                    return;
            }

            e.Handled = true;
            ListBoxItem lbi = (ListBoxItem) thelist.ItemContainerGenerator.ContainerFromItem( thelist.SelectedItem );
            lbi.Focus();
        }
    }
} 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-11-06T15:11:06.980

您应该能够在没有使用 KeyboardNavigation.DirectionalNavigation 的事件侦听器的情况下做到这一点，例如

```
<ListBox Name="thelist"
         IsSynchronizedWithCurrentItem="True"
         ItemsSource="{Binding}"
         ScrollViewer.VerticalScrollBarVisibility="Disabled"
         KeyboardNavigation.DirectionalNavigation="Cycle"> 
```

# c# - 哪些策略和工具可用于查找 .NET 中的内存泄漏？

> ID：134086
> 
> 赞同：155
> 
> 时间：2008-09-25T15:41:32.280
> 
> 标签：c#, .net, memory-management, memory-leaks

我写了 10 年的 C++。我遇到了内存问题，但可以通过合理的努力来解决它们。

在过去的几年里，我一直在编写 C#。我发现我仍然有很多记忆问题。由于不确定性，它们很难诊断和修复，而且因为 C# 的理念是，当你非常肯定地这样做时，你不应该担心这些事情。

我发现的一个特殊问题是我必须明确地处理和清理代码中的所有内容。如果我不这样做，那么内存分析器就没有真正的帮助，因为有太多的谷壳漂浮在你身上，你无法在他们试图向你展示的所有数据中找到泄漏。我想知道我是否有错误的想法，或者我所拥有的工具是否不是最好的。

什么样的策略和工具可用于解决 .NET 中的内存泄漏？

* * *

## 回答 #1

> 赞同：52
> 
> 时间：2008-09-25T15:43:44.177

当我怀疑内存泄漏时，我使用 Scitech 的[MemProfiler 。](http://memprofiler.com/)

到目前为止，我发现它非常可靠和强大。它至少有一次救了我的培根。

GC 在 .NET IMO 中运行良好，但就像任何其他语言或平台一样，如果你编写了糟糕的代码，就会发生糟糕的事情。

* * *

## 回答 #2

> 赞同：41
> 
> 时间：2008-09-25T16:26:38.287

仅针对忘记处置问题，请尝试[此博客文章中描述的解决方案](http://www.interact-sw.co.uk/iangblog/2004/03/23/locking)。这是本质：

```
 public void Dispose ()
    {
        // Dispose logic here ...

        // It's a bad error if someone forgets to call Dispose,
        // so in Debug builds, we put a finalizer in to detect
        // the error. If Dispose is called, we suppress the
        // finalizer.
#if DEBUG
        GC.SuppressFinalize(this);
#endif
    }

#if DEBUG
    ~TimedLock()
    {
        // If this finalizer runs, someone somewhere failed to
        // call Dispose, which means we've failed to leave
        // a monitor!
        System.Diagnostics.Debug.Fail("Undisposed lock");
    }
#endif 
```

* * *

## 回答 #3

> 赞同：17
> 
> 时间：2008-09-25T15:51:09.167

我们在项目中使用了 Red Gate 软件的[Ants Profiler Pro](http://www.red-gate.com/Products/ants_profiler/index.htm)。它适用于所有基于 .NET 语言的应用程序。

我们发现 .NET 垃圾收集器在清理内存对象时非常“安全”（应该如此）。它将保留对象只是因为我们将来**可能会使用它。**这意味着我们需要更加小心我们在内存中膨胀的对象数量。最后，我们将所有数据对象转换为“按需膨胀”（就在请求字段之前），以减少内存开销并提高性能。

编辑：这是我所说的“按需膨胀”的进一步解释。在我们数据库的对象模型中，我们使用父对象的属性来公开子对象。例如，如果我们有一些记录在一对一的基础上引用了一些其他“详细信息”或“查找”记录，我们将这样构建它：

```
class ParentObject
   Private mRelatedObject as New CRelatedObject
   public Readonly property RelatedObject() as CRelatedObject
      get
         mRelatedObject.getWithID(RelatedObjectID)
         return mRelatedObject
      end get
   end property
End class 
```

我们发现，当内存中有大量记录时，上述系统会产生一些实际的内存和性能问题。所以我们切换到一个系统，其中对象只在被请求时才被膨胀，数据库调用只在必要时进行：

```
class ParentObject
   Private mRelatedObject as CRelatedObject
   Public ReadOnly Property RelatedObject() as CRelatedObject
      Get
         If mRelatedObject is Nothing
            mRelatedObject = New CRelatedObject
         End If
         If mRelatedObject.isEmptyObject
            mRelatedObject.getWithID(RelatedObjectID)
         End If
         return mRelatedObject
      end get
   end Property
end class 
```

事实证明，这更有效，因为对象在需要它们之前一直保持在内存之外（访问 Get 方法）。它在限制数据库命中和内存空间方面提供了非常大的性能提升。

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2008-09-25T15:50:53.053

在编写托管代码时，您仍然需要担心内存，除非您的应用程序是微不足道的。我将建议两件事：首先，*通过 C# 阅读 CLR，*因为它将帮助您了解 .NET 中的内存管理。其次，学会使用像**CLRProfiler** (Microsoft) 这样的工具。这可以让您了解导致内存泄漏的原因（例如，您可以查看大对象堆碎片）

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2008-09-25T16:41:01.857

你在使用非托管代码吗？如果你不使用非托管代码，根据微软的说法，传统意义上的内存泄漏是不可能的。

但是，应用程序使用的内存可能不会被释放，因此应用程序的内存分配可能会在应用程序的整个生命周期内增长。

> 来自[Microsoft.com 上的如何识别公共语言运行时中的内存泄漏](http://support.microsoft.com/kb/318263)
> 
> 当您将非托管代码用作应用程序的一部分时，.NET Framework 应用程序中可能会发生内存泄漏。此非托管代码可能会泄漏内存，而 .NET Framework 运行时无法解决该问题。
> 
> 此外，项目可能只会出现内存泄漏。如果声明了许多大型对象（例如 DataTable 对象）然后将其添加到集合（例如 DataSet）中，则可能会出现这种情况。这些对象拥有的资源可能永远不会被释放，并且这些资源在程序的整个运行过程中都处于活动状态。这似乎是一个泄漏，但实际上它只是程序中内存分配方式的一个症状。

为了处理此类问题，您可以实现[IDisposable](http://msdn.microsoft.com/en-us/library/b1yfkh5e(VS.71).aspx)。如果您想了解一些处理内存管理的策略，我建议您搜索*IDisposable、XNA、内存管理*，因为游戏开发人员需要更多可预测的垃圾收集，因此必须强制 GC 做它的事情。

一个常见的错误是不删除订阅对象的事件处理程序。事件处理程序订阅将防止对象被回收。此外，请查看[using](http://msdn.microsoft.com/en-us/library/yh598w02(VS.80).aspx)语句，该语句允许您为资源的生命周期创建有限范围。

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2008-10-01T00:47:37.203

[这个博客](http://blogs.msdn.com/tess/archive/2008/05/21/the-21-most-popular-blog-posts.aspx)有一些非常精彩的演练，使用 windbg 和其他工具来追踪所有类型的内存泄漏。优秀的阅读来发展你的技能。

* * *

## 回答 #7

> 赞同：5
> 
> 时间：2015-10-22T15:03:29.867

我刚刚修复了 Windows 服务中的内存泄漏。

首先，我尝试[了 MemProfiler](http://memprofiler.com/)。我发现它真的很难使用，而且一点也不友好。

然后，我使用[了 JustTrace](http://www.telerik.com/products/memory-performance-profiler.aspx)，它更易于使用，并为您提供有关未正确处理的对象的更多详细信息。

它让我很容易解决内存泄漏问题。

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2008-09-25T16:22:09.920

如果您观察到的泄漏是由于缓存实现失控造成的，那么您*可能*需要考虑使用 Wea​​kReference。这有助于确保在必要时释放内存。

但是，恕我直言，最好考虑定制解决方案 - 只有您真正知道需要将对象保留多长时间，因此为您的情况设计适当的内务管理代码通常是最好的方法。

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2008-09-25T16:44:27.323

**Big guns - [Windows 调试工具](https://docs.microsoft.com/en-us/windows-hardware/drivers/debugger/debugger-download-tools)**

这是一个惊人的工具集合。您可以使用它分析托管和非托管堆，并且可以离线进行。这对于调试由于内存过度使用而不断回收的 ASP.NET 应用程序之一非常方便。我只需要创建一个在生产服务器上运行的活动进程的完整内存转储，所有分析都是在 WinDbg 中离线完成的。（事实证明，一些开发人员过度使用了内存中的会话存储。）

[“如果坏了就是……”](http://blogs.msdn.com/tess/default.aspx)博客有关于这个主题的非常有用的文章。

* * *

## 回答 #10

> 赞同：3
> 
> 时间：2018-03-02T19:12:13.640

我更喜欢Jetbrains 的[dotmemory](https://www.jetbrains.com/dotmemory/)

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2008-09-25T15:55:53.960

要记住的最好的事情是跟踪对对象的引用。很容易挂起对您不再关心的对象的引用。如果您不再使用某些东西，请摆脱它。

习惯于使用具有滑动到期的缓存提供程序，因此如果在所需的时间窗口内没有引用某些内容，则会取消引用并清理它。但如果它被大量访问，它会在内存中显示。

* * *

## 回答 #12

> 赞同：2
> 
> 时间：2008-09-25T16:12:48.397

最好的工具之一是使用[Debugging Tools for Windows ，并使用](http://www.microsoft.com/whdc/devtools/debugging/default.mspx "Windows 调试工具")**adplus**获取进程的内存转储，然后使用**windbg**和**sos**插件来分析进程内存、线程和调用堆栈。

您也可以使用此方法来识别服务器上的问题，在安装工具后，共享目录，然后使用 (net use) 从服务器连接到共享，然后执行崩溃或挂起进程转储。

然后离线分析。

* * *

## 回答 #13

> 赞同：2
> 
> 时间：2012-09-17T04:01:37.843

在对托管应用程序进行了一次修复之后，我遇到了同样的事情，比如如何验证我的应用程序在下一次更改后不会有相同的内存泄漏，所以我写了类似对象发布验证框架的东西，请看一下NuGet 包[ObjectReleaseVerification](https://nuget.org/packages/ObjectReleaseVerification)。您可以在此处找到示例[https://github.com/outcoldman/OutcoldSolutions-ObjectReleaseVerification-Sample](https://github.com/outcoldman/OutcoldSolutions-ObjectReleaseVerification-Sample)以及有关此示例的信息[http://outcoldman.ru/en/blog/show/322](http://outcoldman.ru/en/blog/show/322)

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2018-05-04T23:03:07.907

从 Visual Studio 2015 开始考虑使用开箱即用的[**内存使用诊断工具**](https://docs.microsoft.com/en-us/visualstudio/profiling/memory-usage) 来收集和分析内存使用数据。

内存使用工具可让您拍摄托管和本机内存堆的一个或多个快照，以帮助了解对象类型的内存使用影响。

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2020-04-07T07:48:31.773

我使用它的 DotMemory 的最佳工具之一。您可以将此工具用作 VS 中的扩展。运行您的应用程序后，您可以分析您的应用程序使用的内存的每个部分（按对象、命名空间等）并拍摄一些快照, 与其他快照比较。 [点内存](https://www.jetbrains.com/dotmemory/)

# svn - 分叉开源项目的最佳实践是什么？

> ID：134090
> 
> 赞同：8
> 
> 时间：2008-09-25T15:42:13.400
> 
> 标签：svn, version-control, open-source, branch

我需要定制一个开源项目。这些更改是针对特定组织的，对公共项目没有用处。代码更改包括禁用组织不需要的功能（影响 5% 的代码）、为组织定制其他功能（影响 20% 的代码）以及添加新的自定义功能（添加大约 10% 的新代码）。

我可以从当前版本开始并从那里进行自定义。但是，原始项目继续取得进展并引入新功能，我希望能够在这些改进出现时将其纳入。

管理此问题的最佳方法是什么？现在，我只能在发布版本可用时获得它们，但我应该很快就可以只读访问原始项目的 Subversion 存储库。我是使用 Subversion 存储库的新手，但也可以将它们用于我的代码。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-09-25T15:48:30.390

最佳实践是首先尝试将您的更改合并到项目中。

如果这不是一个选择，你只是

1.  导入他们当前的 HEAD，
2.  在分支中进行修改
3.  从他们的更新你的树
4.  合并和重新分支

第 3 步和第 4 步与您的前叉保持最新有关。这是很多工作，取决于项目的活动和保持最新状态的重要性。如果非常重要，我会每周至少更新和合并一次。

您可能更喜欢将他们的 svn 树导入 git 以简化合并，这是您最常做的事情

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2008-09-25T15:47:27.850

最好的办法是不要分叉它。为什么不弄清楚如何改进它，这样它就可以做你想做的事情并且不会丢失任何现有的功能。如果代码大小是一个问题，也许你可以花一些时间来提高现有项目的效率。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-09-25T18:41:09.663

我认为将您的东西放到上游是最安全的方式，因为您可以免费获得所有错误修复，并且上游所做的更改不会破坏您的东西，因为其他贡献者也必须尊重您的“功能”，因为他们是项目中的一等公民. 如果这不是一个可行的选择，我会说带有颠覆桥的[git](http://git.or.cz/)是要走的路，因为它已经有很多对分叉有用的功能，这是在 git 中做事的自然方式，因为一切都是一种不同回购的叉子。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-09-25T16:03:31.070

你和项目负责人谈过吗？您的更改是否具有普遍意义，还是非常适合您的需求？如果你不能在主项目中做你需要的工作，你当然可以分支他们的树，只要继续合并就行了。

您也可以查看 GIT 之类的功能（它可以与原始 svn 很好地交互）以接受部分合并/补丁。分歧越大，这个问题就越严重。当然，您可以使用 svn 和一个好的编辑器来完成，但使用更灵活的工具可能会使您的生活变得更轻松。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2010-02-18T02:13:21.473

这是 Visko 建议的变体，相反的假设是您将花费大部分时间进行自己的更改，并且只是偶尔集成原始源项目的新版本。（使用下面的颠覆词汇。）

1.  创建项目，将 original-source 作为主干提交。标签。

2.  当您进行本地更改时，根据需要使用分支，合并回主干以进行发布等。

3.  当您想要集成原始源项目的新版本时：

    *   为它做一个分支；
    *   在分支文件上加载（hack）源；
    *   将主干合并到分支中（因为它可能需要一些时间，而且你不想破坏你的主干）；
    *   然后将分支合并回主干。标签。

这就是我在脑海中设计的供我自己使用的过程。希望得到反馈。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-09-25T15:47:49.783

导入原始项目的 subversion-dump 并使用自己的存储库作为分支启动您的 fork - 随着原始项目的改进，您可以导入更改，然后调用“svn merge”来合并这些改进。只要您和原始项目不进行一些重组（重命名源文件，在目录之间移动等），合并应该主要工作。

# tdd - 开发 N 层应用程序。朝什么方向？

> ID：134094
> 
> 赞同：2
> 
> 时间：2008-09-25T15:42:52.620
> 
> 标签：tdd, n-tier-architecture

假设您正在实现一个用户故事，该用户故事需要在从 UI（或服务外观）到 DB 的所有层中进行更改。

你往哪个方向移动？

*   从 UI 到业务层到存储库到数据库？
*   从数据库到存储库到业务层到 UI？
*   这取决于。（什么 ？）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-09-27T01:52:09.547

我见过的此类问题的最佳答案是由 Atomic Object 人员和他们的[Presenter First](http://en.wikipedia.org/wiki/Presenter_First)模式提供的。基本上，它是 MVP 模式的一种实现，其中（顾名思义）您从 Presenter 开始工作。

This provides you with a very light-weight object (since the presenter is basically there to marshal data from the Model to the View, and events from the View to the Model) that can directly model your set of user actions. When working on the Presenter, the View and Model are typically defined as interfaces, and mocked, so your initial focus is on defining how the user is interacting with your objects.

I generally like to work in this way, even if I'm not doing a strict MVP pattern. I find that focusing on user interaction helps me create business objects that are easier to interact with. We also use [Fitnesse](http://www.fitnesse.org/) in house for integration testing, and I find that writing the fixtures for Fitnesse while building out my business objects helps keep things focused on the user's perspective of the story.

I have to say, though, that you end up with a pretty interesting TDD cycle when you start with a failing Fitnesse test, then create a failing Unit Test for that functionality, and work your way back up the stack. In some cases I'm also writing Database unit tests, so there is another layer of tests that get to be written, failed, and passed, before the Fitnesse tests pass.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-25T17:31:52.030

如果可能发生变化，请从前面开始。您可以立即从股东那里获得反馈。谁知道？也许他们实际上并不知道他们想要什么。观察他们使用界面（UI、服务或其他）。他们的行为可能会激发您以新的眼光看待问题。如果您可以在编码域对象和数据库之前捕获更改，则可以节省大量时间。

如果要求是严格的，那么它就不那么重要了。从可能最困难的层开始——尽早解决风险。归根结底，这是“艺术多于科学”的问题之一。这可能是创建最佳解决方案的层设计之间的微妙相互作用。

干杯。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-25T15:45:40.007

我会自下而上，因为你会很快得到一些工作结果（即你可以在没有用户界面的情况下编写单元测试，但在模型完成之前不能测试用户界面）。

不过也有其他意见。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-25T15:53:40.940

我将开始对问题域进行建模。创建代表系统实体的相关类。一旦我对此有信心，我就会尝试找到一个可行的映射来将实体持久化到数据库中。如果您在拥有域模型之前在 UI 中投入了太多工作，那么之后您需要重新设计 UI 的风险很大。

考虑到这一点，您可能需要对所有图层进行一些更新...... =）

# php - PDO 准备好的语句是否足以防止 SQL 注入？

> ID：134099
> 
> 赞同：711
> 
> 时间：2008-09-25T15:43:35.270
> 
> 标签：php, security, pdo, sql-injection

假设我有这样的代码：

```
$dbh = new PDO("blahblah");

$stmt = $dbh->prepare('SELECT * FROM users where username = :username');
$stmt->execute( array(':username' => $_REQUEST['username']) ); 
```

PDO 文档说：

> 准备好的语句的参数不需要引用；司机为您处理。

**这真的是我需要做的一切来避免 SQL 注入吗？真的那么容易吗？**

如果它有所作为，您可以假设 MySQL。另外，我真的只是对使用准备好的语句来对抗 SQL 注入感到好奇。在这种情况下，我不关心 XSS 或其他可能的漏洞。

* * *

## 回答 #1

> 赞同：889
> 
> 时间：2012-08-30T17:22:04.327

简短的回答是**否定**的，PDO 准备不会保护您免受所有可能的 SQL 注入攻击。对于某些模糊的边缘情况。

我正在调整[这个答案](https://stackoverflow.com/a/12118602/338665)来谈论 PDO ......

长答案并不容易。[它基于此处演示](http://shiflett.org/blog/2006/jan/addslashes-versus-mysql-real-escape-string)的攻击。

# 攻击

所以，让我们从展示攻击开始......

```
$pdo->query('SET NAMES gbk');
$var = "\xbf\x27 OR 1=1 /*";
$query = 'SELECT * FROM test WHERE name = ? LIMIT 1';
$stmt = $pdo->prepare($query);
$stmt->execute(array($var)); 
```

在某些情况下，这将返回超过 1 行。让我们剖析一下这里发生了什么：

1.  **选择字符集**

    ```
    $pdo->query('SET NAMES gbk'); 
    ```

    为了使这种攻击起作用，我们需要服务器在连接上期望的编码既要编码`'`为 ASCII ie `0x27` *，*又要有一些字符，其最后一个字节是 ASCII `\`ie `0x5c`。事实证明，MySQL 5.6 默认支持 5 种这样的编码：`big5`、`cp932`、`gb2312`和. 我们会在这里选择。`gbk``sjis``gbk`

    现在，注意`SET NAMES`这里的使用非常重要。**这会在服务器**上设置字符集。还有另一种方法，但我们很快就会到达那里。

2.  **有效载荷**

    我们将用于此注入的有效负载以字节序列开头`0xbf27`。在`gbk`中，这是一个无效的多字节字符；在`latin1`，它是字符串`¿'`。请注意， in`latin1` **和** `gbk`,`0x27`本身就是一个文字`'`字符。

    我们选择了这个payload，因为如果我们调用`addslashes()`它，我们会在字符之前插入一个ASCII `\`ie 。所以我们最终会得到，它是一个两个字符的序列：后跟. 或者换句话说，一个*有效*字符后跟一个未转义的. 但我们没有使用. 那么进行下一步...`0x5c``'``0xbf5c27``gbk``0xbf5c``0x27`*`'``addslashes()`*

**   **$stmt->执行()**

    这里要意识到的重要一点是，PDO 默认情况下不会**执行**真正的准备好的语句。它模拟它们（对于 MySQL）。因此，PDO 在内部构建查询字符串，`mysql_real_escape_string()`在每个绑定的字符串值上调用（MySQL C API 函数）。

    C API 调用的`mysql_real_escape_string()`不同之处`addslashes()`在于它知道连接字符集。因此它可以对服务器期望的字符集进行正确的转义。然而，到目前为止，客户端认为我们仍在使用`latin1`连接，因为我们从未告诉过它。我们确实告诉了我们正在使用的*服务器*`gbk`，但*客户端*仍然认为它是`latin1`.

    因此，调用`mysql_real_escape_string()`插入反斜杠，我们`'`的“转义”内容中有一个自由悬挂字符！事实上，如果我们查看字符集`$var`，`gbk`我们会看到：

    ```
    缞' OR 1=1 /*
    ```

    这正是攻击所需要的。

    *   **查询**

    这部分只是一种形式，但这里是呈现的查询：

    ```
    SELECT * FROM test WHERE name = '縗' OR 1=1 /*' LIMIT 1 
    ```* 

 *恭喜，您刚刚使用 PDO Prepared Statements 成功攻击了一个程序...

# 简单的修复

现在，值得注意的是，您可以通过禁用模拟的准备好的语句来防止这种情况：

```
$pdo->setAttribute(PDO::ATTR_EMULATE_PREPARES, false); 
```

这*通常会*导致一个真正的准备好的语句（即数据在一个单独的数据包中与查询一起发送）。但是，请注意 PDO 将默默地[回](https://github.com/php/php-src/blob/master/ext/pdo_mysql/mysql_driver.c#L210)退到模拟 MySQL 本身无法准备的语句：那些它可以在手册中[列出](http://dev.mysql.com/doc/en/sql-syntax-prepared-statements.html)的语句，但要注意选择适当的服务器版本）。

# 正确的修复

这里的问题是我们没有调用 C API`mysql_set_charset()`而不是`SET NAMES`. 如果我们这样做了，只要我们使用自 2006 年以来的 MySQL 版本就可以了。

如果您使用的是较早的 MySQL 版本，那么一个[错误意味着](http://bugs.mysql.com/bug.php?id=8378)*即使客户端已正确通知连接编码*，也会将无效的多字节字符（例如我们的有效负载中`mysql_real_escape_string()`的那些字符）视为单字节以进行转义，因此这种攻击会仍然成功。该错误已在 MySQL [4.1.20、5.0.22](http://dev.mysql.com/doc/refman/4.1/en/news-4-1-20.html)和[5.1.11](http://dev.mysql.com/doc/relnotes/mysql/5.1/en/news-5-1-11.html)中[修复](http://dev.mysql.com/doc/relnotes/mysql/5.0/en/news-5-0-22.html)。

 *但最糟糕的部分是直到 5.3.6`PDO`才公开 C API `mysql_set_charset()`，因此在之前的版本中，它**无法**针对每个可能的命令阻止这种攻击！它现在作为[DSN 参数](http://www.php.net/manual/en/ref.pdo-mysql.connection.php)公开，应该使用它**而不是** `SET NAMES`...

# 拯救恩典

正如我们一开始所说，要使这种攻击起作用，必须使用易受攻击的字符集对数据库连接进行编码。 [`utf8mb4`](http://dev.mysql.com/doc/en/charset-unicode-utf8mb4.html)不*易受攻击*，但可以支持*每个*Unicode 字符：因此您可以选择使用它来代替 - 但它仅在 MySQL 5.5.3 之后才可用。另一种方法是[`utf8`](http://dev.mysql.com/doc/en/charset-unicode-utf8.html)，它也*不易受到攻击*，并且可以支持整个 Unicode[基本多语言平面](http://en.wikipedia.org/wiki/Plane_(Unicode)#Basic_Multilingual_Plane)。

或者，您可以启用[`NO_BACKSLASH_ESCAPES`](http://dev.mysql.com/doc/en/sql-mode.html#sqlmode_no_backslash_escapes)SQL 模式，该模式（除其他外）会改变`mysql_real_escape_string()`. 启用此模式后，`0x27`将替换为`0x2727`而不是`0x5c27`，因此转义过程*无法*在之前不存在的任何易受攻击的编码中创建有效字符（即`0xbf27`仍然存在`0xbf27`等），因此服务器仍将拒绝该字符串为无效. 但是，请参阅[@eggyal 的回答](https://stackoverflow.com/a/23277864/623041)，了解使用此 SQL 模式可能产生的不同漏洞（尽管不是使用 PDO）。

# 安全示例

以下示例是安全的：

```
mysql_query('SET NAMES utf8');
$var = mysql_real_escape_string("\xbf\x27 OR 1=1 /*");
mysql_query("SELECT * FROM test WHERE name = '$var' LIMIT 1"); 
```

因为服务器期望`utf8`...

```
mysql_set_charset('gbk');
$var = mysql_real_escape_string("\xbf\x27 OR 1=1 /*");
mysql_query("SELECT * FROM test WHERE name = '$var' LIMIT 1"); 
```

因为我们已经正确设置了字符集，所以客户端和服务器匹配。

```
$pdo->setAttribute(PDO::ATTR_EMULATE_PREPARES, false);
$pdo->query('SET NAMES gbk');
$stmt = $pdo->prepare('SELECT * FROM test WHERE name = ? LIMIT 1');
$stmt->execute(array("\xbf\x27 OR 1=1 /*")); 
```

因为我们已经关闭了模拟的准备好的语句。

```
$pdo = new PDO('mysql:host=localhost;dbname=testdb;charset=gbk', $user, $password);
$stmt = $pdo->prepare('SELECT * FROM test WHERE name = ? LIMIT 1');
$stmt->execute(array("\xbf\x27 OR 1=1 /*")); 
```

因为我们已经正确设置了字符集。

```
$mysqli->query('SET NAMES gbk');
$stmt = $mysqli->prepare('SELECT * FROM test WHERE name = ? LIMIT 1');
$param = "\xbf\x27 OR 1=1 /*";
$stmt->bind_param('s', $param);
$stmt->execute(); 
```

因为 MySQLi 一直在做真正的准备好的语句。

# 包起来

如果你：

*   使用 MySQL 的现代版本（5.1 后期，所有 5.5、5.6 等）**和**PDO 的 DSN 字符集参数（在 PHP ≥ 5.3.6 中）

**或者**

*   不要使用易受攻击的字符集进行连接编码（你只使用`utf8`///等`latin1`）`ascii`

**或者**

*   启用`NO_BACKSLASH_ESCAPES`SQL 模式

你是 100% 安全的。

否则，**即使您使用 PDO 准备语句，您也很容易受到攻击……**

# 附录

我一直在慢慢地研究一个补丁来改变默认不模拟为 PHP 的未来版本做准备。我遇到的问题是，当我这样做时，很多测试都会中断。一个问题是模拟准备只会在执行时抛出语法错误，但真正的准备会在准备时抛出错误。所以这可能会导致问题（并且是测试失败的部分原因）。

* * *

## 回答 #2

> 赞同：521
> 
> 时间：2008-09-25T15:50:51.960

准备好的语句/参数化查询通常足以防止对该语句^(*进行)*一阶*注入。如果您在应用程序的其他任何地方使用未经检查的动态 sql，您仍然容易受到*二阶*注入的攻击。

 *二阶注入意味着数据在被包含在查询中之前已经在数据库中循环一次，并且更难实现。AFAIK，您几乎从未见过真正的工程二阶攻击，因为攻击者通常更容易进行社会工程攻击，但有时会由于额外的良性`'`字符或类似字符而出现二阶错误。

当您可以将一个值存储在稍后用作查询中的文字的数据库中时，您可以完成二阶注入攻击。例如，假设您在网站上创建帐户时输入以下信息作为新用户名（假设此问题为 MySQL DB）：

```
' + (SELECT UserName + '_' + Password FROM Users LIMIT 1) + ' 
```

如果对用户名没有其他限制，则准备好的语句仍将确保上述嵌入式查询在插入时不执行，并将值正确存储在数据库中。但是，假设稍后应用程序从数据库中检索您的用户名，并使用字符串连接将该值包含在一个新查询中。您可能会看到其他人的密码。由于 users 表中的前几个名字往往是管理员，因此您可能也刚刚放弃了农场。（另请注意：这是不以纯文本形式存储密码的另一个原因！）

然后我们看到，准备好的语句对于单个查询就足够了，但是它们本身**不足以**防止整个应用程序中的 sql 注入攻击，因为它们缺乏一种机制来强制对应用程序中的数据库的所有访问使用安全代码。然而，作为良好应用程序设计的一部分——可能包括代码审查或静态分析等实践，或使用限制动态 sql 的 ORM、数据层或服务层——***准备好的语句*****是*解决 Sql 注入的主要工具问题。***如果您遵循良好的应用程序设计原则，例如将您的数据访问与程序的其余部分分开，则很容易强制或审核每个查询正确使用参数化。在这种情况下，完全防止了sql注入（一阶和二阶）。

* * *

[^*事实证明，当涉及到宽字符时，MySql/PHP （好吧，曾经）只是在处理参数方面很愚蠢，并且在[此处其他高度投票的答案](https://stackoverflow.com/a/12202218/3043)中仍然概述了一种*罕见*的情况，它可以允许注入通过参数化询问。]

* * *

## 回答 #3

> 赞同：46
> 
> 时间：2010-04-21T09:00:06.190

不，它们并非总是如此。

这取决于您是否允许将用户输入放置在查询本身中。例如：

```
$dbh = new PDO("blahblah");

$tableToUse = $_GET['userTable'];

$stmt = $dbh->prepare('SELECT * FROM ' . $tableToUse . ' where username = :username');
$stmt->execute( array(':username' => $_REQUEST['username']) ); 
```

将容易受到 SQL 注入的攻击，并且在此示例中使用准备好的语句将不起作用，因为用户输入被用作标识符，而不是数据。这里的正确答案是使用某种过滤/验证，例如：

```
$dbh = new PDO("blahblah");

$tableToUse = $_GET['userTable'];
$allowedTables = array('users','admins','moderators');
if (!in_array($tableToUse,$allowedTables))    
 $tableToUse = 'users';

$stmt = $dbh->prepare('SELECT * FROM ' . $tableToUse . ' where username = :username');
$stmt->execute( array(':username' => $_REQUEST['username']) ); 
```

注意：您不能使用 PDO 绑定 DDL（数据定义语言）之外的数据，即这不起作用：

```
$stmt = $dbh->prepare('SELECT * FROM foo ORDER BY :userSuppliedData'); 
```

以上不起作用的原因是因为`DESC`and `ASC`are not *data*。PDO 只能对*数据*进行转义。其次，你甚至不能`'`在它周围加上引号。允许用户选择排序的唯一方法是手动过滤并检查它是否为`DESC`或`ASC`。

* * *

## 回答 #4

> 赞同：29
> 
> 时间：2008-09-25T15:55:46.533

是的，这就足够了。注入类型攻击的工作方式是通过某种方式让一个解释器（数据库）来评估一些本来应该是数据的东西，就好像它是代码一样。这只有在您将代码和数据混合在同一介质中时才有可能（例如，当您将查询构造为字符串时）。

参数化查询通过分别发送代码和数据来工作，因此*永远*不可能在其中找到漏洞。

但是，您仍然容易受到其他注入类型的攻击。例如，如果您在 HTML 页面中使用数据，您可能会受到 XSS 类型的攻击。

* * *

## 回答 #5

> 赞同：29
> 
> 时间：2012-08-30T17:00:15.760

不，这还不够（在某些特定情况下）！默认情况下，当使用 MySQL 作为数据库驱动程序时，PDO 使用模拟的准备好的语句。在使用 MySQL 和 PDO 时，您应该始终禁用模拟的预准备语句：

```
$dbh->setAttribute(PDO::ATTR_EMULATE_PREPARES, false); 
```

另一件总是应该做的事情是设置数据库的正确编码：

```
$dbh = new PDO('mysql:dbname=dbtest;host=127.0.0.1;charset=utf8', 'user', 'pass'); 
```

另请参阅此相关问题：[如何防止 PHP 中的 SQL 注入？](https://stackoverflow.com/questions/60174/best-way-to-prevent-sql-injection-in-php/60496)

另请注意，这仅是关于数据库方面的事情，您在显示数据时仍然需要注意自己。例如，`htmlspecialchars()`再次使用正确的编码和引用样式。

* * *

## 回答 #6

> 赞同：14
> 
> 时间：2008-09-25T15:50:43.770

就我个人而言，我总是会首先对数据进行某种形式的清理，因为您永远无法信任用户输入，但是当使用占位符/参数绑定时，输入的数据将分别发送到服务器到 sql 语句，然后绑定在一起。这里的关键是，这将提供的数据绑定到特定类型和特定用途，并消除任何更改 SQL 语句逻辑的机会。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2018-03-04T20:17:56.390

即使您要防止 sql 注入前端，使用 html 或 js 检查，您也必须考虑前端检查是“可绕过的”。

您可以禁用 js 或使用前端开发工具（现在内置于 firefox 或 chrome）编辑模式。

因此，为了防止 SQL 注入，清理控制器内部的输入日期后端是正确的。

我想建议您使用 filter_input() 本机 PHP 函数来清理 GET 和 INPUT 值。

如果您想继续安全，对于明智的数据库查询，我想建议您使用正则表达式来验证数据格式。preg_match() 在这种情况下会帮助你！但请注意！正则表达式引擎不是那么轻。仅在必要时使用它，否则您的应用程序性能将下降。

安全是有代价的，但不要浪费你的表现！

简单的例子：

如果您想仔细检查从 GET 收到的值是否为数字，则小于 99 if(!preg_match('/[0-9]{1,2}/')){...}

```
if (isset($value) && intval($value)) <99) {...} 
```

所以，最终的答案是：“不！PDO Prepared Statements 不会阻止所有类型的 sql 注入”；它不会阻止意外的值，只是意外的连接

# perforce - 您如何在 Perforce 中搜索更改列表描述的文本？

> ID：134103
> 
> 赞同：73
> 
> 时间：2008-09-25T15:44:09.213
> 
> 标签：perforce

有时，我发现自己想在 Perforce 中搜索更改列表描述的文本。在 P4V 中似乎没有办法做到这一点。我可以通过将更改命令的输出重定向到文件来做到这一点......

```
p4 changes -l > p4changes.txt 
```

...（-l 开关告诉它转储更改列表描述的全文）然后搜索文件，但这相当麻烦。有没有人找到更好的方法？

* * *

## 回答 #1

> 赞同：70
> 
> 时间：2008-12-01T22:26:26.420

当提交的更改列表窗格具有焦点时，CTRL+F 允许您进行任意文本搜索，其中包括更改列表描述。

唯一的限制是它只搜索那些从服务器获取的更改列表，因此您可能需要增加检索到的数量。这是通过“一次获取的更改列表、作业、分支映射或标签的数量”设置完成的，可以通过导航到“编辑”->“首选项”->“服务器数据”找到该设置。

* * *

## 回答 #2

> 赞同：22
> 
> 时间：2009-10-15T11:54:49.423

`p4 changes -L | grep -B 3 searchstring`

`-B 3`表示在匹配的字符串之前显示 3 行，应该足以显示带有 2 行注释的更改 ID，但您可以根据需要进行更改。

* * *

## 回答 #3

> 赞同：17
> 
> 时间：2008-09-25T15:57:06.657

我使用[p4sql](http://www.perforce.com/perforce/doc.current/manuals/p4report/01_install.html)并在“更改”数据库上运行查询。这是[perforce 数据库模式](http://www.perforce.com/perforce/doc.current/manuals/p4report/aa_schema.html)

查询看起来像这样（未经测试）

```
select change from changes where description like '%text%' and p4options = 'longdesc' 
```

编辑：添加了 p4options 以在描述中返回超过 31 个字符。

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2010-10-07T11:13:52.943

这是 Paul 的“grep”答案的 Powershell 版本。再次，它在更改描述中搜索指定的字符串并返回它之前的 3 行，以包含更改 ID：

```
p4 changes -L | select-string "search string" -Context (3,0) 
```

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2012-09-15T23:55:37.737

`less`当您可以通过管道输出并使用搜索时，为什么要重定向到文件`less`？

```
p4 changes -l | less 
```

然后按`/`提示输入搜索字符串。之后，`n`将跳转到下一场比赛，`Shift`+`n`将跳转到上一场比赛。

Windows的实现`less`可作为[UnxUtils](http://unxutils.sourceforge.net/)的一部分使用。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-09-25T17:16:23.940

使用 p4sql 确实是有效地做你想做的事情的唯一方法。我不知道任何其他方式。当然，好处是您可以使用 select 语句来限制更改列表值的范围（通过日期、用户等）。您的方法将有效，但随着您生成更多更改列表，很快就会变得很麻烦。您可以限制更改命令的范围，但不会获得 p4sql 的灵活性。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-06-24T19:45:51.980

Eddie on Games 在[http://www.eddiescholtz.com/blog/archives/130上发布了他的 Perforce Changelist Search 0.1](http://www.eddiescholtz.com/blog/archives/130)

但是，我喜欢使用我最喜欢的文本编辑器和简单的：p4 changes -s 提交 //prog/stuff/main/... >temp.txt

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-11-21T06:47:00.717

如果你仍然喜欢你的命令行，你可以编写一个小的 perl 脚本：

*   将记录分隔符 $/ 更改为双换行符“\n\n”，以便将输入过滤为 ztagged p4 输出的完整记录。
*   使用 args 中的正则表达式扫描 '/^... desc/..//' 部分。

用法类似于 'p4 -ztag changes -l | yourperlfilter.pl searchterm1 searchterm2'

如果一切正常，您可以[将其集成到 p4win 工具菜单](http://markmail.org/message/ipcpb4ddbqhdmt43)中。

# sharepoint - Sharepoint：如何设置编辑 WSS 用户配置文件的权限

> ID：134110
> 
> 赞同：0
> 
> 时间：2008-09-25T15:44:57.527
> 
> 标签：sharepoint, import, wss, profile

我在 MOSS 2007 上使用基于表单的用户身份验证运行 SharePoint 应用程序，而不使用 MySite 功能。因此，SSP 管理站点上仅涉及 MySites 上的用户配置文件的所有设置通常不应影响应用程序的用户配置文件，因为这些应从 WSS 进行管理。

但是我可以在哪里定义 WSS 用户配置文件的设置？目前，用户只能编辑其个人资料中的属性，这些属性被列为应用程序用户列表的附加列（WebsiteAction --> WebisteSettings --> 用户和组 --> 所有用户 --> ListSettings）。因此，所有其他属性，例如名字、姓氏、信息、头衔等，都是从我们的身份目录 (LDAP) 部分导入的，但用户不可编辑。

那么是否有任何选项来定义哪些属性应该对用户可编辑，哪些属性不应该？如果有任何选项可以定义将哪些 LDAP 属性映射到哪个 WSS 配置文件属性，那也会很有趣。

再见，弗洛

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-09-26T08:13:55.717

这些事情由您的共享服务提供商处理。所以 gå 那里：

用户配置文件和属性 -> 查看配置文件属性

你还可以在那里做关于个人资料、我的网站等的各种其他事情。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-09-29T08:41:38.843

是的，视图配置文件属性菜单也是我尝试处理问题的地方。但是使用我们的 LDAP 身份验证连接器不会导入任何配置文件。用户信息仅存储在 WSS 的用户配置文件中，因此视图配置文件属性中的设置不会影响 WSS 配置文件的设置。

所以我仍在寻找可以找到 WSS 用户配置文件设置的地方。

# html - 用css定位三个div

> ID：134125
> 
> 赞同：4
> 
> 时间：2008-09-25T15:47:51.657
> 
> 标签：html, css, layout

我有三个`divs`：

```
<div id="login" />
<div id="content" />  
<div id="menu" /> 
```

我将如何定义 CSS 样式（不接触 HTML）以将`menu-div`作为左列，`login-div`在右列中，`content-div`也在右列中但在`login-div`.

每个 div的`width`是固定的，但`height`不是。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-09-25T15:54:05.773

```
#menu {
  position:absolute;
  top:0;
  left:0;
  width:100px;
}
#content, #login {
  margin-left:120px;
} 
```

为什么这样？标记中最后出现的菜单使它变得困难。您可能还可以浮动内容和登录权，并添加一个 clear:right 内容，但我认为这可能是您最好的选择。如果没有看到更大的图景，很难给出一个绝对适用于您的情况的解决方案。

* * *

编辑：这似乎也有效：

```
#content, #login {
  float:right;
  clear:right
} 
```

* * *

更多想法：如果您想让列处于居中布局，则绝对定位将不起作用（或无法正常工作）。浮动似乎有效 - 只要您可以获得任何列之间的边界类型要求以使用浮动解决方案，您最好选择它。再说一次，如果该站点应该左对齐，我认为绝对方法可以很好地满足您的需求。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-09-25T15:57:19.620

飘走……不完美。 [克里斯的回答](https://stackoverflow.com/questions/134125/positioning-three-divs-with-css#134162)似乎是一个更好的解决方案。

```
#login {
  float: right;
  width: 400px;
  border: 1px solid #f00;
}

#content {
  clear: right;
  float: right;
  width: 400px;
  border: 1px solid #f00;
}

#menu {
  float: left;
  width: 400px;
  border: 1px solid #f00;
}
```

```
<div id="login">Login</div>
<div id="content">Content</div>
<div id="menu">Menu</div>
```

# vb.net - datagridview 和 AddNew 的问题

> ID：134127
> 
> 赞同：2
> 
> 时间：2008-09-25T15:48:17.397
> 
> 标签：vb.net

我创建了一个 VB 2008 程序来跟踪工作请求。这一切都在 VISTA 盒子上完美运行，但我在 XP 环境中添加新记录时遇到程序问题。

基本上我有 2 个选项卡：TAB 1 包含一个数据网格视图，其中包含有限的信息和一个日历。在日历上选择日期会更改 datagridview 中的信息。TAB 2 在文本/组合框中保存该记录的所有可用信息。datagridview 和文本框都使用相同的绑定源，因此每当用户从 datagridview 中选择一行时，它们始终保持同步。当您选择 NEW 按钮时，TAB 2 出现，所有文本框都为空，因此用户可以添加数据。如果您回头查看 TAB 1，您会看到向 datagridview 添加了一个空的新行（用户不能直接在 datagridview 中添加一行，因为 AllowUserToAdd 设置为 false）。如果您让应用程序在 VISTA 上保持 AddNew 记录状态，您将一直保持在该新记录上，直到您选择 SAVE 或 CANCEL。然而，在 XP 上，经过 1 分钟的时间后，所有空白字段最终都将填写该特定日历日的现有记录。当您回顾 TAB 1 时，您不再看到新的空行，您只看到以前保存的现有记录。

关于如何解决的任何想法？感谢您的任何帮助。

这是添加新记录的代码：

```
Private Sub cmdNew_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles cmdNew.Click

    'Focus on Work tab
    TabControl1.SelectedTab = tabWork

    'Change the files from read-only
    bEditMode = True
    ChangeEditMode()

    'Clear the current information stored in the fields
    Try
        Me.BindingContext(WorkRequestBindingSource).AddNew()

    Catch ex As Exception
        System.Windows.Forms.MessageBox.Show(ex.Message)
    End Try

    'Hidden text boxes populate with current selected calendar
    'Used to populate TimeIn and DateNeed because if never clicked on, will populate as NULL on save 
    dtpDateNeed.Text = txtDate.Text
    dtpTimeIn.Text = txtTime.Text

End Sub 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-04T16:43:25.953

这绝对是一个环境问题。为了解决这个问题，我需要知道您在每台机器上使用的浏览器以及每台机器上的一些设置。

**听起来**XP 机器在超时后刷新页面并因此修改新记录。我以前见过这种情况，而且很臭。

您可能需要考虑在视图状态中保存更多的状态信息来捕捉这种情况。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-09-28T21:59:49.150

如果代码完全相同，我想知道这是否是环境问题，例如不同的国际选项或框架版本？

# asp.net-mvc - ASP.NET MVC CTP5 崩溃 IDE

> ID：134131
> 
> 赞同：3
> 
> 时间：2008-09-25T15:49:07.127
> 
> 标签：asp.net-mvc, visual-studio-2008, ide, crash, preview-5

我最近安装了 MVC CTP5，当我尝试打开 aspx 时，VS 现在崩溃了，我在事件查看器中收到以下错误：

```
.NET Runtime version 2.0.50727.3053 - Fatal Execution Engine Error (7A035E00) (80131506) 
```

我能够在 asp.net 论坛上找到与同一问题相关的[这篇](http://forums.asp.net/t/1313452.aspx)文章，但还没有人找到可行的解决方案（至少对我来说没有）。

只是想知道是否有其他人遇到过这个问题以及他们为解决这个问题做了什么？

编辑：想补充一点，我已经尝试了文章中的所有提示，并且可以使用代码编辑器打开标记，但想知道找到了解决此问题的实际解决方案。谢谢！

编辑：我的 Vista 机器上没有这个问题，似乎只发生在我的 XP VM 上。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-09-25T15:51:34.063

以下是适用于我**的帖子的**解决步骤：

1.基于CTP5打开项目

2.IN解决方案资源管理器，启用“显示所有文件”

3.打开“bin”文件夹，删除“Microsoft.Web.Mvc.dll”、“System.Web.Mvc.dll”、“System.Web.Abstractions.dll”、“System.Web.Routing.dll”

4.打开“References”文件夹，单击ONCE“System.Web.Abstractions”并在“属性”窗口中将“Copy Local”更改为true。对 System.Web.Routing 重复相同的操作。

5.构建应用程序（Ctrl+Shift+B）

6.在设计器中打开site.master。VS不会崩溃。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-09-26T17:39:16.610

我在使用 Power Commands 和 Preview 5 时遇到了问题。如果您安装了 Power Commands，请尝试更新或卸载它以解决问题。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-28T04:43:08.267

仅供参考 - 微软已经发布了一个修复[至少一些变体]这个问题的修补程序：

[https://connect.microsoft.com/VisualStudio/Downloads/DownloadDetails.aspx?DownloadID=16827&wa=wsignin1.0](https://connect.microsoft.com/VisualStudio/Downloads/DownloadDetails.aspx?DownloadID=16827&wa=wsignin1.0)

[http://blogs.msdn.com/jnak/archive/2009/02/26/fix-available-asp-net-mvc-rc-crash-in-a-windows-azure-cloud-service-project.aspx](http://blogs.msdn.com/jnak/archive/2009/02/26/fix-available-asp-net-mvc-rc-crash-in-a-windows-azure-cloud-service-project.aspx)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-09-25T23:15:04.187

有点无效的答案，但我也一直有这个。并不是说我经常重新启动 VS，而是在打开 Web 项目之前清理 bin 文件夹是我的解决方法。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-03T13:23:44.570

在 vista x64 和 vs2008 sp1 上也有同样的问题。可能必须清理 bin 文件夹和 system.web.routing/abstraction，因为它甚至在带有 (mvc) 路由的 webforms 项目上也会崩溃。当我从 bin 中删除所有文件并再次添加引用时，它工作正常。
vs2008+ctp5 中真的很烦人的bug！

# .net - 置于 GAC 中的程序集是否获得完全信任？

> ID：134148
> 
> 赞同：6
> 
> 时间：2008-09-25T15:52:30.287
> 
> 标签：.net, security, gac

我一直在听到关于这个话题的相互矛盾的事实。什么是正确的？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-09-25T15:54:12.047

您一直听到相互矛盾的观点，因为这是一个非常混乱的话题，即使在高级工程师中也是如此。简而言之，简单地将程序集放在 GAC 中确实隐含地赋予它完全信任，但这可以通过安全策略覆盖。

EDIT1：让我补充一点，一个普遍的想法是，如果你不完全信任一个程序集，你为什么要把它放在 GAC 中？

EDIT2：我在这里有一个链接，指向 Michelle Bustamante 的博客文章，但正如您在下面的评论中看到的那样，它不再可用，所以我从这个答案中删除了它。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-09-25T16:11:11.613

我将尝试举一个可能有助于澄清问题的例子。假设您有一个运行中等信任度的 Web 应用程序。它需要做一些需要完全信任的事情，因此您创建一个类库项目（程序集）来完成该任务并将其安装到 GAC。在测试中，新程序集完美地执行了它的功能，但是当您尝试在 Web 应用程序中使用它时，您会发现您仍然只有中等信任度。

# algorithm - 您将如何在 2MB 的 RAM 中对 100 万个 32 位整数进行排序？

> ID：134158
> 
> 赞同：14
> 
> 时间：2008-09-25T15:53:47.070
> 
> 标签：algorithm, language-agnostic, google-moderator

请以您选择的语言提供代码示例。

**更新**：没有对外部存储设置限制。

示例：整数通过网络接收/发送。本地磁盘上有足够的空间用于中间结果。

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2008-09-25T15:57:14.457

将问题拆分成足够小以适合可用内存的部分，然后使用[归并排序](http://en.wikipedia.org/wiki/Merge_sort)将它们组合起来。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2008-10-23T07:38:20.207

[Guido van Rossum 使用 Python 对 2MB RAM 中的一百万个 32 位整数进行排序](http://neopythonic.blogspot.com/2008/10/sorting-million-32-bit-integers-in-2mb.html)

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-09-25T15:55:35.100

100 万个 32 位整数 = 4 MB 内存。

您应该使用一些使用外部存储的算法对它们进行排序。以合并排序为例。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2008-09-25T15:57:52.847

您需要提供更多信息。有哪些额外的存储空间可用？您应该将结果存储在哪里？

否则，最一般的答案：1.将前半部分数据加载到内存中（2MB），用任何方法排序，输出到文件。2.将后半部分数据加载到内存中（2MB），任意排序，保存在内存中。3\. 使用合并算法将两个排序后的一半合并，并将完整的排序数据集输出到一个文件中。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2008-09-25T16:38:14.327

这篇[关于外部排序的维基百科文章](http://en.wikipedia.org/wiki/External_sort)有一些有用的信息。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-09-25T18:33:12.380

[具有多相合并的双重锦标赛排序](http://www.google.com/codesearch?hl=en&q=timsort+file:py+show:4i7a6-mymA8:R8oO5cfsCpI:QtbBnxu6pzk&sa=N&cd=2&ct=rc)

```
#!/usr/bin/env python
import random
from sort import Pickle, Polyphase

nrecords = 1000000
available_memory = 2000000 # number of bytes
    #NOTE: it doesn't count memory required by Python interpreter 

record_size = 24 # (20 + 4) number of bytes per element in a Python list
heap_size = available_memory / record_size 
p = Polyphase(compare=lambda x,y: cmp(y, x), # descending order
              file_maker=Pickle, 
              verbose=True,
              heap_size=heap_size,
              max_files=4 * (nrecords / heap_size + 1))

# put records
maxel = 1000000000
for _ in xrange(nrecords):
    p.put(random.randrange(maxel))

# get sorted records
last = maxel
for n, el in enumerate(p.get_all()):
    if el > last: # elements must be in descending order
        print "not sorted %d: %d %d" % (n, el ,last)
        break
    last = el

assert nrecords == (n + 1) # check all records read 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-02-12T08:09:50.283

*   嗯，将它们全部存储在一个文件中。
*   内存映射文件（你说只有 2M 的 RAM；假设地址空间足够大，可以内存映射文件）。
*   使用文件后备存储对它们进行排序，就好像它现在是真实内存一样！

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2013-01-16T05:43:37.217

这是一个有效且有趣的解决方案。

将一半的数字加载到内存中。对它们进行堆排序并将输出写入文件。对另一半重复。使用外部排序（基本上是考虑文件 i/o 的合并排序）来合并两个文件。

另外：面对缓慢的外部存储，使堆排序更快：

*   在所有整数都在内存中之前开始构建堆。

*   在堆排序仍在提取元素时开始将整数放回输出文件

* * *

## 回答 #9

> 赞同：-2
> 
> 时间：2008-09-25T16:28:46.127

正如上面提到的 32 位 4 MB 的 int 类型。

使用 C++ 中的 int、short 和 char 类型将尽可能多的“数字”放入尽可能少的空间。通过进行几种类型的强制转换来到处塞满东西，你可能会很聪明（但有奇怪的脏代码）。

它在我座位的边缘。

小于 2^8(0 - 255) 的任何内容都存储为 char（1 字节数据类型）

小于 2^16(256 - 65535) 且 > 2^8 的任何内容都存储为短（2 字节数据类型）

其余的值将被放入 int。（4字节数据类型）

您需要指定 char 部分的开始和结束位置、short 部分的开始和结束位置以及 int 部分的开始和结束位置。

* * *

## 回答 #10

> 赞同：-3
> 
> 时间：2008-09-25T20:28:13.900

没有例子，但是[桶排序](http://en.wikipedia.org/wiki/Bucket_sort)的复杂度相对较低，并且很容易实现

# asp.net-mvc - 将 Web 应用程序迁移到 asp.net mvc

> ID：134159
> 
> 赞同：1
> 
> 时间：2008-09-25T15:53:51.780
> 
> 标签：asp.net-mvc, asp.net-mvc-migration

我需要你关于迁移的建议。我想将现有项目迁移到 ASP.NET MVC，我可以找出除 url 重写问题之外的过程：

例如，我如何制作以下路线：

[http://www.eireads.com/ireland/mayo/cars-3/1263-used-cars-citroen-c5-for-sale.aspx](http://www.eireads.com/ireland/mayo/cars-3/1263-used-cars-citroen-c5-for-sale.aspx)

或者也许我可以以某种方式继续支持传统路线。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-09-26T00:06:09.367

我认为将 Web 表单应用程序迁移到 MVC 将非常困难，除非您在当前应用程序中明确区分关注点。如果您遵循了像 MVP 这样的设计模式，那么它可能会更容易，但如果没有，那么您的大部分业务逻辑很可能必须转移到控制器类中，并且大部分都需要重新编写。

我将从提取您的模型开始，这应该相当容易，然后识别您的控制器和操作并查看您可以重用多少代码。在这一点上，您应该能够辨别您是否可以迁移，或者您是否最好重写部分应用程序。

ASP.NET MVC 中的默认 URL 模式是 http(s)://(appdomain)/(controller)/(action)/(par/ame/ters)

因此，您上面的网址应该适合该模式。您可以更改模式以考虑其他事情（例如命名空间）。您的 URL 模式可能是：

[http://www.eireads.com/cars/used/ireland/mayo/citreon](http://www.eireads.com/cars/used/ireland/mayo/citreon)

其中 ireland、mayo 和 citreon 是输入参数。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-09-25T22:02:55.140

I think you should really re-write your question and try to detail exactly what you are attempting to accomplish here.

If you are asking how to migrate an existing **WebForm** project into ASP.NET MVC keeping the same URL rewrite, the answer is; not easily. The models are too different.

Yet, you mention "routes" in the end, which make me think you are speaking like those of the System.Web.Routing namespace. So are you dealing with an existing MVC app and want it too look like that URL path? I can't tell. I am confused.

# .net - 使用反射获取构造子类类型的集合

> ID：134161
> 
> 赞同：0
> 
> 时间：2008-09-25T15:54:01.017
> 
> 标签：.net, reflection

我想创建一个实现 IEnumerable<T> 的类，但使用反射生成 T 并通过 IEnumerable<T> 返回它们，其中 T' 是 T 的完全构造的子类，其中一些属性隐藏，其他属性只读。

好吧，那可能不是很清楚。让我通过代码来解释这一点 - 我想要一个 CollectionView<T> 类，如下所示： -

```
public class CollectionView<T> : IEnumerable<T> {
  public CollectionView(IEnumerable<T> inputCollection, 
    List<string> hiddenProperties, List<string> readonlyProperties) {
    // ...
  }

  // IEnumerable<T> implementation which returns a collection of T' where T':T.
}

...

public class SomeObject {
  public A { get; set; }
  public B { get; set; }
  public C { get; set; }
}

...

var hiddenProperties   = new List<string>(new[] { "A" });
var readOnlyProperties = new List<string>(new[] { "C" });

IEnumerable<SomeObject> someObjects = CollectionView<SomeObject>(hiddenProperties,
  readOnlyProperties);

...

dataGridView1.DataSource = someObjects; 
```

（当在 dataGridView1 中显示时，显示列 B 和 C 和 C 具有一个只读的底层存储）

这是可能的/可取的还是我完全失去了理智/这个问题是否表明我作为程序员的严重不足？

我想这样做，以便我可以操作要传递到 DataGridView 的集合，*而不必直接操作 DataGridView 来隐藏列/使列只读*。所以不要'哦，只使用 dataGridView1.Columns.Remove(blah) / dataGridView1.Columns[blah].ReadOnly = true' 请回答！

帮助！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-09-25T16:19:30.627

[Castle.DynamicProxy](http://www.castleproject.org/dynamicproxy/index.html)将帮助您完成此任务。您要做的是创建一个继承 T 的拦截器。您将存储隐藏和只读属性的集合。当调用 getter 或 setter 时，拦截器将检查该属性是否存在于任一集合中，然后采取适当的措施。

但是，我不知道您将如何隐藏财产。您不能在派生类中更改基类的访问修饰符。您可以使用`new`关键字，但我不知道如何使用 Castle.DynamicProxy 来做到这一点。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-09-26T12:18:25.947

我决定对这个问题采取不同的方法，我真的没有只见树木不见森林！我决定创建一个扩展方法，将我的 IEnumerable 转换为数据表，然后可以根据需要传递：-

```
public static DataTable ToDataTable<T>(this IEnumerable<T> collection)
{
    DataTable ret = new DataTable();

    Type type = typeof(T);

    foreach (PropertyInfo propertyInfo in type.GetProperties())
    {
        // Ignore indexed properties.
        if (propertyInfo.GetIndexParameters().Length > 0) continue;
        ret.Columns.Add(propertyInfo.Name);
    }

    foreach (T data in collection)
    {
        DataRow row = ret.NewRow();
        foreach (PropertyInfo propertyInfo in type.GetProperties())
        {
            // Ignore indexed properties.
            if (propertyInfo.GetIndexParameters().Length > 0) continue;

            row[propertyInfo.Name] = propertyInfo.GetValue(data, null);
        }

        ret.Rows.Add(row);
    }

    return ret;
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-25T16:29:09.637

即使通过创建子类代理，您也无法隐藏属性。您至少可以动态构造一个不同的类型，它具有良好的属性，但它不会是`T`.

但是，如果您只需要使用数据绑定，则返回一个对象列表就足够了。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-19T17:50:46.360

您还可以使用 ICustomTypeDescriptor 过滤属性列表。为此，我为数据对象 (MyWrapper)、自定义属性描述符 (MypropertyDescriptor) 和集合类创建了一个包装类。我扩展了集合类以观察 IList 以便可以修改数据，并扩展 ITypedList 以便数据网格可以构建列。您可能还想继承 ObservableCollection<> 或 BindingList<>。

自定义描述符用于处理设置和检索属性值：

```
public sealed class MyPropertyDescriptor : System.ComponentModel.PropertyDescriptor
{
    private PropertyDescriptor innerProperty;
    private Boolean isReadonly;

    public MyPropertyDescriptor(PropertyDescriptor innerProperty, Boolean isReadonly)
        : base(innerProperty.Name, GetAttributeArray(innerProperty.Attributes))
    {
        this.innerProperty = innerProperty;
        this.isReadonly = isReadonly;
        if (!isReadonly) this.isReadonly = innerProperty.IsReadOnly;
    }

    public override Type ComponentType
    {
        get { return this.innerProperty.ComponentType; }
    }
    public override Boolean IsReadOnly
    {
        get { return this.isReadonly; }
    }
    public override Type PropertyType
    {
        get { return this.innerProperty.PropertyType; }
    }
    public override String Name
    {
        get
        {
            return this.innerProperty.Name;
        }
    }
    public override String DisplayName
    {
        get
        {
            return this.innerProperty.DisplayName;
        }
    }
    public override Boolean SupportsChangeEvents
    {
        get
        {
            return true;
        }
    }
    public override void SetValue(Object component, Object value)
    {
        if (!this.isReadonly)
        {
            this.innerProperty.SetValue(component, value);
            if (component is MyWrapper) (component as MyWrapper).NotifyPropertyChanged(this.innerProperty.Name);
        }
    }
    public override Object GetValue(Object component)
    {
        return this.innerProperty.GetValue(component);
    }

    public override Boolean CanResetValue(Object component)
    {
        return false;
    }
    public override void ResetValue(Object component)
    {
    }
    public override Boolean ShouldSerializeValue(Object component)
    {
        return true;
    }

    private static Attribute[] GetAttributeArray(AttributeCollection attributes)
    {
        List<Attribute> attr = new List<Attribute>();
        foreach (Attribute a in attributes) attr.Add(a);

        return attr.ToArray();
    }
} 
```

包装类是通过 ICustomTypeDescriptor 控制对属性的访问：

```
public sealed class MyWrapper : System.ComponentModel.ICustomTypeDescriptor, System.ComponentModel.INotifyPropertyChanged
{
    private Object innerObject;
    private String[] hiddenProps;
    private String[] readonlyProps;

    private Type innerType;

    public MyWrapper(Object innerObject, String[] hiddenProps, String[] readonlyProps)
        : base()
    {
        this.innerObject = innerObject;
        this.hiddenProps = hiddenProps;
        this.readonlyProps = readonlyProps;
        this.innerType = innerObject.GetType();
    }

    public static PropertyDescriptorCollection FilterProperties(PropertyDescriptorCollection pdc, String[] hiddenProps, String[] readonlyProps)
    {
        List<PropertyDescriptor> list = new List<PropertyDescriptor>();

        foreach (PropertyDescriptor pd in pdc)
        {
            if (hiddenProps != null)
            {
                Boolean isHidden = false;
                foreach (String hidden in hiddenProps)
                {
                    if (hidden.Equals(pd.Name, StringComparison.OrdinalIgnoreCase))
                    {
                        isHidden = true;
                        break;
                    }
                }
                if (isHidden) continue; // skip hidden
            }

            Boolean isReadonly = false;
            if (readonlyProps != null)
            {
                foreach (String rp in readonlyProps)
                {
                    if (rp.Equals(pd.Name, StringComparison.OrdinalIgnoreCase))
                    {
                        isReadonly = true;
                        break;
                    }
                }
            }

            list.Add(new MyPropertyDescriptor(pd, isReadonly));
        }

        return new PropertyDescriptorCollection(list.ToArray());
    }

    #region ICustomTypeDescriptor Members

    PropertyDescriptorCollection ICustomTypeDescriptor.GetProperties(Attribute[] attributes)
    {
        return FilterProperties(TypeDescriptor.GetProperties(this.innerType, attributes), hiddenProps, readonlyProps);
    }
    PropertyDescriptorCollection ICustomTypeDescriptor.GetProperties()
    {
        return FilterProperties(TypeDescriptor.GetProperties(this.innerType), hiddenProps, readonlyProps);
    }

    AttributeCollection ICustomTypeDescriptor.GetAttributes()
    {
        return TypeDescriptor.GetAttributes(this.innerType);
    }

    String ICustomTypeDescriptor.GetClassName()
    {
        return TypeDescriptor.GetClassName(this.GetType());
    }
    String ICustomTypeDescriptor.GetComponentName()
    {
        return TypeDescriptor.GetComponentName(this.GetType());
    }
    TypeConverter ICustomTypeDescriptor.GetConverter()
    {
        return TypeDescriptor.GetConverter(this.GetType());
    }
    EventDescriptor ICustomTypeDescriptor.GetDefaultEvent()
    {
        return TypeDescriptor.GetDefaultEvent(this.GetType());
    }
    PropertyDescriptor ICustomTypeDescriptor.GetDefaultProperty()
    {
        return null;
    }
    Object ICustomTypeDescriptor.GetEditor(Type editorBaseType)
    {
        return TypeDescriptor.GetEditor(this.GetType(), editorBaseType);
    }
    EventDescriptorCollection ICustomTypeDescriptor.GetEvents(Attribute[] attributes)
    {
        return null;
    }
    EventDescriptorCollection ICustomTypeDescriptor.GetEvents()
    {
        return null;
    }

    Object ICustomTypeDescriptor.GetPropertyOwner(PropertyDescriptor pd)
    {
        return this.innerObject;
    }

    #endregion

    #region INotifyPropertyChanged Members
    internal void NotifyPropertyChanged(String propertyName)
    {
        if (this.propertyChanged != null) this.propertyChanged.Invoke(this, new PropertyChangedEventArgs(propertyName));
    }
    private event PropertyChangedEventHandler propertyChanged;
    event PropertyChangedEventHandler INotifyPropertyChanged.PropertyChanged
    {
        add { propertyChanged += value; }
        remove { propertyChanged -= value; }
    }
    #endregion
} 
```

以及 CollectionView<> 的修改版本。这个示例的大部分只是将接口方法映射到内部列表。

```
public sealed class CollectionView<T> : IEnumerable<MyWrapper>, System.Collections.IList, IList<MyWrapper>, ITypedList
{
    private String[] hiddenProps;
    private String[] readonlyProps;
    private List<MyWrapper> collection;

    public CollectionView(IEnumerable<T> innerCollection, String[] hiddenProps, String[] readonlyProps)
        : base()
    {
        this.hiddenProps = hiddenProps;
        this.readonlyProps = readonlyProps;

        this.collection = new List<MyWrapper>();
        foreach (T item in innerCollection)
        {
            this.collection.Add(new MyWrapper(item, hiddenProps, readonlyProps));
        }
    }

    #region ITypedList Members

    PropertyDescriptorCollection ITypedList.GetItemProperties(PropertyDescriptor[] listAccessors)
    {
        return MyWrapper.FilterProperties(TypeDescriptor.GetProperties(typeof(T)), this.hiddenProps, this.readonlyProps);
    }

    String ITypedList.GetListName(PropertyDescriptor[] listAccessors)
    {
        return null;
    }
    #endregion

    #region IEnumerable<MyWrapper> Members

    IEnumerator<MyWrapper> IEnumerable<MyWrapper>.GetEnumerator()
    {
        return this.collection.GetEnumerator();
    }

    #endregion

    #region IEnumerable Members

    System.Collections.IEnumerator System.Collections.IEnumerable.GetEnumerator()
    {
        return this.collection.GetEnumerator();
    }

    #endregion

    #region IList Members
    Int32 System.Collections.IList.Add(Object value)
    {
        return (this.collection as System.Collections.IList).Add(value);
    }
    void System.Collections.IList.Clear()
    {
        (this.collection as System.Collections.IList).Clear();
    }
    Boolean System.Collections.IList.Contains(Object value)
    {
        return (this.collection as System.Collections.IList).Contains(value);
    }
    Int32 System.Collections.IList.IndexOf(Object value)
    {
        return (this.collection as System.Collections.IList).IndexOf(value);
    }
    void System.Collections.IList.Insert(Int32 index, Object value)
    {
        (this.collection as System.Collections.IList).Insert(index, value);
    }
    Boolean System.Collections.IList.IsFixedSize
    {
        get { return (this.collection as System.Collections.IList).IsFixedSize; }
    }
    Boolean System.Collections.IList.IsReadOnly
    {
        get { return (this.collection as System.Collections.IList).IsReadOnly; }
    }
    void System.Collections.IList.Remove(Object value)
    {
        (this.collection as System.Collections.IList).Remove(value);
    }
    void System.Collections.IList.RemoveAt(Int32 index)
    {
        (this.collection as System.Collections.IList).RemoveAt(index);
    }
    Object System.Collections.IList.this[Int32 index]
    {
        get
        {
            return (this.collection as System.Collections.IList)[index];
        }
        set
        {
            (this.collection as System.Collections.IList)[index] = value;
        }
    }
    #endregion

    #region ICollection Members
    void System.Collections.ICollection.CopyTo(Array array, Int32 index)
    {
        (this.collection as System.Collections.ICollection).CopyTo(array, index);
    }
    Int32 System.Collections.ICollection.Count
    {
        get { return (this.collection as System.Collections.ICollection).Count; }
    }
    Boolean System.Collections.ICollection.IsSynchronized
    {
        get { return (this.collection as System.Collections.ICollection).IsSynchronized; }
    }
    Object System.Collections.ICollection.SyncRoot
    {
        get { return (this.collection as System.Collections.ICollection).SyncRoot; }
    }
    #endregion

    #region IList<MyWrapper> Members
    Int32 IList<MyWrapper>.IndexOf(MyWrapper item)
    {
        return this.collection.IndexOf(item);
    }
    void IList<MyWrapper>.Insert(Int32 index, MyWrapper item)
    {
        this.collection.Insert(index, item);
    }
    void IList<MyWrapper>.RemoveAt(Int32 index)
    {
        this.collection.RemoveAt(index);
    }
    MyWrapper IList<MyWrapper>.this[Int32 index]
    {
        get
        {
            return this.collection[index];
        }
        set
        {
            this.collection[index] = value;
        }
    }
    #endregion

    #region ICollection<MyWrapper> Members
    void ICollection<MyWrapper>.Add(MyWrapper item)
    {
        this.collection.Add(item);
    }
    void ICollection<MyWrapper>.Clear()
    {
        this.collection.Clear();
    }
    Boolean ICollection<MyWrapper>.Contains(MyWrapper item)
    {
        return this.collection.Contains(item);
    }
    void ICollection<MyWrapper>.CopyTo(MyWrapper[] array, Int32 arrayIndex)
    {
        this.collection.CopyTo(array, arrayIndex);
    }
    Int32 ICollection<MyWrapper>.Count
    {
        get { return this.collection.Count; }
    }
    Boolean ICollection<MyWrapper>.IsReadOnly
    {
        get { return false; }
    }
    Boolean ICollection<MyWrapper>.Remove(MyWrapper item)
    {
        return this.collection.Remove(item);
    }
    #endregion
} 
```

# xml - XML的diff和merge

> ID：134169
> 
> 赞同：1
> 
> 时间：2008-09-25T15:55:07.957
> 
> 标签：xml, devtools

谁能推荐一个好的 XML 差异和合并工具？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2010-08-24T12:42:59.280

[项目：合并](http://www.projectmerge.com)- 不是免费的，但也不昂贵。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-09-25T15:56:06.487

我喜欢[氧气](http://www.oxygenxml.com/xml_diff_and_merge.html)。

# linq - Linq输出作为接口？

> ID：134182
> 
> 赞同：4
> 
> 时间：2008-09-25T15:57:01.290
> 
> 标签：linq, casting, interface

这是我试图做的代码：

```
public IList<IOperator> GetAll()
{
      using (var c = new MyDataContext())
      {
          return c.Operators.ToList();
      }
} 
```

Operator 实现了 IOperator，但出现以下编译错误：

```
Cannot implicitly convert type 'System.Collections.Generic.List<MyProject.Core.Operator>' to 'System.Collections.Generic.IList<MyProject.Core.Model.IOperator>'. An explicit conversion exists (are you missing a cast?) 
```

我如何施放这个以获得我需要的东西？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-09-25T16:12:46.260

试试`Cast<>()`方法：

```
return c.Operators.Cast<IOperator>().ToList(); 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-09-25T16:29:12.257

如果我将代码更改为以下内容：

```
public IList<IOperator> GetAll()
{
      using (var c = new MyDataContext())
      {
           var operators = (from o in c.Operators
                            select o).Cast<IOperator>();

           return operators.ToList();
      }
} 
```

它不仅可以编译，而且可以实际工作！感谢您朝正确方向轻推。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-25T16:13:25.540

编辑：实际上，

return (List< IOperator >)c.Operators.ToList();

不会成功*的*。对不起

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2010-01-15T01:04:01.323

使用 ConvertAll<>

[http://msdn.microsoft.com/en-us/library/kt456a2y.aspx](http://msdn.microsoft.com/en-us/library/kt456a2y.aspx)

eg：在这种情况下，TEntity 必须是一个 IBusinessUnit，但是是一个类，所以我在转换时遇到了同样的麻烦`List<Operator> to List<IOperator>`（假设 Operator 实现了 IOperator）。

在您的情况下，就像您说的那样，Operator 不会影响 IOperator，但这没关系-这仍然有效-

```
 public static IList<IBusinessUnit> toIBusinessUnitIList(List<TEntity> items)
      {

      return items.ConvertAll<IBusinessUnit>(new Converter<TEntity, IBusinessUnit>(TEntityToIBuisinessUnit));
      }

  /// <summary>
  /// Callback for List<>.ConvertAll() used above.
  /// </summary>
  /// <param name="md"></param>
  /// <returns></returns>
  private static IBusinessUnit TEntityToIBuisinessUnit(TEntity te)
  {
   return te;  // In your case, do whatever magic you need to do to convert an Operator to an IOperator here.
  } 
```

# .net - 基于字符串值在 .NET 中创建方法调用

> ID：134214
> 
> 赞同：10
> 
> 时间：2008-09-25T16:03:51.850
> 
> 标签：.net, vb.net, method-call

现在，我的代码看起来像这样：

```
Private Sub ShowReport(ByVal reportName As String)
    Select Case reportName
        Case "Security"
            Me.ShowSecurityReport()
        Case "Configuration"
            Me.ShowConfigurationReport()
        Case "RoleUsers"
            Me.ShowRoleUsersReport()
        Case Else
            pnlMessage.Visible = True
            litMessage.Text = "The report name """ + reportName + """ is invalid."
    End Select
End Sub 
```

有什么方法可以创建可以使用我的方法命名约定来简化事情的代码？这是一些描述我正在寻找的伪代码：

```
Private Sub ShowReport(ByVal reportName As String)
    Try
        Call("Show" + reportName + "Report")
    Catch ex As Exception
        'method not found
    End Try
End Sub 
```

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2008-09-25T16:08:28.627

```
Type type = GetType();
MethodInfo method = type.GetMethod("Show"+reportName+"Report");
if (method != null)
{
    method.Invoke(this, null);
} 
```

这是C#，应该很容易将其转换为VB。如果您需要将参数传递给方法，可以将它们添加到 Invoke 的第二个参数中。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-09-25T16:56:39.057

你有一个更深层次的问题。你的琴弦太重要了。谁在给你传递字符串？你能让他们不要那样做吗？

坚持使用 switch 语句，因为它将内部实现（方法名称）与外部视图分离。

假设您将其本地化为德语。你要重命名所有这些方法？

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-09-25T16:06:19.847

您可以使用反射来做到这一点，但老实说，我认为这对于您的特定场景来说过于复杂了，即同一类中的代码和 switch()。

现在，如果您将应用程序设计为在其自己的程序集中（有点像插件/插件架构）或捆绑在单个外部程序集中的每个报告类型，那么您可以将报告程序集加载到应用程序域中，然后使用反射来做这种事情。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-09-25T16:08:17.283

使用反射。在`System.Reflection`命名空间中，您需要获取`MethodInfo`所需方法的对象，`GetMethod("methodName")`在包含该方法的类型上使用。

拥有`MethodInfo`对象后，您可以`.Invoke()`使用对象实例和任何参数进行调用。

例如：

```
System.Reflection.MethodInfo method = this.GetType().GetMethod("foo");
method.Invoke(this, null); 
```

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2008-09-25T16:10:07.640

反射 API 允许您`MethodInfo`从方法中获取一个，然后对其进行动态调用`Invoke`。但在你的情况下它是矫枉过正的。

您应该考虑拥有一个按字符串索引的委托字典。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2008-09-25T16:10:23.240

您可以使用反射。尽管就个人而言，我认为您应该坚持使用 switch 语句。

```
private void ShowReport(string methodName)
{
    Type type = this.GetType();
    MethodInfo method = type.GetMethod("Show"+methodName+"Report", BindingFlags.Public)
    method.Invoke(this, null);
} 
```

对不起，我在做 C#。只需将其转换为 VB.NET。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-09-25T16:07:31.640

您可以使用[System.Reflection](https://docs.microsoft.com/en-us/dotnet/api/system.reflection)。有关详细信息，请参阅[此代码项目文章](http://www.codeproject.com/KB/codegen/Run-Time_Code_Generation2.aspx)。

```
string ModuleName = "TestAssembly.dll";
string TypeName = "TestClass";
string MethodName = "TestMethod";

Assembly myAssembly = Assembly.LoadFrom(ModuleName);

BindingFlags flags = (BindingFlags.NonPublic | BindingFlags.Public | 
  BindingFlags.Static | BindingFlags.Instance | BindingFlags.DeclaredOnly);

Module [] myModules = myAssembly.GetModules();
foreach (Module Mo in myModules) 
{
 if (Mo.Name == ModuleName) 
     {
     Type[] myTypes = Mo.GetTypes();
     foreach (Type Ty in myTypes)
         {
        if (Ty.Name == TypeName) 
            {
            MethodInfo[] myMethodInfo = Ty.GetMethods(flags);
            foreach(MethodInfo Mi in myMethodInfo)
                {
                if (Mi.Name == MethodName) 
                    {
                    Object obj = Activator.CreateInstance(Ty);
                    Object response = Mi.Invoke(obj, null);
                    }
                }
            }
        }
    }
} 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-09-25T16:10:08.777

Python（和 IronPython）可以很容易地做到这一点。但是，使用 .Net，您需要使用反射。

在 C# 中：http: [//www.dotnetspider.com/resources/4634-Invoke-me-ods-dynamically-using-reflection.aspx](http://www.dotnetspider.com/resources/4634-Invoke-me-ods-dynamically-using-reflection.aspx)

我快速移植到 VB.Net：

```
Private Sub InvokeMethod(instance as object, methodName as string )
            'Getting the method information using the method info class
            Dim mi as MethodInfo = instance.GetType().GetMethod(methodName)

            'invoing the method
            'null- no parameter for the function [or] we can pass the array of parameters
            mi.Invoke(instance, Nothing)
End Sub 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-09-25T16:14:37.550

如果我正确理解了这个问题，您将不得不使用反射找到方法“show”+reportName，然后间接调用它：

半生不熟的例子：

```
Case "financial" :
{
   Assembly asm = Assembly.GetExecutingAssembly ();

    MethodInfo mi = asm.GetType ("thisClassType").GetMethod ("showFinancialReport");

   if (mi != null)
      mi.Invoke (null, new object[] {});

} 
```

在此处插入您自己的逻辑以构成要调用的方法的名称。

有关详细信息，请参阅 MethodInfo 和 Assembly 的 MSDN 文档。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2008-09-25T16:15:02.917

使用反射：

```
Type t = this.GetType();
try 
{
    MethodInfo mi = t.GetMethod(methodName, ...);

    if (mi != null)
    {
        mi.Invoke(this, parameters);
    }
} 
```

但我同意之前，最好不要更改您的原始代码;-)

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2008-09-25T18:07:31.833

“最接近您的问题”的解决方案。

您可以从这些报告中创建代表，并通过在 Hashtable 中查找匹配的字符串来调用它们：

```
Public Sub New()
    '...
    ReportTable.Add("Security", New ReportDelegate(AddressOf ShowSecurityReport))
    ReportTable.Add("Config", New ReportDelegate(AddressOf ShowConfigReport))
    ReportTable.Add("RoleUsers", New ReportDelegate(AddressOf ShowRoleUsersReport))
    '...
End Sub

Private Sub ShowSecurityReport()
    '...
End Sub

Private Sub ShowConfigReport()
    '...
End Sub

Private Sub ShowRoleUsersReport()
    '...
End Sub

Private Delegate Sub ReportDelegate()

Private ReportTable As New Dictionary(Of String, ReportDelegate)

Private Sub ShowReport(ByVal reportName As String)
    Dim ReportToRun As ReportDelegate
    If ReportTable.TryGetValue(reportName, ReportToRun) Then
        ReportToRun()
    Else
        pnlMessage.Visible = True
        litMessage.Text = "The report name """ + reportName + """ is invalid."
    End If
End Sub 
```

这样，您可以添加任意数量的报告，并且您反映它们的能力以及反射的性能都不是问题。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2019-02-04T12:39:40.590

在 VB .Net MSVS 2015 中为我工作

```
Dim tip As Type = GetType(MODULENAME)'if sub() or function() in module
        Dim method As MethodInfo = tip.GetMethod("MaxV") 'name of function (gets 2 params double type)
        Dim res As Double = 0 'temporary variable
        If (Not Nothing = method) Then 'if found function "MaxV"

            res = method.Invoke(Me, New Object() {10, 20})
        End If
        MsgBox(res.ToString()) 
```

# c# - 在构建过程中生成 Xml 序列化程序集

> ID：134224
> 
> 赞同：67
> 
> 时间：2008-09-25T16:06:16.540
> 
> 标签：c#, xml, xml-serialization

此代码产生 FileNotFoundException，但最终运行没有问题：

```
void ReadXml()
{
    XmlSerializer serializer = new XmlSerializer(typeof(MyClass));
    //...
} 
```

这是一个例外：

* * *

mscorlib.dll 中出现了“System.IO.FileNotFoundException”类型的第一次机会异常

附加信息：无法加载文件或程序集“MyAssembly.XmlSerializers，Version=1.4.3190.15950，Culture=neutral，PublicKeyToken=null”或其依赖项之一。该系统找不到指定的文件。

* * *

**如果找不到，框架似乎会自动生成序列化程序集。** 我可以使用 sgen.exe 手动生成它，从而缓解异常。

**如何让 Visual Studio 自动生成 XML 序列化程序集？**

* * *

**更新： Generate Serialization Assembly: On 设置似乎没有做任何事情。**

* * *

## 回答 #1

> 赞同：74
> 
> 时间：2012-01-10T03:43:51.573

正如 Martin 在[他的回答](https://stackoverflow.com/a/264464/94928)中解释的那样，通过项目属性打开序列化程序集的生成是不够的，因为 SGen 任务正在将`/proxytypes`开关添加到 sgen.exe 命令行。

Microsoft 有一个[记录在案的 MSBuild 属性](http://msdn.microsoft.com/en-us/library/bb629394.aspx)，它允许您禁用`/proxytypes`开关并导致 SGen 任务生成序列化程序集，即使程序集中没有代理类型也是如此。

> SGenUseProxyTypes
> 
> 一个布尔值，指示代理类型是否应由 SGen.exe 生成。SGen 目标使用此属性来设置 UseProxyTypes 标志。此属性默认为 true，并且没有 UI 可以更改它。要为非 Web 服务类型生成序列化程序集，请在导入 Microsoft.Common.Targets 或 C#/VB.targets 之前将此属性添加到项目文件并将其设置为 false

正如文档所建议的，您必须手动修改项目文件，但您可以将该`SGenUseProxyTypes`属性添加到您的配置中以启用生成。您的项目文件配置最终看起来像这样：

```
 <PropertyGroup Condition=" '$(Configuration)|$(Platform)' == 'Debug|x86' ">
    <!-- Snip... -->
    <GenerateSerializationAssemblies>On</GenerateSerializationAssemblies>
    <SGenUseProxyTypes>false</SGenUseProxyTypes>
  </PropertyGroup>
  <PropertyGroup Condition=" '$(Configuration)|$(Platform)' == 'Release|x86' ">
    <!-- Snip... -->
    <GenerateSerializationAssemblies>On</GenerateSerializationAssemblies>
    <SGenUseProxyTypes>false</SGenUseProxyTypes>
  </PropertyGroup> 
```

* * *

## 回答 #2

> 赞同：57
> 
> 时间：2008-10-15T14:45:18.973

这就是我通过修改 .CSPROJ 文件中的 MSBUILD 脚本来设法做到这一点的方法：

首先，将 .CSPROJ 文件作为文件而不是项目打开。滚动到文件底部，直到在 Project 标记关闭之前找到这段注释掉的代码：

```
<!-- To modify your build process, add your task inside one of the targets below and uncomment it. Other similar extension points exist, see Microsoft.Common.targets.
<Target Name="BeforeBuild">
</Target>
<Target Name="AfterBuild">
</Target>
--> 
```

现在我们只需插入我们自己的 AfterBuild 目标来删除我们自己的任何现有 XmlSerializer 和 SGen，如下所示：

```
<Target Name="AfterBuild" DependsOnTargets="AssignTargetPaths;Compile;ResolveKeySource" Inputs="$(MSBuildAllProjects);@(IntermediateAssembly)" Outputs="$(OutputPath)$(_SGenDllName)">
   <!-- Delete the file because I can't figure out how to force the SGen task. -->
   <Delete
     Files="$(TargetDir)$(TargetName).XmlSerializers.dll"
     ContinueOnError="true" />
   <SGen
     BuildAssemblyName="$(TargetFileName)"
     BuildAssemblyPath="$(OutputPath)"
     References="@(ReferencePath)"
     ShouldGenerateSerializer="true"
     UseProxyTypes="false"
     KeyContainer="$(KeyContainerName)"
     KeyFile="$(KeyOriginatorFile)"
     DelaySign="$(DelaySign)"
     ToolPath="$(TargetFrameworkSDKToolsDirectory)"
     Platform="$(Platform)">
      <Output
       TaskParameter="SerializationAssembly"
       ItemName="SerializationAssembly" />
   </SGen>
</Target> 
```

这对我行得通。

* * *

## 回答 #3

> 赞同：29
> 
> 时间：2008-11-05T06:20:56.880

这个问题的其他答案已经提到了 Project Properties->Build-> **Generate Serialization Assemblies设置，但默认情况下，只有在项目中有“** **XML Web 服务代理类型**”时才会生成程序集。

了解 Visual Studio 的确切行为的最佳方法是检查C:\WINDOWS\Microsoft.NET\Framework\v2.0.50727**Microsoft.Common.targets** 文件中的**GenerateSerializationAssemblies目标。**

**您可以从 Visual Studio输出**窗口检查此构建任务的结果，然后从**显示输出**：下拉框中选择**构建。**你应该看到一些类似的东西

 **C:\Program Files\Microsoft Visual Studio 8\SDK\v2.0\bin\sgen.exe /assembly:D:\Temp\LibraryA\obj\Debug\LibraryA.dll / **proxytypes** /reference:.. /compiler:/ delaysign-LibraryA -> D:\Temp\LibraryA\bin\Debug\LibraryA.dll

这里的关键点是 / **proxytypes**开关。您可以阅读有关[XML 序列化程序生成器工具 (Sgen.exe)的各种开关](http://msdn.microsoft.com/en-us/library/bk3w6240(VS.80).aspx)

如果您熟悉 MSBuild，则可以自定义 GenerateSerializationAssemblies 目标，以便 SGen 任务具有 UseProxyTypes="false" 属性而不是 true，但是您需要承担自定义 Visual Studio / MSBuild 系统的所有相关责任。或者，您可以扩展您的构建过程以手动调用 SGen 而无需 /proxytypes 开关。

如果您阅读 SGen 的文档，他们很清楚 Microsoft 想要限制此工具的使用。考虑到关于这个主题的大量噪音，很明显微软在记录 Visual Studio 体验方面做得并不好。这个问题甚至有一个[连接反馈](http://connect.microsoft.com/VisualStudio/feedback/ViewFeedback.aspx?FeedbackID=123088)项，但反应不是很好。

* * *

## 回答 #4

> 赞同：12
> 
> 时间：2013-03-21T02:06:42.133

创建一个新的 sgen 任务定义打破了车轮上的苍蝇。只需设置所需的变量以使任务按预期工作。无论如何，微软文档缺少一些重要信息。

## 预生成序列化程序集的步骤

（部分来自[http://msdn.microsoft.com/en-us/library/ff798449.aspx](http://msdn.microsoft.com/en-us/library/ff798449.aspx)）

1.  在 Visual Studio 2010 的解决方案资源管理器中，右键单击要为其生成序列化程序集的项目，然后单击“卸载项目”。
2.  在解决方案资源管理器中，右键单击要为其生成序列化程序集的项目，然后单击“编辑 .csproj”。
3.  在 .csproj 文件中，紧跟在该`<TargetFrameworkVersion>v?.?</TargetFrameworkVersion>`元素之后，添加以下元素：

    > `<SGenUseProxyTypes>false</SGenUseProxyTypes>` `<SGenPlatformTarget>$(Platform)</SGenPlatformTarget>`

4.  在 .csproj 文件中，在每个平台配置中

    例如`<PropertyGroup Condition="'$(Configuration)|$(Platform)' == 'Debug|x86'">`

    添加以下行：

    `<GenerateSerializationAssemblies>On</GenerateSerializationAssemblies>`

5.  保存并关闭 .csproj 文件。

6.  在解决方案资源管理器中，右键单击刚刚编辑的项目，然后单击重新加载项目。

此过程在您的输出文件夹中生成一个名为 .xmlSerializers.dll 的附加程序集。您将需要使用您的解决方案部署此程序集。

* * *

## 解释

默认情况下，SGen 仅适用于为“任何 CPU”生成的代理类型。如果您没有在项目文件中设置相应的变量，就会发生这种情况。

需要 SGenPlatformTarget 才能匹配您的 PlatformTarget。我倾向于认为这是项目模板中的一个错误。为什么 sgen 目标平台与您的项目不同？如果是这样，您将获得运行时异常

> 0x80131040: 定位程序集的清单定义与程序集引用不匹配

您可以通过分析您的项目文件找到 msbuild 任务定义：

```
<Import Project="$(MSBuildToolsPath)\Microsoft.CSharp.targets" /> 
```

其中 MSBuildToolsPath 取决于您的`<TargetFrameworkVersion>` [http://msdn.microsoft.com/en-us/library/bb397428.aspx](http://msdn.microsoft.com/en-us/library/bb397428.aspx)

查看 TargetFrameworkVersion 4.0 的 SGen 任务定义

> Windows安装路径\Microsoft.NET\Framework\v4.0.30319\Microsoft.CSharp.targets

要查看 $(SGenPlatformTarget) 等未记录的变量，您可以在项目文件中自由设置

```
<Target
    Name="GenerateSerializationAssemblies"
    Condition="'$(_SGenGenerateSerializationAssembliesConfig)' == 'On' or ('@(WebReferenceUrl)'!='' and '$(_SGenGenerateSerializationAssembliesConfig)' == 'Auto')"
    DependsOnTargets="AssignTargetPaths;Compile;ResolveKeySource"
    Inputs="$(MSBuildAllProjects);@(IntermediateAssembly)"
    Outputs="$(IntermediateOutputPath)$(_SGenDllName)">

    <SGen
        BuildAssemblyName="$(TargetFileName)"
        BuildAssemblyPath="$(IntermediateOutputPath)"
        References="@(ReferencePath)"
        ShouldGenerateSerializer="$(SGenShouldGenerateSerializer)"
        UseProxyTypes="$(SGenUseProxyTypes)"
        KeyContainer="$(KeyContainerName)"
        KeyFile="$(KeyOriginatorFile)"
        DelaySign="$(DelaySign)"
        ToolPath="$(SGenToolPath)"
        SdkToolsPath="$(TargetFrameworkSDKToolsDirectory)"
        EnvironmentVariables="$(SGenEnvironment)"
        SerializationAssembly="$(IntermediateOutputPath)$(_SGenDllName)"
        Platform="$(SGenPlatformTarget)"
        Types="$(SGenSerializationTypes)">
            <Output TaskParameter="SerializationAssembly" ItemName="SerializationAssembly"/>
    </SGen>
</Target> 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2010-02-14T10:05:09.863

万一其他人在之前一切正常之后突然遇到这个问题：对我来说，这与选项菜单（选项 - >调试）中未选中“启用我的代码（仅限托管）”复选框有关（这是安装 .NET Reflector 后自动关闭）。

编辑：也就是说，当然，这个异常以前发生过，但是当“仅启用我的代码”关闭时，调试助手（如果启用）将在抛出时停止。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2014-08-11T16:01:34.407

我参加聚会有点晚了，但我发现以前的答案很难处理。具体来说，每当我尝试查看项目的属性时，Visual Studio 都会崩溃。我认为这是因为它不再了解如何读取 csproj 文件。那就是说...

将以下内容添加到您的构建后事件命令行：

```
"C:\Program Files (x86)\Microsoft SDKs\Windows\v7.0A\Bin\NETFX 4.0 Tools\sgen.exe" "$(TargetPath)" /force 
```

每次为调试或发布构建项目时，这将直接利用 sgen.exe 重新构建 Xml 序列化程序集。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-09-25T16:12:58.053

查看解决方案的属性。在底部的构建选项卡上有一个名为“生成序列化程序集”的下拉菜单

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2014-01-09T09:15:31.340

[与大脑备份](https://stackoverflow.com/a/15538240)提供的解决方案略有不同的解决方案可能是直接在您必须使用它的地方指定平台目标，如下所示：

```
<!-- Check the platform target value and if present use that for a correct *.XmlSerializer.dll platform setup (default is MSIL)-->
<PropertyGroup Condition=" '$(PlatformTarget)'=='' ">
  <SGenPlatform>$(Platform)</SGenPlatform>
</PropertyGroup>
<PropertyGroup Condition=" '$(PlatformTarget)'!='' ">
  <SGenPlatform>$(PlatformTarget)</SGenPlatform>
</PropertyGroup>

<!-- Delete the file because I can't figure out how to force the SGen task. -->
<Delete Files="$(TargetDir)$(TargetName).XmlSerializers.dll" ContinueOnError="true" />
<SGen
  BuildAssemblyName="$(TargetFileName)"
  BuildAssemblyPath="$(OutputPath)"
  References="@(ReferencePath)"
  ShouldGenerateSerializer="true"
  UseProxyTypes="false"
  KeyContainer="$(KeyContainerName)"
  KeyFile="$(KeyOriginatorFile)"
  DelaySign="$(DelaySign)"
  ToolPath="$(SGenToolPath)"
  SdkToolsPath="$(TargetFrameworkSDKToolsDirectory)"
  EnvironmentVariables="$(SGenEnvironment)"
  Platform="$(SGenPlatform)">
  <Output TaskParameter="SerializationAssembly" ItemName="SerializationAssembly" />
</SGen> 
```

# javascript - 有没有好的 Markdown Javascript 库或控件？

> ID：134235
> 
> 赞同：91
> 
> 时间：2008-09-25T16:08:10.453
> 
> 标签：javascript, controls, markdown

我想建立一个网站，用户可以在其中输入文本并在 Markdown 中对其进行格式化。我想要 Javascript 解决方案的原因是因为我想显示实时预览，就像在 StackOverflow 上一样。

但是，我的站点不针对开发人员，因此编辑器控件将是理想的。

我在 StackOverflow 上收集到，正在使用 WMD 编辑器。

在 Google 上快速搜索也会出现 Showdown 库，我认为 WMD 实际上正在使用它。

还有其他选择吗？WMD/Showdown 已经是很棒的工具了吗？你对不同的选择有什么经验？

* * *

## 回答 #1

> 赞同：66
> 
> 时间：2008-09-25T18:42:54.543

我们对 WMD 非常满意。但是，其中有一些琐碎的错误。没什么大不了的，但我希望*John* Fraser（作者）将代码开源，这样我们就可以修复其中的一些。他承诺会这样做，但其他现实生活中的项目正在阻碍。

~~我每周都会跟进约翰。一旦 WMD 源最终可用，我将在博客上发布。~~一年多来一直无法联系约翰·弗雷泽。

我们已经开源了 JavaScript Markdown 库

[http://code.google.com/p/pagedown/](http://code.google.com/p/pagedown/)

和服务器端 C# Markdown 库

[http://code.google.com/p/markdownsharp/](http://code.google.com/p/markdownsharp/)

* * *

## 回答 #2

> 赞同：34
> 
> 时间：2008-10-13T13:43:14.530

如果您不反对使用 Ajax 生成实时预览，那么另一种选择是[markItUp！](http://markitup.jaysalvat.com/home/). 标记！是一个通用的标记编辑器，非常灵活。它确实提供了一种创建标记编辑器的简单方法，但与 WMD 不同的是，它不提供自己的实时预览。

我为我的一个开源项目（[Roller的](http://roller.apache.org/)[Markdown 插件](http://github.com/myabc/roller-markdown/tree/master)）使用了markItUp!，以及一个简单的 JSP（使用[MarkdownJ](http://sourceforge.net/projects/markdownj/)）。如果您正在使用另一种服务器端技术，请酌情替换那个简单的 JSP。

在遇到 WMD 之前，我实际上开始使用它。我同意，WMD 很棒，但只是刚刚开源，在这个阶段，更难以自定义其行为。

* * *

## 回答 #3

> 赞同：12
> 
> 时间：2013-03-16T16:06:46.970

我推荐[marked](https://github.com/chjj/marked)，它轻量级、高效、易于使用，并且还支持GitHub Flavored Markdown (GFM)。它可以在服务器（nodejs）或客户端（浏览器）端使用。

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2008-09-25T16:31:35.310

据我所知，确实没有任何其他基于浏览器的 Markdown 编辑器，至少没有像 WMD 编辑器那样广泛。

Showdown 是 JS 中的 Markdown 转换器，它构成了 WMD 的 HTML 预览的基础。它们都是由[http://attacklab.net/](http://attacklab.net/)制作的。

据我所知，两者都没有什么大的抱怨（至少在 Markdown 邮件列表中没有）。所以去吧。

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2011-04-24T09:22:09.667

有一个名为 Showdown，目前托管在这里：[https ://github.com/coreyti/showdown](https://github.com/coreyti/showdown)

还有[https://github.com/evilstreak/markdown-js](https://github.com/evilstreak/markdown-js) :)

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2012-08-25T06:36:13.320

[最近发布](http://strapdownjs.com)的Strapdown.js ，“让创建优雅的 Markdown 文档变得非常简单。不需要服务器端编译。”

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2008-09-25T16:37:32.317

我没有对此进行测试，但这是另一种选择：

[Markdown 所见即所得](http://sourceforge.net/projects/md-wysiwyg/)

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2012-06-20T09:00:20.657

这个问题现在更加古老，但也更加相关，因为提到的大部分代码都已经过时了几年。

但是，我确实发现了一些似乎仍然是最新的：

[Jquery-Markedit](http://tstone.github.com/jquery-markedit/) - 这是很久以前从 wmd-edit 派生的，并被重构为使用 jQuery。乍一看似乎不错。

[EpicEditor](https://github.com/OscarGodson/EpicEditor) - 仍然得到维护，具有灵活的解析器，正如您在下面看到的那样，作者反应迅速（见下文）。IT 似乎也有很好的文档。遗憾的是不能使用 IE9。

[MarkdownDeep](http://www.toptensoftware.com/markdowndeep/dingus)是第三个仍然是最新的选项。这个有趣的一点是对 Markdown Extra 的支持。对 JQuery 有依赖（其实不用 JQuery 也可以实现）。基于 .NET 版本，因此文档比 JS 版本更符合该版本。这也适用于 IE9。它非常易于使用（使用 JQuery）并且非常简单。据我所知，这并没有发生重大的发展。

[js-markdown-extra](https://github.com/tanakahisateru/js-markdown-extra)是 PHP 库的一个相当准确的端口，并且仍在维护中。它当然支持 Markdown Extra。

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2011-06-12T21:39:20.633

这个问题很古老，但希望这可能对某人有所帮助。我最近刚刚发布了我自己的 Javascript 降价编辑器[uedit](http://amir-hadzic.github.com/uedit/)的工作版本。[您可以在此处](https://github.com/amir-hadzic/uedit)找到源代码。它适用于大多数浏览器（包括 IE6+），并且不依赖于任何外部 JS 库。

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2012-08-15T19:24:03.693

在尝试了几个插件来解决我自己提供 MarkDown seudo-WYSIWYG 的需求之后，我结束了自己的实现：

*   [http://fguillen.github.com/MDMagick/](http://fguillen.github.com/MDMagick/)

也许没有这里评论的所有解决方案强大，但我认为没有一个像**集成和定制那样简单易行**。

# c# - 为什么不能在.Net 的静态方法中使用关键字“this”？

> ID：134237
> 
> 赞同：32
> 
> 时间：2008-09-25T16:08:22.713
> 
> 标签：c#, .net

我试图`this`在静态方法中使用关键字，但编译器不允许我使用它。

为什么不？

* * *

## 回答 #1

> 赞同：67
> 
> 时间：2008-09-25T16:08:50.590

这很容易。关键字“this”返回对包含它的类的当前实例的引用。静态方法（或任何静态成员）不属于特定实例。它们存在而不创建类的实例。在 MSDN 文档中对什么是静态成员以及为什么/何时使用它们有更[深入的解释。](http://msdn.microsoft.com/en-us/library/98f28cdx(printer).aspx)

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2008-09-25T17:07:53.943

作为附加说明，您可以从静态方法访问该类的静态成员。使下面的示例有效并且有时非常有用。

```
public static void StaticMethod(Object o)
{
     MyClass.StaticProperty = o;
} 
```

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2008-09-25T16:10:51.273

静态方法是特定于类的，而不是特定于实例的。“this”表示运行时类的一个实例，因此它不能在静态上下文中使用，因为它不会引用任何实例。相反，应该使用类的名称，并且您只能访问类中的静态成员

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-09-25T16:40:42.870

this 表示当前实例对象，并且没有具有静态方法的实例。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2014-12-03T08:57:47.397

如果您想在静态函数中使用类的非静态函数。在静态函数中创建类的对象。例如

```
 Class ClsProgram(){
public static void staticfunc(){
ClsProgram Obj = new ClsPrograM()
Obj.NonStaticFunc();
}
public void NonStaticFunc(){}
} 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-09-25T19:06:10.570

静态方法中没有`this`对象引用。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2016-10-28T01:02:18.710

对于 OP 的问题，请参阅接受的答案。这个答案适用于那些正在寻找一种快速的单行列以在静态方法中使用的人。

如果该类是一个表单，并且它是打开的（您还需要表单的名称），则可以在静态方法中调用它；

```
Application.OpenForms["MainForm"]; 
```

# ibm-midrange - 检索记录问题

> ID：134244
> 
> 赞同：0
> 
> 时间：2008-09-25T16:09:43.460
> 
> 标签：ibm-midrange, rpgle

好吧，这可能不是最好的主题......

我正在应用程序中设置审批工作流程。我将用户名和美元金额传递给子程序，并找出我需要用于审批流程的工作流程。我以为我已经完成了这项工作，直到我尝试处理尚未设置用户的情况。

所以在我的桌子上我有：

```
wfid wfuser wfamt
1 个用户 1 0
2 用户 2 0
2 用户 2 10000.00
```

现在如果 user3 试图向工作流发送一些东西，它不应该去，因为它们没有设置。（请注意我有另一个包含实际流定义的表）

我有这段代码来检索正确的工作流程：

```
 setgt (userId:amount) ARWFR1;
     readp ARWFR1;
     return wfid; 
```

显然，如果用户设置正确，这将有效。但是，将我们的 user3 sinareo 重新放入，它就无法正常工作。所以我尝试了：

```
 setgt (userId:amount) ARWFR1;
     readpe (userId) ARWFR1;
     if (%eof());
       return 0;
     endif;
     return wfid; 
```

这不像我预期的那样工作。我确定我错过了明显的，你能看到吗？我希望我目前的逻辑足够清晰。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-09-25T16:45:56.150

可以在以下位置找到对我有用的解决方案：http: [//archive.midrange.com/rpg400-l/200809/msg00509.html](http://archive.midrange.com/rpg400-l/200809/msg00509.html)

# nhibernate - 有人有使用 NHibernate 创建偶尔连接的浏览器应用程序的经验吗？

> ID：134245
> 
> 赞同：2
> 
> 时间：2008-09-25T16:10:03.457
> 
> 标签：nhibernate, microsoft-sync-framework, occasionallyconnected

我们需要使我们的企业 ASP.NET/NHibernate 基于浏览器的应用程序能够在连接到客户服务器或从客户服务器断开连接时运行。有人做过吗？如果是这样，你是怎么做到的？（技术、建筑等）

背景：

我们开发和销售一种基于浏览器的企业应用程序，供施工现场人员用于输入时间表信息。目前，它需要连接到客户办公室的服务器，我们希望为那些没有无线 Internet 可用性的客户构建一个偶尔连接的应用程序版本。

我们的应用程序是一个使用 NHibernate 进行 O/R 映射的 ASP.NET 应用程序。作为 Microsoft 商店，Microsoft Sync Framework 很有吸引力，但我们不知道它是否与 NHibernate “配合得很好”。

任何见解将不胜感激。

戴夫吨

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-09-25T20:32:20.833

也许您可以使用小型版本数据库操作某种离线版本（我听说有关 vistadb 的好消息 - [http://www.vistadb.net/](http://www.vistadb.net/)我相信它与 NHibernate 配合得很好）。使用同步工具在数据重新上线时复制数据。单击一次启动器可以处理安装和集成。

但是，要小心涉及同步的任何事情-如果只是单用户时间表可能还可以-但是如果在线-离线数据中存在任何冲突的可能性，则最好从不同的角度考虑问题-回避...

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-20T14:23:52.133

为什么不将它与 Google Gears 结合使用？人们在离线时将数据放入，然后在重新连接到服务器时可以同步数据。

在现代世界中，使用 HTML5 数据存储： [http ://www.webreference.com/authoring/languages/html/HTML5-Client-Side/](http://www.webreference.com/authoring/languages/html/HTML5-Client-Side/)

# c# - C# 异常处理继续出错

> ID：134251
> 
> 赞同：2
> 
> 时间：2008-09-25T16:10:27.077
> 
> 标签：c#, exception, csv

我有一个基本的 C# 控制台应用程序，它逐行读取文本文件（CSV 格式）并将数据放入 HashTable。行中的第一个 CSV 项是键（id num），行的其余部分是值。但是我发现我的导入文件有一些不应该有的重复键。当我尝试导入文件时，应用程序出错，因为哈希表中不能有重复的键。我希望我的程序能够处理这个错误。当我遇到重复键时，我想将该键放入 arraylist 并继续将其余数据导入哈希表。我如何在 C# 中做到这一点

这是我的代码：

* * *

私有静态哈希表导入文件（哈希表 myHashtable，字符串 myFileName）{

```
 StreamReader sr = new StreamReader(myFileName);
        CSVReader csvReader = new CSVReader();
        ArrayList tempArray = new ArrayList();
        int count = 0;

        while (!sr.EndOfStream)
        {
            String temp = sr.ReadLine();
            if (temp.StartsWith(" "))
            {
                ServMissing.Add(temp);
            }
            else
            {
                tempArray = csvReader.CSVParser(temp);
                Boolean first = true;
                String key = "";
                String value = "";

                foreach (String x in tempArray)
                {
                    if (first)
                    {
                        key = x;
                        first = false;
                    }
                    else
                    {
                        value += x + ",";
                    }
                }
                myHashtable.Add(key, value);
            }
            count++;
        }

        Console.WriteLine("Import Count: " + count);
        return myHashtable;
    } 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2008-09-25T16:20:10.487

```
if (myHashtable.ContainsKey(key))
    duplicates.Add(key);
else
    myHashtable.Add(key, value); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-09-25T16:14:07.270

更好的解决方案是调用 ContainsKey 来检查密钥是否存在，然后再将其添加到哈希表中。对这种错误抛出异常会影响性能，并且不会改善程序流程。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-09-25T16:26:37.663

ContainsKey 对每个项目都有恒定的 O(1) 开销，而捕获异常只会对重复项目造成性能影响。

在大多数情况下，我会说检查密钥，但在这种情况下，最好捕获异常。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-09-25T16:42:29.403

这是一个解决方案，可以避免二级列表中的多次命中，所有插入的开销都很小：

```
Dictionary<T, List<K>> dict = new Dictionary<T, List<K>>();

//Insert item
if (!dict.ContainsKey(key))
   dict[key] = new List<string>();
dict[key].Add(value); 
```

您可以将字典包装在隐藏它的类型中，或者将其放在字典上的方法甚至扩展方法中。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-09-25T17:42:13.330

如果您有超过 4 个（例如）CSV 值，则可能值得将*值*变量设置为使用 StringBuilder，因为字符串连接是一个慢速函数。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-09-25T17:51:27.660

嗯，170 万行？我犹豫要不要为这种负载提供这个。

这是使用 LINQ 执行此操作的一种方法。

```
CSVReader csvReader = new CSVReader();
List<string> source = new List<string>();
using(StreamReader sr = new StreamReader(myFileName))
{
  while (!sr.EndOfStream)
  {
    source.Add(sr.ReadLine());
  }
}
List<string> ServMissing =
  source
  .Where(s => s.StartsWith(" ")
  .ToList();
//--------------------------------------------------
List<IGrouping<string, string>> groupedSource = 
(
  from s in source
  where !s.StartsWith(" ")
  let parsed = csvReader.CSVParser(s)
  where parsed.Any()
  let first = parsed.First()
  let rest = String.Join( "," , parsed.Skip(1).ToArray())
  select new {first, rest}
)
.GroupBy(x => x.first, x => x.rest)   //GroupBy(keySelector, elementSelector)
.ToList()
//--------------------------------------------------
List<string> myExtras = new List<string>();
foreach(IGrouping<string, string> g in groupedSource)
{
  myHashTable.Add(g.Key, g.First());
  if (g.Skip(1).Any())
  {
    myExtras.Add(g.Key);
  } 
} 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-09-25T17:05:30.563

谢谢你们。我最终使用了 ContainsKey() 方法。它可能需要多花 30 秒，这对我的目的来说很好。我正在加载大约 170 万行，该程序总共需要大约 7 分钟来加载两个文件、比较它们并写出一些文件。进行比较和写出文件只需要大约 2 秒。

# design-patterns - 你们中有多少人从事三层设计？

> ID：134253
> 
> 赞同：3
> 
> 时间：2008-09-25T16:10:32.863
> 
> 标签：design-patterns, 3-tier

多年来，3 层设计一直是我对数据库驱动应用程序的标准设计理念，它从未让我失望过。对于那些练习它的人，描述你的层次。

我发现很多人混淆了业务层和数据访问层，使其更像是 2.5 层设计。

我更喜欢使用存储过程将数据层几乎完全移动到数据库中，并且只在代码中拥有一个非常轻量级的数据层，将 sproc 调用包装到业务对象中。

你如何处理它？

编辑：如果您要做的只是定义 3 层是什么，请不要浪费时间回复。我正在寻找具体的人如何实现它，您使用存储过程还是 ORM，您如何处理 DAL 和 BLL 之间的循环依赖关系？除了说之外，这个话题还有很多深度

*   用户界面
*   商业
*   数据

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-09-25T16:16:32.773

我已经做了一段时间的主要网络应用程序，并且一直在关注 3-Tier：

UI：纯 ASPX 页面。有时实际上很难将您的业务层从这里向下推，因为在这里进行快速计算或某些事情似乎很容易做到。但是，我已经足够自律，可以确保页面背后的代码除了显示/隐藏面板、更新用户输入等之外什么都不做。

DAL：所有数据访问层的东西。我非常喜欢使用可用的 XSD/DataTable/TableAdapter 类。我还使用基于存储过程的 CRUD 方法，因此将适配器连接到存储过程很容易。

BLL：在我这里的大多数应用程序中，业务层往往是三层中最轻的，因为它们主要是 CRUD 类型的应用程序，内置了一些报告。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-25T16:13:23.480

3层：

*   数据库后端作为数据存储，我们还在数据库中强制执行依赖关系
*   C# 业务层 - 处理通过 http 提交的用户请求（由 aspx 页面接收），根据数据库的状态收集正确的响应并通过 xml 将其返回给客户端（尽管我会推荐 json）
*   javascript 前端 - 以用户友好的方式处理呈现 xml

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-25T16:15:41.213

我练习 3 层设计的方式与您的做法非常相似，因为我使用存储过程来处理大部分（如果不是全部）与数据库的通信。我对我的课程进行设计，以便每个课程都有特定的目的，以降低复杂性并在更改时提供更大的灵活性。

我在 3 层设计中遇到的最大问题之一是在哪里放置输入验证。很多时候，我发现自己在 UI 和业务层都重复验证，以便通过快速验证检查使用户受益，并确保进出数据层的数据是有效的。你如何处理验证？

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-09-25T16:47:31.760

更多的旁注：永远不要忘记 n 层分层是逻辑分层，而不是进程的物理分离。即，不需要让业务逻辑在与展示代码不同的进程（或不同的盒子）中运行。重要的是保持代码干净。

在物理上分离表示代码和业务逻辑已经有一段时间了，例如，通过使用 web 服务连接到后端。在某些情况下，这是一个好主意，但无论如何都不是必需的，但会使您的架构、部署、设计和成本性能显着复杂化。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-12-30T15:14:58.440

我发现 2.5 层设计最适合我创建的新 Web 应用程序。我通常从 2 个类库和 1 个 Web 应用程序开始。

*   `Company.Data`（类库）
*   `Company.Web`（类库）（包含`PageBase`、自定义控件、帮助函数等）
*   `Company.Web.WebApplication`（Web应用程序）

对于我创建的应用程序，我只使用存储过程来访问数据。事实上，我已经创建了 CodeSmith 模板来生成所有的存储过程、数据和业务类。

```
Company.Data 
```

该程序集主要由实体数据类和集合组成。例如，我通常`Settings`在我的 Web 应用程序中调用一个表。一个名为`Setting`并将`SettingCollection`生成的类。

因此，如果我需要加载特定设置，我可以这样做..

```
Dim setting As New Setting(1) 'pass in the id of the specific setting
setting.Value = "False" 'change the value
setting.Save() ' Call the save method to persist changes back to the database 
```

或创建一个新设置，我只是不在构造函数中传递值

```
Dim setting as New Setting()
setting.Name = "SmtpServer"
setting.Value = "localhost"

setting.Save() 
```

我在`Company.Data`程序集中的命名空间通常看起来像这样..

```
Company.Data.Entites
Company.Data.Collections
Company.Data.BusinessObjects 
```

（此命名空间用于创建访问数据的自定义方法）

我还根据主键、外键和唯一索引生成自定义方法。

例如，设置表中的名称列具有唯一索引。`GetSettingByName`将自动生成一个调用的共享方法 ，这将返回一个设置对象。此方法将在`Company.Data.BusinessObjects`命名空间中

对于实体和业务对象类，会生成两个文件。1 是每次生成的，1 是可编辑的并且只在第一次生成。我使用部分类来允许我添加自定义代码而不会被覆盖。

对我来说，这种方法非常有效。Codesmith 生成为我节省了无数小时的编码时间。我可以在一个表中添加 5 个新列，在几秒钟内重新生成所有新代码。存储过程将被删除并重新创建。

2.5 层设计效果很好，因为我的应用程序只使用一个数据库，那就是 Sql Server。以后不会再需要用到access、oracle、mysql了。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-09-25T16:22:54.927

## n层设计

我认为分层效果很好。 [看看 OSI 模型中的层。](http://en.wikipedia.org/wiki/OSI_model) 我已经使用了您描述的三层，这种方法确实很有帮助。模型视图控制器的抽象通常在大型桌面应用程序中很有帮助。您可以继续将事物分解成越来越小的更易于管理的部分。有一个收益递减点。并且，有时我们想要移除抽象层并可能直接与硬件对话——这取决于您的应用程序的目标。

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2008-09-26T02:09:04.157

我们使用大约 6 层设计。

*   浏览器端 Javascript 等等。这是纯粹的视觉糖，几乎没有商业价值或加工。这里的任何输入验证都是多余的检查——它们可以被绕过，所以我们不信任它们。

*   服务器端 HTML 演示文稿。这部分是由业务规则驱动的。但是我们使用的模板语言没有处理。

*   服务器端视图函数，业务逻辑，“控制”。这是导航、验证和“更高级别”的面向应用程序处理发生的地方。这是发生状态变化的地方——计算、更新、删除等等。这就是处理。这是强制执行身份验证和授权的地方。

*   模型定义（使用 ORM 层）。这是对象模型。它映射到关系模型。它包括作为对象方法的所有模型级处理。这是完成一些计算的地方，过滤、计数、排序都在这里定义。这是我们有用的数据视图。

*   访问层（某种数据库连接）。取决于数据库产品。它由 ORM 层管理，所以我们不做任何编码，只是配置。

*   数据库中的持久存储（无存储过程，无触发器）。

* * *

## 回答 #8

> 赞同：-4
> 
> 时间：2008-09-25T16:12:17.277

我们曾经使用以下方法来处理它： - UI 层（所有 UI 所在的位置） - 业务层（所有业务逻辑所在的位置） - 数据层（所有 DB 访问所在的位置）

# tomcat - 如何将 Tomcat 配置为在登录后始终定向到 index.jsp？

> ID：134263
> 
> 赞同：0
> 
> 时间：2008-09-25T16:11:34.500
> 
> 标签：tomcat, jakarta-ee, login

目前 Tomcat 的登录支持将用户重定向到应用程序发现他们未登录时的初始位置。

对于这个特定的应用程序，我需要强制他们总是回到`index.jsp`.

我很确定这是 WAR's 中的一个简单配置选项`web.xml`，但我在 google 中没有找到答案。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-09-30T20:37:53.810

更好的解决方案可能是使用 servlet 过滤器。然后，您可以检查 j_username / j_password，并成功登录并将他们重定向到您希望他们去的地方。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2008-09-25T21:28:26.283

这是您无法在 web.xml 中配置的内容，因为它不是标准的一部分。对于 Tomcat（在 6.0.14 版上测试），您可以通过在 login.jsp 顶部添加下一个代码来强制用户返回 index.jsp。它将 URL 中没有名称为“login”的参数的每个请求重定向到 /index.jsp?login 页面。因为重定向确实具有“登录”参数，所以用户将看到登录页面。

这不是一个安全的解决方案。如果有人请求一个页面并添加登录参数，他将被重定向。所以：

/showPerson?id=1234 将重定向到 /index.jsp?login

/showPerson?id=1234?login 不会重定向到 /index.jsp?login

login.jsp 之上的代码：

```
<%
if (request.getParameter("login") == null) {
    response.sendRedirect(request.getContextPath() + "/index.jsp?login");
    return;
}
%> 
```

您可能可以使用 cookie，而不是使用“登录”参数。您可以通过为登录参数 (login=randomvalue) 创建一个随机值并将该值存储在会话对象中进行比较来使其更安全。

# metrics - 如何解释代码指标（由 SourceMonitor 计算）

> ID：134266
> 
> 赞同：15
> 
> 时间：2008-09-25T16:12:30.473
> 
> 标签：metrics, source-monitor

[在阅读了“计算代码指标”](https://stackoverflow.com/questions/60394/calculate-code-metrics "计算代码指标")问题的答案后，我安装了[SourceMonitor](http://www.campwoodsw.com/sm20.html "源监视器")工具并计算了一些指标。

但我不知道如何解释它们。

什么是指标的“好”值

*   “百分比分支语句”
*   “每类方法”
*   “每个方法的平均语句”
*   “最大方法或函数复杂度”

我在文档中没有找到任何提示，有人可以帮助我吗？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2008-09-25T16:19:38.053

SourceMonitor 是一个很棒的工具。

“每个类的方法”对于那些希望确保他们的类遵循良好的 OO 原则的人很有用（方法太多表明一个类可能承担的责任超出其应有的范围）。

“每个方法的平均语句数”对于大致了解每种方法的大小很有用。对我来说更有用的是关于具有太多语句的方法的信息（双击模块以获得更精细的细节）。

函数复杂度对于确定代码有多糟糕很有用。真的，我使用这些信息比其他任何东西都多。这是关于模块中最糟糕的函数有多复杂的信息（至少根据圈复杂度）。如果您双击模块/文件，您可以找出哪个特定方法如此糟糕。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2008-09-25T20:18:17.793

作为一般经验法则，10 或更少的圈复杂度是您想要的。在大多数情况下，从 11 到 20 的 CC 大约与您想要的一样高：一旦超过 20，您更有可能在查找和修复缺陷时遇到问题，而一旦超过 50，您通常会寻找现在需要重构的方法。

请记住，这些是指导方针。可以有一个 CC 为 25 的方法，该方法尽可能简化；当您需要更新这些方法时，您只需要更加小心。

# sockets - 如何在 VxWorks 5.5 中接收 UDP 组播

> ID：134284
> 
> 赞同：2
> 
> 时间：2008-09-25T16:14:12.667
> 
> 标签：sockets, vxworks

我在 VxWorks 5.5 下无法接收 UDP 多播。我加入了多播组：

```
setsockopt(soc, IPPROTO_IP, IP_ADD_MEMBERSHIP, (char *) &ipMreq, sizeof (ipMreq)); 
```

相邻 Windows 机器上的类似代码确实接收多播。我能够从 VxWorks 发送多播；ifShow() 表示接口支持多播；MCAST_ROUTING 在内核配置中启用，但仍无法接收多播。

**编辑**：我需要在 RealTek 以太网驱动器 RX 配置寄存器中设置一个位，以使多播能够传递到应用层。

```
#define RTL_RXCG_AM           0x04      /* Accept Multicast */ 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-09-25T16:43:09.480

您是否正在检查 Join setsockopt() 调用的返回值以确保它实际上成功了？过去我在使用 VxWorks 5.5 时遇到了一个特定问题，我的多播连接在不应该出现的情况下失败了。我相信我们必须从 WindRiver 获得新的库来解决这个问题。

**编辑：**我不知道让多播与 VxWorks 一起工作的特定技巧。它应该使用标准的 BSD 套接字操作。如果接口可以正确接收单播流量，并且网络分析器（例如 Wireshark）显示正在发送多播 JOIN 并且正确形成了入站多播数据包，那么我怀疑是驱动程序问题。过去，WindRiver 支持对我们解决这些问题非常有帮助；我不知道您是否与他们签订了支持合同以获得该级别的帮助。

# .net - 在 Infragistics Winform UltraCombo 上隐藏标题

> ID：134295
> 
> 赞同：5
> 
> 时间：2008-09-25T16:15:17.987
> 
> 标签：.net, winforms, controls, combobox, infragistics

我已经浏览了几乎所有我能想到的属性，但还没有找到一种简单的方法来从 Infragistics 隐藏 winform UltraCombo 控件上的标题。

当我有多个可见列等等时，标题是有意义的，但有时隐藏它会很好。

举一个简单的例子，假设我有一个组合框，显示某物是否处于活动状态。旁边有一个标签，上面写着“活动”。组合框有一列有两行——“是”和“否”。

当用户打开下拉菜单时，他们会看到“活动”或任何列的标题标题，然后是选项。我希望它只显示“是”和“否”。

这是一个很小的美学问题，可能只是困扰我，甚至没有被用户注意到，但我仍然很想知道是否有办法绕过这种默认行为。

**解决方案：**正如@Craig 所建议的，我需要*ColHeadersVisible 。*该物业的位置略有不同，但很容易找到。一旦我设置了*DisplayLayout.Bands(0).ColHeadersVisible=False*，下拉菜单就会按照我想要的方式显示。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-09-25T16:17:15.627

`<DropDownLayout ColHeadersVisible="No"></DropDownLayout>`为我们工作。这是针对 .NET 2008 的 Infragistics NetAdvantage。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-09-25T16:33:56.240

我对 Infragistics WinForms 套件的理解是 UltraCombo 是为多列（或嵌入式 UltraGrid）使用而设计的。

我为解决这个问题所做的就是用 UltraComboEditor 控件替换那些 UltraCombos。这些是 IG 的标准 .NET 组合框的“增强”版本。

根据您的使用场景，这可能适合您的情况，也可能不适合。但是，看起来您使用原始 UltraCombo 有一个解决方案，这肯定对您现有代码的影响较小。

（感谢你和克雷格：当我第一次经历这种痛苦时，我实际上忽略了那个属性；我正在记下它的未来！）

# search - 如何在 Intellij IDEA 的增量搜索中选择其余单词？

> ID：134298
> 
> 赞同：1
> 
> 时间：2008-09-25T16:15:32.400
> 
> 标签：search, ide, intellij-idea, incremental-search

在 Intellij IDEA 中处于增量搜索模式时，有没有办法选择单词的其余部分。例如，假设我想找到“handleReservationGranted”这个词。我按 Ctrl-f 进入增量搜索模式，然后开始输入字母“han”。现在假设我找到了“handleReservationGranted”的开头。在我的搜索框中，我有“han”，但我现在希望能够选择单词的其余部分，以便搜索框包含“handleReservationGranted”而不是“han”。

在 Xemacs 中，我可以键入 Ctrl-s，键入“han”，然后键入 Ctrl-w。现在我的搜索词是“handleReservationGranted”，而不是“han”。所以现在如果我按下 Ctrl-s，我会找到下一个出现的“handleReservationGranted”。

Intellij IDEA 中是否有类似的功能？我现在能做的最好的事情是继续输入其余的字母（dleReservationGranted），或者退出增量搜索，使用 Ctrl-W 选择单词，然后使用 Ctrl-f 再次输入搜索。

我正在使用 Intellij IDEA 7.0.3。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-09-25T16:24:00.960

是的，您可以在增量搜索期间使用自动完成功能。

键入“han”后，按 CTRL-SPACE（自动完成），它将为您提供文件中潜在匹配项的列表。只需从列表中选择“handleReservationsGranted”，这将成为您的搜索词。

# jsp - 如何从网络上的另一台计算机浏览我的 Tomcat 本地主机？

> ID：134309
> 
> 赞同：21
> 
> 时间：2008-09-25T16:17:04.487
> 
> 标签：jsp, tomcat, localhost

我是一个 IIS 人，知道它就像使用 webapp 的[http://[computername]/path](http://[computername]/path)一样简单。但是，我似乎无法弄清楚如何为我的 JSP 应用程序实现这一点在Tomcat下运行的写作。我需要在某处设置配置设置吗？

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2008-09-25T16:20:07.227

您需要使用默认情况下为 8080 的 Tomcat 端口。因此，您可能希望从机器 B 访问机器 A 上的本地主机 [http://A:8080/YourProject](http://A:8080/YourProject) 并记住与 IIS 不同，它区分大小写。

* * *

## 回答 #2

> 赞同：19
> 
> 时间：2008-09-25T16:31:03.360

您是否在防火墙中创建了例外？

假设 Tomcat 在端口 8080 上运行并且这是一台 Windows XP 机器，防火墙将阻止该端口（在 Windows Server 2003 上不是这种情况）。

可以通过以下方式配置防火墙：从控制面板中选择 Windows 防火墙，然后单击例外 -> 添加端口并输入名称和编号：Tomcat、8080 并将传输协议保留为 TCP

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2010-10-26T14:52:04.470

如果你的 ip 是 192.122.11.22 你必须写[http://192.122.11.22:8080/proyectname](http://192.122.11.22:8080/proyectname)（如果不是，那么看看你的防火墙）

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-09-25T16:31:46.853

您可以使用您的 IP 地址而不是 localhost

[http://10.4.0.1:8080/YourProject](http://10.4.0.1:8080/YourProject)

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2017-10-13T19:04:52.660

**第 1 步：**将防火墙例外添加到您用于主机的端口的入站连接（中的`Host`标记`CATALINA_HOME(Tomcat dir)/conf/server.xml`）。

**第 2 步：**至少在 Windows 10 中，允许 Tomcat 通过防火墙进行通信。一种方法是控制面板->系统和安全-> Windows防火墙->“允许应用程序或功能通过Windows防火墙”->“更改设置”->为“Commons Daemon Service Runner”启用私有和公共（如果不存在） : "Allow another app..." ->`tomcat#.exe`在 Tomcat bin 目录中选择， `#`tomcat 版本号在哪里）

**第 3 步：**为`javaw`. 在 Windows 10 中，这就是上述“更改设置”的步骤，然后是：查找带有路径的 Java(TM) Platform SE 二进制文件`javaw`（如果不存在，请按上述方式添加）-> 为其启用私有和公共。

如果这不起作用，请告诉我。:)

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-09-25T16:21:03.243

Tomcat 默认使用端口 8080，因此您必须在 URL 中提供端口号才能看到任何内容。如果它正在运行[http://yourcomputer:8080/app](http://yourcomputer:8080/app)应该可以解决问题。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2015-12-29T03:01:01.017

除了阻塞端口（参见 AirSource Ltd 的回答），您的防火墙可能对 Tomcat 服务有限制。例如，Mcafee Firewall 将 Tomcat 限制为“仅传出”。

如果使用 Mcafee，请在更改设置 > 防火墙下，展开程序的 Internet 连接并找到 Commons Daemon Service Runner（又名 tomcat*.exe）。编辑它并将访问从仅传出更改为传入和传出 - 使用指定端口（推荐）。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2016-08-17T10:07:13.443

你必须写你机器的 IP 而不是使用“localhost”

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2018-01-22T05:02:27.157

这很好用，只需写[http://your_ipaddress:8080(tomcat](http://your_ipaddress:8080(tomcat) server port)/project name

并确保您连接到相同的网络并且项目部署在 tomcat 上。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2019-06-27T14:50:44.360

` **Step 1** : 进入tomcat安装目录，查找server.xml文件，一般路径为

> C:\Program Files\Apache Software Foundation\Tomcat 9.0\conf\server.xml

用编辑器打开它并寻找连接器块。它会像

```
<Connector port="8080" protocol="HTTP/1.1"
               connectionTimeout="20000"
               redirectPort="8443"/> 
```

添加 **地址="0.0.0.0"** 到它

```
<Connector port="8080" protocol="HTTP/1.1"
               connectionTimeout="20000"
               redirectPort="8443"
               address="0.0.0.0" /> 
```

保存文件。

**第二步：** 进入电脑的防火墙和网络保护设置，**关闭公网防火墙**。

**第三步：** 启动tomcat服务器。然后使用pc的本地ip地址和端口8080（tomcat服务器默认使用，除非你改变它）从其他设备连接到pc上的tomcat服务器。

> 例如 - [http://192.168.8.137:8080/](http://192.168.8.137:8080/)（将 192.168.8.137 替换为您电脑的本地 IP 地址）

# ironpython - IronPython 和 IronRuby 的当前标准合规级别

> ID：134314
> 
> 赞同：4
> 
> 时间：2008-09-25T16:18:13.440
> 
> 标签：ironpython, ironruby

有人对此有一些数字吗？我只是在找一个百分比，一个总结会更好。

标准合规性：实现如何符合标准语言规范？

对于那些仍然不清楚的人：我强调**current**。下面提供的 IronPython 链接包含 2 年前最后一次编辑的信息。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-09-25T16:37:14.953

以下网站通常会更新他们的“合规”进展情况：

铁蟒——

[http://www.codeplex.com/Wiki/View.aspx?ProjectName=IronPython](http://www.codeplex.com/Wiki/View.aspx?ProjectName=IronPython)
[http://www.codeplex.com/IronPython/Wiki/View.aspx?title=Regression%20Tests&referringTitle=More%20Information](http://www.codeplex.com/IronPython/Wiki/View.aspx?title=Regression%20Tests&referringTitle=More%20Information)

铁红宝石 -

[http://www.ironruby.net/](http://www.ironruby.net/)

事实上来自 IronRuby 网站 -

“我们在今年的 RailsConf 上展示了 IronRuby 调度了一些静态和动态 Rails 请求。我们正在运行 RubySpecs 来衡量我们与 Ruby 的一致性，并且我们以 71% 的比率通过了核心规范（RubySpec 核心预期为 12026 / 16793）。 "

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-09-09T10:09:09.333

IronRuby 有一个显示更新数字的网站：[http ://www.ironruby.info](http://www.ironruby.info)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-25T16:20:50.467

我们不会主动跟踪这些类型的数字，但如果您想将其归结为单个数值，您可以下载它们并针对这些语言的相应测试套件运行它们。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-09-09T08:26:36.817

发现[更新](http://blog.jimmy.schementi.com/2009/07/ironruby-at-oscon-2009-mono-moonlight.html)。

他们现在要求 85%。不错 ：）

# delphi - Delphi：OpenFileDialog 与 URL 崩溃

> ID：134321
> 
> 赞同：0
> 
> 时间：2008-09-25T16:19:48.397
> 
> 标签：delphi, url, uri, openfiledialog

给 TOpenFileDialog 一个 URL，Execute 方法抛出一个异常：

```
OpenDialog1.Filename := 'http://www.osfi-bsif.gc.ca/app/DocRepository/1/eng/issues/terrorism/indstld_e.xls';
bResult := OpenDialog1.Execute; 
```

但是您可以从 URL 打开文件。

德尔福5

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-09-25T16:55:03.600

TOpenDialog 只是 comdlg32.dll 中 Windows 函数 GetOpenFileName 的包装器。

```
function TOpenDialog.Execute(ParentWnd: HWND): Boolean;
begin
  Result := DoExecute(@GetOpenFileName, ParentWnd);
end; 
```

不幸的是，这个函数的[文档](http://msdn.microsoft.com/en-us/library/ms646927.aspx)不是很好。但我很确定它不支持http。

# php - PHP 中的错误处理

> ID：134331
> 
> 赞同：31
> 
> 时间：2008-09-25T16:21:05.583
> 
> 标签：php, error-handling

我熟悉一些基础知识，但我想更多地了解的是何时以及为什么应该在 PHP 中使用错误处理（包括抛出异常），尤其是在实时站点或 Web 应用程序中。它是否可以被过度使用，如果是，过度使用是什么样的？有不应该使用的情况吗？此外，关于错误处理，有哪些常见的安全问题？

* * *

## 回答 #1

> 赞同：32
> 
> 时间：2008-09-25T18:43:38.020

添加到已经说过的内容的一件事是，将 Web 应用程序中的任何错误记录到日志中是至关重要的。这样，正如 Jeff “Coding Horror” Atwood 所建议的那样，您将知道您的用户何时遇到了您的应用程序的问题（而不是“问他们出了什么问题”）。

为此，我推荐以下类型的基础架构：

*   在您的数据库中创建一个“崩溃”表和一组用于报告错误的包装类。我建议为崩溃设置类别（“阻塞”、“安全”、“PHP 错误/警告”（与异常）等）。
*   在您的所有错误处理代码中，确保记录错误。始终如一地执行此操作取决于您构建 API 的程度（以上步骤） -如果操作正确，记录崩溃应该是*微不足道的。*

额外的功劳：有时，您的崩溃将是数据库级别的崩溃：即数据库服务器关闭等。如果是这种情况，您的错误记录基础设施（上面）将失败（您无法将崩溃记录到数据库，因为日志尝试写入数据库）。在这种情况下，我会在您的 Crash 包装器类中编写故障转移逻辑

*   向管理员发送电子邮件，和/或
*   将崩溃的详细信息记录到纯文本文件中

所有这些听起来都像是矫枉过正，但相信我，这会影响您的应用程序是否被接受为“稳定”或“不稳定”。这种差异来自这样一个事实，即所有应用程序一开始都是不稳定/崩溃的，但那些了解其应用程序所有问题的开发人员有机会实际修复它。

* * *

## 回答 #2

> 赞同：24
> 
> 时间：2008-09-27T11:02:43.437

粗略地说，错误是 PHP 中的遗留问题，而异常是处理错误的现代方式。那么最简单的事情就是设置一个错误处理程序，它会引发异常。这样一来，所有错误都将转换为异常，然后您可以简单地处理一种错误处理方案。以下代码将为您将错误转换为异常：

```
function exceptions_error_handler($severity, $message, $filename, $lineno) {
  if (error_reporting() == 0) {
    return;
  }
  if (error_reporting() & $severity) {
    throw new ErrorException($message, 0, $severity, $filename, $lineno);
  }
}
set_error_handler('exceptions_error_handler');
error_reporting(E_ALL ^ E_STRICT); 
```

不过，在少数情况下，代码是专门为处理错误而设计的。例如，在验证文档时引发警告的[`schemaValidate`方法。`DomDocument`](http://docs.php.net/manual/en/domdocument.schemavalidate.php)如果将错误转换为异常，它将在第一次失败后停止验证。有时这是您想要的，但在验证文档时，您实际上可能想要*所有*失败。在这种情况下，您可以临时安装一个错误处理程序来收集错误。这是一个小片段，我已用于此目的：

```
class errorhandler_LoggingCaller {
  protected $errors = array();
  function call($callback, $arguments = array()) {
    set_error_handler(array($this, "onError"));
    $orig_error_reporting = error_reporting(E_ALL);
    try {
      $result = call_user_func_array($callback, $arguments);
    } catch (Exception $ex) {
      restore_error_handler();
      error_reporting($orig_error_reporting);
      throw $ex;
    }
    restore_error_handler();
    error_reporting($orig_error_reporting);
    return $result;
  }
  function onError($severity, $message, $file = null, $line = null) {
    $this->errors[] = $message;
  }
  function getErrors() {
    return $this->errors;
  }
  function hasErrors() {
    return count($this->errors) > 0;
  }
} 
```

还有一个用例：

```
$doc = new DomDocument();
$doc->load($xml_filename);
$validation = new errorhandler_LoggingCaller();
$validation->call(
  array($doc, 'schemaValidate'),
  array($xsd_filename));
if ($validation->hasErrors()) {
  var_dump($validation->getErrors());
} 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-09-25T21:58:57.643

恕我直言，最佳做法是使用以下方法： 1\. 创建错误/异常处理程序 2\. 在应用程序启动时启动它 3\. 从内部处理所有错误

```
<?php

class Debug {

    public static setAsErrorHandler() {
         set_error_handler(array(__CLASS__, '__error_handler'));
    }

public static function __error_handler($errcode, $errmsg, $errfile, $errline) {
       if (IN DEV) {
                print on screen
           }
           else if (IN PRO) {
                log and mail
           } 
    }
}

Debug::setAsErrorHandler();

?> 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-09-25T16:33:33.480

未经处理的错误会停止脚本，仅此一项就是处理它们的一个很好的理由。

通常您可以使用 Try-Catch 块来处理错误

```
try
{
    // Code that may error
}
catch (Exception $e)
{
    // Do other stuff if there's an error
} 
```

如果您想停止页面上出现的错误或警告消息，则可以在调用前加上 @ 符号，如下所示。

```
 @mysql_query($query); 
```

然而，对于查询，做这样的事情通常是个好主意，这样你就可以更好地了解正在发生的事情。

```
@mysql_query($query)
    or die('Invalid query: ' . mysql_error() . '<br />Line: ' . __LINE__ . '<br />File: ' . __FILE__ . '<br /><br />'); 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-09-25T17:06:12.917

在您无法明确控制脚本正在处理的数据的情况下，您应该使用错误处理。我倾向于经常使用它，例如在表单验证等地方。知道如何发现代码中容易出错的地方需要一些实践：一些常见的地方是在返回值的函数调用之后，或者在处理来自数据库查询的结果时。你永远不应该假设函数的返回会是你所期望的，你应该确保在预期中编写代码。您不必使用 try/catch 块，尽管它们很有用。很多时候，您可以通过简单的 if/else 检查来解决问题。

错误处理与安全编码实践密切相关，因为有很多“错误”不会导致您的脚本简单地崩溃。虽然不是严格的错误处理本身，但 addedbytes 有一篇很好的 4 篇文章系列，介绍了一些安全 PHP 编程的基础知识，您可以在[这里](http://www.addedbytes.com/php/writing-secure-php/)找到。在 stackoverflow 上还有很多其他问题，例如[mysql_real_escape_string](https://stackoverflow.com/questions/110575/do-htmlspecialchars-and-mysqlrealescapestring-keep-my-php-code-safe-from-inject#116237)和[正则表达式](https://stackoverflow.com/search?s=regular+expressions)，它们在确认用户输入数据的内容方面非常强大。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-09-25T16:47:32.760

您可以将其存储在日志中，而不是输出 mysql_error。这样您就可以跟踪错误（并且您不依赖用户报告它）并且您可以进入并删除问题。

最好的错误处理是对用户透明的那种，让你的代码解决问题，不需要那个用户伙伴。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-09-25T17:55:18.963

除了立即在代码中处理错误之外，您还可以使用

[http://us.php.net/manual/en/function.set-exception-handler.php](http://us.php.net/manual/en/function.set-exception-handler.php)
和
[http://us.php.net/manual/en/function.set-error-handler.php](http://us.php.net/manual/en/function.set-error-handler.php)

我发现设置自己的异常处理程序特别有用。当发生异常时，您可以根据异常类型执行不同的操作。

例如：当`mysql_connet`呼叫返回时，`FALSE`我会抛出一个`new DBConnectionException(mysql_error())`并以“特殊”方式处理它：记录错误、数据库连接信息（主机、用户名、密码）等，甚至可能通过电子邮件通知开发团队可能真的有问题数据库

我用它来补充标准错误处理。我不建议过度使用这种方法

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2008-09-27T14:38:10.627

@ 错误抑制非常慢。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-11-18T01:19:45.843

您还可以使用 Google 表单来捕获和分析异常，而无需维护数据库或可公开访问的服务器。[这里](http://www.brighthub.com/hubfolio/matthew-casperson/articles/56351.aspx)有一个教程解释了这个过程。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2022-01-08T19:39:50.667

```
public $error=array();
public function Errors($Err)
{

   ------ how to use -------
   $Err = array("func" => "constr", "ref"  => "constrac","context"  =>  
   "2222222ت","state" => 3,);
    $ResultErr=$this->Errors($Err);
    $context=(array_filter(explode(',', $ResultErr['context'])));
    $func=(array_filter(explode(',', $ResultErr['func'])));
    $ref=(array_filter(explode(',', $ResultErr['ref'])));
    $state=($ResultErr['state']);
    $errors=array_merge(["context"=>$context], ["func"=>$func], 
    ["ref"=>$ref], ["state"=>$state]);
    var_dump($errors);

   ---------------begine ------------------------      
    global $error;
    if (!is_array($Err)) {
        return $error;
    } else {
        if (!(isset($error['state']))) {
            $error['state']="";
        }
        if (!(isset($error['func']))) {
            $error['func']="";
        }
        if (!(isset($error['ref']))) {
            $error['ref']="";
        }
        if (!(isset($error['context']))) {
            $error['context']="";
        }
        $error['state']=$error['state'];
        $error['func']=$error['func'].= $Err["func"].",";
        $error['ref']=$error['ref'].= $Err["ref"].",";
        $error['context']=$error['context'].= $Err["context"].",";
        $error["state"]=$Err["state"];
        return $error;
    }
} 
```

# eclipse - Eclipse 文件夹 Referenced Libraries 消失

> ID：134338
> 
> 赞同：42
> 
> 时间：2008-09-25T16:23:34.860
> 
> 标签：eclipse

在 Eclipse 版本 3.4.1 的 Java 项目中，有时文件夹“Referenced Libraries”会从“Project Explorer”视图中消失。所有第三方 jar 都直接显示在项目文件夹的根目录中。该项目编译并运行良好。这似乎是一个 GUI 问题。

我怎样才能找回这个文件夹？

* * *

## 回答 #1

> 赞同：92
> 
> 时间：2008-09-25T16:39:40.907

首先，打开“Package Explorer”视图（而不是“Project Explorer”视图）。

然后，如果引用的 .jar 文件在项目的根目录中仍然可见，请单击 Package Explorer 视图右上角的小“向下箭头”图标。在出现的上下文菜单中，菜单上的一项是“显示'引用的库'节点”。单击该菜单项。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-07-03T09:33:20.720

我在**Eclipse Juno**中一直在努力解决这个问题，因为它有点不同。

*   `down arrow`像以前一样点击小
*   点击`Customize view`
*   查看`Libraries from external`

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2015-04-10T15:09:50.893

对于今天遇到问题的人（Kepler）：您可能处于“Java EE”透视图中，默认情况下具有 Project Explorer。只需切换到“Java”透视图，它将用包资源管理器替换项目资源管理器，后者将缺少引用库文件夹。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2017-03-13T19:19:38.260

确保您实际上是在 Project Explorer 中，而不是在像 Navigator 这样的其他视图中，就像我的朋友...

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2018-04-02T09:26:30.817

使用 Package Explorer 视图而不是 Project Explorer 视图。

# windows-mobile - 如何在 Windows Mobile 上为 PDA 检索时区选择

> ID：134344
> 
> 赞同：2
> 
> 时间：2008-09-25T16:23:59.680
> 
> 标签：windows-mobile, timezone

有没有办法在 Windows Mobile 中检索时区选项以便在 GUI 中显示它们？最好不必每 15 分钟显示一次，以便能够显示加德满都的 GMT+5:45。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-24T09:27:55.897

根据[MSDN：城市列表和时区数据文件](http://msdn.microsoft.com/en-us/library/aa458853.aspx)，

> 您可以向这些文件添加或删除内容。您可以按原样重新分发这些文件，也可以通过将其包含在源代码、数据库或其他格式中来重新打包这些数据。您可以使用此数据的摘录，而不是整个数据集。

```
Note   Microsoft bears no responsibility for the content or
usage of these files. Certain locales have specific legal requirements with
regard to providing data of this type; ensure you are in compliance with such
regulations. 
```

> 如果您使用提供的城市数据或使用来自任何来源的任何类型的地理信息，我们鼓励您为用户提供编辑、添加和删除信息的方式。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-09-25T19:43:47.877

Windows Mobile 将时区信息存储在[名为 Timezones.csv 的文件中](http://msdn.microsoft.com/en-us/library/aa458853.aspx)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-02T09:37:38.527

Windows Mobile SDK 的 \Resource 文件夹中提供了 Timezones.csv 和 CityList.csv 文件！

您可以修改列表并决定要向用户显示的列表。

# c# - 如何确定 Windows Mobile 中的程序中断

> ID：134359
> 
> 赞同：2
> 
> 时间：2008-09-25T16:26:34.667
> 
> 标签：c#, windows-mobile, mobile

我有一个为 Windows Mobile 编写的游戏应用程序，我想要一个与拼图关联的计时器。如果程序由于任何原因失去焦点（来电，用户切换程序，用户点击 Windows 按钮），那么我想要一个弹出对话框来覆盖拼图并停止计时器。当用户关闭弹出对话框时，计时器可以再次启动。

有谁知道如何做到这一点？

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-09-25T19:36:12.853

查看[OpenNETCF 社区站点上关于确定表单或流程何时更改的文章](http://community.opennetcf.com/articles/cf/archive/2008/08/13/determining-form-and-process-changes-in-windows-ce.aspx)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-09-25T17:04:20.630

一个快速的方法是**使用 PInvoke 来调用 GetForegroundWindow() 和 GetWindowText(** ) 每当你的计时器滴答（每秒一次？）。

GetForegroundWindow() 返回一个可用于调用 GetWindowText() 的窗口句柄。如果前台窗口的文本与表单的 Text 属性（其标题）匹配，则您知道您的应用程序具有焦点。然后，您可以在每个计时器滴答声中显示或隐藏您的谜题。

# memcached - 多个 memcached 实例的好处

> ID：134366
> 
> 赞同：6
> 
> 时间：2008-09-25T16:28:15.990
> 
> 标签：memcached

运行 4 个 .5GB 内存缓存服务器或一个 2GB 实例之间有什么区别吗？

运行多个实例有什么好处吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-09-25T16:32:30.690

如果一个实例失败，您仍然可以获得使用缓存的优势。如果您使用的 Consistenthashing 将相同的数据带到同一个实例，而不是在仍在运行的机器之间传播新的读/写，则尤其如此。

您还可以选择在 32 位操作系统上运行服务器，该操作系统不能处理超过 3GB 左右的内存。

查看常见问题解答：http: [//www.socialtext.net/memcached/](http://www.socialtext.net/memcached/)和[http://www.danga.com/memcached/](http://www.danga.com/memcached/)

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-09-25T16:31:33.017

高可用性很好，memcached 会自动将您的缓存分布在 4 台服务器上。如果其中一个服务器由于某种原因而死机，您可以通过继续处理该错误，就好像缓存是空白的一样，重定向到不同的服务器，或者您想要的任何类型的自定义错误处理。如果您的 1x 2gb 服务器死机，那么您的选择非常有限。

要记住的重要一点是，您没有 4 个缓存副本，它是 1 个缓存，分配给 4 个服务器。

唯一的缺点是用完 4x .5 比用完 1x 2gb 内存更容易。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-10-25T20:35:06.190

I would also add that theoretically, in case of several machines, it might save you some performance, as if you have a lot of frontends doing a lot of heavy reads, it's much better to split them into different machines: you know, network capabilities and processing power of one machine can become an upper bound for you.

This advantage is highly dependent on memcache utilization, however (sometimes it might be ways faster to fetch everything from one machine).

# c++ - 您如何编写对 UTF-8 安全的代码？

> ID：134371
> 
> 赞同：10
> 
> 时间：2008-09-25T16:30:20.197
> 
> 标签：c++, unicode, utf-8, globalization

我们有一组为 ASCII 字符集开发的应用程序。现在，我们正试图在冰岛安装它，但遇到了冰岛字符被搞砸的问题。

我们正在解决我们的问题，但我想知道：是否有一个很好的“指南”来编写专为 8 位字符设计的 C++ 代码，并且在提供 UTF-8 数据时可以正常工作？

我不能指望每个人都阅读整个 Unicode 标准，但如果有更容易理解的内容，我想与团队分享，这样我们就不会再遇到这些问题了。

此时重写所有应用程序以使用 wchar_t 或其他字符串表示形式是不可行的。我还会注意到这些应用程序通过网络与使用 8 位字符的服务器和设备进行通信，因此即使我们在内部使用 Unicode，我们仍然会在边界处遇到翻译问题。在大多数情况下，这些应用程序只是传递数据。除了从一个地方复制到另一个地方之外，他们不会以任何方式“处理”文本。

使用的操作系统是 Windows 和 Linux。我们使用 std::string 和普通的 C 字符串。（不要让我为任何设计决定辩护。我只是想帮助解决这个烂摊子。）

* * *

以下是建议的清单：

*   [每个软件开发人员绝对、肯定必须了解 Unicode 和字符集的绝对最低要求（没有借口！）](http://www.joelonsoftware.com/articles/Unicode.html)
*   [适用于 Unix/Linux 的 UTF-8 和 Unicode 常见问题解答](http://www.cl.cam.ac.uk/~mgk25/unicode.html)
*   [Unicode 指南](ftp://ftp.ilog.fr/pub/Users/haible/utf8/Unicode-HOWTO.html)

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2008-09-25T17:54:24.223

在大多数情况下，只需 8 位干净。但是，您必须注意任何非 ASCII 字符都会拆分为多个字节，因此如果要显示换行或截断文本，则必须考虑到这一点。

UTF-8 的优点是您始终可以在多字节字符中判断您所在的位置：如果第 7 位被设置并且第 6 位重置（字节为 0x80-0xBF），这是一个尾随字节，而如果第 7 位和第 6 位是设置和 5 复位 (0xC0-0xDF) 它是一个前导字节和一个尾随字节；如果设置了 7、6 和 5 并且重置了 4 (0xE0-0xEF)，则它是带有两个尾随字节的前导字节，依此类推。在最高有效位设置的连续位的数量是组成字符的字节总数。那是：

110x xxxx = 两字节字符
1110 xxxx = 三字节字符
1111 0xxx = 四字节字符
等

冰岛字母全部包含在 ISO 8859-1 和 Windows-1252 中。如果这是控制台模式应用程序，请注意控制台使用 IBM 代码页，因此（取决于系统区域设置）它可能显示为 437、850 或[861](http://en.wikipedia.org/wiki/Code_page_861)。Windows 没有对 UTF-8 的原生显示支持；您必须转换为 UTF-16 并使用 Unicode API。

如果是控制台模式应用程序，调用 SetConsoleCP 和 SetConsoleOutputCP 并指定代码页 1252 将有助于解决您的问题。不幸的是，选择的控制台字体必须是支持代码页的字体，我看不到设置字体的方法。标准位图字体仅支持系统默认的 OEM 代码页。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-09-25T16:45:07.837

这看起来像一个全面的快速指南：
[http ://www.cl.cam.ac.uk/~mgk25/unicode.html](http://www.cl.cam.ac.uk/~mgk25/unicode.html)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-25T16:59:05.133

请注意，完整的 unicode 不适合 16 位字符；所以要么使用 32 位字符，要么使用可变宽度编码（UTF-8 是最流行的）。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-09-25T17:13:41.463

UTF-8 的设计完全考虑了您的问题。我要注意的一件事是 ASCII 实际上是 7 位编码，所以如果您的基础设施的任何部分将第 8 位用于其他目的，那可能会很棘手。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-09-25T18:11:11.593

您可能想查看[icu](http://www.icu-project.org/)。它们可能具有使处理 UTF-8 字符串更容易的功能。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-09-25T17:05:49.003

冰岛语使用 ISO Latin 1，所以 8 位应该足够了。我们需要更多细节来弄清楚发生了什么。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-06-29T13:20:02.893

冰岛语与法语、德语和大多数其他西欧语言一样，可以使用 8 位字符集（Windows 上的 CP1252，*x 上的 ISO 8859-1 aka Latin1）来支持。这是 Unicode 发明之前的标准方法，并且仍然很常见。正如你所说，你有一个约束，你不能重写你的应用程序来使用 wchar，你也不需要。

您不应该对 UTF-8 引起问题感到惊讶。UTF-8 将非 ASCII 字符（例如带重音的拉丁字符、thorn、eth 等）编码为每个两个字节。

唯一可以给出的一般性建议非常简单（理论上）：（1）决定您的系统中要支持的字符集（Unicode，Latin1，CP1252，...）（2）如果您被提供以其他方式（例如 UTF-8）编码的数据，然后在系统边界 (3) 将其转码为您的标准（例如 CP1252），如果您需要提供以其他方式编码的数据，...

* * *

## 回答 #8

> 赞同：-1
> 
> 时间：2008-09-25T16:39:12.657

您可能想要使用宽字符（wchar_t 代替 char 和 std::wstring 代替 std::string）。这不会自动解决 100% 的问题，但这是很好的第一步。

还可以使用支持 Unicode 的字符串函数（请参阅文档）。如果某些东西操纵宽字符或字符串，它通常会意识到它们是宽的。

# javascript - 如何在 Javascript 中监听元素方法调用

> ID：134374
> 
> 赞同：1
> 
> 时间：2008-09-25T16:30:29.243
> 
> 标签：javascript, listeners

我想听方法调用。

例如，当一个元素被任何内容附加到文档时，我希望传递该元素以对其进行操作，例如：

//某处

```
aParent.appendChild(aChild); 
```

//当前者时，我定义为侦听器的函数使用`aChild`as 参数调用

有人知道该怎么做吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-09-25T16:40:02.090

不知道核心功能是否可行，但您始终可以为要监控的操作创建自己的功能：

```
 function AppendChild(oParent, oChild) {

   // your stuff on oParent

   // append oChild
   oParent.appendChild(oChild)
} 
```

或者，也许，修改实际的 appendChild()，但这会很棘手......

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-09-25T17:21:28.293

您所描述的是[面向方面的编程](http://en.wikipedia.org/wiki/Aspect-oriented_programming)。在 AOP 用语中，您的“连接点”将是 element.appendChild()，而您的“建议”是您希望执行（之前和/或之后）每个匹配的连接点执行的函数。

一段时间以来，我一直对 JavaScript AOP 的可能性非常感兴趣，我刚刚发现了这个[Aspect Oriented Programming 和 javascript](http://www.dotvoid.com/2005/06/aspect-oriented-programming-and-javascript/)，它看起来很有希望，不需要采用一个大的旧 API。——我真的很高兴你提出这个问题。我对此有用途，例如临时日志记录、计时代码段等。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-25T17:36:14.610

多个浏览器以不同的方式处理 DOM，不幸的是 IE 处理事物的方式不如 Mozilla 的方式强大。最简单的方法是使用像 Filini 提到的自定义函数。

但是，您也可以将不同浏览器的 DOM 对象包装在外观中，并将其用于所有元素访问。这需要更多的工作，但您将能够以相同的方式处理所有浏览器，并能够轻松添加/删除侦听器。我不确定它是否比自定义函数更有用，但值得一看。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-25T16:45:28.630

我知道 Dojo Toolkit 提供了这个功能。[您可以在此处](http://dojotoolkit.org/book/dojo-book-0-9/part-3-programmatic-dijit-and-dojo/event-system/simple-connections-dojo-connect)进行一些解释- 跳转到“将功能相互连接”部分。有兴趣的可以看看[dojo.connect的源码](http://archive.dojotoolkit.org/nightly/dojotoolkit/dojo/_base/connect.js)看看是怎么回事。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-09-25T16:46:13.980

在 Firefox 中，您可以重写[Node](http://www.xulplanet.com/references/objref/Node.html) .prototype.appendChild 以调用您自己的函数（先保存原始的 appendChild，然后在其中调用它）来执行其他操作。

```
Node.prototype._appendChild = Node.prototype.appendChild;
Node.prototype.appendChild = function myFunct(el){....; this._appendChild(el);} 
```

Internet Explorer 没有实现这些接口（但可能有一种解决方法，可能使用 .htc..）。IE8 将有 Element 而不是 Node。

# sharepoint - Infopath 不使用 Outlook 任务/Sharepoint 渲染背景颜色/图片

> ID：134378
> 
> 赞同：1
> 
> 时间：2008-09-25T16:31:06.620
> 
> 标签：sharepoint, outlook, workflow, infopath, task

我正在使用 Infopath 表单收集信息以触发我在 Sharepoint 2007 上的 Windows 工作流。Infopath 表单具有徽标和品牌，仅显示在 Sharepoint 门户上，但在工作流期间创建任务时通过电子邮件发送的 infopath 表单看起来不同背景颜色（Infopath 主题）和 jpeg 不存在...在所有适当的地方检查了 Web 表单兼容性...有什么想法吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-09-27T17:09:36.253

在这里找到问题...InfoPath 似乎在客户端缓存表单（似乎在缓存中检查表单的唯一 URN），这意味着如果您尝试单击电子邮件“编辑此任务...”新表单不会下载，而是显示缓存中的 InfoPath 表单。

我正在寻找解决此问题的几种方法。同时，为了能够在 InfoPath 表单上看到 jpeg 和背景颜色，请在您的 cmd 窗口上运行以下命令（抱歉，它现在是“hacky”）

"C:\Program Files\Microsoft Office\Office12\INFOPATH.EXE" /cache clearall

当我找到解决这个问题的好方法时会写一篇博文

雅各布

# mysql - 以预定义的顺序返回查询结果

> ID：134379
> 
> 赞同：16
> 
> 时间：2008-09-25T16:31:27.463
> 
> 标签：mysql, sql-order-by

`SELECT`是否可以按照预定的顺序做一个陈述，即。仅根据 ID 字段选择 ID 7、2、5、9 和 8**并按该顺序返回它们**？

这两个语句都以相同的顺序返回它们：

```
SELECT id FROM table WHERE id in (7,2,5,9,8) 
```

```
SELECT id FROM table WHERE id in (8,2,5,9,7) 
```

* * *

## 回答 #1

> 赞同：37
> 
> 时间：2008-09-25T16:37:29.977

我不认为这是可能的，但在这里找到了一个似乎做你所追求的事情的[博客条目：](http://www.handgestrickt.biz/item/21/)

```
SELECT id FROM table WHERE id in (7,2,5,9,8) 
ORDER BY FIND_IN_SET(id,"7,2,5,9,8"); 
```

会给不同的结果

```
SELECT id FROM table WHERE id in (7,2,5,9,8) 
ORDER BY FIND_IN_SET(id,"8,2,5,9,7"); 
```

`[FIND_IN_SET](http://dev.mysql.com/doc/refman/5.0/en/string-functions.html#function_find-in-set)`返回`id`给它的第二个参数中的位置，所以对于上面的第一种情况，`id`7 在集合中的位置 1，2 在 2 等等 - mysql 内部计算出类似

```
id | FIND_IN_SET
---|-----------
7  | 1
2  | 2
5  | 3 
```

然后按 的结果排序`FIND_IN_SET`。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-09-25T16:42:45.440

你最好的选择是：

```
ORDER BY FIELD(ID,7,2,4,5,8) 
```

......但它仍然很丑。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-25T16:36:44.097

您能否包含一个将您的 ID 7,2,5,... 映射到序数 1,2,3,... 的 case 表达式，然后按该表达式排序？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-25T16:35:20.887

所有排序均由 ORDER BY 关键字完成，但您只能按升序和降序排序。如果您使用诸如 PHP 之类的语言，则可以使用一些代码对它们进行相应的排序，但我认为仅使用 MySQL 是不可能的。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-09-25T16:36:26.373

这适用于甲骨文。你能在 MySql 中做类似的事情吗？

```
SELECT ID_FIELD
FROM SOME_TABLE
WHERE ID_FIELD IN(11,10,14,12,13)
ORDER BY
  CASE WHEN ID_FIELD = 11 THEN 0
       WHEN ID_FIELD = 10 THEN 1
       WHEN ID_FIELD = 14 THEN 2
       WHEN ID_FIELD = 12 THEN 3
       WHEN ID_FIELD = 13 THEN 4
  END 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-09-25T16:37:43.423

您可能需要创建一个带有自动编号字段的临时表并以所需的顺序插入其中。然后对新的自动编号字段进行排序。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-09-25T16:38:58.770

这很 hacky（而且可能很慢），但你可以使用 UNION ALL 来获得效果：

```
SELECT id FROM table WHERE id = 7
UNION ALL SELECT id FROM table WHERE id = 2
UNION ALL SELECT id FROM table WHERE id = 5
UNION ALL SELECT id FROM table WHERE id = 9
UNION ALL SELECT id FROM table WHERE id = 8; 
```

**编辑：其他人提到了**[此处](http://dev.mysql.com/doc/refman/5.0/en/string-functions.html#function_find-in-set)记录的 find_in_set 函数。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-09-25T16:39:42.607

嗯，不是真的。你能得到的最接近的可能是：

```
SELECT * FROM table WHERE id IN (3, 2, 1, 4) ORDER BY id=4, id=1, id=2, id=3 
```

但你可能不想要那个:)

如果没有关于表格中内容的更多信息，很难为您提供任何更具体的建议。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-09-25T16:47:18.220

你在这里很快就能得到答案，不是吗……</p>

我问这个的原因是，这是我能想到的避免对复杂的多维数组进行排序的唯一方法。我并不是说排序会很困难，但是如果有更简单的方法可以使用直接 sql 进行排序，那为什么不呢。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2008-12-04T20:18:47.923

一种 Oracle 解决方案是：

```
SELECT id FROM table WHERE id in (7,2,5,9,8)
ORDER BY DECODE(id,7,1,2,2,5,3,9,4,8,5,6); 
```

这会为每个 ID 分配一个订单号。适用于一小组值。

* * *

## 回答 #11

> 赞同：-1
> 
> 时间：2008-09-25T16:39:20.533

我能想到的最好的方法是添加第二个列 orderColumn：

```
7 1
2 2
5 3
9 4 
8 5 
```

然后只做一个 ORDER BY orderColumn

# python - 将 Pylons 控制器作为单独的应用程序运行？

> ID：134387
> 
> 赞同：11
> 
> 时间：2008-09-25T16:34:14.663
> 
> 标签：python, pylons

我有一个 Pylons 应用程序，我想将一些逻辑移动到一个单独的批处理过程中。我一直在主应用程序下运行它进行测试，但它将在数据库中做很多工作，我希望它是一个单独的进程，将在后台不断运行。主 pylons 应用程序会将作业提交到数据库中，新进程将完成每个作业中请求的工作。

如何将控制器作为独立脚本启动？

我目前有：

```
from warehouse2.controllers import importServer
importServer.runServer(60) 
```

在控制器文件中，但不是控制器类的一部分：

```
def runServer(sleep_secs):
    try:
        imp = ImportserverController()
        while(True):
            imp.runImport()
            sleepFor(sleep_secs)

    except Exception, e:
        log.info("Unexpected error: %s" % sys.exc_info()[0])
        log.info(e) 
```

但是在命令行上启动 ImportServer.py 会导致：

```
2008-09-25 12:31:12.687000 Could not locate a bind configured on mapper Mapper|I
mportJob|n_imports, SQL expression or this Session 
```

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-04-24T03:42:01.870

如果要加载 Pylons 应用程序的一部分，例如来自 Pylons 外部的模型，请先在脚本中加载 Pylons 应用程序：

```
from paste.deploy import appconfig
from pylons import config

from YOURPROJ.config.environment import load_environment

conf = appconfig('config:development.ini', relative_to='.')
load_environment(conf.global_conf, conf.local_conf) 
```

这将加载 Pylons 应用程序，该应用程序设置了大部分状态，以便您可以继续使用 SQLAlchemy 模型和 Session 来处理数据库。

请注意，如果您的代码正在使用诸如请求/响应/等之类的 pylons 全局变量，那么这将不起作用，因为它们需要正在进行的请求才能存在。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-25T19:04:57.483

我正在修改我的回答并支持 Ben Bangert 的另一个回答，因为它是正确的。我回答并从此学会了正确的方法（如下所述）。如果您真的想要，请查看此答案的历史记录，以查看我最初提出的错误（但有效）解决方案。

# asp.net-mvc - 您在哪里进行验证？模型、控制器或视图

> ID：134388
> 
> 赞同：12
> 
> 时间：2008-09-25T16:35:01.107
> 
> 标签：asp.net-mvc, validation, design-patterns

您将用户输入验证放在 Web 表单应用程序的什么位置？

1.  视图：JavaScript 客户端
2.  控制器：服务器端语言（C#...）
3.  模型：数据库（存储过程或依赖项）

我认为每个级别都需要验证：

1.  用户是否输入了一个合理的值
    *   是日期实际日期，是数字实际数字...
2.  再次执行 1\. 中的所有检查，并检查恶意攻击（IE XSS 或 SQL 注入）
    *   1.中所做的检查主要是为了避免用户出错时服务器往返。
    *   由于它们是在 javascript 中在客户端完成的，因此您不能相信它们是在运行的。再次验证这些值将阻止一些恶意攻击。
3.  是否满足依赖关系（即用户是否向有效问题添加了评论）
    *   一个好的界面使这些很难违反。如果有什么东西在这里被抓住了，那么事情就很不对劲了。

[[受此响应](https://stackoverflow.com/questions/134253/how-many-of-you-do-3-tier-design#134300)的启发]

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-09-25T16:37:05.407

我检查了所有层级，但我想说明我使用的验证技巧。

我在数据库层进行验证，对模型的适当约束将提供自动数据完整性验证。

这是大多数 Web 程序员似乎迷失的艺术。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-09-25T16:44:34.407

模型中的验证，可选的 UI 中的自动化例程，从模型中获取提示并改善用户体验。

通过自动化例程，我的意思是用户界面中不应该有任何每个模型的验证代码。如果您有一个验证方法库，例如 RoR（具有 validates_presence_of :username 之类的方法），则控制器或视图应该能够读取这些方法并应用等效的 javascript（或任何方便的方法）。

这意味着您必须在 ui 中复制完整的验证库，或者如果您使用预先存在的映射，则至少提供一个映射。但是一旦完成，您就不必在模型之外编写任何验证逻辑。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-09-25T16:41:13.227

可以在所有层进行验证。

验证来自 Web 表单的输入（所有字符串、转换为适当的类型等）与验证来自 Web 服务或 XML 文件等的输入不同。每一种都有自己的特殊情况。当然，您可以创建一个 Validator 助手类，从而将 Validation 外部化并允许它被视图共享。

然后你有DAO层验证 - 模型中是否有足够的数据来持久化（以满足非空约束等）等等。您甚至可以在数据库中设置检查约束（是 ('N', 'A', 'S', 'D') 等中的状态）。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-11-26T08:37:56.433

这很有趣。我在模型中执行所有验证的时间最长，就在我认为的 DAL（数据访问层）之上。我的模型通常是在表数据网关之后使用 DAL 提供抽象和低级 API 的。

在 TDG 中，我将实现业务逻辑和验证，例如：

1.  用户名是否为空
2.  用户名 > 30 个字符
3.  如果记录不存在，则返回错误

随着我的应用程序变得越来越复杂，我开始意识到大部分验证都可以在客户端使用 JavaScript 完成。所以我将大部分验证逻辑重构为 JS 并清理了我的模型。

然后我意识到服务器端验证（不是过滤/转义——我认为不同）应该在服务器中完成，并且只有客户端作为锦上添花。

因此，当我再次意识到，INPUT 验证/断言和业务规则/逻辑之间可能存在明显差异时，验证逻辑又回来了。

基本上，如果它可以在应用程序的客户端完成（使用 JS）我认为这是 INPUT 验证......如果它必须由模型完成（这个记录是否已经存在等？）然后我会考虑商业逻辑。令人困惑的是它们都保护了数据模型的完整性。

如果您不验证用户名的长度，那么如何阻止人们创建单字符用户名？

我还没有完全决定接下来把这个逻辑放在哪里，我认为这真的取决于你更喜欢什么，瘦控制器，重型模型，或者反之亦然......

在我的例子中，控制器往往更加以应用程序为中心，而如果精心制作模型，我经常可以在“其他”项目中重用，而不仅仅是在内部，所以我更喜欢保持模型的轻量级和较重的控制器。

真正驱使你朝任何一个方向发展的力量是个人观点、要求、经验等……

有趣的主题:)

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2008-11-26T09:07:26.500

验证*必须*在控制器中完成 - 这是唯一确保安全和响应的地方。

验证*应该*在视图中完成 - 它是联系点，将提供最好的 UE 并为您的服务器节省额外的工作。

验证*将*在模型上完成 - 但仅限于特定核心级别的检查。数据库应该总是反映适当的约束，但是让它代表真正的验证是低效的，数据库也不总是可以用简单的约束来确定有效的输入。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2008-09-25T16:45:45.697

所有验证都应该至少发生一次，这应该在中间层，无论是在您的值对象中（在 DDD 意义上，不要与 DTO 混淆），还是通过实体本身的业务对象。可以进行客户端验证以增强用户体验。我倾向于不进行客户端验证，因为我可以一次在表单上暴露所有错误的东西，但这只是我个人的偏好 可以进行数据库验证以确保数据完整性，以防你搞砸了逻辑中间层或后端的东西。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-09-25T16:43:52.520

我只在视图和控制器中执行此操作，数据库通过您的数据类型和诸如此类的东西强制执行其中的一些操作，但我宁愿它在没有我发现错误的情况下走得那么远。

尽管您几乎回答了自己的问题，但要知道的重要一点是，您永远不能信任视图，尽管这是向用户提供反馈的最简单途径，因此您需要至少在一个级别上进行清理。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-08-09T21:19:35.730

嗯，不确定。在我读到这篇文章之前，我会说控制器：瘦控制器，胖模型

[http://blog.atrumfutura.com/archives/373-The-M-in-MVC-Why-Models-are-Misunderstood-and-Unappreciated.html](http://blog.astrumfutura.com/archives/373-The-M-in-MVC-Why-Models-are-Misunderstood-and-Unappreciated.html)

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-08-09T21:29:30.920

由于大多数验证依赖于*业务规则*，因此我在*业务层*上作为第三方工具类进行验证。还有其他类型的验证，例如用户输入，而它需要在控制器中进行，但您也可以将这些验证规则封装在第三方类中。实际上，这取决于要验证的内容。

客户端验证是次要的，只是为了构建一个轻量级的*输入验证*，但*始终需要*服务器端验证。你永远不能相信用户输入；）

**.NET**有很好的控件来构建验证，但*业务层*总是需要更好的方法来验证数据，而这些控件不足以完成这项任务。

* * *

## 回答 #10

> 赞同：-1
> 
> 时间：2009-09-16T15:27:04.417

视图中的简单输入验证。模型中的完全验证。原因？如果您更改视图技术，并且验证在视图/控制器中，则必须为新视图重写验证。这可能会引入错误。把它放在模型中，所有视图都会重用它......

但是，正如我所说，视图中的简单验证是为了速度和易用性。

# php - 如何在 PHP 中一起添加货币字符串（非标准化输入）？

> ID：134392
> 
> 赞同：2
> 
> 时间：2008-09-25T16:36:04.627
> 
> 标签：php

我有一个表格，人们将在其中输入美元价值。

可能的输入：
$999,999,999.99
999,999,999.99
999999999
99,999
$99,999

用户可以随意输入美元值。我想将输入读取为双精度数，以便将它们加起来。

我尝试将字符串类型转换为双精度，但这没有用。输出时 Total 刚好等于 50：

```
$string1 = "$50,000";
$string2 = "$50000";
$string3 = "50,000";
$total = (double)$string1 + (double)$string2 + (double)$string3;
echo $total; 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-09-25T16:47:37.597

正则表达式不会将您的字符串转换为数字。我建议您使用正则表达式来验证该字段（确认它符合您允许的格式之一），然后只循环字符串，丢弃所有非数字和非句点字符。如果您不关心验证，则可以跳过第一步。第二步仍将其仅剥离为数字和句点。

顺便说一句，在计算货币价值时，您不能安全地使用浮点数。您将失去精度，并且很可能最终得到与输入不完全匹配的总数。

更新：这里有两个函数可用于验证输入并将其转换为小数点表示。

```
function validateCurrency($string)
{
    return preg_match('/^\$?(\d{1,3})(,\d{3})*(.\d{2})?$/', $string) ||
           preg_match('/^\$?\d+(.\d{2})?$/', $string);
}

function makeCurrency($string)
{
    $newstring = "";

    $array = str_split($string);
    foreach($array as $char)
    {
        if (($char >= '0' && $char <= '9') || $char == '.')
        {
            $newstring .= $char;
        }
    }

    return $newstring;
} 
```

第一个函数将匹配您可以预期的大部分货币格式“$99”、“99,999.00”等。它不会匹配“.00”或“99.”，也不会匹配大多数欧式数字（99.999,00 ）。在您的原始字符串上使用它来验证它是否是有效的货币字符串。

第二个函数将删除除数字和小数点之外的所有内容。请注意，它本身仍可能返回无效字符串（例如，“”、“....”和“abc”以“”、“....”和“”的形式出现）。一旦字符串被验证，使用它来消除多余的逗号，或者如果你想跳过验证，可以单独使用它。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-09-25T17:59:09.233

您永远不想将货币价值表示为浮点数！

例如，采用以下（看似直截了当的）代码：

```
$x = 1.0;
for ($ii=0; $ii < 10; $ii++) {
  $x = $x - .1;
}
var_dump($x); 
```

您可能会假设它会产生零值，但事实并非如此。由于`$x`是一个浮点数，它实际上最终会比零多一点（1.38777878078E-16），这本身并不是什么大问题，但这意味着不能保证将该值与另一个值进行比较正确的。例如`$x == 0`会产生假。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-25T16:37:31.597

[http://p2p.wrox.com/topic.asp?TOPIC_ID=3099](http://p2p.wrox.com/topic.asp?TOPIC_ID=3099)

一步一步地经历它

[编辑] 典型...该网站现在似乎已关闭... :(

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-25T16:46:49.330

不是一个衬里，但如果你去掉'，你可以这样做：（这是伪代码）

```
 m/^\$?(\d+)(?:\.(\d\d))?$/
 $value = $1 + $2/100; 
```

这允许 9.99 美元，但不允许 9 美元。或 9.9 美元并且没有抱怨错放的千位分隔符（错误或功能？）

这里有一个潜在的“局部性”问题，因为您假设成千上万的人使用“，”和美分作为“。” 但在欧洲则相反（例如 1.000,99）

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-09-25T16:48:05.567

我建议不要使用浮点数来存储货币值。如果总和变大，您可能会出现舍入错误。（好的，如果它变得**非常**大。）

最好使用范围足够大的整数变量，并将输入存储为美分，而不是美元。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-09-25T16:49:11.633

我相信你可以用 printf 来完成这个，它类似于同名的 c 函数。它的参数可能有点深奥。你也可以使用 php 的[number_format](http://us3.php.net/manual/en/function.number-format.php)函数

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-09-25T18:46:55.907

假设您获得的是真实货币价值，您可以简单地去除不是数字或小数点的字符：

```
(pseudocode) 
newnumber = replace(oldnumber, /[^0-9.]/, //) 
```

现在您可以使用类似的东西进行转换

```
double(newnumber) 
```

但是，这不会处理诸如“5.6.3”之类的字符串和其他此类非货币字符串。这就提出了一个问题，“你需要处理格式错误的字符串吗？”

# c# - C#/.net ActiveDirectory 资源

> ID：134399
> 
> 赞同：2
> 
> 时间：2008-09-25T16:37:25.047
> 
> 标签：c#, .net, active-directory

我最近承担了一个应用程序的维护工作，该应用程序执行许多与 ActiveDirectory 相关的任务，包括查询和更新。

当然，我有现有的代码要查看，但我也很好奇是否有人有通过 C# 和 .Net 进行 AD 操作的任何好的链接，或者指向我可以说服老板购买的任何好书的指针。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-09-25T16:40:54.850

[Linq 到 Active Directory](http://www.codeplex.com/LINQtoAD)，宝贝。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-09-25T16:43:53.847

一个很好的参考：[Howto: (Almost) Everything In Active Directory via C#](http://www.codeproject.com/KB/system/everythingInAD.aspx)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-25T16:39:58.237

当我开始时，我发现[本教程很有帮助。](http://geekswithblogs.net/mhamilton/archive/2005/09/30/55621.aspx)

# blackberry - 有没有人尝试过为 Blackberry 平台使用 C 或 C++ 进行开发？

> ID：134408
> 
> 赞同：7
> 
> 时间：2008-09-25T16:38:24.280
> 
> 标签：blackberry, native

根据我在嵌入式计算方面的经验，我的每一个迹象都表明，做这样的事情需要昂贵的设备才能访问平台（ICE 调试器、JTAG 探针、I2C 编程器等），但我一直想知道是否一些野心勃勃的黑客找到了一种在黑莓设备上加载本机代码的方法。任何人？

编辑：我知道已发布的 SDK 及其附带的限制。我很好奇是否有人试图绕过他们，如果有，他们走了多远。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2008-09-29T02:37:51.213

随着时间的推移，我已经在许多不同的论坛中看到了这个问题。最初的黑莓在 C++ 中是可编程的，但我认为 RIM 遇到了试图在 C/C++ 编译为本机范例中实现安全平台的问题。

这些设备确实有 JTAG 端口，但除非可以将 RIM 代码作为开始的地方，否则问题将是巨大的。

我还想知道带有替代 FOSS 操作系统的 Blackberry 会有多大用处，因为它不可能有连接到 BES 或 BIS、发送 PIN 等的协议。如果你只是在寻找手持的力量计算平台 我怀疑有更多可能的候选者可用。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-11-20T23:34:43.910

不，C++ 不再是受支持的 RIM 开发工具，因为他们在几年前就将其淘汰了。客户端应用程序可以使用 Java（或少数 5GL 框架之一）开发，Web + 服务器端应用程序可以使用标准工具开发。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-05-04T21:22:23.230

对于那些寻找更新信息的人来说，新的 Playbook 操作系统，也称为 QNX，也称为 Blackberry 10（或者它将在运行它的手机出现时）实际上是基于 c/c++，也使用 QML 和 C++ 添加上称为级联。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-09-25T19:52:39.447

不幸的是，官方[SDK 网站](http://na.blackberry.com/eng/developers/)似乎只提到了 Java。根据[维基百科](http://en.wikipedia.org/wiki/BlackBerry#CPU)，不同版本的黑莓使用不同的处理器。再加上 RIM 为设备使用专有操作系统这一事实，在没有官方工具的情况下开发本机代码变得非常困难。还有一个部分 API 级别的安全限制，将进一步禁止高级修补。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2011-05-21T03:12:40.977

只是随机搜索这个问题的答案并遇到了[http://supportforums.blackberry.com/t5/Tablet-OS-SDK-for-Adobe-AIR/Native-CC-SDK/td-p/778009](http://supportforums.blackberry.com/t5/Tablet-OS-SDK-for-Adobe-AIR/Native-C-C-SDK/td-p/778009)其中提到 BB计划近期发布 C/C++ SDK，更多细节将在 2011 游戏开发者大会上提供。

# java - 如何在 Struts 2 中提交多个模型？

> ID：134424
> 
> 赞同：1
> 
> 时间：2008-09-25T16:40:43.073
> 
> 标签：java, jsp, struts

我有一个 JSP，它允许用户动态创建额外的表单字段来创建多个对象。也许我想让用户在提交发票表单时能够提交任意数量的行项目。

如何创建一个 Struts 2 Action，它能够接收`ArrayList`从这些动态生成的字段创建的对象。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-09-25T23:04:27.830

您应该阅读[表格输入指南](http://struts.apache.org/2.x/docs/tabular-inputs.html)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-25T23:08:59.910

[根据 (ever-poor) 文档](https://struts.apache.org/core-developers/type-conversion.html#indexing-a-collection-by-a-property-of-that-collection)，这迫使您尝试推断您想要的信息，而不仅仅是权威地告诉您（并假设您真的在询问 Struts 的内置类型转换），您的表单字段将需要命名为...

```
someList.makeNew(0).someField1
someList.makeNew(0).someField2
...
someList.makeNew(1).someField1
someList.makeNew(1).someField1
... 
```

...然后您需要[设置一个 ActionClassName-conversion.properties 文件](https://struts.apache.org/core-developers/type-conversion.html)，让类型转换器知道如何处理以 . 开头的字段的类型转换`someList`。

我自己唯一一次真正尝试过这个，我很难让它与`List`s 一起工作，最终不得不使用`Map`s。

[这是一篇关于使用类型转换](http://www.vitarara.org/cms/struts_2_cookbook/updating_a_list_of_domain_entities)[修改`Map`](http://www.vitarara.org/cms/struts_2_cookbook/updating_a_list_of_domain_entities)对象的有用博客条目- 我没有太多运气找到有关`makeNew`文档提到的字段名称格式的有用信息，但这可能会帮助您入门。

# asp.net - 元标记的移动能力渲染 en ASP.NET Mobile

> ID：134442
> 
> 赞同：2
> 
> 时间：2008-09-25T16:44:37.137
> 
> 标签：asp.net, mobile, mobile-website, wurfl

任何人都知道为每个适配器呈现元标记的移动功能是什么？

我正在使用 Marg.Wurfl 来检测移动设备，它将 wurfl 功能映射到移动功能，但它不呈现元标记。我在 ASP.NET 移动控件 XHTML 适配器源中找到了**requiresXhtmlCssSuppression**功能，但它不起作用我。

提前谢谢，

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-09-26T15:52:09.723

在大量使用[Reflector](http://reflector.red-gate.com/)之后，我发现 Wml、Chtml 和 Html (Mobile) 控件适配器使用：RequiredMetaTagNameValue、RequiresContentTypeMetaTag 和 PreferredRenderingMime 功能来呈现元标记，您可以在 *FormAdapter 的 RenderExtraHeadElements 函数中看到它们（不在 *PageAdapter、WTF 中） ）。但是 Xhtml 控件适配器（[源代码](http://www.microsoft.com/downloadS/details.aspx?FamilyID=9642963f-7c8d-4b26-a440-400e03ced4cb&displaylang=en)）不呈现元标记。我会创建一个。

以前，我认为问题是功能映射，但现在我认为这是 XhtmlPageAdapter 渲染问题。

更多信息？

# ide - 学习 Smalltalk 的最佳免费 IDE 是什么？

> ID：134452
> 
> 赞同：26
> 
> 时间：2008-09-25T16:46:14.917
> 
> 标签：ide, smalltalk

您认为学习 SmallTalk 的好 IDE 是什么？我只会将它用作一种爱好，所以它必须是免费的。

* * *

## 回答 #1

> 赞同：30
> 
> 时间：2009-02-07T18:28:46.890

您还应该考虑[Pharo](http://pharo-project.org/home)。Pharo 是 Squeak 的一个分支。他们的目标是：

*   一个干净、精益的开源 Smalltalk 平台，源自 Squeak

*   专业 Smalltalk 开发的明显选择

*   一个帮助人们创造未来的新兴平台

无论是 Squeak 还是 Pharo，都有一个庞大、活跃和支持的社区。

* * *

## 回答 #2

> 赞同：22
> 
> 时间：2008-09-25T16:51:53.827

我认为[Squeak](http://www.squeak.org/)是要走的路。它有一个完整的 smalltalk 环境，并且会不断更新。它是我用来学习的东西，实际上它本身就是一个很酷的应用程序。

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2008-09-29T22:24:41.237

吱吱声是免费的。Cincom 有一个非商业版本的 VisualWorks。GemStone/S 可免费用于小型安装。GNU Smalltalk 在 GPL 意义上是“免费的”。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2008-10-01T13:39:59.373

绝对去Squeak。就环境而言，它是一个封闭的系统，或者你所说的 IDE，但是用它来做 webapps 很有趣 - 寻找 Seaside。然而，我总是建议参与开发的每个人都看看它，只是为了了解图像中的开发是如何工作的 - 并体验一个实时系统。

Squeak 或 Smalltalk 的主要问题在于，一旦你习惯了它，就很难回到传统的编程方式。

此外，我听说如果你在 Smalltalk 工作一段时间，你可能会成为一个更好的程序员。我不知道这是不是真的，但我当然喜欢这样想。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2008-09-25T16:50:09.493

[吱吱声](http://www.squeak.org/)很好，很自由，很酷

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2008-09-25T17:14:32.117

您还可以使用[Cincom Smalltalk](http://www.cincomsmalltalk.com/userblogs/cincom/blogView?content=smalltalk)或[Dolphin Smalltalk](http://www.object-arts.com/content/navigation/products/dce.html)。他们都有社区版。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-02-11T23:48:39.177

如果您从[Cincom Smalltalk](http://www.cincomsmalltalk.com/userblogs/cincom/blogView?content=smalltalk)开始，则有大量可用的学习材料：

--[教程](http://www.cincomsmalltalk.com/userblogs/cincom/blogView?content=tutorials) --[每日截屏视频](http://smalltalk-daily.cincomsmalltalk.com) --[视频](http://www.cincomsmalltalk.com/userblogs/cincom/blogView?content=smalltalk_videos) --[每周播客](http://industry-misinterpretations.cincomsmalltalk.com)

您可以在 iTunes 上找到截屏视频、视频和播客 - 只需在播客部分搜索“Smalltalk”。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2009-03-15T20:29:19.360

您不需要单独的 IDE，因为 smalltalks 通常带有自己的 IDE，因此选择您的 smalltalk 风格几乎决定了适合您的 IDE。不过，不要让这个事实吓跑您使用 smalltalk！

[WRT 你最初的问题，我在Dolphin Smalltalk](http://en.wikipedia.org/wiki/Dolphin_Smalltalk)中度过了美好的两年，强烈推荐它。

Dolphin Smalltalk 就像啤酒一样免费。如果您需要开源的 smalltalk，请使用[Squeak](http://en.wikipedia.org/wiki/Squeak)。

在我看来，Dolphin 是更精致/舒适/用户友好的一款。

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2009-06-11T11:07:17.347

如果您习惯于 Eclipse 或 Visual Studio，并且在 Windows 上运行 - 那么[Dolphin](http://www.object-arts.com/content/navigation/products/dce.html)对您来说会非常熟悉。它看起来非常漂亮（没有模拟的小部件，因为它不是跨平台的），并且它有很好的触感，比如代码完成和图形窗口设计器（很像 mac 上的 IB）。它还具有出色的重构工具，可以轻松创建小型 .exe 文件（例如 500k，包括 vm）。有一个[在 Dolphin 中做 TDD的小截屏视频](http://www.planningcards.com/Thoughts/SMock%20and%20TDD%20in%20action.htm "海豚中的 TDD")

当然，这些东西在其他方言中也是可用的——特别是 Squeak Pharo 看起来很有前途，特别是如果你在追求开源产品。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2008-09-25T16:47:20.687

[Smalltalk/X](http://www.exept.de/en/products/smalltalk-x/stx-overview)前几天出现在 Reddit 上。它看起来很不错。

# php - 日志/图表 PHP 执行时间

> ID：134453
> 
> 赞同：3
> 
> 时间：2008-09-25T16:46:20.267
> 
> 标签：php, metrics

是否有任何工具可用于记录 php 站点的页面加载时间？

主要是寻找我可以看到加载时间随时间变化的趋势，我正在考虑使用 error_log() 将它们转储到文件中，但我不知道我可以用什么来解析它并显示图表

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-09-25T16:54:20.077

您可以在执行开始时记录微时间，保持该变量直到结束，检查时间，减去它们，然后您就有了执行时间。在大多数情况下，需要输出缓冲才能完成这项工作，除非它是特定事物总是最后运行的情况（如`footer()`）。

```
$time_start = microtime_float();

function microtime_float() {
   list($usec, $sec) = explode(" ", microtime());
   return ((float)$usec + (float)$sec);
}

//at the start. 

//at the end:

$time_end = microtime_float();
$time = round($time_end - $time_start, 4);

echo "Last uncached content render took $time seconds"; 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-09-25T16:53:04.167

使用 Firefox 的 Firebug 扩展，它有一个显示加载时间的网络面板。

如果您想进行负载测试，apache 附带了一个名为 apache bench 的实用程序，请在您附近的控制台窗口中尝试 ab --help。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-25T17:31:26.663

请参阅[PEAR 基准](http://pear.php.net/package/Benchmark/)。它允许您在代码中添加基准。您可以让它在您的页面上转储一个 HTML 表格，或者您可以遍历数据并写入日志文件。

# sql - 使用 LIKE 'string' vs = 'string' 对 Oracle 的性能有何影响？

> ID：134456
> 
> 赞同：17
> 
> 时间：2008-09-25T16:46:35.850
> 
> 标签：sql, performance, oracle

这

```
SELECT * FROM SOME_TABLE WHERE SOME_FIELD LIKE '%some_value%'; 
```

比这慢

```
SELECT * FROM SOME_TABLE WHERE SOME_FIELD = 'some_value'; 
```

但是这个呢？

```
SELECT * FROM SOME_TABLE WHERE SOME_FIELD LIKE 'some_value'; 
```

我的测试表明第二个和第三个示例完全相同。如果这是真的，我的问题是，为什么要使用 "=" ？

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2008-09-25T17:03:45.153

使用绑定变量时有一个明显的区别，您应该在 Oracle 中将其用于数据仓库或其他批量数据操作以外的任何事情。

举个例子：

```
SELECT * FROM SOME_TABLE WHERE SOME_FIELD LIKE :b1 
```

Oracle 在执行之前无法知道 :b1 的值是 '%some_value%' 或 'some_value' 等，因此它将基于启发式方法估计结果的基数并提出一个适当的计划可能适合也可能不适合 :b 的各种值，例如 '%A'、'%'、'A' 等。

类似的问题也适用于等式谓词，但可能导致的基数范围更容易根据列统计信息或唯一约束的存在来估计。

所以，就我个人而言，我不会开始使用 LIKE 作为 = 的替代品。优化器有时很容易被愚弄。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-09-25T16:48:13.727

查看两者的解释[计划](http://www.adp-gmbh.ch/ora/explainplan.html)。它们生成相同的执行计划，因此对于数据库来说，它们是相同的东西。

您将使用 = 来测试相等性，而不是相似性。如果您也在控制比较值，那么它并没有太大的区别。如果那是由用户提交的，那么 'apple' 和 'apple%' 会给你很多不同的结果。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-09-25T17:11:37.600

> 如果这是真的，我的问题是，为什么要使用 "=" ？

一个更好的问题：如果这是真的，为什么要使用“LIKE”来测试相等性？你可以省去按 shift 键，每个阅读脚本的人都会感到困惑。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-09-25T16:58:23.343

你试过了吗？测试是唯一确定的方法。

顺便说一句，这些语句都不能确定返回相同的行。试用：

```
insert into some_table (some_field) values ('some_value');
insert into some_table (some_fieled) values ('1some_value2');
insert into some_table (some_field) values ('some1value');

SELECT * FROM SOME_TABLE WHERE SOME_FIELD LIKE '%some_value%';

SELECT * FROM SOME_TABLE WHERE SOME_FIELD = 'some_value';

SELECT * FROM SOME_TABLE WHERE SOME_FIELD LIKE 'some_value'; 
```

就清晰度和避免细微的错误而言，最好不要使用**LIKE**，除非您需要它的通配符功能。（显然，在进行临时查询时，它可能没问题。）

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-09-25T16:59:41.263

LIKE '%WHATEVER%' 必须进行全索引扫描。

如果没有百分比，那么它就像一个等于。

如果 % 在一端，则索引可以是范围扫描。

我不确定优化器如何处理绑定字段。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-09-25T17:30:36.540

`like`如果您没有像`$%`etc 这样的字符，则形式上是相同的，因此发现它具有相同的成本也就不足为奇了。

我发现 David Aldridge 的回答很有趣，因为您的应用程序应该使用绑定变量。使用 a`like '%foobar'`您不能在索引中使用排序。如果查询是预编译的，会导致更多的索引或表全扫描。

此外，我发现它很危险，因为它可能导致 SQL 注入和奇怪的错误（例如，如果有一个名为 john 的用户，黑客可以创建一个名为的用户`'joh$'`并尝试登录）

为什么要冒险？`'='`更清晰，没有这些问题。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2018-10-25T11:00:50.697

1) % 和 = 旨在用于不同的场景。尽管我们可以在 like 子句中使用精确值进行搜索并获得所需的结果，但在所有此类情况下仍应使用 =。因此，每当我们有确切的值要搜索时，我们总是应该使用 =。

2) 当搜索子句中没有提供 % 时，like 和 = 的性能：在所有这些情况下，查询优化器会自动将 like cluase 转换为 =。从查询计划中可以看出这一点（请参阅随附的屏幕截图）。因此，在这种情况下，性能应该完全相同。感谢查询优化器！

我提供了这两个查询的执行计划的屏幕截图，即使用like 子句但没有% 的查询以及使用like 子句和% 的查询。

[![像带有 % 查询执行计划的子句](https://i.stack.imgur.com/goXca.png)](https://i.stack.imgur.com/goXca.png)

[![没有%查询执行计划的like子句](https://i.stack.imgur.com/FPR7f.png)](https://i.stack.imgur.com/FPR7f.png)

# c - 将全局重构为本地。它们应该是静态的吗？

> ID：134459
> 
> 赞同：2
> 
> 时间：2008-09-25T16:46:58.580
> 
> 标签：c, refactoring, static, global-variables, rtos

我正在重构“意大利面条代码”C 模块以在多任务 (RTOS) 环境中工作。

现在，有很长的函数和许多不必要的全局变量。

当我尝试用局部变量替换仅存在于一个函数中的全局变量时，我陷入了困境。每个全局变量都表现得像本地“静态” - 例如，即使您退出并重新进入函数，也保持其值。

对于多任务处理，“静态”本地变量是全局变量中最差的。它们使函数不再重新输入。

有一种方法可以检查函数是否在保留变量值重新进入而不跟踪所有逻辑流的情况下进行中继？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-09-25T16:57:34.203

简短的回答：不，没有任何方法可以根据局部变量的声明是否为静态来自动判断函数的行为是否不同。您只需检查在原始代码中使用全局变量的每个函数的逻辑。

但是，如果用静态局部范围变量替换全局变量意味着该函数不是可重入的，那么当它是全局时它也不是可重入的。因此，我认为将全局变量更改为静态局部范围变量不会使您的函数比开始时的可重入性更少。

如果全局确实仅在该范围内使用（当您删除全局时编译器/链接器应确认），则行为应该接近相同。初始化时可能会或可能不会出现问题，我不记得标准是怎么说的：如果静态初始化在 C 中与在 C++ 中发生的时间相同，那么当执行第一次到达声明时，您可能已经更改了并发安全函数变成了非并发安全函数。

确定一个函数是否可以安全地重入还需要查看逻辑。除非标准另有说明（我没有检查过），否则函数不会仅仅因为它声明一个静态变量而自动不可重入。但是，如果它以任何重要的方式使用全局或静态，您可以假设它是不可重入的。如果没有同步，那么假设它也是非并发安全的。

最后，祝你好运。听起来这段代码离你想要的地方还有很长的路要走......

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-26T06:33:19.140

如果你的全局变量真的只用在一个函数中，那么将它们变成静态局部变量不会有任何损失，因为它们无论如何都是全局的，这使得使用它们的函数不可重入。通过限制变量的范围，您会有所收获。

您应该对仅在一个函数中使用的所有全局变量进行更改，**然后**检查每个静态局部变量以查看是否可以将其设为非静态（自动）。

规则是：如果变量在设置之前在函数中使用，则保持静态。

可以自动本地化的变量示例（您可以将“ `int nplus4;`”放在函数内（您不需要将其设置为零，因为它是在使用前设置的，如果您在设置它之前实际使用它，这应该会发出警告，一个有用的检查）：

```
int nplus4 = 0;         // used only in add5
int add5 (int n) {
    nplus4 = n + 4;     // set
    return nplus4 + 1;  // use
} 
```

var在`nplus4`使用之前设置。以下是一个应该通过`static int nextn = 0;`在函数中放置“”来保持静态的示例：

```
int nextn = 0;             // used only in getn
int getn (void) {
    int n = nextn++;       // use, then use, then set
    return n;
} 
```

请注意，它可能会变得棘手，“ `nextn++`”不是设置，而是使用和设置，因为它等效于“ `nextn = nextn + 1`”。

另一件需要注意的事情：在 RTOS 环境中，堆栈空间可能比全局内存更有限，因此在将大的全局变量（例如“ `char buffer[10000]`”）移动到函数中时要小心。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-25T17:01:51.587

如果您的编译器在初始化之前使用变量时会警告您，请使可疑变量成为本地变量，而不在其声明中为其分配值。

如果不更改其他代码，任何发出警告的变量都不能成为本地变量。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-09-25T17:14:30.497

将全局变量更改为静态局部变量会有所帮助，因为修改的范围已经缩小。但是，并发问题仍然是一个问题，您必须通过锁定访问这些静态变量来解决它。

但是你想要做的是将变量的定义推入它用作本地的最高范围，然后将它作为参数传递给任何需要它的东西。这显然需要大量工作（因为它具有级联效应）。您可以将类似需要的变量分组到“上下文”对象中，然后将它们传递出去。

请参阅设计模式[封装上下文](http://accu.org/index.php/journals/246)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-09-25T16:57:17.527

请举例说明您所谓的“全局”和“局部”变量

```
int global_c; // can be used by any other file with 'extern int global_c;'

static int static_c; // cannot be seen or used outside of this file.

int foo(...)
{
   int local_c; // cannot be seen or used outside of this function.
} 
```

如果您提供一些代码示例，说明您拥有的内容和更改的内容，我们可以更好地回答这个问题。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-09-25T17:05:41.563

如果我正确理解您的问题，您担心的是全局变量从一个函数调用到下一个函数调用保留其值。显然，当您转而使用普通的局部变量时，情况并非如此。如果您想知道更改它们是否安全，我认为您除了阅读和理解代码之外别无选择。简单地对相关变量的名称进行全文搜索可能是有益的。

如果你想要一个不完全安全的快速而肮脏的解决方案，你可以改变它，看看有什么问题。我建议确保你有一个可以在源代码控制中回滚的版本，并提前设置一些单元测试。

# delphi - Delphi 弹出菜单检查

> ID：134463
> 
> 赞同：6
> 
> 时间：2008-09-25T16:47:27.487
> 
> 标签：delphi

我在 Delphi 中使用弹出菜单。我想以“无线电组”方式使用它，如果用户选择一个项目，它会被选中，而其他项目不会被选中。我尝试使用 AutoCheck 属性，但这允许检查多个项目。有没有办法设置弹出菜单，以便只能检查一个项目？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2008-09-25T17:12:16.383

要将弹出（或任何其他）菜单项视为单选组项目，请将您希望在单选组中的每个项目的“RadioItem”属性设置为 true。

它不会显示复选标记，而是显示所选项目的项目符号，但它会按照您想要的方式工作，并且视觉提示实际上将匹配 Windows 标准。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-09-25T17:07:07.860

Zartog 是对的，但如果您想保留复选框，请将此事件分配给弹出菜单中的每个项目。

请注意，此代码看起来有点毛茸茸，因为它不依赖于知道弹出菜单的名称（因此，使用“GetParentComponent”查找它）。

```
procedure TForm2.OnPopupItemClick(Sender: TObject);
var
  i : integer;
begin
  with (Sender as TMenuItem) do begin
    //if they just checked something...
    if Checked then begin
      //go through the list and *un* check everything *else*
      for i := 0 to (GetParentComponent as TPopupMenu).Items.Count - 1 do begin
        if i <> MenuIndex then begin  //don't uncheck the one they just clicked!
          (GetParentComponent as TPopupMenu).Items[i].Checked := False;
        end;  //if not the one they just clicked
      end;  //for each item in the popup
    end;  //if we checked something
  end;  //with
end; 
```

您可以在运行时将事件分配给表单上的每个弹出框，如下所示（如果您想这样做）：

```
procedure TForm2.FormCreate(Sender: TObject);
var
  i,j: integer;
begin
  inherited;

  //look for any popup menus, and assign our custom checkbox handler to them
  if Sender is TForm then begin
    with (Sender as TForm) do begin
      for i := 0 to ComponentCount - 1 do begin
        if (Components[i] is TPopupMenu) then begin
          for j := 0 to (Components[i] as TPopupMenu).Items.Count - 1 do begin
            (Components[i] as TPopupMenu).Items[j].OnClick := OnPopupItemClick;
          end;  //for every item in the popup list we found
        end;  //if we found a popup list
      end;  //for every component on the form
    end;  //with the form
  end;  //if we are looking at a form
end; 
```

回应此答案下方的评论：如果您想要求至少检查一个项目，请使用它而不是第一个代码块。您可能希望在 oncreate 事件中设置默认选中项。

```
procedure TForm2.OnPopupItemClick(Sender: TObject);
var
  i : integer;
begin
  with (Sender as TMenuItem) do begin
    //go through the list and make sure *only* the clicked item is checked
    for i := 0 to (GetParentComponent as TPopupMenu).Items.Count - 1 do begin
      (GetParentComponent as TPopupMenu).Items[i].Checked := (i = MenuIndex);
    end;  //for each item in the popup
  end;  //with
end; 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-09-26T05:34:07.597

要放大 Zartog 的帖子： Delphi 中的弹出菜单（至少从 D6 开始）有一个 GroupIndex 属性，它允许您在一个菜单中拥有多组单选项目。将第一组的 GroupIndex 设置为 1，第二组设置为 2，以此类推。

所以：设置 AutoCheck = True Set RadioItem = True Set GroupIndex 如果您需要一组以上的单选项目

# cakephp - 在 CakePHP 中将控制器父类放在哪里？

> ID：134470
> 
> 赞同：4
> 
> 时间：2008-09-25T16:48:04.757
> 
> 标签：cakephp

我有两个共享大部分代码的控制器（但必须是不同的控制器）。显而易见的解决方案（至少对我而言）是创建一个类，并让两个控制器从它继承。问题是……放在哪里？现在我在 app_controller.php 中有它，但是那里有点乱。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2008-09-25T16:54:37.750

在 cake 中，组件用于存储可供多个控制器使用的逻辑。该目录是/app/controllers/components。例如，如果您有一些可共享的实用程序逻辑，您将有一个名为 UtilComponent 的对象和一个名为 UtilComponent.php 的 /app/controlers/components 文件。

```
<?php
class UtilComponent extends Object {
    function yourMethod($param) {
        // logic here.......

        return $param;
    }
}
?> 
```

然后，在您的控制器类中，您将添加：

```
var $components = array('Util'); 
```

然后你调用如下方法：

```
$this->Util->yourMethod($yourparam); 
```

更多信息：

[文档](http://book.cakephp.org/view/315/Components)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-09-26T09:57:00.693

顺便说一句，如果“它们必须是单独的控制器”的原因是您需要的 URL。请记住，您可以使用路由：

```
Router::connect('/posts', array('controller' => 'posts', 'action' => 'index'));
Router::connect('/comments', array('controller' => 'posts', 'action' => 'list_comments')); 
```

# c# - 如何将参数传递给通过 Assembly.CreateInstance 加载的 C# 插件？

> ID：134481
> 
> 赞同：5
> 
> 时间：2008-09-25T16:50:42.783
> 
> 标签：c#, assemblies, arguments, createinstance

我现在拥有的（成功加载插件）是这样的：

```
Assembly myDLL = Assembly.LoadFrom("my.dll");
IMyClass myPluginObject = myDLL.CreateInstance("MyCorp.IMyClass") as IMyClass; 
```

这仅适用于具有不带参数的构造函数的类。如何将参数传递给构造函数？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2008-09-25T17:38:18.410

你不能。而是使用[Activator.CreateInstance](http://msdn.microsoft.com/en-us/library/wcxyzt4d.aspx)，如下例所示（请注意，客户端命名空间位于一个 DLL 中，而主机位于另一个 DLL 中。两者必须位于同一目录中才能使代码正常工作。）

但是，如果你想创建一个真正可插入的接口，我建议你使用一个 Initialize 方法，它在你的接口中接受给定的参数，而不是依赖于构造函数。这样，您可以只要求插件类实现您的接口，而不是“希望”它接受构造函数中接受的参数。

```
using System;
using Host;

namespace Client
{
    public class MyClass : IMyInterface
    {
        public int _id;
        public string _name;

        public MyClass(int id,
            string name)
        {
            _id = id;
            _name = name;
        }

        public string GetOutput()
        {
            return String.Format("{0} - {1}", _id, _name);
        }
    }
}

namespace Host
{
    public interface IMyInterface
    {
        string GetOutput();
    }
}

using System;
using System.Reflection;

namespace Host
{
    internal class Program
    {
        private static void Main()
        {
            //These two would be read in some configuration
            const string dllName = "Client.dll";
            const string className = "Client.MyClass";

            try
            {
                Assembly pluginAssembly = Assembly.LoadFrom(dllName);
                Type classType = pluginAssembly.GetType(className);

                var plugin = (IMyInterface) Activator.CreateInstance(classType,
                                                                     42, "Adams");

                if (plugin == null)
                    throw new ApplicationException("Plugin not correctly configured");

                Console.WriteLine(plugin.GetOutput());
            }
            catch (Exception e)
            {
                Console.Error.WriteLine(e.ToString());
            }
        }
    }
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-09-25T16:54:11.793

称呼

```
public object CreateInstance(string typeName, bool ignoreCase, BindingFlags bindingAttr, Binder binder, object[] args, CultureInfo culture, object[] activationAttributes) 
```

反而。 [MSDN 文档](http://msdn.microsoft.com/en-us/library/ck6xe688.aspx)

编辑：如果您要对此投反对票，请深入了解为什么这种方法是错误的/或不是最好的方法。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-09-25T16:51:15.857

您可以使用[Activator.CreateInstance](http://msdn.microsoft.com/en-us/library/wcxyzt4d.aspx)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-09-25T16:53:28.020

Activator.CreateInstance 接受一个 Type 和任何你想传递给 Types 构造函数的东西。

[http://msdn.microsoft.com/en-us/library/system.activator.createinstance.aspx](http://msdn.microsoft.com/en-us/library/system.activator.createinstance.aspx)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2010-06-17T03:15:03.403

您也可以不使用 Activator.CreateInstance，它可以执行得更好。请参阅下面的 StackOverflow 问题。

[如何在 Activator.CreateInstance 中传递 ctor args 或使用 IL？](https://stackoverflow.com/questions/2024435/how-to-pass-ctor-args-in-activator-createinstance)

# version-control - 具有共享库的多个项目/解决方案的源代码控制

> ID：134490
> 
> 赞同：1
> 
> 时间：2008-09-25T16:52:48.380
> 
> 标签：version-control, shared-libraries, repository-design

我目前正在开展一个项目，将许多 Excel VBA 驱动的工作簿转换为 VSTO 解决方案。所有的工作簿都会共享一些类库和第三方程序集，实际上大部分工作都是在类库中完成的。我目前的文件夹结构是这样布局的。

```
Base
    Libraries  
    Assemblies  
    Workbooks  
        Workbook1  
        Workbook2 
```

每个工作簿都是自己的解决方案，工作簿解决方案只是引用文件夹结构中的程序集。我的问题是您将如何布置源代码控制？你会在基地启动存储库吗？或者您会为每个工作簿解决方案创建一个存储库吗？你会重新排列文件夹吗？

现在我们已经完成了最初的开发，我们即将有一群外部开发人员加入到项目中来帮助我们转换其余的工作簿，我真的很喜欢他们能够从基础中签出的想法目录并准备好所有依赖项。我还担心在一个源代码控制存储库下拥有 20 多个解决方案/项目会带来其他问题。

对于加入该项目的人来说，我希望一切都尽可能简单，但我不想牺牲长期可用性。在我看来，我一直在来回走动，一个存储库或每个解决方案一个存储库更简单？

我会很感激你的见解和见解，因为我刚出来。

附加信息：目前，我个人使用的是 Mercurial，但该项目可能会转移到 StarTeam，除非我能为其他东西提出一些令人信服的论据。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-09-25T17:58:03.823

你没有在你的问题中提到你正在使用什么源代码控制。因为听起来您不需要限制外部开发人员访问存储库的其余部分，所以我不会费心设置多个存储库。我假设除非您的代码运行到数百万行大小，否则存储库大小不是问题。

这完全取决于您的版本控制系统支持什么功能。在 subversion 中，您可以将其他文件夹声明为外部文件夹并为该文件夹的内容提供文件 URL，这将导致 subversion 将该文件夹作为单独的存储库处理，即使它位于您的文件夹结构中。

# java - 如何将对象序列化为字符串

> ID：134492
> 
> 赞同：157
> 
> 时间：2008-09-25T16:53:07.363
> 
> 标签：java, serialization

我能够将一个对象序列化为一个文件，然后再次恢复它，如下一个代码片段所示。我想将对象序列化为字符串并存储到数据库中。谁能帮我？

```
LinkedList<Diff_match_patch.Patch> patches = // whatever...
FileOutputStream fileStream = new FileOutputStream("foo.ser");
ObjectOutputStream os = new ObjectOutputStream(fileStream);
os.writeObject(patches1);
os.close();

FileInputStream fileInputStream = new FileInputStream("foo.ser");
ObjectInputStream oInputStream = new ObjectInputStream(fileInputStream);
Object one = oInputStream.readObject();
LinkedList<Diff_match_patch.Patch> patches3 = (LinkedList<Diff_match_patch.Patch>) one;
os.close(); 
```

* * *

## 回答 #1

> 赞同：281
> 
> 时间：2008-09-25T18:03:38.973

塞尔吉奥：

你应该使用[BLOB](http://docs.oracle.com/javase/6/docs/api/java/sql/Blob.html)。使用 JDBC 非常简单。

您发布的第二个代码的问题是编码。您应该另外对字节进行编码以确保它们都不会失败。

如果您仍想将其写成字符串，您可以使用[java.util.Base64](https://docs.oracle.com/javase/8/docs/api/java/util/Base64.html)对字节进行编码。

您仍然应该使用 CLOB 作为数据类型，因为您不知道序列化数据将持续多长时间。

这是如何使用它的示例。

```
import java.util.*;
import java.io.*;

/** 
 * Usage sample serializing SomeClass instance 
 */
public class ToStringSample {

    public static void main( String [] args )  throws IOException,
                                                      ClassNotFoundException {
        String string = toString( new SomeClass() );
        System.out.println(" Encoded serialized version " );
        System.out.println( string );
        SomeClass some = ( SomeClass ) fromString( string );
        System.out.println( "\n\nReconstituted object");
        System.out.println( some );

    }

    /** Read the object from Base64 string. */
   private static Object fromString( String s ) throws IOException ,
                                                       ClassNotFoundException {
        byte [] data = Base64.getDecoder().decode( s );
        ObjectInputStream ois = new ObjectInputStream( 
                                        new ByteArrayInputStream(  data ) );
        Object o  = ois.readObject();
        ois.close();
        return o;
   }

    /** Write the object to a Base64 string. */
    private static String toString( Serializable o ) throws IOException {
        ByteArrayOutputStream baos = new ByteArrayOutputStream();
        ObjectOutputStream oos = new ObjectOutputStream( baos );
        oos.writeObject( o );
        oos.close();
        return Base64.getEncoder().encodeToString(baos.toByteArray()); 
    }
}

/** Test subject. A very simple class. */ 
class SomeClass implements Serializable {

    private final static long serialVersionUID = 1; // See Nick's comment below

    int i    = Integer.MAX_VALUE;
    String s = "ABCDEFGHIJKLMNOP";
    Double d = new Double( -1.0 );
    public String toString(){
        return  "SomeClass instance says: Don't worry, " 
              + "I'm healthy. Look, my data is i = " + i  
              + ", s = " + s + ", d = " + d;
    }
} 
```

输出：

```
C:\samples>javac *.java

C:\samples>java ToStringSample
Encoded serialized version
rO0ABXNyAAlTb21lQ2xhc3MAAAAAAAAAAQIAA0kAAWlMAAFkdAASTGphdmEvbGFuZy9Eb3VibGU7T
AABc3QAEkxqYXZhL2xhbmcvU3RyaW5nO3hwf////3NyABBqYXZhLmxhbmcuRG91YmxlgLPCSilr+w
QCAAFEAAV2YWx1ZXhyABBqYXZhLmxhbmcuTnVtYmVyhqyVHQuU4IsCAAB4cL/wAAAAAAAAdAAQQUJ
DREVGR0hJSktMTU5PUA==

Reconstituted object
SomeClass instance says: Don't worry, I'm healthy. Look, my data is i = 2147483647, s = ABCDEFGHIJKLMNOP, d = -1.0 
```

**注意**：对于 Java 7 及更早版本，您可以在此处查看原始[答案](https://stackoverflow.com/revisions/134918/9)

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2008-09-25T16:58:08.630

将数据写入 ByteArrayOutputStream 而不是 FileOutputStream 怎么样？

否则，您可以使用 XMLEncoder 序列化对象，持久化 XML，然后通过 XMLDecoder 反序列化。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2008-09-25T17:19:25.897

感谢您的快速回复。我将立即放弃一些投票以感谢您的帮助。我根据您的回答编写了我认为的最佳解决方案。

```
LinkedList<Patch> patches1 = diff.patch_make(text2, text1);
try {
    ByteArrayOutputStream bos = new ByteArrayOutputStream();
    ObjectOutputStream os = new ObjectOutputStream(bos);
    os.writeObject(patches1);
    String serialized_patches1 = bos.toString();
    os.close();

    ByteArrayInputStream bis = new ByteArrayInputStream(serialized_patches1.getBytes());
    ObjectInputStream oInputStream = new ObjectInputStream(bis);
    LinkedList<Patch> restored_patches1 = (LinkedList<Patch>) oInputStream.readObject();            

        // patches1 equals restored_patches1
    oInputStream.close();
} catch(Exception ex) {
    ex.printStackTrace();
} 
```

**请注意**，我没有考虑使用 JSON，因为效率较低。

**注意：**我会考虑您关于不在数据库中将序列化对象存储为字符串而是 byte[] 的建议。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2017-06-02T11:54:42.397

Java8 方法，将 Object 从/转换为 String，灵感来自[OscarRyz](https://stackoverflow.com/a/134918/1645517)的回答。对于解码/编码，需要并使用[java.util.Base64 。](https://docs.oracle.com/javase/8/docs/api/java/util/Base64.html "java.util.Base64")

```
import java.io.ByteArrayInputStream;
import java.io.ByteArrayOutputStream;
import java.io.IOException;
import java.io.ObjectInputStream;
import java.io.ObjectOutputStream;
import java.io.Serializable;
import java.util.Base64;
import java.util.Optional;

final class ObjectHelper {

  private ObjectHelper() {}

  static Optional<String> convertToString(final Serializable object) {
    try (final ByteArrayOutputStream baos = new ByteArrayOutputStream();
      ObjectOutputStream oos = new ObjectOutputStream(baos)) {
      oos.writeObject(object);
      return Optional.of(Base64.getEncoder().encodeToString(baos.toByteArray()));
    } catch (final IOException e) {
      e.printStackTrace();
      return Optional.empty();
    }
  }

  static <T extends Serializable> Optional<T> convertFrom(final String objectAsString) {
    final byte[] data = Base64.getDecoder().decode(objectAsString);
    try (final ObjectInputStream ois = new ObjectInputStream(new ByteArrayInputStream(data))) {
      return Optional.of((T) ois.readObject());
    } catch (final IOException | ClassNotFoundException e) {
      e.printStackTrace();
      return Optional.empty();
    }
  }
} 
```

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2008-09-25T17:01:01.807

如何将对象持久化为[blob](https://docs.oracle.com/javase/7/docs/api/java/sql/Blob.html)

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2008-09-25T19:57:15.270

XStream 提供了一个简单的实用程序，用于对 XML 进行序列化/反序列化，而且速度*非常*快。存储 XML CLOB 而不是二进制 BLOBS 将不那么脆弱，更不用说更具可读性了。

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2008-09-25T17:04:24.967

如果您将对象作为二进制数据存储在数据库中，那么您确实应该使用`BLOB`数据类型。数据库能够更有效地存储它，您不必担心编码等。JDBC 提供了根据流创建和检索 blob 的方法。如果可以，请使用 Java 6，它为 JDBC API 添加了一些内容，使处理 blob 变得更加容易。

如果您绝对需要将数据存储为字符串，我会推荐[XStream](http://xstream.codehaus.org/)用于基于 XML 的存储（比 更容易`XMLEncoder`），但替代对象表示可能同样有用（例如 JSON）。您的方法取决于为什么您实际上需要以这种方式存储对象。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2008-09-25T18:18:07.237

看一下 java.sql.PreparedStatement 类，具体是函数

[http://java.sun.com/javase/6/docs/api/java/sql/PreparedStatement.html#setBinaryStream(int,%20java.io.InputStream)](http://java.sun.com/javase/6/docs/api/java/sql/PreparedStatement.html#setBinaryStream(int,%20java.io.InputStream))

然后看一下java.sql.ResultSet类，具体是函数

[http://java.sun.com/javase/6/docs/api/java/sql/ResultSet.html#getBinaryStream(int)](http://java.sun.com/javase/6/docs/api/java/sql/ResultSet.html#getBinaryStream(int))

请记住，如果您将对象序列化到数据库中，然后在新版本中更改代码中的对象，则反序列化过程很容易失败，因为您的对象的签名已更改。我曾经在存储自定义首选项序列化然后更改首选项定义时犯了这个错误。突然间，我无法阅读任何以前的序列化信息。

您最好在表中编写笨重的每个属性列并以这种方式组合和分解对象，以避免对象版本和反序列化的这个问题。或者将属性写入某种哈希图中，例如 java.util.Properties 对象，然后序列化极不可能更改的属性对象。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2008-09-25T17:05:11.610

序列化的流只是一个字节序列（八位字节）。所以问题是如何将字节序列转换为字符串，然后再转换回来。此外，如果要将其存储在数据库中，则需要使用一组有限的字符代码。

该问题的明显解决方案是将字段更改为二进制 LOB。如果您想坚持使用字符 LOB，那么您需要以某种方案进行编码，例如 base64、hex 或 uu。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2008-09-25T18:38:18.577

您可以使用 sun.misc.Base64Decoder 和 sun.misc.Base64Encoder 类中的构建将序列化的二进制数据转换为字符串。你不需要额外的类，因为它是内置的。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2017-06-20T07:19:15.047

简单的解决方案，为我工作

```
public static byte[] serialize(Object obj) throws IOException {
    ByteArrayOutputStream out = new ByteArrayOutputStream();
    ObjectOutputStream os = new ObjectOutputStream(out);
    os.writeObject(obj);
    return out.toByteArray();
} 
```

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2008-09-25T17:03:06.670

你可以使用 UUEncoding

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2020-10-28T08:38:53.220

今天最明显的方法是将对象保存为 JSON。

1.  JSON 可读
2.  JSON 比 XML 更具可读性和更易于使用。
3.  许多允许直接存储 JSON 的非 SQL 数据库。
4.  您的客户端已经使用 JSON 与服务器通信。（如果没有，很可能是一个错误。）

[使用Gson](https://github.com/google/gson)的示例。

```
Gson gson = new Gson();
Person[] persons = getArrayOfPersons();
String json = gson.toJson(persons);
System.out.println(json);
//output: [{"name":"Tom","age":11},{"name":"Jack","age":12}]
Person[] personsFromJson = gson.fromJson(json, Person[].class);
//...
class Person {
     public String name;
     public int age;
} 
```

> Gson 允许直接转换 List。例子可以很容易地用谷歌搜索。我更喜欢先将列表转换为数组。

# xml - “有效的 xml”和“格式良好的 xml”之间有什么区别吗？

> ID：134494
> 
> 赞同：86
> 
> 时间：2008-09-25T16:53:08.847
> 
> 标签：xml, validation, xsd, dtd

我不知道有什么不同，但一位同事说有，尽管他无法支持。如果有，有什么区别？

* * *

## 回答 #1

> 赞同：84
> 
> 时间：2008-09-25T16:53:29.923

有区别，是的。

遵循[XML 标准](https://www.w3.org/XML/)的 XML被认为是格式良好的，而遵循[DTD](https://www.w3schools.com/xml/xml_dtd.asp)的 xml被认为是有效的。

* * *

## 回答 #2

> 赞同：37
> 
> 时间：2014-09-14T05:53:02.770

# 格式良好的与有效的 XML

***格式良好***意味着文本对象符合[W3C](http://www.w3.org/TR/REC-xml/)对[XML](http://www.w3.org/TR/REC-xml/#sec-well-formed)的要求。

***有效***意味着格式良好的 XML 满足指定模式给出的附加要求。

* * *

## 官方定义

根据[W3C 对 XML 的建议](http://www.w3.org/TR/REC-xml/)：

> [定义：数据对象是一个 XML 文档，如果它是 [**格式良好的**](http://www.w3.org/TR/REC-xml/#dt-wellformed)，如本规范中定义的那样。此外，如果 XML 文档满足某些进一步的约束，则它是[**有效的。]**](http://www.w3.org/TR/REC-xml/#dt-valid)

* * *

## 观察：

*   格式不正确的文档不是 XML。（*格式良好的 XML*很常用，但在技术上是多余的。）
*   有效意味着格式良好。
*   格式良好并不意味着有效。
*   尽管[W3C XML 推荐标准](http://www.w3.org/TR/xml/)定义了针对 DTD 的[有效性](http://www.w3.org/TR/xml/#dt-valid)，但传统用法允许将该术​​语应用于符合通过[XSD](http://www.w3.org/standards/xml/schema)、[RELAX NG](http://relaxng.org/)、[Schematron](http://www.schematron.com/)或其他方法指定的 XML 模式。

* * *

## 导致文档成为...的原因的示例

***格式不正确：***

*   一个元素缺少一个结束标签（并且不是自动关闭的）。
*   没有正确嵌套的元素重叠：`<a><b></a></b>`
*   属性值缺少与开始引号匹配的结束引号。
*   `<`or`&`用于内容而不是`&lt`or `&amp;`。
*   存在多个根元素。
*   存在多个 XML 声明，或者 XML 声明出现在文档顶部以外的位置。

***无效的***

*   缺少元素或属性，但 XML 模式需要。
*   元素或属性已使用但未由 XML 模式定义。
*   元素的内容与 XML 模式指定的内容不匹配。
*   属性的值与 XML 模式指定的类型不匹配。

* * *

## 命名空间格式良好

从技术上讲，XML 中的组件名称中允许使用冒号字符。但是，冒号[***只能***](https://www.w3.org/TR/REC-xml/#sec-common-syn)用于命名空间的名称中：

> **笔记：**
> 
> XML 建议中的命名空间 [ [XML 名称](https://www.w3.org/TR/REC-xml/#xml-names)] 为包含冒号字符的名称分配了含义。因此，作者不应在 XML 名称中使用冒号，除非是出于命名空间的目的，但 XML 处理器必须接受冒号作为名称字符。

因此，另一个术语[***namespace-well-formed***](https://www.w3.org/TR/xml-names/#Conformance)被定义在[Namespaces in XML 1.0 W3C Recommendation](https://www.w3.org/TR/xml-names/)中，它暗示了所有的 XML 格式良好的规则以及*那些*管理命名空间和命名空间前缀的规则。

通俗地说，*格式良好*的术语通常用于*命名空间格式*正确的地方。但是，这是一种次要的技术方式，其实际后果不如此答案中描述的**格式良好的 XML 与有效的 XML**之间的区别。

* * *

## 回答 #3

> 赞同：29
> 
> 时间：2008-09-25T16:54:58.093

有效 XML 是针对 DTD 成功验证的 XML。

格式良好的 XML 是所有标记都以正确顺序关闭的 XML，如果它有一个声明，它在文件中的第一件事就是具有正确的属性。

换句话说，有效性是指语义，格式良好是指语法。

所以你可以有无效的格式良好的 XML。

* * *

## 回答 #4

> 赞同：17
> 
> 时间：2008-09-25T17:04:51.237

正如其他人所说，格式良好的 XML 符合 XML 规范，有效的 XML 符合给定的模式。

另一种说法是，格式良好的 XML 在*词汇上*是正确的（可以被解析），而有效的 XML 在*语法*上是正确的（可以与已知的词汇和语法相匹配）。

XML 文档在格式正确之前是无效的。所有 XML 文档都遵循相同的格式标准（W3 提出的 RFC）。一个 XML 文档可以对某些模式有效，而对其他模式无效。有许多模式语言，其中许多本身是基于 XML 的。

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2008-09-25T17:04:27.320

格式良好的 XML 是符合语言语法要求的 XML。不遗漏任何结束标签，使用所有单例标签`<whatever />`而不是 just `<whatever>`，并且结束标签的顺序正确。

有效的 XML 是使用 DTD 并符合其所有要求的 XML。因此，如果您不正确地使用属性，就会违反 DTD 并且无效。

所有有效的 XML 都是格式正确的，但并非所有格式正确的 XML 都是有效的。

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2008-09-25T17:04:44.543

如果满足标准规定的所有 XML 文档的要求，则 XML 是格式良好的 - 因此诸如具有单个根节点、具有正确嵌套的节点、所有节点具有结束标记（或使用斜线的空节点速记之前）右尖括号），引用的属性等。格式正确仅意味着它遵守 XML 规则，因此可以正确解析。

如果 XML 将针对 DTD 或模式进行验证，那么它就是有效的。这显然因情况而异——对一种模式有效的 XML 对另一种模式无效，即使它仍然是格式良好的。

如果 XML 格式不正确，则无法正确解析 - 解析器只会抛出异常或报告错误。这是通用的，您的 XML 包含什么并不重要。只有在解析后才能检查其有效性。此域或上下文相关，并且需要一个 DTD 或模式来验证。对于简单的 XML 文档，您可能没有 DTD 或模式，在这种情况下，您无法知道 XML 是否有效——概念或有效性在这种情况下根本不适用。当然，这并不意味着你不能使用它，它只是意味着你无法判断它是否有效。

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2011-08-13T17:13:51.540

W3C 在 XML 规范中定义了创建 XML 文档时需要遵循的某些规则。此类规则的示例包括只有一个根元素，每个开始标签都有结束标签，属性值使用单/双引号等等。如果 XML 文档遵循所有这些规则，则称其为格式良好的文档，并且 XML 解析器可用于解析和处理此类文档。

文档类型定义 (DTD) 或 XML 模式可用于定义特定类 XML 文档的结构和内容。这包括父子关系详细信息、属性列表、数据类型信息、值限制等。除了格式良好的规则外，如果一个 XML 文档还遵循关联的 DTD/Schema 中指定的规则，则称为是一个有效的 XML 文档。

所有有效的 XML 文档都是格式良好的，但反过来并不总是正确的。格式良好的 XML 文档不一定是有效的。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2008-09-25T16:57:15.810

我要补充一点，有效的 XML 也意味着它是格式良好的，但格式良好的 XML 不一定是有效的。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2010-06-07T11:18:06.070

如果 XML 符合 DTD 规则，那么它就是一个有效的 XML。如果一个 XML 文档符合 XML 规则（所有开始的标签都是封闭的，有一个根元素等），那么它就是一个格式良好的 XML。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2013-12-12T15:47:17.437

摘自[可扩展标记语言 (XML) 1.0（第五版）- W3C 建议 2008 年 11 月 26 日](http://www.w3.org/TR/REC-xml/#sec-documents)：

> [定义：数据对象是一个 XML 文档，如果它是格式良好的，如本规范中定义的那样。此外，如果 XML 文档满足某些进一步的约束，则它是有效的。]

* * *

*对于那些喜欢伪代码而不是文本段落的人...... :)*

```
IF is_well_formed(<XML_doc>) THEN
    # It is well-formed, and can be parsed
    IF is_valid(<XML_doc>) THEN
        # Well-formed and ALSO valid. Hurray! 
        # **A valid XML doc, is a well-formed doc!**
    ELSE
        # Only well-formed, NOT valid
    END IF
ELSE
    # Not well-formed, or valid!
END IF

FUNCTION is_well_formed
    IF <does_not_contain_syntax,_spelling,_punctuation,_grammar_errors,_etc._errors> THEN
        RETURN TRUE
    ELSE 
        RETURN FALSE
    END IF
END FUNCTION 

FUNCTION is_valid
    IF <markup_of_the_XML_document_matches_"some"_defined_standard> THEN
        # Standards used to validate XML could be a DTDs or XML Schemas, referenced within the XML document
        RETURN TRUE
    ELSE 
        RETURN FALSE
    END IF
END FUNCTION 
```

基于理论：[“格式良好”与有效](https://www.ischool.utexas.edu/technology/tutorials/webdev/xml_dtds/04_xml.html)

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2008-09-25T16:55:38.700

好吧，根据定义，格式不正确的 XML 不是 XML。人们通常将有效的 XML 称为符合特定模式（XSD 或 DTD）的 XML。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2011-01-27T09:55:30.597

DTD 是文档类型定义的首字母缩写词。这是对一系列 XML 文件的内容的描述。这是 XML 1.0 规范的一部分，它允许描述和验证给定文档实例是否符合详细说明其结构和内容的一组规则。

验证是根据 DTD（更一般地说是根据一组构造规则）检查文档的过程。

验证过程和构建 DTD 是 XML 生命周期中最困难的两个部分。简而言之，DTD 定义了文档中所有可能的元素，文档树的正式形状是什么（通过定义元素的允许内容；文本、允许的子列表的正则表达式或混合内容即文本和儿童）。DTD 还定义了所有元素的有效属性以及这些属性的类型。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2018-05-16T12:25:01.640

请参阅[W3 学校的 XML DTD](https://www.w3schools.com/xml/xml_dtd.asp)：

> 具有正确语法的 XML 文档称为“格式良好”。
> 
> 针对 DTD 验证的 XML 文档既“格式正确”又“有效”。

# c - fork() 作为参数

> ID：134501
> 
> 赞同：4
> 
> 时间：2008-09-25T16:54:06.723
> 
> 标签：c, fork

通常当我需要在 C 中分叉时，我会这样做：

```
pid_t p = fork();
if(p == 0) { /* do child stuff */ }
else { /* do parent stuff and pray there wasn't an error */ } 
```

我突然想到我可以放弃额外的变量并使用：

```
if(fork() == 0) { /* child */ }
else { /* parent/pray */ } 
```

除了不正确的错误处理之外，（为什么）这工作/不工作？

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2008-09-25T17:02:46.110

你的建议肯定会奏效。但是，错误处理在任何表现良好的应用程序中都不是可选的。以下实现模式同样简洁，也可以处理错误。此外，它将 fork() 返回值保存在 pid 变量中，以防您稍后想在父级中使用它来等待子级。

```
switch (pid = fork()) {
case -1:       /* Failure */
  /* ... */
case 0:        /* Child */
  /* ... */
default:       /* Parent */
  /* ... */
} 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-09-25T16:58:41.640

您在父进程中丢失了子进程 ID，这是返回给父进程的 ID。我认为您可以恢复该信息，但可能不是唯一的（也就是说，我认为您可以获得所有孩子的 PID，但不一定是您刚刚分叉的孩子的 PID）。如果您不需要知道孩子的PID，我认为第二种方式很好。

此外，如果分叉中出现错误，则返回 -1，在这两种情况下您都没有测试，这通常是一个错误。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-09-25T16:59:27.707

你应该这样做。我从来不知道它不起作用。这就是史蒂文斯书中的做法。

```
int p;
if((p = fork()) == 0) { /* child */ }
else { /* parent/pray */ } 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-09-25T17:01:39.527

您可以在 C 中自由地执行此操作，并且它会起作用，因为父级和子级将从 fork 接收到不同的返回值 - 并且首先对其进行评估。唯一的问题是您提到的错误处理。此外，如果您想对其进行操作，您将没有任何其他方法来恢复子 PID，例如使用 waitpid 等。

# .net - Microsoft.ApplicationBlocks.Data.ODBCHelper？

> ID：134505
> 
> 赞同：0
> 
> 时间：2008-09-25T16:54:49.777
> 
> 标签：.net, odbc, application-blocks

我发现提到了 ODBC 存在的数据应用程序块，但似乎在任何地方都找不到。如果我没有 Access DB 应用程序块的副本，我也不会相信它曾经存在过。

有人知道从哪里下载 DLL 或代码库吗？

--更新：它不包含在数据应用程序块的 v1、v2 或企业库版本中

谢谢，布赖恩斯旺森

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-18T18:14:32.863

您对在哪个版本的 .net 上使用 ODBC 块感兴趣？

企业库有一个数据访问组件。它在 SQL、Oracle 和 ODBC 上很有用。只需在 .config 文件 EX 中设置不同的提供程序名称：

<add name="MyConnection" connectionString="Dsn=Datasource;uid=UserID;pwd=Password" providerName= **"System.Data.Odbc"** />

此时，数据访问代码是“标准化”的，并且对于 SQL、Oracle 和 ODBC 看起来相同

前任：

```
Imports Microsoft.Practices.EnterpriseLibrary.Data
Imports Microsoft.Practices.EnterpriseLibrary.ExceptionHandling

    Public Class MyClass

    Private dbMyDatabase As Database

    dbMyDatabase = DatabaseFactory.CreateDatabase("MyConnection")

    Public Function GetMyData(ByVal FacilityCode As String) As Data.DataSet

            Try
                Dim SQL As String
                SQL = "SELECT * from MyDataTable"
                Dim cmd As Data.Common.DbCommand = dbMyDatabase.GetSqlStringCommand(SQL)
                Return dbMyDatabase.ExecuteDataSet(cmd)
            Catch ex As Exception
                ExceptionPolicy.HandleException(ex, "All")
                Throw
            End Try
        End Function 

    End Class 
```

最新企业库的地址是：http: [//msdn.microsoft.com/en-us/library/cc467894.aspx](http://msdn.microsoft.com/en-us/library/cc467894.aspx)

这是假设您使用的是 .net 3x。

另请注意，我们在上面的代码中使用了异常处理块。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-09-25T16:57:45.200

[http://www.microsoft.com/downloads/details.aspx?FamilyId=F63D1F0A-9877-4A7B-88EC-0426B48DF275&displaylang=en](http://www.microsoft.com/downloads/details.aspx?FamilyId=F63D1F0A-9877-4A7B-88EC-0426B48DF275&displaylang=en)

很确定它在那里

# java - 在 JgraphT 中显示权重

> ID：134510
> 
> 赞同：5
> 
> 时间：2008-09-25T16:55:22.197
> 
> 标签：java, graphing, jgrapht

我已经实现了这个图：

```
ListenableDirectedWeightedGraph<String, MyWeightedEdge> g = 
    new ListenableDirectedWeightedGraph<String, MyWeightedEdge>(MyWeightedEdge.class); 
```

为了显示类名的含义；一个简单的可听有向加权图。我想更改边缘的标签而不是格式

```
return "(" + source + " : " + target + ")"; 
```

我希望它显示边缘的重量。我意识到节点上的所有操作，例如`getEdgesWeight()`方法，都是从图而不是边缘委托的。如何显示边缘的重量？我是否必须以某种方式将图表传递到边缘？

任何帮助表示赞赏。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-03T16:59:10.773

I assume that the class MyWeightedEdge already contains a method such as

```
public void setWeight(double weight) 
```

If this is indeed the case, then what you need to do is:

Derive your own subclass from *ListenableDirectedWeightedGraph* (e.g., *ListenableDirectedWeightedGraph*). I would add both constructor versions, delegating to "super" to ensure compatibility with the original class.

Create the graph as in your question, but using the new class

```
ListenableDirectedWeightedGraph g = 
    new CustomListenableDirectedWeightedGraph(
        MyWeightedEdge.class); 
```

Override the method *setEdgeWeight* as follows:

```
public void setEdgeWeight(E e, double weight) {
    super.setEdgeWeight(e, weight);
    ((MyWeightedEdge)e).setWeight(weight);
} 
```

And, last but not least, override the *toString* method of the class *MyWeightedEdge* to return the label you want the edge to have (presumably including the weight, which is now available to it).

I hope this helps.

# release - 获取正确的软件版本号。v1.0.0.1

> ID：134517
> 
> 赞同：20
> 
> 时间：2008-09-25T16:57:32.923
> 
> 标签：release, release-management, release-cycle

我在线分发软件，并且总是想知道是否有更好的方法来更好地定义版本号。

让我们在答案中假设 ABCD。你什么时候增加每个组件？

您是否使用任何其他版本号技巧，例如 D mod 2 == 1 意味着它仅是内部版本？

您是否有带有自己版本号的 beta 版本，或者您是否有每个版本号的 beta 版本？

* * *

## 回答 #1

> 赞同：29
> 
> 时间：2008-09-25T17:27:48.263

我开始喜欢某些应用程序（例如 Perforce）使用的 Year.Release[.Build] 约定。基本上它只是说明你发布的年份，以及那一年的顺序。所以 2008.1 将是第一个版本，如果您在一个月或三个月后发布另一个版本，它将转到 2008.2。

这种方案的优点是没有隐含的发布“数量”，您可以在其中争论某个功能是否足够重要以保证主要版本的增加。

一个可选的附加功能是标记内部版本号，但这往往仅用于内部目的（例如添加到 EXE/DLL 以便您可以检查文件并确保存在正确的版本）。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2008-09-28T04:50:45.070

在我看来，几乎任何版本号方案都可以或多或少地正常工作。我工作的系统使用版本号，例如 11.50.UC3，其中 U 表示 32 位 Unix，而 C3 是次要修订（修订包）号；其他字母用于其他平台类型。（我不推荐这个方案，但它有效。）

到目前为止，有一些黄金法则尚未阐明，但隐含在人们所讨论的内容中。

*   不要两次发布相同的版本 - 一旦 1.0.0 版本发布给任何人，就永远无法重新发布。
*   发布数量应该单调增加。也就是说，版本 1.0.1 或 1.1.0 或 2.0.0 中的代码应始终晚于版本 1.0.0、1.0.9 或 1.4.3（分别）。

现在，在实践中，人们确实必须在有新版本可用时发布旧版本的修复程序——参见 GCC，例如：

*   GCC 3.4.6 在 4.0.0、4.1.0（和 AFAICR 4.2.0）之后发布，但它继续 GCC 3.4.x 的功能，而不是添加添加到 GCC 4.x 的额外功能。

因此，您必须仔细构建您的版本编号方案。

我坚信的另一点：

*   发布版本号与CM（VCS）系统版本号无关，小程序除外。任何具有多个主要源文件的严肃软件都将具有与任何单个文件的版本无关的版本号。

使用 SVN，您可以使用 SVN 版本号 - 但可能不会，因为它的变化太不可预测。

对于我使用的东西，版本号纯粹是政治决定。

顺便说一句，我知道一些软件从 1.00 版到 9.53 版都经过了发布，但后来又变成了 2.80 版。这是一个严重的错误——由营销决定。诚然，该软件的 4.x 版本已经过时，因此不会立即引起混淆，但该软件的 5.x 版本仍在使用和销售中，并且修订版已经达到 3.50。当不可避免的冲突发生时，我非常担心我的代码必须与 5.x（旧样式）和 5.x（新样式）一起使用。我想我必须希望他们在更改为 5.x 时会犹豫不决，直到旧的 5.x 真的死了——但我并不乐观。我还使用人工版本号，例如 9.60，来表示 3.50 的代码，这样我就可以进行理智的`if VERSION > 900`测试，而不必这样做：`if (VERSION >= 900 || (VERSION >= 280 && VERSION < 400)`，其中我用 900 表示版本 9.00。然后是版本 3.00.xC3 中引入的重大更改——我的方案无法检测到次要版本级别的更改......抱怨......抱怨......

*注意*：Eric Raymond 提供了[软件发布实践 HOWTO](http://en.tldp.org/HOWTO/Software-Release-Practice-HOWTO/naming.html)，包括关于命名（编号）发布的（链接）部分。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2008-09-25T17:04:49.193

我通常使用 D 作为构建计数器（由编译器自动递增）每次构建发布到“公共”时我都会递增 C（不是每个构建都发布） A 和 B 用作主要/次要版本号并手动更改。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2008-09-25T17:09:49.070

我认为有两种方法可以回答这个问题，它们并不完全是互补的。

1.  技术：根据技术任务增加版本。示例：D 是内部版本号，C 是迭代，B 是次要版本，A 是主要版本。定义次要版本和主要版本确实是主观的，但可能与底层架构的更改等相关的事情。
2.  营销：根据向客户提供的“新”或“有用”功能的数量增加版本。您还可以将版本号绑定到更新策略...对 A 的更改需要用户购买升级许可证，而其他更改则不需要。

我认为，最重要的是找到适合您和您的客户的模型。我见过一些情况，其中偶数版本是公开版本，而奇数版本被认为是 beta 或 dev 版本。我见过一些忽略 C 和 D 的产品。

然后是来自 Micrsoft 的示例，其中对 .Net Framework 版本号的唯一合理解释是涉及营销。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2008-09-25T17:02:28.527

我们的政策：

*   A - 功能或界面的重大 (> 25%) 更改或添加。
*   B - 功能或界面的小改动或添加。
*   C - 破坏界面的小改动。
*   D - 修复不更改界面的构建。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2008-09-25T17:03:04.203

人们往往想让这比它真正需要的更难。如果您的产品只有一个长期存在的分支，只需按其内部版本号命名后续版本。如果您有某种“小错误修复是免费的，但您必须为主要的新版本付费”，那么使用 1.0、1.1 ... 1.n、2.0、2.1...等。

如果您无法立即弄清楚示例中的 A、B、C 和 D 是什么，那么您显然不需要它们。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2008-09-25T17:17:37.213

我对版本号的唯一用途是让客户可以告诉我他们使用的是 2.5.1.0 版或其他版本。

我唯一的规则是尽量减少报告该数字时的错误： **所有四个数字都只能是 1 位数字**。

```
1.1.2.3 
```

可以，但是

```
1.0.1.23 
```

不是。客户可能会将这两个数字（至少口头上）报告为“一一二三”。

自动递增内部版本号通常会导致版本号，例如

```
1.0.1.12537 
```

这也无济于事。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2008-09-25T21:16:46.107

一个好的非技术方案只使用这种格式的构建日期：

YYYY.MM.DD.BuildNumber

其中 BuildNumber 是一个连续的数字（更改列表）或每天从 1 开始。

示例：2008.03.24.1 或 2008.03.24.14503

这主要用于内部发布，如果您不经常发布每月一次，公开发布会看到打印为 2008.03 的版本。维护版本被标记为 2008.03a 2008.03b 等等。他们应该很少超过“c”，但如果它是一个很好的指标，你需要更好的 QA 和/或测试程序。

用户常见的版本字段应以友好的“2008 年 3 月”格式打印，在“关于”对话框或日志文件中保留更多技术信息。

最大的缺点：只是在另一天编译相同的代码可能会更改版本号。但是您可以通过使用版本控制更改列表作为最后一个数字并检查以确定是否也需要更改日期来避免这种情况。

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2013-12-25T09:52:14.837

在 github 世界中，遵循 Tom Preston-Werner 的版本号“semver”规范变得很流行。

来自[http://semver.org/](http://semver.org/)：

> 给定版本号 MAJOR.MINOR.PATCH，增加：
> 
> 当您进行不兼容的 API 更改时的 MAJOR 版本，当您以向后兼容的方式添加功能时的 MINOR 版本，以及当您进行向后兼容的错误修复时的 PATCH 版本。预发布和构建元数据的附加标签可作为 MAJOR.MINOR.PATCH 格式的扩展。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2008-09-25T17:00:38.330

我使用 VRM，例如 2.5.1

V（版本）更改是主要的重写
R（修订）更改是重要的新功能或错误修复
M（修改）更改是次要的错误修复（错别字等）

我有时也会在最后使用 SVN 提交号。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2009-05-30T10:08:28.167

归根结底，这一切都是主观的，完全取决于您自己/您的团队。

只需看看所有的答案 - 都非常不同。

我个人使用`Major.Minor.*.*`- Visual Studio 自动填写修订/内部版本号。这也用于我工作的地方。

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2009-06-08T20:19:56.943

**我喜欢年月日。**因此，v2009.6.8 将是这篇文章的“版本”。（合理地）复制是不可能的，并且很清楚什么时候是较新的版本。您也可以去掉小数点并将其设为 v20090608。

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2010-11-28T17:41:59.457

对于库，版本号告诉您两个版本之间**的兼容性级别**，以及升级的难度。

错误修复版本需要保留二进制、源代码和序列化兼容性。

次要版本对不同的项目意味着不同的东西，但通常它们不需要保持源代码兼容性。

主要版本号可以打破所有三种形式。

[我在这里](http://motlin.com/2010/how-to-do-version-numbers/)写了更多关于基本原理的文章。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2008-09-25T17:25:21.657

对于内部开发，我们使用以下格式。

```
[Program #] . [Year] . [Month] . [Release # of this app within the month] 
```

例如，如果我今天发布应用程序#15，并且这是本月的第三次更新，那么我的版本# 将是

```
15.2008.9.3 
```

这完全是非标准的，但它对我们很有用。

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2008-09-25T17:25:40.703

对于过去的六个主要版本，我们使用了 M.0.mb，其中 M 是主要版本，m 是次要版本，b 是内部版本号。因此发布的版本包括 6.0.2、7.0.1、...，直到 11.0.0。不要问为什么第二个数字总是0；我问了很多次，没有人真正知道。自 1996 年发布 5.5 以来，我们还没有出现过非零值。

# asp.net - ASPNET TreeView 扩展节点样式

> ID：134519
> 
> 赞同：1
> 
> 时间：2008-09-25T16:57:35.777
> 
> 标签：asp.net, css, treeview

有谁知道如何在 ASP.Net 的 TreeView 控件中将自定义样式应用于扩展节点？我有许多根节点，并希望扩展节点具有不同的背景。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-09-25T19:50:43.023

开箱即用的控件无法做到这一点，这适用于很多 MS ASP.NET 控件，但是在 codeplex 上有一个适配器项目可以使您的 ASP.NET 控件对 CSS 友好：
[http://www。 codeplex.com/cssfriendly](http://www.codeplex.com/cssfriendly)
它非常简单，但再次询问您是否需要任何帮助来设置它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-14T14:34:46.017

我不想偏离原始控件，所以我最终编写了一些 JavaScript，它会在页面加载时通过节点结构修改树。

# eclipse - 将 Stack Overflow 集成到 IDE 中？

> ID：134520
> 
> 赞同：20
> 
> 时间：2008-09-25T16:57:40.363
> 
> 标签：eclipse, eclipse-plugin, integration, stackexchange-api

好吧，这只是我的一个疯狂想法。Stack Overflow 看起来非常结构化并且可以集成到开发应用程序中。那么，是否有可能，甚至有用，为 Eclipse 提供一个 Stack Overflow 插件？

您希望将 Stack Overflow 的哪些功能直接集成到您的 IDE 中，以便您可以“本地”使用它而无需更改为浏览器？

编辑：我正在考虑更深入的集成方式，而不仅仅是在 IDE 中使用网页。就像当您使用某个 Java 类并遇到问题时，来自 SO 的答案可能会突然爆发。在某些情况下，这样的事情可能很烦人，但其他人可能会很有帮助。

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2008-09-25T18:06:15.583

跟进乔希的回答。此 VS 宏将在 StackOverflow 中搜索 Visual Studio IDE 中突出显示的文本。只需突出显示并按 Alt+F1

```
Public Sub SearchStackOverflowForSelectedText()
    Dim s As String = ActiveWindowSelection().Trim()
    If s.Length > 0 Then
        DTE.ItemOperations.Navigate("http://www.stackoverflow.com/search?q=" & _
            Web.HttpUtility.UrlEncode(s))
    End If
End Sub

Private Function ActiveWindowSelection() As String
    If DTE.ActiveWindow.ObjectKind = EnvDTE.Constants.vsWindowKindOutput Then
        Return OutputWindowSelection()
    End If
    If DTE.ActiveWindow.ObjectKind = "{57312C73-6202-49E9-B1E1-40EA1A6DC1F6}" Then
        Return HTMLEditorSelection()
    End If
    Return SelectionText(DTE.ActiveWindow.Selection)
End Function

Private Function HTMLEditorSelection() As String
    Dim hw As HTMLWindow = ActiveDocument.ActiveWindow.Object
    Dim tw As TextWindow = hw.CurrentTabObject
    Return SelectionText(tw.Selection)
End Function

Private Function OutputWindowSelection() As String
    Dim w As Window = DTE.Windows.Item(EnvDTE.Constants.vsWindowKindOutput)
    Dim ow As OutputWindow = w.Object
    Dim owp As OutputWindowPane = ow.OutputWindowPanes.Item(ow.ActivePane.Name)
    Return SelectionText(owp.TextDocument.Selection)
End Function

Private Function SelectionText(ByVal sel As EnvDTE.TextSelection) As String
    If sel Is Nothing Then
        Return ""
    End If
    If sel.Text.Length = 0 Then
        SelectWord(sel)
    End If
    If sel.Text.Length <= 2 Then
        Return ""
    End If
    Return sel.Text
End Function

Private Sub SelectWord(ByVal sel As EnvDTE.TextSelection)
    Dim leftPos As Integer
    Dim line As Integer
    Dim pt As EnvDTE.EditPoint = sel.ActivePoint.CreateEditPoint()

    sel.WordLeft(True, 1)
    line = sel.TextRanges.Item(1).StartPoint.Line
    leftPos = sel.TextRanges.Item(1).StartPoint.LineCharOffset
    pt.MoveToLineAndOffset(line, leftPos)
    sel.MoveToPoint(pt)
    sel.WordRight(True, 1)
End Sub 
```

安装：

1.  转到工具 - 宏 - IDE
2.  在“MyMacros”下使用您选择的名称创建一个新模块。或使用现有模块。
3.  将上面的代码粘贴到模块中
4.  向模块添加对 System.Web 命名空间（用于 HttpUtility）的引用
5.  关闭宏 IDE 窗口
6.  转到工具 - 选项 - 环境 - 键盘
7.  在“显示包含的命令”文本框中键入“google”。SearchGoogleForSelectedText 宏应该会出现
8.  单击“按快捷键”文本框，然后按 ALT+F1
9.  单击分配按钮
10.  点击确定

这一切都取自 Jeff Atwood 的[Google Search VS Macro](https://blog.codinghorror.com/google-search-vsnet-macro/)帖子，只是修改为搜索 StackOverflow。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2008-09-25T17:08:03.693

我认为我无法将 SO 集成到 IDE 中完成任何工作。它几乎和将 Digg/Reddit 集成到 IDE 中一样糟糕，如果不是最糟糕的话。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2008-09-25T17:05:44.400

在 Visual Studio 中，您可以添加一个快捷方式来搜索 StackOverflow 中突出显示的术语。[Jeff Atwood 在他的Google 搜索 VS.NET 宏](https://blog.codinghorror.com/google-search-vsnet-macro/)博客条目中写到了与 Google 做类似的事情。

使用这种方法，您可以突出显示术语或错误消息（或 IDE 中的任何其他可选文本），按下快捷键，然后在 StackOverflow 上查看所有匹配结果。

我确信在其他 IDE 中也有办法做到这一点。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-09-25T17:08:00.603

如果 StackOverflow 可以开始识别每个代码片段包含的语言，那么我可以看到 IDE 的代码完成/代码片段插件，该插件响应特殊语法，用于在 SO 上执行搜索并插入已接受答案的代码部分。

例如：在我的来源中，我可能会输入：

```
//# read an XML file 
```

//# 语法提示插件开始搜索并显示问题标题列表。当我选择一个时，它会插入已接受答案的代码部分。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-09-25T17:03:25.797

我不了解 Eclipse，但对于 Visual Studio，如果有人真的想要这个，他们可以轻松地为“起始页新闻频道”添加 SO RSS 提要，因此 SO 问题列表出现在起始页中，或者甚至更好，缩小它带有一个标签（[如 C#](https://stackoverflow.com/feeds/tag/c%23)）。它不完全是“集成”，但它可以让您以极少的努力快速了解最近的事情。但是，不确定它有多“有用”。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-09-25T17:06:43.087

您有 Eclipse 的[RSS 插件](http://morphine.sourceforge.net/presence/projects/rss/index.html)来读取 StackOverflow 提要。

但我支持你，一个 SO Eclipse 插件会很酷。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-09-25T16:59:48.503

您可以将其设置为 Visual Studio 中的起始页。

不确定这会带来什么好处……但对每个人都有好处。

# c++ - 使用 ofstream 时，我如何知道我达到了文件的最大大小？

> ID：134526
> 
> 赞同：3
> 
> 时间：2008-09-25T16:58:14.857
> 
> 标签：c++, linux

使用 ofstream 写入文件时，我如何知道文件大小何时达到操作系统的最大文件大小 - 更具体地说是 linux 的最大文件大小 - ??

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-09-25T17:11:56.757

首先，最大文件大小是文件系统限制，而不是操作系统限制。根据文件系统的格式化方式，它甚至会因特定文件系统而异。

至于您如何确定您已达到限制，您的代码可能会在发生这种情况时引发异常，然后您将能够将其与操作系统错误代码相关联。

请注意，“典型”EXT2 文件系统的实际限制[非常大](http://en.wikipedia.org/wiki/Ext2#File_system_limits)- 以 TB 为单位。在实践中，你可能永远也达不到它。如果您认真地积累 TB 级数据，您可能需要考虑是否有更合理的方式来存储它，而不是单个巨大的文件。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-09-25T19:16:25.570

您可以检查是否[设置了坏位](http://www.cplusplus.com/reference/iostream/ios/bad.html)。此外，当设置了坏位时，您可以使用[异常](http://www.cplusplus.com/reference/iostream/ios/exceptions.html)强制流抛出异常。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-25T17:01:25.863

我认为（不是 100% 肯定）你只需要在写入操作系统的最大文件大小后比较流的当前大小。否则我猜底层实现只会让你继续写，直到实际的操作系统 io 调用失败。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-26T13:37:23.447

好吧，fstream 对于“写入超过实现定义的最大文件大小的文件”（来自“man 2 write”）没有排他性例外，例如使用 C 函数“write”时可用的错误代码 EFBIG . 因此，我认为必须像 Jim Crafton 所说的那样，将文件大小与一些用户定义的最大大小或与“streamoff”变量持有的最大值进行比较，该变量是用于处理文件大小的变量类型 - 文件实际偏移 - 在 iostream 中。

# css - 你能推荐学习 CSS 的最佳截屏视频吗？

> ID：134543
> 
> 赞同：1
> 
> 时间：2008-09-25T17:02:27.140
> 
> 标签：css

它应该是实用的、完整的、以程序员为目标的并且详细介绍了布局技术！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-09-25T17:20:03.493

以下是您可能需要考虑的一些内容：

*   **[设计师](http://movielibrary.lynda.com/html/modPage.asp?id=216)**的 CSS：Andy Clarke 和 Molly E. Holzschlag
*   **[CSS 网站设计](http://movielibrary.lynda.com/html/modPage.asp?ID=279)**与：Eric Meyer
*   **[SitePoint :CSS 视频速成课程](http://www.sitepoint.com/videos/videocss1/)**
*   **[CSS技巧](http://css-tricks.com/videos/)**
*   **[初学者 CSS 教程](http://www.softwaretrainingtutorials.com/css2.php)**

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-09-25T17:16:49.257

您在寻找免费的屏幕演员吗？如果没有，Eric Meyer（Web 标准之神之一）有一个名为[CSS Web Design](http://www.lynda.com/store/productinfo.aspx?productid=532)的视频，它将告诉您流利使用 CSS 所需的一切。

它还涵盖了一些高级 CSS 技术，例如[Sliding Doors](http://www.lynda.com/store/productinfo.aspx?productid=532)。他还在一些知名网站上重构了一些 HTML 以利用 CSS。

如果您是一个快速学习者，[W3School 的 CSS](http://w3schools.com/css/)部分有足够的信息来帮助您入门。CSS实际上很容易学习。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-25T17:18:20.347

查看 www.css-tricks.com。他们有出色的屏幕演员。

另一个值得关注的地方是各种网页设计播客。转到 iTunes 并搜索播客，您可能会找到一些要查看的内容。

# versioning - 发布具有> 1个第一个商业版本号的软件是否令人不悦？

> ID：134568
> 
> 赞同：5
> 
> 时间：2008-09-25T17:05:32.623
> 
> 标签：versioning, release-cycle

发布版本号高于 1 的软件是否令人不悦？

例如，一些**不**精通技术的人可能会认为竞争对手的产品具有更高的版本号，这意味着我的软件不是那么好。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-09-25T17:36:16.200

我相信人们营销产品版本的主要方式有 3 种：

1.  产品名称 [版本号]（即 Wordperfect 5.0）
2.  产品名称[发布年份]（即Gentoo 2008.0）
3.  产品名称[代号]（即Windows Vista）

我实际上更喜欢将发布年份作为版本控制策略的一部分，它让您的客户知道产品的最新版本是什么，发布的一般年龄并使用 2008.1 类型的数字，您知道发布是修订版（即服务盒）。

如果您仍然决定使用版本号，我认为从 1.1 开始**没有什么**坏处，这就是我们在我以前的工作地点一直在做的事情......

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2008-09-25T17:08:42.850

任何根据营销而不是软件工程考虑来设置版本号的人都会让我感到恼火。

现实情况是，拥有更多版本、补丁或更高版本并不会使您的软件本质上更好，就像拥有更多橡皮擦标记并不会使用铅笔写的东西本质上更好一样。

营销部门想给产品起什么名字，我不在乎，事实上，我更希望他们不拘泥于版本号。微软做得很好，因为虽然他们的内部版本号保持一致和健全，但营销并没有推动“Windows 6”而是“Vista”。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-09-25T17:06:28.657

Oracle 在他们的第一个 DB 版本中做到了这一点。没有 Oracle 1。

您对 Oracle 软件质量的看法是另一回事.... :-)

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2008-09-25T17:15:43.533

一个简单的解决方案是发布带有年份编号（当年或来年）或型号名称的第一个版本。无论如何，这现在很流行：

*   德尔福**2009**
*   微软 SQL **2008**
*   视窗**_**
*   微软办公软件**2007**
*   RemObjects **Oxygene**（在 Chrome 和 Joyride 之后出现）

虽然个别版本号仍然更常见。

这避免了*“版本 1 在哪里？”的问题。*没有版本 1\. 在几个版本之后，您可以根据需要切换回版本号，并保持可观的数字。

您还可以一起使用版本号并以**订阅的形式**出售您的软件，因此购买包括一年的更新，然后您可以给他们构建*20080925A*（构建日期），并经常将它们更新到最新的认证构建.

这实际上取决于您发布的软件类型、分发方式以及目标市场。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2008-09-25T17:23:39.227

实际上，我更倾向于让我的版本号低于我的竞争对手，所以我的营销人员可以说“我们的第 2 版等于他们的第 10 版！他们花了 10 次发布才走到这一步，而我们在 2 ！我们的人因此聪明了5倍！给我们更多的钱！”

（这就是为什么我没有或永远不想要我自己的公司。）

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2008-09-25T17:43:07.760

对于我们的软件，我们在内部使用了 1.0 和 1.1 版本，并且从未向公众发布它们。我们的第一个公开版本是 2.0 版。没有人不高兴，如果有人问我们会告诉他们内部版本。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-09-25T17:12:17.973

我不会担心的。让您的软件质量不言自明。坚持1.0。或者，更好的是，根本不附加版本号。如果有人想知道版本 - 好吧，这就是 Help / About 的用途。=)

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2008-09-25T17:12:35.057

无论哪种方式，人们都会知道它是第 1 版。如果你称它为 2.0 版，但 1.0 版是无处可寻的，而且没有人见过它，人们会弄清楚它。

或者，您可以在内部进行版本控制，只需将您的产品称为“比 XYZ 2008 更好的惊人应用程序”

编辑：实际上我改变了主意，将您的软件称为 Amazing App 2010。这样人们会认为它来自未来。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2008-09-25T18:12:10.013

我公司经常与工程部门发生这种争论。当我们试图将我们的下一个版本标记为高于前一个版本的主要版本时，发生了巨大的爆炸，因为营销/销售认为我们当前的客户会因为我们这么快就有新的主要版本而感到不安，他们需要升级。他们希望它是一个高于前一个的 .5 版本。我们回去了几次……目前，工程正在获胜。市场部也用年份编号的release作为产品名称，所以不知道在闹什么。不过，我们倾向于将我们的内部名称和外部名称混为一谈。此外，当我们开始使用当前格式的版本号时，我们从一个相当高的数字开始，正是因为担心客户会认为我们的软件不是 t 与具有更高版本号的竞争对手一样好。这是一个真正的问题，至少在营销人员的头脑中是这样。

我的 0.02 美元是版本号应该反映产品的主要功能/更改，因此第一个公开版本定义为 1.0.0。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2008-09-26T17:13:13.850

不，绝对可以从任意点开始。或者，使用一个模糊的防御方案，比如发布年份的最后一位数字。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2008-09-25T17:07:14.663

您可以使用发布年份或花哨的代号而不是版本号，从而绕过人为使您的软件看起来比实际更粗糙的道德问题 :)

营销有很多问题要解决。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2008-09-25T17:07:25.927

我说是的，人为地夸大数字以占优势是不道德的。但是，将其称为 10.0 X .1 版完全没问题！

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2008-09-25T17:08:51.540

我真的认为这根本不重要。我不认识任何人，即使是那些不精通技术的人，谁会认为产品 A 的 2.0 版甚至与产品 B 的 1.0 版远程相关。

真正不精通技术的人可能甚至不知道他们拥有/想要的软件的版本号是什么。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2008-09-25T17:09:25.157

我认为将产品销售给感兴趣的各方都是营销部门的事情，但是版本号应该是准确的，尽管您如何定义版本号可能会起作用。

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2008-09-25T17:16:56.573

让我把问题转回到你身上：你更愿意购买大而昂贵的软件包的第 1 版还是 3.14 版？

版本号的目的是作为调试和故障排除的唯一句柄。它还向用户传达了一些信息。但第一次使用与第二次使用无关。如果我在内部使用版本 1702，则有办法说它应该作为版本 1 还是版本 11 发布。

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2008-09-25T17:33:11.853

当然，您应该将其称为版本 1。但是对于之后您可以多快发布版本 2，没有任何规定！

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2008-09-25T18:08:11.163

文字之星 1986

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2008-09-25T18:16:06.337

我非常相信：

[主要].[次要].[次要/补丁]

其中 beta [major] = 0 和 gamma [major] 从 1 开始。我认为这是信息量最大、易于理解和诚实的版本编号方案。

当然，对于 alpha，我更喜欢更简单的：[svn-revision-num]，因为它当时仅供内部使用，而且信息量更大。

* * *

## 回答 #19

> 赞同：0
> 
> 时间：2011-01-21T15:51:59.363

Ubuntu 以 9.04、9.10 等时间为基础，我们总能猜出哪个是最新的。

# c++ - c++ 异常：抛出 std::string

> ID：134569
> 
> 赞同：82
> 
> 时间：2008-09-25T17:05:36.820
> 
> 标签：c++, exception, stl

当我的 C++ 方法遇到奇怪的事情并且无法恢复时，我想抛出一个异常。可以抛出`std::string`指针吗？

这是我期待做的事情：

```
void Foo::Bar() {
    if(!QueryPerformanceTimer(&m_baz)) {
        throw new std::string("it's the end of the world!");
    }
}

void Foo::Caller() {
    try {
        this->Bar(); // should throw
    }
    catch(std::string *caught) { // not quite sure the syntax is OK here...
        std::cout << "Got " << caught << std::endl;
    }
} 
```

* * *

## 回答 #1

> 赞同：102
> 
> 时间：2008-09-25T17:16:46.230

是的。[`std::exception`](http://en.cppreference.com/w/cpp/error/exception)是 C++ 标准库中的基本异常类。您可能希望避免将字符串用作异常类，因为它们本身可以在使用过程中引发异常。如果发生这种情况，那么你会在哪里？

boost 有一个关于异常和错误处理良好风格的优秀[文档。](http://www.boost.org/community/error_handling.html)值得一读。

* * *

## 回答 #2

> 赞同：66
> 
> 时间：2008-09-25T17:12:37.020

几个原则：

1.  你有一个 std::exception 基类，你应该让你的异常派生自它。这样一般的异常处理程序仍然有一些信息。

2.  不要抛出指针而是对象，这样就会为您处理内存。

例子：

```
struct MyException : public std::exception
{
   std::string s;
   MyException(std::string ss) : s(ss) {}
   ~MyException() throw () {} // Updated
   const char* what() const throw() { return s.c_str(); }
}; 
```

然后在您的代码中使用它：

```
void Foo::Bar(){
  if(!QueryPerformanceTimer(&m_baz)){
    throw MyException("it's the end of the world!");
  }
}

void Foo::Caller(){
  try{
    this->Bar();// should throw
  }catch(MyException& caught){
    std::cout<<"Got "<<caught.what()<<std::endl;
  }
} 
```

* * *

## 回答 #3

> 赞同：25
> 
> 时间：2008-09-25T17:14:32.117

所有这些工作：

```
#include <iostream>
using namespace std;

//Good, because manual memory management isn't needed and this uses
//less heap memory (or no heap memory) so this is safer if
//used in a low memory situation
void f() { throw string("foo"); }

//Valid, but avoid manual memory management if there's no reason to use it
void g() { throw new string("foo"); }

//Best.  Just a pointer to a string literal, so no allocation is needed,
//saving on cleanup, and removing a chance for an allocation to fail.
void h() { throw "foo"; }

int main() {
  try { f(); } catch (string s) { cout << s << endl; }
  try { g(); } catch (string* s) { cout << *s << endl; delete s; }
  try { h(); } catch (const char* s) { cout << s << endl; }
  return 0;
} 
```

你应该更喜欢 h 而不是 f 而不是 g。请注意，在最不受欢迎的选项中，您需要显式释放内存。

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2008-09-25T17:09:32.677

它有效，但如果我是你，我不会这样做。完成后，您似乎并没有删除该堆数据，这意味着您已经创建了内存泄漏。C++ 编译器负责确保异常数据即使在堆栈被弹出时也保持活动状态，所以不要觉得您需要使用堆。

顺便说一句，投掷 a`std::string`并不是最好的方法。如果您使用简单的包装器对象，您将拥有更多的灵活性。它现在可能只是封装了 a `string`，但将来您可能希望包含其他信息，例如导致异常的某些数据或行号（非常常见）。您不想更改代码库中每个位置的所有异常处理，所以现在走上正轨，不要抛出原始对象。

* * *

## 回答 #5

> 赞同：8
> 
> 时间：2008-09-25T18:48:34.810

除了可能抛出从 std::exception 派生的东西之外，您还应该抛出匿名临时对象并通过引用捕获：

```
void Foo::Bar(){
  if(!QueryPerformanceTimer(&m_baz)){
    throw std::string("it's the end of the world!");
  }
}

void Foo:Caller(){
  try{
    this->Bar();// should throw
  }catch(std::string& caught){ // not quite sure the syntax is ok here...
    std::cout<<"Got "<<caught<<std::endl;
  }
} 
```

*   您应该抛出匿名临时对象，以便编译器处理您抛出的任何对象的生命周期 - 如果您从堆中抛出新的东西，其他人需要释放该东西。
*   您应该捕获引用以防止对象切片

.

有关详细信息，请参阅 Meyer 的“Effective C++ - 第 3 版”或访问[https://www.securecoding.cert.org/.../ERR02-A.+Throw+anonymous+temporaries+and+catch+by+reference](https://www.securecoding.cert.org/confluence/display/cplusplus/ERR02-A.+Throw+anonymous+temporaries+and+catch+by+reference)

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2013-07-11T18:20:06.370

**在 C++ 中抛出异常的最简单方法：**

```
#include <iostream>
using namespace std;
void purturb(){
    throw "Cannot purturb at this time.";
}
int main() {
    try{
        purturb();
    }
    catch(const char* msg){
        cout << "We caught a message: " << msg << endl;
    }
    cout << "done";
    return 0;
} 
```

这打印：

```
We caught a message: Cannot purturb at this time.
done 
```

如果您捕获了抛出的异常，则异常被包含并且程序将继续运行。如果您没有捕获异常，则程序存在并打印：

`This application has requested the Runtime to terminate it in an unusual way. Please contact the application's support team for more information.`

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2017-12-03T13:52:10.463

虽然这个问题相当古老并且已经得到解答，但我只想添加一个关于如何**在 C++11 中**进行正确异常处理的注释：

## 使用[`std::nested_exception`](http://en.cppreference.com/w/cpp/error/nested_exception)和[`std::throw_with_nested`](http://en.cppreference.com/w/cpp/error/throw_with_nested)

在我看来，使用这些会导致更清晰的异常设计，并且不需要创建异常类层次结构。

请注意，这使您能够在代码中**获取异常的回溯，**而无需调试器或繁琐的日志记录。[在此处](https://stackoverflow.com/a/37227893/4069571)和[此处](https://stackoverflow.com/a/348862/4069571)的 StackOverflow 上描述了如何编写适当的异常处理程序来重新抛出嵌套异常。

由于您可以对任何派生的异常类执行此操作，因此您可以向此类回溯添加大量信息！你也可以看看我[在 GitHub 上的 MWE](https://github.com/GPMueller/mwe-cpp-exception)，回溯看起来像这样：

```
Library API: Exception caught in function 'api_function'
Backtrace:
~/Git/mwe-cpp-exception/src/detail/Library.cpp:17 : library_function failed
~/Git/mwe-cpp-exception/src/detail/Library.cpp:13 : could not open file "nonexistent.txt" 
```

# jquery - jQuery 和原型冲突

> ID：134572
> 
> 赞同：27
> 
> 时间：2008-09-25T17:05:45.057
> 
> 标签：jquery, autocomplete, prototypejs, accordion, conflict

我在一个 html 页面中使用 jQuery AutoComplete 插件，其中我还有一个使用原型的手风琴菜单。

它们都可以完美地单独工作，但是当我尝试在一个页面中实现这两个组件时，我得到了一个我无法理解的错误。

> 未捕获的异常：[异常...“组件返回失败代码：0x80004005 (NS_ERROR_FAILURE) [nsIDOMViewCSS.getComputedStyle]”nsresult:“0x80004005 (NS_ERROR_FAILURE)”位置：“JS 框架 :: file:///C:/Documents and Settings /Administrator/Desktop/website/js/jquery-1.2.6.pack.js :: 匿名 :: 第 11 行“数据：无]

我发现与 jQuery 冲突的文件是手风琴菜单使用的“effects.js”。我尝试用较新版本替换此文件，但较新版本似乎破坏了手风琴行为。

我的猜测是手风琴中使用的'effects.js'文件被修改以获得手风琴演示输出。我还尝试使用 jQuery 需要的覆盖方法来避免与其他库发生冲突，但这不起作用。

我从[stickmanlabs.com](http://www.stickmanlabs.com/accordion/)获得了手风琴演示。

并且 jQuery AutoComplete 可以从[jQuery 站点](http://docs.jquery.com/Plugins/Autocomplete#Setup)获得。

有没有其他人遇到过这个问题？

* * *

## 回答 #1

> 赞同：118
> 
> 时间：2008-09-25T22:08:02.367

有两种可能的解决方案： 与旧版本的 Scriptaculous 和 jQuery 发生冲突（Scriptaculous 试图错误地扩展本机 Array 原型） - 首先尝试升级您的 Scriptaculous 副本。

如果这不起作用，您将需要使用`noConflict()`（如上所述）。但是，有一个问题。由于您包含一个插件，因此您需要按特定顺序执行包含，例如：

```
<script src="jquery.js"></script>
<script src="jquery.autocomplete.js"></script>
<script>
  jQuery.noConflict();
  jQuery(document).ready(function($){
    $("#example").autocomplete(options);
  });
</script>
<script src="prototype.js"></script>
<script src="effects.js"></script>
<script src="accordion.js"></script> 
```

希望这有助于澄清情况。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2008-09-25T17:16:04.517

jQuery 允许您将 jQuery 函数重命名为`$`其他名称，以避免与其他库发生命名空间冲突。

你可以做这样的事情

```
var J = jQuery.noConflict(); 
```

详细信息：[michaelshadle.com — jQuery 的无冲突模式：这是它最好的另一个原因](http://michaelshadle.com/2007/07/03/jquerys-no-conflict-mode-yet-another-reason-why-its-the-best/)

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2008-09-27T03:55:47.270

在这种情况下，我真的看不出同时使用这两个库的原因。

您可以使用 Prototype（实际上是 Scriptaculous）的[Ajax.Autocompleter](http://github.com/madrobby/scriptaculous/wikis/ajax-autocompleter)并抛弃 jQuery，或者您可以使用 jQuery 的[Accordion](http://docs.jquery.com/UI/Accordion)并摆脱 Prototype。

同时使用这两个库并不是一个好主意，因为：

1.  它们会引起冲突。
2.  通过将它们都包含在内，您可以强制用户同时下载它们。这不是带宽友好的方法。

# asp.net - 如何快速渲染 HTML

> ID：134574
> 
> 赞同：7
> 
> 时间：2008-09-25T17:05:51.077
> 
> 标签：asp.net, html

我正在开发在 C#/ASP.NET 上开发的 Web 应用程序。我们正在使用第三方控件在我们的页面中显示网格、选项卡、树和其他复杂控件。问题是这些控件呈现了大量的 HTML。由于这个原因，页面的大小已经大幅增长，浏览器需要一段时间来加载页面。我想找到一些通用技术来使浏览器（Internet Explorer、Firefox 等）中的 HTML 呈现速度更快。

请注意，所有页面的 ViewState 都已关闭。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2008-09-25T17:35:21.663

有一个 Firefox 扩展，YSlow ( [http://developer.yahoo.com/yslow/](http://developer.yahoo.com/yslow/) )，它可以分析任何网页并列出要进行的特定更改，以提高速度。它建议的一些更改与 Web 服务器有关，而不是 HTML 的内容，但无论如何它都非常有用。
YSlow 网页截图： ![替代文字](https://i.stack.imgur.com/mHpgQ.png)

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2008-09-25T17:08:16.220

gzip HTML - 不会提高渲染速度，但会大大减少页面大小。

确保您没有使用基于表格的布局，并确保使用的任何 javascript 或 css 都已缩小、压缩并链接在头部，以便可以缓存。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2008-09-27T03:04:43.477

打开你的普通页面，在 URL 中输入这个，然后按 enter：

```
javascript:var tags = document.getElementsByTagName('*');alert('Page weight: ' + tags.length + ' tags.'); 
```

（您甚至可以将其保存为书签）

**如果您有超过 500 个标签，您可能希望尽可能清理一些“标签汤”。**

Digg 的主页有大约 1,000 个标签！因此渲染速度很慢（第一次）

MSN 的主页有大约 700 多个标签...因此呈现速度很慢

雅虎主页包含大约 600 个标签……因此渲染速度更快

Google 的主页有大约 92 个标签！...因此呈现如闪电！

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-09-25T17:27:50.947

对于第三方控件，您所能做的就是在支持中添加错误以提高其性能。

但是在编码时，您可以使用多种技术。一个关键是要了解 JavaScript DOM 调用比 html 解析慢得多。因此，如果您将 innerHTML = " .... " 设置为数千行，与通过循环调用 document.createElement() 进行渲染相比，它将非常快。

以下是来自 MSDN 的提示：

[http://msdn.microsoft.com/en-us/library/ms533019.aspx](http://msdn.microsoft.com/en-us/library/ms533019.aspx)

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-09-25T17:14:41.150

1.  使用第 3 方工具或至少使用 IIS6 内置压缩选项 ( [Microsoft TechNet](http://www.microsoft.com/technet/prodtechnol/WindowsServer2003/Library/IIS/92f627a8-4ec3-480c-b0be-59a561091597.mspx?mfr=true) ) 压缩 HTML。

2.  评估第三方控件是否有必要。如果是，请根据自己的需要编写自己的控件和/或使用它们的控件（如果它们是“启用 AJAX”的）。大多数流行的第 3 方控件确实具有 AJAX 功能，并且允许在页面的其余部分加载后填充数据，从而向用户显示一些进度。

3.  `ViewState`如果不需要，请关闭。使用第三方控件时，`ViewState`可能会变得巨大。

**更新：**我在[http://weblogs.asp.net/jgaylord/archive/2008/09/29/web-site-performance.aspx](http://weblogs.asp.net/jgaylord/archive/2008/09/29/web-site-performance.aspx)

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-10-04T09:27:49.397

压缩根本不会加速渲染，它只会加速内容交付。

我建议做一些“分析”——用很多你的 html 对象（比如表格行或一些常见的 div 容器）制作测试页面——然后使用像 YSlow 这样的插件来测试需要多少时间渲染例如 10K 的此类元素。分析后，您将看到实际的渲染瓶颈。

顺便说一句，问题实际上可能在于内容交付，而不是渲染。YSlow 也会显示它的位置。您还可以使用一些可视化工具来验证网站加载速度，例如[http://Site-Perf.com/](http://Site-Perf.com/)

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-09-26T02:47:19.247

我强烈建议您查看[Yahoo CSS 和 JavaScript 压缩器](http://developer.yahoo.com/yui/compressor/)，它不仅会减少您的 CSS 和 JavaScript 文件大小，还会在您的代码中引发任何错误和可能的重复。任何 Web 开发人员的工具箱中的明确必须。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-09-26T03:32:30.603

如果问题出在控件本身，则可能是四处寻找新的供应商。我确实意识到这将涉及对时间和金钱的再投资，但如果您无法使用前面提到的压缩方法获得所需的结果，我可能需要提交下一次重大修订。

请记住，在可以的地方将 EnableViewstate 设置为 false

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-09-25T17:15:54.253

我会看一下页面上控件的 Viewstate。如果可能的话，您应该禁用它，因为它会被序列化（我认为是 Base64 编码）并填充在页面中。如果您在每次回发时更新控件中的数据，您应该能够安全地禁用视图状态并可能节省大量带宽。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2008-12-30T11:49:16.280

要加速网格的渲染，请使用网格分页。
网格分页将通过减少显示的网格线数量来减少渲染。

我们通常从每页 50 行开始，并始终将网格行数设置为系统参数，部署后可以轻松减少或增加。

在使用标准 ASP.NET 控件时，还发现使用 CSS 友好控件适配器时它们的速度更快。[CSS 友好的控制适配器](http://www.codeplex.com/cssfriendly/Release/ProjectReleases.aspx?ReleaseId=2159)

# iphone - 为 UITableView 使用 Interface Builder

> ID：134575
> 
> 赞同：9
> 
> 时间：2008-09-25T17:06:02.653
> 
> 标签：iphone, cocoa-touch, uitableview, interface-builder

我在 iPhone 开发学习过程中处于早期阶段。我正试图了解各种作品。现在，我刚刚采用了基本的 NavigationController 模板，并且正在尝试创建一个带有几个文本字段的简单分组表视图。我似乎无法做的是让 Interface Builder 允许我将 UITableViewCell 放入 UITableView 中，以便我可以向 Cell 添加一个文本字段。这甚至可能吗（似乎它应该被赋予 UITableViewCell 是一个可拖动控件的事实）？

如果不是，这是否意味着所有这些都是我需要自己编写的代码？

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2008-09-25T17:20:03.820

您可以使用 Interface Builder 创建单元格，但您必须使其成为顶级对象，而不是表视图的子项。然后您可以在视图控制器的**tableView:cellForRowAtIndexPath:**函数中返回此单元格。

确保在 Interface Builder 中为单元格提供一个**标识符**，然后使用与**dequeueReusableCellWithIdentifier 相同的标识符：（**请参阅示例代码以了解其工作原理 - 想法是单元格被重复使用 - 操作系统只会分配尽可能多的单元格立即适合屏幕。节省内存的巧妙方法。）

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-09-25T21:45:22.263

小心 Boot To The Head 的方法。如果您没有妥善处理您的`IBOutlets`. 我将在不发布代码 (NDA) 的情况下尽我所能解释这一点。如果您打算使用 IB 创建您的单元格，请制作`UITableViewCell`它自己的 Xib 文件。将文件的所有者设置为您的`UIViewController`子类（或`UITableController`）。调用类似的`IBOutlet`东西`UITableViewCell *cellFactory`。在`UITableViewDataSource`方法`tableView:cellForRowAtIndexPath:`中执行以下伪代码；

1.  尝试使用您在 IB 中设置的标识符使单元格出列
2.  如果成功，你就完成了。只需使用单元格
3.  否则，您需要创建一个新单元格。使用该`[NSBundle mainBundle] loadNibNamed:owner:options:`方法与您正确的 xib 文件在那里。这将用一个新的单元格填充 cellFactory ivar。棘手的部分来了。
4.  设置`cell = cellFactory`然后释放`cellFactory`并将其设置为 nil 以确保您不会意外再次使用它。您现在可以正常使用手机了

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-25T17:15:19.510

不幸的是，它并没有真正以这种方式工作 - 表格视图中的单元格是由委托在运行时生成的。不过，事实证明这是非常简单的代码。查看 tableview 示例代码，很容易理解。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-02T14:16:46.670

[这是一个很好的关于使用UITableView 的 UI builder 的](http://www.galloway.me.uk/tutorials/custom-uitableviewcell/)教程

# mysql - Applescriptable mySQL 客户端 - 低成本还是免费？

> ID：134580
> 
> 赞同：0
> 
> 时间：2008-09-25T17:06:32.607
> 
> 标签：mysql, macos, applescript

任何人都可以推荐 AppleScriptable 的 MySQL 前端客户端或 OS X 吗？最好是低成本或免费的。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-09-25T17:33:55.910

我建议只使用命令行 mysql 客户端并使用`do shell script`applescript 中的命令来调用它：

```
do shell script "mysql -e 'select * from customer'" 
```

# windows - Windows 上的 Gem 更新 - 是否损坏？

> ID：134581
> 
> 赞同：7
> 
> 时间：2008-09-25T17:06:36.583
> 
> 标签：windows, ruby, rubygems

[这是对这个问题](https://stackoverflow.com/questions/43778/sqlite3-ruby-gem-failed-to-build-gem-native-extension)的跟进。

当我在 Windows 上发出**`gem update`**命令时，只要它到达一个最新版本没有 Windows 二进制文件的 gem，它就会尝试构建本机扩展，这当然会失败。例如：

```
Updating sqlite3-ruby
Building native extensions.  This could take a while...
ERROR:  While executing gem ... (Gem::Installer::ExtensionBuildError)
  ERROR: Failed to build gem native extension.

c:/ruby/bin/ruby.exe extconf.rb update
checking for fdatasync() in rt.lib... no
checking for sqlite3.h... no

nmake
'nmake' is not recognized as an internal or external command,
operable program or batch file. 
```

要求所需平台的旧的 pre-1.x 行为至少使更新成为可能。现在我根本无法更新，除非我卸载麻烦的 gem（目前是 sqlite3-ruby 和 hpricot），运行更新，然后使用 --version 开关重新安装 gem。

有没有人有解决这个难题的方法，还是我们被困住了？

* * *

**笔记：**

```
$ gem -v
1.2.0

$ ruby -v
ruby 1.8.6 (2007-09-24 patchlevel 111) [i386-mswin32] 
```

* * *

**注意（2008 年 9 月 26 日）：**我刚刚更新到 gems 1.3.0，这个问题仍然存在。

**注意（2008 年 11 月 18 日）：**刚刚更新到 gems 1.3.1，问题仍然存在。

**注意（2009 年 4 月 28 日）：**最新版本的 Gems ( [1.3.2](http://blog.segment7.net/articles/2009/04/15/rubygems-1-3-2) ) 现在会跳过在更新期间构建原生扩展失败的任何 gem；换句话说，问题是固定的。万岁！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-09-27T21:22:09.843

Gems，从[1.3.2 版本](http://blog.segment7.net/articles/2009/04/15/rubygems-1-3-2)开始，现在将跳过无法构建的 gem，因此将 Rubygems 更新到最新版本，这里讨论的问题应该得到解决。

```
gem update --system 
```

***现在不推荐使用以下解决方案，但我将其留在这里记录。***

我在 Ruby 论坛（它是邮件列表的前端）上[启动了一个关于这个问题的线程。](http://www.ruby-forum.com/topic/166693)有一些有趣的讨论；值得一读。那里甚至有一个非常hacky的解决方案：

```
`gem.bat outdated`.split(/\n/).map{|z|z.scan(/^[^[:space:]]+/)}.flatten.each{|z| `gem.bat update #{z}`} 
```

它调用该`gem outdated`命令并构建所有过时 gem 的列表。然后它遍历列表并调用`gem update`每个单独的过时 gem。如果一个失败，它就会转移到下一个。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-09-25T21:21:06.737

看来我们被困住了。我在[这里](http://rubyforge.org/frs/?group_id=254)发现最后一个版本（1.2.4）没有mswin32 gem，我尝试将它安装在我的计算机上并遇到了同样的问题。

安装以前的版本可以正常工作：

```
gem install sqlite3-ruby --version '1.2.3' 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2010-09-22T19:07:21.217

执行以下命令，它应该可以工作：

```
gem install sqlite3-ruby --platform=mswin32 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-01T01:41:58.820

查看 sqlite3-ruby的[RubyForge 文件列表](http://rubyforge.org/frs/?group_id=254)可以发现 1.2.3 版包含使用 Visual Studio 6 和 MinGW 构建的 gem (sqlite3-ruby-1.2.3-mswin32.gem & sqlite3-ruby-1.2.3-x86- mingw32.gem）。但是，1.2.4 版没有任何此类预构建的 gem。

如果您安装了 Visual Studio 6 或[MinGW](http://www.mingw.org/)并设置了编译器环境变量（至少对于 Visual Studio 6 但不确定 MinGW），则应该在安装期间构建 gem。我不确定这些 gem 是否会在较新版本的 Visual Studio 下构建。

# mobile - 可以在各种移动 Web 浏览器中捕获签名吗？

> ID：134585
> 
> 赞同：24
> 
> 时间：2008-09-25T17:07:25.380
> 
> 标签：mobile, mobile-devices

我的公司正在考虑为现场数据输入提供一个轻量级的移动网站（我们已经有一个胖客户端移动应用程序）。一个硬性要求是我们必须能够捕获签名。

**是否有任何现有技术用于捕获签名，特别是在移动网络浏览器内运行的网页内，跨越各种移动设备/网络浏览器？** 我只要求浏览器内的解决方案，而不是胖客户端。

出于显而易见的原因，该设备将需要具有触摸屏。

当然，有很多很多不同的移动浏览器具有各种各样的功能。理想的解决方案将支持尽可能多的浏览器，并根据浏览器功能优雅地降级。

我已经知道某些版本的 Flash 可能会提供此类所需的绘图 API，假设所需设备的浏览器支持 Flash。

我还知道用于Windows Mobile 设备上[的 Pocket IE 的第三方 ActiveX/OCX 控件。](http://www.bennet-tec.com/btproducts/WebSignature)用户在使用前需要在浏览器中手动下载/安装控件。不幸，但可以接受。

我个人并不知道许多支持托管 Java 小程序的移动浏览器，但可能有一些。同样，基于对各种 Java API 的支持，这也许是一种可能的途径。

如果引擎和处理器在设备上足够强大，Javascript*可以做到这一点。*

最后，这里完全是白日梦，也许可以让用户使用移动设备的相机在一张普通的纸上为签名拍照，并以某种方式将其视为有效签名。但是，这将产生一个位图图像，而不是我可能在所有其他情况下收集的矢量。此外，如果不是不可能/不合理的话，将通过相机应用程序拍摄照片并使用网络浏览器应用程序上传，同时将该特定图像与正在捕获的其余数据相关联，这将是非常困难的。

谢谢。

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2010-11-11T11:12:20.290

现在有一个 jQuery 插件可以做到这一点 - > ~~[http://thomasjbradley.ca/lab/signature-pad](http://thomasjbradley.ca/lab/signature-pad)~~

截至 2016 年 3 月 17 日，上一个链接处于非活动状态，但相关存储库位于 GitHub 上：[https ://github.com/thomasjbradley/signature-pad](https://github.com/thomasjbradley/signature-pad)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-01T20:14:31.797

我认为图片的想法非常聪明，但我会更进一步。一些移动设备（尤其是手机）甚至不会在浏览器中上传文件。我会生成一个特定于操作的电子邮件地址，例如某种交易 ID 和用户 ID 的哈希值，并允许它作为电子邮件附件发送。这应该会捕获非常广泛的客户，并且不会增加可怕的复杂性。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2010-12-01T19:01:58.330

[thomas j bradley 的 jQuery 签名板插件](http://thomasjbradley.ca/lab/signature-pad)很棒而且很容易实现。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-01T08:14:55.270

首先，我是一名 C++ 开发人员，而不是 Web 开发人员，但我已经在 C++/MFC 中编写并部署了一个 Windows Mobile 签名捕获例程。如果您想使用或翻译代码，请告诉我，我将在此处发布。它不是特别优雅，但可以完成工作。基本上，您需要可用的按钮单击和鼠标移动消息。

已经走上了这条路，我的结论是，这不是对技术的充分利用。屏幕在签名捕获区域容易磨损且无响应，使其不仅无法用于签名捕获，而且无法用于其他操作。我们的经验是，对于移动销售人员类型的应用程序，它将手持设备的使用寿命限制在一年左右，导致用户不满意。

相机的想法似乎更聪明，不会破坏设备。IMO 你也会得到更好的签名，触摸屏的签名很糟糕。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2010-11-26T23:18:45.037

是的，找到了，这适用于 Android 2.1、2.2、iPhone。它工作得非常好，并带有用于将 JSON 保存的坐标转换为图像的 php 代码。 [http://thomasjbradley.ca/lab/signature-pad](http://thomasjbradley.ca/lab/signature-pad)

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2011-11-17T22:32:10.940

[http://mysignature.brinkster.net](http://mysignature.brinkster.net) - 不适用于移动浏览器 [http://thomasjbradley.ca/lab/signature-pad](http://thomasjbradley.ca/lab/signature-pad) - 不适用于 IE。它具有画布和闪存技术。IE 的画布标签有问题。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2016-12-15T00:27:59.437

所有这些答案都已过时。

目前最好的图书馆是 - [https://github.com/szimek/signature_pad](https://github.com/szimek/signature_pad)

[thomas bradley 的签名板不再维护](https://github.com/thread-pond/signature-pad/commit/6a17146f9b27632480d981259ee146b5ed8b49db)

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-10-03T18:56:10.017

如果不在网页上嵌入某些内容，唯一的方法就是使用 JavaScript。

不幸的是，大多数移动浏览器不支持 JavaScript，而且支持的浏览器也不是特别快。

我认为不可能基于当前存在的大多数设备创建通用解决方案。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-09-25T18:00:19.403

如果你说的是让它在各种移动浏览器上工作，我认为这在技术上是不可能的。大多数手机至少可以很容易地通过电子邮件发送图片，因此您可以随时将其发送到附件被转储到某处的某个帐户。尽管如此，您仍必须在主题中手动输入一些标识符。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2008-09-25T18:04:21.157

如果移动浏览器支持 javascript，那么您也许可以在某些触摸屏设备上执行此操作。否则必须使用插件、java、flash 或其他类似方法来完成。

使用 javascript，您可以查看“鼠标”在哪里。在某些设备上，如果用户使用触控笔在屏幕上按下，您可以捕捉鼠标移动并记录它们遵循的模式（签名）。

我怀疑某些移动浏览器不会将该信息传递到 javascript - 他们可能只会传递点击...

可能需要进行一些测试。

-亚当

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2012-06-01T20:00:43.917

带有 Flash 的 Canvas（通过 FlashCanvas）与 jSignature 一起为我们工作得很好。[http://willowsystems.github.com/jSignature/](http://willowsystems.github.com/jSignature/)

MIT + Works（专门为运行而编写）在任何有 Canvas 或 Flash 的地方。+ 在 iPad、iPhone、Android 平板电脑、手机上测试。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2014-08-04T18:10:17.680

您可能需要考虑开源 jQuery 插件：[https ://github.com/applicius/jquery.signfield/](https://github.com/applicius/jquery.signfield/)

# c# - WPF 中的 Google Maps-Like 滚动面板

> ID：134594
> 
> 赞同：17
> 
> 时间：2008-09-25T17:09:22.113
> 
> 标签：c#, .net, wpf

我有一个画布，我正在其中绘制一堆形状和其他 UI 元素。这个画布可能非常大，所以我想把它放在一个面板中，允许我使用鼠标放大/缩小并通过拖动鼠标滚动，就像谷歌地图一样。我能找到的最接近的东西是 ScrollViewer，但显然这还不够接近。

有没有人在 WPF 中做过这个并且有任何 XAML 和/或 C# 代码？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-09-25T18:19:18.123

[上周](https://stackoverflow.com/questions/67628/deepzoom-for-wpf)我问过 DeepZoom 是否计划用于 WPF（因为它在 Silverlight 上可用）。我收到了此代码的链接，这听起来很像您想要的解决方案： [在 WPF 中平移和缩放](http://blogs.windowsclient.net/joeyw/archive/2008/08/05/pan-and-zoom-deepzoom-style-in-wpf.aspx)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-09-25T17:39:27.753

这个链接会有帮助吗？我还没有进入 WPF，但快速搜索会产生这个链接，希望它可以帮助你：

[http://blogs.vertigo.com/personal/swarren/Blog/Lists/Posts/Post.aspx?ID=7](http://blogs.vertigo.com/personal/swarren/Blog/Lists/Posts/Post.aspx?ID=7)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-09-25T19:40:27.570

我认为您在使用带有 ScrollViewer 的大画布/网格时走在正确的轨道上。我最近使用相同的设置做了类似的事情。

对于放大和缩小，您可以在画布的 LayoutTransform 属性中使用 ScaleTransform，然后将其连接到 MouseWheel 事件。您可以将 ScaleX 和 ScaleY 更改为“放大”和缩小，画布的所有子元素也将“放大”。

对于平移，您可以在 ScrollViewer 中隐藏滚动条，并使用 MouseMove 事件调用 ScrollViewers ScrollToHorizo​​ntalOffset() 函数以编程方式移动滚动条。使用“最佳解决方案”发布的链接，这正是如何做到的。

如果我在我的开发机器上，我可以给你一些示例代码。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-09-25T17:49:45.077

您需要的是一个“虚拟化画布面板”请在此处查看示例[http://blogs.msdn.com/jgoldb/archive/2008/03/08/performant-virtualized-wpf-canvas.aspx](http://blogs.msdn.com/jgoldb/archive/2008/03/08/performant-virtualized-wpf-canvas.aspx)

更多关于 VirtualizingPanel [http://blogs.msdn.com/dancre/archive/2006/02/06/526310.aspx](http://blogs.msdn.com/dancre/archive/2006/02/06/526310.aspx)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-09-25T17:48:20.633

如果我没记错这里你可以找到你想要的东西。

[http://www.codeproject.com/KB/vista/swordfishcharts.aspx](http://www.codeproject.com/KB/vista/swordfishcharts.aspx)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-09-26T17:43:06.447

查看 Sacha 的[这篇](http://www.codeproject.com/KB/WPF/SpiderControl.aspx)CodeProject 文章...他有一个 FrictionScrollViewer，通过拖动鼠标进行滚动（也支持一些物理...）

# c# - 处理多语言支持的最佳方式？

> ID：134615
> 
> 赞同：3
> 
> 时间：2008-09-25T17:13:24.867
> 
> 标签：c#, internationalization

我一直在寻找关于如何在我的小应用程序上支持 i18n...

我知道 Microsoft 提供“文化”类，但您必须重新编译您的应用程序以包含您添加的任何新字符串。所以，我要做的就是将我所有的字符串放在一个外部文件中，并为用户提供翻译应用程序的选择，而无需重新编译。

有没有简单的方法来处理这个？使用 XML 还是类似 INI 的？任何可用的教程？PS：尝试在 C# 上执行此操作...不要打扰其他语言

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-09-25T17:20:04.727

这是 Scott Hanselman 的一篇不错的博客文章，其中包含几个很好的资源： [http ://www.hanselman.com/blog/ASPNETInternationalizationGlobalizationAndLocalizationWhew.aspx](http://www.hanselman.com/blog/ASPNETInternationalizationGlobalizationAndLocalizationWhew.aspx)

一般来说，我可以说您希望将资源保留在二进制文件之外（使用 .resource 文件之类的文件），这将允许您在不重新编译的情况下添加/编辑资源。我自己做的不多，所以我对整个事情有点生疏。

希望这会有所帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-09-25T17:19:36.630

如果您在应用程序中包含一个新字符串，无论如何您都必须重新编译它，不是吗？

如果您经常添加语言，资源文件和/或附属 DLL 可能是您最好的选择

否则，您可以编写自己的提供程序。以下是我发现有用的一些链接，您的里程可能会有所不同：

[http://en.csharp-online.net/Localization_Like_the_Pros](http://en.csharp-online.net/Localization_Like_the_Pros)

[http://www.devhood.com/tutorials/tutorial_details.aspx?tutorial_id=211](http://www.devhood.com/tutorials/tutorial_details.aspx?tutorial_id=211)

[http://www.codeproject.com/KB/aspnet/DeclarativeGlobalization.aspx](http://www.codeproject.com/KB/aspnet/DeclarativeGlobalization.aspx)

[网页的 MS 工具包](http://msdn.microsoft.com/en-us/library/aa479334.aspx)

[CE 解决方案](http://www.codeproject.com/KB/locale/celocalization.aspx)

# python - 哪个更可取：lambda 函数或嵌套函数（'def'）？

> ID：134626
> 
> 赞同：121
> 
> 时间：2008-09-25T17:15:03.240
> 
> 标签：python, syntax, function, lambda

我主要使用 lambda 函数，但有时使用似乎提供相同行为的嵌套函数。

以下是一些简单的例子，如果在另一个函数中找到它们，它们在功能上会做同样的事情：

**Lambda 函数**

```
>>> a = lambda x : 1 + x
>>> a(5)
6 
```

**嵌套函数**

```
>>> def b(x): return 1 + x

>>> b(5)
6 
```

使用其中一种是否有优势？（性能？可读性？限制？一致性？等）

这还重要吗？如果没有，那是否违反了 Pythonic 原则：

> [应该有一种——最好只有一种——明显的方法来做到这一点。](https://www.python.org/dev/peps/pep-0020/).

* * *

## 回答 #1

> 赞同：126
> 
> 时间：2008-09-25T17:16:31.257

如果您需要将 分配`lambda`给名称，请改用 a `def`。`def`s 只是赋值的语法糖，所以结果是一样的，而且它们更加灵活和可读。

`lambda`s 可以*使用一次，扔掉*没有名字的函数。

但是，这种用例非常罕见。您很少需要传递未命名的函数对象。

内置函数`map()`和`filter()`需要函数对象，但**列表推导**和**生成器表达式**通常比这些函数更具可读性，并且可以覆盖所有用例，而不需要 lambda。

对于你真的需要一个小函数对象的情况，你应该使用`operator`模块函数，比如`operator.add`而不是`lambda x, y: x + y`

如果您仍然需要一些`lambda`未涵盖的内容，您可以考虑编写一个`def`，只是为了更具可读性。如果函数比`operator`模块中的函数更复杂，a`def`可能更好。

因此，现实世界中好的`lambda`用例非常罕见。

* * *

## 回答 #2

> 赞同：35
> 
> 时间：2008-09-26T10:20:43.307

实际上，对我来说有两个不同之处：

首先是关于他们做什么以及他们返回什么：

*   def 是一个不返回任何内容并在本地命名空间中创建一个“名称”的关键字。

*   lambda 是一个关键字，它返回一个函数对象，并且不会在本地命名空间中创建一个“名称”。

因此，如果您需要调用一个带有函数对象的函数，那么在一行 python 代码中执行此操作的唯一方法是使用 lambda。def 没有等价物。

在某些框架中，这实际上很常见；例如，我经常使用[Twisted](http://twistedmatrix.com/)，所以做类似的事情

```
d.addCallback(lambda result: setattr(self, _someVariable, result)) 
```

很常见，并且使用 lambdas 更简洁。

第二个区别是关于允许实际功能做什么。

*   用'def'定义的函数可以包含任何python代码
*   使用 'lambda' 定义的函数必须计算为表达式，因此不能包含诸如 print、import、raise 等语句。

例如，

```
def p(x): print x 
```

按预期工作，而

```
lambda x: print x 
```

是一个语法错误。

当然，有一些解决方法 -`print`用`sys.stdout.write`或`import`替换`__import__`。但通常在这种情况下你最好使用一个函数。

* * *

## 回答 #3

> 赞同：27
> 
> 时间：2008-09-25T17:29:26.450

[在这次采访中，](http://www.linuxjournal.com/article/2959) Guido van Rossum 说他希望他没有让 'lambda' 进入 Python：

> ” **Q. Python 的哪个特性你最不满意？**
> 
> 有时我接受贡献太快了，后来意识到这是一个错误。一个例子是函数式编程特性，比如 lambda 函数。是一个关键字，可让您创建小型匿名函数；内置函数（如 map、filter 和 reduce）在序列类型（如列表）上运行函数。
> 
> 在实践中，结果并不是那么好。Python 只有两个作用域：本地和全局。这使得编写 lambda 函数很痛苦，因为您经常希望访问定义 lambda 的范围内的变量，但由于有两个范围，您不能。有一种方法可以解决这个问题，但它有点像一个kludge。通常，在 Python 中使用 for 循环而不是使用 lambda 函数似乎更容易。只有当已经有一个内置功能可以满足您的需求时，地图和朋友才能正常工作。

恕我直言，Iambas 有时会很方便，但通常会以牺牲可读性为代价。你能告诉我这是做什么的吗：

```
str(reduce(lambda x,y:x+y,map(lambda x:x**x,range(1,1001))))[-10:] 
```

我写了它，我花了一分钟才弄明白。这是来自 Project Euler - 我不会说是哪个问题，因为我讨厌剧透，但它在 0.124 秒内运行 :)

* * *

## 回答 #4

> 赞同：12
> 
> 时间：2012-08-16T13:16:40.080

对于 n=1000，这是调用函数与 lambda 的一些时间：

```
In [11]: def f(a, b):
             return a * b

In [12]: g = lambda x, y: x * y

In [13]: %%timeit -n 100
for a in xrange(n):
  for b in xrange(n):
    f(a, b)
   ....:
100 loops, best of 3: 285 ms per loop

In [14]: %%timeit -n 100
for a in xrange(n):
  for b in xrange(n):
    g(a, b)
   ....:
100 loops, best of 3: 298 ms per loop

In [15]: %%timeit -n 100
for a in xrange(n):
  for b in xrange(n):
    (lambda x, y: x * y)(a, b)
   ....:
100 loops, best of 3: 462 ms per loop 
```

* * *

## 回答 #5

> 赞同：11
> 
> 时间：2018-03-27T19:03:16.740

> ## 更可取的是：lambda 函数还是嵌套函数 ( `def`)？

与常规函数相比，使用 lambda 有一个优点：它们是在表达式中创建的。

有几个缺点：

*   没有名字（只是`'<lambda>'`）
*   没有文档字符串
*   没有注释
*   没有复杂的陈述

它们也是相同类型的对象。`def`由于这些原因，我通常更喜欢使用关键字而不是 lambdas创建函数。

## 第一点 - 它们是相同类型的对象

lambda 产生与常规函数相同类型的对象

```
>>> l = lambda: 0
>>> type(l)
<class 'function'>
>>> def foo(): return 0
... 
>>> type(foo)
<class 'function'>
>>> type(foo) is type(l)
True 
```

由于 lambda 是函数，因此它们是一流的对象。

lambda 和函数：

*   可以作为参数传递（与常规函数相同）
*   当在外部函数中创建时，成为该外部函数局部变量的闭包

但是默认情况下，lambdas 缺少函数通过完整函数定义语法获得的一些东西。

### 兰巴`__name__`是`'<lambda>'`

毕竟，Lambda 是匿名函数，所以它们不知道自己的名字。

```
>>> l.__name__
'<lambda>'
>>> foo.__name__
'foo' 
```

因此无法在它们的命名空间中以编程方式查找 lambda。

这限制了某些事情。例如，`foo`可以用序列化代码查找，而`l`不能：

```
>>> import pickle
>>> pickle.loads(pickle.dumps(l))
Traceback (most recent call last):
  File "<stdin>", line 1, in <module>
_pickle.PicklingError: Can't pickle <function <lambda> at 0x7fbbc0464e18>: 
attribute lookup <lambda> on __main__ failed 
```

我们可以`foo`很好地查找——因为它知道自己的名字：

```
>>> pickle.loads(pickle.dumps(foo))
<function foo at 0x7fbbbee79268> 
```

### Lambda 没有注释，也没有文档字符串

基本上，没有记录 lambda。让我们重写`foo`以更好地记录：

```
def foo() -> int:
    """a nullary function, returns 0 every time"""
    return 0 
```

现在， foo 有文档：

```
>>> foo.__annotations__
{'return': <class 'int'>}
>>> help(foo)
Help on function foo in module __main__:

foo() -> int
    a nullary function, returns 0 every time 
```

然而，我们没有相同的机制来向 lambdas 提供相同的信息：

```
>>> help(l)
Help on function <lambda> in module __main__:

<lambda> lambda (...) 
```

但我们可以破解它们：

```
>>> l.__doc__ = 'nullary -> 0'
>>> l.__annotations__ = {'return': int}
>>> help(l)
Help on function <lambda> in module __main__:

<lambda> lambda ) -> in
    nullary -> 0 
```

但是，可能有一些错误会弄乱帮助的输出。

### Lambda 只能返回一个表达式

Lambda 不能返回复杂的语句，只能返回表达式。

```
>>> lambda: if True: 0
  File "<stdin>", line 1
    lambda: if True: 0
             ^
SyntaxError: invalid syntax 
```

诚然，表达式可能相当复杂，如果您*非常*努力，您可能可以使用 lambda 完成相同的任务，但增加的复杂性更不利于编写清晰的代码。

为了清晰和可维护性，我们使用 Python。过度使用 lambda 可能会对此产生不利影响。

### lambda的*唯一优点：可以在单个表达式中创建*

这是唯一可能的好处。由于您可以使用表达式创建 lambda，因此您可以在函数调用中创建它。

在函数调用中创建函数避免了（廉价的）名称查找，而不是在其他地方创建的。

但是，由于 Python 是经过严格评估的，因此除了避免名称查找之外，这样做没有其他性能提升。

对于一个非常简单的表达式，我可能会选择一个 lambda。

在进行交互式 Python 时，我也倾向于使用 lambda，以避免在需要时使用多行代码。当我想在调用时将参数传递给构造函数时，我使用以下类型的代码格式`timeit.repeat`：

```
import timeit

def return_nullary_lambda(return_value=0):
    return lambda: return_value

def return_nullary_function(return_value=0):
    def nullary_fn():
        return return_value
    return nullary_fn 
```

现在：

```
>>> min(timeit.repeat(lambda: return_nullary_lambda(1)))
0.24312214995734394
>>> min(timeit.repeat(lambda: return_nullary_function(1)))
0.24894469301216304 
```

我相信上面的微小时间差异可以归因于名称查找`return_nullary_function`- 请注意，它*非常*微不足道。

## 结论

Lambda 适用于您希望最小化代码行以支持创建奇异点的非正式情况。

Lambda 不适用于更正式的情况，在这种情况下，您需要让稍后出现的代码编辑器更加清晰，尤其是在它们不重要的情况下。

我们知道我们应该给我们的对象起个好名字。*当对象没有*名称时，我们怎么能这样做呢？

`def`由于所有这些原因，我通常更喜欢使用 with而不是 with创建函数`lambda`。

* * *

## 回答 #6

> 赞同：8
> 
> 时间：2016-02-11T18:14:36.767

*表现：*

使用 创建函数比使用 创建函数`lambda`要*快*`def`一些。不同之处在于`def`在 locals 表中创建了一个名称条目。结果函数具有相同的执行速度。

* * *

可读性：

对于大多数 Python 用户而言，Lambda 函数的可读性稍差，但在某些情况下也更加简洁。考虑从使用非功能性例程转换为功能性例程：

```
# Using non-functional version.

heading(math.sqrt(v.x * v.x + v.y * v.y), math.atan(v.y / v.x))

# Using lambda with functional version.

fheading(v, lambda v: math.sqrt(v.x * v.x + v.y * v.y), lambda v: math.atan(v.y / v.x))

# Using def with functional version.

def size(v):
    return math.sqrt(v.x * v.x + v.y * v.y)

def direction(v):
    return math.atan(v.y / v.x)

deal_with_headings(v, size, direction) 
```

如您所见，该`lambda`版本更短且“更容易”，因为您只需添加`lambda v:`到原始非功能版本即可转换为功能版本。它也更加简洁。但是请记住，很多 Python 用户会对 lambda 语法感到困惑，因此您在长度和实际复杂性方面损失的内容可能会在其他编码人员的困惑中重新获得。

* * *

限制：

*   `lambda`函数只能使用一次，除非分配给变量名。
*   `lambda`分配给变量名的函数与函数相比没有优势`def`。
*   `lambda`函数可能很难或不可能腌制。
*   `def`必须仔细选择函数的名称，使其具有合理的描述性和唯一性，或者至少在范围内未使用。

* * *

一致性：

Python 大多避免函数式编程约定，转而支持过程和更简单的目标语义。运营商与这种`lambda`偏见形成鲜明对比。此外，作为已经流行的替代方法`def`，该`lambda`函数为您的语法增加了多样性。有些人会认为这不太一致。

* * *

已有功能：

正如其他人所指出的，`lambda`该领域中的许多用途可以由`operator`或其他模块的成员代替。例如：

```
do_something(x, y, lambda x, y: x + y)
do_something(x, y, operator.add) 
```

在许多情况下，使用预先存在的函数可以使代码更具可读性。

* * *

Pythonic 原则：“应该有一种——最好只有一种——明显的方法”</p>

这类似于[真理](https://en.wikipedia.org/wiki/Single_source_of_truth)教义的单一来源。不幸的是，single-obvious-way-to-do-it 原则一直是 Python 的一种渴望，而不是真正的指导原则。考虑一下 Python 中非常强大的数组解析。它们在功能上等同于`map`和`filter`功能：

```
[e for e in some_array if some_condition(e)]
filter(some_array, some_condition) 
```

`lambda`并且`def`是相同的。

这是一个见仁见智的问题，但我会说 Python 语言中的任何用于一般用途的东西，但显然不会破坏任何东西，这已经足够“Pythonic”了。

* * *

## 回答 #7

> 赞同：6
> 
> 时间：2008-09-25T17:19:48.253

我同意 nosklo 的建议：如果您需要为函数命名，请使用`def`. `lambda`我为我只是将一小段代码传递给另一个函数的情况保留函数，例如：

```
a = [ (1,2), (3,4), (5,6) ]
b = map( lambda x: x[0]+x[1], a ) 
```

* * *

## 回答 #8

> 赞同：6
> 
> 时间：2013-12-27T10:54:37.633

虽然同意其他答案，但有时它更具可读性。`lambda`这是一个派上用场的示例，在一个用例中，我不断遇到 N 维[`defaultdict`](http://docs.python.org/2/library/collections.html#collections.defaultdict)。
这是一个例子：

```
from collections import defaultdict
d = defaultdict(lambda: defaultdict(list))
d['Foo']['Bar'].append(something) 
```

我发现它比`def`为第二维创建更具可读性。这对于更高的维度更为重要。

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2008-09-25T19:13:39.320

lambda 的主要用途一直是简单的回调函数，以及需要函数作为参数的 map、reduce、filter。随着列表推导成为规范，并且添加了允许，如下所示：

```
x = [f for f in range(1, 40) if f % 2] 
```

很难想象在日常使用中使用 lambda 的真实案例。因此，我会说，避免使用 lambda 并创建嵌套函数。

* * *

## 回答 #10

> 赞同：3
> 
> 时间：2009-06-17T00:02:38.453

lambda 的一个重要限制是它们不能包含除表达式之外的任何内容。除了微不足道的副作用之外，lambda 表达式几乎不可能产生任何东西，因为它不可能拥有像`def`'ed 函数那样丰富的主体。

话虽如此，Lua 影响了我广泛使用匿名函数的编程风格，我在代码中乱扔垃圾。最重要的是，我倾向于以我不考虑列表推导或生成器的方式将 map/reduce 视为抽象运算符，就像我通过使用这些运算符显式推迟实现决策一样。

**编辑：**这是一个相当古老的问题，我对此事的看法有所改变。

首先，我强烈反对将`lambda`表达式分配给变量；因为 python 有一个特殊的语法（提示，`def`）。除此之外，lambda 的许多用途，即使它们没有名字，也有预定义（并且更有效）的实现。例如，有问题的示例可以缩写为 just `(1).__add__`，而无需将其包装在`lambda`or`def`中。许多其他常见用途可以通过`operator`,`itertools`和`functools`模块的某种组合来满足。

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2018-07-26T10:43:23.490

*   计算时间。
*   没有名字的函数。
*   实现一功能多用功能。

考虑一个简单的例子，

```
# CREATE ONE FUNCTION AND USE IT TO PERFORM MANY OPERATIONS ON SAME TYPE OF DATA STRUCTURE.
def variousUse(a,b=lambda x:x[0]):
    return [b(i) for i in a]

dummyList = [(0,1,2,3),(4,5,6,7),(78,45,23,43)]
variousUse(dummyList)                           # extract first element
variousUse(dummyList,lambda x:[x[0],x[2],x[3]]) # extract specific indexed element
variousUse(dummyList,lambda x:x[0]+x[2])        # add specific elements
variousUse(dummyList,lambda x:x[0]*x[2])        # multiply specific elements 
```

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2008-11-18T07:19:32.897

如果您只是要将 lambda 分配给本地范围内的变量，您也可以使用 def，因为它更具可读性并且将来可以更容易地扩展：

```
fun = lambda a, b: a ** b # a pointless use of lambda
map(fun, someList) 
```

或者

```
def fun(a, b): return a ** b # more readable
map(fun, someList) 
```

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2015-10-21T21:37:03.317

我发现 lambda 的一种用途是在调试消息中。

由于可以懒惰地评估 lambda，因此您可以使用如下代码：

```
log.debug(lambda: "this is my message: %r" % (some_data,)) 
```

而不是可能很昂贵：

```
log.debug("this is my message: %r" % (some_data,)) 
```

即使调试调用由于当前的日志记录级别而没有产生输出，它也会处理格式字符串。

当然，要使其按照描述的方式工作，正在使用的日志记录模块必须支持 lambdas 作为“惰性参数”（就像我的日志记录模块一样）。

相同的想法可以应用于任何其他用于按需内容价值创造的惰性评估情况。

例如这个自定义三元运算符：

```
def mif(condition, when_true, when_false):
    if condition:
         return when_true()
    else:
         return when_false()

mif(a < b, lambda: a + a, lambda: b + b) 
```

代替：

```
def mif(condition, when_true, when_false):
    if condition:
         return when_true
    else:
         return when_false

mif(a < b, a + a, b + b) 
```

使用 lambdas 只有条件选择的表达式将被评估，没有 lambdas 都将被评估。

当然，您可以简单地使用函数而不是 lambda，但对于短表达式，lambda 更 (c) 更简洁。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2008-09-25T20:26:14.777

我同意诺斯克洛。顺便说一句，即使*使用一次，丢弃*功能，大多数时候您只想使用操作员模块中的某些东西。

例如：

你有一个带有这个签名的函数：myFunction(data, callback function)。

您想传递一个添加 2 个元素的函数。

使用 lambda ：

```
myFunction(data, (lambda x, y : x + y)) 
```

蟒蛇方式：

```
import operator
myFunction(data, operator.add) 
```

当然，这是一个简单的例子，但是 operator 模块提供了很多东西，包括 list 和 dict 的项目 setter / getter。真的很酷。

* * *

## 回答 #15

> 赞同：-1
> 
> 时间：2017-10-18T12:03:38.363

一个主要的区别是你不能使用`def`内联函数，在我看来这是函数最方便的用例`lambda`。例如，在对对象列表进行排序时：

```
my_list.sort(key=lambda o: o.x) 
```

因此，我建议将 lambdas 用于此类琐碎的操作，这也不会真正受益于通过命名函数提供的自动文档。

* * *

## 回答 #16

> 赞同：-2
> 
> 时间：2009-04-25T08:35:43.980

lambda 对于生成新函数很有用：

```
>>> def somefunc(x): return lambda y: x+y
>>> f = somefunc(10)
>>> f(2)
12
>>> f(4)
14 
```

# python - 如何将 django.core.urlresolvers.reverse 与函数引用而不是命名的 URL 模式一起使用？

> ID：134629
> 
> 赞同：10
> 
> 时间：2008-09-25T17:15:23.537
> 
> 标签：python, django

在我的`urls.py`文件中，我有：

```
from myapp import views
...
(r'^categories/$', views.categories) 
```

`categories`里面的视图函数在哪里`myapp/views.py`。没有其他 URLconf 行参考`views.categories`。

在一个单元测试文件中，我试图使用 来获取这个 URL `django.core.urlresolvers.reverse()`，而不是仅仅复制 '/categories/' （DRY 和所有这些）。所以我有：

```
from django.core.urlresolvers import reverse
from myapp import views
...

url = reverse(views.categories) 
```

当我运行我的测试时，我得到一个`NoReverseMatch`错误：

```
NoReverseMatch: Reverse for '<function categories at 0x1082f30>' with arguments '()' and keyword arguments '{}' not found. 
```

如果我将 URL 模式设为命名模式，它匹配得很好，如下所示：

```
url(r'^categories/$', views.categories, 'myapp-categories') 
```

并使用模式名称来匹配它：

```
url = reverse('myapp-categories') 
```

但据我从文档中可以看出[，`reverse`我](http://docs.djangoproject.com/en/dev/topics/http/urls/#reverse)不需要将其设为命名 URL 模式即可使用`reverse`。

任何想法我做错了什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-09-25T22:55:44.153

Jack M. 的例子几乎是正确的。

如果要使用命名 url，它必须是 url 函数，而不是元组。

```
url(r'^no_monkeys/$', 'views.noMonkeys', {}, "no-monkeys"), 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-09-28T19:56:18.793

经过进一步调查，事实证明这是我如何导入视图模块的问题：

[如何成功地将函数引用传递给 Django 的 reverse() 函数？](https://stackoverflow.com/questions/146522/how-do-i-successfully-pass-a-function-reference-to-djangos-reverse-function)

不过，感谢您的帮助，伙计们：您启发了我正确看待它。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-25T20:39:30.517

这确实有效，并且您粘贴的所有代码都是正确的并且工作正常（我只是将它复制到一个干净的测试/项目应用程序中，它反转了 URL 没有任何问题）。所以这里还有一些你没有向我们展示的东西。简化到最基本的基础直到它起作用，然后开始重新添加复杂性，看看它在哪里崩溃。

此外，您可以执行“./manage.py shell”，然后交互式地导入反向函数和您的视图函数并尝试反向。这将删除测试设置作为可能的原因。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2008-09-25T17:18:16.197

reverse 函数实际上使用了 URL 的“名称”。这是这样定义的：

```
urlpatterns = patterns('',
    (r'^no_monkeys/$', 'views.noMonkeys', {}, "no-monkeys"),
    (r'^admin/(.*)', admin.site.root),
) 
```

现在您将使用字符串“no-monkeys”调用 reverse 以获取正确的 url。

Ninja Edit： [这里是](http://docs.djangoproject.com/en/dev/topics/http/urls/#id2)关于该主题的 django 文档的链接。

# .net - 是否可以使用 .NET 泛型类实现 COM 接口？

> ID：134633
> 
> 赞同：8
> 
> 时间：2008-09-25T17:15:43.863
> 
> 标签：.net, generics, com, comvisible

我有以下界面，我试图使 COM 可见。当我尝试生成类型库时，它不喜欢我的实现类派生自泛型类的事实。

是否可以将泛型类用作 COM 实现类？（我知道我可以编写一个非通用包装器并将其导出到 COM，但这增加了另一个我宁愿不做的层。）

```
[ComVisible(true)]
public interface IMyClass
{
   ...
}

[ComVisible(true), ComDefaultInterface(typeof(IMyClass))]
[ClassInterface(ClassInterfaceType.None)]
public class MyClass : BaseClass<IMyClass>, IMyClass
{
   ...
} 
```

错误信息：

```
警告：类型库导出器遇到派生的类型
来自泛型类，未标记为
[ClassInterface(ClassInterfaceType.None)]。类接口不能
暴露于此类类型。考虑用
[ClassInterface(ClassInterfaceType.None)]
并将显式接口作为默认接口公开给
COM 使用 ComDefaultInterface 属性。
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-09-25T17:41:52.957

不能导出泛型类型和派生自泛型类型的类型。设置`ComVisible(false)`你的`MyClass`类型。您需要创建非泛型类实现或仅使用接口。

# c# - 检查集合中的重复项

> ID：134644
> 
> 赞同：4
> 
> 时间：2008-09-25T17:17:06.387
> 
> 标签：c#, .net, .net-2.0

假设你有一个`Foo`类的集合：

```
class Foo
{
    public string Bar;
    public string Baz;
}

List<Foo> foolist; 
```

并且您想检查此集合以查看另一个条目是否具有匹配的`Bar`.

```
bool isDuplicate = false;
foreach (Foo f in foolist)
{
     if (f.Bar == SomeBar)
     {
         isDuplicate = true;
         break;
     }
} 
```

`Contains()`不起作用，因为它比较了整个类。

有没有人有更好的方法来做到这一点，适用于 .NET 2.0？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2008-09-25T17:26:33.570

```
fooList.Exists(item => item.Bar == SomeBar) 
```

这不是 LINQ，而是一个 Lambda 表达式，但是，它使用了 v3.5 特性。没问题：

```
fooList.Exists(delegate(Foo Item) { return item.Bar == SomeBar}); 
```

这应该在 2.0 中有效。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-09-25T17:20:42.180

实现[IEqualityComparer<T>](http://msdn.microsoft.com/en-us/library/ms132151.aspx)接口，并使用匹配的[Contains](http://msdn.microsoft.com/en-us/library/bb339118.aspx)方法。

```
public class MyFooComparer: IEqualityComparer<Foo> {

   public bool Equals(Foo foo1, Foo foo2) {
      return Equals(foo1.Bar, foo2.Bar);
   }

   public int GetHashCode(Foo foo) {
      return foo.Bar.GetHashCode();
   }
}

Foo exampleFoo = new Foo();
exampleFoo.Bar = "someBar";
if(myList.Contains(exampleFoo, new MyFooComparer())) {
    ...
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-25T17:19:28.237

fooList.Exists(item => item.Bar == SomeBar)

或与匿名代表

fooList.Exists(delegate(Foo item) {return item.Bar == SomeBar;})

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-25T17:20:49.857

如果您需要该元素，您还可以使用 List.Find() 并传入一个委托，该委托为您的“匹配”定义返回 true ( [http://msdn.microsoft.com/en-us/library/x0b5b5bc。 .aspx](http://msdn.microsoft.com/en-us/library/x0b5b5bc.aspx)）。

有一个如何在该 MSDN 文档上定义委托的示例。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-09-25T17:21:22.740

如果您的类的“Bar”是唯一的（类 Foo 的键），那么您可以尝试实现 System.Collections.ObjectModel.KeyedCollection。这很简单：只需实现 GetKeyForItem() 方法。

```
class Foo
{
    public string Bar;
    public string Baz;
}

class FooList : KeyedCollection<string, Foo>
{
    protected override string GetKeyForItem(Foo item)
    {
        return item.Bar;
    }
}

FooList fooList; 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-09-25T17:33:22.463

如果您在 Foo 上覆盖 Equals 以在 Bar 上创建键，则 Contains() 将起作用。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-09-25T18:37:35.867

如果您可以使用 LINQ，则可以执行以下操作：

```
bool contains = foolist.Where(f => f.Bar == someBar).Count() != 0; 
```

* * *

## 回答 #8

> 赞同：-1
> 
> 时间：2008-09-25T17:20:07.253

您可能想要使用 C5.HashSet，并为 Foo 实现 Equals 和 GetHashCode()。

# perl - 如何使用 Perl 搜索归档文件

> ID：134650
> 
> 赞同：3
> 
> 时间：2008-09-25T17:17:59.083
> 
> 标签：perl, search, file-io, compression

使用 Perl 阅读压缩目录内容的首选方法是什么？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-09-25T17:19:06.913

CPAN 上有几个模块用于处理各种存档格式（zip、tar 等），您可能需要的是[Archive::Zip](http://search.cpan.org/~adamk/Archive-Zip-1.24/lib/Archive/Zip.pm)。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-09-25T20:22:49.873

存档::Zip

```
require Archive::Zip;
my $zip = Archive::Zip->new($somefile);
for($zip->memberNames()) {
  print "$_\n";
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-25T18:32:40.213

如果您想要 .tar.gz 存档的内容

```
open(DIR_LISTING, "gzip -dc concert25.tgz | tar -tf -|") || die;
while (<DIR_LISTING>) {
   print;
}
close (DIR_LISTING); 
```

# c# - 终结器在其对象仍在使用时启动

> ID：134653
> 
> 赞同：5
> 
> 时间：2008-09-25T17:18:24.713
> 
> 标签：c#, .net, garbage-collection, finalization

**摘要：** C#/.NET 应该是垃圾收集。C# 有一个析构函数，用于清理资源。当对象 A 在我尝试克隆其变量成员之一的同一行被垃圾收集时会发生什么？显然，在多处理器上，有时垃圾收集器会获胜......

**问题**

今天，在 C# 培训课程中，老师向我们展示了一些代码，这些代码只有在多处理器上运行时才会包含错误。

我会总结说，有时，编译器或 JIT 在从其调用的方法返回之前调用 C# 类对象的终结器会搞砸。

Visual C++ 2005 文档中给出的完整代码将作为“答案”发布，以避免提出非常大的问题，但基本内容如下：

下面的类有一个“哈希”属性，它将返回一个内部数组的克隆副本。在构造函数中，数组的第一项值为 2。在析构函数中，它的值设置为零。

关键是：如果您尝试获取“示例”的“哈希”属性，您将获得数组的一个干净副本，其第一项仍然是 2，因为正在使用该对象（因此，不是垃圾收集/完成）：

```
public class Example
{
    private int nValue;
    public int N { get { return nValue; } }

    // The Hash property is slower because it clones an array. When
    // KeepAlive is not used, the finalizer sometimes runs before 
    // the Hash property value is read.

    private byte[] hashValue;
    public byte[] Hash { get { return (byte[])hashValue.Clone(); } }

    public Example()
    {
        nValue = 2;
        hashValue = new byte[20];
        hashValue[0] = 2;
    }

    ~Example()
    {
        nValue = 0;

        if (hashValue != null)
        {
            Array.Clear(hashValue, 0, hashValue.Length);
        }
    }
} 
```

但没有什么比这更简单了......使用这个类的代码在一个线程中运行，当然，对于测试，该应用程序是高度多线程的：

```
public static void Main(string[] args)
{
    Thread t = new Thread(new ThreadStart(ThreadProc));
    t.Start();
    t.Join();
}

private static void ThreadProc()
{
    // running is a boolean which is always true until
    // the user press ENTER
    while (running) DoWork();
} 
```

DoWork 静态方法是发生问题的代码：

```
private static void DoWork()
{
    Example ex = new Example();

    byte[] res = ex.Hash; // [1]

    // If the finalizer runs before the call to the Hash 
    // property completes, the hashValue array might be
    // cleared before the property value is read. The 
    // following test detects that.

    if (res[0] != 2)
    {
        // Oops... The finalizer of ex was launched before
        // the Hash method/property completed
    }
} 
```

显然，每执行 1,000,000 次 DoWork，垃圾收集器就会施展魔法，并尝试回收“ex”，因为它不再在函数的剩余代码中被引用，而这一次，它比“Hash”更快获取方法。所以我们最终得到的是一个零字节数组的克隆，而不是正确的（第一项在 2）。

我的猜测是代码的内联，它基本上将 DoWork 函数中标记为 [1] 的行替换为以下内容：

```
 // Supposed inlined processing
    byte[] res2 = ex.Hash2;
    // note that after this line, "ex" could be garbage collected,
    // but not res2
    byte[] res = (byte[])res2.Clone(); 
```

如果我们假设 Hash2 是一个简单的访问器，编码如下：

```
// Hash2 code:
public byte[] Hash2 { get { return (byte[])hashValue; } } 
```

所以，问题是：**这是否应该在 C#/.NET 中以这种方式工作，或者这是否可以被视为 JIT 编译器的错误？**

# 编辑

有关解释，请参阅 Chris Brumme 和 Chris Lyons 的博客。

[http://blogs.msdn.com/cbrumme/archive/2003/04/19/51365.aspx](http://blogs.msdn.com/cbrumme/archive/2003/04/19/51365.aspx)
[http://blogs.msdn.com/clyon/archive/2004/09/21/232445.aspx](http://blogs.msdn.com/clyon/archive/2004/09/21/232445.aspx)

每个人的答案都很有趣，但我无法选择一个比另一个更好的答案。所以我给了你们一个+1...

对不起

:-)

# 编辑 2

尽管在相同条件下使用相同的代码（多个相同的可执行文件同时运行、发布模式等），但我无法在 Linux/Ubuntu/Mono 上重现该问题

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2008-09-27T12:53:23.077

这只是代码中的一个错误：终结器不应该访问托管对象。

实现终结器的唯一原因是释放非托管资源。在这种情况下，您应该仔细实现[标准 IDisposable 模式](http://msdn.microsoft.com/en-us/library/b1yfkh5e.aspx)。

使用这种模式，您可以实现一个受保护的方法“protected Dispose(bool disposing)”。当从终结器调用此方法时，它会清理非托管资源，但不会尝试清理托管资源。

在您的示例中，您没有任何非托管资源，因此不应实现终结器。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-09-25T17:37:01.767

你所看到的非常自然。

您不保留对拥有字节数组的对象的引用，因此该对象（不是字节数组）实际上是免费的，可供垃圾收集器收集。

垃圾收集器真的可以那么激进。

因此，如果您在对象上调用一个方法，该方法返回对内部数据结构的引用，并且对象的终结器弄乱了该数据结构，那么您还需要保持对该对象的实时引用。

垃圾收集器看到 ex 变量不再在该方法中使用，因此它可以，并且正如您所注意到的，将在正确的情况下（即时间和需要）将其垃圾收集。

正确的方法是在 ex 上调用 GC.KeepAlive，所以将这行代码添加到方法的底部，一切都应该很好：

```
GC.KeepAlive(ex); 
```

我通过阅读Jeffrey Richter的[Applied .NET Framework Programming](http://www.microsoft.com/mspress/books/5353.aspx)一书了解了这种攻击性行为。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-25T17:27:29.590

这看起来像是您的工作线程和 GC 线程之间的竞争条件；为了避免它，我认为有两种选择：

(1) 将您的 if 语句更改为使用 ex.Hash[0] 而不是 res，以便 ex 不能过早地被 GC，或者

(2) 在调用 Hash 期间锁定 ex

这是一个非常漂亮的例子 - 老师的观点是 JIT 编译器中可能存在仅在多核系统上表现出来的错误，或者这种编码可能具有垃圾收集的微妙竞争条件？

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-09-25T17:29:29.540

我认为你看到的是**合理**的行为，因为事情是在多个线程上运行的。这就是 GC.KeepAlive() 方法的原因，在这种情况下应该使用该方法来告诉 GC 该对象仍在使用中并且它不是清理的候选对象。

查看您的“完整代码”响应中的 DoWork 函数，问题是紧接在这行代码之后：

```
byte[] res = ex.Hash; 
```

该函数不再对*ex*对象进行任何引用，因此此时它有资格进行垃圾收集。添加对 GC.KeepAlive 的调用可以防止这种情况发生。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-09-25T17:36:27.493

在你的 do work 方法中调用终结器是完全正常的，因为在 ex.Hash 调用之后，CLR 知道不再需要 ex 实例......

现在，如果您想让实例保持活动状态，请执行以下操作：

```
private static void DoWork()
{
    Example ex = new Example();

    byte[] res = ex.Hash; // [1]

    // If the finalizer runs before the call to the Hash 
    // property completes, the hashValue array might be
    // cleared before the property value is read. The 
    // following test detects that.

    if (res[0] != 2) // NOTE
    {
        // Oops... The finalizer of ex was launched before
        // the Hash method/property completed
    }
  GC.KeepAlive(ex); // keep our instance alive in case we need it.. uh.. we don't
} 
```

GC.KeepAlive 做...什么都不做 :) 它是一个空的不可内联 /jittable 方法，其唯一目的是诱使 GC 认为该对象将在此之后使用。

警告：如果 DoWork 方法是托管 C++ 方法，则您的示例完全有效...如果您不希望从另一个线程中调用析构函数，则必须手动手动保持托管实例处于活动状态*。*IE。您传递对托管对象的引用，该对象将在最终确定时删除非托管内存的 blob，并且该方法正在使用相同的 blob。如果您不保持实例处于活动状态，那么您将在 GC 和您的方法的线程之间出现竞争条件。

而这会以泪水告终。并管理堆损坏......

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-09-25T18:46:01.447

是的，这是以前[出现过的](http://blogs.msdn.com/ricom/archive/2004/05/19/135332.aspx)[问题](http://blogs.microsoft.co.il/blogs/sasha/archive/2008/07/28/finalizer-vs-application-a-race-condition-from-hell.aspx)。

更有趣的是，您需要运行 release 才能发生这种情况，而您最终会抬起头来“嗯，这怎么可能是空的？”。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-09-25T19:53:07.057

# 来自 Chris Brumme 博客的有趣评论

[http://blogs.msdn.com/cbrumme/archive/2003/04/19/51365.aspx](http://blogs.msdn.com/cbrumme/archive/2003/04/19/51365.aspx)

```
class C {<br>
   IntPtr _handle;
   Static void OperateOnHandle(IntPtr h) { ... }
   void m() {
      OperateOnHandle(_handle);
      ...
   }
   ...
}

class Other {
   void work() {
      if (something) {
         C aC = new C();
         aC.m();
         ...  // most guess here
      } else {
         ...
      }
   }
} 
```

> 所以我们不能说'aC'在上面的代码中可能存在多长时间。JIT 可能会报告引用，直到 Other.work() 完成。它可能会将 Other.work() 内联到其他方法中，并且报告 aC 的时间更长。即使您添加“aC = null;” 在你使用它之后，JIT 可以自由地认为这个赋值是死代码并消除它。无论 JIT 何时停止报告引用，GC 都可能在一段时间内无法收集它。
> 
> 更有趣的是担心可以收集 aC 的最早点。如果您和大多数人一样，您会猜想 aC 最早符合收集条件的是在 Other.work() 的“if”子句的右括号中，我在其中添加了注释。事实上，大括号在 IL 中并不存在。它们是您和您的语言编译器之间的句法契约。 **一旦启动对 aC.m() 的调用，Other.work() 就可以自由地停止报告 aC。**

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-09-25T17:24:11.050

## 完整代码

您将在下面找到从 Visual C++ 2008 .cs 文件复制/粘贴的完整代码。由于我现在在 Linux 上，并且没有任何 Mono 编译器或关于其使用的知识，所以我现在无法进行测试。尽管如此，几个小时前，我还是看到了这段代码的工作及其错误：

```
using System;
using System.Threading;

public class Example
{
    private int nValue;
    public int N { get { return nValue; } }

    // The Hash property is slower because it clones an array. When
    // KeepAlive is not used, the finalizer sometimes runs before 
    // the Hash property value is read.

    private byte[] hashValue;
    public byte[] Hash { get { return (byte[])hashValue.Clone(); } }
    public byte[] Hash2 { get { return (byte[])hashValue; } }

    public int returnNothing() { return 25; }

    public Example()
    {
        nValue = 2;
        hashValue = new byte[20];
        hashValue[0] = 2;
    }

    ~Example()
    {
        nValue = 0;

        if (hashValue != null)
        {
            Array.Clear(hashValue, 0, hashValue.Length);
        }
    }
}

public class Test
{
    private static int totalCount = 0;
    private static int finalizerFirstCount = 0;

    // This variable controls the thread that runs the demo.
    private static bool running = true;

    // In order to demonstrate the finalizer running first, the
    // DoWork method must create an Example object and invoke its
    // Hash property. If there are no other calls to members of
    // the Example object in DoWork, garbage collection reclaims
    // the Example object aggressively. Sometimes this means that
    // the finalizer runs before the call to the Hash property
    // completes. 

    private static void DoWork()
    {
        totalCount++;

        // Create an Example object and save the value of the 
        // Hash property. There are no more calls to members of 
        // the object in the DoWork method, so it is available
        // for aggressive garbage collection.

        Example ex = new Example();

        // Normal processing
        byte[] res = ex.Hash;

        // Supposed inlined processing
        //byte[] res2 = ex.Hash2;
        //byte[] res = (byte[])res2.Clone();

        // successful try to keep reference alive
        //ex.returnNothing();

        // Failed try to keep reference alive
        //ex = null;

        // If the finalizer runs before the call to the Hash 
        // property completes, the hashValue array might be
        // cleared before the property value is read. The 
        // following test detects that.

        if (res[0] != 2)
        {
            finalizerFirstCount++;
            Console.WriteLine("The finalizer ran first at {0} iterations.", totalCount);
        }

        //GC.KeepAlive(ex);
    }

    public static void Main(string[] args)
    {
        Console.WriteLine("Test:");

        // Create a thread to run the test.
        Thread t = new Thread(new ThreadStart(ThreadProc));
        t.Start();

        // The thread runs until Enter is pressed.
        Console.WriteLine("Press Enter to stop the program.");
        Console.ReadLine();

        running = false;

        // Wait for the thread to end.
        t.Join();

        Console.WriteLine("{0} iterations total; the finalizer ran first {1} times.", totalCount, finalizerFirstCount);
    }

    private static void ThreadProc()
    {
        while (running) DoWork();
    }
} 
```

对于那些有兴趣的人，我可以通过电子邮件发送压缩项目。

# ruby - Ruby VM 之间的差异

> ID：134655
> 
> 赞同：3
> 
> 时间：2008-09-25T17:18:29.283
> 
> 标签：ruby, jruby, ironruby, rubinius

主要 Ruby VM 的优点/缺点是什么（特性、兼容性、性能和怪癖？）我知道还有一些额外的特性，比如能够通过 JRuby 使用 Java 接口。这些也将有助于注意。在这一点上是否有任何 VM 具有明显的优势，以及在什么情况下？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-09-27T18:14:08.470

这是我在主要 VM 上搜集的一些信息：[Ruby MRI](http://en.wikipedia.org/wiki/Ruby_MRI)、[Ruby 1.9 (YARV)](http://en.wikipedia.org/wiki/YARV)、[JRuby](http://www.jruby.org/)、[XRuby](http://xruby.com/default.aspx)、[Rubinius](http://rubini.us/)和[IronRuby](http://www.ironruby.net/)

去年有一个比较主要 VM 的[性能基准，但考虑到 VM 开发的速度有多快，它在今天可能并不那么重要。](http://antoniocangiano.com/2007/12/03/the-great-ruby-shootout/)Ruby 1.9 通常是最快的，我相信现在仍然比 JRuby 有优势。

目前有四种 VM 能够运行 Ruby on Rails：Ruby MRI、Ruby 1.9、JRuby 和 Rubinius。

XRuby 和 JRuby 一样在 JVM 上运行，并将 Ruby 源文件编译为 Java .class。

IronRuby 在 .NET 上运行，利用其 DLR，并允许您将 Ruby 与 .NET 库和基础架构集成。它还不能运行 Ruby on Rails。

还有一个名为[HotRuby](http://hotruby.yukoba.jp/)的 VM ，可让您在浏览器或 Flash 中运行 Ruby 源代码。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-09-25T17:24:58.443

我使用了 Matz 的 Ruby 和 JRuby，它们解决了不同的任务。如果您正在开发一个直接的 Ruby 或 Rails 应用程序，那么这可能就足够了，但如果有一些功能强大的 Java 库可以提供很大帮助，那么 JRuby 可能是值得的。

我没有做任何过于复杂的事情，但 JRuby 似乎匹配得很好，至少就实现核心语言特性而言（我还没有遇到任何差异，但它们可能存在）。

我想分享一个小轶事... 我正在编写一个脚本来与 DB2 数据库交互。Ruby 中的 DB2 支持非常糟糕……您必须安装整个 DB2 express 版本才能编译 Ruby 驱动程序，这对我来说甚至都不起作用。我受够了，转而使用 JRuby，使用 JDBC 和一些小的 DB2 JDBC jar。它完美地解决了我的问题。重点？好吧，如果访问某些 Java 库可以简化手头的问题，那么一定要去做！

我希望这可以帮到你！抱歉，我对其他虚拟机没有任何经验....

* * *

我读过的另一个警告，但我不太了解细节......我认为 JRuby 支持通过 Java 线程进行线程，而不是 Matz 实现中支持的“绿色”线程......所以如果你想要多线程多核系统，JRuby 可能会更好地为您服务……除非您想在 C 中执行线程。

# javascript - 在哪里可以找到用于将 Perl 数据结构转换为 JavaScript 的 Perl 模块？

> ID：134656
> 
> 赞同：4
> 
> 时间：2008-09-25T17:18:31.000
> 
> 标签：javascript, perl, json, data-structures, mason

在哪里可以找到用于将 Perl 数据结构转换为 JavaScript 的 Perl 模块？

例如，这是我的代码（梅森）：

```
% # convert our @cti data structure into a javascript one
  var cti = [
% foreach my $cti_category (@cti) {
             {
                 label: "<% $cti_category->{'label'} %>",
                 value: "<% $cti_category->{'value'} %>",
                 children: [
%     foreach my $cti_type (@{$cti_category->{'children'}}) {
                            {
                              label: "<% $cti_type->{'label'} %>",
                              value: "<% $cti_type->{'value'} %>",
                            },
%     }
                           ]
             },
% }
            ]; 
```

有这个模块吗？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2008-09-25T18:48:05.763

JSON 代表 JavaScript Object Notation，这是您正在寻找的格式。

不幸的是，您要查找的模块都不在 Perl 核心中，但它们在 CPAN 上可用，快速[搜索](http://search.cpan.org/search?query=JSON&mode=all)就会发现。

我实际上建议安装[JSON::Any](http://search.cpan.org/author/RBERJON/JSON-Any-1.17/lib/JSON/Any.pm)作为包装器，以及[JSON::XS](http://search.cpan.org/author/MLEHMANN/JSON-XS-2.2222/XS.pm)（如果你有 C 编译器）或[JSON](http://search.cpan.org/author/MAKAMAKA/JSON-2.12/lib/JSON.pm)和[JSON::Syck](http://search.cpan.org/~audreyt/YAML-Syck-1.05/lib/JSON/Syck.pm)之一，如果你没有的话。JSON::Any在其他几个 JSON 模块之上提供了一个[接口类（您可以选择，或者让它从已安装的内容中选择），这与​​您最终使用的模块无关。](http://en.wikipedia.org/wiki/Interface_pattern)这样，如果您的代码需要移植到其他地方，并且（例如）目标机器可以在您不能安装 JSON::XS 时安装，那么您无需任何额外代码即可获得性能提升。

```
use JSON::Any;

my $j = JSON::Any->new;

$json = $j->objToJson($perl_data); 
```

像这样。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2008-09-25T17:20:27.970

查看[JSON](http://search.cpan.org/perldoc?JSON)或[JSON::XS](http://search.cpan.org/perldoc?JSON::XS)。

更详细地说，JSON 是“JavaScript Object Notation”，上面的两个模块将 perl 数据结构转换为该格式。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-25T17:20:56.033

[JSON](http://search.cpan.org/~makamaka/JSON-2.53/lib/JSON.pm)！

> 该模块使用 JSON::XS 或 JSON::PP 将 Perl 数据结构转换为 JSON，反之亦然。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-25T17:21:43.660

[JSON](http://search.cpan.org/~makamaka/JSON-2.12/lib/JSON.pm)模块将转换数据结构——它基本上是一个 to/from JSON 序列化程序。

# .net - 加密 web.config 中的成员资格元素时出现问题

> ID：134658
> 
> 赞同：5
> 
> 时间：2008-09-25T17:19:02.357
> 
> 标签：.net, configuration, encryption, web-config

我正在尝试加密 .Net 应用程序的 Web.Config 中的“system.web.membership”元素，以保护 Active Directory 的用户名和密码。我正在使用 aspnet_regiis 命令进行加密，并尝试了几种不同的字符串作为“pe”选项的值，但均未成功。我已成功加密 web.config 上的“connectstrings”元素。

命令

```
C:\Windows\Microsoft.NET\Framework\v2.0.50727>aspnet_regiis -pe "connectionStrings" -site MySite -app /MyApp
加密配置部分...
成功了！

C:\Windows\Microsoft.NET\Framework\v2.0.50727>aspnet_regiis -pe "membership" -site MySite -app /MyApp
加密配置部分...
未找到配置部分“成员资格”。
失败的！

C:\Windows\Microsoft.NET\Framework\v2.0.50727>aspnet_regiis -pe "system.web.membership" -site MySite -app /MyApp
加密配置部分...
未找到配置部分“system.web.membership”。
失败的！
```

网络配置

```
<configuration>
    ...
    <system.web>
        ...
        <authentication mode="Forms">
            <forms name=".ADAuthCookie" 
                   timeout="30"/>
        </authentication>
        <authorization>
            <deny users="?"/>
            <allow users="*"/>
        </authorization>
        <membership defaultProvider="MyADMembershipProvider">
            <providers>
                <add name="MyADMembershipProvider"
                     type="System.Web.Security.ActiveDirectoryMembershipProvider, System.Web, Version=2.0.0.0,Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a" 
                     connectionStringName="ADConnectionString" 
                     connectionUsername="MyUserName" 
                     connectionPassword="MyPassowrd"/>
            </providers>
        </membership>
        ...
    </system.web>
    ...
</configuration> 
```

那么给了什么？我错过了什么？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-09-25T17:33:18.250

配置部分由“ `system.web/membership`”标识，而不是“ `membership`”或“ `system.web.membership`”。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-03-12T14:01:22.347

我知道您的问题已经解决，但是对于收到此错误消息的其他人来说，似乎只有 web.config 的某些部分可以加密。我试图在我的网络配置中加密 SMTP 设置：

```
<?xml version="1.0"?>
<configuration>
  <system.net>
    <mailSettings>
      <smtp>
        <network host="myhost" port="25" userName="myusername" password="mypassword" />
      </smtp>
    </mailSettings>
  </system.net>
</configuration> 
```

这有效：

```
aspnet_regiis.exe -pef "system.net/mailSettings/smtp" "path_to_site" -prov "DataProtectionConfigurationProvider" 
```

但这些没有：

```
aspnet_regiis.exe -pef "system.net/mailSettings" "path_to_site" -prov "DataProtectionConfigurationProvider"

aspnet_regiis.exe -pef "system.net" "path_to_site" -prov "DataProtectionConfigurationProvider" 
```

# visual-studio-2008 - 部署项目中缺少项目依赖项

> ID：134673
> 
> 赞同：12
> 
> 时间：2008-09-25T17:20:31.183
> 
> 标签：visual-studio-2008, deployment-project

我有一个为几个 Windows 服务构建安装程序的 VS2008 部署项目。

每个服务引用几个不同的项目：

```
CustomerName.MailSendingService
 -> 客户名称.网络
 -> 客户名称.数据
 -> CustomerName.Security

CustomerName.ProductIntegrationService
 -> 客户名称.Core
 -> CustomerName.Security

```

Windows服务项目、它们引用的项目、部署项目都在同一个VS2008解决方案中。

我在部署项目的文件系统编辑器中添加了 Windows 服务项目的主要输出。

我的期望是 Windows 服务项目的主要输出将包括来自引用项目的 DLL。但是，在构建部署项目时，缺少引用项目之一的 DLL。（`CustomerName.ProductIntegrationService`失踪`CustomerName.Security`）

令人抓狂的是，Windows 服务引用的其他项目的 DLL 都存在；仅缺少一个项目的输出。

（编辑）我已经验证在参考属性窗口中参考设置为复制本地。引用项目的 DLL 放置在 Windows 服务项目的`bin\Release`文件夹中，但未打包在为部署项目构建的 MSI 文件中。

（编辑 2）按照 Joseph Daigle 的建议，我检查了依赖项是否在主要输出的依赖项列表中，并且它没有标记为“排除”，因此这似乎不是导致此问题的原因。

为什么只有一个项目的输出会丢失？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2010-07-06T19:35:22.580

在重现了同样的可疑 msi 缺陷后，我还有几件事要添加。

1）当我添加第二个项目输出共享相同检测到的依赖项到安装程序时，它没有自动添加依赖项。我删除了两个项目输出并以相反的顺序将它们添加回来。添加的第二个项目输出从未添加检测到的依赖项。这不包括项目的任何配置或代码问题以及引用的添加方式。失败的总是第二个。

2) 我的团队在使用“手动添加检测到的程序集”解决方法后实际上遇到了第二个问题。最初我们从 '\Program Files\xxx' 中的位置添加依赖项，但在 64 位机器上遇到了构建问题，即使 VS 足够聪明，在 '\Program Files (x86)\xxx' 文件夹中也存在相同的依赖项在获取参考文献时处理这个问题。

*   手动添加程序集的正确方法是导航到 bin 文件夹并添加在本地复制的程序集。这确保了正确的程序集将出现在 x86 或 x64 机器上。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-09T03:08:40.977

我可以验证这对我们来说也是一个问题。我怀疑这是部署项目中的一个错误——它只在一个位置添加了依赖项目的输出（也许它认为它是一个 COM dll？）

为丢失的 dll 手动添加主输出似乎是一种可行的解决方法。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-25T17:37:02.097

我还没有使用 Visual Studio 2008，但是在 2005 年，您必须验证项目中缺少的引用是否将 Copy Local 属性设置为 true。

这会将丢失的文件复制到输出目录。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-25T17:44:33.513

除了**hectorsq**的响应之外，还要验证依赖关系是否在部署项目依赖项列表中，并且有问题的 DLL 是否被标记为包含在内。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-09-30T08:55:28.163

您是否尝试过在反射器中查看您的 dll，看看它是否真的依赖于其他 dll？VS 足够聪明，如果它可以看到您实际上并没有使用它，它就不会包含引用的程序集。

除此之外，即使您“认为”您正在使用它，VS 也可以优化您的使用 - 这是一个极限情况，但我已经看到了：

例如，如果您有一个“常量”程序集，其中包含：

```
public const string LockPanelUrn = "ApplicationRack.LockPanel"; 
```

VS 会将字符串直接粘贴在您的引用代码中。

除此之外，我建议删除并重建您的安装解决方案。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-11-21T19:24:01.080

您是否在最初创建部署项目后添加了此程序集依赖项？如果是这样，您可能需要右键单击 Detected Dependencies 文件夹并选择 Refresh Dependencies。它将拾取自您上次执行此操作以来添加的任何新内容。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-07-03T00:34:48.883

看看这个——也许这不能解释为什么会这样，但至少它提供了一些解决方法:)

[http://lo-sharpdevs.blogspot.com/2009/07/vs-2008-disappearing-dependencies.html](http://lo-sharpdevs.blogspot.com/2009/07/vs-2008-disappearing-dependencies.html)

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2011-02-02T09:03:26.370

我在使用 Microsoft SMO 对象时遇到了类似的问题。我有一个二进制组件 (X.dll)，它使用我自己制作的这些 Microsoft SMO 对象。编译 X.dll 后，我在另一个使用 X.dll（而不是代码）的 EXE 项目中引用它。附加的安装程序项目检测到它需要 Microsoft SMO 对象，并检测到它们是我在机器上安装的 SQL Server 的本地。

使用 SMO 对象的组件 X.dll 通过我保存在共享驱动器上的本地“外部”文件夹引用 Microsoft SMO 对象。所有模块都是参考这些模块编译的，但是我的 EXE 项目的安装项目会从我的 SQL Server 安装中检测到这些模块。

因此，我们有另一台机器的“Externals”文件夹中包含 SMO 对象，但安装项目将不再从“检测到的依赖项”中找到 SMO 对象，因为它没有意识到 SMO 对象在外部模块中！我不确定它在哪里搜索 Detected Dependancy 文件，但它没有查看 X.dll 最初从哪里获取它们，甚至可能是 EXE 文件夹......

# asp.net - DataGrid 编辑问题

> ID：134680
> 
> 赞同：0
> 
> 时间：2008-09-25T17:21:23.863
> 
> 标签：asp.net, datagrid

我有一个 DataGrid，带有一个带有图像和标签的 ItemTemplate。在 EditItemTemplate 中，标签被替换为文本框。我的问题是编辑模板仅在我第二次单击“编辑”按钮时显示。是什么赋予了？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-09-25T17:30:24.780

确保在绑定数据网格之前检查 Page.IsPostback。您可能会在每次页面加载期间进行绑定。

```
If Not Page.IsPostBack() Then
    DoDataBinding()
End If 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-09-25T17:31:11.437

确保在设置 EditItemIndex 属性后重新绑定 DataGrid。

编辑：同意马萨。最佳实践是将数据绑定移动到单独的方法中，并在第一个页面加载时首先调用它，然后在设置 EditItemIndex 后再次调用它。

# html - 为什么小空间不断出现在我的网页中？

> ID：134683
> 
> 赞同：6
> 
> 时间：2008-09-25T17:22:32.630
> 
> 标签：html, css, layout

这可能是一个愚蠢的问题，但如果有更好或正确的方法来做到这一点，我很想学习它。

我遇到过几次，包括最近，在我的 HTML 页面的渲染版本中出现了小空间。直觉上，我认为这些不应该存在，因为在文本或实体之外，页面 HTML 的格式应该无关紧要，但显然它确实如此。

我指的是这个——我从客户那里得到了一些关于他们希望他们的网站看起来如何的 Photoshop 文件。他们希望它看起来与此文件中的图像基本像素完美。

页面中的一个地方需要一个菜单​​栏，每个地方都会在悬停时进行更改，充当超链接等。在 Photoshop 文件中，这是一个长栏，因此一种廉价且简单的方法是只需将该段拆分为多个图像，然后将它们彼此相邻放置在文件中。

所以本能地我把它排成这样（还有更多，但这是要点）

```
<a href="page1.html">
  <img src="image1.png" />
</a>
<a href="page2.html">
  <img src="image2.png" />
</a>
<a href="page3.html">
  <img src="image3.png" />
</a> 
```

等等。

问题是图像之间的空间很小，这是不可接受的，因为客户想要这个像素完美的东西（而且它看起来很糟糕）。

使其正确渲染的一种方法是删除图像之间的回车符

```
<a href="page1.html">
  <img src="image1.png" />
</a>
<a href="page2.html">
  <img src="image2.png" />
</a>
<a href="page3.html">
  <img src="image3.png" />
</a> 
```

这使得图像相互对立（期望的效果），但它使行非常长并且代码更难以维护（它在这里包装在 SO 中，这是一个简化版本 - 真正的有更长的文件名和 JavaScript洒进去做悬停）。

在我看来，这不应该发生，但看起来 HTML 中的回车被呈现为一个小的空白空间。这发生在所有浏览器中，看起来像。

我认为上面的两个片段应该呈现相同是对还是错？有什么我做错了吗？也许用错误的编码保存文件？我是否应该将这些链接中的每一个都设为完美定位的 CSS 元素？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2008-09-25T17:26:33.633

空格（包括回车）通常在所有浏览器中呈现为空格。

您需要一个接一个地放置元素，但您可以使用一个技巧：

```
<a href="page1.html"><img src="image1.png" 
/></a><a href="page2.html"><img src="image2.png" 
/></a><a href="page3.html"><img src="image3.png" 
/></a> 
```

这看起来也有点难看，但还是比单行好。您可能会更改格式，但想法是在元素内部而不是在它们之间添加回车。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2008-09-25T17:30:11.377

我不知道这对于您的页面是否足够通用，但是您可以对这些特定**的 a**标签进行分类并将它们全部浮动，然后无论您的 HTML 格式如何，它们都会聚集在一起。

```
<style>
    a.together {
        float:left;
    }
</style>

<a class='together' href="page1.html"><img src="image1.png" /></a>
<a class='together' href="page2.html"><img src="image2.png" /></a>
<a class='together' href="page3.html"><img src="image3.png" /></a> 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-09-25T17:27:53.490

这是 HTML 规范的一部分 - 空格在标记中，因此它们被视为文档的一部分。

由于您不喜欢格式，您唯一的其他选择是打破 html 标签：

```
 <a href="..."><img src=".." /></a
  ><a href="..."><img src=".." /></a
  ><a href="..."><img src=".." /></a 
```

我认为这是不可取的，或者动态创建 html - 通过 JavaScript 或使用模板系统和动态 html。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-09-25T17:33:40.077

原因很简单：在 HTML 中，空白很重要，但只有一次。重复的空白被忽略，只显示第一个。

避免这种情况的唯一可靠方法是，正如您所做的那样，在元素之间不放置空格。

当基于表格的布局比现在少时，您可以使用零边框、零填充表格来对齐元素，同时将它们放在源代码中的单独行上。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-09-25T17:33:51.073

您在上面演示的行为是正确的，因为浏览器将回车视为空格。要修复它，您可以使用以下方式设置它的样式：

```
a { display: block; float: left; } 
```

请注意，上述规则适用于所有链接，因此您可能只想将选择器缩小到某些元素，即：

```
#nav a { display: block; float: left; } 
```

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2008-09-25T17:36:13.330

我处理这个问题的方法是使用一个无序列表，并让每个图像/链接成为一个项目。然后使用 CSS 内联显示每个项目并将它们浮动到左侧。

这将为您提供更大的灵活性并使标记非常易读。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-09-25T17:33:49.437

如果你要在网站上做一个选项卡式界面，请花大力气把它做好，这将是值得的。有很多网站都有很好的 CSS 选项卡实现示例。考虑使用其中之一。

[这个](http://www.noupe.com/javascript/37-great-ajax-css-tab-based-interfaces.html)有很多 CSS+Javascript/AJAX 选项卡。或者查看[这组简单的 CSS 示例](http://htmldog.com/articles/tabs/)（一些样式）。最后，看看这个非常酷的[标签生成器](http://www.tabsgenerator.com/)。

# visual-studio - Visual Studio ">of" 命令导致解决方案资源管理器变得古怪

> ID：134688
> 
> 赞同：1
> 
> 时间：2008-09-25T17:24:16.633
> 
> 标签：visual-studio

我现在在 Visual Studio 2005 中使用一个相当大的解决方案，每当我尝试在工具栏搜索框中使用“> of”命令时，它都会导致我的解决方案资源管理器失控。具体来说，所有文件夹都开始显示其中没有任何文件，我必须点击“刷新”按钮才能让它们全部显示出来。这非常烦人，所以我不再使用“>of”命令，但跳转到文件命令确实会派上用场。

有没有其他人经历过这种情况，或者有更好的选择来通过文件名跳转到特定文件？

注意：ReSharper 不是一个选项。这种规模的解决方案太慢了。我试了一下，每次加载都需要 10-15 分钟。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-09-26T08:53:12.440

首先，感谢您让我发现您可以从“查找组合”框中运行命令。

我没有遇到您的问题（我的解决方案中没有足够的文件？），但您提到的更好的选择可能是 Visual Assist 的“在工作区中打开文件”命令。一个解决方案中有 2500 个左右的文件，对我来说快如闪电。

# jar - 如何创建包含 xml 和 html 文件的 jar 文件？

> ID：134691
> 
> 赞同：3
> 
> 时间：2008-09-25T17:24:44.713
> 
> 标签：jar

我正在尝试创建一个 jar 文件，其中包含一些所需的类和 java 文件，但我也想包含一些额外的 xml、xsl、html、txt (README) 文件。

我在 Windows XP 上使用 Eclipse。

有没有一种简单的方法可以设置目录结构并将所有文件打包到 jar 中？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-09-25T17:31:24.747

将文件添加到源文件夹，它们可以包含在 jar 中。

一种常见的方法是在项目的根目录下拥有一个 src 文件夹。其中，Java 文件的文件夹和其他文件夹。就像是：

```
源/
    css/
    爪哇/
    html/
    图片/
```

然后，您可以将每个子文件夹设为源文件夹（右键单击，用作源文件夹），它们应该可以添加到 jar 中。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-25T21:43:26.997

I just added all the files into my Eclipse project (including the txt, html, xml, etc files).

Then I used Eclipse to File->Export->Jar File->Next Check the "Export Java source files and resources" box.

Done.

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-25T17:30:30.223

.jar 只是一个 ZIP 存档，因此您可以使用任何能够创建 ZIP 的程序。只需确保包含清单和所有类文件。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-09-25T17:35:58.633

如果您使用的是 Ant，则可以使用该[`jar`任务](http://ant.apache.org/manual/Tasks/jar.html)（请参阅示例部分以了解如何包含/排除某些文件等）

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-09-25T17:35:20.943

如果您迁移到 ANT（或 Maven，对于您的 Maven 粉丝），那么您可以很好地自动化 Jar 构建，并且还可以在 Eclipse 之外使用它（例如，在自动化构建环境中）。您需要做的就是将文件从您的 src、jsp、foobar 和资源位置复制到构建暂存文件夹中，然后使用 ANT 的 Jar 任务将生成的文件打包。

```
<target name="makejar" depends="compile, copyfiles">

    <jar destfile="${jars.dir}/myjarfile.jar" index="true" basedir="${build.dir}" />

</target> 
```

我看不起的一件事是在 src 文件夹中包含非源代码（Javadoc 的 package.html 文件除外）。如果你觉得你必须这样做才能实现某件事，那么你做错了。

# linq - Linq To SQL 缓存 VS 多用户应用程序

> ID：134694
> 
> 赞同：1
> 
> 时间：2008-09-25T17:25:19.220
> 
> 标签：linq

我们开发了通过 Linq to SQL 访问 SQL 2005 数据库的 Win32 应用程序。问题是当 2 个用户访问同一记录（查看和编辑）时……用户 1 更新记录（DataContext.SubmitChanges()），用户 2 将继续看到旧信息，直到他重新启动应用程序。因此，我们想更新用户 2 的上下文……现在出现的解决方案是调用 DataContext.Refresh 以将对象与 SQL 表同步……我们想知道是否存在其他解决方案？

谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-09-25T17:33:15.223

我注意到刷新可能真的很讨厌，具体取决于您已经从实体中获取的数据，另一种解决方案是将您正在使用的上下文重置为新实例。

```
context = new MyDataContext(ConnectionString); 
```

至少在我使用它的情况下，这会减少开销和数据库调用。

# .net - 捕获异常作为预期的程序执行流控制？

> ID：134698
> 
> 赞同：12
> 
> 时间：2008-09-25T17:25:52.730
> 
> 标签：.net, sql, sql-server, exception-handling

我一直觉得期望定期抛出异常并将它们用作流逻辑是一件坏事。异常感觉它们应该是“*异常*”。如果您期望并计划出现异常，那似乎表明您的代码应该被重构，至少在 .NET 中......
但是。最近的一个场景让我停下来。不久前我在 msdn 上发布了这个，但我想引起更多关于它的讨论，这是一个完美的地方！

因此，假设您有一个数据库表，其中有几个其他表的外键（在最初引发辩论的情况下，有 4 个外键指向它）。您希望允许用户删除，但前提是没有外键引用；你不想级联删除。
我通常只是检查是否有任何引用，如果有，我会通知用户而不是删除。在 LINQ 中编写它非常容易和轻松，因为相关表是对象上的成员，因此 Section.Projects 和 Section.Categories 等很适合用智能感知和所有类型输入......
但事实是 LINQ 然后必须可能会访问所有 4 个表以查看是否有任何结果行指向该记录，并且访问数据库显然总是一个相对昂贵的操作。

该项目的负责人要求我将其更改为仅捕获代码为 547（外键约束）的 SqlException 并以这种方式处理它。

我是……
*抗拒*的。

但是在这种情况下，吞下与异常相关的开销可能比吞下 4 个表命中要有效得多……尤其是因为我们必须在每种情况下都进行检查，但我们可以避免这种情况下的异常当没有孩子时...
加上数据库确实应该负责处理引用完整性，这是它的工作并且做得很好...
所以他们赢了，我改变了它。

但在某种程度上，我仍然觉得它是*错误*的。

你们如何看待期待和有意处理异常？当它看起来比事先检查更有效率时可以吗？下一个查看您的代码的开发人员是否更容易混淆，或者更容易混淆？是否更安全，因为数据库可能知道开发人员可能不会考虑添加检查的新外键约束？还是你认为最佳实践的观点是什么？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-09-25T17:29:37.917

你的领导是绝对正确的。例外不仅在蓝月亮情况下出现一次，而且专门用于报告预期结果之外的结果。

在这种情况下，仍然会进行外键检查，异常是可以通知您的机制。

您不应该做的是使用笼统的笼统声明来捕获和抑制异常。进行细粒度的异常处理正是首先设计异常的原因。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-09-25T17:37:53.107

哇，

首先，您能否稍微提炼一下这个问题，虽然很高兴阅读一个经过深思熟虑和解释的问题，但要消化的内容很多。

简短的回答是“是”，但它可能取决于。

*   我们有一些应用程序，其中我们有很多业务逻辑绑定在 SQL 查询中（不是我的设计 Gov！）。如果这是它的结构方式，那么管理层可能很难以其他方式说服，因为它“已经奏效”了。
*   在这种情况下，真的有什么大不了的吗？因为它仍然是一次穿越电线和回来的旅行。服务器在意识到它无法继续之前是否做了很多事情（即，如果您的操作发生了一系列事务，那么它是否会在中途失败，浪费时间？）。
*   首先在 UI 中进行检查有意义吗？它对您的申请有帮助吗？如果它提供更好的用户体验？（即，我曾看到您在向导中逐步完成几个步骤的情况，它开始，然后跌倒，当它具有在第 1 步之后跌倒所需的所有信息时）。
*   并发是个问题吗？是否有可能在您的提交发生之前删除/编辑记录或其他任何内容（如经典的`File.Exists`boo-boo 中）。

在我看来：

**我会做*这两个*。如果我能快速失败并提供更好的用户体验，那就太好了。无论如何，任何预期的 SQL（或任何其他）异常都应该被捕获并适当地反馈。**

我知道有一个共识，即异常不应用于除*异常情况外*，但请记住，我们在这里跨越应用程序边界，不要**期待**。就像我说的，这就像`File.Exists`，没有意义，无论如何都可以在访问之前将其删除。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-09-25T17:42:05.343

我认为您是对的，异常应该只用于处理*意外*结果，这里您使用异常来处理可能预期的结果，您应该明确处理这种情况但仍然捕获异常以显示可能的错误。

除非这是在整个代码中处理这种情况的方式，否则我会支持你。只有当它确实是一个问题时才应该提出性能问题，即它取决于这些表的大小和使用此功能的次数。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-09-26T13:18:10.780

好问题。然而，我找到了答案……可怕！
一个例外是一种 GOTO。
我不喜欢以这种方式使用异常，因为这会导致意大利面条式代码。
就那么简单。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-09-25T17:40:34.257

你在做什么没有错。例外不一定是“例外”。它们的存在是为了允许调用对象根据需要进行细粒度的错误处理。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-09-25T17:42:35.357

捕获特定的 SqlException 是正确的做法。这是 SQL Server 传递外键条件的机制。即使您可能喜欢使用不同的异常机制，SQL Server 也是这样做的。

此外，在您检查这四个表期间，其他一些用户可能会在您完成检查之前但在您阅读该表之后添加相关记录。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-09-25T19:32:46.717

我建议调用一个存储过程来检查是否有任何依赖关系，如果没有则删除。这样，完整性检查就完成了。

当然，对于单例删除与批量删除，您可能需要不同的存储过程......批量删除可以查找子行并返回一组不符合批量删除条件的记录（有子行） .

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2010-11-23T02:54:59.043

我不喜欢在程序中到处看到异常，但在这种情况下，我会使用异常机制。

即使您在 LINQ 中进行测试，您也必须捕获异常，以防有人在您使用 LINQ 测试完整性时插入子记录。既然您无论如何都必须检查异常，为什么要复制代码？

另一点是这种“短程”异常不会导致维护问题，也不会使您的程序更难阅读。您将在 10 行代码内完成 try、删除的 SQL 调用和 catch。意图很明显。

不像抛出一个要被捕获的异常，堆栈中的 5 个过程调用较高，问题是确保中间的所有对象都已正确处理（释放）。

Exceptions are not always a magic answer, but I would not feel wrong to use them in this situation.

My two cents,

Yves

# matlab - 如何在 MATLAB 中针对一列对二维数组进行排序？

> ID：134712
> 
> 赞同：45
> 
> 时间：2008-09-25T17:30:02.143
> 
> 标签：matlab, sorting, matrix, octave

我想根据特定列对矩阵进行排序。有一个`sort`函数，但它独立地对所有列进行排序。

例如，如果我的矩阵`data`是：

```
 1     3
 5     7
-1     4 
```

然后所需的输出（按第一列排序）将是：

```
-1     4
 1     3
 5     7 
```

但输出`sort(data)`是：

```
-1     3
 1     4
 5     7 
```

如何按第一列对该矩阵进行排序？

* * *

## 回答 #1

> 赞同：75
> 
> 时间：2008-09-25T18:34:42.987

我认为[sortrows](http://www.mathworks.com/help/matlab/ref/sortrows.html)功能是您正在寻找的。

```
>> sortrows(data,1)

ans =

    -1     4
     1     3
     5     7 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2016-03-06T21:27:31.423

的替代方案`sortrows()`，可应用于更广泛的场景。

1.  保存要排序的行/列的排序索引：

    ```
    [~,idx]=sort(data(:,1)); 
    ```

2.  根据先前排序的索引重新排序所有行/列

    ```
    data=data(idx,:) 
    ```

# html - HTML 4 和 HTML 5 之间的主要区别是什么？

> ID：134727
> 
> 赞同：148
> 
> 时间：2008-09-25T17:32:19.953
> 
> 标签：html, html4

[HTML4](http://www.w3.org/TR/REC-html40/)和[HTML5 草稿](http://www.w3.org/html/wg/html5/)之间的主要区别是什么？

请保留与更改的语法和添加/删除的 html 元素相关的答案。

* * *

## 回答 #1

> 赞同：203
> 
> 时间：2009-02-23T14:22:08.227

HTML5 有几个区别于 HTML4 的目标。

# 处理畸形文件的一致性

第一个是*一致的、已定义的错误处理*。如您所知，HTML 特意支持“标记汤”，即编写格式错误的代码并将其更正为有效文档的能力。问题是这样做的规则没有写在任何地方。当新的浏览器供应商想要进入市场时，他们只需要在各种浏览器（尤其是 IE）中测试格式错误的文档并对其错误处理进行逆向工程。如果他们不这样做，那么许多页面将无法正确显示（估计将大约 90% 的页面放在网络上至少有些格式不正确）。

因此，HTML5 试图发现并编码这种错误处理，以便浏览器开发人员都可以标准化并大大减少一致显示内容所需的时间和金钱。同样，在 HTML 作为一种文档格式消亡之后的很长一段时间内，历史学家可能仍想阅读我们的文档，而拥有一个完全定义的解析算法将大大有助于这一点。

# 更好的 Web 应用程序功能

HTML5 的次要目标是通过 HTML、CSS 和 Javascript 开发浏览器成为应用平台的能力。许多元素已直接添加到当前（在 HTML4 中）Flash 或基于 JS 的 hack 的语言中，例如`<canvas>`、`<video>`和`<audio>`. 有用的东西，例如本地存储（一个 js 可访问的浏览器内置键值数据库，用于存储超出 cookie 可以保存的信息），新的输入类型，例如浏览器可以公开简单用户界面的日期（以便我们不必使用我们基于 js 的日历日期选择器），并且浏览器支持的表单验证将使开发人员开发 Web 应用程序变得更加简单，并使用户更快地开发 Web 应用程序（因为很多东西都将得到原生支持，而不是通过 javascript 入侵）。

# 改进的元素语义

HTML5 中还有许多其他较小的努力，例如更好地定义现有元素的语义角色（`<strong>`现在实际上意味着不同的东西，`<em>`甚至具有模糊的语义，在解析遗留文档时应该可以很好地工作）以及添加有用的新元素语义 - , , , , 和应该替换网页上使用的大多数s，使您的页面更具语义，但更重要的是，*更易于阅读*。没有更痛苦的扫描来查看随机关闭的内容 - 相反，您将有一个明显的, 或，使您的文档结构更加直观。`<b>``<i>``<article>``<section>``<header>``<aside>``<nav>``<div>`*`</div>``</header>``</article>`*

 ** * *

## 回答 #2

> 赞同：45
> 
> 时间：2008-09-25T17:37:18.350

来自[维基百科](http://en.wikipedia.org/wiki/HTML_5#Differences_from_HTML_4)：

*   面向灵活解析和兼容性的新解析规则
*   新元素 - 部分、视频、进度、导航、仪表、时间、旁边、画布
*   新的输入属性——日期和时间、电子邮件、网址
*   新属性——ping、charset、async
*   全局属性（可应用于每个元素）——id、tabindex、repeat
*   弃用的元素被删除——中心、字体、罢工

* * *

## 回答 #3

> 赞同：12
> 
> 时间：2008-09-25T17:35:48.993

您需要查看[HTML5 与 HTML4 的差异：W3C 工作组说明 2014 年 12 月 9 日](http://www.w3.org/TR/html5-diff/)以了解完整的差异。有许多新元素和元素属性。一些元素被删除，其他元素具有与以前不同的语义值。

还定义了 API，例如使用画布，以帮助构建下一代 Web 应用程序并确保实现标准化。

* * *

## 回答 #4

> 赞同：12
> 
> 时间：2011-01-23T13:09:47.173

HTML5 引入了许多有助于创建 Web 应用程序的 API。这些可以与为应用程序引入的新元素一起使用：

*   用于播放视频和音频的 API，可与新的视频和音频元素一起使用。
*   启用离线 Web 应用程序的 API。
*   允许 Web 应用程序为某些协议或媒体类型注册自身的 API。
*   `contenteditable`与新的全局属性相结合的编辑 API 。
*   `draggable`与属性相结合的拖放 API 。
*   公开历史记录并允许向其中添加页面以防止破坏后退按钮的 API。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-04-28T21:15:36.297

您可能对这个[HTML5 元素和属性](http://simon.html5.org/html5-elements)列表感兴趣。

另外，请注意它是“HTML 4”，而不是“HTML4”。事实上，对于 HTML 5，这两种变体都被使用，但在含义上有一个重要的区别。HTML 5 指的是 W3C 规范的名称，而“HTML5”是那些具有`text/html`遵循该规范的 MIME 类型的 HTML 文件的文档类型。XHTML 5 与 XHTML5 也是如此。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2012-07-06T06:15:49.380

现在 W3c 在他们的网站上提供了官方的区别：

[http://www.w3.org/TR/html5-diff/](http://www.w3.org/TR/html5-diff/)

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-09-25T19:51:36.030

HTML 5 邀请您为代码添加大量语义价值。此外，还有嵌入多媒体内容的原生解决方案。

其余的很重要，但更多的是技术性的糖，可以使您免于使用客户端编程语言做同样的事情。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2013-10-23T04:17:27.530

简而言之，与 html 相比，它要简单得多，删除了长文档类型，并删除了中心和字体标签。我还在我的博客中回答了这个差异： [http ://ravisinghblog.in/key-difference-between-html-and-html-5/](http://ravisinghblog.in/key-difference-between-html-and-html-5/)

# vb.net - VB.NET 中的通用对象

> ID：134728
> 
> 赞同：2
> 
> 时间：2008-09-25T17:32:39.797
> 
> 标签：vb.net, generics

我有一个声明如下的类：

```
Public MustInherit Container(Of T As {New, BaseClass}) Inherits ArrayList(Of T) 
```

我有继承这个类的类。

我有另一个类，我必须在这个方法中传递实例：

```
Public Sub LoadCollection(Of T As {BaseClass, New})(ByRef Collection As Container(Of T)) 
```

我需要将传入的对象存储在全局变量中，但我不能简单地声明它：

```
Private _Container as Collection(Of BaseClass) 
```

声明这个对象的语法是什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-01T10:40:49.243

Sorry haven't got time to expand on this right now, but I think [this link](http://rasor.wordpress.com/2008/08/19/cast-a-generic-list-c/) describes your underlying problem and a solution.

(You might also find [this](http://blogs.msdn.com/lucian/archive/2008/10/02/co-and-contra-variance-how-do-i-convert-a-list-of-apple-into-a-list-of-fruit.aspx) interesting.)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-09-25T17:48:03.957

它不能是全局变量。容器是一个想法，而不是一个东西。

正如你所设计的那样，这个想法只是在 LoadCollection() 中形成了一个实际的东西。您需要在该方法之外传达信息。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-26T00:47:53.103

嗯。“集合”是变量名，而不是类型。我认为这就是你想要的：

```
Private _Container as Container(Of BaseClass) 
```

此外，ArrayList 不是通用类；你不是说继承***列表***（T）吗？

# c++ - 返回对对象的 const 引用而不是副本

> ID：134731
> 
> 赞同：73
> 
> 时间：2008-09-25T17:33:15.037
> 
> 标签：c++, constants

在重构一些代码时，我遇到了一些返回 std::string 的 getter 方法。例如这样的事情：

```
class foo
{
private:
    std::string name_;
public:
    std::string name()
    {
        return name_;
    }
}; 
```

当然，吸气剂会更好地返回 a `const std::string&`? 当前方法正在返回一个效率不高的副本。返回一个 const 引用会导致任何问题吗？

* * *

## 回答 #1

> 赞同：60
> 
> 时间：2008-09-25T17:41:03.863

这可能导致问题的唯一方法是调用者存储引用，而不是复制字符串，并在对象被销毁后尝试使用它。像这样：

```
foo *pFoo = new foo;
const std::string &myName = pFoo->getName();
delete pFoo;
cout << myName;  // error! dangling reference 
```

但是，由于您现有的函数返回一个副本，因此您不会破坏任何现有代码。

**编辑：**现代 C++（即 C++11 及更高版本）支持[Return Value Optimization](https://en.wikipedia.org/wiki/Copy_elision)，因此不再不赞成按值返回内容。仍然应该注意按值返回非常大的对象，但在大多数情况下应该没问题。

* * *

## 回答 #2

> 赞同：32
> 
> 时间：2011-02-23T18:19:54.780

实际上，另一个*不*通过引用返回字符串的**问题**是，通过[c_str()](http://www.cplusplus.com/reference/string/string/c_str/)方法通过指针提供对内部的访问。这让我头疼了好几个小时。例如，假设我想从 foo 获取名称，并将其传递给 JNI 以用于构造 jstring 以稍后传递给 Java，这将返回一个副本而不是引用。我可能会写这样的东西：*`std::string``const char*``name()`*

 *```
foo myFoo = getFoo(); // Get the foo from somewhere.
const char* fooCName = foo.name().c_str(); // Woops!  foo.name() creates a temporary that's destructed as soon as this line executes!
jniEnv->NewStringUTF(fooCName);  // No good, fooCName was released when the temporary was deleted. 
```

如果你的调用者要做这种事情，最好使用某种类型的智能指针，或者一个常量引用，或者至少在你的 foo.name() 方法上有一个讨厌的警告注释头。我提到 JNI 是因为以前的 Java 编码人员可能特别容易受到这种看似无害的方法链接的攻击。

* * *

## 回答 #3

> 赞同：18
> 
> 时间：2008-09-25T20:58:25.090

const 引用返回的一个问题是，如果用户编写了如下代码：

```
const std::string & str = myObject.getSomeString() ; 
```

通过`std::string`返回，临时对象将保持活动状态并附加到 str 直到 str 超出范围。

但是 a 会发生什么`const std::string &`？我的猜测是，我们会有一个对象的 const 引用，当它的父对象释放它时，它可能会死掉：

```
MyObject * myObject = new MyObject("My String") ;
const std::string & str = myObject->getSomeString() ;
delete myObject ;
// Use str... which references a destroyed object. 
```

所以我更喜欢 const 引用返回（因为无论如何，我只是更愿意发送引用而不是希望编译器优化额外的临时），只要遵守以下合同：“如果你想要它超越我的对象的存在，他们在我的对象被破坏之前复制它”

* * *

## 回答 #4

> 赞同：10
> 
> 时间：2008-09-25T21:33:09.220

std::string 的一些实现与写时复制语义共享内存，因此按值返回几乎与按引用返回一样有效*，*您不必担心生命周期问题（运行时确实给你）。

如果您担心性能，请*对其进行基准测试*（<= 强调不够）！！！尝试这两种方法并测量增益（或缺乏增益）。如果一个更好并且你真的很在乎，那就使用它。如果不是，那么更喜欢按价值提供保护，以防止其他人提到的终身问题。

你知道他们怎么说做假设...

* * *

## 回答 #5

> 赞同：8
> 
> 时间：2009-03-31T14:58:05.843

好的，所以返回副本和返回引用之间的**区别是：**

*   **性能**：返回参考可能会也可能不会更快；这取决于`std::string`您的编译器实现的实现方式（正如其他人指出的那样）。但即使您返回引用，函数调用后的赋值通常也会涉及副本，如`std::string name = obj.name();`

*   **安全**：返回参考可能会也可能不会导致问题（悬空参考）。如果您的函数的用户不知道他们在做什么，将引用存储为引用并在提供对象超出范围后使用它，那么就会出现问题。

如果您想要**快速安全地**使用**boost::shared_ptr**。您的对象可以在内部将字符串存储为`shared_ptr`并返回一个`shared_ptr`. 这样，将不会复制对象，并且它始终是安全的（除非您的用户`get()`在对象超出范围后拉出原始指针并对其进行处理）。

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2008-09-25T17:34:47.623

我将其更改为返回 const std::string&。如果您不更改所有调用代码，调用者可能会复制结果，但不会引入任何问题。

如果您有多个线程调用 name()，则会出现一种潜在的问题。如果您返回一个引用，但后来更改了基础值，那么调用者的值将会更改。但是现有的代码无论如何看起来都不是线程安全的。

看看 Dima 对一个相关的潜在但不太可能的问题的回答。

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2008-09-25T17:37:05.277

可以想象，如果调用者真的想要一个副本，您可能会破坏某些东西，因为他们即将更改原件并希望保留它的副本。然而，实际上它更有可能只返回一个 const 引用。

最简单的做法是尝试它，然后测试它是否仍然有效，前提是您有某种可以运行的测试。如果没有，我会先专注于编写测试，然后再继续重构。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2008-09-25T17:43:13.343

如果您更改为 const 引用，该函数的典型用法不会中断的可能性非常好。

如果调用该函数的所有代码都在您的控制之下，只需进行更改并查看编译器是否会抱怨。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2008-09-25T18:59:03.067

有关系吗？一旦您使用现代优化编译器，按值返回的函数将不会涉及副本，除非它们在语义上是必需的。

请参阅[C++ lite 常见问题解答](http://www.parashift.com/c++-faq-lite/ctors.html#faq-10.9)。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2008-09-25T17:35:41.600

取决于你需要做什么。也许您希望所有调用者在不更改类的情况下更改返回值。如果您返回不会飞的 const 引用。

当然，下一个论点是调用者可以制作自己的副本。但是，如果您知道如何使用该函数并且知道无论如何都会发生这种情况，那么这样做可能会在以后的代码中为您节省一步。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2008-09-25T18:33:16.843

我通常返回 const& 除非我不能。QBziZ 举例说明了这种情况。当然，QBziZ 还声称 std::string 具有写时复制语义，这在今天很少是真的，因为 COW 在多线程环境中涉及大量开销。通过返回 const & 你让调用者有责任用他们末尾的字符串做正确的事情。但是，由于您正在处理已经在使用的代码，因此您可能不应该更改它，除非分析显示该字符串的复制会导致大量性能问题。然后，如果您决定更改它，您将需要彻底测试以确保您没有破坏任何东西。希望与您一起工作的其他开发人员不会像 Dima 的回答那样做粗略的事情。

* * *

## 回答 #12

> 赞同：-1
> 
> 时间：2017-03-20T07:44:17.053

返回对成员的引用会公开类的实现。这可能会阻止更改课程。如果需要优化，可能对私有或受保护的方法有用。 [C++ getter 应该返回什么](https://stackoverflow.com/questions/20091046/what-should-a-c-getter-return)

# asp.net - 将 ASP.NET DropDownList DataTextField 绑定到方法？

> ID：134741
> 
> 赞同：6
> 
> 时间：2008-09-25T17:34:22.430
> 
> 标签：asp.net, data-binding, drop-down-menu

无论如何，ASP.NET DropDownList 中的项目是否将它们的 Text 或 Value 绑定到源上的方法而不是属性？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-10-20T09:52:17.743

这是我的解决方案：

```
<asp:DropDownList ID="dropDownList" runat="server" DataSourceID="dataSource" DataValueField="DataValueField" DataTextField="DataTextField" />
<asp:ObjectDataSource ID="dataSource" runat="server" SelectMethod="SelectForDataSource" TypeName="CategoryDao" />

public IEnumerable<object> SelectForDataSource()
{
    return _repository.Search().Select(x => new{
        DataValueField = x.CategoryId, 
        DataTextField = x.ToString() // Here is the trick!
    }).Cast<object>();
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-23T01:12:43.507

这是 2 个示例，用于从类中绑定 ASP.net 中的下拉列表

你的 aspx 页面

```
 <asp:DropDownList ID="DropDownListJour1" runat="server">
    </asp:DropDownList>
    <br />
    <asp:DropDownList ID="DropDownListJour2" runat="server">
    </asp:DropDownList> 
```

您的 aspx.cs 页面

```
 protected void Page_Load(object sender, EventArgs e)
    {
    //Exemple with value different same as text (dropdown)
    DropDownListJour1.DataSource = jour.ListSameValueText();            
    DropDownListJour1.DataBind();

    //Exemple with value different of text (dropdown)
    DropDownListJour2.DataSource = jour.ListDifferentValueText();
    DropDownListJour2.DataValueField = "Key";
    DropDownListJour2.DataTextField = "Value";
    DropDownListJour2.DataBind();     
    } 
```

你的 jour.cs 类 (jour.cs)

```
public class jour
{

    public static string[] ListSameValueText()
    {
        string[] myarray = {"a","b","c","d","e"} ;
        return myarray;
    }

    public static Dictionary<int, string> ListDifferentValueText()
    {
        var joursem2 = new Dictionary<int, string>();
        joursem2.Add(1, "Lundi");
        joursem2.Add(2, "Mardi");
        joursem2.Add(3, "Mercredi");
        joursem2.Add(4, "Jeudi");
        joursem2.Add(5, "Vendredi");
        return joursem2;
    }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-25T17:35:59.103

唯一的方法是处理 DropDownList 的 Databinding 事件，调用该方法并自己设置 DropDownList 项中的值。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2011-12-16T01:25:18.047

有时我需要将导航属性用作 DataTextField，例如 ("User.Address.Description")，因此我决定创建一个从 DropDownList 派生的简单控件。我还实现了一个 ItemDataBound 事件，它也可以提供帮助。

```
public class RTIDropDownList : DropDownList
{
    public delegate void ItemDataBoundDelegate( ListItem item, object dataRow );
    [Description( "ItemDataBound Event" )]
    public event ItemDataBoundDelegate ItemDataBound;

    protected override void PerformDataBinding( IEnumerable dataSource )
    {
        if ( dataSource != null )
        {
            if ( !AppendDataBoundItems )
                this.Items.Clear();

            IEnumerator e = dataSource.GetEnumerator();

            while ( e.MoveNext() )
            {
                object row = e.Current;

                var item = new ListItem( DataBinder.Eval( row, DataTextField, DataTextFormatString ).ToString(), DataBinder.Eval( row, DataValueField ).ToString() );

                this.Items.Add( item );

                if ( ItemDataBound != null ) // 
                    ItemDataBound( item, row );
            }
        }
    }
} 
```

* * *

## 回答 #5

> 赞同：-4
> 
> 时间：2008-09-25T17:58:59.407

声明式：

```
<asp:DropDownList ID="ddlType" runat="server" Width="250px" AppendDataBoundItems="true" DataSourceID="dsTypeList" DataTextField="Description" DataValueField="ID">
    <asp:ListItem Value="0">All Categories</asp:ListItem>
</asp:DropDownList><br />
<asp:ObjectDataSource ID="dsTypeList" runat="server" DataObjectTypeName="MyType" SelectMethod="GetList" TypeName="MyTypeManager">
</asp:ObjectDataSource> 
```

上面绑定到返回通用列表的方法，但您也可以绑定到返回 DataReader 的方法。您还可以在代码中创建数据源。

# java - RichFaces 中的服务器端 DataTable 排序

> ID：134742
> 
> 赞同：8
> 
> 时间：2008-09-25T17:34:26.047
> 
> 标签：java, ajax, jsf, richfaces

我有一个列数可变的数据表和一个数据滚动条。如何启用服务器端排序？我更喜欢由用户单击列标题来触发它。

```
<rich:datascroller for="instanceList" actionListener="#{pageDataModel.pageChange}"/>
<rich:dataTable id="instanceList" rows="10" value="#{pageDataModel}"
                var="fieldValues" rowKeyVar="rowKey">
  <rich:columns value="#{pageDataModel.columnNames}" var="column" index="idx">
    <f:facet name="header">
      <h:outputText value="#{column}"/>
    </f:facet>          
    <h:outputText value="#{classFieldValues[idx]}" />
  </rich:columns>
</rich:dataTable> 
```

我已经在 bean 上有一个方法来执行排序。

```
public void sort(int column) 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-09-25T20:46:33.543

我最终手动完成。我在标题文本标签中添加了一个支持标签，就像这样。

```
<h:outputText value="#{column}">
  <a4j:support event="onclick" action="#{pageDataModel.sort(idx)}"
               eventsQueue="instancesQueue"
               reRender="instanceList,instanceListScroller"/>
</h:outputText> 
```

为了获得升/降箭头，我添加了一个 css 类。

```
<h:outputText value="#{column}" styleClass="#{pageDataModel.getOrderClass(idx)}" >
  <a4j:support event="onclick" action="#{pageDataModel.sort(idx)}"
               eventsQueue="instancesQueue"
               reRender="instanceList,instanceListScroller"/>
</h:outputText> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2010-05-14T14:48:03.067

您的数据模型需要实现“可修改”接口。

数据表将调用它的`modify()`方法来进行服务器端排序和过滤。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2010-07-15T14:52:37.460

这里有一个相当优雅的解决方案：

[http://livedemo.exadel.com/richfaces-demo/richfaces/sortingFeature.jsf?tab=ex-usage](http://livedemo.exadel.com/richfaces-demo/richfaces/sortingFeature.jsf?tab=ex-usage)

这个演示避免使用标签。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-22T14:36:32.483

看看“rich:columns”的“sortBy”属性，也许这就是你要找的。 [Richfaces 参考](http://www.jboss.org/file-access/default/members/jbossrichfaces/freezone/docs/devguide/en/html_single/index.html#columns)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-11-14T09:32:57.750

检索列表时不能只使用 Collection.sort() 吗？

# c# - C#中的布尔类型和布尔类型有什么区别

> ID：134746
> 
> 赞同：366
> 
> 时间：2008-09-25T17:35:27.857
> 
> 标签：c#, types, boolean

C#中的类型`bool`和类型有什么区别？`Boolean`

* * *

## 回答 #1

> 赞同：407
> 
> 时间：2008-09-25T17:39:20.950

`bool`是 的别名`System.Boolean`就像`int`是 的别名一样`System.Int32`。在此处查看完整的别名列表：[内置类型表（C# 参考）](https://msdn.microsoft.com/en-us/library/ya5y69ds.aspx)。

* * *

## 回答 #2

> 赞同：53
> 
> 时间：2008-09-25T17:37:05.027

我不相信有一个。

`bool`只是一个别名`System.Boolean`

* * *

## 回答 #3

> 赞同：22
> 
> 时间：2008-09-25T17:37:43.387

他们是一样的。bool 只是布尔值的别名。

* * *

## 回答 #4

> 赞同：19
> 
> 时间：2008-09-25T17:43:20.300

没有区别 - bool 只是 System.Boolean 的别名。

[http://msdn.microsoft.com/en-us/library/c8f5xwh7(VS.71).aspx](http://msdn.microsoft.com/en-us/library/c8f5xwh7(VS.71).aspx)

* * *

## 回答 #5

> 赞同：15
> 
> 时间：2012-09-26T23:43:55.240

我意识到这是多年后的事了，但我偶然发现了谷歌的这个页面，上面有同样的问题。

到目前为止，MSDN 页面上有一个细微差别。

VS2005

> 笔记：
> 
> 如果您需要一个也可以具有 null 值的布尔变量，请使用 bool。有关详细信息，请参阅 Nullable 类型（C# 编程指南）。

VS2010

> 笔记：
> 
> 如果您需要一个也可以具有 null 值的布尔变量，请使用 bool?。有关详细信息，请参阅 Nullable 类型（C# 编程指南）。

* * *

## 回答 #6

> 赞同：13
> 
> 时间：2008-09-25T17:40:28.187

他们是一样的。布尔值有助于简化 C# 和 VB.Net 之间的来回转换。大多数 C# 程序员倾向于喜欢“bool”，但如果你在一个同时有很多 VB.Net 和 C# 的商店，那么你可能更喜欢 Boolean，因为它在这两个地方都适用。

* * *

## 回答 #7

> 赞同：10
> 
> 时间：2008-09-25T17:40:40.370

如前所述，它们是相同的。有两个，因为 bool 是 C# 关键字，而 Boolean 是 .Net 类。

* * *

## 回答 #8

> 赞同：9
> 
> 时间：2008-09-25T17:37:55.743

一个是另一个的别名。

* * *

## 回答 #9

> 赞同：5
> 
> 时间：2008-09-25T17:40:49.620

bool 是布尔类的别名。我在声明变量时使用别名，在调用类上的方法时使用类名。

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2014-08-20T10:36:37.543

它们是相同的，Bool 只是 System.Boolean 的缩写。使用 VB.net 程序员时使用布尔值，因为它适用于 C# 和 Vb

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2016-08-05T16:51:30.543

~~bool 是原始类型，这意味着值（在这种情况下为真/假）直接存储在变量中。布尔值是一个对象。Boolean 类型的变量存储对 Boolean 对象的引用。唯一真正的区别是存储。一个对象总是比原始类型占用更多的内存，但实际上，将所有布尔值更改为 bool 不会对内存使用产生任何明显影响。~~

我错了; 这就是它在带有布尔值和布尔值的java中的工作方式。在 C# 中，bool 和 Boolean 都是引用类型。它们都直接将值存储在变量中，它们都不能为null，并且它们都需要“convertTO”方法将它们的值存储为另一种类型（例如int）。如果您需要调用在布尔类中定义的静态函数，那么使用哪一个才重要。

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2014-08-04T15:23:39.537

请注意，`Boolean`只有您拥有`using System;`（通常但不一定包括在内）才会起作用（除非您将其写为`System.Boolean`）。 `bool`不需要`using System;`

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2020-11-01T19:03:40.767

除非您获得类型字符串，否则没有实际区别。当您使用反射或 GetType() 时，您会得到 {Name = "Boolean" FullName = "System.Boolean"} 两者。

* * *

## 回答 #14

> 赞同：-1
> 
> 时间：2016-08-05T20:07:59.733

bool 是布尔值的别名。别名的作用是在编译代码之前将一个文本字符串替换为另一个文本字符串（如 notepad++ 中的 search/replace-all）。在运行时使用一个在另一个上没有影响。

在大多数其他语言中，一种是原始类型，另一种是对象类型（C# 术语中的值类型和引用类型）。C# 没有让您在两者之间进行选择。当您要调用 Boolean 类中定义的静态方法时，它会自动将 Boolean 视为引用类型。如果您创建一个新的布尔变量，它会自动将其视为引用类型（除非您使用 Activator.CreateInstance 方法）。

* * *

## 回答 #15

> 赞同：-2
> 
> 时间：2013-10-08T19:04:05.060

也许 bool 比布尔值“轻”一点；有趣的是，改变这个：

```
namespace DuckbillServerWebAPI.Models
{
    public class Expense
    {
        . . .
        public bool CanUseOnItems { get; set; }
    }
} 
```

...对此：

```
namespace DuckbillServerWebAPI.Models
{
    public class Expense
    {
        . . .
        public Boolean CanUseOnItems { get; set; }
    }
} 
```

...导致我的 cs 文件出现“使用系统”；将类型改回“bool”会导致 using 子句的头发变灰。

（Visual Studio 2010，WebAPI 项目）

# windows - 在不重新启动的情况下清除 Windows“运行”对话框历史记录

> ID：134748
> 
> 赞同：6
> 
> 时间：2008-09-25T17:35:33.877
> 
> 标签：windows, registry, windows-explorer, privacy

我目前正在开发一个程序，以立即清除出现在 Windows*开始*->*运行*对话框中的先前运行命令列表。*通过删除HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Explorer\RunMRU*键清除此列表的过程[有据可查](http://support.microsoft.com/kb/142298)；但是，在这些更改生效之前，似乎有必要执行以下操作之一：

1.  重新启动计算机
2.  选择*开始*->*关闭*，然后选择*取消*。

这些都不是我想要完成的任务的理想选择：#1 对用户极具破坏性，而#2 似乎需要额外的用户交互。

有谁知道如何在不需要任何用户交互的情况下立即（并以编程方式）强制重新加载此信息，*同时最大限度地减少对用户其他活动的干扰*？ **我希望在执行我的程序后立即清除用户的运行历史记录，*而不*需要他们采取任何进一步的行动（例如使用上面＃2中的“关闭”->“取消”技巧）或强制重新启动.**

或者，从不同的角度解决问题：单击*Start* -> *Shut Down* -> *Cancel*时，Windows 资源管理器会重新加载 RunMUI 键。 ***有没有办法在不让用户选择Shut Down*****然后*****Cancel*****的情况下强制进行类似的重新加载？**

 **## 我已经尝试过的事情：

*   [使用procmon](http://technet.microsoft.com/en-us/sysinternals/bb896645.aspx)监视 explorer.exe 状态，同时选择*Shutdown*然后*Cancel*。我看到 Explorer 正在写入 RunMRU 键，但无法确定是什么触发了这个。
*   许多谷歌搜索“重新加载 runmru 而不重新启动”。大多数结果仍然推荐上面的方法#1，尽管少数结果建议#2。
*   有限的 MSDN API 检查。RegFlushKey调用看起来[很有](http://msdn.microsoft.com/en-us/library/ms724867(VS.85).aspx)希望，但我以前从未使用过它，所以我不知道它是否适用于不同进程缓存的注册表信息。

任何建议或其他信息将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-09T05:47:16.503

你试过ccleaner吗？

[http://www.ccleaner.com/](http://www.ccleaner.com/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-01T06:23:28.550

不是您问题的完整答案，但我确实从PC Mag的这篇[文章中找到了触发清除运行命令的第三种方法。](http://www.pcmag.com/article2/0,2817,2109318,00.asp)

杀死explorer.exe再重新启动，注册表修改后也会清空运行列表。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-01T10:32:51.913

我有一个讨厌的黑客给你。以编程方式显示窗口，立即隐藏（以编程方式）并单击取消（好吧，您猜对了，以编程方式）。

您可以尝试寻找图标缓存刷新 API 或其他 API，如果它们具有您正在寻找的副作用，我不会太惊讶。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-02T02:51:49.657

我见过它实际工作的实例，即使 F5 键也不起作用？试试这个，ctrl>alt>delete 然后去任务管理器，进程选项卡...结束 explorer.exe。然后点击file new task并输入explorer.exe，然后检查...是否有效？

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2010-10-01T20:55:57.590

据我所知，它依赖于托管开始菜单/任务栏/桌面的 explorer.exe 进程被关闭并重新打开。我知道没有“干净”的方法可以做到这一点。

如果您*确实*需要在没有用户交互的情况下执行此操作，则需要关闭**所有**explorer.exe 进程并重新启动一个。

这是一个基本的 C# 程序来做到这一点；

```
 using System.Diagnostics;

  Process[] procs = Process.GetProcessesByName("explorer");
  foreach (Process proc in procs)
  {
    proc.Kill();
  }

  Process.Start("explorer.exe"); 
```

请注意，这将关闭所有打开的“Windows 资源管理器”窗口，之后可能会或可能不会打开额外的“Windows 资源管理器”。

我刚刚在 Windows XP 32bit 上测试过，它确实清除了运行命令缓存。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-26T15:25:00.487

视窗

1.  右键单击任务栏
2.  属性菜单选项
3.  开始菜单选项卡
4.  自定义按钮
5.  程序窗格
6.  清晰的列表
7.  点击确定

这会调用一个 Windows API 函数来刷新 explorere.exe 任务栏进程并清除列表（无需编辑注册表）。

* * *

## 回答 #7

> 赞同：-4
> 
> 时间：2008-10-01T06:38:16.173

HKEY_CURRENT_USER\ Software\ Microsoft\ Windows\ CurrentVersion\ Explorer\ RunMRU\

# release-management - 发布管理 - 最佳实践

> ID：134778
> 
> 赞同：13
> 
> 时间：2008-09-25T17:41:43.067
> 
> 标签：release-management, release-cycle

我在一家产品开发公司工作。我们首先进行内部发布，然后是公开发布。我想知道，其他产品开发公司如何管理他们的发布？你怎么给发布号？标记源代码管理？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2008-09-25T17:47:22.693

我们使用 SubVersion，其中标签和分支的创建成本很低。

就发布而言，我们遵循以下约定：

（主要版本）。（次要版本）。（补丁版本）。（SVN修订版）

*   补丁发布 = 错误修复
*   次要版本 = 二进制兼容 / 接口兼容
*   主要版本 = 包括重大更改。

那有意义吗？如果您需要更多信息，请添加评论，我将编辑我的帖子以澄清。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-11-03T21:44:30.053

[我创建了一个类似的问题](https://stackoverflow.com/questions/1669772/whats-the-right-way-to-manage-a-release-with-svn)，但我想补充一点：我强烈建议使用[**Jira 之**](http://www.atlassian.com/software/jira/)类的东西来管理发布周期。您可以将提交与请求/问题/错误相关联，然后将它们标记为发布的一部分。

特别是，*如果您想知道如何管理一个良好的发布周期，请查看 Apache 基金会是如何做到的，因为他们将其归结为一门科学*。例如，这里是[Mahout 项目中的发布路线图](https://issues.apache.org/jira/browse/MAHOUT?report=com.atlassian.jira.plugin.system.project:roadmap-panel)。

除了跟踪问题并将它们捆绑在发布包中的工作系统外，您还需要开始将其与持续集成（我使用过 CruiseControl 和 Hudson）和单元测试集成，以便您的构建周期与所有内容一起管理别的。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-09-25T18:53:33.627

我曾在一家定制软件供应商工作，当客户决定不想实施自己的呼叫中心和网站时，该供应商最终转变为解决方案供应商。

在那种环境下，每个主要客户都有机会定制系统工作方式的某些方面。因此，开发有一个核心产品，其中包含所有合同通用的组件，并为每个客户提供单独的分支（一些客户需要进行细微调整，其他客户需要与其他系统进行重大集成）。

它工作得很好，直到业务增长和分支机构数量扩大，通常是为了适应真正蹩脚的变化。在某一时刻，我认为他们拥有相同代码库的 15 个不同的活动版本……这使得事情变得非常不灵活且难以支持。

不要做我们所做的——让你的发布规模扩大！

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-10-16T20:10:56.303

正如其他人所说，处理管理释放的最佳方法是分支。我强烈建议您查看 TFS 分支指南 ( [http://tfsbranchingguideii.codeplex.com/Release/ProjectReleases.aspx?ReleaseId=20785](http://tfsbranchingguideii.codeplex.com/Release/ProjectReleases.aspx?ReleaseId=20785) )，它解释了根据项目大小和不同创建分支结构的几种方法向最终用户提供软件的方式（主要版本、服务包、修补程序）。其中大部分并非特定于 TFS，因此您可以将其应用于大多数其他源代码控制系统。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-09-25T17:51:11.297

在我的公司，当一个版本准备好时，我们为主要/次要版本号创建一个分支，称为`R_2_1`. 最初的发布是通过在之后立即创建一个快照分支或标签来完成的，称为`R_2_1_0`. 当 QA 针对某个版本提交错误时，会在分支上进行代码更改`R_X_Y`，然后`R_2_1_1`创建一个分支来标记该版本。所以树看起来像这样：

```
Mainline
|
|- R_2_1
|  |
|  |-R_2_1_0 (locked)
|  |
|  |
|  |-R_2_1_1 (locked)
|  |
.  .
.  .
.  . 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-10-16T19:58:15.800

基于 ITIL 框架的答案（或多或少等于其他框架）。

ITIL 将版本分为 3 组：主要软件版本、次要软件版本和紧急软件修复。

来自 ITIL 书籍：

• 主要软件版本和硬件升级，通常包含大量新功能，其中一些可能会使对问题的干预性修复变得多余。主要升级或发布通常会取代之前的所有次要升级、发布和紧急修复。
• 次要软件版本和硬件升级，通常包含小的增强和修复，其中一些可能已经作为紧急修复发布。次要升级或发布通常会取代之前的所有紧急修复。
•紧急软件和硬件修复，通常包含对少数已知问题的更正

所以，按照这个你应该有：

主要：v1、V2、v3 等
次要：v1.1、V2.1 等
紧急情况：v1.1.1、V2.1.1 等。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-06-01T10:43:12.673

我们使用 SVN 并为每个版本创建两个分支。一个是用于构建此版本的源代码的标签，一个是实际发布的二进制文件的新导入。这很重要，因为（无论您多么尝试使两个开发人员的机器相同，或尝试维护稳定的构建机器）当您尝试在 6 个月后重新生成构建 X 时，您会不可避免地发现一些东西已经改变并且产生的二进制文件略有不同。

小补丁在从发布源分支复制的分支中制作，并合并到主干中。然后可以通过将发布源分支复制到新分支并合并所需的任何补丁来轻松制作次要版本。

主要工作在从主干复制的分支中进行，完成后合并回主干。然后可以从主干进行主要版本。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2012-04-25T16:32:39.317

跟进 co-cat 关于 TFS 的回答。有一个新的 URL，其中包含 VS2010 和 VS11 的一些更新

[http://vsarbranchingguide.codeplex.com/releases](http://vsarbranchingguide.codeplex.com/releases)

# c# - 源自 SQL Server 的 Datagrid 使用情况

> ID：134785
> 
> 赞同：1
> 
> 时间：2008-09-25T17:42:40.070
> 
> 标签：c#, sql, winforms

我想知道使用链接到数据表组合（连接）的数据网格控件的最佳方式，这种方式既允许显示，也允许在基础表中创建新行和删除。

数据网格似乎提供了后一种功能，但我还没有找到一种让我满意的方法，而不仅仅是在一个网格上显示并提供特定的单独编辑创建和删除工具。

为了说明起见，假设数据库包含：-

客户表
* CustomerID
* CustomerName

订单表
* CustomerID
* OrderLineItem
* OrderLineQuanity

并且我想丢失 CustomerID 以用于显示目的，但希望能够创建新客户并删除现有客户，也许可以使用确认对话框。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-09-27T00:18:21.970

CSharpAtl 是正确的，使用 Master-Detail 控件。在 WinForm 应用程序中使用一个的示例位于[http://msdn.microsoft.com/en-us/library/y8c0cxey.aspx](http://msdn.microsoft.com/en-us/library/y8c0cxey.aspx)。

WinForm DataGrids 支持主记录和详细记录的添加、编辑和删除。至于您关于更改详细记录以使其与新主记录匹配会发生什么的问题；这是不可能的。根据设计，明细行仅包含与主记录匹配的记录，您不能（例如）将订单更改为属于新客户，因为明细行不包含任何客户信息。

如果要将 Detail 行移动到另一个 Master，则必须为新的 Master 创建一个新的 Detail 行，从旧的 Detail 行复制数据，并删除旧的 Detail 行。如果您有野心，您可以支持剪切和粘贴或拖放详细信息行，但在内部您必须创建/复制/删除。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-25T19:48:40.437

如果我正确理解了您的问题，那么您有一个查询执行多个表的连接，这些表显示在一个网格上。您希望用户能够操作该网格并让基础表反映更改。

解决这个问题的一种方法是实现存储过程来执行 CRUD 操作。存储过程将包含从所有必需的表中插入、更新和删除记录的逻辑。每个过程都需要为网格上的每个绑定字段提供一个参数。将过程设置为数据源上的插入、更新和删除命令。

所以想象一下，如果你正在向网格中添加一条新记录。网格调用插入命令，将参数传递给存储过程。然后在存储过程中，您将创建逻辑来确定网格中的新行是否需要新客户，或者它是否是现有客户，然后相应地调整操作。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-25T18:17:46.817

如果关系是一对多，您可以走使用 Master Detail 的路线。[链接文字][1]

[1]： http: [//msdn.microsoft.com/en-us/library/aa479344.aspx/](http://msdn.microsoft.com/en-us/library/aa479344.aspx/) “主细节”

# java - 为什么要池化无状态会话 bean？

> ID：134791
> 
> 赞同：28
> 
> 时间：2008-09-25T17:43:30.050
> 
> 标签：java, ejb, pooling, stateless-session-bean

Java 中的无状态 bean 不会在来自客户端的两次调用之间保持其状态。所以简而言之，我们可以将它们视为具有业务方法的对象。每个方法都接受参数并返回结果。当调用该方法时，正在执行堆栈中创建一些局部变量。当方法返回时，从堆栈中删除局部变量，如果分配了一些临时对象，它们无论如何都会被垃圾回收。

从我的角度来看，这与通过单独的线程调用同一单个实例的方法没有什么不同。那么，为什么一个容器不能使用一个 bean 的实例而不是汇集多个实例呢？

* * *

## 回答 #1

> 赞同：29
> 
> 时间：2008-09-25T18:24:22.357

池化做了几件事。

一，通过每个实例有一个bean，可以保证线程安全（例如，Servlet 不是线程安全的）。

第二，您减少了 bean 可能具有的任何潜在启动时间。虽然会话 Bean 是“无状态的”，但它们只需要对客户端是无状态的。例如，在 EJB 中，您可以将多个服务器资源注入到一个会话 Bean 中。该状态对于 bean 来说是私有的，但是没有理由不能阻止它从调用到调用。因此，通过合并 bean，您可以将这些查找减少到仅在创建 bean 时发生。

三、可以使用 bean pool 作为限制流量的手段。如果池中只有 10 个 Bean，则最多只能有 10 个请求同时工作，其余的将排队。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-25T20:30:17.047

池化提高了性能。

处理所有请求/线程的单个实例会导致大量争用和阻塞。

由于您不知道将使用哪个实例（并且多个线程可以同时使用一个实例），因此 bean 必须是线程安全的。

容器可以根据实际活动管理池大小。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-30T20:26:05.060

Java EE 模型的事务性使用线程上下文来管理事务生命周期。

存在这种简化，因此无需实现任何特定接口即可直接与 UserTransaction 对象交互；当从 InitialContext 检索事务（或注入会话 bean）时，它被绑定到线程局部变量以供重用（例如，如果无状态会话 bean 中的方法调用另一个也使用注入事务的无状态会话 bean。 )

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-25T19:13:38.820

Statelesss会话bean的生命周期是不存在，Passive和MethodReady（Passive或Inactive）状态。为了优化性能，而不是从创建到方法就绪状态遍历bean，容器通过管理主动和被动状态之间的bean容器回调 - ejbActivate() 和 ejbPassivate() 通过管理 bean 池。

sreenut

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2018-03-30T13:23:20.697

方法本质上是线程安全的（包括静态的）。为什么？很简单，因为方法中的每个变量都是在堆栈内存中创建的，即方法中使用的每个变量都是每次调用创建的（它不是共享的）。但是，参数不是堆栈的一部分。

但是，如果方法使用不安全的变量，则该方法是不安全的：

a) 调用静态字段或变量。然而，它发生在每一种情况下。

b) 调用它共享的资源。比如EntityManager。

c) 传递一个不安全的参数。

# c++ - 首次编译错误时自动停止 Visual C++ 2008 构建？

> ID：134796
> 
> 赞同：47
> 
> 时间：2008-09-25T17:44:38.067
> 
> 标签：c++, visual-studio, visual-studio-2008, visual-c++, visual-studio-2005

我知道我可以编译单个源文件，但有时——比如说，在编辑许多`.cpp`文件使用的头文件时——需要重新编译多个源文件。这就是 Build 的用途。

VC9 (Visual C++ 2008) 中“Build”命令的默认行为是尝试编译所有需要它的文件。有时这只会导致许多失败的编译。我通常只是注意错误并按 ctrl-break 手动停止构建。

有没有办法配置它，使构建在第**一个编译错误**（不是第一个失败的项目构建）时自动停止？

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2009-07-06T03:03:53.247

我想出了一个更好的宏家伙。它在第一个错误/秒后立即停止（更新构建窗口后）。

Visual Studio -> 工具 -> 宏 -> 宏 IDE...（或 ALT+F11）

```
Private Sub OutputWindowEvents_OnPaneUpdated(ByVal pPane As OutputWindowPane) Handles OutputWindowEvents.PaneUpdated
    If Not (pPane.Name = "Build") Then Exit Sub

    pPane.TextDocument.Selection.SelectAll()
    Dim Context As String = pPane.TextDocument.Selection.Text
    pPane.TextDocument.Selection.EndOfDocument()

    Dim found As Integer = Context.IndexOf(": error ")

    If found > 0 Then
        DTE.ExecuteCommand("Build.Cancel")
    End If

End Sub 
```

希望它对你们有用。

* * *

## 回答 #2

> 赞同：17
> 
> 时间：2008-10-11T22:30:57.257

这可以通过添加响应事件 OnBuildProjConfigDone 运行的宏来完成。

宏如下：

```
Private Sub BuildEvents_OnBuildProjConfigDone(ByVal Project As String, ByVal ProjectConfig As String, ByVal Platform As String, ByVal SolutionConfig As String, ByVal Success As Boolean) Handles BuildEvents.OnBuildProjConfigDone

  If Success = False Then
    DTE.ExecuteCommand("Build.Cancel")
  End If

End Sub 
```

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2011-01-21T10:20:39.193

是的，这在 MSVC 2005-2010 上运行良好：

```
Public Module EnvironmentEvents
  Private Sub OutputWindowEvents_OnPaneUpdated(ByVal pPane As OutputWindowPane) Handles OutputWindowEvents.PaneUpdated
    If Not (pPane.Name = "Build") Then Exit Sub

    Dim foundError As Boolean = pPane.TextDocument.StartPoint.CreateEditPoint().FindPattern(": error")
    Dim foundFatal As Boolean = pPane.TextDocument.StartPoint.CreateEditPoint().FindPattern(": fatal error")

    If foundError Or foundFatal Then
      DTE.ExecuteCommand("Build.Cancel")
    End If
  End Sub
End Module 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2014-01-08T09:17:45.040

我知道这个问题是针对 VS 2008 的，但是在为 VS 2012 搜索相同的答案时我偶然发现了它。由于 2012 年不再支持宏，因此宏解决方案将不再起作用。

[您可以在此处](http://visualstudiogallery.msdn.microsoft.com/92a14c1d-82ce-409d-8e16-3f2aac0a00ea)下载显然适用于 VS 2010 和 2012 的扩展程序。我可以确认它在 VS 2012 中运行良好。

[此](https://stackoverflow.com/a/3042159/2396122)响应中提供了扩展程序的原始链接。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-09-25T18:05:10.577

有[这篇文章](http://old.stevenharman.net/blog/archive/2008/01/17/visual-studio-tip-kill-that-build.aspx)- 不确定它是否会在第一个错误或解决方案中的第一个失败项目时停止构建。

Ctrl-break 也会手动停止它。

现在，如果有某种方法可以阻止它在构建失败后花费 10 分钟重建智能感知！

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2015-09-01T09:55:55.633

你也可以下载[这个](https://visualstudiogallery.msdn.microsoft.com/91aaa139-5d3c-43a7-b39f-369196a84fa5)扩展，似乎适用于每个版本的 Visual Studio

# spring - 您更喜欢将应用程序的哪些部分外部化为配置，为什么？

> ID：134797
> 
> 赞同：1
> 
> 时间：2008-09-25T17:45:07.940
> 
> 标签：spring, configuration

您的应用程序的哪些部分没有编码？我认为最明显的例子之一就是数据库凭证——硬编码被认为是不好的。在大多数情况下，很容易决定是否要外部化或编码。对我来说，规则很简单。如果出现以下情况，应将应用程序的某些部分外部化：

1.  它可以并且应该由非开发人员更改，但不经常包含在 UI 中定义的应用程序设置中（数据库凭据、服务 URL 等）
2.  它不需要编程语言并且看起来不自然被编码（本地化）

你有什么要补充的吗？

[这与这个关于 spring cfg](https://stackoverflow.com/questions/131975/what-are-benefits-of-dependency-injection-container)的问题有点相关。Spring 配置对我来说似乎不太明显，因为在我的实践中，除了开发人员之外，任何人都不会修改它。而外化的道路可以带你走很远，到整个项目都被“配置”，而不是编码——那么在哪里停下来呢？

因此，请根据您的经验在此处发布一些示例，当您从配置而不是编码的东西中受益时 - 比如 spring 中的依赖注入配置等。如果您使用 spring - 在不重新编译的情况下多久更改一次配置？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-09-25T17:47:30.837

在应用程序的不同部署之间需要有所不同的任何内容。也就是说，任何特定于环境的东西。

示例包括：

*   数据库连接字符串
*   Web 或 WCF 服务的 URL
*   日志记录配置

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-09-25T18:04:40.407

您的应用程序使用的任何信息都是“数据”，并且可能会根据其安装位置而改变。像：

*   用于发送电子邮件的 smtp 邮件服务器
*   数据库连接字符串
*   应用程序使用的文件位置/文件夹的路径
*   FTP 服务器和连接信息
*   用于身份验证的 Active Directory 服务器
*   应用程序中显示的任何指向外部信息源的链接
*   警告限值
*   我什至将 RegEx 过滤器用于限制数据输入字段的允许字符。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-09-25T17:54:59.993

除了明显变化的东西（路径、服务器、端口等）之外，有些人认为您应该能够轻松更改任何可能合理更改的内容，例如，假设您有一个在业务逻辑上运行的通用引擎（a规则引擎）。

然后，您将在“配置文件”上定义规则，最终不亚于使用 DSL 而不是通用目的语言进行编程。好处是它更接近域，因此更容易和更易于维护，并且您可以轻松更改原本需要新构建的东西。

这背后的主要论点是，你认为永远不会改变的事情最终总是会改变，所以你最好做好准备。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-09-25T17:46:37.750

想到路径和服务器名称/地址..

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-09-25T19:24:19.247

我还将添加加密密钥（它们本身应该被加密）......

基本上，经验法则是应用程序在进行常规功能操作之前需要的信息，它必须手头有数据（即本地和未联网）。
请注意，此数据不应该是动态变化的或大量的，否则它应该在数据库中。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-09-25T17:51:16.880

我同意你的两个条件，这就是为什么我：

1.  很少包含配置文件作为 Windows 或 Windows Mobile 应用程序的一部分（网络应用程序是的）。
2.  如果我*确实*包含了一个旨在由最终用户调整的配置文件，那么它肯定不会是 XML。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-09-25T17:55:50.927

员工的电子邮件/姓名，因为员工可以来去匆匆……（不过，您通常应该尝试将他们排除在应用程序之外）

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2008-09-25T18:00:26.827

配置文件应包括：

*   部署细节
    *   数据库凭据
    *   文件路径
    *   主机名
*   在许多地方使用但可能会改变的任何东西
    *   联系电子邮件地址
*   不在 GUI 中的选项

最后一个有点开放，但非常重要。我发现预见客户将来可能想要更改的变量非常有用。如果更改不频繁，我或他们可以编辑配置文件。如果它变得很常见，那么将选项添加到 GUI 中是微不足道的，它不是硬编码的。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2008-12-01T15:29:51.190

我使用 Spring 连接没有 GUI（事务开关）的 J2SE 应用程序中的所有 bean。这样我就很容易在每个部署中拥有不同的配置（我们在不同的国家运行这个东西），而不必编写任何不同的代码。当我使用普通 JDBC（或 Spring JDBC）时，我喜欢的另一件事是与代码分开管理所有 SQL 语句。就像在属性文件或 XML 或其他东西中一样，有时甚至作为将使用该语句的 bean 中的字符串属性（当只有一个 bean 将使用该语句时，例如 DAO）。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2008-11-29T07:55:04.230

对于 Spring 应用程序，我实际上区分了两种类型的配置：

1.  项目外部化为“部署时间”或“环境特定”的属性文件：服务器 IP/地址、文件系统位置等

2.  Spring XML 配置可以做很多事情，比如指示整体应用程序结构，通过 AOP 应用行为等。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2009-05-14T14:04:44.127

我打算使用spring JDBC或者vanilla JDBC进行数据持久化，这里我们决定将Java代码中的所有SQL都外部化，这样在SQL查询调优和优化方面可以更好地处理，我们不需要打扰爪哇代码。

# executable - 试图让 Windows 服务在共享驱动器上运行可执行文件

> ID：134805
> 
> 赞同：3
> 
> 时间：2008-09-25T17:47:22.227
> 
> 标签：executable, unc, windows-share

我有将在 Windows 服务中运行的 c#。我正在尝试使用 Process 和 ProcessStartInfo 类来运行可执行文件。如果可执行文件在本地驱动器上，没问题。但是，我需要在共享驱动器上运行可执行文件。我尝试使用 UNC 表示法 (//machine_name/share_name/directory/runme.exe)，但该过程似乎挂起。该服务和共享驱动器在 Windows XP 上。以前有没有人解决过这个问题？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-09-25T17:51:00.003

您的服务正在运行的帐户可能没有访问共享驱动器的权限。尝试将其配置为通过服务小程序以具有网络权限的用户身份运行。右键单击服务，选择属性并在登录选项卡中设置帐户。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-25T17:51:04.697

服务以什么帐户运行？

LocalSystem 将只允许访问本地文件系统。如果要访问网络资源，则必须以域或网络用户身份运行该服务。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-25T17:51:49.750

看看这个：[http ://forums.microsoft.com/MSDN/ShowPost.aspx?PostID=471168&SiteID=1](http://forums.microsoft.com/MSDN/ShowPost.aspx?PostID=471168&SiteID=1)

这应该会有所帮助。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-25T18:20:05.207

如果共享驱动器上的应用程序是 .Net 应用程序，请确保它具有足够的信任。

# javascript - Javascript：函数退出时触发操作

> ID：134815
> 
> 赞同：3
> 
> 时间：2008-09-25T17:48:35.937
> 
> 标签：javascript, triggers, function-exit

有没有办法监听 javascript 函数退出？功能完成时可以设置的触发器？

我试图在 AJAX 对象从数据库中检索数据时使用用户界面混淆技术 (BlockUI)，但该函数不一定最后执行，即使您将它放在函数调用的末尾。

例子：

```
function doStuff() {
  blockUI();
  ajaxCall();
  unblockUI();
}; 
```

在触发 unBlockUI 之前，doStuff 有没有办法监听 ajaxCall 完成？实际上，它线性地处理函数，按顺序调用每个对象，然后生成一个单独的线程来完成每个对象。因此，尽管我的 AJAX 调用可能需要 10-15 秒才能完成，但由于函数的线性执行，我只会阻止用户一瞬间。

解决这个问题的方法不太优雅......仅当 AJAX 函数设置的返回值设置为 true 或类似性质时，才结束循环。但这似乎不必要地复杂和低效。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-09-25T17:53:22.260

但是，您正在完成您的 Ajax 例程，您需要的是一个“回调”函数，该函数将在完成后运行：

```
function ajaxCall(callback){
    //do ajax stuff...
    callback();
} 
```

然后：

```
function doStuff(){
    blockUI();
    ajaxCall(unblockUI);
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-25T17:51:14.137

您的 AJAX 调用应该指定一个回调函数。您可以从回调中调用 unblockUI。

[SAJAX](http://www.modernmethod.com/sajax/)是一个简单的 AJAX 库，它对如何进行 AJAX 调用有更多帮助。

还有[另一篇文章](https://stackoverflow.com/questions/133310/how-can-i-get-jquery-to-perform-a-synchronous-rather-than-asynchronous-ajax-req)描述了您正在寻找的内容。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-25T17:51:23.090

你可以做一个同步的xhr。这将在调用期间导致整个 UI 阻塞（无论需要多长时间）。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-25T17:55:52.097

您需要重新设计程序流程以与异步流程兼容，例如指定处理响应后要调用的回调函数。查看 Prototype 或 JQuery 或 ... 是如何完成此任务的。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-09-25T23:58:24.550

答案很简单，当您的 ajax 请求返回结果时，您必须调用 unblockUI()，使用 jQuery 您可以这样做：

```
function doStuff(){

    blockUI();

    jQuery.ajax({
        url: "example.com",
        type: "POST",           //you can use GET or POST
        success: function(){

            unblockUI();
        }
    });
} 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-09-26T01:05:01.677

在我看来，您希望用户在从数据库中获取信息时等待。当我对数据库中的一些信息进行 Ajax 调用时，我所做的是显示一个动画 gif，上面写着“得到它......” - 它不断闪烁，直到信息被检索并显示在网页中。显示信息时，动画 gif 将关闭/隐藏，焦点将移至正在显示的新信息。动画 gif 让用户知道正在发生一些事情。

# bug-tracking - 错误修复时间分配

> ID：134821
> 
> 赞同：6
> 
> 时间：2008-09-25T17:50:38.070
> 
> 标签：bug-tracking

客户要求我们对我们遇到的每个错误进行时间估算。

尽管我们确实有一个固定的错误修复时间表并为此分配了时间，但我们没有为我们拥有的每个错误分配时间。简单地说，我们已经确定了我们的 bug 的优先级，并确保在分配的时间内修复最高优先级的 bug。

我不喜欢将时间分配给错误，原因很简单：

1.  它通常是不准确的。很难弄清楚修复需要多长时间。
2.  浪费时间。
3.  影响代码质量
4.  从长远来看会产生更多的错误（我们可能会在截止日期前完成它时错过某些事情）。

我们应该如何解决这个问题，我们不想提供每个错误的小时数，而只是一个关于修复哪些错误的时间框架？

你如何为你的 bug 分配时间？它有效吗？值得花时间和精力吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-09-25T17:55:08.963

我能给出的唯一答案是非常保守。猜猜需要多长时间，并将您的猜测乘以四。用它作为你的估计。正如你所说，很难弄清楚事情需要多长时间才能解决，最好说这需要比实际时间更长的时间，而不是因为你不够保守而被抓到“超过你的最后期限”。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-09-25T18:02:43.860

我工作的公司经常收到客户不合理的要求。 **要记住的关键是客户希望了解情况。** 我们发现最好的方法是状态报告。

所以，我们首先很好地解释了我们的立场。在您的示例中，这将是这样的：

> 我们有一个固定的时间表来修复我们项目中的错误，我们在历史上一直保持按计划进行的良好记录。但是，详细说明每个错误需要多长时间才能修复的过程很容易出错。我们很乐意为您提供关于已修复的错误和已测试的修复的每周更新（或每周两次或每天两次，具体取决于客户）。

但是，我确实认为最好尝试估计每个错误需要多长时间才能修复。这样做的原因是您需要了解修复所有错误的总时间。如果您无法估计修复各个部件需要多长时间，您将无法获得准确的估计。当然，这些可能是粗略的估计（估计不超过花一个小时研究问题）——你不想浪费太多时间进行估计。然后我通常会额外考虑 20%。所以假设错误的估计是 3 天、5 天和 2 天。然后我会向客户报告我们应该能够在 12 天内修复错误。当然，您可能需要花更多的时间来测试和重新包装您的产品，然后才能为他们提供可交付成果。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-09-25T18:02:31.237

不要从估计修复错误需要多长时间的角度来考虑这一点，因为你不可能正确估计。

**从管理客户愤怒**的角度考虑这一点。如果您告诉他们这些错误根本不需要时间来修复并且最终需要 3 个月，那么您的客户现在会对您感到满意，并且将来会对您感到愤怒。

如果您告诉他们这些错误需要 3 个月才能修复，而他们实际上需要 3 个月才能修复（他们会这样做），那么您的客户现在会很生气，并且将来会对您感到满意。

我通常会说 bug 根本不需要时间（2-3 天似乎是一个很好的安抚数字）。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-25T17:55:40.193

它应该与估计您拥有的任何其他任务相同。将其分解为尽可能小的任务，并尽可能准确地估计这些任务，并为意外情况进行填充。然后给他们一个范围，这样你就不会被限制在没有明确定义的任务上的特定日期。估计修复错误的时间和估计实现具有模糊需求的功能的时间之间没有区别。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-09-25T17:56:11.037

你是对的，估计通常是不准确的。

也许您想问他们，如果每个错误未修复，他们会花费多少。然后你可以执行适当的计算来确定它们是否应该被修复，以及你（或者实际上，他们）有多少时间可以投入到每个 bug 上。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-09-25T17:59:42.417

为什么不直接为错误严重程度选择几个波段，例如 1 小时、1/2 天、1 天、1 周并针对它们进行分配。通常你会对一个错误有一种感觉——那些你不知道的错误，把最坏的情况算出来！

由于您引用的原因（调查时间太长等），我认为您不会希望在比这更精细的水平上进行估计。

我不认为这是浪费时间。您的客户想要知道的不仅仅是错误的数量和它们的优先级——他们想要了解还有多少工作要做。

在任何情况下，这都不应该导致您产生更多的错误。你不应该急于解决这些问题。如果您估计 1 天而需要 10 小时，那没关系。如果您估计 1 周并花了 2 小时，那么结果很好！

这只是一个估计练习！

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-09-25T18:00:09.857

通常我们会同意必须为特定版本修复哪些错误，然后定义修复所有错误的时间范围。对于每个单独的错误，修复可能需要多长时间存在很多不确定性/可变性，但这往往会导致更多错误的平均数。对于某些您知道需要更长时间的错误，可能会给出一些估计，例如，如果您需要为其编写模拟器或测试框架。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-09-25T18:00:12.383

如果这些是已发现并报告的错误，那么您应该能够估计修复它的时间（以及重新测试的时间）。估算的置信度可能与您在估算上花费的时间成正比，或许可以向客户解释这一成本。

如果有许多相关的小错误报告，也许您可​​以将它们合并为一份综合报告。这可以避免客户纯粹根据个人估计来挑选要修复的错误。

# wpf - 在 WPF ComboBox 上，是否可以为文本框和弹出窗口设置不同的前景色？

> ID：134825
> 
> 赞同：5
> 
> 时间：2008-09-25T17:51:10.687
> 
> 标签：wpf, xaml, combobox

基本上我的问题源于希望文本框部分为白色，而下拉为黑色。当我将文本设置为白色时，下拉菜单显示为我想要的，但文本框中的文本本身很难阅读。将前景设置为黑色会使下拉菜单不可读。

有没有好的方法来处理这个？我还在学习WPF。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-09-25T18:04:10.750

编辑 ControlTemplate，您将看到一个 TextBlock 和另一个 PopUp，它们又具有一组控件。此文本框有不同的前景/背景，

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-25T17:54:04.660

最好的办法是编辑 ComboBox 模板的副本，并独立设置两者。

# php - 如何使用 php 找到文件的 mime 类型？

> ID：134833
> 
> 赞同：49
> 
> 时间：2008-09-25T17:51:52.247
> 
> 标签：php, filesystems, http-headers, content-type

好的，所以我有一个 index.php 文件，它必须处理许多不同的文件类型。我如何根据`REQUEST_URI`.

如果我请求`http://site/image.jpg`，并且所有请求都通过 index.php 重定向，看起来像这样

```
<?php
   include('/www/site'.$_SERVER['REQUEST_URI']);
?> 
```

我将如何使它正常工作？

我应该根据请求的文件的扩展名进行测试，还是有办法获取文件类型？

* * *

## 回答 #1

> 赞同：51
> 
> 时间：2008-09-25T17:59:56.347

如果您确定您只使用图像，您可以查看~~[获取图像大小（）](http://us3.php.net/manual/en/function.getimagesize.php)~~ [exif_imagetype()](http://us3.php.net/manual/en/function.exif-imagetype.php) PHP 函数，它尝试返回图像 mime 类型。

如果您不介意外部依赖，您还可以查看出色的[getID3](http://getid3.sourceforge.net)库，它可以确定许多不同文件类型的 mime 类型。

最后，您可以查看[mime_content_type()](http://us3.php.net/manual/en/function.mime-content-type.php)函数 - 但它已被[Fileinfo](http://us3.php.net/manual/en/ref.fileinfo.php) PECL 扩展所弃用。

* * *

## 回答 #2

> 赞同：22
> 
> 时间：2008-09-25T18:05:14.990

mime_content_type() 已被弃用，因此您将无法指望它在未来工作。有一个“fileinfo”PECL 扩展，但我还没有听说过它的好消息。

如果您在 *nix 服务器上运行，您可以执行以下操作，这对我来说效果很好：

```
$file = escapeshellarg( $filename );
$mime = shell_exec("file -bi " . $file);
$filename should probably include the absolute path. 
```

* * *

## 回答 #3

> 赞同：18
> 
> 时间：2012-08-30T07:29:28.913

```
function get_mime($file) {
  if (function_exists("finfo_file")) {
    $finfo = finfo_open(FILEINFO_MIME_TYPE); // return mime type ala mimetype extension
    $mime = finfo_file($finfo, $file);
    finfo_close($finfo);
    return $mime;
  } else if (function_exists("mime_content_type")) {
    return mime_content_type($file);
  } else if (!stristr(ini_get("disable_functions"), "shell_exec")) {
    // http://stackoverflow.com/a/134930/1593459
    $file = escapeshellarg($file);
    $mime = shell_exec("file -bi " . $file);
    return $mime;
  } else {
    return false;
  }
} 
```

对我来说，这些都不起作用 -`mime_content_type`已弃用、`finfo`未安装且`shell_exec`不允许。

* * *

## 回答 #4

> 赞同：10
> 
> 时间：2013-08-01T02:39:20.073

实际上，我厌倦了 PHP 中缺乏*标准*的MIME 嗅探方法。安装文件信息...使用不推荐使用的功能...哦，这些工作，但仅适用于图像！我厌倦了它，所以我做了一些研究并找到了[WHATWG Mimesniffing 规范](http://mimesniff.spec.whatwg.org/)——不过我相信这仍然是一个草案规范。

无论如何，使用这个规范，我能够在 PHP 中实现一个 mimesniffer。性能不是问题。事实上，在我简陋的机器上，我能够在 PHP 超时之前打开和嗅探数千个文件。

这是[MimeReader 类](https://github.com/shanept/MimeSniffer/)。

```
require_once("MimeReader.php");

$mime = new MimeReader(<YOUR FILE PATH>);
$mime_type_string = $mime->getType();     // "image/jpeg" etc. 
```

* * *

## 回答 #5

> 赞同：8
> 
> 时间：2013-03-06T19:34:56.990

如果您只使用图像并且需要 mime 类型（例如用于标题），那么这是最快和最直接的答案：

```
$file = 'path/to/image.jpg';
$image_mime = image_type_to_mime_type(exif_imagetype($file)); 
```

即使您重命名图像文件，它也会输出真实的图像 mime 类型

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-09-25T18:01:38.573

根据 php 手册，[finfo-file](http://us2.php.net/manual/en/function.finfo-file.php)函数是最好的方法。但是，您需要安装[FileInfo](http://us2.php.net/manual/en/ref.fileinfo.php) PECL 扩展。

如果扩展名不是一个选项，您可以使用过时的[mime_content_type](http://us2.php.net/mime_content_type)函数。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2016-01-31T05:20:22.370

`mime_content_type()`似乎是要走的路，尽管上面的评论说它已被弃用。`mime_content_type()`根据[http://php.net/manual/en/function.mime-content-type.php](http://php.net/manual/en/function.mime-content-type.php) ，它不是——或者至少这个化身没有被弃用。它是 FileInfo 扩展的一部分，但 PHP 文档现在告诉我们，它从 PHP 5.3.0 开始默认启用。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2016-10-12T17:34:25.313

从 PHP 5.3 开始，您可以使用 finfo 来完成此操作：

```
<?php
$info = new finfo(FILEINFO_MIME_TYPE);
echo $info->file('myImage.jpg');
// prints "image/jpeg" 
```

FILEINFO_MIME_TYPE 标志是可选的；没有它，你会得到一些文件的更详细的字符串；（显然某些图像类型会返回大小和颜色深度信息）。使用 FILEINFO_MIME 标志返回 mime 类型和编码（如果可用）（例如 image/png；charset=binary 或 text/x-php；charset=us-ascii）。有关更多信息，请参阅[此站点](https://www.inanimatt.com/php-files.html)。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-09-25T18:00:47.107

我没用过，但是有一个[PECL 扩展](http://pecl.php.net/package/Fileinfo)来获取文件的 mimetype。它的官方文档在[手册](http://www.php.net/manual/en/ref.fileinfo.php)中。

根据您的目的，文件扩展名可能没问题，但它不是非常可靠，因为它很容易更改。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2008-09-25T18:03:18.350

如果您只处理图像，则可以使用`[getimagesize()][1]`包含有关图像的各种信息的函数，包括类型。

更通用的方法是使用 PECL 的 FileInfo 扩展。此扩展的 PHP 文档可在以下位置找到：[http ://us.php.net/manual/en/ref.fileinfo.php](http://us.php.net/manual/en/ref.fileinfo.php)

有些人对该扩展有严重的抱怨......因此，如果您遇到严重问题或由于某种原因无法安装扩展，您可能需要查看已弃用的功能[`mime_content_type()`](http://us.php.net/manual/en/function.mime-content-type.php)

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2012-09-12T11:46:16.910

[我使用来自http://php.net/manual/de/function.mime-content-type.php](http://php.net/manual/de/function.mime-content-type.php) @''john dot howard at prismmg dot com 26-Oct-2009 03:43'的用户函数得到了非常好的结果 '

```
function get_mime_type($filename, $mimePath = '../etc') { ... 
```

不使用 finfo、exec 或不推荐使用的函数

也适用于远程资源！

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2016-08-24T18:58:38.053

如果你运行 Linux 并且有扩展，你可以简单地通过创建一个哈希数组从 /etc/mime.types 读取 MIME 类型。然后，您可以将其存储在内存中，并通过数组键简单地调用 MIME :)

```
/**
 * Helper function to extract all mime types from the default Linux /etc/mime.types
 */
function get_mime_types() {
    $mime_types = array();
    if (
        file_exists('/etc/mime.types') &&
        ($fh = fopen('/etc/mime.types', 'r')) !== false
    ) {
        while (($line = fgets($fh)) !== false) {
            if (!trim($line) || substr($line, 0, 1) === '#') continue;
            $mime_type = preg_split('/\t+/', rtrim($line));
            if (
                is_array($mime_type) &&
                isset($mime_type[0]) && $mime_type[0] &&
                isset($mime_type[1]) && $mime_type[1]
            ) {
                foreach (explode(' ', $mime_type[1]) as $ext) {
                    $mime_types[$ext] = $mime_type[0];
                }
            }
        }
        fclose($fh);
    }
    return $mime_types;
} 
```

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2017-11-28T01:02:59.197

你的服务器上的任何文件的 mime 都可以用这个得到

```
<?php
function get_mime($file_path){
  $finfo = new finfo(FILEINFO_MIME_TYPE);
  $type  = $finfo->file(file_path);
}

$mime = get_mime('path/to/file.ext'); 
```

# python - 初学者想知道他的代码是否是“Pythonic”

> ID：134834
> 
> 赞同：23
> 
> 时间：2008-09-25T17:52:03.947
> 
> 标签：python

这真的是我用python写的第一件事。我来自Java背景。我不想只学习如何使用 Python 语法编写 java 代码。我想学习如何在 pythonic 范式中编程。

你们能否评论一下我如何使以下代码更具pythonic？

```
from math import sqrt

# recursively computes the factors of a number
def factors(num):
    factorList = []
    numroot = int(sqrt(num)) + 1
    numleft = num
    # brute force divide the number until you find a factor
    for i in range(2, numroot):
        if num % i == 0:
            # if we found a factor, add it to the list and compute the remainder
            factorList.append(i)
            numleft = num / i
            break
    # if we didn't find a factor, get out of here!
    if numleft == num: 
        factorList.append(num)
        return factorList
    # now recursively find the rest of the factors
    restFactors = factors(numleft)
    factorList.extend(restFactors)

    return factorList

# grabs  all of the twos in the list and puts them into 2 ^ x form
def transformFactorList(factorList):
    num2s = 0
    # remove all twos, counting them as we go
    while 2 in factorList:
        factorList.remove(2)
        num2s += 1
    # simply return the list with the 2's back in the right spot
    if num2s == 0: return factorList
    if num2s == 1:
        factorList.insert(0, 2)
        return factorList
    factorList.insert(0, '2 ^ ' + str(num2s))
    return factorList

print transformFactorList(factors(#some number)) 
```

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2008-09-25T22:42:18.007

David Goodger 有一本很棒的入门书，叫做“像 Pythonista 一样的代码[”](http://python.net/~goodger/projects/pycon/2007/idiomatic/handout.html)。该文本中的一些内容重新命名（引用）：

*   `joined_lower`对于函数、方法、属性

*   `joined_lower`或 ALL_CAPS 表示常量

*   `StudlyCaps`上课

*   `camelCase`仅符合预先存在的约定

* * *

## 回答 #2

> 赞同：21
> 
> 时间：2008-09-25T18:18:14.057

只需使用 'import math' 和 'math.sqrt()' 而不是 'from math import sqrt' 和 'sqrt()'; 仅仅通过导入“sqrt”你不会赢得任何东西，而且代码很快就会因为太多的自导入而变得笨拙。此外，当您大量使用 from-import 时，诸如 reload() 和模拟测试之类的东西会更快地中断。

divmod() 函数是执行除法和取模的便捷方法。您可以使用 for/else 代替对 numleft 的单独检查。您的因子函数是生成器的自然候选者。xrange() 在另一个答案中已经提到过。这一切都是这样完成的：

```
import math

# recursively computes the factors of a number as a generator
def factors(num):
    numroot = int(math.sqrt(num)) + 1
    # brute force divide the number until you find a factor
    for i in xrange(2, numroot):
        divider, remainder = divmod(num, i)
        if not remainder:
            # if we found a factor, add it to the list and compute the
            # remainder
            yield i
            break
    else:
    # if we didn't find a factor, get out of here!
        yield num
        return
    # now recursively find the rest of the factors
    for factor in factors(divider):
        yield factor 
```

使用生成器确实意味着您只能对结果进行一次迭代；如果你只是想要一个列表（就像你在 translateFactorsList 中所做的那样），你将不得不在 list() 中包装对 factor() 的调用。

* * *

## 回答 #3

> 赞同：17
> 
> 时间：2008-09-25T22:54:38.370

您可能想要查看的另一件事是文档字符串。例如，此函数的注释：

```
# recursively computes the factors of a number
def factors(num): 
```

可以转换成这样：

```
def factors(num):
    """ recursively computes the factors of a number""" 
```

这样做并不是 100% 有必要这样做，但这是一个好习惯，以防你开始使用 pydoc 中的某些东西。

你也可以这样做：

### 文档字符串.py

```
"""This is a docstring""" 
```

### 在命令行：

```
>>> import docstring
>>> help(docstring) 
```

### 结果：

```
Help on module docstring:

NAME
    docstring - This is a docstring

FILE
    /Users/jason/docstring.py 
```

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2008-09-25T18:08:45.153

几点评论：

1.  我会替换`range()`为`xrange()`; 当您调用 时`range()`，它会一次分配整个范围，而当您遍历 时`xrange()`，它一次返回每个结果，从而节省内存。
2.  不要将表达式放在同一行 ( `if num2s -- 0: return factorList`) 的条件之后。它使一目了然地看到它在做什么（它是一个块）变得更加困难。
3.  不要害怕使用模块。该`[sympy][1]`模块已经具有计算因子的代码，这可以通过消除大部分代码来简化您的代码。
4.  Python 的字符串格式化简单而有效。

例如：

```
factorList.insert(0, '2 ^ ' + str(num2s)) 
```

可以改为

```
factorlist.insert(0, '2 ^ %s' % num2s) 
```

总而言之，我没有发现您的代码非常不符合 Python 风格。只需确保您要使用[floor division](http://www.python.org/doc/2.2.3/whatsnew/node7.html)，因为这是默认情况下使用整数值时往往会发生的情况。否则，您需要修复除法运算符：

```
from __future__ import division 
```

有时令人沮丧的语言警告。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2008-09-25T18:16:38.677

```
from itertools import takewhile

def transform_factor_list(factor_list):
    num_2s = len(list(takewhile(lambda e: e == 2, factor_list)))
    if num_2s > 1:
        factor_list[:num_2s] = ["2 ^ %i" % (num_2s, )]
    return factor_list 
```

这就是我从第二个功能中得到的。

大多数pythonic变化：

*   [PEP-8](http://www.python.org/dev/peps/pep-0008/)兼容命名
*   切片（并分配给切片）
*   迭代器
*   字符串格式化

该函数假设输入是有序的，它由因子实现。

**编辑**：删除了一些列表的特殊情况，这样更紧凑

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2010-01-07T15:49:15.543

根据克里斯的回答，稍微简化：

*   for 而不是外部 while
*   内部同时保留重复使用相同除数的能力
*   使用 itertools.groupby 大大简化了 compress()
*   修复 tostring() 中的一个小错误

高温：

```
import itertools

def factorize(n):
    # ideally an iterator of prime numbers
    # this'll work though
    divisors = itertools.count(2)

    for divisor in divisors:
        # This condition is very clever!
        # Note that `n` is decreasing, while `divisor` is increasing.
        # And we know that `n` is not divisible by anything smaller,
        # so this stops as soon as the remaining `n` is obviously prime.
        if divisor**2 > n:
            yield n
            break

        while n % divisor == 0:
            yield divisor
            n //= divisor

def compress(factors):
    for (factor, copies) in itertools.groupby(factors):
        # The second object yielded by groupby is a generator of equal factors.
        # Using list() to count its length.
        power = len(list(copies))
        yield (factor, power)

def tostring(compressed):
    return ' * '.join("%d**%d" % (factor, power) for (factor, power) in compressed)

# test
assert tostring(compress(factorize(12))) == '2**2 * 3**1' 
```

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2009-01-12T05:02:33.487

不要害怕列表推导。从 Java 切换到 Python 并发现它们是美好的一天。

对于因子函数，可能是这样的：

```
def factors(num):
    return [i for i in xrange(1, num+1) if num % i == 0] 
```

可能不是最好的代码，但它简短易懂。

祝 Python 好运，它是一门很棒的语言。

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2009-07-21T15:59:09.757

这就是我会这样做的方式......

```
import itertools
import collections

def factorize(n):
    # ideally an iterator of prime numbers
    # this'll work though
    divisors = itertools.count(2)

    divisor = divisors.next()
    while True:
        if divisor**2 > n:
            yield n
            break

        a,b = divmod(n, divisor)

        if b == 0:
            yield divisor
            n = a
        else:
            divisor = divisors.next()

def compress(factors):
    summands = collections.defaultdict(lambda: 0)

    for factor in factors:
        summands[factor] += 1

    return [(base, summands[base]) for base in sorted(summands)]

def tostring(compressed):
    return ' * '.join("%d**%d" % factor for factor in compressed) 
```

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2008-09-25T18:07:57.840

这就是我的想法：

```
def transformFactorList(factorList):
    oldsize = len(factorList)
    factorList = [f for f in factorList if f != 2]
    num2s = oldsize - len(factorList)
    if num2s == 0:
        return []
    if num2s == 1:
        return [2]+factorList
     return ['2 ^ %s' % num2s] + [factorList] 
```

这种形式`[f for f in factorList if f != 2]`称为列表理解。

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2009-01-12T05:18:50.490

由于这篇文章似乎是由凯西（笑）复活的，所以我会加上我的 2 美分。

**[浏览 PEP-8](http://www.python.org/dev/peps/pep-0008/)**中的所有内容。当我遇到代码格式问题时，它极大地帮助了我。

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2010-01-07T20:10:35.853

我会使用列表理解来将两者分开：

```
def transformFactorList(factorList):
    twos = [x for x in factorList if x == 2]
    rest = [x for x in factorList if x != 2]
    rest.insert(0, "2 ^ %d" % len(twos))
    return rest 
```

请注意，这将为您提供`2^0`and `2^1`，而您的代码没有。你用两个做的事情似乎是任意的（有时你得到一个字符串，有时是一个数字，有时什么都没有），所以我认为这会很好。如果你愿意，你可以很容易地改变它：

```
def transformFactorList(factorList):
    twos = [x for x in factorList if x == 2]
    rest = [x for x in factorList if x != 2]
    if twos:
        rest.insert(0, 2 if len(twos)==1 else "2 ^ %d" % len(twos))
    return rest 
```

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2010-01-07T16:27:32.503

使用递归（在没有必要的地方）不是 Pythonic。Python 没有尾递归消除，*flat 比 nested 好*。

如有疑问，请尝试`import this`

**更新**：根据大众的要求，这里是迭代分解（叹息）：

```
"""returns an iterator of tuples (factor, power) such that 
reduce(operator.mul, (factor**power for factor, power in factors(n))) == n """
def factors(n):
    i = 2
    while n > 1:
        p = 0
        while n > 1 and n % i == 0:
            p += 1
            n /= i
        if p:
            yield (i, p)
        i += 1 
```

# javascript - 我应该为 JavaScript 链接使用哪个“href”值，“#”还是“javascript:void(0)”？

> ID：134845
> 
> 赞同：4315
> 
> 时间：2008-09-25T17:54:27.140
> 
> 标签：javascript, html, performance, optimization, href

以下是构建链接的两种方法，其唯一目的是运行 JavaScript 代码。就功能、页面加载速度、验证目的等而言，哪个更好？

```
function myJsFunc() {
    alert("myJsFunc");
}
```

```
<a href="#" onclick="myJsFunc();">Run JavaScript Code</a>
```

或者

```
function myJsFunc() {
    alert("myJsFunc");
}
```

```
 <a href="javascript:void(0)" onclick="myJsFunc();">Run JavaScript Code</a>
```

* * *

## 回答 #1

> 赞同：2255
> 
> 时间：2008-09-26T08:03:39.907

I use `javascript:void(0)`.

Three reasons. Encouraging the use of `#` amongst a team of developers inevitably leads to some using the return value of the function called like this:

```
function doSomething() {
    //Some code
    return false;
} 
```

But then they forget to use `return doSomething()` in the onclick and just use `doSomething()`.

A second reason for avoiding `#` is that the final `return false;` will not execute if the called function throws an error. Hence the developers have to also remember to handle any error appropriately in the called function.

A third reason is that there are cases where the `onclick` event property is assigned dynamically. I prefer to be able to call a function or assign it dynamically without having to code the function specifically for one method of attachment or another. Hence my `onclick` (or on anything) in HTML markup look like this:

```
onclick="someFunc.call(this)" 
```

OR

```
onclick="someFunc.apply(this, arguments)" 
```

Using `javascript:void(0)` avoids all of the above headaches, and I haven't found any examples of a downside.

So if you're a lone developer then you can clearly make your own choice, but if you work as a team you have to either state:

Use `href="#"`, make sure `onclick` always contains `return false;` at the end, that any called function does not throw an error and if you attach a function dynamically to the `onclick` property make sure that as well as not throwing an error it returns `false`.

OR

Use `href="javascript:void(0)"`

The second is clearly much easier to communicate.

* * *

## 回答 #2

> 赞同：1384
> 
> 时间：2008-09-25T18:09:22.627

两者都不。

如果您有一个有意义的实际 URL，请将其用作 HREF。如果有人在您的链接上单击鼠标中键以打开新选项卡，或者如果他们禁用了 JavaScript，则不会触发 onclick。

如果这不可能，那么您至少应该使用 JavaScript 和适当的单击事件处理程序将锚标记注入文档。

我意识到这并不总是可能的，但在我看来，在开发任何公共网站时都应该努力做到这一点。

查看*[Unobtrusive JavaScript](http://en.wikipedia.org/wiki/Unobtrusive_JavaScript)*和*[Progressive enhancement](http://en.wikipedia.org/wiki/Progressive_enhancement)*（都是维基百科）。

* * *

## 回答 #3

> 赞同：798
> 
> 时间：2012-02-25T02:08:18.010

做事`<a href="#" onclick="myJsFunc();">Link</a>`或`<a href="javascript:void(0)" onclick="myJsFunc();">Link</a>`其他任何包含`onclick`属性的事情——五年前还可以，尽管现在这可能是一种不好的做法。原因如下：

1.  它促进了侵入式 JavaScript 的实践——事实证明，这种做法难以维护且难以扩展。在*[Unobtrusive JavaScript](http://en.wikipedia.org/wiki/Unobtrusive_JavaScript)*中了解更多信息。

2.  您正在花费时间编写极其冗长的代码——这对您的代码库几乎没有（如果有的话）好处。

3.  现在有更好、更容易、更易于维护和可扩展的方法来实现所需的结果。

## 不显眼的 JavaScript 方式

根本就没有`href`属性！任何好的 CSS 重置都会处理丢失的默认光标样式，所以这不是问题。然后使用优雅且不显眼的最佳实践附加您的 JavaScript 功能 - 由于您的 JavaScript 逻辑保留在 JavaScript 中而不是标记中，因此更易于维护 - 当您开始开发需要将您的逻辑拆分为的大型 JavaScript 应用程序时，这是必不可少的黑盒组件和模板。更多内容*[请参阅大型 JavaScript 应用程序架构](http://speakerdeck.com/u/addyosmani/p/large-scale-javascript-application-architecture)*

## 简单的代码示例

```
// Cancel click event
$('.cancel-action').click(function(){
    alert('Cancel action occurs!');
});

// Hover shim for Internet Explorer 6 and Internet Explorer 7.
$(document.body).on('hover','a',function(){
    $(this).toggleClass('hover');
});
```

```
a { cursor: pointer; color: blue; }
a:hover,a.hover { text-decoration: underline; }
```

```
<script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js"></script>
<a class="cancel-action">Cancel this action</a>
```

## 黑盒化*[Backbone.js](http://documentcloud.github.com/backbone/)*示例

有关可扩展、黑盒化的 Backbone.js 组件示例 -*[请在此处查看此工作 jsfiddle 示例](http://jsfiddle.net/balupton/sTzdD/)*。请注意我们如何利用不显眼的 JavaScript 实践，并且在少量代码中拥有一个可以在页面上重复多次的组件，而不会产生副作用或不同组件实例之间的冲突。惊人！

## 笔记

*   省略元素`href`上的属性`a`将导致无法使用`tab`键导航访问该元素。如果您希望这些元素可以通过`tab`键访问，您可以设置`tabindex`属性，或者改用`button`元素。您可以轻松地设置按钮元素的样式，使其看起来像*[Tracker1 的回答](https://stackoverflow.com/a/8525002/130638)*中提到的普通链接。

*   省略元素`href`上的属性将导致[Internet Explorer 6](http://en.wikipedia.org/wiki/Internet_Explorer_6)和[Internet Explorer 7](http://en.wikipedia.org/wiki/Internet_Explorer_7)不采用样式，这就是为什么我们添加了一个简单的 JavaScript shim 来代替通过。这完全没问题，就好像您没有 href 属性并且没有优雅降级一样，那么您的链接无论如何都不会工作 - 您将有更大的问题需要担心。`a``a:hover``a.hover`

*   如果您希望您的操作仍然在禁用 JavaScript 的情况下工作，那么使用一个`a`带有`href`属性的元素，该属性转到某个 URL，该 URL 将手动执行该操作，而不是通过 Ajax 请求或任何应该采取的方式。如果您正在执行此操作，那么您要确保`event.preventDefault()`在单击调用时执行一次单击，以确保单击按钮时它不会跟随链接。此选项称为优雅降级。

* * *

## 回答 #4

> 赞同：355
> 
> 时间：2008-09-25T17:55:34.953

`'#'`会将用户带回页面顶部，所以我通常使用`void(0)`.

`javascript:;`也表现得像`javascript:void(0);`

* * *

## 回答 #5

> 赞同：312
> 
> 时间：2011-12-15T18:41:57.957

老实说，我都不会建议。`<button></button>`我会为这种行为使用程式化的。

```
button.link {
  display: inline-block;
  position: relative;
  background-color: transparent;
  cursor: pointer;
  border: 0;
  padding: 0;
  color: #00f;
  text-decoration: underline;
  font: inherit;
}
```

```
<p>A button that looks like a <button type="button" class="link">link</button>.</p>
```

这样您就可以分配您的 onclick。我还建议通过脚本绑定，而不是使用`onclick`元素标签上的属性。唯一的问题是旧 IE 中无法禁用的伪 3d 文本效果。

* * *

如果您*必须*使用 A 元素，请使用`javascript:void(0);`已经提到的原因。

*   如果您的 onclick 事件失败，将始终拦截。
*   不会发生错误的加载调用，或基于哈希更改触发其他事件
*   如果单击失败（onclick throws），哈希标记可能会导致意外行为，除非它是适当的失败行为并且您想要更改导航历史记录，否则请避免它。

注意：您可以将 替换为`0`一个字符串，例如`javascript:void('Delete record 123')`它可以作为一个额外的指示符，显示点击实际执行的操作。

* * *

## 回答 #6

> 赞同：149
> 
> 时间：2008-09-25T17:56:53.467

第一个，最好有一个真实的链接，以防用户禁用了 JavaScript。只要确保返回 false 以防止在 JavaScript 执行时触发 click 事件。

```
<a href="#" onclick="myJsFunc(); return false;">Link</a> 
```

如果您使用 Angular2，这种方式有效：

`<a [routerLink]="" (click)="passTheSalt()">Click me</a>`.

见这里[https://stackoverflow.com/a/45465728/2803344](https://stackoverflow.com/a/45465728/2803344)

* * *

## 回答 #7

> 赞同：110
> 
> 时间：2008-09-25T18:59:47.497

如果你问我也不行；

如果您的“链接”的唯一目的是运行一些 JavaScript 代码，则它不属于链接；而是一段带有 JavaScript 函数的文本。我建议使用`<span>`带有`onclick handler`附加标签的标签和一些基本的 CSS 来模仿链接。链接是为导航而制作的，如果您的 JavaScript 代码不是用于导航，则它不应该是`<a>`标签。

例子：

```
function callFunction() { console.log("function called"); }
```

```
.jsAction {
    cursor: pointer;
    color: #00f;
    text-decoration: underline;
}
```

```
<p>I want to call a JavaScript function <span class="jsAction" onclick="callFunction();">here</span>.</p>
```

* * *

## 回答 #8

> 赞同：104
> 
> 时间：2008-09-25T18:35:42.470

理想情况下，您会这样做：

```
<a href="javascriptlessDestination.html" onclick="myJSFunc(); return false;">Link text</a> 
```

或者，更好的是，您将在 HTML 中拥有默认操作链接，并且您将在 DOM 呈现后通过 JavaScript 不显眼地将 onclick 事件添加到元素，从而确保如果 JavaScript 不存在/未使用您不有无用的事件处理程序使您的代码难以理解，并可能混淆（或至少分散注意力）您的实际内容。

* * *

## 回答 #9

> 赞同：76
> 
> 时间：2011-09-24T01:55:06.253

使用只是做一些有趣的动作，所以如果你想节省打字工作，`#`我建议使用.`#self``JavaScript bla, bla,`

* * *

## 回答 #10

> 赞同：71
> 
> 时间：2009-04-17T06:49:34.703

我使用以下

```
<a href="javascript:;" onclick="myJsFunc();">Link</a> 
```

反而

```
<a href="javascript:void(0);" onclick="myJsFunc();">Link</a> 
```

* * *

## 回答 #11

> 赞同：61
> 
> 时间：2008-10-16T17:46:51.417

我建议改用一个`<button>`元素，*尤其是*当控件应该产生数据变化时。（类似于 POST 的东西。）

如果你不显眼地注入元素，那就更好了，这是一种渐进增强。（请参阅[此评论](https://stackoverflow.com/questions/134845/href-for-javascript-links-or-javascriptvoid0#134957)。）

* * *

## 回答 #12

> 赞同：56
> 
> 时间：2008-09-27T10:58:16.537

我同意其他地方的建议，即您应该在`href`属性中使用常规 URL，然后在 onclick 中调用一些 JavaScript 函数。缺陷是，他们会`return false`在通话后自动添加。

这种方法的问题是，如果该功能不起作用或有任何问题，链接将变得无法点击。Onclick 事件将始终返回`false`，因此不会调用正常的 URL。

有非常简单的解决方案。`true`如果它工作正常，让函数返回。然后使用返回的值来确定是否应该取消点击：

**JavaScript**

```
function doSomething() {
    alert( 'you clicked on the link' );
    return true;
} 
```

**HTML**

```
<a href="path/to/some/url" onclick="return !doSomething();">link text</a> 
```

* * *

请注意，我否定了`doSomething()`函数的结果。如果它有效，它将返回`true`，因此它将被否定 ( `false`) 并且`path/to/some/URL`不会被调用。如果函数将返回`false`（例如，浏览器不支持函数中使用的某些内容或其他任何错误），则它被否定`true`并被`path/to/some/URL`调用。

* * *

## 回答 #13

> 赞同：52
> 
> 时间：2009-11-23T20:38:21.857

`#`比 好`javascript:anything`，但以下更好：

HTML：

```
<a href="/gracefully/degrading/url/with/same/functionality.ext" class="some-selector">For great justice</a> 
```

JavaScript：

```
$(function() {
    $(".some-selector").click(myJsFunc);
}); 
```

您应该始终争取优雅的降级（如果用户没有启用 JavaScript ......并且当它符合规范和预算时）。此外，直接在 HTML 中使用 JavaScript 属性和协议被认为是不好的形式。

* * *

## 回答 #14

> 赞同：43
> 
> 时间：2008-09-25T18:02:31.253

除非您使用 JavaScript 写出链接（以便您知道它已在浏览器中启用），否则理想情况下，您应该为禁用 JavaScript 浏览的人提供正确的链接，然后在 onclick 中阻止链接的默认操作事件处理程序。这样，启用 JavaScript 的用户将运行该功能，禁用 JavaScript 的用户将跳转到适当的页面（或同一页面内的位置），而不是仅仅单击链接而没有任何反应。

* * *

## 回答 #15

> 赞同：37
> 
> 时间：2009-11-07T02:26:48.550

绝对哈希（`#` ) 更好，因为在 JavaScript 中它是一个伪方案：

1.  污染历史
2.  实例化引擎的新副本
3.  在全局范围内运行并且不尊重事件系统。

当然，带有防止默认操作的 onclick 处理程序的“#”会更好。此外，仅用于运行 JavaScript 的链接并不是真正的“链接”，除非您在出现问题时将用户发送到页面上的某个合理的锚点（只有 # 将发送到顶部）。您可以简单地使用样式表模拟链接的外观和感觉，而完全忘记 href。

另外，关于cowgod的建议，特别是这个：`...href="javascript_required.html" onclick="...`这是个好方法，但它不区分“JavaScript禁用”和“onclick失败”场景。

* * *

## 回答 #16

> 赞同：30
> 
> 时间：2015-08-13T01:01:04.130

我通常去

```
<a href="javascript:;" onclick="yourFunction()">Link description</a> 
```

它比 javascript:void(0) 短并且做同样的事情。

* * *

## 回答 #17

> 赞同：27
> 
> 时间：2011-07-26T11:35:44.707

我选择 use `javascript:void(0)`，因为使用它可以防止右键单击打开内容菜单。但是`javascript:;`更短并且做同样的事情。

* * *

## 回答 #18

> 赞同：27
> 
> 时间：2011-12-16T00:09:40.960

我会使用：

```
<a href="#" onclick="myJsFunc();return false;">Link</a> 
```

**原因：**

1.  这使得`href`简单，搜索引擎需要它。如果您使用其他任何内容（例如字符串），则可能会导致`404 not found`错误。
2.  当鼠标悬停在链接上时，它不会显示它是一个脚本。
3.  通过使用`return false;`，页面不会跳转到顶部或破坏`back`按钮。

* * *

## 回答 #19

> 赞同：26
> 
> 时间：2016-01-26T19:54:18.667

**不要将链接用于运行 JavaScript 的唯一目的。**

使用 href="#" 将页面滚动到顶部；使用 void(0) 会在浏览器中产生导航问题。

相反，使用链接以外的元素：

```
<span onclick="myJsFunc()" class="funcActuator">myJsFunc</span> 
```

并使用 CSS 设置样式：

```
.funcActuator { 
  cursor: default;
}

.funcActuator:hover { 
  color: #900;
} 
```

* * *

## 回答 #20

> 赞同：24
> 
> 时间：2014-02-13T03:34:00.917

所以，当你用一个`<a />`标签做一些 JavaScript 事情时，如果你也放了，你可以在事件的末尾`href="#"`添加**return false** *（在内联事件绑定的情况下），*比如：

```
<a href="#" onclick="myJsFunc(); return false;">Run JavaScript Code</a> 
```

*或者您可以使用 JavaScript 更改**href**属性，例如：*

```
<a href="javascript://" onclick="myJsFunc();">Run JavaScript Code</a> 
```

**或者**

```
<a href="javascript:void(0)" onclick="myJsFunc();">Run JavaScript Code</a> 
```

* * *

但从语义上讲，上述所有实现这一点的方法都是错误的*（虽然效果很好）*。如果没有创建任何元素来导航页面并且有一些与之关联的 JavaScript 内容，那么它不应该是`<a>`标签。

您可以根据需要简单地使用 a`<button />`代替做事情或任何其他元素，如 b、span 或任何适合那里的元素，因为您可以在所有元素上添加事件。

* * *

因此，**使用**`<a href="#">`. 默认情况下，您会在该元素上获得光标指针`a href="#"`。为此，我认为您可以使用 CSS 来`cursor:pointer;`解决这个问题。

最后，如果您从 JavaScript 代码本身绑定事件，那么`event.preventDefault()`如果您使用标签，您可以做到这一点`<a>`，但如果您没有`<a>`为此使用标签，那么您将获得优势，您不需要不需要这样做。

所以，如果你看到了，最好不要为这类东西使用标签。

* * *

## 回答 #21

> 赞同：23
> 
> 时间：2008-10-23T09:55:57.323

使用jQuery会更好，

```
$(document).ready(function() {
    $("a").css("cursor", "pointer");
}); 
```

并省略`href="#"`和`href="javascript:void(0)"`。

锚标记标记将像

```
<a onclick="hello()">Hello</a> 
```

够简单！

* * *

## 回答 #22

> 赞同：20
> 
> 时间：2008-10-16T18:00:25.290

通常，您应该始终有一个后备链接，以确保禁用 JavaScript 的客户端仍然具有某些功能。这个概念被称为不显眼的 JavaScript。

示例...假设您有以下搜索链接：

```
<a href="search.php" id="searchLink">Search</a> 
```

您始终可以执行以下操作：

```
var link = document.getElementById('searchLink');

link.onclick = function() {
    try {
        // Do Stuff Here        
    } finally {
        return false;
    }
}; 
```

这样一来，`search.php`当您使用 JavaScript 的查看者查看您的增强功能时，将定向到禁用 JavaScript 的人。

* * *

## 回答 #23

> 赞同：19
> 
> 时间：2013-07-25T22:31:57.607

如果您碰巧使用的是[**AngularJS**](http://angularjs.org/)，您可以使用以下内容：

```
<a href="">Do some fancy JavaScript</a> 
```

这不会做任何事情。

此外

*   它不会带您到页面顶部，如 (#)
    *   因此，您不需要`false`使用 JavaScript显式返回
*   简明扼要

* * *

## 回答 #24

> 赞同：17
> 
> 时间：2008-09-25T21:20:35.317

我相信你提出了错误的二分法。这不是唯一的两个选择。

我同意 D4V360 先生的建议，即使你使用了锚标签，你也没有真正在这里有锚。您所拥有的只是文档的一个特殊部分，该部分的行为应该略有不同。一个`<span>`标签更合适。

* * *

## 回答 #25

> 赞同：17
> 
> 时间：2008-09-25T21:02:38.123

根据您想要完成的任务，您可能会忘记 onclick 并只使用 href：

```
<a href="javascript:myJsFunc()">Link Text</a> 
```

它绕过了返回 false 的需要。我不喜欢这个`#`选项，因为如前所述，它会将用户带到页面顶部。如果您有其他地方可以发送未启用 JavaScript 的用户（这在我工作的地方很少见，但这是一个非常好的主意），那么 Steve 提出的方法效果很好。

```
<a href="javascriptlessDestination.html" onclick="myJSFunc(); return false;">Link text</a> 
```

最后，`javascript:void(0)`如果您不想让任何人去任何地方并且不想调用 JavaScript 函数，则可以使用。如果您有一个希望发生鼠标悬停事件的图像，它会很好用，但是用户没有任何东西可以点击。

* * *

## 回答 #26

> 赞同：16
> 
> 时间：2014-04-26T18:37:30.263

我个人将它们结合使用。例如：

HTML

```
<a href="#">Link</a> 
```

* * *

用一点点 jQuery

```
$('a[href="#"]').attr('href','javascript:void(0);'); 
```

或者

```
$('a[href="#"]').click(function(e) {
   e.preventDefault();
}); 
```

但我使用它只是为了防止当用户单击空锚时页面跳转到顶部。我很少`on`直接在 HTML 中使用 onClick 和其他事件。

我的建议是使用`<span>`带有属性的元素`class`而不是锚点。例如：

```
<span class="link">Link</span> 
```

* * *

然后将函数分配给`.link`包含在正文中、`</body>`标记之前或外部 JavaScript 文档中的脚本。

```
<script>
    (function($) {
        $('.link').click(function() {
            // do something
        });
    })(jQuery);
</script> 
```

***注意：**对于动态创建的元素，请使用：

```
$('.link').on('click', function() {
    // do something
}); 
```

对于使用动态创建的元素创建的动态创建的元素，请使用：

```
$(document).on('click','.link', function() {
    // do something
}); 
```

* * *

然后你可以设置 span 元素的样式，让它看起来像一个带有一点 CSS 的锚：

```
.link {
    color: #0000ee;
    text-decoration: underline;
    cursor: pointer;
}
.link:active {
    color: red;
} 
```

这是上面提到**[的 jsFiddle](http://jsFiddle.net/mdesdev/Dn8YT/)**示例。

* * *

## 回答 #27

> 赞同：16
> 
> 时间：2016-10-29T19:10:16.520

我用开发者工具在谷歌浏览器中都试过了，`id="#"`花了 0.32 秒。而该`javascript:void(0)`方法只用了 0.18 秒。所以在谷歌浏览器中，`javascript:void(0)`工作得更好更快。

* * *

## 回答 #28

> 赞同：15
> 
> 时间：2012-06-25T19:34:39.380

当我有几个假链接时，我更喜欢给他们一个“无链接”类。

然后在 jQuery 中，我添加以下代码：

```
$(function(){
   $('.no-link').click(function(e){
       e.preventDefault();
   });
}); 
```

对于 HTML，链接很简单

```
<a href="/" class="no-link">Faux-Link</a> 
```

我不喜欢使用哈希标签，除非它们用于锚点，而且我只在有两个以上的虚假链接时才执行上述操作，否则我会使用 javascript:void(0)。

```
<a href="javascript:void(0)" class="no-link">Faux-Link</a> 
```

通常，我喜欢完全避免使用链接，而只是将一些东西包裹在一个跨度中，并将其用作激活某些 JavaScript 代码的一种方式，例如弹出窗口或内容显示。

* * *

## 回答 #29

> 赞同：14
> 
> 时间：2008-09-25T18:40:14.080

禁用 JavaScript 的用户可以访问您的站点是一件好事，在这种情况下，href 指向的页面执行与正在执行的 JavaScript 相同的操作。否则，我使用“ **#** ”和“ `return false;`”来防止其他人提到的默认操作（滚动到页面顶部）。

谷歌搜索“ `javascript:void(0)`”提供了很多关于这个主题的信息。其中一些，比如[这个](https://web.archive.org/web/20090210041609/http://blog.reindel.com/2006/08/11/a-hrefjavascriptvoid0-avoid-the-void/)提到**不使用 void(0)**的原因。

* * *

## 回答 #30

> 赞同：13
> 
> 时间：2011-12-14T22:09:59.440

我基本上是从[这篇实用文章中使用渐进增强来](http://www.matthidinger.com/archive/2011/02/22/Progressive-enhancement-tutorial-with-ASP-NET-MVC-3-and-jQuery.aspx)解释的。**简短的回答是你永远不会使用`javascript:void(0);`，或者`#`除非你的用户界面已经推断出 JavaScript 已启用，在这种情况下你应该使用`javascript:void(0);`**. 另外，不要使用 span 作为链接，因为这在语义上是错误的。

在您的应用程序中使用[SEO](http://en.wikipedia.org/wiki/Search_engine_optimization)友好的 URL 路由，例如 /Home/Action/Parameters 也是一种很好的做法。如果你有一个链接到一个没有 JavaScript 的页面，你可以在之后增强体验。使用指向工作页面的真实链接，然后添加 onlick 事件以增强演示文稿。

这是一个示例。Home/ChangePicture 是页面上的表单的工作链接，带有用户界面和标准 HTML 提交按钮，但它看起来更好地注入到带有 jQ​​ueryUI 按钮的模式对话框中。无论哪种方式都有效，具体取决于满足移动优先开发的浏览器。

```
<p><a href="Home/ChangePicture" onclick="return ChangePicture_onClick();" title="Change Picture">Change Picture</a></p>

<script type="text/javascript">
    function ChangePicture_onClick() {
        $.get('Home/ChangePicture',
              function (htmlResult) {
                  $("#ModalViewDiv").remove(); //Prevent duplicate dialogs
                  $("#modalContainer").append(htmlResult);
                  $("#ModalViewDiv").dialog({
                      width: 400,
                      modal: true,
                      buttons: {
                          "Upload": function () {
                              if(!ValidateUpload()) return false;
                              $("#ModalViewDiv").find("form").submit();
                          },
                          Cancel: function () { $(this).dialog("close"); }
                      },
                      close: function () { }
                  });
              }
        );
        return false;
    }
</script> 
```

* * *

## 回答 #31

> 赞同：13
> 
> 时间：2017-03-26T23:27:35.263

在现代网站上，如果元素仅执行 JavaScript 功能（不是真正的链接），则应避免使用 href。

为什么？这个元素的存在告诉浏览器这是一个带有目的地的链接。这样，浏览器将显示“在新选项卡/窗口中打开”功能（当您使用 shift+click 时也会触发）。这样做将导致打开同一页面而没有触发所需的功能（导致用户沮丧）。

关于 IE：从 IE8 开始，如果设置了 doctype，元素样式（包括悬停）将起作用。其他版本的 IE 真的不用担心了。

唯一的缺点：删除 HREF 会删除 tabindex。为了克服这个问题，您可以使用样式为链接的按钮或使用 JS 添加 tabindex 属性。

* * *

## 回答 #32

> 赞同：11
> 
> 时间：2009-02-28T17:06:31.770

你也可以像这样在锚中写一个提示：

```
<a href="javascript:void('open popup image')" onclick="return f()">...</a> 
```

所以用户会知道这个链接的作用。

* * *

## 回答 #33

> 赞同：10
> 
> 时间：2014-03-07T14:28:04.413

我将 href="#" 用于我想要虚拟行为的链接。然后我使用这段代码：

```
$(document).ready(function() {
    $("a[href='#']").click(function(event) {
        event.preventDefault();
    });
}); 
```

这意味着如果 href 等于哈希 (*="#") 它会阻止默认链接行为，因此仍然允许您为其编写功能，并且不会影响锚点点击。

* * *

## 回答 #34

> 赞同：10
> 
> 时间：2008-09-25T17:57:48.300

不要忽视你的 URL 可能是必要的事实——在引用之前触发了 onclick，所以有时你需要在离开页面之前在客户端处理一些东西。

* * *

## 回答 #35

> 赞同：10
> 
> 时间：2010-12-27T15:17:02.903

这里还有一件更重要的事情要记住。[第 508 节](http://en.wikipedia.org/wiki/Section_508_Amendment_to_the_Rehabilitation_Act_of_1973)合规性。正因为如此，我觉得有必要指出，您需要[JAWS](http://en.wikipedia.org/wiki/JAWS_%28screen_reader%29)等屏幕阅读器的锚标记才能通过选项卡对其进行聚焦。因此，“只使用 JavaScript 并忘记开头的锚点”的解决方案不是其中一些选项。仅当您无法让屏幕跳回顶部时，才需要在 href 中触发 JavaScript。您可以使用 0 秒的 settimeout 并将 JavaScript 触发到您需要关注的位置，但即使是 apage 也会跳到顶部然后返回。

* * *

## 回答 #36

> 赞同：10
> 
> 时间：2014-03-20T10:55:57.740

我想说最好的方法是为您从未使用过的 ID 制作一个 href 锚点，例如 #Do1Not2Use3This4Id5 或类似的 ID，您可以 100% 确定没有人会使用并且不会冒犯他人。

1.  `Javascript:void(0)`是个坏主意，违反了启用 CSP 的 HTTPS 页面上的内容安全策略[https://developer.mozilla.org/en/docs/Security/CSP](https://developer.mozilla.org/en/docs/Security/CSP)（感谢@jakub.g）
2.  使用 just`#`会让用户在按下时跳回顶部
3.  如果未启用 JavaScript，则不会破坏页面（除非您有 JavaScript 检测代码
4.  如果启用了 JavaScript，您可以禁用默认事件
5.  除非您知道如何阻止浏览器选择某些文本，否则您必须使用 href，（不知道使用 4 是否会删除阻止浏览器选择文本的内容）

基本上没有人在本文中提到 5，我认为这很重要，因为如果您的网站突然开始选择链接周围的内容，它就会显得不专业。

* * *

## 回答 #37

> 赞同：9
> 
> 时间：2008-10-23T14:22:33.540

只是为了了解其他一些人提到的观点。

最好绑定事件 'onload'a 或 $('document').ready{}; 然后将 JavaScript 直接放入 click 事件中。

在 JavaScript 不可用的情况下，我会使用指向当前 URL 的 href，也可能使用指向链接位置的锚点。该页面仍然可供没有 JavaScript 的人使用，那些没有注意到任何差异的人。

正如我手头的，这里有一些 jQuery 可能会有所帮助：

```
var [functionName] = function() {
   // do something
};

jQuery("[link id or other selector]").bind("click", [functionName]); 
```

* * *

## 回答 #38

> 赞同：9
> 
> 时间：2019-06-14T11:37:31.553

最简单也是大家使用最多的就是**javascript:void(0)**你可以用它来代替**#**来停止**标签重定向到标题部分**。

```
<a href="javascript:void(0)" onclick="testFunction();">Click To check Function</a>

function testFunction() {
    alert("hello world");
} 
```

* * *

## 回答 #39

> 赞同：8
> 
> 时间：2008-09-25T18:50:38.143

理想情况下，您应该有一个真实的 URL 作为非 JavaScript 用户的后备。

如果这没有意义，`#`请用作`href`属性。我不喜欢使用该`onclick`属性，因为它直接在 HTML 中嵌入了 JavaScript。一个更好的主意是使用外部 JS 文件，然后将事件处理程序添加到该链接。`#`然后，您可以阻止默认事件，以便 URL在用户单击后不会更改为附加。

* * *

## 回答 #40

> 赞同：8
> 
> 时间：2012-08-22T16:08:03.150

您可以使用 href 并删除所有只有散列的链接：

HTML：

```
<a href="#" onclick="run_foo()"> foo </a> 
```

JS：

```
$(document).ready(function(){         // on DOM ready or some other event

   $('a[href=#]').attr('href','');    // set all reference handles to blank strings
                                      //  for anchors that have only hashes

}); 
```

* * *

## 回答 #41

> 赞同：8
> 
> 时间：2012-03-16T02:16:13.690

我看到很多想要继续使用`#`值的人的答案`href`，因此，这是一个希望满足两个阵营的答案：

**A）**我很高兴拥有`javascript:void(0)`我的`href`价值：

```
<a href="javascript:void(0)" onclick="someFunc.call(this)">Link Text</a> 
```

**B）**我正在使用 jQuery，并希望`#`作为我的`href`价值：

```
<a href="#" onclick="someFunc.call(this)">Link Text</a>

<script type="text/javascript">
    /* Stop page jumping when javascript links are clicked.
       Only select links where the href value is a #. */
    $('a[href="#"]').live("click", function(e) {
         return false; // prevent default click action from happening!
         e.preventDefault(); // same thing as above
    });
</script> 
```

请注意，如果您知道不会动态创建链接，请改用该`click`函数：

`$('a[href="#"]').click(function(e) {`

* * *

## 回答 #42

> 赞同：8
> 
> 时间：2011-12-15T09:21:35.130

我从您的话中了解到，您想创建一个链接只是为了运行 JavaScript 代码。

那么你应该考虑到有些人在他们的浏览器中阻止了 JavaScript。

因此，如果您真的打算将该链接仅用于运行 JavaScript 函数，那么您应该动态添加它，这样即使用户没有在浏览器中启用他们的 JavaScript 并且您使用该链接只是为了触发一个 JavaScript 函数，当在浏览器中禁用 JavaScript 时，使用这样的链接是没有意义的。

出于这个原因，当 JavaScript 被禁用时，它们都不好。

Aand 如果启用了 JavaScript 并且您只想使用该链接来调用 JavaScript 函数，那么

```
<a href="javascript:void(0)" onclick="myJsFunc();">Link</a> 
```

比使用更好的方法

```
<a href="#" onclick="myJsFunc();">Link</a> 
```

因为 href="#" 会导致页面执行不需要的操作。

`<a href="javascript:void(0)" onclick="myJsFunc();">Link</a>`此外，另一个优于JavaScript 的原因是`<a href="#" onclick="myJsFunc();">Link</a>`JavaScript 被用作大多数浏览器的默认脚本语言。作为 Internet Explorer 的示例，它使用 onclick 属性来定义将使用的脚本语言的类型。除非弹出另一种好的脚本语言，否则 Internet Explorer 也会默认使用 JavaScript，但如果使用另一种脚本语言`javascript:`，它会让 Internet Explorer 了解正在使用的脚本语言。

考虑到这一点，我更喜欢使用和锻炼

```
<a href="javascript:void(0)" onclick="myJsFunc();">Link</a> 
```

足以让它成为一种习惯并更加用户友好，请在 JavaScript 代码中添加这种链接：

```
$(document).ready(function(){
    $(".blabla").append('<a href="javascript:void(0)" onclick="myJsFunc();">Link</a>')
}); 
```

* * *

## 回答 #43

> 赞同：8
> 
> 时间：2014-11-18T15:42:45.403

为什么不使用这个？这不会向上滚动页面。

```
<span role="button" onclick="myJsFunc();">Run JavaScript Code</span> 
```

* * *

## 回答 #44

> 赞同：7
> 
> 时间：2008-09-25T21:38:17.850

**If** you use a link as a way to **just** execute some JavaScript code (instead of using a span like D4V360 greatly suggested), just do:

```
<a href="javascript:(function()%7Balert(%22test%22)%3B%7D)()%3B">test</a> 
```

If you're using a link with onclick for navigation, don't use href="#" as the fallback when JavaScript is off. It's usually very annoying when the user clicks on the link. Instead, provide the same link the onclick handler would provide if possible. If you can't do that, skip the onclick and just use a JavaScript URI in the href.

* * *

## 回答 #45

> 赞同：7
> 
> 时间：2008-09-26T11:44:40.193

如果你正在使用一个`<a>`元素，只需使用这个：

```
<a href="javascript:myJSFunc();" />myLink</a> 
```

就我个人而言，稍后我会附加一个带有 JavaScript 的事件处理程序（也可以使用`attachEvent`或者`addEventListener`也许<把你最喜欢的 JavaScript 框架放在这里>）。

* * *

## 回答 #46

> 赞同：7
> 
> 时间：2010-07-17T22:46:42.633

与整体情绪完全一致，在`void(0)`需要时使用，在需要时使用有效 URL。

使用[URL 重写](http://en.wikipedia.org/wiki/Rewrite_engine)，您可以使 URL 不仅可以在禁用 JavaScript 的情况下执行您想要执行的操作，而且还可以准确地告诉您它要做什么。

```
<a href="./Readable/Text/URL/Pointing/To/Server-Side/Script" id="theLinkId">WhyClickHere</a> 
```

在服务器端，你只需要解析 URL 和查询字符串，然后做你想做的事。如果您很聪明，您可以允许服务器端脚本以不同的方式响应 Ajax 和标准请求。允许您拥有处理页面上所有链接的简洁集中代码。

[URL重写教程](http://www.easymodrewrite.com/)

优点

*   显示在状态栏中
*   通过 JavaScript 中的 onclick 处理程序轻松升级到 Ajax
*   实际上评论自己
*   防止您的目录被一次性使用的 HTML 文件弄得乱七八糟

缺点

*   仍应在 JavaScript 中使用 event.preventDefault()
*   服务器端相当复杂的路径处理和 URL 解析。

我敢肯定那里还有更多的缺点。随意讨论它们。

* * *

## 回答 #47

> 赞同：7
> 
> 时间：2019-01-02T15:45:25.967

# 2019 年 1 月编辑

在**HTML5**中，使用没有 href 属性的 a 元素是**有效**的。它被认为是**“占位符超链接”**

> 如果 a 元素没有 href 属性，则该元素代表一个占位符，用于放置链接，如果它是相关的，则仅包含元素的内容。

例子：

```
<a>previous</a> 
```

如果在那之后你想做其他事情：

1 - 如果您的链接无处可去，请不要使用`<a>`元素。使用 a`<span>`或其他适当的东西并添加 CSS`:hover`以根据需要设置样式。

2 -如果您想要原始、精确和快速，请使用`javascript:void(0)`OR `javascript:undefined`OR 。`javascript:;`

* * *

## 回答 #48

> 赞同：6
> 
> 时间：2013-02-08T14:15:02.623

你**不应该在你的 HTML 中使用**inline`onclick="something();"`来避免无意义的代码污染它；所有点击绑定都必须在 Javascript 文件 (*.js) 中设置。

像这样设置绑定：`$('#myAnchor').click(function(){... **return false**;});` 或 `$('#myAnchor').bind('click', function(){... **return false**;});`

然后你有一个干净的 HTML 文件，易于加载（并且对 seo 友好），没有数千个`href="javascript:void(0);"`而且只是`href="#"`

* * *

## 回答 #49

> 赞同：6
> 
> 时间：2011-12-14T21:06:36.227

我强烈希望尽可能地让我的 JavaScript 远离我的 HTML 标记。如果我`<a>`用作单击事件处理程序，那么我建议使用`<a class="trigger" href="#">Click me!</a>`.

```
$('.trigger').click(function (e) {
    e.preventDefault();
    // Do stuff...
}); 
```

值得注意的是，许多开发人员认为将锚标记用于单击事件处理程序并不好。他们希望您使用 a `<span>`or`<div>`和一些添加`cursor: pointer;`到它的 CSS。这是一个争论不休的问题。

* * *

## 回答 #50

> 赞同：3
> 
> 时间：2012-03-15T09:43:37.887

为了完整起见，这里还有一个选项，即使 JavaScript 被禁用，它也会阻止链接做任何事情，而且它很短:)

```
<a href="#void" onclick="myJsFunc()">Run JavaScript function</a> 
```

如果页面上不存在 id，则链接将不执行任何操作。

一般来说，我同意 Aaron Wagner 的回答，应该将 JavaScript 链接与 JavaScript 代码一起注入到文档中。

* * *

## 回答 #51

> 赞同：3
> 
> 时间：2021-03-01T18:48:59.477

这里实际上有**四个选项**。

`return false;`如果您希望在***禁用*****JavaScript或用户代理不支持它***的浏览器中安全“回退” （现在占用户的 1-5%），使用它可以让您保留锚版本。`href` **如果脚本失败**，您可以使用锚点“#”符号、空字符串或特殊 URL 。请注意，您必须使用`href`屏幕阅读器才能知道它是超链接。（注意：我不打算讨论关于删除`href`属性的争论，因为这一点在这里没有实际意义。没有`href`锚点意味着锚点不再是超链接，而只是一个带有点击事件的 html 标记被捕获。 )*

 *```
<a href="" onclick="alert('hello world!');return false;">My Link</a>
<a href="#" onclick="alert('hello world!');return false;">My Link</a>
<a href="MyFallbackURL.html" onclick="alert('hello world!');return false;">My Link</a> 
```

下面是今天比较流行的使用`javascript:void(0)`内部`href`属性的设计。如果浏览器不支持脚本，它应该再次返回其页面，因为`href`超链接路径返回一个空字符串。如果您不在乎谁支持 JavaScript，请使用此选项。

```
<a href="javascript:void(0);" onclick="alert('hello world!');">My Link</a> 
```

* * *

## 回答 #52

> 赞同：3
> 
> 时间：2019-05-14T13:40:51.090

•`Javascript: void(0);`对空值**[未分配]**无效，这意味着您的浏览器将`NULL`单击**DOM**，并且窗口返回 false。
•`'#'`不遵循javascript 中的DOM 或Window。这意味着锚 href 内的 '#' 符号是**LINK**。链接到相同的电流方向。

* * *

## 回答 #53

> 赞同：2
> 
> 时间：2019-05-29T04:49:55.830

您可以在此处使用 javascript:void(0) 而不是使用 # 来停止锚标记重定向到标题部分。

```
function helloFunction() {
    alert("hello world");
}
<a href="javascript:void(0)" onclick="helloFunction();">Call Hello Function</a> 
```

* * *

## 回答 #54

> 赞同：0
> 
> 时间：2021-06-27T10:17:40.790

`javascript:void(0)`将来会弃用，因此您应该使用`#`.

* * *

## 回答 #55

> 赞同：-2
> 
> 时间：2017-10-04T19:47:25.140

4.0 之前的引导模式有一个基本上没有记录的行为，它们将使用 AJAX`href`从元素加载 s ，`a`除非它们完全是`#`. 如果您使用的是 Bootstrap 3，`javascript:void(0);`hrefs 将导致 javascript 错误：

`AJAX Error: error GET javascript:void(0);`

在这些情况下，您需要升级到 bootstrap 4 或更改 href。

# windows - 在 Visual C++ 中构建错误/成功的声音？

> ID：134847
> 
> 赞同：11
> 
> 时间：2008-09-25T17:54:35.533
> 
> 标签：windows, visual-studio, visual-studio-2008, visual-c++, visual-studio-2005

在长时间的 Visual C++ 构建中，听到某种（可选）声音对于构建/编译结果非常有帮助，例如：

*   个别编译错误
*   文件编译成功/失败
*   构建成功/失败
*   批量构建成功/失败

有谁知道如何在 Visual C++（尤其是 Vista 上的 Visual C++ 2008）中为这些类型的构建事件启用声音？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2008-09-25T18:56:59.237

CJM 几乎是对的。

在 VC++ 9 (Visual Studio 2008) 中，转到控制面板的声音小程序（Vista 中的控制面板/硬件和声音/声音）。

在“声音”选项卡下，滚动到“Microsoft Visual Studio”下的“构建成功”，并为此事件设置声音。

如果您在这台 PC 上拥有（或拥有）多个 VS（我有 6.0、2003、2005 和 2008），则可能有多个名称为“Microsoft Developer”或空白的条目 - 我假设它们适用于旧版本。我经常最终设置错误的。看来您必须关闭 VS 2008 并重新打开才能生效。

有人提到这在 VS 2005 中被破坏/删除 - 我也注意到了这一点。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-09-25T17:56:51.110

转到开始 | 设置 | 控制面板 | 声音，单击声音选项卡，然后自定义 Microsoft Developer 下的条目。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-25T17:59:43.180

在 VS2005 中，声音子系统无法正常工作，不确定它是否在 2008 年修复。使用宏，您可以播放声音，例如成功的构建和失败的构建的不同声音，但是我认识的人做了他们由于宏失败而不断崩溃。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-09-25T18:16:00.677

另一种解决方案是安装[Visual Studio Power Toys](http://msdn.microsoft.com/en-us/vs2005/aa718340.aspx)。这包括一个名为“Toast”的功能，当构建完成时，它会在系统托盘中显示通知。您可能会看到这是否具有对声音通​​知有用的选项。

# perl - 在 Perl 中发出 HTTP GET 请求的最简单方法是什么？

> ID：134858
> 
> 赞同：44
> 
> 时间：2008-09-25T17:55:57.213
> 
> 标签：perl, web-services, http

我有一些我用 PHP 编写的代码来使用我们的简单 web 服务，我还想在 Perl 中为可能更喜欢该语言的用户提供这些代码。发出 HTTP 请求的最简单方法是什么？在 PHP 中，我可以用`file_get_contents()`.

这是我要移植到 Perl 的全部代码：

```
/**
 * Makes a remote call to the our API, and returns the response
 * @param cmd {string} - command string ID
 * @param argsArray {array} - associative array of argument names and argument values
 * @return {array} - array of responses
 */
function callAPI( $cmd, $argsArray=array() )
{
   $apikey="MY_API_KEY";
   $secret="MY_SECRET";
   $apiurl="https://foobar.com/api";

   // timestamp this API was submitted (for security reasons)
   $epoch_time=time();

   //--- assemble argument array into string
   $query = "cmd=" .$cmd;
   foreach ($argsArray as $argName => $argValue) {
       $query .= "&" . $argName . "=" . urlencode($argValue);
   }
   $query .= "&key=". $apikey . "&time=" . $epoch_time;

   //--- make md5 hash of the query + secret string
   $md5 = md5($query . $secret);
   $url = $apiurl . "?" . $query . "&md5=" . $md5;

   //--- make simple HTTP GET request, put the server response into $response
   $response = file_get_contents($url);

   //--- convert "|" (pipe) delimited string to array
   $responseArray = explode("|", $response);
   return $responseArray;
} 
```

* * *

## 回答 #1

> 赞同：77
> 
> 时间：2008-09-25T17:59:43.163

LWP::简单：

```
use LWP::Simple;
$contents = get("http://YOUR_URL_HERE"); 
```

* * *

## 回答 #2

> 赞同：19
> 
> 时间：2008-09-25T18:02:39.677

LWP::Simple 具有您正在寻找的功能。

```
use LWP::Simple;
$content = get($url);
die "Can't GET $url" if (! defined $content); 
```

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2008-09-25T17:59:29.530

看看[LWP::Simple](http://search.cpan.org/perldoc?LWP::Simple)。对于更多涉及的查询，甚至还有[一本关于它的书](http://oreilly.com/catalog/9780596001780/)。

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2008-09-25T17:59:52.260

我会使用[LWP::Simple](http://metacpan.org/pod/LWP::Simple)模块。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2008-09-25T18:00:55.470

试试[HTTP::Request](https://metacpan.org/pod/HTTP::Request)模块。此类的实例通常传递给 LWP::UserAgent 对象的 request() 方法。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2013-09-20T04:23:51.610

[Mojo::UserAgent](http://search.cpan.org/perldoc?Mojo%3a%3aUserAgent)也是一个不错的选择！

```
 use Mojo::UserAgent;
  my $ua = Mojo::UserAgent->new;

  # Say hello to the Unicode snowman with "Do Not Track" header
  say $ua->get('www.☃.net?hello=there' => {DNT => 1})->res->body;

  # Form POST with exception handling
  my $tx = $ua->post('https://metacpan.org/search' => form => {q => 'mojo'});
  if (my $res = $tx->success) { say $res->body }
  else {
    my ($err, $code) = $tx->error;
    say $code ? "$code response: $err" : "Connection error: $err";
  }

  # Quick JSON API request with Basic authentication
  say $ua->get('https://sri:s3cret@example.com/search.json?q=perl')
    ->res->json('/results/0/title');

  # Extract data from HTML and XML resources
  say $ua->get('www.perl.org')->res->dom->html->head->title->text;` 
```

样本直接来自 CPAN 页面。当我无法让 LWP::Simple 在我的机器上工作时，我使用了它。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2015-03-20T09:23:49.850

如果它在 Unix 中并且没有安装 LWP::Simple，您可以尝试：

```
my $content = `GET "http://trackMyPhones.com/"`; 
```

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2016-01-29T20:32:01.730

我认为[Srihari 可能引用](https://stackoverflow.com/questions/134858/whats-the-simplest-way-to-make-a-http-get-request-in-perl/29163199#29163199)的是[Wget](https://www.gnu.org/software/wget/)，但我实际上建议（再次，在没有 LWP::Simple 的 *nix 上）使用[cURL](http://curl.haxx.se/)：

```
$ my $content = `curl -s "http://google.com"`;
<HTML><HEAD><meta http-equiv="content-type" content="text/html;charset=utf-8">
<TITLE>301 Moved</TITLE></HEAD><BODY>
<H1>301 Moved</H1>
The document has moved
<A HREF="http://www.google.com/">here</A>.
</BODY></HTML> 
```

旗帜`-s`告诉 curl 保持沉默。否则，您每次都会在标准错误上获得 curl 的进度条输出。

# windows - WinDbg Dr. Watson minidump - 需要最初为已安装版本构建的 pdb/dll？

> ID：134866
> 
> 赞同：3
> 
> 时间：2008-09-25T17:57:18.927
> 
> 标签：windows, debugging, dll, windbg, dr.watson

我有一个来自目标应用程序崩溃的 mindmp 文件。我是否可以为某个软件版本重建 dll/pdb 文件并正确加载 windbg 符号？

我的问题是我们的 pdb 文件只保留在主要版本中（不幸的是）。这是一个每日构建，我可以自己重建，但我被错误绊倒了。

使用 !sym 嘈杂：“图像标题与内存图像标题不匹配。”

```
DBGENG:  C:\...\XXX.dll image header does not match memory image header.
DBGENG:  XXX.dll - Partial symbol image load missing image info
DBGHELP: Module is not fully loaded into memory.
DBGHELP: Searching for symbols using debugger-provided data.
DBGHELP: C:\...\XXX.pdb - mismatched pdb 
```

注意我已经用 dll 构建了 pdb，它们来自同一个 RELEASE 目录（我应该构建调试吗？）

这些是发布版本（因为发布版本安装在目标上并崩溃）我是否应该以某种方式使用调试构建 dll 来获取更多符号信息？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2008-10-02T03:47:42.300

[ChkMatch](http://www.debuginfo.com/tools/chkmatch.html "校验匹配")实用程序专为这种确切情况而设计。只要您拥有原始 .EXE，就可以重新编译源代码（使用相同的编译器和编译器设置）并修补新的 .PDB 以匹配旧的 .EXE。

在此示例中，*OriginalExecutable.exe*是不再具有 .PDB 文件的可执行文件，而*RebuiltPDB.pdb*是通过重建原始源生成的可执行文件。

```
chkmatch -m OriginalExecutable.exe RebuiltPDB.pdb 
```

现在，只要这两个文件有它们的原始名称，调试器就应该接受它们作为匹配对。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2008-09-25T18:05:06.943

以我的经验可能不会。

如果您有确切的构建目录并使用**完全相同的**编译器设置进行构建，那么这可能会起作用。您肯定无法从调试版本中针对发布崩溃转储加载符号。

您将需要打开“加载任何内容”选项：.symopt+0x40 以让 windbg 忽略时间戳差异。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-10-24T12:31:25.903

如果您仍然拥有编译映像的确切源代码，则重建它以生成一个新的 pdb 文件，然后指示 WinDbg 在您打开故障转储时强制加载此 pdb - 它在我的实践中工作过一次。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-14T16:10:24.153

PDB 文件通过 GUID 和“年龄”（它是一个序列号）与它们的 EXE 文件相关联。这些嵌入在 EXE 和 PDB 中。GUID 在每次完整构建时重新生成，并且“年龄”在每次增量构建时更改。

调试器使用这些来确保它正在查看 EXE 文件的正确 PDB。

我不知道 SteveMan 提到的“chkmatch”工具，但我怀疑它可以通过修补 GUID/age 以使其匹配来工作。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2014-01-13T19:32:21.960

帮助 Doug 为时已晚，但为了遇到这个问题的任何人，另一个线程（[是否可以在 Visual Studio 中加载不匹配的符号？](https://stackoverflow.com/questions/3660084/is-it-possible-to-load-mismatched-symbols-in-visual-studio)）指出了一种让 WinDbg 接受不匹配的 .PDB 文件的方法

```
.symopt_0x40 
```

# asp.net - 使用 MVC 在 ASP.NET 中实现 API 的最佳方法是什么？

> ID：134871
> 
> 赞同：7
> 
> 时间：2008-09-25T17:57:53.510
> 
> 标签：asp.net, asp.net-mvc, web-services

我一直是 Web 表单模型中的长期 ASP.NET 开发人员，并且正在使用一个新项目作为接触 ASP.NET MVC 的机会。

该应用程序将需要一个 API，以便一组其他应用程序可以与其通信。在此之前，我一直只使用标准 Web 服务来构建 API。

作为旁注，我有点犹豫是否要一头扎进创建 API 的 REST 风格，至少对于这个特定的实例。这个应用程序可能需要 API 版本控制的概念，我认为 REST 方法，其中 API 基本上分散在站点的所有控制器中，在这方面有点麻烦。（但如果对潜在的版本控制潜在要求有一个很好的答案，我并不完全反对。）

那么，Stack Overflow 的居民们，你们怎么说？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-09-25T18:06:04.320

我同意基尔霍夫的观点。尝试使用从“IFacade”继承的“Facade”包装类。在您的 Facade 类中放置您的代码以使用您的 Web 服务。这样，您的控制器将简单地调用 Facade。这样做的好处是您可以交换一个“DummyFacade”，它实现了相同的 IFacade 接口，它实际上并不与 Web 服务对话，只是返回静态内容。让您在不影响服务的情况下实际进行一些单元测试。基本上与存储库模式的想法相同。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-09-25T17:59:52.697

我仍然会推荐一个可以为客户端消费者或服务器端消费者服务的服务层。甚至可能以各种格式返回数据，具体取决于使用调用者。

# wpf - 将 2 个 WPF 组合框数据绑定到 1 个源而不被“链接”

> ID：134872
> 
> 赞同：5
> 
> 时间：2008-09-25T17:58:02.747
> 
> 标签：wpf, data-binding, xaml

我有一个主从场景，其中我有 1 个 ComboBox 列出来自 ObjectDataSourceProvider 的公司。在此之下，我有 2 个 ComboBoxes 绑定到当前 Company 对象的 Contacts 属性。我需要能够在每个 ComboBox 中选择不同的联系人；但是，只要我在一个列表中更改选择，另一个列表就会更新到同一个联系人。

我尝试了不同的设置（OneWay 与 TwoWay），但到目前为止似乎没有任何效果。这是我的 XAML 的摘录。

```
<Page.Resources>
    <!-- This is a custom class inheriting from ObjectDataProvider -->
    <wg:CustomersDataProvider x:Key="CompanyDataList" />
</Page.Resources>

<Grid>
    <!--- other layout XAML removed -->
    <ComboBox x:Name="Customer" Width="150"
              ItemsSource="{Binding Source={StaticResource CompanyDataList},Path=Companies,Mode=OneWay}"
              DisplayMemberPath="Name"
              SelectedValuePath="Id"
              IsSynchronizedWithCurrentItem="True"
              SelectedValue="{Binding Path=Id, Mode=OneWay}" 
              VerticalAlignment="Bottom" />

    <ComboBox x:Name="PrimaryContact" Width="150"
              DataContext="{Binding ElementName=Customer,Path=Items,Mode=OneWay}"
              ItemsSource="{Binding Path=Contacts,Mode=OneWay}"
              DisplayMemberPath="FullName"
              SelectedValuePath="Id"
              IsSynchronizedWithCurrentItem="True"
              SelectedValue="{Binding Path=Id,Mode=OneWay}" />

    <ComboBox x:Name="AdminContact" Width="150"
              DataContext="{Binding ElementName=OwnerCustomer,Path=Items,Mode=OneWay}"
              ItemsSource="{Binding Path=Contacts,Mode=OneWay}"
              DisplayMemberPath="FullName"
              SelectedValuePath="Id"
              IsSynchronizedWithCurrentItem="True"
              SelectedValue="{Binding Path=Id,Mode=OneWay}" />

    <!--- other layout XAML removed -->
</Grid> 
```

我认为创建一个 CollectionViewSource 将是要走的路，但我无法做到这一点。有没有一种简单的方法可以使 PrimaryContact 和 AdminContact 不链接？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-09-25T18:25:25.973

[将“ IsSynchronizedWithCurrentItem](http://msdn.microsoft.com/en-us/library/system.windows.controls.primitives.selector.issynchronizedwithcurrentitem.aspx) ”属性更改为“False”。

# git - 撤消 git rebase

> ID：134882
> 
> 赞同：3758
> 
> 时间：2008-09-25T17:59:22.230
> 
> 标签：git, rebase, git-rebase, undo

有人知道如何轻松撤消 git rebase 吗？

想到的唯一方法是手动进行：

*   git checkout 两个分支的提交父级
*   然后从那里创建一个临时分支
*   手工挑选所有提交
*   用手动创建的分支替换我重新设置的分支

在我目前的情况下，这将起作用，因为我可以轻松地发现来自两个分支的提交（一个是我的东西，另一个是我同事的东西）。

然而，我的方法给我的印象是次优且容易出错（假设我刚刚用我自己的 2 个分支重新设置了基础）。

有任何想法吗？

澄清：我说的是重放一堆提交的rebase。不止一个。

* * *

## 回答 #1

> 赞同：5164
> 
> 时间：2008-09-25T19:56:28.343

最简单的方法是找到分支的头部提交，因为它是在[reflog](https://git-scm.com/docs/git-reflog)中 rebase 开始之前的那一刻......

```
git reflog 
```

并将当前分支重置为它（通常需要注意的是在使用`--hard`选项重置之前要绝对确定）。

假设旧的提交`HEAD@{2}`在 ref 日志中：

```
git reset --hard HEAD@{2} 
```

*在 Windows 中，您可能需要引用参考：*

```
git reset --hard "HEAD@{2}" 
```

`git log HEAD@{2}`您只需执行( *Windows:* `git log "HEAD@{2}"` )即可检查候选老头的历史记录。

如果您没有禁用每个分支 reflogs，您应该能够简单地做`git reflog branchname@{1}`，因为在重新连接到最终头之前，rebase 会分离分支头。我会仔细检查这一点，尽管我最近没有验证这一点。

默认情况下，所有 reflogs 都会为非裸存储库激活：

```
[core]
    logAllRefUpdates = true 
```

* * *

## 回答 #2

> 赞同：1741
> 
> 时间：2009-03-28T13:24:50.743

实际上，rebase 将您的起点保存到，`ORIG_HEAD`所以这通常很简单：

```
git reset --hard ORIG_HEAD 
```

但是，`reset`和`rebase`all`merge`将您的原始`HEAD`指针保存到`ORIG_HEAD`so 中，如果您在尝试撤消 rebase 后执行了这些命令中的任何一个，那么您将不得不使用 reflog。

* * *

## 回答 #3

> 赞同：450
> 
> 时间：2009-07-27T18:21:54.227

[查尔斯的回答](https://stackoverflow.com/a/135614/259206)有效，但您可能想要这样做：

```
git rebase --abort 
```

清理之后`reset`。

否则，您可能会收到消息“<code>Interactive rebase already started”。

* * *

## 回答 #4

> 赞同：107
> 
> 时间：2008-09-26T02:08:44.970

将分支重置为其旧提示的悬空提交对象当然是最好的解决方案，因为它无需花费任何努力即可恢复先前的状态。但是如果你碰巧丢失了这些提交（例如，因为你同时垃圾收集了你的存储库，或者这是一个新的克隆），你总是可以再次重新设置分支。关键是`--onto`开关。

假设您有一个想象性地称为的主题分支，当提交的尖端是`topic`您分支的时候。在分支上的某个时刻，你做到了。现在您要撤消此操作。就是这样：`master``master``0deadbeef``topic``git rebase master`

```
git rebase --onto 0deadbeef master topic 
```

这将接受所有`topic`未打开的提交`master`并在`0deadbeef`.

有了它`--onto`，您可以将您的历史重新排列成几乎*任何形状*。

玩得开心。:-)

* * *

## 回答 #5

> 赞同：95
> 
> 时间：2015-09-28T12:43:48.797

如果**您已将分支推送到远程存储库**（通常是原始存储库），然后您已经完成了一个成功的 rebase（没有合并）（给出“No rebase in progress”），您可以使用命令`git rebase --abort`轻松**重置分支：**

> git reset --hard origin/{branchName}

例子：

```
$ ~/work/projects/{ProjectName} $ git status
On branch {branchName}
Your branch is ahead of 'origin/{branchName}' by 135 commits.
  (use "git push" to publish your local commits)

nothing to commit, working directory clean

$ ~/work/projects/{ProjectName} $ git reset --hard origin/{branchName}
HEAD is now at 6df5719 "Commit message".

$ ~/work/projects/{ProjectName} $ git status
On branch {branchName}
Your branch is up-to-date with 'origin/{branchName}.

nothing to commit, working directory clean 
```

* * *

## 回答 #6

> 赞同：75
> 
> 时间：2009-05-12T20:57:24.453

实际上，在执行任何重要操作之前，我在分支上放置了一个备份标记（大多数变基都是微不足道的，但如果它看起来很复杂，我会这样做）。

然后，恢复就像`git reset --hard BACKUP`.

* * *

## 回答 #7

> 赞同：48
> 
> 时间：2019-05-06T08:04:45.020

```
git reset --hard origin/{branchName} 
```

是重置由 rebase 完成的所有本地更改的正确解决方案。

* * *

## 回答 #8

> 赞同：29
> 
> 时间：2012-02-20T13:59:06.350

使用`reflog`对我不起作用。

对我有用的方法与[此处](http://www.bluemangolearning.com/blog/2009/03/recovering-from-a-disastrous-git-rebase-mistake/)描述的相似。打开 .git/logs/refs 中的文件，该文件以重新定位的分支命名，并找到包含“rebase finsihed”的行，如下所示：

```
5fce6b51 88552c8f Kris Leech <me@example.com> 1329744625 +0000  rebase finished: refs/heads/integrate onto 9e460878 
```

签出该行列出的第二个提交。

```
git checkout 88552c8f 
```

一旦确认这包含了我丢失的更改，我就松了一口气。

```
git log
git checkout -b lost_changes 
```

* * *

## 回答 #9

> 赞同：16
> 
> 时间：2008-09-25T21:36:50.693

对于多次提交，请记住任何提交都会引用导致该提交的所有历史记录。所以在查尔斯的回答中，将“旧提交”读作“最新的旧提交”。如果您重置为该提交，则导致该提交的所有历史记录都将重新出现。这应该做你想要的。

* * *

## 回答 #10

> 赞同：14
> 
> 时间：2016-06-23T09:23:45.167

如果您成功地针对远程分支重新定位并且不能`git rebase --abort`，您仍然可以做一些技巧来保存您的工作并且没有强制推送。假设您当前错误地重新设置的分支被调用`your-branch`并正在跟踪`origin/your-branch`

*   `git branch -m your-branch-rebased`# 重命名当前分支
*   `git checkout origin/your-branch`# 签出到源已知的最新状态
*   `git checkout -b your-branch`
*   检查`git log your-branch-rebased`、比较`git log your-branch`和定义缺少的提交`your-branch`
*   `git cherry-pick COMMIT_HASH`对于每个提交`your-branch-rebased`
*   推动你的改变。请注意，两个本地分支相关联`remote/your-branch`，您应该只推送`your-branch`

* * *

## 回答 #11

> 赞同：11
> 
> 时间：2015-03-11T21:26:47.550

按照@Allan 和@Zearin 的解决方案，我希望我可以简单地发表评论，但我没有足够的声誉，所以我使用了以下命令：

而不是做`git rebase -i --abort` （注意**-i**）我不得不简单地做（`git rebase --abort`没有**-i** **）**。

`-i`同时使用两者`--abort`会导致 Git 向我显示使用/选项列表。

所以我以前和当前使用此解决方案的分支状态是：

```
matbhz@myPc /my/project/environment (branch-123|REBASE-i)
$ git rebase --abort

matbhz@myPc /my/project/environment (branch-123)
$ 
```

* * *

## 回答 #12

> 赞同：11
> 
> 时间：2019-05-29T17:56:53.927

**如果您不想进行硬重置**...

您可以从 reflog 签出提交，然后将其保存为新分支：

```
git reflog 
```

在你开始变基之前找到提交。您可能需要进一步向下滚动才能找到它（按 Enter 或 PageDown）。记下 HEAD 编号并替换 57：

```
git checkout HEAD@{57} 
```

查看分支/提交，如果正确，则使用此 HEAD 创建一个新分支：

```
git checkout -b new_branch_name 
```

* * *

## 回答 #13

> 赞同：4
> 
> 时间：2017-02-09T12:25:35.240

假设我将 master 重新定位到我的功能分支，我得到了 30 个新的提交，这些提交破坏了一些东西。我发现通常最容易删除错误的提交。

```
git rebase -i HEAD~31 
```

最后 31 次提交的交互式变基（如果你选择太多也没关系）。

只需获取您想要摆脱的提交并用“d”而不是“pick”标记它们。现在，提交被有效地删除，撤消了变基（如果您只删除了变基时刚刚获得的提交）。

* * *

## 回答 #14

> 赞同：4
> 
> 时间：2019-01-10T12:21:58.307

如果您在分支上，您可以使用：

```
git reset --hard @{1} 
```

不仅有 HEAD 的参考日志（通过 获得`git reflog`），每个分支也有 reflogs（通过 获得`git reflog <branch>`）。因此，如果您在，`master`那么`git reflog master`将列出对该分支的所有更改。`master@{1}`您可以通过、`master@{2}`等来引用该更改。

`git rebase`通常会多次更改 HEAD 但当前分支只会更新一次。

`@{1}`只是[当前分支的快捷方式](https://git-scm.com/docs/gitrevisions#gitrevisions-emltngtemegem1em)，所以它等于`master@{1}`if you are on `master`。

`git reset --hard ORIG_HEAD`如果您`git reset`在交互式`rebase`.

* * *

## 回答 #15

> 赞同：4
> 
> 时间：2021-07-01T22:47:25.017

另一种**不需要进行硬重置**的方法是使用您想要的起点创建一个新分支。

与其他解决方案一样，您使用 reflog 来找到正确的起点。

```
git reflog 
```

（您也可以使用`git log -g`此处了解更多详细信息）

然后您注意对提交 SHA 的引用（例如：）`e86a52b851e`。

最后，您使用 git branch 命令。

```
git branch recover-branch e86a52b851e 
```

参考：[https ://git-scm.com/book/en/v2/Git-Internals-Maintenance-and-Data-Recovery#_data_recovery](https://git-scm.com/book/en/v2/Git-Internals-Maintenance-and-Data-Recovery#_data_recovery)

* * *

## 回答 #16

> 赞同：3
> 
> 时间：2020-07-19T22:47:40.903

尽管事实上它应该是可自动化的（至少大部分情况下），但这些答案都不是完全自动的，这让我很恼火。我创建了一组别名来尝试解决这个问题：

```
# Useful commands
#################

# Undo the last rebase
undo-rebase = "! f() { : git reset ; PREV_COMMIT=`git x-rev-before-rebase` && git reset --merge \"$PREV_COMMIT\" \"$@\";}; f"

# See what changed since the last rebase
rdiff = "!f() { : git diff ; git diff `git x-rev-before-rebase` "$@";}; f"

# Helpers
########
# Get the revision before the last rebase started
x-rev-before-rebase = !git reflog --skip=1 -1 \"`git x-start-of-rebase`\" --format=\"%gD\"

# Get the revision that started the rebase
x-start-of-rebase = reflog --grep-reflog '^rebase (start)' -1 --format="%gD" 
```

您应该能够对此进行调整，以允许很容易地返回任意数量的变基（处理 args 是最棘手的部分），如果您快速连续地执行多个变基并在此过程中搞砸了一些事情，这将很有用。

## 注意事项

如果任何提交消息以“rebase (start)”开头，它会感到困惑（请不要这样做）。您可以通过为您的正则表达式匹配以下内容来使正则表达式更具弹性以改善情况：

```
--grep-reflog "^rebase (start): checkout " 
```

警告：未测试（正则表达式可能需要调整）

我没有这样做的原因是因为我不是 100% 的变基*总是*从结帐开始。谁能证实这一点？

`:`[如果您对函数开头的null ( ) 命令感到好奇，这是为别名设置 bash 补全的一种方式]

* * *

## 回答 #17

> 赞同：2
> 
> 时间：2019-06-19T14:39:49.543

我通常做的是 `git reset #commit_hash`

到我认为 rebase 无效的最后一次提交。

然后 `git pull`

现在，您的分支应该与 master 完全匹配，并且 rebased 提交不应该在其中。

现在可以只挑选这个分支上的提交。

* * *

## 回答 #18

> 赞同：1
> 
> 时间：2020-02-16T19:06:45.363

我用 reset 和 reflog 尝试了所有建议，但没有成功。恢复 IntelliJ 本地历史解决了丢失文件的问题

* * *

## 回答 #19

> 赞同：-5
> 
> 时间：2016-03-09T09:19:08.793

如果你在 git rebase 中搞砸了一些东西，例如`git rebase --abort`，当你有未提交的文件时，它们将丢失并且`git reflog`无济于事。这发生在我身上，你需要在这里跳出框框思考。如果您像我一样幸运并使用 IntelliJ Webstorm，那么`right-click->local history`无论您使用版本控制软件犯了什么错误，您都可以并且可以恢复到文件/文件夹的先前状态。运行另一个故障保护总是好的。

# firefox - 为什么 Selenium 不能捕获我的击键？

> ID：134883
> 
> 赞同：2
> 
> 时间：2008-09-25T17:59:24.007
> 
> 标签：firefox, testing, selenium

我正在 win32/ff3 上试用最新 Selenium IDE Firefox 扩展的记录器。

在一个页面上，目前我必须按 Enter 才能转到下一页，但它不在提交按钮上，它是手动捕获的。这不是由录音机拾取的。我知道我可以在录制后自己手动输入，但是为什么不是这部分呢？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-09-26T15:31:53.780

从硒常见问题解答：

[http://wiki.openqa.org/display/SIDE/FAQ](http://wiki.openqa.org/display/SIDE/FAQ)

“并不是每个事件都会被 Selenium IDE 记录。通常不会记录的是那些涉及复杂 HTML 和/或 AJAX 的事件。我们希望随着时间的推移改进这一点，但总会有 IDE 无法记录的情况” t 录制所有内容，因为它必须在录制太少和太多之间取得平衡。”

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-09-26T15:26:45.137

您是否尝试过使用其他浏览器？它在FF2，IE中发生同样的事情吗？使用最新的夜间版本。我知道FF3存在一些问题。

# javascript - VBScript：在 DOM 元素中使用变量

> ID：134885
> 
> 赞同：1
> 
> 时间：2008-09-25T17:59:35.177
> 
> 标签：javascript, html, vbscript

我希望在对我正在构建的 Web 应用程序的 DOM 元素的引用中使用 VBScript 变量。以下是受影响代码区域的简短摘录：

```
dim num
num = CInt(document.myform.i.value)
dim x
x = 0
dim orders(num)
For x = 0 To num
    orders(x) = document.getElementById("order" & x).value
    objFile.writeLine(orders(x))
Next 
```

这是我第一次尝试 VBScript，我还没有找到任何在线执行此类操作的方法。正如您在上面的代码中看到的，我正在尝试创建一个数组（订单）。该数组可以有任意数量的值，但该数量将在`document.myform.i.value`. 因此，For 循环遍历 ID 为 order+x 的所有文本输入（即 order0、order1、order2、order3、order4 等，直到 num）

我的 orders(x) 行似乎有问题，我认为它无法识别我的意思`getElementById("order" & x)`，而且我不确定该怎么做。有人有什么建议吗？将不胜感激！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-09-26T13:22:40.707

我能够得到这个工作。感谢你们俩的时间和投入。这是为我解决的问题：

而不是使用

```
document.getElementById("order" & x).value 
```

我将整个 ID 设置为变量：

```
temp = "order" & x
document.getElementById(temp).value 
```

它似乎按预期工作。再次，非常感谢您为此付出的时间和精力！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-16T13:13:03.950

你不需要稍微改变你的循环吗？

```
For x = 0 To num - 1 
```

EG 有 4 个项目，您需要从 0 迭代到 3。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-25T18:04:44.197

我只能假设这是客户端 VBScript，因为 document.getElementById() 无法从服务器访问。

尝试 objFile.writeLine("order" & x)，然后检查源以确保所有元素都在文档中。

[因为我不能在注释中添加代码...] 这很奇怪。在我看来，一切都应该正常工作。

我能想到的唯一另一件事是：改变

```
orders(x) = document.getElementById("order" & x).value
objFile.writeLine(orders(x)) 
```

至

```
orders(x) = document.getElementById("order" & x)
objFile.writeLine(orders(x).value) 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-25T20:55:21.337

看起来好像您正在混合客户端与服务器端代码。

```
objFile.writeLine(orders(x)) 
```

那是 VBScript 写入文件，您只能在服务器上执行此操作。

```
document.getElementById 
```

这是通常在 JavaScript 中执行的客户端大小的代码。您可以在客户端的 IE 上使用 VBScript，但很少有人这样做。

在服务器上，您通常使用 request("formFieldName") 来引用作为表单标签一部分的表单字段，而不是 DOM 元素（假设您使用的是经典 ASP）。

为了让服务器端的东西出现在客户端（当你构建一个页面时），你可以像这样将它嵌入到你的 HTML 中：

```
<% = myVariable %> 
```

或像这样（作为代码块的一部分）：

```
document.write myVariable 
```

# lisp - 何时在 Lisp 中使用 ' （或引号）？

> ID：134887
> 
> 赞同：126
> 
> 时间：2008-09-25T17:59:42.400
> 
> 标签：lisp, quote

在阅读了 Lisp 入门书籍的主要部分之后，我仍然无法理解特殊运算符`(quote)`（或等效的`'`）函数的作用，但这已经遍布我所见过的 Lisp 代码。

它有什么作用？

* * *

## 回答 #1

> 赞同：192
> 
> 时间：2008-09-26T04:27:46.213

**简短回答** 绕过默认评估规则，*不*评估表达式（符号或 s-exp），将其传递给函数，完全按照键入的方式。

**长答案：默认评估规则**

当调用常规（我稍后会谈到）函数时，将评估传递给它的所有参数。这意味着你可以这样写：

```
(* (+ a 2)
   3) 
```

进而`(+ a 2)`通过评估`a`和 2 来评估 。符号的值`a`在当前变量绑定集中查找，然后替换。Say`a`当前绑定到值 3：

```
(let ((a 3))
  (* (+ a 2)
     3)) 
```

我们会得到`(+ 3 2)`，然后在 3 和 2 上调用 + 产生 5。我们的原始形式现在`(* 5 3)`产生 15。

**已经解释`quote`了！**

好的。如上所示，函数的所有参数都被评估，所以如果你想传递*符号* `a`而不是它的值，你不想评估它。Lisp 符号既可以作为它们的值，也可以作为其他语言使用字符串的标记，例如哈希表的键。

这就是`quote`进来的地方。假设您想从 Python 应用程序中绘制资源分配，而是在 Lisp 中进行绘制。让您的 Python 应用程序执行以下操作：

```
print("'(")
while allocating:
    if random.random() > 0.5:
        print(f"(allocate {random.randint(0, 20)})")
    else:
        print(f"(free {random.randint(0, 20)})")
    ...
print(")") 
```

给你的输出看起来像这样（稍微漂亮）：

```
'((allocate 3)
  (allocate 7)
  (free 14)
  (allocate 19)
  ...) 
```

还记得我所说的`quote`("tick") 导致默认规则不适用吗？好的。否则会发生的情况是 和 的值`allocate`被`free`查找，我们不希望这样。在我们的 Lisp 中，我们希望这样做：

```
(dolist (entry allocation-log)
  (case (first entry)
    (allocate (plot-allocation (second entry)))
    (free (plot-free (second entry))))) 
```

对于上面给出的数据，将进行以下函数调用序列：

```
(plot-allocation 3)
(plot-allocation 7)
(plot-free 14)
(plot-allocation 19) 
```

**但是`list`呢？**

好吧，有时您*确实*想评估这些论点。假设您有一个漂亮的函数来操作一个数字和一个字符串并返回一个结果列表......事物。让我们做一个错误的开始：

```
(defun mess-with (number string)
  '(value-of-number (1+ number) something-with-string (length string)))

Lisp> (mess-with 20 "foo")
(VALUE-OF-NUMBER (1+ NUMBER) SOMETHING-WITH-STRING (LENGTH STRING)) 
```

嘿！那不是我们想要的。我们希望有*选择地*评估一些参数，而将其他参数保留为符号。试试#2！

```
(defun mess-with (number string)
  (list 'value-of-number (1+ number) 'something-with-string (length string)))

Lisp> (mess-with 20 "foo")
(VALUE-OF-NUMBER 21 SOMETHING-WITH-STRING 3) 
```

**不只是`quote`，而是`backquote`**

好多了！顺便说一句，这种模式在（大部分）宏中很常见，以至于有特殊的语法可以做到这一点。反引号：

```
(defun mess-with (number string)
  `(value-of-number ,(1+ number) something-with-string ,(length string))) 
```

这就像 using `quote`，但可以选择通过在某些参数前面加上逗号来显式评估它们。结果等效于 using `list`，但如果您从宏生成代码，您通常只想评估返回的代码的一小部分，因此反引号更适合。对于较短的列表，`list`可以更具可读性。

**嘿，你忘了`quote`！**

那么，这会给我们带来什么影响？哦，对了，`quote`实际上是做什么的？它只是返回未评估的参数！还记得我在开始时所说的关于常规函数的内容吗？事实证明，某些运算符/函数不需要*评估*它们的参数。例如 IF - 如果 else 分支没有被采用，你不希望它被评估，对吧？所谓的*特殊运算符*，连同宏，就是这样工作的。特殊运算符也是语言的“公理”——最小的规则集——你可以在其上通过以不同的方式将它们组合在一起来实现 Lisp 的其余部分。

回到`quote`，虽然：

```
Lisp> (quote spiffy-symbol)
SPIFFY-SYMBOL

Lisp> 'spiffy-symbol ; ' is just a shorthand ("reader macro"), as shown above
SPIFFY-SYMBOL 
```

比较（在 Steel-Bank Common Lisp 上）：

```
Lisp> spiffy-symbol
debugger invoked on a UNBOUND-VARIABLE in thread #<THREAD "initial thread" RUNNING   {A69F6A9}>:
  The variable SPIFFY-SYMBOL is unbound.

Type HELP for debugger help, or (SB-EXT:QUIT) to exit from SBCL.

restarts (invokable by number or by possibly-abbreviated name):
  0: [ABORT] Exit debugger, returning to top level.

(SB-INT:SIMPLE-EVAL-IN-LEXENV SPIFFY-SYMBOL #<NULL-LEXENV>)
0] 
```

因为`spiffy-symbol`在当前范围内没有！

**加起来**

`quote`, `backquote`（带逗号），并且`list`是用于创建列表的一些工具，它们不仅是值列表，而且如您所见，可以用作轻量级（无需定义 a `struct`）数据结构！

如果您想了解更多信息，我推荐 Peter Seibel 的书[Practical Common Lisp](http://gigamonkeys.com/book)以提供学习 Lisp 的实用方法，如果您已经开始全面编程的话。最终，在您的 Lisp 之旅中，您也将开始使用包。Ron Garret 的[The Idiot's Guide to Common Lisp Packages](http://www.flownet.com/ron/packages.pdf)将为您提供很好的解释。

快乐黑客！

* * *

## 回答 #2

> 赞同：57
> 
> 时间：2008-09-25T18:02:28.977

它说“不要评价我”。例如，如果您想将列表用作数据而不是代码，则应在其前面加上引号。例如，

`(print '(+ 3 4))`打印“（+ 3 4）”，而 `(print (+ 3 4))`打印“7”

* * *

## 回答 #3

> 赞同：19
> 
> 时间：2009-02-23T16:49:34.877

其他人已经很好地回答了这个问题，Matthias Benkard 提出了一个很好的警告。

不要使用报价来创建您稍后将修改的列表。该规范允许编译器将带引号的列表视为常量。通常，编译器会通过在内存中为常量创建单个值，然后从常量出现的所有位置引用该单个值来优化常量。换句话说，它可以将常量视为匿名全局变量。

这可能会导致明显的问题。如果你修改一个常量，它很可能会在完全不相关的代码中修改同一个常量的其他用途。例如，您可以在某个函数中将某个变量与 '(1 1) 进行比较，而在一个完全不同的函数中，以 '(1 1) 开始一个列表，然后向其中添加更多内容。运行这些函数后，您可能会发现第一个函数不再正确匹配，因为它现在尝试将变量与第二个函数返回的 '(1 1 2 3 5 8 13) 进行比较。这两个函数是完全不相关的，但是由于使用了常量，它们会相互影响。甚至可能会发生更疯狂的不良影响，例如完全正常的列表迭代突然无限循环。

当您需要一个常量列表时使用引号，例如用于比较。当您要修改结果时使用列表。

* * *

## 回答 #4

> 赞同：14
> 
> 时间：2008-09-25T21:16:50.773

这个问题的一个答案是 QUOTE “创建列表数据结构”。这不太对。QUOTE 比这更根本。事实上，QUOTE 是一个微不足道的运算符：它的目的是*防止*任何事情发生。特别是，它不会创造任何东西。

(QUOTE X) 所说的基本上是“什么都不做，给我 X”。X 不必是 (QUOTE (ABC)) 中的列表或 (QUOTE FOO) 中的符号。它可以是任何对象。实际上，评估由 (LIST 'QUOTE SOME-OBJECT) 生成的列表的结果将始终只返回 SOME-OBJECT，无论它是什么。

现在， (QUOTE (ABC)) 似乎创建了一个元素为 A、B 和 C 的列表的原因是这样的列表确实是它返回的内容；但是在评估 QUOTE 表单时，列表通常已经存在了一段时间（作为 QUOTE 表单的一个组件！），由加载器或读取器在执行代码之前创建。

这往往会使新手经常绊倒的一个含义是，修改由 QUOTE 表单返回的列表是非常不明智的。出于所有意图和目的，QUOTE 返回的数据被视为正在执行的*代码*的一部分，因此应被视为只读！

* * *

## 回答 #5

> 赞同：11
> 
> 时间：2008-09-25T18:04:27.553

引用阻止执行或评估表单，而是将其转换为数据。通常，您可以通过对其进行评估来执行数据。

quote 创建列表数据结构，例如，以下是等价的：

```
(quote a)
'a 
```

它还可以用于创建列表（或树）：

```
(quote (1 2 3))
'(1 2 3) 
```

您最好购买一本关于 lisp 的介绍性书籍，例如[Practical Common Lisp](http://gigamonkeys.com/book/)（可在线阅读）。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2016-02-28T12:30:09.380

**在 Emacs Lisp 中：**

**可以引用什么？**

列表和符号。

引用一个数字将计算为数字本身： `'5`与 相同`5`。

**当你引用列表时会发生什么？**

例如：

`'(one two)`评估为

`(list 'one 'two)`评估为

`(list (intern "one") (intern ("two")))`.

`(intern "one")`创建一个名为“one”的符号并将其存储在“中央”哈希映射中，因此无论何时您说`'one`该符号`"one"`都会在该中央哈希映射中查找。

**但什么是符号？**

例如，在 OO 语言（Java/Javascript/Python）中，符号可以表示为具有`name`字段的对象，该字段是符号的名称，`"one"`如上所示，并且数据和/或代码可以与该对象相关联。

因此 Python 中的符号可以实现为：

```
class Symbol:
   def __init__(self,name,code,value):
       self.name=name
       self.code=code
       self.value=value 
```

例如，在 Emacs Lisp 中，一个符号可以有 1) 与之关联的数据和（同时 - 对于同一个符号）2) 与之关联的代码 - 根据上下文，数据或代码被调用。

例如，在 Elisp 中：

```
(progn
  (fset 'add '+ )
  (set 'add 2)
  (add add add)
) 
```

评估为`4`。

因为`(add add add)`评估为：

```
(add add add)
(+ add add)
(+ 2 add)
(+ 2 2)
4 
```

因此，例如，使用`Symbol`我们上面在 Python 中定义的类，这个`add`ELisp-Symbol 可以用 Python 编写为`Symbol("add",(lambda x,y: x+y),2)`.

非常感谢 IRC #emacs 上的人们向我解释符号和引号。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2014-06-07T05:22:47.063

当我们想传递参数本身而不是传递参数的值时，我们使用引号。它主要与使用 C 编程语言中不可用的列表、对和原子期间传递的过程有关（大多数人开始使用 C 编程进行编程，因此我们感到困惑）这是 Scheme 编程语言中的代码，它是 lisp 的一种方言我想你可以理解这段代码。

```
(define atom?              ; defining a procedure atom?
  (lambda (x)              ; which as one argument x
(and (not (null? x)) (not(pair? x) )))) ; checks if the argument is atom or not
(atom? '(a b c)) ; since it is a list it is false #f 
```

最后一行 (atom?'abc) 将 abc 原样传递给程序以检查 abc 是否为原子，但是当您传递 (atom?abc) 时，它会检查 abc 的值并将值传递给它。因为，我们没有为它提供任何价值

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2019-06-18T16:19:33.467

```
Code is data and data is code.  There is no clear distinction between them. 
```

这是任何 lisp 程序员都知道的经典语句。

当您引用代码时，该代码将是数据。

```
1 ]=> '(+ 2 3 4)
;Value: (+ 2 3 4)

1 ]=> (+ 2 3 4)
;Value: 9 
```

当您引用代码时，结果将是代表该代码的数据。因此，当您要处理表示程序的数据时，您引用该程序。这也适用于原子表达式，不仅适用于列表：

```
1 ]=> 'code
;Value: code

1 ]=> '10
;Value: 10

1 ]=> '"ok"
;Value: "ok"

1 ]=> code
;Unbound variable: code 
```

假设您想创建一种嵌入到 lisp 中的编程语言——您将使用在 scheme 中引用的程序（如`'(+ 2 3)`），并通过为程序提供语义解释来解释为您创建的语言中的代码。在这种情况下，您需要使用引号来保留数据，否则它将以外部语言进行评估。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2015-05-12T00:13:02.023

Quote 返回其参数的内部表示。*在对引用无效*的解释进行了太多解释之后，这就是灯泡亮起的时候。如果在我引用函数名时 REPL 没有将函数名转换为大写字母，那么我可能还没有意识到。

所以。普通的 Lisp 函数将它们的参数转换为内部表示，计算参数并应用函数。Quote 将其参数转换为内部表示，然后返回。从技术上讲，这句话说“不评估”是正确的，但是当我试图理解它做了什么时，告诉我它没有做什么是令人沮丧的。我的烤面包机也不评估 Lisp 函数。但这不是您解释烤面包机功能的方式。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2016-02-21T22:01:07.080

**另一个简短的答案：**

`quote`表示不评估它，*反引号*是引用但留下*后门*。

**一个很好的参考：**

Emacs Lisp 参考手册说得很清楚

9.3 报价

特殊形式的引号返回其单个参数，如所写，而不对其进行评估。这提供了一种在程序中包含不是自评估对象的常量符号和列表的方法。（不必引用数字、字符串和向量等自评估对象。）

特殊形式：引用对象

```
This special form returns object, without evaluating it. 
```

因为引号在程序中经常使用，所以 Lisp 为它提供了一种方便的读取语法。一个撇号字符 (''') 后跟一个 Lisp 对象（在读取语法中）扩展为一个列表，其第一个元素是引号，第二个元素是对象。因此，读语法 'x 是 (quote x) 的缩写。

以下是一些使用引号的表达式示例：

```
(quote (+ 1 2))
     ⇒ (+ 1 2)

(quote foo)
     ⇒ foo

'foo
     ⇒ foo

''foo
     ⇒ (quote foo)

'(quote foo)
     ⇒ (quote foo) 
```

9.4 反引号

反引号结构允许您引用列表，但有选择地评估该列表的元素。在最简单的情况下，它与特殊形式的引号相同（在上一节中描述；请参阅引用）。例如，这两种形式产生相同的结果：

```
`(a list of (+ 2 3) elements)
     ⇒ (a list of (+ 2 3) elements)

'(a list of (+ 2 3) elements)
     ⇒ (a list of (+ 2 3) elements) 
```

反引号参数中的特殊标记“，”表示一个不是常量的值。Emacs Lisp 求值器求值 ',' 的参数，并将值放入列表结构中：

```
`(a list of ,(+ 2 3) elements)
     ⇒ (a list of 5 elements) 
```

在列表结构的更深层次上也允许使用 ',' 进行替换。例如：

```
`(1 2 (3 ,(+ 4 5)))
     ⇒ (1 2 (3 9)) 
```

您还可以使用特殊标记“，@”将评估值拼接到结果列表中。拼接列表的元素成为与结果列表的其他元素处于同一级别的元素。不使用 '`' 的等效代码通常是不可读的。这里有些例子：

```
(setq some-list '(2 3))
     ⇒ (2 3)

(cons 1 (append some-list '(4) some-list))
     ⇒ (1 2 3 4 2 3)

`(1 ,@some-list 4 ,@some-list)
     ⇒ (1 2 3 4 2 3) 
```

# asp.net - 从控制器的操作中返回 XML 作为 ActionResult？

> ID：134905
> 
> 赞同：144
> 
> 时间：2008-09-25T18:01:13.097
> 
> 标签：asp.net, .net, xml, asp.net-mvc

从 ASP.NET MVC 中的控制器操作返回 XML 的最佳方法是什么？有一种返回 JSON 的好方法，但不适用于 XML。我真的需要通过视图路由 XML，还是应该采用 Response.Write-ing 的非最佳实践方式？

* * *

## 回答 #1

> 赞同：142
> 
> 时间：2010-12-01T15:29:51.557

```
return this.Content(xmlString, "text/xml"); 
```

* * *

## 回答 #2

> 赞同：115
> 
> 时间：2008-09-25T18:14:03.193

使用[MVCContrib](http://www.codeplex.com/MVCContrib)的 XmlResult 操作。

以下是他们的代码供参考：

> ```
> public class XmlResult : ActionResult
> {
>     private object objectToSerialize;
> 
>     /// <summary>
>     /// Initializes a new instance of the <see cref="XmlResult"/> class.
>     /// </summary>
>     /// <param name="objectToSerialize">The object to serialize to XML.</param>
>     public XmlResult(object objectToSerialize)
>     {
>         this.objectToSerialize = objectToSerialize;
>     }
> 
>     /// <summary>
>     /// Gets the object to be serialized to XML.
>     /// </summary>
>     public object ObjectToSerialize
>     {
>         get { return this.objectToSerialize; }
>     }
> 
>     /// <summary>
>     /// Serialises the object that was passed into the constructor to XML and writes the corresponding XML to the result stream.
>     /// </summary>
>     /// <param name="context">The controller context for the current request.</param>
>     public override void ExecuteResult(ControllerContext context)
>     {
>         if (this.objectToSerialize != null)
>         {
>             context.HttpContext.Response.Clear();
>             var xs = new System.Xml.Serialization.XmlSerializer(this.objectToSerialize.GetType());
>             context.HttpContext.Response.ContentType = "text/xml";
>             xs.Serialize(context.HttpContext.Response.Output, this.objectToSerialize);
>         }
>     }
> } 
> ```

* * *

## 回答 #3

> 赞同：33
> 
> 时间：2012-10-03T22:55:47.460

如果您正在使用出色的 Linq-to-XML 框架构建 XML，那么这种方法将很有帮助。

`XDocument`我在 action 方法中创建了一个。

```
public ActionResult MyXmlAction()
{
    // Create your own XDocument according to your requirements
    var xml = new XDocument(
        new XElement("root",
            new XAttribute("version", "2.0"),
            new XElement("child", "Hello World!")));

    return new XmlActionResult(xml);
} 
```

这个可重用的自定义`ActionResult`序列化 XML 为您。

```
public sealed class XmlActionResult : ActionResult
{
    private readonly XDocument _document;

    public Formatting Formatting { get; set; }
    public string MimeType { get; set; }

    public XmlActionResult(XDocument document)
    {
        if (document == null)
            throw new ArgumentNullException("document");

        _document = document;

        // Default values
        MimeType = "text/xml";
        Formatting = Formatting.None;
    }

    public override void ExecuteResult(ControllerContext context)
    {
        context.HttpContext.Response.Clear();
        context.HttpContext.Response.ContentType = MimeType;

        using (var writer = new XmlTextWriter(context.HttpContext.Response.OutputStream, Encoding.UTF8) { Formatting = Formatting })
            _document.WriteTo(writer);
    }
} 
```

您可以指定 MIME 类型（例如`application/rss+xml`）以及是否需要缩进输出。这两个属性都有合理的默认值。

如果您需要 UTF8 以外的编码，那么添加一个属性也很简单。

* * *

## 回答 #4

> 赞同：27
> 
> 时间：2009-10-16T14:11:35.683

如果您只对通过请求返回 xml 感兴趣，并且您有 xml“块”，则可以执行以下操作（作为控制器中的操作）：

```
public string Xml()
{
    Response.ContentType = "text/xml";
    return yourXmlChunk;
} 
```

* * *

## 回答 #5

> 赞同：17
> 
> 时间：2008-10-29T19:46:28.790

MVC Contrib 中有一个 XmlResult（以及更多）。看看[http://www.codeplex.com/MVCContrib](http://www.codeplex.com/MVCContrib)

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2016-07-26T15:28:30.297

我最近不得不为一个 Sitecore 项目执行此操作，该项目使用一种方法从 Sitecore 项及其子项创建 XmlDocument，并将其从控制器 ActionResult 作为文件返回。我的解决方案：

```
public virtual ActionResult ReturnXml()
{
    return File(Encoding.UTF8.GetBytes(GenerateXmlFeed().OuterXml), "text/xml");
} 
```

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2013-09-26T19:19:39.830

终于设法完成了这项工作，并认为我会在这里记录下如何为他人省去痛苦。

环境

*   VS2012
*   SQL Server 2008R2
*   .NET 4.5
*   ASP.NET MVC4（剃刀）
*   Windows 7的

支持的网络浏览器

*   火狐 23
*   IE 10
*   铬 29
*   歌剧 16
*   Safari 5.1.7（Windows 的最后一个？）

我的任务是单击 ui 按钮，在我的控制器上调用一个方法（带有一些参数），然后让它通过 xslt 转换返回一个 MS-Excel XML。返回的 MS-Excel XML 然后会导致浏览器弹出打开/保存对话框。这必须适用于所有浏览器（如上所列）。

起初我尝试使用 Ajax 并为文件名创建一个具有“下载”属性的动态 Anchor，但这仅适用于 5 个浏览器中的大约 3 个（FF、Chrome、Opera），不适用于 IE 或 Safari。并且尝试以编程方式触发锚点的 Click 事件以导致实际的“下载”存在问题。

我最终做的是使用“不可见”的 IFRAME，它适用于所有 5 个浏览器！

所以这就是我想出的：[请注意，我绝不是 html/javascript 大师，只包含了相关代码]

HTML（相关位的片段）

```
<div id="docxOutput">
<iframe id="ifOffice" name="ifOffice" width="0" height="0"
    hidden="hidden" seamless='seamless' frameBorder="0" scrolling="no"></iframe></div> 
```

JAVASCRIPT

```
//url to call in the controller to get MS-Excel xml
var _lnkToControllerExcel = '@Url.Action("ExportToExcel", "Home")';
$("#btExportToExcel").on("click", function (event) {
    event.preventDefault();

    $("#ProgressDialog").show();//like an ajax loader gif

    //grab the basket as xml                
    var keys = GetMyKeys();//returns delimited list of keys (for selected items from UI) 

    //potential problem - the querystring might be too long??
    //2K in IE8
    //4096 characters in ASP.Net
    //parameter key names must match signature of Controller method
    var qsParams = [
    'keys=' + keys,
    'locale=' + '@locale'               
    ].join('&');

    //The element with id="ifOffice"
    var officeFrame = $("#ifOffice")[0];

    //construct the url for the iframe
    var srcUrl = _lnkToControllerExcel + '?' + qsParams;

    try {
        if (officeFrame != null) {
            //Controller method can take up to 4 seconds to return
            officeFrame.setAttribute("src", srcUrl);
        }
        else {
            alert('ExportToExcel - failed to get reference to the office iframe!');
        }
    } catch (ex) {
        var errMsg = "ExportToExcel Button Click Handler Error: ";
        HandleException(ex, errMsg);
    }
    finally {
        //Need a small 3 second ( delay for the generated MS-Excel XML to come down from server)
        setTimeout(function () {
            //after the timeout then hide the loader graphic
            $("#ProgressDialog").hide();
        }, 3000);

        //clean up
        officeFrame = null;
        srcUrl = null;
        qsParams = null;
        keys = null;
    }
}); 
```

C# SERVER-SIDE（代码片段）@Drew 创建了一个名为 XmlActionResult 的自定义 ActionResult，我针对我的目的对其进行了修改。

[从控制器的操作中返回 XML 作为 ActionResult？](https://stackoverflow.com/questions/134905/what-is-the-best-way-to-return-xml-from-a-controllers-action-in-asp-net-mvc/12718046#12718046)

我的控制器方法（返回 ActionResult）

*   将 keys 参数传递给生成 XML 的 SQL Server 存储过程
*   然后通过 xslt 将 XML 转换为 MS-Excel xml (XmlDocument)
*   创建修改后的 XmlActionResult 的实例并返回它

    XmlActionResult 结果 = 新 XmlActionResult(excelXML, "application/vnd.ms-excel"); 字符串版本 = DateTime.Now.ToString("dd_MMM_yyyy_hhmmsstt"); string fileMask = "LabelExport_{0}.xml";
    result.DownloadFilename = string.Format(fileMask, version); 返回结果；

@Drew 创建的 XmlActionResult 类的主要修改。

```
public override void ExecuteResult(ControllerContext context)
{
    string lastModDate = DateTime.Now.ToString("R");

    //Content-Disposition: attachment; filename="<file name.xml>" 
    // must set the Content-Disposition so that the web browser will pop the open/save dialog
    string disposition = "attachment; " +
                        "filename=\"" + this.DownloadFilename + "\"; ";

    context.HttpContext.Response.Clear();
    context.HttpContext.Response.ClearContent();
    context.HttpContext.Response.ClearHeaders();
    context.HttpContext.Response.Cookies.Clear();
    context.HttpContext.Response.Cache.SetCacheability(System.Web.HttpCacheability.NoCache);// Stop Caching in IE
    context.HttpContext.Response.Cache.SetNoStore();// Stop Caching in Firefox
    context.HttpContext.Response.Cache.SetMaxAge(TimeSpan.Zero);
    context.HttpContext.Response.CacheControl = "private";
    context.HttpContext.Response.Cache.SetLastModified(DateTime.Now.ToUniversalTime());
    context.HttpContext.Response.ContentType = this.MimeType;
    context.HttpContext.Response.Charset = System.Text.UTF8Encoding.UTF8.WebName;

    //context.HttpContext.Response.Headers.Add("name", "value");
    context.HttpContext.Response.Headers.Add("Last-Modified", lastModDate);
    context.HttpContext.Response.Headers.Add("Pragma", "no-cache"); // HTTP 1.0.
    context.HttpContext.Response.Headers.Add("Expires", "0"); // Proxies.

    context.HttpContext.Response.AppendHeader("Content-Disposition", disposition);

    using (var writer = new XmlTextWriter(context.HttpContext.Response.OutputStream, this.Encoding)
    { Formatting = this.Formatting })
        this.Document.WriteTo(writer);
} 
```

基本上就是这样。希望它可以帮助别人。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2014-02-10T20:54:21.023

一个简单的选项，可让您使用流和所有`return File(stream, "text/xml");`.

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2014-02-25T19:22:37.747

这是一个简单的方法：

```
 var xml = new XDocument(
            new XElement("root",
            new XAttribute("version", "2.0"),
            new XElement("child", "Hello World!")));
        MemoryStream ms = new MemoryStream();
        xml.Save(ms);
        return File(new MemoryStream(ms.ToArray()), "text/xml", "HelloWorld.xml"); 
```

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2016-08-09T15:55:42.803

使用 XDocument 的方法 Save() 的[Drew Noakes](https://stackoverflow.com/a/12718046/4473736)的答案的一个小变化。

```
public sealed class XmlActionResult : ActionResult
{
    private readonly XDocument _document;
    public string MimeType { get; set; }

    public XmlActionResult(XDocument document)
    {
        if (document == null)
            throw new ArgumentNullException("document");

        _document = document;

        // Default values
        MimeType = "text/xml";
    }

    public override void ExecuteResult(ControllerContext context)
    {
        context.HttpContext.Response.Clear();
        context.HttpContext.Response.ContentType = MimeType;
        _document.Save(context.HttpContext.Response.OutputStream)
    }
} 
```

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2020-12-05T19:51:12.920

使用其中一种方法

```
 public ContentResult GetXml()
    {
        string xmlString  = "your xml data";
        return Content(xmlString, "text/xml");
    } 
```

或者

```
 public string GetXml()
    {
        string xmlString = "your xml data";
        Response.ContentType = "text/xml";
        return xmlString;
    } 
```

# unix - 如何列出所有用户的所有 cron 作业？

> ID：134906
> 
> 赞同：923
> 
> 时间：2008-09-25T18:01:31.083
> 
> 标签：unix, cron

是否有命令或现有脚本可以让我一次查看 *NIX 系统的所有计划的 cron 作业？我希望它包含所有用户 crontab，`/etc/crontab`以及`/etc/cron.d`. 也很高兴看到`run-parts`in运行的特定命令`/etc/crontab`。

理想情况下，我希望以漂亮的列形式输出并以某种有意义的方式排序。

然后，我可以合并来自多个服务器的这些列表，以查看整体“事件时间表”。

我正要自己写这样的脚本，但如果有人已经麻烦了......

* * *

## 回答 #1

> 赞同：1219
> 
> 时间：2008-09-25T18:07:49.977

您必须以 root 身份运行它，但是：

```
for user in $(cut -f1 -d: /etc/passwd); do crontab -u $user -l; done 
```

将遍历列出其 crontab 的每个用户名。crontab 由各自的用户拥有，因此您将无法看到其他用户的 crontab，而无需他们或 root。

* * *

**编辑** 如果您想知道 crontab 属于哪个用户，请使用`echo $user`

```
for user in $(cut -f1 -d: /etc/passwd); do echo $user; crontab -u $user -l; done 
```

* * *

## 回答 #2

> 赞同：326
> 
> 时间：2008-09-26T00:50:39.277

我最终编写了一个脚本（我试图自学 bash 脚本的更精细的点，所以这就是为什么你在这里看不到 Perl 之类的东西）。这不是一件简单的事情，但它可以满足我的大部分需求。它使用 Kyle 的建议来查找单个用户的 crontab，但也处理`/etc/crontab`（包括`run-parts`in `/etc/cron.hourly`、`/etc/cron.daily`等启动的脚本）和`/etc/cron.d`目录中的作业。它采用所有这些并将它们合并到如下所示的显示中：

```
mi     h    d  m  w  user      command
09,39  *    *  *  *  root      [ -d /var/lib/php5 ] && find /var/lib/php5/ -type f -cmin +$(/usr/lib/php5/maxlifetime) -print0 | xargs -r -0 rm
47     */8  *  *  *  root      rsync -axE --delete --ignore-errors / /mirror/ >/dev/null
17     1    *  *  *  root      /etc/cron.daily/apt
17     1    *  *  *  root      /etc/cron.daily/aptitude
17     1    *  *  *  root      /etc/cron.daily/find
17     1    *  *  *  root      /etc/cron.daily/logrotate
17     1    *  *  *  root      /etc/cron.daily/man-db
17     1    *  *  *  root      /etc/cron.daily/ntp
17     1    *  *  *  root      /etc/cron.daily/standard
17     1    *  *  *  root      /etc/cron.daily/sysklogd
27     2    *  *  7  root      /etc/cron.weekly/man-db
27     2    *  *  7  root      /etc/cron.weekly/sysklogd
13     3    *  *  *  archiver  /usr/local/bin/offsite-backup 2>&1
32     3    1  *  *  root      /etc/cron.monthly/standard
36     4    *  *  *  yukon     /home/yukon/bin/do-daily-stuff
5      5    *  *  *  archiver  /usr/local/bin/update-logs >/dev/null 
```

请注意，它显示了用户，并且或多或少按小时和分钟排序，以便我可以看到每日时间表。

到目前为止，我已经在 Ubuntu、Debian 和 Red Hat AS 上对其进行了测试。

```
#!/bin/bash

# System-wide crontab file and cron job directory. Change these for your system.
CRONTAB='/etc/crontab'
CRONDIR='/etc/cron.d'

# Single tab character. Annoyingly necessary.
tab=$(echo -en "\t")

# Given a stream of crontab lines, exclude non-cron job lines, replace
# whitespace characters with a single space, and remove any spaces from the
# beginning of each line.
function clean_cron_lines() {
    while read line ; do
        echo "${line}" |
            egrep --invert-match '^($|\s*#|\s*[[:alnum:]_]+=)' |
            sed --regexp-extended "s/\s+/ /g" |
            sed --regexp-extended "s/^ //"
    done;
}

# Given a stream of cleaned crontab lines, echo any that don't include the
# run-parts command, and for those that do, show each job file in the run-parts
# directory as if it were scheduled explicitly.
function lookup_run_parts() {
    while read line ; do
        match=$(echo "${line}" | egrep -o 'run-parts (-{1,2}\S+ )*\S+')

        if [[ -z "${match}" ]] ; then
            echo "${line}"
        else
            cron_fields=$(echo "${line}" | cut -f1-6 -d' ')
            cron_job_dir=$(echo  "${match}" | awk '{print $NF}')

            if [[ -d "${cron_job_dir}" ]] ; then
                for cron_job_file in "${cron_job_dir}"/* ; do  # */ <not a comment>
                    [[ -f "${cron_job_file}" ]] && echo "${cron_fields} ${cron_job_file}"
                done
            fi
        fi
    done;
}

# Temporary file for crontab lines.
temp=$(mktemp) || exit 1

# Add all of the jobs from the system-wide crontab file.
cat "${CRONTAB}" | clean_cron_lines | lookup_run_parts >"${temp}" 

# Add all of the jobs from the system-wide cron directory.
cat "${CRONDIR}"/* | clean_cron_lines >>"${temp}"  # */ <not a comment>

# Add each user's crontab (if it exists). Insert the user's name between the
# five time fields and the command.
while read user ; do
    crontab -l -u "${user}" 2>/dev/null |
        clean_cron_lines |
        sed --regexp-extended "s/^((\S+ +){5})(.+)$/\1${user} \3/" >>"${temp}"
done < <(cut --fields=1 --delimiter=: /etc/passwd)

# Output the collected crontab lines. Replace the single spaces between the
# fields with tab characters, sort the lines by hour and minute, insert the
# header line, and format the results as a table.
cat "${temp}" |
    sed --regexp-extended "s/^(\S+) +(\S+) +(\S+) +(\S+) +(\S+) +(\S+) +(.*)$/\1\t\2\t\3\t\4\t\5\t\6\t\7/" |
    sort --numeric-sort --field-separator="${tab}" --key=2,1 |
    sed "1i\mi\th\td\tm\tw\tuser\tcommand" |
    column -s"${tab}" -t

rm --force "${temp}" 
```

* * *

## 回答 #3

> 赞同：221
> 
> 时间：2008-12-12T03:56:01.740

在 Ubuntu 或 debian 下，您可以查看 crontab `/var/spool/cron/crontabs/`，然后每个用户的文件都在那里。当然，这仅适用于特定于用户的 crontab。

对于 Redhat 6/7 和 Centos，crontab 位于`/var/spool/cron/`.

* * *

## 回答 #4

> 赞同：41
> 
> 时间：2015-08-07T08:56:00.357

这将显示所有用户的所有 crontab 条目。

```
sed 's/^\([^:]*\):.*$/crontab -u \1 -l 2>\&1/' /etc/passwd | sh | grep -v "no crontab for" 
```

* * *

## 回答 #5

> 赞同：35
> 
> 时间：2013-08-03T00:40:46.303

取决于您的 linux 版本，但我使用：

```
tail -n 1000 /var/spool/cron/* 
```

作为根。非常简单而且非常简短。

给我这样的输出：

```
==> /var/spool/cron/root <==
15 2 * * * /bla

==> /var/spool/cron/my_user <==
*/10 1 * * * /path/to/script 
```

* * *

## 回答 #6

> 赞同：17
> 
> 时间：2010-07-06T11:29:02.417

Kyle Burton 的答案的一个小改进，改进了输出格式：

```
#!/bin/bash
for user in $(cut -f1 -d: /etc/passwd)
do echo $user && crontab -u $user -l
echo " "
done 
```

* * *

## 回答 #7

> 赞同：15
> 
> 时间：2010-05-19T00:54:07.557

```
getent passwd | cut -d: -f1 | perl -e'while(<>){chomp;$l = `crontab -u $_ -l 2>/dev/null`;print "$_\n$l\n" if $l}' 
```

这避免了直接与 passwd 混淆，跳过没有 cron 条目的用户，对于那些拥有它们的用户，它会打印出用户名以及他们的 crontab。

不过主要是把它放在这里，这样我以后可以找到它，以防我需要再次搜索它。

* * *

## 回答 #8

> 赞同：15
> 
> 时间：2017-12-28T07:36:21.823

从 ROOT 用户获取列表。

```
for user in $(cut -f1 -d: /etc/passwd); do echo $user; sudo crontab -u $user -l; done 
```

* * *

## 回答 #9

> 赞同：12
> 
> 时间：2011-08-23T12:13:49.037

如果您使用 NIS 检查集群，根据马特的回答 /var/spool/cron/tabs，查看用户是否有 crontab 条目的唯一方法是。

```
grep -v "#" -R  /var/spool/cron/tabs 
```

* * *

## 回答 #10

> 赞同：11
> 
> 时间：2017-06-23T06:37:48.013

这个脚本在 CentOS 中对我有用，可以列出环境中的所有 cron：

```
sudo cat /etc/passwd | sed 's/^\([^:]*\):.*$/sudo crontab -u \1 -l 2>\&1/' | grep -v "no crontab for" | sh 
```

* * *

## 回答 #11

> 赞同：10
> 
> 时间：2010-05-03T17:38:33.877

我喜欢上面简单的单行答案：

> 对于 $(cut -f1 -d: /etc/passwd) 中的用户；执行 crontab -u $user -l; 完毕

但是 Solaris 没有 -u 标志并且不打印它正在检查的用户，您可以像这样修改它：

```
for user in $(cut -f1 -d: /etc/passwd); do echo User:$user; crontab -l $user 2>&1 | grep -v crontab; done 
```

当帐户不允许使用 cron 等时，您将获得一个用户列表，而不会出现 crontab 引发的错误。请注意，在 Solaris 中，角色也可以位于 /etc/passwd 中（请参阅 /etc/user_attr）。

* * *

## 回答 #12

> 赞同：9
> 
> 时间：2012-07-12T14:57:03.183

```
for user in $(cut -f1 -d: /etc/passwd); 
do 
    echo $user; crontab -u $user -l; 
done 
```

* * *

## 回答 #13

> 赞同：9
> 
> 时间：2016-12-20T01:19:44.133

下面从没有 crontab 的用户中删除注释、空行和错误。剩下的只是用户及其工作的清晰列表。

注意`sudo`第二行中的使用。如果您已经是 root，请将其删除。

```
for USER in $(cut -f1 -d: /etc/passwd); do \
USERTAB="$(sudo crontab -u "$USER" -l 2>&1)";  \
FILTERED="$(echo "$USERTAB"| grep -vE '^#|^$|no crontab for|cannot use this program')";  \
if ! test -z "$FILTERED"; then  \
echo "# ------ $(tput bold)$USER$(tput sgr0) ------";  \
echo "$FILTERED";  \
echo "";  \
fi;  \
done 
```

示例输出：

```
# ------ root ------
0 */6 * * * /usr/local/bin/disk-space-notify.sh
45 3 * * * /opt/mysql-backups/mysql-backups.sh
5 7 * * * /usr/local/bin/certbot-auto renew --quiet --no-self-upgrade

# ------ sammy ------
55 * * * * wget -O - -q -t 1 https://www.example.com/cron.php > /dev/null 
```

我在 Ubuntu（12 到 16）和 Red Hat（5 到 7）上使用它。

* * *

## 回答 #14

> 赞同：6
> 
> 时间：2008-09-25T18:08:04.703

取决于你的 cron 版本。在 FreeBSD 上使用 Vixie cron，我可以这样做：

```
(cd /var/cron/tabs && grep -vH ^# *) 
```

如果我想要更多的制表符分隔，我可能会做这样的事情：

```
(cd /var/cron/tabs && grep -vH ^# * | sed "s/:/      /") 
```

这是 sed 替换部分中的文字选项卡。

`/etc/passwd`循环访问用户并`crontab -l -u $user`为每个用户执行操作可能更加独立于系统。

* * *

## 回答 #15

> 赞同：6
> 
> 时间：2020-11-03T11:39:23.470

虽然许多答案产生了有用的结果，但我认为为这项任务维护复杂脚本的忙碌是不值得的。这主要是因为大多数发行版使用不同的 cron 守护进程。

# 观看和学习，儿童和老人。

```
$ \cat ~jaroslav/bin/ls-crons 
#!/bin/bash
getent passwd | awk -F: '{ print $1 }' | xargs -I% sh -c 'crontab -l -u % | sed "/^$/d; /^#/d; s/^/% /"' 2>/dev/null
echo
cat /etc/crontab /etc/anacrontab 2>/dev/null | sed '/^$/d; /^#/d;'
echo
run-parts --list /etc/cron.hourly;
run-parts --list /etc/cron.daily;
run-parts --list /etc/cron.weekly;
run-parts --list /etc/cron.monthly; 
```

### 像这样跑

```
$ sudo ls-cron 
```

### 示例输出（Gentoo）

```
$ sudo ~jaroslav/bin/ls-crons 
jaroslav */5 * * * *  mv ~/java_error_in_PHPSTORM* ~/tmp 2>/dev/null
jaroslav 5 */24 * * * ~/bin/Find-home-files
jaroslav * 7 * * * cp /T/fortrabbit/ssh-config/fapps.tsv /home/jaroslav/reference/fortrabbit/fapps
jaroslav */8 1 * * * make -C /T/fortrabbit/ssh-config discover-apps # >/dev/null
jaroslav */7    * * * * getmail -r jazzoslav -r fortrabbit 2>/dev/null
jaroslav */1    * * * * /home/jaroslav/bin/checkmail
jaroslav *    9-18 * * * getmail -r fortrabbit 2>/dev/null

SHELL=/bin/bash
PATH=/sbin:/bin:/usr/sbin:/usr/bin
MAILTO=root
HOME=/
SHELL=/bin/sh
PATH=/sbin:/bin:/usr/sbin:/usr/bin
MAILTO=root
RANDOM_DELAY=45
START_HOURS_RANGE=3-22
1   5   cron.daily      nice run-parts /etc/cron.daily
7   25  cron.weekly     nice run-parts /etc/cron.weekly
@monthly 45 cron.monthly        nice run-parts /etc/cron.monthly

/etc/cron.hourly/0anacron
/etc/cron.daily/logrotate
/etc/cron.daily/man-db
/etc/cron.daily/mlocate
/etc/cron.weekly/mdadm
/etc/cron.weekly/pfl 
```

### 示例输出（Ubuntu）

```
SHELL=/bin/sh
PATH=/usr/local/sbin:/usr/local/bin:/sbin:/bin:/usr/sbin:/usr/bin
17 *    * * *   root    cd / && run-parts --report /etc/cron.hourly
25 6    * * *   root    test -x /usr/sbin/anacron || ( cd / && run-parts --report /etc/cron.daily )
47 6    * * 7   root    test -x /usr/sbin/anacron || ( cd / && run-parts --report /etc/cron.weekly )
52 6    1 * *   root    test -x /usr/sbin/anacron || ( cd / && run-parts --report /etc/cron.monthly )

/etc/cron.hourly/btrfs-quota-cleanup
/etc/cron.hourly/ntpdate-debian
/etc/cron.daily/apport
/etc/cron.daily/apt-compat
/etc/cron.daily/apt-show-versions
/etc/cron.daily/aptitude
/etc/cron.daily/bsdmainutils
/etc/cron.daily/dpkg
/etc/cron.daily/logrotate
/etc/cron.daily/man-db
/etc/cron.daily/mlocate
/etc/cron.daily/passwd
/etc/cron.daily/popularity-contest
/etc/cron.daily/ubuntu-advantage-tools
/etc/cron.daily/update-notifier-common
/etc/cron.daily/upstart
/etc/cron.weekly/apt-xapian-index
/etc/cron.weekly/man-db
/etc/cron.weekly/update-notifier-common 
```

### 图片

Ubuntu：

[![ubuntu](https://i.stack.imgur.com/fyNiH.png)](https://i.stack.imgur.com/fyNiH.png)

巴布亚新几内亚：

[![gentoo](https://i.stack.imgur.com/vETIY.png)](https://i.stack.imgur.com/vETIY.png)

* * *

## 回答 #16

> 赞同：5
> 
> 时间：2009-08-07T07:56:08.970

感谢这个非常有用的脚本。我在旧系统上运行它时遇到了一些小问题（Red Hat Enterprise 3，它处理不同的 egrep 和字符串中的制表符），以及 /etc/cron.d/ 中没有任何内容的其他系统（脚本然后以错误结束）。所以这里有一个补丁可以让它在这种情况下工作：

```
2a3,4
> #See:  http://stackoverflow.com/questions/134906/how-do-i-list-all-cron-jobs-for-all-users
>
27c29,30
<         match=$(echo "${line}" | egrep -o 'run-parts (-{1,2}\S+ )*\S+')
---
>         #match=$(echo "${line}" | egrep -o 'run-parts (-{1,2}\S+ )*\S+')
>         match=$(echo "${line}" | egrep -o 'run-parts.*')
51c54,57
< cat "${CRONDIR}"/* | clean_cron_lines >>"${temp}"  # */ <not a comment>
---
> sys_cron_num=$(ls /etc/cron.d | wc -l | awk '{print $1}')
> if [ "$sys_cron_num" != 0 ]; then
>       cat "${CRONDIR}"/* | clean_cron_lines >>"${temp}"  # */ <not a comment>
> fi
67c73
<     sed "1i\mi\th\td\tm\tw\tuser\tcommand" |
---
>     sed "1i\mi${tab}h${tab}d${tab}m${tab}w${tab}user${tab}command" | 
```

我不太确定第一个 egrep 中的更改是一个好主意，但是，这个脚本已经在 RHEL3、4、5 和 Debian5 上进行了测试，没有任何问题。希望这可以帮助！

* * *

## 回答 #17

> 赞同：5
> 
> 时间：2016-09-08T07:38:08.563

您可以为所有用户列表编写：

```
sudo crontab -u userName -l

, 
```

你也可以去

```
cd /etc/cron.daily/
ls -l
cat filename 
```

此文件将列出时间表

```
cd /etc/cron.d/
ls -l
cat filename 
```

* * *

## 回答 #18

> 赞同：4
> 
> 时间：2014-03-26T15:03:56.400

建立在@Kyle 之上

```
for user in $(tail -n +11 /etc/passwd | cut -f1 -d:); do echo $user; crontab -u $user -l; done 
```

为了避免通常在 /etc/passwd 顶部的注释，

在 macOS 上

```
for user in $(dscl . -list /users | cut -f1 -d:); do echo $user; crontab -u $user -l; done 
```

* * *

## 回答 #19

> 赞同：4
> 
> 时间：2016-05-19T15:40:45.780

我认为下面会有一个更好的班轮。例如，如果您在 NIS 或 LDAP 中有用户，他们就不会在 /etc/passwd 中。这将为您提供每个已登录用户的 crontab。

```
for I in `lastlog | grep -v Never | cut -f1 -d' '`; do echo $I ; crontab -l -u $I ; done 
```

* * *

## 回答 #20

> 赞同：4
> 
> 时间：2018-01-10T19:14:17.840

在 Solaris 上，对于特定的已知用户名：

```
crontab -l username 
```

要在 Solaris 上一次获得所有用户的工作，就像上面的其他帖子一样：

```
for user in $(cut -f1 -d: /etc/passwd); do crontab -l $user 2>/dev/null; done 
```

更新：请停止建议在 Solaris 上错误的编辑： [![在此处输入图像描述](https://i.stack.imgur.com/1PT7z.png)](https://i.stack.imgur.com/1PT7z.png)

* * *

## 回答 #21

> 赞同：4
> 
> 时间：2018-12-22T00:36:07.537

很抱歉并感谢 yukondude。

我试图总结时间设置以便于阅读，虽然这不是一个完美的工作，而且我不会触及“每个星期五”或“仅在星期一”的东西。

这是版本 10 - 现在是：

*   跑得更快
*   具有可选的进度字符，因此您可以进一步提高速度。
*   使用分隔线分隔标题和输出。
*   当可以总结所有未遇到的时间间隔时，以紧凑的格式输出。
*   接受一年中月份的 Jan...Dec 描述符
*   接受 Mon...Sun 星期几的描述符
*   尝试在 anacron 丢失时处理 debian 风格的虚拟化
*   尝试处理在使用“[ -x ... ]”预测试可执行性后运行文件的 crontab 行
*   尝试处理在使用“command -v”预测试可执行性后运行文件的 crontab 行
*   允许使用区间跨度和列表。
*   支持在用户特定的 /var/spool crontab 文件中使用 run-parts。

我现在在这里完整地发布脚本。

[https://gist.github.com/myshkin-uk/d667116d3e2d689f23f18f6cd3c71107](https://gist.github.com/myshkin-uk/d667116d3e2d689f23f18f6cd3c71107)

* * *

## 回答 #22

> 赞同：3
> 
> 时间：2016-07-28T08:42:54.233

由于它是遍历文件（`/etc/passwd`）并执行操作的问题，因此我缺少有关[如何逐行（和/或逐字段）读取文件（数据流，变量）的正确方法)?](http://mywiki.wooledge.org/BashFAQ/001) ：

```
while IFS=":" read -r user _
do
   echo "crontab for user ${user}:"
   crontab -u "$user" -l
done < /etc/passwd 
```

这使用作为字段分隔符`/etc/passwd`逐行读取。`:`通过说`read -r user _`，我们`$user`保持第一个字段和`_`其余字段（忽略字段只是一个垃圾变量）。

这样，我们就可以`crontab -u`使用我们引用的变量来调用`$user`安全（如果它包含空格怎么办？在这样的文件中不太可能，但你永远不会知道）。

* * *

## 回答 #23

> 赞同：1
> 
> 时间：2021-08-30T18:02:04.690

我倾向于使用以下小命令来列出单个用户的所有作业以及带有现代 bash 控制台的基于 Unix 的操作系统上的所有用户：

**1\. 单用户**

```
 echo "Jobs owned by $USER" && crontab -l -u $USER 
```

**2.所有用户**

```
for wellknownUser in $(cut -f1 -d: /etc/passwd);
   do
      echo "Jobs owned by $wellknownUser";
      crontab -l -u $wellknownUser;
      echo -e "\n";
      sleep 2;  # (optional sleep 2 seconds) while drinking a coffee
   done 
```

* * *

## 回答 #24

> 赞同：1
> 
> 时间：2021-09-30T14:39:43.747

我在一个衬里脚本下制作了它，它可以为我列出所有用户的所有 cron 作业。

```
cat /etc/passwd |awk -F ':' '{print $1}'|while read a;do crontab -l -u ${a} ; done 
```

* * *

## 回答 #25

> 赞同：-1
> 
> 时间：2016-12-19T11:48:32.350

对我来说，看看 /var/spool/cron/crontabs 是最好的方法

* * *

## 回答 #26

> 赞同：-2
> 
> 时间：2015-01-16T19:29:37.547

此脚本将 Crontab 输出到一个文件，并列出所有确认没有 crontab 条目的用户：

```
for user in $(cut -f1 -d: /etc/passwd); do 
  echo $user >> crontab.bak
  echo "" >> crontab.bak
  crontab -u $user -l >> crontab.bak 2>> > crontab.bak
done 
```

# version-control - 在 Source Safe 中有一种方法可以保护一些开发人员正在修改的关键文件

> ID：134914
> 
> 赞同：1
> 
> 时间：2008-09-25T18:02:57.243
> 
> 标签：version-control, visual-sourcesafe

我宁愿不只是永久地向我签出一堆文件，而且我想要一种方法来防止在我不知道的情况下更改一些非常重要的文件。

PS 是的，我知道 SourceSafe 很糟糕。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-09-25T18:17:34.837

您只能逐个项目设置访问权限。

这是通过运行 Source Safe Administration 应用程序然后转到工具 > 按项目的权限来完成的。选择所需的项目，然后为用户提供所需的权限。
为了保护文件的子集，请将它们放在单独的项目中，从而保护子集。

当您进入 Source Safe 时，如果您将子文件夹的工作文件夹设置为与父文件夹相同，那么当您执行获取最新等操作时，所有文件都将位于同一文件夹中。如果您希望受保护的文件位于单独的文件夹中，请相应地设置工作文件夹。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-09-25T18:06:02.853

自从我不得不使用 Source Safe 已经有一段时间了，但我认为它没有内置这种功能。

您可以设置一个单独的存储库/实例来排除不应被允许修改它们的用户吗？

或者失败了，只需保持文件始终在您的机器上签出：P

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-25T18:23:08.957

检查他们锁定独占

# c# - 在服务器端 webrequest 上执行严格的超时策略

> ID：134917
> 
> 赞同：1
> 
> 时间：2008-09-25T18:03:34.730
> 
> 标签：c#, .net, asp.net, rest, webrequest

我们需要调用第 3 方以使用 REST 检索值，但是如果我们在 10 毫秒内没有收到响应，我想使用默认值并继续处理。

我倾向于使用异步 WebRequest 来做到这一点，但我想知道使用同步请求是否有技巧。

有什么建议吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-09-25T18:17:32.857

如果您正在执行请求并等待它返回，我会说保持同步 - 如果您不打算做任何事情或在等待时保持响应，则没有理由执行异步请求。

对于同步呼叫：

```
WebRequest request = WebRequest.Create("http://something.somewhere/url");
WebResponse response = null;
request.Timeout = 10000; // 10 second timeout
try
{
    response = request.GetResponse();
}
catch(WebException e)
{
  if( e.Status == WebExceptionStatus.Timeout)
  {
    //something
  }
} 
```

如果做异步：

您必须在请求对象上调用 Abort() - 您需要自己检查超时，没有内置方法可以强制执行硬超时。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-09-25T18:41:30.363

您可以将您对第 3 方的调用封装在 WebService 中。然后，您可以从您的应用程序同步调用此 WebService - Web 服务引用有一个简单的超时属性，您可以将其设置为 10 秒或其他任何值。

在超时期限过后，您从 WebService 获取第 3 方数据的调用将引发 WebException。您抓住它并改用默认值。

编辑：菲利普上面的反应更好。里夫。

# visual-studio - Visual Studio 编辑器：删除结构化 IF/End If

> ID：134921
> 
> 赞同：1
> 
> 时间：2008-09-25T18:04:03.963
> 
> 标签：visual-studio, editor

是否有简单的方法可以删除**IF/End If**结构化配对。能够一键完成此操作会很好（我也使用 Refactor！Pro）

现在这就是我所做的：

1.  删除**IF**行
2.  考虑到缺少**IF ，观看 Visual Studio 重新格式化代码以正确排列。**
3.  如果导航到**末尾**
4.  删除**End If**行

即在以下示例中，我想将代码从

```
IF Value = True Then
  DoSomething()
  DoSomething2()
End IF 
```

至

```
DoSomething()
DoSomething2() 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-09-25T18:49:59.737

虽然这不是 Martin Fowler 的书[Refactoring](http://martinfowler.com/books.html#refactoring)所指定的意义上的字面重构，但这就是我使用 resharper 来实现这一目标的方式：

1.  **使用if**语句移动/单击
2.  按**control + delete**删除行
3.  按**Alt + enter**，选项*删除大括号*将是第一个指定的。
4.  按**回车**

完毕。不是很简单，但是击键很短，而且不太复杂，而且我不必花费/浪费时间使用愚蠢的箭头键或鼠标来完成这种类型的代码更改。

我相信 Resharper 从 4.0 开始支持 VB.net 代码。

# python - 显示带前导零的数字

> ID：134934
> 
> 赞同：1189
> 
> 时间：2008-09-25T18:06:06.487
> 
> 标签：python, integer, string-formatting

鉴于：

```
a = 1
b = 10
c = 100 
```

如何为所有少于两位数的数字显示前导零？

这是我期待的输出：

```
01
10
100 
```

* * *

## 回答 #1

> 赞同：1505
> 
> 时间：2008-09-25T18:08:21.363

在 Python 2（和 Python 3）中，您可以：

```
number = 1
print("%02d" % (number,)) 
```

基本上**%**就像`printf`或`sprintf`（请参阅[文档](https://docs.python.org/3/library/stdtypes.html#printf-style-string-formatting)）。

* * *

对于 Python 3.+，同样的行为也可以通过以下方式实现[`format`](https://docs.python.org/3/library/stdtypes.html#str.format)：

```
number = 1
print("{:02d}".format(number)) 
```

* * *

对于 Python 3.6+，可以使用[f-strings](https://docs.python.org/3/reference/lexical_analysis.html#f-strings)实现相同的行为：

```
number = 1
print(f"{number:02d}") 
```

* * *

## 回答 #2

> 赞同：1126
> 
> 时间：2010-07-30T11:58:30.337

您可以使用[`str.zfill`](https://docs.python.org/2/library/stdtypes.html#str.zfill)：

```
print(str(1).zfill(2))
print(str(10).zfill(2))
print(str(100).zfill(2)) 
```

印刷：

```
01
10
100 
```

* * *

## 回答 #3

> 赞同：376
> 
> 时间：2008-09-25T18:43:06.460

在 Python 2.6+ 和 3.0+ 中，您将使用[`format()`](https://docs.python.org/library/stdtypes.html#str.format)string 方法：

```
for i in (1, 10, 100):
    print('{num:02d}'.format(num=i)) 
```

或使用内置（对于单个数字）：

```
print(format(i, '02d')) 
```

有关新的格式化功能，请参阅[PEP-3101](http://www.python.org/dev/peps/pep-3101)文档。

* * *

## 回答 #4

> 赞同：151
> 
> 时间：2013-11-13T19:30:23.083

```
print('{:02}'.format(1))
print('{:02}'.format(10))
print('{:02}'.format(100)) 
```

印刷：

```
01
10
100 
```

* * *

## 回答 #5

> 赞同：97
> 
> 时间：2017-11-28T14:52:21.420

在**Python >= 3.6**中，您可以使用引入的新 f 字符串简洁地做到这一点：

```
f'{val:02}' 
```

它打印名称为和 a`val`的变量。[`fill`](https://docs.python.org/3/library/string.html#grammar-token-fill)`0`[`width`](https://docs.python.org/3/library/string.html#grammar-token-width)`2`

对于您的具体示例，您可以在循环中很好地执行此操作：

```
a, b, c = 1, 10, 100
for val in [a, b, c]:
    print(f'{val:02}') 
```

打印：

```
01 
10
100 
```

* * *

有关 f 字符串的更多信息，请查看引入它们的[PEP 498 。](https://www.python.org/dev/peps/pep-0498/)

* * *

## 回答 #6

> 赞同：90
> 
> 时间：2010-11-10T10:03:43.967

或这个：

`print '{0:02d}'.format(1)`

* * *

## 回答 #7

> 赞同：68
> 
> 时间：2008-09-25T18:07:37.170

```
x = [1, 10, 100]
for i in x:
    print '%02d' % i 
```

结果是：

```
01
10
100 
```

在文档中阅读[有关使用 % 进行字符串格式化的更多信息](https://pyformat.info/)。

* * *

## 回答 #8

> 赞同：55
> 
> 时间：2012-04-27T22:02:37.990

执行此操作的 Pythonic 方式：

```
str(number).rjust(string_width, fill_char) 
```

这样，如果其长度大于 string_width，则原始字符串将原样返回。例子：

```
a = [1, 10, 100]
for num in a:
    print str(num).rjust(2, '0') 
```

结果：

```
01
10
100 
```

* * *

## 回答 #9

> 赞同：34
> 
> 时间：2015-11-22T21:01:27.677

或者另一种解决方案。

```
"{:0>2}".format(number) 
```

* * *

## 回答 #10

> 赞同：7
> 
> 时间：2018-06-21T00:43:15.873

我就是这样做的：

```
str(1).zfill(len(str(total))) 
```

基本上 zfill 取你要添加的前导零的数量，所以很容易取最大的数字，把它变成一个字符串并得到长度，像这样：

```
Python 3.6.5（默认，2018 年 5 月 11 日，04:00:52）
[GCC 8.1.0] 在 Linux 上
输入“帮助”、“版权”、“信用”或“许可”以获取更多信息。
>>> 总计 = 100
>>> 打印(str(1).zfill(len(str(total))))
001
>>> 总计 = 1000
>>> 打印(str(1).zfill(len(str(total))))
0001
>>> 总计 = 10000
>>> 打印(str(1).zfill(len(str(total))))
00001
>>>

```

* * *

## 回答 #11

> 赞同：7
> 
> 时间：2020-03-11T18:50:30.170

你可以用*f strings*来做到这一点。

```
import numpy as np

print(f'{np.random.choice([1, 124, 13566]):0>8}') 
```

这将打印 8 的恒定长度，并用前导填充其余部分`0`。

```
00000001
00000124
00013566 
```

* * *

## 回答 #12

> 赞同：5
> 
> 时间：2008-09-25T18:10:01.003

使用格式字符串 - [http://docs.python.org/lib/typesseq-strings.html](http://docs.python.org/lib/typesseq-strings.html)

例如：

```
python -c 'print "%(num)02d" % {"num":5}' 
```

* * *

## 回答 #13

> 赞同：2
> 
> 时间：2013-11-15T16:33:33.573

```
width = 5
num = 3
formatted = (width - len(str(num))) * "0" + str(num)
print formatted 
```

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2018-04-20T13:21:55.293

采用：

```
'00'[len(str(i)):] + str(i) 
```

或使用`math`模块：

```
import math
'00'[math.ceil(math.log(i, 10)):] + str(i) 
```

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2021-03-09T18:51:58.277

所有这些都创建了字符串“01”：

```
>python -m timeit "'{:02d}'.format(1)"
1000000 loops, best of 5: 357 nsec per loop

>python -m timeit "'{0:0{1}d}'.format(1,2)"
500000 loops, best of 5: 607 nsec per loop

>python -m timeit "f'{1:02d}'"
1000000 loops, best of 5: 281 nsec per loop

>python -m timeit "f'{1:0{2}d}'"
500000 loops, best of 5: 423 nsec per loop

>python -m timeit "str(1).zfill(2)"
1000000 loops, best of 5: 271 nsec per loop

>python
Python 3.8.1 (tags/v3.8.1:1b293b6, Dec 18 2019, 23:11:46) [MSC v.1916 64 bit (AMD64)] on win32 
```

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2021-10-02T11:23:45.933

这将是 Python 的方式，尽管为了清楚起见我会包含参数 - “{0:0>2}”.format(number)，如果有人想要 nLeadingZeros，他们应该注意他们也可以这样做：“{0:0> {1}}".format（数字，nLeadingZeros + 1）

* * *

## 回答 #17

> 赞同：-3
> 
> 时间：2016-02-19T04:20:45.753

如果处理一位或两位数的数字：

`'0'+str(number)[-2:]`或者`'0{0}'.format(number)[-2:]`

# unicode - 在 vbscript 文件中键入双字节字符

> ID：134937
> 
> 赞同：3
> 
> 时间：2008-09-25T18:06:34.363
> 
> 标签：unicode, encoding, vbscript, utf-8, ansi

我需要将 → (&rarr) 转换为可以键入 ANSI VBScript 文件的符号。我正在编写一个脚本，该脚本使用正则表达式将一组选定的 htmlcode 转换为其实际的双字节符号。许多语言使用“\0x8594;”来实现这一点……VBScript 中的等价物是什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-09-25T18:54:14.797

答案是 ChrW(8594)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-25T18:31:38.283

ChrW(&H8594)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2011-02-23T06:41:35.957

注意：鲍勃金的回答对于所提供的信息是正确的。问题是 alumb 对数字字符实体引用的含义有误。→ （→ 单个右箭头），如前所述，也被标识为 → 但这是十进制的，因此不等同于“许多语言”（例如 C++）中的 \x8594。这就是 chrW(&H8594) 给出“错误”字符的原因。使用“&#x”而不是“&#”指定十六进制字符实体引用。因此 薔 (蔷) = \x8594 = chrW(&H8594) 而 → (→) = chrW(8594) = \x2192。

# php - 在 CakePHP 的视图中放置显示逻辑的最佳实践

> ID：134948
> 
> 赞同：0
> 
> 时间：2008-09-25T18:08:08.370
> 
> 标签：php, cakephp, cakephp-1.2

我有一个 CakePHP 1.2 应用程序。

我遇到了需要执行一些逻辑才能在视图中正确呈现事物的情况。

示例：我有一个名为 Types 的表。有各种类型的标志，因此每一行都设置了一个或多个 BOOL 字段。对于一种类型，我将 RTF 的内容存储在另一个字段中。

因此，当我在视图中显示所有拼写错误的列表时，我想为存储 RTF 的类型创建一个链接。我不想显示链接，否则。

这种逻辑的最佳位置在哪里？

我想使用 html->link 来创建链接，但我不能在我的模型中使用它。逻辑是否应该进入模型，如果是，我是否应该在我的模型中构建 HTML，例如链接？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-09-25T18:25:24.490

我建议在视图中保留该逻辑，在模型中构建 HTML 会破坏整个视图/模型的分离。我认为视图逻辑没有任何问题，我个人倾向于将其限制为基本条件。

最终我认为这个想法是找出这个逻辑最适合的地方。在这种情况下，逻辑是“如果我有某种类型，我应该提供指向它的链接”，这是一个视图问题，而不是模型问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-02T18:03:53.827

构建您自己的 AppHtmlHelper 扩展 HtmlHelper 并为您进行检查。

# version-control - USB 驱动器上的 SourceSafe 有什么好的替代方案？

> ID：134950
> 
> 赞同：7
> 
> 时间：2008-09-25T18:08:19.570
> 
> 标签：version-control

为了便于携带，我喜欢将源文件保存在 USB 驱动器上。迄今为止，我一直为此目的使用 Visual SourceSafe。什么是满足这些标准的 VSS 的良好替代方案：

*   整个数据库可以保存在 USB“笔”驱动器上
*   在本地驱动器上复制的代码/文档
*   不需要中央服务器
*   使用标准备份工具轻松备份和恢复
*   与 Visual Studio 集成
*   占地面积小
*   易于清理数据库并保持小
*   兼容 Windows XP、Vista 和 Vista x64

关于设置的一个很好的参考也很好。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-09-25T18:13:55.877

我会使用 SVN (Subversion)。

您可以在“文件”模式下使用 SVN（不使用网络）。将它与集成到资源管理器的 tortoiseSVN 结合起来，您就有了一个不错的小型便携式存储库。

对于 Visual Studio 集成，有商业版（49 美元）VisualSVN（我相信它是用于开发 StackOverflow 的设置）。

也有人提到了我没用过的 AnkhSVN，但有些人觉得它不太令人满意。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-09-25T18:09:10.647

不要使用 SourceSafe。它有很大的问题。看到这个：

*   [第1条](http://www.highprogrammer.com/alan/windev/sourcesafe.html)
*   [第二条](http://www.developsense.com/testing/VSSDefects.html)

我建议改用 SubVersion。

如果您使用的是 Windows，则可以使用[TortoiseSVN](http://tortoisesvn.tigris.org/)。

如果您正在使用 Linux 或其他 Unix 变体，请尝试[RapidSVN](http://rapidsvn.tigris.org/)。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-09-25T18:15:50.973

使用颠覆。FSFS 风格的存储库效果最好，因为旧的 BDB 存储库在从一台计算机移动到另一台计算机时可能会出现问题。使用 AnkhSVN，您将与 Visual Studio 完全集成（AnkhSVN 2.x 是一个源代码控制插件；不过，旧版本仍然可以完成这项工作）。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-09-25T18:16:09.567

[Bazaar 可以满足](http://bazaar-vcs.org/)您的要求（就独立工作而言非常好），并且有一个 2007 Summer of Code 项目来构建[一个 Visual Studio 集成插件](https://launchpad.net/bzr-visualstudio)，该插件似乎已经[产生了一个至少部分功能的产品](https://lists.ubuntu.com/archives/bazaar/2007q3/027836.html)。

Bazaar（以及其他分布式工具，例如 Git、Mercurial、Darc 等）是理想的，因为您可以将存储库存储在多个位置（即在您的笔式驱动器上，但也可以定期复制到服务器上） ，在一个或另一个分支中进行更改（假设您将笔式驱动器留在家中 - 您可以针对远程服务器上的副本构建更改，通过 WebDAV、SFTP 等上传它们，并能够将它们无缝合并到对笔式驱动器进行本地更改；Subversion 等非分布式解决方案没有该功能）。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-09-25T18:11:42.247

有两种常见的免费前端[Ankhsvn](http://ankhsvn.open.collab.net/)集成到 Visual Studio 和[TortoiseSVN](http://tortoisesvn.tigris.org/)集成到 explorer（我的偏好）。还有一个 sliksvn 一个独立的 svn 服务器用于 windows。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-09-25T18:16:00.550

我也推荐 SubVersion - 你可以找到一个以非常便宜的价格提供 SVN 的托管服务提供商，这样你的源代码总是可以备份和可用，你只需要在闪存驱动器上保留 SVN 客户端......

# validation - 您如何执行地址验证？

> ID：134956
> 
> 赞同：93
> 
> 时间：2008-09-25T18:09:12.767
> 
> 标签：validation, street-address

甚至可以执行地址（物理，而不是电子邮件）验证吗？似乎地址格式的绝对数量，即使仅在美国，也会使这项任务变得相当困难。另一方面，这似乎是满足多个业务需求所必需的任务。

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2008-09-30T14:57:10.943

这是一种免费且“开箱即用”的方式。不是 100% 完美，但它应该拒绝公然不存在的地址。

将整个地址提交给[Google 的地理编码网络服务](https://developers.google.com/maps/documentation/geocoding/)。该服务尝试返回您提供给它的位置的确切坐标，即纬度和经度。

根据我的经验，如果地址无效，您将从服务中获得 602 的结果。肯定存在误报或误报的可能性，但与其他一致性检查结合使用可能会很有用。

（另一方面， [Yahoo 的地理编码网络服务](http://developer.yahoo.com/maps/rest/V1/geocode.html)将返回该镇中心的坐标，如果该镇存在，但地址的其余部分是虚假的。只要您密切注意结果）。

* * *

## 回答 #2

> 赞同：21
> 
> 时间：2011-10-13T04:11:39.960

这里有许多很好的答案，但其中大多数都假设用户想要一个“API”解决方案，他们必须编写代码来连接到第 3 方服务和/或屏幕抓取 USPS。这一切都很好，但应该考虑到与实施相关的业务需求和成本，然后权衡所需的收益。

根据业务需求和系统接收数据的方式，实时地址处理解决方案可能是最佳选择。如果需要实时解决方案，您需要考虑 Google Maps/Bing/Yahoo API 的许可协议和技术限制。他们通常会限制您每天可以拨打的电话数量。USPS 网络工具 API 是相同的，另外它们限制了您如何/为什么可以使用他们的系统，以及之后您如何被允许使用数据。

同时，有少数优秀的服务提供商可以轻松处理静态地址列表。本质上，您给服务提供商一个 C​​SV 文件或 Excel 文件，他们将其清理并取回给您。这是一次性的交易，通常没有长期承诺或义务。

全面披露：我是 SmartyStreets 的创始人。我们对美国境内的地址进行地址验证。我们可以轻松地对[列表进行 CASS 认证](https://smartystreets.com/demo)，并且我们还提供[地址验证 Web 服务 API](https://smartystreets.com/docs/address)。我们没有隐藏的费用、合同或任何东西。您使用我们的服务，直到您不再需要它并且您可以离开。（与需要合同的手机公司不同。）

* * *

## 回答 #3

> 赞同：15
> 
> 时间：2008-09-30T15:07:06.130

USPS 有一个[在线](http://zip4.usps.com/zip4/)地址清理器，有人将它的[屏幕抓取](http://www.eggheadcafe.com/articles/20060430.asp)到一个穷人的网络服务中。但是，如果您经常这样做，最好申请一个[USPS 帐户](https://www.usps.com/business/web-tools-apis/developers-center.htm)并调用他们自己的[webservice](https://www.usps.com/business/web-tools-apis/welcome.htm)。

* * *

## 回答 #4

> 赞同：9
> 
> 时间：2009-07-23T15:59:15.693

我将向您推荐我的博客文章-[地址存储课程](https://endswithsaurus.wordpress.com/2009/07/23/a-lesson-in-address-storage/)，我将介绍地址验证过程中使用的一些技术和算法。我的主要想法是*“地址存储不要偷懒，以后只会让你头疼！”*

此外，还有另一个 StackOverflow 问题，它提出了题为[“国际地理地址应如何存储在关系数据库中”的问题](https://stackoverflow.com/questions/1159756/how-should-international-geographical-addresses-be-stored-in-a-relational-databas)。

* * *

## 回答 #5

> 赞同：8
> 
> 时间：2017-01-19T20:34:07.093

在我曾经工作过的一家德国公司开发内部地址验证服务的过程中，我遇到了许多解决这个问题的方法。我将尽我所能在下面总结我的发现：

**免费的开源软件**

显然，任何人都会采用的第一种方法是开源的（例如[openstreetmap.org](http://openstreetmap.org)），这绝不是一个坏主意。但是，您能否真正将其用于良好和可靠的使用，很大程度上取决于您需要在多大程度上依赖结果。

地址是一个非常多变的东西。验证美国地址不是一件容易的事，但可以忍受，但是一旦你去欧洲，尤其是拥有广泛邮政编码系统的英国，开源方法将根本缺乏数据。

**网络服务/API**

*企业级软件*

很明显，钱可以解决问题。但并不是每个企业或开发人员每次地址查找都可以花费约 0.15 美元（即 1,000 个 API 请求需要 150 美元）——这是一种非常昂贵的商业模式，绝大多数地址验证 API 都已实施。

**我最终集成的内容：[streetlayer API](https://streetlayer.com)**

由于我不愿意采用手动验证地址数据的编程方法，我最终得出结论，我需要一个价格标签不会让我的老板想要解雇我并且仍然提供可靠可靠的 API国际验证结果。

长话短说，我最终集成了一个由 apilayer 构建的 API，称为“streetlayer API”。简单的 JSON 集成、令人惊讶的准确验证结果及其对开发人员友好的定价让我很容易信服。此外，每月 100 个请求完全免费。

希望这可以帮助！

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-09-30T14:46:49.673

我使用过[http://www.melissadata.com](http://www.melissadata.com)的服务， 他们的“地址对象”运行良好。它的价格昂贵，是的。但是，当您考虑编写自己的解决方案的成本、应用程序中脏数据的成本、退回的邮件（销售损失等）时，这些成本是合理的。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2011-02-20T20:12:57.167

您还可以尝试 SAP 的数据质量解决方案，该解决方案可在服务器平台处理大量请求时使用，如果您想在应用程序的进程中运行它，也可以作为可嵌入的 SDK 使用。我们在我们的应用程序中使用它，它非常健壮且可扩展。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2012-11-12T20:42:12.043

正如在[reddit](http://www.reddit.com/r/PHP/comments/131smj/i_have_hundreds_of_addresses_in_a_sql_database/c70315i)上看到的：

```
$address = urlencode('1600 Pennsylvania Avenue, Washington, DC');
$json = json_decode(file_get_contents("http://where.yahooapis.com/geocode?q=$address&flags=J"));
print_r($json); 
```

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2017-06-08T04:59:32.813

Fixaddress.com 服务可提供以下服务，

1) 地址验证。

2）地址更正。

3) 地址拼写纠正。

4) 纠正拼音错误。

Fixaddress.com 使用 USPS 和 Tiger 数据作为参考数据。

有关更多详细信息，请访问以下链接，

[http://www.fixaddress.com/](http://www.fixaddress.com/)

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2017-12-22T11:37:26.223

您可以尝试 Pitney Bowes “IdentifyAddress” Api，网址为 - [https://identify.pitneybowes.com/](https://identify.pitneybowes.com/)

该服务分析输入地址并将其与世界各地的已知地址数据库进行比较，以输出标准化的详细信息。它更正地址，添加丢失的邮政信息，并使用适用邮政当局首选的格式对其进行格式化。我还使用了额外的地址数据库，因此它可以提供增强的详细信息，包括地址质量、地址类型、音译（例如从中文汉字到拉丁字符）以及地址是否已验证到场所/门牌号、街道或城市级别的参考信息。

你会在网站上找到很多可用的示例和 sdk，我发现它非常容易集成。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2018-01-18T00:10:08.800

必须可靠地执行地址查找的一个领域是 VOIP E911 服务。我知道公司为此可靠地使用以下服务：

**Bandwidth.com** 9-1-1 访问 API MSAG 地址验证

MSAG = 主街地址指南

[https://www.bandwidth.com/9-1-1/](https://www.bandwidth.com/9-1-1/)

**SmartyStreet**美国街道地址 API

[https://smartystreets.com/docs/cloud/us-street-api](https://smartystreets.com/docs/cloud/us-street-api)

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2008-09-25T18:17:35.540

对于基于我们的地址数据，我的公司使用[了 GeoStan](http://www.centrus.com/GeoStan.html)。它具有 C 和 Java 的绑定（我们创建了一个 Perl 绑定）。请注意，它是一种商业产品，并不便宜。虽然它非常快（每秒约 300 个地址），并提供 CASS 认证（USPS 批量邮件折扣）、DPV（投递点验证）标记和 LON/LAT 地理编码等功能。

有一个 Perl 模块[Geo::PostalAddress](http://search.cpan.org/~pauamma/Geo-PostalAddress-0.04/PostalAddress.pm)，但它使用启发式方法并且没有为 GeoStan 提到的其他功能。

编辑：有些人提到“自己做”，如果你决定这样做，一个很好的信息来源是[美国人口普查老虎数据集](http://www.census.gov/geo/www/tiger/)，其中包含很多关于美国的信息，包括地址信息。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2008-09-25T18:19:11.433

有提供这种服务的公司。处理群发邮件的服务机构将清理整个邮件列表以确保其格式正确，从而导致邮资折扣。USPS 销售可用于开发定制解决方案的地址信息数据库。他们还有提供此类软件和服务的经批准的供应商名单。

有一些（但不是很多）包具有用于将地址验证挂钩到您的软件的 API。

但是，您说得对，这是一个非常讨厌的问题。

[http://www.usps.com/ncsc/ziplookup/vendorslicensees.htm](http://www.usps.com/ncsc/ziplookup/vendorslicensees.htm)

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2008-09-25T18:31:59.000

如前所述，那里有许多服务，如果您希望真正验证整个地址，那么我强烈建议您使用 Web 服务类型的服务，以确保您的应用程序可以快速识别更改。

除了上面列出的服务之外，webservice.net 还有这个美国地址验证服务。[http://www.webservicex.net/WCF/ServiceDetails.aspx?SID=24](http://www.webservicex.net/WCF/ServiceDetails.aspx?SID=24)

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2008-09-25T19:25:02.617

我们在[Perfect Address](http://www.zipinfo.com/products/sdk/sdk.htm)方面取得了成功。

他们的数据库包含所有美国街道名称和街道号码范围。如果您有幸拥有这种数据，它还可以作为自由格式地址字段的相当不错的解析器。

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2008-09-30T14:42:59.340

验证它是一个有效的地址是一回事。

但是，如果您要验证给定的人住在给定的地址，那么您唯一几乎可以保证的就是发送到该地址的测试邮件，即使这样也不确定该人是否有组织或认识该地址的某人。

否则人们可以指定一个他们知道存在的任意随机地址，这对你来说毫无意义。

为了立即获得结果，您可以做的最好的事情是要求用户发送他们银行对账单或其他一些近期居住证明的照片/扫描副本，因为至少他们必须更加努力地忘记它，并且锻造说的事情很容易通过基本的图像取证分析显示出来。

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2008-09-30T14:57:54.827

没有全球解决方案。对于任何给定的国家来说，这充其量是相当棘手的。

在英国，邮局控制邮政地址，并且可以（有偿）提供地址信息以进行验证。

政府机构还保留一份广泛的地址列表，这些地址集中整理在 NLPG（国家土地和财产地名录）中。

实际上验证这些列表是非常困难的。大多数人甚至不知道他们的地址是如何被邮局保存的。有些企业甚至不知道他们在特定街道上的号码。

你最好的选择是联系一家专门从事这类事情的公司。

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2009-07-23T16:05:01.860

雅虎也有[Placemaker API。](http://developer.yahoo.com/geo/placemaker/)它仅适用于位置，但它具有适用于所有世界位置的通用 ID。

[看起来ISO 列表](http://en.wikipedia.org/wiki/List_of_ISO_standards)中没有标准。

* * *

## 回答 #19

> 赞同：0
> 
> 时间：2017-01-10T20:43:37.563

NAICS.com 推出了一个 API，它将添加包括街道地址在内的各种关键业务数据。这将在处理您网站的表单时即时发生。[https://www.naics.com/business-intelligence-api/](https://www.naics.com/business-intelligence-api/)

* * *

## 回答 #20

> 赞同：-1
> 
> 时间：2008-09-25T18:14:56.340

对于美国地址，您可以要求有效状态，并验证 zip 是否有效。您甚至可以检查邮政编码是否处于正确状态，但除此之外，我认为您可以运行的许多测试不会提供很多假阴性。

你想做什么——防止简单的错误或执行某种身份检查？

# sql - 获得每个组的最佳结果（在 Oracle 中）

> ID：134958
> 
> 赞同：16
> 
> 时间：2008-09-25T18:09:32.687
> 
> 标签：sql, oracle, greatest-n-per-group

我如何能够在 oracle 查询中为多个组获得 N 个结果。

例如，给定下表：

```
|--------+------------+------------|
| emp_id | name       | occupation |
|--------+------------+------------|
|      1 | John Smith | Accountant |
|      2 | Jane Doe   | Engineer   |
|      3 | Jack Black | Funnyman   |
|--------+------------+------------| 
```

有更多的行有更多的职业。我想从每个职业中获得三名员工（比如说）。

有没有办法在不使用子查询的情况下做到这一点？

* * *

## 回答 #1

> 赞同：41
> 
> 时间：2008-09-25T18:27:48.760

我现在没有方便的 oracle 实例，所以我没有对此进行测试：

```
select *
from (select emp_id, name, occupation,
      rank() over ( partition by occupation order by emp_id) rank
      from employee)
where rank <= 3 
```

这是有关排名如何工作的链接：[http ://www.psoug.org/reference/rank.html](http://www.psoug.org/reference/rank.html)

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2008-09-25T20:48:29.903

这会产生您想要的东西，并且它不使用特定于供应商的 SQL 功能，例如 TOP N 或 RANK()。

```
SELECT MAX(e.name) AS name, MAX(e.occupation) AS occupation 
FROM emp e 
  LEFT OUTER JOIN emp e2 
    ON (e.occupation = e2.occupation AND e.emp_id <= e2.emp_id) 
GROUP BY e.emp_id 
HAVING COUNT(*) <= 3 
ORDER BY occupation; 
```

在此示例中，它为每个职业的 emp_id 值最低的三名员工提供了信息。您可以更改不平等比较中使用的属性，使其按姓名或其他方式提供顶级员工。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2011-06-07T10:05:12.793

将 RowNum 添加到排名：

```
select * from 
         (select emp_id, name, occupation,rank() over ( partition by occupation order by emp_id,RowNum) rank   
                      from employee) 
         where rank <= 3 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-09-25T18:24:55.007

我不确定这是否非常有效，但也许是一个起点？

```
select *
from people p1
    join people p2
        on p1.occupation = p2.occupation
    join people p3
        on p1.occupation = p3.occupation
        and p2.occupation = p3.occupation
where p1.emp_id != p2.emp_id
    and p1.emp_id != p3.emp_id 
```

这应该为您提供包含 3 名不同员工的行，这些员工都在同一职业中。不幸的是，它会给你这些的所有组合。

请问有人能把这个减掉吗？

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-09-25T18:32:12.150

在 SQL Server 中对此进行了测试（并且它使用子查询）

```
select emp_id, name, occupation
from employees t1
where emp_id IN (select top 3 emp_id from employees t2 where t2.occupation = t1.occupation) 
```

只需在子查询中执行 ORDER 即可满足您的需求

# asp.net - 缓存用户控件时可以使用多个 VaryByCustom 参数吗？

> ID：134962
> 
> 赞同：7
> 
> 时间：2008-09-25T18:10:02.343
> 
> 标签：asp.net, caching

我一直在尝试几种不同的方法，但由于某种原因它不起作用。甚至可能吗？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2008-09-25T18:30:13.590

是的。在声明中用分号分隔它们。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-09-25T18:49:28.160

如果您在 Global.asax.cs 文件中覆盖 GetVaryByCustomString()，您可以传入一个分号分隔的值列表，然后您需要对其进行解析。

如果指定的属性不存在，将使用一个内置值（浏览器）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-09-20T12:41:19.143

您可以通过分号分隔来使用多个参数，但您必须自己实现拆分它们的逻辑。**这意味着您可以使用任何字符作为分隔符，因为您需要自己解析它。**

您可能会覆盖`GetVaryByCustomString(HttpContext context, string custom)`您的 global.asax。该`custom`参数将包含您使用传递的任何内容`VaryByCustom`，如下所示

```
<%@ OutputCache Duration="86400" VaryByParam="none" VaryByCustom="custom1;custom2" %> 
```

*额外说明：`base.GetVaryByCustomString`不实现任何字符串拆分功能，仅在`browser`作为值传递时才会执行某些操作。否则它将返回`null`。*

# ruby - Ruby - 相当于 Python __str__() 方法？

> ID：134969
> 
> 赞同：5
> 
> 时间：2008-09-25T18:11:19.640
> 
> 标签：ruby

在 Ruby 中，是否有与`__str__()`您可以在 Python 类上定义的方法等效的方法？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2008-09-25T18:15:41.253

你可以使用 to_s。

[http://briancarper.net/2006/09/26/ruby-to_s-vs-to_str/](http://briancarper.net/2006/09/26/ruby-to_s-vs-to_str/)

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-09-25T20:00:04.483

`__repr__()`FWIW ，检查可能更像`__str__()`

从图书馆参考...

**代表**（自我）

`Called by the repr() built-in function and by string conversions (reverse quotes) to compute the ``official'' string representation of an object. If at all possible, this should look like a valid Python expression that could be used to recreate an object with the same value (given an appropriate environment). If this is not possible, a string of the form "<...some useful description...>" should be returned. The return value must be a string object. If a class defines __repr__() but not __str__(), then __repr__() is also used when an ``informal'' string representation of instances of that class is required.`

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2008-09-25T18:12:59.577

在核心类上，它通常是“检查”。

例如：

```
irb(main):001:0> puts "array is: #{[1,2,3].inspect}"
array is: [1, 2, 3]
=> nil
irb(main):002:0> puts "array is: #{[1,2,3]}"
array is: 123
=> nil
irb(main):003:0> 
```

# c# - 如何找到特定对象存在的引用数？

> ID：134976
> 
> 赞同：0
> 
> 时间：2008-09-25T18:12:52.523
> 
> 标签：c#, .net, vb.net, visual-studio-2008

我有一些代码传递大量对象，我想确定是否有任何我不知道的引用仍在徘徊，以及这些引用的位置。知道我该怎么做吗？

我的理解是监视窗口只允许我查看当前正在执行的代码块可用的项目，并且“查找所有引用”仅在我在编译时添加对对象的引用时才有帮助。除非监视窗口的内容比我知道的要多。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-09-25T18:15:37.370

如果您在代码中说话，只需右键单击对象名称，在下拉菜单中选择“查找所有引用”，引用列表将出现在输出窗口的下方

编辑：由于只有一个 .NET 标签，Visual Studio 假设

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-25T18:14:06.903

在像 Elcipse 或 Visual Studio 这样的 IDE 中，您可以使用上下文菜单来完成。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-25T18:49:17.070

探查器将允许您执行此操作。CLR Profiler 或 ANTS Profiler 就是两个例子。

# sharepoint - 仅保护站点的 Login.aspx

> ID：134988
> 
> 赞同：2
> 
> 时间：2008-09-25T18:14:59.943
> 
> 标签：sharepoint, iis, ssl, login, security

1.  是否可以只保护 Login.aspx 页面（和回发）而不是 IIS 中的整个站点？
2.  我们希望通过针对我们的 Active Directory 运行基于表单的身份验证的 SharePoint 站点来专门执行此操作。
3.  指向此的链接会有所帮助。

这是我们到目前为止所做的：
1\. 设置 SharePoint 以使用 FBA 对抗 AD。
2\. 将登录页面移至 Secure/Login.aspx
3\. 在 web.config 中将相应的登录 url 设置为`https://..../Secure/Login.aspx`

这不起作用，这里需要帮助。但是，即使这可行，我们如何让用户从 https 回到 http？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-09-25T18:22:45.213

没有太多的意义。如果唯一加密的是 Login.aspx 页面，这意味着有人可以嗅探所有未通过登录页面发送的流量。

这可能会阻止人们获取用户：通过，但您的所有其他数据都会暴露。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-09-25T18:47:49.977

除了所有暴露的数据，以及可以在途中更改的用户操作外，用户的会话 id（或其他身份验证数据）以明文形式发送。这意味着攻击者可以窃取您的 cookie (...) 并在系统中冒充您，即使没有获得您的密码。（如果我没记错的话，SPSv.3 也支持内置密码更改模块......）
所以我会说这不是一个好主意，除非你不太关心那个系统......但是，为什么还要打扰认证？只是让它匿名？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-30T16:40:52.723

我同意 AviD 和 Dan Williams 的观点，即仅保护登录页面并不是一个好主意，因为它会在离开密码页面后暴露其他数据。但是，您可以通过 IIS 管理器仅对 login.aspx 页面要求 SSL。如果您导航到 IIS 管理器中的 login.aspx 页面（我相信它在 下`/_layouts`），您可以右键单击单个文件并选择`Properties`. 从那里，转到`File Security`选项卡并单击`Edit...`下的按钮`Secure communications`。在那里，您可以选中该`Require secure channel (SSL)`框，并且仅该页面需要 SSL。

我不赞成让用户从那里返回 http，但我相信它的默认行为是在登录成功时将您发送到请求的页面。如果没有，我认为您可以自定义登录页面在成功登录时向您发送的位置。

# c# - 检查.NET中是否可以访问服务器的最佳方法？

> ID：134992
> 
> 赞同：2
> 
> 时间：2008-09-25T18:15:37.230
> 
> 标签：c#, .net, web-services

我在 C# 中创建了一个时钟应用程序，该应用程序连接到我们服务器上的 Web 服务，以便为员工上班/下班打卡。该应用程序驻留在系统托盘中，如果用户关闭/暂停他们的机器，或者如果他们空闲超过三个小时，它会在最后一次活动时将他们打卡。

我的问题是，当用户将他的机器从睡眠状态（触发 SystemEvents.PowerModeChanged 事件）中恢复过来时，应用程序会尝试为员工重新计时，但当时网络连接尚未完全初始化，并且网络- 服务呼叫超时。

一个明显的解决方案，尽管它是一个黑客，将延迟时钟，但这并不一定能全面解决问题。我想要做的是一种“无情”的时钟，它会一直等到它可以看到服务器，直到它真正尝试打卡。

确定是否可以建立到 Web 服务的连接的最佳方法是什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-09-25T18:19:46.937

最好的方法是实际尝试建立连接并捕获错误。您可以 ping 机器，但这只会告诉您机器是否正在运行并且在网络上，这并不一定反映 Web 服务是否正在运行和可用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-09-25T18:27:58.040

处理事件时，将您的连接代码放入一个方法中，该方法将循环直到成功，捕获错误并重试。

即使是延迟也不是完美的，因为取决于运行它的各个系统和其他应用程序，重新建立网络连接可能需要不同的时间。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-25T18:28:00.053

如果问题是重新建立网络服务的延迟，[Ping](http://msdn.microsoft.com/en-us/library/system.net.networkinformation.ping.aspx)是解决方案；就像按门铃看看有没有人在家

如果 ping 成功，则尝试调用 Web 服务，适当地捕获异常（我认为 SocketException 和 SoapException 都可能发生，具体取决于准备情况/响应能力）

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-25T21:57:54.650

实现一个队列，您可以在其中发布消息并让一个线程定期尝试将内存中的队列刷新到 Web 服务。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-02T17:18:46.170

尽管 Web 服务端口已打开，但可以禁用 Ping。我不会用这种方法...***********