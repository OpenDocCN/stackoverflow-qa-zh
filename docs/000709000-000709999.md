# StackOverflow 问答 000709000-000709999

# mysql - 仅mysql转储表

> ID：709000
> 
> 赞同：24
> 
> 时间：2009-04-02T09:35:00.350
> 
> 标签：mysql, export

在我的数据库中，我有一些表和视图。如何从命令行从我的数据库中导出所有表（而不是视图）？

* * *

## 回答 #1

> 赞同：30
> 
> 时间：2011-12-16T09:33:23.800

要忽略 DB for Dump 中的单个视图：

`mysqldump -uusrname -ppwd -h hostname --ignore-table=db.view_name db > db.sql`

要忽略 Db for Dump 中的多个视图：

`mysqldump -uusrname -ppwd -h hostname --ignore-table=db.view1 --ignore-table=db.view2 db > db.sql`

注意：多次忽略转储使用`--ignore-table`选项的多个视图。

* * *

## 回答 #2

> 赞同：29
> 
> 时间：2009-04-02T09:56:25.587

当前的实现 mysqldump 不会在没有视图的情况下创建转储——此外，（上次我检查）视图实际上被创建了两次——一次作为表，然后表被删除并替换为视图。因此，您不能只过滤掉“CREATE VIEW”命令，除非该行为已被修改。

但是， mysqldump 会将表列表作为数据库名称后面的参数。像这样的东西：

```
mysqldump -ujoe -pmysecret joesdb posts tags comments users 
```

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2010-05-24T15:01:45.650

从数据库备份单个表

```
mysqldump -uUSERNAME -pPASWORD DATABASE TABLE_NAME --host=HOST_NAME > c:\TABLE_NAME.sql 
```

从数据库转储中恢复单个表

```
mysql -uUSERNAME -pPASSWORD DATABASE --host=HOST_NAME < c:\TABLE_NAME.sql 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2014-07-11T11:11:53.103

更新了@ladieu 的脚本：

*   Shell 参数已正确转义，允许带有 shell 字符的密码
*   使用 PDO 而不是 mysql 特定函数（有时 IP 似乎使用 mysql_* 函数针对 DNS 解析，从而触发错误）
*   删除了脚本在本地使用的假设（添加了主机参数）
*   使用“-r”选项来避免编码问题
*   将输出文件命名为 .sql
*   重新排列参数，使其适合“我想连接到由和转储数据库标识的用户>

```
<?php

if (is_array($argv) && count($argv)>3) {
    $host=($argv[1]);
    $user=($argv[2]);
    $password=($argv[3]);
    $database=($argv[4]);

}
else {
    echo "Usage php mysqdump.php <host> <user> <password> <database>\n";
    exit;
}

echo 'connecting to'.$host;

$pdo=new PDO("mysql:host=$host;dbname=$database",$user,$password);

//$link = mysql_connect($host, $user, $password);

//$source = mysql_select_db($database, $link);
$sql = "SHOW FULL TABLES IN `$database` WHERE TABLE_TYPE LIKE 'VIEW';";
$result = $pdo->query($sql);
$views=array();
while ($row = $result->fetch()) {
   $views[]="--ignore-table={$database}.".$row[0];
}
//no views or triggers please
$host=escapeshellarg($host);
$user=escapeshellarg($user);
$password=escapeshellarg($password);
$database=escapeshellarg($database);
echo passthru("mysqldump -h $host -u $user --password=\"$password\" $database --skip-triggers ".implode(" ",$views)." -r $database.sql"); 
```

享受 ！

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-11-08T18:26:45.410

用法

```
php mysqldump.php mydatabase myusername mypassword > myoutputfile.sql 
```

这是我的一个相当古老的脚本。如果您无权访问 mysql 函数，有人可以轻松地将其修改为使用 PDO。

```
<?php

if (is_array($argv) && count($argv)>3) {
    $database=$argv[1];
    $user=$argv[2];
    $password=$argv[3];
}
else {
    echo "Usage php mysqdump.php <database> <user> <password>\n";
    exit;
}

$link = mysql_connect('localhost', $user, $password);

if (!$link) {
    die('Could not connect: ' . mysql_error());
}

$source = mysql_select_db('$database', $link);
$sql = "SHOW FULL TABLES IN `$database` WHERE TABLE_TYPE LIKE 'VIEW';";
$result = mysql_query($sql);
$views=array();
while ($row = mysql_fetch_row($result)) {
   $views[]="--ignore-table={$database}.".$row[0];
}
//no views or triggers please
echo passthru("mysqldump -u root --password=\"$password\" $database --skip-triggers ".implode(" ",$views));

?> 
```

* * *

## 回答 #6

> 赞同：-2
> 
> 时间：2009-04-02T09:49:31.423

您可以使用带有选项[--ignore-table](http://dev.mysql.com/doc/refman/5.1/en/mysqldump.html#option_mysqldump_ignore-table)的 mysqldump来单独排除视图。或者使用 mysqldump 并使用应用程序/手动删除视图。grep 可能是一个选项：

```
grep -v "CREATE VIEW" db.dump > db-without-views.dump 
```

* * *

## 回答 #7

> 赞同：-2
> 
> 时间：2013-05-29T07:35:25.213

尝试以下操作：

```
mysqldump -h drupdbsvr  -u elt_drupal_dba -pdrupdev-654! clms_admin views_display views_view view_argument view_exposed_filter view_filter view_sort view_tablefield view_view > /opt/dbdump/clms_admin_view.sql 
```

语法是：-

```
mysqldump -h hostname -u database_user_name database_password database_name table_name1 table_name2 > path/sql_file.sql 
```

# image - Photoshop 保存为网络

> ID：709002
> 
> 赞同：0
> 
> 时间：2009-04-02T09:35:15.137
> 
> 标签：image, photoshop, file-format

在 Photoshop 的“为 web 和设备保存”对话框中，我如何选择所有切片将使用的文件格式，而无需为每个切片选择格式。我有很多切片，需要不止一次这样做。

我正在使用 Photoshop CS4。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-02T09:55:42.857

您不能选择所有切片并在保存网络对话中选择格式吗？您可以在对话框中选择多个切片，方法是按住 shift 键单击它们（即在使用鼠标选择时按住 shift 键）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-02T10:07:44.123

按 Ctrl+A

*编辑：根据评论，这在 CS4 或 CS5 中不起作用。*

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-09-29T04:13:58.980

只需在 Save For Web 窗口中单击并拖动（使用切片工具）。这将绘制一个选择框，并将选择里面的所有切片。

“不要切片。这是 1990 年代的表格布局。”

这是荒谬的。图像一直用于网页布局。

# c# - 将 .NET Windows 控件升级为 WPF 控件的最佳方式？

> ID：709009
> 
> 赞同：0
> 
> 时间：2009-04-02T09:36:53.653
> 
> 标签：c#, .net, wpf, controls

我们即将将**C# windows 应用程序**(1.1)从**windows 控件**(3.5) 升级到**WPF 。**

 ***   你对从哪里**开始有什么建议吗**
*   任何**提示和技巧**？
*   要**避免**什么？

*窗口控件**（1.1 .NET）**与应用程序的“入口点”和“过程控制器”一起存在于解决方案中的一个单独项目中。*

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-02T10:11:25.333

我建议从小处着手，因为 WPF/Xaml 的学习曲线非常陡峭，我认为有竞争力的 C#/WinForms 开发人员需要 6 个月才能适应 - 所以你的“...大型应用程序和大量业务逻辑.. .” 可能不是一个很好的开始。

OTOH，如果您的团队已经熟悉 WPF，那么真正的第一步是确定用户想要哪些功能可以通过 WPF 的图形细节得到最好的服务。如果他们真的想要 3D 旋转表单，那么实现一个好的工作*原型*，如果他们想要调整文档大小，那么就这样做。这是一个大象问题，一次只能解决一小部分。

真正尽早决定的关键是是使用 MVC 还是使用它的各种后代。该决定将决定您放置代码的位置。由于 WPF 严重依赖于绑定，因此在您知道绑定将如何/何时/在何处发生之前，您无法继续前进。

# c# - 泛型是此类设计的解决方案吗？

> ID：709017
> 
> 赞同：1
> 
> 时间：2009-04-02T09:39:02.023
> 
> 标签：c#, generics

我有一个可能值的枚举：

```
 public enum Language
    {
        English = 1,
        French = 2,
        German = 3
    } 
```

现在我希望我的类是动态的，因为它可以基于枚举列表满足多个值。因此，如果枚举列表增长，我可以捕获所有可能的值。

这是我最初设计的样子：

```
 public class Locale
    {
        public string EnglishValue { get; set; }
        public string FrenchValue { get; set; }
        public string GermanValue { get; set; }
    } 
```

但是如果枚举列表（或任何列表）增长，我想要一些不需要重新编译的东西：是否可以表达如下内容：

```
 public class Locale
    {
        public string StringValue<T> Where T : Language
    } 
```

我愿意接受任何可以很好地解决这个问题的建议或设计模式。谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-02T09:50:52.590

只需使用字典。

```
public class Locale : Dictionary<Language, string>
{
} 
```

不管你做什么，如果你改变枚举，你必须重新编译，但你可能的意思是“维护” Locale 类。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-02T09:42:48.410

不幸的是，您提出的建议行不通。恕我直言，这将是一个更好的设计：

```
public class Locale
{
    public string GetStringValue(Language language)
    {
        // return value as appropriate
    }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-02T09:43:53.637

泛型参数是类型参数，而不是值参数，枚举成员（至少在 C# 中）是不同的值，而不是类型。枚举（在本例中为 Language）确实是一种类型，但不是它的成员。

此外，泛型类会知道它有一个继承自 Language 的类型参数，但由于枚举在 C# 中是不可继承的，因此 this 和泛型类型参数约束（“where T:Langauge”事物）一起几乎意味着泛型类型参数在所有情况下都将始终为“语言”，因此在这种情况下没有泛型类。如果我是你，我会这样做：

```
public class Locale
{
    public string GetStringValue(Language language)
    {
        // ...
    }
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-02T09:47:34.187

也许像 System.Globalization.CultureInfo 一样，将 Language 作为一个类并封装一些特定于语言的处理会更好？

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-02T09:48:31.300

虽然我同意其他答案，但您当然可以使用字典作为语言列表，然后在运行时从本地配置或数据库中填充它，从而为您提供可扩展性，而无需重新编译。

# silverlight - 为什么在全屏模式下我没有收到键盘输入事件？

> ID：709019
> 
> 赞同：4
> 
> 时间：2009-04-02T09:40:37.573
> 
> 标签：silverlight, silverlight-2.0

我在使用 Silverlight 全屏模式时遇到了一些问题。

如果我将应用程序切换到全屏，则不会处理来自键盘的所有输入。没有文本框输入，没有按键/按键事件，可能还有更多。这是一个示例应用程序，演示了这一点：

**xml:**

```
<Canvas>

<TextBlock Text="Try some input:" Canvas.Top="10" Width="100"></TextBlock>

<TextBox x:Name="tboxInput" Width="100" Canvas.Top="30"></TextBox>

<Button x:Name="btnFullScreen" Content="Go Full Screen" Canvas.Top="60"></Button>

</Canvas> 
```

**后面的代码：**

```
public Page() 
{

InitializeComponent();

btnFullScreen.Click += new RoutedEventHandler(btnFullScreen_Click); 
}

void btnFullScreen_Click(object sender, RoutedEventArgs e) 
{

Application.Current.Host.Content.IsFullScreen = !Application.Current.Host.Content.IsFullScreen; 
if (!Application.Current.Host.Content.IsFullScreen)

btnFullScreen.Content = "Go Full Screen"; 
else

btnFullScreen.Content = "Go Normal Screen"; 
} 
```

很容易看出，在全屏模式下，您无法在文本框中输入文本。我在这里做错了吗？是否有另一种方法可以切换全屏，这样就不会发生这种情况？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-04-02T09:43:44.493

此链接应该可以帮助您：[http ://silverlight.net/forums/p/11519/36798.aspx](http://silverlight.net/forums/p/11519/36798.aspx)

**编辑**

而这篇[MSDN 文章](http://msdn.microsoft.com/en-us/library/cc189023(VS.95).aspx)给了你更详细的理由：

> 当 Silverlight 插件处于全屏模式时，它会禁用大多数键盘事件。这种在全屏模式下对键盘输入的限制是一项安全功能，旨在最大限度地减少用户输入意外信息的可能性。在全屏模式下，唯一允许的输入是通过以下键。
> 
> 上箭头、下箭头、左箭头、右箭头、空格键、制表符、上翻页、下翻页、主页、结束、回车

# java - （网络套接字）字节在发送队列中停留 15 分钟；为什么？

> ID：709033
> 
> 赞同：4
> 
> 时间：2009-04-02T09:44:31.857
> 
> 标签：java, networking, routing, firewall

我有一个在 Windows（Citrix 机器）上运行的 Java 程序，它向 Linux 上的 Java 应用程序服务器发送请求；这种调度机制都是自定义的。

Windows Java 程序（我们称之为它`W`）打开一个监听套接字到操作系统给定的端口，比如 1234 以接收结果。然后它通过“业务请求”调用服务器上的“调度”服务。该服务将请求拆分并发送到其他服务器（我们称之为它们`S1 ... Sn`），并将作业数量同步返回给客户端。

在我的测试中，有 13 个作业被分派到多个服务器，并且在 2 秒内，所有服务器都完成了它们的作业并尝试将结果发送回`W`'s 套接字。

我可以在日志中看到收到了 9 个作业`W`（这个数字因测试而异）。所以，我试着寻找剩下的 4 个工作。如果我`netstat`在这个 Windows 盒子上做一个，我看到 4 个套接字是打开的：

```
TCP    W:4373       S5:48197  ESTABLISHED
TCP    W:4373       S5:48198  ESTABLISHED
TCP    W:4373       S6:57642  ESTABLISHED
TCP    W:4373       S7:48295  ESTABLISHED 
```

如果我`W`执行`java.net.SocketInputStream.socketRead0(Native Method)`.

如果我在每个`S`框上执行 a `netstat`，我会看到一些字节仍在发送队列中。此字节数在 15 分钟内不会移动。（以下是`netstat`s在不同机器上的聚合）：

```
Proto Recv-Q Send-Q Local Address               Foreign Addr   State
tcp        0   6385 S1:48197                          W:4373   ESTABLISHED
tcp        0   6005 S1:48198                          W:4373   ESTABLISHED
tcp        0   6868 S6:57642                          W:4373   ESTABLISHED
tcp        0   6787 S7:48295                          W:4373   ESTABLISHED 
```

如果我对服务器进行线程转储，我会看到线程也卡在 `java.net.SocketInputStream.socketRead0(Native Method)`. 我期待一个写，但也许他们正在等待一个ACK？（这里不确定；它会在 Java 中显示吗？不应该由 TCP 协议直接处理吗？）

现在，非常奇怪的是：15 分钟后（而且总是 15 分钟），收到结果，关闭套接字，一切都照常进行。

这以前总是有效的。`S`服务器移动到不同的数据中心，因此不再`W`位于`S`同一个数据中心。此外，`S`是在防火墙后面。所有端口都应该在`S`和之间获得授权`W`（我被告知）。谜团真的是15分钟的延迟。我认为这可能是针对 DDOS 的一些保护？

我不是网络专家，所以我寻求帮助，但没有人可以帮助我。我花了 30 分钟和一个人用 Wireshark（以前的 Ethereal）捕获数据包，但出于“安全原因”，我无法查看结果。他必须对此进行分析并回复我。我询问了防火墙日志；相同的故事。

我不是这些盒子的 root 或管理员，现在我不知道该怎么办......我不期待你们提供解决方案，但是关于如何进步的一些想法会很棒！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-02T17:35:52.043

如果它在您的本地网络中运行良好，那么我不认为这是一个编程问题（重新`flush()`评论）。

否则两台机器之间的网络连接是否正常？您可以通过（例如）FTP 毫无问题地传输类似数量的数据吗？您是否可以通过组合客户端/服务器脚本来复制此问题，以发送适当大小的数据块。即 W 和 S 之间的网络连接是否良好？

另一个问题。你现在有一个防火墙。这可能是以前不存在的瓶颈吗？（虽然不确定这将如何解释一致的 15m 延迟）。

最后一个问题。您设置的 TCP 配置参数是什么（在 W 和 S 上 - 我正在考虑操作系统级别的参数）。那里有什么可以建议或导致 15m 的数字。

不确定这是否有帮助。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-02T15:25:31.763

对。如果您使用的是 BufferedOutputStream ，则需要调用 flush() ，除非您达到最大缓冲区大小。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-03T04:27:33.910

除了尝试Brian说的，您还可以检查以下内容

1) 在任意一台服务器上运行 tcpdump，查看从启动作业到延迟后所有处理完成时的消息流顺序。这将告诉您哪一方导致延迟（W 或 S）。检查是否有任何重传、丢失的 ack 等。

2) W 和 S 之间是否发生了某种碎片化？

3) 字节卡住的服务器上的网络负载情况如何？负载过重会导致输出错误，导致socket队列没有被清空吗？（也可能存在 NIC 错误，其中在遇到某些错误条件后，NIC 缓冲区未刷新，或者无法恢复传输，并且这种情况正在被某种看门狗清除）

有关上述两个的更多信息肯定会有所帮助。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-03T22:20:49.557

您*确定*卡在读取调用中的线程与发送数据的线程相同吗？是否有可能实际涉及的线程被其他活动阻塞了，而您的堆栈转储显示了其他恰好正在执行套接字 i/o 的无辜线程？自从我使用 Java 以来已经有一段时间了，但我隐约记得 JVM 使用套接字进行 IPC。

我会检查所有接收方，看看其中一个是否是预期的接收方，而是在 15 分钟内做其他事情。

它在一个位置而不是另一个位置工作的事实通常表明应用程序计时错误，而不是数据中心问题。

# c# - 要列出的数据表 How do I take a DataTable and convert it to a List? I've included some code below in both C# and VB.NET, the issue with both of these is that we create a new object to return the data, which is very costly. I nee 问问题 问问题 2009-04-02T09:45:09.047 69321 次 This question shows research effort; it is useful and clear 7 This question does not show any research effort; it is unclear or not useful Bookmark this question. Show activity on this post. How do I take a DataTable and convert it to a List? I've included some code below in both C# and VB.NET, the issue with both of these is that we create a new object to return the data, which is very costly. I need to return a reference to the object. The DataSetNoteProcsTableAdapters.up_GetNoteRow object does implement the INote interface. I am using ADO.NET, along with .NET 3.5 c# code public static IList<INote> GetNotes() { DataSetNoteProcsTableAdapters.up_GetNoteTableAdapter adapter = new DataSetNoteProcsTableAdapters.up_GetNoteTableAdapter(); DataSetNoteProcs.up_GetNoteDataTable table = new DataSetNoteProcs.up_GetNoteDataTable(); IList<INote> notes = new List<INote>(); adapter.Connection = DataAccess.ConnectionSettings.Connection; adapter.Fill(table); foreach (DataSetNoteProcs.up_GetNoteRow t in table) { notes.Add((INote)t); } return notes; } VB.NET Code Public Shared Function GetNotes() As IList(Of INote) Dim adapter As New DataSetNoteProcsTableAdapters.up_GetNoteTableAdapter Dim table As New DataSetNoteProcs.up_GetNoteDataTable Dim notes As IList(Of INote) = New List(Of INote) adapter.Connection = DataAccess.ConnectionSettings.Connection adapter.Fill(table) For Each t As DataSetNoteProcs.up_GetNoteRow In table notes.Add(CType(t, INote)) Next Return notes End Function If the properties of the list match the field names in the datatable you should be able to create some kind of generic reflection routine. c#dataset 4 7 回答 7 This answer is useful 6 I have another approach that might be worth taking a look at. It's a helper method. Create a custom class file named CollectionHelper: public static IList<T> ConvertTo<T>(DataTable table) { if (table == null) return null; List<DataRow> rows = new List<DataRow>(); foreach (DataRow row in table.Rows) rows.Add(row); return ConvertTo<T>(rows); } Imagine you want to get a list of customers. Now you'll have the following caller: List<Customer> myList = (List<Customer>)CollectionHelper.ConvertTo<Customer>(table); The attributes you have in your DataTable must match your Customer class (fields like Name, Address, Telephone). I hope it helps! For who are willing to know why to use lists instead of DataTables: link text The full sample: http://lozanotek.com/blog/archive/2007/05/09/Converting_Custom_Collections_To_and_From_DataTable.aspx 于 2009-05-15T13:47:49.807 回答 This answer is useful 2 No, creating a list is not costly. Compared to creating the data table and fetching the data from the database, it's very cheap. You can make it even cheaper by creating the list after populating the table, so that you can set the initial capacity to the number of rows that you will put in it: IList<INote> notes = new List<INote>(table.Rows.Count); 于 2009-04-02T13:27:04.270 回答 This answer is useful 1 Why not pass the DataTable into to the function instead of instantiating it? That would simply contain a reference. That's way too simple an answer too be worthwhile to you I'm sure, but I don't see how it doesn't solve your problem. 于 2009-04-02T12:21:20.527 回答 This answer is useful 1 No sure if this is what your looking for but you could try something like this. public class Category { private int _Id; public int Id { get { return _Id; } set { _Id = value; } } private string _Name = null; public string Name { get { return _Name; } set { _Name = value; } } public Category() {} public static List<Category> GetCategories() { List<Category> currentCategories = new List<Category>(); DbCommand comm = GenericDataAccess.CreateTextCommand(); comm.CommandText = "SELECT Id, Name FROM Categories Order By Name"; DataTable table = GenericDataAccess.ExecuteSelectCommand(comm); foreach (DataRow row in table.Rows) { Category cat = new Category(); cat.Id = int.Parse(row["Id"].ToString()); cat.Name = row["Name"].ToString(); currentCategories.Add(cat); } return currentCategories; } } This is what I have done so hope this helps. Not sure if it is the right way to do it but it works for what we needed it for. 于 2009-04-02T13:37:47.053 回答 This answer is useful 0 Do you want to reference the rows of the table? In that case you should use the DataTable.Rows property. Try this: notes.AddRange(table.Rows); If the table rows implement INote then this should work. Alternatively you could do as you did above: foreach (INote note in table.Rows) { notes.Add(note) } 于 2009-04-02T10:31:02.617 回答 This answer is useful 0 This is one simple way to do it. Say you have a history of events to pull from the database and you've a class like this: public class EventHistRecord { public string EvtDate { get; set; } public string EvtType { get; set; } public string EvtUser { get; set; } public string EvtData { get; set; } } Then from database you pull event history records in a dataset: DataSet ds = SqlQueries.getDataSet("select * from EventHist", phoneNum); And then from the dataset in to a List of EventHistRecord: List<EventHistoryRecord> lstRecs = ds.Tables[0].AsEnumerable().Select( dr => new EventHistoryRecord { EvtDate= dr["EvtDate"].ToString(), EvtData = dr["EvtData"].ToString(), EvtType = dr["EvtType"].ToString(), EvtUser = dr["EvtUser"].ToString() }).ToList(); 于 2019-09-23T14:35:11.303 回答 This answer is useful -1 如果列表的属性与数据表中的字段名称匹配，您应该能够创建某种通用反射例程。 于 2009-04-02T10:03:11.420 回答 Related 1 java - 一些奇怪的 getString 错误 1 android - Android后台调用登录页面 2 java - 实例化引用新教员的 Employee 变量 1 c - 编写一个 C 函数来解析十六进制字符串并将其转换为十进制？ 1 php - 如何使用 PHP 制作一个自动重启的倒数计时器 1 jquery - jquery - 如何防止executeSql的延迟执行？ 0 javascript - Backbone 集合和 Backbone 模型事件 0 ruby-on-rails - Sidekiq 未在数据库中找到元素 1 symfony - Symfony FOSUser Bundle - 为密码更改设置 failure_path 1 github - github分支和合并 Reference php × 1429865 c/c++ × 756500 nginx × 49975 mongodb × 159057 mybatis × 3233 anaconda × 13410 pycharm × 14671 python × 1902243 vscode × 56040 docker × 110988 github × 49000 flask × 49129 ffmpeg × 24037 jmeter × 16910 matplotlib × 63493 bootstrap × 54641

> ID：709035
> 
> 赞同：7
> 
> 时间：
> 
> 标签：c#, dataset

How do I take a DataTable and convert it to a List?

I've included some code below in both C# and VB.NET, the issue with both of these is that we create a new object to return the data, which is very costly. I need to return a reference to the object.

The DataSetNoteProcsTableAdapters.up_GetNoteRow object does implement the INote interface.

I am using ADO.NET, along with .NET 3.5

c# code

```
public static IList<INote> GetNotes() 
{ 
    DataSetNoteProcsTableAdapters.up_GetNoteTableAdapter adapter =
        new DataSetNoteProcsTableAdapters.up_GetNoteTableAdapter(); 
    DataSetNoteProcs.up_GetNoteDataTable table =
        new DataSetNoteProcs.up_GetNoteDataTable(); 

    IList<INote> notes = new List<INote>(); 

    adapter.Connection = DataAccess.ConnectionSettings.Connection; 
    adapter.Fill(table); 

    foreach (DataSetNoteProcs.up_GetNoteRow t in table) { 
        notes.Add((INote)t); 
    } 

    return notes;
} 
```

VB.NET Code

```
Public Shared Function GetNotes() As IList(Of INote)
    Dim adapter As New DataSetNoteProcsTableAdapters.up_GetNoteTableAdapter
    Dim table As New DataSetNoteProcs.up_GetNoteDataTable

    Dim notes As IList(Of INote) = New List(Of INote)

    adapter.Connection = DataAccess.ConnectionSettings.Connection
    adapter.Fill(table)

    For Each t As DataSetNoteProcs.up_GetNoteRow In table
        notes.Add(CType(t, INote))
    Next

    Return notes
End Function 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-15T13:47:49.807

I have another approach that might be worth taking a look at. It's a helper method. Create a custom class file named CollectionHelper:

```
 public static IList<T> ConvertTo<T>(DataTable table)
    {
        if (table == null)
            return null;

        List<DataRow> rows = new List<DataRow>();

        foreach (DataRow row in table.Rows)
            rows.Add(row);

        return ConvertTo<T>(rows);
    } 
```

Imagine you want to get a list of customers. Now you'll have the following caller:

```
List<Customer> myList = (List<Customer>)CollectionHelper.ConvertTo<Customer>(table); 
```

The attributes you have in your DataTable must match your Customer class (fields like Name, Address, Telephone).

I hope it helps!

For who are willing to know why to use lists instead of DataTables: [link text](https://stackoverflow.com/questions/275269/does-a-datatable-consume-more-memory-than-a-listt)

The full sample:

[http://lozanotek.com/blog/archive/2007/05/09/Converting_Custom_Collections_To_and_From_DataTable.aspx](http://lozanotek.com/blog/archive/2007/05/09/Converting_Custom_Collections_To_and_From_DataTable.aspx)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-02T13:27:04.270

No, creating a list is not costly. Compared to creating the data table and fetching the data from the database, it's very cheap.

You can make it even cheaper by creating the list after populating the table, so that you can set the initial capacity to the number of rows that you will put in it:

```
IList<INote> notes = new List<INote>(table.Rows.Count); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-02T12:21:20.527

Why not pass the DataTable into to the function instead of instantiating it? That would simply contain a reference.

That's way too simple an answer too be worthwhile to you I'm sure, but I don't see how it doesn't solve your problem.

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-02T13:37:47.053

No sure if this is what your looking for but you could try something like this.

```
 public class Category
{
    private int _Id;
    public int Id
    {
        get { return _Id; }
        set { _Id = value; }
    }

    private string _Name = null;
    public string Name
    {
        get { return _Name; }
        set { _Name = value; }
    }

    public Category()
    {}

    public static List<Category> GetCategories()
    {
        List<Category> currentCategories = new List<Category>();

        DbCommand comm = GenericDataAccess.CreateTextCommand();
        comm.CommandText = "SELECT Id, Name FROM Categories Order By Name";
        DataTable table = GenericDataAccess.ExecuteSelectCommand(comm);

        foreach (DataRow row in table.Rows)
        {
            Category cat = new Category();
            cat.Id = int.Parse(row["Id"].ToString());
            cat.Name = row["Name"].ToString();
            currentCategories.Add(cat);
        }
        return currentCategories;
    }
} 
```

This is what I have done so hope this helps. Not sure if it is the right way to do it but it works for what we needed it for.

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-02T10:31:02.617

Do you want to reference the rows of the table? In that case you should use the DataTable.Rows property.

Try this:

```
notes.AddRange(table.Rows); 
```

If the table rows implement INote then this should work.

Alternatively you could do as you did above:

```
foreach (INote note in table.Rows)
{
  notes.Add(note)
} 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2019-09-23T14:35:11.303

This is one simple way to do it. Say you have a history of events to pull from the database and you've a class like this:

```
public class EventHistRecord
{
    public string EvtDate { get; set; }
    public string EvtType { get; set; }
    public string EvtUser { get; set; }
    public string EvtData { get; set; }
} 
```

Then from database you pull event history records in a dataset:

```
DataSet ds = SqlQueries.getDataSet("select * from EventHist", phoneNum); 
```

And then from the dataset in to a List of EventHistRecord:

```
 List<EventHistoryRecord> lstRecs = ds.Tables[0].AsEnumerable().Select(
dr => new EventHistoryRecord { EvtDate= dr["EvtDate"].ToString(),
                               EvtData = dr["EvtData"].ToString(),
                               EvtType = dr["EvtType"].ToString(),
                               EvtUser = dr["EvtUser"].ToString() 
                              }).ToList(); 
```

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2009-04-02T10:03:11.420

如果列表的属性与数据表中的字段名称匹配，您应该能够创建某种通用反射例程。

# java - 为什么像 Java 这样的语言使用分层包名，而 Python 没有？

> ID：709036
> 
> 赞同：15
> 
> 时间：2009-04-02T09:45:13.537
> 
> 标签：java, python, packages

我没有在 Java 中做过企业工作，但我经常看到[反向域名包命名约定](https://stackoverflow.com/questions/420945/java-package-name-convention-failure)。例如，对于 Stack Overflow Java 包，您可以将代码放在 package 之下`com.stackoverflow`。

我刚刚遇到了一个使用类似 Java 约定的 Python 包，我不确定支持和反对它的论点是什么，或者它们是否以与 Java 相同的方式适用于 Python。您更喜欢其中一个的原因是什么？**这些原因是否适用于所有语言？**

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2009-04-02T10:32:12.973

Python 不这样做是因为你最终会遇到一个问题——谁拥有几乎所有其他东西都是子包的“com”包？Python 建立包层次结构（通过文件系统层次结构）的方法根本不能很好地适应这种约定。Java 可以摆脱它，因为包层次结构是由提供给“包”语句的字符串文字的结构定义的，因此任何地方都不需要显式的“com”包。

还有一个问题是，如果您想公开发布一个软件包，但没有一个适合嵌入软件包名称的域名，或者您最终出于某种原因更改（或丢失）您的域名，该怎么办。（以后的更新需要不同的包名吗？你怎么知道 com.nifty_consultants.nifty_utility 是 com.joe_blow_software.nifty_utility 的更新版本？或者相反，你怎么知道它*不是*更新版本？如果你错过了你的域名更新，域名被域名营员抢走，别人从他们那里购买了域名，他们想公开发布软件包，他们是否应该使用你已经使用过的同一个名字？）

在我看来，域名和软件包名称解决了两个完全不同的问题，并且具有完全不同的复杂因素。我个人不喜欢 Java 的约定，因为（恕我直言）它违反了关注点分离。避免命名空间冲突是一件好事，但我讨厌我的软件的命名空间是由（并依赖于）营销部门与某些第三方官僚机构的交互定义的。

为了进一步澄清我的观点，回应 JeeBee 的评论：在 Python 中，包是一个包含`__init__.py`文件（并且可能是一个或多个模块文件）的目录。包层次结构要求每个更高级别的包都是完整的、合法的包。如果两个包（特别是来自不同供应商，但甚至来自同一供应商的不直接相关的包）共享一个顶级包名称，无论该名称是 'com' 或 'web' 还是 'utils' 或其他任何名称，每一个*必须*`__init__.py`为该顶级包提供一个。我们还必须假设这些包很可能安装在目录树中的相同位置，即site-packages/[pkg]/[subpkg]。文件系统因此强制只有*一个* `[pkg]/__init__.py`——那么谁赢了？这个问题没有（也不可能）一个一般情况下的正确答案。我们也不能合理地将这两个文件合并在一起。由于我们不知道另一个包可能需要在其中做什么，`__init__.py`因此不能假定共享顶级包的子包在安装两者时都可以工作，除非它们被专门编写为相互兼容（至少在这个文件中） ）。这将是一场分发噩梦，并且几乎会使嵌套包的整个点无效。这并不特定于反向域名包层次结构，尽管它们提供了最明显的坏例子并且（IMO）在哲学上是有问题的——这实际上是共享顶级包的实际问题，而不是哲学问题，即我主要关心这里。

（另一方面，使用子包更好地组织自身的单个大包是一个好主意，因为这些子包*是*专门设计用于一起工作和生活的。但这在 Python 中并不常见，因为单个概念包没有t 往往需要足够多的文件才能需要额外的组织层。）

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2009-04-02T20:05:02.310

如果 Guido 自己宣布应该遵循反向域约定，它不会被采用，除非`import`在 python 中的实现有重大变化。

考虑：python 在运行时使用快速失败算法搜索导入路径；java 在编译时和运行时都使用详尽的算法搜索路径。来吧，尝试像这样安排你的目录：

```
folder_on_path/
    com/
        __init__.py
        domain1/
            module.py
            __init__.py

other_folder_on_path/
    com/
        __init__.py
        domain2/
            module.py
            __init__.py 
```

然后尝试：

```
from com.domain1 import module
from com.domain2 import module 
```

这些语句中的一个将成功。为什么？因为在搜索路径上要么`folder_on_path`或要么更高。`other_folder_on_path`当 python 看到`from com.`它可以抓取第一个`com`包时。如果恰好包含`domain1`，那么第一个`import`将成功；如果没有，它会抛出一个`ImportError`并放弃。为什么？因为`import`必须在运行时发生，可能发生在代码流中的任何一点（尽管最常见于开始时）。没有人想要在这一点上进行详尽的树遍历来验证没有可能的匹配。它假设如果它找到一个名为 的包`com`，它就是*这个* `com`包。

此外，python 不区分以下语句：

```
from com import domain1
from com.domain1 import module
from com.domain1.module import variable 
```

验证的概念`com`在*每种* `com`情况下都会有所不同。在java中，你真的只需要处理第二种情况，这可以通过遍历文件系统来完成（我猜类和文件命名相同的好处）。在 python 中，如果您尝试仅在文件系统帮助的情况下完成导入，第一种情况可能（几乎）透明地相同（**init** .py 不会运行），第二种情况可以完成，但您会丢失初始运行module.py，但第三种情况是完全无法实现的。代码必须执行`variable`才能可用。这是另一个要点：`import`不仅仅是解析命名空间，它还执行代码。

现在，如果每个分发的 python 包都需要一个安装过程来搜索文件夹，然后是, 等等，那么你*可以*摆脱这个，但这使得打包变得相当困难，破坏了拖放功能，并使包装和全面滋扰。`com``domain`

* * *

## 回答 #3

> 赞同：12
> 
> 时间：2009-04-02T10:18:03.320

“你更喜欢其中一个的原因是什么？”

Python 的风格更简单。Java 的风格允许来自不同组织的同名产品。

“这些理由是否适用于所有语言？”

是的。您可以轻松地拥有名为“com”、“org”、“mil”、“net”、“edu”和“gov”的顶级 Python 包，并将您的包作为子包放入其中。

**编辑**. 当你这样做的时候你有一些复杂性，因为*每个人*都必须合作而不是用他们自己的垃圾污染这些顶级包。

Python 没有开始这样做是因为命名空间冲突——作为一个实际问题——被证明是相当罕见的。

Java 开始这样做是因为开发 Java 的人预见到很多人会毫无头绪地为他们的包选择相同的名称，并且需要解决冲突和所有权问题。

Java 人员没有预见到开源社区会选择奇怪的现成唯一名称来避免名称冲突。有趣的是，每个编写 xml 解析器的人都不称其为“解析器”。他们似乎称它为“撒克逊”或“Xalan”或完全奇怪的东西。

* * *

## 回答 #4

> 赞同：12
> 
> 时间：2009-04-02T20:24:06.087

在 Joel on Software 的某处，Joel 比较了两种公司发展方式：Ben & Jerry 的方法，从小规模开始有机地发展，以及亚马逊的方法，从一开始就筹集大量资金并提出非常广泛的要求.

当 Sun 推出 Java 时，它大张旗鼓，大肆宣传。Java应该接管。大多数未来相关的软件开发将在网络交付的 Java 小程序上进行。会有铜管乐队，甚至是小马。在这种情况下，明智的做法是预先建立一个基于互联网、对公司友好且在全球范围内的命名约定。

好吧，结果并不像 Sun 所希望的那样，但他们计划着，好像他们会成功一样。就我个人而言，我鄙视那些可能被成功破坏的项目。

Python 最初是 Guido van Rossum 的一个项目，社区在很长一段时间后才确信如果 van Rossum 被公共汽车撞到它会生存下来。据我所知，最初并没有接管世界的计划，而且它也不是一种网络小程序语言。

因此，在语言的形成阶段，没有理由为命名方案需要一个庞大的层次结构。在那个更非正式的社区中，一个人选择了一个或多或少异想天开的项目名称，并检查其他人是否已经在使用它。（在英国喜剧节目之后命名一种计算机语言可能会被认为是异想天开的开始。）人们认为没有必要迎合一个庞大但缺乏想象力和笨拙的命名方案。

* * *

## 回答 #5

> 赞同：11
> 
> 时间：2009-04-02T10:02:10.753

这是防止名称冲突的好方法，并充分利用现有的域名系统，因此不需要额外的官僚机构或注册。它简单而精彩。

通过反转域名，它还赋予了它一个层次结构，这很方便。所以你可以在最后有子包。

唯一的缺点是名称的长度，但对我来说这根本不是缺点。我认为对于任何支持它的语言来说，这都是一个不错的主意。

例如，为什么 JavaScript 库不这样做？它们的全局命名空间是一个大问题，但 Javascript 库使用简单的全局标识符，如“$”，这与其他 Javascript 库发生冲突。

* * *

## 回答 #6

> 赞同：6
> 
> 时间：2009-04-02T09:47:13.003

这个想法是保持名称空间无冲突。而不是不可读的 UUID 或类似的，反向域名不太可能妨碍别人。非常简单，但务实。此外，当使用 3rd 方库时，它可能会为您提供关于它们来自何处的线索（用于更新、支持等）

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-04-02T10:23:29.127

Python*确实*有它，它只是一个更扁平的层次结构。看`os.path`，例如。并且没有什么能阻止库设计者做出更深层次的设计，例如 Django。

从根本上说，我认为 Python 的设计理念是您希望完成工作而无需提前指定或输入太多内容。这极大地有助于脚本和命令行的使用。“The Zen of Python”中有几个部分解决了这个问题的基本原理：

*   简单胜于复杂。
*   平面优于嵌套。
*   美丽总比丑陋好。（Java 系统在我看来很难看。）

另一方面，有：

*   命名空间是一个很棒的想法——让我们做更多的事情！

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-04-02T10:04:05.537

Java 能够这样做，因为它是推荐的 Java 标准实践，并且几乎被 Java 社区普遍接受。Python 没有这个约定。

# performance - 在不使用 CDN 的情况下提高全球网站性能？

> ID：709038
> 
> 赞同：2
> 
> 时间：2009-04-02T09:46:13.160
> 
> 标签：performance, cdn, optimistic

CDN 似乎是一种在全球范围内提高网站性能的非常强力的方法，因为它们使用接近最终用户的数千台机器来确保良好的吞吐量。

与减少请求大小和数量的“常规”方法相比，是否有任何方法可以通过高延迟或慢速链接（例如，英国到澳大利亚）提高长距离性能，或者是让服务器更接近的唯一其他方法用户？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-02T09:50:58.737

您无法通过减小大小来规避延迟。只需确保您的服务器支持 Keepalive，应该缓存的所有内容实际上都带有适当的 Expires: 标头，并且您的 HTML 大小合理（即也使用 gzip 压缩） - 然后看看您能做到多远以及多宿主是否仍然存在必要的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-02T09:56:03.013

听起来很精神，我不确定 HTML 是否有效，但将可重用脚本的引用放在 HTML 的底部，就在`</body>`.

在测试中，我发现速度的主观印象大大提高，因为在下载和解析脚本时会显示 HTML 和图像。

向[ACM 致敬](http://cacm.acm.org/)。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-02T10:13:55.357

你可以打败物理定律。光速可能很快，但它仍然是有限的，因此距离和实际下载的内容数量以及它们的大小都很重要。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-02T09:51:39.420

让服务器靠近主干 IXP 会有所帮助。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-02T09:51:51.540

排除“通常”的方式，没有任何其他方式可以影响交通的表现，您将受制于您和目的地之间的因素。

一些团体开始使用 p2p 网络来分发大文件，Sky、BBC 等将其用于他们的下载服务，但老实说，让文件尽可能靠近最后一英里无疑是最好的解决方案。

# wpf - WPF 3D - 将 ModelVisual3D 适合相机的视野？

> ID：709039
> 
> 赞同：2
> 
> 时间：2009-04-02T09:46:16.233
> 
> 标签：wpf, 3d, modelvisual3d, perspectivecamera, fieldofview

我有一个长方体，它的尺寸是从 XML 导入的，所以我需要确保无论模型的大小如何，相机都能看到它的全部。这是出于预览目的。为了清楚起见，我可能会在顶部显示比例尺的标题。

我想我需要一些函数来告诉我 ModelVisual3D 是否适合`FieldOfView`相机的边界或 ViewPort3D 本身。

到目前为止，`DependencyProperty`当尺寸属性更改时，我有静态回调（尺寸属性为 s）定义如下。目前它非常粗糙，但你明白我正在寻找的想法。注释掉的部分大致显示了我正在寻找什么样的逻辑

```
 private static void OnCubeDimensionsChanged(DependencyObject d, DependencyPropertyChangedEventArgs e)
    {
        if (!valueSemaphore)
        {
            //while(mainModel.WillClip(mainCamera))
            //{
            //     mainCamera.FieldOfView--;
            //}

            valueSemaphore = true;
            double propertyValue = 0.0;
            Product3D p = d as Product3D;

            switch (e.Property.Name)
            {
                case "CubeHeight":
                    propertyValue = (double.Parse(e.NewValue.ToString()) / 100) * 8;
                    p.CubeHeight = propertyValue;
                    break;
                case "CubeWidth":
                    propertyValue = (double.Parse(e.NewValue.ToString()) / 100) * 5.3;
                    p.CubeWidth = propertyValue;
                    break;
                case "CubeDepth":
                    propertyValue = (double.Parse(e.NewValue.ToString()) / 100) * 2.6;
                    p.CubeDepth = propertyValue;
                    break;
            }
            valueSemaphore = false;
        }
    } 
```

如果有人知道注释掉的部分应该放在哪里，我将永远感激不尽。
提前致谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-03T18:01:16.967

您需要掌握的是立方体在视图平面上的 2D 投影范围。然后，您可以对最小和最大 X 和 Y 值进行简单检查，以查看整个立方体是否可见。

在范围内添加容差因子将处理任何舍入误差。

[我已经从这里](http://www.ericsink.com/wpf3d/A_AutoZoom.html)复制了看起来是相关的代码部分。然后，您可以相应地设置视口的大小。

```
public static Rect Get2DBoundingBox(ModelVisual3D mv3d)
{
    bool bOK;

    Matrix3D m = MathUtils.TryWorldToViewportTransform(vpv, out bOK);

    bool bFirst = true;    
    Rect r = new Rect();

    if (mv3d.Content is GeometryModel3D)
    {
        GeometryModel3D gm3d = (GeometryModel3D) mv3d.Content;

        if (gm3d.Geometry is MeshGeometry3D)
        {
            MeshGeometry3D mg3d = (MeshGeometry3D)gm3d.Geometry;

            foreach (Point3D p3d in mg3d.Positions)
            {
                Point3D pb = m.Transform(p3d);
                Point p2d = new Point(pb.X, pb.Y);
                if (bFirst)
                {
                    r = new Rect(p2d, new Size(1, 1));
                    bFirst = false;
                }
                else
                {
                    r.Union(p2d);
                }
            }
        }
    } 
```

# javascript - 如何为 Ajax 请求实现缓存

> ID：709046
> 
> 赞同：4
> 
> 时间：2009-04-02T09:48:50.520
> 
> 标签：javascript, ajax, caching, jquery

我有一个简单的应用程序，它显示了许多项目的列表，用户可以在其中显示由 Ajax 获得的每个项目的详细信息。

但是，如果用户关闭详细信息并再次打开，应用程序会发出另一个 Ajax 请求，以再次获取相同的内容。

有没有简单的解决方案如何通过在客户端缓存请求来防止这种情况，所以当用户再次显示相同的详细信息时，内容将从缓存中加载。最好使用**jQuery**。

我认为这可以通过代理对象来解决，它会在第一次发出请求时存储请求，当再次发出请求时，代理只会返回先前的结果而不发出另一个 Ajax 请求。

但我正在寻找一些更简单的解决方案，我不必自己实现所有这些。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-02T09:49:59.143

看看这些 jQuery 插件：

*   [http://plugins.jquery.com/project/cache](http://plugins.jquery.com/project/cache)
*   [http://plugins.jquery.com/project/Tache](http://plugins.jquery.com/project/Tache)
*   [http://plugins.jquery.com/project/jCache](http://plugins.jquery.com/project/jCache)

## jQache 示例：

```
// [OPTIONAL] Set the max cached item number, for example 20
$.jCache.maxSize = 20; 
// Start playing around with it:
// Put an item into cache:
$.jCache.setItem(theKey, theValue);
// Retrieve an item from cache:
var theValue = $.jCache.getItem(theKey);
// Clear the cache (well, I think most of us don't need this case):
$.jCache.clear(); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-02T09:58:22.057

恕我直言，最简单的方法是创建一个全局数组：

```
var desc_cache=[]; 
```

然后创建一个这样的函数：

```
function getDesc(item){
if(desc_cache[item]) return desc_cache[item] else $.ajax(...);
} 
```

获取 ajax 数据后将结果保存到 desc_cache。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2010-03-22T12:36:13.717

另一个 jQuery 缓存插件，您可以在其中设置对象的过期和依赖项：

[http://plugins.jquery.com/project/jCacher](http://plugins.jquery.com/project/jCacher)

**jCacher 示例代码：**

```
$(document).ready(function() {

    $.jCacher.add("key", "value");

});

$(document).ready(function() {

    var cacheItem = $.jCacher.get("key");
    alert(cacheItem.value + " was retrieved from the cache");

}); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2011-08-19T14:59:10.310

您可以创建一两个类来封装您正在缓存的事实；然后，您可以交替使用 AJAX 或缓存。见这里： http: [//myok12.wordpress.com/2011/08/19/building-an-almighty-data-retrieval-system-for-all-html5-webapps/](http://myok12.wordpress.com/2011/08/19/building-an-almighty-data-retrieval-system-for-all-html5-webapps/)

# c++ - C++：内联函数和链接时间代码生成

> ID：709047
> 
> 赞同：7
> 
> 时间：2009-04-02T09:49:05.480
> 
> 标签：c++, visual-studio, header, inline

直到不久前，我的代码库还非常接近`#include`地狱。每次我更改一个稍微重要的 .h 文件时，实际上所有文件都会重新编译。
如此高的标头依赖性的主要原因是我有许多需要内联的小函数，我的印象是内联工作它们需要与调用代码在同一个翻译单元中，所以它们需要是在标题中。对于内联函数，甚至编译其他头文件也需要包含在头文件中，ad infimum。

输入[链接时代码生成](http://msdn.microsoft.com/en-us/library/xbf3tbeh(VS.80).aspx)（在 Visual Studio 中）。这样做的主要优点之一是现在内联函数可以跨翻译单元。
但我还是很不确定。我怎样才能真正确定这些函数真的被内联了？我意识到无论我在哪里定义函数，编译器基本上都可以做它想做的任何事情。

有没有办法检查内联的内容？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-04-02T18:41:45.987

我知道在 C++ 中这样说是禁忌，但您可以将这些函数实现为预处理器宏。对不起，我现在去用肥皂洗嘴。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-02T09:53:01.337

当然，您并不真正关心事情是否内联 - 您只关心性能是否令人满意。但是，如果您真的想找出答案，请检查编译器生成的代码。您可以通过调试器使用汇编器视图窗口最轻松地完成此操作。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-04-02T09:54:36.713

你永远不能确定函数是内联的。由编译器来选择它。但是您可以通过允许编译器找到与函数关联的目标代码来使编译器更容易。

这就是链接时代码生成的用武之地。编译器不再生成目标代码，它们生成一种中间语言形式，而实际编译代码的是链接器。

要检查内联的内容，恐怕您只能生成汇编输出以及目标代码。这使您可以读取调用某个函数时产生的确切目标代码，并且很清楚那里是否存在“调用”。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-04-02T09:58:27.563

一种相对简单的方法是使用分析器。如果函数是内联的，您将不会在控制图中看到它。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-04-02T09:52:14.660

获得可执行文件后，您可以使用工具对其进行检查并在符号表中查找内联函数的名称。一个非常有用的工具是[Dependency Walker](http://www.dependencywalker.com/)。

这当然假设您可以获得一个构建，它结合了足够的优化设置，让编译器不必担心内联，同时保留符号。

对于 Visual Studio，我认为“发布”版本通常与这些版本相匹配，但我并不完全确定。

# ms-office - 如何从 Ribbon 控件获取 MS word 屏幕位置？

> ID：709050
> 
> 赞同：1
> 
> 时间：2009-04-02T09:49:56.053
> 
> 标签：ms-office, ribbon, add-in

我想获取单词位置，以便我可以在功能区控件的事件处理程序中相对于屏幕上的单词定位对话框

私人无效按钮1_Click（对象发送者，RibbonControlEventArgs e）

如何得到它？我的意思是没有位置或点属性告诉屏幕坐标。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-21T20:16:01.737

我遇到过同样的问题。不知道为什么，但 RibbonControl 类没有提供 Location 属性。

坐标可能位于 COM 对象中的某个位置，但我不是 Excel 专家。

还有人遇到这个吗？

# c# - C# 映射 php 参数

> ID：709058
> 
> 赞同：0
> 
> 时间：2009-04-02T09:51:41.027
> 
> 标签：c#, php, browser, params

我有一个包含 ?action=a¤t=b&something=c 的字符串我想创建一个我可以做的变量 val = mymap['current']; C# 中有什么东西可以解析这个吗？还是我需要使用 string.split 并编写自己的函数？

-edit- 感谢 REA_ANDREW 和 Guy Starbuck（来自另一个线程）解决。

```
using System.Web;
using System.Collections.Specialized;
//add System.Web reference to project
NameValueCollection q = HttpUtility.ParseQueryString(link.Substring(link.IndexOf("?")+1));
//value = q["key"] 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-02T09:56:22.437

这个问题显示了一个非常适合目的的方法：

[如何将查询字符串解析为 .NET 中的 NameValueCollection](https://stackoverflow.com/questions/68624/how-to-parse-a-query-string-into-a-namevaluecollection-in-net)

```
using System.Collections.Specialized; 
```

安德鲁

# backgroundworker - ThreadPool 何时将线程分配给 Backgroundworker 的实例？

> ID：709061
> 
> 赞同：1
> 
> 时间：2009-04-02T09:52:02.790
> 
> 标签：backgroundworker

如果我没记错的话，.NET 中的 Backgroundworker 将从 CLR ThreadPool 中获取一个线程，以执行后台任务。我想实例化一个 backgroundworker 对象的集合或列表。但是，并非集合中的所有对象都会同时被调用。所以让我担心的是，如果我有 10 个 backgroundworkers 对象的集合，CLR ThreadPool 将为我分配 10 个线程，如果我的集合中有太多对象，我认为它会用完 ThreadPool 中的线程。

所以这里我的问题是，ThreadPool 何时将线程分配给 BackgroundWorker 的实例？是在实例化对象时还是在调用方法 RunWorkerAsync() 时？

预先感谢您的所有帮助

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-06-11T17:17:27.333

作为对您问题的回答，BackgroundWorker 线程将由 RunWorkerAsync 中的 ThreadPool 分配。您可以研究下一个 BackgroundWorker 实现以了解更多它的机制。

[BackgroundWorker 实现 - 在 C# 中](http://weblogs.asp.net/rosherove/pages/BackgroundWorker.aspx)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-02T09:56:24.963

这是一个你不应该真正关心的实现细节。不要过早优化下界渗透。也就是说，不要创建不必要的`BackgroundWorker`s 实例，也不要发明复杂的优化逻辑，以便您能够重用它们。只需在需要时实例化它们。

# c# - 如何防止脏记录被更新

> ID：709064
> 
> 赞同：0
> 
> 时间：2009-04-02T09:52:25.377
> 
> 标签：c#, ado.net, enterprise-library

假设产品类

```
public class Product
{
    public String Name {get;set;}
    public Decimal Price {get;set;}
    public Int32 QuantityStock {get;set;}
} 
```

现在假设两个客户同时“请求”同一个产品，命名为“产品 1”，具有以下值

**名称 = “产品 1”**

**价格 = 10**

**数量库存 = 100**

第一个客户将 QuantityStock 增加到 110

然后第二个客户将 QuantityStock 减少到 90

所以我的这个产品缺少 10 个 QuantityStock，因为第二个客户端从原始值“100”更新了 quantityStock，而不是第一个客户端更新了“110”...

**原始值 = 100**

**第一个客户端更新 100 => 110**

**第二次客户端更新 100 => 90**

我怎样才能防止这种行为？

注意：我处于具有存储库模式和企业库的 3 层架构中。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-02T09:59:14.363

在我将记录提交到数据库之前，我会在记录上使用时间戳并确认记录的时间戳保持不变。如果时间戳已更改，即客户端 1 在客户端 2 读取数据后执行了提交操作，则采取适当的操作。

对于您表示的操作，我很想对其进行调整而不是绝对，因此它要么从系统中增加或减少库存。这样你就不用担心争吵了。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-02T09:56:01.127

我会从这个选项列表中选择第四个：http: [//davidhayden.com/blog/dave/archive/2005/10/05/2503.aspx](http://davidhayden.com/blog/dave/archive/2005/10/05/2503.aspx)

> 在更新期间检查时间戳 ( rowversion ) 的更改。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-02T09:59:43.427

看看这篇文章：

[SQL Server - 乐观并发数据库更新 - 悲观并发 - 高性能 ASP.NET 网站](http://davidhayden.com/blog/dave/archive/2005/10/05/2503.aspx)

还有这里（在文章末尾）：

[使用 .NET 2.0 与现有的基于 .NET 1.1 SOA 的 XML Web 服务一起开发下一代智能客户端](http://www.codeproject.com/KB/smart/SmartClientSOA.aspx)

### 样本：

```
var reader = SqlHelper.ExecuteReader(connectionString,
    "UpdateProduct", product.Name, product.Price, product.StockQuantity);    
if (reader.RecordsAffected > 0)
{
    RefreshEntity(reader, product);
    result = reader.RecordsAffected;
}
else
{
    //must always close the connection
    reader.Close();

    // Concurrency exception
    DBConcurrencyException conflict = 
       new DBConcurrencyException("Concurrency exception");
    conflict.ModifiedRecord = product;

    AssessmentCollection dsrecord;
    // Get record from Datasource
    if (transactionManager != null)
        dsrecord = ProductRepository.Current.GetByName(
        this.transactionManager, product.Name);
    else
        dsrecord = ProductRepository.Current.GetByName(connectionString, 
            product.Name);
    if (dsrecord.Count > 0)
        conflict.DatasourceRecord = dsrecord[0];

    throw conflict;
} 
```

# vim - 在 Vim 中跳转/定位光标

> ID：709066
> 
> 赞同：27
> 
> 时间：2009-04-02T09:53:08.417
> 
> 标签：vim

如何将光标移动到当前行的第 25 位？

* * *

## 回答 #1

> 赞同：71
> 
> 时间：2009-04-02T10:16:35.553

在普通模式下，使用管道字符：

```
25| 
```

会将您移至同一行的第 25 列

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2009-04-02T09:54:52.983

进入：

```
024l 
```

解释：

`0`: 将光标移动到当前行的第一个字符
`24l`: 将光标向右移动 24 次（从而到达第 25 列）

# image - 通过 DirectX 更快地显示大图像？

> ID：709070
> 
> 赞同：3
> 
> 时间：2009-04-02T09:53:59.913
> 
> 标签：image, user-interface, directx, zooming

作为工业视觉应用程序的开发人员，我经常有相当笨重的图像，比如 6000x4000Pixels 或更大。

虽然相机和图像处理正在处理稳定的新图像流（并且此处理是主要任务），但我希望允许用户舒适地并行查看其他图像。

在处理器（GDI 等）上执行此操作会窃取太多性能。例如，我们需要 0.2 秒来分析图像，但通过单次缩放（调整大小以适应某些控件）显示它需要 0.8 秒，更不用说让用户继续前进并深入了解它了。

由于 Photoshop 允许借助显卡的非常快的内存和处理来显示和缩放，我想知道是否有人可以给我一个想法，是否以及如何在我自己的代码中对此进行实验：将数据推送到显卡（可能需要多长时间这需要我的 76MB 的 rgb 数据吗？）并让它显示在一些控件中，而不用费力地放大并由用户移动到控件/卡以进行用户交互。

无需 3D 外观，只需在 2D-rgb 图像中移动和调整大小。目标是在低处理器负载的情况下实现快速舒适的观看。

==>这可能吗（作为纹理或类似的东西）？==> 当前的 >=256MB 的低端 3D 卡有限制吗？==> 有人可以建议一些预期的持续时间（复制数据，缩放）吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-02T11:20:33.450

您将受到最大纹理大小（因卡而异）的限制，因此您必须将大图像细分为几个较小的纹理。只要卡是 AGP 或 PCI-E，将实际纹理数据传输到您的视频内存应该非常快。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-02T10:03:20.467

什么是像素格式？您的尺寸数字似乎适用于 8 位 RGB，6000x4000 像素的单个图像应该需要大约 69 MB 的空间。所以它应该适合低端显卡的纹理内存，假设 Windows 和其他应用程序没有太多开销。当然，上传到显卡内存需要一段时间；但很难提供估计，因为它很可能会随着系统负载以及您的硬件/总线配置而变化。

我会更担心纹理大小的最大限制。我认为今天的高端显卡在纹理中的最大分辨率为 4096x4096 纹素，这意味着您无法将图像放入单个纹理中。

设置 DirectX 来测试这一点应该不会太难，周围有很多教程。[这](http://www.two-kings.de/tutorials/dxgraphics/dxgraphics05.html)是一个快速链接，展示了如何使用纹理进行渲染；查看同一教程系列的前面部分，了解如何初始化内容。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-07-20T02:38:31.253

您可以使用 Direct3D 做到这一点。它可以通过绘制带纹理的四边形轻松处理用于平移和缩放的大图像。

由于图像的大小和屏幕的大小（您没有 6Kx4K 显示器，是吗？），您需要创建一个系统来按需将大图像分页到纹理中。考虑到输入数据的大小，我认为您会发现将数据输入卡的速度的主要因素是磁盘和卡之间的 I/O 带宽。您可能会发现创建一种在磁盘上存储图像的方法是值得的，该方法利用二维空间相干性（即平铺存储布局，而不是扫描线存储布局）以及计算点采样的低分辨率版本。您可以使用未压缩的 RGB 自己完成所有这些操作，您不需要 JPEG2000 来执行此操作。一旦他们选择了图像，您就可以将此数据存储作为低优先级的后台进程。先得到什么'

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-02T11:00:25.120

我建议您使用专为此类任务设计的格式。它是[JPEG2000](http://www.jpeg.org/jpeg2000/)。您想要的[功能称为 ROI（感兴趣区域）和渐进式传输。](http://en.wikipedia.org/wiki/JPEG_2000#Features)如果您需要，它可以是无损的。

# c# - 使用 C# 在 Web 项目中处理异常的方法

> ID：709072
> 
> 赞同：8
> 
> 时间：2009-04-02T09:54:24.123
> 
> 标签：c#, exception-handling

处理 catch 语句中发生的异常的最佳方法是什么。目前我们正在将异常消息写入响应对象的 write 方法。但是我想要一个解决方案，通过该解决方案，用户只会收到一条一般错误消息，表明出现了问题，但我们必须获得有关错误的详细描述。我想知道 C# 中用于异常处理的不同做法。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-04-02T10:00:30.677

对于 Web 项目并防止任何异常被推送到浏览器，您可以启用健康监控以及使用自定义错误页面。如果您预计 catch 语句中可能会出现异常，只需在其中嵌套另一个 try catch 以便它优雅地倒下。

在 global.asax 中，您还可以订阅 Application_Error 事件，该事件将被调用以处理未处理的异常

安德鲁

ASP.NET 中的健康监控：[http ://www.4guysfromrolla.com/articles/031407-1.aspx](http://www.4guysfromrolla.com/articles/031407-1.aspx)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-04-02T10:10:50.793

对你想要解决这个问题有好处。将异常消息直接写回给用户可能会带来重大的安全风险——正如您已经发现的那样，异常消息可能包含大量信息，这些信息可以帮助恶意用户访问您的站点。

我会看看[ELMAH](http://msdn.microsoft.com/en-us/library/aa479332.aspx)（错误记录模块和处理程序）；这是一种将详细错误记录添加到 Web 应用程序的简单方法。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-02T10:00:26.090

我会将详细错误记录到我的数据库中，并将用户重定向到通用错误页面。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-02T10:00:22.207

写入事件日志是选项之一。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-04-02T13:33:21.947

正如 REA_ANDREW 所说，将健康监控与自定义错误页面一起使用。

他没有明确说的一件事是，您应该避免将 try/catch 块放在所有内容周围的编程风格。健康监控将记录未处理的异常，自定义错误页面将向用户显示您希望用户看到的有关错误的任何内容（如果有的话）。但这只有在您*没有*捕获异常时才会发生，因此请不要理会它们并让它们传播。

# .net - Cruise control.NET 忽略某些本地文件夹中的更改？

> ID：709074
> 
> 赞同：0
> 
> 时间：2009-04-02T09:54:40.567
> 
> 标签：.net, scripting

感谢您提供的大力帮助。事实上，我现在能够检测到本地文件夹本身的修改。但现在我面临另一个瓶颈。

当我的 Cruise control.NET 检测到我的源文件中的任何修改时，它开始构建并通过每 60 秒轮询一次进行检查。

现在构建文件的结果被填充到我的文件夹本身中，因此 Cruise control.NET 看到了修改并一次又一次地开始构建，它变成了一个链式过程。

那么无论如何我可以在巡航控制.NET上进行一些检查，只寻找一些文件夹的修改并过滤掉一些其他的东西。

例如：如果我正在寻找名为 build 的文件夹，它有 5 个文件夹，即 A、B、C、D、RESULTS。

我只需要注意文件夹 A、B、C 和 D 而不是 RESULTS 的修改，因为 RESULTS 文件夹包含我的构建过程的最终产品文件。

我希望我能够有效地沟通我的问题。

感谢和问候麦迪

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-02T10:46:16.293

Try the filtered source control block: [http://confluence.public.thoughtworks.org/display/CCNET/Filtered+Source+Control+Block](http://confluence.public.thoughtworks.org/display/CCNET/Filtered+Source+Control+Block)

# python - 如何区分迭代器和可迭代对象？

> ID：709084
> 
> 赞同：14
> 
> 时间：2009-04-02T09:56:55.833
> 
> 标签：python, iterator

在 Python 中，可迭代的接口是[迭代器接口](http://docs.python.org/library/stdtypes.html#iterator-types)的子集。这样做的好处是，在许多情况下，它们可以以相同的方式处理。但是，两者之间存在重要的语义差异，因为对于一个可`__iter__`迭代对象返回一个新的迭代器对象而不仅仅是`self`. 我如何测试一个可迭代对象真的是一个可迭代对象而不是一个迭代器？从概念上讲，我将可迭代对象理解为集合，而迭代器仅管理迭代（即跟踪位置），而不是集合本身。

例如，当一个人想要循环多次时，这种差异就很重要。如果给出了迭代器，那么第二个循环将不起作用，因为迭代器已经用完并直接 raise `StopIteration`。

测试一种方法很诱人`next`，但这似乎很危险并且在某种程度上是错误的。我应该检查第二个循环是否为空吗？

有没有办法以更 Pythonic 的方式进行这样的测试？我知道这听起来像是 LBYL 对抗 EAFP 的经典案例，所以也许我应该放弃？还是我错过了什么？

**编辑：** S.Lott 在下面的回答中说，这主要是想要在迭代器上进行多次传递的问题，并且首先不应该这样做。但是，在我的情况下，数据非常大，并且根据情况必须多次传递数据处理（绝对没有办法解决这个问题）。

iterable 也由用户提供，对于单次通过就足够的情况，它将与迭代器一起工作（例如，为简单起见由生成器创建）。但是如果用户在需要多次传递时只提供一个迭代器，那么防止这种情况会很好。

**编辑 2：** 实际上这是[Abstract Base Classes](http://www.python.org/dev/peps/pep-3119/#abcs-for-containers-and-iterators)的一个非常好的示例。`__iter__`迭代器和可迭代对象中的方法名称相同但语义不同！所以`hasattr`没用，但`isinstance`提供了一个干净的解决方案。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-04-02T10:11:29.310

```
'iterator' if obj is iter(obj) else 'iterable' 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-02T10:09:59.063

> 但是，两者之间存在重要的语义差异......

不是真正的语义或重要的。它们都是可迭代的——它们都使用 for 语句。

> 例如，当一个人想要循环多次时，这种差异就很重要。

这什么时候会出现？你必须更具体。在极少数情况下，当您需要对可迭代集合进行两次遍历时，通常会有更好的算法。

例如，假设您正在处理一个列表。您可以随心所欲地遍历列表。为什么你会纠结于迭代器而不是可迭代对象？好吧，那没用。

好的，这里有一个。您正在分两次读取文件，并且您需要知道如何重置可迭代对象。在这种情况下，它是一个文件，并且`seek`是必需的；或关闭并重新打开。感觉很恶心。您`readlines`可以获得一个列表，该列表允许两次通过而没有复杂性。所以这没有必要。

等等，如果我们有一个大到无法将其全部读入内存的文件怎么办？而且，由于不明原因，我们也无法寻求。然后怎样呢？

现在，我们要了解两次传球的细节。在第一关，我们积累了一些东西。索引或摘要之类的。索引包含文件的所有数据。总结通常是对数据的重组。通过从“摘要”到“重组”的微小变化，我们将文件的数据保留在新结构中。在这两种情况下，我们都不需要文件——我们可以使用索引或摘要。

所有“两遍”算法都可以更改为原始迭代器或可迭代的一遍，以及不同数据结构的第二遍。

这既不是 LYBL 也不是 EAFP。这就是算法设计。你不需要重置迭代器——YAGNI。

* * *

**编辑**

这是一个迭代器/可迭代问题的示例。这只是一个设计不佳的算法。

```
it = iter(xrange(3))
for i in it: print i,; #prints 1,2,3 
for i in it: print i,; #prints nothing 
```

这是微不足道的。

```
it = range(3)
for i in it: print i
for i in it: print i 
```

“并行多次”是微不足道的。编写一个*需要*可迭代的 API。当有人拒绝阅读 API 文档或在阅读后拒绝遵循它时，他们的东西就会坏掉。正如它应该。

“在需要多次传递时用户只提供一个迭代器的情况下很好的防范”都是疯狂的人编写破坏我们简单 API 的代码的例子。

如果有人足够疯狂地阅读大部分（但不是所有 API 文档）并在需要迭代时提供迭代器*，*您需要找到此人并教他们 (1) 如何阅读所有 API 文档和 (2)遵循 API 文档。

“保障”问题不太现实。这些疯狂的程序员非常罕见。在它确实出现的少数情况下，*你知道他们是谁*并且可以帮助他们。

* * *

**编辑 2**

“我们必须多次读取相同的结构”算法是一个基本问题。

不要这样做。

```
for element in someBigIterable:
    function1( element )
for element in someBigIterable:
    function2( element )
... 
```

改为这样做。

```
for element in someBigIterable:
    function1( element )
    function2( element )
    ... 
```

或者，考虑这样的事情。

```
for element in someBigIterable:
    for f in ( function1, function2, function3, ... ):
        f( element ) 
```

在大多数情况下，算法的这种“枢轴”会导致程序更容易优化，并且可能会带来性能的净改进。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-02T23:24:19.727

```
import itertools

def process(iterable):
    work_iter, backup_iter= itertools.tee(iterable)

    for item in work_iter:
        # bla bla
        if need_to_startover():
            for another_item in backup_iter: 
```

雷蒙德从吉多那里借来的那台该死的时光机……</p>

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-02T11:50:17.497

由于 Python 的鸭子类型，

任何对象都是可迭代的，如果它定义了`next()`and`__iter__()`方法返回自身。

如果对象本身没有`next()`方法，则`__iter__()`可以返回任何有`next()`方法的对象

您可以参考这个问题以查看[Python 中的 Iterability](https://stackoverflow.com/questions/649549/iterability-in-python)

# session - 安全 cookie 和混合 https/http 站点使用

> ID：709085
> 
> 赞同：52
> 
> 时间：2009-04-02T09:56:58.300
> 
> 标签：session, cookies, https, security

许多网站似乎支持 https，但不使用安全 cookie。我想让我的网站使用安全 cookie，但允许使用 http 访问某些内容。

一种明智的做法似乎是为真实会话设置一个安全 cookie，以及一个非安全 cookie，它只是表示用户是否登录的标志（在标题中显示不同的内容，如注销链接而不是登录链接）。此 cookie 不包含任何“真实”会话信息，只是为了使网站可以为登录用户显示的页面与网站 http 部分上未登录用户的页面略有不同。

将整个站点设置为 https 是另一种选择，但这似乎比普通的 http 慢很多，因此并不是很理想。

为什么网站不使用这种设置并拥有安全的 cookie？如今，cookie 被盗的可能性似乎使安全 cookie 成为必需品。有没有更好的方法来实现同样的目标？

* * *

## 回答 #1

> 赞同：31
> 
> 时间：2009-04-02T10:37:21.073

您提出的解决方案似乎可行，只要您不介意未经授权的人能够“就好像他们已登录”一样查看网站的非安全（http）部分 - 即只要网站的 http 部分不包含任何敏感信息，登录用户和未登录用户之间的唯一区别是标题中的内容无害。

它不经常使用的原因可能是以下之一：

*   这种情况可能并不常见。通常，如果您足够关心使网站的一部分安全，您会将登录会话限制在该安全部分，或者您会让整个网站始终使用 HTTPS（如 Paypal）。
*   现有的解决方案是安全的，并且功能不止于此，例如，在 HTTPS 登录表单中登录某人并在将其传输回 HTTP 时维护该会话。 ~~OpenID 就是一个例子。还可以考虑 flickr 或 gmail：他们的登录页面始终是 HTTPS，但是一旦会话开始，您就会迁移回 HTTP，同时安全地维护会话。~~

* * *

**更新**（2014 年 8 月）

自从我在 2009 年写这篇文章以来，为登录屏幕提供安全连接但在登录后返回 HTTP 的做法几乎消失了。

横向使用 HTTPS 的开销不再被视为大问题。由 Google 开创的新 SPDY 协议（现在演变为 HTTP/2）得到跨浏览器和主要 Web 服务器的支持，并提高了 HTTPS 速度。

最后，隐私被认为比以往任何时候都更加重要，即使是对于身份验证不重要的操作，例如写评论、上传照片等等。

谷歌最近甚至表示，仅使用 HTTPS 的网站将开始在搜索引擎排名中受益。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2009-04-02T10:35:39.830

从安全的角度来看，您永远不应信任通过非安全连接发送的任何内容。因此，考虑到这一点，只有在盗窃或滥用该 cookie 的成本大约为零时，才可以安全地使用通过未加密连接发送的 cookie。

考虑到这一点，大多数网站的设计都不允许数据在渠道之间“泄漏”。毕竟，来自**加密**端的数据通常具有特权，因此不应允许在正常通道中使用，而来自**未加密**通道的数据可能会受到欺骗，因此不应被信任。

如果您有不符合这些概括的数据，请随意处理。

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2011-10-30T18:35:22.343

通过 HTTP 传输会话 cookie 困扰了我一段时间。我认为您描述的技术是保护 cookie 的唯一合理方法，同时使登录用户可以像登录一样浏览 HTTP 页面。但是，我很少看到这种实现。

> **为什么网站不使用这种设置并拥有安全的 cookie？**

我认为缺乏采用的主要原因是[风险管理](http://www.digitalthreat.net/2009/06/threat-vs-vulnerability-vs-risk/)：

*   通过窃听窃取会话令牌比跨站点脚本（假设存在漏洞）要困难得多。您需要访问网络（例如用户的 LAN 或 ISP）。因此，根据基于风险的优先级，开发人员应该首先解决 XSS 问题，因为它提供了更大的攻击面（攻击的可能性更高）。
*   CSRF 和 UI 修正（又名点击劫持）也是如此。
*   如果会话被黑客攻击的业务影响很大（例如存储信用卡以供以后在网上商店使用），您最好将整个站点限制为 HTTPS。

另一个原因可能是可用性问题：使用您提出的方案，您可以有效地为单个用户管理两个并发会话。只要登录标志是存储在不安全会话中的唯一状态，这很容易。如果您还可以从两个会话中更改语言和国家/地区等设置，它可能会变得混乱（实施或使用）。

> **有没有更好的方法来实现同样的目标？**

来自[Web 应用程序黑客手册](http://mdsec.net/wahh/)：

> 如果使用 HTTP cookie 来传输令牌，则应将其标记为`secure`防止用户的浏览器通过 HTTP 传输它们。如果可行，应为应用程序的每个页面使用 HTTPS，包括帮助页面、图像等静态内容。

说真的，让整个网站都使用HTTPS。几年前，这可能不可行，主要是因为 CDN 不提供 HTTPS 支持。然而，今天主要是平衡开发和运营成本的问题。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2016-05-13T16:57:47.300

我完全知道推荐的做法是在整个站点上强制使用 SSL。但是，在某些特殊情况下，能够在 HTTP 和 HTTPS 之间进行选择可能会派上用场。

我遇到了与@Dsavid Gardner 类似的情况。我的公司使用第三方供应商来管理我们网站的商店部分，该商店位于子域“ [https://store.mysite.com](https://store.mysite.com) ”上。我们拥有价值 15 年的视频内容，当视频嵌入 SSL 时，我们当前的视频管理供应商会中断。（我猜它是从 HTTP 域中提取资源，但这是另一天的另一个问题）

当然，我可以购买 SSL 并通过调试两个第三方供应商的过程，以及对我们的整个数据库进行搜索和替换（或 .htaccess 文件破解，但我离题了）以更正任何 HTTP 资源链接，只是为了能够在标题中有一条消息说“欢迎'你的名字'”，但这似乎有点矫枉过正。

这是我想出的一个简单的 Javascript 解决方案，它根据已设置的安全 cookie 设置站点范围的不安全 cookie。

首先，[我抓取了一些 javascript cookie 函数](http://www.w3schools.com/js/js_cookies.asp "W3 Javascript Cookie")。继续将此代码放在您网站的安全部分：

```
function readCookie(name) {
    var nameEQ = name + "=";
    var ca = document.cookie.split(';');
    for(var i=0;i < ca.length;i++) {
        var c = ca[i];
        while (c.charAt(0)===' ') { 
            c = c.substring(1,c.length);
        }
        if (c.indexOf(nameEQ) === 0) {
            return c.substring(nameEQ.length,c.length);
        }
    }
    return null;
 }
 function setCookie(cname, cvalue, exdays) {
    var d = new Date();
    d.setTime(d.getTime() + (exdays*24*60*60*1000));
    var expires = "expires="+d.toUTCString();

    /* Note, the W3 documents where I got this code didn't include the
    option to set the domain. I added this and it allows the cookie 
    to be shared across sub-domains. Be sure not to add "www" */
    document.cookie = cname + "=" + cvalue + "; " + expires + "; domain=.yourdomain.com";
 }
 /*Now we check our cookies on our secure server to find out if the user is
 logged in or not. In my case, the First Name is stored as a cookie. */
 var firstNameCookie = readCookie("the-secure-cookie-name");
 //
 if(!firstNameCookie){
    /* If the cookie doesn't exist, then the person isn't logged in. Add 
    conditional logic here if you'd like (such as deleting any current 
    logged in cookies from the HTTP portion of the site) */
 }
 else {
    /* otherwise, we have a successful login. By grabbing the cookie via 
    this javascript resting on the secure server, we haven't compromised our 
    security. However, if we set a cookie with javascript right now, it 
    won't be a secure cookie by default and we'll have access to it with 
    HTTP on the subdomain */
    setCookie("HTTPfirstName", firstNameCookie, 1.5);
 }

 */The clients first name is now accessible across subdomains in the cookie
  entitled "HTTPfirstName" */ 
```

在这种情况下，我们唯一泄露给 HTTP 服务器的是客户端的名字。但是，如果您想要更高的安全性，您可以将服务器设置设置为仅允许 HTTP 请求访问某些 cookie（即“firstNameCookie”），这会增加额外的保护层。[您可以学习如何做到这一点这里](https://www.tunetheweb.com/security/http-security-headers/secure-cookies/)

当然，这不是最理想的解决方案。将来，我计划在站点范围内实施 SSL，但同时拥有一个简单的 javascript 函数来替换它肯定很好。

# c# - 从程序集中加载 ResourceDictionary

> ID：709087
> 
> 赞同：16
> 
> 时间：2009-04-02T09:58:01.933
> 
> 标签：c#, wpf, xaml, resourcedictionary

我在文件系统的某个地方有一个程序集，例如“C:\temp\test.dll”。在该程序集中有一个 ResourceDictionary，例如“abc.xaml”。

我怎样才能得到那个 ResourceDictionary？也许有一种使用反射的方法？到目前为止我还没有找到解决方案。

提前致谢！

编辑：只是想补充一点，我想访问字典中的资源，例如样式。

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2009-05-28T07:30:32.203

您实际上需要像这样编写 Uri：

```
Assembly.LoadFrom(@"C:\temp\test.dll");
ResourceDictionary rd = new ResourceDictionary();
rd.Source = new Uri(@"pack://application:,,,/test;component/myresource.xaml"); 
```

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2009-04-03T07:56:16.797

**编辑：**我找到了一个更好的解决方案，它适用于 ResourceDictionaries：

```
Assembly.LoadFrom(@"C:\temp\test.dll");
ResourceDictionary rd = new ResourceDictionary();
rd.Source = new Uri("/test;component/myresource.xaml"); 
```

* * *

好吧，我无法让它与 ResourceDictionaries 一起使用，所以我改用了旧的资源文件；）对于任何感兴趣的人，我是这样做的：

```
Assembly a = Assembly.LoadFile(@"C:\temp\test.dll");
ResourceManager rm = new ResourceManager("NameOfResource", a);
object o = rm.GetObject("xyz"); 
```

正如 Ian 所建议的，您可以使用 Reflector 获得“NameOfResource”。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-02T10:16:45.087

拿一份[Reflector](http://www.red-gate.com/products/reflector/)的副本（Lutz 已经把它交给了）。使用它来查看其中资源的程序集和名称空间等。

然后像这样读入嵌入式资源；

```
Assembly asm = System.Reflection.Assembly.GetExecutingAssembly();
using (System.IO.Stream s = asm.GetManifestResourceStream(<yourname>)
{
    using (System.IO.StreamReader reader = new System.IO.StreamReader(s))
    {
        string xml = reader.ReadToEnd();
    }
} 
```

# php - Xampp 中的无限 PHP 外观

> ID：709092
> 
> 赞同：0
> 
> 时间：2009-04-02T09:59:16.407
> 
> 标签：php

如果我做一个无限循环或一个如此大的循环需要几天时间，如果我重新启动 xampp，这个过程会停止吗？我编写了一些向谷歌发出请求的代码，我和网络上的其他人开始获取搜索验证码。我停止了 xampp，它似乎停止了，但是当我重新启动 xampp 时，它又开始发生了。

这很难说，但似乎是一致的。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-02T10:12:41.227

不，该过程不会从它离开的地方开始。除非您明确告诉它从停止的地方开始，否则它将重新开始。

即这个 php scruot 完成了将数字加一的完全没有意义的任务：

```
$i = $_GET['i'];
while(true)
  print $i++; 
```

如果您在停止服务器时记下最后一个数字，然后使用正确的 $_GET['i'] 重新启动脚本，它将从它离开的地方开始，但这只是因为您这样做了。重启时不保存脚本状态。

**编辑**
您还可以将当前状态保存到文件系统或数据库中，这样您就不必手动输入了。

**编辑 2**
哦，所以你不想阻止进展。如果重新启动 XAMP 并没有停止它，那么您将不得不提供更多关于正在发生的事情的信息，因为重新启动 XAMP 应该会停止所有 PHP 脚本的执行。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-02T10:02:15.947

由于 PHP 是 Web 服务器的子进程（在 XAMPP 的情况下），一旦 Web 服务器被关闭，它就会停止。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-02T10:06:22.647

但是，您很少需要在 Web 请求之后运行很长的进程。您可以使用 PHP 的命令行 Iterface (php myfile.php) 来运行这类脚本。

# c - 使用 win32 api 检索操纵杆名称

> ID：709094
> 
> 赞同：1
> 
> 时间：2009-04-02T09:59:49.557
> 
> 标签：c, winapi, windows-vista

我插入了一个操纵杆。它有一个名称字符串“我的 50cent 操纵杆”，如果我在 Vista 上的控制面板下转到游戏控制器，就会显示该字符串。我想以编程方式检索此字符串。经过一番研究，我发现joyGetDevCaps可以检索除名称字符串之外的大量信息。在 szPname 下，我得到“Microsoft Pc Joystick driver”和一些信息。在 szOEMVxD 数组下，我得到看起来像被随机字符包围的“pc 操纵杆驱动程序”。如何获得显示在控制面板下的名称？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-02T19:16:00.150

唔...

也许尝试[枚举](http://msdn.microsoft.com/en-us/library/bb206128(VS.85).aspx)系统上的操纵杆。传递给回调函数的[DIDEVICEINSTANCE](http://msdn.microsoft.com/en-us/library/bb219639(VS.85).aspx)可能在其 tszInstanceName 或 tszProductName 字段中包含您要查找的字符串。

# sql - 如何编写sql查询？对于 ms sql 服务器

> ID：709098
> 
> 赞同：0
> 
> 时间：2009-04-02T10:00:37.743
> 
> 标签：sql, sql-server

我需要编写一个 sql 查询，将一个数据库 (DB1) 中的一列添加到另一列，并将总和保存在第二个数据库 (DB2) 的该列中。userIds 相同的地方

```
DB1
TableA
UserId People

DB2
TableB
Amount UserId 
```

会是这样的

DB2.TableB.Amount = DB2.TableB.Amount + DB1.TableA.People

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-02T10:11:10.683

你的意思是：

```
UPDATE b
SET    Amount = b.Amount + a.People
FROM DB2.dbo.TableB b
INNER JOIN DB1.dbo.TableA a
  ON  a.UserId = b.UserId 
```

dbo = 表的所有者，也可以不指定：DB1..TableA

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-02T10:05:50.773

```
INSERT INTO DB2.dbo.TableB
SELECT COUNT(*), UserID
FROM DB1.dbo.TableA
GROUP BY UserID 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-02T10:08:26.103

这是未经测试的：

```
INSERT INTO DB2.dbo.TableB
SELECT SUM(DB2.TableB.Amount + DB1.TableA.People), UserID
FROM DB1.dbo.TableA
GROUP BY UserID 
```

# flash - ActionScript 2 事件的最佳实践 - 有没有模拟 ActionScript 3 样式事件的方法？

> ID：709107
> 
> 赞同：8
> 
> 时间：2009-04-02T10:05:08.763
> 
> 标签：flash, actionscript-3, actionscript-2

我喜欢 AS3 事件模型——它有助于保持我的代码干净和有损耦合。当我过去从事 AS2 项目时，我的代码不是那么整洁，并且类之间更加相互依赖。由于 AS2 对范围的奇怪处理，我从未真正了解过 AS2 事件系统。

由于我仍然偶尔需要在 AS2 中工作，所以我的问题是：

有没有人设法在 AS2 中模拟 AS3 事件 API，如果没有，监听和调度事件以及处理范围的最佳实践是什么？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-04-02T14:33:35.403

实际上，它很容易做到这一点。几节课应该能让你继续前进。第一个是一个`Event`类，如下：

```
class com.rokkan.events.Event
{

    public static var ACTIVATE:String = "activate";
    public static var ADDED:String = "added";
    public static var CANCEL:String = "cancel";
    public static var CHANGE:String = "change";
    public static var CLOSE:String = "close";
    public static var COMPLETE:String = "complete";
    public static var INIT:String = "init";

    // And any other string constants you'd like to use...

    public var target;
    public var type:String;

    function Event( $target, $type:String )
    {
        target = $target;
        type = $type;
    }

    public function toString():String
    {
        return "[Event target=" + target + " type=" + type + "]";
    }
} 
```

然后，我使用另外两个基类。一种用于常规对象，一种用于需要扩展的对象`MovieClip`。首先是非`MovieClip`版本...

```
import com.rokkan.events.Event;
import mx.events.EventDispatcher;

class com.rokkan.events.Dispatcher
{

    function Dispatcher()
    {
        EventDispatcher.initialize( this );
    }

    private function dispatchEvent( $event:Event ):Void { }
    public function addEventListener( $eventType:String, $handler:Function ):Void { }
    public function removeEventListener( $eventType:String, $handler:Function ):Void { }
} 
```

下一个`MovieClip`版本...

```
import com.rokkan.events.Event;
import mx.events.EventDispatcher;

class com.rokkan.events.DispatcherMC extends MovieClip
{

    function DispatcherMC()
    {
        EventDispatcher.initialize( this );
    }

    private function dispatchEvent( $event:Event ):Void { }
    public function addEventListener( $eventType:String, $handler:Function ):Void { }
    public function removeEventListener( $eventType:String, $handler:Function ):Void { }
} 
```

只需使用 Dispatcher 或 DispatcherMC 扩展您的对象，您就可以像 AS3 一样分派事件和侦听事件。只有几个怪癖。例如，当您调用时，`dispatchEvent()`您必须传入对调度事件的对象的引用，通常只是通过引用对象的`this`属性。

```
import com.rokkan.events.Dispatcher;
import com.rokkan.events.Event;

class ExampleDispatcher extends Dispatcher
{
    function ExampleDispatcher()
    {

    }

    // Call this function somewhere other than within the constructor.
    private function notifyInit():void
    {
            dispatchEvent( new Event( this, Event.INIT ) );
    }
} 
```

另一个怪癖是当您想监听该事件时。在 AS2 中您需要使用`Delegate.create()`来获得正确范围的事件处理函数。例如：

```
import com.rokkan.events.Event;
import mx.utils.Delegate;

class ExampleListener
{
    private var dispatcher:ExampleDispatcher;

    function ExampleDispatcher()
    {
        dispatcher = new ExampleDispatcher();
        dispatcher.addEventListener( Event.INIT, Delegate.create( this, onInit );
    }

    private function onInit( event:Event ):void
    {
        // Do stuff!
    }
} 
```

希望我从旧文件中正确复制并粘贴了所有这些内容！希望这对你有用。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-02T10:30:06.940

我想最好的做法是尽可能使用 EventDispatcher 类。您可以在此处阅读： [http ://help.adobe.com/en_US/AS2LCR/Flash_10.0/help.html?content=00002325.html](http://help.adobe.com/en_US/AS2LCR/Flash_10.0/help.html?content=00002325.html)

UI 组件也有非常类似于 AS3 的事件调度。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-11-12T08:17:06.143

我写了几个类来处理 AS2 中的事件。你可以在这里下载它们。

[http://dispatchevent.org/mims/as2-eventdispatcher/](http://dispatchevent.org/mims/as2-eventdispatcher/)

# php - 通过PHP获取厂商提供的硬盘序列号

> ID：709108
> 
> 赞同：5
> 
> 时间：2009-04-02T10:05:13.163
> 
> 标签：php, hard-drive, serial-number

通过PHP获取制造商提供的硬盘驱动器的序列号：如何完成？我想将它存储在一个文件中。

操作系统：Windows 2000、XP、ME、Vista...

***是的，我想要服务器***硬盘的序列号。

 *还是可以通过 Adob​​e AIR 完成？还是可以通过 Windows 上的 C 程序来完成？

```
C:\Documents and Settings\Administrator>dir
 Volume in drive C has no label.
 Volume Serial Number is BC16-5D5F 
```

这个数字：BC16-5d5f 是硬盘独有的吗？它与制造商给出的序列号有何不同？

```
wmic DISKDRIVE GET SerialNumber 
```

在我的 Vista 机器上仅显示以下文本：

> 序列号

在我的 XP 机器上，该命令无法识别。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-04-02T11:14:09.423

以下返回磁盘序列号。应该使用多个驱动器，您只会得到多个结果。只需使用[shell_exec](http://php.net/manual/en/function.shell-exec.php)运行它。

```
wmic DISKDRIVE GET SerialNumber 
```

wmic.exe 位于您的 windows system32 文件夹中。而且 wmic 确实存在于 WinXP 上，我自己在那里使用过。

我在 Vista 上的结果：

```
C:\Windows\System32>wmic DISKDRIVE GET SerialNumber
SerialNumber
20202020202054534241354c4*snip* 
```

我不知道是否所有硬盘都向操作系统提供序列号。

wmic 命令似乎只适用于 Windows XP、Windows Vista 和 Windows 7 的专业版。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-04-02T10:10:37.457

PHP 本身无法访问这样的硬件。

您将不得不

*   使用操作系统的命令并使用`system()`or调用它`exec()`
*   为 PHP 编写一个扩展，它将返回您的信息

如果您在 Linux 上并且拥有必要的权限和配置，您可以使用`$r = system("hdparm -I /dev/hda");`（将 hda 替换为您的 hd）来获取给定硬盘驱动器的序列号。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-02T10:08:31.063

```
hdparm -i /dev/sdX 
```

那是在linux上，但不确定在windows上。您可以通过“system()”执行它

看看[http://www.microsoft.com/communities/newsgroups/en-us/default.aspx?dg=microsoft.public.hk.msdn.connection&tid=e41f0af2-2e76-4be6-9b7b-636e79ac0491&cat=zh_HK_3b03d742- 993a-4f96-accd-1063c6bfd559&lang=zh&cr=HK&sloc=&p=1](http://www.microsoft.com/communities/newsgroups/en-us/default.aspx?dg=microsoft.public.hk.msdn.connection&tid=e41f0af2-2e76-4be6-9b7b-636e79ac0491&cat=zh_HK_3b03d742-993a-4f96-accd-1063c6bfd559&lang=zh&cr=HK&sloc=&p=1)

可能是前进的方向。

此外，当我在命令提示符下运行“dir”时，它显示：

```
C:\Documents and Settings\Administrator>dir
 Volume in drive C has no label.
 Volume Serial Number is BC16-5D5F 
```

那是你要找的吗？

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-02T10:09:28.333

我不能告诉你答案，但我想你必须看看扩展的方向（甚至可能自己写一个）。我怀疑这是 PHP 的核心。

编辑：我忘记了“exec”的原始力量：-/

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2017-10-07T21:09:32.543

[使用shell_exec](http://php.net/manual/en/function.shell-exec.php)运行以下命令（如果需要，在命令提示符下进行测试）：

```
wmic path win32_physicalmedia get Tag,SerialNumber 
```

DISKDRIVE 没有获得显示通过 IDE 通道插入的驱动器的实际序列号。以上似乎得到了我所有驱动器的实际序列号。标签还将返回您它是什么类型的驱动器，这可能有助于识别不同的驱动器。

示例输出：

```
SerialNumber     Tag
WD-WX55D33JQNZ4  \\.\PHYSICALDRIVE4
S1OKIJNH938475   \\.\PHYSICALDRIVE0
WD-CV44HJ5L765Y  \\.\PHYSICALDRIVE1
WD-WX41D65SD1UU  \\.\PHYSICALDRIVE2
WD-WXB1SD3OIJHG  \\.\PHYSICALDRIVE3
                 \\.\CDROM0 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2014-11-05T07:30:58.323

在基于 *nix 的机器上，您也可以使用`ls /dev/disk/by-id/`，因为`hdparm`需要 root 权限（请参阅[Patrick Daryll G.](https://stackoverflow.com/a/709128/881743)答案）。

```
<?php
exec($command.' 2>&1', $output);
echo 'HDD: '.$output[0].'<br>';

$outputs = explode('_', $outputs[0]);
$outputs = end($outputs);
echo 'HDD-SN: '.$output.'<br>'; 
```

你会得到这样的东西

```
HDD: ata-HGST_XXX1234567890XX_ABCD123456789X  // <connection>-<hdd_model>_<hdd_sn>
HDD-SN: ABCD123456789X  // Your HDD Serial Number 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-04-02T10:07:14.577

您想要来自服务器或客户端的硬盘驱动器吗？PHP 在服务器上运行，因此对我来说，直接从客户端获取它似乎是不可能的。

该手册建议您可以在服务器上执行命令：http: [//nl2.php.net/manual/en/ref.exec.php](http://nl2.php.net/manual/en/ref.exec.php)

不幸的是，我没有足够的 Unix 来为您提供硬盘序列号。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2014-06-09T11:44:53.263

试试这段代码，它工作正常。

```
<?php
   function GetVolumeLabel($drive) {
       // Try to grab the volume name
       if (preg_match('#Volume Serial Number is (.*)\n#i', shell_exec('dir '.$drive.':'), $m)) {
          $volname = ' ('.$m[1].')';
       } else {
           $volname = '';
       }
   return $volname;
}

$serial = str_replace("(","",str_replace(")","",GetVolumeLabel("c")));
echo $serial;

?> 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2012-12-10T12:16:42.060

您可以使用

```
 $hdserial =`wmic DISKDRIVE GET SerialNumber 2>&1` 
```

或者

```
 $hdserial =`wmic bios get serialnumber 2>&1` 
```

然后你可以回应它。

根据[Patrick Daryll Glandien](https://stackoverflow.com/a/709128/799845)的提示，您可以在基于 *nix 的机器上执行以下操作。$hdserial=`hdparm -I /dev/hda`

`hdparm -i /dev/sda`返回较少的信息。但由于 hdparm 需要 root 访问权限，它并没有为我运行 php。

'2>&1' 部分是从[这里的建议](http://php.net/manual/en/function.shell-exec.php#106250)中使用的。

# c++ - 注册变量

> ID：709114
> 
> 赞同：2
> 
> 时间：2009-04-02T10:07:18.103
> 
> 标签：c++, recursion

我有一个涉及大量递归的 C++ 代码。我正在考虑为我的变量使用寄存器类。您是否认为这样做可以节省堆栈内存并提高性能

谢谢

萨米尔

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-04-02T10:31:44.707

我敢打赌编译器不会满足您的要求。假设您有一个局部变量，并且您递归调用该函数 100 次。如果要尊重所有自动变量“注册”关键字，则仅针对该变量将需要 100 个硬件寄存器（所有变量在第 100 次调用时仍处于活动状态）

性能是一个难题。分析程序真正花费时间的地方并尝试在那里进行优化，但要小心：有些决策可能以无收益而告终，有些可能以更差的性能告终。正如之前提到的，编译器非常擅长他们所做的事情。强制一个变量到一个寄存器意味着少一个寄存器供其余变量使用。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-04-02T10:09:30.627

不，我认为它可能根本没有效果。现代编译器在调度寄存器使用方面通常比人类好得多，并且可能会忽略“寄存器”关键字。

话虽如此，唯一真正找出答案的方法是编写一些代码并使用 register 关键字测量其性能，而没有它 - 代码更改是微不足道的。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-02T10:10:26.940

您可以将算法更改为仅使用`std::stack`一些自定义类，该类将包含算法的状态，而不是函数堆栈和递归调用。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-02T10:13:13.503

如果我没记错的话， register 关键字并不能保证变量将存储在寄存器中，但表明它可以并且如果可能的话应该使用寄存器但是，如果寄存器不可用，那么它仍然会在堆栈中结束.

Microsoft C++ 忽略关键字并自行决定。我会首先查看您的算法以获得性能提升。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-02T10:14:10.287

编译器 100% 可以满足您的`register`要求。当然，如果您设法将一个或两个局部变量压缩到寄存器中，您可能会节省堆栈空间，但（当然）如果这些值需要在调用之间保留，那么它们将需要再次放入堆栈中。

# tsql - 在数据库内任何表的任何列中搜索一个值

> ID：709120
> 
> 赞同：100
> 
> 时间：2009-04-02T10:09:16.087
> 
> 标签：tsql

`char(64)`有没有办法在一个 MS SQL Server 数据库内的任何表的任何列中搜索一个值（在我的情况下它是类型的 UID ）？

我坐在一个巨大的数据库前，不知道如何将表链接在一起。为了找出这一点，我想列出所有表以及在任何行中包含特定值的列。那可能吗？

*一种方法可能是将整个数据库转储到一个文本文件中，然后使用任何文本编辑器来搜索该值 - 但如果数据库太大，这将是纯粹的痛苦。*

* * *

## 回答 #1

> 赞同：123
> 
> 时间：2009-04-02T10:13:05.390

> 如何在数据库中所有表的所有列中搜索关键字？

[http://vyaskn.tripod.com/search_all_columns_in_all_tables.htm](http://vyaskn.tripod.com/search_all_columns_in_all_tables.htm)

**编辑：**这是实际的 T-SQL，以防链接失效：

```
CREATE PROC SearchAllTables
(
@SearchStr nvarchar(100)
)
AS
BEGIN

-- Copyright © 2002 Narayana Vyas Kondreddi. All rights reserved.
-- Purpose: To search all columns of all tables for a given search string
-- Written by: Narayana Vyas Kondreddi
-- Site: http://vyaskn.tripod.com
-- Tested on: SQL Server 7.0 and SQL Server 2000
-- Date modified: 28th July 2002 22:50 GMT

CREATE TABLE #Results (ColumnName nvarchar(370), ColumnValue nvarchar(3630))

SET NOCOUNT ON

DECLARE @TableName nvarchar(256), @ColumnName nvarchar(128), @SearchStr2 nvarchar(110)
SET  @TableName = ''
SET @SearchStr2 = QUOTENAME('%' + @SearchStr + '%','''')

WHILE @TableName IS NOT NULL
BEGIN
    SET @ColumnName = ''
    SET @TableName = 
    (
        SELECT MIN(QUOTENAME(TABLE_SCHEMA) + '.' + QUOTENAME(TABLE_NAME))
        FROM    INFORMATION_SCHEMA.TABLES
        WHERE       TABLE_TYPE = 'BASE TABLE'
            AND QUOTENAME(TABLE_SCHEMA) + '.' + QUOTENAME(TABLE_NAME) > @TableName
            AND OBJECTPROPERTY(
                    OBJECT_ID(
                        QUOTENAME(TABLE_SCHEMA) + '.' + QUOTENAME(TABLE_NAME)
                         ), 'IsMSShipped'
                           ) = 0
    )

    WHILE (@TableName IS NOT NULL) AND (@ColumnName IS NOT NULL)
    BEGIN
        SET @ColumnName =
        (
            SELECT MIN(QUOTENAME(COLUMN_NAME))
            FROM    INFORMATION_SCHEMA.COLUMNS
            WHERE       TABLE_SCHEMA    = PARSENAME(@TableName, 2)
                AND TABLE_NAME  = PARSENAME(@TableName, 1)
                AND DATA_TYPE IN ('char', 'varchar', 'nchar', 'nvarchar')
                AND QUOTENAME(COLUMN_NAME) > @ColumnName
        )

        IF @ColumnName IS NOT NULL
        BEGIN
            INSERT INTO #Results
            EXEC
            (
                'SELECT ''' + @TableName + '.' + @ColumnName + ''', LEFT(' + @ColumnName + ', 3630) 
                FROM ' + @TableName + ' (NOLOCK) ' +
                ' WHERE ' + @ColumnName + ' LIKE ' + @SearchStr2
            )
        END
    END 
END

SELECT ColumnName, ColumnValue FROM #Results
 END 
```

* * *

## 回答 #2

> 赞同：17
> 
> 时间：2013-09-12T12:00:06.450

下面提到的所有第三方工具都是 100% 免费的。

我使用[ApexSQL Search](http://www.apexsql.com/sql_tools_search.aspx)在表中搜索对象和数据方面取得了巨大成功。它具有其他几个功能，例如关系图等……

我在大型（40GB TFS 数据库）数据库上有点慢……

![在此处输入图像描述](https://i.stack.imgur.com/h6XUb.png)

除此之外，还有[SSMS 工具包](http://www.ssmstoolspack.com/)，它提供了许多非常有用的其他功能，即使这些功能与搜索文本没有直接关系。

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2012-10-19T10:52:35.323

我扩展了代码，因为它没有告诉我' `record number`'，我必须重新找到它。

```
CREATE PROC SearchAllTables
(
@SearchStr nvarchar(100)
)
AS
BEGIN

-- Copyright © 2002 Narayana Vyas Kondreddi. All rights reserved.
-- Purpose: To search all columns of all tables for a given search string
-- Written by: Narayana Vyas Kondreddi
-- Site: http://vyaskn.tripod.com
-- Tested on: SQL Server 7.0 and SQL Server 2000
-- Date modified: 28th July 2002 22:50 GMT

-- Copyright @ 2012 Gyula Kulifai. All rights reserved.
-- Extended By: Gyula Kulifai
-- Purpose: To put key values, to exactly determine the position of search
-- Resources: Anatoly Lubarsky
-- Date extension: 19th October 2012 12:24 GMT
-- Tested on: SQL Server 10.0.5500 (SQL Server 2008 SP3)

CREATE TABLE #Results (TableName nvarchar(370), KeyValues nvarchar(3630), ColumnName nvarchar(370), ColumnValue nvarchar(3630))

SET NOCOUNT ON

DECLARE @TableName nvarchar(256), @ColumnName nvarchar(128), @SearchStr2 nvarchar(110)
    ,@TableShortName nvarchar(256)
    ,@TableKeys nvarchar(512)
    ,@SQL nvarchar(3830)

SET  @TableName = ''
SET @SearchStr2 = QUOTENAME('%' + @SearchStr + '%','''')

WHILE @TableName IS NOT NULL
BEGIN
    SET @ColumnName = ''

    -- Scan Tables
    SET @TableName = 
    (
        SELECT MIN(QUOTENAME(TABLE_SCHEMA) + '.' + QUOTENAME(TABLE_NAME))
        FROM    INFORMATION_SCHEMA.TABLES
        WHERE       TABLE_TYPE = 'BASE TABLE'
            AND QUOTENAME(TABLE_SCHEMA) + '.' + QUOTENAME(TABLE_NAME) > @TableName
            AND OBJECTPROPERTY(
                    OBJECT_ID(
                        QUOTENAME(TABLE_SCHEMA) + '.' + QUOTENAME(TABLE_NAME)
                         ), 'IsMSShipped'
                           ) = 0
    )
    Set @TableShortName=PARSENAME(@TableName, 1)
    -- print @TableName + ';' + @TableShortName +'!' -- *** DEBUG LINE ***

        -- LOOK Key Fields, Set Key Columns
        SET @TableKeys=''
        SELECT @TableKeys = @TableKeys + '''' + QUOTENAME([name]) + ': '' + CONVERT(nvarchar(250),' + [name] + ') + ''' + ',' + ''' + '
         FROM syscolumns 
         WHERE [id] IN (
            SELECT [id] 
             FROM sysobjects 
             WHERE [name] = @TableShortName)
           AND colid IN (
            SELECT SIK.colid 
             FROM sysindexkeys SIK 
             JOIN sysobjects SO ON 
                SIK.[id] = SO.[id]  
             WHERE 
                SIK.indid = 1
                AND SO.[name] = @TableShortName)
        If @TableKeys<>''
            SET @TableKeys=SUBSTRING(@TableKeys,1,Len(@TableKeys)-8)
        -- Print @TableName + ';' + @TableKeys + '!' -- *** DEBUG LINE ***

    -- Search in Columns
    WHILE (@TableName IS NOT NULL) AND (@ColumnName IS NOT NULL)
    BEGIN
        SET @ColumnName =
        (
            SELECT MIN(QUOTENAME(COLUMN_NAME))
            FROM    INFORMATION_SCHEMA.COLUMNS
            WHERE       TABLE_SCHEMA    = PARSENAME(@TableName, 2)
                AND TABLE_NAME  = PARSENAME(@TableName, 1)
                AND DATA_TYPE IN ('char', 'varchar', 'nchar', 'nvarchar')
                AND QUOTENAME(COLUMN_NAME) > @ColumnName
        ) -- Set ColumnName

        IF @ColumnName IS NOT NULL
        BEGIN
            SET @SQL='
                SELECT 
                    ''' + @TableName + '''
                    ,'+@TableKeys+'
                    ,''' + @ColumnName + '''
                ,LEFT(' + @ColumnName + ', 3630) 
                FROM ' + @TableName + ' (NOLOCK) ' +
                ' WHERE ' + @ColumnName + ' LIKE ' + @SearchStr2
            --Print @SQL -- *** DEBUG LINE ***
            INSERT INTO #Results
                Exec (@SQL)
        END -- IF ColumnName
    END -- While Table and Column
END --While Table

SELECT TableName, KeyValues, ColumnName, ColumnValue FROM #Results
END 
```

* * *

## 回答 #4

> 赞同：10
> 
> 时间：2014-08-18T23:47:01.560

资料来源： http: [//fullparam.wordpress.com/2012/09/07/fck-it-i-am-going-to-search-all-tables-all-collumns/](http://fullparam.wordpress.com/2012/09/07/fck-it-i-am-going-to-search-all-tables-all-collumns/)

不久前我有一个解决方案，我一直在改进。如果被告知，还会在 XML 列中搜索，或者如果提供仅整数字符串，则搜索整数值。

```
/* Reto Egeter, fullparam.wordpress.com */

DECLARE @SearchStrTableName nvarchar(255), @SearchStrColumnName nvarchar(255), @SearchStrColumnValue nvarchar(255), @SearchStrInXML bit, @FullRowResult bit, @FullRowResultRows int
SET @SearchStrColumnValue = '%searchthis%' /* use LIKE syntax */
SET @FullRowResult = 1
SET @FullRowResultRows = 3
SET @SearchStrTableName = NULL /* NULL for all tables, uses LIKE syntax */
SET @SearchStrColumnName = NULL /* NULL for all columns, uses LIKE syntax */
SET @SearchStrInXML = 0 /* Searching XML data may be slow */

IF OBJECT_ID('tempdb..#Results') IS NOT NULL DROP TABLE #Results
CREATE TABLE #Results (TableName nvarchar(128), ColumnName nvarchar(128), ColumnValue nvarchar(max),ColumnType nvarchar(20))

SET NOCOUNT ON

DECLARE @TableName nvarchar(256) = '',@ColumnName nvarchar(128),@ColumnType nvarchar(20), @QuotedSearchStrColumnValue nvarchar(110), @QuotedSearchStrColumnName nvarchar(110)
SET @QuotedSearchStrColumnValue = QUOTENAME(@SearchStrColumnValue,'''')
DECLARE @ColumnNameTable TABLE (COLUMN_NAME nvarchar(128),DATA_TYPE nvarchar(20))

WHILE @TableName IS NOT NULL
BEGIN
SET @TableName =
(
SELECT MIN(QUOTENAME(TABLE_SCHEMA) + '.' + QUOTENAME(TABLE_NAME))
FROM INFORMATION_SCHEMA.TABLES
WHERE TABLE_TYPE = 'BASE TABLE'
AND TABLE_NAME LIKE COALESCE(@SearchStrTableName,TABLE_NAME)
AND QUOTENAME(TABLE_SCHEMA) + '.' + QUOTENAME(TABLE_NAME) > @TableName
AND OBJECTPROPERTY(OBJECT_ID(QUOTENAME(TABLE_SCHEMA) + '.' + QUOTENAME(TABLE_NAME)), 'IsMSShipped') = 0
)
IF @TableName IS NOT NULL
BEGIN
DECLARE @sql VARCHAR(MAX)
SET @sql = 'SELECT QUOTENAME(COLUMN_NAME),DATA_TYPE
FROM INFORMATION_SCHEMA.COLUMNS
WHERE TABLE_SCHEMA = PARSENAME(''' + @TableName + ''', 2)
AND TABLE_NAME = PARSENAME(''' + @TableName + ''', 1)
AND DATA_TYPE IN (' + CASE WHEN ISNUMERIC(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(@SearchStrColumnValue,'%',''),'_',''),'[',''),']',''),'-','')) = 1 THEN '''tinyint'',''int'',''smallint'',''bigint'',''numeric'',''decimal'',''smallmoney'',''money'',' ELSE '' END + '''char'',''varchar'',''nchar'',''nvarchar'',''timestamp'',''uniqueidentifier''' + CASE @SearchStrInXML WHEN 1 THEN ',''xml''' ELSE '' END + ')
AND COLUMN_NAME LIKE COALESCE(' + CASE WHEN @SearchStrColumnName IS NULL THEN 'NULL' ELSE '''' + @SearchStrColumnName + '''' END + ',COLUMN_NAME)'
INSERT INTO @ColumnNameTable
EXEC (@sql)
WHILE EXISTS (SELECT TOP 1 COLUMN_NAME FROM @ColumnNameTable)
BEGIN
PRINT @ColumnName
SELECT TOP 1 @ColumnName = COLUMN_NAME,@ColumnType = DATA_TYPE FROM @ColumnNameTable
SET @sql = 'SELECT ''' + @TableName + ''',''' + @ColumnName + ''',' + CASE @ColumnType WHEN 'xml' THEN 'LEFT(CAST(' + @ColumnName + ' AS nvarchar(MAX)), 4096),'''
WHEN 'timestamp' THEN 'master.dbo.fn_varbintohexstr('+ @ColumnName + '),'''
ELSE 'LEFT(' + @ColumnName + ', 4096),''' END + @ColumnType + '''
FROM ' + @TableName + ' (NOLOCK) ' +
' WHERE ' + CASE @ColumnType WHEN 'xml' THEN 'CAST(' + @ColumnName + ' AS nvarchar(MAX))'
WHEN 'timestamp' THEN 'master.dbo.fn_varbintohexstr('+ @ColumnName + ')'
ELSE @ColumnName END + ' LIKE ' + @QuotedSearchStrColumnValue
INSERT INTO #Results
EXEC(@sql)
IF @@ROWCOUNT > 0 IF @FullRowResult = 1
BEGIN
SET @sql = 'SELECT TOP ' + CAST(@FullRowResultRows AS VARCHAR(3)) + ' ''' + @TableName + ''' AS [TableFound],''' + @ColumnName + ''' AS [ColumnFound],''FullRow>'' AS [FullRow>],*' +
' FROM ' + @TableName + ' (NOLOCK) ' +
' WHERE ' + CASE @ColumnType WHEN 'xml' THEN 'CAST(' + @ColumnName + ' AS nvarchar(MAX))'
WHEN 'timestamp' THEN 'master.dbo.fn_varbintohexstr('+ @ColumnName + ')'
ELSE @ColumnName END + ' LIKE ' + @QuotedSearchStrColumnValue
EXEC(@sql)
END
DELETE FROM @ColumnNameTable WHERE COLUMN_NAME = @ColumnName
END 
END
END
SET NOCOUNT OFF

SELECT TableName, ColumnName, ColumnValue, ColumnType, COUNT(*) AS Count FROM #Results
GROUP BY TableName, ColumnName, ColumnValue, ColumnType 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2015-06-04T13:56:22.470

[我在https://gallery.technet.microsoft.com/scriptcenter/c0c57332-8624-48c0-b4c3-5b31fe641c58](https://gallery.technet.microsoft.com/scriptcenter/c0c57332-8624-48c0-b4c3-5b31fe641c58)找到了一个相当强大的解决方案，我认为值得指出。它搜索以下类型的列：varchar、char、nvarchar、nchar、text。它工作得很好，支持特定的表格搜索以及多个搜索词。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-04-11T16:00:36.117

[http://www.reddyss.com/SQLDownloads.aspx](http://www.reddyss.com/SQLDownloads.aspx)上有一个不错的脚本

为了能够在任何数据库上使用它，您可以在以下位置创建它：http: [//nickstips.wordpress.com/2010/10/18/sql-making-a-stored-procedure-available-to-all-databases/](http://nickstips.wordpress.com/2010/10/18/sql-making-a-stored-procedure-available-to-all-databases/)

不确定是否有其他方法。

要使用它，请使用以下内容：

```
use name_of_database

EXEC spUtil_SearchText 'value_searched', 0, 0 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2016-08-31T22:33:35.703

在尝试[了@regeter 的解决方案](https://stackoverflow.com/a/25373716/3357935)并在我搜索外键/主键以查看它存在的所有表/列时发现它并没有解决我的问题后，它不起作用。在阅读了另一个尝试使用唯一标识符的人如何失败后，我进行了修改，这是更新后的结果：（适用于 int 和 guid...您将看到如何轻松扩展）

```
CREATE PROC [dbo].[SearchAllTables_Like]
(
        @SearchStr nvarchar(100)
)
AS
BEGIN

-- Copyright © 2002 Narayana Vyas Kondreddi. All rights reserved.
-- Purpose: To search all columns of all tables for a given search string
-- Written by: Narayana Vyas Kondreddi
-- Site: http://vyaskn.tripod.com
-- Tested on: SQL Server 7.0 and SQL Server 2000
-- Date modified: 28th July 2002 22:50 GMT

CREATE TABLE #Results (ColumnName nvarchar(370), ColumnValue nvarchar(3630))

SET NOCOUNT ON

DECLARE @TableName nvarchar(256), @ColumnName nvarchar(128), @SearchStr2 nvarchar(110)
SET  @TableName = ''
SET @SearchStr2 = QUOTENAME('%' + @SearchStr + '%','''')

WHILE @TableName IS NOT NULL
BEGIN
    SET @ColumnName = ''
    SET @TableName = 
    (
        SELECT MIN(QUOTENAME(TABLE_SCHEMA) + '.' + QUOTENAME(TABLE_NAME))
        FROM    INFORMATION_SCHEMA.TABLES
        WHERE       TABLE_TYPE = 'BASE TABLE'
            AND QUOTENAME(TABLE_SCHEMA) + '.' + QUOTENAME(TABLE_NAME) > @TableName
            AND OBJECTPROPERTY(
                    OBJECT_ID(
                        QUOTENAME(TABLE_SCHEMA) + '.' + QUOTENAME(TABLE_NAME)
                         ), 'IsMSShipped'
                           ) = 0
    )

    WHILE (@TableName IS NOT NULL) AND (@ColumnName IS NOT NULL)
    BEGIN

        SET @ColumnName =
        (
            SELECT MIN(QUOTENAME(COLUMN_NAME))
            FROM    INFORMATION_SCHEMA.COLUMNS
            WHERE       TABLE_SCHEMA    = PARSENAME(@TableName, 2)
                AND TABLE_NAME  = PARSENAME(@TableName, 1)
                AND DATA_TYPE IN ('guid', 'int', 'char', 'varchar', 'nchar', 'nvarchar')
                AND QUOTENAME(COLUMN_NAME) > @ColumnName
        )

        IF @ColumnName IS NOT NULL
        BEGIN
            INSERT INTO #Results
            EXEC
            (
                'SELECT ''' + @TableName + '.' + @ColumnName + ''', LEFT(' + @ColumnName + ', 3630) 
                FROM ' + @TableName + ' (NOLOCK) ' +
                ' WHERE ' + @ColumnName + ' LIKE ' + @SearchStr2
            )
        END
    END 
END

SELECT ColumnName, ColumnValue FROM #Results
END 
```

# eclipse - JBOSS 的库太多了！（m2eclipse 的问题）

> ID：709126
> 
> 赞同：2
> 
> 时间：2009-04-02T10:10:22.683
> 
> 标签：eclipse, maven-2, jboss, m2eclipse, eclipse-wtp

我承认这不是最好的标题，但如果没有三行标题，我不知道如何赞美它。

我有一个（例如）依赖 JTA 的项目，使用范围“提供”（JBOSS 带来了自己的 JTA 实现）。如果我使用 m2eclipse 它可以很好地解决所有依赖项。我的问题是，如果我将这个项目部署到 jboss（在 eclipse 中），那些提供的依赖项也会放在 war 文件中，但这是错误的。

任何想法如何解决这个问题？

**编辑：**

我猜它是以下错误：[https ://bugs.eclipse.org/bugs/show_bug.cgi?id=242476](https://bugs.eclipse.org/bugs/show_bug.cgi?id=242476)

但似乎，该修复程序只会包含在下一个 Eclipse 版本中

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-02T13:31:38.207

我将用我对上一个问题的回答来回答这个问题 - 基本上，为 jta 创建自己的 pom，然后自己排除或设置所有这些传递依赖项的提供范围。在您的项目中，将您的 jta 依赖项设置为您刚刚创建的 pom。

[这是我之前对（某种）类似问题的回答的文本。](https://stackoverflow.com/questions/547805/how-to-exclude-all-transitive-dependencies-of-a-maven-dependency/548077#548077)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-09-14T14:33:17.247

正如我在问题中提到的，它已在 Eclipse 3.5 中修复。

我测试了它，它终于可以工作了。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2009-04-02T10:46:54.780

在您的 pom.xml 中使用为 JTA 库提供的范围。当 pom 创建 war 文件时，它不会在 war 中包含那个 jta jar。

# .net - 自动部署 asp.net mvc 站点

> ID：709134
> 
> 赞同：4
> 
> 时间：2009-04-02T10:12:29.823
> 
> 标签：.net, asp.net-mvc, deployment

目前我在我的机器上构建我的网站，将它们部署到测试机器以查看它们是否仍然在那里工作，然后必须请求系统管理员将它们部署到 qa/生产服务器。
一次又一次，我应该感到自豪的时刻被一些被误解、遗忘或没有记录的部署程序扼杀了。
目前，系统管理员将文件从开发服务器复制到他认为合适的任何服务器，并尝试遵循我的 deploymentProcedures.txt。

有没有我可以使用的机制使这种过渡尽可能顺畅？我现在能想到的事情是

*   将连接字符串设置为生产数据库
*   将 CustomErrors 设置为 On
*   检查是否为流水账赋予了正确的 I/O 权限
*   确保所需的 COM 对象可用

可以使非程序员的人更容易部署的东西。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-04-02T10:18:15.830

您是否考虑过使用 Web 部署项目？

[http://weblogs.asp.net/scottgu/archive/2008/01/28/vs-2008-web-deployment-project-support-released.aspx](http://weblogs.asp.net/scottgu/archive/2008/01/28/vs-2008-web-deployment-project-support-released.aspx)

安德鲁

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-02T16:03:10.800

如果您的应用程序只是由您或您可以控制的团队创建的，那么您应该选择 CI（持续集成）。那里有许多免费产品，[Cruise Control .NET](http://cruisecontrol.sourceforge.net/)可能会对您有所帮助。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-11-18T08:17:03.660

您应该尝试以下解决方案：

FinalBuilder (www.finalbuilder.com) 通过共享文件夹进行构建管理和构建分发。

InstallAce (www.installace.com) 供开发团队打包构建内容，并供您/支持团队在 Web Farm 等上部署构建包内容。

您也可以尝试一些成本较低的工具来直接或通过 WIX 生成 MSI 包。[您可以在维基百科 ( http://en.wikipedia.org/wiki/Continuous_integration](http://en.wikipedia.org/wiki/Continuous_integration) ) 上获得所有优秀的自动安装软件列表，我参考了这些信息。

Cruise Control 是一个免费的解决方案，也被 .Net 社区广泛使用。

# sharepoint - MOSS 的 AssetUrlSelector 可以浏览列表中的子文件夹吗？

> ID：709143
> 
> 赞同：1
> 
> 时间：2009-04-02T10:14:47.727
> 
> 标签：sharepoint, moss, sharepoint-2007

每当我尝试使用 AssetUrlSelector 浏览 Microsoft Office SharePoint Server (MOSS) 中的子文件夹时，我都会收到“列表不存在”错误。

要重现此行为：添加摘要链接 Web 部件并添加新链接。单击“浏览”，这将打开 AssetPortalBrowser.aspx 对话框。浏览到包含子文件夹的列表并双击子文件夹。此时会引发错误。

我所有的 MOSS 装置都表现出这种行为。虽然我可以理解为什么它可能无法处理子文件夹的浏览，但它抛出错误似乎很奇怪。

我很想知道其他人是否有这个问题，或者是否有人可以确认这是否是正确的行为？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-07-07T08:44:00.267

我确认 MOSS 2007 SP2（2009 年 4 月 CU）会出现此问题。它适用于文档库，但不适用于自定义列表（我使用了链接列表）。

您应该向 Microsoft 拨打支持电话。这显然是产品的一个错误，因此它不应该花费任何费用。我已经检查了 2009 年 6 月的 CU 修复列表，但看不到任何可以解决此问题的内容。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-15T13:02:58.103

您必须确保您的用户在根 Web 上具有“浏览目录”权限级别。您可以将您的用户放在一个具有该权限级别的组中，也可以创建您自己的角色来包含该权限级别。

# c++ - ACE (C++)：不调用 cancel_timer == MLK？

> ID：709145
> 
> 赞同：0
> 
> 时间：2009-04-02T10:15:43.403
> 
> 标签：c++, memory-leaks, ace

如果通过以下方式安排了一次性计时器

```
schedule_timer(timer,0,ACE_Time_Value(delay),ACE_Time_Value::zero) 
```

是否需要 cancel_timer 以避免内存泄漏？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-02T16:28:14.890

我认为答案是“视情况而定”。除了相对古老的 ACE 版本，您可以让 Reactor（或 Timer_Queue）增加事件处理程序的引用计数，并在事件处理程序从 Reactor（或 Timer_Queue）中删除时减少它。请注意，引用计数是可选，必须启用。

另外，这玩意我没用过，看文档测试！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-02T12:16:55.513

定时器对象不会被ACE释放，但是ACE需要维护定时器的任何数据结构都会在定时器运行后被释放。

两种验证方式：

*   阅读ACE源代码（不好玩）
*   [在valgrind](http://www.valgrind.org/)下运行一个小测试程序

# c++ - 如何有效地清除 std::queue？

> ID：709146
> 
> 赞同：189
> 
> 时间：2009-04-02T10:16:13.073
> 
> 标签：c++, data-structures, stl, queue

我正在使用 std::queue 来实现 JobQueue 类。（基本上这个类以先进先出的方式处理每个作业）。在一种情况下，我想一次性清除队列（从队列中删除所有作业）。我在 std::queue 类中看不到任何可用的明确方法。

如何有效地实现 JobQueue 类的 clear 方法？

我有一个简单的循环弹出解决方案，但我正在寻找更好的方法。

```
//Clears the job queue
void JobQueue ::clearJobs()
 {
  // I want to avoid pop in a loop
    while (!m_Queue.empty())
    {
        m_Queue.pop();
    }
} 
```

* * *

## 回答 #1

> 赞同：290
> 
> 时间：2009-04-02T10:23:56.143

清除标准容器的一个常见习惯用法是使用空版本的容器进行交换：

```
void clear( std::queue<int> &q )
{
   std::queue<int> empty;
   std::swap( q, empty );
} 
```

这也是实际清除某些容器内的内存的唯一方法（std::vector）

* * *

## 回答 #2

> 赞同：53
> 
> 时间：2009-04-02T10:19:44.267

是的 - 恕我直言，队列类有点错误。这就是我所做的：

```
#include <queue>
using namespace std;;

int main() {
    queue <int> q1;
    // stuff
    q1 = queue<int>();  
} 
```

* * *

## 回答 #3

> 赞同：33
> 
> 时间：2010-08-30T11:12:42.053

该主题的作者询问如何“有效地”清除队列，所以我认为他想要比线性*O(queue size)*更好的复杂性。[David Rodriguez](https://stackoverflow.com/a/709161/711006)服务的方法，[anon](https://stackoverflow.com/a/709156/711006)具有相同的复杂性：根据 STL 参考，`operator =`具有复杂性*O(queue size)*。恕我直言，这是因为队列的每个元素都是单独保留的，并且不像向量中那样分配在一个大内存块中。所以要清除所有内存，我们必须单独删除每个元素。所以最直接的清除方法`std::queue`是一行：

```
while(!Q.empty()) Q.pop(); 
```

* * *

## 回答 #4

> 赞同：19
> 
> 时间：2015-02-25T16:54:05.563

显然，有两种最明显的清除方法`std::queue`：与空对象交换和分配给空对象。

我建议使用赋值，因为它更快、更易读、更明确。

我使用以下简单代码测量了性能，发现在 C++03 版本中交换比分配给空对象慢 70-80%。但是，在 C++11 中，性能没有差异。无论如何，我会带着任务去。

```
#include <algorithm>
#include <ctime>
#include <iostream>
#include <queue>
#include <vector>

int main()
{
    std::cout << "Started" << std::endl;

    std::queue<int> q;

    for (int i = 0; i < 10000; ++i)
    {
        q.push(i);
    }

    std::vector<std::queue<int> > queues(10000, q);

    const std::clock_t begin = std::clock();

    for (std::vector<int>::size_type i = 0; i < queues.size(); ++i)
    {
        // OK in all versions
        queues[i] = std::queue<int>();

        // OK since C++11
        // std::queue<int>().swap(queues[i]);

        // OK before C++11 but slow
        // std::queue<int> empty;
        // std::swap(empty, queues[i]);
    }

    const double elapsed = double(clock() - begin) / CLOCKS_PER_SEC;

    std::cout << elapsed << std::endl;

    return 0;
} 
```

* * *

## 回答 #5

> 赞同：18
> 
> 时间：2016-09-23T08:19:52.340

在 C++11 中，您可以通过以下方式清除队列：

```
std::queue<int> queue;
// ...
queue = {}; 
```

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2013-04-29T18:57:22.763

您可以创建一个从队列继承的类并直接清除底层容器。这是非常有效的。

```
template<class T>
class queue_clearable : public std::queue<T>
{
public:
    void clear()
    {
        c.clear();
    }
}; 
```

也许您的实现还允许您的 Queue 对象（此处`JobQueue`）继承`std::queue<Job>`而不是将队列作为成员变量。这样您就可以直接访问`c.clear()`您的成员函数。

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2018-07-26T09:53:49.930

假设您`m_Queue`包含整数：

```
std::queue<int>().swap(m_Queue) 
```

否则，如果它包含例如指向`Job`对象的指针，则：

```
std::queue<Job*>().swap(m_Queue) 
```

这样，您将一个空队列与您的 交换`m_Queue`，因此`m_Queue`变为空。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2014-02-14T22:03:49.060

我宁愿不依赖`swap()`或将队列设置为新创建的队列对象，因为队列元素没有正确销毁。调用`pop()`会调用相应元素对象的析构函数。这在队列中可能不是问题，`<int>`但很可能对包含对象的队列产生副作用。

`while(!queue.empty()) queue.pop();`因此，不幸的是，如果您想防止可能的副作用，至少对于包含对象的队列来说，循环似乎是最有效的解决方案。

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2018-09-24T16:16:00.577

我这样做（使用 C++14）：

```
std::queue<int> myqueue;
myqueue = decltype(myqueue){}; 
```

如果您有一个不想为其构建别名/类型定义的非平凡队列类型，这种方法很有用。不过，我总是确保对这种用法发表评论，以向毫无戒心的/维护程序员解释这并不疯狂，并且代替了实际`clear()`方法。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2015-01-10T17:38:07.543

使用 a`unique_ptr`可能没问题。
然后重置它以获得一个空队列并释放第一个队列的内存。至于复杂度？我不确定 - 但猜它是 O(1)。

可能的代码：

```
typedef queue<int> quint;

unique_ptr<quint> p(new quint);

// ...

p.reset(new quint);  // the old queue has been destroyed and you start afresh with an empty queue 
```

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2018-12-14T14:39:26.760

另一种选择是使用简单的 hack 来获取底层容器`std::queue::c`并调用`clear`它。该成员必须按照`std::queue`标准存在，但不幸的是`protected`。这里的hack取自[这个答案](https://stackoverflow.com/a/29325258/673852)。

```
#include <queue>

template<class ADAPTER>
typename ADAPTER::container_type& get_container(ADAPTER& a)
{
    struct hack : ADAPTER
    {
        static typename ADAPTER::container_type& get(ADAPTER& a)
        {
            return a .* &hack::c;
        }
    };
    return hack::get(a);
}

template<typename T, typename C>
void clear(std::queue<T,C>& q)
{
    get_container(q).clear();
}

#include <iostream>
int main()
{
    std::queue<int> q;
    q.push(3);
    q.push(5);
    std::cout << q.size() << '\n';
    clear(q);
    std::cout << q.size() << '\n';
} 
```

# css - CSS：如何克服 IE6 中的负边距和绝对位置问题？

> ID：709151
> 
> 赞同：0
> 
> 时间：2009-04-02T10:18:15.393
> 
> 标签：css, internet-explorer, css-position, internet-explorer-6, margin

我正在使用绝对定位和负边距（顶部：和左侧：）在我的网站中定位徽标和其他此类内容。我知道 IE6 存在负边距和绝对定位问题，我该如何克服这些问题以确保它们在 IE6 中正常工作？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-02T10:29:56.973

在 IE6 中使用绝对定位时，您可能会得到一些意想不到的定位，除非您专门在最近定位的父元素上设置宽度（否则 IE6 似乎不知道您的*左*值应该在哪里）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-02T10:22:29.563

您可能需要重新考虑使用负边距。你真的需要它们来做你正在做的事情吗？我想如果没有您的代码示例就很难说清楚。

如果您使用绝对定位，则可以相对于您拥有的任何相对父元素将某些东西定位在您喜欢的任何位置。顶部和左侧属性（或右侧和底部）应该意味着您不必使用负边距，不是吗？

# c# - How to split & merge mpeg video files

> ID：709155
> 
> 赞同：1
> 
> 时间：2009-04-02T10:19:26.640
> 
> 标签：c#

I am given with a project where advertisements are added in between serials. So for that we need to first split the video file into pieces and merge it with those advertisements. Can anyone help me out in this.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-02T10:43:59.107

ffmpeg can do that, but I assume you want a c# library? If you do please edit your question.

And beware ffmpeg is GPL. On the project I worked on we installed ffmpeg separatly and called it from our program in an external process.

And we had to build ffmpeg ourselves, we used mingw

[http://en.wikipedia.org/wiki/Ffmpeg](http://en.wikipedia.org/wiki/Ffmpeg)
[http://en.wikipedia.org/wiki/mingw](http://en.wikipedia.org/wiki/mingw])

[edit] Ansver to comment:
Sorry I don't have anything personally. But you tagged the question c# so if that was the only type you wanted it would be best to say so in the question.

I did however have another thought, have you looked into the [Windows Media SDK](http://msdn.microsoft.com/en-us/windowsmedia/default.aspx)?

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-02T10:49:57.767

您可以使用 MEncoder，也可以使用 GPL。

[MEncoder（维基百科）](http://en.wikipedia.org/wiki/MEncoder)

* * *

## 回答 #3

> 赞同：-4
> 
> 时间：2009-04-02T10:27:33.313

Use any professional video editing software like Adobe Premier ([http://www.adobe.com/products/premiere/](http://www.adobe.com/products/premiere/)).

# wpf - 您在 MVVM 中绑定 DataContext 的策略是什么？

> ID：709158
> 
> 赞同：6
> 
> 时间：2009-04-02T10:22:53.837
> 
> 标签：wpf, silverlight, mvvm, conceptual

这两个 1 小时的视频分步展示了如何使用 MVVM 模式在 Silverlight 和 WPF 中构建简单的测验应用程序：

[在 Silverlight 中实现模型-视图-视图模型](http://pixel8.infragistics.com/default.aspx#Episode:11927)

[在 WPF 中实现模型-视图-视图模型](http://pixel8.infragistics.com/default.aspx#Episode:11933)

令我惊讶的是**它们在结构上的不同**之处，例如，它们如何使用 DataBinding：

在 Silverlight 方法中，我们将***View*****的 DataContext 设置为ViewModel中的*ObservableCollection*****：**

 **```
<views:QuestionView x:Name="QuestionDataView" />

QuestionViewModel qdata = new QuestionViewModel();
qdata.FetchQuestions();
QuestionDataView.DataContext = qdata.Questions; 
```

在 WPF 方法中，我们**将*Window*的 DataContext 设置为*ViewModel*本身**。

```
<view:QuizView Margin="4" />

base.DataContext = new QuizViewModel(Quiz.Create()); 
```

似乎我看到的每个 MVVM 示例都以稍微新的变体进行 DataContext 绑定，我**试图确定**一些坚实的基础，即“**如何在 MVVM 模式中完成 DataContext 绑定**”。

当您决定将 DataContext 绑定到某个东西时，您会想到什么：为什么要将**Window / View / ListBox / 等**的 DataContext 绑定到**ObservableCollection / ModelView / 等**？这里有什么优点、缺点和策略？

任何输入表示赞赏。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-04-02T10:31:23.100

他们有没有提到为什么 Silverlight 使用了不同的方法？这可能只是平台的限制。

推荐的方法是绝对使用视图模型本身作为视图的`DataContext`. 实际上，您应该创建视图模型并让 WPF 为您解析视图，而不是显式地创建视图。为此，请注册一个`DataTemplate`：

```
<DataTemplate DataType="{x:Type local:MyViewModel}">
    <local:MyView/>
</DataTemplate> 
```

然后，您只需将视图模型实例粘贴到`ContentControl`.`ItemsControl`或其他任何内容中，WPF 将使用适当的`DataTemplate`. 凭借 WPF 的模板系统，这`DataTemplate`将拥有视图模型。`DataContext`

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-02T10:49:00.640

如果您阅读 Silverlight 视频的评论，您会发现绑定到 ObservableCollection 是一个错误。它会导致抛出异常。

大多数时候 View 绑定到 ViewModel （实际上我想不出我不这样做的原因）

上面的 Kents 示例是我遵循的一般规则，让 Silverlight 在给定 ViewModel 集合的情况下为我创建视图。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-06T11:28:21.143

在我们的项目中，我得到了一些非常有天赋的 MS 工程师的一些支持，他们将视图数据上下文直接绑定到视图模型。

理想情况下，除了您的数据上下文设置之外，您不应该有任何代码背后的代码 - 事实上这也可以在 XAML 中完成。

# asp.net-mvc - 模型绑定器中的模型绑定

> ID：709162
> 
> 赞同：0
> 
> 时间：2009-04-02T10:24:33.740
> 
> 标签：asp.net-mvc, modelbinders, modelbinder

首先，请容忍我在这里。我有一个自定义模型绑定器，它成功地将表单数据映射到自定义对象。在此模型绑定器中，它还将表单项映射到不同的自定义对象。我觉得我应该能够做的是创建一个单独的模型绑定器来处理第二个映射。这是一个简化版本。

自定义对象：

```
public class Category
{
    public int CategoryId { get; set; }
    public string Name { get; set; }
    public string Status { get; set; }
    public string Description { get; set; }
    public IEnumerable<SubCategory> SubCategories { get; set; }
}

public class SubCategory
{
    public int CategoryId { get; set; }
    public string Name { get; set; }
    public string Description { get; set; }
    public string Status { get; set; }
} 
```

如果我的表单为 SubCategories 传回了一堆 Id，我需要做的是运行到数据存储库并水合 SubCategory 对象。从表格中，将按以下格式提交子类别列表：

```
<input type="text" name="Name" value="This Category" />

<input type="hidden" name="subcat.Index" value="0" />
<select name="subcat[0].Id">
    <option value="1">Something</option>
    <option value="2">Something else</option>
</select>

<input type="hidden" name="subcat.Index" value="1" />
<select name="subcat[1].Id">
    <option value="1">Something</option>
    <option value="2">Something else</option>
</select>

<input type="hidden" name="subcat.Index" value="2" />
<select name="subcat[2].Id">
    <option value="1">Something</option>
    <option value="2">Something else</option>
</select> 
```

编写自定义来映射类别显然很简单，但编写模型绑定器将依次映射子类别（在模型绑定器中，我会运行查询我的数据存储库）证明有点困难。

我不确定我说得有多清楚，抱歉，感谢您的阅读，如果有什么我可以说的让我更清楚，请告诉我！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-04-02T12:05:42.467

我对此的看法是模型绑定器应该构建表示模型，而不是来自存储库的实体类型。模型绑定器应该是从表单的键/值集合到表示模型的非常简单的映射，该表示模型主要是标量值，可能与其他主要是标量值或列表的类型有一些关系。正如您所发现的，必须从存储库中实现实体实例会增加很多复杂性。

而且，这是不必要的。使用演示模型有很多优点，包括：

*   永远不需要将允许用户更新的字段列入白名单，因为表示模型只包含这些字段。
*   默认模型绑定器适用于除最复杂的模型绑定场景之外的所有场景。在实践中，我发现只有当用户看到的值必须以有条件的方式绑定到某个其他值时，我才需要使用自定义模型绑定器。使用表示模型时，表示模型的结构应该与页面的结构相匹配，因此出于结构原因，您不需要使用自定义模型绑定器。
*   您将能够在创建数据库或实体模型之前创建视图和控制器。这意味着您可以在进行大量工作以创建最终系统之前获得客户对您的设计的认可。这有助于在实体模型中的结构性问题发生之前对其进行梳理。只需创建一个与您认为客户希望看到的页面相匹配的演示模型，使用此演示模型的虚构实例构建页面的总体轮廓，并将其展示给客户。如果他们满意，您可以构建存储库/实体模型并编写 LINQ 查询以将其映射到您的表示模型。

因此，在您的示例中，子类别将作为整数列表来自表单集合。因此，表示模型应该具有相同的整数列表。在控制器中，绑定后，您可以调用方法将模型值从表示模型传输到存储库中的物化类别实例。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-13T15:55:24.163

我建议看一下这个[Singing Eels 帖子](http://www.singingeels.com/Articles/Model_Binders_in_ASPNET_MVC__Part_2.aspx)，它提供了另一种方法的示例。使用示例 StatefulObjectBinder 方法，可以绑定必须从数据库中检索的业务对象集合。由于控制器正在实现 IModelBinder，因此您可以访问存储库，该存储库可用于混合所需的对象并将它们添加到对象集合中。

# java - 在 Bea Weblogic 中运行批处理

> ID：709169
> 
> 赞同：1
> 
> 时间：2009-04-02T10:26:51.147
> 
> 标签：java, jakarta-ee, batch-file, weblogic

我们目前在 Java 中有处理多个（有时很大）文件的批处理作业。这些作业可能需要一些时间才能运行。我们使用在循环中持续运行的 Java 线程直接在 JVM 中运行这些文件。（处理文件，然后等待一段时间）。

现在我工作的公司想要在 Weblogic 应用服务器中运行这些作业。不是因为它更好，而是因为那是公司的标准平台。

我看到的一个潜在问题是 BEA weblogic 监视所有线程，并且默认说运行时间超过 10 分钟的线程是 STUCK 线程，这可能会导致服务器处于 FAILED 状态。

在 BEA Weblogic 中执行此操作的最佳实践是什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-02T10:29:40.467

BEA Weblogic 仅监控特定时间的请求线程。对于请求处理代码生成的线程，它不会。我们使用 Quartz（来自 OpenSymphony）调度程序来调度 Weblogic 中的作业，该作业过去需要 3-4 小时才能完成。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-07-09T16:16:05.293

Weblogic 服务器提供支持更长线程运行时间的 WorkManagers，并针对长时间工作进行了优化（一般来说，它们是围绕旧的 ThreadPools 的框架）。对于 WorkManager，您可以定义 MaxThreadStuckTime，在此时间之后线程被视为卡住并可能被终止。

# wcf - IIS Silverlight not connecting to WCF

> ID：709174
> 
> 赞同：3
> 
> 时间：2009-04-02T10:29:33.480
> 
> 标签：wcf, silverlight, iis-6

I am at a loss, and hoping someone here can help me. I have created a WCF service that runs on a remote computer. The service is self-hosted, but provides the clientaccesspolicy.xml through a webget command.

I also have a silverlight application that queries the WCF server. I access the service through a service reference. When I execute the silverlight code in VS2008 it connects fine to the server. When I host the site on a local IIS server (even 5.1) it works fine.

However, when I move my site to our official IIS server, the client dies when it tries to connect to the server. Initially it did not work at all, then we had the MIME types added. Although, currently, I think the MIME type for .xap is still set to application/octet-stream. (Don't know if it really makes a difference, since the site gets downloaded now.)

I checked the packets going in and out of the browser, and it seems that the client crashes every time I try to establish a connection to the server (I believe it takes place when it instantiates the connection code, before even sending a packet.) I know the IIS server can see the WCF Service, since I tested retrieving data from the service using ASP.NET.

Other than installing the SDK on that IIS, I can think of nothing else to try. Anyone have any ideas?

Thanks

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-03T04:59:35.830

您的问题可能是 ClientAccessPolicy.xml 位置。它与域的关系在哪里？它必须位于域服务器的根目录（[http://domain.com/clientpolicyfile.xml](http://domain.com/clientpolicyfile.xml)或[http://www.domain.com/clientpolicyfile.xml](http://www.domain.com/clientpolicyfile.xml)）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-07-24T17:50:32.180

我不能说我回答了我自己的问题，但最后我将 WCF 服务移到了 IIS 环境中，突然之间，通信工作正常。

# c# - Using enum to represent IDs in C#

> ID：709179
> 
> 赞同：1
> 
> 时间：2009-04-02T10:30:11.713
> 
> 标签：c#, types

I was using plain ints to represent some IDs internally but I needed a constant to represent a null ID, while I was playing around I realised that this would work:

```
public enum ID : int { Null = -1 } 
```

then for example:

```
ID myID = ID.Null; 
```

Is this a bad idea?
Is it worse that just using plain ints?
If it is a problem, what is the best way to represent IDs?

Thanks.

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-04-02T10:33:39.583

Why don't you use a Nullable int ? `Nullable<int>` or `int?`.

EDIT
Or if you don't like the that, use the build-in `int.MinValue` as your constant for representing null id. Either way, they are standard, and not some custom hack.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-02T10:36:50.747

Why not just use a constant, as you state in the question? If you want to have a range of "magic" Ids, I suppose using an enum is as good a method as any.

As the other poster suggests, using one of the built-in constants such as int.MinValue is almost certainly the best option.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-02T10:40:18.930

You only need one value, Null? If so I'd use a const.

Depends on scope also - if you are using this enum inside a class, across several classes, or from one assembly to another. If you are using enums cross-assembly, you need to watch out for a weird case (for which I can't currently find any reference and can't remember the exact details) whereby enum names and values can appear to be unsynchronised - though I think you can avoid this by explicitly defining the values, as you have done here.

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-02T10:56:17.767

我认为取决于，但我更喜欢处理简单常量的枚举（在许多情况下）。这是因为枚举代表了比常量更详细的东西，并且您可以在许多情况和许多用途中使用枚举。

我也认为您不是代表“语言空值”而是“常规空值”实际上您将 ID 设置为值 -1 的枚举值，所以这很好地说明了您打算做什么以及我是什么谈论，出于这个原因，如果您要使用“语言 null”，那么使用可为空的`Nullable<int>`or仍然是一个好主意`int?`。

在某些情况下，例如使用 ORM 或类似方法时，定义一种未设置值而不是空值是一种很好的做法，因此使用枚举可能很有用，正如我之前所说的那样。

最后我想，最好考虑一下你需要代表什么样的空值

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-02T11:25:14.063

感谢您的回答。我想我喜欢这个首先是它使我的代码比使用普通 int 或 int 更容易阅读？没有单独 ID 类的不必要开销，例如：

```
int? myId = getAnIDFromSomewhere(); 
```

与：

```
ID myId = getAnIDFromSomewhere(); 
```

其次，它将类型和 Null 常量绑定到一个包中（当然，哪个 int？也可以）。另一方面，不知何故感觉不对，因此我在这里提出问题。

导致我这样做的一件事是，我不能在返回/使用 ID 的接口上包含 NullID 常量（因为 C# 不允许我这样做），这也感觉不对（因为返回 NullID 的可能性似乎是一部分那个界面）。

无论如何，我认为这里的回复清楚地表明，如果我继续我疯狂的枚举计划，我最终会出现在 thedailywtf.com 上，所以我放弃了这个想法。:)

再次感谢。

# asp.net - Asp.net：实现自动注销功能

> ID：709182
> 
> 赞同：8
> 
> 时间：2009-04-02T10:31:12.383
> 
> 标签：asp.net, ajax, session-timeout, logout

我必须在我的一个项目中实现自动注销功能，我只是不知道从哪里开始寻找想法，但是**SO**。

如果用户会话已过期，我需要应用程序将用户重定向到登录页面。请告诉我我应该采取什么方法来解决这个要求。

**问题陈述：** 如果用户在任何给定的登录实例中离开系统超过 n 分钟，系统应自动将其注销。

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2009-04-02T13:16:31.330

继续评论和问题一样多，我不确定您是否想要在一段时间后将用户注销，无论活动如何，或者只是在一段时间不活动之后。

如果您乐于使用标准的[ASP.NET 机制](http://msdn.microsoft.com/en-us/library/yh26yfzy.aspx)，则无需任何主要工作即可为您完成：

设置您的[会员提供商](http://msdn.microsoft.com/en-us/library/6e9y4s5t.aspx)。

确保您的[身份验证部分](http://msdn.microsoft.com/en-us/library/532aee0e.aspx)定义了 loginUrl：

```
<authentication mode="Forms">
  <forms loginUrl="login.aspx" />
</authentication> 
```

[您可以使用表单元素](http://msdn.microsoft.com/en-us/library/1d3t3c61.aspx)上的“超时”属性设置默认 30 分钟以外的超时：

```
<authentication mode="Forms">
  <forms loginUrl="login.aspx" timeout="15"/>
</authentication> 
```

这将在用户在您的站点上闲置 15 分钟后注销（在浏览器打开且没有 javascript“心跳”的情况下，或者如果他们在另一个站点上花费 15 分钟）。

拒绝匿名用户访问

```
<authorization>
  <deny users="?" />
</authorization> 
```

然后确保使用[location 元素的所有用户都可以访问您的登录、注册和可能忘记的密码页面：](http://msdn.microsoft.com/en-us/library/b6x6shw7.aspx)

```
<location path="Logon.aspx">
  <system.web>
    <authorization>
      <allow users="?"/>
    </authorization>
  </system.web>
</location>
<location path="Register.aspx">
  <system.web>
    <authorization>
      <allow users="?"/>
    </authorization>
  </system.web>
</location>
<!-- etc --> 
```

这样，当用户的身份验证 cookie 过期时，他们将被重定向到表单页面的 loginUrl 元素中指定的 URL。

* * *

如果您没有使用标准的 ASP.NET 机制，那么您最好实现“基页”类型模型。

创建一个继承自 System.Web.UI.Page 的新类，它将检查用户的登录状态，如果他们没有登录/超时，则将它们重定向到您的登录页面。

在要锁定的页面中，您可以从基页面类继承而不是从 System.Web.UI.Page 继承（这种设置的示例以执行类似的操作 - 检查每个页面上的设置）在[我的回答中看到](https://stackoverflow.com/questions/495245/how-do-i-reference-an-asp-net-masterpage-from-appcode/495338#495338)

* * *

您的登录页面可能需要在其中包含一些破坏框架的 JS 才能跳出 iFrame：

```
if (top!=self.parent){
  top.location=self.parent.location;
} 
```

* * *

或者您是说按“返回”他们仍然可以通过浏览器缓存看到您的页面？在这种情况下，您需要在每个页面上使用 Cache 标头：

```
Response.Cache.SetCacheability(HttpCacheability.NoCache); 
```

* * *

好的，那么，在这种情况下，您还需要一个 JS 计时器对象来执行 Location.Replace 到您的登录页面 - 在每个页面的用户控件中（或者更好的是，在您的母版页面中）都有这个以自动重定向n分钟后的用户：

```
<script type="text/javascript">
  setTimeout('location.Replace("/login.aspx")', 900000);
</script> 
```

时间以毫秒为单位，因此这将在 15 分钟内移动它们，而无需为此准备整个 jQuery 框架。

您可能还想查看元刷新标签：

```
<meta http-equiv="refresh" content="900;url=http://example.com/login.aspx" /> 
```

这将强制浏览器在 15 分钟后刷新到登录页面（以秒为单位）。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-12-17T08:38:24.040

这是通过以下方式实现的：

1）将每个请求（服务器和ajax，不包括会话检查ajax请求）的时间戳保存到服务器到会话变量中。

2) 使用 ajax 频繁地通过 JS 函数轮询服务器，并检查会话时间戳和 ajax 请求时间之间的时间差异是否大于会话超时 val 然后注销当前用户并返回 bool for那个ajax请求。

3) 如果返回的布尔值为真，则将当前页面重定向到登录页面。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-02T11:43:39.807

由于您不知道从哪里开始，您可能会发现这篇 4guys 文章很有用：[http ://www.4guysfromrolla.com/webtech/110701-1.shtml](http://www.4guysfromrolla.com/webtech/110701-1.shtml)

**编辑**

如果您想在经过一段已知的时间（即您的会话到期时间）后重定向到一个 url，那么听起来[jQuery 计时器可能会很有用。](http://plugins.jquery.com/project/Timer)

希望这可以帮助。

# c# - 在线程中访问 UI

> ID：709187
> 
> 赞同：10
> 
> 时间：2009-04-02T10:31:50.463
> 
> 标签：c#, multithreading, user-interface

当我尝试更改 UI 属性（特别是启用）时，我的线程抛出 System.Threading.ThreadAbortException

如何在线程中访问 UI。

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2009-04-02T11:50:48.400

您可以使用 BackgroundWorker，然后像这样更改 UI：

```
control.Invoke((MethodInvoker)delegate {
    control.Enabled = true;
}); 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-04-02T14:01:41.223

如果您使用的是 C# 3.5，那么使用扩展方法和 lambdas 来防止从其他线程更新 UI 真的很容易。

```
public static class FormExtensions
{
  public static void InvokeEx<T>(this T @this, Action<T> action) where T : Form
  {
    if (@this.InvokeRequired)
    {
      @this.Invoke(action, @this);
    }
    else
    {
      action(@this);
    }
  }
} 
```

因此，现在您可以`InvokeEx`在任何表单上使用，并且能够访问任何不属于`Form`.

```
this.InvokeEx(f => f.label1.Text = "Hello"); 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-04-02T10:35:29.750

我假设我们在这里谈论 WinForms？您需要有一个线程来管理它 - 创建相关控件的线程。如果您想从不同的线程执行此操作，您可以使用 Control.InvokeRequired 进行检测，那么您应该使用 Control.Invoke 方法将其编组到正确的线程上。谷歌该属性和方法（分别）用于执行此操作的一些常见模式。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-02T10:34:40.033

使用 Win Form 的 BackgroundWorker 类代替手动执行同步如何？

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-04-02T10:36:19.967

如果`SynchronizationContext`要在非 UI 线程仍在运行时修改 UI，则用于编组对 UI 线程的调用。否则，使用`BackgroundWorker`.

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-04-02T10:36:57.033

```
void button1_Click( object sender, EventArgs e ) {
    var thread = new Thread( ParalelMethod );
    thread.Start( "hello world" );
}
void ParalelMethod( object arg ) {
   if ( this.InvokeRequired ) {
       Action<object> dlg = ParalelMethod;
       this.Invoke( dlg, arg );
   }
   else {
       this.button1.Text = arg.ToString();
   }
} 
```

# c# - WCF Authentication

> ID：709192
> 
> 赞同：0
> 
> 时间：2009-04-02T10:33:48.710
> 
> 标签：c#, .net, wcf, authentication, basichttpbinding

We're building some core services in .Net 3.5 and exposing the services via WCF. The services will only be accessed internally (i.e. within the intranet). The services just need to authenticate the calling user's windows credentials and get their AD/functional groups.

The serives need to be exposed using NetTcpBinding and BasicHttpBinding.

What configuration do I need to add to the section for both both binding types? Is it just this:

```
 <system.serviceModel>
    <services>
      <service name="WCFTest.CalculatorService" behaviorConfiguration="WCFTest.CalculatorBehavior">
        <host>
          <baseAddresses>
            <add baseAddress = "http://localhost:8000/WCFTest/CalculatorService/" />
            <add baseAddress = "net.tcp://localhost:9000/WCFTest/CalculatorService/" />
          </baseAddresses>
        </host>

        <endpoint address ="basicHttpEP" binding="basicHttpBinding" contract="WCFTest.ICalculatorService"/>
        <endpoint address="mex" binding="mexHttpBinding" contract="IMetadataExchange"/>

        <endpoint address ="netTcpEP" binding="netTcpBinding" contract="WCFTest.ICalculatorService"/>
        <endpoint address="mex" binding="mexTcpBinding" contract="IMetadataExchange"/>

      </service>
    </services>
    <behaviors>
      <serviceBehaviors>
        <behavior name="WCFTest.CalculatorBehavior">          
          <serviceAuthorization impersonateCallerForAllOperations="false"  principalPermissionMode="UseWindowsGroups" />
          <serviceCredentials >
            <windowsAuthentication allowAnonymousLogons="false" includeWindowsGroups="true" />
          </serviceCredentials>    
          <serviceMetadata httpGetEnabled="True"/>
          <serviceDebug includeExceptionDetailInFaults="False" />
        </behavior>
      </serviceBehaviors>
    </behaviors>
  </system.serviceModel> 
```

Is that the case? Will this then apply to both my NetTcp and BasicHttp Bindings?

Thanks

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-02T10:41:11.017

In Visual Studio 2008 go to Tools -> WCF Service Configuration Editor. Open your config file and edit the settings there.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-10-07T20:15:20.693

不，netTcpBinding 无需配置：默认情况下它使用 Windows 身份验证。对于 basicHttpBinding，您需要在绑定配置中指定您希望的身份验证机制（因为 basicHttpBinding 默认不使用身份验证）：

```
<system.serviceModel>
  <bindings>
    <basicHttpBinding>
      <binding name="DefaultBasicHttpBinding">
        <security mode="TransportCredentialsOnly">
          <transport clientCredentialType="Windows"/>
        </security>
      </binding>
    </basicHttpBinding>
  </bindings>
  <services>
    <service name="WCFTest.CalculatorService" behaviorConfiguration="WCFTest.CalculatorBehavior">
      <host>
        <baseAddresses>
          <add baseAddress="http://localhost:8000/WCFTest/CalculatorService/" />
          <add baseAddress="net.tcp://localhost:9000/WCFTest/CalculatorService/" />
        </baseAddresses>
      </host>
      <endpoint address="basicHttpEP" binding="basicHttpBinding" contract="WCFTest.ICalculatorService"/>
      <endpoint address="mex" binding="mexHttpBinding" contract="IMetadataExchange"/>
      <endpoint address="netTcpEP" binding="netTcpBinding" contract="WCFTest.ICalculatorService"/>
      <endpoint address="mex" binding="mexTcpBinding" contract="IMetadataExchange"/>
    </service>
  </services>
  <behaviors>
    <serviceBehaviors>
      <behavior name="WCFTest.CalculatorBehavior">          
        <serviceMetadata httpGetEnabled="True"/>
        <serviceDebug includeExceptionDetailInFaults="False"/>
      </behavior>
    </serviceBehaviors>
  </behaviors>
</system.serviceModel> 
```

# java - Regex gives error

> ID：709195
> 
> 赞同：1
> 
> 时间：2009-04-02T10:34:35.027
> 
> 标签：java, regex

Continuing with the post at [Regular expression to allow a set of characters and disallow others](https://stackoverflow.com/questions/705672/regular-expression-to-allow-a-set-of-characters-and-disallow-others/705990#705990)

Does anybody know why the below would occur?

I get the below error when I create a regular expression as:

```
[^@*–’”“\r\nœçsÇSgGšcrŠRNEŽDTCnežuUIti—¿„”]+ 
```

and enter any of these restricted characters in the input field

```
java.lang.ArrayIndexOutOfBoundsException
    at org.apache.regexp.RECompiler$RERange.delete(RECompiler.java:1326)
    at org.apache.regexp.RECompiler$RERange.remove(RECompiler.java:1417)
    at org.apache.regexp.RECompiler$RERange.include(RECompiler.java:1459)
    at org.apache.regexp.RECompiler$RERange.include(RECompiler.java:1470)
    at org.apache.regexp.RECompiler.characterClass(RECompiler.java:699)
    at org.apache.regexp.RECompiler.terminal(RECompiler.java:863)
    at org.apache.regexp.RECompiler.closure(RECompiler.java:942)
    at org.apache.regexp.RECompiler.branch(RECompiler.java:1151)
    at org.apache.regexp.RECompiler.expr(RECompiler.java:1203)
    at org.apache.regexp.RECompiler.compile(RECompiler.java:1281)
    at org.apache.regexp.RE.(RE.java:495)
    at org.apache.regexp.RE.(RE.java:480) 
```

but this expression works perfectly fine

```
[^@*–’”“\r\nœçsÇSgGšcrŠRN]+ 
```

Also,

```
[^@*–’”“\r\nœçsÇSgGšcrŠR„”]+ 
```

works but

```
[^@*–’”“\r\nœçsÇSgGšcrŠRNE]+ 
```

does not work and gives the above error.

Is there a limit to the number of characters that can be disallowed like the way above?

Regards, Udit Sud

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-02T11:00:08.787

破折号（减号）在字符类中具有特殊含义。它定义了连续字符的范围，例如`"a-z"`.

可能存在一个连续的范围`"*–’"`，但我想这不是你的意图。您可能想要文字破折号，我怀疑您看到的异常与此有关。

而不是这个：

```
[^@*–’”“\r\nœçsÇSgGšcrŠRNEŽDTCnežuUIti—¿„”]+
----^ (this is the error) 
```

尝试：

```
[^@*’”“\r\nœçsÇSgGšcrŠRNEŽDTCnežuUIti—¿„”–]+
-----------------------------------------^ (this okay) 
```

或者

```
[-^@*’”“\r\nœçsÇSgGšcrŠRNEŽDTCnežuUIti—¿„”]+
-^ (this okay as well) 
```

或者

```
[^@*\–’”“\r\nœçsÇSgGšcrŠRNEŽDTCnežuUIti—¿„”]+
----^^ (this okay as well) 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-02T23:39:23.403

请参阅[http://webui.sourcelabs.com/jakarta-regexp/issues/22804](http://webui.sourcelabs.com/jakarta-regexp/issues/22804) - 此软件包的旧版本*确实*将允许范围的最大数量限制为 16。这已在 2003 年修复，但可以想象它们只是稍微提高了上限。（？）

无论如何，正如其他人所建议的那样，我总是将 Java 内置的正则表达式解析器用于任何新工作。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-02T10:55:28.300

看起来像 apache regexp 解析器中的一些错误。你可以使用标准的（java.util.regex）吗？

# javascript - 如何让网络浏览器自动刷新？

> ID：709203
> 
> 赞同：5
> 
> 时间：2009-04-02T10:36:04.947
> 
> 标签：javascript, html, browser

假设我想运行一个简单的 Python 脚本，它是一个 Web 服务器。我想将浏览器连接到它，每 N 秒刷新一次，即更新页面。我该怎么做？

我假设 Python 服务器脚本会生成一些 HTML，其中包含休眠并强制刷新的 javascript？或者浏览器可以强制刷新吗？

提前致谢。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-04-02T10:37:43.367

```
<meta http-equiv="refresh" content="5" /> 
```

这将在 5 秒后重新加载页面。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-04-02T11:05:26.137

刷新页面是一种相当古老的方法，并且在带宽方面通常比简单地更新页面的特定部分更昂贵。此处介绍的解决方案已经可以满足您的需求，但您还应该尝试使用 AJAX 研究动态更新。掌握起来并不难。基本上，您可以使用 AJAX 仅从需要在页面上更新的 Web 服务器请求数据，而不是让浏览器刷新整个页面。

有很多关于 AJAX 的教程。如果你需要支持 IE6，可能会稍微困难一点，否则就很简单了。理论上：

1.  创建一个 XMLHTTPRequest 对象。
2.  告诉它一个指向页面上需要更新的数据的 URL（它不必是 XML）。
3.  给对象一个函数，可以在接收到数据时对其进行处理。
4.  告诉对象将请求发送到服务器并检索数据。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-02T10:39:10.867

将以下内容放在

```
<meta http-equiv="refresh" content="5" /> 
```

这将在 5 秒后刷新页面。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-02T10:38:18.107

您可以使用 META-Tag 进行刷新或使用 javascript。但是您必须注意正确处理 URL 中的参数，并且如果您不打算刷新 POST 操作，则不要刷新。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-02T10:38:52.740

使用[元刷新](http://webdesign.about.com/od/metataglibraries/a/aa080300a.htm)标签。尽管如果网页突然自行更新，我会感到非常惊讶。一些 AJAXy 的东西会更有用。

# javascript - 当 onfocus 设置选择大小时，谷歌浏览器会中断

> ID：709207
> 
> 赞同：3
> 
> 时间：2009-04-02T10:37:03.663
> 
> 标签：javascript, select, google-chrome, focus, setattribute

以下 javascript 在 Google Chrome 中调整选择列表的大小。它在进入该字段时起作用，但单击它会导致“Aw，Snap！” 错误页面。

```
<select onfocus="this.setAttribute('size', 3);">
<option>selectList with onfocus</option>
<option>2</option>
<option>3</option>
<option>4</option>
</select> 
```

在 FF 和 IE 中运行良好。这是 onfocus （如果我实现 onClick 没有问题）和设置 size 属性之间的某种冲突。我被告知它也在 Safari 中中断。

非常感谢任何帮助、想法或解决方法。

（PS Yeh 我知道调整选择列表的大小不是很好的形式，但这是老板/客户想要的）

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-04-02T10:46:43.470

将带有选择的行更改为：

```
<select onfocus="var that = this; setTimeout(function() {that.setAttribute('size', 3);}, 0);"> 
```

它在 Chrome 中对我有用。我没有在 Safari 中尝试过，但我怀疑它也会起作用。基本上我们在这里所做的只是使用 setTimeout 转义调用堆栈，这似乎绕过了 Webkit 中的错误。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2011-01-31T02:08:25.493

我还发现了这个：

*   [http://code.google.com/p/chromium/issues/detail?id=4579](http://code.google.com/p/chromium/issues/detail?id=4579)
*   [http://bugs.webkit.org/show_bug.cgi?id=17648](http://bugs.webkit.org/show_bug.cgi?id=17648)

所以这似乎是一个 WebKit 问题，出于某种原因，他们不想修复它（使其符合标准）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2010-04-12T23:05:17.430

据我所知，谷歌浏览器忽略了多个选择框的所有选择大小属性。

见链接：

[http://www.w3schools.com/TAGS/tryit.asp?filename=tryhtml_select_size](http://www.w3schools.com/TAGS/tryit.asp?filename=tryhtml_select_size)

使用任何其他浏览器，然后尝试使用 Google Chrome。Chrome 完全忽略了基本的 HTML 属性。

# delphi - Delphi Component Saving

> ID：709208
> 
> 赞同：0
> 
> 时间：2009-04-02T10:37:15.160
> 
> 标签：delphi, object, save, delphi-7, record

How best could I save this component and all internal variables? Examples of code would be appreciated.

```
 TSmall = record
      fName: string[30];
      fAge: integer;
      fID_Number: string[30];
  end;

  TRec = record
    ArraySmall: array[1..10] of TSmall;
  end;

  TBigComponent = class(TComponent)
    private
      fSmallArr: TRec;
      fCompCount: integer;
      fBigName: string;
    public
      procedure AddNew(Name: string; Age: integer; ID: string);
      procedure Save(FileName: string);
      procedure Load(FileName: string);
      procedure SetName(Name: string);
      function GetName: string;
      function ToString: string;
    published
      property SmallArr: TRec read fSmallArr write fSmallArr;
      property Count: integer read fCompCount write fCompCount;
      property Name: string read fBigName write fBigName;
    end; 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-03T01:45:48.870

对 Wouter 建议的一个小改进：

```
 type
  TSmall = record
      fName: string[30];
      fAge: integer;
      fID_Number: string[30];
  end;

  TRec = record
    ArraySmall: array[1..10] of TSmall;
  end;

  TBigComponent = class(TComponent)
  private
      type
        TInternalFields = record
          SmallArr: TRec;
          CompCount: integer;
          BigName: Shortstring;
       end;
    var
      FFields : TInternalFields;
    public
      procedure AddNew(Name: string; Age: integer; ID: string);
      procedure Save(FileName: string);
      procedure Load(FileName: string);
      procedure SetName(Name: string);reintroduce;
      function GetName: string;
      function ToString: string;
    published
      property SmallArr: TRec read FFields.SmallArr write FFields.SmallArr;
      property Count: integer read FFields.CompCount write FFields.CompCount;
      property Name: ShortString read FFields.BigName write FFields.BigName;
    end;

procedure TBigComponent.Save(FileName: string);
var
  F:File of TInternalFields;
begin
  AssignFile(F,FileName);
  Rewrite(F);
  Write(F, FFields);
  CloseFile(F);
end; 
```

这消除了将对象中的每个字段复制到记录中的需要 - 它已经在记录中。

我不确定何时添加了**read Record.field**语法 - 它是在 2006 年

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-02T11:22:35.987

要使用 Delphi 内部持久性和 RTTI，您应该使用类而不是记录。

这里有很多很好的建议和例子：

[使用 RTTI 而不是自定义代码将 Delphi 对象树序列化为 XML 的好方法是什么？](https://stackoverflow.com/questions/368913/whats-a-good-way-to-serialize-delphi-object-tree-to-xml-using-rtti-and-not-cust)

如果您正在寻找将自定义数据保存到可视组件的示例，请检查 Delphi VCL 源代码中的 ComCtrls.pas 文件中的方法 TTreeNodes.DefineProperties。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-02T12:02:52.070

一般来说，遵循 VilleK 的建议并利用 Tpersistent 提供的东西可能是最容易的。

但是，不知何故，我更喜欢这种方法，因此我可以完全控制文件的结构。

```
type
  TFileStruct=packed record
    fSmallArr: TRec;
    fCompCount: UINT32; // be explicit.. who knows what 64bit Delphi does to your integers...
    fBigName: String[250]; // AnsiChar
  end;

procedure TBigComponent.Save(FileName: string);
var
  F:File of TFileStruct;
  FileStruct:TFileStruct;
begin
  FileStruct.fSmallArr := fSmallArr;
  FileStruct.fCompCount := fCompCount;
  FileStruct.fBigName := fBigName;

  AssignFile(F,FileName);
  Rewrite(F);
  Write(F,FileStruct);
  CloseFile(F);
end; 
```

请记住，String[xxx] 似乎被视为 AnsiString，因此如果您使用 Delphi 2009，您的 Unicode 字符串将在您保存时更改为 AnsiStrings。至少文件可以与用旧版本的 Delphi 编译的软件交换。

在 TSmall 中，我会将 Age 的整数更改为 Byte，这样您就不会遇到 64 位 Delphi 的麻烦。
“8 位应该对每个人都足够了”(c) 2009 Wouter :-)

# entity-framework - 如何从 ADO.NET Entity Framework 中的模型生成表？

> ID：709214
> 
> 赞同：1
> 
> 时间：2009-04-02T10:38:29.557
> 
> 标签：entity-framework, orm, ado.net

如何在 Visual Studio 设计器中创建实体并从中生成表格？我发现在 VS 中生成实体比在 SQL Server 中创建表要容易得多。

另外，如果我确实从表中生成了一个实体，是否可以对实体进行更改并将它们推送到表中？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-02T10:41:49.580

EF，至少在当前版本中，不支持这个。没有创建数据库的机制；同样，当您重新同步时，它会*从*数据库中更新模型。

也许使用“data dude”（VS2008 数据库版）在数据库中进行更改？

# c# - How to add Outlook.TaskItems to already existing Outlook.Items?

> ID：709223
> 
> 赞同：0
> 
> 时间：2009-04-02T10:41:22.857
> 
> 标签：c#, vsto, outlook-addin, task

I've looked all over the internet and could not find an answer for this one...

Basically, what I want to do is to retrieve all the TaskItems from all the Tasks folders and put them into one single Outlook.Items list. I know how to look at all the folders and how to retrieve the tasks from these folders, but i don't know how to put together all the tasks I retrieve.

So, I have some Outlook.Items that i get from a folder like this:

```
Outlook.MAPIFolder outlookTasksFolder = Application.Session.GetDefaultFolder(Outlook.OlDefaultFolders.olFolderTasks);
        Outlook.Items outItems = outlookTasksFolder.Items; 
```

Then, I'd like to add a TaskItem to outItems.

Anyone knows how to do that? Thank you

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-08-09T23:33:03.090

As 76mel said create a new folder and use the Items.Add method to add all of the tasks into it.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-06T10:04:28.777

Items 集合 outItems.Add(TaskItem) 上有一个 Add 方法可以解决问题。

76梅尔

# web-services - Soapui 免费版可以在输出之间断言吗？

> ID：709227
> 
> 赞同：3
> 
> 时间：2009-04-02T10:41:59.113
> 
> 标签：web-services, testing, soapui

Soapui 免费版可以在两个请求的输出之间断言吗？我想检查一个输出的值是否等于另一个输出的值。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-06-16T10:32:40.757

是的你可以！:-)
这是一个在我的 soapUI v2.5.2 中工作的 Groovy 脚本（它是专业版，但也适用于免费版本）：

```
def r1 = context.testCase.testSteps["Request #1"].properties["Response"]
def response1 = r1["value"]
def r2 = context.testCase.testSteps["Request #2"].properties["Response"]
def response2 = r2["value"]

log.info "Request #1 response: $response1"
log.info "Request #2 response: $response2"

assert response1 == response2 
```

我希望这也适用于你。

干杯!
松兹拉

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-10-29T11:03:43.520

另一个有效的：

```
def myContext1 = new com.eviware.soapui.support.GroovyUtils( context )
holderOpConfirmation = myContext1.getXmlHolder ("opConfirmation3 - Request 2#Response")

holderOpConfirmation.namespaces["bilhete"] = "http://bilhete.ic.cp.fujitsu"
def ticketNo1 = holderOpConfirmation[ "//bilhete:ticketNo//bilhete:number" ]

log.info "ticketNo1: $ticketNo1"

//Segundo Bilhete
def myContext2 = new com.eviware.soapui.support.GroovyUtils( context )
holderGetNullifiedTickets = myContext2.getXmlHolder ("getNullifiedTickets - Request 1#Response")

holderGetNullifiedTickets.namespaces["bilhete"] = "http://bilhete.ic.cp.fujitsu"
def ticketNo2 = holderGetNullifiedTickets[ "//bilhete:getNullifiedTicketsReturn" ]

log.info "Numero bilhete 2: $ticketNo2"

if (!ticketNo2.contains(ticketNo1)) {
 com.eviware.soapui.support.UISupport.showInfoMessage(
    "O bilhete " + ticketNo1 + " nao se encontra entre os bilhetes anulados manualmente.\n" +
    "Por favor verifique a data do relatorio nas propriedades do teste");
}

// Garantir que a data de "getNullifiedTickets - Request 1" é um dia anterior à data da volta do askPlaces original
assert ticketNo2.contains(ticketNo1) 
```

# wpf - WPF：消失的图标

> ID：709228
> 
> 赞同：7
> 
> 时间：2009-04-02T10:43:17.097
> 
> 标签：wpf, icons, menuitem

我有几个在 Window.Resources 中声明的图标。它们在第一次需要出现时显示良好（例如：单击菜单，MenuItem 图标有效），但在显示另一个菜单（例如：上下文菜单）后，原始图标消失并且不会返回。就好像第一次使用图标的最后一个元素得到了保留它。

```
<Window.Resources>
    <Image x:Key="Chart_16"
           Source="pack://application:,,,/Resources/images/chart_16.png" />
    ...
<Window.Resources>

<MenuItem Header="Summary"
          Command="loc:AppCommands.ShowSummary"
          Icon="{StaticResource Chart_16}" /> 
```

我尝试将其保存为 24 位 PNG、隔行 24 位 PNG 和 8 位 PNG，但同样的事情发生了。它不仅仅是一个，在多个地方使用的每个图标都以这种方式运行。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-04-02T11:21:51.793

那是因为您的资源是一个`Image`，这是一个`Control`. `Control`s 只能有一个父级，因此它可以有效地在每个父级中重新`MenuItem`设置。

您的选择是：

1.  不要使用`Image`，而是使用`ImageSource`甚至`string`包含图像的 URI。
2.  `x:Shared`使用XAML 属性将资源设置为非共享。这将根据需要创建多个`Image`控件。

# ruby - Difference Between downcase and downcase! in Ruby

> ID：709229
> 
> 赞同：11
> 
> 时间：2009-04-02T10:43:27.813
> 
> 标签：ruby, naming-conventions

I am just learning Ruby and I don't quite understand the difference between several Ruby methods with and without a '!' at the end. What's the difference? Why would I use one over the other?

* * *

## 回答 #1

> 赞同：33
> 
> 时间：2009-04-02T11:01:33.667

Methods with an exclamation mark at the end are often called bang-methods. A bang method doesn't necessarily modify its receiver as well as there is no guarantee that methods without a exclamation mark doesn't.

It's all very well explained in [this blog post](http://dablog.rubypal.com/2007/8/15/bang-methods-or-danger-will-rubyist). To quote the post:

> The ! in method names that end with ! means, “This method is dangerous”—or, more precisely, this method is the “dangerous” version of an otherwise equivalent method, with the same name minus the !. “Danger” is relative; the ! doesn’t mean anything at all unless the method name it’s in corresponds to a similar but bang-less method name.

and

> The ! does not mean “This method changes its receiver.” A lot of “dangerous” methods do change their receivers. But some don’t. I repeat: ! does not mean that the method changes its receiver.

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2009-04-02T14:49:06.053

The non-bang downcase() method simply returns a new object representing you string downcased.

The bang version modifies your string itself.

```
my_text = "MY TEXT"
my_new_text = my_text.downcase
puts my_new_text # will print out "my text"
puts my_text     # will print out "MY TEXT" - the non-bang method doesn't touch it

my_text.downcase!

puts my_text # will print out "my text". The bang version has modified the object you're calling the method on 
```

# java - 对 java HTML 解析器/编辑器的建议

> ID：709233
> 
> 赞同：2
> 
> 时间：2009-04-02T10:45:07.013
> 
> 标签：java, html, parsing

在尝试使用第三方 HTML 编辑器执行（我希望）是一个简单的操作时，我一直遇到问题。由于这些问题，我正在寻找可用于执行操作的替代 HTML 解析器的建议。

这是我的情况，我的 html 中有 span 标签（带有标识它们的 ID 属性），我只想根据客户端另一个区域的更新替换它们的内容。例如：

```
<html>
    <body>
        <p>Hello <span id="1">name</span> you are <span id="2">age</span></p>
    </body>
</html> 
```

我一直在尝试像这样使用`HTMLDocument`该类`javax.swing.text`：

```
Element e;
e = doc.getElement(document.getDefaultRootElement(), Attribute.ID, "1");
document.setInnerHTML(element, "John");
e = doc.getElement(document.getDefaultRootElement(), Attribute.ID, "2");
document.setInnerHTML(element, "99"); 
```

但返回的元素是叶元素，不允许设置 innerHTML。不幸的是，文档、阅读器和解析器都是由第 3 方提供的，所以我无法真正修改它。

所以，我所希望的是其他人也有类似的问题，并且可以推荐一个替代库来做到这一点？

在此先感谢，B。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-02T12:36:33.767

你真的不能用 java.swing.text.HTMLDocument 做到这一点吗？

我从来没有尝试过，但是通过 API 阅读了一些类似的东西

```
document.replace(e.getStartOffset(), e.getEndOffset()-e.getStartOffset(), "John", null) 
```

而不是使用 setInnerHtml() 可以工作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-02T10:57:04.503

你试过[HTML 解析器](http://htmlparser.sourceforge.net/)吗？它是一个健壮的、开源的 Java 的 HTML 解析库。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-02T11:13:20.940

HTMLParser 是一个很棒的库，但它是 LGPL，它可能不适合某些商业项目。

如果您的 html 格式正确，那么您可以进入 Dom4J 遍历节点，如果您的 HTML 格式不正确，您可以将 Tidy 与 Dom4J 结合使用

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-02T11:18:10.350

我在[TagSoup](http://home.ccil.org/~cowan/XML/tagsoup/)的当前项目中运气不错。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-06-30T13:41:32.867

I used [JTidy](http://jtidy.sourceforge.net/) very successfully. It takes in HTML, removes out the crap, so you have a proper DOM object and then simply use XPath to alter your targets.

# asp.net-mvc - ASP.NET MVC – Set Selected Value of Cascading Drop-Down

> ID：709234
> 
> 赞同：3
> 
> 时间：2009-04-02T10:45:13.050
> 
> 标签：asp.net-mvc, cascadingdropdown

I'm working on an ASP.NET MVC application and using NHibernate.

I’m working on a cascading drop-down and have used Method 1 in the following website: [link text](http://stephenwalther.com/blog/archive/2008/09/07/asp-net-mvc-tip-41-creating-cascading-dropdown-lists-with-ajax.aspx)

Everything is working correctly, I just wondered if it was possible to set the cascading drop-down to a value stored in a database? For example the list would be blank on a create page, but on an edit page the selected value would be set to a value in a database.

I have updated the code below:

CascadingDropDownList.js

```
 function bindDropDownList(e, targetDropDownList, selectedValue) {
var key = this.value;
var allOptions = targetDropDownList.allOptions;
var option;
var newOption;
targetDropDownList.options.length = 0;

for (var i = 0; i < allOptions.length; i++) {
    option = allOptions[i];
    if (option.key == key) {
        newOption = new Option(option.text, option.value,selectedValue);
        targetDropDownList.options.add(newOption);
    }
} 
```

}

JavascriptExtenstions.cs

```
public static class JavaScriptExtensions
{
    public static string CascadingDropDownList(this HtmlHelper helper, string name, string associatedDropDownList)
    {
        var sb = new StringBuilder();

        // render select tag
        sb.AppendFormat("<select name='{0}' id='{0}'></select>", name.Replace("'",""));
        sb.AppendLine();

        // render data array
        sb.AppendLine("<script type='text/javascript'>");
        var data = (CascadingSelectList)helper.ViewDataContainer.ViewData[name.Replace("'","")];
        var listItems = data.GetListItems();
        var colArray = new List<string>();
        foreach (var item in listItems)
            colArray.Add(String.Format("{{key:'{0}',value:'{1}',text:'{2}'},selected:'{3}'}", item.Key, item.Value,item.Text.Replace("'",""),item.Selected));
        var jsArray = String.Join(",", colArray.ToArray());
        sb.AppendFormat("$get('{0}').allOptions=[{1}];", name.Replace("'",""), jsArray);
        sb.AppendLine();
        sb.AppendFormat("$addHandler($get('{0}'), 'change', Function.createCallback(bindDropDownList, $get('{1}')));", associatedDropDownList, name.Replace("'",""));
        sb.AppendLine();
        sb.AppendLine("</script>");
        return sb.ToString();

    }
}
public class CascadingSelectList
{
    private IEnumerable _items;
    private string _dataKeyField;
    private string _dataValueField;
    private string _dataTextField;
    private string _dataSelected;

    public CascadingSelectList(IEnumerable items, string dataKeyField, string dataValueField, string dataTextField, string dataSelected)
    {
        _items = items;
        _dataKeyField = dataKeyField;
        _dataValueField = dataValueField;
        _dataTextField = dataTextField.Replace("'","");
        _dataSelected = dataSelected;
    }

    public List<CascadingListItem> GetListItems()
    {
        var listItems = new List<CascadingListItem>();
        foreach (var item in _items)
        {
            var key = DataBinder.GetPropertyValue(item, _dataKeyField).ToString();
            var value = DataBinder.GetPropertyValue(item, _dataValueField).ToString();
            var text = DataBinder.GetPropertyValue(item, _dataTextField).ToString().Replace("'","");
            var selected = DataBinder.GetPropertyValue(item, _dataSelected).ToString();
            listItems.Add(new CascadingListItem(key, value, text.Replace("'",""),selected));
        }
        return listItems;
    }
}

public class CascadingListItem
{
    public CascadingListItem(string key, string value, string text, string selected)
    {
        this.Key = key;
        this.Value = value;
        this.Text = text.Replace("'","");
        this.Selected = selected;
    }

    public string Key { get; set; }
    public string Value { get; set; }
    public string Text { get; set; }
    public string Selected { get; set; }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-02T11:06:54.433

您需要修改扩展方法以包含一个选定的值，如普通下拉菜单。

您还需要修改 javascript：

```
function bindDropDownList(e, targetDropDownList)  // Need to add extra parameter here.
{
    var key = this.value;
    var allOptions = targetDropDownList.allOptions;
    var option;
    var newOption;
    targetDropDownList.options.length = 0;

    for (var i=0; i < allOptions.length; i++) 
    {
        option = allOptions[i];
        if (option.key == key) 
        {
            newOption = new Option(option.text, option.value); // Need to set to selected here
        targetDropDownList.options.add(newOption);
    }
} 
```

}

您需要在此处将额外参数传递给 javascript 函数：

```
sb.AppendFormat("$addHandler($get('{0}'), 'change', Function.createCallback(bindDropDownList, $get('{1}')));", associatedDropDownList, name); 
```

# asp.net - 使用 c# .NET 从 Exchange 2003 访问日历信息

> ID：709252
> 
> 赞同：0
> 
> 时间：2009-04-02T10:54:13.827
> 
> 标签：asp.net, calendar, exchange-server

我正在尝试在 C#.NET 中创建一个预订系统，该系统将在 MSQL 数据库中存储预订，但还将预订添加到相关用户的交换日历中。

创建新约会时，我希望它使用他们的交换日历检查用户的可用性。如果它们可用，它将在 .NET 系统中预订一个日期，并添加一个交换条目。

是否可以将 .NET 与 Exchange 2003 集成？

系统需要访问 5 个用户的日历并找到他们的可用性，是否可以设置为允许使用系统用户帐户或为此目的创建的新帐户？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-02T14:36:24.540

我已经使用 Exchange 网络服务在 Exchange 2007 上成功完成了这项工作，在谷歌上的快速搜索表明它们在 Exchange 2003 中可用。

您必须安装/启用 Web 服务，设置一个对其他用户具有模拟权限的帐户作为交换。

然后，您使用服务绑定连接到 Web 服务，该服务绑定使用这些主凭据并模拟其他用户。我在 MSDN 站点中找到了我需要的所有示例。

更新：看起来我所说的服务是在 2007 年推出的，抱歉。

# c# - 将图像保存到数据库

> ID：709256
> 
> 赞同：2
> 
> 时间：2009-04-02T10:56:04.367
> 
> 标签：c#, image, stream, storage, alphablending

我可以使用下面的代码将图像保存到数据库，将其流式传输到字节数组，但是当它回来时，它已经失去了图像周围的 alpha 混合并显示出块状的蓝色边框。

```
image.Save(stream, image.RawFormat); 
```

怎样才能把原图放回去？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2010-01-25T19:54:44.357

使用特定的`ImageFormat`，例如：

```
image.Save(stream, ImageFormat.Png); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-05T00:42:04.763

您是否绝对必须将其保存为字节数组...我听说过尝试这样做的几个问题。如何保存路径和其他图像信息，以便您的应用程序可以将其从目录中取出...

# c# - 将 int 转换为字符串和 C# 中的 ToString() 方法有什么区别

> ID：709263
> 
> 赞同：3
> 
> 时间：2009-04-02T10:59:42.627
> 
> 标签：c#

将 Int 转换为字符串和 ToString() 方法有什么区别？

例如 ：-

```
int MyInt = 10;
label1.Text = (string)MyInt;       // This Doesn't Work
label1.Text = MyInt.ToString();    // but this does. 
```

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2009-04-02T11:04:10.993

好吧，`ToString()`只是一个返回字符串的方法调用。它在中定义，`object`因此调用任何东西（空引用除外）总是有效的。

演员表操作员可以做以下四件事之一：

*   预定义的转换，`int`例如`byte`
*   可能会失败的执行时间引用转换，例如强制转换`object`为`string`，它检查目标对象是否为适当的类型
*   编译时已知的用户定义转换（基本上调用具有特殊名称的静态方法）
*   可能会失败的拆箱转换，例如强制转换`object`为`int`

在这种情况下，您要求编译器发出代码以从 转换`int`为`string`. 上述选项均不适用，因此您会收到编译时错误。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-04-02T11:03:59.933

不同之处在于，使用强制转换，您要求编译器假设 int 实际上是一个字符串，但事实并非如此。

使用 ToString()，您要求 int 的字符串表示形式，它实际上是一个字符串 :)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-02T11:07:40.250

嗯，ToString() 正在调用一个方法，该方法返回整数的字符串表示形式。

当你转换时，你没有返回一个表示，你是说你想引用同一个对象（在这种情况下是值类型），但你想引用它作为不同的类型。

仅当您要转换的类型（目标类型）与被转换的对象类型相同或目标类型是转换对象的超类或接口时，转换才会成功。

实际上可以在提供源或目标类型声明隐式或显式转换的强制转换中进行转换，但 Int32 类型不会对 String 目标类型执行此操作。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-02T11:09:26.753

.ToString() 方法是在 System.Object 类型（所有 .NET 类型都从该类型派生）上实现的方法，并且可以在特定派生类型上重写。

因此，“int”类型有它自己的 .ToString() 方法，它知道所有关于 int 的信息，以及如何将它们转换为字符串表示形式。

使用 (string)myint 显式转换，您要求编译器强制将一种类型转换/转换为另一种类型（在这种情况下，将 int 转换为字符串）。它失败了，因为编译器说 string 和 int 是不兼容的类型。

因此，显式转换失败，因为编译器说 int*不是*字符串，但是 .ToString() 调用成功，因为 int 类型说它的值*可以表示*为字符串，并且这样做了！

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-02T11:30:37.653

该方法是编程中最有用的方法之一，许多其他语言（例如 Java）在该级别`ToString()`实现完全相同的方法。`Object`

您可以定义自己的，并且 C# 中的签名必须始终是这样的：

```
public override string ToString() 
```

这意味着此方法将覆盖 Object 类中的定义并返回一个字符串。在内部，您可以以任何您想要的方式操作您的字符串，然后返回结果。

此外，您可以在该整数上使用 ToString 的具体原因是因为在 C# 中，整数都是 Struct 的实例`Int32`。
看 as`Int32`是在一个类的同一级别，它可以有自己的方法，其中之一是 ToString()。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-04-02T12:12:18.147

如果您认为对象可能为 null 或者您的应用程序将出现示例，则永远不要使用 .ToString() 另一件事：

//模拟可能发生的问题
object obj = null; obj.ToString();

# apache-flex - 更改对象的属性和树更新

> ID：709268
> 
> 赞同：0
> 
> 时间：2009-04-02T11:01:10.953
> 
> 标签：apache-flex, tree

我有一个 ArrayCollection，它是 Tree 组件的 dataProvider。ArrayCollection 中的对象具有 _selected 属性。将对象的 _selected 属性设置为 true 后，应更新 Tree 组件（应突出显示特定行）。我怎么能做到这一点？我必须写一个 ItemRenderer 吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-02T12:35:50.210

您不必编写 itemRenderer。要设置高亮，Tree 组件的 selected 属性必须指向 ArrayCollection 中已选择的对象。是否要监听对象的 _selected 属性的更改或在设置 _selected 时添加它取决于您。

我现在有点着急，如果你需要，以后会添加更多。

# c# - 使用 Castle 记录 WCF 中抛出的异常（以及其他）

> ID：709277
> 
> 赞同：1
> 
> 时间：2009-04-02T11:05:45.310
> 
> 标签：c#, wcf, logging, log4net, castle

我正在编写一个 WCF Web 服务，我想知道是否有一种优雅（面向方面​​）的方式来使用 Castle 拦截器机制来记录我的 Web 方法抛出的异常？我知道`IInterceptor`接口，但在那里找不到任何异常信息。

我在 .NET 中见过[Castle、AOP 和 Logging](https://stackoverflow.com/questions/238755/castle-aop-and-logging-in-net)，但它只涵盖方法的参数。

是否有更好的（WCF 或 Castle 的）机制来执行此操作？顺便说一句，我正在使用 log4net 进行日志记录。

更新：我知道 WCF 的日志记录设施，但我更多的是寻找通用解决方案，而不仅仅是在 WCF 环境中。

提前致谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-03T10:56:31.557

如果您想在一般情况下使用 Castle Interceptors，您可以执行以下操作：

```
public void Intercept(IInvocation invocation)
{
   //do some preprocessing here if needed
   try
   {
      invocation.Proceed()
   }
   catch(Exception e)
   {
      LogException(e);
      throw;
   }
   finally
   {
      //do some postprocessing jf needed
   }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-02T11:11:00.120

您应该使用 WCF 跟踪和日志记录中的构建。然后，您可以使用 WCF 跟踪查看器，它将来自服务和客户端的日志拼凑在一起，以便您可以看到完整的消息流。

[http://www.devx.com/dotnet/Article/37389/0/page/6](http://www.devx.com/dotnet/Article/37389/0/page/6)

WCF中有IErrorHandler接口：

```
public interface IErrorHandler
{
    bool HandleError(Exception error, MessageFault fault);
    void ProvideFault(Exception error, ref MessageFault fault, ref string faultAction);
} 
```

更多细节在这里：[http ://www.extremeexperts.com/Net/Articles/ExceptionHandlingInWCF.aspx](http://www.extremeexperts.com/Net/Articles/ExceptionHandlingInWCF.aspx)

# c# - 用于多个绑定的 WCF Mex 端点

> ID：709279
> 
> 赞同：6
> 
> 时间：2009-04-02T11:06:10.613
> 
> 标签：c#, wcf, mex

我正在构建一个 WCF 服务，它将公开 BasicHttp 和 NetTcp 绑定。我还添加了两个相应的 Mex 端点，即

```
<service name="WCFTest.CalculatorService" behaviorConfiguration="WCFTest.CalculatorBehavior">
  <host>
    <baseAddresses>
      <add baseAddress = "http://localhost:8000/WCFTest/CalculatorService/" />
      <add baseAddress = "net.tcp://localhost:9000/WCFTest/CalculatorService/" />
    </baseAddresses>
  </host>

  <endpoint address ="basicHttpEP" binding="basicHttpBinding" contract="WCFTest.ICalculatorService"/>
  <endpoint address="mex" binding="mexHttpBinding" contract="IMetadataExchange"/>

  <endpoint address ="netTcpEP" binding="netTcpBinding" contract="WCFTest.ICalculatorService"/>
  <endpoint address="mex" binding="mexTcpBinding" contract="IMetadataExchange"/>        
</service> 
```

我真的需要添加 NetTcp Mex 端点和 BasicHttp Mex 端点吗？客户端会不会总是使用 Http mex 端点进行元数据发现，无论他们是否要使用 tcp 进行通信？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-02T13:25:28.703

是的，您可以只使用 HTTP mex 端点。我认为假设是您的客户端可以通过 HTTP 进行通信。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-20T11:53:08.707

不，您的代码中的假设是通信通道可以是 http 或 net tcp。

如果您不声明两者，则意味着您将服务/客户端限制为仅通过一个绑定进行通信。

# html - 产品列表中的块元素

> ID：709280
> 
> 赞同：0
> 
> 时间：2009-04-02T11:06:46.713
> 
> 标签：html, css

我有一个包含产品列表的页面。

`<li>`我决定使用无序列表而不是 div 来显示产品，但这样做有一个问题，因为我无法在，浮动链接等......）。

我的问题是：

1.  `<li>`在（例如`<span>`）中使用内联元素来实现这种可视化是否可能并且在语义上是正确的？
2.  使用 div 代替（以及其中的 H2、P 标签）在语义上是否正确？
3.  一般来说，您将如何标记每个产品包含的产品列表：
    1.  一个图像;
    2.  产品名称；和
    3.  一个链接“更多”。

提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-02T11:44:22.923

1.  HTML 最重要的部分是它具有语义意义。如果您想将内联元素显示为完全可以接受的块级元素，前提是它背后的 HTML 是有意义的。这是能够将内容与演示分开的重要部分。
2.  通常，如果您可以将某些内容描述为列表，那么它*应该*是 HTML 列表，`<ul>`a`<ol>`或`<dl>`. 这不是一个严格的规则，而是一个很好的指导方针。如果您不想遵循该准则，则可以使用`<div>`s，只要您不将块级元素放入内联元素中。
3.  保持标记尽可能简单，我会说它应该如下所示：

    ```
    <dl>
      <dt>Product name</dt>
      <dd>
        <img src="product.jpg" alt="Product name" />
        Description.
        <a class="read-more" href="#">Read more about Product name</a>
      </dd>
    </dl> 
    ```

有关样式`<dl>`s [Max Design 的“定义列表 - 误用或误解？”的更多信息](http://www.maxdesign.com.au/presentation/definition/) 有一个可能有用的不同样式的列表。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-02T11:14:32.763

1.  `<span>`是“HTML 的豆腐”，就像`<div>`. 它通常可以插入到任何地方，但如果您想确定，我建议您尝试一下，然后在[W3C 验证页面](http://validator.w3.org/)上测试 HTML 。

    或者更好的是，如果您使用的是 Firefox，请使用 Firefox 的[HTML Validator 插件](https://addons.mozilla.org/nl/firefox/addon/249)。我知道它说仅限 Windows，但在他们的网站上，也有适用于 Linux 和 OS X 的版本。

2.  是的。
3.  我会使用无序列表，就像您在这里所做的那样，或者使用[Data List](http://www.w3schools.com/TAGS/tag_dl.asp)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-02T11:16:39.277

dukevideo.com 上使用的模型是一种极其语义化的方式。

```
<ol>
   <li>
      <span id="lia">
         <span class="productImage">
            <a href="/Bikes/DVD/American-Chopper/American-Chopper-Series-1.aspx" title="American Chopper Complete Series 1">
               <img src="/images/imageCache/bddc1cee608a8fb5927d6521ff1f0eb0.jpg" alt="American Chopper Complete Series 1" />
            </a>
          </span>
          <span class="price">
          <dl class="prices">
            <dt class="hidden strikethru">Price:</dt>
            <dd class="price red">£29.36</dd>
            <dt class="hidden">Our Price:</dt>
            <dd class="price">£25.36</dd>
          </dl>
       </span>
       <span class="title">
          <a href="/Bikes/DVD/American-Chopper/American-Chopper-Series-1.aspx" title="American Chopper Complete Series 1">American Chopper Complete Series 1
          </a>
       </span>
     </span>
     <span id="lib">
       <input type="image" class="buyLink" src="/images/buy.png" alt="Add to Basket" id="AC1" name="buyProduct_AC1" value="buyProductAC1"  />
     </span>
  </li> 
```

（在真实站点上，标记已被重新制作 - 并且无效。我的继任者在 LI 中使用 DIV 而不是 SPAN）

这种语义标记很重，但是是超语义的。搜索引擎或屏幕阅读器可以很好地工作。它使我们能够以列表的形式区分产品规格的各个部分。

希望这些类能说明 CSS 正在做什么。例如： *.hidden - 隐藏屏幕内容，但不隐藏屏幕阅读器、搜索引擎 *.red - 使文本变为红色 *.strikethru - 删除文本，以说明大幅定价 *.title - 加粗字体

# php - 阿贾克斯搞砸了挪威字符

> ID：709286
> 
> 赞同：0
> 
> 时间：2009-04-02T11:09:42.087
> 
> 标签：php, javascript, character-encoding

我正在尝试从 a 获取值`<textarea>`并通过 XMLHttpRequest 将其传递到将内容添加到数据库的 PHP 页面。

但是，当它到达数据库时，“å æ ø”字符被转换为“Ã¥ Ã¦ Ã”。

我搜索了高低并尝试更改为UTF-8，尝试使用`htmlentities()`/`htmlspacialchars()`等的JavaScript版本，但无论我尝试做什么，结果总是一样的。

我的页面设置为 iso-8859-15，请求的 requestType 也是如此。

因为我在工作中不必过多地使用 Ajax，所以我从网上截取了设置过程。它看起来像这样：

```
var page_request = false;
var contentType = "application/x-www-form-urlencoded;charset=iso-8859-15";  

if (window.XMLHttpRequest)
{
  page_request = new XMLHttpRequest();
}

// If the Browser is Internet Explorer
else if (window.ActiveXObject)
{
  try
  {
    page_request = new ActiveXObject("Msxml2.XMLHTTP");
  }
  catch (e)
  {
    try
    {
      page_request = new ActiveXObject("Microsoft.XMLHTTP");
    }
    catch (e){}
  }
}
else 
{ 
  return false; 
}

page_request.open('POST', url, true);
page_request.setRequestHeader("Content-Type", contentType);
page_request.send(query); 
```

但是，在接收端的 PHP 文件和数据库中，特殊字符会被转换。

任何帮助深表感谢！我今天大部分时间都在尝试修复这个错误......

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-02T12:26:57.487

您的字符集声明在说谎。说内容在 ISO 中并不能神奇地使其成为 ISO。

您的`query`变量似乎采用 UTF-8 编码。这是意料之中的，因为 Javascript 字符串始终是 Unicode，并且函数`encodeURIComponent()`（需要正确格式化 GET 和 POST 请求）使用 UTF-8。

恕我直言，最好的办法是完全、永远停止使用 ISO 编码。

如果您还不能这样做，您需要自己在 Javascript 中序列化数据或在服务器上接收发布的数据时将 UTF-8 转换为 ISO。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-02T11:25:26.137

您需要`encodeURIComponent`在您的`textarea`内容上使用。并使用 UTF-8。

* * *

## 回答 #3

> 赞同：-2
> 
> 时间：2009-04-02T11:21:13.713

首先，本网站支持语法高亮，但前提是您选择代码并单击小 101|010 符号。

其次，我会推荐 ISO-8859-1，但我并不是说它可以保证工作......

# asp.net-mvc - 视图中的条件

> ID：709287
> 
> 赞同：0
> 
> 时间：2009-04-02T11:09:54.723
> 
> 标签：asp.net-mvc

我对 ASP MVC 相当陌生，想知道在您的视图中处理条件语句的最佳方法是什么？我确信没有一种万能的方法，但是对于简单的检查，让 If-Then-Else 语句乱扔视图是否明智？

例如，假设我有一个列表，如果设置了模型属性之一，则希望在其中一个列表项上设置类。

```
<% if (myModel.MyProperty == 1) { %>
   <li class="myClass">
<% } else { %>
   <li>
<% } %> 
```

这是解决这个问题的最佳方法，还是有更好的方法？我只是担心，如果您认为有许多这样的条件，它会开始看起来很混乱。

提前感谢您的任何建议。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-03T16:26:36.943

如果你真的想要一个更清晰的视图，你可以创建一个助手：

```
public static class MyHelpers {
    // Need a more descriptive name (based on what you're generating)
    public static string MyListItemHelper(this HtmlHelper helper, bool condition) {
        if(condition) {
            return "<li class=\"myClass\">";
        } else {
            return "<li>";
        }
    }
} 
```

那么你的观点就是：

```
<%= Html.MyListItemHelper(myModel.MyProperty == 1) %>
    ...
</li> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-02T11:14:46.990

我会把它放在你的控制器中。假设你不介意拥有

```
<li class=""> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-02T11:17:00.777

```
<ul>
    <% foreach (var item in Model.Items) { <%
    <li<%= item.HasProperty ? " class="\class\"" : "" %>>
        <%= Html.Encode(item.Name) %>
    </li>
    <% } %>
</ul> 
```

# asp.net-mvc - 如何覆盖“需要 A 值”。在 asp.net mvc 视图中验证日期时间格式时？

> ID：709293
> 
> 赞同：6
> 
> 时间：2009-04-02T11:12:54.437
> 
> 标签：asp.net-mvc

我正在 mvc 视图中检查日期时间字段的日期时间格式，如下所示：

```
 If contactToValidate.LastUpdated = Nothing OrElse Not IsDate(contactToValidate.LastUpdated) OrElse CType(contactToValidate.LastUpdated, DateTime) = DateTime.MinValue Then
             _validationDictionary.AddError("AddErrorValue", "Date Format is not Correct!")
        End If 
```

但是，如果在 View 中 LastUpdated 的输入，在我自己的错误（“日期格式不正确！”）旁边留空，则会显示默认错误消息：需要一个值。我相信这是 mvc 框架自动检查数据类型转换的原因，但是当我检查 LastUpdated 文本框的 null 和 datetime 格式时，我不希望显示此错误消息。我只想要我自己的。我怎样才能做到这一点？谢谢

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-04-02T11:53:56.083

您可能会收到此消息，因为日期字段被绑定到您的演示模型上的不可为空的 DateTime。如果将该字段或属性的类型更改为可为空的 DateTime，则不应再收到此消息。

无论如何，您可以通过在您的演示模型上实现[IDataErrorInfo来自定义用户看到的消息。](http://www.asp.net/Learn/mvc/tutorial-37-vb.aspx)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-11-12T10:29:12.203

我也遇到了这个问题 - 它似乎确实发生在模型字段绑定到数据模型上的不可空类型的情况下。

我绕过这个的方法是清除 ModelState 中的错误信息。在我的控制器方法的异常处理程序中，我这样做：

```
foreach (var state in ModelState.Values)
{
  if (state.Errors.Count > 0) 
    state.Errors.Clear();
} 
```

它删除了默认的验证行为，然后运行我自己的。请注意，如果您自己的验证未涵盖您的所有字段，这样做会留下错误但没有描述。但是，如果您只想清除单个字段，则可以在 ModelState 字典中检查其名称，然后清除该字段。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-12-10T16:54:35.997

不幸的是，无论你从哪里看，这个问题的大部分答案都是“实现 IDataErrorInfo！”。

例如，如果您尝试在绑定到整数属性的文本框字段中键入文本字符串，则会出现同样的问题。简单地说，如果 MVC 无法将用户值转换为正确的类型，它会生成这些（非常无用的）泛型错误，并且永远不会调用 IDataErrorInfo 成员。

覆盖这些无用的消息肯定很麻烦，我个人认为最好的答案是简单地实现一些客户端验证来处理这些场景。它生成这些消息的情况非常一致且易于预测：

*   用户没有为不可为空的字段提供值
*   用户输入或选择了一个不可转换为基础类型的值（例如：文本转换为数字字段）

另外，无论如何，客户端验证只是一种好习惯。如果用户没有启用 javascript，那么如果您使用 Html.ValidationMessage() 和/或设置输入字段的样式来识别问题，他们肯定能够找出问题所在。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-06-29T20:40:57.133

我尝试在我的部分类上实现 IDataErrorInfo，但对于没有在其中选择任何内容的下拉列表，我仍然收到流氓“需要一个值”错误消息，即返回 null 而不是外键的整数。

我已经在我的 Create 操作的第一行这样做了：

```
public ActionResult Create([Bind(Exclude="Id")]MyEntity myEntityToCreate)
{
    foreach (string key in ModelState.Keys)
    {
        ModelState[key].Errors.Clear();
} 
```

然后依靠我在保存对象时触发的自定义模型验证代码在未选择下拉项时向 ModelState 集合添加有意义的错误消息。

这可能不是最好的方法。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2010-03-07T22:20:16.867

如果您想从验证中排除一个属性，那么如果您使用模型绑定，那么最好的方法就是：

```
public ActionResult Create([Bind(Exclude="LastUpdated")] Contact contactToValidate)
{

} 
```

另一方面，如果您使用的是 UpdateModel 或 TryUpdateModel，则可以使用：

```
string prefix = string.Empty;
string[] includedProperties = new string[0];
string[] excludedProperties = new [] { "LastUpdated" };

TryUpdateModel<Contact>(contactToValidate, prefix, includedProperties, excludedProperties); 
```

请注意，由于您正在为包含的属性发送一个空数组，因此您实际上包含了所有属性，然后从该集合中获取一个排除的属性。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-04-02T16:21:40.973

我相信你要找的是这个

```
ViewData.ModelState.AddModelError("FieldName", "Date Format is not Correct!"); 
```

这将强制`<%=Html.ValidationMessage("FieldName") %>`显示您的错误消息。

编辑：我刚刚检查过，这实际上并不能解决问题。您应该参考[Craig Stuntz](https://stackoverflow.com/users/7714/craig-stuntz)关于不可为空类型和[IDataErrorInfo](http://www.asp.net/Learn/mvc/tutorial-37-vb.aspx)的回答，然后您可以为空字段添加自己的错误消息。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2011-01-31T10:20:17.643

我知道这有点晚了。但真正的问题是在绑定模型中有一个名为“Id”的属性。只需将您拥有的任何“Id”字段重命名为 EntityId 或类似的名称。并且 MVC 不会自动验证该字段。

# c++ - 将带有结构的向量序列化为 .dat 文件时，我做错了什么？

> ID：709297
> 
> 赞同：0
> 
> 时间：2009-04-02T11:13:26.960
> 
> 标签：c++, serialization, vector, fstream

如果我输入

说明：苹果

数量：10

批发成本：30

零售成本：20

添加日期：十二月

这些是我的 .dat 文件中的内容：

**1Apple103020十二月**

但是当我加载我的程序时，它没有正确加载结构，导致我的列表中有 0 个项目。这是它应该看起来的样子，还是我做错了什么。

代码：

```
#include "stdafx.h"
#include <iostream>
#include <fstream>
#include <string>
#include <vector>

using namespace System;
using namespace std;
#pragma hdrstop

bool isValidChoice(int size, int choice);

template<typename T>
void writeVector(ofstream &out, const vector<T> &vec);

template<typename T>
vector<T> readVector(ifstream &in);

template<typename T>
vector<T> addItem(vector<T> &vec);

template<typename T>
void printItemDescriptions(vector<T> &vec);

template<typename T>
int displayRecord(vector<T> &vec);

struct InventoryItem {
    string Description;
    int Quantity;
    int wholesaleCost;
    int retailCost;
    string dateAdded;
} ;

int main(void)
{
    cout << "Welcome to the Inventory Manager extreme! [Version 1.0]" << endl;
    ifstream in("data.dat");
    if (in.is_open()) { cout << "File \'data.dat\' has been opened successfully." << endl; } else { cout << "Error opening data.dat" << endl;}
    cout << "Loading data..." << endl;
    vector<InventoryItem> structList = readVector<InventoryItem>( in );
    cout <<"Load complete." << endl << endl;
    in.close();

    while (1)
    {

        string line = "";
        cout << "There are currently " << structList.size() << " items in memory.";
        cout << endl << endl;
        cout << "Commands: " << endl;
        cout << "1: Add a new record " << endl;
        cout << "2: Display a record " << endl;
        cout << "3: Edit a current record " << endl;
        cout << "4: Delete a record " << endl;
        cout << "5: Save current information " << endl;
        cout << "6: Exit the program " << endl;
        cout << endl;
        cout << "Enter a command 1-6: ";

        getline(cin , line);

        int rValue = atoi(line.c_str());

        system("cls");

        ofstream out("data.dat");

        switch (rValue)
        {
            case 1:
                addItem(structList);
                break;
            case 2:
                displayRecord(structList);
                break;
            case 3:
                break;
            case 4:
                break;
            case 5:
                if (!structList.size()) { cout << "There are no items to save! Enter one first!" << endl << endl; system("pause"); system("cls"); break; }
                writeVector(out , structList);
                break;
            case 6:
                return 0;
            default:
                cout << "Command invalid. You can only enter a command number 1 - 6\. Try again. " << endl;
        }

        out.close();
    }

    system("pause");

    return 0;
}

template<typename T>
void writeVector(ofstream &out, const vector<T> &vec)
{
    out << vec.size();

    for(vector<T>::const_iterator i = vec.begin(); i != vec.end(); i++)
    {
        out << *i;
    }
    cout << "Save completed!" << endl << endl;
}

ostream &operator<<(ostream &out, const InventoryItem &i)
{
    out << i.Description;
    out << i.Quantity;
    out << i.wholesaleCost << i.retailCost;
    out << i.dateAdded;
    return out;
}

istream &operator>>(istream &in, InventoryItem &i)
{
    in >> i.Description;
    in >> i.Quantity;
    in >> i.wholesaleCost >> i.retailCost;
    in >> i.dateAdded;
    return in;
}

template<typename T>
vector<T> readVector(ifstream &in)
{
    size_t size;
    if (in.fail())
    {
    in >> size;
    } else {
        size = 0;
    }

    vector<T> vec;
    vec.reserve(size);

    for(unsigned int i = 0; i < size; i++)
    {
        T tmp;
        in >> tmp;
        vec.push_back(tmp);
    }

    return vec;
}

template<typename T>
vector<T> addItem(vector<T> &vec)
{
    system("cls");

    string word;
    unsigned int number;

    InventoryItem newItem;

    cout << "-Add a new item-" << endl << endl;
    cout << "Enter the description for the item: ";
    getline (cin , word);
    newItem.Description = word;

    cout << endl;
    cout << "Enter the quantity on hand for the item: ";
    getline (cin , word);
    number = atoi(word.c_str());
    newItem.Quantity = number;

    cout << endl;
    cout << "Enter the Retail Cost for the item: ";
    getline (cin , word);
    number = atoi(word.c_str());
    newItem.retailCost = number;

    cout << endl;
    cout << "Enter the Wholesale Cost for the item: ";
    getline (cin , word);
    number = atoi(word.c_str());
    newItem.wholesaleCost = number;

    cout << endl;
    cout << "Enter current date: ";
    getline (cin , word);
    newItem.dateAdded = word;

    vec.push_back(newItem);

    return vec;
}

template<typename T>
void printItemDescriptions(vector<T> &vec)
{
    int size = vec.size();

    if (size)
    {
        cout << "---------------------------------" << endl;
        cout << "|      ~ Item Descriptions ~    |" << endl;
        cout << "---------------------------------" << endl;
        cout << "*********************************" << endl;
        for (int i = 0 ; i < size ; i++)
        {
            cout << "(" << i+1 << ")" << ": " << vec[i].Description << endl;
        }
        cout << "*********************************" << endl << endl;
    }
}

template<typename T>
int displayRecord(vector<T> &vec)
{
    string word = "";
    string quit = "quit";
    int choice = 1;
    int size = vec.size();

    if (size)
    {
        printItemDescriptions(vec);
        cout << endl;

        while (1)
        {
            cout << "Type \"exit\" to return to the Main Menu." << endl << endl;
            cout << "Enter \"list\" to re-display the items." << endl << endl;
            cout << endl;
            cout << "Pick the number of the item you would like to display: ";
            getline (cin , word);

            if (convertToLower(word) == "exit") { system("cls"); return 0; }
            if (convertToLower(word) == "list") { system("cls"); displayRecord(vec); }

            choice = atoi(word.c_str());

            if (isValidChoice(size, choice))
            {
                system("cls");
                cout << endl << "[Item (" << choice << ") details] " << endl << endl;
                cout << "******************" << endl;
                cout << "*  Description   * " << vec[choice-1].Description << endl;
                cout << "******************" << endl << endl;
                cout << "******************" << endl;
                cout << "*Quantity On Hand* " << vec[choice-1].Quantity << endl;
                cout << "******************" << endl << endl;
                cout << "******************" << endl;
                cout << "* Wholesale Cost * " << vec[choice-1].wholesaleCost << endl;
                cout << "****************** " << endl << endl;
                cout << "******************" << endl;
                cout << "*  Retail Cost   * " << vec[choice-1].retailCost << endl;
                cout << "****************** " << endl << endl;
                cout << "******************" << endl;
                cout << "*  Data Added    * " << vec[choice-1].dateAdded << endl;
                cout << "****************** " << endl << endl;
            } else { system("cls"); cout << "That item doesn't exist!" << endl; cout << "Pick another item or enter \"list\" to see available items." << endl << endl; }
        }
    } else { cout << "There are currently no items to display." << endl << endl; system("pause"); system("cls"); return 0; }

    return 1;
}

bool isValidChoice(int size, int choice)
{
    for (int i = 0 ; i <= size ; i++)
    {
        if (choice == size) { return true; }
    }
    return false;
}

string convertToLower(string word)
{
    for (unsigned int i = 0 ; i < word.size() ; i++)
    {
        word[i] = tolower(word[i]);
    }

    return word;
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-02T11:16:57.780

在您的阅读功能中：

```
 if (in.fail()) 
```

应该：

```
 if ( ! in.fail()) 
```

或更好：

```
int n;

if ( ! (in >> n) ) {
  n = 0;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-02T11:19:16.980

为结构项目使用一些分隔符，例如“”（空格）

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-02T11:20:25.260

保存 DAT 文件时，您需要在字符串之间添加一个空格（空格/制表符）。

使用 operator>> 读取字符串时，它将读取一个字符串，直到找到第一个空白字符（空格/制表符/EOL）。

从您的代码：

```
ostream &operator<<(ostream &out, const InventoryItem &i)
{
    out << i.Description << ' ';
    out << i.Quantity << ' ';
    out << i.wholesaleCost  << ' ' << i.retailCost  << ' ';
    out << i.dateAdded  << ' ';
    return out;
} 
```

**更新**

即便如此，例如，当使用 operator>> 加载描述时，描述将不完整（加载到保存的描述文本中的第一个空格）。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-02T11:26:50.987

同样，序列化是一项不那么简单的任务。如果您可以花时间学习图书馆。

我不会重新发布我对您提出的上一个问题的[答案](https://stackoverflow.com/questions/708229/im-trying-to-read-write-the-size-of-multiple-structs-to-a-dat-file-i-am-gettin/708639#708639)，但我相信您真的应该看看它。它解释了您面临的一些问题并提供了解决方案。

# django - 如何在我的 Django 应用程序中使用 Dojo？

> ID：709300
> 
> 赞同：2
> 
> 时间：2009-04-02T11:14:29.690
> 
> 标签：django, dojo

如何在我的 Django 应用程序中使用 Dojo？请向我展示有关如何执行此操作的综合示例。
任何指向此组合示例代码的链接将不胜感激

注意：我也不介意使用 Dojango 的示例。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-04-16T12:46:25.443

You may have seen this blog post: [http://blog.uxebu.com/2008/07/26/ajax-with-dojango/](http://blog.uxebu.com/2008/07/26/ajax-with-dojango/)

You can also try the various examples, blog articles and docs here. [http://code.google.com/p/dojango/](http://code.google.com/p/dojango/)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2011-09-19T14:42:19.590

1.  [将dojango](http://dojango.googlecode.com/files/dojango-0.5.2.tar.gz)复制到你的项目根目录
2.  `settings.py`在您的>中包含以下 lin `MIDDLEWARE_CLASSES`：`'dojango.middleware.DojoCollector',`
3.  `settings.py`在您的>中包含以下 lin `TEMPLATE_DIRS`：（`'/<project_location>/dojango/templates/dojango',`这样您就可以看到一些不错的演示）
4.  `settings.py`在您的>中包含以下 lin `INSTALLED_APPS`：`'dojango',`
5.  更改`from django.forms import *`为`from dojango.forms import *`在您的`forms.py`

# string - 使用 basic_string 时出现错误 c2664 vc++ 9.0 中的 abc("hello")

> ID：709303
> 
> 赞同：0
> 
> 时间：2009-04-02T11:15:04.883
> 
> 标签：string, visual-c++, visual-c++-2008, c2664

嗨，在 Visual Studio 2008 中编译此代码时，我收到以下错误

```
#include<iostream>
#include<string>
using namespace std;
void main()
{
     basic_string<wchar_t> abc("hello world");
     cout<<abc;
     return;
} 
```

错误 C2664: 'std::basic_string<_Elem,_Traits,_Ax>::basic_string(std::basic_string<_Elem,_Traits,_Ax>::_Has_debug_it)' : 无法将参数 1 从 'const char [12]' 转换为' std::basic_string<_Elem,_Traits,_Ax>::_Has_debug_it'

错误 C2679：二进制“<<”：未找到采用“std::basic_string<_Elem,_Traits,_Ax>”类型的右侧操作数的运算符（或没有可接受的转换）

我做错了什么？

谁能帮我理解背后发生的事情？谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-02T11:22:38.173

尝试：

> 错误 C2664：

```
basic_string<wchar_t> abc(L"hello world"); 
```

> 错误 C2679：

```
cout << abc.c_str(); 
```

（由于编译器不能/不会为每个用户创建的类型提供合适的重载。但是，由于这也是标准类型，即 ie `wstring`，我查找了适当的标头，发现没有合适`operator<<`的采用 a`string`或 a `wstring`。）

和使用`int main`，所以你有：

```
int main(void)
{        
     basic_string<wchar_t> abc(L"hello world");
     cout << abc.c_str() << endl;
     return 0;
} 
```

不过，您确实应该使用`std::wstring`而不是重新发明轮子。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-02T11:28:24.727

wchar_t 指定宽字符类型。默认情况下，指向文字字符串的 const char 指针不是宽的，但您可以通过在其前面加上 'L' 来告诉编译器将其视为宽字符数组。

所以只需更改为

```
basic_string<wchar_t> abc(L"hello world"); 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-03T17:17:53.420

问题是您混合了宽字符和（窄？）字符类型。

对于您的`basic_string`，请使用：

```
// note the L"..." to make the literal wchar_t
basic_string<wchar_t> abc(L"hello world");  

// note that basic_string is no longer wchar_t
basic_string<char> abc("hello world"); 
```

或等价物：

```
// wstring is just a typedef for basic_string<wchar_t>
wstring abc(L"hello world");

// string is just a typedef for basic_string<char>
string abc("hello world"); 
```

并将输出更改为也匹配：

```
cout << abc;   // if abc is basic_string<char>

wcout << abc;  // if abc is basic_string<wchar_t> 
```

# optimization - 流式传输的有效内存带宽使用

> ID：709308
> 
> 赞同：5
> 
> 时间：2009-04-02T11:17:40.477
> 
> 标签：optimization, streaming, cpu-cache, memory-bandwidth

我有一个流过 250 MB 数据的应用程序，对数据块（每个只有 2 个 32 位字）应用一个简单而快速的神经网络阈值函数。基于（非常简单的）计算的结果，该块不可预测地被推入 64 个 bin 之一。所以它是一个大流输入和 64 个较短（可变长度）的流输出。

使用不同的检测功能重复多次。

计算受内存带宽限制。我可以这么说，因为即使我使用计算量更大的判别函数，速度也没有变化。

**构建新流的写入以优化我的内存带宽的最佳方法是什么？**我特别认为了解缓存使用和缓存行大小可能在其中发挥重要作用。想象一下最坏的情况，我有 64 个输出流，运气不好，许多都映射到同一个缓存行。然后，当我将接下来的 64 位数据写入流时，CPU 必须将过时的缓存行刷新到主内存，并加载到正确的缓存行中。每个都使用 64 字节的带宽......所以我的带宽受限应用程序可能会浪费 95% 的内存带宽（不过，在这个假设的最坏情况下）。

甚至很难衡量效果，因此围绕它设计的方法更加模糊。还是我什至在追逐一个幽灵瓶颈，以某种方式硬件优化得比我好？

如果这有什么不同，我正在使用 Core II x86 处理器。

编辑：这是一些示例代码。它流过一个数组并将其元素复制到伪随机挑选的各种输出数组。使用不同数量的目标箱运行相同的程序会产生不同的运行时间，即使完成了相同数量的计算和内存读取和写入：

2 个输出流：13 秒
8 个输出流：13 秒
32 个输出流：19 秒
128 个输出流：29 秒
512 个输出流：47 秒

使用 512 与 2 个输出流之间的差异是 4 倍，（可能？？）由缓存行驱逐开销引起。

```
#include <stdio.h>
#include <stdlib.h>
#include <ctime>

int main()
{
  const int size=1<<19;
  int streambits=3;
  int streamcount=1UL<<streambits; // # of output bins
  int *instore=(int *)malloc(size*sizeof(int));
  int **outstore=(int **)malloc(streamcount*sizeof(int *));
  int **out=(int **)malloc(streamcount*sizeof(int));
  unsigned int seed=0;

  for (int j=0; j<size; j++) instore[j]=j;

  for (int i=0; i< streamcount; ++i) 
    outstore[i]=(int *)malloc(size*sizeof(int));

  int startTime=time(NULL);
  for (int k=0; k<10000; k++) {
    for (int i=0; i<streamcount; i++) out[i]=outstore[i];
    int *in=instore;

    for (int j=0; j<size/2; j++) {
      seed=seed*0x1234567+0x7162521;
      int bin=seed>>(32-streambits); // pseudorandom destination bin
      *(out[bin]++)=*(in++);
      *(out[bin]++)=*(in++);
    }

  }
  int endTime=time(NULL);
  printf("Eval time=%ld\n", endTime-startTime);
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-02T14:52:10.040

当您写入 64 个输出箱时，您将使用许多不同的内存位置。如果这些 bin 基本上是随机填充的，这意味着您有时会有两个 bin 可以共享相同的缓存行。问题不大；Core 2 L1 高速缓存是 8 路关联的。这意味着您只会遇到第 9 个缓存行的问题。任何时候只有 65 次实时内存引用（1 次读取/64 次写入），8 路关联就可以了。

L2 缓存显然是 12 路关联的（总共 3/6MB，所以 12 并不是一个奇怪的数字）。因此，即使您在 L1 中发生冲突，很有可能您仍然没有触及主内存。

但是，如果您不喜欢这样，请重新排列内存中的 bin。与其按顺序排列每个 bin，不如将它们交错。对于 bin 0，将块 0-15 存储在偏移量 0-63 处，但将块 16-31 存储在偏移量 8192-8255 处。对于 bin 1，将块 0-15 存储在偏移量 64-127 等处。这只需要一些位移和掩码，但结果是一对 bin 共享 8 个缓存行。

在这种情况下，加快代码速度的另一种可能方法是 SSE4，尤其是在 x64 模式下。您将获得 16 个寄存器 x 128 位，并且您可以优化读取 (MOVNTDQA) 以限制缓存污染。不过，我不确定这是否会对读取速度有很大帮助——我希望 Core2 预取器能够捕捉到这一点。读取顺序整数是最简单的访问方式，任何预取器都应该优化它。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-06T21:01:09.770

您是否可以选择将输出流编写为带有内联元数据的单个流以识别每个“块”？如果你要读取一个“块”，在它上面运行你的阈值函数，而不是将它写入一个特定的输出流，你只需写它属于哪个流（1字节），然后是原始数据，你会认真的减少你的颠簸。

我不建议这样做，除非您说过您必须多次处理这些数据。在每次连续运行时，您读取输入流以获取 bin 编号（1 个字节），然后在接下来的 8 个字节上为该 bin 执行您需要执行的任何操作。

就这种机制的缓存行为而言，由于您只在两个数据流中滑动，并且除第一种情况外，写入的数据与读取的数据一样多，因此硬件将为您提供您可能希望的所有帮助就预取、缓存行优化等而言。

如果每次处理数据时都必须添加额外的字节，那么最坏情况下的缓存行为就是平均情况。如果你能负担得起存储空间，这对我来说似乎是一个胜利。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-06T20:42:27.460

如果你真的绝望，这里有一些想法......

您可能会考虑升级硬件。对于与您的流应用程序有些相似的流应用程序，我发现通过更改为 i7 处理器可以大大提高速度。此外，对于内存受限的工作，AMD 处理器据称比 Core 2 更好（尽管我自己最近没有使用它们）。

您可能会考虑的另一个解决方案是使用 CUDA 之类的语言在显卡上进行处理。显卡经过调整以具有非常高的内存带宽并进行快速浮点数学运算。相对于直接的非优化 C 实现，预计 CUDA 代码的开发时间是 5 到 20 倍。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-06T20:25:32.040

您可能想探索将文件映射到内存中。这样，内核可以为您处理内存管理。内核通常最清楚如何处理页面缓存。如果您的应用程序需要在多个平台上运行，则尤其如此，因为不同的 Oses 以不同的方式处理内存管理。

有像 ACE ( [http://www.cs.wustl.edu/~schmidt/ACE.html](http://www.cs.wustl.edu/~schmidt/ACE.html) ) 或 Boost ( [http://www.boost.org](http://www.boost.org) ) 这样的框架，它们允许您编写在平台无关的方式。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-11-06T06:10:09.573

这种情况的真正答案是编写几种方法并对其计时。你显然已经做到了。像我这样的人所能做的就是建议尝试其他方法。

例如：即使没有缓存抖动（您的输出流映射到相同的缓存行），如果您正在写入大小整数，大小 = 1<<19 和 sizeof(int)=4，32 位 - 即如果您正在写入 8MB 的数据，实际上是在读取 8MB 然后写入 8MB。因为如果您的数据在 x86 处理器上的普通 WB (WriteBack) 内存中，要写入一行，您首先必须读取该行的旧副本——即使您要将读取的数据丢弃。

您可以通过 (a) 使用 WC 内存（可能很难设置）或 (b) 使用 SSE 流存储，即 NT（非临时）存储来消除这种不必要的 RFO 读取流量。MOVNT* - MOVNTQ、MOVNTPS 等（还有一个 MOVNTDQA 流加载，虽然使用起来更痛苦。）

我更喜欢我刚刚通过谷歌搜索找到的这篇论文[http://blogs.fau.de/hager/2008/09/04/a-case-for-the-non-temporal-store/](http://blogs.fau.de/hager/2008/09/04/a-case-for-the-non-temporal-store/)

现在：MOVNT* 适用于 WB 内存，但像 WC 内存一样工作，使用少量的写入组合缓冲区。实际数量因处理器型号而异：第一个 Intel 芯片 P6（又名 Pentium Pro）上只有 4 个。Ooof... Bulldozer 的 4K WCC（​​写入组合缓存）基本上提供了 64 个写入组合缓冲区，根据[http://semiaAccurate.com/forums/showthread.php?t=6145&page=40](http://semiaccurate.com/forums/showthread.php?t=6145&page=40)，虽然只有 4 个经典 WC 缓冲区。但是[http://www.intel.com/content/dam/doc/manual/64-ia-32-architectures-optimization-manual.pdf](http://www.intel.com/content/dam/doc/manual/64-ia-32-architectures-optimization-manual.pdf)说有些进程有 6 个 WC 缓冲区，有些有 8 个。无论如何......那里是少数，但不是那么多。通常不是 64。

但是这里有一些你可以尝试的东西：结合自己实现写。

a）写入一组 64 个（#streams）缓冲区，每个缓冲区大小为 64B（缓存行大小），或者可能是 128 或 256B。让这些缓冲区位于普通的 WB 内存中。您可以通过普通商店访问它们，但如果您可以使用 MOVNT*，那就太好了。

当其中一个缓冲区已满时，将其作为突发复制到内存中流真正应该去的地方。使用 MOVNT* 流媒体存储。

这将最终执行 * N 字节存储到临时缓冲区，命中 L1 缓存 * 读取 64*64 字节以填充临时缓冲区 * 从临时缓冲区读取的 N 字节，命中 L1 缓存。* N 个字节通过流存储写入 - 基本上直接进入内存。

即 N 字节缓存命中读取 + N 字节缓存命中写入 + N 字节缓存未命中

与 N 字节缓存未命中读取 + N 字节缓存写入读取。

减少 N 字节的缓存未命中读取可能比弥补额外开销更重要。

# excel - 将 XLL 插件功能转换为本机 VB 模块：刷新公式的问题

> ID：709324
> 
> 赞同：1
> 
> 时间：2009-04-02T11:24:42.177
> 
> 标签：excel, vb6, xll

我有一个 .xll 插件，它注册了我们在许多地方的 excel 表中使用的一些函数。性能很差，而且我们没有原始代码，所以我们通过在模块中编写VB中的函数来复制功能。这些功能按预期工作，性能要好得多。

问题是工作表不能自动识别新功能。例如，假设一个单元格的公式是*“=CustomFunction()”*，它之前在 xll 中定义，现在已经在 VB 中定义。这将继续显示为“#NAME”，除非我手动编辑单元格，然后按 Enter。然后它会正确地选择 VB 公式并进行计算。

重新计算公式的标准技巧：Ctrl/Alt/Shift/F9 不起作用。

有没有人经历过这种情况？知道如何解决这个问题吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-02T12:27:04.100

我会进行全局搜索并将 =CustomFunction 替换为 =TempCustomeFunction。然后将全局重命名回 =CustomFunction。这将强制 Excel 重新评估函数。（我有一个模糊的想法，您可能需要在他第一次替换后保存、关闭和重新启动，但请先尝试确定）。

我很确定我遇到了类似的问题，并为我解决了这个问题。我想如果你有很多工作簿要修复，你可能需要通过自动化来完成。

# .net - 在使用 NUnit 和 MSTest 进行单元测试之间切换

> ID：709331
> 
> 赞同：21
> 
> 时间：2009-04-02T11:28:15.960
> 
> 标签：.net, unit-testing, nunit, mstest

如何配置 .NET 解决方案（C#、.NET 2.0）以允许其他开发人员使用 NUnit 或 MSTest 对解决方案使用相同的单元测试？

背景：

在本项目中，部分开发者使用VS2005 Team Edition，部分开发者使用VS2005 Pro，因此并非所有开发者都能运行MSTest。鉴于这是一个企业项目，团队无法使用 TestDriven.net 或 ReSharper。我知道将这些产品中的任何一个与 VS 一起使用都可以解决此问题，但考虑到授权购买许可证所需的时间，购买这些产品中的任何一个都不是一个可行的选择。

提前感谢您的帮助，MagicAndi。

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2009-04-02T11:29:06.207

[我找到的最佳解决方案是使用我在本文](http://msdn.microsoft.com/en-us/magazine/cc163643.aspx)中找到的一段简单代码。只需在每个 .cs 测试文件的命名空间部分中使用此代码片段：

```
#if NUNIT
using TestClass = NUnit.Framework.TestFixtureAttribute;
using TestMethod = NUnit.Framework.TestAttribute;
using TestCleanup = NUnit.Framework.TearDownAttribute;
using TestInitialize = NUnit.Framework.SetUpAttribute;
using ClassCleanup = NUnit.Framework.TestFixtureTearDownAttribute;
using ClassInitialize = NUnit.Framework.TestFixtureSetUpAttribute;
#else
using Microsoft.VisualStudio.TestTools.UnitTesting;
#endif

using NUnitAssert = NUnit.Framework.Assert;
using MsAssert = Microsoft.VisualStudio.TestTools.UnitTesting.Assert; 
```

代码片段中的`NUNIT`是指解决方案的自定义构建配置。您可以使用 VS 配置管理器（通过 VS 工具栏或解决方案属性）创建它。此外，您需要在您的方法上替换 NUnit 的 Test 属性的所有实例以使用 MSTest TestMethod 属性（反之亦然）。

编辑：更新了上面的代码片段，包括对[Jamie Ide](https://stackoverflow.com/users/12752/jamie-ide)在评论中指出的问题的可能修复。请注意，我还没有设法测试此修复程序。更新后的代码片段取自 Simon 在这篇[博](http://devlicio.us/blogs/derik_whittaker/archive/2008/07/23/mstest-why-i-hate-you-you-cause-me-too-much-friction.aspx)文中的评论。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2015-07-31T06:31:42.940

如果您不想更改*任何*测试代码（即不想在顶部添加别名），这个 shim 对我有用：

```
using System;
using System.Collections;

namespace Microsoft.VisualStudio.TestTools.UnitTesting
{
    public class Placeholder{}
    public class TestClassAttribute : NUnit.Framework.TestFixtureAttribute
    {
    }
    public class TestInitializeAttribute : NUnit.Framework.SetUpAttribute
    {
    }
    public class TestMethodAttribute : NUnit.Framework.TestAttribute
    {
    }
    public class TestCleanupAttribute : NUnit.Framework.TearDownAttribute
    {
    }
    public class IgnoreAttribute : NUnit.Framework.IgnoreAttribute
    {
    }
    public class ExpectedExceptionAttribute : NUnit.Framework.ExpectedExceptionAttribute
    {
        public ExpectedExceptionAttribute(Type exceptionType) : this(exceptionType, null)
        {
        }
        public ExpectedExceptionAttribute(Type exceptionType, string message) : base(exceptionType)
        {
            UserMessage = message;
        }
    }
    public class TestContext : NUnit.Framework.TestContext
    {
        public TestContext(IDictionary dictionary) : base(dictionary)
        {
        }
    }
    public class Assert : NUnit.Framework.Assert
    {
        public static void IsInstanceOfType(object obj, Type type)
        {
            NUnit.Framework.Assert.IsInstanceOfType (type, obj, null);
        }
        public static void IsInstanceOfType(object obj, Type type, string message)
        {
            NUnit.Framework.Assert.IsInstanceOfType (type, obj, message);
        }
    }
    public class CollectionAssert : NUnit.Framework.CollectionAssert
    {
    }
} 
```

这对我来说可以通过 NUnit 运行 MSTest（至少在 Xamarin Studio 的单声道下）。只需包含该文件并正确获取引用（您可能需要不同的项目文件或[条件引用](https://stackoverflow.com/q/6523008/8787 "条件引用")），就可以了。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-02T12:13:15.757

您是否混合了现有的测试？如果没有，或者您不介意转换现有的 MSTest，我会在 NUnit 上进行标准化。我更喜欢 NUnit 而不是 MSTest；它更快，并且不会强迫您在测试类中使用 TestContext 废话。它也更兼容 CI 服务器。

# sql - 大表的 MSSQL 游标无法分配空间

> ID：709333
> 
> 赞同：2
> 
> 时间：2009-04-02T11:28:51.697
> 
> 标签：sql, sql-server, allocation, cursors

我们正在尝试设置一个游标来运行从同一个*巨大*表的两个“实例”之间的连接生成的记录（超过 150 M 记录）。

出现以下异常消息：

> 无法为数据库“tempdb”中的对象“dbo.SORT 临时运行存储：165282123350016”分配空间，因为“PRIMARY”文件组已满。通过删除不需要的文件、删除文件组中的对象、向文件组添加其他文件或为文件组中的现有文件设置自动增长来创建磁盘空间。

你们有谁知道这其中的原因吗？或者如何使下面的查询更有效率？

我发现它发生在`DECLARE CURSOR`和第一个之间的某个地方`FETCH NEXT`，但我还不知道它是否介于...

*   `DECLARE CURSOR`和`OPEN`

或之间

*   `OPEN`和第一个`FETCH NEXT`。

更多细节： sql 语句如下所示：

```
DECLARE cData CURSOR LOCAL FORWARD_ONLY READ_ONLY
为了
  选择 ...
  从 HugeTable HT1 加入 HugeTable HT2 ..
  加入表 3 开 .. 加入表 4 开 .. 加入表 5 开 ..
  在哪里 ...
  由 HT1 订购..., HT1...

插入系统日志（描述）值（'A'）

打开 cData
开始交易流程数据
  -- 目前在这里尝试新的日志记录：
  -- 插入系统日志（描述）值（'B'）
  FETCH NEXT FROM cData INTO ...
  插入到系统日志（描述）值（'C'）
  ... ETC。

```

我收到的最后一条日志消息是“A”，然后一小时后它失败并显示上述消息，从未达到“C”。我现在正在尝试在“B”点记录。

* * *

根据要求，我发布了确切的 sql 表达式：

```
DECLARE cSource CURSOR LOCAL FORWARD_ONLY READ_ONLY
为了
    选择 MD.s 字段名称，
        MD.sFieldValue,
        TR.sTargetDataType,
        MD2.sFieldValue AS sUniqueID,
        TR.sTargetTableName,
        TR.sTargetFieldName,
        I.iRefCustomerID,
        I.iInterfaceID,
        IL.iRefInterfaceSessionID
    来自 MasterData MD
    加入 MasterData MD2
        ON MD.iRowIndex = MD2.iRowIndex
        AND MD.iBatchNumber = MD2.iBatchNumber
        AND MD.sTableName = MD2.sTableName
        AND MD2.sFieldName = 'sUniqueID'
    加入 SourceTargetRelation TR
        ON MD.sFieldName = TR.sSourceFieldName
        AND MD.sTableName = TR.sSourceTableName
    JOIN 接口Log IL
        ON IL.iInterfaceLogID = MD.iBatchNumber
    JOIN接口一
        ON I.iInterfaceID = IL.iRefInterfaceID
        AND TR.iRefSystemID = I.iRefSystemID
    在哪里
        MD.iBatchNumber = @iBatchNumber
    按 MD.sTableName、MD.iRowIndex 排序

```

* * *

在 Quassnoi 更新答案后，我还将原始索引发布在桌子上：

我在此表上有一个非聚集索引，其中包含`iBatchNumber`、`sFieldName`、`sTableName`、列`iRowIndex`。该索引`sFieldValue`作为包含列。

* * *

正如 Quassnoi 建议的那样（我想我现在明白为什么了）我已经更改了索引以使列按以下顺序排列：`iBatchNumber`, `sTableName`, `iRowIndex`, `sFieldName`。我`sFieldValue`用作包含的列。执行计划不再包含任何内容`SORT`，并且执行计划中的步骤数不到原来的一半，我希望这也更快......

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-04-02T11:35:42.087

> 你们有谁知道这其中的原因吗？或者如何使下面的查询更有效率？

您的查询使用`ORDER BY`.

这需要排序，排序需要临时空间。你已经离开了这个空间。

为避免这种情况，请在您的大表上创建一个复合索引：`(col_filter_1, col_filter_2, col_order_1, col_order_2)`，`col_filter_n`您过滤的列在哪里，并且`col_order_n`是您排序的列。

这样的索引可用于过滤和排序过滤结果。

如果您发布您的实际查询（即您过滤和排序的表达式），我可能会更准确地告诉您如何创建这样的索引。

**更新：**

从您的查询中，我可以看到您需要一个索引`(iBatchNumber, sTableName, iRowIndex, sFieldName)`（按该顺序）。

如果您`MD2`在加入中领先也可能会有所帮助：

```
WHERE
    MD2.iBatchNumber = @iBatchNumber
ORDER BY
    MD2.sTableName, MD2.iRowIndex 
```

查看执行计划并确保没有`SORT`使用任何操作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-02T14:05:54.973

你为什么使用游标？特别是在一张大桌子上？你在做什么不能基于集合完成？Curspr 对性能非常不利，如果存在其他替代方案，则不应使用。如果您根据您的选择找到的记录插入到另一个表中，那么没有游标可以做得更好。

# asp.net - 每个请求调用 3 次 ProcessRequest

> ID：709335
> 
> 赞同：0
> 
> 时间：2009-04-02T11:29:38.343
> 
> 标签：asp.net

出于某种原因，我遇到在我的 HttpHandler 中，每个浏览器请求都会调用 ProcessRequest 3 次。我正在使用它从数据库中获取文档，并将它们发送给客户端。它的设置使得对 www.site.dk/documents/* 的每个请求都由这个 HttpHandler 处理。

任何帮助，将不胜感激。

最好的祝福。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-02T11:41:33.400

你可能想看看你正在处理哪些动词（如果你为你的动词指定了 *，你可能会收到 HEAD 和 GET 的单独调用，这将是两个调用）

此外，您不会说您要提供什么样的文件。如果它们是例如 html 文档，它们可能包含对其他资源的引用。如果这些资源 URL 是相对的，那么这些请求也可能进入 /documents/* 区域。

# .net-1.1 - .net 1.1 的 int.TryParse 的最佳替代品是什么

> ID：709336
> 
> 赞同：8
> 
> 时间：2009-04-02T11:29:43.333
> 
> 标签：.net-1.1

使用 .net 1.1 执行等效于 int.TryParse （在 .net 2.0 及更高版本中）的最佳方法是什么。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-04-02T11:33:07.303

明显地，

```
class Int32Util
{
    public static bool TryParse(string value, out int result)
    {
        result = 0;

        try
        {
            result = Int32.Parse(value);
            return true;
        }
        catch(FormatException)
        {            
            return false;
        }

        catch(OverflowException)
        {
            return false;
        }
    }
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-02T11:31:23.953

```
try
{
    var i = int.Parse(value);
}
catch(FormatException ex)
{
    Console.WriteLine("Invalid format.");
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2010-10-19T14:09:03.913

Koistya 几乎拥有它。.NET 1.1 中没有 var 命令。

如果我可以这么大胆：

```
try
{
    int i = int.Parse(value);
}
catch(FormatException ex)
{
    Console.WriteLine("Invalid format.");
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2011-06-20T09:35:53.060

double 有一个 tryparse，因此如果使用它，请选择“NumberStyles.Integer”选项并检查生成的 double 是否在 Int32 的边界内，您可以确定您的字符串是否为整数而不会引发异常。

希望这会有所帮助，杰米

```
private bool TryIntParse(string txt)
{
    try
    {
        double dblOut = 0;
        if (double.TryParse(txt, System.Globalization.NumberStyles.Integer
        , System.Globalization.CultureInfo.CurrentCulture, out dblOut))
        {
            // determined its an int, now check if its within the Int32 max min
            return dblOut > Int32.MinValue && dblOut < Int32.MaxValue;
        }
        else
        {
            return false;
        }
    }
    catch(Exception ex)
    {
        throw ex;
    }
} 
```

# c# - 为什么在不同线程中运行某些东西时 UI 线程会被阻塞？

> ID：709340
> 
> 赞同：1
> 
> 时间：2009-04-02T11:31:36.667
> 
> 标签：c#, winforms, multithreading, events

假设我有正常`button.Click`事件。

如果我尝试从该事件内部访问 UI 元素，我可能会得到不需要的行为 - 甚至是异常（在调试时）。在这种情况下，通常的例外是：`...cannot access UI elements from thread different than they were created in`.

由于这是另一个线程（与主线程不同），为什么当我在事件中执行耗时的操作时我的 UI 会被阻塞？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-02T11:34:25.210

这里的框架是什么？赢形式？WPF？

在 winform（对于单击事件）中，您*位于*UI 线程上。所以你*可以*通过点击事件与 UI 对话。如果发生了其他事情，那就有问题了。你确定你不在计时器回调中吗？

在更一般的意义上，您可以使用`InvokeRequired`/ `Invoke`etc 将控制权传递给 UI 线程。

# sql-server - 使用脚本复制 SQL Server DB

> ID：709343
> 
> 赞同：0
> 
> 时间：2009-04-02T11:33:19.190
> 
> 标签：sql-server

我必须将一个数据库从远程服务器复制到我的本地开发机器。最好的方法是什么。

昨晚我使用 xSQL 对象为远程数据库制作了一个脚本，并在本地服务器上运行它。该脚本给出了一堆错误。下面是 2 个服务器的选择 @@version 输出。脚本不起作用是有原因的吗

远程服务器使用 SQL server 身份验证，本地服务器使用 windows 身份验证

```
Microsoft SQL Server 2008 (RTM) - 10.0.1600.22 (X64) 
Jul  9 2008 14:17:44 
Copyright (c) 1988-2008 Microsoft Corporation
Enterprise Edition (64-bit) on Windows NT 5.2 <X64> (Build 3790: Service Pack 2)

Microsoft SQL Server 2008 (RTM) - 10.0.1600.22 (Intel X86) 
Jul  9 2008 14:43:34 
Copyright (c) 1988-2008 Microsoft Corporation
Express Edition with Advanced Services on Windows NT 5.1 <X86> (Build 2600: Service Pack 2) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-02T11:40:04.043

如果您提供了您的脚本产生的一些错误，那将会很有帮助。

我注意到您使用的是 Enterprise 和 Express 版本 - 这两个版本具有不同的功能，如下所述：http: [//www.microsoft.com/sqlserver/2008/en/us/editions.aspx](http://www.microsoft.com/sqlserver/2008/en/us/editions.aspx)。也许您正在使用 Express 版本不支持的功能，或者您的数据库太大。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-02T12:30:38.460

不确定功能是否与 2008 年完全相同，但在 2005 年，您可以打开 SQL Management Studio，右键单击要复制的 dbase，然后单击导出数据。

这将引导您完成一个向导，允许您将数据导出到另一个 SQL 数据库，包括在本地计算机上运行的数据库。多次使用它 - 效果很好。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-02T11:42:50.493

你为什么不做一个备份和恢复？

# php - 使用冗长的时区有什么意义？

> ID：709350
> 
> 赞同：3
> 
> 时间：2009-04-02T11:35:13.790
> 
> 标签：php, timezone

我知道这不是特定于 PHP 的，但是使用这样列出的时区有什么意义：[http](http://us2.php.net/manual/en/timezones.america.php) ://us2.php.net/manual/en/timezones.america.php ？例如“America/Indianapolis”和“America/New_York”。EST、EDT、CST、CDT 和 c 有什么问题？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-04-02T12:27:27.657

`'America/New_York'`不取决于日期。`EST`仅在冬季有效，而在夏季您必须将其更改为`EDT`. 3 个字母代码的另一个问题是存在冲突。`EST`表示东部标准时间，但它可能在美国或澳大利亚。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-04-02T11:39:39.583

这只是[Zoneinfo 数据库](http://en.wikipedia.org/wiki/Zoneinfo)提供的[不同时区格式](http://en.wikipedia.org/wiki/List_of_tz_zones_by_name)：

> 数据库中的时区被赋予统一的名称，例如“America/New_York”，以使它们更容易被人类理解并消除歧义。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-02T11:38:53.857

城市的时区或夏令时开始/结束日期可能会改变（过去确实发生过），但城市可能会保持在同一位置。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-02T15:35:18.807

一个时区内的所有地区都不遵循相同的规则。例如，亚利桑那州不遵守夏令时。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-02T11:37:40.413

[http://us2.php.net/date_default_timezone_set](http://us2.php.net/date_default_timezone_set)

引自页面：注意：自 PHP 5.1.0（重写日期/时间函数时）以来，如果时区无效，每次调用日期/时间函数都会生成 E_NOTICE，如果使用则生成 E_STRICT 消息系统设置或 TZ 环境变量。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2017-09-07T16:28:16.897

“America/Indianapolis”和“America/New_York”被称为**[tz 数据库](https://en.wikipedia.org/wiki/Tz_database)**（也称为**zoneinfo 数据库**或**IANA 时区数据库**或**Olson 数据库）的****TZID**（时区标识符）。

 ******> tz 数据库将世界划分为自 1970 年以来本地时钟一直相同的区域。

**这意味着在指定 TZID 时，您可以准确无误地确定自 1970 年 1 月 1 日（[Unix 纪元](https://en.wikipedia.org/wiki/Unix_time)）以来世界上发生的任何本地事件的日期。**

这与 Unix 时间戳一起看起来很方便。[但是，请注意 32 位程序，因为它们会报告2038 年问题](https://en.wikipedia.org/wiki/Year_2038_problem)的负值。

“EST”、“EDT”、“CST”和“CDT”通常是**[Microsoft Windows 时区数据库的](https://stackoverflow.com/tags/timezone/info)**缩写，并且由于它们不是唯一的而导致歧义（比较“中部标准时间”、“中部夏令时间”、“中国标准时间”和“古巴标准时间”）。

[https://stackoverflow.com/tags/timezone/info](https://stackoverflow.com/tags/timezone/info)上给出了更多优点/缺点。

# mvvm - 您如何处理 MVVM 中的更改跟踪？

> ID：709354
> 
> 赞同：2
> 
> 时间：2009-04-02T11:37:45.513
> 
> 标签：mvvm

我写了一个小助手来做客户端更改跟踪对象/dtos 以在我的 ViewModel 中使用（请参阅[http://viss.be/2009/04/02/modelviewcontext-client-side-change-tracking/](http://viss.be/2009/04/02/modelviewcontext-client-side-change-tracking/)）

我没有找到很多关于这个主题的资源。所以我想知道；你通常如何处理它？

谢谢，马克

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-04T18:46:08.393

ViewModel 就是将视图（UI）绑定到模型（数据）。所以它不应该负责跟踪变化，这是你应该在你的模型类内部做的事情，因为它们包含数据。

要通知 UI，Model 和 ViewModel 都实现 INotyfyPorpertyChanged。ViewModel 捕获 Model 事件并根据需要将它们传播到 View。

有关更完整的示例，请参阅[http://msmvps.com/blogs/theproblemsolver/archive/2009/04/07/using-model-view-viewmodel-with-silverlight.aspx 。](http://msmvps.com/blogs/theproblemsolver/archive/2009/04/07/using-model-view-viewmodel-with-silverlight.aspx)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-28T01:29:16.753

> 我没有找到很多关于这个主题的资源。

我也想看到更多关于这个话题的讨论

> 所以我想知道；你通常如何处理它？

1.  只需使用数据集。
2.  继续寻找解决方案。

# jakarta-ee - 如何在代码中添加角色，Java EE

> ID：709364
> 
> 赞同：1
> 
> 时间：2009-04-02T11:40:21.420
> 
> 标签：jakarta-ee, role

我正在使用 jboss 4.2.3 和 jaas `org.jboss.security.auth.spi.DatabaseServerLoginModule`。

用户登录后，我想为其添加角色。我该怎么做？

例如，用户单击一个按钮并添加一个角色...

澄清：我有 1 个用户登录的应用程序。在登录中，用户获得了一些角色（来自数据库）。之后，我想在我的代码中为用户添加另一个角色。我的例子是：用户登录后，他可以点击一个按钮，然后在我的 servlet 中为用户添加一个新角色。

似乎 Jboss 不允许这样做，角色只能在登录模块中访问。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2010-02-25T00:04:23.623

我一直在寻找这个问题的答案，我发现 JBoss 允许您以编程方式以及使用 MBean 刷新凭据缓存：

[http://community.jboss.org/wiki/CachingLoginCredentials](http://community.jboss.org/wiki/CachingLoginCredentials)

您可以将角色添加到用户，然后刷新该用户的凭据。据我所知，他们必须注销然后重新登录到您的应用程序；在那之后，他们将拥有你赋予他们的新角色。

如果有一种方法可以分配角色而无需用户注销并重新登录，我想听听。

# flash - 如何在 Actionscript 3 中删除/gc 对象？

> ID：709365
> 
> 赞同：20
> 
> 时间：2009-04-02T11:41:03.883
> 
> 标签：flash, actionscript-3, oop, class

**我想从内部删除/强制对类实例进行垃圾收集**。显然，`this = null`并且`delete this`不工作。有什么办法可以做到这一点，还是我吠错了树？我基本上是在寻找某种析构函数..

我有一个尝试加载 XML 文件的类实例，如果找不到该文件，我想销毁该实例，最好从其内部销毁。然后关键是根据子实例是否为空，在父类中做一些事情。

我曾想过向父母抛出一个事件并从那里删除孩子，但我宁愿只有在没有其他方法的情况下才这样做。

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2009-04-02T13:43:34.900

您不应该尝试从自身中移除对象 - 这是一种不好的做法，并且在 AS3 中您不能确定这样做。

仅当没有对该对象的引用时，才可以删除该对象（即垃圾收集）*。*由于引用总是按值传递，并且对象通常不知道存在哪些对它的引用，因此您不能从自身中删除对象。您可以做的唯一有用的事情是创建一个方法来清理实例使用的所有资源。这种方法将用作析构函数，但您必须手动调用它。不要忘记事件侦听器也会阻止垃圾收集，除非您删除它们。

`delete`'ing 属性和将其设置为`null`. 有效地`delete`从动态类的实例中删除一个属性。而将属性值设置为`null`不会删除该属性，但会删除存储在那里的任何引用。因此，这两个操作都会破坏存储在某个属性中的引用。请注意，您不能`delete`是对象，只能是属性。

在 Flash 播放器 9 和更早版本中，可以使用某些 hack 来启动垃圾收集。但是最近`System.gc()`有电话可用，它做同样的事情。请注意，您不能真正依赖实际调用 GC 的事实。这取决于 Flash 播放器。

**回到你的问题：**抛出事件并通知父母出了问题实际上是一个好主意。你应该坚持下去。此外，如果父母以这种方式知道此类事件会更好，而不是当它发现某些属性被神奇地为空时。

PS：阅读Grant Skinner[关于](http://www.gskinner.com/blog/archives/2006/06/as3%5Fresource%5Fma.html)闪存播放器内存的文章实际上是一个好主意。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2010-03-25T19:45:01.977

如果使用 addChild() 方法将对象添加到 DisplayContainer，则可以使用 parent.removeChild(this) 从对象内的容器中删除对象。如果此后没有对该对象的引用，则垃圾收集器将拾取该对象。

The only problem is when you have event listeners within the object, which you can either remove manually or let the garbage collector do it for you by setting weakReference=true on all listeners.

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-02T11:44:57.463

AS3 没有给你任何析构函数。您能做的最好的事情是设置所有引用`null`并保持手指交叉——GC 会注意到它并释放内存。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-02T11:45:13.907

```
System.gc()
// Forces the garbage collection process. 
```

参考：

[http://livedocs.adobe.com/flash/9.0/ActionScriptLangRefV3/flash/system/System.html](http://livedocs.adobe.com/flash/9.0/ActionScriptLangRefV3/flash/system/System.html)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-04-02T13:11:18.393

您应该先阅读有关垃圾收集的内容，Grant.S 写了一篇关于此的好文章：

[http://www.gskinner.com/blog/archives/2006/06/as3_resource_ma.html](http://www.gskinner.com/blog/archives/2006/06/as3_resource_ma.html)

重点不是将类本身设置为 null，而是删除其所有引用，包括侦听器。一旦它完全成为孤儿，垃圾可能会在某一时刻捡起它。

**基本示例：**

```
// References a newly created sprite
var reference:Sprite = new Sprite();

// Removes the reference, the Sprite is now orphaned and will probably be garbage collected within some seconds.
reference = null; 
```

一个好的做法是在所有类上系统地创建一个“destruct”方法，该方法删除其所有内部引用、处理位图、删除事件侦听器等，此后您只需要担心取消链接外部引用。

如果您使用 FLEX Builder，您可以使用分析器来可视化 Flash Player 在内部处理所有这些的方式。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-04-02T14:54:51.750

[这是从GSkinner](http://www.gskinner.com/blog/archives/2006/08/as3_resource_ma_2.html)强制进行垃圾收集的不受支持的方式。

```
try {
   new LocalConnection().connect('foo');
   new LocalConnection().connect('foo');
} catch (e:*) {}
// the GC will perform a full mark/sweep on the second call. 
```

# wpf - WPF 3D - 确定 ModelVisual3D 是否被剪辑在其 Viewport3D 中

> ID：709368
> 
> 赞同：1
> 
> 时间：2009-04-02T11:43:22.443
> 
> 标签：wpf, 3d, viewport3d, modelvisual3d

我在 a 中有一个立方体渲染`Viewport3D`，我需要知道一种方法来确定所有立方体是否对用户可见。

**编辑：为了清楚起见，..我不是在谈论剪裁，因为这里的近/远平面距离。我的意思是立方体太高或太宽以适合相机的视野。**

任何帮助将不胜感激！

提前致谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-02T12:22:39.387

我无法提供解决方案，但也许我可以为您指明正确的方向。

您需要掌握的是立方体在视图平面上的 2D 投影范围。然后，您可以对最小和最大 X 和 Y 值进行简单检查，以查看整个立方体是否可见。

在范围内添加容差因子将处理任何舍入误差。

编辑：我刚刚在 Google 上搜索了“2D 投影 WPF”，这个[链接](http://www.ericsink.com/wpf3d/A_AutoZoom.html)出现了。看起来它解决了您想要的问题。

进一步编辑：我已经从上面的链接中复制了相关的代码部分。

```
public static Rect Get2DBoundingBox(ModelVisual3D mv3d)
{
    bool bOK;

    Matrix3D m = MathUtils.TryWorldToViewportTransform(vpv, out bOK);

    bool bFirst = true;    
    Rect r = new Rect();

    if (mv3d.Content is GeometryModel3D)
    {
        GeometryModel3D gm3d = (GeometryModel3D) mv3d.Content;

        if (gm3d.Geometry is MeshGeometry3D)
        {
            MeshGeometry3D mg3d = (MeshGeometry3D)gm3d.Geometry;

            foreach (Point3D p3d in mg3d.Positions)
            {
                Point3D pb = m.Transform(p3d);
                Point p2d = new Point(pb.X, pb.Y);
                if (bFirst)
                {
                    r = new Rect(p2d, new Size(1, 1));
                    bFirst = false;
                }
                else
                {
                    r.Union(p2d);
                }
            }
        }
    }

    return r;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-06T22:56:08.403

我记得一个关于翻转码截锥剔除的教程。

[Flipcode - 截锥体剔除](http://www.flipcode.com/archives/Frustum_Culling.shtml)

我希望它有所帮助。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-02T12:04:50.833

我可以考虑做类似的事情：

检查与相机相关的立方体的最近点，并检查它是否从近剪裁平面剪裁。我能想到的离相机最近的点是构成立方体的点之一。因此，您必须检查立方体的 6 个点中的每一个，并检查它们是否被剪裁。如果它们都不是，那么您的立方体是否完全可见哦，显然您还必须检查远剪切平面。

代码很简单：

```
for each point of cube do
    if !(point is in farClippingPlane and nearClippingPlane)
       return false;
    end if
end for
return true 
```

# java - Subversion 中二进制文件的替代方案

> ID：709372
> 
> 赞同：23
> 
> 时间：2009-04-02T11:43:53.817
> 
> 标签：java, svn

我的一些同事确信将构建工件提交到 subversion 存储库是一个好主意。争论是这样，在测试机器上的安装和更新很容易——只需“svn up”！

我敢肯定有反对这种不良做法的有力论据，但我能想到的都是蹩脚的论据，比如“它占用了更多空间”。不这样做的最好的、最致命的理由是什么？我们应该采取哪些其他方法呢？

这适用于 Java 代码，如果有影响的话。一切都是从 Eclipse 编译的（没有自动 PDE 构建）。

当我说添加构建工件时，我的意思是提交看起来像这样：

```
"Added the new Whizbang feature"

 M src/foo/bar/Foo.java
 M bin/Foo.jar 
```

每个代码更改都有相应的生成 jar 文件。

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2009-04-02T11:58:02.703

在我看来，代码存储库应该只包含源代码以及编译此源代码所需的第三方库（在构建过程中可能会使用一些依赖管理工具来检索第三方库）。生成的二进制文件不应与源代码一起签入。

我认为您的问题是您没有适当的构建脚本。这就是为什么从源代码构建二进制文件涉及一些工作，如启动 eclipse、导入项目、调整类路径等......

如果有构建脚本，则可以使用以下命令获取二进制文件：

```
svn update; ant dist 
```

我认为不将二进制文件与源代码一起签入的最重要原因是存储库的大小。这将导致：

*   更大的存储库，版本控制系统服务器上的空间可能太少
*   版本控制系统服务器和客户端之间的大量流量
*   更新时间更长（假设您从互联网上进行 SVN 更新......）

另一个原因可能是：

*   源代码很容易比较，因此版本控制系统的许多功能确实有意义。但是你不能轻易比较二进制文件......

在我看来，您如上所述的方法也引入了很多开销。如果开发人员忘记更新相应的 jar 文件怎么办？

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2009-04-02T13:08:14.703

首先，Subversion（以及现在的所有其他版本）不是源代码控制管理器（我一直认为 SCM 意味着软件配置管理），而是版本控制系统。这意味着它们存储对您存储在其中的内容的更改，它不必是源代码，它可以是图像文件、位图资源、配置文件（文本或 xml），各种东西。构建的二进制文件不应被视为此列表的一部分只有一个原因，那是因为您可以重新构建它们。

但是，请考虑一下为什么还要将已发布的二进制文件存储在其中。

首先，它是一个帮助您的系统，而不是告诉您应该如何构建应用程序。让计算机为你工作，而不是反对你。那么如果存储二进制文件占用空间怎么办——你有数百 GB 的磁盘空间和超快的网络。在其中存储二进制对象不再是什么大问题（而十年前这可能是个问题——这也许就是人们认为 SCM 中的二进制文件是一种不好的做法的原因）。

其次，作为开发人员，您可能对使用该系统重新构建应用程序的任何版本感到满意，但可能使用它的其他人（例如 qa、测试、支持）可能不会。这意味着您需要一个替代系统来存储二进制文件，实际上，您已经有了这样的系统，它就是您的 SCM！好好利用它。

第三，你假设你*可以*从源代码重建。显然，您将所有源代码存储在其中，但您不存储编译器、库、sdks 和*所有*其他所需的相关位。当有人出现并询问“您能否为我构建我们 2 年前发布的版本，客户对该版本有问题”时会发生什么。2年现在是永恒，你甚至有你当时使用的相同编译器吗？当您检查所有源代码却发现新更新的 sdk 与您的源代码不兼容并因错误而失败时会发生什么？您是否只是为了构建这个应用程序而擦除您的开发框并重新安装所有依赖项？你还记得所有依赖项是什么吗？！

最后一点是重要的，为了节省几 k 的磁盘空间，如果不是数周的痛苦，您可能会花费数天甚至数周的时间。（并且 Sod 定律还说，无论您需要重建哪个应用程序，都将是需要最模糊、最难建立的依赖关系的应用程序，您曾经乐于摆脱）

因此，将二进制文件存储在您的 SCM 中，不要担心琐事。

PS。我们将所有二进制文件放在每个项目自己的“发布”目录中，然后当我们想要更新机器时，我们使用一个特殊的“设置”项目，它只包含 svn:externals。您导出安装项目并完成，因为它会获取正确的内容并将它们放入正确的目录结构中。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-04-02T11:48:55.333

像[Hudson](http://hudson.dev.java.net/)这样的持续集成服务器将能够归档构建工件。“为什么不”对你的论点没有帮助，但至少它是一种选择。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2009-04-02T12:18:18.803

> 我敢肯定有反对这种不良做法的有力论据

您错误地认为将“构建工件”提交给版本控制是一个坏主意（除非您错误地表达了您的问题）。它不是。

在版本控制中保留所谓的“构建工件”是可以的，而且确实非常重要。不仅如此，您还应该保留编译器和用于将源文件集转换为成品的任何其他东西。

从现在起的五年内，您肯定会使用不同的编译器和不同的构建环境，这可能会导致您的项目无法编译今天的版本，无论出于何种原因。修复旧版本中的错误可能是一个简单的小改动，将转变为将旧软件移植到当前编译器和构建工具的噩梦，只是为了重新编译具有单行更改的源文件。

因此，您没有理由如此害怕在版本控制中存储“构建工件”。您可能想要做的是将它们放在不同的地方。

我建议将它们分开：

```
 ProjectName
 |--- /trunk
 |    |--- /build
 |    |    |--- /bin        <-- compilers go here
 |    |    |--- /lib        <-- libraries (*.dll, *.jar) go here
 |    |    '--- /object     <-- object files (*.class, *.jar) go here
 |    '--- /source          <-- sources (*.java) go here
 |         |--- package1    <-- sources (*.java) go here
 |         |--- package2    <-- sources (*.java) go here 
```

您必须配置您的 IDE 或构建脚本以将目标文件放置在 /ProjectName/trunk/build/object 中（甚至可能在 .../source 下重新创建目录结构）。

这样，您可以让您的用户选择检查 /ProjectName/trunk 以获取完整的构建环境，或检查 /ProjectName/trunk/source 以获取应用程序的源代码。

在 ../build/bin 和 ../build/lib 中，您必须放置用于编译最终产品的编译器和库，即用于将软件交付给用户的那些。5 年或 10 年后，您将拥有它们，以备不时之需。

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2009-04-02T15:03:39.967

**如果您知道原因**，“将构建工件提交到 subversion 存储库”可能是一个好主意。

**出于发布管理**目的，这是一个好主意，更具体地用于：

## 1/ 包装问题

如果构建工件不仅是 exe（或 dll 或...），而且：

*   一些配置文件
*   一些脚本来启动/停止/重新启动你的工件
*   一些 sql 来更新你的数据库
*   一些源（压缩成文件）以方便调试
*   一些文档（javadoc 压缩在一个文件中）

*那么*最好将构建工件*和*所有相关文件存储在 VCS 中。
（因为它不再只是“重新构建”工件的问题，而且“检索”所有那些将使该工件运行的额外文件的问题）

## 2/ 部署问题

假设您需要在不同的环境（测试、认证、预生产、生产）中部署许多工件。
如果：

*   你产生了许多构建工件
*   从头开始重新创建这些工件很长

*那么*在 VCS 中拥有这些工件是一个好主意，以避免重新创建它们。
您可以从一个环境到另一个环境查询它们。

但是你需要记住：

*   1/您不能将您制作的*所有*工件都存储在 VCS 中：您为持续集成而制作的所有中间构建都**不得**存储在 VCS 中（否则您最终会得到一个包含许多无用二进制文件版本的巨大存储库）。
    只有认证和生产所需的版本需要参考。
    对于中间构建，您需要一个外部存储库（maven 或共享目录）以便快速发布/测试这些构建。

*   2/您不应该将它们存储在同一个 Subversion 存储库中，因为您的开发（修订号）比您的重要构建（被认为值得认证和生产部署的那些）更频繁地提交，
    这意味着存储在第二个存储库中的工件必须对标签（或属性）有一个**命名约定**，以便轻松检索构建它们的开发的修订号。

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2009-04-02T12:08:48.263

根据我的经验，在 SVN 中存储罐子可能会一团糟。
我认为最好将 Jar 文件保存在像[Nexus](http://nexus.sonatype.org/)这样的 Maven-Repository 中。
这也有好处，你可以使用像 Maven 或 Ivy 这样的依赖管理工具。

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2009-04-02T12:13:34.337

二进制文件，尤其是您自己的，还有第三方的，在像 SVN 这样的源代码控制工具中没有位置。

理想情况下，您应该有一个构建脚本来构建您自己的二进制文件（然后可以使用许多可以直接从 SVN 检查源代码的精细自动构建工具之一自动化）。

对于第三方二进制文件，您将需要像 Maven2 这样的依赖管理工具。然后，您可以设置一个本地 Maven 存储库来处理所有第三方二进制文件（或仅依赖公共二进制文件）。本地 repo 还可以管理您自己的二进制文件。

* * *

## 回答 #8

> 赞同：4
> 
> 时间：2009-04-02T13:08:58.260

将二进制文件放在树干或树枝中绝对是矫枉过正。除了像您提到的那样占用空间外，它还会导致源代码和二进制文件之间的**不一致。**当您提到修订版 1234 时，您不会想知道这是否意味着“从修订版 1234 的源生成的构建”与“修订版 1234 中的二进制文件”。避免不一致的相同规则适用于自动生成的代码。您不应该对构建可以生成的内容进行版本控制。

OTOH 我或多或少可以将**二进制文件放入 tags**。这样，其他项目很容易通过 svn:externals 使用其他项目的二进制文件，而无需构建所有这些依赖项。它还使测试人员能够轻松地在标签之间切换，而无需完整的构建环境。

要在标签中获取二进制文件，您可以使用以下过程：

1.  检查一个干净的工作副本
2.  运行构建脚本并评估任何测试结果
3.  如果构建正常，svn 添加二进制文件
4.  而不是提交到主干或分支，直接从您的工作副本中进行标记，如下所示：`svn copy myWorkingCopyFolder myTagURL`
5.  丢弃工作副本以避免将二进制文件意外提交到主干或分支

我们有一个`tagbuild`半自动化步骤 3 和 4 的脚本。

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2009-04-02T11:53:45.227

一个很好的理由是快速让可执行文件在新机器上运行。特别是如果构建环境需要一段时间来设置。（加载编译器、第 3 方库和工具等）

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2009-04-02T12:42:42.020

签入重要的二进制文件违反了源代码/SVN 的使用原则，即源代码管理中的文件应具有有意义的*差异*属性。

今天的源文件与昨天的源文件有明显的不同；差异将产生一组对人类读者有意义的变化。今天的办公室前面的照片与昨天的办公室照片没有明显的差异*。*

因为图像之类的东西不具备差异的概念，为什么要将它们存储在一个存在记录和存储文件之间*差异*的系统中？

基于修订的存储是关于存储文件更改的历史记录。（比如说）JPEG 文件的数据没有显着的变化历史。此类文件也可以完美地存储在目录中。

更实际地，在 SVN 中存储大文件 - 构建输出文件 - 会使结帐速度变慢。存在滥用 SVN 作为通用二进制存储库的可能性。起初一切似乎都很好——因为二进制文件并不多。当然，文件数量会随着时间的推移而增加；我见过需要*数小时*才能签出的模块。

最好将大型相关二进制文件（和输出文件）存储在目录结构中，并在构建过程中引用它们。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2009-04-02T13:25:06.210

在我的项目中，我通常有构建后的钩子来从服务器上的一个特殊工作副本构建，即在一个可从 HTTP 浏览器访问的路径中。这意味着，在每次提交之后，任何 [可以阅读内部网络的人] 都可以轻松下载相关的二进制文件。没有一致性问题，即时更新 + 通往自动化测试的道路。

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2009-04-02T14:13:17.480

版本控制应该有你需要做的一切：svn co 然后构建。它不应该有中间体或最终产品，因为这违背了目的。您可以在 SVN 中为结果创建一个新项目，并分别对二进制结果进行版本化（如果需要，用于发布和补丁）。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2009-04-02T11:48:10.293

您的意思是您在同一个存储库中拥有源代码和构建结果吗？

对于日常构建来说，这是一个很好的论据，在单独的存储库中具有版本化的构建脚本。存储库中的二进制文件本身还不错，但是构建的源代码+结果对我来说看起来很糟糕

如果您构建了多个二进制文件并且没有注意到某处的构建损坏，那么您最终会得到来自不同版本的二进制文件，并且您正在为一些微妙的错误追逐做准备。

提倡每天使用单独版本的自动构建脚本，而不仅仅是针对二进制文件 + 代码

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2009-04-02T11:51:00.523

*   Subversion 是一个源代码控制管理器 -> 二进制文件不是源代码
*   如果您使用“svn up”命令更新生产，所有具有提交权限的开发人员都可以更新/修改/破坏生产吗？

替代方案：使用持续集成，如 Hudson 或 Cruise Control。

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2013-06-03T14:25:41.743

我认为当二进制文件被提交到 VCS 时做坏事的感觉是由一个基本思想所推断的，即永远不应该将多余的东西放在存档中，这是由于资源经济和双重数据管理的缺点。

这就是原因：如果您可以轻松地从该特定版本的其他文件重建您的归档工作状态，例如简单的重新编译或安装标准设置，则不应提交此类二进制文件，而应提交 README 或 INSTALL 文件之类的文件。如果重建失败的困难或风险太大，请承诺。

# php - 为什么我不能使用 CSS 更改显示状态？

> ID：709378
> 
> 赞同：1
> 
> 时间：2009-04-02T11:46:04.450
> 
> 标签：php, html, css, printing

我试图在打印时在报告上显示横幅，但它不打印。我所做的是`display:none`在我的常规 CSS中将显示状态设置为

```
#transfer_head2
{
display:none;
} 
```

我将显示状态更改为`display:block`我的打印 CSS

```
#transfer_head2
{
display:block;
} 
```

但这不起作用。为什么？有谁能够帮我？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-04-02T11:56:39.463

检查 CSS 文件的顺序和定义的媒体。你的 print.css 应该排在最后，这样它就可以用`media=all`. 将 Firefox 与 Web Developer 插件一起使用，您可以更改浏览器中的 CSS，使其像打印媒体一样显示。您可能想尝试结合 Firebug 的检查工具来查看从何处应用了哪些 CSS。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-04-02T11:47:39.453

也许你`display: none`的被稍后定义的另一个属性覆盖。试试！重要

```
display:block !important; 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-04-02T12:38:31.140

是`#transfer_head2`一个`TABLE`？如果是这样，您需要使用：

```
#transfer_head2 { display: table; } 
```

是`TR`吗？

```
#transfer_head2 { display: table-row; } 
```

是一个`TD`还是一个`TH`？然后是以下内容：

```
#transfer_head2 { display: table-cell; } 
```

请注意，这些在 IE6 或更低版本中不受支持。在这种情况下，您可能需要使用以下内容：

```
@media screen {
    #transfer_head2 { height: 1px; width: 1px; overflow: hidden; visibility: hidden; }
}

@media print {
    #transfer_head2 { height: 60px; width: 468px; visibility: visible; }
} 
```

**编辑：**我忘记在我的原始帖子中指定这一点，但请记住，大多数浏览器配置默认禁用后台打印，所以如果你的 CSS 中有以下内容：

```
#transfer_head2 { background-image: url('../image/print_banner.jpg'); } 
```

无论何种`display`模式，它都不会打印。如果您可以控制用户的浏览器配置，这不是问题，但在大多数情况下，您会希望`IMG`为您的横幅使用标签。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-04-02T11:56:48.823

*   确保容器 div（如果有）没有被隐藏
*   使用 Web 开发人员工具栏检查生成的源代码以查看 div 的继承属性。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-11T12:39:30.890

如果没有看到`#transfer_head2`很难分辨的代码，您应该将其粘贴到您的问题中。

一个可能的原因可能是您将横幅设置为`#transfer_head2`元素的背景，而浏览器通常默认设置为不打印背景。

编辑：呃，安德鲁已经涵盖了......

# java - Java：Cloneable 接口的基本原理

> ID：709380
> 
> 赞同：33
> 
> 时间：2009-04-02T11:47:25.087
> 
> 标签：java, clone, specifications, cloneable

为什么接口中没有`.clone()`指定方法`java.lang.Cloneable`？

* * *

## 回答 #1

> 赞同：36
> 
> 时间：2009-04-02T12:05:52.640

基本上，这是一个损坏的界面。Ken Arnold 和 Bill Venners 在[Java Design Issues](http://www.artima.com/intv/issues3.html)中讨论了它。

阿诺德：

> 如果我在这一点上成为上帝，而很多人可能很高兴我不是，我会说 deprecate`Cloneable`并且有一个`Copyable`, 因为`Cloneable`有问题。除了拼写错误之外，`Cloneable`不包含该`clone`方法。这意味着您无法测试某物是否是 的实例`Cloneable`，将其强制转换为`Cloneable`并调用`clone`。您必须再次使用反射，这很糟糕。这只是一个问题，但我肯定会解决一个问题。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2009-04-02T11:56:55.093

在 Java 错误数据库中查看此错误：

[http://bugs.sun.com/bugdatabase/view_bug.do?bug_id=4098033](http://bugs.sun.com/bugdatabase/view_bug.do?bug_id=4098033)

从本质上讲，这是 Java 早期版本中的一个设计缺陷，他们不打算在 Cloneable 接口中修复，因为这样做会破坏与某些现有代码的兼容性。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-04-02T12:03:20.477

在 Java 中，有标记接口的概念。该`Cloneable`接口没有方法或字段，仅用于识别可克隆的语义。

来自[dev-x](http://www.devx.com/tips/Tip/5266)网站：

> 您经常会在 Java 中遇到没有行为的接口。换句话说，它们只是空的接口定义。这些被称为标记接口。Java API 中的一些标记接口示例包括：
> 
> *   [`java.lang.Cloneable`](http://download.oracle.com/javase/7/docs/api/java/lang/Cloneable.html)
> *   [`java.io.Serializable`](http://download.oracle.com/javase/7/docs/api/java/io/Serializable.html)
> *   [`java.util.EventListener`](http://download.oracle.com/javase/7/docs/api/java/util/EventListener.html)

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2009-04-02T12:35:23.193

在我从事的项目中，我们创建了一个名为 PublicCloneable 的接口，它包含 clone 方法并指定它是公共的。

我发现这个很有用：有一个克隆方法，但您无法访问它并没有多大帮助。

```
public interface PublicCloneable extends Cloneable {
    public Object clone();
} 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-04-02T11:57:11.490

因为 clone 方法是在 Object 类中实现的，因为它的“特殊”条件是：任何类型的对象的内存副本。

# python - 切换 python 打印的最佳方法是什么？

> ID：709385
> 
> 赞同：10
> 
> 时间：2009-04-02T11:49:09.543
> 
> 标签：python, printing

我在游戏引擎中运行 Python 2.4，如果需要，我希望能够关闭所有打印。例如，我想为调试构建打开打印，然后为发布构建关闭打印。它也必须尽可能透明。

我在引擎的 C 代码中对此的解决方案是在宏中包含该`printf`函数`vararg`，并将其定义为在发布版本中不执行任何操作。

这是我目前的解决方案：

```
DebugPrints = True
def PRINT (*args):
    global DebugPrints
    if DebugPrints:
        string = ""
        for arg in args:
            string += " " + str(arg)
        print string 
```

它使切换打印输出变得容易，但可能有更好的方法来格式化字符串。我的主要问题是这实际上为程序添加了更多的函数调用。

我想知道您是否可以对 print 关键字的工作方式做些什么？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-04-02T11:50:52.427

是的，你可以分配`sys.stdout`给任何你想要的。`write`用一个什么都不做的方法创建一个小类：

```
class DevNull(object):
    def write(self, arg):
        pass

import sys    
sys.stdout = DevNull()
print "this goes to nirvana!" 
```

使用相同的技术，您还可以通过设置`sys.stdout`为打开的文件对象将打印记录到文件中。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2009-04-02T14:17:17.863

我知道一个答案已经被标记为正确，但是 Python 有一个调试标志，它提供了一个更清晰的解决方案。你像这样使用它：

```
if __debug__:
    print "whoa" 
```

如果您使用 -O 或 -OO 调用 Python（就像您通常对发布版本所做的那样），`__debug__`则设置为`False`. 更好的是，这`__debug__`是解释器的特例；它实际上会在写入`pyc/pyo`文件时删除该代码，从而使生成的代码更小/更快。请注意，您不能为 赋值`__debug__`，因此它完全基于这些命令行参数。

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2009-04-02T12:00:43.667

[日志模块](http://docs.python.org/library/logging.html)是“最好的”方式..虽然我经常只使用一些简单的东西，比如..

```
class MyLogger:
    def _displayMessage(self, message, level = None):
        # This can be modified easily
        if level is not None:
            print "[%s] %s" % (level, message
        else:
            print "[default] %s" % (message)

    def debug(self, message):
        self._displayMessage(message, level = "debug")
    def info(self, message):
        self._displayMessage(message, level = "info")

log = MyLogger()
log.info("test") 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-04-02T11:52:12.627

不要使用打印，而是创建一个处理所有打印的控制台类。只需调用控制台，控制台就可以决定是否实际打印它们。控制台类对于错误和警告消息或重定向输出的位置也很有用。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2015-09-09T21:01:21.003

如果您真的想切换打印：

```
>>> import sys
>>> import os
>>> print 'foo'
foo
>>> origstdout = sys.stdout
>>> sys.stdout = open(os.devnull, 'w')
>>> print 'foo'
>>> sys.stdout = origstdout
>>> print 'foo'
foo 
```

但是，我建议您仅`print`用于一次性代码。用于`logging`原始问题描述的真实应用程序。它允许详细程度的滑动比例，因此您可以只拥有重要的日志记录，或者通常不太重要的细节的更详细的日志记录。

```
>>> import logging
>>> logging.basicConfig(level=logging.DEBUG)
>>> logging.debug('foo')
DEBUG:root:foo 
```

例如，用途可能是在整个代码中放置调试日志。然后让他们沉默，将您的级别更改为更高级别，其中之一是`INFO`、`WARN`或`WARNING`、`ERROR`、 或`CRITICAL`或`FATAL`

```
>>> logging.root.setLevel(logging.INFO)
>>> logging.debug('foo')
>>> 
```

在脚本中，您只需`basicConfig`像这样设置它：

```
import logging
logging.basicConfig(level=logging.INFO)

logging.debug('foo') # this will be silent 
```

可以[在文档](https://docs.python.org/library/logging.html)中找到更复杂的日志记录用法。

* * *

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2015-09-09T20:14:24.977

[我已经在另](https://stackoverflow.com/questions/32487941/efficient-way-of-toggling-on-off-print-statements-in-python/32488016#32488016)一篇文章中回答了这个问题，但问题是否被标记为重复：

无论如何，这就是我要做的：

```
from __future__ import print_function
DebugPrints = 0

def print(*args, **kwargs):
    if DebugPrints:
        return __builtins__.print(*args, **kwargs)

print('foo') # doesn't get printed
DebugPrints = 1
print('bar') # gets printed 
```

遗憾的是你不能保留 py2 打印语法`print 'foo'`

# image - 这种裁剪算法的更优雅的改写是什么？（在 Python 中）

> ID：709388
> 
> 赞同：4
> 
> 时间：2009-04-02T11:50:49.850
> 
> 标签：image, python-imaging-library, python, crop

我想在我的 Django 应用程序中裁剪缩略图图像，以便获得显示图像中心的二次图像。这不是很难，我同意。

我已经写了一些代码来做到这一点，但不知何故它缺乏某种……优雅。我不想玩代码高尔夫，但我认为必须有一种方法来表达这种更短、更 Python 的方式。

```
x = y = 200 # intended size
image = Image.open(filename)
width = image.size[0]
height = image.size[1]
if (width > height):
    crop_box = ( ((width - height)/2), 0, ((width - height)/2)+height, height )
    image = image.crop(crop_box)
elif (height > width):
    crop_box = ( 0, ((height - width)/2), width, ((height - width)/2)+width )
    image = image.crop(crop_box)
image.thumbnail([x, y], Image.ANTIALIAS) 
```

你有什么想法吗？

**编辑：**解释 x, y

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-04-02T12:06:23.230

我认为应该这样做。

```
size = min(image.Size)

originX = image.Size[0] / 2 - size / 2
originY = image.Size[1] / 2 - size / 2

cropBox = (originX, originY, originX + size, originY + size) 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-04-02T12:05:43.200

`fit()`PIL [ImageOps](http://www.pythonware.com/library/pil/handbook/imageops.htm)模块中的功能可以满足您的需求：

```
ImageOps.fit(image, (min(*image.size),) * 2, Image.ANTIALIAS, 0, (.5, .5)) 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-02T11:56:26.827

```
width, height = image.size
if width > height:
    crop_box = # something 1
else:
    crop_box = # something 2
image = image.crop(crop_box)
image.thumbnail([x, x], Image.ANTIALIAS)   # explicitly show "square" thumbnail 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-08-24T01:14:21.357

我想对 jepg 图像进行内容分析。我想拿一个 jpeg imafe 说 251 x 261 并通过一个算法将其裁剪为 96 x 87。这个程序可以像编写智能裁剪算法一样做到这一点，并提示重新调整图像。

# c# - 删除窗口的标题栏文本但保留状态栏文本

> ID：709391
> 
> 赞同：2
> 
> 时间：2009-04-02T11:51:44.357
> 
> 标签：c#, .net, winforms

我正在使用 Windows 窗体，是否可以创建一个在状态栏中有文本但在应用程序顶部的标题栏中没有文本的窗口？（很大程度上是因为打印在我实施的 Aero 玻璃上的标准标题文本看起来很糟糕，因为它太高了，我正在绘制自己的文本标题，显然不希望翻倍）。

这个解决方案（[如何使窗口有任务栏文本但没有标题栏](https://stackoverflow.com/questions/198233/how-to-make-a-window-have-taskbar-text-but-no-title-bar)）并不令人满意，因为我仍然希望保留一个`FixedDialog`窗口框架。

谢谢大家的帮助。

****我知道John的建议，但仍在寻求更清晰的方向，任何人都可以提出你的想法****

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-05-01T01:36:47.617

这应该这样做：

```
[DllImport("uxtheme.dll")]
public static extern int SetWindowThemeAttribute(IntPtr hWnd, WindowThemeAttributeType wtype, ref WTA_OPTIONS attributes, uint size);

public enum WindowThemeAttributeType : uint
{
    /// <summary>Non-client area window attributes will be set.</summary>
    WTA_NONCLIENT = 1,
}

public struct WTA_OPTIONS
{
    public uint Flags;
    public uint Mask;
}
public static uint WTNCA_NODRAWCAPTION = 0x00000001;
public static uint WTNCA_NODRAWICON = 0x00000002;

WTA_OPTIONS wta = new WTA_OPTIONS() { Flags = WTNCA_NODRAWCAPTION | WTNCA_NODRAWICON, Mask = WTNCA_NODRAWCAPTION | WTNCA_NODRAWICON };

SetWindowThemeAttribute(this.Handle, WindowThemeAttributeType.WTA_NONCLIENT, ref wta, (uint)Marshal.SizeOf(typeof(WTA_OPTIONS))); 
```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2009-04-02T12:00:00.250

您正在谈论的内容需要子类化才能进入应用程序的核心。本质上，您将通过拦截某些消息（如 WM_PAINT 等）来对表单进行蒙皮。如果您以前从未在该级别工作过，这不是一件简单的事情。

# windows - 计划任务无法在外部服务器上写入文件

> ID：709392
> 
> 赞同：2
> 
> 时间：2009-04-02T11:52:04.437
> 
> 标签：windows, windows-server-2003, scheduled-tasks

我遇到了在 Windows 2003 服务器计划任务中运行的计划任务的问题

任务在 nt 权限/系统帐户下运行，将文件发送到同一域中的另一台 windows2003 服务器。

执行任务的机器在域和机器中具有有限权限的域帐户下运行

已配置在远程服务器中发送文件的文件夹，授予系统和用户的全部权限

当计划任务要在远程服务器中写入文件时，会发生问题，任务返回异常，例如“拒绝访问路径 ....”

远程服务器检测到运行 externat 计划任务的用户是谁？我应该在远程文件夹中授予哪些权限？

提前致谢

费尔南多

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-02T11:56:26.467

以系统用户身份运行的计划任务将无权访问网络上的另一台计算机。当它运行时，就像您登录到本地机器而不是网络一样。您将需要以特殊网络用户身份运行该任务，或将文件存储在运行该任务的机器上，以供其他进程稍后获取。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-02T12:02:10.010

在本地系统帐户下运行的进程无权访问其他计算机的资源。一个典型的解决方案是为运行任务创建一个单独的域用户，并在这个用户下运行任务。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-03T08:09:22.303

除了上面提到的创建域用户来运行的解决方案，如果你只需要匿名网络访问或“域成员”网络访问，你也可以运行 as `Network Service`which 作为正面几乎没有本地计算机上的权限（不像`Local System`which is甚至比`Administrator`）更强大。

# datetime - .NET 2.0 DateTime UTC 转换

> ID：709396
> 
> 赞同：2
> 
> 时间：2009-04-02T11:54:18.157
> 
> 标签：datetime, c#-2.0, utc

为什么 ToUniversalTime 函数在这里没有作用；

```
DateTime dt = new DateTime(2009,3,24,1,0,0,DateTimeKind.Local);
dt = dt.ToUniversalTime(); // convert BST to UTC ?
dt.ToString(); 
```

“24/03/2009 01:00:00”……错了？

是相同的..

```
DateTime dt = new DateTime(2009,3,24,1,0,0,DateTimeKind.Utc);
dt = dt.ToUniversalTime(); // nothing to do, already utc
dt.ToString(); 
```

“24/03/2009 01:00:00” ...正确。

我希望对第一个示例的 ToString() 值进行调整，其中指定为 Local 的 DateTime 在调用 ToUniversalTime() 时会导致相应的 TimeZone 计算，而英国的时间应该会导致“ 24/03/2009 00:00:00”为 UTC。

但是，以这种方式指定 DateTimeKind 似乎会使 ToUniversalTime 或 ToLocalTime 无法进行任何计算。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-04-02T12:02:19.620

你有机会在英国吗？虽然我们现在处于夏令时，但您在代码中指定的日期是在此切换之前，因此英国的本地时间和 UTC 时间是相同的。如果您将四月指定为月份，那么您将看到一小时的差异。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-02T12:13:38.767

干杯大卫 M. 没有吃我的早餐。事实上，当我用超过 BST 夏令时阈值的日期重复测试时，行为当然是正确的。

```
 DateTime dt = new DateTime(2009,4,24,1,0,0,DateTimeKind.Local); 
 dt = dt.ToUniversalTime(); // convert BST to UTC ? 
 dt.ToString(); // "24/04/2009 00:00:00" ... correct 
```

为了确认，该`ToString()`方法似乎基于 Kind 属性进行输出。

# python - 将现有的 python 项目导入 XCode

> ID：709397
> 
> 赞同：6
> 
> 时间：2009-04-02T11:54:59.983
> 
> 标签：python, xcode, macos

我有一个 python 项目，我一直在用 vim 等终端制作。我读过 XCode 支持 Python 开发，它支持 SVN（我正在使用）但我找不到关于如何开始的文档来自现有代码存储库的新 XCode 项目。

其他开发人员正在不使用 XCode 的项目上工作 - 如果我添加项目文件或其他内容，他们不会介意，但如果我必须重新组织整个事情，他们会介意。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-04-02T16:57:19.843

我不认为将 Xcode 用于纯 python 项目是值得的。尽管 Xcode 编辑器会突出显示 Python 代码的语法，但 Xcode 并没有为您提供编写纯 Python 应用程序的任何其他好处。在 OS X 上，我建议将[TextMate](http://macromates.com/)作为文本编辑器或将 Eclipse 与[PyDev](http://pydev.sourceforge.net/)作为功能更全面的 IDE。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-12T09:02:38.007

我建议不要这样做。在 Xcode 中创建组（看起来像文件夹）实际上并不在文件系统中创建文件夹。这对模块层次结构造成了严重破坏。

此外，Xcode 中的 SCM 集成非常笨拙。在习惯了在 Eclipse 中使用 Subversion 之后，Xcode 中对 Subversion 的支持已经非常原始了。在命令行上执行 svn 命令几乎更容易，所以很清楚发生了什么。

如果您必须使用 Xcode，请使用它来打开单个`py`文件。将其用作速度较慢、相对无特色的文本编辑器。

如果您必须将 Xcode 用于 SCM，请查看他们[的使用 Xcode 和 Subversion 的指南](http://developer.apple.com/tools/subversionxcode.html)。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2010-11-11T08:56:55.787

另见：

[http://lethain.com/entry/2008/aug/22/an-epic-introduction-to-pyobjc-and-cocoa/](http://lethain.com/entry/2008/aug/22/an-epic-introduction-to-pyobjc-and-cocoa/)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-12T08:50:30.977

没有用于使用 Xcode 处理非 Cocoa Python 项目的特殊工具。因此，您可能只想使用“Empty Project”模板（在“Other”下）创建一个项目，然后拖入您的源代码。

为方便起见，您可能希望在项目中设置可执行文件。您可以通过 ctrl/右键单击项目源列表并选择“添加”>“新建自定义可执行文件...”来执行此操作。你也可以添加一个目标，虽然我不确定这会给你带来什么。

# .net - 如何在 .NET 中序列化大对象？（内存不足异常）

> ID：709399
> 
> 赞同：2
> 
> 时间：2009-04-02T11:55:35.130
> 
> 标签：.net, memory, serialization, out-of-memory

我在我的应用程序中对“保存”功能使用序列化。但是当数据太大（15+ MB）时，我开始出现 OutOfMemory 异常。

我有这么多对象，并且它们与其他小对象相连，我认为这会导致内存中的处理能力和数据过多。

我的代码基于此，几乎相同：

[http://www.codeproject.com/KB/vb/TreeViewDataAccess.aspx](http://www.codeproject.com/KB/vb/TreeViewDataAccess.aspx)

**编辑 ：**

1.  我不使用自定义序列化，都是通过 [Serialization] 属性完成的。不包括某些字段。

2.  我序列化了这么多对象和自定义类。包括字典、结构和一堆其他东西。

3.  我将它序列化为一个文件。

4.  我使用 XmlSerializer

*PS我有4 GB的物理内存。*

**解决方案**

感谢答案，我发现我的问题出在 XmlSerializer 上，我已经摆脱了它。二进制序列化与我拥有的数据一起工作得很好。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-08-17T21:23:18.747

我有完全相同的问题。原因是 .NET 序列化无法扩展。

我通过使用 Simon Hewitt 的优秀开源库解决了这个问题，请参阅*[Optimizing Serialization in .NET - part 2](https://www.codeproject.com/Articles/16017/Optimizing-Serialization-in-NET-part)*。

除了显着减少内存使用量之外，它还更快。与文章类似，我得到了 20 倍的加速。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-02T12:34:49.013

实际上，XmlSerializer 忽略了 SerializableAttribute 属性。它们仅由格式化类（BinaryFormatter、SoapFormatter）使用。

我不会使用 XmlSerializer 进行序列化，尤其不是 XmlSerializer 和 BinaryFormatter 的组合。

我只是尝试使用 BinaryFormatter 序列化所有内容。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-02T12:11:30.630

15MB 不应该给你一个 OOM。

如果数据是树状的（而不是完整的图），您可以考虑使用类似[protobuf-net](https://github.com/mgravell/protobuf-net)的序列化程序；除了使用谷歌非常高效（速度和内存）的二进制“协议缓冲区”格式外，它还受益于不必进行参考跟踪（图表需要）——这意味着它只需要担心一次数据（如果有，则两次）得到缓冲）。

但是，这需要对您的类进行不同的标记（或者至少是“选择加入”） - 而且它不会处理完整的图表。但它就在那里，而且是免费的……

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-02T12:01:15.910

您可以编写自己的序列化例程，看看是否可以通过手动调整序列化过程来获得任何性能优势。有关更多详细信息，请参阅[有关自定义序列化的 MSDN 页面](http://msdn.microsoft.com/en-us/library/ty01x675(VS.80).aspx)。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-02T12:02:03.070

也许你可以给我们更多关于如何进行序列化的细节。您是否使用自定义序列化？或者你只是使用内置的 [Serialization] 属性？

我认为您处理此问题的一个好方法是尝试执行您的自定义序列化逻辑并且只序列化您需要的内容，它不能达到 4GB，无论如何它还取决于您的应用程序分配了多少内存。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-04-08T20:58:07.140

使用这里提到的所有方法，将大对象转储到磁盘和恢复的便利性都丢失了。这些也仅支持转储数据类型，因此您不能像使用 BinaryFormatter 那样轻松地转储引用类型。

在对大型对象进行二进制格式化之前，还使用[​​gzip](http://en.wikipedia.org/wiki/Gzip)或[7-Zip](http://en.wikipedia.org/wiki/7-Zip)进行压缩，实际上会将 16 MB 以上的大小移动到 32 MB 左右。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2016-11-07T07:06:38.120

您可以下载[JSON.NET](https://www.nuget.org/packages/newtonsoft.json/)库，它在我的项目中工作超过 100 MB 数据的序列化和反序列化。

对于序列化，您可以像

如果你有对象使用 TextWriter

```
using (TextWriter textWriter = File.CreateText("LocalJsonFile.json"))
{
    var serializer = new JsonSerializer();
    serializer.Serialize(textWriter , yourObject);
} 
```

如果你有字符串使用 StringWriter

```
 StringBuilder sb = new StringBuilder();
  StringWriter sw = new StringWriter(sb);

  using(JsonWriter textWriter = new JsonTextWriter(sw))
  {
     var serializer = new JsonSerializer();
     serializer.Serialize(textWriter, yourObject);
  } 
```

这可能对你有用。

# java - 如何访问此 LDAP 对象的属性？

> ID：709406
> 
> 赞同：1
> 
> 时间：2009-04-02T11:57:44.280
> 
> 标签：java, ldap

我希望有人可以帮助我了解如何处理调用 DirContext.lookup 返回的对象。

以下代码片段有效并返回一个对象。我只是不知道如何从对象中获取属性。

```
javax.naming.directory.DirContext ctx =
    javax.naming.directory.getContext(false);
Object o = ctx.lookup(rdn); 
```

任何帮助将非常感激。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-07T14:24:41.167

属性 attrs = ctx.getAttributes(dn); 假设请求 arrtibute 值的条目具有适当的权限，将检索用户属性。

但是，最佳实践是您只查询您需要的属性。

如果您希望查看所有属性，您应该查询 objectclass 属性值，然后查询模式以获取“所有”分配的属性并决定您需要检索哪些属性。

-吉姆

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-02T14:03:33.543

在 LDAP 目录中，您将执行以下操作：

属性 attrs = ctx.getAttributes(dn);

获取对象的属性

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-02T12:00:19.487

你应该知道你期望从 接收什么对象`lookup()`，明确地转换成它，然后用它做任何你想做的事情。

最后你应该有这样的东西：

```
InitialContext iCtx = new InitialContext();
// load the iCtx with environment variables if necessary
Object o = iCtx.lookup("objectNameOrString");
ExpectedObjectType eot = (ExpectedObjectType) o;
eot.doWhatever(); 
```

# asp.net-mvc - 调整 asp.net mvc

> ID：709410
> 
> 赞同：3
> 
> 时间：2009-04-02T11:59:16.697
> 
> 标签：asp.net-mvc, fubumvc

我真的很喜欢 Fubu MVC 的“一个模型输入 - 一个模型输出”的想法。控制器看起来像这样

```
public class MyController
    {
        public OutputModel MyAction(InputModel inputModel)
        {
            //..
        }
    } 
```

并且服务定位器将自动填充构造函数中所有必需的依赖项。

这使得控制器非常容易测试。

所以我的问题是：您将如何调整 asp.net mvc 以允许控制器中的这种简单性？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-02T17:46:26.090

您正在寻找的是 ControllerActionInvoker。您必须实现自己的并覆盖/接管处理 ASP.NET MVC 的大量管道工作。

作为参考，请查看 Jonathon Carter 关于执行 ControllerActionInvokers 的两部分帖子：http: [//lostintangent.com/2008/07/03/aspnet-mvc-controlleractioninvoker-part-1/](http://lostintangent.com/2008/07/03/aspnet-mvc-controlleractioninvoker-part-1/)

和

[http://lostintangent.com/2008/07/07/aspnet-mvc-controlleractioninvoker-part-2/](http://lostintangent.com/2008/07/07/aspnet-mvc-controlleractioninvoker-part-2/)

此外，Oxite 团队在 Oxite 的第二个版本中这样做了，您可以在此处查看他们的来源：

[http://oxite.codeplex.com/SourceControl/changeset/view/30544](http://oxite.codeplex.com/SourceControl/changeset/view/30544)

这是直接指向他们的 ControllerActionInvoker 实现的链接：http: [//oxite.codeplex.com/SourceControl/changeset/view/30544#442766](http://oxite.codeplex.com/SourceControl/changeset/view/30544#442766)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-02T12:02:04.583

从来没有真正深入挖掘过 ASP.NET MVC 内部，但我想自定义 ModelBinder 和 ActionResult 可以完成这项工作。

# common-lisp - 应用程序编程和常见的 lisp 类型

> ID：709411
> 
> 赞同：5
> 
> 时间：2009-04-02T11:59:56.397
> 
> 标签：common-lisp

我刚刚开始学习 Common Lisp——并且很快就爱上了它——而且我刚刚进入了类型系统。我似乎特别喜欢应用程序编程。

据我了解，在 CL 中，字符串和列表都是序列，但似乎没有用于映射序列的任何标准函数，只有列表。我可以看到为什么要为列表提供它们，它们是基本数据类型等等，但为什么它不是设计用于序列？由于它们是一种更通用的类型，因此将应用函数作为目标而不是列表似乎更有用。还是我完全误解了它的工作原理？

**编辑：**

我感到特别困惑的是，序列——抽象——和列表——实现——似乎在 CL 中被混淆了。共识似乎是这是出于历史原因；lisp 已经存在了很长时间，你几乎可以通过它的函数和宏来规划软件工程实践的发展；乍一看，哪些函数适用于序列，哪些适用于列表似乎是任意的，因为 CL 混合了仅在列表上运行的预序列抽象函数，以及在序列上以更一般的方式执行相同操作的函数。作为目前刚刚学习 CL 的人，我认为如果作者首先引入序列作为更清晰的抽象，然后购买列表作为该抽象的最基本实现，那将会很有用。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-04-02T13:25:57.970

为什么，有很多函数在序列上工作。[使用MAP](http://www.lispworks.com/documentation/HyperSpec/Body/f_map.htm#map)或[MAP-INTO](http://www.lispworks.com/documentation/HyperSpec/Body/f_map_in.htm#map-into)对序列进行映射。

查看[CLHS 的序列部分](http://www.lispworks.com/documentation/HyperSpec/Body/c_sequen.htm)以了解更多信息。

还有一个组织良好的[快速参考。](http://clqr.berlios.de/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-02T13:18:53.027

好吧，您通常是正确的。大多数函数确实专注于列表（, `mapcar`, `find`,`count`等`remove`）`append`。其中一些有序列等效函数（`concatenate`,`some`和与所有序列）。有些函数只对序列起作用（例如 ）。`every``nth``elt``length`

CL有点乱。它是一种大语言，就像在*巨大的*. 超过 700 个功能，AFAIK。而且它很旧。其中一些函数按惯例已被弃用，而其他函数则很少使用（如果有的话）。

是的，将映射函数作为方法，按预期应用于所有序列会更有用。CL 根本不是那样构建的。如果它今天再次建造，我相信会考虑这一点，它看起来会*非常*不同。

也就是说，你并没有完全被冷落。该`loop`宏也适用于序列`iterate`（一个单独的循环宏，我碰巧更喜欢它）。这会让你走得更远。对于大多数实际目的，您将使用列表，这只是一个实用问题。如果你碰巧缺少向量（或一般的序列）的映射函数，谁来阻止你写它？

# c# - 将文本添加到图像文件

> ID：709414
> 
> 赞同：11
> 
> 时间：2009-04-02T12:00:08.440
> 
> 标签：c#

我需要将文本添加到图像文件中。我需要读取一个图像文件（jpg、png、gif），并且需要添加一行文本。

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2009-04-02T12:12:18.910

那么在 GDI+ 中，您将使用 Image 类读取文件，然后使用 Graphics 类向其中添加文本。就像是：

```
 Image image = Image.FromFile(@"c:\somepic.gif"); //or .jpg, etc...
  Graphics graphics = Graphics.FromImage(image);
  graphics.DrawString("Hello", this.Font, Brushes.Black, 0, 0); 
```

如果您想将文件保存在旧文件之上，则代码必须稍作更改，因为 Image.FromFile() 方法会锁定文件，直到它被释放。以下是我想出的：

```
 FileStream fs = new FileStream(@"c:\somepic.gif", FileMode.Open, FileAccess.Read);
  Image image = Image.FromStream(fs);
  fs.Close();

  Bitmap b = new Bitmap(image);
  Graphics graphics = Graphics.FromImage(b);
  graphics.DrawString("Hello", this.Font, Brushes.Black, 0, 0);

  b.Save(@"c:\somepic.gif", image.RawFormat);

  image.Dispose();
  b.Dispose(); 
```

不过，我会对此进行彻底的测试:)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2017-08-12T16:03:10.940

特别是对于具有 gif 结果的 gif，您应该在每个帧上写下如下所示：

```
string originalImgPath = @"C:\test.gif";
Image IMG = Image.FromFile(originalImgPath);
FrameDimension dimension = new FrameDimension(IMG.FrameDimensionsList[0]);
int frameCount = IMG.GetFrameCount(dimension);
int Length = frameCount;
GifBitmapEncoder gEnc = new GifBitmapEncoder();
for (int i = 0; i < Length; i++)
{
    // Get each frame
    IMG.SelectActiveFrame(dimension, i);
    var aFrame = new Bitmap(IMG);

    // write one the selected frame
    Graphics graphics = Graphics.FromImage(aFrame);
    graphics.DrawString("Hello", new Font("Arial", 24, System.Drawing.FontStyle.Bold), System.Drawing.Brushes.Black, 50, 50);
    var bmp = aFrame.GetHbitmap();
    var src = System.Windows.Interop.Imaging.CreateBitmapSourceFromHBitmap(
                bmp,
                IntPtr.Zero,
                Int32Rect.Empty,
                BitmapSizeOptions.FromEmptyOptions());
    // merge frames
    gEnc.Frames.Add(BitmapFrame.Create(src));
}

string saveImgFile = @"C:\modified_test.gif"
using (FileStream fs2 = new FileStream(saveImgFile, FileMode.Create))
{
    gEnc.Save(fs2);
} 
```

我应该提到从[这篇文章](https://stackoverflow.com/questions/540701/access-gif-frames-with-c-sharp)中获取 gif 帧。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-02T12:11:15.433

您可以通过使用 C# 中的 Graphics 对象来做到这一点。您可以从图片中获取 Graphics 对象（image.CreateGraphics() - 或者我记得的类似的东西），并使用一些内置的方法来向它添加文本，例如：Graphycs.DrawString() 或其他相关方法。

# windows - 超时 = 0 的 WaitForSingleObjects

> ID：709419
> 
> 赞同：1
> 
> 时间：2009-04-02T12:01:17.127
> 
> 标签：windows, winapi

timeout = 0 ms是否会`WaitForSingleObject()`立即导致线程上下文切换并且线程释放其剩余时间片？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-02T12:07:39.920

文档另有说明。[MSDN：WatiForSingleObject](http://msdn.microsoft.com/en-us/library/ms687032.aspx "等待单个对象")：

> 如果 dwMilliseconds 为零，则如果对象未发出信号，则函数不会进入等待状态；它总是立即返回。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-02T12:05:27.897

如果向句柄发出信号，则它永远不会进入等待状态。并且如果dwMilliseconds参数为0，即使没有发出信号也不会进入等待状态。

关于它的第二个参数：dwMilliseconds [MSDN 说如下](http://msdn.microsoft.com/en-us/library/ms687032.aspx)：

> ...如果 dwMilliseconds 为零，则如果对象未发出信号，则函数不会进入等待状态；它总是立即返回...

# asp.net - 切换使用中继器控件 ASP.NET 创建的行

> ID：709426
> 
> 赞同：0
> 
> 时间：2009-04-02T12:02:58.200
> 
> 标签：asp.net, jquery

我正在使用中继器控件创建数据列表。一些行可能有其他行，应该使用主行的可点击图像进行切换。

这里是 HTML 部分

```
<table cellpadding="2" cellspacing="0" width="100%">
                <asp:Repeater ID="repeatLockers" runat="Server">
                    <HeaderTemplate>
                        <tr>
            <td>&nbsp;</td>
                            <td>A</td>
                        </tr>
                    </HeaderTemplate>
                    <ItemTemplate>
                        <tr id="trItem" class="SomeParentClass" runat="server">
                            <td>
                                <img id="imgToggleHomeInfo" runat="server" alt="show/hide repetitves" src="icon_plus.gif"
                                    style="cursor: pointer" />
                            </td>
                            <td>
                                <asp:Label ID="lbl" runat="server"></asp:Label>
                            </td>
                        </tr>
                        <tr id="trAddOnFee" runat="server" class="SomeClass" style="display: none;">
                            <td colspan="2">
                                <table cellpadding="4" cellspacing="2" width="100%">
                                    <tr>
                                        <td class="DgHeader">A</td>
                                        <td class="DgHeader">B</td>
                                    </tr>
                                    <asp:Repeater ID="repeatRepetitives" runat="server">
                                        <ItemTemplate>
                                            <tr>
                                                <td>
                                                    <asp:Label ID="lblA" runat="server"></asp:Label>
                                                </td>
                                                <td align="right"> 
                                                    <asp:Label ID="lblB" runat="server"></asp:Label>
                                                </td>
                                            </tr>
                                        </ItemTemplate>
                                    </asp:Repeater>
                                </table>
                            </td>
                        </tr>
                    </ItemTemplate>
                </asp:Repeater>
            </table> 
```

如何使用 Jquery 在其父行上单击其父行上的 imgToggleHomeInfo" 图像时切换类为 "SomeClass" 的行？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-02T12:26:55.990

我会找到图像的父行，然后将其切换为下一个兄弟。

```
$(document).ready( function() {
    $("[id$='imageToggleHomeInfo']").click( function() {
        $(this).closest('tr').next().toggle();
    });
}) 
```

# git - 在 filter-branch --subdirectory-filter 之后如何从我的仓库中删除不需要的对象

> ID：709433
> 
> 赞同：8
> 
> 时间：2009-04-02T12:05:17.837
> 
> 标签：git

我正在使用

```
git filter-branch --subdirectory-filter dir/name -- --all 
```

构建一个仅具有与该目录/名称相关的历史记录的存储库。在进行过滤之前，我将原始存储库（非常大）克隆到 tmp 目录中。在过滤器分支之后，repo 看起来就像我想要的那样，除了一个例外：它似乎仍然包含来自原始 repo 的所有对象，即使它们没有显示在“git log”中。

如何完全删除所有那些不需要的对象？

我试过这样的事情：

```
git reflog expire --expire=now --all
git gc --aggressive --prune=now 
```

我很清楚，我不知道为什么它们仍然存在或删除它们意味着什么，但我肯定愿意。一些可能对我不利的相关信息是，我不久前在我的源代码库上做了一个 git repack -a ，它似乎将该包文件复制到新的代码库中。似乎我仍然应该能够做我想做的事。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-04-02T12:06:29.300

filter-branch 还将备份引用保存在 .git/refs/original 中，您还必须在 gc'ing 之前将其删除

# constructor - 你应该在构造函数中检查错误的参数值吗？

> ID：709449
> 
> 赞同：5
> 
> 时间：2009-04-02T12:09:23.317
> 
> 标签：constructor, data-consistency

您是在每个构造函数中检查数据有效性，还是只是假设数据正确并在参数有问题的特定函数中抛出异常？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-04-02T12:12:32.937

构造函数也是一个函数——为什么要区分？

创建一个对象意味着所有的完整性检查都已完成。在构造函数中检查参数并在检测到非法值后抛出异常是完全合理的。

其中包括简化调试。当您的程序在构造函数中抛出异常时，您可以观察堆栈跟踪并经常立即看到原因。如果您延迟检查，则必须进行更多调查以检测导致当前错误的早期事件。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-02T12:13:01.920

从一开始就拥有一个所有不变量都“满足”的完全构造的对象总是更好的。但是，请注意在非托管语言中从构造函数中抛出异常，因为这可能会导致内存泄漏。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-02T12:16:21.193

我总是在构造函数中强制值。如果用户懒得遵守规则，我只是默默地执行它们而不告诉他们。

所以，如果他们传递了 107% 的值，我会将其设置为 100%。我只是在文档中明确说明会发生这种情况。

只有在没有明显的逻辑强制的情况下，我才会向他们抛出异常。我喜欢称其为“那些懒得或愚蠢而无法阅读文档的人最惊讶的原则”。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-02T12:13:20.407

如果你在构造函数中抛出，堆栈跟踪更有可能显示错误值的来源。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-02T12:15:03.927

在一般情况下，我同意尖牙，但有时对象可能具有某些功能有效而某些功能无效的状态。在这些情况下，最好将检查推迟到具有这些特定依赖项的函数。

通常你会想要在构造函数中进行验证，只是因为这意味着你的对象将始终处于有效状态。但是某些类型的对象需要特定于功能的检查，这也可以。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-04-02T12:19:15.430

这是一个困难的问题。在过去的几年里，我已经多次改变与这个问题相关的习惯，所以我想到了一些想法：

*   检查构造函数中的参数就像检查传统方法的参数......所以我不会在这里区分......
*   检查方法的参数当然有助于确保传递的参数是正确的，但也会引入更多你必须编写的代码，在我看来这并不总是有回报的......尤其是当你编写委托的短方法时经常使用其他方法，我猜你最终会得到 50% 的代码只是进行参数检查......
*   此外考虑到，当您为您的类编写单元测试时，您通常不希望为所有方法传递有效参数......通常只传递对当前测试用例重要的参数确实有意义，因此进行检查会减慢您编写单元测试的速度...

我认为这真的取决于情况......我最终只是在我知道参数确实来自外部系统（如用户输入、数据库、Web 服务或类似的东西）时才编写参数检查...... ）。如果数据来自我自己的系统，我大部分时间都不编写测试。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-04-02T12:28:42.070

我总是试图尽早失败。所以我明确地检查了构造函数中的参数。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-04-02T12:29:05.733

理论上，调用代码在调用函数之前应始终确保满足先决条件。构造函数也是如此。

在实践中，程序员很懒惰，最好还是检查前置条件。断言在那里派上用场。

例子。请原谅我的非花括号语法：

```
// precondition b<>0
function divide(a,b:double):double;
begin
  assert(b<>0); // in case of a programming error. 
  result := a / b;
end;

// calling code should be:
if foo<>0 then
  bar := divide(1,0)
else
  // do whatever you need to do when foo equals 0 
```

或者，您可以随时更改前提条件。在构造函数的情况下，这不是很方便。

```
// no preconditions.. still need to check the result
function divide(a,b:double; out hasResult:boolean):double;
begin
  hasResult := b<>0; 
  if not hasResult then
    Exit;
  result := a / b;
end;

// calling code:
bar := divide(1,0,result);
if not result then
  // do whatever you need to do when the division failed 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-04-02T12:44:52.110

总是尽快失败。运行时.. * 展示了这种做法的一个很好的例子，如果您尝试对数组使用无效索引，则会出现异常。* 如果不是在稍后的某个阶段尝试，铸造会立即失败。

想象一下，如果引用中保留了错误的演员表，并且每次您尝试使用时都会遇到异常，那么灾难代码会是怎样的。唯一明智的方法是尽快失败并尝试尽快避免不良/无效状态。

# c# - 如何将上下文菜单添加到 Silverlight 树项？

> ID：709451
> 
> 赞同：2
> 
> 时间：2009-04-02T12:09:43.550
> 
> 标签：c#, silverlight, menu, tree, contextmenu

我希望将上下文菜单附加到我的 Silverlight Toolkit 树中的树项。我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-02T13:27:34.580

右键单击支持仅通过 Javascript 支持，因此供应商路线是一个不错的选择。

Curtisk 对 Telerik 控件的建议是一个不错的选择，但是第一次实施可能会很棘手——如果你走这条路，请确保为他们的支持多付几英镑——文档很糟糕。

您是否考虑过上下文菜单的替代方案？目前，我正在将一个胖客户端应用程序移植到 Silverlight 中。我们在厚应用中有很多右键单击上下文，在咨询了 Microsoft 的 UX 团队并查看了[Quince UX](http://quince.infragistics.com/)上的示例后，我们决定在屏幕右侧的基于任务的永久菜单中实现我们的上下文菜单. 实施是一个带有绑定的涂鸦，最重要的是，我们的用户已经很好地接受了这一点:-)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-02T12:45:59.797

一种方法是供应商提供......

Telerik 有用于 Silverlight 的 RADControls，上下文菜单控件可以附加到树视图。

[http://www.telerik.com/products/silverlight.aspx](http://www.telerik.com/products/silverlight.aspx)

和

[http://www.telerik.com/products/silverlight/contextmenu.aspx](http://www.telerik.com/products/silverlight/contextmenu.aspx)

有关更多详细信息和树演示

# security - 具有外部用户访问控制的 MediaWiki 文档

> ID：709456
> 
> 赞同：5
> 
> 时间：2009-04-02T12:11:36.527
> 
> 标签：security, mediawiki, wiki

我们在内部使用 MediaWiki 作为我们的软件和硬件文档。似乎为我们的外部用户（客户、项目合作伙伴）授予/撤销对部分文档的“读取访问权限”并不容易实现。我们如何根据用户或角色访问权限控制对文档某些区域的读取访问？

**编辑**：我问这个是因为我不喜欢回到文档的“旧样式”——将 Office 文档存储在几十个不同的位置，没有人知道它们在哪里。所以如果没有办法让用户只能有限地访问他们的产品信息，恐怕管理层会放弃整个 MediaWiki 解决方案并引入一些“新的和更好的”东西。（这可能意味着我们必须将所有内容转移到新系统，格式和超链接会丢失等......）。

* * *

非常感谢您的评论和回答！

一些有趣的信息可以在[http://meta.wikimedia.org/wiki/Access_control找到](http://meta.wikimedia.org/wiki/Access_control)

例如，有一个 HiddenWiki 补丁似乎正在积极开发中，位于[http://sourceforge.net/projects/hiddenwiki/](http://sourceforge.net/projects/hiddenwiki/)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-02T12:53:47.983

MediaWiki 并不是真正为禁止注册用户查看页面而设计的。我不认为你可以在没有痛苦的情况下做到这一点。

从[文档](http://www.mediawiki.org/wiki/Manual:Preventing_access#Restrict_viewing_of_all_pages)（重新格式化）：

让页面对某些用户正常运行但对其他人不可见，例如在大多数论坛软件中是可能的，这是完全不同的事情。MediaWiki 设计用于两种基本的访问模式：

*   每个人都可以查看 wiki 上的每一页（少数特殊页面可能除外）。这是维基百科及其姊妹项目使用的模式。
*   匿名用户只能查看主页和登录页面，不能编辑任何页面。这在技术实现方面与上述基本相同（只是对每个页面视图进行额外检查），这就是它存在的原因。这是某些私人 wiki 使用的操作模式，例如各种 Wikimedia 委员会使用的那些。

我的学校以您想要的方式使用 wiki。我的一个朋友设置了它们。他不得不对软件进行广泛的破解才能使其正常工作。根据我在 MediaWiki 中挖掘的经验，您正在尝试让这个工作变得有趣。

你有四个选择

*   获取一个 MediaWiki 插件并升级它。
*   每次升级时自己破解并重做工作。
*   使用不同的维基软件。
*   如上所述设置一个新的私人维基。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-08T08:41:27.393

正如其他人所指出的，这不是 MediaWiki 的核心功能。

最简单的解决方案可能是拥有一个带有跨 wiki 链接的公共和私人 wiki。（首先复制原始 wiki 并从公共安装中删除不需要的页面，并添加重定向）。

另一种可能性可能是为公共和私人页面设置单独的命名空间，并根据配置文件中的命名空间限制可访问性。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-09T07:02:55.640

听起来您确实在尝试将 MediaWiki 带到它不一定想去的地方，所以我建议**选择一个更好的工具**。

随着 wiki 的发展，我们经历了 MediaWiki 阶段，但最终选择了[MindTouch Deki](http://www.mindtouch.com/Products/MindTouch_Deki_Standard)，因为它看起来和行为都更好，而且更易于管理（例如访问控制）。你可以在他们的网站上找到所有细节，我只能说它开箱即用。

好的部分来了：现在有一个[MediaWiki 到 Deki 的转换器](http://www.mindtouch.com/blog/2009/03/12/free-mediawiki-migration-to-deki-mediawiki-upgrade/)可用。我不能保证它（是新的和全部），但由于所有部件都是免费的，我的建议是你花几个小时尝试看看你能做什么，你可能会喜欢这个结果。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-02T15:21:48.620

您可以使用页面访问限制扩展：[http](http://www.mediawiki.org/wiki/Extension:Page_access_restriction) ://www.mediawiki.org/wiki/Extension:Page_access_restriction和组来执行此操作。

话虽如此，[MediaWiki 不建议您这样做...](http://www.mediawiki.org/wiki/Manual:Preventing_access#Restrict_viewing_of_certain_specific_pages)

（从[我对 Stack Overflow 问题*MediaWiki 支付网关*](https://stackoverflow.com/questions/619036/mediawiki-payment-gateway/619127#619127)的回答中窃取。）

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-07T20:05:55.197

您可以创建[MediaWiki 命名空间](http://www.mediawiki.org/wiki/Namespaces)并将某些用户分配给特定的命名空间。不过，您必须小心...如果不编辑 LocalSettings.php 文件，默认情况下，新名称空间中的页面不会出现在网站上的搜索中。有关更多信息，请参阅[文档](http://www.mediawiki.org/wiki/Manual:Using_custom_namespaces)。

请参阅此[半相关线程](https://stackoverflow.com/questions/563232/how-many-wiki-instances-to-install/563947#563947)。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-04-12T16:11:38.827

如果您命名一个页面`X/Y`，则链接将为`wiki/X/Y`，这意味着您可以在任何好的代理中设置访问权限，例如基于“目录”的 Apache HTTP。您可以将代理连接到 Windows 域或只是用户名列表。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2013-12-18T12:38:12.243

这是我的解决方案。

我们将 wiki 保留在 .htpasswd 后面，子域 (external.wiki.mydomain.co.uk) 上的 php 脚本会获取一个页面并**在它与允许的页面数组匹配时**提供它。

它还去除了侧边栏和页脚等。这可能取决于您的 wiki 使用的样式，strip_content() 函数可能需要调整。

```
 $allowed = array(   "Architecture",
                        "Database_Design",
                        "Authentication",
                        "Branding");

    //put your own .htpasswd credentials in here
    $username = "USERNAME";
    $password = "P@ssw)rd";
    $url = "http://internal.wiki.mydomain.co.uk";

    $ch = curl_init();

    curl_setopt($ch, CURLOPT_URL, $url);
    curl_setopt($ch, CURLOPT_RETURNTRANSFER, true);
    curl_setopt($ch, CURLOPT_USERPWD, "$username:$password");
    curl_setopt($ch, CURLOPT_HTTPAUTH, CURLAUTH_BASIC);
    $output = curl_exec($ch);

    //I have not mod-rewritten the index.php out of the url, hence the 2 lines below...
    $page = str_replace("/index.php/", "",$_SERVER['PHP_SELF']);
    $page = $page == '/index.php' ? "Home" : $page;

    $links = "<div><a href = '/' >Home</a>";
    $links .= isset($_SERVER['HTTP_REFERER']) ? '&nbsp;-&nbsp;<a href = "' . $_SERVER['HTTP_REFERER'] . '" >Back</a>' : '';
    $links .= "</div>";
    if (!in_array($page, $allowed)) {
        $out = "<div>Access denied to " . $page . '</div>' . $links;
    } else {
        curl_setopt($ch, CURLOPT_URL, $url . "/index.php/" . $page);
        curl_setopt($ch, CURLOPT_RETURNTRANSFER, true);
        $output = curl_exec($ch);
        $out = $links . '<br />' . strip_content($output);
    }
    curl_close($ch);
    echo $out;

    /**
     * Strip out unwanted bits of the page, such as side bar and header and footer.
     * @param string $html The raw html
     * @return string
     */
    function strip_content($html)
    {
        $patterns = array(  '!<span class="editsection">.*?<\/span>!is',
                             '@<!-- footer -->.*?<!-- /footer -->@is',
                            '@<!-- panel -->.*?<!-- /panel -->@is',
                            '@<!-- header -->.*?<!-- /header -->@is'

            );
        return preg_replace($patterns, "", $html);
    } 
```

您可以通过在开头添加登录名来扩展它，以便脚本可以为不同的用户选择不同的页面子集。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2014-02-28T21:10:09.667

如果您有私人 wiki，那么您可以使用`$wgBlockDisablesLogin = true`LocalSettings.php 中的标志来禁用被阻止用户的登录功能（然后只需阻止某人撤销所有访问权限）。另一种选择是将整个 wiki 放在 vpn 后面。

参考：

*   [私人维基](http://www.mediawiki.org/wiki/Manual%3aPreventing_access#Simple_private_wiki)
*   [块禁用登录标志](http://www.mediawiki.org/wiki/Manual%3aConfiguration_settings#User_Access)

# c# - 预处理器中的 C# 宏定义

> ID：709463
> 
> 赞同：77
> 
> 时间：2009-04-02T12:12:49.720
> 
> 标签：c#, macros, c-preprocessor

C# 是否能够像在 C 编程语言中使用预处理器语句那样定义宏？我想简化某些重复语句的常规输入，例如：

```
Console.WriteLine("foo"); 
```

* * *

## 回答 #1

> 赞同：58
> 
> 时间：2009-04-02T12:14:04.460

不，C# 不支持像 C 这样的预处理器宏。另一方面，Visual Studio 有[片段](https://docs.microsoft.com/en-us/visualstudio/ide/visual-csharp-code-snippets?view=vs-2017)。Visual Studio 的代码片段是 IDE 的一项功能，在编辑器中扩展，而不是在由预处理器编译的代码中替换。

* * *

## 回答 #2

> 赞同：50
> 
> 时间：2013-03-29T13:00:42.167

您可以使用 C 预处理器（如 mcpp）并将其安装到您的 .csproj 文件中。然后，您将源文件上的“构建操作”从 Compile 更改为 Preprocess 或您所称的任何内容。只需像这样将**BeforBuild**添加到您的 .csproj 中：

```
 <Target Name="BeforeBuild" Inputs="@(Preprocess)" Outputs="@(Preprocess->'%(Filename)_P.cs')">
<Exec Command="..\Bin\cpp.exe @(Preprocess) -P -o %(RelativeDir)%(Filename)_P.cs" />
<CreateItem Include="@(Preprocess->'%(RelativeDir)%(Filename)_P.cs')">
  <Output TaskParameter="Include" ItemName="Compile" />
</CreateItem> 
```

您可能必须手动将至少一个文件上的编译更改为预处理（在文本编辑器中） - 然后“预处理”选项应该可以在 Visual Studio 中选择。

我知道宏被过度使用和误用，但完全删除它们同样糟糕，如果不是更糟的话。宏使用的一个典型例子是**NotifyPropertyChanged**。每个不得不手动重写这段代码数千次的程序员都知道没有宏是多么痛苦。

* * *

## 回答 #3

> 赞同：33
> 
> 时间：2012-09-07T15:47:02.163

我用它来避免`Console.WriteLine(...)`：

```
public static void Cout(this string str, params object[] args) { 
    Console.WriteLine(str, args);
} 
```

然后您可以使用以下内容：

```
"line 1".Cout();
"This {0} is an {1}".Cout("sentence", "example"); 
```

它简洁而时髦。

* * *

## 回答 #4

> 赞同：13
> 
> 时间：2015-11-08T03:13:19.113

虽然您不能编写宏，但在简化示例之类的事情时，C# 6.0 现在提供静态使用。这是 Martin Pernica 在[他的 Medium 文章中](https://medium.com/@martinpernica/new-c-6-0-features-are-great-evolution-b56572f64e35)给出的示例：

```
using static System.Console; // Note the static keyword

namespace CoolCSharp6Features
{
  public class Program
  {
    public static int Main(string[] args)
    {
      WriteLine("Hellow World without Console class name prefix!");

      return 0;
    }
  }
} 
```

* * *

## 回答 #5

> 赞同：8
> 
> 时间：2015-05-13T15:33:14.907

在 C# 中没有直接等效于 C 样式的宏，但是`inline`d 静态方法 - 带或不带`#if`// `#elseif`pragmas `#else`- 是您可以获得的最接近的方法：

```
 /// <summary>
        /// Prints a message when in debug mode
        /// </summary>
        [MethodImpl(MethodImplOptions.AggressiveInlining)]
        public static unsafe void Log(object message) {
#if DEBUG
            Console.WriteLine(message);
#endif
        }

        /// <summary>
        /// Prints a formatted message when in debug mode
        /// </summary>
        /// <param name="format">A composite format string</param>
        /// <param name="args">An array of objects to write using format</param>
        [MethodImpl(MethodImplOptions.AggressiveInlining)]
        public static unsafe void Log(string format, params object[] args) {
#if DEBUG
            Console.WriteLine(format, args);
#endif
        }

        /// <summary>
        /// Computes the square of a number
        /// </summary>
        /// <param name="x">The value</param>
        /// <returns>x * x</returns>
        [MethodImpl(MethodImplOptions.AggressiveInlining)]
        public static double Square(double x) {
            return x * x;
        }

        /// <summary>
        /// Wipes a region of memory
        /// </summary>
        /// <param name="buffer">The buffer</param>
        [MethodImpl(MethodImplOptions.AggressiveInlining)]
        public static unsafe void ClearBuffer(ref byte[] buffer) {
            ClearBuffer(ref buffer, 0, buffer.Length);
        }

        /// <summary>
        /// Wipes a region of memory
        /// </summary>
        /// <param name="buffer">The buffer</param>
        /// <param name="offset">Start index</param>
        /// <param name="length">Number of bytes to clear</param>
        [MethodImpl(MethodImplOptions.AggressiveInlining)]
        public static unsafe void ClearBuffer(ref byte[] buffer, int offset, int length) {
            fixed(byte* ptrBuffer = &buffer[offset]) {
                for(int i = 0; i < length; ++i) {
                    *(ptrBuffer + i) = 0;
                }
            }
        } 
```

这可以完美地作为宏工作，但有一个小缺点：标记为`inline`d 的方法将像任何其他“正常”方法一样复制到程序集的反射部分。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2009-04-02T12:15:17.920

幸运的是，C# 没有 C/C++ 风格的预处理器 - 仅支持条件编译和编译指示（可能还有其他我想不起来的东西）。不幸的是，C# 没有元编程功能（这实际上*可能*在某种程度上与您的问题有关）。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-04-02T12:17:24.233

将 C 宏转换为类中的 C# 静态方法。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2011-02-07T00:50:56.380

我建议您编写扩展程序，如下所示。

```
public static class WriteToConsoleExtension
{
   // Extension to all types
   public static void WriteToConsole(this object instance, 
                                     string format, 
                                     params object[] data)
   {
       Console.WriteLine(format, data);
   }
}

class Program
{
    static void Main(string[] args)
    {
        Program p = new Program();
        // Usage of extension
        p.WriteToConsole("Test {0}, {1}", DateTime.Now, 1);
    }
} 
```

希望这会有所帮助（而且还不算太晚:)）

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2021-03-27T18:49:05.920

使用 lambda

```
void print(string x) => Trace.WriteLine(x);
void println(string x) => Console.WriteLine(x);
void start(string x) => Process.Start(x);

void done() => Trace.WriteLine("Done");
void hey() => Console.WriteLine("hey"); 
```

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2018-08-17T11:33:31.663

由于 C# 7.0 支持`using static`指令和[本地函数](https://docs.microsoft.com/en-us/dotnet/csharp/programming-guide/classes-and-structs/local-functions)，因此大多数情况下不需要预处理器宏。

# asp.net - 指定的参数超出了有效值的范围

> ID：709473
> 
> 赞同：0
> 
> 时间：2009-04-02T12:15:13.333
> 
> 标签：asp.net, drop-down-menu

我有一个包含所有国家/地区的下拉框（ddlCountryTax），如果我选择美国，它将显示显示与美国相关的税收信息的网格。如果我在网格中编辑信息，并且如果我们在 ddlCountryTax 的下拉框中将国家/地区更改为英国（不是下拉框来在网格的编辑窗口中，没有问题）它显示错误，如

> 指定的参数超出了有效值的范围。
> 参数名称：ItemHierarchicalIndex
> 描述：当前Web请求执行过程中发生了未处理的异常。请查看堆栈跟踪以获取有关错误及其源自代码的位置的更多信息。
> 异常详细信息：System.ArgumentOutOfRangeException：指定的参数超出了有效值的范围。参数名称：ItemHierarchicalIndex

源错误：

```
    第 86 行：}
    第 87 行：
    第 88 行：如果（rgStateTax.EditItems.Count > 0）
    第 89 行：{
    第 90 行：foreach( rgStateTax.Items 中的 GridDataItem 项)

    源文件：c:\Projects\ACS\Aivea.Acs.Administration\UserControls\TaxManager.ascx.cs 行：88

```

堆栈跟踪：

```
[ArgumentOutOfRangeException：指定的参数超出了有效值的范围。参数名称：ItemHierarchicalIndex]
Telerik.WebControls.GridItemCollection.get_Item（字符串分级索引）+323
Telerik.WebControls.GridDataItemCollection.get_Item（字符串分级索引）+37
Telerik.WebControls.RadGrid.get_EditItems() +215
Aivea.Acs.Administration.TaxManager.rgStateTax_PreRender(Object sender, EventArgs e) 在 c:\Projects\ACS\Aivea.Acs.Administration\UserControls\TaxManager.ascx.cs:88
System.Web.UI.Control.OnPreRender(EventArgs e) +8682870
System.Web.UI.WebControls.BaseDataBoundControl.OnPreRender(EventArgs e) +31
Telerik.RadGridUtils.RadControl.OnPreRender(EventArgs e) +36 Telerik.RadGridUtils.RadAJAXControl.OnPreRender(EventArgs e) +37
Telerik.WebControls.RadGrid.OnPreRender(EventArgs e) +40
System.Web.UI.Control.PreRenderRecursiveInternal() +80
System.Web.UI.Page.ProcessRequestMain（布尔includeStagesBeforeAsyncPoint，布尔includeStagesAfterAsyncPoint）+842

```

这是代码下拉事件

```
 protected void ddlCountryTax_SelectedIndexChanged( object sender, EventArgs e )
    {
        long locationId = ddlCountryTax.SelectedItem.Value.AsLong();

        ContentAdministrationServiceClient client = null;
        List<DCTaxRate> taxRate = null;
        try
        {
            client = new ContentAdministrationServiceClient();
            taxRate = client.GetTaxRatesByCountryIdAndLocationTypeName( locationId, "State" );
            client.Close();
        }
        catch( FaultException )
        {
            AbortClient( client );
        }

        rgStateTax.DataSource = taxRate;
        rgStateTax.Rebind();

    } 
```

这是 radgrid

```
 protected void rgStateTax_EditCommand( object sender, EventArgs e )
    {
        BindStateTax();
    }

 private void BindStateTax()
    {
        long locationId = ddlCountryTax.SelectedItem.Value.AsLong();

        List<DCTaxRate> taxRate = null;
        ContentAdministrationServiceClient client = null;
        try
        {
            client = new ContentAdministrationServiceClient();
            taxRate = client.GetTaxRatesByCountryId( locationId );
            client.Close();
        }
        catch( FaultException )
        {
            AbortClient( client );
        }

        rgStateTax.DataSource = taxRate;
        rgStateTax.Rebind();
    } 
```

这是预渲染事件：

```
protected void rgStateTax_PreRender( object sender, EventArgs e )
    {
        if( rgStateTax.MasterTableView.IsItemInserted )
        {
            foreach( GridItem item in rgStateTax.Items )
            {
                item.Visible = false;
            }
        }

        if( rgStateTax.EditItems.Count > 0 )
        {
            foreach( GridDataItem item in rgStateTax.Items )
            {
                if( item != rgStateTax.EditItems[0] )
                {
                    item.Visible = false;
                }
            }
        }
    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-03T00:23:18.617

我对正在发生的事情的猜测是您已经在网格中进行了更改，并且在提交这些更改之前您正在更改网格中的数据。

您对网格更改的处理似乎是在更改网格数据的事件之后发生的。要解决此问题，您要么必须在更改网格数据之前处理任何网格更改，要么在国家更改时丢弃网格更改。

# xml - 使用 Excel 存储数据更好或使用 XML 进行自动化测试

> ID：709474
> 
> 赞同：0
> 
> 时间：2009-04-02T12:15:17.373
> 
> 标签：xml, excel, watin

我正在使用 WatiN 进行自动化测试。我需要保存一些值以供将来在我的应用程序中参考。我需要知道 Excel 是否是一种很好的存储方法，或者我宁愿为此目的使用 XML。

亲切的问候

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-02T12:30:17.213

如果您只需要存储值，请使用 XML 解决方案。它将为您以后使用收集的数据提供最大的灵活性。

如果您需要良好的可视化效果，请使用 Excel，您可以在其中应用排序和过滤，还可以创建图表。

您也可以将两者结合使用，即将数据保存在 XML 中，然后使用 XML 映射功能将数据导入 Excel。

# language-agnostic - 如何在产品生命周期中保护构建环境

> ID：709476
> 
> 赞同：4
> 
> 时间：2009-04-02T12:15:21.493
> 
> 标签：language-agnostic

在项目生命周期内记录构建/测试机器设置的最佳实践是什么？如果您需要为产品的先前版本提供补丁，您可能需要重新加载相同的编译器和支持工具以重新发布补丁版本。你记录什么以及如何记录？显而易见的是：

操作系统版本和补丁级别、
编译器/IDE 版本和补丁级别
第 3 方工具/库。

我的第一个想法是保留所有要求的日志文件。此日志文件将进入您的 VCS。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-02T12:23:40.333

我正在使用带有enforcerer插件的[maven](http://maven.apache.org/) for java，所以所有这些东西都存储在我的项目对象模型中，甚至是所需的maven本身的版本。只要我设法从版本控制中获得正确的版本，我就可以回家了。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-02T13:11:45.447

VMWare 虚拟化（或其他类似产品）非常适合这类事情。构建一个完整的开发/构建/或测试环境，并将其设置为仅用于该目的。您可以将图像脱机，将其备份到 DVD 中，并在需要时将其重新打开。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-02T13:09:14.063

3rd 方工具和库与其他一切一起进入版本控制；我们有一个库树，它位于我们的应用程序树旁边的 VCS 主干下，因此它包含在我们创建的任何分支或标签中。我还没有解决的一个问题是 Windows 工具和库需要它们自己的安装程序，而不是用完 VCS 提供的任何目录。

对于操作系统和编译器，如果您不能并行安装多个编译器版本，我建议为每个版本创建一个 VM。然后，您的项目 wiki 可以记录用于给定构建的 VM 和编译器版本。这不像您的日志文件那样是自动的，但它提供了一个随时可用的环境（而不是可能必须重新安装机器以匹配您的日志文件）。一些项目将他们的整个编译器检查到版本控制中，但这对我来说似乎有点矫枉过正（并且与需要自己的安装程序的 IDE 和编译器配合得不好）。

我们不跟踪操作系统和编译器的补丁级别。我意识到补丁可能会破坏或改变某些东西，但这种可能性似乎很低，以至于根本不存在成本效益比。

# asp.net - 可以使标准 .NET CMS 系统与 ASP.NET MVC 一起使用吗

> ID：709486
> 
> 赞同：5
> 
> 时间：2009-04-02T12:19:17.053
> 
> 标签：asp.net, asp.net-mvc, content-management-system

有没有人成功使用为标准 ASP.NET 和 ASP.NET MVC 开发的 CMS？

我目前使用 Immediacy CMS，它似乎与标准 ASP.NET 紧密结合，但我真的很想开始使用 ASP.NET MVC。

有没有针对 MVC 的 CMS 系统？

我如何说服我的雇主转向 ASP.NET MVC？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-08-21T02:17:08.180

我建议看看 Kooboo ( [kooboo.com](http://www.kooboo.com) )，一个简单易用但功能强大的开发人员。有据可查的 API 并基于 ASP.NET MVC（当然 ;-)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-02T15:57:52.420

[N2 CMS](http://www.n2cms.com)在 ASP.NET MVC 中有一个[示例站点](http://n2.codeplex.com/Release/ProjectReleases.aspx?ReleaseId=24776)，我一直在使用它，它工作得非常好 - 请注意，代码现在托管在[Google Code](http://code.google.com/p/n2cms/)上。

您遇到的问题是，许多 CMS 已经做了很多“路由”，因为您请求/编辑的页面实际上并不存在于磁盘上，而是都在某种数据存储中，并且有一个位于 ASP.NET 前面的 HttpHandler 或 ISAPI 过滤器拦截请求并确定应该发生的情况。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-02T12:23:09.993

我个人还没有看到任何大名鼎鼎的 CMS 系统升级到利用 .NET 框架提供的许多新功能，更不用说开始使用 MVC 框架了。

与所有事情一样，成本效益分析是说服老板做任何事情的最佳方式。如果你能指出转向 MVC 框架将如何产生一些直接的积极因素（以及许多长期的积极因素），这些积极因素可以超过转换中的成本（时间、精力和金钱），那么你就成功了。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-02T12:28:25.550

就您如何在它们之上开发应用程序而言，ASP.NET 和 ASP.NET MVC 是非常不同的野兽。从技术上讲，ASP.NET MVC 应用程序是一个 ASP.NET 应用程序，带有一些调用核心 MVC 框架的通用处理程序。

ASP.NET MVC 框架也相对较新（1.0 刚刚在上一次 MIX 发布），因此要成为主流还需要一段时间。

如何说服你的老板？与他谈谈 ASP.NET MVC 的积极方面，以及它将如何改善他未来的业务。有很多材料可以证明这一点。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-08T08:46:32.660

我使用 Immediacy 做了很多工作（我曾经在那里工作过），几个月前我曾考虑过做同样的事情。我认为主要问题将来自插件处理程序、idoc 处理程序和（如果您仍在使用它）ilink 处理程序。

当您启用诸如友好 URL 之类的功能时，如果您在控制器操作中使用类似的命名方法，我认为这会导致问题。

您可能可以在您的项目中使用一些 MVC，我可以看到它作为管理插件工作，但我看不到它在主 webroot 中有用。

我认为必须使用 MVC 构建 CMS 才能从使用该模式中获得最大的好处，而不是试图使其与预先存在的系统 API 并行工作（尽管它是有限的）并做更多的工作为自己。

# java - 桌面应用的推荐技术选择

> ID：709487
> 
> 赞同：1
> 
> 时间：2009-04-02T12:20:26.817
> 
> 标签：java, popup, desktop-application

我正在创建一个本质上是财务警报站点的应用程序。我是一名初级 Java 程序员，我已经为 Java 中的警报创建了一些逻辑。

每当发生“有趣”的事情时，我希望能够在桌面上显示弹出窗口（有趣取决于百分比变化、流动性和其他一些简单因素）。

实现这样的事情的最佳技术组合是什么？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-04-02T12:46:04.040

我会在 Java SE 6 中使用[java.awt.SystemTray](http://java.sun.com/developer/technicalArticles/J2SE/Desktop/javase6/systemtray/)。它是跨平台的并且非常易于使用。

尽管有些人讨厌 Windows 中的气球通知，但它们是最不显眼的弹出窗口，因为它们可以被用户忽略或很容易被忽略。最重要的是，离开计算机的用户不会错过它们，因为气球（至少在 Windows XP/Vista 中）使用系统空闲计时器来确定何时消失的正确时间。

有些人更喜欢更传统的 toast 通知，类似于 Outlook 显示的通知 - 它们会出现并慢慢淡出，让用户有时间在需要时与它们进行交互。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-07T21:16:55.483

我遇到了同样的[问题](https://stackoverflow.com/questions/629388/how-to-notify-the-user-of-important-events-for-a-desktop-application)，最后使用未装饰的 alwaysOnTop 窗口解决了这个问题。

多亏了[这篇博客文章](http://www.curious-creature.org/2007/09/28/translucent-shaped-windows-extreme-gui-makeover/)，我找到了[TimingFramework](https://timingframework.dev.java.net/)，现在它甚至是半透明的，淡入淡出，鼠标悬停时 100% 不透明等。结合 SystemTray 和 TrayIcon 的行为几乎与 Outlook 的行为一样。

哦，我必须注意，除了[第二个](http://www.curious-creature.org/2007/09/28/translucent-shaped-windows-extreme-gui-makeover/)链接之外，我使用淡出

```
AWTUtilities.setWindowOpacity(window, op); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-02T12:30:58.617

您可以编写一个驻留在系统托盘中的 java 程序，但我不确定是否有跨平台兼容的方法来执行此操作。也许您必须为 Win、Mac、Linux 使用特定于平台的库，...

我只是创建一个消息窗口并为其设置动画。然后添加 SystemTray 支持，瞧，大功告成。

在 Delphi 中你可以很快地做到这一点，但你不能轻易地重用你的 java 逻辑

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-02T12:31:09.833

您可以在“静音”模式下运行程序，默认情况下不创建任何窗口，也许只是任务栏中的一个小图标，双击它会打开一个设置窗口。该程序将在后台运行，并在事件发生时创建具有设置焦点的窗口。

但在我看来，幻灯片窗口或至少一个气球工具提示是一个更好的主意。

# c# - 进度条不更新

> ID：709488
> 
> 赞同：2
> 
> 时间：2009-04-02T12:20:31.450
> 
> 标签：c#, .net, progress-bar, backgroundworker

我有以下代码将数据写入 XML 文件。

```
private void WriteResidentData()
{
    int count = 1;
    status = "Writing XML files";
    foreach (Site site in sites)
    {
            try
            {
                //Create the XML file
                StreamWriter writer = new StreamWriter(path + "\\sites\\" + site.title + ".xml");
                writer.WriteLine("<?xml version=\"1.0\" encoding=\"ISO-8859-1\" ?>");
                writer.WriteLine("<customer_list>");

                foreach (Resident res in site.GetCustomers())
                {
                    bw.ReportProgress((count / customers) * 100);
                    writer.WriteLine("\t<customer>");
                    writer.WriteLine("\t\t<customer_reference>" + res.reference + "</customer_reference>");
                    writer.WriteLine("\t\t<customer_name>" + res.name + "</customer_name>");
                    writer.WriteLine("\t\t<customer_address>" + res.address + "</customer_address>");
                    writer.WriteLine("\t\t<payment_method>" + res.method + "</payment_method>");
                    writer.WriteLine("\t\t<payment_cycle>" + res.cycle + "</payment_cycle>");
                    writer.WriteLine("\t\t<registered>" + CheckWebStatus(res.reference) + "</registered>");
                    writer.WriteLine("\t</customer>");
                    count++;
                }

                writer.WriteLine("</customer_list>");
                writer.Close();
            }
            catch (Exception ex)
            {
                lastException = ex;
            }
        }
    } 
```

它使用从数据库中获取数据的同一个 BackgroundWorker。我的进度条在从数据库读取时正确显示进度。但是，在将 XML 写入的进度条归零后，即使该过程正确完成，它也只是位于 0。

谁能建议为什么？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-04-02T12:26:41.123

会不会是（计数/客户）被截断为零（两个整数之间的除法）？

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-04-02T12:43:39.240

我认为应该是 (count*100)/customers，假设您想要完成百分比。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-02T12:28:13.163

这与线程有关。因为您在完成工作的同一线程中更新您的 GUI。

任务完全完成后进度条会填满吗？

嗯，你在那里使用 bw ......所以这可能是你的后台工作进程。

# python - python代码约定使用pylint

> ID：709490
> 
> 赞同：10
> 
> 时间：2009-04-02T12:21:31.900
> 
> 标签：python, conventions, pylint

我正在尝试 pylint 来检查我的源代码的约定。不知何故，一些变量名与常量的正则表达式 ( `const-rgx`) 匹配，而不是变量名正则表达式 ( `variable-rgx`)。如何匹配变量名`variable-rgx`？还是我应该扩展`const-rgx`我的`variable-rgx`东西？

例如
`C0103: 31: Invalid name "settings" (should match (([A-Z_][A-Z1-9_]*)|(__.*__))$)`

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2009-04-02T13:27:59.180

> 不知何故，一些变量名与常量的正则表达式 (const-rgx) 匹配，而不是变量名正则表达式 (variable-rgx)。

这些变量是在模块级别声明的吗？也许这就是为什么它们被视为常量的原因（至少根据 PEP-8，它们应该是这样声明的）。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2009-04-02T12:29:00.027

我只是禁用该警告，因为我不遵循这些命名约定。

为此，请将此行添加到模块的顶部：

```
# pylint: disable-msg=C0103 
```

如果要全局禁用它，请将其添加到 pylint 命令中：

```
python lint.py --disable-msg=C0103 ... 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-02T13:18:58.237

```
 (should match (([A-Z_][A-Z1-9_]*)|(__.*__))$) 
```

就像您说的那样，这是仅匹配大写名称或双下划线包围的名称的 const-rgx。

变量-rgx 是

```
([a-z_][a-z0-9_]{2,30}$)
```

如果您的变量被称为“设置”，它确实应该与变量-rgx 匹配

我只能想到两个原因。要么设置是**常数**，要么是 PyLint 中的错误。

# sql-server - 错误“Microsoft SQL Native Client 错误 '80040e37'”

> ID：709492
> 
> 赞同：1
> 
> 时间：2009-04-02T12:22:28.497
> 
> 标签：sql-server, iis, asp-classic

将我的数据库和网站移至另一台服务器后，我收到错误 Microsoft SQL Native Client 错误“80040e37”。问题出现在没有 schema.tablename，只有 tablename 的 asp 文件中的查询中。但我现在不想在所有查询中包含“模式”。已安装所有更新，并且我的用户的默认架构是正确的。SQL Server 配置为混合模式并接受 windows 身份验证和 sql server 身份验证。软件：IIS 6、Sql Server 2005。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-02T13:14:13.410

解决了。问题是“孤立”登录。解决方案是运行存储过程 sp_help_revlogin，复制其结果并在新服务器中运行它们。

```
EXEC [dbo].[sp_help_revlogin] 
```

示例结果：

```
CREATE LOGIN [exampleLogin] WITH PASSWORD = 0x0100E634633EB1BF18E HASHED, SID = 0x840D462D26543B4FB71234B36137A131, DEFAULT_DATABASE = [yourDB], CHECK_POLICY = OFF, CHECK_EXPIRATION = OFF 
```

# .net - Datagrid 标头 ClientID (JQuery) 中的复选框

> ID：709494
> 
> 赞同：0
> 
> 时间：2009-04-02T12:22:52.677
> 
> 标签：.net, jquery, datagrid

在母版页中，我有一个标准的 DataGrid：

```
 <asp:DataGrid ID="dgMyGrid" runat="server" AutoGenerateColumns="false">
            <Columns>
            <asp:TemplateColumn>
            <HeaderTemplate>
            <asp:CheckBox CssClass="Checker" ID="cbSelectAll" runat="server" />
            </HeaderTemplate>
            <ItemTemplate>
            <asp:CheckBox ID="cbSelect" runat="server" />
            </ItemTemplate>
            </asp:TemplateColumn>
            </Columns>
  </asp:DataGrid> 
```

有以下 jQuery 使标题复选框全选：

```
$(document).ready(function() {
$("#ctl00_ContentPlaceHolder1_dgMyGrid_ctl01_cbSelectAll").click(function() {
 $("#<%=dgID %> :checkbox").each(function(i)
 {
 this.checked = $("#ctl00_ContentPlaceHolder1_dgMyGrid_ctl01_cbSelectAll").is(":checked")
 });
 });
}); 
```

这可行，但有点难看 - 我无法使用
<%=cbSelectAll.ClientID%> 获取标题复选框的客户端 ID（就像我为数据网格所做的那样）可能是因为 javascript 是在该控件之前呈现的。有没有更优雅的方法可以让我的复选框的 clientID 从数据网格中取出？我认为如果我没有像这样对 clientID 进行硬编码会更好。

抱歉，如果这个问题的答案很明显，这是我尝试 jQuery 的第一天！:)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-02T13:50:37.287

为什么不直接引用复选框“cbSelectAll”的类。

```
<asp:CheckBox CssClass="Checker" ID="cbSelectAll" runat="server" />

$("#<%=dgID %> :checkbox").each(function(i)
{ 
    this.checked = $(".Checker").is(":checked");
}); 
```

如果“Checker”类用于多个控件，您始终可以分配一个唯一的类。

```
<asp:CheckBox CssClass="Checker cbSelectAll" ID="cbSelectAll" runat="server" />

$("#<%=dgID %> :checkbox").each(function(i)
{ 
    this.checked = $(".cbSelectAll").is(":checked");
}); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-02T13:58:20.810

此代码用于查找您的复选框

```
 protected static Control FindControl(Control control, string controlId)
    {
        Control result;
        foreach (Control ctrl in control.Controls)
        {
            if (ctrl.ID == controlId)
            {
                result = ctrl;
                return result;
            }
            if (ctrl.Controls.Count != 0)
            {
                result = FindControl(ctrl, controlId);
                if (result != null)
                {
                    return result;
                }
            }
        }
        return null;
    } 
```

现在您可以在 aspx 页面上使用：

```
<%= FindControl(dgMyGrid, "cbSelectAll").ClientID%> 
```

# php - PHP编码比赛

> ID：709499
> 
> 赞同：-1
> 
> 时间：2009-04-02T12:24:02.860
> 
> 标签：php

我想知道是否有针对 PHP 组织的诸如 Sharp Coder for C 和 Java 之类的比赛。有谁知道我在哪里可以找到一些可以竞争的任务？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-04-02T12:27:14.943

我不知道任何 php 比赛。你想从这样的比赛中获得什么？也许您应该检查需要帮助而不是竞争的基于 php 的开源项目。这样你也可以在同一个“步骤”中获得认可并做好工作

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-02T12:41:31.087

[在phpclasses.org](http://solomongaby.users.phpclasses.org/)上有一种竞赛，他们将著名课程的状态授予一些带来新概念的课程，并且每个月他们都会将[PHP 编程创新奖授予](http://solomongaby.users.phpclasses.org/award/innovation/)从为此发布的著名课程中投票最多的课程月。

# html - 超链接消失

> ID：709514
> 
> 赞同：1
> 
> 时间：2009-04-02T12:28:47.467
> 
> 标签：html, css, stylesheet, hyperlink

这很奇怪，我以前从未见过，也许我的电脑需要重新启动，但是：我在网页上添加的每个链接都消失了。[你可以在这里](http://funpunks.com/about/website/)看到一个活生生的例子。

这是我的样式表：

```
/*------- UNIVERSAL -------*/
body
{
    background: #333333;
    color: #222222;
    font-family: Arial, Helvetica, sans-serif;
    font-size: 12px;
}

.tleft { text-align: left; }
.tright { text-align: right; }

a
{
    text-decoration: none;
    color: #e6267c;
    font-weight: bold;
}

a :hover{ border-bottom: 1px #e6267c dashed; }

/*------- PAGE PARTS -------*/
#container
{
    position: relative;
    margin: 0 auto;
    width: 760px;
    padding: 0 70px 0 70px;
    background: url(images/background.png);
}

#top { height: 141px; }

/*------- TOP -------*/
#logo
{
    background: url(images/logo.png);
    display: block;
    width: 263px;
    height: 141px;
    position: absolute;
    top: 0;
    left: 50px;
    text-indent: -9000px;
}

#addjoke
{
    background: url(images/addjoke.png) bottom left;
    display: block;
    width: 242px;
    height: 65px;
    position: absolute;
    top: 0;
    left: 360px;
    text-indent: -9000px;
}

#addjoke:hover { height: 95px; }

#quickbar
{
    background: url(images/quickbar.png);
    width: 160px;
    height: 69px;
    position: absolute;
    top: 0;
    left: 670px;
}

#quickbar form, a { display: none; }

/*------- MENU -------*/
#menu
{
    color: white;
    background: url(images/menumiddle.png) repeat-y;
    float: left;
    width: 207px;
}

#menu div.box
{
    margin-left: 20px;
    margin-right: 28px;
}

#menu span.top
{
    margin: 0;
    display: block;
    height: 10px;
    background: url(images/menutop.png);
}

#menu span.bottom
{
    margin: 0;
    display: block;
    height: 10px;
    background: url(images/menubottom.png);
}

#menu h2
{
    margin: 0;
    height: 31px;
    text-indent: -9000px;
}

#menu ul li
{
    padding-left: 15px;
    background: url(images/menubullet.png) left 4px no-repeat;
}

/*navigation*/
#navigation { background: url(images/navigation.png); }

/*youraccount*/
#youraccount { background: url(images/youraccount.png); }
img.avatar
{
    float: left;
    margin-right: 10px;
}
#menu_login { clear: both; margin-top: 20px; margin-bottom: 20px; }
#menu_login input
{
    padding: 2px 5px 2px 5px;
    color: white;
    background: black;
    border: 2px solid white;
    width: 145px;
}
#menu_login label.label_password { display: block; margin-top: 10px; }
#menu_login div
{
    margin-top: 5px;
    text-align: right;
}
#menu_login button
{
    text-indent: -9000px;
    border: 0;
    width: 57px;
    height: 28px;
    background: transparent url(images/loginbutton.png);
    cursor: pointer;
  cursor: hand;

}
#menu_login label
{
    font-weight: bold;
}

/*toprated*/
#toprated { background: url(images/toprated.png); }

/*newsletter*/
#newsletter { background: url(images/newsletter.png); }

/*recentcomments*/
#recentcomments { background: url(images/recentcomments.png); }

/*------- FOOTER -------*/
#footer
{
    background: url(images/footer.png);
    width: 779px;
    height: 57px;
    margin: 0 auto;
} 
```

这是我的 XHTML（目前还不完整）：

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
      "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
    <head>

        <title>Conforming XHTML 1.0 Strict Template</title>
        <meta name="description" content="" />
        <meta name="keywords" content="" />
        <meta name="author" content="" />
        <meta http-equiv="Content-Type" content="text/html;charset=ISO-8859-1" />

        <link rel="stylesheet" type="text/css" href="http://yui.yahooapis.com/2.7.0/build/reset/reset-min.css" /> 
        <link rel="stylesheet" type="text/css" href="stylesheet.css" />

    </head>

    <body>

        <div id="container">

            <div id="top">

                <a id="logo" href="http://superfunnyjokes.net/">SuperFunnyJokes.Net</a>
                <a id="addjoke">Add Joke</a>
                <div id="quickbar">

                    <form action="http://superfunnyjokes.net/search/" method="post">

                        <input type="text" name="query" />
                        <input type="submit" value="Search" />

                    </form>

                    <a href="http://superfunnyjokes.net/rss/">RSS Feed</a>

                </div>

            </div>

            <div id="menu">

                <!-- span for top of menu, replace with jquery -->
                <span class="top"></span>

                <h2 id="navigation">Navigation</h2>

                <div class="box">

                    <ul>

                        <li><a href="http://superfunnyjokes.net/">Home</a></li>
                        <li><a href="http://superfunnyjokes.net/categories/">Joke Categories</a></li>
                        <li><a href="http://superfunnyjokes.net/random/">Random Joke</a></li>
                        <li><a href="http://superfunnyjokes.net/members/registration/">Become A Member</a></li>
                        <li><a href="http://superfunnyjokes.net/add/">Add A Joke</a></li>

                    </ul>

                </div>

                <h2 id="youraccount">Your Account</h2>

                <div class="box">

                    <img class="avatar" src="images/noavatar.png" />
                    <p>Welcome back! You are not signed in.</p>

                    <form id="menu_login" action="http://superfunnyjokes.net/members/login.php" method="post">

                        <label for="menu_username">Username:</label>
                        <input id="menu_username" type="text" name="username" />
                        <label class="label_password" for="menu_password">Password:</label>
                        <input id="menu_password" type="password" name="password" />

                        <div><button type="submit">Login</button></div>

                    </form>

                </div>

                <h2 id="toprated">Top Rated Jokes</h2>

                <div class="box">

                    <ul class="ordered">

                        <li><a>The Werewolf and Me</a></li>
                        <li><a>Erection</a></li>
                        <li><a>The Werewolf and Me</a></li>
                        <li><a>Erection</a></li>
                        <li><a>The Werewolf and Me</a></li>             

                    </ul>

                </div>

                <h2 id="newsletter">Newsletter</h2>

                <div class="box">

                    <form id="menu_newsletter" action="http://superfunnyjokes.com/newsletter/register.php" method="post">

                        <table>
                            <tr>
                                <td><label for="menu_email">Email:</label></td>
                                <td><input id="menu_email" type="text" name="email" /></td>
                            </tr>
                            <tr>
                                <td></td>
                                <td><button type="submit">Sign Up</button></td>
                            </tr>

                        </table>

                    </form>

                </div>

                <h2 id="recentcomments">Recent Comments</h2>

                <div class="box">

                    <ul class="nobullet">

                        <li><strong>andworth:</strong> haha I really like that one</li>
                        <li><strong>andworth:</strong> haha I really like that one</li>
                        <li><strong>andworth:</strong> haha I really like that one</li>
                        <li><strong>andworth:</strong> haha I really like that one</li>
                        <li><strong>andworth:</strong> haha I really like that one</li>

                    </ul>

                </div>
            <!-- span for bottom of menu, replace with jquery -->
            <span class="bottom"></span>

            </div>

            <div id="main">

                <h2 class="sifr">THE WEREWOLF AND ME</h2>

                <p class="joke">
                    Lorem ipsum dolor sit amet, consectetur adipiscing elit. Aliquam blandit est eu lectus. Sed augue tortor, vehicula in, condimentum eget, tempor in, lectus. Integer enim leo, aliquam eget, hendrerit vel, laoreet a, turpis. Quisque sit amet ligula at quam condimentum ultricies. Sed molestie dolor non tellus. Vestibulum luctus nisi eget metus. Integer semper vestibulum nisl. Proin vel libero ac justo euismod sollicitudin. Duis a ligula sit amet quam fermentum convallis. Quisque tempus iaculis risus. Cras et libero vehicula lorem ultrices volutpat. Mauris quam quam, blandit et, facilisis in, sodales nec, libero. In massa tellus, varius non, luctus eu, facilisis rutrum, odio. Vivamus congue lacus quis metus.
                    <br /><br />
                    Nunc ultrices nisi ut tellus. In placerat tempus quam. Nulla dolor nulla, dictum eget, auctor a, rutrum sit amet, ante. Sed scelerisque est. Vestibulum arcu purus, dignissim nec, rhoncus id, sodales eu, quam. Nullam congue hendrerit enim. Phasellus risus. Pellentesque lacus sem, luctus tempus. 
                </p>

                <div id="jokedetails">

                    <table>
                        <tr>
                            <td>Submitted By:</td>
                            <td>admin</td>
                        </tr>
                        <tr>
                            <td>Date Submitted:</td>
                            <td>26/2/09</td>
                        </tr>
                        <tr>
                            <td>Views:</td>
                            <td>1891</td>
                        </tr>
                        <tr>
                            <td>Average Rating:</td>
                            <td>4.5 / 5</td>
                        </tr>
                    </table>

                    <form action="http://superfunnyjokes.net/process/rating.php" method="post">

                        <input name="starrating" type="radio" class="star {split:2}" /> 
                        <input name="starrating" type="radio" class="star {split:2}" /> 
                        <input name="starrating" type="radio" class="star {split:2}" /> 
                        <input name="starrating" type="radio" class="star {split:2}" /> 
                        <input name="starrating" type="radio" class="star {split:2}" /> 
                        <input name="starrating" type="radio" class="star {split:2}" /> 
                        <input name="starrating" type="radio" class="star {split:2}" /> 
                        <input name="starrating" type="radio" class="star {split:2}" /> 
                        <input name="starrating" type="radio" class="star {split:2}" /> 
                        <input name="starrating" type="radio" class="star {split:2}" /> 

                    </form>

                </div>

                <h2 id="comments">Comments</h2>

                <div class="comment">

                    <div class="left">
                        <img src="http://superfunnyjokes.net/members/avatars/noavatar.png" alt="No Avatar" />
                    </div>

                    <div class="right">

                        <h3>Ryan Polosky</h3>
                        <span>12 March 09</span>
                        <p>I found that joke really funny!</p>

                    </div>

                </div>

                <div class="comment">

                    <div class="left">
                        <img src="http://superfunnyjokes.net/members/avatars/noavatar.png" alt="No Avatar" />
                    </div>

                    <div class="right">

                        <h3>Laura Brauman</h3>
                        <span>12 March 09</span>
                        <p>Nunc ultrices nisi ut tellus. In placerat tempus quam. Nulla dolor nulla,
                        dictum eget, auctor a, rutrum sit amet, ante. Sed scelerisque est.
                        Vestibulum arcu purus, dignissim nec, rhoncus id, sodales eu, quam. Nullam
                        congue hendrerit enim. Phasellus risus. Pellentesque lacus sem, luctus
                        tempus.</p>

                    </div>

                </div>

                <div class="comment">

                    <div class="left">
                        <img src="http://superfunnyjokes.net/members/avatars/noavatar.png" alt="No Avatar" />
                    </div>

                    <div class="right">

                        <h3>James Brauman</h3>
                        <span>10 March 09</span>
                        <p>Haha! Good stuff!</p>

                    </div>

                </div>

                <h2 id="postcomment">Post Comment</h2>

                <div class="postcomment">

                    <div class="left">
                        <img src="images/noavatar.png" alt="No Avatar" />
                    </div>

                    <div class="right">

                        <table>
                            <tr>
                                <td><label for="commentname">Your Name:</label></td>
                                <td><input id="commentname" type="text" name="commentname" /></td>
                            </tr>
                            <tr>
                                <td colspan="2"><textarea cols="0" height="0"></textarea></td>
                            </tr>
                            <tr>
                                <td></td>
                                <td><button type="submit">Post</button></td>
                            </tr>

                        </table>

                    </div>

                </div>

            </div>

            <div id="footer">

            </div>
        </div>

    </body>
</html> 
```

“导航”标题下的整体`<ul>`正在消失，因为它充满了超链接。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-04-02T12:36:51.800

这条线将他们击倒：

```
#quickbar form, a { display:none; } 
```

# macos - CFRunLoopRemoveSource 和 CFRunLoopSourceInvalidate 的区别

> ID：709526
> 
> 赞同：3
> 
> 时间：2009-04-02T12:31:13.047
> 
> 标签：macos, crash, runloop

我在 Mac 上调试我的 HID 驱动程序代码中的崩溃，发现崩溃发生在 CFRunLoop 中。在驱动程序代码中，我打开与我的 HID 设备匹配的 VID 和 PID 的设备的 USB 句柄，然后使用 setInterruptReportHandlerCallback 函数为其设置中断回调，然后使用 CFRunLoopAddSource 调用将其添加到 CFRunLoop。在我调用关闭句柄时，我使用 CFRunLoopRemoveSource 释放它们，然后在 CFRunLoopSourceRef 上使用 CFRelease 。

当我尝试打开句柄等待一段时间（5ms）然后在循环中关闭句柄时会出现问题。

当我搜索问题时，我遇到了一个链接，在该链接中他们遇到了与我的[http://lists.apple.com/archives/usb/.../msg00099.html](http://lists.apple.com/archives/usb/.../msg00099.html)类似的问题，他们使用 CFRunLoopSourceInvalidate 调用而不是删除源调用。当我在关闭句柄调用中将其更改为 Invalidate source 时，它​​修复了我的崩溃。我想知道崩溃之间有什么区别，为什么这个调用修复了我的崩溃？

感谢 jbsp72

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-12-11T01:31:40.603

首先，让我谢谢你。我输入`CFRunLoopRemoveSource`谷歌，找到您的消息，这正是我试图解决的问题，而您通过调用的解决方案`CFRunLoopSourceInvalidate`也解决了我的问题。

`CFRunLoopRemoveSource`现在， an之间的区别`CFRunLoopSourceInvalidate`是：

*   `CFRunLoopRemoveSource`从您指定的特定运行循环中删除源。
*   `CFRunLoopSourceInvalidate`使源无效，并将其从添加的所有运行循环中删除。

现在，我怀疑与我遇到的崩溃相同，即添加源的运行循环已经消失，并且试图从中删除源会导致崩溃。实际上，`__spin_lock`就我而言，这是一个无限循环。

现在，运行循环如何消失？运行循环与线程相关联。你创建一个新线程，你有一个新的运行循环，自动。如果一个线程结束，run loop 就会随之消失。我将运行循环附加到的线程已退出，随后从运行循环中删除源会导致崩溃。

使运行循环无效解决问题的原因是因为它从它添加到的所有运行循环中删除了源，忽略了现在不再存在的运行循环。

# .net - MEF OSGi 是否适用于 .NET？

> ID：709532
> 
> 赞同：24
> 
> 时间：2009-04-02T12:34:44.007
> 
> 标签：.net, eclipse, plugins, osgi, mef

我现在只是想了解[托管可扩展性框架](http://www.codeplex.com/MEF)( [MEF](http://www.codeplex.com/MEF) ) 并深入研究一下。我有 Eclipse 背景，所以在我的大脑中，我目前有以下等式：

> `MEF =~ OSGi for .NET`

根据我目前所听到的。我在正确的路线上吗？

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2009-04-02T13:08:12.397

Scott Hanselman 在他与 Glenn Block的[播客 148](http://www.hanselman.com/blog/HanselminutesPodcast148MEFManagedExtensibilityFrameworkWithGlennBlock.aspx)中帮助突出了有关 MEF 的细节。

与 OSGi 相比，MEF 建立在“控制反转”之上，而[OSGi](http://www.osgi.org/Download/Release4V41)不是：它 (OSGi) 将通过基于生命周期层的不同机制发现新的捆绑包。

> [MEF](http://code.msdn.microsoft.com/mef)专注于应用程序的可扩展性。它使用 DI 作为组合不同扩展的策略，*但它本身并不是通用的 DI 容器*。

由于最后一点可能令人困惑，播客的文字[记录](http://perseus.franklins.net/hanselminutes_0148.pdf)可以提供帮助：

> 不过，我基本上定位它的方式，两者之间的区别在于，IoC 容器实际上是关于在不同环境中管理一组*已知*的事物，比如我想要在我的磁盘环境中使用一个记录器，我想要在我的测试环境中使用一个模拟记录器.
> 
> 所以 MEF 实际上是关于管理一组*未知*的事情，归结为，在 IoC 容器中，我倾向于做基于约定或注册的特定注册机制，这就是 logger 的意思，这就是这个意思是，这就是它的意思。
> 
> MEF 使用代码和代码上的发现机制和注释，它们是属性，无论系统中出现什么，它就是存在的。
> 
> **所以再一次，把它带到更高的层次，它是关于你使用 MEF 来真正管理一组*未知*的东西，你使用 IoC 容器来管理一组*已知*的东西。**

结论：（之一）主要区别在于发现原理（IoC 与生命周期）

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2011-05-23T07:11:19.917

请注意，OSGi 被设计为可以在其之上作为模块提供 IoC 容器，实际上，有多个用于 OSGi 的 IoC 容器以及其他机制：DS、iPOJO、Blueprint 等等。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-05-23T18:44:54.900

只是偶然发现了这一点，但[Prism](http://msdn.microsoft.com/en-us/library/gg406140.aspx)似乎是我见过的 .NET 中最接近 OSGi 的东西！查看文档中的[模块化应用程序开发](http://msdn.microsoft.com/en-US/library/gg405479%28v=pandp.40%29.aspx)部分。

看看他们的模块依赖示例（几乎等同于捆绑！）：

```
<modules>
  <module assemblyFile="Modules/ModuleD.dll" moduleType="ModuleD.ModuleD, ModuleD" moduleName="ModuleD">
    <dependencies>
      <dependency moduleName="ModuleB"/>
    </dependencies>
</module> 
```

微软的模式和实践团队似乎已经结束，相当于一种 OSGi 联盟。

# c# - 在 C# 中捕获多个按键

> ID：709540
> 
> 赞同：17
> 
> 时间：2009-04-02T12:36:45.310
> 
> 标签：c#, winforms

[在Windows 窗体](http://en.wikipedia.org/wiki/Windows_Forms)窗体中工作时，如何在 C# 中捕获多个按键？

我似乎无法同时获得向上箭头和向右箭头。

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2009-04-02T13:10:51.313

我认为当你使用 GetKeyboardState API 函数时你会做得最好。

```
[DllImport ("user32.dll")]
public static extern int GetKeyboardState( byte[] keystate );

private void Form1_KeyDown(object sender, KeyEventArgs e)
{
   byte[] keys = new byte[256];

   GetKeyboardState (keys);

   if ((keys[(int)Keys.Up] & keys[(int)Keys.Right] & 128 ) == 128)
   {
       Console.WriteLine ("Up Arrow key and Right Arrow key down.");
   }
} 
```

在 KeyDown 事件中，您只需询问键盘的“状态”。GetKeyboardState 将填充您提供的字节数组，并且此数组中的每个元素都表示键的状态。

您可以使用每个虚拟键代码的数值来访问每个键状态。当该键的字节设置为 129 或 128 时，表示该键已按下（按下）。如果该键的值为 1 或 0，则该键向上（未按下）。值 1 用于切换键状态（例如，大写锁定状态）。

有关详细信息，请参阅[GetKeyboardState 的 Microsoft 文档](http://msdn.microsoft.com/en-us/library/windows/desktop/ms646299(v=vs.85).aspx)。

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2009-04-02T12:51:44.230

为您提供一点概念验证代码，假设`Form1`包含`label1`：

```
private List<Keys> pressedKeys = new List<Keys>();

private void Form1_KeyDown(object sender, KeyEventArgs e)
{
    pressedKeys.Add(e.KeyCode);

    printPressedKeys();
}

private void Form1_KeyUp(object sender, KeyEventArgs e)
{
    pressedKeys.Remove(e.KeyCode);

    printPressedKeys();
}

private void printPressedKeys()
{
    label1.Text = string.Empty;
    foreach (var key in pressedKeys)
    {
        label1.Text += key.ToString() + Environment.NewLine;
    }
} 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2011-06-01T07:46:59.500

和

```
Keyboard.IsKeyDown(Key.YourKey) 
```

您可以处理多个按键。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-02T12:41:54.970

嗯，每个按键都有单独的事件吗？

您可以为每个箭头创建四个布尔值。当它被按下时，将该箭头的布尔值设置为 true。如果释放被触发，则将该箭头的布尔值设置为 false。

然后您可以检查 up 和 right 布尔值是否为真，然后执行您的操作。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2018-01-24T14:13:53.120

有一个托管库[MouseKeyHook 作为 NuGet](https://www.nuget.org/packages?q=MouseKeyHook)，它为您提供了一个方便的托管包装器。[GitHub 上的源代码](https://github.com/gmamaladze/globalmousekeyhook)。

最近添加了对检测快捷键、组合键和序列的支持。这是一个处理箭头的用法示例：

```
Hook.AppEvents().OnCombination(new Dictionary<Combination, Action>
{
    {Combination.FromString("Left"), GoWest},
    {Combination.FromString("Left+Up"), GoNorthWest},
    {Combination.FromString("Up+Left"), GoNorthWest},
    {Combination.FromString("Up"), GoNorth},
    {Combination.FromString("Up+Right"), GoNorthEast},
    {Combination.FromString("Right+Up"), GoNorthEast},
}); 
```

有关更多信息，请参阅：[检测键组合和序列](https://github.com/gmamaladze/globalmousekeyhook/blob/vNext/keycomb.md)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-04-02T13:15:36.997

使用 SPY++ 查看按键是如何触发的。基本上，如果同时按住多个箭头键，则被击中的第一个键将触发事件，然后当第二个键被击中时它将开始触发，您将不​​再看到第一个键的事件。当他们被释放时，你会看到他们的关键事件。我建议您实现之前建议的 bool 标志，它既快速又简单。

# c++ - 在 DLL 构建期间包含特定文件时，LoadLibrary 失败

> ID：709543
> 
> 赞同：4
> 
> 时间：2009-04-02T12:36:58.023
> 
> 标签：c++, loadlibrary

我的 C++ 应用程序的一个 DLL 中出现了非常奇怪的行为。它可以正常工作并加载，直到我在 DLL 的主文件中使用 #include 包含单个文件。然后我收到此错误消息：

从 D:/Targets/bin/MatrixWorkset.dll 加载组件 无法加载“D:/Targets/bin/MatrixWorkset.dll”：无法加载库 MatrixWorkset：对内存位置的访问无效。

现在我已经搜索并搜索了代码和谷歌，我无法弄清楚发生了什么。到目前为止，一切都在一个 DLL 中，我决定将它分成两个较小的。导致问题的文件是另一个第二个库的一部分（加载正常）。

任何想法都将不胜感激。谢谢， 雅科

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-04-02T13:55:41.377

可能的原因是具有类类型的全局。构造函数从 运行`DllMain()`，然后`DllMain()`在`LoadLibrary()`返回之前运行。`DllMain()`在返回之前，您可以做的事情有很多限制。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-02T12:45:59.097

标头是否可能在某处包含 #pragma comment(lib,"somelibrary.lib") 语句？如果是这样，它会自动尝试导入库。

为了解决这个问题，我首先使用depends（[http://www.dependencywalker.com/](http://www.dependencywalker.com/)）查看二进制文件，看看是否有任何你不期望的DLL依赖项。如果你确实找到了一些东西并且你在 Visual Studio 中，你应该在链接器上打开“显示进度”AKA /VERBOSE。

由于您获得了对内存位置的无效访问，因此 DLLMAIN 中可能存在某些内容或某些静态初始化程序正在崩溃。你能简化 MatrixWorkset.dll（假设你写的）吗？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-02T18:15:34.677

The error you describe sounds like a run-time error. Is this error displayed automatically by windows or is it one that your program emits?

I say attach a debugger to your application and trace where this error is coming from. Is Windows failing to load a dependency? Is your library somehow failing on load-up?

If you want to rule in/out this header file you're including, try pre-compiling your main source file both with and without this #include and diff the two results.

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-03T08:27:51.680

我还是没搞定。让我回答一些被问到的问题：

1) Windows 没有加载依赖项，我认为因为 Dependency Walker 显示一切正常。2) 我附加了一个调试器，它在尝试加载 MatrixWorkset.dll 时基本上会打印以下内容：

```
            10:04:19.234
stdout:&"警告：从 D:/ScinericSoftware/VisualWorkspace/trunk/Targets/bin/MatrixWorkset.dll 加载组件\n"
            10:04:19.234
标准输出：&"\n"
状态：已停止：“收到信号”
状态：停止。
            10:04:19.890
stdout:30*stopped,reason="signal-received",signal-name="SIGSEGV",signal-meaning="Segmentation fault",thread-id="1",frame={addr="0x7c919994",func= "towlower",args=[],from="C:\\WINDOWS\\system32\\ntdll.dll"}
输入：31信息共享
输入：32 堆栈列表参数 2 0 0
输入：33-stack-list-locals 2
输入：34 堆栈列表帧
输入：35-thread-list-ids
输入：36 数据列表寄存器值 x
            10:04:19.890

```

3）MSalters：我不确定您所说的“具有类类型的全局”是什么意思。出现问题的文件已包含在另一个 DLL 中，在该 DLL 中运行良好并且 DLL 加载成功。

这是 MatrixVariable.h 文件的顶部：

```
#include "QtSF/Variable.h" // 位于依赖 DLL（该文件始终存在的 DLL。
#include "Matrix.h" // 位于此 DLL 中的文件
#include "QList" // 这些都是来自 Qt 框架的文件
#include "QModelIndex"
#include "QItemSelection"
#include “QObject”

使用命名空间 Zenautics；
使用命名空间标准；

类 MatrixVariable：公共变量
{
    Q_OBJECT
    Q_PROPERTY(int RowCount READ rowCount WRITE setRowCount)
    Q_PROPERTY(int ColumnCount READ columnCount WRITE setColumnCount)
    Q_PROPERTY(int UndoPoints READ undoPoints WRITE setUndoPoints)

上市：
    //! 默认构造函数。
    MatrixVariable(const QString& name, int rows, int cols, double fill_real = 0, double fill_complex = 0, bool isReal = true);

```

等等等等等等

一种可能的解决方案是将 MatrixVariable 文件放回原始 DLL 中，但这违背了将 DLL 拆分为更小的部分的整个想法，这并不是一个真正的选择。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2010-07-11T18:25:42.993

我刚刚遇到了同样的问题。一直运行良好的 dll 突然停止工作。我在初始化静态对象的 CRT 内容中遇到了访问冲突。全部重建并没有解决问题。但是当我手动注释掉所有静态时，链接器抱怨文件损坏。再次链接：工作。现在我可以加载库了。然后，我一一添加了静态数据。每次，我都重新编译并测试了一个 LoadLibrary。每次都运行良好。最终，我所有的静力学都回来了，一切正常。

如果我不得不猜测，链接器使用的一些中间文件已损坏（我看到 ilk 文件不断被 link.exe 损坏）。如果可以，也许可以清除所有文件并进行干净的构建？但我猜你已经想通了，因为这已经 6 个月大了......

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-12-23T21:34:31.543

当我最近无法从命令行 EXE 加载 DLL 时，我从 GetLastError() 收到该错误。它曾经可以工作，然后我在 DLL 中添加了一些 MFC 代码。现在所有的赌注都取消了。

# c++ - 如何在 Apache 2.2 (c++) 中使用自定义错误响应进行响应？

> ID：709550
> 
> 赞同：0
> 
> 时间：2009-04-02T12:40:09.560
> 
> 标签：c++, apache, custom-error-pages

我目前正在尝试让我的 Apache 模块响应自定义错误消息，例如 400 包含附加信息，例如“坐标超出范围”。

我在谷歌上找到了多个消息来源说这是可能的，但没有人能告诉我怎么做。那么是否有一些功能可以让我这样做：

```
return apache_error( 400, "Coordinate %d is out of bounds.", coord.x ); 
```

?

提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-07-15T06:40:29.417

您可以在 request_rec 的 status_line 成员上设置它。

```
snprintf(buf, buf_size, "%d Coordinate %d is out of bounds", 400, coord.x);
req->status_line = buf;
req->status = 400; 
```

# php - 将 Facebook Connect 添加到 PHP 网站的最简单方法是什么？

> ID：709552
> 
> 赞同：0
> 
> 时间：2009-04-02T12:41:30.680
> 
> 标签：php, javascript, facebook

# 脸书连接

我花了几周时间整理了一个使用 Facebook 连接作为身份验证的基本网站。

我研究了提供的示例应用程序“theRunAround”。然而，代码很复杂，并且使用了大量的文件和类，其中大部分都有很多我不需要的功能。我也很好地阅读了文档。

我的代码*几乎*一直有效。但是，有时我会收到奇怪的、**不可预测**的错误。

## 所需功能

*   检查用户是否已登录 Facebook，如果已登录，则检索 fb_uid、姓名、个人资料图片
*   返回也连接到此应用程序的朋友列表

有没有比 Facebook 提供的关于这种简单功能的教程更好的教程？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-02T16:33:38.793

我最近使用 facebook 连接技术向[Cogenuity添加了朋友通知功能。](http://www.dynamicalsoftware.com/cogenuity)

首先，您需要在 php 代码中创建 facebook 对象。我假设您已经完成了 facebook 应用程序注册。我发现很多连接到 facebook 的部分都不起作用，但起作用的是这个。

```
$user = $facebook->require_login(); 
```

我发现 FQL 部分工作得很好。

```
$query = "select uid1 from friend where uid2 = {$user}";
$results = $facebook->api_client->fql_query($query); 
```

我使用了这个 FQL 查询，它可以满足您的需求。

```
$query = "SELECT name, pic_square, status, about_me FROM user WHERE uid = {$uid}";
$results = $facebook->api_client->fql_query($query); 
```

与 notification_send 方法一样。

```
$facebook->api_client->notifications_send($notifyTarget, $intro, 'user_to_user'); 
```

我希望这有帮助。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-02T16:55:35.277

我编写了自己的库来使用 Facebook Connect，因为我发现提供的库非常缺乏。

我无法提供代码，因为它是公司代码，但这里是我需要做的事情的细分。希望您可以使用它并自己轻松填写空白。

1.  在您的应用程序设置中，配置“连接”选项卡。在我的例子中，“连接 URL”是我的 xd_receiver.htm 文件所在的根文件夹。此外，在“高级”下，我将我的应用程序标记为 Web 应用程序。

2.  将您的 xd_receiver.htm 文件放在上面指定的根文件夹中。那里有大量关于 xd_receiver.htm 的文档。这是 facebook 在用户登录时点击的内容。它会将 cookie 写入他们的浏览器，您的应用程序稍后可以读取这些 cookie 以进行身份​​验证。

3.  Facebook 设置的 cookie 采用 _ 格式，其中 APIKEY 是您的应用程序 API 密钥，是 cookie 的名称。您将需要 _session_key cookie 来进行进一步的 API 调用。如果未设置此 cookie，则需要显示步骤 4 - 6 中所述的登录按钮。否则跳至步骤 7。

4.  您需要在您的页面上加载 Facebook javascript 文件，您将拥有 FB 登录按钮。==> [http://static.ak.connect.facebook.com/js/api_lib/v0.4/FeatureLoader.js.php](http://static.ak.connect.facebook.com/js/api_lib/v0.4/FeatureLoader.js.php)

5.  要显示 FB 登录按钮，请使用： Facebook JS 将自动为您呈现 facebook 登录按钮。它将触发用户登录后您应定义的“facebook_onlogin”方法，以便您可以在他们登录后执行某些操作。

6.  在上述标记的正下方，您需要调用 FB init javascript 以使其呈现按钮：

    FB.init('您的 API 密钥在这里', '您的 XD_RECEIVER.HTM 文件的绝对路径在这里');
7.  使用 cookie 中设置的 session_key 进行任何 API 调用。如何进行 API 调用有据可查。

* * *

希望这可以帮助。

# php - PHP：在注册表中创建一个文件夹

> ID：709558
> 
> 赞同：0
> 
> 时间：2009-04-02T12:43:32.160
> 
> 标签：php, windows, com, registry, wsh

如何使用 PHP 创建新的注册表值？

以下代码不起作用：

```
function registry_write($folder, $key, $value, $type="REG_SZ")
{
  $WshShell = new COM("WScript.Shell");

  $registry = "HKEY_LOCAL_MACHINE\\SOFTWARE\\" . $folder . "\\" . $key;
  //$result = $WshShell->RegRead($registry);
  $result = $WshShell->RegWrite($registry, $value, $type);

  return($result);
}

$folder = "7-ZIP";
$key = "Mac";
$value = "123";

registry_write($folder,$key,$value); 
```

已经有一个名为`7-ZIP`inside的键`HKEY_LOCAL_MACHINE\SOFTWARE`。

apache/logs 中的 error.log 中没有条目。

To : Tomalak 我如何修改这些权限/身份？有没有办法用php做到这一点？

我想做什么：我有一个 Adob​​e AIR 应用程序，我将它与 MySql 和 PHP 捆绑在一起。当这个应用程序安装在一台机器上时，我想把一些关于这台机器的信息放在注册表中，这样每次应用程序运行时我都可以验证它是否没有被盗版。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-02T13:10:43.357

除非您对默认权限/身份进行了修改，否则您的 Web 服务器进程（运行 PHP 的那个）没有对`HKEY_LOCAL_MACHINE`.

除此之外，您的注册表术语有些混乱。

注册表由“键”和“值”组成。每个值都有一个名称（和一个类型），每个键可以包含多个值和键。没有文件夹。

有鉴于此，我建议像这样重构您的函数：

```
function registry_write($key, $name, $value, $type="REG_SZ") {
  $WshShell = new COM("WScript.Shell");

  $path = "HKLM\\SOFTWARE\\$key\\$name";

  try {
    $WshShell->RegWrite($path, $value, $type);
    return true;
  }
  catch (Exception $e) {
    // echo or log the error
  }

  return false;
} 
```

# c# - 连接期间的 LINQ 内联属性更新

> ID：709560
> 
> 赞同：17
> 
> 时间：2009-04-02T12:44:52.017
> 
> 标签：c#, linq

我有两个对象，用于此讨论的 A 和 B。我可以通过公共关系或外键加入这些对象（表）。我正在使用 linq 来执行此连接，我只想在结果集中返回 ObjectA；但是，我想在连接期间使用来自 ObjectB 的数据更新 ObejctA 的属性，以便我从 LINQ 查询中得到的 ObjectAs 与它们在选择的存储介质中的原始状态“略有”不同。

这是我的查询，您可以看到我只想能够做类似 objectA.SomeProperty = objectB.AValueIWantBadly 的事情

我知道我可以在我的选择中做一个新的并启动新的 OBjectAs，但如果可能的话，我想避免这种情况并简单地更新一个字段。

```
return from objectA in GetObjectAs()
   join objectB in GetObjectBs()
           on objectA.Id equals objectB.AId
           // update object A with object B data before selecting it
   select objectA; 
```

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2009-04-02T12:50:55.153

将更新方法添加到您的 ClassA

```
class ClassA {
  public ClassA UpdateWithB(ClassB objectB) {
    // Do the update
    return this;
  }
} 
```

然后使用

```
return from objectA in GetObjectAs()
   join objectB in GetObjectBs()
           on objectA.Id equals objectB.AId
           // update object A with object B data before selecting it
   select objectA.UpdateWithB(objectB); 
```

**编辑**：

或者使用本地 lambda 函数，例如：

```
Func<ClassA, ClassB, ClassA> f = ((a,b)=> { a.DoSomethingWithB(b); return a;});
return from objectA in GetObjectAs()
       join objectB in GetObjectBs()
       on objectA.Id equals objectB.AId
       select f(objectA , objectA ); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-02T12:50:54.183

从“表”这个词，听起来你是从数据库中获取这些数据的。在这种情况下; 不：你不能这样做。您可以做的最接近的是选择对象和额外的列，然后更新属性：

```
var qry = from objectA in GetObjectAs()
          join objectB in GetObjectBs()
             on objectA.Id equals objectB.AId
          select new { A = objectA,
              objectB.SomeProp, objectB.SomeOtherProp };

foreach(var item in qry) {
    item.A.SomeProp = item.SomeProp;
    item.A.SomeOtherProp = item.SomeOtherProp;
    // perhaps "yield return item.A;" here
} 
```

如果你在做 LINQ-to-Objects，也许有一些你可以用流畅的 API 做的 hacky 方法——虽然不是很漂亮。（编辑 - 像[其他回复](https://stackoverflow.com/questions/709560/linq-in-line-property-update-during-join/709579#709579)一样）

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2015-05-14T16:30:48.993

我在这里进行左连接，因此即使 objectB 中的相应属性为空，我仍然拥有来自 objectA 的所有数据。因此，如果 objectB 中的相应属性为 null，那么您必须在 objectA 中定义要执行的操作。我一直使用这个语句来连接两组数据。您不需要详尽列出 objectA 中的所有属性以及它们如何映射，您只需列出要使用 objectB 更新的值。除非定义了到 objectB 的映射，否则 objectA 中预先存在的值是安全的。

```
return from objectA in GetObjectAs()
   join objectB in GetObjectBs()
   on objectA.Id equals objectB.AId into combinedObj
   from subObject in combinedObj.DefaultIfEmpty()
   // update object A with object B data before selecting it
   select ((Func<objectAType>)(() =>
    {
        objectA.property = ((subObject == null) ? "Object B was null" : subObject.property);
        objectA.property = ((subObject == null) ? "Object B was null" : subObject.property);
        return objectA;
    }))() 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2010-07-09T00:09:42.450

首先通过创建一个名为 LinqExtensions 的类来扩展 Linq 以具有 Each 选项。

```
 public static class LinqExtensions
  {
    public static void Each<T>(this IEnumerable<T> source, Action<T> method)
    {
      foreach (var item in source)
      {
        method(item);
      }
    }
  } 
```

然后，您可以使用 Join 返回一个新对象列表，其中包含具有适当值的原始对象。Each 将遍历它们，允许您将值作为参数分配或传递给每个对象。

赋值示例：

```
objectA.Join(objectB,a=>a.Id,b=>b.Id,(a,b) => new {a,b.AValueIWant}).Each(o=>o.a.SomeProperty=o.AValueIWant); 
```

参数传递示例：

```
objectA.Join(objectB,a=>a.Id,b=>b.Id,(a,b) => new {a,b.AValueIWant}).Each(o=>o.a.SomeMethod(o.AValueIWant)); 
```

这样做的好处是 ObjectA 和 ObjectB 不必是同一类型。我已经使用加入字典的对象列表（如查找）来完成此操作。不好的是不清楚发生了什么。你最好跳过每个扩展并这样写。

```
foreach(var change in objectA.Join(objectB,a=>a.Id,b=>b.Id,(a,b) => new {a,b.AValueIWant}))
{
  change.a.SomeProperty = change.AValueIWant;
  change.a.SomeMethod(change.AValueIWant);
} 
```

但为了更清楚，我可能会这样做：

```
foreach(var update in objectA.Join(objectB,objectA=>objectA.Id,objectB=>objectB.Id,(objectA,objectB) => new {objectA, Value = objectB.AValueIWant}))
{
  update.objectA.SomeProperty = update.Value;
} 
```

您将需要在新对象中返回整个 ObjectA，因为它将是只读的，并且这样做的唯一原因是因为引用了集合中的对象，从而允许您更改对象的属性。

但最终，最清楚的是跳过所有的 LINQ 连接，只循环遍历集合并查找匹配项，这将有助于未来的维护。LINQ 很棒，但就像当你有一把锤子时它不会把所有东西都变成钉子一样，当你有一个集合时，它并不意味着 LINQ 就是答案。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-02T12:50:06.260

你可以试试 let 语句吗？（不是在我的开发机器上自己测试）：

```
return from objectA in GetObjectAs()   
join objectB in GetObjectBs()
on objectA.Id equals objectB.AId
let objectA.SomeProperty = objectB.AValueIWantBadly
select objectA; 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2015-10-20T18:15:36.113

你可以通过以下方式尝试..

```
 var list1 = new List<ItemOne>
                        {
                            new ItemOne {IDItem = 1, OneProperty = "1"},
                            new ItemOne {IDItem = 2, OneProperty = null},
                            new ItemOne {IDItem = 3, OneProperty = "3"},
                            new ItemOne {IDItem = 4, OneProperty = "4"}
                        };
        var list2 = new List<ItemTwo>
                        {
                            new ItemTwo {IDItem = 2, TwoProperty = "2"},
                            new ItemTwo {IDItem = 3, TwoProperty = "3"},
                        };

        var query = list1.Join(list2, l1 => l1.IDItem, l2 => l2.IDItem, (l1, l2) =>
        {
            l1.OneProperty = l2.TwoProperty;
            return l1;
        }); 
```

# c# - 在 C# 中将 DataSource 分配给 ListBox 时，如何从 ListBox 中删除所选项目？

> ID：709562
> 
> 赞同：5
> 
> 时间：2009-04-02T12:44:52.250
> 
> 标签：c#

在 C# 中将数据源分配给 ListBox 时，如何从 ListBox 中删除所选项目？

尝试删除时出现错误

**“设置 DataSource 属性时无法修改项目集合。”**

* * *

但是当我尝试从数据源（数据表）中删除项目时，

它将错误作为“数据行不在当前行集合中”。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-04-02T12:48:11.867

在 DataSource 对象中找到该项目并将其删除，然后重新绑定 ListBox。

**编辑**：

以下是从 DataTable 中删除作为 DataSource 的方法，无论 .NET 版本如何。

```
DataRowView rowView = listBox.SelectedItem as DataRowView;

if (null == rowView)
{
    return;
}

dt.Rows.Remove(rowView.Row); 
```

除了 WinForms DataGridViews，我没有尝试过其他任何东西，但我强烈推荐[BindingListView](http://blw.sourceforge.net/)，它比 DataTables/Views 更快，并且允许您将通用 List<T>s 绑定为数据源。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-02T13:06:42.947

或者，使用实现 IBindingList 或从 BindingList 继承的列表。当从绑定列表中添加或删除对象时，绑定到它的任何控件都会自动收到更改通知，并将相应地更新自己。如果您使用 BindingList 并且您的类也实现了 INotifyProperty 更改，则对类属性的任何更改也将在数据绑定控件中自动更新。例如，如果数据网格（视图）中的列绑定到属性“名称”，并且您更改数据源中的“名称”，则数据网格将自动更新。如果向数据源添加新项目，数据网格将自动更新。绑定列表还支持另一个方向的通知。如果用户在数据网格中编辑“名称”字段，则绑定对象将自动更新。稍微偏离主题，如果您再进一步并在 BindingList 中隐含“SupportsSortingCore”和相关方法，您可以为您的数据添加自动排序。单击列标题将自动对列表进行排序并显示标题排序方向箭头。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2011-06-08T22:29:26.547

当您收到消息“设置 DataSource 属性时无法修改项目集合”时。当代码初始化组件未完成时，将数据源设置为其他内容、空列表或 null 无济于事。

为避免该错误，必须在表单加载期间或之后更改数据源或项目列表。

我知道这似乎没有意义。但是，如果在初始化组件结束之前发现任何更改项目的代码，Visual Studio 设计器将以 Designer.cs 或 vb 形式生成代码，这些代码会将项目添加到列表框

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-02T12:51:43.027

如果 ListBox 分配了数据源，则必须从数据源中删除项目，然后重新绑定 ListBox

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-02T13:00:29.123

您需要修改数据源而不是控件的 Items 集合。根据您绑定到的数据源类型，您需要执行不同的操作才能更新 UI。

最好的方法是找到一个适合您需要并实现 IBindingList 或 IBindingListView 的集合。这两个接口甚至实现了侦听 CollectionChanged 事件并相应地更新您的 UI 的处理程序。

如果您的集合不支持这些接口，那么每次有人添加/删除项目时，您都必须重新绑定您的数据源。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-06-10T07:25:09.563

它的变化很简单，为列表框分配一个新的空白值，例如..

将 ABC 调暗为新列表（字符串）（）

ListBox1.DataSource = ABC

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2010-04-29T14:48:24.047

ListBox 实现存在错误，您需要为组件创建一个新的数据源实例，以便它识别更改。

例如：

```
ActivitiesList.DataSource = _activities;

_activities = new List<Activity>(_activities);
_activities.Remove((Activity)ActivitiesList.SelectedItem);

ActivitiesList.DataSource = _activities; 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2012-02-27T18:32:35.767

虽然 Chris Doggett 发布了一个有效的解决方案，但我在使用它时遇到了问题。通过使用该方法，它不允许后续的 GetChanges(DataRowState.Deleted) 正常工作。

为了更好地解决我的问题，我只需要更改一行 - 最后一行。

```
DataRowView rowView = listBox.SelectedItem as DataRowView;

if (null == rowView)
{
    return;
}

rowView.Row.Delete(); 
```

这允许我的 GetChanges 调用正常工作。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2012-04-15T13:11:36.760

这对我有用

```
 DataTable temp = (DataTable)lstBlocks.DataSource;
        temp.Rows.RemoveAt(position); 
```

# java - 避免 Java/Servlet Web 堆栈中的 IllegalStateException

> ID：709564
> 
> 赞同：0
> 
> 时间：2009-04-02T12:45:56.833
> 
> 标签：java, jsp, servlets, jakarta-ee

我不知道，但我觉得 IllegalStateException 导致撤消头痛。如果我有一个请求，请说一个 JSP 或其他一些 servlet，并且需要将一个过滤器与该请求相关联。如果响应已经提交，我不能对客户端的输出进行任何其他修改吗？

例如，我在 JSP 代码中看到将 mimetype 设置为 response.setContent("html")，然后我有一个与需要将 mimetype 设置为其他内容的 JSP 关联的过滤器。设置内容（“图像”）或“xhtml”。但我得到一个 IllegalStateException？

有没有办法清除先前已提交的响应，或者有什么方法可以避免这个问题。

这是在 websphere 上。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-02T12:51:26.117

我认为您需要重新考虑如何准备和回复您的回复。您不能写入响应（*可能会*写入客户端）然后改变主意。

撇开为什么您的解决方案必须更改返回类型的问题不谈，我将使用返回日期 + 类型写入一些虚拟容器对象，并使其可变。只有在您的 servlet 完成所有工作后，您才会将此对象（类型+内容）写入输出流。

（澄清一下，我不认为 servlet 过滤器是正确的方法。它们会拦截请求和响应，但响应人口是 servlet 的责任）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-02T13:46:06.643

我同意其他发帖人的观点，即这很丑陋，但您可以在过滤器中创建一个 HttpServletResponseWrapper 来劫持输出并将该包装器传递给链而不是原始响应对象。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-02T13:05:10.687

您执行 jsp 输出 HTML，然后在同一响应中将内容类型更改为其他内容的过滤器的前提是没有意义的。响应只能返回单个工件，无论是 HTML 文件还是图像。没有办法在同一个响应中返回两者——任何这样做的尝试都是无稽之谈。发送一些带有图像二进制文件的 HTML 是没有意义的。内容类型适用于整个响应。您不能在一个响应中打包多个事物。

有时，如果输出未超过缓冲区大小，您可以 resetBuffer()。最好的方法是避免这种设施，并且在开始输出响应之前要做什么。

# php - 是否在“ESC”上取消了通过 AJAX 调用的 PHP 进程？

> ID：709569
> 
> 赞同：5
> 
> 时间：2009-04-02T12:47:12.120
> 
> 标签：php, ajax, background-process, request-cancelling

如果我进行 AJAX 调用，如果用户按下“ESC”或离开该页面，AJAX 调用会被取消吗？

如果 AJAX 调用被取消，我的 PHP 脚本会继续运行直到它完成它正在做的事情（前提是没有达到时间限制或任何其他服务器配置停止。），还是该进程会同时被杀死它所属的 Apache 孩子？

如果该进程确实被 Apache 子进程杀死，即使它没有完成，那么保持它活着的最佳方法是什么，或者我应该考虑哪些其他选择？（ZendX_Console_Process_Unix 不是一个选项）。

谢谢！

后来的发现：

如果我在 Firefox 中点击“ESC”（在 firebug 中检查），AJAX 调用实际上会被取消。PHP 进程继续进行，不受按 ESC 或关闭选项卡的影响。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-02T12:54:27.373

如果服务器进程在用户结束 ajax 调用（关闭窗口，或移动到另一个网站）之前启动，那么它将一直执行到最终结果。但是一个中断的ajax调用（意味着数据的传输没有完成）服务器不会处理这个调用。

注意：点击 ESC 本身不会结束 ajax 调用，除非您对按键行为进行了 javascripted。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2009-04-02T13:07:54.597

注意...如果您从超链接调用 AJAX 调用，使用 href 属性，然后是，用户可以按 ESC 并停止传输。

```
<a href="javascript:doFoo();">This can be canceled by pressing ESC</a>

<a href="#" onclick="doFoo();">This can NOT be canceled by pressing ESC</a> 
```

# wcf - 如何为具有 HTTPS 端点的 WCF 服务生成客户端代理？

> ID：709580
> 
> 赞同：3
> 
> 时间：2009-04-02T12:51:03.200
> 
> 标签：wcf, security, authentication, https

可能与此 previuos 问题相同的问题：[WCF 代理](https://stackoverflow.com/questions/703698/generating-wcf-proxy-against-untrusted-ssl-endpoint)但不确定...

我有一个配置为使用传输安全性的 HTTPS 服务，我希望还有 Windows 凭据。该服务只能在内部访问（即在 Intranet 内）。配置如下：

```
<configuration>
  <system.serviceModel>
    <services>
      <service name="WCFTest.CalculatorService" behaviorConfiguration="WCFTest.CalculatorBehavior">
        <host>
          <baseAddresses>
            <add baseAddress = "https://localhost:8000/WCFTest/CalculatorService/" />
          </baseAddresses>
        </host>
        <endpoint address ="basicHttpEP" binding="basicHttpBinding" contract="WCFTest.ICalculatorService" bindingConfiguration="basicHttpBindingConfig"/>    
        <endpoint address="mex" binding="mexHttpsBinding" contract="IMetadataExchange"/>
      </service>
    </services>
    <bindings>
      <basicHttpBinding>
        <binding name="basicHttpBindingConfig">
          <security mode="Transport">
            <transport clientCredentialType = "Windows"/>
          </security>
        </binding>
      </basicHttpBinding>
    </bindings>
    <behaviors>
      <serviceBehaviors>
        <behavior name="WCFTest.CalculatorBehavior">          
          <serviceAuthorization impersonateCallerForAllOperations="false"  principalPermissionMode="UseWindowsGroups" />
          <serviceCredentials >
            <windowsAuthentication allowAnonymousLogons="false" includeWindowsGroups="true" />
          </serviceCredentials>
          <serviceMetadata httpsGetEnabled="True"/>
          <serviceDebug includeExceptionDetailInFaults="False" />
        </behavior>
      </serviceBehaviors>
    </behaviors>
  </system.serviceModel>
</configuration> 
```

当我运行该服务时，我在 IE 中看不到该服务。我收到“无法显示此页面”错误。如果我尝试通过“添加服务引用”向导在 VS2008 中创建客户端，我会收到此错误：

> 下载“ [https://localhost:8000/WCFTest/CalculatorService/](https://localhost:8000/WCFTest/CalculatorService/) ”时出错。下载“ [https://localhost:8000/WCFTest/CalculatorService/](https://localhost:8000/WCFTest/CalculatorService/) ”时出错。底层连接已关闭：发送时发生意外错误。身份验证失败，因为远程方已关闭传输流。元数据包含无法解析的引用：“ [https://localhost:8000/WCFTest/CalculatorService/](https://localhost:8000/WCFTest/CalculatorService/) ”。[向https://localhost:8000/WCFTest/CalculatorService/](https://localhost:8000/WCFTest/CalculatorService/)发出 HTTP 请求时出错 . 这可能是由于在 HTTPS 情况下未使用 HTTP.SYS 正确配置服务器证书。这也可能是由于客户端和服务器之间的安全绑定不匹配造成的。底层连接已关闭：发送时发生意外错误。身份验证失败，因为远程方已关闭传输流。如果在当前解决方案中定义了服务，请尝试构建解决方案并再次添加服务引用。

我想我在这里缺少一些基本的基础知识。我需要设置一些证书吗？还是应该像我使用 NetTcpBinding 时那样工作？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-02T19:26:31.327

ng5000,

似乎您在这里可能有另一个问题（可能是 IIS）。关闭传输级安全性是否有任何问题？在检查 WCF 内容之前，我还会确保您可以访问 IE 中的网址。听起来像是安全选项卡中不正确的 IIS 设置。

如果仍然存在问题，请尝试在关闭传输级安全性的情况下构建代理，然后返回并将两个配置更改为传输级 Windows 安全性，看看会发生什么。

-布莱恩

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2010-04-21T04:02:08.910

```
...
<security defaultAlgorithmSuite="Default" authenticationMode="IssuedTokenOverTransport"
                    requireDerivedKeys="false" securityHeaderLayout="Strict" includeTimestamp="true"
                    keyEntropyMode="CombinedEntropy" messageSecurityVersion="WSSecurity11WSTrustFebruary2005WSSecureConversationFebruary2005WSSecurityPolicy11BasicSecurityProfile10">
                    <issuedTokenParameters keyType="SymmetricKey" tokenType="" />
... 
```

这是我的解决方法。我得到了上面的配置文件并将 authenticationMode 从“IssuedTokenOverTransport”更改为“UserNameOverTransport”。它解决了我的环境问题。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2009-04-09T20:15:31.920

改变

```
<endpoint address ="basicHttpEP" binding="basicHttpBinding" contract="WCFTest.ICalculatorService" bindingConfiguration="basicHttpBindingConfig"/> 
```

到

```
<endpoint address ="basicHttpEP" binding="basicHttpsBinding" contract="WCFTest.ICalculatorService" bindingConfiguration="basicHttpBindingConfig"/> 
```

# asp.net - ASP NET MVC 服务器对基本 ajax 请求的响应

> ID：709586
> 
> 赞同：0
> 
> 时间：2009-04-02T12:53:37.720
> 
> 标签：asp.net, asp.net-mvc

我们必须在 Notrhwind.mdb 的 Customer.html 中为基本的 ajax 导航制​​作一个 ASP.NET MVC 或 ASP.NET 应用程序。

我们有这三样东西：

1.  具有 HTML 输入文本标签的纯 HTML/JavaScript 表单，每个字段对应客户表。我们还有 2 个导航按钮：NextRecord 和 PrevRecord 在 OnClick() 事件中：clientGetRecord(NextOrPrev)

2.  一个 javascript ajax clientGetRecord 函数，如下所示：

    ```
    function clientGetRecord(NextOrPrev) {
        var oXMLHTTP = new ActiveXObject("Microsoft.XMLHTTP");
        var sURL = "ServerGetRecord.aspx?ID=" + NextOrPrev;
        oXMLHTTP.open( "POST", sURL, FALSE );
        oXMLHTTP.send();
        var sResult=oXMLHTTP.responseText;
        var aRecord = sResult.split(";");
        document.getElementById('CustomerID').value = aRecord[0];
        document.getElementById('CompanyName').value = aRecord[1];
        document.getElementById('ContactName').value = aRecord[2];
        document.getElementById('Adress').value = aRecord[3];
        //... and so on ...
    }; 
    ```

3.  我们必须有类似 ServerGetRecord 控制函数的东西，它返回到 clientGetRecord 函数，一个简单的字符串，包含用逗号分隔的当前记录字段值，并使用经典的 ADO 数据库处理。

问题是：如何编程和调用ServerGetRecord函数？我可以有一个 ServerGetRecord 函数的 VB 代码示例（或 ASPX、或 ASHX 或其他东西？..）？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-02T12:59:45.990

没有任何 VB smaples 适合您，但您可以创建一个返回 JsonResult 的控制器 (asp.net mvc)。您从数据库中获取数据并构建要返回的 JsonResult 对象。

然后在您的客户端上使用 jQuery 调用控制器并以 json 格式获取结果。

这篇文章可以帮助您入门： http: [//geekswithblogs.net/michelotti/archive/2008/06/28/mvc-json---jsonresult-and-jquery.aspx](http://geekswithblogs.net/michelotti/archive/2008/06/28/mvc-json---jsonresult-and-jquery.aspx)

希望这可以帮助

# xml - 打印出 XSL 变量的值

> ID：709594
> 
> 赞同：18
> 
> 时间：2009-04-02T12:57:16.917
> 
> 标签：xml, xslt

有人可以告诉我如何在我的 XSL 转换中打印出一个变量吗？似乎是一件很容易做的事情，但我似乎做不到。这是我的代码：

```
<?xml version='1.0' encoding='UTF-8' ?>
<xsl:stylesheet version="1.0"
  xmlns:fn="http://www.w3.org/2005/02/xpath-functions" xmlns:xsl="http://www.w3.org/1999/XSL/Transform">

  <xsl:template name="ControlledListStructure">
    <xsl:param name="xmlElem" />
    <xsl:param name="dataName" />

    <xsl:element name="{$xmlElem}">
      1: <xsl:text>{$xmlElem}</xsl:text>.
      2: {$xmlElem}.
    </xsl:element>
  </xsl:template>

</xsl:stylesheet> 
```

如果我使用 xmlElem 的值“Wibble”（字符串 - 不是节点）调用此模板，我会得到以下输出：

```
<Wibble>
      1: {$xmlElem}.
      2: {$xmlElem}.
</Wibble> 
```

所以我的参数是正确的，我只是无法正确访问它。有人可以告诉我如何让 $xmlElem 正确打印出来，以便我看到：

```
<Wibble>
      1: Wibble.
      2: Wibble.
</Wibble> 
```

感谢您的任何意见。

* * *

## 回答 #1

> 赞同：33
> 
> 时间：2009-04-02T13:46:17.763

**所有答案都缺少重要的东西：进一步阅读：**

> 有人可以告诉我如何在我的 XSL 转换中打印出一个变量吗？似乎是一件很容易做的事情，但我似乎做不到。

**在 XSLT 1.0 中，有两种主要的方法来生成 的内容[`<xsl:variable>`](http://www.w3.org/TR/xslt#variables)，**这取决于它是包含标量值（字符串、数字或布尔值）还是具有结构化值——节点集（来自 xml 文档的一个或多个节点(s)):

1.  [**`<xsl:value-of select="$yourscalarVariableName"/>`**](http://www.w3.org/TR/xslt#element-value-of) 使用它来产生一个标量值。实际上产生一个文本节点，包含这个标量值。

2.  [**`<xsl:copy-of select="$yourStructuredVariableName"/>`**](http://www.w3.org/TR/xslt#element-copy-of) 使用它来生成变量中包含的所有节点的副本。

**非常重要的是要知道**，如果 an`xsl:variable`包含节点列表并且`<xsl:value-of ...>`使用该指令，则只会产生第一个节点的字符串值。这是一个经常犯的错误和常见问题解答。

**还有第三种方法**：如果`<xsl:variable>`应该在生成属性时使用：

```
 <someLiteralResultElement someAttribute="{$theVariable}"/> 
```

计算大括号中的 XPath 表达式（称为[**AVT -- attribute-value-template**](http://www.w3.org/TR/xslt#attribute-value-templates)）并将结果放入属性值中。

**在 XSLT 2.0**中，当在非兼容模式下运行时，该`<xsl:value-of .../>`指令会生成一个文本节点列表——每个节点对应一个`xsl:variable`. 在兼容模式下运行时（已`version="1.0"`指定属性），该`<xsl:value-of>`指令的行为方式与其在 XSLT 1.0 中的行为方式相同。

**在 Xslt 2.0** `<xsl:copy-of>`中的行为方式与在 XSLT 1.0 中相同。但是建议使用 new[**`<xsl:sequence>`**](http://www.w3.org/TR/xslt20/#element-sequence)指令，因为前者会为每个节点生成一个新副本，而`<xsl:sequence>`不会生成新的节点副本。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2009-04-02T12:59:42.387

试试这个：

```
<xsl:value-of select="$xmlElem"/> 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-04-02T12:59:48.470

您可以使用：

```
<xsl:value-of select="$xmlElem" /> 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-04-02T12:59:55.427

该`{$xmlElem}`语法仅适用于属性。你需要：

```
<xsl:value-of select="$xslElem" /> 
```

# c# - 如何在 C# 中找到 DataGridViewCell 背景颜色？

> ID：709596
> 
> 赞同：0
> 
> 时间：2009-04-02T12:58:18.160
> 
> 标签：c#, winforms

如何在 C# - windows 应用程序中找到 DataGridViewCell 背景颜色？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-02T13:05:03.463

在 bytes.com 上看到了这个，另一个用户声称它可以工作，虽然我没有测试过（这是 VB）：

```
DataGridView1.Item(ColumnIndex, RowIndex).Style.BackColor = Color 
```

或者

```
DataGridView1.CurrentCell.Style.BackColor = Color 
```

另请参阅 MSDN 文档：

[http://msdn.microsoft.com/en-us/library/system.windows.forms.datagridviewcell.style.aspx](http://msdn.microsoft.com/en-us/library/system.windows.forms.datagridviewcell.style.aspx)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-02T13:55:31.953

如果您需要此信息来更改单元格的呈现，您可以插入 Paint 或 Formatting 事件，EventArgs 有一个 CellStyle 属性，其中包含背景颜色。

# c# - 将文本添加到视频文件

> ID：709597
> 
> 赞同：-5
> 
> 时间：2009-04-02T12:58:31.047
> 
> 标签：c#, video, subtitle

我需要在视频文件中添加文本。我需要阅读一个视频文件并向其中添加一行文本。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-02T13:06:19.747

你正在进入一个高度被忽视的领域。我的意思是 MS 真的忽略了它，即使是最简单的事情也会很快变成一团糟。

现在供您选择：

*   查看[DirectShow.net](http://directshownet.sourceforge.net/) 项目。它包装了 DirectShow 库，让您可以通过视频执行各种操作。
*   有人展示了（谷歌周围）如何在 WPF 上播放视频。您可以轻松添加文本或其他内容，但我不确定是否保存。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-02T13:02:56.667

阅读视频 Alpha 混合。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-02T13:03:15.543

这不是一个真正的问题，您需要具体并提供上下文，否则人们很难提供帮助。

你说需要加一行文字，这是一次性活动吗？1 个视频，1 行文字？显示视频时是否需要显示一行文字；多个视频，每个视频都有一行文字？潜在场景的列表实际上是无穷无尽的，您还没有说明您已经尝试过什么来实现这一点。

只是将其标记为 C# 并不会帮助我担心。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-02T13:09:10.303

DirectShow VRM7 和 VRM9（视频渲染器）都允许您在显示视频时执行此操作。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-08-03T16:47:51.257

您可以使用命令行并从中运行额外的工具吗？例如，ffmpeg 或 VideoCHARge Studio

# sql - “可以以确定的方式使用非确定性用户定义函数”是什么意思？

> ID：709601
> 
> 赞同：6
> 
> 时间：2009-04-02T12:59:45.100
> 
> 标签：sql, sql-server, user-defined-functions, deterministic, non-deterministic

根据 MSDN SQL BOL (Books Online) page on [Deterministic and Nondeterministic Functions](http://msdn.microsoft.com/en-us/library/ms178091.aspx)，非确定性函数可以“*以确定的方式*”使用

> 以下函数并不总是确定性的，但当它们以确定性方式指定时，可用于索引视图或计算列的索引。

非确定性函数可以以**确定性方式**使用是什么意思？
有人可以说明**如何**做到这一点吗？你会**在哪里**这样做？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-04-02T13:06:29.467

一个函数是确定性的意味着它保证总是为相同的输入参数返回相同的输出值。

我假设以确定性方式使用非确定性函数意味着您确保将传递给函数的参数范围使得返回值是确定性的，即。仅依赖于这些论点。

这在实践中意味着什么取决于函数做什么以及它以何种方式是不确定的。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-04-02T13:12:07.753

一个例子：

```
RAND(1)  // deterministic, always returns the same number 
```

相对：

```
RAND()   // non-deterministic, returns new random number on each call 
```

请注意，这使用了 MSDN 文章对“确定性”一词的定义

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-04-02T13:06:47.923

BOL 实际上指出：

> 以下函数**并不总是确定性**的，但可以在以确定性方式指定的索引视图或计算列的索引中使用。

然后在下面说明必须满足哪些条件才能使它们具有确定性。

例如

> CAST - 确定性，除非与 datetime、smalldatetime 或 sql_variant 一起使用

换句话说，您需要满足这些条件才能以*确定的方式使用它们*

例如，当您创建表时

```
CREATE TABLE [dbo].[deterministicTest](
    [intDate] [int] NULL,
    [dateDateTime] [datetime] NULL,
    [castIntToDateTime]  AS (CONVERT([datetime],[intDate],0)),
    [castDateTimeToInt]  AS (CONVERT([int],[dateDateTime],0)),
    [castIntToVarchar]  AS (CONVERT([varchar],[intDate],0))
) ON [PRIMARY] 
```

您可以在 castIntToVarchar 上应用索引，但如果您尝试将索引添加到 castDateTimeToInt 或 castIntToDateTime 您将收到以下错误：

*表 'dbo.deterministicTest' 中的列 'castDateTimeToInt'(castIntToDateTime) 不能用于索引或统计信息或用作分区键，因为它是不确定的。*

因此，如果您想保持确定性，dateTime 既不能用作 CONVERT 函数的源格式，也不能用作目标格式

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-10-02T13:58:28.187

BOL 定义应为：

”确定性函数在使用一组特定的输入值（行）调用并给定相同的数据库状态时，总是在同一行上返回相同的结果。

换句话说，确定性函数总是在其域中的任何特定固定值上返回相同的结果（在这种情况下，域是一行）。

每次使用一组特定的输入值（行）调用非确定性函数时，即使它们访问的数据库状态保持不变，它们也可能返回不同的结果。

在这种情况下，非确定性函数

a) 每次调用时返回不同的值。

b）取决于它们应用的行之外的值。

a) 组示例：未指定种子的 NEWID()、GETDATE()、GETUTDATE()、RAND()。

b) 组的示例：使用 OVER 和 ORDER BY 子句指定时，GET_TRANSMISSION_STATUS()、LAG()、RANK()、DENSE_RANK()、ROW_NUMBER()、NTILE()、SUM()。”</p>

请注意，[一些作者使用了不同的确定性函数定义，](https://dba.stackexchange.com/questions/77639/are-rank-and-dense-rank-deterministic-or-non-deterministic)这可能会导致混淆。

# .net - 以编程方式搜索 PDF 文件中的文本并告诉页码？

> ID：709606
> 
> 赞同：7
> 
> 时间：2009-04-02T13:00:50.433
> 
> 标签：.net, pdf, text-search

有一些工具允许提取 PDF 文件的整个文本部分，以便对 PDF 进行全文索引。

我需要的是一种搜索某些字符串的方法，如果在 PDF 文件中找到它们，返回页码？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-02T13:10:18.600

此示例使用 Adob​​e Reader 附带的库，来自[http://www.dotnetspider.com/resources/5040-Get-PDF-Page-Number.aspx](http://www.dotnetspider.com/resources/5040-Get-PDF-Page-Number.aspx)：

```
using Acrobat;
using AFORMAUTLib;                          
private void pdfRandD(string fPath)
{
    AcroPDDocClass objPages = new AcroPDDocClass();
    objPages.Open(fPath);
    long TotalPDFPages = objPages.GetNumPages();            
    objPages.Close();
    AcroAVDocClass avDoc = new AcroAVDocClass();
    avDoc.Open(fPath, "Title");
    IAFormApp formApp = new AFormAppClass();
    IFields myFields = (IFields)formApp.Fields;            
    string searchWord = "Search String";
    string k = "";
    StreamWriter sw = new
        StreamWriter(@"D:\KCG_FileChecker_Inputs\MAC\pdf\0230_525490_23_cha17.txt", false);
    for (int p = 0; p < TotalPDFPages; p++)
    {                
        int numWords = int.Parse(myFields.ExecuteThisJavascript("event.value=this.getPageNumWords(" + p + ");"));
        k = "";
        for (int i = 0; i < numWords; i++)
        {
            string chkWord = myFields.ExecuteThisJavascript("event.value=this.getPageNthWord(" + p + "," + i + ", true);");
            k = k + " " + chkWord;
        }                
        if(k.Trim().Contains(searchWord))
        {
           int pNum = int.Parse(myFields.ExecuteThisJavascript("event.value=this.getPageLabel(" + p + ",true);"));
           sw.WriteLine("The Word " + searchWord + " is exists in " + pNum);                    
        }

     }
     sw.Close();
     MessageBox.Show("Process completed");
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2011-09-08T17:52:09.467

您可以使用[Docotic.Pdf 库](https://bitmiracle.com/pdf-library/)来搜索 PDF 文件中的文本。

以下示例显示了如何在 PDF 文件中查找指定的字符串和相应的页码：

```
static void searchForTextStrings()
{
    string path = "";
    string[] stringsToFind = new string[] { };

    using (PdfDocument pdf = new PdfDocument(path))
    {
        for (int i = 0; i < pdf.Pages.Count; i++)
        {
            string pageText = pdf.Pages[i].GetText();
            foreach (string s in stringsToFind)
            {
                int index = pageText.IndexOf(s, 0, StringComparison.CurrentCultureIgnoreCase);
                if (index != -1)
                    Console.WriteLine("'{0}' found on page {1}", s, i);
            }
        }
    }
} 
```

如果删除 IndexOf 方法的第三个参数，则可以进行区分大小写的搜索。

免责声明：我为图书馆供应商 Bit Miracle 工作。

# c++ - 当我将它放在我的 while 语句之外时，为什么我的 ofstream 不起作用？

> ID：709612
> 
> 赞同：0
> 
> 时间：2009-04-02T13:02:02.363
> 
> 标签：c++, serialization, file-io, fstream

每次我做任何事情，并且在我的主函数中调用我的 while(1) 时，我的文件都会被清除。这让我疯狂。我什么都试过了。我尝试将我的 ofstream 输出（“data.dat”）；在 while(1) 语句之外，因此不会每次都调用它，但是不会像 ofstream 那样将任何内容写入文件甚至无法正常工作！

我试图使 ofstream 静态，所以它不会像这样一遍又一遍地调用：

```
static ofstream open("data.dat"); 
```

那是行不通的。

就像我说的，当我将 ofstream 放在 while 语句之外时，没有任何内容写入文件。像：

```
ofstream out("data.dat");

    while (1)
    {

        string line = "";
        cout << "There are currently " << structList.size() << " items in memory.";
        cout << endl << endl;
        cout << "Commands: " << endl;
        cout << "1: Add a new record " << endl;
        cout << "2: Display a record " << endl;
        cout << "3: Edit a current record " << endl;
        cout << "4: Delete a record " << endl;
        cout << "5: Save current information " << endl;
        cout << "6: Exit the program " << endl;
        cout << endl;
        cout << "Enter a command 1-6: ";

        getline(cin , line);

        int rValue = atoi(line.c_str());

        system("cls");

        switch (rValue)
        {
            case 1:
                structList = addItem(structList);
                break;
            case 2:
                displayRecord(structList);
                break;
            case 3:
                structList = editRecord(structList);
                break;
            case 4:
                deleteRecord(structList);
                break;
            case 5:
                if (!structList.size()) { cout << "There are no items to save! Enter one first!" << endl << endl; system("pause"); system("cls"); break; }
                writeVector(out , structList);
                break;
            case 6:
                return 0;
            default:
                cout << "Command invalid. You can only enter a command number 1 - 6\. Try again. " << endl;
        }

        out.close();
    } 
```

有人能告诉我为什么我的检查以防止读取空文件不起作用吗？

**我的支票：**

```
bool checkFileEmpty()
{
    ifstream in("data.dat");

    if (in.peek() == in.eofbit)
    {
        return true;
    }

    return false;
} 
```

我厌倦了我的程序在启动时一次又一次地崩溃，因为我的向量被设置为 2 亿的大小。我已经为此尝试了一堆东西......它都不起作用......请上帝帮我解决这两个问题！我已经为此工作了 18 个小时（整晚是的），我几乎完成了。我求求你....

**我的代码：**

```
#include "stdafx.h"
#include <iostream>
#include <fstream>
#include <string>
#include <vector>

using namespace System;
using namespace std;
#pragma hdrstop

bool isValidChoice(int size, int choice);

bool checkFileEmpty();

template<typename T>
void writeVector(ofstream &out, const vector<T> &vec);

template<typename T>
vector<T> readVector(ifstream &in);

template<typename T>
vector<T> addItem(vector<T> &vec);

template<typename T>
void printItemDescriptions(vector<T> &vec);

template<typename T>
int displayRecord(vector<T> &vec);

template<typename T>
vector<T> editRecord(vector<T> &vec);

template<typename T>
vector<T> deleteRecord(vector<T> &vec);

struct InventoryItem {
    string Description;
    int Quantity;
    int wholesaleCost;
    int retailCost;
    string dateAdded;
} ;

int main(void)
{
    cout << "Welcome to the Inventory Manager extreme! [Version 1.0]" << endl;
    ifstream in("data.dat");
    if (in.is_open()) { cout << "File \'data.dat\' has been opened successfully." << endl; } else { cout << "Error opening data.dat" << endl;}
    cout << "Loading data..." << endl;
    vector<InventoryItem> structList = readVector<InventoryItem>( in );
    cout <<"Load complete." << endl << endl;
    in.close();

    while (1)
    {

        string line = "";
        cout << "There are currently " << structList.size() << " items in memory.";
        cout << endl << endl;
        cout << "Commands: " << endl;
        cout << "1: Add a new record " << endl;
        cout << "2: Display a record " << endl;
        cout << "3: Edit a current record " << endl;
        cout << "4: Delete a record " << endl;
        cout << "5: Save current information " << endl;
        cout << "6: Exit the program " << endl;
        cout << endl;
        cout << "Enter a command 1-6: ";

        getline(cin , line);

        int rValue = atoi(line.c_str());

        system("cls");

        ofstream out("data.dat");

        switch (rValue)
        {
            case 1:
                structList = addItem(structList);
                break;
            case 2:
                displayRecord(structList);
                break;
            case 3:
                structList = editRecord(structList);
                break;
            case 4:
                deleteRecord(structList);
                break;
            case 5:
                if (!structList.size()) { cout << "There are no items to save! Enter one first!" << endl << endl; system("pause"); system("cls"); break; }
                writeVector(out , structList);
                break;
            case 6:
                return 0;
            default:
                cout << "Command invalid. You can only enter a command number 1 - 6\. Try again. " << endl;
        }

        out.close();
    }

    system("pause");

    return 0;
}

template<typename T>
void writeVector(ofstream &out, const vector<T> &vec)
{
    out << vec.size();

    for(vector<T>::const_iterator i = vec.begin(); i != vec.end(); i++)
    {
        out << *i;
    }
    cout << "Save completed!" << endl << endl;
}

ostream &operator<<(ostream &out, const InventoryItem &i)
{
    out << i.Description << ' ';
    out << i.Quantity << ' ';
    out << i.wholesaleCost  << ' ' << i.retailCost  << ' ';
    out << i.dateAdded  << ' ';
    return out;
}

istream &operator>>(istream &in, InventoryItem &i)
{
    in >> i.Description;
    in >> i.Quantity;
    in >> i.wholesaleCost >> i.retailCost;
    in >> i.dateAdded;
    return in;
}

template<typename T>
vector<T> readVector(ifstream &in)
{

    size_t size;
    if (checkFileEmpty())
    {
        size = 0;
    } else {
        in >> size;
    }

    vector<T> vec;
    vec.reserve(size);

    for(unsigned int i = 0; i < size; i++)
    {
        T tmp;
        in >> tmp;
        vec.push_back(tmp);
    }

    return vec;
}

template<typename T>
vector<T> addItem(vector<T> &vec)
{
    system("cls");

    string word;
    unsigned int number;

    InventoryItem newItem;

    cout << "-Add a new item-" << endl << endl;
    cout << "Enter the description for the item: ";
    getline (cin , word);
    newItem.Description = word;

    cout << endl;
    cout << "Enter the quantity on hand for the item: ";
    getline (cin , word);
    number = atoi(word.c_str());
    newItem.Quantity = number;

    cout << endl;
    cout << "Enter the Retail Cost for the item: ";
    getline (cin , word);
    number = atoi(word.c_str());
    newItem.retailCost = number;

    cout << endl;
    cout << "Enter the Wholesale Cost for the item: ";
    getline (cin , word);
    number = atoi(word.c_str());
    newItem.wholesaleCost = number;

    cout << endl;
    cout << "Enter current date: ";
    getline (cin , word);
    newItem.dateAdded = word;

    vec.push_back(newItem);

    return vec;
}

template<typename T>
void printItemDescriptions(vector<T> &vec)
{
    int size = vec.size();

    if (size)
    {
        cout << "---------------------------------" << endl;
        cout << "|      ~ Item Descriptions ~    |" << endl;
        cout << "---------------------------------" << endl;
        cout << "*********************************" << endl;
        for (int i = 0 ; i < size ; i++)
        {
            cout << "(" << i+1 << ")" << ": " << vec[i].Description << endl;
        }
        cout << "*********************************" << endl << endl;
    }
}

template<typename T>
int displayRecord(vector<T> &vec)
{
    string word = "";
    string quit = "quit";
    int choice = 1;
    int size = vec.size();

    if (size)
    {
        printItemDescriptions(vec);
        cout << endl;

        while (1)
        {
            cout << "Type \"exit\" to return to the Main Menu." << endl << endl;
            cout << "Enter \"list\" to re-display the items." << endl << endl;
            cout << endl;
            cout << "Pick the number of the item you would like to display: ";
            getline (cin , word);

            if (convertToLower(word) == "exit") { system("cls"); return 0; }
            if (convertToLower(word) == "list") { system("cls"); displayRecord(vec); }

            choice = atoi(word.c_str());

            choice -= 1;

            if (isValidChoice(size, choice))
            {
                system("cls");
                cout << endl << "[Item (" << choice << ") details] " << endl << endl;
                cout << "******************" << endl;
                cout << "*  Description   * " << vec[choice].Description << endl;
                cout << "******************" << endl << endl;
                cout << "******************" << endl;
                cout << "*Quantity On Hand* " << vec[choice].Quantity << endl;
                cout << "******************" << endl << endl;
                cout << "******************" << endl;
                cout << "* Wholesale Cost * " << vec[choice].wholesaleCost << endl;
                cout << "****************** " << endl << endl;
                cout << "******************" << endl;
                cout << "*  Retail Cost   * " << vec[choice].retailCost << endl;
                cout << "****************** " << endl << endl;
                cout << "******************" << endl;
                cout << "*  Data Added    * " << vec[choice].dateAdded << endl;
                cout << "****************** " << endl << endl;
            } else { system("cls"); cout << "That item doesn't exist!" << endl; cout << "Pick another item or enter \"list\" to see available items." << endl << endl; }
        }
    } else { cout << "There are currently no items to display." << endl << endl; system("pause"); system("cls"); return 0; }

    return 1;
}

bool isValidChoice(int size, int choice)
{
    for (int i = 0 ; i <= size ; i++)
    {
        if (choice == i) { return true; }
    }
    return false;
}

string convertToLower(string word)
{
    for (unsigned int i = 0 ; i < word.size() ; i++)
    {
        word[i] = tolower(word[i]);
    }

    return word;
}

bool checkFileEmpty()
{
    ifstream in("data.dat");

    if (in.peek() == in.eofbit)
    {
        return true;
    }

    return false;
}

template<typename T>
vector<T> editRecord(vector<T> &vec)
{
    string word;
    int choice;
    printItemDescriptions(vec);

    cout << "Choose item to edit: ";
    getline ( cin, word );
    choice = atoi(word.c_str());

    system("cls");

    unsigned int number;

    InventoryItem newItem;

    cout << "-Edit an item-" << endl << endl;
    cout << "Enter the description for the item: ";
    getline (cin , word);
    vec[choice-1].Description = word;

    cout << endl;
    cout << "Enter the quantity on hand for the item: ";
    getline (cin , word);
    number = atoi(word.c_str());
    vec[choice-1].Quantity = number;

    cout << endl;
    cout << "Enter the Retail Cost for the item: ";
    getline (cin , word);
    number = atoi(word.c_str());
    vec[choice-1].retailCost = number;

    cout << endl;
    cout << "Enter the Wholesale Cost for the item: ";
    getline (cin , word);
    number = atoi(word.c_str());
    vec[choice-1].wholesaleCost = number;

    cout << endl;
    cout << "Enter current date: ";
    getline (cin , word);
    vec[choice-1].dateAdded = word;

    system("cls");

    cout << "Item edited successfully! " << endl;

    return vec;
}

template<typename T>
vector<T> deleteRecord(vector<T> &vec)
{
    if (!vec.size()) { cout << "There are no items to delete!" << endl << endl; return vec; }
    printItemDescriptions(vec);

    string word;
    int choice;

    cout << "Choose item to delete: ";

    getline( cin, word);

    choice = atoi(word.c_str());

    vec.erase (vec.begin()+choice-1);
    return vec;
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-02T13:21:11.413

你最好在case 5里面移动ofstream的开启和关闭。

在这里，您在每次迭代时创建一个新文件。

```
case 5:
        {
            ofstream out("data.dat");
            writeVector(out , structList);
            out.close();
        }
        break; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-02T13:04:50.407

```
ofstream out("data.dat"); 
```

打开文件进行写入。默认情况下，它将从一开始就开始清除以前存在的任何内容。首先，使用与您正在读取的文件不同的输出文件。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-02T13:07:56.373

尝试在 case 6 语句中添加 close：

```
case 6:
        out.close();
        return 0; 
```

我很确定 close 不会被调用，因为 return 将在进入该语句之前退出 main 。在文件未关闭的情况下，您会留下一个未刷新的缓冲区，我怀疑这会使数据未写入。

您应该将 open 移到 while 循环之前，并从 while 循环中删除 out.close() ，因为它将在第一个菜单选择后关闭文件。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-02T13:19:28.063

检查文件是否为空或无法打开

```
bool IsEmpty( const std::string & filename ) {

   std::ifstream ifs( filename.c_str() );

   if ( ifs.is_open() ) {
      std::string line;
      return ! std::getline( ifs, line );
   }
   else {
      return true;
   }
} 
```

# asp.net - 在 ASP 中使用来自其他项目的用户控件

> ID：709617
> 
> 赞同：6
> 
> 时间：2009-04-02T13:04:57.363
> 
> 标签：asp.net, dll, user-controls, reference

我正在尝试在其他项目中重新使用我的 ASP 用户控件，但遇到了问题。我在[http://weblogs.asp.net/scottgu/archive/2005/08/28/423888.aspx](http://weblogs.asp.net/scottgu/archive/2005/08/28/423888.aspx)上阅读了 ScottGu 的帖子并尝试遵循他的模式，但运行时我的控件的子控件没有被初始化.

我的设置：我正在使用 Visual Studio 2008 我创建了一个解决方案来保存我想要分发给其他几个解决方案的控件。该解决方案包含：

*   库项目（用于模型代码等），我们称之为*“ClassLibrary”*
*   一个 WebApp 项目（带有我的用户控件），我们称之为*“最内层”*
*   许多其他 WebApp 项目充当 Innermost 项目的 Shell，让我们将其中一个称为*“Outer”*

这背后的想法是 Innermost 包含功能，而 Outer 包含使 Innermost 控件在特定框架中工作所需的任何特殊修改。

ClassLibrary 有这样的代码（这全部来自我所做的演示设置，以确保这是一个 ASP 问题，而不是我正在做的其他事情）：

```
using System;

namespace ClassLibrary {
    public class LibraryClass {
        public long getLong() {
            return DateTime.Now.Ticks;
        }

        public string getString() {
            return DateTime.Now.ToString();
        }
    }
} 
```

最里面引用了库项目并且工作正常。这是此项目中的 UserControl 示例：

```
<%@ Control Language="C#" AutoEventWireup="true" 
    CodeBehind="WebUserControl1.ascx.cs" 
    Inherits="Innermost.UserControls.WebUserControl1" %>
<asp:Label ID="testLabel" runat="server"/> 
```

带有代码隐藏：

```
using System;
using System.Web.UI;
using ClassLibrary;

namespace Innermost.UserControls {
    public partial class WebUserControl1 : UserControl {
        protected void Page_Load(object sender, EventArgs e) {
            LibraryClass c = new LibraryClass();
            testLabel.Text = "Your number is " + c.getLong();
        }
    }
} 
```

我在 Innermost 项目中有一个测试页面，它通过使用以下语法注册 Innermost 项目的用户控件来使用它们：

```
<%@ Page Language="C#" AutoEventWireup="true" CodeBehind="Test1.aspx.cs" 
    Inherits="Innermost.Test1" %>

<%@ Register TagPrefix="inner" TagName="Control1" 
    Src="~/UserControls/WebUserControl1.ascx" %>
<%@ Register TagPrefix="inner" TagName="Control2"
    Src="~/UserControls/WebUserControl2.ascx" %>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" 
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head runat="server">
    <title></title>
</head>
<body>
<form id="form1" runat="server">
<div>
    Control 1:
    <inner:Control1 ID="control1" runat="server" />
    <br />
    Control 2:
    <inner:Control2 ID="control2" runat="server" />
</div>
</form>
</body>
</html> 
```

Outer 项目引用 Innermost 和 ClassLibrary；并包含具有以下最内层控件注册的用户控件：

```
<%@ Control Language="C#" AutoEventWireup="true" 
    CodeBehind="TopControl.ascx.cs" Inherits="Outer.Control.TopControl" %>
<%@ Register TagPrefix="inner" Assembly="Innermost"
    Namespace="Innermost.UserControls" %>
<inner:WebUserControl1 ID="Control1" runat="server"/>
<inner:WebUserControl2 ID="Control2" runat="server"/> 
```

使用简单的代码隐藏：使用 System; 使用 System.Web.UI；

```
namespace Outer.Control {
    public partial class TopControl : UserControl {
        public bool ShowType1 { get; set; }

        protected void Page_Load(object sender, EventArgs e) {
            Control1.Visible = ShowType1;
            Control2.Visible = !ShowType1;
        }
    }
} 
```

当我在 Innermost 项目中运行测试页面时，我没有收到任何错误，并且一切正常。当我运行外部项目时，我会`NullReferenceException`告诉我`Innermost.UserControls.WebUserControlX`尚未设置子控件。

堆栈跟踪：

```
[NullReferenceException: Object reference not set to an instance of an object.]
   Innermost.UserControls.WebUserControl1.Page_Load(Object sender, EventArgs e) in c:\Test\ASP\Innermost\Innermost\UserControls\WebUserControl1.ascx.cs:9
   System.Web.Util.CalliHelper.EventArgFunctionCaller(IntPtr fp, Object o, Object t, EventArgs e) +14
   System.Web.Util.CalliEventHandlerDelegateProxy.Callback(Object sender, EventArgs e) +35
   System.Web.UI.Control.OnLoad(EventArgs e) +99
   System.Web.UI.Control.LoadRecursive() +50
   System.Web.UI.Control.LoadRecursive() +141
   System.Web.UI.Control.LoadRecursive() +141
   System.Web.UI.Control.LoadRecursive() +141
   System.Web.UI.Page.ProcessRequestMain(Boolean includeStagesBeforeAsyncPoint, Boolean includeStagesAfterAsyncPoint) +627 
```

如果有人想仔细研究一下，我可以提供测试设置作为解决方案。

所以，最后，我的问题是：为什么控件的 ChildControls 没有按预期设置？即使我`CreateChildControls()`在外部控件的 Init 中运行，它们也不会被创建。是否有一些特殊的方法需要编译 Innermost 项目以在 Outer 项目中使用？

任何帮助将非常感激！

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-04-02T14:06:53.487

我以前没有尝试过这种设置，但我可以猜测发生了什么。UserCotnrols 旨在通过路径加载，而不是通过引用加载。您正在尝试通过引用来创建它们。请注意您在内部项目中引用它们的方式与它与外部项目的不同之处。我相信要使其正常工作，您需要参考 .ascx 文件的路径位置。

快速搜索显示如何在 VS 2005 中完成此操作，但概念在 VS 2008 中应该相同。您可以在[此处](http://webproject.scottgu.com/CSharp/UserControls/UserControls.aspx)找到该信息。

另一种选择是不使用设计图面，而是使用 LoadControl 方法加载控件，并传入 .ascx 文件的路径。

**编辑** 从我上面提到的链接中得到的重要一点是，您必须使外部应用程序可以访问 .ascx 文件。上面的链接通过使用预构建命令将 .ascx 文件复制到外部项目中的子文件夹来完成此操作。把内部项目想象成你要重新分配它。您不仅要放弃程序集，还要放弃 .ascx 文件。为了让用户使用它，他们必须引用 .ascx 文件并让他们的项目引用您的程序集。你也必须做同样的事情。

我希望这更清楚一点。

# c# - 如何制作“调用堆栈图”

> ID：709625
> 
> 赞同：6
> 
> 时间：2009-04-02T13:07:00.527
> 
> 标签：c#, .net, diagram

***创建调用堆栈图***

我们最近刚刚被投入到一个需要我们进入代码的大项目中（duh）。

我们正在使用不同的方法来熟悉它，断点等。但是我们发现一种方法是创建应用程序的**调用树**，最简单/最快的方法是什么？

通过代码？插件？手动？

*该项目是一个 C# Windows 应用程序。*

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-03T09:52:46.953

使用静态分析器[NDepend](http://www.ndepend.com/Doc_VS_Arch.aspx)，您可以获得*静态*方法[调用图](http://www.ndepend.com/Doc_VS_Arch.aspx)，如下图所示。*免责声明：我是该工具的开发人员之一*

![调用图](https://i.stack.imgur.com/UKpMM.jpg)

为此，您只需将[CQLinq 代码查询](http://www.ndepend.com/Features.aspx#CQL)的结果导出到图形：

![代码查询导出](https://i.stack.imgur.com/sUvYB.png)

这样的代码查询实际上可以为任何方法生成，这要归功于下图所示的右键菜单。

![选择直接或间接使用我的方法](https://i.stack.imgur.com/xyt2F.png)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-02T13:10:38.943

每当我开始一份新工作（这通常是因为我是一名承包商）时，我都会花两到三天时间阅读存储库中的每个源文件，并将每个类的注释记录在一个简单的文本文件中。这很费力，但这意味着您可以很好地了解项目如何组合在一起，并且当您需要找到执行某些操作的类时，您将拥有一张可靠的地图。

虽然我在开始一个项目时喜欢 UML/图表，但就个人而言，在检查现有代码时，它们根本没有用。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-02T13:15:20.523

不是您问题的直接答案，但[NDepend](http://www.ndepend.com/Features.aspx)是一个很好的工具，可以让您深入了解 100 英尺的代码库视图，它使您能够深入了解类之间的关系（以及许多其他功能）

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-02T13:09:55.450

**编辑：**我相信微软的[CLR Profiler](http://www.microsoft.com/downloads/details.aspx?familyid=a362781c-3870-43be-8926-862b40aa0cd0&displaylang=en)能够显示正在运行的应用程序的调用树。如果这还不够，我会留下我在下面发布的链接，以防您想开始使用自定义解决方案。

* * *

这是一篇可能为您指明正确方向[的 CodeProject 文章：](http://www.codeproject.com/KB/cs/cs_call_tree_prototype.aspx)

> 此处提供的下载是 Visual Studio 2008 C# 项目，该项目是一个简单的实用程序，用于在 C# 代码中列出用户函数调用树。
> 
> 这个调用树列表器似乎适用于我的编码风格，但对于其他一些编码风格可能不可靠。在这里提供它有两个想法：首先，一些程序员可能会发现它是有用的；其次，如果有人在 C# 解析方面与时俱进，将通过合并一个准确的 C# 解析器来升级它，并提供一个改进的实用程序，无论编码风格如何，它都是可靠的，我将不胜感激

源代码可供下载 - 也许您可以将其用作自定义解决方案的起点。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-02T13:18:31.777

你的意思是这样的：[http ://erik.doernenburg.com/2008/09/call-graph-visualisation-with-aspectj-and-dot/](http://erik.doernenburg.com/2008/09/call-graph-visualisation-with-aspectj-and-dot/)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-04-02T13:21:46.637

不是一个卡住的记录，但如果我让它运行并暂停几次，并且每次都捕获调用堆栈，这让我对占最多时间的调用结构有一个真实的了解。但是，它并没有为我提供快速发生的事情的调用结构。

# php - 阿贾克斯的麻烦。提交而不刷新。我需要帮助

> ID：709626
> 
> 赞同：1
> 
> 时间：2009-04-02T13:07:32.210
> 
> 标签：php, javascript, ajax

我在提交我的 ajax 表单时遇到问题。我习惯了老式的刷新方式，但这种新东西暂时超出了我的范围。是时候开始学习新技术了。

我有一个自动建议框，它可以从数据库中获取我的结果并很好地填充文本框。大约 6 个月前我设计这个时，我在数据库中搜索值而不是键值。这是今天的一个问题，需要解决。

ajax 返回到我的脚本的是键/值对。现在我有了 id，我需要将它传递到我的 php 方法中，以便我可以从那里处理它。

有人可以帮我解决这个问题吗？看起来很简单，但同样，javascript 从来都不是我的事，所以我迷路了。

这是所有相关代码。另外，我认为，至少从我目前看到的代码示例来看，我什至不需要表单标签。我对此是否正确？理想情况下，我想使用输入按钮而不是使用按钮提交找到的 ajax 值。

所以，只是为了澄清，这就是发生的事情。用户键入 2 或 3 个字母。ajax 在“LIKE”运算符上查询数据库并返回匹配项。用户选择他想要的，然后将 id 传给我的方法，并在不同的窗口中返回准确的记录。

```
<form method="post" class="hdrForm" id="search" action="../../index.php?cer=2" target="_top">
<input type="text" name="string" class="hdrInput" id="string" value="Quick Search"><div id="acDiv"></div>

</form> 
```

* * *

注意.. 我需要提交此函数中的“id”。现在，我正在从表单标签中获取 POST val，这是不正确的，但是如何？

```
 AC.chooseFunc = function(id,label)
  {
    document.forms.search.submit();
  } 
```

感谢你们在这方面给我的任何帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-02T13:31:59.703

看看[jQuery](http://jquery.com)。它是一个 JavaScript 库。它包含执行 Ajax 的功能。

*   [jQuery Ajax 文档](http://docs.jquery.com/Ajax)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-02T15:19:34.430

你有两个问题。一个是你告诉表单提交：

```
document.forms.search.submit(); 
```

这就是导致您的表单以标准的非 xhr 方式提交的原因 - 导致刷新。此外，由于您的表单不包含 id 的输入元素，因此即使使用常规表单提交也不会将其发送到服务器。

我同意海报的观点，即使用 jQuery 或其他东西来进行基于 ajax 的提交是个好主意。[这样](http://docs.jquery.com/Ajax/jQuery.post#urldatacallbacktype)的东西可以在你的“AC.chooseFunc”函数中使用，而不是表单提交。

是的，如果你完全使用 ajax，你甚至不需要表单标签。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-02T13:15:42.923

```
document.getElementById("search").onsubmit = function() {
    // Do what you want with the form
    return false; // Stops submit continuing
} 
```

这也会优雅地降级（如果您的服务器端程序编写正确），因为没有 javascript 的用户会在没有 AJAX 的情况下将表单正常提交到 action 属性中的页面。

我建议您使用 jQuery 之类的框架。[提供基础教程（包括 AJAX）](http://docs.jquery.com/Tutorials:Getting_Started_with_jQuery)

# windows - 从批处理文件发送邮件

> ID：709635
> 
> 赞同：50
> 
> 时间：2009-04-02T13:09:31.923
> 
> 标签：windows, command-line, batch-file, email-client

我们有一个备份文件的脚本。备份操作结束后，我们希望将报告作为电子邮件通知发送到我们的一些电子邮件地址。

怎么可能做到这一点？

* * *

## 回答 #1

> 赞同：38
> 
> 时间：2009-04-02T13:42:37.710

[布拉特](http://www.blat.net/)：

```
blat -to user@example.com -server smtp.example.com -f batch_script@example.com -subject "subject" -body "body" 
```

* * *

## 回答 #2

> 赞同：21
> 
> 时间：2009-04-29T21:42:31.450

您还可以使用 Power Shell 脚本：

```
$smtp = new-object Net.Mail.SmtpClient("mail.example.com")

if( $Env:SmtpUseCredentials -eq "true" ) {
    $credentials = new-object Net.NetworkCredential("username","password")
    $smtp.Credentials = $credentials
}
$objMailMessage = New-Object System.Net.Mail.MailMessage
$objMailMessage.From = "script@mycompany.com"
$objMailMessage.To.Add("you@yourcompany.com")
$objMailMessage.Subject = "eMail subject Notification"
$objMailMessage.Body = "Hello world!"

$smtp.send($objMailMessage) 
```

* * *

## 回答 #3

> 赞同：16
> 
> 时间：2016-07-27T05:10:49.947

[PowerShell 带有一个内置命令](https://technet.microsoft.com/en-us/library/hh849925.aspx)。所以直接从`.bat`文件运行：

```
powershell -ExecutionPolicy ByPass -Command Send-MailMessage ^
    -SmtpServer server.address.name ^
    -To someone@what.ever ^
    -From noreply@possibly.fake ^
    -Subject Testing ^
    -Body 123 
```

[**`-ExecutionPolicy ByPass`仅当您尚未设置从 CMD 运行 PS 的权限时才需要**NB****]

 **[同样对于那些希望从 powershell 中调用它的人，在`-Command`[inclusive] 之前删除所有内容，```并将成为您的转义字符（不是`^`）]

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2009-04-02T13:12:09.297

[邮件](http://retired.beyondlogic.org/solutions/cmdlinemail/cmdlinemail.htm)。只需安装 EXE 并运行如下一行：

```
bmail -s myMailServer -f Sender@foo.com -t receiver@foo.com -a "Production Release Performed" 
```

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-04-02T15:10:36.360

我们一直在我们的环境中使用 blat 来执行此操作。[我也使用它通过Stunnel](http://tech.groups.yahoo.com/group/blat/files/Other/)连接到 Gmail 。这是发送文件的参数

```
blat -to user@example.com -server smtp.example.com -f batch_script@example.com -subject "subject" -body "body" -attach c:\temp\file.txt 
```

或者您可以将该文件作为正文放入

```
blat c:\temp\file.txt -to user@example.com -server smtp.example.com -f batch_script@example.com -subject "subject" 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2014-07-03T02:46:55.117

有多种方法可以处理这个问题。

我的建议是使用功能强大的 Windows 免费软件控制台应用程序[SendEmail](http://caspian.dotconf.net/menu/Software/SendEmail/)。

```
sendEmail.exe -f sender.from@mail.com -o message-file=body.txt -u subject message -t to.email.address@mail.com -a attachment.zip -s smtp.gmail.com:446 -xu gmail.login -xp gmail.password 
```

# javascript - Ext.data.Store、Javascript 数组和 Ext.grid.ColumnModel

> ID：709639
> 
> 赞同：1
> 
> 时间：2009-04-02T13:10:39.863
> 
> 标签：javascript, extjs

我正在使用 Ext.data.Store 调用一个 PHP 脚本，该脚本返回一个 JSON 响应，其中包含一些关于将在查询中使用的字段的元数据（唯一名称、表、字段和用户友好的标题）。然后我遍历每个 Ext.data.Record 对象，将我需要的数据放入一个数组 ( `this_column`)，将该数组推到另一个数组 ( `columns`) 的末尾，并最终将其传递给 Ext.grid.ColumnModel 对象。

我遇到的问题是 - 无论我正在测试哪个查询（我有很多，大小和复杂性不同），列数组总是按预期工作，直到`columns[15]`. 在`columns[16]`处，从该点和之前的所有索引都用 的值填充`columns[15]`。这种行为一直持续到循环到达 Ext.data.Store 对象的末尾，此时整个数组包含相同的值。

这是一些代码：

```
columns = [];
this_column = [];

var MetaData = Ext.data.Record.create([
    {name: 'id'},
    {name: 'table'},
    {name: 'field'},
    {name: 'title'}
]);
// Query the server for metadata for the query we're about to run
metaDataStore = new Ext.data.Store({
    autoLoad: true,
    reader: new Ext.data.JsonReader({
        totalProperty: 'results',
        root: 'fields',
        id: 'id'
    }, MetaData),
    proxy: new Ext.data.HttpProxy({
        url: 'index.php/' + type + '/' + slug
    }),
    listeners: {
        'load': function () {
            metaDataStore.each(function(r) {
                this_column['id'] = r.data['id'];
                this_column['header'] = r.data['title'];
                this_column['sortable'] = true;
                this_column['dataIndex'] = r.data['table'] + '.' + r.data['field'];
                // This display valid information, through the entire process
                console.info(this_column['id'] + ' : ' + this_column['header'] + ' : ' + this_column['sortable'] + ' : ' + this_column['dataIndex']);
                columns.push(this_column);
            });

            // This goes nuts at columns[15]
            console.info(columns);

            gridColModel = new Ext.grid.ColumnModel({
                columns: columns
            }); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-02T13:20:14.100

好的，由于 this_column 数组在每次运行时都正确响应，但列数组没有，我认为这一定是 push() 的问题。

在玩了一会儿之后，我改变了代码以在循环的每次迭代中重置 this_column 数组 - 似乎已经解决了这个问题......

```
metaDataStore.each(function(r) {
    this_column = [];
    this_column['id'] = r.data['id'];
    this_column['header'] = r.data['title'];
    this_column['sortable'] = true;
    this_column['dataIndex'] = r.data['table'] + '.' + r.data['field'];
    columns.push(this_column);
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-03T20:25:29.477

我看到您已经找到了一些可行的方法，但只是为将来提供一些建议：如果您直接使用 json 存储和列模型而不是手动执行中间步骤，这会容易得多。

我不确定您使用的是网格还是数据视图，但它们的概念几乎相同。如果您必须进行一些数据自定义，但不是在这里手动进行，您实际上可以在 prepareData 回调函数中进行。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2010-04-29T20:42:58.450

因为您首先`this_column`在全局上下文中使用变量（在示例的顶部），所以它变成了**全局变量**。相反，您应该将每个列定义实例化为对象文字（为了便于阅读，拆分为多行）。

```
metaDataStore.each(function(r) {
  columns.push({
    id: r.data['id'],
    header: r.data['title'],
    sortable: true,
    dataIndex: r.data['table'] + '.' + r.data['field']
  });
}); 
```

或者如果你真的想使用一个变量，你可以这样做以确保它是一个**局部变量**

```
metaDataStore.each(function(r) {
    var this_column = {};
    ... 
```

# sql-server - 将查询结果传递到 csv 文件并使用 SQL Server 2005 将其作为附件发送

> ID：709649
> 
> 赞同：0
> 
> 时间：2009-04-02T13:12:43.290
> 
> 标签：sql-server, stored-procedures

我有两个任务，因为我是新手，所以我需要大师们的帮助/建议。

我需要做的是将 q select 查询的结果发送到一个 csv 文件，该文件可以将分隔符作为逗号或制表符，然后将此文件作为附件发送给特定的收件人。

希望得到一些好的建议

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-02T15:07:42.093

SSIS 可能是要走的路，但如果你想让 T-SQL 做到这一点，试试这个..

我不会为你编写完整的程序，但这里是要点......

确定拆分字符：

```
SET @CSV=',' --use CHAR(9) for tab 
```

一次构建您的 CSV 字符串，循环遍历结果（对每一行执行此操作）：

```
SET @FileMessage=ISNULL(CONVERT(varchar(10),column1),'')+@CSV+ISNULL(CONVERT(varchar(10),column2),'')
SET @ExecuteString = RTRIM('echo ' + @FileMessage + ' >>' + @FileName)
--append it to you file, you'll need write permissions
EXEC @ReturnValue=master..xp_cmdshell @ExecuteString, no_output 
```

在文件完全构建后，实际发送邮件：

```
EXEC xp_sendmail { [ @recipients= ] 'recipients [ ;...n ]' } 
     [ ,[ @message= ] 'message' ] 
     [ ,[ @query= ] 'query' ] 
     [ ,[ @attachments= ] 'attachments [ ;...n ]' ] 
     [ ,[ @copy_recipients= ] 'copy_recipients [ ;...n ]'
     [ ,[ @blind_copy_recipients= ] 'blind_copy_recipients [ ;...n ]'
     [ ,[ @subject= ] 'subject' ]
     [ ,[ @type= ] 'type' ] 
     [ ,[ @attach_results= ] 'attach_value' ]
     [ ,[ @no_output= ] 'output_value' ] 
     [ ,[ @no_header= ] 'header_value' ] 
     [ ,[ @width= ] width ] 
     [ ,[ @separator= ] 'separator' ] 
     [ ,[ @echo_error= ] 'echo_value' ] 
     [ ,[ @set_user= ] 'user' ] 
     [ ,[ @dbuse= ] 'database' ] 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-02T13:17:26.757

您可以使用 SQL Server Integration Services (SSIS) 轻松完成此操作。从查询复制到平面 (CSV) 文件的数据流任务，然后是通过电子邮件发送平面文件的任务。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-12-22T13:09:32.980

SSIS 将是您的最佳选择。查看此链接，了解如何将 csv 文件中的数据传输到 SQL：[从 CSV 导入数据](http://www.kodyaz.com/articles/import-csv-flat-file-into-sql-server-using-ssis-integration-services.aspx)

# java - 将新的 JavaDoc 附加到来自 super 方法的现有 JavaDoc

> ID：709650
> 
> 赞同：23
> 
> 时间：2009-04-02T13:13:38.763
> 
> 标签：java, interface, methods, comments, javadoc

我已经生成了一个有据可查的接口。每个方法都有自己的 JavaDoc。实现此接口的类在逻辑上可能略有不同。

如何将 JavaDoc 从超类添加到现有的 JavaDoc。关键词

```
/**
 * {@inheritDoc}
 */ 
```

只将超类的 javaDoc 设置为当前方法。但是当我尝试添加一些单词时，超级方法的JavaDoc就消失了，比如

```
/**
 * {@inheritDoc}
 * These value depends on...
 */ 
```

有谁知道我如何在不删除的情况下更新超级方法的 JavaDoc。

**编辑：**

关于 Brian Agnew 的回答，这很好但不是真正的答案；）

当您想要覆盖现有方法（如 Swing 中的 paint()）并想要描述如何从外部初始化或处理绘制行为时，您也可能遇到同样的问题。这不仅仅用于接口描述。

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2010-02-08T09:32:57.467

我想当你需要向 javadoc 添加一些东西时，你改变了一些东西。因此，以完全相同的方式编写 javadoc 可能是正确的。

```
/**
 * Enhanced swing paint for my cool component.
 * @see JButton#paint();
 */
@Override
public void paint() {
    super.paint();
    //my stuff
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-02T17:27:03.063

我不知道有任何直接的 JavaDoc 习语可以做到这一点。然而 Eclipse 和 IntelliJ 会让你抓取超级 JDoc 并插入它......它远非完美，就像你更改超级 JDoc 你将不得不重新编辑所有覆盖，但它比手动复制粘贴更好......

# java - 将标识符附加到 Oracle 会话

> ID：709652
> 
> 赞同：1
> 
> 时间：2009-04-02T13:14:34.393
> 
> 标签：java, database, oracle, hibernate

我的 Java 应用程序通过 Hibernate 使用 db 会话。

当我在我的应用程序中创建会话时，我想要做的是将该会话标识为“应用程序”会话。原因是我希望（通过前触发器）限制用户可以对表进行的更新，同时让应用程序全权委托做它喜欢做的事情。

换句话说，我的触发器执行以下操作：

```
if(user is an application)
   allow update
else
   raise oracle error
end if 
```

有人知道最好的方法吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-02T17:41:58.067

将权限授予角色然后让应用程序设置该角色可能更简单。

[http://download.oracle.com/docs/cd/B28359_01/server.111/b28286/statements_10004.htm#sthref9521](http://download.oracle.com/docs/cd/B28359_01/server.111/b28286/statements_10004.htm#sthref9521)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-02T13:39:40.090

在您的触发器中写入以下内容：

```
select 
  terminal, 
  username, 
  osuser, 
  program 
into 
  svTerminal, svUserName, svOSUser, svProgram

from
  v$session 
where 
  audsid=SYS_CONTEXT('USERENV','SESSIONID');

if svProgram <> 'MyApplicationTitle' then
  raise oracle error
end if; 
```

如果运行此查询，您还可以查看可用的其他变量：

```
select * form v$session; 
```

如果触发器没有编译，您应该向拥有 v$session 触发器的用户授予选择权限。您可以通过作为系统执行以下操作来做到这一点：

```
grant select on sys.v_$session to <username>; 
```

更新： v_$session 中的下划线不是错误的。这是 sys 内部的真实名称，可以在其中授予授权。v$session 是您可以在查询中使用的别名。

# windows-xp - 如何从“请告知 Microsoft”对话框中获取错误报告？

> ID：709654
> 
> 赞同：3
> 
> 时间：2009-04-02T13:15:30.397
> 
> 标签：windows-xp, error-reporting

我编写的程序在启动时崩溃。（赢 XP）。

一个对话框“请告诉微软这个问题”。出现。我想被告知这个问题，因为它是我的应用程序。

事情是，点击（点击链接：'查看错误报告的内容'），“错误报告内容”对话框不允许我的客户将其内容复制到剪贴板。

您知道用户如何获取此报告的副本以转发给开发人员吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-04-02T13:52:36.097

不用担心。开发人员可以订阅 WinQual。然后，Microsoft 会将错误报告转发给他们。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-04-02T14:10:29.593

Windows 错误报告是 Microsoft 的[Winqual](https://winqual.microsoft.com/)服务的一部分。

1.  在 Winqual 网站上注册。您需要购买 SSL 证书来识别您和您的组织，而不仅仅是使用用户名/密码登录。如果您只需要用于识别目的的证书，这将花费 99 美元。如果你还想用它来签署代码，它是 499 美元。
2.  在应用程序的本地副本上运行 Microsoft 产品反馈映射工具（可从 Winqual 站点获得），并将结果提交到 Winqual 网站。这会将您的应用程序注册到 Winqual。
3.  从现在开始，如果您登录 Winqual，您可以使用通过 Windows 错误报告针对您提交的应用程序报告的任何错误。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-02T13:53:53.177

使用 Alt-printscreen 抓取活动窗口的副本，然后将其粘贴到 word 或其他内容中。

# wix - WiX：如何防止注册表值在卸载时被删除？

> ID：709661
> 
> 赞同：17
> 
> 时间：2009-04-02T13:17:47.287
> 
> 标签：wix, registry, uninstallation

我想断言安装后存在某个注册表值，所以我添加了以下组件：

```
<Component Id="RegistryEntryContextMenuOdt" Guid="4BA5BA24-4F65-4BDF-99EB-CB4B947F31A9" DiskId="1" KeyPath="yes">
    <RegistryKey Id="RegKeyOdt" Root="HKCR" Action="create" Key=".odt">
      <RegistryValue Type="string" Value="openDocument.WriterDocument.1" />
    </RegistryKey>
</Component> 
```

键/值可能在安装之前已经设置。但是，我希望将该值设置为我的特定值，即它将被我的值覆盖。

我现在的问题是，当我的产品被卸载时，这个值*总是被删除。*但是，我只希望在我的安装程序添加该值时将其删除。如果我的安装程序刚刚修改了该值，则应该恢复以前的值（或者，如果这不可能，我的值应该保持不变）。

请注意，卸载时不会删除密钥本身。这似乎可以正常工作，因为我`Action="create"`在`RegistryKey`元素上指定了。

是否有类似的设置`RegistryValue`可以创建值但不会在安装时将其删除？

更新： HKCR 下的两个注册表项都是机器范围的设置，即它们源自注册表的 HKLM\SOFTWARE\Classes 分支。

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2009-04-02T15:00:48.490

[通过使用Component 元素](http://wix.sourceforge.net/manual-wix3/wix_xsd_component.htm)`NeverOverwrite`的属性，您可以确保仅在注册表项不存在时才安装您的组件。来自 wix 文档：`NeverOverwrite`

> 如果此属性设置为“是”，则如果组件的密钥路径文件或密钥路径注册表项已存在，则安装程序不会安装或重新安装该组件。

您可能还需要设置[Registry](http://wix.sourceforge.net/manual-wix2/wix_xsd_registry.htm)元素的`KeyPath`属性，以明确注册表项是组件键路径。`yes`

如果您确实想设置注册表值，即使它已经存在，但又不想在卸载时将其删除，那么您可以改用`Permanent`Component 元素的属性。

# wpf - WPF 是用户界面设计的未来吗？我现在应该学吗？

> ID：709662
> 
> 赞同：5
> 
> 时间：2009-04-02T13:18:08.177
> 
> 标签：wpf, windows, user-interface

有很多关于 WPF 之类的讨论。我想知道 WPF 是否会成为图形交互用户界面设计的新标准。这是我们在 Windows 界面方面的发展方向吗？它真的会像大家说的那样起飞吗？

### 也可以看看

> [学习 Windows 窗体与 Windows Presentation Foundation](https://stackoverflow.com/questions/173471/learning-windows-forms-vs-windows-presentation-foundation)
> 
> （包含指向 WPF 上许多其他有用帖子的链接）。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-04-02T13:25:05.147

我认为在 Win32、MFC，当然还有 WinForms 中仍然有很多应用程序。我认为将 WPF 添加到您的工具带中将是一个明智的选择。您是否应该放弃所有内容并在今天学习？这取决于你。我看到了对 WPF 的更多需求。这不是压倒性的，但 2001 年的 C#/WinForms 也不是。

所以冗长的答案是你只需要抓住机会。没有人知道 WPF 应用程序是否会主导市场。我倾向于这种可能性，并且我也认为 Silverlight 可能是未来网络应用程序的真正参与者。由于两者之间存在可转移的技能，因此我通过继续学习 WPF 来对冲我的赌注。

另请参阅[使用 WPF 优于 WinForms 是否更好](https://stackoverflow.com/questions/640633/is-it-better-to-use-wpf-over-winforms/)

抱歉，这不是一个具体的答案。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-04-02T13:26:26.313

你要求我们预测未来:)

我认为解决此问题的更好方法是查看如果您不学习 WPF 可以学习的其他技术。我会权衡各种权衡，然后选择对我更有价值的一种。

例如，如果选择是 WinForms 或 WPF，我当然会选择 WPF。WPF 的学习曲线比 WinForms 更陡峭。但是，一旦您通过了学习曲线，使用起来就会容易得多。WPF 可以在几行中完成在 WinForms 中需要数百行自定义控件的操作。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-04-02T20:52:15.830

WPF 是 Windows 的**终极**图形平台。Win32 的 GDI 是“第一次尝试”，WPF 是“永久结构”。对于 Windows 和平面显示器的组合（fe 3d 显示器可能需要其他东西），它永远不会被替换。所以学习它，它是一个很好的商品。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-12-06T20:48:12.940

在 WPF 中有很多东西要学。作为一个 GUI 程序员，你需要死而复生。

但这是否值得努力。为什么？，这是我的答案。

既然您在问这个问题，我假设您是基于 Microsoft 技术的程序员。

由于 MS 的方向是 WPF 进行 GUI 开发，我认为别无选择。Win Forms 将持续很长时间，可能会再持续 2 年。由于 WPF 酷炫的外观和感觉使用户要求比 Win Forms 更多的 WPF 应用程序。如您所知，许多用户的 GUI 是 S/W :)

现在，如果您不是基于 MS 的程序员，可能来自 Java，我说 WPF 与 Java Swing 有很多相似之处。但它是一个非常非常大的 Swing 超级组合。

让 Swing 赶上 WPF 可能需要至少 2/3 年，到那时 WPF 可能会统治这个词，我不认为 Swing 会比这容易得多，如果不是困难的话。

由于 silverlight 是一种独立于平台的平台，并且它的模型类似于 WPF，因此我预测 WPF 将至少在未来 6/7 年（如果不是十年的话）中占据主导地位。

我相信并希望 MS 能让程序员的工作变得更容易，从而缩短学习曲线或将其委托给 GUI 艺术家（使用表达式混合）。

希望我回答了你的问题。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-04-04T02:19:32.680

微软有一个习惯，就是把所有东西都扔在墙上，看看有什么能坚持下去……Pocket PC 平台、J# 等等。关于 WPF，现在判断未来是否会增加采用还为时过早。

如果您编写过 .NET Winforms 和/或 Webforms，那么学习曲线不会那么陡峭。我建议涉足它，但不要把所有的鸡蛋都扔进众所周知的 WPF（甚至 Silverlight）篮子里。正如其他人所指出的，最好将其视为您武器库中的另一个工具。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-04-04T02:25:25.787

WPF 已经存在几年了，微软决定在 WPF 中重写 Visual Studio (2010) 是一个很好的迹象，表明它会继续存在。请记住，这是市场上最受欢迎的 IDE 之一，也是 Microsoft 人员的意向标志。

我的组织去年采用了这项技术，虽然它有一个陡峭的学习曲线——你真的必须学会以不同的方式思考——它为我们能够开发的应用程序的丰富性带来了好处。我喜欢 winforms 并且是 asp.net 的忠实粉丝，但 WPF 让我大吃一惊的是，为您提供了构建块，并且可能性是无穷无尽的......

如果我是你，我会学习 WPF 以获得经验并在以后获得回报。不要忘记 - 如果您采用 WPF，您还将学习 Silverlight 的核心 - 在我看来，这两种技术无济于事！

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2010-12-08T12:35:19.287

使用 WPF 比 WinForms 好得多，你需要有不同的心态。我只能说微软在创建 WPF 和 Silverlight 应用程序时应该使用 HTML 语法，以便前端可以重用或至少用于 silverlight 应用程序，这样在桌面上开发的人可以在编写可在任何地方使用的浏览器应用程序时重用相同的代码. 如果 HTML5 变得更好，我相信它会随着开源（廉价技术）的趋势而变得流行。毫无疑问，WPF 比我用过的其他任何东西更适合开发桌面应用程序，而 c# 作为语言（而不是速度）和它的使用方式更强大。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-04-02T13:32:58.937

是的，开始学习吧。它适用于 Silverlight（虽然不是 1 对 1 映射），它也是与 Abobe Flex 的[MXML](http://www.adobe.com/devnet/flex/articles/paradigm.html)范例非常相似的模型，因此您将以 1 的价格获得 3 胜。

我们开始看到需要它的工作，所以绝对有充分的理由将它放在旧的实用腰带上。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2010-12-20T03:53:34.720

我开始了解它，马修麦克唐纳写了一本关于它的超级书。我向所有人推荐这本书（事实上，我正在上网学习 WPF，直到我看到他的书和另一件事“远离微软网站（MSDN）”

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-04-02T13:27:12.973

是的，如果您要在 Windows 平台上设计桌面应用程序，WPF 就是新兴标准。WPF 取代了迄今为止主导 Windows 桌面的 Win32 API，Microsoft 期望 WPF 平台有类似的生命周期。

此外，它更酷。

当然，还有 Silverlight。

# silverlight - Silverlight 路由事件和异常

> ID：709667
> 
> 赞同：0
> 
> 时间：2009-04-02T13:19:22.400
> 
> 标签：silverlight, exception, routed-events

我有一个复杂的应用程序，它由一个**应用**程序组成，其中包含许多**模块**，每个模块都包含许多**视图**。我的观点的行为可能会引发异常。

有时我想在创建它们的**视图上处理异常，有时在父****模块**中，有时在祖父**应用程序**中。

RoutedEvents 的概念似乎是解决这个问题的一种明智方式，但我不完全确定如何解决这个问题。

有没有人可以分享任何示例或链接来证明我正在努力实现的目标？

谢谢马克

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-08-06T17:29:02.373

尽管 Silverlight 包含 RoutedEventHandler 和 RoutedEventArgs，但遗憾的是桌面 WPF 框架中看到的“路由事件”的概念*并不*相同。

今天保留它是为了源代码和 API 的兼容性，将来可能会支持它。

这意味着，与此同时，您可以做一些额外的工作，但仍然可以通过

*   在应用程序级别，连接您自己的未处理异常处理程序代码，可能创建并命名类型“AdvancedExceptionManager”或其他类型，并在此基础上设计一个简单的 API 以允许事物订阅和处理任何异常并将其冒泡。
*   在模块级别，使用全局/单例未处理的异常处理程序代码，订阅和取消订阅以“处理”全局异常，并取消进一步的处理，例如。

如果您需要有关如何处理此问题的更多信息，请告诉我。这将有助于了解您的“模块”是如何构建或设计的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-10-23T15:44:57.450

这对您来说可能很有趣：

“Silverlight 3 的 RoutedEvents 实现，包括 WPF 兼容性” [http://sl3routedevents.codeplex.com/](http://sl3routedevents.codeplex.com/)

# php - 如何从 PHP 中的文本中删除空白行？

> ID：709669
> 
> 赞同：39
> 
> 时间：2009-04-02T13:19:28.563
> 
> 标签：php, regex

我需要在 PHP 中删除空白行（带有空格或绝对空白）。我使用这个正则表达式，但它不起作用：

```
$str = ereg_replace('^[ \t]*$\r?\n', '', $str);
$str = preg_replace('^[ \t]*$\r?\n', '', $str); 
```

我想要一个结果：

```
blahblah

blahblah

   adsa 

sad asdasd 
```

将要：

```
blahblah
blahblah
   adsa 
sad asdasd 
```

* * *

## 回答 #1

> 赞同：90
> 
> 时间：2009-04-02T13:22:49.490

```
// New line is required to split non-blank lines
preg_replace("/(^[\r\n]*|[\r\n]+)[\s\t]*[\r\n]+/", "\n", $string); 
```

上面的正则表达式说：

```
/(^[\r\n]*|[\r\n]+)[\s\t]*[\r\n]+/
    1st Capturing group (^[\r\n]*|[\r\n]+)
        1st Alternative: ^[\r\n]*
        ^ assert position at start of the string
            [\r\n]* match a single character present in the list below
                Quantifier: Between zero and unlimited times, as many times as possible, giving back as needed [greedy]
                \r matches a carriage return (ASCII 13)
                \n matches a fine-feed (newline) character (ASCII 10)
        2nd Alternative: [\r\n]+
            [\r\n]+ match a single character present in the list below
            Quantifier: Between one and unlimited times, as many times as possible, giving back as needed [greedy]
            \r matches a carriage return (ASCII 13)
            \n matches a fine-feed (newline) character (ASCII 10)
    [\s\t]* match a single character present in the list below
        Quantifier: Between zero and unlimited times, as many times as possible, giving back as needed [greedy]
        \s match any white space character [\r\n\t\f ]
        \tTab (ASCII 9)
    [\r\n]+ match a single character present in the list below
        Quantifier: Between one and unlimited times, as many times as possible, giving back as needed [greedy]
        \r matches a carriage return (ASCII 13)
        \n matches a fine-feed (newline) character (ASCII 10) 
```

* * *

## 回答 #2

> 赞同：28
> 
> 时间：2009-04-02T18:18:14.627

您的`ereg-replace()`解决方案是错误的，因为这些`ereg/eregi`方法已被弃用。你`preg_replace()`甚至不会编译，但如果你添加分隔符并设置多行模式，它会正常工作：

```
$str = preg_replace('/^[ \t]*[\r\n]+/m', '', $str); 
```

The `m` modifier allows `^` to match the beginning of a logical line rather than just the beginning of the whole string. The start-of-line anchor is necessary because without it the regex would match the newline at the end of every line, not just the blank ones. You don't need the end-of-line anchor (`$`) because you're actively matching the newline characters, but it doesn't hurt.

The [accepted answer](https://stackoverflow.com/a/709684/20938) gets the job done, but it's more complicated than it needs to be. The regex has to match either the beginning of the string (`^[\r\n]*`, multiline mode not set) or at least one newline (`[\r\n]+`), followed by at least one newline (`[\r\n]+`). So, in the special case of a string that starts with one or more blank lines, they'll be replaced with *one* blank line. I'm pretty sure that's not the desired outcome.

But most of the time it replaces two or more consecutive newlines, along with any horizontal whitespace (spaces or tabs) that lies between them, with one linefeed. That's the intent, anyway. The author seems to expect `\s` to match just the space character (`\x20`), when in fact it matches any whitespace character. That's a very common mistake. The actual list varies from one regex flavor to the next, but at minimum you can expect `\s` to match whatever `[ \t\f\r\n]` matches.

Actually, in PHP you have a better option:

```
$str = preg_replace('/^\h*\v+/m', '', $str); 
```

`\h` matches any horizontal whitespace character, and `\v` matches vertical whitespace.

* * *

## 回答 #3

> 赞同：16
> 
> 时间：2015-10-23T19:26:27.710

Just explode the lines of the text to an array, remove empty lines using `array_filter` and implode the array again.

```
$tmp = explode("\n", $str);
$tmp = array_filter($tmp);
$str = implode("\n", $tmp); 
```

Or in one line:

```
$str = implode("\n", array_filter(explode("\n", $str))); 
```

I don't know, but this is maybe faster than `preg_replace`.

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2012-03-03T06:46:10.003

The [comment from Bythos](http://programming-oneliners.blogspot.com.au/2006/03/remove-blank-empty-lines-php-29.html?showComment=1258967786143#c1573838206820839972) from Jamie's link above worked for me:

```
/^\n+|^[\t\s]*\n+/m 
```

I didn't want to strip all of the new lines, just the empty/whitespace ones. This does the trick!

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2018-06-03T15:39:50.760

There is no need to overcomplicate things. This can be achieved with a simple short regular expression:

```
$text = preg_replace("/(\R){2,}/", "$1", $text); 
```

The `(\R)` matches all newlines.
The `{2,}` matches two or more occurrences.
The `$1` Uses the first backreference (platform specific EOL) as the replacement.

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-04-02T13:21:05.080

用这个：

```
$str = preg_replace('/^\s+\r?\n$/D', '', $str); 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2013-11-08T14:20:56.830

Try this one:

```
$str = preg_replace("/(^[\r\n]*|[\r\n]+)[\s\t]*[\r\n]+/", "\r\n", $str); 
```

If you output this to a text file, it will give the same output in the simple [Notepad](http://en.wikipedia.org/wiki/Notepad_%28software%29), [WordPad](http://en.wikipedia.org/wiki/WordPad) and also in text editors, for example [Notepad++](http://en.wikipedia.org/wiki/Notepad%2B%2B).

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2021-08-21T14:17:45.897

This has been already answered long time ago but can greatly benefit for `preg_replace` and a much simplified pattern:

```
$result = preg_replace('/\s*($|\n)/', '\1', $subject); 
```

*Pattern: Remove all white-space before a new-line -or- at the end of the string.*

Longest match wins:

*   As the white-space `\s` has a greedy quantifier `*` and contains `\n` consecutive empty lines are matched.

*   As `\s` contains `\r` as well, `\r\n` new-line sequences are supported, however single `\r` (without `\n`) are not.

*   And when `$` matches the end of the buffer the backreference `\1` is empty allowing to handle trailing whitespace at the very end, too.

If leading (empty) lines need to be removed as well, they have to match while not capturing, too (this was not directly asked for but could be appropriate):

```
$result = preg_replace('/^(?:\s*\n)+|\s*($|\n)/', '\1', $subject);
#                        '----------' 
```

*Pattern: Also remove all leading white-space (first line(s) are empty).*

And if the new-line at the end of the buffer should be normalized differently (always a newline at the end instead of never), it needs to be added: `. "\n"`.

This variant is portable to `\r\n`, `\r` and `\n` new-line sequences (`(?>\r\n|\r|\n)`) or `\R`:

```
$result = preg_replace('/^(?> |\t|\r\n|\r|\n)+|(?> |\t|\r\n|\r|\n)*($|(?>\r\n|\r|\n))/', '\1', $subject);
# or:
$result = preg_replace('/^(?:\s*\R)+|\s*($|\R)/', '\1', $subject); 
```

*Pattern: Support all new-line sequences.*

This is with the downside that the new-lines can not be normalized (e.g. any of the three to `\n`).

Therefore, it can make sense to normalize new-lines before removing:

```
$result = preg_replace(['/(?>\r\n|\n|\r)/', '/\s*($|\n)/'], ["\n", '\1'], $subject);
# or:
$result = preg_replace(['/\R/u', '/\s*($|\n)/'], ["\n", '\1'], $subject); 
```

It ships with the opportunity to do some normalization apart from the line handling.

For example removal of the trailing white-space and fixing the missing new-line at the end of file.

Then doing more advanced line normalization, for example zero empty lines at the beginning and end; otherwise not more than two consecutive empty lines:

```
$result = preg_replace(
    ['/[ \t]*($|\R)/u', '/^\n*|(\n)\n*$|(\n{3})\n+/'], 
    ["\n"             , '\1\2'                      ], 
    $subject
); 
```

*The secondary pattern benefits from the first patterns replacements already.*

The power with `preg_replace` relies here in choosing the backreference(s) to replace with wisely.

Also using multiple patterns can greatly simplify things and keep the process maintainable.

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2011-10-03T23:35:41.540

```
function trimblanklines($str) {
    return preg_replace('`\A[ \t]*\r?\n|\r?\n[ \t]*\Z`','',$str);
} 
```

This one only removes them from the beginning and end, not the middle (if anyone else was looking for this).

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2015-01-16T02:03:18.867

The accepted answer leaves an extra line-break at the end of the string. Using `rtrim()` will remove this final linebreak:

```
rtrim(preg_replace("/(^[\r\n]*|[\r\n]+)[\s\t]*[\r\n]+/", "\n", $string)); 
```

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2017-04-19T11:59:04.290

From [this answer](https://stackoverflow.com/questions/17575992/using-php-to-minify-javascript-html-css-within-a-string?answertab=votes#tab-top), the following works fine for me!

```
$str = "<html>
<body>";

echo str_replace(array("\r", "\n"), '', $str); 
```

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2019-09-10T15:40:45.137

```
 <?php

    function del_blanklines_in_array_q($ar){
        $strip = array();
        foreach($ar as $k => $v){
            $ll = strlen($v);
            while($ll--){
                if(ord($v[$ll]) > 32){  //hex /0x20 int 32 ascii SPACE
                    $strip[] = $v; break; 
                }
            }
        }
        return $strip;
    }

    function del_blanklines_in_file_q($in, $out){
        // in filename, out filename
        $strip = del_blanklines_in_array_q(file($in));
        file_put_contents($out, $strip );
    } 
```

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2020-04-11T02:37:20.480

```
$file = "file_name.txt";
$file_data = file_get_contents($file);
$file_data_after_remove_blank_line = preg_replace("/(^[\r\n]*|[\r\n]+)[\s\t]*[\r\n]+/", "\n", $file_data );
file_put_contents($file,$file_data_after_remove_blank_line); 
```

* * *

## 回答 #14

> 赞同：-1
> 
> 时间：2020-04-06T06:37:45.037

nl2br(preg_replace('/^\v+/m', '', $r_msg))

# ruby-on-rails - Ruby on Rails 的隐藏特性

> ID：709679
> 
> 赞同：57
> 
> 时间：2009-04-02T13:21:15.093
> 
> 标签：ruby-on-rails

作为[Ruby 隐藏特性的](https://stackoverflow.com/questions/63998/hidden-features-of-ruby)伴侣。

尝试将它保留在 Rails 中，因为另一个是 Ruby 特定示例的更好位置。请每个帖子一个。

* * *

## 回答 #1

> 赞同：69
> 
> 时间：2009-06-30T04:38:43.433

为了避免重复提交表单，Rails 有一个不错的提交标签选项：

```
submit_tag "Submit", :disable_with => "Saving..." 
```

这为提交按钮添加了行为，一旦单击就禁用它，并显示“正在保存...”而不是“提交”。

**导轨 4+**

```
 DEPRECATION WARNING: :disable_with option is deprecated and 
 will be removed from Rails 4.1\. Use 'data: { disable_with: 'Text' }' instead. 
```

于是上面就变成了：

```
submit_tag 'Submit', data: { disable_with: 'Text' } 
```

* * *

## 回答 #2

> 赞同：22
> 
> 时间：2009-04-13T15:37:11.850

integer.ordinalize 是我不久前偶然发现的一个小方法。

```
1.ordinalize = "1st"
3.ordinalize = "3rd" 
```

* * *

## 回答 #3

> 赞同：21
> 
> 时间：2009-08-05T20:43:49.227

我现在爱上了`div_for`和`content_tag_for`

```
<% div_for(@comment) do %>
  <!-- code to display your comment -->
<% end %> 
```

上面的代码呈现了这一点：

```
<div id="comment_123" class="comment">
  <!-- code to display your comment -->
</div> 
```

想要 CSS 类`comment other_class`吗？没问题：

```
<% div_for(@comment, :class => 'other_class') do %>
  <!-- code to display your comment -->
<% end %> 
```

想要一个跨度而不是一个div？没问题，`content_tag_for`救命！

```
<% content_tag_for(:span, @comment) do %>
<% end %>

# Becomes...

<span id="comment_123" class="comment">
  <!-- code to display your comment -->
</span> 
```

`content_tag_for`如果你想给你加前缀也很好`id`。我用它来加载 gif。

```
<% content_tag_for(:span, @comment, 'loading') do %>
  <%= image_tag 'loading.gif' -%>
<% end %>

# Becomes...

<span id="loading_comment_123" class="comment">
  <img src="loading.gif" />
</span> 
```

* * *

## 回答 #4

> 赞同：18
> 
> 时间：2009-05-20T15:40:53.133

要查看已安装的 gem 列表，您可以运行：

```
gem server 
```

然后将浏览器指向：

```
http://localhost:8808 
```

你会得到一个格式很好的 gems 列表，其中包含指向 rdoc、web 和任何依赖项的链接。比：

```
gem list 
```

* * *

## 回答 #5

> 赞同：16
> 
> 时间：2009-04-30T08:52:32.867

您可以利用 Ruby 类定义处于活动状态以及 Rails 在生产环境中缓存类这一事实，以确保仅在应用程序启动时从数据库中获取常量数据。

例如，对于代表国家/地区的模型，您需要定义一个常量，在`Country.all`加载类时执行查询：

```
class Country < ActiveRecord::Base
  COUNTRIES = self.all
  .
  .
  .
end 
```

您可以通过参考`Country::COUNTRIES`. 例如：

```
<%= select_tag(:country, options_for_select(Country::COUNTRIES)) %> 
```

* * *

## 回答 #6

> 赞同：13
> 
> 时间：2009-06-22T01:54:26.570

在您的 environment.rb 中，您可以定义新的日期/时间格式，例如

```
[Time::DATE_FORMATS, Date::DATE_FORMATS].each do |obj|
  obj[:dots] = "%m.%d.%y"
end 
```

那么在你的观点中你可以使用：

```
Created: <%= @my_object.created_at.to_s(:dots) %> 
```

这将打印如下：

```
Created: 06.21.09 
```

* * *

## 回答 #7

> 赞同：12
> 
> 时间：2009-04-30T08:13:05.850

如果您的模型具有一些类方法和一些命名范围：

```
class Animal < ActiveRecord::Base
  named_scope 'nocturnal', :conditions => {'nocturnal' => true}
  named_scope 'carnivorous', :conditions => {'vegetarian' => true}

  def self.feed_all_with(food)
    self.all.each do |animal|
      animal.feed_with(food)
    end
  end
end 
```

然后您可以通过命名范围调用类方法：

```
if night_time?
  Animal.nocturnal.carnivorous.feed_all_with(bacon)
end 
```

* * *

## 回答 #8

> 赞同：8
> 
> 时间：2009-04-02T13:37:21.467

Rails 2.3.x 现在允许您执行以下操作：

```
render @items 
```

简单多了。。

* * *

## 回答 #9

> 赞同：7
> 
> 时间：2009-04-02T13:24:08.847

我将从我最喜欢的一个开始。当使用集合调用部分时，您可以使用以下命令，而不是遍历您的集合并为每个项目调用它：

```
render :partial => 'items', :collection => @items 
```

这将为每个项目调用一次部分，并每次传递一个局部变量项目。您也不必担心 nil 检查@items。

* * *

## 回答 #10

> 赞同：5
> 
> 时间：2010-05-12T16:05:04.277

您可以为您的测试套件更改模型的行为。假设您定义了一些 after_save 方法，并且您不希望它在单元测试中发生。这是它的工作原理：

```
# models/person.rb
class Person < ActiveRecord::Base

  def after_save
    # do something useful
  end

end

# test/unit/person_test.rb
require 'test_helper'

class PersonTest < ActiveSupport::TestCase

  class ::Person
    def after_save
      # do nothing
    end
  end

  test "something interesting" do
    # ...
  end
end 
```

* * *

## 回答 #11

> 赞同：5
> 
> 时间：2012-02-02T16:02:22.447

有趣的特点是数组有特殊的方法来访问它的 42 个元素

```
a = []
a.forty_two 
```

[http://railsapi.com/doc/rails-v2.3.8/classes/ActiveSupport/CoreExtensions/Array/Access.html#M003045](http://railsapi.com/doc/rails-v2.3.8/classes/ActiveSupport/CoreExtensions/Array/Access.html#M003045)

* * *

## 回答 #12

> 赞同：4
> 
> 时间：2009-04-30T07:11:18.883

If you add routing for a resource:

```
ActionController::Routing::Routes.draw do |map|
  map.resources :maps
end 
```

And register additional mime-types:

```
Mime::Type.register 'application/vnd.google-earth.kml+xml', :kml 
```

You don't need a `respond_to` block in your controller to serve these additional types. Instead, just create views for the specific types, for example `'show.kml.builder'` or `'index.kml.erb'`. Rails will render these type-specific templates when requests for `'/maps.kml'` or `'/maps/1.kml'` are received, setting the response type appropriately.

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2009-11-28T17:01:13.187

返回块是返回值的好方法：

```
def returns_a_hash(id)
  returning Hash.new do |result|
   result["id"] = id
  end
end 
```

将返回一个哈希。您也可以替换任何其他类型。

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2009-06-30T05:13:28.693

```
ActionView::Base.default_form_builder = MyFormBuilderClass 
```

当您创建自己的表单构建器时非常有用。`custom_form_for`在您的视图或您自己的助手中手动传递 :builder 的更好选择。

* * *

## 回答 #15

> 赞同：1
> 
> 时间：2012-04-13T10:58:51.753

以编程方式使用 rake 路由打印所有内容：

```
Rails.application.routes 
```

# c# - 绑定目标何时更新复杂路径？

> ID：709683
> 
> 赞同：4
> 
> 时间：2009-04-02T13:22:42.050
> 
> 标签：c#, .net, wpf, data-binding

在 WPF 中使用数据绑定时，目标依赖对象会在通过`INotifyPropertyChanged`接口通知源已更改时更新。

例如：

```
<TextBlock Text="{Binding Path=SomeField}"/> 
```

`PropertyChanged(this, new PropertyChangedEventArgs("SomeField"))`每当从源调用时，文本字段都会更改以正确反映 SomeField 的值。

如果我使用如下复杂路径怎么办：

```
<TextBlock Text="{Binding Path=SomeObjField.AnotherField}"/> 
```

文本字段会`PropertyChanged(this, new PropertyChangedEventArgs("SomeObjField"))`在源上更新吗？

`PropertyChanged(this, new PropertyChangedEventArgs("AnotherField"))`中间对象（包含在 SomeObjField 中的对象）呢？

源对象和字段不是依赖对象或属性！假设属性/类的实现如下：

```
public class Data : INotifyPropertyChanged
{
   // INotifyPropertyChanged implementation...

   public string SomeField
   {
      get { return val; }
      set
      {
         val = value;
         // fire PropertyChanged()
      }
   }

   public SubData SomeObjField
   {
      get { return val; }
      set
      {
         val = value;
         // fire PropertyChanged()
      }
   }   
}

public class SubData : INotifyPropertyChanged
{
   // INotifyPropertyChanged implementation...

   public string AnotherField
   {
      get { return val; }
      set
      {
         val = value;
         // fire PropertyChanged()
      }
   }
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-02T14:40:42.110

经过进一步调查，似乎当复杂路径的任何部分发送更改通知时，绑定就会更新。因此，如果源对象或中间对象发生更改，则绑定将被更新。

我建立了一个像 Jared 那样的测试项目：

```
<StackPanel Name="m_panel">
    <TextBox IsReadOnly="True" Text="{Binding Path=SomeObjField.AnotherField }"  />
    <TextBox x:Name="field1"/>
    <Button Click="Button1_Click">Edit Root Object</Button>
    <TextBox x:Name="field2"/>
    <Button Click="Button2_Click">Edit Sub Object</Button>
</StackPanel> 
```

以及背后的代码：

```
public Window1()
{
    InitializeComponent();
    m_panel.DataContext = new Data();
}

private void Button1_Click(object sender, RoutedEventArgs e)
{
    Data d = m_panel.DataContext as Data;
    d.SomeObjField = new SubData(field1.Text);
}

private void Button2_Click(object sender, RoutedEventArgs e)
{
    Data d = m_panel.DataContext as Data;
    d.SomeObjField.AnotherField = field2.Text;
} 
```

我正在使用我在问题中提供的基本数据实现。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-02T13:57:17.597

我不是 100% 确定您对问题的 PropertyChanged 部分的要求。但是，如果所涉及的属性都是 DependencyProperty 支持的属性，那么这应该可以按预期工作。我制定了以下示例

Window1.xaml

```
<Window x:Class="WpfApplication1.Window1"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    Title="Window1" Height="300" Width="300">
    <StackPanel Name="m_panel">
        <TextBlock Text="{Binding Path=SomeField}" />
        <TextBlock Text="{Binding Path=SomeField.AnotherField }"  />
        <Button Click="Button_Click">Update Root Object</Button>
        <Button Click="Button_Click_1">Update Another Field</Button>
    </StackPanel>
</Window> 
```

Window1.xaml.cs

```
public partial class Window1 : Window
{
    public Window1()
    {
        InitializeComponent();
        m_panel.DataContext = new Class1();
    }

    private void Button_Click(object sender, RoutedEventArgs e)
    {
        ((Class1)m_panel.DataContext).SomeField = new Class2();
    }

    private void Button_Click_1(object sender, RoutedEventArgs e)
    {
        ((Class1)m_panel.DataContext).SomeField.AnotherField = "Updated field";
    }
} 
```

和类

```
public class Class1 : DependencyObject
{
    public static DependencyProperty SomeFieldProperty = DependencyProperty.Register(
        "SomeField",
        typeof(Class2),
        typeof(Class1));

    public Class2 SomeField
    {
        get { return (Class2)GetValue(SomeFieldProperty); }
        set { SetValue(SomeFieldProperty, value); }
    }

    public Class1()
    {
        SomeField = new Class2();
    }
}

public class Class2 : DependencyObject
{
    public static DependencyProperty AnotherFieldProperty = DependencyProperty.Register(
        "AnotherField",
        typeof(string),
        typeof(Class2));

    public string AnotherField
    {
        get { return (string)GetValue(AnotherFieldProperty); }
        set { SetValue(AnotherFieldProperty, value); }
    }

    public Class2()
    {
        AnotherField = "Default Value";
    }
} 
```

# asp.net-mvc - .net mvc 的简短/快速解释

> ID：709690
> 
> 赞同：7
> 
> 时间：2009-04-02T13:24:52.980
> 
> 标签：asp.net-mvc, communication

.net mvc 的最短解释是什么（让经理从高层次了解它的工作原理、好处等）。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-04-02T13:27:13.473

你可以从[这里](http://www.asp.net/mvc/)开始。

> **ASP.NET MVC**使您能够使用 ASP.NET 框架构建模型视图控制器 (MVC) 应用程序。ASP.NET MVC 是 ASP.NET Web 窗体的替代品，而不是替代品，具有以下优点：
> 
> *   清晰的关注点分离
> *   可测试性 - 支持测试驱动开发
> *   对 HTML 和 JavaScript 的细粒度控制
> *   直观的 URL

正如柯蒂斯克在他的回答中指出的那样，[维基百科](http://en.wikipedia.org/wiki/Model-view-controller)也有一个很好的描述：

> **模型-视图-控制器 (MVC)**是一种用于软件工程的架构模式。该模式的成功使用将业务逻辑与用户界面考虑隔离开来，从而使应用程序更容易修改应用程序的视觉外观或底层业务规则，而不会影响另一个。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-02T13:28:51.147

经理喜欢代码指标、指标和统计数据。代码质量的一个重要衡量标准是耦合。向您的经理解释 MVC 减少了耦合，从长远来看，这反过来又使您的程序更加灵活。

那里有几个度量计算器，[这里](http://cmetrics.codeplex.com/)是 codeplex 上的一个。

[这](http://www.ndepend.com/Metrics.aspx)是另一个用于软件度量的软件，它也解释了它们。检查涉及耦合的指标。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-02T13:31:18.567

简而言之，ASP.net MVC 提供了比 asp.net webforms 更好的模块化和可测试性。但是，一个缺点是您丢失了 webforms 为您提供的一些抽象，因此有些事情需要更多的工作来连接。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-02T13:28:23.143

[http://en.wikipedia.org/wiki/Model-view-controller](http://en.wikipedia.org/wiki/Model-view-controller)的第一段，实际上 MVC 并没有远程绑定到 asp.net，只是给出语言不可知的模式描述

# html - 替换为 HTML ascii 代码

> ID：709694
> 
> 赞同：1
> 
> 时间：2009-04-02T13:25:41.823
> 
> 标签：html, vb.net, ascii

我遇到了一个问题。编写了以下代码片段：

```
teksti = teksti.Trim()
teksti = Replace(teksti, "<", "& lt;")
teksti = Replace(teksti, ">", "& gt;")
teksti = Replace(teksti, """", "& quot;")
teksti = Replace(teksti, "'", "& #8217;")
teksti = Replace(teksti, "%", "& #37;")
teksti = Replace(teksti, "&", "& amp;")
teksti = Replace(teksti, "#", "& #35;")
teksti = Replace(teksti, "@", "& #64;") 
```

写完这篇文章后，我意识到它变成了它自己的问题。该函数应该使 HTML 和 SQL 注入的信息安全（还有其他方法，参数化查询等，但这不是重点）。但是会发生什么，它首先替换`&lt;`为`& lt;` ，然后再次替换新写入的字符串，因为每个替换字符串都有 &、# 和 ; 签到。

有什么提示吗？我考虑过为此使用正则表达式，但我找不到任何足够简单的像样的 Visual Basic 示例。

**编辑：**感谢您的提示。我确信会有一种“聪明”的简单方法来做到这一点，但我想毕竟没有可用的通用方法。首先重新安排问题案例是这里明显的解决方案，谢谢。我想工作日太长了，我没有注意到。:D

至于参数化查询，回头看看我发现我的英语没有按预期出现。我的意思是说我已经在使用它们，这里的这个问题是为了防止以后在其他地方使用相同的字符串进行各种 html 注入和可能的 sql 注入。再次感谢您的帮助。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-04-02T13:28:59.460

如果这是 .NET，您可能会[`System.Web.HttpServerUtility.HtmlEncode`](http://msdn.microsoft.com/en-us/library/system.web.httpserverutility.htmlencode.aspx)改为查看。

如果您使用的是 VBScript/VB6，只需将 & 和磅符号移到此列表的顶部，并且不要依赖此功能来保护您免受 sql 注入。您仍然需要参数化查询。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-02T13:32:16.910

如果您使用的是 VB.NET，您正在寻找[System.Web.HttpUtility.HtmlEncode(string)](http://msdn.microsoft.com/en-us/library/73z22y6h.aspx)。

否则，我将一次遍历字符串一个字符并构建一个新的编码字符串，并在你去的时候替换。这样，您只需要遍历字符串和每个字符的 case 语句，并且您不会重新编码已编码的字符。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-02T13:34:16.017

您可以重新排序以将问题案例放在首位。或者您可以遍历字符串并通过依次分析每个字符并附加它或它是所需的替换来构建一个新字符串。否则，您可以为此使用现成的库/函数，尽管我不精通这种语言，所以无法命名。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-04-02T13:37:34.477

先替换 & 字符，然后替换 # 字符。之后，可以安全地更换其他人。

但是，这**不是**防止 SQL 注入的好方法。最好使用参数化查询来完成。您的代码中有一些字符不需要对 HTML 进行编码，如果您对它们进行编码以防止 SQL 注入，那么您将处于危险的道路上。这将使 SQL 注入更难完成，但这不是一种安全的方法。

此外，如果您在将文本放入数据库之前对其进行编码，则以后可能会遇到问题。最好将文本原封不动地存储在数据库中，并在显示文本时注意 HTML 编码。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-04-02T13:36:49.440

按照其他人的建议重新排序。如果您发现两个相互冲突且无法通过重新排序解决的情况，请添加一个额外的替换，如下所示：

```
teksti = teksti.Trim()
teksti = Replace(teksti, "&", "THISISANAMP")
teksti = Replace(teksti, ";", "& #59;")
teksti = Replace(teksti, "#", "& #35;")
teksti = Replace(teksti, "THISISANAMP", "&amp;") ''newly added
teksti = Replace(teksti, "<", "& lt;")
teksti = Replace(teksti, ">", "& gt;")
teksti = Replace(teksti, """", "& quot;")
teksti = Replace(teksti, "'", "& #8217;")
teksti = Replace(teksti, "%", "& #37;")
teksti = Replace(teksti, "@", "& #64;") 
```

这是更改代码的最简单方法。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-04-02T15:02:29.843

就像之前的帖子中提到的那样，重新排序“替换”应该可以快速解决您的特定问题，并且非常建议您也查看参数化查询。

另一个建议是让您查看用于编码的内置 .net 库，特别是**Microsoft.Security.Application.AntiXss**库，我发现它比 System.Web.HttpUtility.HtmlEncode 更好，因为它使用“白名单”方法而不是“黑名单”方法。

您可以在[此处](http://blogs.msdn.com/cisg/archive/2008/08/26/what-is-microsoft-antixss.aspx)找到有关它的更多信息：

希望这可以帮助。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2018-06-26T11:02:32.923

这对我来说很好：

`yourString = HttpUtility.HtmlDecode(yourString)`

确保导入`System.Web`

*[html字符代码表](https://www.rapidtables.com/web/html/html-codes.html)*

# c - 宏观问题

> ID：709706
> 
> 赞同：2
> 
> 时间：2009-04-02T13:27:23.207
> 
> 标签：c, macros

在一个软件项目（一些旧的 C 编译器）中，我们有很多变量必须正常保存和反转。

有人知道我如何制作这样的宏吗？

```
SET(SomeVariable, 137); 
```

这将执行

```
SomeVariable = 137;
SomeVariable_inverse = ~137; 
```

编辑：

最好的解决方案似乎是：

```
#define SET(var,value) do { var = (value); var##_inverse = ~(value); } while(0) 
```

感谢您的回答

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-04-02T13:30:00.613

试试这个

```
#define SET(var,value) do { var = (value); var##_inverse = ~(value); } while(0) 
```

**编辑**

几个链接到在宏中添加 do/while 的原因

*   [https://stackoverflow.com/questions/257418/do-while-0-what-is-it-good-for](https://stackoverflow.com/questions/257418/do-while-0-what-is-it-good-for)
*   [http://www.rtems.com/ml/rtems-users/2001/august/msg00111.html](http://www.rtems.com/ml/rtems-users/2001/august/msg00111.html)
*   [http://c2.com/cgi/wiki?TrivialDoWhileLoop](http://c2.com/cgi/wiki?TrivialDoWhileLoop)
*   [http://blogs.msdn.com/jaredpar/archive/2008/05/21/do-while-0-what.aspx](http://blogs.msdn.com/jaredpar/archive/2008/05/21/do-while-0-what.aspx)

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-04-02T15:51:53.447

我没有看到提到的一个危险是，在大多数解决方案中，“值”宏参数被评估了两次。如果有人尝试这样的事情，这可能会导致问题：

```
int x = 10;
SET(myVariable, x++); 
```

在此调用之后，myVariable 将是 10，而 myVariable_inverse 将是 ~11。哎呀。对 JaredPar 解决方案的一个小改动解决了这个问题：

```
#define SET(var,value) do { var = (value); var##_inverse = ~(var); } while(0) 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-04-02T13:30:38.287

当它可以如此容易地计算时，你为什么要存储它？这对我来说似乎是个坏主意。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-04-02T16:07:38.510

您可以在单个语句中执行此操作，从而避免使用`do {} while (0)`.

```
#define SetInverse(token, value) (token##_inverse = ~(token = (value))) 
```

此外，这只评估`(value)`一次，这总是很好。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-04-02T13:30:04.997

```
#define SetInverse(token, value) { token = value; token##_inverse = ~value; } 
```

Jinx, Jared - 就像你的 while (0)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-04-02T23:01:33.197

只是提供一种替代方法：

将每个变量存储为如下结构：

```
typedef struct
{
    u32 u32Normal;
    u32 u32Inverted;
} SafeU32TYPE 
```

然后有一个函数，它接受一个指向其中一个的指针，以及要设置的值，并存储该值及其逆：

```
void Set(SafeU32TYPE *pSafeU32, u32Data)
{
    if(pSafeU32 != NULL)
    {
        pSafeU32->u32Normal = u32Data;
        pSageU32->u32Inverted = ~u32Data;
    } /* if */
} /* Set() */ 
```

**优点**：如果你需要 set 函数做一些更强大的事情，比如边界检查，或者以更复杂的方式存储，那么它可以很容易地扩展。

**缺点**：您需要为每种使用的类型使用不同的函数，如果处理器资源是一个问题，这比使用宏效率低。

# database - PostgreSQL 中的最大事务大小

> ID：709708
> 
> 赞同：35
> 
> 时间：2009-04-02T13:27:36.157
> 
> 标签：database, postgresql, transactions

我的应用程序中有一个实用程序，我需要在其中执行插入、更新和删除操作的批量加载。我正在尝试围绕此创建事务，以便一旦调用该系统并将数据提供给它，就可以确保它要么全部添加到数据库中，要么没有添加到数据库中。

所关心的是这里的边界条件是什么？一笔交易可以有多少个 INSERT、UPDATE 和 DELETE？交易规模是否可配置？

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2009-04-02T15:08:19.940

我不认为可以在事务中执行的最大工作量。数据不断添加到表文件中，最终事务要么提交要么回滚：AIUI 这个结果存储在 pg_clog 中；如果它回滚，空间最终会被真空回收。因此，例如，正在进行的事务工作并不是保存在内存中并在提交时刷新。

* * *

## 回答 #2

> 赞同：24
> 
> 时间：2009-08-28T09:09:57.793

单个事务可以在其中运行大约 20 亿条命令（2^31，减去 IIRC 一点点开销。实际上，想想看，可能是 2^32 - 我认为命令计数器是无符号的）。

当然，这些命令中的每一个都可以修改多行。

* * *

## 回答 #3

> 赞同：21
> 
> 时间：2009-04-04T13:55:18.517

对于我从事的一个项目，我执行了 2000 万次 INSERT。我尝试了一笔大交易和每百万次 INSERT 的一笔交易，性能似乎完全相同。

PostgreSQL 8.3

* * *

## 回答 #4

> 赞同：-2
> 
> 时间：2009-08-28T06:56:58.233

我相信最大工作量受您的日志文件大小的限制。数据库永远不会让自己无法回滚，因此如果您在事务期间消耗所有日志空间，它将停止，直到您给它更多空间或回滚。这对于所有数据库来说都是如此。

我建议将您的更新分块成可管理的块，最多需要几分钟的执行时间，这样您就知道是否更早出现问题（例如，通常需要 1 分钟的内容在 10 分钟后仍在运行......嗯，有人删除索引？）

# perl - 为什么我在 Perl 输出中看到 HASH(0xABCDEF)？

> ID：709710
> 
> 赞同：2
> 
> 时间：2009-04-02T13:28:00.913
> 
> 标签：perl, reference, stringification

我正在运行 perl，为 sun4-solaris-64int 构建的 v5.6.1

我在数组上调用 print：

```
print "@vals\n"; 
```

输出如下：

```
HASH(0x229a4) uid cn attuid 
```

或另一个例子：

```
@foo = {};
push(@foo, "c");

print "@foo I am done now\n"; 
```

输出：

```
HASH(0x2ece0) c I am done now 
```

`HASH(0x2ece0)`来自哪里？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-04-02T13:30:52.700

@foo = {} 中的大括号正在创建它。大括号创建一个未命名的哈希引用。

如果要将@foo 设置为空列表，请使用@foo = ()

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-04-02T14:20:29.570

理解这类问题的关键是你在输出中得到了一个额外的项目。那个项目是什么并不重要。

一般来说，当你的容器变量比你预期的多（或少）时，你要做的第一件事就是查看它的内容。Perl 附带的 Data::Dumper 模块可以为您漂亮地打印数据结构：

```
use Data::Dumper;
print Dumper( \@foo ); 
```

一旦你看到你的容器里有什么，你就可以开始向后工作以找出它是如何进入那里的。您最终会在初始化 @foo 后立即注意到它已经有一个元素，这不是您想要的。

另一个技巧是检查列表中元素的数量：

```
print "There are " . @array . " elements in \@array\n"; 
```

如果您得到一个您不期望的数字，请向后工作以找出额外元素何时出现。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-04-02T13:37:25.960

你不小心在@foo 中有一个哈希引用。当您打印出引用而不取消引用时（几乎总是偶然），您会得到一个调试字符串（它的引用类型和内存位置）。

我认为你想要`my @foo = (); push @foo, "c";`的，而不是你现在拥有的。另一方面，您也可以简单地说`my @foo;`创建数组。您无需使用 . 显式将其标记为空`()`。

有关参考[`perldoc perlreftut`](http://perldoc.perl.org/perlreftut.html)的[`perldoc perlref`](http://perldoc.perl.org/perlref.html)更多信息，请参阅。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-04-02T13:46:01.337

你的代码应该这样写：

```
use strict;
use warnings;

my @foo;
push @foo, "c";

print "@foo I am done now\n"; 
```

如果你想要一个空变量，你不需要在 Perl 中初始化变量。但是，您应该使用`my`来声明局部变量。而且你不需要在内置函数周围加上括号，这只会增加混乱。

# asp.net-mvc - 如何在 ASP.NET MVC 视图中检查整数类型字段的空值？

> ID：709712
> 
> 赞同：0
> 
> 时间：2009-04-02T13:28:29.353
> 
> 标签：asp.net-mvc

我在数据库中有整数类型字段，它具有属性“Not Null”。

当我创建一个视图并进行验证时，如果我将该字段留空，它会将其视为 0，因此我无法将其与 0 进行比较，因为如果有人插入值 0，那么它将被视为错误！

另一个问题是我正在使用“ASP.NET MVC 1.0”@Scott Gu 博客中描述的模型错误。我正在检查部分对象类中的值（由 LINQ-To-SQL 创建）。IE

```
public partial class Person
{
    public bool IsValid
    {
        get { return (GetRuleViolations().Count() == 0); }
    }
    public IEnumerable<RuleViolation> GetRuleViolations()
    {
        if (String.IsNullOrEmpty(Name))
            yield return new RuleViolation("Name is Required", "Name");
        if (Age == 0)
            yield return new RuleViolation("Age is Required", "Age");
        yield break;
    }
    partial void OnValidate(ChangeAction action)
    {
        if (!IsValid)
            throw new ApplicationException("Rule violations prevent saving");
    }
} 
```

范围也有问题。

就像在数据库中一样，如果我在 c# 中声明为 smallint 即 short，现在如果我超出该范围，那么它会给出错误，因为“需要 A 值”。

那么最后有没有在 ASP.NET MVC 中进行验证的最佳方法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-02T15:11:33.643

您可以使用可为空的类型更改代码吗？

```
 Dim i As Nullable(Of Integer)

    MsgBox(i.HasValue)
    'result is false

    i = 1
    MsgBox(i.HasValue)
    'result is true

    i = Nothing
    MsgBox(i.HasValue)
    'result is false 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-02T13:35:28.117

我不太了解 MVC 的细节，但有没有办法将 age 的默认值更改为 -1？这样你就有了一个值来检查，人们仍然可以输入 0。

另一种解决方案可能是使用可为空的 int。您可以通过附加一个 ? 到类型。

HTH。

乔纳森

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-02T15:05:41.333

我会先在客户端验证表单。如果年龄为 0，则让用户知道它不是有效年龄。在服务器上更改消息，它具有误导性：

```
if (Age == 0)
    yield return new RuleViolation("0 years is not a valid age", "Age"); 
```

我知道，因为您从`Person`实体绑定到模型属性，所以默认值是 0 - 为什么不在数据库中更改它呢？将数据库中的默认值设置为您认为对用户年龄合理的值，以便新实体不再显示为 0。

如果您不想更改 db 值，请使用 jQuery 将文本框值设置为加载时创建页面上的空字符串。如果用户尝试提交这样的表单，您可以在客户端上检查以禁止它，并且在服务器上您无需执行任何操作，用户将收到“需要 A 值”消息。

顺便说一句，你写道：

> 我不能将它与 0 进行比较，因为如果有人插入一个值 0，那么它将被视为错误

我在这个特定的域模型中没有看到问题。你觉得0岁值不值？问你自己。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2010-04-08T05:36:06.063

检查它`Utilities.GetNullableInt32(textbox1.Text.Trim());`

如果您使用此`GetNullableInt32()`功能检查用户是否输入了值“0”，它将保存`NUll`在您的表格中

# visual-studio - JQuery 1.3.2 vsdoc 不产生 Visual Studio 智能感知

> ID：709713
> 
> 赞同：4
> 
> 时间：2009-04-02T13:28:50.660
> 
> 标签：visual-studio, intellisense, jquery-1.3.2

过去，我使用过为 vs2008 sp1 生成智能感知的 JQuery 1.2 vsdoc 文件。

我最近下载了最新版本的 JQuery 1.3.2 和 JQuery 1.3.2 vsdoc 文件。当我尝试在 vs2008 中为 jquery 获取智能感知时 - 我收到以下错误 -

警告 1 更新 JScript IntelliSense 时出错：C:\Documents and Settings\sonx3d\My Documents\Visual Studio 2008\Projects\WebApplication2\WebApplication2\jquery-1.3.2.js：对象不支持此属性或方法 @ 2139:1

有人可以帮忙吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-04-12T06:05:05.540

它现在对我有用。我所要做的就是重命名`jquery-1.3.2-vsdoc2.js`为`jquery-1.3.2-vsdoc.js`，现在智能感知正在工作。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-04-07T06:28:02.607

检查此链接 [http://code.google.com/p/jqueryjs/downloads/list](http://code.google.com/p/jqueryjs/downloads/list)

下载文件**jquery-1.3.2-vsdoc2.js**并且不要使用**JQuery 1.3.2 vsdoc**

[还要检查来自http://blogs.msdn.com/webdevtools/archive/2009/02/24/vsdoc-for-jquery-1-3-2-now-available.aspx](http://blogs.msdn.com/webdevtools/archive/2009/02/24/vsdoc-for-jquery-1-3-2-now-available.aspx)的最后几条评论

这将解决你的问题。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-09T19:38:28.483

阅读此博客 - [http://blogs.ipona.com/james/archive/2009/01/14/jquery-1.3-and-visual-studio-2008-intellisense.aspx](http://blogs.ipona.com/james/archive/2009/01/14/jquery-1.3-and-visual-studio-2008-intellisense.aspx)

我所做的是 - 我已经下载（更新）版本的 jquery vsdoc 文件并在 vs2008 中添加了一个参考并且它有效。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-07T20:25:22.020

Visual Studio 中一些非常有用的链接 jQuery intellisense：

*   JavaScript Intellisense 常见问题解答：http: [//blogs.msdn.com/webdevtools/archive/2008/11/18/jscript-intellisense-faq.aspx](http://blogs.msdn.com/webdevtools/archive/2008/11/18/jscript-intellisense-faq.aspx)
    它解释了路径样式对 Visual Studio、ASP.NET Web 窗体和ASP.NET MVC。

*   Scott Guthrie 对 jQuery 智能感知的精彩概述： [http ://weblogs.asp.net/scottgu/archive/2008/11/21/jquery-intellisense-in-vs-2008.aspx](http://weblogs.asp.net/scottgu/archive/2008/11/21/jquery-intellisense-in-vs-2008.aspx)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-07-20T17:48:28.543

对于那些遇到错误消息的人： **更新 JScript IntelliSense 时出错：'div.childNodes' is null or not an object**

请参阅此博客： **[http ://blog.jasonkostempski.com/2009/06/jquery-132-visual-studio-2008.html#comment-form](http://blog.jasonkostempski.com/2009/06/jquery-132-visual-studio-2008.html#comment-form)**

在他们替换谷歌的文件之前，该决议可能会有所帮助。

# css - 为什么我的下拉菜单在 ie7 中不起作用？

> ID：709720
> 
> 赞同：0
> 
> 时间：2009-04-02T13:30:13.577
> 
> 标签：css, internet-explorer-7

如果您查看此页面：[http ://www.sussexjewelers.com/product_search.php?cid=69](http://www.sussexjewelers.com/product_search.php?cid=69)

下拉菜单（水平绿色条）在 ie7 中不下拉。它们确实在 ie6、firefox 和 chrome 中下降。此外，如果您查看主页，相同的下拉菜单在 ie7 中也可以使用。我无法弄清楚为什么他们不在 ie7 的这个页面上工作。它们是纯 CSS 下拉菜单。

任何帮助表示赞赏。

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-02T13:48:33.657

你的`<style>`和`<script>`标签应该在你的`<head>`标签内，而不是在你的`<html>`标签外。

还要添加一个 DOCTYPE

XHTML

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"> 
```

HTML 4

```
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd"> 
```

任你选。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-02T13:52:04.537

在实际的 HTML 文档之前有一堆样式和脚本标签。那些应该在页面的头部标签中。

doctype 标签必须是源代码中的第一个标签，否则 IE 将以 quirks 模式呈现页面。其他浏览器也可能会以 quirks 模式呈现它，但它对 IE 的影响更大。一个很大的区别是[盒子模型](http://en.wikipedia.org/wiki/Internet_Explorer_box_model_bug)处理不正确。

一旦代码的基本结构正确，您应该[验证 html](http://validator.w3.org/)和[css](http://jigsaw.w3.org/css-validator/)以查看代码中是否存在更多问题。我可以立即看到您有一个 HTML 文档类型，但您在代码中使用了 XHTML 标记。

如果清理代码后菜单仍然不起作用，我猜这是 z-index 的问题，因此菜单显示但隐藏在主要内容后面。IE 不能正确处理具有布局的元素的 z-index。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-02T13:58:41.870

TonyF 是对的。将来，请尝试在 URL 栏中运行此命令，以查看您是否实际上处于标准模式 (CSS1Compat) 与 Quirks 模式 (BackCompat)：

```
javascript:alert(document.compatMode) 
```

我在 IE 的书签中有那个。

# c# - 是否可以在该环境中使用 WCF(C#) ？

> ID：709729
> 
> 赞同：1
> 
> 时间：2009-04-02T13:32:17.830
> 
> 标签：c#, wcf, msmq

我有几个“黑盒”将数据发送到确定的 IP 和端口，我不能指定其他任何东西（只是 IP 和端口）......

我的服务器应该正在侦听该端口并捕获要发送到 MSMQ 的信息...

如何设置 WCF 服务器来监听该端口？

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-02T13:34:59.070

我会编写一个普通的 Windows 服务来监听数据。

使用[TCPListener](http://msdn.microsoft.com/en-us/library/system.net.sockets.tcplistener.aspx)或类似的类

然后将 WCF 作为 Windows 服务调用以写入消息队列的单独服务插入，这只是配置问题。

```
[ServiceContract]
public interface IDaraWriterService
{
     [OperationContract]
     public void WriteDataToQueue(WriteDataToQueueMessage theDataEncapsulatedInAMessage)
     {
     }
} 
```

顺便说一句，您的 Windows 服务可能会直接写入队列。

有关消息队列的更多信息，请参见此处。[http://msdn.microsoft.com/en-us/library/ms811053.aspx](http://msdn.microsoft.com/en-us/library/ms811053.aspx)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-02T14:38:35.847

如果您可以控制将数据推送到 IP 地址/端口的内容，那么可以，您可以使用 WCF。不幸的是，如果没有某种合同/绑定来指定“服务器”和“客户端”通信的方式，WCF 不会对您有太大帮助。

因此，如果您无法控制客户端代码，则需要“滚动自己的”侦听器。正如@Rob Stevenson-Leggett 建议的那样：[TcpListener](http://msdn.microsoft.com/en-us/library/system.net.sockets.tcplistener.aspx)

**编辑：**

> *谢谢 Randolpho... 所以，我将开发一个带有侦听器的 Windows 服务并将消息添加到 MSMQ。在其他人手中，我需要一个模块来读取队列（MSMQ）并将其添加到数据库中......那个模块可能在 WCF 中？你认为呢？*

是的。WCF 提供[MsmqIntegrationBinding](http://msdn.microsoft.com/en-us/library/system.servicemodel.msmqintegration.msmqintegrationbinding.aspx)用于在任一端与 MSMQ 进行通信。

这是一个很好的教程：

[http://msdn.microsoft.com/en-us/library/ms789008.aspx](http://msdn.microsoft.com/en-us/library/ms789008.aspx)

# sql-server - 将查询结果传递到 csv 文件并使用 SQL Server 2005 将其作为邮件发送

> ID：709735
> 
> 赞同：0
> 
> 时间：2009-04-02T13:33:45.690
> 
> 标签：sql-server, stored-procedures

我有两个任务，因为我是新手，所以我需要大师们的帮助/建议。

我需要做的是将 q select 查询的结果发送到一个 csv 文件，该文件可以将分隔符作为逗号或制表符，然后将此文件作为邮件发送给特定的收件人。

希望得到一些好的建议

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-16T07:44:25.253

尝试这样的事情：

```
DECLARE @cvs nvarchar(MAX)
DECLARE @separator nvarchar(1)

SET @cvs = N''
SET @separator = ','

SELECT TOP 10 
    @cvs = @cvs + CAST(int_column AS nvarchar) + @separator +  nvarchar_column + @separator + CAST(datetime AS nvarchar) + CHAR(13)
FROM
    data_table WITH (NOLOCK)

SELECT @cvs
PRINT @cvs

EXEC msdb.dbo.sp_send_dbmail 
    @recipients = @mail_recipients,
    @profile_name = 'SO',
    @subject = @mail_subject,
    @body = @cvs 
```

使用 COALESCE 来避免 NULL 值，如果需要，将列强制转换为 nvarchar 类型。

# c# - 方法隐藏如何在 C# 中工作？

> ID：709740
> 
> 赞同：8
> 
> 时间：2009-04-02T13:34:54.673
> 
> 标签：c#, inheritance, compiler-construction, method-hiding

为什么会打印以下程序

```
B
B 
```

（正如它应该）

```
public class A
    {
        public void Print()
        {
            Console.WriteLine("A");
        }
    }

    public class B : A
    {
        public new void Print()
        {
            Console.WriteLine("B");
        }

        public void Print2()
        {
            Print();
        }
    }

    class Program
    {
        static void Main(string[] args)
        {
            var b = new B();
            b.Print();
            b.Print2();
        }
    } 
```

但是如果我们像这样删除 B 类中的关键字“public”：

```
 new void Print()
    {
        Console.WriteLine("B");
    } 
```

它开始打印

```
A
B 
```

?

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2009-04-02T13:37:11.420

当您删除访问修饰符时，您将删除从函数`public`中调用 B 方法的任何能力，因为它现在默认为. Main 不再可以访问它。`new Print()``Main``private`

剩下的唯一选择是退回到从 A 继承的方法，因为这是唯一可访问的实现。如果您从另一个 B 方法中调用 Print()，您将获得 B 实现，因为 B 的成员将看到私有实现。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-04-02T13:37:58.330

您正在制作`Print`方法`private`，因此唯一可用`Print`的方法是继承的方法。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-04-02T13:38:03.150

在外部，新的 B.Print() 方法不再可见，因此调用了 A.Print()。

但是，在类中，新的 B.Print 方法仍然可见，因此它是由同一类中的方法调用的方法。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-04-02T13:38:22.433

当您从类 b 中删除关键字 public 时，新的 print 方法在类外不再可用，因此当您从主程序执行 b.print 时，它实际上调用了 A 中可用的公共方法（因为 b继承 a 并且 a 仍然有 Print 作为公共）

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-04-02T13:39:04.240

如果没有 public 关键字，则该方法是私有的，因此不能由 Main() 调用。

但是 Print2() 方法可以调用它，因为它可以看到自己类的其他方法，即使是私有的。

# html - 在 OSCommerce 中更改“主页”徽标的 URL 目标

> ID：709743
> 
> 赞同：1
> 
> 时间：2009-04-02T13:35:40.100
> 
> 标签：html, oscommerce, sts-simple-templatesystem

[http://shop.auxout.com/](http://shop.auxout.com/)

我们暂时将商店托管在虚拟服务器上。谁能告诉我在哪里可以编辑 OSComm 以使顶部的 AUX 徽标指向[www.auxout.com](http://www.auxout.com)？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-07-06T07:54:33.293

**在 osCommerce v2.2**

文件：`catalog/includes/header.php`

在全新安装的第 57 行附近找到这一行：

```
<td valign="middle"><?php echo '<a href="' . tep_href_link(FILENAME_DEFAULT) . '">' .
  tep_image(DIR_WS_IMAGES . 'store_logo.png', STORE_NAME) . '</a>'; ?></td> 
```

**在 osCommerce v3**中（如果您至少使用默认模板）

文件：`templates/default.php`

在全新安装的第 264 行附近找到此行：

```
echo osc_link_object(osc_href_link(FILENAME_DEFAULT), osc_image(DIR_WS_IMAGES .
 'store_logo.jpg', STORE_NAME), 'id="siteLogo"'); 
```

在这两种情况下，只需将`FILENAME_DEFAULT`部分编辑为您希望商店徽标指向的位置（如果不是目录主页）。

# language-agnostic - 如何找到类似的代码片段？

> ID：709744
> 
> 赞同：21
> 
> 时间：2009-04-02T13:36:12.750
> 
> 标签：language-agnostic, search, maintenance, code-duplication

有没有人有一些工具或一些推荐的做法如何找到一段与其他代码相似的代码？

我经常写一个函数或一个代码片段，我记得我之前已经写过类似的东西，我想重用以前的实现，但是使用纯文本搜索不会显示任何内容，因为我没有使用变量名完全一样。

拥有相似的代码片段会导致不必要的代码重复，但是对于大型代码库，不可能将所有代码都保存在内存中。是否有任何工具可以对功能上“相似”的代码和标记的片段或功能进行一些分析？

考虑以下示例：

```
 float xDistance = 0, zDistance = 0;
  if (camPos.X()<xgMin) xDistance = xgMin-camPos.X();
  if (camPos.X()>xgMax) xDistance = camPos.X()-xgMax;
  if (camPos.Z()<zgMin) zDistance = zgMin-camPos.Z();
  if (camPos.Z()>zgMax) zDistance = camPos.Z()-zgMax;
  float dist = sqrt(xDistance*xDistance+zDistance*zDistance); 
```

和

```
 float distX = 0, distZ = 0;
  if (cPos.X()<xgMin) distX = xgMin-cPos.X();
  if (cPos.X()>xgMax) distX = cPos.X()-xgMax;
  if (cPos.Z()<zgMin) distZ = zgMin-cPos.Z();
  if (cPos.Z()>zgMax) distZ = cPos.Z()-zgMax;
  float dist = sqrt(distX*distX +distZ*distZ); 
```

* * *

在我看来，这已经被问了好几次了：

[https://stackoverflow.com/questions/204177/what-tool-to-find-code-duplicates-in-c-projects](https://stackoverflow.com/questions/204177/what-tool-to-find-code-duplicates-in-c-projects)

[如何在开发过程中检测代码重复？](https://stackoverflow.com/questions/191614/how-to-detect-code-duplication-during-development)

我建议在这里关闭重复。

* * *

其实我认为这是一个更普遍的搜索问题，比如：如果问题已经在 StackOverflow 上被问过，我该如何搜索？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-04-02T13:43:57.037

您可以使用[Simian](http://www.harukizaemon.com/simian/index.html)。它是一种检测 Java、C#、C++、XML 等（甚至是纯 txt 文件）中重复代码的工具。它甚至可以很好地集成到像 CruiseControl 这样的工具中。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-08-23T05:57:21.880

我们的[CloneDR](http://www.semanticdesigns.com/Products/Clone)在大型源系统中查找重复代码，包括精确副本和接近未命中，并由语言语法参数化。它支持 Java、C#、COBOL、C++、PHP、Python 和许多其他语言。

它接受许多参数来定义“什么是克隆？”，包括：a）相似度阈值，控制两个代码块必须有多相似才能被声明为克隆（通常 95% 是好的）b）最少行数克隆大小（3 往往是一个不错的选择） c）参数的数量（对文本的明显更改；5 往往是一个不错的选择）使用这些设置，它往往会在它处理的几乎所有内容中找到 10-15% 的冗余代码.

Simian 等面向行的克隆检测工具无法找到已重新格式化的克隆代码，但 CloneDR 会。他们可能会告诉您两个代码块匹配，但通常不会向您显示它们的确切匹配方式或差异所在；CloneDR 会。他们没有建议如何抽象克隆代码；CloneDR 会。

由于具有较弱的匹配算法，它们往往会产生更多的误报；当您报告超过 100 万行的 5000 个克隆时，误报的数量非常重要。

根据您的示例，我希望它能够找到这两个片段（您没有指向任何一个片段）并注意，如果您抽象出变量名称，它们是相似的。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-12-15T21:05:26.493

这是我见过的关于代码克隆检测的最佳集合：

[https://web.archive.org/web/20120502162147/http://students.cis.uab.edu/tairasr/clones/literature](https://web.archive.org/web/20120502162147/http://students.cis.uab.edu/tairasr/clones/literature)

有很多程序，但似乎没有一个是最好的或最受欢迎的。您可以思考什么对您来说最重要，并找到适合您需求的内容。

# asp.net-mvc - MVC 导航选项卡

> ID：709746
> 
> 赞同：1
> 
> 时间：2009-04-02T13:36:52.170
> 
> 标签：asp.net-mvc

好的，我现在想知道如何使用 ASP.NET MVC 处理导航选项卡。举个例子，假设你有你在 stackoverflow 上的标签。因此，问题、标签、用户等。

现在假设您在这个主选项卡下有一个“子选项卡”。因此，一旦您选择了主问题选项卡，就会显示例如查看和添加选项卡。一些问题：

*   最好为这两个实例设置一组路由，例如[http://site/questions/view](http://site/questions/view)和[http://site/questions/add ？](http://site/questions/add)

*   因此，您是否有一个 NavigationController 包含每个主选项卡的操作，即问题、标签等，然后是子选项卡的 id 值，即查看和添加。然后，这将为您提供以下内容：

公共 ActionResult 问题（字符串视图）

公共 ActionResult 标签（字符串视图）

ETC

*   或者您是否会为每个选项卡/导航项设置一个控制器，如果是，将如何实现？

*   假设您需要显示通过突出显示等方式选择的选项卡。在导航选项卡的视图（我猜你会有一个部分视图）中，这会直接引用 URL 以确定应该突出显示哪个，还是以其他方式最好？

在此先感谢您的任何指点

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-02T13:43:42.030

你最好的选择是坚持[REST](http://en.wikipedia.org/wiki/REST)。我会坚持每个主选项卡和每个子选项卡对应可能的 REST 操作都有一个控制器：索引、新的。编辑和删除是特定于项目的，因此不会获得标签。创建由 new 调用，由 edit 更新。

您的示例中的一个例外是“提问”选项卡。它与“问题”选项卡（索引）处于同一级别，但会调用“问题/新”。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-02T13:55:55.557

我认为您的控制器应该比您的用户界面更紧密地绑定到您的模型（请参阅我对[这个问题](https://stackoverflow.com/questions/703159/asp-net-mvc-number-of-controllers/703276#703276)的回答）。一般来说，我认为您应该考虑为您的模型处理输入的控制器，即对我的模型执行某些操作，然后返回与该操作对应的视图（UI）。UI 的元素可以但不一定必须反映模型层次结构。例如SO 中的`Questions`、`Unanswered`和`Ask a Question`，似乎都与问题模型有关，但它们都是顶级界面元素。 `Unanswered`似乎也有它自己的控制器，但很容易被实现为 .../questions/unanswered 而不是 .../unanswered。

# mobile - 在诺基亚上添加 NAPDEF

> ID：709750
> 
> 赞同：0
> 
> 时间：2009-04-02T13:37:23.433
> 
> 标签：mobile, oma, oma-dm

我正在尝试在诺基亚 S60 设备上添加一个新的接入点，但我对如何做有点困惑。根据[规范](http://www.forum.nokia.com/info/sw.nokia.com/id/b5a43a09-2d4b-4ea9-ad76-ecee12913ac7/OMA_DM_Management_Object_for_Connectivity_Settings_v1_1_en.pdf.html)，应在以下根目录添加节点：

```
./AP/<X> 
```

每当我尝试添加一个节点时，我都会得到一个状态码 404，这意味着它无法找到。如果我尝试创建一个已经存在的 AP，我会得到一个状态代码 418 - 它已经存在。

生成的 xml 如下所示：

```
<Add>
  <CmdID>17</CmdID>
  <Item>
    <Target>
      <LocURI>./AP/testAP</LocURI>
    </Target>
    <Meta>
      <Format>node</Format>
      <Type>syncml:metinf</Type>
    </Meta>
  </Item>
</Add> 
```

使用 funambol 我还查询了整个 ./AP 树，并且已经存在很多访问点，所有访问点的名称都类似于 APId00X。

我尝试在 APId00X 表格上为我的 AP 使用其他名称，但也没有运气。

有谁知道在 S60 设备上创建 AP 需要什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-04T13:08:49.173

这不完全是您问题的答案，但如果您找不到使用 OMA-DM 成功完成此操作的方法，您可能希望在设备上运行一些 Symbian C++ 代码来添加接入点。

如果效果更好，您仍然可以通过使用 OMA-DM 安装包含您的代码、运行并卸载它的 .sis 文件来解决该问题。

这很丑陋，但诺基亚在发布手机之前实际测试每个步骤的可能性更高。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-14T06:29:31.067

在诺基亚论坛的帖子中得到了答案。

> [尝试使用命令 ./AP/ 添加接入点时，如果缺少某些必需节点，它将失败并出现错误 404。](http://wiki.forum.nokia.com/index.php/TSS000699_-_Adding_access_points_via_device_management)

因此，在添加 AP 时，只要您记得添加所有必填字段，它就可以正常工作。我不确定哪些是必填字段。我已经成功创建了一个没有 Bearer 的 AP，但我没有对此进行过实验。

# java - 从命令行构建 RAD7 项目

> ID：709770
> 
> 赞同：3
> 
> 时间：2009-04-02T13:42:41.720
> 
> 标签：java, eclipse, maven-2, ant, build-process

我们在 RAD7 IDE 中设置了带有编译依赖项的现有项目。是否可以从现有项目结构创建自动构建脚本？我们有 IBM 门户项目以及常规的 WEB 和企业项目。

Maven 和 Ant 是可能的解决方案，但我们可以使用这些工具从命令行构建现有项目而不使用 IDE 本身吗？

也可以从命令行或 API 调用 RAD\eclipse 核心编译吗？

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-02T13:50:03.200

您需要研究“无头模式”。这基本上是在没有 IDE 出现的情况下运行 IDE 来执行其工作。

我没有任何直接经验，但我们实验室的一个团队在无头模式下使用 RAD 来自动构建 Eclipse/System-z 界面。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-02T20:26:21.453

[基于Build Eclipse Java Project from Command Line](https://stackoverflow.com/questions/206473/build-eclipse-java-project-from-command-line)中的答案。您可以执行以下操作

```
"%RAD_INSTALL%\jdk\jre\bin\java.exe" -Dwtp.autotest.noninteractive=true -cp "%RAD_INSTALL%\startup.jar" org.eclipse.core.launcher.Main  -application org.eclipse.jdt.apt.core.aptBuild  -data "%WORKSPACE%" 
```

您将变量配置`%RAD_INSTALL%`到您的 RAD 实例和`%WORKSPACE%`包含您要构建的项目的工作区的位置。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-02T14:09:19.643

[您可以在Rational Application Developer V7 Programming Guide](http://www.redbooks.ibm.com/abstracts/sg247501.html) Rebook的第 23 章中找到关于无头 Ant 构建的信息。[IBM Rational Application Developer Version 7.0.0.x 信息中心](http://publib.boulder.ibm.com/infocenter/radhelp/v7r0m0/index.jsp)有更多文档（您也应该能够在帮助中找到）。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-02T19:37:30.143

已经有许多项目使用 Tycho 使用 Maven 构建 Eclipse 组件：

这里有一个有点过时的 Tycho 教程：http: [//www.sonatype.com/people/2008/11/building-eclipse-plugins-with-maven-tycho/](http://www.sonatype.com/people/2008/11/building-eclipse-plugins-with-maven-tycho/)

有关 Tycho 开发工作的更多信息：http: [//www.sonatype.com/people/2009/03/the-future-of-maven-osgi-join-the-tycho-users-mailing-list/](http://www.sonatype.com/people/2009/03/the-future-of-maven-osgi-join-the-tycho-users-mailing-list/)

# sql - 我可以将 SQL Server 排序顺序存储在变量中吗？

> ID：709775
> 
> 赞同：4
> 
> 时间：2009-04-02T13:44:22.433
> 
> 标签：sql, sql-server

我在存储过程中有以下 SQL。有没有办法删除 IF 语句并将 'ASC'/'DESC' 选项作为变量传递？

我知道我可以通过多种不同的方式进行查询，或者返回一个表并在外部对其进行排序等。我只想知道我是否可以避免重复 CASE 语句。

```
IF @sortOrder = 'Desc'
  BEGIN
    SELECT * FROM #t_results
    ORDER BY
    CASE WHEN @OrderBy = 'surname'           THEN surname END DESC,
    CASE WHEN @OrderBy = 'forename'          THEN forename END DESC,
    CASE WHEN @OrderBy = 'fullName'          THEN fullName END DESC,
    CASE WHEN @OrderBy = 'userId'            THEN userId END DESC,
    CASE WHEN @OrderBy = 'MobileNumber'      THEN MSISDN END DESC,
    CASE WHEN @OrderBy = 'DeviceStatus'      THEN DeviceStatus END DESC,
    CASE WHEN @OrderBy = 'LastPosition'      THEN LastPosition END DESC,
    CASE WHEN @OrderBy = 'LastAlert'         THEN LastAlert END DESC,
    CASE WHEN @OrderBy = 'LastCommunication' THEN LastCommunication END DESC,
    CASE WHEN @OrderBy = 'LastPreAlert'      THEN LastPreAlert END DESC 
    END
 ELSE
   BEGIN
    SELECT * FROM #t_results
    ORDER BY
    CASE WHEN @OrderBy = 'surname'           THEN surname END DESC,
    CASE WHEN @OrderBy = 'forename'          THEN forename END DESC,
    CASE WHEN @OrderBy = 'fullName'          THEN fullName END DESC,
    CASE WHEN @OrderBy = 'userId'            THEN userId END DESC,
    CASE WHEN @OrderBy = 'MobileNumber'      THEN MSISDN END DESC,
    CASE WHEN @OrderBy = 'DeviceStatus'      THEN DeviceStatus END DESC,
    CASE WHEN @OrderBy = 'LastPosition'      THEN LastPosition END DESC,
    CASE WHEN @OrderBy = 'LastAlert'         THEN LastAlert END DESC,
    CASE WHEN @OrderBy = 'LastCommunication' THEN LastCommunication END DESC,
    CASE WHEN @OrderBy = 'LastPreAlert'      THEN LastPreAlert END DESC 
    END
END 
```

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-04-02T14:13:37.620

传入@OrderBy int，其中正数为ASC，负数为DESC，实际数字为要排序的列：

```
SELECT
    dt.yourColumn1
        ,dt.yourColumn2
        ,dt.yourColumn3
        ,CASE 
            WHEN @OrderBy>0 THEN dt.SortBy
            ELSE NULL
         END AS SortByAsc
        ,CASE 
            WHEN @OrderBy<0 THEN dt.SortBy
            ELSE NULL
         END AS SortByDesc
    FROM (SELECT
              yourColumn1
                  ,yourColumn2
                  ,yourColumn3
                  ,CASE
                      WHEN ABS(@OrderBy) = 1 THEN surname
                      WHEN ABS(@OrderBy) = 2 THEN forename
                      WHEN ABS(@OrderBy) = 3 THEN fullName
                      WHEN ABS(@OrderBy) = 4 THEN CONVERT(varchar(10),userId)
                      WHEN ABS(@OrderBy) = 5 THEN CONVERT(varchar(10),MobileNumber
                      WHEN ABS(@OrderBy) = 6 THEN DeviceStatus
                      WHEN ABS(@OrderBy) = 7 THEN LastPosition
                      WHEN ABS(@OrderBy) = 8 THEN CONVERT(varchar(23),LastAlert,121)
                      WHEN ABS(@OrderBy) = 9 THEN CONVERT(varchar(23),LastCommunication,121)
                      WHEN ABS(@OrderBy) =10 THEN CONVERT(varchar(23),LastPreAlert,121)
                      ELSE NULL
                  END AS SortBy
              FROM YourTablesHere
              WHERE X=Y
         ) dt
    ORDER BY SortByAsc ASC, SortByDesc DESC 
```

只要确保你构建了一个正确排序的字符串。请注意，我使用 'YYYY-MM-DD hh:mm:ss.mmm' 作为日期并将数字放入字符串中。我们通常将多个列放在一起，因此如果您按姓氏排序，也会使用名字等。请注意，如果您确实合并了多个列，则需要用零或空格填充。

如果您不希望 SortByAsc 和 SortByDesc 列出现在结果集中，请将整个事物包装在派生表中。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-04-02T14:16:33.463

你可以在没有动态 SQL 的情况下做到这一点......

```
SELECT
     *
FROM
     My_Table
WHERE
     Whatever = @something
ORDER BY
     CASE @sort_order
          WHEN 'ASC' THEN
               CASE @order_by
                    WHEN 'surname' THEN surname
                    WHEN 'forename' THEN forename
                    WHEN 'fullname' THEN fullname
                    ELSE surname
               END
          ELSE '1'
     END ASC,
     CASE @sort_order
          WHEN 'DESC' THEN
               CASE @order_by
                    WHEN 'surname' THEN surname
                    WHEN 'forename' THEN forename
                    WHEN 'fullname' THEN fullname
                    ELSE surname
               END
          ELSE '1'
     END DESC 
```

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-04-02T13:46:35.923

是的，但您必须使用*动态查询*。

看看[这里](http://www.mssqltips.com/tip.asp?tip=1160)。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2014-10-21T19:44:28.877

这个怎么样：

```
CASE WHEN @order_by = @order_by  THEN @order_by END 
```

那么没有理由有多个案例。

# c# - WPF 和 Silverlight 命令实现对于 MV-VM (MVP) 模式是否无用？

> ID：709776
> 
> 赞同：2
> 
> 时间：2009-04-02T13:44:47.473
> 
> 标签：c#, wpf, silverlight, design-patterns, mvp

请原谅我的无知，我最近才开始在 Silverlight 中编码。

我尝试在 Silverlight 中实现命令模式并碰壁。他们说命令很棒，因为您可以将它们写入 xaml，因此您可以保持代码隐藏干净，而且您的视图和视图模型之间存在松散耦合，因为视图中没有对视图模型的直接引用。

**您不能保持代码隐藏干净**，因为您只能将一个命令绑定到控件，并且您必须决定在绑定时哪个事件将触发您的命令。如果一个控件有 30 个事件，你必须选择一个来指挥。其他 29 个将从后面的代码执行来自事件处理程序的其他命令。

**松散耦合可以通过依赖注入更简单地实现**，命令添加了一个无用的间接层，没有提供任何额外的东西，它们只会使维护代码变得更加困难。当您针对接口进行编程并准确查看调用了什么方法时，维护代码会更容易，然后当您必须在命令定义和视图模型之间不断跳转时。

我是否遗漏了什么，或者命令真的不适合用于视图和视图模型交互？

请看下面的问题。这就是为什么我没有得到所有命令的炒作：

[我应该如何在 Silverlight 中使用 MVVM 处理每个带有命令模式的控件的多个事件？](https://stackoverflow.com/questions/567672/how-should-i-handle-multiple-events-per-control-w-command-pattern-using-mvvm-in-s)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-03T04:55:00.350

看看 Prism ( [http://prism.codeplex.com](http://prism.codeplex.com) ) 和他们的 DelegateCommand<> 基础设施。它是 Silverlight 和 WPF 在 ViewModel（或 Presenter）中创建命令并直接绑定到它的一个很好的解决方案。同样在 Silverlight 3 中，行为可以为您提供一些相同的基于 XAML 的语法。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-02T18:02:42.947

SL 2.0 没有 WPF 强大，您必须在后面编写一些代码:-(。

不确定你是否读过这篇关于 MVVM 和 SL 的文章，讨论了 SL 的命令限制：

[http://msdn.microsoft.com/en-us/magazine/dd458800.aspx](http://msdn.microsoft.com/en-us/magazine/dd458800.aspx)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-02T13:53:07.530

我相信你可以用附加的行为模式来欺骗你的事件处理程序。请参阅以下网址了解更多信息：

[http://www.codeproject.com/KB/WPF/AttachedBehaviors.aspx](http://www.codeproject.com/KB/WPF/AttachedBehaviors.aspx)

# c++ - 如何知道 C++ 中所有者对象的地址？

> ID：709790
> 
> 赞同：7
> 
> 时间：2009-04-02T13:47:53.830
> 
> 标签：c++, templates, notifications, one-to-many

我想在 C++ 中创建一个 Notifier 类，我将在其他对象中使用它来在对象被销毁时通知各种持有者。

```
template <class Owner>
class Notifier<Owner> {
public:
  Notifier(Owner* owner);
  ~Notifier(); // Notifies the owner that an object is destroyed
};

class Owner;

class Owned {
public:
  Owned(Owner* owner);
private:
  Notifier<Owner> _notifier;
}; 
```

我的观点是，由于我有一个密集而复杂的对象图，我想避免将拥有对象的地址存储在通知程序中。有没有办法更改我的通知程序类，以便它可以从自己的地址和在编译时计算的偏移量推断出拥有对象的地址？

另请注意，任何对象都可能必须通知多个“所有者”，可能来自同一类。

谢谢。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-04-02T13:54:53.330

看看[GoF 观察者设计模式](http://www.vincehuston.org/dp/observer.html)。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-02T14:40:16.293

这将是一个**令人讨厌的**hack，并且可能无法保证有效，但这里有一个想法**，我不推荐这样做**。

假设您的布局像您这样描述：

```
template <class Owner>
class Notifier<Owner> {
public:
  Notifier(Owner* owner);
  ~Notifier(); // Notifies the owner that an object is destroyed
};

class Owner;

class Owned {
public:
  Owned(Owner* owner);
private:
  Notifier<Owner> _notifier;
}; 
```

如果`_notifier`知道它的名字，它可以`Owned`像这样计算 ' 的地址（在`Notifier`' 的构造函数中执行）：

```
Owned *p = reinterpret_cast<Owned *>(reinterpret_cast<char *>(this) - offsetof(Owned, _notifier)); 
```

基本上，假设是 _notifier 在 Owned 类中的某个固定偏移量。因此，Owned 的地址等于`_notifier`'s 地址减去相同的偏移量。

再一次，这是我不推荐的未定义行为，但可能会起作用。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-04-02T15:35:48.807

[fa. 的回答](https://stackoverflow.com/questions/709790/how-can-i-know-the-address-of-owner-object-in-c/709996#709996)是一个好的开始。但是，它并不能解决拥有多个相同类型所有者的问题。一种解决方案是让通知程序存储所有者列表而不是单个所有者。这是一个快速实现，以展示这个想法：

```
template <typename Owner, typename Owned>
class Notifier
{
  protected:
    Notifier()
    {}

    // Constructor taking a single owner
    Notifier(Owner & o) 
    { 
        owners.push_back(&o); 
    }

    // Constructor taking a range of owners
    template <typename InputIterator>
    Notifier(InputIterator firstOwner, InputIterator lastOwner)
        : owners(firstOwner, lastOwner) {}

    ~Notifier()
    {
        OwnerList::const_iterator it = owners.begin();
        OwnerList::const_iterator end = owners.end();
        for ( ; it != end ; ++it)
        {
            (*it)->notify(static_cast<Owned*>(this));
        }
    }

    // Method for adding a new owner
    void addOwner(Owner & o) 
    { 
        owners.push_back(&o); 
    }

private:
    typedef std::vector<Owner *> OwnerList;
    OwnerList owners;
}; 
```

你可以这样使用它：

```
class Owner;

class Owned : public Notifier<Owner, Owned>
{
    typedef Notifier<Owner, Owned> base;

    //Some possible constructors:
    Owned(Owner & o) : base(o) { }

    Owned(Owner & o1, Owner & o2)
    {
        base::addOwner(o1); //qualified call of base::addOwner
        base::addOwner(o2); //in case there are other bases
    }

    Owned(std::list<Owner*> lo) : base(lo.begin(), lo.end()) { }
}; 
```

如果您有许多不同类型的所有者，则此解决方案可能会变得相当难以使​​用。在这种情况下，您可能需要查看 boost 元编程库（[MPL](http://www.boost.org/doc/libs/1_38_0/libs/mpl/doc/index.html)、[Fusion](http://spirit.sourceforge.net/dl_more/fusion_v2/libs/fusion/doc/html/index.html)），您最终可以得到一个代码，让您可以执行以下操作：

```
class Owned : public Notifier<Owned, OwnerType1, OwnerType1, OwnerType2>
{
    Owned(OwnerType1 & o1, OwnerType1 & o2, OwnerType2 & o3) 
        : base(o1,o2,o3)
}; 
```

但是，实施此解决方案将比以前的解决方案长一点。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-04-02T14:44:29.653

或类似的东西：

从您的通知程序继承并添加 Owned 作为模板参数。然后您可以在通知程序中拥有一个可用的方法：

```
template < class Owner , class Owned >
class Notifier
{
public:
    Notifier(Owner* owner)
    {}

    Owned * owned()
    { return static_cast< Owned * >( this ); }

    ~Notifier()
    {
        // notify owner with owned()
    }
};

class Owner
{};

class Owned : public Notifier< Owner , Owned >
{
public:
    Owned( Owner * owner ) : Notifier< Owner , Owned >( owner )
    {}
}; 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-04-02T13:48:12.470

部分解决方案是让 Owned 从 Notifier 继承。这样，被破坏对象的地址就是'this'......

```
class Owned : public Notifier<Owner> {
public:
  Owned(Owner* owner) 
    : Notifier<Owner>(owner)
  {}
}; 
```

但是如何处理来自同一类的多个“所有者”？一个人怎么能从“同一类”继承多次？

感谢[fa的回答](https://stackoverflow.com/questions/709790/how-can-i-know-the-address-of-owner-object-in-c/709996#709996)，这是我正在寻找的解决方案：

```
#include <iostream>

template <class Owner, class Owned, int = 0>
class Notifier {
public:
  Notifier(Owner* owner)
    : _owner(owner)
  {}
  ~Notifier() {
    _owner->remove(owned());
  }
  Owned * owned(){ 
    return static_cast< Owned * >( this ); 
  }

private:
  Owner* _owner;
};

class Owner {
public:
  void remove(void* any) {
    std::cout << any << std::endl;
  }
};

class Owned : public Notifier<Owner,Owned,1>, Notifier<Owner,Owned,2> {
public:
  Owned(Owner* owner1, Owner* owner2)
    : Notifier<Owner,Owned,1>(owner1)
    , Notifier<Owner,Owned,2>(owner2)
  {}
};

int main() {
  std::cout << sizeof(Owned) << std::endl;
  Owner owner1;
  Owner owner2;
  Owned owned(&owner1, &owner2);
  std::cout << "Owned:" << (void*)&owned << std::endl << std::endl;
} 
```

谢谢！

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-04-02T13:57:50.483

我对此表示高度怀疑。Notifier 无法知道它已在组合中使用。如果我这样做怎么办

```
class Foo
{
private:
  Notifier _a, _b, _c;
} 
```

虽然我很想被证明是错误的，但我真的怀疑如果没有明确地向通知者提供更多信息是可行的。

# bash - 如何像在 bash 中一样运行两个进程？

> ID：709793
> 
> 赞同：4
> 
> 时间：2009-04-02T13:48:34.170
> 
> 标签：bash, shell, process, scripting

我有两个命令 foo 和 bar。

foo 在没有 stdin 或 stdout/stderr 活动的情况下运行很长时间。bar 是 foo 的客户端，使用 stdout/stderr 运行，但没有 stdin 活动。

我想从一个 shell 运行它们，能够用 ctrl-c 杀死它们，并在 bar 发生时查看它的输出。

即类似这个序列的东西

foo & bar 杀 -9

但不必手动执行杀戮 - 相反它只发生在 ctrl-c

有没有办法编写这个脚本？

谢谢

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-04-02T14:17:34.337

不要使用`kill -9`.

你想上钩`EXIT`，而不是上钩`INT`。

```
trap 'kill $fooPid $barPid' EXIT
foo & fooPid=$!
bar & barPid=$!
wait 
```

该解决方案将始终确保终止`foo`and `bar`，无论它退出的原因是什么（不包括它被`SIGKILL`'ed ）。

如果您想避免保留 PID（存在一些竞争条件问题），您可以这样做：

```
trap 'kill $(jobs -p)' EXIT
foo &
bar &
wait 
```

如果您的脚本没有其他工作，这是一个更好（更清洁！）的解决方案。

**Ps**：这些解决方案意味着`foo`并且`bar`可以写入您的终端（您的脚本`stdout`），但都不能从`stdin`. 如果您需要`foo`或`bar`从标准输入读取，则解决方案会变得*更加*复杂。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-02T13:54:01.443

您可以设置一个 bash 脚本来运行程序并用于`trap`捕获 CTRL-C。然后，在 trap 调用的函数中，直接杀死程序。

自从我这样做以来已经有一段时间了，但我认为以下内容说明了这一点。

```
#!/bin/bash
xx() {
    kill -9 $pid1
    kill -9 $pid2
    echo bye
}
trap 'xx' SIGINT
sleep 1000 &
pid1=$!
sleep 2000 &
pid2=$!
sleep 3600 
```

只需运行此脚本并 CTRL-C 即可，您会发现它会杀死两个睡眠进程。

# c++ - 在 Windows 中调试堆栈溢出？

> ID：709795
> 
> 赞同：5
> 
> 时间：2009-04-02T13:50:11.577
> 
> 标签：c++, windows, debugging, stack-overflow

所以我试图调试这个奇怪的问题，一个进程在没有调用一些析构函数的情况下结束......

在 VS (2005) 调试器中，当我看到以下内容时，我点击了“Break all”并查看了神秘消失进程的线程的调用堆栈：

[闻起来像 SO http://img6.imageshack.us/img6/7628/95434880.jpg](http://img6.imageshack.us/img6/7628/95434880.jpg)

这绝对看起来像一个正在制作的 SO，这可以解释为什么这个过程会在没有先打包手提箱的情况下运行到它快乐的地方。

问题是，VS 调试器的调用堆栈只显示您在图像中看到的内容。

所以我的问题是：我怎样才能找到无限递归调用的开始位置？

[我在某处](https://stackoverflow.com/questions/81202/segfault-on-stack-overflow "某处")读到，在 Linux 中，您可以将回调附加到 SIGSEGV 处理程序并获取有关正在发生的事情的更多信息。

Windows上有类似的东西吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-02T15:42:23.423

**要控制 Windows 在访问冲突**（`SIGSEGV`-equivalent）的情况下做什么，请调用 [`SetErrorMode`](http://msdn.microsoft.com/en-us/library/ms680621(VS.85).aspx)（传递参数 0 以在出现错误时强制弹出窗口，允许您使用调试器附加到它。）

但是，根据您已经获得的堆栈跟踪，**在故障时附加调试器可能不会产生任何附加信息**。您的堆栈已损坏，或者递归深度已超过 VS 可显示的最大帧数。在后一种情况下，**您可能希望*减小*进程的默认堆栈大小**（使用`/F`项目属性中的开关或等效选项）以使问题更快地显现出来，并确保 VS*将*显示所有帧。或者，您可能希望在 std::basic_filebuf<>::flush() 中放置一个断点并遍历它直到破坏阶段（或禁用它直到破坏阶段之前。）

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-02T16:02:58.337

好吧，您知道问题出在哪个线程上——这可能是一个简单的问题，从一开始就跟踪它，看看它从哪里进入杂草。

另一种选择是使用[Debugging Tools for Windows](http://www.microsoft.com/whdc/devtools/debugging/default.mspx)包中的一个调试器 - 它们可能比 VS 调试器显示更多（也许），即使它们通常更复杂且难以使用（实际上可能是因为那个） .

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-02T14:33:45.327

乍一看确实像无限递归，您可以尝试在终止进程的行之前放置一个断点。它可以到达那里吗？如果是这样，你有两种相当简单的方法可以走。

要么你向前一步，看看哪些析构函数被调用，什么时候被赶上。或者您可以在每个相关的对象析构函数中放置一个 printf/OutputDebugString（只有全局对象才需要这个）。如果消息是析构函数做的第一件事，那么你看到的最后一条消息来自析构函数，它把事情挂了。

另一方面，如果它没有到达我最初提到的那个断点，那么可以做类似的事情，但这会更烦人，因为程序仍在“做事”。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-02T14:04:24.447

我不排除在 Windows 中有这样的处理程序，但我从未听说过。

我认为您显示的回溯可能是虚假的。如果您在某种损坏已经发生后闯入该过程，那么回溯不一定有效。但是，如果幸运的话，堆栈跟踪的底部仍然有一些关于正在发生的事情的线索。

尝试将`Sleep()`调用放入源中可能涉及递归的选定函数中。这应该让您有更好的机会在堆栈完全溢出之前进入进程。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-03T23:27:23.187

我同意丹·布雷斯劳的观点。你的堆栈是假的。不过，可能只是因为您没有正确的符号。如果一个程序在没有启动 WER 处理的情况下就消失了，这通常是内存不足的情况。你去调查过这种可能性吗？

# scripting - 为 Telnet 会话创建脚本？

> ID：709801
> 
> 赞同：42
> 
> 时间：2009-04-02T13:52:08.780
> 
> 标签：scripting, telnet

有谁知道创建可以连接到远程登录服务器的脚本的简单方法，执行一些常用的远程登录操作，然后注销？我正在与不熟悉 telnet 以及他们需要运行的命令的用户打交道。我想要的只是让他们双击一个脚本，并让该脚本自动为他们执行命令。

您可能想知道，“用户在哪个平台上？” 它们将在 Windows 和 Linux 上运行。Perl、Java 或 Python 等语言的实现是可以接受的。我看到 Perl 有一个 Net:: Telnet 模块。有人用过吗？

我理想的解决方案是创建两个脚本文件。Windows 的 BAT 文件和 Linux 的 shell 脚本。虽然这会使双重维护成为问题，但这意味着我不必在每台机器上安装 Perl/Java/Python/etc...。不幸的是，我还没有看到任何使用批处理文件或 shell 脚本自动执行 telnet 会话的方法。

谢谢。

* * *

## 回答 #1

> 赞同：40
> 
> 时间：2009-04-02T14:04:12.807

我使用了多种方法在 unix 下编写 telnet 会话脚本，但最简单的方法可能是一系列 echo 和 sleep 命令，它们的输出通过管道传输到 telnet。也可以将输出通过管道传输到另一个命令中。

愚蠢的例子

```
（回显密码；回显“显示IP路由”；睡眠1；回显“退出”）| 远程登录我的路由器

```

这（基本上）检索 Cisco 路由器的路由表。

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2009-04-02T14:02:31.703

[Expect](http://expect.nist.gov/)就是为此而构建的，它可以处理输入/输出以及超时等。请注意，如果您不是 TCL 粉丝，可以使用 Perl/Python/Java 的 Expect 模块。

编辑：上面的页面表明[Wikipedia Expect](http://en.wikipedia.org/wiki/Expect)条目是一个有用的资源:-)

* * *

## 回答 #3

> 赞同：12
> 
> 时间：2009-04-02T14:39:00.570

另一种方法是使用与 vatine 显示相同格式的 netcat（或 nc，取决于哪个 posix），或者您可以创建一个文本文件，在其自己的行中包含每个命令。

我发现一些 posix' telnet 不能正确处理重定向（这就是我建议使用 netcat 的原因）

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2012-02-28T14:52:30.037

此 vbs 脚本重新加载 cisco 交换机，确保在 windows 上安装了 telnet。

```
Option explicit
Dim oShell
set oShell= Wscript.CreateObject("WScript.Shell")
oShell.Run "telnet"
WScript.Sleep 1000
oShell.Sendkeys "open 172.25.15.9~"
WScript.Sleep 1000
oShell.Sendkeys "password~"
WScript.Sleep 1000
oShell.Sendkeys "en~"
WScript.Sleep 1000
oShell.Sendkeys "password~"
WScript.Sleep 1000
oShell.Sendkeys "reload~"
WScript.Sleep 1000
oShell.Sendkeys "~"
Wscript.Quit 
```

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2011-08-23T21:59:02.937

检查[SendCommand 工具](https://sourceforge.net/projects/sendcommand/)。

您可以按如下方式使用它：

```
perl sendcommand.pl -i login.txt -t cisco -c "show ip route" 
```

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2011-09-16T00:14:24.483

这听起来可能不是一个好主意，但我使用 java 并使用简单的 TCP/IP 套接字编程来连接到 telnet 服务器并交换通信。如果您知道实现的协议，它会完美运行。对于 SSH 等，除非您知道如何进行握手等，否则可能会很困难，但简单的 telnet 就像一种享受。

我尝试的另一种方法是在 java System.exec() 等中使用外部进程，然后让内置在 telnet 中的 Windows 为您完成这项工作，您只需向本地系统进程发送和接收数据。

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2014-02-19T06:55:09.780

```
import telnetlib

user = "admin"
password = "\r"

def connect(A):
    tnA = telnetlib.Telnet(A)
    tnA.read_until('username: ', 3)
    tnA.write(user + '\n')
    tnA.read_until('password: ', 3)
    tnA.write(password + '\n')
    return tnA
def quit_telnet(tn)
    tn.write("bye\n")
    tn.write("quit\n") 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-04-02T15:10:33.523

几个问题：

1.  你能把东西放在你正在远程登录的设备上吗？
2.  脚本执行的命令是相同的还是因机器/用户而异？
3.  您是否希望单击该图标的人必须提供用户 ID 和/或密码？

也就是说，我不久前写了一些 Java 来与几个启用 IP 的电源板 (BayTech RPC3) 交谈，这些电源板可能对您有用。如果您有兴趣，我会看看我是否可以将其挖掘并发布在某个地方。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2013-03-28T20:30:27.107

我喜欢 Active State 使用 python 给出的示例。这是完整的[链接](http://code.activestate.com/recipes/498210-automate-performance-monitoring-via-telnet-and-ftp/)。我从链接中添加了部分简单日志，但您可以了解您可以做什么。

```
import telnetlib

prdLogBox='142.178.1.3'
uid = 'uid'
pwd = 'yourpassword'

tn = telnetlib.Telnet(prdLogBox)
tn.read_until("login: ")
tn.write(uid + "\n")
tn.read_until("Password:")
tn.write(pwd + "\n")
tn.write("exit\n")
tn.close() 
```

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2017-07-20T15:43:09.590

Bash shell 支持这种开箱即用的方式，例如

```
exec {stream}<>/dev/tcp/example.com/80
printf "GET / HTTP/1.1\nHost: example.com\nConnection: close\n\n" >&${stream}
cat <&${stream} 
```

要过滤并仅显示一些行，请运行：`grep Example <&${stream}`。

* * *

## 回答 #11

> 赞同：-2
> 
> 时间：2012-09-14T13:08:47.450

将 telnet 会话写入 BAT Dos 文件并执行。

# sql-server - 使用 SQL Server Integration Services（2005 或 2008）从 .gdb 文件访问数据

> ID：709806
> 
> 赞同：0
> 
> 时间：2009-04-02T13:53:00.650
> 
> 标签：sql-server, ssis, interbase

我有许多 .gdb 格式的文件，我认为这些文件与 Borland interbase 有关。有谁知道我将如何从使用 SSIS（2005 或 2008）中提取数据？

非常感谢任何帮助。

埃德。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-04T11:35:29.913

最简单的解决方案可能是为 Borland Interbase 文件找到 ODBC 或 OLEDB 驱动程序，将其连接到您的文件，然后将其用作 SSIS 中的数据源。

Borland Interbase 似乎有几个 ODBC 驱动程序。[这个](http://www.brothersoft.com/xtg-systems-interbase-odbc-driver-571.html)是免费的。[这个](http://www.easysoft.com/products/data_access/odbc_interbase_driver/)不是。

可以在[此处](http://www.ibprovider.com/eng/)找到 OLEDB 驱动程序（不是免费的，尽管有免费试用版） 。

# hardware - 谁能推荐一个学习VHDL的好资源？

> ID：709811
> 
> 赞同：13
> 
> 时间：2009-04-02T13:53:58.697
> 
> 标签：hardware, vhdl

谁能推荐一本学习VHDL的好书？或者失败了，有什么好的资源吗？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-05-05T09:04:32.220

VHDL 的不幸问题是，那里有大量过时、风格不佳和完全错误的资源。电子版和印刷版。

掌握 VHDL 的部分技巧是知道如何过滤掉这些。以下是我前世作为硬件设计师所做的过滤。我希望它对你有帮助。

这些是您想要阅读、拥有或下载的内容：

*   书：Peter J. Ashenden 的“VHDL 设计者指南”（ISBN 1-55860-270-4）。告诉您使用过时的或供应商特定的库不会浪费您的时间；假设您是想了解 HDL 的软件工程师，它不会解释 VHDL；它没有通过假设您是想了解 HDL 的硬件工程师来解释 VHDL。它不提倡供应商及其解决方案（使用特定供应商工具链是一个单独的问题，我发现继续学习 VHDL 和特定于供应商的单独学习很有帮助）。它所做的是从正确的角度引入 VHDL：作为一种用于描述*离散事件系统*的语言，智能程序可以从中提取最终可能成为硬件的东西。它还描述了*标准*语言结构是，存在哪些语言标准，以及它们的具体属性是什么。现代工具越来越符合标准，因此这些信息比其他一些书籍（保持匿名）似乎声称的一堆类比更有用。买吧，一分钱一分货。

*   新闻组 comp.lang.vhdl 居住着对现代 VHDL 非常了解的人，如果您能很好地提出问题，他们可以给您明智的建议。为了能够做到后者，请阅读上面提到的书。浏览众多 VHDL 论坛通常是在浪费时间，因为那里的信息内容通常淹没在噪音中。

*   了解你的工具。获取您将使用的工具链的 PDF 文件，并且非常了解它。越多越好。尤其知道它们的局限性。工具通常具有您需要解决或玩弄的特质，才能使事情变得恰到好处。例如，您可能想要编写可移植的行为代码；除了特定于技术的部分，或者您的工具碰巧合成错误的部分。

*   知道在哪里可以找到合理的 VHDL 资源。理智资源的一个例子是汉堡 VHDL 档案（位于：[http](http://tams-www.informatik.uni-hamburg.de/research/vlsi/vhdl/) ://tams-www.informatik.uni-hamburg.de/research/vlsi/vhdl/ ），我通过使用信号到-的采样方法发现该特定网站上的噪声比相当高。用它。

*   Giovanni de Micheli 的“数字电路的合成和优化”（[http://si2.epfl.ch/~demichel/publications/mcgraw/ index.html](http://si2.epfl.ch/~demichel/publications/mcgraw/index.html)），这可能会为硬件合成方法提供一些启示——尽管已经完成了大量工作来改进那里给出的结果。您可能想从附近的图书馆借这个并翻阅它。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-02T13:59:31.383

一本很棒的教科书是：[VHDL 设计的数字逻辑基础](http://highered.mcgraw-hill.com/sites/0072460857/)

我记得从[这个](http://www.asic.uwaterloo.ca/tutorials)开始以获得快速概述。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-04-12T23:48:32.707

我喜欢Volnei A. Pedroni的名为“[使用 VHDL 的电路设计”的书。](https://rads.stackoverflow.com/amzn/click/com/0262162245)它专注于可综合的 VHDL，这是您为真正的芯片编写代码所需要的，而不仅仅是用于仿真。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2010-03-02T05:35:16.003

我在学习 VHDL 时发现[低碳水化合物 VHDL 教程](http://www.freerangefactory.org/site/pmwiki.php/Main/Books)非常棒。[自从 Low-Carb VHDL Tutorial 的作者将其变成了一本名为Free Range VHDL](http://www.freerangefactory.org/site/pmwiki.php/Main/Books)的开源书籍以来，现在更是如此。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-04-27T11:43:14.200

我推荐[Chu, Pong P.: RTL Hardware design using VHDL。约翰威利父子公司，2006 年](https://rads.stackoverflow.com/amzn/click/com/0471720925)。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-04-02T13:57:46.020

[这](https://rads.stackoverflow.com/amzn/click/com/013519802X)是我用于系统架构课的书。这很简单。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-04-13T00:49:14.683

在学习任何类型的 HDL（Verilog、VHDL...）时，记住*一*件事很重要。这**不是**软件编程，事情是并行工作的。话虽如此，我发现学习任何 HDL 的最佳方法是学习如何在硬件中思考和描述硬件（这就是为什么它被称为硬件描述语言）。

到目前为止，我很少看到向您展示如何将 HDL 转换为硬件的书籍。我在 Synopsys 时读过一本（页面上写满了代码和原理图），但它是一份内部出版物。然而，即使没有这本书，你仍然可以看到你的代码是如何通过在免费软件上综合运行而变成硬件的。

我之所以要强调这一点，是因为有很多方法可以解决一个问题。如果您了解如何将其转换为底层硬件，您将只能从门数和时序的角度编写有效解决该问题的代码。

祝你好运！

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-07-04T06:54:45.997

尽管事情并不总是平行的，但要小心。顺序赋值不同于组合赋值。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-12-03T15:43:44.547

我不确定您的背景或需求是什么，但是David Harris 和 Sarah Harris 的[*Digital Design and Computer Architecture对我来说是一个非常有用的介绍。*](https://rads.stackoverflow.com/amzn/click/com/0123704979)它不是 VHDL 特定的（Verilog 和 VHDL 示例并排呈现）甚至 HDL-heavy - 正如标题所暗示的那样，它更多的是对一般数字设计的介绍。但对我来说，这是一个很好的方法，它展示了代码以及其应用和理论背景的基础。

# c# - C# 数据库应用程序并发

> ID：709823
> 
> 赞同：4
> 
> 时间：2009-04-02T13:56:02.407
> 
> 标签：c#, concurrency

我在 C# 中使用 SQL Server 2005 express 作为后端编写了一个多用户应用程序。

我有一个订单集合。为了使用这个类，您需要实例化它并调用 Load(CustomerCode) 方法，以便使用指定的客户订单填充集合。

**我的问题：**

如何强制执行并发，以便只有 1 个用户可以为特定客户请求 Orders 集合？当用户使用完对象时（当对象设置为 null 时），我需要让它再次可用。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-04-02T14:00:45.903

您需要实现[悲观离线锁定](http://martinfowler.com/eaaCatalog/pessimisticOfflineLock.html)模式。

本质上，您有一个表，您将记录放入其中，代表对其他表中记录的“锁定”。当你想编辑一条记录时，你首先检查锁表中是否有锁，然后在你的域逻辑/UI中做出相应的反应。

它不一定是数据库，它可以是内存缓存。当我在示例中说“表”时，我指的是逻辑表，不一定是数据库表。

> 悲观离线锁通过完全避免冲突来防止冲突。它强制业务事务在开始使用一条数据之前获取它的锁定，因此，大多数情况下，一旦您开始业务事务，您可以非常确定您将完成它而不会被并发反弹控制。

# version-control - 使用 Subversion 和 SharePoint 帮助进行配置管理

> ID：709824
> 
> 赞同：3
> 
> 时间：2009-04-02T13:56:04.857
> 
> 标签：version-control, project-management, projects-and-solutions, lifecycle

好的，一年前被我现在的公司聘用时，我的任务是从 VSS 迁移我们的开发团队。他们已经想到他们想要 Subversion，而且由于我有使用和设置 Subversion 的经验，所以我是一个很好的候选人。我第一次尝试出售 TFS 是因为它本来可以解决我现在遇到的问题，但是由于资金紧张，而且 Subversion 是免费的……好吧，你明白了。无论如何，我已经完成了提案，唯一阻碍的是以下内容。

我建议我们只将源代码存储在 SVN 中，所有文档、发布版本和其他项目工件都存储在我们的 SharePoint 门户中，因此我们不必让非开发人员利益相关者访问 SVN。当我提出提案时，所有的问题都被排除在外，但出现了关于如何管理工件之间的同步的问题（例如：如何将文档 x 版本 3.1.2 与版本 4.5.2 关联）。我最初的反应是在 SharePoint 项目页面中为每个新版本创建一个部分来保存工件（并跟踪更改）。有没有更好的方法来做到这一点？有谁知道有人这样做吗？或者任何将 SVN 与 SharePoint 同步的集成包？

以下是有关公司开发环境的一些信息。我们所有的软件都是供内部使用的，我们不出售任何软件，所以我们的客户都是内部使用的。我们有两种类型的开发人员：1\. 负责维护和定制第三方软件的人，以及 2\. 编写专有软件的人（这是我的落脚点）。我们编写的软件主要是 .NET，但第 3 方软件无处不在（COBAL、C、FORTRAN、其他没人关心的废话）。

请告知，因为我需要尽快提交。我讨厌VSS！！！！！！！！！！我需要解脱！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-02T14:22:04.980

我们内部所做的是将所有文档置于我们的版本控制系统下，我认为这要容易得多。然后，当然，您必须授予非开发人员访问权限。

在你的情况下，使用 SVN，你为什么不把所有东西都放在里面，然后使用 web 界面来访问利益相关者？这对他们来说很容易:-P

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-03T06:41:35.430

我会为文档和源代码使用 SVN。

好处：

*   您可以将文档版本与源代码版本同步。
*   您将所有东西都放在一个地方，因此无需管理两个存储库。

缺点：

*   您可能需要管理某些利益相关者对文件夹结构某些部分的访问权限。
*   SVN 不是最适合文档管理的工具

为了解决对同一文档可能的并发更改，您可以对这些项目使用 SVN 属性 svn:needs-lock，以使其可由锁定项目的一个人编辑。

正如 pablo 所说，您可以通过 Web 界面访问文档（至少用于阅读它们）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-29T12:48:31.187

您可以通过 Web 界面公开 svn repo 并链接到 sharepoint 中的那个。这样，需要编辑文档的人需要访问颠覆，但任何人都可以轻松地“只读”访问文档。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-29T12:57:43.177

在我们的组织中，我们有文档/工件，在 SVN 中编码所有内容，并且可以访问非技术利益相关者以及使用 Tortoise 客户端的人。

但是您可以查看以下选项

*   选项 1：为非技术用户创建一个 ASP.Net 界面

您可以在 ASP.net 中构建一个简单的 Web 界面，使用单个用户对其进行配置，这样您就不必为所有非技术利益相关者创建单独的用户，并且他们可以通过适当的版本控制访问文档等。您可以查看在[sharpsvn](http://sharpsvn.open.collab.net/)用于实施方面。这种方法的缺点是您可能需要花费一些时间来开发这个应用程序

*   选项 2：当然，为每个非开发人员利益相关者创建单独的用户

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-07T14:33:12.350

这个答案对您来说可能为时已晚，但最简单的集成路径可能是将文档存储在 SVN 中，然后使用 svn-hook 发布到 Sharepoint。

构建工件可以以与构建脚本相同的方式以编程方式发布。

您可以使用简单的 POST 将文档上传到 SharePoint

IE

[http://blogs.msdn.com/rohitpuri/archive/2007/04/10/upload-download-file-to-from-wss-document-library-using-dav.aspx](http://blogs.msdn.com/rohitpuri/archive/2007/04/10/upload-download-file-to-from-wss-document-library-using-dav.aspx)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-08-05T14:04:09.223

可能也有点晚了，但是如果您有 SharePoint 系统设置，我会避免将文档放入 SVN 中。尽管 SVN 在源代码方面做得非常出色，但对于文档管理，它并没有提供 SharePoint 的易用性。如果您已经设置了它并且您是主要基于 MS 的网络，那么 SharePoint 很有意义，并且可以比 SVN 更好地处理基于 MS 的文档的修订控制。

是的，您可以使用需求锁定来管理对 SVN 文档的访问，但在某些时候，您可能会有非开发人员需要访问这些文档。向非开发人员、非技术人员解释 SVN 并非易事。

# asp.net - 在 ASP.NET 3.5 中创建拖放应用程序

> ID：709825
> 
> 赞同：1
> 
> 时间：2009-04-02T13:56:08.287
> 
> 标签：asp.net, ajax, drag-and-drop

我需要让客户端能够将图像拖放到 ASP.NET 3.5 Web 应用程序中的类别文件夹中。

我希望存在一个选项，它几乎与 Ajax Control Toolkit 中的 Reorderlist 一样易于使用，而且我不必研究 JQuery 或类似的手工编码。

你有什么建议？

以前也有人问过类似的问题，比如 6 个月前...：[ASP.net AJAX Drag/Drop？](https://stackoverflow.com/questions/13589/asp-net-ajax-drag-drop)推荐使用 MooTools 的地方，但 6 个月在 ASP.NET/Ajax 世界中是很长的时间，所以现在可能存在更好甚至更简单的选择吗？

商业组件也是一种选择 - 无论如何高达 200 美元。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-08T03:22:36.710

我对 Ajax Control Toolkit 中的 Reorder List 的体验与许多其他 3rd 方提供程序一样，是它们中的大多数似乎不值得付出努力。购买前一定要试一试。

不幸的是，那里的许多示例/组件都过于基于客户端，并且似乎总是无法满足实际使用以及您需要与 ASP.Net 应用程序进行交互的类型（例如处理回发）。拖动一个 div 并没有那么复杂，但这就是很多例子所做的。如果您的需求与他们的产品不完全一致，请尝试其他方法。

[Manning](http://www.manning.com/)的书[ASP.NET AJAX in Action](http://www.manning.com/gallo/)是执行拖放代码的很好参考。它使用 Microsoft.Web.Preview，但这很长一段时间没有更新，这令人担忧。我使用 MS 的 PreviewDragDrop 创建了一个非常好的拖放 UI，它确实可以跨浏览器工作，而且它很容易编码。除了预览 DLL，Manning 的书对于理解 Microsoft 的 AJAX API 非常有用。

*但是*，由于 jQuery 将随 Visual Studio 一起发布和支持，我建议将它用于其他任何东西，但徒劳无功地尝试让自己适应未来。

* * *

最后一条建议是永远不要外包你的核心竞争力。如果此页面是您的产品的核心部分，那么您最好使用 jQuery 或 Microsoft.Ajax 等库代码自己实现它，而不是依赖第 3 方组件。但是，如果它只是您网站的一小部分，那么请继续使用 3rd 方控件。

* * *

参考：我的 Microsoft.Web.Preview.dll 版本是 1.1.61025.0。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-02T14:04:34.633

我对 Telerik 的 treeview 控件非常满意，并将它用于几乎所有需要 treeview 拖放的 asp.net 应用程序。

他们允许免费的开发许可证（虽然不是生产）所以我想你应该试一试。去 www.telerik.com 看看

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-02T14:13:53.907

Jquery 具有拖放控件。 [http://geekswithblogs.net/AzamSharp/archive/2008/02/21/119882.aspx](http://geekswithblogs.net/AzamSharp/archive/2008/02/21/119882.aspx) 也许这会有所帮助......

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-05T23:45:31.117

这是另一个 Mootools 建议，但您可能会发现[Mif.Tree](http://mifjs.net/tree/)插件很有用。这是麻省理工学院的许可证。每个演示和 API 文档也有代码示例。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-08T12:16:06.410

罗伯特>> 在经历了 4 到 5 天痛苦的 hack、double hack 和 hack 以绕过其他 hack 之后，我得出了和你一样的结论。尤其是来自 ajax 控制工具包的重新排序列表，把我逼到了精神错乱的边缘。

在我看来，学习 JQuery 并简单地自己做这些事情并没有真正的方法。我过去常常回避编写客户端代码，但是有了 AJAX，很多代码已经不再只是服务器端了。

JQuery 刚刚被移到我个人学习计划的顶部。

# html - 在 HTML 中显示角度符号

> ID：709827
> 
> 赞同：3
> 
> 时间：2009-04-02T13:56:18.927
> 
> 标签：html, internet-explorer

角度的 HTML 符号∠ (∠) 在 IE 6 或 7 中不起作用。在 Internet Explorer 中显示该符号的其他替代方法是什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-02T13:59:35.097

尝试使用这个

```
&#8736;

<FONT FACE="Symbol">&#208;</FONT> 
```

我已经检查过了，它在 ie7 中工作:)。[http://comers.citadel.edu/math_sym2005.htm](http://comers.citadel.edu/math_sym2005.htm)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-04-02T15:04:48.357

您可以使用结合了[Jamie](https://stackoverflow.com/questions/709827/displaying-angle-symbol-in-html/709836#709836)和[Shoban 的](https://stackoverflow.com/questions/709827/displaying-angle-symbol-in-html/709838#709838)答案并添加一些条件注释的解决方案：

```
<style type="text/css">
span.ang { display: inline; }
span.ang_ie { display: none; }
</style>
<!--[if IE]>
<style type="text/css">
span.ang { display: none; }
span.ang_ie { display: inline; font-family: Symbol; }
</style>
<![endif]-->

<span class="ang">&ang;</span><span class="ang_ie">&#208;</span> 
```

以上适用于 IE6、7 和 8、Firefox 2 和 3、Opera 9.6 和 Google Chrome 1 的 Windows。

它在适用于 Windows 3 或 4 的 Safari 中不起作用。适用于 Windows 的 Safari 为`&ang;`(and `&#8736;`) 呈现一个正方形。如果需要 Safari for Windows 支持，您将不得不结合 JavaScript 来检测 IE 和 Safari，以及 [Jamie 的替换图像解决方案](https://stackoverflow.com/questions/709827/displaying-angle-symbol-in-html/709836#709836)。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-04-02T13:59:13.240

尝试用

```
<span class="ang">&ang;</span> 
```

然后，如果浏览器是 IE，则使用 CSS 显示角度的图像。

请参阅这篇关于使用 css 附加图像的文章： [http ://www.hunlock.com/blogs/Attach_icons_to_anything_with_CSS](http://www.hunlock.com/blogs/Attach_icons_to_anything_with_CSS)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-03T08:12:09.113

从另一端看问题，即作为看到空心方块的用户`&lang;`（但也看到`&lang;`和`&rang;`），我找到了 IE7 的解决方案（在 Windows XP 上）：

在 Internet 属性中（抱歉，我这里只有德语版本，所以我不知道这是否是正确的名称。），转到字体，并将文本字体设置为*Arial Unicode MS*或*Lucida Sans Unicode*。

奇怪的是，即使页面不使用该字体，只是设置会导致 IE7 正确解释那些 HTML 命名实体。

编辑：Lucida Sans Unicode 不适用于所有实体。例如，`&ang;`或`&#8617;`显示正常但`&lang;`不显示`&rang;`。

# case-insensitive - 不区分大小写的 ClearQuest 查询

> ID：709828
> 
> 赞同：0
> 
> 时间：2009-04-02T13:56:32.450
> 
> 标签：case-insensitive, clearquest

如何使我的 clearquest 搜索查询不区分大小写？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-02T14:19:12.367

这是一篇可以提供一些见解的文章...取决于您使用的数据库 [http://www-01.ibm.com/support/docview.wss?uid=swg21130205](http://www-01.ibm.com/support/docview.wss?uid=swg21130205)

# hibernate - 休眠条件查询 API

> ID：709849
> 
> 赞同：1
> 
> 时间：2009-04-02T14:02:42.000
> 
> 标签：hibernate

我假设以下是不可以（？）

```
> public Criteria createCritera(Class<?> persistentClass) { 
>     ...//creation of session object etc.
>     session.beginTransaction();
>     Criteria crit = session.createCriteria(persistentClass);
>     session.getTransaction().commit();
>     session.close();
>     
>     return crit; 
} 
```

或者即使用于创建 Critera 的 Session 对象已关闭并且当前 Transaction 已提交，也可以使用和操作 Critera 对象。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-02T14:06:27.997

这确实不是一个好主意...

我不确定你想要完成什么，但我认为你应该看看这`DetachedCriteria`门课。

这允许您创建未链接/连接到会话的条件查询。当您想要执行 DetachedCriteria 时，您必须将其附加到会话中，这样就可以了。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-02T14:08:22.783

如果您没有要使用的活动，请使用[DetachedCriteria](http://www.hibernate.org/hib_docs/v3/api/org/hibernate/criterion/DetachedCriteria.html)`Session`。稍后（例如，在一个 DAO 中，您有一个用于执行查询的活动会话）您可以使用[DetachedCriteria#getExecutableCriteria](http://www.hibernate.org/hib_docs/v3/api/org/hibernate/criterion/DetachedCriteria.html#getExecutableCriteria(org.hibernate.Session))来获取可执行文件`Criteria`。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-09T20:27:32.263

如果您在会话后尝试操作 Query/Critera，创建 Query/Critera 的会话关闭，您将收到 HibernateException。异常会说：“会话已关闭”。

因此，如果 Detached 技术不适用，我会建议（我自己）始终返回结果，例如。

```
crit.list();
query.list(); 
```

而不是返回 Critera/Query 实例

# c# - 指定默认的空 DataTemplate 而不是默认的 'ToString()' DataTemplate

> ID：709853
> 
> 赞同：14
> 
> 时间：2009-04-02T14:03:36.787
> 
> 标签：c#, wpf, datatemplate, default

wpf 应用程序中的默认 DataTemplate 显示该`.ToString()`方法的结果。我正在开发一个应用程序，其中默认的 DataTemplate 不应该显示任何内容。

我试过了：

```
<Grid.Resources>
  <DataTemplate DataType="{x:Type System:Object}">
   <Grid></Grid>
  </DataTemplate>
</Grid.Resources> 
```

但这不起作用。如果不为应用程序中的每个类类型指定特定的 DataTemplate，有谁知道这是否可行？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2011-03-14T04:21:52.750

如果您使用 MVVM 模式并且有一个所有 ViewModel 类都派生自的抽象类，则可以使用该类而不是 System.Object：

```
<Grid.Resources>
    <DataTemplate DataType="{x:Type vm:VMBase}">
    </DataTemplate>
</Grid.Resources> 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-04-02T16:24:06.973

我知道没有办法做到这一点。根据 Joe 在下面的评论，WPF 明确禁止`DataTemplate`为 type指定 a `Object`。

根据您的确切要求，搜索`DataTemplate`与特定类型匹配的 a 可能会更容易。如果你找到一个，使用它。否则，什么也不显示。例如：

```
<ContentControl Content="{Binding YourContent}" ContentTemplateSelector="{StaticResource MyContentTemplateSelector}"/> 
```

在您的选择器中（显然是伪代码）：

```
var dataTemplateKey = new DataTemplateKey() { DataType = theType; };
var dataTemplate = yourControl.FindResource(dataTemplateKey);

if (dataTemplate != null)
{
    return dataTemplate;
}

return NulloDataTemplate; 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2015-07-23T12:43:44.390

我使用了 Nullable，适合我的情况。

```
<DataTemplate DataType="{x:Type sys:Nullable}">
<!-- Content -->
</DataTemplate> 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-03T23:56:59.670

我不确定是否要替换默认的 DataTemplate，但您可以使用 ValueConverter 在某些类型的情况下传递显示 ToString，否则可以使用空字符串。这是一些代码（请注意，typeb 文本块上没有转换器来显示它正常的样子）：

.xaml：

```
<Window x:Class="EmptyTemplate.Window1"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:loc="clr-namespace:EmptyTemplate"
    Title="Window1" Height="300" Width="300">
    <Window.Resources>
        <loc:AType x:Key="atype"/>
        <loc:BType x:Key="btype"/>
        <loc:TypeConverter x:Key="TypeConverter"/>
    </Window.Resources>
    <StackPanel>
        <Button Content="{Binding Source={StaticResource atype}, Converter={StaticResource TypeConverter}}"/>
        <Button Content="{Binding Source={StaticResource btype}, Converter={StaticResource TypeConverter}}"/>
        <TextBlock Text="{Binding Source={StaticResource atype}, Converter={StaticResource TypeConverter}}"/>
        <TextBlock Text="{Binding Source={StaticResource btype}}"/>
    </StackPanel>
</Window> 
```

.xaml.cs：

```
namespace EmptyTemplate
{
    /// <summary>
    /// Interaction logic for Window1.xaml
    /// </summary>
    public partial class Window1 : Window
    {
        public Window1()
        {
            InitializeComponent();
        }
    }

    public class AType { }

    public class BType { }

    public class TypeConverter : IValueConverter
    {
        public DataTemplate DefaultTemplate { get; set; }

        #region IValueConverter Members

        public object Convert(object value, Type targetType, object parameter, System.Globalization.CultureInfo culture)
        {
            if (value.GetType() == typeof(AType))
            {
                return value.ToString();
            }
            return DefaultTemplate;
        }

        public object ConvertBack(object value, Type targetType, object parameter, System.Globalization.CultureInfo culture)
        {
            throw new NotImplementedException();
        }

        #endregion
    }
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2017-08-19T16:11:59.170

这是一个关于如何使用选择器（IMO 的最佳方式）执行此操作的工作示例：

```
public class EmptyDefaultDataTemplateSelector : DataTemplateSelector
{
    public override DataTemplate SelectTemplate(object item, DependencyObject container)
    {
        if (item != null)
        {
            var dataTemplateKey = new DataTemplateKey(item.GetType());
            var dataTemplate = ((FrameworkElement) container).TryFindResource(dataTemplateKey);
            if (dataTemplate != null)
                return (DataTemplate) dataTemplate;
        }

        return new DataTemplate(); //null does not work
    }
} 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2018-03-29T13:33:40.757

我偶然发现了一些东西。我正在使用自定义依赖属性在用户控件上设置 Datacontext，该用户控件具有基于类型（在我的情况下为实体）的 Datatemplates 的内容控件。由于我有几种不同类型的实体，我的自定义依赖属性是

```
` typeof(object) 
```

这是我用来绑定到 ContentControl 的数据上下文的设备。

```
 public object MySelectedItem
    {
        get { return (object)GetValue(Property1Property); }
        set { SetValue(Property1Property, value); }
    }

            public static readonly DependencyProperty Property1Property
        = DependencyProperty.Register(
              "MySelectedItem",
              typeof(object),
              typeof(PromotionsMenu),
              new PropertyMetadata(false)
          ); 
```

像这样使用：

```
 MySelectedItem = SomeEntity; 
```

我发现我也可以这样使用它：

```
 MySelectedItem = "some text"; 
```

上下文控件将打印一些文本作为其上下文。

```
MySelectedItem = ""; 
```

适用于完全空白的上下文。

`

# single-responsibility-principle - 您何时违反 SRP（单一职责原则）？

> ID：709857
> 
> 赞同：7
> 
> 时间：2009-04-02T14:04:55.007
> 
> 标签：single-responsibility-principle, design-guidelines

**SRP**（[PDF](http://www.google.com/url?sa=t&source=web&ct=res&cd=6&url=http%3A%2F%2Fwww.objectmentor.com%2Fresources%2Farticles%2Fsrp.pdf&ei=fsTUSdXFGt2MtgeYtYXhDw&usg=AFQjCNHQQ1Aw-2yCciEbERpJn3VdHBCmQw&sig2=SfZ5lixoD1iPnM8KnQ_W2A)版本；[HTML](http://www.google.com/url?sa=t&source=web&ct=html&cd=6&url=http%3A%2F%2F74.125.47.132%2Fsearch%3Fq%3Dcache%3AMW-oZKBBOMYJ%3Awww.objectmentor.com%2Fresources%2Farticles%2Fsrp.pdf%2Bsrp%26cd%3D6%26hl%3Den%26ct%3Dclnk%26gl%3Dus%26client%3Dfirefox-a&ei=fsTUSdXFGt2MtgeYtYXhDw&usg=AFQjCNExM43HwdCHHSpd-r8VlVlymNF7lw&sig2=Y38RET_adHjn-kjzY7fq8A)版本）指出

> 改变班级的理由不应该不止一个

当您查看 Outlook 的日历事件窗口时，它有“保存**并**关闭”按钮。

![替代文字](https://farm4.static.flickr.com/3604/3406305729_783218cae6_o.png)

*因此，当保存*或*关闭*中的一个或两个的功能发生变化时，该按钮应该会发生变化。这显然违反了 SRP。

此功能既节省时间又方便，因为这是大多数用户在日历上保存约会时*期望*做的事情。

但是现在，我的问题是，除了该功能需要在 Outlook 中可用时，您还何时违反**SRP**？

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2009-04-02T14:08:28.007

SRP 不适用于 UI。请记住，即使按钮被称为“保存和关闭”，毫无疑问也可以有两种单独的方法或类型来处理保存和关闭功能。该按钮只是将这两个独立的功能联系在一起。

如果您觉得有必要违反 SRP，那么您需要重新评估您的方法。任何 SRP 违规都可以重构为一种新的方法或类型，通过这两个部分的组合来公开组合功能。

# c# - 如何禁用表单的输入面板？

> ID：709864
> 
> 赞同：0
> 
> 时间：2009-04-02T14:08:01.923
> 
> 标签：c#, .net-2.0, windows-ce

我创建了一个在手持扫描仪上运行的 Windows CE 5.0 应用程序。扫描仪有自己的（硬件）键盘，几乎所有输入都来自扫描单元。

不幸的是，每当接收扫描字符的文本框被聚焦时，输入面板就会出现在屏幕底部，几乎占据了屏幕空间的三分之一。

是否可以在我的表单或整个应用程序中停用它？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-02T17:02:06.070

如果您不是通过[InputPanel 控件](http://msdn.microsoft.com/en-us/library/microsoft.windowsce.forms.inputpanel.aspx)手动执行此操作，那么我假设您在图像中有 aygshell 并且它们正在使用[WC_SIPPREF 控件](http://msdn.microsoft.com/en-us/library/ms914097.aspx)进行渲染。我不确定您是否可以手动删除该控件-我从未尝试过。可能有一个[agshell 函数](http://msdn.microsoft.com/en-us/library/ms927275.aspx)可以让您禁用/删除它，或者您的应用程序的 InputPanel 的一些工作可以删除它。

您可能还想[查看此博客条目](http://www.christec.co.nz/blog/archives/146)以了解更多详细信息。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-02T14:15:18.990

上次我与 CE 合作的时候，它被称为 Pocketpc 2002（我仍然有我的旧 iPaq 3870 - 第一个带蓝牙的设备和最后一个没有 wifi 的设备），但当时最简单的方法是将设备设置为使用不弹出任何内容的手写识别模式。这对你来说可能是也可能不是一个选择，从那时起情况可能会有所改善。

# python - Python服务器端AJAX库？

> ID：709868
> 
> 赞同：5
> 
> 时间：2009-04-02T14:09:01.533
> 
> 标签：python, ajax

我想要一个浏览器页面来更新有关计时器或事件的一些信息。我想在服务器端使用 Python。这很简单，我不需要任何非常复杂的东西。

我可以花一些时间弄清楚如何以“AJAX 方式”完成所有这些工作，但我确信有人编写了一个不错的 Python 库来完成所有繁重的工作。如果您使用过这样的库，请告诉我详细信息。

注意：我看到[了 how-to-implement-a-minimal-server-for-ajax-in-python](https://stackoverflow.com/questions/336866/how-to-implement-a-minimal-server-for-ajax-in-python)但我想要一个库来隐藏实现细节。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-04-02T14:10:03.650

AJAX 代表异步 JavaScript 和 XML。除了浏览器上安装的 Javascript 来执行 AJAX 调用之外，您不需要任何特殊的库。AJAX 请求来自客户端 Javascript 代码，然后转到服务器端，在您的情况下，服务器端将在 python 中处理。

您可能想使用[Django Web 框架](http://www.djangoproject.com/)。

查看有关[Django 技巧的教程：一个简单的 AJAX 示例](http://www.b-list.org/weblog/2006/jul/31/django-tips-simple-ajax-example-part-1/)。

这是一个[关于 XmlHTTPRequest / AJAX 的简单客户端教程](http://www.mousewhisperer.co.uk/ajax_page.html)

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-04-02T14:23:17.410

您*还可以*使用 python 和 pyjamas 编写 ajax 代码的客户端和服务器端：

这是一个 RPC 风格的服务器和简单的示例：

[http://www.machine-envy.com/blog/2006/12/10/howto-pyjamas-pylons-json/](http://www.machine-envy.com/blog/2006/12/10/howto-pyjamas-pylons-json/)

很多人将它与 Django 一起使用，但正如上面的示例所示，它可以很好地与 Pylons 一起使用，并且可以很容易地与 TurboGears2 一起使用。

我通常赞成学习足够的javascript来自己做这种事情，但是如果你的问题符合睡衣可以做的事情，你会很快很容易地得到结果。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-02T15:36:57.197

我建议你在 Django 中实现服务器部分，在我看来这是一个很棒的工具包。通过 Django，您可以生成 XML 响应（尽管我建议您使用 JSON，它在 Web 浏览器端更容易处理）。

一旦你有东西在服务器端生成你的回复，你必须编写调用它的 JavaScript 代码（通过异步调用），获取结果（在 JSON 中）并使用它在页面的 DOM 树上做一些聪明的事情. 为此，您需要一个 JavaScript 库。

我对“Web 2.0”的各种 javascript 库做了一些经验。[Scriptaculous](http://script.aculo.us/)很酷，[Dojo](http://www.dojotoolkit.org/)也很酷，但我最喜欢的是[MochiKit](http://mochikit.com/)，因为它们专注于非常 Python 的语法，所以它可以很好地隐藏 javascript 和 python 之间的差异。

# php - open_basedir 没有任何效果

> ID：709870
> 
> 赞同：0
> 
> 时间：2009-04-02T14:09:55.213
> 
> 标签：php, apache, apache2, httpd.conf, open-basedir

对于我的虚拟主机面板，需要阻止用户访问他们自己目录之外的文件 ( `/var/www/u/s/username`)。我试图使用这一行`httpd.conf`来防止人们进入目录。

```
<Directory /var/www/users/>
php_admin_value open_basedir .:/usr/lib/php5
</Directory> 
```

但是在`php.ini`，它似乎没有任何效果。我究竟做错了什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-03T19:42:00.797

这可能是一个愚蠢的建议，但您是否在更改 php.ini 后重新启动了网络服务器？

您可能会尝试使用的另一种方法是使用“auto_prepend_file”指令附加一个文件，以包含一个脚本以将 open_basedir 指令收紧到当前用户目录：

来自 PHP.net ( [http://www.php.net/manual/en/ini.sect.safe-mode.php](http://www.php.net/manual/en/ini.sect.safe-mode.php) )

> 从 PHP 5.3.0 开始，open_basedir 可以在运行时收紧。这意味着如果在 php.ini 中将 open_basedir 设置为 /www/，则脚本可以在运行时使用 ini_set() 将配置收紧到 /www/tmp/

**附加建议：**

需要正确设置 Apache 配置以使 INI 覆盖生效。确保您在服务器或虚拟主机的 Apache 配置中设置了“AllowOverride Options”或“AllowOverride All”。

[http://us2.php.net/configuration.changes](http://us2.php.net/configuration.changes)

[http://httpd.apache.org/docs/2.0/mod/core.html#allowoverride](http://httpd.apache.org/docs/2.0/mod/core.html#allowoverride)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-14T11:08:16.340

您可能需要为每个用户目录添加一行：

```
<Directory /var/www/u/s/username>
php_admin_value open_basedir "/var/www/u/s/username/:/shared/path/"
</Directory> 
```

请注意，尾部斜杠是为了防止用户“username”访问“username2”目录。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-02T14:41:50.923

1.  据我所知，它不是路径格式，它必须只是一个目录；
2.  使用 ”。” 使用 open_basedir 完全没有意义，“。” 始终是当前目录。你可以`chdir('/wherever/you/want')`，有“。” 扩展为`/wherever/you/want`

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-02T15:57:39.253

很可能您正在修改错误的“php.ini”。

# arrays - 如何在多维数组上使用 any()？

> ID：709872
> 
> 赞同：3
> 
> 时间：2009-04-02T14:10:17.690
> 
> 标签：arrays, matlab, matrix, multidimensional-array, any

我正在测试一个任意大、任意维度的逻辑数组，我想知道其中是否*有一个或多个*是正确的。`any()`一次只适用于一个维度，`sum()`. 我知道我可以测试维度的数量并重复`any()`，直到我得到一个答案，但我想要一种更快、坦率地说、更优雅的方法。

想法？

我正在运行 2009a（我认为，用旧的说法，R17）。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-04-02T14:14:50.193

如果您的数据在矩阵**A**中，请尝试以下操作：

```
anyAreTrue = any(A(:)); 
```

**编辑：**为了向不熟悉语法的人解释更多，**A(:)**使用[冒号运算符](http://www.mathworks.com/access/helpdesk/help/techdoc/ref/colon.html)获取数组**A**的全部内容，无论维度如何，并将它们重塑为单个列向量（大小数字（A）-by-1）。只需一次调用[ANY](http://www.mathworks.com/access/helpdesk/help/techdoc/ref/any.html)即可对结果列向量进行操作。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-02T15:58:08.393

正如所指出的，正确的解决方案是将结果重塑为向量。然后任何将给出所需的结果。因此，

任何（A（:)）

给出全局结果，如果任何 numel(A) 元素为真，则为真. 你也可以使用

任何（重塑（A，[]，1））

它显式地使用了 reshape 运算符。如果您不希望将矩阵转换为向量以应用任何额外的步骤，那么另一种方法是编写您自己的函数。例如，这是一个可以为您执行此操作的函数：

=======================

函数结果 = myany(A)

% 确定 A 中的任何元素是否非零

结果 = 任何（A（:)）；

=======================

将其保存为搜索路径上的 m 文件。MATLAB 的美妙之处（适用于任何编程语言）是完全可扩展的。如果您希望它具有某些功能，只需编写一个实现它的小习语即可。如果您经常这样做，您将定制环境以满足您的需求。

# asp.net - jQuery Ajax 调用 - 成功设置变量值

> ID：709876
> 
> 赞同：46
> 
> 时间：2009-04-02T14:11:31.043
> 
> 标签：asp.net, javascript, jquery, ajax, web-services

我有一个正在编写的应用程序，它修改服务器中缓存对象上的数据。修改是通过基本上更新该对象的属性的 ajax 调用执行的。当用户完成工作时，我有一个基本的“保存更改”按钮，允许他们保存数据并刷新缓存的对象。

为了保护用户，如果在对服务器对象进行了修改（如果尚未保存）时尝试离开页面，我想警告他们。因此，我创建了一个名为 IsInitialized 的 Web 服务方法，该方法将根据是否保存更改返回 true 或 false。如果他们没有被保存，我想提示用户并给他们一个机会来取消他们的导航请求。

这是我的问题 - 虽然我的调用正常工作，但我似乎无法获得 ajax 成功调用来在其回调函数上设置变量值。这是我现在拥有的代码。

```
 ////Catches the users to keep them from navigation off the page w/o saved changes...
window.onbeforeunload = CheckSaveStatus;
var IsInitialized;

function CheckSaveStatus() {

    var temp = $.ajax({
        type: "POST",
        url: "URL.asmx/CheckIfInstanceIsInitilized",
        data: "{}",
        contentType: "application/json; charset=utf-8",
        dataType: "json",
        success: function(result) {
            IsInitialized = result.d;
        },
        error: function(xmlHttpRequest, status, err) {
            alert(xmlHttpRequest.statusText + " " + xmlHttpRequest.status + " : " + xmlHttpRequest.responseText);
        }

    });

    if (IsInitialized) {
        return "You currently have unprocessed changes for this Simulation.";
    }
} 
```

我觉得我可能试图以不恰当的方式使用 Success 回调。如何在 Success 回调上设置 javascript 变量，以便我可以决定是否应提示用户使用未保存的更改消息？

正如刚才所指出的，我正在进行异步调用，这意味着在我的方法返回之前调用其余代码。有没有办法使用那个 ajax 调用，但仍然捕获 window.onunload 事件？（不制作同步ajax）

* * *

## 回答 #1

> 赞同：38
> 
> 时间：2009-04-02T14:40:57.913

由于您在卸载事件中需要此行为，因此您必须改为进行同步调用。但是，它可能会冻结浏览器窗口/选项卡，具体取决于调用需要多长时间，但是因为您实际上是在试图阻止用户关闭窗口......

添加`async: false`到您的 JSON 以进行同步调用。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2010-11-14T01:30:40.707

jquery页面示例：

```
var html = $.ajax({
  url: "some.php",
  async: false
 }).responseText; 
```

来源：[http ://api.jquery.com/jQuery.ajax/](http://api.jquery.com/jQuery.ajax/)

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-04-02T14:16:40.110

问题是对 Ajax 调用的请求是异步的。因此，当您检查 IsInitialized 时，呼叫尚未完成。

我建议在成功函数中指定您的行为。

基本上，使用 ajax 进行同步调用即使不是不可能的，也确实令人沮丧。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-04-02T14:49:22.107

从理论上讲，您可以终止事件（返回 false）并在成功时关闭窗口，但我认为您会遇到某些用户设置的 Javascript 限制，并且还会让他们对为什么他们的窗口没有关闭感到困惑。所以，我同意 Pawel Krakowiak 的观点，ajax 调用本身必须是同步的。

我要补充一点，您希望向用户提供一些您正在检查状态的通知（请不要弹出窗口。窗口顶部的那些漂亮的通知横幅之一）并确保设置 $.ajax “超时”选项对于这种情况更合理，因此他们不会永远等待窗口关闭。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2010-09-25T17:22:05.943

我在尝试通过 ajax 请求的成功回调为数据对象设置属性时遇到了类似的问题。使用`async: false`也没有解决我的问题。我最终做的是`setTimeout`在 ajax 调用之外使用调用，并将超时值设置为 1，如下所示：

```
function getSessionid() {  
    $.ajax({  
        type: 'POST',  
        url: 'getSession.php',  
        dataType: 'text',  
        success: function(result){myData.sessionid = result;},   
        error: function(data) {alert("Error!\n" + data);} 
    });  
    setTimeout(function() {alert('sessionid = ' + myData.sessionid);},1);  
} 
```

仅仅有 1 毫秒的延迟就让世界变得与众不同。没有它，该`sessionid`属性将不会在 ajax 调用之外设置，尽管回调中的警报显示它确实已被设置。如果您遇到类似的问题，请考虑一下。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-04-02T15:20:03.570

看起来对我来说最好的方法是在我的 ajax 调用中使用 async: false 选项。虽然我理解 Rashack 这样做的犹豫，但我认为这种情况证明了手段是合理的。

Jerph 的另一个重要观点是确保我在尝试验证用户状态时不会让用户挂起。与超时选项相结合很重要。

感谢所有评论的人。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2010-03-08T12:30:04.430

看这里：

[http://groups.google.com/group/jquery-dev/browse_thread/thread/40d0e3def47148a0](http://groups.google.com/group/jquery-dev/browse_thread/thread/40d0e3def47148a0)

# javascript - Javascript“命名空间”和 jQuery AJAX

> ID：709882
> 
> 赞同：5
> 
> 时间：2009-04-02T14:14:09.587
> 
> 标签：javascript, jquery, ajax, json, prototype

我正在使用此处列出的建议 ( [http://www.odetocode.com/articles/473.aspx ) 使用模拟](http://www.odetocode.com/articles/473.aspx)**命名空间**和原型设计来编写 JavaScript AJAX 网络聊天系统。

在我的一个原型方法中，我在**jQuery中调用****$.ajax**方法。然后我想要做的是将返回的 JSON 数据传递到我的 JavaScript 网络聊天命名空间内的一个方法中。

 **问题似乎是因为我已经创建了我的 JavaScript 网络聊天的一个实例，我不能直接调用其中的方法，因为我需要通过实例来解决它。

下面代码中的关键部分是

```
success: function(data, textStatus) {
  this.GetUpdate_Success(data)
}, 
```

我在想，因为我们在 $.ajax() 方法中，**这**不再是指我们的 WebchatV3 对象。

完整的 JavaScript 代码如下所示：

```
/// <reference path="/JavaScript/jquery-1.3.2-vsdoc2.js" />

// Simulated 'namespace'
var AvonAndSomerset = {}

// Chatroom run time data
AvonAndSomerset.WebchatV3 = function(memberId, passcode) {
  this.Members = new Array(); // Members in the chatroom
  this.Questions = new Array(); // The questions queue in the chatroom

  // Details about the current user
  this.currentMember = new AvonAndSomerset.WebchatV3.Member(memberId, passcode, null, null, null, null, null);

  // Set-up AJAX defaults
  $.ajaxSetup({
    type: "POST",
    contentType: "application/json; charset=utf-8",
    dataType: "json"
  });
}

AvonAndSomerset.WebchatV3.prototype = {
    // Get latest Member,Quetsion,Transcript and Room data from server
    GetUpdate: function(StartUp) {

      $.ajax({
        url: "JSON.aspx/Members_GetChanges",
        data: "{ MemberID: " + this.currentMember.memberId + ", Passcode: \"" + this.currentMember.passcode + "\", ReturnAll: " + StartUp + " }",
        success: function(data, textStatus) {
          this.GetUpdate_Success(data)
        },
        error: function(result) {
          alert('Members_GetChanges() failed: ' + result.responseText);
        }
      });
    },
    // Callback - on success of GetUpdate()
    GetUpdate_Success: function(data) {
      alert('The AJAX call was successful!');
    },
    // Does the MemberID exist in the local array?
    Members_DoesExist: function(MemberID) {
      alert('Searching for ' + MemberID);

      alert(this.Members.length);
    } 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-04-02T14:17:47.627

`this`解决此问题的最简单方法是创建一个在所需的适当范围内 引用的变量。`this`和范围在 javascript 中的工作方式与大多数语言不同，在这种情况下，它指的是传递给函数的对象。

```
// Get latest Member,Quetsion,Transcript and Room data from server
GetUpdate: function(StartUp) {
    //here
    var self = this;
    $.ajax({ url: "JSON.aspx/Members_GetChanges",
        data: "{ MemberID: " + this.currentMember.memberId + ", Passcode: \"" + this.currentMember.passcode + "\", ReturnAll: " + StartUp + " }",
        success: function(data, textStatus) {
            self.GetUpdate_Success(data)
        },
        error: function(result) {
            alert('Members_GetChanges() failed: ' + result.responseText);
        }
    });
}, 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-02T14:15:50.220

尝试

```
success: function(data, textStatus) {
  AvonAndSomerset.WebchatV3.GetUpdate_Success(data)
}, 
```

这可能会奏效。

# c# - 如何访问 IQueryable 中的连续元素 目的？

> ID：709885
> 
> 赞同：3
> 
> 时间：2009-04-02T14:15:14.293
> 
> 标签：c#, .net, linq, iteration, iqueryable

我需要访问 IQueryable 对象中的当前和上一个元素。如果我有一个 int 数组，我会执行以下操作：

```
var array = new int[]{0,1,2,3,4};
for(var i = 1; i<array.Length ; i++)
{
    method1(array[i-1], array[i]);
} 
```

我不知道对 IQueryable 做同样的事情，因为它没有实现 IList。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-02T14:20:24.657

**编辑**

有点误读了这个问题。此代码将为您提供后续元素

```
public static IEnumerable<Pair<T,T>> GroupIntoConsequetive(this IEnumerable<T> enumerable) {
  using ( var e = enumerable.GetEnumerator() ) {
    if ( !e.MoveNext() ) { 
      yield break;
    }
    var last = e.Current;
    while ( e.MoveNext() ) {
      yield return new Pair<T,T>(last, e.Current);
      last = e.Current;
    }
  }
} 
```

我不确定是否有默认方式，但为此编写扩展方法应该不难。我假设有一个简单的 Pair 实现

```
public static IEnumerable<Pair<T,T>> Window(this IEnumerable<T> enumerable) {
  using ( var e = enumerable.GetEnumerator() ) {
    while ( e.MoveNext() ) { 
      var first = e.Current;
      if ( !e.MoveNext() ) {
        throw new InvalidOperationException("Need even number");
      }
      var second = e.Current;
      yield return new Pair<T,T>(first,second);
   }
  }
} 
```

使用该窗口，您可以通过以下方式获得您想要的行为

```
var col = GetQueryableItem();
col.Window().Select(pair => method1(pair.First, pair.Second)); 
```

快速而肮脏的 Pair 实现

```
public struct Pair<T1,T2> {
  public readonly T1 First;
  public readonly T2 Second;
  public Pair(T1 first, T2 second) {
    First = first;
    Second = second;
  }
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-02T14:23:04.807

您可以使用 ToList<>() 将 IQueryable<> 转换为 List<>。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-04-02T15:00:07.917

使用扩展方法使这变得相当容易。

```
public static class IEnumerableExtensions
{
  public static IEnumerable<ValueWithPrevious<T>> WithPrevious<T>(this IEnumerable<T> @this)
  {
    using (var e = @this.GetEnumerator())
    {
      if (!e.MoveNext())
        yield break;

      var previous = e.Current;

      while (e.MoveNext())
      {
        yield return new ValueWithPrevious<T>(e.Current, previous);
        previous = e.Current;
      }
    }
  }
}

public struct ValueWithPrevious<T>
{
  public readonly T Value, Previous;

  public ValueWithPrevious(T value, T previous)
  {
    Value = value;
    Previous = previous;
  }
} 
```

用法：

```
var array = new int[] { 1, 2, 3, 4, 5 };
foreach (var value in array.WithPrevious())
{
  Console.WriteLine("{0}, {1}", value.Previous, value.Value);
  // Results: 1, 2
  //          2, 3
  //          3, 4
  //          4, 5
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-02T14:26:13.410

`IQueryable<T>`但它提供了扩展方法来从您的实例创建数组或列表，请参阅[ToArray()](http://msdn.microsoft.com/en-us/library/bb298736.aspx)和[ToList()](http://msdn.microsoft.com/en-us/library/bb342261.aspx)。然后，您可以像使用示例中的数组一样执行相同的操作。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-02T14:38:19.963

IQueryable 是 IEnumerable。因此，您可以执行以下操作：

```
var a = new [] {1, 2, 3, 4}.AsQueryable();

if (a.Count() < 2) {
    return;
}

var prev = a.First();
var isFirst = true;

foreach (var i in a) {
    if (isFirst) {
        isFirst = false;
        continue;
    }

    method1(prev, i);
    prev = i;
} 
```

或者简单地将 IQueryable 转换为 IList：

```
var list = a.ToList(); 
```

# inversion-of-control - Spring.NET 和替代品

> ID：709888
> 
> 赞同：0
> 
> 时间：2009-04-02T14:15:50.220
> 
> 标签：inversion-of-control, spring.net

Spring.NET 是用于 Web 开发的好框架吗？

有替代品吗？

更新（对于弗雷德里克）：

*   在 Web 开发中使用 Spring.NET（或 IoC 容器）时是否有缺点。我总是在客户端 flex 应用程序中使用 spring.actionscript，但客户端应用程序与 Web 应用程序不同。
*   是否有 Microsoft IoC 容器框架？
*   它如何处理并发？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-27T15:52:34.757

作为 Spring.NET 提交者，我当然有偏见，但 Spring.Web 完全是在过去几年中根据我们自己的需求构建和改进的。恕我直言，与其他容器相比，它在 WebForms 开发方面提供了最广泛的支持。MVC 支持仍然是 TDB。

Spring.NET 本身也是完全线程安全的。当然，您自己的单例实现需要是线程安全的，如果不是，您始终可以使用“请求”范围。

hth，埃里希

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-02T14:34:03.610

“是否有 Microsoft IoC 容器框架？” - 是的，它叫做[Unity](http://msdn.microsoft.com/en-us/library/cc468366.aspx)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-02T14:17:36.520

它是一个好的框架吗？取决于你的要求。

有替代品吗？是的。
（温莎城堡，StructureMap，PicoContainer，...）。

[谷歌](http://www.google.be/search?hl=nl&rlz=1C1CHMG_nlBE291BE303&q=IoC+container+frameworks+for+.NET&btnG=Zoeken&meta=)可以告诉你的方式......

# xml - 如果它对 xsd 无效，你能阻止节点插入到 XmlDocument 中吗？

> ID：709891
> 
> 赞同：0
> 
> 时间：2009-04-02T14:16:02.107
> 
> 标签：xml, xsd, c#-2.0

我有一个模式，我有一个文档。我想允许将 xml 片段插入到该文档中，但是，它必须根据架构有效。

是否可以在 C# 中执行此操作？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-02T14:27:59.740

我以前从未这样做过，但您可以使用 XmlDocument 的 NodeChanged、NodeInserted 和 NodeRemoved 事件（请参阅[http://msdn.microsoft.com/en-us/library/system.xml.xmldocument_events.aspx](http://msdn.microsoft.com/en-us/library/system.xml.xmldocument_events.aspx)）。引发事件时，您可以重新验证文档。如果验证失败，您可以取消更改、删除或重新插入节点。

您也可以使用[XmlSchemaValidator](http://msdn.microsoft.com/en-us/library/system.xml.schema.xmlschemavalidator.aspx)类，那样会更复杂。它遵循基于推送的模型，并且在验证期间，基本上会告诉您在当前点什么是有效的。我想您可以验证到插入点，然后检查要插入的节点在该点是否有效。但是，我只使用它来生成符合模式集的 XML 文档；我从来没有将它用于简单的验证。

# asp.net - Telerik RadTree 绑定到 XML 数据源

> ID：709896
> 
> 赞同：0
> 
> 时间：2009-04-02T14:17:09.047
> 
> 标签：asp.net, xml, data-binding, telerik

我有一个绑定到 XMLDataSource 的 Telerik RadTree。我想将节点的文本设置为由 2 个属性（编号和名称）组成。

看`<telerik:RadTreeNodeBinding>`

例子：

*   “1、你好吗？”
*   “2、你几岁？”

XML:

```
<questions>
  <question name="How are you?" number="1" imageurl="">
  </question>
  <question name="How old are you?" number="2" imageurl="">
  </question>
</questions> 
```

ASPX：

```
<telerik:RadTreeView ID="RadTreeView1" runat="server">              
  <DataBindings>  
    <telerik:RadTreeNodeBinding DataMember="questions" Text="Questions" 
       ImageUrl="/questions.png" Expanded="false" />   
    <telerik:RadTreeNodeBinding DataMember="question" 
       Text='[<%# DataBinder.Eval("number")%>].[<%# DataBinder.Eval("name")%>]' 
       ImageUrlField="imageurl" FormatString="{0}" Expanded="false" />
  </DataBindings>
</telerik:RadTreeView> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-02T14:40:20.647

尚未对此进行测试，但试一试：

XML:

```
<questions>
  <question name="How are you?" number="1" imageurl=""></question>
  <question name="How old are you?" number="2" imageurl=""></question>
</questions> 
```

ASPX：

```
 <telerik:RadTreeView ID="RadTreeView1" runat="server">              
        <DataBindings>  
            <telerik:RadTreeNodeBinding DataMember="questions" Text="Questions" ImageUrl="/questions.png" Expanded="false" />   
            <telerik:RadTreeNodeBinding DataMember="question" Text='[<%# DataBinder.Eval(Container.DataItem, "number")%>].[<%# DataBinder.Eval(Container.DataItem, "name")%>]' ImageUrlField="imageurl" FormatString="{0}" Expanded="false" />
       </DataBindings>
    </telerik:RadTreeView> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-02T16:03:26.493

已解决：我使用应用于所有节点的 NodeTemplate 来添加“数字”。如果在 xpath 中找到...

```
<telerik:RadTreeView ID="RadTreeView1" runat="server">
    <NodeTemplate>
            <%# XPath("@number", "{0}.") %>
            <%# DataBinder.Eval(Container, "Text") %>
    </NodeTemplate>             
    <DataBindings>
        <telerik:RadTreeNodeBinding DataMember="questions" Text="Questions" ImageUrl="/questions.png" Expanded="false" />   
        <telerik:RadTreeNodeBinding DataMember="question" TextField="name" ImageUrlField="kpiimageurl" FormatString="{0}" Expanded="false" /> 
    </DataBindings>  
</telerik:RadTreeView> 
```

# java - 如何在 Struts 中显示成功消息？

> ID：709905
> 
> 赞同：3
> 
> 时间：2009-04-02T14:19:57.217
> 
> 标签：java, jakarta-ee, struts

我们可以通过 actionErrors.add(key, new Actionmessage("string")), addErrors(request, actionErrors); 在 Struts 中显示错误。然后通过

我想知道，如何在 Struts 中输出成功消息？你通常/通常是怎么做的？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2010-03-06T04:30:56.103

在 Struts 1 上，您可以使用[ActionMessage](http://struts.apache.org/1.1/api/org/apache/struts/action/ActionMessage.html)实例来表示要在 JSP 上显示的消息

```
ActionMessages messages = new ActionMessages();
messages.add(ActionMessages.GLOBAL_MESSAGE, new ActionMessage("message1");
messages.add(ActionMessages.GLOBAL_MESSAGE, new ActionMessage("message2");
saveMessages(request, messages); // storing messages as request attributes 
```

“message1”和“message2”是资源属性文件的键。非常类似于 ActionError 处理

在 JSP 上显示消息类似于操作错误，但您必须包含属性“消息”

```
<logic:messagesPresent message="true">
   <html:messages id="message" message="true">
     <bean:write name="message"/><br/>
   </html:messages>
</logic:messagesPresent> 
```

在此示例中，消息被存储为属性请求。如果您想控制属性名称，您可以指定任何属性名称

```
ActionMessages messages = new ActionMessages();
messages.add("appMessage", new ActionMessage("message1");
saveMessages(request, messages); // storing messages as request attributes 
```

现在消息存储在请求属性“appMessage”下。例如，如果您想在 JSP 上使用 JSTL 标记而不是 Struts 标记，设置自定义属性名称可能很有用

此外，您可以在会话范围内保存操作消息。

```
saveMessages(request.getSession(), messages); // storing messages as request attributes 
```

您可以使用此功能在用户会话中显示粘性消息，例如用户全名。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-02T17:58:31.723

If you're using Struts2, you should be able to use addActionMessage instead of addActionError.

[http://struts.apache.org/2.0.14/struts2-core/apidocs/com/opensymphony/xwork2/ValidationAwareSupport.html](http://struts.apache.org/2.0.14/struts2-core/apidocs/com/opensymphony/xwork2/ValidationAwareSupport.html)

Your post is missing what you were putting in your JSP, but if you add an action message, you can use the `<s:actionmessage/>` tag to display what you added.

[http://struts.apache.org/2.0.14/docs/actionmessage.html](http://struts.apache.org/2.0.14/docs/actionmessage.html)

# http - 你是如何与 Nabaztag 互动的？

> ID：709906
> 
> 赞同：4
> 
> 时间：2009-04-02T14:20:06.437
> 
> 标签：http, api, nabaztag

我订购的[Nabaztag](http://www.nabaztag.com/)已经到了。我知道有一个API 可以与您自己的软件[中的小动物进行交互。](http://api.nabaztag.com/docs/home.html)还看到了 Perl 和 .NET 等库的链接，并开始自己开发一个简单的 .NET Compact Framework 3.5 库，用于通过我的手机与兔子进行交互。

我见过至少一个声称与 Wifi 兔子交互的[应用程序：Rob Aquila 的 TFS 构建通知应用程序](http://raquila.com/software/team-foundation-server-build-notification-screen/)。（与这个问题无关，但这看起来确实是一个不错的应用程序，可以在大型 TFS 团队的中央监视器上运行......）

我只是好奇其他人使用 Nabaztag 的经历：

*   你曾经使用过 Nabaztag API 与无线兔子交互吗？
*   你做了什么？可以免费在我的兔子身上试用吗？
*   您喜欢使用 API 吗？您是自己使用 HTTP API 还是使用了库？如果是这样，您使用了哪个库？
*   即使您自己没有对 API 进行任何操作，您知道哪些应用程序和/或网站可以与 Nabaztag 交互？
*   还有其他提示吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-07-07T22:40:53.050

这对我的雇主来说有点无耻，但有人写了一个快速而肮脏的 Perl 脚本，让兔子从 ZXTM（宙斯可扩展流量管理器）读取日志事件。

*   [Perl 脚本](http://knowledgehub.zeus.com/articles/2008/12/15/zxtms_like_to_tweet_too#c289)（以及该页面的更上方，如何将其插入 ZXTM）
*   [兔子的视频](http://www.viddler.com/explore/lancew/videos/2/)
*   [适合在桌面上使用的 ZXTM 的 VMware 映像](http://www.zeus.com/downloads/desktop/)来尝试一下

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-12-11T01:56:43.443

我在其他人制作的 python api 包装器上扩展了起点，并有一些应用程序（丑陋的控制面板、个人天气和交通阅读器、当天的谷歌日历事件）。它们都可以在[www.mcgurrin.com/nabaztag](http://www.mcgurrin.com/nabaztag)下载。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-15T12:26:20.720

我用它创建了一个 CruiseControl.net 插件。默认 API 存在一些问题，因为它没有很好的文档记录，因此需要进行大量试验。此外，开发到默认 API 也不是那么容易。

所以我制作了一个 .net API (c#)，它将紫罗兰色 api 抽象出来，并在开发时为您提供更多帮助，特别是在创建编舞时（尤达会说屁股痛）。

目前两者都没有向公众开放，但我正在发布。

可以在你的兔子身上实现的东西，我不知道，本地交通信息（很高兴有）你喜欢的音乐的新版本，与你的手机接口？（从手机发送命令给兔子）

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-10-27T10:28:53.510

嘿 peSHIr，恭喜你得到一只兔子。现在，随着紫罗兰被 Mindscape 收购，它肯定会继续生活......

我也想为兔子开发有趣的东西，但这似乎是一个大惊小怪，而且很难开始——我检查了几个 API 和代理来掌握它——发现很多项目，但要么没用，要么过时。尽管它是用 PHP 编写的，但 OpenNab 项目似乎是最不活跃的项目之一。也许值得一试？

[http://opennab.sourceforge.net/](http://opennab.sourceforge.net/)

希望Mindscape能提供更好的API，甚至更好，开源兔子！

# c# - 轻量级 .Net CMS 库

> ID：709913
> 
> 赞同：4
> 
> 时间：2009-04-02T14:22:15.010
> 
> 标签：c#, asp.net-mvc, content-management-system

我正在为 .net MVC 应用程序寻找一个轻量级的 CMS 库。我不需要任何前端管理，只需要一个可以存储和检索内容的库。我打算自己写前端。我认为自己需要存储的最复杂的东西是一组新闻帖子。除此之外，我需要能够为每个页面存储一组任意键值对。资源文件可能为此提供了最好的模型，除了它们在运行时不可编辑和持久化。

我发现的最接近的东西是[桉树](http://www.codeproject.com/KB/aspnet/eucalypto.aspx)，看起来它应该很符合要求。我可以很容易地撕掉论坛和维基，因为我不需要它们。但它似乎已经有一段时间没有开发了，而且我过去没有听说过它，所以会担心可靠性。图书馆有什么想法可以做到这一点吗？

我知道为这么简单的事情推出我自己的 SQL 数据库可能会更简单，但如果有一个好的库存在，它可以为我节省一些时间和麻烦。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-02T15:19:36.490

您可能想查看文档数据库。[MindTouch's Dream 浮现](http://wiki.developer.mindtouch.com/Dream)在脑海中——它是 DekiWiki 背后的引擎，并在 Mono 上运行。我假设它也可以在 .NET 上运行而无需（或最少）更改。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2009-04-21T14:24:34.483

嗨，我也看到了桉树。但没有网页界面。如果你是 asp.net 的初学者会很困难 Eucalypto 没有一个好的社区。而且它不会成长

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2010-07-01T06:27:46.787

我会推荐看看[n2](http://n2cms.com/ "n2")。包含正常站点所需的大多数内容，而不会臃肿。数据层基于 NHiberbnate，因此您可以使用大多数关系数据库。也适用于 MVC。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2011-10-13T09:01:48.010

我认为[Kooboo](http://www.kooboo.com/)是 .NET 领域中最简单、可扩展和健壮的 CMS（我不喜欢 Orchard，它是可扩展的，但不健壮，）。

# c++ - Windows：覆盖正在使用的文件

> ID：709914
> 
> 赞同：10
> 
> 时间：2009-04-02T14:22:49.207
> 
> 标签：c++, c, windows, winapi, overwrite

我正在尝试编写一个允许在 Windows 中移动文件的实用程序，当它找到正在使用的文件时，将设置该文件以在重新启动时移动。

似乎 MoveFileEx ( [http://msdn.microsoft.com/en-us/library/aa365240(VS.85).aspx](http://msdn.microsoft.com/en-us/library/aa365240(VS.85).aspx) ) 是正确的选择，但是我无法弄清楚我在寻找什么错误代码从 GetLastError ( [http://msdn.microsoft.com/en-us/library/ms679360(VS.85).aspx](http://msdn.microsoft.com/en-us/library/ms679360(VS.85).aspx) ) 查看该文件正在使用中。

当存在实际权限问题时，我希望该实用程序失败。有没有办法区分你不能在那里写和正在使用的覆盖错误？

另外，如果我在用户的临时文件夹中有要移动的文件，它们会在延迟重命名之前被删除吗？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-04-02T14:33:23.283

您必须先调用[CreateFile](http://msdn.microsoft.com/en-us/library/aa363858(VS.85).aspx)以查看文件是否正在使用中。

**要查看文件是否正在使用中：**

如果您获得有效的文件句柄，那么您就知道该文件与已经打开此文件的进程没有冲突的共享权限。

如果您指定无共享访问权限（CreateFile 调用的 dwShareMode 参数为 0），那么如果任何其他进程当前正在以任何方式使用该文件，您将不会获得文件句柄。在这种情况下 GetLastError 将返回：`ERROR_SHARING_VIOLATION (32)`

* * *

**要查看访问文件是否存在安全问题：**

要查看访问该文件是否存在权限问题，CreateFile 调用也会失败，但会出现不同的 GetLastError。你会得到：`ERROR_ACCESS_DENIED (5)`

# asp.net-mvc - 子记录未在 ASP.NET MVC 表单上发布

> ID：709933
> 
> 赞同：1
> 
> 时间：2009-04-02T14:28:10.177
> 
> 标签：asp.net-mvc, model-view-controller, post

我有两个表，Author 和 Book，一个作者可以有很多书。我有一个编辑视图设置为“System.Web.Mvc.ViewPage(of MyDatabase.Author)”。该表单设置为显示作者及其所有书籍，并具有编辑书籍信息的能力：

```
<% Using Html.BeginForm()%>
<%=Model.author_name%> <br/>
<% For Each item In Model.Books%>
<%=Html.CheckBox("checked_out")%>
<%=item.book_name%> <br/>
<% Next%>
<input type="submit" value="Save" />
<% End Using%> 
```

在控制器中，我有 Post 功能：

```
<ActionName("Edit"), AcceptVerbs(HttpVerbs.Post)> _
Function Save(ByVal form As Author) As ActionResult
   Dim book_count = Author.Books.Count
End Function 
```

问题是 Books 集合不是帖子的一部分 - book_count 为零，即使显示了几本书。

我做错了什么，还是我对帖子的期望过高？我怎样才能使这项工作？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-02T14:50:43.833

我相信您的问题是 MVC 的“魔术解析器”没有什么可挂的。当您将项目放在页面上时，您希望能够在集合中枚举的帖子中重新获取这些项目，您必须给出您的“事物”名称。所以，我在我的页面中所做的是，如果我不希望他们能够编辑一个字段，比如您上面的书名，我会使用一个隐藏字段将值包装在 MVC 可以通过的控件中魔术，然后还将该值显示给用户。所以，它可能看起来像：

```
<% for (i = 0; i < Model.Books.Count; i++) {
       book = Model.Books[i] as book //I'm a C# guy so make this VB
<%= Html.CheckBox("author["+1+"].checked_out", book.checked_out) %>
<%= HtmlHidden("author["+i+"].book_name",book.book_name) %>
<%= book.book_name %>
<% } %> 
```

...然后这应该会作为您的 Authors 对象中的图书收藏为您很好地打包回来。看看这是否能让你朝着正确的方向前进。

**编辑** 还有一个想法。我正在使用 UpdateModel 方法来获取结果。没关系，但我想我会把它扔在那里。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-03T15:18:21.210

有关此问题的完整答案，请参见[此处](https://stackoverflow.com/questions/711184/asp-net-mvc-example-of-editing-multiple-child-records)。我基本上不明白 MVC 想要如何命名变量。

# python - 在 Python 中将反斜杠添加到我的 cookie 中

> ID：709937
> 
> 赞同：7
> 
> 时间：2009-04-02T14:29:22.280
> 
> 标签：python

我正在使用 Python 的 SimpleCookie，我遇到了这个问题，我不确定它是否与我的语法有关。此外，这是我的 Python 课程的功课，所以它旨在教授 Python，所以这与我在现实世界中的做法相去甚远。

无论如何，所以基本上我将信息输入保存在 cookie 中的表单中。我正在尝试使用输入的新信息附加到以前的 cookie。但是由于某种原因，在第三次数据输入时，cookie 突然在其中获得了“\”。我不确定他们来自哪里。

这是我得到的输出类型：

> "\"\\"\\\\"test:more\\\\":rttre\\":more\":and more"

```
#!/usr/local/bin/python

import cgi,os,time,Cookie
#error checking
import cgitb
cgitb.enable()

if 'HTTP_COOKIE' in os.environ:
    cookies = os.environ['HTTP_COOKIE']
    cookies = cookies.split('; ')
    for myCookie in cookies:
        myCookie = myCookie.split('=')
        name = myCookie[0]
        value = myCookie[1]
        if name == 'critter' :
            hideMe = value

#import critterClass

#get info from form
form = cgi.FieldStorage()
critterName = form.getvalue('input')
input2 = form.getvalue('input2')
hiddenCookie = form.getvalue('hiddenCookie')
hiddenVar = form.getvalue('hiddenVar')

#make cookie
cookie = Cookie.SimpleCookie()

#set critter Cookie
if critterName is not None:
    cookie['critter'] = critterName
#If already named
else:
    #if action asked, append cookie
    if input2 is not None:
        cookie['critter'] = hideMe+":"+input2
    else:
        cookie['critter'] = "default"

print cookie

print "Content-type: text/html\n\n"

if ((critterName is None) and (input2 is None)):
    print """
    <form name="critter" id="critter" method="post" action="critter.py">
    <label for="name">Name your pet: <input type="text" name="input" id="input" /></label>
    <input type="submit" name="submit" id="submit" value="Submit" />
    </form>
    """
else:
    formTwo ="""
    <form name="critter2" id="critter2" method="post" action="critter.py">
    <label for="name">%s wants to: <input type="text" name="input2" id="input2" /></label>
    <input type="hidden" name="hiddenVar" id="hiddenVar" value="%s" />
    <input type="submit" name="submit" id="submit" value="Submit" />
    </form>
    [name,play,feed,mood,levels,end]
    """
    print formTwo % (critterName,critterName)

if 'HTTP_COOKIE' in os.environ:
    cookies = os.environ['HTTP_COOKIE']
    cookies = cookies.split('; ')
    for myCookie in cookies:
        myCookie = myCookie.split('=')
        name = myCookie[0]
        value = myCookie[1]
        if name == 'critter' :
            print "name"+name
            print "value"+value 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-02T16:28:43.733

正如其他人所解释的，反斜杠正在转义您插入到 cookie 值中的双引号字符。这里起作用的（隐藏的）机制是[`SimpleCookie`](http://docs.python.org/library/cookie.html#Cookie.SimpleCookie)类。该[`BaseCookie.output()`](http://docs.python.org/library/cookie.html#Cookie.BaseCookie.output)方法返回适合作为 HTTP 标头发送的字符串表示形式。它将在双引号字符和**反斜杠字符**之前插入转义字符（反斜杠） 。

这

```
print cookie 
```

语句激活`BaseCookie.output()`。

在您的字符串通过 cookie 的`output()`方法进行的每次行程中，反斜杠都会相乘（从第一对引号开始）。

```
>>> c1=Cookie.SimpleCookie()
>>> c1['name']='A:0'
>>> print c1
Set-Cookie: name="A:0"
>>> c1['name']=r'"A:0"'
>>> print c1
Set-Cookie: name="\"A:0\""
>>> c1['name']=r'"\"A:0\""'
>>> print c1
Set-Cookie: name="\"\\\"A:0\\\"\""
>>> 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-02T14:41:25.090

我不确定，但它看起来像常规的 Python 字符串转义。例如，如果您有一个包含反斜杠或双引号的字符串，Python 通常会以转义形式打印它，以使打印的字符串成为有效的字符串文字。

以下片段说明：

```
>>> a='hell\'s bells, \"my\" \\'
>>> a
'hell\'s bells, "my" \\'
>>> print a
hell's bells, "my" \ 
```

不确定这是否相关，也许有更多领域知识的人可以加入。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-02T14:41:57.617

斜线是由转义双引号引起的。显然，第一次通过时，您的代码会看到双引号，并通过添加反斜杠来转义它。然后它读取转义的反斜杠，并通过在反斜杠前面加上 -- 一个反斜杠来转义反斜杠。然后它读....

当您调用 append 时，问题正在发生。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-04-02T20:07:49.137

正如其他人已经说过的那样，一旦您在 cookie 的末尾添加“和更多”，您就会遇到字符串转义问题。

在此之前，从 SimpleCookie 返回的 cookie 标头不包含引号。（如果 cookie 值中没有空格，则不需要使用引号。）

```
# HTTP cookie header with no spaces in value
Set-Cookie: cookie=value

# HTTP cookie header with spaces in value
Set-Cookie: cookie="value with spaces" 
```

我建议最初使用相同的 SimpleCookie 类来解析 cookie 标头，从而使您免于手动操作，并且还可以正确处理字符串的转义。

```
cookies = Cookie.SimpleCookie(os.environ.get('HTTP_COOKIE', ''))
print cookies['critter'].value 
```

***编辑***：对空格的整个处理不适用于这个问题（尽管在某些情况下它可能会在你不期望它时咬你。）但我使用 SimpleCookie 解析的建议仍然有效。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-04-02T14:42:08.083

反斜杠用于“转义”字符串中原本具有特殊含义的字符，实际上剥夺了它们的特殊含义。经典案例是您可以在带引号的字符串中包含引号的方式，例如：

```
Bob said "Hey!" 
```

可以这样写成字符串：

```
"Bob said \"Hey!\"" 
```

当然，您可能希望在其中使用常规反斜杠，因此“\”仅表示单个反斜杠。

**编辑：**针对您对另一个答案的评论（关于使用正则表达式删除斜杠），我认为您选择了错误的一端。斜线不是问题，它们是一种症状。问题是您正在执行往返处理表示引用字符串的字符串，就好像它们是普通的旧字符串一样。想象一下两个朋友 Bob 和 Sam 正在交谈：

```
Bob:  Hey!
Sam:  Did you say "Hey!"?
Bob:  Did you say "Did you say \"Hey!\"?"? 
```

这就是为什么直到第三次才出现。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-04-03T00:47:27.093

其他人已经指出，这是引号和反斜杠的反斜杠转义的结果。我只是想指出，如果您仔细查看您引用的输出结构，您可以看到这里的结构是如何构建的。

您从中获取的 cookie 值`SimpleCookie`用引号括起来——（未处理的）cookie 具有，例如，

```
`'[...], critter="value1", [...]'` 
```

`', '`在and上拆分后`'='`，您将拥有一个包含 的字符串`"value1"`。然后，您将一个新值附加到该字符串，以便该字符串包含`"value1":value2`.

下一次，你会得到那个字符串，但是用另一组引号包裹它——从概念上讲，`""value1":value2"`. 但是为了使网络浏览器在开头不会看到两个引号字符并认为这就是全部，内部的引号集被转义，所以它实际上返回为`"\"value1\":value2"`.

然后你追加另一个块，在服务器和客户端之间来回传递另一个传递，下一次（因为这些反斜杠现在也需要转义）你得到`"\"\\"value1\\":value2\":value3"`. 等等。

正如已经指出的那样，正确的解决方案是让`SimpleCookie`解析而不是自己切分字符串。

# sharepoint - SharePoint 域和内容查询 Web 部件

> ID：709940
> 
> 赞同：3
> 
> 时间：2009-04-02T14:30:08.813
> 
> 标签：sharepoint, dns, cqwp

我在我们的 moss 服务器上创建了一个新的共享点站点[http://sharepoint:12345](http://sharepoint:12345)并添加了一个 CQWP 没有问题。

我有一个指向同一服务器的域名。所以我指向[http://myinternaldomain.whatever:12345](http://myinternaldomain.whatever:12345)并且由于某种原因 CQWP 然后中断，说无法显示此 Web 部件？

任何想法表示赞赏。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-02T23:03:48.107

您是否为第二个域设置了备用访问映射？

[TechNet 上的 AAM](http://technet.microsoft.com/en-us/library/cc263208.aspx)

# macos - 如何将 Firebug 停靠在浏览器窗口中？

> ID：709941
> 
> 赞同：10
> 
> 时间：2009-04-02T14:30:45.910
> 
> 标签：macos, firefox, firebug

在新窗口中打开后如何将 Firebug 停靠在浏览器窗口中？在 Mac OS X 10.5 上使用 Firefox 3.0.8 和 Firebug 1.3，我无法将其停靠在浏览器窗口中。:(

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2012-11-07T01:07:15.733

如何解决问题

背景：火狐10.0.10

步骤：如果已打开 Firebug，请关闭它 -> 转到 Firefox 菜单 -> 选择“Web 开发人员”选项 -> 从列出的所有选项中选择“Firebug” -> 从所有选项中选择“Firebug UI 位置” -> 选择顶部、按钮、左侧或右侧，取决于您的偏好。

这应该可以解决您的问题。分离的 Firebug 窗口中的“Firebug UI 位置”不起作用。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-02T14:33:38.900

通常，您只需关闭窗口即可。当您再次打开 Firebug 时，它将被停靠。

当我试图弄清楚这一点时，我单击了左上角的错误，而 Firebug 已打开并停靠，并选择了“始终在新窗口中打开”。然后我遇到了同样的问题。

要在 Firebug 作为窗口打开时禁用该选项，请选择查看（在屏幕顶部的 OS X 菜单中，而 Firebug 窗口位于前台）> 选项 > 始终在新窗口中打开。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-04-04T11:03:40.607

单击 Firebug 图标，选择 Firebug UI Location 然后选择底部，它对我有用

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-08-26T20:47:30.820

我有同样的问题。通过以下方式解决：

右键单击状态栏中的萤火虫图标。选择“对所有网页启用”

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-10-10T08:43:31.037

我无法将萤火虫窗口停靠回浏览器窗口。既不是通过按钮，也不是通过菜单。

重置萤火虫设置为我解决了这个问题。幸运的是，我从来没有改变过它们。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-04-02T14:33:29.977

只需关闭萤火虫窗口并再次单击萤火虫图标。它将再次被“停靠”。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2011-01-29T17:46:49.923

这些解决方案都不适合我。不知何故，我的一个萤火虫设置被存储在我的 Firefox 配置文件中，我不知道如何恢复它。所以，我选择了核选项并删除然后重新创建了我的 Firebug 配置文件，遵循 Mozilla 的这些说明：http: [//kb.mozillazine.org/Profile_Manager#Creating_a_new_profile](http://kb.mozillazine.org/Profile_Manager#Creating_a_new_profile)

警告：这应该只是最后的手段，因为它会删除您以前保存的所有设置、附加组件等。这对我来说没什么大不了的，因为我使用 Chrome 作为我的默认浏览器，并且只使用 Firefox 来调试网站使用萤火虫。但对其他人来说，我怀疑这可能是将婴儿与洗澡水一起扔出去，所以只是想明确表示存在权衡。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2012-04-16T14:19:32.010

您可以单击萤火虫窗口最右侧的小叠加双矩形图标，然后停靠和取消停靠萤火虫小部件。

![在此处输入图像描述](https://i.stack.imgur.com/vxYeB.png)

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2014-12-11T05:11:18.910

您可以单击萤火虫窗口最右侧的小叠加双矩形图标，然后停靠和取消停靠萤火虫小部件。

它在 Windows 中对我有用

# vba - 允许用户在 word vba 宏中选择文本

> ID：709943
> 
> 赞同：0
> 
> 时间：2009-04-02T14:31:01.993
> 
> 标签：vba, ms-word

在 VBA for Word 2007 中，我希望能够打开文档、突出显示文本部分并将这些部分替换为链接到文档变量的字段。该过程将是：

1.  打开文档。
2.  选择文本。
3.  从列表中选择 docvariable。
4.  插入链接到所选文档变量的字段。
5.  根据需要重复步骤 1-4。

没有办法事先知道要选择的文本是什么，或者哪个文档变量将链接到哪个字段，或者这些步骤将重复多少次。

只有在微软的帮助下，允许用户在运行时进行选择并将该选择传回子程序的最基本、最简单的任务才能如此曲折和超现实。我花了 2 天时间试图弄清楚这一点。如果有人可以帮忙，我会以你的名字命名我的下一个孩子。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-02T14:55:49.220

我认为“曲折和超现实”是一种误解。

创建一个带有下拉菜单（`"selVarName"`例如名为 ）的小表单，让您可以选择所有可用的文档变量名称。将表单链接到快速访问工具栏中的自定义按钮。

在此表单中单击“确定”后，请执行以下操作：

```
Private Sub btnOK_Click()
  Dim v As Word.Variable
  Dim n As String

  n = Me.selVarName.Value
  With Selection
    For Each v In .Document.Variables
      If v.Name = n Then v.Delete: Exit For
    Next v
    .Document.Variables.Add n, .Range.Text
  End With
End Sub 
```

这已经花里胡哨了。例如，您可以进行附加检查，例如“未选择文本”。

# java - AJAX 使用没有服务器端框架的 REST API

> ID：709947
> 
> 赞同：4
> 
> 时间：2009-04-02T14:32:47.433
> 
> 标签：java, jquery, ruby-on-rails, ajax, rest

我正在构建一个基于 REST 的 API（只读）来访问我的应用程序的服务。我计划编写一个 Web 应用程序，该应用程序将利用这些 API 来提供有关应用程序状态的基本信息。我计划使用 AJAX（使用 jQuery）来显示信息。

最初我计划使用 Grails、Spring MVC、RoR 或其中一个 Web 框架来处理我的应用程序的后端。不过，我将提供的 REST API 已经构建在独立的 REST 框架上，因此我只会将 Web 框架用于核心应用程序，而不是业务逻辑。将来，我可能需要服务器端框架来处理其他任务，但目前大部分工作都在 REST API 中完成。

我的问题是，我应该在服务器端使用 Web 应用程序框架吗？我应该能够直接从浏览器从 AJAX 进行我需要的所有 API 调用。我想不出我需要在服务器端做多少事情。让应用程序成为标准的 HTML + AJAX + REST 有意义吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-02T14:56:02.807

如果不真正了解您当前的设置，很难说。这就是你的情况听起来像：

*   您已经准备好一个包含所有业务逻辑的应用程序。听起来像是用 Java 编写的？
*   您已经使用其他一些独立框架通过 REST api 编写和公开了服务。这意味着如果您愿意，您可以立即使用浏览器访问数据，而无需任何额外工作。
*   您尚未构建 Web 应用程序，但是当您构建时，它将使用 XHR 和 jquery 从 REST api 获取其所有内容。我这么说，因为否则，我认为您已经在使用某种框架来生成其他内容。

如果我的假设是正确的，那么我会说您不需要额外的框架层。Grails、RoR、SpringMVC 我使用 ajax，并帮助公开 REST 服务，但它们提供的大部分功能是创建必须在服务器上生成 html、处理表单提交和处理请求中的会话的应用程序的简单方法/响应周期。听起来你不会做任何这些，它可能会使你的应用程序更加复杂。

如果您确实需要 rails 等提供的东西，我会说您可能不需要使用 rails 来公开您现在拥有的其余 api。您可以仅将 rails 用于您需要的内容，并继续将您拥有的内容用于 REST api。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-02T15:08:46.007

好吧，AJAX 调用需要从某处的服务器中提取数据。如果目标是避免服务器端的复杂设置，CherryPy 可以保持服务器端代码非常小。

我在下面写了一个简单的例子。第一类是放置 ReST API 逻辑的地方。类下面的代码是启动和运行服务器所需的全部内容。

安装 Python 2.6，将下面的代码保存到 restExample.py。然后在您的命令行中通过执行“python restExample.py”运行 python 文件。将您的浏览器指向[http://localhost:8080/blog/999](http://localhost:8080/blog/999)并看到一些 JSON 返回。

```
import cherrypy
import json

# Create the controller
class Blog_Controller(object):
    def get(self, entryID):
        cherrypy.response.headers['Content-Type'] = 'application/json'
        return json.dumps({'title':'Entry Title from DB', 'entry_text': 'Text From DB'})
    def update(self, entryID, titleFromPOSTFormInput, textFromPOSTFormInput):
        # Update DB with passed in arguments.  entryID comes from URL,
        # other two entries come from POST
        cherrypy.response.headers['Content-Type'] = 'application/json'
        return json.dumps({'success':True})

# Setup URL routes
d = cherrypy.dispatch.RoutesDispatcher()
d.connect(name='blog_entry', route='blog/:entryID', action='get',
          controller=Blog_Controller(),
          conditions={'method': ['GET']})
d.connect(name='blog_entry', route='blog/update/:entryID', action='update',
          controller=Blog_Controller(),
          conditions={'method': ['POST']})
config = { '/' : { 'request.dispatch': d } }
cherrypy.tree.mount(root=None, config=config)

# Start the webserver
engine = cherrypy.engine
try:
    engine.start()
except:
    sys.exit(1)
else:
    engine.block() 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-17T19:01:32.853

听起来这对于[带有 Restlet 的 GWT](http://blog.noelios.com/2008/07/25/restlet-ported-to-gwt/ "移植到 GWT 的 Restlet")来说可能是一个很好的用例。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-08-11T21:05:13.500

请原谅我自吹自擂，但如果你正在使用 jQuery 做 AJAX REST 的东西，你应该看看我的 JSON-REST 插件：

[http://plugins.jquery.com/project/rest](http://plugins.jquery.com/project/rest)

如果您要返回 XML，那么这将没有那么有用，但您仍然可以根据您的需要调整一些代码。

# asp.net - 找到具有相同 ID 'add0' 的多个控件。FindControl 要求控件具有唯一的 ID

> ID：709948
> 
> 赞同：4
> 
> 时间：2009-04-02T14:33:06.793
> 
> 标签：asp.net, dynamic, controls, page-lifecycle

以前叫：aspx中如何处理加载下动态创建的控件

回答以下问题：确定要恢复哪些控件所需的信息包含在专用视图状态对象中。

我在代码隐藏页面中动态创建控件 - 这些控件都连接到单击处理程序，因此当发生回发时，我必须重新创建前一组控件，然后清除控件并根据上一次点击。

这在正常情况下编码并正常工作，基本上如下：

```
in Page_Load
if not postback generate default buttons 
else if postback re-generate buttons that were shown on last page

in click_handler
Clear the dynamically generated buttons created in the Page_Load
generate new buttons based on the specific click being handled 
```

但是，当服务器承受负载时，我们开始遇到问题：

每秒有 5 个用户时，我们开始遇到异常： **找到具有相同 ID 'add0' 的多个控件。FindControl 要求控件具有唯一的 ID。**

每秒有 100 个用户时，我们开始遇到异常： **在 DataBind、Init、Load、PreRender 或 Unload 阶段无法修改控件集合。**

一旦发生这种情况，所有后续请求都会收到相同的错误，并且必须重新启动 IIS。

可能是什么原因造成的，我该如何避免？html 请求在负载下是否可能会相互覆盖和干扰？页面卸载后对象是否以某种方式传递，从而允许下一页加载绊倒它们？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-02T15:07:43.387

您如何存储有关您需要恢复的控件的信息？如果您使用 ViewState 或 ControlState，那么我看不出负载会如何影响事物。这就是任何复合控​​件的工作方式。

我会说我在使用 Infragistics UltraWebGrid 时看到了您的第二个错误，但一直无法追踪到它。从调用堆栈看来，EnsureChildControls 似乎是在加载阶段（或者可能是 LoadViewState）被调用的。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-03T14:03:16.210

一个私有静态变量用于存储名称和表格单元格的字典，以便在页面生命周期中不会重新创建表格单元格。

关键是它被标记为静态 - 它应该是一个实例变量 - 最终结果是当请求开始备份时在负载下，然后多个请求共享这个静态字典。

究竟发生了什么我不是 100% 确定 - 但在中等负载下 FindControl 会找到多个同名控件，在非常高的负载下似乎一个请求会尝试修改一个控件（可能添加到它），而它在来自其他请求的无效状态。

最终结果——如果你真的不知道你在做什么——更喜欢实例变量而不是静态变量。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-03T00:14:42.803

你所写的一切似乎都是正确和可行的。这很可能是您的控件生成代码的问题。也许如果您发布其中的一些内容，我们可以更好地找到解决方案。

# hadoop - AWS 上的 MapReduce

> ID：709949
> 
> 赞同：5
> 
> 时间：2009-04-02T14:33:08.167
> 
> 标签：hadoop, amazon-web-services, mapreduce

有人在 AWS 上玩过 MapReduce 吗？有什么想法吗？执行情况如何？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-04-03T06:27:43.827

很容易上手。

这是一个常见问题解答： http: [//aws.amazon.com/elasticmapreduce/faqs/](http://aws.amazon.com/elasticmapreduce/faqs/)

这是入门指南：[http ://docs.amazonwebservices.com/ElasticMapReduce/latest/GettingStartedGuide/](http://docs.amazonwebservices.com/ElasticMapReduce/latest/GettingStartedGuide/)

如果您已经拥有 EC2 账户，则可以使用 AWS 管理控制台启用 MapReduce 并在 10 分钟内启动并运行示例应用程序。

我做了预先打包的 Word Count 示例应用程序，它返回包含在大约 20 MB 文本中的每个单词的计数。您最多可以配置 20 个实例以同时运行，尽管我只使用了 2 个实例，并且作业在大约 3 分钟内完成。

该作业返回一个 300 KB 按字母顺序排列的单词列表以及每个单词在样本语料库中出现的频率。

我真的很喜欢 MapReduce 作业可以用我选择的 Perl、Python、Ruby、PHP、C++、R 或 Java 来编写。该过程轻松而直接，并且界面对您的实例状态和工作流程提供了良好的反馈。

请注意，由于 AWS 在创建实例时会按一小时收费，而且 MapReduce 实例会在作业流程结束时自动终止，因此多个快速运行的作业流程的成本可能会迅速增加。

例如，如果我创建一个使用 20 个实例并在 15 分钟内返回结果的作业流，然后再重新运行该作业流 3 次，即使我只有 20 个实例，我仍将按 80 小时的机器时间收费运行1小时。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-04-05T23:29:58.150

您还可以使用[StarCluster](http://web.mit.edu/star/cluster/)在 AWS 上运行 MapReduce (Hadoop) 。此工具为您配置集群，其优势在于您无需支付额外的 Amazon Elastic MapReduce 价格（如果您想降低成本），您可以使用您的工具创建自己的映像 (AMI)（这可以如果工具的安装不能通过引导脚本完成，那就太好了）。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2010-01-11T07:49:46.760

这非常方便，因为您不必管理自己的集群。您只需按使用付费，因此我认为如果您有一份需要不时运行的工作是个好主意。我们每月只运行一次 Amazon MapReduce，因此对于我们的使用而言，这是值得的。

但是，据我所知，Amazon Map Reduce 的一个缺点是您无法分辨正在运行的操作系统，甚至是其版本。这导致我在运行使用 g++ 4.44 编译的 c++ 代码时出现问题，某些操作系统映像不支持 cUrl 库等。

如果您的用例不需要任何特殊库，我会说去吧。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-10-17T21:28:57.450

此外，根据您计划运行的作业类型/持续时间，您可以将[AWS Spot 实例与 EMR 结合使用以获得更好的定价。](http://aws.typepad.com/aws/2011/08/run-amazon-elastic-mapreduce-on-ec2-spot-instances.html)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2011-07-27T03:32:51.277

MB的好答案。

需要明确的是：您可以通过两种方式运行 Hadoop 集群：1) 在 Amazon EC2 实例上运行它。这意味着您必须安装、配置、终止它等。 2) 使用 Elastic MapReduce 或 EMR 运行它：这是在 Amazon Web Services 上运行 Hadoop 集群的一种自动化方式。除了 EC2 的基本成本外，您还需要支付一点额外费用，但您不需要管理任何东西：只需上传数据，然后上传算法，然后进行处理。作业完成后，EMR 将自动关闭实例。

最好的，

西蒙娜

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-04-25T05:47:00.103

EMR 是使用可用资源的最佳方式，与 EC2 相比增加了很少的成本，但是您将知道它是多么节省时间和容易。云上的大多数 MR 实施都使用这种模型，即 Windows Azure 上的 Apache Hadoop、Mortar Data 等。我曾在 Windows Azure 上使用过 Amazon EMR 和 Apache Hadoop，发现使用起来非常棒。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2014-04-27T23:51:07.220

我正在使用 AWS EMR。它很整洁。我的意思是一旦你启动他们的集群并登录到他们的主节点。您可以使用 hadoop 目录结构。做一些很酷的事情。如果你有一个 edu 帐户，别忘了申请研究资助。他们提供 100 美元的免费积分来使用他们的 AWS。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2015-07-20T00:11:55.613

当您将 S3 存储用于数据时，AWS EMR 是一个不错的选择。它提供与 S3 的开箱即用集成，用于加载文件和发布已处理的文件。在您需要按需运行作业的用例中，您可以从始终运行整个集群的成本中节省下来，这确实可以帮助您节省实例时间。利用上述优势，可以使用 AWS lambda 生成事件驱动的集群。

# c# - 可以获得 C# 代表的 MSIL 吗？

> ID：709957
> 
> 赞同：3
> 
> 时间：2009-04-02T14:35:00.097
> 
> 标签：c#, cil

只是出于好奇......是否可以以编程方式获取代表的 MSIL？我很好奇，因为我一直在玩弄分布式计算系统的想法，您可以在其中简单地编写程序，并且程序本身将分发到将发生工作的每个不同节点。我知道你可以通过在网络上复制实际的程序集并将其加载到 appdomain 中来做到这一点，但我认为拥有一个更简单的模型会非常有趣。

谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-02T14:40:33.627

如何将程序集复制到另一台机器并将其加载到 appdomain 中，这比您考虑的解​​决方案更复杂？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-02T14:56:56.457

委托代码的依赖关系如何——这可能使用 CodeDom 反射发射来工作，但是如果委托调用自身外部的任何内容（甚至是框架代码），你将如何确保它存在于目标机器上？大量的 Assembly.Load() 代码？

顺便说一句：如果你按照这些思路构建一个动态变化的分布式系统，你不会让我维护或操作它！想象一下做故障隔离或尝试做任何事情，比如综合测试......

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-02T14:36:49.437

您可以使用[Reflector](http://www.red-gate.com/products/reflector/)或[ILDASM（MSIL 反汇编程序）](http://msdn.microsoft.com/en-us/library/f7dy01k1(VS.80).aspx)来获取任何 .NET 程序集中的任何成员的 IL。

# language-agnostic - 寻路算法：如何有效地处理权重变化

> ID：709959
> 
> 赞同：0
> 
> 时间：2009-04-02T14:36:13.353
> 
> 标签：language-agnostic, path-finding

所以，我有一个简单的寻路算法，它预先计算到几个目标端点的最短路径，每个目标端点都有不同的权重。这在某种程度上等同于在一个端点和每个端点之间有一个节点，尽管那里的边具有不同的权重。它使用的算法是一种简单的传播算法，在 1d 中看起来是这样的（| 表示墙，- 表示空间）：

*   `5 - - - 3 | - - - 2 - - - - 2`
*   `5 4 - - 3 | - - - 2 - - - - 2 : Handled distance 5 nodes`
*   `5 4 3 - 3 | - - - 2 - - - - 2 : Handled distance 4 nodes`
*   `5 4 3 2 3 | - - - 2 - - - - 2 : Handled distance 3 nodes`
*   `5 4 3 2 3 | - - 1 2 1 - - 1 2 : Handled distance 2 nodes`
*   `Done. Any remaining rooms are unreachable.`

所以，假设我有一个像这样的预先计算的寻路解决方案，其中只有 5 个是目标：

`- - - - | 5 4 3 2 1 -`

如果我把墙改成房间。重新计算很简单。只需重新处理所有距离节点（但忽略已经存在的节点）。但是，我无法找到一种有效的方法来处理如果 4 变成一堵墙该怎么办。显然结果是这样的：

`- - - - | 5 | - - - -`

但是，在二维解决方案中，我不确定如何有效地处理 4。很容易存储 4 依赖于 5，因此需要重新计算，但是如何安全地确定它的新依赖项和值？我宁愿避免重新计算整个数组。

一种总比没有好的解决方案是（大致）仅重新计算距 5 的曼哈顿距离为 5 的数组元素，并维护源信息。这基本上意味着将算法重新应用于选定区域但是我可以做得更好吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-02T15:48:01.693

嗯。我想出的一个解决方案是：保留从每个节点最快可达的节点列表。如果一个节点变成了一堵墙，检查它可以从哪个节点到达并获取相应的列表。然后使用标准算法重新检查所有这些节点。当到达新距离较小的节点时，将其标记为需要重新测试。

取所有未标记的标记节点的邻居，并在它们上重新应用算法，忽略该技术命中的任何标记节点。如果重新应用的算法增加了标记节点的值，则使用新值。

# java - 确定对象是否为原始类型

> ID：709961
> 
> 赞同：125
> 
> 时间：2009-04-02T14:36:28.330
> 
> 标签：java, reflection

我有一个`Object[]`数组，我试图找到那些是原语的。我试过使用`Class.isPrimitive()`，但似乎我做错了什么：

```
int i = 3;
Object o = i;

System.out.println(o.getClass().getName() + ", " +
                   o.getClass().isPrimitive()); 
```

打印`java.lang.Integer, false`。

有正确的方法或替代方法吗？

* * *

## 回答 #1

> 赞同：172
> 
> 时间：2009-04-02T14:40:22.550

an 中的类型`Object[]`永远不会*是*原始的——因为你有引用！这里的类型`i`是`int`，而被引用的对象的类型`o`是`Integer`（由于自动装箱）。

听起来您需要确定该类型是否是“原始包装器”。我认为标准库中没有为此内置任何内容，但很容易编写代码：

```
import java.util.*;

public class Test
{
    public static void main(String[] args)        
    {
        System.out.println(isWrapperType(String.class));
        System.out.println(isWrapperType(Integer.class));
    }

    private static final Set<Class<?>> WRAPPER_TYPES = getWrapperTypes();

    public static boolean isWrapperType(Class<?> clazz)
    {
        return WRAPPER_TYPES.contains(clazz);
    }

    private static Set<Class<?>> getWrapperTypes()
    {
        Set<Class<?>> ret = new HashSet<Class<?>>();
        ret.add(Boolean.class);
        ret.add(Character.class);
        ret.add(Byte.class);
        ret.add(Short.class);
        ret.add(Integer.class);
        ret.add(Long.class);
        ret.add(Float.class);
        ret.add(Double.class);
        ret.add(Void.class);
        return ret;
    }
} 
```

* * *

## 回答 #2

> 赞同：93
> 
> 时间：2010-09-30T14:21:50.790

[commons-lang](http://commons.apache.org/lang/) [`ClassUtils`](http://commons.apache.org/proper/commons-lang/apidocs/org/apache/commons/lang3/ClassUtils.html)有相关*方法*。

新版本有：

```
boolean isPrimitiveOrWrapped = 
    ClassUtils.isPrimitiveOrWrapper(object.getClass()); 
```

旧版本有`wrapperToPrimitive(clazz)`方法，它将返回*原始*对应关系。

```
boolean isPrimitiveOrWrapped = 
    clazz.isPrimitive() || ClassUtils.wrapperToPrimitive(clazz) != null; 
```

* * *

## 回答 #3

> 赞同：26
> 
> 时间：2012-01-31T15:07:03.103

Google 的 Guava 库有一个[Primitives 实用程序](https://guava.dev/releases/snapshot-jre/api/docs/com/google/common/primitives/Primitives.html)，可以检查一个类是否是一个原始的包装类型：[`Primitives.isWrapperType(class)`](https://guava.dev/releases/snapshot-jre/api/docs/com/google/common/primitives/Primitives.html#isWrapperType-java.lang.Class-).

Class.isPrimitive() 适用于基元

* * *

## 回答 #4

> 赞同：18
> 
> 时间：2009-04-02T19:28:57.153

对于那些喜欢简洁代码的人。

```
private static final Set<Class> WRAPPER_TYPES = new HashSet(Arrays.asList(
    Boolean.class, Character.class, Byte.class, Short.class, Integer.class, Long.class, Float.class, Double.class, Void.class));
public static boolean isWrapperType(Class clazz) {
    return WRAPPER_TYPES.contains(clazz);
} 
```

* * *

## 回答 #5

> 赞同：8
> 
> 时间：2009-04-02T14:42:18.067

从 Java 1.5 及更高版本开始，有一个称为自动装箱的新功能。编译器自己做这件事。当它看到机会时，它会将原始类型转换为其适当的包装类。

这里可能发生的事情是当你声明

```
Object o = i; 
```

编译器会将这条语句编译为

```
Object o = Integer.valueOf(i); 
```

这是自动装箱。这将解释您收到的输出。[Java 1.5 规范中的这个页面更详细地解释了自动装箱。](http://java.sun.com/j2se/1.5.0/docs/guide/language/autoboxing.html)

* * *

## 回答 #6

> 赞同：7
> 
> 时间：2009-04-02T14:42:46.427

我认为这是由于*自动装箱*而发生的。

```
int i = 3;
Object o = i;
o.getClass().getName(); // prints Integer 
```

您可以实现与这些特定装箱类匹配的实用方法，并在某个类是原始类时为您提供。

```
public static boolean isWrapperType(Class<?> clazz) {
    return clazz.equals(Boolean.class) || 
        clazz.equals(Integer.class) ||
        clazz.equals(Character.class) ||
        clazz.equals(Byte.class) ||
        clazz.equals(Short.class) ||
        clazz.equals(Double.class) ||
        clazz.equals(Long.class) ||
        clazz.equals(Float.class);
} 
```

* * *

## 回答 #7

> 赞同：6
> 
> 时间：2009-04-02T14:41:10.190

`Integer`不是原始人，`Class.isPrimitive()`不是说谎。

* * *

## 回答 #8

> 赞同：6
> 
> 时间：2017-09-21T14:59:41.257

```
public static boolean isValidType(Class<?> retType)
{
    if (retType.isPrimitive() && retType != void.class) return true;
    if (Number.class.isAssignableFrom(retType)) return true;
    if (AbstractCode.class.isAssignableFrom(retType)) return true;
    if (Boolean.class == retType) return true;
    if (Character.class == retType) return true;
    if (String.class == retType) return true;
    if (Date.class.isAssignableFrom(retType)) return true;
    if (byte[].class.isAssignableFrom(retType)) return true;
    if (Enum.class.isAssignableFrom(retType)) return true;
    return false;
} 
```

* * *

## 回答 #9

> 赞同：5
> 
> 时间：2009-04-02T14:49:28.813

你必须处理java的自动装箱。
让我们拿代码

```
公开课测试
{
    公共静态无效主要（字符串[]参数）
    {
        诠释 i = 3;
        对象 o = i;
        返回;
    }
}
```

你得到类 test.class 和*javap -c test*让你检查生成的字节码。

```
编译自“test.java”
公共类测试扩展 java.lang.Object{
公共测试（）；
  代码：
   0：aload_0
   1：调用特殊#1；//方法 java/lang/Object."":()V
   4：返回公共静态无效主（java.lang.String[]）；
  代码：
   0：iconst_3
   1：istore_1
   2：iload_1
   3：调用静态#2；//方法 java/lang/Integer.valueOf:(I)Ljava/lang/Integer;
   6：astore_2
   7：返回

}
```

如您所见，添加了 java 编译器

```
调用静态 #2; //方法 java/lang/Integer.valueOf:(I)Ljava/lang/Integer;
```

从您的 int 创建一个新的整数，然后通过 astore_2*将该新对象存储在 o 中*

* * *

## 回答 #10

> 赞同：3
> 
> 时间：2009-04-02T14:53:44.000

这样您就可以看到 isPrimitive 有可能返回 true （因为您有足够的答案向您展示为什么它是错误的）：

```
public class Main
{
    public static void main(final String[] argv)
    {
        final Class clazz;

        clazz = int.class;
        System.out.println(clazz.isPrimitive());
    }
} 
```

当方法采用“int”而不是“Integer”时，这在反思中很重要。

此代码有效：

```
import java.lang.reflect.Method;

public class Main
{
    public static void main(final String[] argv)
        throws Exception
    {
        final Method method;

        method = Main.class.getDeclaredMethod("foo", int.class);
    }

    public static void foo(final int x)
    {
    }
} 
```

此代码失败（找不到方法）：

```
import java.lang.reflect.Method;

public class Main
{
    public static void main(final String[] argv)
        throws Exception
    {
        final Method method;

        method = Main.class.getDeclaredMethod("foo", Integer.class);
    }

    public static void foo(final int x)
    {
    }
} 
```

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2009-04-02T14:50:35.677

正如几个人已经说过的，这是由于[autoboxing](http://java.sun.com/j2se/1.5.0/docs/guide/language/autoboxing.html)。

您*可以*创建一个实用方法来检查对象的类是否是`Integer`,`Double`等。但是**无法知道对象是否是通过自动装箱创建的**；一旦它被装箱，它看起来就像一个明确创建的对象。

因此，除非您确定您的数组在没有自动装箱的情况下永远不会包含包装类，否则没有真正的解决方案。

* * *

## 回答 #12

> 赞同：2
> 
> 时间：2009-04-02T14:56:32.480

原始包装器类型不会响应此值。这是用于基元的类表示，尽管除了反射之外，我想不出它有太多的用途。所以，例如

```
System.out.println(Integer.class.isPrimitive()); 
```

打印“假”，但

```
public static void main (String args[]) throws Exception
{
    Method m = Junk.class.getMethod( "a",null);
    System.out.println( m.getReturnType().isPrimitive());
}

public static int a()
{
    return 1;
} 
```

打印“真实”

* * *

## 回答 #13

> 赞同：2
> 
> 时间：2015-12-31T19:08:53.420

我迟到了，但如果你正在测试一个领域，你可以使用`getGenericType`：

```
import static org.junit.Assert.*;

import java.lang.reflect.Field;
import java.lang.reflect.Type;
import java.util.Arrays;
import java.util.Collection;
import java.util.HashSet;

import org.junit.Test;

public class PrimitiveVsObjectTest {

    private static final Collection<String> PRIMITIVE_TYPES = 
            new HashSet<>(Arrays.asList("byte", "short", "int", "long", "float", "double", "boolean", "char"));

    private static boolean isPrimitive(Type type) {
        return PRIMITIVE_TYPES.contains(type.getTypeName());
    }

    public int i1 = 34;
    public Integer i2 = 34;

    @Test
    public void primitive_type() throws NoSuchFieldException, SecurityException {
        Field i1Field = PrimitiveVsObjectTest.class.getField("i1");
        Type genericType1 = i1Field.getGenericType();
        assertEquals("int", genericType1.getTypeName());
        assertNotEquals("java.lang.Integer", genericType1.getTypeName());
        assertTrue(isPrimitive(genericType1));
    }

    @Test
    public void object_type() throws NoSuchFieldException, SecurityException {
        Field i2Field = PrimitiveVsObjectTest.class.getField("i2");
        Type genericType2 = i2Field.getGenericType();
        assertEquals("java.lang.Integer", genericType2.getTypeName());
        assertNotEquals("int", genericType2.getTypeName());
        assertFalse(isPrimitive(genericType2));
    }
} 
```

[Oracle 文档](http://docs.oracle.com/javase/tutorial/java/nutsandbolts/datatypes.html)列出了 8 种原始类型。

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2010-09-30T14:14:18.610

[从 Spring http://static.springsource.org/spring/docs/3.0.x/javadoc-api/](http://static.springsource.org/spring/docs/3.0.x/javadoc-api/)获取 BeanUtils

Apache 变体（commons bean）可能具有类似的功能。

* * *

## 回答 #15

> 赞同：1
> 
> 时间：2013-05-27T18:29:25.927

这是我能想到的最简单的方法。包装类仅存在于`java.lang`包中。除了包装类之外，没有其他类`java.lang`具有名为`TYPE`. 您可以使用它来检查一个类是否是 Wrapper 类。

```
public static boolean isBoxingClass(Class<?> clazz)
{
    String pack = clazz.getPackage().getName();
    if(!"java.lang".equals(pack)) 
        return false;
    try 
    {
        clazz.getField("TYPE");
    } 
    catch (NoSuchFieldException e) 
    {
        return false;
    }           
    return true;        
} 
```

* * *

## 回答 #16

> 赞同：1
> 
> 时间：2016-08-17T08:24:56.077

您可以通过以下语句确定对象是否为包装器类型：

```
***objClass.isAssignableFrom(Number.class);*** 
```

您还可以使用 isPrimitive() 方法确定原始对象

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2012-10-01T09:29:42.743

```
public class CheckPrimitve {
    public static void main(String[] args) {
        int i = 3;
        Object o = i;
        System.out.println(o.getClass().getSimpleName().equals("Integer"));
        Field[] fields = o.getClass().getFields();
        for(Field field:fields) {
            System.out.println(field.getType());
        }
    }
}  

Output:
true
int
int
class java.lang.Class
int 
```

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2019-10-01T09:24:37.977

对于[javapoet](https://github.com/square/javapoet/)的用户，还有这种方式：

```
private boolean isBoxedPrimitive(Class<?> type) {
    return TypeName.get(type).isBoxedPrimitive();
} 
```

# javascript - $(d).attr("id") 是未定义的javascript

> ID：709966
> 
> 赞同：0
> 
> 时间：2009-04-02T14:38:55.110
> 
> 标签：javascript, jquery, firebug

我有一个像这样使用的变量 d：

```
$(function() {  
    for(i = 1; i <= 31; i++) {
        var d = '#days' + i;    
        if ($(d).attr("id").substr(4,2) == 11) {
            $(d).addClass("date_has_event");
            //console.log("diez");
        } else {
            console.log("otro");
        }
    }
} 
```

但是我在萤火虫中收到以下错误：

```
$(d).attr("id") 未定义
index.html (L23) (?)()()
jquery.min.js (L27) onreadystatechange()()
jquery.min.js (L27) onreadystatechange()()
jquery.min.js (L21) nodeName()([function(), function()], function(), undefined)
onreadystatechange()()

```

我真的不明白为什么。有人知道吗？

* * *

**编辑**

对于我不得不运行的糟糕的解释，我很抱歉，这里的情况会更详细一些。我正在使用 javascript 生成日历。每个 td 都有不同的 id（因此是#days + i），我从 1 到 31 运行它，这样我可以覆盖更长的月份。但是我收到了上面提到的错误。我还使用 jQuery 库让我能够更轻松地选择（即，而不是 getElementById 只是#days）

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-04-02T14:49:28.830

为什么不检查 if `i == 11`，然后对其进行处理？它仍然只会开火`$('#days11')`。编辑：如果您需要确保元素也存在，只需将其添加到条件中即可。

```
$(function(){   
    for(i = 1; i <= 31; i++){
        var d = '#days' + i;    

//       if($(d) && i == 11){            
         if(i == 11){
               $(d).addClass("date_has_event");
               //console.log("diez");
         }else{
               console.log("otro");
         }
    }
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-02T14:49:34.773

好的，新的答案。你这样做的方式不是很“jqueryish”。让我们退后一点。据我所知，你有一个类似的 html 结构：

```
<div id="days1"></div>
<div id="days2"></div>
... 
```

然后，您要对具有 days(num) id 的每个项目运行此操作？一个更好的解决方案是，如果你想为每个带有日期的元素添加一个类，首先应用一个类：

```
<div class="days"></div>
<div class="days"></div> 
```

然后您的代码可以是

```
$(function(){
    $(".days").each(function(i){
        if($(this).substr(4,2) == 11){
            $(this).addClass("date_has_event");
        }
    });  
}); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-02T14:58:11.960

由于您是按 id 选择的，因此这是多余的：

```
if ($(d).attr("id").substr(4,2) == 11) 
```

因为 d 的 ID 属性**是**d。

最简单的做法：

```
if (i == 11) 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-02T15:09:14.383

缺少右括号？

```
$(function() {  
    for(i = 1; i <= 31; i++) {
        var d = '#days' + i;    
        if (i == 11) {
            $(d).addClass("date_has_event");
            //console.log("diez");
        } else {
            console.log("otro");
        }
    }
// shouldn't the next line be });
} 
```

# svn - 你如何阻止 SVN Checkout 带回从项目中删除的文件？

> ID：709968
> 
> 赞同：3
> 
> 时间：2009-04-02T14:39:08.060
> 
> 标签：svn, ankhsvn

我们是 subversion、tortoisesvn、ankhsvn 堆栈的新手。在 Studio 2008 中，我们从项目中删除了文件，问题是当我们在 CI 构建中执行 svn checkout 时，我们得到了已删除的文件。如何防止这些文件包含在结帐中？

提前致谢。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-04-02T14:41:47.147

您需要在 Subversion 中删除它们。从 TortoiseSVN 菜单中，选择“删除”，然后提交删除。在命令行上，您可以使用`svn rm <filename>`，然后提交。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-02T14:42:27.117

确保你已经完成了 SVN 删除（Ankh 在通过 VS 删除文件时应该提供这个选项，或者你可以在资源管理器中使用 Tortoise 手动完成）。一旦您提交了该更改，该文件将不会成为 SVN 中的主要版本的一部分。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-02T16:32:17.330

在 Visual Studio 中，“删除”和“删除”是有区别的。删除是在 C# 项目中按“del”键时的默认操作；在 C++ 项目中，默认值为“删除”。

在删除事件的情况下，AnkhSVN 不会 svn 删除文件，因为没有安装 AnkhSVN，VS 也不会从磁盘中删除它。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-02T14:41:54.900

仅从项目中删除文件是不够的：SVN 对“项目”一无所知，它只知道工作副本中的文件，因此您必须从资源管理器中“物理地”删除这些文件，然后提交更改。

# java - 在 Hibernate 中使用 @SecondaryTable 的问题

> ID：709970
> 
> 赞同：1
> 
> 时间：2009-04-02T14:40:08.370
> 
> 标签：java, hibernate, jpa

我的架构的精简版：

```
utility_company
id int not null -- PK
name varchar(255) not null

utility_settings
utility_id -- FK to utility
use_magic tinyint(1) not null default 0 
```

这两个表之间存在一对一的映射关系。撇开这种设计的适用性不谈，我想将这两个表中的数据映射到一个对象。在 Hibernate/JPA 中，据称这样做如下：

```
@Entity
@Table(name = "utility_company")
@SecondaryTables({
    @SecondaryTable(
        name = "utility_settings", 
        pkJoinColumns = {
            @PrimaryKeyJoinColumn(
                name="utility_id", referencedColumnName="id")
        })
})
public class UtilityCompany extends AbstractEntity { 
```

等等。

每个都`@Column`包含适当的表名。

部署时，我收到此错误：

```
Cannot find the expected secondary table: 
no utility_company available for poscore.model.UtilityCompany 
```

该`utility_company`表肯定存在（以前的版本仅映射`UtilityCompany`到该`utility_company`表；我正在添加`utility_settings`）。

发现许多论坛帖子都有这个确切的问题但没有答案。我还尝试了各种据称合法的形式来指定`@SecondaryTable`所有这些都具有相同的效果。

任何人成功使用`@SecondaryTable`，如果是这样，看到了吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2011-03-11T14:36:56.513

“每个@Column 都包含适当的表名。”

尝试删除第一个表名列的显式表名，只为辅助表列指定它。为我做了诀窍。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-04T13:45:12.690

您的映射是正确的恕我直言，并且使用[DataNucleus AccessPlatform](http://www.datanucleus.org/products/accessplatform)作为 JPA 实现运行良好。也许 Hibernates 日志会告诉你更多信息？

——Andy [DataNucleus](http://www.datanucleus.org)

# windows - 如何在 windows 中使用 echo 命令删除文本文件的最后一行？

> ID：709978
> 
> 赞同：0
> 
> 时间：2009-04-02T14:41:05.450
> 
> 标签：windows, echo

如何在 windows 中使用 echo 命令删除文本文件的最后一行？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-02T14:43:22.527

Echo 只有两种用途：

> 回声 [开 | 关]
> ECHO [消息]

您可以使用重定向完全覆盖文件

```
ECHO Testing > a.txt 
```

或者您可以使用附加重定向附加到文件

```
ECHO Testing >> a.txt 
```

或者你可以写一个新行

```
ECHO. 
```

但是你不能用它来删除最后一行

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-02T14:52:48.010

寻找一个'tail'命令/等效项（根据操作系统版本在谷歌上有很多）。

然后

复制旧文件临时文件

尾 -1 > 旧文件

问候迈克尔。

# datetime - 如何将日期时间转换为 dd-mmm-yyyy 日期格式？

> ID：709982
> 
> 赞同：0
> 
> 时间：2009-04-02T14:41:47.913
> 
> 标签：datetime, infragistics

我正在使用`Webdatechooser<<Infragistics control>>`一个采用日期时间的列。我需要将输入的值（通过 Webdatechooser）转换为 dd-mmm-format。

我可以为此提供片段吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-02T14:48:46.710

该值是一个 DateTime 对象，因此您可以使用该对象的 ToString 函数来生成所需的输出。

```
((DateTime)WebDateChooser1.Value).ToString("dd-MMM-yyyy"); 
```

应该这样做。

# php - PHP：购买两者并节省 50 美元？

> ID：709998
> 
> 赞同：0
> 
> 时间：2009-04-02T14:45:50.023
> 
> 标签：php, php4

好的，我的客户想要在购物车中显示同时购买的功能，如果他们在购物车中有 1 个特定的商品类型，他们希望它显示为另一种特定的商品类型，因此如果他们同时购买，他们可以节省 50 美元的总费用。我正在努力思考什么是设置它的最佳方式，这样它就不容易被黑客入侵（即：将两者都添加到购物车中，然后删除一个并保留折扣）

有人在理论上有一些一般的想法吗？

谢谢。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-04-02T14:48:44.900

为什么不在他们提交订单之前进行检查呢？这样，每次他们进入提交订单页面时，它都会检查这两个项目是否都存在。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-02T14:50:18.873

很容易 - 总是根据当前购物车内容即时计算最终价格。您提到的问题似乎只有在您计算最终价格并以某种方式缓存时才会成为问题。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-02T14:49:40.310

通常它是通过创建一个新的捆绑项目来完成的。它有点脏但有效:)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-02T14:49:05.837

他们是否已经在使用系统，或者这是您的自定义工作？

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-02T15:26:35.240

将折扣添加到购物车并使用另一个表来跟踪折扣的相关性。每当从购物车中删除商品时，请检查以确保折扣仍然有效。如果是，那就太好了。如果没有，请将其删除并重新计算购物车价格。***************