# StackOverflow 问答 10454000-10454999

# postgresql - PostgreSQL COPY 可以从远程位置读取 CSV 吗？

> ID：10454002
> 
> 赞同：5
> 
> 时间：2012-05-04T18:12:16.377
> 
> 标签：postgresql, jdbc

我一直在使用带有本地 Postgres DB 的 JDBC，使用 Postgres COPY 命令将数据从 CSV 文件复制到数据库中。我使用 Java 将现有的 CSV 文件解析为与数据库中的表匹配的 CSV 格式。然后我将这个解析的 CSV 保存到我的本地磁盘。然后我让 JDBC 使用解析后的 CSV 对我的本地数据库执行 COPY 命令。一切都按预期工作。现在我正在尝试使用 JDBC 在远程服务器上的 Postgres DB 上执行相同的过程。但是，当 JDBC 尝试执行 COPY 我得到

```
org.postgresql.util.PSQLException: ERROR: could not open file "C:\data\datafile.csv" for reading: No such file or directory 
```

我是否正确理解 COPY 命令告诉数据库在本地查找此文件？IE 远程服务器正在查看其 C: 驱动器（不存在）。

如果是这种情况，是否有指示复制命令在我的计算机上查看而不是在远程计算机上“本地”查看？通读副本文档，我没有找到任何表明此功能的内容。

如果该功能不存在，我只想在本地填充整个数据库，然后将数据库复制到远程服务器，但只是想检查一下我没有遗漏任何东西。

谢谢你的帮助。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-04T18:23:24.513

在您的客户端计算机上按如下方式创建您的 sql 文件

```
COPY testtable (column1, c2, c3) FROM STDIN WITH CSV;
1,2,3
4,5,6
\. 
```

然后在您的客户端上执行

psql -U postgres -f /mylocaldrive/copy.sql -h remoteserver.example.com

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-05-04T18:22:26.443

如果您使用 JDBC，最好的解决方案是使用 PostgreSQL COPY API [http://jdbc.postgresql.org/documentation/publicapi/org/postgresql/copy/CopyManager.html](http://jdbc.postgresql.org/documentation/publicapi/org/postgresql/copy/CopyManager.html)

否则（正如其他人已经指出的那样），您可以使用 psql 中的 \copy ，它允许访问客户端计算机上的本地文件

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-04T18:17:19.450

据我所知，该`COPY`命令只能用于从运行数据库的机器本地读取（从标准输入或从文件）。

您可以制作一个 shell 脚本，在其中运行 java 转换，然后用于[`psql`](http://www.postgresql.org/docs/9.1/interactive/app-psql.html)执行命令，该命令从*客户端*计算机`\copy`上的文件中读取。

# javascript - 带有 iframe 的颜色框关闭按钮

> ID：10454004
> 
> 赞同：2
> 
> 时间：2012-05-04T18:12:25.617
> 
> 标签：javascript, jquery, css, colorbox

我正在为模态弹出窗口使用颜色框，并且弹出窗口的内容来自 URL，因为它显示在 iFrame 中，如何向模态弹出窗口添加关闭按钮？

谢谢

这是彩盒的代码

```
<a class="Modal" href="http://google.com" onclick="openModal();">Click here</a> 
```

和js：

```
var openModal = function (){        
     $(".Modal").colorbox({
         iframe:true, 
         opacity:0.5, 
         scrolling:true, 
         width:832, 
         height:456, 
         top:60
     });
} 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-05-04T18:26:57.333

尝试将此添加到`colorbox-iframe.html`

```
<input type="button" name="btnClose" value="Close" onclick="parent.$.colorbox.close()" /> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-04T22:21:12.830

我以前从未使用过颜色框，但也许您想通过 jQuery 在您的函数中添加关闭按钮：

```
var openModal = function (){        
     $(".Modal").colorbox({
         iframe:true, 
         opacity:0.5, 
         scrolling:true, 
         width:832, 
         height:456, 
         top:60
     });

     $("<div class='thisClosesTheModal'>Close Modal</div>").appendTo(".Modal");
     // style .thisClosesTheModal to look like a close box
}

// and then the function that closes the modal

$(".thisClosesTheModal").live('click', function(){

   $('Modal').hide();

} 
```

# wpf - WPF 绑定和 MemberwiseClone 问题

> ID：10454007
> 
> 赞同：0
> 
> 时间：2012-05-04T18:12:42.903
> 
> 标签：wpf, binding, clone, observablecollection

我正在开发一个 WPF 项目，并实现了一种非常简单的方法来撤消一个级别的更改，该更改在整个项目中运行良好，除了对象属性的更改反映在 MemberwiseClone 中的一种情况。

我正在做的是在我的对象中添加或编辑属性之前在我的对象中执行 MemberwiseClone，然后如果用户想要撤消，我将 MemberwiseClone 对象中的每个属性复制回我的当前对象。

因为我使用的是 WPF 绑定，所以使用 MemberwiseClone 对我很有吸引力，因为到目前为止，对属性所做的任何更改都没有反映在 MemberwiseClone 中。这次我的对象中有一个属性，它是另一个对象的 ObservableCollection，发生的情况是，如果我将一个项目添加到 ObservableCollection，它也会添加到由 MemberwiseClone 创建的对象中，我永远无法真正撤消。

有没有办法解决？欢迎您对此有任何想法。

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-04T21:58:25.853

根据[Object.MemberwiseClone Remarks](http://msdn.microsoft.com/en-us/library/system.object.memberwiseclone.aspx)将复制您中的对象引用，`ObservableCollection`但不会复制引用的对象本身。因此，您的撤消集合引用了相同的可能更改的对象。

你需要一份深拷贝，而不是浅拷贝。看看[如何在 .Net（特别是 C#）中对对象进行深度复制？](https://stackoverflow.com/q/129389/620360)

# javascript - 试图让 CSS3 聚光灯效果与触摸事件一起使用

> ID：10454008
> 
> 赞同：0
> 
> 时间：2012-05-04T18:12:46.607
> 
> 标签：javascript, jquery, css, touch

我试图让这种效果与 ipad 上的触摸事件一起工作，这是 jsfiddle [http://jsfiddle.net/FwsV4/1/上的鼠标事件应该是什么样子](http://jsfiddle.net/FwsV4/1/)

这是我尝试过的[http://jsfiddle.net/FwsV4/3/](http://jsfiddle.net/FwsV4/3/)对我不起作用。

老实说，我对触摸事件以及如何将鼠标单击/移动转换为它们感到有些迷茫。我实际上不确定如何最好地利用这种效果，但我想使用触摸开始/结束事件使元素保持交互。

谁能指出我正确的方向？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-04T19:32:32.403

您的第一个问题是您需要绑定到 touchstart 以防止页面滚动。你可以这样做：

```
$('myElement').htmlElement.bind("touchstart", function(event) {
    event.preventDefault();
  }
); 
```

不过，从中获得坐标可能会更好。

这是一个关于触摸事件的好教程： [http ://www.sitepen.com/blog/2008/07/10/touching-and-gesturing-on-the-iphone/](http://www.sitepen.com/blog/2008/07/10/touching-and-gesturing-on-the-iphone/)

您的第二个问题是将元素设置为 5000 像素的高度和宽度，因为默认情况下 iOS 将缩放以包含整个页面。您应该对此进行调整或使用 viewport 标签来更改缩放行为（请参阅[viewport apple docs](http://developer.apple.com/library/ios/#DOCUMENTATION/AppleApplications/Reference/SafariWebContent/UsingtheViewport/UsingtheViewport.html)）。

以下代码也不正确，它返回一个布尔值，而不是其中一个对象。

```
 var touch = e.originalEvent.touches[0] || e.originalEvent.changedTouches[0]; 
```

这应该是：

```
 var touch = e.originalEvent.touches[0] ? e.originalEvent.touches[0] : e.originalEvent.changedTouches[0]; 
```

**但是**使用 touchmove 您对 e.originalEvent.touches[0] 感兴趣（假设只对单指触摸事件感兴趣）。

您还应该避免以这种方式使用内联 js 和单独的文件 js（在某些情况下可能有理由这样做）。它使跟随变得更加困难。

我不确定将触摸事件与 jfiddle 一起使用是否是一个不错的计划（我可能错了），我只是使用普通的网络服务器/本地文件进行开发。

# spring - Spring 返回 FileSystemResource 而不是 ClassPathResource

> ID：10454011
> 
> 赞同：4
> 
> 时间：2012-05-04T18:12:58.510
> 
> 标签：spring

我正在尝试检索类路径中的文件列表，但 Spring 向我返回了 FileSystemResources 的 Resource[] 而不是 ClassPathResources。代码如下所示：

```
PathMatchingResourcePatternResolver resolver = new PathMatchingResourcePatternResolver();
Resource [] resources = resolver.getResources("classpath*:my/package/**/*.xml"); 
```

我也试过这个：

```
context.getResources("classpath*:my/package/**/*.xml"); 
```

返回的数组是一堆绝对路径 file:// URL，而我真正想要的是 classpath: URL。我究竟做错了什么？

这就是我希望最终构建的内容：

```
/my/package/one.xml
/my/package/two.xml 
```

相反，我得到了这个：

```
file:/C:/eclipse/.../my/package/one.xml 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-24T17:12:25.730

FileSystemResource 和 ClassPathResource 都返回绝对资源路径。FileSystemResource 在文件系统中寻找它`C:/eclipse/.../my/package/one.xml`。ClassPathResource 在内部的类路径文件中查找资源`/WEB-INF/classes`。我不明白你为什么需要 return `classpath:path`，但是你仍然可以通过子串你的绝对路径来得到它。

# ant - 确定从 Ant 运行 YUI 压缩器时哪个文件出错

> ID：10454014
> 
> 赞同：10
> 
> 时间：2012-05-04T18:13:14.333
> 
> 标签：ant, jenkins, yui-compressor

在 Jenkins CI 服务器上运行的 ant 构建任务期间，我们使用 YUI 压缩器压缩我们的 javascript（和 css 文件）。但是，很难确定 YUI 压缩器与哪些 js 文件有错误。我们看到了很多类似的东西：

```
[minify-js] [错误] 3:35：未终止的字符串文字
[缩小-js]
[minify-js] [错误] 3:35：语法错误
[缩小-js]
[minify-js] [错误] 4:8: 语法错误
[缩小-js]
[minify-js] [ERROR] 1:0：编译产生 3 个语法错误。
[minify-js] org.mozilla.javascript.EvaluatorException：编译产生 3 个语法错误。
[minify-js] 在 com.yahoo.platform.yui.compressor.YUICompressor$1.runtimeError(YUICompressor.java:135)
[minify-js] 在 org.mozilla.javascript.Parser.parse(Parser.java:410)
[minify-js] 在 org.mozilla.javascript.Parser.parse(Parser.java:355)
[minify-js] 在 com.yahoo.platform.yui.compressor.JavaScriptCompressor.parse(JavaScriptCompressor.java:312)
[minify-js] 在 com.yahoo.platform.yui.compressor.JavaScriptCompressor.(JavaScriptCompressor.java:533)
[minify-js] 在 com.yahoo.platform.yui.compressor.YUICompressor.main(YUICompressor.java:112)
[minify-js] 在 sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
[minify-js] 在 sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:57)
[minify-js] 在 sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
[minify-js] 在 java.lang.reflect.Method.invoke(Method.java:616)
[minify-js] 在 com.yahoo.platform.yui.compressor.Bootstrap.main(Bootstrap.java:20)
[minify-js] 结果：2

```

在输出中，但我不知道错误来自数百个 JS 文件中的哪个。我们的 ant 任务如下所示：

```
<target name="minify-js">
    <apply executable="yuicompressor" parallel="false" dest="${global.dir}/" taskname="minify-js" force="true">
        <fileset dir="${global.dir}/" includes="**/*.js">
            <exclude name="*.min.js" />
        </fileset>
        <arg value="--type=js" />
        <srcfile />
        <arg value="-o" />
        <targetfile />
        <mapper type="identity" />
    </apply>
</target> 
```

不是 Ant 或 YUI 压缩器方面的专家，我们有什么办法可以将发生错误的文件名输出到某处？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-11T07:01:14.327

我不知道 yuicompressor 是如何工作的，我假设它一次只能处理一个文件。

如果这是真的，您可以使用[for from ant-contrib](http://ant-contrib.sourceforge.net/tasks/tasks/for.html)来完成。您需要事先安装[ant-contrib 。](http://ant-contrib.sourceforge.net)

```
<taskdef resource="net/sf/antcontrib/antcontrib.properties" classpath="${global.dir}/bin_data/ant-contrib-0.6.jar"/>
<for param="file">
  <path>
    <fileset dir="${global.dir}/" includes="**/*.js">
      <exclude name="*.min.js" />
    </fileset>
  </path>
  <sequential>
    <echo>youcompressor for @{file}</echo> <!-- Will output each file and help debugging -->
    <exec executable="yuicompressor"> <!-- I took the args from the official documentation-->
      <arg value="--type=js" />
      <arg value="-o" />
      <arg value="'.js$:-min.js'" />
      <arg value="@{file}" />
    </exec>
  </sequential>
</for> 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-04T20:21:49.470

尝试使用此选项：

> -v, --verbose 显示信息性消息和警告。

对于像您这样的案例，文档中有一个很好的条目：

> 不要犹豫，使用 -v 选项。虽然不是 JSLint 的替代品，但当它感觉到您的代码可能有问题时，它会输出一些有用的提示。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-05-11T06:31:46.073

你试过了吗

```
<apply … verbose="true"> 
```

> 执行后是否打印摘要。从蚂蚁 1.6.

*理想情况下，它会在尝试对文件执行之前*打印一条语句，但之后有一个摘要至少可以让您看到最后一个成功的文件，这应该指向损坏的文件，因为文件集通常是按字母数字顺序排列的。

# ruby-on-rails - Faye、Rails 和 Net：到达 HTTP 文件结尾

> ID：10454017
> 
> 赞同：0
> 
> 时间：2012-05-04T18:13:21.040
> 
> 标签：ruby-on-rails, faye

我正在尝试完成以下任务：一旦网站上批准了帖子，就会通知该网站上的人。

为了解决这个问题，我正在使用 Faye，并在我的方法批准的频道上发布。我的应用程序只有一个通道，非常简单的场景。无论如何，由于某种原因它不起作用。

我正在使用**Rails 2.3.5**、**Faye 0.8.5**、**eventmachine 1.0.0.beta4**（与 Faye 一起安装的那个）、**rack 1.0.1**和**thin 1.3.1**。我没有使用 Apache。

到目前为止，我所拥有的是：

**faye.ru**：（我运行它：rackup faye.ru -s thin -E production）

```
require 'faye'

faye_server = Faye::RackAdapter.new(:mount => '/faye', :timeout => 45)
run faye_server 
```

**应用程序.js**：

```
var $j = jQuery.noConflict();

$j(function() {
  var faye = new Faye.Client('http://0.0.0.0:9292/faye');
  faye.subscribe("/messages/new", function(data) {
    alert(data.text);
  });
}); 
```

**application.html.erb**：

```
<%= javascript_include_tag 'http://0.0.0.0:9292/faye.js' %> 
```

**post_controller.rb**：

```
def approve
  @post.update_attribute(:approved, true)
  message = {:post => @post}
  uri = URI.parse("http://0.0.0.0:9292/faye")
  Net::HTTP.post_form(uri, :message => message.to_json)
  redirect_to(pending_posts_path)
end 
```

**堆栈**跟踪是：

```
EOFError (end of file reached):
  /usr/lib/ruby/1.8/net/protocol.rb:135:in `sysread'
  /usr/lib/ruby/1.8/net/protocol.rb:135:in `rbuf_fill'
  /usr/lib/ruby/1.8/timeout.rb:62:in `timeout'
  /usr/lib/ruby/1.8/timeout.rb:93:in `timeout'
  /usr/lib/ruby/1.8/net/protocol.rb:134:in `rbuf_fill'
  /usr/lib/ruby/1.8/net/protocol.rb:116:in `readuntil'
  /usr/lib/ruby/1.8/net/protocol.rb:126:in `readline'
  /usr/lib/ruby/1.8/net/http.rb:2024:in `read_status_line'
  /usr/lib/ruby/1.8/net/http.rb:2013:in `read_new'
  /usr/lib/ruby/1.8/net/http.rb:1050:in `request'
  /usr/lib/ruby/1.8/net/http.rb:405:in `post_form'
  /usr/lib/ruby/1.8/net/http.rb:543:in `start'
  /usr/lib/ruby/1.8/net/http.rb:404:in `post_form'
  app/controllers/posts_controller.rb:38:in `approve' 
```

并且在瘦服务器上也会出现**错误：**

```
>> Thin web server (v1.3.1 codename Triple Espresso)
>> Maximum connections set to 1024
>> Listening on 0.0.0.0:9292, CTRL+C to stop
!! Unexpected error while processing request: undefined method `call' for nil:NilClass 
```

据我了解，每次尝试在服务器上连接都会出现这个错误，关键是“http://0.0.0.0:9292/faye.js”不可用，即如果我尝试访问这个 URL，我收到“ **！！处理请求时出现意外错误：未定义的方法 `call' for nil:NilClass** ”，这与 Net:HTTP 无法访问它的原因相同。我想知道为什么。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-31T13:40:22.283

不要打字`<%= javascript_include_tag 'http://0.0.0.0:9292/faye.js' %>`

它不完全是本地主机，只需执行以下操作：

`<%= javascript_include_tag 'http://127.0.0.1:9292/faye.js' %>`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-04T19:05:15.997

终于找到问题了，我的错，我忘了用服务器开始监听，在faye.ru上：

```
faye_server.listen(9292) 
```

# java - 按钮自行调整大小？

> ID：10454019
> 
> 赞同：0
> 
> 时间：2012-05-04T18:13:39.470
> 
> 标签：java, user-interface

我和一个朋友正在尝试用 java 中的按钮制作一个 mp3 播放器，但是一旦单击第一个按钮，它就会调整第二个菜单上所有按钮的大小。任何有关如何防止按钮调整大小的信息将不胜感激。

```
 import java.awt.event.*;
       import javax.swing.*;
       import java.awt.*;

   public class Player extends JFrame {

  class CustomPanel extends JPanel{     //create image
     public void paintComponent (Graphics painter){
        Image pic = Toolkit.getDefaultToolkit().getImage("playerBase.jpg");
        if(pic != null) painter.drawImage(pic, 0, 0, this);
     }
  }

  public static void main(String[] args) {
     Player gui = new Player();
     gui.go();
  }

  public void go() {
     JFrame frame = new JFrame("MP3 Player."); //Creates window.
     CustomPanel base = new CustomPanel(); //Makes the image into a panel.
     JButton button1 = new JButton("Artists");
     JButton button2 = new JButton("Genres");
     JButton button3 = new JButton("Songs");
     JButton button4 = new JButton("TEST");
     JButton button5 = new JButton("TEST");
     button1.setHorizontalAlignment(SwingConstants.LEFT);
     button2.setHorizontalAlignment(SwingConstants.LEFT);
     button3.setHorizontalAlignment(SwingConstants.LEFT);
     button4.setHorizontalAlignment(SwingConstants.LEFT);
     button5.setHorizontalAlignment(SwingConstants.LEFT);
     button1.addActionListener(new Button1Listener());
     button2.addActionListener(new Button2Listener());
     button3.addActionListener(new Button3Listener());
     button4.addActionListener(new Button4Listener());
     button5.addActionListener(new Button5Listener());

     base.add(button1);
     base.add(button2);

       base.add(button3);
         base.add(button4);
         base.add(button5);

         frame.setDefaultCloseOperation( JFrame.EXIT_ON_CLOSE );
         frame.setSize(304, 360);
         frame.setResizable(false);
         frame.add(base);
         frame.setVisible(true);

         button1.setSize(280, 30);
         button1.setLocation(10,10);
         button1.setBackground(Color.BLACK); 
         button1.setForeground(Color.white);
         button2.setSize(280, 30);
         button2.setLocation(10,40);
         button2.setBackground(Color.BLACK); 
         button2.setForeground(Color.white);
         button3.setSize(280, 30);
         button3.setLocation(10,70);
         button3.setBackground(Color.BLACK); 
         button3.setForeground(Color.white);
         button4.setSize(280, 30);
         button4.setLocation(10,100);
         button4.setBackground(Color.BLACK); 
         button4.setForeground(Color.white);
         button5.setSize(280, 30);
         button5.setLocation(10,130);
         button5.setBackground(Color.BLACK); 
         button5.setForeground(Color.white);

      }

   //These are the actions for the 5 buttons.
    //Need to get buttons straight once first button is clicked
      class Button1Listener implements ActionListener {
         public void actionPerformed(ActionEvent event) {
            if (event.getSource() instanceof JButton) { 
               JButton clickedButton = (JButton) event.getSource(); 
               clickedButton.setSize(280, 30);
               clickedButton.setLocation(10,10);
               clickedButton.setBackground(Color.BLACK); 
               clickedButton.setForeground(Color.white);

               String buttonText = clickedButton.getText(); 
               if (buttonText.equals("Artists")) { 
                  System.out.println("Artists");
                  clickedButton.setText("Back");

               } 
               else if (buttonText.equals("Back")) { 
                  System.out.println("Back");
               } 
            } 
         } 
      }
   //these are just place holders for the other buttons.
      class Button2Listener implements ActionListener {
         public void actionPerformed(ActionEvent event) {
            System.out.println("Genres");
         }
      }

      class Button3Listener implements ActionListener {
         public void actionPerformed(ActionEvent event) {
            System.out.println("Songs");
         }
      }

      class Button4Listener implements ActionListener {
         public void actionPerformed(ActionEvent event) {
            System.out.println("TEST");
         }
      }

      class Button5Listener implements ActionListener {
         public void actionPerformed(ActionEvent event) {
            System.out.println("TEST");
         }
      }

} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-04T18:21:49.283

在您的`CustomPanel base`.

```
base.setLayout(null); 
```

如果要强制设置组件的大小和位置（使用 setBounds()），则需要删除布局管理器。

但是，LayoutManagers 可以在不同平台上提供更好的 UI 体验，因为它们会适应差异。LayoutManager 基于 PreferredSize 和约束执行组件的大小调整和定位。如果您从未使用过它们或收到过它们的消息，那么您真的应该考虑研究一下它们：[http ://docs.oracle.com/javase/tutorial/uiswing/layout/using.html](http://docs.oracle.com/javase/tutorial/uiswing/layout/using.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-04T18:29:22.613

好吧，我没有看到菜单代码。但是，默认情况下，布局管理器`Panel`是 Flow Layout。由于您没有指定任何布局，`Flow Layout`因此假定您指定的任何大小都将在很大程度上被忽略。

因此，正如 Guillaume 建议的那样，将其设置为 null，这样您就可以绝对定位事物。或者根据您的需要使用更复杂的布局。[在swing 教程](http://docs.oracle.com/javase/tutorial/uiswing/TOC.html)中查看如何使用布局管理器。`GridBagLayout`是最复杂的（难以使用），除非您使用某种 gui 构建器。其他候选人是`BorderLayout`，`GridLayout`等等。通读示例，看看哪一个适合您的情况。

# java - 获取 LinkedHashMap 中的 Previous 键？

> ID：10454021
> 
> 赞同：1
> 
> 时间：2012-05-04T18:13:42.307
> 
> 标签：java, list, linked-list, linkedhashmap

我使用了 LinkedHashMap lhmNotFinal，因为在 map 中输入的键的顺序很重要。我使用这个来获取我的 LinkedHashMap 的值

```
for (String key:lhmNotFinal.keySet())
{
System.out.println(key);
} 
```

现在我想获取我的密钥的先前值，我该怎么做？提前谢谢你。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-04T18:21:33.137

一般来说，这不是与 LinkedHashMap 相关的问题 - 这是一个编码问题。你可以做几件事：

```
String tmp= null;

for (String key : lhmNotFinal.keySet()) {

    tmp = key ;    // after the first iteration you have your last key in tmp
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-04T18:35:32.687

只是为了好玩：

```
//
Map<String, String> map = new LinkedHashMap<String, String>();
map.put( "key1", "value1" );
map.put( "key2", "value2" );

//
final ListIterator<String> keyListIterator = new ArrayList<String>( map.keySet() ).listIterator();
assertEquals( "key1", keyListIterator.next() );
assertEquals( "key2", keyListIterator.next() );
assertEquals( "key2", keyListIterator.previous() );
assertEquals( "key1", keyListIterator.previous() );
assertEquals( "key1", keyListIterator.next() );
assertEquals( "key2", keyListIterator.next() ); 
```

# ms-access - VBScript 从 MSACCESS 导出表关系以便稍后放回

> ID：10454023
> 
> 赞同：2
> 
> 时间：2012-05-04T18:13:47.067
> 
> 标签：ms-access, version-control, vbscript, table-relationships

对于源代码控制，我试图从 Access 中导出表关系，以便能够重新导入它们。据我所知，为了做到这一点，我只需要四条信息。

1.  表名
2.  表字段名称
3.  外部表名
4.  外部表字段名称

我把前三个记下来了，但是在弄清楚最后一点信息时遇到了问题。通常我的表和字段名称总是相同的，所以这通常不是问题，但我真的很想这个 vbscript 是否可以解释将来可能不那么明显的时间。这是我正在使用的代码片段：

```
Dim db, totalrelations, i, j

Set db = oApplication.CurrentDb
totalrelations = db.Relations.Count
WScript.Echo totalrelations
If totalrelations > 0 Then
    WScript.Echo "opening " & totalrelations
    For i = totalrelations - 1 To 0 Step -1
       'WScript.Echo (db.Relations(i).Name)
       'WScript.Echo (db.Relations.Item(i).name)

       WScript.Echo "Attributes: " &       db.Relations.Item(i).Attributes

 '**            'iterate through the count!!!
       WScript.Echo "Field count: " & db.Relations.Item(i).Fields.Count

       If db.Relations.Item(i).Fields.Count > 0 Then
            For j = 0 To db.Relations.Item(i).Fields.Count - 1
                WScript.Echo j & " Field name: " & db.Relations.Item(i).Fields.Item(j).Name
            Next 
       End If
       WScript.Echo "ForeignTable: " &     db.Relations.Item(i).ForeignTable
       WScript.Echo "Name: " &             db.Relations.Item(i).Name
       WScript.Echo "PartialReplica: " &   db.Relations.Item(i).PartialReplica

       WScript.Echo "propertycount: " & db.Relations.Item(i).Properties.Count
       'Simply repeats everything we already know
       If db.Relations.Item(i).Properties.Count > 0 Then
            For j = 0 To db.Relations.Item(i).Properties.Count -1
                WScript.echo j & " PropertyName:" & db.Relations.Item(i).Properties.Item(j).Name
                WScript.echo j & " PropertyValue:" & db.Relations.Item(i).Properties.Item(j).Value
            Next
       End if

       WScript.Echo "Table: " &            db.Relations.Item(i).Table
    Next 

End If 
```

我曾假设我可以很聪明，检查字段计数并遍历它们。然而，这个笑话在我身上，因为我在两个不同名称的字段之间建立了关系，并且字段计数仍然为 1。因此，我的聪明并没有向我揭示法力的秘密：P 有人知道我如何哄这个信息出来了？

1.  表名 = db.Relations.Item.Table
2.  表字段名称 = db.Relations.Item.Fields.Item(0).Name
3.  外表名 = db.Relations.Item.ForeignTable
4.  外部表字段名称 = ????

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-04T18:49:23.283

你有这个...

```
" Field name: " & db.Relations.Item(i).Fields.Item(j).Name 
```

要检索外部表中相关字段的名称，请使用以下命令：

```
" Foreign Field name: " & db.Relations.Item(i).Fields.Item(j).ForeignName 
```

实际上，您不需要显式包含`.Item()`来检索每个集合的*第 i 个*或*第 j 个*成员。所以我会把它缩短为：

```
" Foreign Field name: " & db.Relations(i).Fields(j).ForeignName 
```

# c# - 动画的分辨率独立网格？

> ID：10454024
> 
> 赞同：1
> 
> 时间：2012-05-04T18:13:55.930
> 
> 标签：c#, xna, grid, positioning, pixel

我正在开发一个用 XNA、C# 制作的游戏，我想启用基于 xml 的动画。

XML 看起来像这样

```
<Animation>
<AnimatedObject>
<Filename>Spaceship_Jet_01</Filename>
<Flipped>false</Flipped>
<StartPosition_X>300</StartPosition_X>
<StartPosition_Y>500</StartPosition_Y>
<GOTOPosition_X>650</GOTOPosition_X>
<GOTOPosition_Y>500</GOTOPosition_Y>
<Time>10000</Time>
</AnimatedObject>
</Animation> 
```

这会将一个对象移到一边，就像这样 [http://imm.io/odc7](http://imm.io/odc7)（对不起，X 坐标是错误的）

我注意到会有问题，当玩家显示分辨率与我的不同时，因为我输入了关于对象来自哪里以及它必须去哪里的像素精确信息。

我想到了一个网格，所以我可以告诉程序将对象从（30,27）移动到（22,27），例如。这是一个好的解决方案吗？网格必须独立于分辨率，但瓷砖的数量必须保持不变，我必须将对象绘制到屏幕上。这意味着我必须在位置 (22,27) 处找到图块的正确像素位置，然后将对象“移动”到该图块。

有没有更好的方法来做到这一点？我怎样才能用 XNA 解决这个问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-04T20:08:34.933

如果您使用 2D 相机，您不会有任何问题......因为计算新视图以使其适应新分辨率并不困难......而且您不必更改任何加载方法或逻辑...... .

你可以，但我不喜欢

1.  使用 [0..1] 范围内的位置，很难测量。

2.  加载 xml 时使用新的分辨率因子修复位置......很难看......

    ```
    Pos *= NewResolutionSize/DefaultResolutionSize; 
    ```

# java - 双重检查锁定 - 陷阱？

> ID：10454026
> 
> 赞同：4
> 
> 时间：2012-05-04T18:14:00.777
> 
> 标签：java, synchronization, double-checked-locking

我使用 java 大约一个月了，并且通常仍然是编程的业余爱好者，所以如果我有错误，请随时纠正我。也许我会提供一些多余的细节，但我现在很困惑，我无法决定什么是重要的。

所以，我一直在开发多线程客户端-服务器应用程序。所有线程都使用同一个对象，其中存储了某些配置值和共享记录器；此对象在服务器线程中初始化，然后作为参数传递给客户端线程类构造函数。首先假设该对象的字段仅在服务器启动时更改一次，因此无需担心并发访问，但是现在需要在修改配置文件时从配置文件中重新读取某些配置值，而不必重新启动服务器。

经过一些研究后想到的第一个想法是创建一个同步方法，当请求类中的某些值时将调用该方法，如果自上次访问以来我们的配置文件发生更改，它将重新读取这些值，否则立即返回，例如这个：

```
<This code is inside "config" class, instance of which is shared between threads>
private static long lastModified;
private static File configFile;

public class ChangingVariableSet
    {
    <changing variables go here>
    }

private synchronized void ReReadConfig
    {
    long tempLastMod = configFile.lastModified();
    if(lastModified == tempLastMod)
        return;
    <reread values here>
    lastModified = tempLastMod;
    }

public ChangingVariableSet GetValues()
    {
    ReReadConfig();
    <return necessary values>
    } 
```

（上面的代码没有经过测试，我只是想大致了解一下）。

但是我只是不喜欢*每次*请求值时都阻塞的想法，因为这看起来很昂贵，而且我的应用程序将来可能会变得非常高负载，并且有很多线程。所以我有一个“好”的想法——在锁定之前检查文件是否被修改，然后再次在锁定的方法中，尽可能避免锁定：

```
 public ChangingVariableSet GetValues()
    {
    if(lastModified == configFile.lastModified())
        ReReadConfig();
    <return necessary values>
    } 
```

十分钟后，我了解到它被称为双重检查锁定，再过十分钟后，我的世界在阅读[了这篇文章](http://www.cs.umd.edu/~pugh/java/memoryModel/DoubleCheckedLocking.html "双重检查锁定被破坏")后两次崩溃：第一次是我了解到它可能由于内部 CPU 缓存而无法工作，第二次是我读到关于 long 的操作/float 类型不是原子的。或者它毕竟会工作，因为不涉及对象创建？而且，由于 long 上的操作是非原子的，将“lastModified”声明为 volatile 真的就足够了吗？如果可能的话，我希望能正确解释它为什么会/不会起作用。先感谢您。

PS：我知道类似的问题已经回答了几次，也许最好停止吹毛求疵并同步整个“getValue”方法而不是“ReReadConfig”，但我正在努力学习更多关于线程安全编程和在我自己的代码中查看陷阱，以避免将来出现类似的情况。我也为任何可能的语法和拼写错误道歉，我不太懂英语。

* * *

**编辑：**首先，我修正了最后一个“if”子句中的错字。第二 - 警告，上面的代码不是线程安全的，不要使用它！在方法

```
 public ChangingVariableSet GetValues()
    {
    if(lastModified == configFile.lastModified())
        ReReadConfig();
    <return necessary values>
    } 
```

如果文件在 if-check 和返回值之间的时间跨度内更新，线程 B 可以在线程 A 开始返回值之前启动 ReReadConfig，从而导致对必要数据的危险部分更改。似乎在不过度阻塞的情况下做我需要的正确方法是使用 ReentrantReadWriteLock，但是，我仍然想使用双重检查来避免过度（并且昂贵，文件被假定为大型 XML）配置重新读取：

```
<...>
private static final ReentrantReadWriteLock readWriteLock = new ReentrantReadWriteLock();
private static final Lock read  = readWriteLock.readLock();
private static final Lock write = readWriteLock.writeLock();

private void ReReadConfig
    {
    write.lock();
    long tempLastMod = configFile.lastModified();
    if(lastModified == tempLastMod)
        return;
    <reread values here>
    lastModified = tempLastMod;
    write.release();
    }

 public ChangingVariableSet GetValues()
    {
    if(lastModified == configFile.lastModified())
        ReReadConfig();
    read.lock();
    <get necessary values>
    read.release();
    <return necessary values>
    } 
```

现在它至少看起来是线程安全的，但是在检查时取决于易失性“lastModified”变量的问题仍然存在：我在某处读到易失性变量不能保证非原子操作的任何内容，以及“长”类型读取/写入是非原子的。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-04T18:19:48.217

您想使用[ReadWriteLock](http://docs.oracle.com/javase/1.5.0/docs/api/java/util/concurrent/locks/ReadWriteLock.html)。只要没有作者，这不会阻止读者。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-04T20:44:15.297

如果您可以以这样一种方式组织代码，即所有配置数据都在一个不可变对象中，并且对该对象有一个共享的 volatile 引用，那么这将是线程安全的。这种用例其实就是`volatile`语义修改的目的。

```
public static volatile Config config;

void rereadConfig() {
  if (modified)
    config = new Config(...);
} 
```

# python - 尝试使用设置样式线时的 GNUplot 4.2 语法错误

> ID：10454029
> 
> 赞同：1
> 
> 时间：2012-05-04T18:14:12.317
> 
> 标签：python, gnuplot

我一直在互联网上寻找答案。

似乎有很多版本的如何在 gnuplot 中绘制颜色线。我有一个包含 4 列的数据文件。我想用不同的颜色绘制每一列。这是我根据 gnuplot 帮助文件使用的代码片段，但是在使用这些代码时出现语法错误。

```
set style line 1 lt 1 lc 1 lw 3 # red
set style line 2 lt 1 lc 2 lw 3 #green
set style line 3 lt 1 lc 3 lw 3 #blue
set style line 4 lt 1 lc 4 lw 3 #magenta 
```

我将终端设置为后记。

例如，我已经尝试了这种线型样式的所有组合，包括线型和 lc rgb 'red'，但它们都不起作用！

谁能告诉我出了什么问题？

让我澄清一下，这是 python 脚本中的 gnuplot 脚本。代码如下所示：

```
plot = open('plot.pg','w')
plot_script = """#!/usr/bin/gnuplot
reset
set terminal postscript 
#cd publienhanced color
set output "roamingresult.ps"
set xlabel "time (seconds)"
set xrange [0:900]
set xtics (0, 60, 120, 180, 240, 300, 360, 420, 480, 540, 600, 660, 720, 780, 840, 900)
set ylabel "AP1         AP2         AP3       AP4"
set yrange [0:5]
set nokey
set grid
set noclip one
set ytics 1
#set style data boxes"""
set style line 1 lt 1 lc 1 lw 3
set style line 2 lt 1 lc 2 lw 3
set style line 3 lt 1 lc 3 lw 3
set style line 4 lt 1 lc 4 lw 3 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-04T20:04:10.613

好的，从您刚刚更新的代码中，您的问题很清楚。

## 怎么了（快速回答）

您将 Gnuplot 脚本作为字符串包含到 Python 源代码中。`"""`标记表示字符串的开头和结尾。问题是您使用以下行终止字符串：

```
#set style data boxes""" 
```

同样，这个三引号语法标志着 Gnuplot 字符串的结束，所以接下来的应该是 Python 代码。现在，`set`意味着与 Python 完全不同的东西（如果你好奇的话，它是一个[数学集合）。](http://en.wikipedia.org/wiki/Set_%28mathematics%29)您的 Gnuplot 语法`set`与 Python 中的含义不匹配，所以这就是它给您语法错误的原因。

将三引号移动到 Gnuplot 脚本的末尾可以解决问题。**但是**，有一个更简单的解决方案。

## 更好的方法

您不应该将 Gnuplot 代码直接内嵌到 Python 脚本中。相反，您应该从另一个文件（该文件完全是 Gnuplot 代码）中读取脚本，并以这种方式处理它。

所以，保留一个只包含 Gnuplot 代码的文件（例如`plot.script`）：

```
#!/usr/bin/gnuplot
reset
set terminal postscript 
#cd publienhanced color
set output "roamingresult.ps"
set xlabel "time (seconds)"
set xrange [0:900]
set xtics (0, 60, 120, 180, 240, 300, 360, 420, 480, 540, 600, 660, 720, 780, 840, 900)
set ylabel "AP1         AP2         AP3       AP4"
set yrange [0:5]
set nokey
set grid
set noclip one
set ytics 1
#set style data boxes
set style line 1 lt 1 lc 1 lw 3
set style line 2 lt 1 lc 2 lw 3
set style line 3 lt 1 lc 3 lw 3
set style line 4 lt 1 lc 4 lw 3 
```

然后在 Python 中与这个文件进行交互，如下所示：

```
plot_script = open("plot.script", "r").read() 
```

### 最终结果

`plot_script`包含完全相同的数据，每个文件都包含一种语言独有的代码，并且您的代码更具可读性。

# svn - 将功能分支中的文件合并到主干

> ID：10454031
> 
> 赞同：0
> 
> 时间：2012-05-04T18:14:17.267
> 
> 标签：svn

我们的工作流程如下：

1.  从主干创建功能分支
2.  在功能分支中进行所有开发
3.  在功能分支中工作时，定期将主干合并到分支中以与主干保持同步。
4.  `--reintegrate`功能完成后，使用选项合并回主干。

假设我在功能分支中有一些工作正在进行中。整个分支还没有准备好合并回主干，但是分支中有一个特定文件需要合并到主干。

将这个文件合并到主干的最简单方法是什么，而不会在以后将分支重新集成回主干时造成任何问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-04T18:44:24.783

尝试检出主干并将文件添加到检出并提交回来。

当您第一次从主干合并到开发分支时，这可能会导致该单个文件发生冲突。只要您没有进行任何更改，您就应该安全地接受主干版本。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-04T18:58:29.587

您可以将文件合并到主干。但是您需要使用该选项将合并到主干创建的修订合并回您的分支`--record-only`。

[请参阅svn book 的 Advanced merging 部分中](http://svnbook.red-bean.com/en/1.7/svn.branchmerge.advanced.html)的“保持重新集成的分支活着”

# ruby - Ruby：带装饰器的冰淇淋

> ID：10454033
> 
> 赞同：-3
> 
> 时间：2012-05-04T18:14:19.547
> 
> 标签：ruby

我正在编写一个计算冰淇淋成本的简单程序。

这个过程很简单：挑一个蛋筒，挑一些口味，挑一些浇头，然后付钱。

有一堆不同的蛋筒，一堆不同的口味，还有一堆不同的配料。

我的设计是使用装饰器类来包装冰淇淋，类似于下订单的方式。

所以我有我的基本 Ice Cream 类，它提供了一个“数量”属性，指示事物的成本，以及 Cone、Flavor 和 Toppings 的装饰器类。每个班级都会拿一个冰淇淋对象并添加到数量，因此您基本上可以混合搭配不同类型的冰淇淋。

我有另一个处理实际货币交易的类，它接受各种对象并计算价格。特别是，如果它看到一个冰淇淋，它将执行一些与冰淇淋相关的过程。

现在，这个设计听起来不错，但是我如何检查从冰淇淋机中出来的物体是否是冰淇淋类型的呢？毕竟，理论上它会被一堆装饰器包裹起来，所以如果你问它的类，你可能会看到像 Topping 这样的东西，而不仅仅是冰淇淋。冰淇淋也不需要超级类；它可能是层次结构中的几个类。

`<topping ice cream>.Instanceof(Ice_Cream)`似乎不起作用。

此外，我已经使用一组类实现了它。我可以使用 ruby​​ 中的其他方法来实现这种类型的设计吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-04T18:21:37.657

你应该给我们看一些代码，但是 Ruby 有`Object#is_a?`，`Class#===`这在这里会很有帮助：

```
class MyString < String ; end
MyString.new.is_a? String #=> true
String === MyString.new #=> true
class AnotherString < MyString ; end
AnotherString.new.is_a? String #=> true
String === AnotherString.new #=> true 
```

如果您想知道`Class#===`，它主要用于 case 语句：

```
case value
when String
  # something
when Array
  # something else
end 
```

对于更惯用的设计方法，您可能应该研究模块及其作为 mixin 的使用：

[http://www.ruby-doc.org/docs/ProgrammingRuby/html/tut_modules.html](http://www.ruby-doc.org/docs/ProgrammingRuby/html/tut_modules.html)

# ios - iOS拆分视图控制器-在detailViewController中更改图像

> ID：10454034
> 
> 赞同：0
> 
> 时间：2012-05-04T18:14:22.123
> 
> 标签：ios, uiimageview, uiimage, uisplitviewcontroller

这是另一个“我确信这个问题有一个简单的答案”的问题，但我发现自己很困惑。

我正在使用模板中的拆分视图控制器。我成功地将 NSString 传递给 _detailItem 变量，但无法使用它来创建图像并将其加载到 UIImageView（名为“stripImage”）中。

它一直工作到： **[self.stripImage setImage:[UIImage imageNamed: _detailItem]];**

如果我将字符串文字放入同一行代码（如@“image20.jpg”），它工作正常。

```
- (void)configureView
{
// Update the user interface for the detail item.

if (self.detailItem) {
    NSLog(@"_detailItem is still: %@",_detailItem);
  // correctly reports the name of the imagefile (for example: "image20.jpg"

    [self.stripImage setImage:[UIImage imageNamed: _detailItem]];

    NSLog(@"The image being shown is: %@",self.stripImage.image);
      //returns "The image being shown is: (null)"
}
} 
```

请帮助防止我的头爆炸。提前致谢。

## ...我已经尝试过这种方式：

## （在我的主视图控制器中）：

```
-(void)tableView:(UITableView *)tableView didSelectRowAtIndexPath:(NSIndexPath *)indexPath
{
NSLog(@"Selected row %i",[indexPath row]);
NSString *imageName = [[stories objectAtIndex:[indexPath row]] objectForKey:@"link"];

NSLog(@"The image is: %@", imageName);

// These two work, oddly enough...

self.detailViewController.detailTitle.text = [[stories objectAtIndex:[indexPath row]]      
                 objectForKey:@"title"];
self.detailViewController.detailSubtitle.text = [[stories objectAtIndex:[indexPath row]] 
                 objectForKey:@"subtitle"];
// this one, not so much...
[self.detailViewController loadUpImageWith:imageName];
 } 
```

## 在我的详细视图控制器中：

```
- (void)loadUpImageWith:(NSString *)what
{
NSString *path = [[[NSBundle mainBundle] bundlePath] stringByAppendingPathComponent:[NSString 
                 stringWithFormat:@"strips/%@", what]];
NSLog(@"The file's url is: %@",path);

UIImage *img = [UIImage imageWithContentsOfFile:path];
NSLog(@"The resultant image is: %@",img);

stripImage.image = img;
} 
```

## 但这是奇怪的事情......如果我用字符串文字替换变量（在这种情况下为“what”）：

```
NSString *path = [[[NSBundle mainBundle] bundlePath] stringByAppendingPathComponent:[NSString 
                 stringWithFormat:@"strips/%@", @"grumbles300.jpg"]]; 
```

* * *

...它的工作原理，显示**一个**图像。但我希望能够在那里使用变量！

帮助我欧比万克诺比！你是我唯一的希望。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-06T18:49:36.507

## 令人尴尬的操作员错误。

我正在将一堆图像添加到捆绑包中，但它显然会跟踪包含它们的**文件夹**，**需要将其添加到文件名中。**我认为 UIImage imageNamed: 会追踪图像，只要它们包含在主包中。显然不是。

也许这对正在经历同样类型的大脑放屁的人有用。

解决这个问题后，很容易做到这一点：

```
- (void)loadupDetailTitle:(NSString *)title 
                 subtitle:(NSString *)subtitle 
                    image:(NSString *)imageName
{
NSString *path = [@"strips/" stringByAppendingPathComponent:imageName];
stripImage.image = [UIImage imageNamed:path];
detailTitle.text = title;
detailSubtitle.text = subtitle;
} 
```

# oauth - OAuth 客户端实现中的差异

> ID：10454035
> 
> 赞同：1
> 
> 时间：2012-05-04T18:14:30.493
> 
> 标签：oauth, oauth-2.0, facebook-oauth

我正在连接到几个受 OAuth 保护的服务，并试图了解我的两个 Oauth 客户端库的操作方式似乎不同。

其中一个库是通用 OAuth 客户端，它需要访问令牌密钥/秘密对和消费者密钥/秘密对才能生成签名请求。

另一个库是 Facebook 特定的 OAuth 客户端，只需要一个没有密钥的访问令牌，并且根本不需要消费者令牌或密钥来签署请求。

Facebook 的 OAuth 实现是否如此不同以至于它只需要其他 OAuth 实现所需的 4 个元素中的 1 个来签署请求？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-04T18:32:50.143

您提到的通用库用于 OAuth 1.0a 规范。而 Facebook 的 Graph API 基于 OAuth 2。

OAuth 的两个“版本”彼此完全不同。正如您所提到的，主要区别在于，在 OAuth 2 中没有请求级加密的概念（没有签名恐怖）。相反，该规范依赖于绝对要求 API 端点使用安全传输层 (HTTPS/SSL)。

由于 OAuth 2 直到最近才成熟为更稳定的草案，您会发现服务提供商的实现基于不同的草案，而 OAuth 1.0 在服务器实现方面更加稳定。

这个问题应该会给您很好的见解：[OAuth 2 与 OAuth 1 有何不同？](https://stackoverflow.com/questions/4113934/how-is-oauth-2-different-from-oauth-1).

# jquery - jQuery选择器区别

> ID：10454036
> 
> 赞同：1
> 
> 时间：2012-05-04T18:14:30.667
> 
> 标签：jquery, jquery-selectors

我在 DOM 中有这个元素：`<div id="main" class="main"></div>`. 通过 $('#main') 和 $('.main:first') 选择元素有什么区别吗？

编辑：忘了提到这是假设这个元素是唯一具有类名“main”的元素。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-04T18:18:59.403

> 编辑：忘了提到这是假设这个元素是唯一具有类名“main”的元素。

没有区别，因为只有一个`.main`，因此选择`$('#main')`or`$('.main')`会返回相同的结果。

在性能方面有但你可以忽略它，除非你使用高保真动画或巨大的 DOM 操作。

`$('#main')`- 更快、更整洁、更高效

`$('.main:first')`- 类选择器比 ID 选择器慢，`:first`过滤器慢。

-> 你不需要`:first`，只会`$('.main')`返回你想要的结果。

**其他选项**-

`$('.main')`- 比 ID 选择器慢

`$('div.main')`- 比 ID 选择器慢，仍然比 $('.main') 好

**证明**- [http://jsperf.com/jquery-class-vs-id-v2](http://jsperf.com/jquery-class-vs-id-v2)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-04T18:16:02.050

是的。如果该元素不是该类的第一个元素，则`main`不会选择该元素。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-04T18:16:41.927

$("#main") 可能会快一点，因为它使用了 ID。

此外，如果您在原始元素之前添加另一个带有 .main 类的元素，那么它将失败。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-04T18:16:44.490

ID 选择器更强大，因为 jQuery 遍历 DOM ID 应该是唯一的（意味着每个视图只有 1 个），而您可以有多个主类。

# java - java.security.AccessControlException：访问被拒绝（java.io.FilePermission

> ID：10454037
> 
> 赞同：25
> 
> 时间：2012-05-04T18:14:33.460
> 
> 标签：java, security, file-io, file-permissions, accesscontrolexception

```
final File parentDir = new File("S:\\PDSPopulatingProgram");
parentDir.mkdir();
final String hash = "popupateData";
final String fileName = hash + ".txt";
final File file = new File(parentDir, fileName);
file.createNewFile(); // Creates file PDSPopulatingProgram/popupateData.txt 
```

我正在尝试在文件夹中创建一个文件，但出现异常

```
java.security.AccessControlException: Access denied 
```

我在windows环境下工作。我可以从 Windows 资源管理器创建文件夹，但不能从 Java 代码创建文件夹。

我该如何解决这个问题？

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2012-05-04T19:36:53.377

在您`<jre location>\lib\security\java.policy`尝试添加：

`grant { permission java.security.AllPermission; };`

看看它是否允许你。如果是这样，您将不得不添加更精细的权限。

看：

[java.policy 文件的 Java 8 文档](https://docs.oracle.com/javase/8/docs/technotes/guides/security/PolicyFiles.html)

和

[http://java.sun.com/developer/onlineTraining/Programming/JDCBook/appA.html](http://archive.is/uN0K9)

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2012-09-07T11:48:20.690

虽然不推荐，但如果你真的想让你的 web 应用程序访问其部署目录之外的文件夹。您需要在`java.policy`文件中添加以下权限（路径如Petey B的回复）

```
permission java.io.FilePermission "your folder path", "write" 
```

在你的情况下，它会是

```
permission java.io.FilePermission "S:/PDSPopulatingProgram/-", "write" 
```

这里`/-`表示此文件夹内的任何文件或子文件夹。

**警告：**但是这样做会招致一些安全风险。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2020-02-27T11:46:21.960

只需在 Windows 上记录它，您需要转义`\`字符：

```
"e:\\directory\\-" 
```

# vim - 在 vimrc 中设置 vim omnicompletion 颜色（Pmenu）不起作用

> ID：10454038
> 
> 赞同：7
> 
> 时间：2012-05-04T18:09:34.023
> 
> 标签：vim

我正在尝试按照本指南自定义我的 vim 弹出完成菜单： [Vim Wiki: "Omni completion popup menu"](http://vim.wikia.com/wiki/Omni_completion_popup_menu)。它指出

> 如果您总是想要这个选择，请添加到您的 vimrc。

但是，在我的 .vimrc 文件中使用以下设置

```
colo desert

filetype plugin on
set ofu=syntaxcomplete#Complete
highlight Pmenu guibg=brown gui=bold 
```

我得到以下信息：

![啊啊啊！ 我的眼睛！](../Images/82fc9f21e50d50a37f53dea2b55ce048.png)

注意：当我手动输入高亮命令时，它可以工作：

![在此处输入图像描述](../Images/868ead51aa4c50ae3e5ac8f691558476.png)

如何让弹出窗口使用 .vimrc 中定义的配色方案，而不必每次都手动输入？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2014-02-28T08:01:21.483

如果你把你的命令按以下顺序，你可以得到你想要的。语法选项将覆盖您的突出显示选项。

```
"" gui configuration
color murphy
syntax one
highlight Pmenu guibg=brown gui=bold 
```

![在此处输入图像描述](../Images/923adbfdd3b5a018f52f949a4e6f94e7.png)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-05-07T17:57:34.940

请参阅[vim - 覆盖颜色方案](https://stackoverflow.com/questions/2440149/override-colorscheme "vim - 覆盖颜色方案")

简短的回答是你不能。如果您使用颜色方案，则 .vimrc 中的所有其他颜色方案调整都将被忽略。AfterColors[插件](http://www.vim.org/scripts/script.php?script_id=1641 "AfterColors 插件")为我解决了这个问题。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-04T18:17:47.933

嗯，很可能之后有一个突出显示的命令会覆盖您的选项。可能在确定文件类型并调整选项时。尝试在不设置`filetype plugin on`选项的情况下运行它。

如果可行，您需要调整文件类型检测以在之后运行您的特殊选项。

# python - 从文件中读取配置

> ID：10454039
> 
> 赞同：0
> 
> 时间：2012-05-04T18:14:36.847
> 
> 标签：python, file, config

我尝试读取配置文件并将值分配给变量：

```
#!/usr/bin/env python
# -*- coding: utf-8 -*-

with open('bot.conf', 'r') as bot_conf:
    config_bot = bot_conf.readlines()
bot_conf.close()

with open('tweets.conf', 'r') as tweets_conf:
    config_tweets = tweets_conf.readlines()
tweets_conf.close()

def configurebot():
    for line in config_bot:
        line = line.rstrip().split(':')
    if (line[0]=="HOST"):
        print "Working If Condition"
        print line
        server = line[1]

configurebot()
print server 
```

它似乎一切都很好，只是它没有为服务器变量分配任何值

```
ck@hoygrail ~/GIT/pptweets2irc $ ./testbot.py 
Working If Condition
['HOST', 'irc.piratpartiet.se']
Traceback (most recent call last):
  File "./testbot.py", line 23, in <module>
    print server
NameError: name 'server' is not defined 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-04T18:17:54.750

您的`sever`变量是`configurebot`函数中的局部变量。

如果你想在函数之外使用它，你必须 make it [`global`](http://docs.python.org/reference/simple_stmts.html?highlight=global#the-global-statement)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-04T18:18:07.713

`server`符号未在您使用它的范围内定义。

为了能够打印它，您应该从`configurebot()`.

```
#!/usr/bin/env python
# -*- coding: utf-8 -*-

with open('bot.conf', 'r') as bot_conf:
    config_bot = bot_conf.readlines()
bot_conf.close()

with open('tweets.conf', 'r') as tweets_conf:
    config_tweets = tweets_conf.readlines()
tweets_conf.close()

def configurebot():
    for line in config_bot:
        line = line.rstrip().split(':')
    if (line[0]=="HOST"):
        print "Working If Condition"
        print line
        return line[1]

print configurebot() 
```

您还可以通过在调用 configurebot() 之前声明它来使其全局化，如下所示：

```
server = None
configurebot()
print server 
```

# php - mysql join two rows with shared column entry

> ID：10454044
> 
> 赞同：0
> 
> 时间：2012-05-04T18:15:05.533
> 
> 标签：php, mysql, join, inner-join

I have one table which stores tags for files. The tags can be of different types. There are many files, each with tags stored for them of different types.

columns: file, tagtype, tags

So let's say I have two rows for one file:

```
cyclist.jpg | date | 04-05-2012
cyclist.jpg | face | true 
```

I would like to select into one row, all tags for a file, such that I have a mysql result:

cyclist.jpg 04-05-2012 true

At present I carry out two queries for the above, one for each tagtype. I want to know if I can do some kind of join, with the same table, on the same columns (tags), just based on one shared column (file).

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-04T18:39:50.813

If you want to join automatically two rows that means that probably you can just create one row without spliting it:

```
file         | date       | face 
cyclist.jpg  | 04-05-2012 | true 
```

Otherwise if you need to keep separate rows, just select all rows in one query:

```
$res = mysql_query("select * from tags where file='cyclist.jpg'"); 
```

and then iterate them to fulfil 'merged' record:

```
$res = mysql_query("select * from tags_table where file='cyclist.jpg'");

$mergedRow = array();

while ($row = mysql_fetch_assoc($res)) {
    foreach ($row as $rowKey => $rowValue) {
        if (!array_key_exists($rowKey, $mergedRow)) {
            $mergedRow[$rowKey] = $rowValue;
        }
    }
} 
```

Edit:

As promised here's a sample of joining two rows into one with single query, however I would still recommend `$mergedRow` approach in PHP to merging them :)

```
CREATE TABLE `files_table` (
  `id` int(11) unsigned NOT NULL AUTO_INCREMENT,
  `tag_type` enum('PARENT','CHILD') NOT NULL DEFAULT 'PARENT',
  `date` date DEFAULT NULL,
  `file` varchar(255) NOT NULL DEFAULT '',
  `face` smallint(4) NOT NULL DEFAULT '0',
  PRIMARY KEY (`id`)
) ENGINE=MyISAM AUTO_INCREMENT=1 DEFAULT CHARSET=utf8; 
```

Then you can 'pair' PARENT-CHILDREN sets with:

```
SELECT t1.file, t1.date, t2.face
    FROM files_table AS t1 JOIN files_table AS t2 ON (t1.file = t2.file)
    WHERE t1.tag_type = 'PARENT' AND t2.tag_type = 'CHILD'
    GROUP BY file 
```

# matlab - 在 Matlab 绘图的刻度标签中删除科学记数法

> ID：10454047
> 
> 赞同：11
> 
> 时间：2012-05-04T18:15:28.577
> 
> 标签：matlab, plot, label

我在 Matlab 中做了一个情节，使用：

```
hold on
plot(t1,Dx1,'r')
xlabel('t (ps)')
ylabel('Deviation of coordinate from initial coordinate (Å)')
plot(t1,Dy1,'g')
plot(t1,Dz1,'b')
hold off 
```

但是，y 轴上的刻度标签是以科学计数法生成的：

![y 轴上的科学记数法](../Images/052097aa58435666765dbcbd5a76fd44.png)

有什么办法可以删除科学记数法，只让 y 标签范围从 -0.0025 到 0.0005？谢谢！

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-05-04T18:53:24.857

您可以尝试使用 sprintf 自己手动设置刻度标签：

```
yt = get(gca,'YTick');
set(gca,'YTickLabel', sprintf('%.4f|',yt)) 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2017-02-07T02:43:00.730

创建轴后尝试添加：

```
ax = gca;
ax.YAxis.Exponent = 0; 
```

这是一个例子：

```
x = 0:0.1:10;
y = 1000*x.^2;

%Plot with default notation:

subplot(1,2,1)
plot(x,y)

%Plot without exponent:

subplot(1,2,2)
plot(x,y)
ax = gca
ax.YAxis.Exponent = 0; 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-12-14T18:36:19.223

我还努力让我的绘图轴以固定概念而不是科学记数法显示。对我来说最令人沮丧的部分是，即使在我手动将刻度标签重新分配为固定符号后，“x10^4”标签仍会保留在绘图框的边缘。最后，感谢上面的帖子，我在图形渲染器中跟踪了问题。我正在使用“OpenGL”。当我更改为“zbuffer”时，“x10^4”标签会在我手动重置刻度标签时正确消失。这是一个示例代码，它将 '###,###.0' 格式应用到 y 轴标签，甚至在缩放/平移等时动态更新 y 标签，这要归功于我在Matlab 文件交换。找到其他两个函数的位置包含在示例函数下面的注释中。

```
function []=TickFixExample()

figure %this one works
myRenderer='zbuffer';
set(gcf,'Renderer', myRenderer); 
axesh = axes();
set(gca,'YLim',[20000 20100]);
title(myRenderer)
ticklabelformat(gca,'y','###,###.0');

figure %this one doesn’t work
myRenderer='OpenGL';
set(gcf,'Renderer', myRenderer); 
axesh = axes();
set(gca,'YLim',[20000 20100]);
title(myRenderer)
ticklabelformat(gca,'y','###,###.0'); 
```

Y. Altman 的函数 ticklabelformat(hAxes,axName,format)，可在以下位置找到：http: [//www.mathworks.com/matlabcentral/fileexchange/36254-ticklabelformat-set-a-dynamic-format-of-axes-tick -labels](http://www.mathworks.com/matlabcentral/fileexchange/36254-ticklabelformat-set-a-dynamic-format-of-axes-tick-labels) 或通过谷歌搜索 'ticklabelformat matlab' 我通过更改第 105 行对其稍作修改，如下所示：

```
 tickLabels = arrayfun(@(x)(FormatNumberScalarInputStrOutput`(x,format)),tickValues,'UniformOutput',false);` 
```

代替奥特曼的版本：

```
tickLabels = arrayfun(@(x)(sprintf(format,x)),tickValues,'UniformOutput',false); 
```

该更改通过 S. Lienhard 的函数 y = NumberFormatter( Numbers , FormatPattern ) 提供了千位逗号分隔符功能，也在 Matlab File Exchange 上。我修改后的 Lienhard 代码如下：

```
function y = FormatNumberScalarInputStrOutput(Number ,FormatPattern)

 % adapted 12-2012 by D. Bourgoyne from NUMBERFORMATTER by S. Lienhard
% 
%   The pound sign (#) denotes a digit, the comma is a placeholder for the
%   grouping separator, and the period is a placeholder for the decimal
%   separator.
%   The pattern specifies leading and trailing zeros, because the 0
%   character is used instead of the pound sign (#).
% 
%   Examples:
%   NumberFormatter(rand(5),'0.000')
%   NumberFormatter(rand(5)*100,'###,###.000') 
import java.text.*
v = DecimalFormat(FormatPattern);
y = char(v.format(Number)); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-08-07T14:49:36.957

您必须编写以下内容：

```
set(gcf, 'renderer', 'zbuffer') 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-05-04T18:57:42.380

您可以使用此代码来控制 y 轴刻度标签的格式。此代码源自 ticks_format.m 。

% 在这里设置首选的刻度格式。

```
y_formatstring = '%3.4f'; 
```

% 这是代码。

```
ytick = get(gca, 'ytick');
for i = 1:length(ytick)
    yticklabel{i} = sprintf(y_formatstring, ytick(i));
end
set(gca, 'yticklabel', yticklabel) 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2019-08-05T08:44:04.927

在较新版本的 matlab (2016b) 上，您可以使用函数 ytickformat 和 xtickformat 轻松更改标签的格式。

# vba - VBA 编辑器数据类型不匹配

> ID：10454049
> 
> 赞同：3
> 
> 时间：2012-05-04T18:15:33.647
> 
> 标签：vba, types, mismatch

在 access 2007 中运行时，我不断收到“数据类型不匹配”，

我已经看了一段时间，无法弄清楚。

```
Private Sub Combo7_AfterUpdate()
    Dim clString As Integer
    clString = Me![Combo7].Value
    strSQL = "SELECT [Categorized Tables].[Name of Table] " & _
             "INTO [catTemp] " & _
             "FROM [Categorized Tables] " & _
             "WHERE [Categorized Tables].[Category] = " & clString
    DoCmd.SetWarnings False
    DoCmd.RunSQL strSQL
    DoCmd.SetWarnings True
End Sub 
```

调试器指向 DoCmd.RunSQL strSQL 行。

有人知道我哪里出错了吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-30T16:04:06.940

Siddharth Rout 的回答：

“试试这个 `clString = Val(Me![Combo7].Value)`”

# perl - perl“或”错误处理：可能的错误多语句？

> ID：10454061
> 
> 赞同：7
> 
> 时间：2012-05-04T18:16:27.620
> 
> 标签：perl

这种结构在 perl 中很常见：

```
opendir (B,"/somedir") or die "couldn't open dir!"; 
```

但这似乎不起作用：

```
opendir ( B, "/does-not-exist " ) or {
    print "sorry, that directory doesn't exist.\n";
    print "now I eat fugu.\n";
    exit 1;
}; 
```

“或”错误处理是否可能有多个命令？

编译上述内容：

```
# perl -c test.pl
syntax error at test.pl line 5, near "print"
syntax error at test.pl line 7, near "}"
test.pl had compilation errors. 
```

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2012-05-04T18:20:12.653

您可以随时使用[`do`](http://perldoc.perl.org/functions/do.html)：

```
opendir ( B, "/does-not-exist " ) or do {
    print "sorry, that directory doesn't exist.\n";
    print "now I eat fugu.\n";
    exit 1;
} 
```

或者您可以使用如果/除非：

```
unless (opendir ( B, "/does-not-exist " )) {
    print "sorry, that directory doesn't exist.\n";
    print "now I eat fugu.\n";
    exit 1;
} 
```

或者你可以一起摆动你自己的子程序：

```
opendir ( B, "/does-not-exist " ) or fugu();

sub fugu {
    print "sorry, that directory doesn't exist.\n";
    print "now I eat fugu.\n";
    exit 1;
} 
```

有不止一种方法可以做到这一点。

* * *

## 回答 #2

> 赞同：-2
> 
> 时间：2012-05-04T18:20:29.530

Perl 中的异常处理是用*eval()*

```
eval {
    ...
} or do {
    ...Use $@ to handle the error...
}; 
```

# spring - 春天+休眠+窗体

> ID：10454068
> 
> 赞同：0
> 
> 时间：2012-05-04T18:16:52.617
> 
> 标签：spring, hibernate, jsp

我有一个用户实体：

```
@Entity
@Table(name = "user")
public class User implements Serializable{
private enum Sex {MALE, FEMALE};

@Id @GeneratedValue
private Long id;
@NotNull
private String name;
    @NotNull
    private String password;
} 
```

控制器：

```
@Controller
public class HomeController {
@RequestMapping("/addUser")
public String showHomePage(Map<String, Object> map) {
    map.put("user", new User());
    return "addUser";
} 
```

并在jsp文件中形成

```
<form:form method="post" action="add" commandName="user"> 
     <form:input path="name"/>
     <form:input path="password"/>
     <form:input path="confirm-password"/>
</form:form> 
```

此表单会生成错误，因为`confirm-password`. `User.class`我当然可以添加`confirm-password`字段 as `@Transient`to `User.class`，但是如果我想在我的表单中添加验证码字段怎么办。是否有其他方法可以向表单添加其他字段？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-04T18:46:37.953

将模型用作表单实体不是一个好习惯。您应该有一个 bean 或表单类来从视图和另一个模型中获取数据。

原因是它们有不同的职责，因此需要映射到不同的类。它们通常非常相似，但这种分离促进了更清晰的编码并避免了安全漏洞，因为用户可以尝试通过使用请求篡改器（如 fire bug）从视图中使用您的模型变量。

它们之间的这些微小差异就像您上面列出的那样证明了创建另一个类是合理的。

# iphone - self.navigationItem.titleView setNeedsDisplay 来自异步队列时刷新缓慢

> ID：10454069
> 
> 赞同：0
> 
> 时间：2012-05-04T18:16:54.640
> 
> 标签：iphone, xcode

我正在显示一长串需要用 3 个索引（名称、日期、id）排序的项目。然后我在 self.navigationItem.titleView 中显示带有 UISegmentControl 的列表。用户可以使用该控件来选择他想要显示的排序顺序。然后，用户可以选择根据某些类别过滤该列表。然后我必须再次对列表进行排序，因为使用新的过滤列表可能只会显示一个名称，因此我不想按名称显示排序顺序。所以我需要排序才能重置 UISegmentControl。由于排序需要几秒钟，我将其推送到另一个线程中。这是我的代码：

```
- (void)observeValueForKeyPath:(NSString *)keyPath ofObject:(id)object change:(NSDictionary *)change context:(void *)context
{
if ([keyPath isEqualToString:@"value"]) {
    //The filter value has changed, so I have to redo the sort

        [[self navigationItem] setTitleView:NULL];
        [[self navigationItem] setTitle:@""];
        self.navigationItem.rightBarButtonItem.enabled = false;
        [self.tableView reloadData]; //I reload here because I want to display Loading... on my table (another var has been set before hands so the tableview will display that)

        dispatch_async(backgroundQueue, ^(void) {
            [self displayAfterFilterChanged];  
        });
}
}

-(void) displayAfterFilterChanged
{
displayState = DISPLAYRUNNING;
[self setupSort];  //<<< this is where the 3 sort index are setup based on the filter
dispatch_async(dispatch_get_main_queue(), ^(void) {  //<<< I call all the UI stuff in the main_queue. (remember that this method has been call from dispatch_async)
    [self.tableView reloadData]; //<< the table will display with the sorted and filtered data 
    self.navigationItem.rightBarButtonItem.enabled = true;
    if (!self.leSelecteur) { //<<< if I don't have a UISegmentControl I display a title text
        [[self navigationItem] setTitle:@"atitle"];
    } else { // I have a UISegmentControl, so I use it. 
        [[self navigationItem] setTitleView:self.leSelecteur];
        NSLog(@"before setneedsdisplay");
        [self.navigationItem.titleView setNeedsDisplay];
        NSLog(@"after setneedsdisplay");
    }
});
} 
```

现在，问题：表格立即重新显示，rightbarbuttonitem 立即启用。但是 navigationItem titleView 需要 5-10 秒才能显示出来。看起来它正在跳过一个显示周期并捕捉下一个。有什么办法可以加快速度吗？我可以看到“before setNeedsdisplay”和“after setneedsdisplay”立即显示在日志上。但实际刷新发生在 5-10 秒后。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-04T19:27:56.377

尝试将 displayAfterFilterChanged 中的 dispatch_async(dispatch_get_main_queue(), ^(void) { 更改为 dispatch_sync(dispatch_get_main_queue(), ^(void) { 这是关于您的代码的唯一对我来说似乎不合适的事情。因为您对 displayAfterFilterChanged 的​​调用已经在运行异步我假设您希望 [self setupSort]; 阻止然后您的所有 UI 代码在 UI 线程上同步运行。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-04T19:29:29.280

您的 UI 代码应该在主线程上运行。不要创建单独的线程并在 UI 上执行任务。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-07T13:09:06.457

好的，我知道了。我实际上是在线程中构建我的 UISegmentControl 。所以我在玩UI而不是在主线程中（坏小子......拍打，拍打;））。我移动了所有代码以在主线程中调用的块中创建控件，瞧，它起作用了。谢谢你们

# ios - iOS中的模态提示类名称？

> ID：10454070
> 
> 赞同：1
> 
> 时间：2012-05-04T18:16:58.167
> 
> 标签：ios, ios5, ios4

所以我在类的名称上完全画了一个空白，该类使用多个选项绘制这些模式提示之一。我附上了截图。这是确认用户是否要退出的提示。

![模态提示截图](../Images/729ba81b3ac58008f1d28125437ff23d.png)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-04T18:18:43.250

那是一个`UIActionSheet`，阅读[UIActionSheet 类参考](http://developer.apple.com/library/ios/#DOCUMENTATION/UIKit/Reference/UIActionSheet_Class/Reference/Reference.html)。

## 例子

在您的标头中，您需要添加`<UIActionSheetDelegate>`协议。然后在你的`@implementation`这就是你如何调用这个特定的工作表：

```
UIActionSheet * sampleSheet = [[UIActionSheet alloc] initWithTitle:@"Are you sure you'd like to sign out from Path?" delegate:self 
                                        cancelButtonTitle:@"Cancel" destructiveButtonTitle:@"Sign Out" otherButtonTitles:nil];

[sampleSheet setActionSheetStyle:UIActionSheetStyleBlackTranslucent];
[sampleSheet showInView:self.view]; 
```

这就是您处理工作表的方式：

```
-(void)actionSheet:(UIActionSheet *)actionSheet clickedButtonAtIndex:(NSInteger)buttonIndex 
{
    switch ( buttonIndex )
    {
        case 0:
            NSLog(@"User Chose Cancel");
            break;

        case 1:
            NSLog(@"User Chose to Sign out.");
            break;
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-04T18:20:27.517

你想要[UIActionSheet 类参考](http://developer.apple.com/library/ios/#DOCUMENTATION/UIKit/Reference/UIActionSheet_Class/Reference/Reference.html)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-04T18:21:31.200

请参阅 UIActionSheet，我认为这就是您正在寻找的课程。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-04T18:22:35.207

```
UIActionSheet *popupQuery;
if ([UIImagePickerController isSourceTypeAvailable:UIImagePickerControllerSourceTypeCamera]) { 

    //give the user an option to choose an image from their library or take a new photo...
    popupQuery = [[UIActionSheet alloc] initWithTitle:nil delegate:self cancelButtonTitle:@"Cancel" destructiveButtonTitle:nil otherButtonTitles:@"Take Photo", @"Choose From Library", nil];

    popupQuery.tag = 0;
}
else {

    //give the user an option to choose an image from their library or take a new photo...
    popupQuery = [[UIActionSheet alloc] initWithTitle:nil delegate:self cancelButtonTitle:@"Cancel" destructiveButtonTitle:nil otherButtonTitles:@"Choose From Library", nil];

    popupQuery.tag = 1;
}
popupQuery.actionSheetStyle = UIActionSheetStyleBlackOpaque;
[popupQuery showInView:[self.view window]];

[popupQuery release]; 
```

# sas - 引号 SAS (+) PROC FORMAT value|invalue

> ID：10454072
> 
> 赞同：0
> 
> 时间：2012-05-04T18:17:10.323
> 
> 标签：sas

我仍然坚持使用 SAS 特殊字符处理。

```
 %macro mFormat();
    %do i=1 %to &numVar. ;
        proc format library = work ;
            invalue $ inf&&nomVar&i..s
            %do j=1 %to &&numMod&i.;
                "%superq(tb&i.mod&j.)" = &j.
            %end;
            ;
        run;
        proc format library = work ;
            value f&&nomVar&i..s
            %do k=1 %to &&numMod&i.;
                &k. = "%superq(tb&i.mod&k.)"
            %end;
            ;
        run;
    %end;
%mend mFormat;
%mFormat(); 
```

如您所见，程序假设为每个变量创建格式和信息。我唯一的问题是当变量名称解析为包含

GOTAN-GOTAN
FRANCES-FRANCES
+&DECO-+DECO&
等...

这些名称导致我出现此错误

> “错误：此范围重复，或值重叠：”</p>

我希望我可以强制 SAS 读取这些名称。或者，这不是为包含这些字符（&、%、-、'、"）的变量生成 FORMATS 和 INFORMATS 的最佳方法。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-04T19:17:53.077

我认为炒作是您提供的样本的问题。也许您可以使用字符替换功能将[连](http://support.sas.com/documentation/cdl/en/lrdict/64316/HTML/default/viewer.htm#a000215153.htm)字符（或其他问题字符）转换为空格或下划线等其他内容。

```
%Let Test=One-Two;
 %Put &test;
%Let Test=%sysfunc(translate(&test,%str(_),%str(-)));
 %Put &test; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-06T19:22:38.210

因为您的宏使用了很多全局宏变量，所以很难看出问题所在。该错误消息表明您的宏正在为 PROC FORMAT 生成重复范围。完整的错误消息应该告诉您哪个范围有误；如果这就是你所看到的，我的猜测是你的更多宏变量解析为空白。

在定义 PROC FORMAT 范围时，对使用连字符没有限制。我编了一个小例子来说明：

```
proc format library = work ;
   invalue infs
     'GOTAN-GOTAN'     = 1
     'FRANCES-FRANCES' = 2
     '+&DECO-+DECO&'   = 3;
   value fs
     1 = 'GOTAN-GOTAN'
     2 = 'FRANCES-FRANCES'
     3 = '+&DECO-+DECO&';
run;
data a;
   test = 'FRANCES-FRANCES';
   in_test = input(test,infs.);
   put test= in_test= in_test= fs.;
run; 
```

尽管您可能会找到一些技巧来解决您的宏问题，但我建议您放弃它并使用 PROC FORMAT 的 CNTLIN 选项来使用数据集来创建您的自定义格式和信息。这肯定会使事情更容易维护，也可能有助于为您的项目创建一些有用的元数据。这是一个创建与上面相同的格式和信息的简单示例：

```
data fmt_defs;
   length fmtname start label $32 type $1;

   fmtname = 'INFS';
   type = 'I';
   start = 'GOTAN-GOTAN';     label = '1'; output;
   start = 'FRANCES-FRANCES'; label = '2'; output;
   start = '+&DECO-+DECO&';   label = '3'; output;

   fmtname = 'FS';
   type = 'N';
   start = '1';  label='GOTAN-GOTAN';     output;
   start = '2';  label='FRANCES-FRANCES'; output;
   start = '3';  label='+&DECO-+DECO&';   output;
run;
proc format library = work cntLin=fmt_defs;
run; 
```

您可以在在线文档中找到有关 PROC FORMAT 的更多信息。

祝你好运，鲍勃

# llvm - 避免遍历包含的系统库

> ID：10454075
> 
> 赞同：2
> 
> 时间：2012-05-04T18:17:16.857
> 
> 标签：llvm, clang

我现在正在使用**LLVM** + **Clang**。我使用**ASTUnit**构建树，并使用**RecursiveASTVisitor**遍历树。

```
 clang::ASTUnit* AST;
    clang::DiagnosticOptions diagOpts;
    llvm::IntrusiveRefCntPtr<clang::Diagnostic> diags = clang::CompilerInstance::createDiagnostics(diagOpts, 0, 0);

    const char** ptr = new const char*[1];
    ptr[0] = argv[1];

    clang::CompilerInvocation *ci = new clang::CompilerInvocation();
    clang::CompilerInvocation::CreateFromArgs(*ci, ptr, ptr+1, *diags);
    ci->setLangDefaults(clang::IK_CXX, clang::LangStandard::lang_cxx98);
    ci->getPreprocessorOutputOpts().ShowComments = 1;
    ci->getPreprocessorOutputOpts().ShowLineMarkers = 1;

    AST = clang::ASTUnit::LoadFromCompilerInvocation(ci, diags);

    ...
    ...

    MyRecursiveASTVisitor myvis(AST->getASTContext());
    myvis.TraverseDecl(AST->getASTContext().getTranslationUnitDecl()); 
```

我想避免访问包含的系统库。可能吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-07T16:41:18.217

我想我找到了某种解决方案，但不是最后一个！

在继承的 ASTVisitor 类中：

```
class MyRecursiveASTVisitor : public clang::RecursiveASTVisitor<MyRecursiveASTVisitor> 
```

您可以覆盖函数**TraverseDecl**。在此函数中，您可以遍历声明。如果不递归调用这个函数，当声明不是来自主文件时，可以避免遍历其他文件的声明。

```
bool TraverseDecl ( clang::Decl *D )
{
    bool rval;

    if (!D) return true;

    if (sm.isFromMainFile(D->getLocation()) || std::string(D->getDeclKindName()) == "TranslationUnit")
    {
        bool rval = clang::RecursiveASTVisitor<MyRecursiveASTVisitor>::TraverseDecl(D);
    }
    else
        rval = true;

    return rval;
} 
```

在这种情况下，**sm**是类**MyRecursiveASTVisitor的****clang::SourceManager**。您可以避免在覆盖的**TraverseStmt**函数中以同样的方式遍历来自其他文件的语句。

 ****现在我只知道如何知道语句或声明是来自系统库还是用户定义的库。****

# php - PHPass 认证时出错

> ID：10454077
> 
> 赞同：1
> 
> 时间：2012-05-04T18:17:29.277
> 
> 标签：php, mysql, mysqli

我正在使用 PHPPass 进行密码加密和验证登录。

当我尝试登录时，它给出了错误：_

警告：mysqli::prepare() [mysqli.prepare]: 无效的对象或资源 C:\mysqli rootfile-blahblahblah\includes\user.php 在第 41 行

致命错误：在第 43 行的 C:\rootfile-blahblahblah\includes\user.php 中的非对象上调用成员函数 bind_param()

我按照手册进行身份验证，但由于某种原因它无法正常工作。

这是身份验证功能的代码

```
 public static function authenticate($username, $password)
{
    $pwdhasher = new PasswordHash(8, FALSE);
    $hashed_pwd = $pwdhasher->HashPassword($password);

    $db = new mysqli();
$stmt = $db->prepare("SELECT hashed_password FROM users WHERE username=? LIMIT 1");
    if (!$stmt) die($db->error);
$stmt->bind_param('s', $username);
$stmt->execute();
$stmt->bind_result($hashed_pwd);

if ($pwdhasher->CheckPassword($password, $hashed_pwd)) {
    return true;
} else {
    return false;
}
unset($pwdhasher);

} 
```

对于运行函数的 login.php 页面：_

```
$username = $database->escape_value(trim($_POST['username']));
$password = $database->escape_value(trim($_POST['password']));

    $user = User::find_by_id(1);
    $found_user = User::authenticate($username, $password);

    if ($found_user)
    {
        $session->login($found_user, $user);
        $message = "You have Logged in.";
        redirect_to("index.php");
    }
    else { $message = "Incorrect username/password."; }

} 
```

我已经搜索并尝试了很多东西，但无济于事。：/

现在你看，我想要的是检查数据库中的用户名和哈希密码，如果它们正确则登录，我知道如何检查密码（）并用 HashPassword 加密，但我找不到如何制作它验证用户名和密码....

# linux - 管道仅读取一行输入的程序的最佳方法

> ID：10454080
> 
> 赞同：2
> 
> 时间：2012-05-04T18:17:30.840
> 
> 标签：linux, bash

假设我有一个命令 cmd1 从标准输入读取一行输入并产生一行输出。我还有另一个命令 cmd2 产生多行输出。如何在 linux 中通过管道传输这两个命令，以便为 cmd2 生成的每一行执行 cmd1？如果我只是这样做：

```
# cmd2 | cmd1 
```

cmd1 将仅从 cmd2 获取第一行输出，产生一行输出然后关闭。我知道我可以使用像 perl 这样的解释器来完成这项工作，但我想知道是否有一种干净的方法可以只使用 bash 脚本来完成这项工作。

谢谢

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-05-04T18:33:46.057

你可以使用这样的`while`循环：

```
#! /bin/bash
IFS=$'\n'
while read -r line ; do
    echo "$line" | cmd1
done < <(cmd2) 
```

应保留行中的空格。（其中`-r`是`read`进入[“原始”模式](http://wiki.bash-hackers.org/commands/builtin/read)以防止反斜杠解释。）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-04T18:32:13.620

```
cmd2 | while read line; do echo $line | cmd1; done 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-09T21:31:58.177

我有一种感觉，多个`cmd1`可以并行运行。

如果你安装了 GNU Parallel [http://www.gnu.org/software/parallel/](http://www.gnu.org/software/parallel/)你可以这样做：

```
cmd2 | parallel --pipe -N1 cmd1 
```

您可以通过以下方式安装 GNU Parallel：

```
wget http://git.savannah.gnu.org/cgit/parallel.git/plain/src/parallel
chmod 755 parallel
cp parallel sem 
```

观看 GNU Parallel 的介绍视频以了解更多信息： [https ://www.youtube.com/playlist?list=PL284C9FF2488BC6D1](https://www.youtube.com/playlist?list=PL284C9FF2488BC6D1)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-07-07T08:56:33.077

```
cmd2 | awk '{ system( "echo " $1 " | cmd1" ) }' 
```

`.htaccess`一个有用的例子，我在所有站点上验证文件的所有权/权限。

```
find /var/www/html/ -name .htaccess | awk '{ system( "ls -lA " $1 ) }' 
```

# c++ - C/C++ 可视化库

> ID：10454084
> 
> 赞同：-3
> 
> 时间：2012-05-04T18:17:44.717
> 
> 标签：c++, c, image-processing

是否有任何 C 和 C++ 库支持（相对）简单的 2D 识别任务？[简单我的意思是小动作，固定背景等）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-04T18:19:02.520

[OpenCV](http://opencv.willowgarage.com/wiki/)可能是您的最佳选择，但您仍然需要很好地了解它是如何工作的！

# ruby - Ruby Regex：在模式后返回多个匹配项

> ID：10454088
> 
> 赞同：0
> 
> 时间：2012-05-04T18:17:56.153
> 
> 标签：ruby, regex, capture

我现在已经用谷歌搜索了很多，但我自己无法弄清楚这个正则表达式。我想收集在“验证日：”和“all_exception_rules”文本之间发生的一周中的所有日子：

要搜索的字符串：

> --- !ruby/object:IceCube::Schedule start_time: 2012-04-28 13:38:49.334561000 -07:00 end_time: duration: all_recurrence_rules: - !ruby/object:IceCube::WeeklyRule 验证：:interval: - !ruby/object:IceCube::Validations::WeeklyInterval::Validation 间隔：1 week_start::sunday :base_hour: - !ruby/object:IceCube::Validations::ScheduleLock::Validation 类型::hour :base_min: - ! ruby/object:IceCube::Validations::ScheduleLock::Validation 类型: :min :base_sec: - !ruby/object:IceCube::Validations::ScheduleLock::Validation 类型: :sec :day: - !ruby/object: IceCube::Validations::Day::Validation day: -**周一 - 周二 - 周三 - 周四 - 周五**all_exception_rules: []

我最接近 rubular 的是：`/Validation day: - (.*) all_exception/`. 这会以 rubular 形式显示所有天（加上空格和破折号），但会`Nil`在我的 rails 应用程序中返回。

*   知道为什么这适用于rubular，但不适用于我的应用程序？

*   有没有一种简单的方法可以在没有空格和破折号的情况下获取一系列日期？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-04T18:25:46.563

这有帮助吗？

```
s.scan(/-\s(\w+)\s/) 
#=> [["monday"], ["tuesday"], ["wednesday"], ["thursday"], ["friday"]] 
```

或者：

```
s.scan(/-\s(\w+)\s/).map(&:first).join(" ") 
#=> "monday tuesday wednesday thursday friday" 
```

# php - Mac 和 Windows 电子邮件应用程序的换行符是什么？\r\n 或 \n\n

> ID：10454090
> 
> 赞同：0
> 
> 时间：2012-05-04T18:18:01.013
> 
> 标签：php

我在这里阅读了有关此主题的其他一些帖子。我知道这`\r\n`适用于 Windows，`\n`适用于 Unix，那么推荐给所有用户使用哪个？我正在发送一封电子邮件，并希望 Mac 和 Windows 用户都有换行符

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-04T18:23:18.343

邮件格式由 RFC 指定：查看 [http://www.ietf.org/rfc/rfc2822.txt](http://www.ietf.org/rfc/rfc2822.txt)

它说

消息被分成多行字符。行是由回车和换行这两个字符分隔的一系列字符；即，回车 (CR) 字符（ASCII 值 13）紧跟换行 (LF) 字符（ASCII 值 10）。（回车/换行对在本文档中通常写为“CRLF”。）

所以这将是 \r\n 不管邮件客户端。它与存储在本地计算机上的文本文件不同。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-04T18:28:38.880

我发现`\r\n`Outlook 2007 中存在问题。使用`\n`似乎适用于我测试过的所有客户端。

```
$headers = "MIME-Version: 1.0\n";
$headers .= "Content-Type: text/html; charset=ISO-8859-1\n";
$headers .= "From: " .  $from . "\n"; 
$headers .= "Reply-To: ". $from . "\n"; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-04T18:25:51.050

\r\n，也称为 CRLF（carrage return, line feed），在 RFC 2822 中定义为正确的行结尾。

您可能希望使用 MIME 编码器来格式化您的电子邮件消息中的富文本/html。

# java - 解析出维基百科的 IPAc

> ID：10454092
> 
> 赞同：0
> 
> 时间：2012-05-04T18:18:04.467
> 
> 标签：java, regex

我想从维基百科标记中解析出 IPAc 模板的内容，例如：

```
'''Konjac''' ({{IPAc-en|lang|pron|ˈ|k|oʊ|n|j|æ|k}}) 
```

魔芋（英文发音：/ˈkoʊnjæk/）

```
'''Konjac''' ({{IPAc-en|lang|pron|ˈ|k|oʊ|n|j|æ|k}} {{respell|KOHN|yak}}) 
```

魔芋（英文发音：/ˈkoʊnjæk/ kohn-yak）

```
''Konjac'' is pronounced {{IPAc-en|ˈ|k|oʊ|n|j|æ|k}} in English. 
```

魔芋在英语中发音为 /ˈkoʊnjæk/。

我需要什么正则表达式来提取此内容`|k|oʊ|n|j|æ|k`我不知道如何匹配可能存在但可能不存在的内容（`lang|pron`）

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-04T19:27:44.427

我会试试这个：

```
IPAc-en(?:\w|[|])+.(?:[|]|([^}]))+(?:}}\s*{{respell(?:[|]|([^}]))+)? 
```

它应该匹配主要的发音以及可选的“respell”东西。

两个发音的匹配项都将在捕获组中，因此您应该能够从 java 访问它。

解释：

*   `IPAc-en(?:\w|[|])+.`- 尽可能多地匹配开头，然后是单词字符或管道。匹配另一个字符（这是发音开始的有趣字符）。不要捕捉任何东西。

*   `(?:[|]|([^}]))+`- 匹配一个管道（不要捕获）或任何不是右大括号的东西（捕获 - 那是你想要的字符）。重复直到字符串的末尾或直到找到 }

*   `(?:}}\s*{{respell(?:[|]|([^}]))+)?`- 然后可选地匹配括号并重新拼写文本并使用与上述相同的逻辑来捕获字母。

# ruby-on-rails - 尝试在我的数据库中创建记录时 NilClass:Class 的未定义方法“model_name”

> ID：10454095
> 
> 赞同：0
> 
> 时间：2012-05-04T18:18:09.787
> 
> 标签：ruby-on-rails, ruby-on-rails-3, twitter-bootstrap

我的 Rails 应用程序有问题。

当我尝试`client`在我的`clients`表中创建一个新的时，我得到了这个错误 =>`undefined method model_name for NilClass:Class`

它告诉我错误出现在我的第 2 行的显示视图中。

```
1: <%- model_class = @client.class -%>
2: <h1><%=t '.title', :default => model_class.model_name.human %></h1>
3: 
4: <p>
5:   <strong><%= model_class.human_attribute_name(:name) %>:</strong><br> 
```

这是我的节目视图..

```
<%- model_class = @client.class -%>
<h1><%=t '.title', :default => model_class.model_name.human %></h1>

<p>
  <strong><%= model_class.human_attribute_name(:name) %>:</strong><br>
  <%= @client.name %>
</p>
<p>
  <strong><%= model_class.human_attribute_name(:detail) %>:</strong><br>
  <%= @client.detail %>
</p>
<p>
  <strong><%= model_class.human_attribute_name(:more_detail) %>:</strong><br>
  <%= @client.more_detail %>
</p>
<p>
  <strong><%= model_class.human_attribute_name(:more_details) %>:</strong><br>
  <%= @client.more_details %>
</p>

<div class="form-actions">
  <%= link_to t('.back', :default => t("helpers.links.back")),
              clients_path, :class => 'btn'  %>
  <%= link_to t('.edit', :default => t("helpers.links.edit")),
              edit_client_path(@client), :class => 'btn' %>
  <%= link_to t('.destroy', :default => t("helpers.links.destroy")),
              client_path(@client),
              :method => 'delete',
              :confirm => t('.confirm', :default => t("helpers.links.confirm", :default => 'Are you sure?')),
              :class => 'btn btn-danger' %>
</div> 
```

这是我的控制器 =>

> 类 ClientsController < ApplicationController
> 
> ```
>  respond_to :html
> 
>   def index
>     @clients = Client.all
>     respond_with (@clients)
>   end
> 
>   def new
>     @clients = Client.new
>     respond_with (@clients)
>   end
> 
>   def create
>     @clients = Client.new(params[:name])
>     if @clients.save
>       flash[:notice] = "Client successfully created"
>     end
>     respond_with(@clients)
>   end
> 
>   def destroy
>   @clients = Client.find(params[:id])
>   @clients.destroy
>   flash[:notice] = "Client has been removed."
>   respond_with(@clients)
>   end
> 
> end 
> ```

我看不出问题出在哪里？

我最近安装了 rails-twitter-bootstrap gem，但认为这不会对其产生太大影响。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-04T18:46:09.937

你在你的控制器中设置`@clients`(with`s`在最后) 的值并在你的视图中访问`@client`变量，即没有`s`. 解决这个问题。

# android - Android 启动取消！控制台错误

> ID：10454096
> 
> 赞同：2
> 
> 时间：2012-05-04T18:18:15.460
> 
> 标签：android, adb, uninstallation, launch

当我在设备/模拟器上运行应用程序时出现错误

```
Re-installation failed due to different application signatures. [2011-04-19 10:11:20 - enga] You must perform a full uninstall of the application. WARNING: This will remove the application data! [2011-04-19 10:11:20 - enga] Please execute 'adb uninstall com.engatest' in a shell. Launch canceled! 
```

在终端中执行命令。但是错误仍然存​​在。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-04T18:37:58.583

尝试从设备上卸载应用程序。如果问题仍然存在更改您的包名称。希望这能解决问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-06-25T12:57:09.717

只需在根外壳中使用即可完全删除

> pm 卸载 PACK.AGE.NAME

在你的情况下

> pm卸载com.engatest

# cakephp - MilesJ 的论坛插件和 CakeDC 的用户插件

> ID：10454097
> 
> 赞同：2
> 
> 时间：2012-05-04T18:18:23.017
> 
> 标签：cakephp, cakephp-2.0, cakephp-model, cakedc

如何使用 CakeDC 的用户插件实现 MilesJ 的论坛插件？

*   CakeDC 用户插件工作正常。
*   MilesJ 的 Forum Plugin 用于与之前的自写用户系统一起使用（不使用插件）

[在http://milesj.me/code/cakephp/forum#user-setup](http://milesj.me/code/cakephp/forum#user-setup)上实现论坛插件的说明。然而，它并不期望用户系统使用插件。

这是模型“AppUser”（CakeDC 强制命名）：

```
App::uses('User', 'Users.Model');

类 AppUser 扩展用户 {
    公共 $useTable = '用户';
    public $hasOne = array('Forum.Profile');    
    public $hasMany = array('Forum.Access','Forum.Moderator'));

}

```

我不断收到以下错误...

```
警告 (512)：模型“用户”与模型“配置文件”没有关联 [CORE\Cake\Model\Behavior\ContainableBehavior.php，第 339 行]
警告 (512)：模型“用户”与模型“访问”无关 [CORE\Cake\Model\Behavior\ContainableBehavior.php，第 339 行]
警告 (512)：模型“用户”与模型“配置文件”没有关联 [CORE\Cake\Model\Behavior\ContainableBehavior.php，第 339 行]
警告 (512)：模型“用户”与模型“访问”无关 [CORE\Cake\Model\Behavior\ContainableBehavior.php，第 339 行]

```

如何确保论坛和用户插件之间的关系正确？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-07T07:08:54.067

1.  下载插件并放入插件文件夹->`app/Plugin/`
2.  将文件夹名称重命名为“论坛”。
3.  现在去`app/Plugin/Forum/Config/Schema`

    文件夹并将所有 sql 文件放入您的数据库中，前缀为“forum_”

4.  如果您使用的是 auth 组件，那么它将自动工作，一旦完成上述步骤，请转到[http://example.com/forum/](http://example.com/forum/) 5.然后在您的用户模型（您的项目）中添加以下关系

    public $hasOne = array('个人资料' => array(

    ```
     'className' => 'Profile',

            'foreignKey' => 'user_id',

            'dependent' => true,

            'conditions' => '',

            'fields' => '',

            'order' => '',

            'limit' => '',

            'offset' => '',

            'exclusive' => '',

            'finderQuery' => '',

            'counterQuery' => ''

        ),
       ) 
    ```

5.  然后同样的 Access in has Many Relationship
6.  然后你会得到错误`Fatal error: Call to a member function image() on a non-object in /var/www/projectname/app/Plugin/Utils/View/Helper/GravatarHelper.php on line 89`

对于这些，将您的 HTML 帮助程序放在该应用程序/插件/实用程序/视图/Helper/ 中

最后一切都需要工作..刚才我开始实施这个..如果您遇到任何错误，请告诉我

# gdb - mdb 替代 gdb 的 catch throw？

> ID：10454099
> 
> 赞同：0
> 
> 时间：2012-05-04T18:18:37.580
> 
> 标签：gdb, solaris, mdbg

我不是 gdb 和 mdb 方面的专家，但我知道的是：-

```
 `(gdb) catch throw` 
```

这将在任何时候引发异常时中断
我在 mdb 中有任何类似的命令会在任何时候引发异常时中断吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-08T18:04:03.800

不，这不存在。这是因为在 Solaris 上，它取决于您的编译器和/或正在使用哪个 C++ ABI 的编译选项（以及如何抛出异常）。

`mdb`没有试图了解所有这些，`gdb`在 Solaris 上也没有（如果您编译它，`catch throw`将无法使用旧式或新式 Sun CC 二进制文件）。

您最好的选择是弄清楚“C++ ABI 钩子”是什么，即正在调用哪些隐藏/内部函数`throw()`，并为它们设置断点。或者，一旦你找到/枚举了这些钩子，编写你自己的模块来实现一个`::catch`命令（`mdb`是可扩展的 -*模块化*调试器）。

**编辑：（**无耻插件）另见[我的这个答案](https://stackoverflow.com/a/9600391/512360)（关于 C++ 异常和 DTrace；那里的“隐藏”函数名称也可用于`mdb`断点）。

# php - 在 PHP 中使用真正的单选按钮进行计算

> ID：10454109
> 
> 赞同：-3
> 
> 时间：2012-05-04T18:19:16.137
> 
> 标签：php, button, radio

我正在尝试使用真正的单选按钮的值来计算价格。目的是将文本框中的数字乘以用户选择的值。这是表格：

```
<form action="calculate.php" method="post">
    number: <input type="text" name="n" />
    <br />
    <input type="radio" name="1" value="110" /> option 1
    <br />
    <input type="radio" name="2" value="140" /> option 2
    <br />
    <input type="radio" name="3" value="200" /> option 3
    <br />
    <input type="submit" value="calculate"/>
</form> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-04T18:20:31.323

如果您想选择一个唯一的单选按钮名称应该相同。

```
<form action="calculate.php" method="post">
    number: <input type="text" name="n" />
    <br />
    <input type="radio" name="opt" value="110" /> option 1
    <br />
    <input type="radio" name="opt" value="140" /> option 2
    <br />
    <input type="radio" name="opt" value="200" /> option 3
    <br />
    <input type="submit" value="calculate"/>
</form> 
```

从 PHP 执行此操作

```
$price = $_POST['opt'] * $_POST['n']; 
```

# linux - Linux和Unix有什么区别？

> ID：10454110
> 
> 赞同：8
> 
> 时间：2012-05-04T18:19:19.250
> 
> 标签：linux, unix

有人可以解释一下Linux和Unix之间的主要区别吗？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-05-04T18:22:18.513

Unix 是在 70 年代贝尔实验室 AT&T 编写的。

Linux 是由 Linus Torvalds 编写的用于 PC 的 Unix 端口，并于 1991 年开源。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-04T18:21:40.693

检查这个：[http](http://www.unixguide.net/linux/lnag/lnag1.5.shtml) ://www.unixguide.net/linux/lnag/lnag1.5.shtml Linux 基本上是一个类似 unix 的内核，而 Unix 本身就是一个自建的内核。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-04T18:26:01.033

Unix 是为更多选择的受众（即服务器）设计的专有内核。它主要是专有代码。

Linux 是为一般用途的受众（即台式机）而设计的。它是开源的。Linux 基于 Unix。

# mysql - Mysql查询左连接错误

> ID：10454112
> 
> 赞同：0
> 
> 时间：2012-05-04T18:19:38.813
> 
> 标签：mysql

嘿，伙计们，一个快速的 mysql 问题，我得到了这个当前的查询，这让我头疼

```
SELECT stafflist.id, stafflist.full_name, (wages.wage /5) * stafflist.avgworkingdays AS workingwage ,
count(sick.d) AS DaysOffSick, variables.value AS VAT, count(hols.d) AS Prebooked_Holidays,

((((wages.wage /5) * stafflist.avgworkingdays)/stafflist.avgworkingdaysmonth)*count(sick.d)) AS daysoffsickvalue,
((((((wages.wage / 5) * stafflist.avgworkingdays) * 3 ) /100) * (100 + variables.value))/ (stafflist.avgworkingdaysmonth)) * (stafflist.avgworkingdaysmonth 
- count(hols.d)) AS Commision_target_After_Holidays

from stafflist 

LEFT JOIN wages ON wages.wagesid = stafflist.WageGrade
LEFT JOIN variables ON variables.company=stafflist.company and variables.name = 'VAT'
LEFT JOIN off AS sick ON sick.StaffMember = stafflist.id and sick.isitsick=1 AND sick.addedtowages=0
LEFT JOIN off As hols ON hols.StaffMember = stafflist.id and hols.isitsick=0 AND hols.addedtowages=0 AND hols.m = MONTH(now()) -1 AND hols.prebooked=1
WHERE stafflist.id = 48
GROUP By stafflist.full_name 
```

问题是我希望它计算有多少天被标记为病假，有多少天被标记为假期但是一旦我离开后再次加入表外并将其命名为 hols 字段 daysoffsick 拉出标记为假期的日期

你能帮我解决这个问题吗

问候谢恩

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-04T23:13:15.453

嘿，慢下来，据我了解，您只需要简单地计算生病的天数和按员工分组的预定假期的天数。您需要做的是在左连接中放置一个子查询。我提供了一个更简单的表格，其中包含您需要的数据和部分查询。

[http://sqlfiddle.com/#!2/8a73c/13](http://sqlfiddle.com/#!2/8a73c/13)

您可以将其余的查询插入在一起，但我相信这就是您所追求的

# xml - 任何尚未处理的节点的 XSLT 模板？

> ID：10454114
> 
> 赞同：5
> 
> 时间：2012-05-04T18:19:41.850
> 
> 标签：xml, xslt, default, failover

是否可以匹配“尚未匹配/处理的任何节点”？最好不要让我的样式表变成一个巨大的 for-each/Choose 语句，因为当前的顺序很关键。

该项目仍在开发中，并且已经在实时环境中使用，所以简单地说，代码处于快速变化的状态，以响应我们输入的实时数据。我正在通过 FO 从 XML 生成 PDF 文档其中可能有我还不知道的节点，并且想在我的 XSL-FO 转换中添加“故障转移”指令，将文档开头的所有下落不明的节点以鲜红色显示，以加快发现速度。

我不能只*忽略*惊喜节点，因为*需要*处理数据。我越快找到“孤儿”数据，我就能越快得到妥善处理并将其排除在外。

我尝试过使用`<xsl:template match="*">...</xsl:template>`各种 priority="" 设置，但它当然适用于每个节点。

例如，我可能在一个部分中有这个，因为这些 XML 块不能保证以正确的输出顺序出现。（代码块格式对我不起作用 - 四个空格缩进没有任何结果，抱歉 :(

```
<xsl:template match="AccountSummary">
    <fo:block margin-left="2" space-before="1" space-after="1" text-align="center">
        <xsl:apply-templates select="Label"/>
    </fo:block>
    <xsl:apply-templates select="AccountInfo"/>
    <xsl:apply-templates select="AccountProfile"/>
    <xsl:apply-templates select="ChangeInValueOfAccounts"/>
    <!-- ... more goes here -->
</xsl:template> 
```

我想做类似的事情

```
<xsl:template match="AccountSummary">
    <fo:block margin-left="2" space-before="1" space-after="1" text-align="center">
        <xsl:apply-templates select="Label"/>
    </fo:block>
    <xsl:apply-templates select="AccountInfo"/>
    <xsl:apply-templates select="AccountProfile"/>
    <xsl:apply-templates select="ChangeInValueOfAccounts"/>
    <!-- ... more goes here -->
    <xsl:for-each select="not otherwise matched">
        <!-- call zomgRED template -->
    </xsl:for-each>
</xsl:template> 
```

理想情况下，我宁愿`zomgRED`s 在顶部，但在底部也可以。或用文本标记标记。任何可以在最终文档中吐出文本而不是默默吃掉它的东西。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-04T19:01:04.830

以下是您如何能够获得一些您正在寻找的东西的味道。虽然没有将未处理的节点推到顶部：

**1）在您的样式表中进行身份转换：**

```
<xsl:template match="@* | node()">
    <xsl:copy>
        <xsl:apply-templates select="@* | node()"/>
    </xsl:copy>
</xsl:template> 
```

**2）确保您`<xsl:apply-templates select="*"/>`从所有其他更具体的模板中调用以让解析器运行**

这个想法是您的特定模板处理预期的 XSL-FO 转换，而身份转换只是将所有其他内容转储到结果树中。递归调用将确保您真正接触到所有节点（这是让它们“记录在案”的唯一方法），并且身份转换将与您没有捕获的那些相匹配。

#2 建议实际上可能会妨碍您的 XSL-FO 逻辑，因此可能并不真正可行，如果没有示例输入和您当前的 XSL-FO 转换，我无法判断。也许将其添加到问题中？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-04T19:16:57.177

**注意**：根据更新的问题完全替换了原始答案。

你可以这样做，但你需要列出那些你不想再次获得 zomgRed 模板的项目：

```
<xsl:template match="AccountSummary"> 
    <fo:block margin-left="2" space-before="1" space-after="1" text-align="center"> 
        <xsl:apply-templates select="Label"/> 
  </fo:block> 
  <xsl:apply-templates select="AccountInfo"/> 
  <xsl:apply-templates select="AccountProfile"/> 
  <xsl:apply-templates select="ChangeInValueOfAccounts"/> 
  <-- ... more goes here --> 
    <xsl:apply-templates mode='fallback' select * />

</xsl:template>

<xsl:template match='AccountInfo|AccountProfile|ChangeInValueOfAccounts| ... more goes here' mode='fallback' />

<xsl:template match='*' mode='fallback'>
   <!-- call zomgRED template --> 
</xsl:template> 
```

我已经`for-each`用另一个替换了你的`apply-templates`，但现在我们正在使用一种模式。只有相同模式的模板才会匹配。匹配“*”的模板仅在该模式下匹配，因此在其他情况下不会被调用。单行模板以相同的模式匹配，并且匹配你已经处理过的所有节点，并且什么都不做。由于它比“*”更具体，它将运行（并且什么也不做）而不是那些节点的“*”模板。

作为具有重复节点列表的单行模板的替代方案，您可以将相同的模式添加到所有现有模板（AccountInfo、AccountProfile 等）以及每个模板的 apply-templates 语句。这是一个风格问题，你会发现它更易于维护。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-05T03:01:17.440

**这是一个如何做到这一点的示例**（仅跟踪不匹配的节点——如果需要，可以以相同的方式实现不匹配的属性跟踪）：

```
<xsl:stylesheet version="1.0"
 xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
 <xsl:output omit-xml-declaration="yes" indent="yes"/>
 <xsl:strip-space elements="*"/>

 <!-- Catch all node - types template -- must be the top-most -->
 <xsl:template match="node()">
  Warning: this node is unmatched by any templates:

  "<xsl:copy-of select="."/>"
 </xsl:template>

 <xsl:template match="nums">
  <xsl:apply-templates/>
 </xsl:template>

 <xsl:template match="num[following-sibling::num[1] -1 = .]">
  <xsl:copy-of select="."/>
 </xsl:template>
</xsl:stylesheet> 
```

**当此转换应用于以下 XML 文档时：（**特意选择很简单，以说明这个简单的解决方案）

```
<nums>
  <num>01</num>
  <num>02</num>
  <num>03</num>
  <num>04</num>
  <num>05</num>
  <num>06</num>
  <num>07</num>
  <num>08</num>
  <num>09</num>
  <num>10</num>
</nums> 
```

**生成结果，包括一个不匹配元素的警告：**

```
<num>01</num>
<num>02</num>
<num>03</num>
<num>04</num>
<num>05</num>
<num>06</num>
<num>07</num>
<num>08</num>
<num>09</num>
  Warning: this node is unmatched by any templates:

  "<num>10</num>" 
```

**请注意**：如果样式表导入/包含其他样式表，此解决方案将不起作用。在这种情况下，必须将包罗万象的模板放在最先出现（或具有最低导入优先级）的样式表中。

# ruby-on-rails - 在 aptana 3 中克隆 rails git repo

> ID：10454121
> 
> 赞同：0
> 
> 时间：2012-05-04T18:20:21.790
> 
> 标签：ruby-on-rails, git

我正在尝试将我的 rails git repo 克隆到 aptana 中，这样我就可以对其进行处理，并且还可以完美地在分支之间进行更改。过去几年我一直在使用 netbeans，但现在我想使用 aptana，因为它是最新的。

我找不到在 aptana 中克隆 git repo 并使所有分支可用的方法。

有人会帮我吗？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-04T18:57:39.203

看起来 Aptana 只是执行了一个简单的`git clone`操作，这意味着您的所有分支*都*可用。只是 Aptana 只向您显示“本地”分支（即存在于 Aptana 正在运行的签出工作副本中的分支）。至少乍一看，GUI 不允许您选择远程分支……但您可以在命令行上毫无问题地执行此操作。

假设您的 Aptana 项目位于 中`~/Documents/Aptana Studio 3 WOrkspace/MyProject`，您可以执行以下操作...

*   切换到项目目录。

    ```
    $ cd "~/Document/Aptana Studio 3 Workspace/MyProject" 
    ```

*   运行`git branch -a`以查看所有可用的分支。你会看到这样的东西：

    ```
    $ git branch -a
    * master
      remotes/origin/develop
      remotes/origin/master
      remotes/origin/nifty.feature 
    ```

*   一切以`remotes/`远程分支开始。`git checkout`您可以使用该命令创建一个跟踪远程分支的本地分支。例如，要检查`develop`分支：

    ```
    $ git checkout develop
    Branch develop set up to track remote branch develop from origin.
    Switched to a new branch 'develop' 
    ```

返回到 Aptana Studio，您将看到在弹出菜单中按您的项目名称列出的新分支。

# c++ - 波形绘图库

> ID：10454123
> 
> 赞同：2
> 
> 时间：2012-05-04T18:20:25.200
> 
> 标签：c++, qt, plot, waveform

我正在寻找一个库来绘制实时记录的波形和/或频谱。
我在 Windows XP 下使用 C/C++ 和 Qt 4.8.1。

音频源来自 8 个不同的麦克风（将来可能会更多），所以我想要一个足够快的渲染来绘制 8 个波形而没有太多延迟。我正在使用 Portaudio 来获取数据。
曲目不需要记录，但我需要实时对它们进行一些计算。我知道这可能会减慢速度，所以最终我也会对频谱图感到满意（......绘制成本更低？）。

我试图编译和运行 Qt 的`Spectrum Analyzer`演示，但我发现它很慢（大约 1 秒的延迟）。我不知道它是否被认为是那么慢或者我错过了什么......

在网上搜索我遇到了[MathGL](http://mathgl.sourceforge.net/)，但我不确定它是否非常适合此目的，也许最好选择更具体的东西。

我希望尽可能便携，但我绝对更喜欢易用性而不是便携性。

有什么建议么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-05T15:18:49.773

我可以向您推荐非常快速且轻量级的简单框架：

[QCustomPlot](http://www.workslikeclockwork.com/index.php/components/qt-plotting-widget/)

# python - Python 的 String 类 count() 方法

> ID：10454129
> 
> 赞同：1
> 
> 时间：2012-05-04T18:20:42.440
> 
> 标签：python

我正在阅读 Mark Pilgrim 的 Dive into Python 3 并且已经盯着这个大约一个小时了： http: [//getpython3.com/diveintopython3/strings.html#common-string-methods](http://getpython3.com/diveintopython3/strings.html#common-string-methods)

```
>>> s = '''Finished files are the re-
... sult of years of scientif-
... ic study combined with the
... experience of years.'''
>>> s.lower().count('f')
6 
```

在给出的多行字符串示例中，我不明白为什么`s.lower().count('f')`返回 6 而不是 3。我已经确认它确实返回 6。当然，Pilgrim 甚至在他的笔记中指出它实际上是 6，但没有解释为什么。

有人可以帮我吗？谢谢！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-04T18:23:00.943

该声明中有 6 个 f。您可能不小心忽略了“of”。

（确实，这是[一个](http://www.riddlespot.com/riddle.php?riddleid=469) [广为](http://www.jamesshuggins.com/h/oth1/count_fs.htm) [流传的](http://rainton.com/fun/puzzles/?page=effing) [脑筋急转弯](http://www.formspring.me/r/riddle-hint-count-every-f-lowercase-or-uppercase-inside-the-quoted-sentence-i-ll-give-you-a-second-try-finished-files-are-the-result-of-years-of-scientific-study-combined-with-the-experience-of-years/201930620417371362)）。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-05-04T18:23:25.210

完成...文件...的...的...科学的...的...

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-05-04T18:32:16.850

这可能是一个有用的视觉效果。

![六个f](../Images/b70721224678d63667d070ddf4b88c60.png)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-05-04T18:24:57.457

****完成**的文件是**多年****科学研究**结合**多年**经验的**结果****。****

 ******'lower' 使得整个字符串都是小写的，因此请确保包含诸如“Finished”之类的内容。******

# indexeddb - Can you ever alter the structure of an indexedDB database after it has been opened in firefox?

> ID：10454134
> 
> 赞同：0
> 
> 时间：2012-05-04T18:20:58.637
> 
> 标签：indexeddb

```
var db;
var version = 1;
var request = indexedDB.open("myDB", version);
request.onsuccess(function(e) {db = e.target.result;});
// db.close(); //??? happens async and has no callback
var request2 = indexedDB.open("myDB", ++version);
request.onsuccess = function() { console.log("success"); };
request.onerror = function() { console.log("error"); }; // called if db existed when page was loaded
request.onblocked = function(){console.log("blocked");}; // called on init creation
request.onupgradeneeded = function(){console.log("onupgradeneeded");}; 
```

I need to be able to open the db, read an object store, and then alter the db. It looks like you can only alter the db structure once per page load.

This works just fine in Chrome when using the deprecated setVersion method.

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-05-06T00:34:06.970

The IndexedDB API isn't easy to use. A few things:

1) upgradeneeded won't fire until there are no other open connections to the db. Uncomment the db.close() line. But db won't be an IDBDatabase object until request has received a success event, so you have to wait for that.

2) The request2 object has no event handlers on it. You probably meant to put request2 instead of request on those last 4 lines in the code sample.

3) The first request.onsuccess assignment is wrong.

4) The error handler will be called if the the database on disk has a version higher than the one you are passing to open.

Try this:

```
indexedDB = indexedDB || mozIndexedDB;
var db;
var request = indexedDB.open("myDB");
request.onsuccess = function(e) {
    db = e.target.result;
    var version = db.version;
    db.close();
    var request2 = indexedDB.open("myDB", ++version);
    request2.onsuccess = function() { console.log("success"); };
    request2.onerror = function() { console.log("error"); };
    request2.onblocked = function() { console.log("blocked"); };
    request2.onupgradeneeded = function() { console.log("onupgradeneeded"); };
}; 
```

The console will show:

```
onupgradeneeded
success 
```

If not:

1.  Check that no other tabs have connections opened to this db.
2.  Add handlers for the other three events to request, see which one fires.

# html - ul 列表的 css 问题

> ID：10454136
> 
> 赞同：0
> 
> 时间：2012-05-04T18:21:03.993
> 
> 标签：html, css, html-lists

我试图让我的 ul 列表中的最后一个 li 不显示边框。我确实想要其他一切之间的边界。我只想在我的列表之间用小线作为分隔线。这是我的代码：

CSS

```
 #navcontainer ul li { 
        display: inline; 
        border-right:1px solid #5C5C5C;
        margin-left: -12px;
    }
    #navcontainer ul .last li{ 
        display: inline; 
        border-right:0;
        margin-left: -12px;
    }

    #navcontainer ul li a{
        text-decoration: none;
        padding: .2em 1em;
        color: #5C5C5C;
    } 
```

html

```
<ul class="qa-list">
    <li>
        <a href="#rewards" title="Rewards">Rewards Questions</a> 
    </li>
    <li>
        <a href="#logging" title="Logging In">Logging In Questions</a> 
    </li>
    <li>
        <a href="#uploading" title="Uploading Photo">Uploading Photo Questions</a>
    </li>
    <li>
        <a href="#enter" title="Entering Supporter Email">Entering Supporter Email Questions</a> 
    </li>
    <li>
        <a href="#fb" title="Sharing on Facebook">Sharing on Facebook Questions</a> 
    </li>
    <li>
        <a href="#letter" title="Printing Donation Letter">Printing Donation Letter Questions</a> 
    </li>
    <li>
        <a href="#tracking" title="Tracking Donations">Tracking Donations Questions</a> 
    </li>
    <li>
        <a href="#privacy" title="Privacy">Privacy Questions</a> 
    </li>
    <li>
        <a href="#gift" title="Supporter "Thank You" Gift">Supporter "Thank You" Gift Questions</a> 
    </li>
    <li>
        <a href="#rog" title="About Reaching Our Goal">About Reaching Our Goal Questions</a> 
    </li>
    <li>
        <a href="#contact" title="Contact Information Questions">Contact Information Questions</a> 
    </li>
</ul> 
```

任何人都可以帮忙吗？谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-04T18:24:36.930

试试这个.last：

```
border-right: none; 
```

此外，您似乎没有将`.last`类应用于任何`li`元素。此外，如果您确实应用了它，则需要更改选择器以使其显示为`li.last`，而不是`.last li`.

CSS：

```
#navcontainer ul li.last
{
   ...
   border-right: none;
   ...
} 
```

项目清单：

```
<li class="last">
   <a href="#contact" title="Contact Information Questions">Contact Information Questions</a>
</li> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-04T18:24:42.073

尝试这个：

```
#navcontainer ul:last-child {
    border-right: 0px;
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-04T18:24:57.040

尝试这个：

```
#navcontainer ul li:last-child{ 
    display: inline; 
    border-right:none;
    margin-left: -12px;
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-04T19:13:03.337

您可以使用 CSS3 选择器 :last-child 来定位它。

[http://www.w3schools.com/cssref/sel_last-child.asp](http://www.w3schools.com/cssref/sel_last-child.asp)

```
#navcontainer ul li:last-child {
/* CSS here */
} 
```

# objective-c - 有没有办法打印 SEL 动作？

> ID：10454138
> 
> 赞同：16
> 
> 时间：2012-05-04T18:21:11.203
> 
> 标签：objective-c, ios, selector

例如，我想跟踪发送到我的 canPeformAction 的操作，它们太多，无法在每次出现时在调试器中用“悬停”显示。因此，我想跟踪日志并在我的测试周期后对其进行检查。

```
- (BOOL)canPerformAction:(SEL)action withSender:(id)sender {
    NSLog(@"%s: sender=%@", __FUNCTION__, sender, action);
} 
```

* * *

## 回答 #1

> 赞同：36
> 
> 时间：2012-05-04T18:24:54.630

你要

```
NSLog(@"%s: sender=%@, selector=%s", __FUNCTION__, sender,sel_getName(action)); 
```

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2015-06-14T18:45:45.730

使用**NSStringFromSelector**轻松获取 Selector 的可打印名称。

`NSStringFromSelector(action)`

> `NSString * NSStringFromSelector ( SEL aSelector );`
> 
> 返回给定选择器的字符串表示形式。

```
- (BOOL)canPerformAction:(SEL)action withSender:(id)sender {
    NSLog(@"Action: %@", NSStringFromSelector(action));
} 
```

# php - 如何在由空格分隔的字符串的中点添加换行符

> ID：10454142
> 
> 赞同：6
> 
> 时间：2012-05-04T18:21:28.860
> 
> 标签：php, string, text

使用 php：如何在字符串相对中间的空白处插入换行符？或者换句话说，我如何计算一个句子中的单词，然后在句子中途换行？

这个想法是通过将每个标题切成两半并将其放在两行（如果标题占用超过一行）来避免博客文章标题的第二行出现寡妇（被遗弃的单词）。

提前致谢。

更新：大家好，我意识到我需要 preg_split 函数用空格分割标题。抱歉，如果该部分在问题中不清楚。我修改了 Asaph 的答案并使用了这个：

```
$title_length = strlen($title);
if($title_length > 30){
    $split = preg_split('/ /', $title, null, PREG_SPLIT_NO_EMPTY);
    $split_at = ceil(count($split) / 2);
    echo $split_at;
    $broken_title = '';
    $broken = false;
    foreach($split as $word_pos => $word){
        if($word_pos == $split_at  && $broken == false){
            $broken_title.= '<br />'."\n";
            $broken = true;
        }
        $broken_title .= $word." ";
    }
    $title = $broken_title;
} 
```

我是 SO 的新手，我被社区的力量所震撼。干杯。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-04T18:26:50.833

使用 PHP 的[`wordwrap()`](http://php.net/manual/en/function.wordwrap.php)函数。您可以使用字符串的长度除以 2 作为第二个参数。这是一个例子：

```
<?php
$sentence = 'This is a long sentence that I would like to break up into smaller pieces.';
$width = strlen($sentence)/2;
$wrapped = wordwrap($sentence, $width);
echo $wrapped;
?> 
```

它输出：

```
This is a long sentence that I would
like to break up into smaller pieces. 
```

如果您想要 HTML 输出，您可以使用可选的第三个参数来指定中断字符。像这样：

```
$wrapped = wordwrap($sentence, $width, '<br />'); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-04T18:27:17.107

**更新**

```
<?php
$Sentence = 'I will go to the school tomorrow if it is not raining outside and if David is ok with it.';
$Split = explode(' ', $Sentence);

$SplitAt = 0;
foreach($Split as $Word){
    $SplitAt+= strlen($Word)-1;
    if($SplitAt >= strlen($Sentence)){
        break;
    }
}

$NewSentence = wordwrap($Sentence, $SplitAt, '<br />' . PHP_EOL);

echo $NewSentence;
?> 
```

产生这个：

> 如果外面没有下雨，我明天会去学校<br />\n
> 如果大卫没问题的话。

**编辑**：添加 PHP_EOL 以匹配所有系统加上带有 <br /> 的 html

# ruby-on-rails - 如何公开对运行在 Heroku 上的 node.js 服务器的安全访问？

> ID：10454147
> 
> 赞同：2
> 
> 时间：2012-05-04T18:21:38.300
> 
> 标签：ruby-on-rails, ruby, node.js

想象一下，我有一个 Rails 应用程序，我希望经过身份验证的用户能够访问另一个应用程序的服务（用 node.js 编写）。如何确保只有经过身份验证（登录）进入我的 Rails 应用程序的用户才能访问节点一？

编辑：两个应用程序都在 Heroku 上运行。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-04T22:32:41.200

一种方法是使用令牌实现 SSO。ideascale.com 提供了一些信息

[http://support.ideascale.com/kb/ideascale-setup/single-sign-on-multipass-token-based-cookie-based](http://support.ideascale.com/kb/ideascale-setup/single-sign-on-multipass-token-based-cookie-based)

# c++ - Intel AVX：用于双精度浮点变量的 256 位点积版本

> ID：10454150
> 
> 赞同：29
> 
> 时间：2012-05-04T18:21:57.153
> 
> 标签：c++, performance, simd, avx

英特尔高级矢量扩展 (AVX)**在 256 位版本（YMM 寄存器）中不为双精度浮点变量提供点积**。“为什么？” 这个问题已经在另一个论坛（[这里](http://www.amdzone.com/phpbb3/viewtopic.php?f=532&t=139130)）和 Stack Overflow（[这里](https://stackoverflow.com/questions/16033266/intel-avx-why-is-there-no-256-bits-version-of-dot-product-for-double-precision)）上得到了非常简短的处理。但我面临的问题是如何以有效的方式用其他 AVX 指令替换这个缺失的指令？

单精度浮点变量存在 256 位版本中的点积（[参考此处](http://denali.princeton.edu/IntelXe2011/compiler_c/main_cls/intref_cls/common/intref_avx_dp_ps.htm)）：

```
 __m256 _mm256_dp_ps(__m256 m1, __m256 m2, const int mask); 
```

这个想法是为这个缺失的指令找到一个有效的等价物：

```
 __m256d _mm256_dp_pd(__m256d m1, __m256d m2, const int mask); 
```

更具体地说，我想从`__m128`（四个浮点数）转换为`__m256d`（4个双精度数）的代码使用以下指令：

```
 __m128 val0 = ...; // Four float values
   __m128 val1 = ...; //
   __m128 val2 = ...; //
   __m128 val3 = ...; //
   __m128 val4 = ...; //

   __m128 res = _mm_or_ps( _mm_dp_ps(val1,  val0,   0xF1),
                _mm_or_ps( _mm_dp_ps(val2,  val0,   0xF2),
                _mm_or_ps( _mm_dp_ps(val3,  val0,   0xF4),
                           _mm_dp_ps(val4,  val0,   0xF8) ))); 
```

此代码的结果是一个包含四个浮点数的向量，其中包含和、和、和、和`_m128`之间的点积结果。`val1``val0``val2``val0``val3``val0``val4``val0`

也许这可以为建议提供提示？

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2012-05-04T18:42:44.320

我会使用 4*double 乘法，然后使用 a `hadd`（不幸的是，它只在上半部分和下半部分添加了 2*2 浮点数），提取上半部分（随机播放应该同样有效，也许更快）并将其添加到下半部分。

结果在`dotproduct`.

```
__m256d xy = _mm256_mul_pd( x, y );
__m256d temp = _mm256_hadd_pd( xy, xy );
__m128d hi128 = _mm256_extractf128_pd( temp, 1 );
__m128d dotproduct = _mm_add_pd( (__m128d)temp, hi128 ); 
```

编辑：
在 Norbert P 的想法之后。我扩展了这个版本，一次做 4 个点积。

```
__m256d xy0 = _mm256_mul_pd( x[0], y[0] );
__m256d xy1 = _mm256_mul_pd( x[1], y[1] );
__m256d xy2 = _mm256_mul_pd( x[2], y[2] );
__m256d xy3 = _mm256_mul_pd( x[3], y[3] );

// low to high: xy00+xy01 xy10+xy11 xy02+xy03 xy12+xy13
__m256d temp01 = _mm256_hadd_pd( xy0, xy1 );   

// low to high: xy20+xy21 xy30+xy31 xy22+xy23 xy32+xy33
__m256d temp23 = _mm256_hadd_pd( xy2, xy3 );

// low to high: xy02+xy03 xy12+xy13 xy20+xy21 xy30+xy31
__m256d swapped = _mm256_permute2f128_pd( temp01, temp23, 0x21 );

// low to high: xy00+xy01 xy10+xy11 xy22+xy23 xy32+xy33
__m256d blended = _mm256_blend_pd(temp01, temp23, 0b1100);

__m256d dotproduct = _mm256_add_pd( swapped, blended ); 
```

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2012-05-05T05:06:35.720

我会扩展[drhirsch 的答案](https://stackoverflow.com/a/10454420/733582)以同时执行两个点积，节省一些工作：

```
__m256d xy = _mm256_mul_pd( x, y );
__m256d zw = _mm256_mul_pd( z, w );
__m256d temp = _mm256_hadd_pd( xy, zw );
__m128d hi128 = _mm256_extractf128_pd( temp, 1 );
__m128d dotproduct = _mm_add_pd( (__m128d)temp, hi128 ); 
```

然后`dot(x,y)`是低双并且`dot(z,w)`是高双`dotproduct`。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2017-11-22T23:24:15.303

对于单个点积，它只是一个垂直乘法和水平和（请参阅[在 x86 上进行水平浮点向量求和的最快方法](https://stackoverflow.com/questions/6996764/fastest-way-to-do-horizontal-float-vector-sum-on-x86)）。 `hadd`花费 2 次洗牌 + 一次`add`。当使用两个输入 = 相同的向量时，吞吐量几乎总是次优的。

```
// both elements = dot(x,y)
__m128d dot1(__m256d x, __m256d y) {
    __m256d xy = _mm256_mul_pd(x, y);

    __m128d xylow  = _mm256_castps256_pd128(xy);   // (__m128d)cast isn't portable
    __m128d xyhigh = _mm256_extractf128_pd(xy, 1);
    __m128d sum1 =   _mm_add_pd(xylow, xyhigh);

    __m128d swapped = _mm_shuffle_pd(sum1, sum1, 0b01);   // or unpackhi
    __m128d dotproduct = _mm_add_pd(sum1, swapped);
    return dotproduct;
} 
```

如果您只需要一个点积，这比 @hirschhornsalz 的单向量答案要好，在 Intel 上 1 shuffle uop，在 AMD Jaguar / Bulldozer-family / Ryzen 上取得更大的胜利，因为它立即缩小到 128b 而不是做一堆256b的东西。AMD 将 256b 的操作分成两个 128b 的 uop。

* * *

在并行执行 2 个或 4 个点积的情况下，它可能值得使用`hadd`，您将它与 2 个不同的输入向量一起使用。如果您想要打包结果， Norbert 的`dot`两对向量看起来是最佳的。`vpermpd`即使将 AVX2用作车道交叉洗牌，我也看不出有任何方法可以做得更好。

**当然，如果您真的想要更大`dot`的（8`double`秒或更多），请使用垂直`add`（使用多个累加器来隐藏`vaddps`延迟）并在最后进行水平求和。** 如果可用，您也可以使用`fma`。

* * *

`haddpd`在内部将两种不同的方式混合在一起，`xy`并将`zw`其提供给 vertical `addpd`，这就是我们无论如何都要手动做的事情。如果我们保持`xy`并`zw`分开，我们需要 2 次洗牌 + 2 次加法来获得一个点积（在单独的寄存器中）。因此，第一步将它们混洗在一起`hadd`，我们节省了混洗的总数，只节省了添加数和微指令总数。

```
/*  Norbert's version, for an Intel CPU:
    __m256d temp = _mm256_hadd_pd( xy, zw );   // 2 shuffle + 1 add
    __m128d hi128 = _mm256_extractf128_pd( temp, 1 ); // 1 shuffle (lane crossing, higher latency)
    __m128d dotproduct = _mm_add_pd( (__m128d)temp, hi128 ); // 1 add
     // 3 shuffle + 2 add
*/ 
```

但是对于`vextractf128`非常便宜的 AMD 来说，256b`hadd`的成本是 128b 的 2 倍`hadd`，因此将每个 256b 产品分别缩小到 128b，然后与 128b hadd 结合使用是有意义的。

实际上，根据[Agner Fog 的表格](http://agner.org/optimize/)，`haddpd xmm,xmm`在 Ryzen 上是 4 uops。（而 256b ymm 版本是 8 uops）。因此，如果数据正确，实际上最好在 Ryzen 上手动使用 2x `vshufpd`+ 。`vaddpd`可能不是：他的 Piledriver 数据有 3 uop `haddpd xmm,xmm`，而它只有 4 uop 和一个内存操作数。对我来说，他们不能`hadd`仅实现 3 个（或 6 个 ymm）微指令，这对我来说没有意义。

* * *

`dot`对于将结果打包成一个4 s `__m256d`，确切的问题是，我认为@hirschhornsalz 的答案对于英特尔 CPU 来说看起来非常好。我没有仔细研究过它，但是成对结合`hadd`是很好的。 `vperm2f128`在 Intel 上效率很高（但在 AMD 上相当糟糕：Ryzen 上 8 微指令，每 3c 吞吐量一个）。

# c# - 塑造实体（自定义列）

> ID：10454157
> 
> 赞同：0
> 
> 时间：2012-05-04T18:22:28.773
> 
> 标签：c#, entity-framework

我的客户一直在使用 ADO.NET，现在想迁移到 EF。我开始怀疑他的限制是否会阻止它。（尽管我对 EF 的相对较新可能会阻止它。）

以下是约束：

1.  我可能不会更改数据库。
2.  我不能更改太多代码（只替换数据层）这里的重要一点是，几乎他所有的表单都有一个自动生成列的数据网格（你会在小样本中看到我的意思）
3.  （其他我可能忘记了）

他使用 SQL 来更改列名。我想没问题，我会用投影来做同样的事情。我写了一个简单的例子来说明发生了什么。

```
 SqlConnection MyConnection = new SqlConnection(Properties.Settings.Default.TestConnectionString);
        MyConnection.Open();
        string SQLString = "Select fName as \"First Name\", lName as \"Sur Name\", lName as \"Last Name\", Age from Test";

        SqlDataAdapter MyAdapter = new SqlDataAdapter(SQLString, MyConnection);
        DataSet MySet = new DataSet("table");
        MyAdapter.Fill(MySet);
        bindingSource1.DataSource = MySet.Tables[0];
        dataGridView1.AutoGenerateColumns = true;
        bindingSource1.ResetBindings(true); 
```

这是我的代码

```
var MyContext = new TestEntities();
var MyQuery = MyContext.Tests.Select(
               test => new 
                       { 
                           FirstName = test.fName, 
                           SurName = test.lName, 
                           LastName = test.lName, 
                           Age = test.Age 
                        });

bindingSource2.DataSource = MyQuery.ToList();
dataGridView2.AutoGenerateColumns = true;
bindingSource2.ResetBindings(true); 
```

到目前为止，一切都很好。不是他所做的精确复制（我的列中没有空格），但他对此很好。

但随后，他基于双击数据网格做出决策。所以他会想做这样的事情。

```
 private void dataGridView2_CellDoubleClick(object sender, DataGridViewCellEventArgs e)
        {
            Test MyTest = bindingSource2.Current as Test;
            if (MyTest.Age > 50)
                MessageBox.Show("You are old!");
        } 
```

投影创建匿名类型，所以我不能在这里做出那种决定。（请注意，我必须更改代码才能执行此操作 - 他当前的代码根据数据网格行中的数据做出选择，但他现在认为我们需要使用类。）

有没有办法用实体做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-05T14:48:57.267

投影不会只创建匿名类型。您可以声明新类：

```
public class TestViewClass
{
     public string FirstName {get;set;}
     public string SurName {get;set;}
     public string LastName {get;set;}
     public int Age {get;set;}
} 
```

并制作这样的方法：

```
IQueryable<TestViewClass> GetView()
{
    return MyContext.Tests.Select(t => new TestViewClass
    {
                       FirstName = t.fName, 
                       SurName = t.lName, 
                       LastName = t.lName, 
                       Age = t.Age 
    }; 
} 
```

现在你可以像这样得到 TestViewClass 对象：

```
TestViewClass testView = GetView().Where(t => t.Age > 50).FirstOrDefault(); 
```

# .net - Microsoft 的 .net CLR 是否在运行时内联小功能？

> ID：10454160
> 
> 赞同：4
> 
> 时间：2012-05-04T18:22:41.720
> 
> 标签：.net, optimization, f#

有这样的功能吗？类似 Java HotSpot 的东西在服务器模式下运行，但适用于 .Net 应用程序。

**编辑：** 更多信息。我有一个小应用程序（用 F# 编写），里面有很多小功能。像这个：

```
let printable b =
    if b >= ' 'B && b <= '~'B
    then b else '.'B 
```

我已经意识到性能很差，在分析之后我看到每个这样的函数都被调用了数百万次。我制作了它们`inline`并获得了性能提升（5 次以上，可能更多）。

好的，不错。现在性能很好。但是为什么框架不这样做呢？它有足够的关于我的代码和函数被调用频率的信息。为什么它不内联一个被调用 1M 次的函数？

**EDIT2：** 测量内联函数差异的示例测试：

```
 open System

    let printableByte b =
        if b >= ' 'B && b <= '~'B
        then b else '.'B

    let foo (arr : byte[]) = 
        for i in 0..arr.Length-1 do
            arr.[i] <- printableByte (arr.[i])
        arr.Length / 1000

    let main() =
        let sum = ref 0
        let arr = Array.create 1000000 0uy

        let stopWatch = System.Diagnostics.Stopwatch()
        stopWatch.Start()
        for x in 0..5000 do
            sum := !sum + (foo arr)

        stopWatch.Stop()
        printfn "%d" !sum 
        printfn "total time = %A" stopWatch.ElapsedMilliseconds
        ()

    main() 
```

未内联时运行 19.5 秒，`printableByte`内联时运行 13.6 秒。

**EDIT3：** 只有在为 x86 目标编译并在 x64 主机上运行时才能查看此时间差。如果为“anycpu”或 x64 编译，则没有时间差异。

因此，“小功能”和优化没有任何问题。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-04T19:13:59.163

是的，CLR 进行了一些运行时优化，如本[博客](http://blogs.microsoft.co.il/blogs/sasha/archive/2012/01/20/aggressive-inlining-in-the-clr-4-5-jit.aspx)所示。请注意，根据这篇文章，虚拟方法*没有*内联。

> 这些方法都没有内联：
> 
> *   递归方法
> *   虚方法（即使接收者变量的静态类型是密封的）

你的`printable`函数是如何在你的代码中调用的？如果 F# 编译器将它包装在一个闭包中，它经常这样做，即使在您一开始可能不期望它的情况下，您也会陷入“虚拟方法”的情况。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-04T21:20:20.853

请记住，在 FSI 中测试此代码*与*`Release`在模式下编译项目不同。

我的高度非科学测试表明，您提供的性能测试在`Debug`if`inline`添加到`printableByte`.

但是，当`inline`在`Release`模式下添加时，程序实际上比没有它时执行*得更差。*我相信 F# 编译器团队或一些反汇编可以告诉你为什么会这样......

根据我使用 F# 的经验，您应该*很少*需要手动应用内联优化。只要确保你编译`Release`！

*编辑*：啊哈，是的！确保在“任何 CPU”模式下编译，除非您有特定的理由不这样做（通常我的原因是必须与 F# 中的 x86 COM 库进行互操作）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-04T18:24:38.003

是的，.net 框架针对其运行的平台优化了代码。它考虑了许多因素。但是，有些事情它不会做。例如，如果可用的话，我不相信它会使用 SIMD 指令。但总的来说，它确实在优化方面做得很好。

# django - django multivaluefield & multiwidget - 使一个可选

> ID：10454164
> 
> 赞同：1
> 
> 时间：2012-05-04T18:23:10.373
> 
> 标签：django, django-models, django-multiwidget

这与我[之前的一个问题](https://stackoverflow.com/questions/10370078/django-multivaluefield-multiwidget-compress-and-or-decompress-not-working)有关。

我想要一个包含 Choice 和 TextInput 小部件的 MultiValueField。如果用户从 Choice 中选择“OTHER”，则应该保存 TextInput 的值。否则，应该保存 Choice 的值。到目前为止，我有以下代码：

```
custom_choices = [("one","one"),("two","two"),("OTHER","OTHER")]

class MyMultiWidget(forms.MultiWidget):
    def __init__(self,*args,**kwargs):
        widgets = (
            forms.Select(choices=custom_choices),
            forms.TextInput(),
        )
        super(MyMultiWidget, self).__init__(widgets,*args,**kwargs)

    def decompress(self, value):
        if value:
             return value.split("|")
        return ['', '']

class MyMultiValueField(forms.MultiValueField):
    def __init__(self, *args, **kwargs):
        fields = (
            forms.CharField(max_length=128,required=True),
            forms.CharField(max_length=128,required=False),
        )
        super(MyMultiValueField, self).__init__(fields, *args, **kwargs)
        self.widget = TestMultiWidget()

    def compress(self, data_list):
        if data_list:
            return '|'.join(data_list)

class MyTestField(models.CharField):
    def formfield(self, **kwargs):
        return super(MyTestField, self).formfield(form_class=MyMultiValueField)

class MyModel(models.Model):
    myField = MyTestField() 
```

但是，每当我尝试在 TextInput 中保存不包含值的内容时，都会收到验证错误“此字段是必需的”。尽管上面有“required=False”kwarg，但还是这样。

我试图在 clean 函数中添加一些逻辑；如果 Choice 小部件的值为“OTHER”，则忽略 TextInput 的小部件：

```
def clean(self,value):
    if value[0]!="OTHER":
        value[1]=u''
    else:
        if not value[1]:
            msg = "unspecified value"
            raise forms.ValidationError(msg)
        elif "|" in value[1]:
            msg = "bad value ('|' character is not allowed"
            raise forms.ValidationError(msg)
    super(TestFormField,self).clean(value) 
```

但这没有效果。

有什么建议么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-07T14:13:31.413

正确版本的 clean 应该如下所示：

```
def clean(self,value):
    if value[0] != "OTHER":
        value[1] = u' '
    else:
        if value[1].strip() == u' ':
            msg = "unspecified value"
            raise forms.ValidationError(msg)
        elif "|" in value[1]:
            msg = "bad value ('|' character is not allowed)"
            raise forms.ValidationError(msg)
    return "|".join(value) 
```

# razor - 如何使用缩进和换行符自动格式化 Razor 输出？

> ID：10454165
> 
> 赞同：3
> 
> 时间：2012-05-04T18:23:11.340
> 
> 标签：razor, formatting, markup, asp.net-mvc-4

我有一些带有大量条件逻辑、循环、部分视图等的 Razor 页面。保持输出标记在语义上正确很容易，但使用正确的缩进和换行符来格式化它更困难。如何在运行时自动执行此操作？是否有模块或 Razor 扩展？

请不要说*Right click -> Format selection*。需要明确的是，我想避免在编写 Razor 页面时考虑格式化。我希望我的 Razor 标记以对开发人员有意义的方式进行布局（例如，在服务器端块内缩进） - 但对于单击“查看源代码”的奇怪人来说，呈现的 HTML 是“美化”的。（我不担心增加输出的大小，因为我使用的是 gzip/deflate。）

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-04T19:03:46.220

您可以使用类似`TidyNet`（[http://sourceforge.net/projects/tidynet/](http://sourceforge.net/projects/tidynet/)）的库，实现`ActionFilter`：

```
public override void OnActionExecuted(ActionExecutedContext filterContext)
{
    if (filterContext.Result is ViewResult)
    {
        var tidy = new Tidy
            {
                Options =
                    {
                        DocType = DocType,
                        DropFontTags = DropFontTags,
                        LogicalEmphasis = LogicalEmphasis,
                        XmlOut = XmlOut,
                        Xhtml = Xhtml,
                        IndentContent = IndentContent,
                        HideEndTags = HideEndTags,
                        MakeClean = MakeClean,
                        TidyMark = TidyMark,
                    }
                };

        filterContext.RequestContext.HttpContext.Response.Filter =
            new HtmlTidyFilter(filterContext.RequestContext.HttpContext.Response.Filter, tidy);
    }
} 
```

过滤器的算法：

```
public override void Write(byte[] buffer, int offset, int count)
{
    var data = new byte[count];
    Buffer.BlockCopy(buffer, offset, data, 0, count);
    string html = Encoding.Default.GetString(buffer);

    using (var input = new MemoryStream())
    {
        using (var output = new MemoryStream())
        {
            byte[] byteArray = Encoding.UTF8.GetBytes(html);
            input.Write(byteArray, 0, byteArray.Length);
            input.Position = 0;
            _tidy.Parse(input, output, new TidyMessageCollection());

            string result = Encoding.UTF8.GetString(output.ToArray());

            byte[] outdata = Encoding.Default.GetBytes(result);
            _stream.Write(outdata, 0, outdata.GetLength(0));
        }
    }
} 
```

然后你只需将它插入控制器：

```
[TidyHtml]
public class AnyController : Controller 
```

瞧！;)

我是从这个来源了解到的：http: [//blog.aquabirdconsulting.com/2009/10/28/asp-net-mvc-clean-html/](http://blog.aquabirdconsulting.com/2009/10/28/asp-net-mvc-clean-html/)

# .net - 如何通过 .net 获取有关所有活动 TCP 连接的信息

> ID：10454166
> 
> 赞同：1
> 
> 时间：2012-05-04T18:23:12.347
> 
> 标签：.net, tcp, .net-remoting

一次偶然的机会，我来到了`IPGlobalProperties`课堂。出于兴趣，我玩了一下，并尝试制作一个显示当前网络活动的应用程序。

我得到`IPGlobalProperties.GetActiveTcpConnections`了当前的 TCP 连接。并且因为关闭的连接 (TIME_WAIT) 也包含在 的结果中`GetActiveTcpConnections`，我认为这将使我对最后几秒钟或几分钟的整个 TCP 通信有一个概述。

但是，我知道它们存在的连接，但它们从未出现在`GetActiveTcpConnections`.

我在这里想念什么？如何从任务管理器中获取类似于“网络活动列表”的列表？

*作为附加信息，请求会发送到内部设备，并且对该请求的响应始终正确返回。请求由同一应用程序的 WebClient 类完成。Surprinsinlgy，如果我做netstat -ano，它们也不会出现。但是在任务管理器资源监视器中，我可以看到它们*

# postgresql - 在没有密码提示的情况下在 bash 脚本中运行 PostgreSQL CLI (psql)？

> ID：10454173
> 
> 赞同：4
> 
> 时间：2012-05-04T18:23:34.333
> 
> 标签：postgresql, psql

以用户 postgres 身份通过 bash 脚本运行 PostgreSQL CLI (psql) 会导致发送密码提示，即使我可以在没有密码的情况下手动运行它。当我尝试将 -w 放入脚本时，会发生此错误：

psql：fe_sendauth：未提供密码

我可以在没有密码的情况下以自动方式运行 psql 吗？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-05-04T18:26:04.890

您可以使用密码文件[pgpass.conf](http://www.postgresql.org/docs/current/static/libpq-pgpass.html)或使用[PGPASSWORD](http://www.postgresql.org/docs/8.3/static/libpq-envars.html)变量。

对于本地开发或者如果安全不是问题，您还可以通过修改文件将 PostgreSQL 配置为在[信任身份验证模式下运行。](http://www.postgresql.org/docs/7.4/static/auth-methods.html)`pg_hba.conf`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-04T18:25:29.407

只要您对从运行脚本的主机连接的特定用户没有身份验证，您就可以。为此，您只需`pghba.conf`在服务器上添加以下行（您将需要重新启动 PostgreSQL 守护程序）：

```
host YOUR_DB YOUR_USER YOUR_IP trust 
```

在哪里：

1.  YOUR_DB：数据库名称
2.  YOUR_USER：用于运行脚本的用户
3.  YOUR_IP：脚本运行的IP

其他选项可能是使用[`expect`](http://linux.die.net/man/1/expect)实用程序（假设您使用的是 linux 或某些 unix 变体或 shell，例如 cygwin）。

# jquery - 使用 ajax 时，在 iOS 中按住文本不会在 jQueryMobile 对话框上显示“复制”按钮

> ID：10454177
> 
> 赞同：4
> 
> 时间：2012-05-04T18:23:53.073
> 
> 标签：jquery, ios, mobile, copy, clipboard

我说的是弹出的这些对话框之一：http: [//jquerymobile.com/test/docs/pages/page-dialogs.html](http://jquerymobile.com/test/docs/pages/page-dialogs.html)

（手机短网址[http://bit.ly/KhCGVD](http://bit.ly/KhCGVD)）

单击“打开对话框”——在该对话框中，除非链接中使用了“data-ajax="false"”，否则 iOS 中的任何内容都无法复制。（在安卓上运行良好）

把 '-webkit-user-select: auto!important;' （或“文本”而不​​是“自动”）什么都不做。

添加 javascript 'document.documentElement.style.webkitTouchCallout = "auto";' 什么也没做。

我迫切希望完成这项工作，因为我已经围绕副本在 iOS 和 android 上都可以工作的假设构建了一个完整的东西，但直到它完成才在 iOS 中进行测试:(。

任何帮助将不胜感激，谢谢。

编辑：在 4.3.5 -- 4.3.2 -- iOS 5.1 上测试 -- 不工作

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-15T09:48:51.250

恐怕我无法为您的问题提供简单的答案（例如在 config 或 init 中添加一些内容），但我希望当前的解决方案就足够了。

* * *

# 问题

问题在于这个框架的代码很深。首先，我们有一个**jquery.mobile.dialog.js**文件，其中有一行：

```
 $el.bind( "vclick submit", function( event ) {
               // code
            }) 
```

正如您在此处看到的，我们将绑定**vclick**添加到**$el** - 整个对话框容器。

它自己的事件**vclick是由****vmouse.js**中的 jQuery Mobile 生成的，在挖掘之后我设法检测到实际问题出现在哪里：

```
 $( this ).bind( realType, dummyMouseHandler ); 
```

在某些浏览器（即 Opera Mini）中，需要此行才能使事件工作（如此行上方的注释文本中所述）。

* * *

# 解决方案

所以，这是解决方案之一，打开文件 jquery.mobile.vmouse.js 并注释掉行

```
 $( this ).bind( realType, dummyMouseHandler ); 
```

我已经在 iPad 上对其进行了测试，并且在那个小补丁之后可以使用复制功能。

# php - 选择一个表的部分并计算另一个表的行数

> ID：10454179
> 
> 赞同：1
> 
> 时间：2012-05-04T18:24:03.517
> 
> 标签：php, mysql

我有 2 个 MySQL 表：人员和连接

我想从人员中选择所有列，并计算他们在连接表中的连接数。

```
--------------------   ----------------------
| People           |   | Connections        |
--------------------   ----------------------
| person_id | name |   | cnt_id | person_id |
--------------------   ---------------------- 
```

我想从人员中选择所有人并选择该人的 person_id 出现在第二个表中的次数。

我一直想弄清楚，但做不到。希望大家能帮忙。

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-04T18:30:40.437

如果有人没有联系，这将给出一个计数为零的行：

```
SELECT
    People.person_id,
    People.name,
    COUNT(Connections.person_id) AS number_of_connections
FROM People
LEFT JOIN Connections
ON People.person_id = Connections.person_id 
GROUP BY People.person_id 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-04T18:27:34.743

尝试这个

```
SELECT name,count(Connection.person_id) as cnt FROM 
      People LEFT JOIN Connection ON People.person_id = Connection.person_id 
      GROUP BY Connection.person_id 
```

# maven - 如何确定从 maven reactor 计划构建了哪些工件（即：包括子模块）？

> ID：10454181
> 
> 赞同：3
> 
> 时间：2012-05-04T18:24:21.137
> 
> 标签：maven, maven-plugin, maven-3

（注意：这个问题最初是由 Dan Allen 在 Google+ 上提出的：https: [//plus.google.com/114112334290393746697/posts/G6BLNgjyqeQ](https://plus.google.com/114112334290393746697/posts/G6BLNgjyqeQ)）

如果我运行“mvn install”，它将安装哪些工件？或者，如果我运行“mvn deploy”，它将部署哪些工件？

这可能是一个相当简单的插件，但如果它已经以编程方式在某处可用，我不想重新发明它。似乎这应该在某处很容易获得。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-07T08:24:32.300

正如[Andrew Logvinov](https://stackoverflow.com/users/966590/andrew-logvinov)已经评论的那样，任何 maven 插件都可以附加额外的工件。因此，如果不实际构建项目并执行绑定到生命周期阶段的所有插件，我认为这是不可能的`package`。

我不知道有任何预先存在的插件这样做，关闭可能是将实际部署运行到临时目录中，然后列出包含的文件。为避免在执行此操作时修改本地存储库，您需要避免该`install`阶段。该`verify`阶段直接发生在 之前`install`，然后可以显式调用部署 mojo。

[部署插件](http://maven.apache.org/plugins/maven-deploy-plugin/deploy-mojo.html)允许使用这样的文件 url 指定替代存储库：

```
mvn verify deploy:deploy -DaltDeploymentRepository=snapshots::default::file:///home/jh/Temp/repository 
```

列出所有附加工件的 maven 插件的最简单实现可能如下所示：

```
/**
 * @goal list-artifacts
 * @phase verify
 */
public class ListArtifactsMojo extends AbstractMojo {

    /**
     * @parameter default-value="${project}"
     * @required
     * @readonly
     */
    MavenProject project;

    public void execute() throws MojoExecutionException, MojoFailureException {
        Collection<Artifact> artifacts = new ArrayList<Artifact>();
        artifacts.add(project.getArtifact());
        artifacts.addAll(project.getAttachedArtifacts());

        for (Artifact artifact : artifacts) {
            System.out.println("Artifact: " + artifact);
        }
    }
} 
```

# javascript - three.js - 如何让相机在补间期间查看对象

> ID：10454182
> 
> 赞同：9
> 
> 时间：2012-05-04T18:24:21.177
> 
> 标签：javascript, canvas, 3d, webgl, three.js

所以我正在尝试根据在场景中单击的对象使用补间来补间相机的 fov，效果很好，但现在我想要它做的是让相机将焦点切换到被点击，这不起作用。这是我的点击代码：

```
function onDocumentMouseDown( event ) {
    event.preventDefault();

    var vector = new THREE.Vector3( ( event.clientX / window.innerWidth ) * 2 - 1, - ( event.clientY / window.innerHeight ) * 2 + 1, 0.5 );
    var ray = new THREE.Ray( camera.position, vector.subSelf( camera.position ).normalize() );
    var intersects = ray.intersectObjects( objects );
    if ( intersects.length > 0 ) { //We've clicked a certain object

        camTarget = intersects[0].object.position; //HERE'S THE VECTOR3 I WANT TO LOOK AT
        camTween.start();
    }
} 
```

以及我的补间/相机运动代码：

```
var camUpdate = function(){
    camera.fov = currentFov.fov;  //WORKING
    camera.lookAt(camTarget); //NOT WORKING
    camera.updateProjectionMatrix();
}

var currentFov = { fov: camera.fov };

TWEEN.removeAll();
camTween = new TWEEN.Tween(currentFov).to({fov: +zoomInFov},tweenTime).easing(camEase).onUpdate(camUpdate); 
```

相机正在适当地补间视野，但它似乎始终指向它始终指向的同一方向，而不是切换到 lookAt 命令中指定的“camTarget”向量。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-05-06T08:29:51.467

渲染器调用 THREE.Camera.update()，默认情况下将相机的旋转设置为查看 THREE.Camera.target（这是一个 THREE.Object3D）。而不是做...

```
camera.lookAt( camTarget ); 
```

...尝试...

```
camera.target.position.copy( camTarget ); 
```

我不确定我是否遵循 camTarget 补间的方式，或者它应该切换到新对象？

旁注：建议不要在事件处理程序中执行大量计算 - 在最好的情况下，您在事件处理程序中设置一个标志并在渲染循环中进行处理。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2020-02-09T16:39:00.483

遗憾的是，从 2020 年 2 月的 three.js 版本 112 开始，camera.target 不再有效。jb

# javascript - 在 ajax 渲染上加载 javascript

> ID：10454184
> 
> 赞同：0
> 
> 时间：2012-05-04T18:24:24.607
> 
> 标签：javascript, jquery

我对javascript很陌生并且碰壁了。

基本上我有一个表单，其中包含一些用于发出请求的字段（我正在使用其他人的代码）。

此表单的功能之一是能够发送多个请求，通过从下拉列表中选择请求数量，该表单的许多副本将使用 ajax 加载。

我最近在此表单中添加了 2 个新字段。一个复选框和一个文本字段。使用 jquery 我做了一个简单的切换，这样如果复选框被选中，就会出现文本字段。

```
<tr>
    <td>
        Allow Checkbox
    </td>
    <td>
        <input type="checkbox" name="Check_1" id="Check_1" value="2" />I accept
    </td>
</tr>
<tr id="Row_1" style="display:none;">
    <td>
        Here is a text field
    </td>
    <td>
        <input type="text" name="field_1" id="field_1" value="" />
    </td>
</tr>
<script>
                        $('#Check_1').click(function() {
                        $("#Row_1").toggle();
                        });
                        </script> 
```

这按预期工作，但是当我选择多个请求时它不起作用。通过 ajax 加载的表没有加载其中的 javascript 部分，因此这些字段在选中时不会切换，

我检查了语法，一切似乎都很好。php返回正确的字段ID，即#Check_2、#Row_2、#Check_3、#Row_3等与javascript相同，这是正确的。但是如何让 jquery 在渲染时加载呢？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-04T18:42:49.687

由于新字段是动态进入的，因此`.click`不会附加处理程序。

尝试使用：

```
$('#Check_1').live("click", function() {
    $("#Row_1").toggle();
}); 
```

- 更新 -

我刚刚看到你提到你`ids`正在改变。在这种情况下，我建议您在 html 中添加另一个属性，并将其用作选择器。

例如：

```
<tr>
    <td>
        Allow Checkbox
    </td>
    <td>
        <input type="checkbox" name="Check_1" id="Check_1" value="2" data-toggles />I accept
    </td>
</tr>
<tr id="Row_1" style="display:none;" data-togglable>
    <td>
        Here is a text field
    </td>
    <td>
        <input type="text" name="field_1" id="field_1" value="" />
    </td>
</tr> 
```

然后，使用 new`toggles`和`togglable`data 属性

```
$('[data-toggles]').live("click", function() {
    if ($(this).is(":checked")){
        $(this).parents("tr").siblings("[data-togglable]").show();
    } else {
        $(this).parents("tr").siblings("[data-togglable]").hide();
    }
}); 
```

# iphone - 如何使用电子邮件正文附加 NSMutableArray 数据？

> ID：10454185
> 
> 赞同：1
> 
> 时间：2012-05-04T18:24:25.037
> 
> 标签：iphone, objective-c, xcode, nsmutablearray, mfmailcomposeviewcontroller

我正在尝试将 NSMutableArray 数据附加到电子邮件正文。这是我的 NSMutableArray 代码：

```
NSUserDefaults *defaults1 = [NSUserDefaults standardUserDefaults];
    NSString *msg1 = [defaults1 objectForKey:@"key5"];
    NSData *colorData = [defaults1 objectForKey:@"key6"];
    UIColor *color = [NSKeyedUnarchiver unarchiveObjectWithData:colorData];
    NSData *colorData1 = [defaults1 objectForKey:@"key7"];
    UIColor *color1 = [NSKeyedUnarchiver unarchiveObjectWithData:colorData1];
    NSData *colorData2 = [defaults1 objectForKey:@"key8"];
    UIFont *color2 = [NSKeyedUnarchiver unarchiveObjectWithData:colorData2];
    CGFloat x =(arc4random()%100)+100;
    CGFloat y =(arc4random()%100)+250;  
    lbl = [[UILabel alloc] initWithFrame:CGRectMake(x, y, 100, 70)];
    lbl.userInteractionEnabled=YES;
    lbl.text=msg1;
    lbl.backgroundColor=color;
    lbl.textColor=color1;
    lbl.font =color2;
    lbl.lineBreakMode = UILineBreakModeWordWrap;
    lbl.numberOfLines = 50;
    [self.view addSubview:lbl];
    [viewArray addObject:lbl ]; 
```

现在，如果我的 viewArray 包含 3 个 UILabel 以及上面提到的所有这些属性。那么如何将这个 viewArray 附加到电子邮件正文中。这是我的电子邮件代码。

```
 - (IBAction)sendEmail
  {

  if ([MFMailComposeViewController canSendMail])
  {
     NSArray *recipients = [NSArray arrayWithObject:@"example@yahoo.com"];
     MFMailComposeViewController *controller = [[MFMailComposeViewController alloc] 
          init];
    controller.mailComposeDelegate = self;
    [controller setSubject:@"Iphone Game"];

    NSData *data = [NSKeyedArchiver archivedDataWithRootObject:viewArray];
   [controller addAttachmentData:data mimeType:@"application/octet-stream";  
    fileName:nil]; 

     NSString *emailBody = @"Happy Valentine Day!";
    [controller setMessageBody:emailBody isHTML:NO
    [controller setToRecipients:recipients];
    [self presentModalViewController:controller animated:YES];
    [controller release];

}
else 
{
    UIAlertView *alert = [[UIAlertView alloc] initWithTitle:@"Alert"
                                                    message:@"Your device is not set up for email." 
                                                   delegate:self 
                                          cancelButtonTitle:@"OK" 
                                          otherButtonTitles: nil];

    [alert show];

    [alert release];
}

} 
```

我没有错误。但没有看到电子邮件正文中的任何数据..在 viewArray 中。请任何人指导我如何将我的 viewArray 数据附加到电子邮件中。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-04T18:30:55.557

发送前检查 NSData 不为零。

IE;

```
[controller setSubject:@"Iphone Game"];

NSData *data = [NSKeyedArchiver archivedDataWithRootObject:viewArray];

if(!data){
    NSLog(@"Data is nil");

    return;
}
[controller addAttachmentData:data mimeType:@"application/octet-stream";  
fileName:nil]; 
```

# c++ - 查看给定 VC++ exe 中所有符号/文件的方法

> ID：10454192
> 
> 赞同：1
> 
> 时间：2012-05-04T18:24:41.987
> 
> 标签：c++, visual-studio, visual-studio-2010

我正在尝试找到一种方法来查看给定解决方案的可执行文件中包含的所有符号。

理想情况下，我想以制表符分隔的符号列表和命名空间结束。依赖关系也会很好。

目标是找到不匹配的命名空间，并确保代码在发布时被删除。

作为参考，Flash Builder + eclipse 有一个漂亮的链接器选项，可以列出所有符号及其依赖项。找到链接的“粘性”点非常有用。

我尝试寻找 pdb 查看器或命令行选项，但那里似乎没有任何东西。有谁知道这样做的方法？谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-04T18:27:54.580

您可以使用[dumpbin](http://msdn.microsoft.com/en-us/library/c1h23y6c.aspx)，它类似于 objdump 但适用于 Windows。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-04T21:14:06.793

我偶然发现了我正在寻找的功能。

它位于 Linker->Debugging->Generate Map File & Map File Name 下。

# sql - 从存储的日期时间获取星期几

> ID：10454196
> 
> 赞同：1
> 
> 时间：2012-05-04T18:25:02.267
> 
> 标签：sql

我用过这个

```
select datename(weekday,getdate()) 
```

给我今天的日期，但如果我使用

```
SELECT DATENAME(weekday,dob()) from myTable 
```

其中 dob 是我想要获取日期或星期的存储字段，它给了我一个错误。有没有办法轻松做到这一点？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-04T18:26:51.173

你的专栏里有括号吗？我猜它不是，所以你只使用列名：

```
SELECT DATENAME(weekday,dob) 
from myTable 
```

查看带有示例的[sql fiddle](http://sqlfiddle.com/#!3/a0dc1/1)

# javascript - 让用户的本地时间进入我的 Rails 应用程序

> ID：10454197
> 
> 赞同：1
> 
> 时间：2012-05-04T18:25:03.917
> 
> 标签：javascript, ruby-on-rails, datetime, timezone

如何将用户的本地时间输入到我的 Rails 应用程序中？

我不能询问他们的时区，也不想使用某些 API 从 ip 获取时区。

我认为这可能涉及将 Javascript 日期传递给我的 Rails 应用程序——我该怎么做呢？在我看来，我可以用 therubyracer 做到这一点，但这很麻烦。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-04T18:34:09.910

如果您希望通过表单获取用户日期，您可以有一个隐藏的表单字段并使用 javascript 将用户的时间输入该字段。

或者，您可以使用参数中的日期时间向某个自定义 URL`window.load`发送调用（或类似的）。`AJAX`

# c# - 在设计窗口中向自定义面板添加控件

> ID：10454199
> 
> 赞同：0
> 
> 时间：2012-05-04T18:25:09.700
> 
> 标签：c#, visual-studio-2010, user-controls, custom-panel

所以我创建了一个自定义面板类，如`public class CustomPanel : Panel`. 当我在解决方案资源管理器中双击它时，它的设计会打开，但它是空的（看不到面板本身，只有文本：“要将组件添加到您的类，将它们从工具箱中拖出等等......”。

问：我应该怎么做才能使我的自定义组件在其设计窗口中可编辑？在任何地方都找不到任何东西..

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-04T18:28:10.390

如果你想设计时编辑，你应该创建`UserControl`。（在其上放置`Panel`或您的自定义面板并做任何您想做的事情......在**DesignMode**）

当您派生（如您所描述的）时，您只需更改或添加新方法/属性到`Panel`类，您可以使用它而不是标准`Panel`类。

# ios - 如何在 iOS 中以编程方式设置 UIToolbar 的样式

> ID：10454203
> 
> 赞同：2
> 
> 时间：2012-05-04T18:25:31.263
> 
> 标签：ios, uitoolbar

我可以通过在“样式”下拉菜单中选择一个选项来在 xib 文件中执行此操作，例如。“黑色半透明”。我怎样才能以编程方式做到这一点？

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-04T18:46:13.003

在要设置它的视图控制器中，将以下内容添加到`viewDidLoad`：

```
[self.navigationController.toolbar setBarStyle:UIBarStyleBlackTranslucent]; 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-04T18:43:08.830

尝试设置`UIToolbar.barStyle`和`UIToolbar.translucent`。

# sql-server - 从字符串转换日期和/或时间时转换失败

> ID：10454204
> 
> 赞同：1
> 
> 时间：2012-05-04T18:25:36.963
> 
> 标签：sql-server

我有这个正在返回的 SQL Server 查询`Conversion failed when converting date and/or time from character string.`

```
(
    @numberRecords int,
    @date varchar(12)
)

AS
SET ROWCOUNT @numberRecords
SELECT re.ID, re.RecentChangeTypeID, re.LogID, re.RevisionID
FROM RecentChanges re
    FULL OUTER JOIN Revisions rev
        ON re.RevisionID = rev.ID
    FULL OUTER JOIN Logs lg
        ON re.LogID = lg.ID
WHERE convert(datetime, rev.Timestamp) >= '@date' OR
      convert(datetime, lg.Timestamp) >= '@date';
RETURN 
```

该`date`参数返回格式为“dd-MM-yyyy”的字符串值。可能是什么原因？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-04T18:37:18.767

不要将`@date`参数放在单引号内 - 它被解释为字符串而不是参数。

如所写，您正在尝试制作`'@date'`一个`datetime`不会解析的内容。

话虽如此，您可能应该`datetime`首先将输入参数设为 a 。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-04T18:53:49.180

删除@JNK 所描述的单引号以使您的查询正常工作。但是，为了可能获得更好的性能（索引使用），请尝试此查询（如果您在列`Revisions.Timestamp`和上有索引`Logs.Timestamp`）：

```
SELECT 
    re.ID, re.RecentChangeTypeID, re.LogID, re.RevisionID
FROM RecentChanges         re
    INNER JOIN Revisions   rev ON re.RevisionID = rev.ID
WHERE rev.Timestamp >= @date
UNION
SELECT 
    re.ID, re.RecentChangeTypeID, re.LogID, re.RevisionID
FROM RecentChanges    re
    INNER JOIN Logs   lg ON re.LogID = lg.ID
WHERE lg.Timestamp >= @date 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-04T18:34:04.017

乍一看，在我看来，您正在转换为日期时间，而不是从中转换。我假设 rev.Timestamp 已经是一个日期时间，而你的 @date 是一个 varchar(12) ......所以 SQL Server 抱怨它无法将日期时间与字符串进行比较......

# asp.net - 下拉覆盖静态值的数据源？

> ID：10454205
> 
> 赞同：0
> 
> 时间：2012-05-04T18:25:37.207
> 
> 标签：asp.net, servercontrols

我正在使用数据绑定到数据源的下拉服务器控件，但我还希望将默认值（“选择程序”）硬编码为列表的第一项。

**代码隐藏**

```
/// <summary>
/// Page Load
/// </summary>
protected void Page_Load(object sender, EventArgs e)
{
    ddPrograms.DataSource = Programs.SelectProgramID(1);
    ddPrograms.DataBind();        
} 
```

**前端**

```
 <asp:DropDownList ID="ddPrograms" runat="server" DataValueField="ProgramID" DataTextField="Name" AutoPostBack="true">
            <asp:ListItem Text="Select a program" Value="0" Selected="True"></asp:ListItem>   
        </asp:DropDownList> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-04T19:02:19.927

尝试`AppendDataBoundItems="true"`在 DropDownList 上进行设置。

```
<asp:DropDownList ID="ddPrograms" runat="server" DataValueField="ProgramID" DataTextField="Name" AutoPostBack="true" AppendDataBoundItems="true">
        <asp:ListItem Text="Select a program" Value="0" Selected="True"></asp:ListItem>   
    </asp:DropDownList> 
```

# c# - C# 中的服务器端脚本返回的时间与服务器时钟显示的时间不同

> ID：10454213
> 
> 赞同：0
> 
> 时间：2012-05-04T18:26:14.700
> 
> 标签：c#, asp.net

我面临着典型的问题。我的专用服务器时钟显示上午 11 点，并且在 asp.net 脚本中的 datetime 函数返回下午 4 点时间。

请帮助解决问题。我需要返回服务器时钟时间的功能。我不知道我是否第一次遇到它的常见问题。

自动与互联网时间服务器同步 :: CHECKED TICK ntp2.ja.net

GMT-05 东部时间（美国和加拿大）

一段代码::

```
 if (DateTime.Now.Hour >= 12 && Convert.ToDateTime(txtShipDate.Text.Trim()) < DateTime.Today.AddDays(2))
            {
                flag = false;
            }

            if (DateTime.Now.Hour < 12 && Convert.ToDateTime(txtShipDate.Text.Trim()) < DateTime.Today.AddDays(1))
            {
                flag = false;
            } 
```

问候

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-04T18:30:54.847

我猜您正在使用 DateTime（或简称为 Date）类的两个不同属性：Now 和 UtcNow。如果您使用 Now，请尝试使用 UtcNow，反之亦然。

# c# - 格式化后用许多名称填充组合框

> ID：10454217
> 
> 赞同：0
> 
> 时间：2012-05-04T18:26:25.367
> 
> 标签：c#, string, linq, data-binding, linq-to-entities

好的，我有一些看起来像这样的东西：

公司名称-1234

我只希望名称出现在组合框中供用户选择，因为在这种情况下，后跟数字的破折号是不必要的。

这是我的代码，用 Linq 查询数据库，然后删除破折号后的所有内容，但它似乎用任何东西填充组合框。

```
 using (context ctx = new context())
            {
            List<companyinformation> compInf = new List<companyinformation>();

            var getCompanies = (from c in ctx.companyinformations
                               select c.name).ToList();

            foreach (var n in getCompanies)
            {
                compInf.Add(new companyinformation() { name = Remove(n.LastIndexOf('-')) });
            }

            cbModClient.DataSource = compInf;
            cbModClient.DisplayMember = "name";
            cbModClient.SelectedIndex = -1;
            }; 
```

我刚刚尝试了这段代码，它工作得很好，我认为这是因为我这次使用“-”而不是“-”。

```
 using (context ctx = new context())
        {
            List<companyinformation> compInf = new List<companyinformation>(ctx.companyinformations);

            var getCompanies = (from c in compInf
                       where c.name.Contains("-")
                       select c.name.Substring(0, c.name.LastIndexOf("-"))).ToList();

            cbModClient.DataSource = getCompanies;
            cbModClient.DisplayMember = "name";
            cbModClient.SelectedIndex = -1;
        }; 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-04T18:30:49.897

您正在绑定到`getCompanies`结果集合，但您已经执行了字符串操作并将这些操作添加到`compInf`.

```
cbModClient.DataSource = compInf; 
```

也许更短的方式：

```
var companyNames = ctx.companyinformations
                      .Select(c=> new {FormattedName = 
                                 c.name.Substring(0,c.name.LastIndexOf('-'))
                                       .Trim()})
                      .ToList();

cbModClient.DataSource = companyNames;
cbModClient.DisplayMember = "FormattedName";
cbModClient.ValueMember = "FormattedName"; 
```

考虑在 DataSource 分配上放置一个断点，并检查/确保您的变量确实具有您期望的值。这将确定您的问题是与 LINQ 相关还是与数据绑定相关。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-04T18:56:25.383

我无法复制“仍然没有出现项目”的问题。这是一个等效的程序。

假设您确实从数据库中获得了结果并且没有抛出异常，那么剩下的问题是：您的 ComboBox 有何不同？

```
using System;
using System.Drawing;
using System.Linq;
using System.Windows.Forms;

class Form1 : Form
{
    class CompanyInfo
    {
        public string Name { get; set; }
    }

    static string RemoveTrailingDash(string value)
    {
        int dashIndex = value.LastIndexOf('-');
        if (dashIndex > 0)
            return value.Substring(0, dashIndex).TrimEnd();
        return value;
    }

    public Form1()
    {
        var companies = new CompanyInfo[]
        {
            new CompanyInfo { Name = "Ajax - 1200" },
            new CompanyInfo { Name = "Bermuda Corp - 1" },
            new CompanyInfo { Name = "Capitol Inc" },
            new CompanyInfo { Name = "Dash LLC - " },
        };

        Controls.Add(new ComboBox
        {
            Location = new Point(10, 10),
            DropDownStyle = ComboBoxStyle.DropDownList,

            DataSource = companies.Select(c => new { FormattedName = RemoveTrailingDash(c.Name) }).ToList(),
            DisplayMember = "FormattedName",
        });
    }
    [STAThread]
    static void Main()
    {
        Application.EnableVisualStyles();
        Application.SetCompatibleTextRenderingDefault(false);
        Application.Run(new Form1());
    }
} 
```

# javascript - 获取用户最近的 SoundCloud 曲目链接

> ID：10454218
> 
> 赞同：3
> 
> 时间：2012-05-04T18:26:35.993
> 
> 标签：javascript, html, soundcloud

我一直在寻找一种方法来做到这一点，因为看起来他们应该是一个。

我只想自动从我的 SoundCloud 页面中提取 5 个最新的曲目，并将它们放在我的网站上的“最新音频”部分下。

SoundCloud 甚至自己做这件事。如果你去一个特定的轨道，在页面的右下角有一个“用户名的更多轨道”，看看： [http ://soundcloud.com/goldenstatewarriors/mark-jackson-on-the-dan](http://soundcloud.com/goldenstatewarriors/mark-jackson-on-the-dan)

我发现的最接近的是：

```
http://api.soundcloud.com/tracks?client_id={client_id} 
```

但为此，您需要一个用于 soundcloud 应用程序的 client_id。我尝试注册一个应用程序，但是当我`client_id`在上面输入给我的信息时，我得到了一堆不属于我的曲目：

[http://api.soundcloud.com/tracks?client_id=02db8e29aa2fb5bf590f478b73137c67](http://api.soundcloud.com/tracks?client_id=02db8e29aa2fb5bf590f478b73137c67)

我只知道必须有办法做到这一点......

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-05-04T18:31:51.100

答案很简单

```
http://api.soundcloud.com/users/<USER_ID>/tracks.json?client_id=APP_ID 
```

像这样打它：

```
http://api.soundcloud.com/users/jakuboboza/tracks.json?client_id=APP_ID 
```

你得到：

```
[{"kind":"track","id":3481075,"created_at":"2010/06/16 12:27:20   +0000","user_id":1187050,"duration":1331,"commentable":true,"state":"finished","original_content_size":15835,"sharing":"public","tag_list":"","permalink":"nl-lul","description":"","streamable":true,"downloadable":false,"genre":"","release":"","purchase_url":null,"purchase_title":null,"label_id":null,"label_name":"","isrc":"","video_url":null,"track_type":"","key_signature"... 
```

排序`created_at`并获利:)

干杯! 希望这可以帮助

# xcode - 如何在 Xcode 中关闭 .js 文件的格式设置

> ID：10454219
> 
> 赞同：5
> 
> 时间：2012-05-04T18:26:38.750
> 
> 标签：xcode

有没有办法在 Xcode 中禁用 *.js 文件的源格式？格式化程序绝对会破坏我的 javascript 文件，但我不想失去 Objective-C 文件的功能。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-10-04T17:54:03.377

对我来说效果相当好的是将 .js 文件切换为使用 C 语法着色。

在 XCode 4 中：编辑器 -> 语法着色 -> C

它仍然突出显示数字、字符串和注释，并且以一种理智的方式缩进大括号。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-02-14T17:19:41.577

你可以通过去禁用疯狂的javascript自动缩进

首选项 -> 文本编辑 -> 缩进

并取消选中“语法感知缩进”。

这会禁用所有语言的自动缩进，而不仅仅是 .js 文件。如果您正在使用大量 javascript 或者不介意需要按 Tab 键来缩进，那么这可能是值得的。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-19T01:17:03.117

我有 XCode 4.6.1，我能够通过去保持语法着色

XCode -> 首选项... -> 文本编辑 -> 缩进

并且只是取消选中**自动缩进：“;”** （分号）。

我能够保持其他语法感知缩进打开，并得到了很好的结果。

# php - PHP脚本的任务划分

> ID：10454220
> 
> 赞同：1
> 
> 时间：2012-05-04T18:26:48.963
> 
> 标签：php, mysql, scheduled-tasks, division

我有一个网站抓取脚本，它将数据存储到几个 MySQL 表中。主表中的记录是从其他记录中引用的。该脚本需要大约 5 个小时才能执行，但它总是在大约 70 分钟后停止工作（set_time_limit() 设置为 c）。我尝试从浏览器和 cron 运行它，结果是一样的。

由于脚本在随机时间停止，因此可能导致数据库不一致。可以存储主表记录，但不能使用主表中的 mysql_insert_id() 存储从表记录。

有没有比在运行脚本时从主表中删除最后一条记录以及从其他表中删除该行的所有引用记录更好的方法？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-04T18:35:14.713

您可以将对给定记录的所有查询包装在事务中，并在最后提交。这样，如果脚本在一组查询中途死亡，更改将被回滚并且数据将保持一致。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-04T18:37:08.813

首先要做的事情：你检查过 mysql 连接的 TTL 吗？也许这就是导致问题的原因？

如果这个问题不断出现，您可能想看看使用 PDO 创建一个 db 适配器对象，您可以简单地使用：启动脚本，`$db->beginTransaction();`并通过提交更改来结束（如果一切顺利）`$db->commit();`。

这种方法有很多优点，其中最主要的是`$db->rollBack();`万一出现问题。另一个优点是，当 MySQL 端确实发生错误时，PDO 类会抛出一个`PDOException`对象，因此您可以进行回滚，以确保不会将损坏的数据写入您的数据库并以某种方式退出，类似于 this`die($e->getMessage());`看看什么完全出错了。

检查[PDO 手册页](http://www.php.net/PDO)以获取信息

# objective-c - 表格视图单元格选择在过渡前缓慢消失

> ID：10454227
> 
> 赞同：0
> 
> 时间：2012-05-04T18:27:21.017
> 
> 标签：objective-c, ios

我在任何应用程序中看到表格视图单元格选择突出显示在转换到其他视图之前非常平滑地消失。我已经搜索过这个主题，但我没有找到任何例子。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-04T18:39:18.240

您可以像这样实现您描述的效果。

```
 -(void)tableView:(UITableView *)tv didSelectRowAtIndexPath:(NSIndexPath *)indexPath{
    [tv deselectRowAtIndexPath:indexPath animated:YES];
    double delayInSeconds = .3;
    dispatch_time_t popTime = dispatch_time(DISPATCH_TIME_NOW, delayInSeconds * NSEC_PER_SEC);
    dispatch_after(popTime, dispatch_get_main_queue(), ^(void){
        Location *loc = [self.locations objectAtIndex:indexPath.row];
        LocationDetailsController *locationDetails = [[[LocationDetailsController alloc] initWithNibName:nil bundle:nil] autorelease];
        locationDetails.location = loc;
        [self.navigationController pushViewController:locationDetails animated:YES];
    });
} 

```

# iphone - 从 iPhone 到 PhP 的 POST 不起作用

> ID：10454231
> 
> 赞同：1
> 
> 时间：2012-05-04T18:27:55.023
> 
> 标签：iphone, post, nsurlconnection

第一次使用 POST

POST 信息未从 iPhone 获取到 PhP 脚本。我在任何地方都没有错误。var_dump($_POST) 显示为空。登录失败返回。任何想法下一步看哪里或者我在这里有一个明显的问题：

```
 NSURL *url = [NSURL URLWithString:link];
NSMutableURLRequest *request = [NSMutableURLRequest requestWithURL:url];

NSString *requestBodyString = [NSString stringWithFormat:@"txtuid=%@&txtpwd=%@", userName , password];
NSData *requestBody = [NSData dataWithBytes:[requestBodyString UTF8String]length:[requestBodyString length]];

[request setHTTPMethod:@"POST"];
[request setHTTPBody:requestBody];
[request setValue:@"application/x-www-form-urlencoded" forHTTPHeaderField:@"content-type"]; // added from first suggestion

connection = [[NSURLConnection alloc] initWithRequest:request delegate:self startImmediately:YES]; 
```

在尝试了六种不同的方式后，我从[之前的帖子](https://stackoverflow.com/a/2636694/714038)中获取了修改后的版本。

又一次尝试，结果相同。

```
NSData *data = [[NSString stringWithFormat: @"txtuid=%@&txtpwd=%@", userName , password] dataUsingEncoding:NSUTF8StringEncoding];

// set up request
NSMutableURLRequest *request = [[NSMutableURLRequest alloc] init];
[request setURL:[NSURL URLWithString:link]];
[request setHTTPMethod:@"POST"];
NSString *boundary = [NSString stringWithString:@"--------------------------------------------------"];
NSString *contentType = [NSString stringWithFormat:@"multipart/form-data; boundary=%@", boundary];
[request addValue:contentType forHTTPHeaderField:@"Content-Type"];

// body
NSMutableData *body = [NSMutableData data];
[body appendData:[[NSString stringWithFormat:@"\r\n--%@\r\n",boundary] dataUsingEncoding:NSUTF8StringEncoding]];
[body appendData:[[NSString stringWithString:@"Content-Type: text/plain\r\n\r\n"] dataUsingEncoding:NSUTF8StringEncoding]];  
[body appendData:[NSData dataWithData:data]];
[body appendData:[[NSString stringWithFormat:@"\r\n--%@--\r\n",boundary] dataUsingEncoding:NSUTF8StringEncoding]];  

[request setHTTPBody:body];
connection = [[NSURLConnection alloc] initWithRequest:request delegate:self startImmediately:YES]; 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-04T18:32:02.147

请参阅[我的回答，](https://stackoverflow.com/questions/5151004/to-upload-the-image-file-to-a-web-form/5151145#5151145)了解如何使用 POST 上传图片。它发布到 PHP 文件中的表单。发布数据和不上传图像的概念相同，但这是一个如何使用 Objective-C 发布到 PHP 脚本的工作示例。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-04T18:31:42.107

尽量不要`content-type`显式设置。避免以下行：

```
[request setValue:@"application/x-www-form-urlencoded" forHTTPHeaderField:@"content-type"]; 
```

如果您使用的是 iPhone 模拟器，我强烈建议您使用 PROXY 进行 HTTP 调试。[`mitmproxy`](http://mitmproxy.org/)太棒了。并且非常容易在**Mac OS X**上设置。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-09T13:01:07.810

使用以下代码。确保 post 字符串的收据是一个键并将在服务器中使用。客户端代码

```
 NSString *receipt1 = @"username";

    NSString *post =[NSString stringWithFormat:@"receipt=%@",receipt1];
   NSData *postData = [post dataUsingEncoding:NSASCIIStringEncoding allowLossyConversion:YES];

    NSString *postLength = [NSString stringWithFormat:@"%d", [postData length]];

    NSMutableURLRequest *request = [[[NSMutableURLRequest alloc] init] autorelease];
    [request setURL:[NSURL URLWithString:@"http://localhost:8888/validateaction.php"]];
    [request setHTTPMethod:@"POST"];
    [request setValue:postLength forHTTPHeaderField:@"Content-Length"];
    [request setValue:@"application/x-www-form-urlencoded" forHTTPHeaderField:@"Content-Type"];
    [request setHTTPBody:postData];

    NSHTTPURLResponse* urlResponse = nil;
    NSError *error = [[NSError alloc] init];
    NSData *responseData = [NSURLConnection sendSynchronousRequest:request returningResponse:&urlResponse error:&error];
    NSString *result = [[NSString alloc] initWithData:responseData encoding:NSUTF8StringEncoding];
    NSLog(@"Response Code: %d", [urlResponse statusCode]);

    if ([urlResponse statusCode] >= 200 && [urlResponse statusCode] < 300)
    {
        NSLog(@"Response: %@", result);
    }

} 
```

服务器端 php 脚本。

验证.php

```
<?php
 if(_POST)
    {
        if($_POST['receipt'] == 'username')
        {
            echo "post successfull";
         $receipt   = $_POST['key1'];
         echo $receipt;
        }
        else
    {
        echo "not post";
    }
?> 
```

# php - 将 UL 变成样式化的 SELECT

> ID：10454232
> 
> 赞同：2
> 
> 时间：2012-05-04T18:28:09.400
> 
> 标签：php, javascript, jquery, html

首先，我对 jQuery 和 HTMl5/CSS3 还很陌生，所以虽然可能有一个简单的解决方案，但我一直无法在互联网上找到一个。

我有一个 PHP 脚本，它使用 API 调用将我的 WoW 公会成员的名称提取到一个 UL 中，该 UL 带有一个类，可以正确地为游戏中类的名称着色。现在，我想把这个 UL 变成一个选择框，这样用户就可以在注册网站时选择他们的角色（更多的安全措施可以确保玩家选择他们的卡通人物之一）。

我希望选择框的样式适合我的表单的其余部分，并且我希望类颜色显示在选择中。我假设我必须作弊并使用某种形式的 DIV，但无法找到完全符合我要求的脚本。我的 UL 格式是这样的：

```
 <ul id="charNameList">
        <li><span class="priest">Alastriia</li>
        <li><span class="paladin">Aleathà</li>
        <li><span class="warrior">Arghra</li>
        <li><span class="druid">Autumnal</li>
        <li><span class="rogue">Beerisbadmmk</li>
        <li><span class="priest">Biip</li>
        <li><span class="mage">Blazeglory</li>
        <li><span class="druid">Blaçk</li>
        <li><span class="warlock">Braylna</li>
        <li><span class="warlock">Brileah</li>
        ...
    </ul> 
```

非常感谢任何帮助，即使只是将我指向我的 Google 技能未能找到的教程。谢谢 ：）

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-04T19:05:31.033

我相信你正在寻找更像这样的东西：

HTML

```
<h3 id="charNameListHeader">Select Your Toon: <span id="selectedToon"></span></h3>
<ul id="charNameList" style="display:none;">
    <li data-toonID="1"><span class="priest">Alastriia</li>
    <li data-toonID="2"><span class="paladin">Aleathà</li>
    <li data-toonID="3"><span class="warrior">Arghra</li>
    <li data-toonID="4"><span class="druid">Autumnal</li>
    <li data-toonID="5"><span class="rogue">Beerisbadmmk</li>
    <li data-toonID="6"><span class="priest">Biip</li>
    <li data-toonID="7"><span class="mage">Blazeglory</li>
    <li data-toonID="8"><span class="druid">Blaçk</li>
    <li data-toonID="9"><span class="warlock">Braylna</li>
    <li data-toonID="10"><span class="warlock">Brileah</li>
</ul>
<input type="hidden" id="selectedToonInput" /> 
```

JS

```
$('#charNameListHeader').click( function() {
    $(this).next().toggle();
});
$('#charNameList li').click( function() {
    var selectedValue = $(this).attr('data-toonID');
    $('#selectedToonInput').val(selectedValue);
    var newToon = $(this).children('span').clone();
    $('#selectedToon').html(newToon);
    $('#charNameList').hide();
}); 
```

JS 小提琴：http: [//jsfiddle.net/TQNfQ/2/](http://jsfiddle.net/TQNfQ/2/)

从那里，你只需让它看起来像你想要的那样。toonID 被设置为隐藏输入，因此您可以稍后在处理输入时将其拾取。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-04T18:37:18.443

为什么不使用选择元素？我认为最简单的方法`<li>`之一是隐藏除活动元素之外的所有元素。看起来像这样：

```
$('ul#charNameList li').hide().toggle(function(){
    $(this).siblings().hide();
}, function(){
    $(this).siblings().show();
}).first().show() 
```

# javascript - raphael.js IE8 和 Jquery

> ID：10454235
> 
> 赞同：1
> 
> 时间：2012-05-04T18:28:16.650
> 
> 标签：javascript, jquery, jquery-selectors, internet-explorer-8, raphael

我正在创建一个解剖人，用户可以在其中翻转肌肉，突出显示肌肉，单击时会显示肌肉的名称。通过一个单独的 JQuery，我有一组`<dl>`s，根据单击的肌肉组显示和隐藏。这在 IE9 和其他现代浏览器中运行良好，但我在 IE8 中遇到了问题。IE8 只想使用生成的 raphael.js 中的代码。所以我需要将 jquery 移动到 raphael 中……我相信这将是一种更优雅的方式。但是，我不确定如何进行此操作。

这是我的代码：

路径.js

```
var paths = { 
neck: {
    name: 'neck',
    path: 'd="M412.294,73.035c0,0,7.661,28.869,9.406,31.78c1.746,2.911,4.657,2.911,9.896,2.911 s9.313-1.746,9.896-5.239c0.582-3.493,6.985-28.523,6.985-28.523s-2.963,2.599-6.232,5.984c-2.543,2.632-7.2,5.904-11.088,5.904 c-3.889,0-6.705-2.431-10.367-5.04C418.063,78.868,418.08,79.22,412.294,73.035z"',
},
pecks: {
    name: 'Pecks',
    path: 'd="M379.581,117.994c0,0,0.396-1.586,6.936-4.558c6.539-2.972,13.475-5.351,16.844-6.737 c3.369-1.387,4.559-1.784,4.559-1.784s13.674,2.973,15.061,3.17c1.387,0.198,4.36,1.982,8.72,1.982s9.511-1.387,11.097-2.18 s10.307-2.973,11.693-3.171s1.387-0.198,1.387-0.198s12.286,3.369,16.845,4.36c4.558,0.991,8.917,2.378,9.116,3.765 c0.197,1.387,1.584,4.954,1.584,6.341s-0.197,5.945-0.396,6.738c-0.198,0.792-3.171,15.457-4.757,21.997 c-1.585,6.54-1.188,8.918-7.331,11.494s-10.899,7.53-22.79,2.378s-13.277-5.549-17.241-5.152s-11.098,3.963-14.862,5.351 c-3.766,1.387-16.251,2.179-20.412-0.198c-4.162-2.378-10.9-9.314-12.881-16.844c-1.981-7.531-3.963-16.052-4.359-17.638 C377.995,125.525,377.798,121.165,379.581,117.994z"',
},
} 
```

初始化.js

```
$(function(){

var r = Raphael('man', 500, 573),
    attributes = {
        fill: '#204ad3',
        opacity: '0.0',
        'stroke-linejoin': 'round'

    },
arr = new Array();

var id = 0;

for (var muscles in paths) {

    var obj = r.path(paths[muscles].path);

    obj.attr(attributes);

    obj.node.id = "muscle" + id;
    id++

    arr[obj.id] = muscles;

    obj
    .hover(function(){
        this.animate({
            fill: '#204ad3',
            opacity: '0.3'
        }, 300);
    }, function(){
        this.animate({
            fill: attributes.fill,
            opacity: attributes.opacity
        }, 300);
    })

    .click(function(){
        document.location.hash = arr[this.id];

        var point = this.getBBox(0);

        $('#man').next('.point').remove();

        $('#man').after($('<div />').addClass('point'));

        $('.point')
        .html(paths[arr[this.id]].name)
        .prepend($('<a />').attr('href', '#').addClass('close').text('Close'))
        .css({
            left: point.x+(point.width/2)-80,
            top: point.y+(point.height/2)-20
        })
        .fadeIn();

    });

    $('.point').find('.close').live('click', function(){
        var t = $(this),
            parent = t.parent('.point');

        parent.fadeOut(function(){
            parent.remove();
        });
        return false;
    });
}   

}); 
```

在 init.js 代码中有一个`click(function()`为肌肉群生成弹出窗口。我如何添加允许其他 jquery 根据用户单击的路径发生的代码？就像是：

```
$("dl").hide().delay(100);$('.tag-pathnamehere').show(); 
```

其中类的“pathnamehere”部分将根据单击的路径而改变。

我相信这一行将路径名添加到弹出窗口中：

```
(paths[arr[this.id]].name) 
```

我想以某种方式将类的“pathnamehere”部分更改为单击的路径。

我希望这很清楚，任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-04T22:41:12.507

Assuming that the `dl` elements are already created (are they?), I guess you could do something like:

```
arr = new Array();
tags = new Array();

...
arr[obj.id] = muscles;

tags[obj.id] = ".tag-" + paths[muscles].name; 
```

and then in the `click` handler

```
$(tags[this.id]).show(); 
```

# ios - 即使在应用退出后，如何使用 UIAutomation 工具继续测试 iOS 应用？

> ID：10454239
> 
> 赞同：7
> 
> 时间：2012-05-04T18:28:37.083
> 
> 标签：ios, automated-tests, functional-testing, ios-ui-automation

我有一个应用程序。应用程序中有一个按钮，如果单击该按钮，将退出应用程序。我正在使用 UIAutomation 工具测试应用程序。我想测试这个按钮。但是在应用程序退出后，仪器停止给出异常。我想做的是在应用程序存在后，我想重新打开应用程序并继续进行其余的测试。有没有其他人遇到过同样的情况？如果是这样，您能否分享解决方案，如果您找到任何解决方案？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-14T13:53:48.030

这是不可能的，因为 Instruments 一旦退出就会失去与应用进程的连接。

如果您从命令行编写 UI 自动化脚本，您可以在第一个自动化脚本退出应用程序后运行第二个自动化脚本，然后检查以确保一切都已重置。

```
instruments \
    -D [trace document] \
    -t [instruments template] \
    /path/to/Bundle.app \
    -e UIARESULTSPATH [directory to store test output] \
    -e UIASCRIPT reset_the_app.js

instruments \
    -D [trace document] \
    -t [instruments template] \
    /path/to/Bundle.app \
    -e UIARESULTSPATH [directory to store test output] \
    -e UIASCRIPT check_that_the_app_is_reset.js 
```

因此，与其尝试让同一个 Instruments 实例重新启动并重新附加到应用程序，只需运行两个单独的脚本，一个执行重置和中止，另一个检查应用程序的结果状态。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-11-06T10:00:13.053

感谢您的回答，但文档说：

“当用户通过点击主页按钮或导致其他应用程序进入前台退出您的应用程序时，您的应用程序将暂停。”

所以它不是重新启动而是暂停？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-07-12T14:32:30.960

您可以使用：

```
UIATarget.localTarget().deactivateAppForDuration(n); 
```

其中 n 是您希望此应用重新启动的秒数。我希望这有帮助。

# sql - 在 Coldfusion 中执行 SQL 函数

> ID：10454241
> 
> 赞同：5
> 
> 时间：2012-05-04T18:28:51.407
> 
> 标签：sql, function, coldfusion

我的 MS SQL(2005) 中有一个用户定义的函数，我想通过 Coldfusion (8) 执行该函数。知道我怎样才能让它工作吗？

[它不是一个存储过程，所以 cfstoredproc 出来了] 。

先感谢您。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-05-04T18:35:50.147

您可以直接在常规 CFQUERY 块内调用 SQL UDF，假设您的 Coldfusion 数据源对所需的 UDF 具有适当的 EXECUTE 权限。您不必在 CFQuery 中返回 select 语句。如果您将任何 Coldfusion 变量传递给数据库，请记住使用 CFQUERYPARAM 以确保安全。

要调用 UDF，您需要包含其架构*。在我们的例子中，我们使用了默认模式，因此我们的 UDF 以“dbo”为前缀。如在 dbo.FunctionName() 中。

这是一个例子：

```
<!--- We want to convert this numeric category into its English name.
      Thankfully our database administrator has a simple function to 
      resolve it without extra work on our part. --->

<cfset myCategory = 100428>

<!--- We call this Coldfusion variable using CFQUERYPARAM to prevent SQL Injection --->

<cfquery datasource="mydatasource" name="test">
  SELECT dbo.CategoryAsString(<cfqueryparam cfsqltype="cf_sql_integer" value="#myCategory#">) AS CategoryString
</cfquery>

<!--- And output the result here --->
<cfdump var="#test.CategoryString#"> 
```

*如果您不包含 UDF 的架构，您将收到“执行数据库查询时出错。[Macromedia][SQLServer JDBC 驱动程序][SQLServer]'[FUNCTION NAME]' 不是可识别的内置函数名称。” (CF 8)

# session - ColdFusion 删除会话变量

> ID：10454242
> 
> 赞同：2
> 
> 时间：2012-05-04T18:28:54.723
> 
> 标签：session, coldfusion, session-variables, coldfusion-9

我已经做了很多寻找会删除会话变量的代码的工作，而我成功的关键在于：

```
<cfset StructDelete(Session,"username")> 
```

它第一次工作，然后它永远不会再次工作。我在过去的一个小时里一直在做这件事，我快疯了，任何帮助都将不胜感激。

我不确定这是否相关，但是当我出于某种原因修改 .cfm 时，它似乎并不总是立即“更新”。我的意思是，我会更改一个页面，访问它并且它不会使用新代码。尝试调试时这是一个恐怖...

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-04T21:11:34.627

我怀疑你的意思是它重新存在，你认为它应该消失。查找设置变量的任何“cfparams”。它可能会被删除，然后在下一个请求时重新启动。

您还可以添加一个布尔值以在删除它时检查它是否存在。

```
<cfset exists= structdelete(session, 'username', true)/> 
```

如果它存在，这会给你一个“是”，如果它不存在，它会给你一个“否” - 如果你愿意，你可以执行进一步的逻辑。

您还可以查看您的应用程序名称、会话超时值 onsessionStart() 等。我已经看到每个请求都实例化一个新会话的问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-06T00:55:45.903

我只是cfset会话变量来杀死它......

```
 <cfset session.allowin = "False"> 
```

并且 application.cfm 文件总是在寻找真正的......

# java - Bean 在实例化时填充，但其字段在销毁时为空

> ID：10454243
> 
> 赞同：6
> 
> 时间：2012-05-04T18:29:14.493
> 
> 标签：java, spring, tomcat, configuration, dependency-injection

我有这样的课：

```
 public class Loader implements DisposableBean { 

        Class1 c1;
        Class2 c2;

        Loader(Class c1, Class c2) {
          this.c1 = c1;
          this.c2 = c2; 
    }
    @Override
    public void destroy() throws Exception {
        c1.do();
        c2.do();
    }
} 
```

它被创建为@Configuration 类中的@Bean。

```
@Bean(autowire = Autowire.BY_NAME, name = "loader")
public Loader getLoader() {
    return new Loader(getC1(), getC2());
} 
```

它通过我的 web.xml 中的上下文加载器侦听器进行实例化

```
<listener>
    <listener-class>org.springframework.web.context.ContextLoaderListener</listener-class>
</listener>

<context-param>
    <param-name>contextConfigLocation</param-name>
    <param-value>classpath:applicationContext-loader.xml</param-value>
</context-param> 
```

使用具有此行的应用程序上下文：

```
<context:component-scan base-package="name.of.package.loader.is.in" /> 
```

在 tomcat 中开始战争时，我在构造函数中放置了一个断点，我可以验证 c1 和 c2 是否按预期填充。但是，当我关闭 tomcat 并进入 destroy 方法时，c1 和 c2 都为空，因此抛出了 NPE。为什么这些价值观不再存在？

* * *

啊，该死的，应该再深入一点。它在我不熟悉的代码部分中被清除，我终于找到了它。

# javascript - jquery ajax调用后javascript不工作

> ID：10454248
> 
> 赞同：0
> 
> 时间：2012-05-04T18:29:43.470
> 
> 标签：javascript, jquery, ajax

我正在使用 jquery 开发我的第一个移动网络应用程序，

当我按下按钮转到下一页时，它确实可以，但页面上的 javascript 不起作用。

这是我的代码，和以前一样，我的标题是一个 php 文档，所以我不必一直回忆 header.php

```
<!--<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">-->
<!DOCTYPE html>
<html manifest="cache.manifest">
<!--<html>-->
    <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Balti Tandoori</title>

    <meta name="apple-mobile-web-app-capable" content="yes" />

    <link rel="apple-touch-icon" href="iphone.png" />
    <link rel="apple-touch-startup-image" href="startup.png" />
<!--<meta name="apple-mobile-web-app-status-bar-style" content="black" />-->

    <link rel="stylesheet" href="js/jquery.mobile-1.1.0.min.css" />
            <!-- App custom styles -->

     <link rel="stylesheet" href="js/balti.min.css" />
     <link href="css/mobile.css" rel="stylesheet" type="text/css" />

    <script src="js/jquery-1.7.1.min.js"></script>
    <script src="js/jquery.mobile-1.1.0.min.js"></script> 

            <style type="text/css" media="screen">

        h2 {
            margin: 0;
        }

        .drawers-wrapper {
            position: relative;
            width: 100%;

        }

        .drawer {
        background-color:#ffffff;

            color:#ffffff;
            font-size:20px;
            line-height:1.3em;

        }
<!-- NO REQUIRED -->
        .boxcap {
            height:5px;
            left:0pt;
            position:absolute;
            width:100%;
            z-index:100;
            background:transparent url(http://images.apple.com/downloads/images/sidenav_capbottom.png) no-repeat scroll 0%;
            margin-top:-5px;
        }

        .captop {
            background-image:url(http://images.apple.com/downloads/images/box_188captop.png );
            bottom:auto;
            top:0pt;
            margin-top:0;
        }
<!-- END JUST DOES CORNERS -->
        .drawers {
            margin-bottom:15px;
            color:#76797C;
            font-size:11px;
            line-height: 18px;

        }

        .drawers A {
            color:#666666;
            text-decoration:none;
            font-family:"Lucida Grande",Geneva,Arial,Verdana,sans-serif;
            font-size-adjust:none;
            font-style:normal;
            font-variant:normal;
            font-weight:normal;
        }

        .drawer li {
            border-bottom:1px solid #E5E5E5;
            line-height:16px;
            padding:6px 0pt;
        }

        UL {
            list-style: none;
            padding: 0;
        }

        UL.drawers {
            margin: 0;
        }

        .drawer-handle {
            background-color:#000000;

            color:#ffffff;
            cursor:default;
            font-size:20px;
            font-weight:normal;
            height:50px;
            line-height:25px;
            margin-bottom:0pt;
            text-indent:15px;
            width:100%;
            border:1px solid #ffffff
        }

        .drawer-handle.open {
        background:transparent url(css/body.gif) no-repeat;

        }

        .drawer UL {
            padding: 0 12px;
            padding-bottom:0pt;
        }

        .drawer-content UL {
            padding-top: 7px;
        }

        .drawer-content LI A {
            display:block;
            overflow:hidden;

        }

        .alldownloads li {
            border:0pt none;
            line-height:18px;
            padding:0pt;

        }

        </style>

        <script src="jquery.dimensions.js" type="text/javascript"></script>
    <script src="jquery.accordion.js" type="text/javascript"></script>  

    <!-- link to allow bookmark website -->
    <link rel="stylesheet" href="bookmark/add2home.css">
    <script type="text/javascript">
        var addToHomeConfig = {
        animationIn: 'bubble',
        animationOut: 'drop',
        lifespan:10000,
        expire:2,
        touchIcon:true,
        message:'Add Our Mobile App To Your <strong>%device</strong> Home Page. Available Anytime `%icon`.'
        };
    </script>
    <script type="application/javascript" src="bookmark/add2home.js"></script>
    <!-- bookmark end -->

   <script type="text/javascript">
        $(document).bind("mobileinit", function() {
        $.mobile.page.prototype.options.addBackBtn = true;
        });    
    </script>  
<script type="text/javascript">

$(function () {
  $('UL.drawers').accordion({
    // the drawer handle
    header: 'H2.drawer-handle',

    // our selected class
    selectedClass: 'open',

    // match the Apple slide out effect
    event: 'mouseover'
  });
});

</script>

    </head> 
```

这是我的 index.php

```
<?
require_once("header.php");
?>
<!-- do not touch above -->
    <body>
        <div data-role="page" id="page1" data-theme="f">
            <div data-theme="f" data-role="header">
                <img src="css/logo.gif"width="100%" style="border-bottom :1px solid white" alt="" />
            </div>
         <div data-role="content">
                <ul data-role="listview" data-divider-theme="b" data-inset="true">
                    <li data-theme="b">
                        <a href="menu.php" data-transition="flip">
                            Menu
                        </a>
                    </li>
                    <li data-theme="b">
                        <a href="#page1" data-transition="flip">
                            Opening Times
                        </a>
                    </li>
                    <li data-theme="b">
                        <a href="#page1" data-transition="flip">
                            How To Find Us
                        </a>
                    </li>
                </ul>
                <a data-role="button" data-transition="pop" href="page1" data-theme="b" data-icon="tel" data-iconpos="left">
                    Call Us
                </a>
         <!--   </div>-->

    </div>

            <!-- do not touch below -->

            <div data-theme="b" data-role="footer">
                <h3>
                    &copy; Balti Tandoori
                </h3>
            </div>
        </div>
        <script>
            //App custom javascript
        </script>
    </body>
</html> 
```

这是 javascript 不运行的索引调用的页面，如果我从这样的按钮禁用 ajax 调用，它将运行但我希望 ajax 也能正常工作，我如何在加载时调用 javascript 等

```
<a href="javascript:window.location.href='menu.php'"  data-ajax='false' 
```

菜单.php

```
<?
require_once("header.php");
?>
<!-- do not touch above -->
    <body>

        <div data-role="page" id="page1" data-theme="f">
            <div data-theme="f" data-role="header">
                <img src="css/logo.gif"width="100%" style="border-bottom :1px solid white" alt="" />
            </div>
         <div data-role="content">
         <a href="index.php"  data-role="button" data-transition="flip" data-icon="back" data-theme="b">Back</a>
                              <a data-role="button" data-transition="pop" href="page1" data-theme="b" data-icon="tel" data-iconpos="left">
                    Call Us
                </a>
         <!--   </div>-->

                          <div class="drawers-wrapper">
    <!--<div class="boxcap captop"></div>-->
    <ul class="drawers">

 <ul class="drawers">
        <li class="drawer">
            <h2 class="drawer-handle open">Starters</h2>
     <!-- removes under border-->
           <!-- <ul class="alldownloads">-->
            <!--removed above -->
            <ul>
                <li id="sn-downloadsmacosx">All Categories <div style="text-align:right;">£2.50</div></li>
                <li id="sn-aperture">Big dish<div style="text-align:right;">£2.50</div></li>
                <li id="sn-apple"><a href="/downloads/macosx/apple/">Apple</a></li>

                <li id="sn-video"><a href="/downloads/macosx/video/">Video</a></li>
                <li id="sn-dashboard"><a href="/downloads/dashboard/" class="bottom">Widgets</a></li>
            </ul>
        </li>
        <li class="drawer">
            <h2 class="drawer-handle">Tandoori</h2>
            <ul>
                <li><a title="iTunes 7.5" href="http://www.apple.com/itunes/download/">1\. iTunes 7.5</a></li>
                <li><a title="QuickTime 7.3.1" href="http://www.apple.com/quicktime/download/">2\. QuickTime 7.3.1</a></li>

                <li><a title="iSquint" href="/downloads/macosx/ipod_itunes/isquint.html">13\. iSquint</a></li>
                <li class="last"><a title="US Holiday Calendar" href="/downloads/macosx/calendars/usholidaycalendar.html">14\. US Holiday Calendar</a></li>
            </ul>
        </li>
          <li class="drawer">
            <h2 class="drawer-handle">Traditional</h2>
            <ul>
                <li><a title="iTunes 7.5" href="http://www.apple.com/itunes/download/">1\. iTunes 7.5</a></li>
                <li><a title="QuickTime 7.3.1" href="http://www.apple.com/quicktime/download/">2\. QuickTime 7.3.1</a></li>

                <li><a title="iSquint" href="/downloads/macosx/ipod_itunes/isquint.html">13\. iSquint</a></li>
                <li class="last"><a title="US Holiday Calendar" href="/downloads/macosx/calendars/usholidaycalendar.html">14\. US Holiday Calendar</a></li>
            </ul>
        </li>
          <li class="drawer">
            <h2 class="drawer-handle">Originals</h2>
            <ul>
                <li><a title="iTunes 7.5" href="http://www.apple.com/itunes/download/">1\. iTunes 7.5</a></li>
                <li><a title="QuickTime 7.3.1" href="http://www.apple.com/quicktime/download/">2\. QuickTime 7.3.1</a></li>

                <li><a title="iSquint" href="/downloads/macosx/ipod_itunes/isquint.html">13\. iSquint</a></li>
                <li class="last"><a title="US Holiday Calendar" href="/downloads/macosx/calendars/usholidaycalendar.html">14\. US Holiday Calendar</a></li>
            </ul>
        </li>
          <li class="drawer">
            <h2 class="drawer-handle">Specials</h2>
            <ul>
                <li><a title="iTunes 7.5" href="http://www.apple.com/itunes/download/">1\. iTunes 7.5</a></li>
                <li><a title="QuickTime 7.3.1" href="http://www.apple.com/quicktime/download/">2\. QuickTime 7.3.1</a></li>

                <li><a title="iSquint" href="/downloads/macosx/ipod_itunes/isquint.html">13\. iSquint</a></li>
                <li class="last"><a title="US Holiday Calendar" href="/downloads/macosx/calendars/usholidaycalendar.html">14\. US Holiday Calendar</a></li>
            </ul>
        </li>
        <li class="drawer last">
            <h2 class="drawer-handle">Fish</h2>
            <ul>
                <li><a title="iTunes 7.5" href="http://www.apple.com/itunes/download/">1\. iTunes 7.5</a></li>
                <li><a title="QuickTime 7.3.1" href="http://www.apple.com/quicktime/download/">2\. QuickTime 7.3.1</a></li>

                <li><a title="Security Update 2007-009 1.1 (10.4.11 Universal)" href="/downloads/macosx/apple/security_updates/securityupdate20070091110411universal.html">13\. Security Update 20</a></li>
                <li class="last"><a title="Security Update 2007-009 1.1 (10.5.1)" href="/downloads/macosx/apple/security_updates/securityupdate2007009111051.html">14\. Security Update 20</a></li>
            </ul>
        </li>
    </ul>   
<!--<div class="boxcap"></div>-->
    </div>  

            </div>      

            <!-- do not touch below -->
            <div data-theme="b" data-role="footer">
                <h3>
                    &copy; Balti Tandoori
                </h3>
            </div>

    </body>
</html> 
```

非常感谢您的帮助

为清楚起见添加到 header.php

```
 <script type="text/javascript">

  $(document).bind('pageinit', function(){  //new bit added in script
$(function () {
  $('UL.drawers').accordion({
    // the drawer handle
    header: 'H2.drawer-handle',

    // our selected class
    selectedClass: 'open',

    // match the Apple slide out effect
    event: 'mouseover'
  });
});
});          //new bit added in script
</script> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-04T18:48:42.987

*哪个*JavaScript 不工作？我很难完全理解你的意思，但我愿意预感到你的事件处理程序都没有被绑定。您没有显示所有这些外部脚本文件的内容，所以我不能肯定地说，但只是快速细分：

您所有的 JavaScript 标记都在文档的头部。这意味着它们在处理主体标签之前被加载。此外，jQuery Mobile 动态地创建了大量的 DOM。我没有看到对 的调用`$(document).ready()`，这很好，因为这在 jQuery Mobile 中已经被“淘汰”了，我**也**没有看到对 的调用`$(document).bind("pageinit", function())`，这是在页面加载后将事件处理程序绑定到 DOM 元素的首选方式在 jQuery 移动。

我看到您将回调绑定到文档的`mobileinit`事件，但是[根据 jQuery Mobile](http://jquerymobile.com/test/docs/api/globalconfig.html)文档，这在 DOM 构建之前很久就被调用了。

假设您的手风琴功能不起作用。您正在寻找的模式类似于：

```
$(document).bind('pageinit', function(){
    $('UL.drawers').accordion({
    // the drawer handle
    header: 'H2.drawer-handle',

    // our selected class
    selectedClass: 'open',

    // match the Apple slide out effect
    event: 'mouseover'
    });
}); 
```

# delphi - 何时调用单元中的终结方法？

> ID：10454249
> 
> 赞同：6
> 
> 时间：2012-05-04T18:29:45.643
> 
> 标签：delphi, delphi-2010

我有一个最近崩溃的应用程序，我能够使用 EurekaLog 获取它的调用堆栈。我注意到的是，调用了一个单元完成，但应用程序没有关闭并继续工作。

AFAIK，最终化部分仅在应用程序终止时调用。但这不是发生在我身上的事。

有谁知道为什么不应该调用终结方法？

**编辑**

此应用程序不使用任何 dll 或 bpls。

**编辑2**

完成后的线程是否有可能调用终结？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-04T18:32:36.027

最终确定在两个地方被调用。最常见的是应用程序终止时。但是它们也可以在卸载 DLL（或 BPL）时调用，这会在应用程序终止时自动发生，但如果代码显式卸载它，也可能在程序运行的中间发生。

有可能这就是正在发生的事情吗？

# java - 为什么 replaceAll 从字符串中删除数字？

> ID：10454250
> 
> 赞同：3
> 
> 时间：2012-05-04T18:29:48.847
> 
> 标签：java, regex, string, replaceall

```
String foo = "a3#4#b";
String afterPunctutationRemoval = foo.replaceAll("[,.;:?!'-_\"/()\\{}]", "");
System.out.println(afterPunctutationRemoval); 
```

结果它给了我“a##b”，有人可以解释一下为什么吗？

它不应该按原样返回字符串吗？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-05-04T18:32:52.060

您的字符类包含范围`'`..`_`也匹配数字。

将 放在`-`字符类的开头或结尾：

```
foo.replaceAll("[,.;:?!'_\"/()\\{}-]", "") 
```

或逃避它：

```
foo.replaceAll("[,.;:?!'\\-_\"/()\\{}]", ""); 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-05-04T18:32:40.693

`'-_`匹配 和 之间`'`的每个字符`_`。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-07T08:03:04.663

就像另外两个人说的那样，逃避`-`角色—— `\\-`。

此外，`\\{`评估结果与 相同`{`，这是故意的吗？如果没有，请尝试转义反斜杠 -`\\\\{`

# sql - 如何使用子字符串结果对另一个表进行子字符串化和连接

> ID：10454253
> 
> 赞同：0
> 
> 时间：2012-05-04T18:30:00.657
> 
> 标签：sql, oracle, oracle10g

我有 2 个表：errorlookup 和错误。errorlookup 有 2 列：代码和描述。代码长度为 2。错误有 2 列 id 和错误代码。错误代码的长度为 40，这意味着它们代码为每个 id 存储 20 个错误代码。我需要通过子串错误代码并与错误查找表中的代码匹配来显示与 id 关联的所有描述。错误查找的示例数据：

```
代码：描述
   12：无效
   22：不活动
   21：活跃

```

错误的样本数据：

```
id：错误代码
 1:1221
 2:2112
 3:1222

```

我不能使用 LIKE，因为它会导致太多错误。我希望将错误代码列分解为长度为 2 的字符串，然后加入错误查找。怎么做到呢？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-05T00:10:16.917

如果你真的不能改变表结构，这里有另一种方法：

创建辅助`numbers`表：

```
CREATE TABLE numbers
( i INT NOT NULL 
, PRIMARY KEY (i)
) ;

INSERT INTO numbers VALUES
( 1 ) ;   
INSERT INTO numbers VALUES
( 2 ) ;
--- ...
INSERT INTO numbers VALUES
( 100 ) ; 
```

然后你可以使用这个：

```
SELECT err.id
     , err.errorcodes
     , num.i
     , look.codes
    , look.descriptionid
FROM
    ( SELECT i, 2*i-1 AS pos      --- odd numbers
      FROM numbers
      WHERE i <= 20               --- 20 pairs
    ) num 
  CROSS JOIN 
    errors  err
  JOIN 
    errorlookup  look
      ON look.codes = SUBSTR(err.errorcodes, pos, 2)
ORDER BY 
    err.errorcodes
  , num.i ; 
```

测试：[SQL-Fiddle](http://sqlfiddle.com/#!4/c7939/18)

```
ID  ERRORCODES  I   CODES  DESCRIPTIONID
1   1221        1   12     Invalid
1   1221        2   21     Active
3   1222        1   12     Invalid
3   1222        2   22     Inactive
2   2112        1   21     Active
2   2112        2   12     Invalid 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-04T23:31:01.317

我认为最干净的解决方案是使用 PL/SQL 函数“规范化”您的错误代码表。这样，您可以保留当前（损坏的）表格设计，但仍可以访问其内容，就好像它已正确规范化一样。

```
create type error_code_type as object (id integer, code varchar(2))
/

create or replace type error_table as table of error_code_type
/

create or replace function unnest_errors
   return error_table pipelined
is  
  codes_l integer;
  i       integer;
  one_row error_code_type := error_code_type(null, null);
begin
  for err_rec in (select id, errorcodes from errors) loop
    codes_l := length(err_rec.errorcodes);
    i := 1;
    while i < codes_l loop
        one_row.id   := err_rec.id;
        one_row.code := substr(err_rec.errorcodes, i, 2);
        pipe row (one_row);
        i := i + 2;
    end loop;
  end loop;
end;
/ 
```

现在使用此功能，您可以执行以下操作：

```
select er.id, er.code, el.description
from table(unnest_errors) er
  join errorlookup el on el.codes = er.code; 
```

您还可以基于该函数创建一个视图，以使语句更易于阅读：

```
create or replace view normalized_errorcodes 
as
select *
from table(unnest_errors); 
```

然后您可以简单地引用真实语句中的视图。

（我在 11.2 上对此进行了测试，但我相信它也应该在 10.x 上工作）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-04T19:03:25.627

我认为你在正确的轨道上`LIKE`。MySQL 有一个`RLIKE`允许通过正则表达式进行匹配的函数（我不知道它是否存在于 Oracle 中。）您可以将`errorlookup.code`其用作匹配`errors.errorcodes`. 该`(..)*`模式用于防止匹配“1213”之类的内容，例如“21”。

```
SELECT *
FROM error
JOIN errorlookup
WHERE errorcodes RLIKE CONCAT('^(..)*',code)
ORDER BY id;

+------+----------+------+
| id   | errorcode| code |
+------+----------+------+
|    1 | 11       | 11   |
|    2 | 1121     | 11   |
|    2 | 1121     | 21   |
|    3 | 21313245 | 21   |
|    3 | 21313245 | 31   |
|    3 | 21313245 | 32   |
|    4 | 21       | 21   |
+------+----------+------+ 
```

# jquery - 你能简化 jQuery 代码吗，让我变得更有活力

> ID：10454261
> 
> 赞同：1
> 
> 时间：2012-05-04T18:30:53.267
> 
> 标签：jquery, jquery-ui, dynamic

恐怕，当我使用代码时：

```
<div id="sentence_xx"></div> 
```

我总是要打印很多 jquery 代码。

我可以在这个链接中看到代码：http:
[//jsfiddle.net/hBRNy/2/](http://jsfiddle.net/hBRNy/2/)

问题是，会有很多 div 语句

```
<div id="sentence_xx"></div> 
```

每次我想打印它时，我都必须为每个**< div>**打印整个 jquery 块。

有人知道我怎么解决这个问题吗？因为 jquery 生成的 id 必须是唯一的，我希望这可以更灵活但不知道如何。

亲切的问候

* * *

我通过使用 jquery 通配符找到了一个解决方案（你不能用类替换 id，因为 ui.jquery 不再起作用：

```
<script>
    $(document).ready(function() {
    // For everey id, started with sentence_  (the sentences which I want)
    $('[id^=sentence_]').each(function() {

    // strip the id until i have the number only (sentence_ is a static value)
    var currentId = $(this).attr('id');
    var toRemove = "sentence_";
    var id = currentId.replace(toRemove,'');

    //replace all the characters by "</li> <li class=\"ui-widget-content_"+id+"\">"
    var text = $("#"+currentId).text().trim().split("").join("</li> <li class=\"ui-widget-content_"+id+"\">");
    $("#"+currentId).html("<li class=\"ui-widget-content_"+id+"\">" + text + "</li>");

    //create a <ol> after the div selectable_xx
    $('<ol class="selectable_style" id="selectable_'+id+'"></ol>').insertAfter("#"+currentId);

    // remove the value of the div and place them into the <ol>
   $('.ui-widget-content_'+id+'').clone().appendTo("#selectable_"+id);
    $('#sentence_'+id).remove();

    //replace all the " " by non breaking spaces 
    $('#selectable_'+id+' li').each(function() {
      $(this).html($(this).text().replace(' ', '&nbsp;'));
    });

     //attache the function for selecting items and put the character place into the next span
        $( "#selectable_"+id ).selectable({
            stop: function() {
                var woord ="" ;
                var result = $( "#selectable_"+id ).next('span').empty();
                $( ".ui-selected", this ).each(function() {
                    var index = $( "#selectable_"+ id +" li" ).index( this );
                    result.append( " #" + ( index + 1 ) );
                    letter = index + 1;
                    woord += letter+'';
                });

                }
            });
        });     
    });
</script> 
```

如果你想玩它，我已经更新了代码
[http://jsfiddle.net/hBRNy/16/](http://jsfiddle.net/hBRNy/16/)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-04T18:35:55.727

您应该改用类并尝试使您的代码更加模块化，以避免新元素的重复代码。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-04T18:40:31.390

您应该将 css`class'es`用于重复它们自身的元素。

因此，如果您有许多具有相同功能的元素，例如

所以你可以做这样的事情：

```
$(".my-class").html("<a href='#'>Me!</a>"); 
```

这会将相同的行为附加到类“my-class”的所有元素

要生成像 html 这样的内容，您应该使用把手[http://handlebarsjs.com/](http://handlebarsjs.com/)这样的东西，这可以让您定义模板并在 javascripts 中呈现它们

像这样的东西

```
<a href="{{url}}">{{name}} </a> 
```

变成这个

```
(for var object = {name: "my blog", url: "http://no-idea.com"})

<a href="http://no-idea.com">my blog</a> 
```

（它重写了我的旧帖子，我看到有一些显示错误）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-04T20:46:01.843

我同意类帖子，但如果您确实需要保留句子编号，您可以使用[HTML 5 数据属性](http://html5doctor.com/html5-custom-data-attributes/)将它们存储在节点上。这样您就不必担心重复的 id 属性，并且您仍然可以获得所需的 CSS 挂钩。

```
<div data-sentence="xx"></div> 
```

在 CSS 中选择它们：

```
div[data-sentence] { foo: bar; } 
```

或在 jQuery 中：

```
$('div[data-sentence]') 
```

但是，如果您不需要保留句子编号，只需使用其他人提到的课程即可。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-09T00:52:09.777

尽我所能：/不讨厌

```
$(document)
.ready(function () {
$("[id^=sentence_]")
    .each(function () {
    var a = $(this)
        .attr("id"),
        b = "sentence_",
        c = a.replace(b, ""),
        d = $("#" + a)
            .text()
            .trim()
            .split("")
            .join('</li> <li class="ui-widget-content_' + c + '">');
    $("#" + a)
        .html('<li class="ui-widget-content_' + c + '">' + d + "</li>"), $('<ol class="selectable_style" id="selectable_' + c + '"></ol>')
        .insertAfter("#" + a), $(".ui-widget-content_" + c + "")
        .clone()
        .appendTo("#selectable_" + c), $("#sentence_" + c)
        .remove(), $("#selectable_" + c + " li")
        .each(function () {
        $(this)
            .html($(this)
            .text()
            .replace(" ", "&nbsp;"))
    }), $("#selectable_" + c)
        .selectable({
        stop: function () {
            var a = "",
                b = $("#selectable_" + c)
                    .next("span")
                    .empty();
            $(".ui-selected", this)
                .each(function () {
                var d = $("#selectable_" + c + " li")
                    .index(this);
                b.append(" #" + (d + 1)), letter = d + 1, a += letter + ""
            })
        }
    })
})
}) 
```

# c - 用 .a 文件编译 c 文件的命令

> ID：10454263
> 
> 赞同：10
> 
> 时间：2012-05-04T18:30:55.680
> 
> 标签：c, linux, gcc, x86-64

我有几个 .c 文件和一个 .a 目标文件。我应该使用 gcc 的什么命令将它们编译为一个 exe 文件？如果我们使用makefile，它会是什么样子？

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2012-05-04T18:41:05.710

对于简单的情况，您可能可以这样做：

```
gcc -o maybe.exe useful.a something.c 
```

重要项目的 Makefile 通常首先调用 gcc 将每个 .c 文件编译为 .o 对象。

```
gcc -c something.c 
```

然后他们使用 .o 和 .a 文件列表调用链接器（这些天经常使用 gcc 作为它的包装器）以链接到输出可执行文件。

```
gcc -o maybe.exe useful.a something.o 
```

另请注意，对于大多数已安装的库，通常不会显式指定 .a 文件，而是说 -lhandy 是“尝试在配置的（或使用 -L 指定的）搜索目录中查找名为 libhandy.a 的东西的缩写"

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-05-04T18:44:12.133

`*.a`是一个静态库而不是动态的（`*.dll`在 windows 和`*.so`linux 中）

```
gcc -L<here comes the library path> -l<library name> 
```

例如对于您在当前路径中有 libname.a 的文件，您应该使用：

```
gcc *.c -L. -lname -o myprogram.o 
```

来自[man](http://linux.die.net/man/1/gcc)（将 man gcc 放在 shell 命令提示符中）

> 您可以混合使用选项和其他参数。在大多数情况下，您使用的顺序无关紧要。当您使用多个相同类型的选项时，顺序确实很重要。例如，如果您多次指定 -L，则会按指定的顺序搜索目录。此外，-l 选项的位置也很重要。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-05-04T18:34:59.193

.a 文件是一个库，已经编译。您将 .c 文件编译为 .o，然后使用链接器将 .o 与 .a 链接以生成可执行文件。

# android - Android Fragments 兼容库导致的各种异常

> ID：10454265
> 
> 赞同：0
> 
> 时间：2012-05-04T18:30:56.773
> 
> 标签：android, android-fragments, android-support-library

我已经使用（[Peter Doyle's](https://github.com/petedoyle/android-support-v4-googlemaps)Android 支持/兼容性库（v4，修订版 7）的轻微变体，用于组合使用 Fragments 和 Google Maps 的 Activity。我已经在三星 Galaxy Nexus（冰淇淋三明治）、三星 Galaxy S II（冰淇淋三明治）、HTC Desire HD（姜饼）、HTC Wildfire S（姜饼）和模拟器上测试了该应用程序。该应用程序在这些设备上运行良好。没问题。但是，我已经发布了该应用程序，并且在各种手机上看到了由该库引起的不同类型的错误报告，尤其是在恢复 Activity 时（即，如果没有强制关闭，似乎具有 Fragments 的 Activity 无法在某些手机上恢复自身）。下面我粘贴了一些修剪过的堆栈跟踪作为示例。对此真的很恼火，因为我无法在我拥有的设备上复制它。

运行时异常：

> java.lang.RuntimeException:
> __无法启动活动...
> java.lang.IllegalStateException:
> __指定的孩子已经有一个父母。
> __您必须首先在孩子的父母上调用 removeView()。
> 在 android.app.ActivityThread.performLaunchActivity(ActivityThread.java:1713)
> 在 android.app.ActivityThread.handleLaunchActivity(ActivityThread.java:1738)
> 在 android.app.ActivityThread.handleRelaunchActivity(ActivityThread.java:3024)
> ...
> 由: java.lang.IllegalStateException:
> __指定的孩子已经有一个父母。
> __您必须首先在孩子的父母上调用 removeView()。
> 在 android.view.ViewGroup.addViewInner(ViewGroup.java:1976)
> 在 android.view.ViewGroup.addView(ViewGroup.java:1871)
> ...

非法状态异常

> java.lang.IllegalStateException:
> __Can not perform this action after onSaveInstanceState
> at android.support.v4.app.FragmentManagerImpl.checkStateLoss(Unknown Source)
> at android.support.v4.app.FragmentManagerImpl.beginTransaction(Unknown Source)
> ...

非法状态异常

> java.lang.IllegalStateException:
> __Fragment cw{4067d550} 未附加到 Activity
> ...

运行时异常

> java.lang.RuntimeException:
> __Unable to resume activity...
> java.lang.NullPointerException
> at android.app.ActivityThread.performResumeActivity(ActivityThread.java:2124)
> at android.app.ActivityThread.handleResumeActivity(ActivityThread.java:2139)
> .. .

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-04T20:26:08.777

我遇到了 v4 库的问题，唯一解决它的方法是转到 properties->Java Build Path->Order and Export，然后确保选中 v4 框。否则它会给我 classnotfound 错误。它只是在我将文件从计算机移回 dropbox.com 后才开始崩溃。当您分发您的应用程序时，可能发生了一些变化？

# ruby-on-rails - 需要从 excel 加载 URL 并且需要使用 Ruby 脚本执行

> ID：10454268
> 
> 赞同：0
> 
> 时间：2012-05-04T18:31:06.153
> 
> 标签：ruby-on-rails, ruby, import-from-excel

我对 ruby​​ 很陌生，我想学习 ruby​​ 代码。我有基础知识。我有页面列表（URL），我保存在 Excel 中。我想获取这些页面并且需要在浏览器中加载。请在下面找到我为页面加载编写的基本脚本。

```
require 'rubygems'

require 'watir'

ie = Watir::IE.new

ie.goto("http://google.com")

ie.goto("http://www.softwaretestinghelp.com/")

ie.goto("http://www.onestoptesting.com/manual-testing/")

ie.goto("https://facebook.com") 
```

请帮助完成它。

谢谢和问候， 明尼苏达州维纳亚卡

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2015-09-08T07:54:33.170

您可以使用 Nokogiri gem 和 xml/json 文件来完成。例如：

```
require 'watir-webdriver'
require 'nokogiri'

browser = Watir::Browser.new :firefox
doc = Nokogiri::XML(File.open('your_file.xml'))
url = doc.at('//url').text

browser.goto(url) 
```

你必须有这样的xml：

```
<url>http://google.com</url> 
```

# java - 访问图例项文本

> ID：10454269
> 
> 赞同：1
> 
> 时间：2012-05-04T18:31:12.033
> 
> 标签：java, jfreechart

我正在创建一个条形图：

```
final JFreeChart result = ChartFactory.createBarChart(TITLE, // chart title
    X_TITLE, // domain axis label
    Y_TITLE, // range axis label
    dataset, // data
    PlotOrientation.HORIZONTAL, // the plot orientation
    true, // legend
    true, // tooltips
    false // urls
    ); 
```

然后我添加了一个 ChartMouseListener，如此处[所述](https://stackoverflow.com/questions/8218853/how-to-listen-for-clicks-in-java-jfreechart-using-events/8219445#8219445)。

当我单击图例项时，会显示“LegendItemEntity：seriesKey=null，dataset=null”。

如何访问相应项目的图例文本？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-04T20:14:55.647

从源开始[`org.jfree.chart.demo.BarChartDemo1`](https://github.com/jfree/jfree-demos/blob/master/src/main/java/org/jfree/chart/demo/BarChartDemo1.java)并将其添加`ChartMouseListener`到[源](https://github.com/jfree/jfree-demos/blob/ad2112371b403721f922c2b34938d61653c16f0a/src/main/java/org/jfree/chart/demo/BarChartDemo1.java#L60)会产生如下结果：

```
LegendItemEntity: seriesKey=First, dataset=org.jfree.data.category.DefaultCategoryDataset@d9510071
LegendItemEntity：seriesKey=Second，数据集=org.jfree.data.category.DefaultCategoryDataset@d9510071
LegendItemEntity：seriesKey=Third，数据集=org.jfree.data.category.DefaultCategoryDataset@d9510071

```

如果您得到不同的结果，[sscce](http://sscce.org/)可能会有所帮助。

# java - Java中的私有IP

> ID：10454270
> 
> 赞同：2
> 
> 时间：2012-05-04T18:31:15.437
> 
> 标签：java, sockets

我们当前的系统正在通过套接字接收连接，我们需要确定已连接客户端的私有 IP。目前，我们可以通过 轻松访问公共 IP `connectingSocket.getInetAddress()`，但是获取*私有*地址的最佳方法是什么？

谢谢！

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-05-04T18:34:08.940

简单的答案很简单：**你不能。**

更复杂的答案：如果您可以控制客户端连接到 java 套接字的方式（即强制它们通过代理使用 HTTP），您可以让代理将该信息添加到特殊的标头中。或者，如果您使用专有协议，您可以在协议本身上对私有 IP 进行编码。但是，没有获取该信息的通用方法。**NAT**只是让私有 IP 地址消失。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-04T19:20:37.203

期望能够从公共请求中获取私有 IP 是不合逻辑和不安全的。NAT 和代理隐藏私有 IP 有几个原因，一个是安全性。此外，您不知道传入连接在最终到达您的服务之前可能会经过多少层 NAT'ing、代理或 VLAN 等。

如果您控制客户端（即：它是您自己的 java 客户端等），您可以使用几种不同的技术对请求中的信息进行编码（可能在标头中、有效负载的一部分等中），但如果它是正在连接的通用客户端，那么您无法控制该信息。

也许最好的问题是你为什么想要/需要这些信息？如果是用于记录或跟踪个人，请记住，私有 IP 可以随时更改（大多数人使用 DHCP）并且大多数人没有启用任何类型的 DHCP 记录/历史记录。因此，要通过公共 ip->private ip 追踪哪个硬件发起了连接将是一项不可能完成的任务。

# c# - 将 Mat Lab 函数与 C# 集成

> ID：10454271
> 
> 赞同：2
> 
> 时间：2012-05-04T18:31:16.493
> 
> 标签：c#, time-series, matlab-deployment

我在 Mat Lab 中有这个时间序列函数：

```
function y = time(a, b, c, d, e, f, g, h, i, j, k, l)
x = [a b c d e f g h i j k l];
ts1 = timeseries(x,1:12);
ts1.Name = 'Monthly Count';
ts1.TimeInfo.Units = 'months';
ts1.TimeInfo.Format = 'mmm dd, yy';
ts1.Time=ts1.Time-ts1.Time(1);
plot(ts1); 
```

我已将其部署为 C# 库。现在如何调用函数“时间”并传递参数？

谢谢你的帮助

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-04T19:07:04.357

生成的 C# 库将根据您的 MATLAB 编译器项目设置进行调用 - 假设它是 MyMatLabLib.dll。一旦你将 MyMatLabLib.dll 包含到你的 .NET 项目中，你应该能够像这样使用它：

```
using MyMatLabLib;
public class MatLabWrapper
{
    public MatLabWrapper()
    {
        var ml = new MyMatLab();
        ml.time( /* pass in MWArrays as parameters */ )
    }
} 
```

# php - t 函数中 if 语句中的字符串错误

> ID：10454277
> 
> 赞同：0
> 
> 时间：2012-05-04T18:31:24.883
> 
> 标签：php, mysql

我不断收到此错误：

**PHP Parse 错误：语法错误，意外的 T_STRING**

对于这一行：

```
if($email_addr == "") /* If real email not found, return FALSE*/ 
```

我不知道哪里出了问题，尝试了很多东西，研究了两天，没有更正。我想知道是否其他人可以看到我做错了什么。为什么我会收到此错误？谢谢你。（功能如下）

```
 function searchRecipient() // function to search the database for the real email
{
    global $MessageSentToMailbox; // bring in the alias email
    $email_addr = mysql_query("SELECT email FROM tbl WHERE source='$MessageSentToMailbox'"); // temp store of the real email
    $row = mysql_fetch_assoc($email_addr); //making temp store of data for use in program
    if($email_addr == "") /* If real email not found, return FALSE*/
    {
        return FALSE;
    }
    else  /* Else, return find the person's name and return both in an array */
    {
        $query = "SELECT * FROM tbl WHERE email = '$email_addr'"; // pulling in the row where the emails match
        $results = mysql_query($query, $email_addr); // temp store of both queries from this function
        $row = mysql_fetch_assoc($results); //making temp store of data for use in program
        $name = $row['author'];  // taking the author data and naming its variable
        return array($name, $email_addr);  // this is the name and the real email address to be used in function call
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-04T18:34:27.490

您正在将资源与字符串进行比较。

你真正想做的是：

```
if ($row['email']== "") 
```

或者，更好的是：

```
if (empty($row['email'])) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-04T18:34:27.150

```
if($row['email']== "") /* If real email not found, return FALSE*/
    {
        return FALSE;
    } 
```

# asterisk - Asterisk 认为呼出电话是传真机

> ID：10454279
> 
> 赞同：0
> 
> 时间：2012-05-04T18:31:38.363
> 
> 标签：asterisk

一位用户最近通知我，每当他们尝试拨入另一家公司的电话会议时，电话会在 5 秒左右后挂断。他们还表示，当使用手机拨打同一个号码时，没有问题。我在日志文件中找到了以下条目。

```
[May 4 11:58:20] VERBOSE[24063] app_dial.c: -- DAHDI/1-1 is ringing
[May 4 11:58:20] VERBOSE[24063] app_dial.c: -- DAHDI/1-1 answered SIP/145-00000005
[May 4 11:58:24] WARNING[24063] rtp.c: Don't know how to represent 'f'
[May 4 11:58:24] VERBOSE[24063] chan_dahdi.c: -- Redirecting DAHDI/1-1 to fax extension
[May 4 11:58:24] VERBOSE[24063] pbx.c: -- Executing [h@macro-dialout-trunk:1] Macro("SIP/145-00000005", "hangupcall,") in new stack
[May 4 11:58:24] VERBOSE[24063] pbx.c: -- Executing [s@macro-hangupcall:1] GotoIf("SIP/145-00000005", "1?theend") in new stack 
```

我无法确定解决方案。任何有关解决此问题的见解或建议表示赞赏。（使用 FreePBX v2.9；Asterisk v1.6.2.15.1；CentOS 5.5（最终版）；Sangoma A102）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-04T18:52:34.797

尝试添加到文件中

/etc/asterisk/sip_general_custom.conf

```
faxdetect=no 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-07T12:59:22.683

还尝试修改 chan_dahdi.conf，但没有奏效。最终解决方案是在 /etc/wanrouter/wanpipe1.conf 中修改这些设置（从 YES 更改为 NO）

```
TDMV_HW_DTMF         = NO            # YES: receive dtmf events from hardware
TDMV_HW_FAX_DETECT   = NO            # YES: receive fax 1100hz events from hardware 
```

# android - 项目背景的列表视图问题

> ID：10454283
> 
> 赞同：1
> 
> 时间：2012-05-04T18:32:13.510
> 
> 标签：android, background, android-listview

我的`ListView`项目背景有问题，它比应有的大。这是我的背景资源：

![在此处输入图像描述](../Images/93ac09db48a8d293cf91c56c9a3b0fb4.png)

这是我设备的屏幕截图：

![在此处输入图像描述](../Images/534031efaea1c404f9a0dc11d03d8b9b.png)

布局：

```
 <?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
android:layout_width="fill_parent"
android:layout_height="fill_parent"
android:orientation="vertical"
android:background="@drawable/bg_nocar">
<LinearLayout
    android:layout_width="fill_parent"
    android:layout_height="wrap_content"
    android:orientation="horizontal"
    android:layout_marginTop="50dp"
    android:layout_marginLeft="6.67dp">
    <TextView
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:text="@string/reservation"
        android:textStyle="bold"
        style="@style/reservation_text" />
    <TextView
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:text="@string/reservation.1"
        style="@style/reservation_text" />
</LinearLayout>
<TextView
    android:layout_width="fill_parent"
    android:layout_height="wrap_content"
    android:text="@string/reservation.selectclass"
    style="@style/reservation_selectclass_text"
    android:layout_marginTop="33.33dp"
    android:layout_marginLeft="6.67dp" />
<ListView 
    android:id="@id/android:list"
    android:layout_width="fill_parent"
    android:layout_height="wrap_content"
    android:divider="#00000000"
    android:dividerHeight="0.67dp" />
</LinearLayout> 
```

这是我的项目布局：

```
 <LinearLayout 
xmlns:android="http://schemas.android.com/apk/res/android"
android:id="@+id/reservation_row"
android:layout_width="fill_parent"
android:layout_height="fill_parent"
android:background="@drawable/car_bg"
android:orientation="horizontal">
    <LinearLayout 
        android:layout_width="93.33dp"
        android:layout_height="98.67dp"
        android:orientation="vertical"
        android:layout_marginLeft="6.67dp"
        android:layout_marginTop="13.33dp">
        <TextView
            android:id="@+id/classname"
            android:layout_width="fill_parent"
            android:layout_height="wrap_content"
            style="@style/reservation_classname" />
        <TextView
            android:id="@+id/name"
            android:layout_width="fill_parent"
            android:layout_height="wrap_content"
            style="@style/reservation_name"
            android:layout_marginTop="16.67dp" />
    </LinearLayout>
    <LinearLayout 
        android:layout_width="wrap_content"
        android:layout_height="98.67dp"
        android:orientation="vertical"
        android:layout_marginLeft="6.67dp"
        android:layout_marginTop="13.33dp">
        <ImageView
            android:id="@+id/img"
            android:layout_width="150dp"
            android:layout_height="93.33dp"
            android:layout_marginTop="6dp" />
        <TextView
            android:id="@+id/price"
            android:layout_width="30dp"
            android:layout_height="20dp"/>      
        <TextView
            android:id="@+id/item"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:visibility="gone" />
    </LinearLayout>
</LinearLayout> 
```

为什么背景那么大？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-04T19:21:12.650

由于您不希望图像缩放到列表项的尺寸，因此不应将其作为背景。
相反，您可以这样做。让背景为白色（因为您的 car_bg 资源全是白色的，带有一个徽标）。然后，您的列表视图布局可能如下所示：

```
<RelativeLayout>  //background white
  <ImageView>  //Your car_bg with width and height set as wrap_content
  <LinearLayout>  //All the content that you previously had
</RelativeLayout> 
```

这样，您的图像将不会被缩放并保持原始图像。也就是说，您现在必须自己乘坐不同屏幕尺寸的汽车。您的`car_bg`资源必须有不同的密度图像可用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-04T19:13:21.420

尝试[**缩放`ImageView`以保持其纵横比**](https://stackoverflow.com/q/2521959/844882)，而不是尝试手动设置其高度/宽度。这很可能是您`ImageView`看起来很紧张的原因。

# ajax - PhoneGap / jQuery Mobile 应用程序中是否允许“POST”跨域 ajax 请求？

> ID：10454287
> 
> 赞同：3
> 
> 时间：2012-05-04T18:32:24.827
> 
> 标签：ajax, jquery-mobile, cordova, webview

如标题所示：PhoneGap / jQuery Mobile 应用程序在 webview 模式下是否允许“ **POST** ”跨域 ajax 请求？前提是两者`$.mobile.allowCrossDomainPages`都`$.support.cors`设置为 true。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-04T19:31:34.510

你不需要其中任何一个。

如果您在 iOS 中，只需添加一个新的外部主机并将其值设置为 *

如果您使用的是 Android，请将其添加到您的清单中

```
<access origin="https://example.com" subdomains="true" /> 
```

这是关于同一主题的另一篇文章 [-phonegap 1.3.0 中的白名单状态是什么？](https://stackoverflow.com/questions/8899608/what-is-the-state-of-whitelisting-in-phonegap-1-3-0)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-13T20:26:23.860

```
jQuery.support.cors = true; 
```

也试试这个

# ruby-on-rails - Ubuntu：“unicorn_init.sh start”有效，但“service unicorn_init start”无效

> ID：10454292
> 
> 赞同：1
> 
> 时间：2012-05-04T18:32:42.220
> 
> 标签：ruby-on-rails, ubuntu, nginx, rvm, unicorn

我已经在 Ubuntu 12.04 服务器上安装了带有独角兽的 nginx。一切正常，站点，数据库，独角兽......很好。所以我试图确保在重新启动后，nginx 和 unicorn 启动。我为我的独角兽进程设置了 update-rc.d，但它在重新启动后无法启动/工作。我怀疑这与 ubuntu 使用“服务”而不是“/etc/init.d/unicorn_init”有关

换句话说：

如果我执行：

```
$ /etc/init.d/unicorn_init start 
```

独角兽启动很好，没有错误。

如果我执行：

```
$ service unicorn_init start 
```

它失败了，独角兽没有启动。

我认为它与路径有关。我已将环境 PATHS 添加到 PATH、GEM_PATH 和 GEM_HOME，但我仍然收到相同的结果

# 1，如果我运行 /usr/local/rvm/gems/ruby-1.9.3-p194/bin/unicorn，我会得到错误：

```
usr/local/rvm/rubies/ruby-1.9.3-p194/lib/ruby/site_ruby/1.9.1/rubygems/dependency.rb:247:in `to_specs': Could not find unicorn (>= 0) amongst[bigdecimal-1.1.0, io-console-0.3, json-1.5.4, minitest-2.5.1, rake-0.9.2.2, rdoc-3.9.4] (Gem::LoadError)
    from /usr/local/rvm/rubies/ruby-1.9.3-p194/lib/ruby/site_ruby/1.9.1/rubygems/dependency.rb:256:in `to_spec'
    from /usr/local/rvm/rubies/ruby-1.9.3-p194/lib/ruby/site_ruby/1.9.1/rubygems.rb:1231:in `gem'
    from /usr/local/rvm/gems/ruby-1.9.3-p194/bin/unicorn:18:in `<main>' 
```

# 2，如果我运行 /var/rails/web-app/bin/unicorn，我会得到错误：

```
/usr/local/rvm/rubies/ruby-1.9.3-p194/lib/ruby/site_ruby/1.9.1/rubygems/custom_require.rb:36:in `require': cannot load such file -- bundler/setup (LoadError)
    from /usr/local/rvm/rubies/ruby-1.9.3-p194/lib/ruby/site_ruby/1.9.1/rubygems/custom_require.rb:36:in `require'
    from /var/rails/web-app/bin/unicorn:14:in `<main>' 
```

任何帮助将不胜感激！谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-04T19:19:15.237

您应该使用包含所有必需环境变量的 unicorn 包装脚本：

```
rvm wrapper 1.9.3 ruby-1.9.3 unicorn 
```

它将`ruby-1.9.3_unicorn`在 init 脚本中生成 use this 而不仅仅是 unicorn。

您可以通过以下方式找到有关包装器的更多详细信息：

```
rvm wrapper 
```

如果通过捆绑器（如 capitrano）完成工作，则生成一个包装器`bundle`：

```
rvm wrapper 1.9.3 ruby-1.9.3 bundle 
```

并使用此命令显示的包装器的完整路径：

```
which ruby-1.9.3_bundle 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-27T20:16:39.350

你说的对，Eric，我自己做，在开发模式下运行就可以了。这个例子不能正常使用，还是很粗糙的。

我的`config/unicorn_init`文件：

```
TIMEOUT=${TIMEOUT-60}
PID=$APP_ROOT/tmp/pids/unicorn.pid
CMD="PATH=$_PATH GEM_HOME=$_GEM_HOME GEM_PATH=$_GEM_PATH $APP_ROOT/.bundle/bin/unicorn -D -c $APP_ROOT/config/unicorn.rb"

set -e
action="$1"
set -u

old_pid="$PID.oldbin"

cd $APP_ROOT || exit 1

sig () {
    test -s "$PID" && kill -$1 `cat $PID`
}

oldsig () {
    test -s $old_pid && kill -$1 `cat $old_pid`
}

case $action in
start)
    sig 0 && echo >&2 "Already running" && exit 0
    su -c "$CMD" - $APP_USER
    ;;
stop)
    sig QUIT && exit 0
    echo >&2 "Not running"
    ;;
force-stop)
    sig TERM && exit 0
    echo >&2 "Not running"
    ;;
restart|reload)
    sig HUP && echo reloaded OK && exit 0
    echo >&2 "Couldn't reload, starting '$CMD' instead"
    su -c "$CMD" - $APP_USER
    ;;
upgrade)
    if sig USR2 && sleep 2 && sig 0 && oldsig QUIT
    then
        n=$TIMEOUT
        while test -s $old_pid && test $n -ge 0
        do
            printf '.' && sleep 1 && n=$(( $n - 1 ))
        done
        echo

        if test $n -lt 0 && test -s $old_pid
        then
            echo >&2 "$old_pid still exists after $TIMEOUT seconds"
            exit 1
        fi
        exit 0
    fi
    echo >&2 "Couldn't upgrade, starting '$CMD' instead"
    su -c "$CMD" - $APP_USER
    ;;
reopen-logs)
    sig USR1
    ;;
*)
    echo >&2 "Usage: $0 <start|stop|restart|upgrade|force-stop|reopen-logs>"
    exit 1
    ;;
esac 
```

```
echo "#\!/bin/bash\n_PATH=$PATH\n_GEM_HOME=$GEM_HOME\n_GEM_PATH=$GEM_PATH\nAPP_ROOT=$(pwd)\nAPP_USER=$USER\n$(cat config/unicorn_init)" > config/unicorn_init.sh 
```

```
chmod +x config/unicorn_init.sh 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2018-07-08T19:36:12.533

这是 6 年前对这个问题/答案的更新。从**RVM 1.29.4**和**Ubuntu 16.04**开始。mpapis 的答案对于旧版本的 ubuntu 和 rvm 仍然有效。

从**RVM 1.29.4**开始，上述答案`vm wrapper 1.9.3 ruby-1.9.3 unicorn`不再有效，也不再需要。

包装器已经创建，如果需要，可以在它们的位置以及适当的 gemset 中找到。

查看以下目录位置`/usr/local/rvm/wrappers`。在那里你会找到你想要的 ruby​​ 版本和 gemset 的链接。跟随该链接将带您访问它的所有包装器：`unicorn, unicorn_rails, god, puma, thin, thor, ...`等*。*

例子：

```
TIMEOUT=${TIMEOUT-60}

APP_ROOT=/var/rails/com.domain.site/current
PID=$APP_ROOT/tmp/pids/unicorn.pid
DAEMON=/usr/local/rvm/wrappers/ruby-2.5.1@app/unicorn

CMD="$DAEMON -D -c $APP_ROOT/config/unicorn.rb -E production" 
```

或者，您也可以使用直接路径：

```
DAEMON=/usr/local/rvm/gems/ruby-2.5.1@app/wrappers/unicorn 
```

你懂的(^_^)

# validation - CakePHP 2 & Translate Behavior：在一个表单中保存多个翻译

> ID：10454293
> 
> 赞同：0
> 
> 时间：2012-05-04T18:32:43.970
> 
> 标签：validation, internationalization, cakephp-2.0, locale

它可以在一个表单中保存同一字段的多个翻译吗？我有一个带有行为翻译的模型来翻译名称字段。三个翻译（deu、eng、ita）已正确记录在 i18n 表中，但该字段未正确验证！有什么建议么？

应用程序/模型/Category.php

```
class Category extends AppModel {
    public $actsAs = array('Translate' => array('name' => 'TranslateName'));
    public $validate = array(
        'name' => array(
            'notempty' => array(
                'rule' => array('notempty'),
                'message' => 'Error notempty',
            ),
        ),
    );
    ... 
```

应用程序/查看/类别/admin_edit.ctp

```
<?php
echo $this->Form->create('Category');
echo $this->Form->input('Category.id');
echo $this->Form->input('Category.name.deu', array('label' => __d('Category', 'Name Deu')));
echo $this->Form->input('Category.name.eng', array('label' => __d('Category', 'Name Eng')));
echo $this->Form->input('Category.name.ita', array('label' => __d('Category', 'Name Ita')));
echo $this->Form->end(__d('app', 'Submit'));
?> 
```

应用程序/视图/控制器/CategoriesController.php

```
if ($this->Category->save($this->request->data)) {
    $this->Session->setFlash(__d('Category', 'The category has been saved'));
} else {
    $this->Session->setFlash(__d('Category', 'The category could not be saved. Please, try again.'));
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-15T13:54:07.037

我有一个类似的问题

但是你可以试试这个 - 它应该为你解决它：[https ://github.com/zoghal/cakephp-MultiTranslateBehavior](https://github.com/zoghal/cakephp-MultiTranslateBehavior)

# jquery-mobile - 防止意外点击移动应用程序中的 Google Map APi 属性/徽标

> ID：10454302
> 
> 赞同：0
> 
> 时间：2012-05-04T18:33:45.383
> 
> 标签：jquery-mobile, google-maps-api-3, rhomobile

我使用 Rhomobile、jQuery Mobile 和 Google Maps API 构建了一个移动应用程序。一些用户不小心点击了地图底部的 Google 徽标和归属链接。有没有办法防止此类意外链接和/或捕获它们并询问用户他们是否真的想离开应用程序？

这是应用程序布局的示例：[http ://www.mycoursewalk.com/mobile_course_walk/course_view/152](http://www.mycoursewalk.com/mobile_course_walk/course_view/152)

在手机上打开它以更好地查看问题。

谢谢，

缺口，

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-04T20:34:24.877

不幸的是，如果不违反[服务条款，](http://developers.google.com/maps/terms)就无法做到这一点。

# java - JTable 中的 JPanel 专注于鼠标点击而不是鼠标悬停

> ID：10454304
> 
> 赞同：0
> 
> 时间：2012-05-04T18:33:52.707
> 
> 标签：java, swing, jtable, mouselistener

我有一个表，其中一列包含 JPanel。我已经编写了自定义渲染器和编辑器，它们工作正常。但是，该面板包含一个带有工具提示的 JLabel 组件。如果我单击单元格并将鼠标悬停在标签上，则会显示工具提示，但如果我将鼠标移入单元格并将鼠标悬停在 JLabel 上，则不会显示工具提示。我在表格中添加了一个鼠标侦听器，如下所示，我在其中获取 Panel 对象并尝试使其具有焦点。

```
public void mouseMoved(MouseEvent e) {
    Point p = e.getPoint();
    int row = table.rowAtPoint(p);
    int column = table.columnAtPoint(p);
    System.out.println(row + " " + column);
    Object o = table.getModel().getValueAt(row, column);
    if (o instanceof FileInfoCellPanel) {
        FileInfoCellPanel ficp = (FileInfoCellPanel)o;
        ficp.requestFocusInWindow();
        //ficp.revalidate();
    }
} 
```

我肯定得到了正确的 JPanel 对象，但它似乎从来没有得到关注。因此，单击单元格似乎将焦点集中在面板上，但移动鼠标却没有。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-04T19:55:01.903

如果您只想在工具提示中显示文本，则在渲染器返回的组件上设置工具提示就足够了。`JTable#getTooltipText`如果您查看我在下面复制的方法的实现，就可以看到这一点

```
public String getToolTipText(MouseEvent event) {
    String tip = null;
    Point p = event.getPoint();

    // Locate the renderer under the event location
    int hitColumnIndex = columnAtPoint(p);
    int hitRowIndex = rowAtPoint(p);

    if ((hitColumnIndex != -1) && (hitRowIndex != -1)) {
        TableCellRenderer renderer = getCellRenderer(hitRowIndex, hitColumnIndex);
        Component component = prepareRenderer(renderer, hitRowIndex, hitColumnIndex);

        // Now have to see if the component is a JComponent before
        // getting the tip
        if (component instanceof JComponent) {
            // Convert the event to the renderer's coordinate system
            Rectangle cellRect = getCellRect(hitRowIndex, hitColumnIndex, false);
            p.translate(-cellRect.x, -cellRect.y);
            MouseEvent newEvent = new MouseEvent(component, event.getID(),
                                      event.getWhen(), event.getModifiers(),
                                      p.x, p.y,
                                      event.getXOnScreen(),
                                      event.getYOnScreen(),
                                      event.getClickCount(),
                                      event.isPopupTrigger(),
                                      MouseEvent.NOBUTTON);

            tip = ((JComponent)component).getToolTipText(newEvent);
        }
    }

    // No tip from the renderer get our own tip
    if (tip == null)
        tip = getToolTipText();

    return tip;
} 
```

可以看出，为了确定工具提示文本，渲染器被要求提供一个组件，并且该组件被要求提供它的工具提示文本。当然这仅适用于文本而不适用于例如图像

# linux - linux文件上的退格问题

> ID：10454309
> 
> 赞同：10
> 
> 时间：2012-05-04T18:34:13.717
> 
> 标签：linux, bash, editplus

我使用 EditPlus 编写 linux bash 程序。在我将文件移动到服务器时写入后，出现以下错误：

```
sleep: invalid time interval `2\r'
Try `sleep --help' for more information.

/usr/bin/program: line 9: $'\r': command not found
/usr/bin/program: line 10: $'}\r': command not found
/usr/bin/program: line 11: $'\r': command not found
/usr/bin/program: line 12: syntax error near unexpected token `$'{\r''
'usr/bin/program: line 12: `stop() { 
```

我也使用 dos2unix 解决了这个问题，但没有成功。我想知道有什么办法可以避免这种问题。它浪费了很多时间。有没有更好的编辑器或某种方法来解决这个问题？

编辑：

我解决这个问题的方法是我在 linux 中 vi 一个文件，然后从 windows 文件逐行复制到 linux 文件，然后它就可以工作了。这些是我的代码行：

line7:udevadm control --reload-rules sleep 2 echo echo $(date +"%b %e %T") `hostname`Program[$$]: Program Started | tee -a /var/log/messages echo } stop() {

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-05-04T18:44:06.347

您需要更改文件首选项：转到 Preferences -> Files 并将“Create new file as”更改为 UNIX。此外，您可能希望启用“检查无效 CR/LF，加载时为空字符”选项。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-05-04T18:57:33.573

对于已经生成的文件

```
cat OLDFILE | tr -d '\r' > NEWFILE 
```

应该有帮助。您不能只将输出重定向到输入：

```
cat FILE | tr -d '\r' > FILE 
```

因为这将在读取之前截断输入文件。

与类似程序相比，这不符合无用使用猫奖的条件，因为`tr`不接受文件名作为参数。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2019-09-10T18:16:03.600

在 CRLF 到 LF 的 VSCode / atom 中设置“行结束序列”并保存对我有用

# ios - ios比较来自json的布尔值

> ID：10454315
> 
> 赞同：3
> 
> 时间：2012-05-04T18:34:31.733
> 
> 标签：ios

我使用字典从 json 对象中获得了一个布尔值。在控制台，我可以看到 0 或 1。但我的比较总是返回 true。

```
BOOL *result =[dictionary valueForKey:@"result"];

        if (result == YES) {

            [parser release];
        }
        else {
            errorLbl.text = @"Login failed";
        } 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-04T18:38:16.477

您是否尝试在结尾处添加 boolValue `[dictionary valueForKey:@"result"]boolValue]`；

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-04T18:37:32.857

您需要转换字典中的值。您不能将其直接转换为`BOOL *`(`BOOL`指针)。

假设你`NSString*`从字典中得到一个，你可以这样做：

```
NSString *result = [dictionary valueForKey:@"result"];
if ([result boolValue]) {
    [parser release];
} else {
    errorLbl.text = @"Login failed";
} 
```

假设您可以将[`boolValue`消息](https://developer.apple.com/library/mac/#documentation/Cocoa/Reference/Foundation/Classes/NSString_Class/Reference/NSString.html)与您的协议一起使用。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-01-08T05:30:51.090

试试下面的代码，我得到了

```
BOOL success = [[jsonDict objectForKey:@"success"] boolValue];
if (success == YES){ //Do some stuff } else{ //Do some stuff } 
```

# python - 如何投影和重新采样网格以匹配另一个网格与 GDAL python？

> ID：10454316
> 
> 赞同：16
> 
> 时间：2012-05-04T18:34:32.437
> 
> 标签：python, gis, raster, gdal, osgeo

澄清：我不知何故遗漏了关键方面：不使用 os.system 或 subprocess - 只是 python API。

我正在尝试将 NOAA GTX 偏移网格的一部分转换为垂直基准面转换，而不是完全遵循如何在 GDAL 中使用 python 执行此操作。我想采用一个网格（在这种情况下是一个测深属性网格，但它可能是一个 geotif）并将其用作我想要做的模板。如果我能做到这一点，我有一种感觉，它将极大地帮助人们利用这种类型的数据。

这是我所拥有的绝对行不通的东西。当我在生成的目标数据集 (dst_ds) 上运行 gdalinfo 时，它与源网格 BAG 不匹配。

```
from osgeo import gdal, osr

bag = gdal.Open(bag_filename)
gtx = gdal.Open(gtx_filename)

bag_srs = osr.SpatialReference()
bag_srs.ImportFromWkt(bag.GetProjection())

vrt = gdal.AutoCreateWarpedVRT(gtx, None, bag_srs.ExportToWkt(), gdal.GRA_Bilinear,  0.125)

dst_ds = gdal.GetDriverByName('GTiff').Create(out_filename, bag.RasterXSize, bag.RasterYSize,
                                            1, gdalconst.GDT_Float32)
dst_ds.SetProjection(bag_srs.ExportToWkt())
dst_ds.SetGeoTransform(vrt.GetGeoTransform())

def warp_progress(pct, message, user_data):
  return 1

gdal.ReprojectImage(gtx, dst_ds, None, None, gdal.GRA_NearestNeighbour, 0, 0.125, warp_progress, None) 
```

示例文件（但它们重叠但处于不同投影中的任何两个网格都可以）：

*   [http://surveys.ngdc.noaa.gov/mgg/NOS/coast/F00001-F02000/F00574/BAG/F00574_MB_2m_MLLW_2of3.bag](http://surveys.ngdc.noaa.gov/mgg/NOS/coast/F00001-F02000/F00574/BAG/) _
*   [http://vdatum.noaa.gov/download/data/VDatum_National.zip](http://vdatum.noaa.gov/download/data/VDatum_National.zip) MENHMAgome01_8301/mllw.gtx

命令行相当于我正在尝试做的事情：

```
gdalwarp -tr 2 -2 -te 369179 4773093 372861 4775259 -of VRT -t_srs EPSG:2960 \
     MENHMAgome01_8301/mllw.gtx  mllw-2960-crop-resample.vrt
gdal_translate mllw-2960-crop-resample.{vrt,tif} 
```

* * *

## 回答 #1

> 赞同：29
> 
> 时间：2012-05-10T16:42:04.290

感谢杰米的回答。

```
#!/usr/bin/env python

from osgeo import gdal, gdalconst

# Source
src_filename = 'MENHMAgome01_8301/mllw.gtx'
src = gdal.Open(src_filename, gdalconst.GA_ReadOnly)
src_proj = src.GetProjection()

# We want a section of source that matches this:
match_filename = 'F00574_MB_2m_MLLW_2of3.bag'
match_ds = gdal.Open(match_filename, gdalconst.GA_ReadOnly)
match_proj = match_ds.GetProjection()
match_geotrans = match_ds.GetGeoTransform()
wide = match_ds.RasterXSize
high = match_ds.RasterYSize

# Output / destination
dst_filename = 'F00574_MB_2m_MLLW_2of3_mllw_offset.tif'
dst = gdal.GetDriverByName('GTiff').Create(dst_filename, wide, high, 1, gdalconst.GDT_Float32)
dst.SetGeoTransform( match_geotrans )
dst.SetProjection( match_proj)

# Do the work
gdal.ReprojectImage(src, dst, src_proj, match_proj, gdalconst.GRA_Bilinear)

del dst # Flush 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-09T15:36:12.183

如果我正确理解了这个问题，您可以通过运行 gdalwarp 和 gdal_translate 作为子进程来实现您的目标。只需组合您的选项，然后执行以下操作：

```
import subprocess

param = ['gdalwarp',option1,option2...]
cmd = ' '.join(param)
process = subprocess.Popen(cmd, shell=True, stdout=subprocess.PIPE, stderr=subprocess.PIPE)
stdout = ''.join(process.stdout.readlines())
stderr = ''.join(process.stderr.readlines())

if len(stderr) > 0:
    raise IOError(stderr) 
```

它可能不是最优雅的解决方案，但它会完成工作。运行后，只需使用 gdal 将数据加载到 numpy 中，然后继续。

# c++ - 大对象的序列化

> ID：10454318
> 
> 赞同：1
> 
> 时间：2012-05-04T18:34:37.103
> 
> 标签：c++, serialization, boost, boost-serialization, istringstream

我正在使用 C++ 中的 Boost::Serialization 库。当我想恢复对象时，我使用下面的代码：

```
// ostr is of type std::ostringstream

std::vector<Certificate *> newCRL;
{
    std::istringstream ifs(ostr.str());
    boost::archive::text_iarchive ia(ifs);
    ia >> newCRL;
} 
```

如果 ostr 长度短，我可以成功恢复原始对象，但我遇到的问题是 ostr 长。如果 ostr 很大，运行时会抛出以下异常：

```
std::length_error: basic_string::resize 
```

我认为`std::istringstream ifs(ostr.str());`是这个异常的来源。有什么解决方法可以用来重建大物体吗？

# php - 在 PHP 中使用 fopen 和 fwrite 时的资源 id #7

> ID：10454320
> 
> 赞同：0
> 
> 时间：2012-05-04T18:34:44.407
> 
> 标签：php, mysql, fopen, fwrite

我正在尝试在 PHP 中创建一个下载链接，以便您可以下载表格中的信息。我刚开始写它并遇到了障碍。这是我到目前为止所拥有的：

```
 <?php
 $sql = "SELECT * FROM " . $survey . ";";
 $result = mysql_query($sql)
    or die(mysql_error());
 $row = mysql_fetch_assoc($result);

 $something = "This is text";
 $myFile = "data.txt";
 $fh = fopen($myFile, 'w') or die("can't open file");

 $download_data = "";
 foreach ($row as $k=>$v){
        $download_data .= $k . "=" . $v . "\n";
 }
 fwrite($fh, $download_data);
 fclose($fh);

 echo $download_data;

 ?>
 <a href="data.txt">Download </a> 
```

它只是应该显示类似 Code = 1 Name = John 等的内容。当我打开 txt 文件时，它只是显示 Resource id #7。奇怪的是，当我回显 $download_data 时，它在网页中看起来正确。为了将整个字符串放入文本文件中，我与 fwrite 有什么特别的关系吗

（注意：我同时使用了 mysql_fetch_array 和 mysql_fetch_assoc 并且都具有相同的结果。另外，如果我只是声明一个变量，如 $test = "this is a test"; 它可以工作）。

编辑：我尝试注释掉脚本中的所有其他代码，我得到了相同的结果。打印 $download_data 显示正确的结果，但文本文件仍然只显示资源 id #7。我什至尝试过删除 txt 文件，当它重新创建时，它会做同样的事情。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-04T19:40:31.993

您几乎可以肯定不会用您的示例代码向我们展示全貌。

您可能会将以下内容之一写入文件：

1.  文件句柄，`$fh`
2.  从返回的结果`mysql_query()`

检查你没有混淆`$result`和`$row`。或者更好的是，发布您的所有代码。

# profile - 多个应用程序的一个配置文件？

> ID：10454324
> 
> 赞同：6
> 
> 时间：2012-05-04T18:35:07.413
> 
> 标签：profile

我真的对 ios 配置文件感到困惑。我可以为多个应用程序使用一个开发配置文件吗？分发配置文件的相同问题。

谢谢你的帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-04T18:38:53.307

是的，您可以为多个应用程序使用相同的证书。

它可能看起来很复杂，但一旦你看它，它并没有那么糟糕。这是细分：

开发配置文件让您有机会测试您创建的（任何）应用程序，直到您尝试将其推送到 Apple。当您这样做时，分发配置文件就会发挥作用。从本质上讲，它将您制作的任何应用程序与您的 App Store 店面连接起来。

# javascript - 关于 steriotab 系统的问题

> ID：10454331
> 
> 赞同：0
> 
> 时间：2012-05-04T18:35:38.553
> 
> 标签：javascript, tabs, prototypejs

我用prototype.js库玩了一个steriotab系统，一切正常，除了steriotabs容器下的下一个DIV在转到下一个选项卡时显示得像一个闪光..我知道它有点难以理解..在这里你可以在他们的网站上看到它[http://stereointeractive.com/blog/code/prototype-tabs/](http://stereointeractive.com/blog/code/prototype-tabs/)

您可以通过连续更改四个选项卡（功能、设置、配置、下载）三四次来看到这一点。评论部分将在导航选项卡（功能、设置、配置、下载）下方快速显示。

我认为问题在于当它进入下一个选项卡时，当前选项卡是 display:none 并且在此期间当然没有任何内容（1 或 2 秒），因此下一个 html 代码块将出现在导航下方的顶部。

这个javascript可能会导致问题..

```
activate: function(tab) {
    var tabName = tab.id.replace(this.options.ids.tab,'');
    this.currentPanel = this.options.ids.panel+tabName;
    if (this.showPanel == this.currentPanel) {
      return false;
    }

    if (this.showPanel) {
      if (this.options.effects) {
        new Effect.Fade(this.showPanel, {queue: 'front'});
      } else {
        $(this.currentPanel).hide();
      }
    }

    if (this.options.effects) {
      new Effect.Appear(this.currentPanel, {queue: 'end'});
    } else {
      $(this.showPanel).show();
    }

    this.tabs.invoke('removeClassName', this.options.classNames.tabActive);
    tab.addClassName(this.options.classNames.tabActive);
    this.showPanel = this.currentPanel;
  } 
```

你们有什么想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-05T18:26:04.793

您的怀疑是正确的，您获得闪存的原因是几毫秒，那里没有容器阻止对象下方的内容。您可以考虑的一种选择是在淡化容器的同时将其向上滑动（查看脚本中的[并行效果](http://madrobby.github.com/scriptaculous/effect-parallel/)），这样它就不会随着内容的消失而变得不和谐。

# php - 引用当前路径的父目录中的图像

> ID：10454334
> 
> 赞同：0
> 
> 时间：2012-05-04T18:35:51.437
> 
> 标签：php, jquery

我在 images\a.jpg 中有图像现在我的脚本在 js\a.js 图像中，并且 js 目录在文档根目录 www 目录下

在脚本 a.js 我有：

```
 var provider_img = $(this).attr('src');  \\value of provider_img = images\a.jpg
  title: '<img src=..\provider_img />', 
```

但图像没有显示在标题框中。请帮帮我

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-04T18:37:01.203

路径应该是：

```
images/a.jpg 
```

不是

```
images\a.jpg 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-04T18:39:04.463

尝试如下，

```
title: '<img src=../' + provider_img + '/>', 
```

`provider_img`是一个 var 并且在标题中，如果您希望 var 替换该值，则应将其保留在引号之外。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-05-04T18:41:10.230

你是说你有：

```
Document root
 --> /js/
 --> /images/ 
```

如果是这样，不要尝试做相对路径，而是做一个绝对路径，并参考`/images/a.jpg`.

如果不是，并且您正在尝试做其他事情，则可能需要进一步澄清。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-05-04T18:40:36.267

mgraph 是对的，所有 url 都使用 UNIX 路径分隔符。由于您使用的是反斜杠，我假设您正在使用 Windows 机器。如果您不养成转义反斜杠的习惯，Windows 路径分隔符将来可能会让您头疼：

```
..\newDir === ..[new line]ewDir
..\\newDir === ..\newDir as you want it expected 
```

您可能还想将变量值连接成一个字符串，而不是使用变量名作为字符串：`<img src="/../'+imgVar+'"/>`.

**编辑**

Brian Warshaw 是对的，如果您想要的是图像的正确路径，那么您的路径应该从与 js src 路径相同的基础开始。如果你的脚本标签有一个类似的 src 属性`/js/script`，图片标签应该有一个匹配的路径：`/images/picture.jpg`。您的脚本不会查找该文件，因此路径基础应该是文档根目录，而不是脚本位置。*（很明显的布赖恩，归功于他）*

# javascript - node.js 和 mongo 模式，正在寻找一些介绍材料，也许是教程

> ID：10454339
> 
> 赞同：0
> 
> 时间：2012-05-04T18:36:07.503
> 
> 标签：javascript, html, node.js, mongodb, webgl

嘿，我正在创业，我必须使用 Node.Js 和 Mongo 构建一个简单的数据库（前端是 HTML5/webGL）。基本上我们已经安排了一些投资者，但在我们扣动扳机之前，我想向他们展示一些服务器交互。我做平面设计/业务方面，我的合作伙伴是技术方面，但因为我们都是兼职时间有限，我需要尽快后端。过去 24 小时我已经非常熟悉 Node.JS 和 Mongo 并完成了一些教程，我现在基本上需要将它们组合在一起并开发模式并实际开始构建我的数据库（如果术语不正确，请原谅，我'我是新的）。

我正在寻找这部分的一些资源/介绍/教程/方向，我想知道你们是否有一些建议、链接、youtube 等。任何帮助表示赞赏。谢谢。

这基本上是我想要完成的（也许有帮助）：

客户端 -> 服务器

```
{
    "request": "listProjectsQuery",
    "uuid": "fdsldkjfaldjshf"
} 
```

服务器 -> 客户端

```
{
    "request": "listProjectsResponse",
    "projects": [
        "projID001",
        "projID001",
        "projID001",
        "projID001"
    ]
} 
```

客户端 -> 服务器

```
{
    "request": "projectQuery",
    "uuid": "123oiu4y1o23iuy4",
    "projectID": "projID001"
} 
```

服务器 <-> 客户端

```
{
    "request": "projectData",
    "uuid": "123oiu4y1o23iuy4",
    "projectID": "projID001",
    "name": "projName",
    "bricks": [{

        "xPos": 123,
        "yPos": 123,
        "width": 123,
        "height": 123,
        "brickName": "soundCloud",
        "url": "http://www.purple.com",
    "zPos":1
    },

{

        "xPos": 123,
        "yPos": 123,
        "width": 123,
        "height": 123,
        "brickName": "soundCloud",
        "url": "http://www.purple.com",
    "zPos":0
    }]
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-04T18:54:24.107

如果这是您第一次构建 node.js / mongodb 服务器，我强烈建议您查看[express.js](http://expressjs.com/)和[mongoose.js](http://mongoosejs.com/)。

一般来说，我发现最好的学习方法之一是查看 GitHub 上的示例项目。只需四处寻找位于[此处](https://github.com/jamescarr/sample-node-app/tree/master/mongodb-examples)的示例项目，该项目似乎使用了大多数最佳实践，并且应该为您提供如何开始的好主意。

# php - 口音在工作台中未正确显示，但在 php 网站中正常

> ID：10454340
> 
> 赞同：1
> 
> 时间：2012-05-04T18:36:10.793
> 
> 标签：php, mysql, encoding, diacritics

我正在使用 utf8 mysql 数据库和带有 php 的 utf8 环境。
使用 php 插入一些带有重音符号的文本，然后通过 php 选择它们。重音正确地打印在屏幕上。
我的问题是它们在工作台中没有正确显示，当我手动插入一些值时，当使用 php.ini 选择这些值时，这些值没有正确打印在屏幕上。

任何帮助表示赞赏。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-05T20:50:16.813

请记住告诉数据库连接您正在从 PHP 端发送 UTF-8 字符串：

```
mysql_set_charset('utf8'); 
```

如果您将 UTF-8 字节作为 ISO-8859-1 字节插入数据库，并以相同的方式检索它们，我怀疑您目前正在这样做，您的应用程序会正常，尽管它们从数据库的角度来看是错误的观点。这样做会丢失非 ASCII 字符的排序规则，因此特别是区分大小写的比较可能会意外失败。

# c++ - 将自定义 Apache 2.4 模块与 Linux 上的 httpd/apr 库静态链接时出错

> ID：10454343
> 
> 赞同：0
> 
> 时间：2012-05-04T18:36:31.450
> 
> 标签：c++, linux, apache2, g++, apache-modules

我正在尝试将我的模块移动到 Linux Apache 2.4，但我遇到了链接问题。在 Windows 上，一个 libhttpd.lib 可用于链接以及 apr/apr-util 库。lib* httpd apr 和 aprutil 在我的 Windows 安装中都是静态链接的。我想为 Linux 安装做同样的事情。

根据可用的有限文档，我无法使用 APXS，因为我的模块是用 C++ 编写的。

我很难在 Linux 上找到服务器的存档文件。我需要链接什么才能使我的模块工作？

源能够在 Windows 主机上链接和执行。

示例错误：

```
 /home/ec2-user/httpd-2.4.2/srclib/apr/locks/unix/proc_mutex.c:367: undefined reference to `pthread_mutexattr_init'
    /home/ec2-user/httpd-2.4.2/srclib/apr/locks/unix/proc_mutex.c:374: undefined reference to `pthread_mutexattr_setpshared'
    /home/ec2-user/httpd-2.4.2/srclib/apr/locks/unix/proc_mutex.c:384: undefined reference to `pthread_mutexattr_setrobust_np'
    /home/ec2-user/httpd-2.4.2/srclib/apr/locks/unix/proc_mutex.c:393: undefined reference to `pthread_mutexattr_setprotocol'
    /home/ec2-user/httpd-2.4.2/srclib/apr/locks/unix/proc_mutex.c:414: undefined reference to `pthread_mutexattr_destroy'
    /home/ec2-user/httpd-2.4.2/srclib/apr/locks/unix/proc_mutex.c:408: undefined reference to `pthread_mutexattr_destroy' 
```

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-05T12:58:12.083

所以任何其他搜索这个的人都可能得到答案。

1.  从 apache httpd 站点下载任何 Apache 版本（高于 2.2）源到主目录
2.  打开包装
3.  配置所有内容或只是不指定任何选项（您可以稍后重新配置以进行实际构建）
4.  在源代码上执行 make （不要执行 make install ！只需要目标文件）
5.  创建一个目录来保存您自己的模块的库和源代码。在您的主目录（或任何您想要的）的顶层说“foo”
6.  假设主目录：执行 (find ~/httpdX.X -name '*.o' -exec cp {} ~/foo \;) 命令在括号中。这会将所有已编译的对象复制到 foo。
7.  执行 (find ~/foo -name '*.o' -exec ar r libhttpd.a {} \;) 这将为您创建代码存档。
8.  然后只需在 gcc 或 g++ 的编译定义中包含这些开关（-Wl，-Bstatic -lhttpd -lpcre -lpcreposix -lapr-1 -laprutil-1 -Wl，-Bdynamic -pthread -ldl -lcrypt）
9.  如果您愿意，可以通过在 *.o 文件上运行 rm 来清理您的 foo 目录

您不需要像我需要的那样进行静态编译，但我希望能够将我的模块移动到任何 Linux 主机上，而不用担心必要的组件。Apache 需要 pcre（正则表达式）、apr（所有库）、线程（proc/thread mutex）、dl（动态加载）和 crypt（apr 密码）才能工作。由于 thread、dl 和 crypt 很可能已经在机器上，所以我选择不静态编译它们。

狩猎愉快。我希望我在 3 天内永无止境的故事对其他人有所帮助！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-04T18:42:08.190

这些错误意味着你没有添加`-pthread`到你的编译命令行，所以你没有得到`pthread`链接的库。

（注意：它是`-pthread`，不是`-lpthread`- 它不仅仅是一个链接器选项。）

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-09T02:43:47.137

对于那些用 C++ 构建 Apache 模块并想要动态链接的人，这是我用来成功构建模块的 g++ 命令行；在 Apache 2.2.22/CentOS 6.2 上进行了简要测试。

```
g++ [my files].cpp  -I/httpd/include/ -I/httpd/srclib/apr/include/ 
    -I/httpd/srclib/apr-util/include/ -I/usr/include/ -I/usr/include/apr-1/ 
    -I/httpd/os/unix/ -shared -fPIC -o mod_mymodule.so 
```

我是 Apache/linux 编程新手，无法在其他任何地方找到此信息；感谢 OP 的解决方案，经过几天的挫折，我能够完成这项工作。

这里还有一个链接，它帮助解释了当找不到 httpd 服务器核心代码（Windows 上的 libhttpd.lib）中包含的 apache 函数时如何解决“未解决的引用”链接器问题——这在 * 中不存在nix，除非您像 OP 那样手动制作。基本上，答案是使用 -shared 标志，以便在运行时自动解析这些引用。 [http://www.yolinux.com/TUTORIALS/LibraryArchives-StaticAndDynamic.html](http://www.yolinux.com/TUTORIALS/LibraryArchives-StaticAndDynamic.html)

不要忘记模块代码中的“extern C”，并在构建 HTTPD 时构建 DSO 支持。

希望这对其他人有帮助！

# python - Python 源文件中的计数语句

> ID：10454344
> 
> 赞同：1
> 
> 时间：2012-05-04T18:36:50.830
> 
> 标签：python

由于此处未讨论的原因，代码行数对任何事情都不好衡量。但是有没有一种巧妙的方法来计算 Python 源代码文件中的语句？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-04T22:34:26.173

pylint 直接在其输出报告中给出：

```
 pylint main.py 

  ...

  Report
  ======
  145 statements analysed. 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-04T19:52:08.307

为了计算物理代码行（而不是本地代码行），我发现[SLOCCount](http://www.dwheeler.com/sloccount/)给出了合理的数字。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-04T22:10:32.570

使用`ast`从 Python 代码解析和构造语法树的模块。您将能够根据该树和节点应用您想要的自定义计数算法。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2019-09-14T22:25:36.237

虽然这是一个旧帖子。这是一段代码，它以与 PyLint 相同的方式计算 python 源文件中的语句。

```
from astroid import MANAGER
# Tested with astroid 2.3.0.dev0

class ASTWalker:
    """
    Class to walk over the Astroid nodes
    """
    def __init__(self):
        self.nbstatements = 0

    def walk(self, astroid_node):
        """
        Recurse in the astroid node children and count the statements.
        """
        if astroid_node.is_statement:
            self.nbstatements += 1

        # recurse on children
        for child in astroid_node.get_children():
            self.walk(child)

walker = ASTWalker()
ast_node = MANAGER.ast_from_file("/my/file/name", source=True)
walker.walk(ast_node)

print(walker.nbstatements) 
```

# java - 使用“for”循环时出现“找不到符号”错误

> ID：10454345
> 
> 赞同：3
> 
> 时间：2012-05-04T18:36:51.047
> 
> 标签：java

我是一个完整的 Java 初学者，并且无法理解如何在类和方法之间传递对象。我已经取得了一些进展，但是当我尝试在 for 循环中创建扑克牌时，我的应用程序现在失败了。如果我删除循环它工作正常。这是包含错误的类的第一部分：

```
public class Testing
{
    public static void main(String[] args)
    {

   int Deal = 1;

   for(int Hand = 0; Hand < Deal; ++Hand)
   {
     //instantiate and derive values for Player
     Card card1 = new Card();
     card1.setSuit();  //assign card 1's suit
     card1.setValue(); //asign card 1's value

     //instantiate and derive values for Computer
     Card card2 = new Card();
     card2.setSuit();  //assign card 2's suit
     card2.setValue(); //assign card 2's suit

     //compare the two cards and make sure they are different
     cardCompare(card1,card2);
   }

   //output the two cards to the screen
   output(card1,card2);

} 
```

这是我得到的错误：

```
Testing.java:26: error: cannot find symbol
   output(card1,card2);
          ^
  symbol:   variable card1
  location: class Testing

Testing.java:26: error: cannot find symbol
   output(card1,card2);
                ^
  symbol:   variable card2
  location: class Testing
2 errors 
```

由于如果我删除 for 循环代码可以工作，我假设名称 card1 和 card2 在循环外不可见？如果我想创建 10 或 20 张卡片，我会想在一个循环中完成，所以我一定会遗漏一些关于实例化新对象和在程序的其他地方使用它们的东西。

谢谢你的帮助。

**更新：感谢最初的反馈。我现在看到，如果我将我的实例化语句移到 for 循环之外，理论上我可以使用循环一遍又一遍地为这些对象分配新值，这就是我完成这个特定任务所需要的全部。

不过我仍然很好奇，是否不可能在循环内实例化新对象，但仍然在循环外使用它们？似乎这必须以某种方式成为可能。

```
public class Testing
   {
    public static void main(String[] args)
   {

int Deal = 1;

   //instantiate and derive values for Player
     Card card1 = new Card();

      //instantiate and derive values for Computer
     Card card2 = new Card();

   for(int Hand = 0; Hand < Deal; ++Hand)
   {
     card1.setSuit();  //assign card 1's suit
     card1.setValue(); //asign card 1's value

     card2.setSuit();  //assign card 2's suit
     card2.setValue(); //assign card 2's value

    //compare the two cards and make sure they are different
     cardCompare(card1,card2);
   }

   //output the two cards to the screen
   output(card1,card2);

} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-04T18:39:43.747

card1 和 card 变量在 for 循环内声明，因此仅在循环内可见。要在循环之外使用它，您必须在循环*之前*声明它。请阅读 Java*范围规则*。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-04T18:40:15.460

`card1`和都`card2`在`for`循环范围内，而不是`main()`. 将您的初始化移到`for`.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-04T20:35:03.780

好吧，就目前而言，它将继续尝试覆盖 card1 和 card2 ，因为您将同时声明和初始化它们的“交易”时间。此外，更重要的是，它们将超出范围。相反，事先声明它并且只在循环内*初始化它们。*

您可能想要的是：

```
public class Testing
   {
    public static void main(String[] args)
   {

 int Deal = 1;

 ArrayList<Card> playerCards = new ArrayList<Card>();
 ArrayList<Card> computerCards = new ArrayList<Card>();

  //instantiate and derive values for Player
 Card card1;

 //instantiate and derive values for Computer
 Card card2;

 for(int Hand = 0; Hand < Deal; ++Hand)
 {
    card1 = new Card();
    card1.setSuit();  //assign card 1's suit
    card1.setValue(); //asign card 1's value

    card2 = new Card();
    card2.setSuit();  //assign card 2's suit
    card2.setValue(); //assign card 2's value

   //compare the two cards and make sure they are different
   cardCompare(card1,card2);

   playerCards.Add(card1);
   computerCards.Add(card2); 
```

}

```
 //output the two cards to the screen

  output(card1,card2); 
```

}

没有测试过，但它应该可以工作。

您还需要重新考虑您对输出方法的使用。由于您将每人拥有约 20 张卡片，您认为*何时需要将它们展示给用户？*目前，您将它放在 for 循环之外，因此它只会显示分配给每个循环的 LAST 值。如果您想向他们展示他们获得的每张卡片，请将输出调用放在 for 循环中，并且可能使用 Thread.Sleep() 将程序暂停半秒左右，以便他们可以看到他们获得的每张卡片。那，或者写一个接受卡片数组列表的输出过载，并同时打印所有卡片。再一次，如果你需要帮助，问我。

顺便说一句，我不确定 cardcompare() 在幕后到底在做什么，但你可能想让它返回一个表示它们是否不同的布尔值。就像是：

```
bool areCardsDistinct = cardcompare(card1,card2); 
```

这样，您可以使用结果来决定是否再次获得随机新卡

# windows - Ant exec 作为 Windows 上的不同用户

> ID：10454347
> 
> 赞同：0
> 
> 时间：2012-05-04T18:36:59.067
> 
> 标签：windows, ant

我想在**Windows**的 ant 中以不同用户的身份运行可执行文件。我正在考虑调用[PsExec](http://technet.microsoft.com/en-us/sysinternals/bb897553)在同一台机器上运行并传入用户名和密码。有一个更好的方法吗？到目前为止，我找到的答案是在 Linux/Unix 上运行 ant。

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-04T18:39:44.243

您可以使用该[`runas`](http://technet.microsoft.com/en-us/library/bb490994.aspx)实用程序以其他用户身份运行可执行文件。

> 允许用户以不同于用户当前登录所提供的权限运行特定工具和程序。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-04T18:57:49.567

在 Windows 7 之前的 Windows 版本中，您应该能够简单地右键单击可执行文件并选择“运行方式”。然后，您可以从可用用户的下拉列表中选择用户。在 Windows 7 中，此选项已替换为“以管理员身份运行”选项。

来自 Microsoft 的 windows 页面：

[http://windows.microsoft.com/en-us/windows-vista/What-happened-to-the-Run-as-command](http://windows.microsoft.com/en-us/windows-vista/What-happened-to-the-Run-as-command)

如果您以标准用户身份登录，您还可以使用以管理员身份运行命令以其他用户身份运行程序，即使该用户没有管理员帐户也是如此。为此，请单击以管理员身份运行，然后选择用户帐户。如果您以管理员身份登录，如果您想以其他用户身份运行程序，则需要在命令提示符窗口中键入 runas.exe /user name。

# c++ - 套接字不能用作函数

> ID：10454356
> 
> 赞同：0
> 
> 时间：2012-05-04T18:37:32.547
> 
> 标签：c++, udp, winsock2

嗨，我做过 Java 和 C#，最近在 Linux 环境中用 C/C++ 编写了一个模块。我决定在 Windows 中用 C++ 制作一个简单的 UDP 服务器，我也是新手，但在编码方面不是一个完整的新手。我看过一些例子，除了这一行之外，这一切似乎都有效：

```
SOCKET socket = socket(AF_INET, SOCK_DGRAM, 0); 
```

当我在 Netbeans 中编译它时，会出现以下错误消息：

```
classUDPServer.cpp: In constructor 'UDPServer::UDPServer()':
classUDPServer.cpp:35: error: '((UDPServer*)this)->UDPServer::socket' cannot be used as a function
    make[2]: *** [build/Debug/MinGW-Windows/classUDPServer.o] Error 1
    make[1]: *** [.build-conf] Error 2
    make: *** [.build-impl] Error 2 
```

我同时包含了 winsock2.h 和 iostream。

谁能帮我解决这个错误？

提前致谢！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-04T18:39:31.827

不要以与函数相同的方式命名变量。

```
SOCKET my_socket = socket(AF_INET, SOCK_DGRAM, 0); 
```

此外，正如@chris 指出的那样，您可以使用范围解析运算符（::) 以便`socket`在全局命名空间中查找该函数：

```
SOCKET socket = ::socket(AF_INET, SOCK_DGRAM, 0); 
```

# java - crontab 运行 jar 文件时出错

> ID：10454357
> 
> 赞同：0
> 
> 时间：2012-05-04T18:37:33.040
> 
> 标签：java, bash, jar, cron

我正在运行带有开放 jdk 和 crontab 的 Ubuntu 10.10。我制作了一个简洁的 Java 应用程序，它做了一些很酷的事情并将其导出为可运行的 jar 文件。我可以从命令行运行它就好了，但我需要每天运行一次文件的东西。所以我写了一个 cron 作业来运行一个实际上会调用 jar 文件的 shell 脚本。shell 脚本在单独运行时工作正常，它看起来像这样：

```
#!/bin/sh
/usr/bin/java -jar /root/proj/CoolStuff.jar 
```

完美运行。所以我将它添加到 crontab 中：

```
23 14 * * * /root/proj/runScript.sh > /root/proj/log.txt 2>&1 
```

这并不完美。事实上，它并没有运行。log.txt 会出来说“错误”。很不起眼，对吧？我检查了我的环境变量，没有什么特别的。还有什么我可能会丢失的吗？关于从这里去哪里的任何想法？有什么方法可以让我每天轻松地运行这个脚本？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-04T18:45:33.803

`/usr/bin/java ..`通过注释掉当前的并单独插入`set`一行来查看 crontab 的环境是什么样的。

现在从您的命令行执行`set > tmpEnvVarList.txt`并与您在 log.txt 中看到的内容进行比较。

几乎可以肯定，您的 .profile 或 .bash_rc （或其他）正在设置您 crontab 无法使用的环境变量。您需要在`. .profile`脚本中添加等。

cbO的想法也不错。

我希望这有帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-04T18:41:56.023

检查该文件的执行权限。

cron 以不同的权限运行，而不是您登录时获得的权限。

你也尝试访问/root。尝试将您的脚本重新定位到另一个“非根”目录。

# python - 带有正则表达式的 Python lambda

> ID：10454359
> 
> 赞同：7
> 
> 时间：2012-05-04T18:37:37.663
> 
> 标签：python, regex, lambda, python-2.7

在将 re 的 re.sub() 部分用于 python 时，如果我没记错的话，一个函数可以用于 sub。据我所知，它在匹配中传递给传递的任何函数，例如：

```
r = re.compile(r'([A-Za-z]')
r.sub(function,string) 
```

除了调用方法的 lambda 之外，有没有更聪明的方法让它传入第二个参数？

```
r.sub(lambda x: function(x,arg),string) 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-05-04T18:41:43.010

您可以使用`functools.partial`：

```
>>> from functools import partial
>>> def foo(x, y):
...     print x+y
... 
>>> partial(foo, y=3)
<functools.partial object at 0xb7209f54>
>>> f = partial(foo, y=3)
>>> f(2)
5 
```

在您的示例中：

```
def function(x, y):
     pass # ...
r.sub(functools.partial(function, y=arg),string) 
```

和正则表达式的真正用途：

```
>>> s = "the quick brown fox jumps over the lazy dog"
>>> def capitalize_long(match, length):
...     word = match.group(0)
...     return word.capitalize() if len(word) > length else word
... 
>>> r = re.compile('\w+')
>>> r.sub(partial(capitalize_long, length=3), s)
'the Quick Brown fox Jumps Over the Lazy dog' 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2022-03-03T00:23:52.813

不使用局部：

```
import re

a = 'the quick brown fox jumped over the python'
print re.sub("(\w+)", 
  lambda x: x.group(1).capitalize(),
  a) 
```

Python 中的 Lambda 很好地提供了组的内联修改。

来自 Perl，这就是我的想法：

```
$a = 'the quick brown fox jumped over the python';
$a =~ s/(\w)(\w+)/uc($1).$2/ge;
print "$a\n"; 
```

# php - 来自 Javascript 的查询字符串参数不能用于处理 PHP 脚本

> ID：10454362
> 
> 赞同：0
> 
> 时间：2012-05-04T18:37:52.467
> 
> 标签：php, javascript, jquery, mysql, ajax

我想用来自实际 MySQL 数据库表的值填充我的网页上的[jQWidgets 列表框控件（当页面完成加载和呈现时）。](http://www.jqwidgets.com/listbox-with-checkboxes/)

**部分解决方案：** [这里](http://www.jqwidgets.com/populate-a-listbox-with-data-from-mysql-database-using-php/)

**新问题：** 我已经更新了源代码，如果我硬编码 SQL 字符串 - 列表框会被填充。但我想制作一个小的 JS 函数 - popList(field, table) - 当您想要在页面上生成一个带有 MySQL 数据库值的 jQWidgets 列表框时，可以调用它。

**问题**是 - 由于某种原因，在执行 PHP 脚本时`$field`and`$table`是空的，并且我收到`You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'FROM' at line 1`错误。是什么赋予了？

**页面**：

```
 <div id="ListBox">
                <script type="text/javascript">
                popList("name", "categories");
            </script>
            </div> 
```

**弹出列表（***字段*，*值***）**：

```
 function popList(field, table) {
    $.ajax({
        type: "GET",
        url: 'getListOfValues.php',
        data: 'field='+escape(field)+'&table='+escape(table),
        dataType: 'json',
        success: function(response) {
            var source = $.parseJSON(response);
            $("#ListBox").jqxListBox({ source: source, checkboxes: true, width: '400px', height: '150px', theme: 'summer'});
        },
        error: function() {
            alert('sources unavailable');
        }
    });
} 
```

**getListOfValues.php**：

```
 <?php
    require "dbinfo.php";

    // Opens a connection to a MySQL server
    $connection=mysql_connect($host, $username, $password);
    if (!$connection) {
        die('Not connected : ' . mysql_error());
    }

    // Set the active MySQL database
    $db_selected = mysql_select_db($database, $connection);
    if (!$db_selected) {
        die ('Can\'t use db : ' . mysql_error());
    }

    $field = $_GET["field"];
    $table = $_GET["table"];

    $field = mysql_real_escape_string($field);
    $table = mysql_real_escape_string($table);

    $qryString = "SELECT " . $field . " FROM " . $table;

    $qryResult = mysql_query($qryString) or die(mysql_error());

    $source = array();

    while ($row = mysql_fetch_array($qryResult)){
        array_push($source, $row[$field]);
    }

    mysql_close($connection);

    echo json_encode($source);
?> 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-04T19:33:27.160

好的，你有一些东西在这里。首先，在执行 ajaxRequest 时需要一个回调函数。（我稍后会解释为什么。）所以在你的 ajaxReqest.send(null); 之前添加以下行

```
ajaxRequest.onreadystatechange = processAjaxResponse; 
```

然后您需要添加将被调用的 processAjaxResponse 函数。

```
function processAjaxResponse() {
    if (ajaxRequest.readySTate == 4) {
        var response = ajaxRequest.responseText;
        //do something with the response
        //if you want to decode the JSON returned from PHP use this line
        var arr = eval(response);
    }
} 
```

好的，现在您的 PHP 端的问题是您使用的是 return 方法。相反，您希望 PHP 打印或回显输出。这样想吧。您执行的每个 ajax 调用就像一个不可见的浏览器。您的 PHP 脚本需要在屏幕上打印一些内容，以便不可见的浏览器抓取和使用。

在这种特定情况下，您尝试将数组从 PHP 传递回 JS，因此 json_encode 是您的朋友。将您的退货行更改为以下内容：

```
print json_encode($listOfReturnedValues); 
```

如果您有任何问题或需要任何帮助，请告诉我。顺便说一句，我真的建议使用 jQuery 之类的东西来执行 ajax 调用并解析响应。它不仅可以确保 ajax 调用在每个浏览器中都兼容，它还可以自动将 JSON 响应解析为数组/对象/任何适合您的内容。这是你的 popList 函数在 jQuery 中的样子（注意：你不需要上面的 processAjaxResponse 函数）

```
function popList(field,table) {
    $.ajax({
            type: "GET",
            url: 'getListofValues.php',
            data: 'field='+escape(field)+'&table='+escape(table),
            dataType: "json",
            success: function(response) {
                //the response variable here would have your array automatically decoded
            }
        });
} 
```

它更清洁，更易于维护。我不得不回到一些旧代码来记住我以前是怎么做的；）

祝你好运！

# objective-c - 如何将富文本添加到 CoreData 中然后打印？

> ID：10454364
> 
> 赞同：1
> 
> 时间：2012-05-04T18:38:03.650
> 
> 标签：objective-c, xcode

我想将富文本保存到 CoreData，然后打印出来。

我想要什么样的文字？-> 1\. 字体颜色 2\. 粗体 3\. 下划线 3\. 链接 4\. 字体大小

我怎样才能做到这一点？

PS 在“网络世界”中您输入“<strong>bold text</strong> 等”。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-04T19:05:22.867

这是一个非常简单的例子。在您的情况下，您只需将 html 字符串存储到您的核心数据模型中，然后像下面那样显示它。

```
 #import "ViewController.h"

@implementation ViewController

#pragma mark - View lifecycle

- (void)viewDidLoad{
    [super viewDidLoad];
    UIWebView *webView = [[UIWebView alloc] initWithFrame:self.view.bounds];
    [self.view addSubview:webView];
    NSString *htmlRichText = @"<html><body><p><strong>HEY</strong> here's some text</p></body></html>";
    [webView loadHTMLString:htmlRichText baseURL:nil];

}

@end 
```

# django-haystack - Haystack 查询集包含 None 元素

> ID：10454367
> 
> 赞同：8
> 
> 时间：2012-05-04T18:38:28.583
> 
> 标签：django-haystack

我正在使用 Haystack 进行搜索，返回的结果 SearchQuerySet 包含 None 元素：

```
>> SearchQuerySet().models(Question, Document, Idea)
>> [<SearchResult: idea.idea (pk=3875)>, None, None, None] 
```

运行rebuild_index 没有帮助。如果我从第一行删除 .models() 调用，问题就会消失。我可以从结果中过滤掉 None 元素，但我想知道这是否是预期的行为？

我正在使用 Django 1.4、Whoosh 和 Haystack 2.0.0-beta

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-05T12:02:38.060

当 haystack 索引在数据库中有没有相应记录的记录时，我遇到了这个问题。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2015-12-14T17:22:33.823

不，这绝对不是预期的行为，正如我所见，它似乎与 Whoosh 中的设计决策有关。而且，截至 2015 年 12 月，这似乎仍然是一个问题，正如可以在[此处](https://github.com/django-haystack/django-haystack/issues/1171)看到的那样。此外，我可以使用我的设置（django 1.8.5、haystack 2.4.1、Whoosh 2.7.0）重现它——这就是我来到这里的原因。

对我有用的快速而肮脏的解决方案：在索引上定义一个新字段（类型/模型/番茄），为每个模型设置相同的字段，然后过滤该值：

`.filter(type='my_modelname')`

代替

`.models(MyModel)`.

我不知道（尚）这是如何扩展的，但似乎工作正常。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2015-06-20T02:50:10.180

使用 Whoosh 时遇到了同样的问题，安装了 Elasticsearch 并且`None`元素消失了。

# ruby-on-rails - RSpec 没有为我的模型和控制器生成规范文件

> ID：10454369
> 
> 赞同：3
> 
> 时间：2012-05-04T18:38:44.023
> 
> 标签：ruby-on-rails, ruby-on-rails-3, rspec, rspec2, rspec-rails

我有一个使用 Rails 3 的 Rails 应用程序。

我添加`rspec-rails`到我的`Gemfile`：

```
group :development, :test do
  gem 'rspec-rails'
end 
```

然后我跑`bundle install`。它显示了我的 gem 列表，并且所有 rspec gem 都在那里（核心、rails 等）。

但是，当我跑步时

```
rails g rspec:install 
```

这就是它返回的内容：

```
create  .rspec
create  spec
create  spec/spec_helper.rb 
```

虽然我的应用程序中有模型和控制器，但它只是创建这些文件。为什么 Rspec 不创建规范文件？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2017-09-15T17:46:44.397

这不再适用，您可以将生成器设置为在生成 Rails 应用程序的新部分时创建 RSpec 规范文件，以及为应用程序的现有部分创建规范文件。

主要功能在于应用程序的生成器配置，该配置在运行**rspec-rails** *rspec:install*任务时启用，但如果您想指定要包含/排除的特定规范文件，您可能需要这样：

*config/environments/development.rb* // 或任何你想要的环境

```
Rails.application.configure do
...
  config.generators do |g|
    g.test_framework :rspec
    g.fixture_replacement :factory_bot
    g.factory_bot dir: 'spec/factories'
    g.controller_specs false
    g.request_specs true
    g.helper_specs false
    g.feature_specs true
    g.mailer_specs true
    g.model_specs true
    g.observer_specs false
    g.routing_specs false
    g.view_specs false
  end
end 
```

**发电机设置**

'test_framework' 选项允许 rails 准确地知道要为哪个测试框架创建测试文件，并根据您的设置生成新文件。

使用'fixture_replacement'，我们可以让rails默认不生成fixture，而是使用创建的每个模型创建工厂。

最后是“factory_bot”选项，如果需要，您可以在其中更改工厂文件夹默认值，但在安装时将默认为该目录。[您可以在Factory Girl/Bot 说明](https://github.com/thoughtbot/factory_girl/blob/master/GETTING_STARTED.md#configure-your-test-suite)中找到更多选项。

现在，当我们生成新的东西时，比如模型：

```
> rails g model settings
  invoke  active_record
  create    db/migrate/20170915173537_create_settings.rb
  create    app/models/setting.rb
  invoke    rspec
  create      spec/models/setting_spec.rb
  invoke      factory_girl
  create        spec/factories/settings.rb 
```

**为应用程序的预生成部分生成规范文件**

与生成rails文件类似，可以通过Rspec自己的task生成spec文件：

```
> rails g rspec:model old_settings
  create  spec/models/old_settings_spec.rb
  invoke  factory_girl
  create    spec/factories/old_settings.rb 
```

此命令使用与 rails 的 generate 命令相同的约定来创建规范文件，包括**支架**，因此您可以为整个命名空间创建规范文件。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-04T18:41:45.463

Rspec 不会自动为您现有的模型和控制器创建规范。您现在必须自己创建这些文件。

创建规范文件非常简单。只需创建一个以 _spec.rb 结尾的文件并将其放入其中：

```
require 'spec_helper';
describe User do; 
end 
```

（当然用你正在测试的类替换 User ）你就在那里。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2021-07-14T10:33:06.133

作为脚注，如果您的生成器命令未生成您期望的文件，请检查`application.rb`配置文件以确保未禁用特定规范。

对我来说，以下生成器没有按预期创建文件。

```
% bin/rails g rspec:request api 
Running via Spring preloader in process 70924 
% 
```

因为在`application.rb`

```
g.request_specs false 
```

已设置。虽然这在事后看起来很明显，但命令输出并不直观。将其设置为`true`并重新运行生成器会产生预期的结果。

```
% bin/rails g rspec:request api
Running via Spring preloader in process 71843
      create  spec/requests/apis_spec.rb 
```

# database - 无法分配给只读属性

> ID：10454373
> 
> 赞同：3
> 
> 时间：2012-05-04T18:39:03.433
> 
> 标签：database, delphi, runtime

我正在尝试在运行时针对 TTable 组件更改数据库和表名，但是此错误一直出现在此行：

```
 E2129 Cannot assign to a read-only property 
```

我尝试使用的代码如下：

```
 tblDest.Database  := lvDestAlias;
  tblDest.TableName := lvDestAlias; 
```

使用的变量是先前已初始化的字符串。所以，是的，如果你能提供帮助，我将不胜感激:)

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-04T18:42:09.067

您的问题出在[`Database`](http://docwiki.embarcadero.com/Libraries/en/Bde.DBTables.TDBDataSet.Database)只读属性中，您必须[`DatabaseName`](http://docwiki.embarcadero.com/Libraries/en/Bde.DBTables.TDBDataSet.DatabaseName)改为设置该属性。

# django - 无法在 post_delete 中删除 FileField 的文件

> ID：10454378
> 
> 赞同：4
> 
> 时间：2012-05-04T18:39:21.843
> 
> 标签：django, django-models

我有一个模型`FileField`：

```
class FileModel(models.Model):
    name = models.CharField(max_length=100)
    description = models.CharField(max_length=200)
    file = models.FileField(upload_to='myfiles') 
```

当您使用 a 删除模型实例时`FileField`，django 不会自动从文件系统中删除基础文件，因此我设置了一个信号来删除以下基础文件`post_delete`：

```
def on_delete(sender, instance, **kwargs):
    instance.file.delete()

models.signals.post_delete.connect(on_delete, sender=FileModel) 
```

问题是，当我删除一个`FileModel`对象（比如说从 django 管理页面）时，它会从文件系统中删除文件，但不会删除模型。如果我再次删除它，它会删除模型，但是当它尝试从文件系统中删除文件时会引发异常，因为该文件不存在。

当我将文件删除更改为发生时`pre_delete`，`post_delete`它的行为应如此。我能想到的唯一会导致这种行为的是，如果从`FileField`自动保存模型中删除文件，这将导致它在`post_delete`.

所以我的问题是：为什么调用 a`FileField`的 delete 方法来`post_delete`防止模型被删除？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-05T01:04:12.060

当您访问一个`FileField`属性时，您将获得一个`FieldFile`包装器实例。现在猜猜它的`.delete`方法的代码是什么......（从 django.db.models.fields.files 中提取）

```
def delete(self, save=True):
        # Only close the file if it's already open, which we know by the
        # presence of self._file
        if hasattr(self, '_file'):
            self.close()
            del self.file

        self.storage.delete(self.name)

        self.name = None
        setattr(self.instance, self.field.name, self.name)

        # Delete the filesize cache
        if hasattr(self, '_size'):
            del self._size
        self._committed = False

        if save:
            self.instance.save() 
```

所以你是对的:)

如果我没看错，您现在可以将它再次连接到`post_delete`信号并传递`save=False`delete 方法，它应该可以工作。

是的，我只是因为你的问题才查到的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-21T15:57:46.370

试试[django-cleanup](https://github.com/un1t/django-cleanup)，它会在删除模型实例时删除旧文件，并在将新文件上传到 FileField 或 ImageField 时删除旧文件。

# java - 用于 WebSocket 流式客户端应用程序的 Java/JVM 或 Node.js/V8？

> ID：10454380
> 
> 赞同：3
> 
> 时间：2012-05-04T18:39:33.983
> 
> 标签：java, node.js, jvm, websocket, v8

我需要通过 WebSocket 使用 JSON 格式的数据流，并将数据按原样发送到 Redis 服务器。这就是这个应用程序需要做的所有事情；没有 UI，不需要处理任何请求，根本不需要处理数据。

我想获得最小的占用空间和最高的性能。你认为 Node.js/V8 会比 Java/JVM 更好地处理这种情况吗？我介于这两个选项之间，因为我可以管理这些选项，尽管我的主要技能是 Java。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-04T19:10:11.233

这完全取决于您安装应用程序的环境，以及您对每个环境的经验。

基于节点事件循环的模型非常有效，但是我发现 Java 在 CPU 密集型任务中表现更好。我不认为自己是这两个方面的专家（大约 10 个月的 Node.js，3 年的兼职 Java 经验）所以不要把我的回答当成福音。

在您的情况下，您只是真正执行 I/O，这是 Node.js 擅长的地方，如果您擅长 JavaScript，请选择 Node！

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-04T18:42:28.737

在这种情况下，Node.js 和 socket.io 很容易设置和部署。易于部署。您将在内存使用问题上大约 20-30mb 内存，而 metrix 的性能在这里很难，因为它很难对 websockets 进行基准测试。如果它没有部署在heroku上，那么我会选择node.js

您可以使用`node.js + socket.io`或`node.js / ruby + faye.`

流量生成 < 8k 请求/秒，使用非常基本的 VPS / 硬件设置对它们都应该没问题。

我在 ruby​​ 上使用 faye 与 1.1k 客户端通过 Web 套接字聊天，出现 0 个问题。我们在 node.js 聊天中拥有 4k 的峰值客户端。非常基础的硬件。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-04T18:41:45.667

`Node.js`如果你有足够的经验，我会建议你。

# php - PHP DOMDocument - InsertBefore 多次

> ID：10454383
> 
> 赞同：0
> 
> 时间：2012-05-04T18:39:38.390
> 
> 标签：php, xml, domdocument

我的情况是，我想在 XML 文件的多个位置添加相同的内容。仅供参考 - 第一次处理 DOMDocument。说xml看起来像

```
<rrd>
  <rra>
    <cdp_prep>
      <ds>
        <value>nan</value>
      </ds>
      <ds>
        <value>nan</value>
      </ds>
      <ds>
        <value>nan</value>
      <ds>
     </cdp_prep>
     <database>
        ...
     </database>
   </rra>
  <rra>
    <cdp_prep>
      <ds>
        <value>nan</value>
      <ds>
      </ds>
        <value>nan</value>
      <ds>
      <ds>
        <value>nan</value>
      </ds>
     </cdp_prep>
     <database>
        ...
     </database>
   </rra>
</rrd> 
```

如果我使用类似的东西，`$rrdCDPds = $xRRD->query("/rrd/rra/cdp_prep/ds");`我会得到所有的`<ds>`元素。在这种情况下，我的长度为 6。但是，我试图在`<ds>`每个`<cdp_prep>`元素的第二个上插入之前。我的问题是，如果我查询“/rrd/rra/cdp_prep”，我如何`<ds>`针对每个`<cdp_prep>`元素的第二个元素定位 insertBefore？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-04T22:46:24.817

您可以使用`child`XPath 中的轴来选择第二个 ds 子项：

```
/rrd/rra/cdp_prep/child::ds[2] 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-05T00:22:48.640

基本程序是：

1.  选择要用作`insertBefore`参考节点的节点。您可以使用子轴和位置测试来获得它：`cdp_prep/child::ds[position()=2]`，可以缩写为`cdp_prep/ds[2]`.
2.  准备要插入的节点。
3.  对于每个匹配的参考节点，克隆要插入的节点，然后将其插入。

例子：

```
$dom = new DOMDocument();
$dom->loadXML($xml);
$xp = new DOMXPath($dom);

$newcontent = $dom->createDocumentFragment();
$newcontent->appendChild($dom->createElement('NEWCONTENT'));
$newcontent->appendChild($dom->createTextNode("\n      "));

$DSs = $xp->query('/rrd/rra/cdp_prep/ds[2]');

foreach ($DSs as $ds) {
    $ds->parentNode->insertBefore($newcontent->cloneNode(true), $ds);
}

echo $dom->saveXML(); 
```

# android - Android：如何获取所有可用网络运营商的 GSM 信号强度

> ID：10454388
> 
> 赞同：44
> 
> 时间：2012-05-04T18:39:50.360
> 
> 标签：android, operators, gsm, signal-strength

我正在开发一个小应用程序来检查我所在地区各种网络运营商的信号强度。我目前运营商的信号很不稳定，我想看看其他GSM运营商的实力。

到目前为止，我一直在使用 TelephonyManager 和带有 onSignalStrengthsChanged 回调的 PhoneStateListener 来获取当前网络运营商的 GSM 信号强度，但似乎这个类只给我关于连接到我的 SIM 卡的网络信号强度的信息.

我对测量所有可用运营商的 GSM 信号强度感兴趣。搜索网络给出了关于使用内部 android 类的模糊提示，但我还没有找到任何好的例子。

任何可以让我继续获取所有可用网络运营商及其信号强度列表的答案都值得赞赏。

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2013-05-26T00:21:52.407

也许这些引用和链接可以帮助您编写自己的解决方案：

1.- 获取可用网络提供商列表（完整引用[如何获取可用网络提供商列表？](https://stackoverflow.com/questions/3123697/how-to-get-a-list-of-available-network-providers#answer-3123904)）：

> 由于 Android 是开源的，我查看了源代码，最后发现了一个名为**INetworkQueryService**的东西。我想你可以做与 android 设置实现相同的操作并与此服务进行交互。通过 NetworkSettings.java 的一些指导：
> 
> *   onCreate 启动 NetworkQueryService 并绑定它。
> *   loadNetworksList() 告诉服务查询网络运营商。
> *   评估 INetworkQueryServiceCallback，如果引发事件“EVENT_NETWORK_SCAN_COMPLETED”，将调用 networksListLoaded 以遍历可用网络。

2.- 即使快速阅读[NetworkSetting.java](https://github.com/dzo/packages_apps_phone/blob/master/src/com/android/phone/NetworkSetting.java)和[INetworkQueryService 接口](https://github.com/dzo/packages_apps_phone/blob/master/src/com/android/phone/INetworkQueryService.aidl)，也能让我们了解实现您的目标。

*   在声明中连接服务。

> ```
> /**
>  * Service connection code for the NetworkQueryService.
>  * Handles the work of binding to a local object so that we can make
>  * the appropriate service calls.
>  */
> 
> /** Local service interface */
> private INetworkQueryService mNetworkQueryService = null;
> 
> /** Service connection */
> private final ServiceConnection mNetworkQueryServiceConnection = new ServiceConnection() {
> 
>     /** Handle the task of binding the local object to the service */
>     public void onServiceConnected(ComponentName className, IBinder service) {
>         if (DBG) log("connection created, binding local service.");
>         mNetworkQueryService = ((NetworkQueryService.LocalBinder) service).getService();
>         // as soon as it is bound, run a query.
>         loadNetworksList();
>     }
> 
>     /** Handle the task of cleaning up the local binding */
>     public void onServiceDisconnected(ComponentName className) {
>         if (DBG) log("connection disconnected, cleaning local binding.");
>         mNetworkQueryService = null;
>     }
> }; 
> ```

*   onCreate 启动 NetworkQueryService 并绑定它。

> ```
> Intent intent = new Intent(this, NetworkQueryService.class);
> ...
> startService (intent);
> bindService (new Intent(this, NetworkQueryService.class), mNetworkQueryServiceConnection,
>                         Context.BIND_AUTO_CREATE); 
> ```

*   loadNetworksList() 告诉服务查询网络运营商。

> ```
> private void loadNetworksList() {
> ...    
> // delegate query request to the service.
> try {
>     mNetworkQueryService.startNetworkQuery(mCallback);
> } catch (RemoteException e) {
> }
> 
> displayEmptyNetworkList(false); 
> } 
> ```

*   INetworkQueryServiceCallback 被评估：

> ```
> /**
>  * This implementation of INetworkQueryServiceCallback is used to receive
>  * callback notifications from the network query service.
>  */
> private final INetworkQueryServiceCallback mCallback = new INetworkQueryServiceCallback.Stub() {
> 
>     /** place the message on the looper queue upon query completion. */
>     public void onQueryComplete(List<OperatorInfo> networkInfoArray, int status) {
>         if (DBG) log("notifying message loop of query completion.");
>         Message msg = mHandler.obtainMessage(EVENT_NETWORK_SCAN_COMPLETED,
>                 status, 0, networkInfoArray);
>         msg.sendToTarget();
>     }
> }; 
> ```

*   如果引发事件“EVENT_NETWORK_SCAN_COMPLETED”，则将调用 networksListLoaded 以遍历可用网络。

> ```
> private void networksListLoaded(List<OperatorInfo> result, int status) {
>     ...
> 
>     if (status != NetworkQueryService.QUERY_OK) {
>         ...
>         displayNetworkQueryFailed(status);
>         displayEmptyNetworkList(true);
>     } else {
>         if (result != null){
>             displayEmptyNetworkList(false);
>             ...
>         } else {
>             displayEmptyNetworkList(true);
>         }
>     }
> } 
> ```

我希望它有所帮助。我认为这是一个有趣的挑战，所以下次有空的时候我会尝试一下。祝你好运！

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-05T07:39:04.933

```
private final PhoneStateListener phoneStateListener = new PhoneStateListener() {
    @Override
    public void onCallForwardingIndicatorChanged(boolean cfi) {

        super.onCallForwardingIndicatorChanged(cfi);
    }

    @Override
    public void onCallStateChanged(int state, String incomingNumber) {
        //checkInternetConnection();
        String callState = "UNKNOWN";
        switch (state) {
        case TelephonyManager.CALL_STATE_IDLE:
            callState = "IDLE";
            break;
        case TelephonyManager.CALL_STATE_RINGING:
            callState = "Ringing (" + incomingNumber + ")";
            break;
        case TelephonyManager.CALL_STATE_OFFHOOK:
            callState = "Offhook";
            break;
        }

        Log.i("Phone Stats", "onCallStateChanged " + callState);

        super.onCallStateChanged(state, incomingNumber);
    }

    @Override
    public void onCellLocationChanged(CellLocation location) {
        String cellLocationString = location.toString();

        super.onCellLocationChanged(location);

    }

    @Override
    public void onDataActivity(int direction) {
        String directionString = "none";
        switch (direction) {
        case TelephonyManager.DATA_ACTIVITY_IN:
            directionString = "IN";
            break;
        case TelephonyManager.DATA_ACTIVITY_OUT:
            directionString = "OUT";
            break;
        case TelephonyManager.DATA_ACTIVITY_INOUT:
            directionString = "INOUT";
            break;
        case TelephonyManager.DATA_ACTIVITY_NONE:
            directionString = "NONE";
            break;
        default:
            directionString = "UNKNOWN: " + direction;
            break;
        }

        Log.i("Phone Stats", "onDataActivity " + directionString);

        super.onDataActivity(direction);
    }

    @Override
    public void onDataConnectionStateChanged(int state,int networktype) {
        String connectionState = "Unknown";

        switch (state ) {

        case TelephonyManager.DATA_CONNECTED :
            connectionState = "Connected";
            break;
        case TelephonyManager.DATA_CONNECTING:
            connectionState = "Connecting";
            break;
        case TelephonyManager.DATA_DISCONNECTED:
            connectionState = "Disconnected";
            break;
        case TelephonyManager.DATA_SUSPENDED:
            connectionState = "Suspended";
            break;
        default:
            connectionState = "Unknown: " + state;
            break;
        }

        super.onDataConnectionStateChanged(state);

        Log.i("Phone Stats", "onDataConnectionStateChanged "
                + connectionState);

    }

    @Override
    public void onMessageWaitingIndicatorChanged(boolean mwi) {

        super.onMessageWaitingIndicatorChanged(mwi);
    }

    @Override
    public void onServiceStateChanged(ServiceState serviceState) {
        String serviceStateString = "UNKNOWN";
        switch (serviceState.getState()) {
        case ServiceState.STATE_IN_SERVICE:
            serviceStateString = "IN SERVICE";
            break;
        case ServiceState.STATE_EMERGENCY_ONLY:
            serviceStateString = "EMERGENCY ONLY";
            break;
        case ServiceState.STATE_OUT_OF_SERVICE:
            serviceStateString = "OUT OF SERVICE";
            break;
        case ServiceState.STATE_POWER_OFF:
            serviceStateString = "POWER OFF";
            break;

        default:
            serviceStateString = "UNKNOWN";
            break;
        }

        Log.i("Phone Stats", "onServiceStateChanged " + serviceStateString);

        super.onServiceStateChanged(serviceState);
    }

    @Override
    public void onSignalStrengthChanged(int asu) {

        Log.i("Phone Stats", "onSignalStrengthChanged " + asu);
        setSignalLevel( asu);
        super.onSignalStrengthChanged(asu);
    }
    private void setSignalLevel(int level) {
        int sLevel = (int) ((level / 31.0) * 100);

        Log.i("signalLevel ", "" + sLevel);
    }

}; 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2015-01-30T15:52:01.253

由于我没有 50 点声望点，以下是我对该主题的搜索结果：

Alejandro Colorado 的解决方案似乎是一个不错的解决方案。但问题是用于实现它的类是为android系统应用程序保留的，即使用与系统相同的签名密钥签名的应用程序。

怎么可能？我找到了两种方法来实现这一点。

第一个是在任何制造商公司找一份工作，并签署他们的 NDA，但是，这不是一个很好的解决方案。尤其是使用此密钥实施和签名的应用程序只能在公司的设备上运行......

第二个，更有趣，但我警告你，这并不容易，是制作你自己的 ROM。您必须创建应用程序，将其插入 ROM 的 /system/app/ 目录并重新编译它以使用新系统刷新您的设备。但是有一个问题我还没有回答，是无法识别的ROM签名的问题。我认为避免此问题的最佳方法是将您的 ROM 签名密钥添加到您将使用的恢复中。

这就是我现在所处的位置，也许你会发现这些研究很有用，我希望如此！如果我为你们找到更多信息，我稍后会回来。再见。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-04T18:48:56.840

创建一个 PhoneStateListener 并处理 onSignalStrengthChanged 回调。当您的应用程序初始化时，它应该会给您一个初始通知。这是在 1.x 中。在 2.x 中，有一个未[解决](http://code.google.com/p/android/issues/detail?id=4968)的问题。

# maven - 有没有办法让两个同时的 maven 构建填充一个本地 repo 而不会发生冲突

> ID：10454391
> 
> 赞同：0
> 
> 时间：2012-05-04T18:40:01.937
> 
> 标签：maven, repository

我想在我的本地系统上并行运行两个 Maven 构建，并让它们填充相同的 Maven 存储库。两者都主要是构建我没有更改的东西并编写快照。有没有办法让他们使用锁定文件等来避免在过度写作时阅读？

我知道我可以使用设置我的本地存储库位置并拥有 /.m2/a/repository /.m2/b/repository 但有交错解决方案吗？

或者这只会让我陷入困境而没有真正的好处？

谢谢

彼得

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-14T15:04:01.663

谢谢您的帮助。为每个构建设置一个私有存储库似乎提供了保持构建独立的好处，同时允许用户同时处理多个问题。

修改设置以使用本地 repo 的环境变量

```
<localRepository>${MY_REPO}</localRepository> 
```

工作流程：检查源工作区 A 设置变量 MY_REPO 工作区 A/repo 进行更改 启动 maven 命令以构建和测试

对工作区 B 重复

如果构建和测试阶段很长并且多个测试实例不太可能交互，这将很有用。

彼得

# css - 在 MVC 字段集中流动编辑器元素？

> ID：10454397
> 
> 赞同：0
> 
> 时间：2012-05-04T18:40:48.693
> 
> 标签：css, asp.net-mvc-3, css-float

我正在尝试获取 MVC 3 生成的“创建”页面，以使所有编辑器标签/文本框都浮动在字段集中。

我将脚手架 div 框包裹在另一个 div 中：

```
 <div class="editor-float">
        <div class="editor-label">
            @Html.LabelFor(model => model.EntryDate)
        </div>
        <div class="editor-field">
            @Html.EditorFor(model => model.EntryDate)
            @Html.ValidationMessageFor(model => model.EntryDate)
        </div>
    </div> 
```

然后我添加了这个 CSS 代码：

```
.editor-float
{
   margin-right: 5px;
   float: left;
   position: relative;
} 
```

问题是大多数 div 的浮动很好，但不是全部。

行为图片（Value4 自己坐在“行”中）：

![在此处输入图像描述](../Images/6e32ec66439dfbab212766381f947870.png)

有没有更好的 CSS 属性可以用来让事情变得更好？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-04T18:50:20.980

你要的是`clear`财产。如果你有多个带有类 editor-float 的 div 元素，那么像`clear: left;` 这样定义 .editor-float ：

```
.editor-float 
{ 
    margin-right: 5px; 
    float: left; 
    position: relative; 
    clear: left;
} 
```

# datetime - Chronolocation - 描述地理定位的时间等价物

> ID：10454402
> 
> 赞同：3
> 
> 时间：2012-05-04T18:41:30.840
> 
> 标签：datetime, geolocation

> “地理位置是对物体真实地理位置的识别。地理位置可以指评估位置的做法，也可以指实际评估的位置。” -- [http://en.wikipedia.org/wiki/Geolocation](http://en.wikipedia.org/wiki/Geolocation)

是否有一种标准方法来描述超出 Unix 时间戳的时间位置/坐标？如果没有，请建议或描述一个大纲。这样的系统将正式确定时间，例如：

1.  -13,750,000,000 ± 11,000,000（大爆炸）
2.  1970-01-01:00:00:00（Unix 纪元）
3.  1（公元 1 年）

例如：Geolocations 和 Chronolocations 都经常缺乏精确性——这只是一个考虑因素，但我相信还有更多。

我的目标是形成一种存储和检索各种时间位置的方法。正如您可能想象的那样，这比听起来更复杂。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-17T02:46:20.807

我从来没有听说过这样的系统，但是编写一个存在这样的结构化数据类型的类是相当简单的：

```
struct bigTime{
 signed long int millenium;
 int decade;
 signed long int seconds;
}time; 
```

您可以在任意点之前/之后存储千年（为简单起见，甚至是 1970 年），为中距离存储数十年，然后使用秒和毫秒作为短期。

您可以创建一个类，其中添加 +/- $X 秒、分钟、小时、天、周、月、年、几十年、世纪、千年将是简单的。

```
Say you wanted to go 156 years back. that's -15 decades and -189 341 556 seconds. 

Or 3205 years and 2 weeks and a day back. That's -3 millenia, -20 decades, -159 080 630 seconds.

Or even 67,000,012 years (from jonathan's offtopic joke). That's -67000 millenia, -1 decade -63 113 851.9 seconds. 
```

所有这些都是从今天开始的，但将来自您选择的任意点。

我描述的系统将给你 4.2 万亿年的时间来处理任何一种方法，直到毫秒，并且或多或少地减少了所需的内存。（如果你尝试的话，我相信它可能会被更多地降低）

# iphone - 使用 Xcode 4，主项目 + 共享代码项目的正确方法是什么？

> ID：10454403
> 
> 赞同：3
> 
> 时间：2012-05-04T18:41:34.777
> 
> 标签：iphone, objective-c, ios, xcode, cocoa-touch

目前我有一个 iPhone 应用程序，它只是一个大项目。它有数百个代码文件。我有一个名为“Helper”的文件夹，其中包含我创建的所有类。我将制作第二个应用程序，它也需要使用与“Helper”文件夹中完全相同的代码。

在两个项目/应用程序之间共享“帮助”代码的正确方法是什么？我应该把它放在它自己的项目文件中，然后将主应用程序+“Helper”添加到一个公共工作区吗？我对制作静态库或任何东西不感兴趣......我只是希望以某种方式隔离代码。

我已经尝试过制作第二个“空白”项目文件并将代码拖入其中，但是当我尝试构建 Xcode 时，只是认为我现在缺少头文件......由于某种原因，它没有在另一个项目中看到代码.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-04T19:01:00.150

在我看来，您所描述的情况正是框架旨在解决的问题。您最终可能会创建另一个项目，其中包含您所有的共享代码，并创建一个您的应用程序可以链接的框架。

我建议阅读 Apple 的[框架编程指南](https://developer.apple.com/library/mac/#documentation/macosx/Conceptual/BPFrameworks/Frameworks.html)。从介绍到指南：

> Mac OS X 广泛使用框架来分发共享代码和资源，例如系统本身的接口。您可以创建自己的框架，为公司的一个或多个应用程序提供共享代码和资源。您还可以创建包含类库或附加模块的框架，以将它们分发给其他开发人员。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-04T18:55:59.507

如果共享代码和当前应用程序独有的代码之间有清晰的区别，那将是理想的。如果还没有，请尝试确保将共享的所有内容不依赖于项目唯一代码中的任何内容。

实现此目的的一种方法是使用 Git 存储库，然后将共享代码作为自己的存储库项目。然后，在两个项目的 repo 中，将帮助代码作为子模块包含在内。

我已经处理过使用子模块的项目，尽管我自己还没有设置子模块方面。这里的好处是您对“助手”所做的任何更改都可以拉入两个项目，因此更改是同步的。

如果您还不熟悉 Git，我建议您熟悉一下。即使您不与他人合作，在您的计算机上设置 Git 存储库也非常有用。XCode 目前提供了在您创建项目时设置 repo 的选项。如果您还没有这样做，或者不确定，您仍然可以在事后创建一个 repo。

我使用源代码树来管理我的存储库。[从SourceTree](http://www.sourcetreeapp.com/)创建一个 repo 非常简单和容易。但是，您可以使用 GitHub 自己的桌面客户端，也可以根据需要使用任何其他客户端 - 取决于您如何设置项目。

关于在 git 中设置子模块的一些信息：[设置子模块](http://book.git-scm.com/5_submodules.html)

所以，回顾一下：

1.  确保您的“帮助”代码**可以独立存在**
2.  将帮助代码放入**自己的仓库**
3.  **将帮助程序存储库**作为子模块****包含**到您想要代码的任何项目中。**

 **希望有帮助！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-04T19:05:46.123

> 我对制作静态库或任何东西不感兴趣......

然而，对于 iOS，静态库目标正是您要使用的。

不需要工作区，只需一个带有共享静态库的单独 Xcode 项目，两个应用程序都引用该库。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-04T18:57:19.337

您可以将共享代码放在单独的文件夹中，然后将其添加到两个项目中。但不要忘记将文件夹的路径添加到`User Header Search Paths`in `Build Settings > Search Paths`。**

# java - 表达式的类型必须是数组类型，但它解析为字符串

> ID：10454407
> 
> 赞同：1
> 
> 时间：2012-05-04T18:41:44.337
> 
> 标签：java, arrays, string, expression, field

我不知道我的代码发生了什么。我似乎无法弄清楚为什么数组给了我这个错误。该行是`String line[] = aryLines[];`专门`aryLines[];`

我的代码：

```
public void interpretGpl(String aryLines){

    System.out.println("Interpreting");
    String line[] = aryLines[];
    String tempString[] = null;
    int tempInt[] = null;
    int i = interCount;
    boolean isInt;
    boolean storeValue = false; 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-04T18:48:08.860

我假设这`aryLines`是一个字符串，其中包含由换行符分隔的文本行。这是您需要的代码：

```
public void interpretGpl(String aryLines) {
    String line[] = aryLines.split("\n"); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-04T19:05:38.433

`aryLines`被声明为字符串。它不是一个数组。相反，`line`是一个数组。它不是字符串。= 运算符右侧的东西必须可分配给 = 运算符左侧的东西，而字符串和数组是完全不同的东西。

可能是您为这些变量之一选择了错误的类型，并且您希望它们都是字符串，或者都是字符串数组。

如果类型正确，您将必须弄清楚您想要`aryLines[]`做什么，以及如何去做。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-04T18:45:14.167

你到底想在这里做什么？你想`line`成为一个只有字符串的数组`aryLines`吗？在这种情况下：

```
String line[] = {aryLines}; 
```

是你需要做的。

```
aryLines[] 
```

就其本身而言，没有任何意义。`[]`仅与数据类型结合使用以表示该数据类型的数组。`aryLines`不是数据类型，它是*数据*。

# amazon-s3 - 将大文件上传到 Amazon S3

> ID：10454411
> 
> 赞同：2
> 
> 时间：2012-05-04T18:42:01.383
> 
> 标签：amazon-s3, uploadify

我设法让以下脚本处理较小的文件。但是当我尝试上传大约 10MB 或更多的文件时，它说它已完成，但该文件没有显示在我的 S3 存储桶中。

任何想法为什么它会上传较小的文件而不是 10MB 或更大的文件？

```
<?php
//System path for our website folder
define('DOCROOT', realpath(dirname(__FILE__)).DIRECTORY_SEPARATOR);
//URL for our website
define('WEBROOT', htmlentities(
    substr($_SERVER['REQUEST_URI'], 0, strcspn($_SERVER['REQUEST_URI'], "\n\r")),
    ENT_QUOTES
));

//Which bucket are we placing our files into
$bucket = 'bucket.mysite.com';
// This will place uploads into the '20100920-234138' folder in the $bucket bucket
$folder = date('Ymd-His').'/'; //Include trailing /

//Include required S3 functions
require_once DOCROOT."includes/s3.php";

//Generate policy and signature
list($policy, $signature) = S3::get_policy_and_signature(array(
    'bucket'        => $bucket,
    'folder'        => $folder,
    ));
?>

<script type="text/javascript">
    $(document).ready(function() {
        $("#file_upload").uploadify({
            'uploader'      : '<?= WEBROOT ?>files/uploadify/uploadify.swf',
            'buttonText'        : 'Browse',
            'cancelImg'     : '<?= WEBROOT ?>files/uploadify/cancel.png',
            'script'        : 'http://s3.amazonaws.com/<?= $bucket ?>',
            'scriptAccess'      : 'always',
            'method'        : 'post',
            'scriptData'        : {
                "AWSAccessKeyId"        : "<?= S3::$AWS_ACCESS_KEY ?>",
                "key"               : "${filename}",
                "acl"               : "authenticated-read",
                "policy"            : "<?= $policy ?>",
                "signature"         : "<?= $signature ?>",
                "success_action_status"     : "201",
                "key"               : encodeURIComponent(encodeURIComponent("<?= $folder ?>${filename}")),
                "fileext"           : encodeURIComponent(encodeURIComponent("")),
                "Filename"          : encodeURIComponent(encodeURIComponent(""))
            },
            'fileExt'       : '*.*',
            'fileDataName'      : 'file',
            'simUploadLimit'    : 2,
            'multi'         : true,
            'auto'          : true,
            'onError'       : function(errorObj, q, f, err) { console.log(err); },
            'onComplete'        : function(event, ID, file, response, data) { console.log(file); }
        });
    });
</script> 
```

* * *

```
 <?php
    class S3 {
        public static $AWS_ACCESS_KEY       = '< Your access key >';
        public static $AWS_SECRET_ACCESS_KEY    = '< Your secrete key >';

    /*
     * Purpose:
     *      Actionscript encodes '+' characters in the signature incorrectly - it makes
     *      them a space instead of %2B the way PHP does. This causes uploadify to error
     *      out on upload. This function recursively generates a new policy and signature
     *      until a signature without a + character is created.
     * Accepts: array $data
     * Returns: policy and signature
     */
    public static function get_policy_and_signature( array $data )
    {
        $policy = self::get_policy_doc( $data );
        $signature = self::get_signature( $policy );

        if ( strpos($signature, '+') !== FALSE )
        {
            $data['timestamp'] = intval(@$data['timestamp']) + 1;
            return self::get_policy_and_signature( $data );
        }

        return array($policy, $signature);
    }

    public static function get_policy_doc(array $data)
    {
        return base64_encode(
            '{'.
                '"expiration": "'.gmdate('Y-m-d\TH:i:s\Z', time()+60*60*24+intval(@$data['timestamp'])).'",'.
                '"conditions": '.
                '['.
                    '{"bucket": "'.$data['bucket'].'"},'.
                    '["starts-with", "$key", ""],'.
                    '{"acl": "authenticated-read"},'.
                    //'{"success_action_redirect": "'.$SWFSuccess_Redirect.'"},'.
                    '{"success_action_status": "201"},'.
                    '["starts-with","$key","'.str_replace('/', '\/', $data['folder'] ).'"],'.
                    '["starts-with","$Filename",""],'.
                    '["starts-with","$folder",""],'.
                    '["starts-with","$fileext",""],'.
                    '["content-length-range",0,5242880]'.
                ']'.
            '}'
        );
    }

    public static function get_signature( $policy_doc ) {
        return base64_encode(hash_hmac(
            'sha1', $policy_doc, self::$AWS_SECRET_ACCESS_KEY, true
        ));
    }
    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-04T19:37:46.717

问题解决的问题是这条线

```
'["content-length-range",0,5242880]' 
```

我把它注释掉了，它可以正常工作。没有大小限制。

# java - 使用什么语法从 JavaDB 数据库中选择常量字段值？

> ID：10454413
> 
> 赞同：1
> 
> 时间：2012-05-04T18:42:09.460
> 
> 标签：java, mysql, sql, derby

我正在使用`UNION ALL`将多个`SELECT`查询的结果合并为一个`ResultSet`. 我使用常量字段值来识别生成每一行的语句。这适用于 MySQL，但 Java DB 会抛出`SQLSyntaxErrorException`，指向第一个常量字段值之后的逗号。

****在针对 JavaDB 数据库****的查询中使用什么语法来选择常量字段值？**`SELECT`**

 ****第一个`SELECT`有大约 100 列具有不同的数据类型，下面`SELECT`的 s 被填充以匹配正确的列数。我[这里](http://pastebin.com/RZck3DwW)有。当前的语句如下所示：

```
select
    (0, ID, NAME_FIRST, NAME_LAST)
from person 
where ID=500
union all
select 
    (1, COMMTYPE_ID, NULL, NULL)
from person_commtype 
where PERSON_ID=500 
```

这会引发以下异常：

```
java.sql.SQLSyntaxErrorException: Syntax error: Encountered "," at line 2, column 7. 
```

我也尝试过强制转换值，并删除括号，如下所示：

```
select
    (cast(0 as integer), ID, NAME_FIRST, NAME_LAST)
from person 
where ID=500

select
    0, ID, NAME_FIRST, NAME_LAST
from person
where ID=500 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-04T18:43:47.050

`SELECT`从子句中的字段列表中删除括号。

```
select
    0, ID, NAME_FIRST, NAME_LAST
from person 
where ID=500
union all
select 
    1, COMMTYPE_ID, NULL, NULL
from person_commtype 
where PERSON_ID=500 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-10T11:53:26.843

问题是 Apache Derby 不支持

```
select null from test 
```

相反，您必须将 null 转换为正确的类型：

```
select cast(null as varchar(255)) from test 
```

所以查询看起来像：

```
select
    0, ID, NAME_FIRST, NAME_LAST
from person where ID=500
union all
select 
    1, COMMTYPE_ID, 
    cast(NULL as varchar(255)), 
    cast(NULL as varchar(255))
from person_commtype where PERSON_ID=500 
```

您还必须删除列列表周围的括号，因为这不是标准的 SQL 语法。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-05-04T18:44:39.850

尝试将您的数字放在单引号中。

```
select
    ('0', ID, NAME_FIRST, NAME_LAST)
from person 
where ID=500
union all
select 
    ('1', COMMTYPE_ID, NULL, NULL)
from person_commtype 
where PERSON_ID=500 
```****

# android - 将 Ormlite 与 Android 的 Content Provider 结合使用

> ID：10454415
> 
> 赞同：13
> 
> 时间：2012-05-04T18:42:14.497
> 
> 标签：android, persistence, ormlite, android-contentprovider

我正在开发一个 Android 应用程序，我对是否应该使用 Ormlite 与 Android Content Provider 一起更新和检索数据存在冲突。内容提供者将主要用于通知应用程序在其他平台上的应用程序中发生的数据更改。也许我让这比它需要的更复杂。一些更有经验的意见将不胜感激！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2014-01-08T16:47:21.607

[https://github.com/blandware/android-atleap](https://github.com/blandware/android-atleap)库是一个将 ContentProvider 与 OrmLite 结合使用的示例

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-04T20:42:31.633

试试看。获得的经验通常值得付出努力，即使你最终放弃了结果。哦，让我们知道它是怎么回事，因为我也对[OrmLite](http://ormlite.com/)很好奇。:-)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2014-09-23T18:28:38.953

您可以将[OrmLiteContentProvider](https://github.com/jakenjarvis/Android-OrmLiteContentProvider/blob/master/README.md)或[Android AtLeap 加速器](https://github.com/blandware/android-atleap)与 OrmLite 结合使用。这两个库都允许您在 OrmLite 数据模型之上轻松定义内容提供者。

# firefox - 不同浏览器如何使用同步 XHR 处理超时

> ID：10454426
> 
> 赞同：1
> 
> 时间：2012-05-04T18:43:01.080
> 
> 标签：firefox, timeout, xmlhttprequest, synchronous

周三，我维护的 AJAXy CRM 系统对很多用户都崩溃了，因为 Firefox 开始报告“在窗口上下文中的同步模式下不支持使用 XMLHttpRequest 的超时属性”。其他主要浏览器仍然可以正常工作，因此我建议人们不要使用 Firefox。

据我了解，同步请求是一件坏事，所以我只能假设最近对 Firefox 的一些更新已经阻止它适应坏事。之前的所有讨论（此处和网络上）都暗示将 timeout 属性与同步 XMLHttpRequest 对象一起使用根本不应该起作用，这让我想知道为什么它显然会起作用（截至周三在 Firefox 上除外）。

其他浏览器/旧 Firefox 是否真的在“不应该”的地方实现了超时行为，或者他们只是忽略异常并继续执行（而不是像新的 Firefox 那样退出）？

编辑：我现在无法找到代码，但它是这样的： “this”是复杂的东西，大概是从 XMLHTTPRequest 继承的，“c”是指特定 AJAX 请求或其他东西的特定对象。我会坦白说我对 Javascript 和这个基于 Sugar 的特定 CRM 知之甚少，但代码的本质很简单。这是一种通用的面向对象的请求方式，当请求超时时，这个特定的 4 行左右的代码就会被处理。我的印象是这是一个抽象的基础，特定的请求（或请求实体）应该从它专门化。Firefox Javascript 引擎在.`if (c.somekindoftimeouthandler !== "unassigned" && this.timeout) {
c.timeout = this.timeout
//more stuff about the handler etc...
}``this.timeout`

我相信我的问题的主旨更笼统 - 考虑到使用超时同步 XHR 的“坏处”，各种浏览器如何处理它？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-05T00:45:10.400

IE 允许“超时”用于同步 XHR。如果达到超时时间，我相信它会从 send() 中抛出异常。

Firefox 完全实现了 XHR 规范所说的：异步 XHR 支持超时，但同步 XHR 不支持超时（如果您尝试设置它，则会抛出）。

其他浏览器（和旧的 Firefox）根本不支持超时；他们甚至没有财产。由于您的脚本正在嗅探该属性是否存在，它甚至不会尝试在其他浏览器中设置超时，这就是它在那里工作的原因：您的脚本不会尝试做坏事，所以这些浏览器不会结束向上抛出异常。

所以所有改变的是 Firefox 增加了对 timeout 属性的支持，但它没有做 IE 所做的事情，而是实现了规范所说的事情。而且您的脚本假设任何实现该属性的浏览器都将以 IE 的方式运行...

# android - 通过单击文本中的某些单词导航到其他活动

> ID：10454428
> 
> 赞同：0
> 
> 时间：2012-05-04T18:43:03.290
> 
> 标签：android, android-layout, textview, android-button

我想显示一个文本，其中某些单词会导致应用程序中的其他活动。除了并排放置一堆TextView和按钮（带有可点击的文字和透明背景）之外，还有更方便的方法来实现它吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-04T19:07:52.110

只是一堆 TextViews 和他们的 onClick(s) 应该做的，你不需要按钮..

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-04T19:13:30.143

您可以查看[Linkify](http://developer.android.com/reference/android/text/util/Linkify.html)类，它在文本中搜索一些预定义的链接，例如电话号码、电子邮件地址和 Web 链接，并自动使它们可点击并在点击时导致相应的活动。我认为有可能添加您自己的模式来识别文本中的单词并将它们绑定到您希望用于这些单词的活动。希望这可以帮助。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-04T21:49:31.677

请检查两个链接

[http://blog.elsdoerfer.name/2009/10/29/clickable-urls-in-android-textviews/](http://blog.elsdoerfer.name/2009/10/29/clickable-urls-in-android-textviews/)

[在我的 android 应用程序中处理 textview 链接单击](https://stackoverflow.com/questions/1697084/handle-textview-link-click-in-my-android-app)

# jsf - JSF/Bean #{} 未呈现/解析

> ID：10454432
> 
> 赞同：0
> 
> 时间：2012-05-04T18:43:11.237
> 
> 标签：jsf, jsf-2, el

我`#{}`在 JSF 页面内渲染时遇到问题。

我正在使用 Mojarra 2.1.5 和 JBoss 7

例子：

**JSF 页面**

`<h:inputText value="#{bean.name}"/>`

**面孔-config.xml**

```
<managed-bean>
   <managed-bean-name>bean</managed-bean-name>
   <managed-bean-class>com.Bean</managed-bean-class>
   <managed-bean-scope>session</managed-bean-scope>
</managed-bean> 
```

**HTML 输出**

`#{bean.name}`

**问题**

1.  为什么我看不到 bean 的正确值？
2.  为什么我得到字符串而不是`nothing`？

**更新**

`web.xml`内容：

```
<?xml version="1.0" encoding="ISO-8859-1"?>

<!DOCTYPE web-app
    PUBLIC "-//Sun Microsystems, Inc.//DTD Web Application 2.3//EN"
    "http://java.sun.com/dtd/web-app_2_3.dtd">
<!--
Automatically created by Apache Tomcat JspC.
-->
<web-app 
    xmlns="http://java.sun.com/xml/ns/javaee"
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xsi:schemaLocation="http://java.sun.com/xml/ns/javaee http://java.sun.com/xml/ns/javaee/web-app_3_0.xsd"
    version="3.0">

    <servlet>
        <servlet-name>Faces Servlet</servlet-name>
        <servlet-class>javax.faces.webapp.FacesServlet</servlet-class>
        <load-on-startup>1</load-on-startup>
    </servlet>

    <servlet-mapping>
        <servlet-name>Faces Servlet</servlet-name>
        <url-pattern>*.jsf</url-pattern>
    </servlet-mapping>
</web-app> 
```

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-04T18:50:03.300

根据您更新的问题：

> *我正在使用 Mojarra 2.1.5 和 JBoss 7*

根据您的评论：

> *在我的 WEB-INF/lib 目录中，我只有：jsf-api-1.2_09、jsf-facelets-1.1.14.jar 和 jsf-impl-1.2_09.jar ......老实说我不太确定如果我需要所有这些...在 web-app 标签中我有 2.5 版*

JBoss 7 已经附带了一个 JSF 2.x 实现。您不需要自己提供任何 JSF 库，当然不是旧的规范版本，它只会与所有内容发生冲突。从您的 webapp 中**删除**这些文件。`jsf-*.jar`此外，从 JSF 2.0 开始，Facelets 捆绑在 JSF 库中。**也删除**该`jsf-facelets-*.jar`文件。

JBoss 7 是一个与 Servlet 3.0 兼容的容器。重新声明您`web.xml`遵守 Servlet 3.0：

```
<?xml version="1.0" encoding="UTF-8"?>
<web-app 
    xmlns="http://java.sun.com/xml/ns/javaee"
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xsi:schemaLocation="http://java.sun.com/xml/ns/javaee http://java.sun.com/xml/ns/javaee/web-app_3_0.xsd"
    version="3.0">

    <!-- Config here. -->

</web-app> 
```

此外，您还需要确保`faces-config.xml`符合 JSF 2.0：

```
<?xml version="1.0" encoding="UTF-8"?>
<faces-config
    xmlns="http://java.sun.com/xml/ns/javaee"
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xsi:schemaLocation="http://java.sun.com/xml/ns/javaee http://java.sun.com/xml/ns/javaee/web-facesconfig_2_0.xsd"
    version="2.0">

    <!-- Config here. -->

</faces-config> 
```

请确保您没有阅读针对 JSF 1.x 的教程。JSF 2.x 是一个重大的规范更改。确保您正在阅读面向 JSF 2.x 的资源/书籍/教程。[您可以在我们的 JSF 标签 wiki 页面](https://stackoverflow.com/tags/jsf/info)底部找到有用的链接。

# java - 如何完全禁用 CellTable 中的行选择？

> ID：10454435
> 
> 赞同：4
> 
> 时间：2012-05-04T18:43:27.947
> 
> 标签：java, gwt

当在 CellTable 中选择一行时，我想完全查看更新。如何才能做到这一点？在下面的测试用例中，使用[NoSelectionModel](http://google-web-toolkit.googlecode.com/svn/javadoc/latest/com/google/gwt/view/client/NoSelectionModel.html)，视图仍然更新：单击一行会更改该行的背景和边框颜色，直到单击另一行。

```
 CellTable<String> table = new CellTable<String>();

    TextColumn<String> column = new TextColumn<String>()
    {
        @Override
        public String getValue(String string)
        {
            return string;
        }
    };

    table.addColumn(column);

    List<String> sampleData = Arrays.asList("foo", "bar", "baz");

    table.setRowData(sampleData);

    final NoSelectionModel<String> selectionModel = new NoSelectionModel<String>();
    table.setSelectionModel(selectionModel);

    RootPanel.get().add(table); 
```

我还尝试使用空的覆盖方法对 SingleSelectionModel 进行子类化，但没有成功。

我可以通过为选定的行提供空的[CSS 样式](https://stackoverflow.com/questions/6386070/append-custom-style-to-a-gwt-celltable-in-this-case-all-cells)来伪造我想要的行为，但这种方法似乎有点 hack-ish。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-05-05T00:40:05.537

您看到的是键盘选择突出显示（当您不使用鼠标与表格交互时非常有用）。
您可以使用禁用它[`setKeyboardSelectionPolicy(KeyboardSelectionPolicy.DISABLED)`](http://google-web-toolkit.googlecode.com/svn/javadoc/latest/com/google/gwt/user/cellview/client/HasKeyboardSelectionPolicy.html#setKeyboardSelectionPolicy%28com.google.gwt.user.cellview.client.HasKeyboardSelectionPolicy.KeyboardSelectionPolicy%29)

# java - Fedex 使用 Java 将标签打印到热敏打印机

> ID：10454437
> 
> 赞同：1
> 
> 时间：2012-05-04T18:43:38.380
> 
> 标签：java, fedex, thermal-printer

我正在使用 Fedex 运送 Web 服务来创建货件。我正在使用热敏打印机打印标签 (Java)。

首先我想知道打印到 ZLPII 打印机的 STOCKTYPE 应该是什么，下面是第二个问题。

当打印到打印机并且空标签出来但没有打印时，当我用来打印到 PDF 时它工作得很好。

这是我的 Java 代码

```
PrintService pss[] = PrintServiceLookup.lookupPrintServices(DocFlavor.INPUT_STREAM.AUTOSENSE, null);
if (pss.length == 0)
    System.out.println("FedExSmartPostServiceImpl::saveLabelToFile No printer services available.");

PrintService ps = null;
for (PrintService ps1 : pss) {
    if (ps1.getName().indexOf("Zebra") >= 0) {
        ps = ps1;
        break;
    }
}
System.out.println("FedExSmartPostServiceImpl::saveLabelToFile Printing to " + ps);
DocPrintJob job = ps.createPrintJob();
Doc doc = new SimpleDoc(fis, DocFlavor.INPUT_STREAM.AUTOSENSE, null);
job.print(doc, null);
fis.close(); 
```

我在这里先向您的帮助表示感谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-07T18:40:09.830

我可以使用与上面几乎相同的代码来打印标签，只需将 SimpleDoc 更改如下，而不是使用 FileInputStream。

```
Doc doc = new SimpleDoc(byteArr, DocFlavor.BYTE_ARRAY.AUTOSENSE, null); 
```

希望这可以帮助。

# ruby-on-rails - 如何在 Rails 中处理带有陈旧 CSRF 真实性令牌的页面

> ID：10454440
> 
> 赞同：7
> 
> 时间：2012-05-04T18:44:03.523
> 
> 标签：ruby-on-rails, session, csrf

在我们的 Rails 应用程序中，用户通常会一次打开多个浏览器选项卡数小时或数天。当在这些选项卡之一中，用户注销然后重新登录（或会话到期并创建新会话）时，就会出现问题。

这会导致所有其他选项卡上的 CSRF 真实性令牌变得无效。如果他们尝试提交任何表单或在这些选项卡上发出任何 ajax 请求而不刷新，他们将得到一个错误（实际上会被注销，因为这是传递错误真实性令牌时的默认 Rails 行为）。

这种行为显然是不可取的。我想知道人们如何优雅地处理用户打开您网站的窗口但真实性令牌已过期的情况。

我不想做的只是将他们重定向到登录页面，因为那样他们可能会丢失他们的工作，例如，如果他们一直在写一篇很长的博客文章或其他东西。

想到的解决方案是使用一些 javascript 来轮询服务器以检查真实性令牌是否已更改，或轮询用户的 cookie 以检查会话是否已更改。我从来没有听说过有人这样做，所以我想看看社区是怎么想的。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-04T19:03:54.780

首先：登录/注销/登录不会导致出现新的 csrf-token。它仍然会保存在用户的 cookie 中。下次它通过同一个浏览器登录时，它会得到相同的令牌。

在最新版本的 Rails 中，在令牌不正确的情况下不会抛出错误：所有 Rails 都会做——只是在将会话传递给控制器​​之前重置会话。

所以，更新你的 Rails，你会少一点痛苦。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-04T19:07:50.183

您确定您在谈论 CSRF 令牌而不是会话令牌吗？在 CSRF 令牌不匹配时重定向到登录根本没有任何意义。你只是告诉用户重复他试图做的任何事情。（在传统的 Web 应用程序中，这通常在提交表单时出现；您可以将 CSRF 不匹配视为验证错误，并再次显示表单，保留所有字段值，并要求用户重新提交。在更多的 AJAX - 重型应用程序，您可以在响应中使用某种通用 CSRF 标志，如果已设置，请用户再次执行他所做的任何事情（按下按钮等），甚至可以在不打扰用户的情况下自动化整个事情。

# jsp - 将地图从spring上下文传递到webflow jsp

> ID：10454442
> 
> 赞同：0
> 
> 时间：2012-05-04T18:44:11.867
> 
> 标签：jsp, spring-webflow

我有一张地图，有点像在我的 spring 上下文文件中定义的。

```
<util:map id="myMap">
  <entry key="key1" value="myValue"/>
</util:map> 
```

我想从我的 JSP 在这样的 webflow 中访问它

```
<c:forEach var="item" items="${myMap}">
 <div>
  <c:out value="${item.key}"/>
 <div>
</c:forEach> 
```

我怎么做？我在 spring 上下文中定义地图，但它没有在 webflow 中被拾取。

如果我将它放在常规的 java 视图控制器中，它工作得很好，但是 Webflow 有一个处理视图状态的 XML 文件，我不知道如何将变量传递到视图状态之外。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-01T18:17:41.840

这种方法与 WebFlow 无关，但如果地图打算成为全局单例，您可以使用[org.springframework.web.context.support.ServletContextAttributeExporter](http://static.springsource.org/spring/docs/3.0.x/javadoc-api/org/springframework/web/context/support/ServletContextAttributeExporter.html)将 Spring bean 放到“Application Scope”（又名 ServletContext）上。

如果您这样做，任何 JSP 都可以像您发布的那样通过 EL 访问它。

```
<bean class="org.springframework.web.context.support.ServletContextAttributeExporter">
    <property name="attributes">
        <map>
            <entry key="myMap" value-ref="myMap"/>
        </map>
    </property>
</bean> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-12T19:58:53.353

在您希望访问此地图的视图状态下，您可以设置一个范围变量以在页面中访问。请求范围可能在这里最有意义；它仅在此特定查看请求期间的范围内。您设置的*值*将是您要迭代的该映射的 bean id。（或者，它也可以是 bean 上的方法的输出。）

```
<view-state id="someState" view="viewName">
    <on-render>
        <set name="requestScope.myMap" value="myMap"/>
    </on-render>
</view-state> 
```

我建议查看 spring web flow 文档以获取更多关于各种范围（flash、flow 等）和不同事件（on-render、on-entry 等）的示例

# multithreading - 通过网络对事件进行排序（网络化回合制游戏）

> ID：10454445
> 
> 赞同：6
> 
> 时间：2012-05-04T18:44:17.660
> 
> 标签：multithreading, sockets, networking, haskell, semaphore

我对 haskell 网络（以及一般的点对点通信）相当陌生，并且正在寻找一种玩家对玩家的网络刽子手游戏，类似于流行的“与朋友一起玩”。在学习了包括 haskell.org 的“实现聊天服务器”在内的一些教程之后，我能够成功地创建一个服务器并将套接字连接到套接字，然后将消息弹回第四次。

我还有一个刽子手客户端，当给定预先确定的输入时，它会按预期播放。

但是，我在连接的客户端之间遇到了排序事件的问题。因为对套接字通道的读取和写入发生在不同的线程上（由于 readChan 和 writeChan 的阻塞性质），我不确定如何在远程终端之间对操作进行排序。我知道我想要什么，只是不知道如何到达那里：

1.  一旦第二个用户连接，调用“发送”功能，提示他们输入第一个玩家的输入词
2.  玩家 1 通过“recieve”函数接收到这个词，如果它不是命令关键字（加入、退出、结果），则使用提供的词运行刽子手游戏。与此同时，玩家 2 的屏幕被阻塞，等待玩家 1 完成。
3.  玩家 1 结束。他的结果被记录下来，然后为他调用“发送”函数，提示他输入以玩游戏。
4.  重复 2-3 直到玩家退出。

我已经通过几种方式解决了这个问题。我比较成功的方法之一是通过阻塞信号量。我曾想过在轮到“控制”播放器时使用 MVar。它在第一回合正确运行，但此后退化为乱码。通道内信号量的概念（本质上是一个 MVar，因为它也被阻塞了）真的让我很头疼。由于它确实阻塞，因此也很难调试。

我对信号量的了解有点动摇。我这样做的方式是否有意义？

该代码可以在 bitbucket 存储库中找到。以下是获取正确代码/分支所需的步骤：

```
git clone git@bitbucket.org:ndisidore/haskell-hangman.git
git checkout block-sem 
```

或[在这里在线查看](https://bitbucket.org/ndisidore/haskell-hangman/src/7877047bdf34)。

跑步：`runhaskell NetInterface.hs`

这将创建一个侦听端口 3468 的套接字

要作为客户端/播放器连接，请打开一个单独的终端并运行“telnet localhost 3468”。这需要进行两次，每个玩家一次。

提前致谢。

# javascript - 如何向动态创建的 DOM 对象添加文本？

> ID：10454450
> 
> 赞同：0
> 
> 时间：2012-05-04T18:44:44.753
> 
> 标签：javascript, jquery

假设我有两个按钮“添加链接”和“添加文本”。“添加链接”按钮会自动将以下内容附加到现有页面：

```
<a href="text.html"></a> 
```

当我单击“添加文本”按钮时，创建的所有动态链接的文本都应包含文本“文本”。

我最初使用 "$("a").text("Text")" 作为“添加文本”按钮的功能，但它不起作用，因为链接是在用户单击“添加链接”按钮时动态创建的.

如何使我可以将“文本”放入所有动态创建的链接？

注意：像这样的东西

```
$('buttonforaddtext').live('click', function() {
    $("a").text("Text");
}); 
```

对我不起作用，因为该按钮一直都在那里，它是通过单击“添加链接”按钮动态创建的“a”。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-04T18:48:25.627

```
$('button').on('click', function() {
   /* your code */
}); 
```

如果你有动态对象，你需要使用`.on()`它来让它工作......

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-04T18:51:25.423

正如我在评论中提到的那样尝试如下，

```
$('#addLink').on('click', function () {
    $(body).append('<a href="' + someURL + '" class="newLink"></a>');
});

$('#addText').on('click', function () {
    $('a.newLink').text('New Link'); 
}); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-04T18:48:20.897

```
var yourLink = $("<a href="+someURL+">"+yourText+"</a>"); 
```

或者

```
var yourLink = $("<a href="+someURL+"/>");
yourLink.html("Text"); 
```

然后

```
yourLink.appendTo($('body')); 
```

那就是如果你想同时创建@

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-04T18:49:30.827

你描述的对我来说听起来不错。也许您应该发布您正在使用的代码。以下应该工作：

```
$('#addLink').click(function(){
    $('body').append('<a href="text.html"></a>');
});

$('#addText').click(function(){
    $('a').text('Text');
}); 
```

只要在单击事件发生后创建您的 jQuery 对象 ($('a'))，一切都应该按照您的描述工作。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-05-04T18:56:45.550

正如我们同事之前所说，您需要使用“.live”方法。碰巧在您尝试绑定事件的那一刻，该元素不存在并且它不起作用。

使用 .live，窗口将继续侦听您选择的元素。

如果您使用的是 jQuery 1.7.+，我建议您使用 .on() 方法绑定事件，并在您不再需要它时使用 .off() 解除绑定...

PS.：顺便问一下，你想选择什么？

```
$('buttonforaddtext') 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-05-04T19:02:56.190

您的问题可能是 live 已被弃用，或者您没有您认为拥有的 HTML。由于您在回调中重新查询 A 标记以进行文本插入，并且按钮是静态 HTML，因此您不需要“live”或“delegate”或“on”。只需做一个简单的 .click

# jquery - RoR 使用链式选择 jQuery 插件

> ID：10454452
> 
> 赞同：1
> 
> 时间：2012-05-04T18:44:57.877
> 
> 标签：jquery, ruby-on-rails

我正在尝试使用 jQuery 链式选择。这是所需的 HTML 示例（不是我正在使用的代码 - 但是，它将让您了解 jquery 如何要求 HTML 看起来）：

```
<select id="mark">
  <option value="">--</option>
  <option value="bmw">BMW</option>
  <option value="audi">Audi</option>
</select>
<select id="series">
  <option value="">--</option>
  <option value="series-3" class="bmw">3 series</option>
  <option value="series-5" class="bmw">5 series</option>
  <option value="series-6" class="bmw">6 series</option>
  <option value="a3" class="audi">A3</option>
  <option value="a4" class="audi">A4</option>
  <option value="a5" class="audi">A5</option> 
```

我的 RoR 应用程序有客户、项目和任务我需要任务选项中的类来包含 project.id

现在我正在使用 Simple-Form，代码如下所示：

```
<%= collection_select(:project, :projname, Project.all, :id, :client_project, {}, {:class=>'project_select'}) %>
<%= f.association :task, :label_method => :taskname, :label => 'Task' %> 
```

该集合列出了项目（我已将客户端连接到项目）。所以 HTML 的第一部分很好。

但是，如何获取关联代码以使用 project.id 作为每个任务的类？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-11-07T20:40:40.850

我偶然发现了你的问题，我知道它已经过时了，但我已经通过`simple-form`以下方式解决了这个问题：

```
= form.input :task do
    = form.select :task_id, Task.all.map { |t| [t.taskname, t.id, { :class => t.project_id }] }, :include_blank => true 
```

本质上，您使用 simple_form 包装器`input`，但定义了一些自定义 HTML 以在包装器中使用（在本例中，它使用 Rails`select`表单帮助器）。Rails 助手允许您按照@pduersteler 的回答通过课程。

如果不清楚，我会在我的观点中使用 HAML :)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-04T22:11:41.517

一种可能性是使用帮助器`select`代替`collection_select`并将您的集合传递给。使用允许将 html 作为第三个属性传递。见这里：[http ://api.rubyonrails.org/classes/ActionView/Helpers/FormOptionsHelper.html#method-i-options_for_select](http://api.rubyonrails.org/classes/ActionView/Helpers/FormOptionsHelper.html#method-i-options_for_select)`select``options_for_select``options_for_select`

控制器：`@projects = Project.all.map{ |p| [p.projname, p.id, {:class => p.id}] }`
视图：`select(:project, :projname, options_for_select(@projects), {:class=>'project_select'})`

**未经测试，可能需要修改**

# php - 使用 php 在外部服务器上编辑文件

> ID：10454454
> 
> 赞同：-1
> 
> 时间：2012-05-04T18:45:08.917
> 
> 标签：php

我正在尝试编辑外部文件。我已经更改了文件的 chmods (666)，我可以使用 file_get_contents 读取文件，但我无法放置内容：

> [function.file-put-contents]：无法打开流：HTTP 包装器不支持可写连接

我该如何解决这个问题？

有没有办法在外部服务器上编辑文件？也许你可以提出更好的方法

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-04T19:06:42.527

将外部服务器上的文件 CHMOD 到 0777，然后可以在外部更改它们：

```
<?php
chmod("/somedir/somefile", 0777);
?> 
```

然后用于编辑：

```
<?php
$file = fopen ("ftp://login:password@server", "w");

if (!$file) {
  echo "<p>Unable to open remote file for writing.\n";
  exit;
}

/* Write the data here. */
fwrite ($file, "blablabla");
fclose ($file);
?> 
```

请注意，这可能会造成重大的安全风险。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-04T19:15:56.337

[检查http://us.php.net/manual/en/function.file-put-contents.php](http://us.php.net/manual/en/function.file-put-contents.php)的“注释”部分，了解有关使用 URL 文件规范编写文件的一些线索。tl;dr：不像通过 file_get_contents() 读取远程文件那么容易让你相信。

但是，从安全的角度来看，这是一个坏主意。几个稍微好一点的想法：

1.  检查 ssh2_scp_send 并将本地更改的文件副本 scp 到远程服务器。这可能涉及通过您的操作系统供应商安装 SSH2 PECL 扩展（例如，将它们安装在 'apt' 用于 Debian 类型的 Linux 机器，'yum' 用于 Red Hat 等，或类似的）或从 PECL。

2.  POST 到远程服务器上的脚本并让它为您更新文件。

# asp.net-mvc - MVC 3 远程验证字段具有复杂的名称

> ID：10454458
> 
> 赞同：5
> 
> 时间：2012-05-04T18:45:21.820
> 
> 标签：asp.net-mvc, validation

我有一个输入

```
@Html.TextBoxFor(m => m.Buyer.Email, new { @maxlength = "100" }) 
```

我想用远程属性验证它

```
[Remote("IsUserNameAvailable", "Validation")]        
public string Email { get; set; } 
```

在验证控制器中，我有一个动作：

```
[HttpPost]
public JsonResult IsUserNameAvailable(string Email) 
```

但是，当然我在电子邮件参数中得到一个空值。我应该将什么参数名称传递给 IsUserNameAvailable 方法？

更新：刚刚查看了发送到远程验证操作的请求： [http://myhost/Validation/IsUserNameAvailable?Buyer.Email=test@test.test](http://myhost/Validation/IsUserNameAvailable?Buyer.Email=test@test.test) 参数名称是 Buyer.Email，我应该如何将它传递给函数？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-04T19:15:42.760

代替 HttpPost 使用 HttpGet。你没有发布任何东西。您正在检索结果。其次，确保当您从 IsUserNameAvailable 返回结果时指定您允许 JSON 获取。

```
[HttpGet]
public JsonResult IsUserNameAvailable(string Email)
{
    // Do something
    if (your_email_check_returns_true)
    {
        return Json(true, JsonRequestBehavior.AllowGet);
    }

    return Json(false, JsonRequestBehavior.AllowGet);
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-05T14:19:12.187

由于您不能将字符串属性命名为“Buyer.email”，这应该可以工作......如果您希望控制器中有“买家”视图模型并让 ModelBinder 填充买家电子邮件属性怎么办？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-09-04T19:54:53.143

尝试更改您的操作签名以包含绑定前缀：

```
public JsonResult IsUserNameAvailable([Bind (Prefix="Buyer.") ] string Email) 
```

# php - 当我发送 $_GET 查询时，“%deb%”显示为“�b%”？

> ID：10454459
> 
> 赞同：-1
> 
> 时间：2012-05-04T18:45:22.230
> 
> 标签：php, html, sql, css

我正在根据用户输入在搜索页面上构建查询，然后将查询发送到原始页面并使用它来查询数据库。

当用户在搜索字段中输入“deb”时，结果页面上的查询显示“�b%”代替 Deb。我不知道为什么会这样。我正在使用 LIKE 和 UNION 两个表，但它适用于所有其他值。

'%de' 是保留字符还是什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-04T18:47:14.690

听起来 URL 编码正在进行中，您需要传递 %25deb%25。%25 是百分号的代码

# iphone - 只有纵向模式的 iPhone 应用程序

> ID：10454461
> 
> 赞同：1
> 
> 时间：2012-05-04T18:45:30.577
> 
> 标签：iphone, objective-c

我怎样才能让我的应用程序始终处于纵向模式。如果我旋转 iPhone，它不应该以横向模式显示应用程序。

```
- (BOOL)shouldAutorotateToInterfaceOrientation:(UIInterfaceOrientation)interfaceOrientation
{
// Return YES for supported orientations
return (interfaceOrientation != UIInterfaceOrientationPortrait);

return YES;
} 
```

在我旋转 iPhone 应用程序时以横向模式显示此编码后。我怎样才能让应用程序一直处于纵向模式。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-05-04T18:47:56.347

删除方法——你不需要它。iPhone 应用程序始终以纵向模式启动，除非您强制它以横向模式启动。如果没有此方法，它将保持纵向模式，因为它实际上意味着“我的视图不会响应界面方向的变化”。

顺便说一句，这个方法实际上一开始在 Xcode 的视图控制器模板中被注释掉了，这和它根本不存在是一样的。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-05-04T18:48:50.773

在 xcode 中单击项目名称的左上角，然后单击“目标”的右下方，您可以设置“支持的设备方向”。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-06T10:08:48.967

似乎对于 iOS 6，您需要覆盖此方法，

```
-(BOOL)shouldAutorotate {
    return NO;
} 
```

# facebook-graph-api - 为什么我得到一个空的数据响应？

> ID：10454464
> 
> 赞同：0
> 
> 时间：2012-05-04T18:45:39.670
> 
> 标签：facebook-graph-api

过去我已经让内置的读取操作起作用，但现在它不起作用。我还创建了一个不起作用的自定义操作。

当我尝试将操作发布到此网址时： [https ://graph.facebook.com/me/teamtutorials:complete?access_token=AAACOYImsskcBAGlF33o6awIqxmQ078BVdHUY72CF7GUqTHUhEcpKLdH8ZCKeyQbBqBDlnHwUMwt5aLOzpBmiWQqpvWsNAeHDMPSo2OQZDZDZD&tutorial/tutorials/teamtutorials.comzen-Zen-tutorial/tutorialstutorials.com - 是一个很棒的节省时间的方法](https://graph.facebook.com/me/teamtutorials:complete?access_token=AAACOYImsskcBAGlF33o6awIqxmQ078BVdHUY72CF7GUqTHUhEcpKLdH8ZCKeyQbBqBDlnHwUMwt5aLOzpBmiWQqpvWsNAeHDMPSo2OQZDZD&tutorial=http://teamtutorials.com/web-development-tutorials/why-zen-coding-is-an-awesome-time-saver)吗？

我得到的回应是：

```
{
   "data": [

   ],
   "paging": {
      "next": "https://graph.facebook.com/me/teamtutorials:complete?access_token=AAACOYImsskcBAGlF33o6awIqxmQ078BVdHUY72CF7GUqTHUhEcpKLdH8ZCKeyQbBqBDlnHwUMwt5aLOzpBmiWQqpvWsNAeHDMPSo2OQZDZD&tutorial=http\u00253A\u00252F\u00252Fteamtutorials.com\u00252Fweb-development-tutorials\u00252Fwhy-zen-coding-is-an-awesome-time-saver\u00253F&offset=25&limit=25"
   }
} 
```

是什么导致了这种类型的反应？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-04T19:16:19.437

这看起来就像您对 HTTP GET 请求的响应；您需要发出 HTTP POST 请求来创建新操作

如果您的代码/代理无法发出 POST 请求，或者您可以通过发出 GET 请求并包含额外参数来伪造它`&method=post`

# clickbank - Clickbank api 获取收据信息

> ID：10454465
> 
> 赞同：5
> 
> 时间：2012-05-04T18:45:42.490
> 
> 标签：clickbank

我尝试为 clickbank 创建一个小类，它从 clickbank 获取收据信息。我想，这可能对某人有帮助。在函数 get_payment_info($tries, $receipt) 中使用了尝试，因为 clickbank 不会在交易发生后立即识别交易。

```
<?php

define('CLICKBANK_DEV_KEY','DEV-KEY');
define('CLICKBANK_API_KEY','API-KEY');

Class ClickBank
{
    /*
     * $tries   how many times to check for receipt
     *          because when you come back from clicbank it sometimes shows it invalid
     *          
     * $receipt 
     * 
     * @return  empty array if receipt not valid
     *          receipt info array if receipt is valid 
     */
    function get_payment_info($tries, $receipt){
        $receipt_info = array();
        while($tries>0 && count($receipt_info)==0){
            $receipt_info = $this->get_receipt_info($receipt);
            $tries--;   
        }
        return $receipt_info;
    }

    function get_receipt_info($receipt){
        $receipt_info = array();
        $ch = curl_init();
        curl_setopt($ch, CURLOPT_URL, "https://api.clickbank.com/rest/1.2/orders/$receipt");
        curl_setopt($ch, CURLOPT_HEADER, false); 
        //curl_setopt($ch, CURLOPT_GET, true);
        curl_setopt($ch, CURLOPT_RETURNTRANSFER, true);
        curl_setopt($ch, CURLOPT_SSL_VERIFYPEER, false);
        curl_setopt($ch, CURLOPT_HTTPHEADER, array("Accept: application/json", "Authorization:".CLICKBANK_DEV_KEY.":".CLICKBANK_API_KEY));
        $result = curl_exec($ch);
        $curl_info = curl_getinfo($ch);
        curl_close($ch);

        if($curl_info['http_code']==200){
            $receipt_info = json_decode($result);           
        }

        return $receipt_info;
    }
}

$clickbank = new ClickBank();

$receipt = $_GET['cbreceipt'];

// it will return you transaction details
$transaction_info = $clickbank->get_payment_info(10, $receipt); 
```

# php - 使用 apache mod_throttle 限制下载速度

> ID：10454466
> 
> 赞同：1
> 
> 时间：2012-05-04T18:45:49.370
> 
> 标签：php, apache

我想限制我网站中每次下载的下载速度。

我安装了 mod_throttle，但我找不到如何限制每个文件的带宽。

例如，以最大速度限制每次下载 - 1000KB/s

这需要什么配置？

# google-app-engine - Google App Engine HRD - 如果我超过每秒写入 1 次写入实体组的限制怎么办？

> ID：10454467
> 
> 赞同：8
> 
> 时间：2012-05-04T18:46:01.493
> 
> 标签：google-app-engine, google-cloud-datastore

根据 Google App Engine 文档，在使用 High Replication Datastore 时，写入一个实体组被限制为每秒一次写入。所以...

1.  如果我超过这个限制会发生什么？某种异常？我该怎么办？
2.  我怎么知道我快要超过这个限制了？我可以以特定操作（添加实体......）不太可能经常发生的方式设计应用程序，但我自然不能保证。

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2012-05-04T21:22:40.820

根据 GAE 文档和我有限的经验：

1.  期望像 1 QPS 速率并相应地调整您的应用程序。
2.  [分片](http://en.wikipedia.org/wiki/Sharding)是处理数据存储争用的常见模式。
3.  始终添加防御性代码来处理所有可能的异常 ( `Application Error 5, The datastore operation timed out, Transaction collision for entity group`, ..)
4.  如果出现错误，请重试将任务移动到适当的任务队列中，或者，如果可以，请提醒用户重试。
5.  重试写入，*通常*有效。
6.  如果可能，请使用后写缓存机制将可能导致争用的写入操作移动到[Memcache](https://developers.google.com/appengine/docs/python/memcache/usingmemcache)和降低数据存储命中率的[任务队列。](https://developers.google.com/appengine/docs/python/taskqueue/)
7.  避免争用的一个好方法是保持实体组较小，但不要过分依赖它。
8.  您甚至可以在单个实体上发生争用。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2012-05-04T19:09:32.013

每秒写一次有点低。它实际上支持的不止这些。我什至会说每秒写入 5 到 10 次，但我当然不能保证。

如果你达到这个限制，你会得到一个例外是的。异常消息将是：
`Too much contention on these datastore entities. please try again.`

但我不知道/记得会引发的确切异常。

您可以选择重试、继续或此时您认为正确的任何其他方式。

您无法判断您是否接近每秒 1 次写入的限制。它发生了，你处理它。

# java - Eclipse 4.2 和 Java 8

> ID：10454470
> 
> 赞同：3
> 
> 时间：2012-05-04T18:46:28.360
> 
> 标签：java, eclipse, closures, java-8

我发现这个[页面](http://www.eclipse.org/eclipse/development/plans/eclipse_project_plan_4_2.xml)说明 Java 8 对 Juno 的支持被推迟了，但是我找不到更多信息，人们可以期望多久能够在 Eclipse 中编写第一个闭包并使用这些东西变得富有成效。

有人知道我们还要等多久吗？Java7 的特性很快就出现在 3.7 中，这就是为什么推迟这项任务有点奇怪。

有什么意见、想法吗？或者甚至是一个很好的解决方法？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-05-04T19:00:30.127

Java 8 支持被推迟的关键原因之一是 Java 8 将在 Eclipse Juno 发布后可用。Eclipse 的主要版本无法提供依赖于未完成 Java 版本的功能。

Java 7 支持在 Eclipse Indigo 中遇到了类似的问题。Java 7 的工具在 Java 7 发布后合并到主要 indigo 流中的一个分支中进行，因此您在 Indigo SR1 中看到了工具支持。

我预计 Java 8 也会出现类似的情况。可能已经为这项工作开放了一个分支。检查状态的最佳位置是在您找到的文档中引用的错误中。

[https://bugs.eclipse.org/bugs/show_bug.cgi?id=380190](https://bugs.eclipse.org/bugs/show_bug.cgi?id=380190)

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-05-04T19:09:25.323

Java 8 将在 2013 年中之后的某个时间发布，所以还有相当长的时间要走 :-) 在 Java 8 发布日期之前，不应期望 Eclipse 完全支持 Java 8，Java 7 支持也是如此。

目前，没有为这项工作开放的分支机构。但是，无论何时发生这种情况，您都可以期待看到一些关于它的博客文章 :-)

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-10-14T15:52:03.817

你可以试试 IntelliJ Idea，它有初步的支持，见[http://confluence.jetbrains.com/display/IDEADEV/IDEA+12+EAP](http://confluence.jetbrains.com/display/IDEADEV/IDEA+12+EAP)

# php - 在 Apache 中运行 PHP

> ID：10454473
> 
> 赞同：2
> 
> 时间：2012-05-04T18:46:35.283
> 
> 标签：php

我是 PHP 的新手，并试图在 apache 网络服务器中运行此代码，但由于某种原因它没有运行。

该文件保存在 htdocs info.php 下。当我运行时，根本没有任何动作。事实上，它会打开下载窗口。

任何帮助表示赞赏

php代码：

```
<?php
    date_default_timezone_set('America/Los_Angeles');
    echo date("F j, Y, g:i:s a");
?> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-04T19:37:26.747

我不知道您安装 Web 服务器采取了哪些步骤，但您是否安装了 PHP 并配置了 Apache 以使用它？

如果配置不是主要优先级而 PHP 编程是，那么只需下载 WAMP。这是一个带有 PHP、PHPmyAdmin 和 MySQL 的 Apache 网络服务器，已经配置好并准备就绪。

下载地址：[http ://www.wampserver.com/en/](http://www.wampserver.com/en/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-04T19:41:04.240

虽然我很少推荐使用“一体式”XAMP 包，但对于初学者，我确实例外。

[在这种情况下，简单地下载和使用XAMPP](http://www.apachefriends.org/en/xampp.html)会更容易，而不是挑剔现有 Web 服务器上可能配置错误的内容。

# jsf-2 - JSF 2.0 - 如果用户未登录，则检查和重定向

> ID：10454477
> 
> 赞同：0
> 
> 时间：2012-05-04T18:46:55.490
> 
> 标签：jsf-2

我已经实现了一个 servlet 过滤器，它检查用户是否登录，如果没有，则将用户重定向到登录页面。我将此检查作为过滤器的原因是登录页面存在于另一个 web 应用程序中，我似乎无法重定向到使用 web.xml 的 FROM auth-method 重定向到具有不同上下文根的不同 web 应用程序中的页面（注意，我使用的是 weblogic 11g）。

我遇到的问题是，当我有一个 ajaxified 组件（如按钮）时，servlet 过滤器无法重定向用户。即他们回到他们所在的页面上。

我应该以不同的方式进行此登录检查吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-04T19:34:48.937

我将 servlet 过滤器重新实现为在 RESTORE_VIEW 阶段之前运行的 JSF 2.0 阶段侦听器。通过将逻辑移到 Phase Listener 中，我能够利用 JSF 处理 AJAX 请求重定向的能力。基本上，JSF 2.0 将创建正确的 AJAX 响应以在客户端引起重定向。需要明确的是，如果用户未登录，此机制能够对 AJAX 和非 AJAX 请求进行重定向。

具体来说，它将发回以下响应：

```
<?xml version="1.0" encoding="utf-8"?>
<partial-response>
  <redirect url="/contextpath/faces/ajax/redirecttarget.xhtml">
  </redirect>
</partial-response>" 
```

相位监听器的代码：

```
public PhaseId getPhaseId() 
{
    return PhaseId.RESTORE_VIEW;
}

public void afterPhase(PhaseEvent event) 
{
    ExternalContext ec = FacesContext.getCurrentInstance().getExternalContext();
    HttpSession session = (HttpSession)ec.getSession(false);

    if (session==null || session.getAttribute(IS_LOGGED_IN_INDICATOR) == null) 
    {
        try
        {
            ec.redirect(LOGIN_PAGE_URL);
        }
        catch(IOException e)
        {
            // log exception...
        }           
    }
} 
```

# php - PHP Toolkit / Easycom 给 iSeries 消息

> ID：10454481
> 
> 赞同：0
> 
> 时间：2012-05-04T18:47:03.447
> 
> 标签：php, zend-framework, ibm-midrange, toolkit, zend-server

我们有 PHP 和 Zend Server，在 iSeries 上运行。

我们的 iSeries 是 v6r1m1。我们的 Zend Server 版本是 5.6.0。我们的 PHP 版本是 5.2.17。

当使用 PHP Toolkit 类中的 i5_Connection 和 i5_Program 时，我们的操作员消息中会显示以下消息，并且需要“I”作为响应答案。 **EASYCOM for PHP - IBM i 的 PHP 工具包 - 支持和更新，免费注册：[http](http://www.easycom-aura.com) ://www.easycom-aura.com (I)**

我们究竟需要做什么才能停止收到此消息？

我在消息中列出的网站上看到： **Easycom For PHP，Evaluation
Native access to iSeries - AS/400 数据库和来自 Internet 应用程序的程序。Easycom For PHP 兼容 PHP 4 和 5**

但是，它说的是“评估”。这只会在一段时间内有效吗？那么我们需要购买一些东西吗？

如果有人熟悉这一点，我会感谢任何帮助或建议。

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-04T19:42:20.327

在供应商提供的解决方案之外，您可以让系统自动回复消息。

1.  确定正在生成的回复消息的消息 ID。
2.  使用该`WRKRPYLE`命令确定未使用的回复列表条目序列号。
3.  使用该`ADDRPYLE SEQNBR(?) MSGID(?) RPY(I)`命令添加默认回复。替换`?`为适当的序列号和消息 ID。

请注意，如果消息 ID 是通用消息，例如`CPF9898`您可以添加比较数据以确保只回答此特定消息。例如：`CMPDTA(EASYCOM 1)`。

# wpf - WPF 子菜单项在左侧而不是右侧打开

> ID：10454482
> 
> 赞同：6
> 
> 时间：2012-05-04T18:47:09.343
> 
> 标签：wpf, .net-4.0, menuitem

我已经设置了一个简单的示例菜单。

```
<Menu>
  <MenuItem Header="Top Menu">
    <MenuItem Header="Item 1">
      <MenuItem Header="Sub Menu 2" />
    </MenuItem>
  </MenuItem>
</Menu> 
```

子菜单 2 在左侧而不是预期的菜单右侧打开。如果菜单靠近屏幕边缘，但窗口位于屏幕中心而不靠近任何边缘，我会期待这种行为。

是否有一个属性可以控制 a`MenuItem`在屏幕上的打开位置？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-05-04T20:30:45.187

这是否也发生在您系统上的其他应用程序上？

`MenuDropAlignment`键中的值中有一个注册表设置，`HKEY_CURRENT_USER\Software\Microsoft\Windows NT\CurrentVersion\Windows`可以在系统范围内控制它。您可能只是检查以确保它设置为 0 而不是 1。

更多信息可以[在这篇文章](http://www.sevenforums.com/tutorials/786-menus-open-left-right-side.html)中找到。

# function - PostgreSQL UPSERT 触发器返回 id

> ID：10454485
> 
> 赞同：1
> 
> 时间：2012-05-04T18:47:15.453
> 
> 标签：function, postgresql, triggers, plpgsql, upsert

我`UPSERT`在执行插入操作时可能会更新而不是插入的表上有一个触发器。我已经在该表上执行插入功能，`returning id`但是它在更新而不是插入时不会返回 id。我想在这两种情况下都得到 id。

触发代码

```
perform 1 from tera_subject 
where id = new.subject_id and owner = new.user_id;

if found then
   return null;
else
   select id into vote_id from tera_votes where 
  user_id = new.user_id and
  subject_id = new.subject_id;
   if not found then
  return new;
   else
      -- raise notice 'vote_id: % ; vote: %',vote_id,new.vote;
      if(tg_op = 'INSERT') then
          begin
          -- raise notice 'redirecting to update';
          update tera_votes
              set vote=new.vote
              WHERE id = vote_id;
          end;
      elsif(tg_op = 'UPDATE') then
          -- raise notice 'in update';
          return new;
      end if;
      -- raise notice 'end of trigger %',tg_op;
      return null;
   end if;
end if;
end; 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-04T19:28:34.950

我不认为你会设法让触发器“返回”任何东西。

你在里面做的是：

*   根据您的情况运行更新；
*   抑制`INSERT`触发触发器的语句。

这意味着，它`INSERT`以一种简单的方式终止（无一例外），但这也意味着不可能为您提供任何细节，因为触发器函数不返回任何值。

如果您需要获得 UPSERT 项目的 ID，请考虑使用始终返回 ID 的函数，例如[这个](http://www.postgresql.org/docs/current/interactive/plpgsql-control-structures.html#PLPGSQL-UPSERT-EXAMPLE)。

# trigger.io - trigger.io 页面（不是标签页）中是否允许使用 iframe 标记？

> ID：10454486
> 
> 赞同：1
> 
> 时间：2012-05-04T18:47:40.950
> 
> 标签：trigger.io

trigger.io 页面（不是标签页）中是否允许使用 iframe 标记？

例如，

```
<iframe src="http://www.facebook.com/plugins/comments.php?href=example.com&permalink=1" scrolling="no" frameborder="0" style="border:none; overflow:hidden; width:130px; height:16px;" allowTransparency="true"></iframe> 
```

我已经尝试过上面的语句，但不是在页面内显示内容（例如，实时评论数），而是打开了一个新的浏览器。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-05T16:31:26.857

答案在某种程度上取决于特定的设备。

在 iOS 上，在 iframe 中获取外部 HTML 页面（即不是应用程序本身的一部分）被视为一个单独的页面加载，我们将其交给底层设备。Android 上的情况并非如此——我们将来会使其更加一致，但通过将 Android 移向 iOS 的行为，而不是相反。

一般来说，我们不希望您的用户以这种方式与网页交互：如果他们要离开您的应用程序以使用外部网站，我们建议使用`forge.tabs.open`or `forge.tabs.openWithOptions`( [docs](http://docs.trigger.io/en/v1.3/modules/tabs.html) ) 明确这一点。

请注意，Apple 指南中有明确的措辞禁止将外部网站简单地显示为应用程序！

# ruby-on-rails - VBA Heroku 集成？

> ID：10454499
> 
> 赞同：2
> 
> 时间：2012-05-04T18:48:34.533
> 
> 标签：ruby-on-rails, heroku, excel, rails-postgresql, vba

我想知道将 Excel VBA 应用程序连接到 Heroku Ruby on Rails 应用程序后面的托管数据库可能涉及什么。这可能吗？我的应用程序无法仅在云中完成我需要的所有功能。VBA 应用程序将用作系统的一部分来打印和编码接近“智能”卡。感谢您提供有关如何最好地实施这一点的任何和所有提示。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-04T19:31:32.317

此处的选项数量取决于您想要连接的方式。我会考虑在您的 Heroku 应用程序中公开一个您的 VBA 可以使用的 API（如果可能的话）。

做不到这一点；

1.  目前的共享数据库不允许您直接连接到数据库，所以这是不行的。

2.  新的 beta 共享 postgres 9.1 (https://postgres.heroku.com/blog/past/2012/4/26/heroku_postgres_development_plan/) 将让您从外部连接到它。

3.  使用 Heroku DB 插件提供程序之一，例如 ClearDB，它是一个允许直接访问数据库的 mySQL 提供程序。

4.  带上您自己的数据库，您可以将其托管在外部服务器上，并将您的 Heroku 应用程序连接到它（注意延迟），然后您可以将打印应用程序直接连接到该数据库。

# bash - 为什么函数中的“getopts”不起作用？

> ID：10454501
> 
> 赞同：13
> 
> 时间：2012-05-04T18:48:44.117
> 
> 标签：bash, ubuntu

```
function readArgs() {
    while getopts "i:o:p:s:l:m" OPTION; do
        case "$OPTION" in
            i)
                input="$OPTARG"
                ;;
            o)
                output="$OPTARG"
                ;;
            ...
        esac
    done
}

readArgs

if [[ -z "$input" ]]; then
    echo "Not set!"
fi 
```

这总是给我`Not set!`，但如果我注释掉这些行`function readArgs() {`，`}`并且`readArgs`，它会起作用。为什么？

还，

```
input="$OPTARG"
echo "$input"
;; 
```

不起作用。

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2012-05-04T18:56:14.907

`getopts`正在解析函数的参数`readArgs`，而您没有给该函数任何参数。

尝试：

```
readArgs "$@" 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2012-05-04T19:45:09.090

`getopts`依赖于`OPTIND`被初始化为 1 的变量。要么做

```
readArgs() { OPTIND=1; ... 
```

或者

```
readArgs() { local OPTIND; ... 
```

# xcode - 尝试在应用程序错误 NSInvalidArgumentException 中保存/加载图像

> ID：10454502
> 
> 赞同：-1
> 
> 时间：2012-05-04T18:48:44.973
> 
> 标签：xcode, load, directory, save

我试图在我的应用程序中保存和加载从相机胶卷中挑选的图像。当我按下加载或保存按钮时出现错误

***由于未捕获的异常“NSInvalidArgumentException”而终止应用程序，原因：“-[UIImageView CGImage]：无法识别的选择器发送到实例 0xe637640”

有什么想法吗？

AppDelagate.m

```
- (NSURL *)applicationDocumentsDirectory
{
    return [[[NSFileManager defaultManager] URLsForDirectory:NSDocumentDirectory i       nDomains:NSUserDomainMask] lastObject];

NSArray *paths = NSSearchPathForDirectoriesInDomains(NSDocumentDirectory, NSUserDomainMask, YES);
NSString *documentsDirectory = [paths objectAtIndex:0]; 
```

我试图保存/加载图像的类的.m

```
- (IBAction)save:(id)sender {
UIImage *myImage = imageView;
NSData *data = UIImagePNGRepresentation(myImage);
NSArray *paths = NSSearchPathForDirectoriesInDomains(NSDocumentDirectory, NSUserDomainMask, YES);
NSString *appDocsDirectory = [paths objectAtIndex:0];

}

- (IBAction)load:(id)sender {
UIImage *myImage = imageView;
NSData *data = UIImagePNGRepresentation(myImage);
NSArray *paths = NSSearchPathForDirectoriesInDomains(NSDocumentDirectory, NSUserDomainMask, YES);
NSString *appDocsDirectory = [paths objectAtIndex:0];
UIImage* thumImage = [UIImage imageWithContentsOfFile: [NSString stringWithFormat:@"%@/%@.png", appDocsDirectory, @"myNewFile"]];
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-04T22:37:56.620

这个错误意味着消息 CGImage 被发送到 UIImageView 类型的对象，但 UIImageView 没有响应它。问题似乎出在

```
UIImage *myImage = imageView; 
```

您没有正确编写 imageView 的实现，所以我不能准确地说，但我假设 imageView 是 UIImageView，它是 UIView 的子类，并且您将它分配给 UIImage。尝试

```
UIImage *myImage = [imageView image]; 
```

反而。我认为这应该有效））

顺便说一句，为什么你需要-load 中的第一串和第二串代码？它们是不必要的：

```
- (IBAction)load:(id)sender {
NSArray *paths = NSSearchPathForDirectoriesInDomains(NSDocumentDirectory, NSUserDomainMask, YES);
NSString *appDocsDirectory = [paths objectAtIndex:0];
UIImage* thumImage = [UIImage imageWithContentsOfFile: [NSString stringWithFormat:@"%@/%@.png", appDocsDirectory, @"myNewFile"]];
} 
```

# android - 如何将 C 代码转换为 JNI 代码

> ID：10454503
> 
> 赞同：0
> 
> 时间：2012-05-04T18:48:50.490
> 
> 标签：android, android-ndk, java-native-interface, native-code

我有想要在 Android 应用程序中使用的C 代码 ( *testFile .c)，使用 JNI。*这段代码包含纯C代码，里面有很多方法。此外，它还调用了一些 C 头文件（*file1* .h、*file2* .h）。

例如： *testFile* .c

```
#include "file1.h"
#include "file2.h"

void myMethod1()
{
    ...
    ...
}
void myMethod2()
{
    ...
    ...
}
void myMethod3()
{
    ...
    ...
} 
```

我是否必须将整个*testFile* .c 转换为 JNI 代码，或者只是转换一些我稍后将使用的方法（不是全部）？我还应该在头文件（file1.h 和 file2.h）中转换 c 代码，还是只在 testFile.c 中转换 c 代码？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-04T18:59:40.147

或者如果你的 Java 和 C 代码之间的接口非常简单，但是在 Android 上使用 jni 的整个过程不熟悉，你可以或多或少地将你的 C 代码合并到 ndk 中的 hello-jni 示例中。关键是你从构建和工作的东西开始，一点一点地添加你需要的东西，如果你遇到问题，你可以备份并找出你在哪个阶段破坏了它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-04T18:55:12.177

最简单的方法是定义您的 JNI Java 端接口并使用自动生成 c 方法存根`javah`来生成 c 文件。然后在这个 c 文件中调用实际的 c 方法`method1()`，`method2()`然后`method3()`.

[http://docs.oracle.com/javase/1.4.2/docs/tooldocs/windows/javah.html](http://docs.oracle.com/javase/1.4.2/docs/tooldocs/windows/javah.html)

# drupal - 在 Drupal 7/Views 3 中创建相似节点列表

> ID：10454507
> 
> 赞同：30
> 
> 时间：2012-05-04T18:48:59.593
> 
> 标签：drupal, drupal-7, drupal-views

从 drupal.stackexchange.com 复制，希望在这里获得更多答案：

我面临一个相当普遍的问题，即显示与当前节点相似的节点列表。相似节点定义为具有当前节点具有的至少一个分类术语的节点。作为模块可用的解决方案很少，但是我发现的模块（特别是按术语相似）处于 Drupal 7 的 beta 阶段（如“无法正常工作”）。

我还发现了一些基于视图和上下文过滤器的解决方案（例如[http://scito.ch/content/show-related-nodes-block-based-taxonomy-terms-views-3-and-drupal- 7](http://scito.ch/content/show-related-nodes-block-based-taxonomy-terms-views-3-and-drupal-7)）或关系。我非常喜欢这种方式，因为它节省了我安装额外模块的时间，并且视图正在积极开发和支持，我更喜欢使用它们而不是任何自定义解决方案。我无法解决的问题是如何按它们共享的术语数量对“相似节点”进行排序。例如，如果我有“IPhone 4S”节点，其中包含“Gadget”、“Apple”和“Phone”，我希望类似节点按以下顺序排列：

1.  iPhone 3（苹果、小工具、电话）
2.  iPad（苹果、小工具、平板电脑）
3.  Mac（苹果、电脑）
4.  布拉姆利（苹果、水果、树）

如何在此视图中按它们共享的术语数对节点进行排序？

这个问题是关于构建视图的，请不要建议基于模块或自定义 php 的解决方案。谢谢你。

* * *

## 回答 #1

> 赞同：83
> 
> 时间：2012-07-06T18:28:08.917

1.  创建块视图
2.  添加上下文过滤器 -> 内容：Nid -> 提供默认值 -> 来自 URL 的内容 ID
3.  添加关系 -> 内容：节点上的分类术语 -> 指定适当的词汇表
4.  添加关系 -> 分类术语：使用上述词汇的内容 -> 勾选 需要此关系
5.  打开视图聚合（注意：下面屏幕截图中的箭头指向错误的位置，应该指向它所在位置下方的 2 行）
6.  假设您仅列出标题，请编辑标题字段以使用您在上面 #4 中设置的关系。
7.  添加新的内容排序标准：Nid。在聚合设置中，选择计数。使用 #4 中的关系并降序排序
8.  添加上下文过滤器 -> 内容：Nid -> 使用 #4 中的关系 -> 提供默认值 - 来自 URL 的内容 ID -> 向下滚动并展开“更多”，然后选中“排除”以从视图中删除当前节点

** 请参阅下面@garret-albright 的评论，以在 Views UI 预览中对此进行测试。**

![相关节点视图](../Images/5146e963df39ff5c0d10bec085e3a22c.png)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2015-02-18T10:50:08.647

猜猜看 - 也有[模块](https://www.drupal.org/node/323329)：D

我可以推荐[类似的术语](https://www.drupal.org/project/similarterms)，为您提供该视图而无需配置麻烦。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-05-27T06:24:09.610

当您配置像这样的复杂视图时，有一些配置提示可以帮助您了解每个步骤的实际情况：

在结构>>视图>>设置>>基本：

*   检查“显示高级帮助警告”（重要：需要安装高级帮助模块）
*   选中“自动更新更改预览”
*   选中“在实时预览期间显示有关视图的信息和统计信息”
*   选中“显示 SQL 查询”
*   最后，保存配置

现在，您可以预览每个配置步骤的结果、关联的 SQL 查询以及所涉及的字段和表，因此您会发现更容易理解过滤器和聚合的工作原理。

希望能帮助到你。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-09-16T18:46:32.947

这是与此问题相关的替代解决方案。然而它可能并不适用于所有情况，但如果你可以使用它，它会更简单（在我看来比聚合更安全）。

我将使用[面板](http://drupal.org/project/panels)。一旦您创建了一个面板来显示您的实体（节点或其他任何东西），您就可以添加多个视图并将它们显示在内容旁边。这些观点之一将是我们的相关内容。
因此面板是唯一的限制。**也许**可以使用迷你面板并将其表示为一个块，我自己没有尝试过。

### 先决条件

*   观看次数（哦！）
*   面板
*   Views Content Pane：无需下载，在*ctools*模块中随views一起下载。
*   页面管理器：与视图内容窗格相同（可选/强烈推荐）。

### 风景

1.  像往常一样创建视图，但不要**将**其创建为块或页面。取消选中两者。

2.  在视图配置页面中，在实体上创建**与分类术语的关系。**

3.  创建一个**上下文过滤器**来过滤：**分类术语：术语 ID**。

4.  创建另一个**上下文过滤器**：*实体 ID*或内容：如果是节点，则为**Nid 。**

    *   在创建这个时，底部有一个折叠的字段集，其中包含选项：**Exclude**。按照标记进行检查。

5.  现在通过单击*Add* 创建一个类型为**Content pane**的新显示。

6.  在显示配置区域（名为：Pane settings）中打开**Argument input**。您应该有 2 个选项：

    *   *内容：Nid 来源*：将其来源设置为*From context*。将它的*必需上下文*设置为*Content ID*（如果您不使用节点，它可以是*ID*。
    *   *分类术语：术语 ID 来源*：将其来源设置为*From context*。将其*所需上下文*设置为*Term ID*。

恭喜！您已完成创建视图。是时候讨论小组了（我不会过多解释关于创建小组的内容，因为它超出了本 Q/A 的范围）。

### 小组

1.  创建一个面板（或启用 node/%node 默认面板并添加一个变体）。

2.  在**上下文**选项卡中，在实体上创建**与分类术语的关系。**

3.  单击其中一个窗格中的添加内容。

4.  如果您没有更改视图的类别，则在*视图窗格*中添加它。它将要求您的面板上下文中现在都提供实体 ID 和术语 ID，设置它们。

5.  现在显示面板时，除了本页的内容外，所有具有相同术语的内容都会显示出来。

视图配置

![视图配置](../Images/7c31ace49650060a563ca5d2899ae814.png)

上下文过滤器

![上下文过滤器](../Images/c69cd03062d2e651cf57b238eefde86f.png)

参数输入

![参数输入](../Images/6b61518a0cda66892c5766b23a8be91a.png)

### 重要PS：

这种方法已经过尝试，并且可以完美运行，但是在撰写本文时，ctools 有一个错误。有一个补丁：[https ://www.drupal.org/node/2195211](https://www.drupal.org/node/2195211)

* * *

## 回答 #5

> 赞同：-2
> 
> 时间：2012-05-20T17:28:42.627

我不确定我是否完全了解您的问题，但我认为节点队列就是答案。查看[http://drupal.org/project/nodequeue](http://drupal.org/project/nodequeue)

该模块开发良好。我已经将它用于客户端，您也可以使用他们的 smartqueue api 来制作您的列表。

希望我对您有所帮助。

# sql - 在 Connect By Prior Query 中搜索由 SYS_CONNECT_BY_PATH 创建的路径

> ID：10454508
> 
> 赞同：1
> 
> 时间：2012-05-04T18:49:00.553
> 
> 标签：sql, oracle, connect-by

我正在使用 Connect By 查询来显示组上的分层组，在此页面上，我有一个用于选择父组的组合框。但我想隐藏所有包含当前正在编辑的组的行。

这是我的桌子，

```
GROUPS
-------------
GROUP_ID, GROUP_NAME, GROUP_TYPE, PARENT_ID 
```

我的第一个查询是；

```
SELECT * FROM 
(SELECT  
    GROUP_ID,
    LPAD('-',LEVEL,'-')|| GROUP_NAME GROUP_NAME,
     SYS_CONNECT_BY_PATH(GROUP_NAME, '->')  GROUP_NAME_PATH 
FROM  GROUPS
    START WITH PARENT_ID IS NULL AND TYPE='G'
    CONNECT BY PRIOR GROUP_ID=PARENT_ID) 
```

这个结果在网格上。

```
27  -Generel Manager    ->Generel Manager,
28  --Project Manager   ->Generel Manager->Project Manager,
24  ---System Administrator ->Generel Manager->Project Manager->System Administrator
25  ---Software Developer   ->Generel Manager->Project Manager->Software Developer
26  ----Intern          ->Generel Manager->Project Manager->Software Developer->Intern 
```

例如;

在页面上`Editgroup.aspx?group_id=24` 它显示了所有这些行，但我想隐藏所有包含 GROUP_ID = 24 的行路径，因为 Group 不能是 selfchild。

我找到了这个查询的临时解决方案；

```
SELECT * FROM 
(SELECT  
    GROUP_ID,
    LPAD('-',LEVEL,'-')|| GROUP_NAME GROUP_NAME,
     SYS_CONNECT_BY_PATH(GROUP_NAME, '->') || ',' GROUP_NAME_PATH  
FROM  GROUPS
    START WITH PARENT_ID IS NULL AND GROUP_TYPE='G'
    CONNECT BY PRIOR GROUP_ID=PARENT_ID)
     WHERE  HIYERARSI_ID NOT LIKE '%,24,%' 
```

24 来自 url。

我认为当我们得到大数据时，它不会成为未来的有效解决方案。

如何更智能地检测路径是否包含此 ID？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-04T21:50:06.213

下面的代码将删除组号 24 及其所有子组：

```
SELECT   
GROUP_ID, 
LPAD('-',LEVEL,'-')|| GROUP_NAME GROUP_NAME, 
 SYS_CONNECT_BY_PATH(GROUP_NAME, '->')  GROUP_NAME_PATH  
FROM  GROUPS 
START WITH PARENT_ID IS NULL AND TYPE='G' 
AND GROUP_ID <> 24 /* added condition */
CONNECT BY PRIOR GROUP_ID=PARENT_ID 
AND GROUP_ID <> 24 /* added condition */ 
```

# php - 用 php 显示 XML 标签的完整路径

> ID：10454509
> 
> 赞同：0
> 
> 时间：2012-05-04T18:49:11.960
> 
> 标签：php, xml

假设我们要处理这个 Feed：[http ://tools.forestview.eu/xmlp/xml_feed.php?aid=1094&cid=1000](http://tools.forestview.eu/xmlp/xml_feed.php?aid=1094&cid=1000)

我试图以这种方式显示 XML 文件的节点：

```
deals->deal->dealsite
deals->deal->deal_id
deals->deal->deal_title 
```

这是为了能够处理我们不知道它们的 XML 标记是什么的提要。因此，我们将让用户选择 Deals->deal->deal_title 是 Deal Title 并以这种方式识别它。

我一直在尝试用这段代码来做到这一点：

```
 class HandleXML {
    var $root_tag = false;
    var $xml_tags = array();
    var $keys = array();

function parse_recursive(SimpleXMLElement $element)
{
        $get_name = $element->getName();
        $children   = $element->children();     // get all children

        if (empty($this->root_tag)) {
            $this->root_tag = $this->root_tag.$get_name;
        }

        $this->xml_tags[] = $get_name;

        // only show children if there are any
        if(count($children))
        {
               foreach($children as $child)
               {
                $this->parse_recursive($child); // recursion :)
               }
        }
        else {
            $key = implode('-&gt;', $this->xml_tags);
            $this->xml_tags = array();
            if (!in_array($key, $this->keys)) {
                if (!strstr('&gt;', $key) && count($this->keys) > 0) { $key = $this->root_tag.'-&gt;'.$key; }
                if (!in_array($key, $this->keys)) {
                    $this->keys[] = $key;
                }
            }
        }
    }
}

$xml = new SimpleXMLElement($feed_url, null, true);
$handle_xml = new HandleXML;

$handle_xml->parse_recursive($xml);
foreach($handle_xml->keys as $key) {
    echo $key.'<br />';
}
exit; 
```

但这是我得到的：

```
deals->deal->dealsite
deals->deal_id
deals->deal_title 
```

请参阅第 2 行和第 3 行的**deal->**部分丢失。

我也尝试过使用此代码： http: [//pastebin.com/FkPWXF64](http://pastebin.com/FkPWXF64)但这绝对不是最好的方法，而且它并不总是有效。

不管多少次我都做不到。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-04T19:03:11.307

在我的一个站点中，我使用了一些不同的方法来处理 xml 提要。在您的情况下，它看起来像：

```
$xml = simplexml_load_file("http://tools.forestview.eu/xmlp/xml_feed.php?aid=1094&cid=1000");

foreach($xml->{'deal'} as $deal) 
{
$dealsite = $deal->{'dealsite'};
$dael_id = $deal->{'dael_id'};
$deal_title = $deal->{'deal_title'};
$deal_url = $deal->{'deal_url'};
$deal_city = $deal->{'deal_city'};
$deal_category = $deal->{'deal_category'};

// and so on for the rest

// do some stuff with the variables like insert into MySQL

} 
```

# sql - Sql Server 管理工作室“无效的对象名称 dbo.xxxxx”

> ID：10454514
> 
> 赞同：2
> 
> 时间：2012-05-04T18:49:31.040
> 
> 标签：sql, sql-server, sql-server-2008, stored-procedures

我创建了一个 EmpDB 并创建了一个表“EmpTable”，当我尝试创建一个简单的 SP 时，我收到编译时错误“无效的对象名称 dbo.EmpTable”——为什么？

以下是sql语句

```
use EmpDB;
Go
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
-- =============================================
-- Author:      <Author,,Name>
-- Create date: <Create Date,,>
-- Description: <Description,,>
-- =============================================

CREATE PROCEDURE usp_GetEmpNames

AS

SELECT * FROM dbo.EmpTable 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-04T18:59:57.413

我刚刚创建了一个测试版本并运行了您的脚本，但遇到了任何问题。

需要检查的几件事：

如果你只运行`SELECT`它会运行吗？

```
SELECT * FROM dbo.EmpTable 
```

如果不是，则验证 EmpTable 所在的架构并替换 dbo。

```
SELECT * FROM yourSchemaNameGoesHere.EmpTable 
```

确保您创建的表位于正确的数据库中`EmpDB`，并且您没有意外在错误的数据库中创建表。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2019-10-16T12:24:33.343

确保您选择了运行查询的正确数据库。那是我的问题。

[![在此处输入图像描述](../Images/79182bc6f1c39f44b6f549b8187da0b1.png)](https://i.stack.imgur.com/8dy7y.png)

# php - 如何将json字符串发送回jquery

> ID：10454516
> 
> 赞同：2
> 
> 时间：2012-05-04T18:49:33.830
> 
> 标签：php, jquery, json

我需要将一些数据发送到外部 php 页面，并且该页面必须将所需的数据发送回 jQuery。我的问题是如何将数据从外部页面发送回发送它的页面上的 jQuery。

这是将数据发送到外部页面的 jQuery 代码：

```
function LoadImageData(url)
{    
    $.ajax({
      url: 'get_image_data.php',
      dataType: 'json',
      data: {'url': url },
      success: SetTag()
    }); 
} 
```

这是 htat 接收数据的 PHP 代码，需要返回一些数据：

```
<?php
require_once('FaceRestClient.php');

$apiKey = '**********************';
$apiSecret = '**********************';
$api = new FaceRestClient($apiKey, $apiSecret);

$active_url = $_POST['url'];
$photos = $api->faces_detect($active_url);

return $photos;
?> 
```

所以我的问题是，如何将数据发送回 jQuery。只是简单的返回似乎不起作用。

提前致谢，马克

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-04T18:50:12.363

您需要回显生成的 JSON：

```
echo $photos; 
```

如果`$photos`还不是 JSON，请使用[`json_encode`](http://php.net/json_encode)：

```
echo json_encode( $photos); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-04T18:50:41.553

你需要回应

```
echo $photos; 
```

并且正如@nickb 所说，如果 $photo 还不是 json，则先将其转换为 json，然后再回显。

```
echo json_encode($photos) 
```

如果要获取数据，请在 jQuery 中

```
onSuccess: function(data, status) {
    //var data contains the returned json.
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-04T18:54:36.560

试试这个

```
echo json_encode( $photos); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-05-04T19:26:55.753

有人会认为 REST API 会为您提供 JSON，但您需要检查它是否是有效的 JSON（JSONP 在此处无效）？

您可以在 Ajax 函数中删除 dataType 并让 jQuery 解决，这样至少如果它不是有效的 JSON，您会得到一些东西。

试试这个：

```
$.ajax({
      url: 'get_image_data.php',
      type: 'POST',
      data: {'url': url }
    }).done(function(data) {
       console.log(data);
    }).fail(function() {
       console.log('Your ajax just failed');
}); 
```

打开控制台，看看打印了什么

在 PHP 函数结束时，我倾向于这样做：

```
exit(json_encode($someData)); 
```

以 JSON 格式返回数据，但打印数据的任何内容都可以。

# java - 如何格式化 struts 2 选择标签中的日期列表？

> ID：10454517
> 
> 赞同：2
> 
> 时间：2012-05-04T18:49:41.787
> 
> 标签：java, date, select, struts2, tags

我正在尝试在 struts 2 选择标签中格式化日期，但这样做有困难。我知道有一个 struts 2 日期标签，但我认为这不是我想要的。

我在这里所做的是填充一个带有（周末）日期列表的选择框，我可以在其中选择要添加到员工休假表中的日期。基本上我正在尝试对它们进行格式化，以使其显示得漂亮整洁（MM/dd/yyyy），但我似乎找不到正确的方法来做到这一点。我尝试在下面的列表之间插入格式标签，我尝试在标签中使用 format.date 参数，我尝试使用 listValue 来格式化日期，但似乎没有任何效果。我在这里错过了什么吗？

`<s:select size="25" id="inputExclusionDates" name="available" list="availableExclusions" multiple="true" cssClass="multi-select" />`

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-06T22:39:21.550

为了好玩，我花时间弄清楚如何在 OGNL 中做到这一点，由于一些奇怪的皱纹，这并不像我预期的那么容易。

以下内容适用于提供名为 simpleDateFormat 的 java.text.SimpleDateFormat 属性的操作（请注意，这些选择标记中唯一不同的部分是 listValue 属性）：

```
<s:select listValue="simpleDateFormat.format(new java.util.Date(#this[0].time))" size="25" id="inputExclusionDates" name="available" list="availableExclusions" multiple="true" cssClass="multi-select" /> 
```

以下内容与上述内容相同，但在 JSP 中执行所有操作：

```
<s:select listValue="(new java.text.SimpleDateFormat('MM/dd/yyyy')).format(new java.util.Date(#this[0].time))" size="25" id="inputExclusionDates" name="available" list="availableExclusions" multiple="true" cssClass="multi-select" /> 
```

现在我提到了一条皱纹，眼睛好的人会注意到这看似多余的表情`new java.util.Date(#this[0].time)`，毕竟我应该只能说`#this[0]`。毕竟这是有道理的，但它不起作用。因此，由于这让我有些困惑，我会问一个关于它的问题：[Strange OGNL behavior when using #this in s:select](https://stackoverflow.com/questions/10474967/strange-ognl-behaviour-when-using-this-in-sselect)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-05T09:27:12.207

格式化日期的最简单方法：用一些“格式化日期方法”而不是日期来填充您的列表。

1 使用“格式化日期”方法创建类

```
public class MyDate {
  private Date date;

  public Date getDate(){
    return date;
  }

  public String getFormatedDate(){
    String str = **some code to format date**;
    return  str;
  } 
```

2 将此对象放入 availableExclusions 列表中

3

```
<s:select size="25" id="inputExclusionDates" name="available" list="availableExclusions" multiple="true" cssClass="multi-select" listKey="date" listValue="formatedDate"/> 
```

# javascript - Javascript：如何检索 *string* 数字的小数位数？

> ID：10454518
> 
> 赞同：57
> 
> 时间：2012-05-04T18:50:00.710
> 
> 标签：javascript, string, numbers, decimal

我有一组带小数的字符串数字，例如：`23.456`, `9.450`, `123.01`... 我需要检索每个数字的小数位数，知道它们至少有 1 个小数。

换句话说，该`retr_dec()`方法应返回以下内容：

```
retr_dec("23.456") -> 3
retr_dec("9.450")  -> 3
retr_dec("123.01") -> 2 
```

在这种情况下，尾随零确实算作小数，与此[相关问题](https://stackoverflow.com/questions/9539513/is-there-a-reliable-way-in-javascript-to-obtain-the-number-of-decimal-places-of)不同。

是否有一种简单/交付的方法可以在 Javascript 中实现这一点，或者我应该计算小数点位置并计算与字符串长度的差异？谢谢

* * *

## 回答 #1

> 赞同：114
> 
> 时间：2012-05-04T18:53:36.993

```
function decimalPlaces(num) {
  var match = (''+num).match(/(?:\.(\d+))?(?:[eE]([+-]?\d+))?$/);
  if (!match) { return 0; }
  return Math.max(
       0,
       // Number of digits right of decimal point.
       (match[1] ? match[1].length : 0)
       // Adjust for scientific notation.
       - (match[2] ? +match[2] : 0));
} 
```

额外的复杂性是处理科学记数法，所以

> ```
> decimalPlaces('.05')
> 2
> decimalPlaces('.5')
> 1
> decimalPlaces('1')
> 0
> decimalPlaces('25e-100')
> 100
> decimalPlaces('2.5e-99')
> 100
> decimalPlaces('.5e1')
> 0
> decimalPlaces('.25e1')
> 1 
> ```

* * *

## 回答 #2

> 赞同：59
> 
> 时间：2012-05-04T18:51:12.510

```
function retr_dec(num) {
  return (num.split('.')[1] || []).length;
} 
```

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2012-05-04T18:53:14.170

```
function retr_dec(numStr) {
    var pieces = numStr.split(".");
    return pieces[1].length;
} 
```

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2012-05-04T18:52:45.683

由于还没有基于正则表达式的答案：

```
/\d*$/.exec(strNum)[0].length 
```

*请注意，这对于整数“失败”，但根据问题规范，它们永远不会发生。*

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2017-05-19T07:40:59.747

您可以通过以下方式获得数字小数部分的长度：

```
var value = 192.123123;
stringValue = value.toString();
length = stringValue.split('.')[1].length; 
```

它将数字变成字符串，将字符串一分为二（在小数点处），并返回拆分操作返回的数组的第二个元素的长度，并将其存储在“length”变量中。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2016-01-13T15:36:16.900

尝试使用`String.prototype.match()`with `RegExp` `/\..*/`，返回`.length`匹配的字符串`-1`

```
function retr_decs(args) {
  return /\./.test(args) && args.match(/\..*/)[0].length - 1 || "no decimal found"
}

console.log(
  retr_decs("23.456") // 3
  , retr_decs("9.450") // 3
  , retr_decs("123.01") // 2
  , retr_decs("123") // "no decimal found"
)
```

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2017-02-26T08:30:28.913

我必须处理非常小的数字，所以我创建了一个可以处理像 1e-7 这样的数字的版本。

```
Number.prototype.getPrecision = function() {
  var v = this.valueOf();
  if (Math.floor(v) === v) return 0;
  var str = this.toString();
  var ep = str.split("e-");
  if (ep.length > 1) {
    var np = Number(ep[0]);
    return np.getPrecision() + Number(ep[1]);
  }
  var dp = str.split(".");
  if (dp.length > 1) {
    return dp[1].length;
  }
  return 0;
}
document.write("NaN => " + Number("NaN").getPrecision() + "<br>");
document.write("void => " + Number("").getPrecision() + "<br>");
document.write("12.1234 => " + Number("12.1234").getPrecision() + "<br>");
document.write("1212 => " + Number("1212").getPrecision() + "<br>");
document.write("0.0000001 => " + Number("0.0000001").getPrecision() + "<br>");
document.write("1.12e-23 => " + Number("1.12e-23").getPrecision() + "<br>");
document.write("1.12e8 => " + Number("1.12e8").getPrecision() + "<br>");
```

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2013-09-16T00:32:06.573

对当前接受的答案稍作修改，这将添加到`Number`原型中，从而允许所有数字变量执行此方法：

```
if (!Number.prototype.getDecimals) {
    Number.prototype.getDecimals = function() {
        var num = this,
            match = ('' + num).match(/(?:\.(\d+))?(?:[eE]([+-]?\d+))?$/);
        if (!match)
            return 0;
        return Math.max(0, (match[1] ? match[1].length : 0) - (match[2] ? +match[2] : 0));
    }
} 
```

它可以像这样使用：

```
// Get a number's decimals.
var number = 1.235256;
console.debug(number + " has " + number.getDecimals() + " decimal places.");

// Get a number string's decimals.
var number = "634.2384023";
console.debug(number + " has " + parseFloat(number).getDecimals() + " decimal places."); 
```

利用我们现有的代码，第二种情况也可以很容易地添加到`String`原型中，如下所示：

```
if (!String.prototype.getDecimals) {
    String.prototype.getDecimals = function() {
        return parseFloat(this).getDecimals();
    }
} 
```

像这样使用：

```
console.debug("45.2342".getDecimals()); 
```

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2015-02-02T15:19:46.673

有点混合了其他两个，但这对我有用。我的代码中的外部案例不是由这里的其他人处理的。但是，我删除了科学小数位计数器。我在大学会喜欢的！

```
numberOfDecimalPlaces: function (number) {
    var match = ('' + number).match(/(?:\.(\d+))?(?:[eE]([+-]?\d+))?$/);
    if (!match || match[0] == 0) {
        return 0;
    }
     return match[0].length;
} 
```

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2017-02-15T16:56:46.453

根据利亚姆米德尔顿的回答，这就是我所做的（没有科学记数法）：

```
numberOfDecimalPlaces = (number) => {
            let match = (number + "").match(/(?:\.(\d+))?$/);
            if (!match || !match[1]) {
                return 0;
            }

            return match[1].length;
        };

alert(numberOfDecimalPlaces(42.21));
```

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2018-04-02T20:37:11.200

```
function decimalPlaces(n) {
  if (n === NaN || n === Infinity)
    return 0;
  n = ('' + n).split('.');
  if (n.length == 1) {
    if (Boolean(n[0].match(/e/g)))
      return ~~(n[0].split('e-'))[1];
    return 0;

  }
  n = n[1].split('e-');
  return n[0].length + ~~n[1];

} 
```

# c# - 比较两个复杂对象的最佳方法

> ID：10454519
> 
> 赞同：139
> 
> 时间：2012-05-04T18:50:00.420
> 
> 标签：c#, .net

我有两个复杂的对象，例如**`Object1`**和**`Object2`**。*它们有大约 5 个级别的子对象。*

我需要最快的方法来说明它们是否相同。

在 C# 4.0 中如何做到这一点？

* * *

## 回答 #1

> 赞同：119
> 
> 时间：2012-05-04T18:53:02.753

在所有自定义类型上实现[`IEquatable<T>`](https://msdn.microsoft.com/en-us/library/ms131187%28v=vs.110%29.aspx)（通常与覆盖继承的[`Object.Equals`](https://msdn.microsoft.com/en-us/library/bsc2ak47%28v=vs.110%29.aspx)和方法一起使用）。[`Object.GetHashCode`](https://msdn.microsoft.com/en-us/library/system.object_methods%28v=vs.110%29.aspx)对于复合类型，在包含类型中调用包含类型的`Equals`方法。对于包含的集合，使用[`SequenceEqual`](https://msdn.microsoft.com/en-us/library/bb348567.aspx)扩展方法，它在内部调用`IEquatable<T>.Equals`或`Object.Equals`在每个元素上。这种方法显然需要您扩展类型的定义，但其结果比任何涉及序列化的通用解决方案都要快。

**编辑**：这是一个具有三层嵌套的人为示例。

对于值类型，您通常可以只调用它们的`Equals`方法。即使从未显式分配字段或属性，它们仍将具有默认值。

对于引用类型，您应该首先调用[`ReferenceEquals`](https://msdn.microsoft.com/en-us/library/system.object.referenceequals%28v=vs.110%29.aspx)来检查引用是否相等——当您碰巧引用同一个对象时，这将提高效率。它还可以处理两个引用都为空的情况。如果该检查失败，请确认您的实例的字段或属性不为 null（以避免`NullReferenceException`）并调用其`Equals`方法。由于我们的成员类型正确，该`IEquatable<T>.Equals`方法被直接调用，绕过被覆盖的`Object.Equals`方法（由于类型转换，其执行会稍微慢一些）。

当你覆盖时`Object.Equals`，你也应该覆盖`Object.GetHashCode`；为了简洁起见，我没有在下面这样做。

```
public class Person : IEquatable<Person>
{
    public int Age { get; set; }
    public string FirstName { get; set; }
    public Address Address { get; set; }

    public override bool Equals(object obj)
    {
        return this.Equals(obj as Person);
    }

    public bool Equals(Person other)
    {
        if (other == null)
            return false;

        return this.Age.Equals(other.Age) &&
            (
                object.ReferenceEquals(this.FirstName, other.FirstName) ||
                this.FirstName != null &&
                this.FirstName.Equals(other.FirstName)
            ) &&
            (
                object.ReferenceEquals(this.Address, other.Address) ||
                this.Address != null &&
                this.Address.Equals(other.Address)
            );
    }
}

public class Address : IEquatable<Address>
{
    public int HouseNo { get; set; }
    public string Street { get; set; }
    public City City { get; set; }

    public override bool Equals(object obj)
    {
        return this.Equals(obj as Address);
    }

    public bool Equals(Address other)
    {
        if (other == null)
            return false;

        return this.HouseNo.Equals(other.HouseNo) &&
            (
                object.ReferenceEquals(this.Street, other.Street) ||
                this.Street != null &&
                this.Street.Equals(other.Street)
            ) &&
            (
                object.ReferenceEquals(this.City, other.City) ||
                this.City != null &&
                this.City.Equals(other.City)
            );
    }
}

public class City : IEquatable<City>
{
    public string Name { get; set; }

    public override bool Equals(object obj)
    {
        return this.Equals(obj as City);
    }

    public bool Equals(City other)
    {
        if (other == null)
            return false;

        return
            object.ReferenceEquals(this.Name, other.Name) ||
            this.Name != null &&
            this.Name.Equals(other.Name);
    }
} 
```

**更新**：这个答案是几年前写的。从那时起，我开始不再`IEquality<T>`为此类场景实现可变类型。平等有两个概念：***同一性***和***等价***性。在内存表示级别上，这些通常被区分为“引用相等”和“值相等”（请参阅[​​相等比较](https://docs.microsoft.com/en-us/dotnet/csharp/programming-guide/statements-expressions-operators/equality-comparisons)）。但是，同样的区别也适用于域级别。假设你的`Person`班级有一个`PersonId`属性，每个不同的现实世界的人都是独一无二的。具有相同`PersonId`但不同`Age`值的两个对象应该被视为相等还是不同？上面的答案假设一个是在等价之后。不过有很多用法`IEquality<T>`接口，例如集合，假定此类实现提供了*标识*。例如，如果您正在填充 a `HashSet<T>`，您通常会期望[`TryGetValue(T,T)`](https://docs.microsoft.com/en-us/dotnet/api/system.collections.generic.hashset-1.trygetvalue)调用返回仅共享参数标识的现有元素，而不一定是内容完全相同的等效元素。这个概念由以下注释强制执行[`GetHashCode`](https://docs.microsoft.com/en-us/dotnet/api/system.object.gethashcode#notes-to-inheritors)：

> 通常，对于可变引用类型，您应该`GetHashCode()`仅在以下情况下覆盖：
> 
> *   您可以从不可变的字段计算哈希码；或者
> *   您可以确保当对象包含在依赖于其哈希码的集合中时，可变对象的哈希码不会改变。

* * *

## 回答 #2

> 赞同：112
> 
> 时间：2014-10-13T21:51:32.393

序列化两个对象并比较结果字符串

* * *

## 回答 #3

> 赞同：49
> 
> 时间：2016-03-21T07:27:59.090

您可以使用扩展方法，递归来解决此问题：

```
public static bool DeepCompare(this object obj, object another)
{     
  if (ReferenceEquals(obj, another)) return true;
  if ((obj == null) || (another == null)) return false;
  //Compare two object's class, return false if they are difference
  if (obj.GetType() != another.GetType()) return false;

  var result = true;
  //Get all properties of obj
  //And compare each other
  foreach (var property in obj.GetType().GetProperties())
  {
      var objValue = property.GetValue(obj);
      var anotherValue = property.GetValue(another);
      if (!objValue.Equals(anotherValue)) result = false;
  }

  return result;
 }

public static bool CompareEx(this object obj, object another)
{
 if (ReferenceEquals(obj, another)) return true;
 if ((obj == null) || (another == null)) return false;
 if (obj.GetType() != another.GetType()) return false;

 //properties: int, double, DateTime, etc, not class
 if (!obj.GetType().IsClass) return obj.Equals(another);

 var result = true;
 foreach (var property in obj.GetType().GetProperties())
 {
    var objValue = property.GetValue(obj);
    var anotherValue = property.GetValue(another);
    //Recursion
    if (!objValue.DeepCompare(anotherValue))   result = false;
 }
 return result;
} 
```

或使用 Json 进行比较（如果对象非常复杂）您可以使用 Newtonsoft.Json：

```
public static bool JsonCompare(this object obj, object another)
{
  if (ReferenceEquals(obj, another)) return true;
  if ((obj == null) || (another == null)) return false;
  if (obj.GetType() != another.GetType()) return false;

  var objJson = JsonConvert.SerializeObject(obj);
  var anotherJson = JsonConvert.SerializeObject(another);

  return objJson == anotherJson;
} 
```

* * *

## 回答 #4

> 赞同：28
> 
> 时间：2012-05-04T19:32:48.893

如果你不想实现 IEquatable，你总是可以使用反射来比较所有属性： - 如果它们是值类型，只需比较它们 - 如果它们是引用类型，递归调用函数来比较它的“内部”属性.

我不是在考虑性能，而是在考虑简单性。但是，这取决于对象的确切设计。根据您的对象形状，它可能会变得复杂（例如，如果属性之间存在循环依赖关系）。但是，您可以使用多种解决方案，例如：

*   [比较 .NET 对象](https://github.com/GregFinzer/Compare-Net-Objects)

另一种选择是将对象序列化为文本，例如使用 JSON.NET，然后比较序列化结果。（JSON.NET 可以处理属性之间的循环依赖）。

我不知道您所说的最快是指实现它的最快方法还是运行速度快的代码。在知道是否需要之前，您不应该进行优化。[过早的优化是万恶之源](https://www.google.es/#hl=es&gs_nf=1&cp=46&gs_id=5&xhr=t&q=Premature+optimization+is+the+root+of+all+evil&pf=p&safe=off&output=search&sclient=psy-ab&oq=Premature+optimization+is+the+root+of+all+evil&aq=0&aqi=g1&aql=&gs_l=&pbx=1&bav=on.2,or.r_gc.r_pw.r_cp.r_qf.,cf.osb&fp=f0200d0a847eb23b&biw=1618&bih=965)

* * *

## 回答 #5

> 赞同：9
> 
> 时间：2016-01-20T11:27:27.210

序列化两个对象并通过@JoelFan 比较结果字符串

所以要做到这一点，像这样创建一个静态类并使用扩展来扩展所有对象（这样你就可以将任何类型的对象、集合等传递给方法）

```
using System;
using System.IO;
using System.Runtime.Serialization.Json;
using System.Text;

public static class MySerializer
{
    public static string Serialize(this object obj)
    {
        var serializer = new DataContractJsonSerializer(obj.GetType());
        using (var ms = new MemoryStream())
        {
            serializer.WriteObject(ms, obj);
            return Encoding.Default.GetString(ms.ToArray());
        }
    }
} 
```

在任何其他文件中引用此静态类后，您可以执行以下操作：

```
Person p = new Person { Firstname = "Jason", LastName = "Argonauts" };
Person p2 = new Person { Firstname = "Jason", LastName = "Argonaut" };
//assuming you have already created a class person!
string personString = p.Serialize();
string person2String = p2.Serialize(); 
```

现在您可以简单地使用 .Equals 来比较它们。我用它来检查对象是否也在集合中。它真的很好用。

* * *

## 回答 #6

> 赞同：7
> 
> 时间：2019-05-24T09:34:12.760

序列化两个对象，然后计算哈希码，然后比较。

* * *

## 回答 #7

> 赞同：7
> 
> 时间：2020-05-27T19:15:50.073

您现在可以使用 json.net。只需继续 Nuget 并安装它。

你可以这样做：

```
public bool Equals(SamplesItem sampleToCompare)
{
    string myself = JsonConvert.SerializeObject(this);
    string other = JsonConvert.SerializeObject(sampleToCompare);

    return myself == other;
} 
```

如果你想变得更漂亮，你也许可以为对象制作一个扩展方法。请注意，这仅比较公共属性。如果您想在进行比较时忽略公共属性，您可以使用该`[JsonIgnore]`属性。

* * *

## 回答 #8

> 赞同：6
> 
> 时间：2012-05-04T18:53:56.540

我假设您指的不是字面上相同的对象

```
Object1 == Object2 
```

您可能正在考虑在两者之间进行内存比较

```
memcmp(Object1, Object2, sizeof(Object.GetType()) 
```

但这甚至不是 c# 中的真实代码:)。因为您的所有数据可能都是在堆上创建的，所以内存不是连续的，您不能只以不可知的方式比较两个对象的相等性。您将不得不以自定义方式一次比较每个值。

考虑将`IEquatable<T>`接口添加到您的类中，并`Equals`为您的类型定义一个自定义方法。然后，在该方法中，手动测试每个值。`IEquatable<T>`如果可以的话，再次添加封闭类型并重复该过程。

```
class Foo : IEquatable<Foo>
{
  public bool Equals(Foo other)
  {
    /* check all the values */
    return false;
  }
} 
```

* * *

## 回答 #9

> 赞同：4
> 
> 时间：2021-03-12T07:54:30.617

如果您有需要不可变类的要求。我的意思是，一旦创建，就不能修改任何属性。在这种情况下，C# 9 有一个称为记录的特性。

您可以轻松地按值和类型比较记录是否相等。

```
public record Person
{
    public string LastName { get; }
    public string FirstName { get; }

    public Person(string first, string last) => (FirstName, LastName) = (first, last);
}

var person1 = new Person("Bill", "Wagner");
var person2 = new Person("Bill", "Wagner");

Console.WriteLine(person1 == person2); // true 
```

* * *

## 回答 #10

> 赞同：3
> 
> 时间：2012-05-04T18:53:01.040

我会这样说：

`Object1.Equals(Object2)`

将是您正在寻找的。那就是如果您要查看对象是否相同，这似乎是您要问的。

如果要检查所有子对象是否相同，请使用该`Equals()`方法通过循环运行它们。

* * *

## 回答 #11

> 赞同：3
> 
> 时间：2019-01-16T16:43:41.107

感谢乔纳森的例子。我为所有情况（数组、列表、字典、原始类型）扩展了它。

这是没有序列化的比较，不需要为比较对象实现任何接口。

```
 /// <summary>Returns description of difference or empty value if equal</summary>
        public static string Compare(object obj1, object obj2, string path = "")
        {
            string path1 = string.IsNullOrEmpty(path) ? "" : path + ": ";
            if (obj1 == null && obj2 != null)
                return path1 + "null != not null";
            else if (obj2 == null && obj1 != null)
                return path1 + "not null != null";
            else if (obj1 == null && obj2 == null)
                return null;

            if (!obj1.GetType().Equals(obj2.GetType()))
                return "different types: " + obj1.GetType() + " and " + obj2.GetType();

            Type type = obj1.GetType();
            if (path == "")
                path = type.Name;

            if (type.IsPrimitive || typeof(string).Equals(type))
            {
                if (!obj1.Equals(obj2))
                    return path1 + "'" + obj1 + "' != '" + obj2 + "'";
                return null;
            }
            if (type.IsArray)
            {
                Array first = obj1 as Array;
                Array second = obj2 as Array;
                if (first.Length != second.Length)
                    return path1 + "array size differs (" + first.Length + " vs " + second.Length + ")";

                var en = first.GetEnumerator();
                int i = 0;
                while (en.MoveNext())
                {
                    string res = Compare(en.Current, second.GetValue(i), path);
                    if (res != null)
                        return res + " (Index " + i + ")";
                    i++;
                }
            }
            else if (typeof(System.Collections.IEnumerable).IsAssignableFrom(type))
            {
                System.Collections.IEnumerable first = obj1 as System.Collections.IEnumerable;
                System.Collections.IEnumerable second = obj2 as System.Collections.IEnumerable;

                var en = first.GetEnumerator();
                var en2 = second.GetEnumerator();
                int i = 0;
                while (en.MoveNext())
                {
                    if (!en2.MoveNext())
                        return path + ": enumerable size differs";

                    string res = Compare(en.Current, en2.Current, path);
                    if (res != null)
                        return res + " (Index " + i + ")";
                    i++;
                }
            }
            else
            {
                foreach (PropertyInfo pi in type.GetProperties(BindingFlags.NonPublic | BindingFlags.Instance | BindingFlags.Public))
                {
                    try
                    {
                        var val = pi.GetValue(obj1);
                        var tval = pi.GetValue(obj2);
                        if (path.EndsWith("." + pi.Name))
                            return null;
                        var pathNew = (path.Length == 0 ? "" : path + ".") + pi.Name;
                        string res = Compare(val, tval, pathNew);
                        if (res != null)
                            return res;
                    }
                    catch (TargetParameterCountException)
                    {
                        //index property
                    }
                }
                foreach (FieldInfo fi in type.GetFields(BindingFlags.NonPublic | BindingFlags.Instance | BindingFlags.Public))
                {
                    var val = fi.GetValue(obj1);
                    var tval = fi.GetValue(obj2);
                    if (path.EndsWith("." + fi.Name))
                        return null;
                    var pathNew = (path.Length == 0 ? "" : path + ".") + fi.Name;
                    string res = Compare(val, tval, pathNew);
                    if (res != null)
                        return res;
                }
            }
            return null;
        } 
```

为了轻松复制代码创建的[存储库](https://github.com/miptleha/cs-obj-compare)

* * *

## 回答 #12

> 赞同：3
> 
> 时间：2016-05-20T11:46:39.390

我在下面找到了用于比较对象的函数。

```
 static bool Compare<T>(T Object1, T object2)
 {
      //Get the type of the object
      Type type = typeof(T);

      //return false if any of the object is false
      if (object.Equals(Object1, default(T)) || object.Equals(object2, default(T)))
         return false;

     //Loop through each properties inside class and get values for the property from both the objects and compare
     foreach (System.Reflection.PropertyInfo property in type.GetProperties())
     {
          if (property.Name != "ExtensionData")
          {
              string Object1Value = string.Empty;
              string Object2Value = string.Empty;
              if (type.GetProperty(property.Name).GetValue(Object1, null) != null)
                    Object1Value = type.GetProperty(property.Name).GetValue(Object1, null).ToString();
              if (type.GetProperty(property.Name).GetValue(object2, null) != null)
                    Object2Value = type.GetProperty(property.Name).GetValue(object2, null).ToString();
              if (Object1Value.Trim() != Object2Value.Trim())
              {
                  return false;
              }
          }
     }
     return true;
 } 
```

我正在使用它，它对我来说很好用。

* * *

## 回答 #13

> 赞同：3
> 
> 时间：2018-12-05T03:25:48.587

根据这里已经给出的一些答案，我决定主要支持[JoelFan 的答案](https://stackoverflow.com/a/26349452/1039753)。我喜欢扩展方法，当没有其他解决方案使用它们来比较我的复杂类时，这些方法对我来说非常有用。

## 扩展方法

```
using System.IO;
using System.Xml.Serialization;

static class ObjectHelpers
{
    public static string SerializeObject<T>(this T toSerialize)
    {
        XmlSerializer xmlSerializer = new XmlSerializer(toSerialize.GetType());

        using (StringWriter textWriter = new StringWriter())
        {
            xmlSerializer.Serialize(textWriter, toSerialize);
            return textWriter.ToString();
        }
    }

    public static bool EqualTo(this object obj, object toCompare)
    {
        if (obj.SerializeObject() == toCompare.SerializeObject())
            return true;
        else
            return false;
    }

    public static bool IsBlank<T>(this T obj) where T: new()
    {
        T blank = new T();
        T newObj = ((T)obj);

        if (newObj.SerializeObject() == blank.SerializeObject())
            return true;
        else
            return false;
    }

} 
```

## 使用示例

```
if (record.IsBlank())
    throw new Exception("Record found is blank.");

if (record.EqualTo(new record()))
    throw new Exception("Record found is blank."); 
```

* * *

## 回答 #14

> 赞同：2
> 
> 时间：2017-06-09T14:29:54.637

```
public class GetObjectsComparison
{
    public object FirstObject, SecondObject;
    public BindingFlags BindingFlagsConditions= BindingFlags.Public | BindingFlags.NonPublic | BindingFlags.Instance | BindingFlags.Static;
}
public struct SetObjectsComparison
{
    public FieldInfo SecondObjectFieldInfo;
    public dynamic FirstObjectFieldInfoValue, SecondObjectFieldInfoValue;
    public bool ErrorFound;
    public GetObjectsComparison GetObjectsComparison;
}
private static bool ObjectsComparison(GetObjectsComparison GetObjectsComparison)
{
    GetObjectsComparison FunctionGet = GetObjectsComparison;
    SetObjectsComparison FunctionSet = new SetObjectsComparison();
    if (FunctionSet.ErrorFound==false)
        foreach (FieldInfo FirstObjectFieldInfo in FunctionGet.FirstObject.GetType().GetFields(FunctionGet.BindingFlagsConditions))
        {
            FunctionSet.SecondObjectFieldInfo =
            FunctionGet.SecondObject.GetType().GetField(FirstObjectFieldInfo.Name, FunctionGet.BindingFlagsConditions);

            FunctionSet.FirstObjectFieldInfoValue = FirstObjectFieldInfo.GetValue(FunctionGet.FirstObject);
            FunctionSet.SecondObjectFieldInfoValue = FunctionSet.SecondObjectFieldInfo.GetValue(FunctionGet.SecondObject);
            if (FirstObjectFieldInfo.FieldType.IsNested)
            {
                FunctionSet.GetObjectsComparison =
                new GetObjectsComparison()
                {
                    FirstObject = FunctionSet.FirstObjectFieldInfoValue
                    ,
                    SecondObject = FunctionSet.SecondObjectFieldInfoValue
                };

                if (!ObjectsComparison(FunctionSet.GetObjectsComparison))
                {
                    FunctionSet.ErrorFound = true;
                    break;
                }
            }
            else if (FunctionSet.FirstObjectFieldInfoValue != FunctionSet.SecondObjectFieldInfoValue)
            {
                FunctionSet.ErrorFound = true;
                break;
            }
        }
    return !FunctionSet.ErrorFound;
} 
```

* * *

## 回答 #15

> 赞同：1
> 
> 时间：2012-05-04T18:55:02.587

一种方法是覆盖所`Equals()`涉及的每种类型。例如，您的顶级对象将覆盖`Equals()`以调用`Equals()`所有 5 个子对象的方法。这些对象也应该全部覆盖`Equals()`，假设它们是自定义对象，依此类推，直到可以通过对顶级对象执行相等检查来比较整个层次结构。

* * *

## 回答 #16

> 赞同：1
> 
> 时间：2012-05-04T18:58:25.167

使用`IEquatable<T>`具有方法的接口`Equals`。

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2022-01-12T14:32:35.163

**通用扩展方法**

```
public static class GenericExtensions
{
    public static bool DeepCompare<T>(this T objA, T objB)
    {
        if (typeof(T).IsValueType)
            return objA.Equals(objB);

        if (ReferenceEquals(objA, objB))
            return true;

        if ((objA == null) || (objB == null))
            return false;

        if (typeof(T) is IEnumerable)
        {
            var enumerableA = (IEnumerable<T>) objA;
            var enumerableB = (IEnumerable<T>) objB;

            if (enumerableA.Count() != enumerableB.Count())
                return false;

            using (var enumeratorA = enumerableA.GetEnumerator())
            using (var enumeratorB = enumerableB.GetEnumerator())
            {
                while (true)
                {
                    bool moveNextA = enumeratorA.MoveNext();
                    bool moveNextB = enumeratorB.MoveNext();

                    if (!moveNextA || !moveNextB)
                        break;

                    var currentA = enumeratorA.Current;
                    var currentB = enumeratorB.Current;

                    if (!currentA.DeepCompare<T>(currentB))
                        return false;
                }

                return true;
            }
        }

        foreach (var property in objA.GetType().GetProperties())
        {
            var valueA = property.GetValue(objA);
            var valueB = property.GetValue(objB);

            if (!valueA.DeepCompare(valueB))
                return false;
        }

        return true;
    }
} 
```

# php - PHP file() vs fopen()+fgets() 性能之争

> ID：10454520
> 
> 赞同：1
> 
> 时间：2012-05-04T18:50:00.810
> 
> 标签：php, performance, file, fopen, fgets

我正在重写一些脚本以将机器生成的日志从 perl 解析为 php 文件范围从 20mb~400mb 我遇到了这个问题来决定我应该使用 file() 还是 fopen()+fgets() 组合去通过文件以获得更快的性能。

这是基本的运行，我在打开它之前检查文件大小，如果文件大于 100mb（非常罕见的情况，但它确实会不时发生）我会走 fopen+fgets 路线，因为我只是碰到了脚本的内存限制为 384mb，任何大于 100mb 的文件都有可能导致致命错误。否则，我使用 file()。

我只在两种方法中从头到尾逐行浏览文件一次。

这是一个问题，是否值得保留代码的 file() 部分来处理小文件？我不知道 file() （我也使用 SKIP_EMPTY_LINE 选项）在 php 中是如何工作的，它是直接将文件映射到内存中，还是在遍历时将文件逐行推入内存？我对其进行了一些基准测试，性能非常接近，40mb 文件的平均差异约为 0.1 秒，并且 file() 在大约 80% 的时间（在同一文件集的 200 次测试中）比 fopen+fgets 具有优势。

删除文件部分肯定可以为我节省一些系统内存，并且考虑到我同时运行相同脚本的 3 个实例，它可以在同时托管数据库和其他的 12G 系统上为我节省 1G 的内存废话。但我也不想让脚本的性能下降，因为每天大约有 10k 的这些日志进入，实际上 0.1 秒的差异加起来。

任何建议都会对 TIA 有所帮助！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-05T03:28:56.983

我建议坚持使用一种机制，例如`foreach(new \SplFileObject('file.log') as $line)`. 拆分您的输入文件并并行处理它们，每个 CPU 内核 2-3x。奖励：低于同一系统上的数据库的优先级。在 PHP 中，这意味着一次生成 N 个脚本副本，其中每个副本都有自己的文件列表或目录。由于您在谈论重写并且 IO 性能是一个问题，因此请在此处考虑具有更多功能的其他平台，例如 Java 7 NIO、nodejs 异步 IO、C# TPL。

# django - Django 模板标签允许粗体和斜体元素

> ID：10454527
> 
> 赞同：4
> 
> 时间：2012-05-04T18:50:39.820
> 
> 标签：django, templates, bold, italic, templatetag

Django 有一个模板标签，允许您删除某些 html 标签，使其不显示在存储的数据中。

django 文档给出了一个例子。删除任何 b 或 span 标签。 [https://docs.djangoproject.com/en/dev/ref/templates/builtins/?from=olddocs#removetags](https://docs.djangoproject.com/en/dev/ref/templates/builtins/?from=olddocs#removetags)

```
{{ value|removetags:"b span"|safe }} 
```

但是，我想知道是否有一个很好的方法来做相反的事情。例如，将除指定标签之外的所有标签都列入黑名单。就我而言，我只想允许粗体和斜体标签。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-04T19:07:06.223

[使用漂白剂](https://github.com/jsocol/bleach)编写您自己的模板标签。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-04T19:28:23.427

[您可以根据原始removetags](https://github.com/django/django/blob/master/django/template/defaultfilters.py#L467)和此正则表达式编写自己的模板标签：

```
>>> import re
>>> tags = ['b', 'i']
>>> tags_re = u'(%s)' % u'|'.join(tags)
>>> striptags_re = re.compile(ur'</(?!{0}).*?>|<(?!/)(?!{0}).*?>'.format(tags_re), re.U)
>>> value = '<b>foo</b><i><p>bar</b>'
>>> striptags_re.sub(u'', value)
u'<b>foo</b><i>bar</b>'
>>> value = '<b>foo</b><p>bar</p>'
>>> striptags_re.sub(u'', value)
u'<b>foo</b>bar' 
```

# android - 将 actionbarsherlock 迁移到版本 4.0.2（从 3.5）

> ID：10454536
> 
> 赞同：0
> 
> 时间：2012-05-04T18:51:15.793
> 
> 标签：android, android-actionbar, actionbarsherlock

我正在将使用 actionbarsherlock 3.5 的应用程序迁移到 actionbarsherlock 4.2。几乎一切正常，但我有一个问题 onPrepareOptionsMenu((android.view.Menu) menu);

我需要在运行时向 actionbarsherlock 添加一些项目。我这样做：

公共无效 onPrepareOptionsMenu（菜单菜单）。

问题是这个方法需要一个 android.view.Menu 作为参数。所以，我打电话给：

super.onPrepareOptionsMenu((android.view.Menu) 菜单);

这不起作用，我的菜单永远不会创建。actionbarsherlock 3.5 一切正常。

有小费吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-04T19:04:17.437

它不应该期望`android.view.Menu`。你是从`Sherlock(Fragment)Activity`/延伸的`SherlockFragment`吗？

# objective-c - iphone项目中的ipad旋转

> ID：10454537
> 
> 赞同：1
> 
> 时间：2012-05-04T18:51:16.250
> 
> 标签：objective-c, ios, rotation, orientation

我创建了一个仅针对 iPhone（目前）的项目，并且我选择了仅支持的方向纵向。在 iPhone 上效果很好，但是当我在 iPad 上启动我的项目时，我的应用程序正在旋转！实际上我试图让它成为一个通用应用程序，在 iPad 部署信息中我选择了仅支持的方向纵向，我的应用程序仍然在 iPad 上旋转。我该如何解决？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-04T18:54:48.240

要在您的视图中仅支持纵向模式，请在每个视图中实现以下内容：

```
- (BOOL)shouldAutorotateToInterfaceOrientation:(UIInterfaceOrientation)interfaceOrientation
{
    return (interfaceOrientation == UIInterfaceOrientationPortrait);
} 
```

此外，您还需要确保为每个设备设置了**支持的设备方向：**

![在此处输入图像描述](../Images/4b58699963d2747600c7ec7a6c16bff1.png)

![在此处输入图像描述](../Images/769a7903f69eabada0939e1d0e3841f3.png)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-04T18:55:36.140

您可以通过实现此功能在视图控制器中手动设置旋转值：

```
- (BOOL)shouldAutorotateToInterfaceOrientation:(UIInterfaceOrientation)interfaceOrientation {
    return (interfaceOrientation == UIInterfaceOrientationPortrait;
} 
```

# python - Python Walk，但轻线程

> ID：10454540
> 
> 赞同：5
> 
> 时间：2012-05-04T18:51:27.167
> 
> 标签：python, os.walk

我想递归地遍历一个目录，但是如果 python 遇到一个包含超过 100 个文件的目录，我希望它从任何单个 listdir 中中断。基本上，我正在搜索 (.TXT) 文件，但我想避免使用大型 DPX 图像序列（通常为 10,000 个文件）的目录。由于 DPX 自己存在于没有子目录的目录中，我想尽快打破这个循环。

长话短说，如果 python 遇到匹配“.DPX$”的文件，它会停止列出子目录，退出，跳过该子目录并继续在其他子目录中遍历。

这是否可以在返回所有列表结果之前打破目录列表循环？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-04T19:05:34.247

如果你的意思是“目录列表循环”，`os.listdir()`那么没有。这是不能断的。但是，您可以查看[`os.path.walk()`](http://docs.python.org/library/os.path.html#os.path.walk)or[`os.walk()`](http://docs.python.org/library/os.html#os.walk)方法并删除所有包含`DPX`文件的目录。如果你使用`os.walk()`并且是自上而下的，你可以通过修改目录列表来影响 Python 进入的目录。`os.path.walk()`允许您使用访问方法选择步行地点。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-04T19:13:14.240

根据以下[文档](http://docs.python.org/library/os.html#os.walk)`os.walk`：

> 当*topdown*为`True`时，调用者可以就地修改*dirnames*列表（例如，通过`del`或切片分配），并且`walk()`只会递归到名称保留在*dirnames*中的子目录；这可用于修剪搜索，或强加特定的访问顺序。*topdown*时修改 *dirnames*是无效的，因为 dirnames 中的目录在 *dirnames*本身生成*时*已经生成。*`False`*

 ***因此，理论上，如果您清空，`dirnames`则`os.walk`不会递归任何其他目录。注意关于“...通过 del 或 slice 赋值”的注释；您不能简单地这样做`dirnames=[]`，因为这实际上不会影响`dirnames`列表的内容。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-04T22:03:46.750

避免使用 os.listdir 分配名称列表的正确方法是使用@Charles Duffy 所说的 os 级别函数。

灵感来自另一篇文章：[将文件夹中的文件列为流以立即开始处理](https://stackoverflow.com/questions/4403598/list-files-in-a-folder-as-a-stream-to-begin-process-immediately)

我添加了如何解决特定的OP问题并使用了该功能的可重入版本。

```
from ctypes import CDLL, c_char_p, c_int, c_long, c_ushort, c_byte, c_char, Structure, POINTER, byref, cast, sizeof, get_errno
from ctypes.util import find_library

class c_dir(Structure):
    """Opaque type for directory entries, corresponds to struct DIR"""
    pass

class c_dirent(Structure):
    """Directory entry"""
    # FIXME not sure these are the exactly correct types!
    _fields_ = (
        ('d_ino', c_long), # inode number
        ('d_off', c_long), # offset to the next dirent
        ('d_reclen', c_ushort), # length of this record
        ('d_type', c_byte), # type of file; not supported by all file system types
        ('d_name', c_char * 4096) # filename
        )
c_dirent_p = POINTER(c_dirent)
c_dirent_pp = POINTER(c_dirent_p)
c_dir_p = POINTER(c_dir)

c_lib = CDLL(find_library("c"))
opendir = c_lib.opendir
opendir.argtypes = [c_char_p]
opendir.restype = c_dir_p

readdir_r = c_lib.readdir_r
readdir_r.argtypes = [c_dir_p, c_dirent_p, c_dirent_pp]
readdir_r.restype = c_int

closedir = c_lib.closedir
closedir.argtypes = [c_dir_p]
closedir.restype = c_int

import errno

def listdirx(path):
    """
    A generator to return the names of files in the directory passed in
    """
    dir_p = opendir(path)

    if not dir_p:
        raise IOError()

    entry_p = cast(c_lib.malloc(sizeof(c_dirent)), c_dirent_p)

    try:
        while True:
            res = readdir_r(dir_p, entry_p, byref(entry_p))
            if res:
                raise IOError()
            if not entry_p:
                break
            name = entry_p.contents.d_name
            if name not in (".", ".."):
                yield name
    finally:
        if dir_p:
            closedir(dir_p)
        if entry_p:
            c_lib.free(entry_p)

if __name__ == '__main__':
    import sys
    path = sys.argv[1]
    max_per_dir = int(sys.argv[2])
    for idx, entry in enumerate(listdirx(path)):
        if idx >= max_per_dir:
            break
        print entry 
```***

# cookies - 如何将 GA *和* GWO cookie 限定到单个域

> ID：10454541
> 
> 赞同：0
> 
> 时间：2012-05-04T18:51:36.097
> 
> 标签：cookies, google-analytics, google-website-optimizer

我在 www.britely.com 上同时使用谷歌分析和谷歌网站优化器，并希望将他们的 cookie 仅限于该域。（为了避免从 britely.com 的其他子域加载的静态资产请求中的 cookie 开销，这应该得到一些 CDN 的喜爱。）

使用两者的示例页面（当前[将](http://www.britely.com/ninjamom/s-t-dogs-think)、`__utma`和`__utmb`cookie设置为`__utmc``__utmz``.britely.com``www.britely.com`

就[谷歌的文档](https://developers.google.com/analytics/devguides/collection/gajs/methods/gaJSApiDomainDirectory#_gat.GA_Tracker_._setDomainName)而言，似乎[_gaq.push(['_setDomainName', 'none']);](https://developers.google.com/analytics/devguides/collection/gajs/gaTrackingSite#domainToNone) 在页面顶部调用（或同上“www.britely.com”而不是“none”）*应该*足以实现这一目标。

不知何故，它不是。`.britely.com`我想在我阅读 GWO 的来源之前，我们曾经设置了更多的 cookie `siteopt.js`，这似乎并不知道`_setDomainName`。它响应一个页面全局常量`_udn`，声明它应该使用的 cookie 域 - 因此在页面中以这个开头，至少 GWO`__utmx`和`__utmxx`cookie 被正确处理：

```
<script>
  var _gaq = _gaq || [], _udn = 'www.britely.com';
  _gaq.push(['_setDomainName', 'none']);
</script> 
```

我知道解决 cookie 开销问题的常用方法是提供来自某个域的静态内容，该域与使用 GA 和 GWO 的域完全不同。这不是我寻求的解决方案。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-06T23:22:11.250

除了上述调整之外，Google 网站优化器控制脚本还需要自己的`_gaq.push(['gwo._setDomainName', 'none']);`调用 - 类似于 GA 的调用，它似乎只是系统全局的，但实际上并非如此。

使用上述设置，所有 cookie 的范围都被限定为`www.britely.com`除了`__utmx`and之外，由于某种原因`__utmxx`，它们最终被限定为范围。`.www.britely.com`对我来说已经足够好了。

# tomcat - 将 Grails 与现有的 Web 应用程序集成

> ID：10454542
> 
> 赞同：6
> 
> 时间：2012-05-04T18:51:41.917
> 
> 标签：tomcat, grails, tapestry

我们有一个使用 Tapestry 4.1 编写的大型、笨重但相当稳定的 Web 应用程序，我们希望逐步摆脱它。为此，我们正在考虑在 Grails 中开发一些新功能。我们的客户永远不应该知道其中的区别，如果可能的话，内部人员（例如安装服务）也不应该关心——理想情况下，Grails 应用程序将与现有 Tapestry 代码在同一个 WAR 中，只需`GrailsDispatcherServlet`配置为更具体的路径。对现有应用程序的怪物构建过程进行最小的更改也是至关重要的——在 Gant 和 Ivy 中重做构建系统（目前是 Ant，正在过渡到 Maven）不是一种选择。如果我们可以在开发过程中使用爆炸的 WAR 进行实时重新加载，那就太好了。

那么问题来了：

*   这可能吗？
*   如果是这样，我从哪里开始？
*   如果没有，下一个最好的方法是什么？
*   我需要注意什么？

请注意，我们不会使用 GORM；我们所有的数据都来自 Web 服务，我们已经有 Java 域和消息传递层。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-16T06:24:01.907

好消息：是的，这是可能的。

坏消息：有点毛茸茸的。

至少有两种方式：

1.  按照 Dylan 的建议，修改 Grails 构建以适应您现有的应用程序，并进行一些调整。
2.  创建另一个 Ant 目标，将现有的 WAR 文件与 Grails 生成的 WAR 文件结合起来。

第一个选项，修改 Grails 构建。风险在于，当 Grails 更新版本时，定制和调整过的 Grails 构建可能会完全失败，并且您不会在这里或那里结束。解决这个问题需要深入了解框架如何生成构建。由于这是您第一次接触新框架，因此学习曲线可能会太陡峭。

我更喜欢第二个，因为你不需要搞乱 Grails 的构建。您需要了解底层的 web.xml 配置是如何工作的。我假设您已经拥有这些知识，因为您也已经拥有自己的 Ant 构建。可能这是阻力最小的路径。

第二种方法的缺点是在开发过程中很难有爆炸的 WAR。但是，如果您可以将旧应用程序和新应用程序分开，而无需在开发过程中将它们一起测试，那么您将在使用 Grails 的轻量级开发服务器进行开发时玩得很开心。

下一步将一点一点地使旧应用程序能够在 Grails 下作为 Grails 调用的 Java 组件运行。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-15T03:33:20.117

您可以通过运行 grails install-templates 命令编辑 web.xml 的模板以更改 servlet 映射

您可以使用[Ant 和 Maven](http://grails.org/doc/latest/guide/commandLine.html#4.5%20Ant%20and%20Maven)（或 Gradle）来构建 Grails 应用程序，但由于不是“标准”方法，我的经验是可能需要进行一些小的调整。我使用 Ant 集成（它使用 ivy 作为依赖项）来构建并使用 Gradle 来包装 Ant 并针对特殊要求修改构建。

您可能遇到的问题是 Gant 脚本是 Grails 的核心，并且在这些脚本中发生了许多事情（取决于您使用的插件），这可能会导致尝试将两个构建合并在一起时出现问题，因为这些脚本不是用您的使用编写的记住情况。

# php - 显示 PHP 为 HTTP 请求制作的确切标头？

> ID：10454543
> 
> 赞同：1
> 
> 时间：2012-05-04T18:51:52.003
> 
> 标签：php, http

有没有办法让函数发送的确切标头像`file_get_contents()`or `get_headers()`？

喜欢

```
get_headers('http://google.it');
echo php_get_request_headers();  //> ? 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-04T19:05:51.057

曾经有过这个问题，所以我使用的是代理，例如`fiddler` [http://www.fiddler2.com/fiddler2/](http://www.fiddler2.com/fiddler2/)

```
$default_opts = array(
  'http'=>array(
    'method'=>"HEAD",
    'proxy'=>"tcp://localhost:8888"
  )
);

$default = stream_context_set_default($default_opts);
$headers = get_headers('http://google.com');

var_dump($headers); 
```

它捕获此脚本发送的所有请求，因为`stream_context_set_default` .. 这适用于`file_get_contents`等`fopen`。

# python - Python如何检查不返回

> ID：10454554
> 
> 赞同：0
> 
> 时间：2012-05-04T18:53:07.593
> 
> 标签：python, if-statement, diff

在 python 中，我想使用 commands.getoutput('diff a.txt b.txt') 来区分两个文件，如果它们相同，则打印“成功！”。如果它们相同，我将如何编写满足的 if 语句？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-04T19:12:30.473

以下更快——它将确定文件在第一个差异上是不相同的，而不是读取它们的全部并计算差异。`commands`它还可以正确处理名称中包含空格或不可打印字符的文件，并且在删除模块后将继续与 Python 的未来版本一起使用：

```
import subprocess
if subprocess.Popen(['cmp', '-s', '--', 'a.txt', 'b.txt']).wait() == 0:
  print 'Files are identical' 
```

如果使用`diff`是一个人为的示例，并且您的真正目标*是*确定是否给出了输出，那么您也可以使用 Popen 执行此操作：

```
import subprocess
p = subprocess.Popen(['diff', '--', 'a.txt', 'b.txt'],
                     stdout=subprocess.PIPE,
                     stderr=subprocess.STDOUT)
(stdout, _) = p.communicate()
if p.returncode != 0:
    print 'Process exited with error code %r' % p.returncode
if stdout:
    print 'Process emitted some output: \n%s' % stdout
else:
    print 'Process emitted no output' 
```

检查`returncode`在 UNIX 工具中尤为重要，因为它可能需要区分无输出表示成功和发生故障的情况；仅仅看输出并不总是能让你做出这种区分。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-04T19:00:45.177

不要使用命令使用 os，这要好得多...

```
import os

os.system("diff a.txt b.txt" + "> diffOutput")
fDiff = open("diffOutput", 'r')
output = ''.join(fDiff.readlines())
if len(output) == 0:
        print "Success!"
else:
   print output

fDiff.close() 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-04T19:32:36.320

你能用`filecmp`吗？

```
import filecmp

diff = filecmp.cmp('a.pdf','b.pdf')
if diff:
    print('Success!') 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-04T19:01:34.227

为什么使用`commands.getoutput`？自 python 2.6 以来，此模块已被[弃用。](http://docs.python.org/library/commands.html)此外，您可以仅使用 python 比较文件。

```
file_1_path = 'some/path/to/file1' 
file_2_path = 'some/path/to/file2'

file_1 = open(file_1_path)
file_2 = open(file_2_path)

if file_1.read() == file_2.read():
    print "Success!"

file_1.close()
file_2.close() 
```

给定两个不同文件的路径`open`，然后将`read`它们都输入字符串的结果进行比较。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-05-04T19:02:47.263

```
result = commands.getoutput('diff a.txt b.txt')
if len(result) == 0:
   print 'Success' 
```

# python - python mechanize：创建并提交表单

> ID：10454555
> 
> 赞同：1
> 
> 时间：2012-05-04T18:53:09.850
> 
> 标签：python, html, screen-scraping, mechanize

我正在用机械化连接一个网站。该网站使用 javascript 创建自定义表单并在创建后提交。我怎样才能对机械化做同样的事情，即：创建一个表单，添加与网站的javascript相同的输入元素，然后提交？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-04T19:51:46.200

这似乎有效：

```
br.open(URL)
res = mechanize._form.ParseString(FORM_HTML, BASE_URL)
br.form = res[1]
#continue as if the form was on the page and selected with .select_form()
br['username'] = 'foo'
br['password'] = 'bar'
br.submit() 
```

`URL`是访问站点的完整 URL。`BASE_URL`是 URL 所在的目录。`FORM_HTML`是任何具有`form`元素的 HTML，例如：

```
<form method='post' action='/login.aspx'>
    <input type='text' name='username'>
    <input type='text' name='password'>
    <input type='hidden' name='important_js_thing' value='processed_with_python TM'>
</form> 
```

出于某种原因，`mechanize._form.ParseString`返回两种形式。第一个是`GET`对基本 URL 的请求，没有输入；第二，正确解析的形式来自`FORM_HTML`.

# c# - 动作总是返回 null

> ID：10454563
> 
> 赞同：0
> 
> 时间：2012-05-04T18:53:51.660
> 
> 标签：c#, linq, c#-4.0

我的行动是：

```
[HttpPost]
public ViewResult SearchPost(FormCollection frm)
{

    IList <post> p =db.posts.Include("user").ToList();

    if (Request.Form["area"] != null)          
    {
        if ((p!=null) && (p.Any()))

        {

            p =p.Where(a=>a.area==Request.Form["area"]).ToList();     

        }
   }           
    if (Request.Form["floor"] != null)          
    {              
        if ((p!=null) && (p.Any()))

        {
            p = p.Where(a => a.floor ==   
           Request.Form["floor"]).ToList();                              
        }
    }            
    if (Request.Form["garage"] != null)          
    {
        if ((p!=null) && (p.Any()))

        {
            p = p.Where(a => a.garage ==   
            Request.Form["garage"]).ToList();                                    
        }
    }  

    return View(p);
} 
```

它没有显示任何错误。但总是返回 null。它应该返回过滤的帖子对象或简单的所有帖子而不过滤。有什么问题吗 ？？我找不到它。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-07T04:03:26.420

我不知道你正在处理的类型的完整签名，但也许试试这段代码，看看你是否得到更好的结果：

```
[HttpPost]
public ViewResult SearchPost(FormCollection frm)
{
    var area = Request.Form["area"];
    var floor = Request.Form["floor"];
    var garage = Request.Form["garage"];

    return View(db.posts.Include("user")
        .Where(a => area == null || a.area == area)
        .Where(a => floor == null || a.floor == floor)
        .Where(a => garage == null || a.garage == garage).ToList());
} 
```

（这本质上是将您的代码重写为单个查询，这可能有助于您进行调试。）

# php - MySql 插入高 CPU 负载

> ID：10454564
> 
> 赞同：7
> 
> 时间：2012-05-04T18:53:52.147
> 
> 标签：php, mysql, insert, nginx, cpu-usage

我有 nginx 接收 POST 请求和一个将请求正文放入 MySql 的小型 PHP 脚本。当我每秒有 300 个 POST 时，问题是 MySql CPU 使用率非常高。我希望 MySql 是一个快速的东西，每秒可以处理超过 300 次插入。我使用 Amazon EC2 小型实例，Amazon Linux。

```
top - 18:27:06 up 3 days,  1:43,  2 users,  load average: 4.40, 5.39, 5.76
Tasks: 178 total,   4 running, 174 sleeping,   0 stopped,   0 zombie
Cpu(s): 24.6%us, 13.4%sy,  0.0%ni,  0.0%id,  1.1%wa,  0.0%hi,  4.9%si, 56.0%st
Mem:   1717480k total,  1640912k used,    76568k free,   193364k buffers
Swap:   917500k total,     5928k used,   911572k free,   824136k cached

  PID USER      PR  NI  VIRT  RES  SHR S %CPU %MEM    TIME+  COMMAND
 7677 mysql     20   0  313m 153m 6124 S 39.0  9.2 393:49.11 mysqld
16529 nginx     20   0  157m 151m  820 R 15.2  9.0  28:36.50 nginx
29793 php       20   0 36780 3240 1896 S  2.5  0.2   0:00.34 php-fpm
29441 php       20   0 36780 3204 1892 S  2.2  0.2   0:00.78 php-fpm
29540 php       20   0 36780 3204 1900 S  2.2  0.2   0:00.82 php-fpm
29603 php       20   0 36780 3220 1892 S  2.2  0.2   0:00.61 php-fpm
29578 php       20   0 36780 3200 1900 S  1.9  0.2   0:00.42 php-fpm
29950 php       20   0 36780 3192 1900 S  1.9  0.2   0:00.48 php-fpm
30030 php       20   0 36780 3180 1888 S  1.9  0.2   0:00.08 php-fpm
30025 php       20   0 36780 3200 1888 S  1.6  0.2   0:00.11 php-fpm
29623 php       20   0 36780 3184 1892 S  1.3  0.2   0:00.49 php-fpm
29625 php       20   0 36780 3236 1900 S  1.3  0.2   0:00.46 php-fpm
29686 php       20   0 36780 3364 1900 R  1.3  0.2   0:00.51 php-fpm
29863 php       20   0 36780 3184 1892 S  1.3  0.2   0:00.23 php-fpm
30018 php       20   0 36780 3192 1892 S  1.3  0.2   0:00.19 php-fpm
29607 php       20   0 36780 3224 1900 S  1.0  0.2   0:00.42 php-fpm
29729 php       20   0 36780 3180 1888 R  1.0  0.2   0:00.41 php-fpm 
```

这是我的PHP代码：

```
<?php
    $mysqli=new mysqli("localhost", "root", "", "errorreportsraw");
    $project_id=$_REQUEST["project_id"];
    $data=$_REQUEST["data"];
    $date=date("Y-m-d H-i-s");
    $mysqli->query("insert into rawreports(date, data, project_id) values ('$date', '$data', '$project_id')")
?> 
```

我试过 mysql_connect, mysql_pconnect, mysqli("localhost",...), mysqli("p:localhost", ...) - 还是一样。除了这些插入之外，没有对数据库运行任何查询。

这是我的桌子：

```
CREATE TABLE `rawreports` (
  `id` bigint(20) NOT NULL AUTO_INCREMENT,
  `date` datetime NOT NULL,
  `data` mediumtext NOT NULL,
  `project_id` varchar(100) NOT NULL,
  PRIMARY KEY (`id`)
); 
```

这很简单，没有索引，只是为了存储 POST 数据以供以后处理。在大多数情况下，“数据”字段大约为 3 KB。尝试过 innodb 和 myisam - 还是一样。

这是我的 SHOW PROCESSLIST，除了多个插入之外什么都没有：

```
mysql> show processlist;
+---------+----------------------+-----------+-----------------+---------+------+------------------+------------------------------------------------------------------------------------------------------+
| Id      | User                 | Host      | db              | Command | Time | State            | Info                                                                                                 |
+---------+----------------------+-----------+-----------------+---------+------+------------------+------------------------------------------------------------------------------------------------------+
| 3872248 | root                 | localhost | NULL            | Query   |    0 | NULL             | show processlist                                                                                     |
| 3901991 | root                 | localhost | errorreportsraw | Query   |    0 | update           | insert into rawreports(date, data, project_id) values ('2012-05-05 17-01-37', '{"exceptions":[{"stac |
| 3902003 | root                 | localhost | errorreportsraw | Sleep   |    0 |                  | NULL                                                                                                 |
| 3902052 | root                 | localhost | errorreportsraw | Query   |    0 | update           | insert into rawreports(date, data, project_id) values ('2012-05-05 17-01-37', '{"exceptions":[{"stac |
| 3902053 | root                 | localhost | errorreportsraw | Query   |    0 | update           | insert into rawreports(date, data, project_id) values ('2012-05-05 17-01-37', '{"exceptions":[{"stac |
| 3902054 | root                 | localhost | errorreportsraw | Query   |    0 | update           | insert into rawreports(date, data, project_id) values ('2012-05-05 17-01-37', '{"exceptions":[{"stac |
| 3902055 | root                 | localhost | errorreportsraw | Query   |    0 | update           | insert into rawreports(date, data, project_id) values ('2012-05-05 17-01-37', '{"exceptions":[{"stac |
| 3902056 | root                 | localhost | errorreportsraw | Query   |    0 | update           | insert into rawreports(date, data, project_id) values ('2012-05-05 17-01-37', '{"exceptions":[{"stac |
| 3902057 | root                 | localhost | errorreportsraw | Query   |    0 | update           | insert into rawreports(date, data, project_id) values ('2012-05-05 17-01-37', '{"exceptions":[{"stac |
| 3902058 | root                 | localhost | errorreportsraw | Query   |    0 | update           | insert into rawreports(date, data, project_id) values ('2012-05-05 17-01-37', '{"exceptions":[{"stac |
| 3902059 | root                 | localhost | errorreportsraw | Query   |    0 | update           | insert into rawreports(date, data, project_id) values ('2012-05-05 17-01-37', '{"exceptions":[{"stac |
| 3902060 | root                 | localhost | errorreportsraw | Query   |    0 | update           | insert into rawreports(date, data, project_id) values ('2012-05-05 17-01-37', '{"protocol_version":" |
| 3902061 | root                 | localhost | errorreportsraw | Query   |    0 | update           | insert into rawreports(date, data, project_id) values ('2012-05-05 17-01-37', '{"exceptions":[{"stac |
| 3902062 | root                 | localhost | errorreportsraw | Query   |    0 | update           | insert into rawreports(date, data, project_id) values ('2012-05-05 17-01-37', '{"exceptions":[{"stac |
| 3902063 | root                 | localhost | errorreportsraw | Query   |    0 | update           | insert into rawreports(date, data, project_id) values ('2012-05-05 17-01-37', '{"exceptions":[{"stac |
| 3902064 | root                 | localhost | errorreportsraw | Query   |    0 | update           | insert into rawreports(date, data, project_id) values ('2012-05-05 17-01-37', '{"exceptions":[{"stac |
| 3902065 | root                 | localhost | errorreportsraw | Query   |    0 | update           | insert into rawreports(date, data, project_id) values ('2012-05-05 17-01-37', '{"exceptions":[{"stac |
| 3902066 | root                 | localhost | errorreportsraw | Query   |    0 | update           | insert into rawreports(date, data, project_id) values ('2012-05-05 17-01-37', '{"exceptions":[{"stac |
| 3902067 | root                 | localhost | errorreportsraw | Query   |    0 | update           | insert into rawreports(date, data, project_id) values ('2012-05-05 17-01-37', '{"exceptions":[{"stac |
| 3902068 | root                 | localhost | errorreportsraw | Query   |    0 | update           | insert into rawreports(date, data, project_id) values ('2012-05-05 17-01-37', '{"exceptions":[{"stac |
| 3902069 | root                 | localhost | errorreportsraw | Query   |    0 | update           | insert into rawreports(date, data, project_id) values ('2012-05-05 17-01-37', '{"exceptions":[{"stac |
| 3902070 | root                 | localhost | errorreportsraw | Query   |    0 | update           | insert into rawreports(date, data, project_id) values ('2012-05-05 17-01-37', '{"exceptions":[{"stac |
| 3902071 | root                 | localhost | errorreportsraw | Query   |    0 | update           | insert into rawreports(date, data, project_id) values ('2012-05-05 17-01-37', '{"exceptions":[{"stac |
| 3902072 | root                 | localhost | errorreportsraw | Query   |    0 | update           | insert into rawreports(date, data, project_id) values ('2012-05-05 17-01-37', '{"exceptions":[{"stac |
| 3902073 | root                 | localhost | errorreportsraw | Query   |    0 | update           | insert into rawreports(date, data, project_id) values ('2012-05-05 17-01-37', '{"exceptions":[{"stac |
| 3902074 | root                 | localhost | errorreportsraw | Query   |    0 | update           | insert into rawreports(date, data, project_id) values ('2012-05-05 17-01-37', '{"exceptions":[{"stac |
| 3902075 | root                 | localhost | errorreportsraw | Query   |    0 | update           | insert into rawreports(date, data, project_id) values ('2012-05-05 17-01-37', '{"exceptions":[{"stac |
| 3902076 | root                 | localhost | errorreportsraw | Query   |    0 | update           | insert into rawreports(date, data, project_id) values ('2012-05-05 17-01-37', '{"exceptions":[{"stac |
| 3902077 | root                 | localhost | errorreportsraw | Query   |    0 | update           | insert into rawreports(date, data, project_id) values ('2012-05-05 17-01-37', '{"exceptions":[{"stac |
| 3902078 | root                 | localhost | errorreportsraw | Query   |    0 | update           | insert into rawreports(date, data, project_id) values ('2012-05-05 17-01-37', '{"exceptions":[{"stac |
| 3902079 | root                 | localhost | errorreportsraw | Query   |    0 | update           | insert into rawreports(date, data, project_id) values ('2012-05-05 17-01-37', '{"exceptions":[{"stac |
| 3902080 | root                 | localhost | errorreportsraw | Query   |    0 | update           | insert into rawreports(date, data, project_id) values ('2012-05-05 17-01-37', '{"exceptions":[{"stac |
| 3902081 | root                 | localhost | errorreportsraw | Query   |    0 | update           | insert into rawreports(date, data, project_id) values ('2012-05-05 17-01-37', '{"exceptions":[{"stac |
| 3902082 | root                 | localhost | errorreportsraw | Query   |    0 | update           | insert into rawreports(date, data, project_id) values ('2012-05-05 17-01-37', '{"exceptions":[{"stac |
| 3902083 | root                 | localhost | errorreportsraw | Query   |    0 | update           | insert into rawreports(date, data, project_id) values ('2012-05-05 17-01-37', '{"exceptions":[{"stac |
| 3902084 | root                 | localhost | errorreportsraw | Query   |    0 | update           | insert into rawreports(date, data, project_id) values ('2012-05-05 17-01-37', '{"exceptions":[{"stac |
| 3902085 | root                 | localhost | errorreportsraw | Query   |    0 | update           | insert into rawreports(date, data, project_id) values ('2012-05-05 17-01-37', '{"exceptions":[{"stac |
| 3902086 | root                 | localhost | errorreportsraw | Query   |    0 | update           | insert into rawreports(date, data, project_id) values ('2012-05-05 17-01-37', '{"exceptions":[{"stac |
| 3902087 | unauthenticated user | localhost | NULL            | Connect | NULL | Reading from net | NULL                                                                                                 |
+---------+----------------------+-----------+-----------------+---------+------+------------------+------------------------------------------------------------------------------------------------------+
39 rows in set (0.00 sec) 
```

这是我在服务器仍处于压力下手动执行相同插入时的配置文件：

```
set profiling=1;
insert into rawreports(date, data, project_id) values('2012-05-04 00:58:08','[3000-chars-data-here]','5');
show profile ALL for query 1;

Status                          Duration    CPU_user    CPU_system  Context_voluntary    Context_involuntary    Block_ops_in    Block_ops_out   Messages_sent   Messages_received   Page_faults_major   Page_faults_minor   Swaps   Sourc
starting                        0.000231    0.000000    0.000000    0                    0                      0               0               0               0                   0                   0                   0       NULL    NULL    NULL
checking permissions            0.000030    0.000000    0.000000    0                    0                      0               0               0               0                   0                   0                   0       check_access    sql_parse.cc    4745
Opening tables                  0.000057    0.001000    0.000000    0                    0                      0               0               0               0                   0                   0                   0       open_tables     sql_base.cc     4836
System lock                     0.000030    0.000000    0.000000    0                    0                      0               0               0               0                   0                   0                   0       mysql_lock_tables       lock.cc 299
init                            0.000037    0.000000    0.000000    0                    0                      0               0               0               0                   0                   0                   0       mysql_insert    sql_insert.cc   721
update                          0.075716    0.001999    0.011998    166                  2                      0               0               0               0                   0                   0                   0       mysql_insert    sql_insert.cc   806
Waiting for query cache lock    0.000087    0.000000    0.000000    0                    0                      0               0               0               0                   0                   0                   0       lock    sql_cache.cc    552
update                          0.000037    0.000000    0.000000    0                    0                      0               0               0               0                   0                   0                   0       NULL    NULL    NULL
end                             0.000024    0.000000    0.000000    0                    0                      0               0               0               0                   0                   0                   0       mysql_insert    sql_insert.cc   1049
query end                       0.000042    0.000000    0.000000    0                    0                      0               0               0               0                   0                   0                   0       mysql_execute_command   sql_parse.cc    4434
closing tables                  0.000031    0.000000    0.001000    0                    0                      0               0               0               0                   0                   0                   0       mysql_execute_command   sql_parse.cc    4486
freeing items                   0.000126    0.000000    0.000000    0                    1                      0               0               0               0                   0                   0                   0       mysql_parse     sql_parse.cc    5634
logging slow query              0.000030    0.000000    0.000000    0                    0                      0               0               0               0                   0                   0                   0       log_slow_statement      sql_parse.cc    1460
cleaning up                     0.000024    0.000000    0.000000    0                    0                      0               0               0               0                   0                   0                   0       dispatch_command        sql_parse.cc    1416 
```

我使用 MySql 5.5.20。尝试了 InnoDB 和 MyISAM - 都一样。
这是我的 iostat 输出：

```
# iostat -x
Linux 3.2.12-3.2.4.amzn1.i686 05/15/2012      _i686_  (1 CPU)

avg-cpu:  %user   %nice %system %iowait  %steal   %idle
          23.67    0.03   18.39    4.09   52.87    0.95

Device:         rrqm/s   wrqm/s     r/s     w/s   rsec/s   wsec/s avgrq-sz avgqu-sz   await  svctm  %util
xvdap1            0.00     1.74    0.03    0.78     1.50    25.12    32.85     0.01   14.03   5.92   0.48
xvdap3            0.00     0.00    0.01    0.01     0.05     0.08    10.47     0.00    5.72   1.09   0.00
xvdf              0.40    18.59   23.14  117.55   753.12  3465.25    29.98     0.53    3.74   2.38  33.46 
```

最明显的事情是批量插入并将它们全部提交，而不是一一提交。但我不能这样做，因为每个插入都是一个单独的 POST 请求，单独的 PHP 脚本执行。它们都是同时执行的，互不干扰。

看似很简单的任务，我的CPU究竟在做什么这么辛苦？对mysql、php、linux没有太多经验。可能我只是想念一些东西。感谢您的任何想法！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-11T04:33:54.723

通过“稍后”处理，您可能是指 1 小时或 1 天后？如果是这种情况，那么我会将信息写入一个 CSV 文件，您大约每小时轮换一次，然后当您需要进行“稍后”处理时，您可以使用将文件加载到 MySQL `LOAD DATA INFILE`

[http://dev.mysql.com/doc/refman/5.1/en/load-data.html](http://dev.mysql.com/doc/refman/5.1/en/load-data.html)

我已经让 LOAD DATA INFILE 在不到一分钟的时间内加载了 100 MB 的信息，这种方法将是加快您的 Web 响应的好方法。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-04T19:02:23.937

您是否在循环中运行该 PHP 代码？您可以在单个查询中一次插入多行，这可能有助于降低 CPU 负载。您需要做的就是提供一个逗号分隔的值列表，如下所示：

```
insert into rawreports(date, data, project_id) values (('$date1', '$data1', '$project_id1'),('$date2', '$data2', '$project_id2'), .....)") 
```

此外，如果您在循环中运行，则无需`new mysqli()`为每次迭代重复。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-05-05T11:06:28.410

> 没有索引，

这并不完全正确。
我会首先删除一个索引。
在日志类型表中，它没有任何意义。

顺便说一句，您也可以使用文本日志。用于后期处理。

要获得一些详细信息，您可以在服务器处于正常负载下时从 mysql 控制台运行这些命令：

```
> SET profiling = 1;
> INSERT an example query
> SHOW PROFILE ALL 
```

也试试傻

```
SHOW PROCESSLIST; 
```

这无疑会揭示一些有用但至少值得尝试的东西

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-05-11T18:56:52.420

从所有答案中我可以看出，您可以在分析后有以下选择来处理问题：

1) Amazon EC2 或任何云服务器的写入速度将低于常规专用服务器，因为 HDD iops 在物理节点上托管的所有虚拟服务器之间共享。因此，为 DB 配备单独的机器是个好主意，您甚至可以尝试使用 Amazon Simple DB。应该值得一试。

2）您可以尝试使用最简单的基于文档的 NoSQL 数据库，例如 MongoDB，与 MySQL 相比，它的写入操作速度快很多。我在本地机器上进行了基准测试，发现了令人惊讶的结果。因此，您可以真正将数据库存储在 NoSQL DB 中，而不是使用 CSV 方法，如果以后需要，可以将其推送到 MySQL 以使用批处理作业进行任何关系查询。

3) 如果您不使用任何 PHP 操作码/加速器，请使用它。

但我认为由于磁盘空间写入速度，MySQL 会保持并减慢甚至增加 CPU 使用率......

看看下面的文章是否对你有帮助：http: [//kevin.vanzonneveld.net/techblog/article/improve_mysql_insert_performance/](http://kevin.vanzonneveld.net/techblog/article/improve_mysql_insert_performance/)

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2012-05-11T06:32:37.287

不要直接使用插入数据到 MySQL。而是创建两个 csv 文件。说`even_rawreports.csv`和`odd_rawreports.csv`。现在在偶数小时内（2:00 或 2:59 之间）继续记录每个 POST 请求，`even_rawreports.csv`并在奇数时间登录`odd_rawreports.csv`。

`even_rawreports.csv`编写一个每小时运行并在奇数小时和偶数小时读取的 cron 作业`odd_rawreports.csv`。

在 cron 中使用以下查询在一个查询中直接从 CSV 文件加载数据到 mysql。

```
LOAD DATA INFILE 'even_rawreports.csv' INTO TABLE rawreports (col1,col2,...)
    FIELDS TERMINATED BY '|' OPTIONALLY ENCLOSED BY '"'; 
```

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2012-05-10T06:59:44.197

虽然我同意使用纯文本日志文件或 NoSQL 数据库是更好的选择，但如果您要使用 MySQL，我认为您的瓶颈是 PHP。您是否使用持久连接和准备好的语句？如果没有，那就太浪费时间了。

您可以尝试使用[hsock 模块](https://github.com/arut/nginx-mysql-hsock-module)`nginx`直接连接到 MySQL 。

另请注意，EC2 小型实例没有良好的 I/O 性能。您需要升级到 large 才能获得支持每秒 300 个帖子所需的 I/O 性能。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2012-05-16T03:52:25.407

引入另一个数据库/二进制文件来支持 MySQL 似乎是最后的选择。在你到达那里之前，我希望你考虑一下：

[`MEMORY Storage Engine`](http://dev.mysql.com/doc/refman/5.0/en/memory-storage-engine.html)使用您定期刷新到主存储中的表创建一个表。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2012-05-04T21:47:24.853

你试过插入延迟吗？

我读到您有来自不同客户端的 300 个帖子/秒，但无论如何您可以使用 bundle 一次插入多行。

收集帖子和插入行的单独逻辑。因此，您需要 2 个脚本 - 例如，第一个脚本只是收集所有帖子并将数据保存到文件中。Second 每秒定期运行一次，并将所有数据插入到表中。

顺便说一句：您可以使用 NOW() 插入当前日期 -> 插入 rawreports(date, data, project_id) 值 (NOW(),

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2012-05-04T19:14:44.833

您可以使用准备好的语句尝试 PDO，以利用客户端和服务器之间的二进制通信。

只需每次更改参数并执行即可。

除了传输到服务器的开销较低之外，这可能有助于 CPU 争用，因为 MySQL 不必每次都解析查询。

您必须对数据进行批处理（排队）才能利用这一点。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2012-05-16T11:55:20.393

您是否尝试过使用存档存储引擎？如果您不需要更新/删除/替换，您应该尝试该选项。有关详细信息，请参阅[http://dev.mysql.com/doc/refman/5.0/en/archive-storage-engine.html 。](http://dev.mysql.com/doc/refman/5.0/en/archive-storage-engine.html)

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2012-05-15T13:59:26.447

基于 iostat，您在 5.5 上，我认为您受到亚马逊实例的 CPU 和磁盘 I/O 的限制。你能暂时转移到更快的实例，测量结果吗？没有太大的改进空间。MySQL 的 75ms 更新阶段显示它的 MySQL 杀死了你，而不是 PHP。我很惊讶300也是极限。我不确定数据完整性要求，但 MongoDB 可能适合您，甚至有受支持的 PHP 库。

# objective-c - 如何使用 FMDB 将图像（字节）保存和检索到 SQLite（blob）？

> ID：10454568
> 
> 赞同：3
> 
> 时间：2012-05-04T18:54:11.210
> 
> 标签：objective-c, ios, sqlite, fmdb

我正在制作一个需要显示来自远程站点（来自 URL）的一些图像的 iOS 应用程序，每次用户进入应该显示图像的屏幕时，应用程序都会冻结，直到下载完成。所以我想将已经下载的图像存储到一个名为 COVERS 的 SQLite 表中。

这是我如何下载和显示图像的代码：

假设movieCover是一个**UIImageView**，并且对象movie有一个名为cover的**NSURL**属性，其中包含要下载的图片的URL。

```
NSData *cover = [[NSData alloc] initWithContentsOfURL:movie.cover];
movieCover.image = [[UIImage alloc] initWithData:cover]; 
```

但是，我想把它改成这样：

```
NSData *cover = [appDelegate.dataBase getCoverForMovie:movie];
if( !cover ) {
    cover = [[NSData alloc] initWithContentsOfURL:movie.cover];
    [appDelegate.dataBase setCover:cover ToMovie:movie];
}

movieCover.image = [[UIImage alloc] initWithData:cover]; 
```

假设 appDelegate 是当前 ViewController 的一个属性，dataBase 是 AppDelegate 的一个属性，它使用 FMDB 来操作数据库中的数据。

我需要使用以下方法获取先前保存在数据库中的封面：

```
- (NSData *)getCoverForMovie:(Movie *)movie; 
```

但是，如果没有保存封面，则返回 nil。

所以我需要使用方法保存封面

```
- (BOOL)saveCover:(NSData *)cover ForMovie:(Movie *)movie; 
```

但我不知道如何编写这种方法。需要一些帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2014-08-22T01:35:07.060

## 基于 fmdb.m 示例的方法实现

```
- (NSData *)getCoverForMovie:(Movie *)movie
{
    NSData *cover = nil;

    FMDatabase *db = [FMDatabase databaseWithPath:databasePath];

    [db open];
    FMResultSet *results = [db executeQueryWithFormat:@"SELECT * FROM COVERS WHERE movie = %i", movie.movieID];

    if([results next])
    {
        cover = [results dataForColumn:@"cover"];
    }

    return cover;
}

- (BOOL)saveCover:(NSData *)cover ForMovie:(Movie *)movie
{
    BOOL result;

    FMDatabase *db = [FMDatabase databaseWithPath:databasePath];

    [db open];

    result = [db executeUpdate:@"INSERT OR REPLACE INTO COVERS (movie, cover) VALUES (?,?)", movie.movieID, cover];

    return result;
} 
```

感谢@ccgus 的回答。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-05T02:59:36.580

查看 FMDB 发行版中的 main.m - 它展示了如何保存和提取二进制 blob（以 safari 图标为例）”。

# android - 用于轻松实现多点触控的 Android 库，包括 Twist/Rotate 等？

> ID：10454570
> 
> 赞同：4
> 
> 时间：2012-05-04T18:54:17.930
> 
> 标签：android, multi-touch

有没有人在库或包形式中遇到过一个很好的实现，它实现了多点触摸处理，包括捏缩放、旋转、两指滑动等，并且相对容易扩展？

我编写了捏缩放和两指滑动的代码，但是已经有一段时间了，每次我需要扩展我的操作时，我都厌倦了重新学习这个有点混乱的 API，所有这些都是陷阱。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-07T17:44:13.597

在这一点上我能找到的最好的是

如何使用 -来自 Luke Hutchison[源代码的](http://code.google.com/p/android-multitouch-controller/)[多点触控控制器](http://paulbourke.blogspot.com/2011/10/writing-multitouch-applications-on.html)

如果其他人有更好的东西，请发布！

# javascript - Jquery在加载CSS ddsmoothmenu之前显示UL列表结构

> ID：10454578
> 
> 赞同：0
> 
> 时间：2012-05-04T18:55:10.977
> 
> 标签：javascript, jquery, asp.net, css

我正在为客户开发一个私人项目，并且我已经集成了 ddsmoothmenu。我和客户正在体验在菜单样式启动之前显示的列表的 UL 结构。

有没有办法让菜单加载之前完全样式化，这样它就不会闪现 UL 列表……曾经:)？

它不是每次都这样做。可能有十分之一的页面加载。

它在一个 ASP 网站上，我没有任何 javascript 错误。

请帮忙 ：）

谢谢！

Ĵ

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-04T18:57:41.797

您可以在列表加载之前隐藏列表，或者更快地调用 ddsmoothmenu，而不是等待 DOM 完成加载。如果您知道列表何时存在于 DOM 中，则不必等待 DOM。例子：

```
<ul id='menu'>
    <li>Whatever</li>
</ul>
<script>
    $('#menu').doSomethingNow();
</script> 
```

# html - 508 没有标题的兼容数据表？

> ID：10454579
> 
> 赞同：0
> 
> 时间：2012-05-04T18:55:11.370
> 
> 标签：html, section508

我需要创建符合 508 的代码，并且遇到了一个没有标题的表的问题。每行仅在左列中包含一个类别名称，在右列中包含值。所以我想我最初的问题是——这是一个数据表吗？是否应该以不同的方式表示，例如列表？如果它是一个有效的数据表，我必须为每列发明一个标题名称吗？信息采用从未有列标题的特定格式，所以我什至不确定客户是否想要这些，但我想知道我是否需要告诉他们他们必须在那里才能严格符合 508 ? 最后，有没有一种方法可以让那些使用屏幕阅读器的人可以访问这些标题，但普通观众看不到这些标题？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-05T05:08:14.710

是的，它是一个数据表——结构非常简单，但仍然如此。将其表示为 a`dl`是可能的，但会引发各种格式问题并且可能难以访问（因为浏览工具可能对 HTML 表格有特殊支持，几乎不支持`dl`）。

[508 规则](http://www.access-board.gov/sec508/guide/1194.22.htm)中的 (g) 条规定：“应为数据表标识行和列标题。” 严格的解释是每一行每一列都必须有一个标题。在您的情况下，这对行来说不是问题，因为第一列中的单元格在逻辑上是此处的行标题，因此您只需将`<td scope=row>`其用于它们。但是您需要添加一行列标题。

目前尚不清楚这是否需要合规；该规则没有“全部”一词，解释性散文说“每个表的第一行应包括列标题。” 所以它使用“should”，而不是“shall”或“must”。

如果规则需要列标题，我会说它们是，例如使用客户端脚本添加它们是不可接受的（因为当脚本被禁用时它们将不存在）。仅在某些浏览模式下使用它们也是不可接受的；规则是通用的（即使在“正常”浏览时，标题也确实很有用）。

考虑向看不到它的人大声朗读该页面的行为。如果表格的内容刚开始时没有警告或解释，可能会造成混淆。即使在图形浏览中，用户也可能会感到困惑，部分取决于认知困难。表格前的文字说明（在标题或文本段落中）、表格的标题和一行列标题都可能在这里有所帮助。列标题的内容应作为其中的一部分进行规划；如果在其他案文中说明情况，它们可能会相当简洁。

# c# - NHibernate 使用 Criteria API 加载子元素/集合

> ID：10454584
> 
> 赞同：0
> 
> 时间：2012-05-04T18:55:27.680
> 
> 标签：c#, nhibernate, collections, eager-loading

如何使用 Criteria API 加载子元素和子集合。我已经阅读了几乎可以在 google 上找到的所有链接，但不会加载子元素。

这是我的设置

订单有 OrderItems 并且在我的 DTO 中指定

在订单的流畅映射功能中，我有以下值得注意的行：

```
LazyLoad();
this.HasMany<OrderItems>(x => x.OrderItems).KeyColumns.Add(new[] { "OrderId"}); 
```

在我的存储库类中，我从标准类创建查询并检索一个列表：

```
DetachedCriteria query = criteria.CreateCriteria();
IList<Orders> myOrders = 
    query.GetExecutableCriteria(UnitOfWork.CurrentSession).List<Orders>(); 
```

当我尝试访问 myOrders.OrderItems 时，它们是空的（它们肯定在我的数据库中）。我假设映射函数中的 LazyLoad() 调用将启用此功能...

所以我试着像这样急切地加载：

```
query.SetFetchMode("Orders.OrderItems", NHibernate.FetchMode.Eager) 
```

但这也不起作用。

我哪里错了？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-05T10:10:29.420

试试这个映射供您参考：

```
this.References<OrderItems>(x => x.OrderItems)
    .Column("OrderId")
    .LazyLoad(); 
```

或者

```
this.References<OrderItems>(x => x.OrderItems)
    .Column("OrderId")
    .Not.LazyLoad(); 
```

# javascript - 暂停直到使用 jquery 或 javascript 完成事件/函数

> ID：10454586
> 
> 赞同：0
> 
> 时间：2012-05-04T18:55:31.867
> 
> 标签：javascript, jquery

有没有办法使用 javascript 或 jquery 检查函数是否已完成其操作？

我正在尝试使用 setTimeout 制作一个随着数字变大而减慢的计数器（如果你愿意，可以减慢输出）。如您所知，数字越大，延迟时间越长（在 setTimeout 中）。

我要做的是单击一个按钮，然后在屏幕上打印当前循环迭代。此循环数用作 setTimeout 延迟，因此当数字较低时，它会迅速冲过，随着它变大延迟较大，因此使其打印数字更慢（因为此数字是延迟，延迟越大它打印的频率越低）。

```
Here is the logic I'm trying to accomplish
1\. Click button
2\. Initiate loop
3\. trigger function to set timeout
4\. set timeout triggers a function to print the loop iteration #
5\. Repeat step 3 until the number of set iterations is completed 
```

好吧，正如您所看到的，当设置超时时，循环将继续，但会有超时延迟。有什么办法可以放置一个暂停类型的函数，等待超时函数完成，然后继续下一次迭代？

这是我的代码

```
<html>
<head>
<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.7.1/jquery.min.js" type="text/javascript"></script>
</head>

<body>
<form>
<input type="button" value="Display alert box"
onclick="setMessage()" />

<script>

 function setMessage(){
 for(i=0;i<5000;i++){
 var b = i;
 timeMsg();
//some sort of puase here checking until timeMsg & docWrite are completed, then continue to the next iteration
    }
}

function timeMsg(){
var t=setTimeout("docWrite()",b);
}   

function docWrite(){
document.write(i);
}
</script>
</form>
</body>
</html> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-04T19:03:22.960

我建议不要在 for 循环中执行此操作，而是执行以下操作：

```
function docWrite(i){
    document.write(i);
}

function timeMsg(counter) {
  var t;

  counter++;
  if (counter < 5000) {
    t = setTimeout(function(counter){ 
      docWrite(counter);
      timeMsg(counter);
    }, counter, counter)    
  }
}

timeMsg(0); 
```

# ruby - 带有 ruby 1.8 语法问题的 Rails 3.2（意外的 tASSOC，期待 '}'，意外的 ':'，期待 kEND）

> ID：10454590
> 
> 赞同：0
> 
> 时间：2012-05-04T18:56:01.627
> 
> 标签：ruby, deployment, syntax, ruby-on-rails-3.2

我正在尝试部署一个 ruby​​ 版本为 1.8 的 rails 3.2 应用程序。我可以解决一些我遇到的哈希语法问题，但仍有一个我无法克服：

注意我雇佣了一个不会安装 ruby​​ 1.9 的托管服务。

错误是

```
from {app_path}/config/environment.rb:5
[ pid=586526 thr=203092280 file=utils.rb:176 time=2012-05-04 15:32:29.667 ]: *** Exception SyntaxError in PhusionPassenger::Rack::ApplicationSpawner ({app_path}/config/initializers/wrap_parameters.rb:8: syntax error, unexpected tASSOC, expecting '}'
{app_path}/config/initializers/wrap_parameters.rb:8: warning: don't put space before argument parentheses
{app_path}/config/initializers/wrap_parameters.rb:8: warning: don't put space before argument parentheses
from {app_path}/config/environment.rb:5
[ pid=539635 thr=202883380 file=utils.rb:176 time=2012-05-04 14:30:21.570 ]: *** Exception SyntaxError in PhusionPassenger::Rack::ApplicationSpawner ({app_path}/config/initializers/wrap_parameters.rb:8: syntax error, unexpected ':', expecting kEND
from {app_path}/config/environment.rb:5
[ pid=539635 thr=202883380 file=utils.rb:176 time=2012-05-04 14:29:31.744 ]: *** Exception SyntaxError in PhusionPassenger::Rack::ApplicationSpawner ({app_path}/config/initializers/wrap_parameters.rb:8: syntax error, unexpected ':', expecting kEND 
```

该文件是config/initializers/wrap_parameters.rb，内容如下：

```
ActiveSupport.on_load(:action_controller) do
  # it was originally 
  # wrap_parameters format: [:json] # ruby 1.9 syntax

  # the follow line is line 8
  wrap_parameters :format => [:json] # ruby 1.8 syntax

  # i already tried
  # wrap_parameters {:format => [:json]}
  # wrap_parameters({:format => [:json]})
  # wrap_parameters(:format => [:json])

end

# Disable root element in JSON by default.
ActiveSupport.on_load(:active_record) do
  self.include_root_in_json = false
end 
```

这是配置/环境.rb

```
#config/environment.rb 
# Load the rails application
require File.expand_path('../application', __FILE__)

# Initialize the rails application
Flog::Application.initialize! 
```

我花了几个小时试图摆脱这个问题。

提前谢谢你

# objective-c - 错误消息“应用程序在应用程序启动结束时应该有一个根视图控制器”

> ID：10454591
> 
> 赞同：0
> 
> 时间：2012-05-04T18:56:03.567
> 
> 标签：objective-c, ios, xcode, xcode4.2

我试图在我的 iPhone 模拟器（使用 Xcode 4.2）上简单地查看一个空表，但不知何故我不知道我做错了什么。现在它只显示一个纯白页面。实际上它应该给我一张桌子。

注意：我按照 Big Nerd Ranch 指南“iPhone 编程”第 10 章的说明进行操作。

所以现在我有 4 个 Homepwner-App 文件：

*   HomepwnerAppDelegate.m
*   HomepwnerAppDelegate.h
*   ItemsViewController.h
*   项目视图控制器.m

“ItemsViewController”是 UITableViewController 的子类。

**ItemsViewController.h**

```
# import <UIKit/UIKit.h>

    @interface ItemsViewController : UITableViewController

@end 
```

**项目视图控制器.m**

```
isn't filled with interesting stuff right now 
```

**HomepwnerAppDelegate.h**

```
# import <UIKit/UIKit.h>

@class ItemsViewController;

@interface HomepwnerAppDelegate : NSObject <UIApplicationDelegate> {
    UIWindow *window;
    ItemsViewController *itemsViewController; }  

@property (nonatomic, retain) IBOutlet UIWindow *window;

@end 
```

**HomepwnerAppDelegate.m**

```
#import "HomepwnerAppDelegate.h"
#import "ItemsViewController.h"

@implementation HomepwnerAppDelegate

@synthesize window = _window;

- (BOOL)application:(UIApplication *)application didFinishLaunchingWithOptions:(NSDictionary *)launchOptions
{
    //Create a ItemsViewController
    itemsViewController = [[ItemsViewController alloc] init];

    //Place ItemsViewController's table view in the window hierarchy
    [window addSubview:[itemsViewController view]];
    [window makeKeyAndVisible];
    return YES;
} 
```

@结尾

控制台说： Homepwner[2400:207] 应用程序应该在应用程序启动结束时有一个根视图控制器

我知道已经有其他线程具有相同的错误消息，并且其中很多都链接在“didFinishLaunchingWithOptions：”方法中，但是由于它们提供了很多解决方案，所以我现在很困惑，尤其是因为我只是按照说明进行操作书，仅此而已……我只是觉得我宣布了一些错误。如何解决问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-05T00:43:28.283

我不知道它的价值，但是，你试过了吗

```
self.window.rootViewController = itemsViewController; 
```

当我遇到这个问题时，这就是我解决它的方法。

# domain-driven-design - “富域模型”会违反单一职责原则吗？

> ID：10454593
> 
> 赞同：21
> 
> 时间：2012-05-04T18:56:09.550
> 
> 标签：domain-driven-design, single-responsibility-principle, anemic-domain-model

刚才我输入这个问题时，出现了[一个有趣的线程。](https://stackoverflow.com/q/8808314/304832)我不认为它回答了我的问题。

我一直在使用 .NET MVC3 进行大量工作，希望有一个贫血模型。视图模型和编辑模型最好作为愚蠢的数据容器，您可以将它们从控制器传递到视图。任何类型的应用程序流都应该来自控制器，视图处理 UI 问题。在 MVC 中，我们不希望模型中有任何行为。

但是，我们也不希望控制器中有任何业务逻辑。对于较大的应用程序，最好将域代码与模型、视图和控制器（以及通常的 HTTP）分开并独立于模型、视图和控制器。因此，有一个单独的项目首先提供域模型（具有实体和值对象，根据 DDD 组合成聚合）。

我已经做了一些尝试，从一个贫乏的模型转向更丰富的域代码模型，我正在考虑放弃。在我看来，拥有既包含数据又包含行为的实体类违反了 SRP。

以网络上一个非常常见的场景为例，撰写电子邮件。给定一些事件，域有责任在给定 EmailTemplate、EmailAddress 和自定义值的情况下编写一个 EmailMessage 对象。模板作为具有属性的实体存在，并且自定义值作为用户输入提供。为了论证，我们还假设 EmailMessage 的 FROM 地址可以由外部服务 (IConfigurationManager.DefaultFromMailAddress) 提供。鉴于这些要求，富域模型似乎可以让 EmailTemplate 负责编写 EmailMessage：

```
public class EmailTemplate
{
    public EmailMessage ComposeMessageTo(EmailAddress to, 
        IDictionary<string, string> customValues, IConfigurationManager config)
    {
        var emailMessage = new EmailMessage(); // internal constructor
                                            // extension method
        emailMessage.Body = this.BodyFormat.ApplyCustomValues(customValues);
        emailMessage.From = this.From ?? config.DefaultFromMailAddress;
        // bla bla bla
        return emailMessage;
    }
} 
```

这是我对富域模型的尝试之一。但是，在添加此方法后，EmailTemplate 负责包含实体数据属性和撰写消息。它大约有 15 行长，似乎分散了全班学生对成为 EmailTemplate 的真正含义的注意力——IMO 只是存储数据（主题格式、正文格式、附件和可选的发件人/回复地址）。

我最终将此方法重构为一个专门的类，该类的唯一责任是根据前面的参数编写一个 EmailMessage，我对此更满意。事实上，我开始更喜欢贫血领域，因为它帮助我保持职责分离，使类和单元测试更短、更简洁、更专注。似乎使实体和其他数据对象“没有行为”可以很好地分离责任。还是我在这里偏离轨道？

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2012-05-07T22:17:16.433

支持丰富领域模型而不是贫乏模型的论点取决于 OOP 的价值主张之一，即保持行为和数据彼此相邻。核心好处是封装和凝聚力，有助于推理代码。富领域模型也可以看作是[信息专家的一个实例](http://en.wikipedia.org/wiki/GRASP_%28object-oriented_design%29#Information_Expert)图案。然而，所有这些模式的价值在很大程度上是主观的。如果将数据和行为分开对您更有帮助，那么就这样吧，尽管您可能还会考虑其他将查看代码的人。我更喜欢尽可能多地封装。在这种情况下，更丰富的域模型的另一个好处是可以将某些属性设为私有。如果一个属性只被类中的一种方法使用，为什么要公开它？

富域模型是否违反 SRP 取决于您对责任的定义。根据 SRP，责任是改变的理由，这本身就需要一个定义。该定义通常取决于手头的用例。您可以声明模板类的职责是成为一个模板，包含所有出现的含义，其中之一是从模板生成消息。模板属性之一的更改可能会影响`ComposeMessageTo`方法，这表明这些可能是单一职责。此外，`ComposeMessageTo`方法是模板中最有趣的部分。模板的客户不关心方法是如何实现的，也不关心模板类的属性是什么。他们只想根据模板生成消息。这也投票赞成将数据保留在方法旁边。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-07-26T08:14:46.590

好吧，这取决于您要如何看待它。

另一种方式是：*“单一职责原则会违反富域模型吗？”*

两者都是指导方针。软件设计中没有任何“原则”。然而，有好的设计和坏的设计。这两个概念都可以以不同的方式使用，以实现良好的设计。

# c# - 从数据库加载 PictureBox 图像

> ID：10454595
> 
> 赞同：10
> 
> 时间：2012-05-04T18:56:24.497
> 
> 标签：c#, sql-server

我正在尝试将图像从数据库加载到`PictureBox`. 我使用以下这些代码将它们加载到我的图片中。我已经写了一些代码，但不知道我应该怎么做才能继续。

任何帮助将不胜感激。

```
private void button1_Click(object sender, EventArgs e)
    {
        sql = new SqlConnection(@"Data Source=PC-PC\PC;Initial Catalog=Test;Integrated Security=True");
        cmd = new SqlCommand();
        cmd.Connection = sql;
        cmd.CommandText = ("select Image from Entry where EntryID =@EntryID");
        cmd.Parameters.AddWithValue("@EntryID", Convert.ToInt32(textBox1.Text));
    } 
```

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2012-05-04T19:12:51.280

在 button1_Click 中继续这样的操作：

```
// Your code first, here.

var da = new SqlDataAdapter(cmd);
var ds = new DataSet();
da.Fill(ds, "Images");
int count = ds.Tables["Images"].Rows.Count;

if (count > 0)
{ 
    var data = (Byte[])ds.Tables["Images"].Rows[count - 1]["Image"];
    var stream = new MemoryStream(data);
    pictureBox1.Image = Image.FromStream(stream);
} 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-05-04T19:02:41.507

假设我们有一个简单的数据库，其中有一个名为`BLOBTest`：

```
CREATE TABLE BLOBTest
(
BLOBID INT IDENTITY NOT NULL,
BLOBData IMAGE NOT NULL
) 
```

我们可以通过以下方式检索图像以进行编码：

```
try
{
    SqlConnection cn = new SqlConnection(strCn);
    cn.Open();

    //Retrieve BLOB from database into DataSet.
    SqlCommand cmd = new SqlCommand("SELECT BLOBID, BLOBData FROM BLOBTest ORDER BY BLOBID", cn);   
    SqlDataAdapter da = new SqlDataAdapter(cmd);
    DataSet ds = new DataSet();
    da.Fill(ds, "BLOBTest");
    int c = ds.Tables["BLOBTest"].Rows.Count;

    if(c>0)
    {   //BLOB is read into Byte array, then used to construct MemoryStream,
        //then passed to PictureBox.
        Byte[] byteBLOBData =  new Byte[0];
        byteBLOBData = (Byte[])(ds.Tables["BLOBTest"].Rows[c - 1]["BLOBData"]);
        MemoryStream stmBLOBData = new MemoryStream(byteBLOBData);
        pictureBox1.Image= Image.FromStream(stmBLOBData);
    } 
    cn.Close();
}
catch(Exception ex)
{MessageBox.Show(ex.Message);} 
```

此代码`BLOBTest`将数据库中表中的行检索到 a`DataSet`中，将最近添加的图像复制到`Byte`数组中，然后复制到`MemoryStream`对象中，然后将 加载`MemoryStream`到控件的`Image`属性中`PictureBox`。

**完整参考指南：**

[http://support.microsoft.com/kb/317701](http://support.microsoft.com/kb/317701)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-10-11T08:52:26.917

```
private void btnShowImage_Click(object sender, EventArgs e)
{
    string constr = "Provider=Microsoft.Jet.OLEDB.4.0;Data Source=.\\PIS(ACU).mdb;";
    Con = new OleDbConnection(@constr);
    Con.Open();
    Com = new OleDbCommand();
    Com.Connection = Con;     
    Com.CommandText = "SELECT Photo FROM PatientImages WHERE Patient_Id =  " + val + " ";
    OleDbDataReader reader = Com.ExecuteReader();
    if (reader.Read())
    {
        byte[] picbyte = reader["Photo"] as byte[] ?? null;
        if (picbyte != null)
        {
            MemoryStream mstream = new MemoryStream(picbyte);
            pictureBoxForImage.Image = System.Drawing.Image.FromStream(mstream);
        {
        System.Drawing.Bitmap bmp = new System.Drawing.Bitmap(mstream);
    }
} 
```

# sql - 如何查询包含方括号的列名？

> ID：10454597
> 
> 赞同：12
> 
> 时间：2012-05-04T18:56:34.267
> 
> 标签：sql, vb.net

我有一个 csv，我需要将其解析为 vb.net 中的 gridview。如果我选择 *，我会毫无问题地获得数据。但是，我处于需要引用实际列名的情况。问题是，我无法控制生成 csv 的应用程序，它们将列名括在方括号中。

我怎么能做这样的事情：

```
Dim cmdSelect As New OleDbCommand(SELECT "[name], [height] FROM myTable") 
```

所以我得到数据的回报？

所以，为了完全清楚：我有一个应用程序，它在名为 myTable 的表中创建一个带有列标题 [name] 和 [height] 的 csv，而对于我的生活，我无法弄清楚如何返回[姓名]和[身高]具体​​。

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2012-05-04T19:02:27.843

如果列名带有方括号，则可以使用双引号将列名括起来。下面的示例在 SQL Server 中进行了测试。

*脚本*：

```
CREATE TABLE dbo.myTable
(
        "[name]" varchar(max) not null
    ,   "[height]" int not null
); 
```

*查询所有列*：

```
SELECT * FROM dbo.myTable 
```

*仅查询特定列*：

```
SELECT "[name]", "[height]" FROM dbo.myTable 
```

*VB.NET 代码 - 示例 1*：

```
Dim query As String = String.Format("SELECT {0}{1}{0}, {0}{2}{0} FROM dbo.myTable", """", "[name]", "[height]")
Dim cmdSelect As New OleDbCommand(query) 
```

*VB.NET 代码 - 示例 2*：

```
Dim query As String = String.Format("SELECT {0}[name]{0}, {0}[height]{0} FROM dbo.myTable", """")
Dim cmdSelect As New OleDbCommand(query) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-04T21:44:21.613

我假设这是针对 SQL Server 的。

包含 ] 字符的对象应使用 [] 引用。

对于下表：

```
CREATE TABLE [t]]] (
  [i]]d] int primary key,
  [da]]]ta] int
) 
```

您可以使用以下命令从中进行选择：

```
SELECT [da]]ta], [i]]d] FROM [t]]] 
```

如果您正在寻找在 T-SQL 中引用对象名称的方法，您可以使用 QUOTENAME。

```
SELECT QUOTENAME('t]') 
```

在 SQL Server 中，您还可以使用双引号来引用对象名称；但是，您需要验证两件事。

首先，您需要确保启用了 QUOTED_IDENTIFIER。一些驱动程序会自动为您服务。

```
SET QUOTED_IDENTIFIER ON 
```

第二个想法是你需要做的是确保你在你的对象名称中转义了任何其他双引号。在 T-SQL 中，QUOTENAME 再次提供了帮助。

```
SELECT QUOTENAME('t"]')

"t""]" 
```

在 VB.Net 中，您需要执行以下操作：

```
dim queryStr As String = String.Format("SELECT ""{1}"" FROM dbo.myTable", String.Replace(col1, """", """""")) 
```

# c# - 什么相当于 Silverlight 中的 Winform Control.Handle？

> ID：10454598
> 
> 赞同：0
> 
> 时间：2012-05-04T18:56:35.687
> 
> 标签：c#, winforms, silverlight, silverlight-5.0

如题。

我想将我的 Silverlight 应用程序注册为剪贴板查看器，因此它需要我的控制句柄。

我一直在 msdn 和 google 中搜索，但没有找到任何东西。它甚至存在吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-04T19:14:14.307

控制句柄是一个 HWND，一个窗口句柄，据我所知，SL 中没有窗口。例如，如果您在 WPF 下，则 WindowInteropHelper 类就是这样做的。

关于 SL，一搜就有如下： [SilverlightContainer.WindowHandle 属性](http://msdn.microsoft.com/en-us/library/microsoft.visualstudio.testtools.uitest.extension.silverlight.silverlightcontainer.windowhandle.aspx)

但是不确定您是否能够使用它，它是 .NET 基础架构的一部分。

# c# - C# 中的自动完成块

> ID：10454599
> 
> 赞同：3
> 
> 时间：2012-05-04T18:56:38.993
> 
> 标签：c#

我习惯了 Eclipse 和 Java 开发，但因为我的工作，我需要开始用 C# 编码。我觉得 Visual Studio 不自动完成我的块有点烦人。例如，当我编写一个新函数、类或语句时，习惯于 IDE 自动完成我的块。所以当我输入：

```
private function sendData(String msg, String email) { 
```

并`enter`自动出现右括号，是否有任何设置可以启用此功能`Microsoft visual C# 2010 express`？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-04T18:59:20.977

**这对于 Express 版本是不可能的**，因为您无法安装扩展。您需要使用**Professional 或更高版本并使用第三方扩展**。一些简单的免费工具可以做到这一点（例如[Productivity Power Tools](http://visualstudiogallery.msdn.microsoft.com/d0d33361-18e2-46c0-8ff2-4adea1e34fef)），商业产品[ReSharper](http://www.jetbrains.com/resharper/)也是如此，它做得更多。后者可能会使 Visual Studio 具有您可能习惯于从 Eclipse 中获得的其他功能，例如更多的重构支持。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-04T18:59:38.700

我几乎可以肯定 Productivity Power Tools 扩展将为您提供此功能。你可以在这里找到它：

[http://visualstudiogallery.msdn.microsoft.com/d0d33361-18e2-46c0-8ff2-4adea1e34fef](http://visualstudiogallery.msdn.microsoft.com/d0d33361-18e2-46c0-8ff2-4adea1e34fef)

这确实是一个很棒的附加组件，它可以让您更好地控制这样的选项。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-04T19:02:28.437

Visual Studio 中没有内置这样的功能，但您可以安装像[Brace Completer](http://visualstudiogallery.msdn.microsoft.com/0e33cb22-d4ac-4f5a-902f-aff5177cc94d/)这样的插件来添加功能。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-04T18:59:06.413

不，您不能在 Visual Studio 中默认执行此操作。访问[Microsoft Connect](http://connect.microsoft.com)以提交功能请求。

# java - 休眠 SQL 异常

> ID：10454601
> 
> 赞同：0
> 
> 时间：2012-05-04T18:56:47.607
> 
> 标签：java, hibernate, sqlexception

从过去几天开始，当我在 netbeans IDE 中运行 Java struts2 web 应用程序时，我在 ApacheTomcat 日志中遇到了这个奇怪的异常。我无法弄清楚代码的哪一部分导致了这个异常。

```
May 5, 2012 12:16:47 AM org.apache.catalina.core.StandardWrapperValve invoke
SEVERE: Servlet.service() for servlet [default] in context with path [/latest-raisin]   
threw exception [org.hibernate.exception.GenericJDBCException: Could not execute JDBC 
batch update] with root cause
java.sql.SQLException: Data truncated for column 'synsettype' at row 1
at com.mysql.jdbc.SQLError.createSQLException(SQLError.java:1073)
at com.mysql.jdbc.MysqlIO.checkErrorPacket(MysqlIO.java:3603)
at com.mysql.jdbc.MysqlIO.checkErrorPacket(MysqlIO.java:3535)
at com.mysql.jdbc.MysqlIO.sendCommand(MysqlIO.java:1989)
at com.mysql.jdbc.MysqlIO.sqlQueryDirect(MysqlIO.java:2150)
at com.mysql.jdbc.ConnectionImpl.execSQL(ConnectionImpl.java:2626)
at com.mysql.jdbc.PreparedStatement.executeInternal(PreparedStatement.java:2119)
at com.mysql.jdbc.PreparedStatement.executeUpdate(PreparedStatement.java:2415)
at 
com.mysql.jdbc.PreparedStatement.executeBatchSerially(PreparedStatement.java:1976)
at com.mysql.jdbc.PreparedStatement.executeBatch(PreparedStatement.java:1449)
at 

com.mchange.v2.c3p0.impl.NewProxyPreparedStatement.executeBatch(NewProxyPreparedStatement.java:1723)
at org.hibernate.jdbc.BatchingBatcher.doExecuteBatch(BatchingBatcher.java:70)
at org.hibernate.jdbc.AbstractBatcher.executeBatch(AbstractBatcher.java:268)
at org.hibernate.jdbc.AbstractBatcher.prepareStatement(AbstractBatcher.java:114)
at org.hibernate.jdbc.AbstractBatcher.prepareStatement(AbstractBatcher.java:109)
at org.hibernate.jdbc.AbstractBatcher.prepareBatchStatement(AbstractBatcher.java:244)
at org.hibernate.persister.entity.AbstractEntityPersister.update(AbstractEntityPersister.java:2541)
at org.hibernate.persister.entity.AbstractEntityPersister.updateOrInsert(AbstractEntityPersister.java:2494)
at org.hibernate.persister.entity.AbstractEntityPersister.update(AbstractEntityPersister.java:2821)
at org.hibernate.action.EntityUpdateAction.execute(EntityUpdateAction.java:113)
at org.hibernate.engine.ActionQueue.execute(ActionQueue.java:273)
at org.hibernate.engine.ActionQueue.executeActions(ActionQueue.java:265)
at org.hibernate.engine.ActionQueue.executeActions(ActionQueue.java:185)
at org.hibernate.event.def.AbstractFlushingEventListener.performExecutions(AbstractFlushingEventListener.java:321)
at org.hibernate.event.def.DefaultFlushEventListener.onFlush(DefaultFlushEventListener.java:51)
at org.hibernate.impl.SessionImpl.flush(SessionImpl.java:1216)
at org.hibernate.impl.SessionImpl.managedFlush(SessionImpl.java:383)
at org.hibernate.transaction.JDBCTransaction.commit(JDBCTransaction.java:133)
at com.generalsentiment.management.filters.PersistenceSessionFilter.doFilter(PersistenceSessionFilter.java:48)
at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:243)
at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:210)
at com.generalsentiment.management.filters.DisableUrlSessionFilter.doFilter(DisableUrlSessionFilter.java:91)
at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:243)
at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:210)
at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:224)
at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:169)
at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:472)
at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:168)
at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:100)
at org.apache.catalina.valves.AccessLogValve.invoke(AccessLogValve.java:929)
at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:118)
at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:405)
at org.apache.coyote.http11.AbstractHttp11Processor.process(AbstractHttp11Processor.java:964)
at org.apache.coyote.AbstractProtocol$AbstractConnectionHandler.process(AbstractProtocol.java:515)
at org.apache.tomcat.util.net.JIoEndpoint$SocketProcessor.run(JIoEndpoint.java:302)
at java.util.concurrent.ThreadPoolExecutor$Worker.runTask(ThreadPoolExecutor.java:886)
at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:908)
at java.lang.Thread.run(Thread.java:662) 
```

Info - synsettype 实际上是 Synset 表中的一列。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-04T19:08:06.800

我猜您尝试插入的数据对于该列来说太长了。尝试增加列的大小

# r - 替代 sqlite 或更好的方法来处理 sqlite 中的日期/时间字段

> ID：10454602
> 
> 赞同：5
> 
> 时间：2012-05-04T18:56:55.610
> 
> 标签：r, sqlite, date, data.table

我的数据往往是中型到大型，但从不符合“大”数据的条件。数据几乎总是复杂的关系。出于我在这里讨论的目的，10-50 个表，总大小为 1-10 GB。而已。当我处理比这更大的数据时，我会把它放到 Postgres 或 SQL Server 中。

总的来说，我喜欢 SQLite，但我使用的数据有很多日期/日期时间字段，在 SQLite 中处理日期字段让我很头疼，当我在 R 和 SQLite 之间来回移动数据时，我的日期经常被弄乱.

我正在寻找一种基于文件的 SQLite 替代方案，该替代方案在 R 中易于使用。

*或者*

用于将数据移入/移出 SQLite 和 R 而不破坏日期的更好技术/包。我的目标是停止破坏我的约会。例如，当我使用 RSQLite 包中的 dbWriteTable 时，我的日期通常会以一种无法使用的方式搞砸。

我的主要工作站运行的是 Ubuntu，但我在一个以 Windows 为主的办公室工作。如果建议使用 SQLite 的替代方案，则 +++ 可以在两个平台（或更多平台）上工作的替代方案。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-14T16:24:39.397

使用纪元时间和日期（从原点开始的天数，从原点算起的秒数）。使用 epoch 到 R POSIXct 或 Date 的转换很快（字符串非常慢）。

编辑：另一种选择，在重新阅读并考虑数据的大小后：

您可以简单地将表直接保存为 R 格式，也许还有一小部分额外的元数据来描述表之间的关键关系。您必须创建自己的约定和所有约定，但它肯定更平滑（没有阻抗不匹配）。

另外，我个人非常偏爱这个包`data.table`。它速度快，语法是纯 R 语言，但很好地映射到 SQL 概念。例如 in `dt[i, j, by=list(...)]`，`i`对应于“where”，`j`对应于“select”和`by`“group by”，并且还有用于连接的工具，尽管我在它们周围编写了中缀包装器，因此更容易记住。

我通常只在 R 中完成我的数据处理工作（在从 SQLITE 初始提取之后），我发现 data.table 比大量 SQLDF 查询更快、更实用。

[http://datatable.r-forge.r-project.org/](http://datatable.r-forge.r-project.org/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-05-23T22:00:37.573

sqlite想读取标准格式“YYYY-MM-DD HH:MM:SS”的数据（不需要的可以省略时间部分）---我不知道怎么读任意日期字符串。这导致存储标准化的日期。

在输出时，您想使用 sqlite 函数将日期格式化为您其他软件需要的任何内容——检查 strftime() 的选项。

例如，Octave 喜欢从 0 年开始的天数，所以如果我有一个表 mydata 的列“日期”，我会这样做

从 mydata 中选择 julianday(mydate)-1721059.666667

The magic number is julianday("0000-01-01T00:00:00-04:00") and compensates for the fact that julianday starts in year 4017BC or something like that, whereas Octave counts from year 0.

# wpf - 以老式方式向 DataGrid 添加行（非绑定）

> ID：10454610
> 
> 赞同：0
> 
> 时间：2012-05-04T18:57:22.550
> 
> 标签：wpf, wpfdatagrid

我想以老式的方式以编程方式将行添加到 DataGrid。我有一个非常快速的表单，我想将其中的几个 DataGrids 放在一起，并且我正在尝试向它们添加行。我不想在这种情况下使用 MVVM 绑定模式，因为我想保持低代码行数。

我试过这个，但它不适合我：

```
private static void FillGrid(DataGrid grid, IEnumerable<decimal> values)
{
    foreach (var item in values)
    {
        grid.Items.Add(item);
    }
} 
```

数据网格以非常小的行结束，其中没有数据。它看起来像[这个图像](http://i.imgur.com/dtZDP.png)。我还尝试将我的值包装在一个类中并将该类的对象添加到 DataGrid，但我得到了相同的结果。这是代码：

```
private class MyClass { public decimal MyDecimal { get; set; } }
private static void FillGrid(DataGrid grid, IEnumerable<decimal> values)
{
    foreach (var item in values)
    {
        grid.Items.Add(new MyClass() { MyDecimal = item });
    }
} 
```

我对 Windows 窗体有更多的经验。我发现 MVVM 绑定繁琐、过于复杂且难以调试。如何使此代码正常工作？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-04T22:49:36.593

您的代码正在运行，但您必须告诉`DataGrid`如何处理数据。

```
<DataGrid>
    <DataGrid.Columns>
        <DataGridTextColumn Binding="{Binding}" />
    </DataGrid.Columns>
</DataGrid> 
```

不幸的是，我还没有找到没有绑定的更短的方法。

# css - 有没有办法只使用 CSS 来获得倾斜的盒子阴影？

> ID：10454611
> 
> 赞同：1
> 
> 时间：2012-05-04T18:57:25.103
> 
> 标签：css

我想要类似[CSS-Tricks](http://css-tricks.com/)上的徽标，但使用 CSS 而不是图像文件，因此可以调整其大小。这可能吗？

像这样的图像：

![CSS 技巧徽标](../Images/c539a7ad0b1381c13e2954159c52610f.png)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-04T19:35:45.120

# 带有切角的纯 CSS 倾斜阴影

这需要一段时间来完善，但现在它在横幅下方有一个倾斜的阴影，它也有切角和多个边框。所有的效果，包括背景、标志和阴影，都是用纯 CSS 生成的。

[在 jsFiddle 上查看](http://jsfiddle.net/keKpP/61/) ![带有切角和多个边框的纯 CSS 倾斜阴影](../Images/aa6b898845cb536f7f3ea1c79de7fc32.png)

## HTML

```
<div class="wrapper">
 <div>
  <h1><span>CSS</span>-Tricks</h1>
  <h2>A Web Design Community</h2>
 </div>
</div>
<div class="body">
 <div></div>
</div> 
```

## CSS

```
<style type="text/css">
body {
    min-width:600px;
    background-image:-webkit-repeating-linear-gradient(135deg, #d8d2ce, #d8d2ce 6px, #ccc6c3 7px, #d8d2ce 8px);
    background-image:repeating-linear-gradient(135deg, #d8d2ce, #d8d2ce 6px, #ccc6c3 7px, #d8d2ce 8px);
    background-color:#d8d2ce;
}
.wrapper {
    position:relative;
    margin:77px 46% 10% -10%;
}
.wrapper div:after,
.wrapper div:before {
    content:".";
    font-size:0;
    color:transparent;
    background-color:#bcb9b7;
    position:absolute;
    right:-12px;
    height:50%;
    width:40px;
    padding-top:2.5px;
    border-right:8px solid #afafaf;
}
.wrapper div:after {
    background-image:
        linear-gradient(90deg, transparent, transparent 38px, #c5c5c5 38px, #c5c5c5 40px),
        linear-gradient(180deg, #c5c5c5 0px, #c5c5c5 2px, transparent 2px);
    border-top:8px solid #afafaf;
    top:-10px;
    -webkit-transform-origin:100% 0;
    -webkit-transform: skewX(25deg);
    -ms-transform-origin:100% 0;
    -ms-transform: skewX(25deg);
    transform-origin:top right;
    transform: skewX(25deg);
}
.wrapper div:before {
    background-image:
        linear-gradient(90deg, transparent, transparent 38px, #c5c5c5 38px, #c5c5c5 40px),
        linear-gradient(0deg, #c5c5c5, #c5c5c5 2px, transparent 2px);
    border-bottom:8px solid #afafaf;

    bottom:-10px;
    right:-12px;

    -webkit-transform-origin:100% 100%;
    -webkit-transform: skewX(-25deg);
    -ms-transform-origin:100% 100%;
    -ms-transform: skewX(-25deg);
    transform-origin:bottom right;
    transform: skewX(-25deg);
}
.wrapper div {
    background:#bcb9b7;
    position:relative;
    z-index:2;
    top:-8px;
    left:-8px;
    border:2px solid #c5c5c5;
    box-shadow:0 0 0 8px #afafaf;
    text-align:right;
    text-transform:uppercase;
    font-family:sans-serif;
    color:#ffffff;
    font-size:40px;
    letter-spacing:.05em;
    padding:.55em .7em .55em;
}
.wrapper div h1:after {
    content:"*";
    color:#e5e1de;
    font-weight:bold;
    position:relative;
    top:-.4em;
    font-size:.9em;
}
.wrapper div span {
    color:#444444;
}
.wrapper div h1 {

}
.wrapper div h2 {
    font-size:.26em;
    letter-spacing:.4em;
    font-weight:bold;
    color:#807B77;
    font-family:serif;
    margin-top:.2em;
}
.wrapper:before {
    content:".";
    font-size:0;
    color:transparent;
    display:block;
    width:100%;
    height:90%;
    position:absolute;
    left:0;
    top:0;
    background:rgba(0,0,0,.5);
    box-shadow:0 0 12px 15px rgba(0,0,0,.5);
    -webkit-transform-origin:100% 100%;
    -webkit-transform: translate(-4px,10px) scale(.5, .5) matrix(1, .021, 0, 1, 10, 0) skewX(-25deg);
    -ms-transform-origin:100% 100%;
    -ms-transform: translate(-4px,10px) scale(.5, .5) matrix(1, .021, 0, 1, 10, 0) skewX(-25deg);
    transform-origin:100% 100%;
    transform: translate(-4px,10px) scale(.5, .5) matrix(1, .021, 0, 1, 10, 0) skewX(-25deg);
    z-index:1;
}
.wrapper:after {
    content:".";
    font-size:0;
    color:transparent;
    display:block;
    width:100%;
    height:90%;
    position:absolute;
    left:0;
    top:0;
    background:rgba(0,0,0,.5);
    box-shadow:0 0 12px 15px rgba(0,0,0,.5);
    -webkit-transform-origin:100% 0;
    -webkit-transform: translate(-4px,-4px) scale(.5, .5) matrix(1, .021, 0, 1, 10, 0) skewX(25deg);
    -ms-transform-origin:100% 0;
    -ms-transform: translate(-4px,-4px) scale(.5, .5) matrix(1, .021, 0, 1, 10, 0) skewX(25deg);
    transform-origin:100% 0;
    transform: translate(-4px,-4px) scale(.5, .5) matrix(1, .021, 0, 1, 10, 0) skewX(25deg);
    z-index:1;
}

.body {
    border:8px solid rgba(0,0,0,0);
    box-shadow:0 0 5px rgba(0,0,0,.3);
    position:absolute;
    top:165px;
    margin-left:13%;
    width:80%;
    -moz-box-sizing:border-box;
    -webkit-box-sizing:border-box;
    -o-box-sizing:border-box;
    -ms-box-sizing:border-box;
    box-sizing:border-box;
}
.body div {
    height:200px;
    background:white;
}
</style> 
```

# php - 使用 d3.json() 从 php 获取 json 数据不起作用

> ID：10454612
> 
> 赞同：0
> 
> 时间：2012-05-04T18:57:29.277
> 
> 标签：php, javascript, mysql, json, d3.js

我正在使用 Javascript d3.js 库来绘制一些图表，这些图表使用 php 从 MySQL 数据库中获取数据。我已经使用 d3.json() 从一个“回显”一些 JSON 值的 php 文件中读取。这在我的 PC XAMPP 服务器中运行良好，但在 000webhost 免费服务器上无法运行。有人可以告诉我可能是什么问题吗？我正在使用以下方式获取 JSON 数据。

```
d3.json(d3/section1/section1.php, function(data) {... 
```

php 文件正在回显以下 json 数组：

```
[{"spark":[1,0.2,0.3,0.5,0.1,0.4,0.8,0.3,0.2,0.7,0.6,0.9],"mes":[88],"mark":[90],"info":"Network"},{"spark":[0.1,0.3,0.2,0.5,0.1,0.4,0.2,0.3,0.2,0.7,0.6,0.5],"mes":[87],"mark":[85],"info":"ERP"},{"spark":[1,0.2,0.3,0.5,0.1,0.4,0.8,0.3,0.2,0.7,0.6,0.9],"mes":[90],"mark":[100],"info":"Data Warehouse"},{"spark":[1,0.2,0.3,0.5,0.1,0.4,0.8,0.3,0.2,0.7,0.6,0.9],"mes":[95],"mark":[90],"info":"Web Site"},{"spark":[1,0.2,0.3,0.5,0.1,0.4,0.8,0.3,0.2,0.7,0.6,0.9],"mes":[98],"mark":[88],"info":"Email"},{"spark":[1,0.2,0.3,0.5,0.1,0.4,0.8,0.3,0.2,0.7,0.6,0.9],"mes":[90],"mark":[96],"info":"HR"},{"spark":[1,0.2,0.3,0.5,0.1,0.4,0.8,0.3,0.2,0.7,0.6,0.9],"mes":[100],"mark":[92],"info":"Problem Tracking"}] 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-04T19:00:48.277

URL不需要是字符串吗？

```
d3.json("d3/section1/section1.php", function(data) {... 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-05T17:57:51.863

问题已经解决了。在线服务器是一个免费服务器，它在每个页面的末尾嵌入了一个由 html 标记包围的 javascript。那是在调用预期的正确 JSON 字符串时产生问题。

# c++ - 链表和结构数组之间的区别？

> ID：10454617
> 
> 赞同：0
> 
> 时间：2012-05-04T18:57:44.747
> 
> 标签：c++, data-structures

这些代码之间有什么区别？

1)

```
struct MyStruct
{
    int num;
} ms[2];

ms[0].num = 5;
ms[1].num = 15; 
```

2)

```
struct MyStruct
{
    int num;
    MyStruct *next;
};

MyStruct *ms = new MyStruct;
ms->num = 5;
ms->next = new MyStruct;
ms->next->num = 15; 
```

一般来说，我可能对链表和列表有点困惑，它们对某些东西特别有用吗？请向我解释更多。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-04T19:04:10.833

你的第一个定义...

```
struct MyStruct
{
    int num;
} ms[1]; 
```

...使用单个元素创建一个静态分配的数组。程序运行时不能更改数组的大小；这个数组永远不会包含一个以上的元素。您可以通过直接索引访问数组中的项目；例如，假设您已经定义了一个适当大小的数组，您`ms[5]`将获得数组中的第六个元素（请记住，C 和 C++ 数组是 0 索引的，所以第一个元素是）。`ms[0]`

你的第二个定义...

```
struct MyStruct
{
    int num;
    MyStruct *next;
}; 
```

...创建一个动态分配的链表。此列表的内存在运行时动态分配，并且链表可以在程序的生命周期内增长（或缩小）。与数组不同，您不能直接访问列表中的任何元素；要到达第六个元素，您必须从第一个元素开始，然后迭代 5 次。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-04T19:15:06.460

关于代码中的错误，第一个构造了静态数量的 MyStruct 元素并将它们存储在 ms 数组中，因此 ms 是 MyStruct 结构的数组，当然在这里你的意思是它只有 2 个元素，稍后您不能将任何其他元素添加到 ms 数组中，尽管您限制了 MyStruct 元素的数量，而在第二种情况下，当您有一个链表时，您可以链接任意数量的 MyStruct 元素，这将导致动态数字的 MyStruct 元素，第二种情况允许您在运行时添加任意数量的 MyStruct，第二种情况在内存中的概念上应该如下所示：

`[ MyStruct#1 ] ----> [ MyStruct#2 ] ----> [ NULL ]`

例如，NULL 虽然可能是 MyStruct#3，而第一个：

`[ MyStruct#1 ] ----> [ MyStruct#2 ]`

就是这样，不能添加 MyStruct#3。

现在让我们看一下您编写的代码：

```
struct MyStruct
{
    int num;
} ms[1]; 
```

`ms[1]`真的意味着为我创建一个包含一个 MyStruct 元素的 ms 数组。
接下来的代码假设您创建了两个：

```
ms[0].num = 5;
ms[1].num = 15 
```

因此它应该是：

```
struct MyStruct
{
    int num;
} ms[2]; 
```

它会正常工作！并记住我为它制作的简单插图：
`[ MyStruct#1 ] ----> [ MyStruct#2 ]`

第二种情况：

```
struct MyStruct
{
    int num;
    MyStruct *next;
};

MyStruct *ms = new MyStruct;
ms->num = 5;
ms->next = new MyStruct;
ms->next->num = 15; 
```

`new`如果您保存源代码，则此代码使用 C++ 运算符，因为`.cpp`您将能够编译为 C++ 应用程序而没有错误，而对于 C，语法应更改如下：

```
struct MyStruct
{
    int num;
    MyStruct *next;
};

MyStruct *ms = (MyStruct *) malloc(sizeof MyStruct);
ms->num = 5;
ms->next = (MyStruct *) malloc(sizeof MyStruct);
ms->next->num = 15; 
```

并且不要忘记包含`#include <stdlib.h>`该功能，您可以[在此处](http://www.cplusplus.com/reference/clibrary/cstdlib/malloc/)`malloc()`阅读有关此功能的更多信息。 作为第一种情况，回想一下我对链表的说明： 其中 NULL 实际上是 ms->next MyStruct 结构的下一个元素，为了更详细地解释它，请回想一下 ms->next 是 MyStruct 的指针，我们已经分配了它堆中的一个空间，所以现在它指向一个**与 MyStruct structure 大小相同**的内存块。最后，这里有一个关于何时使用链表以及何时使用数组的**[Stackoverflow问题，这样您就可以准确了解为什么世界各地的人们有时更喜欢链表而有时更喜欢数组。](https://stackoverflow.com/questions/393556/when-to-use-a-linked-list-over-an-array-array-list)**

`[ MyStruct#1 ] ----> [ MyStruct#2 ] ----> [ NULL ]`

 *** * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-04T19:22:11.477

哦，我的朋友，有几十种不同类型的数据结构几乎只包含一堆`num`值或其他什么。程序员不只是对所有事情都使用数组的原因是所需内存量的差异，以及执行对您的特定需求最重要的任何操作的便利性。

链接列表恰好在添加或删除单个项目方面非常快。权衡是在列表中间查找项目相对较慢，并且`next`指针需要额外的内存。适当大小的数组在内存中非常紧凑，您可以非常快速地访问中间的项目，但要在最后添加新项目，您必须事先知道最大元素数，这通常是不可能的或浪费内存，或重新分配一个更大的数组并复制所有内容，这很慢。

因此，那些不知道他们的列表需要多大，并且大多只需要处理列表开头或结尾的项目或总是循环整个列表的人，并且更关心执行速度而不是保存一个几个字节的内存，很可能会选择链表而不是数组。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-05-04T19:26:19.503

一般来说，列表和数组之间的主要区别：

*   列表中的排序是*明确*的；每个元素存储前一个/后一个元素的位置。数组中的排序是*隐式*的；假定每个元素都有一个前面/后面的元素。请注意，单个列表可能包含多个排序。例如，你可以有类似的东西

    ```
    struct dualList {
    T data1;
    K data2;
    struct dualList *nextT;
    struct dualList *nextK;
    };
    ```

    这允许您以两种不同的方式订购同一个列表，一种是 by `data1`，另一种是 by `data2`。
*   相邻的数组元素位于相邻的内存位置；相邻列表元素不必位于相邻位置。

*   数组提供对其元素的随机访问；列表仅提供顺序访问（即，您必须遍历列表才能找到元素）。

*   数组（通常）长度固定为¹ - 向数组添加元素或从数组中删除元素不会改变数组的大小。列表可以根据需要扩大或缩小。

列表非常适合维护动态变化的值序列，尤其是在值需要保持有序的情况下。它们对于存储需要快速和频繁检索的相对静态数据并不那么热门，因为您无法随机访问元素。

* * *

1.  您可以通过动态声明内存来解决此问题，然后根据需要使用它`realloc`来调整该内存块的大小，但需要小心完成，并且可能有点像 PITA。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-05-04T19:04:08.593

当元素排序很重要并且事先不知道元素的数量时，链表很有用。此外，访问链表中的元素需要 O(n) 时间。当您在列表中查找元素时，在最坏的情况下，您将不得不查看列表中的每个元素。

对于数组，必须事先知道数量。当你在 C 中定义一个数组时，你必须传递它的大小。另一方面，访问一个数组元素需要 O(1) 时间，因为一个元素可以通过索引来寻址。使用链表，这是不可能的。

但是，这与 C++ 无关，因为链表和数组的概念与 C++ 无关。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-05-04T19:10:59.703

数组是一个连续的预分配内存块，而链表是运行时分配的（`malloc`）内存块（不一定是连续的）通过指针（`*next`）相互链接的集合。`structs`如果您在编译时知道需要存储的最大元素数，则通常会使用数组。`structs`但是，如果您不知道需要存储的最大元素数，则链接列表很有用。同样对于链表，元素的数量可能会更改、添加和删除元素。**

# ios - 标签上的ios错误

> ID：10454619
> 
> 赞同：0
> 
> 时间：2012-05-04T18:57:54.233
> 
> 标签：ios

如何解决这个问题以停止警告信息？我试图在标签上加上错误。try catch 真的能防止应用程序崩溃吗？

```
@catch (NSException *ex) {
    errorLbl.text =ex;
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-04T19:04:51.663

您应该确保代码不会完全崩溃，而不是试图捕捉崩溃。但是，您始终可以`NSException`将`NSString`

```
@catch (NSException *ex) {
    errorLbl.text = [NSString stringWithFormat:@"%@",[ex reason]];
} 
```

## `NSException`

```
@interface NSException : NSObject <NSCopying, NSCoding> {
    @private
    NSString        *name;
    NSString        *reason;
    NSDictionary    *userInfo;
    id               reserved;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-04T19:03:12.247

这个问题很难理解，但如果你问，Catch 是否会捕获每个基于 NSException 的异常，那么答案是肯定的，只是有一个小问题。

您可以捕获它，但由于您没有对此做任何事情，因此代码将在捕获后继续。如果你的应用程序崩溃了，那么你会用错误填充一些标签，但这并不意味着应用程序处于稳定的位置，它可能只是继续崩溃。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-05T00:44:22.893

NSException`reason`包含您可以显示的“人类可读”原因，例如：

```
@catch (NSException *ex) {
    errorLbl.text = ex.reason;
} 
```

有关更多信息，请参阅[NSException 参考](https://developer.apple.com/library/ios/#documentation/Cocoa/Reference/Foundation/Classes/NSException_Class/Reference/Reference.html)。

值得注意的是，Objective-C 中的异常（与其他语言不同）旨在用于编程或意外的运行时错误，而不是正常的程序流程。 [文档](http://developer.apple.com/library/ios/#documentation/cocoa/conceptual/Exceptions/Exceptions.html#//apple_ref/doc/uid/10000012i)状态：

> 重要提示：您应该将异常用于编程或意外的运行时错误，例如越界集合访问、尝试改变不可变对象、发送无效消息以及失去与窗口服务器的连接。您通常在创建应用程序时而不是在运行时处理这些类型的异常错误。
> 
> ...
> 
> 代替异常，错误对象（NSError）和 Cocoa 错误传递机制是在 Cocoa 应用程序中传达预期错误的推荐方式。有关详细信息，请参阅错误处理编程指南。

请参阅[错误处理编程指南](http://developer.apple.com/library/ios/#documentation/cocoa/conceptual/ErrorHandlingCocoa/ErrorHandling/ErrorHandling.html#//apple_ref/doc/uid/TP40001806)。

# asp.net - ASP.NET 和 WCF 身份验证选项

> ID：10454621
> 
> 赞同：1
> 
> 时间：2012-05-04T18:58:00.117
> 
> 标签：asp.net, wcf, authentication, wif, sts-securitytokenservice

让 ASP.NET Web 应用程序与 WCF 服务通信的身份验证选项有哪些？

场景：

1.  用户在 ASP.NET 表单中输入他们的用户名和密码。
2.  ASP.NET 需要将此传递给 WCF 以对用户进行身份验证。
3.  如果通过身份验证，用户可以在网站上执行操作。每个操作都需要将数据发送到不同的 WCF 操作。WCF 需要知道每个呼叫中​​的用户是谁。

最简单的解决方案是将用户名/密码存储在 ASP.NET 会话状态中。但是，这是不安全的，因为密码存储在服务器的内存中。

我宁愿不使用证书对服务的 ASP.NET“客户端”进行身份验证，因为除了 ASP.NET 之外，此 WCF 可能会被另一个客户端使用。

到目前为止，我看到的最好的建议是使用 Windows Identity Foundation (WIF)。看来这需要一个 STS。根据[MSDN](http://msdn.microsoft.com/en-us/library/ee517265.aspx)，微软似乎不建议通过 Visual Studio 设置 STS。无法保证 STS 在部署环境中可用，因为某些环境可能使用 Active Directory，而其他环境可能具有自定义用户存储。是否可以设置自定义 STS 以针对自定义用户存储进行身份验证？我很难找到有关执行此操作的文档。

除了使用 WIF，还有其他选择吗？如果自定义 WCF 身份验证服务返回可用于针对主要 WCF 服务进行身份验证的令牌，那又如何呢？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-06T20:02:14.090

执行此操作的标准方法是将 WIF 与 Microsoft 的 STS viz 结合使用。Active Directory 联合服务 v2.0 (ADFS)。

有许多自定义 STS 可用，例如[Identity Server](http://identityserver.codeplex.com/)。这使用 SQL DB 作为属性存储。它是开源的，因此可以根据您的需要进行调整。

您可以创建自己的自定义属性存储：[AD FS 2.0 属性存储概述](http://msdn.microsoft.com/en-us/library/ee895358.aspx)。

TechNet WIF/WCF：[WIF 和 WCF](http://social.technet.microsoft.com/wiki/contents/articles/4705.aspx)。

# internet-explorer - 嵌入式 FLV 在 Fire Fox 和 Safari 中播放，但不在 IE 中

> ID：10454623
> 
> 赞同：0
> 
> 时间：2012-05-04T18:58:15.870
> 
> 标签：internet-explorer, flv

我使用 DW 生成的代码嵌入了一个 FLV 文件，它在 IE 中不起作用，但在 Firefox 和 Safari 中可以播放。它甚至可以在我桌面上的 IE 中播放，只是不直播。实际站点[http://business.queensu.ca/centres/qcbv/bsme/feature_ihg.php](http://business.queensu.ca/centres/qcbv/bsme/feature_ihg.php)

这是我的代码：

```
 <object classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000" width="720" height="400" id="FLVPlayer">
      <param name="movie" value="FLVPlayer_Progressive.swf" />
      <param name="quality" value="high" />
      <param name="wmode" value="opaque" />
      <param name="scale" value="noscale" />
      <param name="salign" value="lt" />
      <param name="FlashVars" value="&amp;MM_ComponentVersion=1&amp;skinName=Clear_Skin_1&amp;streamName=files/IHG_V4&amp;autoPlay=true&amp;autoRewind=false" />
      <param name="swfversion" value="8,0,0,0" />
      <!-- This param tag prompts users with Flash Player 6.0 r65 and higher to download the latest version of Flash Player. Delete it if you don’t want users to see the prompt. -->
      <param name="expressinstall" value="Scripts/expressInstall.swf" />
      <!-- Next object tag is for non-IE browsers. So hide it from IE using IECC. -->
      <!--[if !IE]>-->
      <object type="application/x-shockwave-flash" data="FLVPlayer_Progressive.swf" width="720" height="400">
        <!--<![endif]-->
        <param name="quality" value="high" />
        <param name="wmode" value="opaque" />
        <param name="scale" value="noscale" />
        <param name="salign" value="lt" />
        <param name="FlashVars" value="&amp;MM_ComponentVersion=1&amp;skinName=Clear_Skin_1&amp;streamName=files/IHG_V4&amp;autoPlay=true&amp;autoRewind=false" />
        <param name="swfversion" value="8,0,0,0" />
        <param name="expressinstall" value="Scripts/expressInstall.swf" />
        <!-- The browser displays the following alternative content for users with Flash Player 6.0 and older. -->
        <div>

        </div>
        <!--[if !IE]>-->
      </object>
      <!--<![endif]-->
    </object> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-07T17:52:01.173

您可以尝试在代码中添加[IE 兼容模式元标记](http://evolpin.wordpress.com/2011/02/25/ie9-compatibility-and-the-meta-tag/)。这将告诉 IE 它应该使用 IE8 模式还是 IE9 模式。这可能会解决您的问题。

使用代码：

```
 <meta http-equiv="X-UA-Compatible" content="IE=EmulateIE8" > 
```

# javascript - Web 浏览器何时请求动态创建的 iframe 的 src 内容？

> ID：10454624
> 
> 赞同：7
> 
> 时间：2012-05-04T18:58:17.477
> 
> 标签：javascript, html, dom, iframe

假设我使用 js 动态创建一个 iframe 节点，然后设置 src 属性 (1)，最后将该节点附加到 DOM (2)。

浏览器何时请求 src 内容？在（1）之后？在（2）之后？或者它是不可预测的？它取决于浏览器吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-04T19:20:06.493

### [该规范](http://www.w3.org/TR/html5/the-iframe-element.html#the-iframe-element)指出：

> 当一个[`iframe`](http://www.w3.org/TR/html5/the-iframe-element.html#the-iframe-element)元素第一次[插入到文档](http://www.w3.org/TR/html5/infrastructure.html#insert-an-element-into-a-document)中时，用户代理必须创建一个[嵌套的浏览上下文](http://www.w3.org/TR/html5/browsers.html#nested-browsing-context)，然后 第一次[处理`iframe`属性](http://www.w3.org/TR/html5/the-iframe-element.html#process-the-iframe-attributes)。

* * *

使用以下代码段和本地服务器，我已经在许多浏览器中测试了该行为。

```
var f = document.createElement('iframe');
f.src = '/?'; 
```

资源永远不会被获取（我只展示了最低和最高测试的浏览器版本）：

*   即 6 - 9
*   法拉盛 3.6 - 12.0
*   铬 1 - 18
*   歌剧 10.00 - 12.00
*   Safari 4.0 - 5.1.5

因此，仅在将框架附加到文档后才发送请求。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-04T19:16:43.120

(2) 之后。在此之前，它只是 JS。在它附加到 DOM 之前，浏览器不会对其进行操作。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-04T19:17:42.217

好吧，我不会为您测试每个浏览器，但我总是希望具有 src 和 href 属性的元素链接到或加载某种内容，在它们实际附加后总是加载，因为何时/何地 iframe 或js 文件落在文档中，涉及大量安全性和一般实现问题。对于浏览器供应商而言，以任何其他方式做到这一点将是严重的失败，我可以看到一个事实，即 chrome 通过一些实验就可以做到这一点。

我能想到的唯一例外是可以在插入之前加载的图像。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-04T19:18:49.303

以我的经验，它总是在将节点添加到 DOM 时。您可以加载 Firebug 或其他一些开发控制台，并查看何时发生这种情况。抛出几个警报来确定这样的时间：

```
<script type="text/javascript">
    ifrm = document.createElement("IFRAME"); 
    ifrm.setAttribute("src", "http://blah.com/");
    alert('SRC SET'); 
    ifrm.style.width = 640+"px"; 
    ifrm.style.height = 480+"px"; 
    document.body.appendChild(ifrm);
    alert('ADDED TO DOM');
</script> 
```

运行类似的东西并观察 Firebug 中的“Net”选项卡以查看何时请求该页面。我相信只有在调用 appendChild 之后才会请求它。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-05-04T19:19:54.837

（2）之后！！看看这个：http: [//jsfiddle.net/lbstr/td7DD/](http://jsfiddle.net/lbstr/td7DD/)

打开 firebug 或 chrome 的控制台并查看 net 选项卡。你会看到谷歌加载。然后，注释掉第三行并再次运行。你不会看到谷歌加载。

# mysql - MySQL平均温度

> ID：10454625
> 
> 赞同：0
> 
> 时间：2012-05-04T18:58:17.537
> 
> 标签：mysql, average

我有一个温度表，其中包含一个 DATETIME 字段和一个浮点类型的温度字段。每 30 分钟测量一次温度，因此每天测量 48 次。我要做的是选择一个日期范围（例如2012-01-01到2012-05-01），计算每天的平均温度并返回该范围内每天的平均温度。解决方案？

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-04T19:00:57.870

用于`DATE()`剥离 datetime 字段的时间部分，并在`GROUP BY`子句中用于温度列的聚合`AVG()`。您的`WHERE`子句将过滤您要查找的日期范围。

```
SELECT
  DATE(temp_date) AS theday,
  AVG(temperature) AS avgtmp
FROM
  temp_readings
WHERE DATE(temp_date) BETWEEN '2012-01-01' AND '2012-05-01'
GROUP BY theday 
```

**注意：**根据您的描述，听起来每天都有读数，但如果任何一天都没有出现在您的读数表中，那么它将不会出现在您的结果集中。

# xcode - xcodebuild - '代码签名错误：无法找到配置文件 X'

> ID：10454628
> 
> 赞同：16
> 
> 时间：2012-05-04T18:58:25.433
> 
> 标签：xcode, xcodebuild, ios-provisioning, provisioning-profile

又一个代码符号错误。

我正在运行命令：

```
xcodebuild -project $DIR/myproject.xcodeproj -sdk iphoneos5.0 -alltargets 
```

和我的 project.pbxproj

```
"CODE_SIGN_IDENTITY[sdk=iphoneos*]" = "iPhone Distribution: Ryan"
"PROVISIONING_PROFILE[sdk=iphoneos*]" = "/Users/ryan/12345678-9012-3456-7890-123456789012.mobileprovision"; 
```

带输出

```
=== BUILD NATIVE TARGET myproject OF PROJECT myproject WITH THE DEFAULT CONFIGURATION (Release) ===
Check dependencies
[BEROR]Code Sign error: Provisioning profile '/Users/ryan/12345678-9012-3456-7890-123456789012.mobileprovision' can't be found 
```

我找不到有关如何执行此操作的任何指导。我尝试将配置放入 ~/Library/MobileDevice/Provisioning Profiles 并将 project.pbxproj 中的配置文件字段设置为配置文件 ID

我需要在没有 Jenkins/Hudson 的命令行中配置它

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2012-05-17T09:40:30.030

配置文件转到 ~/Library/MobileDevice/Provisioning Profiles，您可以像这样选择配置文件：

```
xcodebuild PROVISIONING_PROFILE=12345678-9012-3456-7890-123456789012 
```

# objective-c - 删除时Objective-c数组不释放对象

> ID：10454631
> 
> 赞同：1
> 
> 时间：2012-05-04T18:58:32.980
> 
> 标签：objective-c

```
// AClass.m
// init
enemyBullets = [[NSMutableArray alloc] initWithCapacity:0];
enemy1 = [[Enemy alloc] initWithBullets:enemyBullets];

// At some point
NSMutableArray *bulletsToDelete = [NSMutableArray array];
for(BulletEnemy *thisBullet in enemyBullets)
{
    // If I have to delete
    [bulletsToDelete addObject: thisBullet];
}
[enemyBullets removeObjectsInArray:bulletsToDelete];

//dealloc method
[enemyBullets release];
[enemy1 release]; 
```

现在在敌人内部某个时间点我执行以下操作：

```
// Enemy.m
- (id)initWithBullets:(NSMutableArray*) _bullets{
     // Enemybullets is a var of Enemy
     enemyBullets = _bullets;
}

// At some point...
myBullet = [[BulletEnemy alloc] init];
[enemyBullets addObject:myBullet];
[myBullet release]; 
```

问题是当我在 Aclass 执行以下操作时：

```
[enemyBullets removeObjectsInArray:bulletsToDelete]; 
```

BulletEnemy 中的 dealloc 方法没有被调用，因为保留计数不为 0。为什么？但是如果我释放 ACLass（它会释放enemyBullets），那么我的子弹就会被释放。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-04T19:14:17.160

让敌人拥有敌人的子弹。并使用 reverseObjectEnumerator

```
// AClass.m
// init
enemy1 = [[Enemy alloc] init];

// At some point
for(BulletEnemy *thisBullet in enemy1.enemyBullets.reverseObjectEnumerator)
{
    // If I have to delete
    [enemy1.enemyBullets removeObject:thisBullet];
}

//dealloc method
[enemy1 release];

//Enemy.h
@property (retain) NSMutableArray* enemyBullets;

// Enemy.m
@synthesize enemyBullets = _enemyBullets;

- (id)init{
     // Enemybullets is a var of Enemy
     _enemyBullets = [[NSMutableArray alloc] init];
}

// At some point...
myBullet = [[BulletEnemy alloc] init];
[enemyBullets addObject:myBullet];
[myBullet release];

-(void) dealloc{
    [_enemyBullets release];
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-29T14:22:24.003

显然，我用保留属性分配了一些东西，这使得对象 +1 因此不会释放。只需更改要分配的属性，它就可以工作。

# google-chrome - Chrome (Webkit) 存储 API - 无法写入串行端口

> ID：10454637
> 
> 赞同：1
> 
> 时间：2012-05-04T18:59:36.267
> 
> 标签：google-chrome, webkit, serial-port, storage

我在 chrome 源代码中使用 Storage API 来写入 Windows 上的串行端口。我修改了 Storage.cpp 中的代码。确切的程序在 WebKit 源代码中运行良好。但是，我无法在 chrome 源代码中创建文件（Storage.cpp 在 WebKit 和 chrome 中是相同的）。这是我的代码片段。

`HANDLE m_hSerialComm = CreateFile(TEXT("COM5"), GENERIC_READ|GENERIC_WRITE, 0, NULL, OPEN_EXISTING, 0,NULL)`;

句柄`m_hserialComm`指向垃圾内存位置。Chrome 是否有自己的 HANDLE 实现？chrome在让程序写入串口方面有什么限制吗？

# php - 从其他控制器访问控制器

> ID：10454642
> 
> 赞同：1
> 
> 时间：2012-05-04T18:59:42.463
> 
> 标签：php, cakephp

我昨天从 cakephp 开始，遇到了一个问题：

我有一个“ImagesController”和一个“UsersController”。

ImageView 显示图像列表。用户使用用户 ID 保存在图像表中。

我现在需要将用户标识转换为用户表中的名称。我与助手一起尝试过，但由于无法访问而无法正常工作`$this->User->find($id)`。

我已经在谷歌上搜索过，但似乎我命名错误，所以它没有得到结果。

谢谢你的帮助！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-04T19:33:17.790

您正在寻找的是将您的 Image 模型与您的 User 模型相关联。[书中的文章](http://book.cakephp.org/2.0/en/models/associations-linking-models-together.html)真的很值得一看！

一旦它们关联起来，您可以直接获取名称而无需调用任何函数。从我的脑海中，您需要将其添加到您的图像模型中：

```
public $belongsTo = array('User'); 
```

然后从您的角度来看，用户名应该在以下位置可用：

```
$data_var['Image']['User']['name']; 
```

`$data_var`保存图像数据的 View 变量在哪里。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-04T19:11:13.713

看起来您有两个模型，`Image`并且`User`. 如果您希望能够调用`$this->User->find($id)`，可以将模型添加到`$uses`控制器顶部的变量中。

```
var $uses = array('Image','User'); 
```

例如。

# java - 调整大小时由 LayoutManager 通知的 JPanel

> ID：10454643
> 
> 赞同：2
> 
> 时间：2012-05-04T18:59:44.890
> 
> 标签：java, swing, layout, jpanel

我有一个`MyPanel`扩展类`JPanel`。
`MyPanel`是一个子面板：他的大小是由`LayoutManager`他的父母计算的。
**问题是，`MyPanel`一旦`LayoutManager`他的父母计算出他的大小，我就需要得到通知。**
需要通知它，因为我需要根据面板的大小初始化一些变量。

如果我调用`getSize()`MyPanel 构造函数，我会得到 (0,0)，因为面板还没有“准备好”。
我应该什么时候打电话`getSize()`？

我想要这样的东西：

```
/** Lays out the panel and sets his size according to his layout */
@Override
public void onReady() {
    System.out.println(getSize()); //output is (0,0);
    super.onReady();
    System.out.println(getSize()); //output is (600,500);
    //here i can initialize my variables
} 
```

有没有类似的东西？也许`doLayout()`？

我能找到的唯一方法是调用`getSize()`该`paintComponent()`方法......它肯定有效，因为面板在`paintComponent()`被调用时肯定会显示，但我不能这样做，因为我需要在知道面板大小后立即初始化一些变量.. .但只有一次！`paintComponent()`会被多次调用...

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-04T19:03:12.373

最好的方法是使用 ComponentListener。

参见 ComponentListener.componentResized(ComponentEvent)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-05-04T19:03:20.080

是[`ComponentListener.componentResized()`](http://docs.oracle.com/javase/7/docs/api/java/awt/event/ComponentListener.html#componentResized%28java.awt.event.ComponentEvent%29)。

# c++ - 从另一个成员函数/构造函数调用 C++ 构造函数是否会执行初始化列表？

> ID：10454644
> 
> 赞同：3
> 
> 时间：2012-05-04T18:59:55.393
> 
> 标签：c++, list, constructor, initializer

在 C++ 对象中，当您从另一个构造函数或成员函数调用构造函数时（在已构造对象之后），您正在调用的构造函数的初始化列表是否仍会执行？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-04T19:37:56.127

在 C++11 中，您可以让构造函数将工作委托给同一类中的另一个构造函数，例如¹：

```
#include <iostream>
struct SomeType  {
    int number;

    SomeType(int new_number) : number(new_number) {}
    SomeType() : SomeType(42) {}
};

int main() {
  SomeType a;
  std::cout << a.number << std::endl;
} 
```

在这种情况下，禁止在此委托之后有一个初始化列表，例如将前面的示例更改为：

```
SomeType() : SomeType(42), number(0) {} 
```

是一个错误。

* * *

如果问题是“给定继承关系，初始化列表是否仍然被调用？” 答案是肯定的，例如

```
#include <iostream>
struct SomeBase {
  SomeBase(int) {}
};

struct SomeType : SomeBase {
    int number;

    SomeType(int new_number=0) : SomeBase(new_number), number(new_number) {}
};

int main() {
  SomeType a;
  std::cout << a.number << std::endl;
} 
```

这很好，并且完全按照您的希望工作。

* * *

在另一个构造函数中直接调用构造函数是不合法的，在 C++11 之前的 C++ 中，也不允许构造函数委托，所以类似于：

```
#include <iostream>

struct SomeType {
    int number;

    SomeType(int new_number) : number(new_number) {}
    SomeType() {
      SomeType::SomeType(0); // Error!
    }
};

int main() {
  SomeType a;
  std::cout << a.number << std::endl;
} 
```

是一个错误，不能直接表达。

以下（我猜这是您在编写问题时想到的）示例不是错误，但不会做您可能希望的事情：

```
#include <iostream>

struct SomeType {
    int number;

    SomeType(int new_number) : number(new_number) {}
    SomeType() {
      SomeType(0); 
      number = 42;
    }
};

int main() {
  SomeType a;
  std::cout << a.number << std::endl;
} 
```

这里不带参数的构造函数构造了 SomeType 的匿名临时实例。它与最初调用构造函数的实例完全不同。这是完全合法的，但可能不是你想要做的。如果你这样做，如果你不小心，你可能会产生无限递归的风险，我认为如果你最终做了这样的事情，这可能是设计问题的一个很好的指标！

¹源自维基百科[C++11 文章](http://en.wikipedia.org/wiki/C++11)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-04T19:26:49.373

我假设您指的是从派生类的初始化列表中调用基类构造函数。假设是这种情况，那么首先执行 BASE 类构造函数（包括其初始化列表），然后调用派生类的初始化列表。

如果您想知道 - 基类构造函数总是在为派生类执行初始化程序列表之前调用，即使对基类构造函数的调用显式出现在派生类初始化程序列表的中间或末尾（如就像它出现在开头一样）。原因是初始化列表中的项目是按照它们出现在类头文件中的类 DECLARATION 中的顺序执行的，而不是按照它们出现在构造函数定义的初始化列表中的顺序。而且，**基**类构造函数永远不会在**派生中声明**类声明。C++ 要求基类构造函数始终在派生类构造函数之前调用——无论对基类构造函数的调用是否显式出现在派生类的初始化列表中——也不管它出现在初始化列表中的什么位置。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-04T19:00:56.770

不要从另一个方法或另一个构造函数显式调用构造函数。

如果您确实需要，请使用两阶段初始化，其中您`Init()`在构造对象后调用类型方法。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-04T19:03:16.303

您不能显式调用构造函数，只能通过 new 或堆栈上的对象构造来调用。有办法破解它（例如放置新），但不要这样做，只需使用两阶段构造和初始化。

# paypal - 使用 Paypal 设置 Zencart

> ID：10454646
> 
> 赞同：0
> 
> 时间：2012-05-04T19:00:12.370
> 
> 标签：paypal, zen-cart

1.  首先：我正在尝试使用 Paypal 设置 Zencart。我已遵循 Paypal 和 Zencart 的所有说明：

将 Paypal 的 API 用户名、密码和签名代码放入 Zencart 的支付模块部分。检查“现场”环境。

然后我尝试在网站上购买产品并收到以下错误消息：

Zen Cart 消息：对于给您带来的不便，我们深表歉意。尚未设置 PayPal 帐户身份验证设置，或 API 安全信息不正确。

10002 安全错误 安全标头无效

我已经尝试查找答案，但我看到的所有内容都表明要确保环境不在沙箱中并且所有内容都输入正确。我已经检查了三倍，并且 API 输入正确并且设置为实时......我还能做什么？

1.  继续前进，我尝试设置沙箱，但不熟悉如何使用 Paypal 的沙箱。因此，我使用适当的沙盒 API 将 Zencart 重新配置为“沙盒模式”，并为商家和私人买家设置了沙盒帐户，但我不知道如何使用它们。我应该回到 Zencart 商店并使用我的新“Paypal 沙盒私人买家电子邮件”注册吗？并且将使用他们给我的工作作为测试的这封电子邮件结帐...如果我要被收费的话，我不想通过结帐...

感谢您的任何帮助：）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-07T02:43:43.320

获得 Zen Cart 问题支持的最佳地点是直接在 Zen Cart 支持论坛上，网址为[http://www.zen-cart.com/forum.php](http://www.zen-cart.com/forum.php)

此外，现有文章已经解释了您描述的问题的基础知识：[http ://www.zen-cart.com/content.php?277-the-paypal-account-in-this-store-is-presently-misconfigured -to-use-mixed-sandbox-and-live-settings-we-are-unable-to-complete-your-transaction-please-notify-the-store-owner-so-they-can-correct-this-problem -10002](http://www.zen-cart.com/content.php?277-the-paypal-account-in-this-store-is-presently-misconfigured-to-use-mixed-sandbox-and-live-settings-we-are-unable-to-complete-your-transaction-please-notify-the-store-owner-so-they-can-correct-this-problem-10002)

将您的 API 设置的三个部分（用户名、密码、签名）从 PayPal 网站准确复制到您商店的管理设置屏幕中，这一点绝对至关重要。

除非您是为支付处理编写新功能的程序员，否则无需使用沙箱。所以一定要检查“实时”单选按钮。（我意识到你已经提到过。为了清楚起见，只是添加了这个。）

您还可以通过在模块设置中打开调试日志来获取有关从 PayPal 返回的确切信息的更多详细信息。

PayPal 技术支持可在 www.paypal.com/mts 获得 - 他们可以查看您的实际传输和您的帐户，并在 API 签名详细信息有问题时解决问题。

# c++ - C ++：使用函数指针时未解析的重载函数

> ID：10454659
> 
> 赞同：1
> 
> 时间：2012-05-04T19:01:14.937
> 
> 标签：c++, function-pointers

```
#include <iostream>
using namespace std;

class B
{
public:
  int getMsg(int i)
  {
    return i + 1;
  }
};

class A
{
  B b;
public:
  void run()
  {
    taunt(b.getMsg);
  }

  void taunt(int (*msg)(int))
  {
    cout << (*msg)(1) << endl;
  }
};

int main()
{
  A a;
  a.run();
} 
```

上面的代码在 A 类中有一个 B 类，A 类有一个方法 taunt，它接受一个函数作为参数。B 类的 getMsg 被传递到 taunt...上面的代码生成了以下错误消息：“错误：没有匹配函数调用 'A::taunt()'”

是什么导致上述代码中的错误消息？我错过了什么吗？

更新：

```
#include <iostream>
using namespace std;

class B
{
public:
  int getMsg(int i)
  {
    return i + 1;
  }
};

class A
{
  B b;
public:
  void run()
  {
    taunt(b.getMsg);
  }

  void taunt(int (B::*msg)(int))
  {
    cout << (*msg)(1) << endl;
  }
};

int main()
{
  A a;
  a.run();
} 
```

t.cpp：在成员函数“void A::run()”中：第 19 行：错误：没有匹配函数调用“A::taunt()”编译由于 -Wfatal 错误而终止。

将 (*msg)(int) 更改为 (B::*msg)(int) 后，我仍然遇到相同的错误

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-04T19:15:04.120

`b.getMsg`不是形成指向成员的指针的正确方法，您需要`&B::getMsg`.

`(*msg)(1)`不是通过指向成员的指针调用函数的正确方法，您需要指定一个对象来调用该函数，例如（使用临时）`(B().*msg)(1)`。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-04T19:18:43.117

在 OOP 中做这些事情的正确方法是使用接口，所以您需要做的就是定义一个接口并在 B 类中实现它，然后将实现此接口的实例的指针传递给 A 类中的方法。

```
class IB{
public:
 virtual void doSomething()=0;
};

class B: public IB{
public:
 virtual void doSomething(){...}
};

class A{
public:
 void doSomethingWithB(IB* b){b->doSomething();}
}; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-04T20:13:14.280

这适用于 VS 2010。所有行的输出都相同：

```
#include <iostream>
#include <memory>
#include <functional>

using namespace std;
using namespace std::placeholders;

class A
{
public:
    int foo(int a, float b)
    {
        return int(a*b);
    }
};

int main(int argc, char* argv[])
{
    A temp;

    int x = 5;
    float y = 3.5;

    auto a = std::mem_fn(&A::foo);
    cout << a(&temp, x, y) << endl;

    auto b = std::bind(a, &temp, x, y);
    cout << b() << endl;

    auto c = std::bind(std::mem_fn(&A::foo), &temp, _1, y);
    cout << c(5) << endl;
} 
```

基本上，您使用`std::mem_fn`获取成员函数的可调用对象，然后`std::bind`如果要绑定其他参数，包括对象指针本身。`std::ref`如果您愿意的话，我很确定也有一种方法可以用来封装对对象的引用。我还包括了`_1`转发标记，只是为了在绑定中指定一些参数，而不是其他参数。如果您希望对所有内容都使用相同的参数但让它在不同的对象上工作，您甚至可以指定除类实例之外的所有内容。由你决定。

如果您更愿意使用`boost::bind`它来识别成员函数，并且您可以将它们全部放在一行上以缩短一点：`auto e = boost::bind(&A::foo, &temp, x, y)`但显然完全使用 std C++11 调用也没什么用。

# postgresql - 从 rails/postgresql 中的开发数据库重新创建测试数据库？

> ID：10454660
> 
> 赞同：0
> 
> 时间：2012-05-04T19:01:31.087
> 
> 标签：postgresql, ruby-on-rails-3.2, postgresql-9.1

strong text实际上我正在使用 pgAdmin 来管理 Rails 应用程序中的 PostgreSQL 开发数据库。

我在 USERS 表上定义了以下约束：

```
 CONSTRAINT users_pkey PRIMARY KEY (id ),
 CONSTRAINT users_name_key UNIQUE (name ),
 CONSTRAINT users_age_check CHECK (age > 16), 
```

但是当我做`rake:db:test:clone`测试数据库复制除上述约束之外的开发结构时。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-05T16:02:45.417

真的有必要用 Ruby 克隆你的数据库吗？使用带有模板的 create Db 从 Postgres 中创建克隆不是更容易吗？

# ios5 - 如何将 TableViewController 的 Cell（Disclosure Detail）中的数据（选择/单击的单元格值）传递到加载的下一个 ViewController？

> ID：10454665
> 
> 赞同：0
> 
> 时间：2012-05-04T19:01:50.153
> 
> 标签：ios5, uitableview

我有一个带有多个单元格（详细信息披露）的 TableViewController，每个单元格都与唯一数据（例如标题/详细信息）相关联。当我单击其中一个单元格时，另一个 ViewController 会被加载（通过模态或推送 segue），并且应该根据单击的单元格显示数据。

简单例如：

TableViewController 的每个 Cell 都与单独的 url 相关联。当我单击其中一个单元格（详细信息披露）时，下一个包含 WebView 的 ViewController 应该打开与单击的单元格的 url 对应的网页。

我们怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-04T20:13:14.557

首先，您需要设置每个 segue 的标识符（在情节提要中，只需单击 segue 并在 Attributes Inspector 中进行设置）。

然后，在您的 UITableViewController 子类中，您需要重写 prepareForSegue：

```
- (void)prepareForSegue:(UIStoryboardSegue *)segue sender:(id)sender {
    if ([segue.identifier isEqualToString:@"yourSegueIdentifier"] ) {
        UIViewController *viewController = segue.destinationViewController;
        viewController.yourVariable = yourData;
    }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-05T10:53:13.307

访问数据的一种方法是在 prepareForSegue 方法中使用以下内容：

```
NSIndexPath *indexPath = tableView.indexPathForSelectedRow; 
```

这将使您可以访问表格的选定行（单元格），以便您知道用户选择了哪个项目。

然后提取您需要的任何数据并使用 prepareForSegue 方法将其传递给目标视图控制器，如另一个答案所示。

# facebook - Facebook事件comment.create未触发

> ID：10454668
> 
> 赞同：1
> 
> 时间：2012-05-04T19:02:08.060
> 
> 标签：facebook, facebook-graph-api, facebook-like, facebook-opengraph

我正在使用 Facebook 的“赞”按钮并[订阅两个事件](http://developers.facebook.com/docs/reference/javascript/FB.Event.subscribe/)：

> **edge.create** - 当用户点击“Like”按钮时
> 
> **comment.create** - 当用户随后在出现的弹出窗口中键入评论时

edge.create 事件正在触发，但 comment.create 似乎没有发生。这是代码：

```
window.fbAsyncInit = function() {
    FB.init({
        appId      : '1111111111111', // App ID
        channelUrl : '//www.xxx.com/channel.php', // Channel File
        status     : true, // check login status
        cookie     : true, // enable cookies to allow the server to access the session
        xfbml      : true  // parse XFBML
    });

    FB.Event.subscribe('edge.create',
        function(response) {
            // user clicked facebook "like" button
            alert("like");
        }
    );

    FB.Event.subscribe('comment.create',
        function(response) {
            // user added comment to facebook like
            alert("comment");
        }
    );
}; 
```

我错过了什么吗？

谢谢。-E

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-04T19:14:53.297

我不认为该事件是为“赞”按钮的“添加评论”弹出窗口而触发的；它仅记录为与评论插件本身一起使用

# paypal - 在贝宝中禁用商品数量和购物车

> ID：10454678
> 
> 赞同：2
> 
> 时间：2012-05-04T19:02:47.720
> 
> 标签：paypal

我的网站将使用贝宝支付物品。

我只希望一次能够购买一件物品，并且该物品的数量只有一件。

我一直在寻找贝宝的选项，但还没有找到任何东西。

这可能吗？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-25T04:13:31.530

如果您一次只想出售一件商品，您可能不需要购物车功能——“立即购买”按钮更适合此目的，因为“一次一件商品”是默认行为。此外，如果您希望强制执行“每位客户一次购买”，那么正如 Gtoxic 所提到的 - 在提供的信息有限的情况下，cookie 可能是最好的选择。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-04T19:05:15.623

您可以使用 cookie、会话或数据库条目来跟踪谁购买了然后从那里工作的东西。

# c - C中的函数getopt

> ID：10454682
> 
> 赞同：0
> 
> 时间：2012-05-04T19:03:03.937
> 
> 标签：c, getopt

当我不写参数时，我遇到了问题，我希望这是必不可少的。

```
 while ((choice = getopt(argc, argv, "a:b:")) != -1) {
    switch (choice) {
    case 'a' :
      printf("a %s\n", optarg);
      break;
    case 'b' :
      printf("b %d\n", optarg);
      break;
    case '?' :
      if (optopt == 'a')
        fprintf (stderr, "Option -%c requires an argument.\n", optopt);
      break;
    }
  } 
```

当我写信时，`./a.out -b test`我没有看到`fprintf()`消息

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-04T19:11:40.297

假设你的意思是`printf()`写时`fprintf()`：

我可能是错的，但据我所知，你`optarg`也`char *`应该`%s`在第二个`printf()`.

如果你真的是这个意思，`fprintf()`请解释你为什么希望看到它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-04T19:25:35.497

因为你`fprintf`在这种情况下`if (optopt == 'a')`，当 optopt 是`'b'`

```
if (optopt == 'a')
    fprintf (stderr, "Option -%c requires an argument.\n", optopt);
break; 
```

尝试

```
if (optopt == 'a' || optopt == 'b' )
    fprintf (stderr, "Option -%c requires an argument.\n", optopt);
break; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-04T20:52:27.753

我认为您需要跟踪自己是否`-a`使用了选项-`getopt()`没有足够丰富的规范来捕获该信息。就像是：

```
int opt_a_found = 0;

while ((choice = getopt(argc, argv, "a:b:")) != -1) {
switch (choice) {
case 'a' :
  opt_a_found = 1;
  printf("a %s\n", optarg);
  break;
case 'b' :
  printf("b %d\n", optarg);
  break;
case '?' :
  if (optopt == 'a')
    fprintf (stderr, "Option -%c requires an argument.\n", optopt);
  break;
}
}

if (!opt_a_found) {
    fprintf (stderr, "Option -a is required.\n");
} 
```

# java - 如何使用 AJAX 数据验证创建 JSF 表单

> ID：10454692
> 
> 赞同：4
> 
> 时间：2012-05-04T19:03:21.517
> 
> 标签：java, jsf, jsf-2

我正在开发一个 JSF 表单原型，用于使用 AJAX 数据验证将数据插入数据库表这是 JSF 页面：

```
<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en"    
      xmlns:h="http://java.sun.com/jsf/html"
      xmlns:f="http://java.sun.com/jsf/core"
      xmlns:ui="http://java.sun.com/jsf/facelets">
    <h:head>
        <ui:insert name="header">           
            <ui:include src="header.xhtml"/>         
        </ui:insert>
    </h:head>
    <h:body>

        <h1><img src="resources/css/images/icon.png" alt="NVIDIA.com" /> History Center</h1>
        <!-- layer for black background of the buttons -->
        <div id="toolbar" style="margin: 0 auto; width:1180px; height:30px; position:relative;  background-color:black">
            <!-- Include page Navigation -->
            <ui:insert name="Navigation">           
                <ui:include src="Navigation.xhtml"/>         
            </ui:insert>

        </div>  

        <div id="logodiv" style="position:relative; top:35px; left:0px;"> 
            <h:graphicImage alt="Demo Insert Form"  style="position:relative; top:-20px; left:9px;"  value="resources/images/logo_databasez.png" />
        </div>
        <div id="main" style="margin: 0 auto; width:1190px; height:700px; position:absolute;  background-color:transparent; top:105px">

            <div id="mainpage" style="margin: 0 auto; width:1190px; height:500px; position:absolute;  background-color:transparent; top:80px">

                <div id="settingsHashMap" style="width:350px; height:400px; position:absolute;  background-color:r; top:20px; left:1px">
                    <h:form>
                        <div id="settingsdiv" style="width:750px; height:400px; position:absolute;  background-color:r; top:20px; left:1px">

                            <h:panelGrid columns="2">
                                <h:panelGroup>Session ID</h:panelGroup>
                                <h:panelGroup>
                                    <h:inputText id="sessionid" value="#{DatabaseController.formMap['sessionid']}" >
                                        <f:validateLength minimum="0" maximum="15"/>
                                        <f:ajax render="sessionidvalidate" event="blur"/>                                          
                                    </h:inputText>
                                    <h:outputText id="sessionidvalidate" rendered="#{DatabaseController.validateSessionid}" value="session is already registered" />
                                </h:panelGroup>

                                <h:panelGroup>User ID</h:panelGroup>
                                <h:panelGroup>
                                    <h:inputText id="userid" value="#{DatabaseController.formMap['userid']}" >
                                        <f:validateLength minimum="0" maximum="15"/>
                                    </h:inputText>
                                </h:panelGroup>

                                <h:panelGroup>Login Time</h:panelGroup>
                                <h:panelGroup>
                                    <h:inputText id="logintime" value="#{DatabaseController.formMap['logintime']}" >
                                        <f:validateLength minimum="0" maximum="35"/>
                                    </h:inputText>
                                </h:panelGroup>

                                <h:panelGroup>Last Refresh Time</h:panelGroup>
                                <h:panelGroup>
                                    <h:inputText id="lastrefreshtime" value="#{DatabaseController.formMap['lastrefreshtime']}" >
                                        <f:validateLength minimum="0" maximum="35"/>
                                    </h:inputText>
                                </h:panelGroup>

                                <h:panelGroup>User IP</h:panelGroup>
                                <h:panelGroup>
                                    <h:inputText id="userip" value="#{DatabaseController.formMap['userip']}" >
                                        <f:validateLength minimum="0" maximum="15"/>
                                    </h:inputText>
                                </h:panelGroup>

                            </h:panelGrid>          

                        </div>   

                        <div id="settingstwodiv" style="width:150px; height:60px; position:absolute;  background-color:transparent; top:380px; left:800px">

                            <h:commandButton value="Create User" action="#{DatabaseController.saveData}"/>

                        </div> 
                    </h:form> 

                </div>   

            </div>  
        </div>

    </h:body>
</html> 
```

这是托管 bean：

```
import java.io.Serializable;
import javax.enterprise.context.SessionScoped;
// or import javax.faces.bean.SessionScoped;
import javax.inject.Named;
/* include SQL Packages */
import java.sql.Connection;
import java.sql.PreparedStatement;
import java.sql.ResultSet;
import java.sql.SQLException;
import java.sql.Timestamp;
import java.text.ParseException;
import java.text.SimpleDateFormat;
import java.util.HashMap;
import javax.annotation.PostConstruct;
import javax.sql.DataSource;
import javax.annotation.Resource;
import javax.faces.context.FacesContext;
import javax.inject.Inject;
import javax.servlet.http.HttpServletRequest;
import javax.servlet.http.HttpSession;
// or import javax.faces.bean.ManagedBean;   

import org.glassfish.osgicdi.OSGiService;

// Demo Insert Form
@Named("DatabaseController")
@SessionScoped
public class Database implements Serializable {

    private HashMap<String, String> formMap = new HashMap<>();

    public Database() {
    }
    /* Call the Oracle JDBC Connection driver */
    @Resource(name = "jdbc/Oracle")
    private DataSource ds;

    public HashMap<String, String> getformMap() {
        return formMap;
    }

    /*

    CREATE TABLE ACTIVESESSIONS(
    SESSIONID VARCHAR2(30 ) NOT NULL,
    USERID VARCHAR2(30 ) NOT NULL,
    LOGINTIME TIMESTAMP(6),
    LASTREFRESHTIME TIMESTAMP(6),
    USERIP VARCHAR2(30 )
    )
    /
     */
    @PostConstruct
    public void hashMapGenerate() {
        /* Initialize the hashmap */
        formMap.put("sessionid", null);
        formMap.put("userid", null);
        formMap.put("logintime", null);
        formMap.put("lastrefreshtime", null);
        formMap.put("userip", null);
    }

    public int saveData() throws SQLException, java.text.ParseException {
//        formMap = new HashMap<String, String>();

        String SqlStatement = null;

        if (ds == null) {
            throw new SQLException();
        }

        Connection conn = ds.getConnection();
        if (conn == null) {
            throw new SQLException();
        }

        PreparedStatement ps = null;

        /*

        CREATE TABLE ACTIVESESSIONS(
        SESSIONID VARCHAR2(30 ) NOT NULL,
        USERID VARCHAR2(30 ) NOT NULL,
        LOGINTIME TIMESTAMP(6),
        LASTREFRESHTIME TIMESTAMP(6),
        USERIP VARCHAR2(30 )
        )
        /
         */

        try {
            conn.setAutoCommit(false);
            boolean committed = false;
            try {           /* insert into Oracle the default system(Linux) time */
                SqlStatement = "INSERT INTO ACTIVESESSIONS"
                        + " (SESSIONID, USERID, LOGINTIME, LASTREFRESHTIME, USERIP)"
                        + " VALUES (?, ?, ?, ?, ?)";

                ps = conn.prepareStatement(SqlStatement);

                ps.setString(1, formMap.get("sessionid"));
                ps.setString(2, formMap.get("userid"));
                ps.setTimestamp(3, toTimeStamp(formMap.get("logintime")));
                ps.setTimestamp(4, toTimeStamp(formMap.get("lastrefreshtime")));
                ps.setString(5, formMap.get("userip"));

                ps.executeUpdate();

                conn.commit();
                committed = true;
            }
            finally 
            {
                if (!committed) {
                    conn.rollback();
                }
            }
        } finally {
            /* Release the resources */
            ps.close();
            conn.close();
        }

        return 0;

    }
    private Timestamp toTimeStamp(String s) throws java.text.ParseException
    {
        Timestamp ts = null;
        java.util.Date date = null;
        if (s == null || s.trim().isEmpty()) return ts;

        SimpleDateFormat sdf = new SimpleDateFormat("yyyy-MM-dd hh:mm:ss.S");
        date = (java.util.Date) sdf.parse(s);
        ts = new Timestamp(date.getTime());

        return ts;

    }

    /* Validators section */
    public boolean getvalidateSessionid(){

        //do SQL query

        return true;
    }

} 
```

我在实施表单验证时遇到了困难。我想通过使用输入的字符串并将其检入数据库，这个值是否已经进入数据库表。这里我调用 Java 方法来检查值：

```
 <h:panelGroup>
                                <h:inputText id="sessionid" value="#{DatabaseController.formMap['sessionid']}" >
                                    <f:validateLength minimum="0" maximum="15"/>
                                    <f:ajax render="sessionidvalidate" event="blur"/>                                          
                                </h:inputText>
                                <h:outputText id="sessionidvalidate" rendered="#{DatabaseController.validateSessionid}" value="session is already registered" />
                            </h:panelGroup> 
```

如何将插入的值发送到 Java 方法？

最良好的祝愿

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-05-04T19:56:17.590

您需要创建一个`Validator`.

开球示例：

```
@FacesValidator("sessionIdValidator")
public class SessionIdValidator implements Validator {

    @Override
    public void validate(FacesContext context, UIComponent component, Object value) throws ValidatorException {
        // ...

        if (yourDataService.existSessionId(value)) {
            throw new ValidatorException(new FacesMessage(FacesMessage.SEVERITY_ERROR,
                "Session ID is already in use, please choose another.", null));
        }
    }

} 
```

按如下方式使用它：

```
<h:inputText id="sessionid" value="#{DatabaseController.formMap['sessionid']}">
    <f:validateLength minimum="0" maximum="15" />
    <f:validator validatorId="sessionIdValidator" />
    <f:ajax event="blur" render="sessionidMessage" />                                          
</h:inputText>
<h:message id="sessionidMessage" for="sessionid" /> 
```

请注意，您应该使用 a`<h:message>`来显示验证消息。你没有任何人在你的视野中。对所有其他字段应用相同的：

```
<h:inputText id="userid" value="#{DatabaseController.formMap['userid']}">
    <f:validateLength minimum="0" maximum="15" />
    <f:ajax event="blur" render="useridMessage" />                                          
</h:inputText>
<h:message id="useridMessage" for="userid" /> 
```

* * *

如果您想在验证器中使用`@Resource`or `@EJB`，则将注释`@Inject`替换为or （因为您似乎出于某种原因使用 CDI）：`@FacesValidator``@ManagedBean``@Named`

```
@Named
public class SessionIdValidator implements Validator {

    @Resource
    private DataSource dataSource;

    @Inject
    private YourDataService yourDataService;

    // ...
} 
```

并按如下方式使用它

```
 <f:validator binding="#{sessionIdValidator}" /> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-04T19:47:07.813

只需在您的标签中添加监听器`h:inputText`：

```
<h:inputText id="sessionid" value="#{DatabaseController.formMap['sessionid']}" 
         valueChangeListener="#{DatabaseController.validateSessionid}"> 
```

因此，您可以在服务器端检查输入的值。当用户跳出输入字段时，JSF 对服务器进行 ajax 调用，并通过生命周期的执行部分运行名称输入组件。这意味着 JSF 将`valueChangeListener`在生命周期的验证过程阶段调用在属性中指定的名称输入的值更改侦听器。

我建议实现这个方法：

```
public void validateSessionid(ValueChangeEvent e) {
    UIInput nameInput = e.getComponent()
    String sessionid = nameInput.getValue()

    //do SQL query
} 
```

在 ajax 调用返回后，JSF 呈现`h:outputText id="sessionidvalidate"`.

# php - 如何使用 preg_match_all 组合两个抓取的变量？

> ID：10454695
> 
> 赞同：0
> 
> 时间：2012-05-04T19:03:33.887
> 
> 标签：php

我使用 preg_match_all 从另一个页面抓取 url 和标题，抓取没问题，但我无法使用 foreach 将它们放入其中！还是有另一种方法代替foreach？

```
//gets URLs of href='xxxx'   
 preg_match_all('/a href="([^"]+)" class=l.+?>.+?<\/a>/',$sear,$results);

//gets titles of >xxxx</a>   
    preg_match_all('/a href=".+?" class=l.+?>([^"]+)<\/a>/',$sear,$t); 
```

下面的代码显示抓取的 URL

```
foreach ($results[1] as $url)
{
echo "<a href='$url'>$u</a> <br>";

$i++;
} 
```

下面的代码显示抓取的标题

```
 foreach ($t[1] as $title)
   { 
   echo $title; 
   $i++;
   } 
```

但我不知道如何在一个 foreach 中显示它们（网址和标题），所以我可以让它像

```
<a href='URL'>Title</a> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-04T19:06:17.700

结合这两个正则表达式以一次捕获两个项目：

```
preg_match_all('/<a href="([^"]+)" class=l.+?>([^<]+)<\/a>/',$sear, $results);
var_dump( $results); 
```

现在您在捕获组 1 和 2 中同时拥有 URL 和标题。

对此正则表达式的改进是使用积极的前瞻来匹配关闭`</a>`，但为简单起见，您当前的解决方案应该没问题。

**编辑：**我最初把它留给 OP 来弄清楚如何从结果中获取正确的输出。但是，这是一个工作示例。

```
for( $i = 0; $i < count( $results[1]); $i++)
    echo 'URL: ' . $results[1][$i] . ', Title: ' . $results[2][$i]; 
```

# visual-studio-2012 - How to ignore users in VS 11 Sql Server Database project publish

> ID：10454697
> 
> 赞同：2
> 
> 时间：2012-05-04T19:03:44.103
> 
> 标签：visual-studio-2012

**Problem** I can't figure out how to ignore users in my vs 11 beta sql server db project when publishing.

**Why is this a problem** This is a problem because I want to keep the setting where I want to drop objects that are not in my project but *are* in the db being published to. If I delete a sproc in my project I'd like to drop the sproc in my db.

Any ideas? I've looked at all of the publish settings and just can't seem to figure it out....

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-12T14:34:53.957

Encountered this as well, since it persists in Visual Studio 2012 RTM / SP1 with SSDT (SQL Server Data Tools). I reached out to Barclay Hill at Microsoft who works on the product, who confirmed that this is currently not possible:

> It is frequently asked for i.e drop everything, but users, permissions and roles. We have it on our backlog, but have not been able to get to it yet.

# ruby - 用于在独立线程中运行服务器然后在任务完成时终止线程的 Rake 任务？

> ID：10454699
> 
> 赞同：3
> 
> 时间：2012-05-04T19:03:53.153
> 
> 标签：ruby, multithreading, rakefile

如何`rake task`在任务完成后启动线程，然后终止线程。

本质上，我正在编写一个`rake task`测试 jekyll 站点。我希望能够启动服务器，执行一些其他任务，然后在任务完成后销毁线程。到目前为止，这是我所拥有的：

```
task :test_site do
  `ejekyll --server`
  `git -Xdn`
  if agree( "Clean all ignored files?")
    git -Xdf
  end
end 
```

但不幸的是，我知道停止的唯一方法`jekyll --server`是使用`ctrl c`. 我很高兴听到`jekyll --server`在庄园中停止不退出 rake 任务的方法，但请发表评论，因为问题是专门询问线程和 rake 任务。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-05T01:33:09.883

你想要[`Process.spawn`](http://www.ruby-doc.org/core-1.9.3/Process.html#method-c-spawn)，*而不是*线程。这是一个新进程，而不是现有进程中的执行线程。你得到了 PID，所以只需发送[`Process.kill(:QUIT, pid)`](http://www.ruby-doc.org/core-1.9.3/Process.html#method-c-kill)或任何你想用来杀死产生的处理的方法。

```
pid = Process.spawn(
  "ejekyll", "--server",
  out: "/dev/null",
  err: "/dev/null"
)

# you may need to add a short sleep() here

# other stuff

Process.kill(:QUIT, pid) && Process.wait 
```

如果`ejekyll`有在前台运行的命令行选项，最好使用它，否则如果它自我守护进程，您需要知道它存储其 PID 文件的位置，以便识别和终止守护进程。

# ruby-on-rails - 单个 Rails 代码库、两台服务器、两个路由范围

> ID：10454708
> 
> 赞同：0
> 
> 时间：2012-05-04T19:04:16.937
> 
> 标签：ruby-on-rails, ruby, routes

在具有命名空间 /admin 功能的 rails 应用程序中，请考虑以下路线：

```
 namespace :admin do
   root :to => 'home#index'
   [.. resources cut here..]
 end

 get 'etc/:etc' => 'etc#etc'
 [.. other top level routes cut..] 
```

如果我想将相同的 Rails 代码库部署到 2 个单独的服务器，frontend.com 仍然会看到顶级路由“etc/:etc”。

但是，如果我想将相同的代码库部署到仅限管理员的服务器上，这样请求将只是[http://backend.com](http://backend.com)并让命名空间 :admin 接管作为顶层，而无需键入或使用[http： //backend.com/admin](http://backend.com/admin)。

在尝试使用 .htaccess 重写时，我在管理命名空间代码中遇到了 URL 生成问题，并且资产不再正确加载。

这只是不值得追求的东西吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-04T19:20:03.507

当然，您可以在根语句周围设置条件。

```
namespace :admin do
  root :to => 'admin#index'
  ...
end
if SOMETHING
  root :to => "admin#index"
end 
```

（在此示例中，我使用了 AdminController 而不是 HomeController。）

用户可以键入[http://backend.com/](http://backend.com/)，但有时 /admin 可能会出现在浏览器的 URL 栏上。

SOMETHING 可以是对主机名或 ENV 的测试。您可以在虚拟主机配置中设置 ENV。

# ios - iOS底部对齐TableViewController（StoryBoard）中的TableView

> ID：10454710
> 
> 赞同：0
> 
> 时间：2012-05-04T19:04:24.493
> 
> 标签：ios, uitableview

`UITableView`使用底座时是否可以底部对齐`UITableViewController`？我想为带有部分卷曲过渡的模态执行此操作。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-04T19:10:56.737

如果您使用的是`UITableViewController`，它会自动使 tableview 全屏显示，并且无法更改。

但是，如果您不需要 a `UITableViewController`，您可以使用标准执行此操作`UIViewController`，只需设置`UITableView`( 在情节提要中或在适当的代码中) 的大小。

# c# - 如何在接口方法的实现中强制使用特定值？

> ID：10454730
> 
> 赞同：0
> 
> 时间：2012-05-04T19:06:32.477
> 
> 标签：c#, .net, interface

用一个例子可以更好地解释这一点。目前我有这样的事情：

```
public class Car {
    internal string SaleCode {get; set;} //Spring, Summer, ...
    public string Name {get; set; }  //Model name
}

public interface ICarFactory 
{
    Car GetSummerSaleCar();
    Car GetSpringSaleCar();
}

public class FordFactory : ICarFactory 
{
    public Car GetSummerSaleCar() {
        return new Car() {Name="Fiesta"};
    }
    public Car GetSpringSaleCar() {
        return new Car() {Name="Fusion"};
    }
}

public class CarProvider {
    public void ProduceCars(ICarFactory factory) {
        var inventory = new List<Car>();
        Car car = null;
        car = factory.GetSummerSaleCar();
        car.SaleCode = "SMR";
        inventory.Add(car);

        car = factory.GetSpringSaleCar();
        car.SaleCode = "SPG";
        inventory.Add(car);
    }
} 
```

对于每个方法，汽车的 SaleCode 应始终相同，因此 CarFactory 实现不应设置此值。现在我在 CarProvider 类中设置了它，但我想知道是否有办法将它从界面中取出。我唯一能想到的就是使用一个属性应用于接口内的方法定义，我可以在其中设置类型，但我觉得必须有另一种选择。

想法？

# 更新

如果您想知道，当我提到为接口中的每个方法添加属性时，这就是我所说的：

```
public class SaleAttribute : Attribute
{
    public string Code { get; set; }
}

public interface ICarFactory
{
    [Sale(Code = "SMR")]
    Car GetSummerSaleCar();
    [Sale(Code = "SPG")]
    Car GetSpringSaleCar();
}

public void ProduceCars(ICarFactory factory)
{
    var inventory = new List<Car>();
    foreach (var method in typeof(ICarFactory).GetMethods())
    {
        String carType = null;
        var attributes = method.GetCustomAttributes(typeof(SaleAttribute), false);
        if (attributes.Length == 1)
        {
            saleCode = ((SaleAttribute)attributes[0]).Name;
            Car car = (Car)method.Invoke(factory, null);
            car.SaleCode = saleCode;
            inventory.Add(car);
        }
    }
} 
```

这有一个额外的好处，即如果在接口中添加方法，则 CarProvider 不需要修改。缺点显然是与反射相关的开销（性能和维护）。

# 更新2

我将示例从使用汽车类型更改为销售代码，因为这更好地反映了我的情况。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-04T19:22:11.453

Mike 我认为最好的方法是拥有一个抽象类型 Car 和两个派生类：CompactCar 和 MediumCar。

```
public abstract class Car { 
    internal string Type {get; protected set;} //Compact, Medium, Large, ... 
    public string Name {get; set; }  //Model name 
} 

public class CompactCar : Car
{
     public CompactCar() { this.Type = "Compact"; }
}

public class MediumCar : Car
{
     public MediumCar() { this.Type = "Compact"; }
} 
```

因此，您可以返回特定类型，例如：

```
public interface ICarFactory      
{     
    CompactCar GetCompact();     
    MediumCar GetMedium();     
}  
public class FordFactory : ICarFactory    
{   
    public CompactCar GetCompact() {   
        return new CompactCar() {Name="Fiesta"};   
    }   
    public MediumCar GetMedium() {   
        return new MediumCar() {Name="Fusion"};   
    }   
} 
```

这对使用它的源代码影响最小，因为它仍然可以引用具有抽象类型 Car 的汽车。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-04T19:11:49.953

`CarType.Create(Medium)`代替呢`new Car`？

我建议一个工厂叫`CarType`

```
public class CarType{
   public class CarType(instName){
      this.instName = instName;
   }
   public Car Create(){
      return new Car(){Type=instName;}
      //or alternatively, if you have more implementations for the cars
      //return (Car)Activator.CreateInstance(this.instName);
   }
   public static CarType Compact = new CarType("Compact");
   public static CarType Medium = new CarType("Medium");
} 
```

用法是

```
Medium.Create(){Name="Fiesta";} 
```

但这仍然在 CarFactorys 方法中，所以对你没有多大帮助......

# c++ - xml C++中每行一条记录

> ID：10454731
> 
> 赞同：0
> 
> 时间：2012-05-04T19:06:34.507
> 
> 标签：c++, xml

我正在用 C++ 编写一个大的 xml 文件。我需要的是能够以块的形式构建记录的 dom 树并将块刷新到磁盘。例如，

```
-----------chunk create-----
<record>data<record>
<record>data<record>
<record>data<record>
<record>data<record>
-----------chunk flush-------- 
```

此外，单行应包含一条完整记录，如上所示。我不想要的是以如下所示的格式打印

```
<record>
 data
</record> 
```

哪个库将允许上述两种功能？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-04T19:18:16.670

也许你可以试试 TinyXML：http: [//sourceforge.net/projects/tinyxml/](http://sourceforge.net/projects/tinyxml/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-04T22:12:05.317

我使用[RapidXml](http://rapidxml.sourceforge.net/)。

# png - 从 png 文件中获取文本字段

> ID：10454733
> 
> 赞同：3
> 
> 时间：2012-05-04T19:06:43.223
> 
> 标签：png, libpng

到目前为止似乎没有任何效果。我必须通过[pnginfo](http://manpages.ubuntu.com/manpages/precise/man1/pnginfo.1.html)看到以下消息：

```
concept_Sjet_dream6.png...
  Image Width: 200 Image Length: 240
  Bitdepth (Bits/Sample): 8
  Channels (Samples/Pixel): 2
  Pixel depth (Pixel Depth): 16
  Colour Type (Photometric Interpretation): GRAYSCALE with alpha channel 
  Image filter: Single row per byte filter 
  Interlacing: No interlacing 
  Compression Scheme: Deflate method 8, 32k window
  Resolution: 11811, 11811 (pixels per meter)
  FillOrder: msb-to-lsb
  Byte Order: Network (Big Endian)
  Number of text strings: 1 of 9
    Comment (xTXt deflate compressed): The comment 
```

但是剩下的文本字符串丢失了。我也尝试过[stackoverflow](https://stackoverflow.com/questions/2190236/how-can-i-read-png-metadata-from-php)中的其他解决方案，它们也没有工作。pngchunks 提供以下信息：

```
Chunk: Data Length 13 (max 2147483647), Type 1380206665 [IHDR]
  Critical, public, PNG 1.2 compliant, unsafe to copy
  IHDR Width: 200
  IHDR Height: 240
  IHDR Bitdepth: 8
  IHDR Colortype: 4
  IHDR Compression: 0
  IHDR Filter: 0
  IHDR Interlace: 0
  IHDR Compression algorithm is Deflate
  IHDR Filter method is type zero (None, Sub, Up, Average, Paeth)
  IHDR Interlacing is disabled
  Chunk CRC: -277290027
Chunk: Data Length 1 (max 2147483647), Type 1111970419 [sRGB]
  Ancillary, public, PNG 1.2 compliant, unsafe to copy
  ... Unknown chunk type
  Chunk CRC: -1362223895
Chunk: Data Length 2 (max 2147483647), Type 1145523042 [bKGD]
  Ancillary, public, PNG 1.2 compliant, unsafe to copy
  ... Unknown chunk type
  Chunk CRC: -2020619073
Chunk: Data Length 9 (max 2147483647), Type 1935231088 [pHYs]
  Ancillary, public, PNG 1.2 compliant, safe to copy
  ... Unknown chunk type
  Chunk CRC: 2024095606
Chunk: Data Length 7 (max 2147483647), Type 1162692980 [tIME]
  Ancillary, public, PNG 1.2 compliant, unsafe to copy
  ... Unknown chunk type
  Chunk CRC: 292503155
Chunk: Data Length 19 (max 2147483647), Type 1951942004 [tEXt]
  Ancillary, public, PNG 1.2 compliant, safe to copy
  ... Unknown chunk type
  Chunk CRC: -528748773
Chunk: Data Length 8192 (max 2147483647), Type 1413563465 [IDAT]
  Critical, public, PNG 1.2 compliant, unsafe to copy
  IDAT contains image data
  Chunk CRC: -309524018
Chunk: Data Length 8192 (max 2147483647), Type 1413563465 [IDAT]
  Critical, public, PNG 1.2 compliant, unsafe to copy
  IDAT contains image data
  Chunk CRC: -1646200198
Chunk: Data Length 2301 (max 2147483647), Type 1413563465 [IDAT]
  Critical, public, PNG 1.2 compliant, unsafe to copy
  IDAT contains image data
  Chunk CRC: -810299134
Chunk: Data Length 0 (max 2147483647), Type 1145980233 [IEND]
  Critical, public, PNG 1.2 compliant, unsafe to copy
  IEND contains no data
  Chunk CRC: -1371381630 
```

示例图片：

![此问题的示例图像](../Images/1a64e68dae6bf426b2d50dc8a6ed1fab.png)

我很困惑。谢谢任何人。

PD：显然每张图片都会发生这种情况，这不是特殊情况，而是常见情况。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-07T16:35:55.500

这是一种从“有效”png 文件中提取文本信息的简单 Java 方法。国际字符可能无法在控制台上很好地显示。

```
import java.io.*;
import java.util.zip.InflaterInputStream;

public class PNGExtractText
{  
  /** PNG signature constant */
  public static final long SIGNATURE = 0x89504E470D0A1A0AL;
  /** PNG Chunk type constants, 4 Critical chunks */
  /** Image header */
  private static final int IHDR = 0x49484452;   // "IHDR"
  /** Image trailer */
  private static final int IEND = 0x49454E44;   // "IEND"
  /** Palette */
  /** Textual data */
  private static final int tEXt = 0x74455874;   // "tEXt"
  /** Compressed textual data */
  private static final int zTXt = 0x7A545874;   // "zTXt"
  /** International textual data */
  private static final int iTXt = 0x69545874;   // "iTXt"
  /** Background color */

  public static void showText(InputStream is) throws Exception
  {
      //Local variables for reading chunks
      int data_len = 0;
      int chunk_type = 0;
      byte[] buf=null;

      long signature = readLong(is);

      if (signature != SIGNATURE)
      {
          System.out.println("--- NOT A PNG IMAGE ---");
          return;
      }

        /** Read header */
        /** We are expecting IHDR */
      if ((readInt(is)!=13)||(readInt(is) != IHDR))
      {
          System.out.println("--- NOT A PNG IMAGE ---");
          return;
      }

      buf = new byte[13+4];//13 plus 4 bytes CRC
      is.read(buf,0,17);

      while (true)
      {
          data_len = readInt(is);
          chunk_type = readInt(is);
          //System.out.println("chunk type: 0x"+Integer.toHexString(chunk_type));

          if (chunk_type == IEND)
          {
             System.out.println("IEND found");
             int crc = readInt(is);
             break;
          }

          switch (chunk_type)
          {
               case zTXt:
               {  
                   System.out.println("zTXt chunk:");
                   buf = new byte[data_len];
                   is.read(buf);
                   int keyword_len = 0;
                   while(buf[keyword_len]!=0) keyword_len++;
                   System.out.print(new String(buf,0,keyword_len,"UTF-8")+": ");
                   InflaterInputStream ii = new InflaterInputStream(new ByteArrayInputStream(buf,keyword_len+2, data_len-keyword_len-2));
                   InputStreamReader ir = new InputStreamReader(ii,"UTF-8");
                   BufferedReader br = new BufferedReader(ir);                       
                   String read = null;
                   while((read=br.readLine()) != null) {
                      System.out.println(read);
                   }
                   System.out.println("**********************");
                   is.skip(4);
                   break;
               }

               case tEXt:
               {
                   System.out.println("tEXt chunk:");
                   buf = new byte[data_len];
                   is.read(buf);
                   int keyword_len = 0;
                   while(buf[keyword_len]!=0) keyword_len++;
                   System.out.print(new String(buf,0,keyword_len,"UTF-8")+": ");
                   System.out.println(new String(buf,keyword_len+1,data_len-keyword_len-1,"UTF-8"));
                   System.out.println("**********************");
                   is.skip(4);
                   break;
               }

               case iTXt:
               {
                  // System.setOut(new PrintStream(new File("TextChunk.txt"),"UTF-8"));
                  /**
                   * Keyword:             1-79 bytes (character string)
                   * Null separator:      1 byte
                   * Compression flag:    1 byte
                   * Compression method:  1 byte
                   * Language tag:        0 or more bytes (character string)
                   * Null separator:      1 byte
                   * Translated keyword:  0 or more bytes
                   * Null separator:      1 byte
                   * Text:                0 or more bytes
                   */
                   System.out.println("iTXt chunk:");
                   buf = new byte[data_len];
                   is.read(buf);
                   int keyword_len = 0;
                   int trans_keyword_len = 0;
                   int lang_flg_len = 0;
                   boolean compr = false;
                   while(buf[keyword_len]!=0) keyword_len++;
                   System.out.print(new String(buf,0,keyword_len,"UTF-8"));
                   if(buf[++keyword_len]==1) compr = true;
                   keyword_len++;//Skip the compresssion method byte.
                   while(buf[++keyword_len]!=0) lang_flg_len++;
                   //////////////////////
                   System.out.print("(");
                   if(lang_flg_len>0)
                       System.out.print(new String(buf,keyword_len-lang_flg_len, lang_flg_len, "UTF-8"));
                   while(buf[++keyword_len]!=0) trans_keyword_len++;
                   if(trans_keyword_len>0)
                       System.out.print(" "+new String(buf,keyword_len-trans_keyword_len, trans_keyword_len, "UTF-8"));
                   System.out.print("): ");
                   /////////////////////// End of key.
                   if(compr) //Compressed text
                   {
                       InflaterInputStream ii = new InflaterInputStream(new ByteArrayInputStream(buf,keyword_len+1, data_len-keyword_len-1));
                       InputStreamReader ir = new InputStreamReader(ii,"UTF-8");
                       BufferedReader br = new BufferedReader(ir);                       
                       String read = null;
                       while((read=br.readLine()) != null) {
                          System.out.println(read);
                       }
                   }
                   else //Uncompressed text
                   {
                       System.out.println(new String(buf,keyword_len+1,data_len-keyword_len-1,"UTF-8"));                           
                   }
                   System.out.println("**********************");
                   is.skip(4);
                   break;
               }    

               default:
               {
                   buf = new byte[data_len+4];
                   is.read(buf,0, data_len+4);
                   break;
               }
          }
      }
      is.close();
 }

 private static int readInt(InputStream is) throws Exception
 {
     byte[] buf = new byte[4];
     is.read(buf,0,4);
     return (((buf[0]&0xff)<<24)|((buf[1]&0xff)<<16)|
                            ((buf[2]&0xff)<<8)|(buf[3]&0xff));
 }

 private static long readLong(InputStream is) throws Exception
 {
     byte[] buf = new byte[8];
     is.read(buf,0,8);
     return (((buf[0]&0xffL)<<56)|((buf[1]&0xffL)<<48)|
                            ((buf[2]&0xffL)<<40)|((buf[3]&0xffL)<<32)|((buf[4]&0xffL)<<24)|
                              ((buf[5]&0xffL)<<16)|((buf[6]&0xffL)<<8)|(buf[7]&0xffL));
 }

 public static void main(String args[]) throws Exception
 {
    FileInputStream fs = new FileInputStream(args[0]);
    showText(fs);       
 }
} 
```

**注意：：**用法：java PNGExtractText image.png

这是我从官方 png 测试套件的测试图像 ctzn0g04.png 中得到的：

```
D:\tmp>java PNGExtractText ctzn0g04.png
tEXt chunk:
Title: PngSuite
**********************
tEXt chunk:
Author: Willem A.J. van Schaik
(willem@schaik.com)
**********************
zTXt chunk:
Copyright: Copyright Willem van Schaik, Singapore 1995-96
**********************
zTXt chunk:
Description: A compilation of a set of images created to test the
various color-types of the PNG format. Included are
black&white, color, paletted, with alpha channel, with
transparency formats. All bit-depths allowed according
to the spec are present.
**********************
zTXt chunk:
Software: Created on a NeXTstation color using "pnmtopng".
**********************
zTXt chunk:
Disclaimer: Freeware.
**********************
IEND found 
```

**编辑：**刚刚找到您的链接并尝试使用图像，得到这个：

```
D:\tmp>java PNGExtractText concept_Sjet_dream6.png
tEXt chunk:
Comment: The comment
**********************
IEND found 
```

上述示例已成为 Java 图像库的一部分，可在[https://github.com/dragon66/icafe找到](https://github.com/dragon66/icafe)

# ruby - 处理任意不等式并检查是否满足（如果有）

> ID：10454738
> 
> 赞同：0
> 
> 时间：2012-05-04T19:07:20.007
> 
> 标签：ruby, algorithm

给定一个非负整数 n 和用户定义的任意一组不等式（比如外部文本文件），我想确定 n 是否满足任何不等式，如果满足，是哪一个。

* * *

这是一个积分列表。

```
n = 0: 1
n < 5: 5
n = 5: 10 
```

如果您画一个等于 5 的数字 n，您将获得 10 分。
如果 n 小于 5，您将获得 5 分。
如果 n 为 0，则获得 1 分。

* * *

冒号左边的东西是“条件”，而右边的东西是“值”。
所有条目将采用以下形式：

```
n1 op n2: val 
```

在这个系统中，平等优先于不平等，因此它们出现的顺序最终将无关紧要。输入是非负整数，尽管中间值和结果可能不是非负数。结果甚至可能不是数字（例如：可能是字符串）。我将其设计为只接受最基本的不等式，以便更容易编写解析器（并看看这个想法是否可行）

我的程序有两个组件：

1.  一个解析器，它将读取结构化输入并构建一个数据结构来存储条件及其相关结果。

2.  一个函数，它将接受一个参数（一个非负整数）并返回结果（或者，在示例中，我收到的点数）

如果列表是硬编码的，这很容易：只需使用 case-when 或 if-else 块，我就完成了。但问题没有那么简单。

回忆顶部的列表。它可以包含任意数量的（不）等式。可能只有3个像上面这样。也许没有，或者可能有 10、20、50 甚至 1000000。本质上，你可以有 m 个不等式，因为 m >= 0

给定一个数字 n 和一个包含任意数量的条件和结果的数据结构，我希望能够确定它是否满足任何条件并返回相关值。与上面的示例一样，如果我传入 5，该函数将返回 10。

它们的条件/值对在其原始形式中并不是唯一的。您可能有多个相同（不）相等但具有不同值的实例。例如：

```
n = 0: 10
n = 0: 1000
n > 0: n 
```

注意最后一个条目：如果 n 大于 0，那么它就是你得到的任何值。

如果满足多个不等式（例如：n > 5、n > 6、n > 7），则应返回所有不等式。如果无法有效地做到这一点，我可以只返回第一个满意的并忽略其余的。但我希望能够检索整个列表。

* * *

我一直在考虑这个问题，我想我应该使用两个哈希表：第一个将存储等式，而第二个将存储不等式。

平等很容易处理：只需将条件作为键并有一个值列表。然后我可以快速检查 n 是否在哈希中并获取适当的值。

但是，对于不平等，我不确定它会如何运作。有谁知道如何以尽可能少的计算步骤解决这个问题？很明显，我可以在 O(n) 时间内轻松完成此任务：只需逐个（不）等式运行它。但是，如果这种检查是实时完成的，会发生什么？（例如：不断更新）

例如，很明显，如果我有 100 个不等式，其中 99 个检查值 > 100，而另一个检查值 <= 100，那么当我通过 47 时，我不必费心检查这 99 个不等式。

您可以使用任何数据结构来存储数据。解析器本身不包含在计算中，因为这将被预处理并且只需要执行一次，但是如果解析数据花费的时间太长可能会出现问题。

由于我使用的是 Ruby，因此在“处理”数据以及如何解释数据时，我可能有更灵活的选择。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-04T20:33:51.360

```
class RuleSet
  Rule = Struct.new(:op1,:op,:op2,:result) do
    def <=>(r2)
      # Op of "=" sorts before others
      [op=="=" ? 0 : 1, op2.to_i] <=> [r2.op=="=" ? 0 : 1, r2.op2.to_i]
    end
    def matches(n)
      @op2i ||= op2.to_i
      case op
        when "=" then n == @op2i
        when "<" then n  < @op2i
        when ">" then n  > @op2i
      end
    end
  end

  def initialize(text)
    @rules = text.each_line.map do |line|
      Rule.new *line.split(/[\s:]+/)
    end.sort
  end

  def value_for( n )
    if rule = @rules.find{ |r| r.matches(n) }
      rule.result=="n" ? n : rule.result.to_i
    end
  end
end

set = RuleSet.new( DATA.read )
-1.upto(8) do |n|
  puts "%2i => %s" % [ n, set.value_for(n).inspect ]
end

#=> -1 => 5
#=>  0 => 1
#=>  1 => 5
#=>  2 => 5
#=>  3 => 5
#=>  4 => 5
#=>  5 => 10
#=>  6 => nil
#=>  7 => 7
#=>  8 => nil

__END__
n = 0: 1
n < 5: 5
n = 5: 10
n = 7: n 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-04T19:58:40.230

我没有花很多时间在你的问题上，但这是我的快速想法：

由于`points list`总是采用 format `n1 op n2: val`，我只是将点建模为哈希数组。

所以第一步是将输入点列表解析成数据结构，一个哈希数组。每个散列都有值 n1, op, n2, value

然后，对于每个数据输入，您将遍历所有哈希（所有点）并处理每个哈希（确定它是否与输入数据匹配）。

**交易的一些技巧**

花时间在解析器中处理错误的输入。例如

```
n < = 1000  # no colon
n < : 1000  # missing n2
x < 2 : 10  # n1, n2 and val are either number or "n"
n           # too short, missing :, n2, val
n < 1 : 10x # val is not a number and is not "n" 
```

ETC

也礼貌地处理非数字输入数据

**添加**

回复：n1 没关系。小心，这可能是一个诡计。为什么不

```
5 < n : 30 
```

是一个有效的积分列表项？

回复：多个哈希数组，每个运算符一个数组，每个点列表项一个哈希 - 确定没问题。由于每个操作都以特定的方式处理，因此可以一个一个地处理运算符。但是....订购就成了一个问题：

由于您希望从多个匹配点列表项返回多个结果，因此您需要维护它们的整体顺序。因此，我认为所有点列表的一个数组将是最简单的方法。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-04T20:25:55.407

我会解析输入行并将它们分成谓词/结果对并构建可调用过程的哈希（使用`eval`- 哦，不！）。“检查”函数可以遍历每个谓词并在其中一个为真时返回相关的结果：

```
class PointChecker
  def initialize(input)
    @predicates = Hash[input.split(/\r?\n/).map do |line|
      parts = line.split(/\s*:\s*/)
      [Proc.new {|n| eval(parts[0].sub(/=/,'=='))}, parts[1].to_i]
    end]
  end
  def check(n)
    @predicates.map { |p,r| [p.call(n) ? r : nil] }.compact
  end
end 
```

这是示例用法：

```
p = PointChecker.new <<__HERE__
  n = 0: 1
  n = 1: 2
  n < 5: 5
  n = 5: 10
__HERE__
p.check(0) # => [1, 5] 
p.check(1) # => [2, 5] 
p.check(2) # => [5] 
p.check(5) # => [10] 
p.check(6) # => [] 
```

当然，这个实现有很多问题。我只是提供一个概念验证。根据您的应用程序的范围，您可能希望构建适当的解析器和运行时（而不是使用`eval`），更一般/优雅地处理输入等。

# html - 我的评论系统的交替背景颜色

> ID：10454740
> 
> 赞同：0
> 
> 时间：2012-05-04T19:07:32.257
> 
> 标签：html, css, colors

我需要您的帮助，了解如何为我的评论系统替换背景颜色。这样红色和蓝色将在其他元素中交替出现。到目前为止，这就是我想要做的工作，但没有成功。

感谢您的时间和耐心。

```
 #comment :nth-child(odd) {
     background-color: red;
   }

   #comment :nth-child(even) {
      background-color: blue;
   }

     #comment {
    color: green;
    margin: 5px auto;
    padding: 5px auto
     width: 100px;
    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-04T19:09:00.393

有一个错字。它被称为`background-color`，而不是`bacground-color`在第二个选择器中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-04T19:21:07.173

更改背景拼写

尝试这样的事情

```
 <html xmlns="http://www.w3.org/1999/xhtml">
            <head>
            <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
            <title>Test Document</title>
            <style type="text/css">

            #comment tr:nth-child(even) {background:blue}
            #comment tr:nth-child(odd) {background: red}
                 #comment {
                color: green;
                margin: 5px auto;
                padding: 5px auto
                 width: 100px;
                }
            </style>
            </head>
            <body>
            <table id="comment">

            <tr>
            <td>test</td>
            </tr>

            <tr>
            <td>test1</td>
            </tr>

            <tr>
            <td>test2</td>
            </tr>

            <tr>
            <td>test3</td>
            </tr>

            </table>
            </body>
            </html> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-04T20:14:23.400

例子：

HTML

```
<div id="comment">
  <div>comment 1</div>
  <div>comment 2</div>
</div> 
```

CSS

```
#comment div:nth-child(odd){background-color:#ff0000;}
#comment div:nth-child(even){background-color:#0000ff;} 
```

要考虑不支持 nth-child 的浏览器，您还可以使用 .odd 和 .even 类，并使用 javascript 和一些功能检测（例如modernizr）附加它们。

解释 CSS：

```
#comment is the parent
div is the child
:nth-child specifies which of these children to apply the rule to 
```

希望这可以帮助！

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2012-05-04T19:26:33.957

我看到了一些可能有问题的地方。

首先，确保您使用的浏览器支持此 CSS3 规则。

其次，您使用的是 # CSS 选择器而不是 . 选择器。您在页面上只有一条评论吗？如果答案是否定的，我知道是这样，那么你应该使用类。此外，不要在伪类选择器中包含空格。

你的代码应该看起来像这样

```
.comment tr:nth-child(even)
{
      background-color: blue;
}

.comment tr:nth-child(odd)
{
      background-color: red;
}

.comment tr
{
    color: green;
    margin: 5px auto;
    padding: 5px auto
    width: 100px;
} 
```

# jquery - colorbox，从数组链接中显示图库

> ID：10454746
> 
> 赞同：0
> 
> 时间：2012-05-04T19:07:52.960
> 
> 标签：jquery, arrays, colorbox

我有我想在 jquery colorbox 中显示的画廊，

用户单击该链接并打开覆盖图库。该图库包含 1 个或多个图像。

```
<a href="" id="30">
<img border="0" src="/uploads/coverGallery1.png" width="225" height="164" alt="" class="image"/>
</a> 
```

我只能将 db 中的图像作为数组链接提供：

```
<script>
   var prod_img_30 = Array(       // 30: is the id of the link
            Array('/uploads/image1.png',0),
            Array('/uploads/image2.png',0), 
            Array('/uploads/image1.png',0)
                    );
</script> 
```

我需要将 jquery colorbox 集成到我的代码中，但直到现在我还不能，任何想法都会有所帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-04T19:12:39.853

ColorBox 仅适用于 DOM 中的元素，因此您必须临时添加到文档的链接才能将它们显示为图库。例如：

```
var $gallery = $('<div>').hide().appendTo('body');
var arr = ['img1.jpg', 'img2.jpg', 'img3.jpg'];

$.each(arr, function(i){
    $('<a href="'+arr[i]+'"></a>').appendTo($gallery);
});

$gallery.find('a').colorbox({rel:'mygroup', open:true}); 
```

# vim - 视觉模式下的“s”有什么作用？

> ID：10454747
> 
> 赞同：8
> 
> 时间：2012-05-04T19:07:54.570
> 
> 标签：vim, vi, macvim

我已经下载了 Tim Pope 的环绕声插件的新版本。我注意到他弃用了“s”而改用大写的“S”。

他说这是为了防止在视觉模式下敲击小写字母“s”而干扰大量 Vim 用户的肌肉记忆。我做了一些谷歌搜索，但我似乎无法找到这到底是做什么的？

我想知道，以防万一我应该知道有关该组合键的大量信息:)

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-05-04T20:42:25.900

如 Vim 手册中所述：

> {Visual}["x]c 或 v_c v_s {Visual}["x]s 删除突出显示的文本 [到寄存器 x] 并开始插入（对于 {Visual}，请参见 Visual-mode）。{Vi 无此功能}

所以 c 和 s 在可视模式下都做同样的事情。

此外，一般来说，如果您想知道键在正常模式以外的*其他*情况下的作用，只需在键前加上模式的第一个字母和下划线即可。

例如：

```
:help v_s 
```

找出 s 键在可视模式下的作用。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-04T19:14:58.177

`s``x`做和那时一样的事情`i`

基本上删除当前突出显示的字符，然后进入插入模式

# java - 如何在没有命令提示符的情况下运行可执行的 .jar 文件？

> ID：10454748
> 
> 赞同：1
> 
> 时间：2012-05-04T19:08:00.807
> 
> 标签：java, jar

我有一个成功运行的非常基本的 .jar 文件，但我似乎只能通过执行以下两项操作之一来运行它：

1.  使用命令提示符并输入命令，例如`java -jar test.jar`
2.  创建路径为的快捷方式`java -jar C:\Users\Nick\Documents\test.jar`

有没有一种方法可以运行 .jar 文件而无需执行这两件事中的任何一项，即从 Windows 资源管理器中运行它的方法？

编辑：我的 .jar 文件如下所示：

```
Manifest-Version: 1.0
Rsrc-Class-Path: ./
Class-Path: .
Rsrc-Main-Class: base.MainClass
Main-Class: org.eclipse.jdt.internal.jarinjarloader.JarRsrcLoader 
```

我使用 Eclipse 来创建它。我是否应该将 Main-Class 编辑为 base.MainClass，并删除其中包含 Rsrc 的任何内容？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-04T19:16:11.983

*   双击它
*   使用一些东西将 JAR 文件包装成一个常见的 exe（例如[http://launch4j.sourceforge.net/](http://launch4j.sourceforge.net/)）

**注意：**当您双击一个 JAR 并且 JAR 只是在控制台上打印出一些内容时，窗口可能会在执行后立即关闭。在这种情况下，你不会看到太多。但是您的程序已正确执行，并且执行后只是关闭了窗口。尝试在您的应用程序中打开一个 JFrame，然后您应该在双击 JAR 时看到该框架。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2016-05-30T00:40:11.517

在分发目录中创建一个 .bat 文件。

```
@echo off 
start javaw -Dfile.encoding=UTF8 -jar test.jar
exit 
```

这个 .bat 文件也将修复特殊字符的问题，例如。netbeans，但双击 .jar 时不会

如果您不需要对特殊字符的支持，您可以省略“-Dfile.encoding=UTF8”部分。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-12-10T02:14:48.353

我的 JAR 与 7Zip 相关联。要运行可执行 JAR，请右键单击文件名并选择 Open With > Java。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-05-05T19:16:58.590

安装 Java 应该为您的操作系统创建一个快捷方式，以便您可以通过双击打开可执行 jar。

如果它不适合您，您必须调查如何为您的操作系统版本执行此操作。

我猜对于 Windows，它是右键单击应用程序，然后配置“使用...打开”对话框。

要运行的程序是 afaik：

```
javaw -jar "%*" 
```

如果它不在 PATH 中，则必须在其中指定 javaw 的整个路径。

如果 Java 程序本身需要命令行参数，例如旋转图像的程序可能需要图像文件作为参数，因此您可以用鼠标在 jarfile 上绘制它们，因此您为“所有参数”指定 windows 语法，即“%*”或类似的东西。您的操作系统手册应该回答这个问题。

# ruby-on-rails - 如何检查导轨中的过滤器链（3.0.8）

> ID：10454751
> 
> 赞同：7
> 
> 时间：2012-05-04T19:08:07.877
> 
> 标签：ruby-on-rails, filter, before-filter

显然[`#filter_chain`](http://apidock.com/rails/ActionController/Filters/ClassMethods/filter_chain)已弃用，有人知道怎么做吗？我已经尝试了几件事，但找不到任何有效的方法。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-05-04T19:10:42.637

```
YourController._process_action_callbacks 
```

# .net - 如何通过 NetworkStream 流式传输数据结构或记录？

> ID：10454753
> 
> 赞同：0
> 
> 时间：2012-05-04T19:08:18.723
> 
> 标签：.net, tcpclient, networkstream, delphi-prism, tcpserver

我有以下数据结构或记录，我需要通过 NetworkStream 与另一台机器进行流式传输。

```
 TRemoteRecord = record
    command:TRemoteCommand;
    status:TRemoteStatus;
    signame:string;
    rvalue:double;
    ivalue:LongInt;
  end; 
```

这是我向流发送或写入数据结构或记录的方式。

```
TheStream:NetworkStream;
 SignalClient:TcpClient;
 SignalServer:TcpServer;
 sb:TRemoteRecord;

 SignalClient.ConnectNew(LocalIPEdit.Text,Int32.Parse(ClientPort.Text));
 TheStream := new NetWorkStream(SignalClient.Connect.DataSocket);
 TheStream.Write(sb, 0 SizeOf(sb)); 
```

当我编译它时，它会引发一个异常，“这些参数没有重载写入。”

如何通过networkstream发送和接收数据结构或记录？

谢谢，

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-11T11:04:02.080

您需要先将 Record 序列化为 byte[]。

这将使您开始：

[http://msdn.microsoft.com/en-us/library/ms752244.aspx](http://msdn.microsoft.com/en-us/library/ms752244.aspx)

以下是对给定类型进行序列化和反序列化的两种方法：http: [//dooba.net/2009/07/02/c-sharp-and-serializing-byte-arrays/](http://dooba.net/2009/07/02/c-sharp-and-serializing-byte-arrays/) [注意：特别注意处理字符串的方式（它具有可变大小）和您的自定义类型。]

# c++ - 如何链接到 Lua 中的回调函数，以便在重新加载脚本时更新回调？

> ID：10454754
> 
> 赞同：0
> 
> 时间：2012-05-04T19:08:29.297
> 
> 标签：c++, lua, luabind

我正在使用 LuaBind 在我的游戏中实现 Lua 脚本，我不清楚的一件事是在游戏中重新加载脚本的后勤工作。

目前，使用 LuaBind C++ 类`luabind::object`，我将对 Lua 回调的引用直接保存在使用它们的类中。然后我可以使用`luabind::call_function`该对象从 C++ 代码中调用 Lua 代码。

我还没有对此进行测试，但我的假设是，如果我重新加载脚本，那么所有函数都将被重新定义，但对旧函数的引用仍将以`luabind::object`C++ 代码所持有的形式存在。我希望能够将旧的换成新的，而不必为游戏中的每个脚本挂钩手动管理它。

如何最好地改变这一点，使过程有效？

我的第一个想法是不要直接保存对函数的引用，而是可能保存函数名，并在每次我们想调用它时按名称获取函数。我正在寻找更好的想法！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-04T19:21:55.947

> 我的第一个想法是不要直接保存对函数的引用，而是可能保存函数名，并在每次我们想调用它时按名称获取函数。

如果您的类正在调用具有已知名称的全局函数，那么这几乎可以解决您的问题。无需提前获取参考资料；它不会产生可衡量的性能差异。我认为`call_function`无论如何都支持将函数名作为字符串传递，对吗？

* * *

当 Lua 脚本注册回调时，您通常会存储对函数值的引用。在这种情况下，它比存储名称要好得多，因为它允许 Lua 脚本注册本地、匿名等函数。

* * *

如果你真的*必须*提前获取价值值，就像你现在所做的那样（实际上没有理由这样做，但我们会假装它是必要的），我会添加一层间接性。你可以有一个封装了全局名称的 LuaFunctionReference 类。在实例化期间，它获取对全局包含的函数的引用。这些对象可以从维护所有此类引用列表的工厂获取。当您重新加载脚本时，您可以拥有工厂/管理器/池/等。对象遍历引用并让它们自己更新，因此整个系统中隐藏在类中的所有引用都将被更新。

# ios - 如何在视图中延迟/异步加载各种元素（标签中的数据）？

> ID：10454757
> 
> 赞同：3
> 
> 时间：2012-05-04T19:08:40.850
> 
> 标签：ios

我有一个带有各种标签的 ViewController。这些标签中的每一个都在运行时根据 html 页面上运行的各种正则表达式解析逻辑动态填充。问题是，每个正则表达式匹配需要 2-3 秒，而我有 8 个这样的标签，这意味着我必须等待大约 20-25 秒才能显示视图！

这是非常非常糟糕的用户体验。我希望这样可以减轻用户的痛苦，因此希望在处理正则表达式后获得数据时独立加载每个标签，而不是等待所有 8 个标签完成检索其正则表达式匹配。

任何方式都可以在 ios 5 中实现？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-04T19:25:15.203

1.  创建一个单独的函数来计算您需要的值。
    （为了代码的可读性/可维护性，你可能已经有了这个。）
2.  在后台线程中运行此线程。
3.  当您准备好实际设置文本时，请确保在主线程上执行此操作：

这是一个例子：

```
- (void)calculateLabelText {
    NSString *label1Text = // However you calculate this...
    dispatch_async(dispatch_get_main_queue(), ^(void) {
        self.label1.text = label1Text;
    });

    NSString *label2Text = // However you calculate this...
    dispatch_async(dispatch_get_main_queue(), ^(void) {
        self.label2.text = label2Text;
    });
} 
```

在 viewDidLoad 中，添加：

```
[self performSelectorInBackground:@selector(calculateLabelText) withObject:nil]; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-04T19:24:54.353

使用大中央调度 (GCD)。它将为您处理队列和线程等。无需为仅发生一次的一组操作创建方法，无论如何，`dispatch_async()`它比在后台线程上执行选择器更快，并且您可以保留现有代码结构 - 您只需将其包装在一个不错的并发包中这不会阻塞主线程:)

> // 获取对全局并发队列的引用（无需创建我们自己的）。
> 
> ```
> dispatch_queue_t queue = dispatch_get_global_queue(DISPATCH_QUEUE_PRIORITY_DEFAULT,0); 
> ```
> 
> 对于每个标签的正则表达式操作 {
> 
> ```
> dispatch_async(queue, ^{
>      // your regex here for one 
> 
>      // execute back in the main thread since UIKit only operates in the main thread.
> 
>     dispatch_async(dispatch_get_main_queue(), ^{
>         [myLabel setText:<result of operations>];
>     });
> }); 
> ```
> 
> }

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-25T03:39:38.223

如果你想使用它，你必须注意让你的代码分开。一部分进行数据加载工作，另一部分将数据设置为控件。你必须确保你的sqlite（我假设你使用这个数据库）在多线程中很酷。

# javascript - 使用 jQuery 发送多个表单之一

> ID：10454759
> 
> 赞同：0
> 
> 时间：2012-05-04T19:08:44.543
> 
> 标签：javascript, jquery, forms, click, element

我正在做类似以下的事情：

```
$.each(data2, function(key2, val2) {
    $('#posts').append('<div class="send_comment" align="right">');
    $('#posts').append('<input type="hidden" class="com_post_id" value="'+i+'"><br /\>');
    $('#posts').append('Author: <input type="text" class="com_author"><br /\>');
    $('#posts').append('Img: <input type="text" class="com_img"><br /\>');
    $('#posts').append('Text: <input type="text" class="com_text"><br /\>');
    $('#posts').append('<button class="new_comment">Send</button>');
    $('#posts').append('</div>');
}); 
```

我怎样才能发送这些字段`$.post`？有了`$(this)`，我可以获得点击的元素，但是呢？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-04T19:13:02.710

`data = $(this).closest('form').serialize()`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-04T19:15:24.787

由于它是动态注入的元素，您应该使用绑定功能`jQuery on`

```
 $(function(){
      $(".send_comment").on("click",".new_comment",function(e){
         e.preventDefault();
         var item=$(this);
         var postId=item.parent().find(".com_post_id");   
         var author=item.parent().find(".com_author");  
         var msg=item.parent().find(".com_text");  

         $.post("yourPage.php", { id : postId, author:author ,msg:msg },function(result){
             //do whatever with result
              alert(result);
         });

      });
    }); 
```

[http://api.jquery.com/on/](http://api.jquery.com/on/)

jQuery`on`将适用于当前和未来的元素。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-04T19:19:45.260

我总是从 jqueryui 的网站上找到模态表单示例作为如何从表单发送数据的一个很好的例子：http: [//jqueryui.com/demos/dialog/#modal-form](http://jqueryui.com/demos/dialog/#modal-form)

基本上给你的字段ID，然后：

```
var author = $( "#author" ),
    image = $( "#image" ),
    text = $( "#text" ),
    allFields = $( [] ).add( author ).add( image ).add( text ); 
```

然后使用帖子：

```
$.post("your_url_that_processes_data",allFields, function(data){ 
   // do something with data 
}); 
```

如果您有多种形式略有不同，那么有很多方法可以解决这个问题。我建议要么更改操作 URL，要么以某种方式从某些 DOM 元素中获取“id”。也许您可以将表单 id 更改为：`"form-".id`在您的脚本中，然后在提交之前阅读它。

我可以尝试帮助更详细的用例吗？

# wcf - 带有 xsd 生成的数据类的 WCF 服务返回空对象

> ID：10454763
> 
> 赞同：0
> 
> 时间：2012-05-04T19:09:05.220
> 
> 标签：wcf, xsd, wscf

我有一个 xsd 文件，我用它生成数据类（使用 xsd.exe 或 WSCF-blue）来构建 WCF 服务。

然后我将生成的类添加到 WCF 服务中的操作中，如下所示：

```
MyGeneratedClassOUT operation1(MyGeneratedClassIN request) 
```

当我从客户端调用该操作时，客户端会返回`MyGeneratedClassOut`填充了空值的请求，即使我很难在服务器端填充它们。

有谁知道如何解决这个问题？这可能是 XSD 文件或 WCF 配置中的问题吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-05T10:44:14.057

这很可能是命名空间问题。如果请求和响应具有相同的命名空间，请检查 Fiddler。

# xml - 需要剥离除节点号以外的所有内容的 URL

> ID：10454764
> 
> 赞同：1
> 
> 时间：2012-05-04T19:09:07.630
> 
> 标签：xml, drupal

我有一个大的 xml 文件（>30mb），其中包含诸如 yoursite.com/category/section/3389121/title-article 之类的路径

我需要删除路径中除节点号之外的所有内容。我想也许使用正则表达式，但不知道如何使它不适用于其余的 xml 字段。

有什么想法吗？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-04T20:46:49.000

您可以使用 PHP 的 SimpleXML 库来解析出您需要的 XML 字段，然后针对它们运行您的正则表达式。一旦您看到它用于执行此操作的语法，您就会明白为什么它被称为 SimpleXML。

# linux - 在 R 上安装 kernlab 包

> ID：10454765
> 
> 赞同：1
> 
> 时间：2012-05-04T19:09:08.827
> 
> 标签：linux, r, suse

我正在尝试在 R 上安装 kernlab 包，但我收到了一大堆错误消息，接近尾声时说：

`g++ -shared -L/usr/local/lib64 -o kernlab.so brweight.o ctable.o cweight.o dbreakpt.o dcauchy.o dgpnrm.o dgpstep.o dprecond.o dprsrch.o dspcg.o dtron.o dtrpcg.o dtrqsol.o esa.o expdecayweight.o inductionsort.o kspectrumweight.o lcp.o misc.o msufsort.o solvebqp.o stringk.o stringkernel.o svm.o wkasailcp.o wmsufsort.o -L/usr/lib64/R/lib -lRlapack -L/usr/lib64/R/lib -lRblas -lgfortran -lm -L/usr/lib64/R/lib -lR /usr/lib64/gcc/x86_64-suse-linux/4.3/../../../../x86_64-suse-linux/bin/ld: cannot find -lgfortran collect2: ld returned 1 exit status make: *** [kernlab.so] Error 1 ERROR: compilation failed for package âkernlabâ * removing â/usr/lib64/R/library/kernlabâ`

`The downloaded source packages are in â/tmp/RtmpzLdUMp/downloaded_packagesâ Updating HTML index of packages in '.Library' Making packages.html ... done Warning message: In install.packages("kernlab") : installation of package âkernlabâ had non-zero exit status`

我怀疑它与 gcc-fortran 有关。我使用的是 SUSE 11 SP1，我安装了 libgfortran43-4.3.4_20091019-47.1，但我无法弄清楚如何使用 yast 安装 gcc-fortran。

任何帮助表示赞赏！谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-04T23:51:27.763

我不使用 SUSE，但稍作搜索表明您可以从此页面获取 gcc-fortran：http: [//software.opensuse.org/package/gcc-fortran](http://software.opensuse.org/package/gcc-fortran)

# css - CSS 中心分层动态 div

> ID：10454770
> 
> 赞同：0
> 
> 时间：2012-05-04T19:09:33.580
> 
> 标签：css

这个 css 有点难以弄清楚......基本上我想要的是这张图片中的内容，但内容是动态变化的。

![在此处输入图像描述](../Images/e395ee1d308f1705211b74d8c152bfdd.png)

所以我这样设置我的html，基本上所有的元素都堆在包装器中，图片和标题会动态旋转，并且会有不同的宽度和高度：

```
<div id="wrapper">
<div id="title"><h2></div>
<div id="image"><img></div>
<div id="leftbutton" class="but"><img></div>
<div id="rightbutton" class="but"><img></div>
</div> 
```

我尝试过的一切都没有成功。我应该怎么做？

我得到的最接近的是这个，但是标题字段可以改变高度，这使得这种方法不起作用，因为我必须相对定位图像，并且它的相对位置随着标题元素的增长和缩小而变化：

```
#wrapper{
position:relative;
text-align: center;
}
.but{
z-index:20;
position:absolute;
}
#leftbutton{
left:0px;
}
#rightbutton{
right:0px;
}
#title{
z-index: 3;
display: inline-block;
width:auto;
min-width: 80px;
max-width: 340px;
}
#image{
z-index: 1;
position: relative;
top:-21px;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-04T19:15:14.603

如果您指的是中心的标题，请使用以下方式：

```
#title {
    margin: 0 auto;
    width: /* your width */
} 
```

该位置应该在包装器处是相对的。

**[JsFiddle UP](http://jsfiddle.net/Zpa9n/1/)**

我只是重新组织了 body 结构，添加了一个 div 并将所有内容浮动。然后在中心部分我添加了标题和图像，您可以将它们设置为以相对 div 为中心。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-04T19:24:57.833

如果您提供了一些示例代码，我们将更好地为您提供帮助。同时，以下代码应该处理您要查找的内容：

HTML

```
<div id="wrapper">
    <div id="title"><h2>Article Headline</h2></div>
    <div id="image"><img></div>
    <div id="leftbutton"><img></div>
    <div id="rightbutton"><img></div>
</div>​ 
```

CSS

```
​#wrapper {
    background:#6cb6d9;
    display:inline-block;
    position:relative;} 

#title {
    position:absolute;
    top:0;
    width:100%;
    text-align:center;}

#title h2 {
    background:green;
    color:white;
    padding:10px 15px 10px 15px;
    display:inline-block;
    max-width:200px}

#image {}

#image img {
    min-width:200px;
    height:300px;
    width:500px; }

#leftbutton {
    position:absolute;
    left:0;
    top:0;
    height:100%;
    width:75px;
    background:black;}

#rightbutton {
    position:absolute;
    right:0;
    top:0;
    height:100%;
    width:75px;
    background:black;} 
```

虽然不是硬编码 img 大小，只需删除这些 CSS 行，让 div 自动调整为 img 的默认大小。

[http://jsfiddle.net/b7c7c/](http://jsfiddle.net/b7c7c/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-04T20:55:39.700

这些解决方案都没有正常工作，最终让它工作的方法是使用这个技巧：[如何在 div 中将绝对定位的元素居中？](https://stackoverflow.com/questions/1776915/how-to-center-absolute-element-in-div)

然后，您只需将所有元素绝对定位在包装器中，并且相对地定位子元素，如帖子中所示

# python - 将 GoPro MP4 视频导入 Python/OpenCV

> ID：10454776
> 
> 赞同：2
> 
> 时间：2012-05-04T19:10:11.090
> 
> 标签：python, opencv, mp4

我正在使用 Python (2.7) 中的 GoPro 相机开发 OpenCV 项目。我正在寻找一种将这些视频文件带入 OpenCV 进行分析的方法。以下是我遇到的问题，任何建议将不胜感激：

1.  我只能让 OpenCV (2.3) 识别原始 AVI 文件。将 MP4 转换为原始 AVI 会产生巨大的文件，并且上限为 2gb（约 30 秒）。
2.  pyFFmpeg 仅适用于 Python 2.6。
3.  pyMedia 不适用于 GoPro 导出的 mp4。

理想情况下，我会读入 mp4 文件，并创建一个循环来解码帧、保存、分析、编码和导出。我的想法不多了。有什么想法吗？

# sorting - 对大字符串中的字母进行排序

> ID：10454777
> 
> 赞同：0
> 
> 时间：2012-05-04T19:10:15.273
> 
> 标签：sorting

我有一个 16 MB 的文本文档，其中包含一个巨大的字母和数字字符串，没有任何分隔符。摘录：“as81jsa8sm1o1kmka9s93m1l”

有没有一种简单的方法来按字母顺序排列所有字符，而无需编写脚本？恐怕JS会在文件的重量下崩溃。

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-04T19:24:22.283

如果您知道字符串仅包含字母和数字，则可以使用桶排序并获得良好的性能。

我不确定您使用的是什么语言，所以我假设您可以逐个字符地读取字符串。我的解决方案是伪代码

```
int[] buckets = int[36]; // 26 for letters, 10 for numbers; assuming only lowercase characters
while(string.hasNext()) {
  char x = next character in string;
  if(x.isAlpha()) {
    buckets[x-'a']++;
  }else {
    buckets[26 + x - '0']++
  }

} 
```

要打印出排序后的字符串：

```
string s = ""; // at the end of the loops, s will contain the sorted string
for(int i =0 ; i < 26; ++i) {
  int y = buckets[i];
  for(int j = 0; j < y; ++j) {
    s+=(y+'a');
  }

}
for(int i =0 ; i < 10; ++i) {
  int y = buckets[i+26];
  for(int j = 0; j < y; ++j) {
    s+=(y+'0');
  }

} 
```

# android - 在手机和模拟器上运行安卓应用

> ID：10454778
> 
> 赞同：0
> 
> 时间：2012-05-04T19:10:18.527
> 
> 标签：android, android-emulator

我写了一个android应用程序`ICS`并将其最小值设置`SDK`为8。我在模拟器上运行该应用程序并且它工作正常但是当我在我的手机上安装.apk文件时我强制关闭。为什么我会遇到这个问题？该应用程序适用于 OCR。

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="fill_parent"
    android:layout_height="fill_parent"
    android:background="@android:color/white"
    android:orientation="vertical" >

    <LinearLayout
        android:id="@+id/H1"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content" >

        <ImageView
            android:id="@+id/iv1"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:src="@drawable/ic_launcher" />

        <ImageView
            android:id="@+id/iv2"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:src="@drawable/ic_launcher" />

        <ImageView
            android:id="@+id/iv3"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:src="@drawable/ic_launcher" />

        <ImageView
            android:id="@+id/iv4"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:src="@drawable/ic_launcher" />

        <ImageView
            android:id="@+id/iv5"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:src="@drawable/ic_launcher" />

        <ImageView
            android:id="@+id/iv6"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:src="@drawable/ic_launcher" />

        <ImageView
            android:id="@+id/iv13"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:src="@drawable/ic_launcher" />

        <ImageView
            android:id="@+id/iv7"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:src="@drawable/ic_launcher" />

        <ImageView
            android:id="@+id/iv14"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:src="@drawable/ic_launcher" />

        <ImageView
            android:id="@+id/iv12"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:src="@drawable/ic_launcher" />

        <ImageView
            android:id="@+id/iv11"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:src="@drawable/ic_launcher" />

    </LinearLayout>

    <LinearLayout
        android:id="@+id/H2"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content" >

        <ImageView
            android:id="@+id/iv8"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:src="@drawable/ic_launcher" />

        <ImageView
            android:id="@+id/iv9"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:src="@drawable/ic_launcher" />

        <ImageView
            android:id="@+id/iv10"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:src="@drawable/ic_launcher" />
    </LinearLayout>

    <LinearLayout
        android:id="@+id/H3"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:orientation="vertical" >
    </LinearLayout>

</LinearLayout> 
```

此外，我总是在 XML 文件中收到此通知：

```
[Accessibility] Missing contentDescription attribute on image 
```

为什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-04T19:15:45.463

不知道为什么它会崩溃，但你得到的错误只是一个警告。contentDescription 仅用于可访问性，不需要。导致崩溃的错误很可能存在于代码的其他地方。

# php - PHP - 重载属性的间接修改

> ID：10454779
> 
> 赞同：68
> 
> 时间：2012-05-04T19:10:35.817
> 
> 标签：php, magic-methods

我知道这个问题已经被问过好几次了，但他们都没有真正的解决方法。也许有一个适合我的具体情况。

我正在构建一个映射器类，它使用魔法方法`__get()`来延迟加载其他对象。它看起来像这样：

```
public function __get ( $index )
{
    if ( isset ($this->vars[$index]) )
    {
        return $this->vars[$index];
    }

    // $index = 'role';
    $obj = $this->createNewObject ( $index );

    return $obj;
} 
```

在我的代码中，我这样做：

```
$user = createObject('user');
$user->role->rolename; 
```

到目前为止，这有效。该`User`对象没有名为“角色”的属性，因此它使用魔术`__get()`方法创建该对象，并从“角色”对象返回其属性。

但是当我尝试修改“角色名”时：

```
$user = createUser();
$user->role->rolename = 'Test'; 
```

然后它给了我以下错误：

> **注意：重载属性的间接修改无效**

不确定这是否仍然是 PHP 中的一些错误，或者它是否是“预期的行为”，但无论如何它都不能按我想要的方式工作。这对我来说真的是一个表演终结者......因为我到底怎么能改变延迟加载对象的属性？

* * *

编辑：

只有当我返回一个包含多个对象的数组时，才会出现实际问题。

我添加了一段重现问题的示例代码：

[http://codepad.org/T1iPZm9t](http://codepad.org/T1iPZm9t)

你真的应该在你的 PHP 环境中运行它才能真正看到“错误”。但是这里发生了一些非常有趣的事情。

我尝试更改对象的属性，这给了我“无法更改重载属性”的通知。但是，如果我在那之后回显该属性，我发现它实际上确实改变了值......真的很奇怪......

* * *

## 回答 #1

> 赞同：103
> 
> 时间：2012-11-01T22:47:33.697

您需要做的就是在 __get 函数前面添加“&”以将其作为参考传递：

```
public function &__get ( $index ) 
```

与这个斗争了一段时间。

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2012-05-04T19:48:14.767

很好，你给了我一些可以玩的东西

跑

```
class Sample extends Creator {

}

$a = new Sample ();
$a->role->rolename = 'test';
echo  $a->role->rolename , PHP_EOL;
$a->role->rolename->am->love->php = 'w00';
echo  $a->role->rolename  , PHP_EOL;
echo  $a->role->rolename->am->love->php   , PHP_EOL; 
```

输出

```
test
test
w00 
```

使用的类

```
abstract class Creator {
    public function __get($name) {
        if (! isset ( $this->{$name} )) {
            $this->{$name} = new Value ( $name, null );
        }
        return $this->{$name};
    }

    public function __set($name, $value) {
        $this->{$name} = new Value ( $name, $value );
    }

}

class Value extends Creator {
    private $name;
    private $value;
    function __construct($name, $value) {
        $this->name = $name;
        $this->value = $value;
    }

    function __toString()
    {
        return (string) $this->value ;
    }
} 
```

## 编辑：根据要求提供新的阵列支持

```
class Sample extends Creator {

}

$a = new Sample ();
$a->role = array (
        "A",
        "B",
        "C" 
);

$a->role[0]->nice = "OK" ;

print ($a->role[0]->nice  . PHP_EOL);

$a->role[1]->nice->ok = array("foo","bar","die");

print ($a->role[1]->nice->ok[2]  . PHP_EOL);

$a->role[2]->nice->raw = new stdClass();
$a->role[2]->nice->raw->name = "baba" ;

print ($a->role[2]->nice->raw->name. PHP_EOL); 
```

输出

```
 Ok die baba 
```

修改类

```
abstract class Creator {
    public function __get($name) {
        if (! isset ( $this->{$name} )) {
            $this->{$name} = new Value ( $name, null );
        }
        return $this->{$name};
    }

    public function __set($name, $value) {
        if (is_array ( $value )) {
            array_walk ( $value, function (&$item, $key) {
                $item = new Value ( $key, $item );
            } );
        }
        $this->{$name} = $value;

    }

}

class Value {
    private $name ;
    function __construct($name, $value) {
        $this->{$name} = $value;
        $this->name = $value ;
    }

    public function __get($name) {
        if (! isset ( $this->{$name} )) {
            $this->{$name} = new Value ( $name, null );
        }

        if ($name == $this->name) {
            return $this->value;
        }

        return $this->{$name};
    }

    public function __set($name, $value) {
        if (is_array ( $value )) {
            array_walk ( $value, function (&$item, $key) {
                $item = new Value ( $key, $item );
            } );
        }
        $this->{$name} = $value;
    }

    public function __toString() {
        return (string) $this->name ;
    }   
} 
```

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2012-05-04T19:29:33.353

我也遇到过同样的错误，如果没有您的整个代码，很难准确指出如何修复它，但这是由于没有 __set 函数造成的。

我过去解决它的方法是我做了这样的事情：

```
$user = createUser();
$role = $user->role;
$role->rolename = 'Test'; 
```

现在如果你这样做：

```
echo $user->role->rolename; 
```

你应该看到“测试”

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2013-11-01T15:23:54.817

虽然我在这个讨论中很晚，但我认为这可能对将来的某些人有用。

我曾经遇到过类似的情况。对于那些不介意取消设置和重置变量的人来说，最简单的解决方法就是这样做。我很确定从其他答案和 php.net 手册中可以清楚地看出这不起作用的原因。对我有用的最简单的解决方法是

假设：

1.  `$object`是重载的对象，`__get`来自`__set`基类，我没有修改的自由。
2.  `shippingData`是我要修改字段的数组，例如：-phone_number

```
// First store the array in a local variable.
$tempShippingData = $object->shippingData;

unset($object->shippingData);

$tempShippingData['phone_number'] = '888-666-0000' // what ever the value you want to set

$object->shippingData = $tempShippingData; // this will again call the __set and set the array variable

unset($tempShippingData); 
```

注意：此解决方案是解决问题并复制变量的快速解决方法之一。如果数组太庞大，最好强制重写该`__get`方法以返回一个引用，而不是昂贵的大数组复制。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2017-04-11T15:53:45.480

我收到了这样的通知：

```
$var = reset($myClass->my_magic_property); 
```

这修复了它：

```
$tmp = $myClass->my_magic_property;
$var = reset($tmp); 
```

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2019-05-30T12:03:14.260

我同意[VinnyD](https://stackoverflow.com/users/614787/vinnyd)的观点，即您需要在 __get 函数前添加“&”，以使其返回所需的结果作为参考：

```
public function &__get ( $propertyname ) 
```

但要注意两点：

1）你也应该这样做

```
return &$something; 
```

或者你可能仍然返回一个值而不是一个引用......

2) 请记住，在任何情况下 __get 返回一个引用，这也意味着相应的 __set 永远不会被调用；这是因为 php 通过使用由 __get 返回的引用来解决这个问题，而不是调用它！

所以：

```
$var = $object->NonExistentArrayProperty; 
```

意味着 __get 被调用，并且由于 __get 具有 &__get 并返回 &$something，$var 现在正如预期的那样是对重载属性的引用......

```
$object->NonExistentArrayProperty = array(); 
```

按预期工作，__set 按预期调用...

但：

```
$object->NonExistentArrayProperty[] = $value; 
```

或者

```
$object->NonExistentArrayProperty["index"] = $value; 
```

在重载数组属性中正确添加或修改元素的意义上，按预期工作，但 __set 不会被调用： __get 将被调用！

如果不使用 &__get 并返回 &$something，这两个调用将不起作用，但是虽然它们确实以这种方式工作，但它们从不调用 __set，而总是调用 __get。

这就是为什么我决定返回参考

```
return &$something; 
```

当 $something 是一个 array() 时，或者当重载的属性没有特殊的 setter 方法时，而是返回一个值

```
return $something; 
```

当 $something 不是数组或具有特殊的 setter 函数时。

无论如何，这对我来说很难正确理解！:)

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2013-06-11T10:28:02.467

我遇到了与 w00 相同的问题，但我没有自由重写发生此问题 (E_NOTICE) 的组件的基本功能。我已经能够使用[ArrayObject](http://php.net/manual/en/class.arrayobject.php%20PHP%3a%20The%20ArrayObject%20class)而不是基本类型[array()](http://www.php.net/manual/en/function.array.php%20PHP%3a%20array)来解决这个问题。这将返回一个对象，该对象将默认通过引用返回。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2012-05-04T19:42:54.293

这是由于 PHP 如何处理重载属性，因为它们不可修改或通过引用传递。

有关过载的更多信息，请参阅[手册](http://us.php.net/manual/en/language.oop5.overloading.php)。

要解决此问题，您可以使用`__set`函数或创建`createObject`方法。

下面是一个`__get`，`__set`它提供了一种解决方法来解决与您的情况类似的情况，您可以简单地修改它`__set`以满足您的需求。

请注意，`__get`从不实际返回变量。而是一旦你在你的对象中设置了一个变量，它就不再被重载。

```
/**
 * Get a variable in the event.
 *
 * @param  mixed  $key  Variable name.
 *
 * @return  mixed|null
 */
public function __get($key)
{
    throw new \LogicException(sprintf(
        "Call to undefined event property %s",
        $key
    ));
}

/**
 * Set a variable in the event.
 *
 * @param  string  $key  Name of variable
 *
 * @param  mixed  $value  Value to variable
 *
 * @return  boolean  True
 */
public function __set($key, $value)
{
    if (stripos($key, '_') === 0 && isset($this->$key)) {
        throw new \LogicException(sprintf(
            "%s is a read-only event property", 
            $key
        ));
    }
    $this->$key = $value;
    return true;
} 
```

这将允许：

```
$object = new obj();
$object->a = array();
$object->a[] = "b";
$object->v = new obj();
$object->v->a = "b"; 
```

# c# - 使用和 ODBC/MySql 的问题

> ID：10454781
> 
> 赞同：0
> 
> 时间：2012-05-04T19:10:43.220
> 
> 标签：c#, asp.net, mysql, odbc, connection-pooling

所以这是我尝试在 C# 中使用 using (for Connection Pooling) 的示例代码。现在我认为由于不在方法中，它给了我一个错误。但是，有没有办法解决这个问题？

```
<% @Page Language="C#" %>
<% @Import Namespace="System.Data.Odbc" %>
<% @Import Namespace="System.Web.Configuration" %>

<script language="C#" runat="server">
string conString = WebConfigurationManager.ConnectionStrings["cheese"].ConnectionString;
using (OdbcConnection con = new OdbcConnection(conString)) {
    con.Open();
    using (OdbcCommand com = new OdbcCommand("SELECT pies FROM ducks WHERE isapie = nope", con)) {
        com.Parameters.AddWithValue("@var", paramWord);
        using (OdbcDataReader reader = com.ExecuteReader()) {
            while (reader.Read()) {
                Response.Write(reader.GetString(0));
            }
        }
    }
    con.Close();
}
</script> 
```

现在给出错误的行是：

```
Line 8:     using (OdbcConnection con = new OdbcConnection(conString)) { 
```

有问题的错误是：

```
Compiler Error Message: CS1519: Invalid token 'using' in class, struct, or interface member declaration 
```

我试图使我的代码保持简约、易于编辑等，因此我想避免仅仅为了拥有它们而使用不必要的类、方法等。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-04T19:18:58.760

你有几个问题；第一个是您没有在方法中定义代码。为此，您需要将其放在 Page_Load 中，例如：

```
<script language="C#" runat="server">

void Page_Load(object sender,EventArgs e)
{
    string conString = WebConfigurationManager.ConnectionStrings["cheese"].ConnectionString;
    using (OdbcConnection con = new OdbcConnection(conString)) {
    con.Open();

    using (OdbcCommand com = new OdbcCommand("SELECT pies FROM ducks WHERE isapie = nope", con)) {
         com.Parameters.AddWithValue("@var", paramWord);
         using (OdbcDataReader reader = com.ExecuteReader()) {
          while (reader.Read()) 
             Response.Write(reader.GetString(0));
         }//end using reader
     }//end using ODBCCommand
  }//end using ODBCConnection
}//page_load
</script> 
```

第二个问题是你使用`using`打开连接而你尝试使用关闭下面的连接对象`}`。当您到达`using`实例化 OdbcCommand 的第二个时，连接已经被释放。你需要做这样的事情：

```
void Page_Load(object sender,EventArgs e)
{
string conString = WebConfigurationManager.ConnectionStrings["cheese"].ConnectionString;
using (OdbcConnection con = new OdbcConnection(conString)) {
    con.Open();

using (OdbcCommand com = new OdbcCommand("SELECT pies FROM ducks WHERE isapie = nope", con)) {
    com.Parameters.AddWithValue("@var", paramWord);
    using (OdbcDataReader reader = com.ExecuteReader()) {
        while (reader.Read()) {
            Response.Write(reader.GetString(0));
        }
    }
 }
 con.Close();
 }
} 
```

最后，您应该使用 gridview 或类似的东西来绑定这些数据，而不是`Response Stream`按照您的方式进行写入。假设您的页面中有一个 Gridview；你可以完美地做到这一点：

```
gridView.DataSource=com.ExecuteReader();
gridView.DataBind(); 
```

# java - 通过 Hibernate Search 将 Hibernate Criteria API 与 Lucene 结合起来？

> ID：10454787
> 
> 赞同：4
> 
> 时间：2012-05-04T19:11:25.413
> 
> 标签：java, hibernate, search, lucene, hibernate-search

如何将休眠条件 API 与 Lucene 休眠搜索结合起来？

```
org.hibernate.Criteria criteria = session.createCriteria(class);

criteria.add(Restrictions.ne(property, value));

FullTextQuery fullTextQuery = ftm.createFullTextQuery(booleanQuery, class);

fullTextQuery.setCriteriaQuery(criteria);

Object result = fullTextQuery.getResultList(); 
```

在上面的例子中，hibernate 不遵守限制吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-20T16:41:59.440

根据[文档](http://docs.jboss.org/hibernate/search/3.4/api/org/hibernate/search/FullTextQuery.html#setCriteriaQuery(org.hibernate.Criteria))，不能在 FullTextQuery 中设置的条件中定义限制。当您使用 BooleanQuery 时，您可以向它添加一个带有限制的子句。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-04T19:37:26.243

您没有使用错误的 Criteria 实例吗？您添加限制`criteria`，但`hibernateCriteria`在其他地方使用

# python - 从字符串中删除数字

> ID：10454788
> 
> 赞同：0
> 
> 时间：2012-05-04T19:11:27.580
> 
> 标签：python, algorithm, nlp

所以，我正在使用一个文本文件，我正在对字符串执行以下操作

```
 def string_operations(string):

        1) lowercase
        2) remove integers from string
        3) remove symbols
        4) stemming 
```

在此之后，我仍然留下如下字符串：

```
 durham 28x23 
```

我看到了我的方法中的缺陷，但想知道是否有一种好的、快速的方法来识别字符串是否附加了一个数值。

所以在上面的例子中，我希望输出是

```
 durham 
```

另一个例子：

```
 21st ammendment 
```

应该给：

```
ammendment 
```

那么我该如何处理这些东西呢？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-04T19:19:58.590

如果您的要求是“删除任何以数字开头的术语”，您可以执行以下操作：

```
def removeNumerics(s):
  return ' '.join([term for term in s.split() if not term[0].isdigit()]) 
```

这会在空格上拆分字符串，然后用空格连接所有不以数字开头的术语。

它的工作原理是这样的：

```
>>> removeNumerics('21st amendment')
'amendment'
>>> removeNumerics('durham 28x23')
'durham' 
```

如果这不是您要查找的内容，则可以在您的问题中显示一些明确的示例（显示初始字符串和您想要的结果）。

# android - 我可以在不使用线程和异步任务的情况下使用进度指示器吗？

> ID：10454790
> 
> 赞同：-3
> 
> 时间：2012-05-04T19:11:33.523
> 
> 标签：android

如果是，我们如何实现这一目标？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-04T22:29:19.517

从理论上讲，是的，你可以，但你不应该。因为进度指示器适用于相对长时间运行的任务，如果您尝试在 UI 线程上执行此操作，您的应用程序将因无响应而被强制关闭。

# internet-explorer - IE 9 + Silverlight 4 中的滚动条

> ID：10454791
> 
> 赞同：2
> 
> 时间：2012-05-04T19:11:37.930
> 
> 标签：internet-explorer, silverlight-4.0, internet-explorer-9

如果我使用 Visual Studio 中的所有默认设置创建一个新的 Silverlight 应用程序并运行该应用程序，我会看到图像中显示的混乱。这在 Chrome 中不会发生。我相信它只在 IE9 而不是 IE8 中。

其他人可以复制或解释吗？

![滚动条错误](../Images/cf6938d73c5598d3caa8950ece078dd6.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-19T14:14:48.377

尝试切换兼容性视图。

# java - 数据表中的 JSF 2.0 commandLink

> ID：10454800
> 
> 赞同：2
> 
> 时间：2012-05-04T19:12:30.133
> 
> 标签：java, jsf-2

我在数据表中遇到 JSF commandLink 问题。我无法让它工作。

我的 bean 在请求范围内，我的操作类也在请求范围内。这是我的数据表：

```
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
        "http://www.w3.org/TR/html4/loose.dtd">
<HTML xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="http://java.sun.com/jsf/html"
      xmlns:f="http://java.sun.com/jsf/core"
      xmlns:ui="http://java.sun.com/jsf/facelets">
<f:view contentType="text/html">
    <ui:include src="../blocks/head.xhtml"/>

    <body>
    <ui:include src="../blocks/header.xhtml"/>

    <div class="content_table" align="center">

        <h:dataTable headerClass="data_table_header"
                     cellpadding="10"
                     rowClasses="dataTableRow1,dataTableRow2"
                     value="#{searchBean.searchResult.corpusInfos}"
                     var="corpusInfo">

            <h:column>
                <f:facet name="header">
                    #{msg['application.corpusInfoTable.corpusPart']}
                </f:facet>
                #{corpusInfo.corpusPart}
            </h:column>

            <h:column>
                <f:facet name="header">
                    #{msg['application.corpusInfoTable.totalWords']}
                </f:facet>
                #{corpusInfo.allWordsCount}
            </h:column>

            <h:column>
                <f:facet name="header">
                    #{msg['application.corpusInfoTable.request']}
                </f:facet>

                <h:form id="idSimpleSearchForm">
                    <h:commandLink id="idSimpleSearchFromTable" action="#{searchAction.processSearch}"
                                   value="#{corpusInfo.searchTerm}">
                        <f:setPropertyActionListener value="50" target="#{searchBean.lineLength}"/>
                        <f:setPropertyActionListener value="simpleSearch" target="#{searchBean.searchType}"/>
                        <f:ajax execute="@form"/>
                    </h:commandLink>
                </h:form>

            </h:column>

            <h:column>
                <f:facet name="header">
                    #{msg['application.corpusInfoTable.usageNumber']}
                </f:facet>
                #{corpusInfo.usageCount}
            </h:column>

            <h:column>
                <f:facet name="header">
                    #{msg['application.corpusInfoTable.analyzedSourcesCount']}
                </f:facet>
                #{corpusInfo.analyzedSourcesCount}
            </h:column>

        </h:dataTable>

    </div>

    <ui:include src="../blocks/footer.xhtml"/>
    </body>
</f:view>
</HTML> 
```

我试图将操作类和 bean 的范围更改为会话或视图。没有成功。当我单击生成的链接时，页面会刷新。

该表是根据我之前的请求生成的。第一个页面包含一些字段和操作按钮，当点击操作按钮时，到达操作类所需的数据设置为 bean 类并传递到该数据表所在的以下 xhtml 页面。我以正确的顺序查看表中的所有值，除了操作链接之外一切正常。

关于如何解决这个问题的任何想法？

编辑：

我把数据表所在的所有页面都放在了里面。也许其他标签有问题？也许他们改变了看法？这个页面的导航写在 faces-config.xml 文件中，如下所示：

```
<navigation-rule>
    <navigation-case>
        <from-action>#{searchAction.processSearch}</from-action>
        <from-outcome>success_simple_search</from-outcome>
        <to-view-id>/views/concordance/concordance.xhtml</to-view-id>
    </navigation-case>

    <navigation-case>
        <from-action>#{searchAction.processSearch}</from-action>
        <from-outcome>failure</from-outcome>
        <to-view-id>/views/error/unexpectedError.xhtml</to-view-id>
    </navigation-case>
</navigation-rule> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-04T19:21:02.573

如果`#{searchBean.searchResult.corpusInfos}`在处理表单提交期间返回的列表与显示带有表单的页面期间不同，则可能会发生这种情况。

您需要将 放在`#{searchBean}`视图范围内以确保列表保留在视图中。

```
@ManagedBean
@ViewScoped
public class SearchBean {} 
```

您需要确保您没有在 and 的 getter 方法中执行任何业务`#{searchBean.searchResult}`逻辑`#{searchBean.searchResult.corpusInfos}`。所以他们应该看起来像这样

```
public SearchResult getSearchResult() {
    return searchResult;
} 
```

和

```
public List<CorpusInfo> getCorpusInfos() {
    return corpusInfos;
} 
```

如果您需要根据初始请求或操作预加载/预填充它们，则需要在 (post) 构造函数或 action(listener) 方法中执行业务工作。

### 也可以看看

*   [未调用 commandButton/commandLink/ajax 操作/侦听器方法或未更新输入值](https://stackoverflow.com/questions/2118656/hcommandlink-hcommandbutton-is-not-being-invoked)

# r - ggplot 2 r上与x轴成比例的不同尺寸方面

> ID：10454805
> 
> 赞同：42
> 
> 时间：2012-05-04T19:12:47.240
> 
> 标签：r, ggplot2, facet

以下是一种情况：

```
group1 <- seq(1, 10, 2)
group2 <-  seq(1, 20, 3)
x = c(group1, group2)
mydf <- data.frame (X =x , Y = rnorm (length (x),5,1), 
 groups = c(rep(1, length (group1)), rep(2, length(group2))))

ggplot(mydf, aes(X, Y, group= groups)) + geom_point()+ facet_grid (.~ group) 
```

在下图中，不同的方面按 x 限制进行缩放：

```
 ggplot(mydf, aes(X, Y, group= groups)) + geom_point()+ 
   facet_grid (.~ group, scales = "free_x") 
```

由于 x 的总宽度有意义，我想产生不同宽度的刻面，而不仅仅是不同的比例。因此，预期的 facet 1 的宽度应该是 2 的一半。

![在此处输入图像描述](../Images/2a34f634c329228d30c152dc7cf15f5f.png)

* * *

## 回答 #1

> 赞同：63
> 
> 时间：2012-05-04T20:02:03.757

如果我对您的理解正确， `space = "free_x"`请在`facet_grid`. 据我所知，`facet_wrap`从未支持空格参数，但许多`facet_wrap`命令可以转换为`facet_grid`命令。

```
library(ggplot2)

ggplot(mydf, aes(X, Y)) + geom_point()+ 
facet_grid (.~ groups, scales = "free_x", space = "free_x") 
```

![在此处输入图像描述](../Images/03afd4d483fa6688440fd93ab8a290af.png)

如果您想在 x 轴上使用相同样式的标签：

```
ggplot(mydf, aes(X, Y)) + geom_point()+ 
 scale_x_continuous(breaks = seq(0,20,2)) +
 facet_grid (.~ groups, scales = "free_x", space = "free_x") 
```

![在此处输入图像描述](../Images/bdaf2dd6777e6a62e37a36ce57ba6972.png)

# asp.net - gridview 循环问题

> ID：10454813
> 
> 赞同：0
> 
> 时间：2012-05-04T19:13:08.003
> 
> 标签：asp.net, vb.net, gridview, row, templatefield

我有一个 4 列的 gridview，其中三个是模板字段，用户可以在其中输入所需的信息，然后单击按钮将其提交到数据库。我有两个问题：

1.  当我单击按钮添加第二行时……第一行帖子中的数据
    消失了。我希望能够添加该行，而不会因多条记录输入情况而第一行信息消失。我的代码如下：

    ```
    Private Sub SetInitialRow()
        Dim dts As New DataTable()
        Dim drs As DataRow = Nothing
        dts.Columns.Add(New DataColumn("Approval Date", GetType(String)))
        dts.Columns.Add(New DataColumn("Total Amount", GetType(String)))
        dts.Columns.Add(New DataColumn("Comments", GetType(String)))
        dts.Columns.Add(New DataColumn("Initials", GetType(String)))
        drs = dts.NewRow()
        drs("Approval Date") = String.Empty
        drs("Total Amount") = String.Empty
        drs("Comments") = String.Empty
        drs("Initials") = String.Empty
        dts.Rows.Add(drs)
        ViewState("CurrentTable") = dts
        gvOLIAdj.DataSource = dts
        gvOLIAdj.DataBind()
    End Sub

    Private Sub AddNewRowToGrid()
        Dim rowIndex As Integer = 0
        If ViewState("CurrentTable") IsNot Nothing Then
            Dim dtCurrentTable As DataTable = DirectCast(ViewState("CurrentTable"), DataTable)
            Dim drCurrentRow As DataRow = Nothing
            If dtCurrentTable.Rows.Count > 0 Then
                For i As Integer = 1 To dtCurrentTable.Rows.Count
                    'extract the TextBox values
                    Dim box1 As TextBox = DirectCast(gvOLIAdj.Rows(rowIndex).Cells(1).FindControl("txtAdjAppr"), TextBox)
                    Dim box2 As TextBox = DirectCast(gvOLIAdj.Rows(rowIndex).Cells(2).FindControl("txtAdjAmt"), TextBox)
                    Dim box3 As TextBox = DirectCast(gvOLIAdj.Rows(rowIndex).Cells(3).FindControl("txtCmmts"), TextBox)
                    drCurrentRow = dtCurrentTable.NewRow()
                    drCurrentRow("Approval Date") = box1.Text
                    dtCurrentTable.Rows(i - 1)("Total Amount") = box2.Text
                    dtCurrentTable.Rows(i - 1)("Comments") = box3.Text
                    'dtCurrentTable.Rows(i - 1)("Initials") = 
                    rowIndex += 1
                Next
                dtCurrentTable.Rows.Add(drCurrentRow)
                ViewState("CurrentTable") = dtCurrentTable
                gvOLIAdj.DataSource = dtCurrentTable
                gvOLIAdj.DataBind()
            End If
        Else
            Response.Write("ViewState is null")
        End If
        'Set Previous Data on Postbacks
        SetPreviousData()
    End Sub

    Private Sub SetPreviousData()
        Dim rowIndex As Integer = 0
        If ViewState("CurrentTable") IsNot Nothing Then
            Dim dats As DataTable = DirectCast(ViewState("CurrentTable"), DataTable)
            If dats.Rows.Count > 0 Then
                For i As Integer = 0 To dats.Rows.Count - 1
                    Dim box1 As TextBox = DirectCast(gvOLIAdj.Rows(rowIndex).Cells(1).FindControl("txtAdjAppr"), TextBox)
                    Dim box2 As TextBox = DirectCast(gvOLIAdj.Rows(rowIndex).Cells(2).FindControl("txtAdjAmt"), TextBox)
                    Dim box3 As TextBox = DirectCast(gvOLIAdj.Rows(rowIndex).Cells(3).FindControl("txtCmmts"), TextBox)
                    box1.Text = dats.Rows(i)("Approval Date").ToString()
                    box2.Text = dats.Rows(i)("Total Amount").ToString()
                    box3.Text = dats.Rows(i)("Comments").ToString()
                    rowIndex += 1
                Next
            End If
        End If
    End Sub

    Protected Sub btnAddNewRow_Click(sender As Object, e As EventArgs) Handles btnAddNewRow.Click
        AddNewRowToGrid()

    End Sub 
    ```

2.  当我尝试编写一个循环来遍历每个模板字段以获取数据并将其放入我的数据库时，它无法识别我在模板字段中有数据？这是我迄今为止尝试过的无济于事......

    ```
    Protected Sub btn_Update_Click(sender As Object, e As EventArgs) Handles btn_Update.Click
        For Each row As GridViewRow In gvOLIAdj.Rows
            For Each gv As GridViewRow In gvOLIAdj.Rows
                Dim appDt As String = (Rows(rowIndex).Cells(1).FindControl("txtAdjAppr")), TextBox)
                Dim approvalDt As String = CType(gv.FindControl("txtAdjAppr"), TextBox).Text
                Dim totalAmt As String = CType(gv.FindControl("txtAdjAmt"), TextBox).Text
                Dim comments As String = CType(gv.FindControl("txtcmmts"), TextBox).Text
                Dim intitials As String = DirectCast(gv.FindControl("total"), TextBox).Text
        Next

    End Sub 
    ```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-06-04T02:34:28.683

在您的 AddNewRowToGrid 方法中，您正在执行以下操作：

```
 dtCurrentTable.Rows(i - 1)("Total Amount") = box2.Text
            dtCurrentTable.Rows(i - 1)("Comments") = box3.Text 
```

这里的问题是更新 dtCurrentTable.Rows( **i - 1** ) 中的行。您正在更新要更新的值上方的行中的值。

# ios - Facebook SDK didLoad:result = null

> ID：10454819
> 
> 赞同：1
> 
> 时间：2012-05-04T19:13:31.250
> 
> 标签：ios, xcode, cocoa-touch, facebook-graph-api

我有一个 Facebook 单身人士并要求获取个人资料图片：

```
[[[FacebookScorer sharedInstance] facebook] requestWithGraphPath:@"me/picture?type=normal" andDelegate:self]; 
```

现在在 facebooks 委托方法 didLoadRawResponce 我实际上收到了个人资料图片并可以显示，但在 didLoad:(id)result 方法中结果为空！

我相信一旦解析了结果就会调用 didLoad 方法，那么为什么我没有从中得到任何回报呢？

我需要使用didLoad的原因是我可以问它是否结果是KindOfClass以查看它是什么，而我注销时也会调用didLoadRawResponce，那么我该如何检查数据是什么？

--Edit 我已经弄清楚如何区分 FBRequests，所以这不再是一个大问题，但是我仍然不明白为什么调用 didLoad 但没有任何结果。即使使用它也会触发 slog，但使用 null

```
if (request == _profilePicRequest) {
    NSLog(@"result:%@",result);
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-10T06:41:36.600

这可以通过从请求中获取数据来解决：

```
- (void)request:(FBRequest *)request didLoad:(id)result{
result = request.responseText;

if ([result isKindOfClass:[NSData class]])
{   
    ...
}

if ([result isKindOfClass:[NSDictionary class]])
{
    ...
} 
```

不是最优雅的解决方案，我仍然不知道为什么结果为零。但它有效。

希望这可以帮助！

# google-apps-script - 如何在谷歌电子表格中引用现有图表

> ID：10454820
> 
> 赞同：1
> 
> 时间：2012-05-04T19:13:39.700
> 
> 标签：google-apps-script

输入新数据时，我想更改电子表格中现有的谷歌图表。我有一个运行良好的 onEdit 函数，但我无法弄清楚如何获取指向电子表格中现有图表对象的“指针”。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-10T22:11:46.280

请参阅[以编程方式管理电子表格中的图表](http://googleappsdeveloper.blogspot.fr/2012/06/programmatically-managing-charts-in.html)：

此外，[其他 Google I/O 公告](http://googleappsdeveloper.blogspot.fr/2012/06/big-updates-for-apps-script.html)可能会引起您的兴趣

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-06T14:40:13.803

我讨厌不得不说出坏消息。但这是不可能的。根本没有 API 可以处理电子表格中的图表。

如果这在您的用例中不是问题。[您可以使用Google 图表工具](https://google-developers.appspot.com/chart/interactive/docs/index)从脚本自动生成图表图像/网址，然后将其插入电子表格。

# c - 在 c 中给出意外输出的代码

> ID：10454824
> 
> 赞同：2
> 
> 时间：2012-05-04T19:14:11.053
> 
> 标签：c

以下代码片段在 Turbo C++ 编译器中给出了意外的输出：

```
 char a[]={'a','b','c'};
     printf("%s",a); 
```

为什么不打印这个`abc`？在我的理解中，字符串在 C 中被实现为一维字符数组。其次，和
之间有什么区别？`%s``%2s`

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-04T19:15:39.657

这是因为您的字符串不是以零结尾的。这将起作用：

```
char a[]={'a','b','c', '\0'}; 
```

指定打印输出的`%2s`最小宽度。由于您正在打印 3 个字符的字符串，因此将被忽略。但是，如果您使用`%5s`，您的字符串将在左侧填充两个空格。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-04T19:15:43.297

```
char a[]={'a','b','c'}; 
```

一个问题是字符串需要以空值结尾：

```
char a[]={'a','b','c', 0}; 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-05-04T21:14:23.890

在不更改原始字符数组的情况下，您也可以使用

```
 char a[]={'a','b','c'};
     printf("%.3s",a);
or
     char a[]={'a','b','c'};
     printf("%.*s",sizeof(a),a);
or
     char a[]={'a','b','c'};
     fwrite(a,3,1,stdout);
or
     char a[]={'a','b','c'};
     fwrite(a,sizeof(a),1,stdout); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-05-04T19:20:23.210

因为你没有使用字符串。要被视为字符串，您需要“空终止”：“\0”或 0（是的，不带引号）。

您可以通过两种形式的初始化来实现这一点：

```
char a[] = {'a', 'b', 'c', '\0'}; 
```

或使用您身边的编译器：

```
char a[] = "abc"; 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2016-08-01T11:36:23.730

每当我们在 c 编程中存储一个字符串时，我们总是在末尾有一个额外的字符来标识字符串的结尾。

使用的额外字符是`null`字符`'\0'`。在您的上述程序中，您缺少空字符。

您可以将您的字符串定义为

```
char a[] = "abc"; 
```

得到想要的结果。

# java - 需要在matches() 中转义java 正则表达式吗？

> ID：10454827
> 
> 赞同：1
> 
> 时间：2012-05-04T19:14:29.593
> 
> 标签：java

我目前正在对 HTTP Origin 进行测试，以确定它是否来自 SSL：

```
(HttpHeaders.Names.ORIGIN).matches("/^https:\\/\\//") 
```

但我发现它不起作用。我需要`matches()`像正则表达式一样转义字符串还是可以保留它`https://`？有没有办法做一个简单的字符串匹配？

[似乎这将是一个简单的问题，但令人惊讶的是，即使在使用 RegEx 测试器http://www.regexplanet.com/advanced/java/index.html](http://www.regexplanet.com/advanced/java/index.html)之后，我也没有得到任何结果。谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-04T19:17:33.650

Java 的正则表达式不需要分隔符。只需这样做：

```
.matches("https://.*") 
```

请注意，matches 验证整个输入字符串，因此`.*`在末尾。`.`如果输入包含换行符（*不*匹配），请启用 DOT-ALL：

```
.matches("(?s)https://.*") 
```

当然，您也可以简单地执行以下操作：

```
.startsWith("https://") 
```

它采用纯字符串（无正则表达式模式）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-04T19:21:57.220

这个正则表达式怎么样：

```
"^(https:)\/\/.*" 
```

它适用于您的测试仪

# calendar - 如何配置 Nutch 避免爬取胡说八道的日历网页

> ID：10454829
> 
> 赞同：0
> 
> 时间：2012-05-04T19:14:41.540
> 
> 标签：calendar, nutch

我正在使用 Nutch 来索引一个网站。我注意到 Nutch 抓取了一些垃圾网页，例如 http:// ***** ** *** **** /category/events/2015-11。这个网页是关于2015年发生的事件，11。这对我来说完全是胡说八道。我想知道 Nutch 是否可以智能地跳过此类网页。有人可能会说我可以使用正则表达式来避免这种情况。但是，由于日历网页的命名模式一直不尽相同，因此无法为此编写完美的Regex。我知道 Heritrix（一个互联网档案爬虫）有这样的能力来避免爬取无意义的日历网页。有没有人解决这个问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-06T01:23:17.870

除了正则表达式 url 过滤之外，没有其他方法可以做到这一点。每当您看到不需要的页面通过爬网内容时，您都可以继续向正则表达式文件添加新模式。

# html - 是否可以在选项元素中嵌套任何 DOM 元素？

> ID：10454831
> 
> 赞同：2
> 
> 时间：2012-05-04T19:14:48.733
> 
> 标签：html

我意识到嵌套在选项元素中（除了`optgroup`）是违反 w3c 标准的。但是，是否有*任何*元素不违反此标准？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-04T19:15:59.267

不，它的[内容模型](http://www.w3.org/TR/html5/dom.html#content-models)是[text](http://www.w3.org/TR/html5/dom.html#text-content)。

[http://www.w3.org/TR/html5/forms.html#the-option-element](http://www.w3.org/TR/html5/forms.html#the-option-element)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-05T04:38:00.590

根据 HTML 语法规则，您不能将任何元素嵌套在`option`. （你可以嵌套`option`在里面`optgroup`，但这是一个不同的问题。）

浏览器强制执行此操作：它们丢弃`option`. 您可以通过`<option>foo <em>bar</em></option>`使用 Firebug 进行测试和查看文档来了解这一点。

但是，*可以*`option`使用脚本在元素内插入 DOM 元素，例如

```
<option id=foo>
...
<script>
  document.getElementById('foo').innerHTML = 'Hello <em>world</em>';
</script> 
```

`option`这并不是特别有用，因为浏览器对元素内容的样式施加了严格的限制。`em`在我测试的浏览器中，只有 Firefox以通常的方式（斜体）在此上下文中呈现元素，`em`并让我在 CSS 中设置它的颜色和背景。

而且，当然，以违反 HTML 规则的方式使用 DOM 是有风险的。

# ssh - Github 部署密钥、子模块、ssh

> ID：10454833
> 
> 赞同：1
> 
> 时间：2012-05-04T19:14:57.443
> 
> 标签：ssh, github

如果我想使用其部署密钥系统访问私有 github 存储库。我是否需要主 git repo 及其所有子模块或仅父模块的 ssh 密钥对？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-04T23:22:17.903

您需要父模块和每个子模块的 SSH 密钥对（如果它们是私有的，或者如果您想在这些子模块中进行新的提交）。
参见例如“[宝塔盒子](http://help.pagodabox.com/customer/portal/articles/221647)”：

> ### 私有子模块回购
> 
> 如果您的子模块位于私有仓库中，您需要授予 Pagoda Box 访问权限以从该仓库中提取。您可以通过将 Pagoda Box 的公共 SSH 密钥添加到 repo 来实现。
> 如果它是 GitHub 存储库，您可以通过简单地添加“pagodabox”作为协作者来完成同样的事情。

# ruby-on-rails-3 - “413 请求实体太大”错误 Rails 3.2 乘客 Phusion

> ID：10454850
> 
> 赞同：18
> 
> 时间：2012-05-04T19:16:13.200
> 
> 标签：ruby-on-rails-3, nginx, passenger

我有一个使用 Rails 3.2.3、Ruby 1.9.3 和带有 Nginx 模块的 Phusion Passenger 的 rails 应用程序。应用用户需要上传大文件。我将指令添加`client_max_body_size 500M;`到 nginx.conf（如下）中的位置块，并通过使用 Ctrl-C 停止和重新启动 nginx 来停止和`passenger start`启动 nginx。但是，当我尝试上传 127 mb 的文件时，我收到错误“413 Request Entity Too Large”。有人可以让我知道我忽略了什么吗？

谢谢，

## 我的 nginx.conf

```
#user  nobody;
worker_processes  1;

#error_log  logs/error.log;
#error_log  logs/error.log  notice;
#error_log  logs/error.log  info;

pid        logs/nginx.pid;

events {
    worker_connections  1024;
}

http {
    passenger_root /Users/mcmahling/.rvm/gems/ruby-1.9.3-p125/gems/passenger-3.0.12;
    passenger_ruby /Users/mcmahling/.rvm/wrappers/ruby-1.9.3-p125/ruby;
    include       mime.types;
    default_type  application/octet-stream;

    #log_format  main  '$remote_addr - $remote_user [$time_local] "$request" '
    #                  '$status $body_bytes_sent "$http_referer" '
    #                  '"$http_user_agent" "$http_x_forwarded_for"';

    #access_log  logs/access.log  main;

    sendfile        on;
    #tcp_nopush     on;

    #keepalive_timeout  0;
    keepalive_timeout  165;

    #gzip  on;

    server {
        listen       80;
        server_name  localhost;
        client_max_body_size       4G;

        #charset koi8-r;

        #access_log  logs/host.access.log  main;

        location / {
             root   html;
             index  index.html index.htm;
             client_max_body_size       4G;
                       client_body_buffer_size    128k;
             client_body_temp_path      /usr/local/nginx/client_body_temp;
        }

        #error_page  404              /404.html;

        # redirect server error pages to the static page /50x.html
        #
        error_page   500 502 503 504  /50x.html;
        location = /50x.html {
            root   html;
        }

        # proxy the PHP scripts to Apache listening on 127.0.0.1:80
        #
        #location ~ \.php$ {
        #    proxy_pass   http://127.0.0.1;
        #}

        # pass the PHP scripts to FastCGI server listening on 127.0.0.1:9000
        #
        #location ~ \.php$ {
        #    root           html;
        #    fastcgi_pass   127.0.0.1:9000;
        #    fastcgi_index  index.php;
        #    fastcgi_param  SCRIPT_FILENAME  /scripts$fastcgi_script_name;
        #    include        fastcgi_params;
        #}

        # deny access to .htaccess files, if Apache's document root
        # concurs with nginx's one
        #
        #location ~ /\.ht {
        #    deny  all;
        #}
    }

    # another virtual host using mix of IP-, name-, and port-based configuration
    #
    #server {
    #    listen       8000;
    #    listen       somename:8080;
    #    server_name  somename  alias  another.alias;

    #    location / {
    #        root   html;
    #        index  index.html index.htm;
    #    }
    #}

    # HTTPS server
    #
    #server {
    #    listen       443;
    #    server_name  localhost;

    #    ssl                  on;
    #    ssl_certificate      cert.pem;
    #    ssl_certificate_key  cert.key;

    #    ssl_session_timeout  5m;

    #    ssl_protocols  SSLv2 SSLv3 TLSv1;
    #    ssl_ciphers  HIGH:!aNULL:!MD5;
    #    ssl_prefer_server_ciphers   on;

    #    location / {
    #        root   html;
    #        index  index.html index.htm;
    #    }
    #}

} 
```

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2012-05-05T01:24:55.143

更改`client_max_body_size 4G;`或`4g;`插入`500m;`服务器块

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-05-14T17:17:28.357

从[Nginx 错误 413](https://stackoverflow.com/questions/4365821/nginx-error-413)和[http://forum.slicehost.com/index.php?p=/discussion/1714/nginx-413-when-uploading-file-1mb-or-larger/p1](http://forum.slicehost.com/index.php?p=/discussion/1714/nginx-413-when-uploading-file-1mb-or-larger/p1)来看，您可能会尝试`client_max_body_size`指定只是一次，可能只在服务器部分，虽然这看起来很可疑。

另外，正如另一个回复中提到的，我认为您希望将“4g”作为值。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-11T16:32:42.453

这只是一个疯狂的猜测，由于我既不了解 Rails、Ruby 也不了解 nginx，因此我无法确定我的想法是否适用，但无论如何，这就是它，也许它会有所帮助......

您是否检查过文件是通过什么方式传输的？您的问题让我想起了我的 Ajax 请求神秘地失败的情况。经过一番研究，我发现了所有通过 GET 发送的请求（这首先是错误的方法）。然后将其更改为 POST 解决了我的问题。

由于您在那里发送文件，这可能是完全不同的事情（我有大约 2KiB 大小的数据）。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2016-07-28T19:44:39.203

client_max_body_size 10m；为我工作，带有';' 在and处，重启Nginx和Unicorn，或者apache...等

就像@MaffooClock 所说，在 http 块内。

# jruby - Jruby/Vert.x，设置问题

> ID：10454851
> 
> 赞同：1
> 
> 时间：2012-05-04T19:16:13.023
> 
> 标签：jruby, jrubyonrails, vert.x

我最近才了解 Vert.x 并想尝试一下，但我遇到了一些问题。

我可以用 javascript 编写服务器，但无法运行 ruby​​ (jruby) 版本。

> 2012 年 5 月 4 日下午 1:50:57 org.vertx.java.core.logging.impl.JULLogDelegate 错误严重：回溯是 /home/curtis/.rvm/rubies/jruby-1.6.6/lib/ruby/site_ruby/ 1.8/rubygems/custom_require.rb:36:in `require' /home/curtis/.rvm/gems/ruby-1.9.3-p125/gems/json-1.6.6/lib/json/ext.rb:13:in` Ext' /home/curtis/.rvm/gems/ruby-1.9.3-p125/gems/json-1.6.6/lib/json/ext.rb:12:in `JSON' /home/curtis/.rvm/gems/ruby-1.9.3-p125/gems/json-1.6.6/lib/json/ext.rb:9:in` (根)' /home/curtis/.rvm/gems/ruby-1.9.3-p125/gems/json-1.6.6/lib/json/ext.rb:36:in `require' /home/curtis/.rvm/gems/ruby-1.9.3-p125/gems/json-1.6.6/lib/json.rb:58:in` JSON' /home/curtis/.rvm /gems/ruby-1.9.3-p125/gems/json-1.6.6/lib/json.rb:54:in `(root)' /home/curtis/.rvm/gems/ruby-1.9.3-p125/gems/json-1.6.6/lib/json.rb:59:in` 要求'/home/curtis/src-files/vert.x-1.0.beta11/bin/。 ./lib/ruby/core/event_bus.rb:16:in `(root)' /home/curtis/src-files/vert.x-1.0.beta11/bin/../lib/ruby/core/event_bus.rb:26:in` (root)' /home/curtis/src-files/vert.x-1.0.beta11/bin/../lib/ruby/vertx.rb:1 ：在`（根）'

当我尝试简单地运行位于`vert.x-1.0.beta11/examples/ruby/webapp`目录中的 webapp 示例时，就会发生这种情况。我确实安装了 Jruby（通过 rvm）

> $ jruby-1.6.6 -v jruby 1.6.6 (ruby-1.8.7-p357) (2012-01-30 5673572) (OpenJDK Client VM 1.7.0_147-icedtea) [linux-i386-java]

我还安装了推荐的 JDK/JRE 版本。使用正确的路径

**.bashrc（底部）**

> PATH=$PATH$HOME/.rvm/bin:$HOME/src-files/vert.x-1.0.beta11/bin:/usr/lib/jvm/java-1.7.0-openjdk-i386

我遇到了一堵砖墙，错误消息要么没有太大帮助，要么让我相信 vert.x 或 jruby 中只是存在一个错误。

请指教？

> JRUBY_HOME=$HOME/.rvm/rubies/jruby-1.6.6

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-13T18:04:32.753

[确保您已安装 json gem，这是运行vert.x 网站](http://vertx.io/install.html "vert.x 网站")上所述的 ruby​​ 版本的先决条件。由于您使用的是 rvm，因此您可以切换到 jruby，`rvm use [jruby-version]`如果您还没有尝试搜索 json gem，如下所示。

`gem search json`

发出上述命令时的结果是什么。如果您没有得到任何响应，您可以使用以下命令将其安装到您的 jruby 中，

`jruby -S gem install json`

如果你想构建 ruby​​ API 文档，你还应该安装 yard gem。希望这可以帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-05T15:00:58.853

.bashrc 中的`PATH`行与您在此处写的一样吗？`$PATH`如果是这样，您需要在和之间添加一个斜线`$HOME`。另外，我认为 rvm 喜欢将 rvm 采购线作为 .bashrc 中的最后一件事，如下所示：

```
# RVM -- don't put anything after this.
[[ -s "$HOME/.rvm/scripts/rvm" ]] && source "$HOME/.rvm/scripts/rvm"

PATH=$PATH:$HOME/.rvm/bin # Add RVM to PATH for scripting 
```

# ruby - 在 Ruby 1.9 中复制对象和子对象

> ID：10454852
> 
> 赞同：1
> 
> 时间：2012-05-04T19:16:16.290
> 
> 标签：ruby

我的应用程序中有一个`KillerSudoku`类。

每个实例都有许多单元格`@cells`，许多区域`@zones`等等。

有没有办法轻松复制一个对象（数独）复制它的所有“子对象”，也就是说，我希望我的副本具有可以修改的单元格和区域，而无需修改以前的数独？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-04T19:47:03.147

假设所有部分都是可[序列化的，`Marshal`](http://www.ruby-doc.org/core-1.9.3/Marshal.html#method-c-dump)并且您想要一个完全深度的克隆：

```
class Object
  # This doesn't have to be on Object; it could be on KillerSudoku instead
  def deep_clone
    Marshal.load(Marshal.dump(self))
  end
end 
```

在行动中看到：

```
class KillerSudoku
  attr_accessor :cells
end

ks1 = KillerSudoku.new
ks1.cells = ["one",2,3]

ks2 = ks1.deep_clone
ks2.cells.pop
ks2.cells.first.reverse!

p ks1.cells, ks2.cells
#=> ["one", 2, 3]
#=> ["eno", 2]           # New array with all instance values being uniq, too 
```

从文档中，如果您的结构中有以下任何内容，则上述内容将不起作用：

*   匿名`Class`或`Module`.

*   与系统相关的对象（例如`Dir`, `File::Stat`, `IO`, `File`, `Socket`, 等）

*   `MatchData`, `Data`, `Method`, `UnboundMethod`, `Proc`, `Thread`, `ThreadGroup`,的一个实例`Continuation`

*   定义单例方法的对象

* * *

如上所示，这是一个真正的深度克隆，甚至字符串也成为新的实例。如果您希望克隆单元格和区域的数组，但所有值仍引用相同的对象，那么您希望通过使用自定义内容`dup`和操作：`clone``initialize_copy`

```
class KillerSudoku
  attr_accessor :cells
  def initialize_copy(old)
    self.cells = old.cells.dup
  end
end 
```

在行动中看到：

```
ks1 = KillerSudoku.new
ks1.cells = ["one",2,3]

ks2 = ks1.clone
ks2.cells.pop
ks2.cells.first.reverse!

p ks1.cells, ks2.cells
#=> ["eno", 2, 3]
#=> ["eno", 2]           # New array that references all the same objects 
```

# c++ - 在基派生（子）类对象中获取基类指针（父）？

> ID：10454860
> 
> 赞同：-1
> 
> 时间：2012-05-04T19:17:30.770
> 
> 标签：c++

所以我有这个类（父类），它创建一个对话框并用控件填充它。在该类中是另一个类（子类），它创建一个计时器，该计时器将函数调用链接/传递到事件系统，以定期更新某些控件的内容。问题来自需要知道它需要更新的对象的计时器更新功能。

我想简单地将基类的指针以某种方式传递给子类，使其完全独立。但我想不出一种方法来实现这一点。有人有想法么？

我已经搜索了答案，但我得到的只是从子类中访问基类中的变量。这会起作用，但似乎没有必要为每个单独的控件触发一个事件......（我想我可以在一个结构中创建所有控件，但这似乎没有必要）

嵌套类看起来有点像这样：

```
class CreateDialog{
    class timer{
    }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-04T19:23:31.977

您可以尝试在父类中声明一个静态成员变量，并将其设置为父类的构造函数中的父指针。

# c++ - 如何在 Eclipse 中为 C 编写 C++ 包装器？

> ID：10454866
> 
> 赞同：0
> 
> 时间：2012-05-04T19:17:55.017
> 
> 标签：c++, c, eclipse, wrapper

我已将 libstdc++ 添加到链接器选项中，但我不断获得对我想在 C 中使用的所有 C++ 函数的“未定义引用”。

我认为问题在于有问题的文件不是使用 g++ 编译的，但是如何在 Eclipse 中定义这个规则？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-04T20:53:50.623

要使 C++ 函数可从 C++ 调用，您必须 - 至少 - 使用“extern C {}”：

*   [http://www.parashift.com/c++-faq-lite/mixing-c-and-cpp.html](http://www.parashift.com/c++-faq-lite/mixing-c-and-cpp.html)

您不能从 C 程序中调用任何仅 C++ 的构造（如 new、delete、任何类或任何模板）——您的 C 模块不会编译和/或不会链接。

您*应该*能够使用 Eclipse 和/或从 g++ 命令行编译具有 .c 后缀的合法 C 模块。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-04T20:35:43.423

使用 g++ 编译的一种方法是，在项目资源管理器中选择 C ​​文件，选择 C/C++ 构建、设置，然后在命令字段中输入 g++。可能有一些更清洁的方法，但它应该工作......

# python - 在python中捕获错误

> ID：10454868
> 
> 赞同：1
> 
> 时间：2012-05-04T19:18:05.833
> 
> 标签：python, error-handling

我试图捕获错误并让代码完成运行。在下面的代码中，我“做某事”。如果失败，我想打印 Error Msg 并继续运行下半部分。

发生的事情是当第一部分发生错误时，错误语句打印并停止运行。我希望代码继续运行超过第一部分。

```
 if len(rows) > 0:
            try:                
                print "Do something"       
            except:
                print time.strftime("%H:%M:%S")  

            try:
                print "Do somethings else"
            except:
                print time.strftime("%H:%M:%S") 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-04T19:21:43.677

Python 的异常没有内置的重启功能来“继续运行下半场”。相反，您只需将“无条件，始终执行此操作”部分从 try 子句中移到 finally 子句中或完全在 try 语句之外。

PS 通常不建议用一个空的 except-clause 吞下所有异常。相反，通常的最佳实践是只捕获您知道如何处理的异常。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-04T19:23:16.623

~~您能否以编程方式确定“做某事”是否失败？如果是这样，那是一种更好的方法，而不是仅仅依靠异常处理机制。我在 .net 代码中经常看到这种反模式。在许多语言中，异常是针对特殊情况而设计的，而不仅仅是错误处理。~~

保留答案只是为了保留那些可能像我一样思考的人的评论。

# asp.net-mvc-3 - 带有查询字符串和表单参数的 POST 模型绑定

> ID：10454872
> 
> 赞同：9
> 
> 时间：2012-05-04T19:18:20.713
> 
> 标签：asp.net-mvc-3

**如果您发布一个表单并且它的操作**具有查询参数**并且**您有表单数据，那么ASP.NET/MVC 中表单绑定的定义行为是什么？

例如：

```
<form action="my/action?foo=1" method="post">
     <input type="hidden" name="bar" value="2">
</form> 
```

如果提交了这样的表单，控制器是否应该同时获取`foo`和`bar`/或仅获取其中一个？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-05-04T19:25:02.037

控制器将获得这两个值。默认模型绑定器将尝试从 URI（查询字符串或路由参数）或正文（并且开箱即用地支持表单数据）中查找参数的匹配项。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-09T22:00:45.200

请注意，您可以看到 Html.BeginForm 助手支持这一点，您可以通过 routeValues 来实现：

```
@Html.BeginForm("ActionName", "ControllerName", new { foo = "1" }) 
```

它本质上会生成与您的表单标签相同的 html，但希望为那些发现此问题并想知道如何使用 BeginForm 帮助程序传递不属于表单的其他值的人发布。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-04T19:25:34.860

我觉得应该可以两者兼得。在这种情况下，我将创建一个包含两个字符串或 int 属性的 ViewModel，一个名为“foo”，另一个名为“bar”，并让您的 ActionResult 接受 ViewModel。你应该看到两个值都进来了。

# c++ - C++ 多重继承

> ID：10454874
> 
> 赞同：1
> 
> 时间：2012-05-04T19:18:41.073
> 
> 标签：c++, inheritance, multiple-inheritance, diamond-problem

请不要在这里质疑这段代码中真正奇怪的工人层次结构，我不知道为什么有人会想要这样的东西，但我决定给自己做一个多重继承练习，以确保我完全理解它。所以这就是结果。

```
using namespace std;

class Employee
{
protected:
    string name;
public:
    string getname()
    {
        return name;
    }
    void setname(string name2)
    {
        name = name2;
    }
    Employee(string name2)
    {
        name = name2;
    }
    Employee(){}
};

class Manager : public Employee
{
public:
    string getname()
    {
        return ("Manager" + name);
    }
    Manager(string name2) : Employee(name2){}
    Manager() : Employee(){}
};

class Supervisor : public Manager,public Employee
{
public:
    Supervisor(string name2) : Manager(name2) , Employee(name2){}
    Supervisor() : Manager() , Employee(){}
    string getname()
    {
        return ("Supervisor" + Employee::getname());
    }
}; 
```

希望你能理解我在这里想要做什么。我得到了一些关于“派生类'Supervisor'和基类'Employee'之间的模棱两可的转换。”那我该怎么办？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-04T19:23:28.303

实际上，按照您定义`Supervisor`类的方式，它的对象将有两个类型的主题`Employee`，每个主题都来自它的基类。这导致了问题。

解决方案是使用[虚拟继承](http://en.wikipedia.org/wiki/Virtual_inheritance)（假设您需要多重继承）：

```
class Manager : public virtual Employee 
```

希望您注意`virtual`这里的关键字。:-)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-04T19:26:43.213

在这种情况下，您需要一个虚拟继承：

```
#include <iostream>
#include <string>
using namespace std;

class Employee
{
protected:
    string name;
public:
    string getname()
    {
        return name;
    }
    void setname(string name2)
    {
        name = name2;
    }
    Employee(string name2)
    {
        name = name2;
    }
    Employee(){}
};

class Manager : public virtual Employee
{
public:
    string getname()
    {
        return ("Manager" + name);
    }
    Manager(string name2) : Employee(name2){}
    Manager() : Employee(){}
};

class Supervisor : public Manager,public virtual Employee
{
public:
    Supervisor(string name2) : Manager(name2) , Employee(name2){}
    Supervisor() : Manager() , Employee(){}
    string getname()
    {
        return ("Supervisor" + Employee::getname());
    }
}; 
```

这个问题也被称为钻石继承问题： [http ://en.wikipedia.org/wiki/Diamond_problem](http://en.wikipedia.org/wiki/Diamond_problem)

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-05-04T20:06:08.197

每个人都已经讨论过虚拟继承，但我建议您也阅读 C++ FAQ。

[http://www.parashift.com/c++-faq-lite/multiple-inheritance.html](http://www.parashift.com/c++-faq-lite/multiple-inheritance.html)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-05-04T19:23:05.247

`Supervisor`包含 Employee 类型的两个对象，直接对象和经理对象。在结果`Employee`上调用方法是模棱两可的（应该调用*哪个Employee？）。*您可能想改用虚拟多重继承。`Supervisor`

# nstimer - NSTimer/NSTimeInterval

> ID：10454881
> 
> 赞同：0
> 
> 时间：2012-05-04T19:19:03.743
> 
> 标签：nstimer, nstimeinterval

我试图制作一个从 30 倒计时到 0 的计时器，但这是我能想到的让它工作的唯一方法，但它不起作用。有谁知道我做错了什么？

.h 文件

```
@interface countDownAppViewController : UIViewController {

UIButton *countDown;
UILabel *displayThis;
}

@property (nonatomic, retain) IBOutlet UIButton *countDown;
@property (nonatomic, retain) IBOutlet UILabel *displayThis;

-(IBAction) theCount:(id) sender;
-(IBAction) displayStuff:(id) sender;

@end 
```

.m 文件

```
@synthesize countDown;
@synthesize displayThis;

-(IBAction) theCount:(id) sender    {
[NSTimer scheduledTimerWithTimeInterval:1.0
                                 target:self
                               selector:@selector(displayStuff:)
                               userInfo:nil
                                repeats:NO];

}
int batman=30;
-(void) viewDidLoad{

displayThis.text = [NSString stringWithFormat:@"%i",batman];
}

-(IBAction) displayStuff:(id) sender    {
while (batman >= 0){
    batman--;
    [NSTimer scheduledTimerWithTimeInterval:1.0
                                     target:self
                                   selector:@selector(displayStuff:)
                                   userInfo:nil
                                    repeats:NO];
displayThis.text = [NSString stringWithFormat:@"%i",batman];

}
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-04T19:34:08.987

您是否尝试过按照实际应该编写的方式编写它？`repeats`争论正是为了这个目的。你可以写一个这样的方法：

```
@interface Whatever: UIViewController
{
    NSTimer *timer;
    int count;
    int maxCount;
}

- (void)countDownFrom:(int)cnt;

@end

@implementation Whatever

- (void)countDownFrom:(int)cnt
{
    maxCount = cnt;
    count = 0;
    timer = [NSTimer scheduledTimerWithTimeInterval:1.0
                                 target:self
                               selector:@selector(doCount)
                               userInfo:nil
                                repeats:YES];
}

- (void)doCount
{
    count++;
    textField.text = [NSString stringWithFormat:@"Count: %d", count];
    if (count >= maxCount)
    {
        [timer invalidate];
    }
}

@end 
```

# dapper - dapper.net，如何刷新 ConcurrentDictionary？

> ID：10454883
> 
> 赞同：0
> 
> 时间：2012-05-04T19:19:19.420
> 
> 标签：dapper, concurrentdictionary

我是 dapper 的新手，并计划在我的新项目中使用它。读完之后，似乎我唯一可能遇到的问题是 ConcurrentDictionary。

> Dapper 缓存有关它运行的每个查询的信息，这允许它快速实现对象并快速处理参数。当前实现将此信息缓存在 ConcurrentDictionary 对象中。它存储的对象永远不会被刷新。如果您在不使用参数的情况下即时生成 SQL 字符串，您可能会遇到内存问题。我们可以将字典转换为 LRU 缓存。

我该如何避免这个问题？有人可以告诉我一些代码告诉我如何以及何时刷新它吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-04T20:22:39.903

根据上面的评论，这是一个即时示例：

```
var builder = new StringBuilder();
builder.AppendLine("SELECT Foo FROM Bar");
if (fisrtName != null || lastName != null)
    builder.AppendLine("WHERE");
if (firstName != null)
    builder.AppendLine("    Bar.FirstName = @Firstname");
if (firstName != null && lastName != null)
    builder.Append(" AND");
if (lastName != null)
    builder.AppendLine("    Bar.LastName = @LastName");
var sql = builder.ToString(); 
```

如您所见，dapper 现在将运行的实际 SQL 将根据`firstName`和/或`lastName`是否为空而有所不同。如果两者都为空，您将获得一个 SQL 字符串。如果 only`firstName`不为空，你会得到另一个。如果 only`lastName`不为空，你会得到另一个。最后，如果两者都不为空，您将得到第四个排列。

这就是“on-the-fly”的含义——dapper 将基于这些独特的排列进行缓存，并且在更复杂的场景中，很容易看出你将如何最终得到许多不同的排列，所有其中需要独立缓存。

# asp.net - ASP 交替 CSS 问题

> ID：10454891
> 
> 赞同：1
> 
> 时间：2012-05-04T19:20:14.610
> 
> 标签：asp.net, css

目前我有 4 个带有交替 CSS 标签的跨度。

```
<% var index =0 ; %>
    <% foreach (var item in Model.Take(4))  {
                    var css = (index%2==0)?"even":"odd";
    %>
        <span class="featured-products <%= css %>">
        <a href="<%= Url.Action("View", "Products", new {id = item.SKU}) %>"><%= Html.Photo(PhotoExtensions.PhotoSizeType.HomepageThumb, item.DefaultPhoto)%></a>
        <a href="<%= Url.Action("View", "Products", new {id = item.SKU}) %>"><%= item.ProductName%></a>
        </span>
    <%
    index ++ ;
    } %> 
```

但我需要最后一个跨度包含一个额外的 CSS 标签“last”。我尝试了几种不同的方法，但都失败了。有什么帮助吗？谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-04T19:21:56.347

您是否尝试过使用 :last-child CSS 选择器？如果您可以通过 CSS 实现您想要的，则可能不需要添加额外的标记。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-04T19:25:10.410

如果您不想使用 CSS。

```
<% var index = 0; %>
<% var items = Model.Take(4); %>
<% foreach (var item in items)  {
                var css = (index%2==0)?"":"odd";
                if(index == items.Count - 1)
                {
                   css = " last";
                }
%>
    <span class="featured-products <%= css %>">
    <a href="<%= Url.Action("View", "Products", new {id = item.SKU}) %>"><%= Html.Photo(PhotoExtensions.PhotoSizeType.HomepageThumb, item.DefaultPhoto)%></a>
    <a href="<%= Url.Action("View", "Products", new {id = item.SKU}) %>"><%= item.ProductName%></a>
    </span>
<%
index ++ ;
} %> 
```

另外，我建议清理此代码。你不需要把`<%`和`%>`无处不在。

**更新：**一种更简洁的方式来写你正在做的事情。绝对不是最干净的，而是一个好的开始。

```
<%
    var index = 0;
    var items = Model.Take(4);

    foreach (var item in items)  {
        var css = (index%2==0)?"":"odd";
        if(index == items.Count - 1)
        {
            css = " last";
        }

        %>
        <span class="featured-products <%= css %>">
        <a href="<%= Url.Action("View", "Products", new {id = item.SKU}) %>"><%= Html.Photo(PhotoExtensions.PhotoSizeType.HomepageThumb, item.DefaultPhoto)%></a>
        <a href="<%= Url.Action("View", "Products", new {id = item.SKU}) %>"><%= item.ProductName%></a>
        </span>
        <%
        index ++ ;
    }
%> 
```

# vb.net - 如何使用 VB.NET 查看 Outlook 日历约会

> ID：10454892
> 
> 赞同：4
> 
> 时间：2012-05-04T19:20:18.090
> 
> 标签：vb.net, outlook

我正在编写一个显示日历的应用程序；当您单击日历上的某个日期时，它应该会显示一个窗口，其中列出了当天的约会。

这如何在 VB.Net 中完成？我可以找到将约会添加到日历的代码，但不能这样做。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-08T21:19:42.813

这是使用 Outlook 互操作 API 的代码片段。

这段代码到达应用程序并获取所有日历项。如果您希望基于日期进行限制，可以调用 clfFolder.Items.Restrict 方法并传入限制过滤器。请注意，我在此方法中调用明确的重复项来形式化条目，而不是列出具有重复项的单个项目。

```
Dim appOutlook As Outlook.Application = Me.OutlookFormRegion.Application
Dim mpnNamespace As Outlook.NameSpace = appOutlook.GetNamespace("MAPI")
Dim clfFolder As Outlook.Folder = _ 
    mpnNamespace.GetDefaultFolder(OlDefaultFolders.olFolderCalendar)
Dim itmItems As Outlook.Items
Dim oaiAppointmentItem As Outlook.AppointmentItem
clfFolder.Items.IncludeRecurrences = False
For Each oaiAppointmentItem In clfFolder.Items
    oaiAppointmentItem.ClearRecurrencePattern()
Next 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-12T08:20:42.633

我用它来查找数据。不确定是否有帮助

尝试

```
 Dim olApp As Outlook.Application
        olApp = CreateObject("Outlook.Application")
        Dim mpnNamespace As Outlook.NameSpace = olApp.GetNamespace("MAPI")
        Dim oCalendar As Outlook.MAPIFolder = mpnNamespace.GetDefaultFolder(Outlook.OlDefaultFolders.olFolderCalendar)
        Dim oItems As Outlook.Items = oCalendar.Items
        oItems.Sort("Start")
        oItems.IncludeRecurrences = True
        Dim oAppt As Outlook.AppointmentItem = oItems.Find("[Subject] = 'Upgrade/Issue reported via eData - Ref:2'")
        oAppt.Subject = "Updated"
        oAppt.Save()
        olApp = Nothing
    Catch ex As Exception
        MsgBox(ex.ToString)
    End Try 
```

# .net - WebForms 中的验证

> ID：10454895
> 
> 赞同：1
> 
> 时间：2012-05-04T19:20:26.937
> 
> 标签：.net, winforms, validation, webforms

我正在开发一个 Intranet 桌面应用程序，并且大多数功能都需要一个 Web 界面来配合它。第一次迭代的桌面部分非常完整，现在我必须在 WebForms 中完成。我已经有一年多没有接触过 WebForms 了，我想知道......

如果我有一个带有一些文本框的表单，我意识到我可以使用 javascript 和诸如此类的代码进行验证，但是有没有一种方法可以像在 WinForms 中一样做到这一点？WinForms 文本框有一个验证方法，当用户离开文本框时会调用该方法。在桌面应用程序上，我将其设置为设置在属性设置中具有验证的类实例属性。有没有办法我可以在 WebForms 中做同样的事情，或者我必须在客户端再次将其全部写出来？ASP TextBoxes 有一个 textchanged 方法，但我没有看到验证。我想你们会说我必须在客户端再写一遍，但希望如此。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-04T19:25:17.660

您不必从头开始。Asp.Net 有几个内置的验证器来帮助处理数据类型、范围、字段之间的比较、必填字段，甚至是错误摘要。[有关更多信息，请参阅此链接](http://msdn.microsoft.com/en-us/library/bwd43d0x.aspx)

您还可以使用[CustomValidator](http://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.customvalidator.aspx)控件将您自己的 javascript 与此验证模型一起使用。

[w3schools.com这里](http://www.w3schools.com/aspnet/aspnet_refvalidationcontrols.asp)有一个非常好的教程

**编辑：**避免回发

您可以使用 UpdatePanel 包装您的 TextBox 以使用 Ajax，或者如果您想提高效率，您可以使用 jQuery 调用 WebMethod 并设置对象。例子：

```
[WebMethod(EnableSession = true)]    
public static  string MyWebMethod(String someVar)
{ 
    HttpContext.Current.Session["someVar"] = someVar;
} 
```

在客户端：

```
 $.ajax({
        type: "POST",
        url: 'Page.aspx/MyWebMethod',
        data: "{ someVar: 'valueFromTextBox' }",
        contentType: 'application/json; charset=utf-8',
        success: function (data) {
            //alert(data);
        }
    }); 
```

# input - 为什么我的 gnuplot 安装的交互模式在 batch.dem 文件和 Octave 时不会旋转

> ID：10454902
> 
> 赞同：7
> 
> 时间：2012-05-04T19:21:13.993
> 
> 标签：input, mouse, rotation, gnuplot, interactive

我有 gnuplot 4.6 在 Mac OS X 上工作。它也适用于 Octave。这不是一个与八度音程相关的问题，只是试图说服您 gnuplot 似乎安装得很好。我的问题是，虽然我可以在批处理模式下用鼠标旋转绘图（我使用 x11 作为绘图窗口）（例如 $unixPrompt> gnuplot pm3d.dem 工作正常：我可以旋转/缩放它们），而且还可以旋转从 Octave 中创建的 3d 绘图，但我不能只进入 gnuplot 并从交互式 gnuplot 程序中旋转任何此类绘图。IE。gnuplot> issuePlotCommands... 会很好地显示该图，但是当我以批处理或 Octave 驱动的方式发出相同的命令时，我不能像我可以做的那样旋转该图。我的交互式 gnuplot 似乎不允许任何鼠标输入。我目前的 .profile 中有 GNUTERM=x11。谁能指出为什么我的 gnuplot 安装的交互模式在用于 batch.dem 文件和 Octave 时不会旋转？谢谢。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-05-28T04:44:16.260

输入`pause -1`. 这为我启用了旋转！

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2012-05-04T23:14:01.443

添加`set mouse`有什么不同吗？

（来自 gnuplot 文档）

```
The command `set mouse` enables mouse actions. Currently the pm, x11, ggi,
windows and wxt terminals are mouse enhanced. There are two mouse modes. The
2d-graph mode works for 2d graphs and for maps (i.e. splots with `set view`
having z-rotation 0, 90, 180, 270 or 360 degrees, including `set view map`)
and it allows tracing the position over graph, zooming, annotating graph etc.
For 3d graphs `splot`, the view and scaling of the graph can be changed with
mouse buttons 1 and 2\. If additionally to these buttons the modifier <ctrl> is
hold down, the coordinate system only is rotated which is useful for large
data sets. A vertical motion of Button 2 with the shift key hold down changes
the `xyplane`. 
```

请注意，以下将起作用：

```
echo "plot sin(x); pause mouse keypress" | gnuplot -persist 
```

但这不会：

```
echo "plot sin(x)" | gnuplot -persist 
```

因为 gnuplot 进程必须处于活动状态才能让 gnuplot_x11 驱动程序与之交谈以进行旋转。

# wcf - WCF 发送和接收字符串？

> ID：10454904
> 
> 赞同：0
> 
> 时间：2012-05-04T19:21:22.280
> 
> 标签：wcf

我能够成功地使用 MSDN 示例向 MSMQ 发送消息并从自托管的 WCF 服务中读取它。

我正在尝试在一个新项目中使用一个简单的字符串。我可以将字符串发送到队列没有问题，但托管的 WCF 服务出现故障。

在尝试找出原因后，使用 Microsoft 服务跟踪查看器并启用主机登录，它说它是一条有毒消息！

但我的合同定义了 MsmqMessage

这是我用来发送的：

```
System.Messaging.Message msg = new System.Messaging.Message(this.textBox1.Text); 
```

这是我的合同（接收）：

```
 [OperationContract(IsOneWay = true, Action = "*")] void
 ProcessIncomingMessage(MsmqMessage<string> incomingMessage); 
```

查看MMC时的消息内容：

```
<?xml version="1.0"?>
<string>test</string> 
```

有任何想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-26T13:42:43.987

修正：在发送方，定义格式化程序：msg.Formatter = new XmlMessageFormatter(new string[] { "System.String" }); 在合同上，用 knowntype 的字符串装饰它：[ServiceKnownType(typeof(String))]

# java - 将 JPanel 添加到 JFrame

> ID：10454913
> 
> 赞同：11
> 
> 时间：2012-05-04T19:22:11.743
> 
> 标签：java, swing, jframe, jpanel

我有一个将 JPanel 添加到 JFrame 的程序：

```
public class Test{

    Test2 test = new Test2();
    JFrame frame = new JFrame();

    Test(){

    ...
    frame.setLayout(new BorderLayout());
    frame.add(test, BorderLayout.CENTER);
    ...

    }

    //main

    ...

    }

    public class Test2{

    JPanel test2 = new JPanel();

    Test2(){

    ...

    }

} 
```

我收到一个错误，要求我将“面板”类型更改为“组件”。我要修复这个错误吗？它要我做： Component panel = new Component();

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2012-05-04T19:28:23.193

```
public class Test{

Test2 test = new Test2();
JFrame frame = new JFrame();

Test(){
...
frame.setLayout(new BorderLayout());
frame.add(test, BorderLayout.CENTER);
...
}

//main
...
}

//public class Test2{
public class Test2 extends JPanel {

//JPanel test2 = new JPanel();

Test2(){
...
} 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-07-28T19:42:17.930

简单地做

```
public class Test{
    public Test(){
        design();
    }//end Test()

public void design(){
    JFame f = new JFrame();
    f.setSize(int w, int h);
    f.setDefaultCloseOperation(JFrame.DISPOSE_ON_CLOSE);
    f.setVisible(true);
    JPanel p = new JPanel(); 
    f.getContentPane().add(p);
}

public static void main(String[] args){
     EventQueue.invokeLater(new Runnable(){
     public void run(){
         try{
             new Test();
         }catch(Exception e){
             e.printStackTrace();
         }

 }
         );
}

} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-04T19:28:36.253

与其让您的 Test2 类包含 JPanel，不如让它成为 JPanel 的子类：

```
public class Test2 extends JPanel {

Test2(){

...

} 
```

**更多细节：**

[JPanel](http://docs.oracle.com/javase/6/docs/api/javax/swing/JPanel.html)是 Component 的子类，因此任何将 Component 作为参数的方法也可以将 JPanel 作为参数。

旧版本不允许您直接添加到 JFrame；你必须使用 JFrame.getContentPane().add(Component)。如果您使用的是旧版本，这也可能是一个问题。较新版本的 Java 允许您直接调用 JFrame.add(Component)。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-04T19:27:59.457

```
Test2 test = new Test2();
...
frame.add(test, BorderLayout.CENTER); 
```

你确定吗？`test`不是一个组件！要做你想做的事，你应该让`Test2`extend `JPanel`！

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-05-04T19:28:00.933

你的`Test2`课程不是 a `Component`，它有 a `Component`which is a difference。

要么你做类似的事情

```
frame.add(test.getPanel() ); 
```

在您为班级中的面板引入吸气剂之后，或者您确保您的`Test2`班级成为 a `Component`（例如，通过扩展 a `JPanel`）

# jquery - jQuery代码中“this”的含义

> ID：10454914
> 
> 赞同：1
> 
> 时间：2012-05-04T19:22:20.003
> 
> 标签：jquery

我正在阅读一本关于 jQuery (Apress Pro jQuery) 的优秀书籍，我对“this”的使用感到有些困惑。例如，我正在阅读以下代码：

```
<script type="text/javascript">
$(document).ready(function() {
    var isResult = $('img').is(function(index) {
        return this.getAttribute("src") == "rose.png";
    });
    console.log("Result: " + isResult);
  });
</script> 
```

我想知道在这种情况下“this”指的是哪个对象。谢谢你。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-04T19:24:28.197

`this`在“this”上下文中是对 DOM`img`元素的引用。

# objective-c - ConvertRect 占 UIScrollView 缩放和 contentOffset

> ID：10454916
> 
> 赞同：1
> 
> 时间：2012-05-04T19:22:25.113
> 
> 标签：objective-c, ios, xcode, ios5

我一直在尝试在 UIScrollView 中获取 UIView 的转换后的 CGRect。如果我不放大它就可以正常工作，但是一旦我放大，新的 CGRect 就会发生变化。这是让我接近的代码：

```
CGFloat zoomScale = (scrollView.zoomScale);    
CGRect newRect = [self.view convertRect:widgetView.frame fromView:scrollView];
CGPoint newPoint = [self.view convertPoint:widgetView.center fromView:scrollView];

//  Increase the size of the CGRect by multiplying by the zoomScale
CGSize newSize = CGSizeMake(newRect.size.width * zoomScale, newRect.size.height * zoomScale);
//  Subtract the offset of the UIScrollView for proper positioning
CGPoint newCenter = CGPointMake(newPoint.x - scrollView.contentOffset.x, newPoint.y - scrollView.contentOffset.y);

//  Create rect with the proper width/height (x and y set by center)
newRect = CGRectMake(0, 0, newSize.width, newSize.height);    

[self.view addSubview:widgetView];

widgetView.frame = newRect;
widgetView.center = newCenter; 
```

我相当确定我的问题在于 zoomScale - 我可能应该根据 zoomScale 值修改 x 和 y 坐标。不过，到目前为止，我所做的一切都没有成功。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-05-07T13:15:55.560

我在 iOS 开发论坛上收到了来自用户 Brian2012 的以下回答：

我做了什么：

1.  创建了一个覆盖视图控制器主视图的 UIScrollView。
2.  在滚动视图中放置一个桌面视图（标准 UIView）。桌面的原点在 0,0 并且大小比滚动视图大，所以我可以滚动而不需要先缩放。
3.  将一些小部件视图 (UIImageView) 放入不同位置的桌面视图中。
4.  将滚动视图的 contentSize 设置为桌面视图的大小。
5.  实现 viewForZoomingInScrollView 以将桌面视图作为要滚动的视图返回。
6.  将 NSLogs 放入 scrollViewDidZoom 以打印出桌面视图的框架和其中一个小部件视图。

我发现了什么：

1.  小部件框架永远不会改变我设置的初始值。因此，例如，如果一个小部件从位置 108、108 开始，大小为 64x64，则无论缩放或滚动，帧总是报告为 108,108,64,64。
2.  桌面框架原点永远不会改变。我在滚动视图中将桌面的原点设置为 0,0，无论缩放或滚动，原点总是报告为 0,0。
3.  唯一改变的是桌面视图的框架大小，大小只是原始大小乘以滚动视图的缩放比例。

结论：

要确定小部件相对于视图控制器主视图的坐标系的位置，您需要自己进行数学计算。在这种情况下，convertRect 方法没有任何用处。这里有一些代码可以尝试

```
- (CGRect)computePositionForWidget:(UIView *)widgetView fromView:(UIScrollView *)scrollView
{
    CGRect frame;
    float  scale;

    scale = scrollView.zoomScale;

    // compute the widget size based on the zoom scale
    frame.size.width  = widgetView.frame.size.width  * scale;
    frame.size.height = widgetView.frame.size.height * scale;

    // compute the widget position based on the zoom scale and contentOffset
    frame.origin.x = widgetView.frame.origin.x * scale - scrollView.contentOffset.x + scrollView.frame.origin.x;
    frame.origin.y = widgetView.frame.origin.y * scale - scrollView.contentOffset.y + scrollView.frame.origin.y;

    // return the widget coordinates in the coordinate system of the view that contains the scroll view
    return( frame );
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2021-12-17T09:24:29.283

我也有类似的问题，我用不同的技巧解决了它。我在一个临时变量中捕获缩放比例，并将scrollView的缩放比例设置为最小值（1.0），然后使用convertRect（）计算我的帧并再次设置原始缩放比例

```
CGFloat actualZoomScal = self.baseVideoView.zoomScale;
CGPoint actualOffset = self.baseVideoView.contentOffset;

self.baseVideoView.zoomScale = 1.0;
CGRect iFrame = [[RGLayout layout] rectToPixels:[self recordingIndicatorFrame]];
self.recordIndicator =  [[RiscoRecordingIndicatorView alloc] initWithFrame:[self convertRect:iFrame fromView:self.previewView]];
[self addSubview:self.recordIndicator] ;
[self bringSubviewToFront:self.recordIndicator] ;
self.baseVideoView.zoomScale = actualZoomScal;
self.baseVideoView.contentOffset = actualOffset; 
```

# sql - 从图像列中预览数据的最简单方法是什么？

> ID：10454919
> 
> 赞同：19
> 
> 时间：2012-05-04T19:22:49.907
> 
> 标签：sql, sql-server, sql-server-2008

我有一些`image`数据类型的列，我想预览（或浏览）这些表中的数据。当我`Select top 1000 rows`在 SQL Server Management Studio 中使用时，图像列的值以十六进制显示。由于十六进制值对我没有用，预览这些图像的最简单方法是什么？

PS.：数据库不在我的控制之下，所以改变数据类型不是一种选择。

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2014-07-02T14:56:38.520

如果您安装了[LinqPad](http://www.linqpad.net/)，预览图像很简单。查询您的记录，将二进制数据转换为图像，然后将输出转储到预览窗口。

编辑：如果您不知道，LinqPad 是一个免费实用程序，可用于许多事情，例如替代管理工作室。大多数时候，我将它用作 .Net 的便签本，用于一次性程序、测试代码和示例。

```
var entity = // fetch data

using (var ms = new MemoryStream(entity.Image.ToArray()))
{
    System.Drawing.Image.FromStream(ms).Dump();
} 
```

结果如下：

![在此处输入图像描述](../Images/acf175e3865167b5bc4d8fd6896ee925.png)

* * *

## 回答 #2

> 赞同：19
> 
> 时间：2012-05-07T17:01:18.513

我会编写一个 proc（或查询；见下文）将二进制文件导出到文件系统，然后使用任何旧的现成照片管理实用程序**（即 Windows 照片查看器）**来查看里面的内容。

如果您在文件命名方面很聪明，您可以为自己提供有关名称中每个图像的足够信息，以便在您直观地找到您要查找的内容后再次在数据库中快速找到它。

这是一个将二进制文件导出到文件系统的过程。我从[这个示例代码](http://jahaines.blogspot.com/2009/10/exporting-binary-files-to-file-system.html)修改。它未经测试，但应该非常接近概念。它使用 BCP 导出您的二进制文件。在此处查看[有关 BCP 实用程序的完整文档](http://msdn.microsoft.com/en-us/library/ms162802%28v=sql.105%29.aspx)。

proc 还使您能够导出表中的所有内容，或者仅基于传递的主键导出单行。它使用游标 (yuck) 以及一些动态 sql (yuck, yuck)，但有时你必须做你必须做的事情。

```
 CREATE PROCEDURE ExportMyImageFiles
 (   
   @PriKey INT,
   @OutputFilePath VARCHAR(500)
 ) 
 AS 
 BEGIN 
     DECLARE @sql VARCHAR(8000) 

     IF @PriKey IS NULL /* export all images */
     BEGIN
        DECLARE curExportBinaryImgs CURSOR FAST_FORWARD FOR

        SELECT 'BCP "SELECT MyImage FROM [dbo].[MyTable] 
           WHERE PrimaryKey =' + CAST(PrimaryKey AS VARCHAR(25)) + 
           '" queryout ' + @OutputFilePath + MyImageName + '.' + 
           MyImageType + ' -S MyServer\MyInstance -T -fC:\Documents.fmt'
        FROM [dbo].[MyTable]

        OPEN curExportBinaryImgs
        FETCH NEXT FROM curExportBinaryImgs INTO @sql

        WHILE @@FETCH_STATUS = 0
        BEGIN            
            EXEC xp_cmdshell @sql, NO_OUTPUT
            FETCH NEXT FROM curExportBinaryImgs INTO @sql
        END

        CLOSE curExportBinaryImgs
        DEALLOCATE curExportBinaryImgs
     END
     ELSE       /* Export only the primary key provided */     
     BEGIN
        SELECT @sql = 'BCP "SELECT MyImage FROM [dbo].[MyTable] 
        WHERE PrimaryKey =' + CAST(PrimaryKey AS VARCHAR(25)) + 
            '" queryout ' + @OutputFilePath
            + MyImageName + '.' + MyImageType + 
            ' -S MyServer\MyInstance -T -fC:\Documents.fmt'
        FROM [dbo].[MyTable]
        WHERE PrimaryKey = @PriKey

        EXEC xp_cmdshell @sql,NO_OUTPUT
     END 
 END 
```

当然，这一切都假设存储在 Image 列中的内容实际上是图像而不是其他文件类型。希望如果它是图像，您也知道类型、bmp、jpg、png、gif 等。

**如果您不想要一个完整的过程的麻烦或可重用性，请尝试像这样的单个查询：**

* * *

```
 DECLARE @OutputFilePath VarChar(500) = /* put output dir here */

    DECLARE @sql VARCHAR(8000)
    DECLARE curExportBinaryImgs CURSOR FAST_FORWARD FOR
    SELECT 'BCP "SELECT MyImage FROM [dbo].[MyTable] 
       WHERE PrimaryKey =' + CAST(PrimaryKey AS VARCHAR(25)) + 
       '" queryout ' + @OutputFilePath + MyImageName + '.' + 
       MyImageType + ' -S MyServer\MyInstance -T -fC:\Documents.fmt'
    FROM [dbo].[MyTable]

    OPEN curExportBinaryImgs
    FETCH NEXT FROM curExportBinaryImgs INTO @sql

    WHILE @@FETCH_STATUS = 0
    BEGIN            
        EXEC xp_cmdshell @sql, NO_OUTPUT
        FETCH NEXT FROM curExportBinaryImgs INTO @sql
    END

    CLOSE curExportBinaryImgs
    DEALLOCATE curExportBinaryImgs 
```

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2012-05-07T15:21:01.697

[图像](http://msdn.microsoft.com/en-us/library/ms187993.aspx)类型不是用于存储图像，它只是“可变长度的二进制数据” 。此类型已弃用，您现在应该将 varbinary(max) 用于可变长度二进制数据。

由于 SQL Server 不知道存储了哪种类型的二进制数据（.zip、.exe、.jpg、.anything），因此 Management Studio 不提供预览也就不足为奇了。

您肯定无法在 Managment Studio 中预览这些数据类型，但我喜欢 @RTomas 提供的解决方案。

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2018-01-21T09:44:57.870

[SSMS SSMSBoost](http://www.ssmsboost.com/Features/ssms-add-in-results-grid-visualizers)有一个非常棒的插件，它提供了大量有用的功能，当然也是预览存储在 SQL 中的图像的最简单方法（至少在我看来）

**注意**：安装此插件后，您必须重新启动 SSMS。

安装它并享受预览图像的乐趣：*右键单击 > 可视化为 > 图片*

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2012-05-04T19:29:50.103

我不知道在 Management Studio 中实现此目的的方法。您可能会更好地编写一个简单的应用程序来查询数据库，然后将十六进制转换为正确的图像类型（.jpg、.png 等）。还有一些[商业](http://download.cnet.com/SQL-Image-Viewer/3000-10254_4-10830522.html)应用程序可以为您执行此操作。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2018-09-02T15:06:42.700

使用 linqpad 代码可以变得更加简单

那些你在**二进制数据列**上拥有实体/类型的人，你会看到**.ToImage()**方法

就我而言，我正在遍历所有行并将所有二进制列发布到图像。

希望能帮助到你。

```
var yourData_Or_List = // fetch data
DataItem_Or_ListItem.BinaryDataColumn.ToImage().Dump(); 
```

[![liqpad 二进制数据到图像](../Images/f123f6c60fffbeac66c6d20bbd6b88a5.png)](https://i.stack.imgur.com/WaqDl.png)

# php - PHP Do something on MySQL Row 添加

> ID：10454923
> 
> 赞同：1
> 
> 时间：2012-05-04T19:23:07.900
> 
> 标签：php, mysql, push

我需要一种方法来不断地（在循环中）检查是否添加了新的 MySQL 行，如果是，对它做一些事情，特别是向用户发送与之相关的通知，但我可以处理。我只需要知道当 MySQL 行数发生变化时如何执行代码。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-04T19:24:27.730

您可能希望考虑在插入和/或删除时使用 MySQL 触发器：

*   [http://dev.mysql.com/doc/refman/5.0/en/triggers.html](http://dev.mysql.com/doc/refman/5.0/en/triggers.html)

*   [http://net.tutsplus.com/tutorials/databases/introduction-to-mysql-triggers/](http://net.tutsplus.com/tutorials/databases/introduction-to-mysql-triggers/)

# facebook - 当用户授权应用程序但 PHP 中的密码错误时，我如何发现这种情况？

> ID：10454930
> 
> 赞同：0
> 
> 时间：2012-05-04T19:23:53.630
> 
> 标签：facebook, authentication, facebook-graph-api

在我的应用程序中，我需要处理所有各种情况。我对标准情况没有任何问题，例如，我对边缘情况有一些问题

*   应用密码输入错误
*   用户取消了我的应用程序的授权

这是我的代码

```
//I have already checked that the app id is valid

require AI1EC_LIB_PATH . '/facebook-php-sdk/src/facebook.php';
// Create our Application instance (replace this with your appId and secret).
$facebook = new Facebook(array(
    'appId'  => $plugin_settings['facebook-app-id'],
    'secret' => $plugin_settings['facebook-app-secret'],
));
// Get User ID
$user = $facebook->getUser();
// We may or may not have this data based on whether the user is logged in.
//
// If we have a $user id here, it means we know the user is logged into
// Facebook, but we don't know if the access token is valid. An access
// token is invalid if the user logged out of Facebook.

if ( $user ) {
    try {
        // Proceed knowing you have a logged in user who's authenticated.
        $user_profile = $facebook->api( '/me' );
    } catch ( FacebookApiException $e ) {
        error_log( json_encode( $e->getResult() ) );
        $user = NULL;
    }
}

// Login or logout url will be needed depending on current user state.
if ( $user ) {
    $logout_url = $facebook->getLogoutUrl();
    echo "OK!";
} else {
    $params = array(
        'scope' => 'user_events, friends_events',
    );
    $login_url = $facebook->getLoginUrl( $params );
    $args = array(
        'login_url'  => $login_url,
    );
    $ai1ec_view_helper->display_admin( 'plugins/facebook/user_login.php', $args );
} 
```

我应该把特定错误的处理放在哪里？我很想向用户显示一个很好的消息，比如“出了点问题，检查你是否正确输入了你的应用程序密码”或“你已经取消了你的应用程序的授权”。也许你应该在 catch() 块中这样做，但我不知道要检查哪些代码。

任何人都可以帮忙吗？

# apache-flex - Flex：数字的DataGrid列格式

> ID：10454932
> 
> 赞同：2
> 
> 时间：2012-05-04T19:23:57.253
> 
> 标签：apache-flex, actionscript

我正在尝试在 DataGrid 的列中格式化一些数字。我在下面的简化测试程序中运行它时遇到错误。到目前为止，我看到的所有示例都有字符串形式的列数据。有没有办法使用数字来做到这一点？如何修改下面的代码以格式化`checking`值？

```
<?xml version="1.0" encoding="utf-8"?>
<mx:Application 
    xmlns:fx="http://ns.adobe.com/mxml/2009" 
    xmlns:s="library://ns.adobe.com/flex/spark" 
    xmlns:mx="library://ns.adobe.com/flex/mx">

<fx:Script>
    <![CDATA[       
        [Bindable]
        public var checking:Array = new Array(1000000.2222, 0, 1000);

        private function myLabelFunction(item:Array, column:DataGridColumn):String {    
                var result:String;
                result = myFormatter.format(item);
                return result;
        }
    ]]>
</fx:Script>

<fx:Declarations>
    <s:NumberFormatter id="myFormatter"
                       fractionalDigits="2" 
                       decimalSeparator="."
                       groupingSeparator=","
                       useGrouping="true"
                       negativeNumberFormat="0"
                       />
</fx:Declarations>

<mx:DataGrid id="dg1" dataProvider="{checking}" >

    <mx:columns>
        <mx:DataGridColumn dataField="checking" headerText="Checking" 
                           labelFunction="myLabelFunction" />
    </mx:columns>

</mx:DataGrid>

</mx:Application> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-04T21:02:55.123

1.  更改过滤器函数签名（`item`应该是`Object`）

    `private function myLabelFunction(item:Object, column:DataGridColumn):String`

2.  `dataField="checking"`从列中删除。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-04T21:18:16.380

虽然 label 功能肯定会起作用——我通常更喜欢 ItemRenderer 来处理这样的事情。您覆盖渲染功能，然后您可以在网格视图“框”中显示您喜欢的任何内容。

一个体面的例子是[here](http://www.adobe.com/devnet/flex/articles/itemrenderers_pt1.html)。对于 DataGrid 示例，向下滚动大约 1/4。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-06-19T14:00:30.403

如果是对象，您必须使用/No caso de objeto, deve-se usar：

```
 private function myLabelFunction(item:Object, column:GridColumn):String {    
            var result:String;
            result = myFormatter.format(item[column.dataField]);
            return result;
        } 
```

# php - 将 PHP 输出到文本框

> ID：10454933
> 
> 赞同：-3
> 
> 时间：2012-05-04T19:23:58.683
> 
> 标签：php, textbox

我试图让在 php 中完成的乘法结果显示在表单的文本框中。如何在php中做到这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-04T19:27:42.800

像这样的东西：

```
<?php

$result = 1 * 764000;

?>

...
<input type="text" value="<?php echo $result; ?>" />
... 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-04T19:28:17.293

不太确定你在这里寻找什么，所以这是一个有点疯狂的猜测。

```
<textarea id="value" name="value"><?php echo $contents; ?></textarea> 
```

这将在您的文本区域中回显您的 PHP 变量 ($contents)。

编辑：对不起，如果您的意思是输入文本类型。我在想 textarea 因为你称它为“文本框”。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-04T21:50:43.620

我想您是在问如何在同一页面上打印结果而不转到下一页。

这是它的工作原理（在我脑海中）

```
<?php

if (isset($_POST['submit']))
{
$result=$_POST['num1']*$_POST['num2'];
}
?>
<html><body>
<form action="#" method="post">
Num1:<input name="num1"><br>
Num2:<input name="num2">
Answer: <input value="<?php if (isset($result)) echo $result ?>">
<input type="submit" name="submit">
</form>
</body></html> 
```

# java - 构建阶段的 Maven 复制

> ID：10454935
> 
> 赞同：2
> 
> 时间：2012-05-04T19:24:06.707
> 
> 标签：java, eclipse, maven

我的情况是：

*   我有一个扫描库目录的项目。
*   这个项目不依赖于其他项目（jars），但这会动态地将它们从目录加载到他的类加载器（是一种插件架构）。
*   两个项目都在一个 pom 项目下

poms的例子：

*家长*：

```
<groupId>mygroup</groupId>
<artifactId>myparent</artifactId>
<packaging>pom</packaging>
<version>1.0</version>
... 
```

*“插件”*：

```
<parent>
    <artifactId>myparent</artifactId>
    <groupId>mygroup</groupId>
    <version>1.0</version>
</parent>

<groupId>mygroup</groupId>
<artifactId>myplugin</artifactId>
<packaging>jar</packaging>
<version>1.0</version>
... 
```

*“装载机”*：

```
<parent>
    <artifactId>myparent</artifactId>
    <groupId>mygroup</groupId>
    <version>1.0</version>
</parent>

<groupId>mygroup</groupId>
<artifactId>myloader</artifactId>
<packaging>war</packaging>
<version>1.0</version>
... 
```

现在，我需要生成jar *“插件”*并在构建时将其复制到项目*“加载器”*中定义的目录中。

这必须在 eclipse 和 jenkins 自动构建中本地工作。

有人知道我该怎么做吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-07T20:41:29.917

基本上它分四步解决：

1.  我在我的“插件”项目中配置插件“maven-assembly-plugin”，以将 jar 复制到项目“loader”中的相对路径中。
2.  *在此配置中，我在jar-with-dependencies*中指定属性“descriptorRef” ，这有助于我将必要的库打包到 jar 中
3.  我在我的“插件”项目中配置插件“maven-copy-plugin”，以复制项目“加载器”中相同相对路径中的属性

我的“插件”项目中的 pom.xml 如下所示：

```
<plugins>
        <plugin>
            <artifactId>maven-assembly-plugin</artifactId>
            <configuration>
                <outputDirectory>${my.output.directory}</outputDirectory>
                <archive>
                    <manifest>
                        <addClasspath>true</addClasspath>
                    </manifest>
                </archive>
                <descriptorRefs>
                    <descriptorRef>jar-with-dependencies</descriptorRef>
                </descriptorRefs>     
            </configuration>
        </plugin>
        <plugin>
            <groupId>com.goldin.plugins</groupId>
            <artifactId>maven-copy-plugin</artifactId>
            <version>0.2.3.6</version>
            <executions>
                <execution>
                    <id>create-archive</id>
                    <phase>package</phase>
                    <goals>
                        <goal>copy</goal>
                    </goals>
                    <configuration>
                        <resources>
                            <!-- Copy config properties -->
                            <resource>
                                <targetPath>${my.output.directory}</targetPath>
                                <directory>${project.basedir}/conf</directory>
                                <includes>
                                    <include>*.properties</include>
                                </includes>
                            </resource>
                        </resources>
                    </configuration>
                </execution>
            </executions>
        </plugin>
    </plugins> 
```

另一方面，我将项目设置为使用目录*${my.output.directory}中的插件*

4.  为了在 eclipse 中自动构建，我为项目创建了一种新型的程序构建器。此构建器运行命令“mvn assembly:assembly”。

**第 1 步**：

![在此处输入图像描述](../Images/8f381225952674976d64c126bc3cce01.png)

**第 2 步**：

![在此处输入图像描述](../Images/c16dcd9357b9b0828bd409e99f13b2db.png)

第 3 步：在“构建选项”选项卡中，您可以配置此执行的详细信息。

对于 jenkins，我创建了一个仅用于测试的虚拟插件。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-04T20:08:00.207

运行 maven install for plugin，将生成的 jar 放入本地 maven repo。然后在您的依赖项部分中指定插件作为依赖项。在这种情况下，即使这些项目是同级项目，它们也只是同级项目，因为当 mvn 目标在父级中运行时，父级指定了构建顺序。如果您打算在那里使用它们的实际构建工件，则必须包含在兄弟姐妹中。

# jquery - jquery 的文本框列表不适用于 jquery

> ID：10454941
> 
> 赞同：0
> 
> 时间：2012-05-04T19:24:28.210
> 
> 标签：jquery, email, textboxlist

我知道问这个问题有点荒谬。`http://www.devthought.com/projects/jquery/textboxlist/`但是当我尝试插入这个 jquery src 时，我在使用 jquery() 的 Textboxlist 时遇到了问题：

```
<script type="text/javascript" src="js/jquery-1.7.2.min.js"></script> 
```

这是结果：

![在此处输入图像描述](../Images/a5cbc214206b52efb421a65ce354815d.png)

移除时：

![在此处输入图像描述](../Images/0b491346ef0f53f53d0d33f6fde780e3.png)

这是 src 的`Textboxlist for jquery`：

```
 <script src="mootools-1.2.1-core-yc.js" type="text/javascript" charset="utf-8"></script>    
    <script src="GrowingInput.js" type="text/javascript" charset="utf-8"></script>
    <script src="../Source/TextboxList.js" type="text/javascript" charset="utf-8"></script>     
    <script src="../Source/TextboxList.Autocomplete.js" type="text/javascript" charset="utf-8"></script>
    <script src="../Source/TextboxList.Autocomplete.Binary.js" type="text/javascript" charset="utf-8"></script> 
```

先感谢您。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-04T19:41:17.733

`jQuery.noConflict()`在[http://docs.jquery.com/Using_jQuery_with_Other_Libraries](http://docs.jquery.com/Using_jQuery_with_Other_Libraries)使用

# google-api - 监听 Google+ 环聊状态变化的正确方法是什么？

> ID：10454942
> 
> 赞同：3
> 
> 时间：2012-05-04T19:24:28.913
> 
> 标签：google-api, google-plus, hangout

[https://developers.google.com/+/hangouts/writing](https://developers.google.com/+/hangouts/writing)上的环聊 API包含一个示例，用于在环聊状态发生变化时设置回调函数，如下所示：

```
gapi.hangout.onStateChanged.add(onStateChange); 
```

运行时，这会导致类似于“ **gapi.hangout.onStateChanged is undefined** ”的错误。Firebug 中的快速检查表明该`onStateChanged`方法属于`gapi.hangout.data` **not** `gapi.hangout`。

状态改变时添加回调函数的正确方法是什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-07T21:46:08.467

您正在寻找的方法确实是[gapi.hangout.data](https://developers.google.com/+/hangouts/reference#gapi.hangout.data)的成员。你提到的那篇文章似乎已经过时了。我修复它 ：）

要在状态更改时执行某些操作，只需附加一个回调：

```
gapi.hangout.data.onStateChanged.add(function() {
  console.log(gapi.hangout.data.getState());
}); 
```

[您可以在示例应用程序](https://developers.google.com/+/hangouts/sample-apps)页面上找到正在运行的代码的工作示例。

# android - 如何在 Android 中指定删除线文本样式？

> ID：10454945
> 
> 赞同：0
> 
> 时间：2012-05-04T19:24:39.083
> 
> 标签：android, text, styles

嗨，我想写一个像“折扣价”这样的词，然后用直线（不是图片）将其剪切，然后在“折扣价”下方写 -> 新的折扣价而不剪切它

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-04T19:27:36.893

这是一个示例：http: [//fupeg.blogspot.com/2010/01/strikethrough-android.html](http://fupeg.blogspot.com/2010/01/strikethrough-android.html)

```
TextView someLabel = (TextView) findViewById(R.id.some_label);
someLabel.setText(someDynamicString);
someLabel.setPaintFlags(someLabel.getPaintFlags() | Paint.STRIKE_THRU_TEXT_FLAG); 
```

# java - 使用 Java Restful 服务进行身份验证

> ID：10454946
> 
> 赞同：1
> 
> 时间：2012-05-04T19:24:46.477
> 
> 标签：java, rest, jersey, java-ee-6, basic-authentication

我正在尝试使用 Glassfish v3 上的基本身份验证获得 Java EE jersey restful 服务。

目前，该服务要求对用户进行身份验证，如果提供了正确的凭据，则允许领域内的任何用户（具有任何角色）访问该服务。它应该只允许管理员角色访问。

此外，如果我尝试限制使用 @RolesAllowed 注释，这也会被忽略。

其余代码：

```
@Path("/file")
public class FileResource {

    @GET
    @Produces("application/json")
    public Response getJson() {
        String result = "{\"data\":\"test\"}";
        return Response.ok(result, MediaType.APPLICATION_JSON).build();
    }

    @GET
    @Produces(MediaType.TEXT_PLAIN)
    @RolesAllowed("admin")
    public Response getOther() {
        String result = "{\"employee\":[{\"email\":\"jdoe@example.com\",\"firstName\":\"John\",\"lastName\":\"Doe\"},{\"email\":\"mmajor@example.com\",\"firstName\":\"Mary\",\"lastName\":\"Major\"}]}";
        return Response.ok(result, MediaType.APPLICATION_JSON).build();
    }
} 
```

web.xml 代码：

```
<?xml version="1.0" encoding="UTF-8"?>
<web-app xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xmlns="http://java.sun.com/xml/ns/javaee" xmlns:web="http://java.sun.com/xml/ns/javaee/web-app_2_5.xsd"
    xsi:schemaLocation="http://java.sun.com/xml/ns/javaee http://java.sun.com/xml/ns/javaee/web-app_3_0.xsd"
    id="WebApp_ID" version="3.0">
    <display-name>org.examples.secure</display-name>
    <welcome-file-list>
        <welcome-file>index.xhtml</welcome-file>
    </welcome-file-list>

    <servlet>
        <servlet-name>JAX-RS Servlet</servlet-name>
        <servlet-class>com.sun.jersey.spi.container.servlet.ServletContainer</servlet-class>
        <load-on-startup>1</load-on-startup>
    </servlet>
    <servlet>
        <servlet-name>Faces Servlet</servlet-name>
        <servlet-class>javax.faces.webapp.FacesServlet</servlet-class>
        <load-on-startup>1</load-on-startup>
    </servlet>

    <servlet-mapping>
        <servlet-name>JAX-RS Servlet</servlet-name>
        <url-pattern>/rs/*</url-pattern>
    </servlet-mapping>
    <servlet-mapping>
        <servlet-name>Faces Servlet</servlet-name>
        <url-pattern>*.xhtml</url-pattern>
    </servlet-mapping>

    <login-config>
        <auth-method>BASIC</auth-method>
        <realm-name>DBRealm</realm-name>
    </login-config>

    <security-constraint>
        <web-resource-collection>
            <web-resource-name>users</web-resource-name>
            <url-pattern>/rs/*</url-pattern>
        </web-resource-collection>
        <auth-constraint>
            <description/>
            <role-name>admin</role-name>
        </auth-constraint>
        <!-- <user-data-constraint>
            <description>SSL</description>
            <transport-guarantee>CONFIDENTIAL</transport-guarantee>
        </user-data-constraint> -->
    </security-constraint>

    <security-role>
        <role-name>admin</role-name>
    </security-role>

</web-app> 
```

sun-web.xml 代码：

```
<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE sun-web-app PUBLIC "-//Sun Microsystems, Inc.//DTD Application Server 9.0 Servlet 2.5//EN" "http://www.sun.com/software/appserver/dtds/sun-web-app_2_5-0.dtd">
<sun-web-app error-url="">
  <context-root>/org.examples.secure</context-root>
  <security-role-mapping>
    <role-name>admin</role-name>
    <group-name>admin</group-name>
  </security-role-mapping>
  <class-loader delegate="true"/>
  <jsp-config>
    <property name="keepgenerated" value="true">
      <description>Keep a copy of the generated servlet class java code.</description>
    </property>
  </jsp-config>
</sun-web-app> 
```

任何帮助，将不胜感激

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-04T22:53:21.130

You need to add [RolesAllowedResourceFilterFactory](http://jersey.java.net/nonav/apidocs/latest/jersey/com/sun/jersey/api/container/filter/RolesAllowedResourceFilterFactory.html "RolesAllowedResourceFilterFactory") to your web application (see the linked javadoc on how) for the @RolesAllowed annotations to work.

# jquery - 使用 Jquery/MVC/Json 将选择列表返回到我的视图

> ID：10454947
> 
> 赞同：2
> 
> 时间：2012-05-04T19:24:47.087
> 
> 标签：jquery, asp.net-mvc, json, selectlist

无论我不断尝试多少搜索和不同的变化，我都无法让它工作：

我正在尝试从我的 jquery 中动态填充一个选择列表：

```
var url = '@Url.Action("GetCounties", "Account")' + '/' + $("#State").val();
            $.get(url, function (data) {
                $('#county').empty();
                $.each(result, function (index, val) {
                    $('#county')
                    .append($("<option></option>")
                    .attr("value", val.Text)
                    .text(val.Text));
                });
            }); 
```

使用实体框架的控制器动作：

```
public JsonResult GetCounties(string id)
{
    return Json(GetCountySelectList(id), JsonRequestBehavior.AllowGet);
}

private SelectList GetCountySelectList(string id)
{
    var counties = db.ZipCodeDataBase.Where(x => x.State.Contains(id)).OrderBy(x => x.County).Select(x => x.County).Distinct().ToList();
    SelectList list = new SelectList(counties);
    return list;
} 
```

生成的选择列表的每个变体都不会返回 jquery 所需的数据。

任何帮助将不胜感激！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-04T19:42:09.687

您正在调用您的返回变量`data`，然后像`result`在`$.each`. 尝试先修复它。

# model-view-controller - 如何保存 QStandardItemModel？

> ID：10454959
> 
> 赞同：0
> 
> 时间：2012-05-04T19:25:40.113
> 
> 标签：model-view-controller, qt

我目前正在编写一个播放播客的应用程序。我将所有提要和其中的剧集表示`QStandardItem`为`QStandardItemModel`. 现在，我没有办法保存这个模型——当应用程序关闭时，提要模型就烟消云散了。我查看了 using `QSettings`，但这仅适用于属于`QVariant`.

看[这篇文章](https://stackoverflow.com/questions/8279649/convert-a-qstandarditemmodel-to-a-qvariant "将 QStandardItemModel 转换为 QVariant")给了我一些希望，但我认为我做错了什么。我的应用程序的构造函数中有以下代码。

```
//Expand QVatiant to use QStandardItemModel
qRegisterMetaType<QStandardItemModel>("QStandardItemModel"); 
```

但是，这在编译时给了我这个错误。

```
/ [...] QtSDK/Desktop/Qt/4.8.1/gcc/lib/QtGui.framework/Versions/4/Headers/qstandarditemmodel.h:424: error: 'QStandardItemModel::QStandardItemModel(const QStandardItemModel&)' is private 
```

啊。这让我想起了 QMetaType 的 Qt 文档中的这个警告，[这里](http://qt-project.org/doc/qt-4.8/qmetatype.html#qRegisterMetaType)。

> 任何具有公共默认构造函数、公共复制构造函数和公共析构函数的类或结构都可以注册。

那么，我从这里去哪里？Qt 的行为与应有的完全一样，因此这种方法行不通。我正在考虑将模型保存为 xml 文件，但这似乎需要付出很多努力。这似乎是一个很常见的问题——我只是不知道在哪里寻找答案。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-14T18:08:44.620

这是我能想到的最佳解决方案：创建一个将模型保存到 XML 文档中的方法，并在我更改模型时调用它（例如添加或删除播客）。我手头没有实际的源代码，但由于没有真正简单的方法来批量保存数据结构，因此这是最好的解决方案。

# python - Python：使模块对 TestRunner 可见的正确方法是什么？

> ID：10454960
> 
> 赞同：0
> 
> 时间：2012-05-04T19:25:44.457
> 
> 标签：python, django, unit-testing, testing, django-testing

在看了几个关于 django 测试的演讲之后，我想编写自己的 TestRunner 来跳过 django 测试，并为我的测试创建更好的包结构。

问题是我们改变了项目结构，测试运行器找不到正确的路径来进行测试发现。这就是我的项目的样子：

```
project/
  -src/
    - project_name/
      - apps/
      - test/ # Not a good name, i know, will change it
         - some_app/

           - test_models.py
    - manage.py
    - development.db 
```

现在，为了测试`test_models.py`我想这样做：

```
$ cd project/src/
$ python manage.py test some_app.test_models 
```

问题是测试运行器找不到那个包（`some_app`）和模块（`test_models.py`）。如果我在测试运行程序中硬编码名称，它会改变，但我不喜欢这样做。这是我为使其工作所做的工作。

```
test_labels = ["%s.%s" % ("project_name.test", l)
                           for l in test_labels
                           if not l.startswith("project_name.test")] 
```

所以，如果你这样做

```
$ python manage.py test some_app.test_models 
```

它将被重写为：

```
$ python manage.py test project_name.test.some_app.test_models 
```

这很好用。

我试过做`sys.path.append("(...)/project_name/test)`，但也没有用。

这是我的 TestRunner 的代码：

```
class DiscoveryDjangoTestSuiteRunner(DjangoTestSuiteRunner):
    """A test suite runner that uses unittest2 test discovery.
    It's better than the default django test runner, becouse it
    doesn't run Django tests and let you put your tests in different
    packages, modules and classes.

    To test everything in there:
        $ ./manage.py test

    To test a single package/module:

        $ ./manage.py test package
        $ ./manage.py test package.module

    To test a single class:

        $ ./manage.py test package.module.ClassName
    """
    def build_suite(self, test_labels, extra_tests=None, **kwargs):
        suite = None
        discovery_root = settings.TEST_DISCOVERY_ROOT
        if test_labels:
            # This is where I append the path
            suite = defaultTestLoader.loadTestsFromNames(test_labels)
            # if single named module has no tests, do discovery within it
            if not suite.countTestCases() and len(test_labels) == 1:
                suite = None
                discovery_root = import_module(test_labels[0]).__path__[0]

        if suite is None:
            suite = defaultTestLoader.discover(
                discovery_root,
                top_level_dir=settings.BASE_PATH,
                )

        if extra_tests:
            for test in extra_tests:
                suite.addTest(test)

        return reorder_suite(suite, (TestCase,)) 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-04T19:45:16.160

在您继续为您的定制投入更多时间之前`TestRunner`，我绝对建议您先看看[`django-nose`](https://github.com/jbalogh/django-nose)。

`django-nose`implements的测试运行器提供的自定义测试[`nose`](http://readthedocs.org/docs/nose/en/latest/)运行器非常灵活，并提供了很多运行测试的选项。它无缝覆盖默认`test`管理命令，并允许您在项目`settings`模块中配置默认​​测试选项。

我真的推荐它有几个原因：

*   该`test`命令的选项已完整记录（[查看输出](https://gist.github.com/2597247)）
*   鼻子为[测试发现提供](http://readthedocs.org/docs/nose/en/latest/finding_tests.html)*了很多*方法
*   您的同事很可能已经是经验丰富的鼻子使用者
*   您不必`TestRunner`自己编写课程

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-05T22:27:35.070

您的 Python 导入层次结构植根于`project/src`. `test_models`因此，您的模块的正确 Python 导入路径是`project_name.test.some_app.test_models`，这就是我希望作为测试标签传入的路径。

但是您不喜欢`project_name.test`每次要运行特定的测试模块时都输入前缀，因为您的所有测试都将位于那里。没关系：您选择引入一些隐含的非显而易见的行为以换取一些便利。`sys.path`为了实现这一点，您绝对不应该添加任何东西：Python 导入健全的关键是将给定代码库的导入层次结构植根于一个并且完全是一个位置；重叠的 sys.path 条目将导致问题，例如以不同名称重复导入同一模块。

实际上，您想要的只是 UI 便利，在我看来，您展示的 test-label-munging 代码是实现这种便利的明显方式。你不喜欢`project_name.test`硬编码前缀，但它必须在某个地方硬编码：测试运行器不可能神奇地发现你想在测试标签前面加上`project_name.test`. 如果您希望自己`TestRunner`更通用，可以将其拉出到类似`BASE_TEST_MODULE`或类似的设置中，并将该设置的值添加到每个测试标签中。

# sql - 构建 PIVOT

> ID：10454961
> 
> 赞同：3
> 
> 时间：2012-05-04T19:25:48.600
> 
> 标签：sql, sql-server, sql-server-2008, tsql, pivot

我认为 PIVOT 将帮助我完成此任务，但我无法开始任何事情。我今天有严重的 SQL 脑放屁，我需要一些帮助。

这是我现在的输出：

```
Id    Name  Question    Answer
0     Test  Vault       A
0     Test  Container   1
1     Foo   Vault       B
1     Foo   Container   2 
```

这是我想要的输出：

```
Id   Name Vault Container
0    Test A    1
1    Foo  B    2 
```

这可以做到吗？

如果这不可能或非常复杂，我有另一种方法来解决这个问题。我的备用查询的输出是：

```
Id   Name VaultId ContainerId
0    Test A       NULL
0    Test NULL       1
1    Foo  B       NULL  
1    Foo  NULL       2 
```

在这里，我需要能够将每个 Id/Name 抑制为一行。我不记得如何做这两个！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-04T19:43:21.643

```
DECLARE @Test TABLE
(
     Id      INT 
    ,[Name]VARCHAR(10) NOT NULL
    ,Question       VARCHAR(10) NOT NULL,
    Answer VARCHAR(10)

);  
INSERT  @Test   VALUES (0,'test1', 'vault','a');
INSERT  @Test   VALUES (0,'test1', 'Container ','1');
INSERT  @Test   VALUES (1,'test4', 'vault','b');
INSERT  @Test   VALUES (1,'test4', 'Container','2');

;WITH CTE
AS
(
    SELECT  t.id, t.[Name], t.[Question    ]   ,t.Answer
     FROM    @Test t
)

SELECT  * 
FROM    CTE
 PIVOT   ( max(answer) FOR Question     IN (vault,container) )  f; 
```

![在此处输入图像描述](../Images/b68ad1bbec66411c5cdf08c926d48982.png)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-04T19:47:50.170

是`PIVOT`的，这就是你需要的:)。假设您的表名为`MyPivot`Try：

```
SELECT Id, Name, [Vault], [Container]
FROM (SELECT Id, Name, Question, Answer FROM MyPivot) AS SourceTable
PIVOT (MAX(Answer) FOR Question in (Vault, Container)) as p; 
```

**编辑：要演示该语法的含义，请参阅以下细分：**

```
PIVOT (<aggregate function>(<column being aggregated>) 
FOR <column that contains the values that will become column headers>
    IN ( [first pivoted column], [second pivoted column]) 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-05-04T19:51:32.430

您可以使用静态枢轴执行此操作：

```
create table temp
(
    id int,
    name varchar(10),
    question varchar(10),
    answer  varchar(10)
)

INSERT into temp   VALUES (0,'test', 'vault','a');
INSERT into temp   VALUES (0,'test', 'Container','1');
INSERT into temp   VALUES (1,'foo', 'vault','b');
INSERT into temp   VALUES (1,'foo', 'Container','2');

select *
from 
(
    select id, name, question, answer
    from temp
) x
pivot 
(
    max(answer)
    for question in ([container], [vault])
) p

drop table temp 
```

或动态支点

```
DECLARE @cols AS NVARCHAR(MAX),
    @query  AS NVARCHAR(MAX);

select @cols = STUFF((SELECT distinct ',' + QUOTENAME(c.question) 
            FROM temp c
            FOR XML PATH(''), TYPE
            ).value('.', 'NVARCHAR(MAX)') 
        ,1,1,'')

set @query = 'SELECT id, name, ' + @cols + ' from 
            (
                select id, name, question, answer
                from temp
           ) x
            pivot 
            (
                 max(answer)
                for question in (' + @cols + ')
            ) p '

execute(@query) 
```

两者都会给你相同的结果：

![在此处输入图像描述](../Images/8356376d4e07b97129f64dbb095d4510.png)

# c++ - 将文件中的非连续块映射到连续的内存地址

> ID：10454964
> 
> 赞同：18
> 
> 时间：2012-05-04T19:26:10.413
> 
> 标签：c++, boost, shared-memory, mmap, boost-interprocess

我对使用内存映射 IO 的前景感兴趣，最好利用 boost::interprocess 中的设施来支持跨平台，将文件中的非连续系统页面大小块映射到内存中的连续地址空间。

一个简化的具体场景：

我有许多“普通旧数据”结构，每个结构都是固定长度（小于系统页面大小）。这些结构连接成一个（非常长的）流，结构的类型和位置由在流中处理它们的那些结构的值。我的目标是在要求苛刻的并发环境中最大限度地减少延迟并最大限度地提高吞吐量。

我可以通过将这些数据映射到至少是系统页面大小两倍的块中来非常有效地读取这些数据......并在读取超出倒数第二个系统页面边界的结构后立即建立一个新映射。这允许与普通旧数据结构交互的代码幸福地不知道这些结构是内存映射的……例如，可以直接使用 memcmp() 比较两个不同的结构，而不必关心页面边界。

事情变得有趣的地方在于更新这些数据流......同时（同时）读取它们。我想使用的策略受到系统页面大小粒度上的“写入时复制”的启发......本质上是写入“覆盖页面” - 允许一个进程读取旧数据，而另一个进程读取更新的数据。

虽然管理要使用的覆盖页面以及何时使用并不一定是微不足道的......这不是我主要关心的问题。我主要担心的是我可能有一个跨越第 4 页和第 5 页的结构，然后更新一个完全包含在第 5 页中的结构......在位置 6 中写入新页面......当第 5 页被“垃圾收集”时确定不再可达。这意味着，如果我将第 4 页映射到位置 M，我需要将第 6 页映射到内存位置 M+page_size... 以便能够使用现有的（非内存映射-知道）功能。

我正在尝试制定最佳策略，但我觉得文档不完整，这使我受到了阻碍。本质上，我需要将地址空间的分配从内存映射中解耦到该地址空间。使用 mmap()，我知道我可以使用 MAP_FIXED - 如果我希望明确控制映射位置......但我不清楚我应该如何保留地址空间以安全地执行此操作。我可以在没有 MAP_FIXED 的情况下为两个页面映射 /dev/zero，然后使用 MAP_FIXED 两次将两个页面映射到显式 VM 地址处的分配空间吗？如果是这样，我也应该调用 munmap() 三次吗？它会泄漏资源和/或有任何其他不良开销吗？为了使问题更加复杂，我想在 Windows 上进行类似的行为...... 有什么办法吗？如果我要妥协我的跨平台野心，是否有巧妙的解决方案？

--

感谢您的回答，Mahmoud ...我已经阅读并认为我已经理解了该代码...我已经在 Linux 下编译了它，它的行为符合您的建议。

我主要关心的是第 62 行 - 使用 MAP_FIXED。它对 mmap 做了一些假设，当我阅读我能找到的文档时，我无法确认这些假设。您将“更新”页面映射到与最初返回的 mmap() 相同的地址空间 - 我认为这是“正确的” - 即不是碰巧在 Linux 上工作的东西？我还需要假设它适用于文件映射和匿名映射的跨平台。

该示例确实使我前进...记录了我最终需要的内容可能可以通过 Linux 上的 mmap() 来实现——至少。我真正想要的是一个指向文档的指针，该文档显示 MAP_FIXED 行将像示例演示的那样工作......并且，理想情况下，从 Linux/Unix 特定 mmap() 到独立于平台的转换（Boost::interprocess ） 方法。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-05-07T02:48:11.143

你的问题有点令人困惑。据我了解，此代码将满足您的需求：

```
#define PAGESIZE 4096

#include <stdio.h>
#include <stdlib.h>
#include <string.h>
#include <sys/mman.h>
#include <errno.h>
#include <sys/types.h>
#include <fcntl.h>
#include <unistd.h>
#include <assert.h>

struct StoredObject
{
    int IntVal;
    char StrVal[25];
};

int main(int argc, char **argv)
{
    int fd = open("mmapfile", O_RDWR | O_CREAT | O_TRUNC, (mode_t) 0600);
    //Set the file to the size of our data (2 pages)
    lseek(fd, PAGESIZE*2 - 1, SEEK_SET);
    write(fd, "", 1); //The final byte

    unsigned char *mapPtr = (unsigned char *) mmap(0, PAGESIZE * 2, PROT_READ | PROT_WRITE, MAP_SHARED, fd, 0);

    struct StoredObject controlObject;
    controlObject.IntVal = 12;
    strcpy(controlObject.StrVal, "Mary had a little lamb.\n");

    struct StoredObject *mary1;
    mary1 = (struct StoredObject *)(mapPtr + PAGESIZE - 4); //Will fall on the boundary between first and second page
    memcpy(mary1, &controlObject, sizeof(StoredObject));

    printf("%d, %s", mary1->IntVal, mary1->StrVal);
    //Should print "12, Mary had a little lamb.\n"

    struct StoredObject *john1;
    john1 = mary1 + 1; //Comes immediately after mary1 in memory; will start and end in the second page
    memcpy(john1, &controlObject, sizeof(StoredObject));

    john1->IntVal = 42;
    strcpy(john1->StrVal, "John had a little lamb.\n");

    printf("%d, %s", john1->IntVal, john1->StrVal);
    //Should print "12, Mary had a little lamb.\n"

    //Make sure the data's on the disk, as this is the initial, "read-only" data
    msync(mapPtr, PAGESIZE * 2, MS_SYNC);

    //This is the inital data set, now in memory, loaded across two pages
    //At this point, someone could be reading from there. We don't know or care.
    //We want to modify john1, but don't want to write over the existing data
    //Easy as pie.

    //This is the shadow map. COW-like optimization will take place: 
    //we'll map the entire address space from the shared source, then overlap with a new map to modify
    //This is mapped anywhere, letting the system decide what address we'll be using for the new data pointer
    unsigned char *mapPtr2 = (unsigned char *) mmap(0, PAGESIZE * 2, PROT_READ | PROT_WRITE, MAP_SHARED, fd, 0);

    //Map the second page on top of the first mapping; this is the one that we're modifying. It is *not* backed by disk
    unsigned char *temp = (unsigned char *) mmap(mapPtr2 + PAGESIZE, PAGESIZE, PROT_READ | PROT_WRITE, MAP_SHARED | MAP_FIXED | MAP_ANON, 0, 0);
    if (temp == MAP_FAILED)
    {
        printf("Fixed map failed. %s", strerror(errno));
    }
    assert(temp == mapPtr2 + PAGESIZE);

    //Make a copy of the old data that will later be changed
    memcpy(mapPtr2 + PAGESIZE, mapPtr + PAGESIZE, PAGESIZE);

    //The two address spaces should still be identical until this point
    assert(memcmp(mapPtr, mapPtr2, PAGESIZE * 2) == 0);

    //We can now make our changes to the second page as needed
    struct StoredObject *mary2 = (struct StoredObject *)(((unsigned char *)mary1 - mapPtr) + mapPtr2);
    struct StoredObject *john2 = (struct StoredObject *)(((unsigned char *)john1 - mapPtr) + mapPtr2);

    john2->IntVal = 52;
    strcpy(john2->StrVal, "Mike had a little lamb.\n");

    //Test that everything worked OK
    assert(memcmp(mary1, mary2, sizeof(struct StoredObject)) == 0);
    printf("%d, %s", john2->IntVal, john2->StrVal);
    //Should print "52, Mike had a little lamb.\n"

    //Now assume our garbage collection routine has detected that no one is using the original copy of the data
    munmap(mapPtr, PAGESIZE * 2);

    mapPtr = mapPtr2;

    //Now we're done with all our work and want to completely clean up
    munmap(mapPtr2, PAGESIZE * 2);

    close(fd);

    return 0;
} 
```

* * *

我修改后的答案应该可以解决您的安全问题。仅`MAP_FIXED`在第二次`mmap`通话时使用（就像我上面所说的那样）。很酷的一点`MAP_FIXED`是，它可以让您覆盖现有的`mmap`地址部分。它将卸载您重叠的范围并将其替换为您的新映射内容：

```
 MAP_FIXED
              [...] If the memory
              region specified by addr and len overlaps pages of any existing
              mapping(s), then the overlapped part of the existing mapping(s) will be
              discarded. [...] 
```

这样，您就可以让操作系统为您找到数百兆的连续内存块（永远不要调用`MAP_FIXED`您不确定的地址不可用）。然后你`MAP_FIXED`用你将要修改的数据调用现在映射的巨大空间的一个子部分。多田。

* * *

在 Windows 上，这样的东西应该可以工作（我现在在 Mac 上，所以未经测试）：

```
int main(int argc, char **argv)
{
    HANDLE hFile = CreateFile(L"mmapfile", GENERIC_READ | GENERIC_WRITE, FILE_SHARE_READ, NULL, CREATE_ALWAYS, FILE_ATTRIBUTE_NORMAL, NULL);
    //Set the file to the size of our data (2 pages)
    SetFilePointer(hFile, PAGESIZE*2 - 1, 0, FILE_BEGIN);
    DWORD bytesWritten = -1;
    WriteFile(hFile, "", 1, &bytesWritten, NULL);

    HANDLE hMap = CreateFileMapping(hFile, NULL, PAGE_READWRITE, 0, PAGESIZE * 2, NULL);
    unsigned char *mapPtr = (unsigned char *) MapViewOfFile(hMap, FILE_MAP_READ | FILE_MAP_WRITE, 0, 0, PAGESIZE * 2);

    struct StoredObject controlObject;
    controlObject.IntVal = 12;
    strcpy(controlObject.StrVal, "Mary had a little lamb.\n");

    struct StoredObject *mary1;
    mary1 = (struct StoredObject *)(mapPtr + PAGESIZE - 4); //Will fall on the boundary between first and second page
    memcpy(mary1, &controlObject, sizeof(StoredObject));

    printf("%d, %s", mary1->IntVal, mary1->StrVal);
    //Should print "12, Mary had a little lamb.\n"

    struct StoredObject *john1;
    john1 = mary1 + 1; //Comes immediately after mary1 in memory; will start and end in the second page
    memcpy(john1, &controlObject, sizeof(StoredObject));

    john1->IntVal = 42;
    strcpy(john1->StrVal, "John had a little lamb.\n");

    printf("%d, %s", john1->IntVal, john1->StrVal);
    //Should print "12, Mary had a little lamb.\n"

    //Make sure the data's on the disk, as this is the initial, "read-only" data
    //msync(mapPtr, PAGESIZE * 2, MS_SYNC);

    //This is the inital data set, now in memory, loaded across two pages
    //At this point, someone could be reading from there. We don't know or care.
    //We want to modify john1, but don't want to write over the existing data
    //Easy as pie.

    //This is the shadow map. COW-like optimization will take place: 
    //we'll map the entire address space from the shared source, then overlap with a new map to modify
    //This is mapped anywhere, letting the system decide what address we'll be using for the new data pointer
    unsigned char *reservedMem = (unsigned char *) VirtualAlloc(NULL, PAGESIZE * 2, MEM_RESERVE, PAGE_READWRITE);
    HANDLE hMap2 = CreateFileMapping(hFile, NULL, PAGE_READWRITE, 0, PAGESIZE, NULL);
    unsigned char *mapPtr2 = (unsigned char *) MapViewOfFileEx(hMap2, FILE_MAP_READ | FILE_MAP_WRITE, 0, 0, PAGESIZE, reservedMem);

    //Map the second page on top of the first mapping; this is the one that we're modifying. It is *not* backed by disk
    unsigned char *temp = (unsigned char *) MapViewOfFileEx(hMap2, FILE_MAP_READ | FILE_MAP_WRITE, 0, 0, PAGESIZE, reservedMem + PAGESIZE);
    if (temp == NULL)
    {
        printf("Fixed map failed. 0x%x\n", GetLastError());
        return -1;
    }
    assert(temp == mapPtr2 + PAGESIZE);

    //Make a copy of the old data that will later be changed
    memcpy(mapPtr2 + PAGESIZE, mapPtr + PAGESIZE, PAGESIZE);

    //The two address spaces should still be identical until this point
    assert(memcmp(mapPtr, mapPtr2, PAGESIZE * 2) == 0);

    //We can now make our changes to the second page as needed
    struct StoredObject *mary2 = (struct StoredObject *)(((unsigned char *)mary1 - mapPtr) + mapPtr2);
    struct StoredObject *john2 = (struct StoredObject *)(((unsigned char *)john1 - mapPtr) + mapPtr2);

    john2->IntVal = 52;
    strcpy(john2->StrVal, "Mike had a little lamb.\n");

    //Test that everything worked OK
    assert(memcmp(mary1, mary2, sizeof(struct StoredObject)) == 0);
    printf("%d, %s", john2->IntVal, john2->StrVal);
    //Should print "52, Mike had a little lamb.\n"

    //Now assume our garbage collection routine has detected that no one is using the original copy of the data
    //munmap(mapPtr, PAGESIZE * 2);

    mapPtr = mapPtr2;

    //Now we're done with all our work and want to completely clean up
    //munmap(mapPtr2, PAGESIZE * 2);

    //close(fd);

    return 0;
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-13T04:55:51.023

> 但我不清楚我应该如何保留地址空间以便安全地做到这一点

这会因操作系统而异，但是稍微挖掘 msdn 上的 mmap（我从 msdn 搜索中的“xp mmap”开始）显示 Microsoft 有他们通常的 VerboseAndHelpfullyCapitalizedNames 用于实现 mmap 片段的（许多）函数。文件映射器和匿名映射器都可以像任何 POSIX-2001 系统一样处理固定地址请求，即如果地址空间中的其他东西正在与内核通信，您可以对其进行排序。我绝不会“安全地”接触，对于您想要移植到未指定平台的代码，没有“安全地”之类的东西。您将不得不建立自己的预映射匿名内存池，以后您可以在自己的控制下取消映射和打包。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2015-07-14T13:41:14.163

我从@Mahmoud 测试了windows 代码，实际上我测试了以下类似的代码，但它不起作用（Linux 代码有效。）如果你取消注释VirtualFree，它会起作用。正如我在上面的评论中提到的，在 Windows 上，您可以使用 VirtualAlloc 保留地址空间，但您不能将 MapViewOfFileEx 与已经映射的地址一起使用，因此您需要先 VirtualFree 它。然后有一个竞争条件，另一个线程可以在你之前抢占内存地址，所以你必须在一个循环中做所有事情，例如尝试最多 1000 次然后放弃。

```
package main

import (
    "fmt"
    "os"
    "syscall"
)

func main() {
    const size = 1024 * 1024

    file, err := os.Create("foo.dat")
    if err != nil {
        panic(err)
    }

    if err := file.Truncate(size); err != nil {
        panic(err)
    }

    const MEM_COMMIT = 0x1000

    addr, err := virtualAlloc(0, size, MEM_COMMIT, protReadWrite)
    if err != nil {
        panic(err)
    }

    fd, err := syscall.CreateFileMapping(
        syscall.Handle(file.Fd()),
        nil,
        uint32(protReadWrite),
        0,
        uint32(size),
        nil,
    )

    //if err := virtualFree(addr); err != nil {
    //  panic(err)
    //}

    base, err := mapViewOfFileEx(fd, syscall.FILE_MAP_READ|syscall.FILE_MAP_WRITE, 0, 0, size, addr)
    if base == 0 {
        panic("mapViewOfFileEx returned 0")
    }
    if err != nil {
        panic(err)
    }

    fmt.Println("success!")
}

type memProtect uint32

const (
    protReadOnly  memProtect = 0x02
    protReadWrite memProtect = 0x04
    protExecute   memProtect = 0x20
    protAll       memProtect = 0x40
)

var (
    modkernel32         = syscall.MustLoadDLL("kernel32.dll")
    procMapViewOfFileEx = modkernel32.MustFindProc("MapViewOfFileEx")
    procVirtualAlloc    = modkernel32.MustFindProc("VirtualAlloc")
    procVirtualFree     = modkernel32.MustFindProc("VirtualFree")
    procVirtualProtect  = modkernel32.MustFindProc("VirtualProtect")
)

func mapViewOfFileEx(handle syscall.Handle, prot memProtect, offsetHigh uint32, offsetLow uint32, length uintptr, target uintptr) (addr uintptr, err error) {
    r0, _, e1 := syscall.Syscall6(procMapViewOfFileEx.Addr(), 6, uintptr(handle), uintptr(prot), uintptr(offsetHigh), uintptr(offsetLow), length, target)
    addr = uintptr(r0)
    if addr == 0 {
        if e1 != 0 {
            err = error(e1)
        } else {
            err = syscall.EINVAL
        }
    }
    return addr, nil
}

func virtualAlloc(addr, size uintptr, allocType uint32, prot memProtect) (mem uintptr, err error) {
    r0, _, e1 := syscall.Syscall6(procVirtualAlloc.Addr(), 4, addr, size, uintptr(allocType), uintptr(prot), 0, 0)
    mem = uintptr(r0)
    if e1 != 0 {
        return 0, error(e1)
    }
    return mem, nil
}

func virtualFree(addr uintptr) error {
    const MEM_RELEASE = 0x8000
    _, _, e1 := syscall.Syscall(procVirtualFree.Addr(), 3, addr, 0, MEM_RELEASE)
    if e1 != 0 {
        return error(e1)
    }
    return nil
} 
```

# facebook - Facebook 应用程序时间线选项卡

> ID：10454965
> 
> 赞同：0
> 
> 时间：2012-05-04T19:26:11.813
> 
> 标签：facebook, facebook-timeline

我对时间线选项卡有疑问。我创建了一个应用程序，该应用程序已作为选项卡安装在 2 个不同的业务页面上。现在我要做的是根据正在查看的业务页面更改选项卡的内容。另一家公司已经这样做了，但我不知道怎么做。有什么想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-23T14:12:56.087

这很容易做到。如果您解码`signed_request`发布到您的页面的数据，您可以看到哪个页面正在“查看”您的应用程序（即应用程序安装在哪个页面上）。

如果您解码数据（例如在 PHP 中，您可以执行以下操作：`print_r( $facebook->getSignedRequest() );`打印解码后的版本），您将看到如下内容：

```
Array
(
    ...
    [page] => Array
        (
            [id] => 1234567890
            [liked] => 1
            [admin] => 1
        )
    [user] => Array
        (
            ...
        )
) 
```

`$response['page']['id']`是当时正在查看您的应用的页面的 ID 。您可以存储已安装您的应用程序的页面的 ID，并通过它检查以确定要加载的内容。

您还会注意到数据包括`$response['page']['admin']`，它告诉您查看页面的用户是否是页面的管理员（1=admin，0=not admin）。和`$response['page']['liked']`，它告诉您查看页面的用户是否是粉丝（1=粉丝，0=不是粉丝）。

# java - 在 JNLP 文件中使用 JAR 参数

> ID：10454970
> 
> 赞同：2
> 
> 时间：2012-05-04T19:26:35.723
> 
> 标签：java, xml, command-line-arguments, jnlp, java-web-start

我有一个问题，如何使用 JNLP 协议运行带有参数的 JAR 文件。例如，要正确运行 selenium-server-standalone-2.21.0.jar 包，我将其称为：

```
selenium-server-standalone-2.21.0.jar -timeout 60000 -trustAllSSLCertificates -port 5555 
```

当我将这些参数添加为：

```
<jar href="/selenium-server-standalone-2.21.0.jar -timeout 60000 -trustAllSSLCertificates -port 5555"/> 
```

我收到错误 - 找不到这样的文件。我猜这些参数被视为文件名的一部分，因此我得到了这个错误。我在哪里可以将调用 JAR 包的参数放在下面的 XML 中。

```
<?xml version="1.0" encoding="UTF-8"?>
<jnlp spec="1.0+" codebase="http://test.com/">
<information>
  <title>Selenium-Server-Standalone-2.21.0</title>
  <vendor>ESKY Testers Toolkit</vendor>
  <homepage href="http://www.esky.pl/"/>
  <description>starts selenium server on client machine</description>
</information>
<security>
  <all-permissions/>
</security>
<resources>
  <j2se version="1.4+"/>
  <jar href="/selenium-server-standalone-2.21.0.jar"/>
</resources>
<application-desc main-class="org.openqa.selenium.server.SeleniumServer"/>
</jnlp> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-04T19:39:01.087

添加`arg`元素作为元素的子`application-desc`元素。例如

```
<?xml version="1.0" encoding="UTF-8"?>
<jnlp spec="1.0+" codebase="http://test.com/">
<information>
  <title>Selenium-Server-Standalone-2.21.0</title>
  <vendor>ESKY Testers Toolkit</vendor>
  <homepage href="http://www.esky.pl/"/>
  <description>starts selenium server on client machine</description>
</information>
<security>
  <all-permissions/>
</security>
<resources>
  <j2se version="1.4+"/>
  <!-- size.  The downloadable size of the JAR file in bytes. -->
  <jar href="/selenium-server-standalone-2.21.0.jar" size="21247" />
</resources>
<application-desc main-class="org.openqa.selenium.server.SeleniumServer">
    <argument>-timeout</argument>
    <argument>60000</argument>
    <!-- etc... -->
</application-desc>
</jnlp> 
```

* * *

以前的评论（现已删除）。

*   卸载应用程序。在测试新的 JNLP 之前。启动文件可能非常抗更新。事实上，在更改 JNLP 时 - 我通常会更改缓存位置（通过 Java 控制面板）以测试新的启动文件。
*   JNLP。使用[JaNaLA](http://pscode.org/janela/)检查启动文件的（格式正确和）有效性（除其他外） 。在进行另一项测试之前，更正粉红色/红色的任何错误。

# appcelerator - appcelerator 应用程序的基本布局

> ID：10454971
> 
> 赞同：0
> 
> 时间：2012-05-04T19:26:43.140
> 
> 标签：appcelerator, appcelerator-mobile

我创建了我的第一个 appcelerator 应用程序并寻找一些关于某事是否可行的信息，如果可行，是否易于实现。

我正在使用 Titanium SDK 2.0.1。

我正在尝试在 Android 的 Google+ 应用程序中创建类似于 Stream 窗口的布局：
1：大标题（可以调整 Ti.UI.createWindow 的导航栏属性吗？）
2：标题下的两个选项卡（想要如果可能的话能够调整它们的高度？如果这不可能，是否有 Ti.UI.createTabGroup 的替代品？）

我认为我可以很容易地弄清楚主要内容。

![我想复制的 Google+ 布局](../Images/87c6ec6fa5602b033c19011c73fd0b33.png)

有关如何实现此布局的任何示例或链接都会很棒。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-05T22:24:52.777

没有办法在 Android 中使用原生 Ti.UI.Window 属性来实现这种类型的 NavBar，但您可以使用视图创建自己的 NavBar 并坚持到窗口的顶部。对于选项卡，我会查看[http://www.tomaspersson.com/2012/03/20/titanium-viewpager-module-now-available/](http://www.tomaspersson.com/2012/03/20/titanium-viewpager-module-now-available/) - 我不确定它是否包含您需要的所有选项，但这是一个很好的起点。祝你好运！

# r - 如何从私有数据创建示例数据集（用无信息的占位符替换变量名称和级别）？

> ID：10454973
> 
> 赞同：45
> 
> 时间：2012-05-04T19:26:47.343
> 
> 标签：r

为了提供方法的可重现示例，通常必须提供数据集。我不想构建示例数据集，而是希望使用我自己的一些数据。不过这个数据不能公布。我希望用无意义的占位符（例如 V1....V5，L1....L5）替换变量（列）名称和因子级别。

***是否有一种自动化的方法可以做到这一点？***

理想情况下，这将在 R 中完成，接收一个 data.frame 并生成这个匿名 data.frame。

使用这样的数据集，只需在脚本中搜索和替换变量名称，您就有了一个可公开发布的可重现示例。

这样的过程可能会增加在可重现示例中包含适当数据，甚至在问题、评论和错误报告中包含可重现示例。

* * *

## 回答 #1

> 赞同：40
> 
> 时间：2012-05-04T20:24:23.577

我不知道是否有自动执行此操作的功能，但*现在**有*;)

```
## A function to anonymise columns in 'colIDs' 
##    colIDs can be either column names or integer indices
anonymiseColumns <- function(df, colIDs) {
    id <- if(is.character(colIDs)) match(colIDs, names(df)) else colIDs
    for(id in colIDs) {
        prefix <- sample(LETTERS, 1)
        suffix <- as.character(as.numeric(as.factor(df[[id]])))
        df[[id]] <- paste(prefix, suffix, sep="")
    }
    names(df)[id] <- paste("V", id, sep="")
    df
}

## A data.frame containing sensitive information
df <- data.frame(
    name = rep(readLines(file.path(R.home("doc"), "AUTHORS"))[9:13], each=2),
    hiscore = runif(10, 99, 100),
    passwd = replicate(10, paste(sample(c(LETTERS, letters), 9), collapse="")))

## Anonymise it
df2 <- anonymiseColumns(df, c(1,3))

## Check that it worked
> head(df, 3)
           name  hiscore    passwd
1 Douglas Bates 99.96714 ROELIAncz
2 Douglas Bates 99.07243 gDOLNMyVe
3 John Chambers 99.55322 xIVPHDuEW    

> head(df2, 3)
  name hiscore  V3
1   Q1 99.96714 V8
2   Q1 99.07243 V2
3   Q2 99.55322 V9 
```

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2012-05-05T03:50:52.933

这是我的功能版本。优点：没有for循环，级别标签匹配变量标签，可以应用于任何df，超过26个字母的有序变量名，数值变量的规范化......

感谢：
@Tyler Rinker 提供了在应用函数中使用列名的解决方案，以及
@Josh O'Brien 对这个问题的回答

[它可以在这里作为一个要点。](https://gist.github.com/2599463)

来自@Josh O'Brien 的数据与非因子变量

```
 df <- data.frame(
  name = rep(readLines(file.path(R.home("doc"), "AUTHORS"))[9:13], each=2),
  hiscore = runif(10, 99, 100),
  passwd = replicate(10, paste(sample(c(LETTERS, letters), 9), collapse="")))

df$passwd<-as.character(df$passwd) 
```

功能

```
anonym<-function(df){
  if(length(df)>26){
    LETTERS<-replicate(floor(length(df)/26),{LETTERS<-c(LETTERS, paste(LETTERS, LETTERS, sep=""))})
    }
    names(df)<-paste(LETTERS[1:length(df)])

    level.id.df<-function(df){
        level.id<-function(i){
      if(class(df[,i])=="factor" | class(df[,i])=="character"){
        column<-paste(names(df)[i],as.numeric(as.factor(df[,i])), sep=".")}else if(is.numeric(df[,i])){
          column<-df[,i]/mean(df[,i], na.rm=T)}else{column<-df[,i]}
          return(column)}
      DF <- data.frame(sapply(seq_along(df), level.id))
      names(DF) <- names(df)
      return(DF)}
    df<-level.id.df(df)
    return(df)}

anonym(df) 
```

结果：

```
 A                 B    C
1  A.1  1.00492190370171  C.8
2  A.1 0.997214883153158  C.2
3  A.2  1.00532434407094  C.5
4  A.2  1.00015775550051  C.6
5  A.3 0.998947207241593  C.3
6  A.3 0.998083738806433  C.4
7  A.5  1.00322085765279  C.7
8  A.5 0.995853096468764  C.1
9  A.4 0.998662338687036 C.10
10 A.4  0.99761387471706  C.9 
```

* * *

## 回答 #3

> 赞同：14
> 
> 时间：2012-05-04T20:30:04.953

如果您想要做的只是用匿名标签替换列名，同样地替换因子级别，是的。首先使用一些虚拟数据作为示例

```
dat <- data.frame(top_secret1 = rnorm(10), top_secret2 = runif(10),
                  top_secret3 = factor(sample(3, 10, replace = TRUE),
                                       labels = paste("Person", 1:3, sep = ""))) 
```

要替换列名，请执行以下操作：

```
dat2 <- dat
colnames(dat2) <- paste("Variable", seq_len(ncol(dat2)), sep = "") 
```

这使

```
> head(dat2)
   Variable1 Variable2 Variable3
1 -0.4858656 0.4846700   Person3
2  0.2660125 0.1727989   Person1
3  0.1595297 0.6413984   Person2
4  1.1952239 0.1892749   Person3
5  0.3914285 0.6235119   Person2
6  0.3752015 0.7057372   Person3 
```

接下来更改级别

```
foo <- function(x) {
    if(is.factor(x)) {
        levels(x) <- sample(LETTERS, length(levels(x)))
    }
    x
}
dat3 <- data.frame(lapply(dat2, foo)) 
```

这使

```
> head(dat3)
   Variable1 Variable2 Variable3
1 -0.4858656 0.4846700         K
2  0.2660125 0.1727989         G
3  0.1595297 0.6413984         O
4  1.1952239 0.1892749         K
5  0.3914285 0.6235119         O
6  0.3752015 0.7057372         K 
```

`foo()`只是传递向量的函数的简单包装器检查它是否是一个因子，如果是，则将级别更改为适当长度的随机字母向量，然后返回该向量。

我们可以将其包装成一个函数来完成所有请求的更改

```
anonymise <- function(df, colString = "Variable", rowString = "Sample") {
    foo <- function(x) {
        if(is.factor(x)) {
            levels(x) <- sample(LETTERS, length(levels(x)))
        }
        x
    }
    ## replace the variable names
    colnames(df) <- paste(colString, seq_len(ncol(df)), sep = "")
    ## fudge any factor levels
    df <- data.frame(lapply(df, foo))
    ## replace rownames
    rownames(df) <- paste(rowString, seq_len(nrow(df)), sep = "")
    ## return
    df
} 
```

在使用中，这给出了

```
> anonymise(dat)
           Variable1 Variable2 Variable3
Sample1  -0.48586557 0.4846700         F
Sample2   0.26601253 0.1727989         L
Sample3   0.15952973 0.6413984         N
Sample4   1.19522395 0.1892749         F
Sample5   0.39142851 0.6235119         N
Sample6   0.37520154 0.7057372         F
Sample7   1.18440762 0.7355211         F
Sample8   0.03605239 0.3924925         L
Sample9  -0.64078219 0.4579347         N
Sample10 -1.39680109 0.9047227         L 
```

# mysql - 从本地服务器传输后，Wordpress 站点不起作用（数据库问题？）

> ID：10454975
> 
> 赞同：1
> 
> 时间：2012-05-04T19:26:51.893
> 
> 标签：mysql, database, wordpress, phpmyadmin

我已经使用 MAMP 在本地开发了一个自定义 woocommerce 商店的自定义 WordPress 主题。它工作得很好。

我已将所有文件上传到服务器，修改了新数据库的配置文件。创建数据库，在 phpMyadmin 中从我的本地导出，然后将其导入在线服务器数据库。数据库是 16MB，所以它不能很好地作为一个文件或单独的表导入，所以我使用 bigdump 来导入它。看起来它有效。

之后，我将 URL 从新数据库的 phpMyadmin 的 wp_options 表中更改为新的 URL。

但是，该站点现在显示错误行，并且顶部缺少 WordPress 管理栏。除此之外，woocommerce 的 Products 选项卡缺失，插件管理区域为空。我也无法安装插件。等等'这一切都不能正常工作。

我猜这是数据库的错误传输，但我不知道。

[这是网站](https://www.livhaley.com)

```
Error lines examples:
Warning: array_merge(): Argument #2 is not an array in /usr/local/pem/vhosts/254369/webspace/httpsdocs/wp-content/plugins/wp-pagenavi/scb/Options.php on line 46 
```

还...

```
Warning: call_user_func_array(): First argument is expected to be a valid callback,

'woocommerce_demo_store' was given in /usr/local/pem/vhosts/254369/webspace/httpsdocs/wp-includes/plugin.php on line 405 
```

关于找出问题所在有什么建议吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-04T19:40:02.177

您不应该通过 phpMyAdmin 导出所有表来导入数据。在此过程中，您将覆盖为新的 wordpress 安装创建的表，并使用其自己的选项值（例如 siteurl、bloginfo 等）。

所以在新服务器上重新安装Wordpress，重新开始干净。不要覆盖它自动生成的表。

登录到您的开发 wordpress 仪表板，转到工具 > 导出并选择所有内容，包括所有链接文件。转到新的 Wordpress，转到工具 > 导入，选择 Wordpress，安装插件，选择你导出的文件，你应该都设置好了。

您将需要更新一些可能不会在您的帖子/页面中更新的 URL。您可能还需要更新代码中的 catid，因为导入的类别将获得新值。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-06T03:14:36.317

詹姆斯 - 关于导入错误，这是因为您尝试导入文件的服务器对其可以导入的文件大小有限制。

进入服务器的根文件夹（wp-content、wp-includes 等文件夹所在的那个），然后编辑当前存在的 php.ini 文件，或者上传一个新文件。您可以下载此示例文件：[http](http://www.reallylinux.com/docs/php.ini) ://www.reallylinux.com/docs/php.ini并上传。将 post_max_size 和 upload_max_filesize 值编辑为 50MB 或其他值：post_max_size = 50M

这将解决导入问题。

对于插件错误，从开发服务器的 wp-content 复制插件文件并将它们导入实时服务器，它应该可以工作。

# orm - ibatis TypeHandlerCallback 用于多列映射 - Money 对象

> ID：10454978
> 
> 赞同：1
> 
> 时间：2012-05-04T19:27:03.763
> 
> 标签：orm, callback, ibatis

Ibatis 多列数据映射到类型处理程序。我有一个我正在使用的货币对象，它需要价值和货币。如何将多个列映射到相同的回调类型处理程序？

Java Money 对象 [http://www.javapractices.com/topic/TopicAction.do?Id=13](http://www.javapractices.com/topic/TopicAction.do?Id=13)

```
public class MoneyTypeHandlerCallBack implements TypeHandlerCallback {

//The below works but problems it always defaults currency. I need to be able to get     Currency as well to use
// new Money(value, currency ) constructor
@Override
public Object getResult(final ResultGetter getter) throws SQLException {
        BigDecimal value = getter.getBigDecimal();
    if (value == null) {
        return null;
    }
    Money result = new Money(value); // I need to be able to do new Money (value, currency)
    return result;
}
... implment other...
} 
```

SomeView Bean 定义：

```
public class SomeView implements Serializable{

    private String companyName
    private Money netamount;

    // .....geters and setters etc
} 
```

SQLMAP 配置：

```
<sqlMap namespace="myspace">
<typeAlias alias="someView" type="com.my.view.someView" />
<resultMap id="some_detail_view" class="someView">
    <result property="companyName" column="COMPANY" />
    ...
    <result property="netamount" column="NET_AMT" />
    <result property="netamountCurrency" column="NET_AMT_CURRENCY" />
</resultMap>    
<select id="someView" parameterClass="java.util.Map" 
              resultClass="someView" resultMap="some_detail_view">
  SELECT COMPANY, NET_AMT, NET_AMT_CURRENCY From......
</select>
</sqlMap> 
```

# asp.net-mvc-3 - 实体框架 LINQ 插入命令失败。MVC3

> ID：10454981
> 
> 赞同：0
> 
> 时间：2012-05-04T19:27:34.427
> 
> 标签：asp.net-mvc-3, linq, entity-framework

您好我正在尝试使用 Linq 和实体框架基于 id 进行基本更新。我对此很陌生，但我没有看到问题所在。

我的实体类对象是在控制器级别声明的。

```
gwwbnEntities db = new gwwbnEntities(); 
```

该方法获取一个查询字符串 id 并更新由该 id 表示的用户的注册状态。

```
public ActionResult ConfirmedAccount(int id)
    {

        var q = from u in db.user_registration
                where u.id == id && u.reg_status == null
                select u;

        if (q.Any())
        {
            foreach(var item in q){

            user_registration user = item;
            user.reg_status = 202;
            db.Entry(user).State = EntityState.Modified;
            db.SaveChanges();
            }

            return View();
        }
        else
        {
            return RedirectToAction("RegistrationError");
        }
    } 
```

任何帮助将不胜感激！同样一切正常并正确填充，但上下文 object.SaveChanges() 方法每次都失败。

多谢你们！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-04T21:12:25.730

您看到的异常是因为您有一个开放的数据读取器 (foreach)，并且您正在尝试在 SaveChanges() 中创建事务（EF 为您完成）。在循环外调用 SaveChanges。另外：不要将状态设置为已修改 - EF 将检测到属性已更改并相应地自动设置状态。在做任何事情之前，您可能想在 q 上执行 .ToList() 。目前，您正在向数据库发送查询（一个用于 .Any()，一个用于获取实体）。如果你这样做 .ToList() 你将只发送一个带实体的查询，但 .Any() 将在列表上而不是在数据库上调用，因此它会更快，并且不会访问数据库。ToList() 还强制查询评估，因此您的 foreach 循环不会使数据读取器保持打开状态，因为它将在列表上进行迭代。

# android - 处理 Android/Google 地图中的无连接

> ID：10454983
> 
> 赞同：0
> 
> 时间：2012-05-04T19:27:40.637
> 
> 标签：android, google-maps

因此，我进行了连接测试并停止了对地图引脚的 JSON 调用。但是，即使这样做了，如果用户点击地图，应用程序也会崩溃。

它似乎在 Google API 的 maps.jar 中为触摸事件调用一个方法，但我无权访问这些对吗？

那么如何测试它或者有更好的方法来检查它？

```
public class Map_Activity extends MapActivity implements LocationListener {
/** Called when the activity is first created. */

MapView map;
private MyLocationOverlay me = null;
Drawable d;
List<Overlay> overlayList;
LocationManager lm;
String towers;
int lat;
int longi;

@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.map_activity);

    map = (MapView) findViewById(R.id.mapview);

    Touchy t = new Touchy();
    overlayList = map.getOverlays();
    overlayList.add(t);

    // //////////////////////////////////// Where the maps opens up to and
    // zoom
    map.getController().setCenter(getPoint(40.801531, -81.405661));
    map.getController().setZoom(15);

    Drawable marker = getResources().getDrawable(R.drawable.pin_yellow);

    marker.setBounds(0, 0, marker.getIntrinsicWidth(),
            marker.getIntrinsicHeight());

    map.getOverlays().add(new SitesOverlay(marker));

    me = new MyLocationOverlay(this, map);
    map.getOverlays().add(me);

    // d = getResources().getDrawable(R.drawable.pin_blue);

    // Geo Location of phone
    lm = (LocationManager) getSystemService(Context.LOCATION_SERVICE);
    Criteria crit = new Criteria();
    towers = lm.getBestProvider(crit, false);
    Location location = lm.getLastKnownLocation(towers);

    if (location != null) {
        lat = (int) (location.getLatitude() * 1E6);
        longi = (int) (location.getLongitude() * 1E6);
        // GeoPoint ourLocation = new GeoPoint(lat, longi);
        // OverlayItem overlayItem = new OverlayItem(ourLocation,
        // "Quit hitting your self", "");
        // CustomPinpoint custom = new CustomPinpoint(d, Map_Activity.this);
        // custom.insertPinpoint(overlayItem);
        // overlayList.add(custom);
    } else {
        // Toast.makeText(MapsActivity.this, "Couldn't get provider",
        // Toast.LENGTH_SHORT).show();
    }

    initLocation();
}

private void initLocation() {

    lm = (LocationManager) this.getSystemService(LOCATION_SERVICE);
    lm.requestLocationUpdates(LocationManager.GPS_PROVIDER, 5000, 500, this);
}

@Override
public void onResume() {
    super.onResume();
    me.enableCompass();
    lm.requestLocationUpdates(towers, 500, 1, this);
}

@Override
public void onPause() {
    super.onPause();
    me.disableCompass();
    lm.removeUpdates(this);
}

@Override
protected boolean isRouteDisplayed() {
    // TODO Auto-generated method stub
    return false;
}

class Touchy extends Overlay {
    public boolean onTouchEvent(MotionEvent e, MapView m) {

        return false;
    }
}

private GeoPoint getPoint(double lat, double lon) {
    return (new GeoPoint((int) (lat * 1000000.0), (int) (lon * 1000000.0)));
}

private class SitesOverlay extends ItemizedOverlay<OverlayItem> {
    private List<OverlayItem> items = new ArrayList<OverlayItem>();

    public SitesOverlay(Drawable marker) {
        super(marker);

        if (isNetworkAvailable() == true) {
            boundCenterBottom(marker);
            // //////////////////////////////////////////////////////////////////////
            String result = queryRESTurl("http://www.mywesite.com/json.json");
            Log.e("Spot 1", "");
            JSONObject json;
            JSONObject json2;
            // JSONObject data;
            try {
                json = new JSONObject(result);
                JSONArray nameArray = json.names();

                JSONArray valArray = json.toJSONArray(nameArray);

                for (int i = 0; i < valArray.length(); i++) {

                    Log.e(nameArray.getString(i), valArray.getString(i));
                    json2 = new JSONObject(valArray.getString(i));
                    JSONArray nameArray2 = json2.names();

                    JSONArray valArray2 = json2.toJSONArray(nameArray2);
                    for (int a = 0; a < valArray2.length(); a++) {

                        // add to maps here
                        items.add(new OverlayItem(getPoint(
                                valArray2.getDouble(3),
                                valArray2.getDouble(2)), valArray2
                                .getString(1), valArray2.getString(0)));
                        Log.e(nameArray2.getString(a),
                                valArray2.getString(a));
                    }
                }
            } catch (JSONException e) {
                // TODO Auto-generated catch block
                e.printStackTrace();
            }
            // Pin Locations

            populate();
        } else {
            AlertDialog.Builder ad = new AlertDialog.Builder(
                    Map_Activity.this);
            ad.setIcon(android.R.drawable.ic_dialog_alert);
            ad.setTitle("OH NO!");
            ad.setMessage("To view the latest information you need a data or wi-fi connection");
            ad.setPositiveButton("OK",
                    new DialogInterface.OnClickListener() {
                        public void onClick(DialogInterface dialog,
                                int which) {
                        }
                    });
            ad.show();
        }
    }

    @Override
    protected OverlayItem createItem(int i) {
        return (items.get(i));
    }

    @Override
    protected boolean onTap(int i) {
        // Toast.makeText(MapsActivity.this,
        // items.get(i).getSnippet(),Toast.LENGTH_SHORT).show();
        OverlayItem item = items.get(i);
        AlertDialog.Builder dialog = new AlertDialog.Builder(
                Map_Activity.this);
        dialog.setTitle(item.getTitle());
        dialog.setMessage(item.getSnippet());
        dialog.show();
        return (true);
    }

    @Override
    public int size() {
        return (items.size());
    }
}

public void onLocationChanged(Location l) {
    // TODO Auto-generated method stub
    List<Overlay> overlays = map.getOverlays();
    me = new MyLocationOverlay(this, map);
    overlays.add(me);
    me.enableMyLocation();
}

public void onProviderDisabled(String provider) {
    // TODO Auto-generated method stub

}

public void onProviderEnabled(String provider) {
    // TODO Auto-generated method stub

}

public void onStatusChanged(String provider, int status, Bundle extras) {
    // TODO Auto-generated method stub

}

public String queryRESTurl(String url) {
    HttpClient httpclient = new DefaultHttpClient();
    HttpGet httpget = new HttpGet(url);
    HttpResponse response;

    try {
        response = httpclient.execute(httpget);
        HttpEntity entity = response.getEntity();

        if (entity != null) {

            InputStream instream = entity.getContent();
            String result = RestClient.convertStreamToString(instream);
            instream.close();
            return result;
        }
    } catch (ClientProtocolException e) {
        Log.e("REST", "There was a protocol based error", e);
    } catch (IOException e) {
        Log.e("REST", "There was an IO Stream related error", e);
    }

    return null;
}

/*
 * Check for Connectivity
 */
public boolean isNetworkAvailable() {
    Context context = getApplicationContext();
    ConnectivityManager connectivity = (ConnectivityManager) context
            .getSystemService(Context.CONNECTIVITY_SERVICE);
    if (connectivity == null) {

    } else {
        NetworkInfo[] info = connectivity.getAllNetworkInfo();
        if (info != null) {
            for (int i = 0; i < info.length; i++) {
                if (info[i].getState() == NetworkInfo.State.CONNECTED) {
                    return true;
                }
            }
        }
    }
    return false;
}
} 
```

![在此处输入图像描述](../Images/dc49db660fad272a0144684c40e0af05.png)

# git - 与 git clone --depth HEAD 等效的 bzr 是什么

> ID：10454997
> 
> 赞同：3
> 
> 时间：2012-05-04T19:28:37.883
> 
> 标签：git, version-control, bazaar

我想知道如何`git clone --depth HEAD`处理 BZR，因为我不需要整个分支历史。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-04T19:41:05.893

Bazaar通过开关支持[轻量级结账。](http://doc.bazaar.canonical.com/development/en/user-guide/using_checkouts.html#getting-a-lightweight-checkout)`--lightweight`

```
bzr checkout --lightweight lp:openshot 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-04T19:50:12.243

您正在寻找的是 Bazaar 中的[轻量级结帐](http://doc.bazaar.canonical.com/beta/en/user-guide/using_checkouts.html#getting-a-lightweight-checkout)。

# objective-c - 每次给变量加 1

> ID：10454998
> 
> 赞同：0
> 
> 时间：2012-05-04T19:28:43.380
> 
> 标签：objective-c, xcode

我正在以编程方式创建（用户按下按钮）许多 UIImageViews，并在以这种方式创建时为每个 UIImageViews 分配一个标签：

```
 int a;

    if (a != nil){

        a = 0;
    }

    a = a + 1;
    image1.tag = a; 
```

问题是使用 a = a +1 我希望变量增加：1,2,3,4 ...但它始终保持为 1，因此每个图像都有一个标签 1。如果我添加 a++，标签2 分配给所有。为什么？？感谢你的回答

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-04T19:33:17.630

我假设`a`是一个`int`或其他一些原始类型。原始类型**永远不会**存在`nil`（好吧，是的，`nil`在技术上是这样`(void *)0`，但我们甚至不要去那里。你不应该使用`nil`原始类型。）；只有一个对象可以`nil`。所以，

```
if (a != nil) 
```

除非为零，否则将**始终**为真，因此每次都将设置回零。`a``a`

编辑：您还在`a`方法调用的范围内声明，因此每次都会重新创建它。将其移至合成属性。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-04T19:45:35.213

这是假设 a 是一个简单的类型。

首先，您永远不应该像这样比较简单的类型；

```
 if (a != nil){
    a = 0;
} 
```

但是，在按下第一个按钮后，上面的 if 语句将始终为真，因为 a 将 > 0，因此不会计算为 NULL。因此，您的 if 语句将始终将 a 重置为零。如果您希望标签递增，请删除该 if 语句。

假设 a 不是简单类型。

创建一个 int 并删除 if 语句。这是一些支持代码。

```
`@implementation ViewController{
    int a;
}
-(void)pressed{
    a = a + 1;
    NSLog(@"%d",a);
}
- (void)viewDidLoad{
    [super viewDidLoad];
    a = 0;
    UIButton * b = [UIButton buttonWithType:UIButtonTypeRoundedRect];
    b.frame = CGRectMake(0, 0, 100, 50);
    [b addTarget:self action:@selector(pressed) forControlEvents:UIControlEventTouchUpInside];
    [self.view addSubview:b];
}
@end` 
```

* * *

 `## 回答 #3

> 赞同：0
> 
> 时间：2012-05-04T19:33:57.617

`nil`等于 0。所以在方法的开头，如果`a`不是 0，则将其设置为 0，然后将其递增。完全取消 nil 检查，它应该可以工作。`