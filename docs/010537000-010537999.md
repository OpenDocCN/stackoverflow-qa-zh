# StackOverflow 问答 10537000-10537999

# jquery - 不使用 getJson() 将 Json 字符串传递给 JQuery

> ID：10537000
> 
> 赞同：1
> 
> 时间：2012-05-10T15:10:39.683
> 
> 标签：jquery, json, jqplot

`JSON`和都非常新`jQuery`，但这是我想要做的 - 我将一个`JSON`字符串作为更大的报告模型的一部分返回到我的网页，以便在生成报告的同时创建多个图表（使用`jqPlot`） .

为了练习这些图表，我使用了以下教程 -[教程](http://depblog.weblogs.us/2009/08/31/charts-with-asp-net-mvc-and-jquery-through-jqplot/)

这是`jQuery`本教程的内容-

```
jQuery(document).ready(function() {
    urlDataJSON = '/Graph/HearthRateDataJSON';

    $.getJSON(urlDataJSON, "", function(data) {
        var dataLines = [];
        var dataLabels = "";
        $.each(data, function(entryindex, entry) {
            dataLines.push(entry['Serie']);
            dataLabels = dataLabels + entry['Name'];
        });

        Plot(dataLines, dataLabels);
    });
});

function Plot(dataLines, dataLabels) {
    var line1 = "{ label: 'line1.0' }";
    options = {
        legend: { show: true },
        title: 'Heart rate overview',
        axesDefaults: { pad: 1 },
        seriesDefaults: { showMarker: false, trendline: { show: false }, lineWidth: 3 },
        axes: {
            yaxis: { min: 0, autoscale: true, label: 'HR[bpm]', labelRenderer: $.jqplot.CanvasAxisLabelRenderer },
            xaxis: { autoscale: true, label: 'Time', labelRenderer: $.jqplot.CanvasAxisLabelRenderer }
        }
    };

    //Data from database is already an array!
    plot = $.jqplot('chartdiv', dataLines, options);

    plot.redraw(); // gets rid of previous axis tick markers
} 
```

为了检索`JSON`数据，本教程使用 getJson() 方法指向一个链接。我已经`JSON`准备好将字符串传递给`jQuery`但是，例如

```
[
    {"Name":"Patient","Serie":[[1,4],[2,25],[3,7],[4,14],[5,13]]},
    {"Name":"Test","Serie":[[1,13],[2,5],[3,7],[4,20],[5,17]]}
] 
```

在`jqPlot`示例中，它们通过如下方式传递硬编码数据：

```
$(document).ready(function(){
  var plot1 = $.jqplot ('chart1', [[3,7,9,1,4,6,8,2,5]]);
}); 
```

但是，我自动生成`JSON`的字符串有花括号等。有没有办法在`jQuery`不使用 getJson 方法的情况下将其传递给？

编辑饼图jQuery代码

```
 $(document).ready(function () {
        var data4 = '[{ "Label": "Car", "Value": 9 },{ "Label": "Bus", "Value": 2 },{ "Label": "Train", "Value": 7 },{ "Label": "Plane", "Value": 8 },{ "Label": "Boat", "Value": 4 }]';

        var data = $.parseJSON(data4);

        var plot1 = jQuery.jqplot('pieChart', [data],
    {
        seriesDefaults: {
            // Make this a pie chart.
            renderer: jQuery.jqplot.PieRenderer,
            rendererOptions: {
                // Put data labels on the pie slices.
                // By default, labels show the percentage of the slice.
                showDataLabels: true
            }
        },
        legend: { show: true, location: 'e' }
    }
  );
    }); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-10T15:14:08.747

使用 parseJSON：

```
 var plotline =  $.parseJSON(jsonstring); 
```

这将像 getJSON 一样工作，只是您可以传递字符串，而不是获取 url。

[http://api.jquery.com/jQuery.parseJSON/](http://api.jquery.com/jQuery.parseJSON/)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-10T15:15:21.117

也可以使用浏览器的原生`JSON.parse`方法

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-05-10T15:43:30.807

您可以使用其他答案中提供的任何建议方法对其进行解析，然后使用它。或者只是简单地使用`JSON`您拥有的数据，因为它是一个数组，并且都`{}`被视为地图。因此，您可以直接使用它们而无需任何解析[，就像我在此处提供的代码中所示的类似情况中所做的那样。](http://jsfiddle.net/cVPjF/7/)

在提供的示例中，`JSON`数据编码在名为 json 的变量中。

```
var json = [{
    "Name": "Poll Results",
    "Serie": [[2, 5, 4], [4, 1, 7], [6, 3, 1], [3, 4, 2]]}];
var dataLines = json[0].Serie;
var title = json[0].Name; 
```

然后在最后将`dataLines`变量传递给图表。

**编辑**

在玩了你提供的样本后，我得出了以下结论。显然，给定的数据不是 jQuery 的 parseJSON 方法可以使用的 JSON 格式。但是，当您将其[字符串化](https://gist.github.com/754454)时，它会起作用。

[在对数据应用 stringify 后，我的示例显示它工作正常。](http://jsfiddle.net/3cbVW/3/)

我尝试将您的 JSON 包装在内部，并将其转换为等效的 String`''`并且它起作用了。所以答案很简单，`parseJSON`你必须传递一个字符串而不是任何其他类型的对象。

# python - python 对我的构造函数参数做了什么？

> ID：10537002
> 
> 赞同：0
> 
> 时间：2012-05-10T15:10:50.743
> 
> 标签：python, inheritance, constructor, python-3.x

好的，我认为这样的代码不会出错，但它显然会：

```
somewhere:
    # p is a float value between 0 and 1
    m.limit=PidRange(p-1.0, p+1.0)

class PidRange(Range):
    def __init__(self, low, up):
        Range.__init__(low,up,...)
        pass
    # some methods definition for the PidRange sub-class

class Range(object):
    def __init__(self, p_min=None, p_max=None, ...):
        if (p_min > p_max):
             raise ValueError("Range can't be created: the low bound %f exceeds high bound %f."%(p_min,p_max)) 
```

我只是想用一些类层次结构初始化一个 [min,max] 范围。但是由于一些完全奇怪的原因， p=0.888337 会引发以下异常：

```
 File "src/__main__.py", line 155, in __find_data
        m.limit=PidRange(p-1.0, p+1.0)
    File "src/routing.py", line 32, in __init__
       Range.__init__(low, up, low!=None, up!=None)
    File "src/equation.py", line 30, in __init__
       raise ValueError("Range can't be created: the low bound %f exceeds high bound %f."%(p_min,p_max))
    ValueError: Range can't be created: the low bound 1.888337 exceeds high bound 1.000000. 
```

有人知道发生了什么吗？我不得不承认我离掌握 Python 语言还很远，但我看不到任何可以解释这种奇怪行为的微妙之处。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-10T15:14:41.710

啊。想通了。

*   缺少对超类`self`的`__init__`调用
*   1.000 'extra value' 是从 ... 转换为浮点数的 True

所以超类构造函数调用“破坏”了调用模型并需要显式的自引用，对吧？

# android - 在创建 android 通知时，在 PendingIntent 中使用 FLAG_UPDATE_CURRENT 时会重复意图额外内容

> ID：10537006
> 
> 赞同：19
> 
> 时间：2012-05-10T15:11:01.947
> 
> 标签：android, android-intent, notifications

我想创建几个启动活动（或刷新活动）以显示产品描述的通知。

```
Notification notification = new Notification(R.drawable.applicationicon,
            Resources.getString("NewSaleNotification", context),
            System.currentTimeMillis());
// Hide the notification after its selected
notification.flags |= Notification.FLAG_AUTO_CANCEL;

Intent intent = new Intent(context, MainApplication.class);
intent.putExtra("saleid", saleid);

// to be sure the activity won't be restarted
intent.setFlags(Intent.FLAG_ACTIVITY_SINGLE_TOP);

PendingIntent pendingIntent = PendingIntent.getActivity(context, 0, intent,
            PendingIntent.FLAG_UPDATE_CURRENT);
notification.setLatestEventInfo(context, SaleTitle, SaleMessage, pendingIntent);
notificationManager.notify(saleid, notification); 
```

当我创建 PendingIntent 时，我有 4 个选择：FLAG_CANCEL_CURRENT、FLAG_NO_CREATE、FLAG_ONE_SHOT 和 FLAG_UPDATE_CURRENT。

最后一个（[http://developer.android.com/reference/android/app/PendingIntent.html#FLAG_UPDATE_CURRENT](http://developer.android.com/reference/android/app/PendingIntent.html#FLAG_UPDATE_CURRENT)）的定义是我想要做的，但它不能正常工作。如果我创建 2 个通知，它们都具有相同的“saleid”额外信息，这是最新的。如何使用不同的“saleid”额外发出多个通知？

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2012-05-10T16:37:26.293

> 但它不能正常工作

是的，它确实。

> 如果我创建 2 个通知，它们都具有相同的“saleid”额外信息，这是最新的。

这正是[文档](http://developer.android.com/reference/android/app/PendingIntent.html#FLAG_UPDATE_CURRENT)所说的应该发生的事情。

> 如何使用不同的“saleid”额外发出多个通知？

选项 #1：在每个`Intents`. 这将使它们不同（从 的角度来看`filterEquals()`）并将它们分开`PendingIntents`。但是，由于您在`Intent`( `MainApplication.class`) 中指定组件，因此该操作不会影响`Intent`路由的方式。

选项 #2：在您的调用中使用不同的`requestCode`（第二个参数） 。`getActivity()`虽然这被记录为“当前未使用”，但它确实会导致`PendingIntent`返回不同的对象。但是，由于此行为未记录在案，因此将来可能会发生变化。

# java - Java URI 类文件位置

> ID：10537008
> 
> 赞同：0
> 
> 时间：2012-05-10T15:11:09.217
> 
> 标签：java, eclipse, uri, workspace, home-directory

为什么这段 java 代码在我的主目录中查找文件？为什么它不在我的 Eclipse 工作区（/home/ *user* /eclipse/workspace/）中？

```
import org.eclipse.emf.common.util.URI;

URI uri = null;
try {
    uri = URI.createURI("../models/task.cm");
    Resource resource = resourceSet.getResource(uri, true);
... 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-10T15:16:37.933

它不应该在工作区目录中查找文件。`..`它应该在当前工作目录的父目录中查找文件（因为路径以 开头 ）。从 Eclipse 运行时的当前工作目录是项目的目录。

我猜你的项目在你的主目录下，所以这就是原因。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-10T15:19:18.973

事实上，它是。在基于 Unix 的 shell 中，“..”代表当前工作目录之上的目录。因此，它实际上是在 Eclipse 程序周围的文件夹中查找，或者正在运行的任何东西。

家将由“//home”表示

当前工作目录由“.”的值表示。

用户目录用“~”表示

最后，根由“/”表示

例如：

```
Macintosh-2:/ Administration$ cd ~ #!sends me from root to my user directory
Macintosh-2:~ Administration$ cd ../Administration #!sends me from my user directory, to the directory above it, then back down 
Macintosh-2:~ Administration$ cd Administration #!user directory doesn't exist inside my user directory, thus showing ".." represents the directory above the current working one.
-bash: cd: Administration: No such file or directory
Macintosh-2:~ Administration$ cd .. #!moves up a directory
Macintosh-2:Users Administration$ #!now working in surrounding directory. 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-10T15:20:03.457

获取资源

资源 getResource(URI uri, boolean loadOnDemand)

```
Returns the resource resolved by the URI. 
```

为了将给定的 URI 解析为资源，资源集应实现以下策略。首先它使用它的 URI 转换器对 URI 进行规范化，然后将其与每个资源的规范化 URI 进行比较；如果找到匹配项，则该资源将成为结果。如果做不到这一点，它会授权允许在其他地方解析 URI。例如，包注册表用于将包的名称空间 URI 解析为该包的静态实例。所以重要的一点是，任意实现可以将 URI 解析为任何资源，不一定是这个特定资源集包含的资源。如果委托步骤未能提供结果，并且 loadOnDemand 为真，则创建资源并且该资源成为结果。

```
Parameters:
    uri - the URI to resolve.
    loadOnDemand - whether to create and load the resource, if it doesn't 
    already exists. 
Returns:
    the resource resolved by the URI, or null if there isn't one and it's not 
    being demand loaded. 
Throws:
    java.lang.RuntimeException - if a resource can't be demand created. 
    WrappedException - if a problem occurs during demand load. 
```

因此，找不到资源，并且在您的主目录中创建了任意资源。

# python - 在将解析的 XML 写入文件之前存储它的最佳方法是什么？

> ID：10537009
> 
> 赞同：-1
> 
> 时间：2012-05-10T15:11:11.273
> 
> 标签：python, xml-parsing

我一直在研究一个[Python 脚本](http://pastebin.com/D9DkQdEv)来解析[XML](http://pastebin.com/vRRxfWiA)并从中创建一个新文件。下面是 XML 结构的简单概述：

```
<script>
    <stage id="stage1">
        <init>
            <variable id="year" value="2012" type="Integer"/>
            <variable id="femaleCloseDate" value="06/04/1955" type="Date"/>
            <variable id="runFemaleCheck" value="True" type="Boolean"/>
            <if>
                <condition><![CDATA[$gender$ == "F"]]></condition>
                <then>
                    <executeMethod class="engineclass_validation" method="femaleCheck">
                        <arguments>
                            <variable id="dob"/>
                            <variable id="femaleAgeBracket"/>
                            <variable id="todaysDate"/>
                        </arguments>
                        <return>
                            <variable id="femalePensionAgeCheck"/>
                        </return>
                    </executeMethod>
                </then>
            </if>
        </init>
        <execute>
            # same stuff as init
        </execute>
    </stage> 
```

这样做的问题是它只是一次读取每一行并根据标签输出该行。如何为每个元素存储数据以便在读取所有内容后使用它？

我想我可以有两个类，一个用于解析 XML，另一个用于使用解析期间存储的所有信息为每个阶段创建一个文件。

解析 XML 没有问题，因为我已经在使用它，但是我如何存储解析的内容并像这样输出它，而不是一次从 XML 中输出一行；

```
if gender == F:
    import engineclass_database
    eeid = engineclass_validation.femaleCheck(dob, femaleAgeBracket, todaysDate)
else: 
```

这最好用字典来完成吗？那么如何访问来自每个类/函数外部的所有这些单独集合的数据？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-10T15:14:21.960

使用 xml 解析器（我建议使用 lxml）来加载您的 xml，并创建新的 DOM 树。

# google-docs - Google 应用脚本计数变量（合并）

> ID：10537014
> 
> 赞同：0
> 
> 时间：2012-05-10T15:11:20.277
> 
> 标签：google-docs, google-docs-api, google-sheets, google-apps-script

我试图在谷歌电子表格中计算谷歌应用程序脚本中的一些变量。这不像我想的那样工作。代码是：

```
for(var n in namen) {
      var naam = namen[n];
      var nr = n;
      if(w == 1) {
        var nr = 3+n;
      } if(w == 2) {
        var nr = 17+n;
      } if(w == 3) {
        var nr = 31+n;
      } if(w == 4) {
        var nr = "45"+n;
      } if(naam == title){
        ssRooster.getRange(nr, col, 1, 1).setValue(dateStr);
        var nr = n;
      }
    } 
```

或者代码是：

```
 } if(naam == title){
            ssRooster.getRange(n+row, col, 1, 1).setValue(dateStr);
          } 
```

应该没问题，但我现在得到 n 中的数字可以说 2，行中的数字可以说 17。它现在的结果是 217 而不是 19。我该如何解决这个问题？

更喜欢其中包含行的代码。（更干净）

谢谢丹尼斯

[编辑] 完整的代码是：

```
function LoadWorkTime() {
  var ss = SpreadsheetApp.getActiveSpreadsheet();
  var Period = Browser.inputBox("Periode","Welke periode wilt U zien. (kies tussen de 1 en de 12.)", Browser.Buttons.OK);
  var ErrorPeriod = "De periode die U invoert is onjuist!";
  if(Period>12){
    Browser.msgBox(ErrorPeriod);
    return;
  } if(Period<1){
    Browser.msgBox(ErrorPeriod);
    return;
  }
  var ssPeriode = ss.setActiveSheet(ss.getSheets()[1]);
  var ThisYear = ssPeriode.getRange(2, 1, 1, 1).getValue();
  var CheckYear = Browser.msgBox("Jaar","Is het jaar " + ThisYear + " het jaar dat U wilt opvragen.", Browser.Buttons.YES_NO);
  if(CheckYear=="yes") {
    var CheckYear = ThisYear;
  } else {
    var PastYear = ThisYear-1;
    var AfterYear = ThisYear-0+1;
    var CheckYear = Browser.inputBox("Jaar", "Vul in jaar tal in tussen " + PastYear + " en " + AfterYear, Browser.Buttons.OK);
    var ErrorYear = "Het jaar wat U heeft ingevuld is onjuist!";
    if(CheckYear>PastYear){
      Browser.msgBox(ErrorYear);
      return;
    } if(CheckYear<AfterYear){
      Browser.msgBox(ErrorYear);
      return;
    }
  }
  ssPeriode.getRange(1, 1, 1, 1).setValue(Period);
  ssPeriode.getRange(3, 1, 1, 1).setValue(CheckYear);
  var ssRooster = ss.setActiveSheet(ss.getSheets()[0]);
  var calRooster = CalendarApp.getCalendarById("0000@group.calendar.google.com");
  var calVakantie = CalendarApp.getCalendarById("0000@group.calendar.google.com");
  var dateRow = 2
  var row = 3;
  for(var w = 1; w <= 4; ++w) {
    var col = 2;
    var namen = ssRooster.getRange(3, 1, 10, 1).getValues();
    for(var d = 1; d <= 7; ++d) {
      var eventdate = ssPeriode.getRange(dateRow, 2, 1, 1).getValue();
      var eventsRooster = calRooster.getEventsForDay(new Date(eventdate));
      var dateRow = dateRow+1;
      for(var e in eventsRooster) {
        var event = eventsRooster[e];
        var title = event.getTitle();
        var dateStr = event.getStartTime();
        Browser.msgBox(title);
        for(var n in namen) {
          var naam = namen[n];
          Browser.msgBox(naam);
        } 
        if(naam == title){
          ssPeriode.getRange(5, 1, 1, 1).setFormula('=' + n + '+' + row);
          var nr = ssPeriode.getRange(5, 1, 1, 1).getValue();
          ssRooster.getRange(nr, col, 1, 1).setValue(dateStr);
        }
      }
      var col = col+2;
    }
    var row = row+14;
  }
} 
```

我不能做这个工作！在我看来，这是一个很好的代码。要亲自尝试，请运行此安装代码并更改您拥有的日历地址。

```
 function Install() {
  var ss = SpreadsheetApp.getActiveSpreadsheet();

  var ssPeriode = ss.setActiveSheet(ss.getSheets()[1]);
  var Wt = 1;
  ssPeriode
  ssPeriode.deleteColumns(2, ssPeriode.getMaxColumns()-1);
  ssPeriode.deleteRows(2, ssPeriode.getMaxRows()-1);
  ssPeriode.clear();
  ssPeriode.clearContents();
  ssPeriode.clearFormats();
  ssPeriode.insertColumnsAfter(1, 1);
  ssPeriode.insertRows(1, 35);
  ssPeriode.getRange(1, 1, 4, 1).setValues([["1"], [""], ["2012"], ["3-1-2000"]]);
  ssPeriode.getRange(2, 1, 1, 1).setFormula('=TEXT(NOW(); "yyyy")');
  ssPeriode.getRange(1, 2, 1, 1).setFormula('=A1');
  ssPeriode.getRange(2, 2, 1, 1).setFormula('=(A3-2000)*364+((B1-1)*28)+A4');
  for(var i = 3; i <= 29; ++i) {
    var c = i-1;
    ssPeriode.getRange(i, 2, 1, 1).setFormula('=B' + c + '+1');
  }
  var c = 2;
  for(var i = i+1; i <= 34; ++i) {
    ssPeriode.getRange(i, 1, 1, 1).setFormula('=SPLIT(TEXT(B' + c + ';"yyyy-ww");"-")');
    var c = c+7;
  }

  var ssRooster = ss.setActiveSheet(ss.getSheets()[0]);
  var Wt = 1;
  var week = 31;
  var dag = 2;
  var nm = 3;
  ssRooster.deleteColumns(2, ssRooster.getMaxColumns()-1);
  ssRooster.deleteRows(2, ssRooster.getMaxRows()-1);
  ssRooster.clear();
  ssRooster.clearContents();
  ssRooster.clearFormats();
  ssRooster.insertColumnsAfter(1, 14);
  ssRooster.insertRows(1, 56);
  for(var col = 1; col <= ssRooster.getMaxColumns(); ++col) {
    ssRooster.setColumnWidth(col, 60);
    if(col == 1) {
      ssRooster.setColumnWidth(col, 80);
    }
  }
  for(var i = 1; i <= 4; ++i) {
    ssRooster.getRange(Wt, 1, 13, 15).setBorder(true, true, true, true, false, false);
    ssRooster.getRange(Wt, 1, 2, 15).setBorder(true, true, true, true, false, false);
    ssRooster.getRange(Wt+2, 1, 11).setNumberFormat("H:mm")
    ssRooster.getRange(Wt, 1, 1, 1).setFormula('=JOIN(P1;"Week ";P1;Periode!B' + week + ')');
    var week = week+1;
    var col = 2;
    for(var j = 1; j <= 7; ++j) {
      ssRooster.getRange(Wt, col, 2, 2).setBorder(true, true, true, true, false, false);
      ssRooster.getRange(Wt+2, col, 11, 2).setBorder(true, true, true, true, false, false);
      ssRooster.getRange(Wt, col, 1, 2).merge();
      ssRooster.getRange(Wt, col, 1, 1).setFormula('=CHOOSE(WEEKDAY(Periode!B' + dag + ';2);"Maandag ";"Dinsdag ";"Woensdag ";"Donderdag ";"Vrijdag ";"Zaterdag ";"Zondag ")&DAY(Periode!B' + dag + ')&CHOOSE(MONTH(Periode!B' + dag + ');" jan";" feb";" mrt";" apr";" mei";" jun";" jul";" aug";" sep";" okt";" nov";" dec")');
      var dag = dag+1;
      var col = col+2;
    }
    var Wt = Wt+1;
    ssRooster.getRange(Wt, 1, 1, 15).setValues([["Naam", "van", "tot", "van", "tot", "van", "tot", "van", "tot", "van", "tot", "van", "tot", "van", "tot"]]);
    for(var k = 1; k <= 6; ++k) {
      var Wt = Wt+1;
      ssRooster.getRange(Wt, 1, 1, 15).setBackground('yellow');
      var Wt = Wt+1;
    }
    var Wt = Wt-12;
    if( i == 1) {
      var Wt = Wt+13;
    }
    if( i >= 2) {
      for(var k = 1; k <= 11; ++k) {
        var Wt = Wt+1;
        ssRooster.getRange(Wt, 1, 1, 1).setFormula('=A' + nm);
        var nm = nm+1;

      }
      var Wt = Wt+1;
      ssRooster.getRange(Wt, 1, 1, 15).setBorder(true, false, true, false, false, false);
      var Wt = Wt+1;
      var nm = nm+3;
    }
  }
  ssRooster.getRange(Wt, 1, 1, 15).clearFormat();
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-11T14:45:05.077

您还可以使用`var nr = new Number(n);`来确保 nr 是一个整数。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-10T15:30:01.967

I am not sure if I understand but I think the solution is to insure nr is an integer:

```
var nr = parseInt(n); 
```

and do not use quotes in var nr = "45"+n;

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-12T12:17:46.830

我现在将数字写入一个单元格，让第三个单元格计数并调用它。代码现在已经启动并运行，旧代码需要一些修改才能让它工作。

现在一切正常。

# php - 使用 php 从搜索词中获取 imdb 海报图片

> ID：10537015
> 
> 赞同：0
> 
> 时间：2012-05-10T15:11:23.333
> 
> 标签：php, imdb

我想从搜索词中使用来自 imdb 的 php 获取海报图片 url。例如，我有搜索词 21 Jump Street，我想取回图像 ur 或仅 imdb 电影 url。使用下面的代码，我只需要从搜索词中检索电影的 url

这是我的代码

```
<?php

    include("simple_html_dom.php");

//url to imdb page
$url = 'hereistheurliwanttogetfromsearch';

//get the page content
$imdb_content = file_get_contents($url);

$html = str_get_html($imdb_content);

$name = $html->find('title',0)->plaintext;

$director = $html->find('a[itemprop="director"]',0)->innertext;

$plot = $html->find('p[itemprop="description"]',0)->innertext;

$release_date = $html->find('time[itemprop="datePublished"]',0)->innertext;

$mpaa = $html->find('span[itemprop="contentRating"]',0)->innertext;

$run_time = $html->find('time[itemprop="duration"]',0)->innertext;

$img = $html->find('img[itemprop="image"]',0)->src;

$content = "";

//build content
$content.= '<h2>Film</h2><p>'.$name.'</p>';
$content.= '<h2>Director</h2><p>'.$director.'</p>';
$content.= '<h2>Plot</h2><p>'.$plot.'</p>';
$content.= '<h2>Release Date</h2><p>'.$release_date.'</p>';
$content.= '<h2>MPAA</h2><p>'.$mpaa.'</p>';
$content.= '<h2>Run Time</h2><p>'.$run_time.'</p>';
$content.= '<h2>Full Details</h2><p><a href="'.$url.'" rel="nofollow">'.$url.'</a></p>';
$content.= '<img src="'.$img.'" />';

echo $content;

?> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-10T22:23:00.070

使用 Kasper Mackenhauer Jacobsenless 建议的 API 可以得到更完整的答案：

```
$url = 'http://www.imdbapi.com/?i=&t=21+jump+street';

$json_response = file_get_contents($url);
$object_response = json_decode($json_response);

if(!is_null($object_response) && isset($object_response->Poster)) {
        $poster_url = $object_response->Poster;
        echo $poster_url."\n";
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-10T16:00:10.923

使用正则表达式进行解析很糟糕，但其中几乎没有什么可以破坏的。建议使用 curl 因为它更快，您可以屏蔽您的用户代理。

从搜索中获取图像的主要问题是您首先需要知道 IMDB ID，然后您才能加载页面并翻录图像 url。希望能帮助到你

```
<?php 
//Is form posted
if($_SERVER['REQUEST_METHOD']=='POST'){
    $find = $_POST['find'];

    //Get Imdb code from search
    $source = file_get_curl('http://www.imdb.com/find?q='.urlencode(strtolower($find)).'&s=tt');
    if(preg_match('#/title/(.*?)/mediaindex#',$source,$match)){
        //Get main page for imdb id
        $source = file_get_curl('http://www.imdb.com/title/'.$match[1]);
        //Grab the first .jpg image, which is always the main poster
        if(preg_match('#<img src=\"(.*).jpg\"#',$source,$match)){
            $imdb=$match[1];
            //do somthing with image
            echo '<img src="'.$imdb.'" />';
        }
    }
}

//The curl function
function file_get_curl($url){
(function_exists('curl_init')) ? '' : die('cURL Must be installed');
$curl = curl_init();
$header[0] = "Accept: text/xml,application/xml,application/xhtml+xml,";
$header[0] .= "text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5";
$header[] = "Cache-Control: max-age=0";
$header[] = "Connection: keep-alive";
$header[] = "Keep-Alive: 300";
$header[] = "Accept-Charset: ISO-8859-1,utf-8;q=0.7,*;q=0.7";
$header[] = "Accept-Language: en-us,en;q=0.5";
$header[] = "Pragma: ";

curl_setopt($curl, CURLOPT_URL, $url);
curl_setopt($curl, CURLOPT_USERAGENT, 'Mozilla/5.0 (Windows NT 5.1; rv:5.0) Gecko/20100101 Firefox/5.0 Firefox/5.0');
curl_setopt($curl, CURLOPT_HTTPHEADER, $header);
curl_setopt($curl, CURLOPT_HEADER, true);
curl_setopt($curl, CURLOPT_REFERER, $url);
curl_setopt($curl, CURLOPT_ENCODING, 'gzip,deflate');
curl_setopt($curl, CURLOPT_AUTOREFERER, true);
curl_setopt($curl, CURLOPT_RETURNTRANSFER, true);
curl_setopt($curl, CURLOPT_TIMEOUT, 5);
curl_setopt($curl, CURLOPT_SSL_VERIFYPEER, false);

$html = curl_exec($curl);

$status = curl_getinfo($curl);
curl_close($curl);

if($status['http_code'] != 200){
    if($status['http_code'] == 301 || $status['http_code'] == 302) {
        list($header) = explode("\r\n\r\n", $html, 2);
        $matches = array();
        preg_match("/(Location:|URI:)[^(\n)]*/", $header, $matches);
        $url = trim(str_replace($matches[1],"",$matches[0]));
        $url_parsed = parse_url($url);
        return (isset($url_parsed))? file_get_curl($url):'';
    }
    return FALSE;
}else{
    return $html;
}
}
?>
<form method="POST" action="">
<p><input type="text" name="find" size="20"><input type="submit" value="Submit"></p>
</form> 
```

# delphi - 如何在 VirtualTreeView 中为混合单元格与背景图像着色？

> ID：10537016
> 
> 赞同：6
> 
> 时间：2012-05-10T15:11:24.987
> 
> 标签：delphi, delphi-7, virtualtreeview, tvirtualstringtree

我正在使用 VT.Background 在 VT 中显示带有几列的背景图像。
但我找不到为单元格使用不同颜色的方法，因为它们隐藏了背景图像。

我曾尝试使用`OnBeforeItemErase`，但如果我使用`EraseAction := eaColor`单元格上的背景位图区域也会被绘制，如果我使用`eaDefault`颜色则不会被应用。

知道如何做到这一点吗？

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2012-05-10T15:42:26.167

只是尝试猜测这是否是您要查找的内容：

***更新：***
为非 MMX CPU 机器添加了颜色混合功能。

```
procedure ColorBlend(const ACanvas: HDC; const ARect: TRect;
  const ABlendColor: TColor; const ABlendValue: Integer);
var
  DC: HDC;
  Brush: HBRUSH;
  Bitmap: HBITMAP;
  BlendFunction: TBlendFunction;
begin
  DC := CreateCompatibleDC(ACanvas);
  Bitmap := CreateCompatibleBitmap(ACanvas, ARect.Right - ARect.Left,
    ARect.Bottom - ARect.Top);
  Brush := CreateSolidBrush(ColorToRGB(ABlendColor));
  try
    SelectObject(DC, Bitmap);
    Windows.FillRect(DC, Rect(0, 0, ARect.Right - ARect.Left,
      ARect.Bottom - ARect.Top), Brush);
    BlendFunction.BlendOp := AC_SRC_OVER;
    BlendFunction.BlendFlags := 0;
    BlendFunction.AlphaFormat := 0;
    BlendFunction.SourceConstantAlpha := ABlendValue;
    Windows.AlphaBlend(ACanvas, ARect.Left, ARect.Top,
      ARect.Right - ARect.Left, ARect.Bottom - ARect.Top, DC, 0, 0,
      ARect.Right - ARect.Left, ARect.Bottom - ARect.Top, BlendFunction);
  finally
    DeleteObject(Brush);
    DeleteObject(Bitmap);
    DeleteDC(DC);
  end;
end;

procedure TForm1.VirtualStringTree1BeforeCellPaint(Sender: TBaseVirtualTree;
  TargetCanvas: TCanvas; Node: PVirtualNode; Column: TColumnIndex;
  CellPaintMode: TVTCellPaintMode; CellRect: TRect; var ContentRect: TRect);
var
  BlendColor: TColor;
  BlendValue: Integer;
begin
  if CellPaintMode = cpmPaint then
  begin
    case Column of
      0: BlendColor := $000080FF;
      1: BlendColor := $0046C2FF;
      2: BlendColor := $0046F5FF;
    end;
    BlendValue := 145;
    if not VirtualTrees.MMXAvailable then
      ColorBlend(TargetCanvas.Handle, CellRect, BlendColor, BlendValue)
    else
      VirtualTrees.Utils.AlphaBlend(0, TargetCanvas.Handle, CellRect, Point(0, 0),
        bmConstantAlphaAndColor, BlendValue, ColorToRGB(BlendColor));
  end;
end; 
```

上面的代码预览：

![在此处输入图像描述](../Images/c8c8c1de260acd1c46931f381d699430.png)

# jsf-2 - 托管 Bean 注释在 JSF 2.0 中不起作用

> ID：10537023
> 
> 赞同：0
> 
> 时间：2012-05-10T15:11:42.337
> 
> 标签：jsf-2, jboss, managed-bean

我在 bean 中遇到了一个奇怪的注释问题。

**index.xhtml**内容：

`<h:outputText value="#{ejb.helloWorld}" />`

**Ejb.java**内容：

```
package bean;

import java.io.Serializable;
import javax.faces.bean.ManagedBean;
import javax.faces.bean.SessionScoped;

    @ManagedBean(name="ejb")
    @SessionScoped
    public class Ejb implements Serializable
    {
        public String getHelloWorld()
        {
            return "Hello World";
        }
    } 
```

从我们上面看到的我应该能够调用bean方法......但我不能，**只有**当我在`faces-config.xml`文件中管理包含内容的bean时它才会起作用：

```
<?xml version="1.0" encoding="UTF-8"?>
<faces-config xmlns="http://java.sun.com/xml/ns/javaee" 
          xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" 
          xsi:schemaLocation="http://java.sun.com/xml/ns/javaee http://java.sun.com/xml/ns/javaee/web-facesconfig_2_0.xsd" 
          version="2.0">

          <managed-bean>
              <managed-bean-name>ejb</managed-bean-name>
              <managed-bean-class>bean.Ejb</managed-bean-class>
              <managed-bean-scope>session</managed-bean-scope>
          </managed-bean>
</faces-config> 
```

**问题**：

1.  为什么我遇到这种情况？
2.  如何解决这个问题？

我正在使用：

*   `JSF 2.0`（导入库）
*   `JBoss Server 4.2`

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-10T18:34:27.623

我的猜测是使用了默认与 JBoss 4.2 捆绑的 JSF 1.2（JBoss 可能不关心 JSF 版本）。结果注释被忽略，使用 faces-config.xml 文件。

尝试使用[此处](http://webcache.googleusercontent.com/search?q=cache%3aEvB_s1KraVIJ%3astinkycheese.ajexperience.com/2010/10/jboss-5-with-jsf-2-on-a-per-app-basis/%20&cd=1&hl=pl&ct=clnk&gl=pl)建议的配置（那是谷歌缓存页面）。

# javascript - 从对象返回函数会破坏 instanceof

> ID：10537025
> 
> 赞同：1
> 
> 时间：2012-05-10T15:11:42.587
> 
> 标签：javascript, oop

这个小宝石让我有点头疼。假设我创建了一个返回函数的对象，如下所示：

```
function Bar(prop) {
    this.prop = prop;
    var that = this;
    return function() {
        this.prop = that.prop;
    }
}

var bar = new Bar();
console.log(bar instanceof Bar)​; 
```

`Bar()`如您所见，返回一个函数。现在，`Bar() instanceof Bar`返回 false，这不是我想要的。如何检查 a`new Bar()`是否是 的实例`Bar`？这甚至可能吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-10T15:20:27.540

从构造函数返回*任何*对象都将使用该对象，而不是返回由构造函数自动生成的实例。这有点抽象，所以这里有一个例子来说明我的观点：

```
function Foo() {}
function Bar() {
    return new Foo();
}
f = new Foo();
console.log(f instanceof Foo); //true
b = new Bar();
console.log(b instanceof Bar); //false
console.log(b instanceof Foo); //true 
```

JavaScript 中的一切都是对象，包括函数，因此`foo.bar`函数返回函数的事实意味着，当您调用时，`new foo.bar()`您将收到由返回的函数`foo.bar`而不是新`foo.bar`实例。

* * *

虽然我不能 100% 确定您正在尝试做什么，但您*可以*`instanceof`通过在上下文中使用来检查一个函数是作为对象初始化程序调用还是作为函数调用。这种模式通常用于强制对象初始化：

```
function Foo(...arguments...) {
    if (!(this instanceof Foo)) {
        return new Foo(...arguments...);
    }
    //do stuff
} 
```

这允许`Foo`作为函数调用并仍然返回一个新`Foo`实例：

```
a = new Foo(); //a instanceof Foo
b = Foo(); //b instanceof Foo 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-10T15:21:38.447

不完全确定你为什么要做你正在做的事情，但我明白问题出在哪里。

在“测试”的范围内，this.bar 是函数 bar(prop)，而不是作为执行此函数的结果返回的函数，如果这有意义的话。然而， new this.bar('hi') 将首先执行 bar('hi')，它返回一个匿名函数，然后充当构造函数。

换句话说，您正在比较从匿名函数创建的实例与不同的函数，因此 instanceof 正确返回 false。

以下日志为“真实”，但可能不是您要查找的内容：

```
function foo() {
    this.test = function() {
        var cls = this.bar('hi');
        console.log(new cls() instanceof cls);
    };

    this.bar = function bar(prop) {
        this.prop = prop;
        var that = this;
        return function() {
            this.prop = that.prop;
        }
    }
}

var test = new foo();
test.test(); 
```

# android - (Android) 保持服务运行，即使应用程序被强制停止

> ID：10537026
> 
> 赞同：1
> 
> 时间：2012-05-10T15:11:42.867
> 
> 标签：android, service, alarmmanager

我创建了一个应用程序。效果很好，但我想要一些与 gmail 相同的功能：当我收到新电子邮件时，我会收到通知。我检查了我的手机，并没有看到运行看起来像 gmail-app 的服务或应用程序。

我已经调查了 AlarmManager 和服务，但是一旦我停止应用程序，两者都不再工作了。

有人可以给我一个提示如何做到这一点吗？

提前致谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-10T15:20:11.497

> 我检查了我的手机，并没有看到运行看起来像 gmail-app 的服务或应用程序。

部分原因是，Gmail 通过`Intents`操作系统的广播，通过我们视为 C2DM 的子系统（这就是您看不到进程的原因）获得此类通知。部分原因是因为 Gmail 是固件的一部分，因此可能会获得一些额外的好处，比如抵制应用程序被强制停止的正常行为。

> 有人可以给我一个提示如何做到这一点吗？

你不能。特别是在 Android 3.1+ 上，如果您的应用程序被强制停止，它将不会再次运行，直到用户手动运行您的一项活动（例如，从启动器）。

# wpf - WPF：将 Ctrl+Enter 转换为 TextBox 上的 Enter

> ID：10537030
> 
> 赞同：3
> 
> 时间：2012-05-10T15:11:52.523
> 
> 标签：wpf, textbox, keydown

我有一个多行文本框， Ctrl+Enter 在其上触发特定操作。Enter 显然会在文本框中创建一个新行。

现在我想颠倒这两个功能，即 Ctrl+Enter 应该创建一个新行，Enter 应该触发我的特定操作。一切正常，除了我需要用 Ctrl-Enter 创建一个新行。

我尝试了这个解决方案： [如何在 C# 中以编程方式生成按键事件？](https://stackoverflow.com/questions/1645815/how-can-i-programmatically-generate-keypress-events-in-c) 但是它不起作用，因为当我为 Enter 键提高 (Preview)Keydown/Up 时，仍然按下 Ctrl 键，所以我最终只是在文本框上模拟另一个 Ctrl-Enter，这没有任何效果。

任何帮助，将不胜感激。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-11T10:02:37.227

这就是我最终在文本框上模拟“Enter”的方式，即使按下 Ctrl 键：

```
var caretIndex = MyTextBox.CaretIndex;
MyTextBox.Text = MyTextBox.Text.Insert(caretIndex, System.Environment.NewLine);
MyTextBox.CaretIndex = caretIndex + 1; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-11T10:16:29.513

如果你想真正模拟一些按键，而不仅仅是复制它的功能，你应该使用[InputSimulator](http://inputsimulator.codeplex.com/)，它是一个很棒的开源库。模拟 Ctrl+Enter 如下所示：

```
InputSimulator.SimulateModifiedKeyStroke(VirtualKeyCode.CONTROL, VirtualKeyCode.RETURN); 
```

# iphone - 我可以在没有单点登录的情况下延长 Facebook Access_Token 的过期时间吗？

> ID：10537031
> 
> 赞同：2
> 
> 时间：2012-05-10T15:11:56.657
> 
> 标签：iphone, authorization, facebook-access-token, facebook-ios-sdk

我是将 facebook 集成到 iphone 的新手。现在我在删除offline_access 时遇到问题。谁能帮我一把？请

我使用以下代码来获得 Facebook 授权。

```
[facebook dialog:@"oauth" andParams:params andDelegate:self]; 
```

当我使用以下代码扩展访问令牌时：

```
[facebook extendAccessTokenIfNeeded]; 
```

我遇到错误：error_msg=使用单点登录未获得访问令牌，error_code=10

如果我使用以下代码来获得授权，我可以扩展访问令牌。

```
[facebook authorize:permissions]; 
```

但我不希望我的应用程序直接访问 Safari，然后重定向到我的应用程序以获取授权

我在[Removal of offline_access permission](https://developers.facebook.com/roadmap/offline-access-removal/)中看到，它说 Scenario 4: Client-side OAuth and Extending Access_Token Expiration Time through New Endpoint

我可以用吗？

如果是，如何使用？

如果没有，是否有任何其他方法来扩展访问令牌？（不重定向到野生动物园）

```
{request_args=(

{
    key = method;
    value = "auth.extendSSOAccessToken";
},
    {
    key = sdk;
    value = ios;
},
    {
    key = "sdk_version";
    value = 2;
},
    {
    key = "access_token";
    value = AAAAAK9pJJuEBAJ5VBsWIMjfdv6s9q6bXjO4AdO3diZA6s9ABEqS1VHNG1N5ynbvxyXVrFxTZAQ4RS8vww5hFPgb86TamBD0yjqPN75xopr8ACwqu8X;
},
    {
    key = format;
    value = json;
}
), error_msg=The access token was not obtained using single sign-on, error_code=10} 
```

# javascript - 正则表达式 - 排除括号和带有特殊键的括号

> ID：10537033
> 
> 赞同：1
> 
> 时间：2012-05-10T15:12:08.513
> 
> 标签：javascript, jquery, regex, string

我得到了这个字符串：

```
[[Fil:Hoganas_hamn.jpg|miniatyr|Höganäs Hamn.]] [[Fil:Hoganas_hamn_kvickbadet.jpg|miniatyr|Höganäs Hamn - Kvickbadet.]] [[Fil:Höganäs Jefast ny redigerad-1.jpg|miniatyr|Jefasthuset sett från väster med en del av den nya bryggan vid Kvickbadet.]] '''Höganäs''' är en [[tätort]] och [[centralort]] i [[Höganäs kommun]] i [[Skåne län]]. Höganäs blev stad 1936\. Ursprungligen är Höganäs ett [[fiskeläge]] kring vilket en [[gruvindustri]] utvecklades för brytning av [[kol (bränsle)|kol]] och [[lera|leror]] för tillverkning av [[eldfast]] [[keramik]] ([[Höganäskrus]]). Gruvindustrin är numera nedlagd. 
```

我想排除 [[FIL: + dynamic word]] 和每个 [[, ]] 的每个实例，但不排除只有 [[word]] 没有“FIL:”的单词本身。

我已经开始为它做一个正则表达式，但我被卡住了。

```
\[\[\Fil:|\]\] 
```

我之后的输出应该如下所示：

```
'''Höganäs''' är en tätort och centralort i Höganäs kommun i Skåne län. Höganäs blev stad 1936\. Ursprungligen är Höganäs ett fiskeläge kring vilket en gruvindustri utvecklades för brytning av kol (bränsle)|kol och lera|leror för tillverkning av eldfast keramik (Höganäskrus). Gruvindustrin är numera nedlagd. 
```

我有 JQuery 但认为 .replace 应该可以解决问题吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-10T15:32:24.900

Try this, maybe you want also to adjust spaces

```
var string = "[[Fil:Hoganas_hamn.jpg|miniatyr|Höganäs Hamn.]] [[Fil:Hoganas_hamn_kvickbadet.jpg|miniatyr|Höganäs Hamn - Kvickbadet.]] [[Fil:Höganäs Jefast ny redigerad-1.jpg|miniatyr|Jefasthuset sett från väster med en del av den nya bryggan vid Kvickbadet.]] '''Höganäs''' är en [[tätort]] och [[centralort]] i [[Höganäs kommun]] i [[Skåne län]]. Höganäs blev stad 1936\. Ursprungligen är Höganäs ett [[fiskeläge]] kring vilket en [[gruvindustri]] utvecklades för brytning av [[kol (bränsle)|kol]] och [[lera|leror]] för tillverkning av [[eldfast]] [[keramik]] ([[Höganäskrus]]). Gruvindustrin är numera nedlagd.";

var result = string.replace(/\[\[Fil:.*?\]\]/g, '').replace(/\[\[(.*?)\]\]/g, '$1');

console.log(result); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-10T15:17:21.117

尝试用空字符串替换此 Regex 的所有匹配项：

```
\[\[Fil:[^\]]*\]\]|\[\[|\]\] 
```

要打破这一点：

```
\[\[Fil:[^\]]*\]\]   matches [[Fil:...]]
\[\[                  matches remaining [[
\]\]                  matches remaining ]]
|                     combines with OR 
```

要获得准确的输出，您可能还需要删除一些空格：

```
\[\[Fil:[^\]]*\]\]\s+|\[\[|\]\] 
```

因此，在 JavaScript 中，您可以编写：

```
x.replace(/\[\[Fil:[^\]]*\]\]\s+|\[\[|\]\]/g, ''); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-10T15:18:20.833

您可以使用这样的正则表达式

```
\[\[.*?\]\] 
```

然后使用[replace](https://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/String/replace)的回调函数版本检查是否以then开头，`Fil:`然后有条件地决定是要返回一个空白字符串来删除它，还是只返回单词本身。

或者，使用 2 个正则表达式。首先用空白字符串替换`Fil:`那些，然后只用单词替换其余部分。您可以使用

```
\[\[(\w+)\]\] 
```

或者类似的东西来捕捉`[[word]]`那些，然后用对这个词的反向引用来替换它，即，`\1`指的是括号中的内容。

# php - PHP不同ips的相同代理检查时间太长

> ID：10537034
> 
> 赞同：0
> 
> 时间：2012-05-10T15:12:12.583
> 
> 标签：php

我在这里阅读了这篇文章 [测试端口是否打开并使用 PHP 转发](https://stackoverflow.com/questions/2226374/test-if-port-open-and-forwarded-using-php)

关于如何扫描同一代理的端口。但我的问题是我想扫描不同 ip xxx.xxx.xxx.$i 的同一个端口，for loop 我尝试从 0 到 255 运行它。我在上面提到的帖子中使用了相同的脚本 for loop 。但是得到答案需要太长时间（实际上我没有得到任何答案）。这是代码

```
for($i=0;$i<2;$i++){
$host = 'xxx.xxx.xxx.'.$i;
  $connection = @fsockopen($host, 3128);

if (is_resource($connection))
{
    echo '<h2>' . $host . ':' . $port . ' ' . '(' . getservbyport($port, 'tcp') . ') is open.</h2>' . "\n";

    fclose($connection);
}

else
{
    echo '<h2>' . $host . ':' . $port . ' is not responding.</h2>' . "\n";
} 
```

}

# asp.net-mvc-3 - 使用 EF MVC3 读取相关数据

> ID：10537037
> 
> 赞同：-1
> 
> 时间：2012-05-10T15:12:22.727
> 
> 标签：asp.net-mvc-3

我有以下内容：

```
public Class Vacancy{
   public int VacancyID {get;set;}
   public List<Application> Applications {get;set;}
}
public Class Applicant{
   public int ApllicantID {get;set;}
   public List<Application> Applications {get;set;}
}
public Class Application{
   public int ApplicationID {get;set;}
   public int VacancyID {get;set;}
   public int ApplicantID {get;set;}
   public virtual Applicant Applicant {get;set;}
   public virtual Vacancy Vacancy {get;set;}
 } 
```

然后我在空缺模型上创建了一个控件。我想要做什么：1）查看所有空缺职位 2）当一个空缺职位被选中时，我想在同一页面中显示其申请列表 3）当从上一步中选择一个申请时，我想获取申请人的详细信息我试图使用这个教程 [http://www.asp.net/mvc/tutorials/getting-started-with-ef-using-mvc/reading-related-data-with-the-entity-framework-in-an-asp-net-mvc](http://www.asp.net/mvc/tutorials/getting-started-with-ef-using-mvc/reading-related-data-with-the-entity-framework-in-an-asp-net-mvc-application) -应用程序，但我无处可去，我撞到了墙，我很困惑[atm](http://www.asp.net/mvc/tutorials/getting-started-with-ef-using-mvc/reading-related-data-with-the-entity-framework-in-an-asp-net-mvc-application)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-10T16:09:41.277

我很确定您不希望这里的任何人从 AZ 对其进行编码。所以在这里我给你一些开始。我提供的解决方案的一半，让你自己做剩下的。

首先，您的代码中有一些拼写问题。类关键字应为小写。您应该使用相同的 ID 来创建外键引用。（如果您的应用程序类中有申请人 ID 作为主键，您应该在应用程序类中使用相同的拼写。实体框架代码在看到类似的名称时首先创建外键关系）。

假设您有这样的`DBContext`课程

```
public class YourDBContext:DbContext
{
    public DbSet<EFCodeFirst.Models.Vacancy> Vacancies { set; get; }
    public DbSet<EFCodeFirst.Models.Applicant> Applicants { set; get; }
    public DbSet<EFCodeFirst.Models.Application> Applications { set; get; }
} 
```

要列出所有空缺，请创建一个名为“索引”的操作

```
public ActionResult Index()
{
   YourDBContext db = new YourDBContext();
   var allVacancies = db.Vacancies.ToList();
   return View(allVacancies);
} 
```

所以我们应该有这个动作的视图，我们需要在其中显示所有的空缺。因此，将强类型的索引视图添加到这样的空缺模型集合中

```
@model IEnumerable<EFCodeFirst.Models.Vacancy>

<h2> All Vacancies </h2>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.6.2/jquery.min.js"></script>
<div id="divVacancies">
@foreach (var vacancy in Model)
{
  <p> @Html.ActionLink(vacancy.VacancyID.ToString(), "GetApplications","Job", new { @id = vacancy.VacancyID }, new {  @class = "ajaxLink" })</p>
}
</div>

<div id="divApplications"></div>

<script type="text/javascript">
    $(function () {
        $(".ajaxLink").click(function (e) {
            e.preventDefault();
            var target = $(this).attr("href");
            $("#divApplications").load(target);
        });
     });
</script> 
```

在这个视图中，我们包含了一个`jQuery`库引用，我们将使用它来进行一些 ajax 调用。我们需要使用 ajax 在同一页面中显示所选空缺的申请信息。为此，我们将向Job 控制器内部`asynchronous`调用的另一个操作发出请求`GetApplications`，并将空缺 id 作为参数。我们只是循环遍历所有可用的空缺并在这里为它创建一个锚标记。

回到 Job 控制器并创建一个`GetApplications`像这样调用的 Action 方法。

```
 public ActionResult GetApplications(int id)
    {
        SampleContext db = new SampleContext();
        var allApplications = db.Applications.Where(x => x.VacancyID == id).ToList();
        return View(allApplications);
    } 
```

这很容易理解，我们正在查询以获取所选空缺的所有申请，然后将其返回到视图。所以我们需要创建一个名为`GetApplications.cshtml`以下内​​容的视图。

```
@model IEnumerable<EFCodeFirst.Models.Application>
<h2>Applications </h2>
@foreach (var application in Model)
{
 <p> @Html.ActionLink(application.ApplicantID.ToString(), "GetApplicants", new { @id = application.VacancyID, @class = "ajaxLink" })</p>
} 
```

直线前进！只需在循环中打印结果。

That is it. It should work. Whenever you click on the vacancy link, it will make a call to the GetApplications method with the id as parameter and that action method will return a view with HTML markup which listss all applications for that vacancy id.

**Once you do this, you should be able to create the second part yourself. It is the same logic. You may need to create a similar GetApplicants action method which returns data. Good Luck**

**Note** : Use `Firebug` /`fiddler` to see what (ajax) requests are going to the action methods with what parameter. This will help you to understand how it works.

# iphone - 从 NSThread 的函数调用时不调用 NSURLConnection 委托

> ID：10537038
> 
> 赞同：2
> 
> 时间：2012-05-10T15:12:22.990
> 
> 标签：iphone, ios, objective-c, xcode, nsurlconnection

我发送`NSURLConnection`请求它工作正常。现在我想刷新信息，即`NSURLConnection.Refresh`从按钮的 IBAction 调用时重新发送正在工作。但不是从`NSThread`方法工作。我该如何解决这个问题。这里`NSThread`函数用于运行系统时间。当时间等于凌晨 1:00 时，我想刷新 API。但它不是调用的代表`NSURLConnection`。

这是 NSURLConnection 代码：

```
-(void)displays:(model *)place
{
  NSString *strs=[@"http://www.earthtools.org/timezone-1.1/" stringByAppendingString:[NSString stringWithFormat:@"%@/%@",place.latitude,place.longitude]];

  NSMutableURLRequest *request=[NSMutableURLRequest requestWithURL:[NSURL URLWithString:strs]];

  NSURLConnection *reqTimeZone=[NSURLConnection connectionWithRequest:request delegate:self];
  [reqTimeZone start]; //here request not get start
} 
```

上面的代码带有名为“displays”的函数，参数是类的一个实例，它具有所有位置详细信息。

NSthread函数代码：

```
- (void) setTimer {    
   //assign current time
    [self countDown];
}

- (void) countDown {
   //count the current time 

   if(hrs==12&& meridian==@"pm")

    [self display:(placedetails)];//it calls the displays function but NSURLConnection is not get start.

    [NSThread detachNewThreadSelector:@selector(setTimer) toTarget:self withObject:nil];
} 
```

上面的显示函数被称为放置的详细信息，但`NSURLConnection`没有调用委托。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-08T17:58:42.647

对于要调用的委托方法，您需要将线程的运行循环附加到 NSURLConnection。由于您正在创建一个线程并且没有将 NSURLConnection 附加到线程的 RunLoop，因此不会触发连接委托方法。

这是一个例子：

```
- (void)viewDidLoad
{
    [super viewDidLoad];
    // Do any additional setup after loading the view, typically from a nib.

    // I am creating a button and adding it to viewController's view
    UIButton *bttn = [UIButton buttonWithType:UIButtonTypeRoundedRect];
    [bttn setFrame:CGRectMake(100.0f, 200.0f, 120.0f, 50.0f)];
    [bttn setTitle:@"Download" forState:UIControlStateNormal];
    [bttn addTarget:self action:@selector(spawnThreadForDownload) forControlEvents:UIControlEventTouchUpInside];

    [[self view] addSubview:bttn];
}

- (void)spawnThreadForDownload
{
    [NSThread detachNewThreadSelector:@selector(downloadAndParse) toTarget:self withObject:nil];
}

- (void)downloadAndParse
{
    @autoreleasepool {
        NSURL *url = [NSURL URLWithString:@"http://apple.com"];
        NSURLRequest *req = [NSURLRequest requestWithURL:url 
                                             cachePolicy:NSURLRequestReloadIgnoringLocalAndRemoteCacheData 
                                         timeoutInterval:20.0f];
        NSURLConnection *conn = [NSURLConnection connectionWithRequest:req delegate:self];

        // Run the currentRunLoop of your thread (Every thread comes with its own RunLoop)
        [[NSRunLoop currentRunLoop] run];

        // Schedule your connection to run on threads runLoop.
        [conn scheduleInRunLoop:[NSRunLoop currentRunLoop] forMode:NSDefaultRunLoopMode];
    }
}

// NSURLConnectionDelegate methods

- (void)connection:(NSURLConnection *)connection didFailWithError:(NSError *)error
{
    NSLog(@"Connection failed with error: %@",[error localizedDescription]);
}

// NSURLConnectionDataDelegate methods

- (void)connection:(NSURLConnection *)connection didReceiveResponse:(NSURLResponse *)response
{

}

- (void)connection:(NSURLConnection *)connection didReceiveData:(NSData *)data
{

}

- (void)connectionDidFinishLoading:(NSURLConnection *)connection
{
    NSLog(@"Connection finished downloading");
} 
```

# css - 如何判断 CSS 是否已经加载？

> ID：10537039
> 
> 赞同：26
> 
> 时间：2012-05-10T15:12:28.573
> 
> 标签：css, watin

我如何断言页面的 CSS 已成功加载并在 Watin 2.1 中应用其样式？

* * *

## 回答 #1

> 赞同：29
> 
> 时间：2012-05-14T11:06:32.290

在做了一些研究并写下我的答案之后，我偶然发现了[这个链接](http://www.phpied.com/when-is-a-stylesheet-really-loaded/)，它解释了你需要了解的关于 CSS 的所有信息、加载时间以及如何检查它。

提供的链接很好地解释了它，事实上，我正在添加一些引用以供将来参考。
[如果你很好奇，我的答案将是 #2 和 #4 的变体。]

## [什么时候真正加载样式表？](http://www.phpied.com/when-is-a-stylesheet-really-loaded/)

**...**

有了这个，让我们看看我们在这里有什么。

```
// my callback function 
// which relies on CSS being loaded function
CSSDone() {
    alert('zOMG, CSS is done');
};

// load me some stylesheet 
var url = "http://tools.w3clubs.com/pagr/1.sleep-1.css",
    head = document.getElementsByTagName('head')[0],
    link = document.createElement('link');

link.type = "text/css"; 
link.rel = "stylesheet";
link.href = url;

// MAGIC 
// call CSSDone() when CSS arrives
head.appendChild(link); 
```

魔术部分的选项，从简单到可笑

1.  听链接.onload
2.  收听 link.addEventListener('load')
3.  听链接.onreadystatechange
4.  setTimeout 并检查 document.styleSheets 中的更改
5.  setTimeout 并检查您创建的特定元素的样式更改，但使用新 CSS 设置样式

第五个选项太疯狂了，假设您可以控制 CSS 的内容，所以忘记它。另外，它会在超时时检查当前样式，这意味着它将刷新回流队列并且可能会很慢。CSS 到达越慢，回流越多。所以，真的，算了。

那么如何实现魔法呢？

```
// MAGIC 

// #1   
link.onload = function () {
    CSSDone('onload listener');
};   

// #2   
if (link.addEventListener) {
    link.addEventListener('load', function() {
        CSSDone("DOM's load event");
    }, false);   
};   

// #3   
link.onreadystatechange = function() {
    var state = link.readyState;
    if (state === 'loaded' || state === 'complete') {
        link.onreadystatechange = null;
        CSSDone("onreadystatechange");
    }   
};

// #4   
var cssnum = document.styleSheets.length;
var ti = setInterval(function() {
    if (document.styleSheets.length > cssnum) {
        // needs more work when you load a bunch of CSS files quickly
        // e.g. loop from cssnum to the new length, looking
        // for the document.styleSheets[n].href === url
        // ...

        // FF changes the length prematurely :(
        CSSDone('listening to styleSheets.length change');
        clearInterval(ti);
    }   
}, 10);

// MAGIC ends 
```

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2014-01-15T20:11:32.947

@ShadowScripter 对文章进行了更新。据称，新方法适用于所有浏览器，***包括 FF。***

```
var style = document.createElement('style');
style.textContent = '@import "' + url + '"';

var fi = setInterval(function() {
  try {
    style.sheet.cssRules; // <--- MAGIC: only populated when file is loaded
    CSSDone('listening to @import-ed cssRules');
    clearInterval(fi);
  } catch (e){}
}, 10);  

document.getElementsByTagName('head')[0].appendChild(style); 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-05-14T07:04:18.937

页面加载后，您可以验证某些元素的样式，如下所示：

```
var style = browser.Div(Find.ByClass("class")).Style;
Assert.That(Style.Display, Is.StringContaining("none"));
Assert.That(Style.FontSize, Is.EqualTo("10px")); 
```

等等...

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2017-08-08T18:01:27.197

由于浏览器兼容性可能会有所不同，并且未来的新浏览器标准可能会发生变化，我建议将 onload 侦听器和添加 CSS 到样式表的组合，以便您可以在 HTML 元素 z-index 更改时进行侦听，如果您使用的是单个样式表。否则，请使用下面的函数为每种样式添加一个新的元标记。

将以下内容添加到您正在加载的 CSS 文件中：

```
#*(insert a unique id for he current link tag)* {
    z-index: 0
} 
```

将以下内容添加到您的脚本中：

```
function whencsslinkloads(csslink, whenload ){
    var intervalID = setInterval(
        function(){
            if (getComputedStyle(csslink).zIndex !== '0') return;
            clearInterval(intervalID);
            csslink.onload = null;
            whenload();
        },
        125 // check for if it has loaded 8 times a second
    );
    csslink.onload = function(){
        clearInterval(intervalID);
        csslink.onload = null;
        whenload();
    }
} 
```

# 例子

`index.html`：

```
<!doctype html>
<html>
    <head>
        <link rel=stylesheet id="EpicStyleID" href="the_style.css" />
        <script async href="script.js"></script>
    </head>
    <body>
        CSS Loaded: <span id=result>no</span>
    </body>
</html> 
```

`script.js`：

```
function whencsslinkloads(csslink, whenload ){
    var intervalID = setInterval(
        function(){
            if (getComputedStyle(csslink).zIndex !== '0') return;
            clearInterval(intervalID);
            csslink.onload = null;
            whenload();
        },
        125 // check for if it has loaded 8 times a second
    );
    csslink.onload = function(){
        clearInterval(intervalID);
        csslink.onload = null;
        whenload();
    }
}
/*************************************/
whencsslinkloads(
    document.getElementById('EpicStyleID'),
    function(){
        document.getElementById('result').innerHTML = '<font color=green></font>'
    }
) 
```

`the_style.css`

```
#EpicStyleID {
    z-index: 0
} 
```

**请不要**让您的脚本同步加载（没有`async`属性），以便您可以捕获链接的 onload 事件。有更好的方法，比如上面的方法。

# php - 将 javascript 变量传递给 php switch case 语句

> ID：10537042
> 
> 赞同：0
> 
> 时间：2012-05-10T15:12:35.860
> 
> 标签：php, jquery, ajax, post, switch-statement

javascript 参数“Step”应该触发 php.ini 中的 switch-case 函数。如果 Step 是 1，则在 php 中触发这段代码并通过 JSON 返回输出。

如果我看一下萤火虫，帖子字符串是：`Step=one&inputFname=rick&inputLname=bovenkamp`我认为这是正确的。所以问题一定出在php文件中，我认为它在`$_POST`部分......

我究竟做错了什么？任何帮助都会非常棒！

javascript代码：

```
$(document).ready(function() {
    $("form#userForm").submit(function() {
        var inputFname = $('#inputFname').attr('value');
        var inputLname = $('#inputLname').attr('value');
            var Step = "one";
        $.ajax({
            type: "POST",
            url: "main.php",
            data: {Step: Step,inputFname: inputFname,inputLname: inputLname},
            dataType: "json",
            contentType:"application/json; charset=utf-8",
                success: function(data) {
                $("p.succesText").html(data.jsCode);
                    $("form#userForm").hide();
                $("div.success").fadeIn();
            },
            error: function(xhr, status, error) {
                $("form#userForm").hide();
                $("p.errorHead").html("Something went wrong.");
                $("p.errorText").text("ResponseText: " + xhr.responseText
                                        + "Statuscode: " + xhr.status
                                        + "ReadyState: " + xhr.readyState);
                $("div.error").fadeIn();
            }
        });
            return false;
    });
}); 
```

PHP 文件：

```
<?php header('content-type: application/json; charset=utf-8');

    $log = array();

    $varStep = htmlspecialchars(trim($_POST["Step"]));  

    switch($varStep) {

        case "one":

        $varFname = htmlspecialchars($_POST["inputFname"]);
        $varLname = htmlspecialchars($_POST["inputLname"]);

        //Make Database connection
        $db = mysql_connect("192.168.178.254","root","852456");
        if(!$db) die("Error connecting to MySQL database.");
        mysql_select_db("Ajax" ,$db);

        //Generate code and check if code already exists in the database
        do
        {
            $varCode = rand(10000, 99999);
            $dbCheckCode = "";
            $dbCheckCode = mysql_query("SELECT * FROM TableAjax WHERE code='$varCode'");
        }
        while (mysql_fetch_array($dbCheckCode) !== false);

        //Save the Form data in the database
        $sql = "INSERT INTO TableAjax (fname, lname, code) VALUES (".PrepSQL($varFname) . ", " .PrepSQL($varLname) . ", " .PrepSQL($varCode) . ")";
        mysql_query($sql);  

        //Return code to frontend
        $log['jsCode'] = $varCode;

        break;
    }

    echo json_encode($log);

    //Clean SQL statement
    function PrepSQL($value)
    {
        if(get_magic_quotes_gpc()) 
        {
            $value = stripslashes($value);
        }
        $value = "'" . mysql_real_escape_string($value) . "'";
        return($value);
    }   

?> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-10T15:36:55.367

将 Step 放在引号中`data : {"Step" : Step,...`。

在这种情况下，您将变量的值作为键传递，也就是说您实际上是在传递`data : {"one" : "one",...`. 你应该对`inputLname`and做同样的事情`inputFname`。

**编辑 - 解释**

如果您在[http://api.jquery.com/jQuery.ajax/](http://api.jquery.com/jQuery.ajax/)查看 contentType 选项的作用，您会看到默认设置就是`application/x-www-form-urlencoded`您想要的。本质上，您的 PHP 错误表明该`$_POST`数组为空，因为由于格式的原因它不知道如何读取您的数据。您希望您的返回数据是`json`，该`dataType`选项就是您所需要的。

你仍然需要做我在帖子第一部分中指出的事情，但基本上你有两个错误让你绊倒。

我希望这是有道理的！

# asp.net-mvc - 您如何为具有适当布局的教室展示制作“考勤表”？

> ID：10537047
> 
> 赞同：1
> 
> 时间：2012-05-10T15:12:45.830
> 
> 标签：asp.net-mvc, entity-framework, razor, viewmodel

我一直很难找到一个以适当方式展示教室的考勤表。我的数据库中有一个出勤表，我可以很容易地使用来自一个教室的数据来显示它，但它的显示方式看起来就像您直接在数据库中浏览到出勤表时的样子。

通过展示我的工作可能更容易解释：

我有以下课程：

实际的课堂课程或课程：

```
public class Course
{
    public int CourseID { get; set; }
    public string Title { get; set; }
    public int AttendanceDate { get; set;}
    public virtual ICollection<Enrollment> Enrollments { get; set; } // allows Students to be enrolled in a Course
    etc. . .
} 
```

我的学生们：

```
public class Student
{
    public int StudentID { get; set; }
    public string Name { get; set; }
    public virtual ICollection<Enrollment> Enrollments { get; set; } // allows Student to be enrolled in a Course
    etc. . .
} 
```

将学生与课程联系起来的实体：

```
public class Enrollment
{
    public int EnrollmentID { get; set; }
    public int CourseID { get; set; }
    public int StudentID { get; set; }
    public virtual Course Course { get; set; }
    public virtual Student Student { get; set; }
} 
```

出勤数据：

```
public class Attendance
{
    public int AttendanceID { get; set; }
    public int CourseID { get; set; }
    public int StudentID { get; set; }
    public int AttendanceDay { get; set; }  // used to set how many days people are supposed to attend this Course (each course has a different length, some are 10 day courses, some are 3, etc.)
    public bool Present { get; set; }  // absent or present (set to absent by default)
    public virtual Course Course { get; set; }
    public virtual Student Student { get; set; }
} 
```

我的项目流程让教师创建课程供学生注册。当学生注册课程时，所有必要的出勤数据都会以默认值（每天都缺席）输入到出勤数据库表中：

```
for (int i = 0; i < course.AttendingDays; i++)
{
    Attendance newAttendance = new Attendance
    {
        CourseID = course.CourseID,
        StudentID = thisStudent.StudentID,
        AttendanceDay = i + 1,
        Present = false
    };
    db.Attendance.Add(newAttendance);
    db.Save();
} 
```

所以我有一个包含一堆考勤数据的数据库表，我无法让它在屏幕上正确显示，排序类似于：

第一天出勤 | 2 | 3 | 4 | 5 |

学生 1 缺席 缺席 缺席 缺席 缺席

Student2 缺席 缺席 缺席 缺席

Student3 缺席 缺席 缺席 缺席

希望你能读到。. . 我认为这是一个非常标准的考勤表布局。

我尝试使用 Group By 对数据进行排序：

```
var model = from s in db.Attendance
                             where s.CourseID == 4
                             group s.AttendanceDay by s.StudentID into t
                             select new
                             {
                                 StudentID = t.Key,
                                 Days = t.OrderBy(x => x)
                             };
        return View(model); 
```

它返回一个匿名类型的 IEnumerable（如果我理解正确的话），但我似乎无法让这些数据做任何事情。如果我使用“更简单”的表生成器（并且不要尝试按 AttendanceDay 编号分组），我得到的出勤表数据就好了，但它的排序就像您查看出勤的实际数据库表时一样，不是很如果您希望教师阅读和编辑信息，这很有用。

我想我需要一个合适的 ViewModel 来调整匿名类型格式的 IEnumerable 中的传入考勤数据，然后是一个适当显示该 ViewModel 的视图。. . 但我不确定我将如何处理该过程。

任何帮助，将不胜感激。谢谢你。

更新：

我开始认为我需要利用“交叉表报告”/“数据透视”并使用如下内容：[http ://linqlib.codeplex.com/wikipage?title=Pivot&referringTitle=Home](http://linqlib.codeplex.com/wikipage?title=Pivot&referringTitle=Home)

任何指针？

## 更新 2：

使用以下接受的答案几乎完全解决了，这是我当前的控制器：

```
 // Generates list of Attendances specifically for current Course
        var attendanceItems = db.Attendance.Where(s => s.CourseID == id);
        List<Attendance> attendanceItemsList = attendanceItems.ToList();
        // End of generating list of Attendances

        // CURRENT PROBLEM AREA - INCOMPLETE
        var student = attendanceItemsList.Select(a => a.Student).Distinct()/*.OrderBy(a => a)*/;  // This works for adding one student, Cannot use OrderBy in its current state - how can I properly order by name?  (right now it will order by id I believe)
        List<Student> StudentList = student.ToList();;

        //
        // Generates list of AttendingDays specifically for current Course
        Course course = db.Courses.FirstOrDefault(p => p.CourseID == id);
        List<int> attDayList = new List<int>();
        for (int i = 0; i < course.AttendingDays; i++)
        {
            attDayList.Add(i + 1);
        };
        // End of generating list of AttendingDays

        AttendanceReportViewModel model = new AttendanceReportViewModel
        {
            AttendanceDays = attDayList,
            Students = StudentList,
            Attendances = attendanceItemsList,
        };
        return View(model); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-16T02:05:14.850

我认为您应该考虑创建一个包含天数列表、学生列表和出勤条目列表的 ViewModel，然后简单地遍历学生并在其中遍历出勤天数，然后显示每个人的出勤记录。

所以 ViewModel 看起来像这样：

```
 public class AttendanceReportViewModel
{
    public List<int> AttendanceDays { get; set; }
    public List<Student> Students { get; set; }
    public List<Attendance> Attendances { get; set; }

    public string IsPresent(Student student, int attendanceDay)
    {
         return Attendances.Single(a => a.StudentID == student.ID && a.AttendanceDay == attendanceDay).Present ? "present" : "absent";
    }
} 
```

确保按照您希望它们出现的方式对所有项目进行排序，但这是简单的 OrderBy 东西。还要确保只加载相关课程的出勤率，并将任何课程数据添加到要显示的视图模型中。

然后在您的视图中像这样迭代：

```
 <table>
    <thead>
        <tr>
            <th>Attendance Day</th>
            @foreach (var attendanceDay in Model.AttendanceDays)
            {
                <th>@attendanceDay</th>
            }
        </tr>
    <thead>
    <tbody>
        @foreach (var student in Model.Students)
        {
            <tr>
                <td>@student.Name</td>
                @foreach (var attendanceDay in Model.AttendanceDays)
                {
                    <td>@Model.IsPresent(student, attendanceDay)</td>
                }
            </tr>
        }
    </tbody>
} 
```

刚刚为你整理了这个，所以甚至不确定我的确切代码是否可以编译，但我希望它能给你一个好的起点。显然，应该对表格应用一些样式等。

## 编辑1：

要将数据加载到视图模型中，您只需在控制器中执行此操作（从技术上讲，最终这应该在存储库中，甚至可能是服务层）

```
 var viewModel = new AttendanceReportViewModel();

viewModel.AttendanceDays = db.Attendance.Select(a => a.AttendanceDay).Distinct().OrderBy(a => a)
... 
```

我还应该注意到，当然您也可以只将出勤数据加载到视图模型中，然后根据这些数据在 ViewModel 中生成 AttendanceDays 和 Students 属性。我暂时避免了这种情况，因为您很可能也需要学生数据。

## 编辑 2

对于学生来说，您希望所有学生都参加课程几乎是一样的，但是由于您已经预先初始化了所有天的出勤数据，您可以这样做：

```
 var viewModel = new AttendanceReportViewModel();

viewModel.AttendanceDays = db.Attendance.Select(a => a.AttendanceDay).Distinct().OrderBy(a => a);
viewModel.Students = db.Attendance.Select(a => a.Student).Distinct().OrderBy(s => s.Name); 
```

或者，您可以像这样从 Enrollment 表中加载此信息：

```
 viewModel.Students = db.Enrollment.Where(e => e.CourseID == courseID).Select(e => e.Student).OrderBy(s => s.Name); 
```

请注意，我假设注册表上的课程和学生 ID 之间存在唯一约束，并且该 courseID 是您生成出勤报告的内容。此外，您的 Enrollment 表中有 Course 映射到上面的 Student，我认为这是不正确的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2021-03-19T06:01:15.890

```
 CREATE PROCEDURE [dbo].[SP_S_GetDaywise_EmpTotalDuties_AttendanceRegister]
        (
        @Month int=null,
        @Year int=null,
        @SCode bigint=null
        )
        AS
            /**Creating TempAllAttendance**/
            CREATE TABLE #TempAllAttendance
            (RecId bigint IDENTITY(1,1),EmpCode BIGINT,Duties FLOAT,AttDay INT, DESIGNATION NVARCHAR(250))
            /**Creating TempAllAttendance**/

            /**Creating SumAttendance**/
            CREATE TABLE #SumAttendance
            (Total FLOAT)
            /**Creating SumAttendance**/

            DECLARE @TotalDuties FLOAT=null

         BEGIN

            SET @TotalDuties=(SELECT SUM(ISNULL(Duties, 0)) AS Total FROM tbl_Attendance WHERE ([Month] = @Month) AND ([Year] = @Year) AND (SCode = @SCode))        

            INSERT INTO #SumAttendance
            (Total)VALUES(@TotalDuties)

            INSERT INTO #TempAllAttendance(EmpCode,Duties,AttDay,DESIGNATION)
            (
                SELECT EmpCode, SUM(ISNULL(Duty1, 0)) AS Duties, DAY(AttendanceDate) AS AttDay,DESIGNATION
                FROM  tbl_Attendance
                WHERE ([Month] = @Month) AND ([Year] = @Year) AND (SCode = @Code)
                GROUP BY EmpCode, AttendanceDate,DESIGNATION 

            )   
            /**This is used to get date wise & Swise Total duty When Records Not Saved In tbl_SiteWiseEmployee_TotalAttendance**/
            /**This is used to get date wise & Sise Total duty When Records Saved In tbl_SiteWiseEmployee_TotalAttendance**/

            /**This is used to get date wise & Swise Total duty**/
                SELECT * FROM #TempAllAttendance
            /**This is used to get date wise & Sitewise Total duty**/
            /**This is used to get date wise Total  duty**/
            SELECT EmpCode,SUM(ISNULL(Duties, 0)) AS Duties,AttDay,DESIGNATION FROM #TempAllAttendance
            GROUP BY EmpCode, AttDay,EmpCode,DESIGNATION
            /**This is used to get Employee SumAttendance**/
            SELECT SUM(Duties) AS Duties,DAY(AttendanceDate) AS AttDay FROM tbl_Attendance
            WHERE (SiteCode = @SCode) AND ([Month] = @Month) AND ([Year] = @Year)  GROUP BY AttendanceDate

            /**This is used to get Employee SumAttendance**/
            SELECT * FROM #SumAttendance
            /**This is used to get date wise & Sitewise Total duty AS P**/
                --SELECT RecId,EmpCode,'P' AS Duties,AttDay FROM #TempAllAttendance

            SELECT EmpCode,'P' AS Duties,AttDay FROM #TempAllAttendance
            GROUP BY EmpCode, AttDay
            /**This is used to get date wise & Swise Total duty  AS P**/

            DROP TABLE #SumAttendance
            DROP TABLE #TempAllAttendance
        END 

        private void STotalEmployeeAttendenceReportAsDuty()
        {
            #region  For Displaying page Header region
            lblMonthId.Value = Request.QueryString["Month"];
            lblMonthName.Value = Request.QueryString["MonthName"];
            lblYear.Value = Request.QueryString["year"];
            lblSCode.Value = Request.QueryString["SCode"];
            lblgvSName.Value = Request.QueryString["SName"];
            lblMonth.InnerText = lblMonthName.Value;
            lblYears.InnerText = lblYear.Value;
            lblSName.InnerText = lblgvSiName.Value + "-" + lblSCode.Value;
            #endregion

            #region Get SWise Employee Detail
            siAttndncPL.SiteCode = lblSiteCode.Value;
            sAttndncPL.Month = lblMonthId.Value;
            siAttndncPL.Year = lblYear.Value;
            DataTable EmpDt = siteAttndncBL.GetEmployeeNameWithTotalDutiesBySit(siteAttndncPL);
            #endregion

            #region Making TempTable.
            DataTable dt = new DataTable();
            DataColumn dc = new DataColumn();
            dc.ColumnName = "EmpCode";
            dt.Columns.Add(dc);
            dc = new DataColumn();
            dc.ColumnName = "EmpName";
            dt.Columns.Add(dc);
            dc = new DataColumn();
            dc.ColumnName = "Designation";
            dt.Columns.Add(dc);
            /**Some Table**/
            DataTable dtdayDuties = new DataTable();
            DataTable dtEmpDayDuties = new DataTable();
            DataTable dtEmpDutiesAsP = new DataTable();
            DataTable dtSumDuty = new DataTable();
            /**Some Region**/
            #endregion

            #region Get No Of Days In Month..
            int DaysCount = DateTime.DaysInMonth(Convert.ToInt32(Request.QueryString["Year"]), Convert.ToInt32(Request.QueryString["Month"]));
            #endregion

            #region This will dispaly date value on grid header
            for (int i = 1; i <= 9; i++)
            {
                dc = new DataColumn();
                dc.ColumnName = "0" + i.ToString();
                dt.Columns.Add(dc);
            }
            for (int i = 10; i <= DaysCount; i++)
            {
                dc = new DataColumn();
                dc.ColumnName = i.ToString();
                dt.Columns.Add(dc);
            }
            dc = new DataColumn();
            dc.ColumnName = "Total";
            dt.Columns.Add(dc);
            #endregion

            #region   /*Adding Site Name Row in Grid View*/
            for (int j = 0; j < EmpDt.Rows.Count + 1; j++)
            {
                DataRow dtrow = dt.NewRow();
                if (j < EmpDt.Rows.Count)
                {
                    dtrow[0] = EmpDt.Rows[j][0];/**this Row Cells EmpCode**/
                    string EmpCode = EmpDt.Rows[j][0].ToString();
                    // lblEmpCode = EmpDt.Rows[j][0].ToString();
                    dtrow[1] = EmpDt.Rows[j][1];/**this Row Cells EmpName**/
                    dtrow[2] = EmpDt.Rows[j][2];/**this Row Cells DESsgName**/
                    dtrow[DaysCount + 3] = EmpDt.Rows[j][3];/**this Row Cells Duties **/

                    #region Get EmployeeWise Total Duties.
                    siteAttndncPL.SiteCode = lblSiteCode.Value;
                    siteAttndncPL.Month = lblMonthId.Value;
                    siteAttndncPL.Year = lblYear.Value;
                    DataSet ds = siteAttndncBL.GetEmployeeDayWiseAttendenceBySCode_WOPHD(siteAttndncPL);
                    dtEmpDutiesAsP = ds.Tables["tbl_GetEmpTotalAttendanceOfDayAsP"];/*getting Site Duties as P*/
                    dtEmpDayDuties = ds.Tables["tbl_GetEmpTotalAttendanceOfDay"];
                    dtdayDuties = ds.Tables["tbl_SumOfAllEmpDayWiseDuties"];
                    dtSumDuty = ds.Tables["tbl_TotalSumOfAllEmpAttendance"];
                    TotalSumDuties = Convert.ToDouble(dtSumDuty.Rows[0]["Total"].ToString());
                    #endregion
                }
                if (j == EmpDt.Rows.Count)
                {
                    #region Count Total Duties.
                    dtrow[2] = "Total Duties";
                    dtrow[DaysCount + 3] = TotalSumDuties;/**Sum Of All Main Attendance**/
                    #endregion
                }
                dt.Rows.Add(dtrow);
            }
            #endregion

            /**Fill Day Wise Attendance In Gridview**/
            #region Day Wise Attendance fill In Gridview..
            for (int i = 0; i < dt.Rows.Count; i++)
            {
                if (i < dt.Rows.Count - 1)
                {
                    for (int j = 3; j < dt.Columns.Count; j++)
                    {
                        foreach (DataRow dtrows in dtEmpDayDuties.Rows)
                        {
                            /*Matching Emp Code*/
                            if (dt.Rows[i][0].ToString() == dtrows[0].ToString())
                            {
                                /*Matching Emp Category */
                                if (dt.Rows[i][2].ToString() == dtrows[3].ToString())
                                {
                                    TextBox txtDuty = new TextBox();
                                    txtDuty.Text = dt.Columns[j].ColumnName.ToString();
                                    txtDuty.Text = dtrows[2].ToString();
                                    /*Matching Date*/
                                    if (Convert.ToString(j - 2) == dtrows[2].ToString())
                                    {
                                        dt.Rows[i][j] = dtrows[1].ToString(); /*Filling  Days wise duty*/
                                    }
                                }
                                /*Matching Emp Category */
                            }
                        }
                    }
                }
                if (i == dt.Rows.Count - 1)
                {
                    for (int j = 3; j < dt.Columns.Count; j++)
                    {
                        foreach (DataRow dtrows in dtdayDuties.Rows)
                        {
                            TextBox txtDuty = new TextBox();
                            txtDuty.Text = dt.Columns[j].ColumnName.ToString();
                            txtDuty.Text = dtrows[1].ToString();
                            if (Convert.ToString(j - 2) == dtrows[1].ToString())
                            {
                                dt.Rows[i][j] = dtrows[0].ToString();

                            }
                        }
                    }
                }
            }

            #endregion
            /**Fill Day Wise Attendance In Gridview**/

            #region Binding Grid
            grdSWiseEmpAttendance.DataSource = dt;
            grdSWiseEmpAttendance.DataBind();
            #endregion Binding Grid
            ViewState["tbldata"] = dt;/*used For Saving Employee Monthly Attendance*/
            Session["reportdata"] = dt;/*used For Printing Employee Monthly Attendance*/
            lblNoOfEmp.InnerText = (grdSWiseEmpAttendance.Rows.Count - 1).ToString();

        }

        void Page_Init(object obj, EventArgs e)
        {
            int days = DateTime.DaysInMonth(Convert.ToInt32(Request.QueryString["Year"]), Convert.ToInt32(Request.QueryString["Month"]));
            int dtinc = 0;
            for (int rowcnt = 0; rowcnt < days + 4; rowcnt++)
            {
                if (rowcnt == 0)
                {
                    BoundField nameColumn = new BoundField();
                    nameColumn.DataField = "EmpCode";
                    nameColumn.HeaderText = "EmpCode";
                    grdSiteWiseEmpAttendance.Columns.Add(nameColumn);

                }

                else if (rowcnt == 1)
                {
                    BoundField nameColumn = new BoundField();
                    nameColumn.DataField = "EmpName";
                    nameColumn.HeaderText = "EmpName";
                    grdSiteWiseEmpAttendance.Columns.Add(nameColumn);

                }
                else if (rowcnt == 2)
                {
                    BoundField nameColumn = new BoundField();
                    nameColumn.DataField = "DESIGNATION";
                    nameColumn.HeaderText = "DESIGNATION";
                    grdSiteWiseEmpAttendance.Columns.Add(nameColumn);

                }
                else if (rowcnt == days + 3)
                {
                    BoundField nameColumn = new BoundField();
                    nameColumn.DataField = "Total";
                    nameColumn.HeaderText = "Total";
                    grdSiteWiseEmpAttendance.Columns.Add(nameColumn);
                    nameColumn.ItemStyle.HorizontalAlign = HorizontalAlign.Center;
                }
                else
                {
                    dtinc = dtinc + 1;
                    string formet = "00";
                    TemplateField bfield = new TemplateField();
                    /**Initalize the DataField value**/
                    bfield.HeaderTemplate = new GridViewTemplate2(ListItemType.Header, Convert.ToString(dtinc.ToString(formet)));
                    /**Initialize the HeaderText field value**/
                    bfield.ItemTemplate = new GridViewTemplate2(ListItemType.Item, Convert.ToString(dtinc.ToString(formet)));
                    /**Add the newly created bound field to the GridView**/
                    grdSEmpAttendance.Columns.Add(bfield);
                }
            }
        }

    <div class="row">
                                                        <div class="col-lg-12">
                                                            <div class="table-responsive">
                                                                <asp:GridView ID="grdSiEmpAttendance" CssClass="table table-small-font table-bordered table-striped" Font-Size="Smaller" EmptyDataRowStyle-ForeColor="#cc0000" HeaderStyle-Font-Size="10" HeaderStyle-Font-Names="Arial" HeaderStyle-Font-Italic="true" runat="server" AutoGenerateColumns="false"
                                                                    BackColor="#f0f5f5" HeaderStyle-ForeColor="#990000">

                                                                    <Columns>
                                                                    </Columns>
                                                                    <HeaderStyle HorizontalAlign="Justify" VerticalAlign="Top"
                                                                        Font-Bold="true" />
                                                                    <RowStyle Font-Size="Small" Height="1" ForeColor="#000000" Font-Italic="true" />
                                                                </asp:GridView>
                                                            </div>
                                                        </div>

                                                    </div>

using System;
using System.Collections.Generic;
using System.Linq;
using System.Web;
using System.Web.UI.WebControls;
using System.Web.UI;

public class GridViewTemplate2 : ITemplate
{
    /**A variable to hold the type of ListItemType**/
         ListItemType _templateType;

    /**A variable to hold the column name**/
         string _columnName;

    /**Constructor where we define the template type and column Name**/
         public GridViewTemplate2(ListItemType type, string colname)
    {

        _templateType = type; /*Stores the template type*/
         _columnName = colname;/*Stores the column name*/
    }

    void ITemplate.InstantiateIn(System.Web.UI.Control container)
    {
        switch (_templateType)
        {
            #region For Use TemplateFields.

            case ListItemType.Header:
                /*Create a New Label control and add it to the container*/
                Label lbl = new Label();/*Allocates the new label object*/

                lbl.Text = _columnName;/*Assigns the name of the column in the lable*/
                lbl.Font.Name = "Calibri";

                //lbl.CssClass = "form-label";
                //lbl.Font.Bold = true;
                container.Controls.Add(lbl);/*Adds the New created label control to the container*/

                break;

            case ListItemType.Item:
                /**Creates a New Text box Control And Add It to the container**/
                TextBox tb1 = new TextBox();/*Allocates the new text box object*/
                tb1.DataBinding += new EventHandler(tb1_DataBinding);/*Attaches the data binding event*/
                tb1.CssClass = "vertical-text";
                string bxid = "txt" + _columnName;
                tb1.ID = bxid.Trim().ToString();
                tb1.Width = new Unit(35, UnitType.Pixel);
                tb1.Height = new Unit(15, UnitType.Pixel);
                //tb1.Style.Add("font-size", "8pt;");
                tb1.Font.Name = "Calibri";

                tb1.Columns = 3; /**Creates a column with size 4**/
                container.Controls.Add(tb1);/**Adds the New created textbox to the container**/
                break;

            case ListItemType.EditItem:

                break;

            case ListItemType.Footer:
                CheckBox chkColumn = new CheckBox();
                chkColumn.ID = "Chk" + _columnName;
                container.Controls.Add(chkColumn);
                break;

            #endregion
        }
    }

    /// <summary>
    /// This is the event, which will be raised when the binding happens.
    /// </summary>
    /// <param name="sender"></param>
    /// <param name="e"></param>
    /// 
    void tb1_DataBinding(object sender, EventArgs e)
    {
        #region For Use DataBinding Fields..
        TextBox txtdata = (TextBox)sender;
        GridViewRow container = (GridViewRow)txtdata.NamingContainer;
        object dataValue = DataBinder.Eval(container.DataItem, _columnName);
        if (dataValue != DBNull.Value)
        {
            if (dataValue.ToString().Trim() == "0".ToString() || dataValue.ToString().Trim()=="")
            {

                txtdata.Text = "";
                //txtdata.BackColor = System.Drawing.Color.BlanchedAlmond;
                //txtdata.ReadOnly = true;
                txtdata.Width = 35;
                txtdata.Height = 25;
                txtdata.CssClass = "form-control input-sm m-bot15";
                txtdata.Font.Size = 8;
            }

            if (dataValue.ToString().Trim() == "777" || dataValue.ToString().Trim() == "L")
            {

                txtdata.Text = "L";
                txtdata.BackColor = System.Drawing.Color.SandyBrown;
                //txtdata.ReadOnly = true;
                txtdata.Width = 35;
                txtdata.Height = 25;
                txtdata.CssClass = "form-control input-sm m-bot15";
                txtdata.Font.Size = 7;
            }

            if (dataValue.ToString().Trim() == "888" || dataValue.ToString().Trim() == "WO")
            {

                txtdata.Text = "WO";
                txtdata.BackColor = System.Drawing.Color.LightGreen;
                //txtdata.ReadOnly = true;
                txtdata.Width = 36;
                txtdata.Height = 25;
                txtdata.CssClass = "form-control input-sm m-bot15";
                txtdata.Font.Size = 7;
            }

            if (dataValue.ToString().Trim() == "999" || dataValue.ToString().Trim() == "PH")
            {

                txtdata.Text = "PH";
                txtdata.BackColor = System.Drawing.Color.Cornsilk;
                //txtdata.ReadOnly = true;
                txtdata.Width = 35;
                txtdata.Height = 25;
                txtdata.CssClass = "form-control input-sm m-bot15";
                txtdata.Font.Size = 7;
            }

            if (dataValue.ToString().Trim() == "1111" || dataValue.ToString().Trim() == "CL")
            {

                txtdata.Text = "CL";
                txtdata.BackColor = System.Drawing.Color.Bisque;
                //txtdata.ReadOnly = true;
                txtdata.Width = 35;
                txtdata.Height = 25;
                txtdata.CssClass = "form-control input-sm m-bot15";
                txtdata.Font.Size = 7;
            }

            if ((dataValue.ToString().Trim() != "1111") && (dataValue.ToString().Trim() != "CL") && (dataValue.ToString().Trim() != "2997") && (dataValue.ToString().Trim() != "HD") && (dataValue.ToString().Trim() != "777") && (dataValue.ToString().Trim() != "L") && (dataValue.ToString().Trim() != "888") && (dataValue.ToString().Trim() != "W/O")  (dataValue.ToString().Trim() != "") && (dataValue.ToString().Trim() != "1")&& 
            {

                txtdata.ReadOnly = false;
                txtdata.BackColor = System.Drawing.Color.LightGoldenrodYellow;
                txtdata.Text = dataValue.ToString();
                txtdata.Width = 35;
                txtdata.Height = 25;
                txtdata.CssClass = "form-control input-sm m-bot15";
                txtdata.Font.Size = 7;
                txtdata.Font.Bold = true;
            }
            if ((dataValue.ToString().Trim() != "1111") && (dataValue.ToString().Trim() != "CL") && (dataValue.ToString().Trim() != "2997") && (dataValue.ToString().Trim() != "HD") && (dataValue.ToString().Trim() != "777") && (dataValue.ToString().Trim() != "L") && (dataValue.ToString().Trim() != "888") && (dataValue.ToString().Trim() != "WO") && (dataValue.ToString().Trim() != "1776") && (dataValue.ToString().Trim() != "") && (dataValue.ToString().Trim() != "3000") && (dataValue.ToString().Trim() != "T") && (dataValue.ToString().Trim() != "1000") && 
            {

                txtdata.ReadOnly = false;
                txtdata.Text = dataValue.ToString();
                txtdata.Width = 35;
                txtdata.Height = 25;
                txtdata.CssClass = "form-control input-sm m-bot15";
                txtdata.Font.Size = 7;
                txtdata.Font.Bold = true;
            }

            //else
            //{
            //    txtdata.ReadOnly = false;
            //    txtdata.Text = dataValue.ToString();
            //    txtdata.Width = 35;
            //    txtdata.Height = 25;
            //    txtdata.CssClass = "form-control input-sm m-bot15";
            //    txtdata.Font.Size = 8;
            //    txtdata.Font.Bold = true;
            //}

        }
        else
        {
            txtdata.Text ="";
            txtdata.Width = 35;
            txtdata.Height = 25;
            txtdata.CssClass = "form-control input-sm m-bot15";
            txtdata.Font.Size = 8;
            txtdata.Font.Bold = true;
        }
        #endregion
    }

} 
```

# .net - 需要更快的 Excel 互操作方法

> ID：10537049
> 
> 赞同：1
> 
> 时间：2012-05-10T15:12:49.307
> 
> 标签：.net, com, excel-interop

众所周知，与 Excel 和 .Net 的互操作非常慢。我知道能够一次性将一组值复制到工作表对象，但根据我的秒表，甚至有一个类型的命令（在 VB.Net 内）：

```
 WS.Range(--range string here--).Value = array 
```

...耗时超过 0.3 秒！这加起来是因为我的例程向每个工作表写入了几十个数组，并且每个工作簿有几个工作表，我可能还会遍历几个工作簿。

如果有办法一次写入不连续的、非矩形的单元组，那么我可以用一个写入命令完成整个 WS。但我认为没有办法在保留“中间”单元格的原始值的同时做到这一点。这些工作簿是预先格式化的，所以我必须保留特定的单元格。

我能做些什么来加快速度吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-11T13:26:29.397

本在上面的评论几乎钉住了它；excel的公式计算是瓶颈。我松了一口气，因为我知道 .Net-Excel 互操作以缓慢着称，但没想到*这么*慢。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-11T13:31:19.487

我不知道这是否可能，但您查看了一个执行相同操作的库：[NPOI](http://npoi.codeplex.com/)。它可以读取和写入 Excel 文档。使用它使我的应用程序更快（将数据从 xls 获取到 C# 应用程序）

# cocos2d-iphone - CCFileUtils：从 Cocos2D-iphone 1.x 中的类方法过渡到 Cocos2D 2.x 中的实例方法

> ID：10537051
> 
> 赞同：1
> 
> 时间：2012-05-10T15:12:58.263
> 
> 标签：cocos2d-iphone

你可能知道，Cocos2D-iphone 1.x 中 CCFileUtils 的所有类方法都被重写为 Cocos2d 2.x 中的单例 [CCFileUtils sharedFileUtils] 的实例方法，所以不是

`[CCFileUtils fullPathFromRelativePath:... resolutionType:...]`

我们需要使用

`[[CCFileUtils sharedFileUtils] fullPathFromRelativePath:maskFileName resolutionType:&resolution]`

我编写了一个用于屏蔽精灵的扩展（http://www.cocos2d-iphone.org/forum/topic/30494），它大量使用 CCFileUtils，现在需要使其与 cocos2d 1.x 和 2.x 兼容

我知道 CC_ENABLE_DEPRECATED 标志，它有助于即时翻译这些调用，但我想有一个明确的解决方案。类似于类方法的东西，它将返回一个 id 以便像这样使用它：

```
Method:
+ (id) getCCFileUtils
{
id fileUtils = [CCFileUtils class];
if ([fileUtils instancesRespondToSelector:@selector(fullPathFromRelativePath:resolutionType:)])
{
    return [fileUtils sharedFileUtils];
}
else
{
    return fileUtils;
}
}
Usage:
id myFileUtils = [MyClass getCCFileUtils];

[myFileUtils fullPathFromRelativePath:maskFileName resolutionType:&resolution]

} 
```

当然，我在 Cocos 1.x 中收到错误“No known instance method for selector 'sharedFileUtils'”，因为没有这样的选择器。我应该如何重写它才能开始工作？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-11T20:26:35.090

好吧，我睡了一会儿后自己做的：）分享代码：

```
/**In Cocos2d v 2.0 CCFileUtils class methods were moved to instance methods.
 Here we set SSK_FILE_UTILS to class or instance depending on Cocos2D version.
 */
#ifdef COCOS2D_VERSION
    #if COCOS2D_VERSION >= 0x00020000
        #define SSK_FILE_UTILS [CCFileUtils sharedFileUtils]
    #else 
        #define SSK_FILE_UTILS CCFileUtils
    #endif
#else
    #define SSK_FILE_UTILS nil
#endif 
```

用法：

```
[SSK_FILE_UTILS fullPathFromRelativePath:... resolutionType:...] 
```

# c# - 将现有程序转换为 MVVM 模式

> ID：10537062
> 
> 赞同：4
> 
> 时间：2012-05-10T15:13:16.093
> 
> 标签：c#, .net, wpf, mvvm

几周后，我几乎完成了我的第一个 WPF 项目。现在我想重构并使我的应用程序尽可能清晰/可重用。

*将整个应用程序更改为MVVM*模式是否需要大量工作（意味着某些逻辑会完全改变？），是否会使应用程序更易于理解？除了 MVVM 之外，我还应该研究其他的东西吗？

基本上这个应用程序将由我以外的人使用，所以我的目标是让这个程序更简单，因为它在某些领域确实变得复杂了。

我的程序的总体布局包括：

*   10 个类（1 个使用 Singleton 的数据库类）
*   3个助手类
*   3 用户控制页面
*   大约 3 个班级的单身人士

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-10T15:18:20.443

> 更改整个应用程序是否需要大量工作？

这很难说，因为这取决于具体的项目以及之前的编码方式，但基本上它*从来都不*是少量的工作。

> 它会使应用程序更容易理解吗？

会说：不，但它肯定会使它更可测试和更可扩展。

> 除了 MVVM 之外，我还应该研究其他的东西吗？

它再次取决于具体项目（项目的目标客户是什么，谁将重用您的代码，项目的*预期*规模是多少......）

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-10T15:32:48.473

请记住，[使用 MVVM 模式需要一个框架](http://www.lhotka.net/weblog/UsingTheMVVMPatternRequiresAFramework.aspx)，否则工作量很大。我会推荐[Caliburn.Micro](http://caliburnmicro.codeplex.com/)，你也应该研究其他可用的[框架](https://stackoverflow.com/questions/4913946/looking-for-the-wpf-mvvm-framework)。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-10T15:17:34.467

重构工作将取决于现有代码。如果您从一开始就考虑到松散耦合，那么它应该不会花费太多精力。

以下是与开始使用 MVVM 相关的问题的链接。

[学习 WPF 和 MVVM - 从头开始​​学习的最佳方法](https://stackoverflow.com/questions/2541484/learning-wpf-and-mvvm-best-approach-for-learning-from-scratch)

[MVVM：从头到尾的教程？](https://stackoverflow.com/questions/1405739/mvvm-tutorial-from-start-to-finish)

[https://stackoverflow.com/questions/2267903/learning-mvvm-for-wpf](https://stackoverflow.com/questions/2267903/learning-mvvm-for-wpf)

如果您有任何具体问题，请更新问题以提及它。

# java - Java Web App 的 CPU 消耗率很高

> ID：10537066
> 
> 赞同：-1
> 
> 时间：2012-05-10T15:13:27.343
> 
> 标签：java, linux, multithreading, processors

我是新来的，我在 CPU 消耗和多线程方面不是很好。但我想知道为什么我的网络应用程序消耗了太多的 CPU 进程？我的程序所做的是在后台更新值，这样用户就不必等待数据的处理，而只需要根据请求获取它。更新过程是使用执行程序库的计划任务，它每 5 秒触发 8 个线程来更新我的数据。

现在我想知道为什么我的应用程序消耗了太多的 CPU。是因为代码不好还是因为服务器规格低？（2 个内核，2 个数据库和 1 个主要应用程序与我的 Web 应用程序一起运行）

非常感谢您的帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-10T15:41:27.517

保罗，

这里的人不可能说问题是您的代码效率低下还是服务器不符合规范。它可能是其中之一或两者，或其他东西。

你需要自己做一些研究：

*   分析代码。这将允许您确定您的 web 应用程序大部分时间都花在了哪里。

*   查看可供您使用的操作系统级别的统计信息。这可能会告诉您真正的问题是内存使用或磁盘 I/O。

*   看看后端数据库的性能。是不是占用了很多CPU？

一旦您确定了 CPU 正在使用的区域，您需要找出问题的真正原因并找出解决方法。一旦你实现了一个潜在的修复，你可以重新运行你的分析等，看看它是否有帮助。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-10T15:22:20.443

您需要分析您的应用程序以找出 CPU 的实际消耗位置。[Java 内置了一些基本的分析方法](http://www.javamex.com/tutorials/profiling/profiling_java5_threads_methodology.shtml)，或者如果您的环境允许，您可以运行内置的“hprof”编译器：

java -Xrunhprof ...

（实际上，您可能想要设置一些额外的选项：谷歌“hprof”了解更多详细信息。）

后者原则上更容易，但我提到了添加您自己的分析例程的可能性，因为它更灵活，并且您可以在运行另一个分析器更麻烦的 Servlet 环境中执行此操作。

# sql-server - SQL 更新查询

> ID：10537070
> 
> 赞同：3
> 
> 时间：2012-05-10T15:13:32.723
> 
> 标签：sql-server

我对 SQL 并不差，但我很难弄清楚这一点。

我有一个名为 的表`test`，其中有一个名为的字符列`key`和两个`datetime`名为`TestTime`and的列`LastTestTime`。

我正在尝试编写一个查询，该查询将更新所有行并将 的值设置为同一行`LastTestTime`的最新前一个。`TestTime``key`

这是我希望结果如何的示例：

```
key   testTime   lastTestTime
------------------------------
aaa   1/1/2012   null
aaa   1/2/2012   1/1/2012
aaa   1/3/2012   1/2/2012 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-10T15:31:55.407

这些都没有回答这个问题。提问者想要每次测试前最近的测试时间，而不是整体最近的时间：

```
UPDATE test 
    SET lastTestTime = (SELECT TOP(1) testTime
                        FROM test tt
                        WHERE test.key = tt.key AND tt.TestTime < test.TestTime
                        ORDER BY testTime DESC
                       ) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-10T15:19:45.910

```
UPDATE t
SET LastTestTime = t2.TestTime
FROM
    Test t JOIN 
    Test t2 
        ON t2.[Key] = t.[Key]
        AND t2.TestTime = (
            SELECT MAX(t3.TestTime)
            FROM Test t3
            WHERE 
                t3.TestTime < t.TestTime
                AND t3.[Key] = t.[Key]
        ) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-10T15:20:09.180

```
UPDATE test
SET lastTestTime = 
   (SELECT TOP(1) testTime 
    FROM test tt
    WHERE test.key = tt.key
    ORDER BY testTime DESC) 
```

# cyclomatic-complexity - 控制流图和圈复杂度

> ID：10537071
> 
> 赞同：0
> 
> 时间：2012-05-10T15:13:33.160
> 
> 标签：cyclomatic-complexity

我必须找到这段代码的控制流图和圈复杂度，然后提出一些白盒测试用例和黑盒测试用例。但是我在为代码制作 CFG 时遇到了麻烦。

也希望对测试用例有一些帮助。

```
private void downShift(int index)
{
    // index of "child", which will be either index * 2 or index * 2 + 1
    int childIndex;

    // temp storage for item at index where shifting begins
    Comparable temp = theItems[index];

    // shift items, as needed
    while (index * 2 <= theSize)
    {
        // set childIndex to "left" child
        childIndex = index * 2;

        // move to "right" child if "right" child < "left" child
        if (childIndex != theSize && theItems[childIndex + 1].compareTo(theItems[childIndex]) < 0)
            childIndex++;

        if (theItems[childIndex].compareTo(temp) < 0)
        {
        // shift "child" down if child < temp
            theItems[index] = theItems[childIndex];
        }
        else
        {
            // shifting complete
            break;
        }

        // increment index
        index = childIndex;
    }

    // position item that was originally at index where shifting began
    theItems[index] = temp;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-28T10:12:16.397

这里的基本圈复杂度是4：while + if + if + 1。如果你考虑像Understand或CMTJava所做的扩展圈复杂度，你还需要为合取加1，所以它是5。无条件控制语句如因为`break`不影响圈复杂度值。

# javascript - 无法让简单的 agility.js 工作

> ID：10537074
> 
> 赞同：1
> 
> 时间：2012-05-10T15:13:52.820
> 
> 标签：javascript, model-view-controller, agility.js

我正在尝试学习 agility.js，我认为应该是一个简单的例子，我无法开始工作，我不知道为什么。单击该按钮应将跨度的文本更改为“再见世界”，但单击什么也不做。有任何想法吗？

```
var message = 
        $$(
            {txt:'Hello World'}, 
            {format:'<span data-bind="txt" /><button id="btn">Click Me</button>'}, 
            {'click #btn' : function(){ this.model.set({txt:"Goodbye World"}) }}
        );

$$.document.append(message); 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-11T19:50:00.013

尝试将格式字符串包装在单个封闭标记中，例如 ... 这是 Agility 正常工作所必需的，但如果缺少它，Agility 不会抛出错误。

我让你的代码在这个 URL 上工作：http: [//jsbin.com/emacez/edit](http://jsbin.com/emacez/edit)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-20T06:54:19.570

你少了一个分号

```
{'click #btn' : function(){ this.model.set({txt:"Goodbye World"}); }}    <---- 
```

# javascript - 基于变量搜索JSON数组？

> ID：10537075
> 
> 赞同：1
> 
> 时间：2012-05-10T15:13:53.317
> 
> 标签：javascript, json

我有一个需要搜索的 JSON 数组：

```
[
{
      "Device_ID":"1",
      "Image":"HTC-One-X.png",
      "Manufacturer":"HTC",
      "Model":"One X",
      "Region":"GSM",
      "Type":"Phone"
   },
   {
      "Device_ID":"2",
      "Image":"Motorola-Xoom.png",
      "Manufacturer":"Motorola",
      "Model":"Xoom",
      "Region":"CDMA",
      "Type":"Tablet"
   },
   {
      "Device_ID":"8",
      "Image":"null",
      "Manufacturer":"Motorola",
      "Model":"Xoom 2",
      "Region":"CDMA",
      "Type":"Tablet"
   }
] 
```

使用关键字：`$_GET['keyword'];`我需要能够执行以下操作。搜索制造商和型号的组合值，即。摩托罗拉 Xoom。然后，对于与此匹配的任何一组值，将它们输出到变量。

例如：如果关键字是 HTC，那么它将搜索数组并输出：

```
$DeviceID = 1 $Image = HTC-One-X.png $Manufacturer = HTC $Model = One
X $Region = GSM $Type = Type 
```

但是，如果关键字是 Motorola，则需要输出包含 Motorola 的所有条目。

当用户键入关键字时，我试图做的是输出所有 JSON 数组条目的实时视图。但是我希望它在用户计算机上运行以减少服务器上的负载。

有谁知道解决这个问题的最佳方法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-10T15:33:41.190

well if you have a selection box with the values for the manufacturer in the options section it's as easy as:

HTML:

```
<select id="selectionBox">
  <option>...</option>
</select>
<div id="outPut">
  output goes in here
</div> 
```

Javascript:

```
var selectedValue = document.getElementById("selectionBox").value;
for(var i = 0; i < jsonObject.length; i++){
  if(jsonObject[i].Manufacturer === selectedValue){
    //considering your object is an array let's
    for(var key in jsonObject[i]){
      document.getElementById("outPut").innerHTML += jsonObject[i][key] + "</br>";
    }
  }
} 
```

that'll pretty much print everything in the object onto the output div, the rest is up to your styling.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-10T16:03:30.997

这是一个过滤 JSON 的函数。显示数据由您决定。

```
var devices = <your JSON array>;    

function filter(keyword, data) {
    var filteredArray = [], i, j;
    for (i = 0, j = data.length; i < j; i++) {
        if ((data[i].Manufacturer && data[i].Manufacturer.indexOf(keyword) !== -1) || (data[i].Model && data[i].Model.indexOf(keyword) !== -1)) {
            filteredArray.push(data[i]);
        }
    }
    return filteredArray;
}

// Example usage
var MotorolaDevices = filter('Motorola', devices); 
```

# c++ - 如何在对象的生命周期内持有 Boost upgradable_lock？

> ID：10537077
> 
> 赞同：1
> 
> 时间：2012-05-10T15:14:06.187
> 
> 标签：c++, boost, mutex, boost-interprocess

我正在实现一对用于进程间通信的类，其中一个进程将是唯一的编写者，并且会有很多读者。一类处理阅读；一个处理写作。为了防止任何其他进程成为编写器，我想要编写器类的单个对象，它在`boost::named_upgradable_mutex`其整个生命周期内保持可升级的锁。为此，编写器类有一个类型的成员变量，`boost::interprocess::upgradable_lock`在构造对象时将其传递给互斥锁。当写入器进程写入时，它会调用写入器类的 Write() 方法，该方法应该将该锁升级为独占锁，执行写入，并以原子方式将独占锁降级为仅可再次升级。

[通过遵循关于Lock Transfers Through Move Semantics](http://www.boost.org/doc/libs/1_49_0/doc/html/interprocess/synchronization_mechanisms.html#interprocess.synchronization_mechanisms.lock_conversions)的 Boost 文档，我设法在我的 writer 类的 Write() 方法中实现了第一部分 - 将锁升级为独占。但是，第二部分 - 将锁降级为可升级 - 导致类型为 boost::interprocess::upgradable_lock 的新局部变量将超出范围并在 Write() 返回时释放互斥锁。我需要将该可升级锁放回我的类的 upgradable_lock 成员变量中，以便升级功能将仅保留在我的 writer 对象中。最好的方法是什么？我唯一能想到的就是在返回之前将局部变量与我的成员变量交换。代码如下所示：

```
using boost::interprocess;
scoped_lock<named_upgradable_mutex> my_exclusive_lock(move(m_lock));

//  do write here

upgradable_lock<named_upgradable_mutex> my_demoted_lock(move(my_exclusive_lock));
m_lock.swap(my_demoted_lock);  //  how else to do this? 
```

这行得通，但最后一行真的违反直觉，我花了一段时间才想到。有没有更好的办法？是否可以将降级锁直接放入我的成员变量中？另外，重用成员变量来存储降级锁是否有任何意想不到的后果？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-05T19:02:20.943

考虑使用[移动赋值运算符](http://www.boost.org/doc/libs/1_49_0/doc/html/boost/interprocess/upgradable_lock.html#id1002515-bb)。以下代码使用`swap()`：

```
upgradable_lock<named_upgradable_mutex> my_demoted_lock(move(my_exclusive_lock));
m_lock.swap(my_demoted_lock); 
```

会成为：

```
m_lock = upgradable_lock<named_upgradable_mutex>(move(my_exclusive_lock)); 
```

在这种特殊情况下，`swap()`移动赋值运算符是可互换的，没有任何副作用，因为`m_lock`它处于默认构造状态 ( `m_lock.owns() == false`and `m_lock.mutex() == 0`)。

* * *

我想不出重用可升级锁的成员变量的任何意外后果。但是，有几个主题需要考虑：

*   一个目标是“防止任何其他进程成为作家”。在`Writer`构造函数中获取锁后，代码会阻止其他进程*创建*，`Writer`此外还会阻止其他进程*写入*。结果，阻塞调用可能对应用程序代码强加或不方便。考虑以下代码：

    ```
    Reader reader;
    Writer writer; // This may block, but the application code cannot react
                   // to it without dedicating an entire thread to the
                   // construction of the writer. 
    ```

    一种妥协的替代方法可能是*尝试*通过[此构造](http://www.boost.org/doc/libs/1_49_0/doc/html/boost/interprocess/upgradable_lock.html#id1002330-bb)函数获取锁，然后添加成员函数以`Writer`提供应用程序更多的控制权。虽然这仍然允许其他进程创建一个`Writer`，但它会阻止多个进程拥有写入权限：

    ```
    class Writer
    {
    public:
      bool IsPrivileged();         // Returns true if this the privileged Writer.
      bool TryBecomePrivileged();  // Non-blocking attempt to become the
                                   // privileged Writer.  Returns true on success.
      bool BecomePrivileged();     // Blocks waiting to become the privileged
                                   // Writer.  Returns true on success.
      void RelinquishPrivileges(); // We're not worthy...we're not worthy...

      enum Status { SUCCESS, NOT_PRIVILEGED };
      Status Write( const std::string& ); // If this is not the privileged Writer,
                                          // then attempt to become it.  If the
                                          // attempt fails, then return
                                          // NOT_PRIVILEGED.
    }; 
    ```

*   在该`Writer::Write()`方法中，如果“ *do write here* ”代码中的任何调用抛出异常，则堆栈将展开，导致：

    *   `my_exclusive_lock`释放独占锁，允许其他进程获得可升级锁。
    *   `m_lock`没有互斥体的句柄，正如在[move](http://www.boost.org/doc/libs/1_49_0/doc/html/boost/interprocess/scoped_lock.html#id1001212-bb)中将所有权转移到时`m_lock.mutex()`设置的那样。`null``my_exclusive_lock`
    *   进一步调用`Writer::Write()`将尝试在**不**获取排他锁的情况下进行写入！即使`m_lock`有一个互斥锁的句柄，`m_lock.owns()`也会是`false`，所以转移到`my_exclusive_lock`不会尝试锁定。

* * *

这是一个示例程序：

```
#include <boost/interprocess/sync/named_upgradable_mutex.hpp>
#include <boost/interprocess/sync/sharable_lock.hpp>
#include <boost/interprocess/sync/upgradable_lock.hpp>
#include <boost/move/move.hpp>
#include <iostream>

int main()
{
  namespace bip = boost::interprocess;
  typedef bip::named_upgradable_mutex mutex_t;

  struct mutex_remove
  {
    mutex_remove()  { mutex_t::remove( "example" ); }
    ~mutex_remove() { mutex_t::remove( "example" ); }
  } remover;

  // Open or create named mutex.
  mutex_t mutex( bip::open_or_create, "example" );

  // Acquire upgradable lock.
  bip::upgradable_lock< mutex_t > m_lock( mutex, bip::try_to_lock );
  std::cout << "upgradable lock own:  " << m_lock.owns()
            << " -- mutex: "            << m_lock.mutex() 
            << std::endl;

  // Acquire the exclusive lock.
  {
    std::cout << "++ Entering scope ++" << std::endl;
    std::cout << "Transferring ownership via move: Upgradable->Scoped"
              << std::endl;
    bip::scoped_lock< mutex_t > exclusive_lock( boost::move( m_lock ) );
    std::cout <<   "upgradable lock owns: " << m_lock.owns()
              << " -- mutex: "              << m_lock.mutex()
              << "\nexclusive lock owns:  " << exclusive_lock.owns() 
              << " -- mutex: "              << exclusive_lock.mutex()
              << std::endl;

    // do write here...

    // Demote lock from exclusive to just an upgradable.
    std::cout << "Transferring ownership via move: Scoped->Upgradable"
              << std::endl;
    m_lock = bip::upgradable_lock< mutex_t >( boost::move( exclusive_lock ) );
    std::cout <<   "upgradable lock owns: " << m_lock.owns()
              << " -- mutex: "              << m_lock.mutex()
              << "\nexclusive lock owns:  " << exclusive_lock.owns() 
              << " -- mutex: "              << exclusive_lock.mutex()
              << std::endl;
    std::cout << "-- Exiting scope --" << std::endl;
  }
  std::cout << "upgradable lock own:  " << m_lock.owns()
            << " -- mutex: "            << m_lock.mutex() 
            << std::endl;

  return 0;
} 
```

产生以下输出：

```
可升级锁拥有：1 -- 互斥锁：0xbff9b21c
++ 进入范围 ++
通过 move 转移所有权：Upgradable->Scoped
可升级锁拥有：0 -- 互斥锁：0
独占锁拥有：1 -- 互斥锁：0xbff9b21c
通过移动转移所有权：Scoped->Upgradable
可升级锁拥有：1 -- 互斥锁：0xbff9b21c
独占锁拥有：0 -- 互斥锁：0
-- 退出范围 --
可升级锁拥有：1 -- 互斥锁：0xbff9b21c
```

# javascript - 清除 cookie 并重定向到 html 页面的 Html 按钮

> ID：10537080
> 
> 赞同：1
> 
> 时间：2012-05-10T15:14:12.243
> 
> 标签：javascript, html

我一直在寻找不同的解决方案，但是你们中的任何人都知道编写一个清除 cookie 并重定向到某个页面的多个按钮的简单方法吗

我已经做到了这一点：

```
<script type="text/javascript">

$(document).ready(function(){
    deleteAllCookies();
}); 
```

现在我有一个链接，我只想让它刷新实际页面，清除 cookie，然后重定向到另一个页面。

有什么简单的方法可以做到这一点吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-05-10T15:28:07.070

刷新后无法运行进程，您无法知道页面是如何加载的。但是如果你想清除所有cookie而不是重定向到另一个页面，

派生自[Robert J. Walker 答案](https://stackoverflow.com/questions/179355/clearing-all-cookies-with-javascript#179514)的 deleteAllCookies() 函数，

```
function deleteAllCookies() {
    var cookies = document.cookie.split(";");

    for (var i = 0; i < cookies.length; i++) {
        var cookie = cookies[i];
        var eqPos = cookie.indexOf("=");
        var name = eqPos > -1 ? cookie.substr(0, eqPos) : cookie;
        document.cookie = name + "=;expires=Thu, 01 Jan 1970 00:00:00 GMT";
    }
}

function clearAndRedirect(link) {
    deleteAllCookies();
    document.location = link;
}

<a href="javascript:clearAndRedirect('start.html')">Start your bacon</a> 
```

* * *

**其他方式：**

如果你为你的锚标签设置了一个唯一的 id 或一个类，你也可以这样做，

```
<a href="#" class="startbacon">Start your bacon</a>

$(document).ready(function() {
    $(".startbacon").click(function() {
        deleteAllCookies();
        document.location = "start.html";
    });
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-10T15:19:58.320

要刷新页面，只需添加：

```
href="javascript:location.reload(true)" 
```

到你的锚标签。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-10T15:42:24.600

由于，您想要刷新整个页面将使用您的实际 DOM 代码进行刷新假设您的按钮如下所示：

```
<a href="#" id="dostuff">Click me</a> 
```

从您的示例代码中，我假设您正在使用 Jquery

当用户单击按钮时 a) 清除所有 cookie b) 设置了一个新 cookie，它作为“标志”工作，以检查您的页面是否已刷新 c) 页面已刷新 d) 您的代码检查“ flag" 如果设置，则再次清除 cookie 并重定向。对于我的代码，我使用[jquery 插件](http://jquery-howto.blogspot.com/2010/09/jquery-cookies-getsetdelete-plugin.html)来轻松操作 cookie，我还将使用 ocanal 的函数（好东西：D）

```
function deleteAllCookies() {
    var cookies = document.cookie.split(";");

    for (var i = 0; i < cookies.length; i++) {
        var cookie = cookies[i];
        var eqPos = cookie.indexOf("=");
        var name = eqPos > -1 ? cookie.substr(0, eqPos) : cookie;
        document.cookie = name + "=;expires=Thu, 01 Jan 1970 00:00:00 GMT";
    }
}

$(document).ready(function() {
    var test_flag = $.cookie('flag');
    //get cookie
    if (test_flag == "flag_is_set") {
        //if cookie is set clear all cookies once more and redirect

        deleteAllCookies();
        document.location = "myPage.html";
    }

    $("#dostuff").click(function() {
        //if button is clicked
        //clear all cookies
        deleteAllCookies();
        //set a new cookie as flag
        $.cookie('flag':'flag_is_set');
        //refresh page

        document.location.reload();
    });

});​ 
```

# html - 下拉列表未正确显示（项目旁边显示空白）

> ID：10537084
> 
> 赞同：1
> 
> 时间：2012-05-10T15:14:19.980
> 
> 标签：html, css, layout

我在导航栏上创建了一个下拉列表，但它没有正确显示。每当我尝试打开列表时，我的项目旁边都会显示一个空白区域，即使我将背景颜色设置为蓝色。我该如何解决？这是它的外观以及我的代码的图像。提前致谢！

![注意项目下拉列表周围的框](../Images/00f2135550f9fc00d7e2872caab003b3.png)

**HTML：**

```
<div id="container">
    <div id="header">
        <ul id="navBar">
            <li><a href="page1.html">Item1</a></li>
            <li><a href="page2.html">Item 2</a>
                <ul>
                    <li><a href="page3.html">Item 2.0</a></li>
                    <li><a href="page4.html">Item 2.1</a></li>
                    <li><a href="page5.html">Item 2.2</a></li>
                </ul>
            </li>
            <li><a href="page6.html">Item 3</a></li>
            <li><a href="page7.html">Item 4</a></li> 
            <li><a href="page8.html">Item 5</a></li>
            <li><a href="page9.html">Item 6</a></li>
        </ul>
    </div>
</div> 
```

**CSS：**

```
#container{
position:relative;
margin:0 auto 0;
width:960px;
}

#header ul#topnav ul, #header li{
float:left;
list-style:none;
margin:0;
padding:0;
}
#header li a:link, #header li a:visited, #header li a:hover{
display:block;
margin:0 2px 0 0;
padding:14px 20px;
color:#FFFFFF;
background-color:#159FC8;
}

#header ul#topnav ul li a:link, #header ul#topnav ul li a:visited{
border:none;
}

#header ul#topnav li.last a{
margin-right:0;
}

#header li li a:link, #header li li a:visited{
width:150px;
float:none;
margin:0;
padding:7px 10px;
font-size:12px;
font-weight:normal;
color:#FFFFFF;
background-color:#159FC8;
}

#header li li a:hover{
color:#666666;
background-color:#CCCCCC;
}

#header li ul{
background:#FFFFFF;
z-index:9999;
position:absolute;
left:-999em;
height:auto;
width:170px;
border-left:1px solid #CCCCCC;
border-bottom:1px solid #CCCCCC;
}

#header li ul a{width:140px;}

#header li ul ul{margin:-32px 0 0 0;}

#header li:hover ul ul{left:-999em;}

#header li:hover ul, #header li li:hover ul{left:auto;}

#header li:hover{position:static;}

#header li.last a{margin-right:0;}

#navBar{
width:960px;
height:45px;
clear:both;
margin:0;
padding:0;
list-style:none;
font-size:14px;
font-weight:bold;
font-family:Verdana, Arial, Helvetica, Sans-Serif;
color:#FFFFFF;
background-color:#159FC8;
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-10T15:43:58.873

看看这个。

[http://jsfiddle.net/qzMUd/](http://jsfiddle.net/qzMUd/)

# linux - 我可以从 fetch 中恢复 GIT 存储吗

> ID：10537086
> 
> 赞同：4
> 
> 时间：2012-05-10T15:14:29.587
> 
> 标签：linux, git, git-stash, git-fetch

我有一个 git repo，我的同事在他的 PC 上有一个克隆。无论出于何种原因，由于技术问题，我们丢失了他的存储库。

在我们失去他的回购之前不久，他藏了一些工作，我做了 a ，`git fetch`然后是`git merge master`.

是否可以获取存储的内容？该`git fetch`命令是否也会将存储区拉过来？

我可以查看所有远程分支，`git branch -a`但我需要隐藏的数据。

我们正在`git version 1.6.3.3`运行`Ubuntu 9.10 Karmic`

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-10T15:18:57.667

抱歉，我不相信你能从中恢复过来。（可以说，如果可以的话，这将是一个安全风险；有人可能在配置文件或其他东西中隐藏了密码。）

从文档（`git fetch --help`）：`Fetches named heads or tags from one or more other repositories, along with the objects necessary to complete them.`

关键词：**命名头**。可悲的是，存储不是一个命名的头（或标签）。

# vba - Excel VB 脚本

> ID：10537089
> 
> 赞同：1
> 
> 时间：2012-05-10T15:14:36.687
> 
> 标签：vba, excel

我有两组包含一些相同信息的数据。这些数据是关于人的姓名、生日和其他信息。每个人通过多列包含在一行中。

关于如何通过VB制作脚本以检查一组数据中一个人的所有信息以及另一组数据中的所有数据的任何想法？我需要突出显示不在两组中的任何名称。例如（如果 excel 中的另一种方式也可用）无法下载任何其他软件

**设置 1**

```
Somebody, Bob 9/2/2012 Male 
Someonelse, Joe 8/16/1950 Male 
```

**设置 2**

```
Somebody, Bob 9/2/2012 Male 
```

在这种情况下，我需要突出显示第 1 组中的某人，乔。

Acual 数据包含几千人。脚本的效率不是什么大问题，只要它能完成工作。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-10T15:34:20.690

> 你有一个例子吗？我对 Excel 的工作原理不是很熟悉。谢谢！– Scape 27 秒前

如果您的意图是查找不在 SET 2 中的值，则可以将 Countif 公式与 IF 公式结合使用。查看快照。

![在此处输入图像描述](../Images/c0e0b2b19b416a2c709f564a3fda8520.png)

如果要突出显示单元格，请使用公式使用条件格式:)

![在此处输入图像描述](../Images/690f04490d6378b7cdce86d805d15c38.png)

# android - Android 网站缩放/缩放 - iOS 适合屏幕？

> ID：10537091
> 
> 赞同：0
> 
> 时间：2012-05-10T15:14:39.247
> 
> 标签：android, mobile, responsive-design, meta-tags

我想知道为什么在我的**Android** ( *HTC Incredible 2* ) 上，我刚刚发布的网站最初是放大/缩放的渲染？在 iPhone / iOS 上 - 它呈现与桌面相同的宽度。

我已经在 Wordpress 211 主题 ( *http://wordpress.org/extend/themes/twentyeleven* ) 之上建立了网站 - 所以它的 META 仍然完好无损。但是我没有看到任何具有初始比例/缩放的地方；我确实看到了适合宽度的元数据。***例如*** `<meta name="viewport" content="width=device-width" />`

*这是我设备中每个浏览器的偏好，它以这种方式使用 META 吗？它是根据浏览器设置获取宽度，然后再次查看元数据吗？*..创建我的初始缩放？

**建议？**

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-22T04:59:31.100

Android 共有三种密度类别，默认情况下目标密度设置为中等。默认设置有效地放大页面。

要防止 Android 视口缩放（放大），您可以将视口密度设置为设备 API。

```
<meta name="viewport" content="target-densitydpi=device-dpi, width=device-width" /> 
```

通过 CSS 定位设备密度

```
<link rel="stylesheet" media="screen and (-webkit-device-pixel-ratio: 1.5)" href="hdpi.css" />
<link rel="stylesheet" media="screen and (-webkit-device-pixel-ratio: 1.0)" href="mdpi.css" />
<link rel="stylesheet" media="screen and (-webkit-device-pixel-ratio: 0.75)" href="ldpi.css" /> 
```

来源：http: [//developer.android.com/guide/webapps/targeting.html#ViewportScale](http://developer.android.com/guide/webapps/targeting.html#ViewportScale)

上面的例子取自上面的源链接。

# git - 推送所有本地 GIT 分支？最佳实践？

> ID：10537095
> 
> 赞同：9
> 
> 时间：2012-05-10T15:14:51.163
> 
> 标签：git, workflow, push

是否应该每天将所有本地创建的 GIT 分支推送到中央存储库？与此相关的最佳实践工作流程是什么？

我们创建了一个 GIT 存储库来管理我们的大型电子商务网站，该网站正在由一个大型团队持续开发。

中央存储库位于“Beanstalk”，我们有三个主要分支，“prestaging”（主）、“staging”和“production”。在本地完成并准备发布时，所有开发都应合并到 prestaging 中。

我也可以看到将长期运行的分支推向 Beanstalk。然而，我们的一些团队主张每天将所有本地开发分支推送到 Beanstalk 或不进行；创造冗余。我认为随着时间的推移，这会使存储库中出现数百个分支。什么是最佳实践？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-05-10T15:31:40.587

I prefer not polluting the central repo with *all* branches of *all* users.

Don't mix:

*   [publication workflow](https://stackoverflow.com/questions/3460897/git-workflow-everyone-has-a-branch-or-everyone-has-a-master/3461332#3461332): what you choose to publish (push/pull to an [upstream repo](https://stackoverflow.com/questions/2739376/definition-of-downstream-and-upstream/2749166#2749166))
*   backup need: use a **[bundle (See "Backup a Local Git Repository")](https://stackoverflow.com/questions/2129214/backup-a-local-git-repository/2129286#2129286)**, that way you have only *one* file to copy to any remote drive you want.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-10T15:29:47.693

I agree with you, using a central repo for backup of daily work is a bad idea. It should hold commits meant to be shared, tested or released.

Backup of daily work should either happen to another repo, more permissive, with optionally an automated `git push --force --all backup-repo` task on each dev machine, or have them a more classic backup tool.

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-05-10T15:17:31.590

您总是可以让用户在完成远程分支后清理他们的远程分支。为了安全起见，让他们将本地分支机构向上推并不是一个坏主意（尤其是在他们的盒子上没有备份解决方案的情况下）。否则，如果他们的机器死了，他们的本地分支就消失了。

# php - 为什么 PHPUnit 不将此函数计算为已运行？

> ID：10537100
> 
> 赞同：0
> 
> 时间：2012-05-10T15:15:07.580
> 
> 标签：php, phpunit

我的单元测试中有这样的代码：

```
// $item_id was defined above
$originalMock = $this->getMock( 'Item', array( 'foo' ), array(
  $item_id
));

$originalMock->expects( $this->once() )->method( 'foo' );

$originalMock->functionThatCallsFoo(); 
```

它是说我根本没有打电话`foo`，即使`functionThatCallsFoo`&`foo`是从内部转储的。

在公开调用的函数和我期望的函数之间有几个函数调用。我确保没有调用链下的静态函数。（最初有，但我改变了它们，看看我能不能让它工作）

**编辑** 我更改了`expects`调用以匹配直接调用的方法`functionThatCallsFoo`，但它仍然不起作用。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-10T15:49:09.023

我要回答这个问题，因为我的代码有很多问题。如果将来其他人有类似的问题，希望这个答案将是一个清单。

1.  我的最终方法是静态的，所以我需要使用 staticExpects 而不是期望
2.  我的静态调用使用 self:: 但我需要使用 static:: ( PHP >= 5.3 )
3.  static:: 不能用于私有函数，不像 self::

最后，我现在明白为什么静态函数是邪恶的了。

# wcf - 实例化服务对象内的 WCF 4.0 实例管理？

> ID：10537114
> 
> 赞同：0
> 
> 时间：2012-05-10T15:15:42.773
> 
> 标签：wcf, instance

我有一个使用每个实例调用模式的 WCF 服务。它是自托管的，根本不使用 IIS。服务类实例化另一个具有该模式的类

```
var myfoo = new Foo().GetResultFromDictionary(something); 
```

该类`Foo`从嵌入式资源中读取数据，进行一些查找，然后返回`Bar`服务类使用的对象。

为单个调用创建一个新实例`Foo()`似乎是一种浪费。加载后，服务的所有实例都应该能够进行调用。

有人对此有设计建议吗？如果这里没有问题（例如，如果 .NET Framework 会处理 .NET Framework 的实例管理），我不想陷入过度优化和预优化的陷阱`Foo`，但我不确定。

感谢所有想法，谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-16T17:52:26.737

我将研究 System.Runtime.Caching 位，创建一个静态类，在调用静态“构造函数”时插入 MemoryCache.Default，并在所有后续调用中从缓存中读取。

# c# - 用户配置文件不起作用

> ID：10537116
> 
> 赞同：1
> 
> 时间：2012-05-10T15:15:59.963
> 
> 标签：c#, asp.net, asp.net-profiles

我按照在线教程使用内置的 asp.net 分析器，但没有获取配置文件。每次运行 GetUserProfile 时它都返回 null：

这是我的调用代码：

```
 if (UserProfile.GetUserProfile() == null)
        {
            UserProfile.Create(Membership.GetUser().UserName);
        }
        UserProfile currentProfile = UserProfile.GetUserProfile();
        currentProfile.WorksAt = "WorksAt Test";
        currentProfile.Manages = "Manages Test";
        String WorksAt = currentProfile.WorksAt;
        String Manages = currentProfile.Manages; 
```

这是我的 Profile 类的代码：

```
 using System.Web.Profile;
        using System.Web.Security;

        public class UserProfile : ProfileBase
        {
            [SettingsAllowAnonymous(false)]
            public string WorksAt
            {
                get { return base["WorksAt"] as string; }
                set { base["WorksAt"] = value; }
            }

            [SettingsAllowAnonymous(false)]
            public string Manages
            {
                get { return base["Manages"] as string; }
                set { base["Manages"] = value; }
            }

            public static UserProfile GetUserProfile(string username)
            {
                return Create(username) as UserProfile;
            }

            public static UserProfile GetUserProfile()
            {
                return Create(Membership.GetUser().UserName) as UserProfile;
            }
        } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-10T15:35:48.267

从在线教程中弄清楚，我需要在 Web.config 中定义配置文件提供程序时添加 inherits="UserProfile"：

```
<profile defaultProvider="TestServerProfile" inherits="UserProfile">
        <providers>
            <clear/>
            <add name="TestServerProfile" type="System.Web.Profile.SqlProfileProvider" connectionStringName="TestServerConnection" applicationName="/"/>
        </providers>
  <properties>
    <group name="UserInformation">
      <add name="WorksAt" type="String" serializeAs="String" defaultValue=""  />
      <add name="Manages" type="String" serializeAs="String" defaultValue=""  />
    </group>
  </properties>
    </profile> 
```

# objective-c - 在 ObjC 中创建 UTType

> ID：10537117
> 
> 赞同：1
> 
> 时间：2012-05-10T15:16:01.333
> 
> 标签：objective-c, types

我知道某些 UT 类型（`kUTTypeJPEG`例如 ）符合`kUTTypeImage`. 如果我想声明我自己的 UTType（`kUTTypeMyImage`例如 ）并使现有的 UTType（如`kUTTypeJPEG`我之前所说的）符合它以`UTTypeConformsTo(existingUTType, kUTTypeMyImage)`返回 TRUE，该怎么办？

可能吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-08T00:38:19.347

您可以在应用程序的 info.plist 中设置它。

苹果文档在这里：http: [//developer.apple.com/library/mac/#documentation/FileManagement/Conceptual/understanding_utis/understand_utis_declare/understand_utis_declare.html#//apple_ref/doc/uid/TP40001319-CH204-SW1](http://developer.apple.com/library/mac/#documentation/FileManagement/Conceptual/understanding_utis/understand_utis_declare/understand_utis_declare.html#//apple_ref/doc/uid/TP40001319-CH204-SW1)

您需要密切关注，`UTTypeConformsTo`因为这是要设置的关键属性。

# asp.net - OpenSessionInView 模式、ADO 和性能

> ID：10537118
> 
> 赞同：0
> 
> 时间：2012-05-10T15:16:02.083
> 
> 标签：asp.net, ado.net, sqlcommand

我们在我们的 AspNet webapp 中使用 NHibernate 和 OpenSessionInView 模式。

使用 ADO 连接（SqlServer），我们希望在每次访问页面时登录不同的数据库。为此，我们是否需要在每次“页面加载”时打开一个连接，执行插入，然后关闭连接，还是我们可以在所有请求之间保持相同的连接共享？

锁和并发访问呢？我们只在这个数据库上插入。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-10T16:28:06.230

是的，我会选择`open --> insert --> close.`的原因是 SQL 连接 - 以及大多数数据库连接，取决于驱动程序 - 是池化的，所以打开一个新连接实际上意味着从池中获取一个连接，这很便宜（除非你用完了池中的连接）。另一方面，如果您坚持一个打开的连接，您最终会遇到大量的并发问题，因为您必须为每个请求同步对该连接对象的访问。换句话说，一场**噩梦。**实际上，您将**阻止**您的请求并大大减慢速度。

同样，您并没有真正提高性能 - 恰恰相反 - 并且您正在使您的应用程序复杂化。

# ruby-on-rails - 在 Rails 中创建 API 命名空间控制器

> ID：10537121
> 
> 赞同：0
> 
> 时间：2012-05-10T15:16:14.813
> 
> 标签：ruby-on-rails, unit-testing, ruby-on-rails-3.1, routes

我正在尝试测试我的命名空间控制器并且运气不佳。我有以下路线设置：

```
namespace :api do
  get 'organization/:id/questions/:number', controller: 'questions', action: 'index', as: 'organization_questions'
end 
```

产生以下路线：

```
api_organization_questions GET    /api/organization/:id/questions/:number(.:format)      {:controller=>"api/questions", :action=>"index"} 
```

该路线有效，我可以使用以下网址成功向它发出请求：[http://localhost:3000/api/organization/1/questions/1234567890](http://localhost:3000/api/organization/1/questions/1234567890)

但是，当我尝试`get`在单元测试中向它发出请求时，我收到以下错误：

> 没有路线匹配 {:controller=>"api/questions", :action=>"/api/organization/1/questions/1234567890"}

我的获取请求如下所示：

```
get api_organization_questions_path(@organization.id, '1234567890') 
```

不知道我做错了什么！？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-10T15:51:08.057

你用什么测试？规范？get 方法的第一个参数是操作。下面的代码应该发出您想要的请求：

```
describe Api::QuestionsController do
  it "should do something" do
    get :index, :id => @organization.id, :number => '1234567890'
  end
end 
```

# javascript - Safari 上的调试功能以了解何时将元素添加到页面

> ID：10537123
> 
> 赞同：0
> 
> 时间：2012-05-10T15:16:25.423
> 
> 标签：javascript, html, safari

Safari 上是否有可用的工具来确定何时将新元素添加到页面。我有一个页面，其中添加了不可见的元素，导致页面滚动。我认为原因所在的元素，似乎不是。我想知道是否有办法找出来。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-10T15:44:33.133

Safari 的内置调试工具仅限于 Chrome 和 Firefox 提供的工具，据我所知，您无法设置断点来检测何时插入节点。

如果你真的坚持使用 Safari 进行调试，你可以使用如下事件监听器：

```
document.addEventListener('DOMNodeInserted', function (event) {
    console.log('This element was added to the page:', event.target);
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-10T15:19:30.393

使用 Web Inspector（或 Chrome 开发人员工具），右键单击 BODY 元素（或更具体的元素，实际添加元素的位置），然后在上下文菜单中选择“中断子树修改”。只要选定元素的子树被修改（添加/删除元素），您的 JS 代码就会中断。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-10T15:28:15.573

我认为您可以使用“突变观察者”。

# php - 如何在正则表达式中使用常量或 var 进行 preg_match/preg_match_all？

> ID：10537129
> 
> 赞同：1
> 
> 时间：2012-05-10T15:16:41.990
> 
> 标签：php, preg-match, constants, preg-match-all

我有以下模式：

```
preg_match( "/^(.*?\/wp-content\/)([^\?]+)(.*)$/", $src, $src_bits ); 
```

现在我想设置一个名为保存文件夹名称`wp-content`的常量。`WP_CONTENT_FOLDERNAME`我该怎么做？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-10T15:18:04.920

只需使用 PHP：

```
preg_match( "/^(.*?\/" . WP_CONTENT_FOLDERNAME . "\/)([^\?]+)(.*)$/", $src, $src_bits ); 
```

# c++ - 如何将方法作为回调传递给另一个类？

> ID：10537131
> 
> 赞同：0
> 
> 时间：2012-05-10T15:17:03.180
> 
> 标签：c++, callback

我对使用 tr1::function 的回调有疑问。我已经定义了以下内容：

```
 class SomeClass {
    public:
      typedef std::tr1::function<void(unsigned char*, int)> Callback;
      void registerCallback(Callback);
    private:
      Callback callback;
  } 
```

我定义了另一个类：

```
 class SomeOtherClass {
      void myCallback(unsigned char*, int);

  } 
```

现在我想使用方法'registerCallback'将我的函数'myCallback'注册为类'SomeClass'的回调。但是，它不起作用。我查看了有关该函数的 boost 文档，使用类的（成员）方法进行回调似乎是合法的。我错了吗？

提前致谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-10T16:06:32.943

成员函数有一个隐式的第一个参数，一个`this`指针，以便知道要在哪个对象上调用函数。通常，它对您是隐藏的，但是要将成员函数绑定到 std::function，您需要在模板参数中显式提供类类型。

```
#include <functional>
#include <iostream>

struct Callback_t {
    void myCallback(int)
    {
        std::cout << "You called me?";
    }
};

class SomeClass {
public:
    SomeClass() : callback() { }
    typedef std::function<void(Callback_t*, int)> Callback;
                           //  ^^^^^^^^^^^

    void registerCallback(const Callback& c)
    {
        callback = c;
    }

    void callOn(Callback_t* p)
    {
        callback(p, 42);
    }
private:
    Callback callback;
};

int main()
{
    SomeClass sc;
    sc.registerCallback(&Callback_t::myCallback);

    Callback_t cb; // we need an instance of Callback_t to call a member on
    sc.callOn(&cb);
} 
```

输出：`You called me?`;

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-10T15:29:54.900

Why all this complicated mumbo-jumbo?

Why not create a class as thus (for example)

```
Class MouseOverEventCallBack
{
   public:
      virtual void RunMouseOverCallback() = 0;
}; 
```

Then just create classes that inherit this class (and redefine the method `RunMouseOverCallback`)

Then Register function just needs to be

```
void registerCallback(MouseOverEventCallBack *callbackObject); // possible could use a reference 
```

The register method will just call the method and the object will have all that it needs.

Seems a bit simpler. Let the compiler do the work with pointers to functions etc.

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-10T15:21:16.910

该函数`void (*)(unsigned char*, int)`是一个自由函数，它与 的类型不同`void (SomeOtherClass::*)(unsigned char*, int)`，因此出现错误。你需要一个对象来调用后者，而前者是一个自由函数。

查看[Boost 文档中列出的可能解决方案](http://www.boost.org/doc/libs/1_49_0/doc/html/function/tutorial.html#id1529941)

另一种可能性是您`SomeOtherClass::myCallback`是私人的，因此您无权访问它。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-08-12T12:34:40.563

使用模板：

```
template <class T>
class B
{
  public:
    typedef void (T::*TCallBackFunction)(void);   
    void SetCallBack(T* pCallBackClass, TCallBackFunction pCallBackFunction)
    {
      if(pCallBackFunction && pCallBackClass)
      {
        m_pCallBackFunction = pCallBackFunction;
        m_pCallBackClass = pCallBackClass;
      }
    }
    void StartCallBackFunction()
    {
      (pCallBackClass->(*m_pCallBackFunction))();
    }
  private:
    TCallBackFunction m_pCallBackFunction;
    T* m_pCallBackClass;
}; 
```

像这样。并使用它：

```
...
B<MyClass> b;
b.SetCallBack(&b, &MyClass::MyFunction);
... 
```

# php - 更改图像 px

> ID：10537133
> 
> 赞同：0
> 
> 时间：2012-05-10T15:17:04.127
> 
> 标签：php, gd

我想改变图像的颜色（几乎变成红色），但我只创建了一行半。为什么？

```
<?php    
$imgname = "test/test.png";
$im = imagecreatefrompng($imgname);

$w = imagesx($im); // image width
$h = imagesy($im); // image height

for($i=0;$i<$w;$i++){
    for($j=0;$j<$h;$j++){
        $color=imagecolorallocatealpha ($im, 255, 0, 0,255);
        imagesetpixel ($im, $i, $j, $color);
    }
}

$imgname = "test/result.png";
imagepng($im, $imgname ); // save image as png
imagedestroy($im);

echo "<img src='test/result.png'>";
?> 
```

如果我在“for”之前移动“imagecolorallocatealpha”，它会起作用......但将来我需要让每个像素都有不同的颜色

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-03T12:36:49.693

`alpha`参数（函数中的最后一个`imagecolorallocatealpha`）应介于 0 和 127 之间。您的值 255 超出范围。如果你让它符合[规范](http://fr2.php.net/manual/en/function.imagecolorallocatealpha.php)，你的代码就可以在我的机器上运行。

# iphone - ViewController respondsToSelector:]: 消息发送到释放的实例

> ID：10537147
> 
> 赞同：2
> 
> 时间：2012-05-10T15:17:40.677
> 
> 标签：iphone, objective-c, xcode

当我启用“僵尸对象”时，我收到此错误（“ViewController respondsToSelector:]: message sent to deallocated instance”）。我发现错误在哪里，但我不知道如何解决它。

这是代码： **ViewController.h**

```
#import <UIKit/UIKit.h>

@interface ViewController : UIViewController <UISearchDisplayDelegate, UISearchBarDelegate>{

    // The saved state of the search UI if a memory warning removed the view.
    NSString        *savedSearchTerm;
    NSInteger       savedScopeButtonIndex;
    BOOL            searchWasActive;
}

@property (nonatomic, copy) NSString *savedSearchTerm;
@property (nonatomic) NSInteger savedScopeButtonIndex;
@property (nonatomic) BOOL searchWasActive; 
```

**视图控制器.m**

```
...
// when I comment out "viewDidDisappear" everything is ok, how to solve this on different way?
- (void)viewDidDisappear:(BOOL)animated
{
    // save the state of the search UI so that it can be restored if the view is re-created
    self.searchWasActive = [self.searchDisplayController isActive];
    self.savedSearchTerm = [self.searchDisplayController.searchBar text];
    self.savedScopeButtonIndex = [self.searchDisplayController.searchBar selectedScopeButtonIndex];
}... 
```

感谢帮助

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-07-05T11:36:51.027

你在做什么来“创造”这个错误？

I my case, I popped the ViewController off the navigation stack and there were still NSNotifications sent to this VC. I simply forgot to remove all observers to my VC.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-10T16:07:17.957

您应该将 [super viewDidDisappear:animated] 放在覆盖的开头，因为这是默认实现。忘记那条线有时会导致问题。

编辑：

我认为您可能需要发布更多代码。关键可能在于您正在做或不做的其他事情。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-14T09:46:39.680

```
/*
- (void)viewDidDisappear:(BOOL)animated
{
    // save the state of the search UI so that it can be restored if the view is re-created
    self.searchWasActive = [self.searchDisplayController isActive];
    self.savedSearchTerm = [self.searchDisplayController.searchBar text];
    self.savedScopeButtonIndex = [self.searchDisplayController.searchBar selectedScopeButtonIndex];
}
*/ 
```

# jquery - 如何使fancybox灯箱出现在页面加载中

> ID：10537149
> 
> 赞同：2
> 
> 时间：2012-05-10T15:17:42.907
> 
> 标签：jquery, fancybox

嗨，我需要一些帮助，以便在页面加载时打开一个 fancybox 灯箱。

这是我的[示例页面](http://www.meandhimclients.co.uk/beachhorizon/bh_wordpressdev/wp-content/themes/beach%20horizon/lighttest.html)

我想要实现的是在页面加载时打开一个灯箱，并在灯箱内打开一个 html 页面，例如 iframe。

我的 js 调用是：

```
jQuery(document).ready(function() {
    $.fancybox(

        {
      'autoDimensions'  : false,
      'width'               : 350,
      'height'              : 650,
      'transitionIn'        : 'none',
      'transitionOut'       : 'none',
      'type': 'iframe',
      'href': 'http://www.meandhimclients.co.uk/beachhorizon/bh_wordpressdev/wp-content/themes/beach%20horizon/lighttest.html'
        }
    );
}); 
```

灯箱确实加载了，所以 js 没问题，但我的 html 页面没有在窗口中加载。任何帮助表示赞赏。

谢谢罗伯

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-11T18:44:21.307

您是否编辑了您的`fancybox.js`文件版本？它似乎已损坏。尝试下载并重新安装。

你得到这个错误：

```
Timestamp: 11/05/2012 11:29:38 AM
Error: missing ) after argument list
Source File: http://www.meandhimclients.co.uk/beachhorizon/bh_wordpressdev/wp-content/themes/beach%20horizon/js/jquery.fancybox-1.3.4.pack.js
Line: 45
Source Code:
b.fn.fancybox.defaults={padding:10,margin:40,opacity:false,modal:false,cyclic:false,scrolling:"auto",width:560,height:340,autoScale:true,autoDimensions:true,centerOnScroll:false,ajax:{},swf:{wmode:"transparent"},hideOnOverlayClick:true,hideOnContentClick:false,overlayShow:true,overlayOpacity:0.7,overlayColor:"#777",titleShow:true,titlePosition:"float",titleFormat:null,titleFromAlt:false,transitionIn:"fade",transitionOut:"fade",speedIn:300,speedOut:300,changeSpeed:300,changeFade:"fast",easingIn:"swing", 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-10T15:39:34.510

我不知道这是否是你的问题的原因，但你有两次调用 fancybox：一次缩小，一次完整源

```
<!-- HERE -->
<script type="text/javascript" src="http://www.meandhimclients.co.uk/beachhorizon/bh_wordpressdev/wp-content/themes/beach horizon/js/jquery.fancybox-1.3.4.js"></script>
<script type="text/javascript" src="http://www.meandhimclients.co.uk/beachhorizon/bh_wordpressdev/wp-content/themes/beach horizon/js/jquery.easing-1.3.pack.js"></script>
<!-- AND HERE -->
<script type="text/javascript" src="http://www.meandhimclients.co.uk/beachhorizon/bh_wordpressdev/wp-content/themes/beach horizon/js/jquery.fancybox-1.3.4.pack.js"></script>
<script src="http://www.meandhimclients.co.uk/beachhorizon/bh_wordpressdev/wp-content/themes/beach horizon/js/fancyboxcall.js"></script> 
```

使用相对路径也更具可读性（我以为您是在外部链接）：

```
<script type="text/javascript" src="/beachhorizon/bh_wordpressdev/wp-content/themes/beach horizon/js/jquery.fancybox-1.3.4.pack.js"></script>
<script type="text/javascript" src="/beachhorizon/bh_wordpressdev/wp-content/themes/beach horizon/js/jquery.easing-1.3.pack.js"></script>
<script type="text/javascript" src="/beachhorizon/bh_wordpressdev/wp-content/themes/beach horizon/js/fancyboxcall.js"></script> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-12T10:53:46.563

Fancybox 不是图像查看器而不是 iframe 弹出窗口吗？如果你想要一个 iFrame 弹出，你可以创建一个边框图像，然后在其中制作一个 iframe，然后在`document.ready`函数中，让它以淡入淡出的形式出现，如下所示：

```
document.ready(function(){
  $("lightbox").fadeIn();
}); 
```

# javascript - HTML & JQuery：将数据从一页移动到第二页

> ID：10537153
> 
> 赞同：0
> 
> 时间：2012-05-10T15:17:54.423
> 
> 标签：javascript, jquery, html

我正在使用 HTML 和 JQuery（没有 PHP）开发一个应用程序，我有两个页面，index.html 和 register.html。在第一页 (index.html) 上，您需要输入卡号，然后单击提交。当用户这样做时，我移动到第二页，我有一个隐藏的输入。

这是代码，index.html

```
<form id="RegisterForm" method="post" data-ajax="false" id="registerCardForm" action="register.html"> 
        <input type="text" id="cardNumberRegField" type="tel"  name="cardNumber" class="required number register" minlength="16" maxlength="16" /> 
        <input name="Submit" type="submit" class="button" value="Register"/>
    </form> 
```

注册.html

```
<input  id="tfscCardNumber" type="hidden" name="tfscCardNumber" class="readonly" minlength="2" maxlength="20" readonly="readonly" disabled="disabled"/> 
```

所以我的问题是如何在页面完全加载之前将第一页中的数字加载到第二页中的隐藏输入中？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-10T15:24:04.013

也许**使用一个网页**而不是两个网页会更简单？

将当前每个页面的内容放入`div`单个页面的 s 中。在页面加载时，仅显示第一个`div`. 当用户单击时，隐藏第一个`div`并显示第二个`div`。

您可以将用户的输入保存在隐藏输入中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-10T15:26:09.567

I would use cookie for that, with jquery cookie plugin. [https://github.com/carhartl/jquery-cookie](https://github.com/carhartl/jquery-cookie)

On Submit, store in cookie, on load, use cookie !

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-10T15:21:25.950

你没有。帖子严格在服务器端处理。一旦服务器处理完信息，就会呈现html并推出页面。如果您将方法更改为`get`，则 url 将包含表单的所有变量，您可以使用 jQuery 将其解析出来。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-10T15:21:27.057

可能您可以将表单的方法属性设置为“get”，以便参数位于 URL 中，然后在 register.html 上您可以解析该参数的 document.location。

希望能帮助到你。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-05-10T15:21:58.523

如果没有服务器端脚本，唯一的方法是在 url 中或使用 cookie。请记住，此时数据已完全公开，并且易于操作。更不用说，有了url中的数据，它会在浏览器历史中留下痕迹。

在做这样的事情时，认真考虑服务器端脚本。

# javascript - 使用 TowerJS 创建登录表单

> ID：10537160
> 
> 赞同：0
> 
> 时间：2012-05-10T15:18:22.753
> 
> 标签：javascript, node.js, javascript-framework, towerjs

首先我要说的是，我主要是一名前端设计师/开发人员，对 MVC 几乎没有经验。

我想使用 TowerJS 创建一个登录表单。我的大部分应用程序都是开箱即用的。我有一个名为“用户”的模型：

```
class App.User extends Tower.Model
  @field "email", type: "String"
  @field "userName", type: "String"
  @field "password", type: "String"
  @field "active", type: "Boolean", default: -> true

  @validates "userName", presence: true
  @validates "email", presence: true, format: /\w+@\w+.com/
  @validates "password", presence: true

  @timestamps() 
```

对于“新”用户视图，我包括“表单”部分：

```
formFor @user, (f) ->
  f.fieldset (fields) ->
    fields.field "email", as: "string"
    fields.field "userName", as: "string"
    fields.field "password", as: "string"
    fields.field "active", as: "string"
  f.fieldset (fields) ->
    fields.submit "Submit" 
```

如果我为我的登录表单使用“表单”部分，它将包含我不想要的字段（例如“活动”）。如果我使用一个名为“登录”的新部分：

```
formFor @user, (f) ->
  f.fieldset (fields) ->
    fields.field "email", as: "string"
    fields.field "password", as: "string"
  f.fieldset (fields) ->
    fields.submit "Submit" 
```

然后表单不会呈现，因为似乎 Tower 期待`User`表单中的所有字段，因为它被传递了`@user`。这真的归结为我对如何渲染模型缺乏高层次的理解。我认为呈现此登录表单的两个选项是：

1.  完全使用“表单”部分，并分别通过 css/back-end-js 隐藏/忽略不相关的字段或...
2.  创建某种只包含我关心的登录字段（电子邮件、密码）的新模型，然后`formFor`在该模型上使用。这对我来说似乎很愚蠢，因为我正在处理用户，所以我直觉上觉得我应该使用该`User`模型。

也许答案在于创建一个`Session`模型，但我不确定所有这些部分如何在 TowerJS 中协同工作。需要明确的是，问题是：**使用 TowerJS 呈现登录表单的*****正确*****方法是什么？**

 ** * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-08T14:36:01.923

尝试这个：

```
formFor @user, (f) ->
  f.fieldset (fields) ->
    fields.field 'email', as: 'string'
    fields.field 'userName', as: 'hidden'
    fields.field 'password', as: 'string'
    fields.field 'active', as: 'hidden'
  f.fieldset (fields) ->
    fields.submit 'Submit' 
```

此外，根据文档中的样式指南，您应该尽可能使用单引号。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-10T17:41:22.437

1.  在 app/views/users 中创建一个名为 _login.coffee 的新文件，其中只包含您想要的字段。像这样：

    ```
    formFor @user, (f) ->
      f.fieldset (fields) ->
        fields.field "email", as: "string"
        fields.field "password", as: "string"
      f.fieldset (fields) ->
        fields.submit "Submit" 
    ```

2.  编辑文件 app/views/users/new.coffee 以使`partial "form"`现在读取的行变为`partial "login"`.

现在您的视图应该正确呈现。当然，您现在将密码存储为明文等，但那是另一回事了……*

# twitter - Twitter计数器显示随机数

> ID：10537161
> 
> 赞同：1
> 
> 时间：2012-05-10T15:18:24.767
> 
> 标签：twitter, blogger

我刚刚在我的[博客](http://www.zombiekb.com)上的每个帖子下添加了 Twitter 按钮，但是每个按钮上显示的推文编号是相同的并且是随机的。

除此之外，如果我输入帖子，显示的数字会发生变化：S

对这个问题有任何想法吗？

编辑：

这是我实际用于 Twitter 按钮的代码

```
<a class='twitter-share-button' data-count='horizontal'data-lang='it'
data-via='ZOMBIEKB' expr:data-text='data:post.title'
expr:data-url='data:post.url' href='https://twitter.com/share'>Tweet</a>

<script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)
[0];if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src=&
quot;//platform.twitter.com/widgets.js&quot;;fjs.parentNode.insertBefore
(js,fjs);}}(document,&quot;script&quot;,&quot;twitter-wjs&quot;);</script> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-10T16:56:52.177

每个小部件`data-url`都必须指向它所描述的帖子的网址，而不是您的博客网址：

是的：`data-url="http://www.zombiekb.com/url-to-this-post/"`

不：`data-url="http://www.zombiekb.com/"`

# mysql - MySQL SQL_NO_CACHE 不工作

> ID：10537165
> 
> 赞同：1
> 
> 时间：2012-05-10T15:18:51.193
> 
> 标签：mysql, node.js, innodb

我有一个表（InnoDB），它经常被插入、更新和读取（通常相隔几毫秒）。我注意到有时在 INSERT/UPDATE 之后的 SELECT 语句会得到陈旧的数据。我认为这是由于缓存造成的，但是放在`SQL_NO_CACHE`它前面之后并没有真正做任何事情。

你如何确保 SELECT 总是等到前一个 INSERT/UPDATE 完成并且不从缓存中获取数据？请注意，这些语句是从单独的请求中执行的（不在同一代码执行中）。

也许我误解了 SQL_NO_CACHE 实际上做了什么......

**更新**：

@Uday，INSERT、SELECT 和 UPDATE 语句如下所示：

`INSERT myTable (id, startTime) VALUES(1234, 123456)`

`UPDATE myTable SET startTime = 123456 WHERE id = 1234`

`SELECT SQL_NO_CACHE * FROM myTable ORDER BY startTime`

我尝试使用没有运气的交易。

**更多更新**：

我认为这实际上是 INSERT 的问题，而不是 UPDATE 的问题。SELECT 语句总是尝试获取按时间排序的最新行。但由于 INSERT 不执行任何表级锁定，因此 SELECT 可能会获取旧数据。执行 INSERT 时有没有办法强制表级锁定？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-10T15:44:09.107

查询缓存不是问题。写入使缓存无效。

MySQL 优先考虑写入，并且使用默认隔离级别 (REPEATABLE READ)，您的 SELECT 将不得不等待 UPDATE 完成。

[如果您为 MyISAM 启用了CONCURRENT INSERTS](http://dev.mysql.com/doc/refman/5.1/en/concurrent-inserts.html) ，则可以对 INSERT 进行不同的处理，InnoDB 也使用记录锁定，因此它不必等待表末尾的插入。

那么这可能是一种竞争条件吗？您确定您的 SELECT 发生在 UPDATE 之后吗？您是否正在从可能尚未传播更新的复制服务器中读取？

如果问题出在并发 INSERT 上，您需要在 MyISAM 上禁用 CONCURRENT INSERT，或者在 INSERT 期间使用 LOCK TABLES 显式锁定表。InnoDB 的解决方案是相同的，使用 LOCK TABLES 显式锁定 INSERT 上的表。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-10T15:27:15.760

A）
如果您根本不需要缓存（对于任何 SELECT），请完全禁用查询缓存。

B）
如果你只想要一个会话，你可以像“set session query_cache_type = 0;”那样做 这将为该特定会话设置此设置。

在任何一种情况下都额外使用 SQL_NO_CAHCE。

# javascript - Kindle Fire 与 iScroll 的兼容性问题

> ID：10537173
> 
> 赞同：0
> 
> 时间：2012-05-10T15:19:10.010
> 
> 标签：javascript, android, html, kindle, iscroll

我在网站上使用 iScroll，所有网络浏览器都很好。但是当我尝试使用 Kindle Fire 设备访问它时，我无法在我的页面上滚动。

当我使用 Android 原生浏览器或 Firefox/Chrome Mobile 时，它​​可以正常工作。

我使用 iScroll 最简单的方法：

```
var MyScroll = new iScroll('left_wrap'); 
```

Kindle Fire 原生浏览器有问题吗？（Android 2.3；应用程序 Webkit）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-07T17:44:09.820

这可能是因为 Kindle Fire 原生浏览器不支持“溢出：自动”触摸滚动：

[http://www.amazon.com/gp/help/customer/forums/kindleqna/ref=cm_cd_pg_newest?ie=UTF8&cdForum=Fx1GLDPZMNR1X53&cdPage=1&cdSort=oldest&cdThread=Tx1NHWJIHDRU49Y](http://www.amazon.com/gp/help/customer/forums/kindleqna/ref=cm_cd_pg_newest?ie=UTF8&cdForum=Fx1GLDPZMNR1X53&cdPage=1&cdSort=oldest&cdThread=Tx1NHWJIHDRU49Y)

虽然如果您使用 Mobile FireFox，Kindle Fire 显然支持它：

[http://www.softufacture.com/mobile](http://www.softufacture.com/mobile)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-24T15:48:26.313

最后，我使用 YUI 滚动视图解决了它，它工作得很好

# c# - 在 C# 中以编程方式构建 Excel worksheet.range

> ID：10537174
> 
> 赞同：1
> 
> 时间：2012-05-10T15:19:13.410
> 
> 标签：c#, excel

希望你能帮忙。

我正在寻找一种通过传入一些参数来构建 excel 工作表范围的方法。我的方法如下：

```
private void TableCellformatting(int rowStart, int rowEnd, char colStart, char colEnd)
    {
        char temp;
        StringBuilder s = new StringBuilder();
        excelSheetRange = null;
        for (int i = rowStart; i <= rowEnd; i++)
        {
            temp = colStart;
            while (temp <= colEnd)
            {
                if (s.Length > 0)
                    s.Append(", ");
                s.Append(string.Format("{0}{1}", temp.ToString(), i));
                temp++;
            }
        }
        excelSheetRange = excelSheet.get_Range(s.ToString());
        excelSheetRange.HorizontalAlignment = Microsoft.Office.Interop.Excel.XlHAlign.xlHAlignCenter;
    } 
```

这运行正常，直到调用 excelSheet.get_Range 部分。当我手动传递单元格号码时，我必须这样做：

```
get_Range("A1", "A2" etc...) 
```

如果这是可能的，或者是否有其他方法，有什么想法吗？

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-10T15:32:08.723

使用`worksheet.range` [属性](https://web.archive.org/web/20150107183159/http://msdn.microsoft.com/en-us/library/microsoft.office.tools.excel.worksheet.range(v=vs.80).aspx)。

```
excelSheetRange = excelSheet.Range[excelsheet.Cells[rowstart, colstart], excelsheet.Cells[rowend, colend]]; 
```

# c++ - 没有类的对象 - 'clean C' 中的数据模型

> ID：10537176
> 
> 赞同：4
> 
> 时间：2012-05-10T15:19:18.733
> 
> 标签：c++, c, c++11, procedural-programming

我曾在一些中型项目上使用 C++，但我从未用 C 进行过任何认真的编程。

阅读[这篇文章](http://www.250bpm.com/blog:4 "为什么我应该用 C 而不是 C++ 编写 ZeroMQ")后，我开始想知道如何在没有类和异常的情况下使用 C++11。我曾经听说过*clean C*这个词。*Clean C*应该是 C++ 代码，它不使用 ANSI C 所没有的 C++ 特性，如类或元编程。

有很多资源如何在 C 中有效地做事以及如何在 C++ 中做事。但是，要找到任何关于如何两全其美的资源是非常困难的。

我的问题分为两部分：

1.  在没有命名空间、异常和元编程的情况下使用 C++ 是否有任何好的资源？书籍，开源项目？
2.  请查看这段简单的代码，这是我在提到的 C++11 子集中处理数据结构和字符字符串的第一次尝试。我首先想到的是代码冗余。你会做什么不同的事情，为什么？

-

```
#include <cstring>

namespace addressbook {
namespace contact {

struct contact {
    char* name;
    char* email;
};

void initialize(addressbook::contact::contact* contact)
{
    contact->name = nullptr;
    contact->email = nullptr;
}

void deinitialize(addressbook::contact::contact* contact)
{
    delete[] contact->name;
    delete[] contact->email;
}

void set_name(addressbook::contact::contact* contact, char* name)
{
    delete[] contact->name;
    contact->name = new char [strlen(name) + 1];
    std::strcpy(contact->name, name);
}

void set_email(addressbook::contact::contact* contact, char* email)
{
    delete[] contact->email;
    contact->email = new char [strlen(email) + 1];
    std::strcpy(contact->email, email);
}

} // namespace contact
} // namespace addressbook

int main()
{
    namespace c = addressbook::contact;

    c::contact jimmy;

    c::initialize(&jimmy);

    c::set_name(&jimmy, const_cast<char*>("Jimmy Page"));
    c::set_email(&jimmy, const_cast<char*>("jp@example.com"));

    c::deinitialize(&jimmy);

    return 0;
} 
```

请怜悯我——我是一个结构化编程新手。

**那为什么不只是C呢？**

命名空间、新建/删除、标准库算法、boost 库、C++11 酷特性 - 仅举几例。

**当您没有构造函数/析构函数时，为什么要新建/删除？**

因为类型安全。`malloc`返回`*void`

**但是标准库抛出异常！而boost也是如此！**

我没有使用异常这一事实并不意味着我不能处理来自外部库的异常。这只是意味着我想在*我*的系统部分以不同的方式管理问题。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-05-10T15:24:01.170

> 但是，要找到任何关于如何两全其美的资源是非常困难的。

因为一个都没有。这样做的唯一原因是因为你迫切需要兼容性——例如，Lua 是用“干净的 C”编写的。根本没有什么“最好”的。

这只是伪装成糟糕的 C++ 代码的 C 代码。它不是 C++ 代码，但兼容。“干净的 C”没有什么比普通的 C 更好的了。

编辑：提问者先生，您似乎不知道 WTF “干净的 C” 甚至*是*。它使您的源代码，甚至是实现，成为编译为 C++ 的 C 代码。没有命名空间，没有类型，没有常量，什么都没有。C++-with-aC-interface 是完全不同的东西，与干净的 C 完全无关。在这种情况下，没有理由限制您在实现中使用哪些 C++ 功能。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-05-10T15:25:41.940

首先要注意的是，即使我们接受文章的前提，也*没有*理由不使用类。也许不要使用构造函数、赋值等——但没有理由不使用成员函数，例如。

接下来，不要陷入到处使用指针的陷阱。您*仍然*应该尽可能选择值语义。如果必须使用指针，请使用*智能*指针而不是手动内存管理，并注意甚至`new`可以抛出异常（除非您使用`std::nothrow`重载）。

最后，不要避免使用 C++ 标准库函数来支持 C 函数。例如，不要使用`strcpy`- 使用`std::copy`和其他 C++ 算法。

* * *

另一方面，`nullptr`之前的检查`delete[]`是不必要的。

# objective-c - Xcode 滚动按钮

> ID：10537179
> 
> 赞同：1
> 
> 时间：2012-05-10T15:19:21.933
> 
> 标签：objective-c, ios, button, scroll, touch

我的应用程序中有一个滚动视图，滚动视图中有很多按钮，它们之间没有任何空格......当我运行应用程序时，我无法滚动，因为我“当然”必须先触摸一个按钮，并且当我尝试滚动时，我触摸的按钮会突出显示，当我释放时.. 按钮被按下！所以我无法到达滚动视图中更下方的按钮！

所有按钮都有“内部修饰”设置。

我想这很容易修复，但我不知道如何！:P

/小白

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-10T15:28:11.937

`canCancelContentTouches`在`UIScrollView`to上设置属性`YES`应该允许它在检测到滚动后取消已经发送到按钮的触摸事件。那应该可以解决您的问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-10T15:31:53.403

You can do what ksoderstrom said or you can auto scroll using this method for your scrolview

```
[self.scrollView scrollRectToVisible:textField.frame animated:YES]; 
```

textField can be a UIButton as well. This method will just move the scrollView to whatever component you specify.

Hoep it helps.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-18T11:17:35.870

我有同样的问题，我发现在模拟器中测试它真的很难。当代码在实际设备上运行时，滚动视图按预期工作......

# sql - 批量交易 - 为什么会进入无限循环？

> ID：10537182
> 
> 赞同：0
> 
> 时间：2012-05-10T15:19:38.290
> 
> 标签：sql, sql-server-2008, transactions

所以，我遇到了一些代码，这些代码应该可以帮助我通过批量更新一个庞大的表（100m+ 条记录），如下所示：

```
--Declare variable for row count
set rowcount 50000
go

Declare @rc int
Set @rc=50000

While @rc=50000
 Begin

  Begin Transaction

  --Use tablockx and holdlock to obtain and hold 
  --an immediate exclusive table lock. This unusually
  --speeds the update because only one lock is needed.

    update  MyTable With (tablockx, holdlock)
    set TestField='ABC'

    ----Get number of rows updated
    ----Process will continue until less than 50000
    select @rc=@@rowcount

  Commit
 End 
```

问题是，这进入了一个无限循环，一直打印（受影响的 50000 行）直到结束。顺便说一句，如果表中的记录少于 50000 条，则上面的代码会正确退出。有人知道怎么修这个东西吗？

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-10T15:21:15.983

如果 MyTable 中有 50000 条或更多记录，则它将始终更新。您的更新中没有 where 子句可以缩小字段范围，最终让您更新到 <50000 条记录。

大概您打算只更新 TestField <> 'ABC' 的记录，因此您没有再次执行相同的更新。

当您考虑使用什么 where 子句时，请考虑使用聚集索引，以便您可以对更新执行索引查找/部分扫描，而不是全表扫描。

顺便说一句，不需要`HOLDLOCK`提示，因为它在事务提交后立即释放，也不需要显式事务，因为更新本身就是一个事务。tabblock 可能会产生轻微的改进，因为它避免了锁升级。

# visual-studio-2010 - VS 定位错误的程序集

> ID：10537183
> 
> 赞同：1
> 
> 时间：2012-05-10T15:19:38.493
> 
> 标签：visual-studio-2010, assemblies, krypton-toolkit

`Krypton.Toolkit.dll`为了在运行时删除许可证错误消息，我不得不从它的源代码重建。在参考文献中，我已经删除了旧的氪组件，并用源代码替换了旧的氪组件。

我现在收到错误：（以及相关的转换类型错误）

`Could not load file or assembly 'ComponentFactory.Krypton.Toolkit, Version=4.0.0.0, Culture=neutral, PublicKeyToken=a87e673e9ecb6e8e'`

我理解错误信息。尽管我的新引用具有相同的名称，但它根本没有强名称，因此没有 PublicKeyToken。

我不明白的是，为什么在完全替换引用时它仍在寻找旧的 PublicKeyToken？此 DLL 不在 GAC 中。

* * *

起初，这些 DLL 在我的主项目`.csproj`文件中引用了匹配的 PKT。我给我的两个程序集起了一个强名称并替换了旧的引用。

然后我清理并重建了项目，新的强名称已在 csproj 文件中替换。`a87e673e9ecb6e8e`但是 Visual Studio 仍在上述项目中寻找，如错误窗口所示。

* * *

排序。一个引用引用了与我的项目相同的第 3 方 DLL，并且它们存在冲突。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-10T15:23:25.450

您的解决方案中的某些内容似乎仍然引用了强名称版本。

您可以打开您的 .csproj（或者如果您正在使用 VB，我认为是 .vbproj）并在您最喜欢的文本编辑器中查找该参考。查找类似于以下内容的行：

```
<Reference Include="ComponentFactory.Krypton.Toolkit, Version=4.0.0.0, Culture=neutral, PublicKeyToken=a87e673e9ecb6e8e, processorArchitecture=MSIL">
</Reference> 
```

搜索 PublicKeyToken 可能就足够了。

如果找到它，您将知道哪个项目仍然引用强命名版本。

您可能会看到一个子节点，例如

```
<Reference ... >
  <HintPath>..\SomePath\ComponentFactory.Krypton.Toolkit.dll</HintPath>
</Reference> 
```

指示链接器查找特定路径以解析引用。

您可以手动编辑项目文件（先备份它），或者如果您对此更满意，可以使用该知识通过 VS 更新参考。

**更新**

如果事实证明（就像在这种情况下所做的那样）问题出在引用的 DLL 上，而引用的 DLL 又引用了另一个 Krypton 版本，那么诊断问题的好工具是 Fusion Log Viewer

[http://msdn.microsoft.com/en-us/library/e74a18c4.aspx](http://msdn.microsoft.com/en-us/library/e74a18c4.aspx)

请注意，Fusion Log Viewer**必须**以管理员身份运行。如果没有，它不会显示任何结果，否则不会抱怨。

# android - 在 Android >=4.0 上捕获媒体按钮（适用于 2.3）

> ID：10537184
> 
> 赞同：10
> 
> 时间：2012-05-10T15:19:40.287
> 
> 标签：android, broadcastreceiver, android-manifest, android-4.0-ice-cream-sandwich

我编写了一些服务，它使用 BroadcastReceiver 来捕获其中一个媒体按钮（来自耳机的“播放按钮”），它在 android 2.3.x（HTC Nexus One 或 HTC Desire）上完美运行

当我尝试在 Android 4.0.3 (Samsung Nexus S) 上运行时，它不起作用（我的应用程序没有收到意图“android.intent.action.MEDIA_BUTTON”和“播放”按钮的行为与往常一样：停止/启动音乐）。

清单内容：

> ```
> ...
> <application
>     android:icon="@drawable/ic_launcher"
>     android:label="@string/app_name" >
>     <receiver android:name=".buttonreceiver.MediaButtonIntentReceiver" >
>         <intent-filter android:priority="10000" >
>             <action android:name="android.intent.action.MEDIA_BUTTON" />
>         </intent-filter>
>     </receiver>
> ... 
> ```

有没有办法让它在 android 4.0.3 上运行

* * *

编辑：我尝试了建议的解决方案，我添加了操作并运行它，但我的接收器仍然没有收到意图。更奇怪的是通过代码注册接收器也不起作用：

```
@Override
protected void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.about_and_activation_view);

    Log.d("MR", "onCreate - " + getIntent().getAction());

    mReceiver = new MediaButtonIntentReceiver();
    registerReceiver(mReceiver, new IntentFilter(Intent.ACTION_MEDIA_BUTTON));
} 
```

现在我完全糊涂了。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-05-10T15:46:15.343

确保您的应用程序中有一个活动，并且用户在尝试按下该按钮之前运行此活动。在那之前，您`<receiver>` [将不会收到任何广播](http://commonsware.com/blog/2011/07/13/boot-completed-regression-confirmed.html)。

* * *

**更新**

[`registerMediaButtonEventReceiver()`在 Android 4.0 及更高版本上`AudioManager`](http://developer.android.com/reference/android/media/AudioManager.html#registerMediaButtonEventReceiver%28android.content.ComponentName%29)，您似乎还需要调用才能接收事件。该状态将一直保持到其他人调用`registerMediaButtonEventReceiver()`或直到您调用`unregisterMediaButtonEventReceiver()`。

例如，这样的活动：

```
public class MediaButtonActivity extends Activity {
  @Override
  public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.main);

    ((AudioManager)getSystemService(AUDIO_SERVICE)).registerMediaButtonEventReceiver(new ComponentName(
                                                                                                       this,
                                                                                                       MediaButtonReceiver.class));
  }
} 
```

将启用清单注册`MediaButtonReceiver`以获取 ACTION_MEDIA_BUTTON 事件。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-11-21T00:32:03.030

如果您只是希望您的应用程序成为默认应用程序，但不需要对按下按钮执行任何操作，则可以使用以下方法。

将此添加到清单文件（在“应用程序”节点中）：

```
 <receiver android:name="BroadcastReceiver">
        <intent-filter>
            <action android:name="android.intent.action.MEDIA_BUTTON" />
        </intent-filter>
</receiver> 
```

将此添加到主活动中的 onCreate() 或应用程序运行时调用的任何位置。在 onResume() 事件中也可能有用：

```
 mAudioManager =  (AudioManager) getActivity().getSystemService(Context.AUDIO_SERVICE);
    mRemoteControlResponder = new ComponentName(getActivity().getPackageName(), BroadcastReceiver.class.getCanonicalName());

    mAudioManager.registerMediaButtonEventReceiver(mRemoteControlResponder); 
```

# .net - Autofac 中的参数化抽象工厂

> ID：10537188
> 
> 赞同：4
> 
> 时间：2012-05-10T15:19:47.067
> 
> 标签：.net, dependency-injection, factory, autofac

我希望能够在 Autofac 中注册具有以下属性的工厂组件：

1.  工厂必须接受一个参数（在这种情况下是一个字符串），并返回一个与该字符串特别相关的组件实例
2.  组件的生命周期必须是 InstancePerLifetimeScope
3.  #2 的含义是第二次调用具有特定参数值的工厂将在生命周期范围内返回相同的组件实例。

我已经能够通过编写一些代码来实现这一点，这些代码在生命周期范围内充当“名称注册表”，保留已创建的名称和组件实例的字典。这可行，但我怀疑可能有一种方法可以使用一些 autofac 注册魔法来做到这一点，但我还没有破解它。有任何想法吗？

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-10T17:11:52.950

听起来您想要 Autofac [Named and Keyed Services](http://docs.autofac.org/en/latest/advanced/keyed-services.html#named-and-keyed-services)。

# php - Zend CLI 工具包含错误

> ID：10537195
> 
> 赞同：0
> 
> 时间：2012-05-10T15:20:05.513
> 
> 标签：php, windows, zend-framework2, zend-tool

我正在尝试安装 Zend_Tools。我尝试了其他问题的解决方案，但一切正常。我将 Windows7 与 XAMPP 一起使用，因此我的 php 位于 C:\xampp\php 中。我将 php 包含在 PATH 中，将 ZendFramework\library 添加到 include_path。我的系统上还有其他一些 php 安装，但我认为我正确地包含了它。php -i | 更多给出：

```
Loaded Configuration File => C:\xampp\php\php.ini 
```

和

```
Zend Extension => 220090626
Zend Extension Build => API220090626,TS,VC9 
```

现在，当我尝试运行 zf.bat 时。我得到错误：

```
ZF Error:In order to run the zf command, you need to ensure that Zend Framework
is inside your include_path... 
```

我还在 zf.php 的顶部添加了 get_include_path() 的回声，它也为我提供了正确的路径：

```
.;C:\xampp\php\PEAR;C:\Users\Felix_2\Documents\programmierung\ZendFramework\libr
ary;C:\Users\Felix_2\Documents\programmierung\ZendFramework\library 
```

在 ZendFramework\library 文件夹中有一个文件夹“Zend”，其中 Zend 的包作为子文件夹，那是正确的文件夹，不是吗？br/> 不知道如何让它工作。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-10T15:23:10.890

您需要将该`Zend`文件夹添加到您的路径中。所以应该是`......ZendFramework/library/Zend`应该修复它。

# linux - tmux 窗格可以远程 ssh 连接吗

> ID：10537206
> 
> 赞同：10
> 
> 时间：2012-05-10T15:20:53.687
> 
> 标签：linux, tmux

我可以在本地运行 tmux 并通过 ssh 连接到远程机器吗.. 之后任何新的窗格和/或屏幕都可以与远程机器外壳一起使用...我的意思是我无法在遥控器上安装 tmux机器，但我不想从每个窗格都进行 ssh 连接，而是 ssh-login 一次。

这样的事情可能吗..谢谢

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-15T17:40:11.070

If you want to login just once, you can use `ControlMaster` feature of ssh. Add some config like [this](http://blogs.perl.org/users/smylers/2011/08/ssh-productivity-tips.html) to your `~/.ssh/config`:

```
ControlMaster auto
ControlPath /tmp/ssh_mux_%h_%p_%r 
```

If you login to the same server (as the same user) multiple times (either in one tmux or not), ssh will reuse the connection so that you don't need to make connection and login again.

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-05-27T02:39:09.713

lilydjwg 解释了一些我以前从未真正理解的东西。了解 ControlMaster 设置会使以下内容更加合理，因为它简化了建立多个`ssh`连接。您只需要认证一次，远程主机不需要为每个连接运行一个 sshd 进程。

在您的`.tmux.conf`文件中：

```
# What host do you usually log in to?
# We'll ssh there by default each time a new window or pane is opened.
REMOTE_HOST=your.usual.host
set-option -g default-command "ssh $REMOTE_HOST"

# Simple interface to change which host is connected to when you create
# a new window or pane.
bind-key C-h command-prompt -p "Set remote host: " -I $REMOTE_HOST "set-option default-command 'ssh %%'"

# In case you really do want a new window with a local shell.
bind-key C new-window "" 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-05-10T15:53:16.810

我不认为`tmux`可以。一种解决方法是将这样的内容添加到*tmux.conf*。

```
bind-key X new-window "ssh HOST" 
```

然后新窗口将在远程主机上启动。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-11-16T19:11:17.760

我正在使用 tmux 1.8 并没有找到内置的解决方案。这些解决方法至少适合我的常见用例：

*   捕获整个窗格内容并在其中搜索最后一个 ssh 命令（我使用提示结束的知识来或多或少可靠地检测命令）
*   `shell-command`如果失败，我会使用tmux`new-window`或`split-window`commands选项检查窗格可能已创建的命令

我的`reconnect.sh`脚本看起来像这样。它最脏的地方是从缓冲区中获取最后一个 ssh 命令的方式。到目前为止，“> ssh”足以让我的情况可靠地检测到包含 ssh 连接请求的线路，但任何更好的解决方案将不胜感激。

```
#!/bin/bash

# @TODO: change this according to your own prompt
# This is used to find lines connect ssh command in the pane buffer
PROMPT_SEPARATOR="> "

# get current pane buffer size and dimensions
HISTORY_LIMIT=`tmux display-message -p "#{history_limit}"`
VISIBLE_LINES=`tmux display-message -p "#{pane_height}"`

# search last ssh command in pane content
LINE=`tmux capture-pane -p -J -S -$HISTORY_LIMIT -E $VISIBLE_LINES | grep "${PROMPT_SEPARATOR}ssh " | tail -1`
if [ -n "$LINE" ]; then
    echo $LINE | sed "s/.*$PROMPT_SEPARATOR//;"
else
    # fall back to the command that might have been used to create the pane
    # (not necessarily ssh but helpful anyway)
    tmux list-panes -F "#{pane_active} #{pane_start_command}" | grep "^1 " | tail -1 | cut -d ' ' -f2-
fi 
```

`split-window`我将此脚本保存在我的 ~/.tmux 目录中，并更改了与此类似的各种快捷`new-window`方式的键绑定`.tmux.conf`：

```
# try to reconnect to remote host when creating new window
bind c run-shell 'CMD=`~/.tmux/reconnect.sh`; tmux new-window "$CMD"' 
```

# jquery - jQuery：仅将 CSS 分配给具有特定属性的元素

> ID：10537208
> 
> 赞同：0
> 
> 时间：2012-05-10T15:20:56.823
> 
> 标签：jquery, css

我有一个表单（使用 jQueryUI 选项卡），我希望文本输入元素`readonly="readonly"`的 CSS 值为`border:0;`. 到目前为止，我得到了（使用 jQuery 文档）：

```
$(":input[type='text'][readonly='readonly']").each(function()
{
    $(this).css('border', '0;');
}); 
```

这根本没有做任何事情。当我添加`$(document).ready()`到上述内容时，我的 jQuery 选项卡会中断（但滑块不会）。如果我只有`$(document).ready()`没有内容，那很好。我认为问题在于第一行，但我不确定。

我不想用 id/class 来做这个。如果可以只使用 CSS，那就太好了，但我想不出办法。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-10T15:22:31.520

一个简单的css怎么样

```
input[readonly] { border-width: 0px; } 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-10T15:24:48.050

抛开普通的 CSS 声明不谈，您`":input[type='text'][readonly='readonly']"`似乎有一个杂散的前导冒号`:`，它实际上指定了一个伪类（并且`input`是一个标签名称）。另外，请尝试删除尾随`;`（`'0;'`或`'0px'`改用）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-10T15:27:22.827

```
$("input[type='text'][readonly='readonly']").each(function(){
    $(this).css('border', '0');
}); 
```

[JSFiddle](http://jsfiddle.net/tjrV5/1)

# linux - 使用 yum 安装同一个包的多个版本？

> ID：10537211
> 
> 赞同：3
> 
> 时间：2012-05-10T15:21:12.237
> 
> 标签：linux, yum

我有一台安装了奇怪内部版本的 MySQL 的服务器，并希望在该节点上安装 collectd。不幸的是，collectd 依赖于 MySQL，它安装失败，因为它需要某个版本的 MySQL，而安装的版本是唯一的内部版本。

是否可以安装第二个 mysql 版本只是为了克服 yum 错误？或让百胜认为它已安装？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-10T15:25:19.070

通常不可能安装同一个包的两个版本。这通常会导致无法解决的文件冲突，尽管在极少数情况下您可以安装一个包的多个版本而不会发生冲突（例如，`kernel`包）。

可以创建一个“假”包来满足缺少*的*依赖项，尽管这样做表明你的系统上的某些东西从根本上被破坏了（通常，有人安装了一些并不真正打算在你的特定发行版上使用的东西使用）。您需要创建一个规范文件，其中包含`Provides:`与您的依赖项匹配的行，如下所示：

```
Provides: mysql = 5.5.22 
```

曾几何时，我写了一个名为[fakeprovide](https://github.com/larsks/fakeprovide)的工具，它可以帮助解决这类问题……如果没有别的，它可能会给你一个模板规范文件来使用。

您还可以获取源 RPM并重建它以与系统上安装`collectd`的版本兼容。`MySQL`

# spotify - 无法在最新的 Spotify 版本上开发应用程序

> ID：10537212
> 
> 赞同：1
> 
> 时间：2012-05-10T15:21:14.063
> 
> 标签：spotify

我已经开发了一段时间的 Spotify 应用程序，但是出现了一个不允许应用程序开发的新版本（再也找不到本地应用程序）。我恢复到以前在 Spotify 的预览部分可用的旧版本，但每次我重新启动 Spotify 时，它都会重新安装最新版本。有没有办法阻止自动更新或获得可以开发的更新版本？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-10T15:33:24.290

The bundle loading logic changed with Spotify 0.8.3\. Just search for the Spotify tag on Stack Overflow and you'll find many, many duplicates of your question.

This one has the answer you're looking for: [Spotify apps dead after update?](https://stackoverflow.com/questions/10416228/spotify-apps-dead-after-update)

# android - android 2.3 和 android 4.0 有什么区别

> ID：10537214
> 
> 赞同：1
> 
> 时间：2012-05-10T15:21:15.980
> 
> 标签：android

从程序员的角度来看，2.3 版本和 4.0 版本有什么区别，例如我会错过什么库，是否只有片段也是其他东西。

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-10T15:26:12.423

有很多值得注意的变化！我建议阅读发行说明：http: [//developer.android.com/sdk/RELEASENOTES.html](http://developer.android.com/sdk/RELEASENOTES.html)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-10T15:27:31.360

不错的列表[（](http://socialcompare.com/en/comparison/android-versions-comparison)尽管它不像官方 SDK 发行说明那样程序员密集）

# javascript - 带有自定义参数的 Javascript 回调

> ID：10537222
> 
> 赞同：0
> 
> 时间：2012-05-10T15:21:33.703
> 
> 标签：javascript, node.js, asynchronous

鉴于我不知道参数可能是什么，我正在尝试解决如何在节点中实现异步回调。

我将说明我正在尝试做的同步版本，以便更清楚地说明这一点。

```
function isAuthorized(userID){
    // check for user Permissions here
    return isAuthorized;
} 
```

使用这个任何函数都可以调用它，并根据它返回的值确定用户是否被授权。但是，我用来获取用户 ID（并检查权限）的函数都是异步函数并且需要回调。但是，当我不知道回调中所需的参数时，我不知道如何实现它。

调用它的函数可能想要向回调发送一些参数（通常它只是等待同步返回），这让我感到困惑。

```
function isAuthorized(socket, callback, args){
    socket.get('userID', function (err, userID) {
        //check userID for permission
        callback(args);
    });
} 
```

我意识到我可以将参数转换为数组并发送该数组，但我想知道是否有更通用的方法来执行此操作，它不会强迫我将所有回调从参数数组转换。

希望你能帮上忙，Pluckerpluck

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-10T15:28:06.243

我不确定，如果我以正确的方式理解您，但您似乎正在寻找`arguments`函数中的对象（[MDN 链接](https://developer.mozilla.org/en/JavaScript/Reference/Functions_and_function_scope/arguments)）。

基本上这样您就不必提前指定任何参数，而是让函数查找存在的参数。因此，您可以执行以下操作：

```
function myFunc() {
  for (var i=0; i<arguments.length; ++i ) {
    console.log( arguments[i] );
  }
} 
```

这导致输出像

```
myFunc( 1 );
> 1
myFunc( 's', 3, 'S' );
> "s"
> 3
> "S" 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-10T15:28:36.610

您始终可以创建一个函数来为您将这些参数拉入一个数组中，然后在您的每个异步函数中重用它：

```
function asyncWithCallbackArgs(obj, callback) {
  var args = Array.prototype.slice.call(arguments, 2);
  callback.apply(obj, args);
} 
```

这将使您能够执行以下操作：

```
function callback (c, d, e, f) {
  console.log([c, d, e, f]);
}

asyncWithCallbackArgs({}, callback,'c','d','e','f');​ 
```

[这里](http://jsfiddle.net/rjzaworski/j2hNF/)有一个小提琴可以玩。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-10T15:32:47.800

因此，当您构建 API 时，您需要指定将参数传递到回调中的顺序。因此，您需要很好地注释您的代码，以便使用您的 API 的任何人都可以了解他们将从您的方法中得到什么。

听起来您可能想要传回不同的参数，具体取决于传入的回调函数的样子。这不是传统上 API 的工作方式。有效地做到这一点需要相当长的时间。

我建议将对象传递给回调。Object 可以有多个参数，人们可以从中提取出来。这将简化未来的增强，因为您可以非常简单地向该对象添加一个附加属性，而不会弄乱每个人对您的方法的实现。因此，返回如下内容：

```
{
    "id": "Some_ID",
    "message": "Some Message",
    "isAuthorized" : true
} 
```

这样，任何使用您的 API 的人都不必在回调方法中考虑多个参数。他们知道他们只会得到一个 arg，并且它将是一个具有多个属性的 Obj，他们可以使用他们想要的属性。此外，将来您可以在不破坏代码的情况下添加第 4 或第 5 个属性。您可以添加一个“日期时间”属性，它们的代码将保持不变。您将获得向后兼容性，然后新的实现者可以使用新属性。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-10T15:25:54.353

如果我对您的理解正确，请不要将它们作为参数传递：

```
var a = "something";
var b = "something";

var callback = function(){
   // use a and b here
};

isAuthorized(socket, callback); 
```

[http://jsfiddle.net/S4tH6/](http://jsfiddle.net/S4tH6/)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-05-10T15:31:32.670

在 Coffee-script 中，你有一个叫做 splats 的东西。

```
( socket, callback, args... )->

  callback args... 
```

这在 Javascript 中翻译为以下内容：

```
var __slice = [].slice;

function() {
  var args, callback, socket;
  socket = arguments[0], callback = arguments[1], args = 3 <= arguments.length ?__slice.call(arguments, 2) : [];
  return callback.apply(null, args);
}; 
```

# c# - SharpPcap 中的过滤器

> ID：10537223
> 
> 赞同：0
> 
> 时间：2012-05-10T15:21:35.310
> 
> 标签：c#, filter, sharppcap

我试图过滤掉 wifi 上的 Probes 和 Broadcast 帧。

使用 SharpPcap。

```
((SharpPcap.AirPcap.AirPcapDevice)(device)).Filter = "wlan.fc.type eq 0"; 
```

不工作

与

```
((SharpPcap.AirPcap.AirPcapDevice)(device)).Filter = "wlan.fc.type == 0"; 
```

这条线似乎允许广播

```
((SharpPcap.AirPcap.AirPcapDevice)(device)).Filter = "broadcast"; 
```

但需要真正获得所有管理框架。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-14T08:49:43.323

我认为您的问题如下：Wireshark 解码数据包，因此当您应用这些过滤器时，数据包已经解码，因此能够访问 wlan.fc.type 字段。

根据我的个人经验和 SharpPcap 的使用，您尝试使用的过滤器是根据字节 [] 计算的，因此您需要更加具体以确保正确应用它。

例如，我一直在使用这个过滤器来达到我的目的。

```
private const String filteringSV = "(ether[0:4] = 0x010CCD04)"; 
```

此外，请记住仅在已打开的设备上设置过滤器。

```
if (nicToUse != null)
         {
            try
            {
               nicToUse.OnPacketArrival -= OnPackectArrivalLive;
               nicToUse.OnPacketArrival += OnPackectArrivalLive;
               try
               {
                  if (nicToUse.Started)
                     nicToUse.StopCapture();
                  if (nicToUse.Opened)
                     nicToUse.Close();
               }
               catch (Exception)
               {
                  //no handling, just do it.
               }

               nicToUse.Open(OpenFlags.Promiscuous|OpenFlags.MaxResponsiveness,10);                 

               nicToUse.Filter = "(ether[0:4] = 0x010CCD04)";

               nicToUse.StartCapture();
            }
            catch (Exception ex)
            {
               throw new Exception(Resources.SharpPCapPacketsProducer_Start_Error_while_starting_online_capture_, ex);
            }
         } 
```

希望它有所帮助。

# iphone - UIAlertView didmissWithClickedButtonIndex 不会解除警报

> ID：10537227
> 
> 赞同：0
> 
> 时间：2012-05-10T15:22:01.127
> 
> 标签：iphone, uialertview

从处理 Web 服务连接的对象中，当网络出现故障时，我将警报传递给使用 Web 服务对象的视图控制器。

网络服务对象：

```
UIAlertView *alert = [[UIAlertView alloc] initWithTitle:@"Error" message:[NSString stringWithFormat:@"Connection failed!  You must be connected to a Wifi source to download data.  Please reconnect to a Wifi source and try again later."] delegate:nil cancelButtonTitle:@"Ok" otherButtonTitles: nil];
    NSDictionary *alertDict = [NSDictionary dictionaryWithObjectsAndKeys:alert, @"AlertView", nil];
    [[NSNotificationCenter defaultCenter] postNotificationName:DisplayAlertNotification object:self userInfo:alertDict]; 
```

视图控制器：

```
- (void)displayAlert:(NSNotification *)notification {
    NSDictionary *dict = [notification userInfo];
    if ([[dict objectForKey:@"AlertView"] isKindOfClass:[UIAlertView class]]) {
        UIAlertView *alert = [dict objectForKey:@"AlertView"];
                NSNumber *theTag = [dict objectForKey:@"AlertTag"];
    NSLog(@"%i", [theTag integerValue]);
    alert.tag = [[dict objectForKey:@"AlertTag"] integerValue];
        [alert show];
    }
}

- (void)removeAlert:(NSNotification *)notification {
    NSDictionary *dict = [notification userInfo];
    if ([[dict objectForKey:@"AlertTag"] isKindOfClass:[NSNumber class]]) {
        NSNumber *theTag = [dict objectForKey:@"AlertTag"];
        UIAlertView *alert = (UIAlertView *)[self.view viewWithTag:[theTag integerValue]];
        // Not sure why but my alert is nil at this point
        [alert dismissWithClickedButtonIndex:0 animated:YES];
    }
} 
```

我还以相同的方式使用 removeAlert 方法以编程方式删除警报。这样做的目的是，如果网络出现故障，但用户尚未单击“确定”，然后网络恢复正常，我将关闭“网络失败”警报，并显示“网络恢复”警报。它可以工作，除非它解除警报并显示网络已恢复，一旦用户单击“网络恢复”上的“确定”，原来的网络故障只会恢复一次。如果用户在出现 Network Failed 时单击 Ok，则它永远不会恢复。

我是否以这种方式正确地解除了警报？谢谢。

编辑：我可以通过在 WebServiceObject 中保存一个引用并以这种方式关闭它来使其工作。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-10T15:24:59.000

您将警报设置为零，所以它什么也不做

```
alert = nil;

[alert dismissWithClickedButtonIndex:0 animated:YES]; 
```

# windows-phone-7 - 应用程序运行期间的wp7后台进程

> ID：10537229
> 
> 赞同：0
> 
> 时间：2012-05-10T15:22:09.477
> 
> 标签：windows-phone-7, backgroundworker, app.xaml

我有一个包含许多页面的项目。无论我的应用程序的情况如何，我都想定期将信息导入我的数据库。

我试图将我的代码放在 App.xaml.cs 中，但它只保存一次数据（我把它放在启动中并在构造函数中尝试。我的方法是获取设备 ID 的位置，就像

```
void watcher_PositionChanged(object sender, GeoPositionChangedEventArgs<GeoCoordinate> e)
{
    Location loc = new GeoCoordinate(e.Position.Location.Latitude, e.Position.Location.Longitude);

    //Send Data to Database
    dclient.CreateUserLocationCompleted += new EventHandler<System.ComponentModel.AsyncCompletedEventArgs>(dclient_CreateUserLocationCompleted);
    dclient.CreateUserLocationAsync(1, loc.Latitude, loc.Longitude);
} 
```

并且我的观察者位置更改在构造函数内部。

```
if (watcher == null)
{
    watcher = new GeoCoordinateWatcher(GeoPositionAccuracy.High)
}

MovementThreshold = getSelectedDeviceLocationFrequencyFromInternalFolder();

watcher.PositionChanged += new EventHandler<GeoPositionChangedEventArgs<GeoCoordinate>>(watcher_PositionChanged);
watcher.Start(); 
```

并在 App.xaml.cs 中全局定义

如何在程序运行时始终定期运行它？还有什么办法吗？谢谢（总而言之，我想定期将位置数据插入我的数据库。）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-10T15:28:36.460

您将需要在应用程序启动时启动一个线程，该线程在它想要的任何时间休眠（或从应用程序的信号唤醒 - 当收到新值时）并将数据写入其中的数据存储。

# xml - 使用 XSLT 2 复制所有 xml 节点并重命名其中的少数节点

> ID：10537238
> 
> 赞同：0
> 
> 时间：2012-05-10T15:22:50.473
> 
> 标签：xml, xslt

我有一个 XML，在那个 XML 中我有一个元素，它本身有几个元素，现在我想要的是复制每个元素并更改标签名称。

XML结构：

```
<mothertag>
     <atag>
        asdfasdfa
     </atag>

     <storybody>
        <p>sometext here<URI ref="http://google.com" /> some more text</p>
     </storybody>

</mothertag> 
```

1.  我想改名`<storybody>`，`<body>`
2.  其他一切都应该保持原样并将其更改`<URI>`为`<a>`

我为文档的其余部分所做的是定义模板并一一应用。现在我遇到了这个需要复制的，因为它几乎没有更改并且名称已更改。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-10T15:39:01.683

`<storybody>`要在 XSLT 中做到这一点，您只需要一个基本的身份转换，元素除外。

像这样的东西：

```
<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform">

  <xsl:template match="@*|node()">
    <xsl:copy>
      <xsl:apply-templates select="@*|node()"/>
    </xsl:copy>
  </xsl:template>

  <xsl:template match="storybody">
    <body>
      <xsl:apply-templates select="@*|node()"/>
    </body>
  </xsl:template>

</xsl:stylesheet> 
```

* * *

**编辑**

我已阅读您的评论，*“我不想使用身份转换。而是我需要在文档中的一个元素上使用身份转换”*，并且不清楚您需要什么。也许您对文档的其余部分进行了转换，但在使用此元素时遇到了问题？在这种情况下，除了您已经编写的内容之外，您应该只使用我的答案中的第二个模板。

您的消息的第二部分在标记中部分丢失了，但现在已修复，我忽略了它。要将`<URI>`元素也更改为 an `<a>`，您应该添加另一个模板。假设你想把原来的`ref`属性改成`href`，两者加起来是这样的

```
<xsl:template match="storybody">
  <body>
    <xsl:apply-templates select="@*|node()"/>
  </body>
</xsl:template>

<xsl:template match="storybody//URI">
  <a>
    <xsl:attribute name="href">
      <xsl:value-of select="@ref" />
    </xsl:attribute>
  </a>
</xsl:template> 
```

如果您的意图与此不同，请澄清，我们将进一步帮助您。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-10T18:05:16.853

如果没有所需结果 XML 的示例，目前尚不清楚您要尝试做什么 Touseef，但是....

如果您需要丢弃大部分输入文档并只保留一个标签，那么此模式可能会有所帮助：

```
 <xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform">

   <xsl:template match="@*|node()">
       <xsl:apply-templates select="@*|node()"/>
   </xsl:template>

   <xsl:template match="storybody">
       <xsl:copy-of select="."/>
   </xsl:template>

 </xsl:stylesheet> 
```

我在打字时不在一台带有 XSLT 引擎的机器前，所以我没有对此进行测试。但我们的想法是将所有内容与第一个模板匹配，并简单地忽略它，除了我们简单地复制到输出文档的 storybody 元素。

如果这没有帮助，那么我敦促您提供一个示例所需的结果 XML 文档，并明确说明您希望应用的规则

# c# - 在 C#.NET 中定义 getter，声明的主体不被接受

> ID：10537241
> 
> 赞同：0
> 
> 时间：2012-05-10T15:23:01.660
> 
> 标签：c#, .net, wcf, dictionary, getter

考虑以下代码：

```
[DataContract]
class QObject {
    public QObject() { }
    [DataMember(Name = "objectindex")]
    public int ObjectIndex { get; set; }
    [DataMember(Name = "datapoint")]
    public int DataPoint { get; set; }
    [DataMember(Name = "type")]
    public string Type { get; set; }
    [DataMember(Name = "data")]
    public int[] Data { get; set; }
    [DataMember(Name = "parameters")]
    public string __Parameters {
        get {
            return this.__Parameters;
        }
        set {
            Parameters = new Dictionary<string,string>();
            Parameters.Add("key", "value");
        } 
    }
    public Dictionary<string, string> Parameters;
} 
```

这对我来说似乎很好，但是当我想编译时，它会出现以下错误：

'QuartzService.NET.QObject.__Parameters.get' 必须声明一个主体，因为它没有标记为抽象、外部或部分

奇怪的是，get声明*了*一个主体。那么，如何解决这个问题？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-10T15:25:36.587

你有没有注意到getter中的无限循环

```
 public string __Parameters {
    get {
        return this.__Parameters;
    }
 ......... 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-10T15:27:33.250

getter 返回**另一个**变量而不是它自己。也许你想从参数中返回一些东西。此外，您的 setter 总是创建一个**新**字典并将相同的内容添加到其中。你想做什么？

尝试这样的事情

```
 public string __Parameters
    {
        get { return this.recreate(); } 
        set
        {
            Parameters = parse(value));
        }
    }     

    public Dictionary<string, string> Parameters; 
```

解析函数接受一个字符串，将其分解并将其存储到字典中。并且 recreate 函数使用字典重新创建字符串。

也这样做：

```
 public Dictionary<string, string> Parameters = new Dictionary<String,String>(); 
```

这样您就不会意外获得空指针，而且我认为您只需要一本字典。（当你解析一个新的 String 时不要忘记清除它）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-10T15:30:35.587

您定义好的吸气剂引入了递归调用。

```
public string __Parameters {
    get {
        return this.__Parameters;
    }
} 
```

尝试改变 this.__Parameters; 经过

```
private string _parameters 
public string __Parameters {
    get {
        return this._parameters;
    }
} 
```

# facebook - 用户进入应用后如何显示认证对话框？

> ID：10537249
> 
> 赞同：0
> 
> 时间：2012-05-10T15:23:35.997
> 
> 标签：facebook

我有一个 facebook 应用程序，我想增加登录转换，所以我希望我的用户登陆我的应用程序主页以查看我提供的内容，然后一旦他们点击，他们将获得身份验证对话框。我该怎么做呢？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-10T16:51:33.217

不能保证添加着陆页会增加转化次数。事实上，向漏斗添加额外的点击可能会造成伤害。但是，如果您想尝试一下，这就是您需要做的。

在您告诉它之前，Facebook 不会提示进行身份验证。为了让您的用户在提示进行身份验证之前看到登录页面，请确保执行以下操作：

1) 确保**关闭**“经过身份验证的推荐” 。这可以在开发人员应用程序中的设置 > 验证对话框下完成

2) 如果使用 JS SDK，请确保您正在调用 FB.getLoginStatus()，以便您可以将已经授权您的应用程序的用户重定向到相应的页面。（您也可以在服务器端使用 PHP SDK 或同等产品来避免客户端重定向）。

3) 如果使用 JS SDK，请在准备好提示验证之前不要调用 FB.login()。例如，您可以调用它来响应用户单击登录页面上的登录按钮。如果不使用 JS SDK，在用户单击您的登录按钮之前不要重定向到身份验证对话框。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-10T15:31:48.397

Please read this carefully:

[http://developers.facebook.com/docs/reference/androidsdk/dialog/](http://developers.facebook.com/docs/reference/androidsdk/dialog/)

```
void dialog(Context context, String action, DialogListener listener) 
```

> Generate a Facebook UI dialog for the request action in the given Android context.
> 
> Parameters
> 
> context - The Android context in which we will generate this dialog.
> 
> action - The type of dialog to call. Currently supported methods are feed and oauth.
> 
> listener - Callback interface to notify the application when the dialog has completed.
> 
> Return Value
> 
> None, the callback interface will be notified when the request has completed.
> 
> Note
> 
> This method is asynchronous and the callback will be invoked in the original calling thread (not in a background thread).

# php - 如何在遗留代码中使用 yii？

> ID：10537255
> 
> 赞同：2
> 
> 时间：2012-05-10T15:24:03.947
> 
> 标签：php, yii, legacy

我和我的同事团队决定在 Yii 中重写一个遗留应用程序，但管理层有严格的政策，所有功能必须保持原样，所以我们必须使用旧模块，直到它们被移植到 Yii，这些模块是编写的以一种程序化的方式，每个人都有一个包含在一般 index.php 中的 php 文件。一般的 index.php 做了三件事：

*   启动会话并向其添加变量。
*   创建数据库连接。
*   呈现所请求模块的主 php 文件。

**一旦我们开始使用 Yii，我们如何使用旧模块？**

我们已经查看了[URL 管理](http://www.yiiframework.com/doc/guide/1.1/en/topics.url)，逻辑非常简单：如果 url 匹配旧模块，则使用[renderFile()](http://www.yiiframework.com/doc/api/1.1/CBaseController#renderFile-detail)渲染它，否则让 Yii 完成工作，但我们不知道这是否是最好的方法。

**在开始这个过程之前，我们是否应该考虑其他任何事情？**

**我想知道 URLManagement + renderFile() 是否可行？**

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-13T06:47:32.353

确实可以使用 URL 处理，但是我会简单地编写一个自定义 URL Rule 类而不是使用大量路由，因为您的配置会一团糟。

如果您想要一些替代建议：

首先，拆分应用程序的创建及其执行

```
require_once($yii);
Yii::createWebApplication($config);

// If you want to run the app:
Yii::app()->run(); 
```

这样您就可以完全控制应用程序是否实际运行。

至于数据库。如果您使用的是 PDO，那么您很幸运。我只会以常规方式给 Yii 一个 db 组件，然后修改 general.php 以使用来自 Yii 的 PDO 实例（Yii::app()->db->pdoInstance）。它总是会在之后加载，这样应该可以工作。如果您不使用 PDO，只需使用 2 个连接，除非您有很多访问者，否则这还不错。

关于 session 不应该有太多的初始化，所以除非你有一个自定义的处理程序，否则也将它移动到 Yii。反正功能都是一样的，所以应该没有太大问题。

在我看来，有两种做事方式：

1）general.php 排在第一位。

您必须在旧文件中列出模块列表，并确定当前请求的模块是否已迁移。基本上将仍然是 general.php 的模块名称放在一个数组中，看看 url 是否需要其中一个并包含 general.php （不要做 Yii::app()->run()）。其余的通过 Yii。

2) Yii 先行。

Have yii do it's magic but intercept the 404 http exceptions. This is easily done with a custom error handler function (http://www.yiiframework.com/doc/guide/1.1/en/topics.error). If you get to the error function again: determine if its a valid legacy module and include general.php.

Both ways are pretty messy but at least like this you get the chance to migrate one module whilst keeping the rest in the legacy file.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-10T18:22:58.163

取决于`Size ,complexity and Person Months`软件对于做出任何决定都至关重要。当然，具有`homogeneous`应用性质而不是`heterogeneous`性质是非常非常可取的。如果您上面提到的模块是您打算转换的模块，我建议您必须在 Yii 中进行 RE-DO，因为 Yii 具有强大的`ORM`模块非常容易制作。

我建议你应该去一个`RE-Do`

您可能感兴趣以下内容 [如何将旧的 OOP PHP 项目转换为 Yii 框架？](https://stackoverflow.com/questions/9339245/how-do-you-convert-an-old-oop-php-project-into-the-yii-framework)

# php - POST xml 不使用 CURL

> ID：10537257
> 
> 赞同：-1
> 
> 时间：2012-05-10T15:24:08.977
> 
> 标签：php, xml, post

我需要在没有 CurL 的情况下发布 xml 数据。

有很多片段，但似乎没有任何效果。最新尝试：

```
function salesOrder($xml, $url)
{

  $context = stream_context_create(array(
    'http' => array(
      'method'  => 'POST',
      'header'  => "Content-type: application/xml\r\n",
      'content' => $xml,
      'timeout' => 5,
    ),
  ));
  $ret = file_get_contents($url, false, $context);

  return false !== $ret;
} 
```

什么都不返回，空白页。

我试过[http://wezfurlong.org/blog/2006/nov/http-post-from-php-without-curl/](http://wezfurlong.org/blog/2006/nov/http-post-from-php-without-curl/)

问题是我不太了解它，我似乎找不到涵盖这个问题的好教程。谁能指出我正确的方向？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-10T15:34:40.897

您可以使用它来实现

```
$xml = "<xml><name>hello</name></xml>" ;
$opts = array (
        'http' => array (
                'method' => "POST",
                'content' => $xml,
                'timeout' => 5,
                'header' => "Content-Type: text/xml; charset=utf-8" 
        ) 
);

$context = stream_context_create ( $opts );
$fp = fopen ( 'http://example.com/b.php', 'r', false, $context );
fpassthru ( $fp );
fclose ( $fp ); 
```

**http://example.com/b.php**

```
file_put_contents("php://output", file_get_contents("php://input")); 
```

# java - 为什么在 Java 7 中没有为 ARM 改造 StAX 类

> ID：10537258
> 
> 赞同：10
> 
> 时间：2012-05-10T15:24:09.453
> 
> 标签：java, java-7, stax, try-with-resources

我预计`XMLStreamReader`会`AutoCloseable`在 Java 7 中找到。但是，事实并非如此。没有（或不应该）改装 StAX 读/写器接口以实施是否有技术原因`AutoCloseable`？他们已经有了 close 方法，其意图与`AutoCloseable`.

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-06-14T10:40:53.357

如果您更接近以下[`close()`方法`AutoCloseable`](http://docs.oracle.com/javase/7/docs/api/java/lang/AutoCloseable.html#close%28%29)：

> 关闭此资源，放弃任何基础资源。此方法在由 try-with-resources 语句管理的对象上自动调用。

甚至[`Closeable` `close()`方法](http://docs.oracle.com/javase/7/docs/api/java/io/Closeable.html#close%28%29)：

> 关闭此流并释放与其关联的任何系统资源。如果流已经关闭，则调用此方法无效。

而[`close()`方法`XMLStreamReader`](http://docs.oracle.com/javase/7/docs/api/javax/xml/stream/XMLStreamReader.html#close%28%29)说：

> 释放与此 Reader 关联的所有资源。**此方法不会关闭底层输入源。**

实际上，输入源由[`Reader`](http://docs.oracle.com/javase/7/docs/api/java/io/Reader.html)实现`Closeable`接口的管理。因此，读者可以在*try-with-ressource*中接近。

例如 ：

```
 XMLInputFactory factory = XMLInputFactory.newInstance();
    XMLStreamReader reader = null;
    try (FileReader fr = new FileReader("file.xml")) { //Will close the FileReader
        reader = factory.createXMLStreamReader(fr);
        reader.close();
    }
    catch (XMLStreamException ex) {
        if(reader!=null)try {
            reader.close();
        } catch (XMLStreamException ex1) {
            Logger.getLogger(Test.class.getName()).log(Level.SEVERE, null, ex1);
        }
    } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-09T05:13:12.257

他们不能制造这些东西没有技术上的原因`AutoCloseable`。我认为这归结为懒惰或没有足够的时间寻找称为 close() 的方法。

# javascript - 寻找一个正则表达式来解析 JS 的参数字符串

> ID：10537260
> 
> 赞同：0
> 
> 时间：2012-05-10T15:24:12.330
> 
> 标签：javascript, regex

我找不到从查询字符串部分获取参数值的正则表达式：

我需要将参数名称发送到方法并获取参数值作为字符串的结果，例如 `"p=1&qp=10"`. 我想出了以下内容：

```
function getParamValue(name) {

  var regex_str = "[&]" + name + "=([^&]*)";

  var regex = new RegExp(regex_str);

  var results = regex.exec(my_query_string);
  // check if result found and return results[1]

} 
```

如果`name = 'p'`. 如果我`regex_str`改为

```
var regex_str = name + "=([^&]*)"; 
```

它可以`'qp'`为 param返回 param 的值`name = 'p'`

你能帮我用正则表达式`'&'`从字符串的开头或字符串的开头搜索参数名称的开头吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-10T15:28:57.983

看起来`split`在这里会更好地工作：

```
var paramsMap = {};
var params = string.split("&");
for (var i = 0; i < params.length; ++i) {
    var keyValue = params[i].split("=", 2);
    paramsMap[keyValue[0]] = keyValue[1];
} 
```

如果你非常想使用正则表达式，你需要使用`g`标志和`exec`方法。类似的东西

```
var regex = /([^=]+)=([^&]+)&?/g;
var paramsMap = {};
while (true) {
    var match = regex.exec(input);
    if (!match)
        break;
    paramsMap[match[1]] = match[2];
} 
```

请注意，由于`regex`对象变为有状态的，您要么需要`lastIndex`在运行另一个提取循环之前重置其属性，要么使用新`RegExp`实例。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-10T15:47:15.560

将您的正则表达式字符串更改为以下内容：

```
//pass the query string and the name of the parameter's value you want to retrieve
function getParamValue(my_query_string , name)
{
    var regex_str = "(?:^|\&)" + name + "\=([^&]*)";
    var regex = new RegExp(regex_str);
    var results = regex.exec(my_query_string); 
    try
    {
        if(results[1] != '')
        {
            return results[1];
        }
    }
    catch(err){};
    return false;
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-10T16:06:40.780

这可能会起作用，具体取决于您是否分离了参数部分。

```
var regex_str = "(?:^|\&)" + name + "=([^&]*)";
or
var regex_str = "(?:\&|\?)" + name + "=([^&]*)"; 
```

# c++ - 未定义对“DES_set_odd_parity”的引用

> ID：10537261
> 
> 赞同：2
> 
> 时间：2012-05-10T15:24:14.313
> 
> 标签：c++, c, gcc, linker, openssl

海合会，Ubuntu。

完成了：

> sudo apt-get install libssl-dev

使用 -lssl 构建，但在链接期间出现错误：

> 未定义对“DES_set_odd_parity”的引用

?

编辑：g++ linear_des.cpp -lssl

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-10T15:38:04.600

`DES_set_odd_parity`是其中的一部分，`libcrypto`因此您也应该尝试将其链接起来。这些方面的内容：
`g++ linear_des.cpp -lssl -lcrypto`
希望这会有所帮助！
PS：使用`pkg-config`工具并在这些行上编译一些东西可能是个好主意：
`g++ linear_des.cpp $(pkg-config --cflags --libs openssl)`

# java - Base64 解码与 Cipher.Decrypt 在 android 中无法正常工作

> ID：10537263
> 
> 赞同：2
> 
> 时间：2012-05-10T15:24:18.320
> 
> 标签：java, php, android, base64

这是一个字符串：

```
String msg="dpbqNszFN2cpmtlzPi3myV9M1ctlkSIQD95ue+T+9rz13T+Pe/aLZ8Pd5geI+PhEM/b0UeRS1cAzKybQsKICTBhh3ke5Jjw6BHWGESJWBnUT54lAlTvzkgOxpQ5stBh2cPPSn3KLyKmXifr8ClbV5s1k3Gy5C7HitA5KLw7hRxAmIGSWQG7PaiLNEVRbgicNfJ7Ic7VIdGA/UA51vK8mpywIR2YQUDPv30ThGq4DuclaJ3X4aVWVj8VYChcfM+82sViVU8HO3DF9CCU4EIADNET503olxiDZBp7WMYmJvWq0KhhZXkLSY3QFmcSMX6IThtdKKCcZp6hu3TtC+7aP7Q=="; 
```

所以字节数组是

```
[1] => 100     [2] => 112     [3] => 98     [4] => 113     [5] => 78     [6] => 115     [7] => 122 .. 
```

应该**解码**为

[我使用 PHP`base64_encode()`编码为上述形式并`base64_decode()`获得此输出]

```
[1] => 118     [2] => 150     [3] => 234     [4] => 54     [5] => 204     [6] => 197      7] => 55     ... 
```

但我面临的问题是（在 android 中，使用`Base64.decode(String)`）它被解码为：

```
[118, -106, -22, 54, -52, -59, 55, 103, 41, -102, -39, 115, 62, 45, -26, -55, 95, 76, -43, -53, 101, -111, 34, 16, 15, -34, 110, 123, -28, -2, -10, -68, -11, -35, 63, -113, 123, -10, -117, 103, -61, -35, -26, 7, -120, -8, -8, 68, 51, -10, -12, 81, -28, 82, -43, -64, 51, 43, 38, -48, -80, -94, 2, 76, 24, 97, -34, 71, -71, 38, 60, 58, 4, 117, -122, 17, 34, 86, 6, 117, 19, -25, -119, 64, -107, 59, -13, -110, 3, -79, -91, 14, 108, -76, 24, 118, 112, -13, -46, -97, 114, -117, -56, -87, -105, -119, -6, -4, 10, 86, -43, -26, -51, 100, -36, 108, -71, 11, -79, -30, -76, 14, 74, 47, 14, -31, 71, 16, 38, 32, 100, -106, 64, 110, -49, 106, 34, -51, 17, 84, 91, -126, 39, 13, 124, -98, -56, 115, -75, 72, 116, 96, 63, 80, 14, 117, -68, -81, 38, -89, 44, 8, 71, 102, 16, 80, 51, -17, -33, 68, -31, 26, -82, 3, -71, -55, 90, 39, 117, -8, 105, 85, -107, -113, -59, 88, 10, 23, 31, 51, -17, 54, -79, 88, -107, 83, -63, -50, -36, 49, 125, 8, 37, 56, 16, -128, 3, 52, 68, -7, -45, 122, 37, -58, 32, -39, 6, -98, -42, 49, -119, -119, -67, 106, -76, 42, 24, 89, 94, 66, -46, 99, 116, 5, -103, -60, -116, 95, -94, 19, -122, -41, 74, 40, 39, 25, -89, -88, 110, -35, 59, 66, -5, -74, -113, -19] 
```

如您所见，某些字符（虽然不可读）没有被正确解码。 **编辑（2）**：字节在 java 中签名，在 PHP 中未签名。感谢@Jon 和@Tony 清除了这个想法。但是错误仍然存​​在于我的代码中。

**编辑（1）：**

代码段：

```
KeyFactory fact = KeyFactory.getInstance("RSA");
BigInteger e=new BigInteger("65537");
BigInteger n=new BigInteger("B7AC0C8F738305F8BDDF93EE25655A70FBDF9F074640C159E36914C227BE1E50A615A25E6706EBA08FB79216F02279420ED4C9DA310778601F6A3233EDADE2FF3775D29E5302C4FCB9E7879D9F3C814AE8F42759148D91CDB23E528241AE2E44F6DE9D4334494C103886B2333D5833EFEABD76205B8F4897BB908E71697A10F6494EBFB0392A831575F64672E0F915A88F46F7FC03E7F94EB56A8A3296840095CB53787EE6E71D4C297108EA5CDD31BD37B1C0A55A8B5FA78F88FC82AEF3C2C80C0FC2CC97A1AEC74ACE44F4AC1B111B727311DA4D1447899A15BA292BCA4E7E864DF55CCB903CD4109874AD475393E7F24FC60E2D7B88E9B4FB57FA54A9B817",16);
RSAPublicKeySpec keySpec=new RSAPublicKeySpec(n,e);
PublicKey pubKey = (PublicKey) fact.generatePublic(keySpec);
Cipher cipher = Cipher.getInstance("RSA");
cipher.init(Cipher.DECRYPT_MODE, pubKey );
String msg="dpbqNszFN2cpmtlzPi3myV9M1ctlkSIQD95ue+T+9rz13T+Pe/aLZ8Pd5geI+PhEM/b0UeRS1cAzKybQsKICTBhh3ke5Jjw6BHWGESJWBnUT54lAlTvzkgOxpQ5stBh2cPPSn3KLyKmXifr8ClbV5s1k3Gy5C7HitA5KLw7hRxAmIGSWQG7PaiLNEVRbgicNfJ7Ic7VIdGA/UA51vK8mpywIR2YQUDPv30ThGq4DuclaJ3X4aVWVj8VYChcfM+82sViVU8HO3DF9CCU4EIADNET503olxiDZBp7WMYmJvWq0KhhZXkLSY3QFmcSMX6IThtdKKCcZp6hu3TtC+7aP7Q==";
byte[] bytes=msg.getBytes("UTF-8");
byte[] enc_bytes= Base64.decode(bytes,Base64.DEFAULT);
byte[]  dt = cipher.doFinal(enc_bytes);   
String code=new String(dt,"UTF-8");
System.out.println(code); 
```

密码解密字符串出来为（在第二个 system.out ）

```
05-10 21:05:27.501: I/System.out(11809): �ќ2`��H&��'Va�x�m��0G�����V�T�����)^����/|���BG,f_r    fK�B7?�a��n������Jl�y�yL���}��΂Ճ������JZj�+�|�-#ș%u�1�z�c�G��nl�5����HELLO HI1 HI1 HI1 HI1 HI1 HI1 HI1 HI1 HI1 HI1 HI1 HI1 HI1 HI1 HI1 HI1 HI1 HI1 HI1 HI1 HI1 HI1 HI1 HI1 HI1 HI1 H 
```

Base64_encoded & 签名数据是“HELLO HI1 HI1 HI1 HI1 HI1 HI1 HI1 HI1 HI1 HI1 HI1 HI1 HI1 HI1 HI1 HI1 HI1 HI1 HI1 HI1 HI1 HI1 HI1 HI1 HI1 HI1 H”

* * *

**[解决了]**

非常感谢@JonSkeet。

`cipher = Cipher.getInstance("RSA/ECB/PKCS1Padding");`删除了所有以它为前缀的垃圾数据。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-10T15:27:12.390

在我看来一切都很好——你只需要记住字节是用 Java 签名的。因此，Java 中的值 -106 对应于无符号值 150。一旦记住这一点，我想您会发现 PHP 中的所有值都对应于 Java 中的值。

请注意，您应该区分*字节*和*字符*。所以当你说：

> 如您所见，某些字符（虽然不可读）没有被正确解码。

您*实际上*是指一些字节......并且没有“可读”字节这样的概念。

编辑：我看不到任何迹象表明您实际上已经*解密*了数据。

您正在使用平台默认编码将 base64 解码的*仍然加密的结果转换为文本：*

```
String tmpr=new String(baser); 
```

你不应该这样做 - 你应该使用`baser`密文来解密。

根本不清楚`tmp`你传递的价值`doFinal`来自哪里......

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-10T15:28:29.363

你的问题是标志之一。第一个样本“应该”将输出字节视为 8 位无符号。Android 版本将它们视为有符号字节。

你的代码真的失败了吗？

*编辑*

`cipher.final()`似乎是为了完成解密而设计的。你是`cipher.update()`先打电话的吗？请参阅此处的示例，并查找`update(...)`stackoverflow.com/questions/3150830/android-encryption

这是[Android Cipher 文档](http://developer.android.com/reference/javax/crypto/Cipher.html)，为您提供方便。

* * *

## 回答 #3

> 赞同：-2
> 
> 时间：2012-05-10T15:26:14.263

Try this on your byte array

```
byte[] bytes = Base64.decode(data, Base64.DEFAULT);
String string = new String(bytes, "UTF-8"); 
```

# javascript - 自动化用户 Web 应用程序

> ID：10537264
> 
> 赞同：0
> 
> 时间：2012-05-10T15:24:18.960
> 
> 标签：javascript, web-applications, iframe, same-origin-policy, browser-extension

我想帮助用户更改第三方 Web 应用程序中的隐私设置。

我的第一个想法是在 iframe 中加载 Web 应用程序并通过 JavaScript 与之交互。但同源政策会禁止这样做。

为了避免同源限制，我可以使用网络代理，但我怀疑很多用户会信任登录。

我可以构建一个浏览器扩展，但这使得它使用起来更麻烦，也更难支持所有浏览器。

有什么建议么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-25T09:50:27.940

您可以使用 OAuth 重定向机制来支持您的用例。

# emacs - emacs - 将当前缓冲区列表保存到文本文件

> ID：10537265
> 
> 赞同：9
> 
> 时间：2012-05-10T15:24:19.380
> 
> 标签：emacs, copy-paste, org-mode

我经常需要获取当前打开文件的简单文本副本。原因通常是：

*   我想将列表发送给同事
*   我想记录我正在处理的任何事情（通常在组织文档中）
*   我想在 shell 上对我当前打开的文件之一进行操作。我需要为此复制粘贴路径名。

事实是，通常`buffer-menu`或`list-buffers`提供方便的菜单来导航打开的缓冲区，但将打开的文件的名称复制粘贴到终端或执行上述任何操作非常不方便。例如：我不能在一行中双击来选择完整的路径名，也不能使用`kill`/ `yank`emacs 序列来复制路径名。

摘要：我想要一种将打开文件列表导出到文本文件（或新缓冲区）的方法，而不需要其他数据；没有文件大小、模式或任何其他 emacs 元数据。

有这个命令吗？我可以安装一个额外的软件包吗？

## 编辑

由 Trey Jackson 添加解决方案，经过修改以提供对已完成操作的一些反馈：

```
(defun copy-open-files ()
  "Add paths to all open files to kill ring"
  (interactive)
  (kill-new (mapconcat 'identity 
                       (delq nil (mapcar 'buffer-file-name (buffer-list))) 
                       "\n"))
  (message "List of files copied to kill ring")) 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-05-10T16:05:38.970

此命令将为您完成这项工作：

```
(defun copy-open-files ()
  "Add paths to all open files to kill ring"
  (interactive)
  (kill-new (mapconcat 'identity 
                       (delq nil (mapcar 'buffer-file-name (buffer-list))) 
                       "\n"))) 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-05-10T15:57:29.320

您可以更改`*Buffer List*`缓冲区的模式。默认情况下，它将处于 mode `Buffer Menu`，但将其更改为`text-mode`or`fundamental-mode`将删除所有允许您像常规缓冲区一样剪切和粘贴的特殊行为。元数据可以很容易地用`delete-rectangle`.

或者，您可以使用 elisp 以编程方式访问缓冲区列表：

```
(dolist (buffer (buffer-list))
  (when (buffer-file-name buffer)
    (insert (buffer-file-name buffer) "\n"))) 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-10T21:28:44.307

您当然应该能够从缓冲区列表中复制和拉取。

例如，复制所有内容，`C-x``h``M-w`然后将其拉入新缓冲区进行编辑。

# javascript - 如何将动态元素数据传输到struts2

> ID：10537266
> 
> 赞同：-2
> 
> 时间：2012-05-10T15:24:21.637
> 
> 标签：javascript, jsp, struts2

我正在使用jsp开发一个在线测试网站。我的一个页面用于在线设计试卷。用户可以动态添加问题，然后将其存储到数据库中。我想我可以使用 JavaScript 实例来存储这些信息。但是如何将这些数据传输到 Struts 2 以将文件存储到数据库中？或者我应该使用其他方式来存储问题并与 Struts2 交互

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-10T15:31:08.083

Just add the correct attributes to your dynamically generated html elements.

# windows - Delphi Windows 服务设计

> ID：10537267
> 
> 赞同：21
> 
> 时间：2012-05-10T15:24:23.517
> 
> 标签：windows, delphi, service, tcp

Delphi Windows 服务设计

我从未创建过 Windows 服务，但一直在阅读我找到的所有内容。我遇到的所有文章或示例在实现方面都非常基础，并且范围有限。还没有看到任何超出这个或解决特定场景的东西。所以，我已经掌握了我可能会找到的所有理论，现在我准备好深入研究这个项目了。我喜欢整理我的想法，并就人们的想法获得一些反馈。我将描述我需要从应用程序中获得什么以及我打算如何构建它。我很感谢任何有构建 Windows 服务经验的人的评论以及他们愿意分享的任何建议。

[场景] 现在我有一个应用程序（我称之为 UPDATEAPPLICATION），它为我们所有其他应用程序提供更新。为了运行我们的任何应用程序，您首先必须运行此 UPDATEAPPLICATION 程序并将所需应用程序的参数传递给它。UPDATEAPPLICATION 调用一个 WebService，它返回关于所需应用程序是否有任何更新的 XML 信息。

如果有更新，UPDATEAPPLICATION 会下载 EXE 或 ZIP 格式的更新，并替换相应的文件以更新目标应用程序。之后 UPDATEAPPLICATION 执行 ShellExecute 以启动所需的应用程序，然后 UPDATEAPPLICATION 关闭。

这是一个相当基本的过程，多年来一直运作良好。UPDATEAPPLICATION 程序是一个Delphi 应用程序，我们的其他应用程序是混合的：Delphi、VB6、MS Access、.NET。

[问题] 随着向 Vista 和 Windows 7 的迁移，安全性发生了巨大变化。由于 UPDATEAPPLICATION 的性质，UAC 不允许应用程序在没有管理员访问权限或 UAC 完全关闭的情况下运行。我们正在将我们的许多应用程序升级到 .NET，在此过程中，我希望这些应用程序以及 UPDATEAPPLICATION 符合 UAC。根据我的研究，唯一的方法是将 UPDATEAPPLICATION 创建为 Windows 服务。因此，本质上，我需要将 UPDATEAPPLICATION 的功能复制到 Windows 服务架构中。

[我的设计] 我正在使用 DelphiXE2。我的设计将由 3 个部分组成，形成一个单一的解决方案：一个 Windows 服务、一个与 Windows 服务交互的小托盘应用程序，以及我重新设计的将向 Windows 服务发送消息的应用程序。

1.  我的 Windows 服务（我将其称为 UPDATESERVICE）将作为 Windows 服务运行并创建一个 TCP 服务器来侦听请求。
2.  托盘应用程序（我将其称为 TRAYAPP）将使用 TCP 客户端来配置/管理 UPDATESERVICE。
3.  我的 USERAPPLICATION 在启动时会向 UPDATESERVICE 发送一条 TCP 消息，上面写着“此应用程序”已启动。

[UPDATESERVICE] 将监听消息。如果它收到一条 USERAPPLICATION 已启动的消息，它将调用 Web 服务以查看是否有更新。如果有，将通知用户关闭应用程序并允许 UPDATESERVICE 更新应用程序。UPDATESERVICE 将下载适当的文件并更新应用程序。

现在我已经解释了我正在尝试做的事情的基础知识，我可以提出我需要回答的具体问题。这些都与我应该如何构建我的 Windows 服务有关。我还计划使用 OmniThread 进行线程管理。

当我的服务启动时，我需要创建 TCP Server。

1.  TCP服务应该在它自己的线程上创建吗？
2.  如果 TCP 服务是它自己的线程，我如何让线程保持活动状态？否则，我可以启动 TCP 服务，但我不确定我将在 TCP 服务单元中使用什么代码来保持线程运行？
3.  什么 Windows 服务事件应该创建 TCP 服务？执行？开机？创建？毕竟我读过它还不清楚应该使用什么事件。
4.  当 TCP Service 接收到要执行某项操作的消息时，该工作应该在 TCP Service 线程中执行还是从主 UPDATESERVICE 产生的新线程执行？例如：
    *   如果 TCP 服务收到一条使用 HTTP 检查更新的消息，TCP 服务线程是否应该生成一个新线程来完成这项工作
    *   或者，TCP 服务线程是否应该向 UPDATESERVICE 发送消息以生成一个新线程来完成这项工作
    *   这还重要吗？
5.  是否可以在 Delphi Code 中启动/停止/注册/取消注册 Windows 服务？

这是我所有的问题。对此可能没有正确/错误的答案，而只是基于经验的偏好。如果您已经使用 Delphi 构建了服务，您可能会有一些我觉得有用的输入。如果您有一个比基本的“启动服务并休眠”更强大的项目并且愿意分享它——即使我不运行或只是伪代码——我相信这将是无价的。感谢您阅读我冗长的问题。如果您能想到更好的解决方法，请分享您的想法。我要补充一点，我们的一些应用程序可以由公众下载和运行，因此我无法完全控制预期的环境。任何建议/意见/帮助将不胜感激。

* * *

## 回答 #1

> 赞同：30
> 
> 时间：2012-05-10T16:10:27.567

快速回答：

1&3) 是的。根据经验，不要实现 OnExecute 服务事件。从 OnStart 服务事件中生成您自己的线程。当您收到 OnStop 服务事件时，可以终止线程。

2）你让你的线程像这样（执行方法）：

```
while not Terminated do
begin
  // do something
end; 
```

4）通常每个客户端连接都将存在于它自己的线程上。（即 TCP 服务器为每个客户端生成一个新线程）。使用众所周知的堆栈，例如 Indy 或 ICS。关于 HTTP 更新，您可以在生成的客户端连接线程中执行此操作。

5）是的，请注意您需要提升权限才能执行此操作。

在我的职业生涯中，我做了很多服务，到目前为止，我总是为服务应用程序使用相同的框架：

```
unit u_svc_main;

interface

uses
  // Own units
  u_globals, u_eventlog, u_MyThread, 
  // Third party units
  // Delphi units
  Windows, Messages, Registry, SysUtils, Classes, SvcMgr;

type
  TMyService = class(TService)
    procedure ServiceCreate(Sender: TObject);
    procedure ServiceAfterUninstall(Sender: TService);
    procedure ServiceAfterInstall(Sender: TService);
    procedure ServiceShutdown(Sender: TService);
    procedure ServiceStop(Sender: TService; var Stopped: Boolean);
    procedure ServiceStart(Sender: TService; var Started: Boolean);
  private
    { Private declarations }
    MyThread : TMyThread;
  public
    { Public declarations }
    function GetServiceController: TServiceController; override;
  end;

var MyService : TMyService;

implementation

{$R *.DFM}

procedure ServiceController(CtrlCode: DWord); stdcall;
begin
  MyService.Controller(CtrlCode);
end;

function TMyService.GetServiceController: TServiceController;
begin
  Result := ServiceController;
end;

procedure TMyService.ServiceCreate(Sender: TObject);
begin
  DisplayName := 'myservice';
end;

procedure TMyService.ServiceAfterInstall(Sender: TService);
var
  Reg        : TRegistry;
  ImagePath  : string;
begin
  // create needed registry entries after service installation
  Reg := TRegistry.Create;
  try
    Reg.RootKey := HKEY_LOCAL_MACHINE;
    // set service description
    if Reg.OpenKey(STR_REGKEY_SVC,False) then
    begin
      ImagePath := Reg.ReadString(STR_REGVAL_IMAGEPATH);
      Reg.WriteString(STR_REGVAL_DESCRIPTION, STR_INFO_SVC_DESC);
      Reg.CloseKey;
    end;
    // set message resource for eventlog
    if Reg.OpenKey(STR_REGKEY_EVENTMSG, True) then
    begin
      Reg.WriteString(STR_REGVAL_EVENTMESSAGEFILE, ImagePath);
      Reg.WriteInteger(STR_REGVAL_TYPESSUPPORTED, 7);
      Reg.CloseKey;
    end;
    // set installdir
    if ImagePath <> '' then
      if Reg.OpenKey(STR_REGKEY_FULL,True) then
      begin
        Reg.WriteString(STR_REGVAL_INSTALLDIR, ExtractFilePath(ImagePath));
        Reg.CloseKey;
      end;
  finally
    FreeAndNil(Reg);
  end;
end;

procedure TMyService.ServiceAfterUninstall(Sender: TService);
var
  Reg : TRegistry;
begin
  Reg := TRegistry.Create;
  try
    // delete self created registry keys
    Reg.RootKey := HKEY_LOCAL_MACHINE;
    Reg.DeleteKey(STR_REGKEY_EVENTMSG);
  finally
    FreeAndNil(Reg);
  end;
end;

procedure TMyService.ServiceShutdown(Sender: TService);
var
  Stopped : boolean;
begin
  // is called when windows shuts down
  ServiceStop(Self, Stopped);
end;

procedure TMyService.ServiceStart(Sender: TService; var Started: Boolean);
begin
  Started := False;
  try
    MyThread := TMyThread.Create;
    MyThread.Resume;
    NTEventLog.Add(Eventlog_Success, STR_INFO_SVC_STARTED);
    Started := True;
  except
    on E : Exception do
    begin
      // add event in eventlog with reason why the service couldn't start
      NTEventLog.Add(Eventlog_Error_Type, Format(STR_INFO_SVC_STARTFAIL, [E.Message]));
    end;
  end;
end;

procedure TMyService.ServiceStop(Sender: TService; var Stopped: Boolean);
begin
  try
    Stopped := True; // always stop service, even if we had exceptions, this is to prevent "stuck" service (must reboot then)
    MyThread.Terminate;
    // give MyThread 60 seconds to terminate
    if WaitForSingleObject(MyThread.ThreadEvent, 60000) = WAIT_OBJECT_0 then
    begin
      FreeAndNil(MyThread);
      NTEventLog.Add(Eventlog_Success,STR_INFO_SVC_STOPPED);
    end;
  except
    on E : Exception do
    begin
      // add event in eventlog with reason why the service couldn't stop
      NTEventLog.Add(Eventlog_Error_Type, Format(STR_INFO_SVC_STOPFAIL, [E.Message]));
    end;
  end;
end;

end. 
```

# image - 元素 x、y、宽度、高度转换为不同尺寸

> ID：10537272
> 
> 赞同：0
> 
> 时间：2012-05-10T15:24:44.933
> 
> 标签：image, algorithm, math

我的数学一定很生疏。我必须想出一个已知的算法：

*   X
*   是的
*   宽度
*   高度

文档中的元素并将它们转换到不同硬件设备上的相同区域。例如，正在为打印创建文档（假设 8.5"x11" 字母大小），然后该文档中的元素将被传输到专有的电子阅读器。

此外，关于电子阅读器的已知事实，屏幕为 825x1200 像素纵向。每英寸有 150 个像素。

我以点为单位给出了打印文档中的源元素（每英寸 72 个 Postscript 点）。

到目前为止，我有一个接近的算法，但它需要准确，我觉得我需要将纵横比合并到图片中。我现在正在做的是：

```
x (in pixels) = ( x(in points)/width(of document in points) ) * width(of ereader in pixels) 
```

等等

有什么线索吗？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-10T15:33:38.847

You may want to revert the order of your operations to reduce the effect of integer truncation, as follows:

```
x (in pixels) =  x(in points) * width(of ereader in pixels) / width(of document in points) 
```

I don't think you have an aspect ratio problem, unless you forgot to mention that your e-reader device has non-square pixels. In that case you will have a different amount of pixels per inch horizontally and vertically on the device's screen, so you will use the horizontal ppi for x and the vertical ppi for y.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-10T15:29:18.223

assuming your coordinates are integer numbers, the formula `x/width` is truncating (integer division). What you need is to perform the division/multiplication in floating point numbers, *then* truncate. Something like

```
(int)(((double)x)/width1*width2) 
```

should do the trick (using C-like conversion to `double` and `int`)

# r - R按索引存储模型

> ID：10537274
> 
> 赞同：1
> 
> 时间：2012-05-10T15:24:45.870
> 
> 标签：r

使用包**earth**，我有许多模型，我想通过索引号调用模型。

我尝试过使用列表，但这不起作用。

```
a <- list(a)
a[1] <- earth(Volume ~ ., data = trees1)
a[2] <- earth(Volume ~ ., data = trees2)
a[3] <- earth(Volume ~ ., data = trees3) 
```

我会很感激你的帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-10T15:27:18.373

```
 x<-1:5
 y<-1:5
 a<-lm(x~y)
 b<-lm(y~x)
 mylist<-list(a,b)
 mylist 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-10T15:48:17.407

试试这个：

```
a <- list(a)
a[[1]] <- earth(Volume ~ ., data = trees1)
a[[2]] <- earth(Volume ~ ., data = trees2)
a[[3]] <- earth(Volume ~ ., data = trees3) 
```

您通常也希望使用“[[”访问内容。

# zend-framework - 如何将 zend 收音机放在扩展表中

> ID：10537276
> 
> 赞同：0
> 
> 时间：2012-05-10T15:24:49.860
> 
> 标签：zend-framework, zend-form, smarty, zend-form-element, zend-decorators

我正在尝试在 Zend Frameword 中构建一个表格，其中必须有一个像这样的表格：

![例子](../Images/b088bbcd7b96071de248a22a130b0955.png)

所以，它是一个单选按钮，后面跟着一些关于某种订阅的描述。我用谷歌搜索自己毫无意义，但无法做到这一点。我已经尝试了几个表单装饰器，但似乎单选按钮粘在一起，你只能将一整组单选按钮包装在一个 html-tag 中......

表单将由 Smarty 模板呈现，但我无法获取模板中的单个单选按钮。也许有人对此有一些经验。

有没有人有想法或链接让我继续这样做？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-10T17:48:48.020

此任务适用于 View Script Decorator 。

[http://framework.zend.com/manual/en/zend.form.standardDecorators.html#zend.form.standardDecorators.viewScript](http://framework.zend.com/manual/en/zend.form.standardDecorators.html#zend.form.standardDecorators.viewScript)

# scala - 这个导入在 Scala 中究竟意味着什么？

> ID：10537277
> 
> 赞同：15
> 
> 时间：2012-05-10T15:24:52.890
> 
> 标签：scala, syntax, import

我在 Scala 代码中遇到了以下问题：

```
我的班级{
  ...
  val a = 新 A；导入一个._

}
```

究竟是什么`val a = new A; import a._`意思？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-05-10T15:27:24.217

它导入对象的方法和变量。所以如果你想打电话`a.foo()`，你可以打电话`foo()`。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2012-05-10T15:28:08.863

这意味着`a`对象`A`类型的所有方法和变量现在都可以在此块（范围）中使用，而无需明确提及`a`. 因此，如果`A`有一种`bar()`方法，您现在可以说：

```
bar() 
```

代替

```
a.bar() 
```

但仅限于定义的范围内`import`。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2012-05-10T17:35:06.883

让我们用您应该熟悉的东西来解释这一点：

```
println("Hello world") 
```

问题是：为什么会这样？没有`println`使用`apply`方法调用的对象，这是对看起来像这样的代码的通常解释。好吧，碰巧的是，上面的代码确实是这样做的：

```
Predef.println("Hello world") 
```

换句话说，`println`是对象上的一个方法`scala.Predef`。那么，你怎么能像上面那样使用它呢？嗯，像这样：

```
import scala.Predef._
println("Hello world") 
```

导入*稳定引用*的内容 （即，不是 a`var`或 a `def`）将使其方法可用，而不必在它们前面加上`reference.`.

它还使在其中定义的任何隐式都可用，这就是使内部定义的隐式转换`scala.Predef`也可用的方式——Scala 导入`java.lang`,`scala`和的内容`scala.Predef`（按此顺序，因此后者会覆盖前面的内容）。

# jquery - Colorbox 跨浏览器的一致性

> ID：10537282
> 
> 赞同：54
> 
> 时间：2012-05-10T15:25:07.867
> 
> 标签：jquery, cross-browser, colorbox, bigbluebutton

我已经安装了一个 BigBlueButton 服务器，它似乎工作正常，因为我可以访问 BBB 演示，也可以使用 BBB API 从 PHP 应用程序访问它。

当我尝试在使用 iframe 内容类型的 Colorbox jQuery 插件创建的模式窗口中打开 BBB 客户端时，问题就开始了。当我使用 Firefox 或 Google Chrome 时，它​​按预期工作，因为 BBB 客户端打开并且用户作为主持人或与会者加入会议。

**问题 1：**当我在 Internet Explorer 或 Safari 中尝试这样做时，模式窗口没有打开 BBB 客户端。相反，它会将我带到我的 BBB 服务器上的 BBB 演示页面。而且我似乎无法加入模式窗口中的 BBB 演示。但它变得更糟。我添加了调试代码以确保模式窗口中用于调用 BBB 客户端的 url 是正确的。如果我只是将此 URL 放入 Internet Explorer 或 Safari 的新选项卡中，则 BBB 客户端将按预期打开。它只是在模态窗口中似乎没有这样做。

**问题2：**在我使用浏览器的另一个选项卡中的 URL 访问 BBB 客户端后，当我重新加载我的 PHP 应用程序并再次访问该页面时，BBB 客户端现在将按预期在使用 Colorbox 生成的模式窗口中加载。（所以，BBB API 生成的 URL 是正确的）。这种行为对于 IE 和 Safari 是一致的。）因此，出于某种原因，在 IE 或 Safari 允许我在由 Colorbox 生成的模式窗口中访问它之前，似乎有必要在浏览器选项卡中访问 BBB 客户端。另外，请注意，一旦我在浏览器选项卡中访问了 BBB 客户端，我就可以在模式窗口中访问任何会议（不仅是我在浏览器选项卡中加入的会议。）当我关闭浏览器并重新启动它时，然后在模态窗口中访问 BBB 客户端不再起作用。似乎在Colorbox生成的模态窗口中，

请帮忙。几天来我一直试图弄清楚这一点，但没有运气。有没有其他人遇到过类似的问题并有解决这些问题的指导？

非常感谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-08-15T13:03:30.597

棘手的一个是您从 URL 调用 BBB IPI，例如

```
<script src="www.bbb.com/script.js"></script> 
```

还是本地的

```
 <script src="js/bbb.js"></script> 
```

如果它不是本地脚本，请尝试下载它，我遇到了类似的问题，这已经解决了它们，如果您从另一个页面调用 API

```
<?php include_once "bbb.html" ?> 
```

确保脚本挂钩在调用页面和被调用页面上。在实时应用程序上应该没关系，但有时确实如此。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-12-05T05:17:00.687

您是否尝试过启用某些 IE 安全设​​置？我会将域设置为受信任站点，然后将受信任站点的设置更改为自定义级别。

一些可能有帮助的设置：

*   跨域访问数据源 - 启用
*   在 IFRAME 中启动程序和文件 - 启用
*   跨不同域导航窗口和框架 - 启用

# c# - 使用 WinZip/WinRar 将 ISO 提取到文件夹

> ID：10537288
> 
> 赞同：0
> 
> 时间：2012-05-10T15:25:30.563
> 
> 标签：c#, .net, iso, winrar, winzip

我正在尝试使用 C# 提取 ISO，我找到了一个 Winzip 库**DotNetZip**并使用了它，但是当我运行该项目时它说它无法提取 ISO。

```
string activeDir = copyTo = this.folderBD.SelectedPath;;

folderName = toExtract.Remove(toExtract.Length - 4, 4);

Path.Combine(activeDir,  Path.GetFileNameWithoutExtension(folderName));

string zipToUnpack = toExtract;
string unpackDirectory = folderName;

using (ZipFile zip1 = ZipFile.Read(zipToUnpack))
{
    // here, we extract every entry, but we could extract conditionally
    // based on entry name, size, date, checkbox status, etc.  
    foreach (ZipEntry file in zip1)
    {
        file.Extract(unpackDirectory, ExtractExistingFileAction.OverwriteSilently);
    }
} 
```

这就是我正在使用的代码。`copyTo`并`folderName`从程序中的其他方法传入。

任何让我在 ISO 上使用 Winzip 或 Winrar 的库都会有很大的帮助，但到目前为止，我的搜索没有任何结果。

提前致谢

编辑：您只能使用带有 C# 的 winrar 提取 .rar 或 .zip，还是可以将要提取的文件作为参数传递以及如何？我试过了

`ProcessStartInfo startInfo = new ProcessStartInfo("winrar.exe"); Process.Start("winrar.exe",@"C:\file\to\be\extracted");`

ISO 位置，但这会返回一个异常，即那里没有可提取的内容。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-10T15:31:30.087

您可以使用 Process.Start 从 c# 执行 winrar 并传入提取 iso 所需的参数。

# javascript - 如何从 asp.net 超链接控件调用 javascript

> ID：10537291
> 
> 赞同：5
> 
> 时间：2012-05-10T15:25:39.990
> 
> 标签：javascript, asp.net, hyperlink

[我只是想使用http://orangoo.com/labs/GreyBox/](http://orangoo.com/labs/GreyBox/)从 asp.net 超链接调用 JavaScript 函数，我的要求是在超链接上显示缩略图并在单击时显示完整图像。我应该使用其他控件吗？我的代码如下：

```
<asp:HyperLink ID="Hyperlink" runat="server" CssClass="Screenshot" ImageUrl="App_Themes/White/Images/thmb_screenshot_1.png"
                        NavigateUrl="App_Themes/White/Images/screenshot_1.png" ToolTip="screenshot 1"   />   

<script language="javascript" type="text/javascript">     
    //Greybox Image popup window
    function OpenImage(url) {
        var caption = "Home";
        return GB_showImage(caption, url)
    }         
</script> 
```

我该如何使用

```
onclick="OpenImage(this.src);
or 
OnClientClick="OpenImage(this.src); 
```

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2013-06-24T14:33:42.420

我知道这很旧，但对于任何有兴趣的人，只需添加 onclick 即可。额外的属性（即使它没有出现在智能感知上）将传递给渲染的标记。

```
 <asp:HyperLink ID="HyperLink4" runat="server" onclick="logDownload();" NavigateUrl="~/download/Sample-Icons.zip">Download Icons</asp:HyperLink> 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2012-05-10T16:32:48.147

如果您使用 a`LinkButton`而不是，您可以使用该`OnClientClick`属性来执行 JavaScript 函数。使用`HyperLink`控件，您可以`NavigateUrl`像这样使用属性：

```
<asp:HyperLink ID="Link1" runat="server"
    Text="Click Me!"
    NavigateUrl="javascript:OpenImage('App_Themes/White/Images/thmb_screenshot_1.png');">
</asp:HyperLink> 
```

这是一篇讨论它的文章：http:
[//gchandra.wordpress.com/2007/09/27/call-javascript-function-inside/](http://gchandra.wordpress.com/2007/09/27/call-javascript-function-inside/)

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2014-10-30T16:58:30.323

我知道这已经过时了，但是对于希望在服务器端而不是通过标记执行此操作的任何人，您都可以做到。

```
var hyperLink = new HyperLink { Text = "Display text", ID = "hyperlinkId"};
hyperLink.Attributes.Add("onclick", "javascriptMethod()"); 
```

* * *

## 回答 #4

> 赞同：-4
> 
> 时间：2012-05-10T15:28:37.427

看起来你基本上在那里，这有什么问题？

```
<asp:HyperLink ID="Hyperlink" runat="server" OnClientClick="OpenImage(this.src)" /> 
```

# javascript - 多个字符串与 indexOf() 匹配

> ID：10537294
> 
> 赞同：24
> 
> 时间：2012-05-10T15:25:47.103
> 
> 标签：javascript, jquery, html

我很确定我的语法是错误的，因为脚本只有在字符串匹配“视频”时才有效，如果字符串有“音频”这个词，它会被忽略。此外，由于 href 标记的值为“#”，重定向为“ ../../../index.html" 不起作用。

js

```
var ua = navigator.userAgent.toLowerCase();
var isIE8 = /MSIE 8.0/i.test(ua);
if (isIE8) {
    $('a').click(function () {
        var srcTag = $(this).find('img').attr('src');
        if (srcTag.indexOf('Video' || 'Audio') > -1) {
            if (confirm('Download Safari? \n\n http://apple.com/safari/download/')) {
            window.location = 'http://apple.com/safari/download/';
            } else { window.location = '../../../index.html';}
        } else {
            alert('no match');
        }
    });
} 
```

html

```
<a href="#"><img src="Video/000_Movies/assets/005_CCC_Jesus_Story_80x60.jpg" />test1</a> 
<a href="#"><img src="Audio/000_Movies/assets/006_GSP_Gods_Story_80x60.jpg" />test2</a> 
<a href="#"><img src="Media/000_Movies/assets/002_God_Man_80x60.jpg" />test3</a> 
```

* * *

## 回答 #1

> 赞同：92
> 
> 时间：2012-05-10T15:28:55.633

将其转换为正则表达式要短得多。

```
if ( srcTag.match( /(video|audio)/ ) ) {
  /* Found */
} else {
  /* Not Found */
} 
```

在旁注中，请不要做你想做的事情。要求用户在使用 Internet Explorer 8 时下载 Safari，这对 Internet 以及该用户都是有害的。

至于将域重定向到另一个位置，您应该使用`.preventDefault()`阻止浏览器跟踪链接：

```
$("a.videoDownload").on("click", function(e){
  e.preventDefault();
  if ( this.getElementsByTagName("img")[0].src.match( /(video|audo)/ ) ) {
    window.location = confirm( 'Download Safari?' )
      ? "http://apple.com/safari/download" 
      : "../../../index.html" ;
  } else {
    /* No match */
  }
}); 
```

再次，请不要*真的*这样做。没有人想成为*那个人*，当你告诉用户下载另一个浏览器时，你就是*那个人*。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2012-05-10T15:30:08.053

`'Video' || 'Audio'` is a logical OR. A non-empty string is implicitly a true value in JavaScript, and thus the short-circuited OR is not evaluated and this collapses to just `'Video'`. This is why you see the results you do.

Others have pointed you in correct directions to resolve.

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-05-10T15:28:12.560

我认为您可能希望在 indexOf 之外使用 OR (||) 运算符：

```
if ((srcTag.indexOf('Video') !== -1) || (srcTag.indexOf('Audio') !== -1)) {
  ...
} 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-05-10T15:27:43.077

我认为您需要的是 2 个单独的 indexOf，如下所示，

```
srcTag.indexOf('Video') != -1  || srcTag.indexOf('Audio') != -1 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-05-10T15:27:54.217

是的，你需要这样做：

```
if (srcTag.indexOf('Video') > -1 || srcTag.indexOf('Audio') > -1) { 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2020-10-16T09:22:55.317

简单的递归函数，您可以获得多个匹配项的索引

```
function getMultipleIndexOf(str, searchQuery, acc = 0, result = []) {
  if (!str || !searchQuery) {
    return { result, acc };
  }
  const foundIndex = str.toLowerCase().indexOf(searchQuery.toLowerCase());
  if (foundIndex < 0) {
    return { result, acc };
  }
  return getMultipleIndexOf(
    str.slice(foundIndex + searchQuery.length),
    searchQuery,
    acc + foundIndex + searchQuery.length,
    [...result, acc + foundIndex]
  );
}

const res = getMultipleIndexOf('long text some how long text!!', 'te');
// { result: [ 5, 24 ], acc: 26 } 
```

只需忽略跟踪先前找到的文本所需的 acc

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2017-11-10T15:34:43.083

使用正则表达式更快，使用[XRegExp](http://xregexp.com/)更好。

```
var sourceString = 'hello world, i am web developer';
if (XRegExp.test(sourceString, /(hello|web)/)) {
  // yes, `hello` or  `web` is found in `sourceString`
} 
```

执行时间为 0.10595703125ms

* * *

## 回答 #8

> 赞同：-2
> 
> 时间：2013-11-28T09:43:41.360

这也将起作用：

```
if (srcTag.indexOf('Video') >= -1 || srcTag.indexOf('Audio') >=-1 ) { 
```

* * *

## 回答 #9

> 赞同：-3
> 
> 时间：2017-06-21T10:28:46.717

这对我有用：

```
if (srcTag.indexOf('Video' | 'Audio' ) >= -1 ) { 
```

# clojure - 如何正确使用线程宏？

> ID：10537295
> 
> 赞同：3
> 
> 时间：2012-05-10T15:25:47.180
> 
> 标签：clojure

我的问题是如何让 Clojure 的线程宏之一在我的特定情况下工作？谢谢你。

我收到此错误：

```
(IllegalArgumentException Don't know how to create ISeq from: 
bene_csv.core$test_key_exclusion$fn__346  clojure.lang.RT.seqFrom (RT.java:487) 
```

当我调用这个函数时：

```
bene-csv.core=> (test-key-exclusion bene-data 1 gic-data 0 2 3) 
```

鉴于此代码——没有线程宏的工作解决方案被注释掉——

```
(defn ret-non-match-rows
    "Expects a sequence of sequences, like what is returned from clojure-csv.
     Returns nil if there's a match; else returns failing row."

    [s-o-s cmp-col-idx inq-row-idx inq-row]

    (let [inq-row inq-row]
        (loop [[row & remain-seq] s-o-s pos 0]
            (let [cmp-val (nth inq-row inq-row-idx nil)]
            (cond
                (not row) inq-row
                (= cmp-val (nth row cmp-col-idx)) nil
                :not-found (recur remain-seq (inc pos)))))))

(defn test-key-exclusion
    "This function takes csv-data1 (the includees) and tests to see
     if each includee is in csv-data2 (the includeds). This function
     also gathers enough other data, so that excludees (those not found),
     can be identified."

    [csv-data1 pkey-idx1 csv-data2 pkey-idx2 lnam-idx fnam-idx]

    (-> (map #(ret-non-match-rows csv-data2 pkey-idx2 pkey-idx1 %1) csv-data1)
        (filter (complement nil?))
        (map (fn [row]
                (vector (nth row pkey-idx1 nil)
                        (nth row lnam-idx nil)
                        (nth row fnam-idx nil))))))
(comment
    (map (fn [row]
            (vector (nth row pkey-idx1 nil)
                    (nth row lnam-idx nil)
                    (nth row fnam-idx nil)))

         (filter (complement nil?)
            (map #(ret-non-match-rows csv-data2 pkey-idx2 pkey-idx1 %1) csv-data1))) 
```

数据类似于以下：

```
[["0123456789" "SMITHFIELD" "HAM"]["1123456789" "LITTLE" "CHICKEN"] ...] 
```

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-05-10T17:21:25.643

您正在使用[“thread-first”宏](http://clojure.github.com/clojure/clojure.core-api.html#clojure.core/-%3E)，但您应该使用[“thread-last”宏](http://clojure.github.com/clojure/clojure.core-api.html#clojure.core/-%3E%3E)。绑定到符号 的“thread-last”宏`->>`与“thread-first”宏的作用相同，只是它将表单作为最后一个参数而不是第一个参数插入。

所以你的代码看起来像这样：

```
(->> (map #(ret-non-match-rows csv-data2 pkey-idx2 pkey-idx1 %1) csv-data1)
     (filter (complement nil?))
     (map (fn [row]
       (vector (nth row pkey-idx1 nil)
               (nth row lnam-idx nil)
               (nth row fnam-idx nil)))))) 
```

# c - How can I implement a mechanism of some sort to prevent buffer overflows

> ID：10537301
> 
> 赞同：3
> 
> 时间：2012-05-10T15:26:02.077
> 
> 标签：c, file-io

I am currently working on a C based log parser (making a C version of the original bash based log parser) and I was wondering how i should go about preventing a buffer overflow in the event that there is botched input, Pretty much just a way to stop the program automatically when it runs out of memory, I have provided the code below as well, thanks!

```
#include <stdio.h>
#include <stdlib.h>
#include <string.h>
#define _GNU_SOURCE
void main(int argc, char *argv[], char *envp[])
{
  FILE *fd;
  char *name;
  name = getenv("MCEXEC_PLAYERNAME");
  char *filename;
  filename = malloc(sizeof "/home/minecraft/freedonia/playerdata/deathlog-.txt" - 1 +    strlen(name) + 1);
  if (!filename) exit(EXIT_FAILURE);
  sprintf(filename,"/home/minecraft/freedonia/playerdata/deathlog-%s.txt",name);
  char buff[1024];
  if ((fd = fopen(filename, "r")) != NULL)
  {
    fseek(fd, 0, SEEK_SET);

    while(!feof(fd))
    {
      memset(buff, 0x00, 1024);
      fscanf(fd, "%[^\n]\n", buff);
    }
    printf("%s\n", buff);
  }
  else
  printf( "fail" );
} 
```

this code below is an attempt at implementing fgets and scanf, but when i run the program it just sits there without displaying any output

```
#include <stdio.h>
#include <stdlib.h>
#include <string.h>
#define _GNU_SOURCE
void main(int argc, char *argv[], char *envp[])
{
  FILE *fd;
  char *name;
  name = getenv("MCEXEC_PLAYERNAME");
  char *filename;
  filename = malloc(sizeof "/home/minecraft/freedonia/playerdata/deathlog-.txt" - 1 +     strlen(name) + 1);
  if (!filename) exit(EXIT_FAILURE);
  sprintf(filename,"/home/minecraft/freedonia/playerdata/deathlog-%s.txt",name);
  char *buff;
  buff = malloc(1024);
  char *finbuff;
  finbuff = malloc(1024);
  if ((fd = fopen(filename, "r")) != NULL)
  {
    fseek(fd, 0, SEEK_SET);

    while(!feof(fd))
  {
      memset(buff, 0x00, 1024);
      memset(finbuff, 0x00, 1024);
     // fscanf(fd, "%[^\n]\n", buff);
      fgets(buff, 1024, fd);
      scanf(buff, "%[^\n]\n", finbuff);
   }
    printf("%s\n", finbuff);
  }
  else
  printf( "fail" );
} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-10T15:29:47.037

Rather than using `fscanf`, you should use a combination of `fgets` and `sscanf` ... the advantage of `fgets()` is that you can specify the maximum number of bytes read, preventing buffer overflows. Secondarily, replace `sprintf` with `snprintf`.

The basic way to prevent buffer overflows is to avoid functions that write to a buffer without specifying the maximum number of bytes to write.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-10T16:16:11.043

我同意@Jason。

您可以使用 fgets() 将一行文本放入字符数组中，该数组将以空字符结尾（即：字符串）。然后，您可以使用 sscanf() 来解析每一行，假设每一行文本都有严格的格式。

以下帖子也可能会有所帮助。

[fgets 和 sscanf](https://stackoverflow.com/questions/9858809/fgets-and-sscanf)

# objective-c - Upload audio - http streaming

> ID：10537302
> 
> 赞同：1
> 
> 时间：2012-05-10T15:26:04.960
> 
> 标签：objective-c, ios, sockets, audio-streaming, cfstream

I'm trying to upload a linear file under http in streaming mode. The idea is do this steps simultaneously, 1) Thread 1: record an audio file and store it in a temp file 2) Thread 2: Take n bytes from temp file and send it to an http server.

How can I write an http stream?, On CFHTTPStream I did not see write methods, only read :s Do I need use sockets? Thanks!!!

My actual code is

```
 CFWriteStreamRef stream;
   NSString *strUrl = @"myurl";       
   NSURL *url = [[[NSURL alloc] initWithString:strUrl] retain];

   CFStringRef requestMethod = CFSTR("GET");

   CFHTTPMessageRef message= CFHTTPMessageCreateRequest(kCFAllocatorDefault, requestMethod, (CFURLRef)url, kCFHTTPVersion1_1);

    CFHTTPMessageSetHeaderFieldValue(message, CFSTR("Content-Type"),
                                     CFSTR("multipart/form-data"));
   stream =  ??  //CFReadStreamCreateForHTTPRequest(NULL, message);
    CFRelease(message);
  //other headers...        
    if (CFWriteStreamSetProperty(stream, kCFStreamPropertyHTTPShouldAutoredirect, kCFBooleanTrue)  == false)
    {
        NSLog(@"Error");
        return NO;
    }

    //
    // Open the stream
    //
    if (!CFWriteStreamOpen(stream))
    {
        CFRelease(stream);
        NSLog(@"Error");
        return NO;
    }

    CFStreamClientContext context = {0, self, NULL, NULL, NULL};
    CFWriteStreamSetClient(stram, kCFStreamEventHasBytesAvailable | kCFStreamEventErrorOccurred | kCFStreamEventEndEncountered,
                           RSWriteStreamCallBack,
                           &context);
    CFWriteStreamScheduleWithRunLoop(stream, CFRunLoopGetCurrent(), kCFRunLoopCommonModes); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-21T21:19:00.490

解决方案是创建一个NSInputStream的子类，并实现方法open、close、read、hasBytesAvailable并且不要忘记-(NSStreamStatus)streamStatus。最后一个方法从 http 调用，以了解我们是打开、关闭还是完成 (NSStreamStatusAtEnd) 发送（还有其他状态，但这是最重要的）。我使用像缓冲区这样的 tmp 文件，因为我必须发送大量数据，但也许数据内存缓冲区可能会更好。最后，我实现了使用自定义 NSInputStream 的其他类，代码如下：

```
 NSURL *url = [NSURL URLWithString:@"url"];
    NSMutableURLRequest *req = [NSMutableURLRequest requestWithURL:url];
    [req setHTTPMethod:@"POST"];
    //set headers if you have to do for example: 
    NSString *contentType = [NSString stringWithFormat:@"multipart/form-data"];
    [req setValue:contentType forHTTPHeaderField:@"Content-Type"];
    //Create your own InputStream
    instream = [[CustomStream alloc] init];
    [req setHTTPBodyStream:instream];
    //I remove instream later 
      NSURLConnection *aConnection = [[NSURLConnection alloc] initWithRequest:req delegate:self startImmediately:NO];
    [aConnection scheduleInRunLoop:[NSRunLoop currentRunLoop] forMode:NSDefaultRunLoopMode];
    [aConnection start]; 
```

# java - Lock-free guard for synchronized acquire/release

> ID：10537303
> 
> 赞同：4
> 
> 时间：2012-05-10T15:26:08.550
> 
> 标签：java, multithreading, mutex, critical-section, lock-free

I have a shared tempfile resource that is divided into chunks of 4K (or some such value). Each 4K in the file is represented by an index starting from zero. For this shared resource, I track the 4K chunk indices in use and always return the lowest indexed 4K chunk not in use, or -1 if all are in use.

This ResourceSet class for the indices has a public acquire and release method, both of which use synchronized lock whose duration is about like that of generating 4 random numbers (expensive, cpu-wise).

Therefore as you can see from the code that follows, I use an AtomicInteger "counting semaphore" to prevent a large number of threads from entering the critical section at the same time on acquire(), returning -1 (not available right now) if there are too many threads.

Currently, I am using a constant of 100 for the tight CAS loop to try to increment the atomic integer in acquire, and a constant of 10 for the maximum number of threads to then allow into the critical section, which is long enough to create contention. My question is, what should these constants be for a moderate to highly loaded servlet engine that has several threads trying to get access to these 4K chunks?

```
public class ResourceSet {

    // ??? what should this be
    // maximum number of attempts to try to increment with CAS on acquire
    private static final int    CAS_MAX_ATTEMPTS = 50;

    // ??? what should this be
    // maximum number of threads contending for lock before returning -1 on acquire
    private static final int    CONTENTION_MAX = 10;

    private AtomicInteger        latch = new AtomicInteger(0);

    ... member variables to track free resources

    private boolean aquireLatchForAquire ()
    {
        for (int i = 0; i < CAS_MAX_ATTEMPTS; i++) {
            int val = latch.get();
            if (val == -1)
                throw new AssertionError("bug in ResourceSet");        // this means more threads than can exist on any system, so its a bug!
            if (!latch.compareAndSet(val, val+1))
                continue;
            if (val < 0 || val >= CONTENTION_MAX) {
                latch.decrementAndGet();
                // added to fix BUG that comment pointed out, thanks!
                return false;
            }
        }
        return false;
    }

    private void aquireLatchForRelease ()
    {
        do {
            int val = latch.get();
            if (val == -1)
                throw new AssertionError("bug in ResourceSet");    // this means more threads than can exist on any system, so its a bug!
            if (latch.compareAndSet(val, val+1))
                return;
        } while (true);
    }

    public ResourceSet (int totalResources)
    {
        ... initialize
    }

    public int acquire (ResourceTracker owned)
    {        
        if (!aquireLatchForAquire())
            return -1;

        try {
            synchronized (this) {
                ... algorithm to compute minimum free resoource or return -1 if all in use
                return resourceindex;
            }
        } finally {
            latch.decrementAndGet();
        }
    }

    public boolean release (ResourceIter iter)
    {
        aquireLatchForRelease();
        try {
            synchronized (this) {
                ... iterate and release all resources
            }
        } finally {
            latch.decrementAndGet();
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-11T01:59:09.310

编写一个良好且高性能的自旋锁实际上非常复杂，需要对内存屏障有很好的理解。仅仅选择一个常数并不会削减它，而且绝对不会是可移植的。谷歌的 gperftools 有[一个你可以看的例子](http://code.google.com/p/gperftools/source/browse/trunk/src/base/spinlock.cc)，但可能比你需要的要复杂得多。

如果您真的想减少对锁的争用，您可能需要考虑使用更细粒度和更乐观的方案。一个简单的方法是将您的块分成 n 个组，并为每个组关联一个锁（也称为剥离）。这将有助于减少争用并提高吞吐量，但无助于减少延迟。您还可以将 AtomicBoolean 关联到每个块和 CAS 以获取它（在失败的情况下重试）。在处理无锁算法时要小心，因为它们往往很难正确处理。如果你做对了，它可以大大减少获取块的延迟。

请注意，如果不知道您的块选择算法是什么样的，就很难提出更细粒度的方法。我还假设您确实存在性能问题（已对其进行了分析以及所有内容）。

当我这样做时，您的自旋锁实现存在缺陷。您永远不应该直接在 CAS 上旋转，因为您正在向内存屏障发送垃圾邮件。[对于任何严重的争用（与雷鸣般的羊群问题](http://en.wikipedia.org/wiki/Thundering_herd_problem)有关） ，这将非常缓慢。最低要求是在您的 CAS 之前首先检查变量的可用性（如果没有障碍读取就很简单）。更好的是不要让所有线程都以相同的值旋转。这应该可以避免相关的缓存线在您的内核之间进行乒乓操作。

请注意，我不知道 Java 中的原子操作与哪种类型的内存屏障相关联，因此我的上述建议可能不是最佳或正确的。

最后，[多处理器编程的艺术](https://rads.stackoverflow.com/amzn/click/com/0123705916)是一本有趣的书，可以更好地了解我在这个答案中吐出的所有废话。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-11T02:09:32.527

You can use `Semaphore`'s `tryAcquire` method if you want your threads to balk on `no resource available`.

I for one would simply substitute your `synchronized` keyword with a `ReentrantLock` and use the `tryLock()` method on it. If you want to let your threads wait a bit, you can use `tryLock(timeout)` on the same class. Which one to choose and what value to use for timeout, needs to be determined by way of a performance test.

Creating an explicit gate seems as you seem to be doing seems unnecessary to me. I'm not saying that it can never help, but IMO it's more likely to actually hurt performance, and it's an added complication for sure. So unless you have an performance issue around here (based on a test you did) and you found that this kind of gating helps, I'd recommend to go with the simplest implementation.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-11T00:15:50.980

我不确定是否有必要为此场景打造自己的 Lock 类。由于 JDK 提供了 ReentrantLock，它在获取锁时也利用了 CAS 指令。与您的个人 Lock 类相比，性能应该相当不错。

# android - Twitter4j pagination with pull-to-refresh-list (Chris Banes)

> ID：10537308
> 
> 赞同：0
> 
> 时间：2012-05-10T15:26:21.900
> 
> 标签：android, twitter4j, pull-to-refresh

I try to implement homeline pagination via Twitter4j to pull-to-refresh list from Chris Banes. However, I have problems of that how to realize it. I have some notes how it should work but it isn't so, my pull refresh list doesn`t refresh. Have any ideas how to upload next 40 tweet to list on refresh?

Activity

```
protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.tweetlist);

        initializeVars();
        paging = new Paging(1, 40);

        try {
            ListView actualListView = pullToRefreshView.getRefreshableView();

            tweets = twitter.getHomeTimeline(paging);
            tweetAdapter = new TweetListAdapter(this, R.layout.customtweetlist, tweets);
            actualListView.setAdapter(tweetAdapter);
        } catch (TwitterException e) {
            e.printStackTrace();
        }
    }

public void onRefresh() {
        new GetDataTask().execute();
    }

    private class GetDataTask extends AsyncTask<Void, Void, List<Status>> {

        protected List<twitter4j.Status> doInBackground(Void... params) {
            paging.setPage(2);
            try {
                tweets = twitter.getHomeTimeline(paging);
            } catch (TwitterException e) {
                // TODO Auto-generated catch block
                e.printStackTrace();
            }
            return tweets;
        }

        protected void onPostExecute(List<twitter4j.Status> result) {
            tweetAdapter.notifyDataSetChanged();

            // Call onRefreshComplete when the list has been refreshed.
            pullToRefreshView.onRefreshComplete();

            super.onPostExecute(result);
        }
    } 
```

My TweetAdapter

```
public class TweetListAdapter extends ArrayAdapter<Status> {
    private final Context context;
    private final List<Status> values;

    public TweetListAdapter(Context context,int textViewResourceId, List<Status> tweets) {
        super(context, textViewResourceId, tweets);
        this.context = context;
        this.values = tweets;
    }

    @Override
    public View getView(int position, View convertView, ViewGroup parent) {
        LayoutInflater inflater = (LayoutInflater) context
                .getSystemService(Context.LAYOUT_INFLATER_SERVICE);
        View rowView = inflater.inflate(R.layout.customtweetlist, parent, false);
        TextView textView = (TextView) rowView.findViewById(R.id.tvText);
        ImageView imageView = (ImageView) rowView.findViewById(R.id.ivImage);
        Status tweet = values.get(position);
        textView.setText(tweet.getText());

    //  imageView.setImageBitmap(getBitmap(tweet.getProfileImageUrl()));
        rowView.invalidate();

        return rowView;
    }

    public static Bitmap getBitmap(String bitmapUrl) {
        try {
            URL url = new URL(bitmapUrl);
            return BitmapFactory.decodeStream(url.openConnection() .getInputStream()); 
        }
        catch(Exception ex) {return null;}
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-10T15:44:45.083

所以发生的事情是您正在更新`tweets`变量，这将更新适配器的`this.values`值，但是该列表**不是**适配器用来呈现列表的（如果您想知道原因，只需深入研究 ArrayAdapter 代码）。解决问题（并防止进一步混淆）的最简单方法是从 BaseAdapter 扩展。这对您来说需要做更多的工作，但您将完全控制适配器的功能（并且会更好地了解正在发生的事情）。

要进一步清理代码，您还应该向适配器添加一个更新 值的方法`this.values`，您不应该依赖它引用与 相同的列表`tweets`。

# groovy - Send messages logged via commons logging (by httpbuilder) to Logback

> ID：10537310
> 
> 赞同：0
> 
> 时间：2012-05-10T15:26:34.650
> 
> 标签：groovy, logback, httpbuilder

I am trying to get apache httpclient logs on the console for HTTPBuilder's RESTClient in groovy. I tried various approaches, including the [standard instructions](https://github.com/jgritman/httpbuilder/wiki) and some other suggestions such as [this](http://groovy.329449.n5.nabble.com/HTTPBuilder-Location-of-the-log4j-xml-file-td372582.html) and [this](http://blog.techstacks.com/2009/12/configuring-wire-logging-in-groovy-httpbuilder.html), but to no avail.

Finally after much frustration, I got some help from this [SO question](https://stackoverflow.com/questions/2975515/http-builder-groovy-lost-302-redirect-handling), and though it's not a clean solution, it gets the job done - I do get the wire logs now.

Here's some sample code:

```
// test.groovy
import groovyx.net.http.RESTClient

import java.util.logging.ConsoleHandler
import java.util.logging.Level
import java.util.logging.Logger

// Remove default loggers
def logger=Logger.getLogger('')
def handlers=logger.handlers
handlers.each() { handler->logger.removeHandler(handler) }

// Log ALL to Console
logger.setLevel Level.FINE
def consoleHandler=new ConsoleHandler()
consoleHandler.setLevel Level.FINE
logger.addHandler(consoleHandler)

def myclient = new RESTClient( 'https://www.google.com/search' )

def resp = myclient.get( queryString: 'q=httpclient' ) 
```

The only problem now is that I want to use logback instead of java.util.Logging for this, because the rest of my application is already using logback.

I am now trying to get the equivalent logback.groovy configuration for the above, but it doesn't work:

```
// logback.groovy
appender("CONSOLE", ConsoleAppender)
{
    encoder(PatternLayoutEncoder)
    {
      pattern = "%d{HH:mm:ss.SSS} [%thread] %-5level %logger{36} - %msg%n"
    }
}

root DEBUG, ["CONSOLE"]

logger "groovyx.net.http.HttpURLClient", DEBUG, ["CONSOLE"]
logger "org.apache.http", DEBUG, ["CONSOLE"]
logger "org.apache.http.headers", DEBUG, ["CONSOLE"]
logger "org.apache.http.wire", DEBUG, ["CONSOLE"] 
```

I am not getting any apache headers or apache wire logs. I am very new to logback (and log4j and slf4j and java.util.Logging), so your help would be greatly appreciated.

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2014-02-20T07:24:23.567

> 作为一个库 HttpClient 并不是要规定用户必须使用哪个日志框架。因此 HttpClient 使用了 Commons Logging 包提供的日志接口

您应该使用 JCL 到 SLF4j 桥来通过 SLF4j 处理程序处理应用程序的 JCL 活动。见[http://www.slf4j.org/legacy.html#jcl-over-slf4j](http://www.slf4j.org/legacy.html#jcl-over-slf4j)

# java - JScrollPane not scrolling when a JPanel is added

> ID：10537311
> 
> 赞同：1
> 
> 时间：2012-05-10T15:26:40.000
> 
> 标签：java, swing, scroll, jpanel, jscrollpane

I was hoping someone would be able to help. This seems like it should be a simple problem but for the life of me I can't work it out.

Problem: I am creating a `JPanel` that is made up of panels containing 5 labels each with `ImageIcons`. [sounds confusing]

I am then adding this panel to a `JScrollPane`. But when it is displayed the images are showing and correctly placed but I am unable to scroll down to see the panels that are off the screen.

here is a screenshot: [http://img841.imageshack.us/img841/36/screenshot20120510at160.png](http://img841.imageshack.us/img841/36/screenshot20120510at160.png)

Here is the snippet of code I am using to populate the panels and add the `JScrollPane`.

```
private void setSeriesViewContainer(){
    container = new BackgroundPanel(backGround, BackgroundPanel.TILED);
    //container.setPreferredSize(new Dimension(650,500));
    container.setLayout(new BoxLayout(container, BoxLayout.PAGE_AXIS));
    FlowLayout flowLayout = new FlowLayout();
    JPanel[] jp = new BackgroundPanel[10];
        for (int i = 0; i < jp.length; i++) {
        jp[i] = new BackgroundPanel(backGround, BackgroundPanel.TILED);
        jp[i].setLayout(flowLayout);
            for (int j = 0; j < 10; j++) {
                jp[i].add(new JLabel(new         ImageIcon(getClass().getResource("/placeHolder.png"))));

            }

    }
        for (int i = 0; i < jp.length; i++) {
        container.add(jp[i]);

    }
public void init(){
seriesViewContainer = new javax.swing.JScrollPane(container);
seriesViewContainer.setBorder(null);
         seriesViewContainer.setHorizontalScrollBarPolicy(javax.swing.ScrollPaneConstants.HORIZONTAL_SCROLLBAR_ALWAYS);
    seriesViewContainer.setVerticalScrollBarPolicy(javax.swing.ScrollPaneConstants.VERTICAL_SCROLLBAR_ALWAYS);
    seriesViewContainer.setPreferredSize(new java.awt.Dimension(700, 300));} 
```

I have searched around for the solution but have not come up with one as yet.

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-10T15:52:48.290

`container.setPreferredSize(new Dimension(x,y));`容器的尺寸应大于滚动窗格的尺寸。

从我读过的内容来看，setPreferredSize() 并不是一件好事。问题可能是容器或 jp 的 LayoutManager。

同样的问题：[Java Swing: JScrollPane not working](https://stackoverflow.com/questions/10016879/java-swing-jscrollpane-not-working)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-17T23:13:59.007

您是否尝试在每次添加后调用 revalidate() 到 JScrollPane 和/或容器？

# javascript - SetReadOnly Ckeditor

> ID：10537315
> 
> 赞同：0
> 
> 时间：2012-05-10T15:27:05.650
> 
> 标签：javascript, jquery, ckeditor

I'm having a hard time using `setReadonly` of CKEDITOR. I want to use `setReadonly` when the Editor is already loaded and ready to be used. I tried using `instanceReady`:

```
 var editor;
    CKEDITOR.on( 'instanceReady', function( ev ){
        editor = ev.editor;
        editor.setReadOnly( true );
    }); 
```

but this does not work, I tried using buttons like the sample is using and it works fine. Is there anyway to `setReadonly` automatically when the editor is ready to be used?

Thanks

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-10T18:01:22.677

最好将它创建为[只读](http://docs.cksource.com/ckeditor_api/symbols/CKEDITOR.config.html#.readOnly)而不是等待它完成然后告诉它以只读方式重新启动。

例如

```
<!DOCTYPE html>
<html>
<head>
  <script type="text/javascript" src="ckeditor/ckeditor.js"></script>
</head>
<body>
<textarea name="messageid" id="messageid">
    abc
</textarea>
<script type="text/javascript">
   CKEDITOR.replace('messageid', {readOnly: true} );  
 </script>   
</body>
</html> 
```

[小提琴演示](http://jsfiddle.net/NxXbn/)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-25T15:46:58.620

在这里你可以看到它是如何工作的！！对我来说工作正常。

[http://ckeditor.com/latest/samples/readonly.html](http://ckeditor.com/latest/samples/readonly.html)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-11-21T19:34:02.357

很简单，在 textarea 中使用 disabled 标签。

例子：

```
<!DOCTYPE html>
<html>
<head>
  <script type="text/javascript" src="ckeditor/ckeditor.js"></script>
</head>
<body>
<textarea name="messageid" id="messageid" disabled="disabled">
    abc
</textarea>
<script type="text/javascript">
   CKEDITOR.replace('messageid');  
 </script>   
</body>
</html> 
```

# android - 如何从 PreferenceScreen 上的文本条目打开对话框？

> ID：10537320
> 
> 赞同：11
> 
> 时间：2012-05-10T15:27:22.513
> 
> 标签：android, android-preferences, android-dialog

在我的 Android 应用程序中，如果用户在 PreferenceScreen 中选择看起来像纯文本的内容，我想显示一个对话框。我已经看到[如何从首选项屏幕打开 AlertDialog？](https://stackoverflow.com/questions/5456993/how-to-open-alertdialog-from-preference-screen)，但该解决方案从 CheckBoxPreference 启动。

就我而言，我想从看起来像 TextView 的东西（或者我想它可能是一个按钮）启动，然后它会导致我已经拥有一个“关于”对话框。任何建议如何做到这一点？谢谢。

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2012-05-10T15:34:21.750

首选项.xml 文件：

```
<PreferenceScreen xmlns:android="http://schemas.android.com/apk/res/android">
    <Preference android:key="dialog_preference" />
</PreferenceScreen> 
```

活动：

```
addPreferencesFromResource(R.xml.preferences);

dialogPreference = (Preference) getPreferenceScreen().findPreference("dialog_preference");
dialogPreference.setOnPreferenceClickListener(new OnPreferenceClickListener() {
        public boolean onPreferenceClick(Preference preference) {
            // dialog code here
            return true;
        }
    }); 
```

# php - 在 php 中更改查询的单选按钮

> ID：10537323
> 
> 赞同：1
> 
> 时间：2012-05-10T15:27:24.170
> 
> 标签：php, mysql, radio-button

我正在尝试用一种主要语言制作多语言词典。我想使用单选按钮来更改语言（以及 php 中的查询） 我的想法是拥有例如 3 个单选按钮：-English、-German、-Spanish。那就是改变语言/查询。

现在我有这样一个代码（在 index.php 中）：

```
<script type='text/javascript'>
$(function(){
    $("form#search-form").submit(function(){
        $("#results").fadeOut();
        $.ajax({
            type:"GET",
            data: $(this).serialize(),
            url: "search.php",
            success: function(msg)
                {
                $("#results").html(msg);
                $("#results").fadeIn();
                }
        });
    return false;
    });

});
</script> 
```

那是 jquery 脚本，可以立即获得结果。以及 div 中的搜索表单：

```
<div id='container'>
<div id='search-box'>
    <form id='search-form'>
        <input type='text' id='input-text' name='s' value=''/>
    </form>
</div> 
```

在 search.php 中：

```
$q = "SELECT * FROM lauk_pamed WHERE diakr LIKE '%".$search_term. "%'or mask LIKE '%" .$search_term. "%' ORDER BY words LIMIT 21";
$r = mysql_query($q);

     if(mysql_num_rows($r)==0)//no result found
    {
    echo "<div id='search-status'>Nothing was found</div>";
    }
 else //result found
    {
    echo "<ul>";
    while($row = mysql_fetch_assoc($r))
        {
        $prus = str_ireplace($search_term, "".$search_term."", $row['wirds']);
        $des = $row['descr'];
?> 
```

所以我的想法是：如果 -English 打开，则查询必须是：

```
 $q = "SELECT * FROM lauk_pamed WHERE diakr LIKE '%".$search_term. "%'or english LIKE '%" .$search_term. "%' ORDER BY words LIMIT 21"; 
```

如果 -German 打开，则查询必须是：

```
 $q = "SELECT * FROM lauk_pamed WHERE diakr LIKE '%".$search_term. "%'or german LIKE '%" .$search_term. "%' ORDER BY words LIMIT 21"; 
```

等等。我怎么能使用单选按钮来做到这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-10T15:38:28.927

HTML：

```
<input id="radioBtn" type="radio" name="radioButton" value="english"> 
```

JS：

```
$("#radioBtn").onChecked{

} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-10T15:37:40.497

在您的 HTML 中执行以下操作：

```
<div id='search-box'>
    <form id='search-form'>
        Translate this:
        <input type='text' id='input-text' name='translate' value=''/>

        <br/><br/><br/>

        Into:<br/>
        <input type="radio" name="language" value="English"> English<br>
        <input type="radio" name="language" value="Spanish"> Spanish<br>
        <input type="radio" name="language" value="German" checked> German

        <br/><br/><br/>

        <button type="submit">Submit</button>
    </form>
</div>​​​​ 
```

然后在 PHP 中，您可以像这样获取字符串和语言：

```
<?php
    $search_string = $_GET['translate'];
    $language      = $_GET['language'];

    // Rest of your code... 
```

如果您希望在单击其他语言时自动提交表单，您可以在 JS 中执行此操作：

```
$('input[name=language]').change(function() {
    $('#search-form').submit();
}); 
```

# html - CSS 和 Internet Explorer div 位置问题

> ID：10537328
> 
> 赞同：0
> 
> 时间：2012-05-10T15:27:39.517
> 
> 标签：html, css, internet-explorer

```
body {
background-image: url(pattern.jpeg); background-attachment: fixed;
font-size:12px;
font-family:Verdana, Arial, Helvetica, sans-serif;
text-align: center;
}

 h1,h2,h3
 {
 color : #6685a8;
 }

 div#outer {
width: 960px;
background-color:#FFFFFF;
margin-top: 00px;
margin-bottom: 0px;
margin-left: auto;
margin-right: auto;
padding: 0px;
border: thin solid #000000;
text-align: left;
 }

 div#header {
padding: 5px;
margin: 0px;
text-align: left;
background-color :#8bb8e8;
 }

 div#nav {
width: 160px;
height: 1669px;
padding: 0px;
margin-top: 0px;
float: left;
background-color:#6685a8;
 }

 div#navright {
width: 160px;
height: 1669px;
padding: 0px;
margin-top: 0px;
background-color:#6685a8;
  }

 div#main {
float:top;
margin-top: 0px;}

 div#footer {
font-size:12px;
font-family:Verdana, Arial, Helvetica, sans-serif;
padding: 15px;
margin: 0px;
border-top: thin solid #000000;
} 
```

一旦我为它创建了 html，它只有一个小标题、两个侧边栏和中间的主要部分（这只是一张图片），页脚包含所有信息，它也都位于页面的中心。问题是它在 chrome 和 firefox 中运行良好，但是当我在 Internet Explorer 中打开它时，它会将 Main.div 和 Footer.div 放在所有内容下方，我需要它位于 nav.div 和 right 之间的顶部。 div

```
<html>
<head>
<link href="carguys.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="outer">
    <div id="header" >
    <p>
     </div>
    <div id="nav">
        <img src="" alt="" width="160" height="400" align="middle"/>
    </div>
    <div id="navright">

    </div>
     <div id="main" align="center">
        <img src="" alt="" width="640" height="400"></img>
    </div>
    <div id="footer">
        <h1 align="center">The Show</h1>
     *lots of content in this section, including a table*
    </div>
 </div>
 </body> 
```

# c# - 用于查看 SharePoint 库中的照片的 Web 部件

> ID：10537330
> 
> 赞同：2
> 
> 时间：2012-05-10T15:27:43.430
> 
> 标签：c#, sharepoint, web-parts

我正在尝试开发一个 Web 部件，它将显示我的照片库中的随机照片。

我已经能够成功循环并从库中选择一张随机照片。我现在的问题是在 SharePoint 网站上显示这张照片。我尝试创建一个图像控件并将 url 设置为我检索到的 url 并以编程方式添加图像控件，但在 web 部件加载后图像似乎没有显示在页面上。它只是显示一个红色 X 表示图像无法显示。

如果我在浏览器中导航到照片的 URL，它会显示，但当 Web 部件尝试将其拉下时不会显示。

有人可以给我指点吗？我仍然是 SharePoint 初学者

这是我到目前为止所拥有的：

```
 Random randomNumber;
       randomNumber = new Random();

       Controls.Clear();
       ClearChildState();
       SPWeb thisWeb = SPContext.Current.Web;

       SPPictureLibrary pictures = (SPPictureLibrary)thisWeb.Lists["Houston Photos"];
       int pictureCount = pictures.ItemCount;
       int index = randomNumber.Next(pictureCount);
       string source = thisWeb.Url + "/" + pictures.Items[index].Url;
       String itemHtml = String.Format(@"<img SRC={0}+height=200px> </img>",source);
       this.Controls.Add(new LiteralControl(itemHtml));
       imgControl.ImageUrl = source; 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-10T18:06:22.720

我会说问题出在你的 img 标签上

尝试类似的东西

```
string itemHtml = string.concat("<img src=\"", source, "\" height=\"200\" />); 
```

您还可以使用 Image 类控件， http: [//msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.image.aspx](http://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.image.aspx)

```
Random randomNumber;
randomNumber = new Random();

Controls.Clear();
ClearChildState();
SPWeb thisWeb = SPContext.Current.Web;

SPPictureLibrary pictures = (SPPictureLibrary)thisWeb.Lists["Houston Photos"];
int pictureCount = pictures.ItemCount;
int index = randomNumber.Next(pictureCount);
string source = thisWeb.Url + "/" + pictures.Items[index].Url;

var image = new Image();
image.ImageUrl = source;
image.Height = 200;
this.Controls.Add(image); 
```

# ruby-on-rails - 公开我的本地应用

> ID：10537331
> 
> 赞同：0
> 
> 时间：2012-05-10T15:27:43.950
> 
> 标签：ruby-on-rails, ruby-on-rails-3.2

当我在 localhost:3000/somecontroller 的机器上启动一些应用程序时。如果我尝试 mymachineip:3000/somecontroller 是否可以公开？对不起，如果是一个愚蠢的问题......

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-10T15:32:43.293

Rails 应用程序默认为 listen on `0.0.0.0:3000`，这实际上只是意味着“在端口 3000 上侦听所有接口”。所以是的，您应该能够通过其 IP 地址从另一台机器访问它。（如果你在你的机器上运行防火墙或任何东西，你可能需要打开端口）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-10T15:33:41.297

You have to configure the firewall to allow access to your machine. Your router has a public IP. You can figure the public IP out, if you go to [http://whatismyipaddress.com/](http://whatismyipaddress.com/), or so similar site.

Then you can configure your firewall to allow access to your machine. Open your router settings, and open a port to your local machine IP. [http://www.wikihow.com/Set-up-Port-Forwarding-on-a-Router](http://www.wikihow.com/Set-up-Port-Forwarding-on-a-Router)

It's also a good idea to give the machine a static IP, bc the IP can change when the machine restarts.

# c# - 在 .NET WebBrowser 控件中显示具有命名空间的 XHTML 元素

> ID：10537332
> 
> 赞同：0
> 
> 时间：2012-05-10T15:27:45.807
> 
> 标签：c#, .net, xml, xhtml

我有一个 XML 文档，其中包含一个元素 XHTML 片段，特别是一个或多个**p**标签，它可以包含更多的 XHTML 标签，例如**em**、**span**等。这些都在“xhtml”命名空间中，并且 XSD 已经导入了 XHTML严格的模式，所以在这方面一切都很好。我的问题是这样的：

我的应用程序需要将这些 XHTML 段落显示为文档。我的想法是将它们包装在一个 XHTML 文档中，并在 body 标记上指定一个命名空间，如下所示：

```
<!-- Stock XHTML pre-amble from application -->
<html>
<head>
    <meta http-equiv="content-type" 
        content="application/xhtml+xml;charset=utf-16" />
</head>
<body xmlns:xhtml="http://www.w3.org/1999/xhtml">
  <!-- Elements from XML document -->
  <xhtml:p>Namespaced paragraph from XML</xhtml:p>  
  <xhtml:p>A partly <xhtml:em>italicised</xhtml:em> paragraph from XML</xhtml:p>
<!-- Post-amble -->
</body> 
</html> 
```

这样，在将文档放在一起时，我就不必从 XHTML 元素中删除所有名称空间。

虽然这在 Firefox 中正确显示，但如果我将其保存为文件，在 System.Windows.Forms.WebBrowser 控件 (.NET 3.0) 中，两个段落一起流动并且**em**被忽略（同样的事情发生在 IE8 中）。换句话说，WebBrowser 不会理解命名空间，并将**xhtml:p**视为未知元素。

从纯学术的角度来看，我很好奇 Firefox 或 IE8 是否适合这里，但我更感兴趣的是这个问题的实用解决方案，如果存在的话。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-11T15:50:18.620

IE8 不支持“真正的”XHTML，因此带有冒号的元素根本不在命名空间中。事实上，如果您在 IE8 中检查 DOM，您会发现元素甚至没有正确地包裹文本。

我怀疑 WebBrowser 控件也是如此。

# http - 蜂窝网络上不支持 HttpWebRequest AllowReadStreamBuffering 属性？

> ID：10537334
> 
> 赞同：0
> 
> 时间：2012-05-10T15:27:55.710
> 
> 标签：http, windows-phone-7, persistent-connection

我正在编写一个通过 http 使用持久连接的应用程序 - 也就是说，Web 服务器永远不会“完成”对响应流的写入，而客户端应用程序会在响应流进入时从响应流中读取数据。

我编写了一些 .NET 3.5 桌面/winforms 应用程序来确认服务器和客户端代码工作正常，然后编写了一个 windows phone 应用程序来做同样的事情。桌面/电话代码之间的唯一区别是我在电话上将 AllowReadStreamBuffering 属性设置为 false。

电话应用程序昨晚工作，但今天它不起作用 - 尝试读取响应流时，它会挂起，直到从服务器端关闭连接 - 这意味着 HttpWebRequest 不支持 AllowReadStreamBuffering 设置。

昨晚和现在的区别在于，昨晚我使用的是 wifi，而今天我是通过蜂窝网络连接的。

我的假设是，在电话上，HttpWebRequest 仅在连接是 wifi（可能还有以太网）时才尊重 AllowReadStreamBuffering = false，但在使用蜂窝网络时它会忽略它并缓冲。

那么 HttpWebRequest 在通过蜂窝连接时强制读取流缓冲是真的吗？我还没有找到任何证实这种行为的文档，所以我想知道是否有其他人经历过这种情况。稍后我将能够更彻底地对此进行测试，但现在我想我会问这个问题。

**更新 5-11-12**
测试并回答了我自己的问题（见下文）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-10T15:51:12.487

AllowReadStreamBuffering = false 适用于蜂窝连接；否则（例如）音频流应用程序将无法正常运行。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-11T14:24:10.173

*我验证了我的 WP7 应用程序在通过蜂窝连接时最初*不会读取无缓冲的响应流 - 它仅在以太网或 wifi 上时才会这样做。

所以我修改了我的服务器 httphandler 以在连接开始时将初始数据块（8k）写入响应流。这样做会使应用程序立即在蜂窝网络上读取响应流，就像它在 wifi 上一样。在忽略最初的数据爆炸后，应用程序可以很好地实时处理各个字节。

我能想到的唯一结论是，当通过蜂窝连接时，HttpWebRequest 最初需要缓冲少量数据，然后才能无缓冲地读取流。

# sql-server - SQL Server：创建函数

> ID：10537336
> 
> 赞同：1
> 
> 时间：2012-05-10T15:27:58.257
> 
> 标签：sql-server, user-defined-functions, stored-functions

我在尝试创建一个可以调用以生成 32 个字符的随机 ID 的函数时遇到了一些麻烦。我让它在查询编辑器中工作，但我的理解是，要在多行结果中生成它，并伴有表中的现有数据，我必须创建一个函数并调用它。这是我的代码：

```
CREATE FUNCTION [dbo].[Func_Gen_OID] (@NewOID varchar(32))
RETURNS VARCHAR(32) AS
BEGIN

DECLARE @Length int = 32
DECLARE @Output varchar(32)
DECLARE @counter smallint
DECLARE @RandomNumber float
DECLARE @RandomNumberInt tinyint
DECLARE @CurrentCharacter varchar(1)
DECLARE @ValidCharacters varchar(255)
SET @ValidCharacters = 'ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789'
DECLARE @ValidCharactersLength int
SET @ValidCharactersLength = len(@ValidCharacters)
SET @CurrentCharacter = ''
SET @RandomNumber = 0
SET @RandomNumberInt = 0
SET @Output = ''

SET NOCOUNT ON

SET @counter = 1

WHILE @counter < (@Length + 1)

BEGIN

        SET @RandomNumber = Rand()
        SET @RandomNumberInt = Convert(tinyint, ((@ValidCharactersLength - 1) * @RandomNumber + 1))

        SELECT @CurrentCharacter = SUBSTRING(@ValidCharacters, @RandomNumberInt, 1)

        SET @counter = @counter + 1

        SET @Output = @Output + @CurrentCharacter

RETURN @Output
END 
```

感谢您的任何帮助！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-23T09:43:30.490

而不是 RAND() 函数，使用这个：

```
create view ViewRandomNumbers 
as 
   select rand( ) as Number 
go 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-10T15:47:18.730

我猜你会看到这个错误：

```
Invalid use of a side-effecting operator 'rand' within a function. 
```

您不能直接在用户定义的函数中使用 RAND() （您需要一个视图作为中介）。在这种情况下，RAND 无论如何都会为查询的每一行返回相同的值，因为您没有指定不同的种子（对函数的每次调用都不同）。如果你想将其余的逻辑封装在函数中，你需要从别处传递一个随机生成的值，可能通过 CHECKSUM() 和 NEWID() 生成。

[此SQL Server Central 线程](http://www.sqlservercentral.com/Forums/Topic666309-338-1.aspx)中提到了一些可能性

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-10T15:40:12.417

我看到的两个问题：

1.  您在 while 循环中返回 @Output 。
2.  您不需要输入参数，因为您没有在函数内部使用它

# amazon - 如何与亚马逊购买的商品互动？

> ID：10537337
> 
> 赞同：5
> 
> 时间：2012-05-10T15:28:05.940
> 
> 标签：amazon, kindle, amazon-product-api

我想将我们的图书馆管理系统 (OLIB) 与我们的亚马逊账户同步，以跟踪我们购买的电子书。这甚至可能吗？我最接近的是亚马逊的产品广告 API：

[https://affiliate-program.amazon.com/gp/advertising/api/detail/main.html](https://affiliate-program.amazon.com/gp/advertising/api/detail/main.html)

然而，它似乎适用于亚马逊的产品列表，但没有提及如何访问我的帐户来管理我购买的 Kindle 电子书。

有任何想法吗？提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-16T17:37:03.030

简短的回答，不。相关问题的答案稍长，[https://stackoverflow.com/a/12905025/1251108](https://stackoverflow.com/a/12905025/1251108)。

一般来说，亚马逊似乎对公开客户购买历史不感兴趣。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-06-16T00:56:05.870

是的，但不是正式的。您可能可以在我所做的工作之上构建一些东西。到目前为止，我已经公开了以下功能

*   列出购买的内容
*   列出个人文件（您通过电子邮件发送或 Instapaper 交付的文件）
*   删除项目

您可以[在 GitHub 上找到我的代码](https://github.com/fatso83/amazon_fiona)- 几分钟前刚刚发布 :) 请注意，这是通过模拟浏览器来工作的，因此对于 UI 中的更改非常脆弱。但是自从我几年前向他们投诉以来，亚马逊并没有改变任何东西，所以我不会太担心......

# jquery - 如何注入 dom并让它渲染/加载？

> ID：10537350
> 
> 赞同：0
> 
> 时间：2012-05-10T15:28:37.437
> 
> 标签：jquery

我通过 jQuery 成功地将 html 插入到元素中而没有问题。问题是对象从不渲染/播放/显示。这是我的代码：

```
<script>
player='<object id="myPlayer" class="myPlayer">';
player+='<param name="bgcolor" value="#FFFFFF" /></object>';
$("#player").append(player);
</script>
<div id="player"></div> 
```

插入 html 元素后，此代码的结果是正确的，但它永远不会呈现。

如果您加载了没有通过 jQuery 插入的对象的页面，我该如何插入并让它呈现呢？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-10T15:34:24.570

Try appending the object after the `div#player` is loaded (or in a ready/ondomload handler). I'm betting that your script is run before `div#player` loads which is why it doesn't show.

```
<script>
$(document).ready(function(){
   player='<object id="myExperience" class="BrightcoveExperience">';
   player+='<param name="bgcolor" value="#FFFFFF" /></object>';
   $("#player").append(player); /* or equivalent vanilla js                 
                                 * document.getElementById("player").innerHtml = player;
                                 */

})
</script>
<div id='player'></div> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-10T15:33:50.140

change inside script:

```
$("#player").html(player); 
```

w/o jquery

```
document.getElementById('player').innerHTML = player; 
```

# c# - C# Listenin 5060 端口

> ID：10537352
> 
> 赞同：-1
> 
> 时间：2012-05-10T15:28:47.140
> 
> 标签：c#

> **可能重复：**
> [监听端口 5060](https://stackoverflow.com/questions/10507166/listening-to-port-5060)

我正在开发一个 SIP 客户端。我有一个问题。我想监听 5060 端口以捕获 SIP 服务器消息。为此，我编写了一些东西。（我也获得了程序的管理员权限）

但是我得到了 SocketException：“试图以访问权限禁止的方式访问套接字”（本机错误代码：10013）...

我的代码：

```
 private void ListenPort() {
        WindowsPrincipal pricipal = new WindowsPrincipal(WindowsIdentity.GetCurrent());
        bool hasAdministrativeRight = pricipal.IsInRole(WindowsBuiltInRole.Administrator);
        TcpListener server = null;
        Int32 port = 5060;
        IPAddress localAddr = IPAddress.Parse("192.168.1.33");
        server = new TcpListener(localAddr, port);

        Byte[] bytes = new Byte[1000];
        String data = null;
    while (hasAdministrativeRight == true)
    {
        server.Start();
        int i = 0;
        while (1==1)
        {
            TcpClient client = server.AcceptTcpClient();
            NetworkStream stream = client.GetStream();
            data = null;
            i = stream.Read(bytes, 0, bytes.Length);
            data += System.Text.Encoding.ASCII.GetString(bytes, 0, i);
            label3.Text += data;
            this.Refresh();
            Thread.Sleep(500);

        }
    }
} 
```

你觉得问题出在哪里？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-10T15:37:59.047

您需要在 while 循环**之外**和第一个 AcceptTcpClient 调用之前调用 server.Start() 。还尝试使用 IPAddress.Any 而不是 IPAddress.Parse("192.168.1.33") 作为您的侦听器 ip

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-10T15:31:40.860

Have you checked that no other program is already using port 5060? That's what this error can mean.

See this discussion on the matter: [http://social.msdn.microsoft.com/Forums/en-US/netfxnetcom/thread/d23d471c-002a-4958-829e-eb221c8a4b76/](http://social.msdn.microsoft.com/Forums/en-US/netfxnetcom/thread/d23d471c-002a-4958-829e-eb221c8a4b76/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-10T12:20:47.977

确保任何其他**SIP 服务器**程序未安装为使用相应端口的 Windows 服务。

输入`netstat -an`，它会显示“监听”端口或尝试谷歌搜索端口检查软件。

并检查您的 SIP 服务器配置是否通过 TCP 或 UDP 运行。

# python - Python：在字符串中查找“=”

> ID：10537355
> 
> 赞同：-2
> 
> 时间：2012-05-10T15:28:57.600
> 
> 标签：python

使用python find 函数，我想确定一个字符串是否有“=”符号。它可以找到除“=”之外的任何其他内容。

`string: Math="Fun".`

`if (string.find("=") > -1):`

有任何想法吗？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-05-10T15:30:54.847

You can do this with the `in` operator:

```
>>> "=" in "dog"
False
>>> "=" in "do=g"
True 
```

There is no need to use `str.find()` (or the deprecated `string.find()`) to do this, unless you want to know the index of the character.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-10T15:30:29.283

You can use the `find` method directly on the string:

```
>>> "a = b".find("=")
2 
```

Alternatively (though not as nice a method of doing so), you can use the `find` method on the `str` class:

```
>>> str.find("a = b", "=")
2 
```

As Lattyware suggested, you ought to use the `in` operator over this method, unless you need the index.

# objective-c - 消除 NSString 中垃圾值的出现？

> ID：10537357
> 
> 赞同：0
> 
> 时间：2012-05-10T15:28:59.253
> 
> 标签：objective-c, ios, nsstring

我得到了下面提到的格式的 XML....

```
<META NAME="ColdFusionMXEdition" CONTENT="ColdFusion DevNet Edition - Not for Production Use."> 
<?xml version="1.0" encoding="UTF-8"?>
<ParticipantService>
<Response>
    <FileName>Alzheimers</FileName>
    <playlist>
        <question answer="t" qno="1" tin="113" title="Aide responds" tout="114"/>
        <question answer="t" qno="2" tin="123" title="Receptionist reports problem" tout="126"/>
        <question answer="t" qno="3" tin="127" title="Receptionist objects to restraint" tout="130"/>
............. 
```

我以 NSString 的形式存储上述 XML。现在我只想从

```
<?xml version="1.0"....... 
```

从这里我想解析不包含 META 标签字符的字符串。有人可以在这里发布任何替代方案吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-10T17:20:56.737

你可以尝试这样的事情：

```
NSString *parseString = [xmlString substringWithRange:NSMakeRange([xmlString rangeOfString: @"<?xml"].location, ([xmlString length] - [xmlString rangeOfString: @"<?xml"].location))]; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-10T17:44:12.107

[`NSString`](https://developer.apple.com/library/mac/#documentation/Cocoa/Reference/Foundation/Classes/NSString_Class/Reference/NSString.html)有很多方法可以使用。这是我的解决方案，类似于彼得的解决方案：

```
NSString *newString = [xmlString substringFromIndex:[xmlString rangeOfString:@"<?xml"].location]; 
```

或者如果你已经有一个 NSMutableString：

```
[mutableXMLString deleteCharactersInRange:NSMakeRange(0, [mutableXMLString rangeOfString:@"<?xml"].location)]; 
```

当然，这两种解决方案都无法解决没有`<?xml`.

# java - RESTful Web Service using Netbeans and Java Issue

> ID：10537361
> 
> 赞同：0
> 
> 时间：2012-05-10T15:29:17.630
> 
> 标签：java, web-services, rest, netbeans, parameters

I'm new at Restful webservices and im trying to create a WS server to work with an android app. I'm using Netbeans and i followed this tuturial to get started (http://netbeans.org/kb/docs/websvc/rest.html) . I was able to successfully teste the basic features as explained in the tuturial. But now I am not able to add a new feature to the WS. Say I have a table in my DB called User. With the tuturial I can access the table Users by ID trhough the function

```
@GET
@Path("{id}")
@Produces(
  {
    "application/xml", "application/json"
  })
public User find(@PathParam("id") Integer id)
  {
    return super.find(id);
  } 
```

The problem is if I want to get a User by its name for example. If I create a similar function like

```
@GET
@Path("{name}")
@Produces(
  {
    "application/xml", "application/json"
  })
public User find(@PathParam("name") String name)
  {
    return super.find(name);
  } 
```

The server crashes. So my question is , what's the procedure to be able to get a User by other parameters different of id.

Thank you

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-10T15:44:14.130

这里有一个一小时长的视频，您可以在其中看到一个 Web 服务前端的实现，该前端允许用户插入和访问数据库行。

原理应该是一样的，因为 Web 服务旨在为可互操作的客户端提供服务，不介意它是 android 应用程序还是其他应用程序。在本视频中，您将看到如何使用 2 个参数来形成查询并针对 oracle 数据库触发它。

我认为可以帮助您的东西是实现 CRUD 外观的 EJB。

我希望它有所帮助：[http ://www.youtube.com/watch?v=0_0gGL2C1ys&feature=player_embedded](http://www.youtube.com/watch?v=0_0gGL2C1ys&feature=player_embedded)

# c# - 在 MVC 中将 Viewmodel 和 datepicker 与 Dotnet Highchart 一起使用

> ID：10537364
> 
> 赞同：2
> 
> 时间：2012-05-10T15:29:20.237
> 
> 标签：c#, asp.net-mvc, asp.net-mvc-3, charts, highcharts

我正在使用基于具有输出代码 javascript 的 C# 代码的 Dotnet Highchart。 [点网高图](http://dotnethighcharts.codeplex.com/)

这几乎是我的图表的样子：

![图表](../Images/cfcbe2d346a6344bb2783165a0522e60.png)

我正在使用我的数据库中的数据通过使用 LINQ 查询来提供此图表数据。

我的实体中有一个“完成日期”列，我需要使用 datepicker 创建两个文本框，以便用户可以选择完成日期的开始和结束日期。然后用户应该能够单击提交按钮，然后图表应该更新并显示两个日期之间的统计数据。我有完整的 LINQ 查询

这是我要使用的 LINQ 查询：

```
public List<CoreValueAndAverageGrade> GetAverageGradeForAllCoreValues(DateTime startDate, DateTime endDate)
        {

            return db.CoreValue
                .Where(coreValue => coreValue.CoreValueQuestion
                    .Any(coreValueQuestion => coreValueQuestion.SubjectType.Ignored_Statistic == false))
                .Select(coreValue => new CoreValueAndAverageGrade
                {
                    CoreValue = coreValue,
                    AverageGrade = coreValue.CoreValueQuestion
                        .Where(coreValueQuestion => coreValueQuestion.SubjectType.Ignored_Statistic == false)
                        .Average(coreValueQuestion => coreValueQuestion.SelectedQuestions
                            .Where(selectedQuestion => selectedQuestion.GoalCardQuestionAnswer != null
                                && selectedQuestion.GoalCardQuestionAnswer.Grade.HasValue

                            && selectedQuestion.GoalCard.Completed_Date >= startDate
                            && selectedQuestion.GoalCard.Completed_Date <= endDate
                                )
                            .Average(selectedQuestion => selectedQuestion.GoalCardQuestionAnswer.Grade.Value))
                })
                .ToList();
        } 
```

这是我的视图模型

```
 public class OfficeStatisticNKIViewModel
    {
        public DateTime StartDate { get; set; }
        public DateTime EndDate { get; set; }
    } 
```

在我的 GET 操作方法中，我有以下代码：

```
public ActionResult OfficeStatistic()
{
    {
       OfficeStatisticNKIViewModel model = new OfficeStatisticNKIViewModel();
       model.EndDate = DateTime.Now;
       model.StartDate = DateTime.Now;
        var averageGrades = OfficeStatisticRepository.GetAverageGradeForAllCoreValues(model.StartDate, model.EndDate);

        var dataItems = (averageGrades.Select(averageGrade => averageGrade.AverageGrade).ToArray());
        Data data = new Data(
            dataItems.Select(y => new Point {Color = GetBarColour(y), Y = y}).ToArray());

        Highcharts chart1 = new Highcharts("Chart")
         .SetXAxis(new XAxis { Categories = averageGrades.Select(averageGrade => averageGrade.CoreValue.Name).ToArray() })
         .SetYAxis(new YAxis { Min = 0, Max = 10, TickInterval = 1, Title = new YAxisTitle { Text = "Betygskalan" } })
         .SetSeries(new Series {  Data = data, Name = "Snittbetyg" })
         .SetLegend(new Legend { Enabled = false })
         .SetTitle(new Title { Text = "Örebro Statistik", })
         .InitChart(new Chart { DefaultSeriesType = ChartTypes.Column });

        return View(new Container(new[] { chart1 }));

    } 
```

问题是我不知道如何执行发布操作方法，图表需要使用新的统计信息进行更新，我需要某种 ajax 还是可以在服务器端执行此操作？

非常感谢任何帮助或提示！

提前致谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-31T20:45:13.793

[http://dotnethighcharts.codeplex.com/discussions/350721/](http://dotnethighcharts.codeplex.com/discussions/350721/)

# iphone - iOS：UITableView - 向表格添加列

> ID：10537365
> 
> 赞同：0
> 
> 时间：2012-05-10T15:29:20.907
> 
> 标签：iphone, objective-c, ios, cocoa-touch

我正在寻找更改我的 tableview 的列数而不对其进行子类化。有什么建议么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-10T15:37:17.207

我想你可以在这里找到你的幸福：http: [//usxue.is-programmer.com/posts/14176.html](http://usxue.is-programmer.com/posts/14176.html) 有了它，你可以创建一个网格并拥有多个列

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-10T15:38:02.387

如果您不需要选择单个列，则可以将 UITableViewCell 子类化以使其看起来像具有多个列。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-10T21:13:51.003

在不继承任何子类的情况下执行此操作需要按如下方式完成：

1) 在视图中放置一个 UIScrollView。
2）在 UIScrollView 中嵌入 n 个 UITableView，其中 n 是所需的列数。
3) 在所有 UITableViews 中关闭滚动。
4) 使所有 UITableView 框架等于该 UITableView 的 contentSize。
5) 设置 UIScrollView 的内容大小等于 UITableView 的最大框架。

我没有对此进行测试，因为我肯定会推荐子类化 UITableView 或 UITableViewCell，但这是一种方法。

# c++ - std::unique_ptr ostream 插入器

> ID：10537369
> 
> 赞同：1
> 
> 时间：2012-05-10T15:29:39.900
> 
> 标签：c++, c++11, ostream, unique-ptr

我使用 -std=c++0x 选项在 gcc 4.4.6 中启用了 unique_ptr。它似乎工作得很好，正是我所需要的——一个带有自定义删除器的作用域指针。

但是我确实注意到了一个问题。

```
typedef std::unique_ptr<X> XPtr;

XPtr ptr1(new X);
XPtr ptr2(new X);

std::cout << "ptr1 points to " << ptr1 << std::endl;
std::cout << "ptr2 points to " << ptr2 << std::endl; 
```

显示：ptr1 指向 1 ptr2 指向 1

我认为 ostream 插入器正在插入 bool 值。

以下修复了它，但我想知道这是否不应该成为标准库的一部分。

```
template<typename Target, typename Deleter>
std::ostream & operator <<( std::ostream & out, const std::unique_ptr<Target, Deleter> & value)
{
    // output the raw pointer
    out << value.get();
    return out;
} 
```

所以问题是：这是 gcc 中当前 unique_ptr 实现的限制，还是我对 unique_ptr 的期望过高？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-10T15:53:44.393

这似乎是 gcc 4.4.6 附带的库中的一个错误。转换是

```
explicit operator bool() const noexcept; 
```

并且不应通过尝试将指针插入到 `ostream`. 这应该会导致编译错误，而这正是 gcc 4.7 上发生的情况。

**编辑：** gcc 4.4 不支持显式转换运算符，因此这在当时不起作用。您应该获得更新的 gcc 版本才能真正使用 C++11。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-10T15:41:58.937

已定义，`unique_ptr`因此`operator bool() const`您看到的是 unique_ptr 对象被转换为 bool 值。正如您所发现的，要打印指针的地址，您需要使用该`get()`方法。

# active-directory - How to populate other attributes when using powershell 2.0 new-aduser?

> ID：10537379
> 
> 赞同：2
> 
> 时间：2012-05-10T15:30:06.977
> 
> 标签：active-directory, powershell-2.0

When trying to create users from a file I get an error when -otherAttributes @{} is added to ps script. I am new to powershell and can not get it to work. Any guidance is appreciated. This is My code:

```
Import-Module ActiveDirectory
$OU = 'ou=Staging OU, dc=Domain, dc=net'
$usrfile = "\\servername\testuser.csv"

Import-Csv $usrfile | 
ForEach-Object {
     New-ADUser -SamAccountName $_.samaccountname -UserPrincipalName $_.Userprincipalname -Name $_.Name -DisplayName $_.displayname -GivenName $_.givenname -Surname $_.sn -Initials $_.initials -Title $_.title -OtherName $_.middlename `
-Description $_.description -Department $_.department -EmployeeID $_.employeeid -Path $OU -Country $_.c `
-OtherAttributes @{departmentNumber=$user.departmentnumber;localeID=$user.localid;extensionAttribute1=$user.extensionAttribute1;employeeType=$user.employeetype} `
-AccountPassword (ConvertTo-SecureString "Password" -AsPlainText -Force) -Enabled $true `
-PasswordNeverExpires $false -ChangePasswordAtLogon $true -PassThru 
    } > Import.log 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2014-05-26T14:03:24.093

我的 AD 中的参数“-otherAttributes @{}”失败。我发现其他方式在 AD 中更改此值。

试试这个：

```
PS> Set-ADuser -identity joseiba -Clear 'msRTCSIP-PrimaryUserAddress'
PS> Set-ADuser -identity joseiba -Add @{'msRTCSIP-PrimaryUserAddress'='4213@grupofibratel.com'} 
```

BR

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-08-13T18:08:15.750

您在其他属性的 ldapdisplayname 周围省略了 '

@{departmentNumber=$user.departmentnumber; 应该是：@{'departmentNumber'=$user.departmentnumber;

您需要在其他属性中的每个 ldapdisplayname 周围加上 ' .. 只是自己处理注释字段

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-10T16:20:51.667

在当前循环迭代中访问对象时，请确保您将所有 $ 都设置为 $_...。我看有些不是。

# ios - 如何强制按钮停留在 tableView 单元格的底部？

> ID：10537381
> 
> 赞同：0
> 
> 时间：2012-05-10T15:30:16.290
> 
> 标签：ios, tableview

我将一个按钮作为子视图添加到我的 tableviewcells。工作正常。但我似乎无法弄清楚，如何强制它始终位于单元格的底部。（如果你愿意，在分隔线的顶部）。单元格高度各不相同，因此固定位置并不明智。但我不知道如何用动态位置添加它。添加按钮的代码如下：

```
UIButton *button = [UIButton buttonWithType:UIButtonTypeRoundedRect];
[button addTarget:self
    action:@selector(buttonPressed:)
    forControlEvents:UIControlEventTouchDown];
    [button setTitle:@"+1" forState:UIControlStateNormal];
    button.frame = CGRectMake(0.0f, 70.0f, 160.0f, 15.0f);
    [cell addSubview:button]; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-10T15:41:54.397

您可以随时检查单元格的高度并像这样放置按钮的框架。

```
button.frame=CGRectMake(0,cellHeight-15,160,15); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-10T15:57:38.117

添加按钮时设置自动调整大小的掩码。我认为你想要的设置是：

```
button.autoresizingMask = UIViewAutoResizingFlexibleTopMargin; 
```

在将按钮添加到单元格后执行此操作。

# sql - Run SQL Select query from .sql file using VBA in Excel

> ID：10537382
> 
> 赞同：0
> 
> 时间：2012-05-10T15:30:19.433
> 
> 标签：sql, oracle, vba, excel, excel-2007

To create dynamic select statements I am currently creating a temp file to hold the query (30k + characters due to number of joins and decodes being used). I'd like to use this temp file that has the full select statement to return the data into excel.

Using my current code I can only run a short select statements. The strings I create seem to get truncated for some reason.

Here's the snippet of code I'm using that creates the file and currently attempts to run the same string.

```
' Set file details
fileDir = "C:\temp\"
filePath = "C:\temp\" & node & "_SRO_TCs.sql"

'check if directory exists, if not create it
If Dir(fileDir, cbDirectory) = "" Then
MkDir fileDir
End If

' open the file
Open filePath For Output As #1

'Write to file
outputText = sqlQuery3
Print #1, outputText

'open connection
sqlCon.ConnectionString = Conn
  'Cn.CursorLocation = adUseClient
sqlCon.Open

'set and execute sql command
Set sqlCommand.ActiveConnection = sqlCon
sqlCommand.CommandText = sqlQuery3
sqlCommand.CommandType = adCmdText
sqlCommand.Execute

'open recordset
Set sqlRecordSet.ActiveConnection = sqlCon
sqlRecordSet.Open sqlCommand

'copy data to excel
ActiveSheet.Range("A1").CopyFromRecordset (sqlRecordSet)  <<<< This is where i get an error returned when stepping through the code - "Run-time error '91': Object variable or With block variable not set"

'close connections
sqlRecordSet.Close
sqlCon.Close

'Close file
Close #1 
```

When I check the file created it has a working sql select statement. I'd like to be able to run this file or the string. Please help!

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-12T16:42:13.487

命令执行方法如下所示

```
Set recordset = command.Execute( RecordsAffected, Parameters, Options ) 
```

您的代码完全不同。之前没有仔细查看您的代码，因为您说它可以使用较短的 SQL 语句。

# javascript - 使用 Google Apps 脚本创建“老式”邮件合并的问题

> ID：10537384
> 
> 赞同：3
> 
> 时间：2012-05-10T15:30:27.240
> 
> 标签：javascript, google-apps, google-apps-script

这是我昨天在 Google Apps Script Office Hours Hangout 上提出的一个问题的后续。

我的最终脚本的目标是为我使用 Google 表单工作的高中的学生选举创建一个选举流程。该脚本包含三个部分：1）创建唯一的“投票 ID”（随机 6 位代码）2）将学生数据（姓名、教室和投票 ID）与模板文档合并，该模板文档将为每个人创建特定的投票指令学生。（即老式邮件合并） 3) 通过检查投票 ID 和删除重复投票来验证结果。

我遇到问题的脚本部分是学生数据合并（步骤 2）。第一个数据集是唯一有效的。其余的显示为“DocumentBodySection”。我有一种感觉，要么是我如何从文档模板中复制文本，要么是我如何将文本添加到新文档中。

带数据的电子表格：[https ://docs.google.com/spreadsheet/ccc?key=0AierVcXWELCudFI1LU10RnlIVHNsUm11a0dDWEV6M1E](https://docs.google.com/spreadsheet/ccc?key=0AierVcXWELCudFI1LU10RnlIVHNsUm11a0dDWEV6M1E)

文档模板：（请参阅后续评论的 url）

由脚本创建的文档：[https ://docs.google.com/document/d/12r2D9SpIVmQYVaasMyMWKjHz6q-ZZyIMEBGHTwlQct8/edit](https://docs.google.com/document/d/12r2D9SpIVmQYVaasMyMWKjHz6q-ZZyIMEBGHTwlQct8/edit)

```
//Get Settings & Data
ss = SpreadsheetApp.getActiveSpreadsheet();
source_sheet = ss.getSheetByName("Student Data");
settings_sheet = ss.getSheetByName("SETTINGS");
results_column = settings_sheet.getRange("B19").getValue();
source_column = settings_sheet.getRange("B18").getValue();
source_lastrow = source_sheet.getLastRow();
docTemplateID = settings_sheet.getRange("B13").getValue();
docCopyName = settings_sheet.getRange("B14").getValue();

//Merge Student Data with Document
function SendDataMerge () {
  // Open docTemplate and Copy Contents to entryTemplate
     var docTemplate = DocumentApp.openById(docTemplateID);
     var entryTemplate = docTemplate.getActiveSection();
     docTemplate.saveAndClose();
  // Make a NEW copy of docTemplate
     var docTemplate = DocsList.getFileById(docTemplateID);
     var docCopy = DocsList.copy(docTemplate, docCopyName);
     var docCopyID = docCopy.getId();
  // Create Array of Student Data (First, Last, Grouping, VID)
     var data = source_sheet.getRange("A2:D"+source_lastrow).getValues();
  // Open docCopy for Editing & Clear Contents
     var doc = DocumentApp.openById(docCopyID);
     var docText = doc.editAsText();
  // Run through Student Data
     for(var i=0; i<5 /*data.length*/; i++) { //For testing, limit this to 5 entries 
       var lastName = data[i][0];
       var firstName = data[i][1];
       var grouping = data[i][2];
       var vid = data[i][3];
       docText.replaceText('keyLastName', lastName);
       docText.replaceText('keyFirstName', firstName);
       docText.replaceText('keyGrouping', grouping);
       docText.replaceText('keyVID', vid);
       docText.appendText('\n*** Appended Text (End of entry) ***');
       docText.appendText(entryTemplate);
     }
  // Save and Close 
     doc.saveAndClose();
  } 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-27T16:46:48.023

我通过创建模板副本、进行文本替换然后将原始文档中的模板元素附加到副本中来解决此问题。特别是，我使用了：`var copyTables = templateDoc.getTables();`获取和存储表（因为我的所有模板数据都包含在一个表中）并`copyDoc.appendTable(copyTables[0].copy() );`附加副本（`.copy()`最后似乎可以发挥真正的魔力）。这提供了在友好的文档界面中更新模板的灵活性，而无需看到程序员。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-11T13:55:21.510

我认为问题出在这一行：

```
docText.appendText(entryTemplate); 
```

变量 entryTemplate 包含一个 DocumentBodySection，这就是您在输出中看到它的原因。如果您尝试附加原始模板文本的另一个副本，则需要在进入循环之前存储它。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-14T00:03:18.077

我同意 Eric 的观点，即 appendText(entryTemplate) 不会做你想做的事。

由于您尝试创建一个包含所有学生的大型文档，因此使用“模板”并替换文本效果不佳。相反，我建议使用生成所需格式的 api 调用在代码中创建“模板”。然后，它可以很容易地继续附加新的学生说明页面。虽然我认为当文档变大时你可能会遇到缓慢......我不知道你有多少学生。

# jquery - 我可以通过 jQuery 禁用系统键吗？

> ID：10537386
> 
> 赞同：-3
> 
> 时间：2012-05-10T15:30:30.250
> 
> 标签：jquery, keyboard

我想在我的图像上禁用系统键（例如，Win 键）？是否可以？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-10T15:35:50.717

我会说不。试试这个[http://jsfiddle.net/XBHp7/](http://jsfiddle.net/XBHp7/)

```
​$(document.body)​.keypress(function( e ){
     document.body.innerHTML += e.which + "<br/>";
});​ 
```

如您所见，浏览器中的网页不会将 windows 键识别为按键。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-10T15:36:04.467

```
$(document).keydown(function(e){
    alert(e.keyCode); // replace "37" below with the windows key code
    if (e.keyCode == 37) { 
       alert( "windows key pressed" );
       return false;
    }
}); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-10T15:36:14.680

您可以检测这些击键（取决于浏览器），但不能阻止系统获取它们。

以下是标准键码列表，其中包含获取其他键码的机制：http: [//www.cambiaresearch.com/articles/15/javascript-char-codes-key-codes](http://www.cambiaresearch.com/articles/15/javascript-char-codes-key-codes)

例如在 Chrome/Ubuntu 上，我可以看到用户何时按下 win 键（我的系统上的代码 91），但不会阻止系统映射到它的操作。

# java - Assign a String content to a new String in Java from parameter

> ID：10537390
> 
> 赞同：1
> 
> 时间：2012-05-10T15:30:46.383
> 
> 标签：java, string, netbeans, warnings

Having this method

```
void doSomething(String input)
{
   //trick for create new object instead of reference assignment
   String workStr= "" + input; 

   //work with workStr
} 
```

Which is the java way for doing that?

**Edit**

*   if I use input variable as input=something then Netbeans warns about assigning a value to a method parameter
*   If I create it with new String(input) it warns about using String constructor

Perhaps the solution is not to assign nothing to input, or just ignore the warning..

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-10T15:33:30.673

```
String copy = new String(original); 
```

> Initializes a newly created String object so that it represents the same sequence of characters as the argument; in other words, the newly created string is a copy of the argument string. Unless an explicit copy of original is needed, use of this constructor is unnecessary since Strings are immutable.

[http://docs.oracle.com/javase/6/docs/api/java/lang/String.html#String(java.lang.String](http://docs.oracle.com/javase/6/docs/api/java/lang/String.html#String(java.lang.String))

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-05-10T15:36:17.570

`String`Java 中的 s 是不可变的，这意味着您不能更改对象本身（任何返回字符串（例如子字符串）的操作都将返回一个新的）。

这意味着无需为`String`s 创建新对象，因为您无法修改原始对象。任何这样做的尝试都只会导致内存浪费。

只有当所讨论的对象是可变的时，分配引用才是一个问题，因为一个对象的更改将反映在同一引用的所有其他副本中。

# java - 如何从 java.sql.Timestamp 中检索毫秒

> ID：10537391
> 
> 赞同：25
> 
> 时间：2012-05-10T15:30:47.163
> 
> 标签：java

我有一个时间戳对象，需要从中获取毫秒数，有人可以帮我提供一个示例代码片段吗？

* * *

## 回答 #1

> 赞同：43
> 
> 时间：2012-05-10T15:32:46.103

您可以使用[Timestamp.getTime()](http://docs.oracle.com/javase/7/docs/api/java/sql/Timestamp.html#getTime%28%29)

> 返回自 1970 年 1 月 1 日 00:00:00 GMT 以来由此 Timestamp 对象表示的毫秒数。

例子：

```
long timeInMilliSeconds = t.getTime();
// do magic trick here 
```

注意：[时间戳](http://docs.oracle.com/javase/7/docs/api/java/sql/Timestamp.html)从[Date](http://docs.oracle.com/javase/7/docs/api/java/util/Date.html)扩展。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-05-10T15:32:50.050

自 Unix 纪元以来，您可以调用[`getTime()`](http://docs.oracle.com/javase/7/docs/api/java/security/Timestamp.html#getTime%28%29)以获取毫秒数。那是你所追求的，还是你想要“一秒钟内的毫秒”或类似的东西？

请注意，*仅*使用毫秒对于 a 来说有点奇怪`Timestamp`，因为它是专门设计为精确到纳秒的。因此，您通常应该`getTime()`与`getNanos()`.

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-05-10T15:33:36.523

来自 Java 文档（[链接](http://docs.oracle.com/javase/6/docs/api/java/sql/Timestamp.html#getTime%28%29)）：

> 公共长 getTime()
> 
> 返回自 1970 年 1 月 1 日 00:00:00 GMT 以来由此 Timestamp 对象表示的毫秒数。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-05-10T15:36:58.023

我想这会给出你想要的输出。

```
public void timeInMills(Timestamp t){
    System.out.println("Time in Milli second "+t.getTime());

} 
```

# java - JTextPane：识别字符串

> ID：10537394
> 
> 赞同：0
> 
> 时间：2012-05-10T15:30:56.117
> 
> 标签：java, regex

我正在尝试使用以下代码在我的 JTextPane 中识别字符串（这意味着双引号内的文本）

```
Pattern string= Pattern.compile("\"/\"/.*");
Matcher matcher = string.matcher(content);

while (matcher.find()) {
    document.setCharacterAttributes(matcher.start(), matcher.end() - matcher.start(), textPane.getStyle("red"), true);
} 
```

但是上面的代码没有正确识别字符串。我认为我给出的模式是错误的。请帮助我纠正模式。

谢谢大家！我真的很感谢你的帮助！由于你们所有的答案都是正确的，我很难选择最佳答案，所以我给了你们每个人的一票。希望你不介意:)

再次感谢大家！我真的很感激:)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-10T15:45:35.797

正确的表达是这样的：

```
Pattern.compile("\"[^\"]*\""); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-10T15:46:13.337

```
 String s = "jsdfjh shfslfh \"ksfsdkflsdaf\" 2346237846 ufhusdhfu usfhsdfis \"sadhgbshad78hgshd\" jhsdjs";
        Pattern p = Pattern.compile("\"{1}[.[^\"]]*\"{1}");
        Matcher m = p.matcher(s);
        while(m.find()){
            System.out.println(s.substring(m.start(), m.end()));
        } 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-10T15:54:40.520

我建议您使用的正则表达式是`"[^"]*"`. 引用和转义，就是`"\"[^\"]*\""`.

所以试试

```
Pattern string= Pattern.compile("\"[^\"]*\""); 
```

但请注意，这将无法正确找到包含双引号的字符串，因此我希望您`JTextPane`不包含 Java。

# javascript - How to show/hide content on click

> ID：10537396
> 
> 赞同：1
> 
> 时间：2012-05-10T15:31:06.750
> 
> 标签：javascript, jquery, html, toggle, slidetoggle

I am trying to find a solution to open one `div` by clicking a link, and close/toggle all other open `div`s at the same time.

This is my code: [http://jsfiddle.net/6Ptkw/1/](http://jsfiddle.net/6Ptkw/1/)

I thought this was the right way, but it doesn't work.

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-11T00:39:13.883

您可以尝试此代码（只需将其应用于您的元素）此“幻灯片打开”一个 div 元素：

```
$('#workload').click(function(){
        $('#work').load('pagehere.jsp');
        $('#work').animate({
        height: '25%',
        fontSize: "3em",
        borderWidth: "10px"
    }, 1000 );   }); 
```

只需使用 .hide() 函数隐藏其他元素。：） 希望这个对你有帮助！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-11T00:35:00.540

您很接近，但请注意，jsfiddle 默认情况下将所有内容包装在 onDomReady 函数闭包中，这意味着您的 slideonlyone 函数不再可见。

[http://jsfiddle.net/6Ptkw/5/](http://jsfiddle.net/6Ptkw/5/)

你发布的 jsFiddle 会有这样的代码

```
$(function(){
    function slideonlyone(){
        //your code   
    };

}); 
```

一个该`onDomReady`函数退出，您将不再有任何引用该`slideonlyone`函数的范围

我将其更改为 nowrapper，以便它可以在全局范围内使用。这通常是不好的做法，您应该通过以下方式附加点击事件

```
$("a").click(function(){

}) 
```

而不是做`<a href="javascript:">`

# performance - 网络面板中谷歌浏览器时间线中的时间是什么意思？

> ID：10537399
> 
> 赞同：83
> 
> 时间：2012-05-10T15:31:24.543
> 
> 标签：performance, google-chrome

通常在使用 Google Chrome 的网络面板对性能进行故障排除时，我会看到不同的时间，并且经常想知道它们的含义。

有人可以验证我是否正确理解这些：

1.  Blocking：被浏览器多次请求同域限制的时间（？？？）
2.  等待：等待来自服务器的连接（？？？）
3.  发送：将文件从服务器传输到浏览器所花费的时间（？？？）
4.  接收：浏览器分析和解码文件所花费的时间（？？？）
5.  DNS 查找：解析主机名所花费的时间。
6.  连接：建立套接字连接所花费的时间。

现在有人将如何解决较长的阻塞时间？

现在有人将如何解决漫长的等待时间？

* * *

## 回答 #1

> 赞同：93
> 
> 时间：2012-10-04T18:13:59.040

发送是将数据/请求上传到服务器所花费的时间。它发生在阻塞和等待之间。例如，如果我回发一个 ASPX 页面，这将表明将请求（包括表单的值和会话状态）上传回 ASP 服务器所花费的时间。

等待是在发送请求之后，但在收到来自服务器的响应之前的时间。基本上这是等待服务器响应所花费的时间。

接收是从服务器下载响应所花费的时间。

[阻塞](https://groups.google.com/forum/?fromgroups=#!topic/speedtracer/MlF_gTvMRD8)是 UI 线程开始请求和 HTTP GET 请求进入网络之间的时间量。

这些发生的顺序是：

1.  阻塞*
2.  DNS 查询
3.  连接
4.  发送
5.  等待
6.  接收

*阻止和 DNS 查找可能会被交换。

网络选项卡不指示处理所花费的时间。

如果您的阻塞时间很长，则运行浏览器的机器运行缓慢。您可以通过升级机器（更多 RAM、更快的处理器等）或减少其工作量（关闭不需要的服务、关闭程序等）来解决此问题。

较长的等待时间表明您的服务器需要很长时间才能响应请求。这要么意味着：

*   该请求需要很长时间来处理（例如，如果您从数据库中提取大量数据，需要对大量数据进行排序，或者必须在需要启动的 HDD 上找到文件）。
*   您的服务器接收到太多请求，无法在合理的时间内处理所有请求（处理请求可能需要 0.02 秒，但是当您有 1000 个请求时，会有明显的延迟）。

这两个问题（长时间等待+长时间阻塞）是相关的。如果您可以通过缓存、添加新服务器和减少活动页面所需的工作来减少服务器上的工作量，那么您应该会看到这两个方面的改进。

* * *

## 回答 #2

> 赞同：25
> 
> 时间：2014-03-15T06:55:35.153

您可以在此处阅读 google 团队的详细[官方说明](https://developers.google.com/chrome-developer-tools/docs/network#about_the_resource_timing_api)。这是一个非常有用的资源，您的信息位于**时间轴视图**部分。

[资源网络计时](https://developers.google.com/chrome-developer-tools/docs/network#resource_network_timing)显示的信息与时间线视图中的资源栏中的信息相同。回答你的问题：

*   **DNS 查找**：执行 DNS 查找所花费的时间。（您需要找出site.com的IP地址，这需要时间）
*   **阻塞**：请求花费的时间等待已建立的连接变为可重用。正如在另一个答案中所说，它不依赖于您的服务器 - 这是客户端的问题。
*   **连接**：建立连接所花费的时间，包括 TCP 握手/重试、DNS 查找以及连接到代理或协商安全套接字层 (SSL) 的时间。取决于网络拥塞情况。
*   **发送**- 发送请求所花费的时间。取决于发送数据的大小（通常很小，因为您的请求几乎总是几个字节，除非您提交大图像或大量文本）、网络拥塞、客户端与服务器的接近程度
*   **等待**- 等待初始响应所花费的时间。这主要是您的服务器处理和响应您的响应的时间。如果您的服务器计算事物，从数据库中获取记录等等，这就是多快。
*   **接收**- 接收响应数据所花费的时间。类似于发送的东西，但现在您从服务器获取数据（响应大小大多大于请求）。所以它还取决于大小、连接质量等。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2015-06-30T11:17:29.587

> **阻塞**：请求花费的时间等待已建立的连接变为可重用。*正如在另一个答案中所说，它不依赖于您的服务器 - 这是客户端的问题*。

我不同意上面的说法。其他一切都相同 [我的机器工作量] - 我的浏览器显示一个网站的“阻塞”时间非常少，而其他网站的阻塞时间很长。

因此，如果等待六个线程之一+代理协商**高，则主要是由于服务器速度慢的级联效应或页面设计不良[通过网络发送过多，次数过多]。

** - 无论“代理协商”是什么意思！，没有人能很好地解释这一点，尤其是在实际不涉及本地/CDN 代理的情况下

# ruby-on-rails - 遍历活动记录结果 - ruby on rails

> ID：10537407
> 
> 赞同：10
> 
> 时间：2012-05-10T15:31:50.827
> 
> 标签：ruby-on-rails

我一直在尝试找到这个答案，也许它太简单了......

在 Rails 中，遍历 activerecord 的结果的最佳方法是如何拉取您想要的特定字段？

我有一个用于提取所有记录的评论（命名帖子）控制器：

```
def index
@posts = Post.find(:all)
end 
```

然后在索引视图中，当我使用 <%= @posts %> 时，我得到了所有数据......这很棒......

```
#<Post id: 1, user_id: "9", picture: nil, comments: "here's a first comment", title: nil, twitter: nl, frame: nil, created_at: "2012-05-09 04:21:16", updated_at: "2012-05-09 04:21:16"> #<Post id: 2, user_id: "9", picture: nil, comments: "here's a second comment", title: nil, twitter: "please", frame: nil, created_at: "2012-05-09 05:20:03", updated_at: "2012-05-09 05:20:03"> 
```

我现在如何遍历测试，以便视图显示来自评论和 created_at 字段的数据：

这是第一条评论，2012-05-09 04:21:16

这是第二条评论，2012-05-09 05:20:03

我已经尝试了以下并得到一个错误。

```
<% @posts.each do |c| %>
   <%= c.posts.comments %>
   <%= c.posts.created_at %>
<% end %> 
```

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2012-05-10T15:35:13.557

中的“c”表示集合`@posts.each do |c|`中的特定帖子对象。`@posts`

所以，从某种意义上说，你正在尝试做`<%= post.posts.comments %>`.

以下是代码的外观：

```
<% @posts.each do |p| %>
   <%= p.comments %>
   <%= p.created_at %>
<% end %> 
```

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2012-05-10T15:37:32.577

把事情改成这样：

```
<% @posts.each do |post| %>
   <%= post.comments %>
   <%= post.created_at %>
<% end %> 
```

我发现如果您将内部变量命名为 out 变量的单数形式，人们会更容易理解——因此`@posts`外部变为`post`内部。

祝你好运！

# jquery - Mobiscroll 1.6 禁用回调的输入字段

> ID：10537411
> 
> 赞同：0
> 
> 时间：2012-05-10T15:32:12.793
> 
> 标签：jquery, jqueryform, mobiscroll

我正在使用**mobiscroll 1.6** (https://github.com/acidb/mobiscroll) 以简单的 html 表单输入日期，我用**jQuery Form** (和[http://jquery.malsup.com/form/](http://jquery.malsup.com/form/) ) ajaxify

我希望在对日期字段进行更改时发布表单。我从 mobiscroll api都试过`onSelect`了：`onClose`

[http://docs.mobiscroll.com/](http://docs.mobiscroll.com/)

但问题是 mobiscroll 似乎将所有输入字段设置`disabled`为包含表单，直到它完全完成。当输入字段被禁用时，jQuery 表单不会对其进行序列化：

[http://jquery.malsup.com/form/#faq](http://jquery.malsup.com/form/#faq) http://www.w3.org/TR/html401/interact/forms.html#h-17.13.2

在输入字段本身上添加事件处理程序不是一个选项，因为它从一开始就使用 JS 进行初始化，因此我在页面加载时获得了触发器。我真的需要从日期选择器触发 ajax 帖子。

任何提示都非常感谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-11T07:19:59.890

你用的是什么版本？从 2.0rc1 开始，这对于 onSelect 和 onCancel 事件是固定的。onClose 弹出窗口尚未隐藏，因此如果您的函数返回 false，将阻止关闭。对于您的用例，我推荐 2.0rc3 和 onSelect 事件。在此处查看此问题的更多详细信息： [https ://groups.google.com/forum/?fromgroups&hl=en#!topic/mobiscroll/fQQ-jYkH-qk](https://groups.google.com/forum/?fromgroups&hl=en#!topic/mobiscroll/fQQ-jYkH-qk)

# c# - 如何将 DependencyProperty 指定为资源

> ID：10537412
> 
> 赞同：0
> 
> 时间：2012-05-10T15:32:17.023
> 
> 标签：c#, wpf

我想在 WPF 中以编程方式创建按钮，该按钮在 何时增长到特定大小`IsMouseOver == true`，并在 何时缩小到其原始大小`IsMouseOver == false`。

为了实现这种行为，我派生了`Button`该类，并添加了一个`DependencyProperty`：

```
public class ScalableButton : Button
{
    public Storyboard MouseOutAnimation
    {
        get { return (Storyboard)GetValue(MouseOutAnimationProperty); }
        set { SetValue(MouseOutAnimationProperty, value); }
    }

    // Using a DependencyProperty as the backing store for MouseOutAnimation.  This enables animation, styling, binding, etc...
    public static readonly DependencyProperty MouseOutAnimationProperty =
        DependencyProperty.Register("MouseOutAnimation", typeof(Storyboard), typeof(ScalableButton), new UIPropertyMetadata(null));

    public ScalableButton(double originalScale, Style style)
        : base()
    {
        CreateMouseOutAnimation(originalScale);
        RenderTransform = new ScaleTransform(originalScale, 1, 0.5, 0.5);
        RenderTransformOrigin = new Point(0.5, 0.5);
        Style = style;
        ApplyTemplate();
    }

    private void CreateMouseOutAnimation(double originalScale)
    {
        DoubleAnimation animX = new DoubleAnimation();
        animX.To = originalScale;
        animX.Duration = TimeSpan.FromMilliseconds(200);
        DoubleAnimation animY = new DoubleAnimation();
        animY.To = 1;
        animY.Duration = TimeSpan.FromMilliseconds(200);
        Storyboard sb = new Storyboard();
        sb.Children.Add(animX);
        sb.Children.Add(animY);
        Storyboard.SetTarget(sb, this.RenderTransform);
        Storyboard.SetTargetProperty(animX, new PropertyPath(ScaleTransform.ScaleXProperty));
        Storyboard.SetTargetProperty(animY, new PropertyPath(ScaleTransform.ScaleYProperty));
        MouseOutAnimation = sb;
    }
} 
```

然后，我创建了一个`Style`用 a`ControlTemplate`为我的按钮制作自定义外观，并添加了一个`Storyboard`资源来放大它们，另一个来缩小它们，这就是问题所在：

```
<Style TargetType="{x:Type rgw:ScalableButton}" x:Key="EllipseWithText" >
    <Setter Property="Template">
        <Setter.Value>
            <ControlTemplate TargetType="{x:Type rgw:ScalableButton}">
                <ControlTemplate.Resources>
                    <Storyboard x:Key="MouseOverAnimation">
                        <DoubleAnimation Storyboard.TargetName="ButtonGrid" Storyboard.TargetProperty="RenderTransform.ScaleX" To="1.2" Duration="0:0:1" />
                        <DoubleAnimation Storyboard.TargetName="ButtonGrid" Storyboard.TargetProperty="RenderTransform.ScaleY" To="1.2" Duration="0:0:1" />
                    </Storyboard>
                    <Storyboard x:Key="MouseOutAnimation">
                        <!-- This would be the one which scales down -->
                    </Storyboard>
                </ControlTemplate.Resources>
                <Grid x:Name="ButtonGrid" RenderTransform="{TemplateBinding RenderTransform}" RenderTransformOrigin="0.5, 0.5">
                    <Ellipse x:Name="ButtonEllipse" Height="50" Width="150" Fill="#00000000" StrokeThickness="1" Stroke="Black" />
                    <TextBlock x:Name="ButtonText" Width="150" TextAlignment="Center" HorizontalAlignment="Center" VerticalAlignment="Center" TextWrapping="Wrap"/>
                </Grid>
                <ControlTemplate.Triggers>
                    <Trigger Property="IsMouseOver" Value="True">
                        <Trigger.EnterActions>
                            <BeginStoryboard Storyboard="{StaticResource MouseOverAnimation}" />
                        </Trigger.EnterActions>
                        <Trigger.ExitActions>
                            <BeginStoryboard Storyboard="{StaticResource MouseOutAnimation}" />
                        </Trigger.ExitActions>
                    </Trigger>
                </ControlTemplate.Triggers>
            </ControlTemplate>
        </Setter.Value>
    </Setter>
</Style> 
```

那么，如何将 指定`ScalableButton.MouseOutAnimation`为资源？

或者有没有其他方法可以实现可扩展按钮？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-10T15:57:24.840

不需要派生按钮。

不要`To`在 ExitActions 动画中设置属性。这将自动从当前属性值动画回原始属性值。请注意，在下面的示例中，我最初设置了`ScaleX = 0.5`.

```
<Style TargetType="Button">
    <Setter Property="Template">
        <Setter.Value>
            <ControlTemplate TargetType="Button">
                <Grid RenderTransformOrigin="0.5, 0.5">
                    <Grid.RenderTransform>
                        <ScaleTransform x:Name="scale" ScaleX="0.5"/>
                    </Grid.RenderTransform>
                    <Ellipse Height="50" Width="150" Fill="Transparent" StrokeThickness="1" Stroke="Black" />
                    <TextBlock Width="150" HorizontalAlignment="Center" VerticalAlignment="Center"
                               TextAlignment="Center" TextWrapping="Wrap" Text="{TemplateBinding Content}"/>
                </Grid>
                <ControlTemplate.Triggers>
                    <Trigger Property="IsMouseOver" Value="True">
                        <Trigger.EnterActions>
                            <BeginStoryboard>
                                <Storyboard>
                                    <DoubleAnimation
                                        Storyboard.TargetName="scale"
                                        Storyboard.TargetProperty="ScaleX"
                                        To="1.2" Duration="0:0:0.3"/>
                                    <DoubleAnimation Storyboard.TargetName="scale"
                                        Storyboard.TargetProperty="ScaleY"
                                        To="1.2" Duration="0:0:0.3"/>
                                </Storyboard>
                            </BeginStoryboard>
                        </Trigger.EnterActions>
                        <Trigger.ExitActions>
                            <BeginStoryboard>
                                <Storyboard>
                                    <DoubleAnimation
                                        Storyboard.TargetName="scale"
                                        Storyboard.TargetProperty="ScaleX"
                                        Duration="0:0:0.2"/>
                                    <DoubleAnimation
                                        Storyboard.TargetName="scale"
                                        Storyboard.TargetProperty="ScaleY"
                                        Duration="0:0:0.2"/>
                                </Storyboard>
                            </BeginStoryboard>
                        </Trigger.ExitActions>
                    </Trigger>
                </ControlTemplate.Triggers>
            </ControlTemplate>
        </Setter.Value>
    </Setter>
</Style> 
```

编辑：虽然`MinWidth`肯定不是比例因子：你可以像下面这样绑定。

```
<ScaleTransform ScaleX="{Binding MinWidth,
    RelativeSource={RelativeSource Mode=TemplatedParent}}"/> 
```

# sql - 如何从 Oracle 数据库中删除重复的行？

> ID：10537413
> 
> 赞同：7
> 
> 时间：2012-05-10T15:32:24.777
> 
> 标签：sql, oracle

我们有一个表，其中两次意外插入了相同的数据，这意味着大多数（但不是全部）行在表中出现了两次。简单地说，我想要一条 SQL 语句来删除一行的一个版本，同时保留另一个版本；我不介意删除哪个版本，因为它们是相同的。

表结构类似于：

> FID、unique_ID、COL3、COL4....

`Unique_ID`是主键，意味着每个键只出现一次。 `FID`是每个功能唯一的键，因此如果它出现多次，则应删除重复项。

要选择具有重复项的功能，请执行以下操作：

`select count(*) from TABLE GROUP by FID`

不幸的是，我不知道如何从该语句转到 SQL 删除语句，该语句将删除无关的行，每行只留下一个。

之前已经问过这类问题，我已经尝试过使用 distinct 来创建表，但是如何在不命名的情况下获取所有列？这只获取单列 FID 并逐项列出要保留的所有列给出：`ORA-00936: missing expression`

`CREATE TABLE secondtable NOLOGGING as select distinct FID from TABLE`

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-05-10T15:38:24.443

如果您不在乎保留哪一行

```
DELETE FROM your_table_name a
 WHERE EXISTS( SELECT 1
                 FROM your_table_name b
                WHERE a.fid = b.fid
                  AND a.unique_id < b.unique_id ) 
```

完成后，您需要向表中添加一个约束，以确保它`FID`是唯一的。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-05-10T15:38:57.220

试试这个

```
DELETE FROM table_name A WHERE ROWID > (
SELECT min(rowid) FROM table_name B
WHERE A.FID = B.FID) 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-10T15:38:21.487

一条建议

```
DELETE FROM x WHERE ROWID IN
(WITH y AS (SELECT xCOL, MIN(ROWID) FROM x GROUP BY xCOL HAVING COUNT(xCOL) > 1)
SELCT a.ROWID FROM x, y WHERE x.XCOL=y.XCOL and x.ROWIDy.ROWID) 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-10T19:14:29.210

试试这个。

```
DELETE FROM firsttable WHERE unique_ID NOT IN 
(SELECT MAX(unique_ID) FROM firsttable GROUP BY FID) 
```

**编辑：** 一种解释：

```
SELECT MAX(unique_ID) FROM firsttable GROUP BY FID; 
```

此 sql 语句将从每个重复行组中选择每个最大 unique_ID 行。并且 delete 语句将保留这些最大的 unique_ID 行并删除每个重复组的其他行。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2017-11-21T07:21:00.613

你可以试试这个。

```
delete from tablename a
where a.logid, a.pointid, a.routeid) in (select logid, pointid, routeid from tablename 
group by logid, pointid, routeid having count(*) > 1)
and rowid not in (select min(rowid) from tablename
group by logid, pointid, routeid having count(*) > 1) 
```

# php - 表单选择框的值错误

> ID：10537421
> 
> 赞同：0
> 
> 时间：2012-05-10T15:32:44.423
> 
> 标签：php, javascript, html, web

在那里

我的网站上有一些选择框，例如：

```
<div class="registrationdate">
   <select class="filter registrationdate" name="rdat" id="regdate">
      <option value="">---</option>
      <option value="2012">at 2012</option>
      <option value="2011">at 2011</option>
      <option value="2010">at 2010</option>
   </select>
</div> 
```

现在我在提交表单后遇到了一个问题......如果在提交后选择了“at 2011”，我只会得到“2011”这个值，但我想要文本。刷新选择框后将文本更改为“at 2011”

在源代码中我可以看到问题，但我不知道如何解决它。提交表单后，我登陆同一页面，上面的选择框的来源改变如下：

```
<div class="registrationdate">
   <select class="filter registrationdate" name="rdat" id="regdate">
      <option value="2012">2012</option>
      <option value="">---</option>
      <option value="2012">at 2012</option>
      <option value="2011">at 2011</option>
      <option value="2010">at 2010</option>
   </select>
</div> 
```

那么这里可以帮助我吗？我希望我表达的意思是可以理解的。谢谢你的帮助！

> > > > 编辑

好的，我想我在同事的代码中找到了问题......但我遇到了另一个问题，与他想要解决的问题相同。这是实际的代码：

```
<form action='<?php echo $_SERVER['PHP_SELF']; ?>' name='filterform' method='get' class="filterform">
  <div class='registrationdate'>
    <strong><?php echo $GLOBALS['Lng']['filter_Erstzulassung']; ?>:</strong>
    <select id="regdate" name="rdat" class="filter registrationdate">
      <?php if (isset($_GET['rdat'])&&$_GET['rdat']!='') echo '<option value="'.$_GET['rdat'].'">'.$_GET['rdat'].'</option>'; ?>
      <option value="">---</option>
      <?php for ($i = date(Y); $i >= (date(Y)-7); $i-- ) {
          echo '<option value="'.$i.'">ab '.$i.'</option>';
      }?>
    </select>
  </div>
  <input type="submit" value="<?php echo $GLOBALS['Lng']['apply']; ?>" name="submit" id="submit" class="field">
</form> 
```

问题是他希望在提交表单后再次显示输入的选项。在正常情况下，如果您发送表单，您将获得默认值。他试图用 php 部分“isset then echo”覆盖它。AFAIK PHP您无法获取选择字段的文本部分，或者？他还有什么办法解决这个问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-10T15:35:28.427

If you wish to get "at 2011" you should set value of the option to

```
<option value="at 2011">at 2011</option> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-10T16:32:37.913

据我了解，您想保留`value`属性，但要获取`option`标签内的文本。

`$("#regdate option[value='2011']").text()`将返回“在 2011 年”

[http://jsfiddle.net/BtNNT/5/](http://jsfiddle.net/BtNNT/5/)

# jquery - 使用 jquery 将不同的 div 加载到弹出 div 中

> ID：10537423
> 
> 赞同：0
> 
> 时间：2012-05-10T15:32:46.997
> 
> 标签：jquery, popup, replacewith

我有一个弹出 div，我需要使用自定义 id 加载一堆不同的 div。

例如，假设我们有 recipepopup1 recipepopup2 和 recipepopup3，每个都有一个 recipebutton1，recipebutton2 recipebutton3，然后我们有另一个 div 将 recipepopup1..recipepopup3 加载到名为 recipe_popup 中。

我怎么能拥有它，所以当我单击 button1 时，它将 div1 加载到 popupdiv 中，如果我单击 button2，它将 div2 加载到 recipe_display 等。

现在我正在使用replaceWith（），我发现当我点击button1时它用recipepopup1替换recipe_pop div的id，所以当我点击recipepopup2时，它只是将div加载到recipe_popup div之外

还有一点需要注意的是，每个 recipepopup 都应该能够被无限加载多次 - 所以当我关闭弹出窗口并单击一个已经被点击的 recipebutton 时，它仍然会弹出相关的 div

感谢您的帮助:) 凯蒂这是我当前的代码：

```
<script type="text/javascript">
$(document).ready(function(){
    $("#recipebutton1").click(function(){
        $('#create_form_span').css('display', 'none');
        $(".recipepopup").css('display','none');
        $("#recipe_display").replaceWith($('#recipepopup1').css('display','block'));
    });
    $("#recipebutton2").click(function(){
        $('#create_form_span').css('display', 'none');
        $(".recipepopup").css('display','none');
        $("#recipe_display").replaceWith($('#recipepopup2').css('display','block'));
    });
    $("#recipebutton3").click(function(){
        $('#create_form_span').css('display', 'none');
        $(".recipepopup").css('display','none');
        $("#recipe_display").replaceWith($('#recipepopup3').css('display','block'));
    });

});
</script> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-10T15:37:46.007

我认为您可以使用 $("#recipe_display").html($('#recipepopup2').html())

希望能帮助到你。

# image - 使用 Tri-State TreeView 控件隐藏复选框

> ID：10537429
> 
> 赞同：-1
> 
> 时间：2012-05-10T15:32:56.053
> 
> 标签：image, c#-4.0, treeview, tri-state-logic

我有一个正在处理的项目，其中有一个 TreeView 控件。对于 1 级以下的所有内容，这些节点都被用作书签功能，因此我们需要一个 Tri-State CheckBox。[我在这里](http://www.codeproject.com/Articles/6549/Tri-State-TreeView-Control)找到了我正在使用的控件。

但是，由于 TreeView 中的前两个级别不需要添加书签，因此客户希望那里有一个 Image。我发现[这个页面](https://stackoverflow.com/questions/4826556/treeview-remove-checkbox-by-some-nodes)谁的响应让 CheckBoxes 在特定节点上消失。不幸的是，API 调用与上述 Tri-State TreeView 中使用的调用发生冲突，它们不能同时工作。

基本上，我正在寻找的是如何在顶部两个级别的节点中获取图像，以及在较低级别的三态复选框。如有必要，我非常愿意尝试另一个 Tri-State CheckBox。

此外，当用户单击顶部两个级别的图像时，图像不应更改。我发现[这个页面](http://social.msdn.microsoft.com/forums/en-us/winforms/thread/5F122C49-F83C-4413-B68F-2237F809DCEF)确实可以防止图像发生变化，但从控件中删除了 PlusMinus、Lines 和 RootLines。

提前抱歉，这是一个如此荒谬和具体的要求。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-16T14:21:26.200

好的，我终于弄明白了。使用[Tri-State Treeview Control](http://www.codeproject.com/Articles/6549/Tri-State-TreeView-Control)，我仍然可以访问 Treeview 上的 AfterClick 事件。

我在 ImageList 中添加了一系列 Checkbox 图标，并在确定了我的底层对象所在的 CheckState（3 个）之后。然后我设置了 ImageIndex、SelectedImageIndex 和 StateImageIndex（可能不需要最后一个，但我正在彻底）到 ImageList 的正确索引。

我暂时不会发布任何代码，但是如果您尝试做同样的事情，请告诉我，我会上传直到清楚为止。

# node.js - 嵌入文档未保存到其集合中

> ID：10537430
> 
> 赞同：1
> 
> 时间：2012-05-10T15:33:06.087
> 
> 标签：node.js, mongodb, mongoose

似乎我的嵌入文档没有保存到它们各自的集合中。这是我的模型：

```
var County = new Schema({
_id                 : Schema.ObjectId,
name                : String,
biggestCity         : String
});

var Country = new Schema({
_id                 : Schema.ObjectId,
name                : String,
counties                : {type: [County], ref: "County"}
});

var Continent = new Schema({
_id       : Schema.ObjectId,
countries : {type: [Country], ref: "Country"},
}); 
```

...这是我用来将它们保存到 MongoDB 的代码：

```
var continentModel = mongoose.model("Continent");
var continent = new continentModel();

country.name = name;

var countryModel = mongoose.model("Country");
var countyModel = mongoose.model("County");
for (var i = 0; i < req.body.countries.length; i++) {
    var country = new countryModel();
    country.name = req.body.countries[i].name;

    for (var j = 0; j < req.body.countries[i].counties.length; j++) {
        var county = new countyModel();
        county.name = req.body.countries[i].counties[j].name;
        county.biggestCity = req.body.countries[i].counties[j].biggestCity;
        countries.counties.push(county);
    }
    continent.countries.push(country;
}
continent.save(); 
```

如果我执行 db.continents.find()，则会返回一个包含所有属性（包括国家和县）的文档。

但是，如果我执行 db.counties.find() 或 db.countries.find()，则不会返回任何内容。因此，似乎 County 和 Country 文档没有被保存到数据库中各自的集合中，而是作为常规属性保存到 Continent 集合中（而不是嵌入文档）。

我究竟做错了什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-10T16:43:53.663

这可能太简单了，但您只调用了continent.save() 而不会在for 循环结束时调用county.save() 或country.save()。这只是一个遗漏还是可以解决问题。如果是遗漏，请参阅我关于发布输出的说明。

# php - php readFile() and mobile safari

> ID：10537437
> 
> 赞同：1
> 
> 时间：2012-05-10T15:33:36.757
> 
> 标签：php, html, ios, avassetexportsession

I am working on app that among other things is using the AVAssetExporter to combine video and audio file into new video. Exported video: plays fine in a web view inside the application. when it is saved using UIIMagePickerController it plays fine from the Camera app. when I am uploading video to a server it plays fine in a desktop version of Safari and Firefox.

But when I am trying to access the video from the mobile safari, I am getting the Movie Couldn't be Played Tip from the debug console.

```
AVAssetExportSession *exporter =[[AVAssetExportSession alloc] initWithAsset:mixComposition presetName:AVAssetExportPresetPassthrough];
        exporter.outputFileType=AVFileTypeQuickTimeMovie; 
```

My question is what kind of export settings should I use in order to create a video that will work on mobile devices? thank you

Edit 1. It appears that it might be connected with the way how how my server side is set up. I found out the following: [http://mobiforge.com/developing/story/content-delivery-mobile-devices](http://mobiforge.com/developing/story/content-delivery-mobile-devices)

I will keep this post updated.

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-27T19:52:25.180

看来它可能与我的服务器端的设置方式有关。我发现了以下内容：http: [//mobiforge.com/developing/story/content-delivery-mobile-devices](http://mobiforge.com/developing/story/content-delivery-mobile-devices)

# gcc - How can I specify an include file from the GCC Command Line?

> ID：10537450
> 
> 赞同：1
> 
> 时间：2012-05-10T15:34:28.037
> 
> 标签：gcc, macros, include

Using GCC under Windows, I would like to be able to specify on the gcc command line (or from a manually managed makefile) the name of a specific include file to be included in the file being compiled. As I see it, ideally the source code file would contain a line something like…</p>

```
#include INCLUDEFILENAME 
```

…then a filename specified on the gcc command line would be substituted for the `INCLUDEFILENAME` text.

It seems I can get close to achieving this by defining a macro called INCLUDEFILENAME on the gcc command line using the `-D` option (eg. `-D INCLUDEFILENAME="C:\TestLib\Test1.h"`) but when the filename text gets substituted into the `#include` statement it is not enclosed in double quotes, and without these it is not recognized as a file to be included. Of course…</p>

```
#include "INCLUDEFILENAME" 
```

…doesn’t work as INCLUDEFILENAME then becomes a string literal and does not get replaced by the macro value. I have tried other ways of specifying the double quotes (`\x22`, `\"`, `"\""`, etc) but these don’t seem to work on the `#include` line.

I am aware of the gcc `-include` option which it seems can force a file to be included without it being mentioned in any way in the source file, but I would prefer that the source file indicates that an include file is to be included here but that it’s name is specified “externally” to the source file (ultimately, from the makefile).

Any suggestions on how I can achieve this would be appreciated.

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-10T17:17:02.197

您必须包含双引号`"`作为定义的一部分（或`<>`，视情况而定）：

```
% cat test.c

#include <stdio.h>
#include OTHERFILE

int main() { printf("%s\n", func()); }

% cat func.c

char *func() { return "It worked."; }

% gcc test.c -DOTHERFILE='"func.c"'
% ./a.out
It worked.
% 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-07-11T15:23:35.553

您可以使用丑陋但经典的字符串化技巧：

```
#define STRINGIFY2(x) #x
#define STRINGIFY(x) STRINGIFY2(x)
#include STRINGIFY(INCLUDEFILENAME) 
```

# python - 使用外部 ip 托管

> ID：10537451
> 
> 赞同：0
> 
> 时间：2012-05-10T15:34:29.313
> 
> 标签：python, hosting, ip, external

`Hello World!`当互联网上的任何人在 url 栏中输入我的外部 ip 时，我想从我的外部 ip 地址中查看以下 python 文件的字符串。

```
#!/usr/bin/env python
from wsgiref.simple_server import make_server

cont = '''Hello world!'''

def application(environ, start_response):
    start_response('200 OK', [('Content-Type', 'text/plain')])
    return [cont]

server = make_server('0.0.0.0', 8080, application)
server.serve_forever() 
```

仅在浏览器的 url 栏中输入我的外部 IP 地址是行不通的。用我的外部 ip 更改 0.0.0.0 也不起作用。我该怎么做呢？

（顺便说一句：当我在浏览器中访问我的内部 IP 地址时，该脚本有效）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-10T15:38:55.667

我猜你是一个正在做网络地址转换（NAT）的路由器，所以你需要[端口转发](http://portforward.com/)以允许外部机器连接到你的服务器。

您也可能正在运行阻止入站请求的防火墙。

您的 ISP 也可能会阻止该端口上的入站请求。[您可以使用在线工具](http://canyouseeme.org/)轻松检查。

# sql-server - SSRS 出价默认放大报告

> ID：10537455
> 
> 赞同：0
> 
> 时间：2012-05-10T15:34:39.220
> 
> 标签：sql-server, sql-server-2008, reporting-services, bids

当我打开我的报告时，默认缩放为 100%，为了我的报告，用户需要查看 75%，我担心他们每次运行报告时都必须手动调整它。我可以想象这会变得相当乏味。有没有一种方法可以告诉每个报告部分默认缩放比例是多少？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-10T16:22:55.673

rc：Zoom 是用于设置报表中缩放级别的参数。
有关这方面的更多信息，您可以参考此站点
[http://msdn.microsoft.com/en-us/magazine/cc188712.aspx](http://msdn.microsoft.com/en-us/magazine/cc188712.aspx)

所以你可以使用类似 [http://www.myserver.com/reportserver?/AdventureWorks](http://www.myserver.com/reportserver?/AdventureWorks) 2008 Sample Reports/Company Sales 2008&rc:Zoom=75

# c++ - Don't want main to wait for boost thread to be finished?

> ID：10537458
> 
> 赞同：2
> 
> 时间：2012-05-10T15:34:55.497
> 
> 标签：c++, boost

I'm working on learning to use boost threads. I'm trying to make a simple program where I feed numbers to a queue that is available on both threads and output it on the worker thread.

I made it so that the worker thread shuts down if I feed it a 1.

The problem is when I call join, my main thread just sits there and waits for the worker thread to be finished. I do not want this. I want main to keep executing in parallel to the worker thread.

```
template<typename Data>
class concurrent_queue
{
private:
    std::queue<Data> the_queue;
    mutable boost::mutex the_mutex;
    boost::condition_variable the_condition_variable;
public:
    void push(Data const& data)
    {
        boost::mutex::scoped_lock lock(the_mutex);
        the_queue.push(data);
        lock.unlock();
        the_condition_variable.notify_one();
    }

    bool empty() const
    {
        boost::mutex::scoped_lock lock(the_mutex);
        return the_queue.empty();
    }

    bool try_pop(Data& popped_value)
    {
        boost::mutex::scoped_lock lock(the_mutex);
        if(the_queue.empty())
        {
            return false;
        }

        popped_value=the_queue.front();
        the_queue.pop();
        return true;
    }

    void wait_and_pop(Data& popped_value)
    {
        boost::mutex::scoped_lock lock(the_mutex);
        while(the_queue.empty())
        {
            the_condition_variable.wait(lock);
        }

        popped_value=the_queue.front();
        the_queue.pop();
    }

};

void workerFunc(concurrent_queue<int>* q )  
{  
    while(true)
    {
        while(!q->empty())
        {
            int p = -1;
            q->wait_and_pop(p);
            std::cout << p;

            if(p == 1)
            {
                return;
            }
        }
    }
}  

int main(int argc, char* argv[])  
{  
    concurrent_queue<int> m_q;
    std::cout << "main: startup" << std::endl;  

    boost::thread workerThread(workerFunc,&m_q);  

    std::cout << "main: waiting for thread" << std::endl;  

    m_q.push(6);
    m_q.push(11);
    workerThread.join();
    m_q.push(99); //will not reach here
    std::cout << "main: done" << std::endl;  

    return 0;  
} 
```

Thanks

I want the thread to be active and running and only process numbers when it has some that could be given at any time by the main thread.

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-10T15:43:30.963

该`join()`函数等待附加线程完成，因为它应该。如果您的目的是让该线程在程序的整个生命周期内（或直到您将 a 推入队列）保持运行，那么您的主线程没有理由调用`join()` *它所在的位置。*`1`

如果您根本没有那个线程，那么当对象超出范围`join()`时，线程将分离。`workerThread`这几乎肯定不是你想要的。通常，多线程程序会在从`main`. 在您的情况下，您需要`1`在调用之前专门向您的线程发出信号（通过将 a 推送到您的队列中）`join()`以使您的程序干净地退出。

这是一个例子：

```
int main(int argc, char* argv[])  
{  
    concurrent_queue<int> m_q;
    std::cout << "main: startup" << std::endl;  

    boost::thread workerThread(workerFunc,&m_q);  

    std::cout << "main: waiting for thread" << std::endl;  

    m_q.push(6);
    m_q.push(11);

    // not ready for this yet...
    // workerThread.join();

    m_q.push(99);

    boost::this_thread::sleep(1000);

    m_q.push(50);
    m_q.push(30);

    std::cout << "main: done" << std::endl;  

    m_q.push(1);
    workerThread.join();

    return 0;  
} 
```

# java - 合并而不是持久化防止“分离实体传递给持久化”错误？

> ID：10537462
> 
> 赞同：2
> 
> 时间：2012-05-10T15:35:14.990
> 
> 标签：java, merge, persistence

我知道有很多关于这个著名的*分离实体传递给持续*错误的讨论。我遇到了那个错误。我[很好地链接](https://stackoverflow.com/questions/2441598/detached-entity-passed-to-persist-error-with-jpa-ejb-code)了我的实体，但这不是问题：我正在将一个实体链接到一个已经存在的实体。我尝试`merge()`了而不是`persist()`，它很好地执行了交易。我询问了那个`merge()`方法，我在[这里](https://stackoverflow.com/questions/1069992/jpa-entitymanager-why-use-persist-over-merge)和[那里](http://blog.xebia.com/2009/03/23/jpa-implementation-patterns-saving-detached-entities/)学到了要点：*它复制了传递对象的状态*。对。

我的问题是，而不是

`em.persist(e); e.anything();`

使用它是不是一个坏主意

`e = em.merge(e); e.anything();`

?

如果我很好理解，`merge()`返回*状态合并到的托管实例*，这应该意味着用返回的实体覆盖给定实体可以访问持久实体，不是吗？

我在任何地方都没有看到那个“解决方案”，所以我在问。如果这是一个重复的问题，我会过失`:)`

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-10T17:56:09.700

> 使用它是不是一个坏主意`e = em.merge(e); e.anything();`

这是否是一个坏主意取决于您的应用程序以及您在合并之前所做的事情以及您在`anything()`.

A`merge`将在某些情况下修复“分离实体”错误。在其他情况下，它会在破坏您的应用程序时满足实体管理器的要求。

要回答您的具体案例的问题，您必须问自己：`e`从哪里来？它包含什么？它与其他实体有关系吗？如果是这样，这些关系是双向的吗？ETC...

# python - How to translate cURL to Python requests language?

> ID：10537464
> 
> 赞同：2
> 
> 时间：2012-05-10T15:35:19.987
> 
> 标签：python, curl, amazon-s3, python-requests

I have some difficulty in translating cURL options into Python requests for uploading a file to a cloud server Picloud. Based on their description, the first step is to POST a request to make a new file to PiCloud to create a ticket for this upload. The second step is to send instructions extracted from this ticket to upload the file.

I am OK with the first step. But have questions about the second one.

1st step, create a upload ticket.

cURL statement:

```
$ curl -k -u 'key:secret_key' -X POST https://api.picloud.com/file/new/ -d name=file_name 
```

My requests code:

```
r = requests.post('https://api.picloud.com/file/new/',auth=(api_key,api_secretkey), verify=False, data={'name':'file_name'}) 
```

The ticket looks like:

```
{"ticket": {"AWSAccessKeyId": "AKIAJCY7JV52WD4MJSNQ", 
"success_action_redirect": "https://api.picloud.com/file/uploaded/3303/4600939/4a6317595a03f85fbbe9102b2454119dc35d3969/", 
"acl": "private", 
"key": "44ec7b76cb3e046986e82b3f13b2da30208d43a5/your_file_name", 
"signature": "TzFhvowtJnBm2+HCvTSlZkBxM5w=", 
"policy": "eyJjb25kaXRpb25zIjogW3siYnVja2V0IjogInBpLXVzZXItZmlsZXMifSwgeyJrZXkiOiAiNDRlYzdiNzZjYjNlMDQ2OTg2ZTgyYjNmMTNiMmRhMzAyMDhkNDNhNS95b3VyX2ZpbGVfbmFtZSJ9LCB7ImFjbCI6ICJwcml2YXRlIn0sIHsic3VjY2Vzc19hY3Rpb25fcmVkaXJlY3QiOiAiaHR0cHM6Ly9hcGkucGljbG91ZC5jb20vZmlsZS91cGxvYWRlZC8zMzAzLzQ2MDA5MzkvNGE2MzE3NTk1YTAzZjg1ZmJiZTkxMDJiMjQ1NDExOWRjMzVkMzk2OS8ifSwgWyJzdGFydHMtd2l0aCIsICIkQ29udGVudC1UeXBlIiwgIiJdXSwgImV4cGlyYXRpb24iOiAiMjAxMi0wNS0xMVQwMTo1MDo0NFoifQ==",
"Content-Type": "application/octet-stream"}, 
"params": {"action": "https://pi-user-files.s3-external-1.amazonaws.com/"}} 
```

2nd step, upload the file.

Basically, I do not quite understand in translating `cURL -L` and `-F` options. Based on instructions from cURL, -L means redirect, and -F means fill in as form.

cURL statement:

```
$ curl -L "https:/.s3.amazonaws.com/" -F "AWSAccessKeyId=1"  -F "success_action_redirect=https://api.picloud.com/file/uploaded/1234" -F "acl=info" -F "key=info"  -F "signature=info" -F "policy=info" -F content-type="info" -F file=your_file_to_upload 
```

My bad trial:

```
up_d={"AWSAccessKeyId": "AKIAJCY7JV52WD4MJSNQ", "success_action_redirect": "https://api.picloud.com/file/uploaded/3303/4596631/28ec3c3898bec2523759e15cd62fb39fa62b5c53/", 
      "acl": "private", "key": "44ec7b76cb3e046986e82b3f13b2da30208d43a5/your_file_name", "signature": "BLsaltt+Ohua4tPPISr2eV2Tr8c=", 
      "policy": "eyJjb25kaXRpb25zIjogW3siYnVja2V0IjogInBpLXVzZXItZmlsZXMifSwgeyJrZXkiOiAiNDRlYzdiNzZjYjNlMDQ2OTg2ZTgyYjNmMTNiMmRhMzAyMDhkNDNhNS95b3VyX2ZpbGVfbmFtZSJ9LCB7ImFjbCI6ICJwcml2YXRlIn0sIHsic3VjY2Vzc19hY3Rpb25fcmVkaXJlY3QiOiAiaHR0cHM6Ly9hcGkucGljbG91ZC5jb20vZmlsZS91cGxvYWRlZC8zMzAzLzQ1OTY2MzEvMjhlYzNjMzg5OGJlYzI1MjM3NTllMTVjZDYyZmIzOWZhNjJiNWM1My8ifSwgWyJzdGFydHMtd2l0aCIsICIkQ29udGVudC1UeXBlIiwgIiJdXSwgImV4cGlyYXRpb24iOiAiMjAxMi0wNS0xMVQwMDozOTo0OFoifQ==", 
      "Content-Type": "application/octet-stream", "file":"new  2.txt"}
    k1=requests.post('https://pi-user-files-test.s3.amazonaws.com/', data=up_d) 
```

The error message is

```
<Error><Code>InvalidArgument</Code><Message>Conflicting query string parameters: acl, policy</Message><ArgumentValue>acl</ArgumentValue><ArgumentName>ResourceType</ArgumentName><RequestId>4767425F264FB0CA</RequestId><HostId>K/pAE6BXLJaRRo56ETWw2uYZed8GR+1+VPPU3TI0pZGNyrqz/PAWSzuwtIAHz9eE</HostId></Error> 
```

Thanks for your help!

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-10T15:42:40.053

看起来您在正文中不需要参数或 AWSAccessKeyID。此外，对我来说，他们告诉您将 Content-Type 卡在正文中而不是将其设置在标头中，这对我来说似乎很奇怪……无论如何，您还需要在请求中设置标头。根据 curl 文档，-F 将标头中的 Content-Type 设置为 multipart/form-data，因此您也应该在 Python 中这样做。

# android - Android 检查表格上次更新的时间

> ID：10537465
> 
> 赞同：7
> 
> 时间：2012-05-10T15:35:23.063
> 
> 标签：android, sql, database, sqlite

您好，我开始开发一个 Android 应用程序，该应用程序将使用一个 SQLite DB 来保存多个表。我想知道的是上次更新特定表的时间，因为某些数据在一周内不需要更新，而其他表需要每隔几个小时更新一次。试图节省带宽并创建更快响应更迅速的应用程序。不确定是否有这个命令（似乎找不到任何东西），或者我是否应该在每个表中添加一个包含当前时间和日期的字段，并使用 System.currentTimeMillis() 来计算它已经持续了多长时间。

我知道这是在下面被问到但从未得到回答，任何帮助都会很棒:)

[检查 SQLite 数据库/表的上次更新时间 (PHP)](https://stackoverflow.com/questions/7969219/check-when-an-sqlite-database-table-was-last-updated-php)

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-05-11T10:45:47.613

有点晚了，但到底是什么——你也可以在你的表上放一堆`TRIGGER`s 并维护一个修改表，如下所示。最近的修改以类型和日期+时间记录在`modifications`表中。`TRIGGER`可以通过一个简单的方法轻松完成创建这样的 s，并为您在您的文件中创建的每个表调用`SQLiteOpenHelper`

```
CREATE TABLE table1 (
    _id INTEGER PRIMARY KEY AUTOINCREMENT,
    text1 TEXT,
    text2 TEXT
);

CREATE TABLE table2 (
    _id INTEGER PRIMARY KEY AUTOINCREMENT,
    text1 TEXT,
    int1 INTEGER
);

CREATE TABLE modifications (
    table_name TEXT NOT NULL PRIMARY KEY ON CONFLICT REPLACE,
    action TEXT NOT NULL,
    changed_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);

CREATE TRIGGER IF NOT EXISTS table1_ondelete AFTER DELETE ON table1
BEGIN
    INSERT INTO modifications (table_name, action) VALUES ('table1','DELETE');
END;

CREATE TRIGGER IF NOT EXISTS table2_ondelete AFTER DELETE ON table2
BEGIN
    INSERT INTO modifications (table_name, action) VALUES ('table2','DELETE');
END;

CREATE TRIGGER IF NOT EXISTS table1_onupdate AFTER UPDATE ON table1
BEGIN
    INSERT INTO modifications (table_name, action) VALUES ('table1','UPDATE');
END;

CREATE TRIGGER IF NOT EXISTS table2_onupdate AFTER UPDATE ON table2
BEGIN
    INSERT INTO modifications (table_name, action) VALUES ('table2','UPDATE');
END;

CREATE TRIGGER IF NOT EXISTS table1_oninsert AFTER INSERT ON table1
BEGIN
    INSERT INTO modifications (table_name, action) VALUES ('table1','INSERT');
END;

CREATE TRIGGER IF NOT EXISTS table2_oninsert AFTER INSERT ON table2
BEGIN
    INSERT INTO modifications (table_name, action) VALUES ('table2','INSERT');
END; 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-10T15:41:48.780

我知道没有 SQL 函数可以做到这一点。

您可以为每条记录添加一个带有时间戳的字段，然后执行查询以从表中返回最新的时间戳。

* * *

## 回答 #3

> 赞同：-2
> 
> 时间：2013-07-03T14:20:47.990

我相信操作可以通过以下步骤来实现

第 1 步：您可以使用**sqlite 触发**机制

第 2 步：从第 1 步调用**sqlite**命令**将更新的记录写入文本文件**（检查将结果写入文件：[http](http://www.sqlite.org/sqlite.html) ://www.sqlite.org/sqlite.html ）

第 3步：在[C#](http://msdn.microsoft.com/en-us/library/system.io.filesystemwatcher.aspx)或[PHP中](https://stackoverflow.com/questions/9271104/php-folder-watching-on-windows)**执行文件系统观察程序**操作

第 4 步：通过**短信网关将****数据从 php 发送到 android**

 **另一个疯狂的科学怪人算法，我正在为我的应用程序工作；-)

欢迎任何比这更可行和更简单的方法......**

# svn - Is Visual sourcesafe an old technology as opposed to Subversion and TortoiseSVN?

> ID：10537466
> 
> 赞同：0
> 
> 时间：2012-05-10T15:35:26.057
> 
> 标签：svn, version-control, visual-sourcesafe

I'm used to using subversion with tortoisesvn with other development teams and found it very useful. My current development team uses MS Sourcesafe which I believe is a load of....well you get the point! Am I right in thinking that subversion with toirtoisesvn is now the standard for modern version control as opposed to source safe?

Thanks

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-11T11:23:26.157

甚至微软的开发者也拒绝使用 VSS。坦率地说，我认为世界上没有人仍然使用...的火焰球。 SVN 是不错的，无论如何作为 CVS 的替代品。但是，如果您正在评估当前的 SCM 解决方案，那么请为您自己提供服务并将其排除在外。我建议查看以下“开源”产品：

*   [Git](http://git-scm.com/)（我个人最喜欢的）。
*   [ [Mercurial](http://mercurial.selenic.com/)（另一个不错的，类似于 Git）
*   [Bazaar](http://bazaar.canonical.com/en/)（在某个时候正在加快速度，但在我看来，上述两个选项被吹出了水面）

一些商业产品：

*   [Perforce](http://www.perforce.com/)（更好的商业 SCM 之一）
*   [Team Foundation Server](http://en.wikipedia.org/wiki/Team_Foundation_Server)（如果您使用的是 VSS，那么这是合乎逻辑的商业“继任者”。但并非没有自己的问题）
*   [Borland StarTeam](http://www.borland.com/us/products/starteam/)（漂亮的 GUI，虽然它对删除的处理很糟糕）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-10T15:40:13.600

[Visual Source Safe](http://en.wikipedia.org/wiki/Microsoft_Visual_SourceSafe)非常老旧。与您今天对源版本控制系统的期望相去甚远。

[CVS](http://en.wikipedia.org/wiki/Concurrent_Versions_System)并不年轻，但它的想法可能更现代，并且没有要求您锁定文件作为示例。

[Subversion](http://en.wikipedia.org/wiki/Subversion_%28software%29)现在也已经过时了，它的本意是要取代这个非常老的一代。

现在年轻的系统是[Mercurial](http://en.wikipedia.org/wiki/Mercurial)和[Git](http://en.wikipedia.org/wiki/Git_%28software%29)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-10T15:40:25.630

这是一个非常主观的问题。

但是，答案是“是”……是的，根据其发布日期和维护计划，它是一项旧技术。

TFS 是较新的 Microsoft 替代 VSS。

# c# - .net 应用程序更新

> ID：10537468
> 
> 赞同：2
> 
> 时间：2012-05-10T15:35:31.607
> 
> 标签：c#, .net, visual-studio, visual-studio-2010

我即将发布应用程序的 Beta 版本，并希望确保它可以远程更新，用户在应用程序中收到更新存在的通知。理想情况下，如果可能的话，我想强制更新。我目前正在使用与 VS2010 一起打包的 InstallShield LE 来构建我的安装 exe 文件。

我的计划是创建一个 wcf Web 服务，它将提供所有产品版本的 XML 清单。我不确定如何提供更新。我能想到的选项是

1.  提供新的 installshield 安装程序 - 安装程序比程序大很多，因此一旦安装程序，发送完整的安装程序似乎有点过分了。
2.  只发送 msi 文件 - 我不确定如何在 VS2010 中创建 MSI 安装程序。
3.  下载新的应用程序文件（一个 exe 大约 7 10 Dlls）并用新文件替换当前文件。

有没有人想过哪个选项最好以及如何实施？我是否需要某种代码签名并在客户端检查安全性？

谢谢你的帮助。

编辑-应该提到 ClickOnce 不是一个选项。主要是因为它的可定制性不足以适应我们的外观和感觉。还有一些关于 ClickOnce 的其他问题，我不会在这里讨论。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-10T15:57:57.197

几年前我也遇到过类似的情况，我们正在开发一个带有几个可选松散耦合组件的产品。我们最终要做的是当应用程序启动时，它会检查我们的“UpdateService”并匹配元数据。

如果应用程序未更新，我们将启动一个单独的进程来更新 XML 并从我们的更新服务中删除字节数组中的 DLL，该更新服务将 XML 和更新的 DLL 复制到相应的文件夹中。

这对我们当时有用。部分原因是客户端可能会升级功能，我们可能需要它来下载额外的 DLL。

然而，应用程序的第一次安装是通过安装程序 (exe)。

挑战在于我们必须编写自定义内容以及正确的补丁/程序集管理或版本。但足以考虑并满足产品经理

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-10T15:41:46.010

ClickOnce 对您来说似乎是一个不错的选择。

[http://msdn.microsoft.com/en-us/library/t71a733d(v=vs.80).aspx](http://msdn.microsoft.com/en-us/library/t71a733d(v=vs.80).aspx)

最好的祝福

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-10T15:57:11.813

[除非您进行了影子复制 ( http://msdn.microsoft.com/en-us/library/ms404279.aspx](http://bit.ly/KT2Vzp) ) ，否则您将无法就地“替换”文件。如果有更新，必须有一些方法在应用程序中“检查”。我想 WCF 对此太过分了。您可以简单地拥有一个已知的 URL 来获取可以与应用程序中的版本号进行比较的“版本号”，以及一个已知的 url 来获取“最新”版本......大多数应用程序只需下载 MSI 并询问用户执行它。

# jquery - jquery中的POST请求错误

> ID：10537469
> 
> 赞同：0
> 
> 时间：2012-05-10T15:35:32.603
> 
> 标签：jquery, asp.net, ajax, post, http-post

我的大学成绩卡（结果）很难理解，而且很难计算学生的实际百分比。所以，我想为学生提供一项服务，学生只需要在那里输入注册号。我会自己计算结果。

首先，我尝试向 http://hurl.it 中的成绩卡页面发送帖子请求[这](http://hurl.it) 是烫发链接[http://hurl.it/hurls/c61f1d38b6543965151a1c8a8d6f641b8921da49/986ecba51b61022fa9fa162be612d7c928051989](http://hurl.it/hurls/c61f1d38b6543965151a1c8a8d6f641b8921da49/986ecba51b61022fa9fa162be612d7c928051989)

**但是**从我的网站使用 jquery 发送相同的请求时出现错误：我正在使用以下代码发送请求。

```
 $.ajax({
                type: "POST",
                url: "http://stusupport12.ignou.ac.in/Result.asp",
                data: "submit=Submit&eno=092853268&hidden%5Fsubmit=OK&Program=BCA",
                success: function (d) {
                    $("#resultDiv").html(d);
                },
                error: function (a, b, c) { alert(a + b + c); }
            }); 
```

请朋友们帮帮我。

**更新 2 - 我通过在我的服务器上处理请求来找到我的解决方案。我创建了一个通用处理程序 (.ashx) 来处理服务器上的请求并将处理后的请求发送回客户端。我可以用 Jquery 来调用它。**

这是代码

```
<%@ WebHandler Language="C#" Class="IGNOU" %>

using System;
using System.Web;
using Newtonsoft.Json;
using System.Collections.Generic;
using System.Net;
using System.IO;

public class IGNOU : IHttpHandler {

    public void ProcessRequest (HttpContext context) {
        context.Response.ContentType = "text/html";
        context.Response.Write(Func(context.Request.QueryString["eno"]));
    }

    public bool IsReusable {
        get {
            return false;
        }
    }
    public string Func(string eno)
    {
        string str = string.Empty;
        WebRequest request = WebRequest.Create("http://stusupport12.ignou.ac.in/Result.asp");
        // Set the Method property of the request to POST.
        request.Method = "POST";
        // Create POST data and convert it to a byte array.
        string postData = "submit=Submit&Program=BCA&hidden_submit=OK&eno=" + eno;
        byte[] byteArray = System.Text.Encoding.UTF8.GetBytes(postData);
        // Set the ContentType property of the WebRequest.
        request.ContentType = "application/x-www-form-urlencoded";
        // Set the ContentLength property of the WebRequest.
        request.ContentLength = byteArray.Length;
        // Get the request stream.
        Stream dataStream = request.GetRequestStream();
        // Write the data to the request stream.
        dataStream.Write(byteArray, 0, byteArray.Length);
        // Close the Stream object.
        dataStream.Close();
        // Get the response.
        WebResponse response = request.GetResponse();
        // Display the status.
        Console.WriteLine(((HttpWebResponse)response).StatusDescription);
        // Get the stream containing content returned by the server.
        dataStream = response.GetResponseStream();
        // Open the stream using a StreamReader for easy access.
        StreamReader reader = new StreamReader(dataStream);
        // Read the content.
        string responseFromServer = reader.ReadToEnd();
        // Display the content.
        Console.WriteLine(responseFromServer);
        // Clean up the streams.
        reader.Close();
        dataStream.Close();
        response.Close();

        return responseFromServer;
    }
} 
```

**更新 1**添加了网页链接 [https://www.bobdn.com/IGNOU_BCA_Result.aspx](https://www.bobdn.com/IGNOU_BCA_Result.aspx)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-10T16:22:18.277

此错误是由于跨域策略，响应返回正确的数据但是浏览器本身阻止响应，因为它不是同一来源。

正如您在 twitter 上看到的，`https://twitter.com/crossdomain.xml`这是跨域策略，您需要`crossdomain.xml`在根目录中放置一个文件，`stusupport12.ignou.ac.in`其内容如下：

```
<?xml version="1.0" encoding="UTF-8"?>
<cross-domain-policy xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://www.adobe.com/xml/schemas/PolicyFile.xsd">
  <allow-access-from domain="www.bobdn.com" />
</cross-domain-policy> 
```

我的 asp.net 样机：

```
byte[] buffer = Encoding.UTF8.GetBytes("submit=Submit&eno=092853268&hidden%5Fsubmit=OK&Program=BCA");

HttpWebRequest req = (HttpWebRequest)WebRequest.Create("http://stusupport12.ignou.ac.in/Result.asp");
req.Method = "POST";
req.ContentType = "application/x-www-form-urlencoded";
req.ContentLength = buffer.Length;
req.CookieContainer = new CookieContainer(); // enable cookies 

Stream reqst = req.GetRequestStream(); // add form data to request stream
reqst.Write(buffer, 0, buffer.Length);
reqst.Flush();
reqst.Close(); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-10T15:48:40.150

我的猜测是错误不在函数声明`function (a, b, c)`中，而是在警报中。我同意这`a, b, c`是可怕的变量名称 - 特别是 b/c 并不明显这`a`是一个 XMLHttpRequest 对象，而`b`和`c`是字符串。
如果您意识到这一点，您将很容易看到错误 - 无法将 XMLHttpRequest 对象与字符串连接。

在此处查看有关错误功能的文档：http: [//api.jquery.com/jQuery.ajax/](http://api.jquery.com/jQuery.ajax/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-10T17:00:54.500

这是重点：

您引用的站点（hurl.it）实际上使用服务器端脚本，使其服务器充当代理并为您检索结果。我绝对肯定，由于同源策略，您无法在客户端执行此类请求。

想象一下，您可以自由地执行这样的请求，您将能够使用大量未过滤的呼叫加载其他人的服务器，从而分配来自数千个不同 IP 的呼叫，并且无法引用您的服务。这就是为什么 SOP 要求您在两者之间放置自己的服务器以监控和引导这些请求。

另一种解决方案是远程服务器设置 API 服务以接收客户端调用，从而返回 JSON 响应，这将正常工作。几乎所有 API 服务都需要一个额外的参数，这将是与您的域相关联的个人开发人员密钥，因此他们可以在任何情况下知道这些请求来自哪里

# c++ - 如何从核心转储中遍历 xerces-c DOMDocument？

> ID：10537470
> 
> 赞同：0
> 
> 时间：2012-05-10T15:35:41.527
> 
> 标签：c++, xml, debugging, coredump, xerces-c

我发布了一个经过编辑的问题，因为原始问题中的段错误和第三方库的整个业务只是分散了注意力。

我所拥有的是一个使用 xerces-c 和 segfaults 的程序（在该过程中创建一个核心转储）。我想要做的是启动 gdb 并从核心转储遍历创建的 DOMDocument。

例如，我想获取给定 DOMElement 或其子节点的属性等等。有没有人有任何我可以阅读的文章来描述 DOMElements 的内部结构等等？或者甚至指向我关于 xerces-c 源代码的一些资源，因为我无法在我的源 tarball 中找到 DOMElement 的源代码。（从那时起，拥有源代码可能会有所帮助，因为我确切地知道 DOMElement 是如何实现的，允许我遍历它）。

正如我所说，我对 xerces-c 代码库不太熟悉，而 apache 文档显然很糟糕。

原始问题：-

我正在使用第三方库，而该库又使用 xercesc 进行 xml 解析，这会导致段错误。如何检查核心转储中的 xerces-c 元素？

我可以访问库源代码，并且它在使用 DOMElement 引用作为函数参数的函数中出现段错误。就像是

```
void func (DOMElement& e, ...) {
} 
```

我想从核心转储中检查这个 DOMElement（如打印出它的名称、标签、子元素等。基本上遍历这个 DOMElement 下面的 DOMDocument）但我不熟悉 xerces-c 代码库。

知道我该怎么做吗？

附加信息：- 我正在使用 gdb。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-10T16:56:51.290

如果您使用的是 gdb，我假设您使用的是 linux，对吗？然后你应该安装`libexerces-c++-dev`（或`libexerces-c++-devel`取决于你的发行版）包和源代码。这将允许您甚至在 xerces 代码中设置断点。

过去我一直在使用 xerces，当它通常崩溃时，问题不在于库本身，而在于“调用者”。在您的情况下，我将使用外部库创建一个非常简单的项目，并尝试解析一个简单的已知可工作的 XML 文件，因为即使您可以找到崩溃指令，我怀疑它是否会有所帮助，因为使用了 xerces不是直接由您而是由另一个图书馆

# web-services - wsimport giving parse error

> ID：10537471
> 
> 赞同：0
> 
> 时间：2012-05-10T15:35:43.010
> 
> 标签：web-services, wsdl, wsimport

I am getting strange parsing error when I try to import a WSDL using `wsimport`.

Error:-

```
org.xml.sax.SAXParseException: Invalid WSDL file: expected 
{http://schemas.xmlsoap.org/wsdl/}definitions found definitions at line 1)

```

I checked the WSDL and I am also surprised the first element of it is not

```
<wsdl:definitions ...> 
```

But rather:

```
<definitions   xmlns:soap="https://schemas.xmlsoap.org/wsdl/soap/" ...> 
```

Could this be the problem? The web service is external, so I dont have any control over the WSDL. One thing I know is that it is generated by JAX-WS 2.1.5\. Is it a customized WSDL that my wsimport tool is not able to understand? If yes please tell me how to resolve this problem. Thanks.

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-11T11:14:20.977

您在 wsdl 的第一行中有以下部分吗？

```
<definitions   ...   xmlns="http://schemas.xmlsoap.org/wsdl/"> 
```

如果没有，添加它，它应该没问题。原因是缺少 wsdl 的命名空间声明。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-10T15:48:23.190

根据[此对话](http://forums.java.net/node/700011)，JAX-WS 的 2.1.5 版本可能生成了不正确的 WSDL，并且您正在使用较新版本的 wsimport。

# ios - 如何将 Android NDK 库编译为静态 iOS 库

> ID：10537476
> 
> 赞同：0
> 
> 时间：2012-05-10T15:36:01.500
> 
> 标签：ios, makefile, android-ndk, static-libraries, porting

我有一个 C++ 代码库，我们的 Android 项目通过 JNI 使用它（构建脚本等都是 Android 特定的）。我需要用它更新我们的 Objective C 项目，它使用的是同一库的旧版本。问题是我只有目标 C 代码，但没有旧的 C++ 代码和 iOS 生成文件（它们是由外部机构完成的）——只有一个二进制 .a 文件。如何从 JNI 代码生成这样的静态 iOS 库，从哪里开始？我现在正在阅读这篇文章：[http](http://www.clintharris.net/2009/iphone-app-shared-libraries/) ://www.clintharris.net/2009/iphone-app-shared-libraries/如果您有兴趣提供帮助，我会更新这篇文章并提供更多详细信息。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-10T15:58:34.607

你被困住了。iOS 和 Android 不共享相同的 ABI。即使您可以使用链接器魔术将符号从 ELF 共享库中拉出并将它们链接到 Mach 二进制文件，这些函数也会崩溃，因为参数传递和堆栈帧设置等内容不同（老实说，我不知道细节除了 iOS 不是 EABI）。如果您愿意为每个函数编写或生成汇编级别的转换层，这几乎是不可能的。但基本上：你是 SOL。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-14T02:44:17.803

您在尝试此操作时遇到具体问题吗？假设代码是跨平台的并且可以在 iOS 上运行，您只需创建一个新的 makefile（Android 是专门的）或将文件拖到新的或现有的 XCode 项目中。

Apple 的 Clang 可以编译（当然你也可以混合使用）C、C++ 和 Obj-C。例如，如果您需要混合 Obj-C 和 C++ 命名您的文件 .mm 并继续。

示例 Makefile（注意：草率但应该说明！）： http: [//pastebin.com/ZyrsfT87](http://pastebin.com/ZyrsfT87)

# iphone - Drawing one NSString in multiple rects

> ID：10537477
> 
> 赞同：0
> 
> 时间：2012-05-10T15:36:03.400
> 
> 标签：iphone, objective-c, ios

I have a really long string, with thousands of line with a default font. So rather than draw the whole thing out in one table view cell, I'm going to make several cells to draw the same string, each drawing the next part of the string.

I'm having a hard time finding a starting point. Say I draw the first 500 pixels of height of the string in the rect - how do I know where to start in my second rect? If it's the same string, how can I specify for it to draw only some parts of the string?

Each cell will know it's own row number, so I'll be able to determine where exactly in the table I am, I just don't know how the string will know which part it's supposed to draw..

Or another question would be: how can I break up one string into multiple strings based on a certain number of lines?

**Edit:** Here are some NSString methods I'm finding that might be useful, but I still don't know how I would use them in my case:

```
- (void)getLineStart:(NSUInteger *)startIndex end:(NSUInteger *)lineEndIndex contentsEnd:(NSUInteger *)contentsEndIndex forRange:(NSRange)aRange
- (NSRange)lineRangeForRange:(NSRange)aRange 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-10T16:04:09.653

使用`substringWithRange:`这将允许您选择字符串的起点和终点。我会用一些字符来抓取每个部分。因此，第 1 部分将是 0-500，第 2 部分将是 500-1000。这里的问题是你可能会在句子中间中断。您可以使用 lineRangeForRange 之类的东西来确定子字符串的范围。

```
lineRangeForRange
Returns the range of characters representing the line or lines containing a given range.

- (NSRange)lineRangeForRange:(NSRange)aRange
Parameters
aRange
A range within the receiver.
Return Value
The range of characters representing the line or lines containing aRange, including the line termination characters. 
```

**编辑**

```
NSString *string = @"tjykluytjghklukytgjhkkghkj sdkjlhfkjsadgfiulgeje fuaeyfkjasdgfueghf aksjgflkj. wyruehskjluishfoeifh uasyeajhkfa uiyelkjahsdf uayekljshdf aehkfjsd. \n I iheio;fajkdsf sdfhlueshkfjskdhf ujhelkjfh. luehljkfhlsdf. leufhlkjdshfa. \n euoiywhfldsjkhf euyhfsdlkj. ewhlkjfsd. euilhfsdkjishdkjf euhjklsfd. \n";
NSLog(@"string length:%i", [string length]);
NSRange range;
range.length = [string length]/2;
range.location = 0;
NSLog(@"LineRangeForRange:%i", [string lineRangeForRange:range].length);
NSLog(@"Substring:%@", [string substringWithRange:[string lineRangeForRange:range]]); 
```

日志显示：

```
string length:295
LineRangeForRange:148
Substring:tjykluytjghklukytgjhkkghkj sdkjlhfkjsadgfiulgeje fuaeyfkjasdgfueghf aksjgflkj. wyruehskjluishfoeifh uasyeajhkfa uiyelkjahsdf uayekljshdf aehkfjsd. 
```

所以这样做是我为 LineRangeForRange 提供了一个从零到字符串一半的范围。它可能是该范围内的最后一行“\ n”。然后我抓住了那个子字符串

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-10T16:04:56.710

听起来不像是我想在应用程序中阅读文本的方式。为什么不使用 textView？

编辑：我的建议不是将 textView 放在 tableViewCell 中，而是显示被截断的文本的开头，然后单击推送显示 textView 的 viewControllers。有点像Mail。

# c# - 从 C# 编组“作为字符串”参数

> ID：10537480
> 
> 赞同：5
> 
> 时间：2012-05-10T15:36:11.497
> 
> 标签：c#, string, marshalling

遇到一个有趣的问题，我想知道是否有人可以帮助解释。我已经尝试在整个互联网上搜索，但似乎无法找到这个问题的答案。虽然我们有解决方案，但其他人可能会遇到同样的问题，而且由于它是随机的，因此很难追踪。

我们有一个应用程序在计算机连接到客户公司网络时随机失败（网络上没有很多信息）。当我们将计算机带到我们的环境中时，它运行良好。失败是相当随机的，但据我所知，这是在从 C# 调用非托管第三方供应商 DLL 期间发生的。我确实有一个回溯（只有几个失败在系统事件日志中提供了跟踪）指向在对非托管 DLL 的调用进行参数编组期间 RtlMoveMemory 函数中的 ntdll.dll 中的故障。

对非托管函数的调用是：

```
ThirdParty.CxxxAutomationWrapper clientDLL = new ThirdParty.CxxxAutomationWrapper () ;

object Parameter1 ;
  :
string theValue = "abcde" ;
Parameter1 = theValue ;
  :
if ( Parameter1 is string )
{
    int returnCode = clientDLL.function ( Parameter1 as string ) ;
} 
```

该调用在客户计算机上定期失败，但在 Visual Studio (2010) 中运行时始终有效。Parameter1 的值设置正确（从不为空）。

由于我将呼叫更改为：

```
String parameter1String = Parameter1.ToString() ;
int returnCode = clientDLL.function ( parameter1String ) ; 
```

一切正常。Parameter1 的值非常受控制，在执行此代码之前不为空。

被调用的接口（clientDLL.function）定义为：

```
HRESULT function ( [in] BSTR parameter,
                   [out, retval] long *ret); 
```

由于我对 c# 中的“as”语句的 [有限？] 理解，我不明白为什么第一个版本失败了。任何人都可以帮助解释为什么在使用指定为“as string”的参数调用时会失败吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-10T15:38:28.203

因为`obj as string`和`obj.ToString()`不一样。第一个是尝试的强制转换（有点像`(string)obj`，但`null`在失败时返回），而第二个是返回对象的字符串表示的方法调用。

实际上，您可以获得任何对象的字符串表示形式，无论它是否与作为类型的字符串兼容，但如果它们不兼容，则转换将失败。

简单的例子：

```
object obj = new object(); // simple object
Console.WriteLine(obj.ToString()); // prints System.Object
Console.WriteLine((obj as string) == null); // True: obj is not a string! 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-10T15:39:16.487

`Parameter1.ToString()`将任何 .NET 对象呈现为字符串（即 的实例`System.String`）。如果为 null`Parameter1 as string`或**不是**. 如果它是一个包装字符串的类而不是一个真正的类*，*那么你最终会得到一个.`null``Parameter1`**`System.String`***`null`*

 *当然，两者都不会在每种情况下都起作用。如果您有`System.String`is的实例`null`，`Parameter1 as string`则将正确返回`null`，而`Parameter1.ToString()`将抛出`NullReferenceException`.

一种安全的方法是：`Convert.ToString(Parameter1)`.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-10T15:44:56.173

`Parameter1 as string`可以认为是

```
string foo
try
{
    foo = (string)Parameter1;
}
catch
{
    foo = null;
} 
```

`.ToString()`在哪里

```
string foo = Parameter1.ToString(); 
```

Parameter1 不能直接转换为字符串的事实是它失败的原因。*

# android - Android Galaxy Nexus - 本地主机 HTTP 请求在 3G 连接开启时不起作用

> ID：10537486
> 
> 赞同：1
> 
> 时间：2012-05-10T15:36:34.733
> 
> 标签：android, http, 3g, samsung-mobile

我在三星 Galaxy Nexus（Android 版本 4.0.2）上向 localhost 发出 HTTP 请求时遇到问题。

我正在 Android 手机上运行一个本地 http 服务器来进行一些研究项目。这个想法是一个 Android 应用程序使用 HTTP 方法（GET、PUT 等）与这个本地服务器通信。

问题如下：

*   当我在打开 Wi-Fi 的情况下向 localhost 或 127.0.0.1 发出 HTTP 请求时，一切正常并且我能够访问服务器。

    *   但是，当我尝试在关闭 Wi-Fi 并使用 3G 连接的情况下执行相同操作时，我在响应状态行中得到一个：**HTTP/1.1 502 Bad Gateway**

    *   最后，如果我尝试通过 3G 连接向其他 IP (www.google.com) 发出 HTTP 请求，则 HTTP 响应代码为 200 OK。

另一个奇怪的事实是，在索尼爱立信 Xperia arcS 上运行相同的代码不会产生问题，并且一切正常。

我的猜测是，当我尝试使用 3G 连接对本地主机进行 HTTP 调用时，三星 Galaxy Nexus 存在问题。但是，我不明白为什么使用其他 IP 地址它可以完美运行。

有什么建议或有类似问题的人吗？

提前致谢，

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-12T15:24:11.610

因为 localhost 只能使用本地网络访问，并且您必须将内容放在在线主机上并使用地址或 IP 地址访问它，例如本地网络上的 localhost IP 地址是 192.168.1.2 并且您正在尝试访问它使用 3g 来自 android 的地址，3g 连接无法访问本地网络资源和地址，所以它会抛出，`UnknownHostException`或者类似的东西希望这会有所帮助

# mfc - MFC 菜单项未正确调用模式对话框

> ID：10537488
> 
> 赞同：4
> 
> 时间：2012-05-10T15:36:42.813
> 
> 标签：mfc

我创建了一个带有一些控件（编辑、文本等）的简单对话框，并将其保存到 GME/GME.rc/Dialog 的资源文件夹中

我添加了一个自动生成的事件处理程序，它创建了一个新类（为本示例的目的为 Class.cpp） 注意：Class::Class(CWnd *pParent) : CDialogEx(Class::IDD, pParent) 构造函数是空的，我不确定这是否相关，但我不认为是..

Class.cpp 中有一个 MESSAGE_MAP COMMAND(menu_item_id, &class::member_function()) 调用是自动生成的。它包含在标准的 BEGIN_MESSAGE_MAP 宏内容中。

但是：当单击菜单项时，该项目保持灰色。“enabled=true”和“gray=false”的属性均已正确配置。所以，我认为这是错误是由于消息处理程序未注册。

任何帮助，将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-10T20:12:46.747

对话框不包含通过 MFC 用于启用菜单项的 ON_UPDATE_COMMAND_UI 处理程序列表运行的代码。例如，通常这是由 CFrameWnd 处理的。尝试调用[`UpdateDialogControls`](http://msdn.microsoft.com/en-us/library/5tst88a4.aspx)你的`OnInitDialog`函数。

我看到您的代码也缺少菜单项的 ON_UPDATE_COMMAND_UI 宏，即使它引用的处理程序是为您创建的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-10T16:56:39.103

没有代码，很难提供帮助。您确定将菜单 ID 的消息处理程序放在 CView、CFrame、CDocument 或 CWinApp 派生类中吗？如果你把菜单处理程序放在你的对话框类中，它对你没有多大好处。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-16T15:14:31.263

您将菜单项处理程序添加到具有菜单的窗口，通常是 CMainFrame。将消息映射和处理程序复制到 CMainFrame 并查看是否有帮助。我不确定您要在这里做什么-我假设您想在单击菜单项时显示“类”（也许更好地编辑您的帖子以调用此“示例对话框”或其他内容...），对? 或者您是否以某种方式向您的 CDialogEx 派生类添加了一个菜单？如果是最后一个，我想这就是 Mark 所指的——“你如何显示菜单”？您如何手动将菜单添加到对话框中？

# oop - 对象上的测试方法存在

> ID：10537491
> 
> 赞同：2
> 
> 时间：2012-05-10T15:36:54.913
> 
> 标签：oop, matlab

我有一个`Matlab`对象单元格数组，例如：

```
objs = {Object1(), Object2(), Object3()}; 
```

这些对象都是不同的类型。他们中的一些人会有一个方法，我们称之为`myMethod()`。我想做类似的事情：

```
for o = objs
  if hasMethod(o, 'myMethod()')
    o.myMethod();
  end
end 
```

我的困难是我不知道该怎么做`hasMethod`-`exist`在这里似乎没有帮助。

我可以使用 a `try - catch`，但我宁愿做一些更整洁的事情。有没有办法做到这一点？我应该改变我的设计吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-10T15:59:43.590

啊，找到了。不是很令人兴奋 - 您可以使用[methods](http://www.mathworks.co.uk/help/techdoc/ref/methods.html)命令获取方法列表。所以要检查一个对象是否有方法，

```
if any(strcmp(methods(o), 'myMethod'))
  o.myMethod();
end 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-10T17:40:09.190

另一种选择是使用元类。

```
 obmeta = metaclass(ob);
  methodNames = cellfun(@(x){x.Name},obmeta.Methods); 
```

您还可以从`obmeta.Methods`类似处获取更多信息

*   输入/输出参数的数量。
*   访问类型
*   该方法在哪个类中定义。

此外，`metaclass`可以从类的名称构造，没有实例，这在某些情况下可能是一个优势。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2017-05-11T14:57:17.883

很接近！如果你写的函数名有点不同，你会偶然发现以下内置函数：

```
if ismethod(o, 'myMethod')
    o.myMethod();
end 
```

文档：[ismethod](https://uk.mathworks.com/help/matlab/ref/ismethod.html)。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-05-10T15:43:07.407

你为什么想这么做？你最好有一个很好的理由：p

最好让它们从超类继承通用功能。然后你可以为所有这些调用该函数，而不是查找它是哪个类/检查一个函数是否存在，然后根据结果调用一个函数（这不是很OO）

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-05-10T17:47:50.687

一个简单的选择是使用函数[EXIST](http://www.mathworks.com/help/techdoc/ref/exist.html)（连同函数[CLASS](http://www.mathworks.com/help/techdoc/ref/class.html)）来检查给定类的方法是否存在：

```
if exist(['@' class(o) '/myMethod'])
  o.myMethod();
end 
```

另一种选择是使用函数[WHICH](http://www.mathworks.com/help/techdoc/ref/which.html)执行如下检查：

```
if ~isempty(which([class(o) '/myMethod']))
  o.myMethod();
end 
```

# eclipse - 如何在 Eclipse 中使用 JUnit RunListener？

> ID：10537495
> 
> 赞同：8
> 
> 时间：2012-05-10T15:37:12.307
> 
> 标签：eclipse, maven, junit, maven-failsafe-plugin

我为 JUnit 编写了一个简单的 RunListener，它与 Maven 配合得很好。我可以通过 maven-failsafe-plugin 注册它

```
<properties>
    <property>
        <name>listener</name>
        <value>com.asml.lcp.middleware.common.jboss.test.tps.TestDocumentationListener</value>
    </property>
</properties> 
```

并查看侦听器的正确输出。

现在，当我运行测试时，我想在 Eclipse 中注册相同的 RunListener 以在那里看到相同的输出。

这可能吗？出于测试目的并保持一致，最好有相同的输出。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2014-10-03T08:20:10.897

我有一组需要执行数据库的测试。我想在执行开始时创建数据库并在最后删除它。

从 maven 我还向 maven-surefire-plugin 添加了一个*RunListener*，它工作正常。而且我还添加了一个名为*ismaven*的系统属性变量。*当我从 maven 执行测试时，这个变量被初始化，但是当我从 Eclipse 执行测试时，这个变量为空（我使用System.getProperty*访问该变量）。

```
<configuration>
  <properties>
    <property>
      <name>listener</name>
      <value>com.mycompany.MyRunListener</value>
    </property>
  </properties>
  <systemPropertyVariables>
    <ismaven>true</ismaven>
  </systemPropertyVariables>
</configuration> 
```

我所有的数据库测试都继承自一个具有@BeforeClass 和@AfterClass 方法的类。这些方法检查测试是由 Maven 执行还是由 Eclipse 检查*ismaven*属性的值。如果测试是由 maven 执行的，则*ismaven*属性有一个值，它们可以做任何事情。但是测试是否正在由 Eclipse 执行，*ismaven*变量为 null 并且它们启动 (@BeforeClass) 或停止 (@AfterClass) 数据库：

```
@BeforeClass
public static void checkIfStartDatabase() {   
  String ismaven = System.getProperty("ismaven");
  // If it is not maven, start the database
  if (ismaven == null) {
    startDatabase();
  }
}

@AfterClass
public static void checkIfStopDatabase() {
  String ismaven = System.getProperty("ismaven");
  // If it is not maven, stop the database
  if (ismaven == null) {
    stopDatabase();
  }
} 
```

此解决方案不能 100% 解决您的问题，但如果您实施它，您可以使用 Eclipse 执行（和调试）一个 JUnit 类的所有测试，您还可以使用 Maven 执行项目的所有测试，并保证您将在执行所有测试之前或之后执行一段代码。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-11-21T21:41:06.383

是的，有可能。基本上你必须实现你自己的 Runner 并且在 run 方法中，你可以添加一个自定义的运行监听器。我根据[这篇文章](https://stackoverflow.com/a/21136829/1812732)第 2 点想到了这一点。

这是我的听众

```
public class TestLogger extends RunListener
{
    public void testFinished(Description description)
    {
        System.out.println("Successful " + description.getMethodName());
    }
} 
```

这是我的亚军

```
public class TestRunner extends BlockJUnit4ClassRunner
{
    public TestRunner(Class<?> klass) throws InitializationError
    {
        super(klass);
    }

    @Override
    public void run(RunNotifier notifier)
    {
        notifier.addListener(new TestLogger());   // THIS IS THE IMPORTANT LINE
        super.run(notifier);
    }
} 
```

这是我实际的junit测试

```
@RunWith(TestRunner.class)           // THIS LINE IS ALSO IMPORTANT
public class MyTest1
{
    @Test
    public void Test1() throws Exception
    {
        if (Math.random() < .5) throw new Exception("ouch");
        assertFalse(Math.random() < .5);
    }
} 
```

您可以使用 Eclipse 中的上下文菜单运行 MyTest1 或 Test1 方法，它将像您期望的那样调用 testLogger。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-05T11:53:00.823

我对此做了更多的研究。据我现在所见，JUnit 在 Eclipse 中运行也无法添加运行侦听器。

# r - 在 R 中绘制年度计划

> ID：10537500
> 
> 赞同：6
> 
> 时间：2012-05-10T15:37:19.267
> 
> 标签：r, ggplot2

我一直在尝试将[自己关于绘制甘特图的答案](https://stackoverflow.com/questions/10489411/how-to-modify-my-r-code-to-plot-this-kind-of-gantt-chart/10490267#10490267)扩展到更一般的情况。我在这里说明部分结果：

![R中的年度计划者](../Images/58a977dc7b2f9a2e09cd45e30c4bc318.png)

此图表上绘制了许多行程，红点代表出发，绿点代表返回。现在这是我的挑战：

1.  我想用灰色点标记离开和返回之间的所有日子，而其他所有日子都保持不变。
2.  我希望这些点能够正确地围绕不同的月份长度（例如，6 月 28 日的出发日期将标记为 6 月 30 日，然后围绕到 7 月 1 日）。
3.  在一日游的情况下，脚本不应失败（例如，9 月初的旅行，出发和返回发生在同一天，较小的绿点绘制在较大的红色标记上）。

用下面的代码生成这个图表很简单，很容易用一条从红到绿的线连接点，这两个点都发生在同一个月。任何人都可以以足以承担闰年和非闰年等的一般方式来帮助解决环绕的情况吗？

```
library("ggplot2")

# ----------------
# LOAD DATA

df <- read.table(text='id,dep_month,dep_day,ret_month,ret_day
c,1,5,1,16
v,2,1,2,6
a,3,28,3,31
z,4,9,4,11
y,4,25,5,3
f,6,28,7,7
w,8,19,8,29
b,9,9,9,9
k,9,29,10,6
n,11,20,12,3', header = TRUE,
                 sep = ',')

# ----------------
# DRAW YEAR CHART

p <- ggplot(data = df,
            aes(x = dep_day,
                y = dep_month
                )
            )
p <- p + theme_bw()
p <- p + geom_point(colour = 'red',
                    size = 6)
p <- p + geom_point(aes(x = ret_day,
                       y = ret_month
                       ),
                   colour = 'green',
                   size = 4
                    )
p <- p + scale_x_continuous( breaks = c(1:31) )
p <- p + scale_y_reverse( breaks = c(1:12) )
p <- p + ylab("Month") + xlab("Day")
print(p) 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-10T19:45:35.313

可能不是完美的解决方案，但是当您使用`date`对象时，想法会变得容易得多：

```
# using your data.frame
# create date object using the dep_month, dep_day etc columns
df$dep.date = as.Date(paste('2012', df$dep_month, df$dep_day, sep='-'))
df$ret.date = as.Date(paste('2012', df$ret_month, df$ret_day, sep='-'))

# calculate the dates for the gray data points between departure and return
# there is probably a more R'ish ways, than a for loop
days <- NULL
for(i in seq(1, nrow(df))){
    tmp <- seq.Date(df[i,]$dep.date, df[i,]$ret.date, by='days')
    days <- rbind(days,
        data.frame(day = as.POSIXlt(tmp)$mday,
            mon = as.POSIXlt(tmp)$mon+1))
}

# plot it
p <- ggplot( days, aes(day, mon)) + geom_point(colour='gray66') + theme_bw() +
 geom_point(data = df, aes(dep_day, dep_month), colour = 'red', size = 6) +
 geom_point(data = df, aes(ret_day, ret_month ),
               colour = 'green', size = 4 )  +
 scale_x_continuous( breaks = c(1:31) ) +
 scale_y_reverse( breaks = c(1:12) ) +
 ylab("Month") + xlab("Day")
print(p) 
```

![在此处输入图像描述](../Images/c52617568f7b002b825a5964a60c3db2.png)

# coldfusion - 在不知道服务器时间的情况下如何使用 DateDiff？

> ID：10537503
> 
> 赞同：2
> 
> 时间：2012-05-10T15:37:38.350
> 
> 标签：coldfusion, coldfusion-9

我在这里在 CF 中解决了一个难题。

您有一个时间戳作为参数传递给服务器。例如`2012-5-10 14:55`. 您如何查看从给定的时间是否已经过去了 30 秒并返回`true`or `false`？

规则：

1.  您不能使用当前服务器时间来检查是否已经过了 30 秒，因为时间戳来自世界上的任何地方并且总是错误的。

2.  在这种情况下，您始终可以信任传递给服务器的参数时间戳。

在 ColdFusion 9 中这怎么可能（如果有的话）？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-10T15:59:26.383

嗯....你的问题是你不知道延迟。您可以从*收到时间戳*开始计算 30 秒- 但这可能是创建时间戳之后的几秒钟。

你可以很容易地数 30 秒...

```
sleep(30000); //1000 miliseconds = 1 second. 30k = 30 seconds 
```

因此，一旦您获得 var，您就可以“等待”三十秒，然后执行某些操作。但是从您的问题来看，您似乎需要从创建时间戳（在客户端上创建）开始精确 30 秒。你可能不能那么准确，因为：

1.  2个时钟不同步
2.  您无法弄清楚请求的延迟。
3.  即使可以，由于您无法控制客户端，因此您将难以*保证*结果，因为 HTTP 是无状态的且不是实时的。

如果您可以指定一个 HTML5 浏览器，您可以为此使用 websockets - 它实际上是在乞求它:) 但这是我能想到的唯一真正的解决方案。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-10T23:32:03.550

您不指定传递给服务器的参数是API请求，表单提交还是ajax请求等，因此另一端的实现会有所不同。但是ColdFusion服务器端应该是极其相似的，基本上绑定了3个问题；时区、时间差异和延迟。

要解决时区问题，您可以要求将参数作为 UTC 时间传递。在将时间与 Coldfusion 进行比较时，您会执行以下操作：

```
<cfif DateDiff("s", Variables.PassedTimestamp, DateConvert( "Local2UTC", Now() )) EQ 30>
  <!--- Exactly 30 seconds difference between timestamps --->
</cfif> 
```

但是您不知道发送给您的时间是否与您服务器上的时间同步。为了帮助解决这个问题，您可以为另一端提供一种方法来查询您的时间并相应地调整他们的时间，或者用他们自己的时间回显您的时间。

该时间同步和最初讨论的时间戳发送都将受到延迟的影响。网络上的任何通信都会受到延迟的影响，只是延迟程度不同。位置和 Internet 连接类型比协议类型的影响更大。您可以执行类似 ping 另一端的操作以获取响应时间，然后将其减半并将其添加到时间戳中，但这仍然是一个近似值，并非所有服务器都会响应 ping。

此外，您的服务器和另一端的代码也会引入延迟。为了减少这种情况，您希望另一端尽可能接近请求结束时计算时间戳，并让您的代码尽快计算时间戳。这可以通过 ColdFusion 完成，方法是将请求时间设置为尽可能靠近 Application.cfm|cfc 的顶部。

```
<cfset Request.Now = Now()> 
```

然后将检查代码更改为：

```
DateDiff("s", Variables.PassedTimestamp, DateConvert( "Local2UTC", Request.Now )) 
```

相反，如果您想要循环直到 30 秒过去然后响应，请注意您的响应似乎不会在 30 秒后发生，因为延迟会延迟响应返回到另一端。

精确到 30 秒是不可能的，但你会采取一些措施让你更接近。如果您只需要查看是否已经过了大约 30 秒，那么这就足够了。

# c# - 从子窗口上的按钮单击事件更新主页上的列表框。

> ID：10537507
> 
> 赞同：0
> 
> 时间：2012-05-10T15:37:47.743
> 
> 标签：c#, silverlight, listbox, refresh, childwindow

我有一个包含列表框的主页。

当用户从列表框中选择配置文件时，会打开一个名为 的子窗口`pWindow`。此窗口作为通过打开另一个名为 的确认窗口的超链接按钮删除当前配置文件的选项`dprofile`。

我的问题是，一旦用户确认删除他们所在的当前配置文件，并在按钮单击确认它，`dProfile`我如何更新第一个主页中的 listBox 以便列表不再包含已删除的profile （目前没有这样做。

在`dProfile`窗口中我创建了一个事件 -

```
public event EventHandler SubmitClicked; 
```

在确定按钮的位置单击我有-

```
private void OKButton_Click(object sender, RoutedEventArgs e)
{
  if (SubmitClicked != null)
  {
      SubmitClicked(this, new EventArgs());
  }
} 
```

所以在主页上我添加了 -

```
private void deleteProfile_SubmitClicked(object sender, EventArgs e)
    {
        WebService.Service1SoapClient client = new WebService.Service1SoapClient();

        listBox1.Items.Clear();
        client.profileListCompleted += new EventHandler<profileListCompletedEventArgs>(client_profileListCompleted);
        client.profileListAsync(ID);
    } 
```

我认为这可能已经更新了列表框，因为它在`dProfile`表单中得到了确认，但是当表单关闭时，列表框保持不变，我必须手动刷新网页才能看到更新。我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-10T16:33:09.863

如果我理解正确，那么您有三页。Main、pWindow 和 dProfile。[早些时候](https://stackoverflow.com/questions/10535987/close-previous-window-from-current-window)，您试图从 dProfile 关闭 pWindwow 并且工作正常。现在您要刷新主页上的 listBox1。
为此，您可以遵循类似的策略。您可能正在从主页面打开 pWindow，其中包含以下行

```
pWindow pWin = new pWindow();
pWin.Show(); 
```

现在您可以在 pWindow 类中定义一个新事件。

```
public event EventHandler pWindowRefeshListBox; 
```

然后在 deleteProfile_SubmitClicked 的事件处理程序中，您可以引发事件以刷新 listbox1，如下行：

```
private void deleteProfile_SubmitClicked(object sender, EventArgs e)
{
    if(pWindowRefreshListBox != null)
        pWindowRefreshListBox(this, new EventArgs());
    this.Close();
} 
```

然后在您的主页中针对您之前定义的 pWin 对象注册事件。

```
pWin.pWindowRefreshListBox += new new EventHandler(pWindow_pWindowRefreshListBox); 
```

然后在主页中定义事件。

```
private void pWindow_pWindowRefreshListBox(object sender, EventArgs e)
{
    listBox1.Items.Clear();
} 
```

这应该刷新列表框。我没有测试代码或语法。因此，您可以在实施之前对其进行检查。

**编辑**
您可以将 dProfile 中的事件定义为静态

```
public static event EventHandler SubmitClicked; 
```

然后您将能够在 Main 和 pWindow 中针对 Class Name 注册它

```
dProfile.SubmitClicked += new .............. 
```

然后相应地实现它，在 pWindow 中，关闭窗口并在主刷新列表框中

**编辑：**
您可以在主页上创建 deleteProfile 实例，在您的主页面中注册以下内容

```
deleteProfile.SubmitClicked += new EventHandler(deleteProfile _SubmitClicked) 
```

这应该工作

# javascript - 使用自定义 Javascript 绑定在 Python 中嵌入 Gecko

> ID：10537508
> 
> 赞同：1
> 
> 时间：2012-05-10T15:37:55.650
> 
> 标签：javascript, python, embed, gecko

是否可以在 Python 中嵌入 Gecko，以便我可以显示 HTML 文档。然后可能创建自定义 Javascript 绑定，以便我可以在 HTML 文档中调用我自己的 Javascript 函数，这些函数将执行一些浏览器通常不允许的任务，例如进行系统调用。这将由底层 python 程序完成。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-10T16:21:53.997

实际上，有多种方法可以做到这一点。首先，您是否正在使用另一个 GUI 库（例如 wxPython、Tkinter、PyGTK 等）并且您想将 Gekco 嵌入到您在其中一个框架中创建的窗口中？即，您是否尝试将 Gecko 框架嵌入到 Tkinter（或 wxPython，或 PyGTK，或...）窗口中？

**仅**将 Gecko 用于 GUI是否可行？如果是这样，您可能想看看[XUL (and xulrunner)](https://developer.mozilla.org/en/XUL)。Gecko 可以通过 XPCOM 与外界交互，并且 Python 与 XPCOM 有一些集成（参见[Google Code 中的 pythonext](http://code.google.com/p/pythonext/)）。因此，可以编写一个混合应用程序，其中 UI 元素在 XUL 中使用活动 javascript 进行描述，并且信号被发送到 UI 和您的 python 代码（在本地运行并且可以执行任意系统调用等）。

沿着同样的思路，但更简单一些，您可以创建一个 python 脚本来启动一个 xulrunner 应用程序和一个本地运行的网络服务器。xulrunner 应用程序托管 GUI 以及活动的 javascript 代码，而本地运行的网络服务器执行任意 python 代码（包括本地系统调用）。我已经多次使用（“包括电池”）BaseHTTPServer 来做类似的事情，我相信你会发现这样做相对简单。

# android - Json MySql 得到两个整数和一个字符串

> ID：10537511
> 
> 赞同：0
> 
> 时间：2012-05-10T15:38:02.683
> 
> 标签：android, mysql, json, object, methods

这是我获取 JSON 对象的类。在这段代码中，我只得到一个对象，我真的不知道如何从该方法返回，有一个 Protected Void 方法，它是一个调用的 settext 方法，并且是唯一的 JSON 对象所在的位置。

```
public class ConnectMySql extends Activity {

 TextView httpStuff;
 HttpClient client;
 JSONObject json;

 final static String URL = "http://79.114.48.119/RadarsMySql.php";

 @Override
 protected void onCreate(Bundle savedInstanceState) {
    // TODO Auto-generated method stub
    super.onCreate(savedInstanceState);
    setContentView(R.layout.main);
    httpStuff = (TextView) findViewById(R.id.tvHttp);
    client = new DefaultHttpClient();
    new Read().execute("latitude");
}

public JSONObject lastTweet(String username) throws ClientProtocolException, IOException,JSONException{
    StringBuilder url = new StringBuilder(URL);
    url.append(username);

    HttpGet get = new HttpGet(url.toString());
    HttpResponse r = client.execute(get);
    int status = r.getStatusLine().getStatusCode();
    //if(status == 200){
        HttpEntity e = r.getEntity();

        String data = EntityUtils.toString(e);
        data = data.substring(data.indexOf("["));

        JSONArray timeline = new JSONArray(data);
        JSONObject last = timeline.getJSONObject(0);
        return last;

    //}else{ 
        //Toast.makeText(ConnectMySql.this, "error", Toast.LENGTH_LONG);
        //return null;

    //}
}

public class Read extends AsyncTask<String, Integer, String>{

    @Override
    protected String doInBackground(String... params) {
        // TODO Auto-generated method stub
        try {
            json = lastTweet("");
            return json.getString(params[0]);
        } catch (ClientProtocolException e) {
            // TODO Auto-generated catch block
            e.printStackTrace();
        } catch (IOException e) {
            // TODO Auto-generated catch block
            e.printStackTrace();
        } catch (JSONException e) {
            // TODO Auto-generated catch block
            e.printStackTrace();
        }
        return null;
    }

    @Override
    public void onPostExecute(String result) {
        // TODO Auto-generated method stub
        httpStuff.setText(result);
        int myNum = 0;

        try {
            myNum = Integer.parseInt(result);
            httpStuff.setText(myNum);
        } catch(NumberFormatException nfe) {
           System.out.println("Could not parse " + nfe);
        } 
    }

}

} 
```

**我想要做的是有一个数组，我可以在其中存储三种对象（例如纬度 [1]、经度 [1]、描述 [​​1]；纬度 [2] 等...我想要纬度和经度作为整数）。在此之后，我将使用 for 循环来调用具有这 3 个参数的函数。任何人都可以帮助我或者可以给我一些提示吗？谢谢！**

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-11T12:12:44.293

不要使用 AsyncTask，因为它在后台执行，这就是为什么它会给你带来一些问题。

当你的 twitter arser 工作时，将它集成到 AsyncTask 中。下面的代码未经测试。

```
 public class ConnectMySql extends Activity {

 TextView httpStuff;
 HttpClient client;
 int i;
 JSONObject json;

 final static String URL = "http://localhost/RadarsMySql.php";

 @Override
 protected void onCreate(Bundle savedInstanceState) {
    // TODO Auto-generated method stub
    super.onCreate(savedInstanceState);
    setContentView(R.layout.main);
    httpStuff = (TextView) findViewById(R.id.tvHttp);
    client = new DefaultHttpClient();
    for(i=0;i<2;i++){
    new Read().execute("latitude");

        try {
            json = lastTweet("",i);

            String result = json.getString(params[i]);

         httpStuff.setText(result);
            int myNum = 0;

            try {
                myNum = Integer.parseInt(result);
                httpStuff.setText(myNum);
            } catch(NumberFormatException nfe) {
               System.out.println("Could not parse " + nfe);
            } 

        } catch (ClientProtocolException e) {
            // TODO Auto-generated catch block
            e.printStackTrace();
        } catch (IOException e) {
            // TODO Auto-generated catch block
            e.printStackTrace();
        } catch (JSONException e) {
            // TODO Auto-generated catch block
            e.printStackTrace();
        }

    }
}

public JSONObject lastTweet(String username,int i) throws ClientProtocolException, IOException,JSONException{
    StringBuilder url = new StringBuilder(URL);
    url.append(username);

    HttpGet get = new HttpGet(url.toString());
    HttpResponse r = client.execute(get);
    int status = r.getStatusLine().getStatusCode();
    //if(status == 200){
        HttpEntity e = r.getEntity();

        String data = EntityUtils.toString(e);
        data = data.substring(data.indexOf("["));

        JSONArray timeline = new JSONArray(data);
        JSONObject last = timeline.getJSONObject(i);
        return last;

    //}else{ 
        //Toast.makeText(ConnectMySql.this, "error", Toast.LENGTH_LONG);
        //return null;

    //}
}

} 
```

# javascript - 当我单击“保存”按钮时如何阻止 Jquery.TinyMCE 提交

> ID：10537513
> 
> 赞同：2
> 
> 时间：2012-05-10T15:38:09.780
> 
> 标签：javascript, jquery, tinymce

每当我单击 Tinymce Editor 的保存按钮时，表单都会提交到服务器。我需要停止表单提交。我搜索了很多，但找不到任何解决方案。这是我的代码，

```
$('textarea.tinymce').tinymce({
    paste_retain_style_properties : "margin, padding, width, height, font-size, font-weight, font-family, color, text-align, ul, ol, li, text-decoration, border, background, float, display",
    script_url : path_global+'/js/TinyMCE/tiny_mce.js',
    valid_children : "+body[style]",
    theme : "advanced",
    plugins : "pagebreak,style,layer,table,save,advhr,advimage,advlink,emotions,iespell,inlinepopups,insertdatetime,preview,media,searchreplace,print,contextmenu,paste,directionality,fullscreen,noneditable,visualchars,nonbreaking,xhtmlxtras,template",
    theme_advanced_buttons1 : "save,newdocument,|,bold,italic,underline,strikethrough,|,justifyleft,justifycenter,justifyright,justifyfull,styleselect,formatselect,fontselect,fontsizeselect",
    theme_advanced_buttons2 : "cut,copy,paste,pastetext,pasteword,|,search,replace,|,bullist,numlist,|,outdent,indent,blockquote,|,undo,redo,|,link,unlink,anchor,image,cleanup,help,code,|,insertdate,inserttime,preview,|,forecolor,backcolor",
    theme_advanced_buttons3 : "tablecontrols,|,hr,removeformat,visualaid,|,sub,sup,|,charmap,emotions,iespell,media,advhr,|,print,|,ltr,rtl,|,fullscreen",
    theme_advanced_buttons4 : "insertlayer,moveforward,movebackward,absolute,|,styleprops,|,cite,abbr,acronym,del,ins,attribs,|,visualchars,nonbreaking,template,pagebreak",
    theme_advanced_toolbar_location : "top",
    theme_advanced_toolbar_align : "left",
    theme_advanced_statusbar_location : "bottom",
    theme_advanced_resizing : true,
     setup : function(ed) {         
      ed.onSaveContent.add(function(ed, l) {
       });
  }
}); 
```

**更新：** 我找到了答案。深入研究源代码，我发现我可以在表单标签上添加 onsubmit = "return false" ，这将阻止表单提交。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-23T08:43:50.403

我找到了答案。挖掘我发现我可以添加的源代码，

```
onsubmit = "return false" 
```

在表单标签上，这将阻止表单提交。

# android - 服务器通信的最佳方法是什么？

> ID：10537517
> 
> 赞同：0
> 
> 时间：2012-05-10T15:38:20.643
> 
> 标签：android, performance, http, tcp

我的应用程序与服务器进行了很多通信 - 正在发送和接收大量数据。我的问题是，我真的应该对所有请求使用 HttpConnection 还是使用某种 TCP 请求？我在文档中的某处（无法再次找到）阅读了有关 TCP 的内容，并且 TCP 通常更有效。

我在每个服务器调用上发送大约 100-400kb 的文件。

我也不确定在我的服务器上使用一个与另一个的服务器副作用？我的意思是应用程序客户端可能会使用 HttpConnection 更快地工作，但这对服务器来说更有效吗？从长远来看，当不只是进行一次调用时，使用服务器的正确方法是什么？

我找到了关于这个主题的少量信息，希望你们能帮助我。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-10T15:48:01.303

正确的方法是使用其中一个`HttpClient`或`URLConnection`类。这两个`HttpClient`更容易使用。如果您发现这些类在某种程度上不足，您将使用其他东西，例如原始套接字，但这不太可能。

# java - 如何在 Windows 7 64 位上安装 JOGL 以与 Eclipse 一起使用？

> ID：10537520
> 
> 赞同：6
> 
> 时间：2012-05-10T15:38:22.937
> 
> 标签：java, eclipse, jogl

我尝试遵循任意数量的[教程](http://schabby.de/jogl-example-hello-world/)：

但我仍然无法让 eclipse 识别我的任何导入语句：

```
import net.java.games.jogl.Animator;
import net.java.games.jogl.GL;
import net.java.games.jogl.GLCanvas;
import net.java.games.jogl.GLCapabilities;
import net.java.games.jogl.GLDrawable;
import net.java.games.jogl.GLDrawableFactory;
import net.java.games.jogl.GLEventListener; 
```

话虽如此，教程和我能够做的事情似乎总是有所不同（即不同的文件、不同的包、不同的步骤等）。

[本教程](https://sites.google.com/site/sites/system/errors/WebspaceNotFound?path=/justinscsstuff/jogl-tutorial-1)将 JOGL 安装为我喜欢的用户库，但引用了我在找到的 JOGL 下载中找不到的文件（nativewindow.all.jar、newt.all.jar）。它还谈到了下载 help.txt 和 wiki 状态已弃用且不应使用的引用 .dll 文件。话虽如此，我尽我所能（使用 wiki 中提到的文件）按照说明进行操作，但它仍然不起作用。

[官方 wiki](https://jogamp.org/wiki/index.php/Downloading_and_installing_JOGL)谈到为不同系统下载不同的软件包，但现在它们似乎都捆绑到一个“jogamp-all-platforms.7z”文件中。它说您需要的文件是：“gluegen-rt.jar、jogl.all.jar、gluegen-java-src.zip、jogl-java-src.zip、gluegen-rt-natives-windows-amd64.jar、jogl -all-natives-windows-amd64.jar”，但它并没有说明你应该对它们做什么。（我在构建路径中引用了它们，但它没有用）。

无论如何，我可能正在做一些非常愚蠢的事情，但不确定是什么。

有人可以逐步提供有关如何将 JOGL 添加到我的 Eclipse 项目中的新手证明说明吗？

编辑****这是我的项目属性窗口的图像： [![我的项目属性窗口](../Images/8750d8f8c7f8ae071a1fd6c86a43885f.png)](https://i.stack.imgur.com/W2YHy.png)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-18T17:47:31.630

用户库 JOGL 很好。但是，您在 GameTutorials/lib 下再次复制它。我认为这告诉 jogl 不要再往下看。尝试删除 GameTutorials/lib 下的 jogl jar 文件，但保留 jogl 用户库下的 jogl jar 文件。那应该可以正常工作。

# asp.net - 使用 ajax 更新时，ASP.Net 下拉列表未传递值

> ID：10537522
> 
> 赞同：0
> 
> 时间：2012-05-10T15:38:26.643
> 
> 标签：asp.net, ajax

我有一些 jQuery 用于打开一个弹出窗口，可以在其中将新的发货人添加到数据库中。原始窗口有一个包含所有当前发货人的下拉列表。当您在弹出窗口中添加新发货人时，该窗口将关闭，然后原始窗口重新加载下拉列表的数据并选择刚刚创建的数据。

所有这些都完美无缺。我的问题是，当您填写表单的其余部分并提交时，它会传递一个空字符串而不是所选项目的值。这是因为它是 ASP.Net 脚本吗？我对 ASP.Net 了解不多，但我从来没有遇到过 PHP 的这个问题。有人可以解释我如何在不刷新整个页面的情况下刷新下拉列表，并且仍然让列表在提交表单时传递它的值吗？

我在打开弹出窗口并重新加载列表的页面上的 javascript 代码如下：

```
function openConsignorAdd() {
    var url;
    url = "/admin/consignor/csAdd.aspx";
    window.open(url, "WizardWindow", "width=400,height=500,resizable=yes,scrollbars=yes");
}

function loadNewAdded(fn, cs_txt_id) {
    //    var pagePath = window.location.pathname;
    var pagePath = "/admin/getNewList.asp";
    var paramList = "data=";

    //Call the page method
    $.ajax({
        type: "POST",
        url: pagePath + "?type=" + fn + "&cs_txt_id=" + cs_txt_id,
        data: paramList,
        success: function (data) {
            //create jquery object from the response html
            var $response = $(data);
            //query the jq object for the values
            var results = $response.filter('select#results').html();

            if (fn == "consignor") {
                $("select#<%=itemConsigner.ClientID%>").html(results);
            } else if (fn == "cdr") {
                $("select#<%=itemCDR.ClientID%>").html(results);
            }
        },
        error: function () {
            alert("Failed To Refresh!\n\nYou must manually refresh the page.");
        }
    });
} 
```

我在弹出页面上刷新列表的 javascript 代码是：

```
function refreshOpener(cs_txt_id) {
    window.opener.loadNewAdded("consignor", cs_txt_id);
} 
```

这两个都有效。为了获得我的下拉列表的值，我只需使用：

```
if (itemConsigner.SelectedValue.ToString() != string.Empty)
{
    itemCsTxtId = itemConsigner.SelectedValue.ToString();
} 
```

我的下拉列表是：

```
<asp:DropDownList ID="itemConsigner" runat="server" TabIndex="1"></asp:DropDownList> 
```

如果您需要更多信息，请告诉我。任何帮助表示赞赏。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-31T13:25:47.217

似乎问题在于，由于我在页面加载后进行更改，服务器没有将我的新添加视为原始选项之一，因此完全忽略了它。这很好，所以我猜人们不能只编辑您的表单。所以我所做的不是获取 的值，而是使用长 ID`itemConsigner.SelectedValue`获取值。`Request.Form["itemConsigner"]`这样它就不会验证我提交的选项是原始选项。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-10T18:16:55.257

可能是一个愚蠢的观察，但没有所有代码，我不确定是否是这种情况。您是否只是使用选择选项中的 id 更新原始列表。还需要为每个填充值。这可能就是为什么您在提交表单后得到一个空值的原因。

# ios - iOS SIGKILL 使用带有无趣回溯的 iOS 4.3 模拟器

> ID：10537525
> 
> 赞同：2
> 
> 时间：2012-05-10T15:38:29.863
> 
> 标签：ios, crash, ios-simulator, sigkill

“只管我自己的事，iOS 应用程序在模拟器中运行。没有做任何非常有趣的事情……只是在视图控制器之间移动……然后暂停……然后 KABLAMMO！”

我立即查看了所有线程的回溯（见下文），但我没有看到任何特别重要的事情：

```
(gdb) t a a bt

Thread 10 (process 55348):
#0  0x9046e02e in __workq_kernreturn ()
#1  0x9ac98ccf in _pthread_wqthread ()
#2  0x9ac9a6fe in start_wqthread ()

Thread 9 (process 55348):
#0  0x9046bc22 in mach_msg_trap ()
#1  0x9046b1f6 in mach_msg ()
#2  0x0228ad86 in __CFRunLoopServiceMachPort ()
#3  0x021e7e74 in __CFRunLoopRun ()
#4  0x021e7840 in CFRunLoopRunSpecific ()
#5  0x021e7761 in CFRunLoopRunInMode ()
#6  0x016186cc in TileCachePrivate::runCacheThread ()
#7  0x01618702 in _runCacheThread ()
#8  0x9ac96ed9 in _pthread_start ()
#9  0x9ac9a6de in thread_start ()

Thread 7 (process 55348):
#0  0x9046db42 in select$DARWIN_EXTSN ()
#1  0x0221c2bc in __CFSocketManager ()
#2  0x9ac96ed9 in _pthread_start ()
#3  0x9ac9a6de in thread_start ()

Thread 6 (process 55348):
#0  0x9046bc22 in mach_msg_trap ()
#1  0x9046b1f6 in mach_msg ()
#2  0x0228ad86 in __CFRunLoopServiceMachPort ()
#3  0x021e7e74 in __CFRunLoopRun ()
#4  0x021e7840 in CFRunLoopRunSpecific ()
#5  0x021e7761 in CFRunLoopRunInMode ()
#6  0x0076a102 in +[NSURLConnection(NSURLConnectionReallyInternal) _resourceLoadLoop:] ()
#7  0x00734cf4 in -[NSThread main] ()
#8  0x00734c80 in __NSThread__main__ ()
#9  0x9ac96ed9 in _pthread_start ()
#10 0x9ac9a6de in thread_start ()

Thread 4 (process 55348):
#0  0x9046bc22 in mach_msg_trap ()
#1  0x9046b1f6 in mach_msg ()
#2  0x0228ad86 in __CFRunLoopServiceMachPort ()
#3  0x021e7e74 in __CFRunLoopRun ()
#4  0x021e7840 in CFRunLoopRunSpecific ()
#5  0x021e7761 in CFRunLoopRunInMode ()
#6  0x034ef903 in RunWebThread ()
#7  0x9ac96ed9 in _pthread_start ()
#8  0x9ac9a6de in thread_start ()

Thread 3 (process 55348):
#0  0x9046e90a in kevent ()
#1  0x01f32f36 in _dispatch_mgr_invoke ()
#2  0x01f33333 in _dispatch_queue_invoke ()
#3  0x01f33593 in _dispatch_worker_thread2 ()
#4  0x9ac98b24 in _pthread_wqthread ()
#5  0x9ac9a6fe in start_wqthread ()

Thread 1 (process 55348):
#0  0x9046bc22 in mach_msg_trap ()
#1  0x9046b1f6 in mach_msg ()
#2  0x0228ad86 in __CFRunLoopServiceMachPort ()
#3  0x021e7e74 in __CFRunLoopRun ()
#4  0x021e7840 in CFRunLoopRunSpecific ()
#5  0x021e7761 in CFRunLoopRunInMode ()
#6  0x025861c4 in GSEventRunModal ()
#7  0x02586289 in GSEventRun ()
#8  0x009d8c93 in UIApplicationMain ()
#9  0x0007682d in main (argc=1, argv=0xbffff510) at /path/to/app/source/Classes/main.m:14
(gdb) 
```

（注意：在 Debug Navigator 中，线程 7 被列为 com.apple.CFSocket.private，线程 4 被列为 WebThread。）

我想操作系统杀死了我的应用程序，但我不知道为什么。

内存使用过多？好吧，我们在模拟器中（但是，是的，我对此已经很谨慎了——在调试期间也没有发现内存警告）。

阻塞主线程？嗯……我不知道！当它发生时，UI 似乎反应灵敏。

运行日志中有什么有趣的东西吗？不...而是每天发生的事情，但仅此而已。:\

进一步的见解和想法表示赞赏！

有关类似（相同？）的问题，请参见此[问题。](https://stackoverflow.com/questions/10324241/mysterious-sigkill-in-ipad-application-running-in-the-simulator)

# jsp - 编码设置为“ISO-8859-1”可以显示汉字

> ID：10537526
> 
> 赞同：2
> 
> 时间：2012-05-10T15:38:35.600
> 
> 标签：jsp, servlets, encoding

我正在开发一个 MVC Web 应用程序。我有一个关于这个应用程序如何显示中文字符的问题，即使所有页面的编码都设置为“ISO-8859-1”？我以为 ISO-8859-1 不支持汉字。

谢谢，

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-10T16:00:05.730

# action - 是否有其他人在使用新操作链接时遇到问题

> ID：10537529
> 
> 赞同：1
> 
> 时间：2012-05-10T15:38:46.893
> 
> 标签：action, facebook-opengraph

我按照此处创建操作链接的指南：[https](https://developers.facebook.com/docs/opengraph/actionlinks/) ://developers.facebook.com/docs/opengraph/actionlinks/ 但是，当我使用我创建的新 facebook 应用程序测试它们时，它没有显示测试操作链接. 制作这些作品是否有一些秘诀未包含在指南中，或者我只是很不走运？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-16T20:08:35.747

Jesse，非 https 操作链接仍应对开发人员可见，并在链接本身上显示错误消息。

# json - 用于转换 JSON 对象的 node.js 模板

> ID：10537533
> 
> 赞同：5
> 
> 时间：2012-05-10T15:38:59.753
> 
> 标签：json, template-engine

我想在 JSON 对象中使用一些表达式语言。假设我有一个“模板”，例如：

```
jsonTemplate = {
    title:"Title: '#{title}',
    header: "Created by #{meta.author} at #{meta.createdAt}"
} 
```

和实际数据如下：

```
data = {
    title: "Some title",
    content:"bla...",
    meta: {createdAt:new Date(), author:"me"}
} 
```

我想做类似的事情

```
parser.render(jsonTemplate, data); 
```

返回

```
{
    title:"Title: 'Some title'",
    header: "Created by me at 2012-05-10 10:00:00"
} 
```

所有的模板引擎都专注于 html 生成，但“渲染”步骤的结果应该是一个 json 对象。

有没有允许这样做的引擎？

如果没有，我将自己创建 json 对象并将现有引擎应用于单个属性。你会为此推荐一个引擎吗？

理想情况下，这应该以 node.js 模块或 common.js 的形式提供。

# java - Arraylist 用我添加的 lastValue 填充自己

> ID：10537536
> 
> 赞同：0
> 
> 时间：2012-05-10T15:39:15.363
> 
> 标签：java, arraylist

我有一个数组列表，由于某些原因，它会覆盖所有以前的值，并且只返回最后添加的值。所以我有 3 个对象要添加，数组中最后一个对象将是 3 倍。这是代码：（对不起，变量不是英文）：

```
public class Convertor {
ArrayList<ArrayList<String>> hervormen = new ArrayList<ArrayList<String>>();
String Voornaam;
public Convertor(ArrayList<ArrayList<String>> hervormen)
{
    this.hervormen=hervormen;
}
public ArrayList<HervormdeRij> Hervormen(){
    ArrayList<HervormdeRij> hervormd = new ArrayList<HervormdeRij>();
    HervormdeRij HervormdeRij = new HervormdeRij();
    int teller = 0;
    ArrayList<String> rij = new ArrayList<String>();
    while (teller < hervormen.size()){
        rij=    hervormen.get(teller);

        HervormdeRij.setDag(rij0(rij));
        HervormdeRij.setUur(rij1(rij));
        HervormdeRij.setDokterId(rij2DokterId(rij));
        HervormdeRij.setDuur(rij2Duur(rij));
        HervormdeRij.setAchternaam(rij5(rij));
        HervormdeRij.setVoornaam(Voornaam);
        HervormdeRij.setAdress(rij6(rij));
        HervormdeRij.setGemeente(rij7(rij));
        HervormdeRij.setTel(rij8(rij));
        HervormdeRij.setCommentaar(rij10(rij));
        HervormdeRij.setEmail(rij11(rij));

        hervormd.add(HervormdeRij);

        teller++;
    }

    return hervormd; 
```

所以“hervormd”始终是最后一个“HervormdeRij”的 2000 次（“hervormen”.size() 的数量）。我真的没有在我的代码中看到错误吗？（而且我 1000% 确定“hervormen”！= 2000 倍相同的值。）

提前致谢

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-10T15:42:03.773

您需要`HervormdeRij HervormdeRij = new HervormdeRij();`在循环内移动，否则每次都将继续添加相同的对象：

```
ArrayList<String> rij = new ArrayList<String>();
while (teller < hervormen.size()){
    HervormdeRij HervormdeRij = new HervormdeRij();
    rij=    hervormen.get(teller);
    ... 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-10T15:42:23.477

您只实例化一个`HervormedeRij`对象（在循环之前），并且每次都重用它。

所以你只需要移动这条线：

```
HervormdeRij HervormdeRij = new HervormdeRij(); 
```

循环内。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-10T15:42:52.913

您必须先初始化对象的新实例，然后再将其添加到数组中。另外，尽量不要用类名定义变量，我将`HervormdeRij`变量名改为`hervormdeRij`

```
public ArrayList<HervormdeRij> Hervormen(){
    ArrayList<HervormdeRij> hervormd = new ArrayList<HervormdeRij>();
    HervormdeRij hervormdeRij;
    int teller = 0;
    ArrayList<String> rij = new ArrayList<String>();
    while (teller < hervormen.size()){
        rij=    hervormen.get(teller);
        hervormdeRij = new HervormdeRij();
        hervormdeRij.setDag(rij0(rij));
        hervormdeRij.setUur(rij1(rij));
        hervormdeRij.setDokterId(rij2DokterId(rij));
        hervormdeRij.setDuur(rij2Duur(rij));
        hervormdeRij.setAchternaam(rij5(rij));
        hervormdeRij.setVoornaam(Voornaam);
        hervormdeRij.setAdress(rij6(rij));
        hervormdeRij.setGemeente(rij7(rij));
        hervormdeRij.setTel(rij8(rij));
        hervormdeRij.setCommentaar(rij10(rij));
        hervormdeRij.setEmail(rij11(rij));

        hervormd.add(HervormdeRij);
        teller++;
    }

    return hervormd;
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-05-10T15:43:50.573

*   重命名 as 以免与其他代码阅读混淆。 `HervormdeRij HervormdeRij = new HervormdeRij();`变成`HervormdeRij hr = new HervormdeRij();`.

*   将它移到你的`while()`循环中，这样每次通过，你都会得到 type 的新实例`HermorvdeRij`。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-05-10T15:46:58.917

尝试在每次迭代中实例化一个新的 HervormdeRij。所以它看起来像这样：

```
public ArrayList<HervormdeRij> Hervormen(){
    ArrayList<HervormdeRij> hervormd = new ArrayList<HervormdeRij>();
    HervormdeRij HervormdeRij;
    int teller = 0;
    ArrayList<String> rij = new ArrayList<String>();
    while (teller < hervormen.size()){
        HervormdeRij = new HervormdeRij();
        rij=    hervormen.get(teller);

        HervormdeRij.setDag(rij0(rij));
        HervormdeRij.setUur(rij1(rij));
        HervormdeRij.setDokterId(rij2DokterId(rij));
        HervormdeRij.setDuur(rij2Duur(rij));
        HervormdeRij.setAchternaam(rij5(rij));
        HervormdeRij.setVoornaam(Voornaam);
        HervormdeRij.setAdress(rij6(rij));
        HervormdeRij.setGemeente(rij7(rij));
        HervormdeRij.setTel(rij8(rij));
        HervormdeRij.setCommentaar(rij10(rij));
        HervormdeRij.setEmail(rij11(rij));

        hervormd.add(HervormdeRij);

        teller++;
    }
} 
```

# backbone.js - Sinon + Backbone 规范在 Jasmine Headless Webkit 下失败，但在独立 Jasmine 中通过

> ID：10537539
> 
> 赞同：6
> 
> 时间：2012-05-10T15:39:24.040
> 
> 标签：backbone.js, jasmine, sinon

我有一个 Backbone 集合规范（当然是 todos），它使用 Sinon 用夹具数据伪造服务器响应。这与独立的 Jasmine 一起通过，但在我的 Jasmine Headless Webkit 设置下失败。

失败是这样的：

```
Todos collection when fetching models from the server should parse todos from the response.

  Expected 0 to equal 2\. (line ~58)
    expect(this.todos.length).toEqual(this.fixture.response.todos.length); 
```

Sinon 和我的夹具正确地返回了一个带有 2 个 todo 的假响应，但集合中没有解析任何 todo。

有一个小提琴显示所有这些都与 Jasmine 独立工作[在这里](http://jsfiddle.net/kaL5d/)

我的 Jasmine Headless Webkit 加载顺序如下：

```
clyde:backbone-jasmine andy$ jasmine-headless-webkit -l
/Users/andy/.rbenv/versions/1.9.3-p0/lib/ruby/gems/1.9.1/gems/jasmine-core-1.1.0/lib/jasmine-core/jasmine.js
/Users/andy/.rbenv/versions/1.9.3-p0/lib/ruby/gems/1.9.1/gems/jasmine-core-1.1.0/lib/jasmine-core/jasmine-html.js
/Users/andy/.rbenv/versions/1.9.3-p0/lib/ruby/gems/1.9.1/gems/jasmine-core-1.1.0/lib/jasmine-core/jasmine.css
/Users/andy/.rbenv/versions/1.9.3-p0/lib/ruby/gems/1.9.1/gems/jasmine-headless-webkit-0.8.4/vendor/assets/javascripts/jasmine-extensions.js
/Users/andy/.rbenv/versions/1.9.3-p0/lib/ruby/gems/1.9.1/gems/jasmine-headless-webkit-0.8.4/vendor/assets/javascripts/intense.js
/Users/andy/.rbenv/versions/1.9.3-p0/lib/ruby/gems/1.9.1/gems/jasmine-headless-webkit-0.8.4/vendor/assets/javascripts/headless_reporter_result.js
/Users/andy/.rbenv/versions/1.9.3-p0/lib/ruby/gems/1.9.1/gems/jasmine-headless-webkit-0.8.4/vendor/assets/javascripts/jasmine.HeadlessConsoleReporter.js
/Users/andy/.rbenv/versions/1.9.3-p0/lib/ruby/gems/1.9.1/gems/jasmine-headless-webkit-0.8.4/vendor/assets/javascripts/jsDump.js
/Users/andy/.rbenv/versions/1.9.3-p0/lib/ruby/gems/1.9.1/gems/jasmine-headless-webkit-0.8.4/vendor/assets/javascripts/beautify-html.js
/Users/andy/.rbenv/versions/1.9.3-p0/lib/ruby/gems/1.9.1/gems/jquery-rails-2.0.2/vendor/assets/javascripts/jquery.js
/Users/andy/.rbenv/versions/1.9.3-p0/lib/ruby/gems/1.9.1/gems/jquery-rails-2.0.2/vendor/assets/javascripts/jquery_ujs.js
/Users/andy/.rbenv/versions/1.9.3-p0/lib/ruby/gems/1.9.1/gems/jasmine-core-1.1.0/lib/jasmine-core/json2.js
/Users/andy/.rbenv/versions/1.9.3-p0/lib/ruby/gems/1.9.1/gems/backbone-rails-0.9.2/vendor/assets/javascripts/underscore.js
/Users/andy/.rbenv/versions/1.9.3-p0/lib/ruby/gems/1.9.1/gems/backbone-rails-0.9.2/vendor/assets/javascripts/backbone.js
/Users/andy/.rbenv/versions/1.9.3-p0/lib/ruby/gems/1.9.1/gems/backbone-rails-0.9.2/vendor/assets/javascripts/backbone-rails.js
/Users/andy/Code/backbone-jasmine/app/assets/javascripts/app/collections/todos.js.coffee
/Users/andy/Code/backbone-jasmine/app/assets/javascripts/app/models/todo.js.coffee
/Users/andy/Code/backbone-jasmine/app/assets/javascripts/application.js
/Users/andy/.rbenv/versions/1.9.3-p0/lib/ruby/gems/1.9.1/gems/jasmine-spec-extras-0.0.2/vendor/assets/javascripts/jasmine-jquery.js
/Users/andy/.rbenv/versions/1.9.3-p0/lib/ruby/gems/1.9.1/gems/jasmine-spec-extras-0.0.2/vendor/assets/javascripts/sinon.js
/Users/andy/.rbenv/versions/1.9.3-p0/lib/ruby/gems/1.9.1/gems/jasmine-spec-extras-0.0.2/vendor/assets/javascripts/jasmine-sinon.js
/Users/andy/Code/backbone-jasmine/spec/javascripts/helpers/spec_helper.js.coffee
/Users/andy/Code/backbone-jasmine/spec/javascripts/helpers/valid_response.js.coffee
/Users/andy/Code/backbone-jasmine/spec/javascripts/fixtures/todos_fixture.js.coffee
/Users/andy/Code/backbone-jasmine/spec/javascripts/app/models/todo_spec.js.coffee
/Users/andy/Code/backbone-jasmine/spec/javascripts/app/collections/todos_spec.js.coffee 
```

和代码（当然也在小提琴中）：

```
# abbreviated todo model
class window.Todo extends Backbone.Model

# complete todos collection
class window.Todos extends Backbone.Collection
  model: window.Todo
  url: "/todos"
  comparator: (todo) ->
    todo.get('priority')
  parse: (res) ->
    res.response.todos

# spec/javascripts/fixtures/todos_fixture.js.coffee
beforeEach ->
  @fixtures = Todos:
    valid:
      status: "OK"
      version: "1.0"
      response:
        todos: [
          id: 1
          title: "Paint the fence"
        ,
          id: 2
          title: "Wash the dog"
         ]

# spec/javascripts/helpers/valid_response.js.coffee
beforeEach ->
  @validResponse = (responseText) ->
    [ 200, "Content-Type": "application/json",
      JSON.stringify responseText ]

# abbreviated todo spec (full spec in fiddle)
describe "Todos collection", ->

  describe "when fetching models from the server", ->
    beforeEach ->
      @todo = sinon.stub(window, "Todo")
      @todos = new Todos()
      @fixture = @fixtures.Todos.valid
      @server = sinon.fakeServer.create()
      @server.respondWith "GET", "/todos", @validResponse(@fixture)

    afterEach ->
      @server.restore()
      @todo.restore()

    it "should parse todos from the response", ->
      @todos.fetch()
      @server.respond()
      expect(@todos.length).toEqual @fixture.response.todos.length
      expect(@todos.get(1).get('title')).toEqual @fixture.response.todos[0].title 
```

正在使用的一些工具对我来说是新的，所以我非常感谢任何帮助 - 谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-07-12T05:32:57.733

也许在`server.respond()`. 你试过这个吗？

```
it "should parse todos from the response", ->
  @todos.fetch()
  @server.respond()
  waits 500
  runs ->
    expect(@todos.length).toEqual @fixture.response.todos.length
    expect(@todos.get(1).get('title')).toEqual @fixture.response.todos[0].title 
```

# asp.net - 当我引用 C++ DLL 时 ASP.NET 不调试 - 不会命中断点

> ID：10537540
> 
> 赞同：0
> 
> 时间：2012-05-10T15:39:24.887
> 
> 标签：asp.net

我的 ASP.NET 网页需要 C++ .NET DLL 提供的一些数据。就加载此 DLL 并首先在其中调用函数而言，一切似乎都工作正常，但现在我的项目似乎已经进入了一种状态，如果我在 .cs 文件中引用 DLL，它实际上并没有调试。

我注释掉了所有引用 DLL 的代码并从我的项目中删除了引用，它工作正常。我添加了对 DLL 的引用，它工作正常。我只取消了 DLL 命名空间的 using 语句（在本例中使用 MDnlnkCmdReader；），没有留下引用 DLL 的实际代码，现在，当我点击调试时，我的断点都没有命中。再次注释掉该行，断点再次命中。

当它进入网页似乎正确加载但没有断点命中的状态时，如果我切换回源代码并查看断点，它们会显示为带有警告标志的轮廓，如果我将鼠标悬停在它们上，然后它说“断点当前不会被命中。源代码与原始版本不同”

我也查看了该错误消息并尝试了通常的解决方案。如果我核对整个 /bin 文件夹，我就会开始收到有关 global.asax 的网络服务器错误消息。这些一直存在，直到我在任何 CPU 模式下构建（通常在 x64 中构建），此时我收到有关 DLL（在 x64 中构建）的“无法加载”消息。当我删除对它的引用时，页面会再次运行。切换回 x64 模式并重新添加引用，我就回到了我开始的地方。重新启动似乎也没有帮助。

任何想法这里发生了什么，以及如何摆脱它？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-11T15:42:16.003

好的，我想我现在已经弄清楚了。我一直在处理的实际上是两个不同的问题。

第一个问题是 ASP.NET 开发服务器似乎只愿意从项目`/bin`文件夹中获取其 DLL。*如果设置为Any CPU* ，您的项目将在那里构建，但如果设置为`x86`or `x64`，则默认为在`bin/x86/Debug`or中构建`bin/x64/Debug`。如果您设置为默认构建位置`x86`或`x64`使用默认构建位置，则开发服务器仍将尝试从文件夹的根目录中获取 DLL `/bin`。

如果您从未将项目构建为`Any CPU`，或者自上次以来已清理过该`/bin`文件夹，则它根本找不到您的 DLL，并且开发服务器将显示一条错误消息，例如“无法加载类型 'WebDownlink.全球的'。” 关于您的`Global.asax`文件（`WebDownlink`项目的名称空间在哪里）。这意味着它无法加载您的命名空间，这是因为它无法找到您的 DLL，因为它只在文件夹的根目录中查找`/bin`。

如果您已将项目构建为 as`Any CPU`然后切换到在`x86`or中构建它`x64`，那么您的新构建将位于适当的子目录中，但开发服务器仍会从您上次`Any CPU`构建中获取文件。但是，Visual Studio 调试器将使用您刚刚构建的文件，因此，如果您在上次`Any CPU`构建后更改了任何内容，您将收到不同的源代码错误，并且调试将无法正常工作。如果您没有更改任何内容，那么调试将起作用，但开发服务器仍将运行该`Any CPU`版本，如果您尝试做任何事关重要的事情，这可能会让您感到困惑。

对此的正确解决方案似乎是将您的`x86`模式配置为在文件夹的根`/bin`目录而不是文件夹中构建`/bin/x86/Debug`。或者，也许一开始就不要引用任何非托管 DLL。

这与第二个问题相吻合，即 ASP.NET 开发服务器仅在 32 位模式下运行，而 64 位系统上的[IIS](http://en.wikipedia.org/wiki/Internet_Information_Services)应用程序池仅在 64 位模式下运行（如果您知道一种方法更改其中任何一个，请让我知道）。如果您需要将代码链接到无法构建为的非托管 DLL，`Any CPU`则必须考虑到这一点。这就是为什么我只`x86`在上面提到的原因——改变你的构建位置是没有意义的，`x64`因为开发服务器无论如何都不会运行它。

幸运的是，我有我的代码引用的 DLL 的源代码，并且它不引用任何其他内容，因此我可以轻松地在 32 位和 64 位模式下构建它，以便在开发服务器和完整的 IIS 上运行它. 如果您引用的是无法重建的 32 位 DLL，那么您要么必须在 32 位机器上部署，要么想办法让 IIS 应用程序池以 32 位运行，而我做不到。吨。如果您的 DLL 是 64 位的并且无法重建，那么您只需在完整的 IIS 上对与它相关的代码进行所有调试。

所以我的解决方案是以 32 位构建我的 DLL，重置引用，然后以 32 位模式构建，输出路径设置为`/bin`. 当我想部署时，我在 64 位中重建 DLL，重置引用，在 64 位中构建项目，然后部署到 IIS。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-10T15:46:20.210

在调试时打开“模块”窗口并查看“路径”列 - 为您提供的程序集的路径是否与您**知道**与源代码匹配的程序集匹配？

[ASP.NET](http://en.wikipedia.org/wiki/ASP.NET)通常将程序集的副本放在“临时 ASP.NET 文件”文件夹中，因此您很可能也需要清除它。

请注意，您还可以取消选中“要求源文件与原始版本完全匹配”，只要源代码不*那么*远，您就可以进行调试。但是，最好还是解决根本问题（程序集与源不匹配）。

# drupal - 在 Drupal 7 中向节点作者发送电子邮件

> ID：10537552
> 
> 赞同：0
> 
> 时间：2012-05-10T15:40:04.257
> 
> 标签：drupal, drupal-7, drupal-modules

Drupal 7：我需要一个模块来将联系表单附加到特定内容类型的节点。该表单应该是可配置的，并允许向节点作者发送带有附件的电子邮件。该表格还应该有一个验证码。电子邮件不得保存在数据库中。

这样的模块存在还是我需要开发它？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-10T16:13:27.797

您应该能够通过 webform 模块、CAPTCHA 模块和自定义模块的组合来实现这一点。

Webform 定义了它自己的 'webform' 内容类型，但它也允许您通过访问 'admin/config/content/webform' 并选择适当的内容类型来启用其他内容类型的 webform。

令牌模块提供节点令牌，例如 nid 和标题，它们可以作为隐藏的表单元素包含在内，但令人讨厌的是，它不包括作者作为令牌。

在您的网络表单的电子邮件选项卡上，可以选择一个表单组件作为将表单结果发送到的电子邮件地址。我将创建一个隐藏字段，将默认值留空，然后使用 hook_form_alter 在自定义模块中将节点作者值添加到它应该相当容易（可以通过查看源代码并查找隐藏输入来找到表单 ID 'form_id '）。然后，您可以在电子邮件选项卡中使用此表单组件将结果发送到。

我能看到的唯一导致问题的是，没有一种简单的方法可以停止 webform 在数据库中记录表单结果 - 我想这在自定义模块中是可以实现的，但没有太多麻烦。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2015-09-04T14:39:43.137

是的，有这样一个模块。它被称为[Webform](https://www.drupal.org/project/webform)。使用 Webform，您可以在具有预定义字段的特定节点类型下添加块表单，并直接向节点作者发送电子邮件。

1.  下载并启用 Webform 4.x
2.  创建新的，添加所需的字段
3.  在*地址*使用令牌*的电子邮件*选项卡下*`[current-page:node:author:mail]`*
**   在*表单设置*选项卡中选中*作为块可用**   配置新启用的块（仅在某些节点类型下显示+将受限页面设置为`node/*/*`）*   做测试*

 *[您可以在此处](http://www.jasom.net/webform-is-submitted-send-email-to-the-current-node-author)找到打印屏幕和更详细的说明。*

# c++ - gtkmm 2.4 cairo 时钟示例在修改为在 HBox 内而不是主窗口内绘制时不起作用

> ID：10537557
> 
> 赞同：2
> 
> 时间：2012-05-10T15:40:18.850
> 
> 标签：c++, gtk, cairo, gtkmm

我在 Ubuntu 10.04 上使用 gtkmm2.4。（因此我的示例包含 on_expose_event() 例程而不是 on_draw()）。在 on_expose_event() 中引用 get_window() 的 VBox 中似乎不存在该窗口。我必须添加它吗？

原始代码[http://developer.gnome.org/gtkmm-tutorial/2.22/gtkmm-tutorial.html#sec-drawing-clock-example](http://developer.gnome.org/gtkmm-tutorial/2.22/gtkmm-tutorial.html#sec-drawing-clock-example)

我的代码是

测试.h

```
#ifndef TEST_H
#define TEST_H

#include <gtkmm.h>

class TEST : public virtual Gtk::Window
{

private:

public:
  TEST();
  virtual ~TEST();

protected:

  Gtk::VBox V;          // Make V Box
  Gtk::HBox H1;     // Upper H Box
  Gtk::HBox H2;     // Lower H Box

class Clock : public virtual Gtk::DrawingArea
{
    public:
        Clock();
        virtual ~Clock();

    protected:
        //Override default signal handler:
        virtual bool on_expose_event(GdkEventExpose* event);
        double m_radius;
        double m_lineWidth;
        bool onSecondElapsed(void);

  Glib::RefPtr<Gdk::Window> m_refGdkWindow;
};

};

#endif // TEST_H 
```

测试.cc

```
#include <ctime>
#include <math.h>
#include <cairommconfig.h>
#include <cairomm/context.h>
#include <cairomm/surface.h>
#include "test.h"

TEST::TEST()
:
V(true,0),
H1(true,0),
H2(true,0)
{

 set_title("test clock");
  set_border_width(10);
  set_size_request(500,500); //set Window Size

  add(V);
  V.pack_start(H1);
  V.pack_start(H2);

  Clock c;  

  H2.pack_start(c);

  show_all(); 

}

TEST::~TEST()
{
}

TEST::Clock::Clock()
    : m_radius(0.42), m_lineWidth(0.05)
{
    Glib::signal_timeout().connect(
                sigc::mem_fun(*this, &Clock::onSecondElapsed), 1000);
}

TEST::Clock::~Clock()
{
}

bool TEST::Clock::on_expose_event(GdkEventExpose* event)
{
  // This is where we draw on the window
  Glib::RefPtr<Gdk::Window> window = get_window();
  if(window)
  {
    Gtk::Allocation allocation = get_allocation();
    const int width = allocation.get_width();
    const int height = allocation.get_height();

    Cairo::RefPtr<Cairo::Context> cr = window->create_cairo_context();

    if (event)
    {
        // clip to the area indicated by the expose event so that we only
        // redraw the portion of the window that needs to be redrawn
        cr->rectangle(event->area.x, event->area.y,
                event->area.width, event->area.height);
        cr->clip();
    }

    // scale to unit square and translate (0, 0) to be (0.5, 0.5), i.e.
    // the center of the window
    cr->scale(width, height);
    cr->translate(0.5, 0.5);
    cr->set_line_width(m_lineWidth);

    cr->save();
    //cr->set_source_rgba(0.337, 0.612, 0.117, 0.9);   // green
    cr->set_source_rgba( 0.712, 0.437, 0.117, 0.7);   // green
    cr->paint();
    cr->restore();
    cr->arc(0, 0, m_radius, 0, 2 * M_PI);
    cr->save();
    cr->set_source_rgba(1.0, 1.0, 1.0, 0.8);
    cr->fill_preserve();
    cr->restore();
    cr->stroke_preserve();
    cr->clip();

    //clock ticks
    for (int i = 0; i < 12; i++)
    {
        double inset = 0.05;

        cr->save();
        cr->set_line_cap(Cairo::LINE_CAP_ROUND);

        if (i % 3 != 0)
        {
            inset *= 0.8;
            cr->set_line_width(0.03);
        }

        cr->move_to(
                (m_radius - inset) * cos (i * M_PI / 6),
                (m_radius - inset) * sin (i * M_PI / 6));
        cr->line_to (
                m_radius * cos (i * M_PI / 6),
                m_radius * sin (i * M_PI / 6));
        cr->stroke();
        cr->restore(); /* stack-pen-size */
    }

    // store the current time
    time_t rawtime;
    time(&rawtime);
    struct tm * timeinfo = localtime (&rawtime);

    // compute the angles of the indicators of our clock
    double minutes = timeinfo->tm_min * M_PI / 30;
    double hours = timeinfo->tm_hour * M_PI / 6;
    double seconds= timeinfo->tm_sec * M_PI / 30;

    cr->save();
    cr->set_line_cap(Cairo::LINE_CAP_ROUND);

    // draw the seconds hand
    cr->save();
    cr->set_line_width(m_lineWidth / 3);
    cr->set_source_rgba(0.7, 0.7, 0.7, 0.8); // gray
    cr->move_to(0, 0);
    cr->line_to(sin(seconds) * (m_radius * 0.9), 
            -cos(seconds) * (m_radius * 0.9));
    cr->stroke();
    cr->restore();

    // draw the minutes hand
    cr->set_source_rgba(0.117, 0.337, 0.612, 0.9);   // blue
    cr->move_to(0, 0);
    cr->line_to(sin(minutes + seconds / 60) * (m_radius * 0.8),
            -cos(minutes + seconds / 60) * (m_radius * 0.8));
    cr->stroke();

    // draw the hours hand
    cr->set_source_rgba(0.337, 0.612, 0.117, 0.9);   // green
    cr->move_to(0, 0);
    cr->line_to(sin(hours + minutes / 12.0) * (m_radius * 0.5),
            -cos(hours + minutes / 12.0) * (m_radius * 0.5));
    cr->stroke();
    cr->restore();

    // draw a little dot in the middle
    cr->arc(0, 0, m_lineWidth / 3.0, 0, 2 * M_PI);
    cr->fill();

  }

  return true;
}

bool TEST::Clock::onSecondElapsed(void)
{
    // force our program to redraw the entire clock.
    Glib::RefPtr<Gdk::Window> win = get_window();
    if (win)
    {
        Gdk::Rectangle r(0, 0, get_allocation().get_width(),
                get_allocation().get_height());
        win->invalidate_rect(r, false);
    }
    return true;
} 
```

主文件

```
#include "test.h"
#include <gtkmm.h>

int main(int argc, char** argv)
{
   Gtk::Main kit(argc, argv);

   //Gtk::Window win;
   //win.set_title("Cairomm Clock");

   //Clock c;
   //win.add(c);
   //c.show();

   TEST t;

   Gtk::Main::run(t);

   return 0;
} 
```

编译

```
 g++ -g test.cc main.cc -o test `pkg-config gtkmm-2.4 cairomm-1.0` 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-10T19:34:30.790

这部分对我来说很可疑：

```
Clock c;  
H2.pack_start(c); 
```

在这个范围的末尾， c 被销毁。实际上，我不确定为什么它不会崩溃，但也许其他人可以对此有所了解。您想在 TEST 中声明 Clock 以使其具有适当的生命周期：

```
class TEST {
   ... 
   class Clock ... {
     ...
   };
   Clock c;   // new code
   ...
}; 
```

# javascript - 如何使用javascript强制“输入键”充当“tab键”？

> ID：10537558
> 
> 赞同：11
> 
> 时间：2012-05-10T15:40:21.370
> 
> 标签：javascript, keyevent, onkeydown

我正在一个充满要填写的表格的网站上工作，我要求当按下退出按钮时焦点移动到下一个输入控件，就像按下“tab”一样。我找到了在按键为 13 时移动焦点的代码，但这需要获取元素的 ID 来关注

```
<input id="Text1" type="text" onkeydown="return noNumbers(event)" />
<input id="Text2" type="text" />

<script type="text/javascript">

    function noNumbers(e) {

        keynum = e.which;

        if (keynum == 13)
            document.getElementById("Text2").focus();

    }
</script> 
```

我需要一个通用函数，当按键代码为 13“即输入”时，触发默认事件按 9“即选项卡”，当然是在 Javascript 中

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-05-10T15:51:07.730

这将处理多个输入字段。

这是 jQuery 版本：http: [//jsfiddle.net/TnEB5/3/](http://jsfiddle.net/TnEB5/3/)

```
$('input').keypress(function(e) {
    if (e.which == 13) {
        $(this).next('input').focus();
        e.preventDefault();
    }
});
```

```
<script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js"></script>
<input id="Text1" type="text"  />
<input id="Text2" type="text" />
<input id="Text3" type="text" />
```

这是纯 javascript 版本： http: [//jsfiddle.net/TnEB5/5/](http://jsfiddle.net/TnEB5/5/) （您可能希望以不同的方式获得同级）

```
function tab(e) {
    if (e.which == 13) {
        e.target.nextSibling.nextSibling.focus();
        e.preventDefault();
    }
}
var inputs = document.getElementsByTagName('input');
for (var x = 0; x < inputs.length; x++)
{
    var input = inputs[x];
    input.onkeypress = tab;
}
```

```
<input id="Text1" type="text"  />
<input id="Text2" type="text" />
<input id="Text3" type="text" />
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-10T16:00:18.897

您需要`tabindex`为通用解决方案显式设置输入字段的属性。就像是

```
<input id="Text1" type="text" tabindex="1" />
<input id="Text2" type="text" tabindex="2" />

<script type="text/javascript">
    $('input').keypress(function(e){
        if(e.which==13){ 
            $("[tabindex='"+($(this).attr("tabindex")+1)+"']").focus();
            e.preventDefault();
        }
    });    
</script> 
```

此解决方案使用 jquery 为页面上的所有输入类型元素分配事件处理程序，将焦点设置到具有下一个最高 tabindex 属性的元素，并在使用 e.preventDefault() 按下 enter 时阻止表单提交。这是一个[jfiddle](http://jsfiddle.net/kkdFM/1/)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-05-10T15:49:27.857

改为处理按键并将 false 返回给浏览器：

[http://jsfiddle.net/EeyTL/](http://jsfiddle.net/EeyTL/)

```
<input id="Text1" type="text" />
<input id="Text2" type="text" />

<script type="text/javascript">
    document.getElementById('Text1').onkeypress = function (e) {
        if (e.which === 13) {
            document.getElementById("Text2").focus();
            return false;
        }
    };
</script> 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-05-10T15:53:00.820

```
<input type="text" value="" onkeyup="doNext(this);"> a <br>
<input type="text" value="" onkeyup="doNext(this);"> b <br>
<input type="text" value="" onkeyup="doNext(this);"> c <br>

function doNext(el){                   
  if(event.keyCode=='13'){
    var nextEl = el.form.elements[el.tabIndex+1];
    if (nextEl && nextEl.focus) nextEl.focus();
  }
} 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2017-09-28T17:32:41.083

虽然帖子很旧，但我希望我的回答可以帮助有需要的人。我有一个类似的情况：

我有一个**非常大的表单**，用于具有**不同类型输入字段**的员工调度程序应用程序。某些输入字段有时会隐藏，有时不会。我被**要求将 Enter 键设置为 Tab 键**，以便表单用户在创建员工日程表时可以使用 10 键。这是我解决问题的方法：

```
$(document).ready(function () {
    var allInputs = $(':text:visible'); //(1)collection of all the inputs I want (not all the inputs on my form)
    $(":text").on("keydown", function () {//(2)When an input field detects a keydown event
        if (event.keyCode == 13) {
            event.preventDefault();
            var nextInput = allInputs.get(allInputs.index(this) + 1);//(3)The next input in my collection of all inputs
            if (nextInput) {
                nextInput.focus(); //(4)focus that next input if the input is not null
            }
        }
    });
}); 
```

我必须做的是：

1.  创建一个我想在选项卡时考虑的所有输入的集合。在我的情况下，它是可见的文本输入。
2.  在有问题的输入上监听 keydown 事件，在我的情况下是所有文本字段输入
3.  当在我的文本输入上按下回车时，确定接下来要关注的输入。
4.  如果该输入有效，则将其置于焦点。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2018-08-16T07:51:36.913

我正在使用此代码前进到下一个输入字段。我讨厌按 TAB 键。此解决方案适用于 IE 和 Firefox：

```
<script type="text/javascript"> 
  function tabE(obj,e){ 
   var e=(typeof event!='undefined')?window.event:e;// IE : Moz 
   if(e.keyCode==13){ 
     var ele = document.forms[0].elements; 
     for(var i=0;i<ele.length;i++){ 
       var q=(i==ele.length-1)?0:i+1;// if last element : if any other 
       if(obj==ele[i]){ele[q].focus();break} 
     } 
  return false; 
   } 
  } 
</script> 
```

HTML 内容

```
<form id="main">
     <input name="" type="text" onkeypress="return tabE(this,event)">
     <input type="submit" value="Ok">
</form> 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2021-03-21T21:01:47.643

这是一个简单的解决方案。基本上，您包含 enter2tab.js 文件，然后在您希望输入的每个对象上添加 enter2tab 类，以将其视为 js。

[https://github.com/AndreasGrip/enter2tab](https://github.com/AndreasGrip/enter2tab)

您显然可以查看代码以了解它的作用和方式..

* * *

## 回答 #8

> 赞同：-1
> 
> 时间：2012-05-10T15:55:19.027

我相信使用 e.preventDefault(); 比返回 false 更安全。

# lisp - “成员”不会识别列表的成员

> ID：10537560
> 
> 赞同：1
> 
> 时间：2012-05-10T15:40:28.297
> 
> 标签：lisp, common-lisp, clisp

我遇到了一个非常奇怪的问题。我有一个名为“定理”的列表，其中只有一项。这是证据：

```
[]> theorems
(((ROSES ARE RED) ^ (~ (ROSES ARE RED))))
[]> (car theorems)
((ROSES ARE RED) ^ (~ (ROSES ARE RED))) 
```

显然 ((ROSES ARE RED) ^ (~ (ROSES ARE RED))) 是“定理”列表的成员。但是当我测试它的成员资格时，它失败了：

```
[]> (member '((ROSES ARE RED) ^ (~ (ROSES ARE RED))) theorems)
NIL 
```

但是，如果我明确地调用它，它会起作用：

```
[]> (member (car theorems) theorems)
(((ROSES ARE RED) ^ (~ (ROSES ARE RED)))) 
```

为什么会发生这种情况，我该如何解决？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-10T16:03:10.737

Common Lisp`EQL`用作默认的测试函数。`EQL`检查项目是否是相同的相同项目。您想测试项目是否具有相同的结构。所以你需要使用`EQUAL`or `EQUALP`。

```
CL-USER 11 > (setf theorems '(((ROSES ARE RED) ^ (~ (ROSES ARE RED)))))
(((ROSES ARE RED) ^ (~ (ROSES ARE RED))))

CL-USER 12 > (member '((ROSES ARE RED) ^ (~ (ROSES ARE RED))) theorems)
NIL 
```

告诉`MEMBER`使用`EQUAL`：

```
CL-USER 13 > (member '((ROSES ARE RED) ^ (~ (ROSES ARE RED)))
                     theorems
                     :test 'equal)
(((ROSES ARE RED) ^ (~ (ROSES ARE RED)))) 
```

# jquery-mobile - PhoneGap 需要 JQM 还是巧合？

> ID：10537561
> 
> 赞同：0
> 
> 时间：2012-05-10T15:40:29.857
> 
> 标签：jquery-mobile, cordova

我看到的 PhoneGap 示例使用 jQuery Mobile，但我想知道 PhoneGap 是否需要它，或者人们是否正在使用 JQM，因为他们（显然）正在编写移动应用程序？

事实上，PhoneGap 是否需要 jQuery？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-10T15:43:06.167

让我为你谷歌一下：

[http://wiki.phonegap.com/w/page/16494778/Getting%20Started%20with%20PhoneGap%20(iOS)%20-%20Xcode%203#Requirements](http://wiki.phonegap.com/w/page/16494778/Getting%20Started%20with%20PhoneGap%20(iOS)%20-%20Xcode%203#Requirements)

这适用于 iOS，但没有 PhoneGap 不需要 jQuery。

人们最有可能使用 jQuery mobile，因为他们试图针对多个设备，而 JQM 开箱即用地支持这一点。

[http://wiki.phonegap.com/w/page/36868306/UI%20Development%20using%20jQueryMobile](http://wiki.phonegap.com/w/page/36868306/UI%20Development%20using%20jQueryMobile)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-11T02:06:12.327

Phonegap 根本不需要 jQuery。

它基本上只是一个没有任何绒毛的空浏览器窗口。您可以使用任何您想要的 HTML、CSS 和 Javascript 技巧，只要它们与支持 HTML5 的浏览器兼容。

我喜欢[http://zeptojs.com/](http://zeptojs.com/)来处理 javascript。更轻量级（虽然你失去了很多 JQuery 的动画和东西）

# ios - iPad 应用程序中标签栏内的拆分视图

> ID：10537562
> 
> 赞同：0
> 
> 时间：2012-05-10T15:40:39.863
> 
> 标签：ios, design-patterns, uisplitviewcontroller, uitabbar

当 iPad 第一次问世时，我记得 Apple 不赞成在标签栏项目视图中使用拆分视图。他们是否拒绝了使用这种设计的申请，我不记得也不知道。

这种设计是否仍然被苹果公司所反对？如果你创建一个使用这种设计的应用程序，它会被苹果拒绝吗？我知道现在有第三方 API 可以帮助您编写利用这种设计模式的应用程序，这让我相信 Apple 不再关心这一点，但我只是想确定这一点。

如果有人能解释为什么苹果不赞成这种设计，那会很有帮助，因为我不明白这种设计对苹果来说是什么问题。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-10T21:13:31.893

我现在找不到引用，但是 HIG 中曾经有一段说你*不能*这样做，然后他们把它改成了你应该*尽量避免*这样做。所以我认为你很清楚，只要设计有意义。可悲的是，我找不到那个短语出现在哪里——也许它是一起取出的。

无论如何，标签栏或拆分视图下的 HIG 中没有任何内容表明您无法做您想做的事。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-26T09:08:49.157

我也刚刚跨过这个。

这在 5.1 之前的 Interface-Builder 中也不起作用。

但是我今天刚刚尝试并认识到您可以简单地将标签栏控制器的关系添加到界面构建器内的拆分视图（这在以前不起作用）。

但是，在运行应用程序并选择包含拆分视图的选项卡时，只会显示详细视图。

编辑：如果你为 5.1 编译，这似乎很容易。处理拆分视图似乎发生了变化。

试试看：

*   在您的 Storyboard 中，创建一个 Tabbar 控制器
*   添加拆分视图控制器
*   创建从标签栏控制器到拆分视图控制器的引用

现在你需要创建你的主控制器和细节控制器

我还没有完成实施，但希望这会有所帮助。

# c++ - 列表根本没有排序

> ID：10537563
> 
> 赞同：2
> 
> 时间：2012-05-10T15:40:42.040
> 
> 标签：c++, visual-c++

我正在更新一个列表，然后尝试对列表进行排序，将最高`sVar1`的放在列表的前面，但它没有这样做，我使用的是 6.0 VS

```
while(Iter != m_SomeList.end())
{
    if((*Iter)->sVar1 == 1) 
    {
        (*Iter)->sVar1++;
    }

    Iter++;
}

m_SomeList.sort(Descending());

Iter = m_SomeList.begin();

while(Iter != m_SomeList.end())
    {
        //now display the content of the list 
```

我的降序排序功能

```
struct Descending : public greater<_LIST_DETAIL*> 
{
    bool operator()(const _LIST_DETAIL* left, const _LIST_DETAIL* right)
    {
        return (left->sVar1 > right->sVar1);
    }
}; 
```

谁能发现什么问题？

编辑：更新的代码，它包含错别字...

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-10T16:05:30.307

这简直是​​一团糟。

首先，您不会派生自`std::greater`——您要么直接*使用* `std::greater`，如：

（伪代码，未编译）

```
std::sort( v.begin(), v.end(), std::greater() ); 
```

...或者，如果这对您没有好处，请通过以下方式编写您自己的函子`std::unary_function`：

```
struct Descending : public unary_function<bool, _LIST_DETAIL>
{
    bool operator()(const _LIST_DETAIL* left, const _LIST_DETAIL* right) const // note const
    {
        return (left->sVar1 > right->sVar1);
    }
}; 
```

其次，语言保留使用前导下划线后跟大写名称。

第三，您使用的是 14 年前的编译器，微软多年前就终止了对它的所有支持。更重要的是，按照今天的标准，它是一堆发臭的垃圾。当它是新的时它甚至不是很好。你需要离开 VS 6.0。

# php - PHP DOMDocument 从 HTML 中分离数据

> ID：10537564
> 
> 赞同：0
> 
> 时间：2012-05-10T15:40:50.450
> 
> 标签：php, html, parsing, domdocument

我尝试了几种方法，但没有太多成功，所以我的 html 如下所示：

```
<td>
  <a href="..?ID=343">
    <img src=".." />
  </a>
</td>
<td>
 <a href="..?id-343">  < - diffirence between two links is that this one has id in lowercase
  Some text..
 </a>
<td> 
```

现在我想得到这个元素和这个内容：一些文本..

我设法获得了这两个信息，但由于某种原因，如果我打印 links_array 我得到双链接：

> 数组（ [0] => [http://www.....net/2004/dealer_oglas.asp?id=5895417](http://www.....net/2004/dealer_oglas.asp?id=5895417) [1] => [http://www.....net/2004/dealer_oglas.asp ?ID=5895417](http://www.....net/2004/dealer_oglas.asp?ID=5895417) [2] => [http://www.....net/2004/dealer_oglas.asp?id=5883006](http://www.....net/2004/dealer_oglas.asp?id=5883006) [3] => [http://www.....net/2004/dealer_oglas .asp?ID=5883006](http://www.....net/2004/dealer_oglas.asp?ID=5883006) [4]

```
$ch = curl_init();

    curl_setopt($ch, CURLOPT_URL, "http://www.....net/2004/dealer_Zaloga.asp?dealer=12321");
    curl_setopt($ch, CURLOPT_RETURNTRANSFER, 1);

    $output = curl_exec($ch);

    $dom = new DOMDocument;
    @$dom->loadHTML($output);

    // Get images
    $images = $dom->getElementsByTagName('img');
    $image_array = array();

    for($i = 0; $i < $images->length; $i++) {
        if($images->item($i)->getAttribute('width') == "80") {
            array_push($image_array, $dom->saveHTML($images->item($i)));
        }
    }

    // Get links
    $links = $dom->getElementsByTagName('a');
    $links_array = array();
    $title_array = array();

   //Here i try to compare the two a that it finds i want to store only the one that does not have img element right after it but for some reason it stores both.

    // All arrays are the same size img, links title
    for($j = 0; $j < $links->length; $j++) {
        if(isset($image_array[$j]) && $dom->saveHTML($links->item($j+1)) != $image_array[$j]) {
            array_push($links_array, 'http://www.....net/2004/' . $links->item($j)->getAttribute('href'));
            array_push($title_array, $links->item($j)->nodeValue);
        }
    } 
```

我尝试比较 nodeValue 的“”或“”但没有成功。感谢您提前提供的所有帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-10T16:13:35.193

也许链接实际上在那里两次？

`$dom->getElementsByTagName('a')`是*全局*搜索。

# git - git + ftp 上传

> ID：10537570
> 
> 赞同：0
> 
> 时间：2012-05-10T15:41:11.900
> 
> 标签：git, ftp

我有一个初学者问题。

如果我有 2 个分支，master 和 testbranch，我切换到 testbranch，然后通过 FTP 上传一个新文件，这会影响 master 和 testbranch 吗？

我尝试这样做，当我运行“git st”时，更改都会出现在 master 和 testbranch 中。

有什么方法可以隐藏 master 的更改，或者这就是 git 的工作方式？

提前致谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-10T15:45:00.463

听起来当您说“切换”时，您的意思是您正在使用该`git checkout`命令。此命令在存储库中已提交的版本之间切换。如果您“FTP 上传”一个新文件（我假设您的意思是将文件添加到沙箱，或覆盖现有文件），除非您提交它，否则它不会影响提交的版本。您是否打算通过 FTP 上传来提交您放入沙箱的文件（我想）？因为这是它影响分支的唯一方式。

通常，您`master`在处理`testbranch`. 除非您提交，否则提交将完全保持提交状态`rebase`，或者以其他方式修改存储库本身。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-10T15:43:14.467

当您添加未跟踪的文件时，您仍然可以签出其他分支，该文件将保留。想象一下相反的情况，如果 Git 在切换分支时将其删除，则该文件将丢失，因为它已提交！

但是`git status`仍然会说该文件未跟踪，但这并不意味着您的分支受到影响。只是 Git 告诉您分支记录和工作副本之间的状态不同。

然后你有两个选择：

*   添加并提交文件：切换到`master`时会被移除，切换回时会重新出现`testbranch`
*   不要提交，只需隐藏状态并返回`master`：

```
 git stash --include-untracked
 #file is saved in a temporary place, and removed
 git checkout master
 #do stuff...
 git checkout testbranch
 # git stash pop
 #file is restored 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-05-10T07:58:49.160

如果您知道 ftp 上传的日期，您可以使用它[`git whatchanged`](https://git-scm.com/docs/git-whatchanged)来检索修改文件列表。

你的命令看起来像这样：

```
git whatchanged --since 'dd/mm/yyyy' --until 'dd/mm/yyyy' --oneline --name-only --pretty=format: | sort | uniq 
```

# python - Rails - 在 libv8 上捆绑安装失败，Python 冲突

> ID：10537571
> 
> 赞同：1
> 
> 时间：2012-05-10T15:41:13.240
> 
> 标签：python, ruby-on-rails

为我的项目运行“捆绑安装”时，出现以下错误：

```
Fetching gem metadata from https://rubygems.org/.........
Using rake (0.9.2.2)
Using i18n (0.6.0)
Using multi_json (1.1.0)
Using activesupport (3.2.1)
Using builder (3.0.0)
Using activemodel (3.2.1)
Using erubis (2.7.0)
Using journey (1.0.3)
Using rack (1.4.1)
Using rack-cache (1.1)
Using rack-test (0.6.1)
Using hike (1.2.1)
Using tilt (1.3.3)
Using sprockets (2.1.2)
Using actionpack (3.2.1)
Using mime-types (1.17.2)
Using polyglot (0.3.3)
Using treetop (1.4.10)
Using mail (2.4.1)
Using actionmailer (3.2.1)
Using arel (3.0.2)
Using tzinfo (0.3.31)
Using activerecord (3.2.1)
Using activeresource (3.2.1)
Using bcrypt-ruby (3.0.1)
Using bundler (1.1.3)
Using coffee-script-source (1.2.0)
Using execjs (1.3.0)
Using coffee-script (2.2.0)
Using rack-ssl (1.3.2)
Using json (1.6.5)
Using rdoc (3.12)
Using thor (0.14.6)
Using railties (3.2.1)
Using coffee-rails (3.2.2)
Installing libv8 (3.3.10.4) with native extensions
Gem::Installer::ExtensionBuildError: ERROR: Failed to build gem native extension
.

    C:/Ruby193/bin/ruby.exe extconf.rb
*** extconf.rb failed ***
Could not create Makefile due to some reason, probably lack of
necessary libraries and/or headers.  Check the mkmf.log file for more
details.  You may need configuration options.

Provided configuration options:
        --with-opt-dir
        --without-opt-dir
        --with-opt-include
        --without-opt-include=${opt-dir}/include
        --with-opt-lib
        --without-opt-lib=${opt-dir}/lib
        --with-make-prog
        --without-make-prog
        --srcdir=.
        --curdir
        --ruby=C:/Ruby193/bin/ruby
Checking for Python...Unable to build libv8: Python 3.x is unsupported by V8! 
```

Gem 文件将继续安装在 C 中

```
:/Ruby193/lib/ruby/gems/1.9.1/gems/libv8-3.3
.10.4 for inspection. 
```

结果记录到

```
C:/Ruby193/lib/ruby/gems/1.9.1/gems/libv8-3.3.10.4/ext/libv8/g
em_make.out 
```

安装 libv8 (3.3.10.4) 时出错，Bundler 无法继续。

`gem install libv8 -v '3.3.10.4'`在捆绑之前确保成功。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-10T16:29:58.473

您的项目中需要 V8 吗？如果您正在编译咖啡脚本，安装节点和 NPM 通常更容易、更快。

# c# - 将字符串添加到逐字字符串文字

> ID：10537578
> 
> 赞同：8
> 
> 时间：2012-05-10T15:41:53.557
> 
> 标签：c#, string-literals, verbatim-string

我有一个名为 defaultPath 的路径，我想将它添加到这个逐字字符串文字中，但可以得到它周围的引号。

```
 @"""C:\Mavro\MavBridge\Server\MavBridgeService.exe"" /service /data ""..\Data""" 
```

我试图添加 +defaultPath 来替换 Data。所以假设我有一个文件夹名称 Data.Apple 我希望输出为

```
 "C:\Mavro\MavBridge\Server\MavBridgeService.exe" /service /data "..\Data.Apple" 
```

但是当我在过去的半个小时里一直这样做时，我得到了

```
 "C:\Mavro\MavBridge\Server\MavBridgeService.exe" /service /data "..\"Data.Apple 
```

或者

```
 "C:\Mavro\MavBridge\Server\MavBridgeService.exe" /service /data "..\" + defaultPath 
```

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-05-10T15:44:16.110

这样做（首选）：

```
string.Format(@"""C:\Mavro\MavBridge\Server\MavBridgeService.exe"" /service /data ""..\{0}""", defaultPath); 
```

或者像这样：

```
@"""C:\Mavro\MavBridge\Server\MavBridgeService.exe"" /service /data ""..\" + defaultPath + "\""; 
```

* * *

第一个使用[`string.Format`](http://msdn.microsoft.com/en-us/library/system.string.format.aspx)，它基本上将第一个参数中的 {0} 替换为第二个参数中的值并返回结果。

第二个使用经典的字符串连接，我所做的是删除最后一个反斜杠（`""..\`而不是`""..\""`）之后的双引号，因为你不想要反斜杠之后的引号。你想要后面的引号`defaultPath`。这就是这段代码的作用：它附加`defaultPath`( `" + defaultPath`) 并在之后附加结束引号 ( `+ "\""`)。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2016-03-10T16:02:18.733

因此，如果您想利用 c# 6 的字符串插值，您也可以这样做

```
var randomText = "insert something";
var yourString = $@"A bunch of text in here 
that is on seperate lines
but you want to {randomText }"; 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-05-10T15:49:21.193

使用 string.Format 在引号之间插入变量：

```
string path = "Data.Apple";
string verbatim = string.Format(@"""C:\Mavro\MavBridge\Server\MavBridgeService.exe"" /service /data ""{0}""", path);
MessageBox.Show(verbatim); 
```

它使阅读和实现更容易，您可以以类似的方式将路径的其他部分替换为可变部分。

如果您尝试仅将“defaultPath”变量附加到末尾，它将永远无法正常工作，因为您已经添加了结尾`"`.

# extjs4.1 - 类似于 Flex View Stack 的 Ext JS 组件

> ID：10537580
> 
> 赞同：0
> 
> 时间：2012-05-10T15:41:58.373
> 
> 标签：extjs4.1

Ext JS 4 中是否有任何类似于 Flex 视图堆栈的组件？ [http://livedocs.adobe.com/flex/3/html/help.html?content=navigators_3.html](http://livedocs.adobe.com/flex/3/html/help.html?content=navigators_3.html)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-10T16:04:36.273

```
layout: 'card' 
```

还是我错过了什么？

# google-bigquery - 谷歌大查询

> ID：10537591
> 
> 赞同：-1
> 
> 时间：2012-05-10T15:42:34.547
> 
> 标签：google-bigquery

我出于 SEO 原因使用 BigQuery。我是一名搜索 TC，我有点困惑，为什么您不使用 Google 论坛，因为我认为这是标准的。我想使用 BigQuery 的目的是在我的竞争对手更改其网站上的数据以及更改了哪些页面时进行拉取。因此，我需要更改的 URL 以及更改时间（日期），因此我还可以提取页面标题和描述，以查看他们所做的与我不同的地方。

有没有人知道如何使用 BigQuery 拉取：

1.  页面更改日期
2.  网址
3.  标题
4.  描述

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-10T21:06:51.003

我们已改用 Stack Overflow 来支持我们的许多开发人员产品，例如 BigQuery。StackOverflow 上有一个很棒的社区，用于格式化技术问题和与社区互动的界面非常棒。

BigQuery 不会为您收集数据——它是一种云服务，用于对海量数据集执行即席查询。在首次执行查询之前，您需要将数据上传到服务（以 CSV 格式）。

因此，如果您有一项收集这些数据的工作——网址、标题、描述、日期，也许还有网页的哈希值，您可能会将此数据的 CSV 文件提取到 BigQuery 中，并使用它来了解网页何时发生更改。

当然，也有 3rd-party 服务（例如 Changedetection.com）可能更容易用于您的目的。

# cordova - 我是否为每个设备加载不同的 phonegap.js？

> ID：10537593
> 
> 赞同：0
> 
> 时间：2012-05-10T15:42:39.230
> 
> 标签：cordova

无论您在什么设备上运行 phonegap.js 文件，它是否都相同？这是我的代码。我想做的是引入最新版本的 PhoneGap，而不是在本地托管它。

```
<script src="http://ajax.googleapis.com/ajax/libs/jquery/1/jquery.min.js"></script>

<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="stylesheet" href="http://code.jquery.com/mobile/latest/jquery.mobile.css">
<script>
$(document).bind("mobileinit", function() {
    $.mobile.ajaxEnabled = false;
});
</script>
<script src="http://code.jquery.com/mobile/latest/jquery.mobile.js"></script>
<script src="phonegap.js" type="text/javascript"></script> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-10T18:49:53.433

不是每个平台都需要它自己的特定 phonegap.js 我们正在努力解决这个要求，但现在。

Android != iOS != 黑莓 != Windows Phone

谈到phonegap.js。

# excel - 删除一行中的重复项

> ID：10537595
> 
> 赞同：1
> 
> 时间：2012-05-10T15:42:43.880
> 
> 标签：excel, vba

朋友们，

我有一个重复几千行的excel表。3类列，可能重复，如下图第二行

有没有办法让 excel 循环遍历一行并删除行内的重复项，使其最终看起来像下面显示的第二个表？

![在此处输入图像描述](../Images/9223a18a1b5c7dd8c9b4ebc3d6ebc817.png)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-10T16:32:15.323

我不确定，但这是你正在尝试的吗？

```
Option Explicit

Sub Sample()
    Dim wsI As Worksheet
    Dim lastRow As Long, lastCol As Long, i As Long, j As Long
    Dim sVal1, sVal2, sVal3

    '~~> Input Sheet
    Set wsI = Sheets("Sheet1")

    With wsI
        lastRow = .Cells.Find(What:="*", After:=.Range("A1"), _
                  Lookat:=xlPart, LookIn:=xlFormulas, SearchOrder:=xlByRows, _
                  SearchDirection:=xlPrevious, MatchCase:=False).Row

        lastCol = .Cells.Find(What:="*", After:=.Range("A1"), _
                  Lookat:=xlPart, LookIn:=xlFormulas, SearchOrder:=xlByColumns, _
                  SearchDirection:=xlPrevious, MatchCase:=False).Column

        For i = 1 To lastRow
            sVal1 = .Cells(i, 1).Value
            sVal2 = .Cells(i, 2).Value
            sVal3 = .Cells(i, 3).Value

            For j = 4 To lastCol Step 3
               If .Cells(i, j).Value = sVal1 And _
               .Cells(i, j + 1).Value = sVal2 And _
               .Cells(i, j + 2).Value = sVal3 Then
                    .Cells(i, j).ClearContents
                    .Cells(i, j + 1).ClearContents
                    .Cells(i, j + 2).ClearContents
               End If
            Next j
        Next i
    End With
End Sub 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2020-06-06T23:41:33.727

这就是我解决它的方法。不是最漂亮的，但它有效：

从行中删除重复的电话

```
Sub PhoneDedupByRow()

    Dim Loopcounter As Long
    Dim NumberOfCells As Long
Application.ScreenUpdating = False
   'Range starting at A1
    Worksheets("Sheet1").Activate
    NumberOfCells = Range("A2", Range("A2").End(xlDown)).Count

    For Loopcounter = 1 To NumberOfCells
    'copies each section...I need to select the proper offsets for cells with the ph#'
    Range(Range("A1").Offset(Loopcounter, 10), Range("A1").Offset(Loopcounter, 19)).Copy
    'This is where the past/transpose will go...push it out to a far out column to avoid errors
    Range("W1").Select
       Selection.PasteSpecial Paste:=xlPasteAll, Operation:=xlNone, SkipBlanks:= _
        False, Transpose:=True
        Application.CutCopyMode = False
    'Knowing the range is 10 cells, i added 11 because gotospecial with no blanks causes an error
    Range("W1:W11").Select
    Selection.SpecialCells(xlCellTypeBlanks).Select
    Selection.Delete Shift:=xlUp

    ActiveSheet.Range("W1:W10").RemoveDuplicates Columns:=1, Header:=xlNo
    ActiveSheet.Range("W1:W10").Select
    Selection.Copy

    Range(Range("A1").Offset(Loopcounter, 10), Range("A1").Offset(Loopcounter, 19)).Select
               Selection.PasteSpecial Paste:=xlPasteAll, Operation:=xlNone, SkipBlanks:= _
        False, Transpose:=True
        Application.CutCopyMode = False
     ActiveSheet.Range("W1:W10").Select
      Selection.ClearContents

    Next Loopcounter

Application.ScreenUpdating = True
End Sub 
```

# c# - 使用 ASP.NET MVC 3 上传解析文本文件

> ID：10537598
> 
> 赞同：0
> 
> 时间：2012-05-10T15:42:49.467
> 
> 标签：c#, regex, asp.net-mvc-3, parsing

所以我正在尝试上传然后解析具有以下格式的文本文件：

> 3 月 29 日 19:23:51,667|DEBUG|1 |1：正在初始化 lorem ipsum...
> 3 月 29 日 19:23:31,682|ERROR|1 |1：启动 Foo.Bar.Launcher
> System.Blah 时出现 Lorem.Ipsum.Exception。 LoremException: Lorem ipsum dolor sit amet, consectetur adipisicing elit...
>     at System.Lorem.Ipsum.Dolor.foo()
>     at System.Lorem.Ipsum.Dolor.foo()
> ...
> Mar 30 22:23:23,667|DEBUG |1 |1: 正在初始化 lorem ipsum...
> Apr 02 17:24:17,413|ERROR|4 |4: Lorem 无法 ipsum... System.DolorException: 对象引用未设置为对象的实例。
>     在 Lorem.Ipsum.Dolor.IpsumDbController..ctor()

和错误类：

```
public class Error
{
    public int ID { get; set; }
    public string Date { get; set; }
    public string Description { get; set; }
    public string ErrorType { get; set; }
} 
```

# 哪里有两个错误：

## 错误 1

**Mar 29 19:23:33** - 是日期
**System.Blah.LoremException** - 是 ErrorType。
**Lorem ipsum dolor sit amet, consectetur adipisicing elit** - 是描述

## 错误 2

**Apr 02 17:24:17** - 是日期
**System.DolorException** - 是 ErrorType。
**你调用的对象是空的。**- 是描述

有没有一种简单的方法可以解析字符串（通过正则表达式？或不？）？如果字符串包含 ERROR，我正在考虑拆分字符串，然后将下一行分配给 ErrorType。

我不太确定我会怎么做，所以任何帮助将不胜感激！

**更新：**模式确实不一致，所以我对 String.Split 解决方案不是很自信。

一般规则是：

全部 |错误| 将有一个 Date **（我们的字符串 Date）**、 System.blah.LoremException **（我们的 ErrorType）** ，然后是一个异常消息**（我们的描述）**

ErrorType & Description 可能与 ERROR 字符串内联或在下一行。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-10T16:07:51.467

我会结合使用 StreamReader 和正则表达式来处理解析。

```
 private static List<Error> ParseErrors(string filepath)
    {
        Regex parser = new Regex(@"^(?<date>\w{3}\s\d{1,2}\s\d{1,2}(?::\d{1,2}){2}),[^\|]+\|ERROR\|[^:]+\s*(?<description>.+)$", RegexOptions.IgnoreCase | RegexOptions.Compiled);
        string line = string.Empty;
        Match curMatch = null;
        var errorLog = new List<Error>();

        using (StreamReader sReader = new StreamReader(filepath))
        {
            while (!sReader.EndOfStream && (line = sReader.ReadLine()) != null)
            {
                curMatch = parser.Match(line);
                if (curMatch.Success)
                {
                    errorLog.Add(new Error()
                    {
                        ID = errorLog.Count, /* not sure how you assign ids? */
                        Date = curMatch.Groups["date"].Value.Trim(),
                        Description = curMatch.Groups["description"].Value.Trim(),
                        ErrorType = sReader.ReadLine().Trim()
                    });
                }
            }
        }
        return errorLog;
    } 
```

这背后的逻辑基本上是遍历流逐行搜索与正则表达式的匹配。正则表达式本身被定制为仅适合“错误”行，因此它不会匹配“调试”等。

如果该行与表达式匹配，则将新的“错误”类实例放入列表中，并使用正则表达式中的解析值填充字段。要填写“ErrorType”字段，我只需阅读匹配后的下一行。

## 编辑

好的，我能看到的最好方法是在异常位于同一行时匹配错误消息末尾的尾随“...”，然后尝试进一步匹配。

修改后的代码：

```
 private static List<Error> ParseErrors(string filepath)
    {
        Regex parser = new Regex(@"^(?<date>\w{3}\s\d{2}\s\d{1,2}(?::\d{1,2}){2}),[^\|]+\|ERROR\|[^:]+:\s*(?<description>.+?)(?:\.\.\.\s*(?<type>.+))?$", RegexOptions.IgnoreCase | RegexOptions.Compiled);
        string line = string.Empty;
        Match curMatch = null;
        var errorLog = new List<Error>();

        using (StreamReader sReader = new StreamReader(filepath))
        {
            while (!sReader.EndOfStream && (line = sReader.ReadLine()) != null)
            {
                curMatch = parser.Match(line);
                if (curMatch.Success)
                {
                    errorLog.Add(new Error()
                    {
                        ID = errorLog.Count, /* not sure how you assign ids? */
                        Date = curMatch.Groups["date"].Value.Trim(),
                        Description = curMatch.Groups["description"].Value.Trim(),
                        ErrorType = (curMatch.Groups["type"].Success ? curMatch.Groups["type"].Value : sReader.ReadLine().Trim())
                    });
                }
            }
        }
        return errorLog;
    } 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-10T15:55:38.040

如果你在循环中使用类似的东西......你也可以像我之前提到的那样使用 split ，这样可能会更有效一些

```
if (line.Contains("ERROR"))
                {
                    data = true;
                    continue;
                }

                if (data)
                    //here you deal with the following line 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-10T15:49:05.720

我会按照你的想法去做。拆分 上的每一行`|`，检查第二个元素是否相等`ERROR`，如果是，假设我需要处理该行和下一行。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-14T10:07:45.080

我解决了它，虽然它不是最优雅的解决方案，所以如果您有其他答案，请随时在此处发布。

```
 public static List<Error> ParseErrors(string filepath)
    {
        //separated the two regex
        Regex dateRegex = new Regex(@"^\w{3}\s\d{2}\s\d{2}:\d{2}:\d{2}", RegexOptions.IgnoreCase | RegexOptions.Compiled);
        Regex errorRegex = new Regex(@"((?<type>System.*?Exception):\s(?<description>.*\.))", RegexOptions.IgnoreCase | RegexOptions.Compiled);

        string CurrentLine = string.Empty;
        string NextLine = string.Empty;

        List<Error> errorLog = new List<Error>();

        using (StreamReader sReader = new StreamReader(filepath))
        {
            while (!sReader.EndOfStream && (CurrentLine = sReader.ReadLine()) != null)
            {

                if (CurrentLine.Contains("|ERROR|"))
                {

                    Match DateMatch = dateRegex.Match(CurrentLine);
                    Match ErrorMatch = errorRegex.Match(CurrentLine);

                    string date = DateMatch.Groups[0].Value.Trim();
                    string errorType = string.Empty;
                    string description = string.Empty;

                    //Check if error type and description is residing in the current line, otherwise, check at the next line
                    if (!ErrorMatch.Groups["type"].Value.Equals("") && !ErrorMatch.Groups["description"].Value.Equals(""))
                    {
                        errorType = ErrorMatch.Groups["type"].Value.Trim();
                        description = ErrorMatch.Groups["description"].Value.Trim();
                    }
                    else
                    {
                        NextLine = sReader.ReadLine();
                        ErrorMatch = errorRegex.Match(NextLine);
                        errorType = ErrorMatch.Groups["type"].Value.Trim();
                        description = ErrorMatch.Groups["description"].Value.Trim();
                    }

                    Error NewError = new Error();
                    NewError.Date = date;
                    NewError.ErrorType = errorType;
                    NewError.Description = description;

                    //a bit lazy with the regex, just take the first sentence of the description if it has multiple sentences.
                    if (NewError.Description.Contains(". "))
                        NewError.Description = NewError.Description.Substring(0, NewError.Description.IndexOf(". "));

                    // Do not add if it's a custom exception.
                    if(!NewError.Description.Equals("") && !NewError.Description.Equals(""))
                        errorLog.Add(NewError);
                }
            }
        }

        return errorLog;

    } 
```

# sql - SQL 报告 - 根据与其相邻的另一列中提到的日期对列进行排序

> ID：10537599
> 
> 赞同：0
> 
> 时间：2012-05-10T15:42:52.063
> 
> 标签：sql

如果有人可以帮助我，那就太好了。我是 SQL 新手。这就是我的表格数据

表名：emp

```
e_no    e_name        e_jobrole      position   promotion_date
1   Robin   Sales           CEO 01/01/2012
1   Robin   Sales           CFO 20/01/2010
2   Jackman Sales - S1  EMP 01/04/2009
4   Sheldon Marketing   MGR 15/08/2012
4   Sheldon Marketing   SNRMGR  01/01/2011
4   Sheldon Marketing   MGR 01/01/2011
3   Arnold  Marketing   CEO 09/09/2009
5   Emmy    Marketing   SNRMGR  08/08/2008
6   Penny   Admin           SNRMGR  05/05/2012
6   Penny   Admin           MGR 09/09/2007 
```

通过排序这些人的晋升日期，我需要获取员工之前担任的职位并与当前职位相邻。这可能吗 ？

以下是我需要的输出

e_no e_name e_job prev_pos curr_pos Promotion_date 1 Robin Sales CFO CEO 01/01/2012 2 Jackman Sales - S1 不可用 EMP 01/04/2009 4 Sheldon Marketing MGR MGR 15/08/2012 3 Arnold Marketing 不可用 CEO 09/09/2009 5 Emmy Marketing 不可用 SNRMGR 08/08/2008 6 Penny Admin MGR SNRMGR 05/05/2012

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-10T15:53:48.370

编辑：我似乎在发布后几秒钟就被证明是错误的：P

我认为您不能在一个查询中做到这一点（使用复杂的存储过程除外）。

如何将数据导入应用程序（在 Java 中，或任何您想要的），然后从最旧的数据中解析数据，并跟踪每个员工的“先前位置”。然后，每当你找到一个你已经有了“以前的位置”的人时，你可以将它插入到表格中，并更新“以前的位置”（如果你以前没见过她，请设置“以前的位置” " 为 null/"none"/""/etc)。

那会有用吗，还是必须全部在数据库上完成？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-10T15:53:58.980

像这样的东西应该工作。WHERE 和 HAVING 的组合可能需要一些调整。

```
select 
  c.e_no, 
  c.e_name, 
  c.e_job, 
  p.position as prev_position, 
  c.position as curr_position, 
  c.promotion_date
from 
  emp c
inner join
  emp p
on 
  c.e_no=p.e_no
group by
  c.e_no, 
  c.e_name, 
  c.e_job, 
  p.position as prev_position, 
  c.position as curr_position, 
where 
  p.promotion_date < c.promotion_date
having 
  max(p.promotion_date),
  max(c.promotion_date) 
```

# css - 加载不同的css

> ID：10537602
> 
> 赞同：0
> 
> 时间：2012-05-10T15:42:59.527
> 
> 标签：css, ruby-on-rails-3, activeadmin

我有带有`active_admin`. `Active_admin`生成器被生成`active_admin.css`。在我的页面（例如`/projects`）上，我得到了混合的 css 文件（我的`style.css`和`active_admin.css`）。如何分离加载样式表文件？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-10T15:47:21.867

使用 Javascript，您可以检查您想要的任何内容并包含您想要的 css

[http://www.javascriptkit.com/javatutors/loadjavascriptcss.shtml](http://www.javascriptkit.com/javatutors/loadjavascriptcss.shtml)

或者你可以在红宝石中尝试这样的..

该示例在 php 中

[http://snipplr.com/view/63586/wpconditional-css-files-loading/](http://snipplr.com/view/63586/wpconditional-css-files-loading/)

# sql-server - 如何将描述属性添加到 SSMS 中的表设计器视图？

> ID：10537610
> 
> 赞同：11
> 
> 时间：2012-05-10T15:43:38.367
> 
> 标签：sql-server, sql-server-2008-r2

在 SSMS（当前运行 SQL Server 2008 R2）中，我想在表设计器窗口中的`Description`属性旁边添加该属性。`Allow Nulls`

我已经查看了注册表更改以设置 null 属性的默认值，如此答案所示[如何将 SSMS 的表设计器中的 Allow Nulls 属性设置为始终为假？](https://stackoverflow.com/questions/10166187/how-do-i-set-the-allow-nulls-property-in-table-designer-of-ssms-to-be-always-fal)但是，我无法弄清楚如何将新属性添加到新的表设计器视图中。

我认为以下注册表项会有所帮助。

> HKEY_CURRENT_USER\Software\Microsoft\Microsoft SQL Server\100\Tools\Shell\DataProject\

```
SSVPropViewColumnsSQL70
SSVPropViewColumnsSQL80 
```

我将上述键的注册表项从更改`1,2,6;`为，**`1,2,6,9;`**但设计器中没有任何更改。

有没有人对此有任何额外的想法？

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2012-05-10T16:24:16.087

以下是将属性添加到 SQL Server Management Studio 中的表设计器的步骤。这些步骤涉及更改注册表设置中的值。

### `NOTE: Please be careful while altering registry keys.`

*   在 Windows 开始 --> 运行命令中键入 regedit 以打开注册表编辑器。

*   导航`HKEY_CURRENT_USER\Software\Microsoft\Microsoft SQL Server\100\Tools\Shell\DataProject`

*   您可能需要相应地更改 SQL Server 版本。我使用的是 SQL Server 2008 R2 Express，因此使用的是版本 100。对于 SQL Server 2012，我在下面找到了这个设置`HKEY_CURRENT_USER\Software\Microsoft\SQL Server Management Studio\11.0\DataProject`

*   在上述注册表路径下，查找键`SSVPropViewColumnsSQL70`和`SSVPropViewColumnsSQL80`.

*   默认情况下，这些注册表项将具有值`1,2,6;`。下面提到的部分*属性序列显示了与每个属性关联的编号。*为了满足将 Description 列添加到表设计器的要求，我必须将注册表项值更改为**`1,2,6,17;`**

*   右键单击该键并选择`Modify`选项。将值从 更改`1,2,6;`为**`1,2,6,17;`**。这必须在键`SSVPropViewColumnsSQL70`和`SSVPropViewColumnsSQL80`

*   **`NOTE: Remember to restart SSMS between each registry change.`**

### 属性顺序：

1.  列名
2.  数据类型
3.  长度
4.  精确
5.  规模
6.  允许空值
7.  默认值
8.  身份
9.  身份种子
10.  身份增量
11.  行 GUID
12.  可空的
13.  浓缩型
14.  不用于复制
15.  公式
16.  整理
17.  描述

希望这可以帮助某人。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2018-12-20T09:06:33.837

对于那些正在寻找 .REG 文件来实现此目的的人，请将这些行复制/粘贴到具有 .REG 扩展名的文本文件中。双击它以将其添加到您的注册表中。[Pithhelmet](https://stackoverflow.com/a/10538313/914490)在答案中列出了列号。下面的示例使用“14.0”表示从 SQL 2017 开始作为独立工具发布的 SSMS 版本。我预计注册表路径将继续保持在 14.0 一段时间，即使定期发布 SSMS 更新也是如此。

```
Windows Registry Editor Version 5.00

[HKEY_CURRENT_USER\Software\Microsoft\SQL Server Management Studio\14.0\DataProject]
"SSVPropViewColumnsSQL70"="1,2,6,3,7,8,17;"
"SSVPropViewColumnsSQL80"="1,2,6,3,7,8,17;" 
```

请注意，将这些更改应用于注册表时，您需要关闭 SSMS。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2017-10-12T09:48:06.903

对于 SQL-Server-Management Studio 2014 (SSMS 2014)，获取“描述”列 (17) 有点棘手：

1）打开SSMS 2014，等待Login-Dialog出现。（不要点击“连接”！） [![在此处输入图像描述](../Images/a7d5182caa61846b8de0da8fe01a6fce.png)](https://i.stack.imgur.com/3HuMh.png)

2a) 打开 Regedit，转到：“HKEY_USERS\S-1...###YOUR-WINDOWS-USER-SID###-\SOFTWARE\Microsoft\SQL Server Management Studio\12.0\DataProject”

2b) 更改键：SSVPropViewColumnsSQL70 和 SSVPropViewColumnsSQL80 从 1、2、6；到 1,2,6,17；

3) 现在在 SSMS 2014 登录对话框中单击“连接”。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2019-09-06T11:04:19.030

对于 SQL Server Management Studio 版本 18.x (2019)：
打开 Regedit 并转到：“Computer\HKEY_CURRENT_USER\Software\Microsoft\SQL Server Management Studio\18.0_IsoShell\DataProject”，然后从 1,2 更改 SSVPropViewColumnsSQL70 和 SSVPropViewColumnsSQL80 数据,6; 到 1,2,6,17

# regex - Perl 正则表达式否定多个单词

> ID：10537613
> 
> 赞同：0
> 
> 时间：2012-05-10T15:43:49.887
> 
> 标签：regex, perl

我需要为 jMeter 测试排除一些 URL：

不排除：

```
http://foo/bar/is/valid/with/this
http://foo/bar/is/also/valid/with/that 
```

排除：

```
http://foo/bar/is/not/valid/with/?=action
http://foo/bar/is/not/valid/with/?=action
http://foo/bar/is/not/valid/with/specialword 
```

请帮我？

我的以下正则表达式不起作用：

```
foo/(\?=|\?action|\?form_action|specialword).* 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-10T15:51:18.340

第一个问题：`/`是通用分隔符，所以使用`\/`或更改分隔符进行转义。第二个问题：它只会匹配`foo/action`等等，你需要在括号前包含一个通配符：`foo\/.*(\?=|\?action|\?form_action|specialword).*`

所以：

```
/foo\/.*(\?=|\?action|\?form_action|specialword).*/ 
```

下一个问题是这将匹配相反的内容：您的排除。你可以微调你的正则表达式来做相反的事情，或者你可以用你的语言处理这个（即如果没有匹配，做这个和那个）。

始终注意正则表达式中的特殊字符。也见[这里](http://www.regular-expressions.info/reference.html)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-10T16:27:18.897

有无数种方法可以用正则表达式击中自己的脚。您可以在循环中使用 /g 和 /c 编写某种“解析器”，但何必呢？您似乎已经在使用当前的正则表达式时遇到了问题。

把问题分解成更小的部分，一切都会变得不那么复杂。您可以为自己编写某种*过滤器*，`grep`例如：

```
sub filter {
    my $u = shift;
    my $uri = URI->new($u);
    return undef if $uri->query;
    return undef if grep { $_ eq 'specialword' } $uri->path_segments;
    return $u;
}

say for grep {filter $_} @urls; 
```

我不会那么坚持正则表达式，特别是如果其他人也必须阅读代码......

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-10T16:15:40.310

将正则表达式分隔符更改为“/”以外的其他内容，这样您就不必在匹配项中对其进行转义。你可能会这样做：

```
m{//foo/.+(?:\?=action|\?form_action|specialword)$}; 
```

?: 表示仅分组。

使用它，您可以说：

```
print unless m{//foo/.+(?:\?=action|\?form_action|specialword)$}; 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-10T16:20:42.083

你的交替是错误的。`foo/(\?=|\?action|\?form_action|specialword)`匹配任何一个

*   `foo/?=`
*   `foo/?action`
*   `foo/?form_action`
*   `foo/?specialword`

所以你需要

```
m{foo/.*(?:\?=action|\?=form_action|specialword)} 
```

有`.*`必要考虑到可能`bar/is/valid/with/this`发生的情况`/foo/`。

请注意，我已将您更改`( .. )`为非捕获`(?: .. )`，并且我使用大括号作为正则表达式分隔符以避免必须转义表达式中的斜杠。

最后，您需要编写

```
unless ($url =~ m{/foo/.*(?:\?=action|\?=form_action|specialword)}) { ... } 
```

或者

```
if ($url !~ m{/foo/.*(?:\?=action|\?=form_action|specialword)}) { ... } 
```

因为正则表达式匹配要*丢弃*的 URL 。

# sql-server - 我需要在 ASP Classic 中关闭嵌套的 MSSQL 更新命令吗？

> ID：10537617
> 
> 赞同：2
> 
> 时间：2012-05-10T15:44:04.333
> 
> 标签：sql-server, asp-classic, vb6, dreamweaver

使用 Dreamweaver CS5，我添加了以下运行良好的服务器行为。

问题是，我需要关闭 MM_rsUser1 吗？

自动生成的代码会关闭 MM_rsUser，但是当我尝试在关闭 MM_rsUser 之前或之后的行上关闭 MM_rsUser1 时，页面会失败。

我发现这个[关于 MySql](https://stackoverflow.com/questions/3359716/do-i-really-need-to-do-mysql-close)的参考资料似乎表明我可能不需要，但由于这是我的第一个项目，我正在努力学习尽可能多的“好习惯”......而且由于 Dreamweaver 正在生成大部分VB 代码，我不想“假设”它对我的作用必然是当今的最佳实践。（该项目正在添加动态数据并将所述数据编辑到预先存在的经典 ASP 站点......我的下一个项目将把它升级到 MVC/C#）

```
<%
' *** Validate request to log in to this site.
MM_LoginAction = Request.ServerVariables("URL")
If Request.QueryString <> "" Then MM_LoginAction = MM_LoginAction + "?" + Server.HTMLEncode(Request.QueryString)
MM_valUsername = CStr(Request.Form("userid"))
If MM_valUsername <> "" Then
  Dim MM_fldUserAuthorization
  Dim MM_redirectLoginSuccess
  Dim MM_redirectLoginFailed
  Dim MM_loginSQL
  Dim MM_rsUser
  Dim MM_rsUser_cmd
  Dim MM_loginUpdate ' used to execute timestamp to log last successful login for user
  Dim MM_rsUser1 '     also used to execute timestamp as above

  MM_fldUserAuthorization = "accessLevel"
  MM_redirectLoginSuccess = "/sql.asp"
  MM_redirectLoginFailed = "/login.asp"

  MM_loginSQL = "SELECT email, password"
  If MM_fldUserAuthorization <> "" Then MM_loginSQL = MM_loginSQL & "," & MM_fldUserAuthorization
  MM_loginSQL = MM_loginSQL & " FROM table WHERE userid = ? AND pword = ?"
  Set MM_rsUser_cmd = Server.CreateObject ("ADODB.Command")
  MM_rsUser_cmd.ActiveConnection = MM_SQL_STRING
  MM_rsUser_cmd.CommandText = MM_loginSQL
  MM_rsUser_cmd.Parameters.Append MM_rsUser_cmd.CreateParameter("param1", 202, 1, 50, MM_valUsername) ' adVarWChar
  MM_rsUser_cmd.Parameters.Append MM_rsUser_cmd.CreateParameter("param2", 202, 1, 50, Request.Form("password")) ' adVarWChar
  MM_rsUser_cmd.Prepared = true
  Set MM_rsUser = MM_rsUser_cmd.Execute

  If Not MM_rsUser.EOF Or Not MM_rsUser.BOF Then 
    ' username and password match - this is a valid user
    Session("MM_Username") = MM_valUsername
    MM_loginUpdate = "UPDATE table SET lastLoggedIn = { fn NOW() } WHERE userid = '" & MM_valUsername & "'"
    MM_rsUser_cmd.CommandText = MM_loginUpdate
    Set MM_rsUser1 = MM_rsUser_cmd.Execute ' unsure if I have to write an MM_rsUser1.Close somewhere or not, but page fails where I've tried
    If (MM_fldUserAuthorization <> "") Then
      Session("MM_UserAuthorization") = CStr(MM_rsUser.Fields.Item(MM_fldUserAuthorization).Value)
    Else
      Session("MM_UserAuthorization") = ""
    End If
    if CStr(Request.QueryString("accessdenied")) <> "" And true Then
      MM_redirectLoginSuccess = Request.QueryString("accessdenied")
    End If
    MM_rsUser.Close
    Response.Redirect(MM_redirectLoginSuccess)
  End If
  MM_rsUser.Close
  Response.Redirect(MM_redirectLoginFailed)
End If
%> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-10T16:03:17.623

乍一看，代码有点棘手。我看到 2 个关闭 MM_rsUser 的语句。Response.Redirect() 就像一个返回语句，所以只会执行一个或另一个，即使 IF 块倾向于使它看起来不一样。我认为对您来说关键是如果您不输入 IF 块，您将无法关闭 MM_rsUser1，因为它从未被打开过。所以我建议这样做：

```
 If Not MM_rsUser.EOF Or Not MM_rsUser.BOF Then 
        ' username and password match - this is a valid user
        Session("MM_Username") = MM_valUsername
        MM_loginUpdate = "UPDATE table SET lastLoggedIn = '" & NOW() & "' WHERE userid = '" & MM_valUsername & "'"
        MM_rsUser_cmd.CommandText = MM_loginUpdate
        Set MM_rsUser1 = MM_rsUser_cmd.Execute ' unsure if I have to write an MM_rsUser1.Close somewhere or not, but page fails where I've tried
        If (MM_fldUserAuthorization <> "") Then
            Session("MM_UserAuthorization") = CStr(MM_rsUser.Fields.Item(MM_fldUserAuthorization).Value)
        Else
            Session("MM_UserAuthorization") = ""
        End If
        if CStr(Request.QueryString("accessdenied")) <> "" And true Then
            MM_redirectLoginSuccess = Request.QueryString("accessdenied")
        End If
        MM_rsUser1.Close 'close it here
        MM_rsUser.Close
        Response.Redirect(MM_redirectLoginSuccess)
    End If 'Not MM_rsUser.EOF Or Not MM_rsUser.BOF 
    'not open, so don't close it
    MM_rsUser.Close
    Response.Redirect(MM_redirectLoginFailed)
End If 'MM_valUsername <> "" 
```

**更新**

重用 MM_rsUser_cmd 充其量是令人困惑的，并且可能是某些错误的原因。改变

```
MM_rsUser_cmd.CommandText = MM_loginUpdate
Set MM_rsUser1 = MM_rsUser_cmd.Execute 
```

至

```
Dim MM_rsUser_cmd1 
Set MM_rsUser_cmd1 = Server.CreateObject ("ADODB.Command")
MM_rsUser_cmd1.ActiveConnection = MM_SQL_STRING
MM_rsUser_cmd1.CommandText = MM_loginUpdate
MM_rsUser_cmd1.Parameters.Append MM_rsUser_cmd1.CreateParameter("param1", 135, 1, -1, NOW()) ' adDBTimeStamp 
MM_rsUser_cmd1.Parameters.Append MM_rsUser_cmd1.CreateParameter("param2", 202, 1, 50, MM_valUsername) ' adVarWChar
MM_rsUser_cmd1.Prepared = true
Set MM_rsUser1 = MM_rsUser_cmd1.Execute 
```

# java - 双击启动时无法从jar打开资源

> ID：10537620
> 
> 赞同：3
> 
> 时间：2012-05-10T15:44:13.977
> 
> 标签：java, resources, jar, double-click

我一直在努力解决这个问题一段时间。我发现[了这个](https://stackoverflow.com/questions/5608286/runnable-jar-runs-fine-with-java-jar-but-problems-with-double-click)和[这个](https://stackoverflow.com/questions/8768122/cant-run-a-jar-file-from-the-double-click)，但这些解决方案对我根本不起作用。

我的 jar 在命令提示符下与 java -jar 完美配合，但是当双击时，会打开一个 JFrame 窗口，但在这些窗口上失败：

```
Scanner fileLat = new Scanner( a.getClass().getResourceAsStream("/motor/resources/lat.txt") );
Scanner fileLong = new Scanner( a.getClass().getResourceAsStream("/motor/resources/long.txt") ); 
```

导致空指针异常和找不到资源。

我的目录结构（在 jar 内）如下所示：

```
/ (root)
|- META-INF
|- motor
 |- main
  |- Main.class
 |- resources
  |- lat.txt
  |- long.txt 
```

我的 MANIFEST.MF 内容如下：

```
Manifest-Version: 1.0
Class-Path: .
Main-Class: motor.main.Main 
```

编辑：我刚刚尝试过[这个](https://stackoverflow.com/questions/2073250/eclipse-export-to-jar-and-include-resource-files-ant)（特别是 jar:file:MyJar.jar!/etc...），它也没有工作。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-10T16:35:26.960

您是否尝试`Class-Path`从清单中删除？在我这里的示例中定义类路径并不常见：许多应用程序（包括 jEdit 和 jExt 安装程序）将在没有它的情况下运行。

您也可以尝试添加一个空的。

# java - 泛型类型声明导致错误

> ID：10537624
> 
> 赞同：1
> 
> 时间：2012-05-10T15:44:28.793
> 
> 标签：java, generics

简而言之，我有：

```
public interface Dictionary<E extends Comparable<E>> extends Iterable<E> { 
```

和

```
public class TreeDictionary implements Dictionary<TreeDictionary> { 
```

编译时，导致错误

> TreeDictionary.java:4：类型参数 TreeDictionary 不在其绑定内 public class TreeDictionary implements Dictionary {

我想原因可能是因为我对 Dictionary 接口的声明并不完全清楚。

如果有人能向我解释这一点，我将不胜感激:)

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-10T15:47:45.000

```
public interface Dictionary<E extends Comparable<E>> 
```

也就是说，无论您要使用哪种类型`E`，它都必须实现`Comparable`接口。

鉴于您的`TreeDictionary`定义：

```
public class TreeDictionary implements Dictionary<TreeDictionary> 
```

`TreeDictionary`没有实现`Comparable`，因此不能`E`在 的泛型类型中替换`Dictionary`。

试试这个：

```
public class TreeDictionary implements Dictionary<TreeDictionary>, Comparable<TreeDictionary> 
```

`TreeDictionary`现在应该符合 的约束`E`。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-10T15:48:28.183

您的 TreeDictionary 类也应该实现 Comaparable 接口。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-10T15:49:42.363

您需要实现 Comparable 接口才能使其工作

公共类 TreeDictionary 实现 Dictionary, Comparable

希望能帮助到你

# c# - 使用 LINQ 组语句获取多个字段

> ID：10537628
> 
> 赞同：1
> 
> 时间：2012-05-10T15:44:47.810
> 
> 标签：c#, linq

我在我的 LINQ 语句中使用了以下分组。

我已经想出了如何从'notes'表中获取最大日期，但是我正在努力寻找一种有效的方法来找到同一记录的'NoteText'属性（在两个地方都用????突出显示）

```
group new { t1, notes } by new
{
    t1.Opportunity_Title
} into g

let latestNoteDate = g.Max(uh => uh.notes.Date)
let latestNote = g.Max(uh => uh.notes.NoteText) < needs to be latest note for record above ^

select new PipelineViewModel
{
    LastNoteDate = latestNoteDate,
    LastNote = latestNote,  ????
}).Take(howMany); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-10T15:52:49.930

或许是这样的：

```
let latestNote = latestNoteDate == null ? null : 
                 g.First(x => x.notes.Date == latestNoteDate).NoteText 
```

# ios - iOS 5.1 OpenGL ES 2.0 - 纹理钳位问题

> ID：10537629
> 
> 赞同：0
> 
> 时间：2012-05-10T15:44:50.293
> 
> 标签：ios, opengl-es, textures

我只是想重复使用 iOS 5.1 GLKit 改进加载的纹理，我已经绘制到一个简单的四边形上。

这是顶点和texCoords

```
#define ROAD_TEX_COORD_MAX  10

const Vertex roadVertices[] = 
{
    { {  90, -90, 0 } , { 1, 1, 1, 1 }, { ROAD_TEX_COORD_MAX, 0                  } }, // Bot R - 0
    { {  90,  90, 0 } , { 1, 1, 1, 1 }, { ROAD_TEX_COORD_MAX, ROAD_TEX_COORD_MAX } }, // Top R - 1
    { { -90,  90, 0 } , { 1, 1, 1, 1 }, { 0                 , ROAD_TEX_COORD_MAX } }, // Top L - 2
    { { -90, -90, 0 } , { 1, 1, 1, 1 }, { 0                 , 0                  } }  // Bot L - 3
};

const GLubyte roadIndices[] = 
{
    0, 1, 2,
    2, 3, 0
}; 
```

这是渲染例程：

```
- ( void ) render
{
    [self.baseEffect prepareToDraw];

    glBindBuffer( GL_ARRAY_BUFFER, vertexBuffer );
    glBindBuffer( GL_ELEMENT_ARRAY_BUFFER, indexBuffer );

    glEnableVertexAttribArray( GLKVertexAttribPosition );        
    glVertexAttribPointer( GLKVertexAttribPosition, 3, GL_FLOAT, GL_FALSE, sizeof( Vertex ), ( const GLvoid * ) offsetof( Vertex, Position ) );
    glEnableVertexAttribArray( GLKVertexAttribColor );
    glVertexAttribPointer( GLKVertexAttribColor, 4, GL_FLOAT, GL_FALSE, sizeof( Vertex ), ( const GLvoid * ) offsetof( Vertex, Color ) );
    glEnableVertexAttribArray( GLKVertexAttribTexCoord0 ); 
    glVertexAttribPointer( GLKVertexAttribTexCoord0, 2, GL_FLOAT, GL_FALSE, sizeof( Vertex ), ( const GLvoid * ) offsetof( Vertex, TexCoord ) );

    glDrawElements( GL_TRIANGLES, sizeof( roadIndices ) / sizeof( roadIndices[0] ), GL_UNSIGNED_BYTE, 0 );
} 
```

然而，这就是我最终的结果：

![在此处输入图像描述](../Images/2ebc59db6c0423750536f656113b59d4.png)

现在我已经阅读了默认情况下使用 REPEAT 纹理设置的 EAGL 设置，您必须手动将其设置为 CLAMP_TO_EDGE。但是，这里的情况并非如此——我没有设置其中任何一个（尽管我尝试禁用 CLAMP 并启用 REPEAT 并且所做的只是使四边形变黑并且看不到任何纹理。

# jquery - 加载网格时默认弹出jqGrid搜索框选项

> ID：10537632
> 
> 赞同：1
> 
> 时间：2012-05-10T15:44:59.590
> 
> 标签：jquery, jqgrid

我正在使用以下 jqgrid 代码：

```
 jQuery("#list2").jqGrid({
        url:'<?php echo $url;?>',
        datatype: "json",
        colNames:[
            <?php 
                $sep = "";
                foreach($columns as $col){
                    echo $sep . "'" . $col['header'] . "'";                         
                    $sep = ","; 
                }
            ?>
        ],
        colModel:[              
            <?php 
                $sep = "";
                foreach($columns as $col){
                    echo $sep . "{name:'" . $col['name'] . "',index:'" . $col['name'] . "', width:" . $col['width'] . ", sortable:true, search:true}"; 
                    $sep = ","; 
                }
            ?>      
        ],
    rowNum:100,
    rowList:[100,200,300,400],
    pager: '#pager2',
        loadonce: true,
        sortname: 'geneID',
        viewrecords: true,
        width:700,
        shrinkToFit:false,
        height:700,
        sortorder: "desc",
    caption:"Breeder Tool Box"
    });

jQuery("#list2").navGrid('#pager2',{add: false, edit: false, del: false,search : true ,     refresh : true},{},{},{});
jQuery("#list2").searchGrid({multipleSearch:true});  // For Adding the Multiple Search Option on the jqgrid 
```

每当加载网格时，搜索框就会默认打开。

我只在单击 jqgrid 工具栏下部的搜索选项后才尝试获取搜索框

您能否指出我的代码中缺少/错误的部分

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-10T17:49:01.073

从[wiki](http://www.trirand.com/jqgridwiki/doku.php?id=wiki%3aadvanced_searching)参考 searchGrid 方法

```
Typically when this method is called it launches the modal dialog and makes it so the grid inaccessible until the dialog is closed.
This method is not the default search method in the navigator. To enable this you should either set the default search options using the extend method or set it in the navigator in the place of the search options. 
```

因此，您调用的是搜索模式，而不是分配网格以具有搜索模式。您应该以这种方式分配多个搜索：

```
jQuery("#list2").navGrid('#pager2',
{add: false, edit: false, del: false,search : true ,refresh : true},
{},
{},
{},
{multipleSearch:true}); 
```

那么这一行应该被删除：

```
jQuery("#list2").searchGrid({multipleSearch:true}); 
```

# .net - 防止误点击datagridview

> ID：10537642
> 
> 赞同：0
> 
> 时间：2012-05-10T15:45:40.370
> 
> 标签：.net, winforms, exception, data-binding, datagridview

我有一个datagridview，我想通过按钮事件将一些行复制到集合中。这里出现了两个问题。

1.  如果我在网格外单击，它不应该触发它，因为它会引发异常。如何预防？

2.  第二个似乎很简单？它是一个空数据行，那么它也应该被禁止。

    ```
     private void btnAdd_Click(object sender, EventArgs e)
    {
        try
        {
            if (// need condition here.)
            {
                DataRowView currentDataRowView = (DataRowView)DataGridView1.CurrentRow.DataBoundItem;
                DataRow row = currentDataRowView.Row;
                DataRowlist.Add(row);
            }
        }
        catch (Exception ex)
        {
            MessageBox.Show(ex.Message);
        }
     } 
    ```

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-10T16:00:18.597

只需检查是否有当前行：

if (DataGridView1.CurrentRow != null) { ... }

# asp.net-mvc-3 - MVC3 帖子上的空模型

> ID：10537646
> 
> 赞同：1
> 
> 时间：2012-05-10T15:46:14.597
> 
> 标签：asp.net-mvc-3, post, model

我有有数据的模型。我只用 on 按钮创建表单，我不在那里使用模型的数据。当我按下按钮时，它会正确转到 HTTPPOST 方法，但模型完全是空的。

**HTML：**

```
@model ViewModels.RequestDeletionViewObject
@using (Html.BeginForm())
  {
     <input type="submit" value="submit"/>
  } 
```

**请求删除视图对象：**

```
public class RequestDeletionViewObject : ViewModelBase 
    { 
        public TreeGridData NodeFilespacesData { get; set; } 
        public Dictionary<long, string> EmailList{ get; set; } 
    } 
```

**控制器：**

```
public ActionResult RequestDel() 
        { 

            return View(_businessLogic.GetData()); 

        } 

        [HttpPost] 
        public ActionResult RequestDel(RequestDeletionViewObject model)  
        { 
            return View(_businessLogic.GetData());  
        } 
```

请帮助我，我在许多其他地方做过类似的事情，它在那里工作，但不是在这里，我不知道我错过了什么？谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-10T16:55:50.920

您的表单中没有任何表单控件。表单只会发布表单控件（文本框、隐藏字段、复选框等）中的数据。

发送到视图的数据无关紧要，它只会在表单内的表单控件中回发数据。

# c# - 将一段文本绘制到控制台中的某个位置？

> ID：10537650
> 
> 赞同：2
> 
> 时间：2012-05-10T15:46:16.160
> 
> 标签：c#, console-application

我知道如何设置控制台的光标位置，但是在创建新行时，光标会移回控制台的左侧。

如何在保留光标`x`坐标的同时设置光标位置并写入多行？

注意：请注意，我可以选择为每一行设置光标位置，因为我的文本块经常改变大小。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-10T15:50:33.800

```
void WriteLineKeepingIndent(string format, params object[] args)
{
    int x = Console.CursorLeft;
    Console.WriteLine(format, args);
    Console.CursorLeft = x;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-10T15:51:51.427

您应该使用其中一种

1.  在每个**Console.WriteLine()**之前设置**Console.CursorLeft**
2.  在字符串上使用**PadLeft**方法

# c# - 在 C# 中正确处理 COM 互操作对象，尤其是 MS Office 应用程序

> ID：10537651
> 
> 赞同：14
> 
> 时间：2012-05-10T15:46:19.967
> 
> 标签：c#, .net, garbage-collection, ms-office, office-interop

我正在开发一个严重依赖多个 Microsoft Office 产品的应用程序，包括 Access、Excel、Word、PowerPoint 和 Outlook 等。在对互操作进行研究时，我发现从 VS2010 和 .NET 4 开始，幸运的是我们不再需要经历 PIA 的噩梦。

此外，我一直在阅读很多关于正确处理物品的文章，最明智的似乎是[这篇](http://www.xtremevbtalk.com/showthread.php?p=1326018)文章。

但是，这篇文章已有 5 年历史，关于 AFAIK 主题的权威出版物并不多。以下是来自上述链接的代码示例：

```
' Cleanup:
GC.Collect()
GC.WaitForPendingFinalizers()
GC.Collect()
GC.WaitForPendingFinalizers()

Marshal.FinalReleaseComObject(worksheet)

oWB.Close(SaveChanges:=False)
Marshal.FinalReleaseComObject(workbook)

oApp.Quit()
Marshal.FinalReleaseComObject(application) 
```

我想知道的是按照今天的标准，这有多准确，如果我希望在未来几年内支持我的申请，我应该注意什么？

**更新：**非常感谢提供一些可信文章的链接。顺便说一句，这不是服务器端应用程序。这将在计算机实验室中运行，我们让用户与我们为他们实例化的办公产品进行交互。

**找到它：** [这篇](http://msdn.microsoft.com/en-us/library/aa679805%28v=office.11%29.aspx)由三部分组成的文章可能是我期望找到的最接近权威帐户的文章。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-10T16:08:52.137

对象超出范围后应该由 GC 自动处理。如果您需要尽快发布它们，可以使用 Marshal.ReleaseComObject [http://msdn.microsoft.com/en-us/library/system.runtime.interopservices.marshal.releasecomobject.aspx](http://bit.ly/KIE0VC)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-10T16:29:00.240

根据您通过互操作控制的 Office 版本以及服务器上发生的情况，是的，您可能需要进行一些严重的卷积以摆脱正在运行的 Office 应用程序之一的实例。存在不可预知的（和不必要的）对话框，例如，Word 在非交互式时会打开（没有一个 Office 应用程序特别适合无人值守执行，因此建议即使使用最新版本也不会安装它们服务器端使用）。

对于服务器案例，请考虑使用 Aspose 的堆栈而不是 Office 或其他替代方案。对于交互式的本地用例，您有时可能需要“额外的强力杀戮”，因为 Office 自动化服务器是表现特别糟糕的非托管对象。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-05-10T16:34:22.733

如果您想完全释放 COM 对象，尤其是在 MS Office COM 对象中，强烈建议您释放父对象内必须使用的子对象。

在您的示例中，我会说在释放单元格、范围或任何其他对象所属的工作表之前释放您可能使用过的所有 Cell、Range 任何其他对象。

# java - 读取列中的数组输出

> ID：10537654
> 
> 赞同：0
> 
> 时间：2012-05-10T15:46:26.123
> 
> 标签：java, arrays, sorting

我的主要目的是获得这种输出：它显示值和它在数组中出现的次数。下面是一个示例，但在代码中，我会要求用户将数据整数输入到数组中

例如对于数组： {-12, 3, -12, 4, 1, 1, -12, 1, -1, 1, 2, 3, 4, 2, 3, -12} 输出应该是：

```
 N  Count
 4  2
 3  3
 2  2
 1  4
-1  1
-12 4 
```

下面是我自己的尝试，但由于某种原因，我无法存储要存储的数组，并在代码的其他部分使用：

```
import java.util.*;
public class Q4 
{    
    /**
     * @param args
     */
    public static void main(String[] args) 
    {
        // TODO Auto-generated method stub
        int[] myarray = new int[50];

        System.out.println("Enter integers into the system, to quit enter -99");
        Scanner scan=new Scanner(System.in);

        for(int i = 0; i<myarray.length; i++)
        {
            int temp =scan.nextInt();
            if(temp!=(-99))
            {   
                myarray[i]=temp;
            }
            if(temp ==(-99))
            {
                System.out.println("Successfully terminated by inputting -99");
                System.out.println();
                break;
            }
            else if(i==(myarray.length-1))
            {
                System.out.println("successfully filled up array fully");
                System.out.println();
            }   
        }

        for(int i = 0; i<myarray.length; i++)
        {
            System.out.print(myarray[i]+",");
        }
        System.out.print("}");

        int temp=0;
        int number = 0;

        Arrays.sort(myarray);
        System.out.println("Array list: {");
        for (int i = 0; i < myarray.length; i++)
        {
            if(temp==0)
            {
                temp=myarray[i];
                number++;
            }
            else if (temp!=0)
            {
                if (temp==myarray[i])
                {
                    number++;
                }
                else
                {
                    temp=0;
                }
            }
        }
        System.out.print("}");  
        System.out.println();   
        System.out.println();   
        System.out.println("N"+"\t"+"\t"+"Count");
        System.out.println(temp+"\t"+"\t"+number);      
    }
} 
```

这是我的输出，这不是我想要的，

```
Enter integers into the system, to quit enter -99
12
3123
3123
11
22
-99
Successfully terminated by inputting -99

Array list: {12,3123,3123,11,22,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,}Array list: {
}

N       Count
3123        48 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-12T21:26:20.330

我要做的是创建一个具有两个实例的新节点类，即值和计数。每次遇到新数字时，使用其值创建一个新节点，并将其计数加一。有一个节点列表并将节点添加到此列表中。对于下一个输入，循环检查该值是否之前已经看过，例如。

```
for i = 0; i <list.size; i++
     if list.get(i).data == value // if it finds the value increment and break
            list.get(i).count++
            break;
     else if i==list.size-1//if it went through the list and didn't find the value, make a new node of the value and add it to the list
            make a new node
            add it to the list 
```

终止后，通过比较 list.get(i).values 和交换对列表进行排序（冒泡排序浮现在脑海中，但有很多排序方法）

之后只需打印值即可

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-10T15:52:49.243

您递增`number`以尝试计算当前`array[i]`出现的次数，但您从未将其值重置为 0。

`N Count`此外，在您的方法结束时，您只打印表格的一行。如果要为索引的每个唯一元素打印一行，您不需要打印多行吗？

有一种更简单的方法可以计算不需要排序的数组中元素的出现次数 - 提示，考虑使用`Map<Integer, Integer>`.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-10T16:02:23.297

你应该尝试以下事情。

```
import java.util.ArrayList;
import java.util.Enumeration;
import java.util.Hashtable;
import java.util.Scanner;

public class NumberRepetion {

    public static void main(String[] args) {
        int[] myarray = new int[50];

        System.out.println("Enter integers into the system, to quit enter -99");
        Scanner scan = new Scanner(System.in);

        ArrayList<Integer> myarrList = new ArrayList<Integer>();

        while (scan.hasNext()) {

            int temp = scan.nextInt();
            if (temp != (-99)) {

                // myarray[i] = temp;
                myarrList.add(temp);
            }
            if (temp == (-99)) {
                System.out.println("Successfully terminated by inputting -99");
                System.out.println();
                break;
            }

        }

        Hashtable<Integer, Integer> result = new Hashtable<Integer, Integer>();

        System.out.print("Input Values  {");

        int currIndex = 0 ;
        for (Integer val : myarrList) {
            if (currIndex == ( myarrList.size() - 1 )){
                System.out.print(val);
            }else{
                System.out.print(val + ", ");
            }
            currIndex++ ;
            int currVal = val;
            Integer integer = result.get(currVal);
            if (integer == null || integer == 0) {
                result.put(currVal, 1);
            } else {
                result.put(currVal, ++integer);
            }
        }
        System.out.print("}");
        System.out.println()

        Enumeration<Integer> keys = result.keys();
        System.out.println("N\t\tCount");

        while(keys.hasMoreElements()){
            System.out.println(" " +  keys.nextElement() +"\t\t" + result.get(keys.nextElement()));
        }

        //System.out.println("\n\n\n Result  " + result);

    }

} 
```

**输出**

```
Enter integers into the system, to quit enter -99
5
6
5
8
4
-99
Successfully terminated by inputting -99

Input Values    {5, 6, 5, 8, 4}
N       Count
 8      1
 5      1 
```

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2012-05-12T23:25:05.330

如果这不是关于如何使用数组的课程，我强烈建议与 List 和其他集合联系 - 但最好是 List，具体来说是 ArrayList。太方便了！这很容易。

有 3 或 4 种基本操作：构造函数来定义 List、添加元素、删除元素、迭代所有元素。

还有大约 50 种其他不常用的方法，以及使用列表的方法等等。

```
public static void main (String [] args)
{
    List <Integer> myarray = new ArrayList <Integer> ();
    System.out.println ("Enter integers into the system, to quit enter -99");
    Scanner scan = new Scanner (System.in);

    while (scan.hasNextInt ())
    {
        int temp = scan.nextInt ();
        if (temp == -99)
        {
            System.out.println ("Successfully terminated by inputting -99");
            System.out.println ();
            break;
        }
        else {
            myarray.add (temp);
            if (myarray.size () == 50)
            {
                System.out.println ("successfully filled array fully up");
                System.out.println ();
            }
        }
    }
    for (int i : myarray)
    {
        System.out.print (i + ",");
    }
    System.out.print ("}");

    Set <Integer> hsi = new HashSet <Integer> (); 
    hsi.addAll (myarray);

    Collections.sort (myarray);
    System.out.println ("Array list: {");
    int idx = 0;
    for (int i: hsi) {
        System.out.println (i + "\t" + Collections.frequency (myarray, i));
    }
    System.out.println (myarray.size ());
} 
```

看看有多简短？只需添加元素 - 您无需提前知道它包含多少元素。没有标记字段或外部值来标记必要的结束！

用法：

```
java Numbers
Enter integers into the system, to quit enter -99
4 44 0 33 2 2 7 9 1  4 3 90 -99 
Successfully terminated by inputting -99

4,44,0,33,2,2,7,9,1,4,3,90,}Array list: {
0   1
1   1
2   2
3   1
33  1
4   2
7   1
9   1
44  1
90  1
12 
```

您收集值的第一个想法，您喜欢通过索引获取或想要迭代，应该是 ArrayList，而不是普通的旧数组。数组仅在特殊情况下才有用 - 当您确定提前知道大小时。

ArrayLists 很快，相信它 - 不 - 不要相信它，测试它！

# tridion - 使用 SDL Tridion 2011 SP1 在富文本字段中创建锚链接

> ID：10537656
> 
> 赞同：6
> 
> 时间：2012-05-10T15:46:37.640
> 
> 标签：tridion, tridion-2011

我正在尝试在组件的 RTF 字段中使用锚按钮，并出现意外行为。使用设计视图中的 Chrome 浏览器，我突出显示/选择`<h2>My Heading</h2>`要用作锚点的标题（即），然后按锚点按钮并输入锚点名称（即 my_place）。

这导致以下代码显示在我的源选项卡中：

```
<a name="my_place" id="myplace"/><h2>My Heading</h2> 
```

由于自关闭`<a/>`标记，这会导致在浏览器中显示 HTML 时出现渲染问题。

我本来希望以下三个 HTML 片段之一被插入到 HTML 源代码中：

```
<a name="my_place" id="myplace"><h2>My Heading</h2></a> 
```

或者

```
<h2><a name="my_place" id="myplace">My Heading</a></h2> 
```

或者

```
<a name="my_place" id="myplace"><a><h2>My Heading</h2> 
```

有没有其他人经历过这个？或知道实现我所期望的方法（无需手动编辑 HTML）。或者这是产品当前版本中的错误。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-15T16:39:18.317

谢谢克里斯，我已经编辑了您的解决方案以满足我的要求，因此希望将来与此问题的任何人分享。

**注意：**这会移动锚点内的文本并删除锚点外的文本。修复了仅包含文本而非 html 的锚点。即我的解决方案修复了这个标签：

```
<p><a name="anchor1" id="anchor1"></a>Anchor text</p> 
```

至

```
<p><a name="anchor1" id="anchor1">Anchor text</a></p> 
```

但不是这个：

```
<p><a name="anchor1" id="anchor1"></a><h1>Anchor text</h1></p> 
```

这是我的xsl。希望它可以帮助您提供一个基础，我相信您可以轻松更新它以查找以下标签（我的解决方案不需要这个）。

```
<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
    <xsl:output omit-xml-declaration="yes" method="html" cdata-section-elements="script"/>
    <xsl:template match="/ | node() | @*">
        <xsl:copy>
            <xsl:apply-templates select="node() | @*"/>
        </xsl:copy>
    </xsl:template>

    <!-- fixes Tridion bug when using interface button to insert anchor in rich text field -->
    <!-- gets all empty anchor tags with an id and takes any following text and copies it inside anchor -->
    <xsl:template match="a[(@id) and (count(node()) = 0)]">
       <xsl:copy>
            <xsl:for-each select="@*">
                <xsl:attribute name="{name(.)}">
                    <xsl:value-of select="."/>                    
                </xsl:attribute>
            </xsl:for-each>
            <xsl:value-of select="normalize-space(following-sibling::text())"/>
        </xsl:copy>
    </xsl:template>
    <!-- delete any text after an empty anchor (template above has already copied this text inside the anchor) -->
    <xsl:template match="text()[preceding-sibling::a[(@id) and (count(node()) = 0)]]" ></xsl:template>
</xsl:stylesheet> 
```

这是我的测试 XML

```
<?xml version ="1.0"?>
<?xml-stylesheet type="text/xsl" href="tridionhtmlfield.xsl"?>
<html>
    <head></head>
    <body>
        <p><a id="anchorlink" name="anchorlink" title="Anchor link" href="#Anchor">Anchor link</a>Some text after</p>
        <p><a name="broken-with-html-name" id="broken-with-html-id"></a><h1>Anchor - broken with html</h1></p>
        <p><a name="broken-text-only-name" id="broken-text-only-id"></a>Anchor - broken text only</p>
        <p><a name="broken-notext-name" id="broken-notext-id"></a></p>
        <p><a name="correct-name" id="correct-id">Anchor - correctly rendered</a> Some text after</p>
    </body>
</html> 
```

改造后：

```
<html>
    <head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"></head>
    <body>
        <p><a id="anchorlink" name="anchorlink" title="Anchor link" href="#Anchor">Anchor link</a>Some text after</p>
        <p><a name="broken-with-html-name" id="broken-with-html-id"></a><h1>Anchor - broken with html</h1></p>
        <p><a name="broken-text-only-name" id="broken-text-only-id">Anchor - broken text only</a></p>
        <p><a name="broken-notext-name" id="broken-notext-id"></a></p>
        <p><a name="correct-name" id="correct-id">Anchor - correctly rendered</a> Some text after</p>
    </body>
</html> 
```

希望这可以帮助

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-05-10T19:48:17.120

附件是我的示例 XSLT 模板：

```
<template match="a[(@name) and (count(node()) = 0)]">
    <copy>
        <apply-templates select="@*"/>
        <xhtml:span xmlns:xhtml="http://www.w3.org/1999/xhtml" class="hidden"> </xhtml:span>
    </copy>
</template> 
```

这增加了比严格需要的多一点，但处理了由于内容交付端的 XML 操作而导致的其他一些问题。

本质上，它将所有空`a`标签与一个`name`属性匹配，并在它们之间添加一些东西以阻止它们自动关闭。在我们的例子中，我们使用 XSLT 对所有 XML 进行后期处理，因此我们面临着空标签一直被关闭的挑战。所以作为一个肮脏的黑客，我们现在`span`在空标签之间插入一个隐藏标签来防止这个问题。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-05-10T16:48:27.860

对我来说，这看起来像是一个错误，克里斯。我刚刚在 Chrome、Firefox 和 IE 上确认了这一点。应该忽略当前的文本选择是完全违反直觉的。（从好的方面来说，一旦你在源选项卡中手动修复它，一切似乎都表现得很完美。）

我建议您向 Tridion 报告此问题，或许可以通过更改模板或过滤 XSLT 来解决此问题。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-07-12T18:59:37.810

这是 Tridion 中的一个错误。我建议（并已在我们的特定安装中实施）的一种解决方法是执行以下操作：

1.  编辑 FormatAreaStyles.css 文件（可在 Tridion CMS 程序文件中找到）以及网站使用的 CSS 文件，以包含如下类：

`.hiddenanchor { width:1px; height: 1px; display: block; text-indent:-50000px; }`

1.  发布您的 CSS 文件（使用新类），以便正确格式化您的锚点。
2.  然后在构建锚点的组件中，您必须：

    一个。在您的组件（您希望目标所在的位置）中键入一个单词或一系列单词，

    湾。选择该文本，并将锚标记应用于它，

    C。然后将您创建的新类 (.hiddenanchor) 应用到锚点。

最后，您的“隐形”锚将如下所示：

```
<a name="anchorname" id="anchorname" class="hiddenanchor">Anchor Name</a> 
```

这是一个粗略的解决方法——完全承认。但它有效。在下一个 DOM 对象关闭之前，您不会得到超链接/下划线样式。

作为对 CSS 的解释，从技术上讲，锚点必须在 DOM 中可见，它才能工作并且可以被锚点链接访问。所以“显示：无”将不起作用。除了采用文本缩进方法之外，您也可以将文本绝对或固定在屏幕之外。

# php - PHP SimpleXML + 获取属性

> ID：10537657
> 
> 赞同：19
> 
> 时间：2012-05-10T15:46:42.457
> 
> 标签：php, xml, simplexml

我正在阅读的 XML 如下所示：

```
<show id="8511">

    <name>The Big Bang Theory</name>
    <link>http://www.tvrage.com/The_Big_Bang_Theory</link>
    <started>2007-09-24</started>
    <country>USA</country>

    <latestepisode>
        <number>05x23</number>
        <title>The Launch Acceleration</title>
    </latestepisode>

</show> 
```

要获得（例如）最新一集的编号，我会这样做：

```
$ep = $xml->latestepisode[0]->number; 
```

这工作得很好。但是我该怎么做才能从中获取ID `<show id="8511">`？

我试过类似的东西：

```
$id = $xml->show;
$id = $xml->show[0]; 
```

但没有一个奏效。

**更新**

我的代码片段：

```
$url    = "http://services.tvrage.com/feeds/episodeinfo.php?show=".$showName;
$result = file_get_contents($url);
$xml = new SimpleXMLElement($result);

//still doesnt work
$id = $xml->show->attributes()->id;

$ep = $xml->latestepisode[0]->number;

echo ($id); 
```

奥利。XML:

```
http://services.tvrage.com/feeds/episodeinfo.php?show=The.Big.Bang.Theory 
```

* * *

## 回答 #1

> 赞同：33
> 
> 时间：2012-05-10T15:54:50.257

这应该有效。

```
$id = $xml["id"]; 
```

您的 XML 根成为 SimpleXML 对象的根；您的代码正在调用名为“show”的 chid 根，但该名称不存在。

您还可以将此链接用于一些教程： http: [//php.net/manual/en/simplexml.examples-basic.php](http://php.net/manual/en/simplexml.examples-basic.php)

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2012-05-10T15:50:12.160

你需要使用[属性](http://php.net/manual/en/simplexmlelement.attributes.php)

我相信这应该有效

```
$id = $xml->show->attributes()->id; 
```

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2013-10-10T07:43:37.627

这应该有效。您需要使用带类型的属性（如果 sting 值使用（字符串））

```
$id = (string) $xml->show->attributes()->id;
var_dump($id); 
```

或这个：

```
$id = strip_tags($xml->show->attributes()->id);
var_dump($id); 
```

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2012-05-10T15:51:26.047

你需要用来[`attributes()`](http://php.net/manual/en/simplexmlelement.attributes.php)获取属性。

```
$id = $xml->show->attributes()->id; 
```

你也可以这样做：

```
$attr = $xml->show->attributes();
$id = $attr['id']; 
```

或者你可以试试这个：

```
$id = $xml->show['id']; 
```

查看对您的问题的编辑（`<show>`是您的根元素），试试这个：

```
$id = $xml->attributes()->id; 
```

或者

```
$attr = $xml->attributes();
$id = $attr['id']; 
```

或者

```
$id = $xml['id']; 
```

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2014-03-12T09:20:11.657

试试这个

```
$id = (int)$xml->show->attributes()->id; 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-05-10T15:54:54.077

您需要`XML`正确格式化您的格式并让它具有示例使用`<root></root>`或`<document></document>`任何内容.. 请参阅[http://php.net/manual/en/function.simplexml-load-string.php上的 XML 规范和示例](http://php.net/manual/en/function.simplexml-load-string.php)

```
$xml = '<?xml version="1.0" ?> 
<root>
<show id="8511">
    <name>The Big Bang Theory</name>
    <link>http://www.tvrage.com/The_Big_Bang_Theory</link>
    <started>2007-09-24</started>
    <country>USA</country>

    <latestepisode>
        <number>05x23</number>
        <title>The Launch Acceleration</title>
    </latestepisode>

</show>
</root>';

$xml = simplexml_load_string ( $xml );
var_dump ($xml->show->attributes ()->id); 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-05-10T16:10:17.037

使用 SimpleXML objecto 正确加载 xml 文件后，您可以执行以下操作`print_r($xml_variable)`，您可以轻松找到可以访问的属性。正如其他用户所说`$xml['id']`，也为我工作。

# python - Python GAE：传入邮件处理程序错误

> ID：10537659
> 
> 赞同：2
> 
> 时间：2012-05-10T15:46:42.970
> 
> 标签：python, google-app-engine, email, handler

我正在 GAE 上编写可以解析和存储传入邮件的应用程序。我已经为电子邮件解析准备了一些简单的代码，但是当我尝试在本地开发服务器上模拟从管理开发控制台接收电子邮件时出现了问题：

```
/develop/google_appengine/google/appengine/runtime/wsgi.py", line 193, in Handle
    result = handler(self._environ, self._StartResponse)
TypeError: 'module' object is not callable
INFO     2012-05-08 16:14:43,516 dev_appserver.py:2891] "POST /_ah/mail/test@example.com HTTP/1.1" 500 - 
```

应用程序.yaml：

```
application: mailhandler
version: 1
runtime: python27
api_version: 1
threadsafe: true

inbound_services:
- mail

handlers:
- url: /_ah/mail/.+ 
  script: email_handler
  login: admin 
```

email_handler.py：

```
from google.appengine.ext import webapp 
from google.appengine.ext.webapp.mail_handlers import InboundMailHandler 
from google.appengine.ext.webapp.util import run_wsgi_app
from google.appengine.api import mail

from models import DataStoreManager

class LogSenderHandler(InboundMailHandler):
    # Receiving new mail message and parsing it
    def receive(self, mail_message):                                                                                                                      
        manager = DataStoreManager()
        instance = manager.get_instance_by_email(mail_message.sender.lowercase())

        email_key = manager.store_email(instance, instance.user, mail_message, mail_message.attachments) 
```

我做错了什么？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-05-10T16:11:24.583

我认为发生的情况是，在您的 app.yaml 中，您将模块/文件定义为脚本而不是应用程序，该模块当然不可调用。

将`app.yaml`定义更改为：

```
handlers:
- url: /_ah/mail/.+ 
  script: email_handler.application
  login: admin 
```

并在末尾添加这一行`email_handler.py`

```
application = webapp2.WSGIApplication([LogSenderHandler.mapping()], debug=True) 
```

这里的文档： [https ://developers.google.com/appengine/docs/python/mail/receivingmail](https://developers.google.com/appengine/docs/python/mail/receivingmail)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-10T16:31:46.197

问题是你没有为你的 handler 声明一个 WSGIApplication `LogSenderHandler`。

您必须阅读以下内容： [https ://developers.google.com/appengine/docs/python/python27/using27](https://developers.google.com/appengine/docs/python/python27/using27)

```
from google.appengine.ext import webapp 
from google.appengine.ext.webapp.mail_handlers import InboundMailHandler 
from google.appengine.ext.webapp.util import run_wsgi_app
from google.appengine.api import mail

from models import DataStoreManager

class LogSenderHandler(InboundMailHandler):
    # Receiving new mail message and parsing it
    def receive(self, mail_message):                                                                                                                      
        manager = DataStoreManager()
        instance = manager.get_instance_by_email(mail_message.sender.lowercase())

        email_key = manager.store_email(instance, instance.user, mail_message, mail_message.attachments)

application = webapp.WSGIApplication([LogSenderHandler.mapping()], debug=True) 
```

之后，您必须在中指定 WSGI 应用程序`your app.yaml`

```
handlers:
- url: /_ah/mail/.+ 
  script: email_handler.application
  login: admin 
```

*注意：*正如文档中所写，该类`InboundMailHandler`有一个特殊的方法`mapping` 可以帮助您声明 URL 的映射。

# asp.net - 无论如何告诉.net缓存使用应用程序结构服务器而不是本地内存？

> ID：10537671
> 
> 赞同：3
> 
> 时间：2012-05-10T15:47:35.640
> 
> 标签：asp.net, .net, appfabric

我们设法使用 App Fabric Caching Server 来存储我们的`Outputcache`，而不更改我们的代码，只使用配置。它运行良好。

有没有办法对 .Net Cache( `HttpContext.Current.Cache`) 做同样的事情？无需更改我们的代码，只需配置。

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-11T16:47:41.570

**HttpContext Cache**没有提供者抽象 ( [`ProviderBase`](http://msdn.microsoft.com/en-us/library/system.configuration.provider.providerbase.aspx)) 。如@Icarus 所示，有**OutputCache**和**Session 。**这将需要更改代码。

 ******这里有几个想法给你...

1.  使用 AppFabric[`DataCache`](http://msdn.microsoft.com/en-us/library/microsoft.applicationserver.caching.datacache%28v=ws.10%29.aspx)而不是`HttpContext.Current.Cache`. 请参阅[Hanselmans 示例](http://www.hanselman.com/blog/InstallingConfiguringAndUsingWindowsServerAppFabricAndTheVelocityMemoryCacheIn10Minutes.aspx)。
2.  使用**HttpContext Cache** ( *Application Cache* ) 将任何内容转换为**Session** ( *User Cache* )。
3.  请参阅[有关构建自定义缓存提供程序的相关 SO 帖子](https://stackoverflow.com/a/875220/175679)。******

# android - 在客户端和网络之间设计一个“任务”层来组织同步网络/api调用

> ID：10537673
> 
> 赞同：3
> 
> 时间：2012-05-10T15:47:52.303
> 
> 标签：android, design-patterns, software-design

对于我正在开发的应用程序，我们有一堆 api 调用来完成某些事情。通常每件事都需要一个以上的 api 调用。我想要设计的是一个中间层，其中 UI/客户端可以只说执行某个任务，中间层将调用该任务，而任务将处理所有 api 调用序列..

我很难选择正确的设计模式。基本上，我在考虑一种调解器类型模式，它可以调解 UI、网络和任务之间的交互。一切都只会与调解人对话，但这可能会使调解人过于复杂。还有一个要求是任务可以由其他任务组成（一个任务可能依赖于另一个任务并调用它并等待它完成）..

是否存在与此类相关的通用设计模式已经存在？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-10T16:19:19.510

Virgil Dobjanschis Google IO REST 解释了从 UI 中解耦网络操作（在他的例子中是 REST）的一个很好的模式，你可以在这里观看视频[http://www.youtube.com/watch?v=xHXn3Kg2IQE](http://www.youtube.com/watch?v=xHXn3Kg2IQE)它应该是一个很好的灵感让你开始。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-10T16:11:09.653

我能想到的最简单的一个，恐怕我不是设计模式大师或任何东西，是命令模式，当然是更复杂的事情的起点。 [http://en.wikipedia.org/wiki/Command_pattern](http://en.wikipedia.org/wiki/Command_pattern)

# sql-server - 函数挂在@Variable 输入上，但不是硬编码整数

> ID：10537674
> 
> 赞同：1
> 
> 时间：2012-05-10T15:47:53.770
> 
> 标签：sql-server, tsql

很奇怪的问题。当我这样调用它时，这个函数随机开始挂起和超时：

```
DECLARE @persId int 
SET @persId = 336

SELECT  * FROM  [CIDER].[dbo].[SMAN_ACL_getPermissions]   (
  null
  ,@persId
  ,1
  ,null)
GO 
```

但是当我这样称呼它时返回超级快：

```
SELECT  * FROM  [CIDER].[dbo].[SMAN_ACL_getPermissions]   (
  null
  ,336
  ,1
  ,null)
GO 
```

有人可以强调这两个我之间的区别吗？这使得调试非常困难......

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-10T15:49:43.283

变量可以是空值，而静态值绝对不是。这可能导致不同的执行计划。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-10T16:10:19.123

您可能会成为参数嗅探的牺牲品。查看表现不佳的执行计划。在计划 XML 中，您将在 ParameterList 标记中看到两个值：不言自明的 ParameterCompiledValue 和 ParameterRuntimeValue。如果两者的数据分布大相径庭，则您可能会为您的运行时价值获得次优计划。您可以尝试在函数中运行缓慢的语句中添加“with (recompile)”，看看是否有帮助

# objective-c - 为什么我的 NSString 变成了 CGPath？Xcode，钛

> ID：10537675
> 
> 赞同：0
> 
> 时间：2012-05-10T15:47:56.453
> 
> 标签：objective-c, xcode, nsstring, titanium, cgpath

所以简而言之，我想定义一个可以随时引用的全局字符串变量。我引用它的函数，它返回一个字符串。一旦我存储它并在另一个函数中引用它，它就会输出为`<CGPath 0x5bbf50>`

有没有搞错？代码如下，请记住这是 Titanium 的一个模块。一、全局变量的定义..

```
@interface ComTestModule : TiModule <CBCentralManagerDelegate, CBPeripheralDelegate>
{
    NSString * teststring;
} 
```

下一部分是我首先将字符串变量从钛发送到 xcode 的函数。

```
-(void)setService:(id)args{
    ENSURE_ARG_COUNT(args, 2);
    teststring = [args objectAtIndex:0];
    NSLog(teststring);
} 
```

NSLog 的输出显示传递的实际字符串。现在是我再次调用字符串并尝试将其输出到日志的最后一个函数。

```
- (void)peripheral:(CBPeripheral *)peripheral didDiscoverServices:(NSError *)error
{
        NSLog(@"---%@", teststring);
} 
```

正如我之前所说，在此步骤中，它输出为`---<CGPath 0x3ef4e0>`

我真的不确定发生了什么..任何关于让它作为原始字符串而不是 CGPath 返回的帮助都会很棒！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-10T16:12:22.447

当您存储指向已释放和解除分配的对象的指针时，通常会发生这样的效果。然后，运行时将用 CGPath 实例替换之前保存 NSString 实例的那块内存。

如果你想确保你的 NSString 保持活跃，你需要拥有它。您可以通过保留它或复制它来做到这一点。在谈论字符串时，复制是首选方法，因此请尝试替换此行：

```
teststring = [args objectAtIndex:0]; 
```

有了这个：

```
teststring = [[args objectAtIndex:0] copy]; 
```

现在只需确保在完成后释放它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-13T16:15:27.360

另一位发帖人的建议很好。您可能希望将您的 testString 变量变成一个复制的属性：

在您的 .h 文件中：

```
@property (nonatomic, copy) NSString teststring; 
```

在你的 .m 文件中

```
@synthesize teststring; 
```

然后，当您分配给它时，使用如下代码：

```
self.teststring = [args objectAtIndex:0]; 
```

该“点语法”为您的属性调用设置器，而不是直接更改实例变量。由于您使用“copy”限定符声明了您的属性，因此 setter 方法会在将字符串放入实例 var 之前复制该字符串。

最后，您可以将此代码添加到您的 dealloc 方法中：

```
self.teststring = nil; 
```

setter 方法还会在分配新值之前释放属性中的任何旧值，因此将其设置为 nil 会释放旧值。

# download - 如何使用转换出口下载数据？

> ID：10537676
> 
> 赞同：1
> 
> 时间：2012-05-10T15:47:56.997
> 
> 标签：download, abap

我尝试将内部表下载到我的 PC，下载应该使用转换出口。

示例：表`T002`包含一个具有一个字符的语言键 (T0002-SPRAS)。

当我`WRITE T0002-SPRAS.`使用转换例程`ISOLA`并获得两个字符的语言键（*E*变为*EN* ...）时，此转换例程应该用于我的导出。

我的测试报告：

```
REPORT  Y_MY_DOWNLOAD_TEST.

CONSTANTS: c_filename type string VALUE 'C:\temp\test.txt'.
data: it_table type table of t002.

start-of-selection.

  SELECT * from t002 into table it_table.

* Start file download
  CALL METHOD cl_gui_frontend_services=>gui_download
    EXPORTING
      filename                  = c_filename
      filetype                  = 'ASC' "or DAT
      WRITE_FIELD_SEPARATOR     = 'X'
      WRITE_LF                  = 'X'
*      DAT_MODE                  = SPACE
      codepage                  = '4110'        "UNICODE
      SHOW_TRANSFER_STATUS      = 'X'
      WRITE_LF_AFTER_LAST_LINE  = 'X'
    CHANGING
      data_tab                  = it_table
    EXCEPTIONS
      OTHERS                    = 99.

  write: 'end'. 
```

结果是一个没有使用转换出口的文件（英语保持*E*）。

[SAP 文档](http://help.sap.com/saphelp_tm80/helpdata/en/c7/5ab8ec178c44a8aacd1dcac3460db8/frameset.htm)提到了参数`dat_mode`：

> 如果设置了此标志，则 .... 不执行转换出口。

我没有设置标志，所以我希望转换完成。我尝试了不同的组合（`dat_mode`开/关、`filetype`ASC 和 DAT），但我从未发现任何转换。

评论：

*   我使用 SAP 7.01 版，支持包 SAPKB70107。这是一个unicode系统。
*   T002只是一个例子，我的真实数据是其他数据，包含语言键。

我正在寻找带有`gui_download`（或其他标准方法/功能模块）的解决方案。

我不想像这样构建自己的导出文件：

```
data: 
  tmp type string,
  targetline type string,
  targettable type table of string.
loop at it_table into sourceline.
  "This could be done dynamic with field symbols and ASSIGN COMPONENT
  write sourceline-field1 to tmp. 
  CONCATENATE targetline ';' tmp into targetline.
  "...
  APPEND targetline to targettable.
endloop. 
```

这将是一个可能的解决方案，但在这种情况下，我更容易适应导出文件的使用者。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-12T10:43:06.730

我不认为这是可能的。但是，您可以在包含字段类型的查询中加入`LAISO`值（这是`SPRAS`输出转换函数返回的值）`SPRAS`，并为查询使用自定义类型，在其中将`SPRAS`类型字段替换为`LAISO`类型。以下是使用该表
的示例：`T003P`

```
types: begin of ty_t003p,
         client type mandt,
         spras type laiso,
         auart type aufart,
         txt type auarttext,
       end of ty_t003p.

data ta_t003p type standard table of ty_t003p.

select t003p~client t002~laiso t003p~auart t003p~txt into table ta_t003p from t003p inner join t002 on t002~spras = t003p~spras.

cl_gui_frontend_services=>gui_download(
  exporting
    filename = 'C:\temp\test.txt'
    filetype = 'DAT'
  changing
    data_tab = ta_t003p ). 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-10T19:23:47.497

好的，

在这里，使用 SE11，转到表格，使用转换例程双击数据元素以显示数据元素。然后双击域以显示域，然后双击转换。例行名称。（在这种情况下为 ISOLA）由于您想要输出值（输入值在 db 中），因此您希望对每个表条目的 spras 字段执行 CONVERSION_EXIT_ISOLA_INPUT。

就像是

```
data: wa_table type t002.

loop at it_table into wa_table.
CALL FUNCTION 'CONVERSION_EXIT_ISOLA_OUTPUT'
  EXPORTING
    input         = wa_table-spras
 IMPORTING
    OUTPUT        = wa_table-spras.

modify it_table from wa_table index sy-tabix.

endloop. 
```

此时您可以继续在 it_table 上使用 cl_gui_frontend_services=>gui_download。

我意识到这接近于使用您的 WRITE 语句，除了 WRITE 语句会给您带来麻烦。

我们在工作中所做的是编写一个程序，使用数据字典生成一个上传下载程序。

表 DD04L 包含每个表字段的转换出口，然后我们执行以下操作：

```
 CONCATENATE 'wa_db-' wa_field-fieldname INTO g_string.

  SELECT SINGLE * FROM dd03l INTO wa_dd03l WHERE tabname EQ p_tab AND fieldname EQ wa_field-fieldname.
  SELECT SINGLE * FROM dd04l INTO wa_dd04l WHERE rollname EQ wa_dd03l-rollname.

  IF wa_dd04l-lowercase IS INITIAL.
    _repl 'translate wa_field to upper case.' g_string.
  ENDIF.
  _add 'if g_oops is initial.'.
  IF wa_dd04l-convexit IS NOT INITIAL.

    _add  'try.'.
    _repl 'move wa_field to &.' g_string.
    _add  'CATCH CX_DYNAMIC_CHECK into gcl_dynamic_check.'.
    _add  'l_error = gcl_dynamic_check->get_text( ).'.
    _add  'l_long_error = gcl_dynamic_check->GET_LONGTEXT( ).'.
    _repl 'concatenate ''Conversion error'' wa_field ''into & ->'' l_error into l_error separated by space.' g_string.
    _add  'condense l_error.' .
    _add  'write l_error. new-line.' .
    _add  'write l_long_error. new-line.' .
    _add  'ENDTRY.'.

    CONCATENATE 'CONVERSION_EXIT_' wa_dd04l-convexit '_INPUT' INTO g_fm.

    _repl '    CALL FUNCTION ''&''' g_fm.
    _add  '      EXPORTING'.
    _repl '        input             = &' g_string.
    _add  '      IMPORTING'.
    _repl '        output            = &' g_string.
    _add  '     EXCEPTIONS'.
    _add  '       length_error       = 1'.
    _add  '       OTHERS             = 2.'.

    IF sy-subrc <> 0.
      MESSAGE ID sy-msgid TYPE sy-msgty NUMBER sy-msgno
              WITH sy-msgv1 sy-msgv2 sy-msgv3 sy-msgv4.
    ENDIF. 
```

有一些定义将代码添加到生成的 ABAP

```
DEFINE _repl.
  wa_prog = &1.
  replace all occurrences of '&' in wa_prog with &2.
  append wa_prog to it_prog.
END-OF-DEFINITION.

DEFINE _add.
  append &1 to it_prog.
END-OF-DEFINITION. 
```

写起来很有趣。。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2020-04-08T12:26:12.823

从 ABAP 7.52 开始，我已验证转换出口仅在以下情况下执行：

*   参数是`filetype = 'DAT'`

    *   或者`filetype = 'ASC' and dat_mode = 'X'`

        （实际上并不是文档所说的）

*   并且仅适用于数据类型为**“N”、“D”、“F”（值 0 除外）或“T”的**字段（但不是最常见的“C”，尤其是关于转换出口`ALPHA`和）`ISOLA``CUNIT`

    `Put_Char_LineBuffer`（您可以在功能组的子程序中验证这些数据类型的规则`SFES`，更具体地说，在子程序中`ConvertAsc`）

请注意，嵌入方法`gui_download`中的文档`cl_gui_frontend_services`说：

> DAT 模式：不再支持。请改用 ASC。

因此，您不能依赖该方法完成的转​​换。

# properties - 条件逻辑似乎不起作用

> ID：10537687
> 
> 赞同：0
> 
> 时间：2012-05-10T15:48:25.657
> 
> 标签：properties, wix

我有一个 Wix Control PushButton，它有几个 Publish 事件

这是xml

```
<Control Id="Next" Type="PushButton" X="0" Y="0" Width="50" Height="20" Default="yes" Text="!(loc.WixUINext)">
  <Publish Event="SpawnDialog" Value="ErrorDialog">
    <![CDATA[PROPERTY1 = "1" AND PROPERTY2 = "1"]]>
  </Publish>
</Control> 
```

但是即使两个属性都等于 1，对话框也不会出现

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-10T16:15:31.323

我发布后几乎立即发现了问题。所以我把它放在这里，以防其他人犯同样的错误。

在我的发布事件之后，我有另一个事件被触发以进入下一个对话框屏幕

```
<Publish Event="NewDialog" Value="CustomizeDlg">1</publish> 
```

所以即使我的错误对话框应该显示，下一个事件会覆盖它，你看不到它。为了阻止这种情况发生，我必须编写逻辑以防止它继续前进。

```
<Publish Event="NewDialog" Value="CustomizeDlg">
<![CDATA[PROPERTY1 = "1" AND PROPERTY2 = "0"]]></Publish> 
```

所以现在如果两个属性都已设置，它将显示错误对话框，但如果只设置了第一个属性，我将直接进入 CustomizeDlg。只要条件不同，一个会失败，另一个会通过，这很有魅力。

# cmake - CMake 失败，直到您删除 CMake Cache

> ID：10537688
> 
> 赞同：1
> 
> 时间：2012-05-10T15:48:26.077
> 
> 标签：cmake

我有一个使用 CMake 管理的项目，我遇到了一些我不理解的非常奇怪的行为。如果我清除我的构建目录，运行 cmake，运行 make，然后运行我的程序，我的程序每次都会崩溃，因为我在 pthreads/boost 线程中的某处断言失败。无论我做了多少次，并清理这个项目，每次运行它都会崩溃。但是，如果我随后删除 CMaketCache.txt，重新生成我的 makefile，构建并运行，程序每次都会按预期运行。

总之，我需要按照以下步骤才能使我的代码正常工作...

1.  运行 Cmake
2.  运行制作
3.  rm CMakeCache.txt
4.  运行制作
5.  运行程序

我删除 CMakeCache.txt 之前和之后的 Make 文件似乎有所不同。什么可以解释这种行为？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-10T16:48:14.613

你有安装 git 吗？如果是这样，您可以使用此技巧：

*   运行 cmake
*   制作
*   混帐添加。
*   git 提交 -m ""
*   rm CMakeCache.txt
*   运行制作
*   混帐差异

我可以从你所说的中看出一些奇怪的事情。我不明白为什么你的程序会因为你删除了 CMakeCache.txt 而重新编译任何东西。从第一次制作开始，一切都应该是最新的，所以那里有些不好……我的猜测是它第二次找到了不同的线程库或没有线程库。

# ios - Openfire：当用户离线时将消息保存在服务器上？

> ID：10537696
> 
> 赞同：0
> 
> 时间：2012-05-10T15:48:48.387
> 
> 标签：ios, xmpp, openfire

我正在编写一个与 openfire 服务器连接的 xmpp ios 聊天应用程序。

应用程序需要能够下载用户在应用程序关闭时错过的所有消息。所以我需要一种方法来保存在服务器上发送的错过的消息，有人知道这样做的好方法吗？是否有类似的插件，或者这需要自定义插件或其他东西？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-10T17:34:26.637

与大多数其他 XMPP 服务器一样，Openfire 已经存储了用户发送的消息，当接收裸 JID 离线时，它可以在（重新）连接时将这些消息发送给客户端。

也可以看看：

*   [XEP-0160 - 处理离线消息的最佳实践](http://xmpp.org/extensions/xep-0160.html)
*   [XEP-0013 - 灵活的离线消息检索](http://xmpp.org/extensions/xep-0013.html)（Openfire 支持）

# sql - 仅当至少有一个使用两个表的孩子时如何选择父行

> ID：10537697
> 
> 赞同：0
> 
> 时间：2012-05-10T15:48:49.073
> 
> 标签：sql, sql-server

您好，我有带有数据和 2 个小问题的表格结构。

```
CREATE TABLE [dbo].[Parent] (
    [id] [int] NOT NULL,
    [Name] [nvarchar](50) NOT NULL, 
 CONSTRAINT [PK_Parent] PRIMARY KEY CLUSTERED 
(
    [id] ASC
)WITH (PAD_INDEX  = OFF, STATISTICS_NORECOMPUTE  = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS  = ON, ALLOW_PAGE_LOCKS  = ON) ON [PRIMARY]
) ON [PRIMARY]

GO

CREATE TABLE [dbo].[Child1] (
    [Child1Id] [int] NOT NULL,
    [ParentId] [int] NOT NULL,
    [SomeData] [int] NOT NULL,  
 CONSTRAINT [PK_Child1] PRIMARY KEY CLUSTERED 
(
    [Child1Id] ASC
)WITH (PAD_INDEX  = OFF, STATISTICS_NORECOMPUTE  = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS  = ON, ALLOW_PAGE_LOCKS  = ON) ON [PRIMARY]
) ON [PRIMARY]

GO

CREATE TABLE [dbo].[Child2] (
    [Child2Id] [int] NOT NULL,
    [ParentId] [int] NOT NULL,
    [SomeData] [int] NOT NULL,  
 CONSTRAINT [PK_Child2] PRIMARY KEY CLUSTERED 
(
    [Child2Id] ASC
)WITH (PAD_INDEX  = OFF, STATISTICS_NORECOMPUTE  = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS  = ON, ALLOW_PAGE_LOCKS  = ON) ON [PRIMARY]
) ON [PRIMARY]

INSERT INTO Parent VALUES(1,'Name 1')
INSERT INTO Parent VALUES(2,'Name 2')
INSERT INTO Parent VALUES(3,'Name 3')
INSERT INTO Parent VALUES(4,'Name 4')

INSERT INTO [Child1] VALUES(1,1,50)
INSERT INTO [Child1] VALUES(2,1,125)
INSERT INTO [Child1] VALUES(3,2,255)

INSERT INTO [Child2] VALUES(1,1,2)
INSERT INTO [Child2] VALUES(2,2,4)
INSERT INTO [Child2] VALUES(3,2,8)
INSERT INTO [Child2] VALUES(4,3,16) 
```

1.  如何选择两个表中至少具有一种子类型的所有 parets 记录。我做了下一个查询，但我不知道显示此记录总数的最佳方法

    SELECT p.Name, count(Child1) , count(Child2)

2.  如何选择仅存在于两个表中的所有 parets 记录？SELECT p.Name, count(Child1) , count(Child2)

感谢您的建议。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-10T15:52:50.833

**查询一：**

```
--at least one child record in either Child1 or Child2
select distinct p.*
from parent p
left outer join child1 c1 on p.id = c1.ParentId
left outer join child2 c2 on p.id = c2.ParentId
where coalesce(c1.ParentId, c2.ParentId) is not null 
```

**查询 2：**

```
--at least one child record in both Child1 and Child2
select distinct p.*
from parent p
inner join child1 c1 on p.id = c1.ParentId
inner join child2 c2 on p.id = c2.ParentId 
```

注意：如果您只想显示父记录的计数，请更改

```
select distinct p.* 
```

到

```
select count(distinct p.id) 
```

在任一查询中。

# sql - 程序错误“必须声明表”

> ID：10537698
> 
> 赞同：0
> 
> 时间：2012-05-10T15:48:57.437
> 
> 标签：sql, procedure

我有一个块代码来创建一个过程：

```
CREATE PROCEDURE GetTableinfomation
    @table nvarchar(50),
    @column nvarchar(50), 
    @valuedk nvarchar(50) 
AS
BEGIN 
   SELECT *  
   FROM @table 
   WHERE @column = @valuedk 
END 
```

我有一个错误。

> 消息 1087，级别 15，状态 2，过程 GetTableinfomation，第 7 行
> 必须声明表变量“@tenbang”。

为什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-10T15:51:55.797

您不能将 SQL 参数用于表名和列，只能用于变量。

您可以通过使用动态 SQL 来解决这个问题：

```
DECLARE @SQL nvarchar(4000)
DECLARE @PARAMS nvarchar(4000)
SET @SQL = 'SELECT * FROM ' 
    + QUOTENAME(@table,'"') + ' WHERE ' 
    + QUOTENAME(@column,'"') + '= @param1'
SET @PARAMS = '@param1 nvarchar(50)'
EXEC sp_executesql @SQL, @PARAMS, @param1=@valuedk 
```

有关更多信息，请参阅文档`sp_executesql`：

*   [http://msdn.microsoft.com/en-us/library/ms188001.aspx](http://msdn.microsoft.com/en-us/library/ms188001.aspx)

# php - 绑定单击类选择器它会多次触发该功能

> ID：10537699
> 
> 赞同：1
> 
> 时间：2012-05-10T15:49:02.287
> 
> 标签：php, jquery, jsapi

我正在编写一些 php 代码和 jquery 以使其更加生动。我有一个单元格表，我单击它来显示一个 div。html是这样的：

```
<table>
 <tr id="line-157"><td id="cell1-157" class="edit"></td><td id="cell2-157"></td></tr>
 <tr><td id="w_157"></td><td id="p_157"></td></tr>
 <tr id="line-158"><td id="cell1-158" class="edit"></td><td id="cell2-158"></td></tr>
 <tr><td id="w_158"></td><td id="p_158"></td></tr>
 <tr id="line-159"><td id="cell1-159" class="edit"></td><td id="cell2-159"></td></tr>
 <tr><td id="w_159"></td><td id="p_159"></td></tr>
</table> 
```

jQuery：

```
$(document).ready(function() {
        $('.edit').bind('click', function() {
                var a = this.id.split('-') ;
                var name_id = a[1] ;
                $('#w_'+name_id).fadeIn();
                $.get('minirpc.php',{
                        subcontrol: 'select_id',
                        id: name_id
                },function(data){
                        $('#w_'+name_id).html(data);
                })
                $.get('minirpc.php',{
                        subcontrol: 'select_pay_id',
                        id: name_id
                },function(data){
                        $('#p_'+name_id).fadeIn();
                        $('#p_'+name_id).html(data);
                })
                return false;
        });
}); 
```

我多次收到回调，而不是每次点击一次。如果我点击一次没问题，2 次循环 4 次，3 次循环 16 次，依此类推……知道吗？

编辑：

阅读评论我认为这可能是软件架构的问题，输出`data`确实包含 javascript，因为 minirpc.php 调用了调用 js 文件的 class_overbooking.php。这些文件是：

*   迷你RPC.php
*   class_overbooking.php
*   js/init_overbooking.js
*   js/overbooking.js

在 minirpc.php 里面：

```
<?
    include('class_overbooking.php');
    switch($subcontrol){
        case ...
        case quote_select:
        break;
        case quote_pay_id:
        break;
    }    
?> 
```

在 class_overbooking.php 中：

```
<script type="text/javascript" src="http://www.google.com/jsapi"></script>
<script type="text/javascript" src="js/init_overbooking.js"></script>
<script type="text/javascript" src="js/overbooking.js"></script>
<?
        php class functions mixed jquery
?> 
```

在 js/init_overbooking.js 中：

```
google.load("jquery", "1.7.1");
google.load("jqueryui", "1.8.13");
google.setOnLoadCallback(function() {
// ![CDATA[
            various sfuff
// ]]
}); 
```

在 js/overbooking.js 中：

```
$(document).ready(function() {

   (...)

     $('.edit').live('click', function() {
            var a = this.id.split('-') ;
        var name_id = a[2] ;
        var count = 0 ;
        var start = new Date().getTime();
            $('#w_'+name_id).fadeIn();
        var elapsed1 = new Date().getTime() - start;
                $('#jdebug1').html() ;
                $.get('minirpc.php',{
                        subcontrol: 'quote_select',
                        id: name_id
                },function(data){
                        $('#w_'+name_id).html(data);
                        var elapsed2 = new Date().getTime() - start;
                        $('#jdebug1').append('|('+name_id+')elapsed2:'+elapsed2+'ms ') ;
                });
                $.get('minirpc.php',{
                        subcontrol: 'quote_pay_id',
                        id: name_id
                },function(data){
                        $('#p_'+name_id).fadeIn();
                        $('#p_'+name_id).html(data);
                var elapsed3 = new Date().getTime() - start;
                        $('#jdebug1').append('|('+name_id+')elapsed3:'+elapsed3+'ms ') ;
                });
        return false;
    });

}); 
```

我也尝试了一个独特的选择器类，但是将名称“edit”更改为“edit-rev123”的问题是相同的。

有什么建议吗？

# php - 如何设置 PHP 多维数组并声明数组键？

> ID：10537707
> 
> 赞同：0
> 
> 时间：2012-05-10T15:49:18.977
> 
> 标签：php, arrays, multidimensional-array

我需要一些帮助来设置 PHP 数组。我对多维数组有点迷失了。

现在，我有一个包含多个产品的数组，如下所示：

如果我这样做：`print_r($products['1']);`我得到：

```
Array ( [0] => size:large [1] => color:blue [2] => material:cotton ) 
```

我可以做`print_r($products['2']);`，等等，它将显示与上面类似的数组。

我正试图在我能做到的地方得到它：

```
echo $products['1']['color']; // the color of product 1 
```

...并回显“蓝色”；

我尝试爆炸字符串并将其添加到数组中，如下所示：

```
$step_two = explode(":", $products['1']);

foreach( $step_two as $key => $value){

$products['1'][$key] = $value;

} 
```

我知道我显然做错了爆炸 / foreach 方式，但我还是想发布我的代码。我希望这是足够的信息来帮助解决这个问题。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-10T15:56:49.740

试试这个：

```
foreach ($products as &$product)
{
    foreach ($product as $key => $value)
    {
        list($attribute, $val) = explode(':',$value);
        $product[$attribute] = $val;

        // optional:
        unset($product[$key]);
    }
}
?> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-10T15:59:06.087

这是一个示例，它将从您的第一个表单转换为您想要的表单（输出如下）

```
<?php

$a = array( '1' => array('color:blue','size:large','price:cheap'));

print_r($a);

foreach ($a as $key => $inner_array) {
  foreach ($inner_array as $key2 => $attribute) {
    $parts = explode(":",$attribute);
    $a[$key][$parts[0]] = $parts[1];
    //Optional, to remove the old values
    unset($a[$key][$key2]);
  }
}

print_r($a);    
?>

root@xxx:/home/vinko/is# php a.php
Array
(
    [1] => Array
        (
            [0] => color:blue
            [1] => size:large
            [2] => price:cheap
        )

)
Array
(
    [1] => Array
        (
            [color] => blue
            [size] => large
            [price] => cheap
        )

) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-10T15:54:22.160

您最好以正确的方式构建数组，但要解决您的问题，您需要`explode`在循环中，例如：

```
foreach( $products['1'] as $value){
  $step_two = explode(":", $value);
  $products['1'][$step_two[0]] = $step_two[1];
} 
```

你可以在它周围包裹另一个 foreach 来循环你的整个`$products`数组。

而且您还最好构建一个新数组，以避免数组中同时包含旧值和新值`$products`。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-10T15:54:49.447

你是对的：你得到了“foreach”和“explode”错误的方式。尝试这样的事情：

```
foreach($products['1'] as $param => $value) {
    $kv = explode(":", $value);
    if(count($kv) == 2) {
        $products[$kv[0]] = $kv[1];
        unset($products['1'][$param]);
    }
} 
```

此代码首先循环遍历第一个元素的子元素，然后用冒号分割每个子元素，如果有两个部分，则将键值设置回数组中。

请注意这一`unset`行 - 它会删除数组元素，例如`$products['1'][1]`设置`products['1']['color']`为`blue`.

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-05-10T16:00:52.583

如果您已经`$products`以这种方式构建，您可以像这样修改它的结构：

```
$products = array(
  '1' => array(
    0 => 'size:large', 1 => 'color:blue', 2 => 'material:cotton'
  ),
  '2' => array(
    0 => 'size:small', 1 => 'color:red', 2 => 'material:silk'
  ),
);
foreach ($products as &$product) {
  $newArray = array();
  foreach ($product as $item) {
    list($key, $value) = explode(':', $item);
    $newArray[$key] = $value;
  }
  $product = $newArray;
}
print_r($products); 
```

如果您不想覆盖原始`$products`数组，只需附加`$newArray`到另一个数组即可。

* * *

## 回答 #6

> 赞同：-2
> 
> 时间：2012-05-10T15:52:34.827

```
<?php
  $products = array();
  $new_product = array();

  $new_product['color'] = "blue";
  $new_product['size'] = "large";
  $new_product['material'] = "cotton";

  $products[] = $new_product;

  echo $products[0]['color'];
  //print_r($products); 
```

# javascript - 在更改时使用 javascript 函数时向 html.dropdownlist 添加样式

> ID：10537715
> 
> 赞同：0
> 
> 时间：2012-05-10T15:49:36.093
> 
> 标签：javascript, jquery, asp.net, css, asp.net-mvc-2

我想在这个下拉列表中添加背景颜色.. 我该怎么做.. 我尝试在下面的代码中添加 new{style="background-color: #fff;"} .. 但这似乎不起作用。 .

```
 <%=Html.DropDownList("dd", 
                       new List<SelectListItem>
         {
            new SelectListItem{ Text="dd1", Value = "dd1" }, 
            new SelectListItem{ Text="dd2", Value = "dd2" }

         }
                            , new { onchange = "jsfunc()" } 

         )%> 
```

我试过了：

```
 <%=Html.DropDownList("dd", 
                       new List<SelectListItem>
         {
            new SelectListItem{ Text="dd1", Value = "dd1" }, 
            new SelectListItem{ Text="dd2", Value = "dd2" }

         }
                            , new { onchange = "jsfunc()" }
                            , new {style="background-color: #fff;"}

         )%> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-10T15:51:45.953

您应该避免使用内联样式。我建议创建一个类，语法是

`new { @class = "yourclass", @onchange = "jsfunc()" }`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-10T15:52:26.247

我认为你有一个语法错误，`new {@style = "background-color: #fff"}`但你应该改用一个类。

编辑

```
new { @onchange = "jsfunc()", @style = "background-color: #fff"} 
```

# python - 如何使用变量保存 nltk Text.similar()

> ID：10537720
> 
> 赞同：2
> 
> 时间：2012-05-10T15:49:43.237
> 
> 标签：python, nltk

我是 nltk 和 python 的菜鸟。最近我遇到了一个问题，我想将终端中显示的 text.similar() 保存在一个变量中，但我失败了很多次。我该如何保存它？

```
text = nltk.Text(word.lower() for word in nltk.corpus.brown.words())
save = []
for word in nltk.word_tokenize("i want to slove this problem"):
    save.append(text.similar(word)) 
```

可悲的是，我发现 save[] 中没有任何内容。然后我测试代码“word = text.similar('women')”，我还发现“word”中没有任何内容。我意识到它接缝我无法保存 text.similar()。我应该怎么做才能保存它？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-05-10T19:41:06.980

的实例`nltk.Text`实际上仅用于交互式探索。它将很多东西转储到控制台，但实际上并没有从它的函数返回任何构造的对象。

在这种情况下，您想要的是`nltk.ContextIndex`类。使用这个类...

```
import nltk
import nltk.text
import nltk.corpus

idx = nltk.text.ContextIndex([word.lower( ) for word in nltk.corpus.brown.words( )])
save = [ ]
for word in nltk.word_tokenize("i want to solve this problem"):
    save.append(idx.similar_words(word)) 
```

完成后，`save`将是“i”、“want”、“to”等上下文中最常见单词的嵌套列表。

看看[在线 nltk.text.Text 文档](http://nltk.github.com/api/nltk.html#nltk.text.Text)，特别是`similar`它引用的方法`nltk.text.ContextIndex`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2020-02-22T05:05:09.247

我喜欢@parselmouth 提供的答案，但我想我也会向您展示另一种方法。这是通过重定向来完成的`stdout`。然后，您可以将存储的值`storable_output`用于以后的其他操作。

**代码**

```
import sys
import io

orig_stdout = sys.stdout

out = io.StringIO()
sys.stdout = out

text1.similar("monstrous")

storable_output = out.getvalue()

sys.stdout = orig_stdout

print(storable_output) 
```

**输出**

```
true contemptible christian abundant few part mean careful puzzled
mystifying passing curious loving wise doleful gamesome singular
delightfully perilous fearless 
```

注意：`text1`是使用导入的`from nltk.book import *`

# handlebars.js - 用于模板组合的把手助手

> ID：10537724
> 
> 赞同：5
> 
> 时间：2012-05-10T15:49:56.437
> 
> 标签：handlebars.js

我有一个 Handlebar 助手来调用模板中的模板，

用法是这样的：

applyTemplate subTemplateId arg1=123 arg2="abc" ...

也可以传递html内容

```
 {{# applyTemplate "tli" a=1 b="y"}}
   ... any content here will get passed to the sub template with {{content}}
   {{/ applyTemplate }} 
```

这个 jsFiddle 说明了它是如何工作的：http: [//jsfiddle.net/maxl/ywUjj/](http://jsfiddle.net/maxl/ywUjj/)

**我的问题**：我希望调用范围内的变量可以在子模板中访问，在 jsFiddle 中，请注意 {{topLevelVar}} 是如何不可用的。

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-08-31T20:51:58.773

在 topLevelVar 之前添加“../”以访问父上下文。

例如：{{../topLevelVar}}

```
<script id="tli" type="text/x-handlebars-template">
    <tr><td>{{a}}----> {{content}} <----- {{b}}</td></tr>
</script>

<script id="zaza" type="text/x-handlebars-template">
  <table>
      {{# applyTemplate "tli" a=1 b="y"}}<input type="text" value='a'>{{../topLevelVar}}{{/ applyTemplate }}
    {{# applyTemplate "tli" a=2 b="z"}}<input type="text" value='b'>{{/ applyTemplate }}      
  </table>
</script> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-24T14:42:17.893

From this example i would say you can use fn to access the context in your helper method [http://yehudakatz.com/2010/09/09/announcing-handlebars-js/](http://yehudakatz.com/2010/09/09/announcing-handlebars-js/)

```
applyTemplate: function(context, fn) {
    for(var i=0, j=context.length; i < j; i++) {
      buffer.push(fn(context[i]))
    }
} 
```

Where fn is the inner "template" part, and context the model that gets applied to it.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-07-18T10:55:14.640

从[http://jsfiddle.net/dain/NRjUb/](http://jsfiddle.net/dain/NRjUb/)上的解决方案开始，我们可以实现相同的结果，但使用内联模板如下：

```
<script id="topLevel" type="text/x-handlebars-template">
    {{# defTpl "test1"}}
    La plantilla <b>diu</b> {{part}},{{../topLevelVar}}
    {{/ defTpl }}
    {{# each sub }}
    Iplant-->{{eTpl "test1" part=this}}--fi plant<br>
    {{/each}}    
</script> 
```

并注册车把助手，例如：

```
(function()
{
    var h={};

Handlebars.registerHelper('defTpl', function(name, context){
    // the subtemplate definition is already compiled in context.fn, we store this
    h[name]=context.fn;
    return "";
});

// block level /inline helper
Handlebars.registerHelper('eTpl', function(name, context){
    if (!h[name]) return "Error , template not found"+name;
    var subTemplate =  h[name];
    //if this isn't a block template , the function to render inner content doesn't exists
    var innerContent = context.fn?context.fn(this):"";
    var subTemplateArgs = $.extend({}, context.hash, {content: new Handlebars.SafeString(innerContent)});

    return new Handlebars.SafeString(subTemplate(subTemplateArgs))
});

})(); 
```

并调用它：

```
var _template =  Handlebars.compile($('#topLevel').html());
$('body').append(_template({topLevelVar:123, content:"cascading",sub:[45,30,12]})); 
```

希望这可以帮助 ：）

# .net - 忽略到 {resource}/Services/*.svc 的路由

> ID：10537725
> 
> 赞同：3
> 
> 时间：2012-05-10T15:49:57.230
> 
> 标签：.net, asp.net-mvc, wcf, asp.net-mvc-3

我试图忽略表单中的每个 URL，`http://domain/Services/{serviceName}.svc/mex?wsdl`因此我`RegisterRoutes`在文件中的方法顶部添加了以下内容`Global.asax`：

```
 routes.IgnoreRoute("{resource}/Services");
        routes.IgnoreRoute("{resource}/Services/{pathInfo}.svc"); 
```

这并没有解决问题，它仍然试图通过默认路由来解决，这显然失败了。

当我尝试浏览 WCF 服务（这有效）时，问题就开始了，但是当我尝试查看其元数据时，我得到一个`404 Error`.

有什么建议么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-10T15:54:43.580

routes.IgnoreRoute("{Services}/{*pathInfo}");

# python - 链接到 django-admin 的问题

> ID：10537726
> 
> 赞同：-1
> 
> 时间：2012-05-10T15:50:02.177
> 
> 标签：python, django, django-admin

我目前在 c:\python27 安装了 python

我目前在 c:\development\python\ 安装了 django（至少我遵循了安装开发版本）

当我从命令提示符键入并执行“python”时，它应该启动 python。但是，当我键入 django-admin 时，我收到错误，即它不被识别为内部或外部命令。我想知道如何将其链接起来以使其正常工作

为了清楚起见，再次编辑。我正在尝试运行命令 django-admin.py startproject projectname

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-10T16:45:01.497

请阅读 Django Book 中关于管理员的章节：http: [//www.djangobook.com/en/2.0/chapter06/](http://www.djangobook.com/en/2.0/chapter06/)

管理员不是您运行的命令。您按照那里的指示“激活”它，然后使用标准`python manage.py runserver`查看您的站点。然后，只需转到`/admin/`，您就会看到它的全部荣耀。

**编辑**

哦。我以为您是在尝试让管理员启动并运行，而实际上您最初只是在尝试创建项目。所以：

如果你已经通过 easy_install、pip 或者只是`python setup.py install`从包的目录运行安装了 Django，那么`django-admin.py`应该已经添加到你的路径中。根据您的问题，我唯一能想到的是，也许您只是想跑步`django-admin`？您确实需要`.py`它，因此请确保使用：

```
$ django-admin.py startproject myproject 
```

如果情况已经如此，那么有两件事。我怀疑是这种情况，但是如果您安装到 virtualenv 中，请确保它已被激活。否则，您可以尝试在某个地方手动创建符号链接`/usr/local/bin`，例如：

```
$ ln -s /path/to/python/site-packages/django/django/bin/django-admin.py /usr/local/bin/django-admin.py 
```

# php - PHP PDF 创建，EZPDF 类：只有一行一行的表格

> ID：10537729
> 
> 赞同：0
> 
> 时间：2012-05-10T15:50:12.037
> 
> 标签：php, pdf, border

这段代码：

```
$data = array(array('row1'=>'row2'));

$this->ezTable($data, null, '',
                array('width'=>'460', 'fontSize'=>'8', 'showLines'=>'1')); 
```

显示一个有 2 行和 1 列的表格。

我需要一个只有一行一列的表格，或者一个文本周围有四个边框（顶部、底部、右侧和左侧）。

我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-16T22:03:36.273

```
$this->ezTable($data, null, '',
                array('width'=>'460', 'fontSize'=>'8', 'showLines'=>'1','showHeadings'=>0)); 
```

# ruby-on-rails - rails同一页面上不同控制器的两种形式

> ID：10537733
> 
> 赞同：1
> 
> 时间：2012-05-10T15:50:32.643
> 
> 标签：ruby-on-rails, view, controller, devise

更新：

* * *

下面的问题源于有一个对用户进行身份验证的 before_filter。

* * *

我在同一页面上有两个表单，两个不同的 form_for，每个都有不同的模型。它们如下，并且都在设计/会话/新视图中：

```
%h2 Sign in
= form_for(resource, :as => resource_name, :url => session_path(resource_name)) do |f|
  %div
    = f.label :email
    %br/
    = f.email_field :email
  %div
    = f.label :password
    %br/
    = f.password_field :password
  - if devise_mapping.rememberable?
    %div
      = f.check_box :remember_me
      = f.label :remember_me
  %div= f.submit "Sign in"
= render :partial => "devise/shared/links"

=form_for BetaSignUp.new do |f|
  .field
    = f.label :email, "Your Email:"
    = f.text_field :email
  .actions
    = f.submit 'Submit' 
```

但是，当在 betasignup 表单中输入新电子邮件时，它不会像在 views/beta_sign_ups/new 视图中具有相同表单时那样保存到数据库中。为什么是这样？我需要对其中一个控制器或路线做些什么吗？

beta_sign_ups_controller：

```
class BetaSignUpsController < ApplicationController
  def new
    @beta_sign_up = BetaSignUp.new

    respond_to do |format|
      format.html # new.html.erb
      format.json { render json: @beta_sign_up }
    end
  end

  def create
    @beta_sign_up = BetaSignUp.new(params[:beta_sign_up])

    respond_to do |format|
      if @beta_sign_up.save
        format.html { redirect_to root_path, notice: 'Thank you for signing up.  You will be notified when we expand the beta group.' }
        format.json { render json: @beta_sign_up, status: :created, location: @beta_sign_up }
      else
        format.html { render action: "new" }
        format.json { render json: @beta_sign_up.errors, status: :unprocessable_entity }
      end
    end
  end
end 
```

betasignups 表单的 html 输出：

```
<form accept-charset="UTF-8" action="/beta_sign_ups" class="new_beta_sign_up" id="new_beta_sign_up" method="post"><div style="margin:0;padding:0;display:inline"><input name="utf8" type="hidden" value="✓"><input name="authenticity_token" type="hidden" value="K4wlzIZ958PdaC91vV4NMu4PLm3TF+yVebN0ll2VuoI="></div>
<div class="field">
<label for="beta_sign_up_email">Your Email:</label>
<input id="beta_sign_up_email" name="beta_sign_up[email]" size="30" type="text">
</div>
<div class="actions">
<input name="commit" type="submit" value="Submit">
</div>
</form> 
```

提交到 betasignups 表单后，服务器日志的输出：

```
Started POST "/beta_sign_ups" for 127.0.0.1 at 2012-05-10 11:36:17 -0400
  Processing by BetaSignUpsController#create as HTML
  Parameters: {"utf8"=>"✓", "authenticity_token"=>"K4wlzIZ958PdaC91vV4NMu4PLm3TF+yVebN0ll2VuoI=", "beta_sign_up"=>{"email"=>"onebroadway@test.com"}, "commit"=>"Submit"}
Completed   in 35ms 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-10T17:22:32.430

您仍然可以使用 before_filter，只需将一些选项传递给它，以便它只会在特定操作上激活，或者使用它替代 skip_before_filter 用于您在表单中使用的任何控制器操作。

# python - 使用 stdout 自定义 Logfile

> ID：10537737
> 
> 赞同：0
> 
> 时间：2012-05-10T15:50:45.377
> 
> 标签：python, logging, python-3.x, stdout, logfiles

对于我当前的项目，我需要找到一种方法将依赖于标准输出的版本或至少将格式化的标准输出写入日志文件。目前我只是使用*subprocess.Popen(exec, stdout=log)*，它将它写入一个未格式化的文件。

我得到的最好的想法是即时格式化输出，通过拦截标准输出，将其重新路由到自定义模块，并通过使用 if 和 elif 的组合将自己的字符串写入日志。但是我在文档中找不到任何关于如何在 Python 3 中执行此操作的方法。我能找到的最合适的答案是在[这个问题](https://stackoverflow.com/questions/107705/python-output-buffering)中，接受的答案已经很接近了。

但我只是不明白我应该如何构建应该用作*stdout=class*的类。这些方法中的哪一种接收输入（以及它是如何格式化的）？这些方法中哪些是必要的？或者甚至可能有一种更简单的方法来完成我想做的事情？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-10T18:22:29.063

您可以使用该[`sarge`](http://sarge.readthedocs.org/)项目来允许父进程捕获子进程的`stdout`（和/或`stderr`），逐行读取（比如说）并使用读取的行做任何您喜欢的事情（包括将它们写入，适当格式化，到日志文件）。

披露：我是该`sarge`项目的维护者。

# iphone - 如果省略关键字 strong 进行 ARC 转换，属性是否强大

> ID：10537742
> 
> 赞同：1
> 
> 时间：2012-05-10T15:51:08.777
> 
> 标签：iphone, objective-c

我刚刚使用自动对话工具将我的项目转换为 ARC，但没有一个属性被转换为强的，只剩下（非原子）？

我一直在关注本[教程](http://www.raywenderlich.com/5677/beginning-arc-in-ios-5-part-1)，它说所有属性都应该是（强的，非原子的）

有任何想法吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-10T15:54:51.600

启用 ARC 后，属性默认为`strong`：

> 在没有所有权来源的情况下合成的可保留对象指针类型的属性具有其关联实例变量的所有权，如果它已经存在的话；否则，[从 Apple 3.1，LLVM 3.1 开始] 它的所有权隐含地很强。在此修订版之前，合成这样的属性是不正确的。

从[这里](http://clang.llvm.org/docs/AutomaticReferenceCounting.html#ownership.spelling.property)

# jquery - 换行时用于固定位置导航的 Jquery outerHeight

> ID：10537746
> 
> 赞同：1
> 
> 时间：2012-05-10T15:51:30.290
> 
> 标签：jquery, navigation, height, word-wrap, css-position

我的网站顶部有一个固定位置导航。我正在使用 outerHeight 来获取导航容器的高度，然后将其添加为容器的顶部填充，以获取导航下方的内容。除非我缩小窗口，否则这一切都很好，因此导航会换行不止一行。在 Chrome 和 IE 中，outerHeight 仍然像行没有换行一样测量（在 Firefox 中工作正常）。

JS

```
function contentTopMargin() {
    var topHeight = $('#topNavContainer').outerHeight(true) - 1;
    $('#container').css('padding-top', topHeight + 'px');
}

$(document).ready(function() {
    contentTopMargin();
    });

$(window).resize(function() {
    contentTopMargin();
}); 
```

HTML

```
<header id="topNavContainer">
<nav id="topNav">

    <div class="current navItem"><a href="#1">item 1</a></div>
    <div class="navItem"><a href="#2">item 2</a></div>
    <div class="navItem"><a href="#3">item 3</a></div>
    <div class="navItem"><a href="#4">item 4</a></div>
    <div class="navItem"><a href="#5">item 5</a></div>

    <div class="clearDiv"></div><!-- for clearing floats -->
</nav>
</header>

<div id="container">
Some content
</div> 
```

CSS

```
#topNavContainer {
position: fixed;
width: 100%;
background: #333;
}

#topNav {
padding-top: 3.5rem;
padding-bottom: 1.5rem;
margin: 0 auto;
max-width: 1200px;
width: 90%;
border-bottom: 1px solid #b1bdbe;
}

#topNav div.navItem {
display: block;
float: left;
margin-right: 4%;
font-size: 1.4rem;
}

#container {
margin: 0 auto;
max-width: 1200px;
width: 90%;
padding-top: 7.5rem;
padding-bottom: 5rem;
}

.clearDiv {
clear: both;
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-10T15:53:11.363

调整窗口大小时调用您的函数

```
$(function() {
    $(window).on('resize', function() {
        contentTopMargin();
    });
}); 
```

# java - 使用 selenium 时 Firefox 冻结

> ID：10537750
> 
> 赞同：2
> 
> 时间：2012-05-10T15:51:48.027
> 
> 标签：java, firefox, selenium

我目前正在开发一个在 Firefox 上使用 selenium 的自动化项目 我的测试工作发现只要我不专注于 Firefox 窗口，一旦我专注于 Firefox 窗口，它就会立即冻结而不恢复我禁用了所有安全选项，我有没有更多想法该怎么做所以问题是我如何防止 Firefox 冻结在我身上（我正在使用 Firefox 版本 3.6.28）

# c - 在给定句柄/字符串绑定的情况下检索本地 RPC 服务器的 PID

> ID：10537762
> 
> 赞同：2
> 
> 时间：2012-05-10T15:52:29.867
> 
> 标签：c, windows, rpc

给定一个本地 rpc 绑定句柄的字符串绑定，比如“ncalrpc:SuperServer”，我们可以获得一个句柄并在该服务器上进行调用。有什么办法可以获取到手柄另一侧的服务器的PID？

[可以使用对I_RpcBindingInqLocalClientPID](http://msdn.microsoft.com/en-us/library/windows/desktop/bb204771%28v=vs.85%29.aspx)的调用来获取客户端的 PID，是否可以将其视为 I_RpcBindingInqLocalServerPID ？

# rally - 通过 WSAPI 在服务器端计数？

> ID：10537765
> 
> 赞同：3
> 
> 时间：2012-05-10T15:52:37.340
> 
> 标签：rally

是否可以使用 WSAPI 在 Rally 的服务器端进行对象计数？

例如，我有一个应用程序想要计算我们工作区中每个项目的未解决缺陷的数量。我不需要知道关于这些缺陷本身的任何事情，所以我只想要一个计数，不需要任何其他数据拉回。

有什么办法可以做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-10T16:12:48.470

您可能想查看 Alan 对此问题的有用回答：

[拉力赛：按计划状态拉故事数以进行发布？](https://stackoverflow.com/questions/10281708/rally-pull-stories-counts-by-schedule-state-for-a-release)

缺陷的类比是：

```
 https://rally1.rallydev.com/slm/webservice/1.31/defect.js?query=(State < "Fixed") 
```

它确实提取了所有数据，但您可以获取响应中返回的 TotalResultCount 属性，以获取与您的查询匹配的缺陷数。

# java - 最接近于 Java/Scala 的 SQLAlchemy

> ID：10537766
> 
> 赞同：31
> 
> 时间：2012-05-10T15:52:38.727
> 
> 标签：java, scala, orm, sqlalchemy, relational-database

作为一个不熟悉 Python 的人，我经常听到很多关于 SQLAlchemy 的赞美。所以我想了解：

1.  [与jOOQ](http://www.jooq.org)或[QueryDSL](http://www.querydsl.com)等“类型安全的 SQL 构建器”相比，它提供了什么？

2.  在 Java（或 Scala）世界中是否有更接近的等价物？我见过在这方面提到的[Apache Empire-DB ......](http://empire-db.apache.org)

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2012-08-16T07:04:17.390

关于 SQLAlchemy 的一个值得注意的事情是它使表成为第一类对象。因此，核心 API 实际上是围绕表对象编写的，因此 API 本质上是关系型的。因此，在这个级别，即使 API 是 OO，它本质上也反映了 RDBMS 对象或函数，例如表、列、关系、连接、别名等。在这个级别上，SQLAlchemy 本质上为您提供了一个 OOSQL，其中 SQL 和关系数据库没有给出二等待遇。这也是 SQLAlchemy 真正闪耀的地方，因为这种抽象级别使您能够降级到“原始”关系级别，从而获得我真的没有见过任何其他 ORM 提供的巨大灵活性。有趣的是，在 ORM 中建模类继承所需的一些底层功能是在这一层实现的，例如。连接表继承[http://docs.sqlalchemy.org/en/rel_0_7/orm/inheritance.html#joined-table-inheritance](http://docs.sqlalchemy.org/en/rel_0_7/orm/inheritance.html#joined-table-inheritance)

（至少最近）更常用的 API 是声明式 API，它实际上是更多的 OO 并将业务域中的对象映射到我上面提到的对象（在大多数情况下是透明的）。这是 ORM 功能的用武之地，该 API 与其他 ORM API 有点相似，后者与域对象一起工作，这些操作直接转换为基础表操作。

据我所知，Scala 中的 ORM 仍在追赶 Java 中容易获得的东西（例如继承），即使它们提供了其他功能（例如类型安全、类似 LINQ 的构造），即使它们正在努力应对一些严重的问题，如 22 列限制。（我读过一些评论，很少有人想知道为什么有人需要超过 22 列，至少根据我的经验，在某些情况下我不会称之为罕见的情况，其中需要多个列）。

scala 中的 ORM（即使它们与 Java 有不同的风格）我认为仍在赶上所需的东西。关于 SQLAlchemy，是否有与我在 Java 或 Scala 中看到的足够接近的等价物？我没见过。

编辑：我忘记添加的一件事是，即使使用声明性 API，SQLAlchemy 仍然可以让您直接访问底层对象。因此，如果“类 Foo”以声明方式映射，则 Foo.__table__ 是您可以根据需要直接使用的表对象。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2012-05-10T16:57:44.520

[Squeryl](http://squeryl.org)提供的可组合性类似于他们在库主页上的“SQLALCHEMY'S PHILOSOPHY”中讨论的内容。您可以查询一个查询。

```
val query = from(table)(t => where(t.a === 1) select(t))
val composed = from(query)(q => where(q.b === 2) select(q)) 
```

它还分享了设计理念的很大一部分，主要是当事情变得复杂时，库应该“让开”并允许开发人员自己调整事情。虽然 Squeryl 进行对象映射，但我认为它更像是 DSL 而不是 ORM。

快速浏览一下 SQLAlchemy 功能列表，它没有共享的一些功能：

1.  使用原始 SQL 的能力——在标准 ANSI SQL 中很难找到任何无法表达的东西。
2.  继承映射——这里有一些个人意见，但我认为当图书馆这样做时，它通常违反了“让开”的原则。

当然，Squeryl 还提供了我认为 Python 库无法提供的主要功能，即编译器检查查询的类型安全性。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2012-05-10T21:39:49.640

[ScalaQuery](https://github.com/szeiger/scala-query)（参见底部关于“slick”的注释）可以做的很简单：

```
for{
  a <- Article
  if a.dateCreated between(start, end)
  _ <- Query groupBy a.reporterID orderBy a.dateCreated.desc
} yield(a) 
```

或通过组合的任意复杂：

```
val team = for{
  t <- Team
  s <- School if t.schoolID is s.id 
} yield (t,s)

val player = for{
  r <- Roster
  p <- Player if r.playerID is p.id
} yield (r, p)

val playerDetail = for{
  (r, p) <- player
} yield (p.id, p.firstName, p.lastName, r.jerseyID, r.position, r.gamesPlayed)

val scoring = for{
  (r, p) <- player
  s <- Scoring if p.id is s.playerID
  detail <- playerDetail 
} yield (r, p, s, detail)

val scoringDetail = for{
  (r, p, s, detail) <- scoring
  val (total, goals, assists) = 
    (s.playerID.count, s.goal.sum, (s.assist1.sum + s.assist2.sum))
  val ppg = (s.playerID.count / r.gamesPlayed)
} yield (goals, assists, total, ppg) 
```

以下是获取团队统计数据的方法（可以针对联赛或单人视图进行修改）：

```
val forScoring = for{
  start ~ end ~ teamID <- Parameters[JodaTime,JodaTime,Int]
  (r,p,s,player) <- scoring if r.teamID is teamID
  comp <- bindDate(start, end) if s.gameID is comp.id
  (goals, assists, total, ppg) <- scoringDetail
  _ <- Query groupBy p.id orderBy ( ppg.desc, total.asc, goals.desc )
} yield (player, goals, assists, total, ppg)

def getScoring(start: JodaTime, end: JodaTime, id: Int): List[TeamScoring] = {
  forScoring(start, end, id).list
} 
```

我不认为在 Scala 中生成强类型的复杂查询是可能的，因此我只好自己移植经过尝试和真正的手写 SQL；也就是说，直到我遇到了 ScalaQuery，这是一个启示，就像 Scala 语言本身一样。

无论如何，你有选择，Squeryl 可能更符合 SQL Alchemy，不知道，探索一下，你可能不会失望，Scala 提供了如此多的优点，很难不感到头晕目眩这里、现在和之后;-)

ps [Zeiger 和 Vogt](http://skillsmatter.com/podcast/scala/scala-language-integrated-connection-kit)在 Scala Days Skills Matters 上关于[SLICK](http://slick.typesafe.com)的精彩演讲，ScalaQuery 的下一个发展

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2012-08-16T13:30:18.863

您还可以使用最近添加到类型安全堆栈中的[Slick 。](http://slick.typesafe.com/)

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2013-11-05T10:23:27.990

## 主动JDBC

它是“Active Record”设计模式的 Java 实现。它的灵感来自 Ruby on Rails 的 ActiveRecord ORM。它可能适合您的需要。

[https://javalite.io/activejdbc](https://javalite.io/activejdbc)

或者

## JDBI

Java 的 SQL 便利库。它尝试使用集合、bean 等在惯用的 Java 中公开关系数据库访问，同时保持与 JDBC 相同级别的详细信息。

[http://jdbi.org](http://jdbi.org)

# cordova - 验证文本字段

> ID：10537767
> 
> 赞同：1
> 
> 时间：2012-05-10T15:52:39.370
> 
> 标签：cordova, sencha-touch, extjs, sencha-touch-2

根据以下代码，名称文本字段不能留空。当用户单击文本字段并决定将其留空时，将弹出错误。

但是如果用户直接点击按钮而不点击文本字段，它会被提交并且不会显示错误消息。`name`所以我想做的是在用户点击提交按钮时提醒用户，如果他/她在文本字段上留空。

```
{   
  xtype:'textfield',
  name:'name',
  label:'name',
  required: true,
  listeners: {
      blur: function(thisTxt, eventObj) {
             var val= thisTxt.getValue();
             if ( val.length==0) {
                     // display alert
             } 
      }
  }
}]
},
{
  xtype:'button',
  id:'new-note-btn',
  text:'Send',
  ui:'confirm',
  padding:5
 }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-10T17:11:35.133

给你一些`id`财产，`textfield`然后按照下面的代码..

```
xtype:'textfield',
name:'name',
id: 'textId',
.....
...... 
```

和

```
{
  xtype:'button',
  id:'new-note-btn',
  text:'Send',
  ui:'confirm',
  padding:5,
  listeners : {
       tap : function() {
           if(Ext.getCmp('textId').getValue()=="") {
                // display the alert ..
           }
       }
  }
} 
```

**注意**：如果这`textfield`发生在您的 中`formpanel`，那么您获取这些`formpanel`值，然后尝试使用如下所示`textfield`的属性访问该值。`name`

```
// Assuming formpanel id = 'formPanelId' ...

listeners : {
    tap : function() {
         var values = Ext.getCmp('formPanelId').getValues();
         var nameValue = values.name;
         if(nameValue == "") {
               // display the alert ..
         }
    }
} 
```

# c# - C# StreamReader Close - 内存泄漏？

> ID：10537771
> 
> 赞同：1
> 
> 时间：2012-05-10T15:52:49.897
> 
> 标签：c#, .net, visual-studio, .net-4.0

我编写了一个在我们的服务器上运行很长时间（几个月）的 .NET C# windows 服务。

昨天我查了一下，发现它使用了 600MB 的内存。我重新启动了服务，现在它使用 60MB 内存。

我已经开始检查为什么它使用这么多内存。 **下面的函数会导致内存泄漏吗？**

**我认为它缺少 StreamReader 的 .Close()。**

作为测试，我已经在循环中运行了以下函数 1000 次，但我没有看到内存增加。

```
private static string GetTemplate(string queryparams)
{
    WebRequest request = HttpWebRequest.Create(uri);
    request.Method = WebRequestMethods.Http.Get;
    WebResponse response = request.GetResponse();
    StreamReader reader = new StreamReader(response.GetResponseStream());
    string tmp = reader.ReadToEnd();
    response.Close();
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-10T15:56:58.583

您的代码正在关闭响应，但不是读者。

```
var tmp = string.Empty;

using(var reader = new StreamReader(response.GetResponseStream())
{
    tmp = reader.ReadToEnd();  
}

/// do whatever with tmp that you want here... 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-05-10T15:57:36.947

所有实现`IDisposable`的对象`WebResponse`都`StreamReader`应该被处理掉。

```
private static string GetTemplate(string queryparams)
{
    WebRequest request = HttpWebRequest.Create(uri);
    request.Method = WebRequestMethods.Http.Get;
    using(var response = request.GetResponse())
    using(var reader = new StreamReader(response.GetResponseStream())
       string tmp = reader.ReadToEnd();
} 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-05-10T16:12:27.283

该代码不会产生内存泄漏。

正如每个人都指出的那样，代码并不理想（会导致关闭资源比您预期的要晚），但是当 GC 开始运行并最终确定未使用的对象时，它们将被释放。

你确定你看到内存泄漏或者你只是假设你有一个基于一些半随机值的内存泄漏？即使没有分配对象，CLR 也可能不会释放托管堆使用的内存，如果您没有足够的内存压力（尤其是在 x64 中），GC 可能不需要运行。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-05-10T16:01:02.423

如果您想查看内存是否会增加，我建议进行超过 1000 次迭代。如果是您的内存泄漏，每次迭代只会占用一小部分内存。

我不确定这是否是您的内存泄漏的根源，但是`.Close()`当您完成使用 StreamReaders 时，这是一种很好的做法。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-05-10T16:03:00.123

使用 StreamReader，最好使用“使用”，然后当对象不再在范围内时实现 IDisposable 接口。

```
using (var reader = new StreamReader(FilePath))
  {
    string tmp = reader.ReadToEnd();
  } 
```

至于你的问题1000次不是很多递归。尝试离开应用程序几个小时并计时几十万，这将为您提供更好的指示。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-05-10T15:57:12.937

它可能取决于您使用它的频率，因为您不使用对 Reader 的 Dispose() 的 esplicit 调用。为确保您在这些行中尽了最大努力，请将它们写下来，如下所示：

```
private static string GetTemplate(string queryparams)
{
    WebRequest request = HttpWebRequest.Create(uri);
    request.Method = WebRequestMethods.Http.Get;
    WebResponse response = request.GetResponse();

    using(StreamReader reader = new StreamReader(response.GetResponseStream())){

         string tmp = reader.ReadToEnd();
         response.Close();
    }

    // here will be called Dispose() of the reader 
    // automatically whenever there is an exception or not.
} 
```

# spring - 使用 Hibernate 的 Spring 数据注入

> ID：10537776
> 
> 赞同：0
> 
> 时间：2012-05-10T15:52:56.123
> 
> 标签：spring, dependency-injection

在初始化网络应用程序时，我试图将一些静态数据从数据库注入到 bean 中。

```
<bean id="CustomDriven" class="java.util.ArrayList">
        <constructor-arg>
            <value>#{FormCodeHibernateDAO.findAll()}</value>
        </constructor-arg>
    </bean> 
```

我收到一个错误

> 6:48:07,977 INFO [main] [UpdateTimestampsCache] 在区域开始更新时间戳缓存：org.hibernate.cache.UpdateTimestampsCache 16:48:07,981 INFO [main] [StandardQueryCache] 在区域开始查询缓存：org.hibernate.cache。 StandardQueryCache 16:48:09,016 DEBUG [main] [GenericDaoJpa] findAll() 16:48:09,017 DEBUG [main] [GenericDaoJpa] 获取 HIBERNATE 会话... 16:48:09,196 ERROR [main] [GenericDaoJpa] 查找所有错误时org.hibernate.SessionException：会话已关闭！在 org.hibernate.impl.AbstractSessionImpl.errorIfClosed(AbstractSessionImpl.java:72) 在 org.hibernate.impl.SessionImpl.setFlushMode(SessionImpl.java:1433)

有什么理由让我得到这个？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-10T16:04:19.387

也许#{FormCodeHibernateDAO.findAll()} 的执行是在应用程序上下文开始连接到数据库之前，我想是的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-11T11:05:03.430

我发现了问题，我的 CustomDriven bean 直接与 DAO Impl 对话。

我将其更改为使用服务与 DAO 对话，新配置看起来像

```
<bean id="CustomDriven" class="java.util.ArrayList">
        <constructor-arg>
            <value>#{dataDrivenService.getDataList()}</value>
        </constructor-arg>
    </bean> 
```

DataDriverService 类是

```
public interface DataDrivenService<T> {

    public List<T> getDataList();
 } 
```

ServiceImpl 是

```
@Service( value = "dataDrivenService" )
public class DataDrivenServiceImpl implements DataDrivenService {

    @Autowired
    @Qualifier( value = "formCodeDAO" )
    private FormCodeDAO dao;

    @Override
    @Transactional( readOnly = true )
    public List<FormCode> getDataList() {
        return dao.findAll();
    }
} 
```

扩展 GenericDAO 实现的接口中的 FormCodeDAO

# java - 我无法让这个简单的 ajax 代码工作

> ID：10537790
> 
> 赞同：0
> 
> 时间：2012-05-10T15:53:28.307
> 
> 标签：java, jquery, xml, ajax, servlets

我开始使用 jquery 学习 ajax，我尝试了很多谷歌搜索，但我无法让这个测试代码工作你能告诉我我做错了什么吗？发生的事情是 ajax 不会创建表。这是我的代码：

JSP：

```
<html>
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <script type="text/javascript" src="js/jquery.js"></script>
    <title>My First Web App</title>
    <script type="text/javascript">
        $(document).ready(function{
            $.ajax({
                type: "GET",
                url: "users",
                dataType: "xml",
                success: function(xml){
                    $("#content").append("<table>");
                    $(xml).find("user").each(function(){
                        var firstName = $(this).find("firstName").text();
                        var lastName = $(this).find("lastName").text();
                        var password = $(this).find("password").text();
                        var email = $(this).find("email").text();
                        $("#content").append("<tr>");
                        $("#content").append("<td>" + firstName + "</td>");
                        $("#content").append("<td>" + lastName + "</td>");
                        $("#content").append("<td>" + password + "</td>");
                        $("#content").append("<td>" + email + "</td>");
                        $("#content").append("</tr>");
                    });
                    $("#content").append("</table>");
                }
            });
        });
    </script>
</head>
<body>
    <div id="content"></div>
</body> 
```

小服务程序：

```
@WebServlet("/users")
public class users extends HttpServlet {
private static final long serialVersionUID = 1L;

/**
 * @see HttpServlet#HttpServlet()
 */
public users() {
    super();
    // TODO Auto-generated constructor stub
}

/**
 * @see HttpServlet#doGet(HttpServletRequest request, HttpServletResponse response)
 */
protected void doGet(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {
    response.setContentType("text/xml;charset=UTF-8");
    usuarioDAO uDAO = new usuarioDAO();
    response.getWriter().write(uDAO.getAllUsers());
} 
```

usuarioDAO：

```
public String getAllUsers()
{
    String xml = "";
    xml += "<?xml version=\"1.0\" encoding=\"UTF-8\"?>";
    xml += "<users>";
    try
    {
        getAllUsers = con.prepareStatement("SELECT * FROM users");
        synchronized(getAllUsers)
        {
            ResultSet res = getAllUsers.executeQuery();
            while (res.next())
            {
                xml += "<user>";
                xml += "<firstName>" + res.getString("firstName") + "</firstName>";
                xml += "<lastName>" + res.getString("lastName") + "</lastName>";
                xml += "<password>" + res.getString("password") + "</password>";
                xml += "<email>" + res.getString("email") + "</email>";
                xml += "</user>";
            }
        }
        getAllUsers.close();
    }
    catch (Exception ex)
    {
        System.out.println(ex);
    }
    xml += "</users>";
    return xml;
} 
```

就是这样，你能告诉我我做错了什么吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-10T16:04:14.417

和这里一样的问题：

[使用 .after() 添加 html 关闭和打开标签](https://stackoverflow.com/questions/8706457/using-after-to-add-html-closing-and-open-tags)

您正在尝试将表格标签添加为纯文本，但它不起作用。取而代之的是，首先向页面添加一个完整的表格（也是 tr）标签，然后向其中添加其他元素。完整的元素，而不仅仅是部分！

**更新**

像这样的东西：

```
 $("#content").append("<table id='table'></table>");
                var i = 0;
                $("#existingElement").html(content);
                $("#existingElement").find("user").each(function(){
                    var firstName = $(this).find("firstName").text();
                    var lastName = $(this).find("lastName").text();
                    var password = $(this).find("password").text();
                    var email = $(this).find("email").text();
                    var rowid = "row"+id;
                    $("#table").append("<tr id='"+rowid+"'></tr>");
                    $("#"+rowid).append("<td>" + firstName + "</td>");
                    $("#"+rowid).append("<td>" + lastName + "</td>");
                    $("#"+rowid).append("<td>" + password + "</td>");
                    $("#"+rowid).append("<td>" + email + "</td>");
                }); 
```

# zend-framework - 我如何在学说 where 子句中写不等于？

> ID：10537793
> 
> 赞同：6
> 
> 时间：2012-05-10T15:53:42.533
> 
> 标签：zend-framework, doctrine-orm

我希望有人可以帮助我，我正在我的存储库中编写一个自定义查询，我想做以下事情： -

```
$query = $this->_em->createQueryBuilder()
->select('a')
->from('entity', 'a')
->where('a.deleted not 1') /// how do you write NOT??? i've tried <> etc 
->getQuery(); 
```

我如何执行上述操作？

谢谢

安德鲁

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2015-07-16T08:52:09.240

弗朗切斯科的回答是正确的。这完全取决于您使用表达式生成器或高级解决方案的意愿。

对于您的特定情况，您可以选择两者之一。

表达式生成器：

```
$queryBuilder = $this->_em->createQueryBuilder();
$expr = $queryBuilder->expr();

$query = $queryBuilder
    ->select('a')
    ->from('entity', 'a')
    ->where($expr->neq('a.deleted', 1))
    ->getQuery(); 
```

有关高级解决方案，请参阅 Rawkode 的回答。除了更改`!=`to`<>`或使用`a.deleted = 0`.

更好的是用 Doctrine 参数化它

```
->where('a.deleted = :deleted')
->setParameter('deleted', false); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2014-03-07T16:44:32.337

只需使用**neq()**，如下例所示：

```
$query = $repository->createQueryBuilder('t');
$expr = $query->expr();
$orx = $expr->orX();

$orx->add($expr->neq('t.pageTitle', $expr->literal('value1')));
$orx->add($expr->neq('t.metaDescription', $expr->literal('value2')));

$query->andWhere($orx); 
```

上面的代码产生：

```
AND (
    t1_.page_title <> 'value1' 
    OR t1_.meta_description <> 'value2'
) 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-10T15:56:46.093

```
$query = $this->_em->createQueryBuilder()
->select('a')
->from('entity', 'a')
->where('a.deleted != 1') /// how do you write NOT??? i've tried <> etc 
->getQuery(); 
```

'!=' 表示不相等

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-05-11T02:26:34.133

!= 表示不等于 !=== 表示不等于

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-06-26T04:29:41.500

```
$queryBuilder = $repository->createQueryBuilder('a');
$query = $queryBuilder
    ->where($queryBuilder->expr()->notIn('u.id', 1)
    ->getQuery(); 
```

我不确定查询构建中的不等于运算符。但是，这可能会对您有所帮助。顺便说一句，我也在寻找更好的答案。

# c++ - x86 架构的内存排序限制

> ID：10537810
> 
> 赞同：3
> 
> 时间：2012-05-10T15:54:41.643
> 
> 标签：c++, multithreading, architecture, c++11, memory-model

在他的伟大著作“C++ Concurrency in Action”中，Anthony Williams 写道（第 309 页）：

> 例如，在 x86 和 x86-64 架构上，原子加载操作总是相同的，无论是标记为 memory_order_relaxed 还是 memory_order_seq_cst（参见第 5.3.3 节）。这意味着使用宽松的内存排序编写的代码可以在具有 x86 架构的系统上运行，而在具有更细粒度的内存排序指令集（例如 SPARC）的系统上可能会失败。

我是否理解在 x86 架构上所有原子加载操作都是正确的`memory_order_seq_cst`？此外，在[cppreference](http://en.cppreference.com/w/cpp/atomic/memory_order) `std::memory_order`站点上提到，在 x86 上发布-获取排序是自动的。

如果此限制有效，那么这些排序是否仍适用于编译器优化？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-08-29T13:21:57.480

是的，排序仍然适用于编译器优化。

此外，在 x86 上“原子加载操作始终相同”并不完全准确。

在 x86 上，完成的所有加载都`mov`具有获取语义，并且完成的所有存储都`mov`具有释放语义。所以acq_rel、acq 和relaxed 加载都是simple `mov`s，acq_rel、rel 和relaxed 存储类似（acq 存储和rel 加载总是等于relaxed）。

然而，这对于 seq_cst 不一定是正确的：架构不*保证*seq_cst 的语义`mov`。事实上，x86 指令集没有任何特定指令用于顺序一致的加载和存储。只有 x86 上的原子读取-修改-写入操作才会具有 seq_cst 语义。因此，您可以通过执行`lock xadd`参数为 0 的 fetch_and_add 操作（指令）来获得加载的 seq_cst 语义，并通过执行 seq_cst 交换操作（`xchg`指令）并丢弃先前的值来获得存储的 seq_cst 语义。

但你不需要两者都做！只要所有 seq_cst 存储都用 完成`xchg`，seq_cst 加载就可以简单地用`mov`. 双重的，如果所有的加载都是用 完成的`lock xadd`，seq_cst 存储可以简单地用`mov`.

`xchg`并且`lock xadd`比 慢得多`mov`。因为程序的负载（通常）比存储多，所以使用 seq_cst 存储很方便，这样`xchg`（更频繁的） seq_cst 负载可以简单地使用 a `mov`。此实现细节在 x86 应用程序二进制接口 (ABI) 中进行了编码。在 x86 上，兼容的编译器必须编译 seq_cst 存储，`xchg`以便可以使用更快的`mov`指令完成 seq_cst 加载（可能出现在另一个翻译单元中，使用不同的编译器编译）。

因此，一般来说，seq_cst 和获取加载在 x86 上使用相同的指令完成是不正确的。这是正确的，因为 ABI 指定 seq_cst 存储被编译为`xchg`.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-10T16:18:45.570

编译器当然必须遵循语言的规则，无论它运行在什么硬件上。

他说的是，在 x86 上，您没有宽松的排序，因此即使您不要求，您也会得到更严格的排序。这也意味着在 x86 上测试的此类代码可能无法在具有宽松排序的系统上正常*工作*。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-09-03T05:38:13.613

值得记住的是，虽然负载放松和 seq_cst 负载可能映射到 x86 上的相同指令，但它们并不相同。编译器可以跨内存操作自由地重新排序加载放松到不同的内存位置，而不能跨其他内存操作重新排序 seq_cst 加载。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-11-07T13:58:19.850

书中的句子以一种有点误导的方式写成。在架构上获得的排序不仅取决于您如何转换原子负载，还取决于您如何转换原子存储。

在 x86上实现的常用方法是在任何存储和来自同一线程的后续加载`seq_cst`之间的某个时间点刷新存储缓冲区。编译器保证这一点的常用方法是在存储后刷新，因为存储比加载少。在这个翻译中，负载不需要刷新。`seq_cst``seq_cst``seq_cst`

如果您仅使用普通加载和存储来编程 x86，则可以保证加载提供`acquire`语义，而不是`seq_cst`.

至于编译器优化，在 C11/C++11 中，编译器在考虑底层硬件之前，会根据基于特定原子语义的代码移动进行优化。（硬件可能会提供更强的排序，但编译器没有理由因此限制其优化。）

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2019-12-12T03:44:50.653

> 我是否理解在 x86 架构上所有原子加载操作都是正确的`memory_order_seq_cst`？

只有（程序的，程序中的一些线程间可见操作的）执行可以是顺序的。单个操作本身不是顺序的。

**询问单个隔离操作的实现是否是顺序的，是一个毫无意义的问题。**

所有需要保证的内存操作的转换必须遵循启用该保证的策略。可能有不同的策略具有不同的编译器复杂性成本和运行时成本。

[只是说实现虚函数有不同的策略：唯一可以（符合我们对速度、可预测性和简单性的所有期望）的策略是使用 vtables，所以所有编译器都使用 vtable，但没有定义虚函数就像通过 vtable 一样。]

在*实践*中，用于在给定 CPU（据*我所知*）上实现操作的策略并*没有*大相径庭。编译器之间的差异很小，不会妨碍二进制兼容性。但是存在潜在的差异，多线程程序的高级全局优化可能会为更高效的原子操作代码生成开辟新的机会。`memory_order_seq_cst`

 *根据您的编译器，仅包含对象的轻松加载和`memory_order_seq_cst`修改的程序`std::atomic<>`可能仅表现出顺序行为，也可能不表现出顺序行为，即使在强排序 CPU 上也是如此。*

# asp.net - 使用按钮在 ASP.NET 的新选项卡/窗口中打开链接

> ID：10537811
> 
> 赞同：0
> 
> 时间：2012-05-10T15:54:42.927
> 
> 标签：asp.net

我正在尝试使用按钮单击在新选项卡/窗口中打开页面。我查看了与[此类](https://stackoverflow.com/questions/6248702/redirecting-new-tab-on-button-click-response-redirect-in-asp-net-c-sharp)似的解决方案，但给出的答案要么使用链接，要么在同一窗口中打开。我需要使用一个按钮，因为它需要根据表单中输入的标准数据（字符串操作）生成链接。但是，此按钮未提交表单；它只是验证外部站点上的一些数据。我需要在不同的窗口或选项卡中使用它，以便他们可以在我的表单和验证站点之间来回切换。这基本上是我目前的`Button_Click`活动：

```
var Address = AddressTextbox.Text.Trim();
Address = Address.Replace(' ', '+');
var Url = "http://www.example.com/query?text=" + Address + "&param1=foo&param2=bar";
Response.Redirect(Url); 
```

这有效，`Response.Redirect(Url)`只是只在同一个窗口中打开，而不是新窗口。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-10T16:04:57.490

只需从 Button 上的 Click 事件处理程序中吐出 javascript 代码。

```
var Address = AddressTextbox.Text.Trim();
Address = Address.Replace(' ', '+');
var Url = "http://www.example.com/query?text=" + Address + "&param1=foo&param2=bar";
Page.ClientScript.RegisterStartupScript(this.GetType(), "dsadas", "window.open('"+Url+"');", true); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-10T15:57:14.857

使用`OnClientClick`属性：

```
<script type="text/javascript">
    redirectToPage = function(url){
        void(window.open(url, "child_window"));
        return false;
    }
</script>
<asp:Button ID="Button1" runat="server"
    Text="Click Me!"
    OnClientClick="return redirectToPage('/somefolder/somepage.aspx');" /> 
```

使用该`OnClientClick`属性，重要的是要记住`return false`最后，否则按钮单击将触发回发。

**编辑**

如果您想从 click 事件处理程序打开一个新窗口，您可以执行以下操作：

```
protected void Button1_Click(object sender, EventArgs e)
{
    Page.ClientScript.RegisterStartupScript(Page.GetType(), "open_window", 
        string.Format("void(window.open('{0}', 'child_window'));", "/somefolder/somepage.aspx"), true);
} 
```

诚然，这有点难看，但是如果在执行按钮单击逻辑之前您不会拥有某些信息，那么这可能是您的最佳选择。如果有任何方法可以在单击按钮之前构建 URL，则只需分配`OnClientClick`in 代码隐藏。

# unix - 无法连接到 beaglebone.local

> ID：10537816
> 
> 赞同：5
> 
> 时间：2012-05-10T15:54:53.063
> 
> 标签：unix, networking, ip-address, beagleboard, angstrom-linux

当我使用以太网电缆将其插入新网络时，我需要知道如何使用 SSH 连接到 beaglebone（或 beagleboard），如下所示：

```
 $ ssh root@beaglebone.local 
```

到目前为止，*如果我知道 IP 地址*，我只能像这样访问它：

```
 $ ssh root@<ip_address> 
```

但我并不总是知道新网络上的板子的 IP 地址，所以我希望使用如下名称访问它：beaglebone.local。

现在，当我尝试执行此操作时，出现此错误：

```
 "ssh: Could not resolve hostname beaglebone.local: nodename nor servname provided, or not known" 
```

我检查了主机名和主机文件，并将“127.0.0.1 beaglebone”添加到 beaglebone 上的主机，但不确定我还能做什么？

```
 # cat /etc/hostname 
    beaglebone 

    # cat /etc/hosts 
    127.0.0.1        localhost.localdomain                localhost 
    127.0.0.1        beaglebone 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-20T03:57:09.767

我在 Angstrom-Cloud9-IDE-GNOME-eglibc-ipk-v2012.05-beaglebone-2012.04.22.img.xz 上运行我的 beaglebone 时遇到了类似的问题。在这个发行版中，“beaglebone.local”应该会在系统启动后出现在网络上。

重新启动后大约 50% 的时间里，“beaglebone.local”不会出现在网络上（尽管可以通过 IP 地址获得骨骼）。发生这种情况时，“systemctl status avahi-daemon.service”显示 avahi-daemon 以“退出代码 255”失败。有趣的是，随后的“systemctl start avaihi-daemon.service”总是会成功，并且“beaglebone.local”会出现在网络上。

“journalctl | grep avahi”也返回了一条消息，说明“守护进程已经在运行 gon PID NNN”。

因此，我通过将“ExecStartPre=/bin/rm -f /var/run/avahi-daemon/pid”行添加到 /lib/systemd/system/avahi-daemon 的 [Service] 部分来“修复”该问题。服务。有了这个添加，“beaglebone.local”现在出现在网络上 100% 重新启动。

我说“已修复”（即，用引号引起来）是因为我无法找到遗留在杂散 avahi pid 文件周围的根本原因，因此没有真正的修复。

——弗兰克

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-10T17:04:17.587

我讨厌回答我自己的问题。在出现更好的方法之前，以下 hack 将一直有效：

这个 shell 脚本（其中 xxx.xxx.xxx 是您计算机 IP 中的前三个数字）将通过循环遍历子网上的所有 IP 地址来找到您的 beaglebone 或 beagleboard（即插入到具有 DHCP 的新网络上的以太网）并尝试以root身份登录每个。如果找到，请尝试您的密码。如果它不起作用，只需按 Enter 键，直到循环再次开始。如果它没有找到板，那么可能是其他问题。

```
for ip in $(seq 1 254); do ssh root@xxx.xxx.xxx.$ip -o ConnectTimeout=5; [ $? -eq 0 ] && echo "xxx.xxx.xxx.$ip UP" || : ; done 
```

**更新 1**

今天我插入了 beaglebone，看到 Bonjour 识别出它加入了网络。所以我试了一下，它奏效了。不知道为什么它突然决定，但确实如此。奇怪，但真实。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-16T07:44:04.633

要使“beaglebone.local”正常工作，您的主机必须能够识别 Zeroconf。BeagleBone 使用[Avahi](http://en.wikipedia.org/wiki/Avahi_%28software%29)告诉 LAN 上的其他系统它在那里并为应用程序提供服务，并且它应该被称为“beaglebone”。如果有多个，则第二个通常称为“beaglebone-2.local”。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-12T20:14:34.070

我在使用 Mac OS X 10.7 时经常遇到这个问题。但与 Frank Halasz 不同，“systemctl status avahi-daemon.service”显示没有失败。事实上，问题出在 Mac 端。使用以下命令重新启动 Bonjour 解决了该问题。

```
$ sudo launchctl unload /System/Library/LaunchDaemons/com.apple.mDNSResponder.plist
$ sudo launchctl load -F /System/Library/LaunchDaemons/com.apple.mDNSResponder.plist 
```

# c# - 查找 DI 的构造函数依赖项的快速方法

> ID：10537822
> 
> 赞同：0
> 
> 时间：2012-05-10T15:55:12.533
> 
> 标签：c#, visual-studio-2010, dependency-injection, constructor, ninject

我正在使用 Ninject 将一个复杂的项目粘合在一起，并且我想重构一些依赖项，以便更好地利用工厂模式（在 ninject.extensions.factory 中实现）。我发现我的很多时间都花在了在屏幕/文件之间切换以确定需要满足哪些构造函数依赖项来实例化特定类型。

我想知道是否存在任何工具/扩展/加载项/工作流程来让我的生活更轻松一些。

# c# - 在字典中拆分字符串

> ID：10537825
> 
> 赞同：2
> 
> 时间：2012-05-10T15:55:27.697
> 
> 标签：c#

如何拆分以下字符串

```
string s = "username=bill&password=mypassword";

Dictionary<string,string> stringd = SplitTheString(s); 
```

这样我就可以按如下方式捕获它：

```
string username = stringd.First().Key;
string password = stringd.First().Values; 
```

请告诉我。谢谢

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-10T15:59:46.150

您可以像这样填充字典列表：

```
Dictionary<string, string> dictionary = new Dictionary<string, string>();
string s = "username=bill&password=mypassword";

foreach (string x in s.Split('&'))
{
    string[] values = x.Split('=');
    dictionary.Add(values[0], values[1]);
} 
```

这将允许您像这样访问它们：

```
string username = dictionary["username"];
string password = dictionary["password"]; 
```

注意：请记住，此函数中没有验证，它假定您的输入字符串格式正确

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-05-10T16:01:25.320

看起来您正在尝试解析查询字符串 - 这已经内置，您可以使用[`HttpUtility.ParseQueryString()`](http://msdn.microsoft.com/en-us/library/ms150046.aspx)它：

```
string input = "username=bill&password=mypassword";
var col = HttpUtility.ParseQueryString(input);
string username = col["username"];
string password = col["password"]; 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-05-10T16:00:28.910

我认为类似的东西应该可以

```
public Dictionary<string, string> SplitTheStrings(s) {
    var d = new Dictionary<string, string>();  
    var a = s.Split('&');
    foreach(string x in a) {
        var b = x.Split('=');
        d.Add(b[0], b[1]);
    }
    return d;
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-05-10T16:08:12.620

```
 var splitString = "username=bill&password=pass";
        var splits = new char[2];
        splits[0] = '=';
        splits[1] = '&';
        var items = splitString.Split(splits);
        var list = new Dictionary<string, string> {{items[1], items[3]}};

        var username = list.First().Key;
        var password = list.First().Value; 
```

这也是我的工作

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-05-10T16:18:40.713

如果键不会重复

```
var dict = s.Split('&').Select( i=>
{
    var t = i.Split('=');
    return  new {Key=t[0], Value=t[1]};}
).ToDictionary(i=>i.Key, i=>i.Value); 
```

如果键可以重复

```
 string s = "username=bill&password=mypassword";
    var dict = s.Split('&').Select( i=>
    {
        var t = i.Split('=');
        return  new {Key=t[0], Value=t[1]};}
    ).ToLookup(i=>i.Key, i=>i.Value); 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-05-10T16:12:28.233

其他答案更好，更容易阅读，更简单，更不容易出现错误等，但另一种解决方案是使用这样的正则表达式来提取所有键和值：

```
MatchCollection mc = Regex.Matches("username=bill&password=mypassword&","(.*?)=(.*?)&"); 
```

匹配集合中的每个匹配项都有两个组，一组用于键文本，一组用于值文本。

我不太擅长正则表达式，所以我不知道如何在不将尾随'&'添加到输入字符串的情况下使其匹配......

# c# - 具有用户输入内容的自定义 WinForm ListBox

> ID：10537826
> 
> 赞同：0
> 
> 时间：2012-05-10T15:55:33.160
> 
> 标签：c#, winforms, .net-4.0

我需要提供来自特定数据集的多个对象作为选项，并填充一个列表，以便最终用户可以选择无、某些、全部或全部 + 可能缺少的数据字段（用户输入）。

我最初计划扩展一个 System.Windows.Forms.ListView 以包含一个包含复选标记的空白项，然后专门处理用户单击此空白行项的情况。

如果可能，我希望能够删除这些用户输入的行项目。我不必使用 System.Windows.Forms.ListView，但它的设计似乎最适合这种特殊用途。

是否已经有具有此功能的控件，或者我错过的 System.Windows.Forms.ListView 的属性可以处理这些情况？

---*更新*---

> ```
> ListBox is changed to System.Windows.Forms.ListView 
> ```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-10T15:58:49.067

DataGrid 听起来很合适；否则我建议查看第 3 方控件。

# matlab - 在 Matlab 中求解向量方程

> ID：10537828
> 
> 赞同：1
> 
> 时间：2012-05-10T15:55:45.077
> 
> 标签：matlab, vector, system, equation

如何在 matlab 中解决这种系统？：

a + b + c = 0
a + d + e = 0 ...等

其中每个符号变量（它们以前用“syms”定义）都在 R^3 中，例如：

a = [0 R1 R2]；
b = [0 R3*cos(alpha) R3*sin(alpha)];

...等（R1、R2、R3、.. 也是符号变量，但是是一维的，即：标量）

我确实搜索了很多，但每个人都解决了标量系统，而不是向量系统。
在这种情况下，每个向量方程代表 3 个标量方程

我知道我可以将整个系统重新格式化为一个矩阵并求解 Ax=0 但这将是很多工作，因为这些是 39 个方程。

非常感谢

# iphone - iOS：取消无效功能

> ID：10537830
> 
> 赞同：1
> 
> 时间：2012-05-10T15:55:52.453
> 
> 标签：iphone, objective-c, ios, xcode, ipad

例如，我创建了一个方法`changeColor`来调用我们使用的方法

```
[self changeColor]; 
```

但我怎样才能取消这些方法？

已编辑：这是我的代码我有几个按钮，它们将一些图像添加到图像视图

```
- (void) setImagesFrame1 {

        NSMutableArray *imageArray = [[NSMutableArray alloc]initWithCapacity:12];
        for (int i = 0; i <= 12; i++) {
        NSString *fileName = [NSString stringWithFormat:@"a%d.png",i];
        UIImage *j = [UIImage imageNamed:fileName];
        UIImageView *tempImage = [[UIImageView alloc]initWithImage:j];
        [imageArray addObject:tempImage];
        [self createPageWithImage:tempImage forPage:i];

    }

}

- (void) setImagesFrame2 {

        NSMutableArray *imageArray = [[NSMutableArray alloc]initWithCapacity:12];
        for (int i = 0; i <= 12; i++) {
        NSString *fileName = [NSString stringWithFormat:@"s%d.png",i];
        UIImage *j = [UIImage imageNamed:fileName];
        UIImageView *tempImage = [[UIImageView alloc]initWithImage:j];
        [imageArray addObject:tempImage];
        [self createPageWithImage:tempImage forPage:i];

    }

} 
```

等等 ...

我用这个动作调用我的方法：

```
- (IBAction)openFrames:(UIButton *)sender {

    [captureView addSubview:framesPreviewView];
    [framesPreviewView sendSubviewToBack:captureView];
    framesPreviewView.frame = CGRectMake(img.bounds.origin.x, img.bounds.origin.y, img.bounds.size.width,  img.bounds.size.height);

        //buttons 
    if (sender == frame1) { [self setImagesFrame1];   }
    if (sender == frame2) {  NSLog(@"frame2"); }
    if (sender == frame3) { [self setImagesFrame3]; NSLog(@"frame3"); }

} 
```

当我按下 frame1 按钮时，图像将被添加到我的视图中，问题是当我按下 frame2 按钮时，此方法的图像也会添加到我的视图中我需要避免这种情况，这意味着当我触摸每个按钮时，其他按钮的方法应该取消

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-10T15:57:55.603

要离开 void 函数，请执行 return 语句...

```
return; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-10T16:11:38.657

你可以：

*   按下 frame1 时禁用 frame2 按钮
*   setImagesFrame1 结束时启用 frame2 按钮

像这样的东西：

```
- (void) setImagesFrame1 {
    frame2.enabled = NO;

    [... your code ...]

    frame2.enable;
} 
```

因此，如果有人按下按钮 1，则在完成所有操作之前，他无法按下按钮 2（并重绘某些东西）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-11T13:29:04.837

您的子视图数组上的最后一个视图将是图像，您应该使用方法 [view removeFrom superView]; 但是，要做到这一点，您需要在子视图数组上使用快速枚举（for-In 循环）。如果你想完全确定，你可以检查重新调整的对象，如果它属于 UIImageView 类。然后你应该在你的 setImages 方法中执行剩余的语句。

示例：`
UIView *tempView;

```
 for(tempView in self.subviews) {

           if([tempView isKindOfClass:[UIImageView class] ]){
            [tempView removeFromSuperView];

          }
       } 
```

`

# c++ - 数组在第一个索引上崩溃

> ID：10537839
> 
> 赞同：0
> 
> 时间：2012-05-10T15:56:39.227
> 
> 标签：c++, arrays, visual-studio

我刚开始使用 C++，但我一直在解决一个非常烦人的问题。一旦我使用动态数组，我就被卡住了。数组在调试中看起来真的很乱（看图片），一旦我将更多的一个对象添加到数组中，它就会崩溃。这不是我得到一个特定项目的错误，而是所有使用动态数组的代码，我什至尝试编译老师在本课程中编写的代码，但没有成功。因此，问题不太可能是代码，但可能是其他问题。但是，为了安全起见，我确实包含了我用来证明这一点的测试代码。 ![代码调试](../Images/5dbdd01ed26e24652aaec9d7ce315dd3.png)

```
#include "iostream"
#include "string"
#include "Student.h"
int main()
{
    _CrtSetDbgFlag( _CRTDBG_ALLOC_MEM_DF | _CRTDBG_LEAK_CHECK_DF);
    string input;
    Student **students = NULL;
    students = new Student*[20];
    for(int i = 0; i < 20; i++)
    {
        students[i] = new Student();
    }
    for(int i = 0; i < 20; i++)
    {
        delete students[i];
    }
    delete[] students;
    return 0;
}

#include "Student.h"
#include "string"

Student::Student()
{
    name = "";
    number = 0;
}
Student::Student(string Name)
{
    name = Name;
    number = 0;
}
Student::~Student()
{

}
string Student::getName() const
{
    return name;
}

#ifndef STUDENT_H
#define STUDENT_H
#include "string"
#include "Course.h"
using namespace std;
class Student
{
private:
    string name;
    int number;
public:
    Student();
    Student(string Name);
    virtual ~Student();
    string getName() const;
};
#endif 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-10T16:21:25.430

它在调试器中看起来混乱的原因是因为您试图查看*student*（您尚未分配，因此内容适当地无效）而不是数组*students*。调试器无法显示动态分配的数组。

还有，`students = new Student();`？这甚至不应该*编译*，而且逻辑是错误的。您正在将 a 分配`Student*`给 a `Student**`。

作为一般规则，永远不要`new[]`在您自己的代码中使用。始终使用`std::vector`. 然后您将自动构建正确数量的`Student`类，并且永远不会泄漏内存或任何类似的事情。

```
int main() {
    std::vector<Student> students;
    string input;
    students.resize(20);
    // Now you can use ALL THE STUDENTS
    return 0;
} 
```

# asp.net - 从 asp.net 服务器向客户端网页发送更新消息

> ID：10537842
> 
> 赞同：1
> 
> 时间：2012-05-10T15:56:52.207
> 
> 标签：asp.net

如果我想实现类似于 stockticker 的东西，我应该使用计时器，还是有办法在服务器发生变化时更新网页内的元素（如 gridview）？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-10T16:00:03.840

### 描述

我强烈建议使用 SignalR。好处是您不必考虑浏览器的兼容性。它根据浏览器支持的内容使用轮询、长轮询或 websocket。它允许将更改推送到客户端，是开源的并且易于设置。查看[SignalR 股票代码示例](http://vimeo.com/31938189)

> **SignalR** - .NET 的异步库，可帮助构建实时、多用户交互式 Web 应用程序。

您可以使用 nuget 安装它。

> PM> 安装包 SignalR

### 更多信息

*   [具有与 SignalR 的实时持久长期运行连接的异步可扩展 Web 应用程序](http://www.hanselman.com/blog/AsynchronousScalableWebApplicationsWithRealtimePersistentLongrunningConnectionsWithSignalR.aspx)
*   [信号R](http://signalr.net/)
*   [Github - SignalR / SignalR](https://github.com/SignalR/SignalR)

# xml - 如何将 XSLT 身份模式应用于文档中的特定节点？

> ID：10537848
> 
> 赞同：0
> 
> 时间：2012-05-10T15:57:14.280
> 
> 标签：xml, xslt

我有一个要使用 XSLT 转换的 XML 文档，我不想对整个文档使用身份模式，而只想在文档中使用一个元素。例如，在我想应用身份模式。有任何想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-10T16:27:53.390

如果您想在其他地方应用其他模板的同时对单个节点进行未更改的深层复制，只需`<xsl:copy-of>`在样式表中的适当位置使用 。

# django - Django 阻止缓存包含的 html 片段

> ID：10537850
> 
> 赞同：3
> 
> 时间：2012-05-10T15:57:16.043
> 
> 标签：django, templates, caching

我有一个 Django 视图，它使用装饰器来启用缓存：

```
@cache_page(24 * 60 * 60) # cache for 24 hours
def index(request):
    # view code 
```

此视图对应于这样的模板：

```
{% extends "base.html" %}

{% load i18n %}

{% block content %}
    html code
{% endblock %} 
```

base.html：

```
{% load i18n %}
<!DOCTYPE html>
<html>
<head>
      <div id="content">
      {% block content %}
      {% endblock %}
      </div>

      <!-- need to tun off caching here... -->
      <div id="sidebar">
          {% include "language_switcher.html" %}
          {% include "login_box.html" %}
      </div>
      <!-- ...and then back on -->

</body>
</html> 
```

在侧栏中，我有几个不应缓存的动态元素。如何仅“关闭”模板这部分（侧边栏）的缓存？

非常感谢任何帮助。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-10T16:26:31.530

检查此应用程序：[https](https://github.com/codysoyland/django-phased) ://github.com/codysoyland/django-phased和此博客文章： http: [//www.holovaty.com/writing/django-two-phased-rendering/](http://www.holovaty.com/writing/django-two-phased-rendering/)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-10T16:05:49.893

我假设您知道[模板片段缓存](https://docs.djangoproject.com/en/dev/topics/cache/#template-fragment-caching)- 不过，我不相信在此处设置较低的值会覆盖设置为较长时间的视图级缓存。这当然意味着您必须分别缓存 index.html 的不同部分，这是可行的，但不太可能是您想要的。

您还可以查看[此处](http://djangosnippets.org/snippets/1801/)`clearcache`实现的模板片段的标记。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-10T16:06:49.843

你不能，真的。当你缓存整个视图时，Django 根本不处理它。它只是从缓存中返回相同的响应，其中包括完整的 HTML。您*可以*将不同的标头添加到缓存中，但这对您没有帮助，除非有一些东西可以改变（登录用户等）。仅对与其他任何内容无关的基本更改内容块无济于事。

删除视图级缓存并手动缓存您想要的视图中的内容*。*否则，你就不走运了。

# django - Django 更改查询结果的字段类型（！）

> ID：10537856
> 
> 赞同：2
> 
> 时间：2012-05-10T15:57:25.323
> 
> 标签：django, django-models, django-orm

我有以下型号

```
类监视器数据（模型。模型）：
  [... 其他的东西]
  starttime = models.CharField(max_length=64, db_column='spurlStartTime', blank=True)

```

所以，starttime 是一个 char 字段（在数据库中，它代表一个 datetime 列）

现在，这就是我正在做的事情：

```
oo=models.MonitorData.objects.all()
打印 oo[0].starttime
打印类型（oo[0].starttime）

```

这就是我得到的：

```
00:35:59
<类型'日期时间.时间'>

```

出于我自己的原因（不想讨论它们），我想将其作为 varchar 读取，然后自己解析。但是 django 不允许我这样做，因为出于我不知道的原因，它会将其转换为日期时间！

任何人都可以向我解释为什么 django 有这种行为，我怎样才能找回我宝贵的字符串？有没有办法强制 django 将此值转换为字符串？

ps：我知道如何使用 str() 所以请不要回答我

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-10T16:43:24.797

Django 没有对它做任何事情。DBAPI 适配器看到它是一个 DATETIME，因此返回一个日期时间。并且没有任何东西`CharField`可以强制日期时间发送文本。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-11-27T10:51:33.873

我认为，而不是以日期时间格式保存值。尝试将其保存为 isoformat。您可以轻松转换。

# java - 将数据打印到预先打印的表格/文具上

> ID：10537859
> 
> 赞同：2
> 
> 时间：2012-05-10T15:57:31.687
> 
> 标签：java, image, forms, printing, alignment

我们有一个要求，我们已经预先打印了文具，并希望用户将数据放入 HTML 表单并能够在该表单上打印数据。对齐/文本大小等非常重要，因为预印的文具已经有每个字符的框。在java中实现这一目标的好方法是什么？我正在考虑使用碧玉报告。还有其他选择吗？可能是带有文本或其他内容的叠加图像？

此外，我们可能需要能够在普通纸上打印，在这种情况下，我们的应用程序需要打印这些框，并且打印后的表格应该与已打印的包含数据的空白信纸相匹配。

我们有一些开源框架来做这些事情吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-10T16:04:28.550

Jaspersoft 报告——http: [//sourceforge.net/projects/jasperreports/](http://sourceforge.net/projects/jasperreports/)

然后，您将创建 XML 模板，然后您将能够生成 PDF、HTML、CSV、XLS、TXT、RTF 等格式的报告。它具有自定义报告的所有必要选项。以前用过，推荐一下。

您将使用 iReport 创建模板，然后编写代码让引擎以不同的可能方式传递数据。

检查[http://www.jaspersoft.com/jasperreports](http://www.jaspersoft.com/jasperreports)

编辑：

您可以拥有背景图像并将框覆盖在其上并设置最大字符大小的限制......等等

它非常强大，并为您提供了很多选择

这是 iReport 的背景图片教程之一[http://ireport-tutorial.blogspot.com/2008/12/background-image-in-ireport.html](http://ireport-tutorial.blogspot.com/2008/12/background-image-in-ireport.html)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-10T16:28:58.537

有些事情要考虑。首先在网页方面，您要使用文具作为表单布局吗？一定要准确吗？梳理框（每个字符一个） 你想在网页上显示它，还是稍后处理梳理。你将如何处理说一个经过梳理的 6 位数字。这是否正确对齐。如果他们输入 7 位数字会怎样。文本也一样。如果它不适合怎么办。字体选择，我们在使用 W 时获得了很多乐趣...您希望框中的字符如何对齐，这意味着什么字体限制，我们查看的一些自动魔术软件确实像改变每个字符的大小这样的废话.

精梳编辑是一场噩梦，我们显示精梳，但在选择时将编辑表面提高到整个框的大小。

另一件事可能会让您发疯，您会发现盒子的大小和布局存在细微差异，因此它们从远处看起来还不错，但一列盒子会移动一个像素。一些测试人员不得不把他们的电子显微镜借给我们，这样我们才能看到我们有多少墨水分子。:(

预计会在 UI 方面花费大量时间，并记住打印的文具更改，因此为自己提供某种形式的元描述开始时会为您省去很多麻烦。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-28T12:37:27.457

打印以电子方式填写的表格内容时，最大的问题是在预打印的表格上正确对齐。您可能会为一台打印机对齐内容，但当您使用另一台打印机时，它会完全错位。

Fly Software 有一个名为 InForm Designer 的表单设计产品，它允许用户指定和保存打印机的垂直和水平偏移量，从而很好地解决了这个问题。这确保填写的表单内容始终对齐。我试过了，效果很好。看看你自己在这里...

[http://www.flysoftware.com/products/inform_designer/overview.asp](http://www.flysoftware.com/products/inform_designer/overview.asp)

在您自己的应用程序中实现类似于 InForm 的打印机偏移可能是值得的（如果可能的话）。

# c# - 在现有数据网格行上实现拖放选项？

> ID：10537862
> 
> 赞同：0
> 
> 时间：2012-05-10T15:57:38.787
> 
> 标签：c#, jquery

我有一个事件数据网格，其中的数据按事件顺序排序（在数据库表中有一个名为 event_order 的列）。我需要实现拖放选项，以便用户可以拖动任何行并在行之间放置任何位置，以便 ajax 应该使用该项目的更新顺序更新我的数据库表。只是建议我如何开始。

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-10T21:01:50.123

我会研究 JQueryUI 插件。它具有拖放功能：

[http://jqueryui.com/demos/droppable/](http://jqueryui.com/demos/droppable/)

# cocoa - 你能右对齐集合视图吗？

> ID：10537864
> 
> 赞同：2
> 
> 时间：2012-05-10T15:57:45.747
> 
> 标签：cocoa

通常集合视图中的视图是左对齐的，但这并不总是看起来很好，是否可以右对齐或居中？

例如

```
|view1 view2 view3|
|            view4| 
```

或者

```
|view1 view2 view3|
|      view4      | 
```

# php - 如何为使用 Ajax 的无限滚动页面加载整个（或更多）DOM？

> ID：10537867
> 
> 赞同：0
> 
> 时间：2012-05-10T15:57:55.890
> 
> 标签：php, parsing, dom

如果您查看这样的页面：[http ://www.fieg.nl/ias-demo#/](http://www.fieg.nl/ias-demo#/)

您可以看到它使用 Ajax 在您滚动到底部时动态添加内容，类似于 Google 图片的工作方式。

如果我想捕获这样的页面以进行解析，我会执行以下操作：

```
$page = file_get_contents("http://www.fieg.nl/ias-demo#/"); 
```

但这只会获取在任何 Ajax 发生之前最初加载的所有内容。是否可以使用 PHP 或 CURL 或任何其他程序来捕获整个页面并自动加载 Ajax 内容并同时捕获它？

此外，如果碰巧有一个奇怪的页面，它永远不会停止加载内容并且永远持续下去，我不确定该工具将如何处理它。因为在那种情况下，该工具永远不会找到 DOM 的结尾。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-10T16:07:23.057

当用户滚动到页面底部时，这些页面通过发送 ajax 请求来获取更多数据来工作。然后，javascript 将 ajax 请求的响应写入页面底部。

您需要运行像 firebug 这样的工具来分析向服务器发出的请求以检索下一页内容（使用网络面板）。找到请求 URL 后，您需要在 PHP 脚本中模拟这些请求。

不幸的是，SO 不是人们将您的脚本编写到蜘蛛网站的地方，但无论如何都有理论。

# android - 多个类可以接收相同的广播接收器意图吗

> ID：10537872
> 
> 赞同：2
> 
> 时间：2012-05-10T15:58:17.763
> 
> 标签：android, android-intent, broadcastreceiver, manifest

我已经回顾了[android 如何为具有不同权限和意图过滤器的同一个广播接收器解析 AndroidManifest 中的多个条目的答案？](https://stackoverflow.com/questions/7237646/how-does-android-resolve-multiple-entries-in-the-androidmanifest-for-the-same-br)但我的问题略有不同。

如果我的应用程序中有 2 个类，1 个用于启动服务，另一个用于根据不同的系统事件停止服务，它们是否都可以接收相同的广播。

我想根据用户是打开还是关闭飞行模式来启动或停止我的服务。将在我的清单中使用以下条目触发这两个类中的 onReceive()。

```
 <receiver android:name=".StartService">
        <intent-filter>
            <action android:name="android.intent.action.BOOT_COMPLETED"/>
            <action android:name="android.intent.action.BATTERY_OKAY"/>
            <action android:name="android.intent.action.ACTION_POWER_CONNECTED"/>"
        </intent-filter>
        <intent-filter>
            <action android:name="android.intent.action.AIRPLANE_MODE"/>
        </intent-filter>
    </receiver>

    <receiver android:name=".StopService" >
        <intent-filter>
            <action android:name="android.intent.action.BATTERY_LOW"/>
        </intent-filter>
        <intent-filter>
            <action android:name="android.intent.action.AIRPLANE_MODE"/>
        </intent-filter>

        <!-- for power testing only -->
        <!--<intent-filter>
            <action android:name="android.intent.action.ACTION_POWER_DISCONNECTED"/>
        </intent-filter>-->
    </receiver> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-10T16:05:06.767

我不确定这是否可能，但另一种方法是在 StartService 接收器中捕获它，然后在其中检查您的服务状态。如果您的服务已经启动，请启动您的广播并在您的 StopService 中捕获它？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-10T16:05:47.643

如果我没记错的话，您可以在班级听众中注册以捕获这些事件。即连接管理器。因此，您可以将单个类作为服务运行，以捕获连接的变化（此时您可以检测到您是否处于飞行模式）并执行任何操作，或者在当前处于活动状态的 Activity 中注册以监听那些事件也是如此。就个人而言，我会在几乎所有情况下都选择在后台运行的服务。

编辑：读过你的问题后，听起来你开始使用一个类的服务，并想用另一个类终止该服务。在这种情况下，我认为不一定是最好的方法。相反，在您已启动的服务中，注册以捕获连接更改并让服务自行停止。

# php - 跨多个站点传输大量数据

> ID：10537877
> 
> 赞同：0
> 
> 时间：2012-05-10T15:58:49.613
> 
> 标签：php, json, oop

最近我遇到了一个问题——我目前在多个站点之间传输语言字符串的方法占用了太多内存。基本上，我只是在一台服务器上创建了一组数据，并用 json 将其呼应出来。

例如 -

```
$data = array(1, 2, 3);
echo json_encode($data); 
```

> PHP 致命错误：在 [..]

主要思想是**，只要我的客户单击，就将语言字符串从语言编辑器传输到我的网站`update`**。

问题是，这个 x-fer 非常频繁地进行（只要我的客户点击`update`网站上的按钮），而且总是很难手动完成。

所以我的问题是： **如何跨多个站点传输如此庞大的数据阵列？**

显然，我的解决方案还不够好。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-10T16:04:54.137

我对这些问题有一些经验。解决问题的简单方法是将该数组拆分为一些请求。

# symfony - Symfony 登录用户的 id

> ID：10537879
> 
> 赞同：54
> 
> 时间：2012-05-10T15:58:53.653
> 
> 标签：symfony, doctrine-orm, dql

我正在使用 Symfony2 和教义 2 开发应用程序。我想知道如何获取当前登录的用户 ID。

* * *

## 回答 #1

> 赞同：139
> 
> 时间：2012-05-10T16:18:06.250

**当前 Symfony 版本（Symfony 4，Symfony >=3.2）**

[由于**Symfony >=3.2**](https://symfony.com/blog/new-in-symfony-3-2-user-value-resolver-for-controllers)，您可以简单地期望将`UserInterface`实现直接注入到您的控制器操作中。然后，您可以调用`getId()`以检索用户的标识符：

```
class DefaultController extends Controller
{
    // when the user is mandatory (e.g. behind a firewall)
    public function fooAction(UserInterface $user)
    {
        $userId = $user->getId(); 
    }

    // when the user is optional (e.g. can be anonymous)
    public function barAction(UserInterface $user = null) 
    {
        $userId = null !== $user ? $user->getId() : null;
    }
} 
```

从 2.6 开始，您仍然可以像在所有 Symfony 版本中一样使用安全令牌存储。例如，在您的控制器中：

```
$user = $this->get('security.token_storage')->getToken()->getUser(); 
```

请注意，*不再鼓励使用此答案下一部分中提到**的快捷方式。`Controller::getUser()`*

**旧版 Symfony 版本**

以前访问用户最简单的方法是扩展基本控制器，并使用快捷`getUser()`方式：

```
$user = $this->getUser(); 
```

从**Symfony 2.6**开始，您可以从安全令牌存储中检索用户：

```
$user = $this->get('security.token_storage')->getToken()->getUser(); 
```

**在 Symfony 2.6 之前**，令牌可以从安全上下文服务访问：

```
$user = $this->get('security.context')->getToken()->getUser(); 
```

请注意，*安全上下文服务在 Symfony 2 中已被弃用，并在 Symfony 3.0 中被删除。*

* * *

## 回答 #2

> 赞同：17
> 
> 时间：2013-08-25T14:46:40.260

在 symfony2 中，我们可以通过以下代码来简化：

```
$id = $this->getUser()->getId(); 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-11-28T11:05:27.290

您可以使用以下代码获取变量：

```
$userId = $this->get('security.context')->getToken()->getUser()->getId(); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-12-15T12:34:52.707

这可以穿在方法：

```
/**
 * Get user id
 * @return integer $userId
 */
protected function getUserId()
{
    $user = $this->get('security.context')->getToken()->getUser();
    $userId = $user->getId();

    return $userId;
} 
```

并归纳 $this->getUserId()

```
public function example()
{
    print_r($this->getUserId()); 
} 
```

# htmlunit - HtmlArea 上的 Click() 没有任何变化，为什么？

> ID：10537880
> 
> 赞同：1
> 
> 时间：2012-05-10T15:58:55.713
> 
> 标签：htmlunit

我正在尝试使用 HtmlUnity，但在尝试使用 javaScript 单击区域时遇到了麻烦。

这是代码：

```
import java.io.IOException;
import java.net.MalformedURLException;

import com.gargoylesoftware.htmlunit.FailingHttpStatusCodeException;
import com.gargoylesoftware.htmlunit.WebClient;
import com.gargoylesoftware.htmlunit.html.HtmlArea;
import com.gargoylesoftware.htmlunit.html.HtmlElement;
import com.gargoylesoftware.htmlunit.html.HtmlMap;
import com.gargoylesoftware.htmlunit.html.HtmlPage;

public class ToPost {

    /**
     * @param args
     * @throws IOException 
     * @throws MalformedURLException 
     * @throws FailingHttpStatusCodeException 
     */
    public static void main(String[] args) throws FailingHttpStatusCodeException, MalformedURLException, IOException {
        HtmlPage page;
        final WebClient webClient = new WebClient();
        page = webClient.getPage("http://www.hidrografico.pt/previsao-mares.php");
        System.out.println(page.getTitleText());
        HtmlPage pagePortoLeixoes = setPort(page, "362,64,440,90");
        System.out.println("Are they the same? "+page.asXml().equals(pagePortoLeixoes.asXml()));
    }

    private static HtmlPage setPort(HtmlPage page, String coordinatesPort) throws IOException {
        HtmlMap map = page.getHtmlElementById("FPMap1");
        Iterable<HtmlElement> childAreas = map.getChildElements();
        HtmlArea tempArea;
        for (HtmlElement htmlElement : childAreas) {
            tempArea = (HtmlArea) htmlElement;
            if(tempArea.getCoordsAttribute().equals(coordinatesPort)){
                System.out.println("Found Leixoes! --> "+ tempArea.asXml());
                return tempArea.click();
            }
        }
        return null;
    }
} 
```

我没有在这里显示它，但我仔细检查了我的完整代码，我真的不在我想要的页面中。

怎么了？为什么点击不起作用？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-11T15:32:25.723

当涉及“复杂”javascript 时，HtmlUnit .click() 通常效果不佳。

> [http://htmlunit.sourceforge.net/apidocs/com/gargoylesoftware/htmlunit/html/HtmlElement.html#click](http://htmlunit.sourceforge.net/apidocs/com/gargoylesoftware/htmlunit/html/HtmlElement.html#click) ()
> 
> 模拟单击此元素，在单击该元素后返回具有焦点的窗口中的页面。请注意，返回的页面可能与原始页面相同，也可能不同，具体取决于单击的元素类型、JavaScript 动作侦听器的存在等

在这种情况下，您必须找到另一种方法来捕获数据。

我所看到的是，使用 .rss 链接，它为您提供到城市的直接链接......例如：[http ://www.hidrografico.pt/previsao-mares-aveiro.php](http://www.hidrografico.pt/previsao-mares-aveiro.php)

另一种方法是伪造一个 POST 请求（以 Httpfox 为例，当您遇到页面时会完成哪些请求）

# iphone - 我应该在哪里展示模态视图控制器？

> ID：10537881
> 
> 赞同：0
> 
> 时间：2012-05-10T15:59:00.277
> 
> 标签：iphone, ios, uitabbarcontroller, presentmodalviewcontroller

我有一个在其顶层带有 UITabBarController 的应用程序。我跟踪用户在哪个选项卡上并存储它，以便当他们重新打开应用程序时，他们位于关闭时所在的选项卡上。所以应用程序启动时没有默认选项卡。

我有一个模式屏幕，每次应用程序启动时都会首先显示。保存哪个选项卡并不重要，用户总是会看到这个视图。

这个模态视图应该从哪里呈现？合乎逻辑的做法是让 UITabBarController 将其作为 rootViewController 呈现，但 Apple 不鼓励子类化 UITabBarController。另一种方法是将 UIViewController 作为处理演示的 rootViewController，但 Apple 坚持认为 UITabBarController 应该是 rootViewController。

那么我应该如何处理呢？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-10T16:10:02.557

如果您从基于窗口的应用程序开始并首先设置`viewController`as `rootViewController`，然后在完成此操作`viewController`后设置`tabBarController`as `rootViewController`，我认为您没有问题。

# ssis - ssis中buffer temp和blob temp的实际用途是什么

> ID：10537884
> 
> 赞同：1
> 
> 时间：2012-05-10T15:59:11.033
> 
> 标签：ssis

我已将 sql server 属性中的内存设置更改为低内存。此外，我已将缓冲区临时路径更改为系统的特定位置。但是为什么包因内存不足而失败？如果我们设置缓冲区临时和blob temp，数据应该交换到那个临时位置对吗？那么如果它失败了，缓冲区临时有什么用？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-10T16:55:57.533

有点相关[SSIS 2005 中 BufferTempStoragePath 的默认文件路径位置是什么？](https://stackoverflow.com/questions/8858463/what-is-the-default-file-path-location-for-buffertempstoragepath-in-ssis-2005/8889210#8889210)特别是，阅读来自 bimonkey 的链接文章，该文章涉及从 sql 代理服务帐户访问磁盘上的这些位置。

一般来说，当你的包报告内存不足时，这是由于使用了[完全阻塞转换](http://sqlblog.com/blogs/jorg_klein/archive/2008/02/12/ssis-lookup-transformation-is-case-sensitive.aspx)和查找任务拉回太多数据。如果您的包大量使用阻塞转换，请尝试将工作卸载到源系统。如果查找是罪魁祸首，请尝试在查询中更具选择性。不要拉回整个表，只拉你需要的列。如果这不够有选择性，您可以尝试使用 where 子句过滤该数据集（我只需要当年的数据等）。否则，将查找从完全缓存模式切换到部分缓存或无缓存。对于通过的每一行，没有缓存会导致对源系统的一次性查询。它将没有记忆，它在 2 行前运行了完全相同的查询。部分缓存通过将 X MB 数据保存在内存中来解决这一难题。如果您想了解有关如何减少内存使用的更多详细信息，请发布一些有关您的包外观的屏幕截图。另请注意，

数据流的架构是将数据读入内存缓冲区，并将这些缓冲区的地址传递给各种任务。不是每个任务都需要分配给它们的内存来保存通过它们的数据，而是它们都使用相同的共享内存集。将内存从一个任务复制到另一个任务会很慢，而且在内存消耗方面非常昂贵。

有了前言，什么是[BufferTempStoragePath 和 BlobTempStoragePath](http://msdn.microsoft.com/en-us/library/ms141031.aspx)？每当您将大型对象类型（n/varchar(max)、xml、图像等）拉入数据流时，该数据*不会*像本机类型那样保存在内存缓冲区中。相反，它被写入磁盘，指向该地址的指针被放入内存缓冲区。BufferTempStoragePath 用于当您的数据流任务仍有工作要做但您要么

*   使你的记忆如此碎片化（通过完全/部分阻塞转换）引擎无法再获得
*   试图在一个任务中做太多该死的事情。我的经验法则是，我应该能够跟踪从包中的任何转换到所有源和目标的线。如果您从导入/导出向导创建了一个包，那么这些数据流是拆分为单独流的主要候选者，因为它喜欢将不相关的事物分组到一个数据流中，这会使它们占用大量内存。
*   盒子根本没有足够的资源来处理数据。我通常更愿意避免在工作中投入更多的硬件，但如果你已经解决了前两颗子弹，这将是我手枪中的最后一颗。

# java - 使用 ObjectInputStream 计算对象的总和

> ID：10537889
> 
> 赞同：0
> 
> 时间：2012-05-10T15:59:37.320
> 
> 标签：java, fileinputstream

我的逻辑再次需要一些帮助。假设`Loan`该类存在，我有一个包含`Loan`对象的文件。我正在`Loan`从文件中读取对象并计算总贷款金额。我给其中一个实例一个变量名`ld`，只是为了向自己证明该`getLoanAmount()`方法有效。

现在在我的 while 循环的最后，我一直在思考如何计算贷款对象，但将它们转换为整数。我认为该`input.readObject()`方法正在返回对象的一个​​实例，因此只有这样获取整数值才有意义：

```
sum = sum + input.readObject().getLoanAmount(); 
```

但是，我收到一个错误，说它找不到符号`getLoanAmount()`，这就是我感到困惑的地方。我以为我搞定了。谁能告诉我为什么我的逻辑是错误的。像往常一样，我真的很感激。这是代码：

```
import java.io.*;
import java.util.Date;
public class RestoringObjects19_7 {
    public static void main(String[] args) throws IOException {
        int sum = 0;
        try {
            ObjectOutputStream output = new ObjectOutputStream(
              new FileOutputStream("Exercise19_7.dat"));
            Loan ld = new Loan(1000);
            System.out.println(ld.getLoanAmount()); //WORKS HERE

            output.writeObject(ld);
            output.writeObject(new Loan(2000));
            output.writeObject(new Loan(3000));
            output.writeObject(new Loan(4000));
            output.writeObject(new Loan(5000));

            output.close();
            ObjectInputStream input = new ObjectInputStream(
              new FileInputStream("Exercise19.7.dat"));
            while(true) {
                sum = sum + input.readObject().getLoanAmount(); //ERROR HERE??
            }
        } catch (Exception e) {
            System.out.println("Sum: " + sum);
        }
  }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-10T16:03:25.757

这看起来像是家庭作业，所以我会给你提示而不是一个完整的答案：

*   方法`input.readObject()`返回类型是`Object`.
*   `getLoanAmount()`是在类型对象上定义的方法`Loan`。

希望这可以帮助您弄清楚您的代码可能有什么问题。

# hibernate - SEAM休眠查询DAO执行两次

> ID：10537895
> 
> 赞同：2
> 
> 时间：2012-05-10T15:59:54.777
> 
> 标签：hibernate, jsf, seam, seam2

我有一个有状态的支持 bean，它在 @Create 方法期间调用以下休眠查询（查询如下所示）：

```
@Override
@SuppressWarnings("unchecked")
public List<Session> getUserSessions(User user, Date startDate, Date endDate){
    String s = "select distinct s from Session s";
    s += " where s.user = :user and s.date >= :startDate and s.date <= :endDate order by s.date desc";
    Query query = this.getEntityManager().createQuery(s);
    System.out.println("Making Query");
    query.setParameter("user", user);
    query.setParameter("startDate", startDate);
    query.setParameter("endDate", endDate);
    return query.getResultList();
} 
```

但是，当我打开 SQL 日志记录时，我可以看到查询运行了两次？请参阅下面的日志

```
16:49:04,563 DEBUG [actions.sessions.SessionActionsBean] Searching for sessions from:     Wed Feb 01 00:00:00 GMT 2012 to: Wed Feb 29 23:59:59 GMT 2012
16:49:04,564 INFO  [STDOUT] Making Query
16:49:04,564 INFO  [STDOUT] Making Query
16:49:04,565 INFO  [STDOUT] Hibernate: select distinct session0_.session_id as session1_101_, session0_.av_pace as av2_101_, session0_.calories as calories101_, session0_.date_created as date4_101_, session0_.date as date5_101_, session0_.distance as distance101_
16:49:04,565 INFO  [STDOUT] Hibernate: select distinct session0_.session_id as session1_101_, session0_.av_pace as av2_101_, session0_.calories as calories101_, session0_.date_created as date4_101_, session0_.date_swam as date5_101_, session0_.distance as distance101_ 
```

从 JSF 调用的支持 bean 只运行一次，但 DAO 查询 bean 似乎调用了两次 getUserSessions()？

这是有原因的，还是日志记录问题？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-08T15:49:02.107

这两个查询并不完全相同。第一个`SELECT`子句要求 column`session0_.date`而第二个子句 select `session0_.date_swam`。

你确定没有其他事情发生吗？

# java - 如何覆盖弹簧安全消息？

> ID：10537897
> 
> 赞同：2
> 
> 时间：2012-05-10T16:00:00.473
> 
> 标签：java, spring-security

如何覆盖诸如“不良凭据”之类的春季消息？我已经使用以下 bean 配置了我的 servlet 上下文文件

```
<bean id="messageSource" class="org.springframework.context.support.ReloadableResourceBundleMessageSource">
    <property name="basename" value="WEB-INF/messages" />       
    <property name="defaultEncoding" value="UTF-8" />       
</bean>

<bean id="localeResolver"
    class="org.springframework.web.servlet.i18n.CookieLocaleResolver">
    <property name="defaultLocale" value="en" />
</bean> 
```

我可以使用`<spring:message>`标签显示来自我的自定义文件的消息。在同一个文件中，我重新定义了所有映射到 spring-security-core.jar （messages.properties 文件）中“坏凭证”的消息，但它们没有被使用。我仍然看到“不良凭据”消息。如何覆盖这些弹簧消息？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-13T09:14:44.263

事实证明，这些 bean 应该在一般应用程序上下文中定义，而不是在 myservlet-servlet.xml 文件中。一旦我从 servlet 上下文中移动了定义，它就开始按预期工作。

* * *

## 回答 #2

> 赞同：-2
> 
> 时间：2013-06-07T09:12:33.373

使用正确的属性名称。

使用基本名称而不是基本名称

# node.js - 从标签中删除博客引用

> ID：10537899
> 
> 赞同：0
> 
> 时间：2012-05-10T16:00:02.313
> 
> 标签：node.js, mongodb, mongoose

我正在使用 Mongoose 在 Node 中开发一个应用程序，您可以在其中发布博客条目并标记它们。当博客条目被删除时，我想从博客中删除它的引用，这里是我需要帮助的地方。

下面是删除博客条目的路线，但是当我尝试删除博客条目时，我得到“TypeError: Cannot call method 'find' of undefined”，所以我猜我下面的代码是错误的。

```
app.post('/blog/delete/:id', function(req, res){

    model.BlogPost.findById(req.params.id, function (err, blog){
        if (err) {
            console.log(err);
            // do something
        }

        blog.remove(function(err) {
            console.log(err);
            // do something
        });

        var query = model.Tag.find( { blogs: { $in : blog } } );

        query.exec(function (err, tags) {
            if (err) {
                console.log(err);
                // do something
            }
            tags.remove();

            res.redirect('back');
        });
    });
}); 
```

博客条目的模型：

```
var BlogPostSchema = new Schema({
    name : String,
    type : String,
    author : ObjectId,
    title   : String,
    body : String,
    buf : Buffer,
    date: { type: Date, default: Date.now },
    comments : [CommentSchema],
    meta : {
        upvotes : Number,
        downvotes : Number,
        // points : { type Number, default: },
        favs : Number,
        uniqueIPs : [String],
        tags : [String]
    }
});

modelObject.BlogPost = mongoose.model('BlogPost', BlogPostSchema); 
```

标签型号：

```
var TagSchema = new Schema({
      name              : String
    , blogs             : [String]
});

modelObject.TagSchema = TagSchema;
modelObject.Tag = mongoose.model('Tag', TagSchema); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-10T17:34:18.757

没有行号很难分辨，但看起来 model.Tag 可能未定义。

*旁注：除非找到并成功删除博客，否则您可能不想删除标签。*

# asp.net - .ascx 中的控件在回发时未显示其新值

> ID：10537903
> 
> 赞同：1
> 
> 时间：2012-05-10T16:00:15.620
> 
> 标签：asp.net

这似乎是一个基本问题，但它让我难住了。

我有一个在 page_load 上加载自定义控件 (.ascx) 的主页。

此自定义控件有两个字段。其中一个是下拉列表，另一个是文本框。当下拉列表更改值时，它会触发回发，一些逻辑在服务器端执行，并为文本框生成一个值。我逐步完成了代码，并正确创建并分配了值。但是，在呈现页面时，该值不会改变。

如果我将文本框的值更改为“QQQ”并触发回发，“QQQ”会留在文本框中，以便我可以验证视图状态是否正常工作。

是否有任何原因导致生成的值未在回发的表单中显示。此过程在初始页面加载时运行良好。

**.aspx.cs**

```
protected void Page_Load(object sender, EventArgs e)
{
   string ascxPath = @"~/_CONTROLTEMPLATES/TRC_BITS.ascx";
   TRC_BITS control = Page.LoadControl(ascxPath) as TRC_BITS;
   phForm.Controls.Add(control);
} 
```

**.ascx**

```
 <asp:TextBox ID="message" runat="server" TextMode="MultiLine" /><br/>
   <asp:DropDownList ID="year" runat="server" AutoPostBack="true">
      <asp:ListItem Text="2011">2011</asp:ListItem>
      <asp:ListItem Text="2012">2012</asp:ListItem>
      <asp:ListItem Text="2013">2013</asp:ListItem>
   </asp:DropDownList> 
```

**.ascx.cs**

```
protected void Page_Load(object sender, EventArgs e)
{
    if (!Page.IsPostBack)
    {
        year.SelectedValue = DateTime.Now.Year.ToString();
    }
    if (year.SelectedValue == 2012)
       message.Text = "ABC";
    else
       message.Text = "XYZ";
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-10T16:03:18.177

因为您是动态地将这些控件添加到页面中，所以您需要为用户控件分配一个 ID。确保每次回发页面时为控件分配相同的 ID，并且将从 ViewState 重新填充字段。

此外，正如 Shai 所建议的那样，如果您在`OnInit`而不是`Page_Load`. `LoadViewState`用户控件的情况略有不同，但通常您希望在方法执行之前添加动态内容。

![在此处输入图像描述](../Images/856834599e49ac8f263f794a35587767.png)

如果您正在寻找一些东西来消除持久动态内容的痛苦，我建议您看看[DynamicControlsPlaceHolder](http://www.denisbauer.com/ASPNETControls/DynamicControlsPlaceholder.aspx)。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-10T16:11:05.363

因为您是动态添加控件，所以需要在页面的 oninit 事件期间添加它们。试试看，相信我。去吧。雅拉。

# c# - C# 正在向 mysql 发送错误的参数

> ID：10537905
> 
> 赞同：0
> 
> 时间：2012-05-10T16:00:18.367
> 
> 标签：c#, mysql, decimal

我正在将参数从 c# 发送到 mysql 数据库。问题是我在 c# 中有十进制值（例如： 45.335 ）但是当我将它发送到 mysql 时，它一直以这种格式发送它（ 45,335 ）我做错了什么？

```
 MySqlConnection con = null;
    MySqlCommand cmd = null;

    con = new MySqlConnection("server=localhost;database=data;uid=root;pwd=*****");
    con.Open();
    cmd = new MySqlCommand("insert into data values (null, ?ParName , ?Parname2);", con);
    cmd.Parameters.AddWithValue("?ParName", OSGconv.deciLat);
    cmd.Parameters.AddWithValue("?Parname2", OSGconv.deciLon);
    cmd.ExecuteNonQuery();

    con.Close();
    } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-10T16:03:52.430

这几乎可以肯定是本地化问题。在英国，我们使用句号作为小数点，但在欧洲大陆，使用逗号代替。检查您的应用和数据库的国家/地区设置。

# mod-rewrite - htaccess *.php to *.html object not found 错误

> ID：10537910
> 
> 赞同：0
> 
> 时间：2012-05-10T16:00:26.603
> 
> 标签：mod-rewrite, http-status-code-404

我正在尝试将 URL 从`index.php`to转换`index.html`为`servicii.php`to`servicii.html`等等。

我在我的文件中写入 了以下代码`.htaccess`，该文件位于我的[站点根目录中：](http://alexbtest.hostei.com/)

```
<IfModule mod_rewrite.c>  
    RewriteEngine On  
    RewriteBase     /
    RewriteRule     ^(.*)\.php$   $1.html [R=permanent] 
</IfModule> 
?> 
```

但是当我关注“Prima pagina”（主页）或“Servicii”（在网站上创建的唯一 2 个页面）时，它给了我一个 404 错误

另外，我有代码

```
<IfModule mod_rewrite.c>
    RewriteEngine on
    RewriteBase  /fetesti/
    RewriteRule  ^(.*)\.php$   $1.html [R=permanent] 
</IfModule> 
```

在我的本地机器上，它是基于 XAMPP 的。它给了我找不到对象 404，并在我的 Apache 日志中：

> 找不到文件 [...]/index.html；

我知道重写引擎正在工作（我写了乱码，它给了我 505 内部服务器错误并进行了其他测试）

我究竟做错了什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-12T12:24:13.143

尝试删除 [R] 永久重定向，并在规则中切换扩展

```
<IfModule mod_rewrite.c>  
    RewriteEngine On  
    RewriteBase     /
    RewriteRule     ^(.*)\.html$   $1.php
</IfModule> 
```

# c# - 在 VS2010 中通过静态分析检测 lambdas 的滥用

> ID：10537914
> 
> 赞同：1
> 
> 时间：2012-05-10T16:00:34.543
> 
> 标签：c#, visual-studio-2010, optimization, resharper

我的一位同事从以下代码开始：

```
var newList = new List<>();

foreach(var item in otherList)
{
    newList.Add(GetNewObjectFrom(item));
} 
```

ReSharper 在此处正确识别了 LINQ 的使用，并将其更改为：

```
var newList = otherList.Select(o => GetNewObjectFrom(o)).ToList(); 
```

但是，lambda 是不必要的，可以通过传递方法进一步简化：

```
var newList = otherList.Select(GetNewObjectFrom).ToList(); 
```

**我的问题**：

Visual Studio 2010 Professional 中的任何工具或 ReSharper 的各种变通工具都可以检测到应该进行的这种更改吗？我意识到最好的工具是第二组人眼，这就是这个问题的起点……但我的工作越多由计算机完成越好。

编辑：太棒了，这是一个 ReSharper 错误。这是一个示例程序：

```
using System.Linq;

namespace ResharperMethodGroupBug
{
    class Program
    {
        static void Main(string[] args)
        {
            var program = new NumberProgram(new NumberProcessor());
            program.Run();
        }
    }

    class NumberProgram
    {
        private readonly INumberProcessor numberProcessor;

        public NumberProgram(INumberProcessor numberProcessor)
        {
            this.numberProcessor = numberProcessor;
        }

        static long SquareNumber(int n)
        {
            return n * n;
        }

        public void Run()
        {
            var listOfNumbers = Enumerable.Range(1, 100).ToList();

            // appropriately triggers "convert to method group"
            var listOfSquares = listOfNumbers.Select(n => SquareNumber(n));

            // does not trigger "convert to method group" when it should
            var listOfCubes = listOfNumbers.Select(n => this.numberProcessor.CubeNumber(n));

            // proof that a method group works here
            var anotherListOfCubes = listOfNumbers.Select(this.numberProcessor.CubeNumber);
        }
    }

    interface INumberProcessor
    {
        long CubeNumber(int n);
    }

    class NumberProcessor : INumberProcessor
    {
        public long CubeNumber(int n)
        {
            return n * n * n;
        }
    }
} 
```

编辑 2：我在 JetBrains 的 Youtrack 上发布了一个问题：http: [//youtrack.jetbrains.com/issue/RSRP-301259](http://youtrack.jetbrains.com/issue/RSRP-301259)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-10T16:11:10.933

Resharper 已经检测到这一点并建议简化：

```
 static void Main(string[] args)
    {
        var items = new[] { 1, 2, 3 };
        var list = items.Select(i => Foo(i)).ToList(); // R# suggests "Convert to method group"
    }

    static int Foo(int i)
    {
        return i;
    } 
```

（使用 VS2010 Pro SP1 和 R# 5.1.3 测试）

# c - 在 GNU/Linux/C 中使用多播 (224.0.0.12) 发现 DHCP 服务器

> ID：10537917
> 
> 赞同：5
> 
> 时间：2012-05-10T16:00:42.453
> 
> 标签：c, linux, multicast, dhcp

这个问题可能源于对 IP 多播的根本误解，所以如果我不在基地，请纠正我。

我正在尝试编写 C 代码来查找网络上所有 DHCP 服务器的 IP 地址。用例是这样的：

1.  客户端广播 DHCP 发现。
2.  我的专有中继代理接收数据包，添加一些基本信息，然后将其单播转发到已知 IP 地址的 DHCP 服务器。

我遇到的问题是告诉中继代理 DHCP 服务器在哪里。我发现多播地址 224.0.0.12 是 IANA 为 DHCP 服务器保留的，所以我想我只需将服务器配置为侦听该多播流量。但是，每当我将 IP_ADD_MEMBERSHIP 的 linux 套接字选项配置为 224.0.0.12 时，它都会使用 IGMP，这是一个完全独立的协议，我不想实现它。

我只是误解了多播的工作原理吗？我不应该能够从中继代理向 224.0.0.12 发送 ping 并让它从所有 DHCP 服务器返回 ping 响应吗？

* * *

附加信息：

*   当我做一个时，所有盒子上的接口都列出了 MULTICAST`ifconfig`
*   我已经`ip route add 224.0.0.0/4 dev eth0`在所有盒子上添加了多播路由

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-12T04:49:27.967

也许您应该做客户端所做的事情 - 在目标网络上使用 DHCPDISCOVER 数据包广播（而不是多播！）？我有几个正在运行的 DHCP 服务器，它们都没有在 224 网络上监听。

您可能还需要请求您现有的地址，或者发送 DHCPRELEASE 以获取您返回的任何优惠，以免在服务器上的虚假预订中占用地址。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-01T17:59:14.607

在一般 IPv4 设置中，使用广播到 UDP 端口 67，而不是多播。广播请求应由网络上的所有 DHCP 服务器响应。查看[Wikipedia 页面上解释的详细信息或阅读](http://en.wikipedia.org/wiki/Dynamic_Host_Configuration_Protocol#Technical_details)[RFC 2131](http://www.ietf.org/rfc/rfc2131.txt)第 3 节中的广播解释。另请参阅[此线程](https://stackoverflow.com/questions/1791616/implementing-dhcp-client)。

# android - StackOverflowError 与 PreferenceActivity

> ID：10537919
> 
> 赞同：0
> 
> 时间：2012-05-10T16:00:54.403
> 
> 标签：android, preferenceactivity, stack-overflow

我创建了一个类似于 Android ApiDemos 中的 PreferenceActivity。

我正在使用此代码来创建活动：

```
protected void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);

    addPreferencesFromResource(R.xml.bridges_references);
    //setPreferenceScreen(createPreferenceHierarchy());
} 
```

这个xml：

```
<?xml version="1.0" encoding="utf-8"?>
<PreferenceScreen
    xmlns:android="http://schemas.android.com/apk/res/android">

<PreferenceCategory
        android:title="Preferences">

    <CheckBoxPreference
            android:key="hasLoops"
            android:defaultValue="true"
            android:title="@string/title_hasLoops"
            android:summary="@string/summary_hasLoops" />

    <ListPreference
        android:key="width"
        android:defaultValue="7"
        android:summary="@string/summary_width"
        android:dialogTitle="@string/title_width"
        android:title="@string/title_width"
        android:entryValues="@array/size_values"/>

    <ListPreference
        android:key="height"
        android:defaultValue="7"
        android:summary="@string/summary_height"
        android:dialogTitle="@string/title_height"
        android:title="@string/title_height"
        android:entryValues="@array/size_values"/>

</PreferenceCategory>

</PreferenceScreen> 
```

当我尝试使用以下方式开始偏好活动时：

```
Intent intent = new Intent(activity.getApplicationContext(), BridgesPreferenceActivity.class);
activity.startActivity(intent); 
```

我得到一个 StackOverflowError：

```
java.lang.StackOverflowError
 at java.io.ObjectOutputStream.writeObjectInternal(ObjectOutputStream.java:1746)
 at java.io.ObjectOutputStream.writeObject(ObjectOutputStream.java:1696)
 at java.io.ObjectOutputStream.writeObject(ObjectOutputStream.java:1660)
 at java.io.ObjectOutputStream.writeFieldValues(ObjectOutputStream.java:1153)
 at java.io.ObjectOutputStream.defaultWriteObject(ObjectOutputStream.java:420)
 at java.io.ObjectOutputStream.writeHierarchy(ObjectOutputStream.java:1251)
 at java.io.ObjectOutputStream.writeNewObject(ObjectOutputStream.java:1587)
 at java.io.ObjectOutputStream.writeObjectInternal(ObjectOutputStream.java:1854)
 at java.io.ObjectOutputStream.writeObject(ObjectOutputStream.java:1696)
 at java.io.ObjectOutputStream.writeObject(ObjectOutputStream.java:1660)
 at java.io.ObjectOutputStream.writeFieldValues(ObjectOutputStream.java:1153) 
```

（太长了，看不出是什么原因造成的；它被切断了）

每当我包含 ListPreference 或 EditTextPreference 时都会发生这种情况。CheckBoxPreference 工作正常。

有时，当我减小数组的大小时它会工作一次，但是一旦我第二次打开首选项，我就会再次收到 StackOverflowError。

知道我做错了什么吗？类似的代码在 ApiDemos 中可以完美编译和运行。

亲切的问候，斯蒂芬。

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2012-05-11T14:36:56.277

好的，显然这与我如何保存调用活动的状态有关，而不是实际的偏好活动。我正在保存一个序列化的对象，它在例如方向改变时可以正常工作，但由于某种原因，当我调用新活动时就不行了。

在将我的首选项完全重写为正常的 Activity 后，我发现了这一点，但它仍然不断抛出相同的错误。

那好吧。*叹*

# javascript - 使用 LinkedIn 插件申请 - 语言支持

> ID：10537927
> 
> 赞同：2
> 
> 时间：2012-05-10T16:01:23.523
> 
> 标签：javascript, linkedin

首先，我对插件本身只有英文感到*失望。*例如，如果用户单击“使用 LinkedIn 应用”按钮并登录到法语个人资料，则它会正确显示。只返回一个页面，该页面的插件以英文显示“已应用”。

为了解决这个问题，我编写了一些 javascript 来在按钮加载后将“通过 LinkedIn 申请”和“共享”文本替换为法语等价文本。我现在遇到的问题是按钮的“已应用”版本。它似乎与实际插件异步加载，这意味着它在某些情况下会覆盖我的法语文本，但在其他情况下不会。

我知道我可以在提交申请时利用 onsuccess 事件。但是，当该 LinkedIn 用户重新访问该页面时，“已应用”文本并不总是以正确的语言显示。

**问题 1**：有没有人幸运地使用任何技术来达到预期的结果？

**问题 2**：LinkedIn 什么时候才能真正支持这个？

非常感谢任何帮助或指导。

谢谢！

**更新：**

我可以确认 Igor F. 使用 setInterval 函数并每 100 毫秒检查一次更改的解决方案是最佳选择，并且在所有经过测试的浏览器中都能完美运行。

**感谢所有的帮助和建议！**

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-17T11:58:48.750

该插件似乎从服务器异步接收其信息并对其进行操作，即更改页面的内容。您是否尝试过监听 DOM 突变事件？

以下是当用户导致网页更改时它们如何工作的示例：

```
<html>
  <!-- This is just mock-up to allow user to modify the DOM -->
  <body>
    Text to add: <input id="in1" type="text"/>
    <button onclick="addNode();">Add node</button>
    <p id="toAdd"></p>
  </body>

  <script type="text/javascript">
    function addNode() {  // adds a text node to the <p> element
      document
        .getElementById("toAdd")
        .appendChild(document
          .createTextNode(document
            .getElementById("in1")
            .value
          )
        );
    }

    ///////////////////////////////////////
    // Here comes the interesting part: !!!
    document
      .getElementById("toAdd")  // listen to modifications of the <p> element
      .addEventListener(
        "DOMSubtreeModified",   // in this case all modifications of its subtree
        function() {
          alert('Modified!');   // change this to whatever fits your purpose
        }
      );
  </script>
</html> 
```

更多关于突变事件[的信息在这里](https://developer.mozilla.org/en/DOM/Mutation_events)。如果你想支持 IE < 9，你需要一种不同的方法。可能会定期检查，例如每 100 毫秒，网页是否包含英文按钮并将其更改为法文。请参阅[setInterval()](https://stackoverflow.com/questions/1224463/is-there-any-way-to-call-a-function-periodically-in-javascipt)。这应该是面向未来的（不推荐使用突变事件），但可能效率更低（缓慢）。

无论如何，这是一个黑客。只有 LinkedIn 可以提供干净的解决方案，例如允许插件的语言代码参数。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-20T01:04:26.290

据我所知，这是您看到的问题：

1.  该按钮最初加载文本“已应用”。
2.  您修改按钮文本以将文本更改为法语。
3.  LinkedIn 修改按钮文本以将其更改为“已应用”。

...而且它是间歇性的，因为有时 3 发生在 2 之前。

我想不出这个问题的“好”解决方案，但我想听听 Igor 的答案是否有效。我*能*想到一个很好的技巧：

异步调用必须以某种方式以按钮为目标，可能是通过其类名*。因此，在将文本更改为法语后，**将类名更改为 else**。这样异步调用将失败，并且您的文本将永远不会被覆盖。

结果是 LinkedIn 将失去对该按钮的所有访问权限，但由于它是一个已经应用的按钮，我认为这并不重要。您也有丢失使用类名选择的 CSS 属性的风险，但是看看野外的 LinkedIn 按钮，我认为这些样式无论如何都是内联的（如果必须，您总是可以自己将它们复制到一个新的类名下。）

祝你好运！

* * *

* LinkedIn 也有可能存储 JavaScript 引用而不是通过类名定位。这将更难追踪，但同样的规则适用：找到 LinkedIn 用来识别该按钮的页面的任何部分，并将其销毁。

# groovy - 如何从 XML 文件中获取 64 位数据到 Groovy 中的字符串

> ID：10537930
> 
> 赞同：1
> 
> 时间：2012-05-10T16:01:33.667
> 
> 标签：groovy, xml-parsing

如何可靠地将 64 位数据从 XML 文件获取到 byte[]，然后将其与字符串进行比较？以下代码失败，因为空格似乎导致断言失败。目标是断言通过。

*请注意，重要的是我们在某些时候以 byte[] 的形式使用它，但不是通过字符串进行比较*

```
<Contents>VGVzdGluZyBURSBzZXNzaW9uIGNvbnRhaW5pbmcgQ29tcGxldGUgUGVyc29uIEEgYW5kIENvbXBs
                ZXRlIEVxdWlwbWVudCBCLg0KDQpUZXN0IFRlc3QNCg0KUmVmZXJlbmNlcyBDb21wbGV0ZSBQbGFj
                ZSBB
            </Contents> 
```

* * *

```
byte[] byteData = document.Contents.text()
assert 'VGVzdGluZyBURSBzZXNzaW9uIGNvbnRhaW5pbmcgQ29tcGxldGUgUGVyc29uIEEgYW5kIENvbXBs'+
                'ZXRlIEVxdWlwbWVudCBCLg0KDQpUZXN0IFRlc3QNCg0KUmVmZXJlbmNlcyBDb21wbGV0ZSBQbGFj'+
                'ZSBB' == new String(byteData) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-11T06:35:19.760

Base 64 数据是文本到 ASCII 的特殊编码，以对 URL 友好（历史上）

编辑感谢下面的评论，实际上 base64 是对数据进行编码以通过电子邮件发送

要从数据中提取文本，请执行以下操作：

```
new String(
'VGVzdGluZyBURSBzZXNzaW9uIGNvbnRhaW5pbmcgQ29tcGxldGUgUGVyc29uIEEgYW5kIENvbXBsZXRlIEVxdWlwbWVudCBCLg0KDQpUZXN0IFRlc3QNCg0KUmVmZXJlbmNlcyBDb21wbGV0ZSBQbGFjZSBB')
.decodeBase64()
) 
```

结果以“包含完整人员 A 和完整设备 B 的会话”开头。

来自[http://mrhaki.blogspot.fr/2009/11/groovy-goodness-base64-encoding.html](http://mrhaki.blogspot.fr/2009/11/groovy-goodness-base64-encoding.html)

# teamcity - 限制对某些 TeamCity 项目的访问

> ID：10537931
> 
> 赞同：10
> 
> 时间：2012-05-10T16:01:33.873
> 
> 标签：teamcity, teamcity-7.0

我们有一个 TeamCity 实例，其中包含各种项目并在其上构建配置，目前没有设置安全性。尽管大多数项目都可以公开可见，但我们希望设置几个仅对某些用户可见的项目。

因为已经在服务器上设置了许多公共项目，跨各种团队，我们希望避免对所有内容设置限制——也就是说，我们宁愿使用“拒绝访问项目 Z”而不是“允许访问”到项目 A，允许访问项目 B，...，允许访问项目 Y”。

如何在不影响公共项目的情况下限制对这些项目的访问？

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2013-07-15T09:21:58.660

如果有人仍然需要答案，这可以由 TeamCity 自己完成。

1.  转到管理 -> 组 -> '创建新组'。例如，公共
2.  为该组分配角色。您可以选择“在选定项目中授予角色”单选按钮并选择这些公共项目并单击分配按钮。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2015-09-08T06:19:25.483

我想创建“测试人员”组并授予他们仅触发“测试构建配置”部署的权限。这就是我所做的。（顺便说一句，这是 TC 9.1 ）

1.  转到“启用每个项目权限” [![在此处输入图像描述](../Images/c143c06effee94a9a620ffa894b8a9f2.png)](https://i.stack.imgur.com/KvJE3.png)

2.  在“角色”下创建了一个角色“项目测试员”，并为该角色分配了“运行构建”权限 [![在此处输入图像描述](../Images/6844a145bb4f90af1aa2dc27778f1a23.png)](https://i.stack.imgur.com/hpaHy.png)

3.  创建了一个组“测试团队”并为其分配了角色“项目测试员”。

[![在此处输入图像描述](../Images/a51101d8d3220b93e1e305d2344171c6.png)](https://i.stack.imgur.com/np51T.png)

显然，将用户添加到组中。希望对某人有所帮助。

# ruby-on-rails - 无法使用 rspec 存根辅助方法

> ID：10537932
> 
> 赞同：27
> 
> 时间：2012-05-10T16:01:37.163
> 
> 标签：ruby-on-rails, ruby-on-rails-3, rspec, rspec2, rspec-rails

我正在尝试在我的控制器中定义的助手上存根方法。例如：

```
class ApplicationController < ActionController::Base
  def current_user
    @current_user ||= authenticated_user_method
  end
  helper_method :current_user
end

module SomeHelper
  def do_something
    current_user.call_a_method
  end
end 
```

在我的 Rspec 中：

```
describe SomeHelper
  it "why cant i stub a helper method?!" do
    helper.stub!(:current_user).and_return(@user)
    helper.respond_to?(:current_user).should be_true # Fails
    helper.do_something # Fails 'no method current_user'
  end
end 
```

在`spec/support/authentication.rb`

```
module RspecAuthentication
  def sign_in(user)
    controller.stub!(:current_user).and_return(user)
    controller.stub!(:authenticate!).and_return(true)

    helper.stub(:current_user).and_return(user) if respond_to?(:helper)
  end
end

RSpec.configure do |config|
  config.include RspecAuthentication, :type => :controller
  config.include RspecAuthentication, :type => :view
  config.include RspecAuthentication, :type => :helper
end 
```

[我在这里](https://stackoverflow.com/questions/7998491/stub-a-controller-helper-method-in-a-helper-spec)问了一个类似的问题，但解决了一个问题。这种奇怪的行为再次蔓延，我想了解*为什么*这不起作用。

*更新*：我发现`controller.stub!(:current_user).and_return(@user)`之前调用`helper.stub!(...)`是导致这种行为的原因。这很容易修复`spec/support/authentication.rb`，但这是 Rspec 中的错误吗？如果它已经在控制器上存根，我不明白为什么它不能在助手上存根方法。

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2013-11-20T05:17:59.913

更新 Matthew Ratzloff 的回答：您不需要实例对象和存根！已弃用

```
it "why can't I stub a helper method?!" do
  helper.stub(:current_user) { user }
  expect(helper.do_something).to eq 'something'
end 
```

编辑。RSpec 3 的方法`stub!`是：

`allow(helper).to receive(:current_user) { user }`

见：[https ://relishapp.com/rspec/rspec-mocks/v/3-2/docs/](https://relishapp.com/rspec/rspec-mocks/v/3-2/docs/)

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2017-06-18T14:35:31.117

在 RSpec 3.5 RSpec 中，似乎`helper`不再可以从`it`块中访问。（它会给你以下信息：

> `helper`不能从示例（例如`it`块）或在示例范围内运行的构造（例如`before`，`let`等）获得。它仅适用于示例组（例如 a`describe`或`context`块）。

（我似乎找不到有关此更改的任何文档，这是通过实验获得的所有知识）。

解决这个问题的关键是知道辅助方法是实例方法，并且对于您自己的辅助方法，这样做很容易：

```
allow_any_instance_of( SomeHelper ).to receive(:current_user).and_return(user) 
```

这最终对我有用

脚注/信用到期信用：

*   [超级支持 Johnny Ji 的一篇博客文章，讲述他们在使用帮助程序/实例方法时遇到的困难](http://johnnyji.me/rspec/2015/06/18/stubbing-controller-instance-methods-in-rspec.html)

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2012-07-13T04:41:23.533

试试这个，它对我有用：

```
describe SomeHelper
  before :each do
    @helper = Object.new.extend SomeHelper
  end

  it "why cant i stub a helper method?!" do
    @helper.stub!(:current_user).and_return(@user)
    # ...
  end
end 
```

第一部分基于RSpec 作者的[这个回复](https://github.com/rspec/rspec-rails/issues/340#issuecomment-909063)，第二部分基于[这个 Stack Overflow 的答案](https://stackoverflow.com/a/1509689/500776)。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2016-09-22T05:19:19.413

规格 3

```
 user = double(image: urlurl)
  allow(helper).to receive(:current_user).and_return(user)
  expect(helper.get_user_header).to eq("/uploads/user/1/logo.png") 
```

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2017-10-06T12:46:50.587

在 RSpec 3 的情况下，这对我有用：

```
let(:user) { create :user }
helper do
  def current_user; end
end
before do
  allow(helper).to receive(:current_user).and_return user
end 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2021-07-23T17:22:03.280

从 RSpec 3.10 开始，此技术将起作用：

```
 before do
    without_partial_double_verification { 
      allow(view).to receive(:current_user).and_return(user)
    }
  end 
```

除非您在全局范围内关闭它，否则`without_partial_double_verification`需要包装器来避免 a 。`MockExpectationError`

# c# - C# 中的 SQL 连接错误 25

> ID：10537934
> 
> 赞同：2
> 
> 时间：2012-05-10T16:01:44.840
> 
> 标签：c#, sql-server, visual-studio-2010

使用以下连接字符串，我不断收到可怕的错误 25：

> 无法连接到 SQL Server，因为连接字符串无效

这是我的连接字符串：

```
connString = @"Data Source=\\10.23.1.3\vadtcdc3;Initial Catalog=VADTC;User Id = test;Password=test"; 
```

我使用的是 VS 2010，MS SQL 2005 标准版，远程访问已开启，命名管道和 TCP/IP 均已启用。我正在使用`System.Data.SqlClient`并且我已经尝试了带有和不带有@符号的连接字符串。在研究了许多帮助网站后，我仍然没有找到答案。

连接字符串在 VB 应用程序中有效，只是在 C# 应用程序中无效。在 VB 应用程序中，我使用 web.config 文件来指定访问服务器的用户名。这是 C# 中的连接所必需的吗？我几乎不知道下一步该做什么......

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-10T16:05:56.630

vadtcdc3 是您的实例的名称吗？

```
connString = "Server=10.23.1.3\vadtcdc3;Initial Catalog=VADTC;User Id = test;Password=test"; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-10T16:09:33.463

尝试这个：

```
connString = "Data Source=10.23.1.3\\vadtcdc3;Initial Catalog=VADTC;User Id = test;Password=test"; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-10T16:03:28.473

去掉 IP 地址前的反斜杠。

有关参考，请参阅[SQL Server 2005 的连接字符串](http://connectionstrings.com/sql-server-2005#p1)。

假设`vadtcdc3`是您的实例名称，您的连接字符串应该是：

```
connString = @"Data Source=10.23.1.3\vadtcdc3;Initial Catalog=VADTC;User Id = test;Password=test"; 
```

如果您的数据库设置为默认实例，只需使用：

```
connString = @"Data Source=10.23.1.3;Initial Catalog=VADTC;User Id = test;Password=test"; 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-10T16:35:57.147

您使用的是什么类型的身份验证？如果您使用 SQL 身份验证，则必须指定凭据在您的字符串中：

```
Integrated Security = false; 
```

所以它看起来像：

```
connString = "Data Source=10.23.1.3\\vadtcdc3;Initial Catalog=VADTC;Integrated Security = false;User Id = test;Password=test"; 
```

# sql - postgres 交叉表参数

> ID：10537940
> 
> 赞同：0
> 
> 时间：2012-05-10T16:02:11.563
> 
> 标签：sql, jsp, postgresql

我有一个使用准备好的语句的交叉表查询（使用 postgres）我正在尝试添加一个参数（中心），但它不起作用这是我的代码：

```
 public List<openbookBean> summarylist(String center) throws SQLException {
        Connection connection = null;
        PreparedStatement statement = null;
        ResultSet resultSet = null;

         String querystring = "select team_manager as team_manager2, "
                        + "compliance_1 as day1, "
                        + "compliance_2 as day2, "
                        + "compliance_3 as day3 "

                        + "FROM crosstab('select team_manager, date_compliance, compliance from openbook_comp where("
                        + "extract(day from date_compliance)= ''1'' or "
                        + "extract(day from date_compliance)= ''2'' or "
                        + "extract(day from date_compliance)= ''3'') "

                        + "and center = '''?''' "

                        + "order by 1,2') AS openbook_comp (team_manager text, "
                        + "compliance_1 varchar,"
                        + "compliance_2 varchar,"
                        + "compliance_3 varchar)";

        List<openbookBean> summarylist_array = new ArrayList<openbookBean>();

        try {

            connection = database.getConnection();
            statement = connection.prepareStatement(querystring);

                statement.setString(1, center);

            resultSet = statement.executeQuery();

            while (resultSet.next()) {
                openbookBean summarylistarray = new openbookBean();
                    summarylistarray.setTeam_manager2(resultSet.getString("team_manager2"));
                    summarylistarray.setDay1(resultSet.getString("day1"));
                    summarylistarray.setDay2(resultSet.getString("day2"));
                    summarylistarray.setDay3(resultSet.getString("day3"));

                summarylist_array.add(summarylistarray);
            }
        } finally {
            try { resultSet.close(); } catch (SQLException logOrIgnore) {}
            try { statement.close(); } catch (SQLException logOrIgnore) {}
            try { connection.close(); } catch (SQLException logOrIgnore) {}
        }

        return summarylist_array;
    }

    } 
```

这是servlet的一部分

```
if (request.getParameter("show").equals("summary")) {
     try {
        List<openbookBean> summarylist_array = openbookDAO.summarylist(region);

        request.setAttribute("summarylist_array", summarylist_array);
        request.getRequestDispatcher("summary.jsp").forward(request, response);
    }

    catch (SQLException e) {
      throw new ServletException("Cannot retrieve areas", e);
    }

    } 
```

我总是收到这个错误：

```
java.lang.NullPointerException
    source.openbookDAO.summarylist(openbookDAO.java:358)
    source.openbookServlet.doGet(openbookServlet.java:74)
    javax.servlet.http.HttpServlet.service(HttpServlet.java:617)
    javax.servlet.http.HttpServlet.service(HttpServlet.java:717) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-10T16:56:55.843

您没有关闭最后一个括号，并且有一个额外的逗号：

```
 + "order by 1,2') AS openbook_comp (team_manager text, "
            + "compliance_1 varchar,"
            + "compliance_2 varchar,"
            + "compliance_3 varchar)" 
```

你可以使用这个：

```
 + "extract(day from date_compliance) in (1, 2, 3) " 
```

如果`center`是数字，请不要使用引号并在参数后添加空格：

```
 + "and center = ? " 
```

如果它不是数字，请像这样尝试：

```
 + "and center = '''?''' " 
```

# generics - 如何编写通用 FactoryModuleBuilder？

> ID：10537941
> 
> 赞同：1
> 
> 时间：2012-05-10T16:02:11.953
> 
> 标签：generics, types, dependency-injection, guice

我想知道如何表示不会失败的以下绑定的通用版本`xxx cannot be used as a key it is not fully specified`

```
install(new FactoryModuleBuilder().
   implement(new TypeLiteral<SomeClass<T,?>>(){}, 
      new TypeLiteral<SomeOtherClass<T, U>>(){}).
   build(SomeFactory.class); 
```

似乎该`implement`方法不适用于参数化类型参数。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-10T18:49:56.503

这是不可能的，因为 Guice 使用类型文字参数的方式。TypeLiterals 需要具体类型，并且从异常中可以看出，它不能接受泛型参数。

引用@jesse-wilson

> 请注意，Guice 不允许绑定不完全限定的类型。例如，您可以绑定 a`Map<String, Integer>`但不能绑定 a `Map<K, V>`。 [https://stackoverflow.com/a/1117878/654187](https://stackoverflow.com/a/1117878/654187)

您可以按照此处所述“完全限定”这些绑定： [https ://stackoverflow.com/a/1120990/654187](https://stackoverflow.com/a/1120990/654187)

但我怀疑这是你想要的。

好消息是你仍然可以在没有辅助注入的情况下轻松编写这个工厂：

```
public class SomeFactory{
    @Inject
    private SomeDependency someDependency;

    public <T> SomeClass<T, ?> buildSomeClass(T t){
        return new SomeOtherClass<T, Object>(t, someDependency);
    }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-10T22:06:09.800

Alen Vrečko[发布](https://groups.google.com/d/msg/google-guice/XJDnJX4uemQ/o58p_qElSG4J)：

> 恕我直言，你可以用泛型做的最好的事情是
> 
> `install(new Assist2<Payment, RealPayment>(PaymentFactory.class){});`或者
> 
> `install(new Assist3<SomeClass<Foo, Bar>, SomeOtherClass<Foo, Bar>, SomeFactory<Foo>(){});`
> 
> 应该很容易实现这种方法。只需查看 TypeLiteral 的来源即可。
> 
> 如果您绝对需要类型参数，例如：
> 
> `install(new CustomAssist<Baz>(){});`在哪里
> 
> `CustomAssist<T> extends Assist<SomeClass<Foo,T>,SomeOtherClass<Foo,Bar>{...`
> 
> 可能是可能的，但实施起来并不容易。但是很有趣。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-10-10T10:26:12.543

从@johncarl 继续

如果您只是注入 someDependency ，那么您将在创建工厂时获得实例。要使其像 FactoryModuleBuilder 构造的工厂一样工作，您需要注入 Injector

```
public class SomeFactory{
    @Inject
    private Injector injector;

    public <T> SomeClass<T, ?> buildSomeClass(T t) {
        return new SomeOtherClass<T, Object>(t, injector.getInstance(SomeDependency));
    }
} 
```

# php - php 有效地设置 HTTPS 请求的读取超时

> ID：10537943
> 
> 赞同：2
> 
> 时间：2012-05-10T16:02:16.487
> 
> 标签：php, soap, curl, https, timeout

有没有办法在 php中有效地设置**https请求的超时时间？**

有一个curl 模拟 SOAP 请求的[解决方案](https://gist.github.com/2654079)，但是它的速度要慢得多。

对慢速服务进行基准测试显示 SOAP 客户端对同一请求平均需要 6.5 秒而不是 5.5 秒。

有一个[流套接字](http://php.net/manual/en/function.stream-socket-client.php)
的替代方案 （由 Zend 框架在 ZendHttpClientAdapterSocket 上实现）但是
stream_set_timeout 函数似乎不适用于 https 连接。

请**注意**，问题是读取超时（获得响应的时间）而不是连接超时（进行握手的时间），它适用于 http 和 soap 请求

找到一个让 curl 更快的解决方案也可以解决这个问题。

**用户故事**
我正在使用 zend soap 客户端对外部 https 肥皂网络服务提出请求。
当网络正常时，该服务通常平均在 5.5 秒内响应。
但是，当出现网络问题时，某些请求最多需要 7 到 8 分钟才能消耗服务器资源。

我可以使用 curl 并强制超时，然后在 web 服务出现网络问题时解决我的问题。
但是，当网络正常时，我的平均响应时间会上升到 6.5 秒。业务需求建议应该丢弃超过 30 秒的请求，以确保系统的稳定性。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-10T16:18:03.570

这取决于您使用的除 cURL 之外的其他内容。

如果您使用流，则可以使用[`stream_set_timeout`](http://php.net/manual/en/function.stream-set-timeout.php)（设置读写超时）。

您可以指定的连接超时，`fsockopen`或者您创建流的方式。

* * *

看看是否可以在 SOAP 客户端中指定读写超时？

# backbone.js - Backbone - 从视图函数更新 URL

> ID：10537947
> 
> 赞同：5
> 
> 时间：2012-05-10T16:02:30.207
> 
> 标签：backbone.js

我在我的第一个主干项目中磕磕绊绊，并试图在单击按钮元素后更新 URL。

我可以通过 window.location.hash 手动设置 URL，但我认为这不是正确的方法。谁能告诉我更新 URL 的首选方式是什么？

```
var AppView = Backbone.View.extend({
   events: {
        "click #loadProject": "filterProject",
    },
    filterProject: function(){
        var projectID = $('#selectProject option:selected').val();
        var orgID = 'test';

        // Is there a better way to do this?
        window.location.hash = '/'+orgID+'/'+projectID;

        this.renderProject(orgID,projectID);
    },
    renderProject:function(orgID,projectID){
     //Some code
    },
});

//Routing
var PropertiesRouter = Backbone.Router.extend({
    routes: {
        "/:who/:project":"getProjects", //#/org/1
        "/:who":"getOrganisation", //#/org
        "*actions": "defaultRoute"          
    },
    getProjects:function(who,project){
        app.renderProject(who,project);
    },
    getOrganisation:function(who){
        app.renderOrganisation(who);
    },
    defaultRoute: function(actions){
        app.renderHomePage();
    },
});

var app = new AppView();
//create router instance
var propertiesRouter = new PropertiesRouter();
//start history service
Backbone.history.start(); 
```

谢谢！

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-05-10T16:41:04.197

你当然可以打电话`window.location.hash`，但这确实打破了一些主干试图为你创造的分离。更好的选择是调用`router.navigate(..)`. 请参阅[http://backbonejs.org/#Router-navigate](http://backbonejs.org/#Router-navigate)

# javascript - 如何在 TableTools 中使用链接而不是 Flash 按钮

> ID：10537949
> 
> 赞同：6
> 
> 时间：2012-05-10T16:02:48.053
> 
> 标签：javascript, jquery, jquery-datatables, tabletools

我正在尝试找到一种方法来更改 TableTools 上的按钮。我想使用我自己的自定义链接而不是 Flash 按钮。有没有办法我可以做到这一点？任何好的资源都可以教我如何进行修改并且仍然能够使用按钮集合等功能。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-25T22:37:41.517

[根据创建者](http://datatables.net/forums/discussion/7583/need-tabletools-export-functionality-to-work-without-flash./p1)的说法，获得 TableTools 导出功能的唯一方法是使用 Flash 按钮。

> 您找到的其他线程应该说目前，不，这不是 TableTools 提供的选项。Flash 选项用于提供跨浏览器/平台的能力以将文件完全保存在客户端 - 该选项在不支持 data:// 协议的旧浏览器（IE6、IE7 等）中根本不可用和本地文件系统交互选项。
> 
> 肯定有可能将此功能添加到 TableTools，但恐怕我还没有机会这样做。虽然它在路线图上。
> 
> 艾伦

如果您对在服务器端创建导出文件感兴趣，您可能需要考虑TableTools[的下载 (GET) 插件](http://datatables.net/extras/tabletools/plug-ins#download)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-05-22T08:18:26.877

是的，可以覆盖现有按钮，例如 PDF/CSV 等，或者创建新的自定义按钮，这些按钮具有指向 URL 的链接以获取或发布数据。在这里，我展示了两种带有 get 方法的方法：

有关获取和发布方法的更多信息：

访问：[Datatable tabletools GET/POST 下载方法覆盖](http://datatables.net/extras/tabletools/plug-ins#download)

**使用代码生成的 pdf 是因为 tabletools 的 pdf 输出在表上重叠，该表具有按某些列数据分组的行。**

第一个覆盖PDF功能和

第二创建自定义按钮。

**1\. 覆盖 PDF 函数以从服务器代码中获取 pdf。**

```
/*Get Method table Tools - PDF - Overriding*/

    TableTools.BUTTONS.pdf = {
        "sAction": "text",
        "sTag": "default",
        "sFieldBoundary": "",
        "sFieldSeperator": "\t",
        "sNewLine": "<br>",
        "sToolTip": "",
        "sButtonClass": "DTTT_button_text",
        "sButtonClassHover": "DTTT_button_text_hover",
        //"sButtonText": "PDF",
        "mColumns": "all",
        "bHeader": true,
        "bFooter": true,
        "sDiv": "",
        "fnMouseover": null,
        "fnMouseout": null,
        "fnClick": function (nButton, oConfig) {
            var oParams = this.s.dt.oApi._fnAjaxParameters(this.s.dt);
            var iframe = document.createElement('iframe');
            iframe.style.height = "0px";
            iframe.style.width = "0px";
            //iframe.src = oConfig.sUrl + "?" + $.param(oParams);
            iframe.src = oConfig.sUrl;//This is the URl you give in datatable Tabletools pdf override below
            document.body.appendChild(iframe);
        },
        "fnSelect": null,
        "fnComplete": null,
        "fnInit": null
    };

    /**/

/*Datatable initialisation*/
$(document).ready(function () {

oTable = $('#alternatecolor').dataTable({
            "bJQueryUI": true,
            "aLengthMenu": [
            [10, 25, 50, 100, -1],
            [10, 25, 50, 100, "All"]
            ],
            "sPaginationType": "full_numbers",
            "aoColumns": [
            null,
            null,
            null,
            null,
            null],
            "bLengthChange": false, "bPaginate": false,
            "sDom": '<"H"Tfr>t<"F"ip>',
            //"sDom": 'T<"clear">lfrtip',
            "oTableTools": {
                "aButtons": [
              "csv", "xls",
              {
               /*PDF Override*/
              "sExtends": "pdf",
              "sButtonText": "PDF",
               //Custom url to fetch pdf report
              "sUrl": " report/PDFReportUsers/us/1"
          }
            ]
            }
        })
        /*Row grouping - optional*/
                .rowGrouping({ bExpandableGrouping: true,
                    bExpandSingleGroup: false,
                    iExpandGroupOffset: -1
                    //asExpandedGroups: [name]
                });

        /**/
    });  
}); 
```

**2.自定义按钮从服务器代码中获取pdf。**

```
 /*Get Method table Tools - Download custom button*/

        TableTools.BUTTONS.download= {
            "sAction": "text",
            "sTag": "default",
            "sFieldBoundary": "",
            "sFieldSeperator": "\t",
            "sNewLine": "<br>",
            "sToolTip": "",
            "sButtonClass": "DTTT_button_text",
            "sButtonClassHover": "DTTT_button_text_hover",
            //"sButtonText": "PDF",
            "mColumns": "all",
            "bHeader": true,
            "bFooter": true,
            "sDiv": "",
            "fnMouseover": null,
            "fnMouseout": null,
            "fnClick": function (nButton, oConfig) {
                var oParams = this.s.dt.oApi._fnAjaxParameters(this.s.dt);
                var iframe = document.createElement('iframe');
                iframe.style.height = "0px";
                iframe.style.width = "0px";
                //iframe.src = oConfig.sUrl + "?" + $.param(oParams);
                iframe.src = oConfig.sUrl;
                document.body.appendChild(iframe);
            },
            "fnSelect": null,
            "fnComplete": null,
            "fnInit": null
        };

        /**/
$(document).ready(function () {

        oTable = $('#alternatecolor').dataTable({
            "bJQueryUI": true,
            "aLengthMenu": [
            [10, 25, 50, 100, -1],
            [10, 25, 50, 100, "All"]
            ],
            "sPaginationType": "full_numbers",
            "aoColumns": [
            null,
            null,
            null,
            null,
            null],
            "bLengthChange": false, "bPaginate": false,
            "sDom": '<"H"Tfr>t<"F"ip>',
            //"sDom": 'T<"clear">lfrtip',
            "oTableTools": {
                "aButtons": [
              "csv", "xls"
                         , {
                              "sExtends": "download",
                              "sButtonText": "Download PDF",
                              "sUrl":     "admin/user/4/downloadfile"
                          }
            ]
            }
        })
        /*Row grouping - optional */
                .rowGrouping({ bExpandableGrouping: true,
                    bExpandSingleGroup: false,
                    iExpandGroupOffset: -1
                    //asExpandedGroups: [name]
                });

        /**/
    }); 
```

# android - 如何检查是否有人对我的 Android 应用写了评论

> ID：10537971
> 
> 赞同：0
> 
> 时间：2012-05-10T16:03:57.830
> 
> 标签：android, google-play, vote

在我的 Android 应用程序中，我希望弹出窗口显示一个链接到我在市场上的应用程序的按钮。弹出窗口正在正确显示，但如果有人已经为我的应用写了评论，我不希望它出现。是否可以检查该人是否已经写了评论或给了星？

对不起，我的英语不好。希望你能理解我的问题。^^

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-10T16:10:53.227

并不真地。您可以让您的应用记住特定用户在进入市场之前按下了您的弹出按钮。但是您无法知道他们是否对您的申请进行了评级或审查。市场没有提供公共 API 来获取第 3 方应用程序的此信息。

# android - 将 TextView 添加到 TableRow

> ID：10537972
> 
> 赞同：0
> 
> 时间：2012-05-10T16:03:58.113
> 
> 标签：android, textview, tablerow

我的程序是这样的

`

```
public class InfoWifiActivity<Intent> extends Activity {
    TableRow tr;
    TextView temp;

     public void onCreate(Bundle savedInstanceState) {
        wifi.startScan();
        tr = new TableRow(this);
        temp = new TextView(this);

        IntentFilter i = new IntentFilter(); 
        i.addAction(WifiManager.SCAN_RESULTS_AVAILABLE_ACTION); 
        registerReceiver(new BroadcastReceiver(){ 

                @Override
                public void onReceive(Context context,
                        android.content.Intent intent) {
                              temp.setText("SSID");
                              temp.setPadding(0,0,3,0);
                              tr.addView(temp);
}
}
}, i );
}
} 
```

`

但是当涉及到 tr.addView(temp);

任何人都可以帮助我吗？在此先感谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-10T16:51:09.060

尝试设置TextView的高度和宽度，然后尝试。

```
tr.addView(temp,intWIDTH,intHEIGHT); 
```

# excel - 如何在excel工作簿的每张表中显示相同的下拉列表

> ID：10537975
> 
> 赞同：0
> 
> 时间：2012-05-10T16:04:11.813
> 
> 标签：excel

我想知道任何可以从任何工作表控制的 Excel 工作簿上显示相同下拉列表的公式。实际上，我在某些单元格中放置了一个 if 公式，但条件单元格通过下拉列表放置在顶部单元格中。所有工作表数据均基于该条件。我的问题是，如果有人想从我的列表中查看其所需的数据，他必须出现在第 1 表上。我想在每张表上显示该下拉列表，以便人们可以从任何表中控制它并获取所需的信息。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-11T20:37:05.647

如果您提到数据验证，则将您的项目列表放在一个单独的选项卡中，并在数据验证中选择“列表”，您可以在其中指向先前定义的项目范围。

# javascript - 如何使用javascript将变量放入字符串中

> ID：10537981
> 
> 赞同：0
> 
> 时间：2012-05-10T16:04:29.097
> 
> 标签：javascript, string, variables

如何在 JavaScript 中将变量放入字符串中？

例子：

```
$('#contactForm').animate({"marginLeft": "+=680px"}, "slow"); 
```

我想在变量中使用而不是`680px`，有没有办法做到这一点？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-10T16:06:34.400

与大多数没有信号的语言一样，您无法执行插值，您必须连接多个字符串。

```
"foo" + "bar" + "baz"
"foo" + string_var + "baz"
"+=" + string_var + "px" 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-10T16:08:04.427

```
var size = "680px";
$('#contactForm').animate({"marginLeft": "+="+size}, "slow"); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-10T16:06:52.073

您可以使用`+`运算符将​​变量中的值连接到`"+="`字符串：

```
$('#contactForm').animate({"marginLeft": "+=" + size}, "slow"); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-10T16:07:21.653

```
var theWidth = "680px"
$('#contactForm').animate({marginLeft: "+=" + theWidth}, "slow"); 
```

# python - 如何让 PLY 忽略正则表达式的大小写？

> ID：10537982
> 
> 赞同：6
> 
> 时间：2012-05-10T16:04:31.140
> 
> 标签：python, regex, ply

我正在研究一个从 SQL INSERT 语句到要与[DbUnit](http://www.dbunit.org)一起使用的数据集 XML 文件的简单转换器。

我当前的定义如下所示：

```
def t_INSERT(token):
    r'INSERT\s+INTO'
    return token 
```

现在，我想支持 SQL 的不区分大小写的命令，例如，接受所有的`INSERT INTO`, `Insert Into`,`insert into`和`iNsErT inTO`作为同一件事。

我想知道是否有一种方法可以使用 PLY`re.I`以便它忽略这种情况，或者还有另一种替代方法来编写我不熟悉的规则。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-05-10T16:35:17.410

`(?)`您可以使用语法将标志注入正则表达式。试试`'(?i)INSERT\s+INTO'`，它添加了忽略大小写的标志。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2017-11-03T16:44:10.270

在内部，`lex.py`使用`re`模块进行模式匹配。
如果您需要为 re.compile() 函数提供可选标志，请使用 lex 的 reflags 选项。例如：

```
lex.lex(reflags=re.UNICODE) 
```

此信息是从[文档](http://www.dabeaz.com/ply/ply.html)第 4.3 和 4.20 节 中提取的。
在您的情况下，您可以将[re.IGNORECASE](https://docs.python.org/3/library/re.html#re.IGNORECASE)传递给词法分析器：

```
import re
lex.lex(reflags=re.IGNORECASE) 
```

如果您以这种方式传递标志，您的代码将更具可读性。

# protocol-buffers - 在预构建事件中使用 protogen 从 .proto 文件生成 c# 文件

> ID：10537984
> 
> 赞同：5
> 
> 时间：2012-05-10T16:04:36.893
> 
> 标签：protocol-buffers, protobuf-net

我们在工作中使用 protobuf 已经有一段时间了，我决定为客户编写一个小控制台应用程序，让他们可以在现场进行一些测试。

我启动了一个新的 c# 控制台应用程序并从 nuget 下载了 google.protocolbuffers 和 protobuf-net。

我想要实现的是将我的“messages.proto”文件变成“messages.cs”

我试图让 protobuf 在预构建事件上构建消息文件，但没有成功，似乎命令参数自我们第一次实现以来已经改变。我按照这里的例子

```
http://code.google.com/p/protobuf-csharp-port/wiki/ProtoGen 
```

并添加了以下预构建事件

```
"$(projectdir)packages\Google.ProtocolBuffers.2.4.1.473\tools\protogen.exe" --proto_path=./protos protos/messages.proto --include_imports -output_directory=./ 
```

但是我收到以下错误

```
Input file protos/messages.proto doesn't exist. 
```

我尝试了各种组合，但似乎没有任何效果。我是在接近这一切都错了还是这里有问题？非常感谢任何帮助！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-04-16T07:08:40.297

您是否尝试过使用绝对路径？我隐约记得自己有一个类似的问题，结果证明它没有正确解析相对路径。

# salesforce - 自动插入主关系字段

> ID：10537986
> 
> 赞同：0
> 
> 时间：2012-05-10T16:04:48.717
> 
> 标签：salesforce, apex-code, visualforce

我有一个带有主关系字段的 VF 页面，我可以在该字段中自动插入值吗

```
<apex:inputField value="{!a.Parent__c}"/> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-10T17:30:46.943

问题有点模糊，但如果你想为 Parent__c 设置一个默认值，你可以在你的控制器类中应用这个值。

例子

```
public class VFController {
private Account controllerAccount;

//Basic Constructor
public VFController() {
    controllerAccount = new Account();
    controllerAccount.Parent__c = getDefaultParentAccount();    
}

//Standard Controller Constructor
public VFController(ApexPages.Controller standardController) {
    controllerAccount = (Account)standardController.getRecord();
    controllerAccount.Parent__c = getDefaultParentAccount();
}

private Id getDefaultParentAccount() {
    Id parentAccountId = null;

    //Lookup default parent Account
    List<Account> parentAccounts = [SELECT Id FROM Account WHERE /*Your Criteria here*/ LIMIT 1];
    if (parentAccounts.isEmpty() == false) {
        parentAccountId = parentAccounts[0].Id;
    }

    return parentAccountId;
} 
```

}

# iphone - 将 iOS 上的默认辅助功能语言设置为西班牙语

> ID：10537987
> 
> 赞同：3
> 
> 时间：2012-05-10T16:04:53.807
> 
> 标签：iphone, ios, ipad, accessibility, voiceover

我正在维护一个为讲英语的用户制作的应用程序。我被要求制作一个西班牙语版本（由于资源大小问题，他们想要单独的应用程序）。他们还希望它可以访问。现在所有标签都在应用程序中设置，但它们的发音带有英语口音！（听起来很可怕:)）无论如何，我发现您可以将accessibilityLanguage 设置为@"es"，这样就可以解决这个问题。那么问题是：

如何将默认的accessibilityLanguage 设置为@"es"？这将覆盖用户的偏好。我知道 Apple 不喜欢这样，但在这种情况下，当所有按钮/标签都是西班牙语时，将其设置为英语确实没有意义。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-14T03:54:38.947

这对我有用，无需`accessibilityLanguage`单独设置每个视图：

```
#import "NSObject+AccessibilityLanguage.h"

@implementation NSObject (AccessibilityLanguage)

- (NSString *)accessibilityLanguage {
    return @"nl";
}

@end 
```

# javascript - “SyntaxError: Unexpected token :” 在控制台中输入 { "a": "", "b": "" } json 时

> ID：10537992
> 
> 赞同：8
> 
> 时间：2012-05-10T16:04:58.223
> 
> 标签：javascript, json, syntax-error, object-literal

在尝试评估以下内容时，我在 chrome 和 firefox 开发人员工具中都遇到了错误：

```
{
    "a": "",
    "b": ""
} 
```

jsonlint.com 告诉我它是有效的。将此代码放入实际的 javascript 文件中并运行它可以正常工作。仅当我在 chrome 开发人员工具或 firebug 的控制台中运行此程序时，才会出现这种奇怪现象。这里发生了什么？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-05-10T16:10:03.870

您不能在控制台中执行 JSON。JavaScript 引擎认为它是一个带有标签的块语句。

所以这：

```
{
    "a": "", "b": ""
} 
```

被解释为块语句。~~该`"a":`部分被解释为一个标签。该`"", "b"` 部分被解释为一个表达式（两个字符串文字和中间的逗号运算符）。现在第二个`:`字符在该位置无效......~~接下来，将`"a"`被解释为字符串文字，并且`:`在该位置无效。

您可以像这样使用 JSON：

1.  你把它放在一个`.json`文件里，
2.  您通过 Ajax 将其作为字符串检索，
3.  您将字符串解析为带有`JSON.parse()`.

（例如，您还可以将 JSON 数据作为字符串保存在变量中或`localStorage`对象中。无论哪种方式，对于 JavaScript，JSON 数据都应始终以字符串值的形式出现。）

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-10-25T17:16:23.340

实际上，对于一次性测试（我主要使用调试控制台），您*可以*输入 JSON 对象语法，但您必须将其分配给一个变量：

```
> var x ={
    "a": "",
    "b": ""
  }
undefined

> x
Object
  a: ""
  b: ""
  __proto__: Object 
```

# google-maps - 从数据文件设置条件图标颜色

> ID：10537994
> 
> 赞同：0
> 
> 时间：2012-05-10T16:05:03.933
> 
> 标签：google-maps, marker, jquery-gmap3

我目前正在 Gmap3 和 GoogleMaps 之上开发一个小应用程序尽管我有一些经验，但我目前还不是 javascript 专家

我的数据集来自一个 JS 文件，我将其解析为一个 data[] 数组，在该数组中可以找到每个标记 lat,lng,title,(infowindow)content,icon 要使用

所有这一切都是一种享受，除了一个，图标颜色

这有效：

> var thiscolor ='绿色'; // 强制所有图标为绿色，不是我想要的，但它可以工作
> 
> ......
> 
> 图标：新 google.maps.MarkerImage( **'img/marker'+thiscolor+'.png'** ,null, null, null, new google.maps.Size(25,25 )) ...

这不会：

> 图标：新 google.maps.MarkerImage( **'+data.icon+'** ,null, null, null, new google.maps.Size(25,25))

我可以验证**data.icon**是否正确解析并显示：**img/markergreen.png** 或**img/markerred.png**

我一直在尝试围绕图标文件路径的各种隐式、显式单引号和双引号以及 + 符号组合......

:-( 现在可用

aaaaaarg 生气了 有人可以帮忙吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-25T06:42:46.903

您必须以以下格式发送标记：-

```
markers:[
    {lat:48.8620722, lng:2.352047, data:'Paris !', options:{icon:"http://maps.google.com/mapfiles/marker_purple.png"}},
    {lat:46.59433,lng:0.342236, data:'Poitiers : great city !'},
    {lat:42.704931, lng:2.894697, data:'Perpignan ! <br> GO USAP !', options:{icon: "http://maps.google.com/mapfiles/marker_green.png"}}
], 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-10T16:39:46.367

您可以使用`setIcon`方法为标记设置图标

```
marker1.setIcon("img/marker'+thiscolor+'.png"); 
```

供参考[http://googlemaps.googlermania.com/google_maps_api_v3/en/change_icon_of_marker.html](http://googlemaps.googlermania.com/google_maps_api_v3/en/change_icon_of_marker.html)

# php - 我可以在每个页面加载时更新我的 jquery 排序吗？

> ID：10537996
> 
> 赞同：-1
> 
> 时间：2012-05-10T16:05:10.063
> 
> 标签：php, jquery, jquery-ui-sortable

我正在使用 jquery sortable 来获得可以通过拖动重新排列的有序项目列表。当用户拖放时，可排序函数运行并更新所有内容，从 0-9 排序。

但是，我可以在列表中插入或删除项目。当发生删除时，排序会有间隙（0-1-2-3-4 - 6-7-8）。添加项目时，对列表项进行计数并添加 1 并设置为排名，将其插入列表底部。因为排序从 0 开始，所以最后也会跳过一个数字。(7,8,10)

但是一旦用户拖放了一个项目，整个列表就会重新排列成正确的顺序，一切都很好。但在那之前，订单是不正常的。

所以我想知道是否有一种方法可以运行 jquery 可排序更新而无需移动项目。它会运行更新，但就像你把所有东西都放在同一个地方一样，但它会解决我的订购问题。我会设置它，以便如果用户只是添加一行或删除一行，该函数将运行并正确设置顺序。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-10T16:14:11.670

我认为每次在可排序列表之外进行更改时，您只需要刷新可排序。

`.sortable( "refresh" )`

[http://docs.jquery.com/UI/Sortable#method-refresh](http://docs.jquery.com/UI/Sortable#method-refresh)

# javascript - 有没有办法检测可观察对象的嵌套结构中的任何元素是否发生了变化？

> ID：10537997
> 
> 赞同：0
> 
> 时间：2012-05-10T16:05:10.153
> 
> 标签：javascript, knockout.js

如果 viewModel.data() 的任何可观察元素发生变化，是否有一个发射器可以触发，或者我是否需要循环并订阅每个独立的可观察对象？

```
data: ko.observable([
      {
        name: "Chart Position",
        fields: ko.observableArray([
          {name: "marginBottom", type: "percOrNumber", value: ko.observable(), valueType: ko.observable()},
          {name: "marginLeft", type: "percOrNumber", value: ko.observable(), valueType: ko.observable()},
          {name: "marginRight", type: "percOrNumber", value: ko.observable(), valueType: ko.observable()},
          {name: "marginTop", type: "percOrNumber", value: ko.observable(), valueType: ko.observable()}
        ])
      }
    ]), 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-10T16:22:31.757

您可以使用计算的 observable 同时“订阅”多个 observable。在计算的 observable 的评估中访问其值的任何 observable 都将成为依赖项。

因此，您可以执行以下操作：

```
ko.computed(function() {
    this.one();  //just accessing the value for a dependency
    this.two();  //doesn't matter if we actually use the value
    this.three();

    //run some code here or if you have a reference to this computed observable, then you can even do a manual subscription against it.
}, vm); 
```

如果你想订阅某个对象图中的所有 observable，那么一个简单的方法就是使用`ko.toJS`. 在您的示例中，您可能想要执行以下操作：

```
ko.computed(function() {
   ko.toJS(vm.data);  //will create dependencies on all observables inside "data"

   //run some code
}, vm.data); 
```

# ruby-on-rails - 我如何区分某些东西是“第一个”还是“创建”的 first_or_create

> ID：10537998
> 
> 赞同：1
> 
> 时间：2012-05-10T16:05:12.280
> 
> 标签：ruby-on-rails, ruby, ruby-on-rails-3, ruby-on-rails-3.1

我正在尝试使用此语句：

```
@vote = Vote.where(:resource_id => params[:id], :user_id => current_user.id).first_or_create(:value => 1) 
```

这是为了赞成或反对。如果数据库中不存在该行，它应该创建它（他们从未对该帖子投票），否则它应该用-1,0,1修改该值。

如果他们第二次单击 upvote，则需要“撤消”投票并将行“值”设置为 0 而不是 1。downvote 也会发生同样的情况，但这只是目前的 upvote 功能。

尽管在 Rails 中调试此语句时遇到问题。我需要基本上区分它是保存的记录还是创建的记录。如果我说：

```
@vote = Vote.where(:resource_id => 25, :user_id => 1)
@vote.exists? 
```

我明白了`true`

但是如果我把这个..（并且记录确实存在，它只是在上面工作）..

```
@vote = Vote.where(:resource_id => 25, :user_id => 1).first_or_create(:value => 1)
@vote.exists? 
```

我得到... NoMethodError：未定义的方法“存在吗？” 为了 ＃

在查看了两个对象的类后，我看到一个是“投票”，一个是“ActiveRecord::Relation”。

我的最终目标是以某种方式重构它（主要是检查投票值是否已经为 1 的部分，如果是，则将其设置为零（撤消投票），否则将其设置为 1

这是我开始尝试使用 first_or_create 重构之前的代码。它又长又丑。

```
 if @vote.exists?
      # Check if they have already voted
      if @vote.first.value == 1
        @vote.first.value = 0
      else
        @vote.first.value = 1
      end
      flash[:notice] = "previous vote modified"
      @vote.first.save
    else
      # Create a new Vote instance, save it
      @vote = Vote.new(:resource_id => params[:id], :user_id => current_user.id, :value => 1)
      if @vote.valid?
        @vote.save
        flash[:notice] = "New vote added"
      else
        @vote.save
        flash[:notice] = (@vote.errors.full_messages).to_s
      end
    end 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-10T16:14:38.547

我会改为使用 Rails 魔术方法`find_or_create_by`方法。

在此处查看“基于动态属性的查找器”：

[http://api.rubyonrails.org/classes/ActiveRecord/Base.html](http://api.rubyonrails.org/classes/ActiveRecord/Base.html)

您可以像使用动态查找方法一样使用它，但如果不存在，则传入要添加的额外变量以创建投票。

在你的情况下，它会是这样的：

```
@vote = Vote.find_or_create_by_resource_id_and_user_id(25, 1, :value => 1) 
```

如果您不希望它立即创建，您可以使用`find_or_initialize_by`which 实际上创建一个`Vote.new`而不保存。

# delphi - 使用 idFTP 上传文件

> ID：10537999
> 
> 赞同：1
> 
> 时间：2012-05-10T16:05:16.973
> 
> 标签：delphi, uploading

我正在尝试使用 idFTP 组件上传文件，并定义了我可以看到的基本属性：

```
 FTPClient.Host  := tblFtpFTPHost.AsString;
  FTPClient.Username := tblFTPUsername.AsString;
  FTPClient.Password := tblFTPPassword.AsString;
  FTPClient.Port     := tblFTPPort.AsInteger; 
```

但是，当我运行命令时 -

```
 FTPClient.Connect; 
```

它将失败并显示以下错误消息：

```
 Project Uploader.exe raised exception class EIdPortRequired with message ''. 
```

我没有向正确的属性提供信息吗？我需要表单上的另一个组件来允许我上传文件吗？

我目前使用 Delphi XE 作为我的 IDE。

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-10T16:29:21.427

看来您的端口值是 0。这是 Indy 抛出此异常的唯一地方：

```
procedure TIdTCPClientCustom.Connect;
begin
  // Do not call Connected here, it will call CheckDisconnect
  if Connected then begin
    EIdAlreadyConnected.Toss(RSAlreadyConnected);
  end;

  if Host = '' then begin
    EIdHostRequired.Toss('');
  end;
  if Port = 0 then begin
    EIdPortRequired.Toss('');
  end;
 ... 
```

请检查端口值是否不为 0。