# StackOverflow 问答 10049000-10049999

# c# - 检索包含 XML 的 HTTP POST 请求

> ID：10049003
> 
> 赞同：3
> 
> 时间：2012-04-06T20:40:43.870
> 
> 标签：c#, xml, http, iis, post

我需要设置一个通过 HTTP POST 侦听 XML 文档的网页。我不需要发帖，我需要收到那个帖子。这是什么对象？我应该使用 HTTP 处理程序、Web 服务、webRequest、Stream 还是其他东西？我需要使用 IIS 服务器并且更喜欢 C#。

**我试过了...**

1.  我不认为我可以使用 WebRequest，因为我没有发送请求，只是在等待他们。

2.  “HttpRequest.InputStream”，但我不知道如何使用它或把它放在哪里。我需要将它与 Web 服务或 asp.net 应用程序一起使用吗？我把它放在 [http://forums.asp.net/t/1371873.aspx/1](http://forums.asp.net/t/1371873.aspx/1)

3.  我尝试了一个简单的网络服务[http://msdn.microsoft.com/en-us/library/bb412178.aspx](http://msdn.microsoft.com/en-us/library/bb412178.aspx) - 但是当我尝试访问“http://localhost:8000/EchoWithGet?s=Hello, world ！”，我得到一个“网页找不到错误”

如果有人有任何有用的代码或链接，那就太好了！

编辑：我正在尝试接收来自另一个程序的通知。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-04-06T20:43:21.570

您可以编写一个将在 IIS 中托管的 ASP.NET 应用程序，您可以在其中拥有一个 .ASPX 页面或一个通用的[.ASHX 处理程序](http://msdn.microsoft.com/en-us/library/bb398986.aspx)（取决于您希望如何格式化结果 - 您想要返回 HTML 还是一些其他类型）然后读取`Request.InputStream`其中将包含来自客户端的请求的正文。

这是一个如何编写通用处理程序 ( `MyHandler.ashx`) 的示例：

```
public class MyHandler : IHttpHandler
{
    public void ProcessRequest(HttpContext context)
    {
        var stream = context.Request.InputStream;
        byte[] buffer = new byte[stream.Length];
        stream.Read(buffer, 0, buffer.Length);
        string xml = Encoding.UTF8.GetString(buffer);

        ... do something with the XML

        // We only set the HTTP status code to 202 indicating to the
        // client that the request has been accepted for processing
        // but we leave an empty response body
        context.Response.StatusCode = 202;
    }

    public bool IsReusable
    {
        get
        {
            return false;
        }
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-06T21:22:43.757

我不确定在哪里调用或使用处理程序。这是我到目前为止所拥有的......

默认.aspx

```
<%@Page Inherits="WebApplication1._Default"%>
<%@OutputCache Duration="10" Location="Server" varybyparam="none"%>
<script language="C#" runat="server">
  void Page_Init(object sender, EventArgs args) {

  }     
}
</script>
<html>
  <body>
  </body>
</html> 
```

默认.aspx.cs

```
namespace WebApplication1  
{
  public partial class _Default : System.Web.UI.Page
  {
    protected void Page_Load(object sender, EventArgs e)
    {
        HttpContext contex = Context;
        MyHandler temp = new MyHandler();
        temp.ProcessRequest(context);
    }
  }

    public class MyHandler : IHttpHandler
    {
       public void ProcessRequest(HttpContext context)
       {
         var stream = context.Request.InputStream;
         byte[] buffer = new byte[stream.Length];
         stream.Read(buffer, 0, buffer.Length);
         string xml = Encoding.UTF8.GetString(buffer);

         ... do something with the XML

        // We only set the HTTP status code to 202 indicating to the
        // client that the request has been accepted for processing
        // but we leave an empty response body
        context.Response.StatusCode = 202;
       }

      public bool IsReusable
      {
        get
        {
          return false;
        }
      }
   }
} 
```

# ruby-on-rails - 如何将参数从控制器传递到 Ruby on Rails 中的模型方法？

> ID：10049010
> 
> 赞同：2
> 
> 时间：2012-04-06T20:41:48.333
> 
> 标签：ruby-on-rails, methods, models, controllers

我包括一个自定义方法来格式化我的 json 数据。

我的控制器如下所示：

```
("def" is taken out for brevity sake)

respond_to do |format|
  format.json { render json: @user, :methods => [:follower_count(params[:id])] }
end 
```

我的模型如下所示：

```
 def follower_count user_id
    User.find(user_id).friendships.count
  end 
```

但是，这会引发语法错误，即意外的 '('。

我不确定如何将参数传递给控制器​​中的 follower_count 方法。我试着用方形包裹——没有用。我试过没有括号 - 仍然不起作用。你如何传递论点？！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-06T20:48:56.730

语法错误告诉您您正在尝试将符号`:follower_count`用作函数。`user_id`但主要问题是，当您已经拥有实例方法时，为什么要传递给实例方法，就像`@id`在类的所有实例方法中一样`User`。

正确的代码如下所示：

```
# controller
format.json { render json: @user, :methods => [:follower_count] }

# User.rb
def follower_count
    friendships.count
end 
```

# php - PHP/MYSQL 数组存储和检索问题

> ID：10049012
> 
> 赞同：2
> 
> 时间：2012-04-06T20:41:56.273
> 
> 标签：php, mysql, arrays

我想在字段中存储短数组。（我意识到有理由将数组分解为项目并单独存储，但我选择了一个简单的存储选项，代价是功能较少。）

我创建数组的代码如下：

```
$str = "one,two,three,four";
$array = explode (",",$str) 
```

然后我使用插入语句存储到 mysql 中的文本字段中它似乎存储得很好。在 PhPAdmin 中，它在字段中显示 ARRAY，如果我只是回显 $array，它会打印“ARRAY”。

当我尝试检索数据时出现问题。

我正在使用

```
while($row = mysql_fetch_array($res)) { 
$array = $row['list']; //that's the field it is stored in 
echo $array; // echoes "ARRAY" 
```

//到目前为止，一切都很好。但是，当我尝试打印出数组的内容时，会收到错误消息。我尝试过使用 implode 以及每个。

```
$text = implode(",", $array);//yields error message improper argument in implode function
foreach($array as $val) {
    echo $val;
} //yields error message improper argument for for each statement

} 
```

我在 dbase 中的条目可能不是正确的数组吗？问题可能是什么？感谢您的任何建议。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-06T20:53:08.577

以这种方式存储数组的常用方法是在输入之前[序列化](http://php.net/manual/en/function.serialize.php)数据，并在检索时[取消序列化。](http://php.net/manual/en/function.unserialize.php)

```
$array = array('one', 'two', 'three', 'four');
$stringToStore = serialize($array); 
```

之后：

```
while($row = mysql_fetch_array($res)) {
  $array = unserialize($row['list']);
  var_dump($array);
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-06T20:50:00.803

您插入的不是数组，而是 PHP 将您的数组评估为字符串形式的内容。要在 MySQL 中存储数组而不正确规范数据，您需要对其进行序列化。基本上你会想做这样的事情：

```
$serialized = implode(',', $arrayToStore); 
```

然后将其存储在 MySQL 中。在它的路上，你会做：

```
$unserialized = explode(',', $arrayFromMySQL); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-06T20:53:03.283

我认为你可以使用[序列化](http://php.net/manual/en/function.serialize.php)，如果你的数组字符串如下（如果你不使用序列化）

```
$str = "one,two,three,four"; 
```

那么为什么在将其插入数据库之前将其设为数组，我认为您可以直接插入字符串，当您需要将字符串用作数组时，您可以简单地从数据库中检索字符串并使用explode使其成为数组像

```
while($row = mysql_fetch_array($res)) { 
$array = explode(",", $row['list']); // "one,two,three,four"
echo $array[0]; // one 
```

# c# - 这是空 try catch 块的情况吗？

> ID：10049017
> 
> 赞同：3
> 
> 时间：2012-04-06T20:42:10.883
> 
> 标签：c#, exception-handling

假设您读入一个大型 XML 文件并且大约 25% 的节点是可选的，所以您真的不在乎它们是否存在，但是，如果它们被提供给您，您仍然会读入它们并做一些事情与他们一起（例如将它们存储在数据库中）。

由于它们是可选的，在这种情况下是否可以将它们包装在空`try . . . catch`块中，所以如果它们不存在，程序只是继续执行？你不关心抛出错误或类似的东西。

请记住，仅仅因为它们是可选的并不意味着您不想检查它们。它只是意味着向您提供 XML 的人或者不希望您知道某些信息，或者他们确实希望您知道并且由您来处理它。

最后，如果这只是几个节点，那没什么大不了的，但是如果您有 100 个可选节点，例如，检查每个节点是否是第一个节点或如果找到`null`a 则停止执行可能会很痛苦`null`，因此我问这是否是空的 try catch 语句的正当理由。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-06T20:46:32.800

如果处理节点 X 是可选的，那么您的代码应类似于：

```
if(node X exists in file)
{
  do work with X
} 
```

并不是：

```
try
{
  do work with X
}
catch{} 
```

现在，如果除了尝试使用节点 X 之外无法确定节点 X 是否存在，或者如果在检查节点 X 是否存在后可以将其删除，那么您将被迫使用 try/catch模型。这不是这里的情况。（与说，在读取文件之前检查文件是否存在相反；有人可以在您检查文件是否存在后将其删除。）

**-------------------------------------------------- ----------**

**编辑：**

由于您的问题似乎是在以下 XML 中单独访问节点“孙子”，其中“父”可能不存在。（请原谅我在 SO 中呈现此 XML 的能力很差；知识渊博的读者可以随意以适当的格式进行编辑。）

```
<root>
  <Parent>
    <Child>
      <GrandChild>
        The data I really want.
      </GrandChild>
    </Child>
  </Parent>
</root> 
```

为此，我会做这样的事情：

```
public static class XMLHelpers
{
public static Node GetChild(this Node parent, string tagName)
{
  if(parent == null) return null;
  return parent.GetNodeByTagName(tagName);
}
} 
```

然后你可以这样做：

```
var grandbaby = rootNode.GetChild("Parent").GetChild("Child").GetChild("GrandChild");
if(grandbaby != null)
{
  //use grandbaby
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-06T20:47:59.243

一般来说，这种情况听起来像是使用空 catch 块的边界可接受的情况（当然假设 catch 的范围是没有节点时抛出的异常的类型）。由于如果节点不存在，您没有任何工作要做，因此代码执行将按计划继续。

我确实质疑`null`在这里检查的痛苦是否太大。检查 null 的代码量/痛苦是 2 行

```
if (parent.IsPresente("child")) {
  var child = parent.GetNode("child");
} 
```

虽然的开销`try / catch`同样冗长

```
try { 
  DoSomething(parent.GetNode("child"));
} catch (TheExceptionType) { } 
```

鉴于这种选择，我会选择这种`if`方法。它同样具有声明性，一般来说更快，整体上更好的风格。异常实际上应该只用于异常情况。事前无法预防的事情。这是一种非常可预防的情况，甚至可以通过扩展方法来支持该模式，使其更可口

```
XmlNode child;
if (parent.TryGetNode("child", out child)) {
  ..
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-06T20:45:29.087

> 由于它们是可选的，在这种情况下是否可以将它们包装在空的 try catch 块中，所以即使它们不存在，程序也会继续执行。

否 - 相反，您应该在执行任何其他操作之前检查特定节点是否存在。由于您*希望*有时会出现这种情况，因此您的程序逻辑应该涵盖这一点，这不是异常处理的用例。

# java - 在 JSP MVC 设计中是否可以在页面加载时自动调用命令？

> ID：10049019
> 
> 赞同：0
> 
> 时间：2012-04-06T20:42:24.353
> 
> 标签：java, jsp

我的应用程序具有以下模式：FrontController、Command、Service 和 DAO。

我遇到的问题是我想在我的主页上显示用户列表（及其头像）。如何让我的 jsp 页面`ListMembersCommand`在没有获取/发布请求的情况下自动调用页面加载？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-06T23:56:51.510

你没有。您所做的是调用控制器并将 if 转发到 JSP。您永远不会直接调用 JSP。

所以，你最终得到的是：

```
request --- invokes ---> Controller --- forwards to ---> JSP 
```

控制器可以在调用 JSP 之前获取任何必要的内容并适当地填充请求以呈现所有内容。

附录 -

这是一个简单的 Servlet，映射到 /MyServlet ：

```
public class MyServlet extends HttpServlet {

    @Override
    protected void doGet(HttpServletRequest request, HttpServletResponse response)
            throws ServletException, IOException {
        MemberDAO dao = DAOFactory.getMemberDAO();
        List<Member> members = dao.getMembers();
        request.setAttribute("members", members);
        RequestDispatcher rd = getServletContext().getRequestDispatcher("/WEB-INF/jsp/members.jsp");
        rd.forward(request, response);
    }
} 
```

这是一个位于 /WEB-INF/jsp/members.jsp 的关联 JSP：

```
<%@page contentType="text/html" pageEncoding="UTF-8"%>
<%@ taglib uri="http://java.sun.com/jsp/jstl/core" prefix="c" %> 
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
    "http://www.w3.org/TR/html4/loose.dtd">

<html>
    <head>
        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
        <title>Members List</title>
    </head>
    <body>
        <h1>Members List</h1>
        <table>
            <tr>
                <td>Member ID</td>
                <td>First Name</td>
                <td>Last Name</td>
            </tr>
            <c:forEach items="${members}" var="member">
                <tr>
                    <td>${member.id}</td>
                    <td>${member.firstName}</td>
                    <td>${member.lastName}</td>
                </tr>
            </c:forEach>
        </table>
    </body>
</html> 
```

在您的浏览器中，您点击：[http://yourhost/yourapp/MyServlet](http://yourhost/yourapp/MyServlet)

servlet 充当控制器，接受请求，对其进行操作（在这种情况下，使用简单的 DAO 模式从数据库中获取所有成员的列表），然后将结果放入带有标签的请求中“成员”（这样`request.setAttribute("members", members)`做）。

一个请求被适当地填充了有趣的信息，servlet 转发到 JSP。

请注意，在这种情况下，JSP 位于 WEB-INF 目录下。浏览器根本无法访问位于 WEB-INF 中的 JSP。因此，对[http://yourhost/yourapp/WEB-INF/jsp/members.jsp](http://yourhost/yourapp/WEB-INF/jsp/members.jsp)的请求将失败。

但它们可以在内部访问。

因此，Servlet 转发到 members.jsp，然后 members.jsp 呈现，`members`从请求中定位值（JSTL c:forEach 标记中的 ${members}），然后 c:forEach 遍历该列表，填充`member`变量，并从那里填写表格中的行。

这是一个经典的“控制器优先”模式，它使 JSP 不受影响。它还有助于保持 JSP 仅存在于 MVC 的视图层中。在这个简单的示例中，Member 和 List 是模型，Controller 中的 Servlet，而 JSP 是视图。

# javascript - jQuery 附加脚本无法完全正常工作

> ID：10049023
> 
> 赞同：0
> 
> 时间：2012-04-06T20:43:04.987
> 
> 标签：javascript, jquery, ajax, append

我正在向文件发出 ajax 请求，作为返回的 html 的一部分，有一些脚本。我将结果附加到文件中的 div 中。问题是我插入的代码有`bind`标签，它们显然不起作用。我尝试用快速控制台消息替换我的绑定函数，我看到它正在插入脚本。如何在附加脚本时让点击事件起作用，这甚至可能吗？非常感谢！

* * *

PS。我知道`.append()`不会将脚本添加到 DOM，并且在浏览代码时无法查看它。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-06T21:19:02.147

所以，我做了一个快速的小提琴...... [http://jsfiddle.net/xqnWF/4/](http://jsfiddle.net/xqnWF/4/)

而且，正如您所看到的，如果您单击“触发器”然后单击“按钮”，它会按预期工作。您能否进一步了解绑定时的事件顺序或 dom 模型？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-06T21:10:48.373

你应该使用 eval(); 附加后的数据上的功能

# seo - 如果我使用 Apache 2，我应该如何使用 HTTP/0.9 处理蜘蛛/网络爬虫？

> ID：10049028
> 
> 赞同：1
> 
> 时间：2012-04-06T20:43:48.827
> 
> 标签：seo, web-crawler, apache2.2

我正在使用 Apache 2 来提供内容，而 Bing Bot 正在使用 HTTP/0.9 从我的服务器请求不提供直接 IP 主机的页面。

如果我不知道他们想要哪个主机，但仍需要他们为我的网站编制索引，我应该如何处理蜘蛛？

我目前返回 400 Bad Request，但让我担心我的网站不会被 Bing 或 Yahoo 编入索引。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-30T14:51:03.337

> [已解决]：我一直在返回 400 Bad Request 并且 Bing/Yahoo 已经接受了提示。

# php - 特定用户今天玩过的没有数据的游戏数

> ID：10049031
> 
> 赞同：1
> 
> 时间：2012-04-06T20:44:14.050
> 
> 标签：php, mysql

我正在尝试获取队列中的召唤师今天玩的游戏数量。我尝试了几个查询。我得到的最接近的是：

```
 SELECT 
        s.summoner,
        s.wins,
        COUNT(*) as playedToday
   FROM summoners s
   LEFT JOIN teams_players tp ON tp.summoner_id = s.summoner
   LEFT JOIN teams t ON t.id = tp.team_id
   LEFT JOIN matches b ON t.id = b.blue_id
   WHERE
        b.played_on = DATE(NOW())
        s.in_queue; 
```

但这并没有给出每个用户的计数。它只是获得总计数。

没有一张表有任何召唤师的数据。我想要的是这样的：

```
 +-----------------+------+-------------+
    | summoner        | wins | gamesPlayed |
    +-----------------+------+-------------+
    | DotAliscious    |  353 |           0 |
    | Kraator         |  440 |           0 |
    | Nammon          |  667 |           0 |
    | VictorousSecret |  843 |           0 |
    | Canas           |  544 |           0 |
    | Sprognak        |  502 |           0 |
    | Ghostilocks     |  808 |           0 |
    | b0b d0e         |  224 |           0 |
    | Metroshica      |  339 |           0 |
    | RubenatorX      |  478 |           0 |
    +-----------------+------+-------------+ 
```

我想不出如何笼统地表达这个问题，这就是为什么我还没有找到解决方案的原因。

* * *

我的数据集。请注意，`teams.id`与`matches.blue_id`和匹配`matches.purple_id`。

```
mysql> DESCRIBE summoners;
+--------------+-------------+------+-----+---------+----------------+
| Field        | Type        | Null | Key | Default | Extra          |
+--------------+-------------+------+-----+---------+----------------+
| id           | int(11)     | NO   | PRI | NULL    | auto_increment |
| icon         | int(11)     | NO   |     | 0       |                |
| summoner     | varchar(32) | NO   | UNI | NULL    |                |
| skype        | varchar(32) | NO   |     | NULL    |                |
| email        | varchar(32) | NO   |     | NULL    |                |
| in_queue     | tinyint(1)  | NO   |     | 0       |                |
| wins         | int(11)     | NO   |     | 0       |                |
| level        | int(11)     | NO   |     | 1       |                |
| lan_wins     | int(11)     | NO   |     | 0       |                |
| played_today | int(11)     | NO   |     | 0       |                |
+--------------+-------------+------+-----+---------+----------------+
10 rows in set (0.00 sec)

mysql> DESCRIBE matches;
+-----------+-------------+------+-----+---------------------+----------------+
| Field     | Type        | Null | Key | Default             | Extra          |
+-----------+-------------+------+-----+---------------------+----------------+
| id        | int(11)     | NO   | PRI | NULL                | auto_increment |
| blue_id   | int(11)     | NO   | MUL | NULL                |                |
| purple_id | int(11)     | NO   | MUL | NULL                |                |
| status    | varchar(32) | NO   |     | display             |                |
| played_on | datetime    | NO   |     | 2012-04-06 13:53:55 |                |
+-----------+-------------+------+-----+---------------------+----------------+
5 rows in set (0.00 sec)

mysql> DESCRIBE teams;
+---------+-------------+------+-----+------------+----------------+
| Field   | Type        | Null | Key | Default    | Extra          |
+---------+-------------+------+-----+------------+----------------+
| id      | int(11)     | NO   | PRI | NULL       | auto_increment |
| outcome | varchar(32) | NO   |     | incomplete |                |
+---------+-------------+------+-----+------------+----------------+
2 rows in set (0.00 sec)

mysql> DESCRIBE teams_players;
+-------------+---------+------+-----+---------+----------------+
| Field       | Type    | Null | Key | Default | Extra          |
+-------------+---------+------+-----+---------+----------------+
| id          | int(11) | NO   | PRI | NULL    | auto_increment |
| team_id     | int(11) | NO   | MUL | NULL    |                |
| summoner_id | int(11) | NO   | MUL | NULL    |                |
+-------------+---------+------+-----+---------+----------------+
3 rows in set (0.00 sec) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-06T20:54:04.643

您`played_on`是`datetime`并且您正在将其与`date`可能是您的问题进行比较。你应该试试：

```
WHERE
    DATE(b.played_on) = DATE(NOW()) 
```

还有你是什么意思`s.in_queue`？你忘了 AND 吗？你的意思是

```
 WHERE
    DATE(b.played_on) = DATE(NOW())
    AND
    s.in_queue; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-06T20:54:47.477

您将要使用子选择来获取满足条件的记录数，如果条件为假，它将返回 0。类似的东西

```
(SELECT COUNT(*) FROM matches b WHERE b.blue_id = t.id AND b.played_on = DATE(NOW())) AS playedToday 
```

并且您将要删除表和检查日期的`LEFT JOIN`子句。`matches``WHERE`

# applescript - 如何使用 AppleScript 在 Skype 中将自己标记为在线？

> ID：10049033
> 
> 赞同：0
> 
> 时间：2012-04-06T20:44:26.077
> 
> 标签：applescript, skype

我只需要一个 AppleScript 就可以自动在 Skype 中将我标记为在线。有什么建议么？谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-06T20:50:02.037

这应该这样做。

```
tell application "Skype" to send command "SET USERSTATUS ONLINE" 
```

我知道你是这个网站的新手，所以我会提供一些友好的建议。通常，当您在这里提出问题时，我们想知道您实际上已经为解决您的问题付出了一些努力。有时这可能包括所谓的[SSCCE](http://sscce.org/)。您可能还想冒险查看[常见问题解答](https://stackoverflow.com/faq)，以获取有关提出好问题的更多提示。

快乐编码！:)

# xcode - 应该创建哪些类型的 XCode 配置文件？

> ID：10049034
> 
> 赞同：1
> 
> 时间：2012-04-06T20:44:26.780
> 
> 标签：xcode, provisioning, provisioning-profile

最近加入 Apple Developer Program 后，我试图了解创建配置文件时的最佳方法。

尚不清楚的基本方面是配置文件中的 AppID 与实际应用程序之间的关系。

例如，我创建了配置文件

```
MyApp1Profile 
```

并成功安装在 XCode 中。

但是，此配置文件适用于我的任何 XCode 项目/应用程序，并允许我在我的设备上运行这些应用程序。

MyApp1Profile 是否应该以某种方式与/ MyApp1 相关联？为什么此配置文件适用于其他应用程序？您是否为同一个应用程序设置了不同的配置文件，例如测试和发布？

如果我要在不同的项目中开发多个应用程序，是否有人链接到创建配置文件的潜在最佳实践？

# plsql - 如何从 oracle 存储函数返回游标或结果集

> ID：10049035
> 
> 赞同：0
> 
> 时间：2012-04-06T20:44:35.330
> 
> 标签：plsql, oracle10g

我有一个存储功能

```
 CREATE OR REPLACE FUNCTION schedule(name in varchar2,pass in varchar2 )
    begin
    select t.name,s.starttime from traininfo t,schedule s, trainslot ts 
    where t.trainid in( select ts.trainid from trainslot 
    where ts.slotid in (select s.slotid from schedule s 
    where s.source='dhaka'
    and s.dest='bogra' ))
    end 
```

我想使用游标返回这个结果集。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-06T22:12:40.093

我看不到您在函数中使用任何一个输入参数的位置。我会假设这是故意或疏忽，因为您正在简化代码。您的查询似乎还缺少外部查询中的 、 和 表`traininfo`之间`schedule`的连接条件。您的嵌套语句正在转身并查询and`trainslot`似乎很奇怪`IN``schedule``trainslot`鉴于缺乏连接条件。我不知道这是否是复制和粘贴错误的结果，还是在发布问题时遗漏了什么，或者这些是否是真正的问题。我将对您打算编写的查询进行猜测，但如果我的猜测是错误的，您必须告诉我们您的查询应该做什么（发布示例数据和预期输出对此非常有帮助） .

```
CREATE OR REPLACE FUNCTION schedule(name in varchar2,pass in varchar2 )
  RETURN sys_refcursor
is
  l_rc sys_refcursor;
begin
  open l_rc
   for select t.name, s.starttime
         from traininfo t,
              schedule  s,
              trainslot ts
        where t.trainid = ts.trainid
          and s.slotid  = ts.slotid
          and s.source  = 'dhaka'
          and s.dest    = 'borga';
  return l_rc;
end; 
```

# c++ - OpenGL 中的倒数计时器

> ID：10049036
> 
> 赞同：-1
> 
> 时间：2012-04-06T20:44:37.193
> 
> 标签：c++, opengl, timer, countdown

我希望在 OpenGL 中创建一个倒数计时器。所以我只是在寻找一个基于系统时钟每秒调用的函数，这将减少一个设置变量。我尝试摆弄 glutTimerfunc 但它只回调一次。我需要一个类似的设置，但需要多次回调。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-06T20:50:28.790

定时器和定时器函数既不是由 C++ 也不是由 OpenGL 定义的，而是由您使用的操作系统定义的。

但是，由于 GLUT 似乎定义了一个，并且您正在使用它，所以我们开始：

在传递给的计时器函数中`glutTimerFunc`，只需`glutTimerFunc`再次使用相同的参数调用。这样，您最终将创建一个无限循环的计时器回调。使用一些全局变量或`int`传递给计时器函数的值来确定何时中断循环。

# ruby-on-rails - Rails - 根据另一个表验证唯一性

> ID：10049047
> 
> 赞同：5
> 
> 时间：2012-04-06T20:46:02.870
> 
> 标签：ruby-on-rails

我有帖子的投票和投票表。我可以验证投票和否决模型中的唯一性，以确保用户不能多次投票或否决。我想验证这两个模型的唯一性，以便用户不能投票反对他们已经投票的帖子，反之亦然。我已经尝试了自定义验证，userfaved，定义如下，但它不起作用。

```
 class Vote < ActiveRecord::Base

 validates_uniqueness_of :user_id,  :scope => :article_id #allows only one vote

 validate :userfaved

 def userfaved
  if Votedown.where( :user_id => :user_id, :artcle_id => :article_id).any?
      errors.add(:user_id, 'already voted on this') 
  end
 end

class Votedown < ActiveRecord::Base

validates_uniqueness_of :user_id, :scope => :article_id #allows only one votedown

validate :userfaved

def userfaved
    if Vote.where(:user_id=> :user_id, :article_id => :article_id).any?
        errors.add(:user_id, 'already voted on this')
    end
end 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-06T22:04:15.627

看起来您的验证中有一个错误：您传递给的哈希值`where`是符号。将其更改为以下内容，它应该可以工作：

```
Votedown.where( :user_id => self.user_id, :article_id => self.article_id).any? 
```

但我认为有一种更简单的方法可以做到这一点。您能否只拥有一个表`Votes`并为其添加一个属性来记录它是向上还是向下？这将使您的唯一性检查非常简单。如果你真的想要单独的类，你可以使用单表继承：有一个`votes`表，一个超类`Vote`和两个子类，`VoteUp`和`VoteDown`.

# php - 是否可以在 HipHop 中使用 PECL 扩展？

> ID：10049049
> 
> 赞同：5
> 
> 时间：2012-04-06T20:46:12.573
> 
> 标签：php, pecl, hiphop

我有一个使用rabbit mq 代理的应用程序，我有用php 编写的消费者并使用这个扩展[http://pecl.php.net/package/amqp](http://pecl.php.net/package/amqp)。我想使用 hiphop 编译这些消费者，但 hiphop 不支持 amqp 扩展。所以问题是我可以将 PECL 扩展编译成 hiphop 吗？

提前致谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-08T02:04:31.127

您必须在 C++ 中手动编写 HipHop 扩展来与扩展的功能交互。很可能原始的 PHP 扩展没有什么用处，如果它只是包装了一个 C 库的话。请参阅此线程上的答案，了解 HipHop 和 PHP 扩展之间的区别：[https ://groups.google.com/group/hiphop-php-dev/browse_thread/thread/51184984d948a77b](https://groups.google.com/group/hiphop-php-dev/browse_thread/thread/51184984d948a77b)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-09-11T14:46:11.740

我启动了 HHVM-AMQP 项目[http://github.com/akalend/hhvm-amqp](http://github.com/akalend/hhvm-amqp) pecl/amqp 的基础是存在的，但存在差异。请参阅示例目录。它是开发者版本。

# fancybox - 如何用fancybox显示图库和文本？

> ID：10049050
> 
> 赞同：0
> 
> 时间：2012-04-06T20:46:28.367
> 
> 标签：fancybox

我想创建一个精美的盒子，左侧是图片库，右侧是一些文字。有可能这样做吗？关于画廊，我指的是fancybox网站上给出的画廊示例。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-06T21:11:00.377

你可以考虑我的fancybox “ *a la* ” facebook 脚本。

你可以看到它[在这里工作](http://picssel.com/playground/jquery/fancyboxALAfacebook_26Mar12.html)。

它需要[fancybox v2.x](http://fancyapps.com)。

# javascript - 清除 setTimeout 问题

> ID：10049052
> 
> 赞同：0
> 
> 时间：2012-04-06T20:46:33.797
> 
> 标签：javascript, jquery, timeout

我试图在按键命令后不到一秒的时间内将“mouseactive”设置为 true，但如果在该时间段内按下按键，我想取消该操作。但是我似乎无法弄清楚如何做到这一点。这就是我所拥有的...

```
$(window).keydown(function(e) {
if (e.keyCode == 40) {
        e.preventDefault();
        mouseactive = false;
        clearTimeout(t);
        var t = setTimeout("mouseActive()",800);
} else if (e.keyCode == 38) {
        e.preventDefault();
        mouseactive = false;
        clearTimeout(t);
        var t = setTimeout("mouseActive()",800);
}
});

function mouseActive() {
mouseactive = true;
} 
```

但这不起作用，它不会将 mouseactive 设置回 true ......谁能告诉我我在这里做错了什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-06T20:47:59.267

**编辑：**清理冗余代码。

**更多编辑：**确保您`var t`在任何闭包之外定义，包括`$(document).ready`. 见下文，

```
var t = null;

$(document).ready(function () {
   //..below code except for var t = null
}); 
```

在处理程序之外声明 var t。

```
var t = null;
$(window).keydown(function(e) {
    e.preventDefault();

   if (e.keyCode == 40) {
        mouseactive = false;
   } else if (e.keyCode == 38) {
        mouseactive = false;
   }

   if (t != null) clearTimeout(t);
   t = setTimeout(mouseActive, 800);
});

function mouseActive() {
   mouseactive = true;
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-06T20:49:12.917

您的问题是`t`该函数第二次运行时不在范围内。您需要创建`t`一个全局变量。

```
var t;

$(window).keydown(function(e) {
if (e.keyCode == 40) {
        e.preventDefault();
        mouseactive = false;
        clearTimeout(t);
        t = setTimeout(mouseActive,800);
} else if (e.keyCode == 38) {
        e.preventDefault();
        mouseactive = false;
        clearTimeout(t);
        t = setTimeout(mouseActive,800);
}
});

function mouseActive() {
mouseactive = true;
} 
```

PS不要将字符串传递给`setTimeout`，传递函数。它`eval`在您传递字符串时使用。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-06T20:49:01.890

你一直在重新声明“t”，试试这个：

```
var t = null;  
$(window).keydown(function(e) {
    if (e.keyCode == 40) {
            e.preventDefault();
            mouseactive = false;
            if(t != null)
            {
               clearTimeout(t);
            }
            t = setTimeout("mouseActive()",800);
    } else if (e.keyCode == 38) {
            e.preventDefault();
            mouseactive = false;
            if(t != null)
            {
               clearTimeout(t);
            }
            t = setTimeout("mouseActive()",800);
    }
    });

    function mouseActive() {
    mouseactive = true;
    } 
```

# python - 为什么 Python 中的以下简短脚本会忽略“if”中的条件？

> ID：10049054
> 
> 赞同：1
> 
> 时间：2012-04-06T20:46:37.253
> 
> 标签：python, if-statement

我希望它在参数超过 10 时给出“甜甜圈数量：很多”，当参数是 count<10 时给出“甜甜圈数量：”。但它总是给我“甜甜圈的数量：很多”

```
#!/usr/bin/python2.6 -tt
import sys
def donuts(count):
  if count < 10:
    x = str(count)
  else:
    x = 'many'
  print 'Number of donuts: ' + x

def main():
  donuts(sys.argv[1])

if __name__ == "__main__":
  main() 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-06T20:50:30.647

`sys.argv`将仅包含字符串，即使您提供整数作为参数，例如，如果您将其称为`python donuts.py 4`，那么`sys.argv[1]`将是并且您将在实际需要时`'4'`尝试比较。`'4' < 10``4 < 10`

因此，首先，尝试转换`sys.argv[1]`为 int：

```
def main():
    donuts(int(sys.argv[1])) 
```

您可能还需要添加一些错误处理，以防未提供参数或它不是整数：

```
def main():
    try:
        donuts(int(sys.argv[1]))
    except IndexError:
        print 'Missing argument'
    except ValueError:
        print 'Invalid argument' 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-04-06T20:50:14.050

`count`是一个字符串。尝试`count = int(count)`

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-04-06T20:48:21.600

您应该在将 count 与 10 进行比较之前将其转换为 int：

```
#!/usr/bin/python2.6 -tt
import sys
def donuts(count):
    if int(count) < 10:
        x = count
    else:
        x = 'many'
    print 'Number of donuts: %s' % x

def main():
    donuts(sys.argv[1])

if __name__ == "__main__":
    main() 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2012-04-06T20:50:20.087

尝试将`count`参数转换为 int 进行比较：

```
if int (count) < 10:
  x = str (count)
else:
  x = 'many' 
```

因为您正在为参数传递一个字符串`count`参数，所以比较失败。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2012-04-06T20:50:37.033

您不会将输入作为整数开始。

改变：

```
def main():
  donuts(sys.argv[1]) 
```

至：

```
def main():
  donuts(int(sys.argv[1])) 
```

但是，如果他们输入字符串或小数而不是数值，您将遇到问题。

# javascript - 用 javascript/dojo 计算 html 元素 (div) 的宽度？

> ID：10049055
> 
> 赞同：0
> 
> 时间：2012-04-06T20:46:48.350
> 
> 标签：javascript, dojo

通常当您在 html 中创建一个 div 时。您可以使用 offsetWidth 或 style.width（如果已声明）检查其宽度。但是，如果更改了 innerHTML 使得 div 的宽度也发生了变化，那么这些函数都不起作用（不确定，但在我的情况下它们没有）。

一些代码：

```
var div = document.createElement("div");
div.innerHtml = "asdfasdfasdfasdfsdfasdfasdfad";
alert(div.style.width); // this is nothing
alert(div.offsetWidth); // this is 0 
```

你如何得到上面div的宽度？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-10-10T13:58:35.170

我意识到这是一个老问题，但对于从谷歌登陆这里的许多人，我会提供它。

这是在 dojo 1.7+ 中执行此操作的方法。使用几何模块，您可以获取和设置内容的宽度（不包括填充或边框）。这忽略了盒子大小。

```
require(['dojo/dom-geometry'], function(domGeom) {
    var myDivNode = dojo.query('div')[0];
    var contentBox = domGeom.getContentBox(myDivNode);
    alert(contentBox.w);

    // This is how to set width/height
    domGeom.setContentSize(myDivNode, {w: 100, h: 100});
}); 
```

来源：[https ://dojotoolkit.org/reference-guide/1.7/dojo/contentBox.html](https://dojotoolkit.org/reference-guide/1.7/dojo/contentBox.html)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-06T20:49:09.820

您无法获取未附加到文档的元素的宽度值。

所以你应该把它附加到页面上，而不是你能得到宽度，

这是一个工作[演示](http://jsfiddle.net/etMWn/2)

# macos - 如何杀死 OS X 中的所有窗口进程

> ID：10049058
> 
> 赞同：1
> 
> 时间：2012-04-06T20:46:55.627
> 
> 标签：macos, bash, process

我想知道是否有一种方法可以杀死所有窗口进程，如从`bash`.

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-02T19:41:11.153

使用 AppleScript 可以很容易地实现这一点，特别是*System Events的**Process Suite ，它似乎与**Activity Monitor*具有相同的窗口应用程序概念：

 **```
tell application "System Events"
    set windowedAppIDs to bundle identifier of every process whose background only is false
    repeat with windowedAppID in windowedAppIDs
        tell application id windowedAppID to quit
    end repeat
end tell 
```

要从 shell 中使用它，请将其包装起来（ AppleScript 每行`osascript -e`一个选项，注意引用和转义。请参阅）。`-e``man osascript`**

# clojure - Clojure：将注释附加到 AOT 编译的方法

> ID：10049060
> 
> 赞同：2
> 
> 时间：2012-04-06T20:47:11.817
> 
> 标签：clojure

我有一个用 Clojure 编写的[BaseX](http://basex.org/) [Java 接口模块。](http://docs.basex.org/wiki/Java_Bindings)该接口提供了许多注释，可用于确定如何调用和优化方法；但是，我无法让这些实际附加到生成的类：

```
(ns net.dyfis.svnkit_wrapper.SvnWrapper
  (:import (org.basex.query QueryModule
                            QueryModule$Requires
                            QueryModule$Permission
                            QueryModule$Deterministic))
  (:gen-class
    :main false
    :extends org.basex.query.QueryModule
    :methods [
      ^{:static true}
      [^{QueryModule$Requires QueryModule$Permission/NONE,
         Deprecated {}}
       cat [java.lang.String] java.lang.String]

      ^{:static true}
      [^{QueryModule$Deterministic {},
         QueryModule$Requires QueryModule$Permission/NONE}
       catRev [java.lang.String int] java.lang.String]])) 
```

但是，只有 Deprecated 注释被附加—— `QueryModule$Requires`and `QueryModule$Deterministic`注释被默默地丢弃：

```
>>> cat
public static java.lang.String net.dyfis.svnkit_wrapper.SvnWrapper.cat(java.lang.String)
>>> cat.getAnnotations()
array(java.lang.annotation.Annotation,[@java.lang.Deprecated()]) 
```

Clojure 1.4.0-beta6 会发生这种情况，而对 AOT 编译方法中的注释的支持应该是从 Clojure 1.2 开始的。因此，这可能是一个使用错误——但我应该做些什么不同的事情呢？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-19T15:32:12.723

除了`java.lang`(like `Deprecated`) 中的类之外，所有类名都必须在`gen-class`声明中完全限定。所以，你的代码应该是：

```
^{org.basex.query.QueryModule$Deterministic {},
  org.basex.query.QueryModule$Requires org.basex.query.QueryModule$Permission/NONE} 
```

请注意，相同的限制不适用于 on/in 、 或 forms 上的注释`deftype`元`defprotocol`数据`defrecord`。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-19T16:24:23.910

将`gen-class`定义移出`ns`声明允许`import`s 应用：

```
(ns net.dyfis.svnkit_wrapper.SvnWrapper
  (:import (org.basex.query QueryModule
                            QueryModule$Requires
                            QueryModule$Permission
                            QueryModule$Deterministic)))

(gen-class
  :name com.indeed.svnkit_wrapper.SvnWrapper
  :main false
  :extends org.basex.query.QueryModule
  :methods [
    ^{:static true}
    [^{QueryModule$Requires QueryModule$Permission/NONE,
       Deprecated {}}
     cat [java.lang.String] java.lang.String]

    ^{:static true}
    [^{QueryModule$Deterministic {},
       QueryModule$Requires QueryModule$Permission/NONE}
     catRev [java.lang.String long] java.lang.String]
  ]) 
```

# ios - AVFoundation：在播放循环之间添加静音暂停

> ID：10049063
> 
> 赞同：3
> 
> 时间：2012-04-06T20:47:26.317
> 
> 标签：ios, xcode, avfoundation, avaudioplayer

我想将录制的声音循环 3 次，但想要在循环之间保持一秒钟的静音，我该怎么做？我的 play_button 代码：

```
-(IBAction) play_button_pressed{

AVAudioPlayer * avPlayer = [[AVAudioPlayer alloc] initWithContentsOfURL:recordedTmpFile error:&error];

[avPlayer setNumberOfLoops: 2];
[avPlayer play];

} 
```

1）我可以在这个方法中添加什么来增加这一秒的沉默吗？

2）如果没有，有没有办法在实际录音中增加一秒钟的沉默？

**编辑：**谢谢；我得到了一个解决方案，它可以在 2 秒的暂停中重复一次声音；它不会无限循环，你能告诉我我错过了什么吗？

```
-(IBAction) play_button_pressed{

AVAudioPlayer * avPlayer = [[AVAudioPlayer alloc] initWithContentsOfURL:recordedTmpFile error:&error];

//[avPlayer setNumberOfLoops: 2];
avPlayer.delegate = self;
[avPlayer prepareToPlay];
[avPlayer play];

}

- (void)audioPlayerDidFinishPlaying:(AVAudioPlayer *)avPlayer successfully:(BOOL)flag
{
NSLog(@"audioPlayerDidFinishPlaying");
tm = [NSTimer scheduledTimerWithTimeInterval:2.0
                                 target:self
                               selector:@selector(waitedtoplay)
                               userInfo:nil 
                                repeats:NO];
}

-(void) waitedtoplay
{
    AVAudioPlayer * avPlayer = [[AVAudioPlayer alloc] initWithContentsOfURL:recordedTmpFile error:&error];
[tm invalidate];
[avPlayer prepareToPlay];
[avPlayer play];
NSLog(@"waitedtoplay");
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-08T03:28:17.453

据我所知，没有任何 AVAudioPlayer 方法在播放循环之间产生“沉默”。

当我制作相同类型的循环时，我使用了 AVAudioPlayerDelegate 和计时器中定义的回调方法。

在头文件中，声明使用 AVAudioPlayerDelegate 如下；

```
@interface xxxxController : UIViewController
<AVAudioPlayerDelegate>{ 
```

当avPlayer结束播放声音时，会调用“audioPlayerDidFinishPlaying”方法。

然后调用方法等待一段时间，例如；

```
-(void) wait{
float seconds = 2.0f;
tm = [NSTimer scheduledTimerWithTimeInterval:seconds
                                      target:self
                                    selector:@selector(waitedtoplay) 
                                    userInfo:nil 
                                     repeats:NO];
} 
```

并且，在方法“waitedtoplay”中，调用 next [avPlayer play]

```
-(void) waitedtoplay{
    [tm invalidate];
    [avPlayer play];
} 
```

这是一个永无止境的循环，因此请添加计数器以限制循环数 = 3。

编辑

在您添加为“waitedtoplay”的方法中，您错过了设置“avplayer.delegate = self”。所以，AVAudioPlayer 不会调用“audioPlayerDidFinishPlaying”。

```
-(void) waitedtoplay
{
AVAudioPlayer * avPlayer = [[AVAudioPlayer alloc] initWithContentsOfURL:recordedTmpFile error:&error];
[tm invalidate];
avPlayer.delegate = self; <<=== MISSING !
[avPlayer prepareToPlay];
[avPlayer play];
NSLog(@"waitedtoplay");
} 
```

请如上添加，它会无限重复...

# security - 如何设置安全性以允许匿名用户添加 ploneboard 3 对话

> ID：10049066
> 
> 赞同：0
> 
> 时间：2012-04-06T20:47:40.397
> 
> 标签：security, plone

如何设置安全性以允许匿名用户添加 ploneboard 3 对话？

我将“Ploneboard：添加对话”设置为匿名用户，但它不起作用。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-08T19:50:00.240

您可以前往论坛并将其工作流程状态从“需要会员才能发布”更改为“免费供所有人”

# apache-flex - 基于滑块的 Flex 设置可见性

> ID：10049067
> 
> 赞同：0
> 
> 时间：2012-04-06T20:47:41.347
> 
> 标签：apache-flex, flex3, visible

我有一个图片库应用程序，它有一个滑块来控制范围从 80 到 1024 的缩略图宽度。当您移动滑块时，缩略图宽度会发生变化，以有效地将图像缩放到 80 像素到 1024 像素之间。缩略图下方是有关图像的一些信息，例如名称、大小、尺寸等。还有一组执行各种任务（删除、编辑、复制等）的图标。所有这些信息都位于一个 VBox 中。

我遇到的问题是当缩略图的宽度达到 150 像素或以下时，我希望隐藏 VBox。我已经能够使用以下代码完成此操作：

```
<mx:VBox visible = "{thumbnail.width &gt; 150}"> 
```

问题是，虽然 VBox 中的信息现在不可见，但它占用的空间并未释放。换句话说，现在有一个与 VBox 完全相同大小的空白区域。我想做的是能够释放这个空间。

我知道这可能是我忽略的一些简单的事情，但是今天我的大脑无法正常工作，因此我们将不胜感激。

顺便说一句：我使用的是 Flex 3.6 SDK。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-06T21:07:25.203

尝试使用[`includeInLayout`](http://help.adobe.com/en_US/FlashPlatform/reference/actionscript/3/mx/core/IUIComponent.html#includeInLayout)：

```
<mx:VBox visible="{thumbnail.width>150}" includeInLayout="{thumbnail.width>150}"> 
```

# javascript - Javascript字符串操作，将数字与字符串组合

> ID：10049070
> 
> 赞同：0
> 
> 时间：2012-04-06T20:47:47.933
> 
> 标签：javascript

我正在尝试从数据集中获取值。我的函数必须从 1 循环到 7 才能获得 7 天的营业时间。我需要做的是：

其中 openHours[i] 中的“i”代表 1 到 7 之间的一个数字。我想将该数字附加在“openHours”这个词上，以便创建一个新词 ex。“开放时间1”

最好的方法是什么？“警报（i）；” 工作正常并生成从 1 到 7 的数字。我只需要将这些数字附加到字符串上。

到目前为止，我尝试了所有可能出现在我脑海中的东西，但我不经常使用 JavaScript，所以我有点卡住了。

谢谢您的帮助。

```
function hoursFunction()
{  
var i =0;
alert("Hello");
for(i=1;i<8;i++)
{
    alert(i);
    alert(hoursForm.openHours[i].value);
}

} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-06T20:55:59.037

编辑：在您发表评论后，您似乎正在尝试获取以下变量：

```
alert(document.getElementById("openHours" + i).value); 
```

但是，我强烈考虑使用 jQuery（或其他库）来处理这个问题，您可以执行以下操作：

```
$("#openHours" + i).val(); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-06T20:55:49.060

您可以使用方括号表示法来访问属性 - 它们与 JavaScript 中的索引相同。

```
alert(hoursForm[openHours + i].value); 
```

# asp.net - 回发后嵌套的ajax UpdatePanels不会清除texbox内容？

> ID：10049072
> 
> 赞同：0
> 
> 时间：2012-04-06T20:47:53.597
> 
> 标签：asp.net, ajax, asp.net-ajax, ajaxcontroltoolkit

我有两个 UpdatePanel，一个 UpdatePanel 包含 Grid，另一个包含数据条目。当用户单击 GridView 中的 ImageButton 时，它将显示给 ModalPopupExtender 并显示第二个 UpdatePanel。当用户将数据输入到第二个 UpdatePanel 下的字段中时，如果他们单击按钮报告或按钮取消，我将在两个按钮上强制回发。问题是，如果用户返回并单击页面上的不同行，则未清除 UpdatePanel2 下的所有数据单击的第一行中的所有数据...我尝试过 UpdatePanel1.Update()，UpdatePanel2.Update( ) 整页 PostBack 没有任何作用。唯一有效的方法是如果我将 Response.Redirect 返回到自身。但我试图避免这样做，并试图避免使用 .cs 代码将字段清除为空。想知道是否有办法回发并清除 UpdatePanel2 下的所有字段。提前感谢您的帮助。

```
<asp:UpdatePanel ID="upGrid" runat="server" UpdateMode="Conditional">
<ContentTemplate>
<div>
    <span id="lblTab" runat="server" style=" font-weight:bold; font-size:larger">All Published Reports</span>
    <br />      
    <asp:GridView 
            ID="gvReports" 
            runat="server" 
            CssClass="gridview" 
            RowStyle-CssClass="gridview_itm" 
            AlternatingRowStyle-CssClass="gridview_aitm" 
            HeaderStyle-CssClass="gridview_hdr" 
            PagerStyle-CssClass="gridview_pgr" 
            AutoGenerateColumns="False" 
            Width="100%" onrowcommand="gvReports_RowCommand">                
            <Columns>
            <asp:TemplateField HeaderText="Name">                    
                <ItemTemplate>                        
                    <asp:LinkButton ID="btnReport" runat="server" CommandName="Report" CommandArgument='<%#Eval("n_ReportFileName")%>' Text='<%#Eval("n_Name")%>' CausesValidation="false"></asp:LinkButton>
                </ItemTemplate>
            </asp:TemplateField>
            <asp:TemplateField HeaderText="Name">                    
                <ItemTemplate>                        
                    <%#Eval("n_Description")%>
                </ItemTemplate>
            </asp:TemplateField>
            </Columns>
    </asp:GridView>                                         
    <asp:UpdatePanel ID="UpdatePanel1" runat="server">
        <ContentTemplate>
            <asp:ModalPopupExtender ID="ModalPopupExtender1" runat="server" TargetControlID="Button1" PopupControlID="ReportParameterPanel" BackgroundCssClass="modalBackground" DropShadow="True">
            </asp:ModalPopupExtender>
            <asp:Button ID="Button1" runat="server" Text="Button" style="visibility:hidden"/>
            <asp:Panel ID="ReportParameterPanel" runat="server" Height="375px" 
                Width="700px" BackColor="#f4de90" 
                HorizontalAlign="Center" BorderColor="#666666" BorderStyle="Outset" 
                BorderWidth="5px"> 
                <table style="height: 50px; width: 685px; text-align: left">
                    <span id="lblReportName" runat="server" style="font-weight:bold; font-size:larger"></span>
                    <tr>
                        <td align="left" style="padding-left: 5px; width: 335px;" valign="top">
                            <span id="StarDateStar" runat="server" style="color: Red">*Optional&nbsp;</span><span id="lblStartDate" runat="server">Start Date: </span>
                            <asp:TextBox ID="tbStartDate" runat="server"></asp:TextBox>
                            <asp:ImageButton ID="imgCalendar" runat="server" ImageUrl="~/App_Themes/Sugar2006/images/Calendar_scheduleHS.png" ImageAlign="Middle" />
                            <asp:CalendarExtender ID="ceStartDate" runat="server" TargetControlID ="tbStartDate" PopupButtonID="imgCalendar" />        
                            <asp:MaskedEditExtender ID="mexStartDate" runat="server" 
                                TargetControlID="tbStartDate" 
                                Mask="99/99/9999" 
                                MaskType="Date"
                                MessageValidatorTip="true"
                                OnFocusCssClass="MaskedEditFocus"
                                OnInvalidCssClass="MaskedEditError" />
                                <br />
                            <asp:MaskedEditValidator ID="mevStartDate" runat="server" 
                                ControlToValidate="tbStartDate"
                                ControlExtender="mexStartDate" 
                                Display="Dynamic" 
                                InvalidValueMessage="This date is invalid!" Font-Bold="True" 
                                ForeColor="#D50000" ValidationGroup="vgMyGroup" />
                        </td>
                        <td align="left" style="padding-right: 5px; padding-bottom: 5px; width: 350px;" valign="top">
                            <span id="EndDateStar" runat="server" style="color: Red">*Optional&nbsp;</span><span id="lblEndDate" runat="server">End Date: </span>
                            <asp:TextBox ID="tbEndDate" runat="server"></asp:TextBox>
                            <asp:ImageButton ID="imgCalendar2" runat="server" ImageUrl="~/App_Themes/Sugar2006/images/Calendar_scheduleHS.png" ImageAlign="Middle" />
                            <asp:CalendarExtender ID="ceEndDate" runat="server" TargetControlID ="tbEndDate" PopupButtonID="imgCalendar2" />        
                            <asp:MaskedEditExtender ID="mexEndDate" runat="server" 
                                TargetControlID="tbEndDate" 
                                Mask="99/99/9999" 
                                MaskType="Date"
                                MessageValidatorTip="true"
                                OnFocusCssClass="MaskedEditFocus"
                                OnInvalidCssClass="MaskedEditError" />
                                <br />
                            <asp:MaskedEditValidator ID="mevEndDate" runat="server" 
                                ControlToValidate="tbEndDate"
                                ControlExtender="mexEndDate" 
                                Display="Dynamic" 
                                InvalidValueMessage="This date is invalid!" Font-Bold="True" 
                                ForeColor="#D50000"
                                ValidationGroup="vgMyGroup" />
                        </td>
                    </tr>
                </table> 

                <table style="height: 25px; width: 685px; text-align: left">
                    <tr>
                        <td align="left" style="padding-left: 5px; width: 335px;" valign="top">
                            <span id="lblOperator" runat="server">Operator:</span>
                            <asp:DropDownList ID="Parameters" runat="server" style="margin-left: 73px">
                                <asp:ListItem Selected="True"><</asp:ListItem>
                                <asp:ListItem>></asp:ListItem>
                                <asp:ListItem>=</asp:ListItem>
                                <asp:ListItem>Completed</asp:ListItem>
                                <asp:ListItem>Not Completed</asp:ListItem>
                            </asp:DropDownList>
                        </td>
                    </tr>
                </table> 

                <asp:RadioButtonList ID="GroupingList" runat="server" Height="25px" 
                        RepeatDirection="Horizontal" 
                        AutoPostBack="true" onselectedindexchanged="GroupingList_SelectedIndexChanged" 
                         CausesValidation="true" ValidationGroup="vgMyGroup" /> 

                <table style="height: 25px; width: 685px; text-align: left">
                    <tr id="rowEntitySelectionLabels" runat="server">
                        <td style="padding-left: 3px; height: 16px; width: 300px;">
                            <asp:Label ID="GroupItemInputLabel" runat="server" />
                        </td>
                        <td style="height: 16px; width: 48px;">
                        </td>
                        <td style="height: 16px; width: 300px;">
                            <asp:Label ID="GroupItemsListInputLabel" runat="server" />
                        </td>
                    </tr>
                    <tr id="rowEntitySelections" runat="server">
                        <td valign="top" style="padding-left: 3px; height: 100px; width: 300px;">
                            <asp:ListBox ID="GroupItemInput" runat="server" Width="300px" Height="150px" 
                                SelectionMode="multiple" BackColor="White" ForeColor="Black" />
                        </td>
                        <td align="center" valign="top" style="height: 100px; width: 50px;">
                        <br />
                            <asp:ImageButton ID="btnAddItem" 
                                ImageUrl="~/App_Themes/Sugar2006/images/Actions-arrow-right-icon.png" runat="server" 
                                OnClick="btnAddItem_Click" Height="18px" Width="25px" 
                                ToolTip="Adds the Selected <Item>." CausesValidation="true" ValidationGroup="vgMyGroup" /><br />
                            <asp:ImageButton ID="btnAddAllItems"                                     
                                ImageUrl="~/App_Themes/Sugar2006/images/Actions-arrow-right-double-icon.png" runat="server" 
                                OnClick="btnAddAllItems_Click" Height="18px" Width="25px" 
                                ToolTip="Adds all of the <Items>." CausesValidation="true" ValidationGroup="vgMyGroup" /><br />
                            <br /><br />
                            <asp:ImageButton ID="btnRemoveItem" 
                                ImageUrl="~/App_Themes/Sugar2006/images/Actions-arrow-left-icon.png" runat="server" 
                                OnClick="btnRemoveItem_Click" Height="18px" Width="25px" 
                                ToolTip="Removes the Selected <Item>." CausesValidation="true" ValidationGroup="vgMyGroup" /><br />
                            <asp:ImageButton ID="btnRemoveAllItems"                                     
                                ImageUrl="~/App_Themes/Sugar2006/images/Actions-arrow-left-double-icon.png" runat="server" 
                                OnClick="btnRemoveAllItems_Click" Height="18px" Width="25px" 
                                ToolTip="Removes all of the <Items>." CausesValidation="true" ValidationGroup="vgMyGroup" />
                        </td>
                        <td valign="top" style="height: 100px; width: 300px;" id="TD1">
                            <asp:ListBox ID="GroupItemsList" runat="server" Width="300px" Height="150px" 
                                SelectionMode="multiple" BackColor="White" ForeColor="Black" />
                        </td>
                    </tr>
                </table>
                <asp:Button ID="btnClose" runat="server" Text="Close" CssClass="btn" onclick="btnClose_Click" CausesValidation="false" />
                <asp:Button ID="btnSend" runat="server" Text="Report" CssClass="btn" OnClick="btnSend_Click" Enabled="false" CausesValidation="true" ValidationGroup="vgMyGroup" />                    
            </asp:Panel>                                    
        </ContentTemplate>
        <Triggers>
            <asp:PostBackTrigger ControlID="btnSend" />
            <asp:PostBackTrigger ControlID="btnClose" />
        </Triggers>
    </asp:UpdatePanel>
</div>
</ContentTemplate>
</asp:UpdatePanel> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-06T21:49:15.997

尝试将 UpdatePanel.UpdateMode 属性设置为 Conditional

```
<asp:UpdatePanel ID="UpdatePanel1" UpdateMode="Conditional" runat="server">
    <!-- other stuff -->
</asp:UpdatePanel> 
```

如果更新模式未设置为条件，则子更新面板将仅刷新其子项，而不是其父项。

这里还有一些更新更新面板的方法：http: [//lisazhou.wordpress.com/2008/01/07/update-panel-different-ways-of-triggering-udates/](http://lisazhou.wordpress.com/2008/01/07/update-panel-different-ways-of-triggering-udates/)

# jquery - 动画 div 从一个地方移动到另一个地方

> ID：10049073
> 
> 赞同：2
> 
> 时间：2012-04-06T20:47:53.830
> 
> 标签：jquery, html, jquery-animate

我正在设计一个 potal 框架，我在主 div 中有多个 portlet(div)。当我移动一个 div 时，我希望它移动到页面顶部并垂直扩展。 **所有这些都有效，但是，我想为移动部分设置动画。**

这就是我的代码的样子

```
$('#smallpotletdiv').prependTo($('#maindiv')); 
```

对动画有更多了解的人会提出什么建议？我将如何显示 div 从其当前位置移动并将其自身附加到新位置？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-07T00:01:03.320

最后使用动画和前置播放位置。前置完成后，将值更改为默认值

```
$("#smallpotletdiv").animate({
      top: 300,
      left: 500     
}).prependTo($("#maindiv")).css({
      top: 'auto',
      left: 'auto'
}); 
```

### 更新：

你的工作代码看起来像这样

```
current.animate({
  top: -30,
  left: -20     
}, 2000, function() {
    current.prependTo(prependToDiv).css({
       top: 'auto',
       left: 'auto'
    });        
}); 
```

### [在这里检查](http://jsfiddle.net/4Bgx7/372/)

他们执行的问题是，您没有将元素定位为可在左侧和顶部移动。为此，必须绝对定位元素，即`position: absolute`。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-06T20:52:20.070

我认为你可以使用：

```
 $('#smallpotletdiv').animate 
```

您可以使用它的参数：例如

```
width: ['toggle', 'swing'],
    height: ['toggle', 'swing'],
    opacity: 'toggle' 
```

[jQuery 动画](http://api.jquery.com/animate/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-07-10T06:43:08.770

实现这一点的一个很酷的工具是一个名为 react-magic-move 的 ReactJS 工具 [https://www.npmjs.com/package/react-magic-move](https://www.npmjs.com/package/react-magic-move)

这有可能操纵 DOM 以平滑地更改元素的位置。然而，它并不容易实现，因为它不受支持并且使用过时的 ReactJS 版本。

在此处查看演示： [https ://www.youtube.com/watch?v=z5e7kWSHWTg#t=424](https://www.youtube.com/watch?v=z5e7kWSHWTg#t=424)

# iphone - 从 UIPickerView 的选定行设置 UIButton 的标题

> ID：10049096
> 
> 赞同：0
> 
> 时间：2012-04-06T20:49:43.047
> 
> 标签：iphone, ios, nsstring, uibutton, uipickerview

详细的场景是这样的：

我正在使用循环创建 10 个按钮并将标签设置为 0-9。在点击每个按钮时，我正在调用一个 UIPickerView，我在其中从不同的数组加载数据。直到这里我得到了预期的结果。但我希望从 pickerView 中选择的行应该设置为相应按钮的标题。

我尝试过的方式 - 我将所选行存储在 pickerViewDelegate 方法中的 NSString 中，并尝试像 setTitle 一样：

```
[myButton setTitle:selectedString forState:UIControlStateNormal] 
```

但它没有反映在任何按钮中。

知道我错过了什么吗？

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-07T10:18:54.880

**你的 UIButton 点击​​动作，**

```
- (IBAction) buttonTaped:(UITapGestureRecognizer *)sender 
{
    myButton=(UIButton *) sender.view; //It will make reference to tapped button,
    //Once you've this, in your picker delegate, you can set title for it
    //myButton should be declare in your controller's header file.
} 
```

**或者**

```
- (IBAction) buttonTaped:(UIButton *)sender 
{
    myButton=(UIButton *) sender;
} 
```

**你的 UIPickerView 委托**

```
- (void)pickerView:(UIPickerView *)pickerView didSelectRow:(NSInteger)row inComponent:(NSInteger)component 
{
    [myButton setTitle:[yourArray objectAtIndex:row] forState:UIControlStateNormal];
} 
```

**希望这会帮助你！**

# git - 移动目录后 git“错误：损坏的松散对象”

> ID：10049101
> 
> 赞同：1
> 
> 时间：2012-04-06T20:50:10.087
> 
> 标签：git, corruption, data-recovery

我不确定我是否有此错误，因为我移动了包含所有项目文件和 .git 的目录，但该错误出现在那个时候。

```
> git fsck 
error: corrupt loose object '25a196217ebb6e341909205575f491022eafc4d9'
fatal: loose object 25a196217ebb6e341909205575f491022eafc4d9 (stored in .git/objects/25/a196217ebb6e341909205575f491022eafc4d9) is corrupt 
```

我搜索了一个答案并尝试了一些没有任何效果的东西。

[如何恢复因硬盘故障损坏的 Git 对象？](https://stackoverflow.com/questions/801577/how-to-recover-git-objects-damaged-by-hard-disk-failure) 导致

```
mv: cannot stat `.git/objects/pack/*': No such file or directory
fixgit.sh: line 3: tmpgit/*.pack: No such file or directory
rm: cannot remove `tmpgit/*': No such file or directory 
```

`.git/objects/pack/`是空的。我很困惑为什么它是空的。

`--full`选项没有帮助。

我的下一个选择是恢复并重新开始。下一次，我会继续备份，并在备份前检查 git。

**附加信息：** 这是我查看对象内容时得到的

```
> git cat-file -p 25a196217ebb6e341909205575f491022eafc4d9
error: corrupt loose object '25a196217ebb6e341909205575f491022eafc4d9'
fatal: loose object 25a196217ebb6e341909205575f491022eafc4d9 (stored in .git/objects/25/a196217ebb6e341909205575f491022eafc4d9) is corrupt 
```

并输入：

```
> git cat-file -t 25a196217ebb6e341909205575f491022eafc4d9
blob 
```

# asp.net-mvc - HTML5 Mobile Safari DatePicker - Initial Value

> ID：10049122
> 
> 赞同：2
> 
> 时间：2012-04-06T20:52:19.350
> 
> 标签：asp.net-mvc, html, mobile, datepicker, mobile-safari

We're working on a .NET MVC mobile site. I understand that on the iPhone, mobile safari will display a datepicker for the following input field:

```
<input type="date"/> 
```

We have a standard date picker helper which spits out date picker options for various platforms. In this case we detect mobile safari and then write out an input field that is bound to our model:

```
<input name="StartDate" value="2008/12/21" type="date"/> 
```

The problem is that the value portion is not shown on load. We can enter in new values, and save them back to our database. But then when we reload the page those values don't show up in the fields. If we save again, our values are all set back to null in the db.

I noticed that when you select a date with the wheels on the iPhone, the value of the text field ends up in the format similar to "Apr 6, 2012" where as I'd expect it to show 2012/04/06 or 04/06/2012\.

My guess is that the mobile safari displays a different attribute of the field, and then sets the value attribute appropriately behind the scenes.

Does anyone know what's going on with this? Thanks!

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-06T23:44:42.943

AFAIK the date must be [RFC3339](https://www.rfc-editor.org/rfc/rfc3339) compliant. Have you tried `2008-12-21` (dashed instead of slashes)?

```
<input type="date" value"yyyy-MM-dd" /> 
```

# maven - Eclipse 中的第谷是什么，我必须学会爱上它吗？

> ID：10049123
> 
> 赞同：-2
> 
> 时间：2012-04-06T20:52:19.850
> 
> 标签：maven, pdfbox, tycho

我一直在尝试使用安装 Apache 项目（PDFBox）

```
mvn install 
```

然后这导致一些插件（Tycho）显然自动安装在我的 Eclipse 中，之后我的 Eclipse 停止工作，我不得不删除所有内容并重新安装 Eclipse。

我已经完成了适量的 Maven 工作，但从未见过 Tycho 并且还没有学会喜欢它。我看不到如何在没有 Tycho 的情况下安装 PDFBox，但我不相信我不理解的东西。是必不可少的吗？如果是这样，我如何在不破坏所有其他 Eclipse 项目的情况下安装它？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-25T09:55:22.807

我认为@Bae 是最接近答案的

# grails - Grails：从域类中的自定义验证器中消除 ConfigurationHolder

> ID：10049125
> 
> 赞同：0
> 
> 时间：2012-04-06T20:52:20.287
> 
> 标签：grails, dns, validation

我在引用配置属性的域类中有一个自定义验证器：

```
accountExpirationDate (
    nullable:true,
    validator: { val, obj ->
        if (val > new Date() + CH.config.EXPIRATION_WINDOW_DAYS) return ['date_too_late']
    }) 
```

其中 CH 是 org.codehaus.groovy.grails.commons.ConfigurationHolder

由于 ConfigurationHolder 已被弃用，我需要摆脱它。我曾尝试使用 grailsApplication 代替它，但在这种情况下它不起作用。还有其他方法吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-06T21:00:49.813

添加一个依赖注入`grailsApplication`，然后你可以从`obj`实例中访问它

```
class MyDomainClass {

   def grailsApplication

   Date accountExpirationDate

   static constraints = {
      accountExpirationDate(nullable:true, validator: { val, obj ->
         def config = obj.grailsApplication.config
         if (val > new Date() + config.EXPIRATION_WINDOW_DAYS) return ['date_too_late']
      })
   }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-06T21:04:21.660

域中有一个新的 getDomainClass 方法。您可以尝试使用它来访问 grailsApplication。

```
validator: { val, obj ->
    if (val > new Date() + this.getDomainClass().grailsApplication.config.EXPIRATION_WINDOW_DAYS) return ['date_too_late']
}) 
```

以下是有关该主题的更好报道： [http ://burtbeckwith.com/blog/?p=993](http://burtbeckwith.com/blog/?p=993)

# c# - PropertyInfo.GetValue(obj, null) 截断字符串

> ID：10049127
> 
> 赞同：0
> 
> 时间：2012-04-06T20:52:34.163
> 
> 标签：c#, string, reflection

这个通用的辅助函数遍历对象列表，访问它们的公共属性，并为每个对象输出一个逗号分隔的字符串。

```
 /// <summary>
    /// Format the properties as a list of comma delimited values, one object row per. 
    /// </summary>
    /// <typeparam name="T">Type of class contained in the List</typeparam>
    /// <param name="list">A list of objects</param>
    /// <returns>a list of strings in csv format</returns>
    public static List<string> ToCSV<T>(this IEnumerable<T> list)
        where T : class
    {
        var results = new List<string>();
        bool firstTime = true;
        foreach (var obj in list)
        {
            // header data
            if (firstTime)
            {
                firstTime = false;
                string line = String.Empty;
                foreach (PropertyInfo propertyInfo in obj.GetType().GetProperties())
                {
                    if (propertyInfo.CanRead)
                    {
                        line += propertyInfo.Name + ',';
                    }
                }
                results.Add(line);
            }
            else
            {
                string line = String.Empty;
                foreach (PropertyInfo propertyInfo in obj.GetType().GetProperties())
                {
                    if (propertyInfo.CanRead)
                    {
                        object value = propertyInfo.GetValue(obj, null);
                        if (value.GetType() == typeof(string))
                        {
                            line += "\"" + value.ToString() + "\"" + ",";
                        }
                        else
                        {
                            line += value.ToString() + ",";
                        }
                    }
                }
                results.Add(line);
            }
        }
        return results;
    } 
```

被此方法迭代的类之一有一个字符串属性，该属性被截断：

```
string BusinessItem { get; set; } // "0000", a legitimate business value 
```

有问题的位在这里：

```
object value = propertyInfo.GetValue(obj, null); // value == 0 
```

如何将属性的值作为字符串而不是 int 获取？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-06T21:10:28.017

考虑这个检查：

```
if (value.GetType() == typeof(string) && (value as string).Contains(',')) 
```

*这意味着只有*包含逗号的字符串值才会写在引号内。

字符串值`"0000"`将写入`0000,`该行。如果读取文件的代码检查一个值是否全是数字以确定它是否是一个数字，那么它将被解析为一个数字，而不是作为字符串读取。在这种情况下，您应该编写*所有*带引号的字符串，而不仅仅是包含逗号的字符串。

# sas - SAS：根据组分配序列号

> ID：10049136
> 
> 赞同：-2
> 
> 时间：2012-04-06T20:53:37.500
> 
> 标签：sas

我知道关于序列号有类似的问题，但我的情况有点不同。我需要根据组变量分配序列号。现在，我的数据按组变量排序。以下数据只是整个数据集的一部分。基本上，我想创建按组分配唯一序列号的“serial_num”变量，如下所示。

例如，当 group = 1 时，每个都有自己唯一的序列号。当 group = 2 时，有两个相同的序列号。我希望你们通过观察下面的数据得到模式。

提前致谢。

```
serial_num  group
----------------
1           1
2           1
.           .
.           .
.           .
7           2
7           2
8           2
8           2
.           .
.           .
.           .    
10          3
10          3
10          3
11          3
11          3
11          3
.           .
.           .
.           . 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-10T12:22:04.547

一个奇怪的要求，但这是一个使用普通旧数据步骤的解决方案。

```
data output;
   set input;
   by group;
   if first.group or c = group then do;
      c = 0;
      serial_num + 1;
   end;
   c + 1;

   drop c;
run; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-06T22:09:27.050

使用 IML 的粗略解决方案。主要是和你确认它是否符合你想要的模式，如果有必要，我可以扩展它以启用数据集输入或进行改进。

注：y 为生成的序列号向量。

```
proc iml;
x={1,1,2,2,2,2,3,3,3,3,3,3,4,4,4,4,4,4,4,4};
y=j(nrow(x),1,.);

y[1,1]=1;
j=1;
 do i=2 to nrow(y);
   if y[i-x[i,1],1]=j then do;
       j=j+1;
       y[i,1]=j;
    end;
  else if x[i,1]^=x[i-1,1] then y[i,1]=y[i-1,1]+1; 
    else y[i,1]=y[i-1,1];
end;
print y;
quit; 
```

# raphael - Raphael.js - 如何以编程方式生成元素名称？

> ID：10049137
> 
> 赞同：-1
> 
> 时间：2012-04-06T20:53:44.630
> 
> 标签：raphael, element

我有一些通过 php 硬编码到页面中的 Raphael 矩形元素，它会根据调用页面时需要的数量动态生成它们。

我要做的是编写一个 javascript 函数，该函数将采用 id 号并更改相关 Raphael 函数的背景颜色。

我知道下面的例子不起作用，但这是我想要实现的。

```
var rectangle_1 = paper.rect(100, 10, 200, 75);
var rectangle_2 = paper.rect(400, 10, 200, 75);
var rectangle_3 = paper.rect(700, 10, 200, 75);

change_color('1');

function change_color(id) {
  variable_name = 'rectangle_' + id;
  variable_name.attr({fill: 'blue', stroke: 'black', 'stroke-width': 3});
} 
```

显然这不起作用，任何关于如何动态生成元素名称的帮助和建议将不胜感激，

问候，

斯特

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-06T20:57:33.640

只需使用数组或对象来存储矩形而不是命名变量。

```
var rectangles = [];
rectangles[0] = paper.rect(100, 10, 200, 75);
rectangles[1] = paper.rect(400, 10, 200, 75);
rectangles[2] = paper.rect(700, 10, 200, 75);

change_color(1);

function change_color(id) {
  rectangles[id].attr({fill: 'blue', stroke: 'black', 'stroke-width': 3});
} 
```

如果您需要字符串 ID，可以将其作为对象进行：

```
var rectangles = {};
rectangles['one'] = ... 
```

# object - 为什么 ListBox 在将对象添加到列表后立即返回 nil 或没有 Object？

> ID：10049140
> 
> 赞同：-2
> 
> 时间：2012-04-06T20:54:22.273
> 
> 标签：object, listbox, nullreferenceexception, delphi-prism

这是system.object：

```
 TTrendGroup = class(System.Object)
    SigList:ArrayList;
    Rate,Phase,Delay:SmallInt;
    RateIndex,PhaseIndex:SmallInt;
    firstTime:Boolean;
    base:integer;
    Enabled:Boolean;
    name:string;
    public
    constructor;
    method AddTGroup(signal:TTrendSignal);
    method Clear;
    method Poll(list:ArrayList);
    method ReadTGroup(bTGr:BinaryReader);
    method WriteTGroup(bTGw:BinaryWriter);
    method WriteSignals(bWSw:BinaryWriter);
    method ToString:String;override;
  end;

constructor TTrendGroup;
begin
  SigList := new ArrayList;
  Rate := 30;
  Phase := 0;
  Delay := Phase;
  RateIndex := 4;
  PhaseIndex := 0;
  firsttime := true;
  enabled := true;
  name := '';
end; 
```

下面是我如何从上面的 system.object 创建一个对象并将其添加到我的 GroupList ListBox：

```
method HTrendFrm.AddGroup1_Click(sender: System.Object; e: System.EventArgs);
var
  i:integer;
  grp:TTrendGroup;
begin
  if ReadWrite then
  begin
    grp := new TTrendGroup;
    grp.name:='New Group';
    i := GroupList.Items.Add(grp);
    GroupList.SelectedIndex := i;
    grpName.Text := 'New Group';
    PollBtn.Checked := grp.Enabled;
    RateBox.SelectedIndex := grp.RateIndex;
    PhaseBox.SelectedIndex:= grp.PhaseIndex;
    SignalListBox.Items.Clear;
    UpdateButtons;
  end;
end; 
```

这是我尝试检索刚刚添加回来的 system.object 的方法：

```
method HTrendFrm.GroupList_Click(sender: System.Object; e: System.EventArgs);
 var
  grp:TTrendGroup;
begin
  if (GroupList.SelectedIndex = -1) then exit;
  with GroupList do
  begin
    grp := TTrendGroup(items[SelectedIndex]); <<<<< HERE is WHERE THE PROBLEM IS. grp always returns NIL.
  end;
end; 
```

我不知道为什么。我在这个程序的其他部分有非常相似的代码，它们按预期工作。

我究竟做错了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-06T21:04:24.150

当返回的对象是`nil`时，您是否验证该`SelectedIndex`值实际上是有效的？您的代码中有一个逻辑错误，允许`SelectedIndex`在`-1`ListBox 不为空时出现。您的`if`语句需要使用`or`运算符而不是`and`运算符：

```
// if (GroupList.Items.Count<=0) and (GroupList.SelectedIndex = -1) then exit;
if (GroupList.Items.Count<=0) or (GroupList.SelectedIndex = -1) then exit; 
```

# sql - 使用 sqlplus 打印错误

> ID：10049144
> 
> 赞同：1
> 
> 时间：2012-04-06T20:54:49.507
> 
> 标签：sql, oracle, sqlplus

下面你可以看到我试图在 sqlplus 上执行的 SQL 脚本模板：

```
WHENEVER SQLERROR EXIT 1 ROLLBACK
WHENEVER OSERROR EXIT 1 ROLLBACK

BEGIN
 -- Doing some Insert
END;
/

INSERT INTO TMP_TABLE VALUES('A', 'B')

COMMIT;
QUIT;
/ 
```

此脚本在我的本地系统上的文件 (Test1.sql) 中可用，我通过 Windows 命令行控制台连接到 Oracle 来运行此查询。在 cmd 下键入以下行。

```
C:\Users\myself> sqlplus UNAME/PWD@//DB IP:PORT/SID @C:\Users\Test1.sql 
```

在 SQL 脚本中，我故意没有`(INSERT INTO...)`用分号终止一条语句（见上文）。现在，当我按照上述说明运行此脚本时，程序成功运行并打印一条消息：

```
SQL*Plus: Release 10.2.0.1.0 - Production on Fri Apr 6 16:50:19 2012

Copyright (c) 1982, 2005, Oracle.  All rights reserved.

Connected to:
Oracle Database 11g Enterprise Edition Release 11.2.0.2.0 - 64bit Production
With the Partitioning, Automatic Storage Management, OLAP, Data Mining
and Real Application Testing options

PL/SQL procedure successfully completed.

Commit complete.

Disconnected from Oracle Database 11g Enterprise Edition Release 11.2.0.2.0 - 64
bit Production
With the Partitioning, Automatic Storage Management, OLAP, Data Mining
and Real Application Testing options 
```

当我在 SQL Navigator 工具上运行相同的脚本集时，出现以下错误，这是正确的：

**[10]：（错误）：ORA-00933：SQL 命令未正确结束**

我不明白为什么脚本没有报告这个错误，而是显示像“提交完成”这样的消息。

当我尝试使用 Windows 命令控制台通过 sdlplus 运行相同的脚本时，你能告诉我如何让我的脚本在控制台上抛出此错误吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-06T23:38:46.670

我的理解是，在 sqlplus 脚本中，空行终止 sql 语句。我没有要测试的 Oracle 环境，但请尝试删除插入和提交语句之间的空行，然后查看是否出现错误。我想你会看到它（它将充当连接的 insert..commit 语句）。

查看[SQL Plus 参考中的执行命令部分](http://docs.oracle.com/cd/B19306_01/server.102/b14357/ch4.htm#sthref803)

具体来说：

> 结束 SQL 命令
> 
> 您可以通过以下三种方式之一结束 SQL 命令：
> 
> *   带分号 (;)
> *   在一行上单独带有斜杠 (/)
> *   有一个空行
> 
> 注意：您可以使用 SET SQLBLANKLINES 命令（不在 iSQL*Plus 中）更改空行在 SQL 语句中的显示方式和行为方式。有关更改空行行为的更多信息，请参阅 SET 命令。

至于 SQLNavigator，不同的客户端工具会有不同的表现。SQLNavigator 解释器的行为与 sqlplus 解释器不同。如果您因脚本问题致电 Oracle 支持，他们会问的第一件事是“在 sqlplus 中运行它时是否看到此错误？”

# php - 为 codeigniter 创建自定义异常类

> ID：10049145
> 
> 赞同：0
> 
> 时间：2012-04-06T20:55:00.667
> 
> 标签：php, codeigniter

我正在尝试为 codeigniter 创建自定义异常类。这是我的代码：

```
class Ci_exception extends Exception {

    var $CI;

    function __construct()
    {
        $this->CI =& get_instance();
    }

    public function errorMessage()
    {
        log_message('error', $this->getMessage());
        return $this->getMessage();
    }

} 
```

如果没有构造方法，这个自定义类可以正常工作。使用构造方法， $this->getMessage() 方法不会返回任何消息。谁能解释为什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-06T20:57:33.770

您需要调用父级的构造函数；它不是隐含在 PHP 中的。您可能还想接受一个`$message`参数。

```
class Ci_exception extends Exception {

    var $CI;

    function __construct($message)
    {
        parent::__construct($message);
        $this->CI =& get_instance();
    }

    public function errorMessage()
    {
        log_message('error', $this->getMessage());
        return $this->getMessage();
    }

} 
```

# java - Java：如何检查某个字符是否在字符串中，然后打印出它相对于字符串的位置？

> ID：10049147
> 
> 赞同：-1
> 
> 时间：2012-04-06T20:55:07.370
> 
> 标签：java, arrays, string, search, char

我想做的是创建一个方法，它有一个字符串和一个字符作为参数，然后该方法获取字符串并搜索给定的字符。如果字符串包含该字符，它会返回一个整数数组，其中包含该字符出现的位置。这是我到目前为止所拥有的：

```
public class Sheet {
public static void main(String[] args) {
    String string = "bbnnbb";
    String complete = null;
    //*******
    for(int i = 0; i < string.length(); i++){
        complete = StringSearch(string,'n').toString();
    }
            //********
}

public static int[] StringSearch(String string, char lookfor) {
    int[]num = new int[string.length()];
    for(int i = 0; i < num.length; i++){
        if(string.charAt(i)== lookfor){
            num[i] = i;
        }
    }
    return num;
} 
```

}

该方法工作正常，并返回：

```
0
0
2
3
0
0 
```

我想要做的是把它们变成 1 个字符串，所以它看起来像这样“002300”。有什么可能的方法吗？我曾尝试在代码的加星标区域执行此操作，但没有成功。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-06T21:01:02.410

做就是了

```
StringBuffer strBuff = new StringBuffer();
for(int i = 0; i<str.length(); i++)
{
    if(str.charAt(i) == reqChar)
    {
        strBuff.append(str.charAt(i));
    }
    else
    {
        strBuff.append('0');
    }
}
return str.toString(); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-06T20:59:39.523

`+=`只需使用运算符将​​结果添加到现有字符串

```
String complete = "";
for(...)
    complete += StringSearch(string,'n').toString(); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-06T21:03:41.093

更新`StringBuilder`为更好的做法。

```
public static String StringSearch(String string, char lookfor) {
    StringBuilder sb = new StringBuilder();

    for(int i = 0; i < string.length; i++){
        if(string.charAt(i) == lookfor)
            sb.append(i);
        else
            sb.append("0");
    }
    return sb.toString();
} 
```

然后你可以只调用一次，而不需要 for 循环。不知道为什么要为字符串中的每个字符调用它。

```
complete = StringSearch(string,'n'); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-04-06T21:06:57.163

我只会使用 java 的正则表达式库，这样它会更灵活（例如，如果您想查找的不仅仅是单个字符）。另外，它是高度优化的。

```
StringBuilder positions = "";

Pattern pattern = Pattern.compile(string);
Matcher matcher = pattern.matcher(lookfor);
while(matcher.find()){
    positions.append(matcher.start());
}

return positions; 
```

# regex - url 文件路径的正则表达式帮助

> ID：10049156
> 
> 赞同：0
> 
> 时间：2012-04-06T20:56:22.583
> 
> 标签：regex

有人可以协助为以下情况创建正则表达式：

我有大约 2000 条记录，我需要对其进行搜索/替换，我需要替换每条记录中的已知项目，如下所示：

```
<li><a href="http://www.website.com/FILEPATH/FILE" target="_blank">View Product Information</a></li> 
```

FILEPATH 和 FILE 是可变的，但周围的 HTML 总是相同的。有人可以帮助我用哪种正则表达式代替搜索的“FILEPATH/FILE”部分？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-06T21:09:06.803

您可以匹配常量部分并使用分组将其放回

```
(<li><a href="http://www\.website\.com/)[^"]*(" target="\_blank">View Product Information</a></li>) 
```

那么你应该用 替换字符串`$1your_replacement$2`，`$1`第一个匹配组和`$2`第二个匹配组在哪里（如果使用 python 例如你应该调用`Match.group(1)`and `Match.group(2)`）

`\`如果您改用 Java，则必须转义字符。

# php - 检查/计数文件数组是否在 php 中为空

> ID：10049159
> 
> 赞同：0
> 
> 时间：2012-04-06T20:56:47.790
> 
> 标签：php, arrays

$_FILES 数组：

**HTML：**

```
<input type="file" name="smth[]" id="smth1" />
<input type="file" name="smth[]" id="smth1" />
<input type="file" name="smth[]" id="smth1" /> 
```

如何检查文件数组是否为空？（未选择文件）。

**PHP：**

```
if (CHECK) {

...operating with $_FILES...

} 
```

谢谢您的回答。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-06T21:04:21.567

```
function any_uploaded($name) {
  foreach ($_FILES[$name]['error'] as $ferror) {
    if ($ferror != UPLOAD_ERR_NO_FILE) {
      return true;
    }
  }
  return false;
}

if (any_uploaded('smth')) {
  // ..operating with $_FILES...
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-06T20:59:06.500

就像是

```
if(isset($_FILES) && count($_FILES) > 0){
... 
```

?

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-06T21:00:49.837

实际上，您需要遍历 $_FILES 并检查错误键中的 UPLOAD_ERR_NO_FILE 。有关更多信息，请参见[http://php.net/manual/en/features.file-upload.errors.php](http://php.net/manual/en/features.file-upload.errors.php)。

除此之外，还有无数种方法可以检查数组是否为空！即空（）或计数（）

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-09-08T14:38:20.993

只需检查文件名：

```
foreach($_FILES as $key => $val){
  if(strlen($_FILES[$key]['name']) > 0){
    //here we got a file from user
  }else{
    //no files received
  }
} 
```

# c++ - C ++中的复矩阵指数

> ID：10049160
> 
> 赞同：4
> 
> 时间：2012-04-06T20:56:54.670
> 
> 标签：c++, c, matrix, blas, gsl

实际上是否可以在 c / c++ 中计算复数矩阵的矩阵指数？

我已经设法使用 GNU 科学库中的 blas 函数得到两个复杂矩阵的乘积。对于 matC = matA * matB：

```
gsl_blas_zgemm (CblasNoTrans, CblasNoTrans, GSL_COMPLEX_ONE, matA, matB, GSL_COMPLEX_ZERO, matC); 
```

我已经设法通过使用未记录的

```
gsl_linalg_exponential_ss(&m.matrix, &em.matrix, .01); 
```

但这似乎不接受复杂的论点。

有没有办法做到这一点？我曾经认为 c++ 可以做任何事情。现在我认为它过时和神秘......

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-12T22:19:54.773

几个选项：

1.  修改`gsl_linalg_exponential_ss`代码以接受复杂的矩阵

2.  将复杂的 NxN 矩阵写为实数 2N x 2N 矩阵

3.  对矩阵进行对角化，取特征值的指数，然后将矩阵旋转回原来的基

4.  使用可用的复矩阵乘积，根据其定义实现矩阵指数：`exp(A) = sum_(n=0)^(n=infinity) A^n/(n!)`

您必须检查哪些方法适合您的问题。

C++ 是一种通用语言。如上所述，如果您需要特定功能，则必须找到可以执行此操作的库或自己实现它。或者，您可以使用 MatLab 和 Mathematica 等软件。如果这太贵了，还有开源替代品，例如 Sage 和 Octave。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-06T21:04:23.690

“我曾经认为 c++ 可以做任何事情”——如果通用语言的核心内置了复杂的数学，那么该语言就有问题。

对于这些非常具体的任务，有一个广为接受的解决方案：库。要么自己写，要么更好，使用已经存在的。

我自己很少需要 C++ 中的复杂矩阵，我总是使用 Matlab 和类似的工具。但是，如果您了解 Matlab，您可能会对这个[http://www.mathtools.net/C_C__/Mathematics/index.html感兴趣。](http://www.mathtools.net/C_C__/Mathematics/index.html)

还有几个其他库可能会有所帮助：

*   [http://eigen.tuxfamily.org/index.php?title=Main_Page](http://eigen.tuxfamily.org/index.php?title=Main_Page)
*   [http://math.nist.gov/lapack++/](http://math.nist.gov/lapack++/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-04T17:48:37.183

我也在考虑这样做，将复杂的 NxN 矩阵写为真正的 2N x 2N 矩阵是解决问题的最佳方法，然后使用`gsl_linalg_exponential_ss()`.

假设**`A=Ar+i*Ai`，**其中`A`是复矩阵，`Ar`和`Ai`是实矩阵。然后写出新的矩阵**`B=[Ar Ai ;-Ai Ar]`**（这里的矩阵是用matlab符号写的）。现在计算 的指数**`B`**，即 **`eB=[eB1 eB2 ;eB3 eB4]`**，然后 的指数由`A`下式给出（对矩阵和 求和）。**`eA=eB1+1i.*eB2`**
**`eB1`****`1i.*eB2`**

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-05T22:49:34.923

我编写了一个代码来使用 gsl 函数 gsl_linalg_exponential_ss(&m.matrix, &em.matrix, .01); 计算复矩阵的矩阵指数。这里有完整的代码和编译结果。我用 Matlab 检查了结果，结果一致。

```
#include <stdio.h>
#include <gsl/gsl_matrix.h>
#include <gsl/gsl_linalg.h>
#include <gsl/gsl_complex.h>
#include <gsl/gsl_complex_math.h>
void my_gsl_complex_matrix_exponential(gsl_matrix_complex *eA, gsl_matrix_complex *A, int dimx)
{
    int j,k=0;
    gsl_complex temp;
    gsl_matrix *matreal =gsl_matrix_alloc(2*dimx,2*dimx);
    gsl_matrix *expmatreal =gsl_matrix_alloc(2*dimx,2*dimx);
    //Converting the complex matrix into real one using A=[Areal, Aimag;-Aimag,Areal]
    for (j = 0; j < dimx;j++)
        for (k = 0; k < dimx;k++)
        {
            temp=gsl_matrix_complex_get(A,j,k);
            gsl_matrix_set(matreal,j,k,GSL_REAL(temp));
            gsl_matrix_set(matreal,dimx+j,dimx+k,GSL_REAL(temp));
            gsl_matrix_set(matreal,j,dimx+k,GSL_IMAG(temp));
            gsl_matrix_set(matreal,dimx+j,k,-GSL_IMAG(temp));
        }

    gsl_linalg_exponential_ss(matreal,expmatreal,.01);

    double realp;
    double imagp;
    for (j = 0; j < dimx;j++)
        for (k = 0; k < dimx;k++)
        {
            realp=gsl_matrix_get(expmatreal,j,k);
            imagp=gsl_matrix_get(expmatreal,j,dimx+k);
            gsl_matrix_complex_set(eA,j,k,gsl_complex_rect(realp,imagp));
        }
    gsl_matrix_free(matreal);
    gsl_matrix_free(expmatreal);
}

int main()
{
    int dimx=4;
    int i, j ;
    gsl_matrix_complex *A = gsl_matrix_complex_alloc (dimx, dimx);
    gsl_matrix_complex *eA = gsl_matrix_complex_alloc (dimx, dimx);

    for (i = 0; i < dimx;i++)
    {
        for (j = 0; j < dimx;j++)
        {
            gsl_matrix_complex_set(A,i,j,gsl_complex_rect(i+j,i-j));
            if ((i-j)>=0)
            printf("%d+%di ",i+j,i-j);
            else
            printf("%d%di  ",i+j,i-j);

        }
        printf(";\n");
    }
    my_gsl_complex_matrix_exponential(eA,A,dimx);
    printf("\n Printing the complex matrix exponential\n");
    gsl_complex compnum;
    for (i = 0; i < dimx;i++)
    {
        for (j = 0; j < dimx;j++)
        {
            compnum=gsl_matrix_complex_get(eA,i,j);
            if (GSL_IMAG(compnum)>=0)
                printf("%f+%fi\t ",GSL_REAL(compnum),GSL_IMAG(compnum));
            else
                printf("%f%fi\t ",GSL_REAL(compnum),GSL_IMAG(compnum));
        }
        printf("\n");
    }
    return(0);
} 
```

# c# - 在 ascx 中使用变量 DataFormatString

> ID：10049162
> 
> 赞同：4
> 
> 时间：2012-04-06T20:57:07.213
> 
> 标签：c#, asp.net, ascx, boundfield

所以我有一些看起来像这样的代码：

```
<asp:BoundField DataField="CreatedOn" HeaderText="Created on" 
SortExpression="CreatedOn" DataFormatString="{0:MMM dd yyyy hh:mm:ss tt}"> 
```

这可以按我的意愿工作。但是，我想在我的程序中到处重复使用日期格式。因此，我想使用一个变量而不是上面使用的字符串。就像是：

```
<asp:BoundField DataField="CreatedOn" HeaderText="Created on" 
SortExpression="CreatedOn" DataFormatString="<%=myFormatString%>"> 
```

但这完全行不通。它从字面上打印出来：

```
<%=myFormatString%> 
```

我尝试了 Bind，我尝试了 Eval，似乎没有任何效果。在我看来，这应该非常简单，甚至是必要的。我是世界上唯一一个想要多次使用 DataFormatString 的人吗？这是可能的还是我是一个梦想家？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-06T21:22:24.050

您可以从代码隐藏设置它：

```
((BoundField)GridView1.Columns[ColumnIndex]).DataFormatString = myFormatString; 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-07-11T19:42:21.277

一种选择是创建一个新类**DateBoundField**（或任何您想命名的名称），它继承绑定字段。在构造函数中，您只需将**DataFormatString**设置为日期格式字符串，然后在任何地方使用 DateBoundField 作为日期，当您需要更改日期格式时，只需在此类的构造函数中更改格式字符串。

```
 public class DateBoundField : BoundField
    {
        public DateBoundField()
        {
             DataFormatString = "{0:yyyy-MMM-dd}";
        }
    } 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-06T21:02:44.237

我想我刚刚找到了解决方案，我以前从未使用过它，所以你需要尝试:-)

[说明 url 未解码 asp.net](https://stackoverflow.com/questions/10094763/description-url-not-being-decoded-asp-net)

我会尝试类似的东西：

```
<%# myFormatString() %> 
```

# php - PHP 按两个条件对多维数组进行排序

> ID：10049167
> 
> 赞同：0
> 
> 时间：2012-04-06T20:57:46.883
> 
> 标签：php, arrays, sorting

我有这个数组，我需要先按“key_1”对它进行排序，然后（如果“key_1”中有多个类似的值）按“key_2”对它进行排序……我该怎么做，知道吗？

谢谢！

```
$my_array[0]['key_1'] = 2;
$my_array[0]['key_2'] = 300;

$my_array[1]['key_1'] = 2;
$my_array[1]['key_2'] = 100;

$my_array[2]['key_1'] = 1;
$my_array[2]['key_2'] = 100; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-06T21:04:17.147

这是一个简单的解决方案：

```
function my_sort($a, $b) {
  if ($a['key_1']==$b['key_1']) {
    if ($a['key_2']==$b['key_2']) {
      return 0;
    } else {
      return ($a['key_2']>$b['key_2']) ? 1 : -1;
    }
  } else {
    return ($a['key_1']>$b['key_1']) ? 1 : -1;
  }
}

usort($my_array, 'my_sort'); 
```

# javascript - 为什么全局对象的属性不接受新的赋值？

> ID：10049169
> 
> 赞同：-3
> 
> 时间：2012-04-06T20:58:06.110
> 
> 标签：javascript

我正在尝试为此全局会话对象中的“参加者”对象的“注释”属性分配一个新值……但是，每当我尝试分配时，该值都不会保留。

从 webkit 中的控制台：

```
> session['attendee']['notes']
null
> session['attendee']['notes'] = "test"
"test"
> session['attendee']['notes']
null
> window.session['attendee']['notes'] = "test"
"test"
> session['attendee']['notes']
null
> window.session['attendee']['notes']
null 
```

Session 在全局范围内设置如下：

```
window.session = {}; 
```

然后稍后我将分配一个从浏览器的 sql 数据库中提取的对象，如下所示；

```
window.session['attendee'] = {'name':'mike' ..etc..} 
```

**更新：**

这是更多控制台信息：

```
> window.session['attendee']
Object
  address_1: null
  address_2: null
  app_id: 1
  badge_id: null
  budget: null
  city: null
  company: null
  decision_maker: null
  email: null
  first_name: "Anonymous"
  followup: null
  id: null
  is_influencer: null
  is_purchaser: null
  is_user: null
  last_name: ""
  notes: null
  phone: null
  rating: null
  scanned: 1
  state: null
  synced: null
  zip: null
  __proto__: Object
> window.session['attendee'].notes
null
> window.session['attendee'].notes = "TEST"
"TEST"
> window.session['attendee'].notes
null 
```

所以 session.attendee 中有一个对象，而“notes”是该对象中的一个属性，但是给它赋值并不会生效。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-06T21:03:55.170

尝试分配给非对象的属性不会做任何事情。确保分配顺序类似于：

```
window.session = {};
window.session.attendee = {};
window.session.attendee.notes = "test"; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-06T21:05:30.363

这对我来说很好。我假设你在做一些愚蠢的事情。

```
window.session;
window.session = {};
window.session = {attendee:{notes:""}};
window.session.attendee.notes = "awesome";
session.attendee.notes; // "awesome" 
```

以下是控制台中的输出：

```
window.session;
undefined
window.session = {};
Object
window.session = {attendee:{notes:""}};
Object
window.session.attendee.notes = "awesome";
"awesome"
window.session.attendee
Object
notes: "awesome"
__proto__: Object 
```

# javascript - 在 Ext.Ajax.request() 中调用时，extjs 4.0 不一致的 window.open() 行为

> ID：10049172
> 
> 赞同：0
> 
> 时间：2012-04-06T20:58:44.293
> 
> 标签：javascript, extjs4, window.open

> **可能重复：**
> [window.open(url) 不同的行为 - 相同的代码，不同的时间](https://stackoverflow.com/questions/9793774/window-openurl-different-behavior-same-code-different-timing)

我会让我的代码片段解释我看到的问题。

```
function myFunction() {
    window.open('http://www.yahoo.com');  // --> this opens a new tab on my browser
    Ext.Ajax.request({
        url: 'PHP function call',
        success: function(response) {
            window.open('http://www.yahoo.com');  // --> this opens a new window, not tab
        }
    });
} 
```

这很奇怪。通过研究这个问题，我了解到目前没有办法强制打开浏览器选项卡而不是浏览器窗口。话虽如此，我仍然想知道是否有任何解决方法。我的应用程序的设计方式是，每次我调用 window.open() 时都会打开一个选项卡，但这种情况除外，因此我的客户觉得这很烦人。任何见解将不胜感激。

除了下面贾斯汀的建议外，我还尝试了以下方法：

```
function myFunction() {
    var myWin = window;
    myWin.open('http://www.yahoo.com');  // --> this opens a new tab on my browser
    Ext.Ajax.request({
        url: 'PHP function call',
        success: function(response) {
            myWin.open('http://www.yahoo.com');  // --> this opens a new window, not tab
        }
    });
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-06T21:37:04.510

这是时机。如果您的请求需要更多时间，则 ~3s 浏览器会认为它是弹出窗口。看看我几周前的问题：[window.open(url) 不同的行为 - 相同的代码，不同的时间](https://stackoverflow.com/questions/9793774/window-openurl-different-behavior-same-code-different-timing)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-07T15:27:37.263

您是否尝试过类似的方法：

```
function myFunction() {
    window.open('http://www.yahoo.com');  // --> this opens a new tab on my browser
    Ext.Ajax.request({
        url: 'PHP function call',
        success: function(response) {
            this.apply(openWindow);
        }
    });
}

function openWindow()
{
     window.open('http://www.yahoo.com');
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-06T21:18:09.340

我怀疑这可能是范围问题。AJAX 调用与脚本的其余部分在单独的“窗口”中运行。

您是否尝试过类似的方法：

```
function myFunction() {
    Ext.Ajax.request({
        url: 'PHP function call',
        success: function(response) {
            openWindows('http://www.yahoo.com');
        }
    });
}

function openWindows(url){
   window.open(url);
} 
```

# php - 从具有重复值的 MySQL 结果创建多维嵌套数组 (PHP)

> ID：10049175
> 
> 赞同：4
> 
> 时间：2012-04-06T20:59:11.643
> 
> 标签：php, mysql, multidimensional-array, nested, duplicates

我目前正在使用 PDO fetchAll() 函数从我们的数据库中提取菜单数据。这样做会将查询结果的每一行放入以下结构的数组中：

```
Array ( 
        [0] => Array ( 
                       [MenuId] => mmnlinlm08l6r7e8ju53n1f58 
                       [MenuName] => Main Menu 
                       [SectionId] => eq44ip4y7qqexzqd7kjsdwh5p 
                       [SubmenuName] => Salads & Appetizers
                       [ItemName] => Tomato Salad
                       [Description] => Cucumbers, peppers, scallions and cured tuna
                       [Price] => $7.00) 
        [1] => Array ( 
                       [MenuId] => mmnlinlm08l6r7e8ju53n1f58 
                       [MenuName] => Main Menu 
                       [SectionId] => xlkadsj92laada9082lkas 
                       [SubmenuName] => Entrees 
                       [ItemName] => Portabello Carpaccio
                       [Description] => Dried tomatoes, pin nuts, mahon cheese
                       [Prices] => $18.00)
 )                      
                       ...etc. 
```

出于解析原因，我想让数组出现在没有重复值的嵌套结构中：

```
Array ( 
          [MenuName] => Main Menu
          [MenuId] => mmnlinlm08l6r7e8ju53n1f58 
          [Section] =>  Array ( 
                                [SectionId] => eq44ip4y7qqexzqd7kjsdwh5p 
                                [SubmenuName] => Salads & Appetizers
                                [Items] => Array (
                                                    [ItemName] => Tomato Salad
                                                    [Description] => Cucumbers, peppers, scallions and cured tuna
                                                    [Prices] => Array (
                                                                        [PriceId] => xksjslkajiak1
                                                                        [Price] => $7.00)
                                                  ) 

                               [SectionId] => xlkadsj92laada9082lkas
                               [SubmenuName] => Entrees
                               [Items] => Array (                           
                                                   [ItemName] => Portabello Carpaccio
                                                   [Description] => Dried tomatoes, pin nuts, mahon cheese
                                                   [Prices] => Array (
                                                                        [PriceId => alkadh29189s09
                                                                        [Price] = $8.00)
                                                  )
                               )
) 
```

作为一名 n00b 程序员，我在最后一天一直在绞尽脑汁想弄清楚如何创建这个新的多维数组。似乎我可能不得不使用几个嵌套的 foreach 语句和引用，但我很难让任何东西工作。

有谁知道我该怎么做？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-06T21:33:29.687

这看起来像你正在寻找的

```
$array = array() ;

while ($row = PDO::fetchAll()) // Replace with relevant Information
{
    $section = array();
    $items  = array();
    $prices  = array();

    if(!array_key_exists($row['MenuId'], $array))
    {
        $array[$row['MenuId']] = array();
        $array[$row['MenuId']]['MenuName'] = $row['MenuName'] ;
        $array[$row['MenuId']]['MenuId'] = $row['MenuId'] ;
        $array[$row['MenuId']]['Section'] = array();
    }

    if(!array_key_exists($row['SectionId'], $array[$row['MenuId']]['Section']))
    {
        $array[$row['MenuId']]['Section'][$row['SectionId']] = array();
        $array[$row['MenuId']]['Section'][$row['SectionId']]['SectionId'] = $row['SectionId'] ;
        $array[$row['MenuId']]['Section'][$row['SectionId']]['SubmenuName'] = $row['SubmenuName'] ; 
        $array[$row['MenuId']]['Section'][$row['SectionId']]['Items'] = array() ;

    }

    $items['ItemName'] = $row['ItemName'] ;
    $items['Description'] = $row['Description'] ;

    $prices['PriceId']  = $row['PriceId'] ;
    $prices['Price']  = $row['Price'] ;

    $items['Prices'] = $prices ;
    $section['Items'] = $items ;

    $array[$row['MenuId']]['Section'][$row['SectionId']]['Items'][] = $items ;

}

var_dump($array); 
```

只需稍作改动，您就可以将其变成您想要的样子

# android - android调试环境变量

> ID：10049181
> 
> 赞同：4
> 
> 时间：2012-04-06T20:59:41.647
> 
> 标签：android, android-2.2-froyo

试图弄清楚如何将信息从 Eclipse 传递到我的 Android 应用程序。基本上，在代码中我有一个变量是我的服务器的主机名。但是，出于调试目的，我想指向我的本地机器而不是生产服务器；我不想更改这个文件，以免我不小心提交它（即我想让我自己和团队中的其他开发人员能够在运行时覆盖各种配置）。通常你可以通过环境变量来做到这一点，但我不知道如何为 Android 做到这一点。

有没有办法做到这一点（或等效的方法），我可以在启动调试实例时指定配置。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-05T02:23:13.290

如果有人想知道，我在 res 目录中添加了一个 xml 文件。然后我利用反射来查看 R 以按名称查找 id，然后从上下文中获取字符串值。

因此，例如，我将以下 XML 放入`res/values/dev.xml`

```
<?xml 版本="1.0" 编码="utf-8"?>
<资源>
    <string name="server">myserver.mydomain.com</string>
    <string name="username">我的用户名</string>
    <string name="password">我的密码</string>
</资源>

```

然后我使用反射来找到`R.strings.server`&的 ID`<context>.getString(id)`

# r - 在 R 和 ggplot2 包中，如何添加线条？

> ID：10049182
> 
> 赞同：0
> 
> 时间：2012-04-06T20:59:48.397
> 
> 标签：r, ggplot2

我正在做生存分析，并使用

1.  绘图函数将 Kaplan-Meier（KA 变量）估计绘制为 y 值与时间的关系。

2.  lines 函数绘制估计 i 和 i+1 之间的阶梯线，对于每个 i=1,2,....

代码如下：

```
plot(KA)

for( i in 1:(length(KA)-1)){

lines(c(i,i+1),c(KA[i],KA[i]))       # The horizontal step lines

lines(c(i+1,i+1),c(KA[i],KA[i+1]))   # The vertical step lines

} 
```

现在我想使用 ggplot2 包制作一个更漂亮的生存图。

问题是：如何将阶梯线添加到图形中？

对不起，我的声誉低于 10，我不能放图表。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-17T08:53:40.987

查看 geom_step、geom_path 或 geom_segment。
它们可能对您想要实现的目标有所帮助。

[http://had.co.nz/ggplot2/geom_step.html](http://had.co.nz/ggplot2/geom_step.html)
[http://had.co.nz/ggplot2/geom_path.html](http://had.co.nz/ggplot2/geom_path.html)
[http://had.co.nz/ggplot2/geom_segment.html](http://had.co.nz/ggplot2/geom_segment.html)

# php - 登录 cookie 安全性

> ID：10049186
> 
> 赞同：0
> 
> 时间：2012-04-06T21:00:18.350
> 
> 标签：php, security, cookies, login

如果用户可以注册并登录，我正在制作我的第一个完整网站。以下 cookie 是否安全？我需要一个更具体的随机代码来代替用户名或密码吗？

```
setcookie("username", "$username", time()+3600);
setcookie("password", "$password", time()+3600); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-06T21:03:41.053

有人可能会从您的用户浏览器中窃取 cookie 文件并访问他的用户名/密码，您不希望这样。因此，您给用户一些随机的 auth-token（会话 id）并将服务器端的用户与包含登录信息的数据集相关联。PHP 已经内置了该功能。

所以你应该改用php的会话引擎。 [http://de3.php.net/manual/en/book.session.php](http://de3.php.net/manual/en/book.session.php)

它还可以处理如果您的浏览器不支持 Cookie 会发生什么问题。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-06T21:03:57.107

如果用户想记住他们的登录名和密码以自动登录，则应该使用它。如果不使用会话。

并且密码应该被编码。**永远不要存储别人直接输入的密码！** 如果您的密码经过编码是安全的，例如：

```
md5('my_password'); 
```

使用这种编码，无法解密密码，因为它与无限的值相关联。

当您比较两个密码以查看是否相同时，当两个密码都被编码时

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-06T21:03:19.423

是的，它们是安全的，因为它们仅特定于计算机/浏览器。（曲奇饼干）。

时间很好，因为它们会在一个小时后自动删除。

是的，为 cookie 的 ID 指定一个更随机的代码而不是“用户名”和“密码”，例如“(nameofsite)usern”和“(nameofsite)pas”，作为名称为“用户名”和“密码”可能会干扰来自另一个网站的用户计算机/浏览器上**已经存在的 cookie。**

我假设您在提交密码时已经对其进行了编码。

# extjs - Sencha Touch 2：尝试将列表添加到面板

> ID：10049188
> 
> 赞同：0
> 
> 时间：2012-04-06T21:00:23.917
> 
> 标签：extjs, sencha-touch-2

我有一个由工具栏和选项卡组成的面板。在每个选项卡上应该有一个列表和一个按钮。我相信我已经正确设置了这个列表，除了我试图添加如下的列表：

```
Ext.define('Myapp.view.Search', {
xtype: 'search',
extend: 'Ext.tab.Panel',

    config: {
        activeItem: 0,
        tabBar: {
            docked: 'top',
            autoScroll: 'auto',
            ui: 'light',
            layout: {
                pack: 'center'
            }
        },

        items: [
        {
            xtype:'toolbar',
            docked:'top',
            ui: 'light',
            title: 'Search'
        },

            {
                title: 'Tab 1',
                xtype: 'formpanel',
                items: [
                    {
                        xtype: 'Mylist' //DOES NOT WORK
                    },
                    {
                        xtype: 'panel',
                        defaults: {
                            xtype: 'button',
                            style: 'margin: 0.1em',
                            flex : 1
                        },
                        layout: {
                            type: 'hbox'
                        },
                        items: [
                            {
                                text: 'Button 1',
                            }
                        ]
                    }
                ]
            },
            {
                title: 'Tab 2',
                xtype: 'formpanel',
                items: [
                    {
                        xtype: 'panel',
                        defaults: {
                            xtype: 'button',
                            style: 'margin: 0.1em',
                            flex : 1
                        },
                        layout: {
                            type: 'hbox'
                        },
                        items: [
                            {
                                text: 'Button 1',
                            }
                        ]
                    }
                ]
            }
        ]
    }
}); 
```

请让我知道我做错了什么，并感谢您的帮助！

**编辑**：在下面添加了 Mylist：

```
Ext.define('Myapp.view.Mylist', {
    extend: 'Ext.dataview.NestedList',
    xtype: 'Mylist',

    config: {
        store: 'Sections'
    },

    getTitleTextTpl: function() {
        return '{name}';
    },
    getItemTextTpl: function(node) {
        return '<strong>{name}</strong>';
    },
}); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-05T04:25:17.200

试试这些

在视图中：

```
 {
        xtype: 'panel',
         flex: 4,
        width: '400px',
        height:"700px",

        layout: {
            type: 'fit'
                },
        items: [
                {
                xtype: 'list',
             // loadingText:"Loading Category",
              styleHtmlContent: true,
              // id:"mylist2",
              width:"300px",

                itemTpl:

             '<div class="mycon">'+ 
             '<input type="image" id="click" img src="{coupon_image}" style="max-width:130%;border:6px double #000000;" width="200" height="200"' +'style="padding:3px;">' +
            '</div>'+
            '<div><font size="2" color="red"><b>Coupon Name:</b></font></div>'+
            '<div><font size="2" color="green"><b>{coupon_name}</b></font></div>'+

                '</div>',                                
              store : 'ViewCategoryStore',

            },

        ]
    } 
```

在控制器中：

```
 Ext.define('Expressdeal.controller.ViewCategoryController', {
    extend: 'Ext.app.Controller',

           config: {
          refs: {

      viewcat : 'viewcategory'       // xtype of the view

               },
          control: {

    'viewcategory list: {
               activate: 'onActivate',
                 itemtap: 'onItemTap',
                     }, 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-06T22:15:56.503

在列表视图中定义列表的位置，您应该说

```
alias:'widget.Mylist' 
```

代替

```
xtype:'Mylist' 
```

你的清单也需要一个 itemTpl 配置，我很确定。

```
config: {
        store: 'Sections',
        itemTpl:'{example}'
    } 
```

只要驱动您列表的商店处于工作状态，列表就应该正确显示

# bookmarklet - pinterest 小书签在网站上不起作用

> ID：10049201
> 
> 赞同：1
> 
> 时间：2012-04-06T21:01:41.393
> 
> 标签：bookmarklet, pinterest

一个客户有一个 oscommerce 网上商店，里面有很多有趣的东西供人们在 pinterest 上钉住，只有它的小书签钉销不起作用。我在网上到处搜索，但找不到任何有价值的东西，所以我希望这里的任何人都可以帮助我。

当我单击书签时，什么都没有显示，但是当我突然打开 firebug 时，pinterest 覆盖层会弹出所有图像。一旦所有内容出现 10 次 pinterest 警报，就会显示“抱歉，我们在此页面上看不到任何大图像或视频”。萤火虫控制台没有给我任何有用的东西，所以我有点没有想法。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-07T13:28:46.750

Okay, after some more poking around I found a reference to improper DOCTYPE's screwing up some bookmarklets in Chrome. I checked against some other sites and changed all the

```
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"> 
```

into

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"> 
```

And now it works!

As a side note, the bookmarklet also doesn't catch the images etc in frames, so that might screw up some sites also.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-05-26T17:06:37.817

它可能不起作用的一个原因是，如果您的网站是 https 并且小书签是旧的。

我注意到 Pinterest 小书签在我们的网站上没有任何作用。

Chrome Web Inspector 透露：“[阻止] [https://example.com/foo上的页面运行来自](https://example.com/foo)[http://assets.pinterest.com/js/pinmarklet.js](http://assets.pinterest.com/js/pinmarklet.js)的不安全内容？...”

当前版本的小书签固定在 https 网站上工作，当然您不能依赖访问者保持最新状态。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-19T19:20:32.417

我在我女朋友的 Wordpress 博客上遇到了类似的问题。

问题是我的图像名称为“a”、“b”、“c”、“d”（因为我在编写一些 JS OnMouseOver 翻转时很懒）。这些名称导致小书签无法加载——一旦我更改了对象名称，小书签就可以正常加载所有内容。

# java - Primefaces如何在下拉值更改时更新celleditor中dataTable中的特定单元格？

> ID：10049211
> 
> 赞同：1
> 
> 时间：2012-04-06T21:02:47.927
> 
> 标签：java, jsf, primefaces

我有一个使用单元格编辑器功能的数据表。在每一行中，我都有一个下拉列表，我想要的是当用户在该下拉列表中选择不同的值时，我希望更新当前行中的另一个单元格。

这是我的专栏：

```
<p:column headerText="Period">
    <p:cellEditor>
        <f:facet name="input">
            <p:selectOneMenu value="#{pj_details.periodDates}" id="period" size="1" styleClass="listBoxMedium">
                <p:ajax update="tabs:editProjects:projects" event="change" listener="#{ppBacker.populateProjectDates}" />
                <f:attribute name="period_key" value="#{pj_details.periodDates}" />
                <f:selectItems value="#{ppBacker.periods}" />
            </p:selectOneMenu>  
         </f:facet>
         <f:facet name="output">
                <h:outputText value="#{pj_details.periodDates}" />
         </f:facet>
    </p:cellEditor>
</p:column> 
```

我的更新有效，只是它更新了将表格从单元编辑器模式中抛出的输入表单。

使用 firebug，我可以看到我需要的更新如下所示：

```
tabs:editProjects:projects:1:projStartDate_input 
```

唯一的问题是此示例中的数字 1 指的是行。

那么我怎样才能更新与下拉列表在同一行中的单元格而不被抛出单元编辑器模式呢？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-09T07:15:32.200

请检查类似的问题... [Jquery Onchange 事件没有被触发 - Primefaces - inputText](https://stackoverflow.com/questions/9374651/jquery-onchange-event-not-getting-fired-primefaces-inputtext/9376806#9376806)

为数据表定义 rowIndexVar 并在 rowIndexVar 的帮助下访问单元格

希望这可以帮助

# jquery - jQuery切换不断重复

> ID：10049212
> 
> 赞同：0
> 
> 时间：2012-04-06T21:02:56.197
> 
> 标签：jquery, jquery-animate, toggle

我对 jQuery 很陌生，但似乎很容易。一样的，我想不通。我正在尝试在两个动画功能之间切换，但是当功能二完成时，它会继续并调用功能一。

```
function toggleThis(){
    $("#navSliderArrow").toggle(function() {       
        $(this).animate({ marginLeft: '235' }, 500);
        $("#sliderArrow").attr("src", "images/hide_nav.gif");
    }, function() {       
        $(this).animate({ marginLeft: '0' }, 500);
        $("#sliderArrow").attr("src", "images/show_nav.gif");
    });
} 
```

我究竟做错了什么？~gyz

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-06T21:15:10.407

根据我之前的评论，

> 据我所知， .toggle 只有一个回调函数。不知道当你有 2 个这样的功能时会发生什么。无论如何，你想在这里实现什么？

阅读更多[.toggle API 文档](http://api.jquery.com/toggle/)

我假设您正在尝试显示和隐藏`onclick`. `#sliderArrow`如果是这样，请在下面尝试，

```
 $(function () {
       var $slideArrow = $("#sliderArrow");
       var $navSlideArrow = $('#navSliderArrow');
       $slideArrow.on ('click', function () {              
          if ($slideArrow.attr('src').indexOf('show') >= 0) {
                $navSlideArrow.animate({ marginLeft: '235' }, 500);
                $slideArrow.attr("src", "images/hide_nav.gif");
          } else {
                $navSlideArrow.animate({ marginLeft: '0' }, 500);
                $slideArrow.attr("src", "images/show_nav.gif");
          }
       });
   }); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-06T21:08:47.443

引用操作：

> “我究竟做错了什么？”

根据[jQuery 文档](http://api.jquery.com/toggle/)，您的语法是错误的。内部不能有两个回调函数`toggle()`。

> .toggle（[持续时间] [，缓动] [，回调]）
> 
> *   **duration** - 一个字符串或数字，确定动画将运行多长时间。
> *   **easing** - 一个字符串，指示用于过渡的缓动函数。
> *   **callback** - 动画完成后调用的函数。

* * *

**编辑：**

阅读其他答案后，我看到还有[另一个版本的 jQuery`toggle()`](http://api.jquery.com/toggle-event/) ...

[http://api.jquery.com/toggle-event/](http://api.jquery.com/toggle-event/)

> .toggle（处理程序（事件对象），处理程序（事件对象）[，处理程序（事件对象）]）
> 
> *   **handler(eventObject)** - 每次点击元素时执行的函数。
> *   **handler(eventObject)** - 每次单击元素时执行的函数。
> *   **handler(eventObject)** - 点击后要循环的其他处理程序。

正确实施，您的 jQuery 应该看起来像*这样*......

```
$(document).ready(function() {
    $("#navSliderArrow").toggle(
        function() {       
            $(this).animate({ marginLeft: '235' }, 500);
            $("#sliderArrow").attr("src", "images/hide_nav.gif");
        },
        function() {       
            $(this).animate({ marginLeft: '0' }, 500);
            $("#sliderArrow").attr("src", "images/show_nav.gif");
        }
    );
}); 
```

有了 jQuery，就完全**不需要**像`<a href="#" onclick="togglethis()">`. 您的 HTML 应该*类似于*...

```
<a href="#" id="navSliderArrow"> 
```

我只说“类似”，因为您的 HTML 不包含在您的 OP 中，而且我不知道您的目标元素应该是什么。

[**jsFiddle 演示**](http://jsfiddle.net/VGYyf/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-06T22:08:43.433

还有一个 .toggle() 的事件处理程序版本 - [http://api.jquery.com/toggle-event/](http://api.jquery.com/toggle-event/)

toggle 事件处理程序绑定了 click 方法本身，因此您只需要直接执行动画即可：

```
$("#navSliderArrow").toggle(
    function() {       
        $(this).animate({ marginLeft: '235' }, 500);
        $("#sliderArrow").attr("src", "images/hide_nav.gif");
    }, 
    function() {       
        $(this).animate({ marginLeft: '0' }, 500);
        $("#sliderArrow").attr("src", "images/show_nav.gif");
    }
); 
```

# objective-c - 如何添加具有更多属性的目标？

> ID：10049215
> 
> 赞同：0
> 
> 时间：2012-04-06T21:03:08.307
> 
> 标签：objective-c, xcode

一个简单的问题，因为我无法快速找到我的问题的任何特殊答案。

我有这样一个方法：

```
- (void)changeValueForEasy:(UISlider *)slider offset:(int)offset {} 
```

我试图用事件来调用它，但我不知道如何添加一个像“偏移”这样的附加对象：

```
[blueSlider addTarget:self action:@selector(changeValueForEasy:) forControlEvents:UIControlEventValueChanged]; 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-06T21:34:31.953

也许是这样的

```
 [blueSlider addTarget:self action:@selector(sliderDragged:) forControlEvents:UIControlEventValueChanged]; 
```

然后

```
- (void)sliderDragged:(UISlider *)slider;
{
    [self changeValueForEasy:slider offset:slider.value];
} 
```

方法名称表明它设置滑块的值，您要调用此方法的事实表明您在更改值时进行了一些额外的处理。我建议将额外的处理抽象到另一种方法中，否则滑块的值将被设置两次。

# android - 安卓。在布局中定位 3 个块

> ID：10049218
> 
> 赞同：0
> 
> 时间：2012-04-06T21:03:17.697
> 
> 标签：android, layout

此图像描述了我需要创建的内容： ![在此处输入图像描述](../Images/7a950e41cf81cb638d6e9c61b7eedf19.png)

这是我的 xml 代码：

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="fill_parent"
    android:layout_height="fill_parent"
    android:orientation="vertical"
    android:background="@drawable/bg" >

<TextView
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:layout_gravity="left" />
<TextView
    android:layout_width="wrap_content"
    android:layout_height="wrap_content" />

<LinearLayout 
    android:layout_width="fill_parent"
    android:layout_height="wrap_content"
    android:gravity="center_vertical|center_horizontal"
    android:orientation="horizontal">
        <TextView  
            android:layout_width="wrap_content" 
            android:layout_height="wrap_content" 
            android:gravity="left"
            />
       <TextView
            android:layout_width="wrap_content" 
            android:layout_height="wrap_content"
            android:gravity="right"
            />
</LinearLayout>
<!-- Now the block that has to be flexible -->
<RelativeLayout 
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:paddingTop="15dp" 
    android:gravity="center" >
<ImageView
    android:layout_width="350dp"
    android:layout_height="wrap_content"    
    android:layout_centerHorizontal="true" >
</ImageView>
<TextView
    android:layout_width="fill_parent"
    android:layout_height="wrap_content"
/>
</RelativeLayout>
<!-- -------------------------------- -->
    <RelativeLayout 
    android:layout_width="fill_parent"
    android:layout_height="wrap_content">

<ImageButton
    android:layout_width="70dp"
    android:layout_height="61dp"
    android:layout_alignParentLeft="true"
    android:layout_alignParentBottom="true"
>
</ImageButton>

<ImageButton
    android:scaleType="fitCenter"
    android:layout_width="70dp"
    android:layout_height="70dp"
    android:layout_centerHorizontal="true"
    android:layout_alignParentBottom="true"  >
</ImageButton>

<ImageButton
    android:layout_width="65dp"
    android:layout_height="65dp"
    android:layout_alignParentRight="true"
    android:layout_alignParentBottom="true" >
</ImageButton>

</RelativeLayout>
</LinearLayout> 
```

必须拉伸的块包含在 ImageView 和 TextView 中。所以我的问题是 - 如何使这个中间块灵活但在顶部和底部保留另外两个块以保持在任何屏幕高度上？中间块将被拉伸。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-06T21:10:18.527

对于顶部和底部布局：

```
android:layout_height="wrap_content" // or a value un pixels (e.g 100dp) 
```

对于灵活的布局：

```
android:layout_height="fill_parent" 
```

请注意，您不需要相对布局。只需使用线性布局，它们就会正确堆叠

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-06T21:15:30.527

我只会使用一个`LinearLayout`. 将其设置`orientation`为`vertical`和。将中间部分的 设置为某个正值，例如，对于固定件，只需使用或适当的某个值。`layout_height``fill_parent``layout_weight``1``wrap_content``dp`

# c - C 程序：常规与不规则字符串数组

> ID：10049219
> 
> 赞同：0
> 
> 时间：2012-04-06T21:03:18.757
> 
> 标签：c

我正在尝试在 C 程序中编写更高效的代码，并且我需要一些帮助以使我的指针和分配正确。我在下面展示了两种方法，每种方法都使用以下声明和 strncpy：

```
int kk, arraysize;
char person_name[100] = "";
char * array_person_name, * array_param;
...
strncpy(person_name, "John Smith", 100);
arraysize = <this value is downloaded from database>;
... 
```

方法A（矩形阵列）：

```
array_person_name = malloc( sizeof(char) * arraysize *100 );
array_param = malloc( sizeof(char) * arraysize * 2 );
for (kk = 0; kk < arraysize; kk++) {
    strncpy(array_person_name[kk], person_name, 100);
    strncpy(array_param[kk], "bt", 2);
} 
```

方法 B（参差不齐的数组）：

```
for (kk = 0; kk < arraysize; kk++) {
array_person_name[kk] = &person_name;
array_param[kk] = "bt";
} 
```

请注意，我尝试创建的数组将相同的值放入数组的每个元素中。方法 A 是一个（矩形）`arraysize`元素数组，每个元素本身都是一个 100 个字符的数组。方法 B 试图通过创建一个（参差不齐的）元素数组来避免浪费存储空间`arraysize`，其中每个元素都是一个指向字符的指针。

问题 1：我在方法 A 中是否正确分配内存（例如 malloc）？

问题 2：方法 B 的语法看起来是否正确？

问题 3：如何为方法 B 中的数组分配内存？

问题 4：我是否正确地认为方法 B 通常是首选？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-06T21:15:38.000

你离这里很远。1：是，2：否，3：否，4：是。我不会全部做，但这里有一些提示。

您需要空间来存储字符串和空间来存储指向字符串的指针（后者对于方法 A 不是绝对必要的）。第一个将有 type `char*`，第二个将有 type `char**`。

对于方法 A，您正在正确分配字符串存储空间，但您需要为字符串指针正确分配存储空间（提示：您需要指针`arraysize`的实例`char*`）。然后它被初始化为彼此相差 100 个字符的指针。

对于方法 B，没有简单的方法来分配空间来存储字符串，因为您不知道需要多少空间。您可以遍历所有字符串一次以计算它们的长度，或者`malloc`每个字符串执行一个，或者使用固定大小的块并在用完时分配更多。

方法 B 使用与方法 A 相同的字符串存储指针数组。一旦知道字符串指针的去向，就需要将字符串指针分配到数组中。

# hibernate - 未找到指定的 JDBC 驱动程序 com.ibm.db2.jcc.DB2Driver 类

> ID：10049221
> 
> 赞同：0
> 
> 时间：2012-04-06T21:03:27.990
> 
> 标签：hibernate, jdbc, db2, classnotfoundexception

我花了相当多的时间研究并试图找出我的配置哪里出了问题，但完全卡住了。从我一直在阅读的帖子中可以看出，我的驱动程序不在类路径中。我添加了 Class.forName("com.ibm.db2.jcc.DB2Driver") 行以确保驱动程序可用并在该行中加载。对于我可能错过的任何建议，我将不胜感激。

我的代码是：

```
 public class TestHibernateConfig {

    private static SessionFactory sessionFactory;

    public static void testConfig() {
        try {
            DB2Driver drvr = (DB2Driver) Class.forName("com.ibm.db2.jcc.DB2Driver").newInstance();

            Configuration cfg = new Configuration();
            cfg.configure("hibernate.cfg.xml");
            sessionFactory = cfg.buildSessionFactory();
            Session sess = sessionFactory.getCurrentSession();
            Transaction tx = sess.beginTransaction();

            Criteria crit = sess.createCriteria(ItemData.class);
            List items = crit.list();

        } catch (Exception e) {
            Logger logger = Logger.getLogger("");
            logger.error(e.getMessage());
        }
    }
} 
```

当我的代码命中时，我得到类未找到错误： sessionFactory = cfg.buildSessionFactory();

休眠.cfg.xml

```
 <?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE hibernate-configuration PUBLIC "-//Hibernate/Hibernate Configuration DTD 3.0//EN" "http://www.hibernate.org/dtd/hibernate-configuration-3.0.dtd">
<hibernate-configuration>
 <session-factory name="speed2db2">
 <property name="hibernate.dialect">org.hibernate.dialect.DB2Dialect</property>
  <property name="hibernate.connection.driver_class">com.ibm.db2.jcc.DB2Driver</property>
  <property name="hibernate.connection.url">jdbc:db2://appdb:50000/MYTEST</property>
  <property name="hibernate.connection.username">myUser</property>
  <property name="hibernate.connection.password">myPass</property>
 </session-factory>
</hibernate-configuration> 
```

持久性.xml

```
<?xml version="1.0" encoding="UTF-8"?>
<persistence version="2.0" xmlns="http://java.sun.com/xml/ns/persistence" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://java.sun.com/xml/ns/persistence http://java.sun.com/xml/ns/persistence/persistence_2_0.xsd">
    <persistence-unit name="speedPersistUnit">
        <class>ItemData</class>
        <properties>
            <property name="hibernate.dialect" value="org.hibernate.dialect.DB2Dialect"/>
            <property name="hibernate.connection.url" value="jdbc:db2://appdb:50000/MYTEST"/>
            <property name="hibernate.default_schema" value="MYSCHEMA"/>
            <property name="hibernate.connection.username" value="myUser"/>
            <property name="hibernate.connection.password" value="myPass"/>
            <property name="hibernate.connection.driver_class" value="com.ibm.db2.jcc.DB2Driver"/>
        </properties>
    </persistence-unit>
</persistence> 
```

从 Eclipse 中，我可以连接到数据库，如果我进入 Hibernate 透视图，我可以浏览数据库模式。我还可以使用 HQL 编辑器在我的班级中加载数据。

编辑：

```
09:35:50,338 INFO  [org.hibernate.cfg.Configuration] (http-xxxxxx-xx.xx.xx.xxxx-15081-1) HHH000043: Configuring from resource: /com/newpig/speed2DB2/hibernate.cfg.xml
09:35:50,340 INFO  [org.hibernate.cfg.Configuration] (http-xxxxxx-xx.xx.xx.xxxx-15081-1) HHH000040: Configuration resource: /com/newpig/speed2DB2/hibernate.cfg.xml
09:35:50,369 INFO  [org.hibernate.cfg.Configuration] (http-xxxxxx-xx.xx.xx.xxxx-15081-1) HHH000041: Configured SessionFactory: speed2db2
09:35:52,059 INFO  [org.hibernate.service.jdbc.connections.internal.DriverManagerConnectionProviderImpl] (http-xxxxxx-xx.xx.xx.xxxx-15081-1) HHH000402: Using Hibernate built-in connection pool (not for production use!)
09:36:16,856 ERROR [] (http-xxxxxx-xx.xx.xx.xxxx-15081-1) Specified JDBC Driver com.ibm.db2.jcc.DB2Driver class not found 
```

错误发生在这一行。

```
 sessionFactory = cfg.buildSessionFactory(); 
```

部署到我的 .war 文件：
.War
|-WEB-INF
||-lib
|||-db2jcc4.jar
|||-hibernate-core-4.1.2.Final.jar
|||-hibernate-entitymanager-4.1。 2.Final.jar
|||-hibernate-jpa-2.0-api-1.0.1.Final.jar

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-10T13:53:34.897

我不认为我提到我正在使用 JBoss7.1。最后，我无法弄清楚为什么 Hibernate 无法加载驱动程序，但通过切换到使用 JNDI 并在 JBoss Standalone.xml 中配置数据源而不是尝试从 Hibernate 建立连接来解决它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-07T11:39:18.763

我认为这可能是因为 hibernate.cfg.xml 在错误的位置。您应该检查它是否在您的类路径中，或者您可以尝试像这样在方法调用中添加类路径。

```
SessionFactory sessionFactory = new Configuration().configure(
                    "/com/mkyong/persistence/hibernate.cfg.xml")
                    .buildSessionFactory();
```

# c# - P/Invoke 错误的参数被传递给 C 库函数

> ID：10049224
> 
> 赞同：2
> 
> 时间：2012-04-06T21:03:41.857
> 
> 标签：c#, c, pinvoke

我一直在尝试从 C# 代码调用 ImageMagick 库中的 NewPixelRegionIterator 函数，并且遇到了参数传递问题。
更具体地说，这里是 NewPixelRegionIterator 的定义：

```
PixelIterator NewPixelRegionIterator(MagickWand *wand,const ssize_t x,
const ssize_t y,const size_t width,const size_t height) 
```

这里是将这个函数导入 C# 代码的代码：

```
[DllImport("libMagickWandDev.so")]
internal static extern PixelIterator NewPixelRegionIterator(IntPtr MagickWand,  
          IntPtr left, IntPtr top, UIntPtr width, UIntPtr height); 
```

我导入**libMagickWandDev.so**而不是**libMagickWand.so**的事实是因为 libMagickWandDev.so 是在启用调试支持的情况下编译的，因此我可以使用 gdb 运行 mono 以了解问题是否出在对 C 函数的调用中（实际上它是）。

通过gdb发现的问题是在调用NewPixelRegionIterator比如：

```
PixelIterator PixIt = PixelIteratorImports.NewPixelRegionIterator(MagickWandPtr,  
         new IntPtr(x), new IntPtr(y), new UIntPtr(1), new UIntPtr(1)); 
```

通过 gdb 找到的实际传递的参数是：

```
Breakpoint 1, NewPixelRegionIterator (wand=0x7fffffffc7a8, x=10744336, y=5, 
width=6, height=1) at wand/pixel-iterator.c:418 
```

*   5 和 6 很好，它们是传递给函数的实际数字（尽管*x*应该等于 5，*y*应该等于 6，使*宽度*和*高度*都等于 1）。这意味着参数的顺序有点向右移动，并且 0x7fffffffc7a8 可能是要返回的结构的一部分或其他东西。
*   如果有帮助，*10744336*是 MagickWandPtr 的值*（* Magick Wand 的地址），因为在 gdb 中将*wand*参数设置为 this 并将*x*设置为合理的值会使函数运行得很好。
*   PixelIterator 是一个非常仔细映射的结构（我还通过 Marshal.SizeOf 验证了结构的大小和实际 C 代码的 sizeof() 是相同的 4192 字节）

再次，提前感谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-06T21:23:36.527

你确定你可以从 PInvoke 函数返回一个结构吗？您不需要使用输出参数/指针返回它吗？

因为参数被移动了，所以我希望 PixelIterator* 类型的隐藏参数作为第一个或最后一个参数。并且返回类型为 void。这就是 C 编译器在底层实现结构返回函数的方式。

在评论中，您解释说返回 PixelIterator* 可以解决问题。其原因可能是 C 函数正在分配一个对象并返回其指针。但是，该定义没有给出任何线索……无论如何，当您完成返回的对象时，您可能需要释放该内存。

# php - 在 preg_replace 中使用花括号

> ID：10049225
> 
> 赞同：1
> 
> 时间：2012-04-06T21:03:47.230
> 
> 标签：php, preg-replace

我正在尝试使用 preg_replace 更改 TeX 文件的格式。

这是我的代码：

```
$regex = "#([\][A-Za-z]+)(Title)#e";
$replace = "('hl\{$1Title}')";
$newphrase = preg_replace($regex,$replace,$newphrase); 
```

我的问题是“{”之前的“\”在我的输出中打印出来。

像这样：\hl\{FaithTitle} 而不是这样：\hl{FaithTitle}

我尝试了很多不同的东西，这里有几个：

```
$replace = "('hl{$1Title}')"; 
```

那会使整个页面崩溃。

```
$replace = "('hl[{]$1Title}')"; 
```

那一个打印出方括号和花括号。

我将不胜感激任何帮助！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-06T21:09:52.593

你的正则表达式没有做你认为它在做的事情。

由于`\`，您的字符类实际上是匹配的`A-Za-z`，但也`][`因为`\`转义了 the 的含义`]`并且`[`在类中没有。

试试这个：

```
$regex = "#(\\[A-Za-z]+)(Title)#"; 
```

同时删除`e`修饰符。我不知道你为什么一开始就有它，但这可能就是它崩溃的原因。

# ruby-on-rails - Rails/延迟作业：无法从延迟作业中保存模型

> ID：10049230
> 
> 赞同：4
> 
> 时间：2012-04-06T21:04:00.443
> 
> 标签：ruby-on-rails, delayed-job

我有一个 Post 模型（如下），它有一个回调方法来通过延迟作业修改 body 属性。如果我删除“延迟”。只需执行#shorten_urls！立即，它工作正常。但是，从延迟作业的上下文来看，它不会保存更新的正文。

```
class Post < ActiveRecord::Base
  after_create :shorten_urls

  def shorten_urls
    delay.shorten_urls!
  end

  def shorten_urls!
    # this task might take a long time, 
    # but for this example i'll just change the body to something else
    self.body = 'updated body'
    save!
  end
end 
```

奇怪的是，作业处理没有任何问题：

```
[Worker(host:dereks-imac.home pid:76666)] Post#shorten_urls! completed after 0.0021
[Worker(host:dereks-imac.home pid:76666)] 1 jobs processed at 161.7611 j/s, 0 failed ... 
```

然而，正文没有更新。有人知道我在做什么错吗？

- 编辑 -

根据 Alex 的建议，我已将代码更新为如下所示（但无济于事）：

```
class Post < ActiveRecord::Base
  after_create :shorten_urls

  def self.shorten_urls!(post_id=nil)
    post = Post.find(post_id)
    post.body = 'it worked'
    post.save!
  end

  def shorten_urls
    Post.delay.shorten_urls!(self.id)
  end
end 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-06T21:13:45.767

原因之一可能是`self`当您将方法传递给`delay`. 尝试制作`shorten_urls!`一个获取记录 ID 并从数据库中获取它的类方法。

# sql-server - SQL Server 聚合给出不寻常的值

> ID：10049235
> 
> 赞同：1
> 
> 时间：2012-04-06T21:04:11.897
> 
> 标签：sql-server, tsql

我有这两个查询来测试我的输出

```
SELECT DISTINCT( providerId ), 
               SUM(( claimCount )), 
               SUM(paidAmount), 
               SUM(provallowed), 
               SUM(patresp), 
               provId, 
               cliCode, 
               asctype, 
               payerid, 
               procCode 
FROM   TempCounts tt, 
       TempClient tct 
WHERE  ( tct.npi = tt.provid 
          OR tct.txcode = tt.provid ) 
       AND CLICODE = 'XXX' 
GROUP  BY tt.provid, 
          providerId, 
          cliCode, 
          asctype, 
          payerid, 
          procCode 
```

--

```
SELECT DISTINCT( providerid ), 
               claimCount, 
               paidamount, 
               provallowed, 
               patresp, 
               provid, 
               CLICODE, 
               asctype, 
               payerid, 
               proccode 
FROM   TempCounts tt, 
       TempClient tct 
WHERE  ( tct.npi = tt.provid 
          OR tct.txcode = tt.provid ) 
       AND CLICODE = 'XXX' 
```

对来自第二个查询的未聚合结果求和应该在第一个查询中给出聚合值，但我的数据集最终像第一个数据集

```
15086   7   216.16  0.00    35.00   1609950203  XXX     216     72040
15086   7   227.36  0.00    21.00   1609950203  XXX     216     72070 
```

第二个数据集

```
15086   1   30.88   0.00    5.00    1609950203  XXX     216     72040
15086   1   32.48   0.00    3.00    1609950203  XXX     216     72070 
```

我一辈子都看不到我错过了什么，盯着它看了这么久，我是代码盲。有什么建议么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-06T21:23:04.657

由于 DISTINCT 选项，这两个数据集可能不同。

因此，未聚合查询仅返回有限数量的行，这些行彼此不同。

在第一个查询中， DISTINCT 选项没有用，因为结果中包含所有分组列。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-06T21:41:01.313

我终于想通了。因为 tempClient 表有多个基于 npi 和 txcode 字段的记录（即一个记录可以有每个 npi 的多个 txcode 实例。我以为我正在过滤它，因为针对 mysql 的相同查询给出了正确的结果。解决方案是添加 tt .npi 和 tt.txcode 到 groupby 语句。

# android - 如何将文件夹图标添加到我的列表视图

> ID：10049242
> 
> 赞同：0
> 
> 时间：2012-04-06T21:04:25.497
> 
> 标签：android, listview

```
for(int i = 0; i < files.length; i++)
{
    File file = files[i];
    path.add(file.getPath());
    if(file.isDirectory())
        item.add(file.getName() + R.drawable.folder); /* it doesn't work, because it shows numbers instead of folder icon */
    else
        item.add(file.getName());
} 
```

它不起作用；它显示数字而不是文件夹图标。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-06T21:28:51.523

有几个关于制作文件管理器和列表的 Android 教程：[Android 编程：从哪里开始创建一个简单的文件浏览器？](https://stackoverflow.com/questions/4108881/android-programming-where-to-start-for-creating-a-simple-file-browser)

该链接 - 在 StackOverFlow 上 - 具有其他对您正在尝试的工作有益的链接。此外，您可以使用 OpenIntents 开源文件管理器中的源代码：

OpenIntents：[http ://www.openintents.org/en/download](http://www.openintents.org/en/download)

源代码： [http ://code.google.com/p/openintents/downloads/detail?name=FileManager-source-1.0.0.zip&can=1&q=](http://code.google.com/p/openintents/downloads/detail?name=FileManager-source-1.0.0.zip&can=1&q=)

要查看 Open Intents 文件管理器的外观，您可以在此处查看：[https ://play.google.com/store/apps/details?id=org.openintents.filemanager](https://play.google.com/store/apps/details?id=org.openintents.filemanager)

让我知道这是否有帮助！

# iphone - writeToFile 如何判断何时完成

> ID：10049245
> 
> 赞同：19
> 
> 时间：2012-04-06T21:05:00.077
> 
> 标签：iphone, ios

我正在向我的文档目录写入一些数据，我想知道是否有办法告诉我的 writeToFile 方法何时完成以及我正在创建的文件已完全创建。提前感谢这里是我正在调用的方法我只是在寻找一种方法，它是委托方法还是其他方式来判断何时完成。

```
[imageData writeToFile:fullPathToFile atomically:YES]; 
```

缺口

* * *

## 回答 #1

> 赞同：33
> 
> 时间：2012-04-06T21:13:17.280

该方法`writeToFile:atomically`是“同步的”。它将写入文件然后返回`YES`或`NO`取决于文件是否成功写入。

这意味着只要方法返回，操作就完成了。

```
BOOL success = [imageData writeToFile:fullPathToFile atomically:YES];
// Now, the operation is complete
// success indicates whether the file was successfully written or not 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2019-10-15T13:08:33.907

**斯威夫特 5：**

```
do {
    try data.write(to: path)
    // here's when write operation is completed without errors thrown
} catch {
    Swift.print(error)
} 
```

# css - CSS *：不是谷歌浏览器下用户脚本中的选择器

> ID：10049246
> 
> 赞同：2
> 
> 时间：2012-04-06T21:05:04.163
> 
> 标签：css, google-chrome, css-selectors, userscripts

我正在尝试创建一个用户样式（作为用户脚本安装在**Google Chrome**中）。隐藏页面上的所有内容并仅显示[图像](http://i.imgur.com/oqhgG.png)只是一些 CSS 。

```
html { height:100%; 
       background:url(http://i.imgur.com/oqhgG.png) no-repeat center fixed #FFFFFF !important; 
       overflow:hidden; 
     }
*:not(html) { display:none; } 
```

我想说我在这里对 CSS 的理解有问题，但这在*Mozilla* **Firefox**中有效（将此代码粘贴到**userContent.css**中，它的行为符合预期）。

还尝试`body`了代替`html`，`visibility:collapse;`代替`display:none;`和更具体的`:not`选择器。

下面是[**userstyles.org**](http://userstyles.org/styles/userjs/53487/Block%20entire%20website%20and%20display%20custom%20graphics.user.js?option-86826=479025&option-86827=479027 "阻止整个网站并显示自定义图形 - user.js 文件")[如何将此 CSS 变成用户脚本](http://userstyles.org/styles/userjs/53487/Block%20entire%20website%20and%20display%20custom%20graphics.user.js?option-86826=479025&option-86827=479027 "阻止整个网站并显示自定义图形 - user.js 文件")

 **请解释一下这里发生了什么！非常感谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-07T04:46:46.077

以下代码在我的 chrome 上运行良好。我删除了您的 @namespace 行并在 html 元素上应用了样式。

```
// @description   Block entire websites in style!
// @author        monn43
// @homepage      http://userstyles.org/styles/53487
// @run-at        document-start
// ==/UserScript==
(function() {
var css = "";
if (false || (document.domain == "perezhilton.com" ||document.domain.substring(document.domain.indexOf(".perezhilton.com") + 1) == "perezhilton.com") || (document.domain == "fitperez.com" || document.domain.substring(document.domain.indexOf(".fitperez.com") + 1) == "fitperez.com") || (document.domain == "cocoperez.com" || document.domain.substring(document.domain.indexOf(".cocoperez.com") + 1) == "cocoperez.com") || (document.location.href.indexOf("http://perezhilton.com/") == 0))
css += "html { height:100%; background:url(http://i.imgur.com/oqhgG.png) no-repeat center fixed #FFFFFF !important; overflow:hidden; }\n*:not(html) { visibility:hidden; }";
if (typeof GM_addStyle != "undefined") {
GM_addStyle(css);
} else if (typeof PRO_addStyle != "undefined") {
PRO_addStyle(css);
} else if (typeof addStyle != "undefined") {
addStyle(css);
} else {
var heads = document.getElementsByTagName("head");
if (heads.length > 0) {
    var node = document.createElement("style");
    node.type = "text/css";
    node.appendChild(document.createTextNode(css));
    heads[0].appendChild(node); 
}
}
})(); 
```**

# python - 如何更好地栅格化绘图而不模糊 matplotlib 中的标签？

> ID：10049248
> 
> 赞同：8
> 
> 时间：2012-04-06T21:05:14.813
> 
> 标签：python, matplotlib, transparency, eps

我通常`ax.set_rasterized(True)`用来光栅化图形，以便在保存为`eps`格式时可以处理透明度，但是光栅化也会模糊轴标签和刻度标签，所以有没有办法只光栅化轴内的补丁而不是整个图形？还是有更好的方法来导出透明的 eps 格式？谢谢。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-04-08T11:08:51.153

由于 matplotlib [Artists](http://matplotlib.sourceforge.net/api/artist_api.html#matplotlib.artist.Artist)可以被光栅化，任何从 Artist ( [http://matplotlib.sourceforge.net/api/artist_api.html](http://matplotlib.sourceforge.net/api/artist_api.html)`rasterized` ) 派生的类都可以通过设置为的关键字进行光栅化`True`。所以你只能光栅化你的补丁。

我只是尝试了一些组合，它似乎工作。但是质量似乎不是很好（另见[http://www.mail-archive.com/matplotlib-users@lists.sourceforge.net/msg13276.html](http://www.mail-archive.com/matplotlib-users@lists.sourceforge.net/msg13276.html)）。

```
import numpy as np
import matplotlib.pyplot as plt 

def add_patch(ax, **kwargs):
    if 'rasterized' in kwargs and kwargs['rasterized']:
        ax.set_rasterization_zorder(0)
    ax.fill_between(np.arange(1, 10), 1, 2, zorder=-1, **kwargs)
    ax.set_xlim(0, 10) 
    ax.set_ylim(0, 3)
    if 'alpha' in kwargs and kwargs['alpha'] < 1:
        txt = 'This patch is transparent!'
    else:
        txt = 'This patch is not transparent!'
    ax.text(5, 1.5, txt, ha='center', va='center', fontsize=25, zorder=-2,
            rasterized=True)

fig, axes = plt.subplots(nrows=4, sharex=True)
add_patch(axes[0], alpha=0.2, rasterized=False)
add_patch(axes[1], alpha=0.2, rasterized=True)
add_patch(axes[2], rasterized=False)
add_patch(axes[3], rasterized=True)

plt.tight_layout()
plt.savefig('rasterized_transparency.eps') 
```

我将其转换`eps`为 png 以在浏览器中显示：

![rasterized_transparency.png](../Images/98f2868dc7e7ce544c1652b58b1e7057.png)

另请参阅：[如何在 matplotlib 中将图形保存为 pdf 作为光栅图像](https://stackoverflow.com/questions/5609969/how-to-save-figures-to-pdf-as-raster-images-in-matplotlib)。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2016-02-03T07:13:37.997

如果您指定 dpi，结果会更好 - 这似乎默认为相当低的值。例如，将最后一行更改为

```
plt.savefig('rasterized_transparency.eps',dpi=200) 
```

并且文件增长到 4.5M，在 Acrobat 中放大 200% 看起来很好。但是我同意可能有更紧凑的格式支持透明度。

# php - 使用 pecl oauth 为 LTI 结果服务构建身体签名的 oauth xml 请求

> ID：10049255
> 
> 赞同：4
> 
> 时间：2012-04-06T21:05:53.413
> 
> 标签：php, oauth, lti

我正在使用 pecl oAuth 库，是否可以构建一个身体签名的 oauth 请求，如下所示：

```
POST http://www.imsglobal.org/developers/BLTI/service_handle.php HTTP/1.0
Host: 127.0.0.1:80
Content-Length: 757
Authorization: OAuth realm="",oauth_version="1.0",
oauth_nonce="29f90c047a44b2ece73d00a09364d49b",
oauth_timestamp="1313350943",oauth_consumer_key="lmsng.school.edu",
oauth_body_hash="v%2BxFnmDSHV%2Fj29qhxLwkFILrtPo%3D",
oauth_signature_method="HMAC-SHA1",
oauth_signature="8auRpRdPY2KRXUrOyz3HKCs92y8%3D"
Content-type: application/xml
<?xml version = "1.0" encoding = "UTF-8"?>
... more xml data ... 
```

我正在尝试使用 IMS Global LTI 标准接口与 Instructure 的 Canvas LMS 进行通信。结果[服务允许您使用](http://www.imsglobal.org/lti/v1p1pd/ltiIMGv1p1pd.html#_Toc309649691)[oauth 签名的 xml 消息](http://www.imsglobal.org/lti/v1p1pd/ltiIMGv1p1pd.html#_Toc309649688)将分数发送回 LMS

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-07T13:50:50.227

事实证明 pecl oAuth 目前不支持 oaut_body_hash。

我最终使用了来自这个谷歌代码存储库[http://code.google.com/p/oauth/](http://code.google.com/p/oauth/)的 oAuth 库，并计算了我自己的身体：

```
$bodyHash = base64_encode(sha1($body, TRUE)); // build oauth_body_hash
$consumer = new \OAuthConsumer($key, $secret);
$request = \OAuthRequest::from_consumer_and_token($consumer, '', 'POST', $endpoint, array('oauth_body_hash' => $bodyHash) );
$request->sign_request(new \OAuthSignatureMethod_HMAC_SHA1(), $consumer, '');
$header = $request->to_header() . "\r\nContent-Type: application/xml\r\n"; // add content type header 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2020-07-15T10:11:33.330

标准[`OAuth::generateSignature`](https://www.php.net/manual/en/oauth.generatesignature.php)函数允许额外的参数作为第三个参数。这可用于传递自定义正文哈希参数：

```
$oauth = new OAuth($credentials["oauthKey"], $credentials["oauthSecret"]);

$timestamp = time();
$oauth->setTimestamp($timestamp);

$nonce = mt_rand();
$oauth->setNonce($nonce);

$bodyHash = base64_encode(sha1($content, true)); // $content contains the body
$sig = $oauth->generateSignature('GET', $url, Array("oauth_body_hash" => $bodyHash)); 
```

然后我们可以使用它来构建我们的 OAuth 标头：

```
$header = array
(
    'Content-Type: application/xml'
);
$header[] = 'Authorization: OAuth '.
            'oauth_version="1.0",'.
            'oauth_nonce="'.$nonce.'",'.
            'oauth_timestamp="'.$timestamp.'",'.
            'oauth_body_hash="'.$bodyHash.'",'.
            'oauth_consumer_key="'.$credentials["oauthKey"].'",'.
            'oauth_signature_method="HMAC-SHA1",'.
            'oauth_signature="'.urlencode($sig).'"'; 
```

# html - 在javascript中更改下载名称

> ID：10049259
> 
> 赞同：34
> 
> 时间：2012-04-06T20:58:14.517
> 
> 标签：html, javascript

如果用户单击可下载的链接，例如

```
<a href="downloadable.txt">Download</a> 
```

在“另存为”对话框之前是否有客户端（html 或 javascript）方法来更改文件的名称？

* * *

## 回答 #1

> 赞同：97
> 
> 时间：2012-04-06T21:16:00.773

HTML5 提供了[`a[download]`](http://updates.html5rocks.com/2011/08/Downloading-resources-in-HTML5-a-download)允许您重命名文件的属性。此示例将下载`link.txt`并重命名它`something.txt`。

```
​&lt;a download="something.txt" href="link.txt">asdf</a>​​​​​​​​​​​​​​​​​​​​​​​​​​​ 
```

请注意，这仅适用于同源 URL（即不能跨不同域）。

* * *

## 回答 #2

> 赞同：18
> 
> 时间：2012-04-06T21:08:04.773

不，您不能从客户端（HTML 或 javascript）更改此设置。您需要从服务器更改它。一种方法是使用将设置 Content-Disposition HTTP 响应标头的服务器端脚本：

```
Content-Disposition: attachment; filename=somecustomname.txt 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2016-11-30T09:14:25.910

您可以使用由 eligrey 编写的 Filesaver.js 脚本（我在此处的示例中使用 angularjs）您可以使用 XmlHttpRequest 对象在经典 javascript 中实现相同的功能

```
//In your html code , add these : ->
<script src="https://rawgit.com/eligrey/FileSaver.js/master/FileSaver.js" type="text/javascript"></script>
 <script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jquery/3.1.1/jquery.min.js"></script>
<script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/angularjs/1.5.7/angular.min.js"></script>
<script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/angularjs/1.5.7/angular-animate.js"></script>
//In your Javascript:- 

$http({
        url: "url where the file is located",
        method: "GET",
        responseType: "blob"
    }).then(function (response) {

saveAs(response.data,"newfilename.extension");

}) 
```

# windows - 每天在特定时间之间触发几次 Windows 任务计划程序进程

> ID：10049260
> 
> 赞同：1
> 
> 时间：2012-04-06T21:06:37.587
> 
> 标签：windows, task

我试图实现一些目标，但我真的不知道我是如何在 Windows 任务调度程序中设置新的基本任务的，而在高级设置中我试图设置特定的东西。

我希望我的工作**每 3 小时在 7:00-23:59 之间运行** 换句话说，我不希望工作在晚上运行..（我尝试使用过期复选框，但我做错了）

编辑：我使用 Windows Server 2008 标准

任何帮助都会很棒..

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-06T21:26:35.700

打开任务的高级属性。选择触发器选项卡。编辑触发器。将时间表更改为从 07:00 开始，每 3 小时重复一次任务，持续 17 小时（您必须自己输入这些数字）。

# objective-c - Core Data 存储多少？

> ID：10049261
> 
> 赞同：1
> 
> 时间：2012-04-06T21:06:51.233
> 
> 标签：objective-c, core-data

只是一个小问题，我找不到答案。

如果我添加一个数据模型，包括每个类的所有属性，并为这些生成核心数据类，我当然可以让所有东西都持久化。

但我也可以将非核心数据属性添加到类中。这些还会持续吗？仅仅凭借属于一个存储的对象？基本数据类型和对象会有什么不同吗？

我认为这些不会被保存，但认为值得检查。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-06T21:12:03.973

不会。Core Data 只保存模型化的属性。向您的 NSManagedObject 子类添加额外的属性是非常好的，并且经常需要，但它们的行为就像任何其他对象上的属性一样，并且不会保存到磁盘。

# asp.net - ASP Membership Provider 密码和盐机器或操作系统是特定的吗？

> ID：10049263
> 
> 赞同：1
> 
> 时间：2012-04-06T21:07:10.467
> 
> 标签：asp.net, asp.net-membership

我在 EF Code First 初始化程序中有一些代码，它正在获取成员资格提供程序（ASP 通用提供程序）并为一些用户播种。我知道这不一定是正常情况，但它在本地开发中运行良好。推送到 Azure 时，我有时会发现它不起作用。我看到在创建的成员资格表中创建的记录，但是当我使用密码登录时它不匹配。用我本地的值更新盐和密码似乎也不起作用。用于盐/密码生成或验证的机器或操作系统是否有特定内容？这没有任何意义，因为这会扰乱任何农场场景，只是寻找任何帮助来解释为什么我会看到这样的东西。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-09T23:02:25.853

Yes, if you set the machine key explicitly, Membership Provider uses that key to encrypt the password.

So you need to have same machine key in all web.config files.

# c# - 从 SQL Server 数据库中删除

> ID：10049265
> 
> 赞同：2
> 
> 时间：2012-04-06T21:07:20.513
> 
> 标签：c#, database, linq-to-sql

我在我的程序中使用带有 Linq-to-SQL 的 SQL Server 数据库

我正在使用此代码清空数据库

```
 db.Tb1.DeleteAllOnSubmit(db.Tb1.Select(x => x));
 db.SubmitChanges(); 
```

执行此代码后，数据库中的所有内容都将被清除。但问题是删除行时数据库的大小并没有减少。

我的意思是在没有数据的情况下使用该代码后，数据库的大小仍然相同

对不起英语不好

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-06T21:13:04.580

这就是 SQL Server 的工作方式。除非您在数据库上手动运行“释放未使用的空间”操作，否则不会返回空间，该操作会重新组织记录在数据库文件中的物理存储方式。否则，未使用的空间将被保留并在添加新记录时重新使用。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-06T21:19:08.467

每当删除行时，数据库不会收缩其数据文件。您必须要求服务器收缩其文件，例如使用 T-SQL 命令`DBCC SHRINKDATABASE`（请参阅[DBCC SHRINKDATABASE 的 MSDN 文档](http://msdn.microsoft.com/en-us/library/ms190488.aspx)）。这种行为的主要原因可能是收缩对性能的影响。此外，服务器将重用现在空闲的页面。对于定期删除大量行或截断完整表的数据库，您可以将收缩安排为维护任务。`UPDATE STATISTICS`然后，您还应该为该表安排更新数据库统计信息（T-SQL 命令）。

# c++ - 是否允许 STL 谓词使用其参数的地址？

> ID：10049268
> 
> 赞同：3
> 
> 时间：2012-04-06T21:07:26.643
> 
> 标签：c++, stl, predicate, remove-if

在编写自定义谓词函数/函子以传递给 STL 算法时，是否允许谓词使用其参数的地址？

这是激发问题的问题。我有一个向量`vec`和一个向量`inds`，其中包含一些索引`vec`。我想删除那些`vec`索引在`inds`.

一种方法是使用`remove_if`谓词函子，该函子通过获取其地址`InInds`来确定其参数的索引：`vec`

```
class InInds {
  private:

  const vector<Element>& vec_;
  const vector<int>& inds_;

  public:

  InInds(const vector<Element>& vec, const vector<int>& inds) 
    : vec_(vec), inds_(inds) {}

  bool operator()(const Element& element) {
    // WARNING: uses the ADDRESS of element, not its value. May not be kosher?
    int index = &element - &vec[0];
    return std::find(inds_.begin(), inds_.end(), index) != inds_.end();
  }

} 
```

`InInds`如果直接在`vec`. 如果在元素的副本上调用它会中断，因为副本的地址对于确定`element`的索引没有用处。

我的问题是：这个谓词是否适用于`remove_if`任何符合标准的编译器？或者谓词是否严格意味着只对值而不是地址进行操作？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-06T21:37:42.140

将 remove_if 与谓词一起使用是错误的，因为 remove_if 通常会将未删除的元素移向范围的开头。您需要将未删除的元素复制到另一个容器，而不是原地移除它们。

# css - 下拉位置

> ID：10049269
> 
> 赞同：0
> 
> 时间：2012-04-06T21:07:40.030
> 
> 标签：css, menu, position

在使用下拉菜单中的链接获取下拉菜单位置或主要是其背景到位时遇到一些问题，无法弄清楚可能是什么问题......这是关于如何使用的 CSS 代码 (menu li ul) 图像它看起来 -> [http://i.imgur.com/9VjpW.jpg](http://i.imgur.com/9VjpW.jpg)或 jsFiddle [http://jsfiddle.net/F5wCG/3/](http://jsfiddle.net/F5wCG/3/)

```
.menu ul{
background-color: transparent;
height: 25px;
list-style: none;
margin: 0;
padding: 0;
position: relative;
clear: left;
float: right;
text-align: center;
right: 50%;

}
.menu li{
    float: left;
    padding: 0px;
    position: relative;
    left: 50%;
    margin: 0px;
    list-style: none;
    }

.menu li a{ /* Where main link names are etc */
    background: #333 url("images/seperator.gif") bottom right no-repeat;
    color: #CCC;
    display: block;
    font-weight: normal;
    line-height: 35px;
    margin: 0px;
    padding: 0px 25px;
    text-align: center;
    text-decoration: none;
    }

    .menu li a:hover, .menu ul li:hover a{
        background-color: #2580A2;
        background-image: url('images/hover.gif');
        background-position: bottom center;
        background-repeat: no-repeat;
        color:#FFFFFF;
        text-decoration:none;
        }

.menu li ul{ /* Drop down menu */
    background-color: #333;
    display: none;
    height: auto;
    border: 0px;
    position: absolute;
    width: 225px;
    z-index: 200;
    padding: 0px;
    margin: 0px;
    border: 0px;
    }

.menu li:hover ul{
    display: block;
    }

.menu li li {
    background: url('images/sub_sep.gif') bottom left no-repeat;
    display: block;
    float: none;
    width: 220px;
    }

.menu li:hover li a{
    background: none;

    }

.menu li ul a{
    display: block;
    height: 35px;
    font-size: 12px;
    font-style: normal;
    margin: 0px;
    padding: 0px 10px 0px 15px;
    text-align: left;
    }

    .menu li ul a:hover, .menu li ul li:hover a{
        background: #2580A2;
        background-image: url(images/hover_sub.gif);
        background-position: center left;
        background-repeat: no-repeat;
        border: 0px;
        color: #FFF;
        text-decoration: none;
        }

.menu p{
    clear: left;
    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-06T21:20:01.933

[http://jsfiddle.net/F5wCG/4/](http://jsfiddle.net/F5wCG/4/)

基本上删除 .menu li { left: 50% } 并添加 .menu li a {left:0; }

# wordpress - 如何将其应用于我的主题的 functions.php 文件，而不是核心 WordPress 文件？

> ID：10049271
> 
> 赞同：0
> 
> 时间：2012-04-06T21:08:00.410
> 
> 标签：wordpress

我需要将一个类应用于 WordPress`get_archive_links`功能输出的帖子存档链接。我可以通过修改`/wp-includes/general-template.php (line 842)`, 来实现这一点：

```
$link_html = "\t<li>$before<a href='$url' title='$title_text'>$text</a>$after</li>\n"; 
```

对此：

```
$link_html = "\t<li>$before<a class='hello' href='$url' title='$title_text'>$text</a>$after</li>\n"; 
```

我很确定我需要在我的主题的functions.php中添加某种过滤器来以聪明的方式完成这个，而不修改核心文件，我只是不知道如何。任何指导都会很棒。

编辑：这是来自 general-template.php 的完整的、未修改的函数：

```
function get_archives_link($url, $text, $format = 'html', $before = '', $after = '') {
$text = wptexturize($text);
$title_text = esc_attr($text);
$url = esc_url($url);

if ('link' == $format)
    $link_html = "\t<link rel='archives' title='$title_text' href='$url' />\n";
elseif ('option' == $format)
    $link_html = "\t<option value='$url'>$before $text $after</option>\n";
elseif ('html' == $format)
    $link_html = "\t<li>$before<a href='$url' title='$title_text'>$text</a>$after</li>\n";
else // custom
    $link_html = "\t$before<a href='$url' title='$title_text'>$text</a>$after\n";

$link_html = apply_filters( 'get_archives_link', $link_html );

return $link_html; 
```

}

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-07T05:48:03.130

所以我想出了如何做到这一点，感谢[这个页面](http://diythemes.com/thesis/rtfm/archives-widget-nofollow/)。

把这个扔进去`functions.php`：

```
// Filter to add nofollow attribute
function nofollow_archives($link_html) {
return str_replace('<a href=', '<a rel="nofollow" href=',  $link_html);
} 
```

然后在任何你想要的地方调用新函数：

```
<?php add_filter('get_archives_link', 'nofollow_archives'); ?>
<?php wp_get_archives('type=monthly'); ?> 
```

该示例显然显示了如何添加 nofollow rel 标签，但您可以轻松修改它以添加链接类或其他任何内容。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-06T21:38:28.647

这样的事情怎么样？

```
function new_get_archives_link ( $link_html ) {
   if ('html' == $format) {
         $link_html = "\t<li>$before<a class='hello' href='$url' title='$title_text'>$text</a>$after</li>\n";
      }
      return $link_html;
   }
add_filter("get_archives_link", "new_get_archives_link"); 
```

将其复制到您的functions.php 中，您不必编辑核心文件。

未经测试..

# c++ - 二元运算符重载和多态性

> ID：10049273
> 
> 赞同：1
> 
> 时间：2012-04-06T21:08:25.583
> 
> 标签：c++, polymorphism, operator-overloading

我正在尝试制作一个允许我将整数添加到我的一个类的运算符，但我遇到了如下问题。

```
 struct Base
{
    //Will have value of zero
};

struct Derived : public Base
{
    int value_;
};

int & operator+=(int & num, Base & b);
int & operator+=(int & num, Derived & d); 
```

随着运营商的实施

```
int & operator+=(int & num, Base & b)
{
    return num;
}

int & operator+=(int & num, Derived & d)
{
    num += d.value_;
    return num;
} 
```

所以我有一个向量，我试图遍历它并将所有值添加到一个整数。但是，即使是 Derived 类型的那些也不会改变总和。

如何使运算符重载多态？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-06T21:15:42.960

这是一个很好的博士。dobbs 文章为您的问题提供了 3 个解决方案[http://drdobbs.com/cpp/200001978](http://drdobbs.com/cpp/200001978) 其中之一，我也在想同样的事情，就是您可以将您的运算符依赖于虚拟成员函数或辅助函数。

# javascript - javascript IFrame 权限

> ID：10049274
> 
> 赞同：1
> 
> 时间：2012-04-06T21:08:36.863
> 
> 标签：javascript

我知道为了保护客户端，您可以对 iframe 的 contentWindow 和 contentWindow.document 属性做很少的事情，但究竟有什么*可能*呢？

编辑：我应该澄清它是跨域的。

# c# - 在 C# 中动态转换 Page.LoadControl

> ID：10049277
> 
> 赞同：3
> 
> 时间：2012-04-06T21:08:48.960
> 
> 标签：c#, asp.net, .net

我是第一次编写一些用户控件，我想知道是否有办法清理我的一些代码。（如果您想了解我正在研究的更多背景信息，请参阅[此问题](https://stackoverflow.com/questions/9234151/dynamic-page-rendering-in-aspx)。）

我有一个`BaseControl`类，基本上，它解析一些 XML 数据，然后根据该数据中包含的内容，调用适当`UserControl`的并在其途中发送数据。这是一个例子：

```
public partial class BaseControl : User Control
{
    protected void Page_Load(object sender, EventArgs e)
    {
        ... //code that parses the data
        var renewalDef = effort.Attributes["renewal_def"].Value;
        var effortNumber = effort.Attributes["renewal_effort_number"].Value;
        if (effortNumber == "1")
        {
            var effortControl = (NAVLEffort1) Page.LoadControl("~/NAVLSeriesControls/NAVLEffort1.ascx");
            effortControl.transactionData = transaction; //'transaction' is a Hashtable object
            HtmlContent.Controls.Add(effortControl); //'HtmlContent' is a PlaceHolder control on BaseControl.ascx page
        }
        if (effortNumber == "2")
        {
            var effortControl = (NAVLEffort2) Page.LoadControl("~/NAVLSeriesControls/NAVLEffort2.ascx");
            effortControl.transactionData = transaction; //'transaction' is a Hashtable object
            HtmlContent.Controls.Add(effortControl); //'HtmlContent' is a PlaceHolder control on BaseControl.ascx page
        }
        if (effortNumber == "3")
        {
            var effortControl = (NAVLEffort3) Page.LoadControl("~/NAVLSeriesControls/NAVLEffort3.ascx");
            effortControl.transactionData = transaction; //'transaction' is a Hashtable object
            HtmlContent.Controls.Add(effortControl); //'HtmlContent' is a PlaceHolder control on BaseControl.ascx page
        }
        // and so on...
    }
} 
```

这不是我写的*实际*代码，它只是我可以前进的一个例子。我想做的是更像这样的事情：

```
...
var effortControlFileString = string.Format("~/NAVLSeriesControls/{0}Effort{1}.ascx", renewalDef, effortNumber);
var effortControl = (renewalDef + "Effort" + effortNumber) Page.LoadControl(effortControlFileString);
effortControl.transactionData = transaction;
HtmlContent.Controls.Add(effortControl)
... 
```

有什么想法可以清理这个烂摊子吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-06T21:18:01.373

## 界面

您可以让所有控件实现一个通用接口并转换为该接口。

```
public interface IMyInterface
{
    object TransactionData
    {
       get;
       set;
    }
}

Control effortControl = Page.LoadControl(path);
HtmlContent.Controls.Add(effortControl);

IMyInterface obj = (IMyInterface)effortControl;
obj.TransactionData = transaction; 
```

在在线 IDE 中查看此[工作示例。](http://www.coderun.com/ide/?w=0d7GFCmjsUq3TftYZqmdSg)

## 基类

您还可以使用抽象基类并转换为具有相同结果的该类型。您将需要使用继承自`UserControl`. 这将避免有两个对象引用（如我上面的示例），因为它可以强制转换为`UserControl`.

上面的例子变成：

```
MyCustomControlType c = (MyCustomControlType)Page.LoadControl(path);
HtmlContent.Controls.Add(c);
c.TransactionData = transaction; 
```

如果每种控件类型的逻辑不同，那么您可能需要转换为每种特定类型（基本上是一个大的 if/else 块）并单独处理每个控件。换句话说，如果您需要根据控件的类型执行不同的操作，您将需要类型感知的逻辑。

为了完整起见，我会提到你也可以使用[DLR](http://msdn.microsoft.com/en-us/library/dd233052.aspx)，但我建议不要这样做。您将放弃编译时类型安全性和性能以减少一些代码。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-06-03T13:41:50.770

您可以创建一个界面并将您的控件添加到 html 页面。前任：

```
private Control _contentControl;

_contentControl = Page.LoadControl("~/Administration/Projects/UserControls/" + controlName);
        ((IEditProjectControl)_contentControl).ProjectId = ProjectId;
        plhContent.Controls.Clear();
        plhContent.Controls.Add( _contentControl );
        _contentControl.ID = "ctlContent";
        Image2.Visible = ((IEditProjectControl)_contentControl).ShowSaveButton;
        SaveButton.Visible = ((IEditProjectControl)_contentControl).ShowSaveButton;
        ((IEditProjectControl)_contentControl).Initialize(); 
```

# java - 如何从一个类到另一个类

> ID：10049278
> 
> 赞同：1
> 
> 时间：2012-04-06T21:08:59.740
> 
> 标签：java

我正在制作一个空中交通管制系统，并且我有一个类飞机，根据是否有飞机来调用名称。如果有 1 架飞机，那么它会说 KLM，如果没有，那么它会说没有飞机。

我正在寻找一种将飞机名称从飞机类到机场类以放入队列的方法。这是平面类的代码

```
package airtrafficcontrolv3;

import java.util.TimerTask;

class Plane
        extends TimerTask
{

    public int nextPlaneLoop = 0;
    public int planes;
    public int fuel;
    public String planeName;

    @Override
    public void run()
    {
        Observer o = new ObserverImpl();
        Subject s = new SubjectImpl();

        if (nextPlaneLoop <= 167)
        {
            //Currently only running 1 or 0 planes...
            planes = (int) (Math.random() * ((2 - 1) + 1));
            //System.out.println("Random generated plane amount: " + planes);
            //System.out.println("Method called, one whole day loop");
            //Adds to the plane in the airspace loop
            nextPlaneLoop++;
            //System.out.println("Loop incrementing: " + nextPlaneLoop);

            if (planes == 0)
            {
                //System.out.println("No fuel is required as no planes are coming in");
                planeName = "No incoming plane";
                //System.out.println("Planes name is: " + planeName);

                System.out.println("Inbound amount of planes: "+planes);
                System.out.println("Inbound: " + planeName);
                System.out.println("Inbound fuel amount: None ");

                System.out.println(" ");
            }
            else
            {
                //Amount of fuel
                fuel = 30 + (int) (Math.random() * ((120 - 30) + 1));
                //System.out.println("Random fuel: " + fuel);
                planeName = "KLM AirFrance";
                System.out.println("Inbound amount of planes: "+planes);
                System.out.println("Inbound: " + planeName);
                System.out.println("Inbound fuel amount: "+fuel);

                System.out.println(" ");
            }
        }
        else
        {
            this.cancel();
            System.out.println("Day Finished");
        }

                s.addObserver(o);
                s.setState(planeName);

                System.out.println(planeName);

                //finalName = planeName;
                Airport point = new Airport();

                //System.out.println(planeName);
    }
} 
```

这就是我的机场课上的内容。

```
/*
 * To change this template, choose Tools | Templates
 * and open the template in the editor.
 */

package airtrafficcontrolv3;
import java.util.*;
import java.util.logging.Level;
import java.util.logging.Logger;

public class Airport
{
    Plane point = new Plane();
    Queue <String> waiting = new LinkedList<String>();

    public Airport()
    {
        //waiting.add(point.);

        while (!waiting.isEmpty())
        {
            System.out.println("Waiting to take off: "+waiting);
            try
            {
                System.out.println("Preparing to taxi: "+waiting.remove());
                Thread.sleep(5000);
            }
            catch (InterruptedException ex)
            {
                Logger.getLogger(Airport.class.getName()).log(Level.SEVERE, null, ex);
            }
        }
    }

} 
```

有没有人可以建议如何从飞机班到机场班的名字。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-06T21:11:12.267

`planeName`在类中创建一个访问器`Plane`（`getName()`是一种常见的样式命名法）。`Airport`每个`Plane`. _

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-06T21:13:18.187

会不会只是`point.planeName`您的机场类呼叫点中有一个计划成员。不知道你到底在问什么...

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-06T21:14:35.783

做一个吸气剂

```
public String getName() {
    return planeName;
} 
```

或者只是通过

```
point.planeName 
```

这也可以，但会被认为是不好的风格。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-06T21:17:34.463

getter 实现在这里不起作用，因为 Plane 中的代码是异步运行的。为了让 Observer 模式在这里工作，Plane 需要包装一个 Observable 的实例。然后在某个时候，需要向该 Observable 注册一个 Airport（需要实现 Observer）实例。

# javascript - 正则表达式在 IE 中没有捕获报价

> ID：10049284
> 
> 赞同：0
> 
> 时间：2012-04-06T21:09:23.670
> 
> 标签：javascript, regex, internet-explorer

我无法让 IE 与我的正则表达式配合得很好。我正在尝试获取背景图片并在网站的其他地方使用它。它适用于除 IE 之外的所有浏览器（当然）。

这是代码：

```
var bgImg = body.css('background-image').replace(/^url\(['"]*(.+)['"]*\).*/, '$1'); 
```

它确实应该可以工作，但由于某种原因，IE 没有捕捉到最后一个报价，而是返回了这个：

[http://mydomain.com/images/bg-image.jpg](http://mydomain.com/images/bg-image.jpg) "

没有`replace`它会返回这个：

url("http://mydomain.com/images/bg-image.jpg")

我的正则表达式不应该处理最后一个双引号吗？如何让 IE 玩起来好听？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-06T21:15:14.197

IE 是正确的。您告诉它匹配任意数量的任意字符，后跟零个或多个引号，后跟一个右括号。IE 将最后一个引号作为“任何字符”的一部分进行匹配，因为它应该是默认的，因为量词是贪婪的。

试试这个正则表达式：

```
/^url\(['"]?([^'"]+)['"]?\)$/ 
```

下一次，在破坏 IE 之前确保你的代码是正确的，好吗？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-06T21:16:16.770

我很难相信其他浏览器没有显示出这种正确的行为。您的第一个捕获组应始终包含引号，因为您使用了一个贪婪的量词，并且您已将结束引号设为可选。

我会建议一个不同的正则表达式：

```
var bgImg = body.css('background-image').replace(/^url\((['"]?)(.+?)\1\).*/, '$2'); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-06T21:16:25.160

您的正则表达式在 Firefox 中也不适用于我。

这是因为`.+`它是贪婪的，并且会尽可能多地消耗字符串。

尝试`.+?`改用。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-06T21:20:27.217

这个正则表达式似乎在 IE 中工作。这是一种不同的方法：

```
/^url\(['"]*([^'")]+)['"]*\).*/ 
```

我不确定为什么另一个不起作用，但这可能与 *.

你的在 IE9 中对我来说失败了，这个正则表达式在这里工作：http: [//jsfiddle.net/jfriend00/yyqB6/](http://jsfiddle.net/jfriend00/yyqB6/)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-04-06T21:30:09.063

如果类型是 IE，请检查[浏览器类型](http://www.quirksmode.org/js/detect.html)，然后再添加一个正则表达式进行替换以选择引号内的文本（s/\"//g），最后执行您想要的任何操作。

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2012-04-06T21:11:41.267

也许不使用正则表达式，而只使用**substr**：

```
var bgImg = body.css('background-image');

bgImg = bgImg.substr(5, bob.length - 7); 
```

# .net - .Net WebClient 在缺少权限时静默失败

> ID：10049294
> 
> 赞同：2
> 
> 时间：2012-04-06T21:10:39.170
> 
> 标签：.net, webclient

[当被要求将文件下载到进程没有写权限的文件夹时， WebClient](http://msdn.microsoft.com/en-us/library/ez801hhe.aspx)静默失败（不抛出异常）：

```
using (WebClient webClient = new WebClient())
{
    webClient.DownloadFile(url, outputPath);
}
if (!File.Exists(outputPath)) logger.Warn("Could not download file."); 
```

该代码在本地服务下运行的 Windows 服务中以每分钟一次的循环运行，试图写入已删除权限的文件夹。在我恢复目标文件夹的适当权限的那一刻，下载开始成功。

这是一种已知的行为吗？它是一个错误吗？检查输出文件的存在是否是确定 DownloadFile 是否成功的正确方法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-06T21:16:18.090

> 这是一种已知的行为吗？

不，根据[文档](http://msdn.microsoft.com/en-us/library/ez801hhe.aspx)：

> 在中间层应用程序（例如 ASP.NET 页面）中使用此方法时，如果执行应用程序的帐户没有访问文件的权限，您将收到错误消息。

因此，如果您在其下运行此代码的帐户没有目标文件夹的写入权限，那么基本上您将得到一个异常。

* * *

> 它是一个错误吗？

我不这么认为。

* * *

> 检查输出文件的存在是否是确定 DownloadFile 是否成功的正确方法？

不，因为如果您没有给定文件夹的权限，[File.Exists](http://msdn.microsoft.com/en-us/library/system.io.file.exists.aspx)将返回 false ，因为文档明确指出：

> 如果调用者没有足够的权限来读取指定的文件，则不抛出异常，并且无论路径是否存在，该方法都返回 false。

所以你可能搞砸了权限。例如，如果您对文件夹具有写入权限但没有读取权限，`DownloadFile`则会成功，但 File.Exists 将返回 false。

# java - 在混淆 java 库的泡菜中

> ID：10049295
> 
> 赞同：0
> 
> 时间：2012-04-06T21:10:40.153
> 
> 标签：java, obfuscation

好吧，我现在有点陷入困境。

我有一个 java 程序，我将其拆分为核心/外部部分。

我将我的核心整理成一个 java 库，外部代码（将公开发布）可以引用。

但是，我不希望这个 java 库的内容是可反编译的。

所以我去找一个好的java混淆器。

使我的情况复杂化的是，我的 java 库并不是完全模块化的——它引用/更改了外部代码的状态（是的，这很糟糕，但无论如何）

我已经尝试过所有高级混淆器（ZKM、allatori 等）和免费混淆器的演示，但它们要么

1.  有非常弱的控制流混淆，这是我需要的
2.  由于对不在 jar 本身但仍被引用的 java 库/依赖项的引用而停止。

有什么建议吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-06T21:14:04.833

混淆不会阻止反编译。它总是可以被反编译。它只是帮助降低你的代码的可读性。只混淆你的逻辑，保持界面不变。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-06T21:40:05.480

1.  如果没有混淆器具有符合您标准的控制流混淆器，那么您将不得不编写自己的混淆器或向现有供应商提交请求以改进他们的产品。

2.  通过混淆器同时运行程序的外部和内部部分。但是为所有外部代码编写[排除规则。](http://www.zelix.com/klassmaster/docs/excludeStatement.html)您还应该为内部代码的公共 API 编写排除规则。如果您的内部代码没有公共 API 层，那么您将遇到困难，因为您的外部代码将不得不通过混淆名称来引用您的内部代码，这将导致非常难以维护和难以维护阅读外部源代码。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-06T21:40:43.093

我赞同 ahanin 的评论。

但是，如果您正在寻找一个混淆器，那么一个具有相当强大规则集的好工具就是[Proguard](http://proguard.sourceforge.net/)。它在需要尽可能少（小）代码的 Android 空间中大量使用。

链接：[Proguard](http://proguard.sourceforge.net/)

# html - 有没有办法让 DIV 自动调整其大小以换行？

> ID：10049298
> 
> 赞同：1
> 
> 时间：2012-04-06T21:10:59.933
> 
> 标签：html, css

我有一个包含一些文本的 div，但是根据不同的情况，这个框可以包含不同数量的文本。有什么方法可以让 div 调整其大小以包装它包含的文本。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-06T21:13:13.433

只需将其包装到另一个容器中，让浏览器通过不应用高度/宽度值来处理大小。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-06T21:15:55.957

尝试其中之一

@CSS3 调整大小：

```
.divClass {resize:both;} 
```

或者

```
.divClass {width:auto; height:auto;min-width:100px;} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-06T21:23:08.343

我认为如果你只使用高度会更好。

```
.Class {height:auto;} 
```

如果你使用宽度：自动，你的网页会扭曲，看起来不会那么好，所以如果你使用固定宽度，你可以使用宽度，比如

```
.Class {height:auto; width: 700px;} 
```

或类似的东西

# c++ - 使用 opencv 2.3.1 进行慢速视频捕获

> ID：10049302
> 
> 赞同：1
> 
> 时间：2012-04-06T21:11:14.760
> 
> 标签：c++, opencv

有没有办法用 opencv 更快地流式传输视频？

我正在使用

```
Mat img;
VideoCapture cap(.../video.avi);
for (;;) {
    cap >> img;
    ...
    here is some calculations
} 
```

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-06T21:17:24.677

由于帧抓取过程非常简单，您遇到的缓慢可能是由于*某些计算*消耗了您的 CPU，从而降低了您的应用程序显示的 FPS。

如果不查看执行此操作的代码，很难判断。

但查明问题根源的简单测试是简单地删除*一些计算*并制作一个简单的应用程序，从视频中读取帧并显示它们。就那么简单！如果此测试完美运行，那么您就知道性能受到正在执行的计算的影响。

祝你好运。

# c# - 用图像路径列中的图像填充 datagridview 列

> ID：10049303
> 
> 赞同：0
> 
> 时间：2012-04-06T21:11:18.343
> 
> 标签：c#, image, datagridview

我有带有字段的 Access 表，其中有一些数据和图像路径。我已经创建了`DataGridViewImageColumn`，然后我不知道如何从某个路径加载一些图像，以及如何使用它。这是表格 [http://imageshack.us/photo/my-images/833/97095287.jpg/](http://imageshack.us/photo/my-images/833/97095287.jpg/)

带有路径的字段是隐藏的，你看，有一些图像列

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-06T22:41:07.490

这是如何将图像放入 DataGridViewImageColumn 中的单元格的示例代码

```
 private void createGraphicsColumn()
    {
        Icon treeIcon = new Icon(this.GetType(), "tree.ico");
        DataGridViewImageColumn iconColumn = new DataGridViewImageColumn();
        iconColumn.Image = treeIcon.ToBitmap();
        iconColumn.Name = "Tree";
        iconColumn.HeaderText = "Nice tree";
        dataGridView1.Columns.Insert(2, iconColumn);
    } 
```

# logback - logback-smtpAppender 将日志邮寄到 gmail

> ID：10049309
> 
> 赞同：3
> 
> 时间：2012-04-06T21:11:53.443
> 
> 标签：logback

我正在尝试将错误日志邮寄到 gmail。但是 logback 不发送任何邮件，我也没有收到任何错误，即使我将用户名更改为随机无效邮件。我认为它不会尝试发送邮件。

我在主函数中记录了 500 封邮件，但它只记录到文件和控制台附加程序中。

```
for(int i=0;i<501;i++){
    logger.error("mail test");
} 
```

请参阅 logback.xml、pom.xml 和控制台输出。

问候，

```
**logback.xml**

   <appender name="EMAIL" class="ch.qos.logback.classic.net.SMTPAppender">
            <smtpHost>smtp.gmail.com</smtpHost>
            <smtpPort>465</smtpPort>
            <SSL>true</SSL>
            <username>myMail@gmail.com</username>
             <password>aaaaa</password>

            <to> myMail@gmail.com</to>
            <from> myMail@gmail.com</from>
            <subject>TESTING: %logger{20} - %m</subject>
            <layout class="ch.qos.logback.classic.PatternLayout">
                <pattern>%date %-5level %logger{35} - %message%n</pattern>
            </layout>
        </appender>
.....
    <root level="TRACE">
        <appender-ref ref="FILE"/>
        <appender-ref ref="STDOUT"/>
        <appender-ref ref="EMAIL" />
    </root>

**pom.xml**

        <dependency>
            <groupId>ch.qos.logback</groupId>
            <artifactId>logback-classic</artifactId>
            <version>1.0.1</version>
        </dependency>

        <dependency>
            <groupId>javax.mail</groupId>
            <artifactId>mail</artifactId>
            <version>1.4.3</version>
        </dependency> 
```

* * *

```
Connected to the target VM, address: '127.0.0.1:51152', transport: 'socket'
23:25:31,588 |-INFO in ch.qos.logback.classic.LoggerContext[default] - Could NOT find resource [logback.groovy]
23:25:31,588 |-INFO in ch.qos.logback.classic.LoggerContext[default] - Could NOT find resource [logback-test.xml]
23:25:31,588 |-INFO in ch.qos.logback.classic.LoggerContext[default] - Found resource [logback.xml] at [file:/D:/projects/TmfCorbaTester/target/classes/logback.xml]
23:25:31,686 |-INFO in ch.qos.logback.classic.joran.action.ConfigurationAction - debug attribute not set
23:25:31,702 |-INFO in ch.qos.logback.core.joran.action.StatusListenerAction - Added status listener of type [ch.qos.logback.core.status.OnConsoleStatusListener]
23:25:31,736 |-INFO in ch.qos.logback.classic.joran.action.LoggerContextListenerAction - Adding LoggerContextListener of type [ch.qos.logback.classic.jul.LevelChangePropagator] to the object stack
23:25:31,737 |-INFO in ch.qos.logback.classic.jul.LevelChangePropagator@8a548b - Propagating DEBUG level on Logger[ROOT] onto the JUL framework
23:25:31,742 |-INFO in ch.qos.logback.classic.joran.action.LoggerContextListenerAction - Starting LoggerContextListener
23:25:31,746 |-INFO in ch.qos.logback.core.joran.action.AppenderAction - About to instantiate appender of type [ch.qos.logback.classic.net.SMTPAppender]
23:25:31,768 |-INFO in ch.qos.logback.core.joran.action.AppenderAction - Naming appender as [EMAIL]
23:25:31,871 |-INFO in ch.qos.logback.core.joran.action.AppenderAction - About to instantiate appender of type [ch.qos.logback.core.rolling.RollingFileAppender]
23:25:31,875 |-INFO in ch.qos.logback.core.joran.action.AppenderAction - Naming appender as [FILE]
23:25:31,925 |-INFO in c.q.l.core.rolling.TimeBasedRollingPolicy - Will use zip compression
23:25:31,927 |-INFO in c.q.l.core.rolling.TimeBasedRollingPolicy - Will use the pattern D:/projects/TmfCorbaTester/TmfCorbaTester-%d-%i.log for the active file
23:25:31,931 |-INFO in ch.qos.logback.core.rolling.SizeAndTimeBasedFNATP@1d87b85 - The date pattern is 'yyyy-MM-dd' from file name pattern 'D:/projects/TmfCorbaTester/TmfCorbaTester-%d-%i.log.zip'.
23:25:31,931 |-INFO in ch.qos.logback.core.rolling.SizeAndTimeBasedFNATP@1d87b85 - Roll-over at midnight.
23:25:31,932 |-INFO in ch.qos.logback.core.rolling.SizeAndTimeBasedFNATP@1d87b85 - Setting initial period to Sat Apr 07 23:19:35 EEST 2012
23:25:31,936 |-INFO in c.q.l.core.rolling.TimeBasedRollingPolicy - Cleaning on start up
23:25:31,936 |-INFO in ch.qos.logback.core.rolling.helper.SizeAndTimeBasedArchiveRemover@f8395f - first clean up after appender initialization
23:25:31,936 |-INFO in ch.qos.logback.core.rolling.helper.SizeAndTimeBasedArchiveRemover@f8395f - periodsElapsed = 64
23:25:31,979 |-INFO in ch.qos.logback.core.rolling.RollingFileAppender[FILE] - Active log file name: D:\projects\TmfCorbaTester/TmfCorbaTester.log
23:25:31,980 |-INFO in ch.qos.logback.core.rolling.RollingFileAppender[FILE] - File property is set to [D:\projects\TmfCorbaTester/TmfCorbaTester.log]
23:25:31,981 |-INFO in ch.qos.logback.core.joran.action.AppenderAction - About to instantiate appender of type [ch.qos.logback.core.ConsoleAppender]
23:25:31,983 |-INFO in ch.qos.logback.core.joran.action.AppenderAction - Naming appender as [STDOUT]
23:25:31,990 |-INFO in ch.qos.logback.core.joran.action.AppenderAction - About to instantiate appender of type [ch.qos.logback.core.ConsoleAppender]
23:25:31,990 |-INFO in ch.qos.logback.core.joran.action.AppenderAction - Naming appender as [STDOUTJACORB]
23:25:31,991 |-INFO in ch.qos.logback.classic.joran.action.LoggerAction - Setting level of logger [jacorb] to DEBUG
23:25:31,991 |-INFO in ch.qos.logback.classic.jul.LevelChangePropagator@8a548b - Propagating DEBUG level on Logger[jacorb] onto the JUL framework
23:25:31,994 |-INFO in ch.qos.logback.classic.joran.action.LoggerAction - Setting additivity of logger [jacorb] to false
23:25:31,994 |-INFO in ch.qos.logback.core.joran.action.AppenderRefAction - Attaching appender named [FILE] to Logger[jacorb]
23:25:31,996 |-INFO in ch.qos.logback.core.joran.action.AppenderRefAction - Attaching appender named [STDOUTJACORB] to Logger[jacorb]
23:25:31,996 |-INFO in ch.qos.logback.classic.joran.action.RootLoggerAction - Setting level of ROOT logger to TRACE
23:25:31,996 |-INFO in ch.qos.logback.classic.jul.LevelChangePropagator@8a548b - Propagating TRACE level on Logger[ROOT] onto the JUL framework
23:25:31,996 |-INFO in ch.qos.logback.core.joran.action.AppenderRefAction - Attaching appender named [FILE] to Logger[ROOT]
23:25:32,001 |-INFO in ch.qos.logback.core.joran.action.AppenderRefAction - Attaching appender named [STDOUT] to Logger[ROOT]
23:25:32,001 |-INFO in ch.qos.logback.core.joran.action.AppenderRefAction - Attaching appender named [EMAIL] to Logger[ROOT]
23:25:32,001 |-INFO in ch.qos.logback.classic.joran.action.ConfigurationAction - End of configuration.
23:25:32,003 |-INFO in ch.qos.logback.classic.joran.JoranConfigurator@14b6bed - Registering current configuration as safe fallback point
mail test
**23:25:32,017 |-INFO in ch.qos.logback.classic.net.SMTPAppender[EMAIL] - SMTPAppender [EMAIL] is tracking [1] buffers**
mail test
mail test
mail test
mail test
..
..
. 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2015-04-07T21:56:57.530

这对我有用：

```
<appender name="EMAIL" class="ch.qos.logback.classic.net.SMTPAppender">
        <smtpHost>smtp.gmail.com</smtpHost>
        <smtpPort>587</smtpPort>
        <STARTTLS>true</STARTTLS>
        <username></username>
        <password></password>
        <to></to>
        <from></from>
        <subject></subject>
        <layout class="ch.qos.logback.classic.html.HTMLLayout"/>
        <asynchronousSending>false</asynchronousSending>
</appender> 
```

而这并没有：

```
<asynchronousSending>true</asynchronousSending> 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-07-09T19:11:22.170

您是否仔细检查了gmail设置？logback 文档中有一个示例：http: [//logback.qos.ch/manual/appenders.html#gmailSTARTTLS](http://logback.qos.ch/manual/appenders.html#gmailSTARTTLS)

其他一切对我来说都很好。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-05-30T12:35:38.510

我猜你的 pom.xml 中缺少几个罐子

1.  JAVA激活jar
2.  slf4j
3.  回退核心

检查以下链接：

[https://github.com/abdulwaheed18/Slf4jTutorial/blob/master/src/com/waheed/tutorial8/Application8.java](https://github.com/abdulwaheed18/Slf4jTutorial/blob/master/src/com/waheed/tutorial8/Application8.java) [https://github.com/abdulwaheed18/Slf4jTutorial/blob/master/sample8.xml](https://github.com/abdulwaheed18/Slf4jTutorial/blob/master/sample8.xml)

# java - 使用 API（Java？）在 Facebook 粉丝页面上发布状态

> ID：10049310
> 
> 赞同：2
> 
> 时间：2012-04-06T21:11:56.993
> 
> 标签：java, facebook, facebook-graph-api

我刚刚开始代表管理员在 FB 粉丝页面上自动发布消息（例如，我在 eclipse 中运行代码，它应该在页面上发布消息）。我阅读了几个关于堆栈溢出的类似问题，浏览了 FB API 上的文档，但似乎我迷失在这片广阔的海洋中。我几乎没有疑问。

1.  我是否需要在 Facebook 上创建一个可以与其 API 交互的 APP。我不能在我的代码（Java）中直接与它们交互吗？
2.  发布状态的请求流程是什么？我的代码 -> 我的 FB 应用程序 -> 我的页面或我的代码 -> 我的 FB 页面
3.  我看到两种不同类型的身份验证，服务器端和客户端。它们是否都需要，或者我可以选择其中之一。
4.  任何指向此示例代码的链接都将非常有帮助。

我需要在比赛中展示这个，而且只有 1-2 天，搞清楚东西需要太多时间。任何帮助，将不胜感激。

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-06T21:26:37.823

**1**您需要一个 Facebook 应用程序，通过该应用程序与 Facebook 进行通信。应用程序可以请求各种权限，当用户授予时，您可以访问用户的数据或页面。特别感兴趣的是`manage_pages`权限（请参阅[权限概述](https://developers.facebook.com/docs/authentication/permissions/)）。

**2**基本步骤是：应用程序请求执行某些操作的权限，用户授予它们，然后您获得一个访问令牌，您可以使用该令牌与 API 进行交互。因此，最初的流程是：您的代码 > 应用程序（和用户）> Facebook API。之后，它是您的代码 > Facebook API（访问令牌作为 URL 中的 GET 参数传递）。

以上是如果您正在做与用户相关的事情。对于页面，它的工作方式有些相同，但您仍然需要用户访问令牌。如果您有`manage_pages`权限，您可以访问`/me/accounts`（使用用户访问令牌），您将收到包含页面访问令牌的响应。然后，该令牌可用于代表该用户在页面上执行操作。这仅适用于用户是页面管理员的情况。

**3**到目前为止，我只使用了客户端身份验证，但也可以只使用服务器端身份验证。一些访问令牌的寿命比其他令牌长。例如，只要用户登录 Facebook，用户访问令牌就有效。但是其他访问令牌（例如页面）的寿命更长。然后，您可以存储访问令牌并重复使用它。

**4**在撰写本文时，我对 Facebook API 的 Java 库并不熟悉，所以在这里我无法为您提供帮助。

# android - 安装后修改 SharedPreferences（通过 BackupManager 恢复）

> ID：10049311
> 
> 赞同：0
> 
> 时间：2012-04-06T21:11:58.090
> 
> 标签：android, sharedpreferences, android-backup-service

我的应用程序能够`SharedPreferences`使用`BackupAgentHelper`类进行备份和恢复。但是有两个条目不能恢复。

有没有办法在再次恢复后重置它们？

我不想将它们放在不同`SharedPreference`的文件中，它们必须在同一个文件中。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-06T21:25:26.043

使用 BackupAgent 的 onBackup 或 onRestore 方法清除操作之前或之后的值。

# windows - 你如何在 Windows 中运行 Vim？

> ID：10049316
> 
> 赞同：42
> 
> 时间：2012-04-06T21:12:48.037
> 
> 标签：windows, shell, vim

我刚刚安装了 gVim，并尝试使用通常适用于 linux 的“vim myfile.java”技术打开文件并进行编辑。但不幸的是，这似乎不起作用。我也尝试过“gvim myfile.java”，但这也不起作用。

有谁知道如何使用 Windows Powershell 或其他技术打开 vim（并像在 linux 中一样使用它）？

* * *

## 回答 #1

> 赞同：42
> 
> 时间：2012-04-07T02:05:40.577

安装时`gVim`：
请确保`[✓] Create .bat files for command line use`已选中。
它将在以下位置创建几个`.bat`文件`C:\Windows\`：

```
C:\>cd %windir%
C:\WINDOWS>dir /b *.bat
evim.bat
gview.bat
gvim.bat
gvimdiff.bat
view.bat
vim.bat
vimdiff.bat
vimtutor.bat 
```

请注意：`C:\WINDOWS`已经在`PATH`环境变量中。
当您输入`vim`命令行时，`C:\WINDOWS\vim.bat`将启动。
如果您未选中上述复选框，则需要`PATH`手动修改。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2014-09-25T14:50:05.597

补充一下，我现在在一个受高度控制的 Windows 工作站上，并且无法访问太多。下载我通常使用的“可执行安装程序”并没有创建`bat`文件，也没有出于某种原因，`vim.exe`虽然`gvim.exe`已为我安装在`vim74`目录中并且工作正常。因此，尽管我还需要设置`PATH`，但在我的 VIm 运行时文件夹中没有`bat`文件`C:\WiNDOWS`也没有任何命令行可执行文件可以调用，这意味着`vim`从命令行（或 Powershell）调用不起作用。

我猜安装的某些部分正在创建与命令行相关的东西，显然包括`vim.exe`，当您没有管理员权限时，它不会正常恢复。

无论哪种方式，“正确”的做法似乎是像往常一样将您设置为您的 vim 可执行文件夹（请注意，[如果您没有 admin privs](https://serverfault.com/a/548112/110976)`PATH`，这可能比平时更困难），然后下载“Win32控制台可执行文件”从与您已经安装的版本匹配的[通常下载页面](http://www.vim.org/download.php)中，挖掘出您刚刚下载的那个 zip，并将其放入与.`gvim``vim.exe``gvim.exe`

查看可执行安装程序确实“完全”工作的另一个框，vim.bat 文件中有一些没有为我安装的关于“为 Win95 收集 VIMARGS 中的参数”`if .%OS%==.Windows_NT goto ntaction`等内容，但没有任何至少在Win7上这似乎不是问题。;^)

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2017-10-30T13:11:31.293

Windows 10 具有适用于 Windows 的 linux 子系统。所以你可以在windows中安装bash，从bash中你可以使用vim。我发现它更方便。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2019-01-29T13:12:39.923

在您的窗口上安装 gVim 并在安装 gvim 时启用“.bat”，然后单击下一步，完成。您可以在窗口上使用 vim。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2021-04-16T13:58:04.997

由于我的工作站受到限制，我不得不将我的 vim 实例本地安装到以下文件夹：`%LocalAppData%\Vim`

但是像其他人建议的那样仅仅改变一个环境变量是不够的，因为批处理文件不在安装目录中（例如`vimdiff`）。所以我[弄清楚了这些来自哪里](https://github.com/vim/vim/blob/master/src/dosinst.h)，并制作了自己的批处理文件以将它们添加到环境变量中。为了帮助您制作这些批处理文件，我提供了下面的命令列表供您在 vim 安装目录中运行（如果`install.bat`先将命令保存到文件，请将所有`%`字符替换`%%`为转义它）：

```
echo @echo off > evim.bat
echo gvim.exe -y %* >> evim.bat

echo @echo off > view.bat
echo vim.exe -R %* >> view.bat

echo @echo off > gview.bat
echo gvim.exe -R %* >> gview.bat

echo @echo off > vimdiff.bat
echo vim.exe -d %* >> vimdiff.bat

echo @echo off > gvimdiff.bat
echo vim.exe -d %* >> gvimdiff.bat 
```

然后你必须去开始>搜索'编辑你帐户的环境变量'>查找'路径'>编辑>添加一个新的子条目`%LocalAppData%\Vim\vim82`。最后，您可能需要关闭并打开命令提示符，或者杀死`explorer.exe`并重新启动它。

# php - PHP数据库获取变量

> ID：10049318
> 
> 赞同：1
> 
> 时间：2012-04-06T21:13:01.183
> 
> 标签：php, mysql

我有以下代码行，除了一个故障外，它可以正常执行。它会将变量名打印到数据库中。

我在我的一个脚本中使用了这段代码：

```
$con = mysql_connect("MyServer","MyDB","myPwd");
mysql_select_db("MyDB", $con);
$sql = "INSERT INTO `MyDB`.`Shipping` (`ID`, `FIRSTNAME`, `LASTNAME`, `ADDRESS1`, `ADDRESS2`, `CITY`, `STATE`, `ZIP`, `ORDERNUMBER`, `SHIPPINGTYPE`, `item1`, `item2`, `item3`, `item4`, `item5`, `item6`, `item7`, `item8`, `item9`, `item10`) VALUES (NULL, \'$first_name\', \'lname\', \'addr\', \'\', \'city\', \'state\', \'zip\', \'ordernum\', \'\', \'0\', \'0\', \'0\', \'0\', \'0\', \'0\', \'0\', \'0\', \'0\', \'0\');";
mysql_query("$sql");
mysql_close($con); 
```

此代码将以下内容打印到数据库：

```
$first_name lname   addr        city    state   zip 0       0   0   0   0   0   0   0   0   0   0 
```

请注意，打印的是变量名称，而不是变量的内容。我怎样才能让它打印出变量内容？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-06T21:21:51.723

对于一个你有一个报价问题。您似乎有双引号，然后转义了单引号。如果您的字符串是双引号，请不要转义您的单引号。

似乎`$first_name`应该起作用。这是确切的代码吗？因为如果你在整个事情周围有单引号，它会创建你描述的输出。

您所有其他列都不是变量，因此很难知道您要做什么。如果您不打算使用它们，为什么要引用它们呢？

在您的`mysql_query`电话中不要`$sql`再次引用。

最后检查`mysql_error()`错误。可能是您在数据库中看到了一些旧的东西，而您的代码根本不起作用。

考虑使用[PDO](http://php.net/PDO)。与原生 mysql_* 接口相比，它支持占位符、更好的安全性和更好的调试。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-06T21:38:42.153

> 请注意，打印的是变量名称，而不是变量的内容

这是因为您没有将变量传递给插入语句，而是传递了 undefined(?) 常量；lname、addr 等。你应该传入你赋值给的变量：（假设）$lname、$addr 等。

此外，您不需要为 ID 列传入 NULL。如果设置为 auto_increment，数据库将为您创建此值。

您还应该利用表架构定义的默认列值，因此您最终不会传入具有默认值的大量变量列表，例如，如果您将 a`DEFAULT 0`作为 item1、item2 的架构的一部分, item3 等，您可以简单地进行以下插入：

```
$sql =
"INSERT INTO `MyDB`.`Shipping` (`FIRSTNAME`, `LASTNAME`, `ADDRESS1`, `CITY`, `STATE`, `ZIP`, `ORDERNUMBER`) VALUES ('$first_name', '$lname', '$addr', '$city', '$state', '$zip', '$ordernum');"; 
```

数据库将自动为您填充 0 的 item1、item2 等列。

正如 cambraca 所提到的，如果您像这样将变量直接传递到您的查询中，您将面临[SQL 注入](http://en.wikipedia.org/wiki/SQL_injection)的风险。您应该阅读如何[准备](http://us2.php.net/mysqli_prepare)查询，这也将迫使您使用 mysqli（与过时的 mysql）api。或者更好的是，阅读[PDO](http://us2.php.net/manual/en/pdo.prepare.php)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-06T21:16:50.137

我想不要在 PHP 中的字符串中使用内联变量，当你不需要时你正在转义 '。试试这个：

```
$con = mysql_connect("MyServer","MyDB","myPwd");
mysql_select_db("MyDB", $con);
$sql = "INSERT INTO `MyDB`.`Shipping` (`ID`, `FIRSTNAME`, `LASTNAME`, `ADDRESS1`, `ADDRESS2`, `CITY`, `STATE`, `ZIP`, `ORDERNUMBER`, `SHIPPINGTYPE`, `item1`, `item2`, `item3`, `item4`, `item5`, `item6`, `item7`, `item8`, `item9`, `item10`) VALUES (NULL, '".$first_name."', 'lname', 'addr', '', 'city', 'state', 'zip', 'ordernum', '', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0');";
mysql_query($sql);
mysql_close($con); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-06T21:17:35.973

将插入语句更改为：

```
$sql = "INSERT INTO `MyDB`.`Shipping` 
  (`ID`, `FIRSTNAME`, `LASTNAME`, `ADDRESS1`, `ADDRESS2`, `CITY`, 
    `STATE`, `ZIP`, `ORDERNUMBER`, `SHIPPINGTYPE`, `item1`, `item2`, 
    `item3`, `item4`, `item5`, `item6`, `item7`, `item8`, `item9`, `item10`)
  VALUES (NULL, '{$first_name}', 'lname', 'addr', '', 'city', 'state',
    'zip', 'ordernum', '', '0', '0', '0', '0', '0', '0', '0',
    '0', '0', '0');"; 
```

另外，请检查您`$first_name`的值是否正确分配。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-04-06T21:24:55.070

而不是使用`\'$first_name\'`替换它，`\"$first_name\"`其他变量也一样。

# android - Apple/Google 是否提供 iOS 或 Android 中 iCal 现场支持的规范？

> ID：10049320
> 
> 赞同：11
> 
> 时间：2012-04-06T21:13:06.907
> 
> 标签：android, ios, icalendar, dday

我正在尝试通过 iCal 发布专有软件日历（使用 DDay.iCal 包，如果这很重要），以便客户可以在他们的手机或平板电脑（或任何其他支持 iCal 的软件中查看他们的约会，例如Outlook 或谷歌日历）。不幸的是，iCal 规范似乎为这些消费者未使用的许多字段（例如评论、状态、类别、类等）提供了支持，而现在我在黑暗中拍摄试图弄清楚找出支持的内容以及它在设备上的显示位置。

**Apple（或 Google 或 Microsoft）是否发布了他们支持的 iCal 字段列表？**

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-28T16:47:48.760

iCal 格式有据可查。请在此处找到例如信息：[http ://en.wikipedia.org/wiki/ICalendar](http://en.wikipedia.org/wiki/ICalendar)

# android - 在回归测试（robotium）中模拟来电？

> ID：10049325
> 
> 赞同：1
> 
> 时间：2012-04-06T21:13:41.260
> 
> 标签：android, junit, robotium

我正在使用robotium 来测试我的应用程序。它的部分功能涉及它在接收来电时的行为。问题是，我似乎无法弄清楚如何在测试用例中以编程方式模拟这个。

我认为这必须是可能的，否则任何依赖传入/传出呼叫事件的应用程序都无法进行回归测试。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-29T12:21:52.673

据我所知，来电等无法使用 Robotium 进行模拟。但是，它们可以通过模拟器使用 telnet。请参阅这篇文章：[使用 android 模拟器发送和接收文本](https://stackoverflow.com/questions/4325669/sending-and-receiving-text-using-android-emulator)

# python - 在python中对列表的所有元素进行减法和除法

> ID：10049328
> 
> 赞同：0
> 
> 时间：2012-04-06T21:13:48.840
> 
> 标签：python

一个非常基本的问题..但我总是执行不好。

我有一个整数列表。

然后我有一个 int "k" 和 "j"

我想做这样的事情：

```
for ele in foo_list:
   ele = (ele - k) / j 
```

是否有一个 pythonic 语法糖让这个东西看起来很漂亮。另外，我有一种不好的感觉，这是一种非常糟糕的方式并且容易出现错误..

做手术安全吗

```
 val = function(val) 
```

所以你接受一个输入，你的输出被保存到输入中。这个方法可以在某个时候变成“Gotcha”吗？或者进行此类操作是否安全？谢谢

谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-06T21:16:21.413

你的代码应该是

```
foo_list = [ (ele - k) / j for ele in foo_list] 
```

编辑：回答你的第二个问题，`val = f(val)`很好。但是您尝试使用它的方式不起作用：`ele`它不是指向列表中元素的指针，而是恰好指向该元素的变量名。当您为它分配其他内容时，您正在使该变量名称指向其他地方：您没有写入它指向的位置。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-06T21:18:06.143

或照常映射：

```
foo_list = map(lambda ele: (ele-k)/j,foo_list) 
```

# javascript - Javascript v3 Fusion Table Layer - where 子句中的 ROWID

> ID：10049333
> 
> 赞同：1
> 
> 时间：2012-04-06T21:14:37.580
> 
> 标签：javascript, google-maps-api-3, google-fusion-tables

如果这已在其他地方解决，请原谅；我进行了搜索，但找不到有关此特定主题的任何内容。基本上，可以在使用 Javascript v3 api 的融合查询的 where 子句中使用 ROWID，例如：

```
 var locationLayer = new google.maps.FusionTablesLayer({ 
       query: { 
           select: 'Address', 
           from: 3349066, 
           where: "'ROWID' in ('2076','2077',....)" 
       } 
   }); 
   locationLayer.setMap(map); 
```

此查询适用于不包含 ROWID 的 where 子句，但我的语法可能有问题？谢谢您的帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-23T17:14:03.300

just to let everyone know, I received this response from Google regarding using the ROWID in the where clause in the maps API:

April 6, 2012

Hi [Abram],

No, I don't think the rowid filter works in the Maps API. Feel free to open a feature request:

[http://code.google.com/p/fusion-tables/issues/list](http://code.google.com/p/fusion-tables/issues/list)

Cheers, Kathryn

# html - 标题后面出现多余的字母，很奇怪

> ID：10049335
> 
> 赞同：0
> 
> 时间：2012-04-06T21:14:51.290
> 
> 标签：html, css, fonts, font-face

我有一个自定义字体，我使用 @font-face 添加到我的 css 规则中。它是一种希伯来字体，我在整个网站的段落和标题中都使用它，我对此没有任何问题。

我还使用顶部导航栏中的字体作为标题。由于某种原因，在标题中添加超过一定数量的字母后，标题后面会出现一个额外的字母。这个字母是不可选择的，一旦我选择了文本的一部分（？？？），它就会消失。

这是它的外观：

![在此处输入图像描述](../Images/228f4ae4bb88787d6707f3432956f70a.png)

这就是我选择一些文本时发生的情况：

![在此处输入图像描述](../Images/a6af7d78f6c0af2fe2e3b41fa16391d3.png)

这是html：

```
<div id="header_body" dir="rtl">
    <div id="slogan">
        <h1>מאגר מאמרים ואפליקציות מקוריות</h1>
        <h2>בנושאים: בניית אתרים, תכנות, עיצוב וקידום</h2>
    </div>
</div> 
```

和CSS：

```
#header_body {
background:transparent url('img/header.jpg') no-repeat center top;
height:76px;
}
#slogan {
    margin:11px 216px 0 0;
    letter-spacing:2px;
    opacity:0.9;
    float:right;
}
#slogan h1 {font:italic bolder 28px "Yoav";text-shadow:1px 1px 0 #b85d1b,2px 2px 0 white,3px 3px 4px #b85d1b;color:#f37a21}
#slogan h2 {font:italic bolder 20px "Yoav";text-shadow:1px 1px 0 #111,2px 2px 0 white,2px 2px 4px #333;color:#888} 
```

# python - Common Lisp：使用与 lisp 进程不同的工作目录启动子进程

> ID：10049338
> 
> 赞同：4
> 
> 时间：2012-04-06T21:14:57.233
> 
> 标签：python, bash, common-lisp, dos, ccl

假设我有一个目录 A 和子目录 B。我 cd 进入 A 并启动 lisp。在那个 lisp 进程中，我想启动一个 Python 子进程，其中 Python 将 B 视为其当前工作目录。lisp 进程需要在 A 中有 cwd，python 进程应该在 B 中有 cwd。我如何以跨平台、简单的方式做到这一点？

我正在寻找一种适用于 CCL 和 SBCL（可能使用“运行程序功能”）并且适用于 Windows、Linux 和 OS X 的解决方案。

我查看了 CCL 运行程序文档，并没有看到更改已启动进程的 cwd 的方法。

我查看了 Python 命令行参数，但没有看到会更改 python 进程的 cwd 的参数。

我想到了一个运行程序调用 'cd B; python ...'，但我不确定它是如何工作的，因为它实际上运行了两个程序；cd，然后是 python。

Python 代码作为输入（作为文件）提供，因此我无法更改任何代码（通过添加 os.chdir() 调用或类似方法）。

将 python 输入文件作为子进程启动的 python 包装文件并不理想，因为我正在发送标准输入并监听由 lisp 启动的 python 进程的标准输出。在 lisp 和评估输入文件的 python 进程之间添加另一个子进程意味着我需要做很多 stout/stdin 中继，我觉得这会很脆弱。

krzysz00 的方法效果很好。由于目录更改是在 lisp 中处理的，因此在启动 python 进程之前，这种方法将适用于启动不同子目录中的其他进程（不仅仅是 python）。

对于文档，这是我使用适用于 SBCL 和 CCL 的 krzsz00 方法的代码。请注意，它使用了 Hoyte 的 defmacro！[来自Let Over Lambda](http://letoverlambda.com)的宏，可以轻松避免不需要的变量捕获：

```
#+:SBCL
(defun cwd (dir)
  (sb-posix:chdir dir))

(defun getcwd ()
  #+SBCL (sb-unix:posix-getcwd)
  #+CCL (current-directory))

(defmacro! with-cwd (dir &body body)
  `(let ((,g!cwd (getcwd)))
     (unwind-protect (progn
                       (cwd ,dir)
                       ,@body)
     (cwd ,g!cwd)))) 
```

用法：

```
(with-cwd "./B"
  (run-program ...)) 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-06T23:09:52.430

要运行外部程序（例如可移植的 python 进程），请参见[external-program](http://common-lisp.net/project/external-program/)。要更改当前工作目录，请使用`cwd`文件[http://files.b9.com/lboot/utils.lisp](http://files.b9.com/lboot/utils.lisp)中的这个稍作修改的（公共域）函数，该文件在下面复制。

```
(defun cwd (&optional dir)
  "Change directory and set default pathname"
  (cond
   ((not (null dir))
    (when (and (typep dir 'logical-pathname)
           (translate-logical-pathname dir))
      (setq dir (translate-logical-pathname dir)))
    (when (stringp dir)
      (setq dir (parse-namestring dir)))
    #+allegro (excl:chdir dir)
    #+clisp (#+lisp=cl ext:cd #-lisp=cl lisp:cd dir)
    #+(or cmu scl) (setf (ext:default-directory) dir)
    #+cormanlisp (ccl:set-current-directory dir)
    #+(and mcl (not openmcl)) (ccl:set-mac-default-directory dir)
    #+openmcl (ccl:cwd dir)
    #+gcl (si:chdir dir)
    #+lispworks (hcl:change-directory dir)
    #+sbcl (sb-posix:chdir dir)
    (setq cl:*default-pathname-defaults* dir))
   (t
    (let ((dir
       #+allegro (excl:current-directory)
       #+clisp (#+lisp=cl ext:default-directory #-lisp=cl lisp:default-directory)
       #+(or cmu scl) (ext:default-directory)
       #+sbcl (sb-unix:posix-getcwd/)
       #+cormanlisp (ccl:get-current-directory)
       #+lispworks (hcl:get-working-directory)
       #+mcl (ccl:mac-default-directory)
       #-(or allegro clisp cmu scl cormanlisp mcl sbcl lispworks) (truename ".")))
      (when (stringp dir)
    (setq dir (parse-namestring dir)))
      dir)))) 
```

结合这两个函数，你想要的代码是：

```
(cwd #p"../b/")
(external-program:start "python" '("file.py") :output *pythins-stdout-stream* :input *pythons-stdin-stream*)
(cwd #p"../a/") 
```

这将`cd`发送给 B，像 by 一样运行 python 进程`python file.py &`，将 python 进程的 stdin/stdout 发送到指定的流（查看`external-program`文档了解更多详细信息），最后执行另一个`cwd`将 lisp 进程返回给 A。如果 lisp 进程应该等到 python 进程完成，使用`external-program:run`而不是`external-program:start`.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-03-20T22:38:57.000

我最终将 krzysz00 的建议写入了一个可以在[此处](https://github.com/Inaimathi/cl-cwd)找到的包中。

然后有人指出[UIOP](http://common-lisp.net/gitweb?p=projects/asdf/asdf.git;a=blob;f=uiop/README)带有`getcwd`and `chdir`。如果你有一个相当新的 lisp，UIOP 应该包含在你的[`asdf`](http://www.cliki.net/asdf).

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-06T21:26:27.457

我不知道 lisp 是什么，但这可以工作吗？

```
 import subprocess
  subprocess.Popen('python myscript.py', cwd='B') 
```

[http://docs.python.org/library/subprocess.html](http://docs.python.org/library/subprocess.html)

# c - d2：参数存储类与在 D 之外实现的功能的互操作性

> ID：10049343
> 
> 赞同：1
> 
> 时间：2012-04-06T21:15:28.920
> 
> 标签：c, interop, d

### `const`（和`in`）

考虑有 C 函数：

```
unsigned int foo(const unsigned int a); 
```

`const`对生成的代码没有影响，就好像代码通过编译一样，`const`如果没有，什么都不会破坏`const`——所以 C 编译器在编译时只使用它作为代码契约说明符。

是否有任何努力在 D 中编写`uint foo(in uint a);`或`uint foo(const uint a);`调用此函数？这是否可以帮助 D 编译器生成更有效的调用代码`foo`，或者这将不起作用（至少对于值类型参数）？

### `ref`和`out`

有C函数

```
unsigned int bar(unsigned int *a); 
```

我是否必须`uint bar(uint* a);`在将其翻译为 D 时使用指针语法，或者我可以写`uint bar(ref uint a);`（或者`uint bar(out uint a);`，如果我知道这`a`仅用于输出，来自文档`bar`）？`ref`和下是否还有其他隐藏机制`out`，或者它们看起来只是简单的指针？`out`当调用超出 D 范围时，D会生成“胶水代码”以将参数初始化为其默认值吗？

**更新 1：**我编写了简单的代码来测试如何在参数中处理`ref`s 和`out`s — 它们实际上至少对于`int`s 来说似乎是普通指针，但`out`在传递时不会重置为初始值 — C 端仍然可以读取它的值并修改它，所以它有效地表现得像`ref`。我不确定，当我以这种方式使用东西时，是否会出现与 GC 相关的问题。

**Update2：**在函数结果中使用`ref`而不是指针也可以按预期方式工作。`const`仍然未经测试，我不知道如何检查它而不需要反汇编我的程序。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-06T21:40:51.143

由于 C 不会破坏参数，因此事物将与任何类型限定符链接。

程序员有责任确保在 extern(C) 函数原型中声明的 D 类型限定符实际上与 C 函数的作用相匹配。

我不会使用 ref 或任何带有 C 代码的 ref，因为 C 中不存在引用，因此它可能不会按照您的预期进行（如果确实如此，它可能随时中断，因为您处于未指定状态世界）。

编辑：关于 const。C 中的 const 和 D 中的 const 不是一回事（它在 D 中是可传递的，而不是在 C 中）。再次由程序员来确定函数的参数是否可以根据 D 语义进行 const 限定。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-06T22:37:18.067

`in`（与 相同`const scope`）在 C 中不存在，因为在 C`scope`中不存在。并且`out`也不`ref`存在于 C 中。不要将它们与`extern(C)`函数一起使用。如果你在函数的参数中使用它们，编译器可能会报错`extern(C)`，但如果没有，我也不会感到惊讶。如果它碰巧奏效了，那你就“幸运”了。它可能随时停止工作。如何`ref`和如何`out`实现是编译器的实现细节。通常，您应该只对实际存在于 C 中的函数使用修饰符`extern(C)`。D 的编译器不会做任何魔术来使 D 的东西在`extern(C)`函数上工作。`extern(C)`

 *我知道的唯一两个例外是`pure`and `nothrow`，因为它们根本不影响调用约定，只是 D 是否允许您从某些函数中调用它们。因此，您可以将 C 函数标记为`pure`和/或`nothrow`。但是如果你用 标记它（或者你可能会得到讨厌的错误），你最好确保该函数实际上是纯函数`pure`- 与`nothrow`. 从技术上讲，@safe、@trusted 和 @system 也可以使用，但 C 函数确实应该保留为默认值 - @system - 因为它们是 C 函数。

不，将参数标记为 C 函数`const`不太可能帮助任何优化。如果参数是值类型，那么`const`从调用者的角度来看是没有意义的。无论如何都会复制该参数。它只与引用类型有关。在 的情况下`extern(C)`，这将仅限于带有指针的指针和结构（直接或间接）。那里*可能*有一些优化，但我不会打赌——尤其是 dmd，它通常不会像 gdc 和 ldc 那样优化代码。充其量，编译器可以做的是确定在该调用之后，传入的变量没有改变，这可能会在调用者中启用其他优化，但它高度依赖于调用者和编译器。

更值得关注的是 C 参数是否真的是`const`. 一般来说，你很好，但在 C 中，丢弃`const`和更改变量是合法的，而在 D 中，[它不是](https://stackoverflow.com/questions/4219600/logical-const-in-d)。这主要可能与`immutable`数据有关（字符串文字是一个主要示例）。如果有任何东西试图实际改变数据，您将面临段错误或更糟的风险。一般来说，这不应该是标记为的 C 函数参数的问题`const`（尽管有时可能是这样），但这绝对意味着将参数标记为`const`C 没有时几乎肯定是一个坏主意。如果你这样做，你需要确保变量的值永远不会被 C 函数实际改变。因为如果你把它标记为`const`然后 C 函数对其进行变异，您将遇到错误。

所以，总而言之，我想说的是，一般来说，你应该只`extern(C)`用 C 修饰符标记函数，而不是 D 特定的修饰符，并且你通常不应该将参数标记为`const`除非它们在 C 中以这种方式标记。如果你知道C函数实际上是什么`pure`，你可以把它标记为`pure`。如果你知道它实际上是`nothrow`，你可以用 标记它`nothrow`。如果您知道 C 函数从未改变过参数，那么您可以将其标记为`const`. 但是你应该对此非常保守，否则你*会*在你的代码中造成讨厌的错误。

如果您还没有阅读这些页面，请阅读：

[http://dlang.org/interfaceToC.html](http://dlang.org/interfaceToC.html)
[http://dlang.org/htomodule.html](http://dlang.org/htomodule.html)*

# jquery - 在切换时更改多个 TD 元素中的 qTip 工具提示

> ID：10049346
> 
> 赞同：0
> 
> 时间：2012-04-06T21:15:38.747
> 
> 标签：jquery, html, css

我在使用带有 jQ​​uery 的 qTip 插件时遇到问题。我创建了一个 js fiddle 来看看它在做什么。我不确定如何解决这个问题（链接在问题描述之后）

所以我有一份清单。你会看到三个`<tr>`，每个都有一个工具提示。如果任务未完成，工具提示会显示“任务未完成”。如果任务完成，工具提示会显示“任务完成”。

当您单击“切换”时，它应该更改`<span>`淡入`<tr>`/淡出并切换类并将工具提示从“完成”更改为“未完成”，反之亦然。

其他一切似乎都正常工作。它改变了类，淡入/淡出，甚至改变了标题属性。

问题是 qTip 插件仅将单元格中的工具提示直接更改为切换右侧。它不会更改以下两个单元格中的工具提示。

一切似乎都是为了让它正常工作。有什么想法吗？这真让我抓狂！！

[JS小提琴](http://jsfiddle.net/SNCCn/4/)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-06T22:44:57.987

两种可能：

**1）**代替

```
.attr('title', 'This task is not yet complete.'); 
```

采用

```
.qtip('option', {'content.text': 'This task is not yet complete.'}); 
```

qTip 在初始化时实际上复制了`title`属性（它不绑定到它），所以为了改变 qTip 你需要通过[qTip 方法](http://craigsworks.com/projects/qtip2/docs/api/#methods)来改变它。

**2)**将 qTip 的内容设置为 jQuery 对象。例如，将`data-qtip`属性添加到您的标题元素，这将是（例如）qtip 内容容器的 id（为每个 qtip 添加额外的 div）：

```
$('[data-qtip]').each(function() {
    var q = $(this).attr('data-qtip');
    var content = $('#'+q);

    $(this).qtip({
        content: content, // here we reference the jQuery object
        position: {
            my: 'bottom center',
            at: 'top center'
        },
        style: { classes: 'ui-tooltip-dark ui-tooltip-rounded' }
    }
}); 
```

现在改变 div 的内容会改变 qtip（因为这实际上是一个绑定）。

我个人认为第二种解决方案更好。它使您可以很好地控制 qTip，并且当我处理动态工具提示（例如带有交互式图表的工具提示）时，它对我来说非常有效。

# jquery - 使用自定义 rel 值还是更好的方法？

> ID：10049347
> 
> 赞同：4
> 
> 时间：2012-04-06T21:15:39.450
> 
> 标签：jquery, html, asp.net-mvc-3, link-tag

*我正在尝试找到一种方法来在我的网页中指示我有一个或多个与之相关*的自定义资源（类似于 CSS 文件），以便可以在页面加载/准备使用 jquery 时下载和解释它们。

自定义资源的主要目的是通过 jquery 选择器告诉页面哪些数据绑定规则应用于其元素，尽管我也对更通用的解决方案感到好奇，因为它真的可以应用于任何东西。

到目前为止，我能想到的最佳选择是`<link>`在页眉中包含指向资源的链接作为元素，就像我对 CSS 资源所做的那样。由于没有`rel`与我的资源文件中使用的数据类型匹配的预定义值，我可能必须定义一个自定义`rel`值。

在做了一些研究之后，我发现通常不鼓励做任何需要自定义标签、属性（保存`data-*`在 HTML5 中）或标准字段值（例如`rel`）的事情。这些建议通常归结为找到一种“标准”方法来实现预期结果。

*不鼓励做任何非标准的*事情是有道理的，但我不确定是否有*标准*的方法来实现我所追求的目标。有什么建议么？

* * *

本例中的自定义资源实际上是 JSON。在服务器端，我定义了一个类似于 CSS 的文件格式，指示要通过 jquery 选择器添加到元素的属性，然后将其转换为 JSON 以供网页解释。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-07-17T04:15:12.423

根据[Darin 的建议](https://stackoverflow.com/questions/10049347/link-with-custom-rel-value-or-maybe-a-better-way/17691007#comment12858185_10049347)，我已经能够`<script>`使用服务器生成的 javascript 动态填充标签（非常简单的 javascript 变量分配给我的服务器端 JSON 对象）。不幸的是，这并不是我真正想要的效果。

他的建议确实让我找到了一个不太优雅的选择。与其尝试使用 the`<link>`或其他标签来识别数据绑定的地图所在的位置，不如指定一个返回地址列表的 URL 并在服务器端处理它们的管理。这对我来说很好，因为我不太习惯编写 javascript（我现在是一名 C# 开发人员，虽然我还戴过其他几顶帽子），但我确实觉得这是一个尽可能优雅的解决方案。

我现在会接受它，但我愿意接受可能的替代方案。

# objective-c - 声音在模拟器（iPhone 和 iPad）和真实的 iPhone 上播放，但不是真实的 iPad

> ID：10049349
> 
> 赞同：0
> 
> 时间：2012-04-06T21:15:49.903
> 
> 标签：objective-c, avaudioplayer

当用户使用下面的代码翻页时，我正在播放 mp3 文件。这在 iPhone 和 iPad（iOs 4,5 和 5.1）的模拟器中运行良好。当我在设备上进行测试时，它在 iPhone 上运行良好，但在 iPad 上却没有声音。我已经在两个不同的 iPad 上尝试过，但仍然没有运气。我检查了文件名和文件路径，一切都很好。同样，在模拟器中一切正常。任何想法为什么会发生这种情况？

```
audioFilename = @"pageflip";
audioData = [NSData dataWithContentsOfMappedFile:[[NSBundle mainBundle] pathForResource:audioFilename ofType:@"mp3"]];
[audioData getBytes:soundBuffer length:128];
Audio1 = [[AVAudioPlayer alloc] initWithData:
audioData error:&error];
Audio1.numberOfLoops = 0;
Audio1.volume=0.9;
[Audio1 prepareToPlay];

Audio1.currentTime=0;
[Audio1 play]; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-09T21:10:46.140

设备上的文件名区分大小写。请检查资源和代码中的文件名。

# java - 服务层和域模型的问题

> ID：10049355
> 
> 赞同：4
> 
> 时间：2012-04-06T21:16:04.353
> 
> 标签：java, design-patterns, domain-driven-design

我正在开发一个具有在域模型上运行的服务层的应用程序。在当前的设计中，我通过服务层向上传递域对象（例如，`Employee`在调用时返回域对象`EmploymentService.getEmployee()`，但要求对对象执行的操作通过服务进行（例如`EmploymentService.transferEmployee( int employeeId, int newLocationId)`。（顺便说一下，示例是人为的）。

这对我来说有点不对劲。一，它看起来像过程编程。第二，域对象具有诸如`Employee.setLocationId`客户端可以调用的设置器，当然不会将员工转移到新位置，因为协调假设转移员工所需的不同系统的所有复杂操作都在服务层中。

如果我可以对客户端隐藏设置器，我会感觉更好，但是不同包中的 ServiceLayer 和 DAO 都需要能够访问域对象的设置器。

这种事情可以吗，还是有更好的方法？（此外，任何具有底层域模型的服务层的真实示例都将受到欢迎！）

另外，我已经阅读了贫血域模型反模式，我*认为*我没有落入那个陷阱，但我并不完全确定！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-08T12:18:44.110

首先，客户端调用 Employee.Transfer() 的问题是您实际上并不想要的：我喜欢只从我的服务层返回 DTO。这些 DTO 包含数据但没有方法。这解决了客户端调用 Employee.Transfer() 的问题。

接下来是在EmploymentService.transferEmployee() 中拥有所有代码的问题。你说它感觉不对，因为它看起来像程序化编程。解决方案是在您放入 Service 的逻辑和放入 Domain 对象的逻辑之间找到一个很好的组合。例如：

域对象：

*   检查它是否没有被删除
*   检查它是否不在该位置
*   等等

服务层可以：

*   加载员工
*   致电 Employee.Transfer
*   向员工发送电子邮件
*   向位置经理发送电子邮件
*   等等

我可能会在此代码中使用 Location Domain 对象：

```
public class Location
{
   public void AddEmployee(Employee emp)
   {
      if(!IsFull)
         Employees.Add(emp);
   }

   public void RemoveEmployee(Employee emp)
   {
      Employees.Remove(emp);
      If(Employees.Count < 100)
         IsFull = false;
   }
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-07T00:16:54.270

首先，虽然你说你的例子是人为的，但我想说这`EmploymentService.transferEmployee(int employeeId, int newLocationId)`有点奇怪。通常你会将一个转移`Employee`到一个`Location`。在 Java 代码中处理 id 是不寻常的。大多数 ORM 都会为您处理。

至于你的问题，我会把转移 an 的逻辑放在`Employee`里面`Employee`。这样一来，如果`Employee.setLocation(Location)`没有进行适当的更改，就不可能有人打电话。这比试图从某些对象中隐藏二传手要好得多。

正如[贫血领域模型](http://en.wikipedia.org/wiki/Anemic_domain_model)的维基百科页面中所述，该模式描述了一个系统，其中领域转换由单独的对象控制。我个人认为转移an`Employee`确实是一种转换，这种转换的逻辑可以而且应该在Domain层。当然，这些问题总是有点口味问题，所以你可能会有不同的想法。

我发现 Martin Fowler[关于这个问题的原始文章](http://www.martinfowler.com/bliki/AnemicDomainModel.html)是一个很好的论据，可以让您的域对象能够自我转换。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-06T21:51:20.653

对客户端隐藏 setter 的一种常用方法是将客户端需要的所有 getter 封装在`IEmployee`接口中，并将服务 API 编码到该接口。这样，setter 对客户端隐藏，但对于需要它们的服务和 DAO 仍然存在。

# ibm-midrange - 使用 SNDDST 发送邮件

> ID：10049362
> 
> 赞同：2
> 
> 时间：2012-04-06T21:16:28.527
> 
> 标签：ibm-midrange, control-language

我试图从我的 as400 发送一封电子邮件，但没有成功！我正在将此代码用于 CLLE：

```
SNDDST     TYPE(*LMSG) TOINTNET((*NONE) +
       ('address1@mail.it') +           
       ('address2@mail.it')) DSTD('TEST') +
LONGMSG('test mail...') 
```

我收到一个错误，我用 WRKDIRE 修复了我添加用户的地方，实际上现在当我调用程序时，读入 dspjoblog：分发的发送已成功完成。但我在邮箱中没有收到任何东西

我认为 SMTP 配置没问题，但我收到此错误：

```
 Tipo    Tipo   ----Registrata----               -----Mittente-----  Num. 
Opz Funzione  voce   Data       Ora      Nome lav.    ID utente  Indir.   seq  
     *RTR    *ERR   10/04/12  13:04:15  QMSF         MARCO     MT        0013 

Funzione . . . . . . . . . . :   Instradamento distribuzione  
Lavoro . . . . . . . . . . . :   275842/QMSF/QMSF             
Data/ora . . . . . . . . . . :   10/04/12  13:04:15           

Mittente:                                                     
ID utente/Indirizzo  . . . :   MARCO     MT                 
Nome sistema/Gruppo. . . . :   S6518B7A                     
Numero di sequenza . . . . . :   0013                         
Data/ora di origine  . . . . :   10/04/12  13:04:15           
Agente destinazione  . . . . :   OfficeVision                 

Codice stato SNADS . . . . . :   0001 Errore instradamento    
Destinatario in errore:                                       
ID utente/Indirizzo  . . . :   INTERNET  GATEWAY            
Nome sistema/Gruppo  . . . :   INTERNET                     
Voce indirizzario sistema  :   Definito localmente 
```

我发现了这个错误：

```
Message. . . : Failed opening file IFS (Integrated File System)
on file/MMAIL/temp/Q6.txt
Cause. . . . . : The RTCP function requires the use of a file IFS (Integrated
   File System) / MMAIL/temp/Q6.txt. The error received by the call is 3025.
   This file does not exist in the system is blocked or damaged and can not
    be used at the time.
Correction. . . : Close MSF (Mail System Framework) "ENDMSF" and restart
 "STRMSF". 
```

我刚刚尝试重新启动作业但没有成功，并且始终在 QMSF 作业中出现此错误日志：

```
Message ID. . . . . : Severity CPFAF98\. . . . . . . : 60
Message type. . . . : Informational
Submit Date. . . . . . : 13/04/12 Time sent. . . . . . : 12:44:02

Message. . . : The job has stopped processing 320083/QMSF/QMSF
  MSF message.
Cause. . . . . : The program exit point in the library QTMSFWD QTCP
  to the point of exit QIBM_QZMFMSF_MSG_FWD has detected a condition with
  6518B7A0909081414210000000008 the message ID. The message indicates that
  processing must be completed. The MSF message will be revised
  the next command execution STRMSF (Start Mail Server Framework)
Correction. . . : Determine because the program exit point has
  indicated the need to end processing of a message. in
  joblog may be listed messages that have caused
  incorrect program. Correct errors, and run the
ENDMSF command (closing mail server framework) to terminate 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-09T16:51:47.397

有很多事情要检查。由于您没有描述您*所做*的事情，因此很难建议您*可以*做的其他事情。我可以推荐一些阅读材料吗？

*   [http://www.easy400.net/mmail/start](http://www.easy400.net/mmail/start)
*   [http://publib.boulder.ibm.com/iseries/v5r2/ic2928/info/rzair/rzair.pdf](http://publib.boulder.ibm.com/iseries/v5r2/ic2928/info/rzair/rzair.pdf)
*   [http://mowyourlawn.com/RPGMail.html](http://mowyourlawn.com/RPGMail.html)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-12T01:37:58.780

You could start by looking at SNADS logs using DSPDSTLOG.

IBM support document "SNADS - Basic Troubleshooting Process" is very helpful in finding the source of error. Hope this helps...

[http://www-01.ibm.com/support/docview.wss?uid=nas1b56c1c34b489e7528625663d004b1797](http://www-01.ibm.com/support/docview.wss?uid=nas1b56c1c34b489e7528625663d004b1797)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-10T13:16:33.370

尝试使用@Buck Calabro 的链接，还有其他几个。SMTP 可能未完全正确设置。

*   [http://www.bvstools.com/docs/mailtool/faq.html](http://www.bvstools.com/docs/mailtool/faq.html)
*   [http://publib.boulder.ibm.com/infocenter/iseries/v5r4/index.jsp?topic=%2Frzair%2Frzairsmtppa.htm](http://publib.boulder.ibm.com/infocenter/iseries/v5r4/index.jsp?topic=%2Frzair%2Frzairsmtppa.htm)

# filesystems - 如何读取包含写入它的整数的hadoop文件

> ID：10049363
> 
> 赞同：0
> 
> 时间：2012-04-06T21:16:34.940
> 
> 标签：filesystems, hdfs

我在 HDFS 上有一个文件，我使用 FSDataOutputStream.writeInt() 在我的代码中写入了整数

如何从命令行 hadoop 工具中读取它？hadoop dfs -cat 返回我的二进制垃圾。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-07T12:12:03.013

直接从命令行使用`hadoop fs`- 不太可能，除非您想通过 awk 脚本深入研究管道输出。

你可以写一个简单的java类来读取文件，我猜是这样的：

```
public class IntFileReader extends Configured implements Tool {
    public static void main(String[] args) throws Exception {
        ToolRunner.run(new IntFileReader(), args);
    }

    public int run(String[] args) throws Exception {
        FileSystem fs = FileSystem.get(getConf());

        FSDataInputStream is = fs.open(new Path(args[0]));

        while (is.available() != -1) {
            System.out.println(is.readInt());
        }

        is.close();

        return 0;
    }
} 
```

然后你可以捆绑在一个 jar 中并执行：

```
hadoop jar myJar.jar IntFileReader /path/to/file/in/hdfs 
```

# apache - 缺少 Cloudfront 缓存控制标头

> ID：10049366
> 
> 赞同：10
> 
> 时间：2012-04-06T21:16:56.487
> 
> 标签：apache, cache-control, amazon-cloudfront

我设置 Cloudfront 为 www.lottoresults.ie 提供静态图像、js、css 文件。我使用了自定义源服务器。

我设置的云端域名是icdn.lottoresults.ie。我使用 Bind9 dns 进行了设置，其中 icdn.lottoresults.ie 是 cloudfront 发行版的 CNAME。

没关系。

但是，对于网站性能优化（Yslow、google pagespeed 等），我想要设置 Cache-control 和 Expires 标头，并且我不想要 Etags。

为此，我在 www.lottoresults.ie 的 doc_root 的 htaccess 文件中有以下内容：

```
Header unset Pragma
FileETag none
Header unset ETag

<FilesMatch "(.*)\.(ico|jpg|jpeg|png|gif|js|css|swf)$">
ExpiresActive on
ExpiresDefault "access plus 1 year"
Header set Cache-Control "max-age=1864000, public"
Header unset Last-Modified
</FilesMatch> 
```

**问题**是，对于来自云端发行版 (icdn) 的资产，*我没有 Cache-control 或 Expires 标头，但我确实有 Etags* - 但是对于 www，我确实有 Cache-control 和 Expires 标头，并且没有 Etags。

当我从我的云端域查询资产时，我没有 Cache-control 或 Expires 标头，但我有 Etags。

curl -I -L [http://icdn.lottoresults.ie/images/green-header.jpg](http://icdn.lottoresults.ie/images/green-header.jpg)

```
HTTP/1.0 200 OK
Date: Sun, 01 Apr 2012 22:58:30 GMT
Server: Apache/2.2.9 (Debian) PHP/5.2.6-1+lenny13 with Suhosin-Patch
Last-Modified: Mon, 08 Aug 2011 20:23:00 GMT
**ETag**: "28a213-19b-4aa0436a1b100"
Accept-Ranges: bytes
Content-Length: 411
Content-Type: image/jpeg
Age: 22137
X-Cache: Hit from cloudfront
X-Amz-Cf-Id: AV55dR4_vWHtlTbU6E9M2tkh9reoAwZcHlD4y9csetK6B6Ey8gDPJA=
Via: 1.0 8adf6ec3585d73c680b4a6d5052988d8.cloudfront.net (CloudFront)
Connection: close 
```

然而，当我从我的源服务器查询相同的资产时，我得到以下信息，其中包括缓存控制、过期和无 Etag。

**curl -I -L [http://www.lottoresults.ie/images/green-header.jpg](http://www.lottoresults.ie/images/green-header.jpg)**

```
HTTP/1.1 200 OK
Date: Fri, 06 Apr 2012 20:50:08 GMT
Server: Apache/2.2.9 (Debian) PHP/5.2.6-1+lenny13 with Suhosin-Patch
Accept-Ranges: bytes
Content-Length: 411
**Cache-Control**: max-age=1864000, public
**Expires**: Sat, 06 Apr 2013 20:50:08 GMT
Content-Type: image/jpeg 
```

非常感谢任何帮助或建议。

谢谢保罗

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2012-04-07T13:20:40.017

我想我知道这是什么，对于其他可能有同样问题的人。

这是一种[PEBKAC](http://en.wikipedia.org/wiki/User_error) - 我必须在资产获得新标头之前使资产**无效。**

例如，我添加了一个新文件 images/zoom2.gif，它看起来正确：

curl -I -L [http://icdn.lottoresults.ie/images/zoom2.gif](http://icdn.lottoresults.ie/images/zoom2.gif)

```
HTTP/1.0 200 OK
Date: Fri, 06 Apr 2012 23:00:24 GMT
Server: Apache/2.2.9 (Debian) PHP/5.2.6-1+lenny13 with Suhosin-Patch
Accept-Ranges: bytes
Content-Length: 1849
Cache-Control: max-age=1864000, public
Expires: Sat, 06 Apr 2013 23:00:24 GMT
Content-Type: image/gif
Age: 29
X-Cache: Hit from cloudfront
X-Amz-Cf-Id:         vPPBdJpw0ZI_J2trHyECnE2UBeQO9NsQZD9GSvl3GIVAZuQN5lz1ZQ==,J4bBHfF5lKEpjRPLZVYpS9HUdAKEOLEe-Gy3-a_x4PsLPrdWuRg93Q==
Via: 1.0 00204466f749ba432b50dc49d604c534.cloudfront.net (CloudFront)
Connection: close 
```

# wordpress - Wordpress query_posts() 还有哪些其他选择？

> ID：10049367
> 
> 赞同：1
> 
> 时间：2012-04-06T21:17:01.887
> 
> 标签：wordpress, posts

Wordpress 法典说：

> `query_posts()`只是众多查询数据库和生成帖子列表的方法之一。在决定使用 query_posts() 之前，一定要了解它的缺点。

但它没有列出这些替代品`query_posts()`是什么。我应该使用别的东西吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-06T23:16:57.383

您可以使用`get_posts()`或创建一个`new WP_Query`. 还有一些更具体的，例如`wp_get_recent_posts()`. 浏览一下`wp-includes/post.php`获取帖子的一些可用方法。在不知道自己要做什么的情况下，我无法告诉您是否应该使用其他东西。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-07T05:55:41.180

看看[这个页面](http://digwp.com/2011/05/loops/)。它列出了`query_posts`. `WP_Query()`可能是您正在寻找的东西。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-07T10:54:55.320

query_posts 将更新全局 $wp_query。也许你不想要那个。

如果您执行 $my_query = new WP_Query 然后 $my_query->query_posts 您不会弄乱全局变量。

有时使用 get_posts() 更容易

您还可以选择自己发出 sql 请求。

# jquery - 如何使倒计时功能化？

> ID：10049368
> 
> 赞同：0
> 
> 时间：2012-04-06T21:17:11.603
> 
> 标签：jquery, html, css

我制作了一个倒数计时器并使用 HTML 和 CSS 对其进行了编码，但我无法使用 jQuery 使其正常运行。我怎样才能使这个倒计时功能化？这是我更喜欢倒计时的 HTML 结构：

```
 <div id="counter-container">
      <div class="counter-box">
        <div class="counter"><p class="counter-p">#</p></div>
        <p class="counter-box-p">days</p>
      </div>
      <div class="counter-box">
        <div class="counter"><p class="counter-p">#</p></div>
        <p class="counter-box-p">hours</p>
      </div>
      <div class="counter-box">
        <div class="counter"><p class="counter-p">#</p></div>
        <p class="counter-box-p">minutes</p>
      </div>
      <div class="counter-box">
        <div class="counter"><p class="counter-p">#</p></div>
        <p class="counter-box-p">seconds</p>
      </div> 
```

如您所见，我已经添加了几天、几小时等的段落元素，因此我不想通过 jQuery 嵌入任何额外的文本。

PS谁能告诉我如何设置新的倒计时日期？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-06T21:40:12.933

```
function counter(count) {
  countdown = setInterval(function(){
    var temp;
    $("p#d").html(Math.floor(count/(60*60*24)));
    temp = count%(60*60*24);
    $("p#h").html(Math.floor(temp/(60*60)));
    temp = count%(60*60);
    $("p#m").html(Math.floor(temp/(60)));
    temp = count%(60);
    $("p#s").html(temp);
    if (count == 0) {
         alert("time's up");
         clearInterval(countdown);       
    }
    count--;
  }, 1000);
}

counter(60*60*24*2); 
```

​<a href="http://jsfiddle.net/NfLAB/" rel="nofollow">演示

**编辑-1：**

计数器以秒为单位获取时间。

```
counter(10); //10 seconds
counter(10*60) //600 seconds -> 10 minutes.
counter(10*60*60) //36000 seconds -> 600 minutes -> 10 hour 
```

**编辑-2：**

如果你想让它`Date`基于工作，你应该改变这样的功能，

```
function counter(futureDate) {
  var today = new Date(); // today
  count = Math.floor((futureDate-today)/1000);
  countdown = setInterval(function(){
    var temp;
    $("p#d").html(Math.floor(count/(60*60*24)));
    temp = count%(60*60*24);
    $("p#h").html(Math.floor(temp/(60*60)));
    temp = count%(60*60);
    $("p#m").html(Math.floor(temp/(60)));
    temp = count%(60);
    $("p#s").html(temp);
    if (count == 0) {
         alert("time's up");
         clearInterval(countdown);       
    }
    count--;
  }, 1000);
}

counter(new Date(2012,4,8)); // May 8, 2012 00:00:00
/* counter(new Date(2012,4,8,15,49,10)); // May 8, 2012 15:49:00 */
​ 
```

[http://jsfiddle.net/NfLAB/1/](http://jsfiddle.net/NfLAB/1/)

# lisp - Lisp 和 Scheme 中的 WebSocket 库？

> ID：10049369
> 
> 赞同：7
> 
> 时间：2012-04-06T21:17:17.377
> 
> 标签：lisp, scheme, common-lisp

哪些定期维护且稳定的库可用于使用 Common Lisp 或 Scheme 托管 WebSocket 服务器？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-04-07T02:33:35.907

Common Lisp wiki cliki 链接到[两个 WebSocket 库](http://www.cliki.net/WebSocket%20server)，这两个库都可以通过[Quicklisp](http://www.quicklisp.org/)获得。您应该评估它们，看看哪个满足您的需求。（**编辑**：[clws](https://github.com/3b/clws)似乎是两者中维护得更积极的。）

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-04-07T01:05:21.870

[Racket](http://racket-lang.org/)有一个 WebSocket 库：[http ://docs.racket-lang.org/net/websocket.html](http://docs.racket-lang.org/net/websocket.html)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-06T22:16:19.560

嗯，有 Common Lisp 的[cl-websocket](https://github.com/spratt/cl-websocket)库。

# android - 为什么我不能将较小的位图绘制到较大的画布中？

> ID：10049370
> 
> 赞同：-1
> 
> 时间：2012-04-06T21:17:21.540
> 
> 标签：android, canvas

我创建了一个自定义视图（显示），它接受创建半静态（很少更改）位图的非视图图标。这个想法是将许多图标传递给显示以打印到其画布上。我的问题是我无法让显示器将图标位图实际绘制到其画布中。

下面的代码是我所拥有的一个工作示例。（通过工作，我的意思是正确执行，而不是打印我想要的内容）

```
public class AndroidTestoActivity extends Activity {
    @Override public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        FrameLayout fl = new FrameLayout(this);
        Display tv = new Display(this); 
        tv.setLayoutParams(new LayoutParams(200, 200));
        fl.addView(tv);
        setContentView(fl);
    }

    public class Display extends View {
        Paint vPaint = new Paint();
        Icon item = new Icon();

        public Display(Context context) {
            super(context);
            vPaint.setStyle(Paint.Style.FILL_AND_STROKE);
            vPaint.setColor(0x0ff000000);
            setBackgroundColor(0xffffffff);
        }

        @Override public void onDraw(Canvas canvas) {
            canvas.scale(200, 200);
            item.onDraw(canvas);
            canvas.drawLine(0.0f, 0.0f, 1.0f, 1.0f, vPaint);
        }
    }

    public class Icon {
        Bitmap myImage;
        Paint mPaint = new Paint();

        public Icon() {
            myImage = Bitmap.createBitmap(50, 50, Bitmap.Config.ARGB_8888);
            mPaint.setStyle(Style.FILL);
            mPaint.setColor(0xffff0000);
            Canvas c = new Canvas(myImage);
            c.scale(50, 50);
            c.drawCircle(0.5f, 0.5f, 0.5f, mPaint);
        }

        public void onDraw(Canvas canvas) {
            canvas.drawBitmap(myImage, 0, 0, null);
        }
    }
} 
```

这段代码应该打印出从左上角到右下角的一条线，并从 0,0 到 50, 50 绘制一个 50px 直径的圆。相反，我得到的只是这条线。但是，如果我将位图打印到文件中，该文件会准确地输出它应该输出的内容。

有没有人知道发生了什么？

**编辑**
为了澄清我的问题，我正在创建一个比 DisplayView 小得多的位图。当我尝试将位图绘制到 DisplayView 中时，位图根本不是我绘制的，并且从未适当地缩放。为什么画布不能正确绘制位图？

**更新**
在 Diplay 的 onDraw 方法中，我将行`items.onDraw(canvas);`移到 before `canvas.scale(200, 200);`。现在测试圈绘制正确。如此简单的改变是做什么来完全忽略以以前的方式绘制圆圈的？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-09T16:55:14.423

事实证明，我@MartinAsenov 基本上是正确的。我最终需要做的是在我缩放画布并正常绘制*之前*（或在保存和恢复之后）绘制所有缓存的位图。至于缩放画布，我认为这仍然是必要的（我的所有其他小部件在绘制之前都缩放到它们的宽度和高度，没有问题）。

这是最终的工作测试活动。

```
public class AndroidTestoActivity extends Activity {
    @Override public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        FrameLayout fl = new FrameLayout(this);
        Display tv = new Display(this); 
        tv.setLayoutParams(new LayoutParams(200, 200));
        fl.addView(tv);
        setContentView(fl);
    }

    public class Display extends View {
        Paint vPaint = new Paint();
        Icon item = new Icon();

        public Display(Context context) {
            super(context);
            vPaint.setStyle(Paint.Style.FILL_AND_STROKE);
            vPaint.setColor(0x0ff000000);
            setBackgroundColor(0xffffffff);
        }

        @Override public void onDraw(Canvas canvas) {
            item.onDraw(canvas);
            canvas.save(Canvas.MATRIX_SAVE_FLAG);
            canvas.scale(getWidth(), getHeight());

            canvas.drawLine(0.0f, 0.0f, 1.0f, 1.0f, vPaint);
            canvas.restore();
        }
    }

    public class Icon {
        Bitmap myImage;
        Paint mPaint = new Paint();

        public Icon() {
            myImage = Bitmap.createBitmap(50, 50, Bitmap.Config.ARGB_8888);
            mPaint.setStyle(Style.FILL);
            mPaint.setColor(0xffff0000);
            Canvas c = new Canvas(myImage);
            c.scale(50, 50);
            c.drawCircle(0.5f, 0.5f, 0.5f, mPaint);
        }

        public void onDraw(Canvas canvas) {
            canvas.drawBitmap(myImage, 50, 50, null);
        }
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-06T23:20:25.007

查看您的代码我认为主要问题是您假设坐标为 0f..1f 但事实是 0f..width / 0f..height - float 用于具有子像素

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-09T17:51:55.333

我最好的猜测是圆变得太大（将其缩放 200 倍），因此其坐标变为负数（即左上角为 (-5,-10)）。android系统不会用负坐标绘制视图（如果你想实现这一点，你需要重写onMeasure（）方法）

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-09T17:54:47.277

我认为您对画布的工作方式有些困惑（而且它不直观，因此很容易混淆）。您调用 Canvas 的方式，使用 Bitmap 作为参数，最终将位图视为正在绘制的东西，因此，您受到位图尺寸的限制。如果您要创建一个没有参数的画布（一个空画布），然后在其中绘制一个位图，那么它实际上并没有改变位图，它只是在画布上绘制。在这种情况下，您可以在矩形内的任何位置绘制位图并在其周围绘制一个圆圈（或您想要的任何其他内容）。

此外，您可以覆盖 onDraw 方法并收集 *它的画布（它在调用回调时交给您），然后在该画布上绘制您想要的任何内容......这就是实际显示在屏幕上的画布，这就是访问它的最简单方法。

# objective-c - Xcode - 如何将1个变量的值从第一个视图控制器传递到另一个视图控制器

> ID：10049372
> 
> 赞同：1
> 
> 时间：2012-04-06T21:17:24.817
> 
> 标签：objective-c, xcode, ios4, xcode4

> **可能重复：**
> [Xcode：故事板选项卡式应用程序来回传递数据](https://stackoverflow.com/questions/9661246/xcode-storyboard-tabbed-application-passing-data-back-and-forth)

基本上我有 2 个视图控制器

第一个视图控制器：包含表格视图

第二个视图控制器：包含图像视图

我想根据从表视图中选择的值（来自第一个视图控制器）在第二个视图控制器上加载图像

我知道我可以使用以下代码捕获所选单元格的值

```
NSString *CellVal = [[NSString alloc]init];
CellVal = [exercises objectAtIndex:indexPath.row]; 
```

但是如何在 2nd View conroller 中引用“CellVal”的值？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-06T21:37:55.930

在您的第二个控制器中创建一个 NSString 属性。然后，在某个时候，使用类似`secondController.stringProperty = cellVal;`.

您放置发布的代码和分配的位置取决于您使用的是 xib 文件还是情节提要。在一种情况下，您可以在从 nib 初始化第二个控制器的地方执行此操作，否则您将在 prepareForSegue: 中执行此操作：（使用序列中的目标控制器）。

# haskell - Haskell 中是否有任何隐含的记忆？

> ID：10049377
> 
> 赞同：7
> 
> 时间：2012-04-06T21:18:02.630
> 
> 标签：haskell, ghc, memoization

有没有办法强制 GHC 在特定值的生命周期内对特定计算进行重击？

我显然可以将值放入记录中，为所述计算的结果创建惰性记录条目，并创建一个生成器函数来构建记录并将值复制到所述条目中。

我讨厌每次我想要它时都需要从记录中提取原始值。而且 Haskell 没有像 C++ 或 Java 这样的临时多态 is-a 关系。

是否有任何技巧可以在具有相同参数的函数的多个不相关调用中记忆值？

我可以模糊地想象各种依赖类型形式的技巧，这些技巧可以有效地告诉编译器多种用法即将到来。Haskell 中没有任何依赖类型，但可能是隐式参数？我想不是，但我想我会问。也许是一个编译器？

* * *

想象一下，我有一个`Necklace`数据结构向量，我需要一个有理数的结果向量，存储为一个公分母和一个分子向量。

```
{-# LANGUAGE ImplicitParams #-}
import qualified Data.Vector as V

data Necklace = Necklace { ... }
necklace_length n = ...

denominator :: (necklaces :: V.Vector Necklace) => Int
denominator = V.foldl' lcm 30 $ V.map necklace_length ?necklaces

numerators :: (necklaces :: V.Vector Necklace) => V.Vector Int
numerators = V.map f ?necklaces
  where f x = ... denominator ...

kittytoy :: (necklaces :: V.Vector Necklace) => Meow -> ...
kittytoy = \meow -> ... numerators ... 
```

先验地，我希望，如果我调用`kittytoy`几百万次，每次都使用不同的参数`meow`，那么 GHC 会生成调用`numerators`一百万次的代码，每次都使用相同的隐式参数`necklaces`。

尽管如此，很明显`numerators`只需要调用一次，第一次`?necklaces`被分配，这意味着 GHC 可能会注意到这种优化。

甚至应该有一种显式的代码重构方法，使用模板 haskell 通过生成类似代码`?numerators = numerators`并添加`numerators :: V.Vector Int`到调用它的函数的类型约束来显式传递 thunk。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-04-06T21:34:53.840

您可能正在寻找由[data-memocombinators](http://hackage.haskell.org/package/data-memocombinators)实现的纯记忆。基本上，它的工作原理是创建一个（惰性的，可能是无限的）树结构，其中包含每个叶子上函数的所有可能值，然后创建一个简单地访问相关位置的值的新函数。例如，你可以为这样的函数编写一个 memoiser `Bool -> a`：

```
memoBool :: (Bool -> a) -> (Bool -> a)
memoBool f =
    let fTrue = f True
        fFalse = f False
    in \b -> if b then fTrue else fFalse 
```

在这种情况下，“树结构”相当盆景，只有两片叶子。

data-memocombinators 将其封装在`Memo a`类型中，定义为`forall r. (a -> r) -> (a -> r)`，并带有有用的组合器，例如`pair :: Memo a -> Memo b -> Memo (a, b)`（阅读：如果你可以记忆参数类型的函数`a`，和参数类型的记忆函数`b`，你可以记忆参数类型的函数`(a, b)`）。

这是纯粹的，非常优雅的，依赖于基本上所有 Haskell 实现所实现的共享（这与使您的记录想法起作用的东西相同）。不幸的是，它也不是很快，所以在实际使用中，您可能希望使用[丑陋](http://hackage.haskell.org/package/uglymemo)`Map`的备忘录，它在幕后使用可变的（但公开了一个外部纯接口）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-07T12:54:24.623

[正如Philip JF](https://stackoverflow.com/users/683453/philip-jf)在此处的[回答](https://stackoverflow.com/a/9599994/667457)`type`中所指出的，现在定义了类型约束的同义词这一事实产生了另一种似是而非的方法。

您可能会为为所有各种派生值创建隐式参数的类型约束创建同义词：

```
type Necklaces = (necklaces :: V.Vector Necklace,
                  denominator :: Int,
                  numerators :: V.Vector Int)

kittytoy :: (Necklaces) => Meow -> ... 
```

您最初会分配所有值，例如`?numerators`使用某种形式的模板 Haskell 构造。我会玩它，看看它是否有效。

# android - Eclipse 安装更新 Indigo 3.7.2 w/ADK 时出错

> ID：10049381
> 
> 赞同：1
> 
> 时间：2012-04-06T21:18:15.677
> 
> 标签：android, eclipse, sdk

在尝试从 Indigo 3.7.1 和 Android SDK 15 更新后，Eclipse 遇到了依赖问题。
似乎所有 Android 组件都已安装，但我`There were no installable units selected when the plan was computed`在“可用更新”窗口中收到以下消息“”。

正在尝试安装 Eclipse SDK 版本 3.7.2.M20120208-800。

对此问题的任何帮助表示赞赏。请参阅下面的更多信息：

* * *

```
Cannot complete the install because of a conflicting dependency.
  Software being installed: Eclipse SDK 3.7.2.M20120208-0800 (org.eclipse.sdk.ide 3.7.2.M20120208-0800)
  Software currently installed: Shared profile 1.0.0.1321891729401 (SharedProfile_SDKProfile 1.0.0.1321891729401)
  Only one of the following can be installed at once: 
    Simple Configurator Manipulator 2.0.0.v20110502-1955 (org.eclipse.equinox.simpleconfigurator.manipulator 2.0.0.v20110502-1955)
    Simple Configurator Manipulator 2.0.0.v20110815-1438 (org.eclipse.equinox.simpleconfigurator.manipulator 2.0.0.v20110815-1438)
  Cannot satisfy dependency:
    From: Shared profile 1.0.0.1321891729401 (SharedProfile_SDKProfile 1.0.0.1321891729401)
    To: org.eclipse.equinox.simpleconfigurator.manipulator [2.0.0.v20110502-1955]
  Cannot satisfy dependency:
    From: Equinox p2 Core Function 1.0.1.v20110906-1605-8290FZ9FVKHVRKtmx3fpNuo02129 (org.eclipse.equinox.p2.core.feature.feature.group 1.0.1.v20110906-1605-8290FZ9FVKHVRKtmx3fpNuo02129)
    To: org.eclipse.equinox.simpleconfigurator.manipulator [2.0.0.v20110815-1438]
  Cannot satisfy dependency:
    From: Equinox p2 Provisioning for IDEs. 2.1.2.R37x_v20110815-1155-6-Bk8pYWZz0qUTX5I15GZWwbXkrl (org.eclipse.equinox.p2.user.ui.feature.group 2.1.2.R37x_v20110815-1155-6-Bk8pYWZz0qUTX5I15GZWwbXkrl)
    To: org.eclipse.equinox.p2.core.feature.feature.group [1.0.1.v20110906-1605-8290FZ9FVKHVRKtmx3fpNuo02129]
  Cannot satisfy dependency:
    From: Eclipse SDK 3.7.2.M20120208-0800 (org.eclipse.sdk.ide 3.7.2.M20120208-0800)
    To: org.eclipse.equinox.p2.user.ui.feature.group [2.1.2.R37x_v20110815-1155-6-Bk8pYWZz0qUTX5I15GZWwbXkrl] 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-06T22:23:20.780

由“”引起的冲突依赖可能是[共享安装](http://dev.eclipse.org/mhonarc/lists/epp-dev/msg01135.html)`Software currently installed:` **`Shared profile`**中共享插件问题的一个迹象（除非以管理员身份运行，否则无法更新，如[错误 339659](https://bugs.eclipse.org/bugs/show_bug.cgi?id=339659#c15)中所述）

[错误 322344](https://bugs.eclipse.org/bugs/show_bug.cgi?id=322344#c3)总结如下：

> 下有很多插件`c:\Program Files`，由于UAC，Eclipse不能在这里写。当您安装附加组件（没有升级，只是额外的捆绑包）时，它们会进入`~/.eclipse`用户主目录下的隐藏文件夹。
> 但是，我们无法在此文件夹中执行任何“更新”，因为您处于共享安装模式，并且假定管理员将“更新”基础。
> 
> 但是，在某些情况下，安装会强制更新（新插件`X`取决于 的更新`Y`）。
> 在这种情况下，我们可能会遇到麻烦，因此我们“锁定”共享区域，这样就不会发生更新。
> 这就是你要打的。

因此，在更新 Eclipse 安装时，您可能会遇到一些写入权限问题（如[错误 287246](https://bugs.eclipse.org/bugs/show_bug.cgi?id=287246#c11)中所示）。

# php - 管理员只能访问 php

> ID：10049382
> 
> 赞同：1
> 
> 时间：2012-04-06T21:18:31.277
> 
> 标签：php, mysql

我正在尝试编写一个页面，该页面只允许具有管理员权限的用户（在数据库中记录为管理员角色）。如果他们是管理员，则从数据库中提取照片以供批准。如果不是管理员，那么他们会被重定向到管理页面并且看不到图像。

目前，任何登录的人都可以查看该页面并显示图像。我究竟做错了什么？

谢谢

```
<?php

session_start();

$isLoggedIn = isset($_SESSION['first_name']) && isset($_SESSION['username']);
$username = $_SESSION['username'];

if ($isLoggedIn && $_SESSION['username']){

echo "Welcome ".$_SESSION['first_name']."<br><a href='login/logged_out.php'>log     
out</a>";

}

$username = $_SESSION['username'];
//var_dump($username);

include("..\connection\connection.php");

// Connect to server and select database.

mysql_connect($host, $username, $password)or die("cannot connect"); 

mysql_select_db($db_name) or die("cannot select DB");

$query=mysql_query("SELECT * FROM users WHERE username = '$username' AND role =   
'admin'");

echo(mysql_error());

$num_rows = mysql_num_rows($query);

if ($num_rows =1){                  

include("..\connection\connection.php");

// Connect to server and select databse.
mysql_connect($host, $username, $password)or die("cannot connect"); 
mysql_select_db($db_name) or die("cannot select DB");

$photo=mysql_query("SELECT * FROM images WHERE approved='N'");

echo(mysql_error());

$numrows = mysql_num_rows($photo);//counts the number or rows returned from database   
matching the mysql_query.

if ($numrows==0){

echo "There are no images awaiting approval.";
}

while($get_photo=mysql_fetch_array($photo)){?>

<a href="approve_image_submit.php?images=<?php echo $get_photo['big_images']; ?>"   
target=""><img src="<? echo $get_photo['url']; ?>" title="">

<? } ?>
<?
}else{

die ("You do not have permission to view this page. Redirect to index.phph Click <a  
href='login/login_page.php'>here</a> to log in.");
                //

}
?> 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-06T21:19:49.593

```
if ($num_rows =1){ 
```

应该

```
if ($num_rows==1){ 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-06T21:50:13.433

所以你的脚本可能有问题

A.`username`与用户名冲突`database`B. 因此`$_SESSION`设置了变量 C. 无效`logic`

我可以继续下去

我有帮助重写代码，但您需要用相关信息替换

```
session_start ();
include ("..\connection\connection.php");

$username = @$_SESSION ['username'];
$rowPhoto = array ();
$dbHost = "";
$dbUser = "";
$dbPass = "";
$dbName = "";

if ($_SESSION ['AUTH'] == true && ! isset ( $_SESSION ['username'] )) {
    echo "Welcome " . $_SESSION ['first_name'] . "<br><a href='login/logged_out.php'>log out</a>";
    exit ();
}
$mysqli = new mysqli ( $dbHost, $dbUser, $dbPass, $dbName ); // Replace with relevant information
$result = $mysqli->query ( "SELECT * FROM users WHERE username = '$username' AND role =  'admin'" );

if ($result->num_rows == 1) {
    $userInfo = $result->fetch_assoc ();
    $photoResult = $mysqli->query ( "SELECT * FROM images WHERE approved='N'" );
    $_SESSION ['AUTH'] = true;
    $_SESSION ['first_name'] = $userInfo ['first_name']; // Replace With
    $_SESSION ['username'] = $username ;
                                                        // Information
    if ($photoResult->num_rows == 0) {
        echo "There are no images awaiting approval.";
    } else {
        $rowPhoto = "";
        while ( $rowPhoto = $photoResult->fetch_assoc () ) {
            echo "<a href=\"approve_image_submit.php?images={$rowPhoto['big_images']}\" target=\"><img src=\"{$rowPhoto['url']}\" title=\"\">";
        }
    }

} else {

    die ( "You do not have permission to view this page. Redirect to index.phph Click <a
            href='login/login_page.php'>here</a> to log in." );
} 
```

我希望这有帮助

谢谢

# c# - 在特定时间间隔添加动画

> ID：10049383
> 
> 赞同：1
> 
> 时间：2012-04-06T21:18:49.683
> 
> 标签：c#, wpf, animation

我对动画比较陌生，所以我正在寻找一些方向。假设我`List<Label>`加载了一个带有 15 个标签的标签。我有`DoubleAnimation`在 500 毫秒内将不透明度从 0 设置为 1 的动画。我想循环，这些标签每 1000 毫秒开始一次动画。所以label1从0ms开始，label2从1000ms开始等等。

我知道我可以将 a 设置`Storyboard.Duration`为 1000ms*15 并将我的标签添加到 SB 并开始它，但是动画播放的速度与添加到 SB 的速度一样快。有没有办法以特定的时间间隔将动画添加到 SB？

**编辑：** 我不再使用`List<Label>`了这是我写的代码

```
class MessageWriter
{
    Storyboard _sb = new Storyboard();
    public MessageWriter()
    {

    }

    public void ProcessMessage(string _Message, WrapPanel _Panel)
    {
        string[] _Words = _Message.Split(new char[1]{Convert.ToChar(" ")});
        int _Counter = 1;
        _sb = new Storyboard();
        foreach (string _Word in _Words)
        {
            _Panel.Children.Add(ProcessWord(_Word));
            if (_Counter < _Words.Length)
            {
                _Panel.Children.Add(ProcessWord(" "));
            }
            _Counter++;
        }
        _sb.Begin();
    }

    private StackPanel ProcessWord(string _Word)
    {
        Debug.Print(_Word);
        StackPanel _Panel = new StackPanel();
        _Panel.Orientation = Orientation.Horizontal;
        _Panel.Margin = new System.Windows.Thickness(0, 0, 0, 0);

        foreach (char _c in _Word.ToList())
        {
            Label _Label = new Label();
            _Label.Opacity = 0;
            _Label.Margin = new System.Windows.Thickness(0, 0, 0, 0);
            _Label.Padding = new System.Windows.Thickness(0, 0, 0, 0);
            _Label.Content = _c.ToString();
            _Panel.Children.Add(_Label);
            AnimateLabel(_Label);
        }
        return _Panel;
    }

    private void AnimateLabel(Label _Label)
    {
        DoubleAnimation _da = new DoubleAnimation();
        _da.From = 0;
        _da.To = 1;

        int _MillSec = 500;
        _da.Duration = new System.Windows.Duration(new TimeSpan(0, 0, 0, 0, _MillSec));

        Storyboard.SetTargetProperty(_da, new PropertyPath(FrameworkElement.OpacityProperty));
        Storyboard.SetTarget(_da, _Label);
        _sb.Children.Add(_da);
    }
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-06T22:19:53.703

您可以简单地设置每个动画的[BeginTime](http://msdn.microsoft.com/en-us/library/system.windows.media.animation.timeline.begintime.aspx)。

而且绝对不需要故事板。只需将动画应用于标签：

```
DoubleAnimation opacityAnimation = new DoubleAnimation
{
    To = 1d,
    Duration = TimeSpan.FromSeconds(0.5),
    BeginTime = TimeSpan.FromSeconds((double)labelIndex)
};
labelIndex++;
label.BeginAnimation(UIElement.OpacityProperty, opacityAnimation); 
```

为什么每个变量名上都有奇怪的下划线？有广泛接受的[.Net 命名约定](http://msdn.microsoft.com/en-us/library/ms229045.aspx)。

# c++ - 对 std::queue 的 C/C++ 值分配

> ID：10049385
> 
> 赞同：1
> 
> 时间：2012-04-06T21:19:02.347
> 
> 标签：c++, c, queue, variable-assignment

我正在尝试将 char* 值从循环分配到队列中。我一直复制指针而不是分配数据本身。我觉得有一个简单的答案，但我找不到一个很好的例子。

例子

```
while(something) {
    next = queue.front();
    queue.pop();
    while(something) {
        /* do work */
        /* text has new value of char* */
        queue.push(text);
    }
} 
```

显然，这不起作用，因为当我为文本分配一个新值时，队列中的所有条目都会变成那个新值。我需要知道如何进行正确的复制/分配。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-06T21:21:11.443

改为使用`std::queue<std::string>`和`std::string`来保留字符串。

如果你从某个地方得到一个`char *`，你可以把它推到类型队列中`std::queue<std::string>`，字符串将被隐式构造。

如果您因任何原因不能使用 a `std::string`（尽管对于简单的情况，我想不出任何好的方法），您必须：

1.  获取字符串长度（例如使用`strnlen`）。
2.  分配该大小的新 char 数组
3.  从当前位置复制内容并将填充数组的指针推送到队列中。
4.  退出队列时，您必须记住释放 2 中分配的数组。

# php - 我不断收到空白值和无效文件

> ID：10049389
> 
> 赞同：-1
> 
> 时间：2012-04-06T21:19:13.520
> 
> 标签：php, javascript, jquery, ajax, file-upload

> **可能重复：**
> [它为 ImageId 插入一个空白值](https://stackoverflow.com/questions/10044822/it-inserts-a-blank-value-for-imageid)

我在[这里](http://jsfiddle.net/fPtMq/25/)有一个 jsfiddle ，用户可以在其中在文本区域中添加问题并在下面添加问题。现在，当用户添加问题时，它会在下表中添加问题，但也会添加包含文件输入的列。用户可以使用此输入选择图像文件。

现在我没有在 Jsfiddle 中包含提交按钮，但是当用户提交表单时，它会将用户带到 create_session.php 页面，但我在下面有一个 AJAX，它将在后台发布到 insertQuestion.php。

```
 function submitform()
{
    var fieldvalue = $("#QandA").val();
    $.post("insertQuestion.php", $("#QandA").serialize() ,function(data){
        var QandAO = document.getElementById("QandA");
        QandAO.submit();
    });  
    alert("Your Details for this Session has been submitted"); 
} 
```

现在在 insertQuestion.php 中，它做了两件事，首先它应该从文件输入字段上传所有文件，它应该将表单中的所有值插入到数据库中。

但是有两个问题：

问题1：

即使我上传了正确的文件类型，它也会不断回显我有一个“无效文件”。为什么要这样做以及如何修复它，以便它不会为有效文件回显“无效文件”。

问题2：

在 INSERT VALUES 代码中，即使从文件输入中选择了文件位置，它也会继续显示“ImageId”的空白值。为什么它一直显示空白值，如何解决？

以下是我目前看到的插入值示例：

```
INSERT INTO Question (QuestionContent, ImageId) VALUES ('What is my Name?',''), ('What is my Age','') 
```

下面是 insertQuestion.php 中的完整代码：

```
<?php

session_start();

 if ((($_FILES["fileImage"]["type"] == "image/gif")
|| ($_FILES["fileImage"]["type"] == "image/jpeg")
|| ($_FILES["fileImage"]["type"] == "image/pjpeg")
|| ($_FILES["fileImage"]["type"] == "image/jpg")
|| ($_FILES["fileImage"]["type"] == "image/png")
|| ($_FILES["fileImage"]["type"] == "image/tif")))
  {
  if ($_FILES["fileImage"]["error"] > 0)
    {
    echo "Return Code: " . $_FILES["fileImage"]["error"] . "<br />";
    }
  else
    {
    echo "Upload: " . $_FILES["fileImage"]["name"] . "<br />";
    echo "Type: " . $_FILES["fileImage"]["type"] . "<br />";
    echo "Size: " . ($_FILES["fileImage"]["size"] / 1024) . " Kb<br />";
    echo "Temp fileImage: " . $_FILES["fileImage"]["tmp_name"] . "<br />";

    if (file_exists("uploadimages/" . $_FILES["fileImage"]["name"]))
      {
      echo $_FILES["fileImage"]["name"] . " already exists. ";
      }
    else
      {
      move_uploaded_file($_FILES["fileImage"]["tmp_name"],
      "uploadimages/" . $_FILES["fileImage"]["name"]);
      echo "Stored in: " . "uploadimages/" . $_FILES["fileImage"]["name"];
      }
    }
  }
else
  {
  echo "Invalid file";
  }

$username="xxx";
$password="xxx";
$database="xxx";

mysql_connect('localhost',$username,$password);

mysql_select_db($database) or die( "Unable to select database");

$i = 0;
    $c = count($_POST['questionText']);

    $insertquestion = array();

    for($i = 0;  $i < $c; $i++ ){

      $imagequery = "SELECT ImageId FROM Image WHERE (ImageFile = '". mysql_real_escape_string($_POST['fileImage'])."')";
        $imagers = mysql_query($imagequery);
        $imagerecord = mysql_fetch_array($imagers);
        $imageid = $imagerecord['ImageId']; 

        $insertquestion[] = "'".  
                        mysql_real_escape_string( $_POST['questionText'][$i] ) ."','".
                        mysql_real_escape_string( $imageid [$i] ) ."'";

    }

     $questionsql = "INSERT INTO Question (SessionId, QuestionId, QuestionContent, QuestionMarks, OptionId, ImageId) 
        VALUES (" . implode('), (', $insertquestion) . ")";

    echo($questionsql);

mysql_close();

?> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-06T21:27:21.103

问题 1：由于您将 [] 添加到上传文件名 $_FILES["fileImage"] 是一个 Files 数组，因此 ["type"] 仅存在于数组的每个元素中，因此 if 失败。

错误报告（E_ALL）；有助于防止此类错误。

问题 2 是问题 1，但使用 $_POST

# c++ - 我将如何清除链接列表？

> ID：10049391
> 
> 赞同：1
> 
> 时间：2012-04-06T21:19:32.567
> 
> 标签：c++, pointers, linked-list, shortest-path

我一直在尝试编写一个最短路径算法，dijkstras 算法，找到前两个顶点的最短路径就可以了。我在尝试清除链表和优先级队列时遇到了问题。

```
class llNode {
public:
    int id;
    int source;
    int weight;
    llNode* next;
    llNode(int key, int distance, int from) {
        id=key;
        weight=distance;
        source=from;
        next = NULL;
    }
};

class lList {
private:
    llNode* root;
    llNode* end;

    void clearAll(llNode* toClear);

public:
    lList() {
        root = NULL;
    }

    void add(llNode* toAdd) {
        if ( root == NULL) {
            root = toAdd;
            end = toAdd;
            return;
        }

        end->next = toAdd;
        end=end->next;
    }

    bool isFound(int key) {
        for(llNode* ii= root; ii != NULL ; ii=ii->next) {
            if ( ii->id == key) {
                return true;
            }
        }

        return false;
    }

    void clearAll();

};

void lList::clearAll() {
clearAll(root);
}

void lList::clearAll(llNode* toClear) {
if(toClear == NULL) {
    return;
}

clearAll(toClear->next);

toClear=NULL;

} 
```

除了这些清晰的方法之外，我还尝试简单地将 root 设置为 NULL，并且我还尝试遍历列表并在每个元素上使用 delete。我必须幸运地使用这些方法中的任何一种。Root 不断设置为无效位置，我收到访问冲突错误。

有什么简单的我没看到的吗？我将如何从链表中删除每个元素？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-06T21:24:21.923

您需要检查每个元素并将其删除

```
Set pointer to root
While(pointer !=null)
{
  temp=pointer->next;
  delete[] pointer;
  pointer = temp;
} 
```

* * *

## 回答 #2

> 赞同：-3
> 
> 时间：2012-04-06T21:29:33.900

设置`root`为`NULL`将删除整个列表。

```
void lList::clearAll() {
     root = NULL;
} 
```

你说你试过这个。在这种情况下，您的访问冲突是如何发生的？

当心：我的代码可能包含内存泄漏！您可能希望遍历列表并取消分配每个项目，除非使用其他机制恢复它们的内存。

# mysql - 这个mysql创建触发器语句有什么问题

> ID：10049401
> 
> 赞同：2
> 
> 时间：2012-04-06T21:20:45.443
> 
> 标签：mysql

```
CREATE TRIGGER google_inventory BEFORE UPDATE ON `cataloginventory_stock_item`
FOR EACH ROW 
BEGIN 
   update `catalog_product_entity_int` 
   set value=20 
   where attribute_id=552 
          and entity_id=NEW.product_id 
          and NEW.is_in_stock=0;
   update `catalog_product_entity_int` 
   set value=21 
   where attribute_id=552 
          and entity_id=NEW.product_id 
          and NEW.is_in_stock=1;
  END; 
```

它给了我以下错误：

> 1064 - 您的 SQL 语法有错误；检查与您的 MySQL 服务器版本相对应的手册，以在第 4 行的 '' 附近使用正确的语法

我是一名 SQL Server 专家，无法确定问题所在。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-06T21:25:02.353

您需要更改分隔符。没有它，分号将结束 CREATE TRIGGER 语句。

```
delimiter |

CREATE TRIGGER google_inventory BEFORE UPDATE ON `cataloginventory_stock_item`
FOR EACH ROW 
BEGIN 
   update `catalog_product_entity_int` 
   set value=20 
   where attribute_id=552 
          and entity_id=NEW.product_id and NEW.is_in_stock=0;
   update `catalog_product_entity_int` 
   set value=21 
   where attribute_id=552 
          and entity_id=NEW.product_id and NEW.is_in_stock=1;
  END;
|

delimiter ; 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-06T21:25:39.210

触发器中的分号搞砸了。您必须使用`DELIMITER`关键字来更改 MySQL 使用的分隔符。

从[http://dev.mysql.com/doc/refman/5.0/en/create-procedure.html](http://dev.mysql.com/doc/refman/5.0/en/create-procedure.html)：

```
mysql> delimiter //

mysql> CREATE PROCEDURE simpleproc (OUT param1 INT)
    -> BEGIN
    ->   SELECT COUNT(*) INTO param1 FROM t;
    -> END//
Query OK, 0 rows affected (0.00 sec)

mysql> delimiter ; 
```

# r - 计算加权平均值和标准差

> ID：10049402
> 
> 赞同：35
> 
> 时间：2012-04-06T21:20:48.673
> 
> 标签：r, statistics, mean, weighted

我有一个时间序列`x_0 ... x_t`。我想计算数据的指数加权方差。那是：

```
V = SUM{w_i*(x_i - x_bar)^2, i=1 to T} where SUM{w_i} = 1 and x_bar=SUM{w_i*x_i} 
```

参考：[http ://en.wikipedia.org/wiki/Weighted_mean#Weighted_sample_variance](http://en.wikipedia.org/wiki/Weighted_mean#Weighted_sample_variance)

目标是基本上对时间较早的观察结果进行加权。这很容易实现，但我想尽可能多地使用内置功能。有谁知道这在 R 中对应什么？

谢谢

* * *

## 回答 #1

> 赞同：36
> 
> 时间：2012-04-07T02:23:28.007

R 提供加权平均值。事实上， ?weighted.mean 显示了这个例子：

```
 ## GPA from Siegel 1994
 wt <- c(5,  5,  4,  1)/15
 x <- c(3.7,3.3,3.5,2.8)
 xm <- weighted.mean(x, wt) 
```

再一步：

```
v <- sum(wt * (x - xm)^2) 
```

* * *

## 回答 #2

> 赞同：32
> 
> 时间：2014-06-24T10:59:42.420

Hmisc 包包含您需要的功能。

因此：

```
x <- c(3.7,3.3,3.5,2.8)

wt <- c(5,  5,  4,  1)/15

xm <- wtd.mean(x, wt)

var <- wtd.var(x, wt)

sd <- sqrt(var) 
```

不幸的是，Hmisc 包的作者没有包含显式`wtd.sd`函数。你必须平方根wtd.var。

查尔斯·康盖

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2017-08-18T18:22:29.300

`Hmisc`使用该`wtd.var()`功能时，我也遇到错误。幸运的是，`SDMTools`具有类似的功能，甚至可以直接为您计算 SD，而无需取 sqrt 方差。

```
library(SDMTools)

x <- c(3.7,3.3,3.5,2.8)
wt <- c(5,  5,  4,  1)/15  ## Note: no actual need to normalize weights to sum to 1, this will be done automatically.

wt.mean(x, wt)
wt.sd(x,wt)

wt.var(x, wt) 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2020-08-26T23:02:21.440

正如其他人所指出的，包`Hmisc`具有功能`wt.var()`。

请注意，您需要了解是否需要**频率**权重或**可靠性**权重。在您的情况下，我相信您对可靠性权重感兴趣，因此需要明确设置`normwt=TRUE`. 在这种情况下，您可以以任何格式（总和为 1，总和为 N 等）给出您的权重。如果要使用频率权重，则需要注意如何指定权重。

```
library(Hmisc)

n <- 3
x <- seq_len(n)
w <- c(0.1, 0.2, 0.6)
w2 <- w / min(w)
w3 <- w / sum(w)

## reliability weights?
wtd.var(x = x, weights = w, normwt=TRUE)
#> [1] 0.95
wtd.var(x = x, weights = w2, normwt=TRUE)
#> [1] 0.95
wtd.var(x = x, weights = w3, normwt=TRUE)
#> [1] 0.95

## frequency weights?
wtd.var(x = x, weights = w)
#> Warning in wtd.var(x = x, weights = w): only one effective observation; variance
#> estimate undefined
#> [1] -4.222222
wtd.var(x = x, weights = w2)
#> [1] 0.5277778
wtd.var(x = x, weights = w3)
#> Warning in wtd.var(x = x, weights = w3): only one effective observation;
#> variance estimate undefined
#> [1] Inf 
```

^(由[reprex 包](https://reprex.tidyverse.org)（v0.3.0）于 2020 年 8 月 26 日创建)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-04-08T02:27:10.013

Hmisc 包提供了这个功能：

[http://rgm2.lab.nig.ac.jp/RGM2/func.php?rd_id=Hmisc:wtd.stats](http://rgm2.lab.nig.ac.jp/RGM2/func.php?rd_id=Hmisc:wtd.stats)

# android - Android App 启动设备上所有已安装的应用程序

> ID：10049403
> 
> 赞同：1
> 
> 时间：2012-04-06T21:20:58.387
> 
> 标签：android, launch

我正在开发一个测试应用程序，它将一个接一个地连续启动设备上的每个应用程序。该应用程序主要用于通过上下文切换进行 UI 稳定性测试。我是 Android 新手，并试图找出沿途的事情。我将非常感谢任何建议

这就是我的应用程序应该做的事情：-

1.  查询设备并获取设备上所有应用程序的列表，
    包括系统应用程序
2.  现在依次启动每个应用程序，直到启动设备上的所有应用程序
3.  一旦完成列表浏览一次，它将从列表中的第一个应用程序重新开始

    让我们调用我的应用 Launcher_app 并假设设备上有 5 个应用 A、B、C、D、E。Launcher 应用将依次启动 A，然后是 B、C、D、E，然后通过启动 A 重新启动。这是将一直持续到用户手动存在启动器应用程序

我尝试实现该应用程序，但我对 android 系统如何允许这样的上下文切换有几个问题。

这是自动启动每个应用程序的代码片段

ublic Runnable AutoLaunch = new Runnable() {

```
public void run()
{

   while(AppIndex < mAppsList.getCount())
   {

       //get the app name using index AppIndex
       //launch app using the appname
      App app = (App) mAppsList.getItemAtPosition(AppIndex);
     Intent i = getPackageManager().getLaunchIntentForPackage(app.getPackageName());
       try 
          {
             if (i != null) 
             {
                startActivity(i);

             } 
             else 
             {
                i = new Intent(app.getPackageName());
                startActivity(i);

             }
             for(int j=0;j<2000;j++)
                 for(int k=0;k<10000;k++)
                     continue;
             finish();

          } 
          catch (ActivityNotFoundException err) 
          {
             //Toast.makeText(ListInstalledApps.this, "Error launching app", Toast.LENGTH_SHORT).show();
          }

    if(AppIndex == mAppsList.getCount()-1)
          AppIndex = 0;
      else                
          AppIndex++;

   } 
```

这是我的理解：-

启动器应用程序一开始将处于前台 (FG)。然后应用 A 进入前台 n Launcher_app 将进入后台（BG）。现在应用 B 进入 FG，应用 A 与 Launcher 应用一起进入 BG。以这种方式继续下去，有时应用程序 E 位于 FG 中，而包括 Launcher 应用程序在内的其余应用程序位于 BG 中。

当我尝试使用上述实现运行应用程序时，我看到应用程序正在启动，但应用程序顺序是随机的，此外，我在设备启动时没有看到非常多的应用程序，可能它发生得太快了....不确定。我直到我知道我在正确的轨道上才想继续

在这种情况下，对于下一次迭代，Launhcer 应用程序会按该顺序恢复应用程序 A、B、C、D、E 还是会重新启动每个应用程序？如果系统在实际场景中需要内存，Launcher 应用程序也会被杀死在 BG 中运行的设备上有近 50 个应用程序。或者系统会让我的应用程序保持活动状态，因为这是启动所有其他应用程序的主要应用程序。

请帮助我了解它是如何工作的，因为我真的想知道这样的应用程序是否可行？解决上述问题的最佳方法是什么。将不胜感激任何类型的指针/建议。

谢谢迷你

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-06T21:37:40.487

这是什么：

```
for(int j=0;j<2000;j++)
    for(int k=0;k<10000;k++)
        continue; 
```

如果您只是想引入延迟，您可以简单地睡一会儿或使用类似的东西[`postDelayed`](http://developer.android.com/reference/android/os/Handler.html#postDelayed%28java.lang.Runnable,%20long%29)来间隔通话。

我同意你的猜测，即这些应用程序启动得太快了。您实际上是同时启动所有这些，因此您会看到似乎是随机顺序（由于启动时间不同）以及一些甚至没有时间在另一个获得焦点之前显示其 UI。

修复你的延迟代码，其中大部分应该会好得多。

# iphone - 新 iPad 是否支持酷睿蓝牙，还是仅限于 iPhone 4S？

> ID：10049404
> 
> 赞同：1
> 
> 时间：2012-04-06T21:21:09.710
> 
> 标签：iphone, ios, bluetooth, core-bluetooth

我有一个关于 Core Bluetooth 框架的小问题。我知道 Core Bluetooth 仅适用于 iOS 5.0 或更高版本，但 Apple 文档也表示它仅适用于 iPhone 4S。

它是否也适用于新 iPad 或仅适用于 iPhone 4S？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-10T15:31:09.790

我正在开发一个 BLE 应用程序，我可以 100% 确认新 iPad (iPad 3) 与 BLE 以及 coreBluetooth 框架一起使用。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-06T22:08:28.363

是的，新 iPad[支持蓝牙 4.0](http://www.apple.com/ipad/specs/)，包括Core Bluetooth 所需[的 Low Energy 功能。](http://www.kickstarter.com/projects/elijahparker/timelapse-powerful-features-brilliant-timelapse/posts/186436)我认为可以安全地假设所有比 iPhone 4S 更新的 iOS 设备都将获得这种支持。

奇怪的是，该设备的文档尚未更新。

# r - 在 R 中，我如何遍历表中的列并根据列名执行计算？

> ID：10049408
> 
> 赞同：1
> 
> 时间：2012-04-06T21:21:34.377
> 
> 标签：r, loops

我正在加载这样的表格：

```
mydata <- read.table("c:\\file.tab", header=TRUE, sep="\t", quote="\"") 
```

我可以计算 COLUMN1_NAME 列中空白条目的百分比，如下所示：

```
sum(mydata$COLUMN1_NAME == "")/nrow(mydata) 
```

但是我有很多专栏。我想要一种循环抛出并计算每列的百分比的方法，而不是复制和粘贴上面的行并手动更改列名。我对**R**很陌生，所以任何帮助表示赞赏。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-06T21:25:24.670

使用带有数字而不是名称的方括号。

```
i <- 1

sum(sum(mydata[[i]] == "")/nrow(mydata) 
```

等等。

见`?Extract`。您也可以通过编程方式获取名称并使用它们，但这只是一个额外的步骤：

```
i <- 1
nms <- names(mydata)
sum(mydata[[nms[i]]] == "")/nrow(mydata) 
```

# java - 使用 Ctrl+C 携带存储语句的缓冲区

> ID：10049409
> 
> 赞同：1
> 
> 时间：2012-04-06T21:21:34.830
> 
> 标签：java, buffer, copy-paste

我正在尝试制作一个应用程序，该应用程序在某个阶段存储由`CTRL`+复制的所有语句`C`，并操作将当前语句携带到特定语句的“缓冲区”

示例：用户按下`CTRL`+`C`复制 "Hello" ，如果他在任何文本区域/字段按下`CTRL`+ `V`，书面文字将是 "Hello" ，我希望书面语句是 "Test" 而不是 "Hello"

问题是：如何访问携带复制语句的缓冲区并使用 Java 操作其内容？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-06T21:48:42.937

```
 public static void main(String[] args) throws Exception
  {
    // Get a reference to the clipboard
    Clipboard clipboard = Toolkit.getDefaultToolkit().getSystemClipboard();

    // Poll once per second for a minute
    for (int i = 0; i < 60; i++)
    {
      // Null is ok, because, according to the javadoc, the parameter is not currently used
      Transferable transferable = clipboard.getContents(null);

      // Ensure that the current contents can be expressed as a String
      if (transferable.isDataFlavorSupported(DataFlavor.stringFlavor))
      {
        // Get clipboard contents and cast to String
        String data = (String) transferable.getTransferData(DataFlavor.stringFlavor);

        if (data.equals("Hello"))
        {
          // Change the contents of the clipboard
          StringSelection selection = new StringSelection("Test");
          clipboard.setContents(selection, selection);
        }
      }

      // Wait for a second before the next poll
      try
      {
        Thread.sleep(1000);
      }
      catch (InterruptedException e)
      {
        // no-op
      }
    }
  } 
```

我为一些简单的可测试性/验证添加了轮询。它会在一分钟内每秒检查一次剪贴板。据我所知，没有办法进行基于事件的通知（除非你正在监听风味变化，但你不是），所以我认为你被轮询困住了。

# java - 将重启手机的 Android 应用小部件 - 小部件没有做任何事情？

> ID：10049413
> 
> 赞同：1
> 
> 时间：2012-04-06T21:21:55.793
> 
> 标签：java, android, android-widget

我开始为此拔头发了！我一直在尝试制作一个应用程序，它将在屏幕上放置一个小部件，单击该小部件将重新启动手机。小部件出现在屏幕上，但单击时没有任何反应。我一直在 youtube 上关注 bucky 的教程。

代码在这里，我不知道我做错了什么！

reboot_widget_activeity.java：

```
package com.liamwli.reboot_widget;

import android.app.Activity;
import android.app.PendingIntent;
import android.appwidget.AppWidgetManager;
import android.content.Context;
import android.content.Intent;
import android.os.Bundle;
import android.view.View;
import android.view.View.OnClickListener;
import android.widget.Button;
import android.widget.RemoteViews;

public class reboot_widget_activeity extends Activity implements
        OnClickListener {
    /** Called when the activity is first created. */
    int awID;
    AppWidgetManager awm;
    Context c = reboot_widget_activeity.this;

    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.main);

        Intent i = getIntent();
        Bundle extras = i.getExtras();
        if (extras != null) {
            awID = extras.getInt(AppWidgetManager.EXTRA_APPWIDGET_ID,
                    AppWidgetManager.INVALID_APPWIDGET_ID);
        }
        awm = AppWidgetManager.getInstance(c);
    }

    @Override
    public void onClick(View v) {
        // TODO Auto-generated method stub

        RemoteViews views = new RemoteViews(c.getPackageName(), R.layout.widget_layout);

        Intent in = new Intent(c, Reboot.class);
        PendingIntent pi = PendingIntent.getActivity(c, 0, in, 0);
        views.setOnClickPendingIntent(R.id.bRB, pi);

        awm.updateAppWidget(awID, views);

        Intent result = new Intent();
        result.putExtra(AppWidgetManager.EXTRA_APPWIDGET_ID, awID);
        setResult(RESULT_OK, result);
        finish();
    }
} 
```

重启.java：

```
package com.liamwli.reboot_widget;

import java.io.IOException;

import android.app.Activity;
import android.app.ProgressDialog;
import android.os.Bundle;
import android.widget.Toast;

public class Reboot extends Activity {

    @Override
    protected void onCreate(Bundle savedInstanceState) {
        // TODO Auto-generated method stub
        super.onCreate(savedInstanceState);
        ProgressDialog wait;
        wait = new ProgressDialog(Reboot.this);
        wait.setProgressStyle(ProgressDialog.STYLE_HORIZONTAL);
        wait.setMessage("Rebooting. If this hangs, then this app wont work on this device (pull battery)");
        wait.setCancelable(false);
        wait.show();
        try {
            Runtime.getRuntime().exec("su");
            Runtime.getRuntime().exec("reboot");
        } catch (IOException e) {
        }
        wait.dismiss();
        Toast.makeText(Reboot.this, "Unable to reboot. Please ensure your device is rooted!", Toast.LENGTH_LONG).show();
        finish();
    }

} 
```

小部件.java：

```
package com.liamwli.reboot_widget;

import android.appwidget.AppWidgetProvider;
import android.content.Context;
import android.widget.Toast;

public class Widget extends AppWidgetProvider {

    @Override
    public void onDeleted(Context context, int[] appWidgetIds) {
        // TODO Auto-generated method stub
        super.onDeleted(context, appWidgetIds);
        Toast.makeText(context, "Reboot Widget Added", Toast.LENGTH_SHORT)
                .show();
    }

} 
```

androidmanifest.xml：

```
<?xml version="1.0" encoding="utf-8"?>
<manifest xmlns:android="http://schemas.android.com/apk/res/android"
    package="com.liamwli.reboot_widget"
    android:versionCode="1"
    android:versionName="1.0" >

    <uses-sdk android:minSdkVersion="8" />

    <application
        android:icon="@drawable/ic_launcher"
        android:label="@string/app_name" >
        <activity
            android:name=".reboot_widget_activeity"
            android:label="@string/app_name" >
            <intent-filter>
                <action android:name="android.intent.action.MAIN" />

                <category android:name="android.intent.category.LAUNCHER" />
            </intent-filter>
        </activity>

    <receiver android:name=".Widget">

        <intent-filter>
            <action android:name="android.appwidget.action.APPWIDGET_UPDATE" />
        </intent-filter>

        <meta-data android:name="android.appwidget.provider" android:resource="@xml/widgetstuff"/>
    </receiver>

    <activity
            android:name=".Reboot"
            android:label="@string/app_name" >
            <intent-filter>
                <action android:name="com.liamwli.reboot_widget.REBOOT" />

                <category android:name="android.intent.category.DEFAULT" />
            </intent-filter>
        </activity>

    </application>

</manifest> 
```

小部件stuff.xml：

```
<?xml version="1.0" encoding="utf-8"?>
<appwidget-provider xmlns:android="http://schemas.android.com/apk/res/android" android:minHeight="40dp" android:minWidth="40dp" android:initialLayout="@layout/widget_layout">

</appwidget-provider> 
```

小部件布局.xml

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    android:orientation="vertical" >

    <Button
        android:id="@+id/bRB"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:text="Reboot" />

</LinearLayout> 
```

Eclipse 没有给我任何错误，而且我没有得到任何强制关闭。小部件上的按钮根本不做任何事情 - 为什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-06T21:26:01.777

改变这个：

```
Runtime.getRuntime().exec("su");
Runtime.getRuntime().exec("reboot"); 
```

对此：

```
Runtime.getRuntime().exec("su -c reboot"); 
```

*原因*：你不能分开这两个命令，因为然后**su**单独运行并且**reboot**在没有*su的情况下运行*

PS不要忘记添加所需的权限

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-06T21:28:11.560

清单中缺少权限。请注意， il 仅适用于实际设备，不适用于模拟器

```
<uses-permission android:name="android.permission.REBOOT" /> 
```

# python - timeit 模块中的 Reindent()，help('timeit') 不显示函数名。为什么？

> ID：10049414
> 
> 赞同：1
> 
> 时间：2012-04-06T21:22:09.343
> 
> 标签：python, function, module

当我执行帮助（'timeit'）时，位于 timeit 模块（Python（2.7）标准库）中的以下函数不会显示。

```
def reindent(src, indent):
    """Helper to reindent a multi-line statement."""
    return src.replace("\n", "\n" + " "*indent) 
```

当我在模块中定义一个函数并调用 help('modulename') 时，可以在 help() 输出中看到函数。调用 help() 时，不显示以下划线开头的函数名称。但是 reindent 函数没有前导下划线，但它没有显示在帮助输出中。为什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-06T21:29:25.063

在模块的开头`__all__`定义了一个变量：

```
__all__ = ["Timer"] 
```

这限制了从 timeit 导入的内容。例如，请参见[此处](http://docs.python.org/tutorial/modules.html#importing-from-a-package)的描述`__all__`。如果您评论该行，帮助会提供有关数据和功能的更多信息

# android - 检查 JSON 中是否存在对象

> ID：10049415
> 
> 赞同：3
> 
> 时间：2012-04-06T21:22:14.723
> 
> 标签：android, json, deserialization, gson

我需要知道一个对象是否存在于 JSON 字符串中，并根据该对象的存在做不同的事情。如果它不存在，我想省略该对象，因为它会抛出 NullPonterException。我试过使用**if**但没有成功...有人可以告诉我如何检查对象的存在吗？

先感谢您！

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-04-06T21:52:38.883

尝试以下操作：

```
String jsonString = yourJsonString;
String nameOfObjectInQuestion = "yourObjectInQuestion";
JSONObject json = null;
JSONObject objectInQuestion = null;
try { 
    json = new JSONObject(jsonString); 
    objectInQuestion = json.getJSONObject(nameOfObjectInQuestion);
} 
catch (JSONException ignored) {}

if (objectInQuestion == null) {
    // Stomp your feet
}
else {
    // Clap your hands
} 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-12-09T00:54:48.733

您可以在 JSONObjects 上使用 isNull() 函数。

*"boolean isNull(String name) 如果此对象没有 name 映射或者它有一个值为 NULL 的映射，则返回 true。* "

```
JSONObject contact = venueitem.getJSONObject("contact");

if (contact.isNull("formattedPhone") == false)
    venue.phone = contact.getString("formattedPhone");
else
    {
    ...
    } 
```

来源： http: [//developer.android.com/reference/org/json/JSONObject.html#isNull(java.lang.String)](http://developer.android.com/reference/org/json/JSONObject.html#isNull(java.lang.String))

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2015-05-27T13:37:43.540

使用 JSONObject.has(String)。

```
 JSONObject MyObject = null;
 if(JSONObject.has("ObjectName")){
        MyObject = JSONObject.getJSONObject("ObjectName");
 }

 if(MyObject != null){
  // do stuff
 } 
```

[http://developer.android.com/reference/org/json/JSONObject.html#has(java.lang.String)](http://developer.android.com/reference/org/json/JSONObject.html#has(java.lang.String))

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-11-29T11:18:30.487

或者..更简洁...

```
myJSONObject.isNull("myfield")?"":myJSONObject.getString("myfield") 
```

# android - Android 自定义滚动条图标

> ID：10049416
> 
> 赞同：2
> 
> 时间：2012-04-06T21:22:22.940
> 
> 标签：android

我想知道设置在列表视图上快速滚动时出现的图标的确切步骤。这显示为一个银色图标，其中有三条线穿过它。不确定这个叫什么名字。我想它可能被称为拇指。请发布详细的回复，显示用我自己的图片替换它的确切步骤。我还可以在 sdk 中的哪里找到银色小图标，以便我可以正确调整我的大小或指示它的尺寸。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-08-18T03:49:13.603

创建您的样式并应用于您的滚动视图

```
style name="code_droid_style">  
    <item name="android:scrollbarAlwaysDrawVerticalTrack">true</item>
    <item name="android:scrollbarStyle">outsideOverlay</item>
    <item name="android:scrollbars">vertical</item>
    <item name="android:fadeScrollbars">false</item>
    <item name="android:scrollbarThumbVertical">@drawable/code_droid_thumb</item>
</style> 
```

我认为这里存在默认值：`..\platforms\android-N\data\resscrollbar_handle_accelerated_anim2.9`，搜索此类型，您应该找到它

# c# - Oracle.DataAccess.Client.BulkCopy - 尝试将 varchar2 转换为不应该的数字

> ID：10049418
> 
> 赞同：2
> 
> 时间：2012-04-06T21:22:24.070
> 
> 标签：c#, oracle11g, odp.net

我有一个表`(A)` ，其中包含一个名为`confirmation_number`. 它被定义为 a`varchar2(30)`并包含类似`SMITERI-2012-02-31-4567`.

我有另一个表`(B)`，其中还包含一个名为 的列`confirmation_number`，它也是一个`varchar2(30)`.

我有一个存储过程，它从中提取数据`A`，对其执行一些转换，它包括确认号列。

我使用`C#`and`ODP.Net`运行存储过程并`DataTable`用它加载 a 。然后我执行一些额外的转换。但是，我从来没有碰过确认号码栏。

最后，我创建一个`OracleBulkCopy`对象，设置列映射，告诉它`update`Table `B`，然后调用`loader.WriteToServer(dataTable)`.

**我收到以下错误**：

```
Input string was not in a correct format.
   at System.Number.StringToNumber(String str, NumberStyles options, NumberBuffer& number, NumberFormatInfo info, Boolean parseDecimal)
   at System.Number.ParseInt64(String value, NumberStyles options, NumberFormatInfo numfmt)
   at Oracle.DataAccess.Client.OracleBulkCopy.PerformBulkCopy() 
```

我已经确认该`confirmation_number`列上发生了错误，因为如果我不加载该列，则数据加载成功。

任何想法为什么`BulkCopy`会试图把 a`varchar(2)`变成 a `Number`？

**编辑：** 我已经确认了以下相关问题：

1.  这不仅发生在确认号码上。这似乎只是字符串列上的问题 - 无论是从字符串到字符串还是从字符串到整数。

2.  这不会发生在每个 varchar2 列上 - 姓氏和名字都没有问题。

3.  这发生在没有空值的列（确认号）和可能具有空值的列（街道类型）上。

4.  在加载程序开始之前调查数据表的内容表明，成功进入和没有成功进入的列定义没有区别。

我开始怀疑 BulkCopy 本身是否存在错误，是否需要使用另一个实用程序来执行此加载。

**编辑：**

下面是精简后的代码。

**表 A**

```
 CREATE TABLE "APPS_UNPROCESSED" 
   (    "LAST_NAME" VARCHAR2(30 BYTE), 
    "FIRST_NAME" VARCHAR2(30 BYTE), 
    "MIDDLE_NAME" VARCHAR2(30 BYTE), 
    "NAME_SUFFIX" VARCHAR2(30 BYTE), 
    "GENDER" VARCHAR2(1 BYTE), 
    "DATE_OF_BIRTH" VARCHAR2(10 BYTE), 
    "ID" NUMBER, 
     :
     :
    "CONFIRMATION_NUMBER" VARCHAR2(30 BYTE) NOT NULL ENABLE, 
    "IS_FBO" NUMBER(1,0), 
     :
     :
     CONSTRAINT "VR_APPS_UNPROCESSED_PK" PRIMARY KEY ("CONFIRMATION_NUMBER") 
```

**表 B**

```
 CREATE TABLE "APPS_PROCESSED"
   (    "LAST_NAME" VARCHAR2(30 BYTE), 
    "FIRST_NAME" VARCHAR2(30 BYTE), 
    "MIDDLE_NAME" VARCHAR2(30 BYTE), 
    "NAME_SUFFIX" VARCHAR2(30 BYTE), 
    "GENDER" NUMBER(1,0), 
    "DATE_OF_BIRTH" DATE,
     :
     :
    "CONFIRMATION_NUMBER" VARCHAR2(30 BYTE), 
    "ID" NUMBER, 
    "IS_FBO" NUMBER(1,0),
     :
     :
    "ID" NUMBER NOT NULL ENABLE, 
     :
     :
     CONSTRAINT "VR_APPLICATION_PK" PRIMARY KEY ("ID") 
```

**程序**

```
 procedure getUnprocessedApps(results OUT sys_refcursor)
   as
   BEGIN
    open results for
      select 
        a.last_name
        ,a.first_name
        ,a.middle_name
        ,a.name_suffix
        ,decode(a.gender, 'M', 1, 0) as gender_id
        ,a.gender as gender_code
        ,to_char(to_date(a.date_of_birth, 'MM-DD-YYYY'), 'DD-mon-YYYY') as date_of_birth
        ,cast(a.confirmation_number as varchar2(30)) as confirmation_number
        ,a.id
        ,0 as is_fbo
     :
     :
      from vr_apps_unprocessed a 
```

**获取数据**

```
 DataSet data = new DataSet();
                OracleConnection conn = null;
                OracleCommand cmd = null;
                OracleDataAdapter data_adapter = new OracleDataAdapter();

                //fetch the data and load
                using (conn = new OracleConnection(connString))
                {
                    using (cmd = new OracleCommand())
                    {

                        cmd.Connection = conn;
                        cmd.CommandText = "APPS.getUnprocessedApps";
                        cmd.CommandType = CommandType.StoredProcedure;
                        cmd.Parameters.Add("results", OracleDbType.RefCursor, ParameterDirection.Output);
                        conn.Open();
                        data_adapter.SelectCommand = cmd;
                        data_adapter.Fill(data, "results");
                    }
                }
                return data.Tables["results"]; 
```

**设置列映射**

```
 private static Dictionary<string, string> ColumnMappings()
    {
        Dictionary<string, string> mapping = new Dictionary<string, string>();
        mapping.Add("last_name", "last_name");
        mapping.Add("first_name", "first_name");
        mapping.Add("middle_name", "middle_name");
        mapping.Add("name_suffix", "name_suffix");
        mapping.Add("gender_id", "gender"); 
        mapping.Add("date_of_birth", "date_of_birth");
        mapping.Add("is_fbo", "is_fbo"); 
        mapping.Add("confirmation_number", "confirmation_number");
        mapping.Add("id", "id"); 
     :
     :
            return mapping;
    } 
```

**加载文件**

```
 private static void loadFiles(DataTable dt, string connString)
        {
            OracleConnection orclconn = null;
            OracleBulkCopy loader = null;

            //now insert the data into Oracle               
            using (orclconn = new OracleConnection(connString))
            {
                orclconn.Open();
                using (loader = new OracleBulkCopy(orclconn)) 
                {
                    loader.DestinationTableName = "APPS_Processed"

                    foreach (KeyValuePair<string, string> k in ColumnMappings())
                    {
                        loader.ColumnMappings.Add(k.Key, k.Value);
                    }

                    loader.WriteToServer(dt);

                } //end using oracle bulk loader

            } //end using oracle connection

        } 
```

**编辑：** 我无法让批量复制工作，但我已经获得了使用数组工作的传统方法：[http ://www.oracle.com/technetwork/issue-archive/2009/09-sep/o59odpnet- 085168.html](http://www.oracle.com/technetwork/issue-archive/2009/09-sep/o59odpnet-085168.html)

它肯定比成功的批量加载要慢，但至少我可以获取数据。不过，如果有人对为什么批量复制本身不断失败有任何想法，我仍然很乐意。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-06T20:02:24.623

似乎`BulkCopy`根据给定的列的声明类型进行了某种类型转换`DataTable`。

如果您`Column.DataType.ToString()`为导致问题的列打印 ，则很有可能您会看到与数据库期望的类型不同的类型。

您可以从使用旧的数据表创建一个新的数据表，但`Column.DataType`将麻烦的列显式更改为数据库期望的类型。

```
public DataTable potentialFix(DataTable dt) {    
    DataTable newTable = new DataTable(dt.TableName);

    //define columns for the new table with type string (or whatever type you want)
    foreach (DataColumn dc in dt.Columns)
    {
        newTable.Columns.Add(new DataColumn(dc.ColumnName, typeof(String)));
    }

    newTable.BeginLoadData();
    DataTableReader dtReader = new DataTableReader(dt);
    newTable.Load(dtReader);
    newTable.EndLoadData();

    return newTable;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-11T06:27:09.770

我相信问题出在您的“date_of_birth”列中。您传递的是字符串而不是日期。由于日期是数字，它会尝试转换它们，但它不是它期望的格式，您更改了月份和日期的顺序。

# vba - 如何访问 Excel VBA 中的联系人组？

> ID：10049419
> 
> 赞同：9
> 
> 时间：2012-04-06T21:22:35.287
> 
> 标签：vba, excel, outlook

我正在构建一个 Excel 加载项，它将活动工作簿作为 Outlook 电子邮件模板中的附件发送到特定的联系人组。

我已经得到了前两部分来使用下面的代码，但我不确定如何将该`.TO`字段设置为联系人组。

```
Public Sub Mail_Reports()
    Dim rng As Range
    Dim OutApp As Object
    Dim OutMail As Object 

    With Application
        .EnableEvents = False
        .ScreenUpdating = False
    End With

    On Error Resume Next

    Set OutApp = CreateObject("Outlook.Application")

    'Set this line to the path and file name of your template
    Set OutMail = OutApp.CreateItemFromTemplate("C:\Users\moses\AppData\Roaming\Microsoft\Templates\test.oft")
    On Error Resume Next

    With OutMail
        '.TO field should be set to the contact group
        .BCC = ""
        .Attachments.Add ActiveWorkbook.FullName
        .HTMLBody = Replace(OutMail.HTMLBody, strOldPeriod, strNewPeriod)
        .Subject = Replace(OutMail.Subject, strOldPeriod, strNewPeriod)
        'To display the email leave as is;  to send the Email, change to .Send
        .Display    'or Send
    End With

    On Error GoTo 0

    With Application
        .EnableEvents = True
        .ScreenUpdating = True
    End With

    Set OutMail = Nothing
    Set OutApp = Nothing
End Sub 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-06T22:03:17.497

只需使用联系人组的名称（以前称为“分发列表”）。[按照Ron de Bruin](http://www.rondebruin.nl/win/s1/outlook/tips.htm)网站上的建议，我刚刚尝试过，它确实有效。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2021-08-17T14:39:04.917

扩展接受的答案以简单地使用名称，确保联系人组名称不模棱两可。

例如，如果我有两个名为“我的列表”和“我的列表 2”的组。当我尝试手动发送电子邮件并仅在“收件人”框中键入“我的列表”时，Outlook 会显示一个弹出窗口，询问要解决哪个列表。这有点像 Excel 中的自动填充建议。相反，如果我键入“我的列表 2”，Outlook 将准确地知道我想要哪个列表。

同样，当通过 VBA 尝试相同的事情时，Outlook 会感到困惑，并且错误消息不是很清楚：“Outlook 无法识别一个或多个名称”。

我知道的最简单的解决方法是将“我的列表”的名称更改为“我的列表 1”或其他任何完全唯一的名称，其中没有其他列表共享该确切的基本名称。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-23T15:55:55.047

为了解析收件人的电子邮件地址或姓名（因此它们不只显示纯文本），您可以执行以下操作。

```
With OutMail
    '.TO field should be set to the contact group
    .BCC = ""
    .Attachments.Add ActiveWorkbook.FullName
    .HTMLBody = Replace(OutMail.HTMLBody, strOldPeriod, strNewPeriod)
    .Subject = Replace(OutMail.Subject, strOldPeriod, strNewPeriod)
    'To display the email leave as is;  to send the Email, change to .Send
    .Display    'or Send
    If Not .Recipients.ResolveAll Then
        For Each Recipient In .Recipients
            If Not Recipient.Resolved Then
                MsgBox Recipient.Name & " could not be resolved"
            End If
        Next 
    End If
End With 
```

# ruby - 深度哈希检查

> ID：10049421
> 
> 赞同：1
> 
> 时间：2012-04-06T21:22:39.343
> 
> 标签：ruby

好的，这有点复杂，但我需要遍历这个哈希来查找每个元素是否满足以下条件之一：

**值是一个字符串**

或者

**该值是一个哈希，包含字符串，而不是哈希**

或者

**值是一个哈希，包含字符串和/或哈希**

或者

**值是一个数组**

**更新：**

非常奇怪的事情...... [编辑：这是因为 #collect 正在返回哈希的键值对，它们是数组]

```
irb> my_hash['gd:name'].collect(&:class)
=> [Array, Array] 
```

查看下面的散列，该内部元素的类应该是散列，而不是数组？

检查它看起来像：

```
irb> my_hash['gd:name'].collect(&:inspect)
=> ["[\"gd:givenName\", {\"$t\"=>\"Thomas\"}]", "[\"gd:familyName\", {\"$t\"=>\"Chapin\"}]"] 
```

*但它的行为就像一个哈希：*

```
irb> my_hash['gd:name']['gd:givenName']
=> {"$t"=>"Thomas"}
irb> my_hash['gd:name']['gd:givenName']['$t']
=> "Thomas" 
```

* * *

```
{
  "gd:etag"=>"\"Rnk7fjVSLyt7I2A9WhVQEU4KRQI.\"",
  "id"=>{
    "$t"=>"da513d38e88d949"
   },
  "gd:name"=>{
    "gd:givenName"=>{"$t"=>"Thomas"}, "gd:familyName"=>{"$t"=>"Chapin"}
  },
  "gd:phoneNumber"=>[
    {
      "rel"=>"mobile",
       "$t"=>"(480) 703-4887"
    }
  ], 
  "gd:email"=>[
    {
      "rel"=>"home",
      "primary"=>"true",
       "address"=>"tchapin@gmail.com"
    }, 
    {
      "rel"=>"work",
      "address"=>"tom@tornadodesign.com"}
  ]
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-06T21:34:40.673

您可以测试哈希值的类别。

```
hash.each do |key, value|
  if value.is_a? String 
    # do String work
  elsif value.is_a? Hash
    #do Hash work
  elsif value.is_a? Array
    # do Array work
  end
end 
```

编辑：更新了 Niklas B 的建议。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-06T22:10:27.797

检查哈希值。

如果每个都返回真：

*   值是字符串或数组   
*   值是一个非空的散列，仅包含字符串和/或散列

带有一些打印的解决方案以显示正在发生的事情：

```
puts hash.each_pair.all?{|k,v|
  puts "key #{k} = value #{v} class #{v.class}"
  case v
  when String, Array
    true
  when Hash
    return false if v.empty? 
    v.each_pair.all?{|k2,v2|
      puts "inner key #{k2} = value #{v2} class #{v2.class}"
      case v2
      when String, Hash
        true
      else
        false
      end
    }
  else
    false
  end
} 
```

If you don't care to keep track of the keys, you can change #each_pair to #values

# windows-phone-7 - 在 AdRotator 控件中指定多种区域性

> ID：10049426
> 
> 赞同：0
> 
> 时间：2012-04-06T21:23:09.780
> 
> 标签：windows-phone-7, windows-phone-7.1, windows-phone, adrotator

我将 adRotator 控件与我的 Windows Phone 7 应用程序一起使用。他们有一个文件，根据您所在的国家/地区指定要播放的广告：

```
<AdSettings> 
    <CultureDescriptors> 
        <AdCultureDescriptor CultureName="en-US"> 
            <Probabilities Probability="60" AdType="Smaato" /> 
            <Probabilities Probability="40" AdType="AdMob" /> 
        </AdCultureDescriptor> 
        <AdCultureDescriptor CultureName="en-GB"> 
            <Probabilities Probability="60" AdType="Smaato" /> 
            <Probabilities Probability="40" AdType="AdMob" /> 
        </AdCultureDescriptor> 
        <AdCultureDescriptor CultureName="de-DE"> 
            <Probabilities Probability="80" AdType="Smaato" /> 
            <Probabilities Probability="20" AdType="AdMob" /> 
        </AdCultureDescriptor> 
    </CultureDescriptors> 
</AdSettings> 
```

如您所见，我指定了 3 种不同的文化（en-US、en-GB 和 de-DE）。但是，其中 2 个具有完全相同的设置（en-US、en-GB）。

有没有办法在同一个节点上指定多种文化？我尝试了以下方法，但似乎不起作用。

```
<AdSettings> 
    <CultureDescriptors> 
        <AdCultureDescriptor CultureName="en-US, en-GB, da-DK"> 
            <Probabilities Probability="60" AdType="Smaato" /> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-11T01:55:20.807

[WP统一广告控件](http://wpunifiedad.codeplex.com/)在一个节点中支持多个国家/地区，例如关注，它还提供多个事件，可以帮助获得对广告和广告空间的更多控制。

```
<AdCountryDescriptor Country="US, GB" InitialAdProvider="AdMob">
      <Probability Value="70" AdProvider="PubCenter" />
      <Probability Value="10" AdProvider="AdDuplex" />
      <Probability Value="10" AdProvider="MobFox" />
      <Probability Value="10" AdProvider="AdMob" />
      <Probability Value="20" AdProvider="NoAd" />
    </AdCountryDescriptor>
    <AdCountryDescriptor InitialAdProvider="PubCenter">
      <Probability Value="20" AdProvider="PubCenter" />
      <Probability Value="20" AdProvider="AdDuplex" />
      <Probability Value="20" AdProvider="MobFox" />
      <Probability Value="20" AdProvider="AdMob" />
      <Probability Value="20" AdProvider="NoAd" />
    </AdCountryDescriptor> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-06T21:38:46.727

答案是不。我已经下载了代码并查看了它 - 所以它是每个节点的单一文化。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-05T13:50:38.427

您可以添加一个`CultureDescriptor`名称为`default`. 如果您想要通用设置，则只需添加与默认设置不同的特定文化。

# webdav - Visual Studio 11 和 WebDAV？

> ID：10049436
> 
> 赞同：2
> 
> 时间：2012-04-06T21:24:31.243
> 
> 标签：webdav, visual-studio-2012

我一直在谷歌搜索，但似乎找不到直接的答案。

有谁知道 Visual Studio 11 是否支持通过 Studio 2010 中缺乏的 WebDAV 协议连接到 IIS 7/7.5？

# php - magento 客户/客户返回错误值

> ID：10049439
> 
> 赞同：1
> 
> 时间：2012-04-06T21:24:57.450
> 
> 标签：php, magento

我正在尝试将大量客户信息从 Magento 导入外部应用程序。外部应用程序已经知道他们的 entity_ids，我基本上想获取他们的客户对象并修改一些条目。

这是代码（感谢 StackOverflow 帮助我进行设置！）

```
$collection = Mage::getModel('customer/customer');
/* each $key is an entity ID */
foreach (array_keys($concatresult) as $key) {
   $collection->load($key);
   Zend_Debug::Dump("Key: " . $key . " Forum username:" . $collection->getForumUsername() . " Name: " .  $collection->getName());
} 
```

这是输出。实体 38、48、131*的“论坛用户名”为空*（这是一个自定义字段）：

```
string(53) "Key: 10955 Forum username:user1 Name: F1 L1"
string(47) "Key: 38 Forum username:user1 Name: F2 L2"
string(51) "Key: 48 Forum username:user1 Name: F3 L3"
string(50) "Key: 131 Forum username:user1 Name: F4 L4" 
```

然而返回的最后一个值是重复的。

我检查过：

*   仅返回 38、48、131 的 forum_username 条目按预期返回 NULL。

可能出了什么问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-09T13:44:07.113

解决了。我需要在循环中加载客户对象！

```
/* each $key is an entity ID */
foreach (array_keys($concatresult) as $key) {
    $collection = Mage::getModel('customer/customer');
    $collection->load($key);
    Zend_Debug::Dump("Key: " . $key . " Forum username:" . $collection->getForumUsername() . " Name: " .  $collection->getName());
} 
```

# numpy - 标量多变量函数的求根

> ID：10049443
> 
> 赞同：1
> 
> 时间：2012-04-06T21:25:25.370
> 
> 标签：numpy, scipy

编辑：更具体地说，我正在寻找一种实用的方法来绘制具有 2 个变量的标量函数的零点形状。所以这些值只需要精确到我选择的 2D 网格的分辨率。例如 f(x,y) = sqrt(x^2 + y^2) - 4 应该给我一个圆圈。

问题是 fsolve 需要一个向量函数，所以

```
from scipy.optimize import fsolve
def a(x): return sin(x[0]) + cos(x[1])
nodes = fsolve(a,(.1,.2)) 
```

不会工作。有什么解决方法吗？例如 def a(x): return [sin(x[0]) + cos(x[1]),0]

但它只输出 1 个解决方案（array([-1.37079633,0.2]) 而不是所有可能的零）。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-11T08:40:37.093

如果要诊断 2D 函数及其零点的行为，最好生成 2D 值网格，并使用 matplotlib 之类的东西进行绘图`pcolor`。然后，如果您真的需要精确找到零点的位置，您就知道从哪里开始`fsolve`寻找。

原则上，如果您对函数有所了解，例如，y 的每个值有多少个零，那么您将知道需要在每个最小值附近应用 fsolve 多少次。这可能会或可能不会被证明是足够稳健的。但是没有找到任意非线性函数的所有零点的通用解决方案，尤其是对于多维函数。

# jquery - jQuery：多个值 - 下拉菜单

> ID：10049446
> 
> 赞同：1
> 
> 时间：2012-04-06T21:25:44.093
> 
> 标签：jquery, html, css

这是在 jQuery 中传递两个 id 的正确方法吗？

如图所示，我遇到了以下问题。

域注册：不显示输入框。

域名转移：只显示一个输入框。

**图片：**

![在此处输入图像描述](../Images/e486232b0a742ba8e5e8f1fd4dbb05c1.png)

**CSS：**

```
#domainToBeReged, #domainToBeReged0, #domainToBeTransfered{
    display:none;
} 
```

**HTML：**

```
<label for="domainRequired">Domain Registration: </label>
                    <select name="domainRequired" id="domainRequired">
                        <option value="pleaseSelect">Please Select</option>
                        <option value="yes">Yes</option>
                        <option value="no">No</option>
                    </select>
        <div id="domainToBeReged">
            <label for="domainToBeReged">Domain One:</label><input name="domainToBeReged" id="domainToBeReged" type="text" placeholder="http://www." />
            <label for="domainToBeReged0">Domain Two:</label><input name="domainToBeReged0" id="domainToBeReged0" type="text" placeholder="http://www." />

        </div>
        <label for="domainTransfer">Domain Transfer: </label>
                    <select name="domainTransfer" id="domainTransfer">
                        <option value="pleaseSelect">Please Select</option>
                        <option value="yes">Yes</option>
                        <option value="no">No</option>
                    </select>
        <div id="domainToBeTransfered">
                    <label for="domainToBeTransfered">Domain:</label><input name="domainToBeTransfered" id="domainToBeTransfered" type="text" placeholder="http://www." />
                  <label for="domainToBeTransfered0">Domain:</label><input name="domainToBeTransfered0" id="domainToBeTransfered0" type="text" placeholder="http://www." />
        </div>
        <label for="currentHosting">Current Hosting: </label>
        <textarea cols="10" rows="10" name="currentHosting" id="currentHosting"></textarea>
        <input type="submit" class="nextButton" value="Next" />
        </fieldset>
    </form> 
```

**jQuery：**

```
 jQuery(document).ready(function() { 
$('select[name="domainRequired"]').change(function() {
            var $domain = $('#domainToBeReged','#domainToBeReged0');
                if ($(this).val() == 'yes') {
                    $domain.show();
                } else {
                    $domain.hide(); 
        }
            });             

        $('select[name="domainTransfer"]').change(function() {
            var $domain = $('#domainToBeTransfered');
                if ($(this).val() == 'yes') {
                    $domain.show();
                } else {
                    $domain.hide(); 
        }
            });             

    }); 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-06T21:30:03.737

这并不完全正确：

*   `$("selector1", "selector2")`正在寻找`selector1`里面`selector2`。它基本上相当于`$("selector2").find("selector1")`. 您似乎只需要两个独立的选择器。请改用*逗号选择器*。
*   您可以使用和/`.toggle(bool)`来消除。`if``show``hide`

```
$("#domainToBeReged, #domainToBeReged0").toggle($(this).val() === "yes"); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-06T21:29:55.407

不，您的 jquery 必须是：

```
$('#domainToBeReged,#domainToBeReged0'); 
```

# php - php preg_match_all 语法/正则表达式

> ID：10049449
> 
> 赞同：1
> 
> 时间：2012-04-06T21:26:28.547
> 
> 标签：php

我需要从这个字符串中取出单词并在 sql 语句中用 AND LIKE/NOT LIKE 替换，但我正在努力弄清楚:-)

```
$string = "hello -world !someword ! again |foo &foo AND foo ORfoo";
if (preg_match_all("/AND|OR|\||&|!|\-(\w+)/", "$string", $matches)) {
        foreach ($matches as $match) {
                foreach ($match as $m) {
                        // 1\. figure out what the delimiter was (!, |, &, -, AND, OR
                        // 2\. create a sql statement from it using the word following the delimiter
                        // Example:
                        if ($m = "!") {
                                $where .= " AND msg NOT like '%".$m."%'";
                        }
                        if ($m = "AND") {
                                $where .= " AND msg like '%".$m."%'";
                        }
                        if ($m = "OR") {
                                $where .= " OR msg like '%".$m."%'";
                        }
                }
        }
}
echo $where; 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-06T22:09:24.040

使用下面的代码来收集您的正则表达式匹配。请记住，preg_match_all 旨在收集给定模式的所有出现。请注意，我使用 preg_match 代替。"\s*" 允许您匹配存在的空格。

```
$results = array();
$word_to_capture = '\s*(\w+)%';
$patterns[] = "%(AND)" . $word_to_capture;
$patterns[] = "%(&)" . $word_to_capture;
$patterns[] = "%(OR)" . $word_to_capture;
$patterns[] = "%(\|)" . $word_to_capture;
$patterns[] = "%(!)" . $word_to_capture;
$patterns[] = "%(-)" . $word_to_capture;

foreach($patterns as $p):
    preg_match($p,$string,$matches);
    $results[] = $matches;
endforeach; 
```

然后你可以遍历 $results 数组来创建你的 MySQL 查询。生成的数组将如下所示。

```
Array
(
    [0] => Array
        (
            [0] => AND foo
            [1] => AND
            [2] => foo
        )

    [1] => Array
        (
            [0] => &foo
            [1] => &
            [2] => foo
        )

    [2] => Array
        (
            [0] => ORfoo
            [1] => OR
            [2] => foo
        )

    [3] => Array
        (
            [0] => |foo
            [1] => |
            [2] => foo
        )

    [4] => Array
        (
            [0] => !someword
            [1] => !
            [2] => someword
        )

    [5] => Array
        (
            [0] => -world
            [1] => -
            [2] => world
        )

) 
```

我在正则表达式中添加了一个额外的捕获。您的不同模式将在元素 1 中，单词将在元素 2 中。

您可以使用下面的代码来创建您的查询片段：

```
$query_fragment = "";
foreach($results as $r):
    switch (trim($r[1])):
        case "AND":
            $query_fragment .= " AND msg LIKE '%" . $r[2] . "%'";
            break;
        case "!":
            $query_fragment .= " AND msg NOT LIKE '%" . $r[2] . "%'";
            break;
        case "&":
            $query_fragment .= " AND msg LIKE '%" . $r[2] . "%'";
            break;
        case "OR":
            $query_fragment .= " OR msg LIKE '%" . $r[2] . "%'";
            break;
        case "|":
            $query_fragment .= " OR msg LIKE '%" . $r[2] . "%'";
            break;
    endswitch;
endforeach; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-06T22:03:30.297

您需要单独捕获触发器。那是：

```
/(AND|OR|\|&|!-)(\w+)/ 
```

您的表达式当前仅捕获一个破折号后的单词。

循环也不正确。你想要类似的东西

```
foreach ($matches[1] as $count => $match) {
   if ($match == '!') {
      $where . = " AND msg NOT LIKE '%" . $matches[2][$count] . "%'";
   }
} 
```

SQL 注入也可能是您关心的问题。

# algorithm - 自相交多边形的面积

> ID：10049454
> 
> 赞同：17
> 
> 时间：2012-04-06T21:27:20.363
> 
> 标签：algorithm, svg, 2d, polygon

计算一个*简单的不规则*多边形的面积[是微不足道的](http://www.mathopenref.com/coordpolygonarea2.html)。但是，考虑如下左图所示的自相交多边形 ABCDEF：

                    ![形如“8 字形”的自相交多边形](../Images/3020d873e937a72d1f9b3af1e2dd9b49.png)

如果我们使用上面的链接到公式以多边形顺序遍历点，我们得到的面积为 0。（“顺时针”区域抵消了“逆时针”区域。）

但是，如果我们[围绕中心对点进行径向排序](https://stackoverflow.com/questions/6989100/sort-points-in-clockwise-order)并计算面积，我们会在正上方得到多边形 ABEDCF 的错误面积。

如何最好地找到自相交多边形的可见区域？（如果答案需要为每个交叉点创建幻象点，请提供有关如何最好地找到交叉点以及如何以正确顺序遍历它们的详细信息。）

*在调查我对这个问题的解决方案的边缘案例时出现了[这个问题](https://stackoverflow.com/a/10045537/405017)。*

## 定义区域

我将“区域”定义为使用“非零”或“偶数”规则填充多边形时可见的像素数量。我会接受其中任何一个的答案，尽管两者都会更好。请注意，我*没有*明确定义自重叠区域以计算重叠区域两次。

![在此处输入图像描述](../Images/6620315197b0c52c38c1565a18fa4a71.png)

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-04-06T21:52:03.037

[您可以使用此页面](http://softsurfer.com/Archive/algorithm_0108/algorithm_0108.htm)中的以下伪代码尝试[Bentley–Ottmann](http://en.wikipedia.org/wiki/Bentley%E2%80%93Ottmann_algorithm)

**Bentley-Ottmann 算法**

Bentley-Ottmann 算法的输入是线段 Li 的集合 OMEGA={Li}，其输出将是交点的集合 LAMBDA={Ij}。该算法被称为“扫描线算法”，因为它的操作可以被可视化为具有另一条线，即“扫描线”SL，扫描集合 OMEGA 并在它通过各个片段 Li 时收集信息。为 SL 的每个位置收集的信息基本上是 OMEGA 中当前与 SL 相交的所有段的有序列表。维护此信息的数据结构通常也称为“扫描线”。此类结构还可以在发现交叉点时检测并输出它们。它发现交叉点的过程是算法及其效率的核心。

要实现扫描逻辑，我们必须首先对 OMEGA 的段进行线性排序，以确定 SL 遇到它们的顺序。也就是说，我们需要对所有段 Li 的端点 {Ei0,Ei1}i=1,n 进行排序，以便我们可以检测 SL 何时开始和停止与 OMEGA 的每个段相交。传统上，端点是通过先增加 x 然后增加 y 坐标值来排序的，但是任何线性顺序都可以（一些作者更喜欢先减少 y 然后增加 x）。在传统的排序中，扫描线是垂直的，在遇到每个线段时从左到右移动，如图所示：

图片扫描线

在算法中的任何一点，扫描线 SL 只与一个端点位于其左侧（或上方）而另一端点位于其右侧的线段相交。SL 数据结构通过以下方式保持这些段的动态列表：（1）在遇到最左边的端点时添加一个段，以及（2）在遇到最右边的端点时删除一个段。此外，SL 以“上下”关系对段列表进行排序。因此，要添加或删除一个段，必须确定其在列表中的位置，这可以通过对列表中的当前段进行最坏情况的 O(log-n) 二进制搜索来完成。此外，除了添加或删除段之外，还有一个事件改变了列表结构；即，每当两个线段相交时，它们在有序列表中的位置必须交换。鉴于这两个部分，

为了组织这一切，该算法维护了一个有序的“事件队列”EQ，其元素导致 SL 段列表发生变化。最初，EQ 设置为所有段端点的扫描排序列表。但是，当段之间的交叉点被发现时，它们也会以与端点使用相同的扫描顺序添加到 EQ 中，但必须测试以避免将重复的交叉点插入事件队列中。上图中的示例显示了这是如何发生的。在事件 2 中，段 S1 和 S2 导致交叉点 I12 被计算并放入队列中。然后，在事件 3 处，段 S3 介于 S1 和 S2 之间并将其分开。接下来，在事件 4 中，S1 和 S3 在扫描线上交换位置，并且 S1 再次靠近 S2，导致再次计算 I12。但是，每个路口只能有一个事件，并且 I12 不能两次入队。因此，当一个交叉点被放入队列时，我们必须在队列中找到它的潜在 x 排序位置，并检查它是否已经存在。由于任何两个线段最多有一个交点，因此用线段的标识符标记一个交点就足以唯一地标识它。由于这一切，事件队列的最大大小 = 2n+k.le.2n+n2，任何插入或删除都可以通过 O(log(2n+n2)) = O(log-n ) 二分查找。

但是，这一切与有效地找到完整的路段交叉点有什么关系呢？好吧，随着段被顺序添加到 SL 段列表中，它们与其他符合条件的段的可能交叉点被确定。当找到一个有效的交集时，它就会被插入到事件队列中。此外，当在扫描期间处理 EQ 上的交集事件时，它会导致 SL 列表的重新排序，并且交集也被添加到输出列表 LAMBDA。最后，当所有事件都处理完毕后，LAMBDA 将包含所有交点的完整有序集。

但是，我们仍然需要描述一个关键细节，即算法的核心；即，如何计算一个有效的交集？显然，只有当它们在某个时间同时出现在扫描线上时，它们才能相交。但这本身不足以使算法高效。重要的观察是两个相交的线段必须是扫描线上的直接上下邻居。因此，只有少数受限情况需要计算可能的交叉点：

当一个段被添加到 SL 列表中时，确定它是否与其上方和下方的邻居相交。

当从 SL 列表中删除一个段时，它之前的上下邻居将作为新邻居聚集在一起。因此，需要确定它们可能的交叉点。

在相交事件中，两个路段在 SL 列表中交换位置，并且必须确定它们与新邻居（每个一个）的相交。这意味着对于 EQ 的任何一个事件（端点或交集）的处理，最多需要进行两个交集确定。

一个细节仍然存在，即从 SL 结构中添加、查找、交换和删除段所需的时间。为此，SL 可以实现为平衡二叉树（例如 AVL、2-3 或红黑树），以保证这些操作最多花费 O(log-n) 时间，因为 n是 SL 列表的最大大小。因此，(2n+k) 个事件中的每一个事件至少有 O(log-n) 个处理要做。将初始排序和事件处理相加，算法的效率为：O(nlog-n)+O((2n+k)log-n)=O((n+k)log-n)。

**伪代码：Bentley-Ottmann 算法**

将所有这些放在一起，实现 Bentley-Ottmann 算法的顶级逻辑由以下伪代码给出：

```
 Initialize event queue EQ = all segment endpoints;
    Sort EQ by increasing x and y;
    Initialize sweep line SL to be empty;
    Initialize output intersection list IL to be empty;

    While (EQ is nonempty) {
        Let E = the next event from EQ;
        If (E is a left endpoint) {
            Let segE = E's segment;
            Add segE to SL;
            Let segA = the segment Above segE in SL;
            Let segB = the segment Below segE in SL;
            If (I = Intersect( segE with segA) exists) 
                Insert I into EQ;
            If (I = Intersect( segE with segB) exists) 
                Insert I into EQ;
        }
        Else If (E is a right endpoint) {
            Let segE = E's segment;
            Let segA = the segment Above segE in SL;
            Let segB = the segment Below segE in SL;
            Delete segE from SL;
            If (I = Intersect( segA with segB) exists) 
                If (I is not in EQ already) 
                    Insert I into EQ;
        }
        Else {  // E is an intersection event
            Add E’s intersect point to the output list IL;
            Let segE1 above segE2 be E's intersecting segments in SL;
            Swap their positions so that segE2 is now above segE1;
            Let segA = the segment above segE2 in SL;
            Let segB = the segment below segE1 in SL;
            If (I = Intersect(segE2 with segA) exists)
                If (I is not in EQ already) 
                    Insert I into EQ;
            If (I = Intersect(segE1 with segB) exists)
                If (I is not in EQ already) 
                    Insert I into EQ;
        }
        remove E from EQ;
    }
    return IL;
} 
```

此例程输出所有交点的完整有序列表。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-06T22:32:12.513

这是我的想法，我假设你的多边形中没有孔，有孔会更复杂，你应该首先从你的多边形中删除孔：

1.  首先找到多边形的凸包，为此您需要找到多边形顶点的凸包。并计算凸包面积。

2.  之后，找到多边形的所有交点。

3.  您应该从凸包中减去不属于原始多边形的额外多边形以找到您的多边形区域，将它们命名为*badpoly*。*badpolys*在凸包上总是至少有一个边框，因此该边框不属于您的原始多边形，将它们命名为*badborder*，通过遍历凸包，您可以找到所有*badborders*，但是要找到*badpoly*的其他边框，下一个连接的边框到鉴于相对于*badborder*具有最小角度的*badborder是**badpoly*的边界之一，您可以继续此操作以查找*badpoly的所有边界*然后计算它的面积，同样通过重复这种方式你可以计算所有*badpolys*的面积。

* * *

## 回答 #3

> 赞同：-2
> 
> 时间：2018-07-05T14:20:54.250

在这种情况下，Bentley-Ottmann 算法并不好。

因为它仅在您想要段之间的交点时才有效。

哈哈，我已经解决了通过将自相交多边形转换为多个多边形来计算自相交多边形的问题。

这是我的代码。

[https://github.com/zslzz/intersection_polygon](https://github.com/zslzz/intersection_polygon)

```
class SdPolygon(object):

  def __init__(self, points=None):
    points = self.parafloat(points)
    self.points = points
    self.current_points = []
    self.sd_polygons = []
    self.gene_polygon()
    from shapely.ops import cascaded_union
    self.sd_polygon = cascaded_union(self.sd_polygons)

  def parafloat(self, points):
    """
    为保证准确，将所有的浮点数转化为整数
    :return:
    """
    para_point = [(int(x), int(y)) for x, y in points]
    return para_point

  def gene_polygon(self):
    for point in self.points:
        self.add_point_to_current(point)  # 依次将点加入数组
    p0 = Polygon(self.current_points)
    self.sd_polygons.append(p0)

  def add_point_to_current(self, point):
    """
    将该点加入到current_points 中，倒序遍历current_points中的点，如果能围成多边形，则将所围成的点弹出
    :param point:
    :return:
    """
    if len(self.current_points) < 2:
        self.current_points.append(point)
        return
    cross_point_dict = {}  # 记录线段与其他点的相交点，{0:P1,6:P2}
    l0 = Line(Point(point[0], point[1]), Point(self.current_points[-1][0], self.current_points[-1][1]))
    for i in range(0, len(self.current_points) - 1):
        line = Line(Point(self.current_points[i][0], self.current_points[i][1]),
                    Point(self.current_points[i + 1][0], self.current_points[i + 1][1]))
        cross_point = self.get_cross_point(l0, line)  # 获取相交点
        if self.is_in_two_segment(cross_point, l0, line):  # 如果相交点在两个线段上
            cross_point_dict.update({i: cross_point})
    flag_dict = {}  # 保存剪下点的信息
    cross_points_list = sorted(cross_point_dict.items(), key=lambda item: item[0], reverse=True)  # [(3,P),(1,P)]
    for cross_point_info in cross_points_list:
        cross_i, cross_point = cross_point_info[0], cross_point_info[1]
        if flag_dict:  # 对应需要剪下多个多边形的情形，
            points = self.current_points[cross_i + 1:flag_dict['index'] + 1]
            points.append((flag_dict['point'].x, flag_dict['point'].y))
            points.append((cross_point.x, cross_point.y))
            p = Polygon(points)
            self.sd_polygons.append(p)
        else:
            points = self.current_points[cross_i + 1:]
            points.append((cross_point.x, cross_point.y))
            p = Polygon(points)
            self.sd_polygons.append(p)  # 将生成的polygon保存
        flag_dict.update(index=cross_i, point=cross_point)
    if flag_dict:
        point_list = self.current_points[:flag_dict['index'] + 1]  # 还未围成多边形的数组
        point_list.append((flag_dict['point'].x, flag_dict['point'].y))  # 加上交点
        self.current_points = point_list
    self.current_points.append(point)

  def is_in_segment(self, point, point1, point2):
    """
    交点是否在线段上
    :param point:(x,y)
    :param point1:[(x1,y1),(x2,y2)]
    :param point2:
    :return:
    """
    if point1.x > point2.x:
        minx = point2.x
        maxx = point1.x
    else:
        minx = point1.x
        maxx = point2.x
    if point1.y > point2.y:
        miny = point2.y
        maxy = point1.y
    else:
        miny = point1.y
        maxy = point2.y
    if minx <= point.x <= maxx and miny <= point.y <= maxy:
        return True
    return False

  def is_in_two_segment(self, point, l1, l2):
    """
    点 是否在两段 线段中间
    :param point:
    :param l1:
    :param l2:
    :return:
    """

    def is_same_point(p1, p2):
        """
        判断点是否相同
        :param p1:
        :param p2:
        :return:
        """
        if abs(p1.x - p2.x) < 0.1 and abs(p1.y - p2.y) < 0.1:
            return True
        return False

    if self.is_in_segment(point, l1.p1, l1.p2) and self.is_in_segment(point, l2.p1, l2.p2):
        if (is_same_point(point, l1.p1) or is_same_point(point, l1.p2)) and (
                    is_same_point(point, l2.p1) or is_same_point(point, l2.p2)):
            # 判断是否在两条线段的端点上
            return False
        return True
    return False

  def get_line_para(self, line):
    """
    规整line
    :param line:
    :return:
    """
    line.a = line.p1.y - line.p2.y
    line.b = line.p2.x - line.p1.x
    line.c = line.p1.x * line.p2.y - line.p2.x * line.p1.y

  def get_cross_point(self, l1, l2):
    """
    得到交点
    :param l1: 直线Line
    :param l2:
    :return: 交点坐标Point
    """
    self.get_line_para(l1)
    self.get_line_para(l2)
    d = l1.a * l2.b - l2.a * l1.b
    p = Point()
    if d == 0:
        return p
    p.x = ((l1.b * l2.c - l2.b * l1.c) // d)
    p.y = ((l1.c * l2.a - l2.c * l1.a) // d)
    return p 
```

# c++ - 信号处理程序与虚函数和继承（事件处理）

> ID：10049455
> 
> 赞同：3
> 
> 时间：2012-04-06T21:27:20.447
> 
> 标签：c++, event-handling, virtual, signals-slots

我有一个基本的 Window 类，我需要有诸如 MouseDown、MouseUp、WindowResized 等事件。我有两种可能的路线：信号处理程序（例如 Boost.Signal）或虚拟函数，该类的用户创建从 Window 派生的类并覆盖 OnMouseUp、OnMouseDown 和 OnWindowResized 函数。每种的优点和缺点是什么，还是风格问题？

我正在用 C++ 编写这个，但我想这个概念更重要。

提前谢谢，嗯。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-06T21:35:31.373

这是一项与各种方法（plain c、virtual、boost::signal 等）的性能相关的研究。[学习](http://www.kbasm.com/cpp-callback-benchmark.html)

据此， boost.signal 存在一些严重的问题。坦率地说，尽管我认为这是一个非常有趣的问题，因为我正在玩同样的想法，但我并没有使用太多该库。就目前而言，我会选择虚拟实现。

问候。:)

# c++ - “autoreconf”：找不到包含/Makefile.in

> ID：10049458
> 
> 赞同：0
> 
> 时间：2012-04-06T21:27:52.250
> 
> 标签：c++, compiler-construction, makefile, compiler-errors

我已经下载了我想编译的这个[tarball 。](http://libtheoraplayer.svn.sourceforge.net/viewvc/libtheoraplayer/trunk/)所以我写了这个：

```
/tmp/libtheoraplayer/trunk/$ autoreconf --force --install 
```

但我得到了这个：

`libtoolize: Consider adding `AC_CONFIG_MACRO_DIR([m4])' to configure.ac and libtoolize: rerunning libtoolize, to keep the correct libtool macros in-tree. libtoolize: Consider adding `-I m4' to ACLOCAL_AMFLAGS in Makefile.am. configure.ac:54: required file **`include/Makefile.in'** not found autoreconf: automake failed with exit status: 1`

但是文件 Makefile.in 在`src/`文件夹中..

任何想法？

哈维尔

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-07T17:38:26.890

据我所知，安装程序的最终用户不需要执行 autoreconf。它适用于开发人员。当您从存储库获得代码并尝试构建它时（即使您不是开发人员），您需要 autoreconf。如果不是这种情况，您只需尝试安装和使用该软件，尝试创建一个新副本，然后

```
./configure
make
make install 
```

高温高压

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-02T13:07:00.203

好吧，如果你需要 autoreconf，安装它

```
yum install automake autoconf 
```

# c - 使用 md5sum 更简单的不变量

> ID：10049460
> 
> 赞同：1
> 
> 时间：2012-04-06T21:28:13.353
> 
> 标签：c, discrete-mathematics, md5sum

我想使用不变量来区分数学对象。我有它们，它们是由一个整数序列 int[N] 形成的。不变量非常强大和有用，但它有一个缺点：它很庞大，因为 N 很大。

我想要的是有一个更简单的不变量，并且使用**md5sum**似乎是合适的。一些不同的不变量可以放在一起，但这不是问题，因为它们无论如何都只是不变量并且预计会很少见。对于这样的整数列表，是否有 md5sum 的 C 接口？这听起来是一个标准要求，但我找不到它。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-06T21:35:12.793

没有标准的 md5 C 库，但有很多免费的实现。在 Google 上搜索“md5 c”，[第一个链接](http://www.google.com/url?sa=t&rct=j&q=&esrc=s&source=web&cd=1&ved=0CDAQFjAA&url=http://people.csail.mit.edu/rivest/Md5.c&ei=ZmF_T8PKOIXXiAKzlZy1Aw&usg=AFQjCNEu3k_qiRjgKfQ-l002OXCUYqSaXA&sig2=S71aEwCFqAd-0I5NPyL1Tw)包含一个实现。

# java - 如何将损坏的西里尔字母转换为正常字母

> ID：10049461
> 
> 赞同：3
> 
> 时间：2012-04-06T21:28:20.147
> 
> 标签：java, character-encoding

我在服务器上有文件。最初他们的名字是可读的，用户将他们的文件（名字包含西里尔符号）放入服务器，我从我的应用程序中获取他们的文件。问题是当我从服务器获取这些文件时，它们的名称与原始名称不同。类似“Ìóõòîð...”的东西，但原始名称不包含此类符号（仅 абвгдеёжзийклмнопрстуфхцчшщьъэюя）。我不知道他们如何上传文件（他们有 ftp 访问权限），但肯定知道他们的名字在上传之前是“好”的，之后在服务器上是“损坏的”。甚至 filezilla 也显示其名称已损坏。

我需要帮助来恢复损坏的名称。我使用 Java

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-06T21:36:04.230

尝试这个：

```
 String s = "Ìóõòîð";
    final byte[] cp1252s = s.getBytes("Cp1252");
    final String s1 = new String(cp1252s, "Cp1251");
    System.out.println(s1); 
```

版画：Мухтор

# python - python 3.2 如何在函数之间传递变量中的数据

> ID：10049462
> 
> 赞同：0
> 
> 时间：2012-04-06T21:28:21.367
> 
> 标签：python, function, variables, python-3.x

我将如何存储并将 r 的内容从 main 传递到两个？如果我将它设置为 r = 某些已修复的内容，它将打印 r，但是如何将变量内容传递并保存到 r 中。我尝试了 random.getstate/setstate 但它说“函数对象不可下标”。

```
import random
from random import randrange

def main():
    r = random.randrange(1,13,1)
    print (r)

r = random.randrange(1,13,1)

def two():
    if r==7 or r==11:
       print (r)
    else:
       print (r)

  main()
  two() 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-06T21:31:01.250

好吧，根据情况，您要么创建一个类，要么返回数据，然后将其作为参数传递，后者可能是您想要的代码，例如：

```
def main():
  ...
  r = do_something()
  ...
  return r

def two(r):
  ...
  do_something_else(r)
  ...

r = main()
two(r) 
```

如果这发生在您可以定义为实体的事物中，则可以在类中进行：

```
class Main():
  def main(self):
    ...
    self.r = do_something()
    ...

  def two(self):
    ...
    do_something_else(self.r)
    ...

main = Main()
main.main()
main.two() 
```

但是，在这种情况下，这是不必要的，因为您正在创建一个并没有真正封装任何东西的类。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-06T21:31:29.473

使用返回值和函数参数：

```
import random
from random import randrange

def main():
    r = random.randrange(1,13,1)
    return r

def two(r):
    if r==7 or r==11:
       print (r)
    else:
       print (r)

r = main()
two(r) 
```

该函数`main`计算随机值，然后将其返回到调用它的位置。然后，您可以将返回值存储在变量中（`r`在这种情况下也称为：） `r = main()`。虽然它不需要被调用`r`，你也可以将它命名为其他名称。

要将值传递给`two`，您可以将其作为参数传递。正如您在 中看到的`def two(r):`，该函数`two`现在需要一个参数（也称为`r`），并且在该函数中使用它。同样，这不需要调用`r`，但使用相同的名称似乎很合适。

# sql - 存储过程使用临时表创建数据透视表

> ID：10049464
> 
> 赞同：2
> 
> 时间：2012-04-06T21:28:33.113
> 
> 标签：sql, sql-server, pivot, pivot-table

我有一个表 Survey_Data_Response，其中填充了来自两个表的“插入”语句 - Survey_Question 和 Survey_Response，它们在 QuestionID 上连接。

我想使用 SP 旋转 Survey_Data_Response 表并将结果保存到临时表中，以便查询它以开发报告。

Survey_Data_Response 表具有字段 - QuestionID、ResponseID、Question、Response、ResponseDateTime、moduleID。

问题的数量可能会因调查而异。

```
 QuestionID   Question   Response    ResponseDateTime       ResponseID   ModuleID
 123           Age          34       2011-06-06 18:21:00     ABC            123
 345           Gender       M        2011-06-06 18:21:00     DEF            123
 567           Phone       444-4444  2011-06-06 18:21:00     HIG            123
 123           Age          23       2011-06-07 12:01:00     MNO            123
 789           Postal Code 90988     2011-06-07 12:01:00     XYZ            123 
```

我需要将表格旋转为如下所示，将问题作为列并在相应字段中进行响应。

```
 ResponseID   Age    Gender     Phone     Postal Code     ResponsDateTime 
   ABC          34      M        444-4444                   2011-06-06 18:21:00
   XYZ          23                            90988         2011-06-07 12:01:00 
```

在过去的 2 天里，我尝试了许多数据透视查询，但没有任何运气。这就是我所在的位置，它返回列标题，但没有填充对问题的响应。

```
 DECLARE @cols VARCHAR(1000)
 DECLARE @sqlquery VARCHAR(2000)

 SELECT  @cols = STUFF(( SELECT distinct  ',' + QuoteName(question)
                    FROM temp_SURVEY_DATA FOR XML PATH('') ), 1, 1, '') 
 SET @sqlquery = 'SELECT * FROM
  (SELECT DynamicQuestionResponseID,question,moduleid 
   FROM temp_SURVEY_DATA ) base
   PIVOT (max(moduleid) FOR question
   IN (' + @cols + ')) AS finalpivot'

 EXECUTE ( @sqlquery ) 
```

有人可以帮我理解为什么这个 Pivot 不起作用以及如何使它起作用吗？

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-06T22:03:09.897

这应该给你你想要的：

```
create table temp_SURVEY_DATA
(
    questionid int,
    question varchar(50),
    response varchar(50),
    responsedatetime datetime,
    responseid varchar(3),
    moduleid int
)

insert into temp_SURVEY_DATA values(123, 'Age', '34', '2011-06-06 18:21:00', 'ABC', 123)
insert into temp_SURVEY_DATA values(345, 'Gender', 'M', '2011-06-06 18:21:00', 'ABC', 123)
insert into temp_SURVEY_DATA values(567, 'Phone', '444-4444', '2011-06-06 18:21:00', 'ABC', 123)
insert into temp_SURVEY_DATA values(123, 'Age', '23', '2011-06-07 12:01:00', 'XYZ', 123)
insert into temp_SURVEY_DATA values(789, 'Postal Code', '90988', '2011-06-07 12:01:00', 'XYZ', 123)

DECLARE @cols AS VARCHAR(MAX),
    @query  AS VARCHAR(MAX);

SET @cols = STUFF((SELECT distinct ',' + QUOTENAME(c.question) 
            FROM dbo.temp_SURVEY_DATA c
            FOR XML PATH(''), TYPE
            ).value('.', 'VARCHAR(MAX)') 
        ,1,1,'')

set @query = 'SELECT responseid, moduleid, responsedatetime, ' + @cols + ' from 
            (
                select question, response, responsedatetime, responseid, moduleid
                from temp_SURVEY_DATA
            ) x
            pivot 
            (
                max(response)
                for question IN(' + @cols + ')
            ) p '

execute(@query) 
```

结果：

```
responseid    moduleid  responsedatetime        Age Gender  Phone       Postal Code
ABC           123       2011-06-06 18:21:00.000 34  M       444-4444     
XYZ           123       2011-06-07 12:01:00.000 23                      90988 
```

# c# - 列表的自定义排序

> ID：10049466
> 
> 赞同：3
> 
> 时间：2012-04-06T21:28:36.650
> 
> 标签：c#, generics, sorting, lambda

我有一个`List<T>`where `T`is my `Event`type ，它有一个`time`type字段`long`。此列表由 Web 服务填充，如果事件没有时间，则值设置为 0。

我想要做的是按时间升序对列表进行排序，但将时间= 0 的项目放在最底部。

目前，我正在以一种 hack 的方式完成此任务，并且我想学习一种更好的方法。

```
var events = new ObservableCollection<Event>();
var resp = JsonConvert.DeserializeObject<Events>(restResponse.Content).Items;

var notime = resp.Where(r => r.time == 0);
var yestime = resp.Where(r => r.time > 0);

yestime.ToList().ForEach(events.Add);
notime.ToList().ForEach(events.Add);

CallbackInternal(callback, events); 
```

我尝试实现一个 custom `IComparer`，但效果并不好（这是一个镜头）

```
public class EventComparer : IComparer<Event>
{
    public int Compare(Event x, Event y)
    {
        if (x.time == 0) return 0;
        if (x.time < y.time) return -1;
        if (x.time > y.time) return 1;
        return 0;
    }
} 
```

指导表示赞赏！

谢谢！

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-04-06T21:33:23.307

尝试

```
 events.OrderBy (e => e.Time == 0).ThenBy (e => e.Time); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-06T21:31:57.037

您可以使用 LINQ：

```
resp.OrderBy(i => i.time == 0 ? int.MaxValue : i.time); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-06T21:30:01.967

你应该这样做：

```
 if(x.time==y.time) return 0;
 if(x.time==0) return 1;
 return x.time - y.time; 
```

这里的要点是 0 比任何其他时间都大，因此它将被放置在列表的末尾。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-04-06T21:32:24.557

您的自定义 IComparer 不正确。使用正确的逻辑，它应该可以正常工作。问题是如果左值为零，任何值都将等于它。这意味着这`0 == 3`是真的，而且`3 > 0`是真的。事实上，`0 > 3`而且`3 < 0`应该是真的

你应该这样做：

```
if (x.time == y.time) return 0;
if (x.time == 0) return 1;
if (y.time == 0) return -1;
return x.time.CompareTo(y.time); 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-04-06T21:34:37.443

试试这个（你必须根据你的需要调整它）：

```
 class Comparer : IComparer<int>
    {
        public int Compare(int x, int y)
        {
            if (x == y) return 0;
            else if (x == 0) return 1;
            else if (y == 0) return -1;
            else if (x < y) return -1;
            else if (x > y) return 1;
        }
    } 
```

# c - 在低级文件复制程序中使用 gotoxy() 时代码生成错误

> ID：10049468
> 
> 赞同：0
> 
> 时间：2012-04-06T21:28:49.237
> 
> 标签：c

`gotoxy` 包含在低级文件复制程序中的函数会产生错误。

这是代码

```
#include<stdio.h>
#include"d:\types.h"
#include"d:\stat.h"
#include"d:\fcntl.h"
#include<windows.h>

void gotoxy(int x, int y)
{
COORD coord;
coord.X = x;
coord.Y = y;
SetConsoleCursorPosition(GetStdHandle(STD_OUTPUT_HANDLE), coord);
}

main()
{
int inhandle,outhandle,bytes;
char buffer[512],source[128],target[128];
printf("enter source file location\n");
scanf("%s",source);
printf("enter target file name with location\n");
scanf("%s",target);
inhandle=(source,O_BINARY,O_RDONLY);
if(inhandle==-1)
{
printf("cannot open source file\n");
}
outhandle=(target,O_CREAT,O_BINARY|O_WRONLY,S_IWRITE);
if(outhandle==-1)
{
printf("cannot create target file");
}
 while(1)
{
bytes=read(inhandle,buffer,512);
if(bytes>1)
{
write(outhandle,buffer,bytes);
}
}
close(inhandle);
close(outhandle);
} 
```

这是由 c-free ver5.0 编译器生成的错误列表

```
--------------------Configuration: mingw5 - CUI Debug, Builder Type: MinGW--------------------

Compiling D:\c\test4.c...
[Error] C:\PROGRA~2\C-FREE~1\mingw\include\stdlib.h:293: error: conflicting types for '_fmode'
[Error] d:\fcntl.h:107: error: previous declaration of '_fmode' was here
[Error] C:\PROGRA~2\C-FREE~1\mingw\include\stdlib.h:293: error: conflicting types for '_fmode'
[Error] d:\fcntl.h:107: error: previous declaration of '_fmode' was here
[Warning] D:\c\test4.c:43:2: warning: no newline at end of file

Complete Compile D:\c\test4.c: 4 error(s), 1 warning(s) 
```

我究竟做错了什么？如何成功编译代码？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-06T21:32:35.623

`fcntl.h`您在（wtf？）中的副本`d:\`与系统标题的其余部分不匹配。不要像那样混合和匹配系统标头。

另外：`gotoxy()`是一个 lib(n)curses 函数；它在 Windows 上通常不可用。如果需要，您可能需要调查[PDCurses](http://pdcurses.sourceforge.net/)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-07T04:38:27.427

标题应该是

```
#include <stdio.h>
#include <sys/types.h>
#include <sys/stat.h>
#include <sys/fcntl.h>
#include <unistd.h>
#include <windows.h> 
```

不要复制它们以使其工作。

当您遇到错误时，请处理例如

```
inhandle=open(source,O_BINARY,O_RDONLY);
if(inhandle==-1) { perror("cannot open source file\n");return -1;}
outhandle=open(target,O_CREAT|O_BINARY|O_WRONLY,S_IRWXU);
if(outhandle==-1) { perror("cannot create target file"); return -1;} 
```

而while循环没有退出点。

```
while(bytes=read(inhandle,buffer,512),bytes>1) {
 if (write(outhandle,buffer,bytes) == -1) { perror("write");break; }
} 
```

程序以前不可能工作，不是包含 gotoxy 打破了它。

# html - Gif 动画在悬停时打开 div 框背景

> ID：10049475
> 
> 赞同：0
> 
> 时间：2012-04-06T21:29:20.390
> 
> 标签：html, css, xhtml

![在此处输入图像描述](../Images/a97ebb915081c31ed256c5e77d8f7ffe.png)

左边是我想要的，右边是我不断得到的。这是我的代码；

goo.gl/rnhJ7

```
<div id="butterbox">
    <div id="btrlwh">
        <div id="btrlan">
            <div id="btrlbx">
            </div>
        </div>
    </div>
</div>

div#butterbox {position:absolute;}
#btrlwh {background:url(/wp-content/themes/bliss/images/butterfly/leftwhite.gif) no-repeat;width:52px;height:50px;position:relative;right:75px;top:64px;padding:14px 0 0 2px;}
#btrlan {background:url(/wp-content/themes/bliss/images/butterfly/leftd.gif) no-repeat;width:52px;height:50px;z-index:999;}
#btrlan:hover {background:url(/wp-content/themes/bliss/images/butterfly/left.gif) no-repeat; }
#btrlbx {width:81px;height:58px;position:relative;top:15px;left:25px;border:1px solid #FFF;background-color:#8ad1e3;z-index:9;} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-06T22:10:14.193

尝试

```
#btrlbx {visibility:hidden}
#btrlan:hover #btrlbx {visibility:visible} 
```

# python - DJANGO：表单中缺少空白选择选项

> ID：10049478
> 
> 赞同：1
> 
> 时间：2012-04-06T21:29:37.930
> 
> 标签：python, django, django-forms, widget, modelform

我有以下内容：

模型.PY

```
LIST = (('Manager', 'Manager'),('Non-Manager', 'Non-Manager'),)

class Employee(models.Model):
    fname = models.CharField(max_length=15, blank=False, null=False)
    manager = models.CharField(max_length=15, choices=LIST, blank=True, null=True)
    comment = models.TextField(blank=True, null=True)
    def __unicode__(self):
        return self.fname

class EmployeeForm(forms.ModelForm):
    fname = forms.CharField(required=True, label='First Name')
    manager = forms.CharField(required=False, widget=Select(choices=LIST), label='Their Position?')
    comment = forms.CharField(required=False, widget=forms.Textarea(attrs={'cols': 50, 'rows': 10}), label='Comments')
    class Meta:
        model = Employee 
```

如果我从 EmployeeForm 中删除经理，我会在表单下拉菜单中获得一个“------”作为选项，但如果我将经理保留在 EmployeeForm 中（并且我需要覆盖字段标签） ，它会删除“------”。如何让 EmployeeForm 保留“------”选项？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-06T21:37:12.200

怎么样的东西：

```
manager = forms.CharField(required=False, widget=Select(choices=(('', '----------'),) + LIST), label='Their Position?') 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-07T08:06:47.807

您需要使用[`ChoiceField`](https://docs.djangoproject.com/en/dev/ref/forms/fields/#choicefield).

# php - 清除 cookie 时 PHP 会话变量消失

> ID：10049479
> 
> 赞同：3
> 
> 时间：2012-04-06T21:29:54.730
> 
> 标签：php, session, cookies

我一直在互联网上对会话和 cookie 进行大量研究，我不断遇到的关于会话的论点是，如果禁用 cookie，它不会影响会话。

不过，每次清除 cookie 时，我的会话变量似乎也会清除。此外，我在一些网站上读到会话实际上应该使用 cookie 清除。

有人可以向我解释一下吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-06T21:34:04.563

如果可能的 php 将其会话 ID 存储在 cookie 中。如果您的浏览器拒绝，它会携带会话 ID 以及查询字符串。

如果你杀死你的cookies并且没有对查询字符串进行调整，php会忘记你是谁！

但是可以通过[http://de2.php.net/manual/en/session.configuration.php#ini.session.use-cookies禁用 cookie 使用](http://de2.php.net/manual/en/session.configuration.php#ini.session.use-cookies)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-06T21:33:24.470

你误会了。会话依赖于 cookie。当您请求一个页面时，一个包含您的会话 UID 的 cookie 将被发送到服务器。因此清除 cookie 将导致会话丢失。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-06T21:35:19.800

如果需要，您可以强制在 get 中使用 PHP SESS ID 而不是在 cookie 中，默认的是 cookie

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-06T21:37:05.197

会话通过存储具有近期（或有时甚至是负数）到期日期的 cookie 来利用 cookie。`PHPSESSID`在 PHP 中，默认情况下可以在名称下找到此 cookie 。在运行时需要使用 PHP 中的`session_start`函数来加载和关联/识别用户和关联的会话信息。

因为会话是一种特殊类型的 cookie，清除 cookie（即使禁用 cookie）可能会导致会话标识符丢失，从而导致会话重置。

这是一篇很棒的文章，它解开了 PHP 会话背后的任何谜团：

[http://justinmccormick.com/wp/programming/php-sessions-explained](http://justinmccormick.com/wp/programming/php-sessions-explained)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-04-06T21:37:09.403

默认情况下，如果您清除会话已消失，PHP 会将会话 ID 存储在 cookie 中。

您可以做的是启用[session.use_trans_sid](http://www.php.net/manual/en/session.configuration.php#ini.session.use-trans-sid)。这样，PHP 会将会话 ID 附加到 url。（但我不建议这样做）

# html - HTML： div区域的标签laysover边缘

> ID：10049487
> 
> 赞同：1
> 
> 时间：2012-04-06T21:30:32.123
> 
> 标签：html, css

ul 中的 li 标签由于某种原因没有缩进。有什么我想念的吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-06T21:31:50.330

您的 CSS 文件的第 1 行是问题所在。

```
* {
    margin: 0;
    padding: 0;
} 
```

使用该声明，您将列表项的边距和填充设置为 0；因此它没有出现缩进。

要解决此问题，您应该为元素添加一些默认样式。例如，对于我的样式表，第一行将是 CSS 重置，然后是各种元素的一些通用样式。

```
/*CSS Reset*/
html,body,div,span,applet,object,iframe,h1,h2,h3,h4,h5,h6,p,blockquote,pre,a,abbr,acronym,address,big,cite,code,del,dfn,em,img,ins,kbd,q,s,samp,small,strike,strong,sub,sup,tt,var,b,u,i,center,dl,dt,dd,ol,ul,li,fieldset,form,label,legend,table,caption,tbody,tfoot,thead,tr,th,td,article,aside,canvas,details,embed,figure,figcaption,footer,header,hgroup,menu,nav,output,ruby,section,summary,time,mark,audio,video{margin:0;padding:0;border:0;font-size:100%;font:inherit;vertical-align:baseline}/* HTML5 display-role reset for older browsers */article,aside,details,figcaption,figure,footer,header,hgroup,menu,nav,section{display:block}body{line-height:1}ol,ul{list-style:none}blockquote,q{quotes:none}blockquote:before,blockquote:after,q:before,q:after{content:'';content:none}table{border-collapse:collapse;border-spacing:0}
/*Generic Styles*/
ul{list-style:disc;margin:1em 0 1em 3em}
li{margin:.3em 0} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-06T21:41:24.417

代替

```
* {
    margin: 0;
    padding: 0;
} 
```

您可以对特定元素执行相同的操作

```
a, #header, #banner, #content, #bodyArea, #left, #nav, #img2, #img3,......
{
    margin: 0;
    padding: 0;
} 
```

这是您所有元素的冗长集合，其中包含

```
margin: 0;
padding: 0; 
```

# objective-c - NSAutoreleasePool 循环

> ID：10049489
> 
> 赞同：1
> 
> 时间：2012-04-06T21:30:42.343
> 
> 标签：objective-c, nsautoreleasepool

假设我有这样的代码：

```
NSAutoreleasePool* pool=[[NSAutoreleasePool alloc]init];
for(unsigned int i=0;i<10;i++)
{
    NSDate* date=[[NSDate alloc]init];
}
[pool drain]; 
```

请注意，此代码仅用于显示我可以做什么，它是对我通常做的事情的简化。因此，在每次迭代中，都会分配并初始化一个新的 NSDate。NSAutoreleasePool 是否将它们全部耗尽，或者我是否必须以这种方式在循环中添加 NSAutoreleasePool：

```
for(unsigned int i=0;i<10;i++)
{
    NSAutoreleasePool* pool=[[NSAutoreleasePool alloc]init];
    NSDate* date=[[NSDate alloc]init];
    [pool drain];
} 
```

?
另外，我的书（mac os x 的可可编程）没有提到 NSAutoreleasePool，它只是这样使用它：

```
@autoreleasepool
{
    <code>
} 
```

我已经读到这种方式比使用 NSAutoreleasePool 更有效，但是如果我使用它，我会收到一个语法错误：
“程序中出现意外的 '@'”
为什么会这样？

我试过这样修改代码：

```
NSAutoreleasePool* pool=[[NSAutoreleasePool alloc]init];
for(unsigned int i=0;i<10;i++)
{
    NSDate* date=[[NSDate alloc]init];
    [date autorelease];
}
[pool drain]; 
```

那是对的吗？我认为保留了 10 个不同的对象（计数为 1），然后添加到自动释放池中。我没有内存泄漏吗？有没有办法用 gdb 检查这个对象计数？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-06T21:34:25.697

当你分配/初始化一个类时，返回的实例*通常*不会被自动释放。所以，不，在那个例子中，根本不需要自动释放池。

通常，当您有可量化的性能问题表明需要自动释放池时，您应该只在代码中添加自动释放池。不要解决你没有的问题。

如果`@autoreleasepool`不起作用，那是因为您使用的是较旧的编译器。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-06-12T04:54:44.690

来自苹果[文档](http://developer.apple.com/library/ios/#Documentation/Cocoa/Conceptual/MemoryMgmt/Articles/mmAutoreleasePools.html)

```
If you write a loop that creates many temporary objects.
You may use an autorelease pool block inside the loop to dispose of those objects before the next iteration. Using an autorelease pool block in the loop helps to reduce the maximum memory footprint of the application. 
```

所以如果@Ramy 使用不是更好：

```
for(unsigned int i=0;i<10;i++)
{
    NSAutoreleasePool* pool=[[NSAutoreleasePool alloc]init];
    NSDate* date=[[NSDate alloc]init];
    [date autorelease];
    [pool drain];
} 
```

# xpath - 为 excel2010 创建等效于 google doc 电子表格函数 importxml() 函数

> ID：10049492
> 
> 赞同：1
> 
> 时间：2012-04-06T21:31:00.120
> 
> 标签：xpath, excel, vba

我在过去使用过 google 电子表格，特别是他们的 importxml() 函数。我想知道是否有办法在 VBA 中构建函数（对于 Excel 2010）（我不是很精通在 VBA 上创建函数），从而可以复制 google 函数以在 excel 2010 文件中运行？

我找到了一些我认为可以使用的 VBA 代码，但我似乎无法运行它来给我想要的东西。

理想情况下，我想在一个单元格（在 excel 2010 中）添加以下函数并获取 xpath 内容。即：=importXML("web url","xpath")

任何指导将不胜感激。

最好的帕科

```
Option Explicit

Public Sub WaitBrowserQuiet(objIE As InternetExplorer)
Do While objIE.Busy Or objIE.ReadyState <> READYSTATE_COMPLETE
    DoEvents
Loop
End Sub

Public Function getXPathElement(sXPath As String, objElement As HTMLBaseElement) As HTMLBaseElement
Dim sXPathArray() As String

Dim sNodeName As String
Dim sNodeNameIndex As String
Dim sRestOfXPath As String
Dim lNodeIndex As Long
Dim lCount As Long

' Split the xpath statement
sXPathArray = Split(sXPath, "/")
sNodeNameIndex = sXPathArray(1)
If Not InStr(sNodeNameIndex, "[") > 0 Then
    sNodeName = sNodeNameIndex
    lNodeIndex = 1
Else
    sXPathArray = Split(sNodeNameIndex, "[")
    sNodeName = sXPathArray(0)
    lNodeIndex = CLng(Left(sXPathArray(1), Len(sXPathArray(1)) - 1))
End If
sRestOfXPath = Right(sXPath, Len(sXPath) - (Len(sNodeNameIndex) + 1))

Set getXPathElement = Nothing
For lCount = 0 To objElement.childNodes().Length - 1
    If UCase(objElement.childNodes().Item(lCount).nodeName) = UCase(sNodeName) Then
        If lNodeIndex = 1 Then
            If sRestOfXPath = "" Then
                Set getXPathElement = objElement.childNodes().Item(lCount)
            Else
                Set getXPathElement = getXPathElement(sRestOfXPath, objElement.childNodes().Item(lCount))
            End If
        End If
        lNodeIndex = lNodeIndex - 1
    End If
Next lCount
End Function

Private Sub cmdGetQuote_Click()
Dim ie As InternetExplorer
Dim elem As HTMLBaseElement
Dim url As String

url = "http://www.bloomberg.com/quote/MXIBTIIE:IND"

Set ie = New InternetExplorer
ie.Visible = True
ie.Navigate url
WaitBrowserQuiet ie

Set elem = getXPathElement("//span[@class=' price']", ie.Document)
Range("A1").Value = elem.innerText

Set ie = Nothing
End Sub 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-05T12:03:31.813

如果您是 Windows 用户，您可以使用[Neil Bosma 的 SEO 工具](http://nielsbosma.se/projects/seotools/)来运行 Xpath 功能。

# ios - 我无法使用 UISearchBar 控件在 UITableView 上进行搜索

> ID：10049499
> 
> 赞同：1
> 
> 时间：2012-04-06T21:31:44.917
> 
> 标签：ios, ios5

我无法在 UITableView 上进行搜索。我已经在 UITableViewController h 文件中声明了委托等：

```
@protocol searchTanksListDelegate
- (void) searchTanksList:(UISearchBar *) sender textDidChange:(NSString *) searchText;
@end

@property (weak, nonatomic) id <searchTanksListDelegate> searchDelegate;
@property (weak, nonatomic) IBOutlet UISearchBar *searchTanksList; 
```

我在 UITableViewController viewDidLoad 函数中将 searchTanksList.delegate 设置为 self。

我已经实现了这个方法：

```
- (void)searchTanksList:(UISearchBar *)searchTanksList textDidChange:(NSString *)searchText
{
    if (searchText.length == 0)
    {
        self.isFiltered = false;
    }
    else {
        self.isFiltered = true;
        self.searchResults = [[NSMutableArray alloc] init];
        for (tank* thisTank in self.tanks)
        {
            NSRange nameRange = [thisTank.tankProduct rangeOfString:searchText options:NSCaseInsensitiveSearch];
            NSRange numberRange = [thisTank.tankNumber rangeOfString:searchText options:NSCaseInsensitiveSearch];
            NSRange productNumberRange = [thisTank.tankProductNumber rangeOfString:searchText options:NSCaseInsensitiveSearch];
            if (nameRange.location != NSNotFound || numberRange.location != NSNotFound || productNumberRange.location != NSNotFound)
            {
                 [self.searchResults addObject:thisTank];
            }
        }
    }
} 
```

属性已经被合成等等 - 所以代码编译没有错误或警告......虽然我输入时没有调用 textDidChange 方法！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-07T02:19:07.340

您应该将 searchBar 声明为属性并确保将类设置为`UISearchBarDelegate`. 然后使用委托方法：

```
-(void)searchBar:(UISearchBar *)searchBar textDidChange:(NSString *)searchText 
```

处理搜索。如果你需要，我可以给你一个完整的例子。

假设您要过滤的是数组的示例：

```
#pragma mark - SearchBar Delegate Methods
-(void)searchBar:(UISearchBar *)searchBar textDidChange:(NSString *)searchText
{    
    [self filterContentForSearchText:searchText];
}

-(void)searchBarCancelButtonClicked:(UISearchBar *)searchBar
{
    searchBar.text = @"";

    workingTableViewData = [[NSMutableArray alloc] initWithArray:originalTableViewData];
    [self.myTableView reloadData];

    [searchBar resignFirstResponder];    
}

-(void)searchBarTextDidEndEditing:(UISearchBar *)searchBar
{
    [searchBar resignFirstResponder];
}

- (void)filterContentForSearchText:(NSString *)searchText
{
    if (searchText && searchText.length) {
        [self.workingTableViewData removeAllObjects];    
        for (NSDictionary *dictionary in originalTableViewData)
        {
            for (NSString *thisKey in [dictionary allKeys]) {
                if ([thisKey isEqualToString:@"Key1"] || 
                        [thisKey isEqualToString:@"Key2"]) {
                    if ([[dictionary valueForKey:thisKey] rangeOfString:searchText options:NSCaseInsensitiveSearch].location != NSNotFound) {
                        [workingTableViewData addObject:dictionary];
                    }

                } // if ([thisKey isEqualToString:@"Key1"] || [thisKey isEqualToString:@"Key2"])

            } // for (NSString *thisKey in [dictionary allKeys])

        } // for (NSDictionary *dictionary in originalTableViewData)

        [self.myTableView reloadData];

    } // if (searchText && searchText.length)

}

-(void)searchBarSearchButtonClicked:(UISearchBar *)searchBar {
    [self filterContentForSearchText:searchBar.text];
    [searchBar resignFirstResponder];
} 
```

注意 - workingTableViewData 和 originalTableViewData 都是私有属性。originalTableViewData 是一个 NSArray，workingTableViewData 是一个 NSMutableArray。

# linux - 测量核心转储时间

> ID：10049503
> 
> 赞同：3
> 
> 时间：2012-04-06T21:32:06.567
> 
> 标签：linux, linux-kernel

当一个进程崩溃时，我想测量转储核心需要多长时间。我的理解是它是一个执行转储核心的内核函数。这里的任何内核专家都可以指出我可以添加挂钩来测量核心转储时间的正确位置吗？这是 64 位内核，版本 2.6.3*

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-06T21:51:37.420

您不需要修改内核。Linux 内核 inotify 工具可用于让您知道何时创建了核心文件，并且您可以使用文件的修改时间来告诉您核心转储何时完成。

但是，如果您可以访问该过程的源代码，则可以拥有它

1.  捕获可能导致核心转储的信号
2.  在某处写一个时间戳
3.  将信号处理程序重置为默认值
4.  将信号重新发送给自己，这将导致这次核心转储。

coredump 间隔是核心文件的最后修改时间，减去进程之前写入的时间戳。

# c++ - boost multi_array resize 不会在 VS2008 中编译

> ID：10049513
> 
> 赞同：1
> 
> 时间：2012-04-06T21:33:37.727
> 
> 标签：c++, visual-studio-2008, visual-c++, boost, boost-multi-array

这个最小的代码不能用 VS2008 和 boost 1.49 编译

```
#include "boost/multi_array.hpp"

int _tmain(int argc, _TCHAR* argv[])
{
    boost::multi_array<double, 3> arrayTest;
    arrayTest.resize(boost::extents[10][11][12]);
    return 0;
} 
```

我已经看到了这个[答案](https://stackoverflow.com/questions/4870172/boostmulti-array-resize-doesnt-work)，但似乎没有帮助。如有任何帮助，我将不胜感激。

异常冗长的错误消息如下所示：

```
\Users\CommonThirdPartyStatic\boost\v1_49_0\boost/multi_array.hpp(402) : while compiling class template member function 'boost::multi_array<T,NumDims> &boost::multi_array<T,NumDims>::resize(const boost::detail::multi_array::extent_gen<NumRanges> &)'
with
[
    T=double,
    NumDims=3,
    NumRanges=3
]
.\testBed.cpp(7) : see reference to class template instantiation 'boost::multi_array<T,NumDims>' being compiled
with
[
    T=double,
    NumDims=3
]
\CommonThirdPartyStatic\boost\v1_49_0\boost/multi_array.hpp(433) : warning C4996: 'std::transform': Function call with parameters that may be unsafe - this call relies on the caller to check that the passed values are correct. To disable this warning, use -D_SCL_SECURE_NO_WARNINGS. See documentation on how to use Visual C++ 'Checked Iterators'
\Program Files\Microsoft Visual Studio 9.0\VC\include\algorithm(868) : see declaration of 'std::transform'
\CommonThirdPartyStatic\boost\v1_49_0\boost/multi_array.hpp(438) : warning C4996: 'std::transform': Function call with parameters that may be unsafe - this call relies on the caller to check that the passed values are correct. To disable this warning, use -D_SCL_SECURE_NO_WARNINGS. See documentation on how to use Visual C++ 'Checked Iterators'
\Program Files\Microsoft Visual Studio 9.0\VC\include\algorithm(868) : see declaration of 'std::transform'
\CommonThirdPartyStatic\boost\v1_49_0\boost/multi_array.hpp(477) : warning C4996: 'std::uninitialized_fill_n': Function call with parameters that may be unsafe - this call relies on the caller to check that the passed values are correct. To disable this warning, use -D_SCL_SECURE_NO_WARNINGS. See documentation on how to use Visual C++ 'Checked Iterators'
\Program Files\Microsoft Visual Studio 9.0\VC\include\memory(369) : see declaration of 'std::uninitialized_fill_n'
\Users\CommonThirdPartyStatic\boost\v1_49_0\boost/multi_array.hpp(472) : while compiling class template member function 'void boost::multi_array<T,NumDims>::allocate_space(void)'
with
[
    T=double,
    NumDims=3
]
\CommonThirdPartyStatic\boost\v1_49_0\boost/multi_array/extent_gen.hpp(49) : warning C4996: 'std::copy': Function call with parameters that may be unsafe - this call relies on the caller to check that the passed values are correct. To disable this warning, use -D_SCL_SECURE_NO_WARNINGS. See documentation on how to use Visual C++ 'Checked Iterators'
\Program Files\Microsoft Visual Studio 9.0\VC\include\xutility(2576) : see declaration of 'std::copy'
\Users\CommonThirdPartyStatic\boost\v1_49_0\boost/multi_array/extent_gen.hpp(46) : while compiling class template member function 'boost::detail::multi_array::extent_gen<NumRanges>::extent_gen(const boost::detail::multi_array::extent_gen<0> &,const boost::detail::multi_array::extent_gen<NumRanges>::range &)'
with
[
    NumRanges=1
]
.\testBed.cpp(8) : see reference to class template instantiation 'boost::detail::multi_array::extent_gen<NumRanges>' being compiled
with
[
    NumRanges=1
]
\CommonThirdPartyStatic\boost\v1_49_0\boost/multi_array/view.hpp(317) : warning C4996: 'std::equal': Function call with parameters that may be unsafe - this call relies on the caller to check that the passed values are correct. To disable this warning, use -D_SCL_SECURE_NO_WARNINGS. See documentation on how to use Visual C++ 'Checked Iterators'
\Program Files\Microsoft Visual Studio 9.0\VC\include\xutility(3071) : see declaration of 'std::equal'
\Users\CommonThirdPartyStatic\boost\v1_49_0\boost/multi_array/view.hpp(313) : while compiling class template member function 'boost::detail::multi_array::multi_array_view<T,NumDims> &boost::detail::multi_array::multi_array_view<T,NumDims>::operator =(const boost::detail::multi_array::multi_array_view<T,NumDims> &)'
with
[
    T=double,
    NumDims=3
]
\Users\CommonThirdPartyStatic\boost\v1_49_0\boost/multi_array.hpp(406) : see reference to class template instantiation 'boost::detail::multi_array::multi_array_view<T,NumDims>' being compiled
with
[
    T=double,
    NumDims=3
]
\Users\CommonThirdPartyStatic\boost\v1_49_0\boost/multi_array.hpp(402) : while compiling class template member function 'boost::multi_array<T,NumDims> &boost::multi_array<T,NumDims>::resize(const boost::detail::multi_array::extent_gen<NumRanges> &)'
with
[
    T=double,
    NumDims=3,
    NumRanges=3
]
\CommonThirdPartyStatic\boost\v1_49_0\boost/multi_array/view.hpp(321) : warning C4996: 'std::copy': Function call with parameters that may be unsafe - this call relies on the caller to check that the passed values are correct. To disable this warning, use -D_SCL_SECURE_NO_WARNINGS. See documentation on how to use Visual C++ 'Checked Iterators'
\Program Files\Microsoft Visual Studio 9.0\VC\include\xutility(2576) : see declaration of 'std::copy'
\CommonThirdPartyStatic\boost\v1_49_0\boost/multi_array/multi_array_ref.hpp(340) : warning C4996: 'std::fill_n': Function call with parameters that may be unsafe - this call relies on the caller to check that the passed values are correct. To disable this warning, use -D_SCL_SECURE_NO_WARNINGS. See documentation on how to use Visual C++ 'Checked Iterators'
\Program Files\Microsoft Visual Studio 9.0\VC\include\xutility(3283) : see declaration of 'std::fill_n'
\Users\CommonThirdPartyStatic\boost\v1_49_0\boost/multi_array/multi_array_ref.hpp(328) : while compiling class template member function 'boost::const_multi_array_ref<T,NumDims,TPtr>::const_multi_array_ref(TPtr,const boost::general_storage_order<3> &,__w64 const int *,const unsigned int *)'
with
[
    T=double,
    NumDims=3,
    TPtr=double *
]
\Users\CommonThirdPartyStatic\boost\v1_49_0\boost/multi_array/multi_array_ref.hpp(417) : see reference to class template instantiation 'boost::const_multi_array_ref<T,NumDims,TPtr>' being compiled
with
[
    T=double,
    NumDims=3,
    TPtr=double *
]
\Users\CommonThirdPartyStatic\boost\v1_49_0\boost/multi_array.hpp(113) : see reference to class template instantiation 'boost::multi_array_ref<T,NumDims>' being compiled
with
[
    T=double,
    NumDims=3
]
\CommonThirdPartyStatic\boost\v1_49_0\boost/multi_array/multi_array_ref.hpp(374) : warning C4996: 'std::transform': Function call with parameters that may be unsafe - this call relies on the caller to check that the passed values are correct. To disable this warning, use -D_SCL_SECURE_NO_WARNINGS. See documentation on how to use Visual C++ 'Checked Iterators'
\Program Files\Microsoft Visual Studio 9.0\VC\include\algorithm(710) : see declaration of 'std::transform'
\Users\CommonThirdPartyStatic\boost\v1_49_0\boost/multi_array/multi_array_ref.hpp(367) : while compiling class template member function 'void boost::const_multi_array_ref<T,NumDims,TPtr>::init_from_extent_gen(const boost::detail::multi_array::extent_gen<NumRanges> &)'
with
[
    T=double,
    NumDims=3,
    TPtr=double *,
    NumRanges=3
]
\CommonThirdPartyStatic\boost\v1_49_0\boost/multi_array/multi_array_ref.hpp(380) : warning C4996: 'std::transform': Function call with parameters that may be unsafe - this call relies on the caller to check that the passed values are correct. To disable this warning, use -D_SCL_SECURE_NO_WARNINGS. See documentation on how to use Visual C++ 'Checked Iterators'
\Program Files\Microsoft Visual Studio 9.0\VC\include\algorithm(710) : see declaration of 'std::transform'
\CommonThirdPartyStatic\boost\v1_49_0\boost/multi_array/subarray.hpp(239) : warning C4996: 'std::equal': Function call with parameters that may be unsafe - this call relies on the caller to check that the passed values are correct. To disable this warning, use -D_SCL_SECURE_NO_WARNINGS. See documentation on how to use Visual C++ 'Checked Iterators'
\Program Files\Microsoft Visual Studio 9.0\VC\include\xutility(3071) : see declaration of 'std::equal'
\Program Files\Microsoft Visual Studio 9.0\VC\include\xutility(2472) : see reference to function template instantiation 'boost::detail::multi_array::sub_array<T,NumDims> &boost::detail::multi_array::sub_array<T,NumDims>::operator =<boost::detail::multi_array::const_sub_array<T,2>>(const ConstMultiArray &)' being compiled
with
[
    T=double,
    NumDims=2,
    ConstMultiArray=boost::detail::multi_array::const_sub_array<double,2>
]
\Program Files\Microsoft Visual Studio 9.0\VC\include\xutility(2579) : see reference to function template instantiation '_OutIt std::_Copy_opt<boost::detail::multi_array::array_iterator<T,TPtr,NumDims,Reference>,_OutIt,std::_Iter_random_helper<_Cat1,_Cat2>::_Iter_random_cat>(_InIt,_InIt,_OutIt,_InOutItCat,std::_Nonscalar_ptr_iterator_tag,std::_Range_checked_iterator_tag)' being compiled
with
[
    _OutIt=boost::detail::multi_array::array_iterator<double,double *,boost::mpl::size_t<3>,boost::detail::multi_array::sub_array<double,2>>,
    T=double,
    TPtr=const double *,
    NumDims=boost::mpl::size_t<3>,
    Reference=boost::detail::multi_array::const_sub_array<double,2>,
    _Cat1=boost::detail::iterator_category_with_traversal<std::input_iterator_tag,boost::random_access_traversal_tag>,
    _Cat2=boost::detail::iterator_category_with_traversal<std::input_iterator_tag,boost::random_access_traversal_tag>,
    _InIt=boost::detail::multi_array::array_iterator<double,const double *,boost::mpl::size_t<3>,boost::detail::multi_array::const_sub_array<double,2>>,
    _InOutItCat=std::_Iter_random_helper<boost::detail::iterator_category_with_traversal<std::input_iterator_tag,boost::random_access_traversal_tag>,boost::detail::iterator_category_with_traversal<std::input_iterator_tag,boost::random_access_traversal_tag>>::_Iter_random_cat
]
\Users\CommonThirdPartyStatic\boost\v1_49_0\boost/multi_array/view.hpp(321) : see reference to function template instantiation 'boost::detail::multi_array::array_iterator<T,TPtr,NumDims,Reference> std::copy<boost::detail::multi_array::array_iterator<T,const T *,NumDims,boost::detail::multi_array::const_sub_array<T,2>>,boost::detail::multi_array::array_iterator<T,TPtr,NumDims,Reference>>(_InIt,_InIt,_OutIt)' being compiled
with
[
    T=double,
    TPtr=double *,
    NumDims=boost::mpl::size_t<3>,
    Reference=boost::detail::multi_array::sub_array<double,2>,
    _InIt=boost::detail::multi_array::array_iterator<double,const double *,boost::mpl::size_t<3>,boost::detail::multi_array::const_sub_array<double,2>>,
    _OutIt=boost::detail::multi_array::array_iterator<double,double *,boost::mpl::size_t<3>,boost::detail::multi_array::sub_array<double,2>>
]
\Users\CommonThirdPartyStatic\boost\v1_49_0\boost/multi_array/view.hpp(313) : while compiling class template member function 'boost::detail::multi_array::multi_array_view<T,NumDims> &boost::detail::multi_array::multi_array_view<T,NumDims>::operator =(const boost::detail::multi_array::multi_array_view<T,NumDims> &)'
with
[
    T=double,
    NumDims=3
]
\CommonThirdPartyStatic\boost\v1_49_0\boost/multi_array/subarray.hpp(242) : warning C4996: 'std::copy': Function call with parameters that may be unsafe - this call relies on the caller to check that the passed values are correct. To disable this warning, use -D_SCL_SECURE_NO_WARNINGS. See documentation on how to use Visual C++ 'Checked Iterators'
\Program Files\Microsoft Visual Studio 9.0\VC\include\xutility(2576) : see declaration of 'std::copy'
\CommonThirdPartyStatic\boost\v1_49_0\boost/multi_array/concept_checks.hpp(120) : warning C4510: 'boost::multi_array_concepts::ConstMultiArrayConcept<Array,NumDims>' : default constructor could not be generated
with
[
    Array=boost::detail::multi_array::const_sub_array<double,2>,
    NumDims=2
]
\Users\CommonThirdPartyStatic\boost\v1_49_0\boost/concept/detail/has_constraints.hpp(42) : see reference to class template instantiation 'boost::multi_array_concepts::ConstMultiArrayConcept<Array,NumDims>' being compiled
with
[
    Array=boost::detail::multi_array::const_sub_array<double,2>,
    NumDims=2
]
\Users\CommonThirdPartyStatic\boost\v1_49_0\boost/concept/detail/msvc.hpp(53) : see reference to class template instantiation 'boost::concepts::not_satisfied<Model>' being compiled
with
[
    Model=boost::multi_array_concepts::ConstMultiArrayConcept<boost::detail::multi_array::const_sub_array<double,2>,2>
]
\Users\CommonThirdPartyStatic\boost\v1_49_0\boost/concept_check.hpp(45) : see reference to class template instantiation 'boost::concepts::require<Model>' being compiled
with
[
    Model=boost::multi_array_concepts::ConstMultiArrayConcept<boost::detail::multi_array::const_sub_array<double,2>,2>
]
\Users\CommonThirdPartyStatic\boost\v1_49_0\boost/multi_array/subarray.hpp(235) : see reference to function template instantiation 'void boost::function_requires<boost::multi_array_concepts::ConstMultiArrayConcept<Array,NumDims>>(Model *)' being compiled
with
[
    Array=boost::detail::multi_array::const_sub_array<double,2>,
    NumDims=2,
    Model=boost::multi_array_concepts::ConstMultiArrayConcept<boost::detail::multi_array::const_sub_array<double,2>,2>
]
\Program Files\Microsoft Visual Studio 9.0\VC\include\xutility(2472) : see reference to function template instantiation 'boost::detail::multi_array::sub_array<T,NumDims> &boost::detail::multi_array::sub_array<T,NumDims>::operator =<boost::detail::multi_array::const_sub_array<T,2>>(const ConstMultiArray &)' being compiled
with
[
    T=double,
    NumDims=2,
    ConstMultiArray=boost::detail::multi_array::const_sub_array<double,2>
]
\CommonThirdPartyStatic\boost\v1_49_0\boost/multi_array/concept_checks.hpp(120) : warning C4610: struct 'boost::multi_array_concepts::ConstMultiArrayConcept<Array,NumDims>' can never be instantiated - user defined constructor required
with
[
    Array=boost::detail::multi_array::const_sub_array<double,2>,
    NumDims=2
]
\CommonThirdPartyStatic\boost\v1_49_0\boost/multi_array/index_gen.hpp(57) : warning C4996: 'std::copy': Function call with parameters that may be unsafe - this call relies on the caller to check that the passed values are correct. To disable this warning, use -D_SCL_SECURE_NO_WARNINGS. See documentation on how to use Visual C++ 'Checked Iterators'
\Program Files\Microsoft Visual Studio 9.0\VC\include\xutility(2576) : see declaration of 'std::copy'
\Users\CommonThirdPartyStatic\boost\v1_49_0\boost/multi_array/index_gen.hpp(55) : while compiling class template member function 'boost::detail::multi_array::index_gen<NumRanges,NumDims> boost::detail::multi_array::index_gen<0,0>::operator [](const boost::detail::multi_array::index_gen<0,0>::range &) const'
with
[
    NumRanges=1,
    NumDims=1
]
\Users\CommonThirdPartyStatic\boost\v1_49_0\boost/multi_array/base.hpp(71) : see reference to class template instantiation 'boost::detail::multi_array::index_gen<NumRanges,NumDims>' being compiled
with
[
    NumRanges=0,
    NumDims=0
]
\CommonThirdPartyStatic\boost\v1_49_0\boost/multi_array/iterator.hpp(149) : warning C4996: 'std::equal': Function call with parameters that may be unsafe - this call relies on the caller to check that the passed values are correct. To disable this warning, use -D_SCL_SECURE_NO_WARNINGS. See documentation on how to use Visual C++ 'Checked Iterators'
\Program Files\Microsoft Visual Studio 9.0\VC\include\xutility(3071) : see declaration of 'std::equal'
\Users\CommonThirdPartyStatic\boost\v1_49_0\boost/iterator/iterator_facade.hpp(535) : see reference to function template instantiation 'bool boost::detail::multi_array::array_iterator<T,TPtr,NumDims,Reference>::equal<const Facade2>(IteratorAdaptor &) const' being compiled
with
[
    T=double,
    TPtr=const double *,
    NumDims=boost::mpl::size_t<3>,
    Reference=boost::detail::multi_array::const_sub_array<double,2>,
    Facade2=boost::detail::multi_array::array_iterator<double,const double *,boost::mpl::size_t<3>,boost::detail::multi_array::const_sub_array<double,2>>,
    IteratorAdaptor=boost::detail::multi_array::array_iterator<double,const double *,boost::mpl::size_t<3>,boost::detail::multi_array::const_sub_array<double,2>>
]
\Users\CommonThirdPartyStatic\boost\v1_49_0\boost/iterator/iterator_facade.hpp(837) : see reference to function template instantiation 'bool boost::iterator_core_access::equal<Derived1,Derived2>(const Facade1 &,const Facade2 &,boost::mpl::true_)' being compiled
with
[
    Derived1=boost::detail::multi_array::array_iterator<double,const double *,boost::mpl::size_t<3>,boost::detail::multi_array::const_sub_array<double,2>>,
    Derived2=boost::detail::multi_array::array_iterator<double,const double *,boost::mpl::size_t<3>,boost::detail::multi_array::const_sub_array<double,2>>,
    Facade1=boost::detail::multi_array::array_iterator<double,const double *,boost::mpl::size_t<3>,boost::detail::multi_array::const_sub_array<double,2>>,
    Facade2=boost::detail::multi_array::array_iterator<double,const double *,boost::mpl::size_t<3>,boost::detail::multi_array::const_sub_array<double,2>>
]
\Program Files\Microsoft Visual Studio 9.0\VC\include\xutility(2471) : see reference to function template instantiation 'bool boost::operator !=<boost::detail::multi_array::array_iterator<T,TPtr,NumDims,Reference>,boost::multi_array<T,2>,boost::random_access_traversal_tag,Reference,ptrdiff_t,boost::detail::multi_array::array_iterator<T,TPtr,NumDims,Reference>,boost::multi_array<T,2>,boost::random_access_traversal_tag,Reference,ptrdiff_t>(const boost::iterator_facade<Derived,Value,CategoryOrTraversal,Reference> &,const boost::iterator_facade<Derived,Value,CategoryOrTraversal,Reference> &)' being compiled
with
[
    T=double,
    TPtr=const double *,
    NumDims=boost::mpl::size_t<3>,
    Reference=boost::detail::multi_array::const_sub_array<double,2>,
    Derived=boost::detail::multi_array::array_iterator<double,const double *,boost::mpl::size_t<3>,boost::detail::multi_array::const_sub_array<double,2>>,
    Value=boost::multi_array<double,2>,
    CategoryOrTraversal=boost::random_access_traversal_tag
]
\CommonThirdPartyStatic\boost\v1_49_0\boost/multi_array/iterator.hpp(149) : warning C4996: 'std::equal': Function call with parameters that may be unsafe - this call relies on the caller to check that the passed values are correct. To disable this warning, use -D_SCL_SECURE_NO_WARNINGS. See documentation on how to use Visual C++ 'Checked Iterators'
\Program Files\Microsoft Visual Studio 9.0\VC\include\xutility(3071) : see declaration of 'std::equal'
\CommonThirdPartyStatic\boost\v1_49_0\boost/iterator/iterator_concepts.hpp(136) : error C2146: syntax error : missing ',' before identifier 'traversal_category'
\Users\CommonThirdPartyStatic\boost\v1_49_0\boost/iterator/iterator_concepts.hpp(145) : see reference to class template instantiation 'boost_concepts::SinglePassIterator<Iterator>' being compiled
with
[
    Iterator=boost::detail::multi_array::array_iterator<double,double *,boost::mpl::size_t<2>,boost::detail::multi_array::sub_array<double,1>>
]
\Users\CommonThirdPartyStatic\boost\v1_49_0\boost/iterator/iterator_concepts.hpp(143) : see reference to class template instantiation 'boost_concepts::ForwardTraversal<Iterator>' being compiled
with
[
    Iterator=boost::detail::multi_array::array_iterator<double,double *,boost::mpl::size_t<2>,boost::detail::multi_array::sub_array<double,1>>
]
\Users\CommonThirdPartyStatic\boost\v1_49_0\boost/concept/detail/has_constraints.hpp(42) : see reference to class template instantiation 'boost_concepts::ForwardTraversalConcept<Iterator>' being compiled
with
[
    Iterator=boost::detail::multi_array::array_iterator<double,double *,boost::mpl::size_t<2>,boost::detail::multi_array::sub_array<double,1>>
]
\Users\CommonThirdPartyStatic\boost\v1_49_0\boost/concept/detail/msvc.hpp(53) : see reference to class template instantiation 'boost::concepts::not_satisfied<Model>' being compiled
with
[
    Model=boost_concepts::ForwardTraversalConcept<boost::detail::multi_array::array_iterator<double,double *,boost::mpl::size_t<2>,boost::detail::multi_array::sub_array<double,1>>>
]
\Users\CommonThirdPartyStatic\boost\v1_49_0\boost/concept_check.hpp(45) : see reference to class template instantiation 'boost::concepts::require<Model>' being compiled
with
[
    Model=boost_concepts::ForwardTraversalConcept<boost::detail::multi_array::array_iterator<double,double *,boost::mpl::size_t<2>,boost::detail::multi_array::sub_array<double,1>>>
]
\Users\CommonThirdPartyStatic\boost\v1_49_0\boost/multi_array/concept_checks.hpp(67) : see reference to function template instantiation 'void boost::function_requires<boost_concepts::ForwardTraversalConcept<Iterator>>(Model *)' being compiled
with
[
    Iterator=boost::detail::multi_array::array_iterator<double,double *,boost::mpl::size_t<2>,boost::detail::multi_array::sub_array<double,1>>,
    Model=boost_concepts::ForwardTraversalConcept<boost::detail::multi_array::array_iterator<double,double *,boost::mpl::size_t<2>,boost::detail::multi_array::sub_array<double,1>>>
]
\Users\CommonThirdPartyStatic\boost\v1_49_0\boost/multi_array/concept_checks.hpp(65) : while compiling class template member function 'void boost::multi_array_concepts::ConstMultiArrayConcept<Array,NumDims>::constraints(void)'
with
[
    Array=boost::detail::multi_array::const_sub_array<double,2>,
    NumDims=2
]
\Users\CommonThirdPartyStatic\boost\v1_49_0\boost/concept/detail/has_constraints.hpp(42) : see reference to class template instantiation 'boost::multi_array_concepts::ConstMultiArrayConcept<Array,NumDims>' being compiled
with
[
    Array=boost::detail::multi_array::const_sub_array<double,2>,
    NumDims=2
]
\Users\CommonThirdPartyStatic\boost\v1_49_0\boost/concept/detail/msvc.hpp(53) : see reference to class template instantiation 'boost::concepts::not_satisfied<Model>' being compiled
with
[
    Model=boost::multi_array_concepts::ConstMultiArrayConcept<boost::detail::multi_array::const_sub_array<double,2>,2>
]
\Users\CommonThirdPartyStatic\boost\v1_49_0\boost/concept_check.hpp(45) : see reference to class template instantiation 'boost::concepts::require<Model>' being compiled
with
[
    Model=boost::multi_array_concepts::ConstMultiArrayConcept<boost::detail::multi_array::const_sub_array<double,2>,2>
]
\Users\CommonThirdPartyStatic\boost\v1_49_0\boost/multi_array/subarray.hpp(235) : see reference to function template instantiation 'void boost::function_requires<boost::multi_array_concepts::ConstMultiArrayConcept<Array,NumDims>>(Model *)' being compiled
with
[
    Array=boost::detail::multi_array::const_sub_array<double,2>, 
```

# symfony - 可以更改捆绑目录结构吗？

> ID：10049514
> 
> 赞同：1
> 
> 时间：2012-04-06T21:33:51.310
> 
> 标签：symfony, structure, bundle

这是否可以更改 Symfony 2 中的包结构，例如：

*   我的捆绑
    *   实体名称
        *   控制器.php
        *   实体.php
        *   EntityRepository.php
        *   看法
            *   index.html.twig
            *   ETC
    *   第二实体
    *   ETC

这可能吗？我该如何开始做这样的事情？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-06T23:29:47.467

简短的回答：没有

如果您通过框架代码 grep，您会发现某些目录名称被硬编码到系统中。我知道您正在尝试按实体组织事物。我曾经为许多项目自己做这件事。

但是，如果您要使用 S2，那么您需要接受它的基本结构。它运作良好。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-07T07:16:06.480

您可以检查[KnpRadBundle](http://rad.knplabs.com/)。他们稍微改变了结构。

但正如 Cerad 所说，由于一致性，一些路径是硬编码的，Symfony 的创建者 fabpot[在这里](https://github.com/symfony/symfony/pull/3489#issuecomment-4340229)解释了它。

# javascript - 将数据库模型的整洁 json 数据从服务器（python）发送到客户端

> ID：10049516
> 
> 赞同：-1
> 
> 时间：2012-04-06T21:34:13.120
> 
> 标签：javascript, python, json, google-app-engine, serialization

我正在使用 appengine、webapp2 框架。我有以下模型：

```
class Match(db.Model):
    date_time = db.DateTimeProperty()
    team1 = db.StringProperty()
    team2 = db.StringProperty()
    venue = db.StringProperty()
    result = db.IntegerProperty() 
```

现在在客户端，一个事件向我的一个发布请求`views`，基于该发布请求，我想发送 jQuery/javascript 易于读取的 json 数据。

最好的方法是什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-06T22:05:08.580

在模型中：

```
class DictModel(db.Model):
    def to_dict(self):
       return dict([(p, unicode(getattr(self, p))) for p in self.properties()])

class Match(DictModel):
    date_time = db.DateTimeProperty()
    team1 = db.StringProperty()
    team2 = db.StringProperty()
    venue = db.StringProperty()
    result = db.IntegerProperty() 
```

在意见中：

```
import json
self.response.out.write(json.dumps([m.to_dict() for m in matches])) 
```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-04-07T04:21:20.307

首先，我会推荐使用 guido 的 ndb 而不是旧的 db 模块。但实际上旧的 db 模块和 ndb 都有适合您的解决方案。首先，您需要将模型从对象转换为 json 可序列化结构。特别是一个python字典。

旧数据库

dict = db.to_dict(Matchentity)

数据库

dict = Matchentity.to_dict()

现在您必须将其序列化为 json，这并不像您想象的那么简单，因为您必须处理一些属性，因为它们的值在 json 中没有多大意义。在新的 ndb 中，您可以通过在 to_dict() 方法中使用 exlude 参数来简单地排除这些，而在旧的 db 中，为每个模型编写一个特定的方法可能是一个更好的主意。然后使用 json.dump(dict) 在 ndb 邮件列表上有一些很好的讨论。

# ios - 应用内购买沙盒测试——老沙盒用户不断提示

> ID：10049521
> 
> 赞同：10
> 
> 时间：2012-04-06T21:34:33.803
> 
> 标签：ios, iphone, in-app-purchase

我正在开发一款带有应用内购买的 iphone 游戏。我试图通过调用 restoreCompletedTransactions 来检索我的沙盒用户以前的购买，但没有触发回调。

我在网上从其他一些遇到类似问题的人那里阅读到删除沙盒用户并尝试创建一个新用户。在一个月左右的时间里，我多次尝试删除和创建新的测试用户（一些用户报告说这是苹果的沙箱服务器），但我的运气为零。

奇怪的是，每次在我进行恢复调用时，我在 iPhone 上被提示输入我的用户凭据时，都会提示我输入**我以前尝试过的所有沙盒帐户**。这很奇怪，因为我已经从 ITunesConnect 中删除了它们，并且还在我的 iPhone 设置上的应用商店中登出。

我也尝试过恢复我的 iPhone - 也没有用。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-08T08:59:17.247

添加事务观察器后，如果有任何未完成的事务（这意味着您没有完成），iOS 将检查默认队列，因此每次有事务时它都会显示警报框，直到您完成它，即使您没有'不要执行任何操作来添加新的付款。所以尝试为当前停留在队列中的所有事务调用完成事务。

# php - 将参数传递给 CakePHP 中的方法

> ID：10049522
> 
> 赞同：0
> 
> 时间：2012-04-06T21:34:35.757
> 
> 标签：php, cakephp

我的帖子控制器中有以下方法：

```
public function index( $filter = null )
{
    debug($filter); exit;
} 
```

如果我访问以下 URL：`/posts/index/filter:test`它将返回 null 但如果我使用`/posts/index/test`它将返回 test...

我的印象是 Cake 默认将传递的参数视为命名？

我尝试使用以下路线解决此问题：

`Router::connect('/test', array('controller'=>'posts','action'=>'index','filter'=>'test'));`

但它仍然返回为空！好像过滤器没有传递给方法......

我该如何解决？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-06T21:37:43.500

如果需要获取命名参数，可以使用控制器的 params 属性：

```
$this->params['named']['filter'] 
```

# mercurial - 如何使 mercurial (hg) 外部存储库忽略内部（非子）存储库的存在

> ID：10049526
> 
> 赞同：3
> 
> 时间：2012-04-06T21:34:54.370
> 
> 标签：mercurial

简而言之，我怎样才能使外部 mercurial 存储库完全不知道给定内部存储库的存在？我基本上只是想忽略子文件夹中某些 .hg* 的存在，并让外部存储库继续其快乐的方式。

换句话说，我希望有两个彼此无关的 mercurial 存储库，但恰好跟踪同一个文件。是 - 对该文件的编辑必须提交两次，等等；但在这种情况下，这就是我想要的。

背景：

我正在回避 mercurial 无法处理部分克隆的问题，但我相信它会起作用。我们有一个巨大的项目树检查到 mercurial，承包商需要访问这棵树的一部分。我对子存储库方法的理解是很难回溯到现有的树中。无论如何，我不想强​​迫我所有的同事这样做，这样我就可以与一个承包商合作。

我想做的是在我们整个项目树的克隆中的一两个文件夹中创建内部存储库。然后我计划将这些内部存储库进一步克隆给承包商。这不是最好的，但它会起作用；在他推送给我之后，我可以合并到内部存储库触及的文件，然后走到外部存储库检查我们的整体树。理想情况下，从外部存储库的角度来看，似乎一些魔法只是更新了一些文件。

问题是 mercurial 似乎对自己了解太多:)。例如，使用 hg init、hg add * 和 hg clone 时一切正常；但是当他在他的最后添加一个新文件并且我去 hg 在外部存储库中添加它时，我得到（混淆）：

中止：路径 'foo/bar.txt' 在 repo 'foo' 内

我可以通过将内部存储库的 .hg 重命名为其他名称来解决它，但总的来说，这种方法已经失控了。hg stat 忽略内部存储库也有问题；以及我试图从外部存储库执行的其他命令和其他事情通常会中断（我在与承包商共享的一个文件夹中的子存储库中遇到了很多麻烦）。

有任何想法吗？

（我确实提出了一个理论上的解决方案：在我的文件系统的其他地方创建另一个存储库 baz/，然后使用文件系统符号链接从原始树中提取文件夹。但后来我硬连线到给定的机器连接两个存储库，我担心这种方法会产生我没有想到的其他后果。从外部的角度隐藏内部存储库会更方便。）

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-07T01:05:29.987

我不认为有一种方法可以做你想做的事，但是将子目录变成子存储库并不难。唯一需要注意的是，一旦目录成为子存储库，就可以通过给目录一个新名称来更容易地在拆分前和拆分后的历史之间来回切换。

对于此示例，我有以下目录结构，并且我为每个文件伪造了一些历史记录：

```
org
 + file1
 + dir
    + file2 
```

**第 1 步**- 启用`convert`扩展。
**第 2 步**- 创建文件映射以将`dir`历史记录移动到其自己的存储库的根目录。例子：

```
include dir
rename dir . 
```

**第 3 步**- 运行转换，创建一个具有不同名称的目录。 **第 4 步**- 移动原项目下的新目录。
**第 5 步**- 从原始项目中删除旧目录。
**第 6 步**- 在新的子存储库中，更新到最新版本。
**第 7 步**- 在原始存储库中，添加一个`.hgsub`引用新子存储库的文件。
**第 8 步**- 添加`.hgsub`文件，修复所有引用旧目录的项目路径并提交。

例子：

```
hg convert --filemap filemap org sub
move sub org
cd org
hg remove dir
cd sub
hg update tip
cd ..
echo sub=sub >> .hgsub
REM Fix up other project paths referencing dir->sub.
hg ci -Am "Converted 'dir' to repo 'sub'." 
```

现在您已经为您的承包商维护了历史记录，并且可以更新到旧版本或新版本的主要历史记录而不会发生冲突。当您更新到之前`sub`存在时，Mercurial 会正确更新`sub`为 null 父级并`dir`会出现在历史记录中。更新到历史的尖端，`dir`消失和`sub`更新。

# iphone - 修正浮点数

> ID：10049533
> 
> 赞同：6
> 
> 时间：2012-04-06T21:35:50.507
> 
> 标签：iphone, ios, xcode, cocoa-touch, cocoa

我想知道是否有一种方法可以轻松安全地纠正浮点数。

例如，

输入时：“32 + 32.1” 结果：“64.0999999999999”

另外我必须提到，在使用科学记数法时，这种情况经常发生。" ( 2.3 * 10^23)*(1.452 * 10^23) " 返回： " 3.339599999999999999e+46"

最后，有时返回的数字是：ex。123.0000000000001

谢谢您的帮助！

**编辑**

被批准的答案很棒。但是我发现对我有用的是在 NSString stringWithFormat 中使用带有双精度的 %g。%g 似乎非常恰当地四舍五入。前任。

```
 answer.text = [NSString stringWithFormat@" %g ", doubleAnswer]; 
```

通过计算使用双打然后使用该方法似乎对我有用，我希望这对其他人也有帮助。如果这不是您要寻找的答案，请查看已批准的答案！

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-04-06T21:39:44.437

浮点数不能很好地表示特定的数字。使用双精度会减少这种情况发生的频率，但您仍然会遇到问题。有关如何存储浮点数的技术描述（以及为什么我们首先会遇到这个问题）请参阅这篇维基百科文章： [IEEE 754-1985](http://en.wikipedia.org/wiki/IEEE_754-1985)。（基本上，浮点数被存储为值的二进制表示，并且只有这么多位可供使用，因此它们很快用完并且必须四舍五入到它们能够表示的最接近的值。）

通常，您不必担心 +/- .0000001，只需在您想用适当的小数点数向用户显示它们时格式化它们，它就会被四舍五入。但在内部，它的存储方式并不重要。

例如，如果您想显示“结果”，您可以执行以下操作：

```
float myFloat = 32 + 32.1;
NSString *result = [NSString stringWithFormat:%@"%.2f", myFloat];
// result will contain 64.10 
```

如果您不想要固定数量的小数点，您还可以使用浮点到字符串的转换功能`NSNumber`：

```
float myFloat = 32 + 32.1;
NSNumber *myNumber = [NSNumber numberWithFloat:myFloat];
NSString *result = [myNumber stringValue];
// result will contain 64.1 
```

`NSDecimalNumber`将为您处理所有这些，但它涉及更多并且涉及更多开销，但这里有一个示例可以帮助您入门：

```
NSDecimalNumber *num1   = [NSDecimalNumber decimalNumberWithString:@"32"];
NSDecimalNumber *num2   = [NSDecimalNumber decimalNumberWithString:@"32.1"];
// Or since you use exponents:  
// NSDecimalNumber *num2   = [NSDecimalNumber decimalNumberWithMantissa:321 exponent:-1 isNegative:NO];

NSDecimalNumber *myNumber = [num1 decimalNumberByAdding:num2];
NSString *result = [myNumber stringValue];
// result will contain 64.1 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-06T21:38:18.627

你不能“纠正”一个浮点数，因为浮点数根本不能代表你想要的数字。

浮点数非常不精确，通常不应该用于涉及大量计算的任何事情，因为累积误差通常是灾难性的。

改用 a `double`。它们可以表示更大范围的值，因此可以非常精确地表示更多值。如果这还不够好，您将需要进行更精确的操作。可能`NSDecimalNumber`。

# javascript - 对象初始化器中的局部变量

> ID：10049534
> 
> 赞同：0
> 
> 时间：2012-04-06T21:36:02.320
> 
> 标签：javascript, variables, object, local, initializer

问题是：是否可以在 JavaScript 中使用对象初始值设定项创建如下结构？

```
var human = new function (years) {
    var age = years;
    Object.defineProperties(this, {
        age: {
            enumerable:true,
            get: function () {
                return age;
            },
            set: function (value) {
                if( typeof value != 'number') throw 'Age must be a number';
                age = value;
            }
        }
    });
} 
```

我试图做的事情：

```
var years = 0;
var human = {
    _age: years,
    get age () {
        return this._age;
    },
    set age (value) {
        if( typeof value != 'number') throw 'Age must be a number';
        this._age = value;
    }
} 
```

这个例子更直观和“友好”（至少对我来说），但我需要“_age”是本地的，就像在前面的例子中一样。

是否可以在对象初始化器中创建局部变量？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-06T21:43:51.533

您可以执行以下操作：

```
 function myObject(){
      var privateVar = 'default';

      this.setPrivateVar = function(val){
        privateVar = val;
      }

      this.getPrivateVar= function(){
        return privateVar;
      }

    }

var obj = new myObject();
alert(obj.privateVar); //undefined
alert(obj.getPrivateVar()) // default 
```

另一个例子：

```
 function myObject(){
       var privatVariable = 'default';
       return {
           getVal : function(){
                return privatVariable;
           }
       }
   }

var obj = myObject(); 
```

# mysql - Grails 数据库连接池 - 负载测试

> ID：10049538
> 
> 赞同：2
> 
> 时间：2012-04-06T21:36:17.007
> 
> 标签：mysql, grails, connection-pooling

我将 Grails 与 MySQL 一起使用。我在 DataSource.groovy 中实现了连接池，在负载测试时出现此错误：

```
production {
   dataSource {
      driverClassName = "com.mysql.jdbc.Driver"
      dbCreate = "update" // one of 'create', 'create-drop','update'
      url = "jdbc:mysql://localhost:3306/mpest"
      username = "root"
      password = "Cos"
      pooled = true
      //pooling parameters
      properties {
         maxActive = 300
         minIdle = 1
         initialSize = 10 
         maxWait = 10000 
         testOnBorrow = true 
         testWhileIdle = true 
         testOnReturn = false 
         validationQuery = "SELECT 1"
      }
   }
} 
```

但不断出错。

```
2012-04-07 05:48:20,716 [http-bio-80-exec-120] ERROR StackTrace  - Sanitizing stacktrace:
org.hibernate.exception.JDBCConnectionException: could not inspect JDBC autocommit mode
    at org.hibernate.exception.SQLStateConverter.convert(SQLStateConverter.java:97)
    at org.hibernate.exception.JDBCExceptionHelper.convert(JDBCExceptionHelper.java:66)
    at org.hibernate.exception.JDBCExceptionHelper.convert(JDBCExceptionHelper.java:52)
    at org.hibernate.jdbc.JDBCContext.afterNontransactionalQuery(JDBCContext.java:275)
    at org.hibernate.impl.SessionImpl.afterOperation(SessionImpl.java:444)
    at org.hibernate.impl.SessionImpl.list(SessionImpl.java:1604)
    at org.hibernate.impl.CriteriaImpl.list(CriteriaImpl.java:306)
    at org.codehaus.groovy.grails.orm.hibernate.metaclass.FindByPersistentMethod$1.doInHibernate(FindByPersistentMethod.java:100)
    at org.springframework.orm.hibernate3.HibernateTemplate.doExecute(HibernateTemplate.java:406)
    at org.springframework.orm.hibernate3.HibernateTemplate.execute(HibernateTemplate.java:339)
    at org.codehaus.groovy.grails.orm.hibernate.metaclass.FindByPersistentMethod.doInvokeInternalWithExpressions(FindByPersistentMethod.java:67)
    at org.codehaus.groovy.grails.orm.hibernate.metaclass.AbstractClausedStaticPersistentMethod.doInvokeInternal(AbstractClausedStaticPersistentMethod.java:562)
    at org.codehaus.groovy.grails.orm.hibernate.metaclass.AbstractStaticPersistentMethod.invoke(AbstractStaticPersistentMethod.java:64)
    at org.codehaus.groovy.grails.orm.hibernate.metaclass.AbstractStaticPersistentMethod.invoke(AbstractStaticPersistentMethod.java:57)
    at org.codehaus.groovy.grails.commons.metaclass.StaticMethodInvocation$invoke$29.call(Unknown Source)
    at org.codehaus.groovy.grails.plugins.orm.hibernate.HibernatePluginSupport$_addDynamicFinderSupport_closure17.doCall(HibernatePluginSupport.groovy:466)
    at sun.reflect.GeneratedMethodAccessor560.invoke(Unknown Source)
    at sun.reflect.DelegatingMethodAccessorImpl.invoke(Unknown Source)
    at java.lang.reflect.Method.invoke(Unknown Source)
    at org.codehaus.groovy.reflection.CachedMethod.invoke(CachedMethod.java:90)
    at groovy.lang.MetaMethod.doMethodInvoke(MetaMethod.java:233)
    at groovy.lang.MetaClassImpl.invokeMethod(MetaClassImpl.java:1058)
    at groovy.lang.ExpandoMetaClass.invokeMethod(ExpandoMetaClass.java:1070)
    at groovy.lang.MetaClassImpl.invokeMethod(MetaClassImpl.java:886)
    at groovy.lang.Closure.call(Closure.java:282)
    at org.codehaus.groovy.runtime.metaclass.ClosureStaticMetaMethod.invoke(ClosureStaticMetaMethod.java:59)
    at groovy.lang.MetaClassImpl.invokeStaticMissingMethod(MetaClassImpl.java:1355)
    at groovy.lang.MetaClassImpl.invokeStaticMethod(MetaClassImpl.java:1343)
    at groovy.lang.ExpandoMetaClass.invokeStaticMethod(ExpandoMetaClass.java:1082)
    at org.codehaus.groovy.runtime.callsite.StaticMetaClassSite.call(StaticMetaClassSite.java:50)
    at org.codehaus.groovy.runtime.callsite.CallSiteArray.defaultCall(CallSiteArray.java:40)
    at org.codehaus.groovy.runtime.callsite.StaticMetaClassSite.call(StaticMetaClassSite.java:55)
    at org.codehaus.groovy.runtime.callsite.AbstractCallSite.call(AbstractCallSite.java:124)
    at org.mPest.ReportManagement.addReport(ReportManagement.groovy:14)
    at org.mPest.ReportManagement$addReport$55.call(Unknown Source)
    at org.mPest.ReportController$_closure1.doCall(ReportController.groovy:12)
    at sun.reflect.GeneratedMethodAccessor505.invoke(Unknown Source)
    at sun.reflect.DelegatingMethodAccessorImpl.invoke(Unknown Source)
    at java.lang.reflect.Method.invoke(Unknown Source)
    at org.codehaus.groovy.runtime.callsite.PogoMetaMethodSite$PogoCachedMethodSite.invoke(PogoMetaMethodSite.java:225)
    at org.codehaus.groovy.runtime.callsite.PogoMetaMethodSite.callCurrent(PogoMetaMethodSite.java:51)
    at org.codehaus.groovy.runtime.callsite.AbstractCallSite.callCurrent(AbstractCallSite.java:149)
    at org.mPest.ReportController$_closure1.doCall(ReportController.groovy)
    at sun.reflect.GeneratedMethodAccessor490.invoke(Unknown Source)
    at sun.reflect.DelegatingMethodAccessorImpl.invoke(Unknown Source)
    at java.lang.reflect.Method.invoke(Unknown Source)
    at org.codehaus.groovy.reflection.CachedMethod.invoke(CachedMethod.java:90)
    at groovy.lang.MetaMethod.doMethodInvoke(MetaMethod.java:233)
    at groovy.lang.MetaClassImpl.invokeMethod(MetaClassImpl.java:1058)
    at groovy.lang.ExpandoMetaClass.invokeMethod(ExpandoMetaClass.java:1070)
    at groovy.lang.MetaClassImpl.invokeMethod(MetaClassImpl.java:886)
    at groovy.lang.Closure.call(Closure.java:282)
    at groovy.lang.Closure.call(Closure.java:277)
    at org.codehaus.groovy.grails.web.servlet.mvc.SimpleGrailsControllerHelper.handleAction(SimpleGrailsControllerHelper.java:368)
    at org.codehaus.groovy.grails.web.servlet.mvc.SimpleGrailsControllerHelper.executeAction(SimpleGrailsControllerHelper.java:232)
    at org.codehaus.groovy.grails.web.servlet.mvc.SimpleGrailsControllerHelper.handleURI(SimpleGrailsControllerHelper.java:190)
    at org.codehaus.groovy.grails.web.servlet.mvc.SimpleGrailsControllerHelper.handleURI(SimpleGrailsControllerHelper.java:129)
    at org.codehaus.groovy.grails.web.servlet.mvc.SimpleGrailsController.handleRequest(SimpleGrailsController.java:73)
    at org.springframework.web.servlet.mvc.SimpleControllerHandlerAdapter.handle(SimpleControllerHandlerAdapter.java:48)
    at org.codehaus.groovy.grails.web.servlet.GrailsDispatcherServlet.doDispatch(GrailsDispatcherServlet.java:292)
    at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:719)
    at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:644)
    at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:560)
    at javax.servlet.http.HttpServlet.service(HttpServlet.java:641)
    at javax.servlet.http.HttpServlet.service(HttpServlet.java:722)
    at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:305)
    at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:210)
    at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:70)
    at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:243)
    at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:210)
    at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:70)
    at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:243)
    at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:210)
    at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:70)
    at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:243)
    at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:210)
    at org.apache.catalina.core.ApplicationDispatcher.invoke(ApplicationDispatcher.java:684)
    at org.apache.catalina.core.ApplicationDispatcher.processRequest(ApplicationDispatcher.java:471)
    at org.apache.catalina.core.ApplicationDispatcher.doForward(ApplicationDispatcher.java:402)
    at org.apache.catalina.core.ApplicationDispatcher.forward(ApplicationDispatcher.java:329)
    at org.codehaus.groovy.grails.web.util.WebUtils.forwardRequestForUrlMappingInfo(WebUtils.java:298)
    at org.codehaus.groovy.grails.web.util.WebUtils.forwardRequestForUrlMappingInfo(WebUtils.java:264)
    at org.codehaus.groovy.grails.web.util.WebUtils.forwardRequestForUrlMappingInfo(WebUtils.java:255)
    at org.codehaus.groovy.grails.web.mapping.filter.UrlMappingsFilter.doFilterInternal(UrlMappingsFilter.java:183)
    at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:76)
    at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:243)
    at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:210)
    at org.codehaus.groovy.grails.web.sitemesh.GrailsPageFilter.obtainContent(GrailsPageFilter.java:245)
    at org.codehaus.groovy.grails.web.sitemesh.GrailsPageFilter.doFilter(GrailsPageFilter.java:134)
    at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:243)
    at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:210)
    at org.codehaus.groovy.grails.web.servlet.mvc.GrailsWebRequestFilter.doFilterInternal(GrailsWebRequestFilter.java:69)
    at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:76)
    at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:243)
    at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:210)
    at org.codehaus.groovy.grails.web.filters.HiddenHttpMethodFilter.doFilterInternal(HiddenHttpMethodFilter.java:65)
    at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:76)
    at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:243)
    at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:210)
    at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:88)
    at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:76)
    at org.springframework.web.filter.DelegatingFilterProxy.invokeDelegate(DelegatingFilterProxy.java:237)
    at org.springframework.web.filter.DelegatingFilterProxy.doFilter(DelegatingFilterProxy.java:167)
    at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:243)
    at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:210)
    at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:224)
    at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:169)
    at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:472)
    at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:168)
    at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:98)
    at org.apache.catalina.valves.AccessLogValve.invoke(AccessLogValve.java:927)
    at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:118)
    at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:407)
    at org.apache.coyote.http11.AbstractHttp11Processor.process(AbstractHttp11Processor.java:987)
    at org.apache.coyote.AbstractProtocol$AbstractConnectionHandler.process(AbstractProtocol.java:579)
    at org.apache.tomcat.util.net.JIoEndpoint$SocketProcessor.run(JIoEndpoint.java:307)
    at java.util.concurrent.ThreadPoolExecutor.runWorker(Unknown Source)
    at java.util.concurrent.ThreadPoolExecutor$Worker.run(Unknown Source)
    at java.lang.Thread.run(Unknown Source)
Caused by: com.mysql.jdbc.exceptions.jdbc4.MySQLNonTransientConnectionException: Data source rejected establishment of connection,  message from server: "Too many connections"
    at sun.reflect.GeneratedConstructorAccessor139.newInstance(Unknown Source)
    at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(Unknown Source)
    at java.lang.reflect.Constructor.newInstance(Unknown Source)
    at com.mysql.jdbc.Util.handleNewInstance(Util.java:409)
    at com.mysql.jdbc.Util.getInstance(Util.java:384)
    at com.mysql.jdbc.SQLError.createSQLException(SQLError.java:1015)
    at com.mysql.jdbc.SQLError.createSQLException(SQLError.java:989)
    at com.mysql.jdbc.SQLError.createSQLException(SQLError.java:984)
    at com.mysql.jdbc.MysqlIO.doHandshake(MysqlIO.java:1105)
    at com.mysql.jdbc.ConnectionImpl.createNewIO(ConnectionImpl.java:2186)
    at com.mysql.jdbc.ConnectionImpl.<init>(ConnectionImpl.java:787)
    at com.mysql.jdbc.JDBC4Connection.<init>(JDBC4Connection.java:49)
    at sun.reflect.GeneratedConstructorAccessor131.newInstance(Unknown Source)
    at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(Unknown Source)
    at java.lang.reflect.Constructor.newInstance(Unknown Source)
    at com.mysql.jdbc.Util.handleNewInstance(Util.java:409)
    at com.mysql.jdbc.ConnectionImpl.getInstance(ConnectionImpl.java:357)
    at com.mysql.jdbc.NonRegisteringDriver.connect(NonRegisteringDriver.java:285)
    at org.apache.commons.dbcp.DriverConnectionFactory.createConnection(DriverConnectionFactory.java:38)
    at org.apache.commons.dbcp.PoolableConnectionFactory.makeObject(PoolableConnectionFactory.java:582)
    at org.apache.commons.pool.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:1158)
    at org.apache.commons.dbcp.PoolingDataSource.getConnection(PoolingDataSource.java:106)
    at org.apache.commons.dbcp.BasicDataSource.getConnection(BasicDataSource.java:1044)
    at org.springframework.jdbc.datasource.DataSourceUtils.doGetConnection(DataSourceUtils.java:111)
    at org.springframework.jdbc.datasource.TransactionAwareDataSourceProxy$TransactionAwareInvocationHandler.invoke(TransactionAwareDataSourceProxy.java:224)
    at $Proxy6.getAutoCommit(Unknown Source)
    at org.hibernate.jdbc.ConnectionManager.isAutoCommit(ConnectionManager.java:212)
    at org.hiber 
```

下面告诉我有**太多的连接**

```
Caused by: com.mysql.jdbc.exceptions.jdbc4.MySQLNonTransientConnectionException: Data source rejected establishment of connection,  message from server: "Too many connections"
    at sun.reflect.GeneratedConstructorAccessor139.newInstance(Unknown Source)
    at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(Unknown Source)
    at java.lang.reflect.Constructor.newInstance(Unknown Source)
    at com.mysql.jdbc.Util.handleNewInstance(Util.java:409)
    at com.mysql.jdbc.Util.getInstance(Util.java:384)
    at com.mysql.jdbc.SQLError.createSQLException(SQLError.java:1015)
    at com.mysql.jdbc.SQLError.createSQLException(SQLError.java:989)
    at com.mysql.jdbc.SQLError.createSQLException(SQLError.java:984)
    at com.mysql.jdbc.MysqlIO.doHandshake(MysqlIO.java:1105)
    at com.mysql.jdbc.ConnectionImpl.createNewIO(ConnectionImpl.java:2186)
    at com.mysql.jdbc.ConnectionImpl.<init>(ConnectionImpl.java:787)
    at com.mysql.jdbc.JDBC4Connection.<init>(JDBC4Connection.java:49)
    at sun.reflect.GeneratedConstructorAccessor131.newInstance(Unknown Source)
    at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(Unknown Source)
    at java.lang.reflect.Constructor.newInstance(Unknown Source)
    at com.mysql.jdbc.Util.handleNewInstance(Util.java:409)
    at com.mysql.jdbc.ConnectionImpl.getInstance(ConnectionImpl.java:357)
    at com.mysql.jdbc.NonRegisteringDriver.connect(NonRegisteringDriver.java:285)
    at org.apache.commons.dbcp.DriverConnectionFactory.createConnection(DriverConnectionFactory.java:38)
    at org.apache.commons.dbcp.PoolableConnectionFactory.makeObject(PoolableConnectionFactory.java:582)
    at org.apache.commons.pool.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:1158)
    at org.apache.commons.dbcp.PoolingDataSource.getConnection(PoolingDataSource.java:106)
    at org.apache.commons.dbcp.BasicDataSource.getConnection(BasicDataSource.java:1044)
    at org.springframework.jdbc.datasource.DataSourceUtils.doGetConnection(DataSourceUtils.java:111)
    at org.springframework.jdbc.datasource.TransactionAwareDataSourceProxy$TransactionAwareInvocationHandler.invoke(TransactionAwareDataSourceProxy.java:224)
    at $Proxy6.getAutoCommit(Unknown Source)
    at org.hibernate.jdbc.ConnectionManager.isAutoCommit(ConnectionManager.java:212)
    at org.hibernate.jdbc.JDBCContext.afterNontransactionalQuery(JDBCContext.java:266) 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-06T22:30:44.200

我会说这是你的问题：

```
Caused by: com.mysql.jdbc.exceptions.jdbc4.MySQLNonTransientConnectionException: Data source rejected establishment of connection,  message from server: "Too many connections" 
```

您可以使用此连接信息与 MySQL 客户端（GUI 或命令行）连接吗？确保您可以在 Grails 外部进行一般连接，然后配置 Grails 以使用数据库。

正如@rlovtang 在他的评论中所说，指定方言是个好主意。由于 MyISAM/InnoDB 的原因，它对 MySQL 尤其重要，但是如果您指定它，Grails 不需要检查连接元数据来确定您正在使用的数据库。尽管在这种情况下，如果您无法建立连接以找出方言，那么您肯定会在一般情况下进行持久性问题。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-07T10:07:48.743

您已达到最大 MySQL 连接数。如果您的物理数据库已达到其容量，那么 grails 将无法为您做任何事情。

MySQL 的默认活动连接数为 150。正如您在池属性中配置的那样，您需要设置为`maximum_connections`300 。`my.cnf`

`netstat -anp | grep 3306`如果您有，请仔细检查，当您的负载测试在您的数据库机器上运行时，池参数是否正确使用，例如使用。

# node.js - 读取目录中的所有文件，将它们存储在对象中，并发送对象

> ID：10049557
> 
> 赞同：112
> 
> 时间：2012-04-06T21:38:22.623
> 
> 标签：node.js

我不知道这是否可能，但这里有。使用回调使其变得更加困难。

我有一个包含 html 文件的目录，我想用 node.js 和 socket.io 将这些文件以对象块的形式发送回客户端。

我所有的文件都在 /tmpl

所以socket需要读取/tmpl中的所有文件。

对于每个文件，它必须将数据存储在一个对象中，文件名作为键，内容作为值。

```
 var data;
  // this is wrong because it has to loop trough all files.
  fs.readFile(__dirname + '/tmpl/filename.html', 'utf8', function(err, html){
      if(err) throw err;
      //filename must be without .html at the end
      data['filename'] = html;
  });
  socket.emit('init', {data: data}); 
```

最后的回调也是错误的。当目录中的所有文件都完成后，必须调用它。

但我不知道如何创建代码，有人知道这是否可能吗？

* * *

## 回答 #1

> 赞同：198
> 
> 时间：2012-04-06T21:57:09.760

所以，分为三个部分。读取、存储和发送。

下面是阅读部分：

```
var fs = require('fs');

function readFiles(dirname, onFileContent, onError) {
  fs.readdir(dirname, function(err, filenames) {
    if (err) {
      onError(err);
      return;
    }
    filenames.forEach(function(filename) {
      fs.readFile(dirname + filename, 'utf-8', function(err, content) {
        if (err) {
          onError(err);
          return;
        }
        onFileContent(filename, content);
      });
    });
  });
} 
```

这是存储部分：

```
var data = {};
readFiles('dirname/', function(filename, content) {
  data[filename] = content;
}, function(err) {
  throw err;
}); 
```

发送部分由您决定。您可能希望一一发送或在阅读完成后发送。

如果您想在阅读完成后发送文件，您应该使用同步版本的`fs`函数或使用 Promise。异步回调不是一个好的风格。

此外，您询问了有关剥离扩展名的问题。你应该一一回答问题。没有人会只为您编写完整的解决方案。

* * *

## 回答 #2

> 赞同：21
> 
> 时间：2017-04-20T09:00:33.237

这是前一个版本的现代`Promise`版本，使用一种`Promise.all`方法在读取所有文件后解决所有承诺：

```
/**
 * Promise all
 * @author Loreto Parisi (loretoparisi at gmail dot com)
 */
function promiseAllP(items, block) {
    var promises = [];
    items.forEach(function(item,index) {
        promises.push( function(item,i) {
            return new Promise(function(resolve, reject) {
                return block.apply(this,[item,index,resolve,reject]);
            });
        }(item,index))
    });
    return Promise.all(promises);
} //promiseAll

/**
 * read files
 * @param dirname string
 * @return Promise
 * @author Loreto Parisi (loretoparisi at gmail dot com)
 * @see http://stackoverflow.com/questions/10049557/reading-all-files-in-a-directory-store-them-in-objects-and-send-the-object
 */
function readFiles(dirname) {
    return new Promise((resolve, reject) => {
        fs.readdir(dirname, function(err, filenames) {
            if (err) return reject(err);
            promiseAllP(filenames,
            (filename,index,resolve,reject) =>  {
                fs.readFile(path.resolve(dirname, filename), 'utf-8', function(err, content) {
                    if (err) return reject(err);
                    return resolve({filename: filename, contents: content});
                });
            })
            .then(results => {
                return resolve(results);
            })
            .catch(error => {
                return reject(error);
            });
        });
  });
} 
```

**如何使用它：**

就像这样做一样简单：

```
readFiles( EMAIL_ROOT + '/' + folder)
.then(files => {
    console.log( "loaded ", files.length );
    files.forEach( (item, index) => {
        console.log( "item",index, "size ", item.contents.length);
    });
})
.catch( error => {
    console.log( error );
}); 
```

假设您有另一个文件夹列表，您也可以遍历此列表，因为内部 promise.all 将异步解析每个文件夹：

```
var folders=['spam','ham'];
folders.forEach( folder => {
    readFiles( EMAIL_ROOT + '/' + folder)
    .then(files => {
        console.log( "loaded ", files.length );
        files.forEach( (item, index) => {
            console.log( "item",index, "size ", item.contents.length);
        });
    })
    .catch( error => {
        console.log( error );
    });
}); 
```

**这个怎么运作**

会`promiseAll`变魔术。它需要一个功能块 signature `function(item,index,resolve,reject)`，`item`数组中的当前项在哪里，它在数组中的`index`位置`resolve`以及回调函数。每个 Promise 都将被推送到当前数组中，并通过匿名函数调用将当前作为参数：`reject``Promise``index``item`

```
promises.push( function(item,i) {
        return new Promise(function(resolve, reject) {
            return block.apply(this,[item,index,resolve,reject]);
        });
    }(item,index)) 
```

然后所有的承诺都将被解决：

```
return Promise.all(promises); 
```

* * *

## 回答 #3

> 赞同：18
> 
> 时间：2018-04-01T18:33:58.680

对于下面的所有示例，您需要导入[fs](https://nodejs.org/api/fs.html)和[路径](https://nodejs.org/api/path.html)模块：

```
const fs = require('fs');
const path = require('path'); 
```

## 异步读取文件

```
function readFiles(dir, processFile) {
  // read directory
  fs.readdir(dir, (error, fileNames) => {
    if (error) throw error;

    fileNames.forEach(filename => {
      // get current file name
      const name = path.parse(filename).name;
      // get current file extension
      const ext = path.parse(filename).ext;
      // get current file path
      const filepath = path.resolve(dir, filename);

      // get information about the file
      fs.stat(filepath, function(error, stat) {
        if (error) throw error;

        // check if the current path is a file or a folder
        const isFile = stat.isFile();

        // exclude folders
        if (isFile) {
          // callback, do something with the file
          processFile(filepath, name, ext, stat);
        }
      });
    });
  });
} 
```

用法：

```
// use an absolute path to the folder where files are located
readFiles('absolute/path/to/directory/', (filepath, name, ext, stat) => {
  console.log('file path:', filepath);
  console.log('file name:', name);
  console.log('file extension:', ext);
  console.log('file information:', stat);
}); 
```

## 同步读取文件，存储在数组中，自然排序

```
/**
 * @description Read files synchronously from a folder, with natural sorting
 * @param {String} dir Absolute path to directory
 * @returns {Object[]} List of object, each object represent a file
 * structured like so: `{ filepath, name, ext, stat }`
 */
function readFilesSync(dir) {
  const files = [];

  fs.readdirSync(dir).forEach(filename => {
    const name = path.parse(filename).name;
    const ext = path.parse(filename).ext;
    const filepath = path.resolve(dir, filename);
    const stat = fs.statSync(filepath);
    const isFile = stat.isFile();

    if (isFile) files.push({ filepath, name, ext, stat });
  });

  files.sort((a, b) => {
    // natural sort alphanumeric strings
    // https://stackoverflow.com/a/38641281
    return a.name.localeCompare(b.name, undefined, { numeric: true, sensitivity: 'base' });
  });

  return files;
} 
```

用法：

```
// return an array list of objects
// each object represent a file
const files = readFilesSync('absolute/path/to/directory/'); 
```

## 使用 promise 异步读取文件

[本文中有关](http://2ality.com/2017/05/util-promisify.html)[Promisify](https://nodejs.org/dist/latest-v8.x/docs/api/util.html#util_util_promisify_original)的更多信息。

```
const { promisify } = require('util');

const readdir_promise = promisify(fs.readdir);
const stat_promise = promisify(fs.stat);

function readFilesAsync(dir) {
  return readdir_promise(dir, { encoding: 'utf8' })
    .then(filenames => {
      const files = getFiles(dir, filenames);

      return Promise.all(files);
    })
    .catch(err => console.error(err));
}

function getFiles(dir, filenames) {
  return filenames.map(filename => {
    const name = path.parse(filename).name;
    const ext = path.parse(filename).ext;
    const filepath = path.resolve(dir, filename);

    return stat({ name, ext, filepath });
  });
}

function stat({ name, ext, filepath }) {
  return stat_promise(filepath)
    .then(stat => {
      const isFile = stat.isFile();

      if (isFile) return { name, ext, filepath, stat };
    })
    .catch(err => console.error(err));
} 
```

用法：

```
readFiles('absolute/path/to/directory/')
  // return an array list of objects
  // each object is a file
  // with those properties: { name, ext, filepath, stat }
  .then(files => console.log(files))
  .catch(err => console.log(err)); 
```

**注意：**返回`undefined`文件夹，如果需要，可以将它们过滤掉：

```
readFiles('absolute/path/to/directory/')
  .then(files => files.filter(file => file !== undefined))
  .catch(err => console.log(err)); 
```

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2017-12-03T10:06:22.390

你是像我这样的懒人并且喜欢**npm 模块**吗：D 然后检查一下。

npm 安装[节点目录](https://www.npmjs.com/package/node-dir)

读取文件的示例：

```
var dir = require('node-dir');

dir.readFiles(__dirname,
    function(err, content, next) {
        if (err) throw err;
        console.log('content:', content);  // get content of files
        next();
    },
    function(err, files){
        if (err) throw err;
        console.log('finished reading files:', files); // get filepath 
   }); 
```

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2017-09-06T08:22:33.287

另一个使用 Promise 的现代方法的版本。其他基于 Promise 的响应更短：

```
const readFiles = (dirname) => {

  const readDirPr = new Promise( (resolve, reject) => {
    fs.readdir(dirname, 
      (err, filenames) => (err) ? reject(err) : resolve(filenames))
  });

  return readDirPr.then( filenames => Promise.all(filenames.map((filename) => {
      return new Promise ( (resolve, reject) => {
        fs.readFile(dirname + filename, 'utf-8',
          (err, content) => (err) ? reject(err) : resolve(content));
      })
    })).catch( error => Promise.reject(error)))
};

readFiles(sourceFolder)
  .then( allContents => {

    // handle success treatment

  }, error => console.log(error)); 
```

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2018-01-01T07:32:10.747

如果你有 Node.js 8 或更高版本，你可以使用新的 util.promisify。（我将与重新格式化为对象有关的代码部分标记为可选，这是原始帖子要求的。）

```
 const fs = require('fs');
  const { promisify } = require('util');

  let files; // optional
  promisify(fs.readdir)(directory).then((filenames) => {
    files = filenames; // optional
    return Promise.all(filenames.map((filename) => {
      return promisify(fs.readFile)(directory + filename, {encoding: 'utf8'});
    }));
  }).then((strArr) => {
    // optional:
    const data = {};
    strArr.forEach((str, i) => {
      data[files[i]] = str;
    });
    // send data here
  }).catch((err) => {
    console.log(err);
  }); 
```

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2020-09-11T12:33:00.347

我刚写了这个，对我来说看起来更干净：

```
const fs = require('fs');
const util = require('util');

const readdir = util.promisify(fs.readdir);
const readFile = util.promisify(fs.readFile);

const readFiles = async dirname => {
    try {
        const filenames = await readdir(dirname);
        console.log({ filenames });
        const files_promise = filenames.map(filename => {
            return readFile(dirname + filename, 'utf-8');
        });
        const response = await Promise.all(files_promise);
        //console.log({ response })
        //return response
        return filenames.reduce((accumlater, filename, currentIndex) => {
            const content = response[currentIndex];
            accumlater[filename] = {
                content,
            };
            return accumlater;
        }, {});
    } catch (error) {
        console.error(error);
    }
};

const main = async () => {

    const response = await readFiles(
        './folder-name',
    );
    console.log({ response });
};
```

`response`您可以根据需要修改格式。此代码的`response`格式如下所示：

```
{
   "filename-01":{
      "content":"This is the sample content of the file"
   },
   "filename-02":{
      "content":"This is the sample content of the file"
   }
} 
```

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2016-08-24T21:53:35.707

为了让代码在不同的环境中顺利运行，**path.resolve**可以用于操作路径的地方。这是效果更好的代码。

阅读部分：

```
var fs = require('fs');

function readFiles(dirname, onFileContent, onError) {
  fs.readdir(dirname, function(err, filenames) {
    if (err) {
      onError(err);
      return;
    }
    filenames.forEach(function(filename) {
      fs.readFile(path.resolve(dirname, filename), 'utf-8', function(err, content) {
        if (err) {
          onError(err);
          return;
        }
        onFileContent(filename, content);
      });
    });
  });
} 
```

收纳部分：

```
var data = {};
readFiles(path.resolve(__dirname, 'dirname/'), function(filename, content) {
  data[filename] = content;
}, function(error) {
  throw err;
}); 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2020-04-29T06:39:52.417

## 异步/等待

```
const { promisify } = require("util")
const directory = path.join(__dirname, "/tmpl")
const pathnames = promisify(fs.readdir)(directory)

try {
  async function emitData(directory) {
    let filenames = await pathnames
    var ob = {}
    const data = filenames.map(async function(filename, i) {
      if (filename.includes(".")) {
        var storedFile = promisify(fs.readFile)(directory + `\\${filename}`, {
          encoding: "utf8",
        })
        ob[filename.replace(".js", "")] = await storedFile
        socket.emit("init", { data: ob })
      }
      return ob
    })
  }

  emitData(directory)
} catch (err) {
  console.log(err)
} 
```

谁想尝试使用发电机？

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2021-11-15T04:20:31.400

所以，如果有人正在寻找一种对初学者友好的方法，这是我的。

在实际解决之前，我们必须了解**异步函数**和**Promise**。异步函数在单线程范围之外运行，可以与主线程并行运行。这基本上意味着，如果一个函数是异步的，JavaScript 不会等待函数完成，而是会转到下一行。该函数将并行执行。

fs.readFile() 是异步的，因此它执行下一行，并并行运行，

现在，让我们了解承诺。Promise 基本上是一个对象，它返回异步函数的成功或失败。例如：

```
//Defining Promise
const promise = new Promise((resolve,reject)=>{
    //This is an asynchronous function, which takes 2 seconds to execute
    setTimeout(()=>{
        if(1!=0){
            //If there is an error reject the promise
            reject(new Error("This is an error messahe"))
        } 
        else{
            //if there are no errors we resolve the promise
            resolve({'userId':'id'})
        }
    },2000)
}) 
```

现在，原来的问题来了

```
const fs = require("fs");

// Read the File Names.
function readFileNames() {
  // Defining a new promise
  return new Promise((resolve, reject) => {
    try {
      //read the directory
      fs.readdir("./public/", (err, files) => {
        // If read completes, resolve the promise.
        resolve(files);
      });
    } catch (err) {
      // If there is an error, reject the promise. 
      reject(err);
    }
  });
}

// Read content of a given file
function readFileContent(file) {
  return new Promise((resolve, reject) => {
    try {
      fs.readFile("./public/" + file, "utf8", (err, content) => {
        resolve(content);
      });
    } catch (err) {
      reject(err);
    }
  });
}

//sending the data
module.exports = {
// If we want to wait for a function to wait for a promise to be 
// resolved we define it as 'async'
  async get(req, res) {
    let data = {};
    //Here we wait for the promise to resolve, thus await is used
    const fileNames = await readFileNames();
    let count = 0;
    // Note we again use async since we want to wait for promise
    fileNames.forEach(async (name) => {
      // We wait for the content of file.
      const content = await readFileContent(name);
      data[name] = content;
      // Since we want to send data after the loop is completed.
      if (count === fileNames.length - 1) {
        res.send(data);
      }
      count++;
    });
  } 
```

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2021-12-07T13:34:55.160

在此示例中，我创建了一个数组。但是如果你愿意，你可以创建一个对象

```
const fs = require('fs-extra')

const dirname = `${process.cwd()}/test`
const fileNames = await fs.readdir(dirname)

const files = []
for(const fileName of fileNames){
    const file = await fs.readFile(`${dirname}/${fileName}`, 'utf8')
    files.push(file)
} 
```

# steam - 如何从 Valve 服务器查询中获取玩家 SteamID？

> ID：10049561
> 
> 赞同：7
> 
> 时间：2012-04-06T21:38:42.157
> 
> 标签：steam

这些查询：[https ://developer.valvesoftware.com/wiki/Server_queries](https://developer.valvesoftware.com/wiki/Server_queries)

可以返回关于 [TF2] 服务器的许多信息，例如玩家姓名、积分、当前地图等。

我知道如何返回玩家姓名列表，但这没有用（玩家可以自由更改他们的名字）。

如何返回 SteamID 列表？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-25T14:10:10.537

获取 SteamID 列表的**唯一**方法是连接真实源客户端并发出“状态”控制台命令。

有一个基于 cfg 的解决方案可以动态生成特殊的 cfg 文件（将由游戏加载），其中包含顺序连接到多个服务器并发出“状态”命令的命令。SteamID 将写入控制台日志文件（并且可以轻松解析）。

这些程序称为“服务器扫描仪”或“steamid 扫描仪”，主要用于诈骗和统计目的，可以在官方论坛上找到（facepunch.com 目前已关闭） [https://www.google.com/?q =site:facepunch.com%20server%7Csteamid%20scanner](https://www.google.com/?q=site:facepunch.com%20server%7Csteamid%20scanner)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-21T19:05:36.950

A2S* 查询无法做到这一点。相反，您需要使用[RCON 协议](https://developer.valvesoftware.com/wiki/Source_RCON_Protocol)并发出`status`命令。

A2S_INFO查询可以通过传递[给](https://developer.valvesoftware.com/wiki/Server_queries#A2S_INFO)来返回*服务器的*SteamID，但这是您可以使用 A2S* 命令获得的唯一 SteamID`0x10``Extra Data Flag (EDF)`

# php - 是否可以在没有重定向的情况下将视频上传到 Youtube？

> ID：10049566
> 
> 赞同：0
> 
> 时间：2012-04-06T21:39:33.023
> 
> 标签：php, zend-framework, youtube

Zend 框架中的 Youtube API 指定我可以使用基于浏览器的上传通过表单将视频上传到 Youtube。但是，这样的表单需要在查询字符串的“nexturl”参数中定义一个回发页面。

我正在尝试修改 Gravity Forms（一个 Wordpress 插件），以便我可以将视频作为表单提交的内联函数上传到 Youtube。这意味着我无法将表单操作设置为指向 Youtube；它必须指向本机重力形式支持。

有什么方法可以在不使用此重定向的情况下将视频上传到 Youtube？如果没有，我能够完成这项工作的唯一方法是打开一个新窗口并在那里执行上传（这并不理想）。

如果有人对此有任何经验，请告诉我。谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-06T22:01:23.363

如果您将其`IFRAME`嵌入到您的页面中怎么办？

# cakephp - 我可以在 _schema Model 字段中添加什么来构建自定义无表模型？

> ID：10049567
> 
> 赞同：0
> 
> 时间：2012-04-06T21:39:36.577
> 
> 标签：cakephp, model, cakephp-2.1

我已经在食谱中读过这个“技巧”：http: [//book.cakephp.org/2.0/en/models/model-attributes.html#usetable](http://book.cakephp.org/2.0/en/models/model-attributes.html#usetable)

现在我想为我的模型构建一个自定义模式，但是这个数组没有格式。例如，我不知道应该为 bool 类型输入什么：“boolean”还是“bool”？

如果我想在使用 $this->Form->input 时获得一个“选择框”，我应该输入什么类型？我应该创建一个 hasMany 关系（使用 2 个无表模型）吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-04-06T22:14:41.230

文档在这里：[http ://book.cakephp.org/2.0/en/models/model-attributes.html#schema](http://book.cakephp.org/2.0/en/models/model-attributes.html#schema)

这是联系表格的示例：http: [//www.dereuromark.de/2011/12/15/tools-plugin-part-2-contact-form/](http://www.dereuromark.de/2011/12/15/tools-plugin-part-2-contact-form/)

至于布尔值（tinyint 1）：

```
protected $_schema = array(
   'status' => array(
       'type' => 'boolean',
       'length' => 1,
       'default' => 0,
       'null' => false,
       'comment' => 'some optional comment'
   ),   
); 
```

提示：如果您想快速找到自己的方法：

创建一个表“apples”和一个 Apple 模型并添加您要调试的所有类型的字段，然后像这样调用模型 schema()：

```
debug($this->Apple->schema()); 
```

这就是我确认上述内容的方式。

对于第二部分 - 如果值可以被认为是“静态”的，我对选择框使用以下 ENUM 解决方案：http: [//www.dereuromark.de/2010/06/24/static-enums-or-semihardcoded -attributes/](http://www.dereuromark.de/2010/06/24/static-enums-or-semihardcoded-attributes/) 否则您应该使用说明书或数组数据源中记录的关系。

# algorithm - Jon Bentleys 美丽的快速排序 - 它是如何工作的？

> ID：10049579
> 
> 赞同：3
> 
> 时间：2012-04-06T21:41:22.323
> 
> 标签：algorithm, quicksort, data-partitioning

我以为我对快速排序的工作原理有很好的了解，直到我在[http://code.google.com/edu/algorithms/index.html](http://code.google.com/edu/algorithms/index.html)上观看了 Jon Bentley 介绍他的“漂亮的快速排序代码”的视频，如下所示：

```
void quicksort(int l, int u){
    int i, m;
    if(l >= u) return;
    m = l;
    for(i = l+1; i<= u; i++)
        if(x[i] < x[l])
            swap(++m, i); //this is where I'm lost. Why the heck does it preincrement?

    swap(l, m);

    quicksort(l, m-1);
    quicksort(m+1, u);

} 
```

令我困惑的算法的另一部分是 FOR 循环之后的最终交换。为什么这是必要的？让我们假设数组已经有序。如果这是真的，那么由于 x[i] > x[l] 就不会发生交换。最后，我们将 l 与 m 交换。这搞砸了订单。

我错过了什么吗？

谢谢。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-06T21:51:09.090

在开始`m`时设置为`l`，并且该元素`x[l]`被选择为分区元素（枢轴）。

接下来，该算法遍历一个列表，每当它找到一个小于 的元素时`x[l]`，它会将其移动**到当前的 之后** `m`。这意味着，当 时`m > l`，从`l+1`到的所有位置上的元素`m`都小于元素`x[l]`。

例如：

```
3 5 4 2 1  l = 0, m = 0, i = 1
  ^
3 5 4 2 1  l = 0, m = 0, i = 2
    ^
3 2 4 5 1  l = 0, m = 1, i = 3
      ^
3 2 1 5 4  l = 0, m = 2, i = 4
        ^ 
```

最后，我们将最后一个较小的数字与第一个（分区）元素交换以获得：

```
1 2 3 5 4 
```

如果没有比第一个更小的元素，则交换什么也不做（因为`m`等于`l`）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-06T21:50:57.620

at 的元素`x[l]`是所选的枢轴。for 循环的不变量是所有元素`x[l+1]`through`x[m]`都小于枢轴，并且所有来自`x[m]`through的元素`x[i]`都大于或等于枢轴。

当它找到一个小于枢轴的元素时，它将它向下移动到 entry `m+1`，然后向上碰撞`m`。（入口处`m+1`大于枢轴点，因此向上移动它很好。）

最后一个交换是将枢轴从`x[l]`to移动，`x[m]`因为它需要在下部数组和上部数组之间结束。如果没有发生交换（排序数组示例），那么`m==l`最终交换不会移动任何东西。

代码在教学上会更清晰地设置`m = l + 1`和使用`m++`，而不是`++m`.

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-05-19T04:36:59.233

分区算法很好并且容易记住。它已经在 ACM 的通信中或被 Benltey 多次重述。它也出现在 Bentley 的 Programming Pearls 书中。这个想法是跟踪否定后置条件的元素，即枢轴后面的元素较少，索引较高的元素较大。但是，如果选择随机元素不是随机的，我们最终可能会得到最大（或最小）的元素，这将使我们对 O(n) 进行更多的交换。java中的一个实现和解释是[博客]：[http](http://harisankar-krishnaswamy.blogspot.in/2013/05/quick-sort-partition-algorithm.html) ://harisankar-krishnaswamy.blogspot.in/2013/05/quick-sort-partition-algorithm.html “这里”

哈里

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-06T21:53:30.710

如果数组已排序，m 永远不会从它的初始值 l 改变，所以交换什么也不做。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-04-06T22:40:54.650

固定索引`l`并`u`指向要排序的子数组的第一个和最后一个元素。该值`x[l]`始终被选为基准。

在循环的顶部，子数组（不包括枢轴`x[l]`）划分如下：

*   下部区域：带有索引的元素`l < index <= m`已经过测试，发现`< x[l]`
*   中间区域：带索引的元素`m < index < i`已经过测试，发现`>= x[l]`
*   上部区域：具有索引的元素`i <= index <= u`尚未经过测试

一种可能的混淆来源是，当循环运行时，值大于枢轴的区域是*中间*部分，而不是上部。在未测试区域用尽之前，它不会到达阵列的上部——它通过反复交换有效地“移动”，为扩展的下部区域腾出空间。

具体来说，`m`每当下部区域需要扩展时，循环变量就会预先递增：中间区域的第一个元素（如果有）必须移动到末尾，以便扩展下部区域。请注意，如果中间区域为空，`m == i`则在预增量之后（对于这种情况，`swap()`操作必须是空操作）。

最后，枢轴`x[l]`被交换到下部区域的末端，以将其放置到位以进行递归步骤。请注意，如果数组已经有序，则下部区域为空，`m == l`并且最终`swap()`操作再次为空操作。

# arrays - 在scala中的多维数组上映射函数

> ID：10049581
> 
> 赞同：3
> 
> 时间：2012-04-06T21:41:35.473
> 
> 标签：arrays, scala, map, multidimensional-array

我知道有一种干净的方法可以将函数映射到`f:A => B`数组上，`foo`类型`Array[A]`为获取`Array[B]`via `foo.map{f}`。

是否有一种干净的方法来映射`f`以`bar:Array[Array[A]]`获得`Array[Array[B]]`保留数组结构的`bar`同时将所有`A`元素映射到 type的元素`B`？

一般来说，有没有办法映射任意维度数组的元素（即不仅是 2D，而且是 3D、4D 等）。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-04-06T21:46:48.890

您可以在地图内映射：

```
bar.map(_.map(f)) 
```

~~我怀疑是否有一种类型安全的方法来映射任意维度的数组，因为不同维度的数组属于不同的类型。~~但是保持嵌套映射调用很简单：

```
scala> val bam = new Array[Array[Array[Array[Array[A]]]]](0)
bam: Array[Array[Array[Array[Array[A]]]]] = Array()

scala> bam.map(_.map(_.map(_.map(_.map(f)))))
res1: Array[Array[Array[Array[Array[B]]]]] = Array() 
```

实际上，我发现[shapeless](https://github.com/milessabin/shapeless)具有“对任意嵌套数据结构的通用映射和折叠操作”。我没有测试过`Array`，但看起来它可以与其他数据结构一起使用。

```
everywhere(f)(bam) 
```

# node.js - 避免“破坏非socket.io升级”错误

> ID：10049587
> 
> 赞同：3
> 
> 时间：2012-04-06T21:41:53.867
> 
> 标签：socket.io, node.js, dojo, websocket, socket.io

我正在尝试创建一个基于[socket.io](/questions/tagged/socket.io "显示标记为“socket.io”的问题")的服务器，但是每当我使用 dojo 由客户端连接到它时，它都会向我显示此错误：

```
 debug - destroying non-socket.io upgrade 
```

这是我的服务器代码

```
var express = require("express");
var io = require("socket.io");
server= express.createServer();
var server_socket = io.listen(server);

server_socket.sockets.on("connection",function(socket)
{
    console.log("connection established");
    socket.emit("message", message);
});

server.listen(8080); 
```

这是我的客户代码

```
require(["dojox/socket"], function (socket)
{
    var args, ws = typeof WebSocket != "undefined";
    var _socket = dojox.socket(args = {
        url: ws ? "ws://localhost:8080/" : "http://localhost:8080",
        headers:{
        "Content-Type":"application/x-www-urlencoded"
         },
        transport: function(args, message){
          args.content = message; // use URL-encoding to send the message
                                  // instead of a raw body
          dojo.xhrPost(args);
         }
    }); 
    websocket = dojox.socket.Reconnect(_socket);
    websocket.on("message",function(data)
    {
       console.log(data);
    });
}); 
```

请帮我。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-04-12T12:44:08.597

在 socketio 服务器配置上将“destroy upgrade”设置为 false 将解决此问题。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-09T19:06:18.753

Socket.io 是 node.js 的服务器和客户端库。我猜 Dojo 的 websocket 客户端与 socket.io 服务器不直接兼容。我建议只使用[socket.io 客户端](http://socket.io/#how-to-use)进行连接，否则您可能不得不修改 Dojo 的 websocket 库，这可能会很困难。

# haproxy - HAProxy 远程访问统计

> ID：10049588
> 
> 赞同：1
> 
> 时间：2012-04-06T21:42:02.550
> 
> 标签：haproxy

我想知道如何在不使用 Web 界面的情况下远程访问 HAProxy 的统计信息。我想编写一个代码来查询 HAProxy 的统计信息，以查看有多少特定服务器停机。

我可以通过 Web 界面访问统计信息，但我需要对其进行解析。我试图尽可能避免这种情况。我发现的另一件事是，有一种方法可以使用 socat 在本地查询统计信息，但我不确定如何远程查询 haproxy 的“套接字”，或者是否有可能。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-17T18:21:21.143

我认为您无法解析 Web 界面的输出。幸运的是，haproxy 可以返回 csv 中的所有内容，因此这不是一项艰巨的任务。

你没有特别提到 Nagios，所以这可能不是你要找的，但是有人写了一个漂亮的 Nagios 插件来做到这一点：[http ://cvs.orion.education.fr/viewvc/viewvc.cgi/ nagios-plugins-perl/trunk/plugins/check_haproxy.pl?revision=135&view=markup](http://cvs.orion.education.fr/viewvc/viewvc.cgi/nagios-plugins-perl/trunk/plugins/check_haproxy.pl?revision=135&view=markup)

# bash - 如何将 eval 的结果分配给 bash 脚本中的变量？

> ID：10049592
> 
> 赞同：5
> 
> 时间：2012-04-06T21:42:16.003
> 
> 标签：bash, variables, eval

我有一个 bash 脚本，它返回一个列表，这是我想要的，但我需要将结果放在一个变量中，以便我可以在 for 循环中一次对它们进行操作。

```
#!/bin/bash
processID="ps aux | grep `date +"%b"` | gawk '{print \$2}'"

eval $processID 
```

如何将 eval 的结果分配给变量？谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-06T21:46:16.940

```
pid=$( ps aux | grep `date +"%b"` | awk '{print $2}' ) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-06T22:12:07.737

由于您已经在使用 awk，因此您可以不再需要 grep。"$" 不需要转义，因为扩展不会出现在单引号内。

```
pid=$(ps aux | awk -vdate=$(date +%b) '$0 ~ date { print $2 }') 
```

如果您希望返回多个 pid，请使用数组：

```
pids=($(ps aux | awk -vdate=$(date +%b) '$0 ~ date { print $2 }'))

for pid in "${pids[@]}"; do
   ...
done 
```

# wpf - WPF 和线程编组

> ID：10049593
> 
> 赞同：1
> 
> 时间：2012-04-06T21:42:17.800
> 
> 标签：wpf, multithreading, windows-phone-7

如果 II 只是没有弄清楚实际的方法，我深表歉意，但我已经浏览了各种博客文章并且觉得离答案更近了。

我正在编写一个 WP7 应用程序，它本质上是一个将时间转换为成本的秒表。

该模型包含方法 Start() 和 Pause() 以及双重属性 Cost。在 ViewModel 中，我将 ICommands 用于 Start() 和 Pause()，这会触发底层模型函数。然而，在调用 Start() 之后，我希望 UI 能够反映成本的增加。

我考虑了几种方法：

1.  ViewModel 通过一个自我实现的订阅者模型订阅模型，并且模型在模型运行时每隔几毫秒通知所有订阅者。
2.  View Model StartCommand 启动一个后台工作程序，该工作程序每隔几毫秒在 Cost 属性上触发一个 RaisePropertyChanged 事件。

我选择了第二个建议，因为模型根本不需要线程（它只记录用户按下开始和暂停的时间，并在成本计算中使用它）。我的方法基于[http://msdn.microsoft.com/en-us/library/cc221403(VS.95).aspx](http://msdn.microsoft.com/en-us/library/cc221403(VS.95).aspx)

但是，当我尝试运行它时，我得到一个“UnauthorizedAccessException”。代码如下：

Backgroundworker 在构造函数中被创建为 VM 成员

```
public MeetingCostViewModel()
{
    _backgroundWorker = new BackgroundWorker
    {
        WorkerSupportsCancellation = true,
        WorkerReportsProgress = false,
    };
    _backgroundWorker.DoWork += DoWork;
} 
```

StartCommand 触发后台工作者运行

```
private DelegateCommand _startCommand;
    public ICommand StartCommand
    {
        get
        {
            return _startCommand ?? (_startCommand = new DelegateCommand(
                delegate
                {
                    _meetingCost.Start();
                    _keepUpdating = true;
                    if (_backgroundWorker.IsBusy != true)
                    {
                        _backgroundWorker.RunWorkerAsync();
                    }
                }));
        }
    } 
```

这是基于[http://blog.lab49.com/archives/1166的实际工作方法](http://blog.lab49.com/archives/1166)

```
private void DoWork(object sender, DoWorkEventArgs e)
{
    while (true)
    {
        PropertyChangedEventHandler temp = PropertyChanged;
        if (temp != null)
        {
            temp(this, new PropertyChangedEventArgs("Cost"));
        }
        Thread.Sleep(50);
    }
} 
```

我不确定这是否是正确的方法，但我想保持 View 数据绑定并且没有“代码隐藏”，但是这里的大多数替代响应都需要明确设置控件，我想不惜一切代价避免。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-06T22:02:21.767

UnauthorizedAccessException 可能意味着您正在从不同的线程访问 UI 对象。您的事件处理程序在错误的线程上触发。

更改代码以使用将在 UI 线程上触发的 DispatcherTimer。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-06T22:30:04.437

另一种解决方案是在 的报告进度事件处理程序中进行更新`BackgroundWorker`。它将自动编组到正确的线程。

# python - 如何在 Python 中控制函数的参数准确性

> ID：10049596
> 
> 赞同：2
> 
> 时间：2012-04-06T21:43:02.637
> 
> 标签：python, function, parameters

我在 Python 中有这个函数：

```
def Rotate_Vector(vector, axis, direction): 
```

其中**vector**是3个元素的元组（每个元素代表笛卡尔坐标轴上向量的三个坐标x，y，z），**axis**是轴的坐标，**direction**是一个整数，表示顺时针或逆时针运动。

我想在我的功能中控制输入参数是否正确：

*   *向量*必须是 3 个整数的元组
*   *axis*必须是 3 个整数的元组，并且可能的值应该是 -1, 0, 1
*   *方向*必须是值为 +1 或 -1 的整数。

我想知道在函数中执行这些控件（类型、值和元素数量）的正确方法。

编辑：

**轴**可能是 6 种可能的情况： (1,0,0) (-1,0,0) (0,1,0) (0,-1,0) (0,0,1) (0,0,- 1)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-06T21:44:13.833

简短的回答是：不要。Python 是鸭子类型的，所以只要做你需要做的，如果它不起作用，那么它就会出错。

例如，如果将向量限制为长度为 3 的元组，那么传入列表的人呢？如果它做同样的工作，为什么它们传递的内容对你很重要？

如果您真的觉得需要，请执行以下操作：

```
if direction not in {1, -1}:
    raise ValueError("direction must be +1 or -1")

if not len(vector) == 3:
    raise ValueError("vector must contain 3 values") 
```

ETC...

但是，这违反了 Python*请求原谅而不是许可*的原则。

我还要注意这里更好的选择是避免使用幻数。例如，添加，`Vector.FORWARD = +1`然后`Vector.BACKWARD = -1`告诉人们将它们传递给方向。这仍然提供了灵活性，但为人们提供了关于使用什么来指导的指导。同样，您可以提供[`namedtuples`](http://docs.python.org/library/collections.html#collections.namedtuple)向量以在构建它们时提供指导。

还值得注意的是，[PEP-8](http://www.python.org/dev/peps/pep-0008/)建议`lowercase_with_underscores`使用函数名称，因此`Rotate_Vector()`这不是一个特别好的函数名称，除非您被项目中现有的约定所强制。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-06T23:29:01.547

我会避免检查用户发送的容器类型。正如其他回答者所指出的那样，这对您的代码施加了无用的限制，从而阻止了代码的可重用性。从接口的角度来考虑。只要参数符合接口，那么代码就应该对它们起作用并产生所需的结果。

但是，此逻辑不适用于您想要施加的两个特定约束。具体来说，您希望`axis`变量的条目位于`{1, 0, -1}`并且您希望方向变量位于`{1, -1}`.

这些是有效的约束。我会这样实现它们：

```
valid_axis_entries = set((1,0, -1))
valid_direction_values = set((1, -1))

def rotate_vector(vec, axis, direction):
    if not all(entry in valid_axis_entries for entry in axis):
        raise SomeErrorCondition

    if direction not in valid_direction_values:
        raise SomeOtherErrorCondition 
```

我遵循的一般规则是允许任何有意义的输入飞行，并允许任何`raise`没有意义的输入出现错误。任何序列都对向量有意义，但根据您的算法，没有任何序列值对您的旋转轴有意义，并且`itertools.islice`肯定不是方向的有效输入。检测你知道的条件会导致你的算法失败并提出有用的错误消息对于你的代码用户来说就像允许他们发送任何有意义的东西一样体贴。

另外，我支持将方向参数存储为大写命名变量的建议，并鼓励用户发送这些而不是依赖于魔术常量。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-06T22:58:03.880

如前所述，python 是鸭子类型的，因此您只需像往常一样做事，并期望用户处理引发的任何异常。

最好只对您的代码进行单元测试，确保所有内容都使用有效数字，这会增加您对某些工作的信心，并允许您更轻松地缩小可能的错误位置。

如果你真的想检查类型，你可以对对象的类型（例如`isinstance(direction, int)`）使用断言来进行调试，但这实际上只是“穷人的单元测试”。

使用 python 的原则（*请求宽恕，而不是许可*，并且*显式优于隐式*），我会做这样的事情：

```
import math

def rotate_vector(vector, axis, direction):
    try:
        x, y, z = vector
    except TypeError:
        raise TypeError("Invalid vector {0}".format(vector))

    valid_axes = {(1,0,0), (-1,0,0), (0,1,0), (0,-1,0), (0,0,1), (0,0,-1)}

    if not axis in valid_axes:
        raise ValueError("Invalid axis {0}".format(axis))

    try:
        ax, ay, az = axis
    except TypeError:
        raise TypeError("Invalid axis {0}".format(axis))

    # do math to rotate the vector
    # rotated = ...

    try:
        # You really only need the sign of the direction
        return math.copysign(rotated, direction)
        # or:
        return rotated * math.copysign(1, direction)
    except TypeError:
        raise TypeError("Invalid direction {0}".format(direction)) 
```

因为你真的只关心方向的标志，你可以使用它并消除任何错误检查。的特殊情况`0`将被视为`1`，您可能需要提出一个`ValueError`for 。

如果您实际上不需要 ax/ay/az 或 x/y/z，最好直接对`vector`and执行操作`axis`，并让底层操作引发异常。这将使它能够用于鸭子打字。

编辑：（更新`axes`->`axis`问题中的新值）

# android - 与语言无关的 Robotium 测试

> ID：10049597
> 
> 赞同：0
> 
> 时间：2012-04-06T21:43:02.637
> 
> 标签：android, testing, robotium

是否可以编写与语言无关的 Robotium 测试？例如，如果您使用 PreferenceActivity，根据定义，就无法获得对它的 R.id 引用。

是否有机制支持这一点？或者也许是 Robotium 从字符串文件中读取的一种方式？

谢谢你。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-06T22:40:10.483

您可以通过简单地访问当前活动从 Robotium 测试中读取被测应用程序的 strings.xml 文件：

```
String myString = getActivity().getString(R.string.my_string); 
```

# r - 用演员重塑几个变量

> ID：10049602
> 
> 赞同：9
> 
> 时间：2012-04-06T21:43:38.617
> 
> 标签：r, reshape

我有一个如下所示的 data.frame：

```
> head(ff.df)
  .id pio caremgmt prev price surveyNum
1   1   2        2    1     2         1
2   1   2        1    2     1         2
3   1   1        1    2     2         3
4   1   2        2    1     5         4
5   1   1        1    1     3         5
6   1   1        2    2     4         6 
```

我想通过 id 重塑所有四个非 id 变量。换句话说，我想要 colnames：

```
surveyNum pio1 pio2 pio3 caremgmt1 caremgmt2 caremgmt3 prev1 prev2 prev3 price1 price2 price3 
```

我可以为单个变量做到这一点：

```
> cast( ff.df, surveyNum~.id, value=c("pio"))
   surveyNum 1 2 3
1          1 2 2 2
2          2 2 1 2
3          3 1 2 1
4          4 2 1 1
5          5 1 2 2
6          6 1 2 1
7          7 1 1 2
8          8 2 2 1
9          9 1 1 2
10        10 1 1 1
11        11 2 2 1
12        12 1 2 2
13        13 1 1 1
14        14 2 1 1
15        15 1 2 1
16        16 2 1 2
17        17 1 2 2
18        18 2 1 2
19        19 1 2 2
20        20 2 2 2
21        21 2 1 1
22        22 1 2 1
23        23 2 1 1
24        24 2 1 2 
```

但是当我尝试了几次它就完全失败了：

```
> cast( ff.df, surveyNum~.id, value=c("pio","caremgmt","prev","price"))
Error in data.frame(data[, c(variables), drop = FALSE], result = data$value) : 
  arguments imply differing number of rows: 72, 0
In addition: Warning message:
In names(data) == value :
  longer object length is not a multiple of shorter object length 
```

有什么提示吗？我可以使用 base (stats)`reshape`命令，但我真的很想摆脱它，因为它会因拉头发而导致过多的手动头皮创伤......

```
ff.df <- structure(list(.id = c(1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 
1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 3L, 3L, 
3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 
3L, 3L, 3L, 3L, 3L, 3L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 
    2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L), pio = structure(c(2L, 
2L, 1L, 2L, 1L, 1L, 1L, 2L, 1L, 1L, 2L, 1L, 1L, 2L, 1L, 2L, 1L, 
2L, 1L, 2L, 2L, 1L, 2L, 2L, 2L, 2L, 1L, 1L, 2L, 1L, 2L, 1L, 2L, 
1L, 1L, 2L, 1L, 1L, 1L, 2L, 2L, 2L, 2L, 2L, 1L, 1L, 1L, 2L, 2L, 
1L, 2L, 1L, 2L, 2L, 1L, 2L, 1L, 1L, 2L, 2L, 1L, 1L, 2L, 1L, 2L, 
1L, 2L, 2L, 1L, 2L, 1L, 1L), .Label = c("1", "2"), class = "factor"), 
    caremgmt = structure(c(2L, 1L, 1L, 2L, 1L, 2L, 2L, 1L, 1L, 
    2L, 2L, 2L, 2L, 1L, 1L, 1L, 1L, 1L, 2L, 2L, 2L, 1L, 1L, 2L, 
    1L, 2L, 1L, 2L, 1L, 1L, 2L, 2L, 2L, 1L, 2L, 1L, 2L, 1L, 2L, 
    1L, 2L, 1L, 2L, 1L, 1L, 2L, 1L, 2L, 1L, 2L, 2L, 2L, 2L, 1L, 
    1L, 2L, 1L, 2L, 1L, 1L, 1L, 1L, 2L, 1L, 2L, 2L, 2L, 1L, 1L, 
    1L, 2L, 2L), .Label = c("1", "2"), class = "factor"), prev = structure(c(1L, 
    2L, 2L, 1L, 1L, 2L, 1L, 2L, 2L, 1L, 2L, 2L, 2L, 2L, 1L, 1L, 
    1L, 2L, 2L, 1L, 2L, 1L, 1L, 1L, 2L, 1L, 2L, 2L, 1L, 1L, 1L, 
    2L, 1L, 1L, 2L, 2L, 2L, 1L, 1L, 1L, 1L, 2L, 2L, 2L, 1L, 1L, 
    2L, 2L, 2L, 2L, 1L, 2L, 1L, 1L, 2L, 1L, 1L, 1L, 2L, 1L, 2L, 
    1L, 2L, 1L, 1L, 1L, 2L, 2L, 1L, 2L, 2L, 2L), .Label = c("1", 
    "2"), class = "factor"), price = structure(c(2L, 1L, 2L, 
    5L, 3L, 4L, 1L, 5L, 4L, 3L, 1L, 2L, 6L, 6L, 5L, 4L, 6L, 3L, 
    5L, 6L, 3L, 1L, 2L, 4L, 3L, 5L, 2L, 5L, 4L, 5L, 6L, 6L, 4L, 
    6L, 4L, 1L, 2L, 3L, 1L, 2L, 2L, 5L, 1L, 6L, 1L, 3L, 4L, 3L, 
    6L, 5L, 5L, 4L, 4L, 2L, 2L, 2L, 6L, 3L, 1L, 4L, 4L, 5L, 1L, 
    3L, 6L, 1L, 3L, 5L, 1L, 3L, 6L, 2L), .Label = c("1", "2", 
    "3", "4", "5", "6"), class = "factor"), surveyNum = c(1L, 
    2L, 3L, 4L, 5L, 6L, 7L, 8L, 9L, 10L, 11L, 12L, 13L, 14L, 
    15L, 16L, 17L, 18L, 19L, 20L, 21L, 22L, 23L, 24L, 1L, 2L, 
    3L, 4L, 5L, 6L, 7L, 8L, 9L, 10L, 11L, 12L, 13L, 14L, 15L, 
    16L, 17L, 18L, 19L, 20L, 21L, 22L, 23L, 24L, 1L, 2L, 3L, 
    4L, 5L, 6L, 7L, 8L, 9L, 10L, 11L, 12L, 13L, 14L, 15L, 16L, 
    17L, 18L, 19L, 20L, 21L, 22L, 23L, 24L)), .Names = c(".id", 
"pio", "caremgmt", "prev", "price", "surveyNum"), row.names = c(NA, 
-72L), class = "data.frame") 
```

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-04-06T21:57:50.380

我认为问题在于`ff.df`还没有充分融化。试试这个：

```
library(reshape)

# Melt it down
ff.melt <- melt(ff.df, id.var = c("surveyNum", ".id"))

# Note the new "variable" column, which will be combined
# with .id to make each column header
head(ff.melt)

  surveyNum .id variable value
1         1   1      pio     2
2         2   1      pio     2
3         3   1      pio     1
4         4   1      pio     2
5         5   1      pio     1
6         6   1      pio     1

# Cast it out - note that .id comes after variable in the formula;
# I think the only effect of that is that you get "pio_1" instead of "1_pio"
ff.cast <- cast(ff.melt, surveyNum ~ variable + .id)

head(ff.cast)

  surveyNum pio_1 pio_2 pio_3 caremgmt_1 caremgmt_2 caremgmt_3 prev_1 prev_2 prev_3 price_1 price_2 price_3
1         1     2     2     2          2          1          1      1      2      2       2       6       3
2         2     2     1     2          1          2          2      2      2      1       1       5       5
3         3     1     2     1          1          2          1      2      1      2       2       5       2
4         4     2     1     1          2          2          2      1      2      2       5       4       5
5         5     1     2     2          1          2          1      1      1      1       3       4       4
6         6     1     2     1          2          1          1      2      1      1       4       2       5 
```

这对你有用吗？

本质上，在转换时，转换公式右侧指示的变量决定了将出现在转换结果中的列。通过仅指示`.id`，我相信您要求`cast`以某种方式将所有这些值向量塞进三列 - 1、2 和 3。将数据一直向下融合创建`variable`列，它可以让您指定组合和向量应该定义cast数据框`.id`的`variable`列。

（对不起，如果我重复/迂腐！我也在努力为自己解决问题）

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-04-07T07:51:46.527

您可以使用 R 中的`reshape`函数执行此操作`base`。列排序有点奇怪，但可以轻松修复。

```
 reshape(ff.df, direction = 'wide', idvar = "surveyNum", timevar = '.id') 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2015-03-19T16:55:00.147

您可以使用ie`dcast`的开发版本执行此操作`data.table`[`v1.9.5`](https://github.com/Rdatatable/data.table/wiki/Installation)

```
 library(data.table)
  ff.cast <- dcast(setDT(ff.df), surveyNum~.id, 
        value.var=c('pio', 'caremgmt', 'prev', 'price'))
  head(ff.cast,3)
  #  surveyNum 1_pio 2_pio 3_pio 1_caremgmt 2_caremgmt 3_caremgmt 1_prev 2_prev
  #1:         1     2     2     2          2          1          1      1      2
  #2:         2     2     1     2          1          2          2      2      2
  #3:         3     1     2     1          1          2          1      2      1
  #   3_prev 1_price 2_price 3_price
  #1:      2       2       6       3
  #2:      1       1       5       5
  #3:      2       2       5       2 
```

# java - 有人知道用于图像的基本 Java 套接字上传脚本吗？

> ID：10049609
> 
> 赞同：-2
> 
> 时间：2012-04-06T21:44:49.490
> 
> 标签：java, image, sockets, upload

我非常接近完成一个宠物项目，这是我参加比赛之前需要的最后一部分，完全不需要帮助。我感到既兴奋又闷闷不乐，因为我与客户端交互的需要让我慢了好几个星期。

有没有办法上传图像而不将它们转发到脚本或将我的 ftp 详细信息放在我的课堂上？当我所在的主机不允许我将任何敏感文件保留在根目录之上时，最后一点对我来说简直是可怕的。那么直接客户端-> 服务器套接字连接可以完成我想要的工作吗？

哦，在向 jdk 添加任何内容时，我处于新手村，因此对于如何解决此问题的本地方法将是最有帮助的 ^_^ 谢谢。

* * *

我很混乱 ：'（

我需要一个傻瓜指南之类的东西，很多这些东西都会自动假设一个人对 Java 语言有丰富的理解。我不介意花时间从头开始学习，但我现在没有时间。我在一个 PHP 项目中遇到了麻烦，这使它加班并影响了我的个人生活。T_T

我如何找出最适合在 btw 上监听的端口？我可以在一个小程序的脚本中创建客户端/服务器功能吗？

有谁知道一个地方可以更好地向外行解释这一切？

即使是示例代码对我来说也像是教科书上的东西，而且它们通常不是很好的入门书。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-06T22:13:03.900

只需使用普通插座即可。然后您可以获取输出流并`ObjectOutputStream`从中生成。只需发送图像即可。

这是一个关于如何使用套接字和服务器套接字的官方教程：http: [//docs.oracle.com/javase/tutorial/networking/sockets/](http://docs.oracle.com/javase/tutorial/networking/sockets/)

# javascript - 使用 extend.js 有什么好处？

> ID：10049616
> 
> 赞同：2
> 
> 时间：2012-04-06T21:45:58.110
> 
> 标签：javascript, dependency-management

我刚刚熟悉了[*extend.js*](https://github.com/searls/extend.js)，并且想知道使用该库是否比使用原生 JavaScript 更有价值。让我演示一下；

使用*extend.js*，我会像这样声明一个命名空间：

```
extend('some.madeup.namespace',{
   foo : 'bar'
}); 
```

......而没有它，我只需要这样做：

```
var some = { madeup : { namespace : { foo : 'bar' } } }; 
```

我坚信 KISS 原则，我真的认为应该减少外部依赖，让事情变得更简单一些。所以，如果这个库所做的只是为我保存（一次性）赋值声明，我会考虑是否值得麻烦。

有什么我在这里想念的吗，这就是全部吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-06T22:14:17.860

我怀疑这个问题的明智答案很大程度上依赖于任何第三方工具的通用答案。

当第三方工具帮助他们更快、更优雅地完成工作时，人们会使用第三方工具，至少理论上是这样。但是有些人，包括我自己，发现减少依赖并从头开始实现更优雅。对我们来说，在我们的项目中加入糖几乎没有什么价值，因为这会贬低我们的原则。

对于其他人来说，它具有价值，因为它减少了他们必须编写的代码量，并且可能感觉更有条理。他们自己也会做同样的抽象，所以使用一个经过深思熟虑和测试的库是有意义的。

它在很大程度上取决于您的个人喜好和使用情况。诚然，我没有特别提到这个库的使用，它只有 51 行代码。阅读它提供的功能并得出自己的结论应该不会花很长时间。

据我所知，这个库只是创建命名空间层次结构并检查冲突的命名空间。大多数代码似乎都集中在创建层次结构和验证命名空间的独特性。这向我表明它被设计为在可能发生冲突的情况下的通用工具 - 比如说您正在发布自己的库以供大众消费。

但是，如果您需要我的意见，那将来自一个不会选择使用它的人。命名空间实际上是不必要的。如果您确实担心名称空间冲突，那么所有防止窗口上的多个名称空间冲突的努力听起来确实很有必要，但任何好的设计都不会。

# ios - 协议必须符合 NSObject 协议吗？

> ID：10049617
> 
> 赞同：20
> 
> 时间：2012-04-06T21:46:10.263
> 
> 标签：ios, objective-c, nsobject

NSObject 协议带有库存协议模板，但对于协议的实际实现来说，它似乎并不是所有必需的。离开它似乎完全没有改变。那么，协议是否真的有必要继承它，或者它只是一个不必要的附加组件？

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2012-04-06T23:54:22.520

多年来，我（以及许多像我一样的人）没有让我们的协议符合`<NSObject>`. 它工作正常。但这通常很烦人。`respondsToSelector:`最常见的烦恼是，如果不回滚就无法使用`NSObject*`（这会破坏协议的全部意义）。在 ObjC1 时代这并不重要，因为没有`@optional`，所以我们都不担心它（那时我们根本没有使用协议，因为没有`@optional`它们就没那么有用了）。然后 ObjC2 伴随着可选方法的精彩添加而出现，并突然变得`respondsToSelector:`重要。我们这些速度较慢的人花了一点时间，但最终我们开始发现，如果你让你的协议符合`<NSObject>`. 幸运的是，现在这已经进入了 Xcode，让每个人都可以更轻松地以更方便的方式做事。

但不，你不必这样做。在很多情况下都无所谓。但是没有太多理由不这样做，所以我推荐它。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-04-06T21:52:32.817

不必要。委托只是一个辅助对象——唯一的要求是委托类放在它上面的那些。如果你想正式化给定委托的要求，创建一个正式的协议，即使用`@protocol`指令声明一个协议。如果符合 NSObject 协议是这些要求之一，您可以让您的协议采用它：

```
@protocol MyDelegateProtocol <NSObject>
//...
@end 
```

也就是说，我看不出有任何理由创建一个不是从 NSObject 或可能是 NSProxy 派生的委托，而且这两个类已经符合 NSObject 协议。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-06T21:54:00.930

不是每个对象都必须子类化`NSObject`，所以我猜如果您期望这样的对象符合您的协议，它不一定必须符合 NSObject。

符合 NSObject 让编译器知道该对象符合基本要求 - 请查看[NSObject 协议参考](https://developer.apple.com/library/mac/#documentation/Cocoa/Reference/Foundation/Protocols/NSObject_Protocol/Reference/NSObject.html)。不用说我符合 NSObject 编译器怎么知道我符合这些？

`NSObject`定义为

```
@interface NSObject <NSObject> {
    Class   isa;
} 
```

而`id`定义为

```
typedef struct objc_object {
    Class isa;
} *id; 
```

所以对于`id`编译器不知道它符合`NSObject`

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2015-06-29T23:52:33.397

**推荐而不是强制。**

根据苹果官方文档**ProgrammingWithObjectiveC.pdf**

> 如果您尝试在`respondsToSelector:`符合上面定义的协议的 id 上调用该方法，您将收到一个编译器错误，即没有已知的实例方法。一旦你用协议限定了一个 id，全静态类型检查就会回来；如果您尝试调用未在指定协议中定义的任何方法，您将收到错误消息。避免编译器错误的一种方法是将自定义协议设置为采用 NSObject 协议。

*上面定义*的协议是不符合协议的`NSObject`协议。

> 例如，**最好将协议定义为符合 NSObject 协议**（一些 NSObject 行为从其类接口拆分为单独的协议；NSObject 类采用 NSObject 协议）。

# php - PHP/SQL 将 sql 结果分配给会话

> ID：10049619
> 
> 赞同：1
> 
> 时间：2012-04-06T21:46:24.060
> 
> 标签：php, mysql, sql

我正在尝试将查询结果中的值分配给会话，但它不起作用..

**下面的会话用户名** ，我正在注册用户电子邮件的会话用户名

```
$_SESSION['myusername'] = $myusername; 
```

**检查登录** 在这里我试图从同一个表中获取客户名称，如果电子邮件被存储并将其保存在“名称”会话中

```
$_SESSION['name'] = $row['name']; 
```

**在这里记录成功** 我正在尝试获取用户名

```
echo "Welcome ". $_SESSION['name']; 
```

**检查登录页面***

```
<?php
ob_start();
$host="localhost"; // Host name 
$username="xx"; // Mysql username 
$password="xx"; // Mysql password 
$db_name="xx"; // Database name 
$tbl_name="customer"; // Table name
$db_usercol="email"; // Field containing username
$db_passcol="password"; // Field containing password

// Connect to server and select databse.
mysql_connect("$host", "$username", "$password")or die("cannot connect"); 
mysql_select_db("$db_name")or die("cannot select DB");

// username and password sent from form 
$myusername=$_POST['myusername']; 
$mypassword=$_POST['mypassword'];

// To protect MySQL injection (more detail about MySQL injection)
$myusername = stripslashes($myusername);
$mypassword = stripslashes($mypassword);
$myusername = mysql_real_escape_string($myusername);
$mypassword = mysql_real_escape_string($mypassword);

$sql="SELECT * FROM $tbl_name WHERE $db_usercol='$myusername' and $db_passcol='$mypassword'";
$result=mysql_query($sql);

// Mysql_num_row is counting table row
$count=mysql_num_rows($result);
// If result matched $myusername and $mypassword, table row must be 1 row

if($count==1){
// Register $myusername, $mypassword and redirect to file "profile.php"
session_register("myusername");
session_register("mypassword");
$_SESSION['myusername'] = $myusername;
$_SESSION['name'] = $row['name']; 
header("location:profile.php");
}
else {
echo "Wrong Username or Password";
}
ob_end_flush();
?> 
```

**成功登录***

```
<?
// Check if session is not registered , redirect back to main page. 
// Put this code in first line of web page. 
session_start();
if(isset($_SESSION[$myusername])){
header("location:members.php");
}
else
include("header.php");
?>

<body id="profile">
<div id="wholewrap">
<div id="bodywrap">

<div id="content">
<h1>Your Profile</h1>

<?php

echo "Welcome ". $_SESSION['myusername'];
echo "Welcome ". $_SESSION['name'];
?>

</div>  <!-- content #end -->

<div id="sidebar">

Lorem Ipsum

</div>  <!-- sidebar #end -->

</div>  <!-- bodywrap #end -->
</div>  <!-- wholewrap #end -->

 <?php include("footer.php"); ?> 
```

**结果是**

我只得到用户名而不是用户名，这是同一个表中名为*name的字段*

![结果](../Images/fd1e810193bb980f31daf471c9320ce1.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-06T21:49:11.210

首先你必须有一个查询，像这样

```
$query = mysql_query("SELECT `name` FROM `users` WHERE `email`='".$_POST['email']."'") or die(mysql_error()); // of course you want to clear the strings and validate them 
```

然后你做

```
if(mysql_num_rows($query) > 0)
{
   $row = mysql_fetch_assoc($query);

   $_SESSION['name'] = $row['name'];
} 
```

# jquery - jQuery 追加只发生一次

> ID：10049623
> 
> 赞同：1
> 
> 时间：2012-04-06T21:46:47.420
> 
> 标签：jquery, append

我的意图是`<input>`每次只剩下一个空白时创建一个新字段 - 所以当最上面的一个失去焦点时。这种情况会发生，但只会发生一次（因此只能制作三个`<input>`字段。

我的工作示例位于[http://sas98.user.srcf.net/guestlist/](http://sas98.user.srcf.net/guestlist/)编号 4 下。

代码是：

```
<div id="names">
<p><input class="input" type="text" name="name1" /></p>
<p><input class="input" type="text" name="name2" /></p>
</div>

<script type="text/javascript">
$(document).ready(function() {
var name = $("<p><input class='input' type='text' /></p>");
    $('.input').blur(function() {
        if($(this).val().length>0) {
            $('#names').append(name.clone());
        }
    });
});
</script> 
```

编辑：

```
 $('#names').append(name); 
```

变成

```
 $('#names').append(name.clone()); 
```

让它在卡住之前再工作几次。这似乎是喜怒无常的——我看不出它有什么规律。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-06T22:00:01.613

问题是事件处理程序没有更新。对于 Jquery < 1.7 使用 $.live() 绑定模糊，在较新版本上使用 $.on()

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-06T22:08:25.617

这就像你想要的那样工作：http: [//jsfiddle.net/YFJA6/](http://jsfiddle.net/YFJA6/)

```
$('#names').on({
blur: function() {
    if($(this).val().length>0) {
        $('#names').append('<p><input class="input" type="text" /></p>');
    }
}
}, 'input'); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-06T21:52:49.487

这是因为您只添加了一次 .blur() 处理程序（在创建新输入之前），因此还需要为最新输入分配一个用于模糊事件的处理程序。

出于兴趣，请尝试：

```
<div id="names">
<p><input class="input" type="text" name="name1" /></p>
<p><input class="input" type="text" name="name2" /></p>
</div>

<script type="text/javascript">
$(document).ready(function() {    
    $('.input').blur(addBlur());
});
function addBlur() {
        var name = $("<p><input class='input' type='text' /></p>");
        if($(this).val().length>0) {
            var newBox = name.clone();
            newBox.blur(addBlur());
            $('#names').append(name.clone());
        }
    }
</script> 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2016-02-08T21:40:36.763

这对我有用：

`$('#selector').append(htmlcontent.clone(true));`

# xslt - 如何使用 DocBook/Oxygen 设置 epub 目录样式

> ID：10049625
> 
> 赞同：1
> 
> 时间：2012-04-06T21:46:54.350
> 
> 标签：xslt, epub, docbook

我正在使用 DocBook5 和 Oxygen 13.1 使用 ANT 将 DocBook5 xml 文件转换为 ePub。

效果很好，一般。

但我正在尝试弄清楚如何设置电子书目录的样式，以便章节标题和章节编号不都带有下划线。

我认为应该有一种方法可以在我的自定义 xsl 中添加一个条目，它会说“没有下划线”或“只在章节标题下划线，而不是编号”。但我一直无法弄清楚如何。

有人知道这样做的方法吗？或者对我可能看的地方有什么想法？

提前致谢。

直流丹尼森

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-30T16:29:48.043

Epub 文件只是 zip 文件。如果你解压它，你会发现你所拥有的基本上是一个`xhtml`带有 CSS 的文件。更改文档的样式是使用 CSS 完成的。

当然，解压 epub 文件来更改 CSS 是没有意义的。您将使用外部 CSS，然后将其添加到您的自定义层：

```
<xsl:param name="html.stylesheet" select="'myAwesomeStylesheet.css'"/> 
```

在您的 CSS 中，您可以像设置 xhtml 输出一样设置样式，例如。

```
a { text-decoration: none; } 
```

（我不知道 CSS 类 [eg `div.toc`] 是否也在 epub 存档的 xhtml 输出中。如果是这样，您将对外观有更多的控制权。）

# javascript - 使用 JavaScript + jQuery 函数检查表行冗余时性能下降

> ID：10049626
> 
> 赞同：1
> 
> 时间：2012-04-06T21:47:02.983
> 
> 标签：javascript, jquery, html-table, matching, redundancy

我使用 js+jQuery 编写了函数。

这是一个 jsFiddle 的链接，它显示了我的问题：http: [//jsfiddle.net/anarnold/LpBaW/](http://jsfiddle.net/anarnold/LpBaW/)

 `此函数的目标是扫描表并检查具有某些字段 (td) 值匹配的行。然后为行分配一个类，表示它们是否是唯一的，并且匹配的行数被打印到每行的最终字段（td）中。

它基本上使用这种结构的嵌套循环：

对于每一行...扫描整个表以查找匹配项..

我识别行的方法是将每一行的字段 (td) 文本连接到每一行的最后一个字段 (td) 上的 rowid 属性。

当前的功能运行良好，但是对于大约 2000 行的大型表，它会变得非常慢。

必须有一种更高效、更优雅的方式来实现这一点。任何帮助将不胜感激！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-06T22:09:12.247

这是使用关联数组存储结果然后对其进行迭代的示例：

[http://jsfiddle.net/AdDMk/](http://jsfiddle.net/AdDMk/)

```
var rowIdCnt = {};

function unqOrMsgTest() {
    // Store counts here
    var rowIdCnt = {};

    // loop through check tds
    $("#binning tr td[col=check]").each(function() {

        // grab row identifer to check against other rows        
        var rowId = $(this).attr("rowid");

        if (rowId in rowIdCnt) {
            rowIdCnt[rowId] ++;
        } else {
            rowIdCnt[rowId] = 1;
        }

    });

    // Now iterate over each count and update the table appropriately:
    $.each(rowIdCnt, function(rowId, cnt) {
        //this bit of logic picks a class to assign rows        
        var resultClass = "notUnique";
        if (cnt < 2) {
            resultClass = "unique";
        }

        //apply the row class and print the redundancy number into td
        $('#binning tr td[rowid='+rowId+']').text(cnt).parent().addClass(resultClass);

    });

} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-06T22:14:02.383

这是一种更好的预成型方法。我已经尽可能多地删除了多余的 DOM 调用，并更正了无效属性（HTML 标签只能支持某些属性.. 自定义属性需要以 为前缀`data-`）

```
$(document).ready(function(){ //this is just to fire the function
    $("#unqOrMsgTestFire").click(function(){
        unqOrMsgTest();
    });
});

function check_unique(row, collection) {
    var unique = true, rowid = $(row).children('td[data-col=check]')[0].getAttribute('data-rowid');
    collection.each(function() {
        if( $(this).children('td[data-col=check]')[0].getAttribute('data-rowid') == rowid ) {
            unique = false; 
        }
    });
    return unique;
}

function unqOrMsgTest() { 

    var collection = $("#binning tbody").children('tr');

    collection.each(function(i, el){
        el.className += check_unique( el, collection.not(el) ) ? ' unique' : 'notUnique';
    });            

}​ 
```

[http://jsfiddle.net/rlemon/LpBaW/41/](http://jsfiddle.net/rlemon/LpBaW/41/) <- 他们都失败了，但这是意料之中的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-06T21:49:37.940

为每个表条目创建哈希值并使用哈希表或在检查重复之前对其进行排序，因此您只需要比较邻居。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-06T21:53:29.557

更优雅的方法是在构建此表之前在数据级别执行此操作。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-04-06T22:33:23.827

这是我推荐的解决方案：

[http://jsfiddle.net/j9RXR/29/](http://jsfiddle.net/j9RXR/29/)

```
function unqOrMsgTest() { 
    var rows = $("#binning tbody").children('tr');
    var totalRows = rows.length;
    var idLookup = {};
    var i, rowId, resultClass, checkColumn, rowCount, row;

    // loops through all rows, convert to jQuery objects and track the IDs
    for (i = 0; i < totalRows; i++)
    {
        row = $(rows[i]);
        rowId = row.children('td[col="check"]').attr("rowid");
        rows[i] = row;

        idLookup[rowId] = (rowId in idLookup) ? idLookup[rowId] + 1 : 1;
    }

    // loop through each row and check them for redundancy
    for (var i = 0; i < totalRows; i++ )
    {
        // grab row identifer to check against the id lookup
        row = rows[i];
        checkColumn = row.children('td[col="check"]');
        rowId = checkColumn.attr("rowid");     

        //this bit of logic picks a class to assign rows        
        rowCount = idLookup[rowId];
        resultClass = rowCount < 2 ? "unique" : "notUnique";

        //apply the row class and print the redundancy number into td
        checkColumn.text(rowCount);
        row.attr("class", resultClass);        
    };            
}​ 
```

与上述建议使用关联数组（或哈希）来存储 id 和计数的答案类似，我还删除了所有对`list.each( function() {...} )`dom 元素到 jQuery 对象的调用并最小化了转换次数。

我删除使用的原因`each`是因为每次迭代都会创建一个新的匿名函数，还调用了从 this 到 $(this) 的冗余转换，更不用说堆栈抖动了。只需说一个简单的 for 循环就足够了，而且速度更快。

有关 jQuery 陷阱的更多信息，请查看[要避免的 jQuery 陷阱](https://stackoverflow.com/questions/1229259/jquery-pitfalls-to-avoid)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-04-06T23:02:39.647

[http://jsfiddle.net/LpBaW/57/](http://jsfiddle.net/LpBaW/57/)

```
$(function(){ //this is just to fire the function
    $("#unqOrMsgTestFire").click(unqOrMsgTest);
    $("#spawn").click(function(){
        var blueprint = $("#binning tbody tr").first();
        for(var i = 0; i < 1000; i++)
            blueprint.clone().appendTo("#binning tbody").find('td[rowid]').attr('rowid', Math.floor(Math.random()*500));
    });
});

function unqOrMsgTest() {
    console.profile();
    var toCheck = $("#binning > tbody > tr > td[col=check]"),
        ignore = {},
        curId,
        currentlyProcessing,
        rowsAmount,
        i;

    i = toCheck.length - 1;
    while( i >= 0 ) {
        curId = toCheck.eq(i).attr("rowid");
        if( !(curId in ignore) ) {
            ignore[curId] = undefined;

            currentlyProcessing = $("#binning > tbody > tr > td[rowid=" + curId  + "]");

            rowsAmount = currentlyProcessing.length;

            currentlyProcessing
                .text( rowsAmount )
                .parent().attr('class', rowsAmount > 1 ? "notUnique" : "unique");
        }
        i--;
    }
    console.profileEnd();
}​

        rowsAmount = currentlyProcessing.length;

        currentlyProcessing
            .text( rowsAmount )
            .parent().attr('class', rowsAmount > 1 ? "notUnique" : "unique");

        toCheck = toCheck.not( currentlyProcessing );
    }
} 
````

# ruby - 使用 ruby zip 保存 zip 注释

> ID：10049627
> 
> 赞同：1
> 
> 时间：2012-04-06T21:47:08.187
> 
> 标签：ruby, zip

尝试使用 ruby​​zip 将注释添加到我根本不会修改的 zip 文件中。

```
zf = Zip::ZipFile.open 'Archive.zip'
zf.comment = "blah blah blah" 
```

我试过了`zf.close`，`zf.commit`但没有运气。我正在阅读文档，但似乎找不到解决方案。

以前有人做过吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-06T22:06:40.657

我使用以下代码成功尝试了它：

```
require 'zip/zipfilesystem'

zf = Zip::ZipFile.open 'Archive.zip', 'w'
zf.comment = "blah blah blah"

zf.get_output_stream("first.txt") { |f| f.puts "Hello from ZipFile" }
zf.close 
```

我添加了至少一个文档来创建 zip 文件。没有内容，就没有 zip 文件（仅评论似乎不是*内容*）。

您不创建 zip，而是要修改 zip 文件。

这也有效，但它也改变了 zip 文件：

```
require 'zip/zipfilesystem'

zf = Zip::ZipFile.open 'Archive.zip'
zf.comment = "CHANGED COMMENT"
zf.get_output_stream("second.txt") { |f| f.puts "Hello from ZipFile" }

zf.close 
```

基于此，您可以执行以下操作：

```
require 'zip/zipfilesystem'

zf = Zip::ZipFile.open 'Archive.zip'
zf.comment = "CHANGED COMMENT"
zf.get_output_stream("second.txt") { |f| f.puts "Hello from ZipFile" }
zf.commit #write the data and change the commen
zf.remove("second.txt")  #remove the data again - the comment changed

zf.close 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-07T23:15:04.243

升级到 RubyZip 0.9.7（今天发布），修复了这个错误。

# javascript - 如何更改 iPhone 移动网络的点击（点击）div 类

> ID：10049631
> 
> 赞同：0
> 
> 时间：2012-04-06T21:48:15.173
> 
> 标签：javascript, iphone, css, html

我有 4 个按钮，构建为 div。这些 div 控制同一页面上其他 div 的显示/隐藏状态。div 当前包含每个 div（按钮）内的复制点。一旦用户选择了一个 div（按钮），每个 div 的背景颜色都需要更改为“选定状态”。这也可以称为“活动/非活动”状态。我希望用户通过更改背景颜色以及每个 div 中的文本颜色来知道他们选择了哪个 div（按钮）。

我想用 CSS、Javascript 或你们可能有的任何其他建议来完成这个。我目前在我的 CSS 中为 div(buttons) 使用渐变背景。

我在网站上查看过，但找不到使用 4 个选项卡、按钮、div 完成的操作。只有两个。这是我的第一篇文章，所以如果我不清楚，我很抱歉。提前致谢

这是我的 div（按钮）HTML：

```
<div id="row1">
    <a id="buttonToggle1" href="#" ><div class="width145 paddingFloaterCell floatlft productSelectedBtn btnBorderBtm"><span class="bby_blue"><strong>Product Name</strong></span><br><span class="red_text"><strong>$100</strong></span></div></a><a id="buttonToggle2" href="#" ><div class="btnBorderLft width146 paddingFloaterCell floatrt productNotSelectedBtn"><span class="textWhite"><strong>Product Name</strong></span><br><span class="textYellow"><strong>$100</strong></span></div></a>
</div>

<div id="row2">
    <a id="buttonToggle3" href="#" ><div class="width145 paddingFloaterCell floatlft productNotSelectedBtn"><span class="textWhite"><strong>Product Name</strong></span><br><span class="textYellow"><strong>Sale: $100</strong></span></div></a><a id="buttonToggle4" href="javascript:showonlyone('productSelected4');" ><div class=" btnBorderLft width146 paddingFloaterCell floatrt productNotSelectedBtn"><span class="textWhite"><strong>Product Name</strong></span><br><span class="textYellow"><strong>Sale: $100</strong></span></div></a>
</div> 
```

" 一些 CSS：

```
.productNotSelectedBtn{
background-image: linear-gradient(bottom, rgb(0,57,98) 20%, rgb(42,91,126) 60%);
background-image: -o-linear-gradient(bottom, rgb(0,57,98) 20%, rgb(42,91,126) 60%);
background-image: -moz-linear-gradient(bottom, rgb(0,57,98) 20%, rgb(42,91,126) 60%);
background-image: -webkit-linear-gradient(bottom, rgb(0,57,98) 20%, rgb(42,91,126) 60%);
background-image: -ms-linear-gradient(bottom, rgb(0,57,98) 20%, rgb(42,91,126) 60%);

background-image: -webkit-gradient(
linear,
left bottom,
left top,
color-stop(0.2, rgb(0,57,98)),
color-stop(0.6, rgb(42,91,126)));}
.productSelectedBtn{
background-image: linear-gradient(bottom, rgb(231,231,231) 42%, rgb(254,254,254) 71%);
background-image: -o-linear-gradient(bottom, rgb(231,231,231) 42%, rgb(254,254,254) 71%);
background-image: -moz-linear-gradient(bottom, rgb(231,231,231) 42%, rgb(254,254,254) 71%);
background-image: -webkit-linear-gradient(bottom, rgb(231,231,231) 42%, rgb(254,254,254) 71%);
background-image: -ms-linear-gradient(bottom, rgb(231,231,231) 42%, rgb(254,254,254) 71%);

background-image: -webkit-gradient(
linear,
left bottom,
left top,
color-stop(0.42, rgb(231,231,231)),
color-stop(0.71, rgb(254,254,254)));
-moz-box-shadow:    inset 0 0 5px #000000;
-webkit-box-shadow: inset 0 0 5px #000000;
box-shadow:         inset 0 0 5px #000000;} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-06T22:57:08.667

这对于 jQuery 来说是微不足道的：

```
jQuery('#row1 a, #row2 a').click(function(){
    jQuery(this).find('div').toggleClass('productNotSelectedBtn productSelectedBtn');
}); 
```

你基本上只是为每个 div 交换 css 类，你切换`productNotSelectedBtn`和`productSelectedBtn`

​在 jsfiddle 上试用：http: [//jsfiddle.net/ArtBIT/vHyHz/2/](http://jsfiddle.net/ArtBIT/vHyHz/2/)

# php - getter 方法的包装器

> ID：10049634
> 
> 赞同：1
> 
> 时间：2012-04-06T21:48:45.207
> 
> 标签：php, class

如果我有类似的方法

```
function getVar1(){
  return $this->var1;
}

function getVar2(){
  return $this->var2;
} 
```

等等...

并且这些变量是要打印在屏幕上的，创建直接打印它们的其他方法是个好主意吗？

喜欢

```
 function Var1(){
     echo $this->getVar1();
   }

   function Var2(){
     echo $this->getVar2();
   } 
```

或者我应该坚持在需要它们的地方调用 echo getVar1() 吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-06T21:50:30.373

用于`echo getVar1();`此目的。为此创建函数不仅是浪费时间，而且还是一种用无用的东西弄乱代码的好方法。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-06T21:55:25.170

函数应该做他们名字所暗示的事情。这是核心设计原则之一。当你说`getVar()`时，它会做它应该做的事情：返回一个变量。

在您的示例中，您甚至没有指定该函数的作用。如果你想要一个打印一些东西的函数，然后调用它`printVar1()`或类似的东西。

另一方面，我不得不同意ThiefMaster。您可以只使用 echo`getVar1()`而不是创建更大的类。尤其是在 PHP 这样的解释型语言中（类比编译型语言增加了更多的开销）。

# ios - 我怎么知道哪个 ViewController 当前处于活动状态

> ID：10049635
> 
> 赞同：0
> 
> 时间：2012-04-06T21:48:46.827
> 
> 标签：ios

我想知道当前哪个 ViewController 是活动的。换句话说，显示给用户的那个？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-06T21:56:23.113

请更准确地表达你的问题。据我了解您想要做的，例如，您可以使用通知[（通知教程）](http://www.theappcodeblog.com/2011/05/16/nsnotificationcenter-tutorial-using-the-notification-center-in-your-iphone-app/)并将当前视图控制器的名称/类型/对象广播到您的应用程序，每当创建和激活新控制器时。

请查看这个类似的问题，它也有很好的答案：[我如何知道哪个 ViewController 处于活动状态？](https://stackoverflow.com/questions/8480867/how-can-i-know-which-viewcontroller-is-active)

# objective-c - 编辑 100 个 ImageViews - Objective C iOS

> ID：10049639
> 
> 赞同：0
> 
> 时间：2012-04-06T21:49:01.430
> 
> 标签：objective-c, ios, cocoa-touch, uiimageview

目前在我的 iPhone 应用程序中，我有大约 200 个图像视图，我需要专门在我的代码中编辑几乎所有这些视图。我真的必须为每一个图像视图创建出口，还是有一种更简单（更快）的方法可以在我的代码中单独引用和编辑每个图像视图？

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-06T22:01:28.490

使用 an`IBOutletCollection`然后您可以将它们视为数组

```
@property (nonatomic, strong) IBOutletCollection(UIImageView) NSArray *imageViews; 
```

您仍然必须在笔尖中进行所有连接，但您只有一个属性

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-06T21:55:08.540

你可以：

*   给他们随后的标签并循环使用`viewWithTag:`他们的超级视图

*   遍历所有父视图的子视图并检查`[obj isKindOfClass:[UIImageView class]]`所选子视图是否为 UIImageView

这两个是第一个想到的。

# c++ - 在 Visual Studio 2010 上将静态库链接到我的项目

> ID：10049640
> 
> 赞同：6
> 
> 时间：2012-04-06T21:49:06.647
> 
> 标签：c++, visual-studio-2010

我想使用 oscpack ( [http://code.google.com/p/oscpack/](http://code.google.com/p/oscpack/) ) 作为我的项目的静态库，但是当我尝试将它添加到示例中时，出现链接错误，例如：

> 1>oscpackd.lib(UdpSocket.obj) : 错误 LNK2019: 函数“public: __thiscall UdpSocket::Implementation::Implementation(void)”中引用的无法解析的外部符号 __imp__socket@12 (??0Implementation@UdpSocket@@QAE@XZ)
> 
> 1>oscpackd.lib(UdpSocket.obj) : 错误 LNK2019: 函数“public: __thiscall UdpSocket::Implementation::~Implementation(void)”中引用的未解析外部符号 __imp__closesocket@4 (??1Imp​​lementation@UdpSocket@@QAE@XZ )
> 
> ...

基本上，我创建了一个用于构建 oscpack.lib 的解决方案，在项目中我添加了相应的 .h 和 .cpp 文件。

然后在示例解决方案中，我添加了 main.cpp，然后包含（属性>C/C++>其他包含目录）oscpack 库的文件夹，然后在链接器选项卡上添加了库的文件夹位置和名称的库。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-04-06T22:04:38.157

在解决方案资源管理器窗口中右键单击您的项目，然后单击属性 > 链接器 > 输入 > 附加依赖项设置。您必须添加 ws2_32.lib。

VS 项目模板负责告诉链接器链接最常见的 Windows 库。像 kernel32.lib 一样，没有它就无法编写 Windows 程序。但不是winsock，不是每个程序都想创建一个套接字。必须明确添加。

您可以从有关 closesocket() 的 MSDN 文章中找到这些依赖项。它在文章的底部。**Header**位告诉您#include 需要什么，您说得对。库**位**告诉您需要告诉链接器进行链接的内容。不是自动的，你必须自己处理。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-06T22:08:55.720

已经有正确的答案 - 您需要指定要链接的 winsock 库。但对于小型项目，这是我最喜欢这样做的方式： `#pragma comment(lib, "ws2_32.lib")` 只需将其放入您的 main.cpp 中（注意：特定于 MSVC）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-06T22:00:39.697

您是说将库和 main.cpp 放入单独的解决方案中吗？尝试将它们放入同一个解决方案中，并适当地设置项目引用。

此外，请确保您对正确的构建配置进行了更改。IE。如果您在 Debug 模式下构建，请确保已将 lib 名称和头目录添加到 Debug 配置中。

# iphone - 如何使用新数据重新加载或刷新选项卡栏控制器的选项卡栏中的数据？

> ID：10049644
> 
> 赞同：2
> 
> 时间：2012-04-06T21:49:27.110
> 
> 标签：iphone, ios, xcode, uitabbarcontroller, navigationcontroller

我有 3 个带有标签栏控制器的标签。标签栏中的所有 3 个视图控制器都有导航控制器，可以自行转到其他视图控制器。

标签栏中的视图控制器之一是带有地图和地图注释（地图视图控制器）。这些注释来自基于应用程序启动时的当前位置的 Web 服务。在地图视图控制器中，顶部有一个导航栏项（搜索按钮），使您可以在地图上搜索不同的位置。单击搜索按钮后，搜索视图控制器将被推送到导航堆栈。搜索完成并找到新位置后，新位置将显示在同一搜索视图控制器的表视图中。

我的目标是在单击表格视图项后自动返回地图视图，并根据新搜索的位置在地图上加载新的注释数据。再次显示地图视图后，应用程序首次启动时检索的旧数据应替换为从 Web 获取的新数据。标签栏中的所有 3 个视图控制器通过单例对象共享注释数据。

我的问题是，当用户单击搜索视图控制器中的**didSelectRowAtIndexPath**方法中的项目时，我应该怎么做才能使用新数据返回地图视图？返回选项卡栏中的地图视图并从 Web 服务再次加载数据的最佳方法是什么？

我是否在搜索视图控制器中使用“ **popViewControllerAnimated** ”，然后在地图视图控制器“ **viewWillAppear** ”方法中工作？如何将新位置的纬度和经度值从搜索视图控制器传递给地图视图控制器？我是否将地图视图控制器导入到搜索视图控制器中，并将地图视图控制器的 ivar 设置为纬度和经度，即使“搜索视图控制器”是由“地图视图控制器”推动而产生的？由于地图视图控制器已经在内存中，将地图视图控制器导入搜索视图控制器有什么复杂性？

我想要完成的事情类似于免费应用程序“Wikihood”在搜索地图时所做的事情。

非常感谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-06T22:05:08.607

看来您可以使用单例对象作为数据模型。这样，`viewWillAppear:`只显示当前在数据模型中设置的任何位置，并且您的搜索控制器有一个方便的位置来放置其结果。

想到的其他选项是委托或通知，但由于您已经拥有模型对象，因此继续使用它是一致的。

# c# - C# 中的并行分区算法：如何最大化并行性

> ID：10049645
> 
> 赞同：3
> 
> 时间：2012-04-06T21:49:37.577
> 
> 标签：c#, parallel-processing, plinq, data-partitioning

我在 C# 中编写了一个并行算法，将一个数组划分为两个列表，一个包含满足给定谓词的元素，另一个列表包含不满足谓词的元素。它是一种保序算法。

我写了如下，但我想知道如何最大化从硬件并发中获利的机会。

```
 static void TestPLinqPartition(int cnt = 1000000)
    {
        Console.WriteLine("PLINQ Partition");
        var a = RandomSequenceOfValuesLessThan100(cnt).ToArray();
        var sw = new Stopwatch();
        sw.Start();
        var ap = a.AsParallel();
        List<int> partA = null;
        List<int> partB = null;
        Action actionA = () => { partA = (from x in ap where x < 25 select x).ToList(); };
        Action actionB = () => { partB = (from x in ap where !(x < 25) select x).ToList(); };
        Parallel.Invoke(actionA, actionB);
        sw.Stop();

        Console.WriteLine("Partion sizes = {0} and {1}", partA.Count, partB.Count);
        Console.WriteLine("Time elapsed = {0} msec", sw.ElapsedMilliseconds);
    } 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-06T21:55:43.813

如果您的列表很长，您将不会从中获得太多的并行性（2x）。相反，我建议使用 Parallel.For 并使用线程本地`Tuple<List<int>, List<int>>`作为并行循环状态。Parallel.For API 让您可以轻松做到这一点。您可以在最后合并各个子列表。

这个版本是令人尴尬的并行，并且由于没有同步，在 CPU 总线上几乎没有一致性流量。

编辑：我想强调的是，您不能只使用所有线程共享的两个 List，因为这会导致疯狂的同步开销。您需要使用线程本地列表。甚至 ConcurrentQueue 都不适合这种情况，因为它使用互锁操作，这会导致 CPU 一致性流量受到限制。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-06T23:23:04.100

我会将数据划分为小段（例如，使用[Partitioner](http://msdn.microsoft.com/en-us/library/system.collections.concurrent.partitioner.aspx)类），并根据每个分区的位置为每个分区分配一个索引。对于每个编号的分区，我将创建一个[任务](http://msdn.microsoft.com/en-us/library/system.threading.tasks.task.aspx)，将分区分成两组，一组与谓词匹配，另一组不匹配，并返回两组，以及它们源自的分区的索引，作为任务的返回值。然后我会等待所有任务完成，然后`.Concat()`（以防止浪费时间实际合并所有数据）根据索引匹配组，对于非匹配组也是如此。您应该能够以这种方式实现任意程度的并行性，同时保留相对项目顺序。

# ckeditor - JspellCheck 错误

> ID：10049647
> 
> 赞同：0
> 
> 时间：2012-04-06T21:50:07.653
> 
> 标签：ckeditor

*错误：JSpell 已经附加，或者在调用 jspellCheck 之前没有调用 jspellInit。*有人知道解决方案吗？当我与 Ckeditor 集成时，我得到了这个

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-06T21:55:24.640

将以下两行 JavaScript 代码复制到需要使用 JSpell Evolution 的每个页面上。请注意，将这些行放在 HTML 文档的 HEAD 部分是标准做法。您可能需要根据您的环境修改 JavaScript 文件的 URL（请注意，这些 JavaScript 文件*必须*与您的网页位于同一服务器和端口上，否则拼写检查器将无法正常工作）。

```
<script TYPE="text/javascript" SRC="/jspellEvolution/jspellSettings.js" CHARSET="ISO-8859-1"></script> 
<script TYPE="text/javascript" SRC="/jspellEvolution/jspellEvolution.js" CHARSET="ISO-8859-1"></script> 
```

[http://www.jspell.com/wiki/index.php/JSpell_Evolution#Adding_JSpell_to_Your_Web_Page](http://www.jspell.com/wiki/index.php/JSpell_Evolution#Adding_JSpell_to_Your_Web_Page)

# .net - .NET MVC 3 C# 访问单个列表 物品

> ID：10049651
> 
> 赞同：2
> 
> 时间：2012-04-06T21:50:35.100
> 
> 标签：.net, asp.net-mvc-3, linq-to-entities

我希望我正确地命名了这个问题，并且我可以正确解释我的意思。我有一个从数据库填充的 ViewModel 的列表<>，在我的控制器中，我试图通过项目的属性值之一访问该列表的特定单个项目并更改另一个属性值。

例如，我的模型可能有几个属性：

```
 public int Id { get; set; }
    public bool IsChanged { get; set; } 
```

我想通过'Id'访问它并像这样更改'IsChanged'属性（我在我不确定的部分周围使用#'s）

```
 list.#(select item in the list by it's Id)#.IsChanged = true; 
```

我希望这是有道理的，即使您可能有一个很好的教程链接，谢谢:-)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-06T22:04:35.793

如果我理解正确，如果没有匹配项， using`Single`会导致 null 错误，我宁愿使用`SingleOrDefault`如果没有匹配项会返回 null 的 a ......这可能是一种安全的方法：

```
if(list != null)
{
  var item = list.SingleOrDefault(x => x.Id == 1);
  if(item !=null)
  {
    item.IsChanged = true;
  }
  else
  {
   // code to handle this case
  }
}
else
{
  // code to handle this case
} 
```

这是迄今为止我读过的关于 LINQ 的最好的书... [LINQ to Objects Using C# 4.0](https://rads.stackoverflow.com/amzn/click/com/0321637003)

干杯...

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-06T21:52:21.180

```
list.Single(x => x.Id == 123).IsChanged = true; 
```

Single() 方法期望只有一个满足查询的项目，因此您需要确保您的 Id 是唯一的。

如果**没有项目**满足查询，`ArgumentNullException`则会抛出 an。如果**有多个项目**满足查询，`InvalidOperationException`则会抛出 an。

如果您尝试访问的属性是引用类型，您可能需要额外检查以确保它已被实例化。

# php - 使用 CakeSocket 建立 TCP 连接

> ID：10049656
> 
> 赞同：0
> 
> 时间：2012-04-06T21:51:03.100
> 
> 标签：php, sockets, cakephp, tcp

请在这里保持温和，我今天早上才开始使用 CakePHP（或任何框架）。在浏览了 Cake 关于建立博客的简短教程之后，我爱上了它，并想将它应用到我目前正在从事的另一个项目中，我只需要一点帮助。我需要通过 TCP 连接建立并写入套接字。在过去的一个小时里，我一直在玩 CakeSocket，并且取得了大约 0 的进展。我一直在阅读[CakeSocket](http://api13.cakephp.org/class/cake-socket#method-CakeSocketconnect)，但老实说，甚至无法弄清楚如何包含这个东西。（关于 cake apis 如何解释这一点的任何指导也将有所帮助，因为我想利用我将来可以使用的所有资源 - 并且我确信我已经做了一个巨大的疏忽。无论如何 - 这是什么我到目前为止（这是控制器）。任何建议、示例或链接都会非常有帮助。谢谢！

```
<?php
class ConnectionController extends AppController {
public function index() {
    $socket = new CakeSocket();
    // For the purpose of this post I have changed the host and port.
    // I am using a static IP as the host.
    $socket->_construct(array(
        'persistent'    => false,
        'host'          => 'localhost',
        'protocol'      => 'tcp',
        'port'          => 80,
        'timeout'       => 30
    ));
    if ($socket->connect()) {
        setFlash('Connected');
    } else {
        setFlash('Not Connected.');
    }
}
}
?> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-10T20:24:00.670

```
App::uses('CakeSocket','Network');
$socket = new CakeSocket( array('host'=>$ip,'port'=>$port));
if($socket->connect()) {
  $socket->write($data);
  $socket->disconnect();
  return true;
}
return false; 
```

# varnish - 如何将第二个缓存清漆到特定 IP

> ID：10049658
> 
> 赞同：3
> 
> 时间：2012-04-06T21:51:16.200
> 
> 标签：varnish

我有一个竞争对手窃取了我们的内容，由于一些调查，我在我们的日志中找到了他们的 IP 地址。有谁知道我如何使用 Varnish 从第二个陈旧的缓存中为他们提供我们的网站？我希望他们获得该网站，但只是获得旧内容。

我什至不确定这是否可行，但这是我使用 Varnish 3 崇敬页面想出的。我会在这里解决问题吗？

```
backend longcache {
  .host = "127.0.0.1";
  .port = "8080";
  .connect_timeout = 6s;
  .first_byte_timeout = 3s;
  .between_bytes_timeout = 3s;
}

acl longcachegroup {
  "255.255.255.255";      // the bad ip
}

if (client.ip ~ longcachegroup) {
  set req.backend = longcache;

  sub vcl_fetch {
if (req.url ~ "^/*") {
    unset beresp.http.cookie;
}

# A TTL of Long ass time minutes
    set beresp.ttl = 999999999999s;
 }
} 
```

这是我当前的 default.vcl

```
backend default {
  .host = "127.0.0.1";
  .port = "8080";
  .connect_timeout = 600s;
  .first_byte_timeout = 600s;
  .between_bytes_timeout = 600s;
}

sub vcl_recv {
  # Add a unique header containing the client address
  remove req.http.X-Forwarded-For;
  set    req.http.X-Forwarded-For = client.ip;
}

sub vcl_recv {

# A configuration file specific for Drupal 7 that also seems to work on Drupal 6

# Either the admin pages or the login
if (req.url ~ "/admin/?") {
        # Don't cache, pass to backend
        return (pass);
}

#for anonymous search and poll votes
if (req.request ~ "POST") {
  return (pass);
}

# Remove the "has_js" cookie
set req.http.Cookie = regsuball(req.http.Cookie, "has_js=[^;]+(; )?", "");

# Remove the "Drupal.toolbar.collapsed" cookie
set req.http.Cookie = regsuball(req.http.Cookie, "Drupal.toolbar.collapsed=[^;]+(; )?", "");

# Remove any Google Analytics based cookies
set req.http.Cookie = regsuball(req.http.Cookie, "__utm.=[^;]+(; )?", "");

# Remove the Quant Capital cookies (added by some plugin, all __qca)
set req.http.Cookie = regsuball(req.http.Cookie, "__qc.=[^;]+(; )?", "");

# Are there cookies left with only spaces or that are empty?
if (req.http.cookie ~ "^ *$") {
        unset req.http.cookie;
}

# Static content unique to the theme can be cached (so no user uploaded images)
if (req.url ~ "^/themes/" && req.url ~ "\.(css|js|png|gif|jp(e)?g)") {
        unset req.http.cookie;
}
# Cache images
if (req.url ~ "^/files/" && req.url ~ "\.(css|js|png|gif|jp(e)?g)") {
        unset req.http.cookie;
}

# Normalize Accept-Encoding header (straight from the manual: https://www.varnish-cache.org/docs/3.0/tutorial/vary.html)
if (req.http.Accept-Encoding) {
        if (req.url ~ "\.(jpg|png|gif|gz|tgz|bz2|tbz|mp3|ogg)$") {
                # No point in compressing these
                remove req.http.Accept-Encoding;
        } elsif (req.http.Accept-Encoding ~ "gzip") {
                set req.http.Accept-Encoding = "gzip";
        } elsif (req.http.Accept-Encoding ~ "deflate") {
                set req.http.Accept-Encoding = "deflate";
        } else {
                # unkown algorithm
                remove req.http.Accept-Encoding;
        }
}

# Don't cache the install, update or cron files in Drupal
if (req.url ~ "install\.php|update\.php|cron\.php|current\.html|^/user|fupload/flash|stream\.html") {
    return (pass);
}

# Uncomment this to trigger the vcl_error() subroutine, which will HTML output you some variables (HTTP 700 = pretty debug)
#error 700;

# Anything else left?
if (!req.http.cookie) {
        unset req.http.cookie;
}

if (req.http.Authorization || req.http.Cookie) {
  # Not cacheable by default
  return (pass);
}

# Try a cache-lookup
return (lookup);

}

sub vcl_fetch {

# For static content related to the theme, strip all backend cookies
if (req.url ~ "^/themes/" && req.url ~ "\.(css|js|png|gif|jp(e?)g)") {
    unset beresp.http.cookie;
}

# A TTL of 15 minutes
    set beresp.ttl = 900s;
}

sub vcl_error {

    set obj.http.Content-Type = "text/html; charset=utf-8";
    set obj.http.Retry-After = "5";
    synthetic {"
<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
 "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html>
  <head>
    <title>"} + obj.status + " " + obj.response + {"</title>
  </head>
  <body>
    <h1>Error "} + obj.status + " " + obj.response + {"</h1>
    <p>"} + obj.response + {"</p>
    <h3>Guru Meditation:</h3>
    <p>XID: "} + req.xid + {"</p>
    <hr>
    <p>Varnish cache server</p>
  </body>
</html>
"};

} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-08T14:35:51.930

您将在缓存中为每个人覆盖您的 ttl，因为它将获得与您的目标相同的哈希值。

您还需要添加以下内容：

```
sub vcl_hash {

    ### these 2 entries are the default ones used for vcl. Below we add our own.
    set req.hash += req.url;
    set req.hash += req.http.host;

    if (client.ip ~ longcachegroup) {
        set req.hash += "longcachegroup";
    }
} 
```

# cakephp - CakePHP 2.1 .po 文件/翻译不起作用

> ID：10049661
> 
> 赞同：5
> 
> 时间：2012-04-06T21:51:26.543
> 
> 标签：cakephp, translation, cakephp-2.1

我`<?php echo __("this is my string"); ?>`在视图内部使用多种语言显示文本。我为德语创建了一个 .po 文件目录：

=> app/Locale/ger/LC_MESSAGES/default.po

> msgstr "这是我的字符串"
> 
> msgstr "dies ist meine zeichenkette"

当我添加`Configure::write('Config.language','ger');`到我的 AppController.php beforeFilter 函数时，文本仍然是“这是我的字符串”。即使我用不同的 msgstr 为英语创建了一个 .po，文本仍然保持不变。

我是否必须更改特定设置才能激活翻译？

* * *

我有一个后续问题：我添加`Configure::write('Config.language','eng');`到**core.php**以设置我的默认语言，但现在我无法更改该值，即使我尝试在**AppController.php** beforeFilter 中覆盖它：

```
Configure::write('Config.language', 'deu'); //'de' also doesn't work
CakeSession::write('Config.language', 'deu'); //'de' also doesn't work 
```

如果我更改 core.php 中的值，它可以正常工作，但一旦在 core.php 中设置，我就无法更改它。

**已解决：**啊，我忘了`parent::beforeFilter();`在所有控制器的 beforeFilter 函数中添加。

* * *

**附加信息：**

*   如果你想定义一种默认语言（你通常会这样做），添加`Configure::write('Config.language', 'eng');`到**core.php**

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-04-06T22:17:15.583

您可以查看文件 lib/Cake/I18n/L10n.php，了解如何调用每种语言。

德语设置：

```
Configure::write('Config.language','de'); 
```

=> app/Locale/deu/LC_MESSAGES/default.po

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-04-06T22:16:34.567

它的“deu”不是“ger”

[CakePHP 使用来自http://www.loc.gov/standards/iso639-2/php/code_list.php](http://www.loc.gov/standards/iso639-2/php/code_list.php)的官方 (T) 代码，对于 CakePHP 1.3，它记录在[Internationalizing Your Application](http://book.cakephp.org/1.3/en/The-Manual/Common-Tasks-With-CakePHP/Internationalization-Localization.html#internationalizing-your-application)下：

> 三字符语言环境代码符合[ISO 639-2](http://www.loc.gov/standards/iso639-2/php/code_list.php)标准，但如果您创建区域语言环境（en_US、en_GB 等），如果合适，cake 将使用它们。

```
ISO 639-2 |  ISO 639-1 | English name | French name | German name |
Code      |  Code      | of Language  | of Language | of Language |
-------------------------------------------------------------------
ger (B)   |            |              |             |             |
deu (T)   |  de        | German       | allemand    | Deutsch     | 
```

# java - 休眠多对多结果不如预期 - 仅获取最后一条记录

> ID：10049666
> 
> 赞同：1
> 
> 时间：2012-04-06T21:51:41.903
> 
> 标签：java, hibernate, many-to-many

我有角色实体，它具有三个与 Page、ProfileSection 和 PageComponents 的多对多映射。当我加载角色页面时加载正确，但 profileSection 和 PageComponents 仅加载一条记录。

下面是我的模型。

```
@Entity 
@Table(name = "role", uniqueConstraints = {@UniqueConstraint(columnNames={"authority"})})
public class Role extends AbstractBaseModel implements GrantedAuthority {
    @Id 
    @GeneratedValue(strategy = GenerationType.AUTO)
    @BusinessKey(include = MethodType.TO_STRING)
    private int id;

    @BusinessKey
    private String authority;

    @ManyToMany(cascade=CascadeType.ALL, fetch = FetchType.LAZY)
    //@Fetch(value = FetchMode.SUBSELECT)
    private Set<Page> pages;

    @ManyToMany(cascade=CascadeType.ALL, fetch = FetchType.LAZY)
    //@Fetch(value = FetchMode.SUBSELECT)
    private Set<PageComponent> pageComponents;

    @ManyToMany(cascade=CascadeType.ALL, fetch = FetchType.LAZY)
    @Fetch(value = FetchMode.SELECT)
    private Set<ProfileSection> profileSections;
} 
```

页面.java

```
@XmlRootElement(name="page")
@Entity
@Table(name = "page", catalog = "public", uniqueConstraints = {@UniqueConstraint(columnNames = {"page_id", "page_title"})})
public class Page extends OrderedModel {
    private static final long serialVersionUID = 1L;

    @BusinessKey(include = MethodType.TO_STRING)
    @Column(name = "page_id")
    private String pageId;

    @BusinessKey(include = MethodType.TO_STRING)
    @Column(name = "page_title")
    private String pageTitle;

    @BusinessKey
    @OneToMany(mappedBy="page", cascade = CascadeType.ALL, fetch = FetchType.LAZY)
    private List<PageComponent> pageComponents;
} 
```

ProfileSection.java

```
@Entity
@Table(name = "profile_section", catalog = "public", uniqueConstraints = {@UniqueConstraint(columnNames = "section_id")})
public class ProfileSection  extends OrderedModel {
    private static final long serialVersionUID = 1L;

    @BusinessKey(include = MethodType.TO_STRING)
    @Column(name = "section_id")
    private String sectionId;

    @BusinessKey(include = MethodType.TO_STRING)
    @Column(name = "section_title")
    private String sectionTitle;
} 
```

页面组件.java

```
@Entity
@Table(name = "page_component", catalog = "public", uniqueConstraints = {@UniqueConstraint(columnNames = "component_id")})
public class PageComponent  extends BaseModel {
    private static final long serialVersionUID = 1L;

    @BusinessKey
    @ManyToOne(fetch = FetchType.LAZY)
    @JoinColumn(name="page_id")
    private Page page;

    @BusinessKey(include = MethodType.TO_STRING)
    @Column(name = "component_id")
    private String componentId;

    @BusinessKey(include = MethodType.TO_STRING)
    @Column(name = "component_title")
    private String componentTitle;

    @BusinessKey(include = MethodType.TO_STRING)
    @Column(name = "component_type")
    private String componentType;
} 
```

以下是我的 dao 中的代码

```
List<Person> list = c.list();
for(Person p: list){
    System.out.println("Roles size is:: "+p.getRoles().size());
    Role r = p.getRoles().iterator().next();
    System.out.println("Page Size is: "+r.getPages().size());
    System.out.println("ProfileSection Size is: "+r.getProfileSections().size());
    System.out.println("Page Components Size is: "+r.getPageComponents().size());
    for(ProfileSection s : r.getProfileSections()) {
        System.out.println(s.getSectionId());
    }
} 
```

结果是：

```
Roles size is:: 1 - Expected 1

Page Size is: 6 - Expected 6

ProfileSection Size is: 1 - Expected 3

Page Components Size is: 1 - Expected 4 
```

* * *

我根据您提供的链接修改了我的 Role.java。下面是修改后的实体

```
@Entity 
@Table(name = "role", uniqueConstraints = {@UniqueConstraint(columnNames={"authority"})})
public class Role extends AbstractBaseModel implements GrantedAuthority{

    @Id 
    @GeneratedValue(strategy = GenerationType.AUTO)
    @BusinessKey(include = MethodType.TO_STRING)
    private int id;

    @BusinessKey
    private String authority;

    @ManyToMany(cascade=CascadeType.ALL, fetch = FetchType.LAZY)
    @JoinTable(name="role_page",
      joinColumns={@JoinColumn(name="role_id", referencedColumnName="id")},
      inverseJoinColumns={@JoinColumn(name="pages_id", referencedColumnName="id")})
    private Set<Page> pages;

    @ManyToMany(cascade=CascadeType.ALL, fetch = FetchType.LAZY)
    @JoinTable(name="role_page_component",
      joinColumns={@JoinColumn(name="role_id", referencedColumnName="id")},
      inverseJoinColumns={@JoinColumn(name="pagecomponents_id", referencedColumnName="id")})
    private Set<PageComponent> pageComponents;

    @ManyToMany(cascade=CascadeType.ALL, fetch = FetchType.LAZY)
    @JoinTable(name="role_profile_section",
      joinColumns={@JoinColumn(name="role_id", referencedColumnName="id")},
      inverseJoinColumns={@JoinColumn(name="profilesections_id", referencedColumnName="id")})
    private Set<ProfileSection> profileSections;

} 
```

以下是 dao 代码：

```
/**
     * For Depth > 1, better use this method method.
     * Example: Person person = personDAO.findByProperty("email", email, lazyOptions, true);
     */
    @SuppressWarnings("unchecked")
    public T findByProperty(String propertyName, Object value, HibernateCriteriaLazyOptions lazyOptions, boolean uniqueResult) {
        JoinCriteriaHelper joiner = JoinCriteriaHelper.forClass(getGenericClass(), lazyOptions.getPaths());
        Criteria c;
        if(lazyOptions.getDepth() != null){
            // this would only fetch properties a, b and e
            c = joiner.getExecutableCriteria(getSession(), lazyOptions.getDepth());
            //DetachedCriteria dc = joiner.getDetachedCriteria(Preload.DEPTH_2);
        }else{
            // this would fetch all properties a, b, c, d and e
            c = joiner.getExecutableCriteria(getSession());
        }
        c.add(Restrictions.eq(propertyName, value));

        if(getGenericClass().equals(Person.class)){
            List<Person> list = c.list();
            for(Person p: list){
                System.out.println("Roles size is:: "+p.getRoles().size());
                Role r = p.getRoles().iterator().next();
                System.out.println("Page Size is: "+r.getPages().size());
                System.out.println("ProfileSection Size is: "+r.getProfileSections().size());
                System.out.println("Page Components Size is: "+r.getPageComponents().size());
                for(ProfileSection s : r.getProfileSections()){
                    System.out.println(s.getSectionId());
                }
            }
        }
        return (T)UnproxyUtility.unproxy((T)c.uniqueResult());
    } 
```

以下是我的表格：

```
CREATE TABLE "role"
(
  id integer NOT NULL,
  authority character varying(255),
  CONSTRAINT role_pkey PRIMARY KEY (id),
  CONSTRAINT role_authority_key UNIQUE (authority)
)

CREATE TABLE page
(
  id bigserial NOT NULL,
  created_date timestamp without time zone,
  last_updated timestamp without time zone,
  page_id character varying(255),
  page_title character varying(255),
  order_number bigint,
  CONSTRAINT page_pkey PRIMARY KEY (id),
  CONSTRAINT page_page_id_key UNIQUE (page_id),
  CONSTRAINT page_page_id_key1 UNIQUE (page_id),
  CONSTRAINT page_page_title_key UNIQUE (page_title)
)

CREATE TABLE role_page
(
  role_id integer NOT NULL,
  pages_id bigint NOT NULL,
  CONSTRAINT role_page_pkey PRIMARY KEY (role_id, pages_id),
  CONSTRAINT fk140574b8dc0483c9 FOREIGN KEY (pages_id)
      REFERENCES page (id) MATCH SIMPLE
      ON UPDATE NO ACTION ON DELETE NO ACTION,
  CONSTRAINT fk140574b8facefbbe FOREIGN KEY (role_id)
      REFERENCES "role" (id) MATCH SIMPLE
      ON UPDATE NO ACTION ON DELETE NO ACTION
)

CREATE TABLE page_component
(
  id bigserial NOT NULL,
  created_date timestamp without time zone,
  last_updated timestamp without time zone,
  component_id character varying(255),
  component_title character varying(255),
  component_type character varying(255),
  page_id bigint,
  CONSTRAINT page_component_pkey PRIMARY KEY (id),
  CONSTRAINT fk5b31d34d78d7191e FOREIGN KEY (page_id)
      REFERENCES page (id) MATCH SIMPLE
      ON UPDATE NO ACTION ON DELETE NO ACTION,
  CONSTRAINT page_component_component_id_key UNIQUE (component_id)
)

CREATE TABLE role_page_component
(
  role_id integer NOT NULL,
  pagecomponents_id bigint NOT NULL,
  CONSTRAINT role_page_component_pkey PRIMARY KEY (role_id, pagecomponents_id),
  CONSTRAINT fk8af50636d6882e9f FOREIGN KEY (pagecomponents_id)
      REFERENCES page_component (id) MATCH SIMPLE
      ON UPDATE NO ACTION ON DELETE NO ACTION,
  CONSTRAINT fk8af50636facefbbe FOREIGN KEY (role_id)
      REFERENCES "role" (id) MATCH SIMPLE
      ON UPDATE NO ACTION ON DELETE NO ACTION
)

CREATE TABLE profile_section
(
  id bigserial NOT NULL,
  created_date timestamp without time zone,
  last_updated timestamp without time zone,
  order_number bigint,
  section_id character varying(255),
  section_title character varying(255),
  CONSTRAINT profile_section_pkey PRIMARY KEY (id),
  CONSTRAINT profile_section_section_id_key UNIQUE (section_id),
  CONSTRAINT profile_section_section_id_key1 UNIQUE (section_id)
)

CREATE TABLE role_profile_section
(
  role_id integer NOT NULL,
  profilesections_id bigint NOT NULL,
  CONSTRAINT role_profile_section_pkey PRIMARY KEY (role_id, profilesections_id),
  CONSTRAINT fkcac52086b893cd43 FOREIGN KEY (profilesections_id)
      REFERENCES profile_section (id) MATCH SIMPLE
      ON UPDATE NO ACTION ON DELETE NO ACTION,
  CONSTRAINT fkcac52086facefbbe FOREIGN KEY (role_id)
      REFERENCES "role" (id) MATCH SIMPLE
      ON UPDATE NO ACTION ON DELETE NO ACTION
) 
```

以下是 Hibernate 执行的查询：

```
Hibernate: select pages0_.role_id as role1_22_1_, pages0_.pages_id as pages2_1_, page1_.ID as ID17_0_, page1_.created_date as created2_17_0_, page1_.last_updated as last3_17_0_, page1_.order_number as order4_17_0_, page1_.page_id as page5_17_0_, page1_.page_title as page6_17_0_ from role_page pages0_ inner join public.page page1_ on pages0_.pages_id=page1_.ID where pages0_.role_id=?

Page Size is: 6

Hibernate: select profilesec0_.role_id as role1_22_1_, profilesec0_.profilesections_id as profiles2_1_, profilesec1_.ID as ID19_0_, profilesec1_.created_date as created2_19_0_, profilesec1_.last_updated as last3_19_0_, profilesec1_.order_number as order4_19_0_, profilesec1_.section_id as section5_19_0_, profilesec1_.section_title as section6_19_0_ from role_profile_section profilesec0_ inner join public.profile_section profilesec1_ on profilesec0_.profilesections_id=profilesec1_.ID where profilesec0_.role_id=?

ProfileSection Size is: 1

Hibernate: select pagecompon0_.role_id as role1_22_1_, pagecompon0_.pagecomponents_id as pagecomp2_1_, pagecompon1_.ID as ID18_0_, pagecompon1_.created_date as created2_18_0_, pagecompon1_.last_updated as last3_18_0_, pagecompon1_.component_id as component4_18_0_, pagecompon1_.component_title as component5_18_0_, pagecompon1_.component_type as component6_18_0_, pagecompon1_.page_id as page7_18_0_ from role_page_component pagecompon0_ inner join public.page_component pagecompon1_ on pagecompon0_.pagecomponents_id=pagecompon1_.ID where pagecompon0_.role_id=?

Page Components Size is: 1 
```

如果观察结果：

```
Pages are getting 6 - This is expected as the rows are 6 for that particular role id

PageComponents 1 - This is wrong as the rows matching for that role id are 4

ProfileSections 1 - This is also wrong matching rows are 4. 
```

我无法理解我错在哪里。我根据建议更新了我的实体，但结果仍不如预期。这不是我第一次处理多对多问题，到目前为止我从未遇到过这种问题。即使我没有在 Role.java 中映射 joinTable 也得到了预期的结果。

当我错了，请告诉我？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-06T22:53:25.190

我不确定它为什么会返回`Page`,`ProfileSection`或根本不返回`PageComponent`。看起来您没有将多对多与注释连接`@JoinTable`起来`@JoinColumn`。也许您是通过 XML 来实现的？在这种情况下，您可以发布您的连接定义吗？

有关使用注释连接 ManyToManys 的说明，请参阅[此站点。](http://en.wikibooks.org/wiki/Java_Persistence/ManyToMany)

# ruby - 使用负整数进行 Ruby 数组排序的行为不一致

> ID：10049667
> 
> 赞同：1
> 
> 时间：2012-04-06T21:51:56.390
> 
> 标签：ruby, arrays, sorting

给定一个数组

```
x = [1, 3, 5, -1, -3, -5] 
```

如果我们使用命令

```
x.sort {|i| i} 
```

我们被给予

```
x = [-1, -3, -5, 1, 3, 5] 
```

有没有什么办法，给定我们的数组，让它以正确的升序/降序和负数返回它？例如

```
x = [-5, -3, -1, 1, 3, 5] or [5, 3, 1, -1, -3, -5] 
```

编辑：

似乎 x.sort 可以解决这个问题，但是如果有一个更复杂的问题，我想根据散列中给出的值从我的数组中排序，例如

```
x = [{:i=>1}, {:i=>2}, {:i=>3}, {:i=>4}, {:i=>5}]
y = {3=>10, 4=>-1, 2=>-2, 5=>-3, 1=>-4} 
```

我希望能够根据 y 中的值对 x 进行排序，以便我的结果是

```
x = [{:i=>3}, {:i=>4}, {:i=>2}, {:i=>5}, {:i=>1}] 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-04-06T21:56:12.630

```
x = [1, 3, 5, -1, -3, -5]
x.sort # => [-5, -3, -1, 1, 3, 5]
x.sort {|a,b| a <=> b} # => [-5, -3, -1, 1, 3, 5]
x.sort {|a,b| b <=> a} # => [5, 3, 1, -1, -3, -5] 
```

由于[`Array#sort`方法](http://www.ruby-doc.org/core-1.9.3/Array.html#method-i-sort)预期的返回值，您的示例产生了意外的结果。基本上，当您只返回第一个参数时（当需要两个参数时），解释器只查看元素的符号 (-/0/+) 并将其用于排序。因此，根据底层排序算法，当它从数组产生对到您的块时，它只查看第一个元素的符号，因此类似于：

```
compare(1, 3) # => 1 (wrong, should be -1 since 1 < 3)
compare(1, 5) # => 1 (wrong, should be -1 since 1 < 5)
compare(1, -1) # => 1 (right, by complete accident) 
```

**[编辑]**根据您更新的问题，尝试使用以下排序比较器块：

```
x.sort! {|a,b| y[b[:i]] <=> y[a[:i]]}
x # => [{:i=>3}, {:i=>4}, {:i=>2}, {:i=>5}, {:i=>1}] 
```

其中读取 -`x`通过比较每个元素对对数组进行适当的排序，`a`并`b`通过在哈希中查找它们的`:i`属性`y`并按降序比较这些值。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-06T22:56:09.980

我很惊讶到目前为止没有人提到[Enumerable#sort_by 。](http://www.ruby-doc.org/core-1.9.3/Enumerable.html#method-i-sort_by)虽然对于您最初的问题`sort`显然是正确的答案，`sort_by`但可以按照您的预期使用该块。您更新的问题也很容易解决：

```
x = [-1, -3, -5, 1, 3, 5]
x.sort_by { |i| i } 
#=> [-5, -3, -1, 1, 3, 5]

x = [{:i=>1}, {:i=>2}, {:i=>3}, {:i=>4}, {:i=>5}]
y = {3=>10, 4=>-1, 2=>-2, 5=>-3, 1=>-4}
x.sort_by { |x| -y[x[:i]] } 
#=> [{:i=>3}, {:i=>4}, {:i=>2}, {:i=>5}, {:i=>1}] 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-06T21:54:35.060

```
x.sort # => [-5, -3, -1, 1, 3, 5] 
```

# sql-server - 在 SQL Server 中，如果第一条语句引发错误，执行是否会移至下一条语句？

> ID：10049676
> 
> 赞同：2
> 
> 时间：2012-04-06T21:52:54.283
> 
> 标签：sql-server, tsql

我有一个包含多个更新和插入查询的 SP。如果任何查询给出错误，执行是否移至下一条语句？例如，

```
CREATE PROCEDURE Test()
AS
BEGIN
    INSERT INTO SomeTable VALUES (1, 2, 3)
    UPDATE SomeTable SET X = 4 WHERE Y = 5
END 
```

在上面的例子中，如果 INSERT 语句抛出错误，执行会移动到下一个 UPDATE 语句吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-06T23:03:37.673

这取决于[错误的严重性](http://msdn.microsoft.com/en-us/library/ms164086.aspx)。从严重性 19 及以上，批处理被中止：

> 指示已超出不可配置的数据库引擎限制，并且当前批处理已终止。严重级别为 19 或更高的错误消息会停止当前批处理的执行。

但是请注意，如果上面的代码在一个`BEGIN TRY/BEGIN CATCH`块内运行（或从这样一个块调用），那么严重性为 10-18 的错误会导致控制流跳转到 catch 块（这与*说*执行被中止不同） )，因此**不会**执行下一条语句。

此外，该[`XACT_ABORT`](http://msdn.microsoft.com/en-us/library/ms188792.aspx)设置还会导致当前事务回滚*和*当前批处理中止。

如果您想要一个如何编写可靠存储过程代码的模板，请参阅[异常处理和嵌套事务](http://rusanu.com/2009/06/11/exception-handling-and-nested-transactions/)

# xml - 如何有效地在 XML 中建模逻辑/布尔表达式？

> ID：10049677
> 
> 赞同：3
> 
> 时间：2012-04-06T21:53:02.713
> 
> 标签：xml, boolean-logic

小 xml 建模练习在这里。

假设我们有一些逻辑表达式： (x & y) | (p & q)

无论出于何种原因，它都需要用 XML 表示。

这是一个快速的刺，但我认为这很笨拙：

```
 <expr>
    <or>
        <and>
            <e>x</e>
            <e>y</e>
        </and>
        <and>
            <e>p</e>
            <e>q</e>
        </and>
    </or>
 </expr> 
```

另一个刺伤，我闻起来不对：

```
<expr>
    <or>
        <and l="x" r="y"/>
        <and l="p" r="q"/>
    </or>
</expr> 
```

你会怎么做？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2014-02-10T10:07:09.033

Armatus 的回答对我来说看起来不错。我认为左右元素是多余的。有一个逻辑表达式，如果我评估它们是左右还是右左都没有关系。

```
 <expr type="or">
    <expr type="and">
        <sig>x</sig>
        <sig>y</sig>
    </expr>
    <expr type="and">
        <sig>p</sig>
        <sig>q</sig>
    </expr>
</expr> 
```

例如： `(x & y) | (p & q)`是一样的`(q & p) | (y & x)`

此外，它可以添加两个以上的信号。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-04-06T22:11:25.910

这个怎么样？

```
<expr:or>
<l>
    <expr:and>
    <l>x</l><r>y</r>
    </expr>
</l>
<r>
    <expr:and>
    <l>p</l><r>q</r>
    </expr>
</r>
</expr> 
```

也可以加`<expr:xor><l>x</l><r>y</r></expr>`和`<expr:not>x</expr>`。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-06T22:36:55.540

你的第一个“快速刺伤”对我来说看起来非常合理，除了外部的“expr”元素，它没有增加太多价值。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2018-09-10T07:48:05.543

看看表达式树是如何在 Microsoft .NET 的[System.Linq.Expressions](https://docs.microsoft.com/en-us/dotnet/api/system.linq.expressions?redirectedfrom=MSDN&view=netframework-4.7.2)命名空间中建模的很有趣。我认为在这里很重要的基本概念是，一切都继承自基本的[Expression](https://docs.microsoft.com/en-us/dotnet/api/system.linq.expressions.expression?view=netframework-4.7.2)类——所以几乎所有东西都是一个表达式，无论是二元运算、参数、常量等等。

此外，NuGet 包[Serialize.Linq](https://github.com/esskar/Serialize.Linq)演示了如何将此类表达式树序列化为 XML。

**长解决方案**

不过这只是参考。我认为 XML 模型可以做得更简单。我会像这样为您的示例建模：

```
<expr returns="boolean">
  <params>
    <param name="x" type="boolean">
    <param name="y" type="boolean">
    <param name="p" type="boolean">
    <param name="q" type="boolean">
  </params>
  <body op="bor">
    <left op="band">
      <left  op="param">x</left>
      <right op="param">y</left>
    </left>
    <right op="band">
      <left  op="param">p</left>
      <right op="param">q</left>
    </right>
  </body>
<expr> 
```

**简短的解决方案**

根据您的实现，您可能能够省略`<params>`元素和`type`属性，并在解释表达式时以更“隐式”的方式处理这些事情（有点像 JavaScript、PowerShell 等）。此外，如果 XML 输出的大小/长度存在问题，您可以缩短元素和类型名称。

因此，这是一个高度缩短版本的示例：

```
<e t="bor">
  <l t="band">
    <l t="prm">x</l>
    <r t="prm">y</r>
  </l>
  <r t="band">
    <l t="prm">p</l>
    <r t="prm">y</r>
  </r>
</e> 
```

**另一个例子**

为了完整起见，这里是另一个示例，说明如何以这种方式对更复杂的表达式进行建模。

伪代码 lambda/箭头表达式：

```
(float b, int e) => e == 0 ? 1 : (e == 1 ? b : pow(b, e)) 
```

XML 表示：

```
<expr returns="float">
 <params>
   <prm name="b" type="float" />
   <prm name="e" type="int" />
 </params>
 <body op="if">
   <cond op="eq">
     <left op="param">e</left>
     <right op="const" type="int">0</right>
   </cond>
   <true op="const" type="float">1</true>
   <false op="if">
     <cond op="eq">
       <left op="param">e</left>
       <right op="const" type="int">1</right>
     </cond>
     <true op="param">b</true>
     <false op="call" name="pow">
       <args>
         <arg op="param">p</arg>
         <arg op="param">e</arg>
       </args>
     </false>
   </false>
 </body>
</expr> 
```

# format - SAS - 从带有科学计数法数字的csv文件导入时如何保留实际数字

> ID：10049683
> 
> 赞同：3
> 
> 时间：2012-04-06T21:53:53.860
> 
> 标签：format, sas, scientific-notation

当我将具有长数字 ID 的文件从 csv 文件导入 SAS 时，我想将数字转换为文本。但是这些数字是以科学记数法存储的，所以当它们转换时，最后一个数字都变成了零。

例如，7.3139908E14 变成了 731399080000000，它应该是 731399076376199。

有没有办法解决这个问题？最终我需要做一些重复数据删除，然后将此文件导出为文本文件。

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-10T15:40:53.250

假设您的数据看起来像（即第二个 CSV 位置的数字 ID）：

```
blah;7313990763761997;blah 
```

您可以逐行简单地读取文件并直接访问输入缓冲区（_INFILE_ 变量）：

```
filename mycsv "\path\to\mycsv.csv";

data mydata;
  infile mycsv;
  input;
  length idvar $16;
  idvar=scan(_infile_,2,";");
run; 
```

如果您只想这样做，这将保留文本格式的数字。

# android - SQL查询转换为数组Android

> ID：10049685
> 
> 赞同：0
> 
> 时间：2012-04-06T21:54:05.920
> 
> 标签：android

您好，我是 android 新手，我真的需要一些帮助。我的 sqlitehelper 类中有一个预填充数据库，我需要一个查询请求返回一个 String[] 表。示例我的数据库有 3 列 id、name、tel 我的查询将基于 id，因此光标将获得 {1 mary 2134} 我希望将其转换为字符串 [1 mary 2134]。不知道它是否有帮助，但我的所有请求都将返回单行，导致查询基于其主键。
我的代码是这样的：

```
 public String[] getSingleRow(String id){
    String[] asColumnsToReturn = new String[] { COLUMN_ID,COLUMN_NAME, COLUMN_TELEPHONE}
    Cursor cursor = this.dbSqlite.query(TABLE_NAME, asColumnsToReturn, COLUMN_ID + "=" + id, null, null, null, null);

    //here is where i need help
    String table[]=new String[2];
    int i = 0;

                while (i < table.length) {
                table[i]  = cursor.getString(i);
                i++;
                cursor.moveToNext();
                }
                cursor.close();
return table;
  } 
```

我需要它，所以在我的主课中我可以设置 textview 如下：

```
TextView myTextView = (TextView)findViewById(R.id.textView1);
Table= SQLiteHelper.getSingleRow(id);
myTextView.setText(Table[0]); // "0"for id "1" for name and "2" for telephone 
```

所以我的问题是如何将单行返回的查询转换为 String[]

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-06T22:00:28.243

在您可以使用光标之前，您必须先调用`cursor.moveToFirst()`。在你的 while 循环之前调用它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-06T22:05:13.227

您似乎对光标是什么感到困惑。

光标指向结果响应中的一行。因此，如果您的表格如下所示：

```
1 | Mary | 1234
2 | Alice | 134
3 | Bob | 123 
```

在调用 cursor.movetoNext() 之前，游标一次只能指向这些行之一。在单行结果中，您的游标显然永远不必使用该方法。

当然，如果您想要一个 ROW 而不是像您的变量那样命名的 TABLE：

```
cursor.moveToFirst();
String row[] = new String[3]
row[0] = cursor.getString(0);
row[1] = cursor.getString(1);
row[2] = cursor.getString(2);
return row; 
```

另外，我建议也对列使用常量：

```
//declared somewhere as public static final String KEY_NAME = "name";
cursor.getString(cursor.getColumnIndexByName(KEY_NAME)); 
```

# android - 从 LocationManager 获取 ProximityAlerts 列表

> ID：10049686
> 
> 赞同：0
> 
> 时间：2012-04-06T21:54:11.597
> 
> 标签：android, locationmanager

**简而言之：** *我如何访问`LocationManagerService.mProximityAlerts`？*

我正在尝试让多个 ProximityAlerts 在 Android 中工作。`PendingIntents`在调试期间跟踪我添加为 ProximityAlerts的情况会很有帮助。

我检查了 Android 源代码，发现在 中`mProximityAlerts`声明了一个映射变量`LocationManagerService`，但我不知道如何在运行（调试）我的应用程序时访问该变量。

查询本次调用的结果

```
LocationManager lm = (LocationManager) caller.getSystemService(Context.LOCATION_SERVICE); 
```

在调试器中运行时似乎没有帮助，而且我无法在 NetBeans 监视列表中进行类型转换`lm.mService`（`LocationManagerService`如果这甚至是正确的轨道......）。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-06T22:19:35.613

> 简而言之：如何访问 LocationManagerService.mProximityAlerts？

你没有，至少不是通过 SDK。它们可能包含在`adb shell dumpsys`.

# ios5.1 - NKAssetdownload 的开始因报刊应用程序的 iOS5.1 更新而延迟

> ID：10049687
> 
> 赞同：1
> 
> 时间：2012-04-06T21:54:13.937
> 
> 标签：ios5.1, newsstand-kit

我有一个已发布的 ipad 应用程序，它是一个报摊应用程序。

自从 5.1 iOs 更新以来，当我尝试使用 NKAssetDownload 下载任何问题时，我在更新开始之前延迟了很长时间。

我没有收到任何错误消息或任何内容，下载开始需要很长时间（5-10 分钟）。

下载开始后，它会正常进行并完成，不会有任何进一步的延迟或错误。

如果我能对问题可能是什么或如何调试它有任何建议，我将不胜感激，因为这是一个实时应用程序，客户开始发疯。

先感谢您。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-08T20:25:21.547

Apple 建议您将问题下载为一个文件。如果您下载多个文件（例如，每页一个文件），更新通知出现前会有延迟。这是因为发送到应用程序的下载进度指示是针对每个文件的。如果您一次下载多个文件，则由于共享带宽而延长了在一个文件上取得显着（通知）进度所需的时间。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-12T09:48:38.957

我也有这个问题。我最终仅将 NKAssetDownload 用于报亭推送后台下载。对于在前台运行的普通应用内下载，我使用 URLConnection。NKAssetDownload 似乎不是为前台使用而设计的，因为它不够可靠，用户无法等待它完成。

# javascript - 如何在 jQuery 中调用 setinterval？

> ID：10049697
> 
> 赞同：2
> 
> 时间：2012-04-06T21:56:06.887
> 
> 标签：javascript, jquery, setinterval

我正在尝试`setinterval`在 jQuery 中调用函数，但它给出了错误

`Microsoft JScript runtime error: 'setinterval' is undefined`

这是我的代码

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
    <title></title>
    <script src="//ajax.googleapis.com/ajax/libs/jquery/1.6.1/jquery.min.js" type="text/javascript"></script>
    <script type="text/javascript">
        $(document).ready(function () {
            setInterval(function () {alert("HELLO WORLD!");}, 300);
        });
    </script>
</head>
<body>
//HTML code is here.
</body>
</html> 
```

![在此处输入图像描述](../Images/b89f892db94efb7af8d250b74b292efc.png)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-06T22:42:18.830

屏幕截图显示您正在尝试使用“setinterval”，即没有大写“i”，这是一个错误（javascript 区分大小写）。要么它不是您使用的确切代码，要么在某处有另一段代码调用它。

# java - 您能否拥有不相邻但仍可在一个单选组中使用的单选按钮？

> ID：10049699
> 
> 赞同：2
> 
> 时间：2012-04-06T21:56:14.283
> 
> 标签：java, android, radio-button, radio-group

我想要做的是在不同的图片上有几个单选按钮，所以当你点击那个单选按钮时，它变成了背景，如果我把单选按钮放在一个单选组中，所有的按钮都在彼此旁边，但是我基本上需要它们在页面的四个边缘。我在相对布局中有我的布局，但是当我移动一个单选按钮时，它会离开单选组，是否有阻止这个？谢谢迈克尔。

这是无线电组的代码

```
 <RadioGroup
        android:id="@+id/PictureSelection"
        android:layout_width="wrap_content"
        android:orientation="horizontal"
        android:layout_height="wrap_content"
        android:layout_alignBottom="@+id/textView1"
        android:layout_alignRight="@+id/Picture1" >

        <RadioButton
            android:id="@+id/radioButton1"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:layout_above="@+id/EditQuestion2"
            android:layout_alignRight="@+id/Picture1" />

        <RadioButton
            android:id="@+id/radioButton4"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content" />

        <RadioButton
            android:id="@+id/radioButton2"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:layout_alignBottom="@+id/Picture2"
            android:layout_alignRight="@+id/Picture2" />

        <RadioButton
            android:id="@+id/radioButton3"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:layout_alignRight="@+id/textView1"
            android:layout_alignTop="@+id/EditQuestion1" />
    </RadioGroup> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-06T21:59:41.177

按钮的位置无关紧要。只要他们在同一个组。当您“移动”它时，您可能会不小心制作一个新按钮并将其添加到该位置？您必须提供有关此问题的更多信息才能获得明确的答案，例如一些代码。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-06T22:06:35.940

向单选组添加一个按钮只不过是告诉机器所有按钮都是同一个“问题”的“答案”。换句话说，它们都是 ONE 选项的所有可能选择。你可以在整个页面上都有按钮，如果它们被分组，你永远不能选择超过一个。如果您有两个按钮组，则每个组中的一个按钮一次可以“打开”（选中），因此您将有两个按钮总共处于活动状态，等等。分组按钮与定位无关。

更改单选按钮的位置不会影响单选按钮是否被分组，请确保在声明单选按钮组之前声明所有按钮，并在声明组之后将每个按钮添加到组中。

# get - 将 GET 变量检索到 php 页面的方法

> ID：10049700
> 
> 赞同：-1
> 
> 时间：2012-04-06T21:56:17.157
> 
> 标签：get

检索传递给 .php 页面的 GET（在 URL 中）变量的最佳方法是什么

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-06T22:00:54.670

如果您的网址是，`exmaple.com/file.php?var=value`则“值”存储在`$_GET['var']`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-06T22:05:35.347

假设您的 GET 请求的形式为`page.php?var=1`：

```
<?php
    if (isset($_GET['var'])) {
        echo $_GET['xyz'];
    }
?> 
```

但是，如果您使用的是 PHP 框架，它可能会为您提供替代方法。

# blackberry - 如何在黑莓上交换 RSA 密钥

> ID：10049702
> 
> 赞同：0
> 
> 时间：2012-04-06T21:56:23.580
> 
> 标签：blackberry, rsa, blackberry-jde

我正在开发一个安全的多方应用程序，但我有一个*非常*大的问题。该应用程序在 BB 设备上运行，并通过套接字连接到在 pc 上运行的 java 服务器，以交换多个数据。在BB方面，我创建了一个RSAKeyPair，显然我需要将公钥（RSAPublicKey）发送到服务器，所以它可以加密数据等等......但是，臭名昭著的问题是我无法发送密钥，因为没有处理像 RSAPublicKey 这样的加密对象的流。我尝试将密钥转换为不同的类型（String、int 等），但它不起作用。

有人可以给我一些建议，好吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-07T08:33:20.813

调用`getE`和`getN`方法，将这些字节数组转换为 Base64 格式的字符串并发送到服务器。在服务器上解码 Base64 字符串并调用构造函数，获取`E`和`N`参数。

但是通过非加密通道发送此密钥并不是一个好主意。考虑将 HttpsConnection 连接到服务器并使用此安全连接进行数据传输。

# jquery - 如何使用 jQuery $.ajax() 处理 404 错误

> ID：10049709
> 
> 赞同：1
> 
> 时间：2012-04-06T21:58:31.483
> 
> 标签：jquery, ajax, http-status-code-404

为了测试当我尝试加载不存在的资源（与我的 Web 服务器在同一主机上）时会发生什么，我设置了以下代码：

```
var wrongURL = "http://foo/bar.json"; // non-existent resource
$.ajax({
    url: wrongURL,
    dataType: 'json',
    success: function(jsonResponse, textStatus, jqXHR) {
        $.('#divOfInterest').html("you should never see this");
    },
    error: function(jqXHR, textStatus, errorThrown) {
        $.('#divOfInterest').html("sorry, could not find URL");
    }
});
// remainder of code... 
```

我没有看到我的 div 显示消息`sorry, could not find URL`，而是收到控制台错误：

```
GET http://foo/bar.json 404 (Not Found) - bar.json 
```

`error`调用中和块之后的任何内容`$.ajax()`（即`// remainder of code`）都不会被执行

看起来我的浏览器（Safari 5.1.5）卡在 404 错误上并提前离开了该功能。

如何优雅地处理错误并执行其余代码？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-06T22:09:33.210

据我了解，您需要一个服务器来实际返回错误状态以运行该错误函数。

例如，如果您为 Soundcloud 上不存在的用户请求 JSON 对象，您将收到从服务器返回的 404 错误。

但是，如果您错误地输入了完整的 URI，则根本没有返回任何资源，也没有状态代码。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-06T22:08:16.973

只需替换`$.('#divOfInterest')`为`$('#divOfInterest')`:D

演示：http: [//jsfiddle.net/9Ua8J/](http://jsfiddle.net/9Ua8J/)

# android - 使用 FragmentTabs 示例未显示 ActionBar 项目

> ID：10049712
> 
> 赞同：1
> 
> 时间：2012-04-06T21:59:05.777
> 
> 标签：android, actionbarsherlock

我正在使用 ActionBarSherlock 并且有一个小问题。在片段选项卡示例中，有四个选项卡。其中三个将项目添加到 ActionBar，但第一个没有（标记为“简单”）。我试图让第一个将项目添加到 ActionBar，但由于某种原因它不起作用。我可以看到选项卡之间的唯一区别是“简单”选项卡是 SherlockFragment，而其他三个选项卡是 SherlockListFragment。

SherlockListFragments 像往常一样使用 onCreateOptionsMenu 来填充 ActionBar，但是当我将其添加到 SherlockFragment 并对其进行跟踪时，它甚至不会被调用，并且栏上也不会出现任何项目。

我不能用 SherlockFragment 添加 ActionBar 项目吗？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-04-06T22:09:04.083

你打电话了`setHasOptionsMenu(true)`吗？

# jquery - 将 jquery 弹出窗口从 onload 更改为 click 函数

> ID：10049713
> 
> 赞同：0
> 
> 时间：2012-04-06T21:59:12.880
> 
> 标签：jquery, popup

我发现这个教程几乎完全符合我的要求：

[http://webstutorial.com/jquery-popup-jquery-slide-popup/jquery](http://webstutorial.com/jquery-popup-jquery-slide-popup/jquery)

除了它在正文加载时运行，我试过让它在点击时运行，但我无法让它工作，谁能帮我让它在我点击按钮而不是加载时运行？

JS

```
function openOffersDialog() {
    $('#overlay').fadeIn('fast', function() {
    $('#overlay').css('z-index', 100);
    $('#overlay').css('opacity', 0.8);
    $('#overlay').css('background', '#000000');
    $('#boxpopup').css('display','block');
    $('#boxpopup').animate({'left':'30%'},500);
    });
}

function closeOffersDialog(prospectElementID) {
$(function($) {
    $(document).ready(function() {
        $('#' + prospectElementID).css('position','absolute');
        $('#' + prospectElementID).animate({'left':'-100%'}, 500, function()       {
            $('#' + prospectElementID).css('position','fixed');
            $('#' + prospectElementID).css('left','100%');
            $('#overlay').fadeOut('fast');
        });
    });
});
 } 
```

CSS

```
#wrapper a{
cursor:pointer;
font-size:15px;
font-weight:bold;
text-decoration:underline;
}

.box {
background-color: #ffffff;
color: #888888;
height: 205px;
left: 100%;
padding: 20px;
position: fixed;
right: 30%;
top: 25%;
width: 555px;
z-index: 101;
border:5px solid #888888;
border-radius:10px;
-moz-border-radius:10px;
}

.overlay {
/*background: #000000;*/
bottom: 0;
left: 0;
position: fixed;
right: 0;
top: 0;
z-index: -100;
/*opacity:0.5;*/
}

a.boxclose {
background: url("cancel.png") repeat scroll left top transparent;
cursor: pointer;
float: right;
height: 26px;
left: 32px;
position: relative;
top: -33px;
width: 26px;
} 
```

HTML

```
<body>
<!--<body onload="openOffersDialog();">-->
<div id="wrapper">
<div id="overlay" class="overlay"></div>

<a onclick="openOffersDialog();">Click Here To See The PopUp</a><button onclick="test();">TESTCLICK</button><button ontouchstart="test();">TESTTOUCH</button>
<div id="boxpopup" class="box">
<a onclick="closeOffersDialog('boxpopup');" class="boxclose"></a>
<div id="content">
Lorem ipsum dolor sit amet, consectetuer adipiscing elit. Aenean commodo ligula eget dolor. 
</div>
</div>
</div> 
```

任何帮助都会很棒，谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-06T22:10:58.327

JavaScript

```
function closeOffersDialog(prospectElementID) {
        $('#' + prospectElementID).css('position','absolute');
        $('#' + prospectElementID).animate({'left':'-100%'}, 500, function()       {
            $('#' + prospectElementID).css('position','fixed');
            $('#' + prospectElementID).css('left','100%');
            $('#overlay').fadeOut('fast');
        });
 } 
```

# c# - 发送电子邮件时出错 system.web.httpexceptions：消息无法发送到 smtp 服务器

> ID：10049714
> 
> 赞同：2
> 
> 时间：2012-04-06T21:59:20.243
> 
> 标签：c#, email, smtp

我的程序中有一个功能可以从谷歌帐户发送电子邮件。

我不久前写了这段代码，它曾经工作得很好，它按预期发送电子邮件。但是，现在我无法让它工作。（我现在正在使用 Windows 7 64 位，如果这会有所作为的话）。

我得到的错误（这是代码中的第一条错误消息）是：

> system.web.httpexceptions：消息无法发送到 smtp 服务器。传输错误代码为 0x80040217。服务器响应不可用--> system.reflection.targetinvocationexception：调用的目标已抛出异常。--> system.runtime.interopservice.comexception (0x80040211)：消息无法发送到 smtp 服务器。传输错误代码为 0x80040217。服务器响应不可用。

这是代码：

```
void sendEmail(string [] emailList, int emailLength, string fileName)
{
    int i = 0;      //variable to act as temporary index into emailList array
    try
    {
        try
        {
            MailMessage message = new MailMessage();
        //Because using google server, requires SSL
            message.Fields.Add("http://schemas.microsoft.com/cdo/configuration/smtpusessl", "true");
            message.Fields.Add("http://schemas.microsoft.com/cdo/configuration/smtpserverport", "465");
            message.Fields.Add( "http://schemas.microsoft.com/cdo/configuration/smtpauthenticate",1 );
            message.Fields.Add( "http://schemas.microsoft.com/cdo/configuration/sendusername","theusername@gmail.com" );
            message.Fields.Add( "http://schemas.microsoft.com/cdo/configuration/sendpassword","thepassword" );

            message.From = "theusername@gmail.com";
            message.To = emailList[i];

            //add Bcc
            while (++i < emailLength)
            {
                message.Bcc = emailList[i];
            }//end while

            message.Subject = "Test Subject";
            message.Body = "Test Body";

            MailAttachment fileAttach = new MailAttachment(fileName);
            message.Attachments.Add(fileAttach);

            try
            {       
                SmtpMail.SmtpServer = "smtp.gmail.com"; 
```

先感谢您！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-09-16T12:42:36.187

我遇到了同样的问题，但是当我使用未使用 Gmail 登录的两步验证的 Gmail 地址时解决了这个问题。如果您只使用密码而不进行额外验证（在我的情况下是通过手机代码），它可以工作

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-11-12T14:35:31.473

也许你被谷歌阻止了，因为你是从远程计算机中的程序发送的（这不是你通常使用的那个）尝试在运行该程序的同一台计算机上打开 gmail。，看看你是否有安全问题。

在 gmail 帐户上转到[https://www.google.com/settings/account](https://www.google.com/settings/account)并打开安全性并看到我 gmail 已阻止访问您的帐户

# symfony - 教义实体缺少分配的 ID

> ID：10049725
> 
> 赞同：0
> 
> 时间：2012-04-06T22:00:29.430
> 
> 标签：symfony, doctrine-orm

我有两个实体，联系人和全球。

```
Example\EventBundle\Entity\EventGlobal:
    type: entity
    table: EventGlobal
       fields:
          id:
              id: true
              type: integer
              generator:
                strategy: AUTO
  oneToOne:
      EventKontakt:
      targetEntity: Example\EventBundle\Entity\EventContact
      mappedBy: EventGlobal
      cascade: ["persist"]

Example\EventBundle\Entity\EventContact:
    type: entity
    table: EventContact
    fields:
      EventGlobal_id:
       id: true
       type: integer
      oneToOne:
        EventGlobal:
         targetEntity: Example\EventBundle\Entity\EventGlobal
         inversedBy: EventContact
         joinColumns:
           EventGlobal_id:
             referencedColumnName: id
             nullable: false 
```

他们工作正常。现在我用 Symfony 构建一个表单

```
 public function buildForm(FormBuilder $builder, array $options)
{
    $builder
        ->add(Stuff..)
        ->add('EventContact', new EventContactType($this->options))
    ;
} 
```

表单正确呈现，具有一对一的关系。但是当我保存时，我得到一个错误。

我的错误是：

```
 Entity of type Example\EventBundle\Entity\EventContact is missing an assigned ID. The identifier generation strategy for this entity requires the ID field to be populated before EntityManager#persist() is called. If you want automatically generated identifiers instead you need to adjust the metadata mapping accordingly. 
```

我怎样才能实现我的安全是由 Symfony/Doctrine 完成的？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-06T22:14:58.543

您需要为 EventContact 添加生成器。

为您的 EventContact 实体。

```
fields:
   EventGlobal_id:
   id: true
   type: integer
   generator:
       strategy: AUTO 
```

# c++ - 开发 C++ 访问冲突（分段错误）错误

> ID：10049729
> 
> 赞同：0
> 
> 时间：2012-04-06T22:00:41.333
> 
> 标签：c++

当我遇到错误时，我正在执行此代码。通过执行调试器，错误是“程序中出现访问冲突（分段错误）错误”。

```
/* Statcstr.cpp
* Le stringhe sono in realta' array static
*/
#pragma hdrstop
#include <condefs.h>
#include <string.h>
#include <iostream.h>
//---------------------------------------------------------------------------
#pragma argsused
int Modifica();
void Attesa(char *);
int main(int argc, char* argv[]) {
while( Modifica() );
Attesa("terminare");
return 0;
}
int Modifica() {
static unsigned int i = 0; // Per contare all'interno della stringa
char *st = "Stringa di tipo static\n";
if(i < strlen(st)) { // Conta i caratteri nella stringa
cout << st; // Stampa la stringa
st[i] = 'X'; //<--- THIS IS THE FAILING INSTRUCTION
i++; // Punta al prossimo carattere
return 1;
} else
return 0; // Indica che la stringa e' finita
}
void Attesa(char * str) {
cout << "\n\n\tPremere return per " << str;
cin.get();
} 
```

你能告诉我我该如何解决吗？非常感谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-06T22:02:07.353

修改字符串文字是未定义的行为。

```
char *st = "Stringa di tipo static\n";
           //this resides in read-only memory 
```

尝试将其声明为

```
char st[] = "Stringa di tipo static\n";
            //this is a string you own 
```

或者，由于这是 C++，您应该使用`std::string`.

# c++ - 一些帮助解释我的游戏的 GlowCode 配置文件

> ID：10049730
> 
> 赞同：0
> 
> 时间：2012-04-06T22:00:50.613
> 
> 标签：c++, windows, multithreading, profiling, glowcode

我们的前 3 个函数都显示为线程同步对象；大多数`WaitForSingleObject()`.

这个函数是否非常繁重，即使使用 0 调用只是检查线程的状态？非常关注这些函数的值在自时间中显示的时间比它所描述的任何其他值高 2 个数量级。或者也许 Glowcode 只是对这个函数感到害怕，因为当它看起来一大堆时，代码指针恰好在那里。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-07T02:58:31.873

首先，[***不要看自拍***](https://stackoverflow.com/questions/1777556/alternatives-to-gprof/1779343#1779343)。

它存在的唯一原因是因为有人可能会在他们自己的代码中编写花费太多时间在紧密 CPU 循环中的代码。您的程序是否花费所有时间反转矩阵或进行 FFT？

*发明gprof*的全部原因，以及随之而来的大量分析器，是真正的软件包含大量子程序，它们在大老鼠的巢穴中相互调用，到目前为止，花费太多时间的最简单方法是进行子程序调用这是可以避免的。自拍时间不会暴露那些。

接下来，无论您是查看 Wall 时间还是 CPU 时间，如果 WaitForSingleObject() 大部分时间都处于活动状态，则意味着您的线程主要在等待某些东西。你需要*找出什么*。

有一个非常简单的方法可以找出答案。只需按 Pause、Ctrl-C、Esc 或任何使其停止在轨道上的键，然后查看堆栈。调用堆栈上的每一行代码都代表一个未完成的请求，如果该请求没有发出，程序将不会等待。所以这就是你如何知道它在等待什么。

如果你碰巧在它不在 WaitForSingleObject() 中时抓住了它，请再做一次，也许几次。这似乎比分析更费力，但您可以选择查找问题或做一些简单的事情。

# android - 滚动文本视图

> ID：10049732
> 
> 赞同：1
> 
> 时间：2012-04-06T22:01:11.517
> 
> 标签：android

我有`TextView`一个`ViewGroup`. 中显示的文本`TextView`超出了 的宽度，`ViewGroup`并按预期剪裁。

我想要做的是`TextView`向左滚动以显示文本，并在文本结尾可见时停止。

但是，如果我使用 a `TranslationAnimation`，则将`TextView`其“翻译”到适当的位置，但`TextView`仍然会在其原始位置被剪裁，除了遵循与用于类似的模式之外，我找不到解决方法中的选框`TextView`。

我也看不到在选框对象中指定的方法，仅在文本可见时停止，所以我认为我可能需要创建自己的选框功能。

我还有其他选择吗？

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-06T22:34:15.853

你不能只`TextView`用水平滚动包装你`ScrollView`吗？

通常`TextView`由于屏幕用完而简单地被剪裁。A`ScrollView`应该确保您可以滚动到之前被剪辑的屏幕外部分。

# php - 这段代码有什么问题 [PHP Cookies]

> ID：10049736
> 
> 赞同：0
> 
> 时间：2012-04-06T22:01:31.503
> 
> 标签：php, cookies, login

我有这段代码，但是当我尝试加载页面时它是空白的：（我用 USERCOOKIEID 和 PASSCOOKIEID 替换了 cookie 的实际名称，并删除了用户登录时发生的代码）

```
if(isset($_COOKIE['USERCOOKIEID'])) { 
$user = $_COOKIE['USERCOOKIEID']; 
$pass = $_COOKIE['PASSCOOKIEID'];
$check = mysql_query("SELECT * FROM users WHERE username = '$user'")or die();
while($info = mysql_fetch_array($check)) {
    if ($pass != $info['password']) {           
    }else{
    //This is were the code goes for a user that is signed on
    }
}

}else{//what happens if they don't have the cookie
header("Location: login.php"); 
```

}

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-06T22:04:33.847

应该看起来像

```
if(isset($_COOKIE['USERCOOKIEID']))
{ 
    $user = $_COOKIE['USERCOOKIEID']; 
    $pass = $_COOKIE['PASSCOOKIEID'];
    $check = mysql_query("SELECT * FROM `users` WHERE `username`='$user'") or die();
    if (mysql_result($check, 0, 'passwordcolnum') == $pass) {
    } else {
        //This is were the code goes for a user that is signed on
    }
} else { //what happens if they don't have the cookie
    header("Location: login.php");
} 
```

也，而不是`mysql_fetch_array`，你为什么不使用`mysql_result`肯定只有一条记录

# java - 为什么这个静态java方法不是线程安全的？

> ID：10049737
> 
> 赞同：2
> 
> 时间：2012-04-06T22:01:39.073
> 
> 标签：java, static, thread-safety

以下方法不访问任何共享变量。它仍然不是线程安全的。我要么测试错了，要么我遗漏了一些东西。请解释。

方法：

```
public static boolean acquireFolderLock(File directoryPath) {
    final String LOCK_FILE_NAME = ".lock";
    boolean isLocked = false;
    if(directoryPath != null && directoryPath.isDirectory()) {
        File lockFile = new File(new StringBuilder(directoryPath.getAbsolutePath()).append(File.separatorChar).append(LOCK_FILE_NAME).toString());
        if(lockFile.exists()) {
            isLocked = false;
        } else {
            try {
                lockFile.createNewFile();
                isLocked = true;
            } catch(IOException ioex) {
                isLocked = false;
            }
        }
    }
    return isLocked;
} 
```

用于测试的线程类

```
class AThread extends Thread {
String name;
public AThread(String name) {
    this.name = name;
}

@Override
public void run() {
    File f = new File("C:\\TEMP\\DIRECTORY");
    System.out.println(name + ": " + Util.acquireFolderLock(f));
}
} 
```

以及启动线程的主要方法

```
public static void main(String[] args) throws Exception {
    for(int i = 1; i <= 100; i++) {
        (new AThread("Thread-->" + i)).start();
    }
} 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-06T22:08:04.497

该方法检查文件是否存在，然后创建它。这意味着当另一个线程正在执行时，一个线程可能已经完成了该语句`if (lockFile.exists())`（结果： ） （因此，它创建了锁定文件）。`false``lockFile.createNewFile();`

第一个线程现在基于不正确的信息继续：它认为该文件不存在，但它已由另一个线程创建。

线程安全不仅仅关乎共享变量，还关乎共享资源（变量、数据库、文件系统、网络连接等）。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-06T22:06:25.363

“静态”是一个包含文件系统的术语。仅仅因为没有明确共享变量并不意味着*文件系统*不在线程之间共享。

访问文件系统，就像您在这里所做的那样，与访问共享变量一样糟糕，并且需要相同的技术来确保线程安全。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-06T22:11:16.457

根据 javadocs for File.createNewFile() [http://docs.oracle.com/javase/6/docs/api/java/io/File.html#createNewFile](http://docs.oracle.com/javase/6/docs/api/java/io/File.html#createNewFile) ()

> 注意：此方法不应用于文件锁定，因为生成的协议不能可靠地工作。应该改用 FileLock 工具。

所以你应该使用 java.nio.channels.FileLock，它是线程安全的。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-06T23:08:46.130

你应该检查 lockFile.createNewFile() 的返回值，你不需要检查 lockFile.exists()

```
true if the named file does not exist and was successfully created; false if the named file already exists 
```

此外，根据您的用例，nio FileLock 可能比使用 createNewFile 更不可靠。我认为 nio FileLock 在 NFS 上被破坏了。我不确定 javadocs 中的不可靠是什么意思，但 createNewFile 的一个问题是当你崩溃时你会离开锁。不过，这可能是一项功能而不是错误，具体取决于您的用例。

# ruby-on-rails - 在 Rails 模型中“重载”字段的最佳方法是什么？

> ID：10049744
> 
> 赞同：2
> 
> 时间：2012-04-06T22:02:50.167
> 
> 标签：ruby-on-rails, ruby-on-rails-3, model-view-controller, model, overloading

考虑一个模型用户：

```
User(id: integer, name: string, email: string, status: string) 
```

当我构建应用程序时，状态是数据库中的一个字段。但是新的要求意味着改变，因此在某些情况下动态计算状态。例如，在星期天，如果他们的姓氏以 A 开头，那么他们的状态是“不正常”。

我想将此功能封装在 User 模型中，***如下所示***：

```
Class User < ActiveRecord::Base

  def status
    if is_sunday && last_name.starts_with('A')
        return 'not ok'
    else
       return status
    end
  end

end 
```

做这个的最好方式是什么？如果上面的代码确实有效，那么用方法覆盖数据库中的字段似乎是不好的做法。

或者，我可以创建一个方法`get_status`来使用上述代码。但在这种情况下，我需要更改`status`整个应用程序中的每个引用。这听起来不太好。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-06T22:49:55.187

我在[ActiveRecord::Base 文档](http://api.rubyonrails.org/classes/ActiveRecord/Base.html#label-Overwriting+default+accessors)中看到您可以覆盖 ActiveRecord 提供的默认访问器。当然，您不能`status`像以前那样使用，因为它使该方法有些递归。

您可以使用`read_attribute(:attribute_name)`或者`self[:attribute_name]`如果您愿意，可以访问数据库中的列值。长话短说，你的访问者变成了：

```
Class User < ActiveRecord::Base
  def status
    if is_sunday && last_name.starts_with('A')
      'not ok'
    else
      read_attribute(:status)
    end
  end
end 
```

**更新**：我已经尝试过它并且它有效，但请注意，因为如果您不明确调用此方法，您将获得数据库内容......例如，您尝试查询`users`表以查找用户`status = "not ok"`可能会有惊喜。

# java - 尽可能将变量定义为“本地”是否会使实现更快？

> ID：10049746
> 
> 赞同：1
> 
> 时间：2012-04-06T22:03:05.687
> 
> 标签：java, performance, coding-style

在编程时，我经常会遇到以下场景（在代码中描述）。我在要使用的块中定义变量。

```
 int maximumLengthOfToken = 0;

    while(fileScanner.hasNextLine())
    {
       String line; // definition
       line = fileScanner.nextLine();

       Scanner lineScanner; // definition
       lineScanner = new Scanner(line);

       String token = lineScanner.next(); // definition and assignment
       if(stringToMatch.endsWith(token))
        {
                 if(token.length() >= maximumLengthOfToken )
                  {
                     maximumLengthOfToken = token.length();  
                     builder.append(line);
                     builder.append("\n\n\n");
                  }
        }
    }
    fileScanner.close(); 
```

然而，有时，为了“整洁”，也因为我来自 C 背景，我喜欢在顶部定义所有变量，无论它们在哪里使用。所以我做了以下 -

```
 int maximumLengthOfToken = 0;
    String line; // definition
    Scanner lineScanner; // definition
    String token; // definition

    while(fileScanner.hasNextLine())
    {
       line = fileScanner.nextLine();
       lineScanner = new Scanner(line);

       token = lineScanner.next(); // definition

               if(stringToMatch.endsWith(token))
                {
                 if(token.length() >= maximumLengthOfToken )
                  {
                     maximumLengthOfToken = token.length();  
                     builder.append(line);
                     builder.append("\n\n\n");
                  }
        }
    }
    fileScanner.close(); 
```

“啊！它看起来很整洁”，我想。

但是，这对代码的性能有什么影响吗？第一种风格会导致更快的代码执行还是第二种风格？另外，在这种情况下，约定是什么？我相信这是第一种风格。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-06T22:05:05.790

不会。不会有性能差异。

如果您对此表示怀疑，请问问自己：“如果我的变量在 2000 字节之外，计算机查找我的变量会比在 200 字节或 20 字节之外需要更长的时间吗？” 答案应该是否定的。

唯一*可能*产生影响的情况是，如果您的变量在使用之前从处理器缓存中退出[（请参阅局部性）](http://en.wikipedia.org/wiki/Locality_of_reference)，在这种情况下，将变量移动到更靠近使用它的位置*可能会*提高速度。但是在变量和它的使用之间需要大量的代码才能实现。

编译器也有可能将您的方法编译为相同的字节码。简而言之，我认为您不必担心。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-06T22:46:00.990

正如其他人所说，没有显着的性能差异。

您想在将变量声明放在方法顶部和将它们放在使用它们的位置之间进行选择。不要强迫自己做出这样的选择。你可以两者兼得——通过使你的方法非常简短。当您发现自己面临这种选择时，请将其视为您的代码告诉您：“您的方法太长了。”

更短的方法更容易编写、更容易测试、更容易调试、更容易维护。如果您没有（比如说）10 行以上的方法，您将永远不会遇到这个问题——并且您将拥有更好的组织代码。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-06T22:05:10.247

这可能对代码的性能没有任何影响——我希望生成的字节码是相同的——但第一个版本通常被认为更易于维护和可读。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-06T22:07:36.600

在一般情况下，可能会有轻微的（有时甚至是巨大的）差异，但在 Java 的情况下，标准编译器链很可能不会。

编译器可能会有所不同的是，您在一个范围内定义了“varA”，而在不相交的范围内定义了“varB”。编译器可能会观察到范围是不相交的，并将相同的堆栈槽分配给两者，这非常非常轻微地提高了解释器的性能。但是，如果它不够聪明，无法弄清楚发生了什么，这种技术可能会在 JITC 中导致更糟糕的优化。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-04-06T22:38:02.797

由于在现代 Java 实现中使用了运行时优化，您应该不会看到太大的差异。因此，您应该主要关注清晰度和易于维护。

也就是说，有几个充分的理由将变量声明为尽可能接近使用位置：

*   它更容易阅读，尤其是对于非常短暂的（例如临时）变量。读者可以立即看到变量的类型，而无需向上滚动到方法的开头。

*   通过尽可能地限制变量的范围，您可以减少例如重用循环计数器时出现意外错误的可能性。

*   当变量的范围尽可能有限时，一些优化（例如逃逸分析）可能会执行得更好。

作为旁注，我同时使用 C 和 Java 编程，*有时*很难从一个上下文切换到另一个。但是，在 Java 中使用 C 风格的约定（反之亦然）并不是一个好主意。C 约定是由 Java 根本没有的限制决定的——使用它们只会使您的代码更难被其他人阅读。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-04-07T00:26:00.677

关于变量范围的最大“性能”差异将在垃圾收集中。在本地声明变量可能会允许 GC 更快地收集未使用的变量。

# python - 构造函数继承自 python

> ID：10049755
> 
> 赞同：1
> 
> 时间：2012-04-06T22:04:03.380
> 
> 标签：python

我做了一个看起来像的类。

```
class NewInt:
  def __init__(self, x,y):
    self.holders = {"x":x,"y":y} 
```

现在，我有一个数字说字典。所以一切都是一样的

除了它不是 NewInt 而是一个 dict.Somethng 像

```
 A  {"x": 3,"y":4} 
```

所以它完全是 NewInt 类型，除了它是一个字典。

有没有办法我可以做类似的事情

```
this_int = NewInt(A) 
```

我忘记了，但是这样的构造函数有一个特殊的名字来完成赋值？？谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-06T22:09:03.677

您可以使用[关键字参数](http://docs.python.org/tutorial/controlflow.html#keyword-arguments)：

```
A = {"x": 3,"y":4}
this_int = NewInt(**A) 
```

顺便说一句，看起来您正在重新实现[复数](http://docs.python.org/library/stdtypes.html#typesnumeric)。这些已经内置到 Python 中，请尝试`complex(3,4)`或`3+4j`.

# ruby - 如何在 ruby 测试单元中使用验证

> ID：10049758
> 
> 赞同：0
> 
> 时间：2012-04-06T22:04:25.870
> 
> 标签：ruby, unit-testing, selenium, webdriver

所以我总是使用 perl 编写脚本，但尝试使用 Ruby，所以这个问题可能听起来很傻，但我会尝试一下。

我正在用 ruby​​ Test::Unit 编写 Selenium Webdriver 脚本 下面是一些示例代码。

```
 def test_runit
    @driver.get(@base_url + "/")
    @driver.find_element(:id, "gbqfq").clear
    @driver.find_element(:id, "gbqfq").send_keys "selenium"
    @driver.find_element(:id, "gbqfb").click
    @driver.find_element(:link, "Selenium - Web Browser Automation").click
    assert(@driver.find_element(:tag_name => "body").text.include?("administration tasks"),"the assert works")
    @driver.find_element(:link, "Support").click
  end 
```

带输出

```
 ruby runit.rb 
Loaded suite runit
Started
.
Finished in 9.732149 seconds.

1 tests, 2 assertions, 0 failures, 0 errors 
```

在测试时，我需要检查页面上是否存在文本。使用`assert`效果很好。但是，如果它失败了，测试就会在那里结束，并且不会继续进行。

在 perl 中，我可以给你一些类似的 `verify`东西，它基本上将某事标记为失败并继续前进。

我希望得到这样的结果

```
ruby runit.rb 
Loaded suite runit
Started
.
Finished in 9.732149 seconds.

1 tests, 1 assertion, 1 failure, 0 errors 
```

但是验证不适用于 ruby​​ 测试单元，或者可能是我做错了。

有人可以给我一些示例代码吗？谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-09T14:47:46.400

知道了！！需要使用救援。感谢您的回复。

```
begin
    assert(@driver.find_element(:tag_name => "body").text.include?("text to check"),"the assert works")
rescue Test::Unit::AssertionFailedError
    @verification_errors << $!
end 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-14T04:49:32.877

确实是的。你需要拯救命令。

但是，您可以在测试助手中轻松创建类似于此的验证方法

```
 def verify
   $verification_errors = [] if $verification_errors.nil?
   assert yield
 rescue Test::Unit::AssertionFailedError => afe
   $verification_errors << afe
   puts "ERROR: #{afe.message}"
 end 
```

然后你可以这样称呼它：

```
 verify{ @driver.find_element(:tag_name => "body").text.include?("foobar") } 
```

在测试结束时，在拆卸期间，您需要检查是否有任何验证错误：

```
 assert $verification_errors.empty? or $verification_errors.nil? 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-06T22:45:34.757

我没有听说 Ruby 有类似于 perl 的“验证”功能，因为“断言”意味着，如果为假，程序会立即停止。

我建议你重新实现你的代码并给它一个“nil guard”：

```
body_element = @driver.find_element(:tag_name => "body")
if body_element
  assert(body_element.text.include?("administration tasks"),"the assert works")
end 
```

# c++ - 在控制台 mfc 程序中检测转义键

> ID：10049764
> 
> 赞同：1
> 
> 时间：2012-04-06T22:04:56.007
> 
> 标签：c++, visual-studio, mfc, console-application

我正在 Visual Studio 11 (beta) 中编写一个控制台 mfc 应用程序的小程序。我以前从未为这种环境编程过，我正试图弄清楚如何检测控制台中的 Escape 键按下。我已经广泛地查看了在线资源并尝试了许多不同的东西，但无法弄清楚。

这是我试图看看我是否能让它工作的东西。

```
printf("Press Escape to exit.");
bool maxReached = true;
while (maxReached)
{
    if(WM_COMMAND == IDCANCEL) // Tried many different things here, like WM_KEYDOWN == VK_ESCAPE. no luck
    {
        maxReached = false;
    }
}
exit(-1); 
```

任何帮助将非常感激。

卡迈勒

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-06T22:42:36.600

您可以检测使用

```
if (getch() == 0x1B) // escape detected
{
  maxReached = false;
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-07T16:08:52.387

您始终可以安装键盘挂钩并检查是否按下了 ESC 键。
就是这样：

一、安装挂钩

```
HHOOK hhkLowLevelKybd;    
HINSTANCE hInstance = GetModuleHandle(NULL);

// Install the low-level keyboard hook
hhkLowLevelKybd  = SetWindowsHookEx(WH_KEYBOARD_LL,
                LowLevelKeyboardProc,
                hInstance,
                NULL ); 
```

接下来，让 LowLevelKeyboardProc 执行您的例程以响应 ESC 键：

```
_declspec(dllexport) LRESULT CALLBACK LowLevelKeyboardProc( int nCode, WPARAM wParam, LPARAM lParam)
{
    if (nCode == HC_ACTION)
    {
         PKBDLLHOOKSTRUCT p = ( PKBDLLHOOKSTRUCT ) lParam;
         switch (wParam)
         {
            case WM_KEYUP:
            case WM_SYSKEYUP:
                switch (p->vkCode)
                {
                   case 0x1B: //OR VK_ESCAPE
                       maxReached = false;
                       break;
                   default:
                       break;
                }
                break;
            default:
                break;
         }
     }
     return(CallNextHookEx( NULL, nCode, wParam, lParam ));
} 
```

# java - 在多对多表中插入之前休眠选择多列

> ID：10049773
> 
> 赞同：0
> 
> 时间：2012-04-06T22:05:58.490
> 
> 标签：java, hibernate

我有两个 Entity`Customer`和`Product`with relation `many-to-many`。

`

```
@ManyToMany(cascade = CascadeType.MERGE, fetch=FetchType.LAZY)
    @JoinTable(
            name = "customer_products",
            joinColumns={@JoinColumn(name="customer_id")},
            inverseJoinColumns = {@JoinColumn(name="product_id")}) 
    @CollectionId(
            columns = @Column(name="id"),
            type = @Type(type="long"),
            generator = "native"
    )
    public Collection<Product> getProducts() {
        return products;
    }
    public void addProduct(Product product){
        this.products.add(product);
    }
    public void setProducts(Collection<Product> products) {
        this.products = products;
    } 
```

`

我想添加客户产品

`

```
 Customer customer = (Customer)session.load(Customer.class, new Long(1));
    Product product = (Product) session.load(Product.class, new Long(1));
    customer.addProduct(product);
    session.persist(customer);` 
```

代码所做的是，它从表中选择所有列，`Customer`并`Products`仅从`ids`这些表中插入到`customer_products`表中。有没有办法只`ids`从上面的表格中选择？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-06T22:48:01.760

可以从列中检索单独的实体数据，而无需使用 JPA/Hibernate 实例化整个实体对象。

这将与一对一完美匹配，但不确定多对多关系：

```
CriteriaBuilder cb = entityManager.getCriteriaBuilder();
CriteriaQuery<Object[]> q = cb.createQuery(Object[].class);
Root<Customer> c = q.from(Customer.class);
q.select(cb.array(c.get("id"), c.get("products").get("id")));

List<Object[]> results = em.createQuery(q).getResultList();
for (Object[] result : results) {
  System.out.println("Customer id: " + result[0] + ", Product id: " + result[1]);
} 
```

仍然值得一试，可能会让你走上正轨。[查找有关 JPQL 和 CriteriaBuilder 查询的更多信息。](http://www.objectdb.com/java/jpa/query/jpql/select)

顺便说一句，如果你能提供你为什么需要这样做的理由，也许我们可以从新的角度提供一个替代解决方案，因为现在我们看不出为什么需要这样做。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-06T22:24:26.653

`not null`它只是将 id 插入表中，因为这就是您在实体上设置的所有内容，并且您对其他列没有任何约束。没有办法处理`Customer`或`Product`直接获取他们的 id 而没有其他数据。这只是 ORM 的一部分。

但是，您可以使用[本机 SQL 查询](http://docs.jboss.org/hibernate/orm/3.3/reference/en/html/querysql.html#querysql-creating)从数据库中选择单条数据。 [这个人](https://stackoverflow.com/questions/4969258/select-one-column-from-a-row-in-hibernate/4970203#4970203)也提供了一个很好的 SQLQuery 用法示例。

***编辑***

重新阅读您的问题后，我意识到您说的是 ids 被插入到`customer_product`表中。所以我的第一段并不正确。它只是插入 id，因为您只是向客户添加产品，这就是您的交叉引用表。

但是，解决方案是相同的。如果您只想从`customer`or中选择 id `product`，则需要使用 SQL 查询。如果您想`customer_product`直接从中选择 id（这有点奇怪），您需要使用 SQL 查询或创建一个`CustomerProduct`对象（这会更奇怪）。

# ruby-on-rails - Searchlogic 的可行替代品是什么？

> ID：10049774
> 
> 赞同：3
> 
> 时间：2012-04-06T22:06:01.500
> 
> 标签：ruby-on-rails, ruby, search, searchlogic, meta-search

[Searchlogic](https://github.com/binarylogic/searchlogic)似乎不适用于 Rails 3。（除其他外，Ryan Bates 在他的 RailsCasts 中提到过，[Google Group](https://groups.google.com/forum/?fromgroups#!forum/searchlogic)中的最后一个问题来自 2010 年。）

所以我正在寻找替代品。我喜欢您制作搜索表单的字段名称并将其转换为 Search 对象的功能，然后您可以使用`@search.all`or获得结果`@search.paginate`。

起初，[Meta Where](http://erniemiller.org/projects/metawhere/)和[Meta Search](http://erniemiller.org/projects/metasearch/)看起来很有希望。但后来我发现[这个](https://github.com/ernie/meta_where)通知“MetaWhere 将不会更新以支持 3.1”。（我使用的是 Rails 3.2.2。）

开发人员[提议使用一个名为“Ransack”的库](http://erniemiller.org/2011/08/31/rails-3-1-and-the-future-of-metawhere-and-metasearch/#more-978)来替代 MetaWhere。

好吧，也许吧。但在我深入研究“Ransack”之前，我想我应该把问题放在那里：有没有人知道另一个库与我上面描述的 SearchLogic 具有类似的功能？（视图表单填充一个搜索对象。）

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-07T02:02:32.607

如果您使用的是 Rails 3.0，您应该查看[MetaSearch](https://github.com/ernie/meta_search)

如果您使用的是 Rails 3.1+，您应该查看[Ransack](https://github.com/ernie/ransack)

两者都是厄尼米勒写的。

# asp.net - 当 .NET 中发生部分回发时，用户控件中的 Javascript 不会触发

> ID：10049777
> 
> 赞同：4
> 
> 时间：2012-04-06T22:06:20.983
> 
> 标签：asp.net, user-controls, updatepanel, partial-postback

我试图了解一些关于使用更新面板的部分回发的信息，虽然很多事情都让我感到困惑，但这个让我感到困惑。

我在 UpdatePanel 中使用选项卡，因为这是一个数据输入应用程序，所以我将内容放入用户控件中，因此每个选项卡都有自己的用户控件。此外，我正在向每个用户控件添加自定义 javascript，以处理该控件中内容的特定客户端事务。

在这样做时，虽然我注意到用户控件中的 javascript 不会在部分页面回发时触发。

为了模拟这一点，我在 VS2010 中创建了一个非常简单的应用程序（在母版页上使用带有 ScriptManager 控件的母版页）。

默认页面的内容面板有以下内容

```
<asp:UpdatePanel runat="server" UpdateMode="Conditional" ChildrenAsTriggers="true">
<ContentTemplate>
   <asp:Button runat="server" ID="Button1" Text="Partial postback" />
   <br />
   <asp:Panel runat="server" ID="panel"></asp:Panel>
</ContentTemplate>
</asp:UpdatePanel> 
```

然后我创建了一个用户控件并简单地添加了一些纯文本和一个 javascript 警报

```
<%@ Control Language="vb" AutoEventWireup="false" CodeBehind="UC1.ascx.vb" Inherits="TestWebApp_VB.UC1" %>
This is user control 1
<script> alert('control 1'); </script> 
```

然后在内容页面的页面加载事件中，我将控件加载到面板中。

```
 Panel.Controls.Add(LoadControl("UC1.ascx")) 
```

此外，在按钮的单击处理程序上，我还加载了控件（或切换时的不同控件，如进一步所述）

```
Button_Click
 Panel.Controls.Clear()
 Panel.Controls.Add(LoadControl("SomeControl.ascx")) 
```

因此，当页面第一次加载时，警报会触发，但是当您单击按钮并且页面被部分回发时，警报永远不会触发。

我向前迈了一步，创建了第二个用户控件，并让按钮切换加载控件，并在 UpdatePanel 之外添加了一个普通按钮。每当我进行完整回发时，加载的用户控件中的 javascript 都会触发，但它不会在部分回发时触发。

然后我向前迈了一步，将控件中的 javascript 移动到一个函数中，这样我就可以从 PageRequestManager 或 document.ready 调用该函数。

所以现在我的两个控件包含这个脚本（警报包含每个控件的不同消息）

```
<script type="text/javascript">
  function userLoad() {
    alert("Identify control");
  }
</script> 
```

因此，我将其添加到内容面板的末尾

```
<script type="text/javascript">
   var prm = Sys.WebForms.PageRequestManager.getInstance().add_endRequest(userLoad);
</script> 
```

好吧，现在每个部分回发都会触发 javascript，但是它会触发最后一次由完整回发加载的控件的 javascript。

例子：

1.  页面最初加载 UserControl1 - UserControl1 的警报触发（此处未显示 - 在 jquery document.ready 中调用 userLoad 函数）

2.  用户点击按钮 - 应该加载 UserControl2

3.  UserControl2 已加载到屏幕上，但会触发 UserControl1 的警报

有点罗嗦，为此道歉，我发现没有简单的方法来解释这一点。

- -编辑 - -

我尝试过的其中一件事是使用 Scotts 的建议。将每个控件的 javascript 保存在一个单独的文件中，并将其全部放入一个名为 function UC1Load() {} 之类的函数中（如果我觉得很活泼，可能会在它周围贴上一个命名空间），添加对脚本文件的引用内容页面通过

```
<script src='UC1.js'> 
```

然后注册启动脚本来调用这个函数

```
 ScriptManager.RegisterStartupScript(ctrl, ctrl.GetType(), "UserJS", "UC1Load()", True) 
```

最大的问题是我现在必须下载一堆永远不会使用的脚本，这就是我首先将脚本放在用户控件中的原因。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-07T02:41:11.853

您可以采用的另一种方法是使用 jQuery 的[`.on()`](http://api.jquery.com/on/)方法。

> 当提供选择器时，事件处理程序被称为委托。当事件直接发生在绑定元素上时，不会调用处理程序，而只会调用与选择器匹配的后代（内部元素）。jQuery 将事件从事件目标冒泡到附加处理程序的元素（即，从最内到最外的元素），并为沿该路径匹配选择器的任何元素运行处理程序。
> 
> 事件处理程序仅绑定到当前选定的元素；当您的代码调用 .on() 时，它们必须存在于页面上。
> 
> ...
> 
> 委托事件的优点是它们可以处理来自以后添加到文档的后代元素的事件。通过选择在附加委托事件处理程序时保证存在的元素，您可以使用委托事件来避免频繁附加和删除事件处理程序的需要。例如，该元素可以是模型-视图-控制器设计中视图的容器元素，或者如果事件处理程序想要监视文档中的所有冒泡事件，则可以是文档。在加载任何其他 HTML 之前，文档元素在文档的头部是可用的，因此在此处附加事件是安全的，而无需等待文档准备好。

因此，例如，您可以使用相同的类将 UserControls 与 div 一起包装，如下所示：

## 用户控件 1

```
<div class="userControl">
    <span>This is UserControl 1</span>
</div> 
```

## 用户控制 2

```
<div class="userControl">
    <span>This is UserControl 2</span>
</div> 
```

然后，在您的 MasterPage 中，在您的标记之前的最底部`</body>`，包含您的 jQuery 引用和您的 jQuery 脚本。在我的示例中，我在单击 时打印出`<span />`UserControl 内部的内容`<span />`。

## jQuery

```
 <script src="//ajax.aspnetcdn.com/ajax/jQuery/jquery-1.7.2.min.js"></script>
    <script>
        $("div[id$=UpdatePanel1]")
            .on("click", "div.userControl span", function() { 
                alert($(this).html().trim()); 
            });
    </script>
</body>
</html> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-07T00:26:19.520

好的，在创建了我自己的测试网站并进行了修改之后，这就是我要工作的内容：

## 测试控制1

```
<%@ Control Language="C#" 
            AutoEventWireup="true" 
            CodeFile="TestControl1.ascx.cs" 
            Inherits="Controls_TestControl1" %>

This is Test Control 1 
```

## 测试控制2

```
<%@ Control Language="C#" 
            AutoEventWireup="true" 
            CodeFile="TestControl2.ascx.cs" 
            Inherits="Controls_TestControl2" %>

This is Test Control 2 
```

## 10049777.aspx

```
<%@ Page Language="C#" 
         MasterPageFile="~/Site.master" 
         AutoEventWireup="true" 
         CodeFile="10049777.aspx.cs" 
         Inherits="_10049777" %>

<asp:Content ID="Content1" ContentPlaceHolderID="HeadContent" runat="Server" />
<asp:Content ID="Content2" ContentPlaceHolderID="MainContent" runat="Server">
    <asp:UpdatePanel ID="UpdatePanel1" runat="server" 
        UpdateMode="Conditional" 
        ChildrenAsTriggers="true">
        <ContentTemplate>
            <asp:Button ID="Button1" runat="server"
                Text="Partial postback" 
                OnClick="Button1_Click" />
            <br /><br />
            <asp:Panel runat="server" ID="Panel1" />
        </ContentTemplate>
    </asp:UpdatePanel>
</asp:Content> 
```

## 10049777.aspx.cs

```
protected void Page_Load(object sender, EventArgs e)
{
    if (!IsPostBack)
    {
        var TestControl1 = LoadControl("Controls\\TestControl1.ascx");

        Panel1.Controls.Add(TestControl1);
        ScriptManager.RegisterStartupScript(TestControl1, 
                                            TestControl1.GetType(), 
                                            "TestControl1Script", 
                                            "alert(\"control 1\");", 
                                            true);
    }
}

protected void Button1_Click(object sender, EventArgs e)
{
    var TestControl2 = LoadControl("Controls\\TestControl2.ascx");

    Panel1.Controls.Clear();
    Panel1.Controls.Add(TestControl2);

    ScriptManager.RegisterStartupScript(TestControl2, 
                                        TestControl2.GetType(), 
                                        "TestControl2Script", 
                                        "alert(\"control 2\");", 
                                        true);
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-08T03:51:05.980

为内联脚本问题找到了一个很好的解释

[http://veskokolev.blogspot.com/2009/03/inline-scripts-in-updatepanel-doesnt.html](http://veskokolev.blogspot.com/2009/03/inline-scripts-in-updatepanel-doesnt.html)

简而言之：部分回发会更新更新面板的 innerHtml，因此它将 html 的 blob 视为纯文本，因此不会在 html 中注册任何脚本标签。

所以我的最终解决方案是这样的。

每个控件都有一个自己的 javascript 文件，其函数名称类似于

```
function controlNameLoad() { ..do your stuff } 
```

内容面板代码内部（在判断要加载哪个控件的 case 语句内部）

```
dim ctrl = LoadControl("UCName.ascx")
panel.Controls.Add(ctrl)
ScriptManager.RegisterClientScriptInclude(ctrl, ctrl.GetType(), "UserJS", "UCName.js")
ScriptManager.RegisterStartupScript(ctrl, ctrl.GetType(), "UserJS", "controlNameLoad()", True) 
```

这适用于我的测试项目，稍后会看到我是否可以实现到我的真实代码中。

# php - 如何在动态网站的 LESS 中设置变量？

> ID：10049778
> 
> 赞同：2
> 
> 时间：2012-04-06T22:06:23.763
> 
> 标签：php, javascript, css, html, less

我在前端使用**LESS** / Bootstrap，在服务器端使用**PHP 。**我想使用服务器端脚本为页面上的许多不同元素**生成不同的颜色**（想想彩虹）。

我想做的是在 PHP 中创建两个变量`@startcolor`，并`@endcolor`使用这些变量在 LESS 中应用渐变。所以我想做的是这样的：

在 HTML 中：

```
<div style="@startcolor: rgb(1,2,3); @endcolor: rgb(4,5,6)">...</div> 
```

不到：

```
.buttonBackground(@startcolor, @endcolor); 
```

在 CSS 中它工作得很好，我可以简单地使用样式标签覆盖任何样式。我的问题是，到目前为止，我发现无法使用内联样式标记在 LESS 中设置变量。

为了更好地理解我想要实现的目标，请查看此[测试页面](http://zerodev.net/temp/less-inline/)。我想做的是将背景渐变设置为随机颜色，就像我现在设置文本颜色一样。

如果无法使用服务器端技术，**是否可以使用 JS？**

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-06T22:08:37.817

不，LESS.js 只解析`stylesheet/less`资源文件，所以显然你不能内联。

# php - strstr() 可以用于在句子中查找 2 个单独的关键字吗？

> ID：10049783
> 
> 赞同：0
> 
> 时间：2012-04-06T22:07:07.740
> 
> 标签：php

strstr() 可以用于在句子中查找 2 个单独的关键字吗？

前任：

```
$sentence = 'the quick brown fox';

if (strstr($sentence, 'brown') && strstr($sentence, 'fox')) {
   echo 'YES';
} else {
   echo 'NO';
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-06T22:13:11.323

是的，它可以...您拥有的脚本将返回`YES`..总是因为`strstr`用于查找字符串的第一次出现及其独立于其他声明的工作..它能够 在 2 个不同的第一次出现实例中找到`brown`AND`fox`

他们是如何工作的

```
strstr($sentence, 'brown') // Returns 'brown fox' 
strstr($sentence, 'fox') // Returns 'fox' 
```

两个结果都是有效的字符串

如果你试试

```
var_dump(strstr($sentence, 'fish')); // Returns false 
```

现在这不是检查字符串的有效方法，但有它自己的用途

文档： http: [//php.net/manual/en/function.strstr.php](http://php.net/manual/en/function.strstr.php)

**编辑 1**

```
$sentence = 'the quick brown fox';
$keywords = array (
        'brown',
        'fox' 
);

echo "<pre>"; 
```

`preg_match` [http://php.net/manual/en/function.preg-match.php](http://php.net/manual/en/function.preg-match.php)

例子

```
$regex = '/(' . implode ( '|', $keywords ) . ')/i';

if (preg_match ( $regex, $sentence )) // Seach brown or fox
{
    echo "preg_match brown or fox" . PHP_EOL;
} 
```

这一切都取决于您的用例

`strpos()`- 查找 astring 中子字符串第一次出现的位置

`stripos()`- 查找字符串中第一次出现不区分大小写的子字符串的位置

`strrpos()`- 查找字符串中子字符串最后一次出现的位置

`strrchr()`- 查找字符串中最后一次出现的字符

例子

```
if (strpos ( $sentence, $keywords [0] ) || strpos ( $sentence, $keywords [1] )) {
    echo "strpos brown OR fox " . PHP_EOL;
}

if (strripos ( $sentence, $keywords [0] ) && strpos ( $sentence, $keywords [1] )) {
    echo "strpos brown AND fox " . PHP_EOL;
} 
```

我希望这有帮助

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-06T22:08:47.720

这取决于您使用它的目的。从外观上看，您应该使用`strpos`，而不是`strstr`.

# wordpress - Wordpress 自动更新插件/软件

> ID：10049788
> 
> 赞同：-1
> 
> 时间：2012-04-06T22:02:09.917
> 
> 标签：wordpress

有人知道除了managewp之外的软件或插件来更新一堆博客+插件，它也能正常工作吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-06T22:26:03.637

假设您在 WordPress 中启用了[博客网络](http://codex.wordpress.org/Create_A_Network)功能，您应该能够在更新 WordPress 核心文件后立即更新所有博客。更新站点后，您可以从网络插件管理部分一次更新所有插件。

# python - 为什么 django admin 无法正确打开？

> ID：10049789
> 
> 赞同：0
> 
> 时间：2012-04-06T22:07:48.047
> 
> 标签：python, django

我正在使用[django-userena](https://github.com/bread-and-pepper/django-userena)，如果您使用`pip`一切顺利安装它，但是如果您手动安装它然后键入`python setup.py install`管理区域不会像它应该那样打开![在此处输入图像描述](../Images/a9bdec1c425ccb1ffc8e1b07962a99dd.png)

* * *

![在此处输入图像描述](../Images/5696467f802be55afdcc721e1df9ef3b.png)

**设置.py**

```
 import os, sys

    abspath = lambda *p: os.path.abspath(os.path.join(*p))

    PROJECT_ROOT = abspath(os.path.dirname(__file__))
    USERENA_MODULE_PATH = abspath(PROJECT_ROOT, '..')
    sys.path.insert(0, USERENA_MODULE_PATH)

    DEBUG = True
    TEMPLATE_DEBUG = DEBUG

    ADMINS = (
        # ('Your Name', 'your_email@domain.com'),
    )

    MANAGERS = ADMINS

    DATABASES = {
        'default': {
            'ENGINE': 'django.db.backends.sqlite3',
            'NAME': 'demo_project.db',
            'TEST_NAME': ':memory:',
        }
    }

    if DEBUG:
        # Use the Python SMTP debugging server. You can run it with:
        # ``python -m smtpd -n -c DebuggingServer localhost:1025``.
        EMAIL_PORT = 1025

    TIME_ZONE = 'America/Chicago'
    LANGUAGE_CODE = 'en-us'

    ugettext = lambda s: s
    LANGUAGES = (
        ('en', ugettext('English')),
        ('nl', ugettext('Dutch')),
        ('fr', ugettext('French')),
        ('pl', ugettext('Polish')),
        ('pt', ugettext('Portugese')),
        ('es', ugettext('Spanish')),
    )

    SITE_ID = 1

    USE_I18N = True
    USE_L10N = True

    MEDIA_ROOT = abspath(PROJECT_ROOT, 'media')
    DOCUMENT_ROOT = abspath(PROJECT_ROOT, 'docs')

    MEDIA_URL = '/media/'

    ADMIN_MEDIA_PREFIX = '/media/admin/'

    SECRET_KEY = 'sx405#tc)5m@s#^jh5l7$k#cl3ekg)jtbo2ds(n(kw@gp0t7x@'

    TEMPLATE_LOADERS = (
        'django.template.loaders.filesystem.Loader',
        'django.template.loaders.app_directories.Loader',
    )

    MIDDLEWARE_CLASSES = (
        'django.middleware.common.CommonMiddleware',
        'django.contrib.sessions.middleware.SessionMiddleware',
        'django.middleware.locale.LocaleMiddleware',
        'django.middleware.csrf.CsrfViewMiddleware',
        'django.contrib.auth.middleware.AuthenticationMiddleware',
        'django.contrib.messages.middleware.MessageMiddleware',
        'userena.middleware.UserenaLocaleMiddleware',
    )
    TEMPLATE_CONTEXT_PROCESSORS = (
        "django.contrib.auth.context_processors.auth",
        "django.core.context_processors.debug",
        "django.core.context_processors.i18n",
        "django.core.context_processors.media",
        "django.contrib.messages.context_processors.messages",
        "django.core.context_processors.request",
    )

    AUTHENTICATION_BACKENDS = (
        'userena.backends.UserenaAuthenticationBackend',
        'guardian.backends.ObjectPermissionBackend',
        'django.contrib.auth.backends.ModelBackend',
    )

    ROOT_URLCONF = 'demo_project.urls'

    TEMPLATE_DIRS = (
        abspath(PROJECT_ROOT, 'templates')
    )

    INSTALLED_APPS = (
        'django.contrib.auth',
        'django.contrib.contenttypes',
        'django.contrib.sessions',
        'django.contrib.sites',
        'django.contrib.messages',
        'django.contrib.admin',
        'easy_thumbnails',
        'guardian',
        'south',
        'userena',
        'userena.contrib.umessages',
        'demo_project.profiles',
    )

    # Userena settings
    LOGIN_REDIRECT_URL = '/accounts/%(username)s/'
    LOGIN_URL = '/accounts/signin/'
    LOGOUT_URL = '/accounts/signout/'
    AUTH_PROFILE_MODULE = 'profiles.Profile'

USERENA_DISABLE_PROFILE_LIST = True
USERENA_MUGSHOT_SIZE = 140

# Test settings
TEST_RUNNER = 'django.test.simple.DjangoTestSuiteRunner'
SOUTH_TESTS_MIGRATE = False

# Guardian
ANONYMOUS_USER_ID = -1 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-06T22:09:30.807

您需要使管理静态文件可用。你的设置是什么？

# javascript - 创建不同尺寸图像的缩略图

> ID：10049790
> 
> 赞同：3
> 
> 时间：2012-04-06T22:07:58.550
> 
> 标签：javascript, html, css, image, thumbnails

我正在尝试制作可能大小不同的用户提交图像的缩略图，但是当我尝试做的是：

使用图像的较短尺寸来填充图像允许的空间。（如果图像为 500x350 且缩略图大小为 250x250，则图像高度将填充缩略图）然后我试图将图像居中于另一个维度。我在做这件事时遇到了麻烦，我不知道我应该使用 CSS 还是 Javascript。任何建议都会很棒。

解决方案：我让它按照我想要的方式工作。

```
 function sizeThumbs(){
        //resize each idea image so it is a good sized/centered thumbnail
        $.each($("img.thumbpic"), function() {
            var maxWidth = 250;
            var maxHeight = 150;
            var width = $(this).width();
            var height = $(this).height();

            if((width/maxWidth) < (height/maxHeight)){
                var multiplier = maxWidth/width;
                var newHeight = height * multiplier;

                $(this).css("width", maxWidth);
                $(this).css("height", newHeight);

                var heightD = (maxHeight - newHeight)/2;
                $(this).css("margin-top", heightD+"px");
                $(this).css("margin-bottom", heightD+"px");
            }else{
                var multiplier = maxHeight/height;
                var newWidth = width * multiplier;

                $(this).css("width", newWidth);
                $(this).css("height", maxHeight);

                var widthD = (maxWidth - width)/2;
                $(this).css("margin-left", widthD+"px");
                $(this).css("margin-right", widthD+"px");
            }
        }); 
    } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-24T14:27:18.910

我有类似的问题，但解决方案是要裁剪左右边距，而图像应该居中。我的解决方案是在这个 JS Fiddle：http: [//jsfiddle.net/david_binda/9tTRQ/1/](http://jsfiddle.net/david_binda/9tTRQ/1/)

这很简单，您需要两个图像包装器和简单的 CSS。

**HTML**

```
<div class="thumb-wrapper">
   <a href="" title="" class="img">
      <img src="http://upload.wikimedia.org/wikipedia/commons/4/40/Tectonic_plate_boundaries.png" alt="" />    
</a>
</div> 
```

**CSS**

```
.thumb-wrapper{
    width: 250px; // desired thumbnail width
    height: 250px; // desired thumbnail height        
    overflow: hidden;    
    position: relative;
    margin: 0 auto;
}
.thumb-wrapper .img{
    display: block;    
    position: absolute;
    width: 350px; // should be wider than final thumbnail
    height: 250px; // desired thumbnail height
    left: 50%;
    margin-left: -175px; // half of above defined width eg. 350/2 = 175
}
.thumb-wrapper .img img{
    width: auto !important;
    max-width: 350px !important; // should be wider than final thumbnail
    min-width: 250px !important; // desired width of thumbnail
    height: 250px !important; // desired thumbnail height
    margin: 0 auto;
    display: block;
}​ 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-07T12:23:08.617

您还可以使用 html5 画布元素和**translate**方法

[http://www.html5canvastutorials.com/advanced/html5-canvas-transform-translate-tutorial/](http://www.html5canvastutorials.com/advanced/html5-canvas-transform-translate-tutorial/)

由于调整大小是在浏览器引擎中实现的，因此它可能比您的本机 javascript 实现要快得多，特别是如果它涉及到一页上的大量图像。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-06T22:09:32.057

`max-width: 250px; max-height: 250px;`在图像的 CSS 中设置。浏览器为您创造了奇迹。

# facebook - 如何授予用户权限

> ID：10049794
> 
> 赞同：0
> 
> 时间：2012-04-06T22:08:18.253
> 
> 标签：facebook, authentication, facebook-graph-api, oauth-2.0

我正在使用 JS-SDK，并且我的用户已经获得了我的 facebook 应用程序的授权。

现在我的开放图形操作已获批准并开始发布。

我的用户正在进入我的网站，如果用户登录到 Facebook，JS SDK 会自动使用 FB.getLoginStatus 获取登录状态并执行操作。

facebook 需要“publish_actions”权限才能在 facebook 上发布操作。所以，我用“publish_actions”值向我的登录按钮添加了范围属性，当你点击它时它就可以工作了。

但有一个问题：直到今天我才从我的用户那里获得此许可。因此，如果用户不接受 JS SDK 的此权限，我想自动打开一个窗口来接受此权限。因为系统没有这样做。

> 场景（更清晰的想法）：
> 
> 1) 用户上周访问了我的网站并使用登录按钮进行了授权。
> 
> 2）我昨天在我的网站上添加了 Open Graph 的东西，并在我的登录按钮上添加了范围属性。
> 
> 3) 用户登录 Facebook。之后今天来到我的网站。JS SDK自动授权没有给出任何错误“本网站有新权限”等...
> 
> 因此，我想向该用户显示新的身份验证对话框。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-06T23:04:04.497

好吧，一旦用户加载您的页面，您可以使用 js sdk 检查用户授予您的应用程序的权限，如果没有包含 publish_actions，请让他授予它。

您可以完全在客户端执行此操作，如下所示：

```
FB.api("me/permissions", function(response) {
    if (response && response.data && response.data.lengh == 1 && !("publish_actions" in response.data)) {
        FB.login(function(response) {
            console.log(response);
        }, { scope: "publish_actions" });
    }
}); 
```

或者您可以将用户发送到身份验证对话框而不是调用*FB.login*，这取决于您。此外，您可以在服务器端而不是客户端以类似的方式检查权限，这再次取决于您。

# facebook - 使用 linter/debugger 测试 URL 列表

> ID：10049801
> 
> 赞同：0
> 
> 时间：2012-04-06T22:08:49.793
> 
> 标签：facebook, debugging

有没有办法使用 Facebook url linter / debugger 测试整个 URL 列表，而不是一次测试一个？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-06T22:58:17.370

如果您查看调试器的源代码，您会发现它是一个简单的 html 表单，您可能也可以这样做，创建一个包含几个 url 的页面并将每个 url 提交给调试器使用的相同操作.

调试器的服务器端有可能检查请求的来源（可能是某种 csrf？），但我对此表示怀疑。

唯一的问题是你为什么要做这样的事情？

# python-3.x - 将列表中的 02:12、03:45... 的值相加以形成格式 time = hours:minutes:seconds

> ID：10049805
> 
> 赞同：0
> 
> 时间：2012-04-06T22:09:03.653
> 
> 标签：python-3.x

我想将字符串转换为分钟，然后将其全部加起来并将其作为字符串返回，我在执行此操作时遇到了困难。

我有一个包含这个的列表：

TimeL = ['02:32','03:43','01:05','56:03']

我想将这些分钟：秒加在一起，并以小时：毫米：秒的格式返回一个总数，但如果它们的值不足以组成一个小时，我只想返回一个毫米：秒的值。

到目前为止，我所能做的就是将每件事都转换为秒并将它们相加，但这不是我想要的，这只是我知道该怎么做。

```
def getTIME(s):
    l = s.split(":")
    return int(l[0])*(60) + int(l[1])

for i in range(len(TimeL)):
        NEW = getTIME(TimeL[i])
        NewTotalTime = NewTotalTime + NEW 
```

所以我的方法将返回一个只有几秒的值。所以就像 3432 秒。我希望它是小时：分钟：秒，我卡住了。任何人都可以提供一点帮助，谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-06T22:18:14.897

使用以下内容：

```
str(datetime.timedelta(seconds=3432)) 
```

您需要为此导入`datetime`模块。您已经有了秒数，这会将其转换为包含小时、分钟和秒的字符串。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-06T22:31:19.710

这就是你想要的。1 分钟 = 60 秒，因此您将秒除以 60。您的问题是您需要在 python 中除以 60.0，以便获得确切的值（浮点值）。一旦你有了这个，你取最小的整数值 ( `math.floor`)，例如 150 秒是 2.5 分钟，所以你需要 2 分钟，2 分钟是 120 秒，你从 150 中删除你得到 30。这是剩余的秒数。你用相同的推理数小时（60 分钟）

```
import sys
import math

def getSeconds(s):
    l = s.split(":")
    return int(l[0])*(60) + int(l[1])

def getTotalString(time_list):
    total_secs = 0
    for time_str in time_list:
        total_secs += getSeconds(time_str)

    total_mins = total_secs/60.0
    mins = math.floor(total_mins)
    secs = total_secs-mins*60

    if mins<60:
        return '%.2d:%.2d' % (mins, secs)
    else:
        hours = math.floor(mins/60.0)
        mins = mins-60*hours
        return '%.2d:%.2d:%.2d' % (hours, mins, secs)

if __name__ == '__main__':
    print getTotalString(sys.argv[1:]) 
```

计算秒数总和的方法可以在 Python 中用一行代码完成：

```
total_secs = sum(getSeconds(time_str) for time_str in time_list) 
```

将`sum`计算列表（或迭代器）中数字的总和。您可以为其提供要添加的数字列表或数字生成器，即`the number of seconds in each time string in the list`

我希望我说得尽可能清楚和有启发性，但是您可以使用 datetime 模块的更简单的解决方案。

**更新：**这是 Python 2.x 而不是 Python 3。所以它可能无法按预期工作，但想法是一样的，语法是不同的。

# javascript - jQuery bing 滑块实现

> ID：10049808
> 
> 赞同：1
> 
> 时间：2012-04-06T22:09:11.670
> 
> 标签：javascript, jquery, html, css

我正在寻找类似于 bing.com 上的滑块。我在网上看到的所有滑块示例都有内容（文本、文本框等）和滑块的背景图像在单击下一个和上一个按钮时发生变化。

我正在寻找只有背景图像发生变化而不是其顶部的内容的东西。如果您遇到使用 JQuery 或其他 JS 库的人，请告诉我。谢谢你。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-06T22:45:42.463

解决这个问题的方法是 CSS 绝对定位。将您想要保持不变的内容放在滑块上方。将图像放在滑块内。

看看这个例子：http: [//jsfiddle.net/8WjYe/](http://jsfiddle.net/8WjYe/)

进一步阅读：[https ://developer.mozilla.org/en/CSS/position](https://developer.mozilla.org/en/CSS/position)

# python - DJANGO：表单中缺少 ManyToManyField 空白选择选项

> ID：10049817
> 
> 赞同：0
> 
> 时间：2012-04-06T22:09:57.177
> 
> 标签：python, django, forms, widget, many-to-many

我在我的视图中构建了以下表单

视图.PY

```
class MembershipForm(forms.ModelForm):
    project = forms.ModelChoiceField(Project, required=True)
    role = models.ManyToManyField(Role, blank=True) 
```

模型.PY

```
class Membership(models.Model):
    project = models.ForeignKey(Project)
    role = models.ManyToManyField(Role, blank=True, null=True) 
```

在我的模板中，角色没有“------”选项。我怎样才能将其作为一个选项并默认选择它？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-07T04:00:01.693

首先，您的 MembershipForm 看起来不正确。修复它

```
class MembershipForm(forms.ModelForm):
    # Do you really need to override the form field for role?
    class Meta:
        model = Membership 
```

或者是其他东西。

其次，对于ManyToManyField，不使用空标签'--------'，因为小部件可能表示没有选择任何项目的状态，并且同时选择空标签和实际项目会令人困惑。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-06T22:36:19.523

我不确定为什么缺少空白选项是视图，但要设置默认值，请使用[默认字段](https://docs.djangoproject.com/en/dev/ref/models/fields/#default)。

```
class Membership
    role = models.ManyToManyField(Role, blank=True, null=True, default = "") 
```

# actionscript-3 - 使用 for each 循环检查可能的密码列表

> ID：10049819
> 
> 赞同：0
> 
> 时间：2012-04-06T22:10:06.830
> 
> 标签：actionscript-3

我目前正在学习动作脚本 3，但我遇到了一个问题，只是希望有人引导我了解我做错了什么或向我解释。我试图做的是将一组可能的密码与正确的密码匹配，并跟踪密码是否正确。这就是我到目前为止所拥有的。

```
var passWords:Array = ["catdog", "fatcow", "yoda", "petergriffin"];
var userPassword:String = "petergriffin";
var wrongPassword:Boolean = false;

for each(var p:String in passWords)//checking each possible password for correct match
{ 
            if(p == userPassword)
            {
                trace("The password was found in the list");
            }

        } 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-06T22:26:21.753

更好的方法是使用 AS3 的`indexOf`数组函数：

```
if(passWords.indexOf(userPassword) != -1) {
     trace("The password was found in the list");
} 
```

`indexOf`返回数组中元素的索引（令人惊讶！）。但如果元素不在数组中，则返回 -1。

# sbt - 尝试了没有结果的有效 URL

> ID：10049822
> 
> 赞同：0
> 
> 时间：2012-04-06T22:10:17.053
> 
> 标签：sbt

sbt 报告：

[警告] ==== teleal-repo：尝试过 [警告] [http://teleal.org/m2/org/teleal/cling/cling-core/1.0.4/cling-core-1.0.4.pom](http://teleal.org/m2/org/teleal/cling/cling-core/1.0.4/cling-core-1.0.4.pom)

然后抱怨这种依赖没有解决。

唯一的问题是这是一个有效的 URI。知道为什么 SBT 会这样做吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-09T04:26:46.407

尝试清理你的常春藤缓存（~/.ivy2/cache）并进行干净的构建（sbt clean update compile）

# jquery - 单击时隐藏 CSS 下拉菜单

> ID：10049828
> 
> 赞同：2
> 
> 时间：2012-04-06T22:10:53.137
> 
> 标签：jquery, css, menu, drop-down-menu, nav

我有一个 CSS 下拉菜单，它的功能是我想要的，除了一个部分，单击其中一个子菜单项不会关闭子菜单。

大多数人可能并不关心这一点，因为每个链接都会将他们带到一个新页面，但我的只是停留在同一页面上并调用 javascript 函数。

使用 jquery，我可以像这样在点击时隐藏子菜单：

```
 $("ul.pureCssMenu li a").live('click', function() {
            $("li.pureCssMenui").hide();
        }); 
```

但是，单击一个子菜单后，所有子菜单现在都将永远隐藏。有没有办法在不做像计时器这样俗气的事情的情况下取消隐藏它？还是一种更好的方法来解决这个问题？

这是我正在处理的页面： [http ://www.nba.com/warriors/wallpapertest_031.html](http://www.nba.com/warriors/wallpapertest_031.html)

提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-06T22:14:29.267

对于取消隐藏，您可以简单地使用

```
$("li.pureCssMenui").show(); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-06T22:18:06.800

你应该把 < UL > 隐藏在里面而不是 < LI > 所以像这样

```
$("ul.pureCssMenu li a").live('click', function() {
            $("li.pureCssMenui ul").hide();
 }); 
```

# php - 插入 county; ?> 好的，所以这段代码正在运行，并且回显输出是：“arizona” 现在我想用 echo 替换第一行的“arizona”。我试过 问问题 问问题 2012-04-06T22:11:35.880 148 次 This question shows research effort; it is useful and clear 0 This question does not show any research effort; it is unclear or not useful Bookmark this question. Show activity on this post. county; ?> 好的，所以这段代码正在运行，并且回显输出是：“arizona” 现在我想用 echo 替换第一行的“arizona”。我试过 ： county;): ?> county; ?> 但不工作。我怎样才能包括： $image->county; 在第一行？ 试试这个 county){ ?> county; ?> phprangeecho 4 4 回答 4 This answer is useful 3 if从表达式中删除分号： county): ?> 于 2012-04-06T22:12:57.313 回答 This answer is useful 3 尝试这个 county){ ?> county; ?> 于 2012-04-06T22:12:55.757 回答 This answer is useful 2 你很近！只需要从第一行删除分号： county): ?> county; ?> 于 2012-04-06T22:13:02.680 回答 This answer is useful 0 您还可以将 php 保持打开直到代码结束，而不是在每一行都打开和关闭它，这会导致可读性差。此外，您的第一行中有额外的分号。;D county) { echo $image->county; } ?> 于 2012-04-06T22:18:17.543 回答 Related 2 java - 类型“class *”没有被增强的 JPA 异常 2 android - 在 Google Map v2 Android 上加载 1700 个标记超时 3 c# - 如何在不在 URL 中写入任何内容的情况下将数据发送到网站？ 6 maven - 带有 Eclipse Jetty 的 Maven 插件的奇怪的 NoClassDef-s 1 ruby-on-rails-3.2 - Rails 根路径不起作用 0 objective-c - 如何绑定几个NSArrays的所有对应元素 2 python - Python 3：比较主列表中的元组？ 3 python - 如何获取列表中特定字符的频率？ 5 java - 在java中检查字符串/字符串[]是否为空或“” 2 performance - CPU 密集度最低的循环 Reference php × 1429865 c/c++ × 756500 nginx × 49975 mongodb × 159057 mybatis × 3233 anaconda × 13410 pycharm × 14671 python × 1902243 vscode × 56040 docker × 110988 github × 49000 flask × 49129 ffmpeg × 24037 jmeter × 16910 matplotlib × 63493 bootstrap × 54641

> ID：10049832
> 
> 赞同：0
> 
> 时间：
> 
> 标签：php, range, echo

```
<?php if($range == 'arizona'): ?>
    <?php echo $image->county; ?>
<?php endif; ?> 
```

好的，所以这段代码正在运行，并且回显输出是：“arizona”

现在我想用 echo 替换第一行的“arizona”。我试过 ：

```
<?php if($range == $image->county;): ?>
    <?php echo $image->county; ?>
<?php endif; ?> 
```

但不工作。我怎样才能包括：

```
 $image->county; 
```

在第一行？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-06T22:12:57.313

`if`从表达式中删除分号：

```
<?php if($range == $image->county): ?> 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-06T22:12:55.757

尝试这个

```
<?php if($range == $image->county){ ?>
   <?php echo $image->county; ?>
<?php } ?> 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-04-06T22:13:02.680

**你很近！**只需要从第一行删除分号：

```
<?php if($range == $image->county): ?>
    <?php echo $image->county; ?>
<?php endif; ?> 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-06T22:18:17.543

您还可以将 php 保持打开直到代码结束，而不是在每一行都打开和关闭它，这会导致可读性差。此外，您的第一行中有额外的分号。;D

```
<?php if($range == $image->county) {
    echo $image->county;
} ?> 
```

# matlab - TeX字符的MATLAB表？

> ID：10049833
> 
> 赞同：3
> 
> 时间：2012-04-06T22:11:36.240
> 
> 标签：matlab, tex

在 mathworks.com 上的在线文档中，MATLAB 支持的 TeX 字符子集表在哪里？

我习惯了很容易找到它，但我不能：在这个页面[http://www.mathworks.com/help/techdoc/creating_plots/f0-4741.html#f0-28104](http://www.mathworks.com/help/techdoc/creating_plots/f0-4741.html#f0-28104)他们有一条说明：

> 有关符号列表和用于定义它们的字符序列，请参阅文本属性参考页中[的可用 TeX 字符表。](http://www.mathworks.com/help/techdoc/ref/text_props.html#String)

但超链接似乎搞砸了。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-06T22:14:13.120

没关系，找到了；它就在超链接所在的位置，但是您必须查看 TeX 字符序列表并单击不明显的小向下箭头才能显示该表。

# arrays - CLR 堆中的数组

> ID：10049840
> 
> 赞同：0
> 
> 时间：2012-04-06T22:12:25.707
> 
> 标签：arrays, object, heap-memory, clr

我有一个下图：

![在此处输入图像描述](../Images/766f3dc56a8d5cadaf6341301bd1aff2.png)

我的问题是，堆中数组中的对象存储在“对象引用”及其值、属性等的位置。**或者**这些“对象引用”部分仅包含对存储特定对象所有内容的另一个堆地址的引用？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-06T22:15:47.200

对象引用就是这样——对存储在别处的对象的*引用。*

请注意，只有类被存储为对象引用；结构（值类型）是内联存储的。

# iphone - 核心位置 newLocation 无法分配给属性

> ID：10049851
> 
> 赞同：0
> 
> 时间：2012-04-06T22:14:03.630
> 
> 标签：iphone, objective-c, ios, geolocation, gps

在 Apple 的文档中，他们展示了这种与 CoreLocation 一起使用来提取 GPS 数据的方法

```
- (void)locationManager:(CLLocationManager *)manager didUpdateToLocation:(CLLocation     *)newLocation fromLocation:(CLLocation *)oldLocation 
{
} 
```

这是为了通知您 GPS 已更新。newLocation 将拥有您需要的 GPS 数据，但如果我在此方法中添加一条语句以将其分配给一个属性，则会写入注释。

```
latitude = [NSString stringWithFormat:@"%f", newLocation.coordinate.latitude];
NSLog(@"%@", latitude); 
```

将上面的 NSLog 放入方法中将显示正确的坐标。但是当方法结束时，数据似乎消失了。我班上的属性“纬度”没有被分配。也许这是一个范围问题？我无法从中返回任何内容，也无法在方法之外看到 newLocation。有没有人想办法解决这个问题？

* * *

编辑：我使用弧和纬度属性是强。我还需要其他属性吗？这是我用来导入属性的实现代码。（纬度是 LocationAwareness 的一个属性）这两个 nslog 都显示为 null

```
#import "ViewController.h"
#import "LocationAwareness.h"

@interface ViewController ()

@end

@implementation ViewController
@synthesize location;

- (void)viewDidLoad
{
[super viewDidLoad];
self.location = [[LocationAwareness alloc] init];
NSLog(@"%@", location.latitude);
NSLog(@"%@", location.longitude);
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-06T22:16:54.367

它需要保留。不要忘记释放变量以再次使用，并在 dealloc 方法中。因此，您的 -didUpdateToLocation 方法应如下所示。

```
latitude = [[NSString stringWithFormat:@"%f", newLocation.coordinate.latitude] retain]; 
```

...

```
- (void)locationManager:(CLLocationManager *)manager didUpdateToLocation:(CLLocation     *)newLocation fromLocation:(CLLocation *)oldLocation 
{
    if (latitude) {
        [latitude release];
    }

    latitude = [[NSString stringWithFormat:@"%f", newLocation.coordinate.latitude] retain];
} 
```

否则，如果您使用 ARC，只需添加一个具有“强”属性的属性。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-06T22:18:01.510

如果您使用的是 ARC 并且纬度是一个强大的属性，请使用：

```
self.latitude = [NSString stringWithFormat:@"%f", newLocation.coordinate.latitude]; 
```

# wordpress - 在 WordPress 主题选项中使用 HTML 编辑器

> ID：10049856
> 
> 赞同：0
> 
> 时间：2012-04-06T22:14:20.697
> 
> 标签：wordpress, themes

我的 wp 主题设置中有一个`<textarea>`。如何将其转换为使用 wordpress HTML 编辑器？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-06T22:19:56.470

使用[`wp_editor()`](http://codex.wordpress.org/Function_Reference/wp_editor).

例子：

```
$editor_settings =  array (
    'textarea_rows' => 8
,   'media_buttons' => FALSE
,   'teeny'         => TRUE
,   'tinymce'       => FALSE
    // a very minimal setup
,   'quicktags'     => array ( 'buttons' => 'strong,em,link' )
);
wp_editor( $content, $key, $editor_settings ); 
```

有关更好的示例，请参阅[此答案](https://wordpress.stackexchange.com/a/43742/73)和[WordPress Stack Exchange](https://wordpress.stackexchange.com/)上的[wp-editor 标记](https://wordpress.stackexchange.com/questions/tagged/wp-editor)。

# java - 使用长字符串

> ID：10049857
> 
> 赞同：2
> 
> 时间：2012-04-06T22:14:27.487
> 
> 标签：java

我想在 Eclipse 中使用很长的字符串。所以我的问题是：每次我在括号中输入一个字符串时，Eclipse 只会将第一行识别为字符串（字符串中有换行符）

字符串：

```
public static final String EXAMPLE_TEST ="" 
```

当我插入字符串时：

```
public static final String EXAMPLE_TEST ="1\.    Lorem ipsum dolor sit amet, consetetur sadipscing elitr, sed diam nonumy eirmod tempor invidunt ut labore et dolore 
2\.  magna aliquyam erat, sed diam voluptua. 
3\.  At vero eos et accusam et justo duo dolores et ea rebum. Stet clita kasd gubergren, no sea takimata sanctus est Lorem ipsum 
4\.  dolor sit amet. Lorem ipsum dolor sit amet, consetetur sadipscing elitr, sed diam nonumy eirmod tempor invidunt ut labore et dolore
5\.  magna aliquyam erat, sed diam voluptua. At vero eos et accusam et justo duo dolores et ea rebum. Stet clita kasd gubergren, 
6\.  no sea takimata sanctus est Lorem ipsum dolor sit amet.
" 
```

1.（“orem ipsum dolor sit amet, consetetur sadipscing elitr, sed diam nonumy eirmod tempor invidunt ut labore et dolore”）之后的行被逃脱。

我希望有人能帮帮忙。谢谢

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-04-06T22:19:36.597

在首选项中：

Java > 编辑器 > 打字

选中“粘贴到字符串文字时转义文本”。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-04-06T22:18:13.470

通常这些都被分解了；

```
String blah = "I am \n" +
 "a very \n" +
 "long string."; 
```

编译器希望标记在换行之前关闭。'token' 类似于 'String' 或 'blah' 或 '=' 或 '"I am"' 或 '+'。你不能有一个分成多行的标记——编译器不知道如何识别它。不幸的是，它是语言的基础。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-04-06T22:19:23.657

您不能直接在`String`. 因此，您必须将它们`+`与`\n`角色一起连接起来。

这可以通过简单的查找和替换工具轻松实现自动化。

尽管有人[提议](http://blog.joda.org/2008/01/java-7-multi-line-string-literals_594.html)将多行字符串添加到 Java 7 中，但可能会很有趣。不幸的是，没有得到任何结果（更多详细信息可以在链接中找到）。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-04-06T22:18:41.633

Java 不支持多行字符串。如果您不想将所有内容都放在一行中，则必须使用 +。

或者，您可以从与源一起分发的 ini（首选项）文件中加载文本（甚至可以在 jar 中）。当您考虑稍后添加 i18n 时，这也很好。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-04-06T22:21:20.877

如果到处都没有 + 号，真的没有办法做到这一点。[JLS](http://docs.oracle.com/javase/specs/jls/se5.0/html/lexical.html#3.10.5)说：

> 行终止符出现在“开始”之后和“结束匹配”之前是编译时错误。

因此，在源代码中声明此类字符串的唯一方法是将它们放在一行中，然后`\r\n`在中间插入，或者使用 + 运算符连接它们。您不应该害怕在字符串上使用 + 运算符，因为它们被声明为 static final，因此连接只会进行一次。

另一种方法是从文件中读取这些字符串，这样您就不必在源代码中声明它们。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2019-04-21T16:59:13.460

遵循 Java 的编码约定，您必须连接 String 值：

```
public static final String EXAMPLE_TEST = "1\.  Lorem ipsum dolor sit amet, "  
                                          + "consetetur sadipscing elitr, sed diam " 
                                          + "nonumy eirmod tempor invidunt ut labore "                                                
                                          + "et dolore "
                                          + "2\.  magna aliquyam erat, sed "                                              
                                          + "diam voluptua. "
                                          + "3\.  At vero eos et " 
                                          + "accusam et justo duo dolores et ea " 
                                          + "rebum. Stet clita kasd gubergren, no " 
                                          + "sea takimata sanctus est Lorem ipsum "
                                          + "4\.  dolor sit amet. Lorem ipsum dolor " 
                                          + "sit amet, consetetur sadipscing elitr, "
                                          + "sed diam nonumy eirmod tempor invidunt "                                    
                                          + "ut labore et dolore " 
                                          + "5\.  magna aliquyam "                                        
                                          + "erat, sed diam voluptua. At vero eos et "                                          
                                          + "accusam et justo duo dolores et ea " 
                                          + "rebum. Stet clita kasd gubergren, "
                                          + "6\.  no sea takimata sanctus est Lorem " 
                                          + "ipsum dolor sit amet."; 
```

确保连接运算符始终从下一行开始。 [https://www.oracle.com/technetwork/java/javase/documentation/codeconventions-136091.html#248](https://www.oracle.com/technetwork/java/javase/documentation/codeconventions-136091.html#248)

希望这可以帮助！

快乐编码，

布雷迪

# mysql - 用于存储包含具有不同属性的产品的订单的适当数据库结构

> ID：10049859
> 
> 赞同：1
> 
> 时间：2012-04-06T22:14:33.790
> 
> 标签：mysql, database, database-design

几天来，我一直在尝试为我的问题提出解决方案，但没有运气。我希望有人能帮助我。如果描述太长，我很抱歉。

我想建立一个网站，客户可以在其中选择这些产品并可以订购它们的任意组合。

## 产品一：

完全定制的产品（即使不是所有信息对表结构都很重要，我也会详细描述定制过程）

客户可以从组件列表中组装产品，并且：

1.  有两种类型的组件 - 主要组件和辅助组件
2.  每个组件都有特定的重量和价格
3.  主要组件由辅助组件组成，但它们的权重与单独列出时不同（对于跟踪哪个组件的销售量很重要）
4.  每个产品必须恰好包含 1 个主要成分，并且可以包含 0 到多个补充成分
5.  辅助成分的总重量总是 <= 主要成分的重量
6.  主成分最终重量按“原主成分重量-辅成分总重量”计算

例如。

添加主要成分MC（重量1000g）
添加Sup。组分 1 (重量 100g)
添加 Sup. 组分2（重量200g）

最终产品包括：
主要成分 MC 700g
Sup。组分 1 100g
Sup. 组分 2 200g

每个产品都有唯一的代码（原因稍后解释）。

## 产品乙：

预组装并直接购买的产品（由组件制成，但组件的重量可能与在组装模块中单独列出时的重量不同）

## 产品C：

其他与组件无关的物品 - T 恤、马克杯

**我的问题是 - 在以下情况下，存储这些项目的订单最有效的数据库结构是**什么：

1.  我需要显示特定订单的所有订单项目，当存在产品 A 时，列出它的所有组件和主要组件的组件
2.  我需要能够通过代码重建已经购买的定制产品（产品 A），并在它们不再有库存/可用时移除单个组件
3.  所有组件的重量和价格可以随时间变化+主要组件的组件和产品B也可以改变
4.  我需要能够跟踪每个组件的销售量以及销售时间

到目前为止，我有以下数据库结构，但我认为我没有走在正确的轨道上：

**成分**

*   身份证（PK）
*   姓名
*   价格
*   重量

**订单**（不相关的列，如 number、customer_firstname、delivery_method 等省略）

*   身份证（PK）

**order_items**（所有产品类型共有的字段）

*   身份证（PK）
*   order_id（FK 到 orders.id）
*   代码
*   姓名
*   价格
*   数量

**order_producta**

*   身份证（PK）
*   order_item_id（FK 到 order_items.id）
*   component_id（FK 到 components.id）
*   数量
*   价格
*   重量

非常感谢您的回复。如果我解释不清楚，我很乐意用其他信息编辑我的问题。

# jquery - jQuery - 单击许多 div 时更改图像

> ID：10049861
> 
> 赞同：0
> 
> 时间：2012-04-06T22:14:56.520
> 
> 标签：jquery, image, click

我有许多具有相同背景图像的 div，当我单击其中一个时，我想更改此背景。

我正在和这样的人一起训练：

**身体**：

```
<div id="basket-plusminus"></div>
...
<div id="basket-plusminus"></div>

<script>
$("#basket-plusminus").toggle(
function () {
$(this).addClass("click-plusminus");
},
function () {
$(this).removeClass("click-plusminus");
}
);
</script> 
```

在 CSS 中：

```
#basket-plusminus {
width:11px;
height:11px;
background:url(../img/icons/plus-min.png) no-repeat scroll 0 0 transparent;
cursor:pointer;
}

.click-plusminus {
background-image:url(../img/icons/minus-min.png) !important;
} 
```

**我不知道如何在其中添加自动 ID，也许这是一个解决方案。**

帮助

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-06T22:24:21.577

通过对标记和 javascript 进行一些修改，您可以这样做：http: [//jsfiddle.net/Wrxdy/](http://jsfiddle.net/Wrxdy/)当然保留您拥有的背景 - 例如，我只是切换颜色。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-06T22:24:35.173

使用 class 而不是 id 标签，因为 id 是唯一的。

尝试：

```
<div class="basket-plusminus"></div>
...
<div class="basket-plusminus"></div>

<script>
$(".basket-plusminus").toggle(
    function ()
    {
        $(this).addClass("click-plusminus");
    },
    function ()
    {
        $(this).removeClass("click-plusminus");
    }
);
</script> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-06T22:26:09.360

一旦您修复了相同的 ID 问题，此代码行应该对您有所帮助

$.(document).ready(function() {

$("#backet-plusminus").click(function() { $('myOjbect').css('background-image', 'url(' + imageUrl + ')'); });

})

# .net - 紧凑框架 3.5 是否支持 System.Runtime.Serialization？

> ID：10049863
> 
> 赞同：4
> 
> 时间：2012-04-06T22:15:02.027
> 
> 标签：.net, compact-framework, datacontract, netdatacontractserializer

我正在编写一个库，它是一组旨在在许多不同的 .NET 应用程序之间共享的类，包括至少一个使用 .NET 紧凑框架的类。我一直在使这些类使用带有一堆 [DataMember] 的 [DataContract] 属性，以便使用 DataContractJSONSerializer 轻松序列化和反序列化它们。我一直在网上搜索以了解 .NET Compact Framework 3.5 是否支持此功能（DataContractAttribute、DataMemberAttribute 和 DataContractJsonSerializer），但我什至无法在.NET 框架。

有没有人碰巧知道对这些功能的支持程度？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-06T22:59:46.140

我相信 System.Runtime.Serialization 命名空间存在于 .net 3.5 CE 中。这是 namespaces 的完整[列表](http://blogs.msdn.com/b/lokeuei/archive/2007/10/29/namespaces-for-net-compact-framework-3-5.aspx)，但其中不支持您感兴趣的任何功能。

据我了解，您正在尝试创建一些可以序列化的实体库。我认为您需要为您的 .net CE 应用程序提供另一种方法。说不同的库（或相同的代码，但为 ce 编译并定义了指令）。然后你需要利用一些外部库进行 json 序列化（如果你仍然需要它）。

还要考虑使用另一种序列化机制来代替 DataContractJsonSerializer。[从SO 的另一个好问题](https://stackoverflow.com/questions/9301878/whats-the-difference-between-datacontractjsonserializer-and-javascriptserialize)开始。

如果您正在尝试使用某些服务，msdn 论坛上有[帖子](http://social.msdn.microsoft.com/forums/en-US/wcf/thread/7c28693e-7add-4703-a1e8-5092898dcc85/)，其中讨论了类似的问题。他们的建议是建立一些中间层。

无论如何，无论你用 .NET 3.5 CE 做什么都会很困难，因为老实说，它是一种过时的技术。

# css - 为什么相对定位会改变我的页面顺序？

> ID：10049865
> 
> 赞同：0
> 
> 时间：2012-04-06T22:15:54.257
> 
> 标签：css, css-position

我的 HTML 和 CSS 代码有一个奇怪的问题：

```
<header>
    <h1>title</h1>
</header>
<nav>
    <a href="">menu 1</a>
    <a href="">menu 1</a>
    <a href="">menu 1</a>
    <a href="">menu 1</a>
</nav> 
```

```
header {
  margin: 0 auto;
  position: relative;
  top: 200px;
  width: 200px;
}
header h1 {
  font-size: 24px;
  text-align: center;
}
nav {
  clear: both;
  margin: 0 auto;
  position: relative;
  width: 200px;
}
* {
    border: none;
    font-size: 100%;
    font: inherit;
    vertical-align: baseline;
}
article, aside, details, figcaption, figure, footer, header, hgroup, menu, nav, section, summary {
    display: block;
}
body, html {
    height: 100%;
} 
```

当它们都相对定位时，为什么会`<nav>`出现在上面？`<header>`

[请参阅 jsFiddle。](http://jsfiddle.net/aARyr/)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-06T22:20:19.137

不是，您只是将标题移到导航下方。您为其指定了 a `top: 200px`，它将其*向下*移动200 像素...您的导航出现在如果该属性不存在时它*会出现的位置。*它从窗口顶部向下移动了标题的高度。如果你也想向下推导航，你也可以添加一个`top: 200px`，但这只会导致每个其他元素都需要相对定位到距离它最初出现的顶部 200px 的问题，这不是很合乎逻辑.

![相对定位](../Images/9703f25c999b2f2ba7b6f0b9d5db35b9.png)

你到底想做什么？您的意思是改为使用`margin-top: 200px`，将页面上的所有内容向下移动 200 像素？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-06T22:19:52.630

```
position: relative; 
top: 200px; 
```

这会将标题向下移动 200 像素，将其放在导航下方。它只是按照你告诉它的去做...

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-06T22:20:02.413

`<header>`有`top: 200px;`所以它将被定位在距离顶部 200 像素处。没有偏移，`<nav>`所以它应该出现在`<body>`.

# ssrs-2008 - 我的报告中只显示一条记录

> ID：10049867
> 
> 赞同：0
> 
> 时间：2012-04-06T22:16:10.933
> 
> 标签：ssrs-2008, reporting-services

我在 SSRS 中设计了一份报告，它不是表格报告，而是自定义报告。当我预览我的报告时，为什么我不能导航到下一条记录？作为此报表数据集的查询有大约 1000 条记录，但我在预览模式下的报表无法识别它，只在顶部菜单栏中显示“1 或 1”。如何导航到其他记录？

提前致谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-07T13:09:45.173

根据您的描述，听起来您只设计了一页，而不是重复的数据元素。如果您通过将数据字段拖到空白背景上来设计页面，那么您获得的文本框将仅显示数据集中的第一个结果。

您需要使用将重复其内容的每个数据记录的项目：列表、表格或矩阵，Tablix 的所有变体。

要构建对每条记录重复的复杂布局，您应该：

*   创建父报表和子报表（它采用参数将查询过滤到单个记录。）将子报表放入列表或表中。
*   将一个矩形放入列表或表格中，并在该矩形中构建您的报告。

无论哪种方式，请注意您的文本框包含在重复项中。

# android - 为什么我的画布不显示（Android）？

> ID：10049868
> 
> 赞同：0
> 
> 时间：2012-04-06T22:16:12.847
> 
> 标签：android, line, paint, android-canvas

我对整个图形/画布的东西相当陌生。我要做的就是在一些按钮下方显示一个带有线条的画布。我做错了什么？这是我的代码：

```
public class Vectors extends Activity{

    VectorsView vectorsView;
    LinearLayout l;
    Canvas canvas;

    @Override
    public void onCreate(Bundle savedInstanceState) {
        // TODO Auto-generated method stub
        super.onCreate(savedInstanceState);
        setContentView(R.layout.vectors);
        vectorsView = new VectorsView(this);

    }

    public class VectorsView extends View{

        public VectorsView(Context context) {
            super(context);
        }

        @Override
        protected void onDraw(Canvas canvas) {
            // TODO Auto-generated method stub
            super.onDraw(canvas);
            l = (LinearLayout) findViewById(R.layout.vectors);

            Paint paint = new Paint();
            canvas = new Canvas();

            paint.setColor(Color.WHITE);
            canvas.drawLine(0, 0, 100, 100, paint);
            vectorsView.draw(canvas);

            l.addView(vectorsView);
            setContentView(l);
        }
    }
} 
```

这是请求的vectors.xml：

```
<?xml version="1.0" encoding="utf-8"?>
<ScrollView  xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_height="wrap_content" 
    android:layout_width="match_parent">
    <LinearLayout 
         android:layout_width="fill_parent" 
         android:layout_height="fill_parent"
         android:background="@drawable/background" 
         android:orientation="vertical">

         <ImageView android:layout_height="wrap_content" 
            android:src="@drawable/vectors" 
            android:layout_width="wrap_content"
            android:layout_gravity="center"
            android:paddingTop="5dp"
            android:paddingBottom="5dp"
            android:adjustViewBounds="true">
         </ImageView>
         <LinearLayout android:layout_height="wrap_content" 
            android:layout_width="match_parent"
            android:orientation="horizontal">
            <Button android:text="Choose Program" 
                android:id="@+id/bChsProgV" 
                android:layout_width="wrap_content" 
                android:layout_height="wrap_content"
                android:layout_marginBottom="5dp"
                android:layout_marginLeft="97dp"
                android:adjustViewBounds="true">
            </Button>
            <ImageButton android:layout_height="wrap_content" 
                android:src="@drawable/help" 
                android:id="@+id/ibHelpV" 
                android:layout_width="wrap_content"
                android:layout_marginLeft="65dp"
                android:background="@null" 
                android:layout_marginTop="10dp">
            </ImageButton>
         </LinearLayout>
         <LinearLayout android:layout_width="match_parent" 
            android:layout_height="wrap_content" 
            android:orientation="horizontal">
             <TextView android:text="Value" 
                android:layout_width="wrap_content" 
                android:layout_height="wrap_content"
                android:paddingLeft="5dp"
                android:paddingRight="5dp"
                android:textColor="#fffafa">
             </TextView>
             <EditText android:text="" 
                android:id="@+id/etValueV" 
                android:layout_height="wrap_content"
                android:inputType="numberSigned|numberDecimal"
                android:layout_width="100dp" >
             </EditText>
             <Button android:text="Next" 
                android:id="@+id/bNextV" 
                android:layout_width="65dp" 
                android:layout_height="wrap_content"
                android:layout_marginLeft="10dp">
             </Button>
             <TextView android:text="" 
                android:id="@+id/tvAnsValV" 
                android:layout_width="wrap_content" 
                android:layout_height="wrap_content">
             </TextView>
         </LinearLayout>
         <LinearLayout android:layout_width="match_parent" 
            android:layout_height="wrap_content" 
            android:orientation="horizontal">
             <TextView android:text="Angle" 
                android:layout_width="wrap_content" 
                android:layout_height="wrap_content"
                android:paddingLeft="5dp"
                android:paddingRight="5dp"
                android:textColor="#fffafa">
             </TextView>
             <EditText android:text="" 
                android:id="@+id/etAngleV" 
                android:layout_height="wrap_content"
                android:inputType="numberSigned|numberDecimal"
                android:layout_width="100dp" >
             </EditText>
             <Button android:text="Prev" 
                android:id="@+id/bPrevV" 
                android:layout_width="65dp" 
                android:layout_height="wrap_content"
                android:layout_marginLeft="10dp">
             </Button>
             <TextView android:text="" 
                android:id="@+id/tvAnsAng" 
                android:layout_width="wrap_content" 
                android:layout_height="wrap_content">
             </TextView>
         </LinearLayout>
         <LinearLayout android:layout_height="wrap_content" 
            android:layout_width="match_parent"
            android:orientation="horizontal">
            <LinearLayout android:layout_height="wrap_content" 
            android:layout_width="wrap_content"
            android:orientation="vertical">
                <RadioGroup
                    android:layout_width="match_parent"
                    android:layout_height="wrap_content" >              
                    <RadioButton android:layout_height="wrap_content"
                        android:layout_width="wrap_content"
                        android:checked="true"
                        android:text="Degrees"
                        android:layout_marginLeft="5dp"
                        android:id="@+id/rbDegV">
                    </RadioButton>
                    <RadioButton android:layout_height="wrap_content"
                        android:layout_width="wrap_content"
                        android:checked="false"
                        android:text="Radians"
                        android:layout_marginLeft="5dp"
                        android:id="@+id/rbRadV">
                    </RadioButton>
                </RadioGroup>
            </LinearLayout> 
            <RadioGroup
                android:layout_width="match_parent"
                android:layout_height="wrap_content" >  
                <LinearLayout android:layout_height="wrap_content" 
                    android:layout_width="wrap_content"
                    android:orientation="horizontal">
                    <LinearLayout android:layout_height="wrap_content" 
                        android:layout_width="wrap_content"
                        android:orientation="vertical">
                        <RadioButton android:layout_height="wrap_content"
                            android:layout_width="wrap_content"
                            android:checked="false"
                            android:text="Q2"
                            android:layout_marginLeft="90dp"
                            android:id="@+id/rbQ2V">
                        </RadioButton>
                        <RadioButton android:layout_height="wrap_content"
                                android:layout_width="wrap_content"
                                android:checked="false"
                                android:text="Q3"
                                android:layout_marginLeft="90dp"
                                android:id="@+id/rbQ3V">
                        </RadioButton>
                    </LinearLayout>
                    <LinearLayout android:layout_height="wrap_content" 
                        android:layout_width="wrap_content"
                        android:orientation="vertical">
                        <RadioButton android:layout_height="wrap_content"
                            android:layout_width="wrap_content"
                            android:checked="true"
                            android:text="Q1"
                            android:layout_marginLeft="5dp"
                            android:id="@+id/rbQ1V">
                        </RadioButton>
                        <RadioButton android:layout_height="wrap_content"
                                android:layout_width="wrap_content"
                                android:checked="false"
                                android:text="Q4"
                                android:layout_marginLeft="5dp"
                                android:id="@+id/rbQ4V">
                        </RadioButton>
                    </LinearLayout>
                </LinearLayout> 
            </RadioGroup>                                                       
         </LinearLayout>
         <Button android:text="Submit" 
            android:id="@+id/bSubmitV" 
            android:layout_width="75dp" 
            android:layout_height="wrap_content"
            android:layout_gravity="center">
         </Button>
         <TextView android:text="" 
            android:id="@+id/tvErrorV" 
            android:layout_width="wrap_content" 
            android:layout_height="wrap_content"
            android:layout_gravity="center"
            android:textColor="#fffafa">
         </TextView>
         <LinearLayout android:id="@+id/llCanvasV" 
            android:layout_height="wrap_content" 
            android:layout_width="match_parent">
         </LinearLayout>
    </LinearLayout>

</ScrollView> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-31T17:33:46.323

您的视图层次结构由您的 XML 定义。

您的 setContentView() 调用使作为顶级 XML 元素的 ScrollView 成为视图层次结构的根视图。

您在代码中创建的 VectorsView 对象未附加到该视图层次结构。由于它不在该层次结构中，因此它永远不会显示。它的 onDraw() 代码永远不会被调用。

在 onDraw() 例程中调用 addView() 和 setContentView() 是不合适的。一般的顺序是在调用 onCreate() 的代码中定义视图层次结构，然后允许操作系统在整个层次结构中调用你的 onDraw() 方法。

如果您从 onDraw() 中删除了除绘图相关命令之外的所有内容，那么您可以通过将 setContentView(R.layout.vectors) 调用替换为 setContentView(vectorsView) 来查看它。当然，您的 XML 定义的小部件都将不可见。

此页面提供了一些附加信息：

[http://developer.android.com/guide/topics/ui/index.html](http://developer.android.com/guide/topics/ui/index.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-06T23:06:26.887

要么你在你的vectors.xml中使用VectorsView - 但是你需要添加一个带有属性的构造函数

或者

您在vectors.xml中添加一个容器（例如LinearLayout）并通过代码将您的vectorsView添加到它 - 那么您拥有的构造函数就足够了

# c# - LINQ：为什么我不能在返回的对象中声明新对象？

> ID：10049869
> 
> 赞同：2
> 
> 时间：2012-04-06T22:16:14.973
> 
> 标签：c#, linq, entity-framework-4, properties

首先，我做了一些寻找这个问题的答案......但我找不到任何东西，因为我不知道我正在使用的功能是什么。

以下代码中的 DBEntities 是由 devart 为 Oracle 数据库连接生成的。

**为什么第一个示例有效，而第二个示例只给我一个 System.NullReferenceException？**

有效代码：

```
using (DBEntities context = new DBEntities())
{
    var infos = (from info in context.Infos
                 where info.Index == index
                 orderby info.Name
                 select new
                 {
                     Name = info.Name,
                     MRN = info.MRN,
                     UnitNumber = (info.UnitNum == null) ? -1 : (decimal)info.UnitNum,
                     UnitName = (info.UnitName == null) ? String.Empty : info.UnitName
                 }).Distinct();

    foreach (var info in infos)
    {
        // *do stuff*
    }
} 
```

给出异常的代码（只有在达到 foreach 时才会看到异常）：

```
using (DBEntities context = new DBEntities())
{
    var infos = (from info in context.Infos
                 where info.Index == index
                 orderby info.Name
                 select new Member()
                 {
                     Name = info.Name,
                     MRN = info.MRN,
                     CurrentUnit = new Unit()
                     {
                         UnitNumber = (info.UnitNum == null) ? -1 : (decimal)info.UnitNum,
                         UnitName = (info.UnitName == null) ? String.Empty : info.UnitName
                     }
                 }).Distinct();

    foreach (Member info in infos)
    {
        // *do stuff*
    }
} 
```

**编辑：** 我想补充一点，这也有效：

```
using (DBEntities context = new DBEntities())
{
    var infos = (from info in context.Infos
                 where info.Index == index
                 orderby info.Name
                 select new Member()
                 {
                     Name = info.Name,
                     MRN = info.MRN
                 }).Distinct();

    foreach (Member info in infos) //Exception is thrown here.
    {
        // *do stuff*
    }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-06T22:23:25.750

第一个有效，因为您可以从 SQL 返回那些匿名类型，并且 EF 可以为整个表达式生成 SQL 语句。第二个没有，因为您无法在 SQL 中创建 Member 类的实例。如果您强制进行枚举（使用 AsEnumerable()），您可以创建 Member 值客户端。

异常总是会在枚举点被抛出，因为 LINQ 在设计上是完全“懒惰的”。如果您想强制它在您创建表达式时发生（例如，出于测试目的），请添加`.ToList()`到它的末尾。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-06T22:27:14.560

代替

```
foreach (Member info in infos) //Exception is thrown here.
{
    // *do stuff*
} 
```

利用

```
foreach (var info in infos) //Valid.
{
    // *do stuff*
} 
```

这是因为`infos`返回匿名结果。这不是完全的`Member`集合类。

# python - WSGI：让每个请求真正独一无二

> ID：10049872
> 
> 赞同：1
> 
> 时间：2012-04-06T22:16:27.503
> 
> 标签：python, mod-wsgi, wsgi

我目前正在熟悉 Python 中 Web 应用程序的 WSGI 规范。我设置 Apache（使用 mod-wsgi）来调用一个小应用程序，该应用程序当前只显示线程 ID 号，以尝试观察每个请求的唯一性：

```
import thread

def application(environ, start_response)
    start_response('200 Ok', [('Content-type', 'text/plain')])
    output = "current thread id: %s" % thread.get_ident()
    return [output] 
```

我很快注意到，过了一会儿，后续请求会重用相同的线程。

如果我的理解是正确的，为了让我的应用程序具有“特定于上下文”的变量，我需要使用类似于以下的方案来存储它们：

```
lock = thread.allocate_lock()
lock.acquire()
thread_id = get_ident()
threadsafe[thread_id]['user'] = request.username
lock.release() 
```

然后我可以以类似的方式从应用程序的不同部分访问它们。在这种情况下，我唯一的保证是该值属于该特定线程。然而，使用同一个线程的请求可能仍然会踩到对方的脚趾（例如，请求访问来自先前请求的剩余值）。我的结论是，要以真正独特的方式处理每个请求，除了“thread_id”之外，我还需要另一个键来区分使用同一线程的请求。

使用 uuid 之类的唯一键，我可以做到这一点

```
lock.acquire()
uuid = uuid.uuid4()
thread_id = get_ident()
threadsafe[(thread_id, uuid)]['user'] = request.username
lock.release() 
```

但这意味着我也有办法以线程安全的方式检索 uuid 值，就像我以后可以检索 thread_id 一样。

我得出了正确的结论吗？如果是这样，我如何获得该附加密钥？

**编辑**

我突然想到我的问题是错误的二分法。我以线程可以与自身同时运行的观点来处理事情，而实际上这是不可能的。使用同一线程的请求必须串行运行。因此，我实际上可以使用 uuid 来避免使用线程的陈旧值，但只有在将其存储为线程保存值本身之后。

```
# somewhere early in the request
threadsafe[thread_id]['current_uuid'] = uuid.uuid4()

# later
lock.acquire()
thread_id = get_ident()
uuid = threadsafe[thread_id]['current_uuid']
threadsafe[(thread_id, uuid)]['user'] = request.username
lock.release() 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-06T23:18:33.400

*该答案基于@user590028 答案的评论中开发的新信息。*

您说您的目标是拥有线程安全的持久数据。因为您还说您正在熟悉 WSGI 规范，所以我觉得这个链接特别相关：[Application_Global_Variables](http://code.google.com/p/modwsgi/wiki/ApplicationIssues#Application_Global_Variables)

> ...虽然可以使用全局数据，但它只能用于缓存可以在该单个进程的上下文中安全重用的数据。您不能使用全局数据作为保存任何请求处理程序必须可见的信息的手段，无论它在哪个进程中运行。

您的应用程序可能不仅在多个线程下运行，而且可能在多个进程下运行。根据上面的链接，对于持久数据（超出当前请求）的推荐解决方案是使用外部存储解决方案（文件系统、数据库、memcached ......）

### 更新

你试图用锁来保存状态信息似乎完全没有必要。无论如何，每个请求都应该被认为是唯一的。如果客户端用户向您的应用程序发出 10 个请求，并且您希望在这些请求中保留数据，那么您应该使用会话密钥（如 cookie），当他们的请求是新的（不包含会话）时您首先向客户端建立，然后您在响应中返回它并期望将来的请求提供此密钥。随后，有一些库旨在为您提供此功能：[http ://www.ollycope.com/software/pesto/session.html](http://www.ollycope.com/software/pesto/session.html)

wsgi 应用程序有一个入口点，在这种情况下，您的示例将其定义为一个名为“应用程序”的函数。它也可能是一个类或任何可调用的东西。由于范围，您的变量本质上是特定于上下文的。无论您对该范围做什么，都与运行同一处理程序的任何其他线程完全不同。“应用程序”函数可能更复杂，调用其他函数并传递其变量，直到最终返回其响应体。您还可以创建一个类实例，其中包含处理请求和生成响应所需的所有功能，并使用它自己的实例变量。

如果前两个建议都不适用于您的要求，我认为唯一剩下的可能性是您确实希望将数据存储在数据库、文件系统、memcached 或 redis 等中。uuid4 将是唯一的，但它的值只有在您在响应中传递它并让客户端返回它以保持与该数据的关联时才有意义。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-06T22:22:55.127

你说的对。线程 id 不保证随着时间的推移是唯一的。考虑 UUID。像 str(uuid.uuid4()) 这样的东西

# gem - 不能使用hirb rails gem

> ID：10049877
> 
> 赞同：5
> 
> 时间：2012-04-06T22:17:24.303
> 
> 标签：gem

[变化]

*   问题不是“enale”的错字而不是“启用”
*   安装没有问题的`--no-ri --no-rdoc`标志
*   现在这样做`require enable`给出了一个错误而不是`false`（不知道为什么）

我在使用 Gem [hirb](https://github.com/cldwalker/hirb)格式化 rails 控制台的输出时遇到了一些问题。

```
$ gem install hirb --no-ri --no-rdoc
Successfully installed hirb-0.6.2
1 gem installed

$ rails c
Loading development environment (Rails 3.2.3)
irb(main):001:0> require 'hirb'
LoadError: cannot load such file -- hirb
        from c:/Ruby193/lib/ruby/gems/1.9.1/gems/activesupport-3.2.3/lib/active_
support/dependencies.rb:251:in `require'
        from c:/Ruby193/lib/ruby/gems/1.9.1/gems/activesupport-3.2.3/lib/active_
support/dependencies.rb:251:in `block in require'
        from c:/Ruby193/lib/ruby/gems/1.9.1/gems/activesupport-3.2.3/lib/active_
support/dependencies.rb:236:in `load_dependency'
        from c:/Ruby193/lib/ruby/gems/1.9.1/gems/activesupport-3.2.3/lib/active_
support/dependencies.rb:251:in `require'
        from (irb):1
        from c:/Ruby193/lib/ruby/gems/1.9.1/gems/railties-3.2.3/lib/rails/comman
ds/console.rb:47:in `start'
        from c:/Ruby193/lib/ruby/gems/1.9.1/gems/railties-3.2.3/lib/rails/comman
ds/console.rb:8:in `start'
        from c:/Ruby193/lib/ruby/gems/1.9.1/gems/railties-3.2.3/lib/rails/comman
ds.rb:41:in `<top (required)>'
        from script/rails:6:in `require'
        from script/rails:6:in `<main>'
irb(main):002:0> 
```

我正在运行 Ruby 1.9.3、Rails 3.2.3、Bundler 1.1.3、Windows 7 64 位。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-04-12T23:35:29.117

你打错了，你应该输入`Hirb.enable`

添加`gem hirb`到您的 rails 项目的 Gemfile 中。

# asp.net - 如何在asp.net中隐藏寻呼机

> ID：10049880
> 
> 赞同：1
> 
> 时间：2012-04-06T22:17:57.407
> 
> 标签：asp.net, pager

我正在使用寻呼机与 ListView 进行分页，但问题是，当没有从表中找到行时。在这种情况下，寻呼机也显示分页。所以，我的问题是，我怎样才能隐藏寻呼机。当 ListView 显示消息时`no row found`。

提前致谢 ！！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-06T22:28:10.967

您可以使用该[`DataBound`](http://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.basedataboundcontrol.databound.aspx)事件来隐藏它：

```
protected void jobSearchResult_DataBound(Object sender, EventArgs e)
{
     DataPager pager = (DataPager)jobSearchResult.FindControl("jobSearchPager");
     pager.Visible = pager.TotalRowCount > pager.MaximumRows;
} 
```

**编辑**：假设您使用的是 VB.NET

```
Protected Sub jobSearchResult_DataBound(ByVal sender As Object, ByVal e As System.EventArgs) 
    Dim pager = DirectCast(jobSearchResult.FindControl("jobSearchPager"), DataPager)
    pager.Visible = pager.TotalRowCount > pager.MaximumRows 
End Sub 
```

如果您的寻呼机不是 ListView 的一部分（在 ListView`LayoutTemplate`之外），您可以直接引用它而不使用`FindControl`：

```
jobSearchPager.Visible = jobSearchPager.TotalRowCount > jobSearchPager.MaximumRows 
```

*   [DataPager.TotalRowCount 属性](http://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.datapager.totalrowcount.aspx)
*   [DataPager.MaximumRows 属性](http://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.datapager.maximumrows.aspx)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-06T22:23:56.093

在您的数据绑定方法中，您可以检查项目源计数。如果它为零，则将寻呼机的可见性设置为 false。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-06T22:28:06.560

检查您检索到的数据的结果，如果是空呼叫：

```
DataPager.Visible = false; 
```

# html - 过度滚动 y 填满剩余空间？

> ID：10049888
> 
> 赞同：0
> 
> 时间：2012-04-06T22:18:28.750
> 
> 标签：html, css

我目前正在构建一个固定在页面底部的页脚元素。

```
 <div id='footer'>
    <div id='chat'> 
      <input class='input-medium' type='text' placeholder="Say something..."/>
      <button class='btn'>Send</button>
    </div>

    <div id='logs'>
       <!-- There will be a lot of logs here and it will be scrollable-y --> 
    </div>
  </div> 
```

我想以这样一种方式构造这个元素，使我的用户可以（垂直）调整它的大小，使其达到他们喜欢的高度。我会调整大小，以便调整页脚元素的大小将调整#logs 的大小。

我应该如何构建我的 CSS，以便我可以简单地为页脚设置一个高度，以便：

*   #chat 将首先填满空间。
*   #logs 将填满剩余的空间。如果有溢出，#logs 会溢出吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-06T22:26:38.243

听起来您刚刚准确地描述了您的需求。不确定您是否需要我们的帮助！只需将日志设置为 100% 并溢出-y 即可滚动。

[http://jsfiddle.net/LPPAP/1](http://jsfiddle.net/LPPAP/1)

```
#footer {
    position: fixed;
    bottom: 0;
    width: 600px;
    border: 1px solid gray;
    background: lightgray;
    border-radius: 15px 15px 0px 0px;
    padding: 10px;
    height: 200px;    
    left: 50%;
    margin-left: -300px;
}
#logs { height: 100%; overflow-y: scroll; margin-top: 20px; } 
```

# ajax - jQuery：检测 XHR() 延迟

> ID：10049891
> 
> 赞同：1
> 
> 时间：2012-04-06T22:19:02.537
> 
> 标签：ajax, jquery, xmlhttprequest

**检测延迟的 XHR 请求**（`jQuery.ajax()`或`jQuery.load()`）**不是超时**（x 秒后）的最佳方法是什么？

我正在寻找一种解决方案来显示用户界面的等待消息（连接中止）。

# php - HTML Purifier - 允许链接？

> ID：10049906
> 
> 赞同：2
> 
> 时间：2012-04-06T22:21:09.357
> 
> 标签：php, htmlpurifier

该网站是404'ing，所以我无法在那里搜索。我试过查看文档，但不清楚在哪里可以找到它。我已经使用我想要允许和包含的标签列表进行了配置，`<a>`但 HTML Purifier 删除了`href`. 我需要在配置中添加什么以允许在`href`HTML Purifier 的默认设置中使用它？

-编辑-

这就是我现在所拥有的：

```
$config = HTMLPurifier_Config::createDefault();
    $config->set('HTML.AllowedAttributes', 'a.href');
    $config->set('HTML.Allowed', 'various tags');
    $config->set("HTML.Nofollow", true);
    $config->set('CSS.AllowedProperties', ''); 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-06T23:08:16.713

添加 `$config->set('HTML.AllowedAttributes', 'a.href');`成功了。不过，我想听听Edward Yang对此事的看法，因为根据他的回复，他认为没有必要。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-06T22:28:56.733

默认情况下允许使用 Href。更有可能是您意外启用了魔术引号。关闭它们。

（PS 该网站已关闭，因为 Dreamhost 很烂，并吃掉了它的磁盘。我们正在等待他们完成恢复...）

# iphone - 我可以同时使用 UIPageViewControllers 吗？

> ID：10049909
> 
> 赞同：0
> 
> 时间：2012-04-06T22:21:28.293
> 
> 标签：iphone, ios, ipad, uikit, uipageviewcontroller

我想同时显示 2 本书。（对于 iPad）我可以为此使用 UIPageViewControllers 吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-07T17:34:51.753

毫无疑问，你可以，只要每本书都包含在它自己的观点中。

# mysql - 我需要帮助从 mysql 中的连接表中定义变量

> ID：10049912
> 
> 赞同：0
> 
> 时间：2012-04-06T22:21:52.613
> 
> 标签：mysql

我很难从连接中的第二个表定义变量。

这是我的代码

```
$sql = "SELECT *
    FROM Catalog
        LEFT OUTER JOIN Client_Data on CatalogMgr.partnumber = Client_Data.partnumber
        LEFT OUTER JOIN Clients on Client_Data.Client_id = Clients.Client_Id
        LEFT OUTER JOIN Clients C1 on Clients.Client_Name = C1.Client_Name
        WHERE  Clients.Client_Id = '".$C_ID."'
        AND Avail_Flag = 10";

$CL_Name = Clients.Client_Name; 
```

//结果
$result = mysql_query($sql);

```
while ($row = mysql_fetch_array($result)) 
```

====在输出页面上

```
echo "$CL_Name"; 
```

是空的。

====我试过了

```
$CL_name = $row['Clients.Client_Name'];
$CL_name = $row['Client_Name']; 
```

并且都返回一个空变量。

谢谢你的帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-07T06:45:37.503

为什么不这样选择

```
$sql = "SELECT Catalog.* , Client_Data.name as `Client_Name`
FROM Catalog
    LEFT OUTER JOIN Client_Data on CatalogMgr.partnumber = Client_Data.partnumber
    LEFT OUTER JOIN Clients on Client_Data.Client_id = Clients.Client_Id
    LEFT OUTER JOIN Clients C1 on Clients.Client_Name = C1.Client_Name
    WHERE  Clients.Client_Id = '".$C_ID."'
    AND Avail_Flag = 10";

   $CL_Name = Clients.Client_Name; 
```

和这样的 php echo

```
echo $row['Client_Name']; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-06T22:31:52.530

第一个 LEFT OUTER JOIN 看起来不对。 `CatalogMgr`=> `Catalog`?

# c# - 通过 UDP 连接在 C# 中读取此 C++ 编组数据

> ID：10049913
> 
> 赞同：0
> 
> 时间：2012-04-06T22:21:56.563
> 
> 标签：c#, c++, marshalling

此结构化数据通过 UDP 连接发送。我可以读取 UDP 数据包，但无法解析来自此 C++ 结构的数据。

这是结构：

```
struct scanner_status{
    // ---
    u_short UDP_STATUS;
    u_short TCP_COMMAND;
    u_short TCP_LOGGING;
    // scanner attributes
    EPlatformModelNumber ModelNo;
    string SerialNo;
    bool bHasCT;
    bool bHasPET;
    bool bHasSPECT;
    // physical
    EBedType_mMM _eCurrBedType;
    int_16 _CurrPallet;
    bool _bTunnelPresent;
    //
    scanner_status()
      : UDP_STATUS(u_short(~0))
      , TCP_COMMAND(u_short(~0))
      , TCP_LOGGING(u_short(~0))
      , ModelNo(eUnknownPlatformModelNumber)
      , bHasCT(false)
      , bHasPET(false)
      , bHasSPECT(false)
      , _eCurrBedType(emMM_BedType_Unknown)
      , _CurrPallet(-1)
      , _bTunnelPresent(false)
    { }
};
decl_marshalling(scanner_status); 
```

我想在用 C# 阅读这篇文章时获得帮助，但我对 C++ 和编组并不十分熟悉，非常感谢任何帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-06T22:44:57.550

您需要在 c# 中创建具有等效 .net 类型的类似结构。您还需要按如下方式装饰您的 c# 结构。确保顺序与 c++ 结构中的顺序相同，因为您需要确保内存布局相同。

```
[StructLayout(LayoutKind.Sequential)]
struct scanner_status{
// ---
[MarshalAs(UnmanagedType.U1)]
u_short UDP_STATUS;
[MarshalAs(UnmanagedType.U1)]
u_short TCP_COMMAND;
[MarshalAs(UnmanagedType.U1)]
u_short TCP_LOGGING; 
```

这是来自 Microsoft 的一些帮助。[关联](http://msdn.microsoft.com/en-us/library/aa446538.aspx)

如果您还有问题，请告诉我。

# jquery - 在 MVC3 中处理验证 - 每个复选框组必须选择一个复选框

> ID：10049914
> 
> 赞同：0
> 
> 时间：2012-04-06T22:21:57.730
> 
> 标签：jquery, asp.net-mvc-3, validation

[标题应该说“每个问题必须选择一个复选框”，但是标题中不允许使用“问题”一词]

简单的 Q/A 表格。举一个例子，有 7 个问题。在 POST 上，我的控制器操作需要一个`IEnumerable<AssessmentQuestionsModel>`. 我的`AssessmentQuestionsModel`implements`IValidatableObject`和我的 Validate 方法如下：

```
public IEnumerable<ValidationResult> Validate(ValidationContext validationContext)
{
    if (this.assessmentAnswers.Where(e => e.userAnswer == true).Count() == 0)
    {
        yield return new ValidationResult("You must select at least one answer for every question");
        yield break;
    }
} 
```

这在视图级别工作正常 - 它返回该错误消息并将其显示在验证摘要中。问题是，它返回 7 次，每个问题一个。现在我正在使用 jQuery 来评估验证摘要 UL 并删除重复项，但这似乎是一个 hack。我究竟做错了什么？

谢谢

[编辑 - 测试验证结果过载]

以下实际上是调用了两次。但是，它们没有分组，并且仍然显示多个验证错误。

```
if (this.assessmentAnswers.Where(e => e.UserAnswer== true).Count() == 0)
{
    yield return new ValidationResult("You must select at least one answer for every question", new List<string>() { "NoAnswerMarked" });
    yield break;
} 
```

[编辑-查看信息]

```
@using System.Linq
@using System.Collections.Generic
@model IList<Academy.AssessmentQuestionsModel>

@{
    ViewBag.Title = "TakeAssessment";
    ViewBag.PageID = "TakeAssessment";
}
@section TitleBar {
    <span>
    @if(ViewBag.Status == "questions") {    
        <text>Take Assessment</text>
    } else {
        <text>Assessment Response</text>
    }
    </span>
}
@section JS {
<script type="text/javascript">
    $(function () {
        if ($(".validation-summary-errors li:contains('You must select at least one answer for every question')").length > 0) {
            $(".validation-summary-errors ul")
                .find("li:contains('You must select at least one answer for every question')")
                .remove()
                .end()
                .append("<li>You must select at least one answer for every question</li>");
        }
        $("#asubmit").click(function (e) {
            var hasErrors = false;
            $(".newAnswerWrapper").each(function () {
                if ($(this).find('input[type="checkbox"]:visible:checked').length == 0) {
                    e.preventDefault();
                    hasErrors = true;
                    return false;
                }
            });
            if (hasErrors) {
                $(".validation-summary-valid").find("ul").append("<li>You must select at least one answer for every question</li>").end().show();
            } else {
                $(".validation-summary-errors").find("li:contains('You must select at least one answer for every question'')").remove().end().hide();
            }
        });
    });
</script>
}
@using (Html.BeginForm())
{
    @Html.ValidationSummary(false)
<fieldset>
    <legend></legend>
    <div class="takeAssessment">
    @if(!string.IsNullOrEmpty(ViewBag.AssessmentInstructions)) {
        <h4>Instructions</h4>
        <p>@ViewBag.AssessmentInstructions</p>
    }
    @{
    int questionCount = 0;
    int totalQuestions = Model.Count();

    @Html.Hidden("ModuleID", (int)ViewBag.ModuleID)
    for (var i = 0; i < Model.Count; i++)
    {

        @Html.HiddenFor(m => m[i].questionDescription)
            <div class="newQuestionWrapper">
                    <h4>Question @(i + 1) of @totalQuestions</h4>
                    @Html.HiddenFor(m => m[i].assessmentID)
                    @Html.HiddenFor(m => m[i].assessmentQuestionID)
                    <p class="questionDescription">@Model[i].questionDescription</p>
                    <div class="newAnswerWrapper"></div>

                <div class="newAnswerWrapper">
                    <div class="answerHeader">
                        <p class="correct">Select</p><p class="answers">Answer(s)</p>
                    </div>

                 @for (var j = 0; j < Model[i].assessmentAnswers.Count(); j++)
                 {
                    @Html.HiddenFor(m => m[i].assessmentAnswers[j].assessmentAnswerID)
                    @Html.HiddenFor(m => m[i].assessmentAnswers[j].assessmentQuestionID)
                    @Html.HiddenFor(m => m[i].assessmentAnswers[j].assessmentAnswer)

                     if (ViewBag.Status == "questions")
                     {          
                         <div class="answerRow">
                            <span class="isAnswer first">@Html.CheckBoxFor(m => m[i].assessmentAnswers[j].userAnswer)</span>
                            <span class="answerDisplay">@Html.DisplayFor(m => m[i].assessmentAnswers[j].assessmentAnswer)</span>
                            @Html.HiddenFor(m => m[i].assessmentAnswers[j].isAnswer)
                            <div class="clear"></div>
                         </div>
                     }
                     else
                     {
                        <div class="answerRow">
                            @{
                                string cls = Model[i].assessmentAnswers[j].isAnswer ? "correct" : "incorrect";
                            }
                            <span class="isAnswer first">@Html.CheckBoxFor(m => m[i].assessmentAnswers[j].userAnswer, new { @disabled = "disabled" })</span>
                            <span class="answerDisplay" style="width: 510px !important;">@Html.DisplayFor(m => m[i].assessmentAnswers[j].assessmentAnswer)</span>
                            <span class="isAnswer"><span class="@cls">@Html.DisplayFor(m => m[i].assessmentAnswers[j].isAnswer)</span></span>

                            <div class="clear"></div>
                        </div>
                     }
                     <div class="clear"></div>
                 }

              </div>

    <div class="clear"></div>
            </div>
    }
}

    <div class="clear"></div>
    </div>
    @if (ViewBag.Status == "questions")
    {
    <input type="submit" id="submit" value="Submit Assessment" class="redButton197x38" />
    }
</fieldset>
}
<p>
    @Html.ActionLink("Back to Module", "Learn", new { id = ViewBag.ModuleID }, new { @class = "redButton197x38" })
</p> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-07T00:05:07.933

我一直在考虑你的问题，我认为这个问题比我想的要简单得多，ValidationResult 类有一个重载的构造函数，它要求传入成员名称，如果你传入相同的键（新列表(){ "QuestionError" }) ) 在这里它应该将它们分组并且只显示一个结果。

# wpf - 如何使边距相对于 UIElement 的中心而不是网格中的左上角？

> ID：10049916
> 
> 赞同：1
> 
> 时间：2012-04-06T22:22:32.600
> 
> 标签：wpf, grid, margin, uielement

我希望该`Margin`属性引用中心`UIElement`而不是左上角。这样，当我更改它的宽度/高度时，`UIElement`它会保持在同一个位置。

有没有办法配置这种行为，或者我必须依靠 Binding 来进行调整？

谢谢。

例如，如果我更改`Width/Height`以下矩形的 ，它的中心会移动。

```
<Grid>
    <Rectangle Fill="#FF991C1C" Width="10" Height="40" HorizontalAlignment="Left" Margin="90,161,0,0" VerticalAlignment="Top"/>
</Grid> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-06T22:28:21.750

为什么不删除边距并使用这些？

```
HorizontalAlignment="Center"
VerticalAlignment="Center" 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-07T11:26:14.710

由于一个模糊的原因，如果我希望边距相对于中心，我无法弄清楚矩形对齐应该是中心。这段代码使我的 Rectangle 表现得像我想要的那样。

```
<Grid>
    <Rectangle Fill="#FF991C1C" Width="10" Height="40" HorizontalAlignment="Center" Margin="90,161,0,0" VerticalAlignment="Center"/>
</Grid> 
```

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2020-04-09T14:56:03.720

在某些情况下，当尝试基于元素的中心而不是边缘仅使用单个边距属性定位元素时，我发现此解决方案很有用：

```
/* Declare a CSS variable equal to your element's width. */

:root{
   --my-element-width: 40px;
}

/* Declare your margin as 50% minus half the element's width */

.myClass {
  margin-right: calc(50% - var(--my-element-width));
}

/* Apply this class to the element in question. */ 
```

# cakephp - cakephp 复选框显示额外的隐藏字段

> ID：10049917
> 
> 赞同：3
> 
> 时间：2012-04-06T22:22:45.673
> 
> 标签：cakephp, cakephp-1.3, cakephp-2.0

```
foreach($apps as $app){

        echo $this->Form->input('Application', array('type'=>'checkbox', 'id'=>$app['Application']['description'], 'div'=>false,'type'=>'checkbox','value' => $app['Application']['description'],'label'=>$app['Application']['description']));

    }

<div class="checkboxes"> 
    <input type="hidden" name="data[Group][Application]" id="GG_" value="0"/><input type="checkbox" name="data[Group][Application]"  id="GG" value="GG"/><label for="GG">GG</label><input type="hidden" name="data[Group][Application]" id="BS_" value="0"/><input type="checkbox" name="data[Group][Application]"  id="BS" value="BS"/><label for="BS">BS</label>  <div>
</div>
    <input type="hidden" name="data[Group][Grant]" id="GroupGrant_" value="0"/><input type="checkbox" name="data[Group][Grant]"  style="float: left; display: inline" value="Edit Weather" id="GroupGrant"/><label for="GroupGrant">Edit Weather</label><input type="hidden" name="data[Group][Grant]" id="GroupGrant_" value="0"/><input type="checkbox" name="data[Group][Grant]"  style="float: left; display: inline" value="Edit Traffic" id="GroupGrant"/><label for="GroupGrant">Edit </label>       

        </div> 
```

不确定隐藏字段来自哪里。谢谢

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-06T22:25:40.693

这是一个蛋糕后备，以防您没有选择复选框并发布表单以进行验证。在这种情况下，php 不会为此字段提交任何内容（甚至不是空字符串）。因此 cake 找到了一个聪明的解决方法来克服这个问题。

顺便说一句，单选按钮类似的东西。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-03-12T12:32:04.037

即使有一个隐藏字段，我们可以在提交表单时将其禁用，这样它就不会出现在提交的数据中..您需要按以下方式编写..

```
echo $this->Form->input('Application', array('type'=>'checkbox', 'id'=>$app['Application']['description'], 'div'=>false,'type'=>'checkbox','value' => $app['Application']['description'],'label'=>$app['Application']['description'],'hiddenField'=>false)); 
```

# clojure - 懒惰的并列功能有什么优点吗？

> ID：10049925
> 
> 赞同：2
> 
> 时间：2012-04-06T22:24:07.367
> 
> 标签：clojure, functional-programming, lazy-evaluation

在回答有关使用相同参数（A：juxt）映射多个函数的函数[的问题](https://stackoverflow.com/questions/10044254/is-there-a-reverse-map-function)时，我想出了一个与 juxt 基本采用相同形式但使用 map 的函数：

```
(defn could-be-lazy-juxt
  [& funs]
  (fn [& args]
    (map apply funs (repeat args))))

=> ((juxt inc dec str) 1)
[2 0 "1"]
=> ((could-be-lazy-juxt inc dec str) 1)
(2 0 "1")

=> ((juxt * / -) 6 2)
[12 3 4]
=> ((could-be-lazy-juxt * / -) 6 2)
(12 3 4) 
```

我对它的懒惰或性能一无所知，但 REPL 中的时间确实表明正在发生一些懒惰的事情。

```
=> (time (apply (juxt + -) (range 1 100)))
"Elapsed time: 0.097198 msecs"
[4950 -4948]
=> (time (apply (could-be-lazy-juxt + -) (range 1 100)))
"Elapsed time: 0.074558 msecs"
(4950 -4948)

=> (time (apply (juxt + -) (range 10000000)))
"Elapsed time: 1019.317913 msecs"
[49999995000000 -49999995000000]
=> (time (apply (could-be-lazy-juxt + -) (range 10000000)))
"Elapsed time: 0.070332 msecs"
(49999995000000 -49999995000000) 
```

我确信这个功能并不是那么快（结果的打印“感觉”在两者中都一样长）。对函数执行 'take x' 只会限制评估函数的数量，这可能会限制其适用性，并且通过 'take' 限制其他参数在正常并列中应该同样懒惰。

这并列真的很懒吗？惰性并列是否会给表格带来任何有用的东西，例如作为其他惰性函数之间的合成步骤？性能（内存/cpu/对象计数/编译）有什么影响？为什么 Clojure juxt 用 reduce 实现并返回一个向量，这打破了惰性？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-06T23:12:58.153

是的，你的 juxt 实现是懒惰的，因为它只调用了懒惰的 map。

在没有意识到调用者中的参数的情况下很难以现在的形式调用它（通过使用apply。所以我对其进行了一些更改以获取一系列函数：

```
user> (defn could-be-lazy-juxt
  [funs]
  (fn [& args]
    (map #(apply %1 %2) funs (repeat args))))
#'user/could-be-lazy-juxt 
```

然后定义一个惰性函数序列，当它实现时会产生大量输出

```
user> (defn loud-seq [len] (take len (map #(do (println "produced a function") %) (cycle [inc dec]))))
#'user/loud-seq 
```

然后使用 juxt 从这个惰性函数序列中创建一个函数

```
user> (def f (could-be-lazy-juxt (loud-seq 50)))
#'user/f 
```

如您所见，列表仍然是惰性的，它在调用结果函数时实现了它的函数列表。

所以让我们称之为：

```
user> (f 1)
(produced a function
produced a function
2 produced a function
produced a function
0 2 produced a function
produced a function
0 2 produced a function
produced a function
0 2 produced a function
produced a function
0 2 produced a function
produced a function
0 2 produced a function
produced a function
0 2 produced a function
produced a function
0 2 produced a function
produced a function
0 2 produced a function
produced a function
0 2 produced a function
produced a function
0 2 produced a function
produced a function
0 2 produced a function
produced a function
0 2 produced a function
produced a function
0 2 produced a function
produced a function
0 2 produced a function
produced a function
0 2 produced a function
produced a function
0 2 produced a function
produced a function
0 2 produced a function
produced a function
0 2 produced a function
produced a function
0 2 produced a function
produced a function
0 2 produced a function
produced a function
0 2 produced a function
produced a function
0 2 produced a function
produced a function
0 2 produced a function
produced a function
0 2 0)
user> 
```

我把这样做的原因留给你；）

# jquery - 如何使用 jquery 选择来自不同 DOM 级别的相似元素？

> ID：10049926
> 
> 赞同：2
> 
> 时间：2012-04-06T22:24:08.933
> 
> 标签：jquery

我只想从同一级别中选择“mixitup”元素，单击其中一个元素。

```
<div data-id="0">
    <div class="mixitup">1</div>
    <div class="mixitup">2</div>
    <div class="mixitup">3</div>
</div>
<div data-id="1">
    <div class="mixitup">4</div>
    <div class="mixitup">5</div>
    <div class="mixitup">6</div>
</div> 
```

我是说。如果我单击内容 = 4 的 DIV，我想选择 DIV 4,5 和 6。

有人知道一种方法吗？谢谢

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-06T22:31:01.697

如果您想选择所有这些，包括您选择的那个。[http://jsfiddle.net/kwnDS/1/](http://jsfiddle.net/kwnDS/1/)

```
$('.mixitup').on('click', function() {
    $(this).siblings().andSelf();
}); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-06T22:37:13.063

兄弟姐妹，包括 self 元素，将通过查找父节点并选择其所有子节点（而不是后代）来完成：

```
$(".mixitup").click(function () {
    $(this).parent().children().doSomething();
}); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-06T23:06:25.170

为了避免选择被点击元素的父元素，你应该简单地选择它的兄弟元素和它自己：

```
$(".mixitup").on("click", function(e) {
  $('.mixitup').removeClass('clicked');
  $(this).siblings().andSelf().addClass("clicked");
}​); 
```

[http://jsfiddle.net/crazytonyi/G4Bny/](http://jsfiddle.net/crazytonyi/G4Bny/)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-06T22:27:14.577

您需要的是兄弟姐妹选择器：

```
$('.mixitup').click(function(){
  $(this).siblings('.mixitup'); //this selects siblings of an element;
}) 
```

# ruby - 将未知数量的参数传递给 ruby 函数

> ID：10049932
> 
> 赞同：2
> 
> 时间：2012-04-06T22:24:34.780
> 
> 标签：ruby, syntax

我正在编写一个方法来包装另一个方法作为类的一部分。它需要接受和传递任意数量的参数。

就像是...

```
def do(*things)
  old_method(things)
end 
```

除了这不起作用，因为 old_method 需要将 things 数组的内容作为单独的参数而不是作为数组传递。

我只是想不出在 ruby​​ 语法中做到这一点的方法......

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-06T22:32:45.403

您可以使用：

```
def do(*things)
  old_method(*things)
end 
```

那是一个 splat 运算符，请参阅例如[What does the (unary) * operator do in this Ruby code？](https://stackoverflow.com/questions/918449/what-is-the-operator-doing-to-this-string-in-ruby)或者 [splat 在这里做什么？](https://stackoverflow.com/questions/1456146/whats-the-splat-doing-here)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-06T22:32:29.163

同样的方式你得到的论点，`old_method(*things)`。

# ruby - Ruby 在继承的类中执行代码

> ID：10049934
> 
> 赞同：1
> 
> 时间：2012-04-06T22:25:08.613
> 
> 标签：ruby, oop

我试图能够进行全局异常捕获，以便在发生错误时添加额外信息。我有两个班级，“爬虫”和“亚马逊”。我想要做的是能够调用“crawl”，在amazon中执行一个函数，并在crawl函数中使用异常处理。

这是我的两个课程：

```
require 'mechanize'

class Crawler
  Mechanize.html_parser = Nokogiri::HTML

  def initialize
    @agent = Mechanize.new
  end

  def crawl
    puts "crawling"

    begin
      #execute code in Amazon class here?
    rescue Exception => e
      puts "Exception: #{e.message}"
      puts "On url: #{@current_url}"
      puts e.backtrace
    end
  end

  def get(url)
    @current_url = url
    @agent.get(url)
  end
end

class Amazon < Crawler
  #some code with errors
  def stuff
    page = get("http://www.amazon.com")
    puts page.parser.xpath("//asldkfjasdlkj").first['href']
  end
end

a = Amazon.new
a.crawl 
```

有没有办法可以在“crawl”中调用“stuff”，这样我就可以对整个 stuff 函数使用异常处理？有没有更好的方法来实现这一点？

编辑：这是我结束的时候

```
require 'mechanize'

class Crawler
  Mechanize.html_parser = Nokogiri::HTML

  def initialize
    @agent = Mechanize.new
  end

  def crawl
    yield
  rescue Exception => e
    puts "Exception: #{e.message}"
    puts "On url: #{@current_url}"
    puts e.backtrace
  end

  def get(url)
    @current_url = url
    @agent.get(url)
  end
end

c = Crawler.new

c.crawl do
  page = c.get("http://www.amazon.com")
  puts page.parser.xpath("//asldkfjasdlkj").first['href']
end 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-06T22:53:10.507

我设法通过“超级”和占位符功能获得了所需的功能。还有更好的方法来做到这一点吗？

```
require 'mechanize'

class Crawler
  Mechanize.html_parser = Nokogiri::HTML

  def initialize
    @agent = Mechanize.new
  end

  def stuff
  end

  def crawl
    stuff
  rescue Exception => e
    puts "Exception: #{e.message}"
    puts "On url: #{@current_url}"
    puts e.backtrace
  end

  def get(url)
    @current_url = url
    @agent.get(url)
  end
end

class Amazon < Crawler
  #some code with errors
  def stuff
    super
    page = get("http://www.amazon.com")
    puts page.parser.xpath("//asldkfjasdlkj").first['href']
  end
end

a = Amazon.new
a.crawl 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-06T23:24:53.700

您可以抓取接受代码块：

```
def crawl
  begin
    yield
  rescue Exception => e
    # handle exceptoin
  end
end

def stuff
  crawl do
    # implementation of stuff
  end
end 
```

我对没有实体的方法并不疯狂。代码块在这里可能更有意义。根据您想要做什么，还可以消除对子类化的需要。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-07T00:21:36.800

如果您想换一种方式，请查看“策略”设计模式：

```
# test_mach.rb
require 'rubygems'
require 'mechanize'

# this is the context class,which calls the different strategy implementation
class Crawler
  def initialize(some_website_strategy)
    @strategy = some_website_strategy
  end

  def crawl
    begin
      @strategy.crawl
      #execute code in Amazon class here?
    rescue Exception => e
      puts "==== starts this exception comes from Parent Class"
      puts e.backtrace
      puts "==== ends  this exception comes from Parent Class"
    end
  end
end

# strategy class for Amazon
class Amazon
  def crawl
    puts "now crawling amazon"
    raise "oh ... some errors when crawling amazon"
  end
end

# strategy class for taobao.com 
class Taobao
  def crawl
    puts "now crawling taobao"
    raise "oh ... some errors when crawling taobao"
  end
end 
```

然后运行此代码：

```
amazon = Crawler.new(Amazon.new)
amazon.crawl
taobao = Crawler.new(Taobao.new)
taobao.crawl 
```

结果：

```
now crawling amazon
==== starts this exception comes from Parent Class
test_mach.rb:27:in `crawl'
test_mach.rb:13:in `crawl'
test_mach.rb:38
==== ends  this exception comes from Parent Class
now crawling taobao
==== starts this exception comes from Parent Class
test_mach.rb:34:in `crawl'
test_mach.rb:13:in `crawl'
test_mach.rb:40
==== ends  this exception comes from Parent Class 
```

顺便提一句。对于您的实施，基本上我对您做了同样的事情。除了

```
# my implementation
class Crawler
  def stuff
    raise "abstract method called"
  end
end 
```

如果您想要另一种方式，请查看“围绕别名”（<< metaprogramming ruby​​>>，第 155 页）。但是我认为“围绕别名”是策略的还原案例。

（ 我是说，

*   在策略模式中，您首先实现“上下文”类，然后您需要实现“策略”类。
*   但是在“围绕别名”法术中，您首先需要实现一个“策略”，然后编写一个“围绕别名”“策略”的新类......

错误...希望我没有让您感到困惑^_^）

# ruby-on-rails - 奇怪的 Rails 3.2 Apache 乘客 500 错误

> ID：10049938
> 
> 赞同：0
> 
> 时间：2012-04-06T22:25:51.297
> 
> 标签：ruby-on-rails, apache, passenger

我有一个新的 rails 应用程序，它可以在本地运行，并且可以在我的测试服务器上运行，但不能在生产服务器上运行。奇怪的是，它适用于某些路线，但不适用于其他路线。

我正在使用活动管理员，并且我在 active_admin 登录后面设置的所有表单都可以正常工作，但是我的所有公共视图和主页一直显示 500 错误。

测试和生产的配置几乎相同，即使我在 vhost.conf 中设置了日志记录，它也没有在应用程序日志或 apache 日志中记录任何内容。

我假设这是一个权限或 gem 问题，但似乎无法找到导致它的任何原因。

**编辑：另外我应该注意，当我去的时候，我所有的资产都可以正常使用。我可以通过 URL 直接访问它们并且它们可以工作。**

Rails 控制台也适用于我的所有对象。我今天花了很多时间在这上面，并且没有运气地查看了很多类似的问题。任何有关如何调试的建议都会非常有帮助。提前致谢。

编辑：这是我的 .conf 条目：

```
<VirtualHost *:80>
    DocumentRoot /var/www/app_admin/public/
    <Directory /var/www/app_admin/public>
                            AllowOverride all
    </Directory>
    ServerName www.mydomainname.com
    ServerAlias mydomainname.com
    ErrorLog /var/log/httpd/app_admin/error.log
    CustomLog /var/log/httpd/app_admin/access.log common
</VirtualHost> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-12-12T03:11:33.007

我以前遇到过这种情况。

什么（我相信）导致奇怪的是 Apache 从开发而不是生产中获取资源，因为 rails s 被执行而不是 RAILS_ENV=production rails s。不知道如何，但它设法从 Dev 获取 PID。

我最终重新启动了服务器，避免运行任何类型的 rails s 命令，然后它就工作了。

对那个耸耸肩。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-06T22:50:30.650

`Options -MultiViews`请尝试在“目录”节点中添加新行。

```
<VirtualHost *:80>
  #...
  <Directory /var/www/app_admin/public>
     AllowOverride all 
     Options -MultiViews  # add this line 
  </Directory>
  #...
</VirtualHost> 
```

# database - 从备注字段的内容中删除特定行

> ID：10049939
> 
> 赞同：2
> 
> 时间：2012-04-06T22:25:56.623
> 
> 标签：database, delphi, paradox

我将如何使用 Delphi 从某个字符串之后的备注字段中删除数据，例如，我正在浏览的数据库中的数据显示如下：

```
<Data I want to keep>

======= Old Data ========
<line 1>
<line 2>
etc. 
```

我怎么能告诉德尔福删除（包括）旧数据线之后的所有数据？但不要触摸我希望保留的数据？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-04-06T22:36:29.097

就像是：

```
var
  I: Integer;
  s: string;
begin
  s := 'your big string with ======= Old Data ======== and more';
  I:=Pos('======= Old Data ========',s);
  if I>0 then
    Delete(s, I, MaxInt);
  ShowMessage(s); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-06T22:44:21.527

试试这个：

```
procedure myForm.ClearFromLine(value: string);
var
  i, index: integer;
begin
  index := memo.lines.IndexOf(value);
  if index = -1 then
    Exit;
  memo.lines.BeginUpdate;
  try
    for i := memo.lines.count - 1 downto index do
      memo.lines.delete(i);
  finally
    memo.lines.EndUpdate;
  end;
end; 
```

# php - 服务定位器、依赖注入（和容器）和控制反转

> ID：10049940
> 
> 赞同：12
> 
> 时间：2012-04-06T22:25:58.103
> 
> 标签：php, design-patterns, dependency-injection, inversion-of-control, service-locator

我已经编程了一段时间，但从未有兴趣从理论上了解每个概念的含义，我可能正在使用各种编程概念，但并不知道。

**Service Locator**：对我来说，是指通过减少代码量来加速开发的快捷方式的记录。一个问题是：Locator 是否可以仅引用命名空间/类，或者我可以拥有一个变量注册表？

以下是我对它的理解：

```
$locator = new ServiceLocator()
$locator->set('app', new System\Application());
$locator->set('db', new System\Pdo());

// Get the objects
$locator->get('db')->connect();
$locator->get('app')->run(); 
```

**依赖注入（和依赖注入容器）**：在对象中注入对象，无论工厂模式如何，都可以更快地访问这些对象。DI 容器呢？

以下是我对它的理解：

```
$app = new System\Application(System\Config::load()); 
```

**控制反转**：不了解这种设计模式（或了解但不知道我所做的是否是 IoC）

那么，理论上（最好有简单的例子），这些概念中的每一个是什么意思？我是正确的，还是有什么问题/可以改进？

谢谢！

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2012-04-07T09:45:59.120

服务定位和依赖注入首先用于解耦类，以便可以轻松地测试和更改它们。

当您将**IoC 容器的****注册**和**解析**部分与**服务定位器**进行比较时，它**似乎**是相同的。

 ******您可以将 IoC 容器用作服务定位器，这被​​认为是一种反模式。当您使用服务定位时，您总是必须在整个架构中主动调用服务定位器。因此，您将类解耦，但另一方面，您将它们全部耦合到服务定位器。此外，使用服务定位器发现依赖关系更加困难，因为您隐藏了依赖关系。而使用依赖注入，您可以使用构造函数注入将依赖项“公开”。

当您使用 IoC 容器时，您会使用依赖注入（构造函数注入或属性注入）。IoC 容器现在能够通过查看构造函数参数来解析依赖关系图并创建整个依赖关系图。这称为**自动接线**。服务定位器无法自动连接依赖项。正如我已经提到的，您不必强制使用自动连接，您可以通过简单地直接在每个类中调用 IoC 容器来轻松使用 IoC 容器，就像服务定位器一样，**但您不应该**！

另请参阅：[https ://stackoverflow.com/a/11319026/175399](https://stackoverflow.com/a/11319026/175399)

![在此处输入图像描述](../Images/a6e48d419592564aa28951c77031ea45.png)

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2012-04-07T07:53:27.253

我认为您正确理解了服务定位器。

关于**依赖注入**，意味着如果一个对象具有构造函数和/或属性依赖项，则这些依赖项是由外部注入到对象中的，而不是对象自己获取依赖项

```
public class MyClass
{
   private $_dep;
   public function __construct($dep=null)
   {
       //$dep has to be injected
       $this->_dep=$dep;                           
   }

   //this is wrong because it couples MyClass to a specific Dependency implementation
   public function __construct()
   {
       $this->_dep=new Dependency();
    }
}
   $dep=new Dependency();
   $obj=new MyClass($dep); 
```

通常构造函数将抽象（接口）作为参数，在类外部实例化一个具体实现，然后在创建 MyClass 的新实例时将其传递给构造函数。

一个 DI 容器，自动处理依赖注入。您只需对其进行配置，以便它知道在询问抽象时要返回哪些具体类。容器处理对象创建，通过构造函数和/或属性注入依赖项。根据容器（我不知道 php 的示例，我只熟悉 .net DI 容器），您可能还必须注册可以由它创建的对象类型。

**控制反转**意味着不是较高级别的类依赖于较低级别的类（依赖性）实现，而是控制被反转，因此较低级别的类实现依赖于较高级别的类所需的抽象。

```
//abstraction defined for the use of higher level class
public interface  IRepository {}

// that's the dependency, the lower level class  
public class XmlRepository implements IRepository {}

//the higher level class
 public class MyClass
 {
     public function __construct(IRepository $repo) {}
  } 
```

IoC 和 DiC 结合在一起，因为 DI 容器提供了 IoC 功能。******

# iphone - 如何根据对象的类别总结提取结果的数字属性？

> ID：10049942
> 
> 赞同：0
> 
> 时间：2012-04-06T22:26:07.100
> 
> 标签：iphone, ios, nsmutablearray, nsfetchedresultscontroller, nsfetchrequest

我有一个`NSFetchRequest`返回我所有保存的对象（称它们为`Item`s）并将它们存储在`NSMutableArray`. 这些`Item`s 中的每一个都有一个类别、一个数量和一些其他属性。我的目标是检查每个类别`Item`并存储同一类别对象的金额总和。所以如果我有这些`Item`：

*   红色的; 10.00
*   蓝色的; 20.00
*   绿; 5.00
*   红色的; 5.00
*   绿; 15.00

那么我会有一个数组或其他类型的容器，而不是：

*   红色的; 15.00
*   蓝色的; 20.00
*   绿; 20.00

**以这种方式组织数据的最佳方式是什么？**我打算创建一个`Totals`只有类别和数量的对象类（称为它）。当我在 for 循环中遍历 fetch 结果时，`Item`在对象中添加具有相同类别的 s`Totals`并将它们存储在 a 中`NSMutableArray`。我遇到的问题是我不确定如何检查数组是否包含`Totals`具有特定属性的对象。具体来说，一个已经存在的类别。因此，如果存在“红色”，则将金额添加到其中，否则创建一个`Totals`具有“红色”类别和第一个`Item`金额的新对象。谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-06T22:43:48.020

要回答您的问题并为您提供可以证明在许多情况下有用的通用方法，您可以使用 [myObject isKindOfClass:aClass] 方法，然后使用 NSObject 的 respondsToSelector: 方法。

如果你知道你会得到什么样的数据。你可以用 Red = 0、Blue = 0、Green = 0 实例化一个对象 Totals，然后相应地添加数量。

作为另一种选择，您可以查看键值编码：[链接在这里](http://theocacao.com/document.page/161/)

您可以使用 NSMutableDictionary 类来实现这一点。如果键存在，您将查看您的总对象（NSMutableDictionary），如果不存在，则创建它，如果存在则添加值。

# javascript - 如何将 json 数据与 javascript 组合在一起

> ID：10049944
> 
> 赞同：0
> 
> 时间：2012-04-06T22:26:10.617
> 
> 标签：javascript, json

我有一些 json，我正在尝试对它进行分组。我正在尝试使用 javascript 来做到这一点。理想情况下，我希望将 JSON 分组在一起，并为每个组分配一个数字，以便循环遍历它。我的最终目标是拥有一个功能，这样我就可以选择按哪个键进行分组。

我试图使用一个函数但没有成功。我不知道从这里去哪里。

```
var groupBy = function(array, predicate) {
    var grouped = {};
    for(var i = 0; i < array.length; i++) {
        var groupKey = predicate(array[i]);
        if (typeof(grouped[groupKey]) === "undefined")
            grouped[groupKey] = [];
        grouped[groupKey].push(array[i]);
    }

    return grouped;
}

var groupData = groupBy(data, function (obj) {
    console.log(obj);
     return obj.category;
 }); 
```

我的json是

```
{
  "merchantcontract":"My Angel Dream Day Care Center 1 10137.01",
  "smi_transactiondate":"\/Date(1332831600000)\/",
  "smi_glamount2":5.8700,
  "smi_transactionclass":180870001,
  "smi_transactionclassname":"Residual Agent Commission",
  "smi_contractprodcutidname":"Traditional",
  "smi_agentid":"1d3f44ee-afc3-e011-addf-a4badb1ddef5",
  "smi_primaryagentid":"1d3f44ee-afc3-e011-addf-a4badb1ddef5"
},

{
  "merchantcontract":"My Angel Dream Day Care Center 1 10137.01",
  "smi_transactiondate":"\/Date(1331622000000)\/",
  "smi_glamount2":4.5792,
  "smi_transactionclass":180870001,
  "smi_transactionclassname":"Residual Agent Commission",
  "smi_contractprodcutidname":"Traditional",
  "smi_agentid":"1d3f44ee-afc3-e011-addf-a4badb1ddef5",
  "smi_primaryagentid":"1d3f44ee-afc3-e011-addf-a4badb1ddef5"
},

{
  "merchantcontract":"Eds Overhead Doors 10150.01",
  "smi_transactiondate":"\/Date(1333695600000)\/",
  "smi_glamount2":11.9300,
  "smi_transactionclass":180870001,
  "smi_transactionclassname":"Residual Agent Commission",
  "smi_contractprodcutidname":"Traditional",
  "smi_agentid":"1d3f44ee-afc3-e011-addf-a4badb1ddef5",
  "smi_primaryagentid":"1d3f44ee-afc3-e011-addf-a4badb1ddef5"
}, 
```

我需要的是对所有相同的商家合同进行分组，并将所有剩余部分分组在其中，这样我就可以加起来 glamount2

```
-My Angel Dream Day Care Center 1 10137.01
--Residual //This could be anything
----total of glamount2 in the residual of my angle
--foo
----total of glamount2 in the foo of my angle 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-06T23:57:52.460

也许我遗漏了一些东西（你的意图让我感到困惑），但如果你只需要遍历这些对象并获得一个特定的属性，你就不需要以任何方式“重新组合”它们。

只需遍历对象并获得所需的任何属性：

```
​for(var i=0; i < myjson.length; i++){
    console.log(myjson[i].smi_glamount2);
}​ 
```

这假设这 3 个（或更多）对象都包含在一个数组中，如下所示：

```
var myjson = [{
    "merchantcontract": "My Angel Dream Day Care Center 1 10137.01",
    "smi_transactiondate": "\/Date(1332831600000)\/",
    "smi_glamount2": 5.8700,
    "smi_transactionclass": 180870001,
    "smi_transactionclassname": "Residual Agent Commission",
    "smi_contractprodcutidname": "Traditional",
    "smi_agentid": "1d3f44ee-afc3-e011-addf-a4badb1ddef5",
    "smi_primaryagentid": "1d3f44ee-afc3-e011-addf-a4badb1ddef5"
},
{
    "merchantcontract": "My Angel Dream Day Care Center 1 10137.01",
    "smi_transactiondate": "\/Date(1331622000000)\/",
    "smi_glamount2": 4.5792,
    "smi_transactionclass": 180870001,
    "smi_transactionclassname": "Residual Agent Commission",
    "smi_contractprodcutidname": "Traditional",
    "smi_agentid": "1d3f44ee-afc3-e011-addf-a4badb1ddef5",
    "smi_primaryagentid": "1d3f44ee-afc3-e011-addf-a4badb1ddef5"
},
{
    "merchantcontract": "Eds Overhead Doors 10150.01",
    "smi_transactiondate": "\/Date(1333695600000)\/",
    "smi_glamount2": 11.9300,
    "smi_transactionclass": 180870001,
    "smi_transactionclassname": "Residual Agent Commission",
    "smi_contractprodcutidname": "Traditional",
    "smi_agentid": "1d3f44ee-afc3-e011-addf-a4badb1ddef5",
    "smi_primaryagentid": "1d3f44ee-afc3-e011-addf-a4badb1ddef5"
}]; 
```

# maven - 什么时候可以安全地删除本地 Maven 存储库？

> ID：10049948
> 
> 赞同：21
> 
> 时间：2012-04-06T22:27:05.740
> 
> 标签：maven

`rm -rf ~/.m2/repository`如果我在网上工作并且我可以通过远程存储库访问所有需要的工件，在哪些情况下是安全的和不安全的。

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2012-04-06T23:08:07.307

当您从远程存储库中检索所有依赖项时，本地存储库只不过是一个缓存。

像所有缓存一样，Maven 本地存储库有时会变得“脏”。在一个公认的偏执和矫枉过正的行为中，我安排了一个定期的 cron 作业来清除我的构建机器上的本地存储库。这会强制与我的 Nexus Maven 存储库重新同步。

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2012-04-06T22:32:07.743

如果您可以通过远程存储库访问所有需要的工件，则删除本地 Maven 存储库始终是安全的。下一次构建所需的所有工件，包括基本的 Maven 插件（如编译器）基本上都将从远程存储库中获取。就是这样。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2019-01-28T18:16:39.550

因此，除了采用“蛮力”方式，还有一个不同的选择：

蛮力：

rm -rf ~/.m2/repository

这是执行此操作的“mvn”方法。

“一切：

```
mvn dependency:purge-local-repository 
```

一些我觉得有帮助的论点

```
mvn dependency:purge-local-repository -DactTransitively=false -DreResolve=false 
```

这是我通常为我的***本地***机器做的事情：（我使用“groupid”的选项参数，它比大锤/蛮力更受控制......

```
mvn dependency:purge-local-repository -DmanualInclude="my.group.id" -DsnapshotsOnly=true  -DactTransitively=false -DreResolve=false 
```

您可以在此处调查命令行选项：

[https://maven.apache.org/plugins/maven-dependency-plugin/purge-local-repository-mojo.html](https://maven.apache.org/plugins/maven-dependency-plugin/purge-local-repository-mojo.html)

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2016-11-09T11:56:30.033

您可以做的是添加一个 cron 条目，以便在给定的时间段内（例如 90 天）定期删除本地存储库中的文件。

```
find ~/.m2/ -type f -atime +90 -delete && \
    find ~/.m2/ -type d -empty -delete 
```

这可以使您的缓存大小减少到仅是您最近使用过的工件。

# java - 是否有一个 Java 库可以实现样本分布的正态性测试之一？

> ID：10049953
> 
> 赞同：5
> 
> 时间：2012-04-06T22:27:32.823
> 
> 标签：java, statistics

我有一个数据集，我想测试它与正态分布或高斯分布的接近程度。我知道有多种算法可以做到这一点，例如。Jarque-Bera 测试、Anderson-Darling 测试和许多其他测试。

我希望找到这些测试之一的开源 Java 实现，这样我就不需要从头开始实现它。任何人都可以提供任何指示吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-06T23:23:01.370

统计库[SSJ](http://www.iro.umontreal.ca/~simardr/ssj/indexe.html)：

1.  已获得 GNU GPL 许可
2.  是纯 Java（没有 JNI）
3.  有[安德森-亲爱的](http://www.iro.umontreal.ca/~simardr/ssj/doc/html/umontreal/iro/lecuyer/probdist/AndersonDarlingDist.html)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-03-29T23:26:57.833

[http://jdistlib.sourceforge.net/](http://jdistlib.sourceforge.net/)

这有许多其他的正态性测试方法。

# grails - 确保没有请求通过应用程序中的 GET 方法

> ID：10049957
> 
> 赞同：1
> 
> 时间：2012-04-06T22:28:04.750
> 
> 标签：grails, block, http-get

为了确保所有表单提交和所有提交到服务器的数据都不是通过`GET`我找到这段代码

```
if(request.method == 'GET') {
      response.sendError(405)
    } else {
      // the rest of the delete action goes here
    } 
```

我们可以将它应用到由所有控制器扩展的基本控制器中，因此代码不会在任何地方重复。以上方法检查现有方法我想知道有没有办法在`POST`整个应用程序中设置方法，就像所有表单和提交的所有数据都应该是`POST`. 我用来设置的任何配置/变量？
提前
致谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-06T23:08:46.033

一般来说，这就是`allowedMethods`地图的用途；当您使用`generate-controller`or`generate-all`脚本时，您的控制器将具有以下内容：

```
static allowedMethods = [save: "POST", update: "POST", delete: "POST"] 
```

并且您可以根据哪些操作需要 POST 以及哪些操作允许 GET 从地图中添加或删除操作名称。您可以将其放在基类中，并允许子类重用基类定义并使用以下方法添加到它：

```
static allowedMethods = BaseController.allowedMethods + [createUser: "POST"] 
```

这要求您扩展该基类，因此很容易忘记。所以更好的方法可能是使用过滤器；您可以使用`create-filters`命令创建一个。

因此，例如，您可以使用这样的过滤器，其中包含要禁止的明确操作列表：

```
def filters = {
   postOnly(controller:'*', action: 'save|update|delete') {
      before = {
         if (!request.post) {
            response.sendError(405)
            return false
         }
         true
      }
   }
} 
```

除了管道分隔的动作名称（您可以对控制器名称执行相同操作）之外，您还可以使用通配符，因此您可以添加以“create”开头的任何动作：

```
 postOnly(controller:'*', action: 'save|update|delete|create*') { 
```

# android - 我的 andengine 项目中的致命异常：无法实例化活动 ComponentInfo

> ID：10049963
> 
> 赞同：0
> 
> 时间：2012-04-06T22:28:25.870
> 
> 标签：android, eclipse, andengine

由于此错误，我无法运行 andengine 项目：

[![](../Images/a0993855c097b7c3cc7bbafac7dbe692.png)](https://i.stack.imgur.com/5FqN5.png)

这是我的代码：

```
package a.a.a;

import org.anddev.andengine.engine.Engine;
import org.anddev.andengine.entity.scene.Scene;
import org.anddev.andengine.ui.activity.BaseGameActivity;

public class AActivity extends BaseGameActivity
{
    Engine engine;
    public Engine onLoadEngine() 
    {
        return engine;
    }

    public void onLoadResources() 
    {
    }

    Scene scene;
    public Scene onLoadScene() 
    {
        return this.scene;
    }

    public void onLoadComplete()
    {
    }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-23T19:51:10.173

您正在返回空对象

你应该在返回之前初始化你的引擎和场景

参考基本示例代码

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-06T22:30:05.227

确保您的活动已在清单中声明。

# c# - 在 onmessage 之前 WebSocket 连接断开

> ID：10049964
> 
> 赞同：0
> 
> 时间：2012-04-06T22:28:28.500
> 
> 标签：c#, sockets, websocket, streamwriter, tcplistener

我用 Javascript 编写了一个 WebSocket 客户端，它与我的服务器的 C# 连接并握手。目前，在“刷新”我的输出流时（仅在我将标头 BACK 发送给客户端并确认我的连接之后），客户端崩溃并在我下次尝试写入时生成服务器端异常。后一种行为是预期的，但是我无法弄清楚为什么刷新会断开连接。我在服务器端使用 TcpListener 和带有 StreamWriter 的 Socket，在客户端使用普通 WebSocket。

这种情况真正令人困惑的是，在“握手”的传输过程中，文本可以双向传输，并且在每行发送后执行 Flush，但是一旦握手完成，flush 就会终止连接。

请告诉我此修订中是否有足够的信息；因为它现在已经修改了几次。

提前致谢。

客户端Javascript：

```
<!DOCTYPE html>  
<meta charset="utf-8" />
<html>
<head>
<script language="javascript" type="text/javascript">
    var wsUri = "ws://127.0.0.1:9002/cc";
    var output;
    var websocket = null;

    function init()
    {
        StartWebSocket();
    }

    function StartWebSocket()
    {
        output = document.getElementById("output");
        writeToScreen("#WebSocket Starting");
        websocket = new WebSocket(wsUri,"lorem.ipsum.com");
        writeToScreen("#WebSocket Instantiated");
        websocket.removeEventListener("open",onOpen,false);
        websocket.addEventListener("open",onOpen,false);

        websocket.removeEventListener("close",onClose,false);
        websocket.addEventListener("close",onClose,false);

        websocket.removeEventListener("message",onMessage,false);
        websocket.addEventListener("message",onMessage,false);

        websocket.removeEventListener("error",onError,false);
        websocket.addEventListener("error",onError,false);

        writeToScreen("#WebSocket Events Attached");
    }

    function onOpen(evt)
    {
        try
        {
            writeToScreen("#WebSocket Connection Established");
            writeToScreen("#WebSocket BinaryType: " + websocket.binaryType);
            writeToScreen("#WebSocket Protocol: " + websocket.protocol);
            writeToScreen("#WebSocket Extensions: " + websocket.extensions);
            doSend("TestOutput\r\n\r");
        }
        catch( e )
        {
            writeToScreen(e);   
        }
    }

    function onClose(evt)
    {
        writeToScreen("#WebSocket Connection Aborted:");
        writeToScreen("&nbsp;&nbsp;&nbsp;&nbsp;Reason: " + evt.code );
        writeToScreen("&nbsp;&nbsp;&nbsp;&nbsp;Reason: " + evt.reason );
        writeToScreen("&nbsp;&nbsp;&nbsp;&nbsp;Clean: " + evt.wasClean);
    }

    function onMessage(evt)
    {
        writeToScreen("#WebSocket Message Event");
        try
        {
            writeToScreen("<span style=\"color: blue;\">#WebSocket Server Message: " + evt.data+"</span>");
        }
        catch( e )
        {
            writeToScreen(e);
        }
    }

    function onError(evt)
    {
        writeToScreen("<span style=\"color: red;\">#WebSocket Error:</span> " + evt.data);
    }

    function doSend(message)
    {
        try
        {
            websocket.send(message);
            writeToScreen("#WebSocket Output Written to Server: " + message);
        }
        catch( e ) 
        {
            writeToScreen(e);
        }
    }

    function writeToScreen(message)
    {
        try
        {
            var pre = document.createElement("a");
            pre.style.wordWrap = "break-word";
            pre.innerHTML = message + "<br>";
            output.appendChild(pre);
        }
        catch( e )
        {
            writeToScreen(e);
        }
    }

    window.addEventListener("load", init, false);

</script>
</head>
<body>
<div id="output"></div>
</body>
</html> 
```

我从客户那里收到的握手报价如下：

```
GET /cc HTTP/1.1
Upgrade: websocket
Connection: Upgrade
Host: 127.0.0.1:9002
Origin: http://localhost
Sec-WebSocket-Key: icajBpkAfgA+YbVheBpDsQ==
Sec-WebSocket-Version: 13 
```

我这样解释握手：

```
public override void Interpret(string Argument)
{
    if (String.IsNullOrEmpty(Argument))
    {
        return;
    }
    else
    {
        if( !HeaderFinished )
        {
            if (!HeaderStarted)
            {
                if (Argument.StartsWith("GET /"))
                {
                    this.Role = "client";
                    HeaderStarted = true;
                    this.Server.Print("Connection at " + this.Address + " set to client.");
                }
                else
                {
                    return;
                }
            }
            else
            {
                if (Argument.StartsWith("Sec-WebSocket-Key:"))
                {
                    this.Key = Argument.Split(' ')[1].TrimEnd().TrimStart();
                    return;
                }
                else if (Argument.StartsWith("Sec-WebSocket-Version:"))
                {
                    this.HeaderFinished = true;
                    this.WriteHeaderResponse();
                    HeaderSent = true;
                    return;
                }
            }
        }
        else
        {
            this.InterpretMessage(DecodeMessage(Argument));
            return;
        }
    }
} 
```

发送我的标题响应：

```
public void WriteHeaderResponse()
{
    this.WriteLine("HTTP/1.1 101 Switching Protocols");
    this.WriteLine("Upgrade: websocket");
    this.WriteLine("Connection: Upgrade");
    String NewKey = ComputeResponseKey(this.Key);
    this.WriteLine("Sec-WebSocket-Accept: " + NewKey);
    this.WriteLine("Sec-WebSocket-Protocol: lorem.ipsum.com");
    this.WriteLine("\r\n");
} 
```

并从客户端获取以下输出（此时）：

```
#WebSocket Starting
#WebSocket Instantiated
#WebSocket Events Attached
#WebSocket Connection Established
#WebSocket BinaryType: blob
#WebSocket Protocol: lorem.ipsum.com
#WebSocket Extensions: 
#WebSocket Output Written to Server: TestOutput 
```

此时，如果我尝试执行以下服务器端方法，客户端会像这样断开连接：

```
#WebSocket Connection Aborted:
    Reason: 1006
    Reason: 
    Clean: false 
```

消息代码：-取自我在网上找到的东西，稍作修改......

```
public void WriteMessage(byte[] Payload)
{
    byte[] Message;
    int Length = Payload.Length;
    int MaskLength = 4;

    if (Length < 126)
    {
        Message = new byte[2 + MaskLength + Length];
        Message[1] = (byte)Length;
    }
    else if (Length < 65536)
    {
        Message = new byte[4 + MaskLength + Length];
        Message[1] = (byte)126;
        Message[2] = (byte)(Length / 256);
        Message[3] = (byte)(Length % 256);
    }
    else
    {
        Message = new byte[10 + MaskLength + Length];
        Message[1] = (byte)127;

        int left = Length;
        int unit = 256;

        for (int i = 9; i > 1; i--)
        {
            Message[i] = (byte)(left % unit);
            left = left / unit;

            if (left == 0)
                break;
        }
    }

    //Set FIN
    Message[0] = (byte)129;// (0 | 0x80);

    //Set mask bit
    //Message[1] = (byte)(Message[1] | 0x80);

    //GenerateMask(Message, Message.Length - MaskLength - Length);

    //if (Length > 0)
        //MaskData(Payload, 0, Length, Message, Message.Length - Length, Message, Message.Length - MaskLength - Length);

    char[] output = new char[Message.Length-4];

    for( int i = 0, y = 0, z = 0; i < Message.Length; i++ )
    {
        if (Message[z] == '\0')
        {
            if (Payload.Length > i-z)
                output[i] = (char)Payload[y++];
        }
        else
        {
            output[i] = (char)Message[z++];
        }
    }

    this.OutputWriter.Write(output, 0, output.Length);
    this.OutputWriter.Flush();
} 
```

更新：我刚刚用我最新的替换了本文档中的所有代码。

总结一下：

```
- The client-server handshake has been matched on both sides.
- A path has been defined in the URI for the WebSocket.
- Data packets are now being 'properly' framed. 
```

我在编辑时才注意到的一点是我的 WriteMessage 方法的最后几行。完成所有框架后，我将字节数组转换为字符数组并使用 StreamReader.Write 发送它。我不确定这是否是一个可行的解决方案，所以如果不是，请让我检查一下。

否则我很困惑。这似乎符合我读过的所有标准，但仍然让我失望。如果我能让它发挥作用，这就是交易的制定者，所以我真的很感谢任何人的帮助。

谢谢你。-DigitalJedi*掌心*

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-17T08:48:25.723

该问题是由于在握手响应中使用了 Sec-WebSocket-Protocol 引起的。客户端没有请求子协议，因此来自服务器的唯一有效响应是在不指定子协议的情况下完成握手。如果服务器以意外的子协议响应，则要求客户端关闭连接。[有关详细信息，请参阅RFC 6455](https://www.rfc-editor.org/rfc/rfc6455#section-4.2.2)的第 4.2.2 节中的 /subprotocol/ 部分。

最简单的解决方法是从您的响应中删除 Sec-WebSocket-Protocol 标头。如果要保留它，则需要将子协议名称作为第二个参数传递给客户端的 WebSocket 构造函数，并在服务器的响应中使用此子协议。有关详细信息，请参阅[客户端 API](http://dev.w3.org/html5/websockets/#the-websocket-interface)文档。

编辑：
完成握手后，服务器很可能无法尝试从客户端的 onOpen 读取“TestOutput”消息。WebSocket 消息不是纯文本并且不使用 HTTP，因此该行`this.ReadLine()`极不可能找到一个 \r\n 来终止。有关详细信息，请参阅规范的[数据框架](https://www.rfc-editor.org/rfc/rfc6455#section-5.2)部分。这篇[wiki 帖子](https://stackoverflow.com/questions/8125507/how-can-i-send-and-receive-websocket-messages-on-the-server-side)有一些用于 websocket 读/写的有用伪代码。或者，您可以试试我的[C++ 服务器](https://github.com/openhome/ohNet/blob/master/OpenHome/Net/Device/Upnp/DviServerWebSocket.cpp)。请参阅`WsProtocol80::Read()`如何阅读消息。或者查看其中一种开源 C# 服务器，例如[Fleck](https://github.com/statianzo/Fleck/blob/master/src/Fleck/Handlers/Hybi13Handler.cs)（读取/写入消息的代码已链接）。

您可以考虑其他一些小的更改，这些更改将使您的代码更加健壮，但不会影响立即通过和失败：

*   理想情况下，您指定的任何子协议都应包含您的域名，以最大程度地减少意外匹配任何不兼容协议请求的机会。RFC 6455的[早期部分](https://www.rfc-editor.org/rfc/rfc6455#section-1.9)解释了原因。
*   在使用支持的子协议进行响应之前，值得考虑检查请求中是否存在 Sec-WebSocket-Protocol 标头及其值。
*   无法保证客户端请求中标头的顺序，因此您可能会延迟响应，直到您读取空行。

# java - Android：在按键点击时启用触觉反馈和声音

> ID：10049968
> 
> 赞同：3
> 
> 时间：2012-04-06T22:29:32.427
> 
> 标签：java, android, dalvik

我在处理 Android 中的系统设置时遇到问题。长话短说，我们正在开发一个应用程序，该应用程序使用不同的输入设置进行一些用户实验。我们需要通过不同的实验以编程方式启用和禁用按键声音和按键振动。

我已经探索了一些选项，但如果可能的话，我想避免实际设置监听器并手动振动。

我已授予自己修改系统设置的权限：

```
<uses-permission android:name="android.permission.WRITE_SETTINGS" /> 
```

以下是我用来修改系统设置的代码：

```
 android.provider.Settings.System.putInt(getContentResolver(),
             android.provider.Settings.System.HAPTIC_FEEDBACK_ENABLED,
             1); 
```

但是，这些更改不会反映在系统设置中。

以下代码正在运行，验证了模拟器上的系统设置窗口中的设置实际上发生了变化。

```
 android.provider.Settings.System.putInt(getContentResolver(),
             android.provider.Settings.System.TEXT_AUTO_PUNCTUATE,
             0);

   android.provider.Settings.System.putInt(getContentResolver(),
             android.provider.Settings.System.TEXT_AUTO_REPLACE,
             0); 
```

我还尝试在视图上设置特定设置，例如：

```
 EditText inputArea = (EditText) findViewById(R.id.editText1);
    inputArea.setHapticFeedbackEnabled(true);
    inputArea.performHapticFeedback(HapticFeedbackConstants.KEYBOARD_TAP, HapticFeedbackConstants.FLAG_IGNORE_GLOBAL_SETTING | HapticFeedbackConstants.FLAG_IGNORE_VIEW_SETTING);
    inputArea.performHapticFeedback(HapticFeedbackConstants.VIRTUAL_KEY, HapticFeedbackConstants.FLAG_IGNORE_GLOBAL_SETTING | HapticFeedbackConstants.FLAG_IGNORE_VIEW_SETTING); 
```

我已经把它推到手机上，它也没有任何影响。

我需要的是一种在实验过程中以编程方式启用/禁用按键点击时的触觉反馈和声音的方法。我搜索了堆栈溢出，但找不到任何有用的东西。

任何人都知道任何技巧，或者我是否必须让自己使用按键处理程序并手动振动手机？

谢谢！

# iphone - WebView 中的 Rss - iOS

> ID：10049969
> 
> 赞同：0
> 
> 时间：2012-04-06T22:29:47.553
> 
> 标签：iphone, ios, xcode, rss, webview

所以我在 Xcode 上为 iOS 做一个 WebView，一切都很好，但是当我尝试用下面的代码打开一个 RSS url 时它不起作用

```
NSString *urlAddress = @"feed://stackoverflow.com/feeds/question/9602059"; 
```

但是当我尝试打开一个普通的网页时，它运行完美。有什么建议么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-06T22:33:39.037

尝试改用 http。我不确定 UIWebView 是否理解/处理“提要”

```
NSString *urlAddress = @"http://stackoverflow.com/feeds/question/9602059"; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-06T22:34:53.363

如果您订阅了 iOS 开发人员计划，请查看此 URL 以获取更多信息。

如果没有，这里有一个报价：

> 上面发布的“hungrysoft.com”链接对我也不起作用。具体来说，我取回了一个 XML 文件，当 UIWebView 尝试呈现该文件时，它没有任何格式显示，即使 XML 文件包含对样式表的引用。我的猜测是，Safari 不知何故知道如何通过引用样式表来呈现 XML 文件，但 UIWebView 不知道。

此外，我不相信 UIWebViews 支持 feed:// 协议。尝试使用 NSXMLParser 来解析信息。

# c++ - C++：坐标数组？

> ID：10049972
> 
> 赞同：0
> 
> 时间：2012-04-06T22:30:02.800
> 
> 标签：c++, arrays, refactoring, code-cleanup

我的代码有问题。实际上它有效，但我想清洁它以使其更合适。

所以我有一个包含浮点 x 和浮点 y 的类 Coord。

构造函数是：

```
void Coord::Coord (float x,float y)
{
this->x = x;
this->y = y;
} 
```

我以这种方式创建了我需要的所有点：

```
Coord pt1(0,1);
Coord pt2(20,0);
...
Coord pt61(12,14); .... ` 
```

在我必须制作一些点的数组之后，例如第五个五个点将被分配到一个数组中，另外 4 个点在另一个数组中，另外 2 个点在另一个数组中......

```
Coord pts_weakhealth[3] = {pt1,pt2,pt3}; 
```

这个数组，我必须作为类的构造函数的参数，例如：

```
Sef health(pts_weakhealth,3);
Sef strength(pts_weak,4);` 
```

我将以同样的方式创建一些 Sef，然后将它们组成一个数组

```
Sef spec[2] = {health,strength}; 
```

一个类 Universe 将包含一些 sef ：

```
Universe hlth(spec); 
```

你可以想象当我有很多点，很多sef，很多脏代码的时候......

我该如何改进呢？让我的代码更好......

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-07T00:35:04.840

很难说出这里要问什么......但这里有一些建议可以让你朝着正确的方向前进：

1.  不要对点初始化进行硬编码。编写一个例程从配置或初始化文件中读取点。

2.  不要将它们存储在数组中。根据配置文件中的信息构建向量或点的列表或双端队列。

3.  使用配置文件从先前定义的点构建您`Sef`的 s 和 s。`Universe`

# map - tr1 使用成员函数绑定在地图容器上（哎呀！）

> ID：10049974
> 
> 赞同：0
> 
> 时间：2012-04-06T22:30:04.920
> 
> 标签：map, bind, smart-pointers, placeholder, tr1

我在使用以下功能时遇到问题：

```
typedef std::tr1::shared_ptr<Island> Island_sp_t;
typedef map<string, Island_sp_t>::value_type island_map_pair;

std::map<std::string, Island_sp_t> Island_ptr_map;

void Model::save_all(ostream& out)
{
    for_each(Island_ptr_map.begin(), Island_ptr_map.end(), bind(&Island::save,
             bind<Island_sp_t>(&island_map_pair::second, _1), ref(out)));
} 
```

我的`Island::save`功能看起来像这样

```
virtual void save(std::ostream& out) const; 
```

到目前为止，这种将绑定与地图结合使用的格式对我来说一直有效，但仅在这种特殊情况下，我在 g++ 4.1.2 上收到以下错误，并带有以下标志：

```
g++ -c Pedantic -ansi -Wall

/usr/lib/gcc/x86_64-redhat-linux/4.1.2/../../../../include/c++/4.1.2/tr1/bind_iterate.h: In member function ‘typename std::tr1::result_of<_Functor ()(typename std::tr1::result_of<std::tr1::_Mu<_T1, std::tr1::is_bind_expression<_T1>::value, (std::tr1::is_placeholder<_T1>::value > 0)> ()(_T1, std::tr1::tuple<_U1, std::tr1::_NullClass, std::tr1::_NullClass, std::tr1::_NullClass, std::tr1::_NullClass, std::tr1::_NullClass, std::tr1::_NullClass, std::tr1::_NullClass, std::tr1::_NullClass, std::tr1::_NullClass>)>::type, typename std::tr1::result_of<std::tr1::_Mu<_T1, std::tr1::is_bind_expression<_T1>::value, (std::tr1::is_placeholder<_T1>::value > 0)> ()(_T2, std::tr1::tuple<_U1, std::tr1::_NullClass, std::tr1::_NullClass, std::tr1::_NullClass, std::tr1::_NullClass, std::tr1::_NullClass, std::tr1::_NullClass, std::tr1::_NullClass, std::tr1::_NullClass, std::tr1::_NullClass>)>::type)>::type std::tr1::_Bind<_Functor ()(_T1,
_T2)>::operator()(_U1&) [with _U1 = std::pair<const std::basic_string<char, std::char_traits<char>, std::allocator<char>
>, std::tr1::shared_ptr<Island> >, _Functor = std::tr1::_Mem_fn<void (Island::*)(std::ostream&)const>, _T1 = std::tr1::_Bind_result<std::tr1::shared_ptr<Island>, std::tr1::_Mem_fn<std::tr1::shared_ptr<Island> std::pair<const std::basic_string<char, std::char_traits<char>, std::allocator<char>
>, std::tr1::shared_ptr<Island> >::*> ()(std::tr1::_Placeholder<1>)>, _T2 = std::tr1::reference_wrapper<std::basic_ostream<char, std::char_traits<char> > >]’: /usr/lib/gcc/x86_64-redhat-linux/4.1.2/../../../../include/c++/4.1.2/bits/stl_algo.h:159:   instantiated from ‘_Function std::for_each(_InputIterator,
_InputIterator, _Function) [with _InputIterator = std::_Rb_tree_iterator<std::pair<const std::basic_string<char, std::char_traits<char>, std::allocator<char> >, std::tr1::shared_ptr<Island> > >, _Function = std::tr1::_Bind<std::tr1::_Mem_fn<void (Island::*)(std::ostream&)const> ()(std::tr1::_Bind_result<std::tr1::shared_ptr<Island>, std::tr1::_Mem_fn<std::tr1::shared_ptr<Island> std::pair<const std::basic_string<char, std::char_traits<char>, std::allocator<char>
>, std::tr1::shared_ptr<Island> >::*> ()(std::tr1::_Placeholder<1>)>, std::tr1::reference_wrapper<std::basic_ostream<char, std::char_traits<char> > >)>]’ Model.cpp:179:   instantiated from here /usr/lib/gcc/x86_64-redhat-linux/4.1.2/../../../../include/c++/4.1.2/tr1/bind_iterate.h:45: error: no match for call to ‘(std::tr1::_Mem_fn<void (Island::*)(std::ostream&)const>) (std::tr1::shared_ptr<Island>, std::basic_ostream<char, std::char_traits<char> >&)’ /usr/lib/gcc/x86_64-redhat-linux/4.1.2/../../../../include/c++/4.1.2/tr1/functional_iterate.h:261: note: candidates are: _Res std::tr1::_Mem_fn<_Res (_Class::*)(_T1)const>::operator()(const _Class&, _T1) const [with
_Res = void, _Class = Island, _T1 = std::ostream&] /usr/lib/gcc/x86_64-redhat-linux/4.1.2/../../../../include/c++/4.1.2/tr1/functional_iterate.h:267: note:                 _Res std::tr1::_Mem_fn<_Res (_Class::*)(_T1)const>::operator()(const _Class*, _T1) const [with
_Res = void, _Class = Island, _T1 = std::ostream&] /usr/lib/gcc/x86_64-redhat-linux/4.1.2/../../../../include/c++/4.1.2/tr1/functional_iterate.h:274: note:                 _Res std::tr1::_Mem_fn<_Res (_Class::*)(_T1)const>::operator()(_Tp&, _T1) const [with _Tp = std::tr1::shared_ptr<Island>, _Res = void, _Class = Island, _T1 = std::ostream&] /usr/lib/gcc/x86_64-redhat-linux/4.1.2/../../../../include/c++/4.1.2/tr1/bind_iterate.h:45: error: return-statement with a value, in function returning 'void' make: *** [Model.o] Error 1 
```

我对这个错误感到非常困惑，因为似乎所有类型都与`functional_iterate.h:274`候选人匹配得很好。关于我缺少什么的任何想法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-07T18:23:59.513

对于任何想知道的人，我需要在我的第二个绑定参数中添加一个“const”，以便算法如下所示：

```
for_each(Island_ptr_map.begin(), Island_ptr_map.end(), bind(&Island::save,
             bind<const Island_sp_t>(&island_map_pair::second, _1), ref(out))); 
```

# c - 为什么 GCC 保留空函数？

> ID：10049981
> 
> 赞同：14
> 
> 时间：2012-04-06T22:30:43.380
> 
> 标签：c, function, optimization, gcc, macros

在大多数情况下，如果我想在 C 中创建一个可选功能，我只需创建两个这样的函数：

```
#ifdef OPTIONAL_SOMETHING
void do_something(int n, const char *s)
{
    while (n--) {
        printf("%s", s);
    }

    /* ...You might get the point, really do something... */
}
#else
void do_something(int n, const char *s)
{
    /* Empty body */
}
#endif 
```

因此，如果符号未定义（禁用该功能时），则会将一个空函数编译到可执行文件中。

深入研究程序集列表，似乎 GCC在**优化被禁用时***编译并调用*空函数。如果**启用了优化**，也使用and ，它只*编译必要的堆栈处理代码，但它优化了调用指令。**总而言之，它保留了功能。*****`-O2``-O3`****

 *****大约同样适用于非空但未使用的方法。

它应该简单地扔掉整个东西，但事实并非如此。为什么这是默认行为？只是为了好奇：我怎样才能消除这个？

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2012-04-06T22:32:58.243

由于该函数具有外部链接（不是`static`），因此编译器无法消除它，因为另一个目标文件可能会引用它。如果函数是`static`，它将被完全消除。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-07T03:46:11.883

如果您希望编译器最终内联您必须告诉他的函数。声明你的函数`inline`，这允许编译器在它认为合适的时候*不*发出函数。

现在，当您使用 -O0 左右编译时，这可能会导致“未定义符号”错误。放一个“实例化”，如

```
void do_something(int n, const char *s); 
```

仅在一个编译单元（.c 文件）中。*****

# ruby-on-rails - 无法将父模型属性复制到子模型？

> ID：10049983
> 
> 赞同：0
> 
> 时间：2012-04-06T22:30:46.860
> 
> 标签：ruby-on-rails, ruby, ruby-on-rails-3

我有一个多态关联：

```
class User
  has_many :products
  has_many :subscriptions, :foreign_key => :subscriber_id
end

class Product
  belongs_to :store
  has_many :subscriptions, :as => :subscribable
end

class Subscription
  belongs_to :subscriber, :class_name => "User"
  belongs_to :subscribable, :polymorphic => true
end 
```

该`Subscription`模型包含`Product`列，因为我想复制它们：

```
create_table :products do |t|
  t.string  :name
  t.decimal :price
  t.integer :user_id
  t.integer :store_id
end

create_table :subscriptions do |t|
  t.string  :name
  t.decimal :price
  t.integer :store_id
  t.integer :subscriber_id # user_id
  t.integer :subscribable_id
  t.string  :subscribable_type
end 
```

当我尝试通过我的链接订阅产品时：

```
<td><%= link_to "Subscribe", { :controller => "products", :action => "subscribe_product", :id => product.id }, :method => :post %></td> 
```

我得到错误：

```
NameError in ProductsController#subscribe_product

undefined local variable or method `store_id' for #<ProductsController:0x705bad8> 
```

因为我的控制器现在试图复制我的产品字段：

```
def subscribe_product
    @product = Product.find(params[:id])
    subscription = Subscription.new(@product.attributes.merge({
      :store_id => store_id,
      :price => price,
      :name => name
    }))
    subscription.subscriber_id = current_user.id
    @product.subscriptions << subscription
    if @product.save
      redirect_to :back, :notice => "Successfully subscribed to #{@product.name}"
    else
      render :back, :notice => "Could Not Subscribe to Product correctly."
    end
  end 
```

有谁知道如何解决这一问题？我不明白为什么`store_id`以及要复制的其余字段给出`NameError`?

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-07T04:29:01.853

使用实例变量@product 获取 store_id、价格和名称的值，如下所示：

```
def subscribe_product
  @product = Product.find(params[:id])

  subscription = Subscription.new(
     :store_id => @product.store_id,
     :price => @product.price,
     :name => @product.name
     )

  subscription.subscriber = current_user
  @product.subscriptions << subscription
  if @product.save
    redirect_to :back, :notice => "Successfully subscribed to #{@product.name}"
  else
     render :back, :notice => "Could Not Subscribe to Product correctly."
   end
end 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-07T04:02:35.480

你得到的错误是因为你的控制器中的这一行：

```
subscription = Subscription.new(@product.attributes.merge({
  :store_id => store_id,
  :price => price,
  :name => name
})) 
```

`store_id`, `price`, 并且`name`不是控制器方法中的局部变量，并且不在任何其他方式的范围内，因此计算机不知道它们应该是什么。（我也不确定它们应该是什么；这些值应该来自哪里？）

我也不明白你为什么要复制 和 之间的`Product`列`Subscription`。这似乎是不必要的数据重复。你想通过这样做来达到什么目的？

# magento - Magento 创建“最新产品”系列

> ID：10049984
> 
> 赞同：0
> 
> 时间：2012-04-06T22:30:55.363
> 
> 标签：magento

我正在尝试在主页上创建一个包含最新产品的集合。到目前为止，这是我的代码：

```
$_productCollection = clone $this->getLoadedProductCollection();

$_productCollection->clear()
 ->setPageSize(40)
 ->setOrder('created_at', 'desc')
 ->load(); 
```

这是退回 40 件产品，但顺序不正确。

我尝试了很多东西......有人可以帮助我吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-07T09:12:32.383

我不确定你的确切问题是什么，但这里有一个方便的调试方法可以帮助你。

您始终可以使用`Zend_Db_Select`对象中可用的方法检查您的集合查询。例如，在您的情况下，我们可以运行：

```
echo (string) $_productCollection->getSelect()->assemble(); 
```

您还可以将`true`作为参数添加到您的`->load()`方法调用中，`->load(true)`以在浏览器中打印查询。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-18T17:05:33.573

在您的收藏中使用以下内容：

```
 $collection->addAttributeToSort('news_from_date', 'desc');
    $collection->addAttributeToSort('created_at', 'desc'); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-07T22:51:02.383

或者，您可以作弊并通过在 php 文件中直接查询来获取 ID 列表：

`SELECT entity_id, sku FROM catalog_product_entity ORDER BY created_at DESC LIMIT 0,40;`

正如人们所希望的那样，结果与您按 entity_id 订购一样。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-01-13T02:07:35.227

您需要先清洁物体。为此：

```
$_productCollection = $this->getLoadedProductCollection()
   ->clear()
   ->addAttributeToSort('created_at', 'DESC'); 
```

除了 created_at 之外，您还可以使用 name、updated_at、sku 等。

希望能帮助到你。

# python - Suds 数组数组不嵌套

> ID：10049989
> 
> 赞同：1
> 
> 时间：2012-04-06T22:31:35.947
> 
> 标签：python, soap, suds

让我先说我对 SOAP 以及事情应该如何工作仍然很陌生。我正在使用垂直响应 API。

我在获取 suds 以正确构造请求的 xml 时遇到问题。这是一些代码：

```
from suds.client import Client

url = 'https://api.verticalresponse.com/wsdl/1.0/VRAPI.wsdl'
client = Client(url)
vr = client.service
...
test_list = (
    (
        {
            'name' : 'email_address',
            'value' : login['username'],
        },
        {
            'name' : 'First_Name',
            'value' : 'VR_User',
        }
    ),
    (
        {
            'name' : 'email_address',
            'value' : 'api-support@verticalresponse.com',
        },
        {
            'name' : 'First_Name',
            'value' : login['username'],
        },
    ),
)

# sid and cid are correctly retrieved prior to this point
print "Sending test message..."
vr.sendEmailCampaignTest({
    'session_id' : sid,
    'campaign_id' : cid,
    'recipients' : test_list,
}) 
```

在这种情况下 login['username'] 只是一个电子邮件地址。

该代码引发此错误：

```
suds.WebFault: Server raised fault: 'Application failed during request deserialization: Too many elements in array. 4 instead of claimed 2 (2) 
```

这里是 sendEmailCampaignTest 的定义：http: [//developers.verticalresponse.com/api/soap/methods/campaigns/sendemailcampaigntest/](http://developers.verticalresponse.com/api/soap/methods/campaigns/sendemailcampaigntest/)

这是记录输出的 xml。 **此 XML 不正确且不起作用**（我删除了 session_id 和 list_id 以便在此处显示）：

```
<?xml version="1.0" encoding="utf-8" ?>
DEBUG:suds.client:headers = {'SOAPAction': u'"VR/API/1_0#sendEmailCampaignTest"', 'Content-Type': 'text/xml; charset=utf-8'}
ERROR:suds.client:<?xml version="1.0" encoding="UTF-8"?>
<SOAP-ENV:Envelope xmlns:ns3="http://api.verticalresponse.com/1.0/VRAPI.xsd" xmlns:SOAP-ENC="http://schemas.xmlsoap.org/soap/encoding/" xmlns:ns0="http://schemas.xmlsoap.org/soap/envelope/" xmlns:ns1="http://www.w3.org/2001/XMLSchema" xmlns:ns2="http://schemas.xmlsoap.org/soap/encoding/" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:ns4="VR/API/1_0" xmlns:SOAP-ENV="http://schemas.xmlsoap.org/soap/envelope/" SOAP-ENV:encodingStyle="http://schemas.xmlsoap.org/soap/encoding/">
   <SOAP-ENV:Header/>
   <ns0:Body>
      <ns4:sendEmailCampaignTest>
         <args xsi:type="ns3:sendEmailCampaignTestArgs">
            <session_id xsi:type="ns1:string">redacted</session_id>
            <campaign_id xsi:type="ns1:int">redacted</campaign_id>
            <recipients xsi:type="ns3:ArrayOfNVDictionary" ns2:arrayType="ns3:NVDictionary[2]">
               <item>
                  <name xsi:type="ns1:string">email_address</name>
                  <value xsi:type="ns1:string">email@example.com</value>
               </item>
               <item>
                  <name xsi:type="ns1:string">First_Name</name>
                  <value xsi:type="ns1:string">VR_User</value>
               </item>
               <item>
                  <name xsi:type="ns1:string">email_address</name>
                  <value xsi:type="ns1:string">api-support@verticalresponse.com</value>
               </item>
               <item>
                  <name xsi:type="ns1:string">First_Name</name>
                  <value xsi:type="ns1:string">email@example.com</value>
               </item>
            </recipients>
         </args>
      </ns4:sendEmailCampaignTest>
   </ns0:Body>
</SOAP-ENV:Envelope>
DEBUG:suds.client:http failed:
<?xml version="1.0" encoding="UTF-8"?><SOAP-ENV:Envelope xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:SOAP-ENC="http://schemas.xmlsoap.org/soap/encoding/" xmlns:SOAP-ENV="http://schemas.xmlsoap.org/soap/envelope/" xmlns:xsd="http://www.w3.org/2001/XMLSchema" SOAP-ENV:encodingStyle="http://schemas.xmlsoap.org/soap/encoding/"><SOAP-ENV:Body><SOAP-ENV:Fault><faultcode>SOAP-ENV:Client</faultcode><faultstring>Application failed during request deserialization: Too many elements in array. 4 instead of claimed 2 (2)
</faultstring></SOAP-ENV:Fault></SOAP-ENV:Body></SOAP-ENV:Envelope> 
```

我正在基于以下 ruby​​ 脚本（由 Vertical Response 提供）移植我的脚本：

```
test_list = [
           [{
              'name' => 'email_address',
              'value' => $username
            },
            {
              'name' => 'First_Name',
              'value' => 'VR_User'
            }
           ],
           [{
              'name' => 'email_address',
              'value' => 'api-support@verticalresponse.com'
            },
            {
              'name' => 'First_Name',
              'value' => $username
            }
           ]
          ]
print "Sending test message...\n"
temp0 = vr.sendEmailCampaignTest({
                                 'session_id' => sid,
                                 'campaign_id' => cid,
                                 'recipients' => test_list,
                               }) 
```

它输出以下 xml。 **这个 XML 是正确的并且可以工作**（我删除了 session_id 和 list_id）：

```
<?xml version="1.0" encoding="utf-8" ?>
<env:Envelope xmlns:xsd="http://www.w3.org/2001/XMLSchema"
    xmlns:env="http://schemas.xmlsoap.org/soap/envelope/"
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
  <env:Body>
    <n1:sendEmailCampaignTest xmlns:n1="VR/API/1_0"
        env:encodingStyle="http://schemas.xmlsoap.org/soap/encoding/">
      <args xmlns:n2="http://api.verticalresponse.com/1.0/VRAPI.xsd"
          xsi:type="n2:sendEmailCampaignTestArgs">
        <session_id xsi:type="xsd:string">redacted</session_id>
        <campaign_id xsi:type="xsd:int">redacted</campaign_id>
        <recipients xmlns:n3="http://schemas.xmlsoap.org/soap/encoding/"
            xsi:type="n3:Array"
            n3:arrayType="n2:NVDictionary[2]">
          <item xsi:type="n3:Array"
              n3:arrayType="n2:NVPair[2]">
            <item>
              <name xsi:type="xsd:string">email_address</name>
              <value href="#id9496430"></value>
            </item>
            <item>
              <name xsi:type="xsd:string">First_Name</name>
              <value xsi:type="xsd:string">VR_User</value>
            </item>
          </item>
          <item xsi:type="n3:Array"
              n3:arrayType="n2:NVPair[2]">
            <item>
              <name xsi:type="xsd:string">email_address</name>
              <value xsi:type="xsd:string">api-support@verticalresponse.com</value>
            </item>
            <item>
              <name xsi:type="xsd:string">First_Name</name>
              <value href="#id9496430"></value>
            </item>
          </item>
        </recipients>
      </args>
    </n1:sendEmailCampaignTest>
    <value id="id9496430"
        xsi:type="xsd:string"
        env:encodingStyle="http://schemas.xmlsoap.org/soap/encoding/">address@example.com</value>
  </env:Body>
</env:Envelope> 
```

我了解错误在于收件人的构造。它应该包含两个项目，每个项目包含两个项目，但我使用 suds 的 python 脚本将其设置为包含四个未嵌套的项目。所以我的问题是我怎样才能得到正确构造 xml 的泡沫？

编辑：我尝试过的：

```
>>> url = 'https://api.verticalresponse.com/wsdl/1.0/VRAPI.wsdl'
>>> client = Client(url)
>>> args = client.factory.create('ns0:sendEmailCampaignTestArgs')  
>>> args
(sendEmailCampaignTestArgs){
   session_id = None
   campaign_id = None
   recipients = 
      (ArrayOfNVDictionary){
         _arrayType = ""
         _offset = ""
         _id = ""
         _href = ""
         _arrayType = ""
      }
 } 
```

在我看来，suds 没有正确构造 ArrayOfNVDictionary（它没有可以保存 NVDictionary 的实际数组元素），任何有助于确定你会很棒。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-06T23:03:02.407

SOAP 的全部意义在于远程方法调用和参数应该看起来像您选择的语言的本机方法和对象。

为了避免错误，请始终使用特定的 SOAP 类型，如此（未经测试）代码段中所示：

```
>>> recipient_list = [ 
...     ('root@eruditorum.org', 'Enoch'), 
...     ('billg@microsoft.com', 'Bill'), 
... ]
>>> client = suds.client.Client('https://api.verticalresponse.com/wsdl/1.0/VRAPI.wsdl')
>>> args = client.factory.create('ns0:sendEmailCampaignTestArgs')
>>> for email, first_name in recipient_list:
...     recipient = client.factory.create('ns0:NVDictionary')
...     recipient['email_address'] = email
...     recipient['First_Name'] = first_name
...     args.recipients.append(nvdict)
>>> args.session_id = sid
>>> args.campaign_id = cid
>>> client.service.sendEmailCampaignTest(args) 
```

恕我直言，像上面这样的显式代码更干净，更易于维护。

当然你可以忽略我的建议，在这种情况下我猜`test_list`应该是这样的：

```
test_list = [ 
    { 
        'email_address': 'josh@cartme.com', 
        'First_Name': 'Josh' },
    },
    { 
        'email_address': 'josh.cartme@gmail.com', 
        'First_Name': 'Josh' },
    },
] 
```

# php - 如何在两个不同的服务器上验证登录？

> ID：10049991
> 
> 赞同：0
> 
> 时间：2012-04-06T22:31:52.513
> 
> 标签：php, security, encryption, xss

我开发了一个 CMS 应用程序，它将所有客户的文件存储在他们的服务器上，但在我的服务器上进行处理（即保留我开发的有价值的代码，同时不允许用户提交的代码使我的网站易受攻击）。现在的问题是用户有一个控制面板来编辑他们的网站，这是托管在他们的网站上的，这是一个 1 页的东西，但登录详细信息/会话总是在我的网站上。

我正在考虑有一种方法使该站点上的编辑页面只有在传递的令牌有效时才可访问，两个站点可以采用相同的方式来开发和检查相同的令牌。这是可接受的安全性吗，我的意思是我能想到的唯一漏洞是，如果 URL 以某种方式被嗅探并在令牌仍然有效的同一时间范围内独立使用。检查标头是一项可选的额外安全措施，但这些可能是伪造的，因此它不是一个绝对的解决方案。我不知道嗅探用户的网络流量有多容易，这种方法可以使用吗？

提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-06T22:48:20.217

好吧，只要您还验证证书（以击败中间人攻击），只需加密您的传输（即使用 SSL）就可以轻松击败嗅探攻击。

我不确定我是否完全理解您的设置，但您似乎应该将编辑页面调出到您的后端服务器，并将令牌传递给它以进行身份​​验证。这是你想要的，还是……？

# cakephp - cakephp 复选框多选仅发送最后选择的复选框的值

> ID：10049995
> 
> 赞同：4
> 
> 时间：2012-04-06T22:32:11.830
> 
> 标签：cakephp, cakephp-1.3, cakephp-2.0

我没有得到所有选中复选框的值。它只是给了我最后选择的复选框的值

这是代码

```
foreach($apps as $app){

        echo $this->Form->input('Application.id', array('type'=>'checkbox','multiple' => 'checkbox' , 'id'=>$app['Application']['description'], 'div'=>false,'type'=>'checkbox','value' => $app['Application']['description'],'label'=>$app['Application']['description']));

    } 
```

并在提交时得到最后一个复选框，即 LASTCHECKBOX

```
object(CakeRequest) {
    params => array(
        'plugin' => null,
        'controller' => 'groups',
        'action' => 'add',
        'named' => array(),
        'pass' => array()
    )
    data => array(

        'Application' => array(
            'id' => 'LASTCHECKBOX'
        )

    )
    query => array()
    url => 'groups/add'
    base => ''
    webroot => '/'
    here => '/groups/add'
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-06T22:37:14.307

我认为这是因为“价值”。

在你的情况下使用`"options" => array(1, 2, 3)`

你最好不要在视图中设置值、默认值或类似的东西。使用控制器操作设置默认值。比它应该工作正常。

```
if ($this->request->isPost()) {

} else {
    $this->request->data['Model']['fieldname'] = 'defaultvalue';
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-06-12T11:40:17.077

对于多个复选框，您需要将其`[]`作为名称 HMTL 属性的最后一部分（有关更多说明，请参见此[答案](https://stackoverflow.com/a/7880656/327074)）。

这是在 CakePHP 中使用“选择”类型的输入完成的。如果您查看 2.0 的[Form Helper 选择文档](http://book.cakephp.org/2.0/en/core-libraries/helpers/form.html#FormHelper::select)（但也适用于 v1.2+），则不需要循环，您只需要使用复选框创建多选：

```
<?php
$options = array(
    'Value 1' => 'Label 1',
    'Value 2' => 'Label 2'
);
echo $this->Form->select('Model.field', $options, array(
    'multiple' => 'checkbox'
));
?> 
```

因此，我认为对您而言，`foreach($apps`您不需要将 $apps 修改为与`$options`.

```
<?php
$apps = array(
    'App Id 1' => 'Description 1',
    'App Id 2' => 'Description 2'
);
echo $this->Form->select('Application.id', $apps, array(
    'multiple' => 'checkbox'
));
?> 
```

应该输出：

```
<div class="input select">
   <label for="ApplicationId">Id</label>
   <input name="data[Application][id]" value="" id="ApplicationId" type="hidden">
   <div class="checkbox">
      <input name="data[Application][id][]" value="App Id 1" id="ApplicationId1" type="checkbox">
      <label for="ApplicationId1">Description 1</label>
   </div>
   <div class="checkbox">
      <input name="data[Application][id][]" value="App Id 2" id="ApplicationId2" type="checkbox">
      <label for="ApplicationId2">Description 2</label>
   </div>
</div> 
```