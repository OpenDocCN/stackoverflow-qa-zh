# StackOverflow 问答 12379000-12379999

# c++ - 如何在 C++ Metro 应用程序中制作 HTTP POST/GET？

> ID：12379004
> 
> 赞同：0
> 
> 时间：2012-09-11T22:51:03.730
> 
> 标签：c++, xaml, windows-8, microsoft-metro

我有一些 Web 服务，我的应用程序需要通过 HTTP POST/GET 发送带有 REST 的 json 来与之通信。我能看到的唯一方法是使用 iXMLHTTPRequest2 框架，但是天哪，天哪，它比我想要处理的更丑陋。

这是我必须用 c++ 看的唯一选择吗？

使用 c# 会更容易吗？我知道所有语言的大部分内容都是相同的，但如果 c# 有更好的方法来做到这一点，我愿意跳槽。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-25T21:12:08.120

您还应该查看[Project Casablanca](http://msdn.microsoft.com/en-us/devlabs/casablanca.aspx) - 它是一个完全原生的 C++ 库，也适用于 Metro 应用程序（我相信它包含 IXHR2）。我一直在使用它来执行 http REST 调用并非常成功地解析 JSON。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-11T23:04:03.853

这就是您必须在 C++ 中使用的接口。这比 C# 更难。鉴于此，有一个[很好的示例](http://code.msdn.microsoft.com/windowsapps/HttpClient-sample-55700664)可以让使用该界面更容易接受。

# jsf - primefaces/jsf 中 id 和 widgetvar 的命名约定

> ID：12379011
> 
> 赞同：3
> 
> 时间：2012-09-11T22:51:23.547
> 
> 标签：jsf, primefaces, naming-conventions

我遇到了一个问题，即 id 属性和 widgetvar 的 id 相同，显然不建议这两个属性具有相同的值。所以我试图找到最好的惯例。是否有特殊（保留）字符不能像句号等使用。谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-12T11:08:59.857

只需始终使用特定前缀即可。没有真正的“最佳”前缀，也没有官方推荐的约定。“最好的”只是在整个 Web 应用程序中保持一致。

例如

```
<p:tabView id="tabs" widgetVar="$tabs">
<p:dataTable id="table" widgetVar="$table">
<p:calendar id="calendar" widgetVar="$calendar"> 
```

或者

```
<p:tabView id="tabs" widgetVar="_tabs">
<p:dataTable id="table" widgetVar="_table">
<p:calendar id="calendar" widgetVar="_calendar"> 
```

或者

```
<p:tabView id="tabs" widgetVar="p_tabs">
<p:dataTable id="table" widgetVar="p_table">
<p:calendar id="calendar" widgetVar="p_calendar"> 
```

请注意，这`$`在 JSF 客户端 ID 中是不允许的。

# android - Android GridLayout 中的水平居中视图

> ID：12379012
> 
> 赞同：7
> 
> 时间：2012-09-11T22:51:26.433
> 
> 标签：android, alignment, android-4.0-ice-cream-sandwich, grid-layout, xml-layout

我们正在编写一个针对 ICS+ 的应用程序，并相信 GridLayout 是最好的布局范例，但似乎很少有人写过它，而且我们遇到了一些对齐问题。

```
<GridLayout
    xmlns:android="http://schemas.android.com/apk/res/android"
    android:id="@+id/row_background"
    android:rowCount="1"
    android:columnCount="3"
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    android:useDefaultMargins="true"
    android:background="@drawable/list_item_bg">

    <ImageView
        android:id="@+id/visibilityIcon"
        android:layout_row="0"
        android:layout_column="0"
        android:src="@drawable/visibility_icon" 
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_gravity="center_horizontal"/>

    <ImageView
        android:id="@+id/windIcon"
        android:layout_row="0"
        android:layout_column="1"
        android:src="@drawable/wind_icon"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_gravity="center_horizontal"/>

    <ImageView
        android:id="@+id/crosswindIcon"
        android:layout_row="0"
        android:layout_column="2"
        android:src="@drawable/cloud_icon"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_gravity="center_horizontal"/>

</GridLayout> 
```

但是，左边的 2 个图标保持左对齐，最右边的图标以剩余空间居中。

本质上，我们需要做的是将每列的大小指定为总屏幕大小的 1/3（因为 3 列）。我认为这是 GridLayout 所做的，但似乎 'wrap_content' 会导致这种行为（有道理），但 'match_parent' 会导致第一列填满整个屏幕，而不是填充其单元格，这是我所期望的行为。

我们似乎已经尝试了重力、layout_gravity 等的所有组合，但要么我们根本上做错了，要么发现了 GridLayout 的限制。

谢谢你的帮助！

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-09-11T22:58:40.967

GridLayout 中只允许增长一行一列，即沿该轴具有重力的那一列。如果不止一行或一列指定重力，只有一个会得到它（如果我记得它是“最后一个”）。选择其他布局或编写自己的布局。如果您只想要一行具有等分图标的行，您可以使用 LinearLayout ，其中组件的宽度为 0px 且权重都相同，例如 1。

# javascript - 使用 JavaScript 解析 HTML

> ID：12379014
> 
> 赞同：1
> 
> 时间：2012-09-11T22:51:40.683
> 
> 标签：javascript, jquery, xpath, xml-parsing, html-parsing

我正在处理一个页面，该页面需要从其他页面获取信息，然后在当前页面上显示部分信息/数据。

我有需要在字符串中解析的 HTML 源代码。我正在寻找一个可以帮助我轻松做到这一点的库。（我只需要提取特定的标签和它们包含的文本） HTML 格式正确（所有结束/结束标签都存在）。

我已经查看了一些选项，但由于各种原因，它们都非常难以使用。

我尝试了以下解决方案：

1.  jkl-parsexml 库（库 js 文件本身抛出 HTTPError 101）
2.  jQuery.parseXML 实用程序（没有找到太多文档/许多示例来弄清楚该怎么做）
3.  XPATH（执行语句不起作用，但 JS 错误控制台未显示错误）

所以我正在寻找一个对用户更友好的图书馆或任何可以让我更好、更轻松、更有效地使用上述工具的东西（教程/书籍/参考资料/文档）。

理想的解决方案是 Python 中可用的 BeautifulSoup。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-11T22:56:08.380

使用 jQuery，它就像使用其中的字符串中的 HTML 数据创建一个 jQuery 对象一样简单`$(HTMLstring);`（此 DOM 将与您的文档断开连接）。从那里可以很容易地用它做任何你想做的事情——当然，遍历加载的数据对于 jQuery 来说是小菜一碟。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-11T22:56:52.087

你可以这样做：

```
$("string with html here").find("jquery selector") 
```

`$("string with html here")`这将创建一个文档片段并将一个 html 放入其中（基本上，它将解析您的 HTML）。并将`find`搜索该文档片段中的元素（并且仅在其中）。同时不会放到页面DOM中

# c# - MVC C# Entity Framework 错误：数据读取器与指定的不兼容

> ID：12379015
> 
> 赞同：0
> 
> 时间：2012-09-11T22:51:58.813
> 
> 标签：c#, asp.net-mvc-3, entity-framework, stored-procedures

调用以下存储过程后出现错误：

```
var result = db.APP_Client_Update(clientID,[and other parameters here]).ToList(); 
```

和错误：

```
The data reader is incompatible with the specified 
'ClientModel.APP_Client_Update_Result'. 
A member of the type, 'retcode', does not have a corresponding 
column in the data reader with the same name. 
```

存储过程返回以下内容：如果我找不到记录，那么...

```
If @WorkflowID is null or not exists 
(Select 1 from Clients_Changes where ClientID = @ClientID)
BEGIN
    Select '-999' as retcode, 
'Unable to update client record, something is wrong' as retmessage
    Return 0
END 
```

如果成功...

```
IF @@TRANCOUNT > 0 
BEGIN
COMMIT TRANSACTION
Select '1' as retcode, 'Client Updated Successfully' as retmessage 
END 
```

我到处寻找解决方案，但似乎找不到，我确保我的 mvc 解决方案中的所有返回类型都与 retcode 和 retmessage 完全匹配。任何帮助，将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-12T18:00:13.863

看起来问题出在运行 SQL Profiler 后的存储过程中，我能够缩小错误范围。

# c# - GData 版本 2.1.0.0 中的哪个示例显示了如何使用 3.0 API 检索帐户？

> ID：12379019
> 
> 赞同：0
> 
> 时间：2012-09-11T22:52:27.750
> 
> 标签：c#, profile, gdata-api, google-analytics-api, account

简单的问题：

我在 .NET 下使用 Google Analytics v2.3——直到 2012 年 8 月 23 日。

我已经下载了 Google Data API msi 2.1.0.0 版。

我已经从 Subversion 获得了源代码。

哪个示例（如果有）展示了如何实现新版本 3.0 帐户检索和 API 方法调用？

这是我的旧代码。

```
 public Dictionary<string, string> GetAccounts_old(string username, string password, string myservice)
    {

        AccountQuery feedQuery = new AccountQuery();
        AnalyticsService service = new AnalyticsService(myservice);
        Dictionary<string, string> accounts = new Dictionary<string, string>();

        try
        {
            if (!string.IsNullOrEmpty(username))
            {
                service.setUserCredentials(username, password);
            }
            foreach (AccountEntry entry in service.Query(feedQuery).Entries)
            {
                accounts.Add(entry.ProfileId.Value, entry.Title.Text);
            }
        }
        catch (Exception ex)
        {
            throw new Exception("There was a problem: " + ex.Message);
        }
        return accounts;
    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-12T08:10:29.500

Google Analytics API v3 不是基于 GData，而是由不同的库支持：[http ://code.google.com/p/google-api-dotnet-client/](http://code.google.com/p/google-api-dotnet-client/)

示例将添加到[http://code.google.com/p/google-api-dotnet-client/wiki/APIs#Google_Analytics_API](http://code.google.com/p/google-api-dotnet-client/wiki/APIs#Google_Analytics_API)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-27T22:46:45.330

这是我的 c# api v3 代码的链接，它是答案部分 [Automated use of google-api-dotnet-client with OAuth 2.0][1] [1]: [Automated use of google-api-dotnet-client with OAuth 2.0](https://stackoverflow.com/questions/12429392/automated-use-of-google-api-dotnet-client-with-oauth-2-0/12603329#12603329)我没有尝试提取帐户信息，请发布您所做的任何代码更改。

# objective-c - 注销流程 facebook sdk IOS [self authorizeWithFBAppAuth:NO safariAuth: NO];

> ID：12379025
> 
> 赞同：4
> 
> 时间：2012-09-11T22:52:52.073
> 
> 标签：objective-c, ios, facebook, login, logout

facebook ios sdk 上用于登录和注销以及 Safari 的所有问题都已解决，无需添加文件 facebook.m 代码行`[self authorizeWithFBAppAuth:NO safariAuth:NO]`，但在新的 facebook SDK 中，此文件已过时，因此未在框架库中使用我的问题是这个问题的当前解决方案是什么非常感谢

# ruby - 如何多次执行带参数的 Rake 任务？

> ID：12379026
> 
> 赞同：15
> 
> 时间：2012-09-11T22:52:59.707
> 
> 标签：ruby, rake

`invoke`在一个循环中[多次](https://stackoverflow.com/questions/4822020/rake-task-in-loop-executes-only-first-task)执行相同的 rake 任务是不可能的。但是，我希望能够调用`rake first`和遍历一个数组，并`second`在每次迭代时使用不同的参数调用。由于`invoke`只在第一次执行，我尝试使用`execute`，但[Rake::Task#execute](http://rake.rubyforge.org/classes/Rake/Task.html#M000120)不使用 splat (*) 运算符，只接受一个参数。

```
desc "first task"
task :first do 
  other_arg = "bar"
  [1,2,3,4].each_with_index do |n,i|
    if i == 0 
      Rake::Task["foo:second"].invoke(n,other_arg)
    else
      # this doesn't work
      Rake::Task["foo:second"].execute(n,other_arg)
    end
  end
end

task :second, [:first_arg, :second_arg] => :prerequisite_task do |t,args|
  puts args[:first_arg]
  puts args[:second_arg]
  # ...
end 
```

围绕它的一个技巧是将参数`execute`放入一个数组并`second`检查 args 的结构，但这看起来，嗯，hackish。还有另一种（更好的？）方法来完成我想做的事情吗？

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2012-10-18T06:33:12.910

您可以使用 Rake::Task#reenable 允许再次调用它。

```
desc "first task"
task :first do 
  other_arg = "bar"
  [1,2,3,4].each_with_index do |n,i|
    if i == 0 
      Rake::Task["second"].invoke(n,other_arg)
    else
      # this does work
      Rake::Task["second"].reenable
      Rake::Task["second"].invoke(n,other_arg)
    end
  end
end

task :second, [:first_arg, :second_arg]  do |t,args|
  puts args[:first_arg]
  puts args[:second_arg]
  # ...
end 
```

$先抽成

```
1
bar
2
bar
3
bar
4
bar 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-10-31T13:55:00.110

该`execute`函数要求[Rake::TaskArguments](http://rake.rubyforge.org/Rake/TaskArguments.html)作为参数，这就是它只接受一个参数的原因。

[你可以使用](https://stackoverflow.com/a/19690760/2298505)

```
stuff_args = {:match => "HELLO", :freq => '100' }
Rake::Task["stuff:sample"].execute(Rake::TaskArguments.new(stuff_args.keys, stuff_args.values)) 
```

但是，invoke 和 execute 之间还有另一个区别，execute 不会在 invoke 首先执行此操作时运行 :prerequisite_task，因此 invoke 和 reenable 或 execute 的含义并不完全相同。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2020-06-16T17:12:47.727

FWIW这可能会帮助某人，所以我会发布它。

我希望能够从 CLI 运行一个命令来多次运行一个 Rake 任务（每次都使用新参数，但这并不重要）。

例子：

```
rake my_task[x] my_task[y] my_task[z] 
```

然而，由于 Rake 将所有`my_task`的 args 都视为同一个任务，因此它只会在第一次调用而`my_task[x]`不会调用`my_task[y]`and `my_task[z]`。

使用`Rake::Task#reenable`其他答案中提到的方法，我编写了一个`reenable`Rake 任务，您可以将其定位在任务之后运行以允许它再次运行。

结果：

```
rake my_task[x] reenable[my_task] my_task[y] reenable[my_task] my_task[z] 
```

我不会说这是理想的，但它适用于我的情况。

### `reenable`耙任务来源：

```
task :reenable, [:taskname] do |_task, args|
  Rake::Task[args[:taskname]].reenable
  Rake::Task[:reenable].reenable
end 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2018-09-03T10:08:44.317

这对我有用，很容易理解你只需要循环你的 bash 命令。

```
task :taskname, [:loop] do |t, args|
        $i = 0
        $num = args.loop.to_i
        while $i < $num  do
        sh 'your bash command''
        $i +=1
        end
    end 
```

# delphi - 使用带有泛型的枚举

> ID：12379032
> 
> 赞同：5
> 
> 时间：2012-09-11T22:53:44.990
> 
> 标签：delphi, generics, enums

我正在尝试创建一个通用类，我可以使用一组枚举来启动其中的值。例如：

```
constructor TManager<TEnum>.Create;
var
  enum: TEnum;
  enumObj: TMyObject;
begin
  fMyObjectList:=  TObjectDictionary<TEnum,TMyObject>.Create([doOwnsValues],10);
  for enum:= Low(TEnum) to High(TEnum) do
  begin
    enumObj:= TMyObject.Create();
    fMyObjectList.Add(enum, enumObj);
  end;
end; 
```

此外，后面的方法将通过枚举值获取对象，例如：

```
function TManager<TEnum>.Fetch(enum: TEnum): TMyObject;
begin
  fMyObjectList.TryGetValue(enum, Result);
end; 
```

但是，作为通用参数传递，delphi 并不知道 TEnum 将是一个枚举。我可以以某种方式强制执行吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-09-12T07:09:52.437

正如大卫所说，你能做的最好的事情就是在运行时使用 RTTI。

```
 type  
      TRttiHelp = record
        class procedure EnumIter<TEnum {:enum}>; static;
      end;

    class procedure TRttiHelp.EnumIter<TEnum {:enum}>;
    var
      typeInf: PTypeInfo;
      typeData: PTypeData;
      iterValue: Integer;
    begin
      typeInf := PTypeInfo(TypeInfo(TEnum));
      if typeInf^.Kind <> tkEnumeration then
        raise EInvalidCast.CreateRes(@SInvalidCast);

      typeData := GetTypeData(typeInf);
      for iterValue := typeData.MinValue to typeData.MaxValue do
        WhateverYouWish;
    end; 
```

虽然我不知道当您的枚举定义了值时代码的行为，例如

```
 (a=9, b=19, c=25) 
```

* * *

编辑：

如果您想返回`iterValue`枚举，可以使用以下函数，该函数取自[Jim Ferguson 的枚举助手类](http://cc.embarcadero.com/item/27397)

```
class function TRttiHelp.EnumValue<TEnum {:enum}>(const aValue: Integer): TEnum;
var
  typeInf: PTypeInfo;
begin
  typeInf := PTypeInfo(TypeInfo(TEnum));
  if typeInf^.Kind <> tkEnumeration then
    raise EInvalidCast.CreateRes(@SInvalidCast);

  case GetTypeData(typeInf)^.OrdType of
    otUByte, otSByte:
      PByte(@Result)^ := aValue;
    otUWord, otSWord:
      PWord(@Result)^ := aValue;
    otULong, otSLong:
      PInteger(@Result)^ := aValue;
  else
    raise EInvalidCast.CreateRes(@SInvalidCast);
  end;
end; 
```

然后，您可以使用一般提供的作为构造函数中字典的索引。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-12T06:20:50.257

您不能约束一个泛型参数，这样`low()`并且`high()`可以在泛型类中使用。唯一可用的约束是类或接口约束。

据我所知，该语言没有提供通用方法来枚举通用枚举类型。可能你能做的最好的事情就是使用 RTTI，牺牲编译时类型的安全性（如 Tobias 所示）。

* * *

阅读了对 Tobias 答案的评论后，您似乎真正想要的是 `TObjectDictionary<TEnum,TMyObject>`. 那是因为您希望能够找到`TMyObject`给定`TEnum`密钥的实例。你想要`TObjectDictionary`而不是`TDictionary`因为前者接管了`TMyObject`实例的所有权。完成后，您需要有人将它们全部释放，您不妨让`TObjectDictionary`它们为您完成。

有关所有权方面的示例，请参阅@RRUZ 在此处的答案：[使用 Generics.Collections.TObjectDictionary 的示例](https://stackoverflow.com/questions/8463968/example-for-using-generics-collections-tobjectdictionary/8466317#8466317)

# iphone - 目标c应用程序崩溃中的插入排序算法

> ID：12379033
> 
> 赞同：0
> 
> 时间：2012-09-11T22:53:48.033
> 
> 标签：iphone, objective-c, xcode, nsmutablearray

我正在尝试使用 Obj-c 实现插入排序算法 我将下面的注释行从 C 转换为 Obj C ，（如果有人可以查看和帮助，希望它们是正确的）但是应用程序崩溃并出现以下错误 Terminating app due未捕获的异常 'NSRangeException'，原因：' *** -[NSMutableArray objectAtIndex:]: index 4294967295 beyond bounds [0 .. 9]'

```
-(IBAction)clicked_insertsort:(id)sender{

    NSMutableArray  *iarray = [[NSMutableArray alloc]initWithArray:garr];
    int n = [iarray count]  ;
    NSLog(@"%@",iarray);

    int i,j,x,k;

     for(i=1;i<=n-1;i++)  

     {  
     j=i;  

     //x=a[i]; 
    x=[[iarray objectAtIndex:(NSUInteger)i]intValue];    

     //while(a[j-1]>x && j>0)  
     while ([[iarray objectAtIndex:(NSUInteger)j-1]intValue] >x && j>0)

     {  

     //a[j]=a[j-1];
    [iarray replaceObjectAtIndex: (j) withObject: [iarray objectAtIndex: (j-1)]];
     j=j-1;  
     }  

    // a[j]=x;  
    [[iarray objectAtIndex:(NSUInteger)j]intValue] == x; 

     }
    NSLog(@"%@",iarray);
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-11T22:57:45.800

您应该避免将索引转换为无符号整数。一次尝试一个，哪一个将错误更改为 -1 而不是 4294967295 是您遇到问题的索引

当 j 设置为 0 时，您现在将在索引 -1 处对 iarray 进行索引，当转换为 unsigned int 时，它等于 4294967295

# parsing - 解析多种格式的平面文件

> ID：12379035
> 
> 赞同：0
> 
> 时间：2012-09-11T22:54:07.067
> 
> 标签：parsing, flat-file, edi, filehelpers

自从我不得不编写相当于自定义格式的 edi 处理器以来已经有一段时间了。上次我写一个时，我是一个 AS/400 程序员（不是 iSeries 给你一个时间表）。很简单，我构建了一个结构，检查了记录类型列，然后根据数据和记录类型的固定位置开始处理。

快进到 2012 年，我的要求几乎完全相同，只是我不再有一个 AS/400 来简化它。

为简洁起见，前 2 列包含一个记录类型，结构基于该类型。关于如何在 web 服务器上的 c# 中最好地处理这个问题有什么建议吗？

我考虑过的一些选项是文件助手和 SSIS。我可以完全控制环境，所以我几乎可以做任何有意义的事情。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-12T03:03:09.940

您可以尝试使用 FileHelpers 的 Multi Record 引擎选项

[http://www.filehelpers.com/example_multirecords.html](http://www.filehelpers.com/example_multirecords.html)

您必须定义与您拥有的不同类型的行一样多的记录类，然后提供一个委托，让 FileHelpers 选择正确的。

还有一个 Master Detail 引擎：

[http://www.filehelpers.com/example_masterdetail.html](http://www.filehelpers.com/example_masterdetail.html)

该库的最新版本：[http ://teamcity.codebetter.com/viewLog.html?buildId=51642&tab=artifacts&buildTypeId=bt66](http://teamcity.codebetter.com/viewLog.html?buildId=51642&tab=artifacts&buildTypeId=bt66)

# mysql - MySQL 函数条件总是评估为真

> ID：12379036
> 
> 赞同：1
> 
> 时间：2012-09-11T22:54:08.007
> 
> 标签：mysql, function, conditional, evaluate

我有一个 SQL 函数，它应该根据用户激活是否成功返回 0 或 1。我有以下两个需要与之交互的表：

```
users {user_id, unique email, ...}
user_activation {activation_hash, unique email, ...} 
```

该函数应该评估：

1.  传入的哈希是否与 user_activation 中的一行匹配？
2.  用户表中是否不存在相应的电子邮件？
3.  然后在 users 中插入一个新用户并删除激活行并返回 1，否则返回 0

这是我的功能：

```
delimiter #
create function activate_user
(
    p_activation_hash char(32)
)
returns int
deterministic
begin

    if not exists (
        select 1 from users u
        inner join (
            select email from user_activation where activation_hash = p_activation_hash
        ) ua
        on u.email = ua.email
    )
  then

    -- hash exists but email doesnt so add
    insert into users (email, password_hash, first_name, last_name, company_name)
      select email, password_hash, first_name, last_name, company_name
      from user_activation
      where activation_hash = p_activation_hash
      and expiry_date > now();

    -- delete the activation row(s)
    delete low_priority from user_activation where activation_hash = p_activation_hash;

    return 1;

  end if;

  return 0;

end #
delimiter ; 
```

我的问题是条件总是评估为真（尽管即使没有唯一关键字，也只有 1 行被插入到用户表中）。

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-11T23:05:28.443

尝试将定义从更改`DETERMINISTIC`为`NOT DETERMINISTIC`（或删除它，因为它`NOT`是默认值），因为对于给定的输入，该函数的结果每次*都不相同。*

一旦一个（有效的）散列被使用一次，该函数就会为该散列返回一个不同的值。您可能一遍又一遍地看到相同的结果，因为第一次调用该函数时它返回`1`，而现在每次调用它时它都返回相同的值，即使激活记录不再存在。散列的输入可能在某一时刻无效，然后在下一时刻有效（但不太可能）。

有关详细信息，请参阅[CREATE PROCEDURE 语法。](http://dev.mysql.com/doc/refman/5.5/en/create-procedure.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-21T22:30:48.620

我今天重新审视了这个问题，发现了一个非常方便的 NOT IN 查询，它可以解决问题：

```
delimiter #
create procedure activate_user
(
    in p_activation_hash char(32),
    inout status int
)
proc_main:begin

    set status = 0;

    if exists (
        select 1 from user_activation
            where activation_hash = p_activation_hash
            and email not in (select email from users)
    )
    then

    -- hash exists but email doesnt so add
    insert into users (email, password_hash, first_name, last_name, company_name)
      select email, password_hash, first_name, last_name, company_name
      from user_activation
      where activation_hash = p_activation_hash
      and expiry_date > now();

    -- delete the activation row(s)
    delete low_priority from user_activation where activation_hash = p_activation_hash;

    set status = 1;

  end if;

end proc_main #
delimiter ; 
```

# javascript - 骨干模型更改事件仅触发一次

> ID：12379038
> 
> 赞同：1
> 
> 时间：2012-09-11T22:54:34.450
> 
> 标签：javascript, model-view-controller, events, backbone.js, coffeescript

我有一个 Backbone 模型，它在更改时触发一个函数。我想将该函数链接到一个视图。

模型：

```
class App.Models.Tracker extends Backbone.Model
  urlRoot : '/api/trackers'

  initialize: ->
    @on('change', @update, this)

  update: ->
    console.log('changed in model')
    @trigger('update', this); 
```

看法：

```
class App.Views.Tracker extends Backbone.View
  template: JST['trackers/tracker']

  initialize: () ->
    @model.on("update", @animate, this);

  render: ->
    $(@el).html(@template(tracker: @model))
    this

  animate: ->
    console.log('changed in view')
    progress = @model.get('progress')
    console.log(progress) 
```

发生的事情是每次模型更改时都会调用模型中的“更新”方法。但是视图中的“动画”方法仅在创建模型时调用一次。

我怎么了？

***编辑***

也许我只是测试错了？

```
 trackers = new App.Collections.Trackers
 trackers.fetch()
 tracker = trackers.get(333)
 tracker.set({progress : 70}) 
```

333 是创建的跟踪器的 id ......但上述不起作用.. JSFiddle 确实工作正常，这令人困惑

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-12T08:51:07.623

尝试等到`Collection.fetch()`完成后开始使用集合中的模型：

```
trackers = new App.Collections.Trackers
trackers.fetch({
  success: function(){
    tracker = trackers.get(333);
    tracker.set({progress : 70});  
  }
}); 
```

# r - 如何创建一个包含R中另一列最大值的列？

> ID：12379043
> 
> 赞同：0
> 
> 时间：2012-09-11T22:55:01.337
> 
> 标签：r, data.table, plyr

使用 R，我想创建一个新列 (MaxAct)，显示不同列 (ActNo) 的最大数量，同时按两个因素 (HHID 和 PERID) 分组

例如，我有这个数据集：

```
UID HHID PERID ActNo
1   1000 1     1
2   1000 1     2
3   1000 1     3
4   1000 2     1
5   1000 2     2
6   2000 1     1
7   2000 1     2
8   2000 1     3
9   2000 1     4
10  2000 2     1
11  2000 2     2 
```

然后我想添加新列（MaxAct），如下所示：

```
UID HHID PERID ActNo MaxAct
1   1000 1     1     3
2   1000 1     2     3
3   1000 1     3     3
4   1000 2     1     2
5   1000 2     2     2
6   2000 1     1     4
7   2000 1     2     4
8   2000 1     3     4
9   2000 1     4     4
10  2000 2     1     2
11  2000 2     2     2 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-11T23:01:14.757

```
dat$MaxAct <- with(dat, ave(ActNo, HHID, PERID, FUN=max) ) 
```

对于涉及单个向量和分组的问题，您希望结果的长度等于行数，`ave`这是您选择的功能。对于更复杂的问题，`lapply(split(dat, fac), FUN)`可能需要或使用该方法`do.call(rbind, by( ...))`

如果您有缺失值：

```
dat$MaxAct <- with(dat, ave(ActNo, HHID, PERID, FUN=function(x) max(x, na.rm=TRUE) )  ) 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-09-11T23:07:31.830

这是`plyr`with `mutate`or `transform`，base R `ave` or的标准票价`data.table`（在这里可能被认为是花生的大锤）。

和 方法已得到`plyr`解决`ave`

# 数据表

```
library(data.table)
DT <- data.table(DF)
DT[,MaxAct := max(ActNo), by = list(HHID, PERID)] 
```

`data.table`考虑到数据的大小，可能不需要内存高效和快速的性质 。

阅读了您之前的问题[How to Create a Column of Ranks While Grouping in R](https://stackoverflow.com/questions/12377447)，所以我们知道这`max(ActNo)`只是每个组中的行数

```
DT[,MaxAct := .N, by = list(HHID, PERID)] 
```

会起作用，而且会稍微快一些。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-09-11T23:04:39.710

R中有几种方法可以完成这项任务。对我来说，最简单的方法是使用`plyr`包

```
require(plyr)
ddply(dat, .(HHID, PERID), transform, MaxAct = max(ActNo))

   UID HHID PERID ActNo MaxAct
1    1 1000     1     1      3
2    2 1000     1     2      3
3    3 1000     1     3      3
4    4 1000     2     1      2
5    5 1000     2     2      2
6    6 2000     1     1      4
7    7 2000     1     2      4
8    8 2000     1     3      4
9    9 2000     1     4      4
10  10 2000     2     1      2
11  11 2000     2     2      2 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-09-11T23:04:21.877

```
df <- read.table(textConnection("UID HHID PERID ActNo
1   1000 1     1
2   1000 1     2
3   1000 1     3
4   1000 2     1
5   1000 2     2
6   2000 1     1
7   2000 1     2
8   2000 1     3
9   2000 1     4
10  2000 2     1
11  2000 2     2"), header=T)

> ddply(df, .(HHID, PERID), transform, MaxAct = length(unique(ActNo)) )
   UID HHID PERID ActNo MaxAct
1    1 1000     1     1      3
2    2 1000     1     2      3
3    3 1000     1     3      3
4    4 1000     2     1      2
5    5 1000     2     2      2
6    6 2000     1     1      4
7    7 2000     1     2      4
8    8 2000     1     3      4
9    9 2000     1     4      4
10  10 2000     2     1      2
11  11 2000     2     2      2 
```

# jquery - jQuery 你如何 LIVE 绑定一个 jQuery 插件

> ID：12379044
> 
> 赞同：1
> 
> 时间：2012-09-11T22:55:05.260
> 
> 标签：jquery, jquery-plugins

我在页面上使用插件颜色选择器，并且该页面具有 ajax 事件，其中元素将在没有页面加载的情况下刷新，因此渲染颜色选择器也无法运行，因为它不是“实时”绑定的。所以只适用于第一次加载。

我知道如何实时绑定事件，例如单击、更改...等，但我不知道如何实时绑定到插件？

所以我的代码看起来像这样：

```
$('.box').ColorPicker(); 
```

任何帮助表示赞赏！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-11T23:10:31.777

这是你想要的

哦，使用`.on`api。如果你热衷于：[jQuery live 方法有什么问题？](https://stackoverflow.com/questions/11115864/whats-wrong-with-the-jquery-live-method/11115926#11115926)

希望能满足你的需要`:)`

**代码**

```
$(document).on('click', '.box', function(){
      $(this).ColorPicker();
}); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-11T23:02:21.097

如果是这种情况，您需要在元素可用后即时附加事件..

```
<div class="colorpicker">
    <div class='box'>Color</div>
</div>

<input type="button" id="btn1" value="Add New Color Picker" />    

$(function() {
    // Adding the Default colorPicker here
    $('.box').ColorPicker();

    $('#btn1').on('click' , function(){
        // Add the ColorPicker to the new Element added Here

        $('.colorpicker').append('<div class="box1">New Color</div>');
        $('div div').last().ColorPicker();

    });        
});​ 
```

试试这个方法。。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-04-28T12:29:42.120

您还可以通过 superlive 插件实时绑定插件。注意我没有使用这个插件的经验，但它看起来很时髦。

[https://code.google.com/p/jquery-superlive/](https://code.google.com/p/jquery-superlive/)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-22T20:22:17.387

这是来自 ColorPicker 网站的简单答案。

```
$('#ColorPicker').ColorPickerSetColor(color); 
```

我在使用 ajax 更新时遇到了同样的问题。

# php - 通过 window.opener 将值从弹出窗口传递到父窗口

> ID：12379047
> 
> 赞同：0
> 
> 时间：2012-09-11T22:55:14.740
> 
> 标签：php, javascript

我知道以前也有人问过类似的问题，但我找不到像我一样使用 window.opener 的问题。

我有一个页面打开一个弹出窗口以显示/编辑/删除数据库中的值。完成后，我使用它来结束脚本并返回父级。

```
die( "<script>window.opener.location.reload();window.close();</script>"); 
```

这很好用，但我想将一个值传回给我可以使用 $_GET 检索的父级。

这是一个日历，我使用上面的代码刷新父页面，以便自动显示对弹出窗口中显示的日记事件所做的更改（否则用户必须刷新自己）。在页面刷新的那一刻，它会回到默认日期，即今天，而不是受影响事件的日期。我想将日期传回给家长

蒂亚

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-11T23:19:24.377

对其进行排序，想到一个更简单的答案，我改用会话，保持简单

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-11T23:41:26.547

您可以将 js 代码放入您的`popup window`

```
<script>
    window.opener._newVar = "new value for parent window";
    // now you can direct access (_newVar) after popup closed.
</script> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-11T23:46:21.327

而不是`.reload()`，只需通过设置导航到具有所需查询字符串的同一页面`location.search`：

```
window.opener.location.search = "?value=" + val; window.close(); 
```

# codeigniter - 如何在 CodeIgniter 中制作类似 category/5/sub_category 的 url

> ID：12379050
> 
> 赞同：-1
> 
> 时间：2012-09-11T22:55:32.773
> 
> 标签：codeigniter, codeigniter-2, friendly-url, codeigniter-url, codeigniter-routing

我希望我的网址看起来像：

`www.domain.com/catalog/category_name/category_id/product_name/product_id`.

我的控制器应该如何完成此操作？

Controller 里面有 Catalog 和 Function category_name 是可以的。

但是我的产品控制器和功能将是什么。我怎样才能做出这样的结构。我需要有一个特定的文件结构吗？

我使用 CodeIgniter 框架。谢谢你的帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-11T23:06:24.357

你的控制器方法应该是这样的

```
<?
//..
    public function category_name($category_id,$product_name,$product_id){
        // some cool code
    }
//..
?> 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-12T07:58:18.340

通常不得更改控制器（如果它接受产品 ID 作为参数）。然后可以通过 URI 路由更改将所有其他信息放入数据库中的 url（通过产品 id 查询并获取相关信息）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-11T23:06:41.347

由于您的问题非常模糊-我的回答也是如此-但是此功能可以满足您的要求

```
Class Catalog extends CI_Controller
{
     public function category_name ($category_id, $product_name, $product_id)
     {
          // your function
     }
} 
```

# objective-c - 为什么这个 dispatch_sync() 调用冻结？

> ID：12379059
> 
> 赞同：29
> 
> 时间：2012-09-11T22:56:44.730
> 
> 标签：objective-c, multithreading, cocoa-touch, grand-central-dispatch

我正在使用 Kiwi 测试框架来测试我的应用程序中的身份验证方法。测试在调用 dispatch_sync 时冻结，如下所示：

```
dispatch_queue_t main = dispatch_get_main_queue();
dispatch_sync(main, ^
                  {
                      [[NSNotificationCenter defaultCenter] postNotificationName:kNotificationAuthenticationSuccess object:nil userInfo:ret];
                  }); 
```

如果有人有任何提示，我想知道它为什么会在那里冻结。

* * *

## 回答 #1

> 赞同：57
> 
> 时间：2012-09-11T23:13:31.027

关于冻结提示的问题的第二部分：

`dispatch_sync`在队列上调用时，**请始终验证此队列不是当前队列**( `dispatch_get_current_queue()`)。因为**`dispatch_sync`**会将您的块放在作为第一个参数传递的队列中，然后**将等待该块执行后再继续**。

因此，如果`dispatch_get_current_queue()`您将块入队的队列相同，即在您的情况下是主队列，则主队列将阻塞对 dispatch_sync 的调用，直到......主队列执行了该块，但它不能，由于队列被阻塞，**你在这里有一个漂亮的死锁**。

一种解决方案（[编辑] 直到 iOS6）：

```
dispatch_queue_t main = dispatch_get_main_queue();
dispatch_block_t block = ^
              {
                  [[NSNotificationCenter defaultCenter] postNotificationName:kNotificationAuthenticationSuccess object:nil userInfo:ret];
              };
if (dispatch_get_current_queue() == main)
  block(); // execute the block directly, as main is already the current active queue
else
  dispatch_sync(main, block); // ask the main queue, which is not the current queue, to execute the block, and wait for it to be executed before continuing 
```

* * *

[编辑] 小心，`dispatch_get_current_queue()`仅用于调试目的，绝不用于生产。实际上，`dispatch_get_current_queue`自iOS6.1.3 起已被弃用。

如果您处于主队列的特定情况（仅与主线程相关联），您可以`[NSThread isMainThread]`按照@meaning-matters 的建议进行测试。

* * *

顺便说一句，你确定你需要`dispatch_sync`吗？我想稍后发送你的通知，避免阻塞直到它被发送，在你的情况下是可以接受的，所以你也可以考虑使用`dispatch_async`（而不是使用`dispatch_sync`和需要队列比较条件），这也可以避免死锁问题。

* * *

## 回答 #2

> 赞同：42
> 
> 时间：2013-03-28T21:49:43.460

`dispatch_get_current_queue()`从 iOS 6 开始不推荐使用，并且`dispatch_get_current_queue() == dispatch_get_main_queue()`被发现`false`在 iOS 6.1.3 的主线程上。

在 iOS 6 及更高版本中，只需执行以下操作：

```
dispatch_block_t block = ^
{
    <your code here>
};

if ([NSThread isMainThread])
{
    block();
}
else
{
    dispatch_sync(dispatch_get_main_queue(), block);
} 
```

# ruby-on-rails-3 - 在 Rails3 的模型中获取当前用户

> ID：12379060
> 
> 赞同：0
> 
> 时间：2012-09-11T22:56:46.813
> 
> 标签：ruby-on-rails-3, activerecord, activeadmin

我正在使用 ActiveAdmin。我需要存储创建或更新每条记录的用户。

所以我为每个模型添加了 user_created_id 和 user_updated_id。在 before_save 上，我想存储有关 current_admin_user 的信息。问题是我无法访问模型中的 current_admin_user。

有没有办法在不破坏 MVC 的情况下做到这一点？

我发现了这个：[http](http://rails-bestpractices.com/posts/47-fetch-current-user-in-models) ://rails-bestpractices.com/posts/47-fetch-current-user-in-models 但我不确定它是否安全。

有什么帮助吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-12T12:56:34.590

在保存之前在控制器中执行它（这是控制器存在的原因）：

```
def create
  @my_model = MyModel.create params[:my_model]
  @my_model.user_created = current_user
  @my_model.save
end 
```

方法也一样`update`。

# ios - iOS CoreMotion Gryoscope 更新间隔

> ID：12379064
> 
> 赞同：0
> 
> 时间：2012-09-11T22:57:03.977
> 
> 标签：ios, core-motion

我正在编写一个在 iOS 兼容设备中使用 Gryoscope 的应用程序。我只希望陀螺仪每秒用新的坐标更新我的应用程序。我试图设置：

```
motionManager.gryoUpdateInterval=1 
```

但是，我似乎每秒获得一百万次更新（是的，我知道那是夸张的）。

我是否需要进行其他设置，或者这不可能？每个设备的此设置的最大值是多少？

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-11T23:18:58.200

**motionManager.gyroUpdateInterval = 1.0; 应该管用。**

但请注意，陀螺仪仅在第四代 iPod touch、iPhone 4 和 iPad 上使用。尝试添加 if-else 语句块以确保设备兼容性。

如果您不想了解更多信息，请尝试此[链接。](http://fromideatoapp.com/bonus-material/)

# python - 如何使用 Python 在 Windows 7 上获取网卡的使用百分比

> ID：12379070
> 
> 赞同：1
> 
> 时间：2012-09-11T22:57:44.597
> 
> 标签：python, windows, windows-7

如何使用 Python 在 Windows 7 上获得一个或多个网卡的使用百分比？我尝试使用 psutil 库，但它只返回传输的数据。

我想获取网卡列表及其使用情况

```
Network card 1 - 1%
Network card 2 - 0%
Network card 3 - 5% 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-12T02:23:18.427

您无法获得百分比，但您可以获得发送和接收的字节数，安装[psutil](https://github.com/giampaolo/psutil)，导入 psutil 和 re （正则表达式模块）。请参阅下面的示例代码，了解我是如何做到的。

```
import psutil # http://code.google.com/p/psutil/
import re # Regular expression

#Percentage function
def percentage(part, whole):
        return 100 * float(part)/float(whole)

if __name__ == '__main__':

    #Retrieve all stats for all Network Cards using psutil
    Stats = psutil.net_io_counters(pernic=True)

    #Just showing printed values for Stats, useful for new coders :)
    for key, val in Stats.items():
        print key, val

    #Filter Starts, convert to string for use with Regular expression
    LanString = str(Stats['Local Area Connection'])
    WirelessString = str(Stats['Wireless Network Connection'])

    #Regular expression pattern that collects values between = character and , character
    pattern = re.compile("\=(.*?)\,") 

    #Find all values matching the pattern
    LanResult = re.findall(pattern, LanString)
    WirelessResult = re.findall(pattern, WirelessString)

    #Select values bytes_sent + bytes_recieved, convert to integers, add together
    LanSumUsage = int(LanResult[0]) + int(LanResult[1])
    WirelessSumUsage = int(WirelessResult[0]) + int(WirelessResult[1])

    #Calculate and print percentages
    TotalUsage = LanSumUsage + WirelessSumUsage
    LanCardPercentage = percentage(LanSumUsage, TotalUsage)
    WirelessCardPercentage = percentage(WirelessSumUsage, TotalUsage)
    print("\nLan Card: %d%%") % LanCardPercentage
    print("Wireless Card: %d%%") % WirelessCardPercentage 
```

对这段代码持保留态度，这是编程新手（一周后）。也没有错误处理。

哦，我的输出在下面，我的网卡没有被使用。

```
Wireless Network Connection iostat(bytes_sent=801853517, bytes_recv=2106217519, packets_sent=4655581, packets_recv=6351113, errin=0, errout=0, dropin=0, dropout=0)
isatap.{10384343-0618-4406-B3D9-DA096A39B0DC} iostat(bytes_sent=0, bytes_recv=0, packets_sent=0, packets_recv=0, errin=0, errout=0, dropin=0, dropout=0)
Teredo Tunneling Pseudo-Interface iostat(bytes_sent=3358183, bytes_recv=27088294, packets_sent=40579, packets_recv=33727, errin=0, errout=1474, dropin=0, dropout=0)
Local Area Connection iostat(bytes_sent=0, bytes_recv=0, packets_sent=0, packets_recv=0, errin=0, errout=0, dropin=0, dropout=0)
Loopback Pseudo-Interface 1 iostat(bytes_sent=0, bytes_recv=0, packets_sent=0, packets_recv=0, errin=0, errout=0, dropin=0, dropout=0)
isatap.{109E44C6-1D07-4E41-A7EA-FCFF2284A1DB} iostat(bytes_sent=0, bytes_recv=0, packets_sent=0, packets_recv=0, errin=0, errout=0, dropin=0, dropout=0)

Lan Card: 0%
Wireless Card: 100% 
```

# javascript - if (foo !== null) 计算结果为 true，即使 foo 为 null

> ID：12379071
> 
> 赞同：0
> 
> 时间：2012-09-11T22:57:50.587
> 
> 标签：javascript, jquery

在javascript中，我有一个日志输出选项，它允许使用元素/选择器来指定输出日志/错误消息的位置。输出在初始化时格式化，如下所示：

```
var $messageOutput = options.messageOutputElement ? $(options.messageOutputElement) : null; 
```

稍后通过日志功能使用它：

```
function outputMessage(msg)
{
    if ($messageOutput !== null)
    {
        messageNum++;
        var $messageOutput = $(options.messageOutputElement);
        var html = $messageOutput.html();
        html += '<b>' + messageNum + '</b><br/>' + msg + '<br/>';
        $messageOutput.html(html);
        $messageOutput.scrollTop($messageOutput[0].scrollHeight);
    }
} 
```

问题是即使 $messageOutput === null，outputMessage() 中的 if 语句也会失败。我已经用 Chome 的调试器验证了 $messageOutput 确实等于 null。事实上，它无论如何都会进入 if 语句。

谁能告诉我为什么会发生这种情况？提前感谢您对此事的任何意见。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-11T23:04:31.880

通过在函数范围内声明“var $messageOutput”，您将停止在全局范围内引用该变量。因此，它不是指那个，而是指一个尚未在函数体内设置的变量，它是未定义的，不是空的。您可能应该删除“var $messageOutput = $(options.messageOutputElement);”的“var”部分，这将使函数引用函数外部的 $messageOutput。

详细说明一下：“var”在您所在的范围内创建了一个新变量，并且为了增加混乱，“var foo = function”之类的行为与“function foo”不同。以下是一些有趣的案例和解释，供您阅读：

```
var x = 5;

function f () {
  console.log(x):
  if (!x) {
   var x = 22;
  }
  return x;
}
function g () {
  console.log(x):
  if (!x) {
    x = 22;
  }
  return x;
}
f(); // prints nothing, and returns 22
g(); // prints 5, and returns the same value 
```

您有时还需要注意的是，您可以在声明之前在全局范围之外引用函数，具体取决于它的声明方式。例如：

```
function f () {
  console.log(f_sub);
  function f_sub () {
    return "subfunction of f";
  }
  return f_sub;
}
function g() {
  console.log(g_sub);
  var g_sub = function () {
    return "subfunction of g";
  }
  return g_sub;
}
f(); // prints and returns f_sub
g(); // prints undefined and returns g_sub 
```

传统的函数声明可以在任何地方进行并在任何地方引用，但是将函数分配给变量意味着在执行该行之前不能引用它。

# php - 如何让 php 脚本等待用户输入

> ID：12379072
> 
> 赞同：3
> 
> 时间：2012-09-11T22:58:04.097
> 
> 标签：php, multithreading, concurrency, input, game-loop

这是我的问题，对于那些看了标题并认为“PHP 不等待用户输入，因为它是一种服务器端语言，因此你的问题是客户端语言”的人，请听我说完。

我在做游戏。这是多人游戏，因此有多个用户。在每一轮游戏开始时，参与游戏的用户会被提示选择他们想要在该轮做的事情。当然，在每个人都选择了他们想要在该轮中做什么之前，该轮不会开始。

看，那是我的问题。如何让脚本在继续执行之前等待“所有”用户发送请求（发送输入）？服务器端语言是 PHP。答案不会在客户端，因为客户端只对一个用户负责，并且不知道其他用户在做什么。

谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-11T23:04:21.903

从根本上说，您有两个选择：

选择一，你让每个脚本检查它是否有它需要的所有数据，然后做所有的工作来计算下一步（或其他）。这实际上比听起来要困难得多，因为您会遇到并发问题。

基本上，这种方法会导致不止一个“过程”——页面加载——试图对相同的数据做同样的工作，这为你要么根本不做工作，要么做的比赛打开了大门它两次。

选择二，听起来更难，是你编写另一个 PHP 脚本来检查它是否有所有的动作，计算结果，并在后台更新数据库（或其他）。

然后，通过 cron 作业或类似的方式运行它，这样您一次只能运行一个实例。这让生活变得更轻松：您的“一切都完成了”脚本只运行一次，因此您不必担心比赛 - 但在提交最后一步和计算结果之间可能存在延迟。

从长远来看，这种方法实际上更容易，因为虽然它涉及更多代码和更多移动部件，但它实际上避免了困难问题（并发），以换取一些更简单的问题（更多代码，使用 cron）。

当然，您可以在这两个方面进行改进，但这些是基本模型。锁定和其他协调技术可以使“在最后一页计算”工作得更好，但它们涉及到你解决比赛。

使用各种“后台作业”工具可以改善第二种方法的延迟，让您立即触发检查，而不仅仅是在计时器上。您仍然有一些延迟，但用户看不到它。

但是，实际上，您可以选择这两种策略中的一种并采用它。

（另外，我强烈建议如果可以的话，抓住一个框架或其他人已经解决了这些问题的东西，然后使用它。）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-11T23:11:37.520

由于您无法将数据推出，我将按以下方式解决此问题：

1.  在例如数据库中收集服务器上提交的信息
2.  运行客户端脚本以定期检查所有必需的信息是否可用
3.  在客户端评估响应：如果为真，开始游戏 - 如果不是“等待”=继续检查

所以你需要：

*   收集信息的服务器上的脚本
*   检查所有信息是否可用的服务器脚本
*   定期检查和评估的客户端脚本

# scala - 电梯 - 设置它

> ID：12379074
> 
> 赞同：0
> 
> 时间：2012-09-11T22:58:20.670
> 
> 标签：scala, lift, sbt

今天我从 scala 和 lift 开始，我目前正在阅读文档。在食谱的帮助下，我设法开始了它。

但是我想阅读一些更大的示例，尤其是这个示例，因为它使用 mongodb + 身份验证[https://github.com/eltimn/lift-mongo.g8/tree/master/src/main/g8](https://github.com/eltimn/lift-mongo.g8/tree/master/src/main/g8)

我没有使用 g8 或 cs，因为我在 cs 上有一些错误，我懒得去调查它们。

所以我只是将回购克隆到我的硬盘上。我认为这就是 g8 正在做的事情。

所以有些文件丢失了，我添加了它们

*   sbt

*   sbt.bat（我正在使用 Windows）

*   sbt-launch.jar

但我收到以下错误：

```
[warn]  ::::::::::::::::::::::::::::::::::::::::::::::
[warn]  ::          UNRESOLVED DEPENDENCIES         ::
[warn]  ::::::::::::::::::::::::::::::::::::::::::::::
[warn]  :: org.scala-sbt#sbt-closure;0.1.3: not found
[warn]  :: com.github.siasia#xsbt-web-plugin_2.9.1;0.11.2
ound
[warn]  :::::::::::::::::::::::::::::::::::::::::::::: 
```

我试图修复 sbt-closure 但我无法通过 maven 搜索找到它

[http://search.maven.org/#search%7Cga%7C1%7Csbt-closure](http://search.maven.org/#search%7Cga%7C1%7Csbt-closure)

plugins.sbt 看起来像这样

```
resolvers += Resolver.url("sbt-plugin-releases",
  new URL("http://scalasbt.artifactoryonline.com/scalasbt/sbt-plugin-releases/"))(
    Resolver.ivyStylePatterns)

addSbtPlugin("org.scala-sbt" % "sbt-closure" % "0.1.3")

addSbtPlugin("me.lessis" % "less-sbt" % "0.1.10")

libraryDependencies <+= sbtVersion(v => "com.github.siasia" %% "xsbt-web-plugin" % (v+"-0.2.11.1")) 
```

知道出了什么问题吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-12T16:11:42.167

每个新版本的 SBT 都需要重新发布 SBT 插件。我的猜测是您下载的模板基于旧版本的 SBT（可能是 0.11？），并且您引用的插件版本尚未针对最新的 SBT（0.12）发布。您可以尝试查找旧版本的 SBT 进行下载，但您最好让 g8/conscript 正常工作，或者使用以下模板之一：[https](https://github.com/lift/lift_24_sbt) ://github.com/lift/lift_24_sbt 。

# search - Sphinx - 过滤一个索引，搜索另一个全文

> ID：12379076
> 
> 赞同：0
> 
> 时间：2012-09-11T22:58:45.453
> 
> 标签：search, indexing, sphinx

对于房地产门户网站，代理商会记录每天有多少开放参观的客人出现。我正在尝试使用 sphinx api 在名为“open_house_guest_info”的 sphinx 索引中过滤访问次数最多的房屋，然后在另一个带有房屋介绍“房屋”的 sphinx 索引中搜索这些房屋 ID，并带有搜索词。

**“open_house_guest_info”索引：**
日期、house_id、guest_count

**“房屋”索引：**
house_id、house_intro

我知道如何用 MySQL 做到这一点，但我正在尝试用 Sphinx 做到这一点。如何根据从与“house_id”相关的另一个索引过滤的属性来搜索不同索引的文本？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-12T11:19:31.790

狮身人面像无法“加入”索引。您必须将所有数据放在一个索引中。

建立索引的 sql_query，可以包括 JOIN 和 GROUP BY 等。由 mysql 执行以创建单个索引。

```
sql_query = SELECT g.id,house_id,house_intro,REPLACE(date,'-','') as date,COUNT(g.id) AS guests FROM houses h INNER JOIN open_house_guest_info g USING (house_id) GROUP BY date,house_id

sql_attr_uint = house_id
sql_attr_uint = date
sql_attr_uint = guests 
```

然后可以按日期、house_id 或客人过滤/分组/排序:) [在 sphinx 查询中]

# nosetests - nosetest Ran 0 对 pandas 的测试

> ID：12379077
> 
> 赞同：2
> 
> 时间：2012-09-11T22:58:51.637
> 
> 标签：nosetests

我尝试遵循熊猫文档。将其安装在 Ubuntu 10.4 上，但是当运行鼻子测试时得到结果 0 测试

```
~$ nosetests pandas

----------------------------------------------------------------------
Ran 0 tests in 0.002s

OK 
```

似乎所有东西都安装正确，所以不知道如何处理它或如何解释（我是鼻子测试的新手）。你能帮我解释一下输出还是建议我应该如何运行这个测试

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-09-03T07:44:53.347

在尝试此操作之前，我在每个尝试过的目录中都收到了*ran 0 tests消息：*

```
/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/site-packages/pandas-0.11.0-py2.7-macosx-10.6-intel.egg/pandas/tests$ sudo nosetests * 
```

sudo 是消除第一轮访问错误所必需的。然后我得到了这些错误：

```
======================================================================
FAIL: test_cast_internals (pandas.tests.test_frame.TestDataFrame)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/site-packages/pandas-0.11.0-py2.7-macosx-10.6-intel.egg/pandas/tests/test_frame.py", line 9092, in test_cast_internals
    assert_frame_equal(casted, expected)
  File "/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/site-packages/pandas-0.11.0-py2.7-macosx-10.6-intel.egg/pandas/util/testing.py", line 250, in assert_frame_equal
    assert(left.columns.names == right.columns.names)
AssertionError

======================================================================
FAIL: test_constructor_from_items (pandas.tests.test_frame.TestDataFrame)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/site-packages/pandas-0.11.0-py2.7-macosx-10.6-intel.egg/pandas/tests/test_frame.py", line 2765, in test_constructor_from_items
    assert_frame_equal(recons, self.frame)
  File "/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/site-packages/pandas-0.11.0-py2.7-macosx-10.6-intel.egg/pandas/util/testing.py", line 250, in assert_frame_equal
    assert(left.columns.names == right.columns.names)
AssertionError

======================================================================
FAIL: test_constructor_more (pandas.tests.test_frame.TestDataFrame)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/site-packages/pandas-0.11.0-py2.7-macosx-10.6-intel.egg/pandas/tests/test_frame.py", line 2565, in test_constructor_more
    tm.assert_frame_equal(dm, self.frame)
  File "/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/site-packages/pandas-0.11.0-py2.7-macosx-10.6-intel.egg/pandas/util/testing.py", line 250, in assert_frame_equal
    assert(left.columns.names == right.columns.names)
AssertionError

======================================================================
FAIL: test_constructor_orient (pandas.tests.test_frame.TestDataFrame)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/site-packages/pandas-0.11.0-py2.7-macosx-10.6-intel.egg/pandas/tests/test_frame.py", line 2713, in test_constructor_orient
    assert_frame_equal(recons, expected)
  File "/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/site-packages/pandas-0.11.0-py2.7-macosx-10.6-intel.egg/pandas/util/testing.py", line 249, in assert_frame_equal
    assert(left.index.names == right.index.names)
AssertionError

======================================================================
FAIL: test_constructor_subclass_dict (pandas.tests.test_frame.TestDataFrame)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/site-packages/pandas-0.11.0-py2.7-macosx-10.6-intel.egg/pandas/tests/test_frame.py", line 2267, in test_constructor_subclass_dict
    assert_frame_equal(self.frame.sort_index(), frame)
  File "/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/site-packages/pandas-0.11.0-py2.7-macosx-10.6-intel.egg/pandas/util/testing.py", line 249, in assert_frame_equal
    assert(left.index.names == right.index.names)
AssertionError

======================================================================
FAIL: test_getitem_fancy_2d (pandas.tests.test_frame.TestDataFrame)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/site-packages/pandas-0.11.0-py2.7-macosx-10.6-intel.egg/pandas/tests/test_frame.py", line 620, in test_getitem_fancy_2d
    assert_frame_equal(ix[:, :2], f.reindex(columns=['A', 'B']))
  File "/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/site-packages/pandas-0.11.0-py2.7-macosx-10.6-intel.egg/pandas/util/testing.py", line 250, in assert_frame_equal
    assert(left.columns.names == right.columns.names)
AssertionError

======================================================================
FAIL: test_getitem_fancy_boolean (pandas.tests.test_frame.TestDataFrame)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/site-packages/pandas-0.11.0-py2.7-macosx-10.6-intel.egg/pandas/tests/test_frame.py", line 1106, in test_getitem_fancy_boolean
    assert_frame_equal(result, expected)
  File "/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/site-packages/pandas-0.11.0-py2.7-macosx-10.6-intel.egg/pandas/util/testing.py", line 250, in assert_frame_equal
    assert(left.columns.names == right.columns.names)
AssertionError

======================================================================
FAIL: test_time_series_plot_color_with_empty_kwargs (pandas.tests.test_graphics.TestDataFrameGroupByPlots)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/site-packages/pandas-0.11.0-py2.7-macosx-10.6-intel.egg/pandas/tests/test_graphics.py", line 752, in test_time_series_plot_color_with_empty_kwargs
    self.assert_(line_colors == ['b', 'g', 'r'])
AssertionError: False is not true

----------------------------------------------------------------------
Ran 3382 tests in 341.290s

FAILED (SKIP=46, failures=8) 
```

# json - 循环将数据添加到复杂的 JSON 对象

> ID：12379079
> 
> 赞同：0
> 
> 时间：2012-09-11T22:58:56.703
> 
> 标签：json, loops

我有一个像这样的复杂 JSON 对象：

```
var requestData = { __batchRequests: [ { __changeRequests: [
{ requestUri: "Customers", method: "POST", headers: { "Content-ID": "1" }, data: { 
    CustomerID: 400, CustomerName: "John"
}  }
] } ] }; 
```

我正在尝试做两件事：

1.  声明此对象，但变量**数据**为空

2.  使用循环，将项目动态添加到**数据**对象，

我该怎么做？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-12T00:32:43.610

这不是一个太复杂的对象。在转换为字符串之前，它不是 JSON。现在，它只是普通的 JS 对象和数组。

将其分解为其元素可能如下所示：

```
var requestData = {};
requestData.__batchRequests = [];
requestData.__batchRequests[0] = {};
requestData.__batchRequests[0].__changeRequests = [];
requestData.__batchRequests[0].__changeRequests[0] = {};
requestData.__batchRequests[0].__changeRequests[0].requestUri = "Customers";
requestData.__batchRequests[0].__changeRequests[0].method = "POST";
requestData.__batchRequests[0].__changeRequests[0].headers = { "Content-ID" : "1" };
requestData.__batchRequests[0].__changeRequests[0].data = {}; 
```

除了重复，你看到了什么？就个人而言，我认为这`__changeRequests[0]`是一个简单的对象：

```
var changeRequest = {
    requestUri : "Customers",
    method : "POST",
    headers : { "Content-ID" : "1" },
    data : {}
}; 
```

我还看到我可以将其推送到我的更改请求数组中：

```
requestData.__batchRequests[0].__changeRequests.push(changeRequest); 
```

正确的？

我也知道我的`changeRequest`变量仍然指向我刚刚添加到数组中的变量，并且无论我在对象上所做的任何更改都将在数组对对象的引用中显示为已更改：

```
changeRequest.data.CustomerName = "Bob";
changeRequest.data.CustomerID = "204";

requestData.__/*...*/changeRequests[0].data.CustomerName; // Bob 
```

那么如何给自己写一些辅助函数呢？

```
function extend (obj, additions) {
    var key;
    for (key in obj) { if (additions.hasOwnProperty(key)) {
        obj[key] = additions[key];
    }
}

function makeChangeRequest (url, method, headers, data) {
    var request = {
        requestUri : url,
        method : method,
        headers : {},
        data : {}
    };

    extend(request.headers, headers);
    extend(request.data, data);

    return request;
}

function getBatch (num) { return requestData.__batchRequests[num]; }

var changeReq = makeChangeRequest("Customers",
                                  "POST",
                                  { "Content-ID" : "1" },
                                  { CustomerName : "Bob", CustomerID : "2012" });

var batch = getBatch(0);

batch.__changeRequests.push(changeReq); 
```

如果您想`changeReq.data`稍后添加更多数据：

```
extend(changeReq.data, { Address : "33 Nowhere Rd.", City : "Splitsville" }); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-11T23:59:44.490

对于问题的第一部分，您可以`data`使用空关联数组进行初始化：

```
var requestData = { __batchRequests: [ { __changeRequests: [
{ requestUri: "Customers", method: "POST", headers: { "Content-ID": "1" }, data: {}  }
] } ] }; 
```

下一部分假设（可能是错误的）您可以使用 jQuery。它还假设您有一个包含所有相关键值对的数组。

```
var customerDeetsArray =[{CustomerID: 400}, {CustomerName: "John"}]; 

for (var i in customerDeetsArray) {
  requestData.data = $.extend(requestData.data, customerDeetsArray[i]);
} 
```

请参阅使用 console.debug 的工作示例：

[http://jsfiddle.net/4Rh72/6/](http://jsfiddle.net/4Rh72/6/)

# android - 带有 Android API 的 NFC 读取标签

> ID：12379084
> 
> 赞同：1
> 
> 时间：2012-09-11T22:59:16.597
> 
> 标签：android, nfc

我还在学习 Android API。

有人可以给我一些使用 Android API 启用 NFC 读取标签的指南吗？为了阅读消息的内容，必须发生哪些主要事项？应该发生的事情的顺序是什么？有人有几行示例代码吗？

例如：

1.  如何阅读意图过滤器：我是否使用“PendingIntent”？
2.  应用程序是否需要能够处理异常？如果是，如何。
3.  如何使用“NfcAdapter”。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-11T23:02:42.397

[这](http://developer.android.com/guide/topics/connectivity/nfc/index.html)是您需要开始的。阅读基础部分，你应该离开 :)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-12T07:03:32.230

查看[此](http://tapintonfc.blogspot.sg/2012/08/nfc-workshop-series-android-dispatch.html)NFC 研讨会系列。这会帮助你。

# c# - 如何通过 New-Variable 将数组变量注入 PowerShell 运行空间

> ID：12379091
> 
> 赞同：1
> 
> 时间：2012-09-11T22:59:52.063
> 
> 标签：c#, powershell

假设我已经通过

```
 var rs = RunspaceFactory.CreateRunspace();
            rs.Open(); 
```

让我们进一步假设我想通过使用 New-Variable cmdlet 将一个变量添加到该运行空间中，该变量键入为一个数组，如下所示：

```
 // create a pipeline to add the variable into the runspace
            var pipeline = PowerShell.Create();
            // create a command object, add commands and parameters to it...
            var cmd = new PSCommand();
            cmd.AddCommand("New-Variable");
            cmd.AddParameter("Name", "foo");
            cmd.AddParameter("Value", "@()");
            // associate the command with the pipeline and runspace, and then invoke
            pipeline.Commands = cmd;
            pipeline.Runspace = rs;
            pipeline.Invoke(); 
```

代码有效，我没有收到任何错误，但变量 'foo' 没有创建为数组类型。我在“@()”上尝试了许多不同的变体，但到目前为止都没有成功。最终，我认为问题归结为如何将 Value 参数正确格式化为 New-Variable，以便将 'foo' 解释为空的 PowerShell 数组类型。

谢谢，

马特

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-12T01:50:59.640

仅供参考，您可以直接在 C# 中执行此操作，如下所示：

```
pipeline.Runspace.SessionStateProxy.PSVariable.Set("foo", new object[0]); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-11T23:16:06.047

`PSCommand.AddParameter`参数名称为字符串，参数值为**对象**。[请参阅此处](http://msdn.microsoft.com/en-us/library/windows/desktop/dd182483%28v=vs.85%29.aspx)的文档。

您应该放置一个“真正的”空数组，而不是代表等效 powershell 脚本的字符串。

```
cmd.AddParameter("Value", new object[0]); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-01-10T19:04:44.020

拯救我的回应是：

如果您是从文本中完成所有操作，则可以查看`AddScript`方法。例如，`var cmd = new PSCommand().AddScript("$myVar = @()");`将生成一个名为 的新变量`$myVar`。

C# 代码中的示例：

```
foreach (Collaborator collab in collabs)
                {
                    counter ++;
                    arrayUsers.Append("@(\"" + collab.mail + "\", \"" + collab.url + "\")");
                    if (counter < numbercollabs)
                        arrayUsers.Append(",");
                }
                string arrayUsersPowerShell =  arrayUsers.ToString();
and then :

using (PowerShell powerShellInstance = PowerShell.Create())
                {
 powerShellInstance.AddScript("$d = get-date; " +
                        "$arrayUsers = @(" + arrayUsersPowerShell + "); " +
                        "$d | Out-String; $arrayUsers[0][1]");
...
Collection<PSObject> PSOutput = powerShellInstance.Invoke();
...
} 
```

所以我们可以正确构造数组

# mysql - MySQL优化三重左连接

> ID：12379092
> 
> 赞同：-1
> 
> 时间：2012-09-11T22:59:59.120
> 
> 标签：mysql, mysql-workbench

我需要进行一个查询，从各种表中获取列 - 总共 5 个表。我很高兴得到左连接的要点，并得到我需要的结果，唯一的问题是速度。我对索引/键有点迷茫，可能是因为我的案例与我在网上阅读的所有示例都不典型。我的表中的“唯一” id 不是所有表中的主键，并且不能是因为该 id 在表中可以有几行（历史/审计目的）。id 在几个表（##/### 和##-###）中也采用不同的格式，因此匹配它们的函数可能会导致速度大大降低。到目前为止粘贴我的代码可能更容易（只有 3 个表 - 在我可以先征服 3 个表之前不要全部完成！），并且希望有人可以建议如何使用索引和键进行改进。

```
SELECT dc.URN,dc.GuideName,dc.GuideStreet,ss.categorycalc,pm.initiatedate
FROM dc
LEFT JOIN pm
ON dc.URN = pm.URN
LEFT JOIN ss
ON dc.URN = replace(ss.URN,"/","-")
WHERE dc.GuidePCode LIKE 'WA9%'
ORDER BY pm.Status ASC; 
```

我希望少一些建议来重新启动数据库并“正确执行”等 - 已经有很多程序已经编码以某些方式将数据插入某些表。因此，更改唯一 ID 的结构以及将其写入某些表的方式是非常不切实际的。我只需要专注于完成我已经获得的数据的报告。“WA9”部分将根据用户想要搜索的内容而变化。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-12T00:16:29.880

首先我会做一个解释。检查 MySQL 手册是否正确使用，但基本上是：

```
EXPLAIN SELECT dc.URN,dc.GuideName,dc.GuideStreet,ss.categorycalc,pm.initiatedate 
FROM dc 
LEFT JOIN pm ON dc.URN = pm.URN 
LEFT JOIN ss ON dc.URN = replace(ss.URN,"/","-") 
WHERE dc.GuidePCode LIKE 'WA9%' 
ORDER BY pm.Status ASC; 
```

查看“关键”列。如果表的一行是空的，那么您可能需要这些字段的索引。如果您还没有它，我建议您添加以下内容：（
顺便说一句，首先在测试环境中运行它）

```
ALTER TABLE dc ADD INDEX URNIdx (URN);
ALTER TABLE pm ADD INDEX URNIdx (URN);
ALTER TABLE dc ADD INDEX GuidePCodeIdx (GuidePCode); 
```

我会说尝试向表 ss 添加索引，但我认为最好创建一个名为 URNdashed 的新列到 ss，其定义与 URN 相同。然后运行此更新：

```
UPDATE ss SET URNdashed = replace(ss.URN, "/", "-"); 
```

还要向 URNdashed 添加一个索引：

```
ALTER TABLE ss ADD INDEX URNdashedIdx (URNdashed); 
```

然后改变你的：

```
ON dc.URN = replace(ss.URN,"/","-") 
to 
ON dc.URN = URNdashed 
```

看看是否有帮助。我希望我把你引向了正确的方向！

# php - 第一篇文章后的 Wordpress 粘性帖子

> ID：12379096
> 
> 赞同：1
> 
> 时间：2012-09-11T23:00:14.910
> 
> 标签：php, wordpress, loops, posts, sticky

我一直在尝试在第二个（或第三个等）位置而不是默认的第一个位置上显示单个粘性帖子。

我已经玩了几个小时的循环，但我总是遇到问题。

这是我到目前为止所做的：

```
 <!-- Wordpress Main Loop Start -->
  <?php  query_posts(array("post__not_in" =>get_option("sticky_posts"))); ?>
  <?php if ( have_posts() ) : $loop_count = 0; while ( have_posts() ) : the_post(); $loop_count++; ?>
  <div <?php post_class(); ?>>
    <h2><a href="<?php the_permalink(); ?>"><?php the_title(); ?></a></h2>
    <div class="byline postinfo">by <?php the_author_posts_link(); ?></div>
    <div class="postdate postinfo"><?php the_time('l F d, Y'); ?></div>
    <div class="commentscounter postinfo"><a href="<?php comments_link(); ?>"><?php comments_number('0', '1', '%'); ?></a></div>
    <?php
      if ($loop_count == 2) : 
      $sticky = get_option( 'sticky_posts' ); 
      query_posts( 'p=' . $sticky[0] );
      wp_reset_query();
      else:
      the_excerpt('Read More...'); 
      endif;
    ?>
  </div>
  <?php endwhile; else: ?>
    <p><?php _e('No posts were found. Sorry!'); ?></p>
  <?php endif; ?>

  <div class="navi">
    <div class="right">
      <?php previous_posts_link('Previous'); ?> / <?php next_posts_link('Next'); ?>
    </div>
  </div>
  <!-- Wordpress Main Loop End --> 
```

我所做的是这样的：

1.  我使用 query_posts() 从循环中过滤掉所有粘性帖子。
2.  使用循环来获取帖子和每次获取帖子时递增的计数器。
3.  在显示获取的帖子的 div 上，我添加了一个 if 语句，它检查计数器是否是特定数字，如果是，它会重写 query_posts 并获取粘性的。如果没有，它会显示获取的帖子。
4.  然后我重置查询，循环继续（几乎）。

问题是，在计数达到我想要的值后，循环不是从上一篇文章继续，而是从头开始。

如果我删除 wp_reset_query() 函数，则循环只会在找到粘性帖子时停止。

如果我尝试重写查询以包含所有帖子，我会得到无限循环，因为我已经在循环中。

我不想将循环分成两三个，所以如果有人可以使用一个循环帮助解决这个问题，那就太好了！

# c - 内存管理的困惑：C程序中的全局char *

> ID：12379098
> 
> 赞同：0
> 
> 时间：2012-09-11T23:00:26.730
> 
> 标签：c, memory-management, global-variables

我有一个程序，我有一个全局变量`char *`，我会不断地改变它。现在，当它是 时，我将它设置为一个值`NULL`，并在它不是时更改它。但是，`NULL`即使我正在设置指针，它也永远不会。我所说的一个例子：

```
char *a;

void function()
{
    if(a == NULL)
    {
         a = "Test1";
    }
    else
    {
         a = "Test2";
    }
} 
```

但是，每次我通过这个函数时，a 总是为空。我认为我需要对内存分配做一些事情，但我对分配它的位置以及释放它的位置感到困惑。谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-11T23:30:05.503

第一次调用 function() 时，'a' 将为 NULL，因为 C 中的全局变量被初始化为零。

然后将其设置为指向“Test1”。第二次调用 function() 时，'a' 仍然是指向“Test1”的指针，而不是 NULL，因此您将其设置为“Test2”。以后的每个调用基本上都不会做任何事情，一次又一次地将“a”设置为“Test2”。

如果这不是您所看到的，那么与您在上面发布的代码相比，您的实际代码会有所不同。例如，如果“char *a”在函数内部，那么它是一个局部变量，而不是全局变量，并且在函数进入时它将具有未定义的值，并且每次函数退出时也会丢失其值。

下面的代码在它下面产生了输出，正如它应该的那样。

```
#include <stdlib.h>
#include <stdio.h>

char *a;

void function();

int main( int argc, const char *argv[] )
{
    function();
    function();
    function();
    function();

    return 0;
}

void function()
{
    printf( "function: a=%s", (a ? a : "NULL") );

    if(a == NULL)
    {
         a = "Test1";
    }
    else
    {
         a = "Test2";
    }

    printf( "  exiting a=%s\n", (a ? a : "NULL") );
}

This produces the following output:

function: a=NULL  exiting a=Test1
function: a=Test1  exiting a=Test2
function: a=Test2  exiting a=Test2
function: a=Test2  exiting a=Test2 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-11T23:37:48.120

我为此感到有些不好意思。问题是我正在分叉进程，并在子进程中编辑变量的副本，而没有意识到父进程的变量不受影响。

对于那个很抱歉。希望这可以帮助遇到此问题的其他人。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-11T23:15:34.497

我将其写为“响应”而不是问题，以便更好地格式化文本：

Q1）如果你这样初始化，行为会改变吗？

`char *a = NULL;`

Q2) 你的编译器、编译器版本和操作系统是什么？

Q3）您*确定*没有其他代码可能与“a”混淆吗？

====================================================

附录：

问：我刚刚意识到我在分叉后在子进程中编辑变量的值。这可能是问题吗？– 梅森

答：仅当您希望更改一个进程中的变量以某种方式更改另一个进程时（不分配共享内存段）；）

# visual-studio - Visual Studio 2012 文档下载

> ID：12379100
> 
> 赞同：12
> 
> 时间：2012-09-11T23:00:32.743
> 
> 标签：visual-studio, visual-studio-2012

大约在 2006 年，Microsoft 曾经提供过 MSDN 库的 ISO 映像。不幸的是，他们不再这样做了。现在，如果您想获得本地帮助，您必须从 Visual Studio 环境中下载它。问题是我刚刚在无法访问 Internet 的家用 PC 上安装了 Visual Studio 2012。

任何人都知道如何下载我可以在我的电脑上手动安装的文档副本？

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2012-10-22T13:57:28.353

您可以在此处获取 Visual Studio 2012 文档的 ISO

[http://www.microsoft.com/en-us/download/details.aspx?id=34794](http://www.microsoft.com/en-us/download/details.aspx?id=34794)

它有 2.7GB 大。

更新：Microsoft 已将 ISO for Visual Studio 2013 文档添加到与上述相同的链接中。

那个 ISO 有 4GB 大。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-09-24T11:02:09.213

[http://download.microsoft.com/download/8/9​​/2/8928585D-136D-4528-AECC-2F211902A8D7/VS2012Documentation.iso](http://download.microsoft.com/download/8/9/2/8928585D-136D-4528-AECC-2F211902A8D7/VS2012Documentation.iso) 上面提供的链接非常有关于 vs 2012 Ultimate 的帮助文档。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-11T23:07:10.813

我记得不久前也在寻找这个，并且（虽然我可能不正确）没有合理的方法可以做到这一点。CD 上仍有可用的文档，但据我所知，您必须是 MSDN 订阅者，但您发现不再有 ISO 可供下载 - 真遗憾，因为它们很有用。

获得它的唯一方法是向拥有 MSDN 订阅并愿意让您使用它们的人乞求、窃取或借用（但实际上不是第二种选择......）CD。但是，仅作记录，我想这违反了销售条款。

# php - MySQL PHP DELETE 不适用于此实例？

> ID：12379103
> 
> 赞同：0
> 
> 时间：2012-09-11T23:00:55.393
> 
> 标签：php, mysql, linux

```
mysql_query($sqlQ, $connection);
mysql_query("DELETE FROM Leaderboards WHERE UserName=" . $row['UserName'] . " LIMIT 1", $connection);
echo("Success3"); 
```

表信息包括：{UserName, Cash, Assets}。

$row['UserName'] 有数据，因为 $row['Assets'] 有数据，INSERT 通过查询工作，但它不会从 db 表中删除该行。

告诉我我做错了什么，这是我第一次使用 PHP 和 MySQL，所以我不知道我在做什么。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-11T23:02:40.677

是`UserName`字符串吗？你缺少引号。

```
mysql_query("DELETE FROM Leaderboards WHERE UserName='" . $row['UserName'] . "' LIMIT 1", $connection); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-11T23:04:55.280

所有 mysql_* 函数都已弃用，并将在 PHP 的未来版本中删除。[您应该使用替代方法](http://php.net/manual/en/mysqlinfo.api.choosing.php)。

您必须转义查询中使用的数据。使用 MySQLi 函数，您的代码将是：

```
mysqli_query($sqlQ, $connection);
mysqli_query("DELETE FROM Leaderboards WHERE UserName='" . mysqli_real_escape_string($connection, $row['UserName']) . "' LIMIT 1", $connection);
echo("Success3"); 
```

您还缺少用户名周围的引号。

我建议不要，但如果你真的想使用 mysql_* 函数，那么使用：

```
mysqli_query("DELETE FROM Leaderboards WHERE UserName='" . mysql_real_escape_string($row['UserName']) . "' LIMIT 1", $connection); 
```

# c - 如何在 C 中获取变量的最低有效字节

> ID：12379109
> 
> 赞同：2
> 
> 时间：2012-09-11T23:01:55.437
> 
> 标签：c, byte

我正在尝试编写一个 C 函数，该函数将打印一个由 x 的最低有效字节和 y 的剩余字节组成的单词。例如，如果 x = 0x89ABCDEF 和 y = 0x76543210，这应该给出 0x765432EF，但如何？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-09-12T07:28:52.620

为了操作数据类型中的特定位（或字节），您应该使用按位运算符。

基本的按位运算符是 | (or)、& (and)、^（异或）和 ~（非或补码），它们的工作方式与逻辑运算符 ||、&& 和 ! 非常不同。

使用您的变量 x = 0x89ABCDEF 和 y = 0x76543210，让我们逐步完成一个解决方案：

首先，这些是二进制的 x 和 y 的值：

```
 x = 1000 1001 1010 1011 1100 1101 1110 1111
    y = 0111 0110 0101 0100 0011 0010 0001 0000 
```

我已将 32 位分成 4 组，以查看十六进制如何转换为二进制。

现在，我们需要取消设置 x 中除最后一个字节之外的所有字节：操作 (x & 0xFF)

```
 x = 1000 1001 1010 1011 1100 1101 1110 1111
        0xFF = 0000 0000 0000 0000 0000 0000 1111 1111
    --------------------------------------------------
    x & 0xFF = 0000 0000 0000 0000 0000 0000 1110 1111 
```

我们只需要取消设置 y 的最后一个字节：操作 (y & ~0xFF)

```
 y = 0111 0110 0101 0100 0011 0010 0001 0000
          ~0xFF = 1111 1111 1111 1111 1111 1111 0000 0000 (~ flips all bits)
    -----------------------------------------------------
    (y & ~0xFF) = 0111 0110 0101 0100 0011 0010 0000 0000 
```

现在，使用“或”运算组合我们的结果： (x & 0xFF) | (y & ~0xFF)

```
 (x & 0xFF) = 0000 0000 0000 0000 0000 0000 1110 1111
                 (y & ~0xFF) = 0111 0110 0101 0100 0011 0010 0000 0000
    ------------------------------------------------------------------
    (x & 0xFF) | (y & ~0xFF) = 0111 0110 0101 0100 0011 0010 1110 1111
    Which in hex is------------7----6----5----4----3----2----E----F 
```

花一些时间来熟悉这些操作，你应该不会有任何麻烦。此外，请务必学习其他按位运算符（<<、>>、&=、|= 等）

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-09-11T23:07:23.793

你试过这个吗？

```
inline uint32_t combine(uint32_t x, uint32_t y) {
  return (y & 0xffffff00) | (x & 0xff);
} 
```

这是一个示例（请参见[此处](http://ideone.com/YL0PR)的结果）。

```
#include <inttypes.h>
#include <stdio.h>

inline uint32_t combine(uint32_t x, uint32_t y) {
  return (y & 0xffffff00) | (x & 0xff);
}

main() {
  printf("%" PRIx32 "\n", combine(0x89abcdef, 0x76543210));
} 
```

# extjs4 - 如何在 extjs 4 中使用带有 3 个决策的 actioncolumn 显示基于 iconCls 的图标？

> ID：12379110
> 
> 赞同：1
> 
> 时间：2012-09-11T23:01:56.263
> 
> 标签：extjs4

我试图根据值显示一个图标，如果值为 0，则它不会显示任何图标，当为 1 或大于 0 时，它将显示一个带有支持单击事件的处理程序的图标，该事件将显示另一个图标，该图标不是图像，而是在 actioncolumn 中使用 iconCls 参数的样式正方形。所以我现在的主要问题是，如果值为 0，我不能让 actioncolumn 停止显示图标，它只会显示两个正方形，并且完全一团糟。我使用渲染器尝试了不同的方法，但结果仍然很奇怪。所以这是我到目前为止的代码。此练习与此处相同，但有一个额外的决定。 [http://www.learnsomethings.com/2011/09/25/the-new-extjs4-xtype-actioncolumn-in-a-nutshell/](http://www.learnsomethings.com/2011/09/25/the-new-extjs4-xtype-actioncolumn-in-a-nutshell/)

```
 `this.columns = [
            {header: 'Estado', dataIndex:'icon', renderer:this.renderIcon, width:35},
            {
                    header:'Geo',
                    width:35,
                    xtype:'actioncolumn',
                    items: [{
                            iconCls:'showGeofence',
                            tooltip:'Geocerca Visible.',
                            handler: function(grid, rowIndex, colIndex) {
                                var rec = grid.getStore().getAt(rowIndex);
                                grid.getStore().getAt(rowIndex).set('geo', 0);
                                grid.getSelectionModel().select(rowIndex);
                            },
                            getClass: function(value,metadata,record){
                                var closed = record.get('geo');
                                    if (closed == 0) {
                                        return 'x-hide-display';
                                    } else {
                                        return 'x-grid-center-icon';
                                    }
                            }
                    },{
                            iconCls:'hideGeofence',
                            tooltip:'Geocerca no Visible.',
                            handler: function(grid, rowIndex, colIndex) {
                                var rec = grid.getStore().getAt(rowIndex);
                                grid.getStore().getAt(rowIndex).set('geo', 1);
                                grid.getSelectionModel().select(rowIndex);
                            },
                            getClass: function(value,metadata,record){
                                var closed = record.get('geo');
                                    if (closed == 1) {
                                        return 'x-hide-display';
                                    } else {
                                        return 'x-grid-center-icon';
                                    }

                            }
                    },{
                            iconCls:'noGeofence',
                            tooltip:'Geocerca no Configurada.',
                            getClass: function(value,metadata,record){
                                var closed = record.get('geo');
                                if(closed !== undefined && typeof(closed)==number){
                                    return 'x-hide-display';
                                }else{
                                    return 'x-grid-center-icon';
                                }
                            }
                    }]
            },
            {header: 'Descripcion', dataIndex:'descripcion',flex:1},
            {header: 'id', dataIndex:'id', hidden:true}
        ];` 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-12T13:24:59.820

基于 3 个决定，我做出了这个糟糕的解决方法，它有效，但老实说太可怕了......诀窍就是使用处理程序在点击行为后设置的值。所以基于这个事实，我这样做了。我希望这可能对未来的任何人有所帮助，或者它可以作为后代可怕编程的一个例子。干杯。

```
 `this.columns = [
            {header: 'Estado', dataIndex:'icon', renderer:this.renderIcon, width:35},
            {
                header:'Geo',
                width:35,
                xtype:'actioncolumn',
                items: [{
                    iconCls:'hideGeofence',
                    tooltip:'Geocerca Visible.',
                    action:'hidegeofence',
                    handler: function(grid, rowIndex, colIndex) {
                        var rec = grid.getStore().getAt(rowIndex);
                        Ext.example.msg("Informacion","Mostrando Geocerca.");
                        grid.getStore().getAt(rowIndex).set('id_geocerca','a');
                        grid.getSelectionModel().select(rowIndex);
                    },
                    getClass: function(value,metadata,record){
                        var closed = record.get('id_geocerca');
                            if(closed>0){
                                return 'x-grid-center-icon';
                            }else{
                                return 'x-hide-display';
                            }
                    }
                },{
                    iconCls:'showGeofence',
                    tooltip:'Geocerca Visible.',
                    handler: function(grid, rowIndex, colIndex) {
                        var rec = grid.getStore().getAt(rowIndex);
                        Ext.example.msg("Informacion","Ocultando Geocerca.");
                        grid.getStore().getAt(rowIndex).set('id_geocerca',1);
                        grid.getSelectionModel().select(rowIndex);
                    },
                    getClass: function(value,metadata,record){
                        var closed = record.get('id_geocerca');
                            if(closed=='a'){
                                return 'x-grid-center-icon';
                            }
                            if(closed>0 || closed==0){
                                return 'x-hide-display';
                            }
                    }
                }]
            },
            {header: 'Descripcion', dataIndex:'descripcion',flex:1},
            {header: 'id', dataIndex:'id', hidden:true}
        ];` 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-11-18T20:11:34.743

当您还使用 getClass 指定图标时，在单击时不会调用 actioncolumn 处理函数。我在 CSS 中声明了一个空图标。.x-action-col-icon{ 宽度：30px; 垂直对齐：底部；}

.../ 为 x-grid-center-icon 和 x-hide-display 添加剩余的 css

在 actioncolumn 定义中添加图标：''，

# mysql - 如何从 CloudBees Jenkins 访问 MySQL？

> ID：12379113
> 
> 赞同：1
> 
> 时间：2012-09-11T23:02:30.177
> 
> 标签：mysql, jenkins, cloudbees

在 Jenkins CloudBees 中运行时，我无法弄清楚如何访问 MySQL 数据库。我试过关注[Dev@Cloud MySQL](http://wiki.cloudbees.com/bin/view/DEV/MySQL)，但是控制台输出中有很多警告，我必须处理 localhost 访问与套接字，这在没有命令行的情况下调试非常棘手。

有没有办法使用 CloudBees MySQL 托管？当我尝试使用 cloudbees JDBC 驱动程序时，我收到 ClassNotFound 错误消息。

**更新**：下面的答案澄清了我不能使用 CloudBees 驱动程序，所以我现在通过 c3p0 连接池使用常规 MySQL 连接器。根据下面的评论，我将池中的连接数限制为 10。

当我从我的开发计算机运行它并连接到 Cloudbees Mysql 实例时，完全相同的配置和 Maven 命令行可以工作。

不幸的是，尝试连接时出现此错误：

```
Caused by: com.googlecode.flyway.core.exception.FlywayException: Unable to obtain Jdbc connection from DataSource
    at com.googlecode.flyway.core.util.jdbc.JdbcUtils.openConnection(JdbcUtils.java:56)
    at com.googlecode.flyway.core.Flyway.execute(Flyway.java:864)
    at com.googlecode.flyway.core.Flyway.migrate(Flyway.java:591)
    at com.assuredlabor.db.DatabaseMigrator.migrate(DatabaseMigrator.java:13)
    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
    at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)
    at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)
    at java.lang.reflect.Method.invoke(Method.java:597)
    at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.invokeCustomInitMethod(AbstractAutowireCapableBeanFactory.java:1414)
    at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.invokeInitMethods(AbstractAutowireCapableBeanFactory.java:1375)
    at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.initializeBean(AbstractAutowireCapableBeanFactory.java:1335)
    ... 62 more
Caused by: java.sql.SQLException: Connections could not be acquired from the underlying database!
    at com.mchange.v2.sql.SqlUtils.toSQLException(SqlUtils.java:106)
    at com.mchange.v2.c3p0.impl.C3P0PooledConnectionPool.checkoutPooledConnection(C3P0PooledConnectionPool.java:529)
    at com.mchange.v2.c3p0.impl.AbstractPoolBackedDataSource.getConnection(AbstractPoolBackedDataSource.java:128)
    at com.googlecode.flyway.core.util.jdbc.JdbcUtils.openConnection(JdbcUtils.java:50)
    ... 72 more
Caused by: com.mchange.v2.resourcepool.CannotAcquireResourceException: A ResourcePool could not acquire a resource from its primary factory or source.
    at com.mchange.v2.resourcepool.BasicResourcePool.awaitAvailable(BasicResourcePool.java:1319)
    at com.mchange.v2.resourcepool.BasicResourcePool.prelimCheckoutResource(BasicResourcePool.java:557)
    at com.mchange.v2.resourcepool.BasicResourcePool.checkoutResource(BasicResourcePool.java:477)
    at com.mchange.v2.c3p0.impl.C3P0PooledConnectionPool.checkoutPooledConnection(C3P0PooledConnectionPool.java:525)
    ... 74 more 
```

任何想法，将不胜感激。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-12T10:10:54.637

您不能从 RUN@Cloud 容器外部使用 CloudBees JDBC 驱动程序，但您可以使用标准 MySQL JDBC 驱动程序和您的 RUN 数据库，使用您可以在 RUN@Cloud Web 控制台上为您的数据库资源找到的主机名和端口。

# node.js - 我在哪里可以找到 jsdom 文档？

> ID：12379116
> 
> 赞同：9
> 
> 时间：2012-09-11T23:02:43.673
> 
> 标签：node.js, jsdom

我正在寻找关于 jsdom 的文档，它比[https://github.com/tmpvar/jsdom](https://github.com/tmpvar/jsdom)上的自述文件更具描述性。

具体来说，我正在寻找有关如何解释由 jsdom 创建的 DOM 节点的 nodeType 属性的说明。据我所知，该属性存储一个没有内在含义的整数。在直接的例子中，我确信我可以做一些测试来发现什么整数映射到什么 DOM 节点类型，但是编写自定义测试和自省代码需要很长时间才能解决这些对象。我使用该文档的其他问题是关于如何直接访问节点的父节点、遍历子节点、访问文本数据等（所有这些都是通过直接在任何 jquery 特定函数之外访问对象属性）。

我在哪里可以找到关于 DOM 节点属性的 jsdom 文档？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-11T23:07:35.400

虽然不是特定于 jsdom，但[http://www.w3schools.com/dom/dom_nodetype.asp](http://www.w3schools.com/dom/dom_nodetype.asp)上的 NodeTypes - Named Constants 表似乎与我看到的 nodeType 值有关。

# javascript - 定义js文件后如何为外部javascript文件设置变量？

> ID：12379121
> 
> 赞同：-1
> 
> 时间：2012-09-11T23:03:35.187
> 
> 标签：javascript, jquery

我正在使用 jQuery Mobile Ajax 导航功能，并且我需要更改在外部 js 文件中定义的变量，所以我**不能**在加载该 js 文件**之前**放置我的定义......

那么，如何在定义 js 文件后更改外部 javascript 文件的变量值？

（该外部 js 文件包含事件）

* * *

*所以这个问题**不是**[那个问题](https://stackoverflow.com/q/2357472/942659)的重复。*

* * *

## 更新

我的 JS 文件包含事件，如下所示：`$(document).on('mousemove','#main',function() { /*something*/} );`

我需要那个变量。是否可以将变量传递给它？

我试过简单地改变那个变量`i = 5;`，但我得到了未定义的错误。

* * *

## 更新 2

外部js文件对于一些页面来说是几乎一样的东西，只是有点不同，就一两个参数而已。

我只是想将参数传递给那个 JS 文件。是否可以？如何？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-11T23:13:20.887

假设定义了您想要更改的`http://www.example.com/external.js`变量。`foo`

```
<script src="http://www.example.com/external.js"></script>
<script type="text/javascript">
    foo = "my new value";
</script> 
```

这假定 external.js 定义`foo`在全局范围内。如果它是在匿名函数或类似函数中定义的，您将无法更改该值。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-11T23:07:42.457

根据您的操作，您只需设置变量即可。例子：

```
// JS file
blah = "Hello";
function doSomething() {
    alert(blah);
}

// HTML file
blah = "I'm a fish";
doSomething(); // alerts "I'm a fish"; 
```

或者，将变量作为参数传递给相关函数，而不是使用全局变量。

# debugging - 调试 PostScript

> ID：12379122
> 
> 赞同：13
> 
> 时间：2012-09-11T23:03:43.953
> 
> 标签：debugging, postscript

如何在 PostScript 中进行调试？我可以在 Linux 上使用 GhostView/GhostScript，但无法查看堆栈、字典等。

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2012-09-15T06:19:32.497

# 最小调试器

我刚刚发现了一个非常有用的技巧。

```
<<
/break{ /hook /pause load store }
/cont{ /hook {} store }
/doprompt{
    (\nbreak>)print
    flush(%lineedit)(r)file
    cvx {exec}stopped pop }
/pause{ doprompt }
/hook{}
>> begin 
```

这是一个 8 行*EMBEDDABLE*调试器。我为我的[8086 模拟器](https://codegolf.stackexchange.com/a/9065/2381)做了这个。放入`hook`主循环，放入`break`一个程序以在下一个钩子处触发暂停（我将它放在可疑的 OPCODE procs 中，钩子是中断发挥其第一个作用的地方）。挂机呼叫暂停和暂停呼叫`doprompt`，为您提供单行“中断>”提示。在此处键入`cont`将清除钩子并继续旋转，`break`在遇到另一个暂停之前不会执行任何暂停。您还可以在提示符下检查值并执行代码，但是当您按 Enter 时， **nb**`doprompt`执行会恢复，因此如果您需要其他行，请调用或`pause`在行尾。执行命令时会忽略错误（您不希望调试器使程序崩溃，那太愚蠢了！）。*我想我可以结合 pause 和 doprompt 并删除一个名字；但这里的目标不是机器效率，而是清晰的概念集合：这段代码要在调试其他代码时完全有用，需要易于扫描和验证。*

*这是一个调试器，它只是读取一行？！*

记住你已经得到`=`并`==`调查价值观。`forall`并`get`破坏数组和东西。要真正*找出你在哪里*，请做`countexecstack array execstack ==`一个可读的整个 caboodle 的转储。也就是说，执行堆栈中当前位置的回溯，其中包含所有部分执行的过程的尾部和等待当前帧返回时恢复的文件。

* * *

# “打印”

有相当多的调试可以在没有调试器的情况下完成，仅仅通过检测你的程序（添加`printf`s，可以这么说）。

刚才我遇到了一个错误，我的调试器无法帮助我，因为调试器本身在一些过于聪明的东西上崩溃了，比如

```
/E [ 0 0 10 ] def %eye point
/crackE { % set pointers into E
    /ex E 0 1 getinterval cvx def
    /ey E 1 1 getinterval cvx def
    /ez E 2 1 getinterval cvx def
} def crackE 
```

所以我正在调查的实际错误是

```
GPL Ghostscript 8.62 (2008-02-29)
Copyright (C) 2008 Artifex Software, Inc.  All rights reserved.
This software comes with NO WARRANTY: see the file PUBLIC for details.
Error: /stackunderflow in --forall--
Operand stack:
   --nostringval--
Execution stack:
   %interp_exit   .runexec2   --nostringval--   --nostringval--   --nostringval--   2   %stopped_push   --nostringval--   --nostringval--   --nostringval--   false   1   %stopped_push   1905   1   3   %oparray_pop   1904   1   3   %oparray_pop   1888   1   3   %oparray_pop   1771   1   3   %oparray_pop   --nostringval--   %errorexec_pop   .runexec2   --nostringval--   --nostringval--   --nostringval--   2   %stopped_push   --nostringval--   --nostringval--   --nostringval--   0.238095   0.047619   0.952381   --nostringval--   %for_real_continue   68.5714   17.1429   360.048   --nostringval--   %for_real_continue   --nostringval--
Dictionary stack:
   --dict:1151/1684(ro)(G)--   --dict:0/20(G)--   --dict:121/200(L)--   --dict:13/20(L)--   --dict:1/2(L)--
Current allocation mode is local
Last OS error: 2
Current file position is 3241
GPL Ghostscript 8.62: Unrecoverable error, exit code 1 
```

我真正需要知道的是`--nostringval--`操作数堆栈上的那个东西到底是什么。

所以我把它放在程序的开头

```
/forall { pstack()= forall } bind def 
```

然后再次运行它

```
{MO matmul 0 --get-- --aload-- --pop-- proj 操作}

错误：/stackunderflow 在 --forall--
操作数栈：
   --nostringval--
...

```

就在错误之前是最终的堆栈转储（使用`==`），它告诉我我有一个过程主体缺少其数据集。

`pstack`与这样的东西相比有点生硬

```
/args { dup 1 add copy -1 1 { -1 roll ==only ( ) print } for } def
/forall { 2 args (forall)= forall } bind def 
```

这对于在明显有效的代码中追踪错误数据更有用。这也是非常早期版本的 Distiller 生成优化的 .ps 文件的方式，它只定义了要转储自己的绘图操作，其余的计算被“蒸馏”出来。

一些技巧

```
()= %print a newline
=string %built-in 128-byte buffer used by = and ==
/object =string cvs print %convert object to string and print without newline
/stack { count dup 1 add copy { = } repeat pop } def % this is the code for the stack operator
66 (#) dup 0 3 index put print %m non-destructively print a "char" 
```

[我之前在这里写了'='而不是'stack'。一个*严重的*错误。*编辑：添加`pop`到`/stack`.* ]

* * *

# errordict 黑客

调查错误的另一种方法是更改​​错误处理程序。要调查上述`/stackunderflow`错误，我可以使用

```
errordict/stackunderflow{dup == /stackunderflow signalerror}put 
```

而不是专门化`forall`。要了解后记这个相当神秘的方面，请继续阅读`errordict` `stop`和`stopped`。并以交互方式查看`errordict{exch =only ==}forall`. `signalerror`在 Adob​​e 解释器中调用了 ghostscript `.error`。它的工作是拍摄堆栈的快照，然后调用`stop`以弹出 exec 堆栈。所以`dup ==`这里和`pstack`上面基本上是相同的错误“时刻”，在`stop`. 您的交互式会话（以及前面在 gs 的正常模式下的程序）在 exec 堆栈上的括号更深，相当于`//your-program stopped { handleerror } if`. 它`handleerror`使用快照（在程序被清除后）打印错误报告及其无信息的堆栈打印输出。

`handleerror`您可以`(ehandle.ps)run`在错误程序开始时找到替代品，以生成不同样式的错误报告。

# 检查 $error

我只是在这里重新阅读我的示例时发现了这一点。如果解释器仍在给您提示，您还可以在错误后调查堆栈。错误信息保存在`$error`字典中，包括堆栈的快照。

```
GS>[ 1 2 3 ] [4 5 6] bogus
Error: /undefined in bogus
Operand stack:
   --nostringval--   --nostringval--
Execution stack:
   %interp_exit   .runexec2   --nostringval--   --nostringval--   --nostringval--   2   %stopped_push   --nostringval--   --nostringval--   %loop_continue   --nostringval--   --nostringval--   false   1   %stopped_push   .runexec2   --nostringval--   --nostringval--   --nostringval--   2   %stopped_push   --nostringval--
Dictionary stack:
   --dict:1168/1684(ro)(G)--   --dict:0/20(G)--   --dict:77/200(L)--
Current allocation mode is local
Current file position is 24
GS<2>

GS<2>$error{pop ==}forall
/dstack
/recordstacks
/globalmode
/newerror
/.nosetlocal
/estack
/errorinfo
/.inerror
/SubstituteFont
/position
/binary
/ostack
/command
/errorname
GS<2>$error/ostack get ==
[[1 2 3] [4 5 6]]
GS<2> 
```

当然，这里的对象仍然在堆栈上。但是`$error`有没有可以偷看的。不要尝试这个：`$error ===`。TMI。

您可以从中获得的一个非常有用的信息`$error`是漂亮的打印`/estack`，即错误点处的执行堆栈的副本。

```
PS<3>$error /estack get ==
[ --quit--{ pop --quit--} false { quitflag false --def---dict- /
execdepth 2 --copy----get--1 --sub----put----end---dict- /doclose false 
--put--interrupt } --loop----cvx--[ /quitflag false --def---dict- /
newerror false --put--/prompt --load----stopped--{ (
Error during prompt execution
)--print--handleerror --exit--} --if--{ 
mark /stmtfile (%statementedit)(r)--file----def--} --stopped--{ --
cleartomark---dict- /newerror --get--{ -dict- /errorname --get--/
undefinedfilename --ne--{ handleerror } --if---dict- /newerror false --
put----exit--} --if--} { --pop--stmtfile --end--{ --cvx----exec--} --
stopped---dict- --begin--{ handleerror stmtfile --closefile--} --if--} 
--ifelse--checkquit ] { checkquit } { -dict- --begin--{ handleerror 
stmtfile --closefile--} --if--} false -file- -file- -file- --repeat----
cvx--[ randcurve randwidth randcolor stroke ] 1 { flushpage newpath } { 
newpath } --forall----cvx--[ dup length 2 gt { [ currentcolordict DEVICE
 /nativecolorspace get get exec counttomark 2 add -1 roll DEVICE dup /
FillPoly get exec pop pstack ()= flushpage } { pop } ifelse ] [ ] { pop 
pstack ()= flushpage } { x_max width 0.50 add def (
intersect polygon edges with scanlines)= /P poly poly length 1 sub get 
def [ poly { Q exch def x_max miny floor cvi 0.50 add 1 maxy ceiling cvi
 0.50 sub { 1 index exch -0.50 1 index 4 2 roll P aload pop Q aload pop 
.intersect { 2 array astore exch } if } for pop /P Q def } forall ] (
sort scanline intersection list)= dup { 1 index 1 get 1 index 1 get eq 
{ exch 0 get exch 0 get lt } { exch 1 get exch 1 get lt } ifelse } qsort
 (set pixels on each scanline)= aload length 2 idiv { exch aload pop 3 2
 roll aload pop /USEDRAWLINE where { pop r g b 7 3 roll currentdict 
DrawLine } { pop 3 2 roll exch 1 exch dup width ge { pop width 1 sub } 
if { r g b 4 3 roll 2 index currentdict PutPix } for pop } ifelse } 
repeat end } --forall----cvx--[ aload pop .maxmin ] [ [ 16 154 ] [ 16 
154 ] ] { pop .maxmin } ] 
PS<3> 
```

现在大部分内容可能都是胡言乱语，前几部分甚至可能无法阅读。此输出来自我自己的 postscript 解释器，该解释器正在建设中，所有对象都具有完全访问权限。但不要看顶部。看看底部。数组的最后一个元素是堆栈的最顶部元素。这是接下来会出现的一段代码并`/command`没有完成`/errorname`。那个小后记片段可以帮助您找到问题的根源所在。在我上面的例子中，我需要在我的源中搜索`.maxmin`前面的调用，前面`pop`是 .. 无论错误是什么。

# 打电话`executive`得到提示

如果您与打印机中的解释器进行串行或远程登录会话，则可以键入`executive`并按回车几次。`executive`它可能不会在您键入时回显字母。不要害怕，但拼写正确。它应该给你一个问候和一个提示。

使用 ghostscript，不带参数运行程序将为您提供相同类型的执行会话。然后你可以`(yourfile)run`并且你应该在错误之后仍然得到一个提示，允许你检查 $error 如上所述。

如果这不起作用，您可以尝试运行`executive` *两次*。这增加了额外的错误处理级别（另一个`stopped {handlerror} if`在 exec 堆栈上）。这可能有助于寻找更奇怪的错误。

# 逐步调试器

我有一个[源级逐步调试器](https://github.com/luser-dr00g/debug.ps)，它应该在任何符合 2 级的 PostScript 解释器中运行。

它还可用于生成堆栈跟踪，如[TeX.SE 上的此答案](https://tex.stackexchange.com/a/160503/21041)所示。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-09-14T11:20:38.263

Emacs 包括 PostScript 工具。它包括用于将您当前选择的文本发送到 postscript 解释器的工具，您还可以将命令直接输入到同一个解释器中，例如查询操作数堆栈或类似的事情。

不过，这可能不是您想要的，因为它可能比您愿意使用的更难使用。但是，正确设置，为您想要监控的所有事情、脚本和宏做事情等使用不同的缓冲区，它会做您想做的一切。我不确定，但网络上其他地方可能有一些东西可以帮助你设置它。

**编辑：**我使用 Emacs 调试 postscript 的主要方法是执行以下操作：我可以将程序的段从文件缓冲区复制粘贴到解释器缓冲区中，作为单步执行我的程序的一种方式。我还可以使用它来告诉我有关操作数堆栈的信息，使用命令打印出它的内容等。我还可以将调试语句添加到`dup ==`将输出到解释器缓冲区的代码（如等）中，因为我有点无法弄清楚如何在`stdout`使用其他环境执行程序时查看。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-12-15T06:42:29.233

在 OS X 10.7.5 上，预览在爆炸时没有给我任何细节，但`/usr/bin/pstopdf`确实给了我一个到标准输出的堆栈转储，这`pstack`也是。

如果我在预览中打开 pdf 文件，则在运行后更改回预览`pstopdf`将刷新新创建的 pdf 文件的视图。

它不是高科技，但您可以快速迭代。

# r - 关于比较的 R switch 语句

> ID：12379128
> 
> 赞同：16
> 
> 时间：2012-09-11T23:04:26.010
> 
> 标签：r, if-statement, switch-statement

我正在尝试编写一个 R 脚本来根据在范围内拟合值来评估不同的表达式。这个想法是，如果 Length 在一个范围内，它将以一种方式进行评估，如果它在一个较长的范围内，它将以不同的方式进行评估。

我可以使用 if/else 语句来完成这项工作，但它非常难看，而且我相信一定有更好的方法......这是有效的代码。

```
Length=8.2

if (Length<1) 
    mode="Walk"
else if (1<=Length & Length <5)
    mode="bike" 
else if (5<=Length & Length <10)
    mode="drive"
else if (Length>=10)
    mode="fly" 
```

我一直在尝试用 switch 函数做一些事情，但它似乎只适用于文本或整数......有没有办法让 switch 语句在每种情况下进行评估，比如这样？

```
Length=3.5

switch(Length,
       (Length<1)  mode="Walk"
       (1<=Length & Length <5)  mode="bike"
       (5<=Length & Length <10)  mode="drive"
       (Length=>10)  mode="fly"
) 
```

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2012-09-11T23:21:48.443

这是与 Josh 类似的答案，但使用的是`findInterval`：

```
Length <- 0:11

cuts <- c(-Inf, 1, 5, 10, Inf)
labs <- c("Walk", "bike", "drive", "fly")

labs[findInterval(Length, cuts)]
# [1] "Walk"  "bike"  "bike"  "bike"  "bike"  "drive" "drive"
# [8] "drive" "drive" "drive" "fly"   "fly" 
```

您还可以使用嵌套`ifelse`语句，这是一个口味问题：

```
ifelse(Length < 1,  "Walk",
ifelse(Length < 5,  "bike",
ifelse(Length < 10, "drive",
                    "fly")))
# [1] "Walk"  "bike"  "bike"  "bike"  "bike"  "drive" "drive"
# [8] "drive" "drive" "drive" "fly"   "fly" 
```

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2017-07-10T11:02:55.580

使用 dplyr 的`case_when`声明：

```
library(dplyr)
Length <- 3.5
mode <- case_when(
                Length < 1 ~ "Walk",
                1 <= Length & Length < 5 ~ "bike",
                5 <= Length & Length < 10 ~ "drive",
                Length >= 10 ~ "fly"
          )
mode
#> [1] "bike" 
```

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2012-09-11T23:09:34.507

会`cut()`做你需要的吗？

```
Length <- 0:11

cuts <- c(-Inf, 1, 5, 10, Inf)
labs <- c("Walk", "bike", "drive", "fly")

as.character(cut(Length, breaks = cuts, labels = labs, include.lowest=TRUE))
#  [1] "Walk"  "Walk"  "bike"  "bike"  "bike"  "bike"  "drive" "drive" "drive"
# [10] "drive" "drive" "fly" 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2018-08-29T22:19:45.827

剪切和切换：使用 cut() 中的因子级别并传递给 switch() 以返回适当的代码。

```
 transport <- function(dist) {
   stopifnot(is.numeric(dist))
   x <- as.numeric(cut(dist, c(-Inf,0,1,5,10,Inf)), right = TRUE)
   switch (x,
           "No distance",
           "Walk",
           "Bike",
           "Drive",
           "Fly",
           stop("Not sure")
   )
 } 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2018-12-20T02:52:37.827

对于手头的示例，这个答案可能有点过头了，但它非常灵活——你可以在里面做任何事情`evaluate_like_this()`。

```
evaluate_one <- function(x) {
  switch(
    x,
    evaluate_like_this(x, "Walk"),
    evaluate_like_this(x, "No distance"),
    evaluate_like_this(x, "Bike"),
    evaluate_like_this(x, "Drive"),
    evaluate_like_this(x, "Fly")
  )
}

evaluate_like_this <- function(x, y) {
  paste0(x, ": ", y)
}

these_data <- 0:11
intervals <- cut(these_data, breaks = c(-Inf, 1, 5, 10, Inf), label = FALSE)
unlist(lapply(intervals, evaluate_one))
#>  [1] "1: Walk"        "1: Walk"        "2: No distance" "2: No distance"
#>  [5] "2: No distance" "2: No distance" "3: Bike"        "3: Bike"       
#>  [9] "3: Bike"        "3: Bike"        "3: Bike"        "4: Drive" 
```

^(由[reprex 包](https://reprex.tidyverse.org)（v0.2.1）于 2018 年 12 月 19 日创建)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2021-10-23T04:11:54.900

```
length <- 3.5
cuts <- c( 1, 5, 10, Inf )
labs <- c( "Walk", "bike", "drive", "fly" )
x <- which( cuts > length )[1]
switch(x,{labs[1]},{labs[2]},{labs[3]},{labs[4]}) 
```

# javascript - 在 Internet Explorer 中，当父级的兄弟姐妹被隐藏时，子元素不会在页面上移动

> ID：12379133
> 
> 赞同：1
> 
> 时间：2012-09-11T23:05:03.453
> 
> 标签：javascript, jquery, css

我正在创建一个支持 jQuery 的网页，其中包含指向外部站点的图像链接，用作浏览器主页。每组相关链接（开发、社交等）都包含在一个文件夹中，可以通过单击其标题来展开或折叠该文件夹。这在 Firefox、Chrome 和 Safari 中运行良好。

![工作网页截图](../Images/102f264dfc95659e76e96dc8bf5a9781.png)

在 Internet Explorer 中（惊喜！）我得到了这种奇怪的行为。假设有三个垂直堆叠的文件夹。如果我折叠第一个文件夹，则第二个和第三个文件夹及其内容会向上移动以填充空间，但第二个文件夹的内容*除外*，它们在页面上保持相同的绝对位置。

我已经创建了页面的精简版本，显示问题所需的最低限度。在这里，我有名为“Red”、“Green”和“Blue”的文件夹，每个文件夹都包含一个图像。

![示例页面截图](../Images/cc04abe72bc4a6cc07f16c03f751a7ff.png)

如果我单击红色标题，蓝色图像将随其文件夹向上移动，但绿色图像保持在相同位置，现在位于蓝色图像后面。

![单击读取文件夹标题后示例页面的屏幕截图](../Images/0ea613bd43320cd86678224c03656dee.png)

但是，如果我将文件夹标题和正文元素上的边框样式设置为“无”而不是“实心”，则绿色图像会按预期与其他元素一起移动。

网页文件夹.html：

```
<html>
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
    <script type='text/javascript' src='jquery-1.7.2.min.js'></script>
    <script type='text/javascript' src='folder.js'></script>
    <link rel='stylesheet' type='text/css' href='style.css'></link>
    <title>Folder Example</title>
  </head>
</html> 
```

样式表 style.css：

```
div.folder-header
{
  background-color:#f0f0f0;
  border-color:#e0e0e0;
  border-width:1px;
  cursor:pointer;
}

div.folder-body
{
  background-color:#f8f8f8;
  border-color:#e0e0e0;
  border-width:1px;
}

div.link-viewport
{
  position:relative;
}

img.link-image
{
  position:absolute;
  display:block;
  border:none;
} 
```

JavaScript 文件 layout.js：

```
$(document).ready(function()
{
    var border = true;

    var folder = function(title, src)
    {
        var section = $('<div>').appendTo('body');
        var header = $('<div>').addClass('folder-header').text(title).appendTo(section);
        var folder = $('<div>').addClass('folder-body').appendTo(section);
        var viewport = $('<div>').addClass('link-viewport').css('width', 64).css('height', 64).appendTo(folder);
        var image = $('<img>').addClass('link-image').attr('src', src).appendTo(viewport);

        header.css('border-style', border ? 'solid' : 'none');
        folder.css('border-style', border ? 'solid' : 'none');

        header.click(function()
        {
            folder.toggle();
        });
    };

    folder("Red", "red.png");
    folder("Green", "green.png");
    folder("Blue", "blue.png");
}); 
```

图像文件 red.png、green.png 和 blue.png：

![图像文件 1](../Images/7d2e3ca5ba6da1219a9da32e6af89577.png)

![图像文件 2](../Images/987c0507149a6547272fcd17aa3446a6.png)

![图像文件 3](../Images/f57ff11197b1923c0cc9819b8c052ffb.png)

任何建议都感激不尽！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-12T17:01:40.513

手风琴似乎在 IE8+ 中工作，但我能够在使用 IE7 模式的 IE9 中看到问题（按 F12 打开 IE 开发工具 -> 浏览器模式 =“IE7”，文档模式 =“IE7 标准”）。我通过进行以下更改使其工作：

**CSS**：添加`overflow: hidden;`到规则集中`div.folder-body`。

**JS**`folder.toggle();` ：在第 18 行删除并插入

```
if (folder.height()) { 
    folder.hide(); 
    folder.height(0); }
else { 
    folder.show(); 
    folder.height(64); 
} 
```

不过我不明白为什么！

这是小提琴：http: [//jsfiddle.net/EhPk8/25/](http://jsfiddle.net/EhPk8/25/)

# html - 为什么图像不居中？

> ID：12379140
> 
> 赞同：1
> 
> 时间：2012-09-11T23:07:02.050
> 
> 标签：html, css, positioning, image

```
<div id="tagcontainer"><img id="tagimg" src="img/tri.png"/></div> 
```

CSS：

```
#tagcontainer {
    width:100%;
    top:0;
    position:absolute;
}
    #tagimg {
        position:relative;
        margin:auto;
    } 
```

不知道为什么我无法弄清楚。为什么这张图片没有居中？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-11T23:09:15.820

因为`<img>`是内联元素。改为在容器上使用`text-align: center`。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-11T23:07:56.337

要么使#tagimg 成为块级元素 { display: inline-block; 或在父级上使用文本对齐中心...

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-11T23:11:23.837

试试这个：

```
#tagcontainer {
width:100%;
position:absolute;
}
#tagimg {
width:[imagewidth]px;
top:0;
position:relative;
margin:auto;
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-11T23:15:15.337

再添加一个 css 属性`display:block;`

```
 #tagimg {
        display:block;
        position:relative;
        margin:auto;
    } 
```

# php - 获取 2-3 组大括号之间的文本的好方法

> ID：12379144
> 
> 赞同：3
> 
> 时间：2012-09-11T23:07:20.690
> 
> 标签：php, string, random, formatting

我正在使用一个返回以下格式文本的 API：

> > {我想要|我需要}制作这个{愚蠢|真棒|刺激}句子{格式化{快速|快速}和随机|旋转和随机}

使用 PHP，我需要像这样格式化字符串：

```
"I need to make this irritating sentence formatting quickly"; 
```

或者

```
"I want to make this awesome sentence spin and be random"; 
```

从最初的文本。

如果大括号不能包含另一组大括号，我不会有问题。有什么建议或任何代码可以帮助我解决这个问题吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-11T23:17:31.597

我假设你的源字符串是这样的：

```
{I want|I need} to make this {stupid|awesome|irritating}
sentence formatting {rapidly|quickly} and {random|spin and be random} 
```

否则括号是嵌套的，并且您的输出示例与您将它们放在源字符串中的方式不匹配。然后`preg_match_all()`像这样使用：

```
preg_match_all("/{.*}/U",$sourceString, $result, 
                      PREG_PATTERN_ORDER|PREG_OFFSET_CAPTURE); 
```

这对你`$sourceString`来说会产生：

```
array(1) {
  [0]=>
  array(4) {
    [0]=>
    array(2) {
      [0]=>
      string(15) "{I want|I need}"
      [1]=>
      int(0)
    }
    [1]=>
    array(2) {
      [0]=>
      string(27) "{stupid|awesome|irritating}"
      [1]=>
      int(29)
    }
    [2]=>
    array(2) {
      [0]=>
      string(17) "{rapidly|quickly}"
      [1]=>
      int(77)
    }
    [3]=>
    array(2) {
      [0]=>
      string(27) "{random|spin and be random}"
      [1]=>
      int(99)
    }
  }
} 
```

你得到所有的物品。然后你可以处理每个条目，去掉“{”和“}”，`explode()`在“|”上 获得一系列可供选择的选项。然后你选择你想要的并用它替换以前找到的项目。请注意，我捕获了找到匹配模式的偏移量，因为您最终不能这样做，`str_replace()`因为我假设您希望能够在许多地方使用相同的条目（即“{this|that} foo {this|that}” `str_replace()`。替换两者，而我认为这是不需要的。所以我们在字符串中得到了偏移量，可以轻松计算字符串的长度，但这足以进行一些手术，并切断我们的条目并进行替换。其他更清洁的方法是使用[preg_replace_callback()](http://php.net/preg_replace_callback)并把所有的“逻辑”

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-11T23:25:30.903

这可能不是几行代码就能完成的。因为你有嵌套代码，你甚至不能使用正则表达式来正确解析输入。

我的一个简单想法是将输入转换为 XML 并使用 SimpleXML 类来解析输入并在此基础上构建一个可以轻松转换为您想要的输出的 AST。

一个简单的例子

```
$xml = "<root>" .
        str_replace(
                array("{", "}"),
                array("<t>", "</t>"),
                $input) . 
        "</root>";

$dom = new SimpleXMLElement($xml);
//... 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-12T00:08:55.987

好的，这基于您提供的句子，但我会在投入生产之前对其进行更多测试。（例如，您不能有任何其他`{`,`}`或`|`）

[http://codepad.viper-7.com/HpJKOt](http://codepad.viper-7.com/HpJKOt)

```
<?php

$string = "{I want|I need} to make this {stupid|awesome|irritating} sentence {formatting {rapidly|quickly} and random|spin and be random}";

echo parseString($string);

function parseString($string) {

    // look for {abc|def}
    if (preg_match_all("/\{(([^\{\|\}]*)\|)+([^\{\|\}]*)\}/", $string, $matches, PREG_OFFSET_CAPTURE)) {

        // trim {} and put into array
        $options = explode('|', substr($matches[0][0][0], 1, -1));

        // randomize
        shuffle($options);

        // make the replacement
        $string = str_replace($matches[0][0][0], $options[0], $string);

        // check again
        return parseString($string);
    }

    return $string;
} 
```

# iphone - CoreData - 如何使用 NSPrivateQueueConcurrencyType 使用临时上下文执行 NSFetchRequest？

> ID：12379149
> 
> 赞同：4
> 
> 时间：2012-09-11T23:07:43.307
> 
> 标签：iphone, performance, core-data, nsfetchedresultscontroller, nsmanagedobjectcontext

从 iOS 5 开始，CoreData 引入了自己的`private queue`功能，您可以在其中让一些操作 ( `especially save context`) 在后台运行。

这必须通过`[context performBlock:...]`.

这很容易对`saving the context`. 但是， for怎么样`NSFetchRequest`？我的意思是如果我想获取一些东西并希望在后台获取呢？我不认为 [context performBlock..] 可以做到这一点。

是否还有一种新的方法可以做到这一点？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-12T00:20:47.400

任何涉及`NSManagedObjectContext`of 的东西`NSPrivateQueueConcurrencyType`都应该包装在一个`performBlock`块中。对于您希望将托管对象传递回主队列上下文的后台获取，如下所示：（请注意，这仅用于说明目的）：

```
// assume self.managedObjectContext is a main queue context
NSManagedObjectContext *backgroundContext = [[NSManagedObjectContext alloc] initWithConcurrencyType:NSPrivateQueueConcurrencyType];
[backgroundContext performBlock:^{
    // do your fetch - e.g. executeFetchRequest
    NSManagedObjectID *objID = [someManagedObject objectID];
    [self.managedObjectContext performBlock:^{
        NSManagedObject *mainManagedObject = [self.managedObjectContext objectWithID:objID];
        //  do something now with this managed object in the main context
    }];
}]; 
```

# mysql - 将 MySQL 配置为在公共 IP 上运行

> ID：12379150
> 
> 赞同：1
> 
> 时间：2012-09-11T23:07:52.453
> 
> 标签：mysql, ip, localhost, public

我无法让 MySQL 安装在公共 IP 上。安装在公共服务器上，因此不会阻止公共访问。但是它安装为 localhost，我不知道如何更改它。有谁知道怎么做？

服务器是一台 Windows 2008 机器。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-12T00:14:22.877

只需注释掉

```
bind-address = ... 
```

在您的配置文件中或指定您希望 mysql 服务器侦听的特定网络接口。

并且不要忘记在那之后重新启动mysql。

# css - 我可以只使用 CSS 为引导图标添加颜色吗？

> ID：12379153
> 
> 赞同：162
> 
> 时间：2012-09-11T23:08:28.583
> 
> 标签：css, twitter-bootstrap, sprite, css-sprites

[Twitter 的引导程序使用 Glyphicons 的图标](http://twitter.github.com/bootstrap/base-css.html#icons)。默认情况下它们是“ `available in dark gray and white`”：

![图片-58.png](../Images/519c0e8d5e481bc6d4ae4c2f928410d0.png)

是否可以使用一些 CSS 技巧来更改图标的颜色？我希望有一些其他的 css3 光彩，可以防止必须为每种颜色设置图标图像。

我知道您可以更改封闭 ( `<i>`) 元素的背景颜色，但我说的是图标前景色。我想可以反转图标图像的透明度，然后设置背景颜色。

那么，我可以只使用 CSS 为引导图标添加颜色吗？

* * *

## 回答 #1

> 赞同：190
> 
> 时间：2012-09-11T23:33:50.267

是的，如果您将[Font Awesome](http://fortawesome.github.com/Font-Awesome/)与 Bootstrap 一起使用！图标略有不同，但数量更多，无论大小如何，它们看起来都很棒，而且您可以更改它们的颜色。

基本上，图标是字体，您可以使用 CSS color 属性更改它们的颜色。集成说明位于页面底部提供的链接中。

* * *

**编辑：** Bootstrap 3.0.0 图标现在是字体！

正如其他一些人在发布 Bootstrap 3.0.0 时也提到的那样，默认[图标字形](http://getbootstrap.com/components/#glyphicons)现在是 Font Awesome 之类的字体，只需更改`color`CSS 属性即可更改颜色。可以通过`font-size`属性更改大小。

* * *

## 回答 #2

> 赞同：39
> 
> 时间：2013-08-29T20:36:27.680

使用最新版本的 Bootstrap RC 3，更改图标的颜色就像添加具有所需颜色的类并将其添加到跨度一样简单。

默认黑色：

```
<h1>Password Changed <span class="glyphicon glyphicon-ok"></span></h1> 
```

会成为

```
<h1>Password Changed <span class="glyphicon glyphicon-ok icon-success"></span></h1> 
```

CSS

```
.icon-success {
    color: #5CB85C;
} 
```

[Bootstrap 3 字形图标列表](http://getbootstrap.com/components/#glyphicons)

* * *

## 回答 #3

> 赞同：18
> 
> 时间：2014-05-22T20:25:14.100

因为字形现在是字体，所以可以使用[上下文类](http://getbootstrap.com/css/#helper-classes)将适当的颜色应用于图标。

例如： `<span class="glyphicon glyphicon-info-sign text-info"></span>` 添加`text-info`到 css 将使图标成为蓝色的信息。

* * *

## 回答 #4

> 赞同：14
> 
> 时间：2012-11-12T14:25:56.237

使引导图标具有不同颜色的另一种可能方法是创建一个所需颜色的新.png （例如**洋红色**）并将其保存为 /path-to-bootstrap-css/img/glyphicons-halflings-magenta.png

在你的**variables.less**中找到

```
// Sprite icons path
// -------------------------
@iconSpritePath:          "../img/glyphicons-halflings.png";
@iconWhiteSpritePath:     "../img/glyphicons-halflings-white.png"; 
```

并添加这一行

```
@iconMagentaSpritePath:     "../img/glyphicons-halflings-magenta.png"; 
```

在你的**sprites.less**添加

```
/* Magenta icons with optional class, or on hover/active states of certain elements */
.icon-magenta,
.nav-pills > .active > a > [class^="icon-"],
.nav-pills > .active > a > [class*=" icon-"],
.nav-list > .active > a > [class^="icon-"],
.nav-list > .active > a > [class*=" icon-"],
.navbar-inverse .nav > .active > a > [class^="icon-"],
.navbar-inverse .nav > .active > a > [class*=" icon-"],
.dropdown-menu > li > a:hover > [class^="icon-"],
.dropdown-menu > li > a:hover > [class*=" icon-"],
.dropdown-menu > .active > a > [class^="icon-"],
.dropdown-menu > .active > a > [class*=" icon-"],
.dropdown-submenu:hover > a > [class^="icon-"],
.dropdown-submenu:hover > a > [class*=" icon-"] {
  background-image: url("@{iconMagentaSpritePath}");
} 
```

并像这样使用它：

```
<i class='icon-chevron-down icon-magenta'></i> 
```

希望它可以帮助某人。

* * *

## 回答 #5

> 赞同：7
> 
> 时间：2013-04-17T12:19:36.607

快速而肮脏的工作为我完成了它，实际上不是为图标着色，而是用您想要的颜色的标签或徽章围绕它；

```
<span class="label-important label"><i class="icon-remove icon-white"></i></span>
<span class="label-success label"><i class="icon-ok icon-white"></i></span> 
```

* * *

## 回答 #6

> 赞同：6
> 
> 时间：2014-02-04T13:39:32.157

Bootstrap Glyphicons 是字体。这意味着它可以像任何其他文本一样通过 CSS 样式进行更改。

CSS：

```
<style>
   .glyphicon-plus {
       color: #F00; 
   }
</style> 
```

HTML：

```
<span class="glyphicon glyphicon-plus"></span> 
```

例子：

```
<!doctype html>
<html>
<head>
<title>Glyphicon Colors</title>
<link href="css/bootstrap.min.css" rel="stylesheet">
<style>
   .glyphicon-plus {
        color: #F00;    
   }
</style>
</head>

<body>
    <span class="glyphicon glyphicon-plus"></span>
</body>
</html> 
```

观看Jen Kramer 的[使用 Bootstrap 3 启动并运行课程，或观看关于](http://goo.gl/HcDQkY)[使用自定义样式覆盖核心 CSS](http://goo.gl/OY27hW)的个人课程。

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2013-08-28T20:17:10.533

这有点迂回..

我用过这样的字形

```
 </div>
        <div class="span2">
            <span class="glyphicons thumbs_up"><i class="green"></i></span>
        </div>
        <div class="span2">
            <span class="glyphicons thumbs_down"><i class="red"></i></span>
        </div> 
```

为了影响颜色，我像这样在头部添加了一些 CSS

```
<style>
        i.green:before {
            color: green;
        }
        i.red:before {
            color: red;
        }
    </style> 
```

瞧，绿色和红色拇指。

* * *

## 回答 #8

> 赞同：4
> 
> 时间：2015-01-19T11:28:45.707

也适用于样式标签：

```
<span class="glyphicon glyphicon-ok" style="color:#00FF00;"></span>

<span class="glyphicon glyphicon-remove" style="color:#FF0000;"></span> 
```

![在此处输入图像描述](../Images/5b53ec4f66419eb0470aff89d1e7eca8.png)

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2012-09-11T23:14:43.153

使用该`mask-image`属性，但它有点黑客。[它在此处](http://www.webkit.org/blog/181/css-masks/)的 Safari 博客中进行了演示。

[此处](http://developer.apple.com/library/safari/#documentation/InternetWeb/Conceptual/SafariVisualEffectsProgGuide/Masks/Masks.html)也对其进行了深入描述。

基本上你会创建一个 CSS 框，比如 a `background-image: gradient(foo);`，然后根据这些 PNG 图像对其应用图像蒙版。

它可以节省您在 Photoshop 中制作单个图像的开发时间，但我认为除非您以多种颜色显示图像，否则它不会节省太多带宽。就我个人而言，我不会使用它，因为您需要调整标记以有效地使用该技术，但我是“纯度是必然的”学派的成员。

* * *

## 回答 #10

> 赞同：3
> 
> 时间：2013-08-28T12:33:51.367

其实很简单：

只需使用：

```
.icon-name{
color: #0C0;} 
```

例如：

```
.icon-compass{
color: #C30;} 
```

就是这样。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2013-08-12T13:28:09.397

只需使用[GLYPHICONS](http://glyphicons.com/)，您就可以通过设置 CSS 来更改颜色：

```
#myglyphcustom {
    color:#F00;
} 
```

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2014-05-02T16:17:01.163

接受的答案（使用令人敬畏的字体）是正确的答案。但由于我只想在验证错误上显示红色变体，所以我最终使用了一个插件包，该插件包[在这个网站上](http://www.devlifeline.com/2013/09/twitter-bootstrap-glyphicons-extended.html)提供。

刚刚编辑了 css 文件中的 url 路径，因为它们是绝对的（以 / 开头），我更喜欢相对的。像这样：

```
.icon-red {background-image: url("../img/glyphicons-halflings-red.png") !important;}
.icon-purple {background-image: url("../img/glyphicons-halflings-purple.png") !important;}
.icon-blue {background-image: url("../img/glyphicons-halflings-blue.png") !important;}
.icon-lightblue {background-image: url("../img/glyphicons-halflings-lightblue.png") !important;}
.icon-green {background-image: url("../img/glyphicons-halflings-green.png") !important;}
.icon-yellow {background-image: url("../img/glyphicons-halflings-yellow.png") !important;}
.icon-orange {background-image: url("../img/glyphicons-halflings-orange.png") !important;} 
```

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2014-07-23T17:46:30.963

您也可以全局更改颜色

IE

```
 .glyphicon {
       color: #008cba; 
   } 
```

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2014-11-10T16:23:28.947

我想我可以将这个片段添加到这个旧帖子中。这是我过去所做的，在图标是字体之前：

```
<i class="social-icon linkedin small" style="border-radius:7.5px;height:15px;width:15px;background-color:white;></i>
<i class="social-icon facebook small" style="border-radius:7.5px;height:15px;width:15px;background-color:white;></i> 
```

这与@frbl 的偷偷摸摸的答案非常相似，但它不使用其他图像。相反，这会将`<i>`元素的背景颜色设置为`white`并使用 CSS 属性`border-radius`使整个`<i>`元素“圆形”。如果你注意到了，`border-radius`(7.5px) 的值正好是`width`and`height`属性的一半（都是 15px，使图标变成正方形），使`<i>`元素成为圆形。

# asp.net - 如何在请求之外获取网站根目录？

> ID：12379154
> 
> 赞同：3
> 
> 时间：2012-09-11T23:08:39.487
> 
> 标签：asp.net, ninject, bootstrapping, webactivator

在请求内部，我可以使用`Server.MapPath()`访问网站根目录。如何访问该功能或以其他方式获取网站根目录而不访问`Server`？我正在尝试为 ninject 内部构建一个绑定`WebActivator.PreApplicationStartMethod`。

我们尝试过使用`Directory.GetCurrentWorkingDirectory()`，它返回了`Microsoft Shared\Dev Server`. 但是， in `Global.asax.cs`，调用`Server.MapPath("")`in`Application_Start`会产生我想要的目录。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-06T18:12:36.517

使用`AppDomain.CurrentDomain.BaseDirectory`返回正确的目录。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-11T23:16:43.870

你可以看看这两个问题：

*   [如何在本地 IIS 服务器上获取网站的物理路径？（来自桌面应用程序）](https://stackoverflow.com/questions/3228813/how-to-get-websites-physical-path-on-local-iis-server-from-a-desktop-app)

*   [如何使用 C# 代码获取 IIS 虚拟目录和 Web 应用程序的物理路径？](https://stackoverflow.com/questions/5431713/how-to-get-the-iis-virtual-dir-web-applications-physical-paths-with-c-sharp-c)

# c# - 绑定 ItemsSource 后如何手动将项目添加到 GridView.Items？

> ID：12379155
> 
> 赞同：0
> 
> 时间：2012-09-11T23:08:42.297
> 
> 标签：c#, wpf, data-binding, windows-8, .net-4.5

我目前有一个填充了 ItemsSource 绑定到 ObservableCollection 的 GridView。

它按我的意图显示项目，但我想在最后手动添加一个外观和行为不同的项目。有没有办法在不修改 ItemsSource 绑定的 ObservableCollection 的情况下做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-11T23:27:14.297

有两种方法：

1.  使用 MVVM 将从模型层提取原始集合，并将附加项添加到视图模型中。*它的工作原理是您可以考虑仅*视图所需的附加项目，例如，您需要在其中添加“以上所有内容”的投票选项列表。

2.  有两个集合，分开，然后`IValueConverter`在绑定`ItemsSource`. 这种方法更加棘手，并且仅在您需要将两个集合分开和组合时才真正有用，例如，一个集合中的项目列表和另一个集合中的项目类别列表但也组合在一起。

我已经在一个广泛使用的大型 WPF 应用程序中成功地使用了这两种方法。

**编辑：**阅读有关问题的评论，如果您确实意味着您想要附加项目的不同视觉或行为，您可以使用 Selector`DataTemplateSelector`和/或`ItemContainerStyleSelector`. 我最近成功地使用了选项#2 和模板选择的组合。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-11T23:29:59.793

一些选项：

使用 CompositeCollection，您可以定义这是 xaml。不确定它是否能解决问题，您可能需要尝试一下

在后台创建一个新集合，其中填充了您的集合中的项目 + 额外项目。

编写一个转换器，然后创建一个新集合（或返回一个 IEnumerable）并添加新项目。

我想所有这些选项都有一个共同的主题，因为它们都是一个新系列。你基本上不能直接绑定到原始集合，因为它没有额外的项目，所以你必须以某种形式绑定到其他东西。

# ruby - 块的目的是什么？

> ID：12379160
> 
> 赞同：0
> 
> 时间：2012-09-11T23:09:35.490
> 
> 标签：ruby

我刚开始使用红宝石，无法将头绕在积木上

它与匿名函数有何不同？

我想在什么情况下使用它？

我什么时候会选择它而不是匿名函数？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-12T00:20:28.130

Ruby doesn't *have* anonymous functions like JavaScript (for example) has. Blocks have 3 basic uses:

1.  Creating `Proc`s
2.  Creating lambdas
3.  With functions

An example of where blocks are similar to anonymous functions is here (Ruby and JavaScript).

Ruby:

```
[1,2,3,4,5].each do |e| #do starts the block
  puts e
end #end ends it 
```

JS (jQuery):

```
$.each([1,2,3,4,5], function(e) { //Anonymous *function* starts here
  console.log(e);
}); //Ends here 
```

The power of Ruby blocks (and anonymous functions) is the fact that they can be passed to *any* method (including those you define). So if I want my own each method, here's how it could be done:

```
class Array
  def my_each
    i = 0
    while(i<self.length)
      yield self[i]
      i+=1
    end
  end
end 
```

For example, when you declare a method like this:

```
def foo(&block)
end 
```

`block` is a `Proc` object representing the block passed. So `Proc.new`, could look like this:

```
def Proc.new(&block)
  block
end 
```

Blocks, by necessity, are bound to a method. They can only be turned into an object by a method like I described above. Although I'm not sure of the exact implementation of `lambda` (it does extra arg checking), but it is the same idea.

So the fundamental idea of a block is this: A block of code, bound to a method, that can either be contained in a `Proc` object by an `&` argument, or called by the `yield` keyword.

# php - 正则表达式匹配的网址

> ID：12379161
> 
> 赞同：-2
> 
> 时间：2012-09-11T23:09:38.300
> 
> 标签：php, regex

我`\b(https?|ftp|file)://[-A-Z0-9+&@#/%?=~_|!:,.;|]*[A-Z0-9+&@#/%=~_|]`用来匹配这个字符串中的网址（添加换行符以便于查看；实际字符串是一件很长的事情）：

```
Lorem ipsum dolor sit amet, consectetur adipiscing elit.
http://www.google.com Nullam id lacus turpis.
http://www.google.com?test=correct&only=1 Quisque ac posuere sem.
http://www.google.com/search?q=blah|george. 
```

我当前的正则表达式得到前两个。对于第三个它得到`http://www.google.com/search?q=blah|george`。我怎样才能停止比赛`|`？即，我希望它只匹配`http://www.google.com/search?q=blah`。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-11T23:12:23.017

只需`|`退出“允许的字符”字符类即可。

# android - 创建底部有菜单的应用程序（像许多 iPhone 应用程序一样），如何组织活动/片段

> ID：12379163
> 
> 赞同：-1
> 
> 时间：2012-09-11T23:09:40.707
> 
> 标签：android, android-activity, controller, fragment

我想在屏幕底部创建一个带有菜单的应用程序。此菜单应在应用程序启动时可见。我正在处理片段，所以菜单是一个片段。

所以我只有一个 Activity 作为控制器，它在菜单片段上方加载不同的片段。因为我想创建干净的代码，所以我不知道如何解决 Activity 类太大的问题。

换句话说，我想在同一个活动中创建不同的控制器。怎么做？有没有另一种方法来解决这个问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-11T23:22:52.293

您应该使用[拆分操作栏](http://developer.android.com/design/patterns/actionbar.html "拆分操作栏")这允许您将操作和溢出菜单放在屏幕底部。我相信您可以使用[Action Bar Sherlock](http://actionbarsherlock.com/)向后兼容旧版本的 Android。有关详细信息，请参阅他们的网站。

[另一种可能性是研究在ViewPager](http://developer.android.com/reference/android/support/v4/view/ViewPager.html)中使用片段。这是一个与兼容性以及[ViewPageIndicator](http://viewpagerindicator.com/)一起使用的库。这是一篇[博客文章](http://android-developers.blogspot.com/2011/08/horizontal-view-swiping-with-viewpager.html)，就像我在评论中指出的那样，我使用底部显示的选项卡和上面的页面进行了此操作。

# php - Wordpress Facebook 分享缩略图 (PHP)

> ID：12379165
> 
> 赞同：1
> 
> 时间：2012-09-11T23:09:54.493
> 
> 标签：php, facebook, wordpress

我知道当人们在 Facebook 上分享您网站上的页面时，它会使用“image_src”标签来查找预览图像。我希望 Facebook 查找帖子缩略图并首先使用它，如果不存在，则使用默认值。

有人可以验证此代码*是否可以*工作吗？我认为 Facebook 现在没有缓存/追赶，但我只想得到更高级的人的点头，以确保我没有犯根本性错误。

```
<link rel="image_src" href="
<?php
if ( has_post_thumbnail() ) {
$thumbnail_src = wp_get_attachment_image_src( get_post_thumbnail_id( $post->ID ), "size" );
echo $thumbnail_src;
}
else echo "/link.jpg"; ?>
" /> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-11T23:23:38.320

为什么不使用[Facebook 的 Open Graph](http://davidwalsh.name/facebook-meta-tags) META 来定义图像（用于共享），只要您的缩略图设置为特色图像，下面的代码（[在此处找到](http://wordpress.org/support/topic/getting-a-post-featured-image-url?replies=9)）应该可以工作。

```
<!-- facebook open graph stuff -->
<meta property="fb:app_id" content="xxxxxxxxx"/>
<meta property="og:site_name" content="MySite"/>
<meta property="og:url" content="http://www.mysite.com"/>
<meta property="og:title" content="Story Title" />
<meta property="og:image" content="
<?php
    $thumbnail_src = wp_get_attachment_url( get_post_thumbnail_id( $post->ID ))
    if($thumbnail_src){ 
    echo $thumbnail_src;
    } else { 
    echo "/link.jpg"; } ?> 
"/>
<!-- end facebook open graph --> 
```

# python - 比较python中多个jpeg的来源

> ID：12379166
> 
> 赞同：0
> 
> 时间：2012-09-11T23:09:57.913
> 
> 标签：python

我有一个文件夹，里面有 78 张 jpeg 图片，其中只有 48 张是唯一的。我想用 Python 遍历这个文件夹中的文件，并让它打印出每个文件名的列表，只要图像不是重复的。

更具体地说，它将打印出一个数组，我可以将其复制并粘贴到 PHP 脚本中以供使用。

我的想法是，当我遍历文件时，将文件源的 md5 保存到一个数组中。但是，如果哈希值已经在数组中，它将忽略该文件并继续前进。

这是我的脚本：

```
from os import listdir
from os import path
from hashlib import md5

m = md5()
hashes = []
d = path.join("Z:\\mydir")
files = listdir(d);
i = 1;

print " array("

for file in files:

    src = "Z:\\mydir\\%s" % file
    src = open(src)
    src = src.read()

    m.update(src)
    hash = m.digest()

    if(hash not in hashes):

        hashes.append(hash)

        if(i == len(files)):
            print "\"%s\"" % file
        else:
            print "\"%s\"," % file
    i += 1

print ");" 
```

这是打印出每张图片！

我认为这个问题可能是因为 jpeg 文件开头的元数据，所以我试图只阅读源代码的后半部分：

```
halfsrclen = len(src) / 2

m.update(src[halfsrclen:])
hash = m.digest() 
```

但这仍然是返回每个文件！

我可能做错了什么，但我不知道是什么:(

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-11T23:13:19.857

您在开始时只创建*一个* `md5`对象，并为每个文件重用相同的哈希对象。*这会为您迄今为止看到的所有*文件创建一个运行哈希，因此每个文件的计算值不同也就不足为奇了。

相反，`md5`为每个文件创建一个新对象：

```
m = md5()
m.update(src)
hash = m.digest() 
```

或者更简洁地说，您可以将数据直接传递给`md5()`构造函数：

```
hash = md5(src).digest() 
```

# ruby - 用长字符串替换

> ID：12379173
> 
> 赞同：2
> 
> 时间：2012-09-11T23:11:48.937
> 
> 标签：ruby, regex, string

我正在使用 gsub 替换文本文件中长字符串的一部分，例如。

```
 str.gsub!(/#{str1}/){"#{updates}"} 
```

当字符串变长时，ruby 返回字符串太长的错误。我怎么解决这个问题？有没有可以做同样工作的 gsub 替代品？据我所知，gsub 会生成原始数据的副本，效率低下。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-11T23:41:36.960

如果`str1`只是一个字符串而不是正则表达式片段，那么您可以执行以下操作：

```
str[str1] = updates 
```

用就地替换`str1`部分。例如：`str``updates`

```
>> s = 'Where is X house?'
=> "Where is X house?"
>> s['X'] = 'pancakes'
=> "pancakes"
>> s
=> "Where is pancakes house?" 
```

`str1`如果您想替换所有s ，则必须在某种循环中重复该操作，直到出现 IndexError `str`。

正则表达式很棒，但你的工具箱应该不仅仅是一把锤子。

顺便说一句，如果`str1`应该只是一个字符串，您应该在将[`Regexp.escape`](https://ruby-doc.org/core/Regexp.html#method-c-escape)其插入到正则表达式之前使用它。

# nhibernate - 如何在分层架构中使用 NHibernate

> ID：12379174
> 
> 赞同：1
> 
> 时间：2012-09-11T23:11:49.380
> 
> 标签：nhibernate

我见过许多关于 NHibernate 会话管理的类似问题（所以我知道我并不孤单），但没有解决从其他层抽象会话管理细节的答案。

简单来说，我有一个域层，其中包含客户、产品和订单等对象。我有一个集成层，它为应用程序定义服务，如 IOrderEntryService，其中包含 Get<Product>(int id) 或 Get<Customer>(int id) 和 Get<Order>(int id) 等方法。我有一个业务规则层，它使用这些服务来获取客户、订单等。业务规则仅使用服务接口来避免对任何特定服务实现的硬依赖。

我可以使用 NHibernate 实现 IOrderEntryService 并定义映射以支持诸如 Customer.Orders 以及 Order.Customer 等属性以及使用延迟加载的类似关联。在我的 Get<Customer>(int id) 实现中，我打开一个 ISession 对象，获取一个客户，然后处置我的 ISession。稍后，如果我引用 Customer.Orders，我会收到一个异常，因为没有当前会话。我理解这样做的原因，但我很难找到一种不将更高层绑定到 NHibernate 的解决方法。我发现的所有示例都建议了为每个请求获取 NHibernate.ISession 的方法，以便会话在整个请求生命周期内保持打开状态。我为此感到挣扎，因为这会将更高层绑定到 NHibernate ISession 对象。

是否有一种抽象的方式来管理不将更高层绑定到 NHibernate 的“会话”？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-12T06:53:58.773

您应该检查[Sharp architecture](http://sharparchitecture.net/)和 sharp [architecture lite](https://github.com/codai/Sharp-Lite)项目。他们都对如何在基于 Web 的系统中使用 nhibernate 提供了扎实的理解。更重要的是，它们为您提供了 IoC 容器、DDD、TDD 等其他方法的背景知识。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-11T23:47:55.037

我建议您使用能够以“隐式方式”管理事务的框架，如 Spring.Net。

它将管理“打开”、“关闭”、“提交”或“回滚”“ISession's”/“事务”的会话。

**关于您的问题**：我认为如果不对较高层的 ISession 进行部分管理，就无法保持会话打开（在演示文稿呈现期间）。

保持对更高层的 ISession 的管理没有问题，只要 [对 ITransaction 的管理] 不受它们的影响。

使用“Spring.Net”，您可以使用：`[Transaction]`和`[Transaction(ReadOnly = true)]`.

# ios - Rafactor 只有一个文件在项目中使用 ARC？

> ID：12379180
> 
> 赞同：1
> 
> 时间：2012-09-11T23:12:32.353
> 
> 标签：ios, xcode, automatic-ref-counting

我的项目**已经**使用了 ARC，但是我从苹果添加了一个不使用 ARC 的类。

我可以仅将此文件重构为 ARC 吗？在重构菜单中选择类，尝试在没有 ARC 的情况下编译我的整个应用程序。这当然会失败，因为只有一个类是非 ARC。

如果没有简单的方法可以做到这一点，我可以在没有 ARC 的情况下编译这个类吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-11T23:42:07.593

这门课在 Apple 项目中几乎是肯定的。重构整个项目——您不需要真正完成或编译——但一旦完成，您就可以将重构的文件作为起点。

# c++ - 将整数转换为小端十六进制字符串

> ID：12379181
> 
> 赞同：0
> 
> 时间：2012-09-11T23:12:50.013
> 
> 标签：c++, visual-studio-2010, windows-xp, long-integer, endianness

我正在尝试将整数转换为小端十六进制字符串。我可以达到一点点十六进制长，但我不确定如何从那里转换为字符串。

```
int iNum = 17706; 
// convert to long little endian hex
long lNum = (long)_byteswap_ushort(iNum);
// convert to string?? 
```

或者，有没有办法直接从整数到小端十六进制字符串？

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-11T23:25:13.467

用于`std::stringstream`格式化字符串。

此外，使用`_byteswap_ulong`或大整数也不准确。

```
long iNum = 17706; 
// convert to long little endian hex
long lNum = (long)_byteswap_ulong(iNum);
// convert to string
std::ostringstream oss;
oss << std::hex << lNum;
std::string mystring = oss.str(); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-12T14:37:59.847

对于便携式解决方案，只需掩码和移位：

```
while (iNum != 0) {
    int byte = iNum & 0x0F;
    std::cout << std::hex << byte;
    iNum /= 16;
} 
```

# android - 我可以创建两个上下文操作栏吗？

> ID：12379184
> 
> 赞同：1
> 
> 时间：2012-09-11T23:13:07.477
> 
> 标签：android, split, android-actionbar, contextual-action-bar

我正在设计一个编辑器，它将对两个相关项目进行特定于上下文的操作，例如插入图像、清除等。在更大的显示器上同时显示这两个项目是有意义的。我宁愿不要求用户在选项卡之间来回切换。

![布局草图 - 图像中的任何失真肯定是由于您的廉价显示器变形](../Images/c086adcc1a4e3995e198e650f3051ea4.png)

是否可以和/或建议使用两个不同的[上下文操作栏](http://developer.android.com/design/patterns/actionbar.html#contextual)来支持这样的配置？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-11T23:42:37.507

一次只有一个。上下文操作栏（又名操作模式）取代了常规操作栏。由于您只有一个操作栏，因此一次只能有一个上下文操作栏。由于用户（希望）一次只处理一个“上下文”，这（希望）不会是一个很大的限制，只要在视觉上很明显她正在执行上下文动作。

# perl - 忽略函数输出中列表的一部分。调用 Perl

> ID：12379187
> 
> 赞同：1
> 
> 时间：2012-09-11T23:13:26.510
> 
> 标签：perl

我只想捕获 Perl 中函数输出的列表的一部分。

我以为只有这些线可以做到这一点，但他们没有。

例如捕获列表的最后一个元素：

```
(, $my_var)  = split(/_/,$sample_string); 
```

例如捕获列表的第二个元素：

```
(, $my_var, , ,)  = split(/_/,$sample_string); 
```

这在 Perl 中可能吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-11T23:26:42.667

另一种解决方案：将不需要的元素分配给`undef`：

```
(undef, $my_var)  = split(/_/,$sample_string); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-11T23:21:28.880

返回数组的第二个元素：

```
my $second_element = (split(/_/,$sample_string))[1]; 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-09-11T23:38:13.143

当你只需要找到两个时，为什么要找到所有的下划线？

```
my ($last_element)   = $sample_string =~ /([^_]*)\z/;
my ($second_element) = $sample_string =~ /_([^_]*)_/; 
```

更一般地说，列表切片可以：

```
my $last_element   = ( split(/_/, $sample_string) )[-1];
my $second_element = ( split(/_/, $sample_string) )[1];
my @some           = ( split(/_/, $sample_string) )[2,3]; 
```

但最接近您要求的是占位符：

```
my (undef, $second_element) = split(/_/, $sample_string); 
```

# javascript - Javascript 可选类型提示

> ID：12379191
> 
> 赞同：12
> 
> 时间：2012-09-11T23:13:52.140
> 
> 标签：javascript, performance, variables, ecmascript-harmony, ecmascript-4

当编程语言是静态类型时，编译器可以更精确地分配内存，因此通常性能更高（在所有其他条件相同的情况下）。

我相信 ES4 引入了可选的类型提示（据我了解，由于 actionscript，Adobe 在其规范中发挥了重要作用）。因此，javascript 是否正式支持类型提示？ES6 会支持原生变量的可选类型提示吗？

如果 Javascript 确实支持类型提示，是否有任何基准可以显示它在性能方面的回报？我还没有看到一个开源项目使用它。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-09-11T23:25:31.313

我的理解是，通过在各个站点上听过许多 Javascript 演讲，类型提示不会像人们想象的那样有帮助。

简而言之，如果您愿意，大多数 Javascript 对象往往具有相同的“形状”。也就是说，它们将具有以相同顺序创建的相同属性。这个“形状”可以被认为是对象的“类型”。一个例子：

```
function Point(x, y) {
  this.x = x;
  this.y = y;
} 
```

所有由“Point”制成的对象都将具有相同的“形状”，并且更新的内部 Javascript 引擎可以做一些花哨的游戏来更快地查找。

在 Chrome（也许还有其他）中，它们使用高位标志来指示数字的其余部分是整数还是指针。

随着所有这些花哨的事情的发生，剩下的就是人类编码人员的打字工作。一方面，我真的很*喜欢*不必担心类型，也不会使用该功能。

不过，您是半正确的。类型提示是其中的一部分`ActionScript 3`——`ECMAScript`但提示从未成为标准。AFAIK，除了一厢情愿之外，还没有讨论过。

该视频更详细地描述了事情： [http ://www.youtube.com/watch?v=FrufJFBSoQY](http://www.youtube.com/watch?v=FrufJFBSoQY)

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2012-11-01T05:56:39.373

我迟到了，但由于没有人真正回答你有关标准的问题，我会加入。

是的，类型提示作为 ECMAScript 4 的一部分进行了讨论，看起来它将成为 JavaScript 的未来……直到 ES4 尘埃落定。ECMAScript 4 被放弃并且从未最终确定。ECMAScript 5（当前标准）没有包含许多为 ECMAScript 4 计划的东西（包括类型提示），实际上只是 ECMAScript 3.1 草案的快速增强版本——以提供一些有用的功能在 ES4 过早消亡之后。

正如您所提到的，现在他们正在开发 ECMAScript 6（它有一些非常棒的特性！），但不要期望看到类型提示。Adobe 人员在一定程度上与 ECMAScript 委员会分道扬镳，而 ES 委员会似乎对恢复它不感兴趣（我认为这是有充分理由的）。

如果这是您想要的，您可能需要查看[TypeScript](http://www.typescriptlang.org/)。这是一个全新的微软项目，基本上是对 ES6+类型的尝试。它是 JavaScript 的超集（除了包含类型之外几乎相同），并且可以编译为可运行的 JavaScript。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2014-06-03T04:25:12.583

ES7（不会很快推出）有一个新的特性叫做[guard](http://wiki.ecmascript.org/doku.php?id=strawman%3aguards)可能就是你要问的那个。现在的语法有点类似于 ES4 和 TypeScript。所有使用`:`并将类型附加到变量。但它不确认语法。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2012-09-12T00:03:59.050

JavaScript JIT 编译器必须做一些非常花哨的事情来确定表达式和变量的类型，因为类型对于许多优化至关重要。但是 JavaScript 编译器的编写者在过去的五年里一直在做所有这些工作。编译器现在真的很聪明。因此，可选的静态类型不会提高典型程序的速度。

令人惊讶的是，当值从无类型代码传递到有类型代码时，ActionScript 中的类型注释有时会要求类型检查（或隐式转换），从而使编译代码*变慢。*

您可能需要在编程语言中使用静态类型还有其他原因，但 ECMAScript 标准委员会对将它们添加到 JS 没有兴趣。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-09-11T23:46:08.440

Javascript 是基于原型的，因此对象的“类型”是完全动态的，并且能够在其生命周期内发生变化。

看看 Ben Firshman 关于对象类型的 Javascript 性能的发现 - [http://jsconf.eu/2010/speaker/lessons_learnt_pushing_browser.html](http://jsconf.eu/2010/speaker/lessons_learnt_pushing_browser.html)

# android - Android：如何将相对布局更改为滚动布局

> ID：12379192
> 
> 赞同：2
> 
> 时间：2012-09-11T23:13:53.793
> 
> 标签：android, scrollview, android-relativelayout

你好，我在 Android 中有一个相对布局，带有 EditTexts、TextViews、一个 Spinner 和 RadioButtons。只有一个屏幕有很多东西，所以我需要更改为 ScrollView。当我尝试在第一行和最后一行添加该行时，我遇到了问题。

如何在我的屏幕上添加滚动而不丢失我迄今为止构建的所有布局？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-11T23:40:35.700

> 所以我需要换一个 ScrollView

您无需*更改*“为 ScrollView”。你需要*把*你`RelativeLayout`的`ScrollView`.

> 如何在我的屏幕上添加滚动而不丢失我迄今为止构建的所有布局？

`ScrollView`在你的周围放一个`RelativeLayout`：

```
<ScrollView>   
    <RelativeLayout> 
               <!-- existing stuff here -->
    </RelativeLayout> 
</ScrollView> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-11T23:54:51.467

正如@CommonsWare 所说，您可以用`ScrollView`.

请记住，[ScrollView](http://developer.android.com/reference/android/widget/ScrollView.html)必须只有一个孩子。

# php - 真正基础的 AJAX (PHP, jQuery)

> ID：12379193
> 
> 赞同：0
> 
> 时间：2012-09-11T23:14:00.453
> 
> 标签：php, jquery, ajax

所以我一直在网上挖掘，发现 jQuery AJAX 解决方案最适合我想做的事情。

我发现 jquery.ajax() 和 jquery.post() 被提及最多。

但是我找到的信息非常全面，老实说，我有点迷路了！

我需要创建一个简单的按钮，它将充当切换开关。它需要将数据 POST 到 PHP 脚本，该脚本将处理它并返回 true 或 false。该按钮应显示设置，或相应地取消设置。

这是障碍，结果还取决于返回 true 或 false 的数据库查找，我需要安全地从 $_SESSION 获取信息。由于 javascript 是客户端，我不热衷于将这些数据输出到用户可以访问的内容中。我的问题是，我可以从“被调用”的 PHP 文件中访问会话，并且它仍然可以正常工作（比如包含？）。

这是我发现的最好的基本代码，但不安全并且可能不正确..

```
$("#mydiv").click(function(){

var button = $(this) ;

if (!button.hasClass('active')) {
    $.post("ajax.php", { user: "2", action: "start" },
        function(data){
           button.addClass('active');
           button.html("End") ;
        }
    );

}
else {
    $.post("ajax.php", { user: "2", action: "stop" },
        function(data){
           button.removeClass('active');
           button.html("Start") ;
        }
    );
}

}); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-11T23:17:44.907

您可以从调用的 php 脚本中安全地访问 $_SESSION。

我假设您在 php 脚本上打印的是真还是假。在这种情况下，您可能需要在回调函数中添加 if 语句。数据包含php脚本的返回。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-11T23:58:08.103

会话变量将在您调用的 php 脚本中可用。请注意，`$.post()`-function 是异步的，并且有一个回调参数，在您的情况下称为`data`. 此回调变量将存储您在 php 脚本中调用的任何内容`$.post()`。

现在，您可以验证内容并做任何您喜欢的事情（顺便说一句，出于安全原因，验证应该始终在您的 php 文件中进行，而不是在 javascript 中进行！）。

一种想法是在验证后回显`"true"`或`"false"`在您的 php 文件中回显，然后退出 php 脚本，例如：

```
<?php
    //validate here and store success in boolean $success
    if($success==true){ echo "true"; exit; }
    else{ echo "false"; exit; }
?> 
```

然后，您的 javascript 回调参数`data`将具有`"true"`或的值`"false"`。您可以像 javascript 中的任何其他变量一样简单地访问此变量，并根据其值执行操作。

一种解决方案可能是：

```
$("#mydiv").click(function(){

    var button = $(this) ;

    if (!button.hasClass('active')) {
        $.post("ajax.php", { user: "2", action: "start" },
            function(data){
                if(data=="true"){
                    button.addClass('active');
                    button.html("End");
                }
            }
        );
    }
    else {
        $.post("ajax.php", { user: "2", action: "stop" },
           function(data){
                if(data=="true"){
                    button.removeClass('active');
                    button.html("Start");
                }
           }
        );
    }

}); 
```

这应该够了吧。如果您需要返回多个数据点，例如带有属性的对象，请检查[JSON](http://www.json.org)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-11T23:20:55.493

如果 PHP 脚本的答案是成功/错误，请考虑使用 HTTP 标头来指示这一点，例如

失败时，渲染：

> header("HTTP/1.0 406 不可接受");

这使您在 jquery 中的生活变得轻松，因为您可以编写成功和错误的处理程序。

至于会话，它应该可以找到，浏览器在发出 AJAX 请求时会传递会话 cookie，PHP 会正确加载会话。

您可以使用以下内容修改上面的代码：

```
$.ajax({
  url: 'http://blarg.com',
  data: { your post data },
  success: function(data) {  do something },
  error: function(o,textStatus) { do Error }
}); 
```

查看 API 了解更多详情：[http ://api.jquery.com/jQuery.ajax/](http://api.jquery.com/jQuery.ajax/)

# ruby-on-rails - 轮胎宝石：如何访问 Elasticsearch 的“高亮”属性？

> ID：12379194
> 
> 赞同：0
> 
> 时间：2012-09-11T23:14:05.643
> 
> 标签：ruby-on-rails, ruby-on-rails-3, elasticsearch, tire

我有一些在 Elasticsearch 中被索引的 Rails 模型（通过 Tire gem）。我可以索引新文档并查询现有索引。

我似乎无法从我的 Rails 应用程序中获取附加到记录的**亮点。**但是，当我*直接*`highlight`通过`curl`.

当我尝试访问`highlight`我的记录属性时，我得到：`undefined method 'highlight' for #<Report:0x007fe8afa54700>`

```
# app/views/reports/index.html.haml
%h1 Listing reports
...
  - @reports.results.each do |report|
    %tr
      %td= report.title
      %td= raw report.highlight.attachment.first.to_s 
```

但是如果我使用`curl`我可以看到`highlight`返回到轮胎......

```
$ curl -X GET "http://localhost:9200/testapp_development_reports/report/_search?load=true&pretty=true" -d '{query":{"query_string":{"query":"contains","default_operator":"AND"}},"highlight":{"fields":{"attachment":{}}}}'
{
  "took" : 1,
  "timed_out" : false,
  "_shards" : {
    "total" : 1,
    "successful" : 1,
    "failed" : 0
  },
  "hits" : {
    "total" : 2,
    "max_score" : 0.111475274,
    "hits" : [ {
      "_index" : "testapp_development_reports",
      "_type" : "report",
      "_id" : "1",
      "_score" : 0.111475274, "_source" : {"id":1,"title":"Sample Number One",...,"attachment":"JVBERi0xMJ1Ci... ...UlRU9GCg==\n"},
      "highlight" : {
        "attachment" : [ "\nThis <em>contains</em> one\n\nodd\n\n\n" ]
      }
    }, {
      "_index" : "testapp_development_reports",
      "_type" : "report",
      "_id" : "2",
      "_score" : 0.111475274, "_source" : {"id":2,"title":"Number two",...,"attachment":"JVBERi0xLKM3OA... ...olJVPRgo=\n"},
      "highlight" : {
        "attachment" : [ "\nThis <em>contains</em> two\n\neven\n\n\n" ]
      }
    } ]
  }
} 
```

模型中的搜索方法：

```
 ...
  def self.search(params)
    tire.search(load: true) do
      query { string params[:query], default_operator: "AND" } if params[:query].present?
      highlight :attachment
    end
  end
  ... 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-12T08:46:31.730

使用选项`highlight`时无法访问方法。`load: true`这应该在轮胎的未来版本中修复。

编辑：您现在可以使用`each_with_hit`方法访问返回的弹性搜索值

例如：

```
results = Article.search 'One', :load => true
  results.each_with_hit do |result, hit|
  puts "#{result.title} (score: #{hit['_score']})"
end 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-15T12:58:35.753

[你可以在这篇文章Elasticsearch/Lucene highlight](https://stackoverflow.com/questions/11424927/elasticsearch-lucene-highlight/13395024#13395024)中找到我的答案

我的方法对我来说很好，希望你也能得到它。

# jquery - 一个带有 onclick 事件的子级的 jQuery 拖动滚动器——不能让它们在拖动时停止触发

> ID：12379197
> 
> 赞同：0
> 
> 时间：2012-09-11T23:14:22.257
> 
> 标签：jquery, preventdefault

我在这里潜伏了很长时间，现在遇到了一个我真的无法解决的问题。

这是一个简单的`#viewport`and `.canvas`，它`.canvas`是超宽的并且`#viewport`有`overflow:hidden`：

```
<div id="viewport">
    <div class="canvas">
        <a href="#" onclick="alert('event fired, boo.')">do not fire on mouse up</a>
    </div>
</div> 
```

使用我在这里的代码，我用 jQuery 创建了一个拖动滚动器，所以当您单击`#viewport`并拖动它时，它会滚动内容，然后将其捕捉到最接近的 190 像素倍数（不相关，但那里的人可能想要我的代码）

```
$("html").mouseup(function(e) {
    down = false;
    $("#viewport").animate({scrollLeft:(190 * Math.round($("#viewport").scrollLeft() / 190))}, 150);
});
$("#viewport").mousedown(function(e) {
    e.preventDefault();
    down = true;
    x = e.pageX;
    left = $(this).stop().scrollLeft();
});
$(document).mousemove(function(e) {
    if (down) {$("#viewport").scrollLeft(left - e.pageX + x);}
}); 
```

我想要做的就是开始拖动链接，当我使用鼠标时，我只需要不触发链接。

我尝试`e.preventDefault()`过到处放置，但是当我松开鼠标时，我似乎无法阻止链接触发。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-12T01:50:10.873

首先，您需要处理`e.preventDefault()`链接的点击事件，因为这是您要阻止的默认事件。

其次，执行上述操作不会阻止`alert('event fired, boo.')`，因为附加在 javascript 中的单击处理程序将在附加在 HTML中的单击处理程序*之后*`e.preventDefault()`触发，并且为时已晚。您可以安全地`onclick="alert('event fired, boo.')"`从 HTML 中删除。

## 编辑

一个聪明的解决方案是链接不是双重用途的 - 即。将拖拽功能与超链接功能分开。但是，如果这是不可能的，那么这里有一个建议的策略：

*   使用仅执行`e.preventDefault()`.
*   通过 190px 获得可拖动性可靠地工作。
*   在鼠标按下时，读取并存储链接位置。
*   在 mouseup 上， if(position has changed) 什么都不做；否则模拟超链接动作。

# javascript - 滑块上的jQuery ui滑块值

> ID：12379202
> 
> 赞同：1
> 
> 时间：2012-09-11T23:14:43.700
> 
> 标签：javascript, jquery, jquery-ui, slider

我很好奇是否有人有一个预先存在的解决方案来将滑块的值放在滑块本身的句柄中，超出以下范围：

```
 $( "#slider-vertical" ).slider({
        orientation: "vertical",
        range: "min",
        min: 0,
        max: 100,
        value: 60,
        slide: function( event, ui ) {
            $( "#amount" ).val( ui.value );
            $(this).find('.ui-slider-handle').text(ui.value);
        } 
```

注意：这不会设置滑块的初始值，但我知道需要这样做。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-11T23:24:07.533

试试这个

```
​$(function(){
    $( "#slider-vertical" ).slider({
        orientation: "vertical",
        range: "min",
        min: 0,
        max: 100,
        value: 60,
        slide: function( event, ui ) {
            $( "#amount" ).val( ui.value );
            $(this).find('.ui-slider-handle').text(ui.value);
        },
        create: function(event, ui) {
            var v=$(this).slider('value');
            $(this).find('.ui-slider-handle').text(v);
        }
    });    
});​ 
```

[**演示**](http://jsfiddle.net/6hyVP/2/)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-04-18T14:35:21.573

如果您使用范围滑块单独设置每个滑块，则对此进行更新

```
$("#slider-vertical").slider({
        range: true,
        min:0,
        max:500,
        values:[1,300],
        slide: function( event, ui ) {
            $(ui.handle).text(ui.value);
        },
        create: function(event, ui) {
            var v = $(this).slider('values');
            var c = 0;
            $(this).find('.ui-slider-handle').each(function(){
                $(this).first().text(v[c]);
                c++;
            });
        }   
}); 
```

# python - urlopen error 连接服务器时出错：ApplicationError: 2 [Errno 10104] getaddrinfo failed

> ID：12379207
> 
> 赞同：3
> 
> 时间：2012-09-11T23:15:27.210
> 
> 标签：python, google-app-engine, python-2.7

我从 Google AppEngine 应用程序使用它时收到此 URLError。然而，当作为独立脚本运行时，相同的 python 脚本可以正常工作。我在互联网上搜索了很多，但找不到解决方案。有没有人遇到过并成功解决？

```
response = opener.open(req) 
```

文件“C:\Python27\lib\urllib2.py”，第 394 行，打开响应 = self._open(req, data) 文件“C:\Python27\lib\urllib2.py”，第 412 行，在 _open '_open ', req) 文件“C:\Python27\lib\urllib2.py”，第 372 行，在 _call_chain 结果 = func(*args) 文件“C:\Python27\lib\urllib2.py”，第 1207 行，在 https_open 返回self.do_open(httplib.HTTPSConnection, req) 文件“C:\Python27\lib\urllib2.py”，第 1174 行，在 do_open 中引发 URLError(err) URLError: urlopen error 连接到服务器时出错：ApplicationError: 2 [Errno 10104] getaddrinfo 失败

# api - API 服务器是否应该存储用户会话数据？还是应用服务器？

> ID：12379211
> 
> 赞同：0
> 
> 时间：2012-09-11T23:16:10.267
> 
> 标签：api, node.js, architecture, webserver

我一直想知道在 API 服务器上存储会话数据的优点/缺点是什么。将会话数据存储在 API 服务器上似乎更直观一些，但我可以看到保持 API 无状态和使用访问令牌访问数据的好处。

你觉得呢？你有没有什么想法？

谢谢！马特

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-14T01:08:07.990

从我目前所读到的，两者都不是。

还有[另一个类似的问题](https://stackoverflow.com/questions/2142856/maintaining-state-in-the-application-server-or-in-the-database)，询问在真正的 REST 样式设置中，应用程序服务器或数据库服务器是否应该持有会话。一些人回答说，虽然有时将会话保存在应用程序服务器（或者在您的情况下是 API 服务器）上更快或更方便，但最好将会话存储在数据库或 Memcache 中。

如果您将它们保留在 API 服务器上，那么如果服务器崩溃，您将面临丢失会话的风险。

此外，（我从[AJ](https://stackoverflow.com/a/2142892/1610603)解释）将您的会话保留在 API 服务器上仅在以下情况下才有效：

*   您的客户端始终连接到同一台服务器（又名“会话亲和性”）
*   您的服务器节点都使用一个公共安装点来假脱机会话

我不确定第二个是否适用于这种情况，但是数据库和/或 Memcache（感谢[InspiredJW](https://stackoverflow.com/a/12380304/1610603)）的想法听起来确实是您最好的选择！

非常感谢

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-12T02:04:28.990

我想说，将会话存储在应用程序服务器和 API 服务器之外的服务器中是很好的。

因为速度，`memcached`被`Redis`用作会话存储。它们速度很快，因为它们是**基于内存的**。

对于**横向扩展**，我建议您将会话存储与 API 和应用程序服务器分开。

即使您的应用程序和 API 服务器在一段时间内出现问题，在这种情况下会话也不会丢失。

# android - 无法在android中禁用屏幕兼容模式

> ID：12379212
> 
> 赞同：1
> 
> 时间：2012-09-11T23:16:11.687
> 
> 标签：android

我正在为所有屏幕尺寸和 dpi 开发一个应用程序。

问题是对于比正常更大/更小的屏幕，UI 正在缩放，这意味着我认为屏幕兼容模式已启用。

这是我的目标：我有一个高度为 90 像素的图像按钮，所以我认为它在 normal-mdpi 设备中是 90 dp，我希望它在越来越小的屏幕尺寸中保持 90 dp。所以对眼睛来说，大小保持不变。

我遇到的问题是在普通 mdpi 设备中看起来不错（90 dp），但在大型 mdpi 设备中看起来更大并且具有缩放伪影。

我的目标是 2.3.3 的最小 android 操作系统，因此我有以下清单：

```
<uses-sdk
    android:minSdkVersion="10"
    android:targetSdkVersion="16" />

<!--
    If not set explictly, screen compatibility mode would be enabled for
    large screen, which is scaling of normal
-->
<supports-screens
    android:anyDensity="true"
    android:largeScreens="true"
    android:normalScreens="true"
    android:smallScreens="true"
    android:xlargeScreens="true" /> 
```

根据 android 文档，如果目标是 10 或以下，则必须指定 support-screens，否则默认启用兼容模式。问题是我正在指定它，但我仍然启用了兼容模式。

有任何想法吗？如果我的理解有误，请告诉我。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-12T23:35:05.010

好的，我想我在一整天的调试后发布了一个答案。

对我来说，问题似乎是模拟器。当您启动 ADV 时，您需要计算实际屏幕设备大小并了解您的显示器 dpi，以便您可以在启动选项中进行设置。完成此操作后，我在布局中指定为“x dp”并在 PNG 中具有“x 像素”的图像按钮在所有屏幕尺寸和密度中看起来都相同（英寸）。

如果您想摆脱由于 android 缩放而导致的伪影，您可以在 ldpi、hdpi、xhdpi 文件夹中提供您自己的图像，并应用相应的缩放。

要计算设备屏幕尺寸，请使用启动选项对话框中提供的分辨率和密度，然后使用以下公式进行计算：（看起来很痛苦，但它有效，您可以在计算机显示器中用尺子测量，如果 x in，设备将在您的标尺中为 x）屏幕尺寸 = sqrt（（w 像素/dpi）^2 +（h 像素/dpi）^2）其中 w，h 是以像素为单位的分辨率

为了计算您的显示器 dpi，我搜索了我的计算机类型。对于 mac book pro 15.4 in，它是 128，对于 Apple Cinema display 27，它是 109。希望这会有所帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-13T01:38:53.640

我用来保持所有图像大小相同的方法是使用常规显示 getWidth 和 getHeight 方法来设置变量。然后我使用 Bitmap.createScaledBitmap 将我的图像设置为屏幕大小的 %。无论dpi如何，它看起来都一样。在 16:9 的 240 dpi 屏幕上，在 480 dpi 16:9 屏幕上获得相同的图像将是 dpi 的两倍。

我在画布上使用这些图像，但我猜它们会相似。在做动画等时，不在 GL 中也很重要。我不得不重做我当前的游戏，因为当我以较小的 dpi 玩它时，它移动得如此之快，就像闪电一样！在 180 和 240 上移动 10 个像素令人大开眼界。

# c# - 当他/她的用户名被另一个用户更改时，如何强制注销用户？

> ID：12379215
> 
> 赞同：13
> 
> 时间：2012-09-11T23:16:34.893
> 
> 标签：c#, asp.net-mvc, forms-authentication

在我的应用程序中，我使用 Forms-Authentication 来登录和注销用户。

一项功能是管理员可以更改其他用户的用户名。在这种情况下，我需要注销用户名已更改的用户。

如果我不这样做，由于他们之前设置的 cookie，他们可以访问应用程序并收到错误消息（因为他们的用户名不存在，并且有些部分我使用他们的用户名来实现某些功能）。

如何强制这些用户使用 Forms-Authentication 注销？

**更新 ：**

```
 public override void OnActionExecuting(ActionExecutingContext filterContext)
    {
        string controller = filterContext.RouteData.Values["controller"].ToString();
        string action     = filterContext.RouteData.Values["action"].ToString(); ;
        // Below returns the previous username, which does not exist anymore in db.
        string userName = HttpContext.Current.User.Identity.Name;

        UnitOfWork unitOfWork = new UnitOfWork();

        if (!unitOfWork.UserRepository.UserExists(userName))
        {
            FormsAuthentication.SignOut();
            filterContext.HttpContext.Session.Clear();
            filterContext.HttpContext.Session.Abandon();
            // I am not using Roles.

        }
        unitOfWork.Dispose();
        base.OnActionExecuting(filterContext);

    } 
```

在我的客户全局过滤器中，我检查用户是否存在，如果不存在，我将其注销。但是，它不起作用。通过工作，我的意思是他们通过了身份验证并获得了对应用程序的访问权限。

提前致谢。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-09-12T00:44:56.823

以下是强制用户退出的操作：

```
public void UserPasswordChangedHandler()
{
  FormsAuthentication.SignOut();
  Roles.DeleteCookie();
  Session.Clear();
} 
```

我认为不需要逐行解释，它的自我解释就足够了。如果我弄错了，请告诉我。

**更新**

对您的附加问题的直接回答是保持每个用户的布尔跟踪，如果他的数据由管理员更新，如果是，只需将他重定向到登录页面。

有关使用表单身份验证信息强制注销的信息，请参阅以下文章：

*   [如何强制用户注销](http://forums.asp.net/t/1839900.aspx/1)
*   [如何强制注销网站的所有用户](https://stackoverflow.com/questions/5488547/how-can-i-force-a-log-out-of-all-users-for-a-website)，
*   [ASP.NET 表单身份验证强制注销](http://forums.asp.net/t/1623873.aspx/1)
*   [如何注销不是当前用户的多个 MembershipUser](https://stackoverflow.com/questions/4600109/how-to-log-off-multiple-membershipusers-that-are-not-the-current-user)

**更新 2**

清除 cookie

*   [HowTo：使用 ASP.NET MVC 创建和删除 Cookie](http://code-inside.de/blog-in/2010/10/19/howto-create-and-remove-cookies-with-asp-net-mvc/)
*   [如何在 ASP NET MVC 3 和 C# 中清除 cookie](https://stackoverflow.com/questions/5122404/how-do-you-clear-cookies-using-asp-net-mvc-3-and-c)
*   [如何使错误的身份验证 cookie 无效](https://stackoverflow.com/questions/10419880/how-do-i-invalidate-a-bad-authentication-cookie-early-in-the-request)

希望这对您有所帮助。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-11T23:35:04.523

当用户需要失效时，您必须将他们的详细信息添加到某种内部静态列表中。

然后在每个页面请求（可能使用 Application_BeginRequest）上查看当前用户是否在该列表中，如果是，则在此调用 FormsAuthentication.SignOut。

这似乎有点像黑客，但这是我现在能想到的最好的。

请注意，删除缺席用户的会话状态完全是另一个问题。

# c - C语言中的hadoop hdfs客户端

> ID：12379219
> 
> 赞同：2
> 
> 时间：2012-09-11T23:16:50.470
> 
> 标签：c, hadoop, hdfs

问题与 C 中 hdfs 客户端的设计和实现有关。libhdfs 页面[http://hadoop.apache.org/docs/r1.0.3/libhdfs.html](http://hadoop.apache.org/docs/r1.0.3/libhdfs.html)提到客户端使用 JNI 接口。谁能解释为什么 C 客户端使用 JNI。客户端需要做的就是在运行在datanode和namenode上的java程序中调用一个远程方法，它可以通过以datanode期望的方式序列化方法调用来实现。将 JNI 用于如此琐碎的事情是令人困惑的。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-25T12:56:53.753

HDFS 完全用 Java 实现，并使用 Java 语言和 API 的几个特性来提高性能并易于编程。Hadoop RPC 协议使用起来非常简单，因为它可以在[这里](http://www.supermind.org/blog/520)。简单性来自于 Hadoop 使用[`Proxy`](http://docs.oracle.com/javase/6/docs/api/java/lang/reflect/Proxy.html) 类来拦截调用，并与`Writable`接口一起将远程过程调用序列化到服务器端；轮到它打开包装并拨打电话。所以该协议在某种程度上依赖于Java。

另一方面，使用 JNI 开发 C 语言可以更轻松、更快速地实现和重用 Java 代码。而且更不容易出错，因为您不必处理诸如字节序或模仿 Java 行为之类的事情。

有一个使用[Apache Avro](http://avro.apache.org/docs/current/)的运动，它可以更容易地与其他语言绑定。到目前为止，它似乎处于搁置状态。

# mysql - SQL查询查找表的主键？

> ID：12379221
> 
> 赞同：24
> 
> 时间：2012-09-11T23:16:56.977
> 
> 标签：mysql, sql, sql-server, oracle

如何使用查询找到表的*主键是哪一列？*

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2012-09-11T23:20:04.797

这是一个重复的[问题](https://stackoverflow.com/questions/893874/mysql-determine-tables-primary-key-dynamically)：

这个答案归功于 Lukmdo：

可能不建议这样做，但效果很好：

```
show index from TABLE where Key_name = 'PRIMARY' ; 
```

可靠的方法是使用information_schema：

```
SELECT k.COLUMN_NAME
FROM information_schema.table_constraints t
LEFT JOIN information_schema.key_column_usage k
USING(constraint_name,table_schema,table_name)
WHERE t.constraint_type='PRIMARY KEY'
    AND t.table_schema=DATABASE()
    AND t.table_name='owalog'; 
```

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2012-09-11T23:25:38.333

对于 Oracle，您可以在[`ALL_CONSTRAINTS`](http://docs.oracle.com/cd/B28359_01/server.111/b28320/statviews_1044.htm)表中查找：

```
SELECT a.COLUMN_NAME
FROM all_cons_columns a INNER JOIN all_constraints c 
     ON a.constraint_name = c.constraint_name 
WHERE c.table_name = 'TBL'
  AND c.constraint_type = 'P'; 
```

**[演示](http://sqlfiddle.com/#!4/4409f/4)**。

对于 SQL Server，这里已经回答[了](https://stackoverflow.com/a/3942921/140816)，对于 MySQL，请查看[@ajon 的回答](https://stackoverflow.com/a/12379241/440294)。

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2016-02-29T11:12:26.963

对于 MySQL：

```
SELECT GROUP_CONCAT(COLUMN_NAME), TABLE_NAME
FROM INFORMATION_SCHEMA.KEY_COLUMN_USAGE
WHERE
  TABLE_SCHEMA = '**database name**'
  AND CONSTRAINT_NAME='PRIMARY'
GROUP BY TABLE_NAME; 
```

**警告**具有两列的主键将用逗号 ( `,`)分隔

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2012-09-12T02:45:23.107

在 SQL Server 中尝试此查询：

```
SELECT     X.NAME AS INDEXNAME,
           COL_NAME(IC.OBJECT_ID,IC.COLUMN_ID) AS COLUMNNAME
FROM       SYS.INDEXES  X 
INNER JOIN SYS.INDEX_COLUMNS  IC 
        ON X.OBJECT_ID = IC.OBJECT_ID
       AND X.INDEX_ID = IC.INDEX_ID
WHERE      X.IS_PRIMARY_KEY = 1
  AND      OBJECT_NAME(IC.OBJECT_ID)='YOUR_TABLE' 
```

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2015-06-09T06:26:43.347

以下查询给出了给定数据库中所有主键的列表。

```
SELECT DISTINCT TABLE_NAME ,column_name
    FROM INFORMATION_SCHEMA.key_column_usage
    WHERE TABLE_SCHEMA IN ('*your_db_name*'); 
```

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2018-09-27T12:22:14.427

在我的 SQL

```
SHOW COLUMNS FROM `table_name`; 
```

这显示了列的详细信息，即字段、数据类型、键等。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2021-02-26T14:03:44.733

这是更简单的方法：

```
DESC TABLE; 
```

它向您展示了 TABLE 的结构；

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2020-02-16T05:18:34.057

LEFT 加入 table_constraints 似乎需要更多时间。我使用 Information_schema.COLUMNS

SELECT TABLE_SCHEMA , TABLE_NAME , COLUMN_NAME 从 Information_schema.Columns WHERE COLUMN_KEY = "PRI" AND TABLE_SCHEMA = DATABASE()

* * *

## 回答 #9

> 赞同：-1
> 
> 时间：2020-08-02T10:09:46.540

**对于 MSSQL：** SELECT DISTINCT C.TABLE_NAME,C.COLUMN_NAME,C.DATA_TYPE FROM sys.indexes I INNER JOIN sys.index_columns IC ON I.OBJECT_ID = IC.OBJECT_ID AND I.INDEX_ID = IC.INDEX_ID INNER JOIN information_schema.columns C ON COL_NAME(IC.OBJECT_ID,IC.COLUMN_ID) = C.COLUMN_NAME 其中 I.IS_PRIMARY_KEY = 1

# heroku - 如何将 .php 文件上传到 Heroku

> ID：12379224
> 
> 赞同：2
> 
> 时间：2012-09-11T23:17:08.910
> 
> 标签：heroku

我需要将 .php 文件上传到我的 Heroku 网站。

这是如何使用终端完成的？我已登录终端，可以看到我的应用程序等...

谢谢你的帮助

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-14T17:42:29.533

如果您需要通过终端在 Heroku 应用程序上上传文件，您需要跟踪它并使用`Git`.

如果尚未完成，请安装和配置 heroku 工具带：[https ://devcenter.heroku.com/articles/quickstart](https://devcenter.heroku.com/articles/quickstart)

然后只需创建您的应用程序，开始跟踪您的文件并将它们推送到 heroku：

```
heroku create myapp
git init
git add .
git commit -m 'Initial commit'
git push heroku master 
```

# javascript - 使用 3d 矩阵确定条形宽度

> ID：12379226
> 
> 赞同：0
> 
> 时间：2012-09-11T23:17:27.687
> 
> 标签：javascript, d3.js

我的数据如下：

```
var data = [[-5,7,10],[10,15,25],[-18,-14,-6]];

var margin = {top: 0, right: 30, bottom: 80, left: 30},
        width = 180 - margin.left - margin.right,
        height = 295 - margin.top - margin.bottom;

var x0 = Math.max(-d3.min(data[0]), d3.max(data[2]));
var x = d3.scale.linear()
        .domain([-x0, x0])
        .range([0, width]);

var y = d3.scale.ordinal()
.domain(d3.range(data.length))
.rangeRoundBands([0, height], .2);

var svg = d3.select("body").append("svg")
    .attr("width", width + margin.left + margin.right)
    .attr("height", height + margin.top + margin.bottom)
  .append("g")
.attr("transform", "translate(" + margin.left + "," + margin.top + ")");

svg.selectAll(".bar")
        .data(data)
      .enter().append("rect")     
        .style("fill", "steelblue")
        .attr("x", function(d, i) { return x(Math.min(0, d[0])); })
        .attr("y", function(d, i) { return y(i); })
        .attr("width", function(d, i) { return Math.abs(x(d[2]) - x(d[0])); })
        .attr("height", y.rangeBand())
        .append("rect");

//y axis
svg.append("g")
.attr("class", "y axis")
.append("line")
.attr("x1", x(0))
.attr("x2", x(0))
.attr("y1", 0)
.attr("y2", height+10); 
```

我想要做的是创建一个条形图，其中`data[0]`是起点，`data[1]`有一条垂直线将条平分并且`data[2]`是条的最大值。到目前为止，我认为我正确地涵盖了前两个用例，但第三个用例失败了。有任何想法吗？

[http://jsfiddle.net/NPqEm/](http://jsfiddle.net/NPqEm/)

# c++ - 生成 Catmull Rom 样条并返回垃圾

> ID：12379229
> 
> 赞同：0
> 
> 时间：2012-09-11T23:17:52.700
> 
> 标签：c++, math, graphics, curves

创建我的 Catmull Rom Spline 后，例如：

```
vector3 SplineVector = newSpline.createCatmulRomSpline(vectorOne, vectorTwo, vectorThree, vectorFour, i); 
```

但是，当我从

```
vector3 SplineVector 
```

我得到垃圾值。

这是我的样条类的列表，我的 vector3 类的一部分以及在初始化中的实现。

**初始化：**

```
for(float i = 0.0f; i <= 1.0f; i += 0.1f)
    {
        vector3 SplineVector = newSpline.createCatmulRomSpline(vectorOne, vectorTwo, vectorThree, vectorFour, i);
        cout << "\n\ncurve pos X: " << SplineVector.getx();
        cout << "\ncurve pos Y: " << SplineVector.gety();
        cout << "\ncurve pos Z: " << SplineVector.getz();

    } 
```

**矢量3：**

```
 class vector3
   {
    public:
vector3::vector3():x(0),y(0),z(0)
{
}
vector3::~vector3()
{
}

vector3(float);
vector3(float inx,float iny,float inz): x(inx), y(iny), z(inz)
{   
}

//Vector operators
_inline vector3 operator=(const vector3& invec){ // Assignment
    return vector3(this->x=invec.x,this->y=invec.y,this->z=invec.z);
}   

_inline vector3 operator+(const vector3& invec){//Addition
    return vector3(this->x+invec.x,this->y+invec.y,this->z+invec.z);
}
_inline vector3 operator-(const vector3& invec){//Subtraction
    return vector3(this->x-invec.x,this->y-invec.y,this->z-invec.z);
}

_inline vector3 operator*(const vector3& invec){//Multiplication
    return vector3(this->x*invec.x,this->y*invec.y,this->z*invec.z);
}
_inline vector3 operator/(const vector3& invec){//Division
    return vector3(this->x/invec.x,this->y/invec.y,this->z/invec.z);
}

//Scaler operators
_inline vector3& operator+=(const float& scaler){//Addition self-assignment
    return vector3(this->x+=scaler,this->y+=scaler,this->z+=scaler);
}
_inline vector3& operator-=(const float& scaler){//Subtraction self-assignment
    return vector3(this->x-=scaler,this->y-=scaler,this->z-=scaler);
}
_inline vector3& operator*=(const float& scaler){//Multiplication self-assignment
    return vector3(this->x*=scaler,this->y*=scaler,this->z*=scaler);
}
_inline vector3& operator*(const float& scalar){
    return vector3(this->x*scalar, this->y*scalar, this->z*scalar);
}

//Math methods
_inline vector3 operator^(vector3& invec){//Cross product
    return vector3( (this->y*invec.z-this->z*invec.y),
                    (this->z*invec.x-this->x*invec.z),
                    (this->x*invec.y-this->y*invec.x));
}
_inline vector3 operator&(vector3& invec){//Dot product
    return (this->x*invec.x)+(this->y*invec.y)+(this->z*invec.z);
}
_inline vector3 distance(vector3&);//Distance

_inline void normalize(){
    float mag = sqrtf(this->x*this->x+this->y*this->y+this->z*this->z);
    this->x/=mag;
    this->y/=mag;
    this->z/=mag;
}

float x;
float y;
float z;

float getx();
float gety();
float getz();
float getMagnitude();
     private:

  float mag;
 }; 
```

**Catmull Rom 样条生成**

```
_inline vector3 createCatmulRomSpline(vector3 P0, vector3 P1, vector3 P2, vector3 P3, float t)
{

    float t2 = t*t;
    float t3 = t2*t;

    vector3 result = ((P1*2) + (P2 - P0) * t + (P0*2 - P1 * 5 + P2*4 - P3)*t2 + (P1*3 - P0- P2*3 + P3) * t3)*0.5f;
    return result;
} 
```

我尝试过其他人的代码，当将数据输出到最终向量时，它会输出虚假值。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-12T00:20:22.480

You had a number of things wrong with your operators, although most of them weren't used. I modified your class. I notice you have not shown your code for the `getx()` (etc) members. I implemented those inline, but perhaps they were responsible for the garbage? Here is the test program with my changes. It seems to work fine:

```
class vector3
{
public:
    vector3::vector3()
        :x(0), y(0), z(0)
    {}

    vector3::~vector3()
    {}

    vector3(float inx,float iny,float inz)
        : x(inx), y(iny), z(inz)
    {}

    //Vector operators
    _inline vector3& operator=(const vector3& invec) { // Assignment
        x = invec.x;
        y = invec.y;
        z = invec.z;
        return *this;
    }   
    _inline vector3 operator+(const vector3& invec) const {//Addition
        return vector3(x+invec.x,y+invec.y,z+invec.z);
    }
    _inline vector3 operator-(const vector3& invec) const {//Subtraction
        return vector3(x-invec.x,y-invec.y,z-invec.z);
    }
    _inline vector3 operator*(const vector3& invec) const {//Multiplication
        return vector3(x*invec.x,y*invec.y,z*invec.z);
    }
    _inline vector3 operator/(const vector3& invec) const {//Division
        return vector3(x/invec.x,y/invec.y,z/invec.z);
    }

    //scalar operators
    _inline vector3& operator+=(const float& scalar){//Addition self-assignment
        x+=scalar,y+=scalar,z+=scalar;
        return *this;
    }
    _inline vector3& operator-=(const float& scalar){//Subtraction self-assignment
        x-=scalar,y-=scalar,z-=scalar;
        return *this;
    }
    _inline vector3& operator*=(const float& scalar){//Multiplication self-assignment
        x*=scalar,y*=scalar,z*=scalar;
        return *this;
    }
    _inline vector3 operator*(const float& scalar) const {
        return vector3(x*scalar, y*scalar, z*scalar);
    }

    //Math methods
    _inline vector3 operator^(const vector3& invec) const {//Cross product
        return vector3( (y*invec.z-z*invec.y),
            (z*invec.x-x*invec.z),
            (x*invec.y-y*invec.x));
    }
    _inline float operator&(const vector3& invec) const {//Dot product
        return (x*invec.x)+(y*invec.y)+(z*invec.z);
    }
    _inline float distance(vector3&) const;//Distance

    _inline void normalize(){
        float mag = sqrtf(x*x+y*y+z*z);
        x/=mag;
        y/=mag;
        z/=mag;
    }

    float x;
    float y;
    float z;

    _inline float getx() const { return x; }
    _inline float gety() const { return y; }
    _inline float getz() const { return z; }
    float getMagnitude() const;
};

_inline vector3 createCatmulRomSpline(vector3 P0, vector3 P1, vector3 P2, vector3 P3, float t)
{
    float t2 = t*t;
    float t3 = t2*t;

    vector3 result = ((P1*2) + (P2 - P0) * t + (P0*2 - P1 * 5 + P2*4 - P3)*t2 + (P1*3 - P0- P2*3 + P3) * t3)*0.5f;
    return result;
}

int main() {    
    vector3 vectorOne(0,0,0);
    vector3 vectorTwo(5,10,1);
    vector3 vectorThree(10,10,2);
    vector3 vectorFour(15,0,3);

    const int ndiv = 10;
    for( int i = 0; i <= ndiv; i++ )
    {
        float t = (float)i / ndiv;
        vector3 SplineVector = createCatmulRomSpline(vectorOne, vectorTwo, vectorThree, vectorFour, t);
        cout << "curve pos X: " << SplineVector.getx() << "\n";
        cout << "curve pos Y: " << SplineVector.gety() << "\n";
        cout << "curve pos Z: " << SplineVector.getz() << "\n\n";
    }

    return 0;
} 
```

# android - 在安装了 2.2 和 4.1 sdks 的 4.0.3 设备上测试 Android 应用

> ID：12379231
> 
> 赞同：0
> 
> 时间：2012-09-11T23:18:30.110
> 
> 标签：android, eclipse

所以我一直在玩虚拟设备一段时间，开发一些 Android 应用程序。我在计算机上安装了 2.2 和 4.1 SDK，就像开发人员网站建议的那样（这包含了当今大多数手机）。

最近我购买了一部 Android 手机，HTC One XL，运行 Android 4.0.3，在尝试通过它运行我的应用程序时，系统找不到该设备。

我在寻找设备时摆弄了一下，但它说它正在 Android 设备选择器中搜索 4.1 设备。

手机处于调试模式，据我所知，安装了最新的驱动程序。

那么，有没有办法告诉 Eclipse 寻找具有较低操作系统的设备，或者我应该卸载 4.1 套件并安装 4.0.3？还是有更好的选择？

# r - 将稀疏距离的 CSV 转换为 Dist 对象 R 的有效方法

> ID：12379233
> 
> 赞同：1
> 
> 时间：2012-09-11T23:19:22.657
> 
> 标签：r, distance, sparse-matrix

我有一个非常大的 csv 文件（大约 9100 万行，所以 for 循环在 R 中花费的时间太长）关键字（大约 50,000 个唯一关键字）之间的相似性，当我读入 data.frame 时看起来像：

```
> df   
kwd1 kwd2 similarity  
a  b  1  
b  a  1  
c  a  2  
a  c  2 
```

这是一个稀疏列表，我可以使用 sparseMatrix() 将其转换为稀疏矩阵：

```
> myMatrix 
  a b c  
a . 1 2
b 1 . .
c 2 . . 
```

但是，现在我想将其转换为 dist 对象。我尝试了 as.dist(myMatrix)，但得到的错误是 as.dist() 的“问题太大”。我还尝试使用 myMatrix = myMatrix * lower.tri(myMatrix) 将稀疏矩阵转换为下三角稀疏矩阵，然后转换为 dist 对象（认为这可能会更好），但随后我遇到了同样的错误，但对于较低的.tri 函数。

谢谢你的帮助！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-12T08:03:34.857

类的对象`"dist"`是稠密的对象。要从稀疏表示开始，需要一个大约为

```
R> 0.5*(91000000*90999999)
[1] 4.1405e+15 
```

元素（给或取对角线）。在 R 中，向量的最大长度为 2^31 - 1：

```
R> 2^31 - 1
[1] 2147483647 
```

这比存储密集`"dist"`对象所需的元素数量要小得多，因此不可能，这就是`dist()`. 出于类似的原因，您将无法将数据的下三角形版本存储为密集对象，因为它也被保存为具有相同长度限制的向量。

在这一点上，我认为您需要更多地解释实际问题以及您想要差异对象的目的（在另一个问题中！）？*您是否需要 9100 万个对象之间的所有差异，或者您是否可以从中获得一个适合 R 向量当前*长度限制的样本？

# javascript - 从多文件输入中删除元素

> ID：12379235
> 
> 赞同：4
> 
> 时间：2012-09-11T23:19:29.553
> 
> 标签：javascript, jquery, html, jquery-ui

我可以使用文件输入标签上的多个属性来选择多个文件。但是我想知道如何删除单个元素。

我知道你不能自己操作文件输入，因为它是一个安全漏洞，浏览器不允许这样做，但我想向你指出 jquery 上传插件：[https ://github.com/blueimp/ jQuery-文件-上传](https://github.com/blueimp/jQuery-File-Upload)。

该插件允许您删除单个元素，那里没有闪光灯。一切都是 javascript 和 html5 api！

哦，我知道uploadify，我只想保留纯js和html文件api。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-12T00:19:09.240

# xml - 如何在 SQLServer 2008R2 中跨多行查询 xml

> ID：12379236
> 
> 赞同：3
> 
> 时间：2012-09-11T23:19:36.543
> 
> 标签：xml, tsql, sql-server-2008-r2, xquery

在一个表中，我有多行，每行都包含基于通用模式的 xml。XML 的一个示例可能是：

```
<Items>
    <Item>Item 1</Item>
    <Item>Item 2</Item>
</Items> 
```

如果我在一个表中有多行，都包含类似的 xml，是否可以编写一个查询`Item`，在单个结果集中返回所有行的节点中的所有值？我们正在使用 SQL Server 2008 R2

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-12T00:03:16.287

如果您的 xml 在`XML`列中定义..

```
DECLARE @Items AS TABLE 
(
    ItemXml XML
)

-- test data with a couple rows of xml
INSERT INTO @Items(ItemXml)
VALUES ('<Items><Item>Item 1</Item><Item>Item 2</Item></Items>')
      ,('<Items><Item>Item 3</Item><Item>Item 4</Item></Items>')

-- the query
SELECT t.i.value('.','VARCHAR(8000)') AS Item
FROM @Items CROSS APPLY ItemXml.nodes('/Items/Item') t(i) 
```

会给你

```
Item
------
Item 1
Item 2
Item 3
Item 4 
```

这里的关键是[`nodes()`](http://msdn.microsoft.com/en-us/library/ms188282(v=sql.105))哪个

> 当您想要将 xml 数据类型实例分解为关系数据时很有用。它允许您识别将映射到新行的节点。

# java - 新对象（..）中的 HQL 新列表（..）

> ID：12379238
> 
> 赞同：0
> 
> 时间：2012-09-11T23:19:39.693
> 
> 标签：java, hibernate, object, hql

我有一个要求，我想在 HQL 查询中创建一个新对象。在 new Object 构造函数中要提供的参数之一是一些其他对象的列表。

例如：

```
SELECT new Object1(a.id, new List(SELECT b FROM table2 AS b WHERE b.id>0)) FROM table1 AS a; 
```

所以我会得到一个 Object1 类型的对象，它有一个从另一个表中检索到的列表。

请帮忙..

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-12T14:32:53.507

你不能像你计划的那样在一个声明中做到这一点。换一种方式思考。有一些可能性。

1.  创建 Object1 到 table1 和 Object2 到 table2 的映射。在 Object1 的映射中，您创建与 Object2 的一对多关系，该关系包含`"WHERE Object2.id>0"`您选择的 where 条件。那么你只需要 HQL 语句`"from Object1"`。
    这是最好的和最具休眠风格的可能性，但它仅在 where 条件始终相同的情况下才有效。然后您需要 table1 和 table2 之间的数据库关系（您的示例中没有，但可能存在，您只是在示例中忘记了它）。

    或者

2.  您只需首先加载 table1 `SELECT new Object1(a.id) FROM Table1 a`，然后在此列表的所有元素上循环加载第二个表`FROM table2 b WHERE b.id>0`并将其放入 Object1 类型的元素中。

    或者

3.  您只首先加载 table1 `SELECT new Object1(a.id) FROM Table1 a`，在 Object1 中您有一个方法，该方法`getObject2List()`在第一次调用时加载 table2 中的元素列表。

# c++ - PlaySound() 播放但听不到 c++

> ID：12379240
> 
> 赞同：0
> 
> 时间：2012-09-11T23:19:50.160
> 
> 标签：c++, speaker, playsound

我使用playsound，它在我的笔记本电脑上可以正常工作，但在我的电脑上却无法正常工作。播放声音时，我会检查音量大小，它会上下波动。但我听不到任何声音。

请注意，我的 PC 扬声器使用正常。

# c# - 在 C# 早期使用浮动花括号释放变量

> ID：12379244
> 
> 赞同：2
> 
> 时间：2012-09-11T23:20:13.033
> 
> 标签：c#, optimization, coding-style, garbage-collection, curly-braces

C# 变量在声明类型的地方实例化（例如`string s;`）并在当前范围的右大括号处释放：

```
// Operates with Q memory
void FantasyMethod() {
    var o = new BigObject();

    {
        var temp = new BigObject();
        Populate(temp); // Populates o1 with N megabytes of data

        o = PerformSomeOperationsOn(temp); // Returns a BigObject of size M (M is close to N)

        // Currently, M+N memory is occupied, we have Q-M-N free
    }

    // Let's tell the garbage collector to catch up
    GC.Collect();
    GC.WaitForPendingFinalizers();

    // Currently, M memory is occupied

    DoUsefulStuffWith(o); // This method can only work if at least Q-M-N/2 memory is free
} 
```

这样做的一个好处是我可以在函数返回之前释放大变量。在上面的（微不足道的）块中，我通过在不再需要一个大变量时立即处理我有限的可用内存。

1.  以上是正确的吗？
2.  这样做是个好主意吗（我对赞成和反对的论点感兴趣，而不是个人意见或偏好）？提取裸括号块作为一种方法会降低内存使用效率吗？如果出于可读性原因我不想制作新方法怎么办？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-11T23:24:23.263

> 这样做的一个好处是我可以在函数返回之前释放大变量。

不。C# 不是 C++，对象没有析构函数，并且您不能保证对象在离开其声明范围并且不存在对它的有效引用时会被回收。

如果您需要那种级别的可预测性，那么您不应该使用托管语言。确实存在有助于减轻 C# 中的内存压力的技术，但它们并不经常需要，而且您永远无法获得像 C 或 C++ 这样的语言所提供的控制级别。

根据您的编辑：

[GC.Collect](http://msdn.microsoft.com/en-us/library/xe0c2357.aspx)将*尝试*运行 GC 通行证，但不能保证。 [GC.WaitForPendingFinalizers](http://msdn.microsoft.com/en-us/library/system.gc.waitforpendingfinalizers.aspx)阻塞，直到所有标记为终结器的对象都运行了它们的终结器。

> 如果一个对象实现了终结器并且没有通过调用 SuppressFinalize 禁用终结器，则该对象将被放置在标记为准备终结的对象列表中。垃圾收集器为此列表中的对象调用 Finalize 方法并从列表中删除条目。此方法会阻塞，直到所有终结器都运行完成。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-11T23:29:34.277

你的假设并不完全正确。与 C++ 不同，对象在超出范围时不会立即被销毁（或者如果我们想学究气，请调用析构函数）。所有可以保证的是，如果在绝对没有引用指向封闭范围内实例化的对象的情况下发生 GC 扫描，则该对象将被*收集*。

即使您没有将对象的使用包含在显式范围内，编译器也已经有足够的信息来“知道”该对象无论如何都没有被使用/引用，因此您不会有任何好处。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-11T23:25:18.770

这是不正确的，假设`BigObject`不是值类型。如果`BigObject`是一个类，那么它将始终存在于托管堆中，并且在超出范围后不会被确定性地处理掉。GC 在另一个线程中运行，您无法预测它何时会进行收集。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-11T23:28:24.713

我从未听说将变量放在块内会释放变量。还有你说的释放是什么意思？内存由垃圾收集器管理，它将决定何时释放内存。

如果“变量”持有资源，那么它应该实现 IDisposable；[http://msdn.microsoft.com/en-us/library/system.idisposable.aspx](http://msdn.microsoft.com/en-us/library/system.idisposable.aspx)），你应该是：

```
using (var b = new DisposableObject())
{
   ...
} 
```

# jquery - 是什么导致 url 中的哈希 (#) 消失？

> ID：12379247
> 
> 赞同：2
> 
> 时间：2012-09-11T23:21:13.527
> 
> 标签：jquery, html

在带有 url 的页面上，例如`mypage.php#tab3`具有如下所示的链接：

![在此处输入图像描述](../Images/04f1c51b323ba6d5519c7cd4cb788fc4.png)

单击添加结果中的 url 缩短到`mypage.php#`

添加代码：

```
function addComment(i) {
    var s = document.getElementById(i);

    s.innerHTML = '';
    $('#'+i).attr('style','width:164px;padding-right:5px');
    $('#'+i).append('<input type="text" id="ci'+i.substr(3)+'" style="width:162px;padding:0 3px" value=\'Enter comment here\' onclick=\"\" onblur="storeComment('+i.substr(3)+');">');
    return false;
} 
```

我添加了一些中断，并且在 return false 语句**之后散列消失了。**

尝试了不成功的更改：

1.  有和没有 onclick
2.  有无返回 false

编辑：问题出在链接代码中。

```
<a href="#" onclick="addComment('com94');">Add</a> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-12T14:26:22.680

您基本上需要`false`在 onclick 处理程序中返回以防止执行链接的默认操作（转到`href`）。

```
<a href="#" onclick="addComment('com94');return false;">Add</a> 
```

或者，由于您的`addComment()`函数已经返回`false`，只需将其委托给它。

```
<a href="#" onclick="return addComment('com94');">Add</a> 
```

顺便说一句，这不是 jQuery 问题，它只是基本的 HTML。

# svn - SVN与设计师

> ID：12379250
> 
> 赞同：0
> 
> 时间：2012-09-11T23:21:45.603
> 
> 标签：svn

我有一个svn控制的项目，现在我想在项目中包含一个设计器，修改一些css文件和html。最好的选择是什么，这样他就不必下载完整的项目、在本地运行服务器、检查 php 配置等？或者也许他不应该使用 svn 并把 html/css 文件交给我？

# java - Java - 不在多线程程序中循环

> ID：12379253
> 
> 赞同：4
> 
> 时间：2012-09-11T23:22:08.537
> 
> 标签：java, multithreading

我仍然是一个 java 新手，正在尝试学习线程。我的问题是它不会循环 5 次。它运行一次并退出。我正在使用 a.class 锁定类对象，这样两个线程都锁定在同一个对象监视器上。

```
class a implements Runnable {
  Thread thr;
  int count;
  String time;

  a(String s) {
    thr = new Thread(this, s);
    thr.start();
  }

  public void run() {
    count++;

    if (Thread.currentThread().getName().compareTo("one") == 0) {
      synchronized (a.class) {

        try {
          for (int i = 0; i < 5; i++) {
            System.out.println("Now running thread " + Thread.currentThread().getName() + " with count " + count);

            time = "Tick";
            System.out.println(time);
            notify();

            while (time == "Tock") {
              wait();
            }
          }
        } catch (Exception e) {
        }

      }
    } else if (Thread.currentThread().getName().compareTo("two") == 0) {
      synchronized (a.class) {
        try {
          for (int j = 0; j < 5; j++) {
            System.out.println("Now running thread " + Thread.currentThread().getName() + " with count " + count);

            time = "Tock";
            System.out.println(time);
              notify();

            while (time == "Tick") {
              wait();
            }
          }
        } catch (Exception e) {
        }
      }
    }
  }
}

public class b {
  public static void main(String args[]) {

    a obj1 = new a("one");
    a obj2 = new a("two");
  }
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-17T19:32:07.300

给你，用原始代码：

```
class a implements Runnable {
    Thread thr;
    int count;
    static String time = "Tock";

    a(String s) {
        thr = new Thread(this, s);
        thr.start();
    }

    public void run() {
        count++;

        if (Thread.currentThread().getName().compareTo("one") == 0) {
            synchronized (a.class) {

                try {
                    for (int i = 0; i < 5; i++) {
                        while (time.equals("Tock")) {
                            a.class.wait();
                        }

                        System.out.println("Now running thread "
                                + Thread.currentThread().getName()
                                + " with count " + count);

                        time = "Tock";
                        System.out.println(time);
                        a.class.notify();                       
                    }
                } catch (Exception e) {
                    e.printStackTrace();
                }

            }
        } else if (Thread.currentThread().getName().compareTo("two") == 0) {
            synchronized (a.class) {
                try {
                    for (int j = 0; j < 5; j++) {
                        while (time.equals("Tick")) {
                            a.class.wait();
                        }

                        System.out.println("Now running thread "
                                + Thread.currentThread().getName()
                                + " with count " + count);

                        time = "Tick";
                        System.out.println(time);
                        a.class.notify();                       
                    }
                } catch (Exception e) {
                    e.printStackTrace();
                }
            }
        }
    }
}

public class Test {
    public static void main(String args[]) {

        a obj1 = new a("one");
        a obj2 = new a("two");
    }
} 
```

问题是你在隐式对象上调用`wait`and ，当锁被对象持有时，因此你必须调用on 。就是这样。`notify``this``a.class``wait/notify``a.class`

我还做了一个小的重组，因为我假设您希望它们以交替顺序打印，对吗`Tick`？`Tock`

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-11T23:24:53.467

在比较字符串（和一般的对象）时，您应该使用`equals`而不是`==`（通常为原语保留）`while(time.equals("Tock"))`：. `==`on strings 通常会导致`false`您希望它（并认为它应该）返回`true`，因此您的循环将在预期之前退出。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-09-11T23:57:03.670

为什么你只循环一次的答案是你调用`notify()`了一个未锁定的对象，因此`IllegalMonitorStateException`被空的 catch 语句抛出并捕获。

这是一种方法。并不是说它是最好的。我试图让它靠近你的代码：

```
public class TickTock {
    static final int N = 4;

    Object lock = new Object();
    int token;

    class Worker extends Thread {
        int id;

        Worker(int id) {
            this.id = id;
        }

        @Override
        public void run() {
            try {
                synchronized (lock) {
                    for (int i = 0; i < 5; i++) {
                        while (id != token%N) lock.wait();

                        System.out.println(id + " " + i);

                        token++;
                        lock.notifyAll();
                    }
                }
            } catch (InterruptedException e) {
                e.printStackTrace();
            }
        }
    }

    void start() {
        for (int i = 0; i < N; i++) {
            new Worker(i).start();
        }
    }

    public static void main(String[] args) {
        new TickTock().start();
    }
} 
```

# gwt - 具有多个入口点的 GWT MVP

> ID：12379256
> 
> 赞同：1
> 
> 时间：2012-09-11T23:22:26.540
> 
> 标签：gwt, mvp

我们有一个具有多个入口点的应用程序。每个 EntryPoint 都包含一个 MVP 配置，其中包含自己的 PlaceHistoryHandler、PlaceHistoryMapper 和 PlaceController。根据配置历史处理程序的顺序，位置处理是重叠的。我认为问题是因为 PlaceHistoryHandler 的实现在 PlaceHistoryMapper 找不到地点时调用 PlaceController.goTo(NOWHERE) 引起的，因为这个地点与另一个入口点的 PlaceHistoryMapper 相关联。我该如何解决这个问题？将 MVP 与多个 EntryPoints 一起使用是否正确？

**更多信息**

托马斯，感谢您的澄清。我们的风景是一个服务器端的 OSGI 应用程序，其中应用程序模块是热部署的，并且包含它们自己的 GWT 视图和入口点。我们的主客户端 GWT 应用程序有一个动态侧边菜单，其中的超链接指向与在主区域中呈现视图的外部 EntryPoints 相关联的令牌。

```
 SIDE MENU
      |
      V
  -------------------------------------------
  |  A1  |                                  |
  |------|                                  |
  |  A2  |                                  |
  |------|                                  |
  |  B1  |                                  |
  |------|         MAIN REGION              |
  |  B2  |                                  |
  |------|                                  |
  |  C1  |                                  |
  |------|                                  |
  |  C2  |                                  |
  ------------------------------------------- 
```

解决此类应用程序的正确方法是什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-12T12:24:42.633

你有两个选择：

（一个）

不要将 PlaceController 用于侧边菜单。使其成为一个小部件，其中包含指向模块中位置的链接。您可以在每个模块中包含此小部件。单击菜单项时，将重新加载整个页面。这样浏览器历史记录将按预期工作。

(乙)

如果您无法重组您的应用程序，请考虑使用启动板/开始菜单方法。您使用单个视图创建主入口点，该视图显示用户可用的应用程序的漂亮菜单。每个菜单项基本上都是指向相应模块（入口点）的起始 URL 的链接。当用户点击它时，这个模块会加载并占据整个屏幕。我还将为每个模块添加一个图标以返回启动板。

通过这种方式，用户可以为启动板添加书签，也可以直接为任何模块添加书签。

请注意，在这种方法中，URL 历史记录将按预期工作，即如果用户进入 Launchpad -> A1 -> A2 -> Launchpad -> B1 等，用户可以点击后退按钮，浏览器将后退一步。

或者，每个模块都可以在新的浏览器选项卡中打开。也许您可以让用户在首选项中的某处选择相同的选项卡或新选项卡。

请注意，智能手机和平板电脑的所有用户都熟悉 Launchpad/开始菜单方法，Mac OS 以及很快的 Windows 8 也使用了该方法。另一个好处是每个模块/应用程序都有更多的屏幕空间可以使用。

# mysql - 在 Perl/MySQL (FreeBSD) 中检测挂起的进程

> ID：12379257
> 
> 赞同：3
> 
> 时间：2012-09-11T23:22:42.860
> 
> 标签：mysql, perl, apache, freebsd, dbi

我有一个在 FreeBSD/Apache 系统上运行的 Perl 脚本，它通过 DBI 对 MySQL 数据库进行一些简单的查询。服务器相当活跃（每天 15 万页），并且每隔一段时间（最多一分钟一次）就会导致进程挂起。我怀疑文件锁可能会阻止读取，或者可能是 SQL 调用，但我无法弄清楚如何获取有关挂起过程的信息。

Per Practical mod_perl 这听起来像是识别让我头疼的操作的方法是系统跟踪、perl 跟踪或交互式调试器。我收集系统跟踪是 FreeBSD 上的 ktrace，但是当我附加到顶部的一个挂起进程时，进程被杀死后的唯一输出是：

```
50904 perl5.8.9 PSIG  SIGTERM SIG_DFL 
```

这对我不是很有帮助。任何人都可以提出更有意义的方法吗？我在 Unix 管理员方面并不是非常先进，所以如果我听起来很愚蠢，您的耐心将不胜感激...... :o)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-23T19:29:40.757

Ktracing 只为您提供系统调用、信号 I/O 和 namei 处理。而且它会非常快速地生成*大量*数据。因此，找出麻烦点可能并不理想。

如果您可以看到脚本的标准输出，请在代码中围绕可疑的问题点放置一些策略性地放置打印语句。然后运行程序应该显示您是否发生了挂起：

```
print "Before query X"
$dbh->do($statement)
print "After query X". 
```

如果您看不到标准输出，请使用例如[Sys::Syslog](http://search.cpan.org/~saper/Sys-Syslog-0.32/Syslog.pm) perl 模块，或调用 FreeBSD 的`logger(1)`程序将调试信息写入日志文件。将它封装到一个`debug()`函数中并使用它或打印语句可能是最简单的。

**编辑：**如果您不想在磁盘上进行大量日志记录，请将日志记录信息写入套接字（Sys::Syslog 支持使用`setlogsock()`），然后编写另一个脚本以从该套接字读取并将调试文本转储到终端，以接收数据的时间为前缀。一旦程序挂起，您就可以看到它在做什么。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-23T20:13:26.663

如果我理解正确，您的 Perl 进程在查询 MySQL 时挂起，而 MySQL 本身仍然可以运行。MySQL 服务器为此具有嵌入式故障排除功能，即[log_slow_queries](https://dev.mysql.com/doc/refman/5.0/en/server-options.html#option_mysqld_log-slow-queries)选项。将以下几行放入您`my.cnf`的技巧中：

```
[mysqld]
log_slow_queries = /var/log/mysql/mysql-slow.log
long_query_time = 10 
```

之后，重新启动或重新加载 MySQL 守护程序。让服务器运行一段时间以收集统计数据并分析发生了什么：

```
mysqldumpslow -s at /var/log/mysql/mysql-slow.log | less 
```

在我的一台服务器上，最高记录（`-s at`按平均查询时间排序，顺便说一句）是：

```
Count: 286  Time=101.26s (28960s)  Lock=14.74s (4214s)  Rows=0.0 (0), iwatcher[iwatcher]@localhost
  INSERT INTO `wp_posts` (`post_author`,`post_date`,`post_date_gmt`,`post_content`,`post_content_filtered`,`post_title`,`post_excerpt`,`post_status`,`post_type`,`comment_status`,`ping_status`,`post_password`,`post_name`,`to_ping`,`pinged`,`post_modified`,`post_modified_gmt`,`post_parent`,`menu_order`,`guid`) VALUES ('S','S','S','S','S','S','S','S','S','S','S','S','S','S','S','S','S','S','S','S') 
```

FWIW，它是一个拥有超过 30K 帖子的 WordPress。

# java - 调用重新实例化的异步任务失败并显示“任务已执行”

> ID：12379262
> 
> 赞同：1
> 
> 时间：2012-09-11T23:23:09.703
> 
> 标签：java, android, android-asynctask

我有一个搜索任务，当第二次单击该按钮时，它会取消当前正在运行的任务并重新创建它。

```
if (_searchAsyncTask != null) {
    // cancel if already running
    _searchAsyncTask.cancel(true);
}
_searchAsyncTask = new SearchAsyncTask(this);
_searchAsyncTask.execute(data); 
```

这在上述代码的最后一行失败，就好像我再次调用了原始异步任务一样。

```
java.lang.IllegalStateException: Cannot execute task: the task has already been executed (a task can be executed only once) 
```

我错过了什么吗？我需要等到原始实例 isCancelled() 吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-11T23:51:49.563

最近我遇到了一个奇怪的问题，当它从后台恢复时出现类似的异常，并且当它进入后台时任务已经运行到一半。我改用 AsyncTask.executeOnExecutor 来解决这个问题（一些代码可能是多余的）：

```
if (_searchAsyncTask == null) {
    _searchAsyncTask = new SearchAsyncTask();
}

if (mThreadExecutor != null && !mThreadExecutor.isShutdown()) {
    mThreadExecutor.shutdownNow();
}

if (mThreadExecutor == null || mThreadExecutor.isShutdown()) {
    mThreadExecutor = Executors.newSingleThreadExecutor();
}

if (_searchAsyncTask.getStatus() != Status.RUNNING) {
    _searchAsyncTask.executeOnExecutor(mThreadExecutor);
} 
```

这解决了我的问题。你可能想试一试...？

# puppet - Augeas 无法将节点设置为另一个节点的值？

> ID：12379263
> 
> 赞同：2
> 
> 时间：2012-09-11T23:23:11.050
> 
> 标签：puppet, augeas

在尝试学习 augeas 配置文件语言的过程中，我设置的第一个真正的任务是复制我的 grub.conf 的第一个块，并在副本中添加一个“单个”内核参数。

在执行此操作时，我浏览了文档，但找不到允许您获取树中另一个节点的值的表达式（如函数或运算符或其他东西）。你知道，像 C 中的星号 (*) 用于间接，这样你就可以将值复制到树的另一部分。

我确定如果我使用的是 C API，我将能够获得该值，但我主要是从 puppet 中调用它，所以它更像是通过 augtool 使用它。

我是疯了还是它真的是语言的一部分而我只是看不到它？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-12T04:31:12.720

目前无法仅使用 Augeas 语言将节点的值复制到另一个节点。

为了在 Puppet 中实现这一点，您需要在处理目录之前检索值，以便使用目录中的值。这样做需要写一个事实。

基于 Augeas 创建事实的最简单方法是使用[augeasfacter](https://github.com/camptocamp/puppet-augeasfacter)，它可以让您使用简单的配置文件轻松创建新事实。

创建新事实后，您可以像使用任何其他变量一样在 Puppet 中使用它的值。特别是，您可以使用它来设置使用`augeas`类型的节点。

# asp.net - 从 ASP.NET MVC 4 中的部分或编辑器模板触发包包含

> ID：12379266
> 
> 赞同：2
> 
> 时间：2012-09-11T23:23:30.377
> 
> 标签：asp.net, .net, asp.net-mvc-4, bundle, asp.net-optimization

我正在 ASP.NET MVC 4 之上构建一个框架。我喜欢 MVC4 中的新捆绑功能，但我遇到了一个问题，我不确定新的捆绑功能是否能解决这种情况。

我的布局视图在之前的页面底部呈现它的脚本包`</body>`。

由于我的项目是一个框架，因此视图不知道页面需要的所有捆绑包。我的项目正在大量使用编辑器模板，它可能需要包含一些 javascript，但无法在编辑器模板本身中呈现它，因为：

*   脚本只需要包含一次，并且编辑器模板可能会多次呈现。
*   该脚本可能依赖于尚未包含的其他 javascript 库，例如 jQuery（它们呈现在页面底部）。

所以，我想做的是在编辑器模板中这样的事情：

```
@Scripts.TriggerInclusion("~/path/to/bundle/that/this/editor/needs") 
```

这将导致捆绑脚本标签仅在页面末尾呈现一次。

我可以不厌其烦地将它构建到我的项目的基础设施中，但我希望这种东西已经以某种方式得到支持。谢谢！

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-10-16T18:00:50.727

我自己滚动。它很容易构建并且对我来说效果很好。

[https://github.com/ronnieoverby/MvcAssetManager/blob/master/MvcAssetManager/Infrastructure/AssetManager.cs](https://github.com/ronnieoverby/MvcAssetManager/blob/master/MvcAssetManager/Infrastructure/AssetManager.cs)

可能有一些错误，我没有太多使用它，因为我的大多数项目仍然是 MVC3。但是我用过的很少，它就成功了。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-09-11T23:47:30.253

这是我们在积压工作中跟踪的内容，它是一个相当复杂的功能，所以我们可能不会在几个版本中使用它。

我们早期的想法基本上是：

*   允许注册命名资产，即 Assets.Register("jquery").Include("~/scripts/jquery.js")
*   允许在包中按名称包含资产
*   添加`Scripts.Requres("jquery")`类似于 TriggerInclusion 的内容，它基本上在页面上注册 jquery 资产。
*   类似的东西`Scripts.RenderRegistered()`会在您选择的位置呈现您页面上所有已注册的脚本，并且还会对资产进行重复数据删除等。

我们不确定此功能的优先级有多高，所以如果这是您真正想要的东西，我在[这里的 codeplex 网站](http://aspnetoptimization.codeplex.com/workitem/26)上创建了一个问题，投票给它。

# jsf - 动态 JSF 复合组件样式/渲染

> ID：12379271
> 
> 赞同：1
> 
> 时间：2012-09-11T23:24:14.293
> 
> 标签：jsf, rendering, stylesheet, composite, composite-component

我对复合组件有一点问题。该组件的实现如下所示：

```
<composite:implementation>
    <h:outputStylesheet name="foo.css" library="bar"/>

    <div id="#{cc.clientId}">
        <composite:insertChildren/>
    </div>
</composite:implementation> 
```

它被动态地包含在一个 facelet 页面中，该页面包含这个带有 JSTL 核心标签的组件。facelet 页面类似于以下页面。

```
<h:panelGroup id="viewport" layout="block">
    <c:if test="#{controller.object != null}">
        <c:forEach items="#{controller.object.elements}" var="element">
            <c:if test="#{element.type == 'type1'}">
                <my:componentTypeOne id="#{element.id}"/>
            </c:if>

            <c:if test="#{element.type == 'type2'}">
                <my:componentTypeTwo id="#{element.id}"/>
            </c:if>
        </c:forEach>
    </c:if>
</h:panelGroup> 
```

因此，当我只渲染`viewport`页面时，组件被渲染，但没有在复合组件中定义样式表`my:component`。有没有办法在不渲染整个页面的情况下即时包含样式表？

**编辑：**示例代码的扩展..

# php - 这个“过程”叫什么，所以我可以研究它？

> ID：12379275
> 
> 赞同：0
> 
> 时间：2012-09-11T23:24:34.823
> 
> 标签：php

我想对此进行一些研究并了解它，但我不知道它叫什么或搜索什么。基本上我想做的是使用PHP基本上自动填写另一个页面上的表格。假设它转到 Facebook.com，登录文本框名为“用户名”。我想知道如何按它们的名称按下按钮并按它们的名称在文本框中输入文本。这会叫什么？谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-11T23:29:11.500

它被称为屏幕截图。

您可以通过下载页面的原始 HTML，然后浏览 HTML 的结构（通常使用 DOM 库，PHP 有一个，请参阅[http://php.net/manual/en/book.dom.php](http://php.net/manual/en/book.dom.php)）来实现。要提交表单，您需要制作一个 HTTP POST 请求，然后下载结果。

如果您提交的是“已知”表单，那么您可以省略下载原始 HTML 表单的第一步，因为您的程序已经知道要提交的字段是什么。

一个更复杂的版本（绕过使用客户端脚本以防止琐碎的屏幕抓取的站点）是托管 Web 浏览器组件（mshtml.dll/Trident、Gecko 或 WebKit）的实例并让它评估页面就像在普通桌面环境中一样。屏幕截图的代码然后操纵 DOM 以触发事件，例如按钮单击。

# ipython - 从 ipython 更改日志文件的路径

> ID：12379289
> 
> 赞同：1
> 
> 时间：2012-09-11T23:26:07.187
> 
> 标签：ipython

我在 Ununtu 10.4 上运行 ipython 并使用 %logstart 记录会话。

我想定义将记录会话的日志文件的路径。目前我的家庭目录中有 ipython_log.py

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-11T23:46:45.683

第一个参数`%logstart`应该是日志文件的路径。例如：

`%logstart ~/mylog.log`

尝试`?%logstart`阅读有关可用选项的信息。

# ios - 使用不同的 NSManagedObjectContexts 时更新 NSManagedObject

> ID：12379295
> 
> 赞同：0
> 
> 时间：2012-09-11T23:26:47.843
> 
> 标签：ios, uitableview, nsfetchedresultscontroller, nsmanagedobjectcontext

我有一个连接到 NSFetchedResultsController 的表视图，该控制器正在侦听 UIManagedDocument 的 managedObjectContext。工作正常。现在，我正在后台上下文中创建一个新对象（其父对象是 UIManagedDocument 的 managedObjectContext）。该对象按预期在我的表格视图中弹出。

现在，稍后我将更新我刚刚创建的那个对象。我在后台上下文中更新它，但由于某种原因，一旦更新完成，表格视图实际上会显示两个（重复）对象，而不仅仅是一个。我很困惑为什么会发生这种情况，但这一定是由于使用了不同的上下文。事实上，我证实我只创建了一次对象（使用 insertObject:...）。

关于如何解决这个问题的任何想法？谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-12T02:34:10.097

已知的错误，有几种不同的症状，包括你的。

在保存到父上下文之前，您需要获取对象的永久 ID。

有关详细信息，请参阅此帖子：[Core Data could not fullfil fault for object after gettingPermanantIDs](https://stackoverflow.com/questions/11321717/core-data-could-not-fullfil-fault-for-object-after-obtainpermanantids/11996211#11996211)

# java - 了解 Java 中的深拷贝构造函数

> ID：12379297
> 
> 赞同：0
> 
> 时间：2012-09-11T23:27:14.653
> 
> 标签：java, constructor, copy, deep-copy

我有一个名为 Bar 的主类，它调用类 Foo，我想我正确地放入了一个深层构造函数

深层复制构造函数的目的是将一个对象的内容复制到另一个对象，并且更改复制的对象不应更改原始内容，对吗？

我的代码做到了，但我不明白为什么当我设置原始对象变量时，复制对象不包含该设置变量，它只包含默认构造函数变量。

```
public class Bar
{
    public static void main(String[] args)
    {
        Foo object = new Foo();
        object.setName1("qwertyuiop");

//the below line of code should copy object to object2?
        Foo object2 = new Foo(object);          
        System.out.println(object.getName1());

//shouldn't the below line of code should output qwertyuiop since object2 is a copy of object? Why is it outputting the default constructor value Hello World?
        System.out.println(object2.getName1()); 

//changes object2's name1 var to test if it changed object's var. it didn't, so my deep copy constructor is working

        object2.setName1("TROLL");
        System.out.println(object2.getName1()); 
        System.out.println(object.getName1());
    }

}

public class Foo
{

    //instance variable(s)
    private String name1;

    public Foo()
    {
        System.out.println("Default Constructor called");
        name1= "Hello World";

    }
    //deep copy constructor
    public Foo(Foo deepCopyObject)
    {   

        name1 = deepCopyObject.name1; 

    }
    public String getName1() {
    return name1;
}
public void setName1(String name1) {
    this.name1 = name1;
}
} 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-09-11T23:35:32.597

那*不是*深拷贝。Java*不是*C++。您可以自由编写一个复制构造函数，它接受一个 Foo 实例并用另一个 Foo 对其进行初始化，但是没有语言支持来帮助您实现。这完全取决于你。

您还应该知道，Java 不需要像 C++ 那样的复制构造函数。Java 对象存在于堆上。您传递给方法的东西是对堆上对象的引用，而不是对象的副本。

您可以编写一个复制构造函数，但它的作用取决于您。你必须非常小心：

```
public class Foo {
    private Map<String, Bar> barDictionary;

    public Foo() {
        this.barDictionary = new HashMap<String, Bar>();
    }

    public Foo(Foo f) { 
        // What happens here is up to you.  I'd recommend making a deep copy in this case.
        this.barDictionary = new HashMap<String, Bar>(); 
        this.barDictionary.putAll(f.barDictionary);  // Question: What about the Bar references?  What happens to those?
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-12T00:27:45.927

首先，因为`String`是不可变的，所以你`Foo`实际上没有任何深度，所以深拷贝和浅拷贝之间的区别并不存在。对于非不可变类型字段，设置`this.field = other.field`将进行`this`浅拷贝。您将需要对`other.field`（递归地进行深度复制，直到您到达仅具有不可变或原始字段的对象）。

其次，要回答代码中注释中的问题，它对我来说是正确的。`System.out.println(object2.getName1());`输出`qwertyuiop`。

# canvas - ThreeJS - 如何将画布输出到特定的 div 中？

> ID：12379299
> 
> 赞同：2
> 
> 时间：2012-09-11T23:27:25.737
> 
> 标签：canvas, three.js

似乎画布只是简单地插入到主体中，位于流程的底部。我想知道我需要更改哪一点代码才能将其插入到特定的 div 中？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-12T07:59:34.627

通常是这一行：

```
container = document.createElement( 'div' );

//later in that file
container.appendChild( renderer.domElement ); 
```

将第一行更改为：

```
container = document.getElementById( 'mycustomdiv' ); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-09-13T11:37:42.713

您可以自己创建画布并将其放在您想要的位置。然后像这样将它传递给渲染器构造函数：`renderer = new THREE.WebGLRenderer({ canvas: myCanvasElem });`参见[文档](https://threejs.org/docs/#api/en/renderers/WebGLRenderer)。

# java - android java主机问题

> ID：12379307
> 
> 赞同：1
> 
> 时间：2012-09-11T23:29:11.480
> 
> 标签：java, android, host

所以我在网上找到了一些脚本并对其进行了一些修改，但我无法让它工作！这是 AllProjects.java

```
 package com.main.timelogger;

import java.util.ArrayList;
import java.util.HashMap;
import java.util.List;

import org.apache.http.NameValuePair;
import org.json.JSONArray;
import org.json.JSONException;
import org.json.JSONObject;

import android.app.ListActivity;
import android.app.ProgressDialog;
import android.content.Intent;
import android.os.AsyncTask;
import android.os.Bundle;
import android.util.Log;
import android.view.View;
import android.widget.AdapterView;
import android.widget.AdapterView.OnItemClickListener;
import android.widget.ListAdapter;
import android.widget.ListView;
import android.widget.SimpleAdapter;
import android.widget.TextView;

public class AllProjects extends ListActivity {
// Progress Dialog
private ProgressDialog pDialog;

// Creating JSON Parser object
JSONParser jParser = new JSONParser();

ArrayList<HashMap<String, String>> projectsList;

// url to get all products list
private static String url_all_products = "http://10.0.2.2/test/getAllProjects.php";

// JSON Node names
private static final String TAG_SUCCESS = "success";
private static final String TAG_PROJECTS = "projects";
private static final String TAG_PID = "pid";
private static final String TAG_NAME = "name";

// products JSONArray
JSONArray products = null;

@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.activity_project);

    // Hashmap for ListView
    projectsList = new ArrayList<HashMap<String, String>>();

    // Loading products in Background Thread
    new LoadAllProjects().execute();

    // Get listview
    ListView lv = getListView();

    // on selecting single product
    // launching Edit Product Screen
    lv.setOnItemClickListener(new OnItemClickListener() {

        public void onItemClick(AdapterView<?> parent, View view,int position, long id) {
            // getting values from selected ListItem
            String pid = ((TextView) view.findViewById(R.id.pid)).getText()
                    .toString();

            // Starting new intent
            Intent in = new Intent(getApplicationContext(),
                    EditProject.class);
            // sending pid to next activity
            in.putExtra(TAG_PID, pid);

            // starting new activity and expecting some response back
            startActivityForResult(in, 100);
        }
    });

}

// Response from Edit Product Activity
@Override
protected void onActivityResult(int requestCode, int resultCode, Intent data) {
    super.onActivityResult(requestCode, resultCode, data);
    // if result code 100
    if (resultCode == 100) {
        // if result code 100 is received 
        // means user edited/deleted product
        // reload this screen again
        Intent intent = getIntent();
        finish();
        startActivity(intent);
    }

}

/**
 * Background Async Task to Load all product by making HTTP Request
 * */
class LoadAllProjects extends AsyncTask<String, String, String> {

    /**
     * Before starting background thread Show Progress Dialog
     * */
    @Override
    protected void onPreExecute() {
        super.onPreExecute();
        pDialog = new ProgressDialog(AllProjects.this);
        pDialog.setMessage("Loading products. Please wait...");
        pDialog.setIndeterminate(false);
        pDialog.setCancelable(false);
        pDialog.show();
    }

    /**
     * getting All products from url
     * */
    protected String doInBackground(String... args) {
        // Building Parameters
        List<NameValuePair> params = new ArrayList<NameValuePair>();
        // getting JSON string from URL
        JSONObject json = jParser.makeHttpRequest(url_all_products, "GET", params);

        // Check your log cat for JSON reponse
        Log.d("All Products: ", json.toString());

        try {
            // Checking for SUCCESS TAG
            int success = json.getInt(TAG_SUCCESS);

            if (success == 1) {
                // products found
                // Getting Array of Products
                products = json.getJSONArray(TAG_PROJECTS);

                // looping through All Products
                for (int i = 0; i < products.length(); i++) {
                    JSONObject c = products.getJSONObject(i);

                    // Storing each json item in variable
                    String id = c.getString(TAG_PID);
                    String name = c.getString(TAG_NAME);

                    // creating new HashMap
                    HashMap<String, String> map = new HashMap<String, String>();

                    // adding each child node to HashMap key => value
                    map.put(TAG_PID, id);
                    map.put(TAG_NAME, name);

                    // adding HashList to ArrayList
                    projectsList.add(map);
                }
            } else {
                // no products found
                // Launch Add New product Activity
                Intent i = new Intent(getApplicationContext(),
                        NewProject.class);
                // Closing all previous activities
                i.addFlags(Intent.FLAG_ACTIVITY_CLEAR_TOP);
                startActivity(i);
            }
        } catch (JSONException e) {
            e.printStackTrace();
        }

        return null;
    }

    /**
     * After completing background task Dismiss the progress dialog
     * **/
    protected void onPostExecute(String file_url) {
        // dismiss the dialog after getting all products
        pDialog.dismiss();
        // updating UI from Background Thread
        runOnUiThread(new Runnable() {
            public void run() {
                /**
                 * Updating parsed JSON data into ListView
                 * */
                ListAdapter adapter = new SimpleAdapter(
                        AllProjects.this, projectsList,
                        R.layout.list_item, new String[] { TAG_PID,
                                TAG_NAME},
                        new int[] { R.id.pid, R.id.name });
                // updating listview
                setListAdapter(adapter);
            }
        });

    }

} 
```

}

这是 JSONParser.java

```
 package com.main.timelogger;

import java.io.BufferedReader;
import java.io.IOException;
import java.io.InputStream;
import java.io.InputStreamReader;
import java.io.UnsupportedEncodingException;
import java.util.List;

import org.apache.http.HttpEntity;
import org.apache.http.HttpResponse;
import org.apache.http.NameValuePair;
import org.apache.http.client.ClientProtocolException;
import org.apache.http.client.entity.UrlEncodedFormEntity;
import org.apache.http.client.methods.HttpGet;
import org.apache.http.client.methods.HttpPost;
import org.apache.http.client.utils.URLEncodedUtils;
import org.apache.http.impl.client.DefaultHttpClient;
import org.json.JSONException;
import org.json.JSONObject;

import android.util.Log;

public class JSONParser {

static InputStream is = null;
static JSONObject jObj = null;
static String json = "";

// constructor
public JSONParser() {

}

// function get json from url
// by making HTTP POST or GET method
public JSONObject makeHttpRequest(String url, String method,
        List<NameValuePair> params) {

    // Making HTTP request
    try {

        // check for request method
        if(method == "POST"){
            // request method is POST
            // defaultHttpClient
            DefaultHttpClient httpClient = new DefaultHttpClient();
            HttpPost httpPost = new HttpPost(url);
            httpPost.setEntity(new UrlEncodedFormEntity(params));

            HttpResponse httpResponse = httpClient.execute(httpPost);
            HttpEntity httpEntity = httpResponse.getEntity();
            is = httpEntity.getContent();

        }else if(method == "GET"){
            // request method is GET
            DefaultHttpClient httpClient = new DefaultHttpClient();
            String paramString = URLEncodedUtils.format(params, "utf-8");
            url += "?" + paramString;
            HttpGet httpGet = new HttpGet(url);

            HttpResponse httpResponse = httpClient.execute(httpGet);
            HttpEntity httpEntity = httpResponse.getEntity();
            is = httpEntity.getContent();
        }           

    } catch (UnsupportedEncodingException e) {
        Log.e("Error","1o catch");
        e.printStackTrace();
    } catch (ClientProtocolException e) {
        Log.e("Error","2o catch");
        e.printStackTrace();
    } catch (IOException e) {
        Log.e("Error","3o catch");
        e.printStackTrace();
    }

    try {
        BufferedReader reader = new BufferedReader(new InputStreamReader(
                is, "iso-8859-1"), 8);
        StringBuilder sb = new StringBuilder();
        String line = null;
        while ((line = reader.readLine()) != null) {
            sb.append(line + "\n");
        }
        is.close();
        json = sb.toString();
    } catch (Exception e) {
        Log.e("Buffer Error", "Error converting result " + e.toString());
    }

    // try parse the string to a JSON object
    try {
        jObj = new JSONObject(json);
    } catch (JSONException e) {
        Log.e("JSON Parser", "Error parsing data " + e.toString());
    }

    // return JSON String
    return jObj;

}
} 
```

这是日志

```
09-12 02:25:27.353: I/ActivityThread(7470): queueIdle
09-12 02:25:27.353: V/ActivityThread(7470): Reporting idle of ActivityRecord{4a3fd360 token=android.os.BinderProxy@4a3fce38 {com.main.timelogger/com.main.timelogger.AllProjects}} finished=false
09-12 02:25:27.353: W/ActivityNative(7470): send ACTIVITY_IDLE_TRANSACTION
09-12 02:25:48.343: E/Error(7470): 3o catch
09-12 02:25:48.353: W/System.err(7470): java.net.SocketException: The operation timed out
09-12 02:25:48.353: W/System.err(7470):     at org.apache.harmony.luni.platform.OSNetworkSystem.connectStreamWithTimeoutSocketImpl(Native Method)
09-12 02:25:48.353: W/System.err(7470):     at org.apache.harmony.luni.platform.OSNetworkSystem.connect(OSNetworkSystem.java:115)
09-12 02:25:48.353: W/System.err(7470):     at org.apache.harmony.luni.net.PlainSocketImpl.connect(PlainSocketImpl.java:244)
09-12 02:25:48.353: W/System.err(7470):     at org.apache.harmony.luni.net.PlainSocketImpl.connect(PlainSocketImpl.java:533)
09-12 02:25:48.353: W/System.err(7470):     at java.net.Socket.connect(Socket.java:1074)
09-12 02:25:48.353: W/System.err(7470):     at org.apache.http.conn.scheme.PlainSocketFactory.connectSocket(PlainSocketFactory.java:119)
09-12 02:25:48.353: W/System.err(7470):     at org.apache.http.impl.conn.DefaultClientConnectionOperator.openConnection(DefaultClientConnectionOperator.java:153)
09-12 02:25:48.363: W/System.err(7470):     at org.apache.http.impl.conn.AbstractPoolEntry.open(AbstractPoolEntry.java:164)
09-12 02:25:48.363: W/System.err(7470):     at org.apache.http.impl.conn.AbstractPooledConnAdapter.open(AbstractPooledConnAdapter.java:119)
09-12 02:25:48.363: W/System.err(7470):     at org.apache.http.impl.client.DefaultRequestDirector.execute(DefaultRequestDirector.java:348)
09-12 02:25:48.363: W/System.err(7470):     at org.apache.http.impl.client.AbstractHttpClient.execute(AbstractHttpClient.java:555)
09-12 02:25:48.363: W/System.err(7470):     at org.apache.http.impl.client.AbstractHttpClient.execute(AbstractHttpClient.java:487)
09-12 02:25:48.363: W/System.err(7470):     at org.apache.http.impl.client.AbstractHttpClient.execute(AbstractHttpClient.java:465)
09-12 02:25:48.373: W/System.err(7470):     at com.main.timelogger.JSONParser.makeHttpRequest(JSONParser.java:62)
09-12 02:25:48.373: W/System.err(7470):     at com.main.timelogger.AllProjects$LoadAllProjects.doInBackground(AllProjects.java:125)
09-12 02:25:48.373: W/System.err(7470):     at com.main.timelogger.AllProjects$LoadAllProjects.doInBackground(AllProjects.java:1)
09-12 02:25:48.373: W/System.err(7470):     at android.os.AsyncTask$2.call(AsyncTask.java:185)
09-12 02:25:48.373: W/System.err(7470):     at java.util.concurrent.FutureTask$Sync.innerRun(FutureTask.java:305)
09-12 02:25:48.373: W/System.err(7470):     at java.util.concurrent.FutureTask.run(FutureTask.java:137)
09-12 02:25:48.373: W/System.err(7470):     at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1068)
09-12 02:25:48.373: W/System.err(7470):     at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:561)
09-12 02:25:48.373: W/System.err(7470):     at java.lang.Thread.run(Thread.java:1096)
09-12 02:25:48.373: E/Buffer Error(7470): Error converting result java.lang.NullPointerException
09-12 02:25:48.373: E/JSON Parser(7470): Error parsing data org.json.JSONException: End of input at character 0 of 
09-12 02:25:48.383: W/dalvikvm(7470): threadid=8: thread exiting with uncaught exception (group=0x400207d8)
09-12 02:25:48.393: E/AndroidRuntime(7470): FATAL EXCEPTION: AsyncTask #1
09-12 02:25:48.393: E/AndroidRuntime(7470): java.lang.RuntimeException: An error occured while executing doInBackground()
09-12 02:25:48.393: E/AndroidRuntime(7470):     at android.os.AsyncTask$3.done(AsyncTask.java:200)
09-12 02:25:48.393: E/AndroidRuntime(7470):     at java.util.concurrent.FutureTask$Sync.innerSetException(FutureTask.java:273)
09-12 02:25:48.393: E/AndroidRuntime(7470):     at java.util.concurrent.FutureTask.setException(FutureTask.java:124)
09-12 02:25:48.393: E/AndroidRuntime(7470):     at java.util.concurrent.FutureTask$Sync.innerRun(FutureTask.java:307)
09-12 02:25:48.393: E/AndroidRuntime(7470):     at java.util.concurrent.FutureTask.run(FutureTask.java:137)
09-12 02:25:48.393: E/AndroidRuntime(7470):     at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1068)
09-12 02:25:48.393: E/AndroidRuntime(7470):     at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:561)
09-12 02:25:48.393: E/AndroidRuntime(7470):     at java.lang.Thread.run(Thread.java:1096)
09-12 02:25:48.393: E/AndroidRuntime(7470): Caused by: java.lang.NullPointerException
09-12 02:25:48.393: E/AndroidRuntime(7470):     at com.main.timelogger.AllProjects$LoadAllProjects.doInBackground(AllProjects.java:128)
09-12 02:25:48.393: E/AndroidRuntime(7470):     at com.main.timelogger.AllProjects$LoadAllProjects.doInBackground(AllProjects.java:1)
09-12 02:25:48.393: E/AndroidRuntime(7470):     at android.os.AsyncTask$2.call(AsyncTask.java:185)
09-12 02:25:48.393: E/AndroidRuntime(7470):     at java.util.concurrent.FutureTask$Sync.innerRun(FutureTask.java:305)
09-12 02:25:48.393: E/AndroidRuntime(7470):     ... 4 more
09-12 02:25:48.693: E/WindowManager(7470): Activity com.main.timelogger.AllProjects has leaked window com.android.internal.policy.impl.PhoneWindow$DecorView@4a40c720 that was originally added here
09-12 02:25:48.693: E/WindowManager(7470): android.view.WindowLeaked: Activity com.main.timelogger.AllProjects has leaked window com.android.internal.policy.impl.PhoneWindow$DecorView@4a40c720 that was originally added here
09-12 02:25:48.693: E/WindowManager(7470):  at android.view.ViewRoot.<init>(ViewRoot.java:247)
09-12 02:25:48.693: E/WindowManager(7470):  at android.view.WindowManagerImpl.addView(WindowManagerImpl.java:148)
09-12 02:25:48.693: E/WindowManager(7470):  at android.view.WindowManagerImpl.addView(WindowManagerImpl.java:91)
09-12 02:25:48.693: E/WindowManager(7470):  at android.view.Window$LocalWindowManager.addView(Window.java:424)
09-12 02:25:48.693: E/WindowManager(7470):  at android.app.Dialog.show(Dialog.java:241)
09-12 02:25:48.693: E/WindowManager(7470):  at com.main.timelogger.AllProjects$LoadAllProjects.onPreExecute(AllProjects.java:115)
09-12 02:25:48.693: E/WindowManager(7470):  at android.os.AsyncTask.execute(AsyncTask.java:391)
09-12 02:25:48.693: E/WindowManager(7470):  at com.main.timelogger.AllProjects.onCreate(AllProjects.java:57)
09-12 02:25:48.693: E/WindowManager(7470):  at android.app.Instrumentation.callActivityOnCreate(Instrumentation.java:1047)
09-12 02:25:48.693: E/WindowManager(7470):  at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:2633)
09-12 02:25:48.693: E/WindowManager(7470):  at android.app.ActivityThread.handleLaunchActivity(ActivityThread.java:2685)
09-12 02:25:48.693: E/WindowManager(7470):  at android.app.ActivityThread.access$2300(ActivityThread.java:126)
09-12 02:25:48.693: E/WindowManager(7470):  at android.app.ActivityThread$H.handleMessage(ActivityThread.java:2038)
09-12 02:25:48.693: E/WindowManager(7470):  at android.os.Handler.dispatchMessage(Handler.java:99)
09-12 02:25:48.693: E/WindowManager(7470):  at android.os.Looper.loop(Looper.java:123)
09-12 02:25:48.693: E/WindowManager(7470):  at android.app.ActivityThread.main(ActivityThread.java:4633)
09-12 02:25:48.693: E/WindowManager(7470):  at java.lang.reflect.Method.invokeNative(Native Method)
09-12 02:25:48.693: E/WindowManager(7470):  at java.lang.reflect.Method.invoke(Method.java:521)
09-12 02:25:48.693: E/WindowManager(7470):  at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:858)
09-12 02:25:48.693: E/WindowManager(7470):  at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:616)
09-12 02:25:48.693: E/WindowManager(7470):  at dalvik.system.NativeStart.main(Native Method) 
```

服务器上的文件没有问题，也没有任何防火墙。我不明白问题出在哪里，所以如果可以的话，请帮助我:)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-12T00:06:24.667

```
 Caused by: java.lang.NullPointerException
09-12 02:25:48.393: E/AndroidRuntime(7470):     at com.main.timelogger.AllProjects$LoadAllProjects.doInBackground(AllProjects.java:128) 
```

有你的问题： AllProjects.java:128 ，你必须验证一个变量`doInBackground()`

# javascript - MSIE9 -- 当 CSS 的宽度和填充同时调整时，输入/文本区域中的文本不遵守当前填充

> ID：12379308
> 
> 赞同：6
> 
> 时间：2012-09-11T23:29:21.717
> 
> 标签：javascript, css, internet-explorer

我有一个简单的脚本，分别添加和删除/`padding-left`上的 textareas/inputs 。这是为了在字段左侧为一个绝对定位的小按钮腾出空间，而不会阻挡其下方的文本。[编辑] 它同时改变元素的宽度，以保持块的总大小一致。`focus``blur`

在几乎所有浏览器中，除了 MSIE 9 外，这都能正常工作。 [编辑] 虽然框保持相同大小，表明两个属性的 CSS 已正确更新，但 input/textarea 中的文本表现得好像填充没有改变. `focus`我知道/事件的回调`blur`正在触发并正确更新 DOM 对象的样式属性，因为获取属性的当前值总是会给你预期的值。

IE

```
var field = $(field);
field.css({
  'padding-left' : 0
});
console.log(field.css('padding-left')); // '0px' 
```

然而 input/textarea 字段中的文本仍然显示之前的填充。基本上，当您尝试同时更改宽度和填充时，在这些字段出现的上下文中，MSIE9 的渲染引擎似乎有些混乱。

一旦您开始在字段中输入，MSIE 将解决问题并使输入/文本区域中的文本遵循当前填充。意识到这一点，我尝试在and回调`field.val(field.val());`的末尾添加一个。这解决了一个问题，并以将插入符号位置重置为输入/文本区域开头的形式引入了另一个问题。`blur``focus`

有没有办法强制浏览器重绘给定元素，而无需经历将其删除并重新插入 DOM 的过程？

[编辑]

这是一个显示代码缩写形式的小提琴（在其实际上下文中具有附加功能）：

[http://jsfiddle.net/KYrXM/](http://jsfiddle.net/KYrXM/)

您将看到填充已更新，但在您开始键入之前没有可见的更改。

如果我选择不更改宽度属性，这个问题就会消失，尽管我需要在我的应用程序中保持盒子大小不变。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-12T03:32:55.123

我不明白为什么会这样；绝对是 IE9 中的一个错误，但如果您将填充设置为空字符串`''`而不是`'0px'`，它可以工作。

```
field.css({
  'padding-left' : '' // <- Use '' instead of 0.
}); 
```

这是一个工作小提琴：http: [//jsfiddle.net/KYrXM/4/](http://jsfiddle.net/KYrXM/4/)

或者，如果您将其设置为`1`而不是，它也可以工作`0`，并且您可能可以围绕额外的像素进行编程。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-12T10:14:46.837

这会强制重绘并解决问题（但这是一个丑陋的黑客）：

```
$('#your-input-element').replaceWith($('#your-input-element').clone()); 
```

# mysql - 网络解决方案 MySQL 设置与 Go Daddy MySQL 设置

> ID：12379312
> 
> 赞同：1
> 
> 时间：2012-09-11T23:29:58.797
> 
> 标签：mysql, wordpress, networking

这很难解释，所以请耐心等待。

我不明白如何在网络解决方案中设置 MySQL 数据库，并且确定它以某种方式链接到特定域和同一服务器上。

客户端需要嵌入博客，因此我发现此链接[http://www.corvidworks.com/articles/wordpress-content-on-other-pages](http://www.corvidworks.com/articles/wordpress-content-on-other-pages)作为嵌入博客的一种方式。

这是用于拉取 WP 帖子的一段代码示例...

```
<?php
// Include WordPress 
define('WP_USE_THEMES', false);
require('/var/www/example.com/wordpress/wp-load.php');
query_posts('showposts=1');
?> 
```

正如您在上面看到的，我需要确定 WP 数据、博客以及与我正在处理的页面位于同一根文件夹/服务器上的任何内容。假设页面是 example.com/newblog.php 我想粘贴这段代码并知道 MySQL 数据库在同一台服务器上。

在 Go Daddy 上，这很容易清楚地看到。很清楚，因为我可以单击名称“example.com”并知道我即将设置一个驻留在同一服务器上的 MySQL 数据库。

还是我不了解数据库是如何创建的以及它们存储在哪里？当您在任何服务器上创建 MySQL 数据库时，它只是独立于域并与域分开吗？

网络解决方案很难导航。我很想单击正在处理的域名，设置 MySQL，并知道它们在同一台服务器上。

我目前看到列出了 2 个域名，但我担心如果我创建一个新的 MySQL 数据库，它将被“链接”或与错误的域相关联。或者我是否可以安全地创建一个并且它不会影响错误的域？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-11T23:37:13.503

GoDaddy 和 Network Solutions 提供的 MySQL 服务器通常位于与托管网站本身不同的服务器上。至少，它们位于与托管服务器不同的虚拟服务器上。

只需查看`wp-config.php`文件，看看它的值`DB_HOST`是什么。这告诉您 MySQL 数据在哪个服务器上。数据是否在同一台服务器上并不重要，只要您使用该主机的正确凭据连接到正确的 MySQL 主机，并且允许您的客户端主机名/IP 使用提供的凭据进行连接。

如果你有代码：

```
<?php
// Include WordPress 
define('WP_USE_THEMES', false);
require('/var/www/example.com/wordpress/wp-load.php');
query_posts('showposts=1'); 
```

The only thing that really matters is that the script making that call is on the same server as the Wordpress blog. Where the MySQL data is doesn't matter. It's using the same credentials that the wordpress site in question is using so its going to be accessing the same data.

Does that help?

# java - 鉴于在 java 中执行了某些方法，有没有办法确定用于该方法的字节码操作的数量？

> ID：12379319
> 
> 赞同：0
> 
> 时间：2012-09-11T23:30:57.330
> 
> 标签：java, performance, bytecode

现在我意识到 JIT 可以抛出这个循环。我正在寻找的是一种计算正在执行的一组代码的指令数量的方法。

我为此想到的是自动化测试，它检测某种方法何时超过预期的指令数量（即性能回归）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-12T07:34:41.483

您可以使用字节码检测为每个字节码操作添加到计数器或为组添加一个数字。这相当复杂，并且会显着减慢您的代码速度。

相反，我建议黑盒在外部计时您的方法。运行该方法超过 10,000 次，使其预热并重复运行约 2 秒。这将使您了解应该获得多少重复的范围，过高或过低都可能表明存在问题。

# java - Java Android Libgdx 字符以慢速开始，然后加速

> ID：12379321
> 
> 赞同：-2
> 
> 时间：2012-09-11T23:31:32.603
> 
> 标签：java, android, libgdx

所以基本上，当我的角色生成时，他们开始缓慢，然后在行走时获得速度。

我该怎么做才能让我的角色以正常速度开始？

这是我的意思的视频 [http://www.youtube.com/watch?v=6ffq_j5Fsu8&feature=youtu.be](http://www.youtube.com/watch?v=6ffq_j5Fsu8&feature=youtu.be)

这也是我的 Zombie.java 的源代码

[http://pastebin.com/BKM1reZC](http://pastebin.com/BKM1reZC)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-11T23:43:36.817

我的猜测是僵尸开始缓慢是由于以下一项或两项原因：

*   由于某种程度的争用，在为它们设置动画的同时创建僵尸会导致动画运行缓慢。

*   由于 JIT 编译而产生的“热身”效果（我不确定这在 Android 上是否合理，但肯定适用于经典的 Java 平台）或其他原因。

# c# - 文件的计算哈希值与清单中指定的不同

> ID：12379329
> 
> 赞同：3
> 
> 时间：2012-09-11T23:32:42.460
> 
> 标签：c#, .net, visual-studio-2010, .net-2.0

我通常只是在 C# 中创建 Web 应用程序，但我试图将我的手转向创建 WinForms 应用程序。我创建了一个 OpenVPN 客户端，它基本上是`OpenVPN.exe`. 该项目需要`OpenVPN.exe`包含该文件，它的位置如下：

```
 string ovpnLocation = System.Windows.Forms.Application.StartupPath
      + "\\OpenVPN_Client\\openvpn.exe"; 
```

我将以下属性应用于 VS 中的文件：

*   **构建操作：**内容
*   **复制到输出目录：**始终复制

现在，当我尝试使用 ClickOnce 安装程序部署应用程序时，出现以下错误：

`File, openvpn.exe, has a different computed hash than specified in manifest.`

在清理、重建并遵循我在整个互联网上可以找到的所有其他帖子中的说明之后，我似乎无法使用这些当前设置解决这个问题。我能够安装和运行它的唯一方法是将文件上的设置更改为以下内容：

*   **构建操作：**无
*   **复制到输出目录：**始终复制

现在使用这些设置，在部署时，我没有得到相同的哈希错误，但似乎文件的位置已经移动，并且我的代码在整个地方抛出了 execptions，因为它找不到它。

所以有两种解决方案：

*   解决哈希问题，无需更改代码。
*   现在找到一些代码来帮助我在最终用户机器上找到文件。

非常感谢任何帮助！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-14T19:09:55.347

我设法通过将项目升级到 .Net 4.0 来解决这个问题。

通过使用相对路径解决了文件路径的问题：

```
 string ovpnLocation = "OpenVPN_Client\\openvpn.exe"; 
```

而不是试图创建一个绝对：

```
string ovpnLocation = System.Windows.Forms.Application.StartupPath
  + "\\OpenVPN_Client\\openvpn.exe"; 
```

# actionscript-3 - 这个工厂原型代码是做什么的？

> ID：12379332
> 
> 赞同：1
> 
> 时间：2012-09-11T23:33:02.130
> 
> 标签：actionscript-3, apache-flex, oop, design-patterns, prototype

这段代码有什么作用？我的意思是特别是原型部分。传入的chain对象是CSS名/值对的对象。我认为 defaultFactory 返回一个具有名称值对的对象。我不知道设置原型的作用。

```
 function addDefaultStyleToProtoChain(chain):Object {
    // If there's a defaultFactory for this style sheet,
    // then add the object it produces to the chain.
    if (defaultFactory != null)
    {
        var originalChain:Object = chain;

        // from here on...
        defaultFactory.prototype = chain;
        chain = new defaultFactory();
        defaultFactory.prototype = null;
     }

     return chain;
  } 
```

这是在 Flex 4.6 SDK 的 CSSStyleDeclaration 类的 addDefaultStyleToProtoChain 方法中

对于上下文，如果：

```
 var o:Object = new defaultFactory();
   trace(o) // {fontFamily:Arial, color:blue};
   trace(chain) // {color:red, fontWeight:bold}

   defaultFactory.prototype = chain;
   chain = new defaultFactory(); 
   trace(chain) // ??? 
```

链条等于什么？

～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～ ～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～ ～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～ ~~~~~
根据下面的答案，这是怎么回事：

```
// create a function that returns an object
var myDynamicDefinition:Function = function() {
    this.name = "initialvalue";
    trace('this.name='+this.name); // returns this.name=initialvalue
}

var dynamicDefinitionInstance = new myDynamicDefinition(); // create an instance of myDynamicDefinition
trace(ObjectUtil.toString(dynamicDefinitionInstance));// returns name = "initialvalue"

// create a new definition and assign it to our dynamic definitions
var newDefinition = {color:"red", name:"newObjectValue"};
myDynamicDefinition.prototype = newDefinition;

// create a new instance with new definition
var dynamicDefinitionInstance2 = new myDynamicDefinition();  // create an instance of myDynamicDefinition
trace(ObjectUtil.toString(dynamicDefinitionInstance2)); // returns name = "initialvalue" color = "red"

// delete name property instance
delete dynamicDefinitionInstance2.name;
trace(ObjectUtil.toString(dynamicDefinitionInstance2)); // returns name = "newObjectValue" color = "red"

// set prototype to null 
myDynamicDefinition.prototype = null;

// create a new instance 
var dynamicDefinitionInstance3 = new myDynamicDefinition(); 
trace(ObjectUtil.toString(dynamicDefinitionInstance2)); // returns name = "newObjectValue" color = "red" 
```

看起来当原型对象设置为包含同名属性的对象时，新实例上的属性值在创建新实例后不会改变。所以一开始没什么区别。如果该属性被删除，则原型对象上的值将用作 FALLBACK。请参阅上面的示例代码和返回值。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-12T00:50:13.143

设置原型基本上修改了一个类，因此从那时起，您实例化该类的任何对象都将获得该类的新版本而不是原始版本。

所以可以说我的语言有一个本地类 foo。如果我想给 foo 添加一个方法，不只是创建一个扩展 foo 的类，而是实际上将方法添加到 foo 中。我会修改 foo 的原型。因此，在执行该代码之后， foo 的所有实例都有我的新方法。

通常你不想这样做，它相当于猴子补丁，但如果你正在编写一个框架或 SDK，并且它有很好的文档，你可能很清楚。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-13T20:50:54.590

我查看了 SDK，发现它`defaultFactory`的功能类似于

```
newStyleDeclaration.defaultFactory = function():void
{
    leftMargin = 50;
    rightMargin = 50;
} 
```

因此，当您将此函数作为构造函数应用于对象（通过原型）时，您只需创建一个新对象，该对象已合并来自第一个对象的属性并在函数中声明。

```
 var def : Function = function() {
        this.someDefChanges = "someDefChanges";
    }

    var o1 = {testValueO2 : "testValueO2"};
    def.prototype = o1;
    var o2 = new def();
    def.prototype = null;

    // o1 = {testValueO2: "testValueO2"}
    // o2 = {someDefChanges: "someDefChanges", testValueO2: "testValueO2"} 
```

希望你的问题我答对了

# java - 在 JFileChooser 中预填充文件名

> ID：12379335
> 
> 赞同：0
> 
> 时间：2012-09-11T23:33:39.993
> 
> 标签：java, swing, jfilechooser

我非常想这样做：

[使用带有预填充文件名的 JFileChooser 保存？](https://stackoverflow.com/questions/1401285/save-using-jfilechooser-with-pre-populated-file-name)

目标是在初始化对话框时，在文件名（实际的目录名称）文本框中具有预定义的名称。

但是，我只想显示目录：`.setFileSelectionMode(JFileChooser.DIRECTORIES_ONLY)`

这样，问题中提供的代码不起作用。

有解决方法吗？

# design-patterns - 为多个不同任务构建 C# 控制台应用程序

> ID：12379342
> 
> 赞同：1
> 
> 时间：2012-09-11T23:33:58.247
> 
> 标签：design-patterns, c#-4.0, console-application

我想构建一个简单的 C# 控制台应用程序，它可以从命令行运行并且可以执行不同的任务。灵活地构建它的最佳方法是什么？我可以看到如何使用策略模式构建各种任务。Main() 函数只是一个巨大的开关吗？人们通常如何实现这个一般概念？

更新：我在 git/hg 之类的“风格上”看，但可能会少一些动作。用户将在命令行下工作，发出带有相关参数的任务，例如：`git add -f`。因此，以此为例，Git/Mercurial 允许扩展。我实际上正在寻找解决这个问题的各种一般方法，以及方法的好处/权衡。没有一种设计是完美的。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-09-12T01:24:56.510

如果您有复杂的命令行参数，请首先使用[http://commandline.codeplex.com/](http://commandline.codeplex.com/)之类的命令行解析库。然后使用[命令模式](http://en.wikipedia.org/wiki/Command_pattern)并针对不同的操作创建模型（或控制系统的类）。例如，如果您有一个“add”命令，请创建一个“AddCommand”类来调用模型上的适当方法和属性。

# java - Java 通用接口扩展了 Comparable

> ID：12379343
> 
> 赞同：1
> 
> 时间：2012-09-11T23:34:15.803
> 
> 标签：java, generics, interface, hashcode, tostring

我想创建一个类，让我们说实现通用接口 Comparable 并覆盖方法 equals、hashCode 和 toString 的 Employee ......我该怎么做？

这样可以吗

```
interface MinMax<T extends Comparable<T>> {

T equals();
T hashCode();
T toString();

} 
```

和

```
class Employee<T extends Comparable<T>> implements MinMax<T> {

 public T equals(){

  }

  public T hashCode(){

  }

  public T toString(){

  }

  } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-12T00:09:35.203

这个问题有两个部分。

第 1 部分：覆盖 equals、hashCode 和 toString。

只需使用新实现在新类中重新定义这些方法。

```
class Employee {

    //fields and other methods

    public boolean equals(Object other) {
        //new implementation here
    }
    public int hashCode() {
        //make sure two equal objects produce the same hashCode
    }
    public String toString() {
        //return whatever you want here
    }
} 
```

第 2 部分：实现 Comparable 接口。

我假设您希望与其他员工进行比较。声明它实现了Comparable，并实现了接口描述的compareTo方法。

```
public Employee implements Comparable<Employee> {

    //fields and methods

    public int compareTo(Employee e) {
        //new implementation. Should probably be consistent with equals.
    }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-11T23:50:57.530

一个类可以实现任意数量的接口，也不需要对它们进行“分组”：

```
class Employee implements Comparable, MinMax{ ... } 
```

无论如何，您必须提供接口方法实现。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-09-21T20:49:02.043

为此，您无需创建自己的单独界面。

Equals、hashCode 和 toString 是对象类的方法，您的新类将自动成为其子类，因此无需您做任何事情，它就可以访问这些方法。要覆盖这些方法，只需在新类中使用您希望方法执行的操作创建同名方法。

Comparable 是一个通用接口，因此您需要将字母 T 替换为所需的类。由于您可能希望将该类的成员与同一类的另一个成员进行比较，因此您将其替换为 Employee。你的类本身不需要是通用的，即使它实现了一个通用接口，所以你的代码中不应该有任何'T'

“扩展”一词适用于您要创建一个作为另一个类的子类的类。或者当您希望进入通用接口的类成为某个类的子类时。你不需要为你的班级这样做，所以在任何地方都不需要扩展这个词。

# java - 自动调整 jpanel 的大小

> ID：12379345
> 
> 赞同：3
> 
> 时间：2012-09-11T23:34:29.977
> 
> 标签：java, swing, layout-manager, null-layout-manager

无论如何，在添加组件时会自动（垂直）调整 JPanel 的大小吗？我已将布局管理器分配为空。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-11T23:48:44.840

考虑使用合适的布局管理器，这将帮助您在添加组件时扩展您想要的方式

[http://docs.oracle.com/javase/tutorial/uiswing/layout/visual.html](http://docs.oracle.com/javase/tutorial/uiswing/layout/visual.html)

我认为您正在寻找 GridLayout 并可能在内部使用 FlowLayout JPanel 以便它们不会扩展，但这取决于您要插入的内容。

# java - 使用条件 AND NOT EXISTS 将 SQL 转换为 HQL

> ID：12379346
> 
> 赞同：0
> 
> 时间：2012-09-11T23:34:33.800
> 
> 标签：java, spring, hibernate, nhibernate-mapping, hql

我需要将此 SQL 语句转换为 HQL，但我认为 NOT EXISTS 在 HQL 中不起作用请帮助我！！！

```
SELECT doctor.idUser, schedule.idSchedule, schedule.timeStart, schedule.day
FROM doctor, schedule
    WHERE schedule.day='LUNES'
        AND schedule.timeStart > '08:00:00'
        AND doctor.idUser= '1'
        AND doctor.idUser = schedule.idUserDoctor
AND NOT EXISTS( SELECT *    FROM appointment
    WHERE schedule.idSchedule = appointment.idSchedule
        AND doctor.idUser = schedule.idUserDoctor
        AND appointment.appointmentDate ='2012-09-06')
AND NOT EXISTS ( SELECT * FROM temporaryschedule
        WHERE schedule.idSchedule = temporaryschedule.idSchedule
        AND doctor.idUser = schedule.idUserDoctor"
        AND temporaryschedule.appointmentDate='201-09-06')
ORDER BY schedule.timeStart ASC 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-12T05:19:28.230

不幸的是，您没有提供有关您的域模型的任何信息，因此我们必须在这里做出一些假设......首先，我没有考虑医生和日程安排之间的任何映射关联，尽管您可能想要映射它。根据良好的设计，我使用参数而不是文字。我假设所有引用的表都已映射，并且正在为类使用“逻辑名称映射”。最后，我使用你的列名作为域模型属性名......

```
select ...
from Doctor d, Schedule s
where s.day = :day
  and s.timeStart > :startTime
  and d.idUser = :doctorId
  and d.idUser = s.idUserDoctor
  and not exists (
      select *
      from Appointment appt
      where s.idSchedule = appt.idSchedule
        and d.idUser = s.idUserDoctor
        and apt.appointmentDate = :apptDate
  )
  and not exists (
      select *
      from TemporarySchedule ts
      where s.idSchedule = ts.idSchedule
        and d.idUser = s.idUserDoctor
        and ts.appointmentDate = tempSchedDate
  )
order by s.startTime asc 
```

# php - 如何在表达式引擎中为管理区域中定制页面的操作和输出创建一系列方法？

> ID：12379353
> 
> 赞同：2
> 
> 时间：2012-05-17T15:22:06.190
> 
> 标签：php, administration

我们正在尝试在 Expression Engine 管理区域中创建一个新页面，最好使用自定义模块或扩展。

我们需要一个在标头发送到浏览器之前调用 EE 的方法和一个显示任何输出的方法。这是通用的，没有特定的功能，但有关此的文档很少。

例如在 WordPress 中，我会在 init 钩子中添加一些自定义操作，并在 functions.php 文件中调用“add_menu_page”方法。此方法的输入变量之一是包含输出的定制 PHP 文件。

简而言之，我需要知道如何在 EE2 中做同样的事情，因为它没有像 WordPress 那样清楚地记录？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-02T15:03:50.893

我们发现最简单的解决方案是使用[http://pkg.io/](http://pkg.io/)为您生成基本的扩展类，允许任何有能力的程序员填补空白以生成用户界面。

# r - 没有可视化的大型网络布局算法

> ID：12379356
> 
> 赞同：0
> 
> 时间：2012-09-11T23:35:58.073
> 
> 标签：r, igraph, sna

有谁知道我可以在不可视化的情况下为大型网络实现强制定向布局算法的资源。我尝试了 R 的 igraph，但在没有可视化的情况下我无法找到获取 x,y 坐标的方法。

任何提示都会很棒

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-12T03:48:23.880

igraph 中的 DrL 布局非常适合较大的图形。我不知道为什么你不能得到坐标，这很简单：

```
library(igraph)
g <- ba.game(10000, 2)
system.time(coords <- layout.drl(g))
#    user  system elapsed 
#  93.629   0.726  96.424 
dim(coords)
# [1] 10000     2 
```

# objective-c - 无法从 UIAlertView 更改视图控制器

> ID：12379359
> 
> 赞同：0
> 
> 时间：2012-09-11T23:36:11.600
> 
> 标签：objective-c, ios, xcode

我正在尝试从 UIAlertView 模态到视图控制器。

```
- (IBAction)cancelScripting:(id)sender {

UIAlertView *areYouSure = [[UIAlertView alloc]initWithTitle:@"Are You Sure?" message:@"Are you sure you want to quit scripting?" delegate:self cancelButtonTitle:@"Cancel" otherButtonTitles:@"OK", nil];

[areYouSure show];

}

- (void)alertView:(UIAlertView *)alertView clickedButtonAtIndex:(NSInteger)buttonIndex {

if (buttonIndex == 1) {

    CRHViewController *firstView = [[CRHViewController alloc] init];

    [self.navigationController modalViewController:firstView animated:YES];    }
} 
```

在我的 .h 文件中，我有一个 UINavigatoinDelegate 集

```
@interface CRHScripting : UIViewController     <UITextViewDelegate,UINavigationControllerDelegate> 
```

在情节提要中，我将视图控制器的标识符设置为 firstView。

线

```
[self.navigationController modalViewController:firstView animated:YES]; 
```

给我带来了所有的麻烦。错误说

```
"No visible @interface for 'UINavigationController' declares the selector     'modalViewController:animated:' 
```

这是什么意思？

**更新：现在我的视图不会完全加载，但它会显示视图控制器**

这是我的初始化代码：

```
#import "CRHViewController.h"

@interface CRHViewController ()

@end

@implementation CRHViewController

-(void)updateTimer {

NSDateFormatter *format = [[NSDateFormatter alloc]init];

[format setDateFormat:@"h:mm"];
clockLabel.text = [format stringFromDate:[NSDate date]];

}

- (void)viewDidLoad
{
    [super viewDidLoad];

    // Do any additional setup after loading the view, typically from a nib.

    timer = [NSTimer scheduledTimerWithTimeInterval:0.5 target:self     selector:@selector(updateTimer) userInfo:nil repeats:YES];

    [homeIconScrollView setScrollEnabled:YES];
    [homeIconScrollView setContentSize:CGSizeMake (150,1100)];

    NSLog(@"Did Load first View"); 

}

- (void)viewDidAppear:(BOOL)animated {

[UIImageView beginAnimations:NULL context:nil];
[UIImageView setAnimationDuration:2];
[scrollNotify setAlpha:0];
[UIImageView commitAnimations];

}

- (void)viewDidUnload
{
[super viewDidUnload];
// Release any retained subviews of the main view.
}

- (BOOL)shouldAutorotateToInterfaceOrientation:  (UIInterfaceOrientation)interfaceOrientation
{
return (interfaceOrientation == UIDeviceOrientationLandscapeRight);
}

@end 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-11T23:37:08.497

你有一个错字：它的`presentModalViewController`.

它会引发该错误，因为它找不到您拼写错误的名称的方法

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-12T00:11:18.117

`- (void)presentViewController:(UIViewController *)viewControllerToPresent animated:(BOOL)flag completion:(void (^)(void))completion`是 UIViewController 方法而不是 UINavigationController 方法。正确的行是：

```
[self presentViewController:firstView animated:YES completion:nil]; 
```

*请注意，`- (void)presentModalViewController:(UIViewController *)modalViewController animated:(BOOL)animated`现在显示为已弃用。如果您仍然想使用它：

```
[self presentModalViewController:firstView animated:YES]; 
```

# javascript - nivo 滑块捕获 controlnav 的链接标题

> ID：12379360
> 
> 赞同：0
> 
> 时间：2012-09-11T23:36:22.883
> 
> 标签：javascript, jquery, html, nivo-slider

基本上，在 nivoslider 中，在 js 文件中设置了它，因此数字显示在 controlnav 部分。这些数字似乎是从此处代码中的“rel”信息中获得的。我只是想知道我可以添加什么内容，以便它从我放入幻灯片的链接中检索“标题”或“替代”。这意味着我可以在 id 可以控制的 controlnav 中显示文本。

```
 if(settings.controlNav){
        vars.controlNavEl = $('<div class="nivo-controlNav"></div>');
        slider.after(vars.controlNavEl);
        for(var i = 0; i < kids.length; i++){
            if(settings.controlNavThumbs){
                vars.controlNavEl.addClass('nivo-thumbs-enabled');
                var child = kids.eq(i);
                if(!child.is('img')){
                    child = child.find('img:first');
                }
                if(child.attr('data-thumb')) vars.controlNavEl.append('<a class="nivo-control" rel="'+ i +'"><img src="'+ child.attr('data-thumb') +'" alt="" /></a>');
            } else {
                vars.controlNavEl.append('<a class="nivo-control" rel="'+ i +'">'+ (i + 1) +'</a>');
            }
        } 
```

我已经看到其他链接，其中讨论了用 etc 替换`i + 1`，`child.attr("alt)`但它似乎不起作用。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-13T16:20:46.027

这是我对您的问题的解决方案：

添加行`var child = kids.eq(i);`

前：

```
vars.controlNavEl.append('<a class="nivo-control" rel="'+ i +'">'+ child.attr('alt') +'</a>'); 
```

# android - 如何测试我的 Windows 8 应用程序

> ID：12379365
> 
> 赞同：0
> 
> 时间：2012-09-11T23:37:20.960
> 
> 标签：android, ios5, windows-8

我打算使用 HTML5 开发一个基于寡妇 8 的应用程序。我没有任何 Windows 手机/平板电脑。

Microsoft/或任何第三方是否推出了允许我在基于 iOS/Android 的设备上测试传感器的应用程序？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-12T03:19:26.703

在适用于 Windows 8 的 Visual Studio 2012 Express 中，有一个模拟器可让您模拟平板电脑的功能：触摸、方向（因此您可以模拟将平板电脑旋转到纵向模式）、不同的分辨率/屏幕尺寸和位置。但是要使用它进行开发，您必须将 Windows 8 作为操作系统运行。

Microsoft 不支持在 iOS/Android 设备上进行测试。但是，有一些第三方构建了游戏创建软件（例如[GameSalad](http://gamesalad.com/)或[Scirra 的 Construct 2](http://scirra.com)），允许您构建游戏，然后将其导出为 Windows 8 应用程序（以及 iOS 应用程序和 Android 应用程序等）。 ）。即使您没有运行 Windows 8 作为操作系统，您也可以使用这些。

# asp.net-mvc-3 - asp.net mvc3，knockout.js 表单提交到服务器

> ID：12379372
> 
> 赞同：1
> 
> 时间：2012-09-11T23:38:17.603
> 
> 标签：asp.net-mvc-3, jquery-mobile, knockout.js

我有一个视图显示从 ViewModel 填充的用户列表。

```
 function MyUser(data) {
     this.Id = ko.observable(data.Id);
     this.phone = ko.observable(data.Phone);
     this.Company = ko.observable(data.Company);
     this.SelectedGrowerID = ko.observable(data.SelectedGrowerID);

     this.setSelectedClass = function (item, event) {
        $('#hfGrowerID').val(event.target.id);

      this.SelectedGrowerID = event.target.id;
    };
   }

    function UserListViewModel() {
    // Data
    var self = this;
    self.users = ko.observableArray([]);

    // Load initial state from server, convert it to MyUser instances, then  populate  self.users
    $.getJSON("UserList/GetAllUsers", function (allData) {
    var mappedUsers = $.map(allData, function (item) { return new MyUser(item) });
    self.users(mappedUsers);
    }); 
```

我有一个简单的表单，其中包含绑定到每个用户的公司的列表项。此外，我有一个隐藏字段，当单击每个列表项时，我将用户的 ID 保存到该字段中。

```
 <form action="UserList/Save" method="post">
          <ul id="UserList" data-bind="foreach: users" data-role="listview">
            <li data-bind="click: setSelectedClass"><a data-bind="attr: {id: Id}">
            <span data-bind="text: Company" /></a></li>
          </ul>

          <input id="hfGrowerID" type="hidden" />
          <input type="hidden" name="users" data-bind="value: ko.toJSON(users)" />

          <button type="submit">Save</button>
        </form> 
```

在我的 UserListController 中，我想获取隐藏字段“hfGrowerID”的值。保存函数如下所示：

```
 <HttpPost()>
     Public Function Save(<FromJson()> users As IEnumerable(Of MyUserModel),
     hfGrowerID As String) As ActionResult
       'do stuff
       Return View ("Index", users)
     End Function 
```

现在，问题是， hfGrowerID 没有任何价值，并且做 Request.Form("hfGrowerID") 也没有返回任何东西。我通过执行 alert 和 console.log 验证了 hfGrowerID 在单击列表项后正在获取一个值。

如何获取不属于我的 ViewModel 的隐藏字段的值？

非常感谢您的帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-11T23:53:19.320

为什么不添加`selectedGrowerId`到您的 ViewModel？

如果您通过 AJAX 发布表单，您甚至不需要隐藏表单字段！

我猜这个`setSelectedClass`函数，当用户点击你的一个`<li>`标签时调用的函数，当前正在设置`hfGrowerID`隐藏表单字段的值？

相反，让该函数在 ViewModel 中设置 的值`selectedGrowerId`，并更改提交按钮，使其成为一个普通按钮，其`click`事件绑定到`submitForm`通过 AJAX 发布必要数据的函数。

**更新：** *对添加到问题的附加代码的回应*

我敢打赌，你的推荐信`this`给你带来了麻烦。

尝试将您的`MyUser`功能更改为以下内容：

```
function MyUser(data) {
    var self = this;
    self.Id = ko.observable(data.Id);
    self.phone = ko.observable(data.Phone);
    self.Company = ko.observable(data.Company);
    self.SelectedGrowerID = ko.observable(data.SelectedGrowerID);

    self.setSelectedClass = function (item, event) {
        $('#hfGrowerID').val(event.target.id);
        self.SelectedGrowerID = event.target.id;
    };
} 
```

尽管看起来我只是简单地替换`this`为`self`，但我相信函数`this`内部的含义与该`setSelectedClass`函数外部的值相比，`this`在 MyUser 函数中购买的值有所不同。

# r - 用一些简单的算术按秒排序

> ID：12379373
> 
> 赞同：-3
> 
> 时间：2012-09-11T23:38:20.383
> 
> 标签：r, posixct

```
x <-80

 test <- seq(from=as.POSIXct('x - 1',format='%M'),to=as.POSIXct('x +
 1',format='%M'),by='sec')
 # this doesn't actually work 
```

我想要做的是在这里以秒为增量创建一个序列，但我想在我的“to”和“from”参数中加入一些简单的算术。

上面的代码显然不起作用，我能得到一些帮助吗？

我需要一些可以用于大于和小于 60 的数值的东西。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-12T00:26:53.893

试试这个：

```
test <- seq(from=strptime(x - 1, format='%M'),
            to=strptime(x + 1, format='%M'),
            by='sec') 
```

然后，您可以`format`随心所欲。

请看一下，`?strptime`因为它是一个非常有用的帮助页面，当您在 R 中使用日期/时间时，您可能会多次参考它。

* * *

你可以把@plannapus 的好建议像这样工作

```
tmp <- seq(strptime(paste((x-1)%/%60, (x-1)%%60, sep=":"), format="%H:%M"), 
           strptime(paste((x+1)%/%60, (x+1)%%60, sep=":"), format="%H:%M"), 
           by='sec')
as.numeric(format(tmp, "%M.%S")) 
```

但是，您确实应该重新考虑您的问题和/或提供有关您正在尝试做的事情的更多信息，因为我的猜测是有更好的方法来做您正在做的任何事情。

# php - PHP 和 Smarty 无法让 IF 工作

> ID：12379375
> 
> 赞同：0
> 
> 时间：2012-09-11T23:38:25.593
> 
> 标签：php, if-statement, smarty

我有这段代码无法正常工作。我错过了什么？我希望最后一个 div 显示在除 index.php 之外的所有页面上

```
{if $smarty.server.REQUEST_URI eq "index.php"} 
<div id="banner_container">
    <div class="center">
 {else}
 <div id="banner_top_container">
 <div class="center clearfix">
 {/if} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-11T23:54:58.637

您可能需要 REQUEST_URI 环境中的前导斜杠...

```
{if $smarty.server.REQUEST_URI == '/index.php'} 
```

*-或者-*

```
{if $smarty.server.REQUEST_URI|strstr:'index.php'} 
```

*-或者-*

```
{if $smarty.server.REQUEST_URI|strpos:'/index.php' === 0} 
```

一种更简洁的方法是将“page”变量分配给 smarty 实例

```
$smarty->assign('page','index'); 
```

然后你可以在其中测试

```
{if $page == 'index'} 
```

因为索引页面上的任何其他查询字符串参数都会导致非常明确的匹配失败

# c - 使用 C，我如何编写代码来计算输入整数的二进制形式中有多少个 1？

> ID：12379377
> 
> 赞同：0
> 
> 时间：2012-09-11T23:38:35.533
> 
> 标签：c

我一直在做一些功课，基本上只是将输入的整数转换为二进制形式。到目前为止，我在将输入的整数转换为二进制数以及拒绝任何负数方面取得了很大进展。

然而，我遇到的问题是计算二进制代码中 1 的数量并打印二进制表示中有多少个。我已经尝试了许多来自互联网和我的书的代码示例（不是直接复制和粘贴，我已经尝试过适合我的需要）但到目前为止都无济于事。我相信这是因为我没有关注特定的数字。

基本上，我是 C 的新手，非常新。我过去 2 个学期的大部分时间都是用 Java 完成的，并且没有任何其他语言的编程经验，只是想寻求帮助。只是为了重申这个问题：

如何计算输入的二进制表示中的个数？

示例：输入 44，二进制为 101100 1 的个数：3

编辑：到目前为止，对于已实现的代码，我现在的新问题是无论我输入什么整数，输出仍然是 12。

```
#include <stdio.h>

int main(void)
{
     int integer; // number to be entered by user
     int i, b, v;
     unsigned n = 0;
     while(v) {
        ++n;
        v &= v - 1;
      }
     printf("Please type in a decimal integer\n"); // prompt
     fflush(stdout);
     scanf("%d", &integer); // read an integer

      if(integer < 0)
{
    printf("Input value is negative!"); // if integer is less than
    fflush(stdout);

    return;                  // zero, print statement
}
     else{
    printf("Binary Representation:\n", integer);
    fflush(stdout);}

  for(i = 31; i >= 0; --i) //code to convert inputted integer to binary form
{
    b = integer >> i;
    if(b&1){
    printf("1");
    fflush(stdout);
    }
    else{
    printf("0");
    fflush(stdout);
    }
    }
     printf("\n");
     fflush(stdout);
     printf("Number of 1's in Binary Representation:%d\n", n);
     fflush(stdout);
     printf("\n");
     fflush(stdout);
     return 0;

}//end function main 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-11T23:49:31.977

编辑：在这里使用它：

```
ones = 0;
while (integer) { ++ones; integer &= integer - 1; } 
printf("Number of 1's in Binary Representation: %d\n",ones);
fflush(stdout); 
```

并首先声明：

```
unsigned int ones; 
```

完整代码：

```
#include <stdio.h>
#include <stdlib.h>

int main(void){
    int integer; // number to be entered by user
    int i, b, n;
    unsigned int ones;
    printf("Please type in a decimal integer\n"); // prompt
    fflush(stdout);
    scanf("%d", &integer); // read an integer

    if(integer < 0)
    {
        printf("Input value is negative!"); // if integer is less than
        fflush(stdout);

        return;                  // zero, print statement
    }
    else{
        printf("Binary Representation:\n", integer);
        fflush(stdout);}

     for(i = 31; i >= 0; --i) //code to convert inputted integer to binary form
    {
        b = integer >> i;
        if(b&1){
        printf("1");
        fflush(stdout);
        }
        else{
        printf("0");
        fflush(stdout);
        }
        }
    printf("\n");
    fflush(stdout);
    ones = 0;
    while (integer) { ++ones; integer &= integer - 1; } 
    printf("Number of 1's in Binary Representation: %d\n",ones);
    fflush(stdout);
    printf("\n");
    fflush(stdout);
    return 0;
} 
```

# iphone - 插入排序算法输出错误

> ID：12379379
> 
> 赞同：-1
> 
> 时间：2012-09-11T23:39:07.497
> 
> 标签：iphone, objective-c, xcode, arrays, nsmutablearray

我正在将以下代码从 C 转换为 Obj-C C 代码行在下面注释并替换为 Obj-C ，但我在结果中有问题排序无法正常工作这里是代码之后的结果如果有人可以帮助PLZ

```
-(IBAction)clicked_insertsort:(id)sender{

    NSMutableArray  *iarray = [[NSMutableArray alloc]initWithArray:garr];
    int n = [iarray count]  ;
    NSLog(@"%@",iarray);

    int i,j,x;

     for(i=1;i<=n-1;i++)  

     {  
     j=i;  

     //x=a[i]; 
    x=[[iarray objectAtIndex:(NSUInteger)i]intValue];    

     //while(a[j-1]>x && j>0)  
     while (j>0 &&[[iarray objectAtIndex:(NSUInteger)j-1]intValue] >x)

     {  

     //a[j]=a[j-1];
    [iarray replaceObjectAtIndex: (j) withObject: [iarray objectAtIndex: (j-1)]];
     j=j-1;  
     }  

    // a[j]=x;  
    [[iarray objectAtIndex:(NSUInteger)j]intValue] == x; 

     }
    NSLog(@"%@",iarray);
} 
```

排序前

```
[Session started at 2012-09-12 02:13:43 +0300.]
2012-09-12 02:13:49.127 sort_alg[1748:207] (
43,
18,
15,
135,
37,
81,
157,
166,
117,
110 
```

)

```
and after sort
2012-09-12 02:13:49.130 sort_alg[1748:207] (
43,
43,
43,
43,
135,
135,
135,
135,
157,
166 
```

)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-11T23:52:35.630

这没有做你认为它正在做的事情：

```
[[iarray objectAtIndex:(NSUInteger)j]intValue] == x; 
```

它在 index 处获取对象的 intValue ，`j`然后与 进行比较`x`，结果没有做任何事情。

您应该阅读文档`NSArray`并使用内置的排序方法。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-12T00:16:51.207

要设置（替换）数组的元素，您首先要执行以下操作：

```
//a[j]=a[j-1];
[iarray replaceObjectAtIndex: (j) withObject: [iarray objectAtIndex: (j-1)]]; 
```

然后由于某种原因，当您下次想做类似的事情时，您可以尝试：

```
// a[j]=x;  
[[iarray objectAtIndex:(NSUInteger)j]intValue] == x; 
```

您是否添加了`==`以消除编译器错误？

第一种方法是正确的 - 您需要调用一个方法来设置（替换）数组中的元素。

现在你知道答案了...

# php - PHP/MYSQL 字符串说明

> ID：12379382
> 
> 赞同：-1
> 
> 时间：2012-09-11T23:39:57.977
> 
> 标签：php

晚上，我想澄清一下。我可以在带有 php 变量的选择查询中使用来指定字段的名称吗？例如：

```
<?php
$fields= "firstname, lastname, address";
$query = "SELECT $fields FROM friends 
WHERE firstname='test'";
...
?> 
```

提前谢谢你！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-11T23:40:58.070

是的..........................................

# asp.net - Facebook 评论审核困难

> ID：12379383
> 
> 赞同：4
> 
> 时间：2012-09-11T23:40:07.770
> 
> 标签：asp.net, asp.net-mvc, facebook, facebook-opengraph, facebook-comments

我正在尝试对 Facebook 评论插件实施审核，该插件将在我的网站中使用。我已确保以下两个标签位于 HTML 头部部分中：

```
<meta property="fb:admins" content="582222130,804179xxx"/>
<meta property="fb:app_id" content="280627238712xxx"/> 
```

我已将脚本放在正文标记的末尾上方：

```
<script type="text/javascript">    (function (d, s, id) {
    var js, fjs = d.getElementsByTagName(s)[0];
    if (d.getElementById(id)) return;
    js = d.createElement(s); js.id = id;
    js.src = "//connect.facebook.net/en_GB/all.js#xfbml=1&appId=280627238712xxx";
    fjs.parentNode.insertBefore(js, fjs);
} (document, 'script', 'facebook-jssdk'));</script> 
```

我在正确的位置放置了 div 标签：

```
<div class="fb-comments" data-href="http://www.sss.net/xxx" data-num-posts="5" data-width="585"> 
```

[Facebook 评论加载到浏览器上，当我访问此页面](https://developers.facebook.com/tools/comments?view=recent_comments)时，除了审核之外，一切似乎都正常工作，根本没有评论。我已确保我已将自己添加为管理员，head 标签 (fb:admins) 中的标签中的 id 之间没有空格。

创建 Facebook 应用程序时是否需要配置任何设置？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-11T23:52:05.307

看起来用于获取插件代码的 appId 与您在元标记中添加的 appID 不同。在您的评论审核工具中，您是否正在查看合适的应用程序？也许检查并查看将元标记更改为相同的 app_id 是否可以修复它。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-09-14T14:14:35.813

您是否尝试过拆分 fb:admins 标签？（此处描述：[og标签中的多个fb：admins](http://facebook.stackoverflow.com/questions/12422193/multiple-fbadmins-in-og-tags)）

第二个猜测：您是否尝试过使用 facebook 调试器调试 data-href-url？[https://developers.facebook.com/tools/debug](https://developers.facebook.com/tools/debug)所有 og-tags 都会缓存 24 小时 - 如果您使用上述工具调试 url，那么所有缓存的数据都会重新加载。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-09-17T20:44:33.930

终于修好了！！

我忘了把

```
<div id="fb-root"></div> 
```

html 标签，它造成了所有这些问题。非常感谢所有努力提供帮助的人！Stackoverflow 摇滚！

# queue - 循环队列的虚拟流

> ID：12379392
> 
> 赞同：1
> 
> 时间：2012-09-11T23:41:24.560
> 
> 标签：queue, circular-buffer

我想实现一个循环队列，它会为我的应用程序的 size() 动态增长和缩小。在搜索相关线程的堆栈溢出时，我遇到了这个 [用于计算循环缓冲区中剩余空间的简化算法？](https://stackoverflow.com/questions/450558/simplified-algorithm-for-calculating-remaining-space-in-a-circular-buffer)MSN 提到了虚拟流。

有没有人将这种索引用于循环队列？这方面的一些背景知识将帮助我实现这种机制。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-11T23:51:43.793

好吧，您知道队列的大小，如果您在访问它们时使用占用单元格的计数器，您可以轻松找到空闲单元格的数量。

但是，如果您的队列在大小超过负载因子时会增长，并继续扩大，那么您将不知道何时缩小。那为什么不只使用队列。

就我个人而言，我总是发现循环队列在大小固定时很有用。否则队列也会这样做。

# wso2 - 在 WSO2 ESB 4.0.3 中启用 XSLT 2.0 时，WSO2 管理 UI“试试看”中断

> ID：12379395
> 
> 赞同：0
> 
> 时间：2012-09-11T23:41:34.463
> 
> 标签：wso2, wso2esb, wso2carbon

根据以下 URL，我启用了 XSLT 2.0 支持

[阿查拉博客条目](http://achala11.blogspot.com/2012/04/how-to-get-xslt-20-support-with-wso2.html)

在那之后看起来 TryIt 服务无法正常工作。在管理 UI 中，我单击“试用此服务”链接时出现以下错误

```
[2012-09-10 11:47:03,491]  INFO - CarbonAuthenticationUtil 'admin' logged in at [2012-09-10 11:47:03,0491] from IP address 0:0:0:0:0:0:0:1%0
Warning: at xsl:stylesheet on line 32 of :
  Running an XSLT 1.0 stylesheet with an XSLT 2.0 processor
Warning: on line 286 of :
  The attribute axis starting at a namespace() node will never select anything
Error on line 1603 of :
  XPTY0004: Required item type of second operand of '|' is node(); supplied value has item
  type xs:string
[2012-09-10 11:47:09,515] ERROR - Util Required item type of second operand of '|' is node(); supplied value has item type xs:string
; SystemID: ; Line#: 1603; Column#: -1
net.sf.saxon.trans.DynamicError: Required item type of second operand of '|' is node(); supplied value has item type xs:string 
```

当我撤消博客条目中提到的恢复 XSLT 1.0 支持时，此错误消失了。你能帮忙吗？谢谢阿比吉特

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-12T04:30:56.827

不幸的是，TryIt 组件被绑定到 XSLT 1.0 语法，并且使用了 Salan。因此，如果您使用 remove Salan 并添加 saxson，则 try-it 填充会中断。此问题已在新的 ESB (4.5.0) 中得到纠正。

问候，/女娲

# string - MIPS - 检查数组的元素是否为空终止字符

> ID：12379397
> 
> 赞同：3
> 
> 时间：2012-09-11T23:41:49.087
> 
> 标签：string, mips

所以我正在尝试编写一个函数来查找 MIPS 中字符串的长度。

我正在沿着数组行走/遍历，加载每个字符，并且我想将每个字符与空终止字符进行比较，以查看字符串是否已“结束”。在每次连续迭代中，我都会增加一个计数器，然后在字符串“结束”后将计数器存储在 $v0 中。但是，如何比较当前加载的字符是否为空终止字符“\0”？更具体地说，我如何表示这个空终止字符？正如我在下面所做的那样，它是零美元吗？如果是这样，那么我还做错了什么？收到地址错误。

```
.data
msg1:.asciiz "Please insert text (max 20 characters): "
msg2:.asciiz "\nThe length of the text is: "

newline: .asciiz "\n"

str1: .space 20
.text
.globl main
main:
addi $v0, $v0,4
la $a0,msg1
syscall #print msg1
li $v0,8
la $a0,str1
addi $a1,$zero,20
syscall   #get string 1

la $a0,str1  #pass address of str1
jal len

len: 
addi $t2, $zero, 0 # $t2 is what we want to return in the end -- the count of the length of the character array
addi $s1, $zero, 0 # Index i for array traversing | init. to 0 | i = 0

Loop:

add $s1, $s1, $a0 # Adds the location of the index to the location of the base of the array | $t1 is now the location of: array[index]
lw $t0, 0($s1)

beq $t0, $zero, exit
addi $t2, $t2, 1 # Count = Count + 1
addi $s1, $s1, 1 # i = i + 1
j Loop

exit: 
la $a0,msg2 
li $v0,4
syscall
move $a0,$t0 #output the results 
li $v0,1
syscall

li $v0,10
syscall 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-12T01:42:37.460

假设您正在处理一个字节字符串，并且您正在寻找字符串末尾的零字节，您应该使用`lbu $t0, 0($s1)`. `lbu`意思是“加载没有符号扩展的字节”。然后你可以`$t0`与`$zero`寄存器进行比较。您当前的代码使用`lw $t0, 0($s1)`将 4 个字节加载到`$t0`.

您的代码中还有一些其他错误，但我会让您自己弄清楚，因为这看起来像是家庭作业。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-10-30T13:29:02.093

以下程序计算字符串的长度

```
.data   
theStr: .asciiz "berjee"
.text
main:
    li $s1, 0
    la $s0, theStr

loop:
    lb $a0, 0($s0)
    beqz $a0, out
    addi $s0, $s0, 1
    addi $s1, $s1, 1
    j loop

out:
    li $v0, 1
    add $a0, $0, $s1
    syscall
    li $v0, 10
    syscall 
```

# php - 查询集中的最大值

> ID：12379398
> 
> 赞同：0
> 
> 时间：2012-09-11T23:41:49.770
> 
> 标签：php, mysql, max, opencart

我有以下代码

```
$this->db->query("UPDATE customer_product_owned
   SET quantity = (max(0, (quantity - " . (int)$order_product_upgrade['quantity'] . ")))
   WHERE customer_id = '" . (int)$order_info['customer_id'] . "'"); 
```

我希望从数量字段的值中减去 php 变量。但是，如果该值小于 0，我希望该值为 0。

我在这里做错了什么？可以在“集合”中使用 max 吗？我可以通过首先找出数量的值来预先通过附加查询来做到这一点，但是有没有办法在同一个查询中做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-11T23:43:48.427

1.  `MAX`是一个聚合函数。你需要`GREATEST(0, ...)`
2.  不要用引号将数字括起来。只需按原样指定它们，例如：

    ```
    WHERE customer_id = " . (int)$order_info['customer_id'] 
    ```

# java - 将值或访问从 jDialog 传递到 jFrame，反之亦然

> ID：12379400
> 
> 赞同：-1
> 
> 时间：2012-09-11T23:42:08.633
> 
> 标签：java, swing

好的，我确实阅读了您发布的链接，但出现以下错误：

```
Exception in thread "AWT-EventQueue-0" java.lang.NullPointerException
at client.medical.main.Main.jMenuItem6ActionPerformed(Main.java:348)
at client.medical.main.Main.access$400(Main.java:21)
at client.medical.main.Main$5.actionPerformed(Main.java:249)
at javax.swing.AbstractButton.fireActionPerformed(AbstractButton.java:2018)
at javax.swing.AbstractButton$Handler.actionPerformed(AbstractButton.java:2341)
at javax.swing.DefaultButtonModel.fireActionPerformed(DefaultButtonModel.java:402)
at javax.swing.DefaultButtonModel.setPressed(DefaultButtonModel.java:259)
at javax.swing.AbstractButton.doClick(AbstractButton.java:376)
at javax.swing.plaf.basic.BasicMenuItemUI.doClick(BasicMenuItemUI.java:833)
at javax.swing.plaf.basic.BasicMenuItemUI$Handler.mouseReleased(BasicMenuItemUI.java:877)
at java.awt.Component.processMouseEvent(Component.java:6505)
at javax.swing.JComponent.processMouseEvent(JComponent.java:3321)
at java.awt.Component.processEvent(Component.java:6270)
at java.awt.Container.processEvent(Container.java:2229)
at java.awt.Component.dispatchEventImpl(Component.java:4861)
at java.awt.Container.dispatchEventImpl(Container.java:2287)
at java.awt.Component.dispatchEvent(Component.java:4687)
at java.awt.LightweightDispatcher.retargetMouseEvent(Container.java:4832)
at java.awt.LightweightDispatcher.processMouseEvent(Container.java:4492)
at java.awt.LightweightDispatcher.dispatchEvent(Container.java:4422)
at java.awt.Container.dispatchEventImpl(Container.java:2273)
at java.awt.Window.dispatchEventImpl(Window.java:2719)
at java.awt.Component.dispatchEvent(Component.java:4687)
at java.awt.EventQueue.dispatchEventImpl(EventQueue.java:723)
at java.awt.EventQueue.access$200(EventQueue.java:103)
at java.awt.EventQueue$3.run(EventQueue.java:682)
at java.awt.EventQueue$3.run(EventQueue.java:680)
at java.security.AccessController.doPrivileged(Native Method)
at java.security.ProtectionDomain$1.doIntersectionPrivilege(ProtectionDomain.java:76)
at java.security.ProtectionDomain$1.doIntersectionPrivilege(ProtectionDomain.java:87)
at java.awt.EventQueue$4.run(EventQueue.java:696)
at java.awt.EventQueue$4.run(EventQueue.java:694)
at java.security.AccessController.doPrivileged(Native Method)
at java.security.ProtectionDomain$1.doIntersectionPrivilege(ProtectionDomain.java:76)
at java.awt.EventQueue.dispatchEvent(EventQueue.java:693)
at java.awt.EventDispatchThread.pumpOneEventForFilters(EventDispatchThread.java:244)
at java.awt.EventDispatchThread.pumpEventsForFilter(EventDispatchThread.java:163)
at java.awt.EventDispatchThread.pumpEventsForHierarchy(EventDispatchThread.java:151)
at java.awt.EventDispatchThread.pumpEvents(EventDispatchThread.java:147)
at java.awt.EventDispatchThread.pumpEvents(EventDispatchThread.java:139)
at java.awt.EventDispatchThread.run(EventDispatchThread.java:97) 
```

我编辑了我的代码，使它看起来像你给我的链接中的那个。

JDialog：我刚刚添加了一个新的 JButton，如下所示：

```
private void jButton2ActionPerformed(java.awt.event.ActionEvent evt) {

    Window win = SwingUtilities.getWindowAncestor(this);
    if (win != null) {
        win.dispose();
     }
   }
  public String getFieldText() {
     return jTextField1.getText();
  } 
```

JFrame：在这里我制作了 2 个变量 dialogPanel 和 dialog 然后编辑了打开 jdialog 的按钮，这里是代码：

```
 private Recherche dialogPanel = new Recherche();
 private JDialog dialog;    
 private void jMenuItem6ActionPerformed(java.awt.event.ActionEvent evt) {                                           
  if (dialog == null) {
     Window win = SwingUtilities.getWindowAncestor(this);
      if (win != null) {
        dialog = new JDialog(win, "My Dialog",
                 Dialog.ModalityType.APPLICATION_MODAL);
        dialog.getContentPane().add(dialogPanel);
        dialog.pack();
        dialog.setLocationRelativeTo(null);
     }
  }
  dialog.setVisible(true); // here the modal dialog takes over
  System.out.print(dialogPanel.getFieldText());

} 
```

我知道我在这里搞砸了，但我看不到它，你能帮我解决这个问题吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-11T23:54:44.897

对于初学者，不要使用`JDialog#show()`，因为该方法已被弃用（请查看 JDialog API 以了解更多信息）。而是使用`JDialog#setVisible(true)`.

这段代码是从“主框架”中调用的吗？

如果是这样，由于您的对话框是模态的，您可以在设置为可见后立即在代码中查询对话框实例以了解其变量的状态。您可以使用 getter（也称为访问器）方法来提取此信息。否则，您需要对“主框架”实例进行有效引用才能传递信息。

如需更多帮助，请告诉我们更多关于您的问题的信息。另外，请注意，我很少有扩展 JFrame 或 JDialog 的类，而是在需要保存我的 GUI 时创建我的 JFrame 或 JDialog，这些 GUI 旨在创建 JPanel 以获得更大的灵活性。

**编辑**
关于您最近的编辑，我仍然看不到您卡在哪里，但让我们简化问题，让您尝试从 JDialog 中的 JTextField 获取信息并使用该信息填充 JFrame 中的 JTextField . 我会给对话框类一个`getFieldText()`返回其字段中保存的文本的方法，然后在对话框返回后，让 JFrame 在*对话框实例上调用此方法。*

有关这方面的具体示例，请参阅我在此答案中发布的[代码](https://stackoverflow.com/a/7017147/522444)。

**编辑 2**
例如，使用您的代码，一切正常。因此，如果您仍然遇到问题，您必须向我们展示更多：

```
import java.awt.*;
import java.awt.event.*;

import javax.swing.*;

public class DialogEg {
   private static void createAndShowGUI() {
      MainPanelGen mainPanelGen = new MainPanelGen();

      JFrame frame = new JFrame("DialogEg");
      frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
      frame.getContentPane().add(mainPanelGen.getMainPanel());
      frame.pack();
      frame.setLocationRelativeTo(null);
      frame.setVisible(true);
   }

   public static void main(String[] args) {
      SwingUtilities.invokeLater(new Runnable() {
         public void run() {
            createAndShowGUI();
         }
      });
   }

}

class MainPanelGen {
   private JPanel mainPanel = new JPanel();
   private JTextField field = new JTextField(10);
   private JButton btn = new JButton(new BtnActn());
   private JDialog dialog;
   private DialogPanel dialogPanel = new DialogPanel();

   public MainPanelGen() {
      mainPanel.add(field);
      mainPanel.add(btn);

      field.setEditable(false);
      field.setFocusable(false);
   }

   public JPanel getMainPanel() {
      return mainPanel;
   }

   private class BtnActn extends AbstractAction {
      BtnActn() {
         super("Button");
      }

      @Override
      public void actionPerformed(ActionEvent arg0) {
         if (dialog == null) {
            Window win = SwingUtilities.getWindowAncestor(mainPanel);
            if (win != null) {
               dialog = new JDialog(win, "My Dialog",
                     Dialog.ModalityType.APPLICATION_MODAL);
               dialog.getContentPane().add(dialogPanel);
               dialog.pack();
               dialog.setLocationRelativeTo(null);
            }
         }
         dialog.setVisible(true); // here the modal dialog takes over
         System.out.println   (dialogPanel.getFieldText());
         field.setText(dialogPanel.getFieldText());
      }
   }
}

class DialogPanel extends JPanel {
   private JTextField field = new JTextField(10);
   private JButton exitBtn = new JButton(new ExitBtnAxn("Exit"));

   public DialogPanel() {
      add(field);
      add(exitBtn);
   }

   public String getFieldText() {
      return field.getText();
   }

   private class ExitBtnAxn extends AbstractAction {

      public ExitBtnAxn(String name) {
         super(name);
      }

      @Override
      public void actionPerformed(ActionEvent arg0) {
         Window win = SwingUtilities.getWindowAncestor(DialogPanel.this);
         if (win != null) {
            win.dispose();
         }

      }

   }

} 
```

您没有告诉我们足够多的信息，无法让我们为您提供帮助。什么线路导致 NPE？您是否测试了该行上的变量以查看哪些变量为空？你有没有回顾过你的代码，看看为什么变量是空的？

# iphone - 快速滚动时，自定义单元格中的多行标签与下一个单元格重叠

> ID：12379401
> 
> 赞同：0
> 
> 时间：2012-09-11T23:42:13.323
> 
> 标签：iphone, objective-c, ios, uitableview

我看到类似的问题几乎被问了几十次，但没有一个答案解决了我的问题（或者我太累了，所以我没有正确地遵循答案）

我有一个带有自定义单元格的表格视图。

细胞看起来像这样

![我在故事板中的自定义单元格](../Images/2a278ed78bf58d3fc2e2709eb4e447df.png)

该单元格是从 UITableViewCell 派生的 ResultsViewCell 类型。

单元格中的最后一个标签是多行单元格。那个有时会与下一个单元格的内容重叠。

这是我的 cellForRowAtIndexPath 函数

```
 - (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath
    {
        static NSString *CellIdentifier = @"StandardSearchResultCell";

        ResultsViewCell *cell = [tableView dequeueReusableCellWithIdentifier:CellIdentifier];

        // Configure the cell...
        Data *theData = [Data getInstance];
        Company *theCompany = [theData.results objectAtIndex:indexPath.row];

        cell.lblTitle.text = theCompany.DisplayName;

        cell.lblDescription.text = theCompany.Description;
        cell.lblAddressPt1.text = theCompany.AddressPt1;
        cell.lblAddressPt2.text = theCompany.AddressPt2;
        cell.lblPhone.text = theCompany.Phone;
        cell.lblEmail.text = theCompany.Email;

        cell.lblDescription.adjustsFontSizeToFitWidth = false;
        cell.lblDescription.lineBreakMode = UILineBreakModeWordWrap;
        cell.lblDescription.numberOfLines = 0;
        [cell.lblDescription sizeToFit];

       ///////////////////////////////////////////
       //edit -Added after David H's answer, but it didn't solve the problem
       cell.contentView.clipsToBounds = false;
       UIFont *cellFont = [UIFont systemFontOfSize:12.0];
       CGSize constraintSize = CGSizeMake(270.0f, MAXFLOAT);
       CGSize labelSize = [theCompany.Description sizeWithFont:cellFont constrainedToSize:constraintSize lineBreakMode:UILineBreakModeWordWrap];
       [cell.contentView setFrame:CGRectMake(cell.contentView.frame.origin.x, cell.contentView.frame.origin.y, 270, 90 + labelSize.height)];
       //end of edit
       ///////////////////////////////////////

        return cell;
    }

- (CGFloat) tableView:(UITableView *)tableView heightForRowAtIndexPath:(NSIndexPath *)indexPath {
    Data *theData = [Data getInstance];
    Company *theCompany = [theData.results objectAtIndex:indexPath.row];

    UIFont *cellFont = [UIFont systemFontOfSize:12.0];
    CGSize constraintSize = CGSizeMake(270.0f, MAXFLOAT);
    CGSize labelSize = [theCompany.Description sizeWithFont:cellFont constrainedToSize:constraintSize lineBreakMode:UILineBreakModeWordWrap];

    return (90.0f + labelSize.height);
} 
```

我究竟做错了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-11T23:47:56.907

这可能会让您感到惊讶，但 UIView 属性 'clipsToBounds' 的默认值为 NO - 也就是说，如果子视图超出视图的框架，则无论如何都要显示它们。

解决方法是确保这些视图中没有一个将“clipsToBounds”设置为 NO。您应该在 cell.contentView 上将其设置为 YES，并确保 cell.contentView 的框架与您在委托 'heightForRowAtIndexPath:' 方法中报告的高度相同。

您可能还需要在多行标签上将“clipsToBounds”设置为“是”（不确定，可能不是）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-12T00:53:20.527

您将需要`tableViewCell`根据该标签的文本高度调整高度。例如采取这种方法：

```
- (int)textHeight:(NSString *)text {
    int width = self.tableView.frame.size.width;
    UILabel *label = [[UILabel alloc] initWithFrame:CGRectMake(0, 0, width, 30)];
    label.numberOfLines = kMyNumberOfLines;

    //setup the label to look like the label of the cell

    label.text = text;
    [label sizeToFit];

    int h = (int)label.frame.size.height;
    [label release];
    return h;
} 
```

然后在您的方法中使用该方法`heightForRowAtIndexPath`来确定单元格的高度。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-12T04:57:01.517

像这样跟...

```
- (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath
{
    UITableViewCell *myCell=[tableView dequeueReusableCellWithIdentifier:@"hi"];
    myCell=[[UITableViewCell alloc]initWithStyle:UITableViewCellStyleDefault reuseIdentifier:@"hi"];

    if (myCell==nil)
    {
        NSArray *viewsToRemove = [mytable1 subviews];

        for (UITableView *table in viewsToRemove) 
        {
            [table removeFromSuperview];
        }
    }    
    return myCell;
} 
```

# java - 无法将 JsonNull 转换为 JsonObject

> ID：12379405
> 
> 赞同：10
> 
> 时间：2012-09-11T23:42:57.897
> 
> 标签：java, json, gson

我想将一个原始属性从一个 JsonObject 复制到另一个

`JsonObject propertyToBeCopied = source.getAsJsonObject(propertyName);`

但我总是遇到这个异常：

`com.google.gson.JsonNull cannot be cast to com.google.gson.JsonObject`

根据文档，应该可以进行演员表，还是我错了？

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2012-09-11T23:57:50.520

根据[文档](http://google-gson.googlecode.com/svn/trunk/gson/docs/javadocs/com/google/gson/JsonNull.html)`JsonNull`是 a`JsonElement`但不是 a `JsonObject`（它本身就是 a `JsonElement`）。使用

```
JsonElement element = source.get(propertyName);
if (!(element instanceof JsonNull)) {
    JsonObject propertyToBeCopied = (JsonObject) element;
} 
```

如果它不是 type ，将返回一个`JsonElement`被强制转换为的 a 。`JsonObject``JsonNull`

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-11T23:50:36.147

根据[API 参考](https://www.javadoc.io/doc/com.google.code.gson/gson/2.6.2/com/google/gson/JsonNull.html)，`JsonNull`派生自`JsonElement`和*非* `JsonObject`，所以我看不出该转换如何有效。

您是否考虑过使用[json-simple](https://github.com/fangyidong/json-simple)代替 gson？作为一般规则，我发现它比其他 json 框架更方便，尽管它当然没有 gson 提供的很多额外功能。但是，如果您使用 gson 所做的只是解析 json，则可能值得切换到更简单的库。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2016-07-26T03:52:33.363

```
JsonElement element = source.get(propertyName);
if (!(element.isJsonNull())) {
    JsonObject propertyToBeCopied = (JsonObject) element;
} 
```

哪一个将具有更好的性能**isJsonNull**或使用**instanceOf**运算符？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2019-11-13T20:58:07.643

如果输出没有响应数组，则有可能引发此错误。

```
JsonObject playListObject = (JsonObject) parser.parse(output);

JsonArray playListInformationArray = playListObject.getAsJsonArray("Response"); 
```

# virtualdub - 连接一系列视频的 VirtualDub 脚本

> ID：12379412
> 
> 赞同：2
> 
> 时间：2012-09-11T23:44:05.637
> 
> 标签：virtualdub

我正在一块一块地处理视频，用文件名保存`scene1.avi`，`scene2.avi`等等。

我想要一种简单的方法将视频构建成一个块并在音轨中配音。为此，我使用了 VirtualDub。

现在，我可以很简单地打开 VirtualDub，通过 File => Open，加载第一个场景，转到 File => Append video segment，选择第二个场景，选中“autodetect additional segments by filename”选项，设置视频到直接流复制，将音频设置为“来自其他文件”并选择音轨，然后将整个内容另存为`out.avi`......但只需四行即可解释所有内容！

我想要一个 VCF 脚本来一起构建所有这些文件。不幸的是，编码语言很烂。

> 我不知道我在创建这种脚本语言时在想什么。它非常松散地基于 C，但它更糟糕。在我创作它之前，我一定一直在看泡泡糖危机。
> 所有语句要么是声明，要么是表达式，并且所有语句都必须以分号结尾。没有流控制——没有函数，没有过程，没有if，没有while，没有for，没有switch，没有goto。

不`if`，不`while`，不`for`……所以我想`while file exists("scene"+i+".avi") {VirtualDub.Append("scene"+i+".avi"); i++;}`这是完全不可能的。

我正在使用批处理脚本来检查 VCF 文件是否存在并使用正确的命令行运行 VirtualDub 来运行脚本，所以也许我可以使用该脚本来“构建”包含所有所需的 VCF 文件文件？有什么方法可以自动检测 VCF 文件中的段，还是我必须使用批处理脚本自定义构建 VCF？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2014-02-23T20:28:20.843

在研究了做非常相似的事情的方法后，我刚刚遇到了这个问题。在我看来，最好的办法是编写一个小脚本或程序，生成一个 VirtualDub 脚本文件以供一次性使用，然后执行它。

例如，我手写了以下脚本来将三个 .avi 文件连接在一起：

```
// Set Video and Audio to Direct Stream Copy
VirtualDub.video.SetMode(0);
VirtualDub.audio.SetMode(0);

VirtualDub.Open(U"D:\path\to\file1.avi");
VirtualDub.Append(U"D:\path\to\file2.avi");
VirtualDub.Append(U"D:\path\to\file3.avi");

VirtualDub.SaveAVI(U"D:\path\to\concatenatedFile.avi");
VirtualDub.Close(); 
```

您可以将其用作模板并从那里开始。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-05-16T00:26:47.300

我刚刚写了一些相关/类似的东西，应该让你开始编码。它是一个批处理文件，因此将以下内容复制到 something.bat：

```
Set Mfps=23.976
Set Bpath="E:\- Video Extractions\Virtualdub\1920x1280 (23.976fps pure,93%%,MPEG2,deinterlaced)auto openNsave.vcf"
rem Set Bpath="E:\- Video Extractions\Virtualdub\852x480 DAR3 (16x9) (24fps,96%%,MPEG2,deinterlaced).vcf"
Set Vdpath="E:\- Video Extractions\Virtualdub\VirtualDub-1.8.8\"
Set Svpath="D:\"
for %%A in (*.mkv *.avi *.mpg *.mpeg *.m2ts *.vob) do >%%~nA.avs echo # M2ts file & >>%%~nA.avs echo SetMemoryMax(128) & >>%%~nA.avs echo DirectShowSource("%%~dA%%~pA%%~nA%%~xA", fps=%Mfps%, audio=true, seekzero = true, convertfps=true) & >>%%~nA.avs echo EnsureVBRMP3Sync() & start /d %Vdpath% VirtualDub.exe /i %Bpath% "%%~dA%%~pA%%~nA.avs" "%Svpath%%%~nA.avi"
rem ---Notes---
rem code requires: Avisynth, virtualdub, pre-existing (.vcf) config file
rem most people prefer to use virtualdub with jobs in queue; run them in sequence. This runs jobs in parallel by searching the directory of the script, finding all listed wildcard masked files below, generating a simple avisynth script file for each file, then opening virtualdub and autosaving the video to .avi
rem caution, this will stress your system. you may only be able to handle 1 file at a time. I can input 30 blueray .m2ts files just fine, so long as i set vdub process to idle or low. Modify the code to your hearts content  ~  TigerWild
rem create a unique .vcf that you will use with this batch file only. Do this by running Virtualdub, opening a video file, configuring all your settings as you want them, then selecting File->save processing settings->.vcf
rem use a text editor to open the vcf file you made, and add these 2 lines:      VirtualDub.Open(VirtualDub.params[0]); VirtualDub.SaveAVI(VirtualDub.params[1]);
rem ---References---
rem http://stackoverflow.com/questions/8749637/dos-command-to-sperate-file-name-and-extension-into-variables
rem http://forum.doom9.org/archive/index.php/t-152842.html     with a nod to stax76 
```

# sql - 在VB中有count linq

> ID：12379414
> 
> 赞同：-2
> 
> 时间：2012-09-11T23:44:10.783
> 
> 标签：sql, vb.net, linq

我有一个 SQL 查询，它返回重复字段以跟踪操作。

```
SELECT contratosfianzas.adquisicion_contrato, count(*) as no_ope 
From contratosfianzas 
GROUP BY contratosfianzas.adquisicion_contrato 
HAVING count(*) > 1 
```

我尝试了此处显示的示例，但我总是返回 1。

请你帮助我好吗。

提前非常感谢你

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-02T10:19:29.723

```
from b in db.contratosfianzas
group b by b.adquisicion_contrato into grup
where grup.Count() > 1
select grup.Key, grup.Count() 
```

# django - Django：使用 Apache 和 mod_xsendfile 提供服务器文件

> ID：12379417
> 
> 赞同：2
> 
> 时间：2012-09-11T23:44:17.783
> 
> 标签：django, apache2

我在为用户下载提供服务器文件时遇到问题。我正在使用带有 mod_xsendfile 的 Apache。首先，如果我尝试在开发服务器上下载文件，则该文件为 0 字节。其次，如果我尝试使用 Apache 提供文件，我会收到错误

SuspiciousOperation：尝试访问 ***** 在行 document.file.path 上被拒绝

```
file_name = document.file.name          
response = HttpResponse(mimetype='application/force-download')
response['Content-Disposition'] = 'attachment; filename=%s' % smart_str(file_name)
response['X-Sendfile'] = document.file.path
return response 
```

我已将 mod_xsend 配置为“Xsend On”。感谢帮助

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-12T07:33:11.390

python代码对我来说看起来很糟糕，在你的apache配置中你必须像这个例子一样配置mode_xsendfile：

```
<Files *.*>
XSendFile on
XSendFilePath /absolute/path/to/your/files
</Files> 
```

还要确保正确加载了 mod_xsendfile。

# c# - 如何结束响应并返回 HTTP 代码 404？

> ID：12379418
> 
> 赞同：10
> 
> 时间：2012-09-11T23:44:19.520
> 
> 标签：c#, asp.net-mvc-3, castle-windsor

我正在使用城堡温莎工厂根据请求 url 实例化一个对象。

就像是：

```
 public FooViewModel Get()
    {
        if (HttpContext.Current == null)
        {
            return new FooViewModel();
        }

        var currentContext = new HttpContextWrapper(HttpContext.Current);

        // resolve actual view model. 
```

在某些情况下，我实际上想抛出 404 并停止请求，目前像：

```
 throw new HttpException(404, "HTTP/1.1 404 Not Found");
        currentContext.Response.End(); 
```

但是请求并没有结束，它仍然会点击 Action 并尝试解析视图？

我的控制器看起来像这样：

```
public class HomeController : Controller
{
    public FooViewModel Foo { get; set; }

    public ActionResult Index()
    {
        ViewBag.Message = "Modify this template to jump-start your ASP.NET MVC application.";

        return View();
    } 
```

我在想这一切都错了吗？或者有什么办法可以做到这一点？

我正在考虑的替代方法是检查 Foo 属性状态的操作属性？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-09-12T00:31:09.867

我认为使用动作过滤器的方法可以实现您想要的：

```
public class RequiresModelAttribute : ActionFilterAttribute
{
    private readonly string _modelName;

    public RequiresModelAttribute(string modelName)
    {
        _modelName = modelName;
    }

    public override void OnActionExecuting(ActionExecutingContext filterContext)
    {
        var property = filterContext.Controller.GetType().GetProperty(_modelName);
        var model = property.GetValue(filterContext.Controller);
        if (model == null)
        {
            filterContext.Result = new HttpStatusCodeResult(404);
        }
    }
} 
```

然后，在您的控制器上，您可以执行以下操作：

```
public class HomeController : Controller
{
    public FooViewModel Foo { get; set; }

    [RequiresModel("Foo")]
    public ActionResult Index()
    {
        ViewBag.Message = "Modify this template to jump-start your ASP.NET MVC application.";

        return View();
    }
} 
```

编辑：也许使用全局过滤器来兑现任何抛出的 HttpExceptions？

```
public class HonorHttpExceptionAttribute : ActionFilterAttribute
{
    public override void OnActionExecuting(ActionExecutingContext filterContext)
    {
        var httpException = filterContext.HttpContext.AllErrors.FirstOrDefault(x => x is HttpException) as HttpException;
        if (httpException != null)
        {
            filterContext.Result = new HttpStatusCodeResult(httpException.GetHttpCode());
        }
    }
} 
```

然后在 Global.asax 中：

```
 public static void RegisterGlobalFilters(GlobalFilterCollection filters)
  {
      filters.Add(new HandleErrorAttribute());
      filters.Add(new HonorHttpExceptionAttribute());
  } 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-12T01:45:59.760

另一种选择是覆盖控制器上的 OnException。

```
 public ActionResult Index()
    {
        ViewBag.Message = "Welcome to ASP.NET MVC!";
        Get();
        return View();
    }

    public int Get()
    {
        throw new HttpException(404, "HTTP/1.1 404 Not Found");
        // we don't need end the response here, we need go to result step
        // currentContext.Response.End();

    }

    protected override void OnException(ExceptionContext filterContext)
    {
        base.OnException(filterContext);
        if (filterContext.Exception is HttpException)
        {
            filterContext.Result = this.HttpNotFound(filterContext.Exception.Message);
        }
    } 
```

# java - 剪辑区域以在动画期间隐藏 JWindow

> ID：12379419
> 
> 赞同：2
> 
> 时间：2012-09-11T23:44:25.443
> 
> 标签：java, swing, animation, jwindow

我正在开发一个 toast 处理程序来管理通过“toast”动画（向上滑动、站立一会儿然后向下滑动）带给用户的通知。Toast 类扩展`JWindow`（只是为了测试，我可以使用`JDialog`更稳定的版本）。

我的问题是创建一种剪辑区域以在动画开始时隐藏 toast (JWindow)。目前窗口在整个动画过程中是可见的，但它应该在`toast.setVisible(true);`执行时完全隐藏并在“向上滑动”阶段开始出现，在“站立”阶段完全可见并在“向下滑动”期间再次开始消失“ 阶段。

我不知道如何设置剪辑区域，有人可以帮助我吗？

我希望这是可以理解的。如果您需要更多详细信息，请告诉我。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-12T00:47:20.553

从 this 开始[`LowerRightFrame`](https://stackoverflow.com/a/9755371/230513)，使用以下初始位置：

```
int x = (int) rect.getMaxX() - f.getWidth();
int y = (int) rect.getMaxY() - f.getInsets().top; 
```

然后使用 a`javax.swing.Timer`定期增加到`y`全高：

```
int y = (int) rect.getMaxY() - f.getHeight(); 
```

在这种方法中，剪裁由主机平台强制执行。请注意，某些平台不会让可见窗口完全脱离屏幕；如果没有可见的拖动条，窗口将无法访问。

# android - 弄清楚状态栏是在顶部还是底部？

> ID：12379423
> 
> 赞同：8
> 
> 时间：2012-09-11T23:45:55.527
> 
> 标签：android

我试图弄清楚如何判断状态栏的位置（顶部或底部）。我试图检查`HierarchyViewer`但没有看到状态栏视图。

我真正需要弄清楚的是，在给定上下文的情况下，一种返回 a 的方法`boolean`（如果 bar 在顶部，则为 true，如果不是，则为 false - 就像***大多数***平板电脑上没有的一样）。我写了一个简单的解决方案来尝试找出状态栏是在顶部还是底部，但它似乎没有帮助：

```
private boolean isStatusBarAtTop(){
    if (!(getContext() instanceof Activity)) {
        return !getContext().getResources().getBoolean(R.bool.isTablet);
    }

    Window window =  ((Activity) getContext()).getWindow();

    if(window == null) {
        return !getContext().getResources().getBoolean(R.bool.isTablet);
    }

    Activity activity = (Activity)getContext();
    Rect rect = new Rect();

    window.getDecorView().getWindowVisibleDisplayFrame(rect);
    View ourView = window.findViewById(Window.ID_ANDROID_CONTENT);

    Log.d("Menu","Window Top: "+ ourView.getTop() + ", "+ourView.getBottom()+ ", "+ourView.getLeft()+", "+ourView.getRight());
    Log.d("Menu","Decor View Dimensions"+rect.flattenToString());

    return  ourView.getTop() != 0;
} 
```

由于某种原因，我得到以下输出（在 Nexus 7 平板电脑上运行）：

```
D/Menu(1007): Window Top: 0, 0, 0, 0
D/Menu(1007): Decor View Dimensions0 0 800 1216 
```

我在想什么/做错了什么？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2014-05-03T16:05:38.560

这是唯一对我有用的方法。以下方法返回**顶部状态栏**的**高度**。因此，如果相应的返回值**等于 0**，则窗口顶部没有状态栏。

 ****```
public static int getTopStatusBarHeight(Activity activity) {
    Rect rect = new Rect();

    activity.getWindow().getDecorView().getWindowVisibleDisplayFrame(rect);

    return rect.top;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-12T23:25:47.400

真的没有办法告诉状态栏的方向/位置。解释它的最好方法是确保你的观点总是解释它。

```
@Override
protected boolean fitSystemWindows(Rect insets) {
    RelativeLayout.LayoutParams params = ((RelativeLayout.LayoutParams)this.getLayoutParams());
    int bottom = params.bottomMargin;
    int left = params.leftMargin;
    int right = params.rightMargin;
    params.setMargins(left, insets.top, right, bottom);
    return super.fitSystemWindows(insets);
} 
```

此方法背后的方法（您在 ViewGroup 中覆盖）是`inset`从框架接收一个矩形，然后将这些插图添加到您的视图填充中。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-07-15T09:22:53.150

我刚刚找到了另一种找出状态栏位置的方法。逻辑很简单，我们有两个步骤来实现这一点，第一个是，

```
 int contentViewTop= window.findViewById(Window.ID_ANDROID_CONTENT).getTop(); 
```

如果状态栏位于顶部，则运行此代码将为您提供（标题栏+状态栏）高度，否则将返回 0。因此我们可以假设输出为 0，状态栏位于底部，否则状态栏位于顶部。

现在状态栏在底部或顶部，这不是问题，我们可以获得这样的高度，

```
public int getStatusBarHeight() 
{
    int result = 0;
    int resourceId = getResources().getIdentifier("status_bar_height", "dimen", "android");
    if (resourceId > 0) 
    {
        result = getResources().getDimensionPixelSize(resourceId);
    }
    return result;
} 
```

我希望这会对某人有所帮助....****

# macos - 假设我知道 root 密码，如何在标准帐户上的 OS X 中制作一个 sudo 本身的 Bash 脚本？

> ID：12379424
> 
> 赞同：1
> 
> 时间：2012-09-11T23:45:56.383
> 
> 标签：macos, bash, ssh, sudo

好的，由于我不会进入的原因（因为它们相当愚蠢），我需要制作一个 shell 脚本，它将每隔 10 秒在 OS X 上启用 SSH。是的，我知道这听起来很愚蠢/毫无意义，但这是有原因的。

只是为了澄清，我知道 root 密码（我可以`login root`在终端中成功），但脚本将在非管理员用户的登录时运行。

**该脚本将在标准（非管理员**）帐户上作为启动代理运行，并且需要以某种方式将自身提升为 root（我碰巧知道其密码），以便它可以启用 SSH。

我试过使用`expect`，但无济于事（它只是拒绝在 OS X 上工作），似乎在 Bash 脚本中传递密码的唯一其他选择是使用`echo $pass | sudo -S $command`，但它只是一个标准用户尝试`sudo`，它不起作用。

我试过`echo $pass | sudo -S login root`, `echo "1234" | sudo -S su root`, 和`echo "1234" | sudo -S su`，但他们都只是返回“对不起，再试一次。”，即使它正在回显正确的密码，我知道因为我可以成功`login root`。

无论如何，我想我的问题是，我如何向 Bash 指定我想要`sudo`作为 root 的身份，而不是运行脚本的当前标准帐户。否则，我如何编写一个脚本，当在普通用户下运行时，它会自行提升为 root 或至少一个管理帐户，而无需用户输入；当然，假设我知道 root 的密码。

我知道这个场景听起来真的“你为什么需要一个脚本来做这个”，但请帮助我；我将不胜感激。[这](http://pastebin.com/K6FmsBVK)是我当前的非工作代码。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-12T01:34:30.817

而不是将密码存储在脚本中..只需使用文件`NOPASSWD`中的选项`/etc/sudoers`。你会想要这样的一行：

```
username ALL = NOPASSWD: /bin/launchctl load -w /System/Library/LaunchDaemons/ssh.plist 
```

然后在你的脚本中做：

```
sudo launchctl load -w /System/Library/LaunchDaemons/ssh.plist 
```

没有`expect`或任何奇怪的必要。

PS你为什么需要这样做！？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-12T00:21:07.957

您是否尝试在脚本上使用 setuid 标志？

# java - Java/Javascript/JSON - 将 JSON 字符串从 Java 传递到 Javascript

> ID：12379425
> 
> 赞同：1
> 
> 时间：2012-09-11T23:45:59.127
> 
> 标签：java, javascript, json, servlets

我将在 Java 中创建的 JSON 字符串作为参数传递给从我的 servlet 调用的 Javascript 方法。但是，当我传递 JSON 字符串时，Firebug 会警告我正在传递的字符串：

Java代码：

```
String jsonString = "{\"id\":1,\"name\":\"Joe Smith\",\"data\":{\"email\":\"smith@gmail.com\",\"phone\":\"555-123-4567\",\"title\":\"CFO\",\"instanceControllerTagLibraryApi\":{\"developmentMode\":false}},\"children\":[],\"instanceControllerTagLibraryApi\":{\"developmentMode\":false}}";

pw.println("<body onload=\"init('"+jsonString+"');\">"); 
```

Javascript：

```
function init(text){
    alert(text);
} 
```

我尝试在传递过程中引用字符串并删除单引号。两者基本上都指向这样一个事实，即传递的字符串需要转义大括号（不知何故）。

错误（单引号）：

> SyntaxError：未终止的字符串文字 [Break On This Error]
> 
> 在里面（'{

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-11T23:57:27.930

错误不在 JSON 字符串中，而是在另一段代码中。

`pw.println("<body onload=\"init('"+jsonString+"');\">");`确实是添加 onload 事件的粗略尝试。

不要尝试将 JSON 字符串添加到 HTML 字符串中，因为引号将不起作用，除非您*双重*转义 JSON 字符串，这很愚蠢。

目前您的输出将如下所示：

```
<body onload="init('{"id":1, ... }');">
                     ^--- syntax error after this 
```

它将尝试执行 JS 代码`init('{`。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-12T00:32:26.407

Frits 能够找出您的问题，这很好。我*肯定会*接受他的建议并*迅速*放弃使用`body onload`.

例如：

```
(function run(){
    var data = '{"id":1,"name":"Joe Smith","data":{"email":"smith@gmail.com","phone":"555-123-4567","title":"CFO","instanceControllerTagLibraryApi":{"developmentMode":false}},"children":[],"instanceControllerTagLibraryApi":{"developmentMode":false}}';

    function init(){
        console.log(data, JSON.parse(data));
    }

    if (window.addEventListener) {
        window.addEventListener('load', init);
    } else if (window.attachEvent) {
        window.attachEvent('load', init);
    }
​})();​ 
```

[http://jsfiddle.net/userdude/eQRBk/1/](http://jsfiddle.net/userdude/eQRBk/1/)

注意使用`window.addEventListener`（以及`window.attachEvent`旧 IE 版本的遗留）。这`console.log`在 Chrome 和 Firebug 中效果更好；在我看来，IE 的控制台在记录对象方面有点令人沮丧。

使用你所提供的，你可以（我建议应该）以不同的方式处理它。但是，请原谅我，我对 Java 并不那么精通，我只知道 JSP（几乎不知道）。所以...？

```
<%

String jsonString = "'{\"id\":1,\"name\":\"Joe Smith\",\"data\":{\"email\":\"smith@gmail.com\",\"phone\":\"555-123-4567\",\"title\":\"CFO\",\"instanceControllerTagLibraryApi\":{\"developmentMode\":false}},\"children\":[],\"instanceControllerTagLibraryApi\":{\"developmentMode\":false}}'";

%>
<script>
(function run(){
    var data = <%=jsonString%>;

    function init(){
        console.log(data, JSON.parse(data));
    }

    if (window.addEventListener) {
        window.addEventListener('load', init);
    } else if (window.attachEvent) {
        window.attachEvent('load', init);
    }
​})();​
</script> 
```

然后您可以将该 JSP 页面插入到`head`or 中`body`，它会正常工作。我还想象您可以将其设置为将该数据动态注入到 JSP 页面中。但是，就像我说的，我有点在这里挥手。

# r - 大稀疏矩阵到三角矩阵 R

> ID：12379426
> 
> 赞同：2
> 
> 时间：2012-09-11T23:46:06.593
> 
> 标签：r, matrix, sparse-matrix, bigdata, triangular

我在 R 中有一个非常大（大约 9100 万个非零条目）的 sparseMatrix()，它看起来像：

```
> myMatrix 
  a b c  
a . 1 2
b 1 . .
c 2 . . 
```

我想将其转换为三角矩阵（上或下），但是当我尝试 myMatrix = myMatrix * lower.tri(myMatrix) 时，出现一个错误，即“问题对于 lower.tri() 来说太大了”。想知道是否有人可能知道解决方案。谢谢你的帮助！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-12T00:05:33.293

与其处理矩阵本身，不如处理它`summary`：

```
library(Matrix)
myMatrix <- sparseMatrix(
    i = c(1,1,2,3),
    j = c(2,3,1,1),
    x = c(1,2,1,2))

myMatrix
# 3 x 3 sparse Matrix of class "dgCMatrix"
#           
# [1,] . 1 2
# [2,] 1 . .
# [3,] 2 . .

mat.summ   <- summary(myMatrix)
lower.summ <- subset(mat.summ, i >= j)

sparseMatrix(i = lower.summ$i,
             j = lower.summ$j,
             x = lower.summ$x,
             dims = dim(myMatrix))
# 3 x 3 sparse Matrix of class "dgCMatrix"
#           
# [1,] . . .
# [2,] 1 . .
# [3,] 2 . . 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2019-03-15T11:11:38.017

当你有一个大的稀疏矩阵时，这个会快一点：

```
ind <- which(myMatrix@i > myMatrix@j)
myMatrix_lower <- sparseMatrix(i = myMatrix@i[ind], 
                               j = myMatrix@j[ind],
                               x = myMatrix@x[ind] ,
                               dims = dim(myMatrix),
                               giveCsparse = F, index1 = FALSE) 
```

# entity-framework - EF5 视觉设计更新但模型不是

> ID：12379429
> 
> 赞同：3
> 
> 时间：2012-09-11T23:46:10.047
> 
> 标签：entity-framework, c#-4.0, entity-framework-5

我正在使用带有 EF5 的 VS2012。我正在使用现有数据库并对数据库进行更改。例如添加新表和 FK

添加表格和 FK 和更新似乎适用于 edmx 文件的设计器，但实际代码未更新。

创建一个新的上下文我看不到我新添加的表。

还有其他人遇到这个问题，无论如何要排序吗？

谢谢！！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-12T08:26:59.623

尝试从生成代码的模板上的上下文菜单中使用*运行自定义工具。*VS2012 中的自动代码生成存在一些问题 - 例如，如果您的 EDMX 不在项目的根目录中，则不会发生自动生成。

# formatting - SCHEME 递归完美数（初学者，希望容易修复）

> ID：12379432
> 
> 赞同：2
> 
> 时间：2012-09-11T23:46:39.253
> 
> 标签：formatting, scheme, racket, perfect-numbers

我的完美数字函数有问题。该代码的目的是确定该数字是否为完美数字，这意味着它等于其除数之和。例如：6。我的代码有问题。这是我的功能：

```
(define (is-perfect x)
  (define (divides a b) (= (modulo b a) 0))
  (define (sum-proper-divisors y)
    (if (= y 1)
        1
        (if (divides y x)
            (+ y (sum-proper-divisors (- y 1)))
        (if (= x 1)
            #f
            (= (sum-proper-divisors (- x 1)
                                    x))))))) 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-12T03:09:12.317

你几乎明白了！但是，有几个问题。首先，您在 中遗漏了一个案例`sum-proper-divisors`：您问 if `y`is one and if `(divides y x)`，但是如果`y`不除会发生什么`x`？

第二个问题是最后一个`if`表达式必须在两个辅助过程的定义之外，目前它在*里面* `sum-proper-divisors`。正确缩进你的代码将更容易找到这种错误。

这就是正确解决方案的外观，因为这看起来像家庭作业，我会让您填写空白：

```
(define (is-perfect x)
  (define (divides a b)
    (= (modulo b a) 0))
  (define (sum-proper-divisors y)
    (cond ((<= y 1)
           1)
          ((divides y x)
           (+ y (sum-proper-divisors (- y 1))))
          (else
           <???>))) ; what goes in here?
  (if (= x 1)
      #f
      (= (sum-proper-divisors (- x 1)) x))) 
```

# javascript - 复杂的 Javascript 正则表达式

> ID：12379440
> 
> 赞同：0
> 
> 时间：2012-09-11T23:47:56.317
> 
> 标签：javascript, regex

我想针对以下规则测试特定文本字段的内容：

1.  它应该是 5 位数字和每个数字末尾的插入符号。
2.  以上只能出现 4 次，整个内容应始终以数字结尾。

例子：

有效的

*   11111^11111
*   11111

无效的

*   11111^11111^1111
*   11111^11111^11111^11111^11111
*   11111^11111^11111^11111^
*   11111^

我正在尝试使用正则表达式来实现相同的功能，并尝试过：

```
/^([0-9]{5}\^){1,4}$/g 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-11T23:51:15.783

尝试以下操作：

```
/^\d{5}(\^\d{5}){0,3}$/ 
```

它匹配行开头的 5 位数字`^\d{5}`，后跟零到三`{0,3}`组插入符号和 5 位数字`(\^\d{5})`，从而保证您只能有 4 组。

**[演示](http://jsfiddle.net/2KMeS/)**。

# c# - 使用 PsExec.exe (sysinternals) 启动进程时读取 StandardOutput

> ID：12379441
> 
> 赞同：2
> 
> 时间：2012-09-11T23:48:02.980
> 
> 标签：c#, .net

我正在使用 PsExec.exe 在远程计算机中调用 exe。远程计算机中的 exe 执行一些操作并在控制台中显示输出。在我尝试重定向输出之前一切正常。代码如下，

```
ProcessStartInfo processInfo = new ProcessStartInfo();
processInfo.FileName = "PsExec.exe";
processInfo.Arguments = "\\\\servername \"C:\\PROGRA~1\\myapp\\app.exe\"";
processInfo.RedirectStandardOutput = true;
processInfo.UseShellExecute = false;
using (Process process = Process.Start(processInfo))
{
string outPutString = process.StandardOutput.ReadToEnd();
} 
```

线路`process.StandardOutput.ReadToEnd()`挂起，什么也不做。那么，如何在使用 PsExec.exe 启动进程时读取 StandardOutput？

# php - Array_udiff 对象数组，以便数组包含仅存在 1 个特定方法实例的对象

> ID：12379442
> 
> 赞同：0
> 
> 时间：2012-09-11T23:48:09.953
> 
> 标签：php, multidimensional-array

我需要转换一个对象数组，例如，该数组将仅包含 1 个对象，其中对象属性“bar”= b。

所以我想转：

```
 Array ( [0] => stdClass Object ( 
    [id] = 1
    [foo] => 'a' 
    [bar] => 'b' )

    [1] => stdClass Object ( 
    [id] => 2
    [foo] => 'a' 
    [bar] => 'c' )

    [2] => stdClass Object ( 
    [id] => 3
    [foo] => 'y' 
    [bar] => 'b' )  ) 
```

进入：

```
 Array ( [0] => stdClass Object ( 
    [id] = 1
    [foo] => 'a' 
    [bar] => 'b' )

    [1] => stdClass Object ( 
    [id] => 2
    [foo] => 'a' 
    [bar] => 'c' ) 
```

但是，我需要它在更大的范围内工作，所以我很难理解如何结合 array_filter、array_udiff 和 array_slice 来获得我想要的。我在想 array_filter 会给我所有的钥匙 where `'foo' = 'b'`. 然后我可以将这个数组和 array_udiff 与原始数组进行对比，以获取`'foo'=! 'b'`. 然后我可以从 array_filter 中分割匹配项以获得一个单键数组......并将其与 array_udiff 差异合并回来。

```
$matches = array_filter($array, "bar_filter");

$remainder = array_udiff($array, $matches, 'compare_objects');

$single =  array_slice( $matches, 0, 1);

$result = array_merge($single, $remainder);

function foobar_filter($obj) {
    if ( $obj->bar == 'b' ) {
        return true;
    } else {
        return false;
    }
}

function compare_objects($obj_a, $obj_b) {
  return $obj_a->id = $obj_b->id;
} 
```

我的 compare_objects 函数肯定是关闭的，但我不知道该放什么。只运行第二个 array_filter 来获取不匹配的项目会更好吗？我需要将数组拆分为键 where`'bar'='b'`和 where`'bar'!='b'`并将其与只有 1 个对象合并在一起`'bar'='b'`

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-12T00:51:23.723

好的，为了清楚起见，我将在一个循环中完成。

```
$matches = array();
$remainder = array();

// $index if you need to maintain index=>object relation
foreach($array as $index => $object) {
  if($object->bar == "b")
    $matches[] = $object;
  else
    $remainder[] = $object;
} 
```

-- for 循环

```
for($index=0,$count=count($array);$index<$count;$index++) {
  if($object->bar == "b")
    $matches[] = $array[$index];
  else
    $remainder[] = $array[$index];
} 
```

--

那么您想将结果与第一个索引合并`$matches`

```
$result = array_merge(array($matches[0]),$remainder); 
```

如果是这种情况，那么您只需要更改比较对象主体，这应该可以过滤掉剩余的对象

```
return $obj_a->id == $obj_b->id ? 0 : 1; 
```

# python - 二十一点返还错误的经销商百分比

> ID：12379446
> 
> 赞同：2
> 
> 时间：2012-09-11T23:48:31.297
> 
> 标签：python, blackjack

所以，我一直在研究 John Zelle 的 Python Programming 中的一个问题。问题是设计一个基本的二十一点程序，该程序演示二十一点经销商在给定规则他必须击中直到他大于 17 的情况下将失败的时间百分比。该程序旨在显示每张初始牌的可能性百分比，因为庄家经常亮出他的第一张牌。

我遇到的问题是，当我将它们与二十一点表交叉引用时，该程序似乎为除了 A 和十之外的每个值都提供了很好的百分比。

```
from random import randrange

def main():
    printIntro()
    n = getInput()
    busts = simBlackjack(n)
    printSummary(n, busts)

def printIntro():
    print "Hello, and welcome to Blackjack.py."
    print "This program simulates the likelihood"
    print "for a dealer to bust."

def getInput():
    n = input("How many games do you wish to simulate: ")
    return n

def simBlackjack(n):
    busts = [0, 0, 0, 0, 0, 0, 0, 0, 0, 0]
    for b in range(10):
        for i in range(n):
            x = b + 1
            if b == 0:
                handAce = True
            else: handAce = False
            while x < 17:
                add = randrange(1,14)
                if add == 11:
                    add = 10
                elif add == 12:
                    add = 10
                elif add == 13:
                    add = 10
                elif add == 1:
                    handAce = True
                x = x + add
                if handAce:
                    if x + 10 >= 17 and x + 10 <= 21:
                        x = x + 10

            if x > 21:
                busts[b] = busts[b] + 1

    return busts

def printSummary(n, busts):
    for b in range(10):
        if b == 0:
            print "When the initial card was Ace, the dealer busted %d times in %d games. (%0.1f%%)" % (busts[0], n, (busts[0]) / float(n) * 100)
        else:
            print "When the initial value was %d, the dealer busted %d times in %d games. (%0.1f%%)" % ((b + 1), busts[b], n, (busts[b]) / float(n) * 100)

if __name__ == "__main__": main() 
```

如果 n = 1,000,000，我分别得到 ~ 11.5% 和 21.2%，这与在线表格保持的 17% 和 23% 显着不同。谁能让我知道问题是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-12T01:21:12.883

我看到的最大问题是评分逻辑将循环结束时的 Ace 计算为硬值“x”，并且它仍然存在。一旦你有一张王牌，“if handAce”这条线每次都会运行。

它看起来也建立在您可以拥有一个且只有一个案例的想法之上。但是，如果鞋子有 4 副牌，理论上你可以 - 但不太可能 - 得到 24 个 A。我已经多次获得多个 A，每一个都为你提供了不同的方式来得分。

我认为不处理一组套牌中的一组卡片（即消耗卡片）很好。

无论如何，我可能会用更多的 oop 风格重做这个来解决 ace 问题：

```
class BlackjackHand(object):
    cards= None

    def __init__(self):
        self.cards = []

    def autoplay(self,initial_card=None):
        if initial_card:
            self.cards.append(initial_card)
        return self.calculate()

    def calculate(self):
        total = 0
        for card in self.cards:
            ## compute!
        return total 
```

我也可能会自己处理面孔，只是为了保持整洁：

```
faces = [ str(i) for i in (1,2,3,4,5,6,7,8,9,10,'j','q','k','a') ]
def facevalue(face):
    if face.isdigit():
        return ( int(face) , 0 )
    if face in ('j','q','k'):
        return ( 10 , 0 )
    if face == 'a':
        return ( 1 , 1 ) 
```

这样你可以做...

```
def simBlackjack(n):
    for face in faces:
        for i in range(n):
            hand = BlackjackHand()
            score = hand.autoplay(initial_card=face) 
```

并用类似的东西计算...

```
( hand , aces ) = facevalue( face )
while True:
    new_card  = random.choice( faces )
    ( new_card_value , new_card_is_ace ) = facevalue( new_card )
    hand += new_card_value
    aces += new_card_is_ace
    # calculate the multiple different scoring possibilities 
    # if all of them bust, then break 
```

那里可能还有其他问题，但对我来说最明显的问题是您的代码不能很好地支持 Aces。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-12T12:48:46.623

答案是我的程序的百分比是基于无限大的甲板鞋，这会改变百分比表。我正在查看的原始表是用于单层的。经过进一步研究，我发现了很多符合我价值观的网站。

话虽如此，感谢您的所有帮助。当然，乔纳森·瓦纳斯科解决问题的方法更好，更具可扩展性。我是新手，所以很有教育意义。

我确实认为有趣的是，无限大的甲板鞋对概率表边缘的影响最大。

# c# - 派生类数组，调用方法？

> ID：12379447
> 
> 赞同：4
> 
> 时间：2012-09-11T23:48:43.977
> 
> 标签：c#, arrays, methods, base, derived

所以我有一个 Account 类型的数组，它由从 Account 派生的 Savings 和 Checking 组成。是否有可能让这些调用他们的方法？编译器只使基类中的方法可见，我无法访问派生类中的方法。把我的头撞到这里的墙上。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-11T23:50:55.177

您需要将数组中的元素转换为派生类：

```
((Checking)someArray[42]).Whatever(); 
```

如果实例实际上不是该类型，这将抛出一个`InvalidCastException`.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-12T00:03:29.357

尽管您可以使用强制转换，但由于您不知道数组元素的确切类型，这将导致一堆异常和一个相当丑陋的代码来处理它们。

你可以使用类似的东西：

```
Saving s = array[i] as Saving;
if(s != null)
{
   s.SomeSavingMethod();
}
else
{
   Checking c = array[i] as Checking;
   if(c != null)
      c.SomeCheckingMethod();
} 
```

然而，猜测类型并相应地调用方法，通常被认为是一个糟糕的设计。这听起来像是虚拟方法的情况，或者这些东西首先不应该在同一个数组中。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-12T00:05:45.610

基本上有两种方法可以用来完成您似乎正在寻找的功能。

第一个并且可以说是最好的（对于您描述的情况）是声明所有这些类都实现的公共接口。

```
public interface IWorker
{
    void DoWork();
}

public class A : IWorker
{
    public void DoWork()
    {
        // TODO: Implement this method
        throw new NotImplementedException();
    }
}

public class B : IWorker
{
    public void DoWork()
    {
        // TODO: Implement this method
        throw new NotImplementedException();
    }
} 
```

第二个是检测类型并在它支持的情况下调用该方法。沿着这些思路。这是[AS 运算符](http://msdn.microsoft.com/en-us/library/cscsdfbt%28v=vs.71%29.aspx)非常方便的地方，因为如果转换成功，它只会返回非空值。

```
List<object> workers = new List<object>() { new A(), new B() };
foreach (object itm in workers)
{
    ClassThatSupportsDoWork obj = itm as ClassThatSupportsDoWork;
    if (obj != null)
        obj.DoWork();
} 
```

# mongodb - mongo聚合速度

> ID：12379450
> 
> 赞同：0
> 
> 时间：2012-09-11T23:49:06.617
> 
> 标签：mongodb

我是 mongo 的新用户（对 mysql 有丰富的经验），它似乎有一些有趣的优点和缺点。显然，优点是您可以保存的数据大小和写入记录的速度。我有一个应用程序，我正在将许多日志写入一个集合，到目前为止我有大约 7m。我的问题是一个看似简单的查询需要很**长时间**。让我解释。

我的收藏有 7m 文件：

```
> db.alpha2.count()
7257619 
```

现在我想计算给定 cid 的所有记录，并且时间戳小于某个数字（此示例具有将来的时间戳，因此它应该计算所有内容）：

```
> db.alpha2.find({'ts': {'$lt': 1446457607}, 'cid': '2636518'}).count()
7257619 
```

这是问题查询，需要整整**58秒**才能将这个号码返回给我！从概念上讲，这是一个非常简单的查询，在 sql 世界中有点等价：

```
select count(*) from alpha2 where cid=2636518 and ts<1446457607 
```

我没有等效的表，但根据我的经验，我认为在 mysql 中运行不到 0.1 秒。那我该怎么办？我计划对比 7m 记录大得多的数据集进行大量聚合。我也在做一些稍微困难的事情（地图减少），而且情况要糟糕得多（几分钟）。我需要这个时间少于一秒。我究竟做错了什么？这个时间成本是 mongo 预期的吗？

在我对上述查询进行计时之前，我在 ts 值上放置了一个索引：

```
db.alpha2.ensureIndex({ts:1}) 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-12T00:15:12.820

为了确定`count()`，MongoDB 必须找到所有匹配的文档。

您可以[explain()](http://www.mongodb.org/display/DOCS/Explain)查询以查看如何使用索引：

```
 db.alpha2.find({'ts': {'$lt': 1446457607}, 'cid': '2636518'}).explain() 
```

特别是您希望最小化`nscannedObjects`（扫描的文档数量）。

您最好的标准情况是对计数中涉及的所有字段进行索引（并确保索引适合可用 RAM）。

因此，您的索引还应包括`cid`：

```
 db.alpha2.ensureIndex({ts:1, cid:1}) 
```

如果您经常进行计数，那么您最好通过[增量 map/reduce](http://www.mongodb.org/display/DOCS/MapReduce#MapReduce-MongoShellScriptwithIncrementalMapReduceandFinalize)之类的过程来存储和更新这些数据（如果这适用于您的用例）。

# return-value - excel偏移函数返回值错误

> ID：12379451
> 
> 赞同：0
> 
> 时间：2012-09-11T23:49:26.703
> 
> 标签：return-value, excel-formula, offset

我对 Excel 中的偏移公式有疑问，我无法理解问题所在。我以前成功地使用过这个公式。公式是

```
=OFFSET($B$3,,,,COUNTA($B$3:$T$3)) 
```

它应该读取日期的水平列表。这将成为一个命名范围并在图表中使用。单元格 B3 包含第一个日期，宽度是 counta 函数。单元格格式 - 在这种情况下为日期 - 会对公式产生任何影响吗？

非常感谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-12T07:47:33.453

在公式本身中，我看不到问题。如果按原样输入（例如在 A3 中），它将显示 B3 的值，因为 OF​​FSET 返回一个**范围**，并且对范围的单个单元格操作会导致显示其第一个单元格的值。

如果 B3:T3 完全为空，则 COUNTA 解析为“0”，因此 OFFSET 解析为 #REF。

OFFSET 函数的典型应用类似于 =SUM(OFFSET(...))，其中 SUM 作用于 OFFSET 提供的完整范围

# java - 如何从 JBoss AS 7.0.2.Final 上的 server.log 中排除记录器类别

> ID：12379454
> 
> 赞同：4
> 
> 时间：2012-09-11T23:49:39.690
> 
> 标签：java, logging, jboss7.x

我正在使用 JBoss AS 7.0.2.Final 并且没有机会改变它。

我尝试配置standalone.xml 为不同的类别创建不同的日志文件。我的问题是：每个记录器的输出都正确附加在指定的文件上，但也写在 server.log 文件上。

这是我的整个日志子系统配置：

```
<subsystem xmlns="urn:jboss:domain:logging:1.1">
    <console-handler name="CONSOLE" autoflush="true">
        <level name="INFO"/>
        <formatter>
            <pattern-formatter pattern="%d{HH:mm:ss,SSS} %-5p [%c] (%t) %s%E%n"/>
        </formatter>
    </console-handler>
    <periodic-rotating-file-handler name="FILE" autoflush="true">
        <level name="INFO"/>
        <formatter>
            <pattern-formatter pattern="%d{HH:mm:ss,SSS} %-5p [%c] (%t) %s%E%n"/>
        </formatter>
        <file relative-to="jboss.server.log.dir" path="server.log"/>
        <suffix value=".yyyy-MM-dd"/>
        <append value="true"/>
    </periodic-rotating-file-handler>
    <periodic-rotating-file-handler name="REQUEST" autoflush="true">
        <level name="INFO"/>
        <formatter>
            <pattern-formatter pattern="%m%n"/>
        </formatter>
        <file path="/Logs/requests.log"/>
        <suffix value=".yyyy-MM-dd-HH"/>
        <append value="true"/>
    </periodic-rotating-file-handler>
    <periodic-rotating-file-handler name="ALARMS" autoflush="true">
        <level name="INFO"/>
        <formatter>
            <pattern-formatter pattern="%m%n"/>
        </formatter>
        <file path="/Logs/alarms.log"/>
        <suffix value=".yyyy-MM-dd-HH"/>
        <append value="true"/>
    </periodic-rotating-file-handler>
    <logger category="com.maucho.alarm" use-parent-handlers="false">
        <level name="INFO"/>
        <handlers>
            <handler name="ALARMS"/>
        </handlers>
    </logger>
    <logger category="com.maucho.request" use-parent-handlers="false">
        <level name="INFO"/>
        <handlers>
            <handler name="REQUEST"/>
        </handlers>
    </logger>
    <logger category="com.arjuna">
        <level name="WARN"/>
    </logger>
    <logger category="org.apache.tomcat.util.modeler">
        <level name="WARN"/>
    </logger>
    <logger category="sun.rmi">
        <level name="WARN"/>
    </logger>
    <logger category="com.hp.autopassj">
        <level name="WARN"/>
    </logger>
    <logger category="org.jboss.as.server.deployment">
        <level name="ERROR"/>
    </logger>
    <root-logger>
        <level name="INFO"/>
        <handlers>
            <handler name="CONSOLE"/>
            <handler name="FILE"/>
        </handlers>
    </root-logger>
</subsystem> 
```

启动 AS 时，standalone.xml 文件将被覆盖，并将没有属性 use-parent-handlers="false" 的记录器标记替换为空，将行为设置为其默认值 use-parent-handlers="true"：

```
<subsystem xmlns="urn:jboss:domain:logging:1.1">
    <console-handler name="CONSOLE" autoflush="true">
        <level name="INFO"/>
        <formatter>
            <pattern-formatter pattern="%d{HH:mm:ss,SSS} %-5p [%c] (%t) %s%E%n"/>
        </formatter>
    </console-handler>
    <periodic-rotating-file-handler name="FILE" autoflush="true">
        <level name="INFO"/>
        <formatter>
            <pattern-formatter pattern="%d{HH:mm:ss,SSS} %-5p [%c] (%t) %s%E%n"/>
        </formatter>
        <file relative-to="jboss.server.log.dir" path="server.log"/>
        <suffix value=".yyyy-MM-dd"/>
        <append value="true"/>
    </periodic-rotating-file-handler>
    <periodic-rotating-file-handler name="REQUEST" autoflush="true">
        <level name="INFO"/>
        <formatter>
            <pattern-formatter pattern="%m%n"/>
        </formatter>
        <file path="/Logs/requests.log"/>
        <suffix value=".yyyy-MM-dd-HH"/>
        <append value="true"/>
    </periodic-rotating-file-handler>
    <periodic-rotating-file-handler name="ALARMS" autoflush="true">
        <level name="INFO"/>
        <formatter>
            <pattern-formatter pattern="%m%n"/>
        </formatter>
        <file path="/Logs/alarms.log"/>
        <suffix value=".yyyy-MM-dd-HH"/>
        <append value="true"/>
    </periodic-rotating-file-handler>
    <logger category="com.maucho.alarm">
        <level name="INFO"/>
        <handlers>
            <handler name="ALARMS"/>
        </handlers>
    </logger>
    <logger category="com.maucho.request">
        <level name="INFO"/>
        <handlers>
            <handler name="REQUEST"/>
        </handlers>
    </logger>
    <logger category="com.arjuna">
        <level name="WARN"/>
    </logger>
    <logger category="org.apache.tomcat.util.modeler">
        <level name="WARN"/>
    </logger>
    <logger category="sun.rmi">
        <level name="WARN"/>
    </logger>
    <logger category="com.hp.autopassj">
        <level name="WARN"/>
    </logger>
    <logger category="org.jboss.as.server.deployment">
        <level name="ERROR"/>
    </logger>
    <root-logger>
        <level name="INFO"/>
        <handlers>
            <handler name="CONSOLE"/>
            <handler name="FILE"/>
        </handlers>
    </root-logger>
</subsystem> 
```

文档很差，说我只需要输入参数 use-parent-handlers="false" 但它不起作用。

另外，我还使用 org.apache.commons.logging.LogFactory 将我的代码 org.apache.log4j.Logger 更改为 org.apache.commons.logging.Log 并得到相同的结果，在两个文件（/Logs/ requests.log 或 /Logs/alarms.log AND server.log）。

我的参考资料： [https:](https://community.jboss.org/message/731527) [//community.jboss.org/message/731527 http://commons.apache.org/logging/guide.html](http://commons.apache.org/logging/guide.html)

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2014-07-28T09:30:31.607

这是一个非常古老的线程，但以防万一有人正在寻找解决此问题的方法。属性名称中有错字，缺少“s”。这是要设置以使其正常工作的属性-use-parent-handler**s**=false

# html - 在部分上叠加图像 边界

> ID：12379458
> 
> 赞同：1
> 
> 时间：2012-09-11T23:50:25.067
> 
> 标签：html, css

我有一个`<div>`带制服的`border: 15px`

jsfiddle 是[http://jsfiddle.net/user1212/e7Gez/2/](http://jsfiddle.net/user1212/e7Gez/2/)

我试图让图像出现在左上角`<div>`

然而，现有的`border`正在阻止它。

有解决办法吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-12T00:18:16.883

如果你可以制作这个 gif 的 Image png 并使白色不可见，这是我的解决方案

使用类 Container 在 div 上方添加带有此 PNG 或 GIF 的图像标记

```
<img id="cornerLeft" src="http://smitra.net76.net/post-bg.jpg" />
<div class="content">
   Text Goes here
</div> 
```

然后对于样式，只需使用绝对定位，**内容**就会放置在该图像下。

```
#cornerLeft{
    position:absolute;
} 
```

我还从您的**内容**类中删除了带有图片的背景

```
background: #ffffff url('http://smitra.net76.net/post-bg.jpg') no-repeat top left; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-12T00:29:27.967

不确定您是否需要将其作为背景，但这将是我的尝试。

html

```
<div class="content">
    <img src="http://smitra.net76.net/post-bg.jpg" />
    Text Goes here
</div>​ 
```

css

```
img {
  position: relative;
  top: -15px;
  left: -15px;    
} 
```

因为看起来你实际上并不需要它作为背景，而是 div 角落的东西？

# html - 覆盖html值

> ID：12379460
> 
> 赞同：1
> 
> 时间：2012-09-11T23:50:44.057
> 
> 标签：html, django

我为 django 电子商务页面创建付款表单，但遇到了处理保存的信用卡信息的情况。

如果我想向我的服务器发出要使用什么操作的信号，我是否需要以自己的形式包装第一个输入和按钮？或者我可以使用下面的代码吗？

```
 {% if user.is_authenticated and user.get_profile.stripe_customer_id %}
        <input type="hidden" name="action=" value="delete_card"/>
        <button type="submit">Use Another Card</button>

        <input type="hidden" name="action=" value="pay_saved_card"/>

 {% endif %} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-12T05:07:06.617

您不能使用 HTML 覆盖隐藏字段，除非您可以让另一个控件发送具有相同名称的参数，然后服务器端检查情况。

这种情况最简单的方法是有一个复选框

```
<input type="checkbox" name="action" value="delete_card" id="othercard" />
<label for="othercard">Use Another Card</label> 
```

不使用隐藏字段。然后，服务器端代码应该只测试是否存在`action`具有 value 的属性`delete_card`。

在中使用等号`name="action="`可能但不常见或不需要：提交表单时，会生成表单 name=value 的数据项，因此您会得到`action==delete_card`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-12T04:17:09.360

通常，要提交或取消表单，需要在表单中添加以下内容。

```
<input type="submit" name="action" value="Cancel" />
<input type="submit" name="action" value="Save" /> 
```

并且取决于`request.POST['action']`在 django 视图中，您将处理保存表单或取消处理。

# ios - 核心数据故障挫折

> ID：12379462
> 
> 赞同：2
> 
> 时间：2012-09-11T23:50:55.397
> 
> 标签：ios, core-data

在视图控制器（Tab 1）中，我从如下核心数据加载：

```
- (void)loadRecordsFromCoreData {

[self.managedObjectContext performBlockAndWait:^{
    NSError *error = nil;
    NSFetchRequest *request = [[NSFetchRequest alloc] initWithEntityName:@"Item"];
    [request setSortDescriptors:[NSArray arrayWithObject:[NSSortDescriptor sortDescriptorWithKey:@"order" ascending:YES]]];

    self.items = [self.managedObjectContext executeFetchRequest:request error:&error];

}];
} 
```

然后我显示这样的项目（在 viewDidAppear 中）：

```
- (void)displayItems
{
for(UIView *subview in [self.itemRow subviews]) {
    [subview removeFromSuperview];
}

int xPos = kXItemOffsetIphone;

for (Item *item in self.items) {
    ItemView *itemView = [[ItemView alloc] initWithFrame:CGRectMake(xPos, kYItemOffsetIphone, kItemWidthIphone, kItemHeightIphone) ];

    [itemView layoutWithData:item];

    [self.itemRow addSubview:itemView];

    xPos += kXItemSpacingIphone;
}

} 
```

ItemView 是一个 UIView 子类，它显示与项目关联的图像等。当我第一次运行应用程序时，所有项目都显示出来。但是，如果我单击另一个选项卡，然后返回选项卡 1，我的所有项目都会消失。项目数组仍然存在，但数组中的每个项目都是“故障”，因此没有显示任何内容。非常令人沮丧。我怎样才能防止这些项目成为“故障”？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-11T23:55:02.497

听起来您`NSManagedObjectContext`正在被释放（也许您的视图控制器在切换选项卡时正在卸载/清理自己？）。

在幕后，您的对象只是数据进出 SQLite 存储以及在`NSManagedObjectContext`. 当上下文被释放时，代理对象仍然存在（因此为什么您的数组仍然充满对象）但是它们无法向释放的托管对象上下文询问数据并且它们的所有值都恢复为错误。

你有几个选择：

当您在控制器之间移动时，您可以传递对您的引用，`NSManagedObjectContext`以免丢失它。

`-viewWillAppear:`您可以在每次显示视图时触发您认为方便的其他方法重新获取数据。

您还可以将您的对象移至`NSManagedObjectContext`在应用程序的整个生命周期中都存在的单例对象，但是如果您不小心，它可能会变得脆弱。

# sql-server - SQL - 秒到日、时、分、秒

> ID：12379466
> 
> 赞同：2
> 
> 时间：2012-09-11T23:51:29.403
> 
> 标签：sql-server, tsql

> **可能重复：**
> [在 sql server 2005 中将秒转换为分钟和秒的有效方法](https://stackoverflow.com/questions/2316288/efficient-way-to-convert-second-to-minute-and-seconds-in-sql-server-2005)

我有一个查询需要以日、时、分、秒格式返回秒。

下面的代码在不到一天时工作正常，但在秒值大于一天时不起作用

```
PRINT Convert(VarChar, DateAdd(S, 86400, 0), 108) 
```

86400 正好是一天，它返回 00:00:00

有人可以修改它并向我展示这样的结果吗

```
1:00:00:00. 
```

谢谢

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-09-11T23:55:41.613

这个怎么样：

```
declare @days int, 
        @dt1 smalldatetime = '2012-03-25 03:24:16', 
        @dt2 smalldatetime = getdate()

set @days = datediff (s, @dt1, @dt2)

SELECT convert(char(10), @days / (60 * 60 * 24)) + ':'
+ convert(char(10), dateadd(s, @days, convert(datetime2, '0001-01-01')), 108)

Result -- 170:20:40:00 
```

请参阅[带有演示的 SQL Fiddle](http://sqlfiddle.com/#!3/c7b0d/37)

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-09-12T02:02:22.267

尝试这个：

```
declare @seconds int=87500;

select cast(@seconds/86400 as varchar(50))+':'+
  Convert(VarChar, DateAdd(S, @seconds, 0), 108) 
```

**结果**：

```
1:00:18:20 
```

# css - CSS3 中是否有相当于 jQuery 的 :first 选择器？

> ID：12379468
> 
> 赞同：2
> 
> 时间：2012-09-11T23:51:31.437
> 
> 标签：css, css-selectors

我有以下标记：

```
<div class="a"></div>
<div class="b"></div> <!-- :first -->
<div class="b"></div>
<div class="b"></div> <!-- :last -->
<div class="c"></div> 
```

我正在尝试使用 class来定位第*一个*和*最后一个* 。如果我为此使用 jQuery 选择器，并且会成功。`<div>``b``.b:first``.b:last`

然而，对于 CSS，这很棘手：第一个`<div class="b">`位于另一个`<div>`具有不同类的位置，并且 :first-child 和 :first-of-type 都匹配第一个`<div>`, 与 class `a`。

是否有一个选择器针对与该类匹配的第一个项目？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-12T00:03:53.823

不，没有与 jQuery`:first`或`:last`选择器等效的 CSS 选择器，因为这些选择器是[过滤器，而不是 CSS 定义的真正简单的选择器](https://stackoverflow.com/questions/9983297/difference-between-css-selector-and-jquery-filter/10835694#10835694)。

在 Selectors 3 中也没有`:first-of-class`或类似的选择器。

但是，您可以使用`~`组合器的覆盖规则将样式应用于某个类的第一个子级：

*   [具有类的第一个元素的 CSS 选择器](https://stackoverflow.com/questions/2717480/css-selector-for-first-element-with-class/8539107#8539107)
*   [CSS选择器选择给定类的第一个元素](https://stackoverflow.com/questions/3615518/css-selector-to-select-first-element-of-a-given-class/3615559#3615559)

但是目前没有办法使用 CSS 将样式应用于某个类的最后一个子类：

*   [是否可以使用当前浏览器使用伪类来检测某个类的第一个和最后一个？](https://stackoverflow.com/questions/10230416/is-it-possible-using-current-browsers-to-use-pseudo-classes-to-detect-first-and/10230466#10230466)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-12T00:20:17.530

您也可以始终使用 b 类对 div 进行包装，并使用 :first-child 和 :last-child 选择器定位其内容。

请参阅此处的示例：http: [//cssdesk.com/fYTHF](http://cssdesk.com/fYTHF)

# mysql - mysql复合索引理论

> ID：12379473
> 
> 赞同：0
> 
> 时间：2012-09-11T23:51:53.960
> 
> 标签：mysql, composite-index

我的 sql 是：`select id,name,city,type from company where city=? and type=?`. 所以我创建了两个索引：一个在city字段上，另一个在type字段上。所以我的问题是：我是否需要在city和type上创建一个复合索引？如果需要，为什么？两个复合索引btree索引如何？结构 VS 单索引 btree 结构。提前致谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-11T23:55:00.820

是的，在这种情况下，您需要有一个复合`city + type`索引才能获得最大可能的性能。

只要 mysql 一次只能使用一个索引（很少有例外，这里不是这种情况） - 它只会检查`city`或`type`减少所有表数据，然后执行扫描以找到确切的行。

如果您有复合索引 - 那么 mysql 将能够解决这两个`city=? and type=?`条件，因此不需要额外的扫描来返回结果集。

> 两个复合索引 btree 索引结构 VS 单索引 btree 结构如何。

没有 2 个复合 btree 结构。如果创建复合索引，则会创建包含两列数据的单个 b 树结构。这就是为什么复合索引中的顺序很重要。

# version-control - WordPress 管理面板设计的更改日志

> ID：12379478
> 
> 赞同：0
> 
> 时间：2012-09-11T23:52:15.837
> 
> 标签：version-control, wordpress, wordpress-theming

是否有专门针对 WordPress 管理面板的更改日志？我想通过v3.0以后的不同版本了解管理面板的设计变化。

我可以通过在本地服务器上安装每个版本来找到它们，但工作量太大。如果我能找到样式何时更改，我可以安装更改后的版本。

感谢您的信息。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-12T00:42:15.780

不是特别，不是。

您可以查看[Wordpress Changelogs](http://codex.wordpress.org/Category:Changelogs)，但其中许多（如果不是全部）没有解决 Wordpress Core 的样式更改。在大多数情况下，它主要处理功能更改、错误修复和数据库升级。

[Wordpress Trac](http://core.trac.wordpress.org/)也有很多关于提交和处理的故障单的有用信息，但也不主要处理样式更改。

我已将 Trac 时间线过滤到过去一年中的所有变更集，因此希望这将开始您正在寻找的内容：

[http://core.trac.wordpress.org/timeline?from=09%2F12%2F12&daysback=365&authors=&changeset=on&update=Update](http://core.trac.wordpress.org/timeline?from=09%2F12%2F12&daysback=365&authors=&changeset=on&update=Update)

# mysql - 多个连接有问题

> ID：12379484
> 
> 赞同：2
> 
> 时间：2012-09-11T23:54:02.510
> 
> 标签：mysql, sql, join, inner-join

我有几张表要连接在一起，但我似乎无法弄清楚如何正确连接它们。有人能帮忙吗？我想同时指定tractionId 和gradeId 值，但是当我认为应该返回行时，我什么也没得到。谁能告诉我我做错了什么？谢谢！

我对它进行了修改：[http ://sqlfiddle.com/#!2/e2b03/2](http://sqlfiddle.com/#!2/e2b03/2)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-11T23:58:55.620

我将第一个加入更改为：

```
INNER JOIN cirriculum_units ON cirriculum_units.cirriculumId = cirriculum_attractions.cirriculumId 
```

代替：

```
cirriculum_units.cirriculumId = cirriculum_attractions.attractionId 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-11T23:58:18.173

您的第一个内部联接在 on 子句中有两个没有匹配值的字段。

要么数据错误，要么命名错误的列

# jquery - 简化jQuery

> ID：12379495
> 
> 赞同：0
> 
> 时间：2012-09-11T23:55:01.170
> 
> 标签：jquery

嗨，我刚刚学习 Jquery atm，我想知道简化以下内容的最佳方法是什么：

```
$(document).ready(function() {
$('.hover').hide();

$( '.state' ).hover(function() {
    $('.divtop .state').stop().animate({opacity:0}, 300),
    $('.divtop .hover').show(),
    $('.divtop .hover').stop().animate({opacity:1}, 1000);
    },

    function() {
    $('.divtop .hover').stop().animate({opacity:0}, 600,'',function(){$(this).hide()});
    $('.divtop .state').stop().animate({opacity:1}, 500);

    });

$( '.divmiddle .state' ).hover(function() {
    $('.divmiddle .state').stop().animate({opacity:0}, 300),
    $('.divmiddle .hover').show(),
    $('.divmiddle .hover').stop().animate({opacity:1}, 1000);
    }, function() {

    $('.divmiddle .hover').stop().animate({opacity:0}, 600,'',function(){$(this).hide()});
    $('.divmiddle .state').stop().animate({opacity:1}, 500);

    });

$( '.divbottom .state' ).hover(function() {
    $('.divbottom .state').stop().animate({opacity:0}, 300),
    $('.divbottom .hover').show(),
    $('.divbottom .hover').stop().animate({opacity:1}, 1000);
    }, function() {

    $('.divbottom .hover').stop().animate({opacity:0}, 600,'',function(){$(this).hide()});
    $('.divbottom .state').stop().animate({opacity:1}, 500);

    });
}); 
```

html 看起来像这样：

```
<section class="left">
            <div class="divtop">
                <img src="img/layout/blue.png" class="state" alt="blue" />
                <img src="img/layout/bluehover.png" class="hover" alt="bluehover" />
            </div><!-- close class divtop -->
            <div class="divmiddle">
                <img src="img/layout/red.png" class="state" alt="red" />
                <img src="img/layout/redhover.png" class="hover" alt="redhover" />
            </div><!-- close class divmiddle -->
            <div class="divbottom">
                <img src="img/layout/pink.png" class="state" alt="pink" />
                <img src="img/layout/pinkhover.png" class="hover" alt="pinkhover" />
            </div><!-- close class divbottom -->

        </section><!-- close left section --> 
```

css 中的图像是绝对定位的，因此它们彼此重叠。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-12T00:34:34.053

代码重复不是 JS 或 jQuery 的问题，只是一般的编程问题。所以尝试将重复的代码重构为可重用的函数或方法。我们如何创建一个函数来为我们绑定悬停处理，因为我们以同样的方式做了 3 次。

另外，不要过度使用`$('#selector')`jQuery 中的。当您可以保存结果并更直接地将元素用作变量时，为什么要多次搜索相同的元素。

所以我会做这样的事情：http: [//jsfiddle.net/v8srd/](http://jsfiddle.net/v8srd/)

```
$(document).ready(function() {

  // Hide all the elements that should be shown on hover
  $('.hover').hide();

  // One function to setup all hovers
  var setupHover = function(position) {

    // Find the parent element that contains the state and the hover,
    // then find the state/hover elements within the parent
    var parent = $('.div' + position),
        state = parent.find('.state'),
        hover = parent.find('.hover');

    // Apply the hover to the above elements
    state.hover(function() {
      state.stop().animate({opacity:0}, 300),
      hover.show().stop().animate({opacity:1}, 1000);
    }, function() {
      hover.stop().animate({opacity:0}, 600,'',function(){$(this).hide()});
      state.stop().animate({opacity:1}, 500);
    });
  };

  // Bind the hover handling to each position
  setupHover('top');
  setupHover('middle');
  setupHover('bottom');
});​ 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-12T00:17:28.370

一种方法可能如下：

```
$(document).ready(function() {
   $('.hover').hide();

   $( 'section.left > div' ).hover(function() {
      $(this).children('.state').stop().animate({opacity:0}, 300),
      $(this).children('.hover').show(),
      $(this).children('.hover').stop().animate({opacity:1}, 1000);
   },
   function() {
      $(this).children('.hover').stop().animate({opacity:0}, 600,'',function(){$(this).hide()});
      $(this).children('.state').stop().animate({opacity:1}, 500);
   });
}); 
```

那应该简化您的代码。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-12T00:18:42.000

将代码的公共部分放在一个函数中，例如：

```
$(document).ready(function() {

  function hover(sel, sel2){
    $(sel).hover(function() {
      $(sel2 + ' .state').stop().animate({opacity:0}, 300),
      $(sel2 + ' .hover').show().stop().animate({opacity:1}, 1000);
    }, function() {
      $(sel2 + ' .hover').stop().animate({opacity:0}, 600,'',function(){$(this).hide()});
      $(sel2 + ' .state').stop().animate({opacity:1}, 500);
    });
  }

  $('.hover').hide();
  hover('.state', '.divtop');
  hover('.divmiddle .state', '.divmiddle');
  hover('.divbottom .state', '.divbottom');
}); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-12T00:22:05.523

这就是我会做的...

```
$(function() {
  $('.hover').hide();
  $('.state' ).hover(function() {
    $(this).stop().animate({opacity:0}, 300);
    $(this).siblings('.hover').stop().animate({opacity:1}, 1000);
  }, function() {
    $(this).siblings('.hover').stop().animate({opacity:0}, 600, function() { $(this).hide(); });
    $(this).stop().animate({opacity:1}, 500);
  });
}); 
```

# boost - 了解 bjam 的目标，以及如何指定新目标？

> ID：12379497
> 
> 赞同：5
> 
> 时间：2012-09-11T23:55:01.473
> 
> 标签：boost, makefile, boost-python, bjam, boost-build

我在理解如何使用 bjam 指定和调用目标时遇到问题。通过这个，我的意思是我想为 bjam 提供命令行目标来构建（实际上是从 Makefile 构建），这些目标对应于构建过程的不同方面，而不是仅仅运行*整个事情*。

例如，现在当我键入“bjam”时，它会关闭并构建一个 python 扩展，运行一个单元测试文件，并创建一个单独的“main”可执行文件。我有执行每个步骤的自定义规则，我的 Jamfile 只是按顺序列出它们：

```
project-name = example ;

sources =
  $(project-name).cpp
  $(project-name)_ext.cpp
  ;

build-ext $(project-name) : $(sources) ;

build-main $(project-name) ; 
```

在我的 Jamroot（上一个目录）中，我定义了这些规则，这是不完整的文件：

```
# A rule to simplify declaration of extension tests:
rule run-test ( test-name : sources + )
{
    import testing ;
    testing.make-test run-pyd : $(sources) : : $(test-name) ;
}

# A rule to further simply declaration of extension tests:
rule run-ext-test ( project-name )
{
  run-test $(project-name) : $(project-name)_ext test_$(project-name)_ext.py ;
}

# A rule to simplify copying of the extension and Boost.Python libraries to the current directory
rule convenient-copy ( project-name )
{
  install convenient_copy
    : $(project-name)_ext
    : <install-dependencies>on <install-type>SHARED_LIB <install-type>PYTHON_EXTENSION
      <location>.
    ;
}

rule build-ext ( project-name : sources + )
{
  python-extension $(project-name)_ext : $(sources) : ;

  # copy the extension and Boost.Python libraries to the current directory
  convenient-copy $(project-name) ;

  # run extension tests
  run-ext-test $(project-name) ;
}

rule build-main ( project-name : other-sources * )
{
  obj $(project-name).o : $(project-name).cpp ;
  exe main_$(project-name) : main_$(project-name).cpp $(project-name).o $(other-sources) ;
  install main : main_$(project-name) : <location>. ;
} 
```

但是我注意到以下对 bjam 的调用并没有做我希望他们做的事情：

```
$ bjam build-main
notice: could not find main target build-main
notice: assuming it is a name of file to create.
don't know how to make <e>build-main
...found 1 target...
...can't find 1 target...

$ bjam main_example
...patience...
...patience...
...found 1597 targets...
...updating 3 targets...
gcc.compile.c++ bin/gcc-4.6/debug/main_example.o
gcc.compile.c++ bin/gcc-4.6/debug/example.o
gcc.link bin/gcc-4.6/debug/main_example
...updated 3 targets... 
```

^^^ 但安装规则未运行，因此二进制文件未复制到 Jamfile 目录。

奇怪的是，有一些目标会做一些事情，但并不总是我所期望的：

```
$ bjam main
...patience...
...patience...
...found 1598 targets...
...updating 3 targets...
gcc.compile.c++ bin/gcc-4.6/debug/main_example.o
gcc.compile.c++ bin/gcc-4.6/debug/example.o
gcc.link main_example
...updated 3 targets... 
```

这确实在 Jamfile 目录中创建了二进制文件。

目标从何`main`而来？我没有定义它...

另一个奇怪的：

```
$ bjam example_ext
...patience...
...patience...
...found 2834 targets...
...updating 3 targets...
gcc.compile.c++ bin/gcc-4.6/debug/example.o
gcc.compile.c++ bin/gcc-4.6/debug/example_ext.o
gcc.link.dll bin/gcc-4.6/debug/example_ext.so
...updated 3 targets... 
```

^^^ 创建了 example_ext.so，但没有将其复制到 Jamfile 位置。

```
$ bjam example_ext.so
notice: could not find main target example_ext.so
notice: assuming it is a name of file to create.
...patience...
...patience...
...found 2836 targets...
...updating 4 targets...
gcc.compile.c++ bin/gcc-4.6/debug/example.o
gcc.compile.c++ bin/gcc-4.6/debug/example_ext.o
gcc.link.dll bin/gcc-4.6/debug/example_ext.so
common.copy example_ext.so
...updated 4 targets... 
```

^^^ 创建 .so 文件并复制它，但没有调用便捷复制来引入 libboost_python.so 文件。

我真的不明白这里发生了什么。bjam 文档确实给我带来了严重的问题。它详细描述了目标，但在规则的上下文中，而不是在从命令行调用 bjam 的上下文中。我确实提到过一些伪目标和“生成”，但对于我认为应该是一个简单的用例来说，这似乎太复杂了。还提到了“绑定”机制，但文档提到`=$(BINDRULE[1])=`这对我来说毫无意义。

我也遇到了化名，`NOTFILE`但`explicit`我不确定我是否走在正确的轨道上，也无法做出任何决定性的事情。

有没有关于如何在 bjam 中创建自定义目标的好例子？还是我只是想以非预期的方式使用 bjam？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-02T09:46:17.303

没有参数的`bjam`调用会构建所有内容，因为您没有任何标记为 的`explicit`目标，除非明确要求，否则可以使用它来防止某些目标的构建。

`bjam build-main`失败，因为`build-main`不是要生成的目标或文件的名称；它是可以使用不同参数调用的规则（函数）的名称，每个调用声明不同的目标集。

`bjam main_example`使声明的目标：

```
exe main_$(project-name) : main_$(project-name).cpp $(project-name).o $(other-sources) ; 
```

它自然不包含`install`它的目标，在下一行声明。

`bjam main`构建`main_example`并安装它，因为它`main`是目标的名称`install`，声明为：`install main : main_$(project-name) : <location>. ;`

请注意，如果您`build-main`在 jamfile 中多次调用，则每次 bjam 调用都会以 退出`error: No best alternative for ./main`，因此最好将安装目标的名称重命名为类似`install_main_$(project-name)`的名称以防止名称冲突。然后`bjam install_main_example`将构建和安装`main_example`.

`bjam example_ext`使声明的目标：

```
python-extension $(project-name)_ext : $(sources) : ; 
```

并且不再像 with 一样安装`bjam main_example`。

`bjam example_ext.so``example_ext.so`确实是正在创建的文件名（当然是在给定平台下），因此所有导致文件命名的目标都`example_ext.so`将由该调用生成。这就是为什么不是所有`convenient-copy`指示安装的文件都通过`bjam example_ext.so`调用安装的原因。在这里我想澄清一点：“没有调用方便复制”不是一个准确的术语。`convenient-copy`是规则的名称，而不是目标，并且使用上面编写的代码，无论 bjam 调用参数如何，该规则将始终被调用。它在调用时所做的只是声明一个名为`convenient_copy`（注意下划线）的目标，这反过来导致（隐式）声明一些文件目标（用于安装），例如 example_ext.so、libboost_python.so 和其他匹配的依赖项`<install-type>SHARED_LIB <install-type>PYTHON_EXTENSION`. 当`convenient-copy`rule 被调用时，它实际上并没有构建任何东西，它只是声明了一些目标。实际构建的内容在稍后阶段决定，该决定取决于 bjam 调用参数。

`bjam convenient_copy`将构建 example_ext.so 并将其与其依赖项一起正确安装，但它遇到与`main`install target 相同的问题：如果您`convenient-copy`多次调用它会中断。将名称从 更改`convenient_copy`为`install_$(project-name)_ext`可以解决问题，然后您可以使用`bjam install_example_ext`.

最后，如果您希望目标不建立在没有参数的 bjam 调用上，则将该目标标记为显式，例如

```
explicit install_main_$(project-name) ; 
```

除非明确要求，否则将禁止 main_example 的安装。为了防止 main_example 的构建，还要添加`explicit`for`main_$(project-name)`和`$(project-name).o`：

```
explicit main_$(project-name) ;
explicit $(project-name).o ; 
```

或一起：

```
explicit install_main_$(project-name) main_$(project-name) $(project-name).o ; 
```

请注意，声明`main_$(project-name)`为while `explicit`not为.`install_main_$(project-name)``$(project-name).o``explicit``main_$(project-name)``explicit`

# css - 即使父元素相对定位，是否可以相对于主体绝对定位元素？

> ID：12379503
> 
> 赞同：2
> 
> 时间：2012-09-11T23:55:24.657
> 
> 标签：css

我无权编辑 HTML，所以我剩下的是一个我想要相对定位的侧边栏，这样我就可以在其中绝对定位一个元素，但我也希望一个孩子的孩子相对于正文，而不是侧边栏。

视觉示例：

```
Sidebar (relative)

| child (absolutely positioned in sidebar)

| child (statically positioned)

| | | | child of child (absolutely positioned relative to the body)

/Sidebar 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-12T00:00:00.937

不，不是 CSS。但是你可以：

*   `left`对and使用负值`top`
*   也许使用 JavaScript 来改变元素在 DOM 中的位置

# c++ - LNK 2005 链接器问题与 msvcrt.lib(MSVCR90.dll)

> ID：12379504
> 
> 赞同：0
> 
> 时间：2012-09-11T23:55:26.067
> 
> 标签：c++, visual-studio-2008, visual-c++, linker-errors, lnk2005

我正在与客户共享一个静态库。它使用的是 vs2008 sp 1。

我正在使用我用 mfc 构建的第三方库，带有共享 dll 和 /MD 选项发布版本

然后我构建了我自己的静态库，其中包括带有共享 dll 选项和 /MD 发布版本的 MFC 的第三方库。

我创建了一个测试 dll 以确保它正常工作。没有问题运行良好。我根本没有使用 MFC。只有客户这就是为什么他们告诉我将 MFC 与共享 dll 和 /MD 一起使用。

现在他们抱怨说他们得到了

xyz 已在 msvcrt.lib(MSVCR90.dll) 错误中定义。我认为这些看起来像 LNK2005 错误。

他们陈述如下：

“由于“我的库”与大型制造工具链构建中常见的许多库进行静态链接，因此具体链接失败。“我的库”正在导出这些常见的库函数，从而导致链接冲突。

他们还说：

“为了解决这个问题，“我的库”只能公开与单个 API（来自我的静态库）本身关联的函数，以保证不会导致链接冲突。当“我的库”为使用链接器选项和模块定义（.def 文件）语句的组合构建"

我不确定是什么导致了这个问题。这对我来说不是问题，但在那里。我在想他们可能在使用不正确的选项或错误的 CRT 版本时遇到问题？

另外，我不确定我能否满足他们可能不与 msvcrt.lib(MSVCR90.dll) 链接的要求，因为我的静态库确实依赖于标准 c 函数等。

我现在很迷茫，我确实研究了几个链接 [如何分发 C 运行时 (CRT) 库](https://stackoverflow.com/questions/8097733/how-to-distribute-c-run-time-crt-libraries)

和

[http://www.nuonsoft.com/blog/2008/10/29/binding-to-the-most-recent-visual-studio-libraries/](http://www.nuonsoft.com/blog/2008/10/29/binding-to-the-most-recent-visual-studio-libraries/)

但是如果链接中说明了 CRT 的问题，那么我不确定如何弄清楚我在 vs2008 中使用的静态库是什么 CRT。我已经使用 /verbose 来查看它，但它不起作用。而且我知道dumpbin 或dependency walker 不会将它用于静态库。

这几天一直在为此苦苦挣扎，并且疯狂地研究。没有关于为什么他们可能会遇到 msvcrt.lib(MSVCR90.dll) 问题的答案。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-12T03:09:51.993

从错误消息中获取冲突库的名称。将这些库的名称添加到您的静态库的项目设置中（我相信在链接器设置中）。应该有一行“忽略库”，这是您应该添加库名称的地方。确保您的项目编译并且您的测试通过。然后把你新编译的静态库发给他们，看看他们是否还有冲突。如果有，请获取冲突库的名称并重复该过程。

这里描述了这个和类似的修复：http: [//support.microsoft.com/kb/148652](http://support.microsoft.com/kb/148652)

您可以尝试将 MFC 支持添加到您的项目中，以尝试在您的开发环境中本地公开冲突；我敢打赌，这会导致您遇到与他们相同的错误。当 C 运行时和 MFC 库链接乱序时会发生这种情况。

# c++ - 何时写异步日志

> ID：12379505
> 
> 赞同：1
> 
> 时间：2012-09-11T23:55:25.920
> 
> 标签：c++, logging, asynchronous

我正在尝试编写一个异步日志记录类，但无法决定何时将日志写入文件。

现在，我正在考虑将所有日志存储在一个向量中，然后按它们的时间戳对它们进行排序。

问题是我应该什么时候将日志写入文件？如果我在写入磁盘之前等待 N 条日志，我可能会错过一个日志条目，或者如果我们已经达到向量中的 N 条日志，则一个日志条目可能会被乱序写入日志。

我在考虑也许使用某种计时器，但我不确定这是否会更好。

我将不胜感激任何想法，谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-12T16:59:29.187

如果您正在处理异步日志记录，我建议使用线程安全队列将所有带有时间戳的消息泵送到日志记录线程工作者。然后，日志工作者可以处理出现在队列中的块中的所有消息。

这种线程安全的队列抽象允许您设置缓冲区大小或使其不受限制（如果队列/缓冲区通过条件变量填满，您可以向线程发送消息），同时从多个线程记录日志，并且即使在发生错误后处理日志，如果您将主线程包装在一个 try catch 循环中，该循环等待记录器在退出之前完成（好吧，它不会帮助解决段错误，但它仍然有助于解决大多数错误）。此外，您可以将消息发送到记录器并在主程序线程中继续前进，而无需等待任何 IO 操作（可能会大大节省执行时间）。实施起来也不难。队列的 API 非常有限，因此您与数据结构的交互只能用一些范围锁定来包装一个列表。

您为此实施付出了很小的代价——即锁定价格。但是，如果您需要添加任何其他多线程，则不必重新构建记录器，并且通过将 IO 卸载到另一个线程，您可能会比单线程记录器更快。

如果您有消息乱序，您有两种选择。在队列的日志工作者端进行日志排序（为工作者保留一个本地缓冲区以保留较旧的消息）。或者将日志队列的实现更改为优先级队列，使用时间戳对消息进行排序并在插入时支付更高的价格。后者可能更容易实现，但要付出更高的同步代价。

我已经在 C++ 中使用 Boost 线程使用了这种策略，并且效果很好。我可以崩溃并且仍然从崩溃之前获取日志，并且当我将工作分支到各个线程以轻松进行可并行化的工作时，我只是在任何地方使用相同的日志抽象来轻松跟踪事件顺序。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-12T02:00:50.427

我同意关于在没有缓冲（或显式刷新）的情况下乱序写入它们的评论。但是，如果您想按顺序编写它们，我将有一个单独的线程来管理编写。您将定义一个特定的延迟量（大概以秒为单位），您可以合理地保证将涵盖任何迟到的情况。

所以在一个非常基本的意义上，你会有一个线程函数，比如：

```
time_t writeDelay = 10;  // 10 seconds

for(;;)
{
    // Sleep for a second
    //[OS-specific code here]

    time_t now;
    time(&now);
    WriteLogEntriesUpTo(now - writeDelay);
} 
```

这里的问题是，如果你做得不对，将你的日志条目分类到一个向量中可能会给你的记录器带来很多开销。至少使用 a`deque`这样您就可以轻松地从前面弹出条目。如果我要这样做，我可能会为我的日志字符串和队列中的简单记录设置一个大缓冲区（实际上是一个内存池）。带有时间戳和指针的东西会使排序变得容易。

```
struct LogEntry {
    time_t timestamp;
    char *message;
}; 
```

而不是把这些放在一个`deque`我会实现某种有序列表（同样，内存池）。让这一切快速完成将是相当繁琐的。你想得越多，乱写就越有意义。

# android - 蓝牙连接抛出错误

> ID：12379508
> 
> 赞同：1
> 
> 时间：2012-09-11T23:55:56.370
> 
> 标签：android, bluetooth

我已经编写了一个普通代码来连接到标准蓝牙设备（一个 wocket）。我正在做的是作为客户端连接到 wocket（它只是一块蓝牙芯片）。我正在使用随机 UUID 连接到 wocket。但是 connect 方法抛出一个 IO 异常，告诉我它无法连接到蓝牙设备。我使用的代码来自 Android 开发者论坛：http: [//developer.android.com/guide/topics/connectivity/bluetooth.html](http://developer.android.com/guide/topics/connectivity/bluetooth.html)

私有类 ConnectThread 扩展线程 { 私有最终 BluetoothSocket mmSocket; 私有最终蓝牙设备 mmDevice；

```
public ConnectThread(BluetoothDevice device) {
    // Use a temporary object that is later assigned to mmSocket,
    // because mmSocket is final
    BluetoothSocket tmp = null;
    mmDevice = device;

    // Get a BluetoothSocket to connect with the given BluetoothDevice
    try {
        // MY_UUID is the app's UUID string, also used by the server code
        tmp = device.createRfcommSocketToServiceRecord(MY_UUID);
    } catch (IOException e) { }
    mmSocket = tmp;
}

public void run() {
    // Cancel discovery because it will slow down the connection
    mBluetoothAdapter.cancelDiscovery();

    try {
        // Connect the device through the socket. This will block
        // until it succeeds or throws an exception
        mmSocket.connect();
        **This call is throwing and IOException saying:
        java.io.IOException Discovery Failed. 
```

**

```
 } catch (IOException connectException) {
        // Unable to connect; close the socket and get out
        try {
            mmSocket.close();
        } catch (IOException closeException) { }
        return;
    }

    // Do work to manage the connection (in a separate thread)
    manageConnectedSocket(mmSocket);
}

/** Will cancel an in-progress connection, and close the socket */
public void cancel() {
    try {
        mmSocket.close();
    } catch (IOException e) { }
} 
```

}

wocket 抛出 IOException 的原因可能是什么。我认为将它作为服务器连接到服务器没有任何意义，因为对于您建立 UUID 的服务器，然后您希望客户端具有相同的 UUID，这在我的情况下是不可能的，因为我无法对 wocket 进行编程。

我正在使用带有 Android 4.0 的 HTC one x 作为测试设备。

先感谢您。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-12T03:42:06.083

尽管使用随机 UUID，但请使用串行端口配置文件的 UUID，即“00001101-0000-1000-8000-00805f9b34fb”，因为 wocket 可能不支持您使用的随机 UUID。当你这样做时

```
createRfcommSocketToServiceRecord(MY_UUID); 
```

它会在您连接的设备上进行服务发现，并查看您提供的 UUID 是否存在于设备中，如果存在则连接到设备。

# android - 带有 cocos2dx 的 Wildfire S 上与声音相关的崩溃

> ID：12379511
> 
> 赞同：0
> 
> 时间：2012-09-11T23:56:10.757
> 
> 标签：android, cocos2d-x, soundpool

我在与声音相关的**HTC Wildfire S**上经常崩溃时遇到问题（在其他设备（如 Thunderbolt）上出现类似的崩溃，但频率较低）。我已经尝试了各种各样的方法来解决它，或者至少在没有运气的情况下了解更多关于问题的确切原因。

我确定这个问题与声音有关。当我注释掉`SoundPool.play()`问题时，问题就消失了。我不认为它是特定于 SoundPool 的，因为我尝试使用**OpenSL ES**来代替它并没有减少崩溃。

我也很难接受这必然是较低级别声音的问题，因为它只发生在这个标题上；但不是（据我所知）在其他使用相同声音代码构建的游戏上。此外，我几乎没有发现其他人遇到同样问题的证据。

但是我能想到的游戏特定的事情会导致这种情况（大量同时出现的声音，频繁的声音，声音格式）似乎不是问题（我一次只减少了一个声音，切换到 WAV，更小文件，OGG，忽略而不阻塞最近发生在另一个声音中的声音）。

我们的通用代码是建立在**cocos2dx**之上的，看起来（虽然我不完全相信）崩溃增加了*** *Cocos2dxSound*** *.java* * 的调整，所以它只会`SoundPool.play(...)` `returned 0`在第一次之后休眠主​​线程。

此外，如果可能出现问题，安装后会下载来自 APK 的一些声音。

非常感谢任何想法或建议；这比它应该花费的时间更长。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-12T00:02:53.823

如果您共享一些代码会有所帮助。但我建议你从 ZXing 检查这段代码：

[http://code.google.com/p/zxing/source/browse/trunk/android/src/com/google/zxing/client/android/BeepManager.java?r=2271](http://code.google.com/p/zxing/source/browse/trunk/android/src/com/google/zxing/client/android/BeepManager.java?r=2271)

特别是 buildMediaPlayer()

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-14T23:13:24.697

该问题是由一个不相关的问题引起的。当声音播放时，它暴露了问题。不确定是怎么玩的；但我们怀疑无论出于何种原因播放声音都会将大多数低/中档手机置于内存边缘（ndk-profiler 最近已签入，但签入时并未禁用它，因此它仍在进行分析）。

# ios - 播放音频时更改音频路由

> ID：12379520
> 
> 赞同：5
> 
> 时间：2012-09-11T23:57:57.753
> 
> 标签：ios, objective-c, audio, avaudioplayer

我有一个使用 avaudioplayer 播放的音频文件，我希望能够在用户按下按钮时播放音频时在设备接收器或扬声器上播放声音。我怎样才能做到这一点 ？目前它只是在音频开始播放之前选择的任何内容上播放。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-01T20:34:24.070

```
UInt32 audioRouteOverride = kAudioSessionOverrideAudioRoute_Speaker;
OSStatus result = AudioSessionSetProperty( kAudioSessionProperty_OverrideAudioRoute, sizeof(audioRouteOverride), &audioRouteOverride );
Assert(result == kAudioSessionNoError); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2014-05-18T18:51:15.957

iOS 6+ 版本

```
NSError* error;

AVAudioSession* session = [AVAudioSession sharedInstance];

[session overrideOutputAudioPort:AVAudioSessionPortOverrideSpeaker error:&error]; 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-02T15:38:08.207

您可以将 MPVolume 控件（[文档链接](http://developer.apple.com/library/ios/#documentation/mediaplayer/reference/MPVolumeView_Class/Reference/Reference.html)）添加到您的用户界面并设置 showVolumeSlider = NO 和 showsRouteButton = YES。

用户将有一个路由按钮将音频路由到他们选择的设备。

# jquery - 在响应式设计中使用 CSS 覆盖 JQuery 函数

> ID：12379523
> 
> 赞同：0
> 
> 时间：2012-09-11T23:58:06.723
> 
> 标签：jquery, css, responsive-design

我在我的网站上遇到了一个小障碍。在移动版本（<480px）中，我有一个用于评论的切换按钮。>480px 版本，按钮隐藏，我想一直显示评论。这是一种响应式设计，因此在调整大小时它是相同的页面。我怎样才能做到这一点？

```
$(document).ready(function(){
  $('#comments-container').addClass('mobile-hide');

   $('#show-comments').click(function()
   {
      $('#comments-container').filter(':not(:animated)').slideToggle();
   });
}); 
```

`.mobile-hide`只是`display: none;`。当我将内容切换为显示然后隐藏并将浏览器大小调整为 >480px 时，内容仍然隐藏。我尝试设置`.mobile-hide { display: block; }`>480px 样式表，但它不起作用。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-12T00:04:12.087

您是否考虑过在 CSS 中使用媒体查询来实现这一点？听起来您不需要为此使用JS，但我有点不清楚。例如：

```
#comment-button {display:block;}

@media only screen and (max-device-width: 480px) {
  #comment-button {display:none;}
} 
```

要监听浏览器宽度，您可以设置一个刻度事件（使用 setInterval 每 x 秒发生一次）或使用 resize 事件：

```
$(window).on('resize', function(ev) {
    if($(window).width() > 480)
        $('html').removeClass('mobile-device').addClass('desktop-device');
    else
        $('html').removeClass('desktop-device').addClass('mobile-device');
});

html.mobile-device .toggle-button {display:none;} 
```

# c++ - 友元和静态成员函数有哪些成员访问权限？

> ID：12379525
> 
> 赞同：2
> 
> 时间：2012-09-11T23:58:16.393
> 
> 标签：c++, static-methods, friend, static-members, private-members

我想知道类对象有什么样的类成员访问`friend`函数和`static`成员函数。具体来说，有什么区别以及为什么要使用另一种。据我了解，声明为`friend`类或`static`成员的函数都可以访问该类的任何实例的私有成员。

我将举一个简单的例子来说明为什么它们看起来与我如此相似。这两个功能似乎都具有相同的访问权限，`operator<`并且`MyClass::lessThan`可以做完全相同的事情。

```
class MyClass {
    friend bool operator<(const MyClass &left, const MyClass &right);
public:
    MyClass(int pub, int priv) : m_pub(pub), m_priv(priv) {}
    static bool lessThan(const MyClass &left, const MyClass &right);
    int m_pub;
private:
    int m_priv;
};

bool operator<(const MyClass &left, const MyClass &right) {
    return ( (left.m_pub < right.m_pub) && (left.m_priv < right.m_priv) );
}

bool MyClass::lessThan(const MyClass &left, const MyClass &right) {
    return ( (left.m_pub < right.m_pub) && (left.m_priv < right.m_priv) );
}

int main(int argc, const char* argv[]) {
    MyClass a(1, 2),
        b(3, 4),
        c(-1, 1);
    cout << "a < b        = " << (a<b) << endl;
    cout << "a lessThan b = " << MyClass::lessThan(a,b) << endl;
    cout << "a < c        = " << (a<c) << endl;
    cout << "a lessThan c = " << MyClass::lessThan(a,c) << endl;
} 
```

显然这是一个简化的例子，但我想我的问题分为两部分：

1.  在成员访问方面，朋友和静态函数有什么区别？
2.  在决定使用哪一种时应该考虑哪些事情？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-12T00:12:26.553

请记住，虽然**友元**函数的原型出现在类定义中，但**友元**函数不是函数成员。类的**友**元函数是在类之外定义的，但**友**元函数可以访问非公共成员。有些人认为“友谊”会破坏信息隐藏。有时**友元**函数用于创建测试器类。

当一个对象类应该只共享一个变量的一个副本时，使用静态数据成员。因此，当所有类成员仅一份副本就足够时，您必须使用静态数据成员来节省存储空间。

对于静态成员函数，您可以查看以下内容：[何时使用静态成员函数？](https://stackoverflow.com/questions/4921150/when-to-use-static-member-function)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-12T00:04:04.540

它们是不同的概念：

如果一个类、方法或函数是类 X 的朋友，则该类、函数或方法可以访问类 X 的成员，这些成员被声明为私有，因此通常无法在类外部访问

```
class A{
  private:
     int x;
  friend void foo(A& a);

};

void foo(A& a){
    a.x = 3; //Access okay, foo is a friend of A
} 

void bar(A& a){
   a.x = -1; // Compiler will complain A::x is private
} 
```

静态成员要么是该类的所有对象实例之间共享的数据成员，要么是可以在没有该类的实例对象的情况下调用的方法。

```
class B{

  private:
    static int y;

  public:
    static void printY();
    void alterY();

}

int B::y=3;

void B::printY(){
   cout<<y;
}

void B::alterY(){
   y++;
   cout<<y;
}

B b1,b2;
B::printY();// will output 3
b1.alterY();// will output 4
b2.alterY();// will output 5 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-12T00:04:35.993

静态方法可以在不通过类实例的情况下调用，因此它们没有任何直接访问权限，它们类似于全局函数，但嵌套在类的命名空间中。但是，如果您给他们一个该类的实例作为参数，他们将能够访问成员变量，而无需像非静态方法一样通过访问器。像静态方法一样，友元函数如果你给他们一个他们是友元的类的实例作为参数，他们将能够直接访问成员变量。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-09-12T00:04:49.267

1.  他们都可以访问班级的所有成员，包括私人成员
2.  您需要确定一个函数在逻辑上是否属于需要访问其成员的类，或者它是否属于另一个类或根本不属于任何类。在第一种情况下（逻辑上属于类的函数）使函数静态；在第二种情况下，使其成为朋友，并根据您的设计将其添加到逻辑所属的类或命名空间中。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-09-12T00:24:56.313

> 在成员访问方面，朋友和静态函数有什么区别？

没有任何。他们都有完全的访问权限。

> 在决定使用哪一种时应该考虑哪些事情？

它完全取决于上下文以及使代码更易于阅读的原因。

在您上面的示例中，我肯定会更喜欢它`bool operator<()` ，`MyClass::lessThan()`因为它使代码更易于阅读。

# python - Sqlalchemy“双层”查询

> ID：12379529
> 
> 赞同：1
> 
> 时间：2012-09-11T23:58:37.550
> 
> 标签：python, sqlalchemy, pyramid

所以我真的不知道如何命名我的问题，所以这是我最好的选择。现在，我的情况是我有几张桌子：

```
Post
---------
Id
#....

Alert
-------------
Id
like_id
Seen

Like
--------
id
post_id 
```

现在，我需要在我拥有帖子 ID 的地方设置请求处理，但我需要找出是否已经启动了与同一帖子对应的另一个警报。所以基本上，它是一个“两层”查询，我必须在其中找到对应于同一个帖子的类似的警报。我怎么能用 sqlalchemy 做到这一点？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-12T03:16:39.280

For example:

```
class Post(Base):
    __tablename__ = 'post'

    id = Column(Integer, primary_key=True)
    text = Column(Unicode)

class Like(Base):
    __tablename__ = 'like'

    id = Column(Integer, primary_key=True)
    post_id = Column(Integer, ForeignKey(Post.id), nullable=False)

class Alert(Base):
    __tablename__ = 'alert'

    id = Column(Integer, primary_key=True)
    like_id = Column(Integer, ForeignKey(Like.id)) 
```

Then in SQLAlchemy you can use the following query:

```
DBSession.query(Alert.id).join(Like).join(Post).filter(Post.id==2).all() 
```

# heroku - Heroku 'Writing config/database.yml to read from DATABASE_URL' 是什么意思？

> ID：12379530
> 
> 赞同：5
> 
> 时间：2012-09-11T23:58:48.797
> 
> 标签：heroku

当我的应用程序基于 Heroku 构建时，它说

```
Writing config/database.yml to read from DATABASE_URL 
```

这意味着什么？这是 Cedar 堆栈的新功能吗？

我有一个机架应用程序。我`config.ru`曾经在 Barmy Bamboo 堆栈上工作：

```
#!/usr/bin/ruby
environment = ENV['DATABASE_URL'] ? 'production' : 'development'

require './pb.rb'

dbconfig = YAML.load(File.read('config/database.yml'))
Pb::Models::Base.establish_connection dbconfig[environment]
Pb.create if Pb.respond_to? :create

run Pb 
```

在我自己的计算机上，它将读取我的本地`config/database.yml`（未提交源代码控制）

```
development:
  adapter: sqlite3
  database: db/development.sqlite3
  pool: 5
  timeout: 5000 
```

在 Heroku 上，它会读取 Heroku 的`database.yml`. 现在在 Cedar 上检查它`heroku run cat config/database.yml`，它似乎是一个 Ruby 文件，而不是 yml。这种变化在任何地方都有解释吗？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-09-12T01:40:33.227

当您将应用程序推送到 Heroku 时，如果您有一个`config`目录，[Ruby 构建包会写入一个新`database.yml`文件](https://github.com/heroku/heroku-buildpack-ruby/blob/v34/lib/language_pack/ruby.rb#L440-503)，并在执行时生成您看到的消息。

Rails[在加载该文件时通过 ERB 运行该文件](https://github.com/rails/rails/blob/v3.2.8/railties/lib/rails/application/configuration.rb#L110-116)，以允许各种动态选项。Heroku 利用这一点，生成一个 ERB 文件，该文件读取`DATABASE_URL`环境变量并创建`.yml`指向该数据库的适当文件。

我假设在 Bamboo 的情况下，`database.yml`创建的是一个简单的 Yaml 文件，指向您的数据库（我找不到任何参考）。

要让您的应用程序在 Cedar 上运行，您需要像 Rails 一样通过 ERB 运行文件。改变这个：

```
dbconfig = YAML.load(File.read('config/database.yml')) 
```

至

```
require 'erb'
dbconfig = YAML.load(ERB.new(File.read('config/database.yml')).result) 
```

如果您的本地`database.yml`只是简单的 yaml，那么像这样通过 ERB 运行应该是无操作的，它将在 Heroku 上获取正确的值。

# haskell - 为什么我会收到类型错误？

> ID：12379535
> 
> 赞同：0
> 
> 时间：2012-09-11T23:59:19.313
> 
> 标签：haskell, compiler-errors, typeerror, function-declaration

在 Haskell 中，我在定义函数时遇到了一些问题，因为我的参数类型与所需的类型不匹配。

例如，我想编写一个函数，它接受一个`n :: Int`并产生从 1 到 的`floor`平方根的整数列表`n`。因此，我将有一个功能，例如：

```
list :: Int -> [Int] 
```

最初我将函数定义如下：

```
list :: Int -> [Int]

list n = [1 .. floor (sqrt n)] 
```

当我加载脚本时，出现类型不匹配的错误消息。但是，我不确定我是否不匹配`sqrt`函数或`floor`函数的类型。错误信息如下：

```
No instance for (Floating Int)
  arising from a use of 'sqrt' at pe142.hs:6:22-27
Possible fix: add an instance declaration for (Floating Int)
In the first argument of 'floor', namely '(sqrt n)'
In the expression: floor (sqrt n)
In the expression: [1 .. floor (sqrt n)]
Failed, modules loaded: none. 
```

有人可以向我解释导致错误的原因以及如何修复它吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-12T00:09:54.107

`sqrt`需要`Floating`类的参数，例如 a `Double`。您正在向它传递一个`Int`，它不是`Floating`该类的实例 - 这就是错误消息告诉您的内容。

因此，要修复错误，请在调用之前将您的转换`Int`为 a 。您可以使用该功能。`Double``sqrt``fromIntegral`

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-09-12T00:12:23.447

当我尝试这个时：

```
list :: Int -> [Int]
list n = [1 .. floor (sqrt n)] 
```

我收到此错误：

```
../src/scratch.hs:15:16:
    No instance for (RealFrac Int)
      arising from a use of `floor'
    Possible fix: add an instance declaration for (RealFrac Int)
    In the expression: floor (sqrt n)
    In the expression: [1 .. floor (sqrt n)]
    In an equation for `list': list n = [1 .. floor (sqrt n)]

../src/scratch.hs:15:23:
    No instance for (Floating Int)
      arising from a use of `sqrt'
    Possible fix: add an instance declaration for (Floating Int)
    In the first argument of `floor', namely `(sqrt n)'
    In the expression: floor (sqrt n)
    In the expression: [1 .. floor (sqrt n)] 
```

这些错误的含义如下：

*   该`floor`函数不能接受 type 的参数`Int`。它的参数必须是“实分数”类型。（要求类型只支持整数的数字的下限是没有意义的。）
*   该`sqrt`函数也不能接受类型的参数`Int`。它的参数必须是浮点类型。（平方根通常是无理数，所以我们需要浮点类型。）

你会发现 Haskell 对哪些数字函数可以应用于哪些数字类型非常非常挑剔，对这些函数返回的类型非常挑剔，而且它基本上不执行任何隐式转换。我通常尝试让编译器推断数字代码中的类型，因为类层次结构非常复杂。如果我们省略了函数的类型声明，编译器会推断出这种类型：

```
list :: (Floating a, Integral t, RealFrac a) => a -> [t] 
```

即，您的`list`函数函数将浮点“实分数”作为其参数，并生成一个整数列表作为其结果。因此，例如，`list`可以采用类型的参数`Double`并生成`[Integer]`.

但是即使省略类型声明也不意味着你不会遇到麻烦，而且你经常不得不使用显式转换；最典型的是您必须使用该函数`fromIntegral`将整数类型转换为小数类型。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-12T00:12:30.320

sqrt 具有以下类型签名：

```
Floating a => a -> a 
```

这意味着 sqrt 接受一个类型为 a 的参数并返回一个类型为 a 的参数。限制是 a 必须是类型类 Floating 中的类型，通常是 Single 或 Double。Int 不在类型类 Floating 中，因此您需要将 n 转换为类型类 Floating 中的内容，您可以通过添加调用来做到这一点`fromIntegral`：

```
list n = [1 .. floor (sqrt (fromIntegral n))] 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-12T11:01:53.023

这个问题大约每周被问一次。（这不是对你的抱怨，只是一个观察。显然这让很多人感到困惑。）

简而言之，`sqrt`不适用于整数，仅适用于浮点数。（例如，它不适用于`Int`，但它确实适用于`Double`。）在某些编程语言中，在这种情况下，整数总是自动“提升”为浮点数。但在 Haskell 中，您必须手动执行此操作。

The solution, as half a dozen other people have no doubt already written, is to stick a `fromIntegral` in there to convert from integers to floating-point. You already have `floor` in there, which lets you convert back to an integer afterwards, as you'd expect.

# php - mysql 和 php 安全性：仅作为目录的数据库

> ID：12379538
> 
> 赞同：1
> 
> 时间：2012-09-12T00:00:05.880
> 
> 标签：php, mysql, security, connection

我只使用 mysql 数据库来显示信息。我能找到的所有关于安全性的信息都是关于动态创建用户名和密码，或者用于用户输入，这不适用于这里，所以如果我错过了重复，请原谅我。

我正在为以下每个进程创建一个单独的 php 文件：

*   config：包含数据库主机、用户名和密码。这将受 htaccess 保护
*   opendb：这将登录到数据库
*   closedb：这将退出数据库
*   功能：这将包含用户定义的功能

用户名权限将仅限于选择。

我正在使用准备好的语句。会话开始包含在用户函数中。

有什么我想念的吗？这听起来相对安全吗？同样，此数据库中的所有信息*都不*是专有的。网站不大。

如果您需要更多信息，请告诉我。

**更新**

使用盐的必要性有多大？

另外，我在某处读到，您可以将其放入 ini 文件中，只需调用连接函数而不存储用户名和密码。那是更好的选择吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-12T00:17:12.330

我能想到的唯一不好的情况是数据库可能会在外部更新（不受您的控制）。有人将 javascript 添加到您正在显示的字段中。然后，您的网站将被用作对访问者进行 XSS 攻击的一部分。解决方案：在显示之前清理数据库输出。

您可能还想避免真正昂贵的查询（以防止拒绝服务），并确保您的 PHP 和 Web 服务器是最新的。

尽管很难从外部访问您的数据库或污染它，但您还应该保护自己免受更传统的攻击。例如，不允许用户将任何内容上传到外部可寻址的位置（或者在确定您知道那里有什么之前不要上传）。

# fonts - 如何让 iWeb 使用 Google Webfont？

> ID：12379539
> 
> 赞同：1
> 
> 时间：2012-03-29T21:22:07.570
> 
> 标签：fonts, iweb

如何让 iWeb 使用来自[Google Webfonts](http://www.google.com/webfonts)的字体？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-04T23:26:10.470

您必须在 iWeb 生成代码后对其进行编辑。Webfonts 需要在头部有一个链接，以便浏览器知道下载字体，并且您想要应用字体的 CSS 选择器需要修改。（谷歌给出了所有的说明）

尽管即使您这样做了，每次更新站点时都需要这样做，因为 iWeb 只会覆盖您的代码编辑。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-21T13:47:25.707

[http://www.wyodor.net/Tutorials/Google/Google_Fonts.html](http://www.wyodor.net/Tutorials/Google/Google_Fonts.html)

# joomla - 注册表中的个人字段joomla 2.5

> ID：12379546
> 
> 赞同：1
> 
> 时间：2012-09-12T00:02:03.087
> 
> 标签：joomla, field

我已经添加了一个字段调用 ID，但我需要这个字段有这个掩码#-####-#### 我该怎么做才能看到例如 1-7878-7878

我怎样才能做到这一点 ？

问候，

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-12T07:18:13.607

您无法创建名称为`ID`. 因为在`Joomla`注册表中已经有了`ID`。所以你必须定义新的字段名。

```
`field_name` varchar(255) NOT NULL default '' 
```

您必须将字段类型声明为`varchar`.

希望这会帮助你...

# python - 在 Python 中传递自定义类

> ID：12379552
> 
> 赞同：0
> 
> 时间：2012-09-12T00:02:44.363
> 
> 标签：python, python-2.7

我将一组`MovieFile`对象从 x.py 传递给 y.py 并遍历它们，尝试在 y.py 中使用每个对象的属性

**x.py**

```
mfSet = {}

def pop():
    ## populate mfSet with MovieFile objects
    m = MovieFile(title=t, year=y, dir=d, filename=f)
    mfSet.setdefault(str(m), []).append(m)

class MovieFile():
    def __init__(self, title, dir, filename, year=0):
        self.title = title
        self.year = year
        self.fulltitle = title if year == 0 else title + ' (' + year + ')'
        self.dir = dir
        self.filename = filename
    def __str__(self):
        return repr(self.title + ' (' + self.year + ') at ' + self.dir) 
```

**y.py**

```
from x import MovieFile, mfSet, pop # not sure if I need to import MovieFile

pop()

for mf in mfSet:
    ft = mf.fulltitle # stacktrace says this attr doesn't exist for str object
    title = mf.title # printing shows that this is "<built-in method title of str object at 0x10d84a3f0>" 
```

所以我的主要问题是：

`fulltitle`为什么 MovieFile 对象被编译为 str 对象，一旦我使用了这些对象，我该如何使用attr？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-12T00:10:39.887

您还没有展示什么`pop`是（请包括该代码，这是重要的一点）。但是，我预计问题出`mfSet`在 a`dict`并且您正在分配`str`键 - 也许`mfSet[str(mf)] = mf`. a 的迭代`dict`产生键，而不是字典的值。

您可能想要使用 a`set`而不是 a `dict`。或者，更改`for mf in mfSet:`为`for mf in mfSet.itervalues():`（并将变量名更改`mfSet`为不会误导类型；[PEP 8](http://www.python.org/dev/peps/pep-0008/)还建议不要在变量名中使用 camelCase）。

* * *

因此，您按 分组`MovieFile.__str__()`。那好吧。这是我编写该代码的方式：

```
from collections import defaultdict

mf_collection = defaultdict(list)

def pop():
    ## populate the collection with MovieFile objects
    m = MovieFile(title=t, year=y, dir=d, filename=f)
    mf_collection[str(m)].append(m)

class MovieFile():

    def __init__(self, title, dir, filename, year=0):
        self.title = title
        self.year = year
        self.fulltitle = title if year == 0 else title + ' (' + year + ')'
        self.dir = dir
        self.filename = filename

    def __str__(self):
        return repr(self.title + ' (' + self.year + ') at ' + self.dir) 
```

和 y.py：

```
from x import mf_collection, pop

pop()

for mf_group in mf_collection.itervalues():  # this yields lists of MovieFiles
    for mf in mf_group:  # this yields the actual MovieFiles
        ft = mf.fulltitle
        title = mf.title 
```

因为您正在使用列表作为值，所以您需要进行另一个级别的迭代。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-12T00:59:20.733

`{}`制作字典，而不是集合（这是因为`dict`和`set`文字都使用`{}`符号，但字典文字排在第一位）。

如果你想要一个空集，你需要使用`set()`. 然后`pop`变成

```
mfSet = set()
def pop():
    mfSet.add(MovieFile(title=t, year=y, dir=d, filename=f)) 
```

# .net - 如何提升我可以传递管理员密码的过程，这样 UAC 就不必要求它了

> ID：12379553
> 
> 赞同：1
> 
> 时间：2012-09-12T00:02:44.073
> 
> 标签：.net, uac

我有一个普通用户可以运行的 exe，但它需要合并一个*REG*文件，这需要 UAC 弹出窗口询问管理员密码，我不想提供给用户。

有没有办法让我输入密码，`process.StartInfo`这样 UAC 就不必询问密码了？

如果我这样做：

```
process.StartInfo.Domain    = "XYZ";
process.StartInfo.UserName  = "admin";
process.StartInfo.Password  = ""; 
```

它告诉我我需要被提升。

我还尝试冒充管理员帐户，然后：

```
process.StartInfo.Verb      = "runas";
process.start() 
```

但它会崩溃：

> 未处理的异常：System.ComponentModel.Win32Exception：未知错误 (0xffffffffe)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-12T06:01:25.447

不，你不能那样做。如果您可以轻松绕过 UAC，那将毫无意义。

问题是即使您知道密码，安全令牌也是使用已删除的权限创建的。当您登录 Windows 时会发生这种情况：您提供了用户名和密码，但您没有立即获得所有管理员权限，您必须通过 UAC 确认来提升权限。

# mysql - 在 MySQL 中两次使用子查询的结果

> ID：12379554
> 
> 赞同：2
> 
> 时间：2012-09-12T00:02:49.513
> 
> 标签：mysql, triggers, subquery, sql-update

我正在创建一个触发器以在另一个表中插入一行时更新一个表。在这个更新语句中，我需要从第一个表中选择一个值。然后我需要在更新语句的两个地方使用这个选定的值。这是我现在的触发语句：

```
CREATE TRIGGER rsrcInsTrig AFTER INSERT ON jos_resources
FOR EACH ROW 
    UPDATE newtbl
    SET subtree_count = subtree_count + 1
    WHERE lft <= (SELECT lft FROM newtbl WHERE taxon_id = NEW.taxon_id)
    AND rgt >= (SELECT lft FROM newtbl WHERE taxon_id = NEW.taxon_id); 
```

这很好用，但不是很优雅（我不需要被告知“newtbl”不是一个好名字；我没有成功）。显然，我希望子查询只运行一次，并保存并使用两次。如果这是一种编程语言，我会定义一个变量。

有没有办法做我想做的事？这真的是一个问题吗（请注意，“newtbl”有超过 150*万*个条目，所以对它的查询并不是微不足道的）？关于这个主题的其他问题是使用连接解决的，但我认为这不适用于这里。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-12T00:08:38.437

```
CREATE TRIGGER rsrcInsTrig AFTER INSERT ON jos_resources
FOR EACH ROW BEGIN
    DECLARE tmplft INT DEFAULT 0; -- assuming it really is an INT
    SELECT lft FROM newtbl WHERE taxon_id = NEW.taxon_id INTO tmplft;
    UPDATE newtbl
    SET subtree_count = subtree_count + 1
    WHERE lft <= tmplft
    AND rgt >= tmplft;
END 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-12T02:02:49.127

您可以稍微不同地表达 WHERE 子句：

```
UPDATE newtbl
SET subtree_count = subtree_count + 1
WHERE (SELECT lft FROM newtbl WHERE taxon_id = NEW.taxon_id) between lft and rgt 
```

# .htaccess - htaccess 规则应用查询字符串规则并更改 url

> ID：12379561
> 
> 赞同：0
> 
> 时间：2012-09-12T00:03:21.500
> 
> 标签：.htaccess

```
 /index.php?search_category=32
to
/32 
```

如何通过`.htacces`s 以在`"/index.php?search_category=32"`出现时自动更改为`"/32"`具有相同查询字符串规则的方式执行此操作？

提前致谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-12T00:23:39.057

**在您的 index.php 文件所在目录**的 htaccess 文件中，您需要添加这些规则。例如，如果目录是`/xyz/`：

```
RewriteEngine On

RewriteBase /xyz/

RewriteCond %{ENV:REDIRECT_STATUS} !200
RewriteCond %{QUERY_STRING} ^search_category=([0-9]+)
RewriteRule ^index.php$ %1? [L,R=301]

RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteRule ^([0-9]+)$ index.php?search_category=$1 [L,QSA] 
```

这是设置，因此您可以交换任何目录中的 htaccess 文件，只要您将 更改为`RewriteBase`htaccess 文件所在的目录（包括文档根目录`/`）。

# text - awk - 比较两个文件，匹配一个字段，合并两个文件

> ID：12379564
> 
> 赞同：2
> 
> 时间：2012-09-12T00:03:37.177
> 
> 标签：text, awk

嘿伙计们，我需要一些帮助，我的目标是在 file2 中匹配 find 或匹配 file1 的第一部分

文件1：

```
\\tempcomputer\c$\test2;test folder;c:\test2
\\tempcomputer\c$\temp;temp folder;C:\temp
\\tempcomputer\c$\unavailablefolder;c:\unavailablefolder 
```

文件2：

```
\\tempcomputer\c$\test2\;2.777.768 Bytes;11/09/12;11/09/12
\\tempcomputer\c$\temp\;5.400.050.974 Bytes;10/09/12;11/09/12
Error: Invalid property element: \\tempcomputer\c$\unavailablefolder 
```

预期输出：

```
\\tempcomputer\c$\test2;test folder;c:\test2;2.777.768 Bytes;11/09/12;11/09/12
\\tempcomputer\c$\temp;temp folder;C:\temp;5.400.050.974 Bytes;10/09/12;11/09/12
\\tempcomputer\c$\unavailablefolder;c:\unavailablefolder;Error: Invalid property element: \\tempcomputer\c$\unavailablefolder 
```

* * *

例如，我想从 file1 的第一行进行比较：

```
\\tempcomputer\c$\test2 
```

在第二个文件上搜索，并从 file1 连接两个文件

```
\\tempcomputer\c$\test2;test folder;c:\test2 
```

并从文件2

```
c:\test2;2.777.768 Bytes;11/09/12;11/09/12 
```

所以第一行是：

```
\\tempcomputer\c$\test2;test folder;c:\test2;2.777.768 Bytes;11/09/12;11/09/12 
```

第一行的预期结果：

```
\\tempcomputer\c$\test2;test folder;c:\test2;2.777.768 Bytes;11/09/12;11/09/12 
```

第二行的预期结果：

```
\\tempcomputer\c$\temp;temp folder;C:\temp;5.400.050.974 Bytes;10/09/12;11/09/12 
```

第三行的预期结果：

```
\\tempcomputer\c$\unavailablefolder;c:\unavailablefolder;Error: Invalid property element: \\tempcomputer\c$\unavailablefolder 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-12T03:03:31.440

如果它是因为*c00kiemon5ter*指示带有反斜杠的复制粘贴错误，那么迭代`File2`中的每一行很简单`File1`，我假设您在找不到匹配项时不希望输出。

*简单的.awk*

```
BEGIN { FS = OFS = ";" }

{ 
  l=$0
  first=$1
  while(getline < "File2") { 
    if(first == $1) {
      print l, $0
      break
    }
  }
} 
```

运行：

```
awk -f simple.awk File1 
```

最后允许一个可选的反斜杠需要更多的工作，但是大部分额外的复杂性可以转移到一个函数中：

*更多工作.awk*

```
function optional_end(s, c) {
  if(c == "")
    c = "\\"
  if(substr(s, length(s)) == c)
    s = substr(s, 1, length(s) - 1)
  return s
}

BEGIN { FS = OFS = ";" }

{ 
  l=$0
  first = optional_end($1)

  while(getline < "File2") {
    if(first == optional_end($1)) {
      print l, $0
      break
    }
  }
} 
```

运行：

```
awk -f more-work.awk File1 
```

* * *

***由 c00kiemon5ter 编辑* ：3**

修改*simple.awk*。
也适用于`\;`第一场-行结尾和打印-加入第三行。

```
BEGIN { FS = OFS = ";"; if( file == "") file = "File2" }

{ 
  l=$0
  first=$1
  while(getline < file) { 
    if((idx = index($0, first))) {
      if (idx == 1)
          $1 = l
      else
          $1 = l FS $0
      print
      break
    }
  }
} 
```

***编辑 2***

输入文件现在可以作为选项给出`-v file=SOME_FILE`；如果没有给出“File2”，则使用，例如：

```
awk -f simple.awk -v file=SOME_FILE File1 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-12T04:45:43.733

假设 File2 中的路径末尾没有终端反斜杠，则如下：

```
join -t ';' <(sort File1) <(sort File2) 
```

将输出：

```
\\tempcomputer\c$\temp;temp folder;C:\temp;5.400.050.974 Bytes;10/09/12;11/09/12
\\tempcomputer\c$\test2;test folder;c:\test2;2.777.768 Bytes;11/09/12;11/09/12 
```

# iphone - 从 UIImagePickerController 启动 ViewController

> ID：12379565
> 
> 赞同：1
> 
> 时间：2012-09-12T00:03:49.550
> 
> 标签：iphone, objective-c, cocoa, uiimagepickercontroller

# 问题

从它启动的视图控制器返回到我的 UIImagePickerViewController 后，相机屏幕忘记了用户拍照并让他重新拍照。

# 细节

我的相机有一个“分享”按钮，在拍照和预览屏幕期间都会显示，如下所示：

![在此处输入图像描述](../Images/5e8c1f45833179aebcc7b06b75094c24.png)

单击共享时，允许用户通过另一个视图控制器添加联系人，如下所示：

![在此处输入图像描述](../Images/107cce81863fbd59687b39c729e2036b.png)

如果用户在拍照之前这样做，这很好，但如果用户在预览屏幕上，他会在返回时被送回拍照模式。

我尝试过以模态方式和通过推送/弹出它来启动新的视图控制器，但是两者都表现出相同的行为——图像选择器忘记了它已经拍摄了一张照片。

# 可能的解决方案

有没有办法保存图像选择器的状态？或者也许是一种显示另一个视图控制器而不必自己启动它的方法？目前可行的解决方案是在预览屏幕期间不显示共享按钮。

谢谢你这么。

# python - 有没有办法从其他函数调用函数？

> ID：12379570
> 
> 赞同：1
> 
> 时间：2012-09-12T00:04:13.133
> 
> 标签：python

当我尝试从其他函数调用函数时（准确地说是在 if 语句中），我不断收到错误。喜欢：

```
 def function1(num):
        num = 5    
        if num == 5:
            function2("This is 5")
        return

    def function2(x):
        print x
        return 
```

我以前没有发现任何类似的问题。有可能吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-12T00:05:25.663

编辑：第一个错误只是一个打字错误，并已在问题中得到纠正。

删除行后的冒号`function2("This is 5")`。

此外，您没有显式返回值，因此没有理由在两个函数的末尾使用 return 语句。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-12T00:07:32.107

```
def function1(num):
    num = 5    
    if num == 5:
        function2("This is 5")
    return

def function2(x):
    print x
    return 
```

这对我有用，您在 function1 中调用 function2 之后添加了一个额外的冒号，而在 function2(x) 之后错过了一个冒号

# wpf - ListView 不会在窗口底部停止

> ID：12379574
> 
> 赞同：0
> 
> 时间：2012-09-12T00:05:00.383
> 
> 标签：wpf, listview

我试图创建一个相当复杂的窗口，其中有多个部分显示一些数据列表。现在根据来源，每个部分的列表中可以有 1 个或多个项目。如果可能，最好每个列表都缩小到数据量，但如果空间用完，则在每个 ListView 中显示滚动条。

我认为网格应该包含 ListView。有什么我想念的想法吗？

下面是一个非常简单的例子，它也没有这样做，我不知道为什么。

```
<Window x:Class="Test.ListTestWindow1"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:sys="clr-namespace:System;assembly=mscorlib"
    Title="ListTestWindow1" Height="400" Width="500">
<Grid>
    <Grid.RowDefinitions>
        <RowDefinition Height="Auto" />
        <RowDefinition Height="*" />
    </Grid.RowDefinitions>
    <Grid Grid.Row="0">
        <StackPanel Orientation="Vertical" HorizontalAlignment="Center">
            <Button Content="Some Stuff"/>
            <TextBlock Text="More Stuff" />
            <Button Content="Place holder"/>
        </StackPanel>
    </Grid>
    <Grid Grid.Row="1">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto" />
            <RowDefinition Height="Auto" />
            <RowDefinition Height="Auto" />
        </Grid.RowDefinitions>
        <Grid Grid.Row="0">
            <Grid.RowDefinitions>
                <RowDefinition Height="Auto" />
                <RowDefinition Height="Auto" />
            </Grid.RowDefinitions>
            <TextBlock Grid.Row="0" Text="List Header Group 1" />
            <ListView Grid.Row="1">
                <ListView.View>
                    <GridView>
                        <GridViewColumn Width="120" Header="Date" />
                        <GridViewColumn Width="120" Header="Day Of Week" DisplayMemberBinding="{Binding DayOfWeek}" />
                        <GridViewColumn Width="120" Header="Year" DisplayMemberBinding="{Binding Year}" />
                    </GridView>
                </ListView.View>
                <sys:DateTime>1/2/3</sys:DateTime>
                <sys:DateTime>4/5/6</sys:DateTime>
                <sys:DateTime>7/8/9</sys:DateTime>
                <sys:DateTime>10/11/12</sys:DateTime>
            </ListView>               
        </Grid>
        <Grid Grid.Row="1">
            <Grid.RowDefinitions>
                <RowDefinition Height="Auto" />
                <RowDefinition Height="Auto" />
            </Grid.RowDefinitions>
            <TextBlock Grid.Row="0" Text="List Header Group 2" />
            <ListView Grid.Row="1">
                <ListView.View>
                    <GridView>
                        <GridViewColumn Width="120" Header="Date" />
                        <GridViewColumn Width="120" Header="Day Of Week" DisplayMemberBinding="{Binding DayOfWeek}" />
                        <GridViewColumn Width="120" Header="Year" DisplayMemberBinding="{Binding Year}" />
                    </GridView>
                </ListView.View>
                <sys:DateTime>1/2/3</sys:DateTime>
                <sys:DateTime>4/5/6</sys:DateTime>
                <sys:DateTime>7/8/9</sys:DateTime>
                <sys:DateTime>10/11/12</sys:DateTime>
            </ListView>
        </Grid>
        <Grid Grid.Row="2">
            <Grid.RowDefinitions>
                <RowDefinition Height="Auto" />
                <RowDefinition Height="Auto" />
            </Grid.RowDefinitions>
            <TextBlock Grid.Row="0" Text="List Header Group 3" />
            <ListView Grid.Row="1">
                <ListView.View>
                    <GridView>
                        <GridViewColumn Width="120" Header="Date" />
                        <GridViewColumn Width="120" Header="Day Of Week" DisplayMemberBinding="{Binding DayOfWeek}" />
                        <GridViewColumn Width="120" Header="Year" DisplayMemberBinding="{Binding Year}" />
                    </GridView>
                </ListView.View>
                <sys:DateTime>1/2/3</sys:DateTime>
                <sys:DateTime>4/5/6</sys:DateTime>
                <sys:DateTime>7/8/9</sys:DateTime>
                <sys:DateTime>10/11/12</sys:DateTime>
            </ListView>
        </Grid>
    </Grid>
</Grid>
</Window> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-12T00:17:49.403

如果您将 RowDefinition 设置`Height`为`Auto`，那么它将扩展到尽可能多的位置以容纳行内的任何内容。因此，您需要`MaxHeight`在`RowDefinition`或其内容（内部网格）上进行设置，以限制它可以扩展的数量。

如果您事先知道 MaxHeight 可以将其设置为静态量，但更有可能您希望将其设置为其容器的百分比（例如，`Window`）。为此，您可以绑定到`ActualHeight`容器的属性。例如：

```
<Window x:Name="window" xmlns:clr="clr-namespace:System;assembly=mscorlib">
<Grid Name="grid">
    <Grid.Resources>
        <local:HeightConverter x:Key="HeightConverter" />
        <clr:Int32 x:Key="Rows">3</clr:Int32>
    </Grid.Resources>     
    <Grid.RowDefinitions>
        <RowDefinition Height="Auto" />
        <RowDefinition Height="Auto" />
        <RowDefinition Height="*" />
    </Grid.RowDefinitions>
    <Grid Grid.Row="0" MaxHeight="{Binding ElementName=window,Path=ActualHeight,Converter={StaticResource HeightConverter},ConverterParameter={StaticResource Rows}}">
        <!-- contents ... -->
    </Grid>
    <Grid Grid.Row="1" MaxHeight="{Binding ElementName=window,Path=ActualHeight,Converter={StaticResource HeightConverter},ConverterParameter={StaticResource Rows}}">
        <!-- contents ... -->
    </Grid>
    <Grid Grid.Row="2">
        <!-- contents ... -->
    </Grid>
</Grid>
</Window> 
```

这里我使用*了 "HeightConverter"*，它应该将容器的实际高度转换为您想要的高度（即，将其除以三）。（你也可以只使用一个固定的数量，`MaxHeight=100`如果这对你有用的话。）转换器应该是这样的：

```
public class HeightConverter : IValueConverter
{
    public object Convert(object value, Type targetType, object parameter, System.Globalization.CultureInfo culture)
    {
        double? containerHeight = (value as double?);
        int numberOfRows = (parameter as int?) ?? 1;
        var contentHeight = (containerHeight.Value / numberOfRows);
        return contentHeight;
    }

    public object ConvertBack(object value, Type targetType, object parameter, System.Globalization.CultureInfo culture)
    {
        throw new NotImplementedException();
    }
} 
```

![例子](../Images/8d63130278d544a7a933623eff33c343.png)

# javascript - JS，“对象”，这个和那个。来自 python 这真的让我很困惑。（双关语）

> ID：12379579
> 
> 赞同：1
> 
> 时间：2012-09-12T00:05:52.850
> 
> 标签：javascript, python, html, oop

这是我为学习 js 编写的图片库中的一些清理代码。我将画廊创建为一个对象，但在某些时候我忘记了“this”指向的内容。底部发生的事情对我来说没有意义（查看评论）。有人可以解释一下吗？

```
function Gallery(parentID)
{
        // ...
    this.showDiv = document.createElement("div");
        // ...
    this.show = function ()
        {
        document.body.appendChild(this.showDiv); //will be given css absolute position to "pop up"
        this.showDiv.innerHTML = '<img class="displayImage" src="' + this.picList[this.showIndex] + '">'; //fill with image
        this.showDiv.focus();
        this.showDiv.onclick = this.hide;
        }   

    this.hide = function ()
        {
        alert(this.innerHTML); // <= WHY DOES THIS SHOW THE INNERHTML CONTENTS OF this.showDiv??????
            //alert(this.showDiv.innerHTML); // <= shouldnt this be correct?
        this.parentNode.removeChild(this); //doesnt work
        }
} 
```

让我知道我是否清理了一些可能影响结果的代码并填写错误。

谢谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-12T00:08:17.143

```
 this.showDiv.onclick = this.hide; 
```

这条线是问题所在。它不像在 Python 中那样工作；`this.hide`不是绑定方法。它只是`hide`功能，不受任何特定`this`的 .

解决它的一种方法是：

```
 this.showDiv.onclick = this.hide.bind(this); 
```

但是`.bind()`函数的方法是一个相当新的标准；它不在所有旧浏览器中。所以你可能想自己动手：

```
function bindMethod(object, func) {
    return function () { return func.apply(object, arguments); };
}

this.showDiv.onclick = bindMethod(this, this.hide); 
```

（通常`this`在 JavaScript 中表现得有些奇怪；要记住的主要一点是，它`this`总是指最里面的函数`this`，它可以是调用者想要的任何东西。有时你会看到 JS 代码做一些事情，比如`var self = this;`给一个特定的函数起`this`一个名字可以在嵌套函数中使用；当然，在 Python 中，这只是事情自动工作的一种方式。）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-12T00:08:57.180

这指的是调用该函数的对象。因此，当您说时`this.showDiv.onclick`， showDiv 就是调用该函数的对象。因此`this.innerHTML`实际上意味着`this.showDiv.innerHTML`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-12T01:58:52.593

如果你坚持使用构造函数，而不是工厂，那么请`this`记住——

如果您有一个方法（或您作为方法调用的任何函数，而不是作为构造函数调用的任何函数），并且该方法引用`this`，则该语句将在***调用***函数时而不是在定义时`this`解析。

 *```
function sayName () { console.log(this.name); }

var bob = { name : "Bob" },
      doug = { name : "Doug" };

bob.greet = sayName;
doug.greet = sayName; 
```

在严格的基于类的语言中，这里会出现各种错误。

但是通过后期绑定的魔力（`this`在执行期间的最后一秒决定什么意思），它顺利进行。

然而，有一个障碍：函数内部的函数。你想`this`指向`this`外部方法的。它没有。在旧（当前）JS 中，它指向`window`. 在未来的 JS 中，它什么都没有。

```
function sayNameAndAge () {
   var outerThis = this,
         name = this.name;

   function sayAge () { console.log(outerThis.age); }

     console.log(name);
     sayAge();
 } 
```

假设 Bob 既有姓名又有年龄，现在，您可以像上次一样分配函数，它会起作用。该函数将看到它`bob`位于点的前面，因此是主题`this`（注意：不是它的工作原理，而是它看起来如何工作，一个函数的深度）。 `outerThis`将保存内部函数的引用以供使用。

另一种选择是：

```
sayNameAndAge.call(bob); 
```

`call`是函数具有的方法（我是否提到函数是对象），它允许您`this`为特定的执行指定，而不是给另一个对象一个方法（实际上是一个引用）。

`bind`像`call`_ `this`_ `bind`_

另一个主要参考点：当您使用事件侦听器时，`this`指向您放置侦听器的元素。

您可以委托侦听器（例如，将一个侦听器附加到一个侦听器`<ul>`，该侦听器侦听对其任何一个的任何点击`<li>`。在这种情况下，`this`将是`<ul>`，因为它是侦听器在触发时附加到的对象。

希望这能让事情变得更清楚一些。*

# google-chrome - 编辑 chrome 开发工具

> ID：12379580
> 
> 赞同：0
> 
> 时间：2012-09-12T00:05:57.733
> 
> 标签：google-chrome, google-chrome-extension, google-chrome-devtools

我一直在寻找有关如何将另一个侧边栏添加到源选项卡的指南。

我知道我们可以从 chromuim 项目下载 devtools_frontend 并对其进行编辑，但我想知道是否有人知道是否可以通过扩展

我发现了一堆用于向元素添加东西但没有用于源的东西。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-14T15:34:21.690

Chrome 提供了三个单独的 API 来扩展开发者工具 - [http://developer.chrome.com/trunk/extensions/devtools.html](http://developer.chrome.com/trunk/extensions/devtools.html) 和更多风险 - [http://developer.chrome.com/trunk/extensions/experimental.html](http://developer.chrome.com/trunk/extensions/experimental.html)

这是您向开发工具添加新选项卡/功能的方式。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-03-27T19:30:49.910

这个答案是在您提出问题多年之后，但您可能想查看GitHub 上的[jQuery Audit](https://github.com/zertosh/jquery-audit)插件。它将选项卡/侧边栏添加到源面板/选项卡。

# javascript - Rails：如何向用户预加载消息

> ID：12379581
> 
> 赞同：0
> 
> 时间：2012-09-12T00:06:08.103
> 
> 标签：javascript, ruby-on-rails

我有一个基于 Rails 的预启动站点，其中包含一些旋转的背景图像（这对于销售站点的想法很重要），加载时间过长，以至于用户在加载之前就离开了站点。他们唯一看到的是电子邮件提交框。

向用户显示网站将需要一些时间加载但然后在合理的时间段后让该消息消失的消息的好方法是什么。我猜测带有计时器的 jQuery fadeOut()，但我不确定将计时器设置多长时间，因为我不确定它什么时候开始计数。

有什么建议么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-12T03:35:38.800

我以前在我写的一个应用程序中不得不处理这样的情况，所以希望我的建议会有所帮助！我会：

1.  加载尽可能准系统的非常基本的 DOM 标记。准系统没有从外部加载任何资产，只有纯 html 标签和 css。这应该很快加载。有一个 div 包含某种消息，让用户知道图像正在加载（例如`<div class = 'loading_images'>loading...</div>`）
2.  既然你提到了 jQuery，我假设你可以访问它，否则你可以只使用标准的 Javascript。这里的想法是检索您尝试使用 AJAX 加载的图像，将图像插入到它们在检索后需要放入的任何 DOM 元素中，然后在完成后关闭加载消息。这样，您就不必担心设置计时器和猜测请求需要多长时间才能完成。请求完成后，您可以关闭加载消息并继续您的快乐方式。无论你在哪里包含你的 jQuery，把这样的东西放在 document.ready 处理程序中

```
$(文档).ready(函数(){

  var 请求 = $.ajax({
                        网址：url_to_your_image，
                        类型：“获取”，
                        成功：功能（数据）{
                                $(whatever_context_or_div_to_insert_your_image).html(数据)
                                $('.loading_images').hide()
                                }  
                      });
  })

```

此代码将等到 DOM 加载完毕，然后创建一个新的 AJAX 请求来检索您要插入到页面中的图像。如果图像加载成功，将使用图像（名为“数据”的变量）调用成功方法，然后将其插入到您想要的任何位置。最后，加载消息被隐藏，以便用户可以与页面及其内容进行完全交互。

这里有两件重要的事情需要注意：

*   就目前而言，如果请求失败（例如，图像没有通过 AJAX 成功加载），代码将不会做任何事情。有关如何处理这种情况，请参阅 $.ajax 和错误回调的 jQuery 文档。
*   上面代码片段的编写方式，只会加载一张图片。为了快速加载您拥有的许多图像，您可以在 for 循环中包含 AJAX 请求并以这种方式加载图像。虽然这不是一个好的做法，所以我建议您考虑创建一个图像精灵，通过 AJAX 仅检索该图像精灵，然后使用 CSS 将较小的图像从较大的图像中裁剪出来。

# php - PHP -> $_SERVER['REMOTE_ADDR' 和 Octects

> ID：12379584
> 
> 赞同：0
> 
> 时间：2012-09-12T00:06:29.187
> 
> 标签：php, ip

我想扩大我`$_SERVER['REMOTE_ADDR'`检查的 IP 范围。这有效：

```
$chk = "10.0.4.";
if( substr($_SERVER['REMOTE_ADDR'],0,strlen($chk)) !== $chk)
    $wgGroupPermissions['*']['read'] = false; 
```

以下为网站打开了世界：

```
$chk = "10.0.";
if( substr($_SERVER['REMOTE_ADDR'],0,strlen($chk)) !== $chk)
    $wgGroupPermissions['*']['read'] = false; 
```

我只想要我的本地子网 10.0。*.* 具有对该站点的读取权限。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-12T00:10:20.570

你在第二个中有一个额外的论点......

```
if (substr($_SERVER['REMOTE_ADDR'], 0, strlen($chk)) !== $chk) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-12T00:10:41.070

`,0`从第二行删除多余的：

```
if( substr($_SERVER['REMOTE_ADDR'],0,strlen($chk)) !== $chk) 
```

# url - 在 Web 服务器 (websphere) 上阻止 url

> ID：12379585
> 
> 赞同：0
> 
> 时间：2012-09-12T00:06:49.127
> 
> 标签：url, websphere, block

plugin-cfg.xml 文件具有允许服务器上所有 url 的记录： <Uri AffinityCookie="WS_JSESSIONID" AffinityURLIdentifier="jsessionid" Name="/web/*"/ %gt;

有什么方法可以阻止一个特定的 url 并让其余的保持打开状态？

就像是：

<Uri AffinityCookie="WS_JSESSIONID" AffinityURLIdentifier="jsessionid" Name="^/web/abc/xyz"/ > <Uri AffinityCookie="WS_JSESSIONID" AffinityURLIdentifier="jsessionid" Name="/web/*"/ >

或任何其他方式？提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-12T12:42:14.503

我几乎可以肯定，插件配置文件中没有办法做到这一点。该文件通常仅反映您可以通过管理控制台配置的内容，而该`Uri`元素仅反映 Web 应用程序的上下文根。因此，如果它支持任何一种强大、灵活的模式语法，我会感到非常惊讶。

另一方面，你也许能够以另一种方式完成你想要的。如果您在 WebSphere 前面有一个代理服务器，那么您可以通过这种方式“阻止”路径。或者使用 WebSphere 中的 Servlet 过滤器来返回 404 页面或您希望该特定 URL 返回的任何其他类型的响应。（包括仅根据 Host 标头有条件地返回该错误页面，如果那是您真正想要的。）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-16T01:45:10.250

您可以使用 mod_rewrite 和 [PT] 标志重写到与上下文根不匹配的 URL。如果您试图将其作为静态文件提供，您可能还必须添加别名以使新的假上下文根工作。

# nservicebus - NServiceBus 回复消息警告

> ID：12379586
> 
> 赞同：0
> 
> 时间：2012-09-12T00:07:20.077
> 
> 标签：nservicebus

我有一个使用 NServiceBus 的 ASP.Net WebAPI 应用程序。命令从应用程序发送到运行 NSB 主机的后端服务器。服务器负责与数据库的通信。

大多数命令都是即发即弃的。一个简单的 Bus.Send(...) 并立即释放 Web 客户端，因此操作可以异步发生。

例外是在数据库中创建新记录的命令。数据库负责生成新创建实体的 ID，我需要将其返回给调用者。这性能较差，因为调用者必须留下来，但在我的情况下这是可以接受的。

我成功地为此使用了 Bus.Reply() 功能，如全双工示例中所述。我正在回复一条消息，其中包含新生成的 ID 的单个属性。在 Web 端，我使用任务延续注册了回调（利用 WebAPI 的异步能力），并在 Bus.Send() 之后使用 .Register。

这一切都很好。它以一种非常直接和简单的方式完成了我想要的。唯一的问题是每次客户端收到响应消息时，都会记录如下警告：

```
2012-09-11 16:46:44,745 [Worker.26] WARN  NServiceBus.Unicast.Transport.Transactional.TransactionalTransport [(null)] - Failed raising 'transport message received' event for message with ID=1faee572-f904-4b09-b1d5-c0bd7c12738d\82936
System.InvalidOperationException: No handlers could be found for message type: MyProject.Messages.MyEntityCreatedResponseMessage
   at NServiceBus.Unicast.UnicastBus.HandleTransportMessage(IBuilder childBuilder, TransportMessage msg)
   at NServiceBus.Unicast.UnicastBus.TransportMessageReceived(Object sender, TransportMessageReceivedEventArgs e)
   at System.EventHandler`1.Invoke(Object sender, TEventArgs e)
   at NServiceBus.Unicast.Transport.Transactional.TransactionalTransport.OnTransportMessageReceived(TransportMessage msg) 
```

我怎样才能摆脱这个警告？我在这里不需要消息处理程序。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-12T00:37:26.517

我建议在服务器甚至客户端（浏览器）上创建 id。这样，您的消息仍然可以是即发即弃的，并且您不需要同步任何内容。

如果您想保留数据库驱动的 id，NServiceBus 只会增加开销。不妨从您的网站代码直接与数据库对话，并在那里添加重试。

# ruby-on-rails - 回形针：找不到“应用程序/javascript”的处理程序

> ID：12379588
> 
> 赞同：0
> 
> 时间：2012-09-12T00:07:24.293
> 
> 标签：ruby-on-rails, ruby-on-rails-3, paperclip

我正在尝试使用回形针上传 javascript 文件并获取

```
No handler found for "application/javascript"
.../paperclip-3.2.0/lib/paperclip/io_adapters/registry.rb:19:in `handler_for'
.../paperclip-3.2.0/lib/paperclip/io_adapters/registry.rb:29:in `for'
.../paperclip-3.2.0/lib/paperclip/attachment.rb:91:in `assign'
.../paperclip-3.2.0/lib/paperclip.rb:196:in `block in has_attached_file' 
```

我将其用作模板系统的一部分。作为我的seed.rb的一部分（所以我不是通过表单上传）我遍历目录中的文件，为每个文件创建一个新的Javascript对象，设置'path'，'extension'和'body'然后回调在验证之前设置名为“source”的回形针附件，并在保存后设置另一个名为“preview”的附件。错误发生`compile_preview`在`self.preview = file`

模型/javascript.rb

```
has_attached_file :source,
                :default_style => :original,
                :path => ":rails_root/tmp/:configured_path",
                :url => ":configured_url",
                :default_url   => "/assets/missing.gif",
                :use_timestamp => false,
                :storage => :filesystem

before_validation :set_source
before_post_process { false }
after_save :compile_preview

validates :body,          :presence => true,
                          :length   => { :maximum => 500.kilobytes }
validates :path,          :presence => true
validates :format,        :presence => true,
                          :inclusion => ["js"]
validates :handler,       :presence => true,
                          :inclusion => ["coffee", "js"]

def set_source
  file = StringIO.new(self.body)
  file.class.class_eval { attr_accessor :original_filename, :content_type }
  file.original_filename = "#{File.basename(self.path)}.#{self.extension}"
  file.content_type = "application/javascript"
  self.source = file
end

def compile_preview
  file = StringIO.new(self.render)
  file.class.class_eval { attr_accessor :original_filename, :content_type }
  file.original_filename = self.source_file_name
  file.content_type = self.source_content_type
  self.preview = file
  self.save
end 
```

我知道这 99% 都有效，因为我已经将它与另一个模型一起使用，但它只是导致问题的“应用程序/javascript”。我也尝试过“text/plain”和旧的“text/javascript”mime 类型，但得到了同样的错误。

我之前没有看到任何人以这种方式与处理程序有问题，而回形针也没有提到它。

我正在使用 Rails 3.2.8 和 Paperclip 3.2.0

我的`handler`属性可能与回形针冲突吗？

有没有人知道我在哪里出错了？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-12T01:00:46.740

原来我只需要休息一下，用新的眼光看它。

我缩短了上面的代码以更好地解释它，但这是我实际拥有的：

```
def rendered_source_file
  file = StringIO.new(self.render)   
  file.class.class_eval { attr_accessor :original_filename, :content_type }
  file.original_filename = self.source_file_name
  file.content_type = self.source_content_type
end

def compile_preview
  self.preview = rendered_source_file
  self.save
end 
```

问题是，我不`rendered_source_file`应该回来。`file``file.content_type`

所以应该是：

```
def rendered_source_file
  file = StringIO.new(self.render)   
  file.class.class_eval { attr_accessor :original_filename, :content_type }
  file.original_filename = self.source_file_name
  file.content_type = self.source_content_type
  file
end

def compile_preview
  self.preview = rendered_source_file
  self.save
end 
```

# android - 我的平板电脑将不再使用 eclipse 从 USB 电缆加载和运行程序

> ID：12379593
> 
> 赞同：0
> 
> 时间：2012-09-12T00:08:20.710
> 
> 标签：android

我无法再通过 USB 电缆连接的 Eclipse 在我的平板电脑上运行任何程序。它一直在说

> 警告：Activity 没有启动，它的当前任务已经被放到了前面

这以前发生过，我会关闭我的平板电脑重新打开它，它会正常工作。完整的日志：

```
[2012-09-11 20:03:42 - TellaFortune] adb is running normally.
[2012-09-11 20:03:42 - TellaFortune] Performing besttecksolutions.tellafortune.TellaFortuneActivity activity launch
[2012-09-11 20:03:48 - TellaFortune] Application already deployed. No need to reinstall.
[2012-09-11 20:03:48 - TellaFortune] Starting activity besttecksolutions.tellafortune.TellaFortuneActivity on device emulator-5554
[2012-09-11 20:03:49 - TellaFortune] ActivityManager: Starting: Intent { act=android.intent.action.MAIN cat=[android.intent.category.LAUNCHER] cmp=besttecksolutions.tellafortune/.TellaFortuneActivity }
[2012-09-11 20:03:49 - TellaFortune] ActivityManager: Warning: Activity not started, its current task has been brought to the front 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-12T00:24:08.920

这意味着您尚未编辑应用程序本身或在应用程序后台运行的服务。Eclipse 不会重新安装与模拟器或设备上已安装的应用程序相同的已安装应用程序。要解决此问题，请编辑应用程序的任何部分。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-12T00:26:34.073

只需编辑任何文件，然后使用 Eclipse 保存并运行应用程序。可以在[此处找到重复的答案](https://stackoverflow.com/a/9232430/1076574)

# objective-c - RestKit：在 didLoadObjects 中了解请求是 POST 还是 PUT

> ID：12379594
> 
> 赞同：0
> 
> 时间：2012-09-12T00:08:28.373
> 
> 标签：objective-c, ios, restkit

有没有办法`- (void)objectLoader:(RKObjectLoader*)objectLoader didLoadObjects:(NSArray*)objects`判断我对服务器的请求是 POST 还是 PUT？

我需要根据使用的 HTTP 动词做出不同的响应。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-12T03:55:42.423

您应该能够通过使用以下命令检查 RKRequest 对象来获得它：

```
- (void)objectLoader:(RKObjectLoader*)objectLoader didLoadObjects:(NSArray*)objects{

    RKRequest *request = [objectLoader.response request];
    NSLog(@"Got %@ method",[request method]);

} 
```

[您可以查看此链接](http://restkit.org/api/master/Classes/RKRequest.html#//api/name/method)获取更多信息

# postgresql - 当开始时间戳的小时小于结束时间戳的小时时检索查询

> ID：12379598
> 
> 赞同：1
> 
> 时间：2012-09-12T00:09:14.937
> 
> 标签：postgresql, datetime, timestamp, common-table-expression

我有一个基于 CTE 的查询，我在其中检索两个给定时间戳之间的用户请求总量，并显示两个日期之间每小时发出的请求数。我的查询工作如下：

1）获取开始和结束日期时间（假设 07-13-2011 10:21:09 和 07-31-2011 15:11:21）

2）检索给定时间戳的每小时 -1 小时间隔内的请求数量。（如果开始时间戳的小时是 10 小时，结束时间戳的小时是 15 如上所述，我应该显示 7 月 13 日至 31 日之间每天 10、11、12、13、14、15 小时的每小时请求量）

查询是这样的：

```
WITH cal AS (
    SELECT generate_series('2-2-2011 00:00:00'::timestamp , '1-4-2012 05:00:00'::timestamp , '1 hour'::interval) AS stamp
        )
, qqq AS (
        SELECT date_trunc('hour', calltime) AS stamp
        , count(*) AS zcount
        FROM mytable
    WHERE calltime >= '13-7-2011 10:21:09' 
          AND calltime <= '31-7-2011 15:11:21' AND calltime::time >= '10:00:00' AND
          calltime::time <= '15:59:59' AND date_part('hour', calltime) >= 8 AND 
          date_part('hour', calltime) <= 15
 GROUP BY date_trunc('hour', calltime)
)
SELECT cal.stamp
        , COALESCE (qqq.zcount, 0) AS zcount
FROM cal
LEFT JOIN qqq ON cal.stamp = qqq.stamp
WHERE cal.stamp >= '13-7-2011 10:00:00' AND cal.stamp <= '31-7-2011 15:11:21' 
       AND date_part('hour', cal.stamp) >= 10 AND 
       date_part('hour', cal.stamp) <= 15
ORDER BY stamp ASC; 
```

此查询显示 10 到 15 小时之间的请求量以每小时间隔显示（X 请求在 10:21:09 到 11:00 之间，Y 请求在 11:00 到 11:59 之间，Z 请求在 12:00 到 12 之间:59...，P 请求在 15:00 到 15:11:21 之间）从 7 月 13 日上午 10 点到下午 3 点开始到 7 月 31 日上午 10 点到下午 3 点结束的每一天

它适用于第一个时间戳的小时值小于第二个时间戳的小时值的输入——例如，在这里，第一个时间戳的小时为 10，第二个时间戳的小时为 15——但存在问题。当我想将其应用于诸如 07-13-2011 22:11:43 和 07-31-2011 04:06:04 之类的输入时，-这样我就可以得到每个小时 22 到 04 之间的请求量一天，我遇到了问题-由于我的查询结构，很可能-。我需要检索请求的总数，如下所示：

```
 stamp                 zcount
    "2011-07-13 22:00:00"  123
    "2011-07-13 23:00:00"  338
    "2011-07-14 00:00:00"  184
    "2011-07-13 01:00:00"  298
    "2011-07-13 02:00:00"  162
    "2011-07-13 03:00:00"  293
    "2011-07-14 04:00:00"  216
    "2011-07-14 22:00:00"  392
    "2011-07-14 23:00:00"  268
    "2011-07-15 00:00:00"  483
    "2011-07-15 01:00:00"  327
    "2011-07-15 02:00:00"  419
    "2011-07-15 03:00:00"  121
    "2011-07-15 04:00:00"  231
     .
     . 
    "2011-07-30 22:00:00"  392
    "2011-07-30 23:00:00"  268
    "2011-07-31 00:00:00"  483
    "2011-07-31 01:00:00"  327
    "2011-07-31 02:00:00"  419
    "2011-07-31 03:00:00"  544
    "2011-07-31 04:00:00"  231 
```

我需要在查询中更改什么以确保它适用于第二个时间戳的小时值小于第一个时间戳的小时值的情况 - 例如，第一个时间戳为 22，第二个时间戳为 4 -？我目前为此使用了一种解决方法，但它并不是很优雅，我想改变它。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-12T02:10:49.767

我会诚实的。我不确定我是否接近。

我把qqq中WHERE子句中的大部分东西都去掉了，因为在外层查询的where子句中重复了。我也切换到 ISO 时间戳，因为它们对我来说更容易阅读。

您可能希望将其重写为可以传递参数的函数。

```
WITH cal AS (
    SELECT generate_series('2011-02-02 00:00:00'::timestamp , 
                           '2012-04-01 05:00:00'::timestamp , 
                           '1 hour'::interval) AS stamp
),
qqq AS (
  SELECT date_trunc('hour', calltime) AS stamp, count(*) AS zcount
  FROM mytable
  WHERE calltime >= '2011-07-13 20:21:09' 
    AND calltime <= '2011-07-31 15:11:21'
 GROUP BY date_trunc('hour', calltime)
)
SELECT cal.stamp, COALESCE (qqq.zcount, 0) AS zcount
FROM cal
LEFT JOIN qqq ON cal.stamp = qqq.stamp
WHERE cal.stamp >= '2011-07-13 20:00:00' 
  AND cal.stamp <= '2011-07-31 15:11:21' 
  AND (
    extract ('hour' from cal.stamp) >= extract ('hour' from '2011-07-13 20:00:00'::timestamp) or
    extract ('hour' from cal.stamp) <= extract ('hour' from '2011-07-31 15:11:21'::timestamp) 
  )
ORDER BY stamp ASC; 
```

如果这里有什么神奇之处，它可能就在这个子句中。注意“或”的使用。

```
AND (
  extract ('hour' from cal.stamp) >= extract ('hour' from '2011-07-13 20:00:00'::timestamp) or
  extract ('hour' from cal.stamp) <= extract ('hour' from '2011-07-31 15:11:21'::timestamp) 
) 
```

# c# - C# 测试程序集

> ID：12379599
> 
> 赞同：2
> 
> 时间：2012-09-12T00:09:20.010
> 
> 标签：c#, unit-testing, testing, projects-and-solutions, solution

我是 C# 新手，并且在弄清楚测试程序集如何工作时遇到了特别困难。这是我的解决方案目录（里面有一个项目 MyProject）：

```
MySolution/MySolutionFile.sln     -- My Solution File
MySolution/packages               -- My Packages Directory
MySolution/MyProject/Properties   -- My Project Properties

MySolution/MyProject/src                    -- My Source Code
                    /src/MyClass1.cs
                    /src/MyClass2.cs

MySolution/MyProject/test                   -- My NUnit Tests
                    /test/MyClass1Test.cs
                    /test/MyClass2Test.cs

MySolution/MyProject/TheMainClass.cs 
```

现在我可以从 Visual Studio 运行测试文件夹中的所有测试。但是我想从像 TeamCity 这样的 CI 系统运行测试，在这种情况下我需要一个组装路径。如何仅将测试文件夹生成到要运行的程序集中。

我是否需要在主类中添加一个运行 MySolution/test 文件夹中每个测试的方法？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-12T00:17:00.533

我认为您需要阅读有关项目和解决方案的信息：http: [//msdn.microsoft.com/en-us/library/ee817674.aspx](http://msdn.microsoft.com/en-us/library/ee817674.aspx)

在那之后，一切都变得更加清晰：拥有一个解决方案，在该解决方案内部为您的应用程序创建一个项目，并为您的单元测试创​​建一个项目。在测试项目中添加对您选择的测试框架的引用和对您的应用程序项目的引用。

这样，您的应用程序就不会知道您的测试并编译到一个程序集中。同时，您的测试依赖于您的应用程序，但编译成另一个程序集，可以由您的测试运行程序 GUI/CI 或您使用的任何其他程序使用。

为了回答您的下一个问题，对于测试项目，您需要选择“库”的项目类型（如果您愿意，控制台应用程序也可以工作）

# css - 使用 :after 没有内容和宽度限制

> ID：12379605
> 
> 赞同：2
> 
> 时间：2012-09-12T00:10:18.370
> 
> 标签：css

这是我的代码：

```
<ul>
    <li><a href="#">link</a></li>
    <li><a href="#">link 2</a></li>
</ul> 
```

菜单是垂直的并且`ul`具有特定的宽度。

我想做的是接下来的事情：

```
------ ul width 300px ------
[link][image repeat........]
[link 2][image repeat .....] 
```

![在此处输入图像描述](../Images/c37eb9d4c9174697a44b8032568976a3.png)

*   图像宽度和`repeat-x`文本高度`ul``repeat-y`

我尝试使用`a:after`，但如果没有为您提供特定宽度的文本/图像内容，您将无法使用它。我的图像只有 3px 宽度，因此它会显示一次并显示它。我该怎么做才能显示图像直到`ul`宽度结束（`a:after`当然使用）？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-12T04:00:04.210

可用性方面，固定宽度的链接列表（右侧有重复的图案填充）应该可以点击该行项目的整个宽度，包括图案填充。但是，既然您在使用上似乎很任性`:after`，那么这个[Fiddle](http://jsfiddle.net/scrimothy/UVMBh/)怎么样？

您必须在`content`属性中添加一个字符，以便那里有一些东西有背景。不幸的是，由于某种原因，我无法使`content: '\0020';`（编码空间）工作，所以我使用了一些非常温和的东西，然后将颜色设置为透明`rgba(0,0,0,0)`。并非所有浏览器都支持 rgba，但有一些资源可以解决这个问题。如果您不使用该路线，您可能只需将竖线 (|) 字符（因为它与图案图像的左边缘对齐）设置为图案的主要颜色。就我而言，我可以将其设置为图像中的深灰色。

无论如何，这应该足以解决您的问题。如果没有，请告诉我。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-05-28T12:39:10.367

`content: "\00a0";`强制你的css样式出现在`:after`:-)

# dblink - 通过 dblink 执行其他用户创建的存储过程

> ID：12379607
> 
> 赞同：1
> 
> 时间：2012-09-12T00:10:20.760
> 
> 标签：dblink

我已经使用用户**USERA**在数据库**A中创建了一个存储过程****PROCA** ，并授予 USERB 执行权限，当使用**USERB**登录时，我可以在数据库 A 中执行这个存储过程。

 ******现在我登录到数据库**X**并创建了一个 dblink **Akink**，这个 dblink 使用用户 USERB 连接到数据库 A。现在，当我使用以下语法执行存储过程时，它被执行而没有任何错误，但是存储过程所做的任何 DML 操作都没有提交。

**从 Databse X 调用存储过程的代码**

```
declare

begin

   USERA.PROCA@Alink();

   COMMIT;

end; 
```

请提出可能是什么问题。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-07-17T14:24:55.047

对于这种情况，似乎没有好的解决方案。
但这里有一个建议给你；尝试使用这个：

```
Exec dbms_utility.exec_ddl_statement@db_link('some ddl sql statment'); 
```

例如：

```
Exec dbms_utility.exec_ddl_statement@db_link('truncate table test_tab'); 
```******

# java - 如何从 Java 中的 LinkedHashSet 中获取一个元素？

> ID：12379608
> 
> 赞同：8
> 
> 时间：2012-09-12T00:10:25.010
> 
> 标签：java, iterator, linkedhashset

我正在寻找将给定集合划分为不相交子集的代码。例如，一组足球运动员，我们根据他们所属的球队对他们进行划分。最后我想要一份代表名单，即每支球队的一名球员。

所有足球运动员都认识他们球队中的所有其他球员——这与复杂性非常相关。所以，我目前关于如何做到这一点的想法如下（`set`目前在哪里 a `LinkedHashSet<T>`）：

```
while (!set.isEmpty()) {
    E e = set.iterator().next();
    makeRepresentative(e);
    set.remove(AllPlayersOnSameTeamAs(e));
} 
```

然而，在 while 循环的每一步都构建一个新的迭代器感觉很奇怪。LinkedHashSet 应该在内部具有某种`firstElement()`功能（对于它的 LinkedList 行为），但由于某种原因，我找不到如何做到这一点。我也尝试了一个 foreach 循环，但这导致了`java.util.ConcurrentModificationException`.

我应该如何正确地做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-12T00:18:21.080

```
while (!set.isEmpty()) {    
    Collection<E> toBeRemoved = new ArrayList<E>();
    E first = set.iterator().next();
    doSomethingWith(e);
    for (E e : set) {
        if (similar(first, e)) toBeRemoved.add(e);
    }
    set.removeAll(toBeRemoved);
} 
```

在阅读您的编辑并更好地理解之后，您可能会喜欢以下解决方案：

```
Collection<E> processed = new ArrayList<E>();
for (E e1 : set) {
    boolean similar = false;
    for (E e2 : processed) {
        if (similar(e1, e2)) similar = true;
    }
    if (!similar) {
        doSomethingWith(e1);
        processed.add(e1);
    }
}
set.clear(); 
```

请注意，在不了解“相似”定义的情况下，这个问题本质上是二次问题。可以使它成为线性或次二次的唯一方法是，是否有一种方法可以将相似元素散列到相同的键。在这种情况下，您可以使用上面的第二种策略，但修改`processed`结构和检查先前相似元素的部分以提高效率（目前该步骤与相似组的数量呈线性关系，而在总元素中可能是线性的） .

此外，任何亚二次方肯定会使用比常量内存更多的东西。如果你想要恒定的记忆，这是你能做的最好的事情（这绝对是二次时间）：

```
while (!set.isEmpty()) {
    Iterator<E> iter = set.iterator();
    E first = iter.next();
    doSomethingWith(first);
    while (iter.hasNext()) {
        if (similar(first, iter.next())) iter.remove();
    }
} 
```

请注意，使用 iter.remove() 可以解决您之前遇到的并发修改问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-03-12T04:07:26.037

我会一次性完成，跟踪我见过的团队。

```
Set<Team> processedTeams = new HashSet<>();
Set<Players> representatives = new HashSet<>();
for(e:players) {
  Team t = e.getTeam();
  if(processedTeams.contains(t))
    continue;
  processedTeams.add(t);
  representatives.add(e)
} 
```

# excel - 如何使用 VBA 从 Excel 用户窗体中读取复选框的值

> ID：12379613
> 
> 赞同：3
> 
> 时间：2012-09-12T00:11:26.527
> 
> 标签：excel, vba, checkbox, userform

我创建了一个包含两个复选框的用户表单。我希望能够根据每个框是选中还是未选中来做不同的事情。但是，似乎无论我做什么，它总是会告诉我复选框的原始值（false 和 false）。这是附加到单击 CommandButton1 的代码：

```
Private Sub CommandButton1_Click()

ReadData

End Sub 
```

在这里ReadData：

```
Sub ReadData()

Dim myForm As UserForm
Set myForm = UserForms.Add("ComplaintEntryForm")

Debug.Print (myForm!CheckBox1.Name)
Debug.Print (myForm!CheckBox1.Value)
Debug.Print (myForm!CheckBox2.Name)
Debug.Print (myForm!CheckBox2.Value)

End Sub 
```

无论这些框是如何被选中的，即时窗口总是显示如下：

```
VBA.UserForms.Add("ComplaintEntryForm").Show
CheckBox1
False
CheckBox2
False 
```

我有整个操作的截图，但它不会让我上传它，因为我是一个新用户。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-12T00:52:12.470

试试这个方法来加载和显示表单（这在一个普通的模块中）：

```
Sub main()

Dim myForm As ComplaintEntryForm

Set myForm = New ComplaintEntryForm
myForm.Show
Set myForm = Nothing

End Sub 
```

在 UserForm 自己的模块中，添加以下内容：

```
Private Sub CheckBox1_Change()

readData

End Sub

Private Sub CheckBox2_Change()

readData

End Sub

Private Sub UserForm_Initialize()

Me.CheckBox1.Value = True
Me.CheckBox2.Value = False

End Sub

Private Sub readData()

Debug.Print Me.CheckBox1.Name
Debug.Print Me.CheckBox1.Value
Debug.Print Me.CheckBox2.Name
Debug.Print Me.CheckBox2.Value

End Sub 
```

我已将两个复选框初始化为`Initialize`事件中的特定值。这意味着我们可以确定表单开始的状态

# javascript - 用链接替换 url 但增加了难度

> ID：12379616
> 
> 赞同：0
> 
> 时间：2012-09-12T00:12:26.807
> 
> 标签：javascript, jquery, url, hyperlink

在一个可编辑的 iframe 中，由于这个正则表达式，我用链接替换了普通的 url：

```
function linkify(text) {
    var regex = /(http|https|ftp)\:\/\/[a-zA-Z0-9\-\.]+\.[a-zA-Z]{2,3}(:[a-zA-Z0-9]*)?\/?([a-zA-Z0-9\-\._\?\,\'\/\\\+&amp;%\$#\=~])*/g;
    return text.replace(regex,"<a href='$&'>$&</a>");
}

var content = linkify($('.div').html()); 
```

当我尝试“链接”包含链接的字符串时，我的问题出现了，它会创建一个像这样的怪物：

```
<a href="&lt;a href='http://google.com'&gt;http://google.com&lt;/a&gt;"></a><a href="http://google.com">http://google.com</a> 
```

我认为如果我遍历 DOM 而不是分析 html 字符串，则可以解决这个问题，但在尝试之前，我想在这里询问是否有人有任何想法。

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-07-27T15:07:09.643

我有一个类似的问题，并通过首先剥离 html 标签来解决它：

```
function strip_tags(str, allow) {
allow = (((allow || "") + "").toLowerCase().match(/<[a-z][a-z0-9]*>/g) || []).join('');

var tags = /<\/?([a-z][a-z0-9]*)\b[^>]*>/gi;
var commentsAndPhpTags = /<!--[\s\S]*?-->|<\?(?:php)?[\s\S]*?\?>/gi;
return str.replace(commentsAndPhpTags, '').replace(tags, function ($0, $1) {
return allow.indexOf('<' + $1.toLowerCase() + '>') > -1 ? $0 : '';
});
} 
```

然后运行 ​​urlify 函数：

```
function urlify(text) {
var exp = /(\b(http):\/\/[-A-Z0-9+&@#\/%?=~_|!:,.;]*[-A-Z0-9+&@#\/%=~_|])/ig;
    return text.replace(exp,"<a href='$1'>$1</a>");
} 
```

看看我的小提琴试试看：http: [//jsfiddle.net/gerbenzomp/UJMeR/3/](http://jsfiddle.net/gerbenzomp/UJMeR/3/)

# java - 如何使用 ProcessBuilder 在 Java 中使用空格启动快捷方式

> ID：12379617
> 
> 赞同：2
> 
> 时间：2012-09-12T00:12:27.247
> 
> 标签：java, execute, processbuilder, desktop-shortcut

这是我通常用来执行快捷方式文件 (.lnk) 的代码

```
 //Get Directory
  String currentDir = new File(game.getGamePath()).getCanonicalPath();

  //Parse Directory to put apostrophes around shortcut name    
  currentDir = currentDir.substring(0, currentDir.lastIndexOf("\\") + 1) + '"' +                      
  currentDir.substring(currentDir.lastIndexOf("\\") + 1, currentDir.length()) + '"';

  //prep the launcher
  ProcessBuilder processBuild = new ProcessBuilder();
  processBuild.command("cmd", "/c", "start" ,"/wait", "", currentDir);

  //launch 
  Process = processBuild.start();
  try {
       Process.waitFor();
  } catch (InterruptedException ex) {

  } 
```

问题是当快捷方式文件名有空格时，我从 Windows 收到一个错误，说它无法加载 [WordAfterSpace.ink]

例如说我有一个值为 [Desktop\A B.lnk] 的 currentDir

解析为 [Desktop\"A B.ink"] ，这在命令提示符下完美运行。

问题是如果我使用上面的代码我会得到这个错误：

> Windows 找不到“B.ink”，请确保您输入的名称正确，然后重试

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-12T00:28:08.050

使用 \" 在字符串中获取双引号 此外，请从头开始引用整个链接，而不是仅引用链接名称，因为它之前可能有其他空格。这将使您免于麻烦。

# iphone - 无法通过 iPhone 上的 Wifi 连接获取位置

> ID：12379624
> 
> 赞同：1
> 
> 时间：2012-09-12T00:13:03.953
> 
> 标签：iphone, gps, location, wifi, locationmanager

我正在尝试编写一个应用程序，该应用程序将为公共交通应用程序获取用户位置，当我在地上时效果很好。当我在地下时，即使我有 wifi 和/或手机信号，位置也不会更新。下面是我正在使用的代码。据我了解，iPhone 只能从 wifi 信号中获取位置，这是不正确的吗？任何帮助将不胜感激，在此先感谢您！

```
- (void)viewDidLoad
{
    [super viewDidLoad];

    //********************** Add map ******************************************

    //setup location manager
    locationManager = [[CLLocationManager alloc] init];
    [locationManager setDelegate:self];
    [locationManager setDistanceFilter:kCLDistanceFilterNone];
    [locationManager setDesiredAccuracy:kCLLocationAccuracyHundredMeters];

    //setup map view
    mapView = [[MKMapView alloc] initWithFrame:CGRectMake(0.0f, 0.0f, 320.0f, 160.0f)];
    mapView.showsUserLocation = YES;
    mapView.userTrackingMode = MKUserTrackingModeFollow;

    //run loop in background
    loopTimer = [[NSTimer scheduledTimerWithTimeInterval:timeInterval target:self selector:@selector(tick:) userInfo:nil repeats:YES]retain];

}

// Search for n seconds to get the best location during that time
- (void) tick: (NSTimer *) timer
{
    // Check for valid coordinate
    CLLocationCoordinate2D coord = mapView.userLocation.location.coordinate;
if (!coord.latitude && !coord.longitude) return;

    //get coordinates to update map
    [mapView setRegion:MKCoordinateRegionMake(coord, MKCoordinateSpanMake(0.005f, 0.005f)) animated:NO];

    //update current location in view
    currentLatView.text = [NSString stringWithFormat:@"%.2f", coord.latitude];
    currentLonView.text = [NSString stringWithFormat:@"%.1f", coord.longitude];

} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-12T08:20:45.497

您在 viewDidLoad 中设置的 locationManager 是您的 CL 位置管理器实例，而 MapKit 在您将 showsUserLocation 设置为 true 时使用它自己的实例。

因此，MapKit 没有使用距离过滤器和所需精度的设置，并且无论如何，您还没有使用 startUpdatingLocation 启动位置管理器。

因此，尝试启动您的位置管理器实例，然后使用委托方法

locationManager:(CLLocationManager *)manager didUpdateToLocation:

了解您的位置经理所说的内容。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-12T18:40:03.747

这是我想出的，似乎运行良好需要更多测试。

```
- (void)viewDidLoad
{
    [super viewDidLoad];

    //********************** Add map ******************************************

    // Create the manager object
    self.locationManager = [[[CLLocationManager alloc] init] autorelease];
    locationManager.delegate = self;

    // This is the most important property to set for the manager. It ultimately determines how the manager will
    // attempt to acquire location and thus, the amount of power that will be consumed.
    locationManager.desiredAccuracy = kCLLocationAccuracyHundredMeters;

    // When "tracking" the user, the distance filter can be used to control the frequency with which location measurements
    // are delivered by the manager. If the change in distance is less than the filter, a location will not be delivered.
    locationManager.distanceFilter = kCLLocationAccuracyBest;

    // Once configured, the location manager must be "started".
    [locationManager startUpdatingLocation];

    //initialize newCoord
    currentCoord = [[CLLocation alloc] initWithLatitude:0 longitude:0];

    //setup map view
    mapView = [[MKMapView alloc] initWithFrame:CGRectMake(0.0f, 0.0f, 320.0f, 160.0f)];
    mapView.showsUserLocation = YES;
    mapView.userTrackingMode = MKUserTrackingModeFollow;

    //create map view
    [self.view addSubview:mapView];

}

- (void)locationManager:(CLLocationManager *)manager didUpdateToLocation:(CLLocation *)newLocation fromLocation:(CLLocation *)oldLocation
{
    // test that the horizontal accuracy does not indicate an invalid measurement
    if (newLocation.horizontalAccuracy < 0) return;

    // test the age of the location measurement to determine if the measurement is cached
    // in most cases you will not want to rely on cached measurements
    NSTimeInterval locationAge = -[newLocation.timestamp timeIntervalSinceNow];
    if (locationAge > 5.0) return;

    // store all of the measurements, just so we can see what kind of data we might receive
    currentCoord = newLocation;

    [self tick];
}

- (void)locationManager:(CLLocationManager *)manager didFailWithError:(NSError *)error
{
    // The location "unknown" error simply means the manager is currently unable to get the location.
    if ([error code] != kCLErrorLocationUnknown) {
        [self stopUpdatingLocation:NSLocalizedString(@"Error", @"Error")];
    }
}

- (void)stopUpdatingLocation:(NSString *)state
{
    [locationManager stopUpdatingLocation];
    locationManager.delegate = nil;
}

- (void) tick
{
    //do stuff here
} 
```

# java - 无法编译 servlet 文件。

> ID：12379628
> 
> 赞同：0
> 
> 时间：2012-09-12T00:13:56.870
> 
> 标签：java, servlets, servlet-3.0

我正在测试一个演示 servlet 文件但是，servlet 似乎没有响应。我无法理解这个问题。

当我在 HTML 表单上单击提交时，URL 是 localhost:8080/Beer-V1/SelectBeer.do

但是，不应该是 /BeerSelect 吗？因为@WebServlet("/BeerSelect") ？？？

**web.xml**

```
 <?xml version="1.0" encoding="UTF-8"?>
 <web-app xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"  
  xmlns="http://java.sun.com/xml/ns/javaee" 
 xmlns:web="http://java.sun.com/xml/ns/javaee/web-   app_2_5.xsd" 
 xsi:schemaLocation="http://java.sun.com/xml/ns/javaee    
 http://java.sun.com/xml/ns/javaee/web-app_3_0.xsd" metadata-complete="false" 
version="3.0">

 <servlet>
<servlet-name>CH3 Beer</servlet-name>
<servlet-class>com.example.web.BeerSelect</servlet-class>
</servlet>
<servlet-mapping>
<servlet-name>CH3 Beer</servlet-name>
<url-pattern>/SelectBeer.do</url-pattern>
</servlet-mapping>
</web-app> 
```

**BeerSelect.java**

```
package com.example.web;

import java.io.IOException;
import java.io.PrintWriter;

import javax.servlet.ServletException;
import javax.servlet.annotation.WebServlet;
import javax.servlet.http.HttpServlet;
import javax.servlet.http.HttpServletRequest;
import javax.servlet.http.HttpServletResponse;

@WebServlet("/BeerSelect")
public class BeerSelect extends HttpServlet {
private static final long serialVersionUID = 1L;

public BeerSelect() {
    super();
}

@Override
protected void doPost(HttpServletRequest request,
        HttpServletResponse response) throws ServletException, IOException {

    response.setContentType("text/html");
    PrintWriter out = response.getWriter();
    out.println("Beer Selection Advice<br>");

    String c = request.getParameter("color");
    out.println("<br> Got Beer Color " + c);

} 
```

}

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-12T00:17:27.853

> 当我在 HTML 表单上单击提交时，URL 是 localhost:8080/Beer-V1/SelectBeer.do
> 
> 但是，不应该是 /BeerSelect 吗？因为@WebServlet("/BeerSelect") ？？？

1.  web-container 为每个部署的 web 应用程序关联一个“上下文路径”，在您的情况下，我相信它是“Beer-V1”。

2.  您已经覆盖了 web.xml 中的映射，如下所示，因此您看到 *.do

    ```
    <servlet-mapping>
      <servlet-name>CH3 Beer</servlet-name>
      <url-pattern>/SelectBeer.do</url-pattern>
    </servlet-mapping> 
    ```

xml DD 会覆盖注释。

# c# - 选中复选框时访问动态创建的文本框值

> ID：12379633
> 
> 赞同：0
> 
> 时间：2012-09-12T00:14:33.727
> 
> 标签：c#, asp.net

我对 ASP.NET 生命周期事件有点困惑。选中时我有一个复选框，它将动态创建标签和文本框。这是在复选框 oncheckchanged 事件中完成的。我在复选框上启用了 Ajax，而没有完整的回发。

现在在新创建的文本框中，我正在输入值，当我单击保存按钮时，在按钮单击事件中它甚至找不到创建的控件。那么页面视图状态如何记住在复选框事件中创建的动态控件，然后在按钮保存事件中访问它的值呢？标记：

```
 <tr> <td> <asp:CheckBox ID="chkType" runat="server" Text="Medical Procedure" OnCheckedChanged="ChkMedicalProc_Clicked"></td></tr>

                <tr><td colspan="2">
                    <asp:PlaceHolder ID="dyna" EnableViewState="true" runat="server"></asp:PlaceHolder>
                </td></tr> 
```

checkchanged 事件中的代码：

```
TableRow tr = new TableRow();
            TableCell tc1 = new TableCell();
            TableCell tc2 = new TableCell();
            Label lbl = new Label();
            lbl.Text = string.Empty;
            lbl.Text = (_queryParam[i].Param_Name + " (" + _queryParam[i].Param_Type + ") (" + _queryParam[i].Param_Length + ")").ToString();
            lbl.Style.Add("font-size", "11px");
            lbl.Style.Add("font-family", "Arial");
            _txtBox = new TextBox();
            _txtBox.ID = ctrlId;
            _txtBox.CssClass = "textEntry";
            _txtBox.Text = string.Empty;
            _txtBox.Text = _queryParam[i].Param_Value;
            tc1.Style.Add("width", "21.8%");
            tc1.Controls.Add(lbl);
            tc2.Controls.Add(_txtBox);
            tr.Cells.Add(tc1);
            tr.Cells.Add(tc2);

            _tbl.Rows.Add(tr);

            this.Master.FindControl("pagecontent1").FindControl("dyna").Controls.Add(_tbl); 
```

保存按钮点击事件：

```
 for (int i = 0; i < box.Count; i++)
                                {
                                    TextBox boxValue= this.Page.Master.FindControl("pagecontent1").FindControl("dyna").FindControl("txtBoxParams-" + i) as TextBox;
                                   //I get object reference error on boxValue
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-12T00:32:54.670

动态控件在回发时会丢失，因此对于每个页面请求，您必须再次动态添加它们。

尽管对于您的示例，始终在页面上具有标签/文本框可能更容易，但将`asp:panel`其包含在您切换其`Visible`属性或通过 javascript 显示/隐藏它的位置中。

至于回发期间这些动态控件的值，如果您使用相同的 重新创建它们`ID`，asp.net 将使用视图状态信息自动将它们重新初始化为正确的输入值。

有关处理动态控件的更多信息，该网站似乎相当准确：[http ://www.4guysfromrolla.com/articles/081402-1.aspx](http://www.4guysfromrolla.com/articles/081402-1.aspx)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-12T00:49:57.213

使用以下递归函数，您将能够检索动态表中的任何控件

> 公共静态控制 DeepFindControl（控制 c，字符串 id）{
> 
> ```
>  if (c.ID == id)
>         {
>             return c;
>         }
>         if (c.HasControls())
>         {
>             Control temp;
>             foreach (var subcontrol in c.Controls)
>             {
>                 temp = DeepFindControl((Control)subcontrol, id);
>                 if (temp != null)
>                 {
>                     return temp;
>                 }
>             }
>         }
>         return null;
>     } 
> ```

要在找到控件后接收控件的值，您应该知道控件的名称，然后您将在另一个新创建的具有相同类型的控件中接收值...“转换从 DeepFindControl 返回的控件”
例如...

> 控件 C1 = DeepFindControl(DynamicTableName, ControlNAme);
> 文本框 _txtBox = (文本框)C1;

# javascript - FF 查看源代码 | 脚本以红色突出显示

> ID：12379635
> 
> 赞同：1
> 
> 时间：2012-09-12T00:15:30.193
> 
> 标签：javascript

FF14 在 vi​​ew->source 上突出显示我的脚本标记为红色

在我所有的标签中，就在这里：

```
<script type='text/javascript'> 
```

有什么不喜欢的吗？

谢谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-12T00:18:05.547

尝试将您的脚本放在 HTML 标记中。也许它不喜欢它自己在外面。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-12T00:19:05.863

SGML/HTML 只允许一个根元素。在 HTML 中，应该是`html`. 但是，您在元素关闭*后*`script`放置了元素。*`html`*

 *因此，元素出现在根元素之外是无效的。脚本标签应该出现在`head`或 中`body`。（它不应该阻止它工作，因为浏览器非常宽松，但它是无效的。）*

# python - 如何使用开发服务器使用 django 1.4 (django-skel setup) 在模板中正确设置图像

> ID：12379636
> 
> 赞同：0
> 
> 时间：2012-09-12T00:15:53.007
> 
> 标签：python, django, image, static-files

我正在尝试使用开发服务器为我的 Django 项目提供服务，该项目使用[django-skel 1.4设置。](http://django-skel.readthedocs.org/en/latest/layout/)我的网站按预期运行，但我的图片除外，它们没有提供。

**部分`templates/home.html`**

```
<img width="65px;" src="assets/img/pic.png" alt="" id="symbol" /> 
```

我猜我应该在这部分改变一些东西：`src="assets/img/pic.png"`. 我已经查看了 SO 线程并根据给定的答案进行了调整，但我无法使其工作。

那么如何在模板中正确设置图像呢？

其他相关信息：

**`settings.common.py`**

```
DJANGO_ROOT = dirname(dirname(abspath(__file__)))

MEDIA_ROOT = normpath(join(DJANGO_ROOT, 'media'))
MEDIA_URL = '/media/'

STATIC_ROOT = normpath(join(DJANGO_ROOT, 'static'))
STATIC_URL = '/static/'

STATICFILES_DIRS = (
    normpath(join(DJANGO_ROOT, 'assets')),
)

STATICFILES_FINDERS = (
    'django.contrib.staticfiles.finders.FileSystemFinder',
    'django.contrib.staticfiles.finders.AppDirectoriesFinder',
    'compressor.finders.CompressorFinder',
) 
```

**项目树**

```
.
├── apps
│   └── __init__.py
├── assets
│   ├── css
│   │   └── base.css
│   ├── img
│   │   └── pic.png
│   └── js
├── default.db
├── __init__.py
├── libs
│   ├── core
│   │   ├── admin.py
│   │   ├── __init__.py
│   │   ├── models.py
│   │   ├── views.py
│   │   └── views.pyc
│   └── __init__.py
├── settings
│   ├── common.py
│   ├── dev.py
│   ├── __init__.py
│   └── prod.py
├── templates
│   ├── 404.html
│   ├── 500.html
│   ├── home.html
│   └── install.html
└── urls.py 
```

顺便说一句：请不要使用 解决方案`if settings.DEBUG`，如果可能的话最好不需要适应`urls.py`。

## 编辑

**完成后的顶级目录树`collectstatic`**

```
.
├── fabfile.py
├── gunicorn.py.ini
├── manage.py
├── Procfile
├── project_name
│   ├── apps
│   │   └── __init__.py
│   ├── assets
│   │   ├── css
│   │   │   └── base.css
│   │   ├── img
│   │   │   └── pic.png
│   │   └── js
│   ├── default.db
│   ├── __init__.py
│   ├── libs
│   │   ├── core
│   │   │   ├── admin.py
│   │   │   ├── __init__.py
│   │   │   ├── models.py
│   │   │   └── views.py
│   │   └── __init__.py
│   ├── settings
│   │   ├── common.py
│   │   ├── dev.py
│   │   ├── __init__.py
│   │   └── prod.py
│   ├── static
│   │   │   └── js
│   │   ├── css
│   │   │   └── base.css
│   │   └── img
│   │       └── pic.png
│   ├── templates
│   │   ├── 404.html
│   │   ├── 500.html
│   │   ├── home.html
│   │   └── install.html
│   └── urls.py
├── README.md
├── reqs
│   ├── common.txt
│   ├── dev.txt
│   └── prod.txt
├── requirements.txt
└── wsgi.py 
```

## 编辑 2

我理解 Django 如何读取路径：让`src="static/img/pic.png"`，来自我的`settings.common.py`：

```
>>> DJANGO_ROOT
'/home/my_username/web/my_project/my_project'
>>> j = os.path.join(DJANGO_ROOT, 'static/')
>>> print j
/home/my_username/web/my_project/my_project/static 
```

但

```
>>> STATIC_URL
'/static/'
>>> j = os.path.join(DJANGO_ROOT, STATIC_URL)
>>> print j
/static/ 
```

所以 Django 可能会在某个地方这样做`os.path.join`，这是我能想到为什么 `src="static/img/pic.png"`有效但`src="{{STATIC_URL}}img/pic.png"`无效的唯一原因。但是，为什么这显然对其他人有效，但对我无效？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-12T00:18:14.340

我认为您*必须*将以下内容添加到`urls.py`

```
(r'^media/(?P<path>.*)$', 'django.views.static.serve', {
        'document_root': settings.MEDIA_ROOT,
    }), 
```

至少我总是这样做的......

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-12T07:23:35.780

您需要添加

```
TEMPLATE_CONTEXT_PROCESSORS = (
    ...
    'django.core.context_processors.static',
) 
```

并添加`staticfiles`到您的`INSTALLED_APPS`

你需要修改你的`img`标签

```
<img width="65px;" src="{{STATIC_URL}}assets/img/pic.png" alt="" id="symbol" /> 
```

如果是用户上传的内容，则替换`{{STATIC_URL}}`为`{{MEDIA_URL}}`

另请参阅相关[的 Django 找不到我的媒体文件（在开发服务器上）](https://stackoverflow.com/questions/9168187/django-cannot-find-my-media-files-on-development-server/9168404#9168404)

# python - Django 社交认证 GitHub 认证

> ID：12379637
> 
> 赞同：4
> 
> 时间：2012-09-12T00:15:58.993
> 
> 标签：python, django, github, django-socialauth

我是 Python 和 Django 的新手，我正在尝试让社交身份验证（[https://github.com/omab/django-social-auth](https://github.com/omab/django-social-auth)）工作。我想使用 Github 进行连接，但没有取得多大成功，而且提供的示例对于刚开始的人来说有点压倒性。是否有任何最近可用的教程来解释如何使用最新版本的社交身份验证来为初学者设置 GitHub 身份验证？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-09-12T07:21:18.807

您是否阅读过[此处提供的文档](http://django-social-auth.readthedocs.org/en/latest/backends/github.html)

安装应用程序后，您需要做一堆配置，包括指定`Github` [后端](http://django-social-auth.readthedocs.org/en/latest/configuration.html)

您可能还想了解[OAuth 协议](https://bitbucket.org/david/django-oauth-plus/wiki/Home)以及您需要的所有令牌以及如何获取它们。

如果您只需要访问 github 特定的 API，我鼓励您查看[PyGithub](https://github.com/jacquev6/PyGithub)

身份验证就像`g = Github( token )`令牌来自 oauth 一样简单。

阅读repos如下

```
for repo in g.get_user().get_repos():
    print repo.name
    repo.edit( has_wiki = False ) 
```

与此相关的问题是[最适合 Github API v3 的 python 库](https://stackoverflow.com/questions/10625190/most-suitable-python-library-for-github-api-v3)

# python - Django：更新模型的正确方法

> ID：12379647
> 
> 赞同：0
> 
> 时间：2012-09-12T00:17:13.157
> 
> 标签：python, django, models

假设我有以下函数，它以用户定义对象的形式从服务器检索数据。例如，让我们将对象定义为 PersonalEntry。

```
def retrieve_people()
    // returns a list of all latest people objects, with fields equal to those in PersonEntry

def retrieve_books()
    // returns a list of all latest book objects regardless of author, with fields equal to those in BookEntry, contains attribute, 
```

两个用户定义的类都有一个 .as_dict() 方法，该方法在字典中返回其所有属性。

我想在调用此函数时更新模型（即，如果该模型的实例已经存在，则更新字段，否则，定义模型的新实例）。这是我目前的设置。

```
class PersonEntry(models.Model):
    name = models.CharField(max_length = 50)
    age = models.IntegerField()
    biography = models.CharField(max_length = 200)

    def update_persons():
         try: 
             temp = retrieve_person()
             for person in temp:
                 match = PersonEntry.objects.filter(name = person.name(), age = person.age())
                 match.update(**person.as_dict())
         except DoesNotExist:
             PersonEntry.create(**person.as_dict())

class BookEntry(models.Model):
    author = models.ForeignKey(PersonEntry)
    author_name = models.CharField(max_length = 50) //books return redundant info
    author_age = models.IntegerField() //books return redundant info
    title = models.CharField(max_length = 50)
    summary = models.CharField(max_length = 200)

    def update_books():
         try: 
             temp = retrieve_books()
             for book in temp:
                 match = BookEntry.objects.filter(title = temp.title())
                 match.update(**book.as_dict(), associate_person(book.author_age(), book.author_name()))
         except DoesNotExist:
             BookEntry.create(**book.as_dict(), associate_person(book.author_age(), book.author_name())

    def associate_person(age, name):
         return PersonEntry.get(name = name, age = age) 
```

我想一个更普遍的问题是，如果我有一个返回数据的函数，如何更新具有关系的模型？我是否在模型本身中有一个方法，或者我是否将它提升了一个级别（即将 update_books 移动到 Person 模型）我是 Django 新手，所以不太确定组织应该如何。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-12T00:45:34.643

我承认我没有完全理解你的问题，但我会采取一个平局，你应该研究一下

[`Managers`](https://docs.djangoproject.com/en/1.4/topics/db/managers/)

一般来说，在 django 中，一切都尽可能懒惰地完成——这意味着在你真正尝试使用它之前什么都不会更新——所以你不会随时更新模型/关系，而只是声明它们是什么（也许与经理) 然后它仅在被询问时才计算出当前值。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-12T07:14:44.253

返回某种模型的集合（或查询集）的方法应该是[Managers](https://docs.djangoproject.com/en/1.4/topics/db/managers/)的一部分。因此，在您的情况下，`update_books`应该在自定义管理器中，`BookEntry`并且`update_persons`应该在自定义管理器中`PersonEntry`。

也不`retrieve_*`要从模型或管理器内部调用该函数。在您的应用程序逻辑中调用它，然后将结果传递给管理器方法，除非该方法本身是管理器/模型的一部分。

您不需要单独的`filter`and`update`方法。根据您检索数据的方式，`pk`您可以直接执行`save`. 查看[Django 如何知道何时创建或更新](https://docs.djangoproject.com/en/dev/ref/models/instances/?from=olddocs#how-django-knows-to-update-vs-insert)

# c++ - 为什么我不能像这样复制可执行文件？

> ID：12379651
> 
> 赞同：1
> 
> 时间：2012-09-12T00:17:51.330
> 
> 标签：c++, copy, fstream

使用 C++ 的`<fstream>`，很容易复制一个文本文件：

```
#include <fstream>

int main() {
    std::ifstream file("file.txt");
    std::ofstream new_file("new_file.txt");

    std::string contents;
    // Store file contents in string:
    std::getline(file, contents);
    new_file << contents; // Write contents to file

    return 0;
} 
```

但是，当您对可执行文件执行相同操作时，输出的可执行文件实际上并不起作用。也许 std::string 不支持编码？

我希望我可以执行以下操作，但文件对象是一个指针，我无法取消引用它（运行以下代码会创建 new_file.exe，它实际上只包含某些东西的内存地址）：

```
std::ifstream file("file.exe");
std::ofstream new_file("new_file.exe");

new_file << file; 
```

我想知道如何做到这一点，因为我认为这在 LAN 文件共享应用程序中是必不可少的。我确信有更高级别的 API 用于使用套接字发送文件，但我想知道这些 API 是如何工作的。

我可以逐位提取、存储和写入文件，因此输入和输出文件之间没有差异吗？感谢您的帮助，非常感谢。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-09-12T00:24:49.267

不知道为什么 ildjarn 发表评论，但要让它成为答案（如果他发布答案，我将删除它）。基本上，你需要使用*无格式*的读写。`getline`格式化数据。

```
int main()
{
    std::ifstream in("file.exe", std::ios::binary);
    std::ofstream out("new_file.exe", std::ios::binary);

    out << in.rdbuf();
} 
```

从技术上讲，`operator<<`用于格式化数据，*除非*像上面那样使用它。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-12T00:27:07.140

用非常基本的术语：

```
using namespace std;

int main() {
    ifstream file("file.txt", ios::in | ios::binary );
    ofstream new_file("new_file.txt", ios::out | ios::binary);

    char c;
    while( file.get(c) ) new_file.put(c);

    return 0;
} 
```

虽然，您最好制作一个 char 缓冲区并使用`ifstream::read`/`ofstream::write`一次读取和写入块。

# javascript - 使用循环滚动数组

> ID：12379652
> 
> 赞同：1
> 
> 时间：2012-09-12T00:17:58.880
> 
> 标签：javascript, arrays

如何通过循环作用于数组本身或返回一个新数组来有效地滚动数组

```
arr = [1,2,3,4,5] 
```

我想做这样的事情：

```
arr.scroll(-2)

arr now is [4,5,1,2,3] 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-12T00:20:20.750

Use [`Array.slice`](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/Array/slice):

```
> arr.slice(-2).concat(arr.slice(0, -2));
[4, 5, 1, 2, 3] 
```

You [can](https://stackoverflow.com/questions/8859828/javascript-what-dangers-are-in-extending-array-prototype) then generalize it and extend `Array.prototype` with the `scroll` function:

```
Array.prototype.scroll = ​function (shift) {
    return this.slice(shift).concat(this.slice(0, shift));
}​;

> arr.scroll(-2);
[4, 5, 1, 2, 3] 
```

# c - 如何从作为C中结构成员的指针访问数组中的值

> ID：12379653
> 
> 赞同：1
> 
> 时间：2012-09-12T00:18:01.613
> 
> 标签：c, pointers, multidimensional-array, struct

我搜索了stackoverflow并看到了我的问题中单词的每个组合，但不是我的问题。

我有一个整数数组，它恰好是一个二维数组。

```
const int themap[something][something] = { {0, ... 
```

我有一个结构，我想在我的程序中有一个指向这个数组的指针

```
typedef struct {
int** mymap;
} THE_STRUCT 
```

在我的程序中，我想通过结构的指针迭代数组的值，但是如果我尝试通过 . 句法

```
int value;
THE_STRUCT mystruct;
mystruct = (int**) themap;

...
//access the map data from mystruct's pointer?
value = mystruct.mymap[x][y];
//doesn't seem to return correct values 
```

如果我直接使用数组（作为全局变量），则将结构从图片中取出，相同的函数可以工作

```
int value;
...
//access the map directly
value = themap[x][y]
//everyone is happy! 
```

我想使用该结构，因为它实际上将携带其他信息以及我需要能够将指针分配给具有不同数据的其他数组的事实。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-12T00:25:27.267

您的二维数组与`int **`. 如果要在 中存储指向它的指针`struct`，可以执行以下操作：

```
const int themap[something1][something2] = { {0, ...

typedef struct {
    const int (*mymap)[something2];
} THE_STRUCT;

...

THE_STRUCT my_struct;
my_struct.mymap = themap;

...

int value = my_struct.mymap[x][y]; 
```

可以*使用*，`int **`但需要一些努力：

```
const int themap[something1][something2] = { {0, ...
const int * themapPointerArray[something1] = {themap[0], themap[1], ..., themap[something1 - 1]};

typedef struct {
    const int **mymap;
} THE_STRUCT;

...

THE_STRUCT my_struct;
my_struct.mymap = themapPointerArray;

...

int value = my_struct.mymap[x][y]; 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-09-12T00:26:38.217

多维数组`int [][]`和双间接指针`int **`是两个完全不同的东西。

对于 C 来说，多维数组是一个以不同方式索引的一维数组。说`x`是`int [3][4]`。然后，`x`包含 12 个按顺序排列的元素，并且`x[1][2]`只是该一维数组的第 6 个元素。

被视为二维数组的双间接指针是指向数组的*指针数组*。因此，如果`y`is `int **`，则`y[1][2]`表示“数组的第三个元素由”的第二个元素指向`y`。

因此，您不能在 and 之间进行转换`int [][]`，`int **`因为它们只是代表不同的事物（您的`int [][]`to 转换`int **`会导致`int [][]`数组中的整数被视为指针，这将不可避免地崩溃）。

相反，您可以转换`int [M][N]`为`int (*)[N]`-- 指向`N`-length 数组的数组的指针。

# entity-framework - 实体框架 - 代码优先错误

> ID：12379660
> 
> 赞同：0
> 
> 时间：2012-09-12T00:18:40.133
> 
> 标签：entity-framework, sql-server-express, nuget-package

我正在使用 Entity Framework 5 使用代码优先`DBContext`且没有配置文件（所有默认值）。我有`.\SQLEXPRESS`安装了默认实例的 SQL Server 2008 R2 以及 SQL Server 2012 Express LocalDB ( `localdb)\v11.0`)。

该框架似乎无法并排处理这些，并且在我运行我的应用程序时会引发异常。我通过删除 SQL Server 2012 Express LocalDB 确认它工作正常。

有趣的一点是，当我在 VS 2010 或 VS 2012 中运行 NuGet 来安装实体框架时，它会使 VS 崩溃并且无法安装框架。我怀疑在这两种情况下都使用了类似的代码来查找/选择服务器。这篇文章旨在引起实体框架团队的注意，不一定要在这里解决。我很乐意提供团队可能需要的任何其他数据。

编辑 -

我发现 NuGet 的问题可能暴露在哪里：

> *安装 EF NuGet 包时，会注册一个默认连接工厂，该连接工厂指向 SQL Express 或 LocalDb，具体取决于您安装的是哪一个。*

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-12T16:46:12.667

很难判断这是否是 EF 错误，因为帖子中没有足够的详细信息。支持同时拥有 SqlExpress 和 LocalDB 的场景并且应该可以工作。SqlExpress 默认与 VS2010 一起安装，但不与 VS2012 一起安装，其中默认数据库解决方案是 LocalDb。确实有一段代码可以检测您的机器上是否安装了 SqlExpress，如果您安装了，它将相应地向您的配置文件添加条目。如果您没有 SqlExpress LocalDB，则应默认使用 VS2012 上的 AFAIR。安装 EF nuget 包时，我从未见过 VS 崩溃。正如我上面所说 - 没有足够的细节来判断这是否是一个 EF 错误 - 游戏中有太多东西，即 VS 本身（安装/公共组件可能会以某种方式损坏），NuGet，PowerShell（实际安装 dll 的脚本是 PowerShell 脚本）当然还有 EF。请随时在此处报告此问题：[http://entityframework.codeplex.com/](http://entityframework.codeplex.com/) - 这样错误将由 EF 团队查看。尽可能多地输入细节，以便我们能够复制问题。

# eclipse - How to disable warning "NLS missing message: CANNOT_FIND_FACELET_TAGLIB"

> ID：12379669
> 
> 赞同：1
> 
> 时间：2012-09-12T00:20:03.867
> 
> 标签：eclipse, jsf, namespaces, facelets, jboss-tools

I'm getting this annoying warning `NLS missing message: CANNOT_FIND_FACELET_TAGLIB in: org.eclipse.jst.jsf.core.validation.internal.facelet.messages` within a facelet page because the composite components namespace could not be validated. I think this is a JBoss Tools validation problem because the composite components library isn't located within the same Eclipse project.

I've found several validation entries under `Preferences > JBoss Tools > Web > JSF > Validation`, `Preferences > JBoss Tools > Web > Knowledge Base > Validator` and `Preferences > Web > JavaServer Faces Tools > Validation` but could not find the right option to ignore the "NLS missing message".

Where could this warning message be disabled? Thanks for advice!

# heroku - 未使用 AFNetworking 发送授权标头

> ID：12379675
> 
> 赞同：7
> 
> 时间：2012-09-12T00:20:43.433
> 
> 标签：heroku, authorization, afnetworking

我正在开发一个向 Web 服务器发出频繁请求的 iOS 应用程序，并且我正在使用 AFNetworking（我非常喜欢）。但是，我遇到了无法解决的授权问题。

服务器要求我提供授权标头以获得我想要的响应。具体来说，授权标头应该是这样的：

```
Authorization = "ApiKey some-user-name:someNumericalApiKey" 
```

我在整个项目中都使用 AFNetworking，一切正常，除了这个授权问题。我正在使用以下代码：

```
[myClient setDefaultHeader:@"Authorization" value:@"ApiKey some-user-name:someNumericalApiKey"]; 
```

where`myClient`指向一个 AFHTTPClient 对象。奇怪的是，当我使用 XCode 记录请求时`AFHTTPRequestOperationLogger`，记录器声称我设置了正确的标头。但是，授权标头似乎没有到达服务器 - 我在服务器日志中看不到它。

为了隔离问题，我尝试使用 good old `NSURLRequest`，以及`curl`和`requests`Python 中的库发出完全相同的请求 - 所有这些工作正常，即发送和接收授权标头（即我可以在服务器日志），服务器响应就是它应该是的。

如果有人遇到同样的问题（并找到了解决方案），我将非常感谢您的来信。

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2015-09-07T19:17:19.993

有时（尤其是使用 Django）这是由重定向剥离标头参数引起的。例如，/Object 在后台重定向到 /Object/，并在切换期间删除必要的 auth 参数。

如果您使用的是[AFNetworkActivityLogger](https://github.com/AFNetworking/AFNetworkActivityLogger)级别，`AFLoggerLevelDebug`那么您应该能够在控制台中查看这一点。如果您看到带有 /Object 的 POST 请求和带有 /Object/ 的响应，那么这可能表明正在进行重定向剥离。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-09T04:33:18.280

如果您手动构建操作，则不会应用 defaultHeaders，这可能是您的问题的原因。

# perl - 根据名称将文件移动到不同的文件夹/目录

> ID：12379677
> 
> 赞同：3
> 
> 时间：2012-09-12T00:20:49.427
> 
> 标签：perl, directory

我有一个包含数百个文件的目录或文件夹。它们按字母顺序命名和排列。我想根据文件名称的第一个字符将文件移动到目录或文件夹中（即文件以`a`一个文件夹开头，文件以`r`另一个文件夹开头，等等）。

有没有办法在不使用[`CPAN`](http://www.cpan.org/)模块的情况下做到这一点？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-09-12T03:22:26.903

文件都在那个文件夹中，还是在子文件夹中？如果它们都在一个文件夹中，您可以使用[opendir](http://perldoc.perl.org/functions/opendir.html)访问该目录，然后使用[readdir](http://perldoc.perl.org/functions/readdir.html)读取文件名并将它们复制到其他地方（使用[File::Copy](http://perldoc.perl.org/File/Copy.html)模块的`move`or`copy`函数。

```
use strict;
use warnings;
use autodie;
use File::Copy;   #Gives you access to the "move" command

use constant {
    FROM_DIR => "the.directory.you.want.to.read",
    TO_DIR   => "the.directory.you want.to.move.the.files.to",
};

#Opens FROM_DIR, ao I can read from it
opendir my $dir, FROM_DIR;

# Loopa through the directory
while (my $file = readdir $dir) {
    next if ($file eq "." or $file eq "..");
    my $from = FROM_DIR . "/" . "$file";
    move $from, TO_DIR;
} 
```

这并不完全符合您的要求，但它应该给您这个想法。基本上，我正在使用`opendir`和`readdir`读取目录中的文件，并且我正在使用`move`将它们移动到另一个目录。

我使用了该`File::Copy`模块，但它包含在所有 Perl 发行版中，因此它不是必须安装的*CPAN 模块。*

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-12T00:26:30.247

使用`glob()`, 或内置`File::Find`为每个起始字母构建文件列表。

# selenium - Selenium Webdriver：选择不显示

> ID：12379678
> 
> 赞同：2
> 
> 时间：2012-09-12T00:21:01.680
> 
> 标签：selenium

> **可能重复：**
> [Selenium WebDriver - 隐藏的选择和锚点](https://stackoverflow.com/questions/12371228/selenium-webdriver-hidden-select-and-anchor)

在我发布我的问题之前，我只想告诉我我是 Selenium 的新手。我正在尝试从下拉列表中选择一个选项。单击下拉框中的向下箭头时会显示选项。但是，当在 Firebug 中检查时，显示样式为“none”，当尝试通过在 Eclipse 中使用 click 方法使用 JUnit webdriver 代码选择选项时，它不起作用并给出了异常 - “org.openqa.selenium. ElementNotVisibleException：元素当前不可见，因此可能无法与之交互”。

请参阅所附图片以获取下拉列表和 HTML 标记。

```
<select class="size-dropdown mediumSelect selectBox" name="skuAndSize" style="display: none;">
<option value=""></option>
<option value="2545672:S" name="skuId"> S</option>
<option value="2545673:M" name="skuId"> M</option![enter image description here][1]>
<option value="2545674:L" name="skuId"> L</option>
<option value="2545675:XL" name="skuId"> XL</option>
<option value="2545676:XXL" name="skuId"> XXL</option>
<option value="2545677:XXXL" name="skuId"> XXXL</option>
<option value="2545678:XXXXL" name="skuId"> XXXXL</option>
</select> 
```

我在发布这个问题之前查看了这个链接 - [Selenium WebDriver - hidden select and anchor](https://stackoverflow.com/questions/12371228/selenium-webdriver-hidden-select-and-anchor) 但是，由于我刚刚开始，我无法清楚地理解。

注意：使用 clickAt 方法时，在 IDE 中也是如此。但是在 Webdriver 中 clickAt 方法不存在。任何人都可以在这方面帮助我。谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-12T09:04:01.310

问题是 Selenium 无法与不可见（禁用）的元素进行交互。所以你需要让元素可见。基本思想：使下拉菜单向下滚动，然后等待，`driver.manage.timeout(...)`然后单击下拉菜单中出现的所需元素。或者您可以使用 javascript 直接单击元素，而无需先下拉下拉菜单。Js能够应付它。

所以**这种方法总是有效的**：

```
css1=select[class="size-dropdown mediumSelect selectBox"]>option[value=""]
css2=select[class="size-dropdown mediumSelect selectBox"]>option[value="2545672:S"]
css2=select[class="size-dropdown mediumSelect selectBox"]>option[value="value="2545673:M"]
//.... and so on.....
public void jsClickOn(String cssSelector){
JavascriptExecutor js = (JavascriptExecutor) driver;
        StringBuilder stringBuilder = new StringBuilder();
        stringBuilder.append("var x = $(\'"+cssSelector+"\');");
        stringBuilder.append("x.click();");
        js.executeScript(stringBuilder.toString());
}
jsClickOn(css1);
jsClickOn(css2);
jsClickOn(css3); 
```

另一种方式：使用操作构建器，高级用户操作 API。[你可以在这里](http://code.google.com/p/selenium/wiki/AdvancedUserInteractions)阅读它并且代码将是这样的：

```
WebElement mnuElement;
WebElement submnuElement;
mnEle = driver.findElement(By.Id("mnEle")).click();
sbEle = driver.findElement(By.Id("sbEle")).click();

Actions builder = new Actions(driver);
// Move cursor to the Main Menu Element
builder.moveToElement(mnEle).Perform();
// Giving 5 Secs for submenu to be displayed
Thread.sleep(5000L);
// Clicking on the Hidden SubMenu
driver.findElement(By.Id("sbEle")).click(); 
```

但也要注意你是如何找到 css 选择器的，xpaths 在例如 firepath 中验证它，在 fox 中添加到 firebug。 ![在此处输入图像描述](../Images/320c8417da1f08efe44db33e5719d8c6.png) 希望这对你有帮助）

将此屏幕视为定位下拉选项的示例。 ![下拉选项](../Images/2b87b770f4ac5ed1f18628a2dab704e7.png)

# mysql - 如何将第二个表的行合并到 1 个字段中

> ID：12379680
> 
> 赞同：1
> 
> 时间：2012-09-12T00:21:07.147
> 
> 标签：mysql, sql

我一直在尝试生成一个将搜索 table1 的查询，然后连接 table2.column1 的所有值，其中 table1.id = table2.owner

```
People
 name | id
-------------
 tim  | 1
 jill | 2
 john | 3

Dogs
name | owner
--------------
 a   | 1
 b   | 1
 c   | 2
 d   | 2 
```

使用下表我需要一个可以输出的查询

```
 name | dogs
 -----------
 tim  | a, b
 jill | c, d
 john | NULL (or a blank text or just so long as the name john still shows) 
```

我已经花了几个小时，真的做不到。我认为 OUTER JOIN 和 group_concat() 之间存在某种形式的混搭。但我并没有真正接近我的答案。

谢谢大家的帮助！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-12T00:24:41.963

你会想要使用**[`GROUP_CONCAT`](http://dev.mysql.com/doc/refman/5.0/en/group-by-functions.html#function_group-concat)**一个`GROUP BY`

```
SELECT p.name, GROUP_CONCAT(d.name)
FROM   people p
LEFT JOIN dogs d 
     ON p.id = d.owner
GROUP BY p.name 
```

见[SQL Fiddle with Demo](http://sqlfiddle.com/#!2/63a11/1)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-12T00:22:47.520

我猜你在寻找**[GROUP_CONCAT](http://mahmudahsan.wordpress.com/2008/08/27/mysql-the-group_concat-function/)**`MySQL`。

```
SELECT  a.name, GROUP_CONCAT(b.name) dogsName
FROM    People a
        LEFT JOIN Dogs b
          ON a.id = b.owner
GROUP BY a.name 
```

# [SQLFiddle 演示](http://sqlfiddle.com/#!2/73c02/2)

# java - 如何将http标头添加到soap webservice glassfish

> ID：12379682
> 
> 赞同：0
> 
> 时间：2012-09-12T00:21:22.827
> 
> 标签：java, web-services, soap, netbeans, glassfish

如何使用 netbeans 和 glassfish 将 http 标头添加到肥皂网络服务？

我的网络服务类：

```
package com.service;

import com.model.Contact;
import com.model.Phonebook;
import java.util.ArrayList;
import javax.jws.WebMethod;
import javax.jws.WebParam;
import javax.jws.WebService;

@WebService(serviceName = "PhonebookService")
public class PhonebookService {

    private Phonebook phonebook = new Phonebook();

    @WebMethod(operationName = "insert")
    public String insert(@WebParam(name = "contact") Contact contact) {

        phonebook.add(contact);
        return contact.getName() + " inserted";

    }

    @WebMethod(operationName = "update")
    public String update(@WebParam(name = "contact") Contact contact) {

        phonebook.update(contact);
        return contact.getName() + " updated";

    }

    @WebMethod(operationName = "remove")
    public String remove(@WebParam(name = "contact") Contact contact) {

        phonebook.remove(contact);
        return contact.getName() + " removed";

    }

    @WebMethod(operationName = "list")
    public ArrayList<Contact> list() {

        return phonebook.list();

    }

} 
```

我想添加“Access-Control-Allow-Origin：*”标题

我该怎么做？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-12T04:25:56.150

在互联网上搜索了几个小时，我最终编写了以下代码，允许添加额外的 http 标头。我将它与 netbeans 生成的 web 服务和内置 glassfish 3 服务器一起使用

```
import java.io.*;
import javax.servlet.*;
import javax.servlet.annotation.WebFilter;
import javax.servlet.http.*;

@WebFilter(urlPatterns = { "/*" })
public class CrossOriginResourceSharingFilter implements Filter {

    public CrossOriginResourceSharingFilter() { }

    @Override
    public void init(FilterConfig fConfig) throws ServletException { }

    @Override
    public void destroy() { }

    @Override
    public void doFilter(
        ServletRequest request, ServletResponse response,
        FilterChain chain) throws IOException, ServletException {

        ((HttpServletResponse)response).addHeader(
            "Access-Control-Allow-Origin", "*"
        );
                ((HttpServletResponse)response).addHeader(
            "Access-Control-Allow-Headers", "Content-Type, Authorization, Accept"
        );
                ((HttpServletResponse)response).addHeader(
                        "Access-Control-Allow-Methods", "GET, POST, OPTIONS"
                );

        chain.doFilter(request, response);
    }
} 
```

# jquery - 在 jQuery 创建的元素上使用 CSS

> ID：12379683
> 
> 赞同：1
> 
> 时间：2012-09-12T00:21:54.417
> 
> 标签：jquery, css

我有一个在`.click`事件上创建的选择列表。它看起来像这样：

```
$('<select class="selectStatus" onChange="statusSubmit()"/>')
    .attr('name', 'status')
    .append('<option>Pick one</option>', '<option>Open</option>', '<option>Full</option>', '<option>Canceled</option>')
    .appendTo(this); 
```

在我的主`styles.css`文件中，我添加了这个：

```
select .selectStatus {
    width:700px;
    padding:0px;
    background-color: green;
} 
```

css 不应该在创建后应用于此选择列表吗？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-09-12T00:23:59.657

您正在将这些样式应用于`select`s 的子级`class="selectStatus"`。

删除空格：`select.selectStatus`.

# ios - 用于补充处方的 iOS API？

> ID：12379692
> 
> 赞同：0
> 
> 时间：2012-09-12T00:23:14.870
> 
> 标签：ios, api

我正在考虑一个 iOS 应用程序，它允许用户使用他们的 iPhone 扫描和补充 Rx 处方。

现在有几个 iOS 应用程序可以做到这一点。我想知道我可以使用哪种类型的 API 来做同样的事情。

由于任务的性质，我相信他们会商业化，但这很好。

任何提示或建议将不胜感激。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-12T00:26:54.630

不太可能有任何这样的公共 API。您应该咨询您计划与之互操作的药房，但很可能它根本不可用，因为美国对所有私人健康信息都有一些*极其*严格的隐私要求*。

*：特别是[HIPAA](http://www.hhs.gov/ocr/privacy/)

# python - replace.if startswith('CERTAIN STRING') 然后返回一个列表，可怕的标题

> ID：12379693
> 
> 赞同：0
> 
> 时间：2012-09-12T00:23:29.820
> 
> 标签：python, list, dictionary, replace, startswith

```
example = ['1 Hey this is the first (1) level.\n', '2 This is what we call a second level.\n','','3 This is the third (3) level, deal with it.']
example = [i.rstrip() for i in example]

dictHeaders =   [['1 ','One'],
                ['2 ','Two'],
                ['3 ','Three'],
                ['4 ','Four'],
                ['5 ','Five'],
                ['6 ','Six']]

example = [eachLine.replace(old,new,1) if eachLine.startswith(old) for eachLine in article for old, newFront in dictHeaders] 
```

我需要它返回...

```
example = ['One Hey this is the first (1) level.', 'Two This is what we call a second level.','','Three This is the third (3) level, deal with it.'] 
```

我创建`dictHeaders`了一个列表列表，以便将移动值添加到每个实例的每个键中。例如，如果`eachLine.startswith(old)`then 附加`One`到开头，并且可能将另一个字符串附加到行尾。如果我可以用 dict 完成上述操作，我宁愿走那条路。我是 Python 新手。

我认为这是要走的路，而不是...

```
def changeCode(example,dictHeaders):
    for old, newFront in dictHeaders:
        for eachLine in example:
            if eachLine.startswith(old):
            return eachLine.replace(old,newFront,1) 
```

每次我运行上面它只返回顶行，但我需要它返回整个列表`example`修改..

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-12T00:33:09.887

最好的方法是使用正则表达式并智能地替换数字：

```
import re

examples = [
  '1 Hey this is the first (1) level.\n',
  '2 This is what we call a second level.\n',
  '3 This is the third (3) level, deal with it.',
  '56 This is the third (3) level, deal with it.'
]

class NumberReplacer(object):
  def __init__(self):
    self.ones = ['one', 'two', 'three', 'four', 'five', 'six', 'seven', 'eight', 'nine']
    self.teens = ['ten', 'eleven', 'twelve', 'thirteen', 'fourteen', 'fifteen', 'sixteen', 'seventeen', 'eighteen', 'nineteen']
    self.tens = ['twenty', 'thirty', 'forty', 'fifty', 'sixty', 'seventy', 'eighty', 'ninety']

  def convert(self, number):
    if number == 0:
      return 'zero'
    elif number < 10:
      return self.ones[number - 1]
    elif number <= 19:
      return self.teens[number % 10]
    else:
      tens = self.tens[number // 10 - 2]
      ones = number % 10 - 1

      if ones == -1:
        return tens
      else:
        return ' '.join([tens, self.ones[ones]])

  def __call__(self, match):
    number = int(match.group(0))

    return self.convert(number).title()

replacer_regex = re.compile('^\s*(\d+)')
replacer = NumberReplacer()

for example in examples:
  print replacer_regex.sub(replacer, example) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-12T02:02:06.603

你很亲密。您不应该从 for 循环内部返回。相反，您可以创建 a`list`作为返回值并将每个结果附加到它

```
def changeCode(example,dictHeaders):
    retval = []
    for eachLine in example:
        for old, newFront in dictHeaders:
            if eachLine.startswith(old):
                retval.append(eachLine.replace(old,newFront,1))
                break
        else:
            retval.append(eachLine)
    return retval 
```

# android - 比较两个图像android

> ID：12379697
> 
> 赞同：0
> 
> 时间：2012-09-12T00:23:56.597
> 
> 标签：android, image, android-camera

此代码完美运行，但我无法使用 ANDROID，我需要比较两个图像？

```
 import java.awt.image.BufferedImage;
    import java.io.FileInputStream;
    import java.util.Vector;

     import javax.imageio.ImageIO;

    public class Untitled1 {
    public static void main(String[] args) {
        Vector original = testImg("b.jpg");
        Vector clonde   = testImg("a.jpg");
        System.out.println(original.equals(clonde));

    }

    public static Vector testImg(String file) {
        Vector all = new Vector();
        try {
            BufferedImage im = ImageIO.read(new FileInputStream(file));
            int w = im.getWidth(null);
            int h = im.getHeight(null);
            int[] rgbs = new int[w * h];
            int x = 0;
            im.getRGB(0, 0, w, h, rgbs, 0, w);

            for (int i = 0; i < w; i+=100) {
                Vector line = new Vector();
                for (int j = 0; j < h; j+=100) {
                    line.add(new Integer(rgbs[x]));
//                    System.out.println("Pixel " + i + "," + j + "has " + "RGB values of " + rgbs[x]);
                    x++;
                }
                all.add(line);
            }

        } catch (Exception ex) {
            ex.printStackTrace();
        }
        return all;
    }

} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-12T00:44:34.990

几件事：

*   如果您的代码处理选定的菜单选项，您应该返回`true`，如果没有。`onOptionsItemSelected()``false`

*   一旦确定图像不同，就应该打破循环。为什么做的工作比你需要的多？

*   此处无需使用案例/开关。您只处理一个菜单项。

所以：

```
@Override
public boolean onOptionsItemSelected(MenuItem item) {
    if (item.getItemId() != 1000)
        return (super.onOptionsItemSelected(item);

    for(int i=0;i<tabA.length;i++)
    {
        if(tabA[i] != tabB[i])
        {
            Toast.makeText(this, "Image are not equal", Toast.LENGTH_LONG).show();  

            return (true);
        }
    }

    Toast.makeText(this, "Image are equal", Toast.LENGTH_LONG).show();  

    return (true);
} 
```

# php - CodeIgniter：坦克身份验证，添加出生日期问题

> ID：12379703
> 
> 赞同：0
> 
> 时间：2012-09-12T00:24:28.343
> 
> 标签：php, codeigniter, tankauth

好的，所以我为注册过程添加了出生日期部分。我可能以一种奇怪的方式完成了它，但在我看来这是一种合乎逻辑的方式，只要它有效，我就可以接受它。我创建了 3 个 dob 字段（dob1、dob2、dob3 - 代表月、日、年）。我现在遇到的问题是当用户注册时，dob 值没有正确存储到数据库中（似乎这些值只是随机的，它们显示为随机数字和字母）。所以我很好奇我做错了什么。这是我所做的。

编辑：我发现了问题，但仍在寻找解决方案。排序在某个地方混淆了。我的前2个电子邮件字母进入dob1，前2个密码字母进入dob2（不知道是否通过或确认通过），dob1进入firstname，dob2进入lastnam，用户名很好，dob3进入电子邮件。所以我在某个地方混淆了我的数组的顺序，但我很确定它在哪里重要。

EDIT2：我发现了我的问题。答案如下。

在 controllers/auth.php 中注册函数

```
function register()
        {
                if ($this->tank_auth->is_logged_in()) {                                                                 // logged in
                        redirect('');

                } elseif ($this->tank_auth->is_logged_in(FALSE)) {                                              // logged in, not activated
                        redirect('/auth/send_again/');

                } elseif (!$this->config->item('allow_registration', 'tank_auth')) {    // registration is off
                        $this->_show_message($this->lang->line('auth_message_registration_disabled'));

                } else {
                        $use_username = $this->config->item('use_username', 'tank_auth');
                        if ($use_username) {
                                $this->form_validation->set_rules('username', 'Username', 'trim|required|xss_clean|min_length['.$this->config->item('username_min_length', 'tank_auth').']|max_length['.$this->config->item('username_max_le\
ngth', 'tank_auth').']|alpha_dash');
                        }

                        $this->form_validation->set_rules('dob1', 'DOB1', 'trim|required|xss_clean|min_length[2]|max_length[2]');
                        $this->form_validation->set_rules('dob2', 'DOB2', 'trim|required|xss_clean|min_length[2]|max_length[2]');
                        $this->form_validation->set_rules('dob3', 'DOB3', 'trim|required|xss_clean|min_length[2]|max_length[4]');
                        $this->form_validation->set_rules('firstname', 'First Name', 'trim|xss_clean|min_length[2]|max_length[50]');
                        $this->form_validation->set_rules('lastname', 'Last Name', 'trim|xss_clean|min_length[2]|max_length[50]');

                        $this->form_validation->set_rules('email', 'Email', 'trim|required|xss_clean|valid_email');
                        $this->form_validation->set_rules('email', 'Email', 'trim|required|xss_clean|valid_email|callback_is_email_domain[ku.edu]');
                        $this->form_validation->set_rules('password', 'Password', 'trim|required|xss_clean|min_length['.$this->config->item('password_min_length', 'tank_auth').']|max_length['.$this->config->item('password_max_length', '\
tank_auth').']|alpha_dash');
                        $this->form_validation->set_rules('confirm_password', 'Confirm Password', 'trim|required|xss_clean|matches[password]');

                        $captcha_registration   = $this->config->item('captcha_registration', 'tank_auth');
                        $use_recaptcha                  = $this->config->item('use_recaptcha', 'tank_auth');
                        if ($captcha_registration) {
                                if ($use_recaptcha) {
                                        $this->form_validation->set_rules('recaptcha_response_field', 'Confirmation Code', 'trim|xss_clean|required|callback__check_recaptcha');
                                } else {
                                        $this->form_validation->set_rules('captcha', 'Confirmation Code', 'trim|xss_clean|required|callback__check_captcha');
                                }
                        }
                        $data['errors'] = array();

                        $email_activation = $this->config->item('email_activation', 'tank_auth');

                        if ($this->form_validation->run()) {                                                            // validation ok
                                if (!is_null($data = $this->tank_auth->create_user(
                                                $use_username ? $this->form_validation->set_value('username') : '',

                                                $this->form_validation->set_value('dob1'),
                                                $this->form_validation->set_value('dob2'),
                                                $this->form_validation->set_value('dob3'),
                                                $this->form_validation->set_value('firstname'),
                                                $this->form_validation->set_value('lastname'),

                                                $this->form_validation->set_value('email'),
                                                $this->form_validation->set_value('password'),
                                                $email_activation))) {                                                                  // success

                                        $data['site_name'] = $this->config->item('website_name', 'tank_auth');

                        $email_activation = $this->config->item('email_activation', 'tank_auth');

                        if ($this->form_validation->run()) {                                                            // validation ok
                                if (!is_null($data = $this->tank_auth->create_user(
                                                $use_username ? $this->form_validation->set_value('username') : '',

                                                $this->form_validation->set_value('dob1'),
                                                $this->form_validation->set_value('dob2'),
                                                $this->form_validation->set_value('dob3'),
                                                $this->form_validation->set_value('firstname'),
                                                $this->form_validation->set_value('lastname'),

                                                $this->form_validation->set_value('email'),
                                                $this->form_validation->set_value('password'),
                                                $email_activation))) {                                                                  // success

                                        $data['site_name'] = $this->config->item('website_name', 'tank_auth');

                                        if ($email_activation) {                                                                        // send "activate" email
                                                $data['activation_period'] = $this->config->item('email_activation_expire', 'tank_auth') / 3600;

                                                $this->_send_email('activate', $data['email'], $data);

                                                unset($data['password']); // Clear password (just for any case)

                                                $this->_show_message($this->lang->line('auth_message_registration_completed_1'));

                                        } else {
                                                if ($this->config->item('email_account_details', 'tank_auth')) {        // send "welcome" email

                                                        $this->_send_email('welcome', $data['email'], $data);
                                                }
                                                unset($data['password']); // Clear password (just for any case)

                                                $this->_show_message($this->lang->line('auth_message_registration_completed_2').' '.anchor('/auth/login/', 'Login'));
                                        }
                                } else {
                                        $errors = $this->tank_auth->get_error_message();
                                        foreach ($errors as $k => $v)   $data['errors'][$k] = $this->lang->line($v);
                                }
                        }
                        if ($captcha_registration) {
                                if ($use_recaptcha) {
                                        $data['recaptcha_html'] = $this->_create_recaptcha();
                                } else {
                                        $data['captcha_html'] = $this->_create_captcha();
                                }
                        }
                        $data['use_username'] = $use_username;
                        $data['captcha_registration'] = $captcha_registration;
                        $data['use_recaptcha'] = $use_recaptcha;
                        $this->load->view('auth/register_form', $data);
                }
        } 
```

库：Tank_Auth.php - 我知道这不是整个 dob，但调用此函数不会返回任何内容，我想如果我可以返回 1 个 dob，那么我可以轻松地将它们全部返回。编辑：我刚刚意识到我没有包含我对该文件的所有更改。

```
else {  
    $this->ci->session->set_userdata(array(     
        'user_id'  => $user->id,    
        'dob1'     => $user->dob1,
        'dob2'     => $user->dob2,
        'dob3'     => $user->dob3,
        'firstname'  => $user->firstname,
        'lastname'  => $user->lastname,   
        'username'  => $user->username, 
        'status'  => ($user->activated == 1) ? STATUS_ACTIVATED : STATUS_NOT_ACTIVATED, 

         )); 
```

. . .

```
function get_dob()
        {
                return $this->ci->session->userdata('dob1');
        } 
```

. . .

```
function create_user($username, $firstname, $lastname, $email, $password, $email_activation, $dob1, $dob2, $dob3)
{
    if ((strlen($username) > 0) AND !$this->ci->users->is_username_available($username)) {
        $this->error = array('username' => 'auth_username_in_use');
        $hashed_password = $hasher->HashPassword($password);
        $data = array(
            'firstname' => $firstname,
            'lastname' => $lastname,
            'dob1' => $dob1,
            'dob2' => $dob2,
            'dob3' => $dob3,
            'username' => $username,
            'password' => $hashed_password,
            'email' => $email, 
```

浏览量：registration_form.php

```
<?php
if ($use_username) {
        $username = array(
                'name'  => 'username',
                'id'    => 'username',
                'value' => set_value('username'),
                'maxlength'     => $this->config->item('username_max_length', 'tank_auth'),
                'size'  => 30,
        );
}
$email = array(
        'name'  => 'email',
        'id'    => 'email',
        'value' => set_value('email'),
        'maxlength'     => 80,
        'size'  => 30,
);
$firstname = array(
        'name'  => 'firstname',
        'id'    => 'firstname',
        'value' => set_value('firstname'),
        'maxlength'     => 50,
        'size'  => 30,
);
$lastname = array(
        'name'  => 'lastname',
        'id'    => 'lastname',
        'value' => set_value('lastname'),
        'maxlength'     => 50,
        'size'  => 30,
);
$password = array(
        'name'  => 'password',
        'id'    => 'password',
        'value' => set_value('password'),
        'maxlength'     => $this->config->item('password_max_length', 'tank_auth'),
        'size'  => 30,
);
$confirm_password = array(
        'name'  => 'confirm_password',
        'id'    => 'confirm_password',
        'value' => set_value('confirm_password'),
        'maxlength'     => $this->config->item('password_max_length', 'tank_auth'),
        'size'  => 30,
);
$dob1 = array(
        'name'  => 'dob1',
        'id'    => 'dob1',
        'value' => set_value('dob1'),
        'maxlength'     => 2,
        'size'  => 30,
);
$dob2 = array(
        'name'  => 'dob2',
        'id'    => 'dob2',
        'value' => set_value('dob2'),
        'maxlength'     => 2,
        'size'  => 30,
);
$dob3 = array(
        'name'  => 'dob3',
        'id'    => 'dob3',
        'value' => set_value('dob3'),
        'maxlength'     => 4,
        'size'  => 30,
);
$captcha = array(
        'name'  => 'captcha',
        'id'    => 'captcha',
        'maxlength'     => 8,
);
?>
<?php echo form_open($this->uri->uri_string()); ?>
<table>
        <?php if ($use_username) { ?>
        <tr>
                <td><?php echo form_label('Username', $username['id']); ?></td>
                <td><?php echo form_input($username); ?></td>
                <td style="color: red;"><?php echo form_error($username['name']); ?><?php echo isset($errors[$username['name']])?$errors[$username['name']]:''; ?></td>
        </tr>
        <?php } ?>
        <tr>
                <td><?php echo form_label('Email Address', $email['id']); ?></td>
                <td><?php echo form_input($email); ?></td>
                <td style="color: red;"><?php echo form_error($email['name']); ?><?php echo isset($errors[$email['name']])?$errors[$email['name']]:''; ?></td>
        </tr>
        <tr>
                <td><?php echo form_label('First Name', $firstname['id']); ?></td>
                <td><?php echo form_input($firstname); ?></td>
                <td style="color: red;"><?php echo form_error($firstname['name']); ?><?php echo isset($errors[$firstname['name']])?$errors[$firstname['name']]:''; ?></td>
        </tr>
        <tr>
                <td><?php echo form_label('Last Name', $lastname['id']); ?></td>
                <td><?php echo form_input($lastname); ?></td>
                <td style="color: red;"><?php echo form_error($lastname['name']); ?><?php echo isset($errors[$lastname['name']])?$errors[$lastname['name']]:''; ?></td>
        </tr>
        <tr>
                <td><?php echo form_label('Password', $password['id']); ?></td>
                <td><?php echo form_password($password); ?></td>
                <td style="color: red;"><?php echo form_error($password['name']); ?></td>
        </tr>
        <tr>
                <td><?php echo form_label('Confirm Password', $confirm_password['id']); ?></td>
                <td><?php echo form_password($confirm_password); ?></td>
                <td style="color: red;"><?php echo form_error($confirm_password['name']); ?></td>
        </tr>
        <tr>
                <td><?php echo form_label('Date of Birth', $dob1['id']); ?></td>
                <td><?php echo form_input($dob1); ?></td>
                <td><?php echo form_input($dob2); ?></td>
                <td><?php echo form_input($dob3); ?></td>
                <td style="color: red;"><?php echo form_error($dob1['name']); ?><?php echo isset($errors[$dob1['name']])?$errors[$dob1['name']]:''; ?></td>
        </tr>

        <?php if ($captcha_registration) {
                if ($use_recaptcha) { ?>
        <tr>
                <td colspan="2">
                        <div id="recaptcha_image"></div>
                </td>
                <td>
                        <a href="javascript:Recaptcha.reload()">Get another CAPTCHA</a>
                        <div class="recaptcha_only_if_image"><a href="javascript:Recaptcha.switch_type('audio')">Get an audio CAPTCHA</a></div>
                        <div class="recaptcha_only_if_audio"><a href="javascript:Recaptcha.switch_type('image')">Get an image CAPTCHA</a></div>
                </td>
        </tr>
        <tr>
                <td>
                        <div class="recaptcha_only_if_image">Enter the words above</div>
                        <div class="recaptcha_only_if_audio">Enter the numbers you hear</div>
                </td>
                <td><input type="text" id="recaptcha_response_field" name="recaptcha_response_field" /></td>
                <td style="color: red;"><?php echo form_error('recaptcha_response_field'); ?></td>
                <?php echo $recaptcha_html; ?>
        </tr>
        <?php } else { ?>
        <tr>
                <td colspan="3">
                        <p>Enter the code exactly as it appears:</p>
                        <?php echo $captcha_html; ?>
                </td>
        </tr>
        <tr>
                <td><?php echo form_label('Confirmation Code', $captcha['id']); ?></td>
                <td><?php echo form_input($captcha); ?></td>
                <td style="color: red;"><?php echo form_error($captcha['name']); ?></td>
        </tr>
<?php }
        } ?>
</table>
<?php echo form_submit('register', 'Register'); ?>
<?php echo form_close(); ?> 
```

**另外：如果您知道如何更改 registration_form.php 的 td 标签的宽度，请告诉我。我正在努力解决这个问题，简单的也行不通。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-12T19:53:40.047

我找到了我搞砸的地方。当我在 auth.php 中调用 create_user() 函数时，我以错误的顺序传递字段。我进入 Tank_Auth.php 文件并重新排序该函数的参数以匹配我在 auth.php 中传递的内容。

```
function create_user($username, $firstname, $lastname, $email, $password, $email_activation, $dob1, $dob2, $dob3) 
```

变成

```
function create_user($username, $dob1, $dob2, $dob3, $firstname, $lastname, $email, $password, $email_activation) 
```

这与我在 auth.php 中的 create_user() 调用相匹配：

```
if (!is_null($data = $this->tank_auth->create_user(
                                                $use_username ? $this->form_validation->set_value('username') : '',

                                                $this->form_validation->set_value('dob1'),
                                                $this->form_validation->set_value('dob2'),
                                                $this->form_validation->set_value('dob3'),
                                                $this->form_validation->set_value('firstname'),
                                                $this->form_validation->set_value('lastname'),

                                                $this->form_validation->set_value('email'),
                                                $this->form_validation->set_value('password'),
                                                $email_activation))) 
```

# jquery - 最后一项的 jcarousel 问题

> ID：12379704
> 
> 赞同：0
> 
> 时间：2012-09-12T00:24:35.847
> 
> 标签：jquery, css, jcarousel

我正在使用 jquery jcarousel 并且遇到了麻烦。当我滚动到最后一项时，似乎总是有一点剩余，这意味着另一个滚动。

一个例子可以在下面看到：

[http://gordonhouse.gumpshen.com/women/rings.aspx](http://gordonhouse.gumpshen.com/women/rings.aspx)

有人可以帮忙吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-12T00:30:25.317

将边距更改`margin:0;`为您的`li.first`并`li.middle`使其全球化

```
ul.promo li {
    margin: 0 14px 0 0;
} 
```

# wpf - 自定义 DependencyProperty 不更新外部视图模型

> ID：12379710
> 
> 赞同：1
> 
> 时间：2012-09-12T00:25:05.940
> 
> 标签：wpf, binding, user-controls, dependency-properties

我有一个用户控件，其中有一个填充了成员的 DataGrid。DataGrid.ItemsSource 绑定到模型上的 ObservableCollection。DataGrid.SelectedItem 绑定到模型上的 SelectedMember 字段。SelectedMember._set 调用 NotifyPropertyChanged 和事件调用 SetValue() 为公开的 DependencyProperty。

此 UserControl 位于页面上。该页面也有一个视图模型。我正在尝试将 UserControl.CurrentMember 绑定到 viewmodel.SelectedMember 但它没有改变。我可以将 CurrentMember.MemberName 绑定到一个文本框，并且该框填充成员名称，因此看起来 UserControl 正确地公开了 DependencyProperty。但是，如果我绑定到模型，它不会更新。

我找不到任何交叉绑定。绑定到 TextBox 工作正常。页面模型上的字段是新的，因此没有任何约束。

可能是什么问题呢？页面模型上的字段是否需要是 DependencyProperty？如果是这种情况，编译器会给我一个错误。

我会尝试获取代码示例，但它是如此根深蒂固，我不能只发布几行代码。

汤姆·P。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-12T03:52:00.427

在梳理代码并尝试在新项目中复制问题后，我发现了问题。

在 UserControl 中，我将 DataContext 设置为模型。但是当我将 UserControl.DataContext 放在页面上时，它会被覆盖。我需要做的是命名 MainGrid 并将 MainGrid 的 DataContext 设置为 UserControlModel。MainGrid 是 UserControl 私有的，不会被覆盖。现在它工作得很好。

# c++ - 无法获取当前的键盘布局

> ID：12379713
> 
> 赞同：6
> 
> 时间：2012-09-12T00:25:15.037
> 
> 标签：c++, winapi, keyboard-layout

我已经尝试过**GetKeyboardLayoutName()**和**GetKeyboardLayout()**来获取当前的键盘布局，但是它们都给了我默认布局，并且更改布局不会影响输出！

```
while(1)
{
    Sleep(5);
    for(int i = 8; i < 191; i++)
    {
        if(GetAsyncKeyState(i)&1 ==1)
        {
            TCHAR szKeyboard[KL_NAMELENGTH];
            GetKeyboardLayoutName(szKeyboard);

            if(GetAsyncKeyState(i)&1 ==1)
            {
                TCHAR szKeyboard[KL_NAMELENGTH];
                GetKeyboardLayoutName(szKeyboard);
                cout << szKeyboard << endl ;
            }
        }
    }
} 
```

当默认布局设置为英语时，它总是给我“00000409”，而当我将布局更改为波斯语时，我希望它是“00000429”。

我在这里的第一个问题，我过去常常通过搜索找到所有答案。但是现在，经过数小时的四处搜索却一无所获，我正在发疯……

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-09-12T07:41:10.457

您需要注意的一件事是 ::GetKeyboardLayout (..) 获取传递的线程标识符的 lang 作为参数。

每个输入线程可以有不同的输入语言环境。例如，如果您将让 IE 放在前台并按 Alt+Shift，则 lang 会更改为 UK。（您可以在任务栏中看到它）

现在，如果您将 Alt+Tab 转到另一个窗口（将在前面），您将看到 lang 不必留在英国。

所以你需要检查的是你传递的线程ID是什么。

看看这段代码，它会给你当前活动窗口的语言：

```
GUITHREADINFO Gti;
::ZeroMemory ( &Gti,sizeof(GUITHREADINFO));
Gti.cbSize = sizeof( GUITHREADINFO );
::GetGUIThreadInfo(0,&Gti);
DWORD dwThread = ::GetWindowThreadProcessId(Gti.hwndActive,0);
HKL lang = ::GetKeyboardLayout(dwThread); 
```

要使用 GUITHREADINFO，您需要定义 WINVER 0x500。把它放在所有包含之前的 stdafx.h 中。

```
#ifdef WINVER
#undef WINVER
#endif 
#define WINVER 0x500 
```

来源：[GetKeyboardLayout 未返回正确的语言 ID (WINXP)](http://forums.codeguru.com/showthread.php?360951)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2018-05-29T02:41:42.320

The following code is simple and works fine. If you write a command line program, the `GetKeyboardLayout` API does't work in windows cmd or powershell, you can test it in [babun](http://babun.github.io/)(an open source windows shell).

```
#include <Windows.h>
int getInputMethod() {
  HWND hwnd = GetForegroundWindow();
  if (hwnd) {
    DWORD threadID = GetWindowThreadProcessId(hwnd, NULL);
    HKL currentLayout = GetKeyboardLayout(threadID);
    unsigned int x = (unsigned int)currentLayout & 0x0000FFFF;
    return ((int)x);
  }
  return 0;
} 
```

# java - 字符串索引超出范围错误 7

> ID：12379717
> 
> 赞同：0
> 
> 时间：2012-09-12T00:25:42.273
> 
> 标签：java, string, indexoutofboundsexception

> **可能重复：**
> [字符串索引超出范围：n](https://stackoverflow.com/questions/9020859/string-index-out-of-range-n)

我正在编写一个程序来根据用户的输入（名字、中间名和姓氏）生成用户名。我应该从每个名字（名字、中间和姓氏）中获取第一个字符以及姓氏的最后一个字符，以便生成用户名。我已经成功编写了程序来生成每个名字的第一个字符，但是当我试图让我的程序生成姓氏的最后一个字符时，我会收到这个错误：

线程“主”java.lang.StringIndexOutOfBoundsException 中的异常：字符串索引超出范围：7

```
at java.lang.String.charAt(String.java:658)
at UsernameGenerator.main(UsernameGenerator.java:39) 
```

这是我的代码：

```
 import java.util.Scanner;
    /**
    UsernameGenerator.java
    Generates a username based on the users inputs.
    @author: Evan Fravert
    */
public class UsernameGenerator {
/**
  * Generates a username based on the users inputs.
  *@param args command line argument
  */
  public static void main(String[] args)
{ // abcde
  String first;
  String middle;
  String last;
  String password1;
  String password2;
  int randomNum;
  randomNum = (int) (Math.random() * 1000) + 100;
  Scanner userInput = new Scanner(System.in);
  System.out.println("Please enter your first name:");
  first = userInput.nextLine();
  String firstLower = first.toLowerCase();
  System.out.println("Please enter your middle name:");
  middle = userInput.nextLine();
  String middleLower = middle.toLowerCase();
  System.out.println("Please enter your last name:");
  last = userInput.nextLine();
  int lastEnd = last.length();
  String lastLower = last.toLowerCase();
  System.out.println("Please enter your password:");
  password1 = userInput.nextLine();
  System.out.println("Please enter your password again:");
  password2 = userInput.nextLine();
  char firstLetter = firstLower.charAt(0);
  char middleLetter = middleLower.charAt(0);
  char lastLetter = lastLower.charAt(0);
  char lastLast = lastLower.charAt(lastEnd);
  if (first == null || first.length() <= 0) {
      firstLetter = 'z';
  }
  else {
  firstLetter = firstLower.charAt(0);
  }
  System.out.println("Your username is " + firstLetter + ""
  + middleLetter + "" + lastLetter + "" + "" + lastLast + "" + randomNum); 
  System.out.println("Your password is " + password1);
  System.out.println("Welcome " + first + " " + middle + " " + last + "!");
  }
  } 
```

提前致谢！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-12T00:27:36.810

Java 数组从零开始，最后一个索引是 last.length() - 1

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-12T00:29:44.720

尝试这个：

```
char lastLast = lastLower.charAt(lastEnd-1); 
```

# mysql - mysql查询限制理论，如何响应客户端

> ID：12379725
> 
> 赞同：-1
> 
> 时间：2012-09-12T00:27:01.807
> 
> 标签：mysql

请你教我mysql查询的理论：如果我的sql是：`select * from user where city='NewYork'`。那么mysql引擎（服务器）会一说查询表，一说响应结果（一一）？或者，在查询一些大小的结果并放入缓存之后，然后批量响应客户端？如果我使用实例限制 10 的限制，那么我想知道 mysql 是否查询所有结果然后响应 10 个结果，或者只查询 10 个结果（不是查询全部）并响应客户端。提前致谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-12T00:32:51.163

我相信服务器会在尝试返回结果之前执行整个查询。同样使用限制子句，一旦服务器知道已满足限制条件，它将停止处理查询。请注意，仅仅因为使用了限制子句，并不意味着服务器没有读取表中的每条记录。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-12T00:33:10.307

这是关于`LIMIT`.

[http://www.mysqlperformanceblog.com/2006/09/01/order-by-limit-performance-optimization/](http://www.mysqlperformanceblog.com/2006/09/01/order-by-limit-performance-optimization/)

# git - 删除后git远程分支重新出现

> ID：12379729
> 
> 赞同：0
> 
> 时间：2012-09-12T00:27:46.470
> 
> 标签：git

我试图删除一个远程分支，它继续重新列出。我试过了

1) git branch -rd origin/legacy 2) git gc --prune=now 3) git branch -d -r origin/legacy 4) 当我尝试 git remote rm origin/legacy 时出现错误：无法删除配置部分' remote.origin/legacy'

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-12T00:49:27.747

要从远程存储库中删除分支，您需要执行以下操作：`git push origin :branch-name`. 这就是 Git`branch-name`从远程存储库中删除的说法。

大概，您有​​一个对本地远程分支（称为`origin/branch-name`）和一个本地分支的引用，称为`branch-name`. `git remote prune origin`将删除`origin/`对不再存在的分支的所有引用，这将使您只剩下本地分支。`git branch -d branch-name`如果您愿意，可以使用 删除它。

# ruby-on-rails - 从 Rails 3.2 应用程序查询远程数据库

> ID：12379730
> 
> 赞同：0
> 
> 时间：2012-09-12T00:28:02.270
> 
> 标签：ruby-on-rails, database, ruby-on-rails-3

我需要查询一个完全独立于我正在构建的 Rails 3.2 应用程序的第 3 方数据库（属于我公司内部使用的不同应用程序）。

最终，我将设置一个 cron 来从 Rails 应用程序将要处理的“其他”数据库中加载新行。

我有权进行`otherdb`设置，但我想知道从哪里开始——我要在 中创建一个新条目`config/database.yml`吗？如果是这样，我该如何指定查询何时被定向到`otherdb`，而不是我的默认 Rails`development`或`production`db？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-12T05:56:37.293

有几种方法可以实现此要求，其中最简单的方法是使用`config/database.yml`和自定义命名空间模型。

设置类似于下面的内容，使用后缀`Rails.env`遵循命名约定将提供您概述的功能。

首先，为每个现有环境的外部数据库创建新条目。它将帮助您能够测试功能。

```
# database.yml
development:
  # add configuration as required

otherdb_development:
  # add configuration as required 
```

其次，为您需要在`otherdb`数据库中访问的每个特定表添加一个模型。我建议为这些模型添加一个命名空间目录（`otherdb`在下面的示例中）以避免混淆和潜在的破坏：

```
# /app/models/otherdb
class Otherdb::Foo < ActiveRecord::Base
  establish_connection "otherdb_#{Rails.env}"
  set_table_name "foo" # customize this if the table name will be different from the classname and is required
end 
```

然后，您可以根据需要使用（作为示例）方法`Otherdb::Foo`并使用结果数据。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-22T04:20:22.807

我昨天有同样的问题。由于您使用的是 Rails 3.2，因此连接到外部数据库的所有模型都必须是建立连接的单个抽象类的子类。在早期版本的 Rails 中，@Sasha 的回答会奏效。但在 3.2 中，该答案会导致您遇到各种令人困惑的数据库错误。（你得到什么错误取决于你使用什么数据库。）

在 Rails 3.2 中，这是我发现的唯一可行的方法：

1.  为所有需要与非默认数据库通信的模型创建一个通用基类。
2.  通过调用告诉 ActiveRecord 这个基类是抽象的`self.abstract_class = true`。
3.  调用`establish_connection`基类。

以下是来自外部表的学生和课程示例：

```
# database.yml:
development:
  # default configuration goes here

other_development:
  # external db configuration goes here

class OtherTable < ActiveRecord::Base
  self.abstract_class = true
  establish_connection "other_#{Rails.env}"
end

class Student < OtherTable
end

class Course < OtherTable
end 
```

如果您想了解更多详细信息，请参阅我写的博客文章，标题为[在 Rails 3.2 中建立与非默认数据库的连接](http://ilikestuffblog.com/2012/09/21/establishing-a-connection-to-a-non-default-database-in-rails-3-2-2/)。

# ruby-on-rails - 避免文件上传命名冲突的策略

> ID：12379732
> 
> 赞同：0
> 
> 时间：2012-09-12T00:28:24.337
> 
> 标签：ruby-on-rails, web-applications, concurrency, amazon-s3

我在 Rails 中有一个 webapp，它作为 AJAX 文件上传功能。文件上传到远程服务器 (AWS S3)。我目前的策略是`temp/`在用户提交表单之前将文件上传到目录中（使用其原始名称），然后将它们重命名为最终名称。

但问题是，如果多个用户尝试同时上传两个具有相同名称的文件，那么其中一个会覆盖另一个。

我正在考虑解决此问题的策略是在加载上传页面时生成随机 SHA1，将它们存储在本地表中以确保它们是唯一的，并在重命名临时文件时将它们删除。

您认为这种方法存在问题吗？

解决这个问题的好策略是什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-12T00:35:53.733

一个问题是，如果他们在没有上传任何内容的情况下离开页面，他们的哈希值将留在数据库中，最终会造成混乱。我会避免在数据库中存储任何这种临时的东西。

与其尝试想出自己的方式来命名临时文件，不如使用 ruby[​​ tempfile 库](http://www.ruby-doc.org/stdlib-1.9.3/libdoc/tempfile/rdoc/Tempfile.html)，它会为您做到这一点？

* * *

本来我以为你是把文件上传到ruby服务器，自己上传到s3。如果用户直接上传文件，临时文件将无济于事。如果您只想要临时文件的唯一名称，UUID 生成器可能适合您。有一个[Ruby UUID 生成器 gem](https://github.com/assaf/uuid/)，它的设计目的是不产生重复，即使在分布式环境中也是如此。如果您使用这些命名文件，则不需要在数据库中存储任何内容。

# string - Verilog 中的字符串操作

> ID：12379750
> 
> 赞同：3
> 
> 时间：2012-09-12T00:31:53.690
> 
> 标签：string, verilog, system-verilog

我需要在 Verilog 模拟中对字符串执行基本操作，例如连接、替换和比较。怎么可能？有内置支持吗？

提前致谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-12T01:17:34.423

Verilog 中没有字符串数据类型，但是 verilog 确实支持字符串文字并将它们用作字节向量。这是规范中的示例：

```
module string_test;
reg [8*14:1] stringvar;
initial begin
  stringvar = "Hello world";
  $display ("%s is stored as %h", stringvar,stringvar);
  stringvar = {stringvar,"!!!"};
  $display ("%s is stored as %h", stringvar,stringvar);
  end
endmodule 
```

由于字符串使用 reg 数据类型，您可以使用普通运算符来操作它们，记住每个字符使用 8 位。

> 5.2.3.1 字符串操作
> 
> Verilog HDL 运算符支持常见的字符串操作复制、连接和比较。副本是通过简单的分配提供的。连接由连接运算符提供。比较由相等运算符提供。在向量 reg 中处理字符串值时，reg 应至少为 8*n 位（其中 n 是 ASCII 字符的数量），以保留 8 位 ASCII 代码。

如果您需要搜索等操作，则必须编写一些任务或功能。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-09-12T02:13:21.783

如果您可以访问支持 SystemVerilog 语法的现代模拟器，则有一种`string`数据类型。可以连接和比较字符串。请参阅 IEEE 标准 (1800-2009)。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2017-03-10T15:01:35.277

sjtaheri,

恢复一个死线程，但我看到这个问题出现了，并且有一个更新的解决方案。

svlib 是一个免费的、开源的 SystemVerilog 实用函数库。它包括文件和字符串操作功能、完整的正则表达式搜索/替换、轻松读写配置文件、访问环境变量和挂钟时间等等。该项目在 DVCon 2014 上展示。

[http://www.verilab.com/resources/svlib/](http://www.verilab.com/resources/svlib/)

# php - 在 Google 地图上绘制位置数据库

> ID：12379754
> 
> 赞同：2
> 
> 时间：2012-09-12T00:32:13.893
> 
> 标签：php, javascript, mysql, google-maps

我在 SQL 数据库中有 100K+ 纬度/经度，我想将它们绘制在谷歌地图上。用户将输入地址以查找靠近该地址的点。我该怎么做？我有地图工作，用户可以输入地址并将地图中心放在这一点上。只需要添加引脚。

我将在 JS 中构建前端，在 PHP 中构建任何后端需求。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-12T12:59:18.757

让我们从搜索地址开始，我会使用[Google Places API](https://developers.google.com/places/documentation/search)。这将允许您本地化您的结果并获取相关地点的坐标。

一旦你有了坐标，我就会去服务器进行查找，如果你使用的是 MySQL，你可以使用它们的空间扩展，这些扩展有一些方便的方法在空间上索引事物。

你说你有 100k 个项目，obv 没有办法将它们全部发送到前端显示在地图上，你需要限制你的结果集，否则用户浏览器会在尝试时流下血泪渲染和处理所有这些。您可以查看[Google Maps Marker Clusterer](http://google-maps-utility-library-v3.googlecode.com/svn/trunk/markerclusterer/docs/examples.html)，了解一种显示高密度标记的好方法。

# linux - 我应该在我的服务器存储库的 svn 中看到所有新添加的文件吗？

> ID：12379758
> 
> 赞同：0
> 
> 时间：2012-09-12T00:32:30.287
> 
> 标签：linux, svn

我在我的服务器中创建了一个新项目，`svn svnadmin create /myrepo`我使用我的客户端进行了结帐并添加了新文件，然后进行了提交，因此，如果我从另一台计算机上结帐，我会得到最近添加的文件，这很完美，但是在我的文件夹 /myrepo 仍然没有文件，从我的客户端添加的所有新文件都在那里不可见，我知道他们实现了许多算法来进行版本控制，我的问题是，我应该能够看到所有添加的新文件来自我服务器中的 /myrepo ，无需与客户端或类似的东西进行结帐？

我想知道我的文件在我的服务器上的保存位置，谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-12T00:39:14.463

不会。文件存储在您创建的存储库中，但存储在专门的数据库中。如果你去`myrepo`查看 db 文件夹，你会看到那里存储了修订文件。这些文件及时包含特定实例的存储库的结构和数据。[Subversion book](http://svnbook.red-bean.com/en/1.7/svn.reposadmin.basics.html)有一些关于结构的信息。您还可以查看实际 Subversion 存储库中[有关](http://svn.apache.org/repos/asf/subversion/trunk/subversion/libsvn_fs_fs/structure)用于存储数据的结构的文档。

# rest - WSo2 治理注册表

> ID：12379759
> 
> 赞同：0
> 
> 时间：2012-09-12T00:32:35.607
> 
> 标签：rest, wso2, registry, wso2carbon, wso2greg

我正在为我们的 SOA 治理解决方案评估 WSO2。几个问题

1.  它提供了一种记录服务的方法。有没有办法记录 WSDL 中列出的每个操作或 RESTful 服务的资源？我无法找到此信息。

2.  如何提供有关 RESTful 服务的信息？

3.  有政策执行吗？

* * *

感谢所有的回复。我确实看过 API 管理器。看起来不错，但有几个问题

1.  我找不到为各种环境记录端点的方法。仅支持 2 个 URL - 用于沙盒和生产。如何为更多环境提供 url？

2.  是否可以自定义生命周期？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-12T15:59:03.103

在 SOA 部署中，您可以使用 WSO2 ESB 作为 PEP（策略执行点）。请关注[本文](http://wso2.org/library/articles/2011/08/finegrained-authorization-restful-services-xacml)了解更多详情。在这种部署中，您可以使用已安装的 WSO2 Governance Registry 服务器作为策略存储。这将有助于您维护中央存储库中的服务策略以及版本控制、生命周期管理、通知等治理功能。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-12T08:24:54.713

对我来说，听起来您可能想看看 Wso2 API Manager 1.0，实际上它提供了一个很好的界面来为“发布者”端的 API 编写文档。

此外，您将拥有用户使用 Restful 服务所需的所有信息 + API 密钥以在 API 管理器的“存储”端进行身份验证。

您不必担心 G-Reg，因为 API 管理器已经包含一个并允许您轻松管理您的 SOA 服务。

希望这可以帮助

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-12T06:42:51.987

1.  2\. 您可以定义自己的元数据，这意味着您可以存储任何数据（新数据类型是通过您上传到服务器的 XML 定义的），wso2 团队提供了一个教程，其中包含如何做到这一点的示例。

2.  恐怕我不明白您在 3 中的意思。您是否希望不同的用户能够创建不同类型的工件？

这是我发现有用的教程：[http ://www.youtube.com/watch?v=pXfxiZlOtH0](http://www.youtube.com/watch?v=pXfxiZlOtH0)

您还可以在 wso2 网站上找到文档

# css - 类在css中的不同场合使用不同

> ID：12379760
> 
> 赞同：-1
> 
> 时间：2012-09-12T00:32:35.597
> 
> 标签：css

为什么我们有时会使用类似的语法

```
.oneclass .someotherclass {

} 
```

而有时

```
.oneclass.someotherclass {

} 
```

注意在第二个中 oneclass 和 someotherclass 之间没有空格

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-12T00:35:18.543

该空间是一个后代选择器。 `a b`匹配`b`在`a`.

没有空格，它只是一个“和”。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-12T00:35:25.400

因为它们的意思不同。第一个用于在具有第一类的元素中具有第二类的元素。第二个是用于两个类的元素。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-12T00:36:22.833

第一个目标`.someotherclass`是下面`.oneclass`，而第二个目标是一个元素，两者都有。例如，第一个将针对，`<div class='oneclass'><div class='someotherclass'></div></div>`而第二个将针对`<div class='oneclass someotherclass'/>`

# azure - 我可以使用 .NET 3.5 构建 Azure 服务总线客户端和服务器应用程序吗？

> ID：12379761
> 
> 赞同：0
> 
> 时间：2012-09-12T00:32:38.010
> 
> 标签：azure

我的应用程序必须是 .net 3.5。我想使用 azure 服务总线中继来促进机器对机器的通信。我发现的所有示例都需要 .NET 4.0（NuGet 包）。有谁知道我是否可以使用 .net 3.5 还是我在浪费时间评估 azure？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-12T06:47:42.797

您还可以使用 REST API 并简单地使用[WebClient](http://rickgaribay.net/archive/2012/01/19/common-service-bus-queue-operations-with-the-rest-api.aspx)类与服务总线进行交互。请注意，[并非所有功能](http://msdn.microsoft.com/en-us/library/windowsazure/hh780771)都受 REST API 支持。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-12T02:10:18.287

我们确实有一个面向 .NET 35 的服务总线客户端 SDK：http: [//www.microsoft.com/en-us/download/details.aspx?id=19925](http://www.microsoft.com/en-us/download/details.aspx?id=19925)

您可以安装 SDK MSI，然后使用其中包含的 Microsoft.ServiceBus.dll。请注意，此 msi 将修改您 machine.config 等中的一些设置。

# r - 没有 gsub 的 sprintf 使用

> ID：12379767
> 
> 赞同：0
> 
> 时间：2012-09-12T00:33:30.480
> 
> 标签：r, printf

`sprintf`在没有`gsub`for 这行代码的情况下使用更优雅的方式是什么？

```
gsub(" ","0",sprintf("%2.d", 0:15))
[1] "00" "01" "02" "03" "04" "05" "06" "07" "08" "09" "10" "11" "12" "13" "14" "15" 
```

即我希望单个数字前面的零...作为字符输出。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-12T00:37:36.977

在格式字符串中使用 a`0`来填充前导零而不是空格：`sprintf("%02d", 0:15)`

# html - CSS / HTML5 形状补间 / 变形？

> ID：12379768
> 
> 赞同：0
> 
> 时间：2012-09-12T00:33:38.053
> 
> 标签：html, animation, css

我发现了使用动画来转换 css 形状的方法，比如这里展示的动画：http: [//matthewlein.com/ceaser/](http://matthewlein.com/ceaser/)

有谁知道是否有可能使用 CSS 或其他非 Flash 代码获得更高级的效果，以创建更复杂的动画 - 甚至在 Mac OS 工具栏上最小化或最大化窗口时看到的效果线？

这是可能的还是超出了使用css的可能性范围？

谢谢，

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-12T14:39:29.217

这应该足以让你开始：http: [//jsfiddle.net/9BTPy/](http://jsfiddle.net/9BTPy/)

请注意，为了简单起见，我只为 Firefox 制作了一个示例。否则代码会变得太大。这也不是您问题的影响，但您应该明白这一点。

另请参阅以下链接以获取文档和其他示例：

*   [http://css3please.com/](http://css3please.com/)
*   [http://www.w3schools.com/cssref/css3_pr_keyframes.asp](http://www.w3schools.com/cssref/css3_pr_keyframes.asp)
*   [http://www.w3schools.com/cssref/css3_pr_animation.asp](http://www.w3schools.com/cssref/css3_pr_animation.asp)

**补充笔记：**

如果你真的必须这样做，那么使用 jQuery-Animations 会更好。对不同浏览器的支持更好，做你描述的效果可能更简单。维护起来也更好。:)

# asp.net-mvc-4 - ASP.NET MVC 4 返回 Json 导致双 json 或空数据

> ID：12379772
> 
> 赞同：2
> 
> 时间：2012-09-12T00:34:46.780
> 
> 标签：asp.net-mvc-4, json.net, jsonresult

***我得到空的 Json 结果或双 json 结果，我还不知道为什么？***

基线： [http](http://learn.knockoutjs.com/mail?folder=Inbox) ://learn.knockoutjs.com/mail? folder=Inbox 在 chrome F12 中看起来像这样：{"id":"Inbox","mails":[{"id":1,.... ..}

我的行动：

```
public ActionResult Mail()
{
    string qs = "";
    foreach (var q in Request.QueryString)
    {

        qs += string.Format("{0}={1}&", q, Request.QueryString[q.ToString()]);
    }
    var proxyRequest = "http://learn.knockoutjs.com/mail?" + qs;
    var request = WebRequest.Create(proxyRequest);
    var response = (HttpWebResponse)request.GetResponse();

    var reader = new StreamReader(response.GetResponseStream());
    var str = reader.ReadToEnd();
    var data = Newtonsoft.Json.JsonConvert.DeserializeObject<dynamic>(str);

    //var json = JsonConvert.SerializeObject(data);  
        // Text Visualization looks good {"id":"Inbox","mails":[{"id":1,"from":"Abb....}
        // no outside quotes, no escaped quotes

        var res = Json(data, JsonRequestBehavior.AllowGet);
        return res;

} 
```

所以基本上我是在代理调用，但问题是为什么返回的结果要么没有填写，要么是双 jsoned。

使用 chrome 网络跟踪上面的结果看起来像。[[[]],[[[[[]],[[]],[[]],[[]],[[]],...]

有效的 json，只是空的。

当我将代码更改为这样时

```
var json = JsonConvert.SerializeObject(data);  
// Text Visualization looks good {"id":"Inbox","mails":[{"id":1,"from":"Abb....}
// no outside quotes, no escaped quotes

var res = Json(json, JsonRequestBehavior.AllowGet);
return res; 
```

Chrome 网络跟踪已将数据翻倍。"{\"id\":\"收件箱\",\"邮件\":[{\"id\":1,\"from\":\"Ab....}"

由于我不知道 Json 实际上是什么，所以我做了牛顿软动态转换 JsonConvert.DeserializeObject

这可能是我空洞回应背后的问题？

任何帮助将不胜感激。谢谢

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-12T00:36:23.647

您的第一个方法失败了，因为`Json()`不理解从您的 JSON 阅读器返回的动态对象。
您的第二种方法失败了，因为`Json()`正在序列化预序列化的字符串。

您可以使用返回预序列化的 JSON 数据`Content(jsonString, "application/json")`

# scala - Scala Play 框架中的重载方法错误

> ID：12379774
> 
> 赞同：0
> 
> 时间：2012-09-12T00:35:02.097
> 
> 标签：scala, playframework, compiler-errors, playframework-2.0

我正在编写一种在用户进行身份验证后正确设置会话 cookie 的方法。如下设置 cookie 不起作用。以下代码段导致“withSession”调用出错：

**重载的方法值 [withSession] 不能应用于 ((String, Long))**

代码：

```
/**
 * Process login form submission.
 */
def authenticate = Action { implicit request =>
  loginForm.bindFromRequest.fold(
    formWithErrors => BadRequest(views.html.login(formWithErrors)),
    credentials => {
      val user = models.User.findByEmail(credentials._1)

      user match {
        case Some(u) => {
          Redirect(routes.Dashboard.index).withSession(Security.username -> u.id)
        }
        case None => Redirect(routes.Auth.login)
      }
    }
  )
} 
```

'credentials' 只是一个包含用户提交的电子邮件和密码的元组。如果我摆脱了“withSession”部分，那么它运行良好。如果我将“重定向”语句从模式匹配代码中移出，则可以正常工作。为什么它不能像我上面所说的那样工作，我该如何解决？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-12T05:27:22.743

我认为 withSession 需要一个字符串，字符串

看看[http://www.playframework.org/documentation/api/2.0.3/scala/index.html#play.api.mvc.SimpleResult](http://www.playframework.org/documentation/api/2.0.3/scala/index.html#play.api.mvc.SimpleResult)

```
def withSession(session: (String, String)*): PlainResult = withSession(Session(session.toMap)) 
```

# prolog - 数据记录分层

> ID：12379775
> 
> 赞同：6
> 
> 时间：2012-09-12T00:35:07.797
> 
> 标签：prolog, logic, datalog

因此，我试图了解 Datalog 的工作原理，它与 Prolog 之间的区别之一是它在否定和递归上具有分层限制。引用维基百科：

> 如果谓词 P 是从谓词 Q 正派生的（即 P 是规则的头部，并且 Q 正出现在同一规则的主体中），则 P 的分层数必须大于或等于分层Q的数量
> 
> 如果谓词 P 是从否定谓词 Q 派生的（即 P 是规则的头部，并且 Q 否定出现在同一规则的主体中），则 P 的分层数必须大于 Q 的分层数,

因此，这样下去，以下两个谓词不会导致分层错误，因为它们可以简单地分配相同的分层编号。所以这些谓词很好，尽管有循环定义。

1.  A(x) :- B(x)
2.  B(x) :- A(x)

但是，如果我们有一个包含一些否定的定义（其中〜是否定），则会发生什么对比

1.  A(x) :- ~ B(x)
2.  B(x) :- ~ A(x)

在这里分层是不可能的。A(x,y) 的分层数必须大于 B(x,y)，B(x,y) 的分层数必须大于 A(x,y)。我的第一个想法是这不好，因为这是一个循环定义，但只要谓词不被否定，分层就可以循环。但为什么？真值只是二进制的。以这种方式对具有否定符号的公式进行不同的处理似乎是非常武断的。在第二种情况下，这种分层试图防止在第一种情况下是什么？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-09-18T05:25:35.240

我认为问题在于：

> A(x) :- \+ B(x)
> 
> B(x) :- \+ A(x)

...是它具有模棱两可的语义。该程序有两个*最小模型*，`{A(x)}`和`{B(x)}`，因此在不*动点语义*（无不动点）或*模型理论语义*（无唯一最小模型）下定义不明确。

为了解决这个问题， Datalog 的*分层语义*对 Datalog 程序的语法施加了限制，这样，如果程序存在*分层*，那么它在不动点和模型理论语义中也将具有唯一的最小模型（反之亦然，我相信）。

*您可以在“数据库基础”*一文中找到更多关于 Datalog 分层语义的详细信息，该文本恰好可以[在线](http://webdam.inria.fr/Alice/)免费获得，相关细节在[第 15 章](http://webdam.inria.fr/Alice/pdfs/Chapter-15.pdf)。这篇优秀的文章还解释了我在上面使用的大多数其他术语，如模型、定点等，如果你被卡住了。

# android - 如何获取所有已安装小部件的 ID？

> ID：12379779
> 
> 赞同：4
> 
> 时间：2012-09-12T00:35:24.810
> 
> 标签：android, android-appwidget

我需要找到任何 AppWidget id 来测试一些功能。执行此操作的代码：

```
List<AppWidgetProviderInfo> infos = mAppWidgetManager.getInstalledProviders();

        for (int i = 0; i < infos.size(); i++) {
            int ids[] = mAppWidgetManager.getAppWidgetIds(infos.get(i).provider);
            if (ids.length != 0) {
                Log.d("TAG", "Found non-zero-length provider!");
                id = ids[0];
                info = infos.get(i);
                break;
            }
        } 
```

但 ids[] 长度始终为 0！为什么以及如何解决它？

更新：我已将此行添加到循环的开头：

```
Log.d("TAG", provider.getPackageName() + "; " + provider.getClassName()); 
```

它打印：

```
D/TAG     ( 5686): Providers count: 12
D/TAG     ( 5686): com.andrew.apollo; com.andrew.apollo.app.widgets.AppWidget11
D/TAG     ( 5686): com.andrew.apollo; com.andrew.apollo.app.widgets.AppWidget41
D/TAG     ( 5686): com.andrew.apollo; com.andrew.apollo.app.widgets.AppWidget42
D/TAG     ( 5686): com.android.browser; com.android.browser.widget.BookmarkThumbnailWidgetProvider
D/TAG     ( 5686): com.android.calendar; com.android.calendar.widget.CalendarAppWidgetProvider
D/TAG     ( 5686): com.android.contacts; com.android.contacts.socialwidget.SocialWidgetProvider
D/TAG     ( 5686): com.android.deskclock; com.android.alarmclock.AnalogAppWidgetProvider
D/TAG     ( 5686): com.android.email; com.android.email.provider.WidgetProvider
D/TAG     ( 5686): com.android.gallery3d; com.android.gallery3d.gadget.PhotoAppWidgetProvider
D/TAG     ( 5686): com.android.quicksearchbox; com.android.quicksearchbox.SearchWidgetProvider
D/TAG     ( 5686): com.android.settings; com.android.settings.widget.SettingsAppWidgetProvider
D/TAG     ( 5686): com.android.vending; com.android.vending.MarketWidgetProvider 
```

所以，这似乎没问题，但我仍然无法获得这个小部件的 id。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-12T00:53:32.653

确保`ComponentName`您用于获取`AppWidgetManager`匹配清单中的小部件提供程序。如果没有，您将得到一个空列表（ids.length = 0，循环不会执行）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2014-08-12T23:40:24.703

我的小部件有不同的布局和大小，因此不同的小部件提供者检索所有 id 并不是那么简单。要获取所有小部件提供商的所有小部件 ID，您可以执行以下操作：

```
 AppWidgetManager appWidgetManager = AppWidgetManager.getInstance(context);
    int Widged_IDS_A[] = appWidgetManager.getAppWidgetIds(new ComponentName(context, WidgetProviderA.class));
    int Widged_IDS_B[] = appWidgetManager.getAppWidgetIds(new ComponentName(context, WidgetProviderB.class));
    int Widged_IDS_C[] = appWidgetManager.getAppWidgetIds(new ComponentName(context, WidgetProviderC.class));
    int Widged_IDS_D[] = appWidgetManager.getAppWidgetIds(new ComponentName(context, WidgetProviderD.class));
    int Widged_IDS_E[] = appWidgetManager.getAppWidgetIds(new ComponentName(context, WidgetProviderE.class));

    int allWidgetIds[] = new int[Widged_IDS_A.length + Widged_IDS_B.length + Widged_IDS_C.length + Widged_IDS_D.length + Widged_IDS_E.length];

    System.arraycopy(Widged_IDS_A, 0, allWidgetIds, 0, Widged_IDS_A.length);
    System.arraycopy(Widged_IDS_B, 0, allWidgetIds, Widged_IDS_A.length, Widged_IDS_B.length);
    System.arraycopy(Widged_IDS_C, 0, allWidgetIds, Widged_IDS_A.length + Widged_IDS_B.length, Widged_IDS_C.length);
    System.arraycopy(Widged_IDS_D, 0, allWidgetIds, Widged_IDS_A.length + Widged_IDS_B.length + Widged_IDS_C.length, Widged_IDS_D.length);
    System.arraycopy(Widged_IDS_E, 0, allWidgetIds, Widged_IDS_A.length + Widged_IDS_B.length + Widged_IDS_C.length + Widged_IDS_D.length, Widged_IDS_E.length);
    Log.v(Classname, "allWidgetIds.length: " + allWidgetIds.length);

    allWidgetIds = merge(Widged_IDS_A, Widged_IDS_B, Widged_IDS_C, Widged_IDS_D, Widged_IDS_E);
    for (int x : allWidgetIds) {
         Log.v(Classname, x + " allWidgetIds onReceive()");
    } 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2021-09-09T20:08:35.237

在科尔廷像这样：

```
val widgetManager = AppWidgetManager.getInstance(context).getAppWidgetIds(ComponentName(context, MyAppWidget::class.java)) 
```

# java - 使用 Java 将特定字符串写入文件

> ID：12379780
> 
> 赞同：-1
> 
> 时间：2012-09-12T00:35:51.423
> 
> 标签：java

我的代码似乎没有正确解决我打算实现的目标。

*   一根长绳子，而不是一根断裂且分开的绳子
*   它没有适当地处理“分隔符”（产生，而不是“，”）
*   还有'可选'（产生'而不是“'”）

当前结果：

```
LOAD DATA INFILE 'max.csv'BADFILE 'max.bad'DISCARDFILE 
'max.dis' APPEND INTO TABLEADDRESSfields terminated by,optionally enclosed  
 by'(ID,Name,sex) 
```

预期的结果应该是这样的

有没有更好的方法来做到这一点或改进上述代码

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-12T00:42:18.407

是的。使用该字符`\n`在文件中开始一个新行，并将`"`字符转义为`\"`. 此外，您需要在每个变量后添加一个空格。

```
content = " LOAD DATA\nINFILE "+ fileName + " BADFILE "+ badName + " DISCARDFILE " + 
discardName + "\n\nAPPEND\nINTO TABLE "+ table + "\n fields terminated by \"" + separator 
+ "\" optionally enclosed by '" + optional + "'\n (" + column + ")"; 
```

这是假设`fileName`, `badName`, 并`discardName`在名称周围加上引号。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-12T00:42:18.900

不要重新发明轮子...... [apache commons-io 库](http://commons.apache.org/io/)在一行中完成所有这些：

```
FileUtils.write(new File(controlName), content); 
```

这是javadoc [`FileUtils.write(File, CharSequence)`](http://commons.apache.org/io/api-release/org/apache/commons/io/FileUtils.html#write%28java.io.File,%20java.lang.CharSequence%29)：

> 如果文件不存在，则将 CharSequence 写入创建文件的文件

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-12T00:58:30.390

例如，要插入新行，您需要在 windows 中使用 \n 或 \r\n

```
 discardName + "\n"  //New line here
"APPEND INTO TABLE" 
```

另一方面，对于双引号符号，您需要在逗号周围专门键入 \"：

```
"fields terminated by \"" + separator +"\"" 
```

这将产生这个“，”，这类似于可选变量需要是什么

# objective-c - associatedValueForKey，无法识别的键

> ID：12379785
> 
> 赞同：1
> 
> 时间：2012-09-12T00:37:06.660
> 
> 标签：objective-c, automatic-ref-counting, nsobject, objective-c-runtime

如果我没有使用“objc_setAssociatedObject”将对象/键关联到 NSObject，然后我调用“objc_getAssociatedObject”，这样安全吗？

我已经在模拟器中测试过它并没有崩溃，但我想确定一下。

当我打电话时：

```
 objc_setAssociatedObject(self, key, value, OBJC_ASSOCIATION_RETAIN); 
```

当我的 NSObject 被释放时，我与我的 NSObject 关联的对象是否会被释放？（我正在使用ARC）。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-12T03:01:43.997

如果没有关联到位，`objc_getAssociatedObject`将返回`nil`。

当您关联一个对象时，它将使用最后一个参数中提供的语义。例如，`OBJC_ASSOCIATION_RETAIN`将保留对象，因此只要关联存在，它就不会被释放。

当持有关联的对象（第一个参数`objc_setAssociatedObject`）释放时，它会破坏关联。当关联被破坏时，保留的对象将被释放（如果它一开始就被保留）。

因此，对于您的示例：

```
objc_setAssociatedObject(self, key, value, OBJC_ASSOCIATION_RETAIN); 
```

`value`将被保留，直到关联被破坏。当`self`解除分配或与另一个关联更改时，关联将被破坏`objc_setAssociatedObject`。

# android - 尝试使用 Maven 创建 Android 应用程序的构建失败

> ID：12379788
> 
> 赞同：0
> 
> 时间：2012-09-12T00:37:38.903
> 
> 标签：android, maven, project, maven-3

我正在尝试使用 Maven 创建一个 Android 应用程序，如[本博客中所述](http://blog.akquinet.de/2011/01/14/starting-android-application-development-with-apache-maven/#WT)

我在 Windows 命令提示符下尝试了以下命令，但出现“构建失败”，为什么？

```
C:\Users\abc\Desktop>mvn archetype:generate -DarchetypeArtifactId=android-qui
ckstart \ -DarchetypeGroupId=de.akquinet.android.archetypes \ -DarchetypeVersion
=1.0.8 \ -DgroupId=com.yourcompany \ -DartifactId=yourandroidapp
[INFO] Scanning for projects...
[INFO] ------------------------------------------------------------------------
[INFO] BUILD FAILURE
[INFO] ------------------------------------------------------------------------
[INFO] Total time: 0.143s
[INFO] Finished at: Wed Sep 12 05:58:36 IST 2012
[INFO] Final Memory: 2M/56M
[INFO] ------------------------------------------------------------------------
[ERROR] The goal you specified requires a project to execute but there is no POM
 in this directory (C:\Users\abc\Desktop). Please verify you invoked Maven fr
om the correct directory. -> [Help 1]
[ERROR]
[ERROR] To see the full stack trace of the errors, re-run Maven with the -e swit
ch.
[ERROR] Re-run Maven using the -X switch to enable full debug logging.
[ERROR]
[ERROR] For more information about the errors and possible solutions, please rea
d the following articles:
[ERROR] [Help 1] http://cwiki.apache.org/confluence/display/MAVEN/MissingProject
Exception 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-12T02:16:26.823

反斜杠 \ 表示 Linux shell 命令中的换行符，如果您在 Windows 上运行，只需将其删除：

```
mvn archetype:generate -DarchetypeArtifactId=android-quickstart -DarchetypeGroupId=de.akquinet.android.archetypes -DarchetypeVersion=1.0.8 -DgroupId=com.yourcompany -DartifactId=yourandroidapp 
```

您将准备好出发。

# php - $_SERVER['REMOTE_ADDR' 字符串和更改子网

> ID：12379789
> 
> 赞同：0
> 
> 时间：2012-09-12T00:37:44.393
> 
> 标签：php, ip

我想扩展我的 ~$_SERVER['REMOTE_ADDR'~ 检查的 IP 范围。以下内容有效且仅允许 10.0.4.* 子网访问该站点：

```
$chk = "10.0.4.";
if( substr($_SERVER['REMOTE_ADDR'],0,strlen($chk)) !== $chk)
    $wgGroupPermissions['*']['read'] = false; 
```

当我修改`$chk`字符串以将站点打开到我的整个本地网络时，我最终将站点打开到整个世界。

```
$chk = "10.0.";
if( substr($_SERVER['REMOTE_ADDR'],0,strlen($chk)) !== $chk)
    $wgGroupPermissions['*']['read'] = false; 
```

我只希望我的本地子网 10.0.. 具有对该站点的读取权限。我该怎么做呢？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-12T01:50:47.300

使用掩码是比拆分字符串更好的方法：

```
function testSubnet($ip, $subnet, $mask) {
    $ip = ip2long($ip);
    $subnet = ip2long($subnet);
    $mask = ip2long($mask);
    return ($ip & $mask) == ($subnet & $mask);
}

var_dump(testSubnet('10.0.0.1', '10.0.0.0', '255.255.255.0'));
var_dump(testSubnet('10.0.0.2', '10.0.0.0', '255.255.255.0'));
var_dump(testSubnet('10.0.1.1', '10.0.0.0', '255.255.255.0'));
var_dump(testSubnet('10.0.1.1', '10.0.0.0', '255.255.0.0')); 
```

* * *

在这种情况下：

```
if(testSubnet($_SERVER['REMOTE_ADDR'], '10.0.4.0', '255.255.255.0')) {
    // Anything, blablabla...
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-12T01:22:56.057

为什么你不能这样做：

```
$z = $_SERVER['REMOTE_ADDR'];

function check($ip, $octet = 2) {
    $allow = explode(".", "10.0.0.1");
    $ipa = explode(".", $ip);

    for($i = 0; $i < $octet; $i++) {
        $ch .= $ipa[$i];
        $ah .= $allow[$i];
    }

   return $ch == $ah;
 }

echo check($z); 
```

其中 $octet 是您要匹配的八位字节数。默认值为 2。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-12T01:27:15.820

你能用这个`header()`功能吗？尝试这个。

```
$allowed_ip = "10.0.4";
if (!strstr($_SERVER['REMOTE_ADDR'],$allowed_ip))
   header("Location: login.php");
   // include("login.php");

/* The user will be redirected to another page or you could
always include your login.php page and just continue from there. */ 
```

# php - 使用 PHP 进行数组排序

> ID：12379791
> 
> 赞同：-1
> 
> 时间：2012-09-12T00:38:10.540
> 
> 标签：php, arrays, sorting

有没有办法在 PHP 中使用描述符进行以下排序：

**阵列 1：**

> $array1 = [“废话”，“嘎嘎”，“yot”]；

**阵列 2**

`$array2 = [1,9,6];`本质上，我试图用 1 来描述 blah，用 9 来描述 quack，用 6 来描述 yot。基本上，总共有 1 blahs、9 quacks 和 6 yots。当我对数组进行排序时，我想生成以下数组：

**数组 1 排序：**

```
$array1 = ["quack","yot","blah"]; 
```

**数组 2 排序：**

```
$array2 = [9,6,1]; 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-12T00:41:19.453

```
array_multisort($array2, SORT_DESC, $array1); 
```

[http://ideone.com/4Afyu](http://ideone.com/4Afyu)

[http://php.net/array_multisort](http://php.net/array_multisort)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-12T00:43:10.787

您可以使用 对数组进行排序[`usort`](http://php.net/usort)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-12T01:00:18.307

好吧，您可以将数据重组为关联数组。

$var = array ('blah'=>1, 'quack'=>9, 'yot'=>6);

这样您的数据就在一个数组中。然后您可以使用 asort 或任何 php 排序函数来操作数组。

# c# - Mailchimp 活动发送错误 - 此活动已发送，无法再次发送

> ID：12379793
> 
> 赞同：5
> 
> 时间：2012-09-12T00:38:16.503
> 
> 标签：c#, asp.net, mailchimp, perceptivemcapi

我有一个 Mailchimp RSS 活动，它读取网站上的 RSS 提要并设置为每天一次。在我将项目添加到提要后，我想以编程方式发送此广告系列。

我正在使用 PerceptiveMCAPI，我的触发活动的代码是

```
campaignSendNowInput campaignSendNowInput = new campaignSendNowInput(apiKey, campaignKey);
campaignSendNow campaignSendNow = new campaignSendNow(campaignSendNowInput);
campaignSendNowOutput campaignSendNowOutput = campaignSendNow.Execute(); 
```

我收到的错误看起来像

```
"Error Code: 313, Message: This Campaign has already been sent and can not be sent again." 
```

关于什么会导致这种情况的任何想法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-15T05:51:36.690

好吧，我想在多看一点之后，我最初的逻辑是错误的。我认为正确的方法是每次都创建一个新的广告系列，然后发送这个新的广告系列。广告系列旨在发送一次。

Mailchimp 中的 RSS 提要公告仅限于每天一次，因此您需要使用标准活动，您可以以编程方式创建并发送该活动。如果内容来自 RSS 提要至关重要，您仍然可以使用 RSS 合并标签来使用 RSS 提要。

# assembly - LNK 2001 未解析的外部符号 _mainCRTStartup MASM

> ID：12379794
> 
> 赞同：5
> 
> 时间：2012-09-12T00:38:22.193
> 
> 标签：assembly, linker, masm, irvine32

我正在我的大学学习汇编，我们得到了一张带有 MASM 615 的 CD，我们正在使用 Irvine32 包含库。在学校计算机上一切正常，但是当我尝试在家用计算机上编译和运行相同的代码时，出现链接错误。

```
INCLUDE Irvine32.inc

.code
main PROC

mov eax,10000h      ; EAX = 10000h
add eax,40000h      ; EAX = 50000h
sub eax,20000h      ; EAX = 30000h
call DumpRegs

exit
main ENDP
END main 
```

此代码在学校的 PC 上运行良好。在家里，我进入 DOS，设置 MASM 文件夹的路径，然后做 Make32 文件。

这是我得到的错误：

```
LINK32 : error LNK2001: unresolved external symbol _mainCRTStartup
test.exe : fatal error LNK1120: 1 unresolved externals 
```

程序编译（我得到 .lst、.obj 和 .pdb 文件），仅此而已。我在想这是因为我家里有一个 64 位操作系统，但我对如何在 64 位环境中启动和运行它一无所知——CD 或书在 64 位系统上没有任何内容。只有一个 make16 或 make32 .bat 文件。这真的很糟糕，因为这意味着我不能在家做任何工作，除非有工作？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2016-02-27T19:01:24.563

其他答案让我感到困惑，所以我将添加我的解决方案。在项目的属性中转到

**配置属性>>链接器>>高级**

在**高级**中，顶部应该是入口点。输入`main`.

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-09-12T15:08:28.640

我认为您可能需要手动指定入口点，因为 Windows 上的默认入口符号不是 _main 而是错误消息中的 _mainCRTStartup 之一。[您可以在链接器选项中使用/ENTRY](https://msdn.microsoft.com/en-us/library/f9t8842e.aspx) :entry_point （程序集中的某些过程）指定入口点。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-07-27T15:00:15.037

我知道它有点晚了——也许它对某人有帮助——但你应该公开 main ，像这样

```
INCLUDE Irvine32.inc

.code
main PROC

mov eax,10000h      ; EAX = 10000h
add eax,40000h      ; EAX = 50000h
sub eax,20000h      ; EAX = 30000h
call DumpRegs

exit
main ENDP

PUBLIC main

END 
```

注意倒数第二行

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2015-07-30T02:37:52.153

尝试包括这个

```
includelib  \Irvine\Irvine32.lib
includelib  \Irvine\User32.lib
includelib  \Irvine\kernel32.lib 
```

# java - 解析 JSON 并从中删除对象会出错

> ID：12379797
> 
> 赞同：1
> 
> 时间：2012-09-12T00:38:59.157
> 
> 标签：java, javascript, jquery, json, cordova

我有一个 phonegap 应用程序，我想在下载之前修剪图片。我将一个 JSON 对象传递给我的函数，它是

```
[{"name":"aaa.jpg","link":"https:\/\/www.abc.com\/aaa.jpg"},"name":"bbb.jpg","link":"https:\/\/www.abc.com\/\/bbb.jpg"}] 
```

并使用以下函数解析和删除

```
function prunePictures(pictures) {
    for ( var i = 0; i < entries.length; ++i) {
            var name = entries[i].name;
            $.each(pictures, function(i, obj) {
                if (obj.name == name) {
                    delete pictures[i];
                }
            });
     }
} 
```

但它没有通过循环，我收到一个错误“无法读取未定义的属性'名称'”

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-12T00:49:23.533

...您不想删除图片对象。你想把它从数组中拼接出来。

删除它会在阵列中留下一个洞，而拼接它会删除这个洞。

```
var l = entries.length, i = 0, pictureName;

for (; i < l; i += 1) {
    pictureName = entries[i].name;
    pictures.forEach(function (picture, i, arr) {
        if (pictureName === picture.name) { arr.splice(i, 1); }
    });
} 
```

`name`如果实体中的对象具有相同的属性，则删除图片中的对象。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-12T00:40:57.653

您的 json 字符串缺少大括号：

```
[{"name":"aaa.jpg","link":"https:\/\/www.abc.com\/aaa.jpg"},{"name":"bbb.jpg","link":"https:\/\/www.abc.com\/\/bbb.jpg"}] 
```

### 编辑

我认为你的 json 只是有一个错字，因为这不是你会得到的错误。

您不应该从 a 中删除，`$.each`而是应该使用`$.grep`

[在这里](http://api.jquery.com/jQuery.grep/)查看信息

```
pictures = $.grep(pictures, function(obj,i) {
    if (obj.name == name) {
        return false;
    }
    return true;
}); 
```

# java - JSP，SQL检索返回null的数据

> ID：12379798
> 
> 赞同：0
> 
> 时间：2012-09-12T00:39:11.137
> 
> 标签：java, sql, jdbc

为什么视图返回 null ？提前致谢。

这是我的观点jsp

```
String abb = "ab";
String cdd = "cd";
UserPass user = UserDb.selectUser(abb,cdd);
out.println(user); 
```

这是我的 UserPass 课程

```
public class UserPass {
    String username;
    String password;

    public UserPass(){
       this.username ="";
       this.password ="";     
    }

    public void setUserName(String username) {
       this.username = username;
    }

    public String getUserName(){ 
       return username;
    }
} 
```

最后是数据包，UserDb

```
String query = "select user_name from UserPass where user_name = ? AND user_password = ? " ;

try{
    ps = connection.prepareStatement(query);
    ps.setString(1, username);
    ps.setString(2, password);

    rs = ps.executeQuery();

    if (rs.getString("user_name") != null) {
        UserPass up = new UserPass();
        up.setUserName(rs.getString("user_name"));
        return up;

    } else {
        return null;
    }
} 
```

我的数据库很简单，条目是 user_name 和 user_password。视图返回 null

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-12T00:41:34.117

您需要先使用[rs.next()](http://docs.oracle.com/javase/7/docs/api/java/sql/ResultSet.html#next%28%29)来检查当前行是否有效：

```
rs = ps.executeQuery();
if (rs.next()) {
    UserPass up = new UserPass();
    up.setUserName(rs.getString("user_name"));
    return up;
} else {
    return null;
} 
```

# php - 使用 cURL 在 PHP 中同时发出 HTTP 请求

> ID：12379801
> 
> 赞同：1
> 
> 时间：2012-09-12T00:40:17.450
> 
> 标签：php, loops, curl

我正在尝试获取一个相当大的域列表来查询每个使用compete.com API的排名，如下所示-> [https://www.compete.com/developer/documentation](https://www.compete.com/developer/documentation)

我编写的脚本需要一个我填充的域数据库，并启动一个 cURL 请求来竞争网站的排名。我很快意识到这非常慢，因为每次发送一个请求。我做了一些搜索，发现了这篇文章-> [http://www.phpied.com/simultaneuos-http-requests-in-php-with-curl/](http://www.phpied.com/simultaneuos-http-requests-in-php-with-curl/)，它解释了如何在 PHP 中使用 cURL 执行同步 HTTP 请求。

不幸的是，该脚本将采用包含 25,000 个域的数组并尝试一次处理它们。我发现 1,000 个批次的效果很好。

***知道如何向competition.com 发送1,000 个查询然后等待完成并发送下一个1,000 直到数组为空吗？***到目前为止，这是我正在使用的内容：

```
<?php

//includes
include('includes/mysql.php');
include('includes/config.php');

//get domains
$result = mysql_query("SELECT * FROM $tableName");
while($row = mysql_fetch_array($result)) {
    $competeRequests[] = "http://apps.compete.com/sites/" . $row['Domain'] . "/trended/rank/?apikey=xxx&start_date=201207&end_date=201208&jsonp=";
}

//first batch
$curlRequest = multiRequest($competeRequests);
$j = 0;
foreach ($curlRequest as $json){
    $j++;
    $json_output = json_decode($json, TRUE);
    $rank = $json_output[data][trends][rank][0][value];

    if($rank) {
        //Create mysql query
        $query = "Update $tableName SET Rank = '$rank' WHERE ID  = '$j'";

        //Execute the query
        mysql_query($query);
        echo $query . "<br/>";
    }
}

function multiRequest($data) {
  // array of curl handles
  $curly = array();
  // data to be returned
  $result = array();

  // multi handle
  $mh = curl_multi_init();

  // loop through $data and create curl handles
  // then add them to the multi-handle
  foreach ($data as $id => $d) {

    $curly[$id] = curl_init();

    $url = (is_array($d) && !empty($d['url'])) ? $d['url'] : $d;
    curl_setopt($curly[$id], CURLOPT_URL,            $url);
    curl_setopt($curly[$id], CURLOPT_HEADER,         0);
    curl_setopt($curly[$id], CURLOPT_RETURNTRANSFER, 1);

    // post?
    if (is_array($d)) {
      if (!empty($d['post'])) {
        curl_setopt($curly[$id], CURLOPT_POST,       1);
        curl_setopt($curly[$id], CURLOPT_POSTFIELDS, $d['post']);
      }
    }

    curl_multi_add_handle($mh, $curly[$id]);
  }

  // execute the handles
  $running = null;
  do {
    curl_multi_exec($mh, $running);
  } while($running > 0);

  // get content and remove handles
  foreach($curly as $id => $c) {
    $result[$id] = curl_multi_getcontent($c);
    curl_multi_remove_handle($mh, $c);
  }

  // all done
  curl_multi_close($mh);

  return $result;

}
?> 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-12T01:04:19.373

代替

```
//first batch
$curlRequest = multiRequest($competeRequests);

$j = 0;
foreach ($curlRequest as $json){ 
```

你可以做：

```
$curlRequest = array();

foreach (array_chunk($competeRequests, 1000) as $requests) {
    $results = multiRequest($requests);

    $curlRequest = array_merge($curlRequest, $results);
}

$j = 0;
foreach ($curlRequest as $json){
    $j++;
    // ... 
```

这会将大数组拆分为 1,000 个块，并将这 1,000 个值传递给`multiRequest`使用 cURL 执行这些请求的函数。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2019-06-21T13:27:10.787

[https://github.com/webdevelopers-eu/ShadowHostCloak](https://github.com/webdevelopers-eu/ShadowHostCloak)

这正是你想要的。只需将空参数传递`new Proxy()`给绕过代理并发出直接请求。

您可以在其中填充 1000 个请求并调用`$proxy->execWait()`，它将同时处理所有请求并在一切完成后退出该方法......然后您可以重复。

# asp.net - MVC3：通过 À la carte 电子商务每月订阅访问网站

> ID：12379806
> 
> 赞同：0
> 
> 时间：2012-09-12T00:40:57.690
> 
> 标签：asp.net, asp.net-mvc-3, e-commerce, membership, roleprovider

我知道如何使用成员资格和角色功能轻松控制谁可以查看站点中的内容。但是，我现在想更进一步，允许人们购买对特定功能的访问权，按月计费。基本上我需要一个销售产品的电子商务网站和一个基于角色的会员网站的组合。下面是我们希望解决的一个场景示例：

我们的网站有以下部分（产品）：学习西班牙语、学习法语、学习德语、学习英语

*   我们现在希望用户能够购买他们想要的东西。所以我们可以给每一种产品定价。

*   我们还想提供捆绑折扣，所以买 2 件可减 10 美元。购买所有 4 件并获得 25% 的折扣。这应该是自动的，但如果需要，优惠券可以，只要它能够弄清楚确保他们拥有正确商品的逻辑

*   我们想限制折扣，以便我们只能向前 100 人或从 X 天到 Y 天提供折扣（理想情况下可能是优惠券系统）

*   如果我们更新定价，我们希望用户成为“伟大的父亲”。因此，如果有人以每月 60 美元的价格注册，然后我们将其设为 100 美元，他们将保持在 60 美元

*   这是一项每月服务，因此我们需要它来创建我们的发票并使用我们的 CC 处理器。我知道如果系统不包含我们的处理器，这将涉及我们制作 API。

*   如果可能的话，我们会喜欢“按比例”功能，因此如果他们目前正在为 3 件商品付款，并且距离下一个结算日期还有 13 天，他们可以添加第 4 件商品并按比例支付金额。

所有这些功能对于高级会员网站来说都是非常常见的功能，但是我只是不确定要搜索什么才能找到这样的框架。我可以找到电子商务，也可以找到基于角色的会员资格，但还没有找到两者的合适组合。

只要它适用于我们需要的东西，许可就可以了。

提前致谢

# c# - 在 C# 中操作结构中的变量

> ID：12379819
> 
> 赞同：0
> 
> 时间：2012-09-12T00:43:16.130
> 
> 标签：c#, struct

我正在尝试在 Visual Studio 中学习 C#。我只有基本的编码知识，一言以蔽之，我买了 C# 5.0。我很喜欢这本书，并试图用我读过的所有东西制作小程序来帮助它坚持下去。我认为结构很简单，但无论出于何种原因，我都无法让结构工作。

因此，这是本书中的一个简短且超基本的示例。

```
public struct Point {
    int x, y;
    public Point(int x, int y) { this.x = x; this.y = y; }
}

Point p1 = new Point();
Point p2 = new Point(1, 1); 
```

它工作正常。但现在说我想操纵 p1 或 p2 中的 x 和 y 变量。我已经尝试了很多，但我无法让它工作。

```
public struct Point {
    public int x;
}

Point p1 = new Point();
p1.x = 10; 
```

这行不通。当我尝试将 p1.x 设置为 10 时，出现错误。它说 p1 是一个“字段”，但用作“类型”。

我可能缺少一些简单的东西，但是我对反复试验的耐心已经耗尽。那么我做错了什么？我了解结构为何有用的基本概念，但我需要能够在制作后实际使用它！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-12T01:17:44.457

```
class Program
{
    public struct Point
    {
        int x, y;
        public Point(int x, int y) { this.x = x; this.y = y; }
    }

    static void Main(string[] args)
    {
        Point p1 = new Point();
        Point p2 = new Point(1, 1);
    }
} 
```

就像@pst 提到的那样。p1 和 p2 需要在一个方法中。在这种情况下，它们位于 main 方法中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-12T02:21:26.030

Tono Nam 的回答是正确但不完整的。

要以您想要的方式设置 x 和 y 的值，您还需要为 x 和 y 设置正确的访问修饰符，例如

```
class Program
{
    public struct Point
    {
        public int x, y;
        public Point(int x, int y) { this.x = x; this.y = y; }
    }

    static void Main(string[] args)
    {
        var p1 = new Point();
        var p2 = new Point(1, 1);
        p1.x = 1;
        p1.y = 1;
    }
} 
```

您将希望使用*public*从任何类访问 x 和 y 。

如果您只想从定义 struct Point 的同一个类中访问 x 和 y ，则需要使用*internal 。*

# javascript - 单击超链接时，如何使用 Google Maps API v3 缩放地图？

> ID：12379820
> 
> 赞同：0
> 
> 时间：2012-09-12T00:43:22.207
> 
> 标签：javascript, google-maps-api-3

当我点击我的超链接时，我无法使用 Google Maps API v3 进行放大/缩小。我让它在 v2 中工作：

```
<a href="javascript:map.setCenter(new GLatLng(58.37,62.66), 16);map.setMapType(G_SATELLITE_MAP);" >Some Place</a> 
```

在 v3 中，我尝试过：

```
<a href="javascript:map.setCenter(new google.maps.LatLng(58.37,62.66));">Some Place</a> 
```

我该如何解决这个问题？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-12T01:41:49.077

在 v3 中，您还必须调用`setZoom`：

```
<a href="javascript:map.setCenter(new google.maps.LatLng(58.37,62.66));map.setZoom(16);">Some Place</a> 
```

# ios - iOS Mobile Safari 滚动：减速时的 DOM 操作？

> ID：12379821
> 
> 赞同：2
> 
> 时间：2012-09-12T00:43:32.230
> 
> 标签：ios, dom, mobile-safari

在iOS MObile Safari中，轻弹滚动后，是否可以在系统处于减速模式时操作DOM？我通过使用 setInterval 在页面上的固定位置元素中不断增加一个数字来测试这一点，我注意到滚动时 DOM 没有更新。有没有办法做到这一点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-03-06T10:12:54.837

不，如果您想运行 javascript 以响应滚动，您唯一的解决方案是使用程序化滚动（iScroller、zynga-scroller）。

# javascript - jQuery Mobile 动态 div 页面

> ID：12379823
> 
> 赞同：1
> 
> 时间：2012-09-12T00:44:01.507
> 
> 标签：javascript, jquery, jquery-mobile

我是 JQuery + JQuery mobile 的新手。

我正在尝试为样式目的创建动态 div 元素。我从 AJAX 调用中提取 JSON，将其放入无序列表中，然后将其包装到 div 中。AJAX + JSON 工作得很好，但是当我在脚本中创建 DIV 并将其附加到另一个 div 容器中时，它不起作用。我已经对此进行了大量阅读，但我发现的解决方案似乎都不适用于 div 部分。

我已将代码简化为以下内容：

HTML：

```
 <div data-role="page">
        <div data-role="header">
            <h1>Page Title</h1>
        </div><!-- /header -->

        <div id="someDiv" data-role="content"></div>
        <div id="anotherDiv"></div>
    </div> 
```

JavaScript：

```
$(document).ready(function() {
    var newDiv = '<div id="d1"><p>This will attach to the content</p></div>';
    var aDiv = '<div id="test" data-role="page"><p>This never gets displayed because of data-role?</p></div>';
    $("#someDiv").html(newDiv).trigger('create');
    $("#anotherDiv").html(aDiv).trigger('create');
});​ 
```

请注意如何`aDiv`不附加到`anotherDiv`. 我怀疑这`data-role="page"`与`aDiv`.

[JSFiddle 链接](http://jsfiddle.net/dAX9f/)

我已经坚持了1天以上。任何帮助是极大的赞赏！！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-12T02:41:43.963

事实上，您`aDiv`正在附加，只是没有显示（您可以在 Firebug/WebInspector/DragonFly 中检查您的标记并查看此内容），因为一次只显示一个 JQM 页面。

如果您想附加一个新页面，您可以尝试将其添加到您的`body`

这是你的小提琴的叉子

[http://jsfiddle.net/49LgB/](http://jsfiddle.net/49LgB/)

# c# - 搜索目录中的所有文件时显示进度

> ID：12379825
> 
> 赞同：6
> 
> 时间：2012-09-12T00:44:19.430
> 
> 标签：c#, filesystems, directoryinfo

我之前问过这个问题：[快速获取特定路径中的所有文件和目录，](https://stackoverflow.com/questions/6061957/get-all-files-and-directories-in-specific-path-fast)以便尽可能快地找到文件。我正在使用该解决方案来查找与正则表达式匹配的文件名。

我希望显示一个进度条，因为对于一些非常大且速度慢的硬盘驱动器，它仍然需要大约 1 分钟才能执行。我在另一个链接上发布的那个解决方案不能让我知道还有多少文件需要遍历才能显示进度条。

**我正在考虑做的一个解决方案是尝试获取**我计划遍历的目录的大小。例如，当我右键单击该文件夹`C:\Users`时，我可以估计该目录的大小。如果我能够知道大小，那么我将能够通过添加我找到的每个文件的大小来显示进度。换句话说，进度=（当前文件大小的总和）/目录大小

由于某种原因，我无法有效地获得该目录的大小。

堆栈溢出的一些问题使用以下方法：

![在此处输入图像描述](../Images/9326337f8505542b9afd344e92ba6a49.png)

但请注意，我得到一个异常并且无法枚举文件。我很想在我的 C 盘上尝试这种方法。

在那张照片上，我试图计算文件的数量以显示进度。**我可能无法使用这种方法有效地获取文件数量**。`how to get the number of files on a directory`当人们问和人们问时，我只是在堆栈溢出上尝试一些答案`how the get the size f a directory`。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-17T18:28:20.630

解决这个问题会给你留下几种可能性之一......

1.  不显示进度
2.  使用前期成本进行计算（如 Windows）
3.  在计算成本的*同时*执行操作

如果速度如此重要并且您期望大型目录树，我会倾向于这些选项中的最后一个。我已经在链接的问题上添加了一个答案，[快速获取特定路径中的所有文件和目录，](https://stackoverflow.com/questions/6061957/get-all-files-and-directories-in-specific-path-fast/12464711#12464711)这展示了一种比您当前使用的更快的计算文件和大小的方法。要将其组合到选项 #3 的多线程代码中，可以执行以下操作...

```
static void Main()
{
    const string directory = @"C:\Program Files";
    // Create an enumeration of the files we will want to process that simply accumulates these values...
    long total = 0;
    var fcounter = new CSharpTest.Net.IO.FindFile(directory, "*", true, true, true);
    fcounter.RaiseOnAccessDenied = false;
    fcounter.FileFound +=
        (o, e) =>
            {
                if (!e.IsDirectory)
                {
                    Interlocked.Increment(ref total);
                }
            };

    // Start a high-priority thread to perform the accumulation
    Thread t = new Thread(fcounter.Find)
        {
            IsBackground = true, 
            Priority = ThreadPriority.AboveNormal, 
            Name = "file enum"
        };
    t.Start();

    // Allow the accumulator thread to get a head-start on us
    do { Thread.Sleep(100); }
    while (total < 100 && t.IsAlive);

    // Now we can process the files normally and update a percentage
    long count = 0, percentage = 0;
    var task = new CSharpTest.Net.IO.FindFile(directory, "*", true, true, true);
    task.RaiseOnAccessDenied = false;
    task.FileFound +=
        (o, e) =>
            {
                if (!e.IsDirectory)
                {
                    ProcessFile(e.FullPath);
                    // Update the percentage complete...
                    long progress = ++count * 100 / Interlocked.Read(ref total);
                    if (progress > percentage && progress <= 100)
                    {
                        percentage = progress;
                        Console.WriteLine("{0}% complete.", percentage);
                    }
                }
            };

    task.Find();
} 
```

[FindFile 类](http://help.csharptest.net/?CSharpTest.Net.Library~CSharpTest.Net.IO.FindFile_members.html)的实现可以在FindFile.cs[中](http://csharptest.net/browse/src/Library/IO/FindFile.cs)找到。

根据您的文件处理任务的成本（上面的 ProcessFile 函数），您应该看到大量文件的进度非常干净。如果您的文件处理速度非常快，您可能希望增加枚举开始和处理开始之间的延迟。

event 参数的类型是[FindFile.FileFoundEventArgs](http://help.csharptest.net/?CSharpTest.Net.Library~CSharpTest.Net.IO.FindFile%20FileFoundEventArgs_members.html)并且是一个可变类，因此请确保不要保留对 event 参数的引用，因为它的值会发生变化。

理想情况下，您将希望添加错误处理以及可能中止两个枚举的能力。可以通过在事件参数上设置“CancelEnumeration”来中止枚举。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-09-17T16:58:10.463

由于文件系统如何存储它的数据，您所问的可能是不可能的。

## 这是文件系统限制

如果不**逐个**枚举文件，就**无法**知道**文件夹的总大小**，也无法知道文件夹内的文件**总数**。这些信息都不存储在文件系统中。

 **这就是为什么 Windows`"Calculating space"`在复制包含大量文件的文件夹之前显示一条消息的原因......它实际上是在计算文件夹中有多少文件，并将它们的大小相加，以便它可以在执行真正的复制操作时显示进度条. （它还使用这些信息来了解目标是否有足够的空间来保存所有正在复制的数据）。

此外，当您右键单击文件夹并转到属性时，请注意计算所有文件并汇总所有文件大小需要一些时间。这是由相同的限制引起的。

要知道文件夹有多大，或者文件夹中有多少文件，您必须逐个枚举文件。

## 快速文件枚举

当然，正如您已经知道的那样，有很多方法可以进行枚举本身......但没有一种方法是即时的。您可以尝试使用文件系统的[USN 日志](http://en.wikipedia.org/wiki/NTFS#USN_Journal)进行扫描。在 CodePlex 中看一下这个项目：[VB.NET 中的 MFT Scanner](http://mftscanner.codeplex.com/) （*代码实际上是 C#...不知道为什么作者说它是 VB.NET*）...它找到了我 IDE 中的所有文件SATA（非 SSD）驱动器在不到 15 秒的时间内找到了 311000 个文件。

您必须按路径过滤文件，以便只返回您正在查找的路径内的文件。但这是工作中最容易的部分！

*希望这对您的项目有所帮助...祝您好运！***

# ruby-on-rails - 在 Rails 中使用 REST API 的第一步是什么？

> ID：12379834
> 
> 赞同：2
> 
> 时间：2012-09-12T00:45:56.760
> 
> 标签：ruby-on-rails, api

我刚刚完成了 Hartl 的关于 Rails 的书。遵循示例很有帮助，我已经能够为我的应用程序构建一些非常基本的功能。但是，我想使用这个 API，并且已经获得了该 API 的密钥。我完全不知道如何开始实现 API。围绕 API 的其他内容很有帮助，但我确实被困在开始实施 API 的第一步应该是什么。

我需要用户能够注册和验证，然后提供将通过外部 API 跟踪的数据。我已经让用户注册并验证了一些东西，只需要知道使用这个 API 的第一步应该是什么。

答案背后的逻辑同样有帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-07T06:18:10.937

您可以将 ActiveResource 用于您的模型并将其指向外部 API。如果您的模型使用外部数据源，这很有用。

[http://api.rubyonrails.org/classes/ActiveResource/Base.html](http://api.rubyonrails.org/classes/ActiveResource/Base.html)

如果您要使用的外部 API 是众所周知的，那么很有可能已经存在与该 API 交互的 gem。

如果您只需要向外部 API 发送一些数据，但您的模型不使用它作为源，则可以使用 Faraday 之类的 HTTP 客户端[https://github.com/technoweenie/faraday](https://github.com/technoweenie/faraday)

# mysql - MySql从多个表中查询数据

> ID：12379835
> 
> 赞同：2
> 
> 时间：2012-09-12T00:46:03.343
> 
> 标签：mysql, sql, report, reporting

我是 SQL 新手，所以请善待。我可以通过查看数据库并将其导出到 Excel 来获取所有信息。一旦进入excel，我必须创建forumlas才能按照我想要的方式获得它。如果可能的话，我只想运行一个查询来查看所有内容。我用谷歌搜索过，但似乎找不到对我有意义或指向正确方向的东西。

我会认为通过我的搜索会有某种形式的连接，但再次成为 SQL 的新手，我正在抓住稻草。

给定以下示例表：

门票表：

```
ID    Queue  Owner  Subject            Status    TimeWorked    LastUpdated
001   1      22     need help          Open      20            2012-09-01
002   2      6      internet           Resolved  60            2012-09-03
003   1      24     email not working  Open      15            2012-09-04 
```

用户表：

```
ID    Name
6     Nobody
22    Josh
24    Jon 
```

自定义字段值表：

```
Id      ObjectId    CustomField    Content
01      001         1              Bob Inc
02      001         2              0
03      001         3              WaitingOnClient
04      001         4              Remote
05      002         1              ZYC Inc
06      002         2              15
07      002         3              WaitingOnClient
08      002         4              Remote
09      003         1              ACB Inc
10      003         2              0
11      003         3              TimeScheduled
12      003         4              OnSite 
```

排队表：

```
ID    Name
1     Support
2     Tier2 
```

我需要做的是查询以使结果如下所示

```
ID  Client  Subject   Queue    Owner  Status    Type   BTime CustomStat      LastUpdate NT
001 Bob Inc need help support  Josh   open      Remote 20    WaitingOnClient 2012-09-01 0
001 ZYC Inc internet  Tier2    Nobody Resolved  Remote 60    WaitingOnClient 2012-09-01 15
001 ACB Inc email     support  Jon    open      onsite 15    TimeScheduled   2012-09-01 0 
```

任何帮助将非常感激。

提前致谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-12T02:55:48.907

为此，您需要使用*内联* `CASE`语句，`GROUP_CONCAT`并且应按`ID`. 试试这个。

```
SELECT  a.ID,
        GROUP_CONCAT((CASE WHEN d.CustomeField = 1 THEN d.content ELSE NULL END)) `Client`,
        a.Subject,
        c.Name,
        b.Name Owner,
        a.`Status`,
        GROUP_CONCAT((CASE WHEN d.CustomeField = 4 THEN d.content ELSE NULL END)) `Type`,
        a.TimeWorked,
        GROUP_CONCAT((CASE WHEN d.CustomeField = 3 THEN d.content ELSE NULL END)) `CustomStat`,
        a.LastUpdated,
        GROUP_CONCAT((CASE WHEN d.CustomeField = 2 THEN d.content ELSE NULL END)) `NT`
FROM    tickets a
        INNER JOIN users b
            ON a.owner = b.id
        INNER JOIN queue c
            ON a.queue = c.id
        INNER JOIN  CustomFieldValue d
            ON a.ID = d.ObjectID
 GROUP BY a.ID 
```

# [*SQLFiddle 演示*](http://sqlfiddle.com/#!2/f7809/11)

# ios - 当 Mobile Safari 自动插入逗号时，如何让用户在其中编辑数字输入？

> ID：12379836
> 
> 赞同：0
> 
> 时间：2012-09-12T00:46:04.950
> 
> 标签：ios, html, mobile-safari

Mobile Safari 在使用数字输入 () 时会自动插入逗号。那也行。但是，当您尝试编辑其中一个大数字时，除非您手动删除逗号，否则它不会让您这样做。

示例： * 输入“500000” * Mobile Safari 将其变为“500,000” * 尝试删除数字中的最后一个 0 以将数字变为“50000”或“50,000” * 不起作用。

注意：删除前两个 0 中的一个，使数字变为“50,000”并具有正确的逗号。事实上，野生动物园不会让您以使逗号不正确的方式对其进行编辑。有没有简单的方法来打开它？我想我们可以手动使用 javascript 并听取输入的每个数字然后操纵值？或者我们可以将输入切换为“tel”而不使用逗号？

# python - 内置类型和用户定义类型之间的 Python 比较

> ID：12379840
> 
> 赞同：1
> 
> 时间：2012-09-12T00:46:40.823
> 
> 标签：python, class, python-3.x, comparison, built-in

Python 3 如何将内置对象（在 lhs 上）与用户定义的对象（在 rhs 上）进行比较？

内置`__eq__`方法是否只是将比较委托给 rhs ( `rhs.__eq__(self)`)？

我在文档中没有找到任何关于此的声明。[文档](http://docs.python.org/py3k/library/stdtypes.html#comparisons)状态：

> 不同类型的对象，除了不同的数值类型，永远不会比较相等。

这很容易引起误解，因为：

```
class X:
  def __eq__(self, rhs)
    return True

x = X()
'abc' == x # True 
```

我认为 doc 声明应该改写如下：

> 不同内置类型的对象，除了不同的数值类型，永远不会比较相等。

并且应该进一步阐明如何执行与用户定义的类实例的比较。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-12T00:59:25.293

要回答问题：

> Python 3 如何将内置对象（在 lhs 上）与用户定义的对象（在 rhs 上）进行比较？

与任何其他对象比较（包括`None`！）的方式相同。

> 内置`__eq__`方法是否只是将比较委托给 rhs ( `rhs.__eq__(self)`)？

不，内置`__eq__`不会像*这样*委托。有一个更高层次的结构在起作用，它涵盖了`==`Python 中的行为。

Given `a == b`, where`a.__eq__(b)` *返回* `NotImplemented`then`b.__eq__(a)`将被调用，并且使用的结果作为相等性测试的结果。（`False`如果两个`__eq__`实现都返回，则返回`NotImplemented`。）

因此，给定`x`（类`X`），并给定`"abc".__eq__(x)` *返回* `NotImplemented`，然后`x.__eq__("abc")`调用（并`True`根据问题评估）。

这同样适用于其他标准比较运算符。

虽然我不想过多地推测文档（或可能的错误措辞），但我相信*如果*在`stdObj.__eq__(obj)`与`stdObj == obj`.

也可以看看：

*   简要提到的[协议](http://docs.python.org/reference/datamodel.html#object.__eq__)[文档`__eq__`](http://docs.python.org/reference/datamodel.html#object.__eq__)`NotImplemented`
*   [为什么返回 NotImplemented 而不是引发 NotImplementedError](https://stackoverflow.com/questions/878943/why-return-notimplmented-instead-of-raising-notimplementederror)

# java - 硬币：无效的方法声明，需要返回类型

> ID：12379841
> 
> 赞同：0
> 
> 时间：2012-09-12T00:47:07.463
> 
> 标签：java

我上周刚开始学习计算机科学，我们得到了一个名为 Coins 的工作表，我必须在其中找出一组硬币中有多少 25 美分硬币、5 美分硬币和几美分硬币。我遇到了很多麻烦，并且遇到了那个错误。这是我的代码

```
package Coins;

public class Coins
{
    private int change;

    // two contructors
    Change()    //default constructor
    {
        change = 94;
    }

    Change( int c )
    {
        change = c;
    }

    // accessor method - change
    public int getChange()
    {
            return Change;
    }

    // mutator method - change
    public void setChange( int anotherChange)
    {
        change = anotherChange;
    }

    public void askUserForChange()
    {
        Scanner keyIn;
        keyIn = new Scanner(System.in);

        System.out.print("Please enter the amount of change: ");
        String input = keyIn.nextLine();

        int nChange = Integer.parseInt (input);

        setChange(nChange);
        // change = nChange

        printChangex();
    }

    // action method - take accessor figure out coins -> output
    // calculating the coins needed for the change
    public void printChangeRange(int start, int end)
    {
        for(int c = start; c <= end; c++
        {
            setChange(c);
            printChangex();
        }

    }
    public void printChangex()
    {

    int c = change;
    int quarter = c / 25;
    System.out.println("quarter = " + quarter);
    int a = c%25;
    int dime = a / 10;
    System.out.println("dime = " + dime);
    int b = a%10;
    int nickel = b / 5;
    System.out.println("nickel = " + nickel);
    int c = b%5;
    int penny = c / 1;
    System.out.println("penny = " + penny);

    }

    // instance variables - replace the example below with your own
    private int x;

    public Coins()
    {
        // initialise instance variables
        x = 0;
    }

    public int sampleMethod(int y)
    {
        // put your code here
        return x + y;
    }
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-12T00:50:46.883

你有一个名为的类`Coins`，并试图给它一个名为`Change`. 类和构造函数必须具有相同的名称。随便挑一个。

为了详细说明标题中的错误，我假设“无效的方法声明，需要返回类型”是指带有`Change() //default constructor`. 由于这是在一个名为`Coins`它的类中，因此它不是评论所声称的构造函数。Java 编译器认为它是一种方法。所有方法都必须有一个返回类型，所以编译器会抱怨。

实际的构造函数位于代码的底部。将构造函数放在首位是标准做法，因此我建议您将这些名称非常流行的构造函数放在`Coins`类的开头。您可能只需要`Change()`完全删除构造函数。

同样作为在这里提出问题的提示，发布您收到的完整错误消息非常重要。我的回答是基于一些有根据的猜测，当然不能解决代码中的所有问题。当您继续尝试修复您的程序时，请随时提出更多问题。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-09-12T00:54:28.683

这个

```
// two contructors
Change()    //default constructor
{
    change = 94;
}

Change( int c )
{
    change = c;
} 
```

是不寻常的。你甚至`Coins`在文件底部有一个类的构造函数，所以你会想要使用它。请记住，所有 Java 类都有一个**与类本身命名相同**的构造函数——即使它是默认构造函数。

^(更不寻常的*是*，它在实例化时具有 94 的神奇价值……但说真的，选择一个类名并坚持下去。)

这个

```
// accessor method - change
    public int getChange()
    {
            return Change;
    } 
```

……也很奇怪。您可能想要返回成员变量`change`，因此将其更改为小写 C。

# iphone - 底部的 UIButton 彩色线条

> ID：12379843
> 
> 赞同：0
> 
> 时间：2012-09-12T00:47:11.377
> 
> 标签：iphone, ios, ios5, uibutton

我有一个 UIView 女巫，其中包含四个 UIButton，所有按钮的背景中都有一个图像。但是顶部的两个按钮在它们的底部有某种彩色线。这只发生在我在我的设备上测试应用程序时，而不是当我在模拟器上运行它时。我想知道是否有人知道如何摆脱这条线。有没有我错过的设置或类似的东西？

图 1： [http](http://hdev.se/asd/bild.PNG)
://hdev.se/asd/bild.PNG 图 2： [http ://hdev.se/asd/bild2.PNG](http://hdev.se/asd/bild2.PNG)

提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-12-16T08:52:25.977

我遇到了同样的问题并找到了以下解决方案：

问题是由我使用的图像引起的。我将它们保存为 PNG-8 文件。当我将它们更改为 PNG-24 文件时，问题就消失了。似乎减少的调色板导致了问题。

# c - 获取内核模块中已安装文件系统的列表？

> ID：12379844
> 
> 赞同：0
> 
> 时间：2012-09-12T00:47:16.530
> 
> 标签：c, linux, kernel, kernel-module, mount-point

我正在尝试获取内核模块中特定文件系统的挂载点的路径。在用户空间工具中，我可以读取 /proc/mount 来执行此操作，但从我尝试和阅读的内容来看，这在内核空间中是不可能的。

如何在内核模块中实现这一点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-19T16:55:21.643

您可以从 /dev/ 目录中获取它，也只需在该位置使用 grep 和 sed 即可找到正确的安装点。

# c++ - 装饰器设计模式与继承？

> ID：12379848
> 
> 赞同：24
> 
> 时间：2012-09-12T00:47:43.677
> 
> 标签：c++, design-patterns

我已经阅读了来自 Wikipedia 的[装饰器设计模式](http://en.wikipedia.org/wiki/Decorator_pattern)，以及来自[这个站点](http://www.vincehuston.org/dp/decorator.html)的代码示例。

我认为传统继承遵循“is-a”模式，而装饰器遵循“has-a”模式。装饰器的调用约定看起来像是在“皮肤”之上的“皮肤”……在“核心”之上。例如

```
I* anXYZ = new Z( new Y( new X( new A ) ) ); 
```

如上面的代码示例链接所示。

但是，我仍然有几个问题我不明白：

1.  wiki 所说的“装饰器模式可用于**在运行时**扩展（装饰）某个对象的功能”是什么意思？'new ...(new... (new...))' 是一个运行时调用，很好，但是一个 'AwithXYZ anXYZ;' 是编译时的继承并且不好？

2.  从代码示例链接中，我可以看到两个实现**中类定义的数量**几乎相同。我记得在其他一些设计模式书籍中，比如“Head first design patterns”。他们以 starbuzz coffee 为例，说传统继承会导致**“类爆炸”**，因为对于咖啡的每种组合，你都会为它想出一个类。

    但是在这种情况下，装饰器不一样吗？如果装饰器类可以采用任何抽象类并对其进行装饰，那么我想它确实可以防止爆炸，但是从代码示例中，您有确切的类定义#，不少于......

有人会解释吗？

* * *

## 回答 #1

> 赞同：71
> 
> 时间：2012-09-12T01:02:54.110

让我们以一些抽象流为例，假设您想为它们提供加密和压缩服务。

使用装饰器（伪代码）：

```
Stream plain = Stream();
Stream encrypted = EncryptedStream(Stream());
Stream zipped = ZippedStream(Stream());
Stream zippedEncrypted = ZippedStream(EncryptedStream(Stream());
Stream encryptedZipped = EncryptedStream(ZippedStream(Stream()); 
```

通过继承，您可以：

```
class Stream() {...}
class EncryptedStream() : Stream {...}
class ZippedStream() : Stream {...}
class ZippedEncryptedStream() : EncryptedStream {...}
class EncryptedZippedStream() : ZippedStream {...} 
```

1）使用装饰器，您可以根据需要在运行时组合功能。每个类只处理一个方面的功能（压缩、加密……）

2) 在这个简单的例子中，我们有 3 个带有装饰器的类，5 个带有继承的类。现在让我们添加更多服务，例如过滤和剪辑。使用装饰器，您只需要另外 2 个类来支持所有可能的场景，例如过滤 -> 剪辑 -> 压缩 -> 加密。使用继承，您需要为每个组合提供一个类，因此您最终会得到数十个类。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2012-09-12T01:05:03.813

以相反的顺序：

2) 比如说，有 10 个不同的*独立*扩展，在运行时可能需要它们的任意组合，10 个装饰器类就可以完成这项工作。要通过继承涵盖所有可能性，您需要*1024*个子类。而且没有办法绕过大量的代码冗余。

1) 假设您在运行时有 1024 个子类可供选择。尝试勾勒出需要的代码。请记住，您可能无法指定选择或拒绝选项的顺序。还要记住，在扩展实例之前，您可能需要使用一段时间。来吧，试试。相比之下，用装饰器做这件事是微不足道的。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-09-12T01:18:30.517

您说得对，它们有时可能非常相似。任一解决方案的适用性和优势将取决于您的具体情况。

其他人击败了我，对你的第二个问题给出了足够的答案。简而言之，您可以组合装饰器来实现更多的组合，而继承是无法做到的。

因此，我专注于第一个：

您不能严格地说编译时不好而运行时好，只是灵活性不同。在运行时更改内容的能力对于某些项目来说可能很重要，因为它允许在不重新编译的情况下进行更改，这可能很慢，并且需要您处于可以编译的环境中。

不能使用继承的一个例子是当你想向实例化对象添加功能时。假设为您提供了一个实现日志接口的对象实例：

```
public interface ILog{
    //Writes string to log
    public void Write( string message );
} 
```

现在假设您开始一项涉及许多对象的复杂任务，并且每个对象都进行日志记录，因此您传递了日志记录对象。但是，您希望任务中的每条消息都以任务名称和任务 ID 为前缀。您可以传递一个函数，或者传递 Name 和 Id 并相信每个调用者都遵循预先挂起该信息的规则，或者您可以在传递它之前装饰日志对象，而不必担心其他对象会这样做对的

```
public class PrependLogDecorator : ILog{

     ILog decorated;

     public PrependLogDecorator( ILog toDecorate, string messagePrefix ){
        this.decorated = toDecorate;
        this.prefix = messagePrefix;
     }

     public void Write( string message ){
        decorated.Write( prefix + message );
     }
} 
```

对 C# 代码感到抱歉，但我认为它仍会将这些想法传达给了解 C++ 的人

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-09-12T00:53:29.433

要解决您问题的第二部分（这可能反过来解决您的第一部分），使用装饰器方法您可以访问相同数量的组合，但*不必编写它们*。如果你有 3 层装饰器，每层有 5 个选项，你就有`5*5*5`可能使用继承定义类。使用装饰器方法你需要 15.

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-09-12T01:01:24.110

首先，我是一个 C# 人，有一段时间没有接触过 C++，但希望你能明白我的出发点。

想到的一个很好的例子是 a`DbRepository`和 a `CachingDbRepository`：

```
public interface IRepository {
  object GetStuff();
}

public class DbRepository : IRepository {

  public object GetStuff() {
    //do something against the database
  }
}

public class CachingDbRepository : IRepository {
  public CachingDbRepository(IRepository repo){ }

  public object GetStuff() {
    //check the cache first
    if(its_not_there) {
      repo.GetStuff();
    }
} 
```

所以，如果我只是使用继承，我会有 a`DbRepository`和 a `CachingDbRepository`。从数据库中`DbRepository`查询；将`CachingDbRepository`检查其缓存，如果数据不存在，它将查询数据库。所以这里有一个可能的重复实现。

通过使用装饰器模式，我仍然拥有相同数量的类，但是如果它不在缓存中，我`CachingDbRepository`会接收`IRepository`并调用它以从底层存储库中获取数据。`GetStuff()`

所以类的数量是相同的，但是类的使用是相关的。 `CachingDbRepo`调用传递给它的回购......所以它更像是组合而不是继承。

我发现何时决定何时使用继承而不是装饰是主观的。

我希望这有帮助。祝你好运！

# javascript - 如何在 jQuery 中创建“reverse preventDefault”？

> ID：12379851
> 
> 赞同：0
> 
> 时间：2012-09-12T00:48:06.370
> 
> 标签：javascript, jquery, events, jquery-events, preventdefault

在[Private Logistics: Privacy-Sensitive Calendar, Todo, and Personal Information Management](http://JonathansCorner.com/private-logistics/)中，输入的数据可以通过点击进行编辑，并且支持输入链接为 <a href="... 或输入 URL，这将被链接。

这很好用，但是当有人点击链接时会出现问题。期望的行为是打开链接，而不是将文本片段置于编辑模式，这与`event.preventDefault()' or '...return false;}`. （在元素上的链接外部单击应将包含元素置于编辑模式，与碰巧没有链接的容器相同。）

***如何***使用 jQuery 反转更常见的模式？我现在最好的猜测是尝试对事件目标进行内省，看看它是否是一个锚。但这只是一个最好的猜测；我已经看到很多这样的模式示例，它们会取消加载另一个页面的链接，但会执行将容器置于编辑模式的添加的 Ajax 功能；我不确定我是否看到了该模式的反面，它会跟随链接而不是将容器置于编辑模式。

我还看到了一种通过在同一页面中加载链接来规避问题的方法，但这是我宁愿仅在存在难以解决的实施问题或类似问题时采用的解决方案。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-06-18T20:22:03.403

您也可以只更改您阻止默认设置的类：

```
$(document).ready(function(){
    $('.blue').removeClass('blue').addClass('green');
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-12T01:35:10.573

一般来说，你不想清理你的大笔划，相反，不要做这么大的笔划。`if`在运行之前使用语句`e.preventDefault()`。

就像是：

```
var preventedLinks = $('a.preventthislink');
$('a').click(function(e){
    if ($(this).index(preventedLinks) != -1) {
       e.preventDefault();
    }
}); 
```

# url - 如何从 IIS 中查找共享点站点 URL

> ID：12379853
> 
> 赞同：1
> 
> 时间：2012-09-12T00:49:02.457
> 
> 标签：url, iis, sharepoint-2007

我的一位团队成员在我们的服务器上安装了 Sharepoint-2007 基础，现在已经离开了组织。现在我想知道共享点 URL，因为其中一个应用程序在执行期间需要它。我查看了 IIS (inetmgr)，可以看到几个与 Sharepoint 相关的虚拟目录，但我无法找出 Sharepoint 站点的 URL。那台机器上安装的操作系统是 Windows-7，这个 Sharepoint-2007-foundation 安装也可以在具有 Windows Server 2008 的 VM 上使用。我不是一个真正的技术人员，对 Sharepoint 也不太熟悉。我该如何解决这个问题？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-12T11:41:08.107

在托管 SharePoint 的服务器中。`Click Start -> SharePoint Central Administration` （如果找不到，请搜索该链接。它通常在 SharePoint Server 2010 产品下）。然后转到

```
Application management -> Manage Web Applications 
```

您将在那里看到站点列表及其 URL。

# javascript - 灯光问题（使用three.js）

> ID：12379861
> 
> 赞同：1
> 
> 时间：2012-09-12T00:50:16.223
> 
> 标签：javascript, three.js

我有一个从搅拌机导出的简单室内场景。它有一个房间，天花板上有 3 个球体，里面有各自的光源。每一个灯都可以单独工作，但是当我将它们全部插入场景中时，只有一个灯可以工作！有时与 2 一起工作，但从不与他们三个一起工作。这是我的灯代码：

```
luz_sala1 = new THREE.PointLight(0xFFFFFF,0.5, 50.0);
luz_sala1.position = new THREE.Vector3(16.14323,2.52331,13.93375);
scene.add(luz_sala1);

luz_sala2 = new THREE.PointLight(0xFFFFFF, 0.5, 50.0);
luz_sala2.position = new THREE.Vector3(27.70114,2.52331,-6.20571);
scene.add(luz_sala2);

luz_sala3 = new THREE.PointLight(0xFFFFFF, 0.5, 50.0);
luz_sala3.position = new THREE.Vector3(21.50580,3.10719,-27.82775);
scene.add(luz_sala3); 
```

如果我将距离设置为 0，效果很好，但我需要这些灯只影响它们所在的区域。我也尝试过 THREE.Spotlight(0xFFFFFF,0.5,50.0,Math.PI, 0) 但使用同样的结果。当它们以某种方式共享相同的距离时，它们看起来会相互抵消吗？

请帮忙，这很混乱。

编辑：另外，我在房间的另一部分有一些聚光灯模型（我有大约 4 个），但是当我将这 4 个聚光灯添加到场景中时，我遇到了着色器编译错误。搜索完问题，发现需要在渲染器中设置maxLights属性。我将它设置为 10，但问题仍然存在，场景中的灯光不能超过 4 个。还有什么我可以做的吗？

编辑2：这里有一些图片。作为参考，“luz_sala1”是靠近电视的那个，“luz_sala2”是中间的，“luz_sala3”是更远的。

这个是上面的代码（所有 3 个灯），除了 0.8 强度。 [http://www.mediafire.com/view/?s85qr4rplhort29](http://www.mediafire.com/view/?s85qr4rplhort29)

这是在打开 2 和 3 的情况下（评论了“scene.add(luz_sala1);”）： [http ://www.mediafire.com/view/?83qbbua9f8ee3b4](http://www.mediafire.com/view/?83qbbua9f8ee3b4)

所以，如您所见，2 个点光源可以很好地协同工作，但 3 个点光源似乎“加起来”到第一个？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-14T09:28:19.633

The maxLight property not having any effect is most likely due to your hardware, drivers or ANGLE (library that translates WebGL to Direct3D) not supporting enough varying vectors in shaders - each light requires one and other things too. This *might* also be in the background of your general problem.

In order to have more lights there are three options:

1.  Try if it helps if you make your browser prefer native OpenGL over ANGLE (google for instructions). Make sure you have up-to-date OpenGL drivers installed though.
2.  Implement a deferred renderer. This is nowadays very common in the desktop world, but it's tricky if not impossible to implement with good performance in WebGL due to framebuffer limitations.
3.  Implement a light manager that only ever uses some lights, disabling the rest. Simplest, though far from perfect method would be to select the lights closest to the camera.

Also worth mentioning is that currently SpotLights are just PointLights that cast shadow to one direction.

# symfony - 如何在 symfony2 中隐藏图像和文件的物理路径

> ID：12379864
> 
> 赞同：2
> 
> 时间：2012-09-12T00:51:19.540
> 
> 标签：symfony, url-rewriting, symfony-2.1

我必须阅读并提供大量资源（图像和文件），并且我想隐藏存储资源的真实路径。使用 symfony 2.x 最好的方法是什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-12T11:46:02.917

如果你想从文件系统中抽象出来，你可以使用[KnpGaufretteBundle](https://github.com/KnpLabs/KnpGaufretteBundle)。Gaufrette 是一个抽象文件系统的 PHP 库。也就是说，无论资源存储在何处（例如，本地文件系统、FTP 服务器、Amazon S3、Dropbox 等），您都可以访问它们。

但是， Gaufrette 并没有抽象路径（您为文件系统设置了一种基本目录），您将使用相对于该基本目录的路径。考虑以下抽象本地文件系统的代码：

```
<?php

use Gaufrette\Filesystem;
use Gaufrette\Adapter\Local as LocalAdapter;

$adapter = new LocalAdapter('/var/media');
$filesystem = new Filesystem($adapter):

$content = $filesystem->read('myFile.txt');

$content = 'Hello I am the new content';

$filesystem->write('myFile.txt', $content); 
```

在此示例中，您将读取和写入文件*/var/media/myFile.txt*。

如果您想进一步抽象文件系统，您可以创建一个具有文件映射及其别名的服务。例如，您可以从 YAML 配置文件中读取这些文件/别名对的列表。然后，您可以使用某种带有别名作为参数的 getter 来获取*真实的文件名。*

# php - 在 php 和 xml 中获取包含特定值的 xml 节点数

> ID：12379866
> 
> 赞同：0
> 
> 时间：2012-09-12T00:51:40.117
> 
> 标签：php, xml, count, nodes

您好我正在尝试获取具有特定内容或值的所有节点的计数。在这种情况下，我有一个 xml：

```
<hotel>
<city>Cancun</city>
<postalCode>77500</postalCode>
<countryCode>MX</countryCode>
<airportCode>CUN</airportCode>
<supplierType>E</supplierType>
<propertyCategory>1</propertyCategory>
<hotelRating>4.0</hotelRating>
<confidenceRating>52</confidenceRating>
</hotel> 
```

我需要找到所有值为 4 的 hotelRating 并计算我的 xml 列表中有多少。我不知道如何用 php 做到这一点。如果有人可以帮助我，我将不胜感激！

顺便说一句，我已经按如下方式连接了 xml 文件，并且能够获取数据和发送数据。

```
$post_string= 'type=xml&cid=222&minorRev=14&apiKey=222&locale='.$userLocale.'&currencyCode='.$userCurr.'&customerIpAddress='.$userIp.'&customerUserAgent='.$userAgent.'&xml=<HotelListRequest><destinationId>'.$destinationId.'</destinationId><arrivalDate>'.$arriving.'</arrivalDate><departureDate>'.$departing.'</departureDate><RoomGroup>'.$xmlQuery.'</RoomGroup><supplierCacheTolerance>MED_ENHANCED</supplierCacheTolerance></HotelListRequest> ';
//Relative path to the file with $_POST parsing
$path = "http://api.ean.com/ean-services/rs/hotel/v3/list"; 
$ch = curl_init($path); 
$fp = fopen('xml/data.xml','w');
//Send the data to the file
curl_setopt($ch, CURLOPT_POSTFIELDS, $post_string); 
curl_setopt($ch, CURLOPT_RETURNTRANSFER, 1);
curl_setopt($ch, CURLOPT_HTTPHEADER, array('Accept: application/xml')); 
curl_setopt($ch, CURLOPT_HEADER, 0);
curl_setopt($ch, CURLOPT_FILE, $fp);
$val = curl_exec($ch);
curl_close($ch);//Close curl session
fclose($fp); //Close file overwrite
$data = simplexml_load_file('xml/data.xml');
} 
```

预先感谢您的任何帮助！！！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-12T00:55:14.353

```
foreach ($data->hotel as $hotel)
{
    if ($hotel->hotelRating == '4.0')
    {
        //  hotel with 4.0 rating found
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-12T01:05:15.037

```
$count = $data->xpath("count(\"//hotel[hotelRating= '4.0']\")"); 
```

将为您提供hotelrating = 4.0 的酒店数量。

# sql - Rails 3 仅连接关系中的某些行

> ID：12379870
> 
> 赞同：0
> 
> 时间：2012-09-12T00:52:28.597
> 
> 标签：sql, ruby-on-rails-3, activerecord

我一直在考虑gmail如何查询他们的对话。我知道他们使用不同的技术，但我想尽可能地模仿。

目前我获取对话列表，然后我必须为每个对话获取消息。我可以使用普通连接：

```
Conversation.joins(:messages).first 
```

但这将加入每条消息，我只需要最后一条消息。我将如何构建这个查询？当我做 Conversation.all 时加入会更好：

```
Conversation.joins(:messages).all # but only join last message for each conversation 
```

另外，我可以使用条件来加入具有特定用户 ID 的最后一条消息吗？

```
message.user_id = 1
Conversation.joins(:messages).all # only last message where user_id = 1 
```

如果这有助于演示查询，我正在使用 squeel。

获取对话以及每个对话的最后一条消息的最佳方式是什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-12T12:33:38.473

这通常使用have子句来完成。你可能会在 Squeel 中做这样的事情（注意，未经测试）：

```
user.conversations.includes{messages}.group{id}.having{messages.id == max(messages.id)} 
```

您将根据对话 ID 进行分组，然后使用必须清除所有行，但每个组中具有最大消息 ID 的行除外。

注意：在许多情况下，“拥有”并不是一件特别理想的事情。您需要检查查询的解释，以确保您不会在路上给自己造成不必要的痛苦。如果是这样，您可以考虑在对话中添加一个缓存列，指向对话中的最后一条消息，然后只针对该列设置关联。

# ios - 核心数据崩溃 - 无法识别的选择器

> ID：12379872
> 
> 赞同：5
> 
> 时间：2012-09-12T00:52:52.953
> 
> 标签：ios, core-data

我看过其他关于无法识别的选择器错误的帖子，但没有关于以下方法中自动生成的代码：

```
- (void)tableView:(UITableView *)tableView commitEditingStyle:forRowAtIndexPath: 
```

当我滑动删除时调用它，当我点击删除按钮时，我收到以下错误：

> -[Vehicle removeObjectFromGasUpsAtIndex:]：无法识别的选择器发送到实例 0x8172c60

我的 NSManagedObject 类 Vehicle 有一个名为 gasUps 的 NSOrderedSet 变量，当我想删除它时，它应该响应这条消息。或者我是这么想的。

这是崩溃的整个方法：

```
- (void)tableView:(UITableView *)tableView commitEditingStyle:(UITableViewCellEditingStyle)editingStyle forRowAtIndexPath:(NSIndexPath *)indexPath
{
   if (editingStyle == UITableViewCellEditingStyleDelete) {
    // need to delete gas up and not vehicle
    int row = [indexPath row];

    //[self.selectedVehicle removeObjectFromGasUpsAtIndex:row];
    [self.selectedVehicle removeObjectFromGasUpsAtIndex:row];
    NSError *error = nil;
    if (![self.managedObjectContext save:&error]) {
         // Replace this implementation with code to handle the error appropriately.
         // abort() causes the application to generate a crash log and terminate. You should not use this function in a shipping application, although it may be useful during development. 
        NSLog(@"Unresolved error %@, %@", error, [error userInfo]);
        abort();
    }
 }   
} 
```

为什么这个选择器无法识别？

编辑：这是给乔迪的。

```
#import <Foundation/Foundation.h>
#import <CoreData/CoreData.h>

typedef enum {
    FullExtract,
    NameExtract
} kTitleExtract;

@interface Vehicle : NSManagedObject

@property (nonatomic, retain) NSString * name;
@property (nonatomic, retain) NSNumber * year;
@property (nonatomic, retain) NSString * make;
@property (nonatomic, retain) NSNumber * mileage;
@property (nonatomic, retain) NSString * model;
@property (nonatomic, retain) NSOrderedSet *gasUps;

// added methods
- (NSString *)getTitleExtract:(kTitleExtract)titleExtract;

@end

@interface Vehicle (CoreDataGeneratedAccessors)

- (void)insertObject:(NSManagedObject *)value inGasUpsAtIndex:(NSUInteger)idx;
- (void)removeObjectFromGasUpsAtIndex:(NSUInteger)idx;
- (void)insertGasUps:(NSArray *)value atIndexes:(NSIndexSet *)indexes;
- (void)removeGasUpsAtIndexes:(NSIndexSet *)indexes;
- (void)replaceObjectInGasUpsAtIndex:(NSUInteger)idx withObject:(NSManagedObject *)value;
- (void)replaceGasUpsAtIndexes:(NSIndexSet *)indexes withGasUps:(NSArray *)values;
- (void)addGasUpsObject:(NSManagedObject *)value;
- (void)removeGasUpsObject:(NSManagedObject *)value;
- (void)addGasUps:(NSOrderedSet *)values;
- (void)removeGasUps:(NSOrderedSet *)values;

@end 
```

这是设置 self.selectedVehicle 的代码片段：

```
if (self.vehiclesArray != nil  && [self.vehiclesArray count] != 0 && self.vehicleIndex != -1) {
    // enable add buttom
    [self.navigationItem.rightBarButtonItem setEnabled:YES];
    self.selectedVehicle = [self.vehiclesArray objectAtIndex:self.vehicleIndex];
    NSLog(@"set selected vehicle");
} else {
    // disable add button
    [self.navigationItem.rightBarButtonItem setEnabled:NO];

    // set vehicle defaults to -1 and make disable add buttom
    NSUserDefaults *defaults = [NSUserDefaults standardUserDefaults];
    [defaults setInteger:-1 forKey:@"vehicleIndex"];
    [defaults synchronize];
    NSLog(@"set index to -1");
} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-12T01:36:58.490

这可能与 Core Data 为有序的一对多关系自动生成的访问器中的一个已知错误有关。

[rdar://10114310](http://openradar.appspot.com/10114310)

Until this is addressed you need to provide your own implementation for the missing accessors.

See answers to [this question](https://stackoverflow.com/questions/7385439/exception-thrown-in-nsorderedset-generated-accessors)

# visual-c++ - C++/OpenGL国际象棋游戏程序设计建议

> ID：12379873
> 
> 赞同：2
> 
> 时间：2012-09-12T00:52:56.797
> 
> 标签：visual-c++, opengl, visual-studio-2012, game-development, game-ai

我正在制作一个用 OpenGL 渲染的国际象棋游戏。

我不是在找人来告诉我所有的答案，我想自己弄清楚代码，但我真正需要的是指出正确的概念。在这一点上，我不知道从哪里开始。这是我发现的：

一个枚举，`TurnState`，具有以下值：

*   `playerOneTurn`
*   `playerTwoTurn`
*   `Stopped`

一个枚举，`GameState`，具有以下值：

*   `playerOneCheck`
*   `playerTwoCheck`
*   `playerOnecCheckMate`
*   `PlayerTwoCheckMate`
*   `InitializingGame`
*   `Tie`
*   `NormalPlay`

一个抽象类 ,`Player`和一个子类 , `Computer`。

具有以下字段的类`ChessGame`：

```
Player p1, p2
TurnState turnState
GameState gameState 
```

具有以下字段的类`Move`：

```
*Piece
Location origin
Location destination 
```

具有以下字段的类`Location`：

```
row
col
*ChessBoard 
```

一个类, `ChessBoard`, 有一个方法, `isValid`, 它接受 a`Move`并检查移动是否有效。

具有以下方法的抽象类`ChessPieces`：

```
GetValue()      // returns an int value of the piece (for scoring)
GetPosition()   // returns the current position of a piece
getIsSelected() // returns a boolean, true if selected, false if unselected
move()          // moves the piece in a way dependent upon what piece 
```

以及以下子类：

*   `Pawn`
*   `Rook`
*   `Queen`
*   `King`
*   `Knight`

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-12T02:46:30.340

至于国际象棋的AI部分：

要获得国际象棋 AI 或任何类型的回合制游戏 AI，您需要计算给定回合中游戏的“价值”（这很重要）（即，您为每个棋子分配一个值并将玩家 1 和player2 然后你做 score = player1score - player2score，所以负值将有利于玩家 2 和正值，玩家 1，这只是一个基本的例子，不是一个非常有效的例子，但它是解释什么是“价值”的最基本的方式游戏将是）。

在您可以计算之后，您需要能够计算给定棋盘特定配置的玩家的每一个可能的移动。

有了它，您将能够构建一个决策树，其中您将拥有游戏的当前状态作为根节点。树的下一个“级别”将代表您可以从当前状态（等等）到达的每个可能的状态。重要的是要注意，如果您考虑玩家 1 可能在树的级别上移动，您将在下一个考虑玩家两个可能的移动。

接下来要做的是：

假设玩家 1 将要移动，他将在树中查看直到深度 5（对于国际象棋游戏，您永远不会查看整个树）。所以他会选择一个会为他优化的动作，这意味着：在每个级别他都会考虑他的最佳动作或玩家2的最佳动作（所以他会在最坏的情况下工作），所以他会移动树的下一级中的最高值节点。

要计算节点的值，请执行以下操作： 注意：考虑到根节点的深度为 0，对于 player1，每个奇数深度节点都需要为 maxValue，而对于 player2，每个偶数深度节点都需要为 minValue。

您将树扩展到您定义的最大深度，对于 maxDepth 中的节点，您只需计算板的值（我在答案开头提到过），对于上层节点，您将执行以下操作：

偶数节点的值：所有子节点之间的 minValue 奇数节点的值：所有子节点之间的 maxValue

所以基本上你会根据更深节点的值进行回归以找到节点的值。

嗯，这就是基本的想法，你可以从中研究一些其他的东西，如果你想你可以PM我，我已经在这种搜索上做了一些工作，我只是在这里描述了最基本的想法，以获得有效的代码你需要很多优化技术。

希望它有所帮助

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-12T12:24:44.950

首先：将两者分开：AI 和 GUI/OpenGL。在国际象棋中，将 GUI 和 AI（计算机国际象棋术语中的“引擎”）放在两个不同的进程中并使用预定义的协议进行通信是很正常的。两个最流行的协议是 UCI 和 WinBoard。

对于国际象棋引擎部分，您基本上需要三件事：

1.  董事会/职位代表
2.  叶节点评估函数
3.  一种搜索算法

我建议你阅读：

1.  [国际象棋编程维基](http://chessprogramming.wikispaces.com/)
2.  [TalkChess 计算机国际象棋论坛](http://talkchess.com/forum/index.php)
3.  学习开源计算机国际象棋引擎，例如 Stockfish、Crafty 或 Fruit。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-12T23:18:33.540

这可能不会直接回答您的问题（实际上您的问题是什么？），但您提到您想要指向正确概念的指针。

oysteijo 是对的，其中一个非常重要的概念是将程序的各个部分相互分离。

对于象棋之类的东西，存在许多有效而优雅的国际象棋游戏状态表示。我想说 MVC（模型、视图、控制器）设计模式非常适合国际象棋游戏。

希望这会有意义，如果不是，我建议您多阅读 MVC。

您的模型将主要涉及存储游戏状态表示的数据结构，这就是棋盘。一件作品只能出现在 64 个地点中的一个上，并且作品的类型、数量以及每个作品的作用都有限制。模型将负责处理这些东西。为模型提供用于确定任何给定动作的合法性的逻辑（即，不一定涉及任何给定游戏实例的状态的游戏属性）也是有意义的。

视图是所有与演示相关的代码所在的位置。所有的 OpenGL 都在这里，一个“调试”例程可能（例如）将棋盘的 ASCII 表示打印到控制台。

控制器可能具有与用户交互以处理输入的一些功能。控制器是操作模型（“将 E5 移动到 D3”：控制器中的一个函数可能会调用`model.moveKnight('D3')`）和视图（“以光彩的 3D 画板”：控制器可能会执行类似调用的操作`openGLView.draw(model)`）的代码部分

MVC 帮助实现的主要目标之一是执行不同任务的代码部分的独立性。如果您的 AI 中的某些更改导致渲染算法出现问题，那将是一个令人沮丧和困难的位置。经验丰富的程序员会竭尽全力确保不会发生这种情况。

此时您可能想知道您的 AI 代码在哪里适合。好吧，这真的取决于你。用你最好的判断。它可能是控制器的一部分。就我个人而言，我希望它是一个`chessAIController`实现 AI 算法的完整的另一个控制器（

关键是，你实际上如何组织代码并不重要，只要它以某种合乎逻辑的方式完成即可。MVC 如此普遍的原因是这三个组件通常存在于大多数软件中，并且通常将它们分开是有意义的。请注意，它们实际上并没有真正分开......控制器通常直接操作视图和模型。诸如不允许视图操作任何东西的限制有助于代码保持干净和可理解。

当您在一个编程项目中没有结构或组织时，几乎不可能避免使用庞大的例程来完成*所有事情*，因为代码中实际上只有一个地方可以构建功能。这总是会产生一堆乱七八糟的意大利面条代码，无论多么高级，任何语言都无法拯救你。这会创建很糟糕的代码，因为没有其他人可以理解它，甚至在编写后两周内你也无法理解它。

# r - r 中的 if 语句？

> ID：12379875
> 
> 赞同：-2
> 
> 时间：2012-09-12T00:53:22.313
> 
> 标签：r, eigenvalue

我不确定我在这里做错了什么。

```
ee <- eigen(crossprod(X))$values
for(i in 1:length(ee)){
if(ee[i]==0:1e^-9) stop("singular Matrix")} 
```

使用特征值方法，我试图确定矩阵是否是奇异的。我试图找出矩阵的特征值之一是否在 0 到 10^-9 之间。如何正确使用 if 语句（如上）来实现我的目标？有没有其他方法可以解决这个问题？

如果我想连接向量中的零特征值怎么办

```
zer <-NULL
ee <- eigen(crossprod(X))$values 
for(i in 1:length(ee)){ 
if(abs(ee[i])<=1e-9)zer <- c(zer,ee[i])} 
```

我可以这样做吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-12T01:18:15.170

@AriBFriedman 非常正确。但是，我可以看到其他一些问题

*   `1e^-9`应该是`1e-9`。
*   `0:1e-9`返回`0`, (`:`在 0 和 1e-9 之间创建一个序列，因此仅返回`0`。有关`?`:``详细信息，请参阅
*   `==`由于浮点运算，使用小数会导致问题

在书面形式中，您的代码（单独）检查元素是否`ee[i] == 0`不是您想要的（在浮点运算方面也没有意义）

您正在寻找特征值小于这个小数的情况，因此请使用小于 ( `<`)。

你正在寻找的是类似的东西

```
if(any(abs(ee) < 1e-9))  stop('singular matrix') 
```

如果你想得到`0`（或小的）特征向量，那么使用`which`

```
# this will give the indexs (which elements are small)
small_values <- which(abs(ee) < 1e-9))
# and those small values
ee[small_values] 
```

不需要`for`循环，因为所做的一切都是矢量化的。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-12T00:54:33.340

`if`*接受长度为 1*的单个参数。

尝试使用`ifelse`或使用`any()`或`all()`将逻辑向量转换为长度为 1 的逻辑向量。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-12T01:22:36.010

这是一个重现您的数据的示例：

```
X <- matrix(1:10,1:10)
ee <- eigen(crossprod(X))$values 
```

这将测试are AND`if` `any`的值`ee``> 0``< 1e-9`

```
if (any((ee > 0) & (ee < 1e-9))) {stop("singular matrix")} 
```

# mysql - Flexviews - 启动 consumer_safe.sh 的问题

> ID：12379878
> 
> 赞同：1
> 
> 时间：2012-09-12T00:53:37.727
> 
> 标签：mysql

我使用以下命令运行了 consumer_safe.sh：

> ./consumer_safe.sh --ini=consumer.ini &

我得到输出“正在重新启动 FlexCDC！” 不断地。
即使我看到进程正在运行，它看起来好像服务器也没有成功启动。

我创建了一个表并运行 add_table.php，但我可以看到在我从测试表中添加和删除行之后，更改日志表没有更新。

我检查了 flexcdc.err，唯一的内容是： Max_allowed_pa​​cket: 536870912

有没有其他人遇到过这个或有任何想法？

# c# - 获取 Visual Studio 以使用自定义主机 factoryType 突出显示 Razor 语法

> ID：12379879
> 
> 赞同：10
> 
> 时间：2012-09-12T00:53:49.917
> 
> 标签：c#, razor, asp.net-mvc-4, visual-studio-2012

这是场景，我扩展[了 MvcWebRazorHostFactory](http://msdn.microsoft.com/en-us/library/system.web.mvc.mvcwebrazorhostfactory%28v=vs.98%29.aspx)，所以我可以在构建时做一些额外的视图魔术。确切的魔法并不重要。

我的 ~\Views\Web.config 中的注册如下所示：

```
<host factoryType="StackExchange.MyNamespace.MyFactory, StackExchange.MyNamespace" /> 
```

项目中有相应的程序集，该程序集的副本位于 \lib 文件夹中，并且我已确认它已按预期复制到 \bin。此外，**实际的视图魔术确实**在构建视图时发生，因此 ASP.NET 本身实际上是在查找所有内容。

**什么在 Visual Studio (2012) 的 Razor Syntax Highlighting**中不起作用。

![在此处输入图像描述](../Images/e5778c4562f5ed2f980162fa1dda5908.png)

上面是语法高亮失败的快照。通常，不能找到任何不在命名空间中的内容`@using`（因此会得到红色波浪下划线），并且该`@model`指令不起作用。这表明我们在 Web.config 中[自动包含命名空间](http://msdn.microsoft.com/en-us/library/system.web.configuration.namespacecollection)时遇到了一些麻烦。

错误的工具提示`@model`是“当前上下文中不存在名称‘模型’”。

通过反复试验，我将根本原因缩小到上述`host`配置部分，尽管我们对 Razor 进行了一些其他调整（例如自定义[pageBaseType](http://msdn.microsoft.com/en-us/library/system.web.configuration.pagessection.pagebasetype.aspx)），但那一行破坏了一切。

到目前为止我尝试过的事情：

*   强命名程序集
*   在 GAC 中安装程序集
    *   [该页面](https://github.com/meleze/Meleze.Web)暗示这是必要的。

当强烈命名我的 ~\Views\Web.config 最终看起来像这样：

```
<host factoryType="StackExchange.MyNamespace.MyFactory, StackExchange.MyNamespace, Version=1.0.0.0, Culture=neutral, PublicKeyToken=b61d663b67b05bd2" /> 
```

我使用“gacutil -l”针对 GAC 检查了版本、文化和 PublicKeyToken。

我想另一个可能的故障点是 GAC 本身，因为我的盒子上有大量的 .NET 版本。程序集和网站都是使用 .NET 4.5 构建的（均引用 MVC 4、Razor 2 等）。`gacutil`我在调试时使用的路径是`Program Files (x86)\Microsoft SDKs\Windows\v8.0A\bin\NETFX 4.0 Tools\gacutil.exe`.

有时，在我筛选根本原因的过程中，我会在视图的第一行收到一条错误消息，大意是“找不到 StackExchange.MyNamespace.MyFactory”。下划线将是“其他错误”颜色（VS2012 Dark Theme 中的紫色）。我无法可靠地重现它，所以我无法获得屏幕截图。

* * *

所以我的问题是，有谁知道如何让 Visual Studio（再次 2012 年）使用自定义主机工厂正确处理 Razor 视图？

我目前对修复的最佳猜测是做一些非常hacky的Web.config替换，所以我在编辑时有一个配置，在调试时有另一个。虽然真的不喜欢这个想法。

看起来这应该可以工作，而且 Visual Studio 只是在寻找它需要的东西时遇到了麻烦。我只是不知道那是什么。

* * *

更多实验后更新。

我有更多的开发人员来重现它`<host pageFactoryType="...">`，包括在 vanilla MVC4 应用程序中（显然，上面的示例来自 StackOverflow 解决方案；它可能有些笨拙）。

不过，我们找到了解决办法，那就是购买[ReSharper](http://www.jetbrains.com/resharper/)许可证。不是一个很好（或便宜）的解决方法，但仍然是一个解决方法。

安装 ReSharper 后，一切正常。如果您有自定义`<pages pageBaseType="...">`注册，则该类型*必须*在同一个项目中，否则您将无法获得智能感知以供`@this.Model`参考（`@model`尽管该指令有效）。

* * *

更多更新。

**如果**您对其进行强命名并将其安装在 GAC 中，则看起来像无操作 HostFactory（扩展 MvcRazorHostFactory 但不覆盖任何方法或包含任何其他代码）工作正常。我相信我在之前测试时使用了错误的 GAC，但是（通过一些外部刺激）能够使用明确的 x64 gacutil 使其工作。

现在的麻烦是找出我的特定主机工厂出了什么问题；更多细节随着他们被发现。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-13T19:41:15.643

经过与微软的一些讨论，我们找到了这个问题的根本原因。

[像往常一样，这是我的代码](http://www.codinghorror.com/blog/2008/03/the-first-rule-of-programming-its-always-your-fault.html)。

根本错误是自定义 factoryType 中的 MVC3 引用，尽管项目（及其周围的一切）是**MVC4**。

总结一下，让 Visual Studio IntelliSense 在 .cshtml 文件中使用自定义`<host factoryType>`：

*   你必须强命名你的程序集
*   您必须在 GAC 中安装程序集
    *   我们仍然针对本地副本进行调试和部署，但 VS 将查看 GAC
*   您*必须*拥有所有正确的参考资料*

请注意，您需要在安装到 GAC 后重新启动 Visual Studio，仅仅重新加载解决方案（通常）是不够的。我们还发现，一些（但不是全部）ReSharper 安装需要清除其缓存，以确保清除缓存。

添加对驻留在 GAC 中的程序集的引用时的一个小问题是 Visual Studio 默认不会将其复制到您的输出目录，这可能对您有用，但给我们带来了问题。您可以在参考的属性中更改它。

![在此处输入图像描述](../Images/126451fccaed4be634cd492d7671ae60.png)

此外，如果您的自定义工厂抛出任何异常，Visual Studio*会给*您一些错误消息（“其他错误”紫色下划线我之前无法可靠地重现）；除了可能在它的构造函数中（这似乎有点不一致）。

在我们遇到的情况下，您没有得到任何帮助，类型本身存在严重问题。事情在运行时工作只是一个巧合（我们正在使用的接口在 MVC3 和 MVC4 之间没有改变，剩下的就是弱命名）。

[*如果您像我们一样安装了 MVC beta 1 到 4，请注意此步骤中的 PEBKAC。]

# javascript - 结合两个javascript函数？

> ID：12379883
> 
> 赞同：0
> 
> 时间：2012-09-12T00:54:19.787
> 
> 标签：javascript, forms, validation, function

我怎样才能结合这两个功能，使他们都工作？现在，我只能让一个来验证，而不是另一个。

JAVASCRIPT 示例：

```
function validateForm() {

var x=document.forms["giftCert"]["gift_name"].value;

if (x==null || x=="") {

errMsg = "The recpient's name is required.";              
    $("div#emptyName").show();
    $("div#emptyName").html(errMsg);

return false;
  }
}

function validateForm() {

var x=document.forms["giftCert"]["gift_email"].value;

if (x==null || x=="") {

errMsg2 = "The recpient's email address is required.";              
    $("div#emptyEmail").show();
    $("div#emptyEmail").html(errMsg2);

return false;
  }
} 
```

表单 HTML 的简短版本：

```
<form action="http://ww6.aitsafe.com/cf/voucher.cfm" method="post" name="giftCert" onsubmit="return validateForm()"  />
    *Name:<input type="text" name="gift_name">
    <div id="emptyName" class="error"></div>

    *Email: <input type="text" name="gift_email">
    <div id="emptyEmail" class="error"></div>

    <input class="button" type="submit" value="Add to Cart" />

</form> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-12T01:46:10.260

您可以将代码放在同一个函数中。

```
function validateForm() {
    return ["Name", "Email"].every(function(type) {
        var lower_type = type.toLowerCase(),
            x=document.forms["giftCert"]["gift_" + lower_type].value;

        if (x==null || x=="")
            $("div#empty" + type).show().html("The recpient's " + lower_type + " is required.");
        else
            return true;
    });
} 
```

由于大部分代码几乎相同，您可以将`"Name"`和`"Email"`值放入一个数组中，然后循环该数组，调用相同的代码，在需要的地方放入适当的值。

这使用`Array.prototype.every`来指示 Array 中的每个值是否通过验证。

如果任一项目验证失败，则返回`undefined`，循环停止并`validateForm`返回`false`。

每个通过验证的项目都返回`true`. 如果所有项目都通过验证，`.every`将返回`true`，并且表单继续。

* * *

如果您想确保所有验证都运行，您可以使用`.filter()`, 并`true`在失败时返回，以便它将一个项目添加到结果数组中。如果没有失败，则 Array 将为空。

然后测试`.length`Array 的 ，并返回与 的比较`0`。

```
function validateForm() {
    return ["Name", "Email"].filter(function(type) {
        var lower_type = type.toLowerCase(),
            x=document.forms["giftCert"]["gift_" + lower_type].value;

        if (x==null || x=="") {
            $("div#empty" + type).show().html("The recpient's " + lower_type + " is required.");
            return true;
        }
    }).length === 0; // will be true if no validation failures
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-12T00:59:36.223

完成后让它调用第二个。

或者有一个调用它们的第三个函数，并在你的 onsubmit 中有它。该函数将看到两个函数的返回值，并且仅当它们都返回 true 时才返回 true。

或者只是将第二个的代码放在第一个中，因为无论如何它都是相似的。您也可以摆脱一些重复的代码。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-12T01:00:17.310

当您重用相同的函数名称时，每个后续函数声明都将覆盖任何前面的条目。将验证保存在单独的函数中可能是最简单的，因此您应该适当地命名它们并创建一个驱动程序函数来调用它们。例子：

```
function validateForm() {
  return validateName && validateEmail();
}

function validateName() {

  var x=document.forms["giftCert"]["gift_name"].value;

  if (x==null || x=="") {

    errMsg = "The recpient's name is required.";              
    $("div#emptyName").show();
    $("div#emptyName").html(errMsg);

    return false;
  }

  return true;
}

function validateEmail() {

  var x=document.forms["giftCert"]["gift_email"].value;

  if (x==null || x=="") {

    errMsg2 = "The recpient's email address is required.";              
    $("div#emptyEmail").show();
    $("div#emptyEmail").html(errMsg2);

    return false;
  }

  return true;
} 
```

此外，您可以将两者结合起来，但这几乎没有那么灵活：

```
function validateForm() {

  var name =document.forms["giftCert"]["gift_name"].value;

  if (name == null || name == "") {

    errMsg = "The recpient's name is required.";              
    $("div#emptyName").show();
    $("div#emptyName").html(errMsg);

    return false;
  }

  var email = document.forms["giftCert"]["gift_email"].value;

  if (email == null || email == "") {

    errMsg2 = "The recpient's email address is required.";              
    $("div#emptyEmail").show();
    $("div#emptyEmail").html(errMsg2);

    return false;
  }

  return true;
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-12T01:01:48.843

简短的回答就是这样做

```
function validateForm() {

var x=document.forms["giftCert"]["gift_name"].value;

if (x==null || x=="") {

    errMsg = "The recpient's name is required.";              
    $("div#emptyName").show();
    $("div#emptyName").html(errMsg);

    return false;
}
x=document.forms["giftCert"]["gift_email"].value;

if (x==null || x=="") {

    errMsg2 = "The recpient's email address is required.";              
    $("div#emptyEmail").show();
    $("div#emptyEmail").html(errMsg2);

   return false;
  }
} 
```

更长的答案是您的函数必须具有唯一的名称。此外，您在部分代码中使用 jquery 为什么不使用它来访问您的表单？此外，从 HTML 调用函数通常被认为是不好的做法。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-09-12T01:02:47.250

一种可能的解决方案：

```
function validateForm() {

    var x=document.forms["giftCert"]["gift_name"].value,
        y = document.forms["giftCert"]["gift_email"].value,
        error = false;

    if ( !x ) {
        errMsg = "The recpient's name is required.";              
        $("div#emptyName").html(errMsg).show();
        error = true;
    }

    if ( !y ) {
        errMsg2 = "The recpient's email address is required.";              
        $("div#emptyEmail").html(errMsg2).show();
        error = true;
    }

    if (error === true) return false;

}​ 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-09-27T18:40:12.597

对于想知道如何将两个函数合二为一的人，这是我为此创建的一个函数：

```
function combineFunctions() {
    var args = Array.prototype.slice.call(arguments, 0);
    return function() {
            for (var i = 0, len = args.length; i < len; i++) {
                if (typeof args[i] === "function") {
                    args[i].apply(this, arguments);
                }
            }
    };
} 
```

然后结合到功能：

```
var myFunc = function() { console.log('1'); };
var myOtherFunc = function() { console.log('2'); };

var myCombinedFunc = combineFunctions(myFunc, myOtherFunc);
myCombinedFunc(); // outputs 1, then 2 to the console 
```

*注意：这仅适用于具有相同参数的函数——非常适合将函数添加到事件处理程序*

# r - 如何使用 RCurl 获取数据？

> ID：12379884
> 
> 赞同：0
> 
> 时间：2012-09-12T00:54:24.767
> 
> 标签：r, rcurl

我想用 Rcurl 获取数据，当我下载网络时，我想要的数据不在文件中，我该如何获取它，任何线索将不胜感激。

```
require(RCurl)
url="http://hk.ishares.com/product_info/fund/holdings/SEHK/2823.htm?ls=true&  l=en&periodCd=d"
data=getURL(url)
write(file="data.html",data) 
```

您可以在网络上看到的以下数据不在 data.html 中，我该如何获取？

```
% Net Assets    Name    Exchange Ticker     Trading Exchange    SEDOL   Market Price    
(HKD equivalent)    Shares Held     Market Value  
(HKD equivalent)    Sector   
9.17    PING AN INSURANCE (GROUP) CO. OF C  601318  XSHG    B1SVWB6     50.40       81,991,646  4,132,780,718   Financials  
6.25    CHINA MERCHANTS BANK CO. LTD A  600036  XSHG    6518723     12.41     227,242,375   2,819,477,954   Financials  
4.86    SHANGHAI PUDONG DEVELOPMENT BANK C  600000  XSHG    6182043     9.15    239,651,727     2,192,915,873   Financials 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-25T17:01:37.700

您的 RCurl 拉取基本上只是下载您连接到它的任何内容。因此，您的输出最终只是该页面底层的 HTML。我在帮助你方面处于语言劣势（我不会说或读中文），但从我在页面源代码中看到的情况来看，看起来大多数数据都是使用 JavaScript 调用的。当您执行`getURL()`.

您最好的解决方案是确定是否有某种 API 可以让您提取实际数据，而不仅仅是复制 HTML 本身。我不确定他们是否提供。但是，另一个完全合理的选择是将数据作为电子表格获取。页面上似乎有一个[链接](http://hk.ishares.com/product_info/fund/excel_holdings.htm?ls=true&periodCd=d&%20%C3%82%C2%A0l=en&ticker=2823)可以获取包含数据的 CSV 文件。您可以抓住它，然后使用`readlines()`或类似的东西将其解析为数据。我有时会抓取 CSV 数据进行工作，并使用以下内容将其放入数据框中：

```
out <- postForm("https://the.api.com/api", token="abcd", format="csv")
mydf <- read.table(textConnection(out),header=TRUE,sep=",",quote="\"") 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-25T17:26:11.520

请注意，在该页面上，有一个“下载”链接指向[http://hk.ishares.com/product_info/fund/excel_holdings.htm?ls=true&periodCd=d&%20%C3%82%C2%A0l= en&ticker=2823](http://hk.ishares.com/product_info/fund/excel_holdings.htm?ls=true&periodCd=d&%20%C3%82%C2%A0l=en&ticker=2823)。

也许你可以用它来下载数据？

[我的包](https://r-forge.r-project.org/R/?group_id=1113)中有一个名为`getHoldings.iShares`（将由 调用`getHoldings`）的函数，可以从美国网站下载 iShares ETF 的持有量。[`qmao`](https://r-forge.r-project.org/R/?group_id=1113)

我在美国 iShares 网站上找不到确切的 ETF，但这将获得**富时中国 25 指数基金**的持有量。也许您可以查看[代码](https://r-forge.r-project.org/scm/viewvc.php/pkg/qmao/R/getHoldings.iShares.R?view=markup&root=twsinstrument)并对其进行修改以在中文站点上使用。

[**警告：** iShares.com 比我跟踪的任何其他 ETF 网站更频繁地更改其 ETF 持股电子表格的格式，因此这可能会在未来中断。]

您首先需要安装[`qmao`软件包](https://r-forge.r-project.org/R/?group_id=1113)

```
> library(qmao)
> getHoldings("FXI")
$iShares
[1] "FXI.h"

Warning message:
In FUN("FXI"[[1L]], ...) :
  FXI has some holdings with duplicate Symbols: -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- --
> head(FXI.h)
           FXI.Weight         ISIN        Sedol     Symbol
X..             10.33 HK0941009539 6073556      941       
X...1            9.20 CNE1000002H1 B0LMTQ3      939       
X99B1G1QD3       8.21 CNE1000003G1 B1G1QD8      1398      
X...2            7.00 HK0883013259 B00G0S5      883       
X...3            5.96 CNE1000001Z5 B154564      3988      
X...4            4.12 CNE100000Q43 B60LZR6      1288      
                                   Name Market.Value Market             Sector
X..                    CHINA MOBILE LTD    474724703   XHKG Telecommunications
X...1         CHINA CONSTRUCTION BANK-H    422947063   XHKG         Financials
X99B1G1QD3     IND & COMM BK OF CHINA-H    377377292   XHKG         Financials
X...2                         CNOOC LTD    321489999   XHKG          Oil & Gas
X...3               BANK OF CHINA LTD-H    273700485   XHKG         Financials
X...4      AGRICULTURAL BANK OF CHINA-H    189355603   XHKG         Financials
           Exchange.Rate Market.Price Shares.Held
X..                 7.75        11.09    42794500
X...1               7.75         0.68   619833320
X99B1G1QD3          7.75         0.59   642996995
X...2               7.75         2.02   159155000
X...3               7.75         0.38   724190000
X...4               7.75         0.39   486089000 
```

# ruby-on-rails - 不是公认的存储提供商（Mongoid、Carrierwave 和 S3

> ID：12379890
> 
> 赞同：3
> 
> 时间：2012-09-12T00:54:59.503
> 
> 标签：ruby-on-rails, mongoid, carrierwave

我正在使用带有 mongoid 支持的 Carrierwave

```
gem "carrierwave-mongoid", :git => "git://github.com/jnicklas/carrierwave-mongoid.git", :branch => "mongoid-3.0",:require => 'carrierwave/mongoid' 
```

我将carrierwave配置为将雾存储与AWS（S3）一起使用

```
# config/initializers/carrierwave.rb
CarrierWave.configure do |config|
    config.storage = :fog
    config.root = Rails.root.join('tmp') # adding these...
    config.cache_dir = 'carrierwave' # ...two lines
    config.fog_credentials = {
        :provider => 'AWS',
        :aws_access_key_id => '',
        :aws_secret_access_key => ''
    },
    config.fog_directory = 'alzheimer'
end 
```

我有一个名为 Picture 的类与上传器和上传器一起使用

```
class ImagenUploader < CarrierWave::Uploader::Base
    include CarrierWave::MimeTypes
    include CarrierWave::RMagick
    storage :fog
    process :set_content_type
    process :convert => 'png'
    def filename
        super.chomp(File.extname(super))+'.png'
    end
    version :thumb do
        process :resize_to_fit => [24,24]
    end
end 
```

而我的图片模型类图片包括 Mongoid::Document 包括 Mongoid::Timestamps 包括 Mongoid::Paranoia belongs_to :user

```
 field :descripcion, :type => String
     field :titulo, :type => String
     field :imagen, :type => String

     attr_accessible :imagen, :imagen_cache, :descripcion, :titulo
     mount_uploader :imagen, ImagenUploader
 end 
```

我尝试上传图片，广告我得到：

```
ArgumentError: is not a recognized storage provider
from /Users/msdark/.rvm/gems/ruby-1.9.3-p194/gems/fog-1.5.0/lib/fog/storage.rb:33:in new'
from /Users/msdark/.rvm/gems/ruby-1.9.3-p194/gems/carrierwave-0.6.2/lib/carrierwave/storage/fog.rb:106:inconnection' 
```

我使用 rails 3.2.8 ruby​​ 1.9.3p194 和 unicorn (4.3.1)

上传后尝试显示此错误：

```
image_tag(picture.imagen_url) 
```

任何想法？

编辑：

宝石文件

```
source 'https://rubygems.org'
gem 'rails', '3.2.8'
group :assets do
   gem 'sass-rails',   '~> 3.2.3'
   gem 'coffee-rails', '~> 3.2.1'
   gem 'therubyracer', :platform => :ruby
   gem 'uglifier', '>= 1.0.3'
   gem 'jquery-rails'
   gem 'jquery-ui-rails'
   gem 'less-rails-bootstrap'
end

gem 'unicorn'
gem 'heroku'
gem 'foreman'

gem 'i18n'
gem 'formtastic'
gem "activeadmin-mongoid",  git: "git://github.com/elia/activeadmin-mongoid.git"
gem 'mongoid'
gem 'bson_ext'
gem 'devise'
gem 'devise-i18n'
gem 'omniauth'
gem 'omniauth-twitter'
gem 'omniauth-facebook'

gem "carrierwave-mongoid", :git => "git://github.com/jnicklas/carrierwave-mongoid.git", :branch => "mongoid-3.0", :require => 'carrierwave/mongoid'
gem 'mini_magick', :git => 'git://github.com/probablycorey/mini_magick.git'

gem 'recaptcha',            :require => 'recaptcha/rails'
gem 'googlecharts'

group :test do 
gem 'capybara'
gem 'database_cleaner'
gem 'mongoid-rspec'
gem 'launchy'
gem 'factory_girl_rails'
gem 'mongoid-rspec'
gem 'faker'
end 
gem 'rspec-rails',:group =>[:development,:test] 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-03T05:22:55.467

我有一个类似的问题。事实证明，我的上传器没有与配置中定义的内容匹配的存储引擎。我在 Carrierwave 配置中（在初始化程序中）做了一个窥探，并查看了 storage_engines。

```
[5] pry(main)> config.storage_engines
=> {:file=>"CarrierWave::Storage::File", :fog=>"CarrierWave::Storage::Fog"} 
```

然后我确保上传者的设置与此处的条目之一匹配。所以在你的情况下，如果你有

```
class ImagenUploader < CarrierWave::Uploader::Base
  ...
  storage :fog
  ...
end 
```

那么您需要确保`:fog`在您使用的配置上下文中有一个条目。你可以从那里回溯。

我意识到这是一个稍微老一点的问题，但如果你还没有弄清楚，我希望这会有所帮助。

# php - PHP提交带有变量名称的可变数量字段的表单，检查是否至少设置了一个

> ID：12379891
> 
> 赞同：0
> 
> 时间：2012-09-12T00:55:08.183
> 
> 标签：php, forms, isset, name-attribute

好的，所以我的标题可能有点混乱，但让我解释一下我的情况：

我有一个很大的表格，里面有很多字段，有些是必需的，有些不是。我使用 JS 进行验证，但随后我也在使用 PHP 在服务器端进行验证。

我要求用户提供的一件事是“标题名称”。现在，标题名称具有“header1”的名称属性。用户可以选择在表单上添加更多标题字段。因此，如果他们单击一个按钮，它会添加另一个具有名称属性“headerx”的“Header Name X”。

知道了？现在，问题是，通常这些标头字段不是必需的，但我确实有条件，它们必须提供至少一个标头字段。所以他们可以提供 100 个，他们可以提供 2 个，他们可能提供 1 个，但是如果他们不提供任何一个，那么验证应该会失败。

我想不出在 PHP 中检查这个的好方法。我知道您的第一个想法就是检查 $_POST 是否包含任何内容。但是不起作用，因为它们是此表单中的多个其他字段，它们是必需的，与这些标题无关。所以我不能简单地检查 $_POST 是否包含某些东西，因为它总是会。

有没有一种方法可以让我喜欢将 isset() 与正则表达式结合起来？像 isset($_POST['header{\d+}']. 这就是说像标题后面至少有一个数字。

谢谢您的帮助！

**编辑：**哦，如果这还不够难，标题字段的数量是无限的。所以我不能只遍历所有可能的“headerx”，因为那显然是一个无限循环。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-12T01:01:19.430

您可以使用 [] 来命名字段：

```
<input type="text" name="foo[]" value="x" />
<input type="text" name="foo[]" value="y" /> 
```

然后 $_POST 就像：

```
array('foo' => array('x', 'y')); 
```

你甚至可以有关联数组：

```
<input type="text" name="foo[bar][first]" value="x" />
<input type="text" name="foo[bar][second]" value="y" /> 
```

看起来像：

```
array('foo' => array('bar' => array('first' => 'x', 'second' => 'y'))) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-12T01:01:06.020

您可以像这样遍历元素：

```
$i = 1;
while($row = $_POST['header' . $i++]){
    //do stuff
} 
```

这将一直持续到没有更多的顺序元素为止。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-12T01:02:38.667

为什么不简单地这样看待它：在另一端的 JS 中，当您进行验证时，最后一次检查检查以验证是否发送了标头 - 它通过了，在表单中设置一个隐藏字段一个*真正*的值 - 然后在您的 PHP 中，您可以检查该特定元素，而不必担心发送的每个可能的标头。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-12T01:05:34.083

```
if(!count(preg_grep('@^header\d+$@',array_keys($_POST))))
{
  //no header submitted
} 
```

这将允许根据要求使用 RegExp，但我也更喜欢 jpic 的解决方案

# android - setMessage() 和 setView() 之间的 AlertDialog 文本大小差异

> ID：12379894
> 
> 赞同：0
> 
> 时间：2012-09-12T00:55:15.727
> 
> 标签：android, android-alertdialog, font-size

使用 setMessage() 将文本作为 CharSequence 放入 AlertDialog 框会导致文本以默认系统大小显示。

但是，如果文本是 TextView 对象，则使用 setView() 添加它，结果输出是一个小字体。

我知道我可以为 TextView 对象定义特定的字体大小（毕竟这就是重点），但是我如何/在哪里告诉项目使用与 setMessage() 相同的字体大小设置？由于 setMessage() 的结果字体大小取决于用户在其设备上设置的系统设置，我希望能够满足视障用户的需求，而无需求助于我的字体大小菜单应用程序。

或者，如果有人知道使用 setMessage() 将 SpannableString 推送到 AlertDialog 的方法，那也是一个合适的解决方案......

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-12T01:30:53.983

请参阅[排版](http://developer.android.com/design/style/typography.html)

您可以将字体大小设置为`18sp`for `Medium size`（由 使用`setMessage()`），并且关于用户偏好，`sp`它本身将根据它进行缩放。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-12T06:57:09.803

这样做以获得默认字体大小：

```
float size = new TextView(this).getTextSize(); 
```

然后将该值设置为您正在使用的 TextView 对象。

# ruby-on-rails - form_tag 不工作

> ID：12379897
> 
> 赞同：0
> 
> 时间：2012-09-12T00:55:51.877
> 
> 标签：ruby-on-rails, forms

我写了以下代码：

```
<h1>Add new book</h1>
<%= form_tag :action => 'create' do %>
<p><label for="book_title">Title</label>:
<%= text_field 'book', 'title' %></p>
<p><label for="book_price">Price</label>:
<%= text_field 'book', 'price' %></p>
<p><label for="book_subject">Subject</label>:
<%= collection_select(:book, :subject_id, @subjects, :id, :name) %></p>
<p><label for="book_description">Description</label><br/>
<%= text_area 'book', 'description' %></p>
<%= submit_tag "Create" %>
<%= end %>
<%= link_to 'Back', {:action => 'list'} %> 
```

我不知道为什么，但由于某种原因，它给了我两个错误：

```
/Developer/Rubyonrails/library/app/views/book/new.html.erb:14: syntax error, unexpected keyword_ensure, expecting ')'
/Developer/Rubyonrails/library/app/views/book/new.html.erb:16: syntax error, unexpected keyword_end, expecting ')' 
```

这是为什么？我该如何解决？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-12T00:57:26.700

`end`不应该在字符串发射器中，而是嵌入 Ruby 代码：

```
<%= form_tag :action => 'create' do %>
  ...
<% end %> 
```

# java - 将虚拟文件夹添加到 Web 动态项目

> ID：12379898
> 
> 赞同：2
> 
> 时间：2012-09-12T00:55:56.490
> 
> 标签：java, eclipse, tomcat, contextpath

现在我正在尝试在 Eclipse Juno 和 Tomcat 7 上完成一个项目，该项目需要一个“虚拟文件夹”来保存多媒体文件（如图像、其他子页面等）。我已经有一些方法可以在基于 URI 的语法中给出文件路径（假设我想访问 /Content/Image 中的图像）并且我想将该 URI 映射到 C:\Users\MyUser\Content\image（我我知道我正在将项目绑定到 Windows 系统，但稍后我将在此问题中解决）。

目前我的项目名为 pj，Eclipse 在 eclipse 的 tomcat 实例中创建了一个名为 pj 的上下文（这很有意义）。当我测试我的项目时

```
> http://localhost:8080/pj 
```

它工作正常（它应该）。

但是这里有一个问题：直到现在我还没有找到一种方法来在 tomcat 中创建一个 URI 以实际转到 Content/Image 路径来获取要添加到我的页面的内容（在不健康的地方阅读以将内容保留在 WEB -INF 文件夹，所以我正试图以正确的方式完成它）。另请阅读某处以实现此目标，我必须在上下文中执行以下操作：

```
<context docbase="d:/images" path="/Content/Images"></context> 
```

另请阅读 tomcat 中的内容，要解析 URI，您必须使用上下文来实现该目标（在 URI 的含义与其在文件系统中的位置之间架起一座桥梁）。尽管如此，从tomcat 4开始（如果没有记错的话）它不应该摆弄server.xml，所以在另一个尝试做到这一点时，我尝试在context.xml中的META-INF中实际添加一个上下文，并显示代码前。但是这里还有另一个问题！似乎添加路径标签会使tomcat发疯，如此处所述：http: [//tomcat.apache.org/tomcat-7.0-doc/config/context.html](http://tomcat.apache.org/tomcat-7.0-doc/config/context.html)。

所以我真的在这里陷入困境......我想问的是：

1.  在 Web 项目中实际添加外部文件夹以获取多媒体内容和
2.  它应该如何让它在 Eclipse 中工作？

PS：我问这个是因为在我的项目中的一个方法中，我使用 getLoader 方法返回 InputStream（java.io InputStream NOT Corba）并且它返回空值（这意味着它没有找到它）。

编辑：试图通过手动插入conext来实际摆弄server.xml但没有用，插入相对URI在服务器上不起作用（本地：8080/Content/Image，里面有有效文件）或进入我的主要项目和 getstream 也不起作用

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-14T17:38:55.787

经过一些摆弄、调整等。我想出了一个解决这种情况的方法。就像我说的那样，实际上可以让一个外部文件夹根据需要保存所有多媒体和/或页面。该解决方案的参考之一在这里：[http](http://harkiran-howtos.blogspot.pt/2009/08/map-external-directory-into-your.html) ://harkiran-howtos.blogspot.pt/2009/08/map-external-directory-into-your.html 。

尽管如此，由于某种原因，这不太可能使其在 Eclipse 中工作（或者我失败了一些东西并且无法使其工作）。但是有一个替代解决方案。在 Web 应用程序内部但在 WEB-INF 和 META-INF 文件夹外部实际上有一个用于此目的的文件夹也是可行的。换句话说，一个位于 Web 应用程序根目录中的文件夹。要访问该文件夹中的这些文件，您可以使用称为 ServletContext 的东西。该上下文实际上包含对 Web 应用程序文件夹结构的所有可能引用。要使用给出的上下文访问这些文件，您必须使用 Servlet 上下文中的 getResourceAsStream（或在必要时使用 getRealPath 和/或您可以保证 Web 应用程序在 Tomcat 中展开）。所以换句话说，

PS：用于指出 ServletContext 的 Ty wds

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-03-21T16:46:06.893

我使 harkiran 的解决方案工作，但它不是很好的解决方案。

人们不鼓励使用 getRealPath。出于多种原因，映射外部文件夹是一件好事。

但要在 Eclipse 中执行此操作，您需要转到部署文件夹。就我而言，它是 Eclipse 工作区中的隐藏文件夹。

> 工作区/.metadata/.plugins/org.eclipse.wst.server.core/tmp0/

在该文件夹中，您应该从 harkiran 的解决方案中创建目录结构和文件。我一直在工作，直到您在 Eclipse 中删除并重新创建服务器。

之后，您需要再次制作它。

# jquery - 在打开器窗口上触发 jQuery

> ID：12379900
> 
> 赞同：0
> 
> 时间：2012-09-12T00:56:07.380
> 
> 标签：jquery, window.opener

我正在从主窗口打开一个对话窗口。该对话框用于上传文件。完成后，我希望对话框在打开器窗口中触发 jQuery 函数。似乎这应该有效，但到目前为止还没有。

在主窗口中，我正在打开这样的对话框：

```
jQuery('.modaldataupload').click(function() {
    var newwindow = window.open(jQuery(this).prop('href'), '', 'height=400,width=500,top=200,left=200');
    if (window.focus) {
        newwindow.focus();
    } 
```

这样可行。上传是使用 php 进行的，它有效，并且对话框被重定向到其中包含以下内容的确认页面：

```
<script type="text/javascript">
jQuery(document).ready(function() {
jQuery('#datauploadslist', window.opener.document).val('hello');
});
</script> 
```

在主窗口中，我有一个 div：

```
<div id="datauploadslist"></div> 
```

我不应该在那个div中得到“你好”吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-12T01:16:53.010

使用`text()`而不是`val()`，`val()`设置表单字段的值

# scheme - DR Racket 翻转字母列表

> ID：12379902
> 
> 赞同：0
> 
> 时间：2012-09-12T00:56:25.530
> 
> 标签：scheme, racket

这是 Scheme 中的一个递归函数翻转，它接受任意长度的原子列表作为其唯一参数，并返回翻转了相邻元素的列表。换句话说，该函数交替列表的元素（即，给定一个列表 [a1,a2,a3,a4,a5,a6...,an] 作为参数，产生 [a2,a1,a4,a3,a6 ,a5,...])。如果 n 是奇数，则 an 保留在结果列表的末尾。不使用任何辅助功能。

这是我的样本

```
> (flip '())
()

> (flip '(a))
(a)

> (flip '(a b))
(b a)

> (flip '(a b c d))
(b a d c)

> (flip '(a b c d e))
(b a d c e) 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-12T03:19:06.473

这是作业，所以我不能给你一个直接的答案。以下是解决方案的总体思路，请填空：

```
(define (flip lst)
  (cond ((null? lst)                   ; The list is empty:
         <???>)                        ; return the empty list.
        ((null? (cdr lst))             ; The list has a single element:
         <???>)                        ; return a list with the single element.
        (else                          ; The list has at least two elements:
         (cons <???>                   ; cons the second element ...
               (cons <???>             ; ... to the first element ...
                     (flip <???>)))))) ; ... and advance two elements at once. 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-25T03:16:03.317

(define (flip lst) (cond ((null?lst)
null)
((null? (cdr lst))
lst)
(else
(cons (car (cdr lst))
(cons (car lst)
(flip (cdr (cdr lst)))))))))

# haskell - 我可以减少 ghci 的内存使用量吗？

> ID：12379903
> 
> 赞同：7
> 
> 时间：2012-09-12T00:56:35.320
> 
> 标签：haskell, ghc, ghci

我在具有 512M RAM 的旧 freebsd 机器上安装了 GHC-7.4。一切都很好！但是GHCI一旦启动就占用了太多的RAM。

任何建议表示赞赏！

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-09-12T05:00:19.487

`ghci +RTS -M100M -c30`如果要将堆大小限制为 100MB 并在堆使用率增加到 30% 时使用压缩，则可以使用。

有关运行时标志的更多信息，请参阅[RTS](http://www.haskell.org/ghc/docs/7.4.2/html/users_guide/runtime-control.html)选项。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-12T17:18:26.907

或者，使用编译器而不是解释器。

# xml - 需要一些帮助来理解 AS3 中包的使用

> ID：12379904
> 
> 赞同：1
> 
> 时间：2012-09-12T00:56:42.090
> 
> 标签：xml, actionscript-3

我刚刚开始探索包的使用。我希望函数的结果（作为变量“myXML”）可用于代码的其他元素。我想知道创建一个新的类文件是否可行。例如：

```
package  
{
    import flash.display.Sprite;
    import flash.events.Event;
    import flash.net.URLLoader;
    import flash.net.URLRequest;    

    public class XMLLoad 
    {
        public var myXML:XML;
        public var myLoader:URLLoader = new URLLoader();
        myLoader.load(new URLRequest("http://myWebsite/myFile.xml"));
        myLoader.addEventListener(Event.COMPLETE, processXML);

        public function processXML(e:Event):void 
        {
            myXML = new XML(e.target.data);
            trace(myXML);
        }

    }

} 
```

这是创建全局变量的好方法吗？如果是这样，在 FLA 文件中，我将如何访问/使用保存 XML 数据的 var“myXM”？

```
import XMLLoad;
XMLLoad();
? 
```

非常感谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-12T05:15:24.710

您在课堂上所做的几乎都完成了，但是有一些事情需要纠正：

首先，在类减速的顶层中，您只能定义成员（属性和方法）。目前你正在做的事情很好，但你也试图在这个范围内运行一些实际的代码：

```
myLoader.load(new URLRequest("http://myWebsite/myFile.xml"));
myLoader.addEventListener(Event.COMPLETE, processXML); 
```

这将抛出错误，您的课程将无法运行。要在创建类的实例时立即运行代码，您需要使用 a `constructor`，它是一个与在其中声明的类同名的函数（区分大小写）。将其转换为代码将如下所示，您会注意到我已经创建了构造函数并将罪魁祸首代码放入其中：

```
public class XMLLoad 
{

    public var myXML:XML;
    public var myLoader:URLLoader = new URLLoader();

    // This is the constructor.
    public function XMLLoad()
    {
        myLoader.load(new URLRequest("http://myWebsite/myFile.xml"));
        myLoader.addEventListener(Event.COMPLETE, processXML);
    }

    public function processXML(e:Event):void 
    {
        myXML = new XML(e.target.data);
        trace(myXML);
    }

} 
```

您现在所做的是创建了一个类`XMLLoad`。使用`new`关键字，您可以创建该类的*实例。*在您的情况下，您只需要一个实例来执行您想要的操作，如下所示：

```
var xmlLoad:XMLLoad = new XMLLoad(); 
```

这将创建一个实例`XMLLoad`并将其分配给变量`xmlLoad`，通过它您将能够访问您在该类中定义的属性和方法。我们在上面创建的构造函数也将自动运行，这意味着您的类已经发起了对某些 XML 的请求。

不幸的是，由于对外部数据的请求是*异步*的（也就是说，它们在与您的应用程序的自然流程不同的时间线上执行），我们无法判断 XML 何时完全加载并且我们能够从外部使用它班级。然而，我们可以做的是`XMLLoad`稍微改变类来帮助我们：

```
public class XMLLoad 
{

    public var myXML:XML;
    public var myLoader:URLLoader = new URLLoader();
    private var _callback:Function;

    public function XMLLoad(callback:Function)
    {
        _callback = callback;
        myLoader.load(new URLRequest("http://myWebsite/myFile.xml"));
        myLoader.addEventListener(Event.COMPLETE, processXML);
    }

    public function processXML(e:Event):void 
    {
        myXML = new XML(e.target.data);
        _callback(myXML);
    }

} 
```

我们在这里所做的是修改构造函数以接受对函数的引用，该函数应该接受 type 的参数`XML`。然后我们修改了您的`processXML`函数以执行回调并将接收到的 XML 发送给它。这意味着您现在可以这样做：

```
var xmlLoad:XMLLoad = new XMLLoad(done);

function done(xml:XML):void
{
    trace(xml);
} 
```

这意味着您将能够在该函数中继续您的应用程序，该`done`函数将为您提供完全加载的 XML。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-12T01:18:03.330

1.  创建一个名为“Variables.as”的类

2.  它里面的代码是这样的（*注意：没有函数，只有变量*）：

    ```
    // Define these variables in the normal place where you would 
    // define them in an AS3 class/package

    public static var enabled:Boolean = false;
    public static var configXMLData:XML; 
    ```

3.  用法，导入 Variables.as 并使用 Variables.enable = true 或 trace(Variables.enable) 等调用和设置。将所需变量添加到公共静态 var 列表中。

4.  XML 加载可以在外部类或您的主应用程序中完成。听起来你对 AS3 不太了解（无意冒犯），所以我现在就让它保持简单，并将它放在你的主要课程中。所有代码辅助都在 Adob​​e Live Docs 中（谷歌搜索时有一些关键字供您使用），例如。AS3 LoadXML 谷歌会给你很多例子。注意设置、加载、加载完成、获取数据是你想要的流程。因此，只有在调用 onComplete 函数后，您才能继续使用您的应用程序。

5.  一旦你的 XML 被加载谷歌起来 AS3 E4X 解析。这是一个巨大的主题，您可以在其中使用用于 AS3 的 XML E4X 检索属性和节点内容的值。您需要参考示例并不难。还有一种旧方法是 XML List，您可以找到文档和示例 Adob​​e Live Docs xmlList。一旦您对此有足够的了解，您就可以随意在 Class 文档 Variables.as 中设置变量。无论您在哪里需要它们，您只需在任何您想要的类中调用 Variables.enable。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-09-12T13:58:55.510

Marty Wallace 的回答涵盖了让您的问题得到解答和发挥作用所需知道的一切。不过，我要补充一点，由于您试图将这些变量设为全局，因此存在一个危险的陷阱。

危险在于，每次调用 时`new`，都会获得变量的新实例。很容易意外地创建两组或更多组全局变量，每组都具有不同的值。

有两种解决方案：仅使用`static`变量，或者将类编写为单例。

第一个更简单，只需将`static`关键字添加到变量中，并记住使用`XMLLoad.`variable_name 引用它们，而不是创建新实例。

```
public class XMLLoad {
    public static var myXML:XML;
    public static var myLoader:URLLoader = new URLLoader();
    private static var _callback:Function;

    public static function loadXML(callback:Function):void
    {
        _callback = callback;
        myLoader.load(new URLRequest("http://myWebsite/myFile.xml"));
        myLoader.addEventListener(Event.COMPLETE, processXML);
    }

    public function processXML(e:Event):void 
    {
        myXML = new XML(e.target.data);
        _callback(myXML);
    }
} 
```

然后，再次向 Marty 借用：

```
XMLLoad.loadXML(done);

function done(xml:XML):void {
    trace(xml);
} 
```

这很好，但在更复杂的情况下会变得有点罗嗦和混乱。另一方面，单例以相同的方式工作，但表现得就像一个普通的类。虽然内部工作可能更复杂一些。

```
public class XMLLoad {
    /**
     *  A static variable that holds the actual instance of the class.
     **/
    private static var instance:XMLLoad;

    public var myXML:XML;

    /**
     *  An initialization method that replaces the constructor and creates
     *      (if it didn't already exists) and returns the instance for external
     *      use.
     **/
    public static function GetLoader():XMLLoad {
        if (!instance) {
            instance = new XMLLoad;
        }
        return instance;
    }

    public function loadXML(callback:Function):void {
        _callback = callback;
        myLoader.load(new URLRequest("http://myWebsite/myFile.xml"));
        myLoader.addEventListener(Event.COMPLETE, processXML);
    }

    private function processXML(e:Event):void {
        myXML = new XML(e.target.data);
        _callback(myXML);
    }
} 
```

对此类的调用如下所示：

```
var xmlLoader:XMLLoad = XMLLoad.GetLoader();
xmlLoader.loadXML(done);

function done(xml:XML):void {
    trace(xml);
} 
```

# colors - Highcharts 面积图，在 X 轴上方/下方使用 2 种填充颜色

> ID：12379905
> 
> 赞同：14
> 
> 时间：2012-09-12T00:56:50.727
> 
> 标签：colors, highcharts

在`Highcharts`中，我想用 2 种颜色填充区域图，正值得到一种颜色，负值得到另一种颜色。我已经能够使用 来做到这一点`linearGradient`，但这必须根据`size of the container`.

是否有更通用的方法来执行此操作，例如设置值 >`0 color 1, values < 0 color 2?`

有关更多信息和示例，请参阅我的 JSFiddle：http: [//jsfiddle.net/GNvur/2/](http://jsfiddle.net/GNvur/2/)

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2013-04-15T09:04:48.327

我们要查找的参数名为 `negativeColor`. 在这样的区域系列中使用它：

```
 series: [{
        type:'area',
        data:chartValues,
        color: "#FF0000",
        threshold: 0,
        negativeColor: '#00FFFF',

        marker : {
            enabled: true
        }
    }] 
```

在这个[JSFiddle](http://jsfiddle.net/GNvur/24/)中查看结果。

# arrays - 如何计算 2N 数组中两个子数组的最接近和？考虑找到最优的

> ID：12379907
> 
> 赞同：3
> 
> 时间：2012-09-12T00:57:10.423
> 
> 标签：arrays, algorithm, numbers

这是我的问题。

有一个包含 2N 个元素的未排序数组。所有这些元素都是正整数。问：如何将这个数组分成两个N数组，两个数组的和必须最接近

一个直观的想法是，

1.  将此数组排序为 a1< a2 < a3< ...< a2N 和
2.  将它们分成两个子数组 a1 a3 a5 ... a(2N-1) 和 [a2,a4,...a2N] ，然后在每个数组中切换两个数字，并继续循环使用我们找到两者之间最小的一个大批。

但是这样一来，我们就不能确定我们找到了最优的。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-12T01:50:20.397

这是[分区问题](http://en.wikipedia.org/wiki/Partition_problem)，而且很难（即 NP 完全）。

也就是说，如果您需要实现这一点，那么您建议的贪心算法做得不错。您可以通过确保一个列表并不总是比另一个少一点，方法是从第一个中取 1，从第二个中取 2，从第一个中取 2，...，从第二个中取 1：

```
A = [a1, a4, a5, a8, a9, ..., a(n-2), a(n-1)]
B = [a2, a3, a6, a7, ..., a(n-4), a(n-3), an] 
```

这并不总是给出最佳解决方案，但在大多数情况下它已经足够好了。它还避免了“先行”的偏见。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-12T01:01:49.310

您应该查找[子集和问题](http://en.wikipedia.org/wiki/Subset_sum_problem)。在您的情况下，您正在拍摄 S/2 的子集总和，其中 S 是全套总和。在整数的情况下，有一个简单的动态规划算法可以做到这一点，这是最著名的。不幸的是，这是伪多项式时间。这意味着运行时间是元素*大小的多项式。*这使它成为正常意义上的指数时间，但如果元素不是太大，它可以正常工作。

子集和动态程序需要稍作修改以强制要求恰好 N 个元素 e[i]。令 Q(i, s, n) 为真，当且仅当存在一个子集，该子集由从 1 到 i 中选择的元素总和为 s 且恰好包含 n<=i 个元素。

然后

Q(i, s, n) = Q(i - 1, s, n) 或 Q(i - 1, s - e[i], n - 1)

基本情况说，根本不使用任何元素，子集中的总和和所需数字都必须为零，否则 Q 为假：

Q(0, 0, 0) = true，否则 Q(0, _, _) 为 false。

要得到答案，请计算 Q(2N, k, N), k = 上限(S/2), 上限(S/2)-1, ... 的 DP 表，直到找到真值。

请注意，此问题与子集总和足够接近，使其成为 NP 难题。这意味着真正的多项式时间算法（如您的排序建议）将是最优性的近似值。当然，对于现实目的来说，这可能很好。

# java - 3 层 Java Web 应用程序的读取超时问题

> ID：12379911
> 
> 赞同：0
> 
> 时间：2012-09-12T00:57:46.710
> 
> 标签：java, timeout

我们的 Web 应用程序的结构是 3 层。(Presentation layer, Business layer, DB layer)
所有的业务逻辑都在业务层。
表示层向业务层请求 CRUD 并获取结果以处理用户的请求。
顺便说一句，我们在表示层上配置了读取超时。(3 秒)
在这种情况下，如果一些结果来自业务层的缓慢，用户会收到错误消息，并且正确完成了 CRUD 处理。所以用户再次尝试操作。结果，数据被复制。
如何解决这个问题呢？只是增加读取时间？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-12T01:09:07.637

实现回滚并在达到超时时执行此操作，或者如果您在超时之前完成，则只需提交数据库事务。增加超时并不能解决任何问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-12T05:08:47.957

对于业务层中长时间运行的事务，您应该在表示层上实现类似 COMET 的机制：

1.  用户提交交易，业务层立即返回
2.  事务在业务层的后台执行
3.  表示层定期轮询业务层以检查事务的状态

不幸的是，这种机制通常需要在表示层和业务层中进行一些重大的实现更改。在客户端，javascript 框架提供了这些开箱即用的功能。在服务器端，servlet 3.0 中的异步 Servlet 可能会有所帮助。

单独增加读取超时很简单，但在大多数情况下不会让您摆脱这种情况：如果客户端请求通过代理/防火墙等......，后者可能会在您的表示层之前超时并关闭连接。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-12T03:18:51.740

最好的选择实际上是让客户端收到请求的确认，然后（稍后）确认完成或失败。这涵盖了典型的场景，除了失去联系或工作非常缓慢。

增加超时时间是明智的，对于大多数严肃的工作来说，3 秒的超时时间是不切实际的（如果服务器暂时繁忙或网络延迟怎么办？）。

# c# - 按键事件隧道

> ID：12379912
> 
> 赞同：0
> 
> 时间：2012-09-12T00:57:48.460
> 
> 标签：c#, wpf

我在 WPF 中有以下层次结构：

窗口 > 网格 > ScrollViewer > StackPanel > [UserControl1, UserControl2 ...]

现在，一旦窗口处于焦点状态，我想在 StackPanel 中接收按键事件。我该如何做到这一点？只是，将代码添加到 StackPanel 中的 PreviewKeyUp/Down 处理程序似乎不起作用；看起来这些事件没有通过 StackPanel 从 Window 传输。

我应该查看 RoutedEventHandlers 吗？

编辑：我注意到的是，如果堆栈面板具有焦点，则会收到关键事件。否则，它不会。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-12T01:09:34.843

确保未处理该事件。

例如，如果您有：

```
 <Grid KeyDown="Grid_KeyDown">
    <ScrollViewer  Name="scrollViewer1" >
        <StackPanel Name="stackPanel1" >
            <TextBox Height="23" Name="textBox1" KeyDown="textBox1_KeyDown" />
        </StackPanel>
    </ScrollViewer>
</Grid> 
```

![在此处输入图像描述](../Images/87da822777f6bc748d8cd74f73c4b563.png)

请注意，文本框事件首先触发。然后另一个事件触发。

如果我放置

```
e.Handled = true; 
```

在方法 textBox1_KeyDown 内，则事件不会冒泡，这意味着该方法`Grid_KeyDown`将不会执行。

预览关键字则相反。而不是像示例中那样冒泡的事件，我只是展示了它会隧道。

尝试确保未处理该事件。也许用户控件处理它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-12T04:14:17.397

尝试这个;

```
EventManager.RegisterClassHandler(typeof(System.Windows.Controls.Control), System.Windows.Controls.Control.KeyDownEvent, yourdelegate); 
```

将其添加到应用程序启动中。

# c# - 内联 css 声明中的 .net Razor 代码块

> ID：12379913
> 
> 赞同：3
> 
> 时间：2012-09-12T00:57:59.033
> 
> 标签：c#, .net, css, asp.net-mvc, razor

@homePartnership.Batsman1Runs 是来自 api 的动态值，而 px 是静态的，如果它彼此相邻运行，则会中断，因为 @homePartnership.Batsman1Runspx 不是有效字段，如果有空格，html 不会跟随宽度，下面是我目前拥有的，它不起作用。

```
<div class="left-bar" style="width:@homePartnership.Batsman1Runs{<text>px</text>}"></div> 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-12T01:02:45.530

用括号括住动态部分（`@( ... )`构造）：

```
<div class="left-bar" style="width:@(homePartnership.Batsman1Runs)px"></div> 
```

请注意，Razor 解析空白，因此这是有效的 Razor 语法：“宽度：@homePartnership.Batsman1Runs px”。但当然，这会产生“宽度：5 px”，这不是完全有效的 CSS。但是，如上所述，您始终可以添加括号来描述代码块。

作为参考，内联 Razor 语法：

*   [一个很好的C#总结](http://www.mikesdotnetting.com/Article/153/Inline-Razor-Syntax-Overview)
*   [MSDN 上的概述](http://msdn.microsoft.com/en-us/vs2010trainingcourse_aspnetmvc3razor.aspx)

# python - 用于布尔评估赋值的 Python 成语

> ID：12379917
> 
> 赞同：0
> 
> 时间：2012-09-12T00:58:56.347
> 
> 标签：python

我有以下 C 程序作为我希望能够在 python 中执行的示例：

```
foo@foo:~/$ cat test.c 
#include <stdio.h>
#include <stdlib.h>
#include <stdbool.h>

bool get_false(){
    return false;
}

bool get_true(){
    return true;
}

void main(int argc, char* argv[]){

    bool x, y;

    if ( x = get_false() ){
        printf("Whiskey. Tango. Foxtrot.\n");
    }   

    if ( y = get_true() ){
        printf("Nothing to see here, keep moving.\n");
    }   
}
foo@foo:~/$ gcc test.c -o test
test.c: In function ‘main’:
test.c:13: warning: return type of ‘main’ is not ‘int’
foo@foo:~/$ ./test 
Nothing to see here, keep moving.
foo@foo:~/$ 
```

在 python 中，我知道如何做到这一点的唯一方法是：

```
foo@foo:~/$ cat test.py
def get_false():
    return False

def get_true():
    return True

if __name__ == '__main__':
    x = get_false()
    if x:
        print "Whiskey. Tango. Foxtrot."

    y = get_true()
    if y:
        print "Nothing to see here, keep moving."

    #if (z = get_false()):
    #    print "Uncommenting this will give me a syntax error."

    #if (a = get_false()) == False:
    #    print "This doesn't work either...also invalid syntax."
foo@foo:~/$ python test.py
Nothing to see here, keep moving. 
```

为什么？因为我想说：

```
if not (x=get_false()): x={} 
```

基本上我正在解决一个糟糕的 API，其中返回的类型要么是数据可用时的字典，要么是 False。是的，一个有效的答案是返回一致的类型并使用 Exceptions 而不是 False 作为故障模式指示器。不过，我无法更改底层 API，而且我在 Python 等具有动态类型的环境中经常遇到这种模式（阅读：对函数/方法接口没有严格的类型）。

关于如何减少 if/else 开销的任何建议？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-12T01:03:09.263

您可以使用

```
x = get_false() or {} 
```

应该`get_false()`返回一个`False`值，Python 将返回`or`.

请参阅Python 参考手册的[第 5.10 节。](http://docs.python.org/release/2.6.8/reference/expressions.html#boolean-operations)[（它至少](http://docs.python.org/release/2.0/ref/lambda.html)从 Python 2.0 就已经存在了）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-12T03:12:26.687

您正在将不方便的 API 与重复的错误补丁代码混合在一起，从而使您试图避免的问题更加复杂。

```
def wrapper():
    x = get_false()
    if not x:
        x = dict()
    return x 
```

然后，您的代码不会被难以阅读的三元（或类似三元）操作所困扰，并且如果您发现它更合适，您可以更改包装器以引发异常。

你不能做的是像在 C 中那样有一个条件赋值；Python 不这样做。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-12T02:07:58.863

您可以为此使用 Python[三元运算符](http://docs.python.org/reference/expressions.html#conditional-expressions)：

```
>>> data=False    # could be data=readyourapi()
>>> x=data if data else {}
>>> x
{} 
```

# ffmpeg - FFMPEG循环视频叠加

> ID：12379919
> 
> 赞同：6
> 
> 时间：2012-09-12T00:59:13.097
> 
> 标签：ffmpeg

我有两个视频，其中一个覆盖在另一个上。覆盖的一个只有几秒钟长，我希望它在播放主视频时保持循环。我已经尝试了我能想到的一切，但在 ffmpeg 中似乎没有任何效果

```
 ffmpeg -i mainVideo.MTS -vf " movie=overlaid.wmv  [overlay];[in][overlay] overlay=1000:500 [out]" output.mp4 
```

将一个叠加在另一个之上，但没有循环。更改`movie=overlaid.wmv`为`movie=overlaid.wmv:loop=0`

给我一条错误信息

[电影@ 01B19FC0] 未找到密钥“循环”。[movie @ 01B19F40] 解析选项字符串时出错：'loop=0' 使用 args 'overlaid.wmv:loop=0' 初始化过滤器 'movie' 时出错 打开过滤器时出错！

根据[ffmpeg docs](http://ffmpeg.org/ffmpeg.html#movie)，循环是电影的有效选项。我尝试将 0、1、10 作为循环值，但结果始终相同（错误）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-12T05:28:27.363

来自[ffmpeg 文档](http://ffmpeg.org/ffmpeg.html)：

> 循环输入流。目前它仅适用于图像流...
> 
> 重复循环输出支持循环的格式，如动画 GIF...

我建议您[连接](http://ffmpeg.org/trac/ffmpeg/wiki/How%20to%20concatenate%20%28join,%20merge%29%20media%20files)要循环多次的视频，然后覆盖该视频，您可以使用 -t 选项来控制循环的持续时间

# aviarc - RegistryItemLoader.LoaderException 添加aviarc小部件命名空间时

> ID：12379922
> 
> 赞同：3
> 
> 时间：2012-09-12T00:59:20.687
> 
> 标签：aviarc

我一直在使用它自己的新小部件开发一个新应用程序，但是当我从以前的应用程序中提取一个小部件命名空间（条件）时，编译器开始给我一个错误：

> RegistryItemLoader.doPreLoadChecks(RegistryItemLoader.java:154)：RegistryItemLoader.LoaderException：ResourceDirectory 不包含定义.xml 文件

在旧应用程序中，小部件工作正常。

在新应用程序中，widgets 目录的目录结构如下所示：

> 小部件/添加依赖项/小部件文件
> 
> 小部件/au.com.aviarc.widget.condition/1.0.0/widgets/is-enabled/widget 文件

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-13T00:31:41.227

遗留工件没有命名空间，并且采用以下样式：

```
widgets
- grid
- - definition.xml
- text-dynamic
- - definition.xml 
```

可命名空间工件出现在 Aviarc 3 中，它们的样式如下：

```
widgets
- example.namespace
- - 1.0.0
- - - widgets
- - - - grid
- - - - - definition.xml
- - - - text-dynamic
- - - - - definition.xml 
```

Aviarc 3 仍然支持遗留工件，但它是一种全有或全无的方式。如果 Aviarc 3 检测到工件目录中的任何遗留工件（如通过查看任何直接子目录中是否有任何 definition.xml 文件来完成），它会尝试以遗留模式获取整个工件目录。

在您提供的目录结构中，add-dependency 小部件是旧版小部件，因此 Aviarc 尝试将所有小部件视为旧版小部件。导致该错误是因为它尝试读取目录 au.com.aviarc.widget.condition 中的 definition.xml 文件，但没有，因为它不是旧版小部件。

该问题的解决方案是：

*   将所有遗留工件移动到命名空间中
*   将所有命名空间的工件更改为遗留工件

前一种解决方案是推荐的解决方案。如果您在命名空间中有特定工件的多个版本，则后者可能是不可能的，并且通常需要对应用程序进行更多更改。

对于前者，最好首先将遗留工件移动到应用程序 1.0.0 命名空间中，因为这是引擎隐式授予它们的命名空间，因此围绕它们的任何特定命名空间都已经指向它. 应用程序 1.0.0 命名空间还保留了遗留工件的行为，因为其中的工件将自动覆盖内置工件，除非明确指定内置版本。

因此，您正在考虑将目录结构更改为：

```
widgets
- application
- - 1.0.0
- - - widgets
- - - - add-dependency
- - - - - ...
- au.com.aviarc.widget.condition
- - [no changes] 
```

如果路径感觉有点长，则可以将一些遗留工件子目录移出各个小部件并设置在命名空间的小部件目录旁边。一些例子是 src 和 lib 目录 - 我个人不确定完整列表是什么，即使它们有限制（当然，某些工件总是可能希望在它们下面找到目录，在这种情况下它们不应移动）。

# jquery - jQuery通过一个方法传递多个变量

> ID：12379924
> 
> 赞同：1
> 
> 时间：2012-09-12T00:59:28.657
> 
> 标签：jquery, variables, selector, global

不知道我是否在这里遗漏了什么。我想通过相同的方法运行多个全局变量。见下文

```
$('#pageMain .stuff, #pageMain .postFooter').each(function(){
    $(this).vertCenter();
}); 
```

而是使用全局变量：

```
$main, $titles, $footers 
```

所以像...

```
$($main, $titles, $footers).each(). . . 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-12T01:00:33.027

您需要调用`each`每个 jQuery 对象：

```
$footers.each(function(){ ... });
$main.each(function(){ ... });
$titles.each(function(){ ... }); 
```

或者，您可以执行以下操作：

```
var aggregated = $footers.add($main).add($titles);

aggregated.each(function() { ... }); 
```

# python - 在 CentOS 上找不到 Python.h 文件

> ID：12379929
> 
> 赞同：32
> 
> 时间：2012-09-12T01:00:26.330
> 
> 标签：python, c, centos

我正在尝试在 CentOS 机器上编译用 C 编写的 Python 扩展。我正进入（状态

```
error: Python.h: No such file or directory 
```

它在 ubuntu 上运行良好，我使用 apt-get 安装了 python-dev。

我尝试使用安装 python-devel

```
yum install python-devel 
```

但它已经安装了。如何修复此错误？

* * *

## 回答 #1

> 赞同：39
> 
> 时间：2015-10-11T07:02:15.373

如果你使用 python3 你可以为此安装 python34-devel

它在[EPEL Repository](https://fedoraproject.org/wiki/EPEL)上可用，并且有[python34-devel 包](https://dl.fedoraproject.org/pub/epel/7/x86_64/repoview/python34-devel.html)可用

您只需运行此命令即可安装它

```
yum install python34-devel 
```

希望有帮助

***注意**此时`python34-devel`是python 3.4的最新版本

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2012-09-12T06:06:04.897

在我的系统上，`Python.h`头文件位于路径中`/usr/include/python2.6/`。由于预处理器默认不搜索此路径，因此您必须将其添加到要搜索的路径列表中。这是通过`-I`编译器的选项完成的，如下所示：

```
$ gcc -I/usr/include/python2.6 source.c -o program 
```

将上面的路径更改为系统上的实际路径。您可以使用[`find`](http://linux.die.net/man/1/find)评论中建议的[`locate`](http://linux.die.net/man/1/locate)命令或已安装的命令找到它。

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2019-05-09T07:07:47.383

*   为了`CentOS 7.4`
    *   `Python 3.6.6`：`yum -y install python36-devel`
    *   `Python 2`：`yum -y install python-devel`
*   为了`Ubuntu`
    *   `Python 3.6`：`apt-get install libpython3.6-dev`

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-11-25T06:34:04.983

在 Centos6.X 上安装`python3.4`（包括 pip）和软件包：`python3.4-dev`

```
yum install http://dl.iuscommunity.org/pub/ius/stable/CentOS/6/x86_64/python34u-3.4.2-1.ius.centos6.x86_64.rpm
yum install http://dl.iuscommunity.org/pub/ius/stable/CentOS/6/x86_64/python34u-devel-3.4.2-1.ius.centos6.x86_64.rpm 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2017-06-04T11:37:48.540

我有一个类似的问题，默认 Python 是 2.7，但 pip 是针对 3.4 运行的，我想使用 2.7。所以我做了：`yum remove python34-pip`和`yum install python2-pip`。解决了！

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2021-02-18T10:47:12.103

对于 centos 8+

```
dnf install -y python3-devel 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2018-06-12T11:45:37.840

我也有类似的问题。

> ./python/py_defines.h:39:20：致命错误：Python.h：没有这样的文件或目录

而 find 命令显示`python.h`存在。

上述解决方案不起作用，但以下命令执行对我有用。

```
yum install python27-python-devel.x86_64 
```

没什么不同，但浪费了很多时间。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2018-09-21T08:18:46.157

这取决于您拥有的 Python！

你需要一个`dev`包，你拥有的 Python XXX 的版本 XXX，你可以在[https://centos.pkgs.org/7/ius-x86_64](https://centos.pkgs.org/7/ius-x86_64)上搜索。

例如，如果你有来自 IUS 的 Python 3.6.5，你需要安装[https://centos.pkgs.org/7/ius-x86_64/python36u-devel-3.6.5-1.ius.centos7.x86_64.rpm .html](https://centos.pkgs.org/7/ius-x86_64/python36u-devel-3.6.5-1.ius.centos7.x86_64.rpm.html)。

# html - 播放按钮的 YouTube 元素 ID

> ID：12379930
> 
> 赞同：0
> 
> 时间：2012-09-12T01:00:29.143
> 
> 标签：html, vb.net

我一直在搜索随机 YouTube 视频的源代码，试图找到播放按钮的元素 ID。我正在 VB.NET 中制作一个程序，WebBrowser 将在其中导航到 YouTube 视频，但我很快发现如果您使用的是 VB.NET，视频不会自动启动。我正在尝试查找元素 ID，以便可以调用单击事件来启动它。对于这方面的任何提示或提示，我将非常高兴。

非常感谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-12T03:26:35.817

Youtube 使用 Flash 作为他们的视频播放器，所以简而言之，“播放按钮”不存在。查看 youtube api[了解更多信息](https://developers.google.com/youtube/)

如果您梳理 youtube api，您很有可能会找到自动播放功能。

祝你好运，

-布赖恩

# android - 为什么 ViewPager 中的第一个视图显示为空？

> ID：12379942
> 
> 赞同：9
> 
> 时间：2012-09-12T01:01:53.120
> 
> 标签：android

我有一个使用以下适配器的 viewpager，在它加载后，第一个视图显示为空，但事实并非如此。如果我滚动到下一个视图然后向后滚动，我可以看到内容。

```
import android.content.Context;
import android.os.Parcelable;
import android.support.v4.view.PagerAdapter;
import android.support.v4.view.ViewPager;
import android.view.View;
import android.widget.TextView;
import java.util.ArrayList;

public class MyPagerAdapter extends PagerAdapter {

    Context context;

    public ArrayList<TextView> mViews;

    int layoutResourceId;

    public MyPagerAdapter(Context context) {
        mViews = new ArrayList<TextView>();

    }

    @Override
    public void destroyItem(View view, int arg1, Object object) {
        ((ViewPager)view).removeView((View)object);
    }

    @Override
    public void finishUpdate(View arg0) {

    }

    @Override
    public int getCount() {
        return mViews.size();
    }

    @Override
    public Object instantiateItem(View view, int position) {
        View myView = mViews.get(position);
        ((ViewPager)view).addView(myView);
        return myView;
    }

    @Override
    public boolean isViewFromObject(View view, Object object) {
        return view == object;
    }

    @Override
    public void restoreState(Parcelable arg0, ClassLoader arg1) {

    }

    @Override
    public Parcelable saveState() {
        return null;
    }

    @Override
    public void startUpdate(View arg0) {

    }

    @Override
    public int getItemPosition(Object object) {
        return POSITION_NONE;
    }

} 
```

这是从我的活动中实现它的代码......

```
public void resetPages() {
    if (mPageText == null)
        return;
    mPagerAdapter.mViews.clear();
    for (int i = 0; i < mPageText.size(); i++) {
        TextView tv = new TextView(this);
        tv.setTextSize(mSelectedFontSize);
        tv.setText(mPageText.get(i));
        tv.setId(i);
        tv.setTag(i);
        tv.invalidate();
        mPagerAdapter.mViews.add(tv);
    }

mPagerAdapter.notifyDataSetChanged();
mViewPager.refreshDrawableState();
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-13T01:22:45.720

尝试添加 followind onCreate 方法并且我的代码有效（“TEXT 0”出现在启动时）。也许只是因为在不适当的时间调用了 resetPages() ？

```
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.activity_main);
    mPageText = new LinkedList<CharSequence>();
    for (int i=0; i<10; i++) {
        mPageText.add("TEXT "+i);
    }
    this.mPagerAdapter = new MyPagerAdapter(this);
    this.mViewPager = (ViewPager)this.findViewById(R.id.viewpager);
    this.mViewPager.setAdapter(mPagerAdapter);
    resetPages();
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-08-27T06:06:19.813

我不确定这一点，但如果您在 instantiateItem 中将 ViewGroup 用于您的视图，那么它可能会起作用，我使用了 viewgroup 并且它工作正常。

```
@Override
public Object instantiateItem(View view, int position) {
    View myView = mViews.get(position);
    ((ViewPager)view).addView(myView);
    return myView;
} 
```

希望我的回答有帮助..

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-06-08T05:45:52.190

问题一定是因为视图需要时间来加载内容，并且在加载内容后视图没有更新。尝试添加

```
 handler.postDelayed(r=new Runnable()
        {
            @Override
            public void run() {
                if (mPosition == position)
                {

                    notifyDataSetChanged();
                   handler.removeCallbacks(r);

                }
            }
        }, 1000); 
```

在`instantiateItem`适配器内部，以便在创建视图时 1 秒后更新视图。`mPosition`是正在打开的第一个视图的位置。如果您通过单击列表中的项目打开 viewpager，那么您需要在调用适配器时传递正在选择的项目的位置。`mPostion`如果您可以设置为 0第一项总是最初在 viewpager 中打开

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2019-08-02T11:18:40.923

好吧，几分钟前我刚刚遇到了一个类似这样的问题。

我的问题只是图像。我重新安排了幻灯片的顺序，发现那个特定的图像仍然是空白的。所以只需替换图像，为我工作:)

# php - 使用 foreach 合并和上传多个输入

> ID：12379943
> 
> 赞同：2
> 
> 时间：2012-09-12T01:02:01.717
> 
> 标签：php

我有这个代码提交多个文件和标题我试图将结果合并到我的数据库并检查标题 [] 是否为空并打印自定义值但我的标题 [] 有问题我需要与 s_upload 结合[] 大批：

```
<?php
if ( $_SERVER['REQUEST_METHOD'] == 'POST' ){

foreach ($_FILES["s_upload"]["error"] as $key => $error) {
    if ($error == UPLOAD_ERR_OK) {
        $tmp_name = $_FILES["s_upload"]["tmp_name"][$key];
        $name = $_FILES["s_upload"]["name"][$key];
       // move_uploaded_file($tmp_name, "data/$name");

       if ($_POST['title']==''){
       echo 'Title';
       }else{
       print_r ($_POST['title']);
       echo $name;
       }
    }
}   
}
?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title></title>

</head>
    <body>

<form method="post" enctype="multipart/form-data">
<div class='file_upload' id='f1'>
<input type="text" name="title[]" id="t1">
<input size="14" name='s_upload[]' id="i1" type='file'/>
</div>
<div class='file_upload' id='f2'>
<input type="text" name="title[]" id="t2">
<input size="14" name='s_upload[]' id="i2" type='file'/>
</div>
<input type="submit"/>
</form>

    </body>
</html> 
```

当我提交这是结果：

```
Array ( [0] => 11111 [1] => 22222 ) 1.jpgArray ( [0] => 11111 [1] => 22222 ) 2.jpg 
```

如果标题存在，我需要这个结果：

```
1111 1.jpg 
2222 2.jpg 
```

如果标题为空，则结果如下：

```
Title 1.jpg 
2222 2.jpg 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-12T01:10:52.937

```
<?php
if ( $_SERVER['REQUEST_METHOD'] == 'POST' ){
$i = 0;
foreach ($_FILES["s_upload"]["error"] as $key => $error) {
    if ($error == UPLOAD_ERR_OK) {
        $tmp_name = $_FILES["s_upload"]["tmp_name"][$key];
        $name = $_FILES["s_upload"]["name"][$key];
       // move_uploaded_file($tmp_name, "data/$name");

       if ($_POST['title'][$i]==''){
       echo 'Title '.$name;
       }else{
       echo $_POST['title'][$i] . ' ' . $name."\n";
       }
    }
    $i++;
}   
}
?> 
```

这段代码很糟糕，但我只是让它工作，请至少让它更具可读性。

* * *

**PsyK 编辑：** 我更新了代码以消除对 $i 的需求，因为该数字已存储在 $key 中。您所缺少的只是将标题作为数组引用，就像您为上传的文件一样。

```
<?php
if ( $_SERVER['REQUEST_METHOD'] == 'POST' ){
foreach ($_FILES["s_upload"]["error"] as $key => $error) {
    if ($error == UPLOAD_ERR_OK) {
        $tmp_name = $_FILES["s_upload"]["tmp_name"][$key];
        $name = $_FILES["s_upload"]["name"][$key];
       // move_uploaded_file($tmp_name, "data/$name");

       if ($_POST['title'][$key]==''){
       echo 'Title '.$name;
       }else{
       echo $_POST['title'][$key] . ' ' . $name."\n";
       }
    }
}   
}
?> 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-12T01:33:49.233

由于您没有指定`1111`来源的来源，我会给您一些选择：

```
<?
if ( $_SERVER['REQUEST_METHOD'] == 'POST' ){
    foreach ($_FILES["s_upload"]["name"] as $key => $name) {
        if ($_FILES["s_upload"]["error"][$key] == UPLOAD_ERR_OK) {
            $tmp_name = $_FILES["s_upload"]["tmp_name"][$key];

            if ($_POST['title'][$key]==''){
                // No title was specified: construct default title
                // This defaults the title to the filename of the file that was uploaded
                $title = $name;
                // This defaults the title to some random 32-character hex string
                $title = md5(time()+rand()); 
            }
            else{
                // A title was specified in the input box: use it
                $title = $_POST['title'][$key];
            }
            echo "$title $name<br />";
        }
    }
}
?> 
```

这是我更改的内容：

1.  我现在正在循环名称而不是错误。这样做更有意义。循环错误是造成混乱的根源。
2.  由于您在输入名称中使用数组 (the `[]`) 命名输入，因此您必须在代码中指定要引用的数组。这意味着您需要`$key`始终如一地使用。
3.  你说你想要一个没有指定的默认标题，但没有解释你想要它如何构建。我在那里抛出了两个随机的想法。第一个默认为上传文件的文件名。第二个只是一个随机字符串。您可以根据当前时间、上传者的 IP 等将其更改为其他内容。无论如何，您都可以在那里进行。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-12T01:16:53.103

看看你的代码试试这个......

它可能有效，也可能无效，我自己没有测试过。

```
 if (is_array($_FILES) && !empty($_FILES)) {
     foreach ($_FILES['s_upload'] as $key => $file) {
        if ($file['error']!=UPLOAD_ERR_OK)
           continue;

        $tmp_name = $file['tmp_name'];
        $name = $file['name'];

        if (isset($_POST['title'][$key])) { # Standard method.
           $title = $_POST['title'][$key];
        } else {
           $title = "Default title";
        } 

        // Do what you need to do with the stuff.

     }
  } 
```

# c# - 如何在 xUnit.net 测试中只运行一次设置代码

> ID：12379949
> 
> 赞同：27
> 
> 时间：2012-09-12T01:03:00.900
> 
> 标签：c#, asp.net, xunit, xunit.net

我正在尝试使用 Xunit 设置我的测试。我需要删除测试开始的文件夹中的所有图像，然后每个方法都会调整图像大小并将其输出的副本保存到文件夹中。文件夹应该只清空一次，然后每个方法都会将自己的图像保存到文件夹中。

当我使用时，在每次测试之前仍然会调用`IUseFixture<T>`该函数，所以我最终在文件夹中只有一张图像。`ClearVisualTestResultFolder`

```
public class Fixture
{
    public void Setup()
    {
        ImageHelperTest.ClearVisualTestResultFolder();
    }
}

public class ImageHelperTest : IUseFixture<EngDev.Test.Fixture>
{
    public void SetFixture(EngDev.Test.Fixture data)
    {
        data.Setup();
    }

    public static void ClearVisualTestResultFolder()
    {
        // Logic to clear folder
    }
} 
```

如果我把它放在`ClearVisualTestResultFolder`构造函数中，它也会为每个测试方法调用一次。我只需要在所有测试方法执行之前运行一次，我该如何实现？

如果重要的话，我会使用 ReSharper 测试运行器。

* * *

## 回答 #1

> 赞同：30
> 
> 时间：2012-09-12T02:13:31.070

按照此[xUnit 讨论主题](http://xunit.codeplex.com/discussions/354663)中的指导，您似乎需要在 Fixture 上实现构造函数并实现 IDisposable。这是一个完整的示例，可以按照您想要的方式运行：

```
using System;
using System.Diagnostics;
using Xunit;
using Xunit.Sdk;

namespace xUnitSample
{
    public class SomeFixture : IDisposable
    {
        public SomeFixture()
        {
            Console.WriteLine("SomeFixture ctor: This should only be run once");
        }

        public void SomeMethod()
        {
            Console.WriteLine("SomeFixture::SomeMethod()");
        }

        public void Dispose()
        {
            Console.WriteLine("SomeFixture: Disposing SomeFixture");
        }
    }

    public class TestSample : IUseFixture<SomeFixture>, IDisposable
    {
        public void SetFixture(SomeFixture data)
        {
            Console.WriteLine("TestSample::SetFixture(): Calling SomeMethod");
            data.SomeMethod();
        }

        public TestSample()
        {
            Console.WriteLine("This should be run once before every test " + DateTime.Now.Ticks);
        }

        [Fact]
        public void Test1()
        {
            Console.WriteLine("This is test one.");
        }

        [Fact]
        public void Test2()
        {
            Console.WriteLine("This is test two.");
        }

        public void Dispose()
        {
            Console.WriteLine("Disposing");
        }
    }
} 
```

从控制台运行程序运行此程序时，您将看到以下输出：

> D:\xUnit>xunit.console.clr4.exe test.dll /html foo.htm xUnit.net 控制台测试运行程序（64 位 .NET 4.0.30319.17929）版权所有 (C) 2007-11 Microsoft Corporation。
> 
> xunit.dll：版本 1.9.1.1600 测试程序集：test.dll
> 
> SomeFixture ctor：这只应该运行一次
> 
> 测试完成：2 个，共 2 个
> 
> SomeFixture：处理 SomeFixture
> 
> 共 2 个，0 个失败，0 个跳过，耗时 0.686 秒

然后，当你破解打开测试输出文件 foo.htm 时，你会看到另一个测试输出。

* * *

## 回答 #2

> 赞同：21
> 
> 时间：2015-08-24T06:02:19.920

> **xUnit.net v1.x**中的旧**`IUseFixture<T>`**接口已被两个新接口取代：和. 此外，将夹具值注入测试的机制已从属性设置器更改为构造器参数。类夹具创建一次并在同一类中的所有测试之间共享（很像旧的 IUseFixture）。集合夹具的工作方式相同，除了单个实例在同一测试集合中的所有测试之间共享。****`IClassFixture<T>`****`ICollectionFixture<T>`****

 *** * *

## 回答 #3

> 赞同：6
> 
> 时间：2012-09-12T08:07:10.377

**注意这仅适用于 xUnit.net v1 - 请参阅接受的答案，除非这是您的情况**

* * *

`IUseFixture<T>.SetFixture`每次测试都会调用一次。夹具本身只创建一次。

换句话说，您不应该在 SetFixture 方法中做任何事情，而是应该在 Fixture 构造函数中触发它。

对于一次性清理，`IDisposable.Dispose`在 Fixture 上实现一个（虽然它不是必需的）

请注意，在测试之间（甚至可能）共享状态是一个坏主意。最好用一个`TemporaryDirectoryFixture` [这样](https://stackoverflow.com/a/11900755/11635)的。**

# regex - 如何在 Cucumber 的自定义路径中使用正则表达式

> ID：12379953
> 
> 赞同：0
> 
> 时间：2012-09-12T01:04:04.833
> 
> 标签：regex, mapping, cucumber

我在paths.rb中有一条路径：

```
when /the page for CA/
   '/CA-area-code' 
```

但是，我想对路径的一部分进行正则表达式，以便它在特征步骤中从正则表达式中提取值。像这样：

```
when /the Phone SEO page for (.*)/
   '/#{foo}-area-code' 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-12T07:19:50.823

```
when /the Phone SEO page for (.*)/
   '/#{$1}-area-code' 
```

应该这样做。

# multithreading - Mapreduce 在 2.7 转换后不再工作

> ID：12379954
> 
> 赞同：1
> 
> 时间：2012-09-12T01:04:16.410
> 
> 标签：multithreading, google-app-engine, mapreduce, python-2.7

在将我们的应用程序转换为 Python 2.7、配置多线程并像这样在 app.yaml 中引用 mapreduce 之后......

```
- url: /mapreduce(/.*)?
  script: mapreduce.main.app
  #script: google.appengine.ext.mapreduce.main.app
  login: admin 
```

并像这样调用mapreduce ...

```
 control.start_map(
      "FNFR",
      "fnfr.fnfrHandler",
      "mapreduce.input_readers.BlobstoreLineInputReader",
      {"blob_keys": blobKey},
      shard_count=32,
      mapreduce_parameters={'done_callback': '/fnfrdone','blobKey': blobKey, 'userID':thisUserID}) 
```

我们得到以下堆栈跟踪...

```
Traceback (most recent call last):
  File "/base/python27_runtime/python27_lib/versions/1/google/appengine/runtime/wsgi.py", line 189, in Handle
    handler = _config_handle.add_wsgi_middleware(self._LoadHandler())
  File "/base/python27_runtime/python27_lib/versions/1/google/appengine/runtime/wsgi.py", line 241, in _LoadHandler
    raise ImportError('%s has no attribute %s' % (handler, name))
ImportError: <module 'mapreduce.main' from '/base/data/home/apps/s~xxxxxxonline/2.361692533819432574/mapreduce/main.pyc'> has no attribute app 
```

我找到了一个 SO 参考（[如何将我的 app.yaml 迁移到 2.7？](https://stackoverflow.com/questions/7945889/how-to-migrate-my-app-yaml-to-2-7)），但正如您从我的 yaml 中看到的那样，我想我已经尝试了所有组合来尝试解决它。谢谢。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-12T01:27:30.977

这对我有用，但我仍然使用相当旧版本的 SDK，我不知道他们是否解决了这个问题：

```
- url: /mapreduce(/.*)?
  script: mapreduce.main.APP
  login: admin 
```

# objective-c - NSEvent addGlobalMonitorForEventsMatchingMask：热键拦截

> ID：12379961
> 
> 赞同：2
> 
> 时间：2012-09-12T01:05:21.447
> 
> 标签：objective-c, xcode, macos, hotkeys, nsevent

`Control`我想拦截以+开头`Shift`并以字符结尾的热键（强制）。
我有以下代码：

```
[NSEvent addGlobalMonitorForEventsMatchingMask:NSFlagsChangedMask handler: ^(NSEvent *event) {
    NSUInteger flags = [event modifierFlags] & NSDeviceIndependentModifierFlagsMask;
    if(flags == NSControlKeyMask + NSShiftKeyMask){
        NSLog(@"pressed!");
    }
}]; 
```

我需要在我的代码中添加什么来检查用户是否按下了`Control``Shift`+字符，以及用户按下了什么字符？ 只有当我上面所说的是真的时，才会执行
代码。 这是我正在寻找的伪代码：`NSLog(@"pressed!");`

```
[NSEvent addGlobalMonitorForEventsMatchingMask:NSFlagsChangedMask handler: ^(NSEvent *event) {
    NSUInteger flags = [event modifierFlags] & NSDeviceIndependentModifierFlagsMask;
    if((flags == NSControlKeyMask + NSShiftKeyMask) && [event containsCharacter]){
       NSLog(@"%@", [event character];
    }
}]; 
```

所以如果用户按下`Control`+ `Shift`+1 我会做一件事，如果`Control`+ `Shift`+2 做另一件事，依此类推......

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-14T14:17:42.067

您需要按位比较：

```
- (void)keyDown:(NSEvent *)theEvent { 
    if ([theEvent modifierFlags] & (NSControlKeyMask | NSShiftKeyMask)) { 
        if (theEvent.keyCode == 1/* add the right key code */) {
            NSLog(@"Do something");
        }
    } else { 
        [super keyDown:theEvent]; 
    } 
} 
```

* * *

## 回答 #2

> 赞同：-3
> 
> 时间：2012-09-12T13:40:06.327

尝试这个：

```
 [NSEvent addGlobalMonitorForEventsMatchingMask:NSKeyDownMask handler:^(NSEvent *event) {
    NSUInteger key = 8; // 8 is "C"
    NSUInteger modifier = NSControlKeyMask + NSShiftKeyMask; 
    if ([event keyCode] == key && [NSEvent modifierFlags] == modifier)

NSLog(@"pressed!");

}]; 
```

# image - 复杂的 HTML5 图像映射？

> ID：12379964
> 
> 赞同：-1
> 
> 时间：2012-09-12T01:05:36.390
> 
> 标签：image, html, menu, hover, clickable

我有一张客厅的图片，我正在将其变成我正在开发的新网站的菜单。这个想法是，您可以单击房间中的某些物品，例如椅子、桌子、沙发等，然后转到所需的页面。我想知道是否有一种聪明的方法可以做到这一点。由于项目不是简单的形状，我不想使用标准的图像映射。

谢谢你的帮助！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-11-04T18:06:26.437

我回答是因为谷歌搜索把我带到了这里......

因为你要求一个工具：

GIMP 有一个非常好的图像地图创建功能。

在 GIMP 中打开您的图像，然后选择 Filters > Web > ImageMap

从那里您可以通过在图像上绘图来创建图像映射。保存将生成 HTML，然后您可以根据需要进行定制。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-06T13:47:29.683

正如 Korvin 所提到的，在 SVG 中执行此操作可能是最简单的选择，因为您可以将事件附加到 SVG 中的对象，而不必手动指定侦听事件的特定区域。

如果你走这条路，我建议使用 RaphaelJS 库，它具有良好的语法和在 IE 预版本 9 中工作的优势。这是一个演示，虽然它使用 onmouseover 而不是 onclick，但它可能接近你的试图达到：

[http://raphaeljs.com/australia.html](http://raphaeljs.com/australia.html)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-12T01:28:46.657

这个工具看起来是一个可靠的图像映射器：[http](http://www.image-maps.com/) ://www.image-maps.com/ 我建议用画布和 SVG 来做这个，它会让这更容易，更专业。

# grails - 使用 Grails Fixture 插件动态加载子项

> ID：12379966
> 
> 赞同：1
> 
> 时间：2012-09-12T01:05:59.120
> 
> 标签：grails, groovy

我正在尝试使用 Fixture 插件在 Grails 应用程序中加载数据。

```
class Author {
  String name 
}

class Book {
  String title
  hasMany = [authors:Author]
} 
```

我将作者加载到一个单独的文件中，并将其包含在第一本书中。

```
//author fixture
fixture {
  author1(Author) {
    name = 'Ken Follett'
  }
  author2(Author) {
    name = 'Martin Fowler'
  }
}

//book fixture
fixture {
  include 'author'
  "book"(Book) {
    title = 'Your favorite book'
    authors = [author1, author2]
  }
} 
```

这一切都很好。我不能做的是替换 [author1, author2] 以便我可以动态（和随机）分配作者。就像是：

```
def dynamicallyBuiltAuthorList = "author1, author2, author100"
authors = ["${dynamicallyBuiltAuthorList}"] 
```

到目前为止，我尝试的几乎所有东西都给了我一个没有匹配的编辑器或找到转换策略的错误。

在此先感谢 Grails 大师！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-12T10:14:17.757

根据您在下面的答案（以及对此答案的先前编辑），这可能是一种更好的方法：

```
def dynamicallyBuiltAuthorList = [ 'author1', 'author2', 'author100' ].collect {
  ref( "$it" )
}
authors = dynamicallyBuiltAuthorList 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-12T22:09:51.707

最后答案很简单：

```
def authorList = []
def dynamicallyBuiltAuthorList = [ 'author1', 'author2', 'author100' ].collect {
   authorList.add(ref("$it"))
}
authors = authorList 
```

感谢蒂姆的帮助！

# php - 如何通过安装脚本向 Magento 添加类别？

> ID：12379972
> 
> 赞同：5
> 
> 时间：2012-09-12T01:07:28.853
> 
> 标签：php, magento

我实际上可以通过设置脚本添加一个类别，但由于某种原因，某些字段没有正确设置。这是我的代码

```
$this->startSetup();
Mage::register('isSecureArea', 1);

$category = Mage::getModel('catalog/category');
$category->setPath('1/2') // set parent to be root category
    ->setName('Category Name')
    ->setUrlKey('category-name')
    ->setIsActive(0)
    ->setIncludeInMenu(1)
    ->setInfinitescroll(1)
    ->setDisplayMode('PAGE')
    ->setLandingPage($idToCmsBlock)
    ->setPageLayout('anotherLayoutThanDefault')
    ->setCustomUseParentSettings(0)
    ->setCustomLayoutUpdate('<reference name="head"><action method="addCss"><stylesheet>css/somecss.css</stylesheet></action></reference>')
->save();
$this->endSetup(); 
```

运行此脚本后，我创建了一个类别，其中包含我在 EAVs 表中设置的所有值。但是，即使我重新索引平面表，平面表也会缺少 displayMode、landingPage、pageLayout、customLayoutUpdate。

奇怪的是，如果我进入管理员，我可以看到所有这些字段都正确设置，但如果我进入前端，大多数这些字段都会被忽略。我将不得不去管理员，取消设置这些值并重置它们以使它们中的每一个正常工作。

还假设我使用 setEnabled(1)，我的类别将在管理员中“启用”，但不会显示在前端。

PS：我激活了平面类别，如果我禁用它似乎可以正常工作，但如果我重新索引它仍然无法正常工作。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-09-13T22:18:04.663

我终于找到了，我不知道为什么，但是这些字段没有正确显示，因为它们是为默认存储 (storeId=1) 插入的，因为我的脚本在更新脚本中运行。您需要使用 storeId 0。

有了这些信息，您会认为解决方案类似于：

```
$this->startSetup();
Mage::register('isSecureArea', 1);

Mage::app()->setCurrentStore(Mage_Core_Model_App::ADMIN_STORE_ID);

$category = Mage::getModel('catalog/category');
$category->setPath('1/2') // set parent to be root category
    ->setStoreId(Mage_Core_Model_App::ADMIN_STORE_ID)
    ->setName('Category Name')
    ...
    ->save();
$this->endSetup(); 
```

但是这段代码也不起作用。事实上，在查看 Mage::app() (Mage_Core_Model_App Line 804) 之后，我注意到一个 IF 条件，如果您在设置脚本中，它将始终返回默认存储。

诀窍是假装你不在安装脚本中，我的工作解决方案是：

```
$this->startSetup();
Mage::register('isSecureArea', 1);

// Force the store to be admin
Mage::app()->setUpdateMode(false);
Mage::app()->setCurrentStore(Mage_Core_Model_App::ADMIN_STORE_ID);

$category = Mage::getModel('catalog/category');
$category->setPath('1/2') // set parent to be root category
    ->setStoreId(Mage_Core_Model_App::ADMIN_STORE_ID)
    ->setName('Category Name')
    ...
    ->save();
$this->endSetup(); 
```

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2013-08-07T13:44:20.177

I ran into the same issue when updating a category via a data install script. The solution provided in the [accepted answer](https://stackoverflow.com/questions/12379972/how-to-add-a-category-to-magento-via-setup-script/12415588#12415588) did work for updating the category, but can be improved upon as follows:

*   In the solution, the user that triggers the update script is forced to the admin environment. This can be remedied by saving the current store id and switching back at end of the script.
*   It doesn't seem that adding isSecureArea to the registry or disabling update mode had any use (at least for the use case of updating a category).

I ended up with the following data install script for updating a category (in this example, a category is loaded by name, after which the name is updated):

```
<?php
    $this->startSetup();

    //Switch to admin store (workaround to successfully save a category)
    $originalStoreId = Mage::app()->getStore()->getId();
    Mage::app()->setCurrentStore(Mage_Core_Model_App::ADMIN_STORE_ID);

    //update category
    $category = Mage::getModel('catalog/category')
        ->loadByAttribute('name', 'OLD_CATEGORY_NAME');
    if ($category) {
        $category
            ->setStoreId(Mage_Core_Model_App::ADMIN_STORE_ID)
            ->setName('NEW_CATEGORY_NAME')
            ->save();
    }

    //Set store to original value
    Mage::app()->setCurrentStore($originalStoreId);

    $this->endSetup();
?> 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-13T07:34:56.580

尝试这个

```
<?php
require_once "../app/Mage.php";
umask(0);
Mage::app('default');
$proxy  = new SoapClient("http://127.0.0.1/magento/index.php/api/soap/?wsdl");
$sessionId  = $proxy->login($magento_webservices_username,  $magento_webservices_passwd);

$data = array('name'=>'Nokia',
            'description'=>'',
            'meta_description'=>'',
            'meta_keywords'=>'',
            'default_sort_by'=>'price',
            'available_sort_by'=>'price',
            'is_active'=>1
);
$newCategoryId = $proxy->call($sessionId, 'category.create', array(3, $data, 1));
echo "Category ID: ".$newCategoryId;

?> 
```

也看看[Magento 创建类别](http://www.magentocommerce.com/api/soap/catalog/catalogCategory/catalog_category.create.html)

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2012-09-12T01:18:33.297

看看这个。希望它会帮助你。
[http://inchoo.net/ecommerce/magento/how-to-add-new-custom-category-attribute-in-magento/](http://inchoo.net/ecommerce/magento/how-to-add-new-custom-category-attribute-in-magento/)

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2016-05-30T05:52:52.527

我通过安装程序脚本创建了多个类别。

```
<?php
$installer = $this;
$installer->startSetup();

Mage::register('isSecureArea', 1);

$category = Mage::getModel('catalog/category');
$category->setPath('1/2/4') // set parent to be root category
->setName('CAT NAME') //Category Name
->setIsActive(1) // Category Status
->setIncludeInMenu(1) // Show in Menu
->setIsAnchor(1) // used for Layered navigation
->setDisplayMode('PAGE') //  Product Only
->setPageLayout('one_column') // Page layout
->save();

$installer->endSetup(); 
```

# java - 使用 RequestDispatcher.forward() 双重转发 ServletRequest 导致 URL 格式错误并导致 404

> ID：12379973
> 
> 赞同：1
> 
> 时间：2012-09-12T01:07:43.303
> 
> 标签：java, eclipse, tomcat, forward, requestdispatcher

我的 Java Web 应用程序使用两个 servlet 来控制表单处理和导航，`/AppControl`并且`/ViewControl`.

AppControl 处理表单提交，然后将请求转发到 ViewControl，ViewControl 确定处理了哪个页面并将请求重新转发到“下一个”页面。

第一个转发（在 servlet 之间）工作正常；但第二个（从 ViewControl 到 JSP 页面）的 URL 格式错误，我得到 404。

servlet 都映射到上下文的根目录，JSP 文件位于名为 /view/ 的子文件夹中

Forward #1 从`/AppControl`to `/ViewControl`， forward #2 从 /ViewControl to `/view/xxx.jsp`，但是出现在浏览器中的是`localhost:8080/view//view/xxx.jsp`，这显然不是它应该去的地方。请注意，发送到浏览器的 URL 中缺少上下文，并且正在嵌入字符串“/view/”的额外实例。

我试过了：

*   `ServerContext`在 using和`ServerRequest`for之间切换`RequestDispatcher`
*   使用绝对路径和相对路径（“./”——这是一个有效的相对路径吗？）
*   将 contextPath 附加（预先挂起）到 URL

以及其他各种黑客和回转，但似乎没有任何东西可以使它起作用；它不断将发送到浏览器的 URL 更改为除调试中出现的 URL（与 RD 相关联）之外的其他内容。

顺便说一句，请求来自 (referrer?) `localhost:8080/(context)/view/zzz.jsp`，发布到`/AppControl`;

我正在使用[getServletContext().getRequestDispatcher(java.lang.String)](http://docs.oracle.com/javaee/6/api/javax/servlet/ServletContext.html#getRequestDispatcher%28java.lang.String%29)进行转发，所以我的印象是目标资源是相对于上下文的根。

这是我尝试过的，以及我得到的结果：

```
URL String Param     | Resulting URL
---------------------|---------------
 /view/xxx.jsp       | localhost:8080/view//view/xxx.jsp
 ./xxx.jsp           | localhost:8080/myApp/xxx.jsp
 ./view/xxx.jsp      | localhost:8080/view/view/xxx.jsp
 /myApp/view/xxx.jsp | localhost:8080/myApp/myApp/view/xxx.jsp 
```

我将用实际代码跟进这篇文章，也许还有截图（如果我能做到的话）......我的环境：

*   Java 6.0_34
*   Eclipse 朱诺 (4.2.0)
*   雄猫 7.0.21。

代码：

```
 //get page navigation info
            setNavigation();
            session.setAttribute("viewControl", this.pageNext);

            //navigate to this.pageNext
            //response.sendRedirect(this.pageNext);
            pageForward(request, response, this.pageNext);
        }
    }else {
        pageForward(request, response, this.appStartPage);
    }
}

private void pageForward(HttpServletRequest request, HttpServletResponse response, String url) 
throws ServletException, IOException {
    RequestDispatcher rd = getServletContext().getRequestDispatcher(url);
    //RequestDispatcher rd = request.getRequestDispatcher(url);

    rd.forward(request, response);
}

private void setNavigation() {
    //this.urlViewBase = this.urlAppBase + "/view/";
    this.urlViewBase = "/view/";
    //this.urlViewBase = "./";
    //this.urlViewBase = "./view/";

    if (this.pageCurrent.equals("StartView.jsp")) {
        this.pageNext = this.urlViewBase + "ApplicantInfo.jsp";
        this.pagePrevious = this.urlViewBase + "StartView.jsp";
    }
    else if (this.pageCurrent.equals("ApplicantInfo.jsp")) {
        this.pageNext = this.urlViewBase + "ApplicantAddress.jsp";
        this.pagePrevious = this.urlViewBase + "StartView.jsp";
    }
    else if (this.pageCurrent.equals("ApplicantAddress.jsp")) {
        this.pageNext = this.urlViewBase + "Menu.jsp";
        this.pagePrevious = this.urlViewBase + "ApplicantInfo.jsp";
    }
    else if (this.pageCurrent.equals("Menu.jsp")) {
        this.pageNext = this.urlViewBase + "Menu.jsp";
        this.pagePrevious = this.urlViewBase + "ApplicantAddress.jsp";
    }
    else {
        this.pageNext = this.urlViewBase + "StartView.jsp";
        this.pagePrevious = this.urlViewBase + "StartView.jsp";
    }
} 
```

# ember.js - ember 示例的contacts.json 文件在哪里

> ID：12379975
> 
> 赞同：0
> 
> 时间：2012-09-12T01:08:26.393
> 
> 标签：ember.js

我已经下载了 ember.js 的示例，并按照说明通过 node 和 localhost:3000 启动了联系人示例但是，没有我可以找到的 contacts.json 文件，因此没有加载任何内容。单击“新联系人”不会执行任何操作。我不太确定如何解决这个问题，但我想知道它是否与根据描述应该存在的没有 contacts.json 文件有关。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-04T20:53:17.047

不幸的是，Ember 示例目前似乎有点过时（联系人演示仍然引用我上次检查的 SC 命名空间）并且有些可能已损坏。我怀疑一旦 Ember 1.0 发布，这将得到清理。您可以[在 github 上查看 emberjs/examples 的问题](https://github.com/emberjs/examples/issues?state=open)。

我不认为你的问题是因为缺少 contacts.json 文件，因为它在实时[联系人演示](http://emberjs.com/examples/contacts/)中也被破坏了——控制台显示：

> 加载资源失败：服务器响应状态为 404（未找到）

您可以注释掉联系人示例中加载 JSON 数据的部分以使该错误消失，例如，

```
//App.contactsController.loadContacts(); 
```

或者您可以创建一个新的 JSON 文件，例如，

```
[
    {
        "firstName": "Alice",
        "lastName": "Anderson",
        "phoneNumbers": [
            "+1 123-456-7890"
        ]
    },
    {
        "firstName": "José",
        "lastName": "Zulu",
        "phoneNumbers": [
            "+55 (11) 5000-6000"
        ]
    }
] 
```

但是，现在最好不要将您的教育建立在示例上。查看参考文档和一些入门的好文章。我发现[trek 的文章：使用 Ember.js 的建议和说明](http://trek.github.com/)很有帮助。

# git - 更改分支时未刷新 Netbeans 文件

> ID：12379976
> 
> 赞同：3
> 
> 时间：2012-09-12T01:08:27.153
> 
> 标签：git, netbeans

正如标题所说，当我更改分支时，netbeans 文件不会刷新。有什么我需要做的配置吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-12T08:15:38.060

您是从 Netbeans 内部（通过 Team > Git > Branch > Switch To Branch）还是从其他地方（例如通过命令行）执行此操作？

如果您通过命令行执行此操作，则 Netbeans 在您手动刷新之前不会知道更改，而如果您使用 Netbeans 中的上下文菜单，它会知道更改。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-02-06T13:26:38.887

Netbeansh 从项目文件中工作，这意味着你应该有类似的东西：~/Documents/NSProject/myproject 文件夹。这个项目文件夹应该有一个 git 存储库（里面的 .git 文件夹）这是你的 git LOCAL 存储库。

任何远程文件或文件夹项目都必须被视为远程存储库，并且只有在将更改推送到此远程时才知道本地更改

这已经说了。如果您在远程命令行中签出到另一个分支，则不会更新其余已更改的文件。您仅更新保存到 LOCAL NETBEANS PROJECT 文件夹中的文件，然后更新打开的文件，然后放入远程文件夹。

# c# - C# 对象部分转换为 JSON(MVC)

> ID：12379977
> 
> 赞同：1
> 
> 时间：2012-09-12T01:08:35.173
> 
> 标签：c#, asp.net-mvc, json

我在控制器中有以下代码。

```
 class Person
    {
        public string Name { get; set; }
        public int Age { get; set; }
        public DateTime Birthday { get; set; }
    }

    public ActionResult JsonObject()
    {
        Person[] persons = new Person[]{
            new Person{Name="John", Age=26, Birthday=new DateTime(1986,1,1)},
            new Person{Name="Tom", Age=10, Birthday=new DateTime(2002, 1, 9)}
        };

        return Json(persons, JsonRequestBehavior.AllowGet);
    } 
```

通常，我得到这样的结果： [{"Name":"John","Age":26,"Birthday":"/Date(504892800000)/"},{"Name":"Tom","Age ":10,"生日":"/日期(1010505600000)/"}]

没关系，但是，我想为用户做一个选项：不显示生日。因此，预期结果将是这样的： [{"Name":"John","Age":26},{"Name":"Tom","Age":10}]

如何不将生日属性序列化为 JSON？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-12T01:19:36.297

你有两个选择：

1) 在 Person 类中添加 [ScriptIgnore] 属性：

```
public class Person
{
    public string Name { get; set; }
    public int Age { get; set; }
    [ScriptIgnore]
    public DateTime Birthday { get; set; }
} 
```

2）返回一个只包含你想要的属性的匿名类型：

```
var toReturn = persons.Select(x => new {x.Name, x.Age});
return Json(toReturn, JsonRequestBehavior.AllowGet); 
```

编辑：我不知道必须动态选择所需的列。您可以使用以下内容，因为对象和字典在 Javascript 中是相同的。

首先，创建一个扩展来创建所需属性的字典：

```
public static class JSONExtensions
{
    public static IDictionary<string, object> ToJsonObject(this object instance, string[] includedProperties)
    {
        var jsonObject = new Dictionary<string, object>();
        foreach (var property in instance.GetType().GetProperties())
        {
            if (includedProperties.Any(x=> x.Equals(property.Name, StringComparison.InvariantCultureIgnoreCase)))
            {
                jsonObject[property.Name] = property.GetValue(instance);
            }
        }
        return jsonObject;
    }
} 
```

接下来，在序列化之前使用这个扩展方法：

```
var toReturn = persons.Select(x => x.ToJsonObject(desiredColumnss));
return Json(toReturn, JsonRequestBehavior.AllowGet); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-12T01:20:29.850

只需定义一个新类作为 DTO，它只包含必填字段。

```
public class PersonDTO
    {
        public string Name { get; set; }
        public int Age { get; set; }
    } 
```

之后，您可以 PersonDTO

# arrays - MATLAB min(array) 给出的索引超出了数组维度

> ID：12379978
> 
> 赞同：0
> 
> 时间：2012-09-12T01:08:40.367
> 
> 标签：arrays, matlab, indexing

我试图找到两个变量的函数的最小值，然后找到变量的值。

我的方法是通过变量的几个值迭代函数，然后使用 min 函数找到最小值。

```
minval = -10;
maxval = 10;
n = 1;

for x = minval:maxval
    for y = minval:maxval
        f(n) = abs(x-1)+abs(y-1)+abs(x-3)+abs(y-5)+abs(x-8)+abs(y-3);
        n=n+1;
    end
end
f(n) = abs(x-1)+abs(y-1)+abs(x-3)+abs(y-5)+abs(x-8)+abs(y-3);
fmin = min(f) 
```

问题出在最后一行：

```
fmin = min(f) 
```

我收到错误

```
??? Index exceeds matrix dimensions.

Error in ==> Lab2 at 65
fmin = min(f) 
```

为什么是这样？任何帮助是极大的赞赏。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-12T01:26:59.063

不要定义名为 min 的变量。试试这个：

```
which min 
```

它告诉你什么？

请注意，可以通过创建具有相同名称的变量来重载 MATLAB 中的函数。这样做会阻止 MATLAB 访问该函数。这很少是一个好主意，所以不要这样做。解决方案是

```
clear min 
```

因此，您将删除您创建的变量。当然，如果该变量中有重要的内容，请先将其填充到其他地方。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-12T04:32:02.313

当我将它插入我的 Matlab 版本时，该代码运行完美。

如果错误发生在第 65 行，那么您的程序中肯定有其他事情发生。试着把你程序的这一部分变成一个函数，这样它就不会受到你正在处理的所有其他事情的影响。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-12T10:03:58.670

确实看起来您已经声明了一个名为 min 的变量，因此 Matlab 现在将其视为变量而不是函数，因此它认为您正在尝试用向量 f 索引变量 min。

但是只是对您的代码的评论，不管 f(442) 是什么，您都可以在没有像这样的循环的情况下以更加 matlabesque 的方式实现同​​样的事情：

```
minval = -10;
maxval = 10;

X = minval:maxval;
Y = X;

[xx, yy] = meshgrid(X, Y);
F = abs(xx-1) + abs(yy-1) + abs(xx-3) + abs(yy-5) +abs(xx-8) + abs(yy-3); 
```

你`f`现在相当于`F(:)'`（没有最终值......），像这样向自己证明：`sum(f(1:end-1) == F(:)')`

无论如何，作为矩阵的 F 可能比作为平面向量的 f 更有意义，您可以像这样找到 F 的最小值：`min(F(:))`

# node.js - 为生产部署 Node.js 应用程序

> ID：12379983
> 
> 赞同：3
> 
> 时间：2012-09-12T01:09:17.967
> 
> 标签：node.js

我遇到的大多数教程都是通过将服务器设置为侦听端口来设置 Node.js Web 应用程序，并通过指定该端口在浏览器中访问它。但是，我将如何部署 Node.js。 js 应用程序是否可以通过 foobar.com 之类的域完全访问？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-12T01:25:29.493

您必须绑定您的域`apex (naked domain)`，并且通常`www`与您的网络服务器的 ip 或其 CNAME 绑定。

由于您无法将 apex 域与 绑定`CNAME`，因此您必须指定服务器 IP 或 IP 或负载平衡器的 IP

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-12T09:58:39.843

您的问题有点模糊。如果您的 DNS 已经配置，您可以绑定到端口 80 并完成它。但是，如果您已经在端口 80 上运行了 apache 或其他一些 httpd 来为显然无法工作的其他主机提供服务。

如果您更喜欢以非 root 身份运行节点进程（并且您应该），那么您更有可能正在寻找反向代理。我的主要httpd是nginx，相关选项是proxy_pass。如果您使用的是 apache，您可能需要[mod_proxy](http://httpd.apache.org/docs/2.2/mod/mod_proxy.html#proxypassreverse)。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-07T02:00:34.373

我刚刚在注册商处创建了一条“A 记录”，指向我的 Web 服务器的 IP 地址。然后您可以在端口 80 上启动您的节点应用程序。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-11-30T22:55:28.667

另一种方法是重定向：

`http://www.foobar.com`到`http://www.foobar.com:82`

问候。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2016-08-31T13:03:29.473

使用 pm2 在服务器上运行您的节点应用程序。

然后使用 Nginx 代理到您的节点服务器。我知道这听起来很奇怪，但它就是这样做的。最终，如果您需要设置负载均衡器，您也可以在 Nginx 中完成所有操作。

```
server {
listen 80;

server_name example.com;

location / {
    proxy_pass http://APP_PRIVATE_IP_ADDRESS:8080;
    proxy_http_version 1.1;
    proxy_set_header Upgrade $http_upgrade;
    proxy_set_header Connection 'upgrade';
    proxy_set_header Host $host;
    proxy_cache_bypass $http_upgrade;
} 
```

}

这是我找到的关于为生产设置 node.js 的最佳教程。

[https://www.digitalocean.com/community/tutorials/how-to-set-up-a-node-js-application-for-production-on-ubuntu-14-04](https://www.digitalocean.com/community/tutorials/how-to-set-up-a-node-js-application-for-production-on-ubuntu-14-04)

为了性能，您还设置了 nginx 来提供您的公共文件。

```
location /public {
    allow all;
    access_log off;
root /opt/www/site; 
```

}

# regex - ColdFusion 从文本文件中删除空行

> ID：12379989
> 
> 赞同：0
> 
> 时间：2012-09-12T01:10:19.817
> 
> 标签：regex, coldfusion

我正在使用以下代码来更新 robots.txt，具体取决于特定页面被标记为允许还是禁止。

```
<cflock type="exclusive" timeout="5">
    <cfset vRemoveLine = ListContainsNoCase(robots,"Disallow: #sURL#", "#chr(13)##chr(10)#")>
    <cfif vRemoveLine>
        <cfset robots = ListDeleteAt(robots, vRemoveLine, "#chr(13)##chr(10)#")>
    </cfif>
    <cffile action="write"
        file="#sitePath#robots.txt"
        output="#robots#"
        nameconflict="overwrite">
</cflock> 
```

但是，它还没有完成和/或可以写得更好。具体来说，当删除一行时，它也不会删除其相关的回车，如果该行位于除底部之外的任何位置，则更是如此。

截图：

1) 拆线前

![在此处输入图像描述](../Images/9226af86888a92dceec8a0f05c16b990.png)

2) 拆线后

![在此处输入图像描述](../Images/0bd7231bc2e2a831f17a4b2bec2428b7.png)

还要注意底部的附加空白行。除了删除不允许及其换行符之外，我还需要丢失所有这些空白行。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-12T13:01:03.700

实际上，更加注意您的代码，您可以简单地做......

```
<cfset robots = robots.replaceAll( "(?m)^Disallow: #ReEscape(sURL)#(?:\r?\n|\z)" , "" ) /> 
```

...而不是那些 List 函数。

这将删除您刚刚删除的行的换行符，但不会删除文件中其他地方存在的任何换行符（可能用于拆分部分并提高可读性）。

当然，如果您想确保文件末尾没有空格，您当然也可以使用 trim。

作为解释，这里又是上面的正则表达式，以扩展/注释形式：

```
(?x)    ## enable extended/comment mode
        ## (literal whitespace is ignored, hashes start comments, also ignored)
(?m)    ## enable multiline mode
        ## (meaning  ^ and $ match start/end of each line, as well as of entire input)

^Disallow:\  ## Match literal text "Disallow: " at start of a line.
             ## (In comment mode, a \ is needed before the space
             ##  in standard use this is not required.)

#ReEscape(sURL)#   ## use ReEscape to avoid issues since the URL might
                   ## contain characters that are non-literal in a regex.

(?:     ## non-capturing group to contain alternation between...

    \r?\n   ## match optional carriage return followed by a newline.
|       ## or
    \z      ## match end of input (whether there is a newline there or not)
) 
```

*（要在 CFML 中使用它，请将其包装在 cfsavecontent 和 cfoutput 中，然后将结果变量放入`robot.replaceAll(here,'')`.）*

如果您真的想确保文件中没有多个换行符（无论与删除不允许行相关的任何更改），最简单的方法是：

```
<cfset robots = robots.trim().replaceAll('\r','').replaceAll('\n{2,}','\n') /> 
```

它修剪两端，然后删除所有回车符，然后用一个换行符替换至少两个换行符的所有实例。

（但总的来说，我可能会推荐最初的更具体的表达方式，而不是一揽子删除多个换行符。）

# java - Android：String.split() 方法实际上没有拆分？

> ID：12379991
> 
> 赞同：1
> 
> 时间：2012-09-12T01:10:27.840
> 
> 标签：java, android

也许这是漫长的一天，我忽略了一些事情，但这让我非常抓狂。

```
String[] address = "192.169.2.10".split(".");
Log.d(TAG, "Address array length: "+address.length); 
//Output: 'Address array length: 0' 
```

我正在解析设备 IP 地址，并尝试`String`通过将其拆分为句点字符来将其拆分为一个数组。显然这应该返回一个长度为 4 的数组，但它返回的长度为 0。

我在这里俯瞰有什么明显的东西吗？

注意：真正的代码是从 中提取 IP 地址`WifiManager`，但即使我像上面那样在其中放入任意 IP 字符串，长度也是 0。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-09-12T01:11:13.343

to 的参数[`split`](http://docs.oracle.com/javase/6/docs/api/java/lang/String.html#split%28java.lang.String%29)是一个正则表达式，并且`.`具有特殊含义，因此您需要对其进行转义：

```
String[] address = "192.169.2.10".split("\\."); 
```

# php - PHP表单/发布错误

> ID：12379995
> 
> 赞同：3
> 
> 时间：2012-09-12T01:10:55.667
> 
> 标签：php, mysql, html, forms

好的，我的发布脚本有点问题。一切都很好，除了当我输入一个像撇号一样的短语时，例如“这是我的标题”不会​​发布，而“这是我的标题”会发布。不知道为什么会这样。也许我真的不知道条形标签，我该怎么办？当它不起作用时，我会收到底部错误消息

```
} else {
if(isset($_POST['what'])&&isset($_POST['when'])&&isset($_POST['where'])&&isset($_POST['details'])&&isset($_POST['sponsored_by'])&&isset($_POST['collegeId'])){

$what = nl2br(htmlspecialchars(strip_tags(stripslashes(trim($_POST['what'])))));

$where = nl2br(htmlspecialchars(strip_tags(stripslashes(trim($_POST['where'])))));

$when = nl2br(htmlspecialchars(strip_tags(stripslashes(trim($_POST['when'])))));

$sponsored_by = nl2br(htmlspecialchars(strip_tags(stripslashes(trim($_POST['sponsored_by'])))));

$details = nl2br(htmlspecialchars(strip_tags(stripslashes(trim($_POST['details'])))));
    $collegeId = intval($_POST["collegeId"]);
    if(isset($_SESSION['username'])){

$username = htmlspecialchars(strip_tags(stripslashes(trim(($_SESSION['username'])))));
        $query = "select id, Name from users where username='$username' and activated = 1";
        $doQuery = mysql_query($query);
        if(mysql_num_rows($doQuery)>0){
            $results = mysql_fetch_array($doQuery);
            $userName = $results['Name'];
            $email = $username;
            $id = $results['id'];
            $query = "insert into events values(NULL,$id,$collegeId,'$what','$when','$where','$details','$sponsored_by',NOW())";
            if(mysql_query($query)) header("Location: collegeInfo.php?college=$collegeId&message=added");
            else echo "Failed to create new Event!".$query; 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-12T01:14:54.810

你不要逃避你的查询。尝试至少使用`addslashes`或清理您的输入`mysql_real_escape_string`。所以`stripslashes`- 从行中删除反斜杠。用于`addslashes`添加它们，而不是在 mysql 查询之前删除。

老兄，在新的 php 版本中`mysql_query`已**弃用**，请使用带有准备好的语句的 PDO。

# javascript - 如何正确分配 jQuery 事件处理程序？

> ID：12379998
> 
> 赞同：2
> 
> 时间：2012-09-12T01:11:05.667
> 
> 标签：javascript, ajax, jquery

我还在学习如何使用 AJAX，所以在这里显示一个新手代码......

**我得到了这个 div（它作为一个复选框列表重复出现）：**

```
<div class="updateTask fs11">
  <input type="checkbox" name="taskStatusRadio" id="taskStatus" value="<?php echo $taskId; ?>" <?php echo $done; ?> > 
  <?php _e('Task Done', 'sagive'); ?>
</div> 
```

**这激活了这个：**

```
jQuery(function($){
    $('.updateTask').click(function () {

        $.post(ajax_object.ajaxurl, {
            action: 'action_update_task',
            task_id: $("input[name=taskStatusRadio]:checked").map(function () {return this.value;}).get()

        }, function(data) {

            // USE DATA RETURNED //////////
            var $response   = $(data);
            var message     = $response.filter('div#message').html();
            var taskid      = $response.filter('div#taskid').html();        

            // SUCCESS RESPOND //////////
            setTimeout(function(){
                $('#success ul li').append(message + taskid);
                $('#success').fadeIn();
                $('#success').css("display", "block");              
            }, 1000);   

            setTimeout(function(){
                $('#success ul li').empty();
                $('#success').fadeIn();
                $('#success').css("display", "none");               
            }, 30000);

            hideTask = "#" + taskid;
            $(hideTask).hide("slow");

            hideTask = '';

        });
    });
}); 
```

**并使用这个 php 文件：**

```
wp_enqueue_script( 'ajax-update-task', get_stylesheet_directory_uri().'/ajaxLoops/ajax-update_task.js', array('jquery'), 1.0 ); // jQuery will be included automatically
wp_localize_script( 'ajax-update-task', 'ajax_object', array( 'ajaxurl' => admin_url( 'admin-ajax.php' ) ) ); // setting ajaxurl

add_action( 'wp_ajax_action_update_task', 'ajax_update_task' ); // ajax for logged in users
function ajax_update_task() {

    global $current_user;
    get_currentuserinfo();
    $task_user = $current_user->display_name;
    if($taskUser == '') {$taskUser = $current_user->user_login;}

    $task_id = $_POST["task_id"];
    $task_id = $task_id[0];
    $task_status = 'done';
    $task_title = get_the_title($task_id);
    $task_title = mb_substr($task_title, 0 ,35).'...';

    update_post_meta($task_id, '_sagive_task_radio_selector', $task_status);
    update_post_meta($task_id, '_sagive_task_user_changed', $task_user);

    echo '<div id="message">'.__('The task: ', 'sagive').$task_title.__('Was Marked Completed!', 'sagive').'</div>';
    echo '<div id="taskid">'.$task_id.'</div>';

    die(); // stop executing script
} 
```

第一次一切正常。但是我在第一个复选框按预期消失后标记的第二个复选框什么也没做。它不会激活 php 脚本，也不会返回响应。

由于我仍然是使用 AJAX 的新手，因此我将不胜感激使用我的代码的示例或带有解释的好示例。

**修订版 1：**
这是复选框所在页面的结构 ![在此处输入图像描述](../Images/c5d287a0e9ae5fd4a041515ac69ef213.png)

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-26T12:49:39.940

我认为您的问题来自您的选择器：

```
$("input[name=taskStatusRadio]:checked").map(function () {return this.value;}).get(); 
```

它返回所有`taskStatusRadio`检查的输入，而不仅仅是您单击的输入。
您的 php 脚本接收在数组中检查的所有 taskid，然后选择第一个对其进行处理并发送响应。
所以第一次，没关系，你只选中了一个复选框。但是当您选中第二个复选框时，所有选中的 taskid 都将被发送，并且只会`$_POST["task_id"][0]`处理。
来自您的 php 脚本的相同响应，前视图没有变化。

所以，我认为，你只需要修改一点你的代码，只发布你点击它的复选框的taskid。

```
jQuery(function($) {
    // we listen only the checkbox, not the div click action
    $(':checkbox', '.updateTask').click(function () {
        // if the checkbox is checked
        if ($(this).attr('checked') == "checked") {

            $.post(ajax_object.ajaxurl, {
                  action: 'action_update_task',
                  task_id: $(this).val() }, 
                  function(data) {

                      // SUCCESS RESPOND //////////
                      setTimeout(function() {
                          $('#success ul li').append( $(data).html());
                          $('#success').fadeIn();
                          $('#success').css("display", "block");              
                          }, 1000);   

                      setTimeout(function() {
                          $('#success ul li').empty();
                          $('#success').fadeIn();
                          $('#success').css("display", "none");               
                          }, 30000);

                      // we hide the checkbox
                      $(this).hide("slow");
             });
         }
     });
 }); 
```

由于前端 javascript 的这种变化，我们必须像这样简化您的 php 脚本：

```
wp_enqueue_script( 'ajax-update-task', get_stylesheet_directory_uri().'/ajaxLoops/ajax-update_task.js', array('jquery'), 1.0 ); // jQuery will be included automatically
wp_localize_script( 'ajax-update-task', 'ajax_object', array( 'ajaxurl' => admin_url( 'admin-ajax.php' ) ) ); // setting ajaxurl

add_action( 'wp_ajax_action_update_task', 'ajax_update_task' ); // ajax for logged in users
function ajax_update_task() {

    global $current_user;
    get_currentuserinfo();
    $task_user = $current_user->display_name;
    if($taskUser == '') {$taskUser = $current_user->user_login;}

    $task_id = $_POST["task_id"];
    $task_status = 'done';
    $task_title = get_the_title($task_id);
    $task_title = mb_substr($task_title, 0 ,35).'...';

    update_post_meta($task_id, '_sagive_task_radio_selector', $task_status);
    update_post_meta($task_id, '_sagive_task_user_changed', $task_user);

    //  Note : now we send the message directly well-formed with the task_id
    echo __('The task: ', 'sagive').$task_title.__('Was Marked   Completed!', 'sagive'). $task_id;

    die(); // stop executing script
} 
```

希望我的回答能解决你的问题；）

ps：我为我糟糕的英语道歉......