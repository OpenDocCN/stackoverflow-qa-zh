# StackOverflow 问答 10199000-10199999

# jquery - Json 请求解析错误 - 意外令牌 < MVC3

> ID：10199002
> 
> 赞同：-1
> 
> 时间：2012-04-17T20:54:23.443
> 
> 标签：jquery, ajax, json, asp.net-mvc-3, partial

所以我对控制器的 Json 调用有问题。我收到一个错误“parseerror - Unexpected token <”

在我看来，我的代码如下：

```
$("select[name='SelectedProjectStatus']").change(function () {

        var DashboardModel = {
            SelectedProjectStatus: $("select[name='SelectedProjectStatus']").val(),
            Page: 1
        };

        $.ajax({
            url: '@Url.Action("Dashboard", "Dashboard")',
            type: 'POST',
            data: JSON.stringify(DashboardModel),
            dataType: 'json',
            contentType: 'application/json; charset=utf-8',
            success: function (data) {
                $('#DashboardResult').replaceWith(data);
            },
            error: function (request, status, err) {
                alert(status);
                alert(err);
            }
        });

    }); 
```

在我的控制器中：

```
 [HttpPost]
    public ActionResult Dashboard(DashboardModel dashboard)
    {
        var MyProjects = EFProject.Project.Where(x => x.UserID == 1);
        if (dashboard.SelectedProjectStatus != 0)
            MyProjects = MyProjects
                        .Where(x => x.Status == dashboard.SelectedProjectStatus)
                        .OrderByDescending(p => p.AuditingCD)
                        .Skip((dashboard.Page - 1) * PageSize)
                        .Take(PageSize);
        else
            MyProjects = MyProjects
                      .OrderByDescending(p => p.AuditingCD)
                      .Skip((dashboard.Page - 1) * PageSize)
                      .Take(PageSize);

        DashboardModel model = new DashboardModel
        {
            Projects = MyProjects,
            PagingInfo = new PagingInfo
               {
                   CurrentPage = dashboard.Page,
                   ItemsPerPage = PageSize,
                   TotalItems = EFProject.Project.Where(x => x.UserID == 1).Count()
               }
        };
        if (Request.IsAjaxRequest())
        {
            return PartialView("DashboardResult", model);
        }
        else
        {
            return View(model);
        }
    } 
```

我试图渲染的部分视图只有以下内容：

```
@using BidThatProject.Web.Models.NonReusableModels.ProjectManagment
@model DashboardModel
<div id="DashboardResult">

</div> 
```

并且父视图显然具有具有相同 id 的 div。它至少应该通过在我身上显示一个空白空间来工作，但它似乎在将数据解析回视图时遇到了问题。可能是它没有将其作为 application/json 类型读取？我真的不知道。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-17T21:21:06.690

使用 Json Result 并返回 Json(model);

```
public JsonResults MyTest(){
    var model = FROM b in Table WHERE b.id == 1 select b;
    return Json(model);
}

$.ajax({
        url: '@Url.Action("Dashboard", "Dashboard")',
        type: 'POST',
        data: {page: 1, selected: $("select[name='SelectedProjectStatus']").val() },
        dataType: 'json',
        contentType: 'application/json; charset=utf-8',
        success: function (data) { // 
            // process the json object into html page
        },
        error: function (request, status, err) {
            alert(status);
            alert(err);
        }
    }); 
```

这是一个编辑，因为博客文章是通过 ajax 获取部分视图，而不是通过 ajax 获取 json 数据：

```
public ActionResults MyTest(SearchModel  results){
    var model = FROM b in Table WHERE b.id == 1 select b;
    return PartialView("ViewName",model);
}
// you create a partial view that takes in your model
$.ajax({
    url: '/ajax/MySearch',
    type: 'POST',
    data: $("form").serialize(),        
    success: function (data) { // 
        $("#searchresults").html(data);
    },
    error: function (request, status, err) {
        alert(status);
        alert(err);
    }
}); 
```

# javascript - 根据页面中是否定义了元素，提供备用的外部 Javascript 文件

> ID：10199006
> 
> 赞同：2
> 
> 时间：2012-04-17T20:54:31.287
> 
> 标签：javascript, jquery

好的，这是我的第一个问题。

设置：我们使用基于 javascript 的工具来 A/B 测试我们的着陆页设计。我需要版本 A（控件）来链接到一个外部 javascript 文件，需要版本 B（变体）来链接到备用 javascript 文件。

目标：在控件底部有一个内部 js 脚本，用于查看该工具实际上是服务于 A 还是 B，如果是，则服务于哪一个。结果表明应该链接哪个外部脚本。

问题：无论该工具实际上是为 A 还是 B 服务，都会先链接原始脚本，然后如果检测到该工具，然后再链接相应的脚本。

这是我的代码（对于任何新手错误，我提前道歉）：

```
//script at bottom of original or tool-served control html page template
<script type="text/javascript">
valForTool = function () {
  var variationId = _tool_exp[_tool_exp_ids[0]].combination_chosen;
  if (variationId == 1) {
     var newScript = document.createElement('script');
     newScript.type = 'text/javascript';
     newScript.src = 'js/scripts.js';
     document.body.appendChild(newScript);
   };
}
originalValidation = function () {
  var newScript = document.createElement('script');
   newScript.type = 'text/javascript';
   newScript.src = 'js/scripts.js';
   document.body.appendChild(newScript);
}
$(function(){
  if (typeof _tool_exp_ids !== 'undefined' && typeof _tool_exp_ids[0] !== 'undefined') {
     valForTool();
  }  else {   
     originalValidation();
  };   
});
</script>
//end script on control or original template  

//script on tool-served variation html template - will run after the above script
<script type="text/javascript"> 
$(function() {
     $('#project_info input[type=submit]').removeAttr('disabled');
     $('#project_info').unbind();
     var newScript = document.createElement('script');
     newScript.type = 'text/javascript';
     newScript.src = 'js/scripts2.js';
     document.body.appendChild(newScript);  
     $('.input_text').parent().addClass('contact_field');
 });
</script>
// end script on variation template 
```

关于我做错了什么的任何想法？我是否提供了足够的信息？谢谢！我喜欢这个网站作为我的问题的参考，但这是我第一次真正发布一个。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-17T21:54:31.407

缩短一点，看起来你只是这样做：

```
<script type="text/javascript">
$(function(){
   if (typeof _tool_exp_ids !== 'undefined' && typeof _tool_exp_ids[0] !== 'undefined') {
      var variationId = _tool_exp[_tool_exp_ids[0]].combination_chosen;
      if (variationId == 1) {
          $.getScript('js/scripts.js', function() {runSecond();});
      }
   }else{   
          $.getScript('js/scripts.js', function() {runSecond();});
   }

   function runSecond() {
      $('#project_info input[type=submit]').removeAttr('disabled').unbind();
      $.getScript('js/scripts2.js');
      $('.input_text').parent().addClass('contact_field');
   }
});
</script> 
```

现在看看，很明显，无论在那些 if/else 语句中满足什么条件，这两个脚本都在运行，我真的不明白你想要做什么，但我要做的第一件事就是添加一些 console.logs 以查看这些 if/else 语句是否按预期工作，然后确定在哪些条件下应该加载哪些脚本等？

# php - 如何解决 php json_decode 中的 JSON_ERROR_UTF8 错误？

> ID：10199017
> 
> 赞同：53
> 
> 时间：2012-04-17T20:55:29.833
> 
> 标签：php, json, parsing, jsonp

我正在尝试这段代码

```
$json = file_get_contents("http://www.google.com/alerts/preview?q=test&t=7&f=1&l=0&e");
print_r(json_decode(utf8_encode($json), true));

        //////////////

// Define the errors.
$constants = get_defined_constants(true);
$json_errors = array();
foreach ($constants["json"] as $name => $value) {
    if (!strncmp($name, "JSON_ERROR_", 11)) {
        $json_errors[$value] = $name;
    }
}

// Show the errors for different depths.
foreach (range(4, 3, -1) as $depth) {
    var_dump(json_decode($json, true, $depth));
    echo 'Last error: ', $json_errors[json_last_error()], PHP_EOL, PHP_EOL;
} 
```

我尝试了很多函数，html_entities_decode、utf8_encode 和 decode、解码十六进制代码，但我总是收到错误“JSON_ERROR_UTF8”。

**我怎么能解决这个问题？**

* * *

## 回答 #1

> 赞同：77
> 
> 时间：2014-11-05T15:32:10.100

[有一个很好的功能](http://php.net/manual/en/function.json-last-error.php#115980)可以清理您的数组。

我建议你使用这样的 json_encode 包装器：

```
function safe_json_encode($value, $options = 0, $depth = 512, $utfErrorFlag = false) {
    $encoded = json_encode($value, $options, $depth);
    switch (json_last_error()) {
        case JSON_ERROR_NONE:
            return $encoded;
        case JSON_ERROR_DEPTH:
            return 'Maximum stack depth exceeded'; // or trigger_error() or throw new Exception()
        case JSON_ERROR_STATE_MISMATCH:
            return 'Underflow or the modes mismatch'; // or trigger_error() or throw new Exception()
        case JSON_ERROR_CTRL_CHAR:
            return 'Unexpected control character found';
        case JSON_ERROR_SYNTAX:
            return 'Syntax error, malformed JSON'; // or trigger_error() or throw new Exception()
        case JSON_ERROR_UTF8:
            $clean = utf8ize($value);
            if ($utfErrorFlag) {
                return 'UTF8 encoding error'; // or trigger_error() or throw new Exception()
            }
            return safe_json_encode($clean, $options, $depth, true);
        default:
            return 'Unknown error'; // or trigger_error() or throw new Exception()

    }
}

function utf8ize($mixed) {
    if (is_array($mixed)) {
        foreach ($mixed as $key => $value) {
            $mixed[$key] = utf8ize($value);
        }
    } else if (is_string ($mixed)) {
        return utf8_encode($mixed);
    }
    return $mixed;
} 
```

在我的应用程序中，utf8_encode() 比 iconv() 效果更好

* * *

## 回答 #2

> 赞同：56
> 
> 时间：2013-06-19T03:31:15.177

您需要简单的代码行：

```
$input = iconv('UTF-8', 'UTF-8//IGNORE', utf8_encode($input));
$json = json_decode($input); 
```

信用：桑乐，我的队友给了我这个代码。是的！

* * *

## 回答 #3

> 赞同：14
> 
> 时间：2014-06-25T17:22:18.720

除非你能保证输入是有效的，否则 iconv 函数是毫无价值的。请改用 mb_convert_encoding。

```
mb_convert_encoding($value, "UTF-8", "auto"); 
```

您可以获得比“auto”更明确的信息，甚至可以指定以逗号分隔的预期输入编码列表。

最重要的是，将处理无效字符而不会导致整个字符串被丢弃（与 iconv 不同）。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2021-04-04T22:33:01.677

没有灵丹妙药可以“解决”编码问题；你必须了解你有什么编码，然后转换它。

计算机最终传输和存储二进制数据；为了使二进制数据有用，我们设计了这样的代码：“这个二进制字符串代表一个'a'，一个代表一个'b'，另一个代表商务西装悬浮表情符号️”。 UTF-8（稍微简化一点）只是其中一种编码。其他编码有 ASCII、ISO-8859-1、Windows Code Page 1252 和 Shift-JIS 等名称。

如果您只知道一个字符串不是“UTF-8” *，那么您就无法将其转换为 UTF-8*，因为您不知道第一个字符应该是“a”还是“️”。

如果你*知道*你的字符串是什么编码，你可以使用 PHP 中的三个函数中的任何一个；根据您安装的 PHP，部分或全部可能不可用，但它们是您想要的。

*   [图标v](https://www.php.net/manual/en/function.iconv.php)
*   [mb_convert_encoding](https://www.php.net/manual/en/function.mb-convert-encoding.php)
*   [UConverter::转码](https://www.php.net/manual/en/uconverter.transcode.php)

请注意，mb_convert_encoding 允许您省略说明当前编码的参数。这不会**自动**计算出正确的编码，它只是使用您控制的全局设置。

PHP 中还提供了另外两个名称错误的函数：[utf8_encode](https://www.php.net/manual/en/function.utf8-encode.php)和[utf8_decode](https://www.php.net/manual/en/function.utf8-decode.php)。这些只是上述三个函数的极其有限的版本：它们*只能从 ISO-8859-1 转换为 UTF-8 并返回*。如果您的字符串不在该编码中（并且您不希望它是），*这些函数将无济于事*。它们可能会使您的错误消失，但这与修复数据不同。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2019-08-05T08:14:01.990

**在 PHP 中** 解码 JSON 解码 JSON 就像对其进行编码一样简单。PHP 为您提供了一个方便的 json_decode 函数，可以为您处理所有事情。如果你只是将一个有效的 JSON 字符串传递给方法，你会得到一个 stdClass 类型的对象。这是一个简短的示例：

```
<?php
$string = '{"foo": "bar", "cool": "attr"}';
$result = json_decode($string);

// Result: object(stdClass)#1 (2) { ["foo"]=> string(3) "bar" ["cool"]=> string(4) "attr" }
var_dump($result);

// Prints "bar"
echo $result->foo;

// Prints "attr"
echo $result->cool;
?> 
```

如果您想取回关联数组，请将第二个参数设置为 true：

```
<?php
$string = '{"foo": "bar", "cool": "attr"}';
$result = json_decode($string, true);

// Result: array(2) { ["foo"]=> string(3) "bar" ["cool"]=> string(4) "attr" }
var_dump($result);

// Prints "bar"
echo $result['foo'];

// Prints "attr"
echo $result['cool'];
?> 
```

如果您期望一个非常大的嵌套 JSON 文档，您可以将递归深度限制在某个级别。如果文档比给定深度更深，该函数将返回 null 并停止解析。

```
<?php
$string = '{"foo": {"bar": {"cool": "value"}}}';
$result = json_decode($string, true, 2);

// Result: null
var_dump($result);
?> 
```

最后一个参数的工作方式与 json_encode 中的相同，但目前只支持一个位掩码（它允许您将 bigints 转换为字符串，并且仅在 PHP 5.4 及更高版本中可用）。到目前为止，我们一直在使用有效的 JSON 字符串（除了从零深度错误）。下一部分将向您展示如何处理错误。

**错误处理和测试** 如果无法解析 JSON 值或找到比给定（或默认）深度更深的嵌套级别，则从 json_decode 返回 NULL。这意味着 json_encode/json_deocde 不会直接引发异常。

那么我们如何确定错误的原因呢？json_last_error 函数在这里有所帮助。json_last_error 返回一个整数错误代码，它可以是以下常量之一（取自此处）：

JSON_ERROR_NONE：没有发生错误。JSON_ERROR_DEPTH：已超过最大堆栈深度。JSON_ERROR_STATE_MISMATCH：无效或格式错误的 JSON。JSON_ERROR_CTRL_CHAR：控制字符错误，可能编码不正确。JSON_ERROR_SYNTAX：语法错误。JSON_ERROR_UTF8：格式错误的 UTF-8 字符，可能编码不正确（自 PHP 5.3.3 起）。有了这些信息，我们可以编写一个快速解析辅助方法，在发现错误时引发描述性异常。

```
<?php
class JsonHandler {

    protected static $_messages = array(
        JSON_ERROR_NONE => 'No error has occurred',
        JSON_ERROR_DEPTH => 'The maximum stack depth has been exceeded',
        JSON_ERROR_STATE_MISMATCH => 'Invalid or malformed JSON',
        JSON_ERROR_CTRL_CHAR => 'Control character error, possibly incorrectly encoded',
        JSON_ERROR_SYNTAX => 'Syntax error',
        JSON_ERROR_UTF8 => 'Malformed UTF-8 characters, possibly incorrectly encoded'
    );

    public static function encode($value, $options = 0) {
        $result = json_encode($value, $options);

        if($result)  {
            return $result;
        }

        throw new RuntimeException(static::$_messages[json_last_error()]);
    }

    public static function decode($json, $assoc = false) {
        $result = json_decode($json, $assoc);

        if($result) {
            return $result;
        }

        throw new RuntimeException(static::$_messages[json_last_error()]);
    }

}
?> 
```

我们现在可以使用上一篇关于异常处理的文章中的异常测试功能来测试我们的异常是否正常工作。

```
// Returns "Correctly thrown"
assertException("Syntax error", function() {
    $string = '{"foo": {"bar": {"cool": NONUMBER}}}';
    $result = JsonHandler::decode($string);
}); 
```

请注意，从 PHP 5.3.3 开始，当在字符串中发现无效的 UTF-8 字符时会返回 JSON_ERROR_UTF8 错误。这强烈表明使用了不同于 UTF-8 的字符集。如果传入的字符串不在您的控制之下，您可以使用 utf8_encode 函数将其转换为 utf8。

```
<?php echo utf8_encode(json_encode($payload)); ?> 
```

我过去一直使用它来转换从不使用 UTF-8 的旧版 MSSQL 数据库加载的数据。

[资源](https://nitschinger.at/Handling-JSON-like-a-boss-in-PHP/)

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2020-04-21T22:02:19.453

我通过@Konstantin解决了添加另一个'if'来管理'utf8ize'函数中的对象（我没有使用其他函数）：

```
function utf8ize($mixed) {
    if (is_array($mixed)) {
        foreach ($mixed as $key => $value) {
            $mixed[$key] = utf8ize($value);
        }
    } else if (is_string ($mixed)) {
        return utf8_encode($mixed);
    } else if (is_object($mixed)) {
        $a = (array)$mixed; // from object to array
        return utf8ize($a);
    }
    return $mixed;
} 
```

# jquery - 通过 ajax (rails & jquery) 更新时表单未提交选定的值

> ID：10199020
> 
> 赞同：0
> 
> 时间：2012-04-17T20:55:44.297
> 
> 标签：jquery, ruby-on-rails

I have a form that has several drop downs, when one is chosen, it updates another. 当我提交此表单时，不会提交通过 ajax 更新的下拉列表的值。当我在更新后使用 firebug 查看表单时，它看起来不错。

这是我的代码

```
 var $j = jQuery.noConflict();

  $j(document).ready(
function(){
   $j('#source_credential_list').change(function(){
          var source_credential = $j("#source_credential").val();
         $j.post("/retrieved_data_records/keys_for_source_credential", {"source_credential":source_credential}, function(result) {
         });
         });
} 
```

```
 <% form_tag  '/retrieved_data_records', :method => :get do %>

      <tr>
     <td>
        <b> Source Credentials</b>
        </td>
         <td>
               <span id="source_credential_list">
                  <%= render :partial => 'source_credential_list' %>
               </span>
         </td>
  </tr>
  <tr>
     <td>
        <b>Source Keys</b>
     </td>
    <td>
       <span id="source_key_list">
           <%= render :partial => 'source_key_list' %>
       </span>

     </td>
  </tr>
<div id="filtersButton"><td><%=submit_tag 'Filter'%></td></div> 
```

source_key_list 部分：

```
 <%=select_tag :filter_source_key, options_from_collection_for_select(@all_source_keys, 'key_name', 'display_fancy_name', @selected_key.key_name)%> 
```

服务器端 keys_for_source_credential 返回：

```
 $j("#source_key_list").html("<%= escape_javascript(render(:partial => 'source_credential_key_list')) %>"); 
```

source_credential_key_list 部分：

```
 <%=select_tag :filter_source_key, options_from_collection_for_select(@all_credential_keys.sort, 'key_name', 'display_fancy_name')%> 
```

在我的服务器上，未提交下拉值。我想我可以手动发布我的下拉选择以及表单发布，但它似乎应该工作......我确定我在做一些愚蠢的事情。

有任何想法吗？

谢谢乔尔

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-18T21:25:24.090

原来我的问题是我的表格在表格之前开始并在表格之后结束，将表格开始和结束移动到表格内解决了我的问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-17T20:57:50.380

我认为你不能使用 val，而是使用文本

```
 $j("#source_credential").text(); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-02-06T15:36:11.717

我遇到了同样的问题，表单没有在选择元素中提交我选择的值。

我通过将“id”更改为“name”来解决。

# ios - iOS：从前置摄像头捕获图像

> ID：10199021
> 
> 赞同：15
> 
> 时间：2012-04-17T20:55:51.320
> 
> 标签：ios, camera

我正在制作一个应用程序，我想从前置摄像头捕获图像，而不显示任何类型的捕获屏幕。我想在没有任何用户交互的情况下完全用代码拍照。我将如何为前置摄像头执行此操作？

* * *

## 回答 #1

> 赞同：41
> 
> 时间：2012-12-28T00:27:49.257

如何使用 AVFoundation 前置摄像头捕捉图像：

开发注意事项：

*   仔细检查您的应用程序和图像方向设置
*   AVFoundation 及其相关框架是令人讨厌的庞然大物，很难理解/实现。我已经使我的代码尽可能精简，但请查看这个优秀的教程以获得更好的解释（网站不再可用，通过 archive.org 链接）： [http ://www.benjaminloulier.com/posts/ios4-和直接访问相机](https://web.archive.org/web/20151231002415/http://www.benjaminloulier.com/posts/ios4-and-direct-access-to-the-camera)

视图控制器.h

```
// Frameworks
#import <CoreVideo/CoreVideo.h>
#import <CoreMedia/CoreMedia.h>
#import <AVFoundation/AVFoundation.h>
#import <UIKit/UIKit.h>

@interface CameraViewController : UIViewController <AVCaptureVideoDataOutputSampleBufferDelegate>

// Camera
@property (weak, nonatomic) IBOutlet UIImageView* cameraImageView;
@property (strong, nonatomic) AVCaptureDevice* device;
@property (strong, nonatomic) AVCaptureSession* captureSession;
@property (strong, nonatomic) AVCaptureVideoPreviewLayer* previewLayer;
@property (strong, nonatomic) UIImage* cameraImage;

@end 
```

视图控制器.m

```
#import "CameraViewController.h"

@implementation CameraViewController

- (void)viewDidLoad
{
    [super viewDidLoad];

    [self setupCamera];
    [self setupTimer];
}

- (void)setupCamera
{    
    NSArray* devices = [AVCaptureDevice devicesWithMediaType:AVMediaTypeVideo];
    for(AVCaptureDevice *device in devices)
    {
        if([device position] == AVCaptureDevicePositionFront)
            self.device = device;
    }

    AVCaptureDeviceInput* input = [AVCaptureDeviceInput deviceInputWithDevice:self.device error:nil];
    AVCaptureVideoDataOutput* output = [[AVCaptureVideoDataOutput alloc] init];
    output.alwaysDiscardsLateVideoFrames = YES;

    dispatch_queue_t queue;
    queue = dispatch_queue_create("cameraQueue", NULL);
    [output setSampleBufferDelegate:self queue:queue];

    NSString* key = (NSString *) kCVPixelBufferPixelFormatTypeKey;
    NSNumber* value = [NSNumber numberWithUnsignedInt:kCVPixelFormatType_32BGRA];
    NSDictionary* videoSettings = [NSDictionary dictionaryWithObject:value forKey:key];
    [output setVideoSettings:videoSettings];

    self.captureSession = [[AVCaptureSession alloc] init];
    [self.captureSession addInput:input];
    [self.captureSession addOutput:output];
    [self.captureSession setSessionPreset:AVCaptureSessionPresetPhoto];

    self.previewLayer = [AVCaptureVideoPreviewLayer layerWithSession:self.captureSession];
    self.previewLayer.videoGravity = AVLayerVideoGravityResizeAspectFill;

    // CHECK FOR YOUR APP
    self.previewLayer.frame = CGRectMake(0, 0, self.view.frame.size.height, self.view.frame.size.width);
    self.previewLayer.orientation = AVCaptureVideoOrientationLandscapeRight;
    // CHECK FOR YOUR APP

    [self.view.layer insertSublayer:self.previewLayer atIndex:0];   // Comment-out to hide preview layer

    [self.captureSession startRunning];
}

- (void)captureOutput:(AVCaptureOutput *)captureOutput didOutputSampleBuffer:(CMSampleBufferRef)sampleBuffer fromConnection:(AVCaptureConnection *)connection
{
    CVImageBufferRef imageBuffer = CMSampleBufferGetImageBuffer(sampleBuffer);
    CVPixelBufferLockBaseAddress(imageBuffer,0);
    uint8_t *baseAddress = (uint8_t *)CVPixelBufferGetBaseAddress(imageBuffer);
    size_t bytesPerRow = CVPixelBufferGetBytesPerRow(imageBuffer);
    size_t width = CVPixelBufferGetWidth(imageBuffer);
    size_t height = CVPixelBufferGetHeight(imageBuffer);

    CGColorSpaceRef colorSpace = CGColorSpaceCreateDeviceRGB();
    CGContextRef newContext = CGBitmapContextCreate(baseAddress, width, height, 8, bytesPerRow, colorSpace, kCGBitmapByteOrder32Little | kCGImageAlphaPremultipliedFirst);
    CGImageRef newImage = CGBitmapContextCreateImage(newContext);

    CGContextRelease(newContext);
    CGColorSpaceRelease(colorSpace);

    self.cameraImage = [UIImage imageWithCGImage:newImage scale:1.0f orientation:UIImageOrientationDownMirrored];

    CGImageRelease(newImage);

    CVPixelBufferUnlockBaseAddress(imageBuffer,0);
}

- (void)setupTimer
{
    NSTimer* cameraTimer = [NSTimer scheduledTimerWithTimeInterval:2.0f target:self selector:@selector(snapshot) userInfo:nil repeats:YES];
}

- (void)snapshot
{
    NSLog(@"SNAPSHOT");
    self.cameraImageView.image = self.cameraImage;  // Comment-out to hide snapshot
}

@end 
```

将它连接到带有 UIImageView 的 UIViewController 用于快照，它会起作用！快照以 2.0 秒的间隔以编程方式拍摄，无需任何用户输入。注释掉选定的行以删除预览层和快照反馈。

如有更多问题/意见，请告诉我！

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2017-12-09T19:52:39.690

将上述代码转换为 Swift 4

```
import UIKit
import AVFoundation

class CameraViewController: UIViewController, AVCaptureVideoDataOutputSampleBufferDelegate {

@IBOutlet weak var cameraImageView: UIImageView!

var device: AVCaptureDevice?
var captureSession: AVCaptureSession?
var previewLayer: AVCaptureVideoPreviewLayer?
var cameraImage: UIImage?

override func viewDidLoad() {
    super.viewDidLoad()

    setupCamera()
    setupTimer()
}

func setupCamera() {
    let discoverySession = AVCaptureDevice.DiscoverySession(deviceTypes: [.builtInWideAngleCamera],
                                                            mediaType: AVMediaType.video,
                                                           position: .front)
    device = discoverySession.devices[0]

    let input: AVCaptureDeviceInput
    do {
        input = try AVCaptureDeviceInput(device: device!)
    } catch {
        return
    }

    let output = AVCaptureVideoDataOutput()
    output.alwaysDiscardsLateVideoFrames = true

    let queue = DispatchQueue(label: "cameraQueue")
    output.setSampleBufferDelegate(self, queue: queue)
    output.videoSettings = [kCVPixelBufferPixelFormatTypeKey as AnyHashable as! String: kCVPixelFormatType_32BGRA]

    captureSession = AVCaptureSession()
    captureSession?.addInput(input)
    captureSession?.addOutput(output)
    captureSession?.sessionPreset = AVCaptureSession.Preset.photo

    previewLayer = AVCaptureVideoPreviewLayer(session: captureSession!)
    previewLayer?.videoGravity = AVLayerVideoGravity.resizeAspectFill
    previewLayer?.frame = CGRect(x: 0.0, y: 0.0, width: view.frame.width, height: view.frame.height)

    view.layer.insertSublayer(previewLayer!, at: 0)

        captureSession?.startRunning()
    }

    func captureOutput(_ output: AVCaptureOutput, didOutput sampleBuffer: CMSampleBuffer, from connection: AVCaptureConnection) {
        let imageBuffer = CMSampleBufferGetImageBuffer(sampleBuffer)
    CVPixelBufferLockBaseAddress(imageBuffer!, CVPixelBufferLockFlags(rawValue: 0))
        let baseAddress = UnsafeMutableRawPointer(CVPixelBufferGetBaseAddress(imageBuffer!))
        let bytesPerRow = CVPixelBufferGetBytesPerRow(imageBuffer!)
        let width = CVPixelBufferGetWidth(imageBuffer!)
        let height = CVPixelBufferGetHeight(imageBuffer!)

        let colorSpace = CGColorSpaceCreateDeviceRGB()
        let newContext = CGContext(data: baseAddress, width: width, height: height, bitsPerComponent: 8, bytesPerRow: bytesPerRow, space: colorSpace, bitmapInfo:
        CGBitmapInfo.byteOrder32Little.rawValue | CGImageAlphaInfo.premultipliedFirst.rawValue)

        let newImage = newContext!.makeImage()
         cameraImage = UIImage(cgImage: newImage!)

        CVPixelBufferUnlockBaseAddress(imageBuffer!, CVPixelBufferLockFlags(rawValue: 0))
    }

    func setupTimer() {
        _ = Timer.scheduledTimer(timeInterval: 2.0, target: self, selector: #selector(snapshot), userInfo: nil, repeats: true)
    }

    @objc func snapshot() {
        print("SNAPSHOT")
        cameraImageView.image = cameraImage
    }
} 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-06-02T12:03:53.140

您可能需要用于`AVFoundation`捕获视频流/图像而不显示它。与 不同`UIImagePickerController`，它不能“开箱即用”。以 Apple`AVCam`为例来帮助您入门。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2017-08-11T11:11:05.927

如果有人在 2017 年仍在寻找解决方案，我将上面的代码从 Objc 转换为 Swift 3。

```
import UIKit
import AVFoundation

class CameraViewController: UIViewController, AVCaptureVideoDataOutputSampleBufferDelegate {

@IBOutlet weak var cameraImageView: UIImageView!

var device: AVCaptureDevice?
var captureSession: AVCaptureSession?
var previewLayer: AVCaptureVideoPreviewLayer?
var cameraImage: UIImage?

override func viewDidLoad() {
    super.viewDidLoad()

    setupCamera()
    setupTimer()
}

func setupCamera() {
    let discoverySession = AVCaptureDeviceDiscoverySession(deviceTypes: [.builtInWideAngleCamera],
                                                           mediaType: AVMediaTypeVideo,
                                                           position: .front)
    device = discoverySession?.devices[0]

    let input: AVCaptureDeviceInput
    do {
        input = try AVCaptureDeviceInput(device: device)
    } catch {
        return
    }

    let output = AVCaptureVideoDataOutput()
    output.alwaysDiscardsLateVideoFrames = true

    let queue = DispatchQueue(label: "cameraQueue")
    output.setSampleBufferDelegate(self, queue: queue)
    output.videoSettings = [kCVPixelBufferPixelFormatTypeKey as AnyHashable: kCVPixelFormatType_32BGRA]

    captureSession = AVCaptureSession()
    captureSession?.addInput(input)
    captureSession?.addOutput(output)
    captureSession?.sessionPreset = AVCaptureSessionPresetPhoto

    previewLayer = AVCaptureVideoPreviewLayer(session: captureSession)
    previewLayer?.videoGravity = AVLayerVideoGravityResizeAspectFill

    previewLayer?.frame = CGRect(x: 0.0, y: 0.0, width: view.frame.width, height: view.frame.height)

    view.layer.insertSublayer(previewLayer!, at: 0)

    captureSession?.startRunning()
}

func captureOutput(_ captureOutput: AVCaptureOutput!, didOutputSampleBuffer sampleBuffer: CMSampleBuffer!, from connection: AVCaptureConnection!) {
    let imageBuffer = CMSampleBufferGetImageBuffer(sampleBuffer)
    CVPixelBufferLockBaseAddress(imageBuffer!, CVPixelBufferLockFlags(rawValue: .allZeros))
    let baseAddress = UnsafeMutableRawPointer(CVPixelBufferGetBaseAddress(imageBuffer!))
    let bytesPerRow = CVPixelBufferGetBytesPerRow(imageBuffer!)
    let width = CVPixelBufferGetWidth(imageBuffer!)
    let height = CVPixelBufferGetHeight(imageBuffer!)

    let colorSpace = CGColorSpaceCreateDeviceRGB()
    let newContext = CGContext(data: baseAddress, width: width, height: height, bitsPerComponent: 8, bytesPerRow: bytesPerRow, space: colorSpace, bitmapInfo:
        CGBitmapInfo.byteOrder32Little.rawValue | CGImageAlphaInfo.premultipliedFirst.rawValue)

    let newImage = newContext!.makeImage()
    cameraImage = UIImage(cgImage: newImage!)

    CVPixelBufferUnlockBaseAddress(imageBuffer!, CVPixelBufferLockFlags(rawValue: .allZeros))
}

func setupTimer() {
    _ = Timer.scheduledTimer(timeInterval: 2.0, target: self, selector: #selector(snapshot), userInfo: nil, repeats: true)
}

func snapshot() {
    print("SNAPSHOT")
    cameraImageView.image = cameraImage
}
} 
```

另外，我找到了一个从 CMSampleBuffer 获取图像的更短的解决方案：

```
func captureOutput(_ captureOutput: AVCaptureOutput!, didOutputSampleBuffer sampleBuffer: CMSampleBuffer!, from connection: AVCaptureConnection!) {
    let myPixelBuffer = CMSampleBufferGetImageBuffer(sampleBuffer)
    let myCIimage = CIImage(cvPixelBuffer: myPixelBuffer!)
    let videoImage = UIImage(ciImage: myCIimage)
    cameraImage = videoImage
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2014-10-08T17:11:20.400

UIImagePickerController 类的文档中有一个名为 takePicture 的方法。它说：

将此方法与自定义叠加视图结合使用，以启动静止图像的编程捕获。这支持在不离开界面的情况下拍摄多张照片，但需要您隐藏默认的图像选择器控件。

# c# - 使用 XML 序列化时保护敏感值（密码）？

> ID：10199029
> 
> 赞同：2
> 
> 时间：2012-04-17T20:56:52.990
> 
> 标签：c#, .net, security, xml-serialization

我们有一个保存用户登录配置文件的类，它是一个简单的类，我们只需将其序列化到磁盘。我们当然可以对序列化过程进行加密、压缩等，但是，出于其他原因，我想保持简单。

序列化的一项是密码（字符串）属性。我不介意它正在被序列化，但我希望被序列化的值是 3DES 加密的，所以如果有人在某个阅读器中打开文件，它不会泄露密码。我知道我可以简单地将密码值设置为加密值并获取加密值，但我想稍微自动化一下，以便在调用 GET'er 时它处理解密，SET'er 处理加密所以它是无缝的。

您认为解决此问题的最佳方法是什么？我在想的是我需要标记“密码”属性以被序列化程序忽略，它只是指向另一个保存加密值的属性的路径，因此将其返回解密。这是处理此问题的最佳/唯一方法吗？只是想看看是否有更简单的方法，然后再通过我能看到的唯一方法进行编码，以将加密/解密保持在序列化类逻辑中。

谢谢。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-04-17T21:02:21.630

您可以将密码属性标记为被序列化忽略，并使用某种包装属性进行序列化：

```
public class LogonInfo
{
    [XmlIgnore]
    public string Password { get; set; }

    public string EncPassword {
    {
        get
        {
            return Encrypt(Password);
        }
        set
        {
            Password = Decrypt(value);
        }
    }

    // TODO: add Encrypt and Decrypt methods
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2016-11-15T12:58:01.883

您可以使用[ExtendedXmlSerializer](https://github.com/wojtpl2/ExtendedXmlSerializer)。如果您的类具有需要加密的属性：

```
public class Person
{
    public string Name { get; set; }
    public string Password { get; set; }
} 
```

您必须实现接口 IPropertyEncryption。例如，它将显示 Base64 编码，但在现实世界中最好使用更安全的东西，例如。RSA.:

```
public class Base64PropertyEncryption : IPropertyEncryption
{
    public string Encrypt(string value)
    {
        return Convert.ToBase64String(Encoding.UTF8.GetBytes(value));
    }

    public string Decrypt(string value)
    {
        return Encoding.UTF8.GetString(Convert.FromBase64String(value));
    }
} 
```

在 Person 类配置中，您需要指定要加密的属性：

```
public class PersonConfig : ExtendedXmlSerializerConfig<Person>
{
    public PersonConfig()
    {
        Encrypt(p => p.Password);
    }
} 
```

然后，您必须注册您的 PersonConfig 类和您的 IPropertyEncryption 实现。在文档中描述了使用 Autofac 的配置。有简单的配置：

```
var toolsFactory = new SimpleSerializationToolsFactory();

// Register your config class
toolsFactory.Configurations.Add(new PersonConfig());

// If you want to use property encryption you must register your implementation of IPropertyEncryption, e.g.:
toolsFactory.EncryptionAlgorithm = new Base64PropertyEncryption(); 

ExtendedXmlSerializer serializer = new ExtendedXmlSerializer(toolsFactory); 
```

然后你可以序列化对象：

```
var obj = new Person {Name = "John", Password = "Ab238ds2"};
var xml = serializer.Serialize(obj); 
```

您的 xml 将如下所示：

```
<?xml version="1.0" encoding="utf-8"?>
<Person type="ExtendedXmlSerialization.Samples.Encrypt.Person">
    <Name>John</Name>
    <Password>QWIyMzhkczI=</Password>
</Person> 
```

ExtendedXmlSerializer 还有许多其他有用的特性：

*   从标准 XMLSerializer 反序列化 xml
*   具有属性接口的序列化类
*   序列化循环引用和引用Id
*   旧版本xml的反序列化
*   财产加密
*   自定义序列化程序

ExtendedXmlSerializer 支持 .net 4.5 和 .net Core。您可以将它与 WebApi 和 AspCore 集成。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-17T21:02:46.513

我会使用您喜欢的任何方法（例如 MD5）存储密码的散列值。在任何时候，内存或磁盘上都不会存储实际密码。然后进行身份验证，获取输入的明文密码，再次对其进行哈希处理，并根据存储的哈希值进行检查。这样，身份验证仍然有效，但除了初始输入之外，没有其他可用的密码明文。在初始输入期间，密码很容易受到攻击，因为它必须在接收数据和对其进行散列以进行比较之间的内存中。由于这段时间很短，攻击不太可能，但有可能。

在程序的这个阶段，[SecureString](http://msdn.microsoft.com/en-us/library/system.security.securestring.aspx)将是在散列之前存储密码的不错选择。这在散列之前提供密码的自动加密，并允许您指定何时从内存中删除对象。

如果第 3 方获得散列，则对他们来说是无用的，因为使用正确的 alogorithim 是不可逆的。如果他们尝试使用哈希登录，您的程序也会再次对其进行哈希处理，但检查失败。为了更加偏执，您也可以随时加密整个文件！

我假设这是在本地发生的，或者网络连接是加密的（例如，https）。根据上面的评论，永远不要通过网络发送明文密码。

# sql-server - 当前记录和下一条记录之间的列的总和

> ID：10199030
> 
> 赞同：1
> 
> 时间：2012-04-17T20:56:57.043
> 
> 标签：sql-server

有点难以解释，我的 SQL Server 不是最好的，但在这里什么都可以。

首先，创建一些表：

```
CREATE TABLE [dbo].[Quarterly](
[QuarterDate] [datetime] NOT NULL,
[SomeText] [nvarchar](50) NULL,
CONSTRAINT [PK_Quarterly] PRIMARY KEY CLUSTERED 
(
[QuarterDate] ASC
)
GO

CREATE TABLE [dbo].[TmpDegreeDays](
[Date] [datetime] NOT NULL,
[Value] [nvarchar](50) NOT NULL,
CONSTRAINT [PK_TmpDegreeDays] PRIMARY KEY CLUSTERED 
(
[Date] ASC
)
GO 
```

然后插入一些数据：

```
INSERT [dbo].[Quarterly] ([QuarterDate], [SomeText]) VALUES (CAST(0x00009CF100000000 AS DateTime), N'Blah')
INSERT [dbo].[Quarterly] ([QuarterDate], [SomeText]) VALUES (CAST(0x00009D4B00000000 AS DateTime), N'Fools')
INSERT [dbo].[Quarterly] ([QuarterDate], [SomeText]) VALUES (CAST(0x00009DA600000000 AS DateTime), N'Later')
INSERT [dbo].[Quarterly] ([QuarterDate], [SomeText]) VALUES (CAST(0x00009E0400000000 AS DateTime), N'Something')
INSERT [dbo].[Quarterly] ([QuarterDate], [SomeText]) VALUES (CAST(0x00009E5E00000000 AS DateTime), N'New year')
INSERT [dbo].[Quarterly] ([QuarterDate], [SomeText]) VALUES (CAST(0x00009EC300000000 AS DateTime), N'In april') 
```

然后将日期范围从`2010-01-01`到（包括）`2012-03-10`插入到表中`TmpDegreeDays`

最后：

我想为结果集中当前记录和下一条记录之间的表中`TmpDegreeDays`的每条记录计算 [Value] 的总和。`Quarterly``QuarterDate``Quarterly`

就像是：

```
DECLARE @startDate datetime, @endDate datetime
SET @startDate = '2010-01-01'
SET @endDate = '2010-12-31'

SELECT q.QuarterDate, q.SomeText, CustomSum = 
(SELECT SUM(CAST([Value] AS float))
FROM TmpDegreeDays 
WHERE [date] >= q.QuarterDate AND *Current QuarterDate* < *Some query here to get next row QuarterDate*)

FROM Quarterly q

WHERE q.QuarterDate BETWEEN @startDate AND @endDate 
```

我正在寻找的最终输出示例：

```
2010-01-01   Sum of [Value] between 2010-01-01 and 2010-03-31
2010-04-01   Sum of [Value] between 2010-04-01 and 2010-06-30
2010-07-01   Sum of [Value] between 2010-07-01 and 2010-09-31
2010-10-03   Sum of [Value] between 2010-10-03 and 2010-10-03 
```

这有意义吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-17T21:16:24.803

您可以尝试这样的事情 - 使用 CTE（在 SQL Server **2005**和更高版本中可用）来查找每个季度的日期，然后总结学位值：

```
;WITH QuarterlyDates AS
(        
   SELECT 
       QuarterDate, 
       QuarterEndDate = DATEADD(MILLISECOND, -3, DATEADD(MONTH, 3, QuarterDate))
   FROM [dbo].[Quarterly]
)
SELECT
    qd.QuarterDate, qd.QuarterEndDate,
    DegreeSum = (SELECT SUM(DegreeValue) 
                 FROM [dbo].[TmpDegreeDays] 
                 WHERE [Date] BETWEEN qd.QuarterDate AND qd.QuarterEndDate)
FROM
    QuarterlyDates qd 
```

The strange function to determine the `QuarterEndDate` is rooted in the fact that the `DATETIME` has a precision of 3.33ms in SQL Server. Thus, the last date for a given month is the last day of that month, and the time is `23:59:59.997` (not .999). Therefore, I need to add three months to the quarter's start date, and then subtract 3 milliseconds from that start date of the next quarter to get the last millisecond of this quarter in question.

**Update:** OK, in order to get the start and end date for a quarter from the table, you need two nested CTE's in order to determine the "end date of the next quarter minus 3 milliseconds" for the end of the quarter - something like this:

```
;WITH QuarterStarts AS
(
    SELECT  
        QuarterDate,
        QNumber = ROW_NUMBER() OVER(ORDER BY QuarterDate)   -- ordering number
    FROM [dbo].[Quarterly]
),
Quarters AS
(
    SELECT
        QuarterStartDate = q1.QuarterDate,
        QuarterEndDate = DATEADD(MILLISECOND, -3, q2.QuarterDate) 
    FROM
        QuarterStarts q1
    INNER JOIN 
        QuarterStarts q2 ON q2.QNumber = q1.QNumber + 1 
)
SELECT
    q.QuarterDate, q.QuarterEndDate,
    DegreeSum = (SELECT SUM(DegreeValue) 
                 FROM [dbo].[TmpDegreeDays] 
                 WHERE [Date] BETWEEN q.QuarterDate AND q.QuarterEndDate)
FROM
    Quarters q 
```

# objective-c - NSPredicate：“无法解析格式字符串 '%@'”？

> ID：10199032
> 
> 赞同：3
> 
> 时间：2012-04-17T20:57:10.317
> 
> 标签：objective-c, ios, core-data, nspredicate, predicate

我正在尝试构建查询字符串或谓词，但我不断收到此错误，

基本上我无法理解的是这很好用：

```
NSPredicate *pred = [NSPredicate predicateWithFormat:@"(name contains[cd] 'o')"]; 
```

但是这个：

```
NSString *predString =  @"(name contains[cd] 'o')";
NSPredicate *pred = [NSPredicate predicateWithFormat:@"%@", predString]; 
```

抛出这个：

> `*** Terminating app due to uncaught exception 'NSInvalidArgumentException', reason: 'Unable to parse the format string "%@"'`

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-04-17T20:58:46.273

`%@`不是谓词格式，而是字符串格式。

```
NSPredicate *pred = [NSPredicate predicateWithFormat:predString]; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-12-19T20:14:54.700

正如所指出的， %@ 不能在谓词构造中随处使用。但是能够提前构造谓词会很有用。您可以使用 #define 来定义它的全部或至少是常量部分：

```
 #define kPredicateStr_MovieItem_MoviesInCatalog @"((wishList == NO) AND ((tvEpisode == NO) || (tvEpisode == YES AND (ANY tvSeries.genres.name LIKE 'TV Movie'))))" 
```

然后按原样提供：

```
 itemsViewController.predicate = [NSPredicate predicateWithFormat:kPredicateStr_MovieItem_MoviesInCatalog]; 
```

或添加到它：

```
 NSString *predStr = [NSString stringWithFormat:@"%@ AND (%@ CONTAINS \"%@\")", kPredicateStr_MovieItem_MoviesInCatalog, titleForSearch, searchString];

    predicate = [NSPredicate predicateWithFormat:predStr]; 
```

# r - R：在 x 和 y 中有误差的加权最小二乘

> ID：10199034
> 
> 赞同：2
> 
> 时间：2012-04-17T20:57:32.460
> 
> 标签：r

有谁知道现有的 R 函数/包，用于对 X 和 Y 都有错误的直线进行加权最小二乘拟合（ala York，1969）？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-17T21:03:52.750

这大概就是所谓的“正交回归”、“戴明回归”等名称。这是一个带有版本的软件包。

[http://finzi.psych.upenn.edu/R/library/MethComp/html/Deming.html](http://finzi.psych.upenn.edu/R/library/MethComp/html/Deming.html)

其他指向 r-help 条目的链接：

[http://tolstoy.newcastle.edu.au/R/e9/help/10/02/4669.html](http://tolstoy.newcastle.edu.au/R/e9/help/10/02/4669.html)

# java - 正则表达式“或”返回一组Java

> ID：10199036
> 
> 赞同：0
> 
> 时间：2012-04-17T20:57:35.930
> 
> 标签：java, regex

你如何只返回一个被发现匹配的组？

我有这个正则表达式：

```
".*>(\\d+.*)\\s.*\\(.*</|>(\\d+.+)<" 
```

当我运行时：

```
 Pattern p = Pattern.compile(regex);
   Matcher m = p.matcher(comparisonString);

   if(m.find() == true){
           System.out.println(m.group(1));
   } 
```

每当匹配表达式的第二部分（'OR' 运算符之后的表达式）时，都会返回 null。每当匹配辅助表达式（“OR”之后的表达式）时，如何返回匹配组？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-17T21:06:50.947

您需要使用捕获组：

```
Pattern pattern = Pattern.compile("(regexToMatch1)|(regexToMatch2)");
...
read in stuff here
...
Matcher matcher = pattern.matcher(yourString);
if (matcher.matches()) {
    String firstString  = matcher.group(1);
    String secondString = matcher.group(2);
} 
```

然后扔掉你不想要的任何组。

这里有很好的例子：http: [//javamex.com/tutorials/regular_expressions/capturing_groups.shtml](http://javamex.com/tutorials/regular_expressions/capturing_groups.shtml)

编辑：等等，我想我不明白你在问什么。您的组匹配，但组为空？您只需要在 matcher.group(#); 中引用第二组即可 称呼。

# glsl - 使用 WebGL 着色器处理数组数据

> ID：10199040
> 
> 赞同：0
> 
> 时间：2012-04-17T20:57:43.190
> 
> 标签：glsl, shader, webgl

现在，我正在做大量 CPU 密集型计算，以在我非常复杂的数据结构中找到某些顶点集。一旦我“找到”了这些，我就会继续使用 WebGL 渲染它们……我想在这里使用 GPU 作为“并行化”的一种手段。

我想知道是否有直接在着色器上处理这些数据并使用其结果来渲染内容的好方法。我需要它将大量数组输入到着色器（制服！？），并且可能使着色器处理的每个顶点的计算结果保持不变。

也许将我的所有数据表示为纹理以将其输入到着色器中是个好主意。可以对纹理进行“查找”吗？

我希望您能理解我的问题，并期待您对此的看法！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-18T12:08:15.560

您可以将纹理视为数据数组，并让着色器从该纹理中读取，处理信息并将结果写入另一个纹理（挂钩到帧缓冲区）。如果您想在下一帧中使用结果，您只需交换纹理即可。

这是一个非常长且复杂的示例，它显示了如何完全使用着色器计算粒子：

[http://i-am-glow.com/?page_id=183](http://i-am-glow.com/?page_id=183)

您还可以在此处阅读记录良好的代码：

[http://empaempa.github.com/GLOW/examples/complicated/Complicated.js](http://empaempa.github.com/GLOW/examples/complicated/Complicated.js)

希望有帮助！

# c++ - 运行时 C++ 链接器缺少库（SONAME 行为）

> ID：10199045
> 
> 赞同：7
> 
> 时间：2012-04-17T20:58:00.507
> 
> 标签：c++, linker, g++, shared

我制作了一个使用两个共享库（我编译的）的程序，并且放置如下：

```
/home_directory_where_I_compile_and_run_everything
-->/lib/libjson_linux-gcc-4.4.6_libmt.so
-->/lib/libre2.so.0 
```

当我编译我的程序时，我将这些库的相对位置传递给链接器，如下所示：

```
g++ ...... stuff ........ my_program.cc lib/libjson_linux-gcc-4.4.6_libmt.so lib/libre2.so.0 
```

它编译得很好，但是在运行程序时找不到 libre2.so，如果我用 ldd 检查它，会发生以下情况：

```
....
lib/libjson_linux-gcc-4.4.6_libmt.so (0x00007f62906bc000)
libre2.so.0 => not found
.... 
```

显然，它确实承认 libjson 上的路径是相对的，但它不会在 libre2.so.0 上这样做（它会修剪所有路径并只留下 libre2.so.0）

有人能告诉我为什么会这样吗？

另外，有没有办法通过 g++ 参数来修改它？

最好的。

*** 更新 ***哇，看看这个！我已将 libre2.so.0 的名称更改为 stuff.so，然后尝试编译基本相同，如下所示：

```
g++ ...... stuff ........ my_program.cc lib/libjson_linux-gcc-4.4.6_libmt.so lib/stuff.so 
```

无论如何它都失败了；它不仅失败了，而且失败了，因为它找不到“libre2.so.0”。

为什么？

***更新＃2 ***

输出为`readelf -d the_program.o`

```
0x0000000000000001 (NEEDED)             Shared library: [lib/libjson_linux-gcc-4.4.6_libmt.so]
0x0000000000000001 (NEEDED)             Shared library: [libre2.so.0] 
```

现在，如果我可以将 [libre2.so.0] 改为 [lib/libre2.so.0] 就好了。

***更新＃3 ***

正如@troubadour 发现的那样：

> 当可执行文件与具有 DT_SONAME 字段的共享对象链接时，当可执行文件运行时，动态链接器将尝试加载由 DT_SONAME 字段指定的共享对象，而不是使用链接器提供的文件名。

这就是为什么它适用于 libjson .....so 而不是 libre2.so.0。（libjson .....so 没有 SONAME 条目）。

我终于找到了我正在寻找的确切问题：

**有没有办法告诉 gcc 链接器忽略共享库文件上的 SONAME 条目并链接到特定的文件路径？**

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-04-17T22:15:42.833

我将首先回答您问题的第二部分，即为什么重命名 libre2.so.0 没有达到您的预期。

`-soname`当您运行可执行文件时，传递给链接器的文件名无关紧要（除非您在构建库时未能提供- 请参阅下面的第二个编辑）。依赖关系取自所谓的“soname”。如果您`readelf`在库上运行该命令，您可以确定它的 soname，例如。

```
readelf -d libre2.so.0 | grep SONAME 
```

重命名文件没关系。上述命令的结果仍然会为您提供相同的 soname，因此程序仍然无法找到“libre2.so.0”的原因。

至于您问题的原始部分，这一切都取决于库是否具有`RPATH`或`RUNPATH`内置于它们和/或您的`LD_LIBRARY_PATH`环境变量的内容是什么。这些是运行时链接器 (ld.so) 将用来查找共享库的东西。尝试

```
man ld.so 
```

了解更多信息。

由于您自己构建了库，因此您将知道它们是否在最终链接阶段使用了`-rpath`or`-runpath`选项。或者，`readelf`再次使用例如。

```
readelf -d libre2.so.0 | grep RPATH
readelf -d libre2.so.0 | grep RUNPATH 
```

我怀疑上述两个命令不会返回任何内容。

我的猜测是你的当前目录`LD_LIBRARY_PATH`允许运行时链接器找到 lib/libjson_linux-gcc-4.4.6_libmt.so 但不是 libre2.so.0。我注意到您已回复我对您的问题的评论说您`LD_LIBRARY_PATH`是空的。这很奇怪。

也许您在 libjson 的 soname 上以某种方式获得了前缀“lib/”？即`readelf`SONAME 的命令是否返回

```
lib/libjson_linux-gcc-4.4.6_libmt.so 
```

而不仅仅是

```
libjson_linux-gcc-4.4.6_libmt.so 
```

另外，通过运行检查程序在 soname 方面需要什么

```
readelf -d my_progam | grep NEEDED 
```

由于您将它传递给 gcc 的方式，可能存在“lib/”前缀。如果是这样，那么如果您使用@enobayram 给出的gcc 命令，那么它将公平竞争，即它也将无法找到libjson。

首先要确定的不是它为什么*没有*找到 libre2.so.0，而是它如何*设法*找到 libjson。如果您尝试从不同的目录运行您的可执行文件，它仍然可以工作还是现在对于 libjson 也会失败？或者，如果您将 libre2.so.0 复制到可执行文件旁边，这会改变什么吗？

**编辑**

Fedora 论坛上的一篇[帖子](http://forums.fedoraforum.org/showthread.php?t=262936)表明 Fedora 版本的 ld.so 将当前目录作为内置搜索路径。虽然我无法验证这一点，但它可以解释为什么你要选择任何库，因为你的案例中没有 ld.so 使用的所有其他东西。

**编辑 2**

从我系统上的 ld 手册页

> -soname=名称
> 
> 创建 ELF 共享对象时，将内部 DT_SONAME 字段设置为指定名称。当可执行文件与具有 DT_SONAME 字段的共享对象链接时，当可执行文件运行时，动态链接器将尝试加载由 DT_SONAME 字段指定的共享对象，而不是使用链接器提供的文件名。
> 
> 版权所有 (c) 1991, 1992, 1993, 1994, 1995, 1996, 1997, 1998, 1999, 2000, 2001, 2002, 2003, 2004, 2005, 2006, 2007, 2008, 2009 Free Software Foundation, Inc.
> 
> 根据 GNU 自由文档许可证 1.3 版或自由软件基金会发布的任何更高版本的条款，允许复制、分发和/或修改本文档；没有不变的部分，没有封面文本，也没有封底文本。许可证的副本包含在标题为“GNU 自由文档许可证”的部分中。

因此，您评论中的理论是正确的。如果`-soname`在构建库时明确指定 no，则共享对象中不存在 SONAME，并且可执行文件中的 NEEDED 字段仅具有提供给链接器的文件名，在您的情况下，该文件名包含前导“lib/”。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-17T21:34:23.603

当您链接到共享库 (.so) 时，当您*执行*程序时，它们必须存在于您的库加载路径中。您在链接时提供的位置不会在可执行文件中“记住”。

替代解决方案：

*   将 .so 文件放在与可执行文件相同的目录中
*   运行`LD_LIBRARY_PATH=lib ./program`
*   将 .so 文件安装到库路径中的某个位置，例如`/usr/local/lib`，在运行程序之前。
*   静态链接

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2015-04-21T06:43:21.483

您需要在两种情况下告诉共享库在哪里。

**一是在连接时**。
有几种方法：

*   将库复制到某个标准目录，例如`/usr/local/lib`，然后通过`ldconfig`. 这样，不需要其他选项/操作。
*   用于`-L`告诉 gcc 在哪里可以找到 lib

**一是在运行时**。
还有几种方法：

*   像链接时间一样，通过 安装它`ldconfig`，然后不需要其他操作。
*   使用`LD_LIBRARY_PATH`.

    > LD_LIBRARY_PATH=.:$LD_LIBRARY_PATH ./a.out

*   用于`rpath`将搜索路径写入可执行文件

    > g++ main.cpp -lxxx -L/a/b/c -Wl,-rpath,/a/b/c

仅在链接阶段指定共享库位置，例如 via `-L`，并不意味着当您运行程序时，系统的加载器会找到所需的库。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-17T21:34:44.293

正确的编译器命令行应该是：

```
g++ ...... stuff ........ my_program.cc -Llib -ljson_linux-gcc-4.4.6_libmt -lre2 
```

并且您应该将共享对象放在标准目录（如 /usr/lib）中，或者您应该将它们的路径添加`LD_LIBRARY_PATH`到能够运行您的可执行文件的路径中。

# java - 如何从 gui 启动控制台程序？

> ID：10199049
> 
> 赞同：1
> 
> 时间：2012-04-17T20:58:13.627
> 
> 标签：java, user-interface, console

这适用于在 BlueJ 中创建并作为包含 BlueJ 包的 zip 文件提交的作业。

包中有几个独立的控制台程序。我正在尝试创建另一个“控制面板”程序 - 一个带有单选按钮的 gui 来启动每个程序。

这是我尝试过的两个监听器类：

```
private class RadioButtonListener implements ActionListener
{
    public void actionPerformed(ActionEvent e)
    {
        if(e.getSource() == arraySearchButton)
        {
            new ArraySearch();
        }//end if
            else if(e.getSource() == workerDemoButton)
            {
                new WorkerDemo();
            }//end else if
    }//end actionPerformed
}//end class RadioButtonListener

private class RunButtonListener implements ActionListener
{
    public void actionPerformed(ActionEvent e)
    {
        if(arraySearchButton.isSelected())
        {
            new ArraySearch();
        }//end if
            else if(workerDemoButton.isSelected())
            {
                new WorkerDemo();
            }//end else if
    }//end actionPerformed
}//end class RunButtonListener 
```

提前致谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-17T21:15:48.383

假设您正在尝试启动 .EXE 控制台应用程序，这里有一些可以帮助您的代码。请参阅下面的说明。

```
import java.io.*;

public class Main {

       public static void main(String args[]) {

            try {
                Runtime rt = Runtime.getRuntime();
                //Process pr = rt.exec("cmd /c dir");
                Process pr = rt.exec("c:\\helloworld.exe");

                BufferedReader input = new BufferedReader(new InputStreamReader(pr.getInputStream()));

                String line=null;

                while((line=input.readLine()) != null) {
                    System.out.println(line);
                }

                int exitVal = pr.waitFor();
                System.out.println("Exited with error code "+exitVal);

            } catch(Exception e) {
                System.out.println(e.toString());
                e.printStackTrace();
            }
        }
} 
```

首先，您需要处理当前正在运行的 java 应用程序，并为此创建一个运行时对象并使用 Runtime.getRuntime()。然后，您可以声明一个新进程并使用 exec 调用来执行正确的应用程序。

bufferReader 将帮助打印生成的进程的输出并在 java 控制台中打印。

最后，pr.waitFor() 将强制当前线程等待进程 pr 终止，然后再继续执行。exitVal 包含错误代码（如果有）（0 表示没有错误）。

希望这可以帮助。

# css - 指定上/下/左/右时CSS位置不起作用

> ID：10199051
> 
> 赞同：2
> 
> 时间：2012-04-17T20:58:16.893
> 
> 标签：css, position, css-position

为顶部/底部/左侧/右侧指定大于或小于零的值无效。

创建了一个指定`position: absolute`. 我也可以声明位置，但只能使用零值，即`top: 0`或`right: 0`. 但是，当我指定`right:50`.

我不知道为什么。我已经从文档中删除了几乎所有内容。

这是CSS：

```
#index-content  {
                position:absolute;
                top:349;
                right:0;
                background-color: fuchsia;
                } 
```

这是HTML：

```
<body>
<div id="index-content">The Title</div>
</body> 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-04-17T21:03:37.093

当您在 css 中设置数值时，您应该使用`px`或其他单位，如`%`,等。`em``pt`

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-04-17T21:00:02.623

在您的值中使用像素 (px)。顶部应该是顶部：349px；

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-17T21:02:09.907

只有当你写0时，你才不需要使用单位。对于 0 以外的数字，您需要定义单位类型（即像素、em、pt、百分比等）

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-05-08T17:56:23.523

You will need to set the body's position as relative or absolute (non-static).

# c++ - 重载模板函数帮助 - C++

> ID：10199054
> 
> 赞同：1
> 
> 时间：2012-04-17T20:58:26.577
> 
> 标签：c++, function, templates, overloading

我不断收到错误消息“没有重载函数“printArray”的实例与参数列表匹配。有人请告诉我为什么吗？我正在尝试重载模板函数，以便它显示在指定位置开始和结束的数组元素。

我有我的初始模板和功能：

```
template< typename T >
void printArray( const T *array, int count ) 
```

以及我试图重载的功能。

```
template< typename T >
void printArray(int lowSubscript, int highSubscript) 
```

我的电话：

```
// display elements 1-3 of array a
   cout << "Array a from positions 1 to 3 is:\n";
   elements = printArray(1,3); 
```

我对第一个 printArray 的调用没有显示错误：

```
// display array a using original printArray function
   cout << "\nUsing original printArray function\n";
   printArray( a, ACOUNT ); 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-17T21:04:34.350

您的第二个重载`printArray`是模板，但签名不依赖于模板参数`T`。因此，您必须在调用时指定它，例如`printArray<int>(1,3)`.

但是，不清楚正在打印哪个数组：您是否忘记为数组添加参数，例如`printArray(a,1,3)`？在这种情况下，您可能可以`T`从该参数中推断出来，就像在`printArray(a,count)`版本中一样。

此外，返回类型意味着即使可以推导出模板参数，`void`您也无法编写。`elements=printArray(1,3)`

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-17T21:04:49.163

您的第二个`printArray`不使用 T，因此不应该是模板。

编译器不将其识别为候选的原因是它无法推断出 T。

# mysql - MYSQL 两个表仅基于和仅通过相同的字段值加入并获取结果

> ID：10199055
> 
> 赞同：-1
> 
> 时间：2012-04-17T20:58:31.497
> 
> 标签：mysql, join

细节：

![http://screencast.com/t/fTRzyqso](../Images/3d5b523d5ceda5d11d13dd83ccb7e760.png)

基本上有2个MYSQL表（联系人和事务），需要根据两个条件获取contactid

1.  获取根本没有交易的所有联系人（contactid）
2.  只获取那些有一笔或多笔交易但都处于取消状态的联系人。

帮助！？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-17T23:02:20.297

您实际上可以通过简单的 LEFT 连接来完成此操作...并查找 NULL（未找到）。通过进行左连接，它从左表中获取所有记录，而不管右侧是否匹配。因此，如果我们将连接条件设置为您的事务表，特别是 Canceled = "No"，并且我们找到匹配项，请从结果集中忽略它。如果事务中没有记录，或者它们都设置为 Canceled = "Yes"，则它们被排除在联接条件之外，因此将被视为 "none found"

```
select
      c.ContactID
   from
      Contacts c
         LEFT JOIN Transactions t
            on c.ContactID = t.ContactID
           AND t.Cancelled = "yes"
   where
      t.contactID is null 
```

# bash - 替换bash中的文本

> ID：10199056
> 
> 赞同：0
> 
> 时间：2012-04-17T20:58:41.770
> 
> 标签：bash, command-line, ssh

我有一个要通过 ssh 编辑的配置文件，并且需要一个智能命令（或​​多个命令）来替换其中的一些文本。文件是这样的：

```
[vol1]
path = /folder
allowed = 10.10.10.1
public=yes 
```

我需要修改允许的部分，精确地添加一些 IP 的空格分隔，如下所示：

```
[vol1]
path = /folder
allowed = 10.10.10.1 10.10.10.9
public=yes 
```

尝试使用**sed** bash 功能，但我无法让它按我的意愿工作，就像我认为它是小菜一碟一样。只是另一个信息，配置文件中有很多这样的文本块。IP 地址不是来自 sam 池，派生或类似的（可能非常不同），并且 IP 地址格式已经检查，因此无需这样做。我所拥有的信息是，我必须在以 [vol1] 开头的块中添加给定的地址，恰好在该块的允许部分中。我希望我听起来足够清楚。

有任何想法吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-17T21:27:04.213

```
ssh user@host sed -i '/allowed =/s/$/ 10.10.10.9/' /path/to/file 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-17T21:28:44.830

您也可以使用编辑器：

```
 echo -e "/10.10.10.1\ns/\$/ 10.10.10.9\nx\n" | ex file_to_change 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-04-17T21:07:56.593

这样做`sed`应该可以解决问题：

```
cat /path/to/file.txt | sed 's/10.10.10.1/& &/g' 
```

要匹配任何 IP：

```
cat /path/to/file.txt | sed 's/[0-9]\{1,3\}\.[0-9]\{1,3\}\.[0-9]\{1,3\}\.[0-9]\{1,3\}/& &/g' 
```

如果要更改分隔符，只需编辑`sed`命令的正确操作数，然后输入您想要的任何分隔符。例如使用选项卡：

```
cat /path/to/file.txt | sed 's/[0-9]\{1,3\}\.[0-9]\{1,3\}\.[0-9]\{1,3\}\.[0-9]\{1,3\}/&\t&/g' 
```

# mysql - mysql 错误：无法销毁使用 factoryGirl 创建的对象

> ID：10199067
> 
> 赞同：1
> 
> 时间：2012-04-17T20:59:50.157
> 
> 标签：mysql, rspec, connection, destroy, initialization

我正在使用 mysql db 在 rails 中运行 rspec。在我使用 factoryGirl 创建一个对象后，我想销毁它，以便数据库看起来很干净，以便运行下一个规范。这是我在规范中的设置方式：

```
before (:each) do
  User.destroy_all
  @user = Factory.create :user
end

after (:each) do
 @user.destroy
end 
```

运行 rspec 时出错：

```
Failure/Error: @user.destroy_all
 NameError:
   uninitialized constant User::connection

Failure/Error: @user.destroy
 NameError:
   uninitialized constant User::connection 
```

我确实在用户模型中设置了`:dependent => :destroy`这里有什么问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-28T19:39:15.647

问题是 @user 类变量引用的对象是“未初始化的常量”。IE，FactoryGirl 工作正常，您的变量未正确实例化 @user 对象。当连接不是数据库表字段时，您可能有对连接的引用。

如果是 MySQL 问题，则会出现与 ActiveRecord 相关的错误消息。

如果您想在测试之前/之后清理数据库，请尝试使用此 gem。它工作得很好。 [http://rubygems.org/gems/database_cleaner](http://rubygems.org/gems/database_cleaner)

这是我在[rails 项目中配置 RSpec 的](https://github.com/westonplatter/questionnaire_engine/blob/f96b2ab4edf5837fb7c272f4dcec855811cab97a/spec/spec_helper.rb)方式，

```
RSpec.configure do |config|        
  config.before(:suite) do
    DatabaseCleaner.strategy = :transaction
    DatabaseCleaner.clean_with(:truncation)
  end
  config.before(:each) do
    DatabaseCleaner.start
  end
  config.after(:each) do
    DatabaseCleaner.clean
  end
end 
```

# c++ - 来自 osg::viewer 的 RGB 图像

> ID：10199075
> 
> 赞同：0
> 
> 时间：2012-04-17T21:00:09.603
> 
> 标签：c++, opengl, opencv, openscenegraph

我有这样的代码：

```
osgViewer::Viewer viewer;
viewer.setSceneData(scene);
viewer.setCameraManipulator( tracker.get() );
viewer.setUpViewInWindow(10,10,1024,768,0);
viewer.realize(); 
```

现在，这个查看器对象给了我一个包含车辆模型、地形等的场景视图。我想从这个查看器中获取一个 RGB 图像，而不管数据是如何写入场景的。

本质上，我想要来自查看器的 RGB 图像，而之前没有关于将哪些数据写入场景的信息。如果查看器在 1024*768 窗口中显示某些内容，我希望它是 RGB 图像。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-17T21:29:46.893

如果我理解正确，那么[osg::ScreenCaptureHandler](http://www.openscenegraph.org/documentation/OpenSceneGraphReferenceDocs/a00645.html)应该符合您的要求。它是位于 include/osgViewer 中的 ViewerEventHandlers 标头的一部分。

它是一个简单的事件处理程序，在按键按下时，捕获并存储当前视图的图像。您可以使用它，也可以根据自己的喜好对其进行调整。

# vb.net - 当用户选择无效的文件路径时返回错误消息

> ID：10199076
> 
> 赞同：1
> 
> 时间：2012-04-17T21:00:14.593
> 
> 标签：vb.net

我正在使用 Microsoft Visual Basic 2008 Express Edition。我在表单中添加了一个文件夹对话框浏览器，当用户按下按钮时我调用它。文件夹路径字符串存储在字符串变量中，并在文本框中显示为文本。（也许我应该使用组合框）

我的问题是：如果用户手动输入不存在的路径，我如何返回错误消息，停止文件创建到无效路径，并返回到我的主窗体？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-17T21:02:16.473

使用命名空间中的[`Directory.Exists`](http://msdn.microsoft.com/en-us/library/system.io.directory.exists.aspx)方法`System.IO`：

```
If Directory.Exists(directoryChosenByUser) Then
    ' Proceed
Else
    ' Return
End If 
```

请注意，由于各种情况（例如，在`Directory.Exists`您的文件创建代码之间删除了目录，或者用户没有写入该目录的权限，或者该目录位于网络驱动器上并且网络连接突然失败，.. .)，您的文件创建仍然可能会失败。因此，捕获错误（使用[`Try ... Catch`](http://msdn.microsoft.com/en-us/library/fk6t46tz.aspx)）并向用户提供有意义的错误消息（而不是让您的应用程序“崩溃”）可能仍然有意义。

# android - 位图文本与本机缓存的比较

> ID：10199077
> 
> 赞同：1
> 
> 时间：2012-04-17T21:00:20.920
> 
> 标签：android, actionscript-3, caching, air, bitmap

我很想回答[这个在线程末尾提出的特定问题](http://www.actionscript.org/forums/showthread.php3?t=150918)。 **TS**自己找到了透明位图文本的解决方案，但是，它与设置**cacheAsBitmap**或**cacheAsBitmapMatrix**标志的性能相比如何？

有没有人在这个领域做过一些“研究”？我知道 cacheAsBitmap 和 cacheAsBitmapMatrix 之间的区别，但我想知道位图文本在哪里！

谢谢！（是的，最终目标是优化移动性能：>）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-21T05:21:08.140

位图文本采用[BitmapData.copyPixels()](http://help.adobe.com/en_US/FlashPlatform/reference/actionscript/3/flash/display/BitmapData.html#copyPixels%28%29)函数的位图技术。这总是比渲染矢量文本然后转换为位图要快。

* * *

**[编辑回复：谢谢]**

绝对地。如果您使用 AS3 for mobile 创建内容，您绝对应该查看[Starling 框架](http://gamua.com/starling/)（这里是[文档](http://doc.starling-framework.org/core/)）。该类`starling.text.TextField`使用您自己提供的纹理图集中的位图字体。

您应该阅读 Thibault Imbert 的[Starling 简介：构建 GPU 加速应用程序](http://shop.oreilly.com/product/0636920024217.do)。这是一本简短的免费电子书，可让您快速上手。

# .net - CQRS、事件溯源和 NoSQL 数据库

> ID：10199082
> 
> 赞同：4
> 
> 时间：2012-04-17T21:00:38.380
> 
> 标签：.net, mongodb, cqrs

我们正在开始一个新项目，我们希望在其中使用 MongoDB 实现 CQRS + 事件溯源架构。我们已经对 CQRS 方法有了一些经验：在我们之前的项目中，我们以 Fohjin 框架为起点（嗯，我们对其进行了重大重构）。在这种情况下，我们使用 Oracle 作为存储，并使用 TransactionScope 实现了 2PC。

但是对于我们的新项目，我们希望使用 MongoDB，因为它具有可扩展性和性能。我们肯定想将它用于读取（报告）部分并将其用于事件存储。此处的替代方法是使用 SQL Server 进行事件存储。所以我们需要做出选择。我不喜欢混合解决方案的是 TransactionScope，它既昂贵又缓慢，而且需要支持不同的 Db 类型（Mongo 和 SQL）。

我们研究了 NCQRS，但似乎我们不想高度依赖任何框架，从我们的角度来看，这决定了很多可以以不同方式实现的东西。所以现在我们正在考虑更轻量级的东西，比如 Jonathan Oliver 的 Event Store。我喜欢流和提交的概念，它也支持 MongoDB。我仍然不明白的是，它如何处理所有 2PC 的东西（据说是用于 NoSQL）。在我们的例子中，我们需要将事件分配给几个事件处理程序：某种类型的去噪器，它为特定类型的事件更新读取数据库和任务调度器。如果这些处理程序出现问题并且我们遇到异常，则无法回滚 MongoDB 的提交。有什么技巧可以解决这个问题吗？

我感谢任何关于如何做出正确决定以及利弊的评论。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-18T01:10:03.467

EventStore 使用 Guid 来唯一标识针对数据库的提交，以防止相同的事件流被持久化多次。通常，此 Guid 直接嵌入在消息中，唯一标识该特定消息，并且可以在对事件流调用 CommitChanges 时用作 CommitId。在处理系统查询端的事件时，您可以使用类似的方法。

有关 2PC 和避免分布式事务的更多信息：

*   [http://blog.jonathanoliver.com/2010/04/extending-nservicebus-avoiding-two-phase-commits](http://blog.jonathanoliver.com/2010/04/extending-nservicebus-avoiding-two-phase-commits)
*   [http://blog.jonathanoliver.com/2011/04/how-i-avoid-two-phase-commit](http://blog.jonathanoliver.com/2011/04/how-i-avoid-two-phase-commit)
*   [https://github.com/elliotritchie/NES/wiki/Transactions](https://github.com/elliotritchie/NES/wiki/Transactions)
*   [http://bill-poole.blogspot.com/2008/06/idempotent-messages.html](http://bill-poole.blogspot.com/2008/06/idempotent-messages.html)

# c# - MonoTouch.Dialog - 接受空值作为输入的 DateElement

> ID：10199084
> 
> 赞同：2
> 
> 时间：2012-04-17T21:01:05.687
> 
> 标签：c#, ios, monotouch.dialog

我搜索了互联网无济于事......我正在使用 MT.D 并想为使用 的人设置生日`DateElement`，但生日可能为空，这意味着尚未收集数据。任何人都知道如何让 DateElement 接受空值或日期？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-18T15:16:29.297

**更新**20140106：*由于 iOS7 已经发布，Apple 希望日期/时间选择器与内容内联，而不是作为操作表，或者在这种情况下，全屏覆盖。因此，此代码仅用于操作方法和历史目的。*

好的，所以我推出了自己的课程。就我个人而言，我认为当前的日期/时间选择器设置看起来并不像带有`ActionSheet`附加日期选择器的弹出窗口那样专业。MT.D 比较有经验的人也许能弄明白，但我做的是从那里复制代码`DateTimeElement`并`DateElement`修改它，使其顶部有三个按钮：最左边的按钮是取消，右边的按钮区域有“设置”和“空”按钮。右侧按钮的标题可以在类的ctor中设置为您喜欢的任何内容，但可以默认为“设置日期”和“无日期”。

分享就是关怀！

**可为空的日期时间元素**

```
using MonoTouch.Foundation;
using MonoTouch.UIKit;
using System;
using System.Drawing;

namespace MonoTouch.Dialog
{
    public class NullableDateTimeElement : StringElement
    {
        private class MyViewController : UIViewController
        {
            private NullableDateTimeElement container;
            private bool hasNullValue = false;
            private bool hasBeenSet = false;
            //private EventHandler nullButtonTouched;
            //UIButton isNullButton;
            public bool Autorotate
            {
                get;
                set;
            }
            public MyViewController (NullableDateTimeElement container)
            {
                this.container = container;
            }
            public override void ViewDidLoad ()
            {
                base.ViewDidLoad ();
                //isNullButton = UIButton.FromType (UIButtonType.RoundedRect);
                //isNullButton.SizeToFit ();
                //isNullButton.Frame = new RectangleF(this.View.Frame.Top, this.View.Frame.Left, this.View.Frame.Width - 40f, 40f);
                //isNullButton.SetTitle (container.NullButtonCaption, UIControlState.Normal);
                this.NavigationItem.RightBarButtonItems = new UIBarButtonItem[]
                {
                    new UIBarButtonItem(container.NullButtonCaption, UIBarButtonItemStyle.Done, NullButtonTapped),
                    new UIBarButtonItem(container.SetButtonCaption, UIBarButtonItemStyle.Done, SetButtonTapped)
                };
                this.NavigationItem.LeftBarButtonItem = new UIBarButtonItem(UIBarButtonSystemItem.Cancel, CancelTapped);
                this.NavigationItem.HidesBackButton = true;
                //this.View.AddSubview (isNullButton);
                //this.isNullButton.TouchUpInside += (nullButtonTouched = new EventHandler(nullButtonWasTouched)); 
            }

            void CancelTapped(object sender, EventArgs e)
            {
                hasBeenSet = false;
                this.NavigationController.PopViewControllerAnimated (true);
            }

            void NullButtonTapped(object sender, EventArgs e)
            {
                hasBeenSet = true;
                hasNullValue = true;
                this.NavigationController.PopViewControllerAnimated (true);
            }

            void SetButtonTapped(object sender, EventArgs e)
            {
                hasBeenSet = true;
                hasNullValue = false;
                this.NavigationController.PopViewControllerAnimated (true);
            }

            public override void ViewWillDisappear (bool animated)
            {
                base.ViewWillDisappear (animated);
                if (hasBeenSet)
                {
                    if (!hasNullValue)
                        this.container.DateValue = this.container.datePicker.Date;
                    else
                        this.container.DateValue = null;
                }
                //this.isNullButton.TouchUpInside -= nullButtonTouched;
                //nullButtonTouched = null;
            }
            /*void nullButtonWasTouched(object sender, EventArgs e)
            {
                hasNullValue = true;
                NavigationController.PopViewControllerAnimated (true);
            }*/
            public override void DidRotate (UIInterfaceOrientation fromInterfaceOrientation)
            {
                base.DidRotate (fromInterfaceOrientation);
                this.container.datePicker.Frame = NullableDateTimeElement.PickerFrameWithSize (this.container.datePicker.SizeThatFits (SizeF.Empty));
            }
            public override bool ShouldAutorotateToInterfaceOrientation (UIInterfaceOrientation toInterfaceOrientation)
            {
                return this.Autorotate;
            }
        }
        public DateTime? DateValue;
        public UIDatePicker datePicker;
        //public UIButton isNullButton;
        public string NullButtonCaption { get; set; }
        public string SetButtonCaption { get; set; }

        protected internal NSDateFormatter fmt = new NSDateFormatter
        {
            DateStyle = NSDateFormatterStyle.Short
        };

        public NullableDateTimeElement (string caption, DateTime? date, string nullButtonCaption, string setButtonCaption) : base (caption)
        {
            this.DateValue = date;
            this.Value = this.FormatDate (date);
            this.NullButtonCaption = nullButtonCaption;
            this.SetButtonCaption = setButtonCaption;
        }

        public NullableDateTimeElement(string caption, DateTime? date, string nullButtonCaption) : this(caption, date, nullButtonCaption, "Set Date")
        {}

        public NullableDateTimeElement(string caption, DateTime? date) : this(caption, date, "No Date", "Set Date")
        {}

        public override UITableViewCell GetCell (UITableView tv)
        {
            this.Value = this.FormatDate (this.DateValue);
            UITableViewCell cell = base.GetCell (tv);
            cell.Accessory = UITableViewCellAccessory.DisclosureIndicator;
            return cell;
        }
        protected override void Dispose (bool disposing)
        {
            base.Dispose (disposing);
            if (disposing)
            {
                if (this.fmt != null)
                {
                    this.fmt.Dispose ();
                    this.fmt = null;
                }
/*              if (this.isNullButton != null)
                {
                    this.isNullButton.Dispose ();
                    this.isNullButton = null;
                }*/
                if (this.datePicker != null)
                {
                    this.datePicker.Dispose ();
                    this.datePicker = null;
                }
            }
        }
        public virtual string FormatDate (DateTime? dt)
        {
            if (dt.HasValue)
                return this.fmt.ToString (dt.Value) + " " + dt.Value.ToLocalTime ().ToShortTimeString ();
            else
                return NullButtonCaption;
        }
        public virtual UIDatePicker CreatePicker ()
        {
            return new UIDatePicker (RectangleF.Empty)
            {
                AutoresizingMask = UIViewAutoresizing.FlexibleWidth,
                Mode = UIDatePickerMode.DateAndTime,
                Date = this.DateValue ?? DateTime.Now
            };
        }
        private static RectangleF PickerFrameWithSize (SizeF size)
        {
            RectangleF applicationFrame = UIScreen.MainScreen.ApplicationFrame;
            float y = 0f;
            float x = 0f;
            switch (UIApplication.SharedApplication.StatusBarOrientation)
            {
                case UIInterfaceOrientation.Portrait:
                case UIInterfaceOrientation.PortraitUpsideDown:

                    {
                        x = (applicationFrame.Width - size.Width) / 2f;
                        y = (applicationFrame.Height - size.Height) / 2f - 25f;
                        break;
                    }
                case UIInterfaceOrientation.LandscapeRight:
                case UIInterfaceOrientation.LandscapeLeft:

                    {
                        x = (applicationFrame.Height - size.Width) / 2f;
                        y = (applicationFrame.Width - size.Height) / 2f - 17f;
                        break;
                    }
            }
            return new RectangleF (x, y, size.Width, size.Height);
        }
        public override void Selected (DialogViewController dvc, UITableView tableView, NSIndexPath path)
        {
            NullableDateTimeElement.MyViewController myViewController = new NullableDateTimeElement.MyViewController (this)
            {
                Autorotate = dvc.Autorotate
            };
            this.datePicker = this.CreatePicker ();
            this.datePicker.Frame = NullableDateTimeElement.PickerFrameWithSize (this.datePicker.SizeThatFits (SizeF.Empty));
            myViewController.View.BackgroundColor = UIColor.Black;
            myViewController.View.AddSubview (this.datePicker);
            dvc.ActivateController (myViewController);
        }
    }
} 
```

**NULLABLE DATE-ONLY 元素**

```
using System;
using MonoTouch.Foundation;
using MonoTouch.UIKit;

namespace MonoTouch.Dialog
{
    public class NullableDateElement : NullableDateTimeElement
    {
        public NullableDateElement (string caption, DateTime? date, string nullButtonCaption, string setButtonCaption) : base (caption, date, nullButtonCaption, setButtonCaption)
        {
            initDateOnlyPicker ();
        }

        public NullableDateElement (string caption, DateTime? date, string nullButtonCaption) : base(caption, date, nullButtonCaption)
        {
            initDateOnlyPicker ();
        }

        public NullableDateElement (string caption, DateTime? date) : base(caption, date)
        {
            initDateOnlyPicker ();
        }

        void initDateOnlyPicker()
        {
            this.fmt.DateStyle = NSDateFormatterStyle.Medium;
        }

        public override string FormatDate (DateTime? dt)
        {
            if (dt.HasValue)
                return this.fmt.ToString (dt);
            else
                return base.NullButtonCaption;
        }
        public override UIDatePicker CreatePicker ()
        {
            UIDatePicker uIDatePicker = base.CreatePicker ();
            uIDatePicker.Mode = UIDatePickerMode.Date;
            return uIDatePicker;
        }
    }
} 
```

@Miguel, Please consider adding this to MonoTouch.Dialog, as there is a very legitimate business need for null dates/date times, and this solution seems to do the trick. My code will have to be cleaned up a bit, but this works.

# javascript - $(document).ready() 函数中设置的 jQuery 值

> ID：10199085
> 
> 赞同：3
> 
> 时间：2012-04-17T21:01:07.963
> 
> 标签：javascript, jquery, asp.net, telerik

我想在 DOM 完全加载后为对象设置值。`OnBlur`问题是，在从文本框中调用一个和`OnFocus`事件后，我得到一个空指针异常。我究竟做错了什么？

javascript:

```
$(document).ready(function () {
    var sumThursdayHrs = $('span[id*="lblThursdayHrs"]').last()
});

var tempThursdayHrs = 0.0;
function BlurThursdayHrs(sender, args) { sumThursdayHrs.text(tempThursdayHrs + sender.get_value()); }
function FocusThursdayHrs(sender, args) { tempThursdayHrs = sumThursdayHrs.text() - sender.get_value(); } 
```

标记：

```
<telerik:RadNumericTextBox ID="txtThursdayHrs" runat="server" NumberFormat-DecimalDigits="1"
        Width="25px" MinValue="0" Type="Number" DbValue='<%# Eval("ThursdayHrs") %>'>
        <ClientEvents OnBlur="BlurThursdayHrs" OnFocus="FocusThursdayHrs" />
</telerik:RadNumericTextBox> 
```

错误：

> Microsoft JScript 运行时错误：“sumThursdayHrs”未定义

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-17T21:15:57.683

正如您在标题中所说，这些值是*在一个函数*中设置的（准备好的事件处理函数）。但是 JavaScript 具有函数作用域，并且当您`sumThursdayHrs`使用`var`关键字声明为本地（不是说“私有”）变量时，它在外部是未定义的。两种可能：

*   使 sumThursdayHrs 成为全局变量（删除“var”）（并最终在外部声明它）。请注意，应尽可能避免使用全局变量，以防止命名冲突和 co
*   或将所有使用它的函数置于同一范围内。当心，那么这些函数也将不再全局可用，因此您需要在相同的上下文中设置模糊/焦点处理程序（正如 Patrick Scott 建议的那样）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-17T21:05:41.010

如果您已经在使用 jquery，为什么不将事件与 jquery 绑定？

```
$('span[id$="txtThursdayHrs"]:first').on("focus", FocusThursdayHrs)
          .on("blur", BlurThursdayHrs); 
```

另外，在 doc ready 函数中声明这些函数，这样他们就可以`sumThursdayHrs`在同一个地方访问或使用匿名函数，而不是调用函数

前任：

```
$(document).ready(function () {
    var sumThursdayHrs = $('span[id*="lblThursdayHrs"]').last();
    var tempThursdayHrs = 0.0;
    $('span[id$="txtThursdayHrs"]:first').on("focus", function() {
        sumThursdayHrs.text(tempThursdayHrs + $(this).val());
    })
    .on("blur", function() {
        tempThursdayHrs = sumThursdayHrs.text() - $(this).val();
    });
}); 
```

或者移动`sumThursdayHrs`到一个全局对象......为了理智，我建议不要把它放在窗口中。

而是定义一个全局命名空间来保存您的应用程序特定的全局变量。这称为全球减排。

前任。

```
var MyApp = {};
$(document).ready(function () {
    MyApp.sumThursdayHrs = $('span[id*="lblThursdayHrs"]').last();
    //... 
```

--

```
MyApp.tempThursdayHrs = 0.0;
function BlurThursdayHrs(sender, args) { MyApp.sumThursdayHrs.text(MyApp.tempThursdayHrs + sender.get_value()); }
function FocusThursdayHrs(sender, args) { MyApp.tempThursdayHrs = MyApp.sumThursdayHrs.text() - sender.get_value(); } 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-17T21:14:50.807

该错误是由于范围界定：

```
$(document).ready(function () {
    // sumThursdayHrs is a *local* variable to the function
    var sumThursdayHrs = $('span[id*="lblThursdayHrs"]').last()
});

// ... so this will fail because it is trying to use
// window.sumThursdayHrs (the property sumThursdayHrs on the window object),
// which is not set and thus the Reference Error
function BlurThursdayHrs(sender, args) {
    sumThursdayHrs.text(tempThursdayHrs + sender.get_value());
} 
```

“简单修复”（可能有效也可能无效）是：

```
$(document).ready(function () {
    // Set the "global variable" sumThursdayHrs
    // "window." isn't technically required, but it is to show a point.
    window.sumThursdayHrs = $('span[id*="lblThursdayHrs"]').last()
}); 
```

快乐编码。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-17T21:27:15.377

我不确定您提供的代码示例是否在同一个包中，但如果您在 中定义了一个变量`$(document).ready()`，请知道该变量在闭包内。在它之外，它将是未定义的。

那么为什么不这样做：

```
$(document).ready(function () {
    var sumThursdayHrs = $('span[id*="lblThursdayHrs"]').last();

    var tempThursdayHrs = 0.0;

    function BlurThursdayHrs(sender, args) {
        sumThursdayHrs.text(tempThursdayHrs + sender.get_value());
    }

    function FocusThursdayHrs(sender, args) {
        tempThursdayHrs = sumThursdayHrs.text() - sender.get_value();
    } 
}); 
```

在上面的代码中，它应该获取您想要的值，因为一切都在`$(document).ready()`闭包内。此外，您已将一个 jquery 对象 , 分配给`$('span[id*="lblThursdayHrs"]')`一个变量，因此它必须在 jquery 环境内部而不是外部使用... 总之一句话，如果您使用的是 jquery，请将其保留在 jquery 环境中。

你所做的是，你已经与 jquery 签订了一份合同，你将通过`var sumThursdayHrs = $('span[id*="lblThursdayHrs"]').last()`. 一旦你使用`$(something)`了，就是这样，它必须在jquery环境中使用。

# matlab - MATLAB如何在数组中查找数组的大小

> ID：10199087
> 
> 赞同：1
> 
> 时间：2012-04-17T21:01:15.997
> 
> 标签：matlab, multidimensional-array, size

我有`x`并且现在`x`是 a `<1x106 cell>`，如果`size(x,1)`我得到 1，`size(x,2)`我得到 106。现在我需要在这之后获取列大小`x(1,106)`是 a`<1x1 cell>`但是当我打开它时它实际上是 a`{1x3503 cell}`但是`size(x(1,106),2)`返回`1`。我认为这将是一个选择 x 内的行和列的简单案例，但我很不幸！

请不要笑我，我知道这一定不难，让我看起来有点像布偶，但直到 4 天前，我什至从未使用过 MATLAB，所以......

**谢谢你陪我！**
干杯!

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-17T21:06:07.950

*索引单元格和索引单元格的内容*是有区别的。

对于前者，您使用括号。另一个单元格数组也是如此`x(1,106)`，它包含存储在位置 (1,106) 中的单个单元格`x`。它*不*等于存储在`x`...的那个单元格中的数组，它只是一个由 .... 的那个单元格组成的单例单元格数组`x`。

相反，如果您想获取该单元格的*内容*，则使用花括号进行索引：`some_array = x{1,106}.`

现在，`some_array`实际上将是存储在 的 (1,106) 单元格中的数组`x`。

以另一种方式突出显示它，您可以选择先设置`some_cell_array = x(1,106)`然后设置`contents_array = some_cell_array{1,1}`，然后`contents_array`实际上将是存储在该单元格中的数组。

# mongodb - 迭代游标时修改Mongo对象的安全+有效方法？

> ID：10199089
> 
> 赞同：8
> 
> 时间：2012-04-17T21:01:23.097
> 
> 标签：mongodb, mongodb-scala

我有一些代码检查 Mongo 集合中的每个对象（迭代没有参数的 find() 的结果），并对其中的一些进行更改。这样做似乎不安全：我的更改已保存，但是当我继续遍历光标时，更改对象的子集（10-15%）第二次出现。我没有更改文档 ID 或任何有索引的东西。

我想我可以通过提前获取所有文档 ID（将光标转换为数组）来避免这个问题，但这些都是大型集合，所以我真的很想避免这种情况。

我注意到默认情况下 find() 的结果似乎没有任何定义的顺序，所以我尝试在光标 {"_id":1} 上进行显式排序。这似乎已经解决了这个问题——无论我修改什么，现在都没有出现两次。但我不知道这是否是一个好的/可靠的方法。据我从文档中可以看出，添加排序不会*使其*预查询所有 ID；如果是这样，那很好，但是我不知道为什么它会解决问题。

在更改内容时使用游标只是一个坏主意吗？

如果这很重要，我正在使用 Scala/Cas​​bah。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-04-17T21:58:56.447

听起来您想要的是快照查询。以下是有关如何执行此操作的更多信息：

[http://www.mongodb.org/display/DOCS/How+to+do+Snapshotted+Queries+in+the+Mongo+Database](http://www.mongodb.org/display/DOCS/How+to+do+Snapshotted+Queries+in+the+Mongo+Database)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-08-01T09:28:57.163

考虑使用`update`修改多个文档的命令：http: [//docs.mongodb.org/manual/tutorial/modify-documents/](http://docs.mongodb.org/manual/tutorial/modify-documents/)

此外，由于您只修改一些对象，因此请考虑使用只返回您实际要修改的文档的查询，而不是扫描整个集合。

迭代 a 的结果`find`和修改对象可能看起来更方便和灵活，因为您不限于使用更新运算符可以做什么，您可以用您选择的语言编写代码来修改文档。但是，存在您描述的问题以及其他限制：

[http://docs.mongodb.org/manual/faq/developers/#faq-developers-isolate-cursors](http://docs.mongodb.org/manual/faq/developers/#faq-developers-isolate-cursors)

例如，快照查询不是 100% 安全的，它们不能与分片集合一起使用，所以如果你后来决定分片，那么你的解决方案就会失败。

如果您需要以更复杂的方式修改大量对象，也许 map-reduce 或聚合管道可以解决您的问题：

[http://docs.mongodb.org/manual/core/aggregation-pipeline/](http://docs.mongodb.org/manual/core/aggregation-pipeline/)

[http://docs.mongodb.org/manual/core/map-reduce/](http://docs.mongodb.org/manual/core/map-reduce/)

# c# - Geo-Tiff 到 ECW 的转换？

> ID：10199106
> 
> 赞同：3
> 
> 时间：2012-04-17T21:03:00.990
> 
> 标签：c#, .net, image, image-processing

是否有任何库（开源或付费）允许将[GeoTiff](http://en.wikipedia.org/wiki/GeoTIFF)图像转换为[ECW](http://en.wikipedia.org/wiki/ECW_%28file_format%29)图像？理想情况下，该组件将简单地接收[GeoTiff](http://en.wikipedia.org/wiki/GeoTIFF)文件作为输入，并生成相应的[ECW](http://en.wikipedia.org/wiki/ECW_%28file_format%29)图像作为输出。它将支持从 .NET 本地调用，但我们可以解决任何外部流程要求。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-18T17:17:53.993

GDAL 有一个可用的二进制文件，称为 gdal_translate。当与 ECW SDK 结合使用时，运行类似的命令

```
gdal_translate.exe SourceFile.tif DestFile.ecw -of ECW 
```

将翻译您的文件。但是，它的上限为 500MB：

```
ERROR 1: ECW SDK 500MB compress limit exceeded. 
```

因此，对于较大的文件，需要替代解决方案。

# matlab - 在matlab中找到数组中的第一个零

> ID：10199109
> 
> 赞同：4
> 
> 时间：2012-04-17T21:03:16.700
> 
> 标签：matlab

我想在 matlab 的数组中找到第一个零元素。我正在使用“查找”功能来查找零，但它没有给出正确的答案，但它给出了 1 的正确答案。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-04-17T21:19:32.900

`find`如果像这样使用应该可以解决问题：

```
> a = [1 2 3 0 5 6 0 8 9];
> find(a==0, 1, 'first')
ans =  4 
```

让我们知道这是否不起作用（以及有关该问题的一些其他详细信息）。

[MATLAB 查找](http://www.mathworks.com/help/techdoc/ref/find.html)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-23T20:02:00.730

```
>> a = [1 2 3 0 5 6 0 8 9];

>> a=a==0;

>> n=1:length(a);

>> [n out]=max(a./n);

out =

     4 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2019-01-24T16:37:47.343

更简单：

```
find(~a,1,'first') 
```

# sql-server - 使用参数在另一个数据库中执行存储过程

> ID：10199111
> 
> 赞同：4
> 
> 时间：2012-04-17T21:03:24.220
> 
> 标签：sql-server, tsql, stored-procedures, dynamic-sql

我需要获取位于另一个数据库中的表的列名。以下脚本适用于活动数据库，但我需要针对同一服务器实例中的另一个数据库运行它：

```
SELECT @ColumnList = 
    CASE
        WHEN @ColumnList IS NULL THEN name
        WHEN @ColumnList IS NOT NULL THEN @ColumnList + ',' + name
    END
FROM sys.columns
WHERE object_id = Object_Id(@TableName); 
```

这是问题所在......数据库在编译时是未知的。它在运行时传递到存储过程中。所以我别无选择，只能使用动态 sql。过去我曾尝试`Use [DBName]`在动态 sql 脚本中使用，但总是遇到问题，直到我意识到我可以这样做：

```
SET @SQL = 'SELECT Foo FROM Bar'
SET @sp_executesql = quotename(@DatabaseName) + '..sp_executesql'
EXECUTE @sp_executesql @SQL 
```

但是我很难弄清楚如何使用上面提到的脚本来做到这一点。我的第一次尝试看起来像：

```
-- @DatabaseName and @TableName are parameters of the 
-- stored procedure containing this script

DECLARE @ColumnList nvarchar(max),
        @SQL nvarchar(max),
        @sp_executesql nvarchar(max) = quotename(@DatabaseName) + '..sp_executesql';
SET @SQL = 
'SELECT @ColumnList = 
    CASE
        WHEN @ColumnList IS NULL THEN name
        WHEN @ColumnList IS NOT NULL THEN @ColumnList + '','' + name
    END
FROM sys.columns
WHERE object_id = Object_Id(@TableName);'

EXECUTE @sp_executesql @SQL,
        N'@ColumnList = nvarchar(max) OUT, @TableName = sysname',
        @ColumnList, @TableName 
```

但是当它运行时，它不会被解释`@ColumnList`为一个有效的变量。我错过了什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-17T21:14:58.433

我不确定您在哪里使用了该语法，但我会这样做：

```
-- I assume these are parameters, so declaring them separately:
DECLARE 
    @DatabaseName SYSNAME = N'db_name',
    @TableName SYSNAME = N'table_name';

DECLARE 
    @sql NVARCHAR(MAX), 
    @columnList NVARCHAR(MAX);

SELECT @sql = N'SELECT @ColumnList = COALESCE(@ColumnList + '','', '''') 
    + c.name
    FROM [$db$].sys.columns AS c
    INNER JOIN [$db$].sys.tables AS o
    ON c.[object_id] = o.[object_id]
    WHERE o.name = @TableName;';

SET @sql = REPLACE(@sql, '$db$', @DatabaseName);

EXEC sp_executesql @sql, 
    N'@ColumnList NVARCHAR(MAX) OUTPUT, @TableName SYSNAME',
    @ColumnList OUTPUT, @TableName;

SELECT @ColumnList 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-17T22:18:18.890

您需要从@params 参数中删除*符号*`=`并在*@ColumnList*参数之后 添加`OUT`或。`OUTPUT`

 ***正确的：**

```
EXECUTE @sp_executesql @SQL,
        N'@ColumnList nvarchar(max) OUT, @TableName sysname',
        @ColumnList OUT, @TableName 
```

**不正确：**

```
EXECUTE @sp_executesql @SQL,
        N'@ColumnList = nvarchar(max) OUT, @TableName = sysname',
        @ColumnList, @TableName 
```*

# joomla - Joomla 网站上的文本主页

> ID：10199113
> 
> 赞同：0
> 
> 时间：2012-04-17T21:03:29.570
> 
> 标签：joomla

文本“Home”中有一个块，它位于我自己添加的文章“Test”之上。

现在我的问题是如何从我的网站上删除这个主页？我已经关掉了面包屑。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-17T21:26:25.770

转到您的主菜单并选择第一项，我们将被称为“家”。查看右侧的参数，并禁用名为 Show Page Heading 的参数。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-17T21:15:42.313

我现在无法测试它，所以我不确定，但请检查：

```
1\. Log in to your Joomla administrator backend.
2\. Click on ‘Extensions’,'Module Manager’.
3\. Search for ‘Breadcrumbs’ module, edit it.
4\. Under the options, set “Show Home” = No 
```

编辑：可能这不是你的问题，@seavers 的答案可能会解决。

# facebook - Facebook 应用程序选项卡而不是页面

> ID：10199115
> 
> 赞同：0
> 
> 时间：2012-04-17T21:03:33.630
> 
> 标签：facebook, tabs

您知道当用户进入 Facebook 页面时是否有任何方法可以从页面自动打开选项卡/应用程序？该页面已激活时间线，但我没有看到任何设置。

非常感谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-17T21:07:42.243

不，这是不可能的，您可以将用户直接链接到您的应用，但导航到页面本身的用户无法自动重定向到应用

# c# - 未找到 Lucene.net 转义字符，但找到未转义字符 - 我应该何时转义？

> ID：10199123
> 
> 赞同：1
> 
> 时间：2012-04-17T21:04:20.840
> 
> 标签：c#, lucene.net

我有一个 Lucene.net 索引，其中一个字段接收许多包含括号的条目。在针对该字段进行搜索之前，我通过`QueryParser.Escape(searchTerm)`. 如果我搜索包含括号的条目，则找不到。但是在运行 Visual Studio 调试器时，我取消了对搜索字符串的转义，并且搜索成功找到了我的条目。

在索引我的数据时，我使用的是标准分析器。对于这个字段，我存储它但不分析它。

### 字段索引：

```
doc.Add(new Field("fieldName", fieldValue, Field.Store.YES, Field.Index.NOT_ANALYZED)); 
```

`Term`有没有比试错更好的方法来知道在构造或`TermQuery`对象时是否（甚至哪些）特殊字符应该被转义？

## 编辑

### 现场搜索：

这有效：

```
List<Query> queryParts = new List<Query>;
queryParts.Add(new TermQuery(new Term("fieldName", searchValue))); 
```

我第一次尝试但没有奏效：

```
List<Query> queryParts = new List<Query>;
queryParts.Add(new TermQuery(new Term("fieldName", QueryParser.Escape(searchValue)))); 
```

来自`searchValue`用户输入。索引值和搜索值都应该包含括号和可能的其他对 Lucene 具有特殊意义的字符。

`queryParts`收集多个搜索条件并最终组合成一个`BooleanQuery`，根据用户的选择，所有元素都可以与`BooleanClause.Occur.MUST`或组合`BooleanClause.Occur.SHOULD`；之后，该查询可能会与其他搜索条件相结合。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-18T13:44:33.203

如果您不使用输入调用 QueryParser.Parse(string)，则无需使用 QueryParser.Escape()。

当您这样做时会发生什么，Escape 方法会将转义字符添加到您的输入中，但由于您手动构建您的术语，转义字符将保留在那里并且 lucene 尝试因此搜索它们。

> 索引值和搜索值都应该包含括号和可能的其他对 Lucene 具有特殊意义的字符

这些字符对 QueryParser Parse 方法具有特殊意义，它们在其他地方没有特殊意义。

# linux-kernel - 如何在 Linux 内核空间中打印用户空间堆栈跟踪

> ID：10199130
> 
> 赞同：3
> 
> 时间：2012-04-17T21:04:37.550
> 
> 标签：linux-kernel

比如说，我挂上了一个 sys_*（例如 sys_open）处理程序；当我发现从用户空间传递的参数是恶意的，我打印用户空间的堆栈跟踪。我该怎么做？

（dump_stack() 只打印内核堆栈）

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2016-07-18T07:55:55.607

您可以向内核中的目标进程发送一个可以生成核心转储文件的信号（例如 SIGBUS、SIGKABRT）。

例如：

```
 do_send_sig_info(SIGABRT, SEND_SIG_FORCED, current, true); 
```

然后您可以使用 gdb 显示生成的核心文件的回溯。

应用范围有限，这非常棘手。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-18T01:39:31.913

`oprofile`支持用户空间堆栈跟踪，这些是通过遍历用户空间堆栈在内核中计算的。（但请注意：它不解析符号；这是由用户空间中的报告工具完成的。）

如果我必须解决这个问题，我会开始（再次）查看 oprofile 代码并使用/调整那里的内容。

也许这种“恶意”事件可以简单地建模为一种要记录的oprofile事件，嗯。

# grails - 在 gsp 中加密密码值

> ID：10199132
> 
> 赞同：0
> 
> 时间：2012-04-17T21:04:47.410
> 
> 标签：grails, encryption, passwords, gsp

在我的 HTML 表单中，我有一个密码字段，我想在将其发送到 URL 表单帖子中之前对其进行加密。

所以我在提交点击时调用了一个 js 函数，比如 validateAndEncrypt() 基本上我想用它来加密密码。

如何加密此密码值？

1）我有一个内置的编解码器类（DESCodec），带有加密和解密方法，我可以直接在gsp中使用这个编解码器吗？- 如果是，我如何将密码值从 javascript 提供给 DESCodec。2）有没有使用纯javascript加密密码值的方法？

我应该采用哪种方法？

谢谢普里扬克

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-17T21:18:58.297

简短的回答：使用 SSL。

长答案：像 DES 这样的私钥加密算法在 Web 上不实用，因为浏览器需要与服务器共享私钥。为了安全地传输它，您需要使用某种形式的公钥交换。实现之后，您基本上重新发明了 SSL，但可能存在错误且不安全。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-17T22:26:56.023

1.  使用 SSL (https)
2.  没有必要在 Javascript 中使用客户端加密。保持客户端加密和服务器端解密同步可能比它的价值更多。
3.  认真：信任 SSL

> 我可以直接在 gsp 中使用这个编解码器吗？

不，您不能在客户端上使用服务器端代码。如果您选择双重加密表单，您将需要一个客户端库在提交表单元素之前对其进行编码。

*如果这确实是您的应用程序真正需要的，那么*您确实有 javascript 加密选项。

*   [http://crypto.stanford.edu/sjcl/](http://crypto.stanford.edu/sjcl/)
*   [http://www.tero.co.uk/des/](http://www.tero.co.uk/des/)
*   [http://www.jcryption.org/](http://www.jcryption.org/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-17T21:18:54.230

只需使用 ssl 加密 (https)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-17T21:25:11.493

使用 SSL 可能是一种更简单、更有效的解决方案——它会加密您可能发送的任何其他敏感数据。您尝试创建的解决方案正是 SSL 的设计目的。

# core-location - 如何比较 CLLocationCoordinate2D

> ID：10199133
> 
> 赞同：50
> 
> 时间：2012-04-17T21:04:47.493
> 
> 标签：core-location, cllocation, equatable

我需要一种比较两个的方法，`CLLocationCoordinate2D`但是当我尝试使用`==`它时它不起作用。请有人可以帮助我以最好的方式比较它们吗？

* * *

## 回答 #1

> 赞同：59
> 
> 时间：2012-04-17T21:10:56.203

用于比较任何给定结构类型的两个实例的通用方法：

```
memcmp(&cllc2d1, &second_cllc2d, sizeof(CLLocationCoordinate2D)) 
```

或者

```
cllc2d1.latitude == cllc2d2.latitude && cllc2d1.longitude == cllc2d2.longitude 
```

如果您真的想确保它们*完全*相等，应该可以工作。但是，鉴于纬度和经度被定义为双精度，您可能真的想做一个“足够接近”的比较：

```
fabs(cllc2d1.latitude - cllc2d2.latitude) <= epsilon && fabs(cllc2d1.longitude - cllc2d2.longitude) <= epsilon 
```

`epsilon`您想接受的任何级别的错误在哪里。

* * *

## 回答 #2

> 赞同：34
> 
> 时间：2012-08-16T22:02:31.887

作为所有这些答案的一个小补充，将比较定义为预处理器定义非常方便：

```
#define CLCOORDINATES_EQUAL( coord1, coord2 ) (coord1.latitude == coord2.latitude && coord1.longitude == coord2.longitude) 
```

或使用 epsilon：

```
#define CLCOORDINATE_EPSILON 0.005f
#define CLCOORDINATES_EQUAL2( coord1, coord2 ) (fabs(coord1.latitude - coord2.latitude) < CLCOORDINATE_EPSILON && fabs(coord1.longitude - coord2.longitude) < CLCOORDINATE_EPSILON) 
```

这使您可以进行如下比较：

```
CLLocationCoordinate2D resultingCoordinate = ... a method call ...;
CLLocationCoordinate2D expectedCoordinate = CLLocationCoordinate2DMake(48.11, 11.12);

if(CLCOORDINATES_EQUAL( resultingCoordinate, expectedCoordinate)) {
    NSLog(@"equal");
} else {
    NSLog(@"not equal");
} 
```

如果您不喜欢预处理器，另一种选择是使用内联方法。

* * *

## 回答 #3

> 赞同：24
> 
> 时间：2016-07-25T22:04:26.370

一个 Swift 扩展：

```
import MapKit

extension CLLocationCoordinate2D: Equatable {}

public func ==(lhs: CLLocationCoordinate2D, rhs: CLLocationCoordinate2D) -> Bool {
    return (lhs.latitude == rhs.latitude && lhs.longitude == rhs.longitude)
} 
```

[从 Xcode 7.3.1、Swift 2.2 开始测试] [当然，仍然存在比较浮点值的内在危险，因此您可能需要考虑使用`epsilon`前面答案中提到的方法]

* * *

## 回答 #4

> 赞同：14
> 
> 时间：2013-10-26T19:10:24.030

您可以使用[CLLocation](https://developer.apple.com/library/ios/documentation/CoreLocation/Reference/CLLocation_Class/CLLocation/CLLocation.html)类的 distanceFromLocation: 方法。返回值是一个[CLLocationDistance](https://developer.apple.com/documentation/corelocation/cllocationdistance?language=objc)，它实际上只是一个双精度值。

```
- (CLLocationDistance)distanceFromLocation:(const CLLocation *)location 
```

* * *

## 回答 #5

> 赞同：9
> 
> 时间：2015-02-23T14:30:31.417

你可以定义一个感觉很像来自 CoreLocation 的函数：

`BOOL CLLocationCoordinateEqual(CLLocationCoordinate2D coordinate1, CLLocationCoordinate2D coordinate2) { return (fabs(coordinate1.latitude - coordinate2.latitude) <= DBL_EPSILON && fabs(coordinate1.longitude - coordinate2.longitude) <= DBL_EPSILON); }`

* * *

## 回答 #6

> 赞同：8
> 
> 时间：2017-07-31T16:54:41.287

在 Swift 3 中，`DBL_EPSILON`已弃用。使用`Double.ulpOfOne`.

```
extension CLLocationCoordinate2D {
    func isEqual(_ coord: CLLocationCoordinate2D) -> Bool {
        return (fabs(self.latitude - coord.latitude) < .ulpOfOne) && (fabs(self.longitude - coord.longitude) < .ulpOfOne)
    }
} 
```

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2019-10-20T02:29:59.033

根据[leann 的](https://stackoverflow.com/users/1107226/leanne) [回答](https://stackoverflow.com/a/38578133/4475605)为 Swift 5 更新。

```
import CoreLocation

extension CLLocationCoordinate2D: Equatable {
    static public func ==(lhs: Self, rhs: Self) -> Bool {
        return lhs.latitude == rhs.latitude && lhs.longitude == rhs.longitude
    }
} 
```

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2012-04-17T21:09:58.370

```
CLLocationCoordinate2D c1, c2;
if (c1.latitude == c2.latitude && c1.longitude == c2.longitude)
{
    // ...
} 
```

我不是在开玩笑。CLLocationCoordinate2D 是一个 C 结构，除了比较各个成员之外，没有简单的方法来比较 C 结构。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2012-04-17T21:17:57.877

`CLLocationCoordinate2D`是一个 C 结构，因此，您需要比较它的字段：

```
CLLocationCoordinate2D coord1, coord2;
if (coord1.latitude == coord2.latitude && coord1.longitude == coord2.longitude) {
    // coordinates are equal
} 
```

请注意，`CLLocationCoordinate2D`字段是`double`，因此，您可能会遇到与任何其他浮点比较相同的问题。因此，我建议对值进行四舍五入，例如：

```
CLLocationCoordinate2D coord1, coord2;
if (round(coord1.latitude * 1000.0) == round(coord2.latitude * 1000.0)
    && round(coord1.longitude * 1000.0) == round(coord2.longitude * 1000.0)) {
    // coordinates are equal
} 
```

是的，这个，代码比较慢，但这可以帮助你避免因浮点数精度不那么完美而导致的问题。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2015-09-23T05:09:59.417

您可以使用此功能包装`CLLocationCoordinate`成`NSValue``+ (NSValue *)valueWithMKCoordinate:(CLLocationCoordinate2D)coordinate`

然后`isEqualToValue`用来比较。

引用Apple doc of `isEqualToValue`function：

> NSValue 类比较每个值对象的类型和内容以确定相等性。

参考：苹果文档[`NSValue`](https://developer.apple.com/library/prerelease/mac/documentation/Cocoa/Reference/Foundation/Classes/NSValue_Class/)

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2016-03-16T10:23:07.573

我们可以将纬度和经度转换为 NSString 并进行字符串比较。

```
+ (BOOL)isEqualWithCoordinate:(CLLocationCoordinate2D)location1 withAnotherCoordinate:(CLLocationCoordinate2D)location2{
NSString *locationString1 = [NSString stringWithFormat:@"%g, %g", location1.latitude, location1.longitude];
NSString *locationString2 = [NSString stringWithFormat:@"%g, %g", location2.latitude, location2.longitude];

if ([locationString1 isEqualToString:locationString2]) {
    return YES;
}else{
    return NO;
} 
```

}

由于 %g 会将截断的十进制数转换为 4 位数字。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2021-04-02T15:17:57.550

**斯威夫特 5.3 方式**

我创建了一个[要点](https://gist.github.com/NikKovIos/42808d2ef3831bd3d18171b4a144412e)

```
extension CLLocationCoordinate2D: Equatable {
    public static func == (lhs: CLLocationCoordinate2D, rhs: CLLocationCoordinate2D) -> Bool {
        let numbersAfterCommaAccuracy: Double = 4
        let ratio = numbersAfterCommaAccuracy * 10
        let isLatitudeEqual = ((lhs.latitude - rhs.latitude) * ratio).rounded(.down) == 0
        let isLongitudeEqual = ((lhs.latitude - rhs.latitude) * ratio).rounded(.down) == 0
        return isLatitudeEqual && isLongitudeEqual
    }
} 
```

# ruby-on-rails - 能够在控制台中获取 JSON 数据，但无法将其绑定到表单上的 AJAX 调用

> ID：10199136
> 
> 赞同：0
> 
> 时间：2012-04-17T21:04:49.263
> 
> 标签：ruby-on-rails, ajax, json

我正在通过浏览器控制台调用 JSON 请求，并且能够获得预期的响应。这是电话：

```
$.get("/settings/getstates?account%5Baddresses_attributes%5D%5B0%5D%5Bcountry%5D=US", function(data){
  console.log(data);
    var items = [];
    $.each(data, function(key, val) {
    items.push(val.name);
  });
    alert(items);   
}, 'json') 
```

但是，当我尝试将调用绑定到表单菜单中的选择器时，出现错误：

`Uncaught TypeError: Object json has no method 'apply'`

这是与 AJAX 绑定相同的调用：

```
$(document).ready(function() {

    $("#country").bind('ajax:success', function(evt, data, status, xhr){
      console.log(data);
        var items = [];
        $.each(data, function(key, val) {
        items.push(val.name);
      });
        alert(items);
    }, 'json')

}); 
```

这是在 Rails 3.2 中——不确定这是否重要？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-17T21:41:40.197

我是 JS/jQuery 等的新手，所以这可能是一个愚蠢的错误。我找到了解决方法。我只需要删除最后一行中的“json”引用，结果是：

```
$(document).ready(function() {

    $("#country").bind('ajax:success', function(evt, data, status, xhr){
      console.log(data);
        var items = [];
        $.each(data, function(key, val) {
        items.push(val.name);
      });
        alert(items);
    });

}); 
```

# html - 表单不会在 CSS 中居中

> ID：10199140
> 
> 赞同：1
> 
> 时间：2012-04-17T21:05:06.530
> 
> 标签：html, css, forms, center

编辑：[这是一个 jsfiddle 演示。](http://jsfiddle.net/4YXZz/)

**编辑 2：我认为它也被我正在使用的 Twitter Bootstrap 样式表覆盖。我会弄清楚那里出了什么问题。谢谢你们的帮助，伙计们。**

这是我的表单现在的样子：

![在此处输入图像描述](../Images/5c412728b59e28e6990e061ccf1cd295.png)

理想情况下，我希望搜索栏和提交按钮居中（搜索栏左侧和按钮右侧的边距相等）。

我的 CSS 似乎不起作用：

```
body {
    text-align:center;
    padding-top:5%;
    background:url(/img/bg.png);
    background-position:center;
    background-position:top;
    background-repeat:no-repeat;
    background-color:0b334c;
}

.searchContainer {
    width:440px;
    margin-left:auto;
    margin-right:auto;
    margin-top: 5%;
    zoom:1;
}

.searchBox {
    border: 1px solid #000000;
    padding:10px;
    margin: 0 auto;
    height:auto;
    width:auto;
    -webkit-border-radius:7px;
    -moz-border-radius:7px;
    border-radius:7px;
    background-color:#6eb0d9;
    background-color:#6eb0d9;
    background-repeat:repeat-x;
    background-image:-khtml-gradient(linear, left top, left bottom, from(#9cd1e9), to(#6eb0d9));
    background-image:-moz-linear-gradient(top, #9cd1e9, #6eb0d9);
    background-image:-ms-linear-gradient(top, #9cd1e9, #6eb0d9);
    background-image:-webkit-gradient(linear, left top, left bottom, color-stop(0%, #9cd1e9), color-stop(100%, #6eb0d9));
    background-image:-webkit-linear-gradient(top, #9cd1e9, #6eb0d9);
    background-image:-o-linear-gradient(top, #9cd1e9, #6eb0d9);
    background-image:linear-gradient(top, #9cd1e9, #6eb0d9);
    filter:progid:DXImageTransform.Microsoft.gradient(startColorstr='#9cd1e9', endColorstr='#6eb0d9', GradientType=0);
}

.searchBox form {
    display:inline-block;
}

.searchBox h2 {
    letter-spacing:-0.05em;
    padding-bottom:8px;
}

.searchBar {
    border: double;
    height:31px;
    width:357px;
    background-color:#fff;
    background-color:#fff;
    background-repeat:repeat-x;
    background-image:-khtml-gradient(linear, left top, left bottom, from(#eee), to(#fff));
    background-image:-moz-linear-gradient(top, #eee, #fff);
    background-image:-ms-linear-gradient(top, #eee, #fff);
    background-image:-webkit-gradient(linear, left top, left bottom, color-stop(0%, #eee), color-stop(100%, #fff));
    background-image:-webkit-linear-gradient(top, #eee, #fff);
    background-image:-o-linear-gradient(top, #eee, #fff);
    background-image:linear-gradient(top, #eee, #fff);
    filter:progid:DXImageTransform.Microsoft.gradient(startColorstr='#eee', endColorstr='#fff', GradientType=0);
}

input.searchButton {
    position:fixed;
    height: 31px;
    width: 33px;
    cursor: pointer;
    border: none;
    background:url(../img/searchButton-Off.png) no-repeat;
} 

input.searchButton:hover { 
    position:fixed;
    height: 31px;
    width: 33px;
    cursor: pointer;
    border: none;
    background:url(../img/searchButton-On.png) no-repeat;
} 
```

* * *

```
 <div class="searchBox">
    <h2 style="color:#000000;">Search</h2>
    <form id="form_297586" class="appnitro"  method="get" action="results.php">
      <input id="keywords" name="keywords" class="searchBar" title="What do you like...?" type="text" maxlength="255" value=""/>
      &nbsp;<input type="submit" class="searchButton" value="" />
      <input type="hidden" name="form_id" value="297586" />
      <input type="hidden" name="src" value="n" />
      <input type="hidden" name="fancy" value="y" />
    </form>
  </div> 
```

我在这里做错了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-17T21:23:59.083

我可以让它工作的唯一方法是`position: fixed`从搜索按钮和搜索栏（`input`s）中删除，然后添加`position: relative; top: -9px;`到`.searchButton`元素中。

老实说，这感觉很脏；我不知道*为什么*需要这样做。

无论如何，一个[JS Fiddle 演示](http://jsfiddle.net/davidThomas/4YXZz/3/)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-17T21:12:39.430

尝试将此类添加到您的 CSS 中：

```
.appnitro { margin: 0 auto; } 
```

您可能需要在表单上设置宽度。

刷新时按Ctrl+F5 =)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-17T21:17:22.400

您可以在 div 内扭曲表单，指定大小并将左右边距设置为自动

[http://jsfiddle.net/chepe263/WbTLr/](http://jsfiddle.net/chepe263/WbTLr/)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-17T21:22:02.867

我在 jsfiddle 上运行了您的代码，我发现它实际上是您的搜索栏完全居中。提交按钮只是停留在它的右侧。`position:fixed`从类中删除`input.searchButton`并添加：

```
position: relative;
bottom: 8px; 
```

这是因为如果您删除`position:fixed`整个中心，但提交按钮会向下移动一点。所以这是一个小小的技巧来推动它。

[jsFiddle 工作演示](http://jsfiddle.net/dvidby0/bRuxA/)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-04-17T21:25:11.373

当我需要居中某些东西时，我会这样做：

### 款式：

```
div.centera {
    float: right;
    left: -50%;
    position: relative;
}
div.centerb {
    float: right; 
    left: 50%;  
    position: relative;
} 
```

### 并居中内容：

```
<div class="centera">
    <div class="centerb">
        <div>Should be in center</div>
    </div>
</div> 
```

## 编辑：

`float: left;`试过了，添加后在铬中 效果很好`<input id="keywords"...`

无论如何，我认为也`float: left`应该为按钮添加...

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2012-04-17T21:15:15.263

您可以将表单包装在中心标签中。

# css - 覆盖没有默认值的 CSS 属性

> ID：10199141
> 
> 赞同：10
> 
> 时间：2012-04-17T21:05:10.193
> 
> 标签：css, inheritance, css-cascade

如果该属性没有默认值，是否可以在 CSS 中覆盖该属性？

例如，假设您的主样式表为特定元素定义了边框：

```
#element {
  border: 1px solid #000;
} 
```

如果你想禁用辅助样式表的边框，你可以这样做：

```
#element {
  border: none;
} 
```

假设第二个样式表是在第一个样式表之后加载的，则该`border: none`规则将优先并删除边框。

但是如果你试图覆盖一个没有默认值或空值的属性呢？

```
#element {
  position: absolute;
  left: 0;
} 
```

现在说，在您的辅助样式表中，您想这样做：

```
#element {
  right: 0;
  top: 0;
} 
```

而且您不希望`left`. 没有这样的东西`left: none;`，所以......你如何“取消声明”`left`主样式表中分配的属性？

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2012-04-17T21:07:13.803

如果我正确阅读了您的问题，您是否想在一个样式表中“删除”您在另一个样式表中的声明，以便该属性将计算为默认值？

目前无法将其重置为浏览器用作给定元素的默认值的任何值。您可以获得的最接近的是[CSS3`initial`关键字](http://www.w3.org/TR/css3-cascade/#initial0)，它根据规范而不是根据浏览器的定义方式将属性重置为其初始/默认值：

```
#element {
  left: initial;
  right: 0;
  top: 0;
} 
```

除了 Safari/Chrome 和 Firefox (as) 之外，没有太多浏览器支持它`-moz-initial`，所以你的下一个最佳选择是查找初始值并对其进行硬编码。对于`left`属性，它是`auto`（而且我相信它是所有浏览器中任何元素的这个值），所以：

```
#element {
  left: auto;
  right: 0;
  top: 0;
} 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-04-17T21:13:49.040

每个 CSS 属性都有依赖于浏览器的默认值，因此没有没有默认值的 CSS 属性。

正如 BoltClock 所说，`initial`是最好的选择。

以下是有关它的一些规格：

[http://www.w3.org/TR/css3-cascade/](http://www.w3.org/TR/css3-cascade/#initial0)

## 编辑：

在 jmbertucci 发表评论之前，我并不认为我一直是如何做到这一点的，

通过使用 CSS 重置，您可以定义自己的默认值，而不依赖于使用的浏览器。如果您`left: 10px;`在自己的 reset.css 中定义，则可以在需要恢复默认值时使用相同的值。

例如，我经常从我的 reset.css 中查找字体大小，并使用它们来进行取决于文本高度的高度计算。

如果使用 PHP 或其他一些预处理，您也可以始终将其用于 CSS 文件：

```
<?php
define('DEFAULT_WIDTH', 'width: 100px;');
?>

div {
    top: 100px;
    <?php print DEFAULT_WIDTH; ?>
} 
```

# api - 两个 Safari 扩展如何相互通信？

> ID：10199149
> 
> 赞同：0
> 
> 时间：2012-04-17T21:05:49.227
> 
> 标签：api, safari-extension

Safari 扩展框架明确不支持扩展之间的消息传递。我正在寻找一种可行的方法来解决这个问题，**而不让页面知道**扩展正在运行。

建议（未测试）：

1.  一个扩展使用 openTab()打开一个**隐藏选项卡到 about:blank#extension-channel。**另一个通过 URL 搜索该选项卡并找到它。他们生产和使用该页面上的元素进行交流。

2.  如果扩展可以跨域读取 cookie，则一个在 extension-homepage.com**设置一个具有随机 ID 的 cookie，**另一个读取它。然后他们创建名为`extension-message-[the random ID]`" 的 DOM 事件，因此页面无法侦听。

3.  请愿 Safari 开发人员将 onRequestExternal 添加到他们的 API 中；）

你能想到另一种方法吗？你有没有得到上述任何工作？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-09T15:44:05.917

让扩展 A 打开一个[WebSocket](http://en.wikipedia.org/wiki/WebSocket)连接到由扩展 B 用 Ja​​vaScript 实现的 WebSocket 服务器。参见[socket.io](http://socket.io/)、[WebSocket-Node](https://github.com/Worlize/WebSocket-Node)等。允许两个扩展之间或扩展与外部世界之间的强大双向通信。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-18T00:38:57.640

可以使用[window.postMessage](https://developer.mozilla.org/en/DOM/window.postMessage)在扩展之间传递消息，以当前选项卡中的页面作为中介。

我在[https://github.com/canisbos/ClickClack](https://github.com/canisbos/ClickClack)分享了两个非常简单的演示扩展作为概念证明。如果您安装它们，您会看到单击一个扩展程序的工具栏按钮会导致另一个按钮图像翻转。

# android - 使用 Phonegap 和 Sencha 的移动离线 GPS lat、lng、存储？

> ID：10199151
> 
> 赞同：0
> 
> 时间：2012-04-17T21:05:52.133
> 
> 标签：android, iphone, mobile, cordova, extjs

如果移动开发是使用 Sencha 和 Phonegap 实现的，是否可以在 iphone / android 上存储离线 gps 信息？

有没有办法使用 html5 和 css3 实现本机应用程序，可以访问 gps 和相机等资源以离线存储该数据？

我正在研究我是否应该去本地，任何建议都非常感谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-18T00:20:03.653

PhoneGap 通过将数据持久化到设备的本地数据库中，绝对支持这种情况。[您可以在PhoneGap API 参考](http://docs.phonegap.com/en/1.6.0/cordova_storage_storage.md.html#Storage)中找到更多信息（包括代码片段）。

如果您见过 SQL 查询，那么数据库操作对您来说将是小菜一碟。您的应用程序也将在 Android 和 iPhone 上运行。

# php - 地理编码地址 - 获取某个地址的地区（Google API）

> ID：10199152
> 
> 赞同：7
> 
> 时间：2012-04-17T21:05:54.367
> 
> 标签：php, google-maps-api-3, geolocation, geocoding, jquery-gmap3

我有一个包含确切地址（街道、编号、城市、地区/地区、国家/地区）的数据库。但是，我想知道如果我们在纽约，是否有办法使用 Google API 来获取城市的区域（例如“曼哈顿”）？

我已经在数据库中的所有其他信息，所以如果有的话我只需要该地区（当然这只会在大城市中）......

更新：

[我在http://www.techques.com/question/1-3151450/Google-geolocation-API---Use-longitude-and-latitude-to-get-address](http://www.techques.com/question/1-3151450/Google-geolocation-API---Use-longitude-and-latitude-to-get-address)上找到了这个功能，并试图更改`formatted_address`为子区域（甚至其他人喜欢 short_name 等），但它不返回任何东西......任何帮助将不胜感激！谢谢！！

```
function reverse_geocode($lat, $lon) {
    $url = "http://maps.google.com/maps/api/geocode/json?latlng=$lat,$lon&sensor=false";
    $data = json_decode(file_get_contents($url));
    if (!isset($data->results[0]->formatted_address)){
        return "unknown Place";
    }
    return $data->results[0]->formatted_address;
} 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-04-18T19:42:15.987

您可以像这样访问子区域：

```
function reverse_geocode($lat, $lon) {
    $url = "http://maps.google.com/maps/api/geocode/json?latlng=$lat,$lon&sensor=false";
    $data = json_decode(file_get_contents($url));
    if (!isset($data->results[0]->address_components)){
        return "unknown Place";
    }

    if ($data->results[0]->address_components[2]->types[0]=="sublocality") {

        $return_array['type']="sublocality";
        $return_array['sublocality_long_name']=$data->results[0]->address_components[2]->long_name;
        $return_array['sublocality_short_name']=$data->results[0]->address_components[2]->short_name;

        return $return_array;
        }

} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-17T23:04:31.217

当存在`types`设置为的结果时，您将在地理编码请求中找到此信息

```
 [ "sublocality", "political" ] 
```

示例：[纽约市麦迪逊大街 317 号](http://maps.googleapis.com/maps/api/geocode/json?address=317%20Madison%20Ave,%20New%20York%20City&sensor=false)

* * *

修改上面的函数以便于访问响应组件：

```
 /**
    * @param $a mixed latitude or address
    * @param $b mixed optional longitude when $a is latitude
    * @return object geocoding-data
    **/

    function geocode($a, $b=null) {
    $params=array('sensor'=>'false');
    if(is_null($b))
    {
      $params['address']=$a;
    }
    else
    {
      $params['latlng']=implode(',',array($a,$b));
    }
    $url = 'http://maps.google.com/maps/api/geocode/json?'.http_build_query($params,'','&');
    $result=@file_get_contents($url);

     $response=new StdClass;
     $response->street_address               = null;
     $response->route                        = null;
     $response->country                     = null;
     $response->administrative_area_level_1 = null;
     $response->administrative_area_level_2 = null;
     $response->administrative_area_level_3 = null;
     $response->locality                    = null;
     $response->sublocality                 = null;
     $response->neighborhood                = null;
     $response->postal_code                 = null;
     $response->formatted_address           = null;
     $response->latitude                    = null;
     $response->longitude                   = null;
     $response->status                      = 'ERROR';

    if($result)
    {
      $json=json_decode($result);
      $response->status=$json->status;
      if($response->status=='OK')
      {
        $response->formatted_address=$json->results[0]->formatted_address;
        $response->latitude=$json->results[0]->geometry->location->lat;
        $response->longitude=$json->results[0]->geometry->location->lng;

        foreach($json->results[0]->address_components as $value)
        {
          if(array_key_exists($value->types[0],$response))
          {
            $response->{$value->types[0]}=$value->long_name;
          }
        }
      }
    }
  return $response;
}

//sample usage
echo '<hr/>'.geocode('317 Madison Ave,New York City')->sublocality;
  //Manhattan

echo '<hr/>'.geocode('foobar')->status;
  //ZERO_RESULTS

echo '<hr/>'.geocode('40.689758, -74.04513800000001')->formatted_address;
  //1 Liberty Is, Brooklyn, NY 11231, USA 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2018-02-07T23:12:39.577

我想出了以下内容。

```
function geocode() {
    var geocoder = new google.maps.Geocoder();
    var lat  = $('#latitude').val()
    var lng  = $('#longitude').val()
    var latlng = {lat: parseFloat(lat), lng: parseFloat(lng)};

  geocoder.geocode(
    {'location': latlng},
    function(results, status) {
      if (status === 'OK') {
        for (var i = 0; i < results[0].address_components.length; i++)
        {
          if (status == google.maps.GeocoderStatus.OK) {
    				if (results[0]) {
    					for (var i = 0; i < results.length; i++) {
                //alert(results[i].types[0]+','+results[i].types[1]+','+results[i].address_components[0].long_name)
                //district
                if (results[i].types[0]=='political' && results[i].types[1]=='sublocality' ){
                  alert(results[i].address_components[0].long_name);
                }
                //City
                if (results[i].types[0]=='locality' && results[i].types[1]=='political' ){
                  alert(results[i].address_components[0].long_name);
                }
                //country
                if (results[i].types[0]=='country' && results[i].types[1]=='political' ){
                  alert(results[i].address_components[0].long_name);
                }
    					}
    				}
    				else {console.log("No reverse geocode results.")}
    			}
    			else {console.log("Geocoder failed: " + status)}

        }
  }})
}
```

```
<script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js"></script>
```

# css - 三列布局，列间距

> ID：10199157
> 
> 赞同：0
> 
> 时间：2012-04-17T21:06:10.863
> 
> 标签：css, html

我不得不使用三列布局，我不知道如何在两列之间放置一些间距：中心列（内容）和右列（div id =“side-gal”）。示例站点在这里[http://jsfiddle.net/Taw4P/](http://jsfiddle.net/Taw4P/)黄色是side-gal，中心蓝色是内容

我想要的是像我在网页左侧的空白空间，在 div id = "side-nav" 和内容之间。在这里这样做很容易，我只是减小了侧导航的宽度。在右侧，它不会像这样工作。

那么，我该怎么做呢？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-17T21:39:56.120

更改`padding:0 10px;`为`margin:0 10px;`开`#side-gal`

# sql-server - 带有附加数据的 EF 代码优先多对多

> ID：10199158
> 
> 赞同：0
> 
> 时间：2012-04-17T21:06:15.777
> 
> 标签：sql-server, entity-framework, ef-code-first

我有这些表：

```
CREATE TABLE [EDR_SECURITY].[Person](
    [ixPerson] [bigint] IDENTITY(1,1) NOT NULL,
    [sName] [nvarchar](200) NOT NULL,
) ON [PRIMARY] TEXTIMAGE_ON [PRIMARY]

CREATE TABLE [EDR_SECURITY].[SecurityGroup](
    [ixSecurityGroup] [bigint] IDENTITY(1,1) NOT NULL,
    [sName] [nvarchar](200) NOT NULL,
    [sDescription] [nvarchar](400) NULL,
) ON [PRIMARY]

CREATE TABLE [EDR_SECURITY].[PersonSecurityGroupDefinition](
    [ixPerson] [bigint] NOT NULL,
    [ixSecurityGroup] [bigint] NOT NULL,
    [fPrivilege] [bigint] NOT NULL,
 CONSTRAINT [PK_PersonSecurityGroupDefinition] PRIMARY KEY CLUSTERED 
(
    [ixPerson] ASC,
    [ixSecurityGroup] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY] 
```

如何在 EF 代码中首先创建 和 之间的`Person`关系`Security Group`？

谢谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-17T21:28:58.590

如果我从原始 SQL 中完全理解...

编辑：正如您在具体情况下所建议的那样，我认为这至少非常接近......

```
public class Person
{
    public int PersonID { get; set; }
    public string Name { get; set; }
    public virtual ICollection<PersonSecurityGroupDefinition> 
        PersonSecurityGroups { get; set; }
}
public class SecurityGroup
{
    public int SecurityGroupID { get; set; }
    public string Name { get; set; }
    public string Description { get; set; }
    public virtual ICollection<PersonSecurityGroupDefinition> 
        PersonSecurityGroups { get; set; }
}
public class PersonSecurityGroupDefinition
{
    public int PersonID { get; set; }
    public int SecurityGroupID { get; set; }
    public int Privilege { get; set; }
    // don't use virtual here as these are PK-s
    public Person Person { get; set; }
    public SecurityGroup SecurityGroup { get; set; }
} 
```

...并在`OnModelCreating`（覆盖您的`DbContext`...

```
modelBuilder.Entity<PersonSecurityGroupDefinition>()
    .HasKey(i => new { i.PersonID, i.SecurityGroupID });

modelBuilder.Entity<PersonSecurityGroupDefinition>()
    .HasRequired(i => i.Person)
    .WithMany(u => u.PersonSecurityGroups)
    .HasForeignKey(i => i.PersonID)
    .WillCascadeOnDelete(false);

modelBuilder.Entity<PersonSecurityGroupDefinition>()
    .HasRequired(i => i.SecurityGroup)
    .WithMany(d => d.PersonSecurityGroups)
    .HasForeignKey(i => i.SecurityGroupID)
    .WillCascadeOnDelete(false); 
```

...希望就是这样。

# c - 在 C 中修改使用 typedef 构造的 MyType 时出错

> ID：10199163
> 
> 赞同：0
> 
> 时间：2012-04-17T21:06:29.653
> 
> 标签：c, struct, typedef

我创建了一个类型并尝试更改其中的 int 值。但是它一直打印240。我不知道为什么，有人可以帮我吗？这是我的代码：

```
typedef struct{
   int i;
}MyType;

do(MyType mt, int ii){
   mt.i = ii;
}

int main(int argc, char ** argv){
    MyType mt;
    do(mt, 5);
    print("%d\n", mt.i);
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-17T21:09:19.823

按值传递`mt`给函数`do()`。所做的任何更改都将是该函数的本地更改。传递地址`mt`：

```
void do_func(MtType* mt, int ii){
    mt->i = ii;
}

MyType mt;
do_func(&mt, 5); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-17T21:10:44.003

所以首先，你的`do`功能有一些问题。您未能指定返回类型，因此假定为 int（C99 之前），但我认为没有理由不只指定它。其次，`do`是 C 中的保留关键字。

您正在按值传递结构，因此会制作一个副本，将其传递给您的`do`函数，然后*对其进行*修改。在 C 中，所有内容都是按值传递的，句号。您`mt`声明的变量`main`永远不会被触及。

`MyType*`如果您需要修改其一个或多个成员变量，请在代码中使用 a，`MyType**`如果您需要为结构本身分配内存（即初始化指针），请使用 a。

```
// pass a pointer to the function to allow
// for changes to the member variables to be 
// visible to callers of your code.
void init_mytype(MyType *mt, int ii){
    if(mt)
        mt->i = ii;
}

MyType mt;
init_mytype(&mt, 1);

// pass a pointer to pointer to initialize memory
// for the structure and return a valid pointer.
// remember, everything is passed by value (copy)
void init_mytype(MyType **mt, int ii) {
    if(mt) {
        *mt = malloc(sizeof(MyType));
        if(*mt) 
            (*mt)->i = ii;
    }
}

MyType *pmt;
init_mytype(&pmt, 1); 
```

# delphi - FastMM 是否只报告内存泄漏和/或内存分配？

> ID：10199167
> 
> 赞同：3
> 
> 时间：2012-04-17T21:06:53.147
> 
> 标签：delphi, memory-leaks, delphi-xe, fastmm, resource-leak

我正在使用 FastMM 调试我的程序，它报告的许多内存泄漏似乎是合法的内存分配，而不是实际的内存泄漏。

例如，

```
A memory block has been leaked. The size is: 20

This block was allocated by thread 0xD44, and the stack trace (return addresses) at the time was:
404902 [System.pas][System][@GetMem][3693]
406597 [System.pas][System][TObject.NewInstance][11044]
406B2A [System.pas][System][@ClassCreate][12121]
60A1D2 [CtrlObjs.pas][Ctrlobjs][TConnObj.Create][430]
61703B [Control.pas][Control][TControlMgr.FindLinks][854]
60ACB2 [CtrlObjs.pas][Ctrlobjs][TControlObject.FindLink][746]
60E2A3 [CtrlObjs.pas][Ctrlobjs][TDelayControl.EvalPulse][2105]
60E4C0 [CtrlObjs.pas][Ctrlobjs][TDelayControl.Evaluate][2193]
6102D4 [CtrlObjs.pas][Ctrlobjs][TLineControl.Evaluate][3155]
60ABF1 [CtrlObjs.pas][Ctrlobjs][TControlObject.ActiveCount][711]
6105D8 [CtrlObjs.pas][Ctrlobjs][TLineControl.ActiveCount][3261]

The block is currently used for an object of class: TConnObj 
```

TConnObj 是经常用于创建对象并在程序不再需要时销毁的类。但是，FastMM 报告它是实际的内存泄漏。那么，在查看 FastMM 内存泄漏日志文件时，如何判断哪个是哪个？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-04-17T21:09:44.923

如果 FastMM 将其报告为泄漏，那么它确实是泄漏。

您创建了一个对象，但未能在程序终止前销毁它。这通常是由于您的代码中存在一个直接错误。也许你省略了 try/finally 来保护对象的生命。

如果它是一个没有被销毁的全局范围对象，那么您可以在程序终止时简单地销毁它。或者您可以调用[RegisterExpectedMemoryLeak](http://docwiki.embarcadero.com/RADStudio/en/Registering_Memory_Leaks)来表明您不打算销毁该对象。但只有当你故意泄漏一个对象时才这样做。不要用它来掩盖无意的泄漏。

但底线是 FastMM 不会说谎。如果它说您正在泄漏，请相信它。

# scala - 当 match 收到 IndexedSeq 但不是 LinearSeq 时出现 MatchError

> ID：10199171
> 
> 赞同：3
> 
> 时间：2012-04-17T21:07:30.993
> 
> 标签：scala, match, seq

有没有理由`match`写反对在类型上的`Seq`工作方式与在类型上的工作方式不同？对我来说，无论输入类型如何，下面的代码似乎都应该做同样的事情。当然不会，否则我不会问。`IndexedSeq``LinearSeq`

```
import collection.immutable.LinearSeq
object vectorMatch {
  def main(args: Array[String]) {
    doIt(Seq(1,2,3,4,7), Seq(1,4,6,9))
    doIt(List(1,2,3,4,7), List(1,4,6,9))
    doIt(LinearSeq(1,2,3,4,7), LinearSeq(1,4,6,9))
    doIt(IndexedSeq(1,2,3,4,7), IndexedSeq(1,4,6,9))
    doIt(Vector(1,2,3,4,7), Vector(1,4,6,9))
  }

  def doIt(a: Seq[Long], b: Seq[Long]) {
    try {
      println("OK! " + m(a, b))
    }
    catch {
      case ex: Exception => println("m(%s, %s) failed with %s".format(a, b, ex))
    }
  }

  @annotation.tailrec
  def m(a: Seq[Long], b: Seq[Long]): Seq[Long] = {
    a match {
      case Nil => b
      case firstA :: moreA => b match {
        case Nil => a
        case firstB :: moreB if (firstB < firstA) => m(moreA, b)
        case firstB :: moreB if (firstB > firstA) => m(a, moreB)
        case firstB :: moreB if (firstB == firstA) => m(moreA, moreB)
        case _ => throw new Exception("Got here: a: " + a + "  b: " + b)
      }
    }
  }
} 
```

在 2.9.1 final 上运行它，我得到以下输出：

```
OK! List(2, 3, 4, 7)
OK! List(2, 3, 4, 7)
OK! List(2, 3, 4, 7)
m(Vector(1, 2, 3, 4, 7), Vector(1, 4, 6, 9)) failed with scala.MatchError: Vector(1, 2, 3, 4, 7) (of class scala.collection.immutable.Vector)
m(Vector(1, 2, 3, 4, 7), Vector(1, 4, 6, 9)) failed with scala.MatchError: Vector(1, 2, 3, 4, 7) (of class scala.collection.immutable.Vector) 
```

它对于 List-y 的东西运行良好，但对于 Vector-y 的东西却失败了。我错过了什么吗？这是编译器错误吗？

的`scalac -print`输出`m`看起来像：

```
@scala.annotation.tailrec def m(a: Seq, b: Seq): Seq = {
  <synthetic> val _$this: object vectorMatch = vectorMatch.this;
  _m(_$this,a,b){
    <synthetic> val temp6: Seq = a;
    if (immutable.this.Nil.==(temp6))
      {
        b
      }
    else
      if (temp6.$isInstanceOf[scala.collection.immutable.::]())
        {
          <synthetic> val temp8: scala.collection.immutable.:: = temp6.$asInstanceOf[scala.collection.immutable.::]();
          <synthetic> val temp9: Long = scala.Long.unbox(temp8.hd$1());
          <synthetic> val temp10: List = temp8.tl$1();
          val firstA$1: Long = temp9;
          val moreA: List = temp10;
          {
            <synthetic> val temp1: Seq = b;
            if (immutable.this.Nil.==(temp1))
              {
                a
              }
            else
              if (temp1.$isInstanceOf[scala.collection.immutable.::]())
                {
                  <synthetic> val temp3: scala.collection.immutable.:: = temp1.$asInstanceOf[scala.collection.immutable.::]();
                  <synthetic> val temp4: Long = scala.Long.unbox(temp3.hd$1());
                  <synthetic> val temp5: List = temp3.tl$1();
                  val firstB: Long = temp4;
                  if (vectorMatch.this.gd1$1(firstB, firstA$1))
                    body%11(firstB){
                      _m(vectorMatch.this, moreA, b)
                    }
                  else
                    {
                      val firstB: Long = temp4;
                      val moreB: List = temp5;
                      if (vectorMatch.this.gd2$1(firstB, moreB, firstA$1))
                        body%21(firstB,moreB){
                          _m(vectorMatch.this, a, moreB)
                        }
                      else
                        {
                          val firstB: Long = temp4;
                          val moreB: List = temp5;
                          if (vectorMatch.this.gd3$1(firstB, moreB, firstA$1))
                            body%31(firstB,moreB){
                              _m(vectorMatch.this, moreA, moreB)
                            }
                          else
                            {
                              body%41(){
                                throw new java.lang.Exception("Got here: a: ".+(a).+("  b: ").+(b))
                              }
                            }
                        }
                    }
                }
              else
                {
                  body%41()
                }
          }

        }
      else
        throw new MatchError(temp6)
  }
}; 
```

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2012-04-17T21:27:58.393

您不能`::`用于除`List`. `Vector`无法匹配，因为 它`::`是一个扩展的案例类`List`，因此它的`unapply`方法不适用于`Vector`。

```
val a :: b = List(1,2,3)    // fine
val a :: b = Vector(1,2,3)  // error 
```

但是您可以定义自己的适用于所有序列的提取器：

```
object +: {
  def unapply[T](s: Seq[T]) =
    s.headOption.map(head => (head, s.tail))
} 
```

所以你可以这样做：

```
val a +: b = List(1,2,3)   // fine
val a +: b = Vector(1,2,3) // fine 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2018-11-23T10:39:31.133

跟随模式匹配适用于`List`, `Seq`, `LinearSeq`, `IndexedSeq`, `Vector`.

```
 Vector(1,2) match {
  case a +: as => s"$a + $as"
  case _      => "empty"  
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2021-03-25T14:30:50.473

在 Scala 2.10中是在[本次提交](https://github.com/scala/scala/commit/b3efb3d493605d1c7e106e5f0a697b52ebb3d97c)`object +:`中引入的。从那时起，对于每个，您可以执行以下操作：`SeqLike`

```
@annotation.tailrec
def m(a: Seq[Long], b: Seq[Long]): Seq[Long] = {
  a match {
    case Nil => b
    case firstA +: moreA => b match {
      case Nil => a
      case firstB +: moreB if (firstB < firstA) => m(moreA, b)
      case firstB +: moreB if (firstB > firstA) => m(a, moreB)
      case firstB +: moreB if (firstB == firstA) => m(moreA, moreB)
      case _ => throw new Exception("Got here: a: " + a + "  b: " + b)
    }
  }
} 
```

代码在[Scastie](https://scastie.scala-lang.org/kzP4Ed77SayXgjQbqVDXNA)运行。

# hover - 仅在悬停时使用 jQuery Cycle

> ID：10199175
> 
> 赞同：2
> 
> 时间：2012-04-17T21:07:44.880
> 
> 标签：hover, jquery-cycle

我试图让 jQuery Cycle 仅在幻灯片悬停时运行（这与它们内置的功能相反）。

这是我所在的位置：http: [//jsfiddle.net/zSBMU/](http://jsfiddle.net/zSBMU/)

```
$(document).ready(function() {

$('.slideshow').hover(
    function() {
        $(this).cycle({
            fx:     'fade',
            speed:   600,
            timeout: 300,
            pause:   0
        });
    },
    function(){
        $(this).cycle('stop');
    }
).trigger('hover'); 
```

​ });

第一次悬停时，它很棒，工作正常。但是，如果您尝试再次悬停同一个，它只会经历一次淡入淡出，而不是再次循环。

有任何想法吗？

请忽略一些粗略的代码，在这里使用一个非常古老的主题，试图清理它！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-17T21:46:47.910

您正在使用“停止”并重新创建循环，因此您在对象上添加了几个循环。

你必须使用“暂停”和“恢复”。

示例如下：

```
var cycleConfigured = false;
$(document).ready(function() {

    $('.slideshow').hover(
        function() {
            if(cycleConfigured)
                $(this).cycle('resume');
            else
            {
                $(this).cycle({
                    fx:     'fade',
                    speed:   600,
                    timeout: 300,
                    pause:   0
                });
                cycleConfigured = true;
            }
        },
        function(){
            $(this).cycle('pause');
        }
    ).trigger('hover');

});​ 
```

该变量`cycleConfigured`将用于控制我们的循环插件，以检查它是否已经实例化。**或者**，您可以创建它`$(document).ready()`，然后像这样暂停它：

```
$(document).ready(function() {
    // configure the cycle plugin
    $('.slideshow').cycle({
         fx:     'fade',
         speed:   600,
         timeout: 300,
         pause:   0
    });
    $('.slideshow').cycle('pause'); // pause it right away.

    $('.slideshow').hover(
        function() {
                $(this).cycle('resume'); // start playing.
        },
        function(){
            $(this).cycle('pause'); // pause the slideshow.
        }
    ).trigger('hover');

});​ 
```

然后你需要做的就是不停地`$(this).cycle('pause')`使用`$(this).cycle('resume')`。

有什么让我知道。

# facebook-graph-api - FB Open graph：可以搜索对象字段吗？

> ID：10199177
> 
> 赞同：1
> 
> 时间：2012-04-17T21:07:45.737
> 
> 标签：facebook-graph-api, facebook-opengraph

有没有办法按字段搜索公共对象？例如：

[https://graph.facebook.com/search?q=conference&type=event&fields=venue](https://graph.facebook.com/search?q=conference&type=event&fields=venue&center=37.76,-122.427&distance=1000)

将为我提供与会议匹配的所有活动并显示它们的位置。有没有办法过滤旧金山的事件？

我试过类似的东西：

[https://graph.facebook.com/search?q=conference&type=event&fields=venue¢er=37.76,-122.427&distance=1000](https://graph.facebook.com/search?q=conference&type=event&fields=venue&center=37.76,-122.427&distance=1000)

但它似乎没有任何效果。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-10-11T04:55:44.320

我也检查了这个。没有任何方法可以在字段中搜索。**只有事件搜索仅适用于 Facebook 的事件标题，** *也不适用于描述*。有按纬度经度获取网址，但这也不适用于fb。我不知道他们什么时候会解决这个问题。

[https://graph.facebook.com/search?q=conference&type=event&fields=venue¢er=37.76,-122.427&distance=1000](https://graph.facebook.com/search?q=conference&type=event&fields=venue&center=37.76,-122.427&distance=1000)

# sql - 2个选择语句之间的tsql UNION

> ID：10199180
> 
> 赞同：-2
> 
> 时间：2012-04-17T21:07:52.453
> 
> 标签：sql

我有 2 个复杂的 sql 语句，但它们都有相同的列名。我正在尝试在两者之间建立一个联盟，但

```
 UNION 
```

说 UNION 附近的语法不正确。

不知道是否还有其他必要使它工作。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-18T07:57:56.783

因为我总是用分号 () 终止我的 SQL 语句，所以我有时会看到这个错误，例如

```
SELECT c 
  FROM T1;  <-- forgot to remove the terminator!
UNION
SELECT c 
  FROM T2; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-17T21:40:39.890

我通常用于联合的语法是：

```
select *
from 
(
  (<subquery 1>)
  union all
  (<subquery 2>)
) t 
```

`UNION ALL`比 更有效`UNION`，因为它不检查消除重复项。

# ruby - 从文件中读取到数组中并作为数组保存回文件中

> ID：10199183
> 
> 赞同：1
> 
> 时间：2012-04-17T21:08:01.757
> 
> 标签：ruby, arrays, file

```
results = open('names.txt').map { |line| line.split(' ')[0]}
p results
n = "Names_In_Array.txt"
outfile = File.new(n, 'w')
outfile.puts(results)
outfile.close 
```

我试图在每个名称后添加引号和逗号，所以我有一个数组格式（除了括号）。在当前状态下，它将其保存回纯字符串。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-17T21:27:30.923

听起来你想要一个像这样的文件：

`ben john joe adam mike bob`

并将其序列化为对象结构以供以后阅读。

如果是这种情况，我建议你看看[YAML](http://yaml.org/YAML_for_ruby.html)。它内置在 Ruby 中，使读取和写入数据结构变得容易。例如：

```
require 'yaml'
names = File.read('names.txt').split(' ')
File.open('Names_In_Array.txt') {|f| f << YAML::dump(names)} 
```

您生成的文件可以在后续程序中读取

```
names = YAML::load(File.open('Names_In_Array.txt')) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-17T21:24:25.587

如果理解正确：

```
outfile.puts(results.map{ |m| "\'#{m}\'" }.join(', ')) 
```

# css - Bootstrap CSS 如何：创建带有标题栏的 ContentBox

> ID：10199188
> 
> 赞同：1
> 
> 时间：2012-04-17T21:08:23.240
> 
> 标签：css, twitter-bootstrap

我想知道如何制作一个标题栏类似于此登录框的“ContentBox”：

[https://github.com/login?return_to=%2Fjshint%2Fjshint%2Farchives%2Fmaster](https://github.com/login?return_to=%2Fjshint%2Fjshint%2Farchives%2Fmaster)

有没有使用引导 css 的简单方法，还是我只需要想出自己的方法？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-04-17T21:23:00.560

您链接的页面不会显示已登录 GitHub 的任何人的登录信息，因此您可能希望下次更具体一些或发布屏幕截图。

话虽如此，我假设您只想要某种盒子上的蓝色渐变标题。这很简单，但是 Bootstrap 中没有内置这种性质的组件。

如果您想查看 GitHub（或任何其他站点）为创建您正在查看的效果所做的工作，可以使用许多工具来*检查*源代码。这是 Chrome 内置调试​​器 (F12) 的屏幕截图。

![在此处输入图像描述](../Images/dae61001a569375d1b4cf631986e0bde.png)

编辑：该图像被缩小太多了，这里仔细看看。 ![在此处输入图像描述](../Images/915fe183844689dfa1589313bc346462.png)

# ios - iOS Robby Hanson XMPP 框架资源

> ID：10199190
> 
> 赞同：1
> 
> 时间：2012-04-17T21:08:36.873
> 
> 标签：ios, xmpp, xmppframework

我正在使用 Robbie Hanson 的 XMPP 框架。我了解对于单个 jabber id，您可以拥有多个资源。如何添加多个资源？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-18T23:42:05.013

资源是标识与服务器的特定连接的字符串。要创建一个新的，您只需与服务器建立一个新连接。

# .htaccess - 子域正在接管对域的请求

> ID：10199195
> 
> 赞同：0
> 
> 时间：2012-04-17T21:09:13.920
> 
> 标签：.htaccess, mod-rewrite, subdomain

我通过**cPanel**`mobile`创建了一个名为我的网站的子域。我将移动设备重定向到该子域，但那里有 javascript 可以对实际域进行 AJAX 调用。我已经组织了这些调用去。但是，这些都没有通过，我怀疑这是因为它正在寻找my ，但该请求应该在**.htaccess**中重写为。**`website.com/mobile/...``...``/mobile`**`website.com/index.php?params=mobile/...`****

 ****这是.htaccess：

```
# redirect phones/tablets to mobile site
RewriteCond %{HTTP_USER_AGENT} "android|blackberry|ipad|iphone|ipod|iemobile|opera mobile|palmos|webos|googlebot-mobile" [NC]
RewriteCond %{HTTP_HOST} !mobile\.website\.com [NC]
RewriteCond %{REQUEST_URI} !^/mobile [NC]
RewriteRule ^(.*)$ http://www.mobile.website.com/$1 [L,R=302]

# not a file or directory
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
# website.com/home => website.com/index.php?params=home
RewriteRule ^(.+)(\?.+)?$ index.php?params=$1 [L,QSA] 
```

这适用于我的本地计算机，但不适用于实时服务器。我通过本地创建了一个 sudomain

```
<VirtualHost *:80>
    DocumentRoot "C:/Program Files (x86)/Apache Software Foundation/Apache2.2/htdocs/website/mobile"
    ServerName mobile.website.local
</VirtualHost> 
```

它运行良好：当我转到`mobile.website.local`or时`website.local/mobile`，我得到了移动站点，当我转到时，`website.local/mobile/users/login`我得到了 AJAX 请求的正确 JSON 输出。

我怎样才能让我的`mobile`子域保持活动状态，但要使用最后一个重写规则转发`/mobile/`请求？`website.com/mobile/...`

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-17T21:31:22.660

只需为您的 /mobile 添加特定的重定向，强制忽略文件或目录语句：

```
RewriteCond %{REQUEST_URI} ^/mobile [NC]
RewriteRule ^(.+)(\?.+)?$ index.php?params=$1 [L,QSA]

# redirect phones/tablets to mobile site
RewriteCond %{HTTP_HOST} !mobile\.website\.com [NC]
RewriteCond %{REQUEST_URI} !^/mobile [NC]
RewriteCond %{QUERY_STRING}  !^params=mobile(.*)$
RewriteRule ^(.*)$ http://www.mobile.website.com/$1 [L]

# not a file or directory
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
# website.com/home => website.com/index.php?params=home
RewriteRule ^(.+)(\?.+)?$ index.php?params=$1 [L,QSA] 
```

有什么让我知道，我会看看我是否可以提供帮助:)****

# javascript - 计算器结果奇怪

> ID：10199199
> 
> 赞同：0
> 
> 时间：2012-04-17T21:09:45.453
> 
> 标签：javascript, calculator

我的计算器输出了一些奇怪的结果，我已将其添加到 jsfiddle 供大家快速查看。

如果我把 4000 作为我的本金和 1 年，我放 1% 的利息，它会重复相同的本金和利息值，它也会每隔一个月跳过一次，但如果我把利率设置为 20%，它会开始倒计时本金和利息的结果正确。它有点奇怪。

我认为问题出在 intr 变量上，但我不太确定如何解决它。

```
 function totalF(){
    var body = document.body;
    var tbl = document.createElement('table');
    tbl.setAttribute('id', 'results');
    var tblBody = document.createElement('tbody');
    var tndiv = document.getElementById('tdcontainer');

    for (var j = 1; j < payments; j++){
    var row = document.createElement('tr');

        temp = round(principal);
        intr = round((monthly * payments) - principal);
    while(temp>0 && intr>0){    
        if(tndiv != null){
               var cell = document.createElement('td');
               var cell2 = document.createElement('td');
               var cell3 = document.createElement('td');            

               var ndiv =  round(temp);
               var intr = round((monthly * payments) - principal);
               var monthlyn = j;

                cell.innerHTML = ndiv;
                cell2.innerHTML = monthlyn;
                cell3.innerHTML = intr;

                row.appendChild(cell);
                row.appendChild(cell2);
                row.appendChild(cell3);

                j++;
            }

            temp-=monthly;
            intr-=monthly;
            tblBody.appendChild(row);

            }
        tbl.appendChild(tblBody);
        body.appendChild(tbl);
        tbl.setAttribute("border", "1");
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-17T21:13:53.783

```
Timestamp: 17.04.2012 23:13:22
Error: document.loandata.payment is undefined
Source File: http://fiddle.jshell.net/_display/
Line: 86 
```

改为使用`document.getElementById('loandata').payment`。对其他表单元素执行相同操作，甚至更好地使用`var form = document.getElementById('loandata');`然后`form.payment`等。

您还尝试在其他地方以无效的方式访问元素。如果一个元素有一个 ID，使用`document.getElementById('yourId')`来访问它，而不是`document.yourId`or `document.someElement.yourId`。

除此之外，您需要在分号后添加缺少的引号：

```
<div id="visualization" style="width: 750px;></div> 
```

# stocks - 下载完整的历史股票数据，包括退市公司？

> ID：10199200
> 
> 赞同：4
> 
> 时间：2012-04-17T21:09:45.533
> 
> 标签：stocks

1.  SO上有几篇文章指向下载历史股票报价的来源，但这些都是针对当前列出的符号。生成的数据集存在幸存者偏差。是否有所有历史数据的来源，包括退市公司，最好是免费/便宜的？我找到了一些来源，但它们通常价值数百美元或更多，需要使用一些 Windows 客户端软件进行安装，或者只是在粗略的网站上。（日终数据很好——我肯定要求盘中出价/要价太多了。）

2.  这些数据经销商又从哪里获取数据？数据的原始源存档是什么？（其中一些数据集可以追溯到 50 年代，所以我不认为答案是“他们只是自己记录。”）他们是否与交易所达成交易/交易所是否有/出售这个？数据是否存在于任何公共记录中？谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-27T02:29:15.073

Norgate Investor Services 是我找到的最便宜的，但它会花费你数百美元（但不到 1000 美元）。他们的来源是标准普尔。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-21T22:11:35.167

[QuantQuote 有无](http://quantquote.com)幸存者偏差的历史股票数据，但他们只提供分钟/秒/滴答的分辨率，而且价格为 $$。[他们](https://quantquote.com/historical-stock-data)还提供标准普尔 500 指数的免费每日分辨率数据。太糟糕了，雅虎在股票退市后没有保留股票数据。

# android - 滚动视图导致出现黑色背景

> ID：10199201
> 
> 赞同：1
> 
> 时间：2012-04-17T21:09:46.157
> 
> 标签：android, scrollview

我只是像这样添加一个滚动视图，屏幕加载后会出现黑色背景。

这个黑色区域位于周围 RelativeLayout 的左上角。当滚动视图定位时`android:layout_marginLeft="20dp" android:layout_marginTop="40dp"`，左侧 20dp 和顶部 40dp 为黑色，而其余灰色背景不受干扰。

这里是带有滚动视图的 xml 部分：

```
 <View
            android:id="@+id/emptyView"
            android:layout_width="match_parent"
            android:layout_height="2dp"
            android:layout_below="@+id/right1" />

        <RelativeLayout
            android:id="@+id/right2"
            android:layout_width="match_parent"
            android:layout_height="wrap_content"
            android:layout_below="@+id/emptyView" >

            <RelativeLayout
                android:id="@+id/right22"
                android:layout_width="match_parent"
                android:layout_height="wrap_content"
                android:layout_below="@+id/emptyView" >

                <ImageView
                    android:id="@+id/emptyView2"
                    android:layout_width="match_parent"
                    android:layout_height="2dp"
                    android:contentDescription="@string/anyStringValue" />

                <HorizontalScrollView
                    android:id="@+id/scrollView"
                    android:layout_width="fill_parent"
                    android:layout_height="520dp"
                    android:layout_marginLeft="20dp"
                    android:layout_marginTop="40dp"
                    android:background="#0000FF" >

                    <TextView
                        android:id="@+id/infoTxt"
                        android:layout_width="wrap_content"
                        android:layout_height="wrap_content"
                        android:background="#FF0000"
                        android:padding="10dp"
                        android:text="@string/Settings_infoTxt"
                        android:textColor="#000000"
                        android:textSize="20dp" />
                </HorizontalScrollView>
            </RelativeLayout>
        </RelativeLayout> 
```

我已经尝试在滚动视图顶部添加一个 emptyView 以及 2 个 RelativeLayouts。但无论如何，黑色区域不断出现。（顶部有/没有RelativeLayouts和空视图）

由于整个页面的背景是灰色的，这个黑色区域扭曲了整个屏幕。

我以前多次使用滚动视图，但从未遇到过这样的问题。我不知道是什么原因造成的。

**如何摆脱滚动视图引起的黑色区域？**

非常感谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-05T12:37:55.823

我遇到了几乎相同的问题，加载滚动视图时出现了一些黑色区域，触摸时消失了。我通过不设置滚动视图的背景颜色来解决它。设置内容视图的背景颜色应该足够了。

```
 //outer layout, where black shapes appear
    LinearLayout outer = new LinearLayout(context);
    outer.setBackgroundColor(Color.MAGENTA);

    ScrollView list = new ScrollView(context);
    list.setLayoutParams(new LayoutParams(100, 300));

    //        do not set the background color here, this causes the blak shapes
    //        list.setBackgroundColor(Color.CYAN);
    //        add an inner layout to the scrollView and set the background of the innerlayout
    LinearLayout linearLayout = new LinearLayout(context);
    linearLayout.setBackgroundColor(Color.CYAN);
    linearLayout.setLayoutParams(new LayoutParams(LayoutParams.FILL_PARENT,LayoutParams.FILL_PARENT));

    list.addView(linearLayout);
    outer.addView(list); 
```

# mod-wsgi - mod_wsgi 守护程序模式上的 apache 不产生小字符串

> ID：10199205
> 
> 赞同：0
> 
> 时间：2012-04-17T21:10:27.793
> 
> 标签：mod-wsgi

在尝试测试一些东西时，使用 Django + apache2 + mod_wsgi3.3。通过运行定期产生结果，我发现了两个不同的结果。在嵌入和守护程序模式之间。

当尝试使用嵌入式模式时，即没有 WSGIDaemonProcess，使用 WSGIProcessGroup 指令。下面提到的函数一个接一个地产生结果，每个数字都会在 2 秒的睡眠后打印在浏览器视图上。

```
def yielder(request):
    gen = testYielding()
    return HttpResponse(gen)

def testYielding():
    yield "3"
    time.sleep(2)
    yield "4"
    time.sleep(2)
    yield "5"
    time.sleep(2)
    yield "6"
    time.sleep(2)
    yield "7" 
```

尽管启用了 DaemonMode，但此视图会在 8 秒后整理完整的响应后响应数据，并将所有数字打印在一起并且不会产生相同的结果，一个接一个。

这种行为正确吗？有没有办法确保像嵌入式模式一样产生守护程序模式响应？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-18T01:13:10.893

守护进程中发生的刷新不会传输到正在执行代理的 Apache 子工作进程。因此，输出是否立即传递回客户端，部分取决于您注册的 Apache 输出过滤器。如果您有输出过滤器想要在刷新之前尝试缓冲响应数据，您将看到此问题。

因此，您应该仔细查看 Apache 输出过滤器的位置。如果您可以更改这些，那么您将别无选择，只能使用嵌入式模式。

# xslt - xslt在for-each中包装重复行不区分大小写

> ID：10199208
> 
> 赞同：0
> 
> 时间：2012-04-17T21:10:35.157
> 
> 标签：xslt, xslt-1.0

我正在尝试使用 XSLT 编写一个循环，以便它自动对具有相同 ID 但不区分大小写的所有项目进行分组。不幸的是，我试图解析的数据是客户端驱动的，所以我无法在加载之前更改它。不管这里是 XML 结构...

```
<Document>
    <Row>
        <Cell>ID</Cell>
    </Row>
    <Row>
        <Cell>hi</Cell>
    </Row>
    <Row>
        <Cell>Hi</Cell>
    </Row>
    <Row>
        <Cell>Hello</Cell>
    </Row>
    <Row>
        <Cell>Hello</Cell>
    </Row>
    <Row>
        <Cell>Hola</Cell>
    </Row>
</Document> 
```

这是我目前正在使用的 XSLT...

```
 <xsl:template match="Document">
    <NewDocument xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
      <xsl:for-each select="//Row[position() &gt; 1]/Cell[1][not(.=preceding::Row/Cell[1])]">
        <xsl:variable name="currentOrderID" select="." />
        <xsl:variable name="currentOrderGroup" select="//Row[Cell[1] = $currentOrderID]" />

        <MainID>
          <xsl:value-of select="$currentOrderGroup[1]/Cell[1]"/>
        </MainID>
        <IDs>
          <xsl:for-each select="$currentOrderGroup">
            <id>
              <xsl:value-of select="Cell[1]"/>
            </id>
          </xsl:for-each>
        </IDs>
      </xsl:for-each>
    </NewDocument>
  </xsl:template> 
```

这只是以 CaSe SeNSiTiVe 的方式按预期包装事情......我一直在尝试在那里使用翻译以使所有内容都大写，但是我似乎无法正确使用语法。

我试图在这里实现的结果是：

```
<NewDocument>
  <MainID>hi</MainID>
  <IDs>
    <id>hi</id>
    <id>Hi</id>
  </IDs>  
  <MainID>Hello</MainID>
  <IDs>
    <id>Hello</id>
    <id>Hello</id>
  </IDs>
  <MainID>Hola</MainID>
  <IDs>
    <id>Hola</id>
  </IDs>
</NewDocument> 
```

似乎找不到任何适合我需要的东西。谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-17T21:55:18.570

在 XSLT1.0 中，要将字符串转换为小写，您需要使用 xpath 中相当麻烦的**translate**函数。

```
translate(., 'ABCDEFGHIJKLMNOPQRSTUVWXYZ', 'abcdefghijklmnopqrstuvwxyz') 
```

此外，您的问题是分组问题，在 XSLT1.0 中，这通常意味着一种称为 Meunchian Grouping 的技术。为此，您首先定义一个键来查找您需要的组中的项目

```
<xsl:key 
   name="Cell" 
   match="Cell" 
   use="translate(., 'ABCDEFGHIJKLMNOPQRSTUVWXYZ', 'abcdefghijklmnopqrstuvwxyz')"/> 
```

在这里，我们根据其（小写）文本内容查找单元格。

要查找每个组中的第一个元素，您需要在 XML 中查找**Cell**元素，这也恰好是您的查找键中出现的第一个元素

```
<xsl:apply-templates 
   select="Row/Cell
   [generate-id() 
    = generate-id(
       key('Cell', 
         translate(., 'ABCDEFGHIJKLMNOPQRSTUVWXYZ', 'abcdefghijklmnopqrstuvwxyz'))[1])]"/> 
```

然后，当您匹配第一个元素时，您可以通过查看键来匹配组内的所有元素。

这是完整的 XSLT

```
<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
   <xsl:key name="Cell" match="Cell" use="translate(., 'ABCDEFGHIJKLMNOPQRSTUVWXYZ', 'abcdefghijklmnopqrstuvwxyz')"/>

   <xsl:template match="Document">
      <NewDocument>
         <xsl:apply-templates select="Row/Cell[generate-id() = generate-id(key('Cell', translate(., 'ABCDEFGHIJKLMNOPQRSTUVWXYZ', 'abcdefghijklmnopqrstuvwxyz'))[1])]"/>
      </NewDocument>
   </xsl:template>

   <xsl:template match="Cell">
      <MainID>
         <xsl:value-of select="."/>
      </MainID>
      <IDs>
         <xsl:apply-templates select="key('Cell', translate(., 'ABCDEFGHIJKLMNOPQRSTUVWXYZ', 'abcdefghijklmnopqrstuvwxyz'))" mode="group"/>
      </IDs>
   </xsl:template>

   <xsl:template match="Cell" mode="group">
      <id>
         <xsl:value-of select="."/>
      </id>
   </xsl:template>
</xsl:stylesheet> 
```

注意**mode**属性的使用，以区分匹配**Cell**元素的两个模板。

当应用于您的 XML 时，将输出以下内容：

```
<NewDocument>
   <MainID>ID</MainID>
   <IDs>
      <id>ID</id>
   </IDs>
   <MainID>hi</MainID>
   <IDs>
      <id>hi</id>
      <id>Hi</id>
   </IDs>
   <MainID>Hello</MainID>
   <IDs>
      <id>Hello</id>
      <id>Hello</id>
   </IDs>
   <MainID>Hola</MainID>
   <IDs>
      <id>Hola</id>
   </IDs>
</NewDocument> 
```

请注意，我不确定如何处理以**ID**作为值的单元格，所以我把它留在里面。如果你确实想排除它，只需将此行添加到 XSLT

```
<xsl:template match="Cell[. = 'ID']" /> 
```

# browser - Windows 身份验证提示用户名字段自动填充且无法更改

> ID：10199215
> 
> 赞同：0
> 
> 时间：2012-04-17T21:11:13.567
> 
> 标签：browser, windows-7, sharepoint-2010, internet-explorer-8, windows-authentication

我有一个使用 Windows 身份验证对其用户进行身份验证的网站。通常，当用户在 IE 浏览器上访问站点时，用户名字段会填充计算机域名和用户名。这通常是不正确的，用户输入正确的用户名和密码即可访问该站点。

我现在在 Windows 7 IE8（我相信）上有一个用户，并且凭据提示中的用户名字段正在自动填充 domain\userName，但用户名不正确，我们无法更改。因此，用户无法登录该站点。有谁之前经历过这个吗？有谁知道为什么用户名字段不能更改？我尝试过的解决方案：

1.  清除缓存和存储的表单数据/密码等
2.  站点位于用户信任的站点中。所以我让用户将设置更改为“提示输入用户名和密码”，但提示仍然出现自动填充的用户名并且不允许她更改。

我以前从未遇到过这种情况。我们的用户在登录时没有任何问题，它只是一个刚刚设置并运行 Windows 7 的公司位置（公司的其余部分在 Windows XP 下）如果重要，这是一个 sharepoint 2010 Web 应用程序对此有任何帮助将不胜感激，因为我有一整组用户都遇到了这个问题。我愿意打赌这在不同的浏览器中不会成为问题，但出于应用程序兼容性的原因，他们需要能够使用 IE。

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-19T00:10:47.503

我能够通过执行以下操作来修复它：

转到开始，控制面板，用户帐户，然后单击管理您的凭据，并查找您的站点的凭据，如果它们在那里修改并“从保险库中删除”（我想您可以将它们编辑为正确的凭据，但我只是删除它并没有提示她）。

她在那里存储了错误的凭据。我不确定为什么从 Internet 选项中清除缓存和密码不起作用，但确实如此。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-07-22T14:50:23.230

我遇到了无法更改存储凭据的域的用户的问题。这是我能在网上找到的唯一一个与我的问题很接近的项目。用户看到表单中自动输入了“user-pcdomain\localusername”。他试图用“workdomain\workusername”更正它，但收到一条消息“请输入用户名和密码”。最终我们意识到他的系统正在发送“user-pcdomain\workdomain”作为他的用户名。我从来没有见过这样的登录失败。

在他的情况下，他没有存储他的凭据，但需要为他需要访问的所有域添加凭据 - “workdomain\workusername”。

关键是 - 扩展答案 - IE 或 Windows 7 或两者都会在极少数情况下错误地存储凭据，并且解决方案在使用管理您的凭据添加\编辑\删除凭据方面很有创意

# objective-c - How should I handle ASIHTTPRequest asynchronous call in iOS?

> ID：10199216
> 
> 赞同：0
> 
> 时间：2012-04-17T21:11:17.827
> 
> 标签：objective-c, ios, cocoa-touch, ios5

I'm trying to use ASIHTTPRequest. I need request be called in Asynchronous. What I'm trying to do, call this method from my Application, and be able to RETURN BOOL value, was request successed, or not. I was able to do it in Synchronous calls. How is it possible to do? I need somehow, return value to my application, was that call successed or not. My request calls, are in seperate classed, I want keep logic seperate from application. That's why I need be able return somehow value. Thanks for help!

```
- (BOOL)sendRequest
{
         NSURL* url = [NSURL URLWithString:ServerApiURL];
    __block ASIHTTPRequest* request = [ASIHTTPRequest requestWithURL:url];

    [request setCompletionBlock:^
    {

            if ([request responseStatusCode] == 200)
            {
              //NEED SOMEHOW RETURN TRUE IF SUCESSED    
            }       
    }];

    [request setFailedBlock:^
    {
       //NEED RETURN FALSE  
    }];

    [request startAsynchronous];
}} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-17T21:37:14.280

Since you are making asynchronous call, the method can not return a value right away, what you can do instead is to call a callback method in your completion and fail block. For instance, `[delegate requestFinishedWithSuccess:YES]` or post a notification.

# mysql - MySQL：如何将多个查询组合成一个使用具有不同条件的同一张表的查询？

> ID：10199218
> 
> 赞同：1
> 
> 时间：2012-04-17T21:11:30.150
> 
> 标签：mysql, sql

我有几个类似的查询，仅在条件子句中有所不同。我正在尝试将所有查询合并为一个。

第一个查询如下所示：

### 第一个查询：

```
SELECT pages.title, 
       YEAR(page_revisions.date) AS year,
       MONTH(page_revisions.date) AS MONTH, 
       COUNT(revid) AS Cadmin_edits 
FROM page_revisions 
    INNER JOIN pages ON page_revisions.title=pages.title
WHERE userid!=0 AND admin=1 AND pages.ns=0 
GROUP BY year, MONTH 
ORDER BY page_revisions.title, year, MONTH;

+--------------+------+-------+--------------+
| title        | year | MONTH | Cadmin_edits |
+--------------+------+-------+--------------+
| Bangalore    | 2002 |    11 |            4 |
| Bangalore    | 2003 |     2 |            2 |
| Bangalore    | 2003 |     5 |            1 |
| Bangalore    | 2003 |     6 |            6 |
| Bangalore    | 2003 |     8 |            4 |
| Bangalore    | 2003 |     9 |            3 |
| Bangalore    | 2003 |    10 |            2 |
| Bart Simpson | 2002 |     9 |            4 |
| Bart Simpson | 2007 |     3 |           33 |
| Bart Simpson | 2007 |     7 |           15 |
| Bart Simpson | 2008 |    11 |           19 |
| Batman       | 2001 |    12 |            5 | 
```

第二个查询非常相似，唯一的区别在于条件 wikip_member=1 而不是 admin。

### 第二个查询：

```
SELECT pages.title, 
       YEAR(page_revisions.date) AS year, 
       MONTH(page_revisions.date) AS MONTH, 
       COUNT(revid) AS Wpart_edits 
FROM page_revisions 
    INNER JOIN pages ON page_revisions.title=pages.title
WHERE userid!=0 AND wikip_member=1 AND pages.ns=0 
GROUP BY year, MONTH
ORDER BY page_revisions.title, year, MONTH;

+------------------------------------------+------+-------+-------------+
| title                                    | year | MONTH | Wpart_edits |
+------------------------------------------+------+-------+-------------+
| 1906 Florida Keys hurricane              | 2011 |    10 |         266 |
| 1906 Florida Keys hurricane              | 2011 |    11 |         108 |
| 1906 Florida Keys hurricane              | 2012 |     2 |          66 |
| 1969 race riots of Singapore             | 2007 |     6 |         124 |
| 1969 race riots of Singapore             | 2008 |     2 |         143 |
| 1969 race riots of Singapore             | 2009 |     1 |         151 |
| 1980 Winter Olympics                     | 2003 |     8 |           3 |
| 1980 Winter Olympics                     | 2003 |    10 |           7 |
| 1980 Winter Olympics                     | 2004 |     3 |          16 |
| Babe Ruth                                | 2004 |     5 |          22 |
| Babe Ruth                                | 2004 |     7 |          21 |
| Bangalore                                | 2002 |    11 |           6 |
| Bangalore                                | 2003 |     2 |           2 |
| Bangalore                                | 2004 |     2 |           9 | 
```

基本上我需要的输出看起来像这样：

### 预期输出：

```
+------------------------------------------+------+-------+--------+-------+
| title                                    | year | MONTH | Cadmin | Wpart |
+------------------------------------------+------+-------+--------+-------+
| 1906 Florida Keys hurricane              | 2011 |    10 |     0  |   266 |
| 1906 Florida Keys hurricane              | 2011 |    11 |     0  |   108 |
| 1906 Florida Keys hurricane              | 2012 |     2 |     0  |    66 |
| 1969 race riots of Singapore             | 2007 |     6 |     0  |   124 |
| 1969 race riots of Singapore             | 2008 |     2 |     0  |   143 |
| 1969 race riots of Singapore             | 2009 |     1 |     0  |   151 |
| 1980 Winter Olympics                     | 2003 |     8 |     0  |     3 |
| 1980 Winter Olympics                     | 2003 |    10 |     0  |     7 |
| 1980 Winter Olympics                     | 2004 |     3 |     0  |    16 |
| Babe Ruth                                | 2004 |     4 |     0  |     7 |
| Babe Ruth                                | 2004 |     8 |     0  |    21 |
| Bangalore                                | 2002 |    11 |     4  |     6 |
| Bangalore                                | 2003 |     2 |     2  |     2 |
| Bangalore                                | 2003 |     5 |     1  |     0 |
| Bangalore                                | 2003 |     6 |     6  |     0 |
| Bangalore                                | 2003 |     8 |     4  |     0 |
| Bangalore                                | 2003 |     9 |     3  |     0 |
| Bangalore                                | 2003 |    10 |     2  |     0 |
| Bangalore                                | 2004 |     2 |     0  |     9 | 
```

这将是查询的组合。基本上获取每个月的修订的 COUNT 并在没有找到与该月的条件匹配的修订时显示 0。我尝试了UNION、SUBSELECT等几种方法，但都没有成功。UNION 似乎没有按预期工作，SUBSELECT 只运行了 128 行需要 5 个小时。

### 联合尝试：

```
SELECT pages.title, 
       YEAR(page_revisions.date) AS year,
       MONTH(page_revisions.date) AS MONTH, 
       COUNT(revid) AS Cadmin, 
       null AS Wpart 
FROM page_revisions 
    INNER JOIN pages ON page_revisions.title=pages.title 
WHERE userid!=0 AND admin=1 AND pages.ns=0 
UNION 
SELECT pages.title, 
       mid( page_revisions.date, 1, 4) AS year, 
       mid(page_revisions.date, 6, 2) AS MONTH, 
       null as Cadmin,
       COUNT(revid) AS Wpart_edits 
FROM page_revisions 
    INNER JOIN pages ON page_revisions.title=pages.title 
WHERE userid!=0 AND wikip_member=1 AND pages.ns=0 
GROUP BY year, MONTH 
ORDER BY title, year, MONTH; 
```

### 子选择尝试：

```
SELECT pages.title, 
       YEAR(page_revisions.date) AS year,
       MONTH(page_revisions.date) AS MONTH, 
       (SELECT COUNT(revid) AS Cadmin_edits FROM page_revisions WHERE YEAR(page_revisions.date)=year and MONTH(page_revisions.date)= month and userid!=0 AND admin=1) 
FROM page_revisions 
    INNER JOIN pages ON page_revisions.title=pages.title
WHERE pages.ns=0 
GROUP BY year, MONTH 
ORDER BY pages.title, year, MONTH; 
```

任何为我指明正确方向的帮助将不胜感激。这是我的最后一次演讲，该演讲将于周五到期，这是我需要将所有内容包装在一起的最后一个查询。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-17T21:24:46.783

在 MySql（和许多其他 SQL 方言）中，您可以加入子选择。这应该会执行得更好，因为引擎将运行一次查询以生成单个结果集，而不是在每行初始结果中运行一次作为 select 子句一部分的子查询。

所以，你会尝试这样的事情：

```
select COALESCE(a.title, b.title), 
   COALESCE(a.year, b.year), 
   COALESCE(a.month, b.month),
   COALESCE(a.Cadmin_edits, 0),
   COALESCE(b.Wpart_edits, 0)
FROM (SELECT pages.title, 
      YEAR(page_revisions.date) AS year,
      MONTH(page_revisions.date) AS MONTH, 
      COUNT(revid) AS Cadmin_edits 
   FROM page_revisions 
   INNER JOIN pages ON page_revisions.title=pages.title
   WHERE userid!=0 
      AND admin=1 
      AND pages.ns=0 
   GROUP BY year, MONTH 
   ORDER BY page_revisions.title, year, MONTH) a
FULL JOIN (SELECT pages.title, 
      YEAR(page_revisions.date) AS year, 
      MONTH(page_revisions.date) AS MONTH, 
      COUNT(revid) AS Wpart_edits 
   FROM page_revisions 
   INNER JOIN pages ON page_revisions.title=pages.title 
   WHERE userid!=0 
      AND wikip_member=1 
      AND pages.ns=0 
   GROUP BY year, MONTH 
   ORDER BY page_revisions.title, year, MONTH) b 
ON a.title = b.title AND a.year = b.year AND a.month = b.month
/*order the full results as you please*/ 
```

如果这是 Oracle 或 Sql Server，我会为子查询推荐几个公用表表达式，因为它们允许您从主查询中删除子查询，从而使完整查询更易于理解。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-17T21:20:30.483

我想`WHERE userid!=0 AND(admin=1 OR wikip_member=1)`如果我得到你需要的正确的话，你就可以做到。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-17T21:46:41.983

```
SELECT pages.title, 
YEAR(page_revisions.date) AS iYear,
MONTH(page_revisions.date) AS iMonth, 
COUNT(revid) AS Cadmin_edits,
0 AS Wpart_edits 
FROM page_revisions 
INNER JOIN pages 
ON page_revisions.title=pages.title
WHERE userid <> 0 
AND [admin] = 1 
AND pages.ns = 0 
GROUP BY pages.title, YEAR(page_revisions.date), MONTH(page_revisions.date) 

UNION ALL   

SELECT pages.title, 
YEAR(page_revisions.date), 
MONTH(page_revisions.date),
    0,
    COUNT(revid)
FROM page_revisions 
INNER JOIN pages 
    ON page_revisions.title=pages.title
WHERE userid <> 0 
AND wikip_member = 1 
AND pages.ns = 0 
GROUP BY pages.title, YEAR(page_revisions.date), MONTH(page_revisions.date)

ORDER BY title, iYear, iMonth; 
```

# go - 去模板函数

> ID：10199219
> 
> 赞同：31
> 
> 时间：2012-04-17T21:11:41.593
> 
> 标签：go, go-templates

当我尝试使用`Funcs`和`FuncMap`. 以下代码按预期工作：

```
buffer := bytes.NewBufferString("")

funcMap := template.FuncMap{
    "label": strings.Title,
}

t, _ := template.New("alex").Funcs(funcMap).Parse("{{label \"alex\"}}") 

t.Execute(buffer, "")

return string(buffer.Bytes()) //=> "Alex" 
```

但是当我尝试将模板放入文件时，它不起作用（`Execute()`说：）`"alex" is an incomplete or empty template`：

```
t, _ := template.New("alex").Funcs(funcMap).ParseFiles("template.html") 
```

使用模板.html：

```
{{label \"alex\"}} 
```

知道为什么吗？这是一个错误吗？有没有更简单的方法在模板中使用方法/函数？

* * *

## 回答 #1

> 赞同：34
> 
> 时间：2012-04-17T22:31:37.037

ParseFiles 可能会使用更好的文档。一个模板对象中可以有多个模板，每个模板都有一个名称。如果您查看 ParseFiles 的实现，您会发现它使用*文件名*作为模板对象内部的模板名称。因此，将您的文件命名为与模板对象相同的名称（可能通常不实用），或者使用 ExecuteTemplate 而不是 Execute。

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2014-01-01T20:08:03.323

索尼娅的回答在技术上是正确的，但让我更加困惑。以下是我最终让它工作的方式：

```
t, err := template.New("_base.html").Funcs(funcs).ParseFiles("../view/_base.html", "../view/home.html")
if err != nil {
    fmt.Fprint(w, "Error:", err)
    fmt.Println("Error:", err)
    return
}
err = t.Execute(w, data)
if err != nil {
    fmt.Fprint(w, "Error:", err)
    fmt.Println("Error:", err)
} 
```

模板的名称是模板的裸文件名，而不是完整的路径。`Execute`将执行默认模板，只要它被命名为匹配，所以不需要使用`ExecuteTemplate`.

在这种情况下，`_base.html`文件是最外层的容器，例如：

```
<!DOCTYPE html>
<html><body>
<h1>{{ template "title" }}</h1>
{{ template "content" }}
</body></html> 
```

while`home.html`定义了具体的部分：

```
{{ define "title" }}Home{{ end }}

{{ define "content" }}
Stuff
{{ end }} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2020-02-17T06:13:04.457

您需要首先解析所有文件并执行它们。您不能直接访问所有文件。

# php - 有时 fputs() 或 fwrite() 会编码 html 特殊字符吗？

> ID：10199223
> 
> 赞同：0
> 
> 时间：2012-04-17T21:11:49.587
> 
> 标签：php, html, string, character-encoding, htmlspecialchars

我正在将包含 html 内容的字符串输出到 html 文件，但在 html 文件中，html 特殊字符被编码（例如***`"`***在 中***`\&quot;`***）。在使用 write 函数之前，我什至使用过 htmlspecialcharacters_decode。奇怪的是，在我的计算机上，字符没有被编码，而在某些服务器上上传的字符是被编码的。我该如何处理这个问题？

期待感谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-17T22:51:11.333

您可能正在遭受[魔术行情的困扰](http://www.php.net/manual/en/security.magicquotes.what.php)

检查你 phpinfo();

要清除 Magic Quotes，请查看 php.net 上的讨论： [http ://www.php.net/manual/en/function.stripslashes.php](http://www.php.net/manual/en/function.stripslashes.php)

示例 (c) jeremysawesome：

```
array_walk_recursive($_POST, create_function('&$val', '$val = stripslashes($val);')); 
```

# python - 在使用 open() 获得的流上使用 io.BufferedReader？

> ID：10199226
> 
> 赞同：20
> 
> 时间：2012-04-17T21:11:58.433
> 
> 标签：python, io, python-2.7, buffered

我想使用缓冲流，因为我想使用一种`peek()`方法来窥视，但将我的流与另一种需要类似文件的对象的方法一起使用。（我会使用`seek()`但可能必须处理不支持随机访问的管道输入 I/O。）

但是这个测试用例失败了：

AttributeError：“文件”对象没有属性“_checkReadable”

```
import sys
import io

srcfile = sys.argv[1]
with open(srcfile, 'rb') as f:
    fbuf = io.BufferedReader(f)
    print fbuf.read(20) 
```

发生了什么事，我该如何解决？我认为 BufferedReader 旨在缓冲流。如果是这样，为什么该`open()`函数不返回与其兼容的东西？

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2012-04-17T21:34:19.037

`print`从您的陈述来看，您使用的是 Python 2。在该版本上， a`file`不是`BufferedReader`构造函数的有效参数：

> 在 Python 2.x 中，这是作为内置`file`对象的替代方案，但在 Python 3.x 中，它是访问文件和流的默认接口。([一](http://docs.python.org/library/io.html))

您应该`io.open`改用：

```
>>> f = io.open(".bashrc", "rb") 
```

如果这样做，则无需将其显式包装在 a 中，`BufferedReader`因为这正是`io.open`默认返回的内容：

```
>>> type(f)
<type '_io.BufferedReader'> 
```

有关详细信息，请参阅[其文档](http://docs.python.org/library/io.html#io.open)；有一个`buffering`控制缓冲的参数。

在 Python 3`open`中，`io.open`两个 I/O 库已合并为一个。似乎它`io`被添加到 Python 2.6 主要是为了向前兼容。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-04-17T21:17:58.210

您可以通过将[`buffering`参数](http://docs.python.org/library/functions.html#open)传递给 open 来设置缓冲量（以字节为单位）：

```
import sys

srcfile = sys.argv[1]
with open(srcfile, 'rb', buffering=30) as f:
    print(f.peek(30))
    print(f.read(20)) 
```

这是一个`BufferedReader`：

```
>>> with open("test.txt", 'rb', buffering=30) as f:
...     type(f)
<class '_io.BufferedReader'> 
```

请注意，默认情况下，它被缓冲到`1`- 行缓冲。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2016-06-29T16:23:37.967

在Python2中，如果你必须使用`file`返回的对象`open`（或者例如一些你不能修改的模块例程提供的对象），你可以使用构造函数获取的文件描述符，然后将对象传递给`fileno()`构造函数。`io.FileIO``io.FileIO``io.BufferedReader`

因此，您的示例代码可以重写如下：

```
import sys
import io

srcfile = sys.argv[1]
with open(srcfile, 'rb') as f:
    fio  = io.FileIO(f.fileno())
    fbuf = io.BufferedReader(fio)
    print fbuf.read(20) 
```

# ruby-on-rails - 不会与应用程序代码混淆的 Rails 3 CMS

> ID：10199227
> 
> 赞同：0
> 
> 时间：2012-04-17T21:12:04.207
> 
> 标签：ruby-on-rails, content-management-system

对于客户，我必须使用我的 Rails 3.2.2 应用程序构建一个 CMS。问题是，该应用程序已准备就绪。没有CMS，就是这样。我只需要实现一个 CMS，但是当我尝试使用 RefineryCMS（按照 Refinery 自己的说明）执行此操作时，它不起作用，因为 Refinery 没有拾取我制作的 CSS 和页面。

我应该怎么办？现有的 Rails 应用程序是否还有另一个有用的 CMS 插件？还是我应该自己构建一个 CMS，使用诸如omni-auth 之类的东西？如果是这样，是否有构建此类 CMS 的教程？

非常感谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-17T21:30:07.987

看看[copycopter](http://railscasts.com/episodes/336-copycopter)，它可能适合您的需求。

# php - 新关键字与创建实例

> ID：10199228
> 
> 赞同：2
> 
> 时间：2012-04-17T21:12:06.553
> 
> 标签：php, oop, instantiation

在一些开源代码上，他们为什么使用：

```
$router = Cfw_Router::getInstance(); 
```

而不是仅仅使用

```
$rounter = new Cfw_Router(); 
```

它有优点吗？

* * *

`getInstance()`：

```
public static function getInstance() {
    if (null === self::$__instance) {
        self::$__instance = new self();
    }
    return self::$__instance;
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-17T21:14:05.067

第一次使用称为 a [`singleton`](http://en.wikipedia.org/wiki/Singleton_pattern)。它确保只存在一个对象实例。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-04-17T21:14:07.093

他们正在使用[单例模式](http://en.wikipedia.org/wiki/Singleton_pattern)。基本上，它只允许在任何给定时间存在一个实例。然而，它有时可以用来提供一个全局变量，这在设计中并不总是最好的（参见上面链接中的批评）。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-04-17T21:16:57.760

This is because the singleton pattern. With getInstance, only 1 instance of the object will be created in the whole program, while with new, a new object instance is created in each call. That can be useful for example in a database handling object. You don't want to have multiple object instances in your program (and multiple connections) but instead you want only one instance of database handler and connection across all your program.

# javascript - 带块的常量声明

> ID：10199229
> 
> 赞同：7
> 
> 时间：2012-04-17T21:12:15.273
> 
> 标签：javascript, variable-assignment, gecko, spidermonkey, destructuring

最近我正在研究 Firefox [Add-on Builder](https://addons.mozilla.org/en-US/developers/builder) SDK 源代码，并偶然发现了这样的常量声明：

```
const { getCodeForKey, toJSON } = require("../../keyboard/utils"); 
```

我可以找到有关[CommonJS Modules](http://www.commonjs.org/specs/modules/1.0/)的信息，但是这个作业的剩余部分让我有点困惑，因为它必须是特定于语言的，我无法在谷歌上搜索任何内容。

有人可以向我指出一些解释这里发生了什么的规范/草案吗？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-04-18T06:06:58.110

这是一个[解构赋值](https://developer.mozilla.org/en/New_in_JavaScript_1.7#Destructuring_assignment_%28Merge_into_own_page.2Fsection%29)，目前仅由 Firefox 使用的 SpiderMonkey JavaScript 引擎实现。以下是它如何与数组一起使用：

```
// Destructuring assignment
[a, b] = foo;

// Equivalent code
a = foo[0];
b = foo[1]; 
```

以下是它与对象的工作方式：

```
// Destructuring assignment
{a, b} = foo;

// Equivalent code
a = foo.a;
b = foo.b; 
```

一个稍微复杂一点的例子：

```
// Destructuring assignment
{name: a, address: {line1: b}} = foo;

// Equivalent code
a = foo.name;
b = foo.address.line1; 
```

所以你的代码示例相当于：

```
var utilsExports = require("../../keyboard/utils");
const getCodeForKey = utilsExports.getCodeForKey;
const toJSON = utilsExports.toJSON; 
```

它只是一种更方便的编写方式。

# android - Android 在 OpenGL|ES 中冻结（CPU 可能已固定。再试一次。）

> ID：10199231
> 
> 赞同：37
> 
> 时间：2012-04-17T21:12:20.193
> 
> 标签：android, c++, opengl-es-2.0

不久前，我遇到了`eglSwapBuffers`冻结手机的问题，设备日志中显示以下消息：

```
W/SharedBufferStack( 1110): waitForCondition(LockCondition) timed out (identity=28, status=0). CPU may be pegged. trying again. 
```

我在网上看到了关于这个问题的讨论，但我发现唯一有效的解决方案是调用`glFinish`after `eglSwapBuffers`。然而，这种解决方案会导致帧率下降 10 到 20 倍，这远远不能接受。

问题已打开，可以在[此处找到](http://code.google.com/p/android/issues/detail?id=6478)

有人评论说使用方形纹理消除了这个问题。我最初以为他指的是二次幂纹理，但在确保我没有使用任何非二次幂纹理并且没有摆脱这个问题之后，我开始认为他可能实际上是指具有匹配的纹理宽度和高度？

我正在使用 Android 2.3.3 测试 HTC Desire。有人评论说未来的版本应该已经解决了这个问题，但是 2.3.3 安装在这么多设备上，我们不能忽视它。

无论如何，有人对此有任何想法吗？我们非常接近发布一个标题，这个问题正在威胁到进度。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-17T11:35:59.700

我也遇到过这个问题，我以前重新安装了应用程序，它对我有用。如果没有，那么只需重启你的设备。这个问题与 OpenGLES 的内部问题有关。你可以参考这个链接： [Android "cpu may被盯住”的错误](https://stackoverflow.com/questions/8458404/android-cpu-may-be-pegged-bug)

# python - sphinx 可以链接到不在根文档下的目录中的文档吗？

> ID：10199233
> 
> 赞同：106
> 
> 时间：2012-04-17T21:12:24.890
> 
> 标签：python, python-sphinx, symlink, toctree

我正在使用 Sphinx 来记录一个非 Python 项目。我想`./doc`在每个子模块中分发文件夹，其中包含`submodule_name.rst`用于记录该模块的文件。然后，我想将这些文件吸入主层次结构中，为整个设计创建规范。

IE：

```
Project
  docs
    spec
      project_spec.rst
      conf.py
  modules
    module1
      docs
        module1.rst
      src
    module2
      docs
        module2.rst
      src 
```

我试图在主`project_spec.rst`文档目录树中包含文件，如下所示：

```
.. toctree::
   :numbered:
   :maxdepth: 2

   Module 1 <../../modules/module1/docs/module1> 
```

但是，此错误消息会导致：

> 警告：toctree 包含对不存在文档 u'modules/module1/docs/module1' 的引用

不能以`../`某种方式在文档路径中使用吗？

更新：添加了 conf.py 位置

更新：除了下面的包含技巧之外，这仍然是（2019 年）不可能的。有一个未解决的问题不断推进：[https ://github.com/sphinx-doc/sphinx/issues/701](https://github.com/sphinx-doc/sphinx/issues/701)

* * *

## 回答 #1

> 赞同：127
> 
> 时间：2013-06-20T14:58:10.937

是的你可以！

代替符号链接（在 Windows 上不起作用），创建一个存根文档，其中除了`.. include::`指令之外什么都没有。

我在尝试链接到源代码树顶部的 README 文件时遇到了这个问题。我将以下内容放在一个名为的文件中`readme_link.rst`：

```
.. include:: ../README 
```

然后在 中`index.rst`，我使目录树看起来像：

```
Contents:

.. toctree::
   :maxdepth: 2

   readme_link
   other_stuff 
```

现在，我的索引页面上有一个指向我的发行说明的链接。

感谢[http://reinout.vanrees.org/weblog/2010/12/08/include-external-in-sphinx.html](http://reinout.vanrees.org/weblog/2010/12/08/include-external-in-sphinx.html)的建议

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2012-04-18T13:48:33.420

似乎答案是否定的，目录树中列出的文档必须位于[源目录](http://sphinx.pocoo.org/glossary.html#term-source-directory)中，即包含您的[主文档](http://sphinx.pocoo.org/glossary.html#term-master-document)和`conf.py`（以及任何子目录）的目录。

来自[sphinx-dev 邮件列表](http://comments.gmane.org/gmane.comp.python.sphinx.devel/4237)：

> 在 STScI，我们在 Sphinx 中为各个项目编写文档，然后还生成一个“主文档”，其中包括（使用 toctree）许多其他项目特定的文档。为此，我们在主文档的 doc 源目录中创建指向项目的 doc 源目录的符号链接，因为 toctree 似乎真的不想包含 doc 源树之外的文件。

`shutil`因此，您可以尝试将符号链接添加到目录中的所有模块，而不是使用复制文件`Project/docs/spec`。如果您创建一个符号链接，`Project/modules`那么您将在您的目录树中简单地引用这些文件，`modules/module1/docs/module1`等等。

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2017-08-30T06:10:24.937

在 conf.py 中，使用 sys.path 和 os.path 添加系统的相对路径

例如：

```
import os
import sys

sys.path.insert(0, os.path.abspath('..'))
sys.path.insert(0, os.path.abspath('../../Directory1'))
sys.path.insert(0, os.path.abspath('../../Directory2')) 
```

然后像往常一样使用你的 index.rst，引用同一目录中的 rst 文件。所以在我本地 Sphinx 文件夹中的 index.rst 中：

```
Contents:

.. toctree::
   :maxdepth: 4

   Package1 <package1.rst>
   Package2 <package2.rst>
   Package3 <package3.rst> 
```

然后在 package1.rst 中，你应该可以正常引用相关包。

```
Package1 package
=====================

Submodules
----------

Submodule1 module
----------------------------------

.. automodule:: file_within_directory_1
    :members:
    :undoc-members:
    :show-inheritance:

Submodule1 module
----------------------------------

.. automodule:: file_within_directory_2
    :members:
    :undoc-members:
    :show-inheritance: 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2020-04-13T18:30:26.740

我解决了我非常相似的问题，但我想包含一个外部 jupyter 笔记本。我已经安装了 nbsphinx，但我无法让它工作。 **什么没有奏效：**

1.  我有我想在路径中包含根目录的目录：

    conf.py：

    `import os import sys sys.path.insert(...`

2.  使用该`.. include:: directive`文件已包含在文档中，但原样。

最后**解决**问题的是安装包[nbsphinx-link](https://github.com/vidartf/nbsphinx-link)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2015-09-07T08:09:17.153

也可以将 sphinx 配置为在根目录中仅包含 index.rst 文件，而在 Project/docs 中包含所有其他 sphinx 内容：

对于 Windows，我将所有 sphinx 文件和目录（index.rst 除外）移动到 docs/ 并更改：

`docs/make.bat`： 改变

```
set ALLSPHINXOPTS=-d %BUILDDIR%/doctrees %SPHINXOPTS%  . 
```

到

```
set ALLSPHINXOPTS=-d %BUILDDIR%/doctrees %SPHINXOPTS%  -c . .. 
```

`docs/conf.py`： 添加

```
sys.path.insert(0, os.path.abspath('..')) 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2021-03-10T07:12:25.400

不需要创建存根文件的另一种技术是在您的目录树根中使用[绝对引用](https://www.sphinx-doc.org/en/master/usage/restructuredtext/directives.html?highlight=toctree#directive-toctree)（以 开头），并在调用时将源目录设置为最低的共同祖先。示例目录布局：`/``sphinx-build`

```
/path/to/common/ancestor
├── a
│   └── foo.rst
├── b
│   ├── bar.rst
│   ├── x
│   │   └── index.rst
│   └── y
│       └── boz.rst
└── c
    └── baz.rst 
```

并且`b/x/index.rst`：

```
.. toctree::
   /a/foo
   /b/bar
   /b/y/boz
   /c/baz 
```

您的`sphinx-build`命令可能如下所示：

```
sphinx-build -c <confdir> -b html -D masterdoc=b/x/index /path/to/common/ancestor <outdir> 
```

我用 sphinx 测试了这个`3.0.2`。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2021-05-06T12:33:19.903

我的回答本质上是@Dan Menes，但是对于 Myst 解析器而不是 reStructured。

我更愿意将此作为评论添加到@Dan Menes 答案，因为它属于那里，但评论不允许我进行格式化，Myst 语法对换行符敏感，并且评论的字符数有限。因此，我将其作为单独的答案发布，即使它与现有答案相关。

要包含在 Myst 中，您必须对其进行稍微不同的格式化：

```
```{include} ../main/post_installation_windows.md
``` 
```

它也可以包装自己来做 reStructured 标记（然后包含的文件将被视为以重组方式编写）：

```
```{eval-rst}
.. include:: snippets/include-rst.rst
``` 
```

但是，使用本机 Myst 语法更容易。它具有更好的功能，例如，仅包含文件将无法正确解析包含文件中的任何引用，而 include-literal 应该：

```
```{include-literal} ../../example.md
:language: md
``` 
```

你可能会发现包含一个简单的文档是可以的，但是包含一个有很多引用的复杂文档会导致更多的麻烦，所以我推荐实验性的`include-literal`（从版本 0.12.7 开始）

参考： [https ://myst-parser.readthedocs.io/en/latest/using/howto.html](https://myst-parser.readthedocs.io/en/latest/using/howto.html)

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2012-04-18T12:46:23.730

一种解决方案，如果真的不可能使用备份的相对链接，`../`我可以使用`shutil`将文件复制到规范中的规范文件夹树中`conf.py`，但除非绝对必要，否则我宁愿不要有多个副本。

# java - 使用 java ArrayList 休眠

> ID：10199245
> 
> 赞同：0
> 
> 时间：2012-04-17T21:13:03.347
> 
> 标签：java, hibernate, jpa

我尝试在此类中使用 Hibernate，其中包括 `ArrayList`：

但我得到了这个例外：

```
expected type: java.util.ArrayList, actual value: org.hibernate.collection.PersistentList 
```

（我必须使用 Arraylist，因为 List 是不可序列化的，这给我带来了麻烦）

当 jpa entitymanager 启动时抛出此异常。

这是课程：

```
package Entities;

import java.io.Serializable;
import java.util.ArrayList;
import java.util.List;

import msg.AnsMsg;

public class Person implements Serializable {

    static final long serialVersionUID = 1L;

    private long id;
    public long getId() {
        return id;
    }

    public void setId(long id) {
        this.id = id;
    }

    private String _email;

    private ArrayList <AnsMsg> msgList=new ArrayList<AnsMsg>();

   public ArrayList <AnsMsg> getMsgList() {

       return msgList;
    }

    public void setMsgList(ArrayList <AnsMsg> msgList) {
        this.msgList = msgList;
    }

    public Person(){}

    public String getEmail() {
        return _email;
    }

    public void set_email(String _email) {
        this._email = _email;
    }
} 
```

这是hbm文件：

```
<?xml version="1.0"?>
<!DOCTYPE hibernate-mapping PUBLIC "-//Hibernate/Hibernate Mapping DTD 3.0//EN"
"http://hibernate.sourceforge.net/hibernate-mapping-3.0.dtd">
<!-- Generated Apr 17, 2012 9:20:13 PM by Hibernate Tools 3.4.0.CR1 -->
<hibernate-mapping>
    <class name="Entities.Person" table="PERSON">
        <id name="id" type="long">
            <column name="ID" />
            <generator class="increment" />
        </id>
        <property name="_email" type="java.lang.String" access="field">
            <column name="_EMAIL" />
        </property>

        <list name="msgList" inverse="false" table="ANSMSG" lazy="true">
            <key>
                <column name="ID" />
            </key>
            <list-index></list-index>
            <one-to-many class="msg.AnsMsg" />
        </list>

    </class>
</hibernate-mapping> 
```

我如何在休眠中使用java Arraylist，在此先感谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-17T21:34:34.860

根据[Hibernate Javadoc](http://docs.jboss.org/hibernate/orm/3.2/api/org/hibernate/collection/PersistentList.html)，PersistentList 也是可序列化的。您的 POJO 可以引用 List，但在运行时和 PersistentList 的实例（可序列化）中应该使用。

简而言之，只需使用 List 接口。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-17T21:23:58.910

我认为您需要关联接口 List 而不是实际的 ArrayList 类。如果您看到 PersisetList 文档[http://docs.jboss.org/hibernate/orm/3.2/api/org/hibernate/collection/PersistentList.html](http://docs.jboss.org/hibernate/orm/3.2/api/org/hibernate/collection/PersistentList.html)它实现了 java.util.List。

# pbs - 使用 qstat 命令从 Torque PBS 服务器获取“不允许从主机访问，或未知主机”

> ID：10199250
> 
> 赞同：3
> 
> 时间：2012-04-17T21:13:26.913
> 
> 标签：pbs, torque

我正在尝试运行命令`qstat`，但没有得到队列状态，而是看到了这个错误：

> 无法解析默认服务器主机 'torqueserver' - 检查 server_name 文件。qstat: cannot connect to server torqueserver (errno=15010) Access from host not allowed, or unknown host

我该如何解决？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-18T20:17:26.747

'torqueserver' 是运行 pbs_server 的节点的主机名吗？在位于 /server_name 的 server_name 文件中（默认为 /var/spool/torque），运行 pbs_server 的节点的实际主机名应该在该文件中。

# javascript - 如何在 django 表单中使用 html5？

> ID：10199251
> 
> 赞同：1
> 
> 时间：2012-04-17T21:13:32.623
> 
> 标签：javascript, python, django, html, django-forms

我想使用这个片段

```
# extra.py in yourproject/app/

from django.db.models import FileField
from django.forms import forms
from django.template.defaultfilters import filesizeformat
from django.utils.translation import ugettext_lazy as _

class ContentTypeRestrictedFileField(FileField):
    """
    Same as FileField, but you can specify:
        * content_types - list containing allowed content_types. Example: ['application/pdf', 'image/jpeg']
        * max_upload_size - a number indicating the maximum file size allowed for upload.
            2.5MB - 2621440
            5MB - 5242880
            10MB - 10485760
            20MB - 20971520
            50MB - 5242880
            100MB 104857600
            250MB - 214958080
            500MB - 429916160
    """
    def __init__(self, *args, **kwargs):
        self.content_types = kwargs.pop("content_types")
        self.max_upload_size = kwargs.pop("max_upload_size")

        super(ContentTypeRestrictedFileField, self).__init__(*args, **kwargs)

    def clean(self, *args, **kwargs):
        data = super(ContentTypeRestrictedFileField, self).clean(*args, **kwargs)

        file = data.file
        content_type = file.content_type

        if content_type in self.content_types:
            if file._size > self.max_upload_size:
                raise forms.ValidationError(_('Please keep filesize under %s. Current filesize %s') % (filesizeformat(self.max_upload_size), filesizeformat(file._size)))
        else:
            raise forms.ValidationError(_('Filetype not supported.'))

        return data 
```

用这个片段

```
// fileInput is a HTMLInputElement: <input type="file" multiple id="myfileinput">
var fileInput = document.getElementById("myfileinput");
// files is a FileList object (simliar to NodeList)
var files = fileInput.files;
for (var i = 0; i < files.length; i++)
{
    alert(files[i].name + " has a size of " + files[i].size + " Bytes");
} 
```

所以我可以使用 html5 检查文件的大小，如何将这 2 个片段合并为 1 个？我还找到了一个上传视频并检查大小的 java 片段，但我找不到任何关于如何实现它的文档。我不能使用 javascript 因为我不能信任客户端

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-18T03:39:38.607

根据 django 的文件输入小部件为该字段创建一个小部件。将第二个片段中的 JS 添加到该小部件的输出中。并在渲染创建时将 max_upload_size 的值从字段传递给小部件。

# scala - 用子类参数覆盖子类方法？

> ID：10199254
> 
> 赞同：6
> 
> 时间：2012-04-17T21:13:51.867
> 
> 标签：scala, inheritance, overriding

当被子类覆盖时，如何强制基方法采用相同的特定子类实例？

IE：

```
abstract class Animal {
  def mateWith(that: Animal)
}

class Cow extends Animal {
  override def mateWith...?
} 
```

从逻辑上讲， a`Cow`应该只能到`mateWith`another `Cow`。但是，如果我这样做`override def mateWith(that: Cow)`，这实际上并没有覆盖基类方法（我想要它，因为我想强制它在子类中存在）​​。

我可以检查以确保另一个实例是 Cow 类型，如果不是则抛出异常 - 这是我最好的选择吗？如果我有更多的动物怎么办？我将不得不重复抛出异常的代码。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-04-17T21:17:32.750

```
abstract class Animal[T <: Animal[T]] {
  def mateWith(that: T)
}

class Cow extends Animal[Cow] {
  override def mateWith(that: Cow) { println("cow") }
}

class Dog extends Animal[Dog] {
  override def mateWith(that: Dog) { println("dog") }
} 
```

并像这样使用它：

```
scala> (new Cow).mateWith(new Cow)
cow

scala> (new Cow).mateWith(new Dog)
<console>:17: error: type mismatch;
 found   : Dog
 required: Cow
              (new Cow).mateWith(new Dog)
                                 ^ 
```

不需要抛出异常的代码；类型系统在编译时为您处理它！

# sql - 匹配单词，但可能在单词中包含空格

> ID：10199256
> 
> 赞同：0
> 
> 时间：2012-04-17T21:13:57.117
> 
> 标签：sql, regex, whitespace

有没有办法将正则表达式（或 SQL）中的单词与空格匹配，例如，

`This` 将匹配

*   `T h i s`
*   `T hi s`
*   `Th is`

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-17T21:23:44.897

您可以`\s*`在每个字母之后使用，表示 0 个或多个空格。但是您可以使用 replace() 使用简单的解决方案...

```
WordThis.replace(' ','').equals("this") 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-17T21:19:30.817

你可以试试这样的表达方式`(t\s*h\s*i\s*s\s*)`。

您需要确保您的设置不区分大小写。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-17T21:20:09.940

`\s*`我想这是在 word 中的每个字符之间手动添加的唯一方法。

# android - 为什么android模拟器运行得这么慢？

> ID：10199258
> 
> 赞同：3
> 
> 时间：2012-04-17T21:14:01.863
> 
> 标签：android, sdk, android-emulator

我有 12 Gb RAM 的 windows 7 prof 64 位。我很好地运行了许多 Linux 和 Windows 虚拟机。为什么安卓模拟器运行这么慢？如何让它更快？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-17T21:20:00.013

大多数 Android 映像在 ARM 平台上运行。这意味着您的计算机必须模拟整个设备，包括将 ARM 指令转换为 x86 指令。您应该尝试新的 x86 仿真器映像。它们明显更快。请参阅英特尔的[本指南](http://software.intel.com/en-us/articles/installing-the-intel-atom-tm-android-x86-emulator-image-add-on-from-the-android-sdk-manager/)。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-17T21:24:27.033

我放弃了模拟器并在 VMWare 映像中安装了 Android x86。仍然不如真实设备快，但比模拟器快得多。工作冠军（另外，在我的笔记本电脑上运行 Android 应用程序非常酷:)）

[http://www.android-x86.org/documents/installhowto](http://www.android-x86.org/documents/installhowto)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-17T22:23:23.930

你有机会尝试新的模拟器吗？ [http://android-developers.blogspot.com/2012/04/faster-emulator-with-better-hardware.html](http://android-developers.blogspot.com/2012/04/faster-emulator-with-better-hardware.html)

# .net - 如何将身份验证信息从一种 .net Web Api 方法传递到另一种

> ID：10199260
> 
> 赞同：0
> 
> 时间：2012-04-17T21:14:06.230
> 
> 标签：.net, asp.net-web-api

使用 .net Web Api 和 Forms 身份验证，我有一个 Api 方法可以进行第二次 Api 调用。第一个 Api 方法是从 javascript 调用的，我可以使用 GetUserPrincipal 方法获取当前登录用户的身份：

```
private void Put(int id, object value) {
    var principal = ControllerContext.Request.GetUserPrincipal();
    ....
    var responseMessage = new HttpClient().PutAsync("/api/secondapicontroller/", null).Result
    ....
} 
```

但是，当该方法进行链接的内部 Api 调用时，GetUserPrincipal 返回一个空对象、没有身份、未经过身份验证等：

```
private void Put(int id, object value) {
    var principal = ControllerContext.Request.GetUserPrincipal();
    ....
} 
```

您如何将身份验证信息从第一个 Api 方法传递到第二个。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-17T21:58:15.250

您只需在 HttpClient 中包含请求中的 cookie - 如果身份验证对两者都有效。这里解释了一些关于[在 HttpClient 中设置 cookie 的](http://social.msdn.microsoft.com/Forums/lv-LV/winappswithcsharp/thread/3724d52e-c92a-45c7-8ed5-8e76a244d80b)内容。

# android - Android共享首选项缓存？

> ID：10199267
> 
> 赞同：1
> 
> 时间：2012-04-17T21:14:32.453
> 
> 标签：android, settings

答案在底部。

我添加了对 4.0.4 浏览器的修改，它添加了一个新的首选项部分。当浏览器启动时，该值被正确读取并且似乎被缓存了。每当 Controller.java 使用 getMaxTabs 时，我都添加了一个日志事件，并且它仅在首次启动时读取。如果我更改设置，则不会发生任何事情。但是，如果我在更改设置后终止浏览器并重新启动，则会正确读取新值。有没有办法强制此设置在更改时重新缓存？

我正在查看 SharedPreferences.OnSharedPreferenceChangeListener 但我看不到如何强制重新读取该变量。

```
int getMaxTabs() {
    Context mContext = mActivity.getApplicationContext();
    SharedPreferences mPrefs = PreferenceManager.getDefaultSharedPreferences(mContext);
    String numTabs = mPrefs.getString(PreferenceKeys.PREF_MAX_TABS, "20");
    int t = Integer.parseInt(numTabs);
    Log.i("max open tabs", "max: " + t);
    return t;
    // The original content of getMaxTabs is below
    // return mActivity.getResources().getInteger(R.integer.max_tabs);
} 
```

所以日志项只在浏览器第一次启动时出现。设置了新的首选项，因为如果我更改它并杀死/重新启动浏览器，则会反映新值。我需要不缓存此设置或强制在更改时刷新缓存，这样会更有效率。

src/com/android/browser/preferences/TabsPreferencesFragment.java

```
package com.android.browser.preferences;

import android.os.Bundle;
import android.preference.Preference;
import android.preference.PreferenceFragment;

import com.android.browser.BrowserSettings;
import com.android.browser.PreferenceKeys;
import com.android.browser.R;
import com.android.browser.search.SearchEngine;

public class TabsPreferencesFragment extends PreferenceFragment {

    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        // Load the XML preferences file
        addPreferencesFromResource(R.xml.tabs_preferences);
    }
} 
```

res/xml/tabs_preferences.xml

```
<?xml version="1.0" encoding="utf-8"?>
<PreferenceScreen
        xmlns:android="http://schemas.android.com/apk/res/android" >
    <ListPreference
        android:key="max_open_tabs"
        android:defaultValue="20"
        android:title="@string/pref_max_open_tabs"
        android:entries="@array/pref_max_open_tabs_choices"
        android:entryValues="@array/pref_max_open_tabs_values"
         />
</PreferenceScreen> 
```

这就是它在 src/com/android/browser/TabControl.java 中的调用方式

```
private int mMaxTabs;

TabControl(Controller controller) {
    mController = controller;
    mMaxTabs = mController.getMaxTabs();
    mTabs = new ArrayList<Tab>(mMaxTabs);
    mTabQueue = new ArrayList<Tab>(mMaxTabs);
}

boolean canCreateNewTab() {
    return mMaxTabs > mTabs.size();
} 
```

**解决方案**
答案就在这里，在 packages/apps/Browser/src/com/android/browser/TabControl.java

在第 55 行附近，我们看到：

```
/**
 * Construct a new TabControl object
 */
TabControl(Controller controller) {
    mController = controller;
    mMaxTabs = mController.getMaxTabs();
    mTabs = new ArrayList<Tab>(mMaxTabs);
    mTabQueue = new ArrayList<Tab>(mMaxTabs);
} 
```

TabControl 对象在浏览器启动时构建一次。这里我们通过调用 mController.getMaxTabs() 来定义 mMaxTabs。

在第 155 行附近，使用 mMaxTabs 定义了 canCreateNewTab。

```
boolean canCreateNewTab() {
    return mMaxTabs > mTabs.size();
} 
```

由于 mMaxTabs 是一个静态值，它永远不会在首选项更新时改变。

解决方案是这样的。

```
/**
 * Construct a new TabControl object
 */
TabControl(Controller controller) {
    mController = controller;
    mTabs = new ArrayList<Tab>(mMaxTabs);
    mTabQueue = new ArrayList<Tab>(mMaxTabs);
}

boolean canCreateNewTab() {
    return mController.getMaxTabs() > mTabs.size();
} 
```

现在，每次请求新的浏览器选项卡时，都会验证首选项设置。

# javascript - 滚动条出现时保持水平元素位置的技巧

> ID：10199273
> 
> 赞同：0
> 
> 时间：2012-04-17T21:15:02.433
> 
> 标签：javascript, html, css, position, scrollbar

我的页面都使用典型的固定宽度边距左右自动布局。

```
.container{
     width:900px;
     margin:0 auto;
} 
```

小问题来了。其中一些页面高于窗口，这意味着它们应该在右侧显示垂直滚动条。在这些页面和其他页面之间切换，主容器会移动一点（ v-scrollbar 的一半宽度）。我知道这是因为父元素（主体）的宽度发生了变化。

但是有人知道是否有图书馆或现有的黑客来抑制这种行为吗？（除了 body{overflow-y:scroll;}）

回复@Mateusz：
谢谢 Matousz，好主意。我尝试了以下代码

```
console.log($('body')[0].offsetHeight+' '+$('body')[0].scrollHeight+' '+$('html'[0].offsetHeight+' '+$('html')[0].scrollHeight); 
```

测试结果是

```
 doc smaller than win              doc larger than win
firefox    1012 1012 1008 1362               1012 1012 1008 1007
chrome/ie  549 1525 545 545                    549 545 545 545 
```

所以他们有不同的行为，比较线程也不同（1和4）。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-17T21:23:13.030

您可以比较 element.offsetHeight 和 element.scrollHeight。并根据此更改容器的位置。

# php - 获取后运行编码 json 时出错

> ID：10199275
> 
> 赞同：0
> 
> 时间：2012-04-17T21:15:16.180
> 
> 标签：php, mysql, json

致命错误：在第 11 行的 /home/content/69/9179269/html/test/json-events.php 中的非对象上调用成员函数 fetchAll()

`$result = $dbh->query($sql)->fetchAll(PDO::FETCH_ASSOC);`

什么会导致这个错误？

```
`$username = "user";
$password = "psword";

$dbh = new PDO("mysql:localhost;dbname=databasename", $username, $password);

$sql = "SELECT `id`, `title`, `time`, `start`, `end`, `url`, `backgroundColor`,    `textColor`, `borderColor`, `description`
    FROM calender WHERE length(column) > 0";`

foreach ($result as $row){
$return[]=array('id'=>$row['id'],
                'title'=>$row['title'],
                'start'=>$row['start'].' '.$row['time'],
                'end'=>$row['end'],
                'url'=>$row['url'],
                'backgroundColor'=>$row['backgroundColor'],
                'textColor'=>$row['textColor'],
                'borderColor'=>$row['borderColor'],
                'description'=>$row['description'],
                "allDay" => false);
}
$dbh = null;

header('Content-type: application/json');
echo json_encode($return); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-17T21:18:14.233

query() 没有返回 pdo 语句。这意味着您的查询可能失败。检查您的 sql 语句和错误消息。

打开错误报告

`$db->setAttribute(PDO::ATTR_ERRMODE, PDO::ERRMODE_WARNING);`

所以你可以看到你的错误信息。

# deployment - JRE 安装如何工作？

> ID：10199276
> 
> 赞同：1
> 
> 时间：2012-04-17T21:15:28.067
> 
> 标签：deployment, installation, classpath, java

我正在打包我的软件，想知道 JRE 的安装是如何工作的。它是简单地复制本地系统上的二进制文件并相应地设置类路径，还是由安装程序完成任何其他步骤？

对于 Windows，JRE 二进制文件存储在`C:\Program Files\Java\jre7`我可以将此文件夹复制到其他机器（具有相同的 32 位或 64 位处理器）以使 JRE 工作。如果是这样，那么需要设置哪些环境变量？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-17T21:20:44.210

> *我可以将此文件夹复制到其他机器（具有相同的 32 位或 64 位处理器）以使 JRE 工作吗*

是没有问题。除非您还想注册 .jar 扩展名以便可以双击它们。

在这种情况下，请查看`ftype`and`assoc`命令。他们可以这样做，例如从批处理文件或安装程序中。

> *如果是这样，那么需要设置哪些环境变量？*

无需设置任何环境变量。

只需确保在启动应用程序时（例如通过批处理文件）正确限定 javaw.exe（或 java.exe）的路径。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-17T21:20:29.660

您可以将整个 JRE 放在一个子目录中，然后根据子目录引用 java.exe。其他产品经常这样做。

您不需要设置任何环境变量。

**更新**

如果这是一个不是 JRE 工具包的商业应用程序（即 Maven 或 Ant 之类的东西），请不要依赖全局环境变量 JAVA_HOME、PATH 或 CLASSPATH 来设置。如果您想创建一个批处理文件，该文件在运行时会自动在您的应用程序的上下文中进行设置，那将可以正常工作。但不要依赖它们在系统中进行设置。

只需有人更改这些以使用某些版本的 1.7 或 1.8 beta 或真正的 JRE 的任何子版本来破坏您的应用程序，然后您将收到有关您的应用程序破坏的客户支持电话，当真的他们所做的是将他们的 JAVA_HOME 更改为荒谬的东西，因为他们误读了 Ant 文档。

如果您提供与 JDK 结合使用的工具集，例如 Ant 或 Maven，您可能希望使用它们安装的任何 JRE/JDK，因为这就是您的工具的重点。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-17T21:23:30.160

简短的版本是，这取决于。但在大多数情况下，二进制兼容性和库路径的限制足以让 JRE 在共享环境中工作（就像我们在工作中的一些机器上所做的那样）。

因为 Java 提供了一个虚拟机来处理请求，并且因为它可以完全独立于系统拥有的其他一些花里胡哨，所以你对它的类路径和二进制配置的直觉是正确的。*但是*，对于需要格式良好且系统特定的路径和库集的库，您可能会遇到问题，这些路径和库在第三方库提供的某些 OS 包中提供。

简而言之：如果您可以选择从其安装程序安装 Java，因为这将保证所有类路径详细信息、所有库、所有日志记录工具和所有特定于系统的勘误表都被考虑在内，尽管正如 Andrew Finnell 指出的那样，您还是[需要手动设置环境变量](https://stackoverflow.com/questions/560797/why-doesnt-the-java-sdk-installer-set-java-home)。*大多数需求只需要*其中的一个严格子集（请参阅其他答案），但在界定此类问题时，最有趣的是极端情况。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-17T21:23:40.550

如果您不指定任何参数，JRE 安装程序会安装所需的二进制文件和可执行文件，但还会创建所需的 Windows 注册表项来配置您的 JRE 安装。

您还可以使用“-static”选项进行安装（请参阅 JRE 安装程序[文档](http://www.oracle.com/technetwork/java/javase/silent-136552.html)），在这种情况下，除了将文件复制到指定路径之外，不会执行任何其他操作。

然后，您将需要手动设置环境变量。对于命令行，最常见的有：PATH、JAVA_HOME 和 CLASSPATH。

# vim - 这是什么，与它相关的 vimscript 函数是什么？

> ID：10199280
> 
> 赞同：3
> 
> 时间：2012-04-17T21:15:48.270
> 
> 标签：vim

![http://dl.dropbox.com/u/24856/Screenshots/p.png](../Images/cefeed1b14d27edb3076fe7e8495a45f.png)

我在搞乱 phpcs 插件。我这样做是为了让 bufwrite 上的插件调用但修改了 phpcs 以仅在实际发生任何违规时显示 quickfix 窗口。

我遇到的问题是，当快速修复窗口打开时，缓冲区不会显示带有红色“>”错误符号的灰色条，除非我先将光标移入快速修复窗口，然后再移回缓冲区。

我正在寻找可以在我的 phpcs 插件中调用的函数，这样在我打开 quickfix 窗口后，我可以刷新那个灰色条以立即显示和显示违规行为。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-18T00:09:43.247

这是标志栏。插件经常使用标志来显示编译错误或其他问题的位置。

您想了解的有关使用标志的所有信息都可以在 中找到`:help signs`。

# android - Android如何在启动时创建数据库，如果它不存在，然后在下一次启动时检索它

> ID：10199283
> 
> 赞同：2
> 
> 时间：2012-04-17T21:15:53.953
> 
> 标签：android, database, sqlite, store, startup

我在 Android 上使用 SQLite 时遇到问题。我能够解析 XML 文件，然后创建一个数据库来存储内容。创建，插入工作正常。我可以在文件资源管理器中看到 .db 文件

我最后一次调用 checkDataBase() 返回 false ？！为什么 ？

我正在使用模拟器上的 Android 2.3。

难道我做错了什么 ？

活动：

```
public class MTGDBActivity extends Activity{

    String currentDBPath = "data/data/rudy.jaumain.mtgdb/databases/MTGCards";
    MTGContainerData mtgcd;
    MTGDatabase mtgdb;

    Button buttonEditions, buttonCollection, buttonDecks;
    View v;

    /** Called when the activity is first created. */
    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);

        try {
                this.mtgcd = new MTGContainerData(this);
                if (!this.checkDataBase()) {
                    System.out.println("FILE DOESN'T EXIST");
                    this.mtgdb = new MTGDatabase(this);
                    this.mtgdb.open();
                    this.mtgcd.loadCards(this.mtgdb);
                    System.out.println("CARDS LOADED");
                    this.mtgdb.close();
                }
                else{
                    System.out.println("FILE DOES EXIST");
                }

        } catch (Exception e) {
            System.out.println("FAIL");
        }

        System.out.println(this.checkDataBase());
        this.setContentView(R.layout.main);
        this.initialize();
    }

    private boolean checkDataBase() {
        SQLiteDatabase checkDB = null;
        try {
            checkDB = SQLiteDatabase.openDatabase(currentDBPath, null,
                    SQLiteDatabase.OPEN_READONLY);
            checkDB.close();
        } catch (SQLiteException e) {
            System.out.println("DATABASE DOES NOT EXIST");
        }
        return checkDB != null ? true : false;
    }

    public void initialize(){
        try{

            v = (View)this.findViewById(R.id.mainLayout);
            v.setBackgroundColor(Color.WHITE);

            this.buttonEditions = (Button)findViewById(R.id.buttonEdition);
            this.buttonEditions.setOnClickListener(new OnClickListener(){
                @Override
                public void onClick(View v) {

                    System.out.println("CLICKED");
                        Intent i = new Intent(v.getContext(), MTGDBEditionsActivity.class);
                        startActivityForResult(i,0);
                }
            });

            this.buttonCollection = (Button)findViewById(R.id.buttonCollection);
            this.buttonCollection.setOnClickListener(new OnClickListener(){
                @Override
                public void onClick(View v) {

                    System.out.println("CLICKED");
                        Intent i = new Intent(v.getContext(), MTGDBCollectionActivity.class);
                        startActivityForResult(i,0);
                }
            });

            this.buttonDecks = (Button)findViewById(R.id.buttonDecks);
            this.buttonDecks.setOnClickListener(new OnClickListener(){
                @Override
                public void onClick(View v) {

                    System.out.println("CLICKED");
                        Intent i = new Intent(v.getContext(), MTGDBDecksActivity.class);
                        startActivityForResult(i,0);
                }
            });

        }
        catch(Exception e1){
            e1.printStackTrace();
        }

    }
} 
```

数据库：

```
public class MTGDatabase{

private static final String TABLE_CARDS = "table_cards";
private static final String COL_ID = "ID";
private static final int NUM_COL_ID = 0;
private static final String COL_NAME = "NAME";
private static final int NUM_COL_NAME = 1;
private static final String COL_EDITION = "EDITION";
private static final int NUM_COL_EDITION = 2;
private static final String COL_RARITY = "RARITY";
private static final int NUM_COL_RARITY = 3;
private static final String COL_MANACOST = "MANACOST";
private static final int NUM_COL_MANACOST = 4;
private static final String COL_NUMBER = "NUMBER";
private static final int NUM_COL_NUMBER = 5;
private static final String COL_COLOR = "COLOR";
private static final int NUM_COL_COLOR = 6;

public int VERSION_BDD = 1;
private SQLiteDatabase sqldb;
private MTGDatabaseAdapter mtgbdAdapter;

public MTGDatabase(Context c) {
    mtgbdAdapter = new MTGDatabaseAdapter(c, "MTGCards.db", null, VERSION_BDD);
}

public void open(){
    sqldb = mtgbdAdapter.getWritableDatabase();
}

public void close(){
    sqldb.close();
}

public SQLiteDatabase getDatabase(){
    return sqldb;
}

public long insertCard(MTGCard card){
    ContentValues values = new ContentValues();
    values.put(COL_NAME, card.getName());
    values.put(COL_EDITION, card.getEdition());
    values.put(COL_RARITY, card.getRarity());
    values.put(COL_MANACOST, card.getManacost());
    values.put(COL_NUMBER, card.getNumber());
    values.put(COL_COLOR, card.getColor());
    return sqldb.insert(TABLE_CARDS, null, values);
}

public int updateCard(int id, MTGCard card){
    ContentValues values = new ContentValues();
    values.put(COL_NAME, card.getName());
    values.put(COL_EDITION, card.getEdition());
    values.put(COL_RARITY, card.getRarity());
    values.put(COL_MANACOST, card.getManacost());
    values.put(COL_NUMBER, card.getNumber());
    values.put(COL_COLOR, card.getColor());
    return sqldb.update(TABLE_CARDS, values, COL_ID + " = " +id, null);
}

public int removeCardWithID(int id){
    return sqldb.delete(TABLE_CARDS, COL_ID + " = " +id, null);
}

public MTGCard getCardWithName(String name){
    Cursor c = sqldb.query(TABLE_CARDS, new String[] {COL_ID, COL_NAME, COL_EDITION, COL_RARITY, COL_MANACOST, COL_NUMBER, COL_COLOR}, COL_NAME + " LIKE \"" + name +"\"", null, null, null, null);
    return cursorToCard(c);
}

private MTGCard cursorToCard(Cursor c){

    if (c.getCount() == 0)
        return null;

    c.moveToFirst();

    MTGCard card = new MTGCard();
    card.setId(c.getInt(NUM_COL_ID));
    card.setName(c.getString(NUM_COL_NAME));
    card.setEdition(c.getString(NUM_COL_EDITION));
    card.setRarity(c.getString(NUM_COL_RARITY));
    card.setManacost(c.getString(NUM_COL_MANACOST));
    card.setNumber(c.getString(NUM_COL_NUMBER));
    card.setColor(c.getString(NUM_COL_COLOR));

    c.close();

    return card;
}
} 
```

数据库适配器：

```
public class MTGDatabaseAdapter extends SQLiteOpenHelper {
private static final String TABLE_CARDS = "table_cards";
private static final String COL_ID = "_ID";
private static final String COL_NAME = "NAME";
private static final String COL_EDITION = "EDITION";
private static final String COL_RARITY = "RARITY";
private static final String COL_MANACOST = "MANACOST";
private static final String COL_NUMBER = "NUMBER";
private static final String COL_COLOR = "COLOR";

private static final String CREATE_BDD = "CREATE TABLE " 
    + TABLE_CARDS 
+ " (" + COL_ID + " INTEGER PRIMARY KEY AUTOINCREMENT, " 
+ COL_NAME + " TEXT NOT NULL, "
+ COL_EDITION + " TEXT NOT NULL, "
+ COL_RARITY + " TEXT NOT NULL, "
+ COL_MANACOST + " TEXT NOT NULL, "
+ COL_NUMBER + " TEXT NOT NULL, "
+ COL_COLOR + " TEXT NOT NULL);";

public MTGDatabaseAdapter(Context context, String name,
        CursorFactory factory, int version) {
    super(context, name, factory, version);
}

@Override
public void onCreate(SQLiteDatabase db) {
    // TODO Auto-generated method stub
    db.execSQL(CREATE_BDD);

}

@Override
public void onUpgrade(SQLiteDatabase db, int oldVersion, int newVersion) {
    db.execSQL("DROP TABLE " + TABLE_CARDS + ";");
    onCreate(db);
}
} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-17T21:53:44.423

我建议您使用 SQLiteOpenHelper 类：http: [//developer.android.com/reference/android/database/sqlite/SQLiteOpenHelper.html](http://developer.android.com/reference/android/database/sqlite/SQLiteOpenHelper.html)

如果数据库不存在，此类将创建数据库，为此它将执行`onCreate()`方法中的代码，如果您扩展 SQLiteOpenHelper 类，您可以覆盖该代码。

您可以通过调用`getReadableDatabase()`和`getWritableDatabase()`方法来检索数据库实例。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-17T22:06:31.537

如果尚未创建数据库，则在您的实例上调用`getReadableDatabase()`or将创建数据库。为了设置应用程序的数据库，您不应该在实现中需要任何硬编码路径（我不确定您要尝试用“解析 XML”做什么）。`getWriteableDatabase()``SQLiteOpenHelper`

创建 SQLiteOpenHelper 类时，请参阅开发人员站点上的[**记事本教程以获取参考。**](http://developer.android.com/resources/tutorials/notepad/index.html)

有关如何在应用程序生命周期过程中正确处理您的信息，请参阅这篇[**文章**](https://stackoverflow.com/a/9286006/844882)`SQLiteOpenHelper`。

# xcode4 - 复制 XCode 项目给了我旧的 myproject.app

> ID：10199288
> 
> 赞同：0
> 
> 时间：2012-04-17T21:16:28.483
> 
> 标签：xcode4

我通过复制和粘贴文件夹复制了我的项目。

然后在项目中，我重命名了项目名称，因此它会弹出一个窗口，要求重命名目标。

我之前做过两次都没有问题，但这一次，在 Products 文件夹中 myproject.app 文件仍然是旧文件。

新的没有出现在我的方案选项中，所以我不知道还能做什么。

Xcode 抱怨一个图标文件不再存在。

有没有办法解决它；还有其他方法可以复制项目吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-18T17:44:48.687

我使用 XCode 4.2 复制项目的解决方案是复制并粘贴项目文件夹，然后打开新文件夹。

单击左侧的项目名称（Project Navigator），然后重命名。

系统将提示您重命名您拥有的任何目标。只需单击重命名。

然后在您的目标构建设置上更改产品名称属性。

# php - DateTime 不会临时更改

> ID：10199289
> 
> 赞同：1
> 
> 时间：2012-04-17T21:16:33.167
> 
> 标签：php, datetime, timezone

我的整个网站是：

```
date_default_timezone_set('Europe/London'); 
```

用户可以选择他们的时区，并在数据库中保存为`4.0`（对于迪拜）

现在我希望用户选择的时区对网站上存在的倒计时有影响。倒计时看起来像这样：

```
 $today_date = new DateTime('now');  // now
    $final_date = new DateTime($date); // a date in the future
    $interval = $today_date->diff($final_date); // find the difference

    $time_left = $interval->format('starting in %d days, %h hours and %i minutes'); // display it 
```

在此之上，我做了以下工作：

```
 $userGMT = $user->get_gmt();
        date_default_timezone_set($userGMT); 
```

哪个不正确。它仍然为欧洲/伦敦时区倒计时，而不是我选择的那个。

我试过做 echo date('H:i:s'); 并且可以看到上述影响的时间，它显示了我选择的时区的时间。

这样就可以了，但是 dateTime('now'); 不是吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-19T07:56:46.563

生成未来日期时，需要明确说明适用的时区。这表明时间间隔与主机的时区无关：

```
<?php
$date = '2012-04-19';   // date in the future
$user_tz = new DateTimeZone('Asia/Dubai');
foreach (array('Europe/London', 'America/Los_Angeles') as $tzname)
{
  date_default_timezone_set($tzname);
  $today_date = new DateTime('now');  // now
  $final_date = new DateTime($date, $user_tz); // future date with explicit tz
  $interval = $today_date->diff($final_date); // find the difference
  $time_left = $interval->format('start in %d days, %h hours and %i minutes');
  echo "$tzname:  $time_left\n";
} 
```

输出：

```
Europe/London:  start in 0 days, 11 hours and 53 minutes
America/Los_Angeles:  start in 0 days, 11 hours and 53 minutes 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-17T22:47:14.937

您想要做的是将`$userGMT`您的 currentTime 添加到然后减去您的服务器时间。所以以秒为单位获取时间然后添加`$userGMT*60*60 - $yourTimeZone*60*60`

# hadoop - Hadoop / AWS 弹性地图降低性能

> ID：10199294
> 
> 赞同：0
> 
> 时间：2012-04-17T21:16:56.027
> 
> 标签：hadoop, amazon-web-services

如果有人有这方面的经验，我正在寻找一个球场......

有没有人有关于 AWS 地图减少速度的基准？

假设我有 1 亿条记录，并且我正在使用 hadoop 流（一个 php 脚本）来映射、分组和减少（通过一些简单的 php 计算）。平均组将包含 1-6 条记录。

运行一堆小实例还是更大的实例更好/更具成本效益？我意识到它被分解为一个实例中的节点，但是更大的节点是否会有更高的 I/O，这意味着每个服务器的每个节点更快（并且更具成本效益）？

还有流式传输，映射器与减速器的比例是如何确定的？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-17T21:57:20.420

我不知道你能否给出一个有意义的基准——这有点像询问计算机程序通常运行多快。在不了解脚本的情况下，不可能说您的程序运行速度有多快。

如果您的意思是，支持 EMR 作业的实例的速度有多快，它们与您指定的底层实例的规格相同，来自 AWS。

如果您想大致了解 EMR 的不同执行方式：我想说您可能会在 CPU 瓶颈之前遇到 I/O 瓶颈。

从理论上讲，这意味着您应该运行许多小型实例并要求机架多样性，以便从更多机器上获取更多 I/O 资源，而不是让它们竞争。在实践中，我发现更少、更高的 I/O 实例可能更有效。但即使这种印象也并不总是成立——实际上取决于该区域的繁忙程度以及您的工作安排在哪里。

# glow - cocos3d 线条发光效果

> ID：10199296
> 
> 赞同：3
> 
> 时间：2012-04-17T21:16:58.213
> 
> 标签：glow, cocos3d

我在只有 GLES 1.1 的 iOS 3.1 上使用 cocos3d 7.0（即 cocos2d 的 3d 扩展）。

我想在空间中画一条具有发光效果的线。理想情况下，它必须看起来像[iOS 中 Opengl ES 1.x 发光效果中](https://stackoverflow.com/questions/9678558/opengl-es-1-x-glowing-effect-in-ios)第二张图像上的一条线。但是上面的例子使用了普通的 gl 调用，没有 cocos3d/2d 框架调用。

在 cocos3d api 方面有没有很好的例子或教程来创建这样的效果？

# jquery - 如果单元格重复，突出显示表格行

> ID：10199297
> 
> 赞同：2
> 
> 时间：2012-04-17T21:16:59.380
> 
> 标签：jquery, jquery-ui

我目前有下表：

```
Checkbox (ID)  |  Training Course Code  |  Training Course Name  |  ....
   [ ]         |  DE00155115-1          |  H&S Exec 1            |  ....
   [ ]         |  DE00155115-1          |  H&S Exec 1            |  ....
   [ ]         |  DE00074454-2          |  H&S Exec 2            |  .... 
```

每门课程运行不止一次，但只能选择一次，因此每个课程代码有多个 ID。

我想要做的是能够在选中重复行后禁用/突出显示重复行。

在上面的示例中，如果选择了第一行，则第二行将禁用，反之亦然。如果选择了第三行，则不会发生任何事情。

我尝试了几个使用 jQuery 的函数，但不确定从哪里开始和构建。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-17T22:06:47.673

如果我理解正确，那么您只需要为下面的复选框实现一个单击处理程序，

[**演示**](http://jsfiddle.net/skram/NgQLw/2/)

```
$('#courses > tbody > tr > td > .selectCourse').on('click', function () {
    var $tr = $(this).closest('tr')
    var selCourseCode = $tr.find('td:eq(1)').html();
    var isChecked = this.checked;
    if (isChecked) {
        $tr.addClass('highlight');
    } else {
        $tr.removeClass('highlight');
    }

    $.each ($tr.siblings(), function () {
        var courseCode = $(this).find('td:eq(1)').html();
        if (courseCode == selCourseCode) {
            if (isChecked) {
                $(this).find('.selectCourse').prop('disabled', true);
                $(this).addClass('disable');
            } else {
                $(this).find('.selectCourse').removeProp('disabled');
                $(this).removeClass('disable');
            }
        }
    });
}); 
```

**CSS：**

```
.highlight { background-color: #386C98; }
.disable { background-color: #386C98; color: grey; } 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-17T22:16:18.053

这是一个示例 jQuery 函数，它应该在旧版本的 IE (8/7/6) 中工作：

[http://jsfiddle.net/lazerblade01/d2QtL/9/](http://jsfiddle.net/lazerblade01/d2QtL/9/)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-17T22:31:22.093

这是一个冗长且稍微复杂的选项：

```
$('table')
    .on('click','input:checkbox',
        function(){
            var that = $(this),
                thatRow = that.closest('tr'),
                id = that.parent().next('td').text();

            if (that.is(':checked')){
                that
                    .closest('tbody')
                    .find('tr td:nth-child(2)')
                    .each(
                        function(){
                            if ($(this).text() == id){
                                $(this)
                                    .closest('tr')
                                    .not(thatRow)
                                    .addClass('disabled')
                                    .find('input:checkbox')
                                    .prop('disabled',true);
                            }
                        });
            }
            else {
                that
                    .closest('tbody')
                    .find('tr td:nth-child(2)')
                    .each(
                        function(){
                            if ($(this).text() == id){
                                $(this)
                                    .closest('tr')
                                    .not(thatRow)
                                    .removeClass('disabled')
                                    .find('input:checkbox')
                                    .prop('disabled',false);
                            }
                        });
            }
        });​ 
```

[JS 小提琴演示](http://jsfiddle.net/davidThomas/tTwDF/1/)。

参考：

*   [`addClass()`](http://api.jquery.com/addClass/).
*   [`:checkbox`选择器](http://api.jquery.com/checkbox-selector/)。
*   [`:checked`选择器](http://api.jquery.com/checked-selector/)。
*   [`closest()`](http://api.jquery.com/closest/).
*   [`each()`](http://api.jquery.com/each/).
*   [`find()`](http://api.jquery.com/find/).
*   [`is()`](http://api.jquery.com/is/).
*   [`next()`](http://api.jquery.com/next/).
*   [`not()`](http://api.jquery.com/not/).
*   [`:nth-child()`选择器](http://api.jquery.com/nth-child-selector/)。
*   [`on()`](http://api.jquery.com/on/).
*   [`parent()`](http://api.jquery.com/parent/).
*   [`prop()`](http://api.jquery.com/prop/).
*   [`removeClass()`](http://api.jquery.com/removeClass/).
*   [`text()`](http://api.jquery.com/text/).

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-17T21:39:12.640

生成表格时，向 html 单元格添加一个属性，例如

```
 <td data-course-name="math">math</td> 
```

使用 jquery 时尝试

```
 $('td[data-course-name=' + name of the course + ']').css( apply css here) 
```

这很简单

# asp.net - 如何重置数组内容

> ID：10199300
> 
> 赞同：0
> 
> 时间：2012-04-17T21:17:09.897
> 
> 标签：asp.net, arrays, c#-4.0, razor, webmatrix

我正在使用 @RenderPage 传递一个数组：

```
@RenderPage("/Shared/_ScopeFormControls.cshtml", ChangeScope) 
```

该数组最初声明并设置为：

```
string[,] ChangeScope = { { "True" }, { "" }, { "" } }; 
```

接收页面将数组解构为变量以在其自己的 if 语句中使用：

```
string[,] ChangeScope = PageData[0];   
var isValid = ChangeScope[0,0];
var InvsOut = ChangeScope[1,0];   
var ItemsToMoveIDs = ChangeScope[2,0]; 
```

首次加载页面时一切正常。

我想根据一堆 if 语句重置 if (IsPost) 中的数组内容，然后使用新值调用 Renderpage。

基本上我想像普通变量一样使用数组并用新内容覆盖其现有内容，例如：

```
ChangeScope = { { "True" }, { "IntoScope" }, { ItemsToMoveIDs } }; 
```

这可能吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-17T21:25:15.783

您是否真的在寻找简单的东西：

```
if (IsPost)
{
    ChangeScope = new string[,] { { "True" }, { "" }, { "" } };
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-17T21:25:48.583

尝试使用 Array.Clear()。

更多信息可以在 MSDN 上[找到](http://msdn.microsoft.com/en-us/library/system.array.clear.aspx)。

# ruby-on-rails - rails 3.1 多种货币

> ID：10199301
> 
> 赞同：2
> 
> 时间：2012-04-17T21:17:13.810
> 
> 标签：ruby-on-rails, ruby-on-rails-3, ruby-on-rails-3.1

如您所见，我必须在此 Web 应用程序[http://www.designconnected.com/上向应用程序添加更多货币，它将价格转换为您选择的任何货币并保持这种方式。](http://www.designconnected.com/)我一直在寻找已经过时的 gem，教程找不到任何东西，并且在 stackoverflow 中有一些关于它的问题，但没有一个得到我需要的东西。

如果你们中有人知道最近发布的更好的宝石......请告诉我。或者如果没有宝石，我应该向 current_user 添加一个 currency_id 以便应用程序将为该用户显示正确的货币.. 但是我从哪里获取货币汇率.. 我一直在寻找解决方案现在3天了，什么都没有。

谢谢你的任何建议..

这个网址已经过检查：

[https://stackoverflow.com/questions/1368010/rails-currency-gem-or-plugin](https://stackoverflow.com/questions/1368010/rails-currency-gem-or-plugin)

[Rails 3 - 多种货币](https://stackoverflow.com/questions/6939089/rails-3-multiple-currencies)

[https://github.com/RubyMoney/money](https://github.com/RubyMoney/money)

最后一个与[https://github.com/RubyMoney/google_currency](https://github.com/RubyMoney/google_currency)结合看起来像是我需要的那个。但现在是获取有关如何使用它的教程的正确时间。

如果无法找到/获取有关此的完整教程，请提供一些关于如何开始的想法。谢谢你。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-04-19T07:23:41.970

[https://github.com/RubyMoney/money-rails](https://github.com/RubyMoney/money-rails)和[https://github.com/RubyMoney/google_currency](https://github.com/RubyMoney/google_currency)是要走的路。这不是我问的或问题中的，但无论如何这是我现在最接近的答案。这些是我为使其正常工作所做的几个步骤：

在**宝石文件中**：

```
gem "json" #if you don't have it
gem "money"
gem "google_currency" 
```

在里面创建一个文件**money.rb**`config/initializers`

```
require 'money'
require 'money/bank/google_currency'
require 'json'
MultiJson.engine = :json_gem
Money.default_bank = Money::Bank::GoogleCurrency.new 
```

在**product.rb**中（或任何需要转换价格的模型）

```
composed_of :price,
    :class_name => "Money",
    :mapping => [%w(price price), %w(currency currency_as_string)],
    :constructor => Proc.new { |price, currency| Money.new(price || 0, currency || Money.default_currency) },
    :converter => Proc.new { |value| value.respond_to?(:to_money) ? value.to_money : raise(ArgumentError, "Can't convert #{value.class} to Money") } 
```

在视图文件中：

```
<%= number_to_currency(product.price.exchange_to(:EUR)) %> 
```

例如，我有一个 IT 语言环境（意大利语）——意大利货币现在是欧元：

您可以将价格转换为欧元。它对我来说非常有用，money gem 使用 Google_currency 将价格从美元转换为欧元，并且区域设置 yml 文件更改了此区域设置的货币，因此您的价格看起来像XXX,XX 欧元，而不是 $XXX,XX。

要为每个区域显示正确的货币，您需要添加：

```
it:
  number:
    currency:
      format:
        format: "%n %u"
        unit: "EUR" 
```

在`it.yml`文件或其他语言中，您使用该国家/地区的货币。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-18T01:19:30.523

您可能不需要宝石。您可以使用此处解释的 URL 在代码中的任何位置直接调用 google 的货币 API。这可以在您的模型中完成，也可以直接在视图中通过 AJAX 完成。

[http://motyar.blogspot.com/2011/12/googles-currency-converter-and-json-api.html](http://motyar.blogspot.com/2011/12/googles-currency-converter-and-json-api.html)

# php - 显示从 Zend_form 恢复的组合框的内容

> ID：10199303
> 
> 赞同：1
> 
> 时间：2012-04-17T21:17:24.587
> 
> 标签：php, zend-framework, combobox, zend-form

我有一个带有组合框的表单

```
 /*Business user type*/
            $Busertype = new Zend_Form_Element_Select("Busertype");
        $Busertype ->setLabel('Business user type')
          ->addFilter('StripTags') //StripTags : Enlève les caractères HTML
              ->setRequired(true)
               -> setMultiOptions(array(
                                '0' => '-Select your business type-',
                    '1' => 'Owner',
                                    '2' => 'Suplier',
                                    '3' => 'Representative',
                                    '4' => 'Shop'
        )); 
```

我想检索组合框的内容，但是当我`echo($busername)`检索组合框的值时。那么如何显示组合框的内容

部分动作

```
 $form = new Application_Form_Inscriptionbu(); 
     $this->view->form = $form; //nous assignons le formulaire à la vue pour affichagee
     if ($this->getRequest()->isPost()) {  //Le formulaire est-il posté ?
     $formData = $this->getRequest()->getPost(); // récupère les infos des formulaires

     if ($form->isValid($formData)) { //Si le formulaire passe la validation
        $v = $form->getValues();
        $busername =$v['Busername'];
        echo($busername);
    } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-17T21:24:35.650

如果您想重新显示所选选项中的文本，您可以使用`getMultiOption`.

```
if ($form->isValid($formData)) { //Si le formulaire passe la validation
    $v         = $form->getValues();
    $busername = $v['Busername'];

    echo "You selected $busername which is called " . 
         $form->getElement('Busername')->getMultiOption($busername) . 
         '<br />';
} 
```

# macos - 在mac中安装时如何找出installerplugin的目录

> ID：10199307
> 
> 赞同：0
> 
> 时间：2012-04-17T21:17:45.590
> 
> 标签：macos, installation, pkg-file

我创建了一个安装程序插件，它会在从 GUI 安装 pkg 文件时显示一个窗格。在安装发生时，我需要知道安装程序插件运行的可执行文件的位置，以便我可以访问相对于该路径的文件。NSProcessInfo 类没有任何帮助，因为它所指的进程是installer.app。有什么办法可以查到吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-18T10:26:46.710

我找到了方法。我们可以使用`NSBundle`Class 通过以下方式定位捆绑包：

```
NSBundle* iPlugin = [NSBundle bundleForClass:[MyInstallerPlugin class]]; 
```

然后使用

```
[iPlugin bundlePath ]; 
```

我们可以找到包根的绝对路径。

# php - PHP 和 C 守护进程之间最有效的进程间调用

> ID：10199309
> 
> 赞同：0
> 
> 时间：2012-04-17T21:17:55.613
> 
> 标签：php, c, interprocess

我有一个由 PHP 支持的 REST API，它调用一个 C 程序。根据输入，C 程序返回 JSON 数据，PHP 读取输出并直接将其发送回客户端。

代码本质上是：

```
$command = $binary . " " . $parameters;
$output = shell_exec($command);
echo $output; 
```

对于 API 的每次调用，PHP 都会启动程序，进行一些处理，然后结束。

我想通过让 C 程序作为守护进程运行来提高效率，然后让 PHP 后端调用这个守护进程。

另外，我可能正在迁移到 Python Web 框架，所以我想要从客户端跨平台的东西。

我的直觉反应是简单地通过套接字进行，从那时起我可以将守护进程放在任何地方（在可预见的将来它会位于同一个 Web 服务器上，但我最终可以将它移走）。但是套接字是否足够高效，或者还有其他被认为是更好的做法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-17T21:26:54.253

如果不了解您的 C 程序的更多信息，很难回答这个问题。

绝对值得检查的一件事是[创建 PHP 扩展](http://theserverpages.com/php/manual/en/zend.creating.php)。

它不是跨平台的，但你可以编写类似 Python 或 Ruby 的扩展，而扩展部分实际上只是围绕你的 C 程序的一个小骨架，而且它真的很容易编写。

# facebook - 受邀的朋友没有收到来自我的 Facebook 应用程序的邀请

> ID：10199312
> 
> 赞同：2
> 
> 时间：2012-04-17T21:18:09.223
> 
> 标签：facebook, facebook-app-requests

我试图让我的应用程序的用户（它仍在开发中，即站点 URL 仍然[http://localhost:portnumbber](http://localhost:portnumbber)，但沙盒模式已禁用）使用如下 URL 发送应用程序邀请：

[http://www.facebook.com/dialog/apprequests?app_id=1234567890&message=MY%20Message&redirect_uri=http://localhost:1234/page.aspx](http://www.facebook.com/dialog/apprequests?app_id=1234567890&message=MY%20Message&redirect_uri=http://localhost:1234/page.aspx)

当我单击链接并发送邀请时，我没有收到任何错误。我遇到的问题是，当我检查我为测试目的创建的测试用户时，我看不到任何应用程序的邀请。但是我注意到，当我登录到测试用户帐户（在 facebook 中）时，我在小通知图标上看到第一个，然后它立即自动消失，当我在测试中搜索任何邀请时-用户帐户我什么也没找到...这是因为我仍在 facebook 的应用程序配置和设置页面的站点 URL 中使用 localhost:portnumbber 吗？还是我错过了在应用程序设置中配置的东西？

# jquery - 未调用uploadify onError

> ID：10199315
> 
> 赞同：-1
> 
> 时间：2012-04-17T21:18:17.770
> 
> 标签：jquery, asp.net-mvc, uploadify

我们如何将自定义错误消息传递给uploadify？

如果在控制器动作上，有一个异常（由 try/catch 捕获）——我们如何将它传递给 uploadify 脚本？永远不会调用 onError 事件？

```
 [HttpPost]
    public ActionResult Upload(HttpPostedFileBase fileData, FormCollection forms)
    {
      try
      {                
        if (fileData.ContentLength > 0)
        {
          var statusCode = Helper.UploadList();
          if (statusCode.Equals(System.Net.HttpStatusCode.Created))
          return Json(new { success = true });                      
        }                  
      }
      return Json(new { success = false });        
    }
    catch (Exception ex)
    {  
    return Json(new { success = false });       
    }   
}

    'onComplete': function (event, queueID, fileObj, response, data) {
                    if (response == '{"success":true}') {
                        alert("File uploaded successfully.");
                    }
                    else if (response == '{"success":false}') {
                        alert('File failed to upload. Please try again!');                   
                    }
                    else {
                        $("#file_uploadDomain").uploadifyCancel(queueID);
                    }
                    return false;
                },

                'onError': function(event, ID, fileObj, errorObj) {
                    alert(errorObj.type + ' Error: ' + errorObj.info);
                }, 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-17T22:39:25.877

**编辑**

[这篇文章](https://stackoverflow.com/a/2081852/130387)应该可以帮助您解决使用 JSON 和 uploadify 的问题。您需要包含[此文件](https://github.com/douglascrockford/JSON-js)或等效文件才能使 JSON.parse 正常工作。

像这样的东西应该可以工作 - 使用 JSON 来发挥你的优势

```
 [HttpPost]
    public ActionResult Upload(HttpPostedFileBase fileData, FormCollection forms)
    {
      try
      {                
        if (fileData.ContentLength > 0)
        {
          var statusCode = Helper.UploadList();
          if (statusCode.Equals(System.Net.HttpStatusCode.Created))
          return Json(new { success = true });                      
        }                  
      }
      return Json(new { success = false, message = "No file was specified." });        
    }
    catch (Exception ex)
    {  
    return Json(new { success = false, message = ex.ToString() });       
    }   
}

    'onComplete': function (event, queueID, fileObj, response, data) {
                    var json = JSON.parse(response);
                    if (json.success) {
                        alert("File uploaded successfully.");
                    }
                    else if (!json.success) {
                        alert(json.message);                   
                    }

  //not sure what else you could have here for the value of success
//, thus a redundant else statement, but I will leave it in.  
                    else {
                       $("#file_uploadDomain").uploadifyCancel(queueID);
                    }
                    return false;
                 }, 
```

# ios - iOS 弹出框 UI 元素

> ID：10199317
> 
> 赞同：2
> 
> 时间：2012-04-17T21:18:27.647
> 
> 标签：ios, ipad

我正计划使用类似于 [http://www.ofzenandcomputing.com/wp-content/uploads/2011/01/enter-password.png的文本条目和按钮创建 UI Popver 元素](http://www.ofzenandcomputing.com/wp-content/uploads/2011/01/enter-password.png)

单击屏幕上的其他位置不应关闭弹出框，只有取消或保存按钮才能关闭弹出框。

iPad 密码设置屏幕是否使用 UIPopoverController ？如何强制仅从弹出窗口中的取消按钮解除弹出窗口？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-17T22:37:47.217

这确实是一个 UIPopover。在 3.2 之前的 iOS 版本中，UIPopover 包含一个名为 passThroughViews 的属性。将带有 self.view 的 NSArray 作为唯一对象传递给该方法，当点击视图时，您的弹出框不会关闭。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-18T04:20:36.573

是的，您可以使用 popoverView 的委托：

```
-(BOOL)popoverControllerShouldDismiss:(UIPopoverController *)popoverController
{
    if ([save or cancel button is tapped]) {
        return YES;
    }
    return NO;
} 
```

# java - 插入本地数据库时出现 Java 空指针异常

> ID：10199319
> 
> 赞同：1
> 
> 时间：2012-04-17T21:18:36.580
> 
> 标签：java, sql, jdbc, nullpointerexception

我正在尝试将用户名添加到 .accdb 本地数据库中。我的代码如下：

```
try
    {
        String sql = "INSERT INTO Users VALUES('?');";
        System.out.println("SQL : " + sql);

        System.out.println("USER : " + user);

        PreparedStatement stmt = database.prepareStatement(sql);
        System.out.println("Statement : " + stmt);
        stmt.setString(1, user); 
        System.out.println("Statement : " + stmt);

        ResultSet results = stmt.executeQuery(); 
        System.out.println("Results : " + results);
    }
    catch(SQLException sqlEx)
    {
        System.out.println("* Cannot execute insertion! *");
        sqlEx.printStackTrace();
        System.exit(1);
    } 
```

控制台输出是：

```
SQL : INSERT INTO Users VALUES('?');
USER : TEST
Statement : sun.jdbc.odbc.JdbcOdbcPreparedStatement@1bf73fa
Exception in thread "Thread-0" java.lang.NullPointerException
at sun.jdbc.odbc.JdbcOdbcPreparedStatement.clearParameter    (JdbcOdbcPreparedStatement.java:1023)
at sun.jdbc.odbc.JdbcOdbcPreparedStatement.setChar    (JdbcOdbcPreparedStatement.java:3057)
at sun.jdbc.odbc.JdbcOdbcPreparedStatement.setString    (JdbcOdbcPreparedStatement.java:766)
at MultiEchoServer.addRegisteredUser(MultiEchoServer.java:100)
at ClientHandler.run(MultiEchoServer.java:339) 
```

谢谢你的帮助！

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-04-17T21:21:18.360

这就是问题所在，我怀疑：

```
String sql = "INSERT INTO Users VALUES('?');"; 
```

该语句没有*任何*参数——它总是会插入一个问号，因为你已经把它放在引号中，所以它是一个*值*而不是一个参数。我想你想要：

```
String sql = "INSERT INTO Users VALUES(?)"; 
```

（请注意，我也删除了 SQL 语句末尾的额外分号 - 我不相信你真的想要那个。）

不幸的是，这个例外并没有多大帮助，诚然......我希望有一些东西表明索引 1 超出了范围。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-04-17T21:21:47.143

删除引号和分号：

```
String sql = "INSERT INTO Users VALUES(?)"; 
```

# data-structures - Clojure 中 2D 游戏板的适当表示

> ID：10199323
> 
> 赞同：5
> 
> 时间：2012-04-17T21:19:01.877
> 
> 标签：data-structures, clojure

我正在使用 Clojure 开发一个小游戏作为学习练习。我想我已经确定了在任何特定时间将游戏状态表示为“可移动”列表和“地形”（棋盘方格）的 2D 矢量矢量。

在 95% 的时间里，我希望检查 2D 矢量似乎适合的特定正方形中的碰撞。但在少数情况下，我需要另辟蹊径——找到符合某些条件的单元格的 (x,y) 位置。第一次尝试是这样的：

```
(defn find-cell-row [fn row x y]
  (if (empty? row) nil
    (if (fn (first row)) [x y]
      (find-cell-row fn (rest row) (inc x) y))))

(defn find-cell [fn grid y]
  (if (empty? grid) nil
    (or (find-cell-row fn (first grid) 0 y)
        (find-cell (rest grid) (inc y)))))

(def sample [[\a \b \c][\d \e \f]])
(find-cell #(= % \c) sample 0) ;; => [2 0] 
```

我尝试了一些更简洁的地图索引，但它很快就变得丑陋了，仍然没有给我想要的东西。是否有更惯用的方法来进行此搜索，或者也许我会更好地使用不同的数据结构？也许是地图 { [xy] -> cell }？使用地图来表示矩阵对我来说感觉很不对 :)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-18T00:11:06.100

对于这种事情，嵌套向量是很正常的，如果你使用`for`理解，扫描它既不难也不难看：

```
(let [h 5, w 10]
  (first
   (for [y (range h), x (range w)
         :let [coords [y x]]
         :when (f (get-in board coords))]
     coords))) 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-17T23:38:35.033

使用普通向量怎么样，然后您可以使用所有“常用”功能，并且您可以根据需要提取 [xy]。

```
(def height 3)
(def width 3)

(def s [\a \b \c \d \e \f \g \h \i])

(defn ->xy [i]
    [(mod i height) (int (/ i height))])

(defn find-cell 
    "returns a vector of the [x y] co-ords of cell when
     pred is true"
    [pred s]
    (let [i (first (keep-indexed #(when (pred %2) %1) s))]
      (->xy i)))

(find-cell #(= \h %) s)
;=> [1 2]

(defn update-cells 
    "returns an updated sequence s where value at index i
     is replaced with v. Allows multiple [i v] pairs"
    [s i v & ivs]
    (apply assoc s i v ivs))

(update-cells s 1 \z)
;=> [\a \z \c \d \e \f \g \h \i]

(update-cells s 1 \p 3 \w)
;=> [\a \p \c \w \e \f \g \h \i] 
```

# mockito - Mockito.verify 选择性方法调用

> ID：10199325
> 
> 赞同：2
> 
> 时间：2012-04-17T21:19:18.127
> 
> 标签：mockito, verify, invocation

在我的应用程序中，我的代码看起来像 -

```
request.setParameter("a",false);//line1
request.setParameter("b",someObject);//line2
request.setParameter("c",someObject);//line3
request.setParameter("d",someObject);//line4 
```

我已经模拟了请求对象，现在我想验证 line3 是否被调用。我不关心其他行，在我尝试过的测试类 `**Mockito.verify(request).setParameter("c",someObject)**` 中-，但是我得到了错误-

```
Argument(s) are different! Wanted:
request.setParameter("c",com.test.MyObject@fec107);
-> at XXX

Actual invocation has different arguments:
request.setParameter("a", false); 
```

出于某种原因，Mockito 比较第一次调用并抛出错误

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-18T06:40:12.313

只有当您验证的调用实际上没有发生时，Mockito 才会这样做。因此，如果`request.setParameter("c", someObject)`已被调用，则无论其他调用如何，您的测试都会通过。如果`verify`失败，Mockito 会尝试通过识别与您尝试验证的呼叫“接近未命中”的呼叫来提供帮助；但*只有*在`verify`失败的情况下。

# asp.net-mvc-3 - MVC3 视图中延迟加载的 NHibernate 实体

> ID：10199332
> 
> 赞同：1
> 
> 时间：2012-04-17T21:19:45.917
> 
> 标签：asp.net-mvc-3, nhibernate

我们在我工作的地方遇到了问题。当我们尝试从 MVC3 视图中访问 NHibernate 实体上的延迟加载属性时，将抛出“No Session” LazyInitializationException。这只是在上周才开始出现在我们身上，但我们一直无法缩小问题的范围。不过，似乎没有一个简单的解决方案。

**备注**：

*   堆栈跟踪示例：http: [//textsnip.com/613608](http://textsnip.com/613608)
*   我们不会在项目中的任何地方处理（或将会话包装在使用中）。我们让 ObjectFactory 处理它。
*   这*仅*在我们的 TeamCity 测试环境中运行回归测试（带有 WatiN 的 SpecFlow）时发生。我们没有人能够在我们的开发机器上重现该问题。
*   这也不会始终如一地发生。虽然失败的测试通常是相同的测试，但它们不会一直失败。访问会命中某些相同视图的页面的其他测试不会失败。
*   在确实失败的测试中，它们似乎更倾向于延迟加载集合初始化而不是非集合，但两者都发生了。
*   虽然我知道尽可能提前加载实体会更好，但由于我们的许多表模型相互依赖，目前还不是那么可行。

我们在这里缺少什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-18T18:45:55.540

您的实体加载模式在视图中称为开放会话，它被视为反模式。更多关于这种模式的缺点[here](https://stackoverflow.com/questions/1847040/open-session-in-view-pattern)和[here](https://stackoverflow.com/questions/1103363/why-is-hibernate-open-session-in-view-considered-a-bad-practice)。

推荐的方法是使用一些带有预取数据的视图模型。但是如果你做不到，你可以使用 linq 预取模型数据来休眠扩展扩展。有一个开源库[ITDT.Sentia](http://code.google.com/p/itdt/source/browse/Experiment/Sources/Sentia/ITDT.Sentia/)，它提供了类型化的扩展扩展，或者您可以在谷歌中搜索“nhibernate expand”。对于更底层的东西，你可以看看 nhibernate [fetching](http://knol.google.com/k/nhibernate-chapter-16-improving-performance#16%282E%291%282E%29%28C2%29%28A0%29Fetching_strategies) strategy 。

例如使用 ITDT.Sentia 库并具有以下模型：

```
public class User : BaseEntity
{
    public virtual string Email { get; set; }
    public virtual Company Company { get; set; }
}

public class Company : BaseEntity
{
    public virtual string Name { get; set; }
} 
```

并假设在获取用户后延迟加载公司实体，您可以执行以下操作：

```
IList<User> users = userRepository
  .GetAll()
  .Where(u => /*some constraints*/)
 // here you are telling nhibernate to make a join and eger load what you need
  .Expand(u  => u.Company) 
  .ToList(); 
```

至于开发环境中的不同行为，我只能猜测它以某种方式使用了其他一些配置文件，也许有不同的调试/发布 web.configs？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-18T16:14:42.437

您是否在视图中直接绑定到您的对象模型？这听起来像您的问题，因为您查看直接绑定到域对象。由于域对象具有惰性集合，因此它会尝试按需加载集合元素，这需要 Nhibernate 会话。

您应该在控制器方法中构建完整的视图模型。

我的建议是为您拥有的每个视图创建一个视图模型。然后在查询 NHibernate 时，直接投影到模型中或使用 Automapper 将您的对象模型转换为视图模型。直接投影的好处是通过 nhibernate 进行查询会更有效，因为它只会选择您需要的列。

另见这篇文章。 [http://lostechies.com/jimmybogard/2009/06/30/how-we-do-mvc-view-models/](http://lostechies.com/jimmybogard/2009/06/30/how-we-do-mvc-view-models/)

它是为视图模型创建的一组最佳实践。

# c# - 在不知道确切路径的情况下在 C# 中启动外部程序

> ID：10199335
> 
> 赞同：0
> 
> 时间：2012-04-17T21:19:49.967
> 
> 标签：c#, .net, launch, process.start

我正在尝试创建一个 C# 程序来启动其他外部应用程序。我搜索了一下，发现了这个： http: [//www.dotnetperls.com/process-start](http://www.dotnetperls.com/process-start)，我认为这是一个很好的教程。我唯一的问题是我并不总是知道程序的路径。

例如，如果我这样做：

```
ProcessStartInfo startInfo = new ProcessStartInfo();
startInfo.FileName = "firefox.exe";
Process.Start(startInfo); 
```

它成功启动了Firefox。但是，如果我这样做：

```
ProcessStartInfo startInfo = new ProcessStartInfo();
startInfo.FileName = "chrome.exe";
Process.Start(startInfo); 
```

它失败了，因为它找不到 chrome，看起来我需要从它的确切路径启动它。所以我的问题是有没有办法访问所有已安装应用程序的通用注册表并从那里启动？谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-17T21:26:15.160

当应用程序的文件夹路径位于“PATH”环境变量中时，可以直接启动应用程序。

可以在以下位置查看和编辑此变量：

1.  右键单击“计算机”
2.  特性。
3.  *如果您使用的是“Windows7”或“Vista”，请进行*高级设置**
**   *高级*选项卡*   *环境变量**

 *条目由 分隔`;`。

我认为您可以启动 Firefox，因为 Firefox 已经将其文件夹放入 PATH 中。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-05T08:53:10.660

我知道这是一个老问题，但我想我已经找到了解决方案。

看看下面的注册表项：

HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\App Paths\

每个已安装的程序都有一个密钥。例如 Chrome.exe。

参考： http: [//msdn.microsoft.com/en-us/library/windows/desktop/ee872121 (v=vs.85).aspx](http://msdn.microsoft.com/en-us/library/windows/desktop/ee872121(v=vs.85).aspx)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-17T21:22:45.740

我认为您正在搜索[Environment.GetEnvironmentVariable](http://msdn.microsoft.com/en-us/library/77zkk0b6.aspx)方法。可以这样使用它：

`Environment.GetEnvironmentVariable("PATH")`

它将返回分配给该变量的字符串。

程序*通常*在该字符串中签名，以便能够通过 Windows 操作系统启动机制自动定位。

这意味着在*这种*情况下，您可能不知道可执行文件的**路径**，但**必须知道**要启动的程序的名称。*

# css - 可能以某种方式覆盖容器的填充？

> ID：10199336
> 
> 赞同：4
> 
> 时间：2012-04-17T21:19:58.860
> 
> 标签：css, html, padding

我可能想多了，但我是第一次使用 Wordpress，习惯了一切让我很头疼。

基本上，我有一个容器 div。我很懒，放了一个 10px 的填充。但是对于我正在*尝试*创建的主题，我有几个`divs`我想跨越整个容器，没有填充。

这是一个图片示例：

![在此处输入图像描述](../Images/afcf58fcc8ef7238a3e1637aa97c76f3.png)

有没有办法绕过容器 div 的设置，这样这个栏就不会被填充？

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2012-04-17T21:26:33.717

您可以在应该跨越整个容器的 div 上添加负边距：

```
div { margin-right: -10px; margin-left: -10px; } 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-17T21:27:22.510

负边距是您的朋友。

```
.wide-child{
    margin: 0 -10px;
} 
```

[小提琴](http://jsfiddle.net/post_erasmus/fgfXY/)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-04-17T21:27:06.053

尝试在内部 div 上使用负边距。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2017-03-13T05:19:27.977

```
.nopadding {
   width: 100vw;
   position: relative;
   left:49%;
   right:49%;
   margin-left: -50vw;
   margin-right: -50vw; 
} 
```

[https://css-tricks.com/full-width-containers-limited-width-parents/](https://css-tricks.com/full-width-containers-limited-width-parents/)

# jquery - Jquery匹配一个包含值的属性

> ID：10199341
> 
> 赞同：1
> 
> 时间：2012-04-17T21:20:21.470
> 
> 标签：jquery, html, css, search, attr

我有一个页面显示简单地将所有内容从图像链接到 .ppt 文件。查看下面的代码，我如何定位特定属性，即 fileext=".ppt" 并根据扩展名将类附加到链接？我正在使用 ASP.NET MVC 和 jQuery

```
<a class="screenshot" title="" fileext=".ppt" rel="http://google.com/test.jpg" href="#"> 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-17T21:23:35.923

```
$('a[fileext=".ppt"]').addClass('foo'); 
```

了解更多信息：

*   [jQuery 属性等于选择器](http://api.jquery.com/attribute-equals-selector/)
*   [jQuery .addClass() 函数](http://api.jquery.com/addClass/)

您可以分别为每种文件类型执行此操作，但如果您有很多文件类型，那么您可能希望获取`fileext`属性的值并自动将其与类名匹配。如果您可以提供更多有关您拥有的链接的示例以及您想要应用于它们的类，那将很有帮助。

# asp.net-mvc-3 - 未找到视图“错误”或其主视图

> ID：10199345
> 
> 赞同：37
> 
> 时间：2012-04-17T21:20:41.713
> 
> 标签：asp.net-mvc-3, error-handling, elmah

我花了很多时间试图找出解决方法无济于事，所以我想我会看看这里是否有人有想法。

我[在我的 ASP.NET MVC3 应用程序中使用 Elmah](https://stackoverflow.com/questions/766610/how-to-get-elmah-to-work-with-asp-net-mvc-handleerror-attribute)。我正在使用与上一个链接中接受的答案完全相同的代码。

我的 Global.asax 中也有这段代码，用于显示带有正确 HTTP 响应的错误页面：

```
 /// <summary>
    /// The customErrors functionality provided by ASP.NET results in HTTP 302 redirects occurring which doesn't accurately reflect what the real HTTP code of the response was.
    /// This method can be used to handle specific HTTP codes without an intermediate redirect.
    /// </summary>
    protected void Application_Error() {
        var exception = Server.GetLastError();
        var httpException = exception as HttpException;
        Response.Clear();
        Server.ClearError();
        var routeData = new RouteData();
        routeData.Values["controller"] = "Error";
        routeData.Values["action"] = "Error500";
        Response.StatusCode = 500;

        if (httpException != null) {
            Response.StatusCode = httpException.GetHttpCode();
            Response.TrySkipIisCustomErrors = true;
            switch (Response.StatusCode) {
                case 403:
                    routeData.Values["action"] = "Error403";
                    break;
                case 404:
                    routeData.Values["action"] = "Error404";
                    routeData.Values["message"] = httpException.Message;
                    break;
                case 500:
                    routeData.Values["action"] = "Error500";
                    break;
            }
        }

        IController errorsController = new ErrorController();
        var rc = new RequestContext(new HttpContextWrapper(Context), routeData);
        errorsController.Execute(rc);
    } 
```

当我不在我的（本地）开发机器上时会出现问题（最初让我认为它与[customErrors](http://msdn.microsoft.com/en-us/library/h0hfz6fc.aspx)相关）。当抛出异常时，Elmah 会处理错误并正确记录它。我也最终出现在正确的错误页面上。但是，在到达正确的错误页面之前，我可以看到另一个中间异常被记录：

```
The view 'Error' or its master was not found or no view engine supports the searched locations. The following locations were searched: ~/Views/Articles/Error.aspx ~/Views/Articles/Error.ascx ~/Views/Shared/Error.aspx ~/Views/Shared/Error.ascx ~/Views/Articles/Error.cshtml ~/Views/Articles/Error.vbhtml ~/Views/Shared/Error.cshtml ~/Views/Shared/Error.vbhtml 
```

ASP.NET 正在尝试加载默认错误页面，即使我正在尝试处理它。有人对如何防止这种情况有任何想法吗？

* * *

## 回答 #1

> 赞同：32
> 
> 时间：2012-04-18T06:25:36.687

不要`base.OnException(context);`在您的自定义错误处理程序中调用从`HandleErrorAttribute`. 您不再需要它，因为您已经在`Application_Error`.

* * *

## 回答 #2

> 赞同：17
> 
> 时间：2013-10-01T16:07:54.753

我遇到了同样的问题，但我没有在任何地方执行 base.OnException() 。另一种可能的解决方案是从`<system.web>`我的 web.config 中删除它：

```
<customErrors mode="On" /> 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2018-04-13T18:32:37.807

如果您使用 Elmah.MVC 并想使用自定义错误页面，只需在您的 Web.config 中将以下值更改为 true：

```
<add key="elmah.mvc.disableHandleErrorFilter" value="true" /> 
```

这将保持 Elmah 日志记录处于启用状态，但阻止它尝试重定向到默认错误页面。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2012-04-17T21:39:32.733

您的网站试图导航到 ~/Error 的某个地方，但由于它不存在而找不到它。

尝试在 Web.config 中删除或禁用**customErrors 。**我愿意将其设置为默认值**并**重定向到**~/Error**

如果您想发布您的 Web.config（省略任何敏感信息），我可能会提供帮助。我最近和 Elmah 处理过类似的问题。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2018-01-11T11:26:47.353

如果您使用 Elmah.mvc，那么将这个设置更改为 true 会有所帮助：

```
<add key="elmah.mvc.disableHandler" value="true" />
<add key="elmah.mvc.disableHandleErrorFilter" value="true" /> 
```

# database - 在 SQL Server 中查询只读数据库时，足够的可用 RAM 增加是否可以消除 tempdb 的使用？

> ID：10199349
> 
> 赞同：1
> 
> 时间：2012-04-17T21:20:46.347
> 
> 标签：database, performance, sql-server-2008, ram, tempdb

`tempdb`当我查看资源使用情况时，SQL Server 会针对一些大型查询进行大量写入。

我不使用临时表或表变量或任何写入，我只执行该服务器上只读数据库的选择语句。

所以我想知道如果我用大量 RAM 升级该服务器，SQL Server 是否能够使用额外的 RAM 并消除使用，`tempdb`或者我仍然必须分配部分 RAM 并移动`tempdb`到 RAM 磁盘？

问题[SQL Server 2005 内存压力和 tempdb 写入问题](https://stackoverflow.com/questions/620226/sql-server-2005-memory-pressure-and-tempdb-writes-problem)与此有关，但没有解决这种情况。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-17T21:28:01.997

您可能会发现此演示文稿非常有帮助：[优化 tempdb 性能](http://bradmcgehee.com/wp-content/uploads/presentations/Optimizing%20tempdb%20Performance.pdf)。

具体来说，请参考以下提示：

*   尽量减少使用 tempdb
*   为您的服务器添加更多 RAM
*   保留自动创建统计信息和自动更新统计信息
*   预先分配 tempdb 空间——每个人都需要这样做
*   如果不需要，请不要缩小 tempdb
*   在它自己的数组上找到 tempdb
*   在快速 I/O 子系统上定位 tempdb
*   在多个物理文件之间划分 tempdb
*   避免使用透明数据加密 (2008)

# entity-framework - EF 4.0 在输出 sql 中将 n_varchar 更改为 varchar

> ID：10199353
> 
> 赞同：0
> 
> 时间：2012-04-17T21:21:11.293
> 
> 标签：entity-framework

我正在使用 Entity Framework 4.0，有没有办法将实体框架生成的 sql 从 n_varchar 更改为 varchar？谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-19T16:10:06.107

使用属性

```
using System.ComponentModel.DataAnnotations;

[Column(TypeName = "varchar")]
public string UserName { get; set; } 
```

# java - Android不会从PHP页面显示特殊字符

> ID：10199354
> 
> 赞同：0
> 
> 时间：2012-04-17T21:21:13.057
> 
> 标签：java, php, android

我有一个显示单词“Entrée”的简单网页。它在网络上看起来很完美，但是当我在 Android 中使用 HTTPClient 来显示应该显示这个单词的网页时，它不知道如何处理“é”。我不熟悉字符代码等，但我一直在环顾四周，发现大多数人推荐使用 UTF-8。如何确保 Android 可以读取此特殊字符？

网页PHP代码：

`<?php echo "Entrée"; ?>`

有任何想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-17T21:33:55.357

这很可能是字符编码问题。PHP 脚本可能没有设置任何/正确的字符编码标头，因此您的浏览器和 Android 会采用他们喜欢的任何方式。

*请不要这样做，这很脏：避免大多数字符编码问题* ~~的**快速技巧**是将任何特殊（主要是非 ASCII）字符转义为[HTML 实体](http://www.w3schools.com/tags/ref_entities.asp)。é`&eacute;`例如。如果您只想这样做`echo "Entrée"`，那么只需在您最喜欢的文本编辑器中查找和替换即可。~~

*改为这样做，它会让世界变得更美好：*

如果您打算输出静态单词以外的任何内容，比如数据库中的一些动态文本，您应该尝试**做正确的事情**：让您的 PHP 脚本输出 UTF-8 并发送正确的`Content-Type`标题。

我的 PHP 很生锈，但是这样的东西应该可以工作：

```
<?php
header('Content-type: text/plain; charset=UTF-8');
echo "Entrée";
?> 
```

您还需要*确保*您的文本编辑器或 IDE**将您的 PHP 文件保存为 UTF-8**（不是 ANSI、ASCII、Windows-1252 或类似的），否则`é`将会一团糟，并且没有任何标题设置可以修复它。大多数编辑器会碰巧保存在 ANSI 中，这在您的编辑器中可能看起来不错，但在浏览器中查看时会在您的脸上炸开。

# php - PHP include 导致页面顶部出现空白

> ID：10199355
> 
> 赞同：29
> 
> 时间：2012-04-17T21:21:15.193
> 
> 标签：php

我正在制作的网站上有问题。我的页面顶部有这一行空白。我不知道它是从哪里来的。这可能是由于 php 在我的页面中出现了额外的换行符，`include()`或者它可能只是一些错误的 css。

* * *

## 回答 #1

> 赞同：41
> 
> 时间：2012-04-17T23:01:08.827

我得到了它！我必须承认，这是一个非常奇怪的事情。

[这](http://studentguru.gr/b/solidus/archive/2009/12/30/lt-php-include-gt-strange-extra-white-space-at-the-beginning-of-page.aspx)是我的确切问题，他的解决方案完美地解决了它。

问题是因为`include()`.

当您将页面保存为 UTF-8 时，文件开头会包含一个称为字节顺序标记（或 BOM）的特殊签名，表明它是一个 UTF-8 文件。您只能使用低级文本编辑器（例如[DOS 编辑](https://www.google.com.mx/url?sa=t&rct=j&q=&esrc=s&source=web&cd=1&ved=0CCcQFjAA&url=http://en.wikipedia.org/wiki/MS-DOS_Editor&ei=XteOT57OD4aA2gXeoej5Cw&usg=AFQjCNH1f3kY7X_qRxcZCzhAmCIxLSyA7Q&sig2=gXbUz3XYRTXTZdp5eXjFuw)）查看 BOM。您需要从包含的文件中删除此签名，以消除页面顶部的空白。

![DOS编辑](../Images/dcf02edb1cbe439d073a254200b677d5.png)

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2013-05-18T14:55:51.977

在 Notepad++ 中，您可以从“编码”菜单中将文件的编码更改为“不带 BOM 的 UTF-8”。这解决了我的问题。

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2014-01-23T22:31:54.157

1.  在记事本++中打开文件

2.  从顶部栏：*编码->在没有 BOM 的 UTF8 中编码*

3.  保存文件

**在 Dreamweaver 中**

按 CTRL + J 或转到*更改->页面设置->平铺/编码*，如果选中，则取消选中*UNICODE BOM*。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2012-04-17T21:27:55.470

好吧，您缺少初学者的 DOCTYPE ...您也没有指定字符编码。

除此之外，请确保如果您已将文件保存为 UTF-8，则它们在开始时不得有[BOM](http://en.wikipedia.org/wiki/Byte_Order_Mark)。还要确保你没有留下任何空行（尽管空格可能会被忽略，否则我写过的每个布局都会中断）

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2012-04-17T21:25:06.897

出于某种原因，在第一个 div 之前的 body 标记之后，您有一些时髦的角色......只需删除它们并根据需要重新缩进。**`&#65279;`**准确的字符...（如果您检查页面的**HTML** ，您可以在 Firebug 中看到它...但您在视图源中看不到它，因为它呈现为空白）。

*与对齐问题无关*......您的登录/注册链接后还有一个不匹配的结束`</li>`标签。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2013-01-16T15:44:10.907

您可以通过以下方式解决此问题...

根据斯昆利夫所说的……你可以避免这个角色……例子

```
$file = file_get_contents('header.php');
$file = substr($file, 3, strlen($file));
echo $file; 
```

所以，你正在跳过这个错误......

问候

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2014-10-10T09:24:33.763

**重要提示：**如果您在我的网站中有多个使用 utf-8 的 php 页面，则需要确保将***每个页面***的编码更改为“在没有 BOM 的情况下以 utf-8 编码”。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2012-04-17T21:24:43.107

是的，在其他任何内容之前都包含了额外的空格。

我可以向您推荐使用[输出缓冲](http://php.net/manual/en/function.ob-start.php)吗？您将获得对推送给客户端的内容的细粒度控制。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2012-04-17T21:39:20.077

声明 DOCTYPE 后，确保将 CSS reset 添加到 CSS 代码的第一行，以使其在所有浏览器中保持一致：

```
*{margin:0;
 padding:0;
 } 
```

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2012-04-17T21:51:53.423

在查看您在 firebug 上的网站输出时，我在 html 渲染上发现了一个小问题。在屏幕截图中查看。 ![萤火虫报告](../Images/d975baeb7b41b5f0b263520f36bf1238.png)

这可能是由于页面顶部缺少文档类型。在页面顶部添加以下文档类型并再次查看输出。

```
<!doctype html>
<html itemtype="http://schema.org/WebPage" xmlns="http://www.w3.org/1999/xhtml"   xmlns:og='http://opengraphprotocol.org/schema/'
xmlns:fb='http://www.facebook.com/2008/fbml'> 
```

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2016-10-10T16:51:36.750

在线测试所有建议，用记事本解决，程序：

1.  复制文件的所有内容以包含，从`php`没有`<?`
2.  打开记事本并输入`<?`然后粘贴所有代码
3.  享受

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2017-09-06T02:18:08.123

这个问题也困扰了我很久，直到我找到了一个非常简单的解决方案。

此问题是由 BOM 字符引起的，该字符用于告诉代码页以及文本文件的字节序。包含 PHP 文件时，也会包含此字符。虽然您不会看到 BOM 字符，但它可能会在您的页面上造成间隙。

我的解决方案在这里。您不必从文件中删除此字符。你需要做的是这样的：

```
<!-- <?php
include_once (dirname(__FILE__) . "/_include.php");
?> --> 
```

使用 HTML 注释标记来包装包含其他 php 文件的 php 代码。BOM 字符将被视为注释，不会出现在页面上。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2017-12-06T13:29:50.407

BOM Character 造成了这个问题。有时它不会创造出人们所看到的这种视觉特征。只需检查文件编辑器设置并设置为“无 BOM”以防止出现此类空白行。

有时图像会因为这个字符而无法工作，因为图像的字符集被这个字符破坏了。

为了避免这种情况，i)。检查您的代码编辑器是否使用 BOM 创建新文件。如果是这样，请更改此设置。ii)。打开代码的所有文件并在开始时检查 BOM 字符（

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2017-12-11T06:24:16.550

试试这个这是我所知道的最好的主意，干杯

```
<div style="position:absolute;">
<?php include("conn.php"); ?>
</div>
<!DOCTYPE html> 
```

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2018-08-12T13:34:35.887

我刚刚下载了 Notepad++，应该建议没有 BOM 的 UTF-8 不是编码选项。只选择“UTF-8”而不是“UTF-8 BOM”。那行得通。

# python - Pygooglevoice登录错误

> ID：10199362
> 
> 赞同：2
> 
> 时间：2012-04-17T21:22:11.433
> 
> 标签：python, sms

其他人问了这个问题，但没有回复，所以我再问一次。我正在尝试使用 pygooglevoice API，但是当我运行 SMS.py 示例脚本时，它给了我一个登录错误。我已经安装了 Enthought python，我想也许我还需要安装其他东西才能运行它。我查看了[说明](http://sphinxdoc.github.com/pygooglevoice/install.html)，当我尝试手动安装 python-setuptools 因为没有安装 yum 时出现错误。这就是 sms.py 不起作用的原因吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-10T19:23:03.960

以下对我有用。我遵循了[pygooglevoice 项目讨论板中给出的步骤，评论 #17](http://code.google.com/p/pygooglevoice/issues/detail?id=60#c17)。如果从头开始，以下是步骤。

```
#Command line Google Voice:
#Updated Jan 10, 2013

#required tools:
sudo apt-get install python python-simplejson python-setuptools
sudo easy_install simplejson

# if gvoice was installed previously, then uninstall it:
sudo rm -r /usr/local/lib/python2.7/dist-packages/googlevoice
sudo rm /usr/local/lib/python2.7/dist-packages/pygooglevoice*

#download pygooglevoice:
wget http://pygooglevoice.googlecode.com/files/pygooglevoice-0.5.tar.gz
tar -xf pygooglevoice-0.5.tar.gz
cd pygooglevoice

# edit settings.py to match correct Google Voice URL on line # 22:
nano googlevoice/settings.py

#correct URL:
LOGIN = 'https://accounts.google.com/ServiceLogin?service=grandcentral'
#you may check if URL is linking to Google Voice login page in browser.
#save and quit settings.py

#install gvoice:
sudo python setup.py install

#Login and make call for the first time:
gvoice # enter login email/pwd
  gvoice> call #follow prompts and make a call
  gvoice>send_sms # or s to send sms
  gvoice>exit #quit gvoice

#After first login, you may like to edit .gvoice for default actions:
sudo nano ~/.gvoice

#end 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-21T02:18:32.917

我以前也有同样的问题。我的版本是 0.5（通过 pip 安装），我的系统是 OSX 10.8。阅读问题 60 #17 后，我刚刚将 **LOGIN = ' [https://www.google.com/accounts/ServiceLoginAuth?service=grandcentral](https://www.google.com/accounts/ServiceLoginAuth?service=grandcentral) '** 更改为 **LOGIN = ' [https://accounts.google.com/ServiceLogin? service=grandcentral](https://accounts.google.com/ServiceLogin?service=grandcentral) '** 在文件**settings.py**然后问题解决了。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-11-24T02:50:57.910

我做了一个当前有效的克隆（至少用于发送短信）： [http ://code.google.com/r/kkleidal-pygooglevoiceupdate/](http://code.google.com/r/kkleidal-pygooglevoiceupdate/)

问题是 Google 更改了登录 URL。此外，我在 POST 请求中添加了一些参数，这可能有助于解决在 POST 请求中遇到的一些问题。登录现在应该可以顺利进行。

# c# - C# System.Transaction.RollBack

> ID：10199363
> 
> 赞同：0
> 
> 时间：2012-04-17T21:22:21.977
> 
> 标签：c#, transactions, transactionscope

**

## 编辑：

好的，谢谢你的分析器。那么如果事务不用于 SQL，那么它的目的是什么？本文展示了一个使用简单事务的示例：

[http://msdn.microsoft.com/en-us/library/ms172152(v=vs.90).aspx](http://msdn.microsoft.com/en-us/library/ms172152(v=vs.90).aspx)

如果它不是为了回滚他们试图恢复的内容以防代码失败，那么这样做的目的是什么？环境事务和正常事务之间的 tge 差异是什么？

```
 void RootMethod()
{
     using(TransactionScope scope = new TransactionScope())
     {
          /* Perform transactional work here */
          SomeMethod();
          scope.Complete();
     }
}

void SomeMethod()
{
     using(TransactionScope scope = new TransactionScope())
     {
          /* Perform transactional work here */
          scope.Complete();
     }
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-17T21:31:54.510

`TransactionScope`是检测和支持它的提供程序的环境事务，例如 ADO.NET 数据库连接提供程序。
不是恢复您在程序中所做的任何更改的魔杖。它只是不以这种方式工作。

如果您创建一个`TransactionScope`，*然后*创建一个数据库连接，然后使用该连接对数据库执行某些操作，然后回滚事务范围，您对数据库的更改将被撤消，就好像您对它发出了 a[`ROLLBACK TRAN`](http://msdn.microsoft.com/en-us/library/ms181299.aspx)一样。
而已。

# json - 为 Google Maps API v3 在数据库中存储地图边界

> ID：10199364
> 
> 赞同：1
> 
> 时间：2012-04-17T21:22:25.177
> 
> 标签：json, google-maps-api-3, bounds

无论如何将边界和/或中心位置转换为字符串并通过json将其发送到服务器端并存储它？

我问是因为当我尝试将这些东西转换成字符串时；我从 api 收到转换错误？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-17T21:51:06.317

使用`serialize`函数，用于检索地图边界和中心数据，然后将其存储在数据库中。

```
function serialize(map){
    var json = '{"bounds":'+map.getBounds().toString() + 
               ',"center":'+map.getCenter().toString()+"}";

    //'toString' returns values in '()', we need to replace them by '[]'
    json = json.replace(/\(/g,"[").replace(/\)/g,"]");
    return json;
} 
```

使用`deserialize`函数，通过存储的数据更新地图的状态：

```
function deserialize(map, json, useCenter ){
    json = JSON.parse(json);
    if( useCenter ){
        map.setCenter( new google.maps.LatLng(json.center[0],json.center[1]) );
    }else{
        map.fitBounds( new google.maps.LatLngBounds(
                      new google.maps.LatLng(json.bounds[0][0],json.bounds[0][1]),
                      new google.maps.LatLng(json.bounds[1][0],json.bounds[1][1])
                   ) );
    }
} 
```

**重要提示：** `map.fitBounds`不符合其论点的确切范围。请参阅此[链接](https://stackoverflow.com/questions/6048975/google-maps-v3-how-to-calculate-the-zoom-level-for-a-given-bounds)。

# c# - C# 琐事游戏：如果出现平局怎么办？

> ID：10199375
> 
> 赞同：5
> 
> 时间：2012-04-17T21:23:14.980
> 
> 标签：c#, arrays, loops

我目前正在做一个琐事游戏。我写了一个 Team 类、一个 Question 类和一个 Round 类。

这是我的 Team 类（我不会发布属性、构造函数和方法，因为它们与我的问题无关）。

```
public class Team
{
    private int _teamNumber = 0;
    private int _score = 0;
} 
```

这是我的回合课：

```
public class Round
{
    Team[] _teams = new Team[4];
    Question[] _questions = new Clue[30];
    bool _done = true; 
} 
```

我遇到的问题是如果出现平局该怎么办。有8支球队。前两轮各有两名获胜者（每队 4 支）将有资格参加第三轮和最后一轮。

因此，如果发生这种情况：

```
currentRound.Teams[0].Score = 300;
currentRound.Teams[1].Score = 300;
currentRound.Teams[2].Score = 100;
currentRound.Teams[3].Score = 350; 
```

如您所见，第二名并列。

我知道我可以检查重复，但如果球队的分数像

500、400、200、200

或者

500、500、200、100

在这种情况下，不需要抢七，因为只有前两支球队晋级下一轮。

所以我想知道是否有人可以帮助我想出一个算法来帮助确定我是否需要一个决胜局。如果我这样做，我们应该选择哪支球队，最后每轮的前两支球队是什么。

谢谢阅读！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-17T21:29:59.167

使用 LINQ 来确定是否有并列第二的团队怎么样？

```
var orderedResults = currentRound.Teams.OrderBy(x=>x.Score).ToList();
if(orderedResults.Any(x=>x.Score == orderedResults[1].Score))
    var team2 = RunTieBreaker(
        orderedResults.Where(x=>x.Score == orderedResults[1].Score).ToList()); 
```

如果您使用此实现，您甚至可以删除 if 并只执行 RunTieBreaker：

```
Team RunTieBreaker(List<Team> teamsToTieBreak)
{
    if(teamsToTieBreak.Count == 1)
        return teamsToTieBreak[0];
    //Do tiebreaker
} 
```

或者，您可以执行`OrderBy`and `Take(2)`。然后你可以运行`Where`和/或`Any`对抗第二队。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-17T21:38:18.410

做这样的事情：

```
var result = currentRound.Teams.OrderBy(t => t.Score).GroupBy(t => t.Score).Take(2);
if (result.Sum(m => m.Count()) > 2)
{
    //Need extra round
}
else
{
    //No extra round
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-17T21:29:49.813

我总是喜欢在我的程序中始终确保不可能有领带。所以如果这是一个掷硬币的游戏，我总是会有奇数的掷球。有了这样的东西，你可以结合时间，或者你可以添加奖励积分来表示准确性。或者，您可以列出连续正确回答的大多数答案。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-17T21:30:46.387

按分数对球队进行排序并采用第二个元素。只选择分数大于或等于该分数的球队。如果您获得超过 2 支球队 - 所有得分等于该分数的球队都会进入决胜局。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-04-17T21:33:24.687

```
List<Team> n = [total teams in round];
int x = [number moving to next round];

OrderTeamsByScore(n);
// get participants by score uses value of x to determine whether tie-break is needed
Team p = RunTieBreaker(GetTeamsByScore(n[x-1].Score, x)); //zero based array 
```

注意：如果只有1支球队的得分为“n[x-1].Score”，则默认为抢七；如果不需要 tie break 则默认返回 "n[x-1]"

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-04-17T21:38:21.457

获得排位线以上的最低分数，并计算有多少支球队拥有该分数或更高：

```
int qualifyingCount = 2;
int score =
  currentRound.Teams.Select(t => t.Score)
  .OrderByDescending(s => s)
  .Take(qualifyingCount).Last();

if (currentRound.Teams.Count(t => t.Score >= score) > qualifyingCount) {
  // tie break needed
} 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-04-17T21:49:38.563

按照此步骤操作，您将获得获胜者名单和并列球队名单。**通过这两个列表，您可以回答您的三个问题。**

**1)**按分数排序。 **2)**确定并列球队的得分。如果没有平局，则设置-1。 **3)**获取非并列获奖者名单。如果每个人都被捆绑，则此列表为空。 **4)**获取并列球队名单。如果没有平局，则此列表为空。 **5）**检查葡萄酒，是否有领带或您需要的任何东西。

```
var orderedTeams = currentRound.Teams.OrderBy(t => t.Score).ToList();
int tieScore = orderedTeams[1].Score == orderedTeams[2].Score ? orderedTeams[1].Score : -1;
List<Team> winers = tieScore > 0 ? orderedTeams.Where(t => t.Score > tieScore) : orderedTeams.Take(2).ToList();
List<Team> tiedTeams = orderedTeams.Where(t => t.Score == tieScore).ToList();
bool needTieBreak = tiedTeams.Count > 0; 
```

# php - 如何使用 JS、PHP 或 HTML 刷新 HTML 页面

> ID：10199385
> 
> 赞同：0
> 
> 时间：2012-04-17T21:24:13.600
> 
> 标签：php, javascript, html

我花了两天时间尝试在 PHP 中创建登录/注销面板。我正在使用一个 PHP 文件来检查您是否已经通过会话变量登录并回显相应的“面板”。

我遇到的问题是，在登录和注销后，我必须刷新页面才能真正出现另一个面板。我发现在 PHP 中已经完成了，`header()`但我在实现它时遇到了问题，因为我总是得到标头已发送的东西。无论如何，经过几个小时后，我决定使用 javascript，所以我创建了一个基本`redirect(url)`函数，它接受一个 URL 并打开该页面，然后我传递`$_SERVER["PHP_SELF"]`给该页面，所以我回到同一页面，基本上令人耳目一新。但现在我在想，如果有人禁用 JS，我会遇到问题。

我不知道的任何替代方案？干杯

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-17T21:52:42.900

Javascript解决方案：

```
var newURL = "http://THE-URL.com";
document.location.href = newURL; 
```

或者

```
location.reload(true); 
```

HTML 解决方案：

```
<meta http-equiv="refresh" content="2;url=http://THE-URL.com"> 
```

PHP解决方案：

```
// taken from http://www.phpfreaks.com/forums/index.php?topic=228678.0
function redirect($loc){
    echo "<script>window.location.href='".$loc."'</script>";
}
function GoHere(){
    redirect('http://THE-URL.com');
} 
```

或者

```
header( "refresh: 2; url='http://THE-URL.com'" ); 
```

用户解决方案：

```
Press F5 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-17T21:36:22.597

`<?php`在开始标记之前或结束标记之后删除空格、换行符或其他垃圾，`?>`以解决***标头已发送***问题

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-17T21:34:10.850

尝试使您的注销脚本成为自己的页面。使注销链接指向那里，然后取消设置会话变量。您可以获取页面引用者并将其发送回给它。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2012-04-17T21:29:09.027

要解决已经发送的 headers 的问题，只需添加：

```
ob_start(); 
```

在代码的开头。

# ruby-on-rails - 如何防止 gmaps4rails 在迁移期间进行地理编码

> ID：10199386
> 
> 赞同：1
> 
> 时间：2012-04-17T21:24:23.473
> 
> 标签：ruby-on-rails, migration, gmaps4rails

我正在使用：

```
acts_as_gmappable :process_geocoding => true, :check_process => false 
```

但是当我进行迁移时，我发生了各种奇怪的事情，因为它正在重新编码所有内容，我认为谷歌暂时阻止了我的洪水或其他事情。有没有办法将 :process_geocoding 临时设置为 false？我在任何地方的文档中都找不到提及它，只是最初如何设置它。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-22T22:27:01.993

我不知道您如何进行迁移。

您想要的想法是更改`gmaps4rails_options`实例方法（[此处为源代码](https://github.com/apneadiving/Google-Maps-for-Rails/blob/master/lib/gmaps4rails/acts_as_gmappable.rb#L59)）。

使用 a`class_eval`或 an`instance_eval`即时更改它。

# wordpress - wordpress 如何强制从所有页面重定向到主页

> ID：10199389
> 
> 赞同：0
> 
> 时间：2012-04-17T21:24:29.793
> 
> 标签：wordpress, .htaccess

我有一个单页 wordpress 网站。它使用页面和帖子，但都以编程方式包含在核心模板中。我不希望用户意外访问单个帖子（即使这不太可能发生）。我宁愿也不必使用 404 模板，因此将每个页面重定向到主页会很棒。在不干扰默认 .htaccess 规则的情况下，这很容易做到吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-18T10:10:09.747

尝试使用[这个插件。](http://wordpress.org/extend/plugins/redirection/) 它允许重定向所有 URL。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-18T12:49:08.153

将此行代码添加到您的 htaccess 文件中：

`redirect 301 / http://www.yoursiteurl.com/`

将“yoursiteurl”替换为您的实际域。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-19T11:55:31.253

我最终使用了[这个插件](http://wordpress.org/extend/plugins/quick-pagepost-redirect-plugin/)并手动重定向每个页面，从而使不相关的页面抛出 404 错误。这不是我想要的，但最终它是最佳实践。

# android - 禁用 cwac-merge 适配器

> ID：10199397
> 
> 赞同：1
> 
> 时间：2012-04-17T21:24:59.683
> 
> 标签：android, android-listview, android-adapter, commonsware-cwac

几天前我发现了一个很棒的项目，叫做[https://github.com/commonsguy/cwac-merge](https://github.com/commonsguy/cwac-merge)。

我想禁用一些适配器（不可点击，如标题）。

在自述文件中，我可以阅读：

> 您还可以扩展 MergeAdapter 以覆盖 isEnabled()，因此您可以控制启用和不启用的位置。

但我无法意识到，我该怎么做。即源 isEnabled 方法：

```
 @Override
  public boolean isEnabled(int position) {
    for (ListAdapter piece : pieces) {
      int size=piece.getCount();

      if (position<size) {
        return(piece.isEnabled(position));
      }

      position-=size;
    }

    return(false);
  } 
```

这是我的适配器的添加代码：

```
 adapter.addView(header("Header1"),false);
            SimpleAdapter test = new SimpleAdapter(Test.this, top, R.layout.main,  
                    new String[] { ITEM_TITLE2, ITEM_CAPTION2, ITEM_TITLE3 }, new int[] { R.id.id1, R.id.id2, R.id.id3 });
            adapter.addAdapter(test1); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-17T22:04:55.050

第 1 步：创建您自己的自定义子类`SimpleAdapter`.

步骤#2：覆盖`isEnabled()`您的自定义子类，`true`根据`false`需要返回。

对于 README 中令人困惑的语言，我深表歉意——我会尽快更新。

# node.js - Express+jade：局部变量在视图中不可用

> ID：10199400
> 
> 赞同：15
> 
> 时间：2012-04-17T21:25:09.077
> 
> 标签：node.js, express, pug

我遇到了一个非常基本的问题，但我似乎找不到答案。我正在使用`node.js`，`express`我只是想将一个局部变量传递到这样的视图中：

```
 app.get('/', function(req, res){
  res.render("index", {locals: {
    title: "Blog",
    }
  });
}); 
```

我的索引视图同样简单：

```
h1= title 
```

但是由于某种原因，我不断收到此错误，就好像从未传递局部变量一样：

```
 500 ReferenceError: /home/spartan/Node_Projects/test/views/index.jade:1 > 1| h1= title 2| title is not defined
> 1| h1= title
  2| title is not defined 
```

我不知道我做错了什么！以下是我正在使用的版本：

*   快递：3.0.0alpha1
*   节点.JS：0.6.14
*   翡翠：0.24.0

有人请帮忙，这样我就可以继续学习节点+快递了！

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2012-04-18T08:24:10.453

您应该传递不带`locals`. 这可能是 express 3.0.0 中的新功能

```
res.render("index", {title: "Blog"}); 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-04-17T22:17:24.120

h1 = title 尝试在本地评估它，您发送的标题和那个不同。要了解差异，请参阅：

```
- var title = 'my title' // - allows writing code
h1 = title 
```

您应该使用的是：

```
h1 #{title} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-18T11:50:19.967

[Here is a response](https://stackoverflow.com/a/10199840/1265207) that I made few hours ago to a smiliar question (+ deal with layout). It shows how to pass data when rendering. (Express 3.0.0 complient)

# php - Yii - 捕获所有传入的请求

> ID：10199406
> 
> 赞同：1
> 
> 时间：2012-04-17T21:25:26.350
> 
> 标签：php, yii

Yii 有没有办法在函数被触发时捕获并处理所有传入的请求。我想纠正一个可以设置为类似的电子邮件扩展名，当文档/更新被触发或功能 SaveDocument 被触发时发送电子邮件 x。

我猜我可以通过扩展 Controller 类来做到这一点，但这已经通过权限扩展来完成。

感谢您的任何建议。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-17T22:25:04.603

创建一个类过滤器 protected/filter/EmailFilter

```
EmailFilter extends CFilter{
//fired before action
protected function preFilter($filterChain)
{
 return true; // false if the action should not be executed
}
 //fired after action
 protected function postFilter()
 {
     sendEmail();

 }
} 
```

在你的控制器中

```
public function filters()
 {
  return array(
  'application.filters.EmailFilter + update,saveDocument'// apply filter on update and       saveDocument action only
 );
 } 
```

# java - JPA2 EntityManager 为空

> ID：10199408
> 
> 赞同：0
> 
> 时间：2012-04-17T21:25:42.600
> 
> 标签：java, mysql, jpa, jsf-2, persistence

代码在这里：http: [//github.com/knownasilya/Ambience](http://github.com/knownasilya/Ambience)

我正在通过我的和我的管理类测试持久性，我用注释`index.xhtml`实例化了 EntityManager 。`@PersistenceContext`每次运行此示例时，我都会在`em.persist(another);`.

我的`persistence.xml`设置与 Eclipse 中的本地数据库配置具有相同的连接信息。我怎样才能找出错误在哪里？

**编辑**这里是相关文件。

Index.xhtml [https://github.com/knownasilya/Ambience/blob/master/g5.ambience/WebContent/index.xhtml](https://github.com/knownasilya/Ambience/blob/master/g5.ambience/WebContent/index.xhtml)

Admin.java [https://github.com/knownasilya/Ambience/blob/master/g5.ambience/src/g5/ambience/user/admin/model/Admin.java](https://github.com/knownasilya/Ambience/blob/master/g5.ambience/src/g5/ambience/user/admin/model/Admin.java)

persistence.xml [https://github.com/knownasilya/Ambience/blob/master/g5.ambience/src/META-INF/persistence.xml](https://github.com/knownasilya/Ambience/blob/master/g5.ambience/src/META-INF/persistence.xml)

**EDIT2**我创建了一个 UserDAO，但是当我尝试在第 24 行专门创建 EntityManager 时，我仍然得到一个 NPE

```
EntityManager em = emf.createEntityManager(); 
```

有了这个错误`Caused by: java.lang.NullPointerException at g5.ambience.user.UserDAO.<init>(UserDAO.java:24)`

UserDAO.java [https://github.com/knownasilya/Ambience/blob/master/g5.ambience/src/g5/ambience/user/UserDAO.java](https://github.com/knownasilya/Ambience/blob/master/g5.ambience/src/g5/ambience/user/UserDAO.java)

**EDIT3**我现在有 3 层抽象/封装。模型（用于持久性的 getter/setter）、业务逻辑和视图逻辑。

我在这里有我的实​​体工厂：http: [//bit.ly/HV4d11](http://bit.ly/HV4d11)，这是一个应用程序范围的托管 bean。然后我有 ManagedUserBean [http://bit.ly/In19rX](http://bit.ly/In19rX)`getUserByUsername`当我通过 UserView [http://bit.ly/In1ta6](http://bit.ly/In1ta6) （会话范围）调用方法时，它仍然给了我一个 NPE 。仍然没有运气，错误在 EntityManager 创建上，这是我的 stackTrace：[http://pastie.org/3814236](http://pastie.org/3814236)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-18T12:50:17.850

UserDAO 需要是一个 EJB bean，例如 @Stateless 才能使用 @PersistenceContext 注释。好的设计模式是创建两层

*   Backing beans - 用于 UI 的托管 bean，您可以在 XHTML 中使用它们。
*   服务层，也就是你所说的 DAO——实现基本业务逻辑的无状态 bean

您决定什么是业务逻辑，什么是 UI 相关逻辑。

如果使用 JEE6 CDI 解决方案，则无需在 faces-config.xml 中声明托管 bean

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-18T13:19:00.780

问题是您将“Active Record”模式与“DAO”模式混淆了。

如果你想在 Java 中使用“Active Record”模式，最好的选择是使用[Spring Roo](http://static.springsource.org/spring-roo/reference/html/architecture.html#architecture-dao)或 Play 框架（< 2.0）。

否则你会想要遵循传统的 DAO + Service 模式（我相信 Roo 1.2.1 现在支持这种模式）。

*编辑：回到这个问题之后，我强烈建议您使用 Spring Roo，这样您就可以看到不同的设计模式是如何工作的，因为 Roo 现在支持两者。它还将在许多其他事情中正确设置实体管理器。从长远来看，您不必使用 Roo。您只需查看脚手架代码即可了解正确的方法。*

# ruby-on-rails - 如何仅从 facebook 获取名称列表 - 使用 RoR、fb_graph gem

> ID：10199409
> 
> 赞同：0
> 
> 时间：2012-04-17T21:25:45.127
> 
> 标签：ruby-on-rails, fb-graph

目前，我正在使用 fb_graph gem 来获取朋友列表：

```
FbGraph::User.me(fb_token).friends 
```

但是，这会返回一个包含许多字段的庞大数组，例如姓名、性别、语言等。我想过滤所有字段并获得一个朋友列表。

我可以遍历提取名称的列表，但是，我正在寻找更有效的方法。

我在想类似的事情：

```
FbGraph::User.me(fb_token).friends(:name) 
```

有人知道怎么做吗？gem 的链接是[https://github.com/nov/fb_graph](https://github.com/nov/fb_graph)

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-17T22:59:41.167

您的目标是最终获得名称数组以供后续使用，还是避免从 FB 检索如此多的数据？

您可以使用类似的名称获取名称数组

```
FbGraph::User.me(fb_token).friends.map {|f| f.name } 
```

那应该会产生您想要的最终结果。不过，它不会减少从 FB 提取的数据量 - 不幸的是，我没有使用足够的 fb_graph 来帮助那里。

# php - php preg_split 和 UTF-8 符号

> ID：10199412
> 
> 赞同：1
> 
> 时间：2012-04-17T21:25:48.990
> 
> 标签：php, utf-8, preg-split

谁能解释一下，为什么这段代码

```
$string='6аd_ТЕХТ GOOD_TEXT';
$words = preg_split('/\s+/', $string, NULL, PREG_SPLIT_NO_EMPTY);

var_dump($words); 
```

显示

```
array(2) { [0]=> string(8) "6àd_ÒÅÕÒ" [1]=> string(9) "GOOD_TEXT" } 
```

代替

```
array(2) { [0]=> string(8) "6аd_ТЕХТ" [1]=> string(9) "GOOD_TEXT" } 
```

我已经阅读了有关此问题的信息，但添加了 /u ：

```
preg_split('/\s+/', $string, NULL, PREG_SPLIT_NO_EMPTY);// '/\s+/' 
```

成为

```
preg_split('/\s+/u', $string, NULL, PREG_SPLIT_NO_EMPTY);// '/\s+/u' 
```

没有帮助。如何解决这个问题？

谢谢你。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-17T21:56:57.337

您的代码中还发生了所提供示例中不存在的其他内容。测试了提供的示例，它按预期工作。如果这种*情况*确实发生（并且没有其他代码影响`$string`），这可能是您正在使用的特定 PHP 版本的错误，可以通过升级 PHP 来解决（但它不太可能是一个问题与 PHP）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-17T21:56:48.837

...我说是斜线，但显然是 utf-8 的东西使它工作。

编辑：我删除了其余部分，发现我需要的只是 xml 行以使其在浏览器中工作。

```
<?php
ini_set('default_charset','utf-8');
header('Content-type: text/html; charset=utf-8');

echo '<?xml version="1.0" encoding="UTF-8"?'.'>
<html><head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
</head><body><pre>
';

$string = "6аd_ТЕХТ GOOD_TEXT";
var_dump(preg_split('/\s+/u', $string, NULL, PREG_SPLIT_NO_EMPTY));

echo '</pre></body></html>'; 
```

这是输出：

```
array(2) {
  [0]=>
  string(13) "6аd_ТЕХТ"
  [1]=>
  string(9) "GOOD_TEXT"
} 
```

# node.js - Jade 模板布局不能与 Node.js 结合使用

> ID：10199415
> 
> 赞同：16
> 
> 时间：2012-04-17T21:26:20.540
> 
> 标签：node.js, express, pug

我正在尝试在 Node.js 中创建一个使用 Jade 模板和布局的简单服务器。由于某种原因，它只会加载模板而不是布局。

这是我所拥有的：

**main.js**

```
var express = require('express');

var app = express.createServer();

app.set('views', __dirname + '/views'); 
app.set('view engine','jade');
app.set('view options', {
 layout: true
});

app.get('/', function(req,res) {
res.render('index', { title: 'My site' });
});

app.listen(4000); 
```

如您所见，布局已启用。我试过直接在渲染方法中引用它，但它没有任何区别。值得注意的是，“标题：'我的网站'”也不起作用。

**索引.jade**

```
h2 Hello!
p I really hope this is working now 
```

**翡翠**

```
!!! 5
html
  head
    title Why won't this work
  body
    h1 I AM A LAYOUT
    div= body 
```

这是我的`npm list`：

```
├─┬ express@3.0.0alpha1 
│ ├── commander@0.5.2 
│ ├─┬ connect@2.1.2 
│ │ ├── crc@0.1.0 
│ │ ├── formidable@1.0.9 
│ │ ├── mime@1.2.4 
│ │ └── qs@0.4.2 
│ ├── debug@0.6.0 
│ ├── mime@1.2.5 
│ └── mkdirp@0.3.1 
└─┬ jade@0.24.0 
  ├── commander@0.5.2 
  └── mkdirp@0.3.0 
```

关于为什么这不起作用的任何想法？

* * *

## 回答 #1

> 赞同：35
> 
> 时间：2012-04-17T22:01:31.507

我认为您的布局方式错误。我这样做：

我将布局设置为 false ：

```
app.set('view options', {
    layout: false
}); 
```

在 layout.jade 文件中：

```
doctype 5
html(lang="en")
    head
        title MySite #{title}
body
    block mainContent 
```

在呈现的页面中（比如说：home.jade），其中包含一个变量（内容）

```
extends layout

block mainContent
    h1 This is home
    p= content 
```

您可以拥有基于（扩展）具有不同变量（用户）的相同布局（other.jade）的另一个页面

```
extends layout

block mainContent
    h1 Oh look ! Another page
    p= user 
```

并这样称呼他们：

```
app.get('/', function(req, res) {
    res.render('home', { 
        title : "Home",
        content: "Some Home page content"
    });
});

app.get('/anotherPage', function(req, res) {
    res.render('other', { 
        title : "Other page",
        user: "Here goes a user name"
    });
}); 
```

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2012-04-19T19:47:32.450

这似乎是对 Express/jade 最新版本的更改。

```
Express:  '3.0.0alpha1': '2012-04-18T22:47:46.812Z'
Jade:     '0.25.0':      '2012-04-18T22:40:01.162Z' 
```

也抓到我了！

其他几件事也发生了变化——我花了一段时间才解决。

不幸的是，Express & Jade 并没有特别完善的文档记录，而且您在网上找到的许多示例都已过时。

Arnaud 现在提供了使用布局的新方法。我不知道旧方法是否有效。当然，当我尝试类似 dtyon 的东西时，它似乎不再起作用了。

因此，使用以下命令检查您安装的 Express & Jade 版本：

```
npm show express dist.tarball
npm show jade dist.tarball 
```

希望这可以帮助。J。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2014-04-14T04:44:37.930

我有同样的问题，只是让人们知道，布局在 express/jade 中工作的新方式是默认情况下布局已经扩展，并且您的块自动作为“body”变量传递

例如

索引.jade

```
/* This will be passed as "body" no need for "block body" */
h1= title
p Welcome to #{title} 
```

布局.jade

```
doctype
html
  head
    meta(charset='utf-8')
  body
    /* body is output here using != which outputs variable without escaping characters */
    section!= body 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2012-04-17T21:34:55.680

据我所知，默认情况下布局文件应命名为“layout.jade”。但是，如果您想要一个不同的名称，您可以在渲染时使用“布局”提示选项：

```
res.render('index', { layout: 'lo', title: 'My site' }); 
```

我还假设**lo.jade**布局文件位于根目录`/views/`中。

# c - 在c中标记一个句子的单词

> ID：10199416
> 
> 赞同：1
> 
> 时间：2012-04-17T21:26:24.753
> 
> 标签：c

我正在尝试将一个句子标记为仅由单个空格分隔的单词。我需要从句子中获取单词，然后将它们写入订阅数组。这是我的工作：

```
void writeToStrArrayOneByOne(char words[10][20], char *sentence){

       char *tokenPtr;
       int j = 0;
       int a,i;
       tokenPtr = strtok(sentence," ");

       while(tokenPtr != NULL){

          a = strlen(tokenPtr);

          for(i=0;i<a;i++){

                words[j][i] = tokenPtr[i];
          }
          tokenPtr = strtok(NULL," ");
          j++;

       } 
```

我只用这个来调用函数，以便从 main 进行调试：

```
 char words[10][20];
     char *sentence = "this is a token";
     writeToStrArrayOneByOne(words,sentence); 
```

但是，它像 EOF 异常时一样冻结。感谢任何帮助，谢谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-17T21:30:00.470

`strtok()`修改它传递的字符串。你给它一个不能修改的字符串文字。

尝试：

```
char sentence[] = "this is a token"; 
```

这将`sentence`生成一个可修改的字符数组。

还要记住，复制标记的循环不会在每个条目的末尾放置一个空终止符——我怀疑你可能会想要这些。也许尝试：

```
strcpy(words[j], tokenPtr); 
```

您应该考虑的其他事项包括：

*   处理可能太长的令牌
*   获取带有太多标记的字符串
*   如果令牌之间有多个空格，则需要做什么-`strtok()`如果对您很重要，则不处理（我之所以提到这一点只是因为在您的问题中您特别提到令牌“仅由一个空格分隔”）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-17T21:34:40.330

好吧，也许这可以帮助你：

```
char** split (char* string, const char* delim) {
   char* p;
   int i = 0;
   char** array;

   array = malloc(strlen(string) * sizeof (char*));
   p = strtok (string, delim);
   while (p != NULL) {
      array[i] = malloc(sizeof(char) );
      array[i++] = p;
      p = strtok(NULL, delim);
    }
  return array;
} 
```

然后在`main`：

```
char s[128] = "Est2,2011,11,02,00,10,madrid,-3.467,44.3578,17.0";
char **array = split(s, ",");
int i = 0;
while (*array){
    printf("[%s]\n", *array++);
    i++;
} 
```

希望能帮助到你。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-17T22:36:42.047

请记住，字符串以 '\0' 作为分隔符结束，这意味着其中包含“a”的数组 arr 是 2 个字符长（arr[0] 是 'a'，arr[1] 是 '\0' 你可能想要写。

```
a = strlen(tokenPointer) + 1 
```

strncopy 也可能有用，它是带有第三个参数的 strcopy，它是要复制的字符串的长度。

它将节省您遍历字符串的时间，并且简化您的函数可能对您很有价值。

enrmarc 是正确的，动态分配内存是您可能执行的一种方式，您可以使一个参差不齐的数组具有您需要的确切大小。您还可以调用指向字符串的指针数组 IE char* stringArr[10]，然后将 stringArr[0] 分配给您的第一个令牌，依此类推。我会假设这不是你想要的。

遵循 Michael Burr 的建议，您的函数定义应该看起来更像：

```
void writeToStrArrayOneByOne(char words[][], char sentence[]) 
```

最后，调试很困难，我没有完全回答你的问题。使用一些预处理器宏使其更容易。尝试使用以下内容：

```
#define PRINT_CVAL(a) printf(#a "contains %c\n", a) 
```

您可以将 CVAL 中的 C 和 %c 更改为 I 和 %d 用于整数等等，它可以帮助您了解您的程序中哪里有问题。

# c# - 如何使用大文件 I/O（读、写）和计算优化例程？

> ID：10199421
> 
> 赞同：1
> 
> 时间：2012-04-17T21:26:47.847
> 
> 标签：c#, performance, .net-4.0

我知道他们说过早的优化是万恶之源……但就是那个时候。

我有一个缓慢但可以执行以下操作的工作程序：

1.  从 file.input 读取块（顺序）
2.  变换块
3.  将转换后的块写入（附加）到 file.output

file.input 和 file.output 最终处于相同大小的范围内（10-100+ GB）。一个块通常约为 10K。转换步骤只是专有格式之间的转换。为了便于讨论，我们可以认为它在计算上与实时压缩算法相当。

这些步骤目前在单个线程中完成。

**我的问题：如何让这个表现更好？**

我意识到基于正在处理的纯数据量，这永远不会变得“快”，但我必须相信有一些相对简单和标准的技术可以让这个更快。

我尝试在读取步骤 (1) 中添加缓冲。也就是说，读取比块大小大得多的块并从缓冲区中读取。这有帮助。但是，对于转换步骤 (2) 和附加 (3) 是否可以做任何事情，我有点坚持。

根据 Resource Monitor，我的 CPU 使用率在 30-45% 之间波动，磁盘 I/O 有一些持续的低使用率。

我将 C# 与一堆 P/invoke 互操作与本机库一起使用。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-17T21:39:39.740

首先，不要在这种情况下添加线程，它们不会提高你的性能。（当然，如果您的应用程序有 UI 界面，您可以添加一个线程来执行您的密集工作并让用户继续执行其他任务）

其次，尽量减少磁盘上的 IO。尽可能多地读取字节并一起写入。第三，您最好的选择可能是优化您的转型工作。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-17T21:37:08.597

首先，您应该验证所有步骤都占用了大部分时间——如果瓶颈只是一个步骤，那么我们在这里看错了图片。

磁盘 I/O 可能需要一些时间，在此期间 CPU 可用于其他任务，因此多线程解决方案可以提高性能。也许您可以使用一个线程来不断填充缓冲区，最多可处理 10 个可处理数据块，一个处理第一个加载的任何块，另一个简单地写入已完成处理的任何块。然后一对`AutoResetEvents`可以通知每个线程前一个线程已完成处理一个或多个块。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-17T21:40:31.433

措施

*   1（简单的顺序读取无处），
*   3（随机字节的简单顺序写入）
*   1+3（读取并立即复制到大小合理的块 16K-64k-512k-1Mb）
*   2（只是计算）

比看看你的数字，看看重叠是否能带来任何可观的好处。45% 的 CPU 负载并不算太糟糕，所以你最好保持原样。

您可以获得的最佳结果是 Max(1, 2, 3)，因此请相应地计划优化。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-04-17T21:34:53.757

如果您使用的是 .NET 4，则可以尝试[MemoryMappedFile](http://msdn.microsoft.com/en-us/library/system.io.memorymappedfiles.memorymappedfile.aspx)和[MemoryMappedViewAccessor](http://msdn.microsoft.com/en-us/library/system.io.memorymappedfiles.memorymappedviewaccessor.aspx)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-04-17T21:48:45.773

您的主要问题将是 I/O。您在 2 个文件之间交替的事实使事情变得更糟。

*   缓冲读取和写入。大动作更好，在这种情况下，更少的动作也更好。

由于还有一个 CPU 密集型部分，我会尝试使用线程。为了尽量减少等待，我会使用管道：ReaderThread -> Queue -> ProcescessingThread -> Queue -> WriterThread

# c# - 从网页映射网络打印机

> ID：10199425
> 
> 赞同：0
> 
> 时间：2012-04-17T21:27:04.863
> 
> 标签：c#, printing, wmi

简而言之，我有一个指向我地板上的网络打印机的图像映射。我希望我的用户单击与网络打印机 X 关联的给定坐标。当他们使用 IE 版本 7 到 9 单击此坐标时，我希望映射该打印机。如果可以（稍后），我可能想将其设置为他们的默认打印机。

我可以使用 WSH/VBS、PowerShell、批处理文件、C# Windows 应用程序编写的本地程序以多种方式执行此操作，但似乎无法像我通过网页在此处说明的那样简单地执行它。

要求是内部用户应该非常简单。“单击 > 是 > 是 > 完成”。我可以控制浏览器，所有用户都在内部安全网络上。

任何想法都是最受欢迎的。肖恩

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-17T21:29:35.197

我怀疑您是否能够通过网页进行操作。

默认情况下，可以通过基于浏览器的应用程序完成的操作仅限于客户端，以防止恶意开发人员制作更改用户机器配置的网站。

也就是说，您可以制作一个[ActiveX 控件来执行此操作](http://msdn.microsoft.com/en-us/library/aa229115%28VS.60%29.aspx)（但不是通过 .NET），我认为您需要使用更旧的 VB6 或 C++）。这与通过网页进行操作完全不同，而且不适合胆小的人。

你真的需要一个客户端解决方案。

在 .NET 中最接近基于 Web 的解决方案是编写客户端应用程序并通过[ClickOnce](http://msdn.microsoft.com/en-us/library/t71a733d%28VS.80%29.aspx)部署它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-17T21:33:31.567

我知道这样做的唯一方法是编写一个[签名的 ActiveX 控件](https://stackoverflow.com/questions/4549465/how-to-sign-an-activex-dll-with-a-certificate)（仅限 IE），它允许您执行任何您想要的操作。

（从技术上讲，您可以编写一个未签名的 activeX 控件，但解决 IE 中的安全证书问题很可能是一场噩梦）

# android - Android：找不到类异常：android.support.v4.app.FragmentPager

> ID：10199430
> 
> 赞同：21
> 
> 时间：2012-04-17T21:27:21.843
> 
> 标签：android, classnotfoundexception

在我的代码中我导入`android.support.v4.view.ViewPager` 但是`ClassNotFoundException: android.support.v4.view.ViewPager`当我将内容视图设置为此 xml 文件时我得到一个：

```
...
 <android.support.v4.app.FragmentPager 
     android:layout_height="0px" 
     android:layout_width="match_parent" 
     android:layout_weight="1" 
     android:id="@+id/pager"> 
     </android.support.v4.app.FragmentPager>
... 
```

* * *

## 回答 #1

> 赞同：41
> 
> 时间：2012-04-17T21:31:01.107

您必须通过右键单击您的项目并选择**Android Tools -> Add Compatibility Library 添加兼容性库**。添加后，清理您的项目并再次构建。

* * *

![在此处输入图像描述](../Images/e4162b19b930108f03b9f0ea1abdbcb4.png)

* * *

## 回答 #2

> 赞同：33
> 
> 时间：2014-08-29T16:28:30.277

我正在使用`Android Studio Beta 0.8.6`，我必须这样做

* * *

**文件 -> 项目结构** ![在此处输入图像描述](../Images/90015cd2568f7664a021c757372584db.png)

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2013-10-30T02:10:41.290

转到`<Your android apk folder>\sdk\extras\android\support\v4`文件夹并添加`android-support-v4.jar`到应用程序库（或整个 sdk 库）。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2013-07-29T09:46:36.097

通过右键单击您的项目并选择 Android 工具 -> 添加兼容性库来添加支持库。添加支持库后清理您的项目并转到 Java 构建路径，转到订购和导出 [最后一个选项卡] 单击所有当前添加的 Jar 文件和库..按确定并刷新您的项目..它对我来说很好..

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-04-17T21:30:50.453

您应该将 android.support.v4 jar 添加到您的应用程序中。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2015-07-13T08:59:36.167

如果它不是基于 gradle，那么您应该将基于 Eclipse ADT 的项目迁移到基于 Gradle 的项目。将项目导入到 android studio 中。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2016-04-08T10:04:56.310

我遇到了这个问题，请右键单击您的项目并单击 Android 工具，现在单击支持库，然后接受许可证立即运行您的项目它将工作：D

RightClick==>Android 工具==>支持库==>接受许可

# visual-studio-2010 - 从 Visual Studio 2010 中的代码覆盖率中免除代码

> ID：10199432
> 
> 赞同：0
> 
> 时间：2012-04-17T21:27:24.010
> 
> 标签：visual-studio-2010, code-coverage

在 Visual Studio 2010 中，包含一个项目用于代码覆盖率分析。有什么办法可以让这个项目中的文件免于代码覆盖？

谢谢，

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-18T03:29:29.750

如果是 .NET，您可以使用[ExcludeFromCodeCoverage](http://msdn.microsoft.com/en-us/library/dd984116.aspx)属性排除类/方法等

# meteor - Meteor 中的包类范围

> ID：10199444
> 
> 赞同：2
> 
> 时间：2012-04-17T21:28:08.853
> 
> 标签：meteor

我在编写包时遇到了一些问题，也许有人可以提供帮助。我正在尝试包含新的 npm 模块并将它们添加到 Meteor 类中。

因此，例如在我的 package.js 中，我声明：

```
mongoose = require('mongoose'); 
```

这很好用，我可以控制台记录它并显示对象。但是在里面`Package.on_use(`我不能使用 Meteor 类：`Meteor is not defined` - 在使用 Meteor 类之前，我什至尝试过使用启动包而不看。

和

在包含使用的 js 文件中：`api.add_file`我无法获取 mongoose 类： `mongoose is not defined`

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-19T01:22:22.903

似乎解决方案是在 add_file 文件中使用：

```
var require = __meteor_bootstrap__.require; 
```

这样我就可以在那里使用 require 。

* * *

编辑：这实际上并不能解决所有用例，因为它只运行服务器端，所以要么我需要一个可以在客户端和服务器端工作的解决方案，要么需要一种在包文件夹中声明需求并使用它的返回值的方法.

# python - 使用 CPython 时，简单程序（2 个 for 循环）在 PyPy 中崩溃

> ID：10199445
> 
> 赞同：1
> 
> 时间：2012-04-17T21:28:09.510
> 
> 标签：python, pypy

这是一个为解决 CodeJam 的[回收号码](https://code.google.com/codejam/contest/1460488/dashboard#s=p2)而编写的简单程序（我知道它可以改进）。

它适用于 CPython，但在 PyPy v1.8 中崩溃并出现以下错误：

```
RPython traceback:
  File "jit_metainterp_compile.c", line 19477, in send_loop_to_backend
  File "jit_backend_x86_assembler.c", line 2293, in Assembler386_assemble_loop
  File "jit_backend_x86_regalloc.c", line 462, in RegAlloc_prepare_loop
  File "jit_backend_x86_regalloc.c", line 1027, in RegAlloc__prepare
  File "jit_backend_x86_regalloc.c", line 3657, in RegAlloc__compute_vars_longevity
Fatal RPython error: AssertionError
[1]    8440 abort      pypy cj.py 
```

代码：

```
#!/usr/bin/env python2

def permutations(a,b,x):

    y = str(x)
    cnt = 0
    for i in range(1,len(y)):
        j = int(y[i:]+y[:i])
        if j == x:
            break
        elif j > x and j >= a and j <= b:
            cnt += 1

    return cnt

nc = int(raw_input())
for c in xrange(nc):
    a, b = map(int,raw_input().split())

    cnt = 0
    for i in range(a,b+1):
        cnt += permutations(a,b,i)

    print "Case #%i: %i" % (c+1, cnt) 
```

样本输入：

```
4
1 9
10 40
100 500
1111 2222 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-17T21:53:28.413

这看起来像一个错误。实际上，它可能与此错误报告有关：

[https://bitbucket.org/pypy/pypy/issues/1075/](https://bitbucket.org/pypy/pypy/issues/1075/)

尝试最新的每晚。

# verilog - 用于 SRAM 接口的 Verilog 双向总线

> ID：10199448
> 
> 赞同：1
> 
> 时间：2012-04-17T21:28:20.743
> 
> 标签：verilog, bidirectional

我们正在尝试写入 Terasic DE1 FPGA 板上的 SRAM 芯片，但是我们遇到了与三态控制有关的错误。错误如下：

```
Error (10137): Verilog HDL Procedural Assignment error at inputOutputControl.v(32): object "SRAM_DATA" on left-hand side of assignment must have a variable data type
Error (10137): Verilog HDL Procedural Assignment error at inputOutputControl.v(33): object "SRAM_DATA" on left-hand side of assignment must have a variable data type
Error (10219): Verilog HDL Continuous Assignment error at inputOutputControl.v(52): object "SRAM_LB_N" on left-hand side of assignment must have a net type
Error (10219): Verilog HDL Continuous Assignment error at inputOutputControl.v(53): object "SRAM_UB_N" on left-hand side of assignment must have a net type 
```

我们遇到问题的模块如下所示，任何人都可以阐明我们如何使其工作吗？

```
module ram_writer(
input               CLK,
input               RESET_N,
input               V_PORCH_EN,
input               LOGIC_WE_N,
input               LOGIC_CE_N,
input        [17:0] LOGIC_WRITE_ADDRESS,        
input        [15:0] LOGIC_WRITE_DATA,
input               VGA_OE_N,
input               VGA_CE_N,
input        [17:0] VGA_READ_ADDRESS,       
output       [15:0] VGA_READ_DATA,
output  reg         SRAM_OE_N,
output  reg         SRAM_WE_N,
output  reg         SRAM_CE_N,
output  reg         SRAM_LB_N,
output  reg         SRAM_UB_N,
output  reg  [17:0] SRAM_ADDRESS,       
inout   wire [15:0] SRAM_DATA   
);

reg [15:0] writeData;

always @(posedge CLK)
begin
   writeData       <= LOGIC_WRITE_DATA;                    
   VGA_READ_DATA   <= SRAM_DATA;
end

always @((posedge LOGIC_WE_N or writeData))
begin
   if( LOGIC_WE_N == 1) SRAM_DATA = 16'bZ;
   else SRAM_DATA = writeData; 
end

always @(posedge CLK)
begin
   if(V_PORCH_EN == 1) begin
   SRAM_ADDRESS <= LOGIC_WRITE_ADDRESS;
   SRAM_CE_N    <= LOGIC_CE_N;
   SRAM_WE_N    <= LOGIC_WE_N; 
   SRAM_OE_N    <= 1;
   end 
   else begin
   SRAM_ADDRESS <= VGA_READ_ADDRESS;
   SRAM_CE_N    <= VGA_CE_N;
   SRAM_OE_N    <= VGA_OE_N; 
   SRAM_WE_N    <= 1;
   end 
end

assign SRAM_LB_N = 0; 
assign SRAM_UB_N = 0; 

endmodule 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-17T21:58:14.040

我认为这：

```
Error (10137): Verilog HDL Procedural Assignment error at inputOutputControl.v(32): object "SRAM_DATA" on left-hand side of assignment must have a variable data type
Error (10137): Verilog HDL Procedural Assignment error at inputOutputControl.v(33): object "SRAM_DATA" on left-hand side of assignment must have a variable data type 
```

参考这个：

```
if( LOGIC_WE_N == 1) SRAM_DATA = 16'bZ;
else SRAM_DATA = writeData; 
```

'wire' 数据类型没有内存，因此您必须使用连续分配来分配它，而不是始终块。

反之在这里：

```
assign SRAM_LB_N = 0; 
assign SRAM_UB_N = 0; 
```

您不能通过连续分配来分配 reg 类型，它必须在 always 块中分配。

# php - 将参数传递给 php 页面，并在 URL 中附加值

> ID：10199449
> 
> 赞同：1
> 
> 时间：2012-04-17T21:28:28.667
> 
> 标签：php, html

假设这是我的表单域代码：

```
<form action="process.php" method="post">
<input type="text" size="25" name="username" />
<input type="text" size="25" name="password" />
</form> 
```

这两个输入框允许用户输入信息。在**process.php**，您可以以相同的方式获取变量：

```
$username = $_POST['username'];
$password = $_POST['password']; 
```

现在我想通过传递参数直接打开页面“process.php”

我用这个链接

> localhost/process.php?username=ahmed&password=123456

不工作，我知道使用**$_GET**是否可以正常工作

```
$username = $_GET['username'];
$password = $_GET['password']; 
```

但我想使用**$_POST**

我会用这种方式打开这个页面吗？？？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-17T21:30:38.013

`$_REQUEST`. `$_POST`它基本上是,`$_GET`和的合并`$_COOKIE`。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-17T21:30:54.377

如果我明白你的意思，你应该可以使用 $_REQUEST['username'] 和 $_REQUEST['password']

如果它靠近数据库，出于安全原因，我建议不要使用它，但这将允许您使用 POST 或 GET。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-17T21:31:07.840

您只能在 URL 中传递 GET 参数。要直接发送 POST 数据，您可能需要使用 CURL 之类的东西来正确格式化您的请求，以将变量包含为 POST 数据。

# c++ - 将 cpp 文件添加到 cscope 数据库

> ID：10199450
> 
> 赞同：1
> 
> 时间：2012-04-17T21:28:33.613
> 
> 标签：c++, cscope

我真的必须结合递归 grep 或 find 与 scope 一起将 .cpp 文件添加到 cscope 数据库吗？

是否有一个简单的模式匹配参数可以与 cscope 的现有 -R 参数无缝协作？

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-18T19:39:47.450

我有`cscope: version 15.7a`并将我的`.cpp`.`.cc`文件作为子目录中的源文件处理`cscope -R`。`mlcscope`在 cygwin 中的工作方式相同。

所以我们[在大型项目上使用 Cscope](http://cscope.sourceforge.net/large_projects.html)有过时的信息：

> 默认情况下，Cscope 仅解析具有 .c、.h、.y 或 .l 扩展名的文件

在最新的 cscope 资源中，我发现`static BOOL issrcfile(char *path)`了具有**硬编码**扩展集的函数：`c h l y C G H L bp qc qh sd cc hh tcc cpp cxx hpp hxx`被识别为源代码文件。

手册页也没有说明正则表达式或使用`-R`.

# c# - 将 Emgu CV 图像转换为 jpeg 2000，然后存储到字节数组

> ID：10199451
> 
> 赞同：0
> 
> 时间：2012-04-17T21:28:38.953
> 
> 标签：c#, emgucv

我可以通过以下方式保存 jpeg 2000 图像文件

```
Image<Bgr, byte> img; img.Save("photo.jp2"); 
```

如何将 Emgu CV Image 转换为 jpeg 2000 然后存储到字节数组

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-03T11:23:20.573

emguv 中的 Image 类具有 Bitmap 属性（请参阅： emgucv 文档中的[Image(TColor, TDepth).Bitmap](http://www.emgu.com/wiki/files/2.3.0/document/html/792e25d7-4ae8-52c3-eadb-c05ee7b7919f.htm)），因此如果您只想要图像的 JPEG 编码字节数组，您可以这样做：

```
Image<Bgr, byte> img;

//...

byte[] bytes;
using(var ms = new MemoryStream())
{
    img.Bitmap.Save(ms, ImageFormat.Jpeg);
    bytes = ms.ToArray();
} 
```

# matlab - FFTW 到顶部 Matlab FFT 的优化

> ID：10199452
> 
> 赞同：1
> 
> 时间：2012-04-17T21:28:43.910
> 
> 标签：matlab, optimization, fft, mex, fftw

Matlab 中的 FFT 不允许选择有多少线程进行计算（http://stackoverflow.com/questions/9528833/matlabs-fftn-gets-slower-with-multithreading）。默认情况下，它使用独立 matlab 上的所有内核。但是在集群上，默认情况下每个工作人员都使用一个 CPU 启动。您可以强制它使用更多内核（maxNumCompThreads 函数）。这与代数运算完美配合，但 FFT 函数仍然（奇怪？）单核。因此，我使用 fftw 库（如 matlab 所做的那样）编写了一个 mex 文件来计算具有所需内核数的 fft。但是当我尝试使用 FFTW_ESTIMATE 规划器（这是 Matlab 中的默认设置）和清晰的智慧来比较代码时，我的代码仍然比 Matlab fft 慢 3 到 4 倍。

这是我用于 mex 的代码（应用于 2D fft，名为 FFT2mx）：

```
#include <stdlib.h>
#include <stdio.h>
#include <mex.h>
#include <matrix.h>
#include <math.h>
#include </home/nicolas/Code/C/lib/include/fftw3.h>    
void FFTNDSplit(int NumDims, const int N[], double *XReal, double *XImag, double *YReal, double *YImag, int Sign)
    {
      fftw_plan Plan;
      fftw_iodim Dim[NumDims];
      int k, NumEl;
      for(k = 0, NumEl = 1; k < NumDims; k++)
      {
        Dim[NumDims - k - 1].n = N[k];
        Dim[NumDims - k - 1].is = Dim[NumDims - k - 1].os = (k == 0) ? 1 : (N[k-1] * Dim[NumDims-k].is);
        NumEl *= N[k];
      }

      //fftw_import_wisdom_from_filename("/home/nicolas/wisdom/wis");

      if(!(Plan = fftw_plan_guru_split_dft(NumDims, Dim, 0, NULL, XReal, 
                                           XImag, YReal, YImag, FFTW_ESTIMATE)))
        mexErrMsgTxt("FFTW3 failed to create plan.");

      if(Sign == -1)
        fftw_execute_split_dft(Plan, XReal, XImag, YReal, YImag);
      else
      {
        fftw_execute_split_dft(Plan, XImag, XReal, YImag, YReal);
      }

      //if(!fftw_export_wisdom_to_filename("/home/nicolas/wisdom/wis"))
      //    mexErrMsgTxt("FFTW3 failed to save wisdom.");

      fftw_destroy_plan(Plan);
      return;
    }

    void mexFunction( int nlhs, mxArray *plhs[],
                  int nrhs, const mxArray *prhs[] )
    {

      int i, j,numCPU;
      int NumDims;
      const mwSize *N;

      if (nrhs != 2) {
          mexErrMsgIdAndTxt( "MATLAB:FFT2mx:invalidNumInputs",
                    "Two input argument required.");
      }

      if (!mxIsDouble(prhs[0])) {
          mexErrMsgIdAndTxt( "MATLAB:FFT2mx:invalidNumInputs",
                    "Array must be double");
      }

      numCPU = (int) mxGetScalar(prhs[1]);
      if (numCPU > 8) {
          mexErrMsgIdAndTxt( "MATLAB:FFT2mx:invalidNumInputs",
                    "NumOfThreads < 8 requested");
      }

      /*if (!mxIsComplex(prhs[0])) {
          mexErrMsgIdAndTxt( "MATLAB:FFT2mx:invalidNumInputs",
                    "Array must be complex");
      }*/

      NumDims = mxGetNumberOfDimensions(prhs[0]);
      N = mxGetDimensions(prhs[0]);

      plhs[0] = mxCreateDoubleMatrix(0, 0, mxCOMPLEX);
      mxSetDimensions(plhs[0], N, NumDims);
      mxSetData(plhs[0], mxMalloc( sizeof(double) * mxGetNumberOfElements(prhs[0]) ));
      mxSetImagData(plhs[0], mxMalloc( sizeof(double) * mxGetNumberOfElements(prhs[0]) ));

      fftw_init_threads();
      fftw_plan_with_nthreads(numCPU);

      FFTNDSplit(NumDims, N, (double *) mxGetPr(prhs[0]), (double *) mxGetPi(prhs[0]),
                 mxGetPr(plhs[0]),  mxGetPi(plhs[0]), -1);

    } 
```

相关的matlab代码：

```
function fft2mx(X,NumCPU)

FFT2mx(X,NumCPU)/sqrt(size(X,1)*size(X,2));
return; 
```

我使用静态库编译 mex 代码：

```
mex FFT2mx.cpp /home/nicolas/Code/C/lib/lib/libfftw3.a /home/nicolas/Code/C/lib/lib/libfftw3_threads.a 
```

一切正常，只是速度较慢。

FFTW 库已使用以下参数进行编译：

```
CC="gcc ${BUILD64} -fPIC" CXX="g++ ${BUILD64} -fPIC" \
./configure --prefix=/home/nicolas/Code/C/lib --enable-threads &&
make
make install 
```

我在一个具有 2 个四核 AMD Opteron(tm) 的集群节点上运行此代码，并使用以下命令进行测试：

```
A = randn([2048 2048])+ i*randn([2048 2048]);
tic, fft2mx(A,8); toc;
tic, fftn(A); toc; 
```

女巫归来：

```
Elapsed time is 0.482021 seconds.
Elapsed time is 0.151630 seconds. 
```

如何调整我的 mex 代码？fftw库的编译是否可以优化？有没有办法只使用 ESTIMATE 规划器来加速 fftw 算法？

我正在寻找任何见解。谢谢你。

* * *

**编辑：**

我考虑了您的建议（使用智慧和静态计划）并编写了以下更新代码：

```
# include <string.h>
# include <stdlib.h>
# include <stdio.h>
# include <mex.h>
# include <matrix.h>
# include <math.h>
# include </home/nicolas/Code/C/lib/include/fftw3.h>

char *Wisfile = NULL;
char *Wistemplate = "%s/.fftwis";
#define WISLEN 8

void set_wisfile(void)
{
    char *home;
    if (Wisfile) return;
    home = getenv("HOME");
    Wisfile = (char *)malloc(strlen(home) + WISLEN + 1);
    sprintf(Wisfile, Wistemplate, home);
}

void cleanup(void) {
    static fftw_plan PlanForward;
    static int planlen; 
    static double *pr, *pi, *pr2, *pi2;
    mexPrintf("MEX-file is terminating, destroying array\n");
    fftw_destroy_plan(PlanForward);
    fftw_free(pr2);
    fftw_free(pi2);
    fftw_free(pr);
    fftw_free(pi);
}

void mexFunction( int nlhs, mxArray *plhs[],
              int nrhs, const mxArray *prhs[] )
{

  int i, j, numCPU, NumDims;
  const mwSize *N;
  fftw_complex *out, *in1;
  static double *pr, *pi, *pr2, *pi2;
  static int planlen = 0;
  static fftw_plan PlanForward;
  fftw_iodim Dim[NumDims];
  int k, NumEl;
  FILE *wisdom;

  if (nrhs != 2) {
      mexErrMsgIdAndTxt( "MATLAB:FFT2mx:invalidNumInputs",
                "Two input argument required.");
  }

  if (!mxIsDouble(prhs[0])) {
      mexErrMsgIdAndTxt( "MATLAB:FFT2mx:invalidNumInputs",
                "Array must be double");
  }

  numCPU = (int) mxGetScalar(prhs[1]);
  if (numCPU > 8) {
      mexErrMsgIdAndTxt( "MATLAB:FFT2mx:invalidNumInputs",
                "NumOfThreads < 8 requested");
  }

  if (!mxIsComplex(prhs[0])) {
      mexErrMsgIdAndTxt( "MATLAB:FFT2mx:invalidNumInputs",
                "Array must be complex");
  }

  NumDims = mxGetNumberOfDimensions(prhs[0]);
  N = mxGetDimensions(prhs[0]);
  for(k = 0, NumEl = 1; k < NumDims; k++)
  {
    Dim[NumDims - k - 1].n = N[k];
    Dim[NumDims - k - 1].is = Dim[NumDims - k - 1].os = (k == 0) ? 1 : (N[k-1] * Dim[NumDims-k].is);
    NumEl *= N[k];
  }

/* If different size, free/destroy */
  if(N[0] != planlen && planlen > 0) {
    fftw_free(pr2);
    fftw_free(pi2);
    fftw_free(pr);
    fftw_free(pi);
    fftw_destroy_plan(PlanForward);
    planlen = 0;
  }
  mexAtExit(cleanup);

/* Init */

fftw_init_threads();
 // APPROACH 1
  //pr = (double *) mxGetPr(prhs[0]);
  //pi = (double *) mxGetPi(prhs[0]);

// APPROACH 2
  pr = (double *) fftw_malloc( sizeof(double) * mxGetNumberOfElements(prhs[0]) );
  pi = (double *) fftw_malloc( sizeof(double) * mxGetNumberOfElements(prhs[0]) );
  tmp1 = (double *) mxGetPr(prhs[0]);
  tmp2 = (double *) mxGetPi(prhs[0]);
  for(k=0;k<mxGetNumberOfElements(prhs[0]);k++)
  {
    pr[k] = tmp1[k];
    pi[k] = tmp2[k];
  }

  plhs[0] = mxCreateNumericMatrix(0, 0, mxDOUBLE_CLASS, mxCOMPLEX);
  mxSetDimensions(plhs[0], N, NumDims);
  mxSetData(plhs[0], (double* ) fftw_malloc( sizeof(double) * mxGetNumberOfElements(prhs[0]) ));
  mxSetImagData(plhs[0], (double* ) fftw_malloc( sizeof(double) * mxGetNumberOfElements(prhs[0]) ));

  pr2 = mxGetPr(plhs[0]);
  pi2 = mxGetPi(plhs[0]);

  fftw_init_threads();
  fftw_plan_with_nthreads(numCPU);

/* Get any accumulated wisdom. */

  set_wisfile();
  wisdom = fopen(Wisfile, "r");
  if (wisdom) {
    fftw_import_wisdom_from_file(wisdom);
    fclose(wisdom);
  }

/* Compute plan */

//printf("%d",planlen);
  if(planlen == 0 ) {

fftw_plan_with_nthreads(numCPU);
    PlanForward = fftw_plan_guru_split_dft(NumDims, Dim, 0, NULL, pr, pi, pr2, pi2, FFTW_MEASURE);
    planlen = N[0]; 
  } 

/* Save the wisdom. */ 

  wisdom = fopen(Wisfile, "w");
  if (wisdom) {
    fftw_export_wisdom_to_file(wisdom);
    fclose(wisdom);
  }

/* execute */

  fftw_execute_split_dft(PlanForward, pr, pi, pr2, pi2); 
  fftw_cleanup_threads();
} 
```

在对函数进行多次调用（2 到 6 次之间）后，我现在遇到了一些分段错误，我不知道为什么。我尝试了不同的方法来通过指针初始化。我还在某处读到该计划的指针必须是静态的才能与相应的静态计划一起使用。你看到我做错了什么吗？

再次感谢您的见解。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-17T21:38:08.780

问题是您正在为每个 FFT 创建和破坏一个计划。创建计划通常比 FFT 本身更耗时。理想情况下，您只需创建和销毁一次计划，然后将其多次重复用于相同维度的连续 FFT。

如果您为相同大小的 FFT 重复调用 MEX，那么您可能能够*记住*计划（例如，保留静态计划变量和维度，并且仅在需要时重新创建计划，即当维度发生变化时）。

或者，您可以拥有三个 MEX 功能 - 一个用于创建计划，一个用于使用给定计划运行 FFT，另一个用于销毁计划。

一旦你解决了上述架构问题，你应该考虑使用`FFTW_MEASURE`而不是`FFTW_ESTIMATE`获得更好的性能。

还有一件事：您可能想要添加`--enable-sse`到您的`./configure`命令中以在 FFTW 蝴蝶中启用 SIMD 代码生成。

# javascript - 使用 KendoUI 折线图，如何使数据标记（点）成为纯色？

> ID：10199456
> 
> 赞同：6
> 
> 时间：2012-04-17T21:29:04.197
> 
> 标签：javascript, jquery, asp.net, telerik, kendo-ui

我正在使用 Kendo UI 替换现有图表。我需要尽量减少图表之间的变化。有谁知道如何使折线图上的点变成实心的？能不能把线变细？

这是我的图表图像：

![](../Images/e8bbf12d61af2e20df6916075d7ee444.png)

这是我的 jsFiddle 项目，如果你想玩的话：http: [//jsfiddle.net/rodneyhickman/uMTnh/2/](http://jsfiddle.net/rodneyhickman/uMTnh/2/)

我的 html 看起来像：

```
<div id='chart'  ></div> 
```

我的 jQuery 脚本看起来像：

```
 jQuery('#chart').kendoChart({
    title: {
        text: "Overall Score out of 100",
        align: "left",
        font: "18px Arial, Verdana, sans-serif",
        color: "#444"
    },
    seriesDefaults: {
        type: "line",
        missingValues: "interpolate",

    },
    legend: {
        position: "bottom"
    },
    tooltip: {
        visible: true,
        format: "{0}%"
    },
    valueAxis: {
        min: 70,
        max: 85,
        plotBands: [{
            from: 70,
            to: 75,
            color: "#EDF5FF"},
        {
            from: 80,
            to: 85,
            color: "#EDF5FF"}]
    },
    series: [{
        name: "Some Product",
        color: "004990",
        tooltip: {
            visible: true,
            template: "<b>Some Product</b><br/>Current Score: #= value #<br/>#= category # "
        },
        data: [81.82, 81.82, 81.82, null, null, null, null, null, null, null, null, 70.42, 72.37]},
    {
        name: "Some Market Segmemt",
        color: "da7633",
        tooltip: {
            visible: true,
            template: "<b>Some Market Segmemt</b><br/>Current Score: #= value #<br/>#= category # "
        },
        data: [73.81, 73.52, 73.59, 73.49, 73.41, 73.51, 73.72, 73.27, 74.23, 73.99, 73.97, 73.83, 73.79]}],
    categoryAxis: {
        labels: {
            rotation: -45,
            step: 1,
            skip: 0
        },
        categories: ["Mar", "Apr", "May", "Jun", "Jul", "Aug", "Sep", "Oct", "Nov", "Dec", "Jan - 2012", "Feb", "Mar"]
    }
}); 
```

任何帮助，将不胜感激。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-04-17T22:09:42.273

在系列对象中使用**标记：{背景：“#004990”}，** //使用您的背景颜色。

要设置栏的宽度，还可以使用**width: 1**属性。

这是您可以使用的 jsfiddle 解决方案：http: [//jsfiddle.net/rodneyhickman/uMTnh/3/](http://jsfiddle.net/rodneyhickman/uMTnh/3/)

这是生成的图像：

![](../Images/1e8b6cbea9a4b353d3160d3ded534e5f.png)

新的 jQuery 脚本如下所示：

```
jQuery('#chart').kendoChart({
    title: {
        text: "Overall Score out of 100",
        align: "left",
        font: "18px Arial, Verdana, sans-serif",
        color: "#444"
    },
    seriesDefaults: {
        type: "line",
        missingValues: "interpolate"

    },
    legend: {
        position: "bottom"
    },
    tooltip: {
        visible: true,
        format: "{0}%"
    },
    valueAxis: {
        min: 70,
        max: 85,
        plotBands: [{
            from: 70,
            to: 75,
            color: "#EDF5FF"},
        {
            from: 80,
            to: 85,
            color: "#EDF5FF"}]
    },
    series: [{
        name: "Some Product",
        color: "004990",
        width: 1,
        markers: { background: "#004990"  },
        size: 2,
        tooltip: {
            visible: true,
            template: "<b>Some Product</b><br/>Current Score: #= value #<br/>#= category # "
        },
        data: [81.82, 81.82, 81.82, null, null, null, null, null, null, null, null, 70.42, 72.37]},
    {
        name: "Some Market Segmemt",
        color: "da7633",
        width: 1,
        markers: { background: "#da7633"  },
        tooltip: {
            visible: true,
            template: "<b>Some Market Segmemt</b><br/>Current Score: #= value #<br/>#= category # "
        },
        data: [73.81, 73.52, 73.59, 73.49, 73.41, 73.51, 73.72, 73.27, 74.23, 73.99, 73.97, 73.83, 73.79]}],
    categoryAxis: {
        labels: {
            rotation: -45,
            step: 1,
            skip: 0
        },
        categories: ["Mar", "Apr", "May", "Jun", "Jul", "Aug", "Sep", "Oct", "Nov", "Dec", "Jan - 2012", "Feb", "Mar"]
    }
}); 
```

# c# - C# Timer 填充数据库

> ID：10199457
> 
> 赞同：0
> 
> 时间：2012-04-17T21:29:05.283
> 
> 标签：c#, mysql, sql-server, postgresql, timer

我正在尝试从 MSSQL 和 PostrgeSQL 数据库中检索数据，以定期（每小时）将其填充到 MySQL 数据库中。

根据我所做的一项研究，我想使用 C# Timer 来做到这一点。但是，我并不完全理解计时器的工作方式。我在 Page_Load 中声明它，设置经过的事件处理程序并从事件处理程序调用一个方法。

```
protected void Page_Load(object sender, EventArgs e)
{
    int duration = 100 * 60 * 5; //milliseconds * seconds * minutes

    // Create a timer with a two second interval.
    System.Timers.Timer timer = new System.Timers.Timer(duration);

    // Hook up the Elapsed event for the timer.
    timer.Elapsed += new System.Timers.ElapsedEventHandler(timer_Elapsed);

    timer.Enabled = true;
}

void timer_Elapsed(object sender, System.Timers.ElapsedEventArgs e)
{
    cf();
} 
```

这行得通，但是...

问题是这样每次加载页面时都会初始化计时器。如何创建一个仅初始化一次并从那一刻起继续运行而不重新初始化的计时器。此外，如果计时器或方法失败 - 引发异常或服务器宕机，我该如何处理？那我该如何重新启动计时器呢？

任何见解都会有所帮助！先感谢您！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-17T21:36:53.620

您不想在 ASP.NET 网页上执行此操作。ASP.NET 计时器设计用于在您离开之前在页面的生命周期内发生的操作。

如果您想做这样的长期工作（即 24/7 每小时一次的任务），您最好：

*   使用带有 System.Timer 的 always on Windows 服务或
*   使用具有每小时 1 次计划的 Windows 计划任务，这将启动控制台应用程序。

另一种选择，因为您的任务似乎与数据库数据传输密切相关，所以使用 SSIS 或其他替代 ETL 工具（Extract-Transform-Load）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-17T21:49:13.417

其他答案涉及到这一点；我会打它的头： ASP.NET 中的计时器是一个坏主意。

原因与 ASP.NET 生命周期有关。最简单的一点是，每次页面加载都会实例化一个 Page 类的实例（您的代码隐藏）。一旦生成的页面作为 HTML 输出到客户端的浏览器，页面实例就会离开作用域并被销毁。这意味着您的计时器（设置为从现在开始运行一个小时）将在其 Tick 事件触发之前很久就消失了；对于简单页面，Page 类可以在内存中持续不到一秒。

在某些情况下，您可以通过将 Timer 存储在 Session 中来解决此问题，只要用户连接到站点，它就会持续存在。但是，会话的超时时间通常早于一个小时（15 分钟是一个常见的标准；具有大量私人数据的网站，如在线银​​行应用程序，超时速度最快可达 5 分钟）。

所以，我重申，不要在 ASP.NET 代码中使用定时器。相反，您可以在 Web 服务器（或应用服务器）上运行的 Windows 服务中使用 Timer，该服务将每小时执行一次数据提取。它可以由 Web 应用程序提供信息，例如连接了哪些用户，可能是通过访问 ASP.NET 使用的数据库来验证/授权在线用户帐户。

如果它只是必须是一个进行数据刷新的网络应用程序，那么我会在页面上的某处保留一个隐藏字段或 JavaScript 变量，以指示下次应该提取数据的时间。为文档加载时设置一个 JavaScript timeout()，这会触发一个 AJAX 回调到服务器以运行一个事件处理程序，该处理程序用来自其他两个 DB 的数据刷新 MySql。始终验证此数据刷新确实应该在您的代码隐藏中发生（可能通过在 Session 或 ViewState 中保持相同的值），否则使用 FireBug 或 Chrome 内置的插件将您自己的页面代码转换为 DoS 机制是微不足道的- 在代码编辑器中。如果更新时间已经过去，您也可以从 Page_Load 触发相同的事件，在用户禁用 JavaScript 的情况下覆盖您自己；

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-17T21:37:14.157

在 Global.asax 中初始化计时器。OnApplicationStart 方法.. [http://msdn.microsoft.com/en-us/library/1xaas8a2(v=vs.71).aspx](http://msdn.microsoft.com/en-us/library/1xaas8a2(v=vs.71).aspx)

此处描述了类似的方法： [http ://www.west-wind.com/weblog/posts/2007/May/10/Forcing-an-ASPNET-Application-to-stay-alive](http://www.west-wind.com/weblog/posts/2007/May/10/Forcing-an-ASPNET-Application-to-stay-alive)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-17T21:37:23.857

如果您声明所有其他变量，您可能想要将初始化程序移动到的第一件事。接下来，您可以在页面中加载一个函数，将您的间隔时间设置为到达下一小时所需的时间。这就是我所做的。

```
 private void SetTimer()
    {
        timer1.Stop();
        var timeOfDay = DateTime.Now.TimeOfDay;
        var nextFullHour = TimeSpan.FromHours(Math.Ceiling(timeOfDay.TotalHours));
        var delta = (nextFullHour - timeOfDay).TotalMilliseconds;
        timer1.Interval = (int)delta;
        timer1.Start();
    } 
```

授予您的情况可能会有所不同，但这可能会对您有所帮助。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-04-18T03:19:35.340

假设您因无法访问控制台应用程序、Windows 服务或本地系统来安排任务而受到限制，一种选择是执行以下操作。当没有计时器可用时，我对模拟计时器的解决方案。

此外，您还需要假设计时器不必完全按小时触发。

1.  将一个表添加到您的数据库中，该表记录了上次运行计时器作业的时间。
2.  页面加载完成后，检查自上次运行计时器作业以来是否已经过了一个小时。
3.  如果已经过了一个多小时，则在该点执行时间作业。
4.  当作业开始时将日志记录到它启动的数据库中，从而防止另一个作业启动。

请记住，当您没有其他选项时，这是一种非常古怪的模拟计时器的方法。

# objective-c - 我应该使用什么 UIApplication Delegate

> ID：10199459
> 
> 赞同：0
> 
> 时间：2012-04-17T21:29:11.087
> 
> 标签：objective-c, ios, uiapplicationdelegate

嘿，所以我需要帮助。我必须从电子邮件启动我的应用程序，而该应用程序不在后台进程中。目前，该应用程序必须在我打开电子邮件附件的过程中。是否有任何 UIApplicationDelegate 可以在我的 AppDelegate 中使用，所以我不需要后台应用程序。现在，我必须告诉我的用户首先打开应用程序，然后打开电子邮件附件，这对某些用户来说是相当困难的。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-17T21:37:24.490

URL 方案是您想要的。
[http://mobile.tutsplus.com/tutorials/iphone/ios-sdk-working-with-url-schemes/](http://mobile.tutsplus.com/tutorials/iphone/ios-sdk-working-with-url-schemes/)

# java - 如何检查给定字符串是否是Java中任何给定枚举的一部分？

> ID：10199462
> 
> 赞同：14
> 
> 时间：2012-04-17T21:29:28.237
> 
> 标签：java, enums

我有两个不同的枚举，我希望能够输出给定的字符串是否是枚举集合的一部分。这是我的代码：

```
public class Check {
    public enum Filter{SIZE, DATE, NAME};
    public enum Action{COPY, DELETE, REMOVE};

    public boolean isInEnum(String value, Enum e){
        // check if string value is a part of a given enum
        return false;
    }

    public void main(){
        String filter = "SIZE";
        String action = "DELETE";
                // check the strings
        isInEnum(filter, Filter);
        isInEnum(action, Action);
    }
} 
```

eclipse 在最后两行中说“过滤器无法解析为变量”，但除此之外，函数“isInEnum”中的 Enum 参数似乎是错误的。

这里出了点问题，有人可以帮忙吗？

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2012-04-17T21:31:34.787

最简单（通常也是最有效）的方法如下：

```
public <E extends Enum<E>> boolean isInEnum(String value, Class<E> enumClass) {
  for (E e : enumClass.getEnumConstants()) {
    if(e.name().equals(value)) { return true; }
  }
  return false;
} 
```

然后你打电话`isInEnum(filter, Filter.class)`。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2016-03-09T08:03:31.493

如果您不介意使用 Apache commons lang3 库，您可以使用以下代码：

```
EnumUtils.isValidEnum(Filter.class, filter) 
```

根据[文档](https://commons.apache.org/proper/commons-lang/javadocs/api-3.1/ "文档")：

> 此方法与 Enum.valueOf(java.lang.Class, java.lang.String) 的不同之处在于它不会为无效的枚举名称引发异常。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2015-11-10T19:20:26.877

这是 Louis Wasserman 的答案的 Java 8/streams 版本。（也可以把这个方法直接放到Enum类中，去掉其中一个参数）

```
public boolean isInEnum(String value, Class<E> enumClass) {
    return Arrays.stream(enumClass.getEnumConstants()).anyMatch(e -> e.name().equals(value));
  } 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2015-11-17T23:09:33.397

我没有足够的分数来直接评论 Simon Tower 的答案，但这里是他提到的第二种方式的方法，它直接在 enum 类本身中进行：

```
 public static boolean isInEnum(String value) {
     return Arrays.stream(EnumClassNameGoesHere.values()).anyMatch(e -> e.name().equals(value));
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-09-28T18:52:07.060

避免使用循环进行验证。

我建议使用`valueOf`. 此方法内置于枚举中，可考虑用于编译时优化。

这类似于实现一个静态`Map<String,EnumType>`来优化查找，这是您可以考虑的另一个考虑因素。

缺点是您必须使用异常处理机制来捕获非枚举值。

例子

```
public enum DataType {
  //...
  static public boolean has(String value) {
    if (value== null) return false;
    try { 
        // In this implementation - I want to ignore the case
        // if you want otherwise ... remove .toUpperCase()
        return valueOf(value.toUpperCase()); 
    } catch (IllegalArgumentException x) { 
        // the uggly part ...
        return false;
    }
  }
} 
```

另请注意，通过上述类型实现，您的代码在调用时看起来更清晰。你的主要现在看起来像：

```
public void main(){
    String filter = "SIZE";
    String action = "DELETE";

    // ...

    if (Filter.has(filter) && Action.has(action)) {
      // Appropriate action
    }
} 
```

然后提到的另一个选项是使用静态地图。您也可以采用这种方法来缓存基于其他属性的所有类型的索引。在下面的示例中，我允许每个枚举值都有一个别名列表。在这种情况下，查找索引将不区分大小写，强制为大写。

```
public enum Command {
  DELETE("del","rm","remove"),
  COPY("cp"),
  DIR("ls");

  private static final Map<String,Command> ALIAS_MAP = new HashMap<String,Command>();
  static {
    for (Command type:Command.values()) {
      ALIAS_MAP.put(type.getKey().toUpper(),type);
      for (String alias:type.aliases) ALIAS_MAP.put(alias.toUpper(),type);
    }
  }

  static public boolean has(String value) {
    return ALIAS_MAP.containsKey(value.toUpper());
  }

  static public Command fromString(String value) {
    if (value == null) throw new NullPointerException("alias null");
    Command command = ALIAS_MAP.get(value);
    if (command == null) throw new IllegalArgumentException("Not an alias: "+value);
    return command;
  }

  private List<String> aliases;
  private Command(String... aliases) {
    this.aliases = Arrays.asList(aliases);
  }
} 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2021-05-04T14:47:44.537

这也可以按如下方式完成：

```
public boolean isInEnum(String value, Enum e){
    return Enums.getIfPresent(e.class, value).isPresent();
} 
```

更多细节可以在[这里](https://guava.dev/releases/19.0/api/docs/index.html?com/google/common/base/Enums.html)找到。

# vb.net - C# TripleDesCrypto 给出的结果与 VB TripleDesCrypto 不同

> ID：10199463
> 
> 赞同：0
> 
> 时间：2012-04-17T21:29:29.407
> 
> 标签：vb.net, cryptography, 3des

尝试对项目使用 TripleDesCrypto 编码，我在解码时不断收到错误数据错误。这就是我在 VB.net 中所拥有的

```
Public Shared Function encode(message As String) As String
    Dim _Key As Byte() = ASCIIEncoding.ASCII.GetBytes("asdf1325asdfs123")
    Dim _IV As Byte() = ASCIIEncoding.ASCII.GetBytes("123ads12")
    Dim sOutput As String = ""
    Try

        Dim tdes As TripleDESCryptoServiceProvider = New TripleDESCryptoServiceProvider()
        Dim InputBuffer As Byte() = Encoding.UTF8.GetBytes(message)
        Dim ms As New MemoryStream()
        Dim encStream As New CryptoStream(ms, tdes.CreateEncryptor(_Key, _IV), CryptoStreamMode.Write)
        encStream.Write(InputBuffer, 0, InputBuffer.Length)
        sOutput = Convert.ToBase64String(ms.ToArray())
        encStream.Close()
        ms.Close()
    Catch ex As Exception
        Throw New ArgumentException("Couldn't Encode Message: " + ex.Message)
    End Try
    Return sOutput
End Function 
```

返回

```
Cui4ahedjTI= 
```

所以我在 C#.net 中尝试了同样的事情

```
 public string encode(string message)
    {
        byte[] _Key  = ASCIIEncoding.ASCII.GetBytes("asdf1325asdfs123");
        byte[] _IV = ASCIIEncoding.ASCII.GetBytes("123ads12");
        string sOutput = "";
        try
        {
            TripleDESCryptoServiceProvider tdes = new TripleDESCryptoServiceProvider();
            byte[] InputBuffer = Encoding.UTF8.GetBytes(message);
            MemoryStream ms = new MemoryStream();
            CryptoStream encStream = new CryptoStream(ms, tdes.CreateEncryptor(_Key, _IV), CryptoStreamMode.Write);
            encStream.Write(InputBuffer, 0, InputBuffer.Length);
            encStream.FlushFinalBlock();
            sOutput = Convert.ToBase64String(ms.ToArray());
            encStream.Close();
            ms.Close();
        }
        catch (Exception ex)
        {
            throw new ArgumentException("couldn't encode message: " + ex.Message);
        }

        return sOutput;
    } 
```

返回

```
ac6EeiwfAQHk26AhfAfaHA== 
```

解码发生在第三方应用程序中，我假设它是用 C# 编写的

问题是为什么结果不同，有没有办法让 vb.net 代码返回与 C# 代码相同的结果？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-18T12:11:48.553

乍一看，我可以看到 C# 版本调用`encStream.FlushFinalBlock();`，但 VB 没有。这不能有区别吗？

# android - 排队，还在去吗？

> ID：10199466
> 
> 赞同：0
> 
> 时间：2012-04-17T21:29:45.570
> 
> 标签：android

我有一个 while 循环，当 BuffedReader 仍然有数据时，while 循环的目的是读取每一行，然后继续。这就是我所拥有的

```
final BufferedReader in;
....
in = new BufferedReader(new InputStreamReader(socket.getInputStream()));
String line = null
while ((line = in.readLine()) != null) {
    line = line.replace(" ", ",");
    reply.append(line + System.getProperty("line.separator"));
    Log.d("DeviceActivity",  line);
} 
```

*   编辑

这会读取预期的两行，然后它不会像预期的那样完成循环。

我也尝试过不同的输入，但结果相同，它不会退出 while 循环。

有谁知道如何防止这种情况？

此外，它并不总是两条线，它可能是无限的。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-15T08:52:11.490

这在这里有效，如果输入流准备好，它只会读取该行。

```
while (in.ready() && (line = in.readLine()) != null) {
    Log.i("Line", line);
    publishProgress(line);
    Thread.sleep(25);
} 
```

# ruby-on-rails - DelayedJob：反序列化 ActiveRecord 对象会在可序列化字段上引发 SerializationTypeMistmatch 错误

> ID：10199471
> 
> 赞同：1
> 
> 时间：2012-04-17T21:29:58.953
> 
> 标签：ruby-on-rails, ruby, activerecord, delayed-job

使用 DelayedJob 时出现意外序列化错误。假设我有以下 ActiveRecord 类用户：

```
class User < ActiveRecord::Base
  serialize :metadata, UserMetaData
end 
```

UserMetaData 看起来像这样：

```
class UserMetaData < Hash
  def some_function
    #do work
  end
end 
```

如果我的 DelayedJob 在内部执行此操作：

```
class MyJob
  attr_accessor :user_id

  def initialize(user_id)
    self.user_id = user_id
  end

  def perform
    @user = User.find(self.user_id)
  end
end 
```

每当我运行它时，我都会在本地收到以下错误：

```
[Worker(host:home pid:87197)] MyJob failed with ActiveRecord::SerializationTypeMismatch: Attribute was supposed to be a UserMetaData, but was a Hash - 2 failed attempts 
```

它在 DelayedJob 系统之外运行良好。似乎每当它从数据库中获取记录时，它都没有正确地反序列化它。我确实注意到，如果我将 User 类更改为：

```
serialize :metadata, Hash 
```

它工作正常，但作为 DelayedJob 中的哈希和 DelayedJob 系统之外的 UserMetaData 出现。这里的问题是当我在 DelayedJob 系统中时，我无法使用 UserMetaData 类上的函数（即：@user.metadata.some_function）。不太清楚该怎么做。任何指针都会非常有帮助。

更新：Github 上似乎也有一张与此问题相关的公开票：[https](https://github.com/collectiveidea/delayed_job/issues/300) ://github.com/collectiveidea/delayed_job/issues/300 。

谢谢！

# iptables - 使用 iptables 模拟混杂模式

> ID：10199477
> 
> 赞同：0
> 
> 时间：2012-04-17T21:30:10.547
> 
> 标签：iptables, snort, dd-wrt, promiscuous-mode

我正在尝试在我的家庭网络上运行 snort，但我没有可以镜像端口的交换机。相反，我有一个带有番茄（dd-wrt）的华硕 RT-N16。经过数小时的搜索，我找到的唯一解决方案是：[http ://www.snort.org/assets/182/snort-opensuse-vbox-ddwrt.txt](http://www.snort.org/assets/182/snort-opensuse-vbox-ddwrt.txt)

基本上他们说要创建这两个 iptables 规则：

**iptables -A PREROUTING -t mangle -j ROUTE --gw 192.168.1.20 --tee**

**iptables -A POSTROUTING -t mangle -j ROUTE --gw 192.168.1.20 --tee**

问题是 --gw 不是一个有效的标志。

然后我需要创建一个脚本来检查规则是否存在。如果是，请删除该规则。如果没有，请创建规则。

我应该 grep **iptables -L -v -n --line-n**还是应该 grep **iptables-save**？

1.  什么是正确的 iptables 语法来模拟到 192.168.1.20 的混杂端口？

2.  如果它们不存在，我如何创建将打开 iptables 规则的脚本，如果它们存在则删除它们？

谢谢，

瑞安

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-10T21:32:31.610

几个月前我在番茄上做了这个。

您至少需要 Tomato v1.24，其中包括 ipt_ROUTE。它用于启用 -j ROUTE 和 --tee 功能。

# /sbin/modprobe ipt_ROUTE

然后添加你上面提到的 iptables 规则。

# sql - 我的 SQL 是什么。计算客户在过去一年中每个月来的次数

> ID：10199478
> 
> 赞同：1
> 
> 时间：2012-04-17T21:30:12.363
> 
> 标签：sql, oracle, group-by

```
SELECT * 
FROM CLIENT
WHERE CLIENT_REG_DATE > DATEADD(year,-1,GETDATE())
GROUPBY MONTH(CLIENT_REG_DATE). 
```

我放入 Apex Oracle 并运行它，它说

```
SQL command not properly ended 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-17T21:35:46.667

Oracle中既没有 a`DATEADD`也没有 a ，也`getdate()`没有`month()`函数。

有关所有可用日期函数的列表，请参阅手册：
[http ://docs.oracle.com/cd/E11882_01/server.112/e26088/functions002.htm#i88891](http://docs.oracle.com/cd/E11882_01/server.112/e26088/functions002.htm#i88891)

并且语句必须以`;`

而且，如果您使用`SELECT *`group by 肯定也不会工作。

如果不更详细地指定要分组的内容，很难说，但从以下内容开始：

```
SELECT to_char(client_reg_date, 'yyyy-mm'), count(*)
FROM CLIENT
WHERE CLIENT_REG_DATE > add_months(sysdate, -12)
GROUP BY to_char(client_reg_date, 'yyyy-mm') 
```

# django - 升级到 Django 1.4 但管理员仍在媒体目录中查找静态文件

> ID：10199480
> 
> 赞同：0
> 
> 时间：2012-04-17T21:30:14.303
> 
> 标签：django, django-admin, django-settings, django-staticfiles

我升级到 Django 1.4，现在我的管理静态文件将无法加载。

我的设置文件的相关部分如下所示：

```
MEDIA_ROOT = os.path.join(SITE_ROOT, 'media')

# URL that handles the media served from MEDIA_ROOT. Make sure to use a
# trailing slash.
# Examples: "http://media.lawrence.com/media/", "http://example.com/media/"
MEDIA_URL = '/media/'

# Absolute path to the directory static files should be collected to.
# Don't put anything in this directory yourself; store your static files
# in apps' "static/" subdirectories and in STATICFILES_DIRS.
# Example: "/home/media/media.lawrence.com/static/"
STATIC_ROOT = os.path.join(SITE_ROOT, 'static')

# URL prefix for static files.
# Example: "http://media.lawrence.com/static/"
STATIC_URL = '/static/'

# URL prefix for admin static files -- CSS, JavaScript and images.
# Make sure to use a trailing slash.
# Examples: "http://foo.com/static/admin/", "/static/admin/".
ADMIN_MEDIA_PREFIX = '/static/admin/'

STATICFILES_FINDERS = (
    'django.contrib.staticfiles.finders.FileSystemFinder',
    'django.contrib.staticfiles.finders.AppDirectoriesFinder',
#    'django.contrib.staticfiles.finders.DefaultStorageFinder',
)

INSTALLED_APPS = (
    # django apps
    'django.contrib.admin',
    'django.contrib.admindocs',
    'django.contrib.auth',
    'django.contrib.contenttypes',
    'django.contrib.messages',
    'django.contrib.sessions',
    'django.contrib.sites',
    'django.contrib.staticfiles', 
```

我收集了。

所以现在文件显示在我项目的静态目录中，但是当我尝试访问时，例如，[http://localhost:8000/static/admin/js/actions.js](http://localhost:8000/static/admin/js/actions.js)我得到一个带有“/usr/local/”的 404 lib/python2.7/dist-packages/django/contrib/admin/media/js/actions.js" 不存在

为什么 django 在我的媒体目录而不是我的静态目录中查找，我该如何解决？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-17T22:17:59.507

问题实际上是我使用的是runcserver而不是runserver，并且runcserver已经硬编码：

```
option_list = BaseCommand.option_list + (
    make_option('--noreload', action='store_false', dest='use_reloader', default=True,
        help='Tells Django to NOT use the auto-reloader.'),
    make_option('--adminmedia', dest='admin_media_path', default='',
        help='Specifies the directory from which to serve admin media.'),
)

try:
    path = admin_media_path or django.__path__[0] + '/contrib/admin/media' 
```

而不是'/contrib/admin/static'

使用 runcserver --adminmedia 'static/admin' 清除一切。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-17T22:12:27.897

来自[https://docs.djangoproject.com/en/dev/releases/1.4/#django-contrib-admin](https://docs.djangoproject.com/en/dev/releases/1.4/#django-contrib-admin)

> 如果您隐式依赖 Django 源代码中管理静态文件的路径，则需要更新该路径。文件**从**django/contrib/admin/media/ 移动到 django/contrib/admin/static/admin/。

检查你的 urls.py。也许它包含这样的东西：

```
if settings.DEBUG:
    urlpatterns += patterns('',
    url(r'^somepath/(?P<path>.*)$', 'django.contrib.staticfiles.views.serve'),
) 
```

# .net - 远程桌面 PowerShell 脚本

> ID：10199483
> 
> 赞同：0
> 
> 时间：2012-04-17T21:30:29.953
> 
> 标签：.net, powershell, remote-desktop

我无法`UserAssignment`使用 .net 访问容器。我能够进入应用程序容器，但没有进一步。任何想法将不胜感激。我正在使用的代码是：

```
Private Function runScript2(userName As String, applicationName As String) As String
    Dim rs As Runspace = RunspaceFactory.CreateRunspace
    rs.Open()

    Dim ps As PowerShell = PowerShell.Create
    ps.Runspace = rs
    Dim sb2 As New StringBuilder
    sb2.AppendLine("Import-Module -Name C:\RemoteDesktopServices\RemoteDesktopServices.psd1")
    sb2.AppendLine("Get-ChildItem -Path RDS:\") 'this works
    sb2.AppendLine("Get-ChildItem -Path RDS:\RemoteApp\RemoteAppPrograms\WordPad\")  'this works
    sb2.AppendLine("Get-ChildItem -Path RDS:\RemoteApp\RemoteAppPrograms\WordPad\UserAssignment") 'this does not work, no error
    sb2.AppendLine("Get-ChildItem -Path C:\MyScripts")
    ps.AddScript(sb2.ToString)

    Dim output As Collection(Of PSObject) = ps.Invoke
    Dim sb As New StringBuilder
    For Each obj As PSObject In output
        If TypeOf (obj.BaseObject) Is DirectoryInfo Then
            Dim fle As DirectoryInfo = CType(obj.BaseObject, DirectoryInfo)
            sb.AppendLine(fle.FullName)
        ElseIf TypeOf (obj.BaseObject) Is FileInfo Then
            Dim fle As FileInfo = CType(obj.BaseObject, FileInfo)
            sb.AppendLine(fle.FullName)
        Else
            sb.AppendLine(obj.BaseObject.ToString)
        End If
    Next
    Return sb.ToString

End Function 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-18T10:36:02.493

It doesn't fail, you simply has no any `UserAssignment`s yet, so it return you nothing. As soon as you will add some user - it will return it. You can check it by adding user manually through `Computer Management` console

# c# - 实现可观察集合的问题

> ID：10199487
> 
> 赞同：0
> 
> 时间：2012-04-17T21:30:49.407
> 
> 标签：c#, wpf, binding, mvvm, observablecollection

我有一个存储在数据库中的对象，我正在我的视图模型中检索该对象并将其放入可观察的集合中。这些对象是属性（房屋/不动产），每个都有一个称为图像的子对象。每个属性可以有多个图像（但每个图像只能有一个属性）。我只想使用一个视图模型。我的属性可以很好地填充列表框，并且可以成功地将图像绑定到后续列表框，但前提是我通过 iList 进行绑定。我的问题是如何将图像实现为它们自己的可观察集合（以便我可以监视更改），而不是 iList。这是我上面提到的一些功能的代码......

```
 public IList<Image> Images
    {
        get
        {
            if (CurrentProperty != null)
                return CurrentProperty.Images.ToList();
            return null;
        }
    }

 private void Load()
    {
        PropertyList = new ObservableCollection<Property>(from property in entities.Properties.Include("Images") select property);        

        //Sort the list (based on previous session stored in database)
        var sortList = PropertyList.OrderBy(x => x.Sort).ToList();
        PropertyList.Clear();
        sortList.ForEach(PropertyList.Add);

        propertyView = CollectionViewSource.GetDefaultView(PropertyList);         
        if (propertyView != null) propertyView.CurrentChanged += new System.EventHandler(propertyView_CurrentChanged);           

        public const string PropertiesPropertyName = "PropertyList";
    private ObservableCollection<Property> _PropertyList = null;

    public ObservableCollection<Property> PropertyList
    {
        get
        {
            return _PropertyList;
        }

        set
        {
            if (_PropertyList == value)
            {
                return;
            }

            var oldValue = _PropertyList;
            _PropertyList = value;

            // Update bindings, no broadcast
            RaisePropertyChanged(PropertiesPropertyName);
        }
    } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-18T06:52:19.823

最终通过遵循此问题提供的答案解决了该问题：

[Listview 显示 ObservableSelection](https://stackoverflow.com/questions/10196127/listview-to-display-observableselection)

我为图像创建了一个 observablecollection，然后创建了一个新方法 images_Update() ，每次视图的当前项（属性 observable 集合）更改时都会调用该方法。我还将它放在 AddImage() 和 DeleteImage() 方法的底部，以确保在调用它们时更新列表。

# php - 当id为空时使用php从mysql中选择数据

> ID：10199489
> 
> 赞同：-1
> 
> 时间：2012-04-17T21:30:53.800
> 
> 标签：php, mysql

如果用户登录，我会得到用户成员 ID。所以我打印用户 ID。这很有效，所以如果用户没有登录，我会打印`0`用户 ID。现在，当我选择任何数据表单 mysql （***如果用户未登录 $id = '0';***）我的代码不起作用，我无法打印结果。我认为我的问题是单引号`id = '.$id.'`。如何解决这个问题？

检查用户是否登录：

```
if($_SESSION['login'] > 0){
   $id = $row['id']} else {
   $id = '0';} 
```

选择具有用户 ID 的数据：

```
$sql = 'SELECT * FROM data_test WHERE id = '.$id.' AND productid = '.$row2['id'];

 ...... 
```

编辑注：`$row2['id']`是另一个结果，与 . 无关`$id`。谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-17T21:48:53.063

首先，PDO（或任何准备好的语句机制）将解决您在构建查询中的大部分问题。这种意大利面条式的 SQL 读起来不好。

这里有例子：[http ://www.php.net/manual/en/pdo.prepare.php](http://www.php.net/manual/en/pdo.prepare.php)

也许您想获取空值的记录？NULL 在 mysql 中的处理方式略有不同。你所要做的：

```
SELECT * FROM table WHERE field IS NULL; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-17T21:34:43.853

尝试：

```
$sql = "SELECT * FROM data_test WHERE id = '$id' AND productid = '{$row2['id']}'"; 
```

$row2['id'] 也应该是 $row['id']

# android - 如何根据方向设置视口，使其为 380x800 或 800x380？

> ID：10199495
> 
> 赞同：1
> 
> 时间：2012-04-17T21:31:17.933
> 
> 标签：android, html, cordova, viewport

元标记“视口”让我可以设置网站的初始比例，但如果用户随后翻转设备的方向，这会变得很奇怪。

例如，如果我将比例设置为 800x380 并且用户以纵向模式打开网站，那么这个比例显然是错误的，当用户旋转 90 度时，网站最终会变得更像 1650 宽。

我将如何设置一个视口，如果设备一开始是横向的，它是 800x380，如果它是纵向的，它是 380x800？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-20T11:24:00.347

要检测方向变化，请将事件侦听器附加到窗口：

```
window.addEventListener('orientationchange', updateOrientation, false); 
```

在 updateOrientation 函数中，您可以检测设备所处的方向并相应地重置视口属性：

```
function updateOrientation() {
  if (!(navigator.userAgent.match(/iPhone/i)) && !(navigator.userAgent.match(/iPod/i))) {
    return;
  }

  var viewport = document.querySelector("meta[name=viewport]");

  switch (window.orientation) {
    case 0: //portrait
      //set the viewport attributes to whatever you want!
      //For Ex : viewport.setAttribute('content', 'width=device-width, initial-scale=1.0, user-scalable=1;');
      break;
    case 90: case -90: //landscape
      //set the viewport attributes to whatever you want!
      break;
    default:
      //set the viewport attributes to whatever you want!
      break;
  }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-17T21:58:26.670

您不应该像这样设置应用程序的“规模”。您应该努力通过使用允许不同屏幕密度的单位来使您的应用程序独立扩展。尝试使用“dp”作为一个单位并安排你的布局，使它们与规模无关。

必须在 android 中构建布局的方式是在平台上开发对我来说更具挑战性的方面之一。抱歉，这在技术上不是一个答案，但因为 android 可以在这么多设备（平板电脑、手机、其他设备）上运行，你真的应该利用密度独立单元和文件夹来进行分辨率缩放（你的高密度、中密度、和drawable中的低密度文件夹。）

但是，您可以在启动时检测方向（onCreate() 或 onResume()），然后从资源中加载适当的布局。不过，您必须保留所有布局的两份副本（一份用于水平方向，一份用于垂直方向。）您还必须配置方向更改以触发布局更改。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-19T07:17:54.647

针对不同的屏幕尺寸和方向使用媒体查询。

```
 <html>
      <head>
        <meta name="viewport" content="width=device-width; height=device-height; user-scalable=no; initial-scale=1; />
        <link rel="stylesheet" href="main_portrait.css" type="text/css" media="all and (orientation:portrait)">
        <link rel="stylesheet" href="main_landscape.css" type="text/css" media="screen and (max-width:500px) and (orientation:landscape)">
        <link rel="stylesheet" href="main_landscape_big.css" type="text/css" media="screen and (min-width: 501px) and (orientation:landscape)">
        <script type="text/javascript" charset="utf-8" src="cordova-1.6.0.js"></script>
        <script type="text/javascript" charset="utf-8" src="main.js"></script>
      </head>
      <body onload="init();"></body>
    </html> 
```

第一个样式表链接适用于纵向模式的所有设备。
当方向为横向时，第二个样式表适用于最大宽度为 500 像素的设备
，最后一个样式表适用于宽度大于 500 像素且方向为横向的设备。

您可以为所需的每个组合添加更多样式表。

这是媒体查询的文档：[W3C 媒体查询](http://www.w3.org/TR/css3-mediaqueries/)
和优秀教程：[如何使用 CSS3 媒体查询创建网站的移动版本](http://coding.smashingmagazine.com/2010/07/19/how-to-use-css3-media-queries-to-create-a-mobile-version-of-your-website/)

# signalr - 无法注册新的 IConnectionIdFactory

> ID：10199497
> 
> 赞同：1
> 
> 时间：2012-04-17T21:31:23.580
> 
> 标签：signalr

我正在尝试指定一个新的 ConnectionIdFactory 并将以下代码包含到 global.asax 的 Application_Start 方法中。我引用了 SignalR 和 SignalR.Hosting.AspNet 组件。

```
AspNetHost.DependencyResolver.Register(typeof(IConnectionIdFactory),
                                              () => new MyConnectionIdFactory()); 
```

“注册”方法在编辑器上显示“无法解析符号‘注册’”。如果我尝试编译，我会得到

*语言不支持“SignalR.Hosting.AspNet.AspNetHost.DependencyResolver”*

**更新 4/18：**有人在 0.5 中做过这个吗？我想在最新的代码库中尝试它，但我知道 AspNetHost 命名空间在 0.5 中已弃用。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-24T22:50:48.030

[Jonas Stawski](http://www.jstawski.com/archive/2012/05/09/AspNetHost-deprecated-in-SignalR-0-5.aspx)说 AspNetHost 在 0.5 中已被弃用。

相反，您可以使用：

```
GlobalHost.DependencyResolver.Register 
```

这是另[一篇](http://weblogs.asp.net/davidfowler/archive/2012/05/04/api-improvements-made-in-signalr-0-5.aspx)关于 0.5 更改的文章。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-18T19:52:21.017

我想通了——原来我正在运行 SignalR 0.5 和 Signal.Hosting.AspNet 0.4。（打脸）。发生这种情况是因为我试图在 0.5 之前使用我自己的 IConnectionIdFactory，但无法弄清楚所以回到 0.4。我以为我删除了所有引用，但我想我错过了一些东西。

希望这可以帮助另一个迷失的灵魂。

# database - 如何重读perl数据库查询结果

> ID：10199501
> 
> 赞同：1
> 
> 时间：2012-04-17T21:31:53.157
> 
> 标签：database, perl

我想使用两次查询的结果。
如何重新定位指针以第二次从头开始读取结果？
下面的示例（为简单起见仅打印到屏幕上）：

```
if ( $dbh = DBI->connect( "DBI:mysql:database=tng;host=ip", "username", "password" ) ) {
    $strSQL = "select * from table";
    if ( $strQuery = $dbh->prepare($strSQL) ) {
        if ( $strQuery->execute() ) {
            while ( @data = $strQuery->fetchrow_array() ) {
                print $data[0];
            }
            --reposition to top and reread the query result and do something else with the data-- $strQuery->finish;
        }
        else {
            $strMsg = "$strDateTime ERROR -- unable to execute statement: " . $strQuery->errstr . "\n";
            print logFile "$strMsg";
        }
    }
    else {
        $strMsg = "$strDateTime ERROR -- unable to prepare statement: " . $dbh->errstr . "\n";
        print logFile "$strMsg";
    }
    $dbh->disconnect();
}
else {
    print logFile "$strDateTime ERROR -- unable to connect to iptables database ... " . DBI->errstr . " \n";
} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-17T23:04:35.417

您不会期望 IO 库将整个文件加载到内存中以逐行读取，那么您为什么期望它来自数据库库呢？

此外，这完全没有必要。加载完整的结果非常容易。

```
my $sth = $dbh->prepare($sql);
my $data = $dbh->selectall_arrayref($sth);

for my $row (@$data) {
    my ($col1, $col2, ...) = @$row;
    ...
}

for my $row (@$data) {
    my ($col1, $col2, ...) = @$row;
    ...
} 
```

如果您需要 DBI 某事，您可以将数据加载到[DBD::Sponge中。](http://search.cpan.org/perldoc?DBD::Sponge)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-17T22:02:34.910

我正要说你不能这样做，但看起来你可以，你只需要`execute`再次声明句柄。请注意，此代码使用 PostgreSQL，因为我使用它（并且手边没有安装 MySQL），但它也应该对您有用。

```
use strict;
use warnings;
use DBI;
my $dbh=DBI->connect("dbi:Pg:dbname=db;host=hosty-host-host","username","password")
  or die DBI->errstr;

my $sth=$dbh->prepare("select generate_series(1,5)") or die $dbh->errstr;
$sth->execute or die $dbh->errstr;

while(my @row=$sth->fetchrow_array)
{
  print "$row[0]\n";
}

print "\nSecond verse, same as the first!\n\n";
$sth->execute or die $dbh->errstr;

while(my @row=$sth->fetchrow_array)
{
  print "$row[0]\n";
}

$sth->finish;
$dbh->disconnect; 
```

输出是：

```
1
2
3
4
5

Second verse, same as the first!

1
2
3
4
5 
```

顺便说一句，我建议通过查看[`err`和/或`errstr`](http://search.cpan.org/~timb/DBI-1.618/DBI.pm#err)而不是使用一堆 if-else 语句来检查错误。

**编辑添加：** 如果您不想`execute`再次处理语句（并从数据库中重新读取信息），您可能会遇到 a) 将数据存储在 (Perl) 数据结构中或 b) 将其写入文件然后从文件中读取它（并`seek`根据需要多次使用文件句柄）。

# facebook - 将 Facebook 选项卡中的可点击图片带到 Facebook 上的另一个应用程序

> ID：10199503
> 
> 赞同：0
> 
> 时间：2012-04-17T21:32:01.410
> 
> 标签：facebook, tabs

我有一个 Facebook 选项卡，其中有一个指向 Facebook 应用程序的图片链接。但是，即使图片是可点击的，它什么也没做！如果我尝试右键单击并在新选项卡/窗口中打开，则链接有效！

有谁熟悉这个问题？这是我在正文中唯一的 html，它在 ASP.NET 中，并且链接有一个，因为我根据某些参数`runat="server"`修改了链接。`Page_Load`

```
 <a href="http://www.facebook.com/myAppLink" runat="server" id="aLink">
        <img src="pictureTab.jpg" border="0" />
    </a> 
```

我只需要链接才能真正转到`http://www.facebook.com/myAppLink`.

提前致谢。

**更新：**

我尝试添加`target="_parent"`并且它有效。

```
 <a href="http://www.facebook.com/myAppLink" runat="server" id="aLink" target="_parent">
        <img src="pictureTab.jpg" border="0" />
    </a> 
```

也可以使用`target="_blank"`，但会在新选项卡中打开应用程序。

# python - 正则表达式替换直到评论

> ID：10199507
> 
> 赞同：1
> 
> 时间：2012-04-17T21:32:32.800
> 
> 标签：python, regex, replace

我有这个文件：

```
 # blah blah blah DO NOT REPLACE blah blah
 blah blah blah
 blah blah REPLACE # comment comment
 REPLACE blah blah 
```

注释以“#”开头，我想替换不在注释中的关键字。

我正在使用python，我该怎么做？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-17T21:39:19.847

不要使用正则表达式。相反，在字符处拆分行`#`并只处理第一部分：

```
>>> lines = '''
...  # blah blah blah DO NOT REPLACE blah blah
...  blah blah blah
...  blah blah REPLACE # comment comment
...  REPLACE blah blah
... '''
>>> [l.split('#', 1) for l in lines.split('\n')]
[[''], 
 [' ', ' blah blah blah DO NOT REPLACE blah blah'], 
 [' blah blah blah'], 
 [' blah blah REPLACE ', ' comment comment'], 
 [' REPLACE blah blah'], ['']] 
```

您现在可以编写代码（可能使用另一个列表推导式）来替换`REPLACE`第一部分中出现的 并重新加入整个事物。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-18T00:13:12.590

我同意 Niklas B，您的问题不需要正则表达式。

你可以使用一些这样的：

```
>>> f = lambda text, sub, repl: \
... '\n'.join([line.split('#')[0].replace(sub, repl) + '#' + line.split('#',1)[1] \
... if '#' in line else line.replace(sub, repl)
... for line in text.split('\n')]) 
```

然后，如果你有

```
>>> text = """# blah blah blah DO NOT REPLACE blah blah
...  blah blah blah
...  blah blah REPLACE # comment comment
...  REPLACE blah blah""" 
```

并想将“替换”替换为“%%%%”，您可以使用函数 f，例如：

```
>>> print f(text, 'REPLACE', '%%%%')
# blah blah blah DO NOT REPLACE blah blah
 blah blah blah
 blah blah %%%% # comment comment
 %%%% blah blah 
```

# excel - Excel。在不同的工作表中创建图表

> ID：10199509
> 
> 赞同：0
> 
> 时间：2012-04-17T21:32:37.043
> 
> 标签：excel, vba, charts

我需要在 Excel 中为每张工作表创建一个图表。这是我的代码：

```
 Sheets(i).Activate

    For Each cht In ActiveSheet.ChartObjects
        cht.Delete
    Next

    'create chart
    Set chtChart = ActiveSheet.ChartObjects.Add(Left:=75, Width:=300, Top:=75, Height:=300).Chart
    With chtChart
        .ChartType = xlXYScatterSmooth

        Do While .SeriesCollection.Count <> 0
            Do Until .SeriesCollection.Count = 0
                .SeriesCollection(1).Delete
            Loop
        Loop

        Set srsNew = .SeriesCollection.NewSeries
        With srsNew
            .XValues = "='" & Sheets(i).Name & "'!" & _
            Sheets(i).Range(Range("K2"), Range("k2").End(xlDown)).Address
            .Values = "='" & Sheets(i).Name & "'!" & _
            Sheets(i).Range(Range("l2"), Range("l2").End(xlDown)).Address
        End With
    End With 
```

对于第一张纸，这有效，但对于第二张，第三张……它没有。它在 XValues 或 Values 中发出错误 1004“应用程序定义或对象定义错误”。我还注意到，如果我介绍

```
range("K2") 
```

在 with 块之外，我在第二张、第三张.... 表中出现错误，但在第一张中没有。

任何建议都是最受欢迎的

问候

若昂

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-17T21:52:36.170

1.  `Range`用它们所属的表来限定你的 s。
2.  不要使用`Select`或`ActiveSheet`。
3.  不要建立字符串地址。直接使用范围。

```
Dim CurSheet As Worksheet, cht As ChartObject
Dim chtChart As Chart, srsNew As Series

...

Set CurSheet = Worksheets(i)

For Each cht In CurSheet.ChartObjects
  cht.Delete
Next

'create chart
Set chtChart = CurSheet.ChartObjects.Add(Left:=75, Width:=300, Top:=75, Height:=300).Chart
With chtChart
  .ChartType = xlXYScatterSmooth

  Do While .SeriesCollection.Count <> 0
    .SeriesCollection(1).Delete
  Loop

  Set srsNew = .SeriesCollection.NewSeries
  With srsNew
    .XValues = CurSheet.Range(CurSheet.Range("k2"), CurSheet.Range("k2").End(xlDown))
    .Values = CurSheet.Range(CurSheet.Range("l2"), CurSheet.Range("l2").End(xlDown))
  End With
End With 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-17T21:53:00.113

如果您像这样完全限定这些范围，也许会有所帮助：

```
With srsNew
    .XValues = "='" & Sheets(i).Name & "'!" & _
    Sheets(i).Range(Sheets(i).Range("K2"), Sheets(i).Range("k2").End(xlDown)).Address
    .Values = "='" & Sheets(i).Name & "'!" & _
    Sheets(i).Range(Sheets(i).Range("l2"), Sheets(i).Range("l2").End(xlDown)).Address
End With 
```

# html - 将浮动 div 的文本设置为浮动和正确换行，而无需硬编码 div 宽度？

> ID：10199510
> 
> 赞同：6
> 
> 时间：2012-04-17T21:33:04.260
> 
> 标签：html, css

看看下面的jsfiddle：

[http://jsfiddle.net/tTNNm/](http://jsfiddle.net/tTNNm/)

如何在不硬编码CSS 中`div.text`的宽度的情况下让图像 div 旁边浮动？`div.text`

div 应该是其内容的全宽，然后高度应该由由于其父元素的宽度限制而需要换行到下一行的内容量来确定。所以在我的小提琴中，为什么会`div.text`占用完整的 300px 宽度并强制自己到下一行，而不是在计算宽度为 200px 的图像 div 旁边适合？

参考：

```
<div class="test">
    <div>
        <img src="http://www.cadcourse.com/winston/Images/SoccerBall.jpg" width="100" height="100"/>
    </div>
    <div class='text'>
        Lorem ipsum dolor sit amet, consectetur adipisicing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua.
    </div>
</div>​

div.test {
    width: 300px;
    outline: 1px solid blue;
    height: 100px;
}

div.test div {
    float: left;
    outline: 1px solid red;
} 
```

​</p>

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-04-17T21:39:31.353

这是因为两个 div 都继承了`float: left;`. 尝试将此添加到您的 CSS 中：

```
div.test div.text {
    float: none;
    outline: 1px solid red;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-17T21:47:43.410

[此代码](http://jsfiddle.net/tTNNm/12/)将使文本不会环绕图像，而只是简单地“调整” div 以适应相应的大小（假设图像为 100 像素宽）。

## HTML

```
<div class="test">
    <div class="image">
        <img src="http://www.cadcourse.com/winston/Images/SoccerBall.jpg" width="100" height="100"/>
    </div>
    <div class='text'>
        Lorem ipsum dolor sit amet, consectetur adipisicing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Lorem ipsum dolor sit amet, consectetur adipisicing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua.
    </div>
</div> 
```

## CSS

```
div.test {
    width: 300px;
    outline: 1px solid blue;
    height: 100px;
}

div.test div.image {
    float: left;
    outline: 1px solid red;
}
div.test div.text {
    outline: 1px solid orange;
    padding-left:110px;
} 
```

# jquery - Struts 2 动作结果和 Jquery POST

> ID：10199512
> 
> 赞同：0
> 
> 时间：2012-04-17T21:33:11.163
> 
> 标签：jquery, struts2

我想知道如何使用 Struts2 操作结果中的 jquery $post 处理错误。

例如，在我的 strut2.xml 中，我使用以下内容处理了错误：

```
<action name="helloWorld" class="net.roseindia.Struts2HelloWorld">
   <result="success">/pages/HelloWorld.jsp</result>
   <result="error">/pages/HelloWorld.jsp</result>
</action> 
```

在我的 jquery 调用中，我有以下内容：

```
$.post("helloWorld", function(){

}).success(result){
    $("#div").html(result);
}).error(){
    alert("ERROR");  

}; 
```

即使结果等于错误，它也总是会成功。

那么如何在我的 jquery 调用中使 result="error" 转到 $.post 错误？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-17T21:36:12.093

它是“成功的”，因为无论“返回”什么，您都会有一个 AJAX 成功的请求/响应。您需要做的是从 servlet 设置一些“失败”通知，然后检查“成功”块中返回的内容。

“成功”表示请求返回“2xx”代码。“错误”表示非 2xx 成功：

更多关于 html 代码的信息：http: [//www.w3.org/Protocols/HTTP/HTRESP.html](http://www.w3.org/Protocols/HTTP/HTRESP.html)

就像这样（**不是有用的代码，但你会明白的**）

```
$.post("helloWorld", function(){

}).success(result){
    if(result == some error condition) { this.error;} 
else { //process the success
        $("#div").html(result);
}
    }).error(){
    alert("ERROR");  

}; 
```

编辑：安东尼在下面发表评论说，由于用户可以控制所请求的服务/页面-您可以以返回 html 错误代码*而不是询问结果 html*的方式构建 servlet/代码-这是一个很好的建议. 谢谢安东尼

# python - Python 使用 matplotlib 绘制日期

> ID：10199514
> 
> 赞同：1
> 
> 时间：2012-04-17T21:33:29.407
> 
> 标签：python, csv, matplotlib, wxpython

我是 Python 和 matplotlib 的初学者，但我正在努力学习！我想使用 matplotlib 从包含频率的日期的 CSV 中绘制一些简单的数据。X 轴包含日期，Y 轴包含频率。来自 CSV 的示例数据：

```
2011/12/15,5
2011/12/11,4
2011/12/19,2 
```

我检查了“matplotlib.sf.net/examples”，但似乎所有测试数据都是从 http get 下载的。如果有人能用一些示例代码指导我如何读入（可能使用 CSV 阅读器）并在图表中显示数据，我将不胜感激。

谢谢！！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-17T23:42:36.263

也许您正在寻找类似的东西：

```
import csv
import datetime as dt
import matplotlib.pyplot as plt

arch = 'C:\\Python26\\programas\\test.csv'
data = csv.reader(open(arch))

data = [(dt.datetime.strptime(item, "%Y/%m/%d"), float(value)) for item, value in data]
data.sort()
[x, y] = zip(*data)

fig = plt.figure()
ax = fig.add_subplot(111)
ax.plot(x, y)

ax.grid(True)
fig.autofmt_xdate()

plt.show() 
```

![在此处输入图像描述](../Images/b94008e82486be385c7b1b26c744d850.png)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-17T23:33:36.430

我试图让我的代码尽可能简单，这绝不是优雅的，但你去吧：

```
import csv
import matplotlib.pyplot as plt

### Making test CSV file ###
data = [['2011/12/15,5'],['2011/12/11,4'],['2011/12/19,2'],['2011/12/16,3'],['2011/12/20,8'],['2011/12/14,4'],['2011/12/10,10'],['2011/12/9,7']]
with open('test.csv', 'wb') as f:
    writer = csv.writer(f)
    for i in data:
        writer.writerow(i)

### Extract data from CSV ###
with open('test.csv', 'rb') as n:
    reader = csv.reader(n)
    dates = []
    freq = []
    for row in reader:
        values = row[0].split(',')
        dates.append(values[0])
        freq.append(values[1])          

### Do plot ###
false_x = [x for x in range(len(dates))]
plt.plot(false_x,freq, 'o-')
plt.xticks(range(len(dates)), (dates), rotation=45)
# plt.axis([xmin, xmax, ymin, ymax]) - sets axes limits on graph
plt.axis([-1, 8, 0, 11])
plt.show() 
```

这使得：

![在此处输入图像描述](../Images/88a8176c657c056d5bf2189feb6253fb.png)

# php - 在 php 中验证输入数据 - javascript

> ID：10199517
> 
> 赞同：0
> 
> 时间：2012-04-17T21:33:51.017
> 
> 标签：php, javascript

我想验证用户在表单中输入的数据。我只有一个用户名和两个密码字段。我的第一个问题是我用 javascript 检查数据并且工作正常，但我也想用 php 检查数据，以防 javascript 不起作用。如果 javascript 不工作，将从 php 代码检查数据，但我的问题是，如果 javascript 工作，那么数据也将从 javascript 和 php 检查。这样好吗？当输入数据由javascript检查时，有什么方法可以避免用php检查？我也在检查输入（用户名和密码）的字符数，字符（我不允许特殊字符，只有“_”，“。” 数字和字母以避免 sql 注入） - 你觉得如何？对于更好的验证，您还有其他建议吗？

先感谢您。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-17T21:37:42.280

您应该**始终**对用户输入进行服务器端（php）验证。客户端（javascript）验证只对更好的用户体验有益。此外，您不应将输入限制为某些字符以防止 mysql 注入，还有其他可靠的方法。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-17T21:38:12.857

是的，您应该同时验证客户端 (JS) 和服务器端 (PHP)。

在客户端上这样做是为了方便您的用户并获得更好的用户体验。

在服务器上执行此操作以防止恶意攻击，或者如您所说，以防您的用户禁用了 JS。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-04-17T21:38:27.120

您应该始终执行服务器端验证。不能保证客户端验证（例如 javascript 验证）不会被击败。获取调试工具（现在很多都内置在浏览器中）和规避 javascript 验证是一个简单的练习。

通常没有任何问题，甚至建议在 Javascript 和 PHP 的两个地方都进行验证。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-04-17T21:38:00.647

检查两种方式都很好，绝对推荐。如果您想避免在启用 Javascript 的情况下使用 PHP 检查，您可以在表单中附加一个隐藏字段并使用 PHP 进行检查。

例如

```
if(!isset($_POST['js_hidden_field'])) {

    // Run Validation 

} 
```

因此，您检查隐藏字段，如果未设置，则运行 PHP 验证

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-04-17T21:39:48.053

这实际上很好，在我看来，你永远不能做太多的验证。任何具有 Web 开发经验的人都可以操作客户端脚本，但服务器端脚本不能。

客户端脚本验证专家：

*   在提交数据之前提醒用户，允许他们自行更正
*   使您的网站看起来更复杂

服务器端验证优点：

*   没有人可以更改您拥有的任何验证规则
*   他们无法关闭服务器端验证。

简而言之，两者都做很好，实际上比只做其中一个要好。

# php - 建立一个数据库来跟踪哪些用户点击了哪些链接？

> ID：10199521
> 
> 赞同：10
> 
> 时间：2012-04-17T21:34:13.120
> 
> 标签：php, mysql, html, sql

我将尝试详细说明我的问题。

我最近在我的大学获得了一个入门级的兼职开发人员职位，以努力提高我的开发技能。虽然我过去使用过 MySQL，但仅在一门课程中简要介绍了它，因为我主要是前端人员（HTML/CSS/JS）。

无论如何，雇用我的部门有一个专为新生设计的网站，让他们适应大学。它有教程和视频供他们观看等。为了访问该站点，他们必须登录到他们的大学帐户（使用 LDAP）。帐户名称的格式为 abc1234。

现在，我的问题是我需要为员工创建一种方法来跟踪新生观看了哪些教程/视频。他们希望我使用数据库来做到这一点。可能会有成千上万的学生，他们希望能够准确地看到哪些学生已经/没有点击每个链接/观看了每个视频。

我应该如何为此设置数据库？他们想要跟踪多个链接/教程/视频。如果有一种方法可以跟踪哪些用户观看了视频到最后，则可以加分，但不是必需的。

我相信我需要使用 PHP 来处理浏览器和数据库之间的交换，对吗？

感谢您提供任何帮助或提示。:)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-17T23:05:53.997

您可以简单地制作一个 PHP 脚本，为它们检索请求的链接，同时向 MySQL 添加一个值。

如果我要这样做，我可能会做这样的事情：

```
<a href="getResource.php?res=video1.mpg&type=video">Video 1</a> 
```

而在 PHP 中，我只需从会话中获取资源、类型和用户 ID，将它们放入数据库中，然后检索他们正在寻找的资源。要跟踪他们是否全程观看了视频，您可以使用 javascript 来观察播放器即将结束的事件，然后只需使用没有擦洗栏的皮肤。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-17T21:44:22.523

例如，您需要一个表“用户：id、名称等...”和一个表“点击：user_id、url”。

要跟踪链接点击次数，您可以执行以下操作：

```
<a hreF="log_click.php?url=<?php echo urlencode("some_url?some=param&etc=anything"); ?>"> 
```

**log_click.php**

```
<?php
$url = $_GET['url'];
$user = /* ie. $_SESSION['user_id'] */
/* insert to database */
header('Location: '. $url); // maybe need urldecode($url) here
exit;
?> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-17T21:46:05.237

有趣的项目。您应该从当前访问的页面中提取用户，并将其存储在每个用户的访问页面日志（在数据库中）中。

# java - 解析/解组在 Java 中将数组作为参数传递的查询字符串

> ID：10199524
> 
> 赞同：0
> 
> 时间：2012-04-17T21:34:21.020
> 
> 标签：java, url, query-string, jersey, kendo-ui

有没有办法**解析/解组**查询字符串，将数组作为 Java 中的参数传递到 Map 或自定义类中？

网址示例：

localhost:8080/app/ws/categories?take=10&skip=10&page=2&pageSize=10&filter[logic]=and&filter[filters][0][field]=company_id&filter[filters][0][operator]=eq&filter[filters][ 0][值]=1513

我需要像这样解析**过滤器参数：**

```
public class Filter {

private String logic;
private List<Filters> filters;

public class Filters {
    private String field;
    private String operator;
    private String value;
    }
} 
```

还有一点 - 我在这里使用 Jersey，也许有可能使用**Jersey 的工具****解析/解组**@QueryParam ？

 **无论如何，任何其他 Java 解决方案也可以。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-06-26T17:16:50.383

我们可以使用 JAXRS 2.0 规范中的 @BeanParam 来做到这一点

```
public PageableResponse<PatientBundleType> getPatientBundles(@BeanParam final PageableBeanParam paging)
{
    ...
}

public class PageableBeanParam
{
    public PageableBeanParam(@Context final UriInfo uriInfo)
    {

        for (Entry<String, List<String>> param : params.entrySet())
        {
            String key = param.getKey();
            String value = param.getValue().iterator().next();

            if ("pageSize".equals(key))
            {
                setPageSize(Integer.valueOf(value));
            }

            ...
        }
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-18T09:30:06.863

I would suggest 2 things :

Either you want to perform a GET, then to keep a RESTful approach, I would have an Url like : localhost:8080/app/ws/categories?take/10/skip/10/page/2/pageSize/10/filter/logic/and/ ...etc

Or POST is acceptable, and I would send JSON payload**

# delphi - 如何使用 delphi 提高 WMI 性能？

> ID：10199531
> 
> 赞同：14
> 
> 时间：2012-04-17T21:34:43.220
> 
> 标签：delphi, wmi

我编写了一个简单的函数来使用 WMI 检索系统信息，将类和属性名称作为参数传递。当我执行这样的功能时

```
 Writeln('Procesor Id '+GetWMIInfo('Win32_Processor','Name'));
  Writeln('Mother Board Serial '+GetWMIInfo('Win32_BaseBoard','SerialNumber'));
  Writeln('BIOS Version '+GetWMIInfo('Win32_BIOS','Version')); 
```

执行时间约为 1300 ms。

我需要检索很多附加信息，那么是否可以减少此函数的执行时间？

这是一个带有函数的示例应用程序

```
{$APPTYPE CONSOLE}

uses
  Diagnostics,
  SysUtils,
  ActiveX,
  ComObj,
  Variants;

function  GetWMIInfo(const WMIClass, WMIProperty:string): string;
var
  sWbemLocator  : OLEVariant;
  sWMIService   : OLEVariant;
  sWbemObjectSet: OLEVariant;
  sWbemObject   : OLEVariant;
  oEnum         : IEnumvariant;
  iValue        : LongWord;
begin;
  Result:='';
  sWbemLocator  := CreateOleObject('WbemScripting.SWbemLocator');
  sWMIService   := sWbemLocator.ConnectServer('', 'root\CIMV2', '', '');
  sWbemObjectSet:= sWMIService.ExecQuery('SELECT * FROM '+WMIClass,'WQL');
  oEnum         := IUnknown(sWbemObjectSet._NewEnum) as IEnumVariant;
  if oEnum.Next(1, sWbemObject, iValue) = 0 then
    Result:=sWbemObject.Properties_.Item(WMIProperty).Value;
end;

var
 SW : TStopwatch;

begin
 try
    CoInitialize(nil);
    try
      SW.Reset;
      SW.Start;
      Writeln('Procesor Id '+GetWMIInfo('Win32_Processor','Name'));
      Writeln('Mother Board Serial '+GetWMIInfo('Win32_BaseBoard','SerialNumber'));
      Writeln('BIOS Version '+GetWMIInfo('Win32_BIOS','Version'));
      SW.Stop;
      Writeln('Elapsed ms '+FormatFloat('#,0.000',SW.Elapsed.TotalMilliseconds));
    finally
      CoUninitialize;
    end;
 except
    on E:Exception do
        Writeln(E.Classname, ':', E.Message);
 end;
 Readln;
end. 
```

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2012-04-17T22:01:35.097

这些是提高 WMI 性能的一些技巧

1.) 重新调用[`CreateOleObject`](http://docwiki.embarcadero.com/Libraries/en/System.Win.ComObj.CreateOleObject)

2.) 重用 WMI 连接

更昂贵的任务之一是与 WMI 服务建立连接，因此请重新利用该连接，而不是每次调用该函数时都创建一个连接。

3.) 仅检索您要使用的列

检索 WMI 的每个属性都有不同的来源，如 Windows 注册表、WinAPi 等，限制列将提高性能。阅读本文了解更多信息[`How obtain the source of the WMI Data`](http://theroadtodelphi.wordpress.com/2012/04/09/how-obtain-the-source-of-the-wmi-data/)

4.)在执行 WQL 语句时使用[WBEM_FLAG_FORWARD_ONLY标志。](http://msdn.microsoft.com/en-us/library/windows/desktop/aa390880%28v=vs.85%29.aspx)

按照上述提示，我重写了您的示例应用程序

```
{$APPTYPE CONSOLE}

uses
  Diagnostics,
  SysUtils,
  ActiveX,
  ComObj,
  Variants;

var
  FSWbemLocator : OLEVariant;
  FWMIService   : OLEVariant;

function  GetWMIInfo(const WMIClass, WMIProperty:string): string;
const
  wbemFlagForwardOnly = $00000020;
var
  FWbemObjectSet: OLEVariant;
  FWbemObject   : OLEVariant;
  oEnum         : IEnumvariant;
  iValue        : LongWord;
begin;
  Result:='';
  FWbemObjectSet:= FWMIService.ExecQuery(Format('Select %s from %s',[WMIProperty, WMIClass]),'WQL',wbemFlagForwardOnly);
  oEnum         := IUnknown(FWbemObjectSet._NewEnum) as IEnumVariant;
  if oEnum.Next(1, FWbemObject, iValue) = 0 then
    Result:=FWbemObject.Properties_.Item(WMIProperty).Value;
end;

var
 SW : TStopwatch;

begin
 try
    CoInitialize(nil);
    try
      SW.Reset;
      SW.Start;
      FSWbemLocator := CreateOleObject('WbemScripting.SWbemLocator');
      FWMIService   := FSWbemLocator.ConnectServer('localhost', 'root\CIMV2', '', '');
      Writeln('Procesor Id '+GetWMIInfo('Win32_Processor','Name'));
      Writeln('Mother Board Serial '+GetWMIInfo('Win32_BaseBoard','SerialNumber'));
      Writeln('BIOS Version '+GetWMIInfo('Win32_BIOS','Version'));
      SW.Stop;
      Writeln('Elapsed ms '+FormatFloat('#,0.000',SW.Elapsed.TotalMilliseconds));
    finally
      CoUninitialize;
    end;
 except
    on E:EOleException do
        Writeln(Format('EOleException %s %x', [E.Message,E.ErrorCode]));
    on E:Exception do
        Writeln(E.Classname, ':', E.Message);
 end;
 Readln;
end. 
```

执行时间从 1245 到 180 毫秒（在我的笔记本电脑上）。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-04-17T21:58:41.320

这是一般的经验法则。

当您说要检索大量附加信息时，我认为这意味着您将多次调用此函数，可能是在循环中。对于性能调整，您只需将那些花费大量时间并且可以重用的东西从循环中取出，即缓存它们。

在这种情况下， CreateOleObject 可能会花费您大部分时间，作为第一遍，我会将其放在循环之外（或多次调用）并将您的 sWebLocator 传递给函数，作为您可能想要的第二遍ConnectServer 也调用函数并将 sWMIService 对象也传入。

# python - 使用 django 运行带有密码参数的 python 脚本

> ID：10199540
> 
> 赞同：2
> 
> 时间：2012-04-17T21:35:52.987
> 
> 标签：python, django, subprocess, django-authentication

我需要创建一个 Web 界面，该界面将提示输入用户名、密码和“记录 ID”，以使用这些凭据运行单独的 python 脚本，然后返回生成的文件。

我编写的单独脚本使用用户名/密码（和 ID）连接到 Oracle 数据库（使用 cx_Oracle），收集相关信息，生成 PDF 并将其保存到预设位置。完成后它会吐出文件名的位置。

我的想法是创建一个采用以下 3 个参数的 django 应用程序：

*   用户名
*   密码
*   ID（这将用于确定要为 PDF 获取哪些记录）

Django 将通过调用 subprocess 将参数提供给脚本。我会把它放在我的视图中，如下所示：

```
# ... 
import subprocess

# ...
def login_view(request):
    username = password = ''
    if request.POST:
        username = request.POST.get('username')
        password = request.POST.get('password')
        record_id = request.POST.get('record_id')

        output = subprocess.check_output([
            "python", 
            "myscript.py", 
            "-id", 
            record_id, 
            "-u", 
            username, 
            "-p",
            password
        ])
        # The output will look like:
        # File /path/to/1234567.pdf saved
        fname = output.split(' ')[1]

        if fname.endswith('.pdf'):
            # Get the filename without the /path/to junk in front
            fname_nopath = fname.split('/')[-1]

            file = open(fname, 'rb')
            content = file.read()
            file.close

            response = HttpResponse(content, mimetype='application/pdf')
            response['Content-Disposition'] = 'attachment; filename=%s' % fname_nopath

            return response
        else:
            response = HttpResponse(output)
            return response 
```

我认为这种方法有点“笨拙”，我认为有一种更优雅的方法可以采用。

我正在考虑的另一种方法是将外部脚本直接导入到我的 views.py 文件中，然后使用从 django 传递的用户名、密码和记录 ID 调用其主函数。这样我可以避免子流程机制。如果需要，我可以在脚本中创建一个单独的 main() 函数，让它返回一个文件字符串，并将其用于通过 django 打开/提供文件。

唯一的问题是该界面将被用户频繁使用。要求他们每次登录为每个 record_id 生成 PDF 报告有点痛苦。理想情况下，我想让用户保持登录状态（我想我必须单独维护一个 cx_Oracle 游标，并将其传递到脚本中）。

我的感觉是，这太复杂了。有没有更好的方法来做到这一点，或者我错过了什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-18T21:30:51.067

1）您应该使用 django 表单来处理用户传递的参数。

2）您可以在用户会话中保存用户名/密码 - 这样用户就不需要再次输入它们。

3) 这实际上取决于您拥有多少记录 ID，但您可以通过查询数据库来显示可用记录 ID 的列表。

# nosql - 使用 NoSQL 数据源映射应用程序？

> ID：10199542
> 
> 赞同：3
> 
> 时间：2012-04-17T21:36:22.133
> 
> 标签：nosql, gis

我一直在使用带有 postgis 数据源的 Geoserver，但我正在考虑切换到 NoSQL 解决方案来存储我的地理空间数据，因为 NoSQL 数据库的无模式特性非常适合我的应用程序。

但是，我遇到的大多数地图应用程序（geoserver、mapserver）似乎都不支持 NoSQL 数据存储。我遇到的最接近的东西是[沙发地图](https://github.com/normanb/couchmaps)

有人使用 NoSQL 进行映射吗？如果是这样，您使用了哪些工具？我特别要寻找的是一个可以使用 NoSQL 数据存储为 WMS 和 WFS 请求提供服务的应用程序。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-04T06:20:22.173

用于 GIS 数据和在 Nosql 中搜索 MongoDB 适合您，因为 mongodb 本身提供了存储和搜索 GIS 数据的工具。

[在这里](http://www.mongodb.org/display/DOCS/Geospatial+Indexing)阅读更多

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2015-03-16T08:38:42.833

我对同样的问题感兴趣，似乎 GeoServer 已准备好与 MongoDB 一起使用，如[http://www.mongodb.com/presentations/mongodb-geoserver](http://www.mongodb.com/presentations/mongodb-geoserver)所示。我希望这对你也有帮助，[http://boundlessgeo.com/2014/06/mapping-worldcup-opengeo-suite-mongodb/](http://boundlessgeo.com/2014/06/mapping-worldcup-opengeo-suite-mongodb/)。它解释了如何配置 GeoServer + MongoDB 之间的连接以及如何使用 geotweets 作为源信息添加层。

# c# - 如何模拟 ReadOnlyCollection 使用最小起订量的财产

> ID：10199544
> 
> 赞同：1
> 
> 时间：2012-04-17T21:36:27.063
> 
> 标签：c#, moq

我试图模拟这个 ReadOnlyCollection 属性：

```
private readonly IList<MyClass> myList = new List<MyClass>();
public virtual ReadOnlyCollection<MyClass> MyList
{
   get
   {
       return new ReadOnlyCollectionBuilder<MyClass>(this.myList).ToReadOnlyCollection();
   }
} 
```

使用这个模拟（如此处所示[）](https://stackoverflow.com/questions/1454186/mocking-virtual-readonly-properties-with-moq)：

```
IList<MyClass> mockList = GetElements();
mockObj.SetupGet<IEnumerable<MyClass>>(o => o.myList).Returns(mockList); 
```

但是在运行时我得到一个 InvalidCastException：

```
Unable to cast object of type 'System.Collections.Generic.List`1[MyClass]' to
type 'System.Collections.ObjectModel.ReadOnlyCollection`1[MyClass]'. 
```

我究竟做错了什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-17T21:52:38.687

假设你的代码真的看起来像（否则它不会编译）：

```
// Arrange
IList<MyClass> stakeHoldersList= GetElements();
mockObj.SetupGet<IEnumerable<MyClass>>(o => o.MyList).Returns(stakeHoldersList);
// Act on SUT which uses mockObj 
```

您有 MyList 类型的属性，`ReadOnlyCollection<MyClass>`但您正在尝试返回`IEnumerable<MyClass>`。这就是为什么你会得到那个错误。所以，改变：

```
ReadOnlyCollection<MyClass> stakeHoldersList = new ReadOnlyCollection<MyClass>(GetElements());
mockObj.SetupGet<ReadOnlyCollection<MyClass>>(o => o.MyList).Returns(stakeHoldersList); 
```

为避免此类运行时错误，请不要指定 SetupGet 方法的类型。在这种情况下，返回值类型将从属性类型推断出来，您将立即得到错误（如果返回值类型与属性类型不匹配，代码将无法编译）：

```
mockObj.SetupGet(o => o.MyList).Returns(stakeHoldersList); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-17T21:47:38.970

您不能模拟私有只读属性`myList`，您可以做的是覆盖公共属性`MyList`，因为它被标记为虚拟。为此，您需要更新此代码：

```
IList<MyClass> mockList = GetElements();
mockObj.SetupGet<IEnumerable<MyClass>>(o => o.myList).Returns(mockList); 
```

对此：

```
var mockList = new ReadOnlyCollection<MyClass>(GetElements());
mockObj.Setup(o => o.MyList).Returns(mockList); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2019-06-17T09:41:42.747

有点晚了，但我认为这可以少一点代码。

```
mockObj.SetupGet(o => o.MyList).Returns(GetElements().AsReadOnly); 
```

# php - Twitter OAUTh 和 PHP

> ID：10199545
> 
> 赞同：2
> 
> 时间：2012-04-17T21:36:27.440
> 
> 标签：php, twitter, oauth

我正在尝试从 Twitter API 获取请求令牌，以便使用他的 Twitter 帐户登录用户，并且我不断收到“无法验证 oauth 签名和令牌”的 401 响应。我正在通过 PHP 执行此操作。我寻找了类似的问题，但显然我是唯一一个疯狂到没有图书馆从头开始做的人。

在他们的 API 文档中，他们谈论“百分比编码”在授权标头中发送的值，我正在使用 urlencode() 函数这样做，不确定它是否正确。

为了计算我使用 hash_hmac('SHA1', $signParameters, $hashKey) 的签名，也不确定它是否适合使用。

这是通过 cURL 生成的请求：

```
POST /oauth/request_token HTTP/1.1
Host: api.twitter.com
Accept: */*
Authorization: OAuth oauth_callback="http%3A%2F%2Fwww.soytumascota.com%2Ftwitter%2Fuser.php", oauth_consumer_key="MY_APP_KEY", oauth_nonce="0dde25902bde5f3b280f58ea642047cf", oauth_signature_method="HMAC_SHA1", oauth_timestamp="1334697987", oauth_version="1.0", oauth_signature="8313277875f20cd8a8631966a2ba273a5d13aeda"
Content-Length: 0
Content-Type: application/x-www-form-urlencoded
Expect: 100-continue 
```

我非常感谢您能提供的任何帮助，谢谢。

编辑：这是我到目前为止编写的代码。

```
<?php
DEFINE( 'CONSUMER_KEY', 'MY_APP_KEY' );
DEFINE( 'CONSUMER_SECRET', 'MY_APP_SECRET' );

$url = 'https://api.twitter.com/oauth/request_token';

//setting OAuth parameters
$Oauth = Array();
$Oauth['oauth_callback'] = 'http://www.soytumascota.com/twitter/user.php';
$Oauth['oauth_consumer_key'] = CONSUMER_KEY;
$Oauth['oauth_nonce'] = md5( $Oauth['oauth_callback'] . CONSUMER_KEY . time() );
$Oauth['oauth_signature_method'] = 'HMAC_SHA1';
$Oauth['oauth_timestamp'] = (string) time();
$Oauth['oauth_version'] = '1.0';

//signature and authorization header are calculated inside functions
$Oauth['oauth_signature'] = calculateSignature( 'POST', $url, $Oauth );
$authorization = getAuthorizationHeader( $Oauth ); 
ksort( $Oauth );

//setting and sending request using cURL
$curl_session = curl_init( $url );
curl_setopt( $curl_session, CURLOPT_RETURNTRANSFER, true );
curl_setopt( $curl_session, CURLOPT_POST, true );
curl_setopt( $curl_session, CURLINFO_HEADER_OUT, true );
curl_setopt( $curl_session, CURLOPT_HTTPHEADER, Array( 'Authorization: ' . $authorization ) );

$result = curl_exec( $curl_session );

function getAuthorizationHeader( $parameters )
{
    $authorization = 'OAuth ';
    $j = count( $parameters );
    foreach( $parameters as $key => $val )
    {
        $authorization .= $key . '="' . urlencode( $val ) . '"';

        if( $j-- > 1 )
        {
            $authorization .= ', ';
        }   
    }

    return $authorization;
}

function calculateSignature( $method, $url, $parameters, $accessToken = '' )
{   
    foreach( $parameters as $key => $val )
    {
        $foo = urlencode( $key );
        unset( $parameters[$key] );

        $parameters[$foo] = urlencode( $val );      
    }

    ksort( $parameters );   

    $signBase = '';
    $j = count( $parameters );
    foreach( $parameters as $key => $val )
    {
        $signBase .= "{$key}={$val}";

        if( $j-- > 1 )
        {
            $signBase .= '&';
        }
    }

    $signBase = strtoupper( $method ) . '&' . urlencode( $url ) . '&' . urlencode( $signBase );

    $signKey = urlencode( CONSUMER_SECRET ) . '&' . urlencode( $accessToken );

    $signature = hash_hmac( 'SHA1', $signParameters, $hashKey);

    return $signature;
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-05-01T22:48:22.527

首先，'oauth_signature_method' 必须是 'HMAC-SHA1' （否则将不起作用）。

关于“百分比编码”，他们在他们的 API 文档[https://dev.twitter.com/docs/auth/percent-encoding-parameters](https://dev.twitter.com/docs/auth/percent-encoding-parameters)中说，他们需要根据 RFC 3986 对字符串进行编码，因此您应该`rawurlencode`使用`urlencode`.

要计算他们在这里说的签名[https://dev.twitter.com/docs/auth/creating-signature](https://dev.twitter.com/docs/auth/creating-signature)你必须使用 HMAC-SHA1 散列算法并将原始输出转换为 base64，例如：

```
$signature = base64_encode(hash_hmac( 'SHA1', $signBase, $signKey, true)); 
```

最后你可能需要添加

```
//no content
curl_setopt( $curl_session, CURLOPT_POSTFIELDS, '');
//no verify certs
curl_setopt( $curl_session, CURLOPT_SSL_VERIFYPEER, FALSE); 
```

到 curl 选项以使请求正常工作。

# sql - SQL查询根据parentid表B获取记录表A

> ID：10199546
> 
> 赞同：0
> 
> 时间：2012-04-17T21:36:28.327
> 
> 标签：sql, sql-server

[已解决：感谢 bluefeet 和 Brian，我必须构建这个工作查询（结果我还需要第四个表/视图）]"

```
SELECT        A.SalesLineID, A.ArticleResultID, B.ID, C.ID, D.Value
FROM            VIEWA AS A 
                INNER JOIN TABLEB AS B ON A.ArticleResultID = B.ArticleResultID 
                AND B.Name = N'Collect' AND DAPR.Value = 1 
                INNER JOIN TABLEC AS C ON B.ArticleResultID = C.ID 
                AND C.Name='Assemble' 
                AND C.Value = 1 
                INNER JOIN TABLED AS D ON D.ArticleResultID = C.ParentId 
                AND D.Name = 'IndexY'
WHERE        (A.SalesID = @SalesID) 
```

[更新：我犯了一个错误，假设 IndexY/Color 和 ProdId 字段表 A 是某种参数/属性表，只有 5 列 ID - NAME - VALUE - ARTICLERESULTID - PRODID。IndexY 是 Name 字段的值..]

我无法构建正确的 sql 查询来完成这个技巧：

我有以下 2 个表：

```
Table A 
ID Name         Value   ArticleResultID     ProdID    Color
1  Operation    Collect             110         10    BLACK
2  IndexY            10             110         10    - 
3  Operation    Collect             101         11    WHITE

Table B
ID  ParentID    Name        Value       
101 110     Assemble        1       
101 100     Assemble        0 
```

脚步：

```
Find record in A with Name = Operation and Value = Collect and ProdId = 11 AS ORG_A
Find record in B With B.ID = ORG_A.ArticleResultId AND B.NAME = 'Assemble'AND B.VALUE = 1 AS B
Find record in A With A.ArticleResultID = B.ParentID as NEW_A 
```

在上述场景中 ORG_A.ArticleResultID = 11 --> B.ParentID = 110 --> NEW_A.ARTICLERESULTID = 110 --> (IndexY - Value - 10)

非常感谢有人能告诉我如何构建这个查询..

最好的祝福，

迈克 D

[旧描述：]

我无法构建正确的 sql 查询来完成这个技巧：

我有以下 2 个表：

```
Table A 
Name        Value   ArticleResultID      IndexY      Color  ProdID
Operation   Collect             110         10           -       0
Operation   Collect             101         _        Black     100  

Table B
ID  ParentID    Name        Value   Dx      Dy
101 110     Assemble        1       1000    500 
101 100     Assemble        0       400     300 
```

我想从 A 中获取所有记录，其中 NAME 等于 'operation'，VALUE 等于 'Collect' 和 PRODID = '100' 但我还想要（这是我的问题）表 A 中记录的 IndexY 值和表 B 中的 PARENTID加入 TABLE B.ID = A.ArticleResultID AND Name = 'Assemble' 和 VALUE = '1'

在上面的场景中，ParentID 110 给了我表 A 中的记录，ArticleResultID 110 和 IndexY (10)。

非常感谢有人能告诉我如何构建这个查询..

最好的祝福，

迈克 D

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-17T22:12:01.993

这对你有用吗？

```
SELECT a.*,c.IndexY
  FROM [TableA] a
  JOIN [TableB] b ON a.ArticleResultId = b.id
                 AND b.Name ='Assemble'
                 AND b.Value = 1
  JOIN [TableA] c ON b.ParentId = c.ArticleResultID
  WHERE a.name = 'Operation'
    AND a.Value = 'Collect'
    AND a.ProdId = 100 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-17T22:20:05.540

因为你的要求不是最清楚的。这个怎么样：

```
SELECT a1.*, a2.indexy as additionalIndexY
FROM ta a1
INNER JOIN tb b
    ON a1.articleresultid = b.id
INNER JOIN ta a2
    ON b.parentid = a2.articleresultid
WHERE a1.name = 'Operation'
    AND a1.prodid = 100
    AND b.name = 'Assemble'
    AND b.value = 1 
```

这是一个带有工作版本的[sqlfiddle](http://sqlfiddle.com/#!3/ef643/5)

如果您只想要 110 articleresultid 的记录，那么：

```
SELECT a2.*
FROM ta a1
INNER JOIN tb b
    ON a1.articleresultid = b.id
INNER JOIN join ta a2
    ON b.parentid = a2.articleresultid
WHERE a1.name = 'Operation'
    AND a1.prodid = 100
    AND b.name = 'Assemble'
    AND b.value = 1 
```

请参阅第二个示例的[sqlfiddle](http://sqlfiddle.com/#!3/ef643/6)

# r - 绘制由 R 中的方程给出的曲线

> ID：10199547
> 
> 赞同：11
> 
> 时间：2012-04-17T21:36:30.167
> 
> 标签：r, graphics

在 R 中，有没有办法绘制方程给出的二维曲线？例如，如何绘制方程 x^2 - 3*y^2 + 2*x*y - 20 = 0 给出的双曲线？

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2012-04-17T22:41:51.947

您可以使用`contour`绘制双曲线的两个分支。

```
f <- function(x,y) x^2 - 3*y^2 + 2*x*y - 20
x <- y <- seq(-10,10,length=100)
z <- outer(x,y,f)
contour(
  x=x, y=x, z=z, 
  levels=0, las=1, drawlabels=FALSE, lwd=3
) 
```

![在此处输入图像描述](../Images/e3a4bb5216d7c49eb55656b0fec78c7c.png)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2016-12-15T06:58:54.233

仅作记录 - ggplot 版本

```
library(ggplot2)
library(dplyr)
f <- function(x,y) x^2 - 3*y^2 + 2*x*y - 20
seq(-10,+10,length=100) %>%
    expand.grid(x=.,y=.) %>%
    mutate(z=f(x,y)) %>%
    ggplot +
    aes(x=x,y=y,z=z) +
    stat_contour(breaks=0) 
```

[![在此处输入图像描述](../Images/1964659ec706a6f2e1eca355019c8f84.png)](https://i.stack.imgur.com/ejVii.png)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-04-26T09:25:41.827

也许解决方案可以将方程转换为公式并使用 curve() 绘制图。

`curve(sqrt(4/9*x^2-20/3) + x/3,-20,20)`

# google-chrome - 从 safari (chrome) 网络检查器复制和粘贴代码

> ID：10199548
> 
> 赞同：7
> 
> 时间：2012-04-17T21:36:30.707
> 
> 标签：google-chrome, safari, web-inspector

我想从网络检查器复制一些 html 代码，但一次只能复制一行。有没有办法选择一个元素块或所有元素？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-17T14:36:47.653

如果您右键单击 Web Inspector 中的任何元素，然后在出现的弹出菜单上单击“复制为 HTML”，您就可以将该元素（以及所有包含的元素）的 html 粘贴到您的编辑器中。`<html>`您可以通过对元素执行此操作来获取整个文档。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-16T02:17:27.020

在控制台上，尝试 document.documentElement.outerHTML。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-18T00:03:46.707

您可以从 Chrome 的网络部分查看 html 响应

# qt - QT 创建将文本添加到文本编辑框的按钮

> ID：10199551
> 
> 赞同：3
> 
> 时间：2012-04-17T21:36:56.533
> 
> 标签：qt

QT 的新手只是玩弄它，看看我是否会喜欢使用它，如果是的话，我想继续深入学习这个程序。

在按钮概念上有点挣扎。我创建了一个按钮和一个文本编辑区域。我想在按下按钮时将一串文本添加到文本编辑窗口中。

我似乎在 google 或 QT wiki 上找不到任何东西来实现这一点。有人可以指出我的方向，这样我至少可以开始使用这个很棒的工具。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-17T21:40:21.493

在 Qt 中，信号和槽被用于在对象之间进行通信。[这](http://qt-project.org/doc/qt-5.0/signalsandslots.html)应该为您提供必要的信息以帮助您入门。

> 当特定事件发生时会发出信号。Qt 的小部件有许多预定义的信号，但我们总是可以子类化小部件以向它们添加我们自己的信号。插槽是响应特定信号而调用的函数。Qt 的小部件有许多预定义的插槽，但通常的做法是子类化小部件并添加自己的插槽，以便您可以处理您感兴趣的信号。

因此，在您的特定情况下，您需要将 QPushButton`clicked()`信号与执行所需操作的自定义插槽连接（将文本添加到 textarea）：

```
 QPushButton * btn = new QPushButton("Button", this);
 connect(btn, SIGNAL(clicked()), this, SLOT(onBtnClicked())); 
```

我们需要在标题中声明我们的插槽：

```
 private slots:
     void onBtnClicked(); 
```

并定义它：

```
 void MySpecialWidget::onClick() 
 {
     // Do what is to be done
 } 
```

如果您已正确完成所有操作，它应该可以工作......否则请查看控制台以查看是否有任何消息如下所示：

```
Object::connect: No such slot MySpecialWidget::onClick() in ... 
```

或者

```
Object::connect: No such signal .... 
```

他们应该给你一个关于正在发生的事情的提示。

最后，我建议看一下广泛的[Qt 示例](http://qt-project.org/doc/qt-4.8/all-examples.html)集。

# hibernate - JPA + Hibernate 的异常处理

> ID：10199552
> 
> 赞同：5
> 
> 时间：2012-04-17T21:37:05.817
> 
> 标签：hibernate, jpa-2.0

我使用 JPA 和 Hibernate 作为容器管理事务的提供者（JBoss AS 6.1.0.Final）。

我正在尝试实现一些细粒度的异常处理，因为我的应用程序上有一个特定的异常层次结构，因此我可以定义在每种情况下要做什么。因此，我已经研究了几个小时，我发现文档含糊不清，示例有些原始，因为“为了清楚起见”总是忽略异常处理，或者是处理异常 e 的简单 try-catch 块。

例如，使用以下代码：

```
public void deleteCompany(ICompany company) throws MyException1, MyException2 {
    if(entityManager != null){
        if(company !=null) {
            try {
                ICompany companyReference= entityManager.getReference(Company.class, company.getId());
                entityManager.remove(managedCompany);
                entityManager.flush();
            } catch(EntityNotFoundException companyDoesNotExist) {
                //Wrap & Throw
            }
        } else {
        throw new MyException1("An error occurred while attempting to save a null instance of a company");
        }
    } else {
        throw new MyException2("The entity manager instance is null");
    }   
} 
```

catch 块是空白的，因为那是我被卡住的地方......我不知道我应该捕捉哪个异常来提醒系统用户试图删除不存在的记录。

我的具体问题是：我可以在那个 catch 块上捕获 Hibernate 异常还是必须捕获 JPA 异常？我发现一些消息来源声称 JPA 包装了提供程序的异常，但这对我来说听起来很奇怪。我还发现调用flush() 方法可以捕获数据库访问和操作异常，因为事务由容器管理，因此在调用deleteCompany 后提交会在进一步的步骤中进行。

谢谢你。

**编辑：**我用我自己用@ApplicationException(rollback=true) 注释的异常来包装我捕获的异常，所以我可以再次抛出它们并更清楚地处理它们。

**编辑 2：**我已经更新了我的代码。如果公司不在数据库中，则删除前的合并会保留公司，从而导致每次删除都成功。现在正在抛出异常，我正在测试它在不同情况下的行为，以按照 Perception 的建议捕获 JPA 异常。

**编辑 3：**现在它可以工作了！事实证明，由于那个合并调用，错误部分出现在我的代码中。首先获取引用并在之后尝试删除就可以了，这样我就能够捕获一个 EntityNotFoundException，包装它并再次抛出它。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-17T21:53:29.723

您绝对不会捕获供应商异常，因为它们会被纳入 JPA 异常。请注意，您可能会在有问题的地方获得几种异常类型之一：

*   `IllegalArgumentException`- 对于分离或非实体对象
*   `IllegalStateException`- 实体管理器已关闭
*   `PersistenceException`- 至少，它的一些子类。您可以出于多种原因得到这个，如果没有关联的事务并且调用需要一个，如果数据库约束拒绝操作，如果事务花费太长时间等等等等。

您真的不应该在如此低的级别捕获这些异常，除非您计划将它们重新包装在某种自定义应用程序异常中。如果您决定采用该路线，请确保包装原始异常，以免堆栈跟踪丢失。

值得注意的是，JPA Entity Manager 生成的所有异常都是运行时异常。

# html - 使用 HTML 标签反序列化 XML

> ID：10199561
> 
> 赞同：3
> 
> 时间：2012-04-17T21:37:27.767
> 
> 标签：html, deserialization, xml-deserialization

我想知道一种解决方案来反序列化 XML 元素中的 HTML 值。下面给出了我的示例 XML，

```
<root>
<Element>
<P>This <i>is </i> a sample <B>XML Tag</B><P>
</Element>
<root> 
```

我要这个 ”

这*是*一个示例**XML 标记**

" 作为字符串。请建议我解决方案。我无法在 XML 文件中添加 cdata。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-17T21:45:30.767

您需要使用转义字符：

```
"   &quot;
'   &apos;
<   &lt;
>   &gt;
&   &amp; 
```

完整参考：

[http://en.wikipedia.org/wiki/List_of_XML_and_HTML_character_entity_references](http://en.wikipedia.org/wiki/List_of_XML_and_HTML_character_entity_references)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-06-19T12:05:53.020

您可以使用 HSharp 反序列化 HTML 和 XML。
HSharp 是一个用于轻松快速地分析 HTML 等标记语言的库。安装：`Install-Package Obisoft.HSharp`
在 GitHub 中查看：在[此处输入链接描述](https://github.com/Obisoft2017/HSharp)

你想要的代码应该是这样的：

```
 var DeResult = HtmlConvert.DeserializeHtml("<root>...</root>");//fill it
        Console.WriteLine(DeResult["root"]["element"]["p"].Son); 
```

# iphone - 为什么 CCAnimation 不使用 CCSpriteBatchNode 来打印它的图像？

> ID：10199562
> 
> 赞同：0
> 
> 时间：2012-04-17T21:37:35.587
> 
> 标签：iphone, cocos2d-iphone, ccsprite

为什么`CCSpriteBatchNode`不明确使用 with `CCAnimation`？相反，我们使用以下内容：（而不是将每个图像添加到 batchNode 并让 batchNode 打印这些图像，代码仅使用`spriteFrameByName`）：

```
CCSpriteBatchNode *chapter2SpriteBatchNode = [CCSpriteBatchNode batchNodeWithFile:@"scene1atlas.png"];
CCSprite *vikingSprite = [CCSprite spriteWithSpriteFrameName:@"sv_anim_1.png"];
[chapter2SpriteBatchNode addChild:vikingSprite];

// Animation example with a CCSpriteBatchNode
CCAnimation *exampleAnim = [CCAnimation animation];
    [exampleAnim addFrame:
    [[CCSpriteFrameCache sharedSpriteFrameCache] 
    spriteFrameByName:@"sv_anim_2.png"]]; 
```

感谢您的回答

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-17T22:28:05.987

batchNode 只是一个纹理绘制工件......不知道纹理包含哪些帧，也不知道它是否在单个纹理中嵌入了多个“逻辑”文件。您必须创建该关联，通常通过将 spriteFrame 添加到 spriteFrameCache，每个 spriteFrame 提供有关 batchNode 的“片段”的元数据。这是我的一个游戏中的一个例子：

```
-(void) setupIdleAnimation{

    [self setupAnimations];
    NSString* animationName = @"Idle";
    NSString* framesFileName = [self getPlistFileNameForAction:animationName];
    CCSpriteBatchNode *bn = [CCSpriteBatchNode batchNodeWithFile:[self getTextureFileNameForAction:animationName]];
    [[CCSpriteFrameCache sharedSpriteFrameCache] addSpriteFramesWithFile:framesFileName texture:bn.texture];

// create array of frames for the animation

    self.idleBatchNode=bn;

    NSMutableArray *animFrames = [NSMutableArray array];
    for(NSUInteger i = 1; i <= 8; ++i) {

        NSString *sfn = [self getFrameNameForAnimation:animationName
                                    andFrameNumber:i];

        CCSpriteFrame *sf = [[CCSpriteFrameCache sharedSpriteFrameCache] spriteFrameByName:sfn];
        if(sf) {
            [animFrames insertObject:sf atIndex:i-1];
        } else {
            CCLOGERROR(@"%@<setupIdleAnimation> : *** Sprite frame named [%@] not found in cache, bailing out.",self.class,sfn);
            return;
        }
    }

    CCAnimation *anim=[CCAnimation animationWithFrames:walkAnimFrames delay:ANIM_FRAME_DELAY];
    [animFrames removeAllObjects];
    anim.name=animationName;

    self.idleAction = [CCRepeatForever 
                   actionWithAction:[CCAnimate actionWithAnimation:anim 
                                              restoreOriginalFrame:NO]] ;

    self.idleSprite = [CCSprite spriteWithSpriteFrameName:[self getFrameNameForAnimation:animationName
                                                                      andFrameNumber:1]];  
    self.idleSprite.visible=NO;
    [self.idleBatchNode addChild:self.idleSprite];
} 
```

所以我在 .plist 中准备了描述每个帧在纹理中的位置的数据，并将这些定义添加到帧缓存中。每个说的 batchNode 是一个可以优化渲染性能的容器。在上面的例子中，它非常适合为 16 个字符类嵌入空闲精灵的纹理，这些字符类通常同时处于视图和空闲状态。

[您可以在本教程](http://www.raywenderlich.com/1271/how-to-use-animations-and-sprite-sheets-in-cocos2d)中找到很好的介绍。

# java - 如何从 Java 反射性地获取 Scala 对象上的字段？

> ID：10199564
> 
> 赞同：3
> 
> 时间：2012-04-17T21:37:45.300
> 
> 标签：java, scala, reflection, scala-java-interop

我有以下对象：

```
 package com.rock

 object Asteriod {
    val orbitDiam = 334322.3
    val radius = 3132.3
    val length = 323332.3
    val elliptical = false
 } 
```

如何使用 Java 反射来获取每个变量的值？我可以从对象中获取方法，但似乎无法弄清楚如何获取字段。这可能吗？

```
 Class<?> clazz = Class.forName("com.rock.Asteriod$");
  Field field = clazz.getField("MODULE$");
   // not sure what to do to get each of the variables????? 
```

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-17T22:06:29.437

这有效：

```
Class<?> clazz = Class.forName("com.rock.Asteriod$");
Object asteroid = clazz.getField("MODULE$").get(null);

Field orbitDiamField = clazz.getDeclaredField("orbitDiam");
orbitDiamField.setAccessible(true);
double orbitDiam = orbitDiamField.getDouble(asteroid);

System.out.println(orbitDiam); 
```

并打印结果`334322.3`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-17T21:43:18.320

开始`clazz.getDeclaredFields()`- 这为您提供了类中声明的**所有**字段，而不仅仅是公共字段。您很可能会发现它们是私有的并且实际上具有合成的吸气剂。所以也要检查所有的方法`getDeclaredMethods`。打印所有内容以查看发生了什么。如果它不是太麻烦，发回调查结果，对其他人来说可能是一个有趣的读物。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-17T22:26:32.077

我不确定您要实现什么，但是如果您只想要不需要反思的价值观：

```
public class Test {
    public static void main(String[] s) {
        System.out.println(com.rock.Asteriod$.MODULE$.orbitDiam());
    }
} 
```

# php - 为什么 SQLSTATE[HY000]: 一般错误？

> ID：10199571
> 
> 赞同：1
> 
> 时间：2012-04-17T21:38:20.453
> 
> 标签：php, mysql, database

这是一个代码，用于注册一个小组的负责人，然后是他的合作伙伴。

```
<?
session_start();
require_once('db.php');
$db = new DB();
$db->newHead($_POST['fname'], $_POST['lname'], $_POST['school'], $_POST['day'], $_POST['month'], $_POST['year'], $_POST['email']);
$hId = $db->getId($_POST['email'], 1);
if ($_POST['pnum'] === 1)
{
    $db->newPartner($hId, $_POST['fname1'], $_POST['lname1'], $_POST['day1'], $_POST['month1'], $POST['year1'], $_POST['email1']);
    $pId = getId($_POST['email1'], 0);
    $db->setHeadId($hId, $pId, 1);
}
if ($_POST['pnum'] === 2)
{
    $db->newPartner($hId, $_POST['fname1'], $_POST['lname1'], $_POST['day1'], $_POST['month1'], $POST['year1'], $_POST['email1']);
    $p1Id = getId($_POST['email1'], 0);
    $db->setHeadId($hId, $p1Id, 1);

    $db->newPartner($hId, $_POST['fname2'], $_POST['lname2'], $_POST['day2'], $_POST['month2'], $POST['year2'], $_POST['email2']);
    $p2Id = getId($_POST['email2'], 0);
    $db->setHeadId($hId, $p2Id, 2);
}
header("Location:Register.php");
?> 
```

这是 db.php 的一部分：

```
 public function getId($email, $type)
{
    if ($type)
        $query = "SELECT * FROM t_head where h_email = '$email';";
    else
        $query = "SELECT * FROM t_partner where p_email = '$email';";
    return $this->query($query);
}

public function newPartner($hId, $fname, $lname, $day, $month, $year, $email)
{
    $query = "INSERT INTO t_partner (p_headid, p_fname, p_lname, p_day, p_month, p_year, p_email)
    VALUES ('$hId', '$fname', '$lname', '$day', '$month', '$year', '$email');";
    return $this->query($query);
}

public function newHead($fname, $lname, $hschool, $day, $month, $year, $email)
{
    $query = "INSERT INTO t_head (h_fname, h_lname, h_school, h_day, h_month, h_year, h_email)
    VALUES('$fname', '$lname', '$hschool', '$day', '$month', '$year', '$email');";
    return $this->query($query);
}

    public function setHeadId($hId, $pId, $num)
    {
        if ($num === 1)
            $query = "UPDATE t_head SET h_p1 = '$pId' WHERE h_id = '$hId';";
        else
            $query = "UPDATE t_head SET h_p2 = '$pId' WHERE h_id = '$hId';";
        $this->execute($query);
    } 
```

有什么问题？DB 是与 PDO 一起使用的类。（我不知道这是什么！但我总是复制它，然后我在它的底部编写函数，它总是正常工作。）但是知道这个错误是什么意思吗？

*   对不起，如果我粘贴了所有代码！我不知道`SQLSTATE[HY000]: General error`与哪个部分有关，因此我无法为您粘贴任何特定的部分/功能。

*   我的站点被复制到另一台服务器，并且 DNS 在 3 小时前出于某种目的而更改。如果这个细节可以帮助你...

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2012-04-17T21:41:19.410

几周前我也遇到过类似的事情。我修复了它改变了 php.ini

我变了

```
;extension=php_pdo_mysql_mysqlnd.dll
extension=php_pdo_mysql_libmysql.dll 
```

到

```
extension=php_pdo_mysql_mysqlnd.dll
;extension=php_pdo_mysql_libmysql.dll 
```

基本上你改变了 mysql 驱动程序 php 使用。我使用了 xampplite 1.7

# mysql - MySQL JOIN——复杂的选择语句

> ID：10199574
> 
> 赞同：0
> 
> 时间：2012-04-17T21:38:34.793
> 
> 标签：mysql, join, left-join

我有 3 张桌子。一个用于用户，一个用于帖子，以及一个连接其他两个表的连接表。

这是连接表中的一些示例数据。

```
| id | user_id | post_id | timestamp |
|----|---------|---------|-----------|
| 1  |    1    |    1    | 4-17-2012 |
| 2  |    1    |    2    | 4-16-2012 |
| 4  |    2    |    2    | 4-17-2012 |
| 5  |    3    |    1    | 4-16-2012 |
|____|_________|_________|___________| 
```

我想编写一个 SELECT 查询，它将执行以下操作：

1) 选择时间戳为 4-17-2012 的用户的所有帖子

和

2) 如果该用户的联接表中没有帖子条目，请同时选择这些帖子。

所以... 对于 user_id = 1，将选择帖子 1，但不会选择帖子 2，因为帖子 2 不是 2012 年 4 月 17 日 对于 user_id = 2，将选择两个帖子，帖子 1 因为没有 user_id 条目= 2 and post_id = 1, and post 2 因为它是 4-17-2012 对于 user_id = 3，不会返回 post 1，但会返回 post 2，因为没有 user_id = 3 和 post_id = 2 的条目。

这是我一直在尝试的示例：

SELECT * FROM posts AS p LEFT JOIN posts_users as pu ON (p.post_id = pu.post_id) WHERE ((pu.user_id = $user_id AND pu.timestamp = 4-17-2012) OR (pu.post_id IS NULL)

如果帖子中有一个 post_id = 3 行，那么它对于所有 posts_users 列都将具有 NULL，因为 LEFT JOIN 有助于满足＃2。但是，如果有任何人的 post_id = 3 的 post_users 条目，那么就不会有 NULL。MySQL 中有没有办法让我们拥有#2 的逻辑？

我在一个已经用 PHP 编写的框架中完成了这一切，并且以某种方式使我很难处理使用 PHP 过滤返回的结果。相信我。有没有办法让我使用 SQL 语句来完成此操作，或者在获得其他查询的结果后，我是否必须尝试在 PHP 中解决？

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-17T21:45:19.273

这行得通吗？

select * from user left outer join posts_users on user.id = posts_users.user_id left outer join posts on posts.id = posts_users.post_id where timestamp = '4-17-2012' or timestamp = NULL

# ssis - 为 Sql Server 存储包按包名称执行包任务

> ID：10199576
> 
> 赞同：0
> 
> 时间：2012-04-17T21:38:46.620
> 
> 标签：ssis

我已经看到人们通过变量更改文件系统连接信息，在文件系统上按名称执行不同的包。我需要在 Sql Server 上执行不同的包。有没有人看到这样做的方法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-17T21:49:52.650

我最终将包添加到 sql 代理，然后执行 bia msdb.dbo.sp_start_job [代理作业名称]

# c# - 正确使用与 Timer 一起使用（或与使用相关的任何对象）

> ID：10199577
> 
> 赞同：0
> 
> 时间：2012-04-17T21:38:54.077
> 
> 标签：c#, garbage-collection

目前的代码结构如下：

```
System.Timers.Timer myTimer;

public void FirstMethod() {
  myTimer;= new System.Timers.Timer();
  myTimer.start();
  SecondMethod();
}

public void SecondMethod(){
  //several things happen here and then
  myTimer.stop();  
} 
```

有人建议我可以`using`用来正确地垃圾收集 Timer 对象。因此，我尝试将以下内容应用于我的代码（取自[此处](https://stackoverflow.com/questions/475763/is-it-necessary-to-dispose-system-timers-timer-if-you-use-one-in-your-applicatio)）：

```
using (SomeClass someClass = new SomeClass())
{  
someClass.DoSomething();  
} 
```

我假设以下将出错，因为`myTimer`不知道`SecondMethod()`？

```
public void FirstMethod() {
  using (System.Timers.Timer myTimer = new System.Timers.Timer())   
  { 
  myTimer.start();
  SecondMethod();
  }
}

public void SecondMethod(){
//several things happen here and then
myTimer.stop();  
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-17T21:41:39.287

在有意义的情况下，您可以将实现`IDisposable`接口的对象包装在一个块中。`using`在这种情况下，它不是因为对象必须在更高的范围内有效。请记住，`using`语句只是这个的简写（语法糖）：

```
var myDisposableObj = new Whatever();
try
{
    // use myDisposableObj.  If an exception is thrown
    // in here somewhere the call to Dispose() still occurs.
}
finally
{
    myDisposableObj.Dispose();
} 
```

在您的情况下，您需要确保`Dispose()`在完成对象后调用它（并且以一种考虑可能引发的异常的方式来阻止调用`Dispose()`发生）。你需要`Timer`坚持一段时间，所以一个`using`街区是不可能的。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-17T21:42:07.360

只有在块结束`using`后应该处置（=销毁）对象时才能使用。`using`计时器的持续时间通常比这更长（如您的示例中所示）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-17T21:40:56.587

`using`只能在实现的对象上使用`IDisposable`，它会在 using 块的末尾自动释放。如果您需要在其他任何地方使用该对象，则不能使用`using`.

在您的示例中，您的原始对象不仅不会在其他方法中被知道，而且会被删除。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-04-17T21:43:01.110

是的你是对的。您的代码是错误的，因为 myTimer 被声明为局部变量，并且它仅在*using*范围内可用。您应该将代码更改为某事。像这样

```
public void FirstMethod() {
  using (System.Timers.Timer myTimer = new System.Timers.Timer())   
  { 
  myTimer.start();
  SecondMethod(myTimer);
  }
}

public void SecondMethod(System.Timers.Timer theTimer){
    //several things happen here and then
    theTimer.stop();  
} 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-04-17T21:44:12.553

“使用模式”用于在实现对象不再在范围内时自动调用 Dispose。Dispose 用于清理所有非托管资源。Finalize 是垃圾收集器在“收集”对象之前调用的内容。

您可以尝试“强制”收集，但是 -

> “可以通过调用 Collect 来强制进行垃圾收集，但大多数情况下，应该避免这样做，因为它可能会产生性能问题。”

所以你需要 SecondMethod 来“访问” myTimer？

# java - Java Disruptor 模式和低延迟

> ID：10199582
> 
> 赞同：2
> 
> 时间：2012-04-17T21:39:16.177
> 
> 标签：java, performance, disruptor-pattern

Q1) 熟悉 Java Disruptor 模式的人是否知道他们对结果进行基准测试的消息的大小？我正在编写一个类似的系统（出于纯粹的兴趣），当我阅读他们的测试描述时，没有提到发送的消息大小？

[http://code.google.com/p/disruptor/wiki/PerformanceResults](http://code.google.com/p/disruptor/wiki/PerformanceResults)

Q2) 计算机之间的通信或进程间通信的破坏者是什么？我最初的印象是计算机到计算机，但他们的工作被标记为“线程间”消息传递库？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-04-18T12:13:32.100

Disruptor 不仅在同一台机器中，而且在单个进程中。当他们说“线程间”时，他们的意思是它用于在一个进程的线程之间发送消息。

消息大小实际上几乎无关紧要，因为消息不会被复制。消息在开始时都是固定的并被重复使用，所以它们有多大并不重要。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-18T12:09:08.347

虽然我不完全熟悉，只是探索它......

1）从 src 中的 perf 测试文件夹看起来他们正在使用[ValueEvent](http://code.google.com/p/disruptor/source/browse/trunk/code/src/perf/com/lmax/disruptor/support/ValueEvent.java)类，它只是持有很长的时间，还有一些其他 xxxEvent 类用于其他性能测试，它们稍微大一点，但我可以到目前为止，在环形缓冲区中只使用了一个 long。

2）我认为它是针对完全相同的机器线程间通信的。跨机器通信的延迟和不确定性会使其非常缓慢。（相对）然后项目还需要处理套接字通信，我在这个库中没有看到。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-06-13T12:26:02.653

1、Disruptor 不在乎消息的大小。但结果应该随着消息的大小线性下降（工作量增加，速度降低）

事实上，它并不关心信息。

库的**KEY**是缓冲区的**ID**。指针，位置，光标，指示器，都意味着相同。破坏者自称“**序列**”

一旦ID得到，整个世界就只属于你！:) 所以**只有一个作家**。真正的关键点。:)

2，不是C2C，也不是P2P :)。只是T2T。T 是线程。[peter-lawrey 有一个很棒的库 Java-Chronicle](https://github.com/peter-lawrey/Java-Chronicle)，可用于 P2P 案例。关于 java dzone 的新文章：[http ://java.dzone.com/articles/ultra-fast-reliable-messaging](http://java.dzone.com/articles/ultra-fast-reliable-messaging)

3、核心模式应该能够克隆到跨界用例。每件事都是ID。至于留言，请客制化。

4、还有一点很重要，就是**volatile 的缓存**。[github上的一个很好的例子](https://github.com/mjpt777/examples)

5、JDK8引入了一个新的注解**@Contended**，看起来很性感。[有关竞争的详细信息](http://mail.openjdk.java.net/pipermail/hotspot-dev/2012-November/007309.html)

# jquery - Juice UI 子控件

> ID：10199587
> 
> 赞同：0
> 
> 时间：2012-04-17T21:39:36.133
> 
> 标签：jquery, asp.net, vb.net, controls, juice-ui

我正在尝试使用 JuiceUI 中的容器控件。到目前为止，我已经玩过[手风琴](http://juiceui.com/controls/accordion)和[tabs](http://juiceui.com/controls/tabs)。它们是很棒的控件，但是我在更新这些控件的“内容”标签中的子控件时遇到了问题。

对于手风琴，有一个 PanelContent 标签，对于选项卡，有一个 TabContent 标签，但为了简单起见，我们将重点放在手风琴上。

在 PanelContent 内部，我有一个标签。我需要用一些信息更新这个标签。由于我无法直接访问控件，因此我尝试将 FindControl 中的控件投射到手风琴本身上。发生 NullReferenceException。我也在 AccordionPanel 上进行了同样的尝试，并且发生了同样的事情。所有这些都是有道理的。

在 VBF 上，一位成员指出该标签是 PanelContent 的子标签。它没有 ID 属性，因此我无法直接从服务器端代码访问。所以我尝试从 AccordionPanel 访问它。我可以，但没有 FindControl 方法。

因此，我不确定如何从该 PanelContent 标记中访问该标签。

不过，当我从 AccordionPanel 中调出 PanelContent 属性时，它有一个名为 InstantiateIn 的方法。它的智能感知描述如下：

> Public Sub InstantiateIn(container As System.Web.UI.Control) 由类实现时，定义子控件和模板所属的 System.Web.UI.Control 对象。这些子控件依次在内联模板中定义。

这*听起来*像我需要的。但我不太确定如何使用它。JuiceUI 文档似乎并不完整，因为我在那里找不到任何关于此的内容。

有什么想法吗，伙计们？

客户端：

```
<asp:UpdatePanel runat="server">
    <ContentTemplate>
        <table style="width: 99%;">
            <tr>
                <td class="style1">
                    <asp:Label ID="Label1" runat="server" Text="CSO:"></asp:Label>
                </td>
                <td>
                    <asp:TextBox ID="txtCSONumber" runat="server" CssClass="UpperCase" Width="115px"></asp:TextBox>
                </td>
            </tr>
            <tr>
                <td class="style1">
                    &nbsp;
                </td>
                <td>
                    <asp:Button ID="btnRetrieve" runat="server" Height="22px" Text="Retrieve" Width="120px" />
                </td>
            </tr>
            <tr>
                <td class="style1">
                </td>
                <td>
                    <asp:Label ID="lblMessage" runat="server" ForeColor="Red" Text="N/A" Visible="False"></asp:Label>
                </td>
            </tr>
        </table>
        <juice:Accordion ID="accSwrlHddRepl" runat="server">
            <juice:AccordionPanel runat="server" Title="HDD Information" ID="pnlHddInfo">
                <PanelContent>
                    <p>
                        <asp:Label ID="lblOriginalHDD" runat="server" Text="N/A"></asp:Label>
                    </p>
                </PanelContent>
            </juice:AccordionPanel>
        </juice:Accordion>
    </ContentTemplate>
</asp:UpdatePanel> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-12T16:19:20.337

据我了解，JuiceUI 有一个尚未发布的未决更新，它为您的场景实现了“FindControl”方法。代码已在其源存储库中，但尚未发布 nuget 更新。

您可以尝试一个名为[Brew](http://shellscape.org/#brew)的 fork ，它已经具有该功能并且是 JuiceUI 的近亲。

# javascript - jQuery Mobile : 动态表单创建显示原生控件与 jQuery Mobile 插件控件

> ID：10199588
> 
> 赞同：0
> 
> 时间：2012-04-17T21:39:36.697
> 
> 标签：javascript, html, jquery-mobile

我创建了这个测试页面来找出我遇到的问题。

第一次单击“表单”选项卡时，浏览器会显示 jQuery Mobile 复选框。然后，如果我单击“主页”选项卡并再次单击“表单”选项卡，它会显示浏览器的本机复选框！

我在这里做错了什么？如何解决？

提前致谢！

索引.html：

```
<!doctype html>
<html>
    <head>
        <title>Form Test</title>
        <link rel="stylesheet" href="http://code.jquery.com/mobile/1.1.0/jquery.mobile-1.1.0.min.css" />
        <script src="http://code.jquery.com/jquery-1.7.1.min.js"></script>
        <script src="http://code.jquery.com/mobile/1.0.1/jquery.mobile-1.0.1.min.js"></script>
        <script>
            var value1;
            var value2;

            // remap jQuery to $
            (function($) {
            })(window.jQuery);

            /* trigger when page is ready */
            $(document).ready(function() {
                initialize();
            });
            /**
             * Initialize the page.
             *
             */
            function initialize() {
                // get server parameters befor making ajax call
                getFormValues();

                // add click handler to the application navigation menu options
                $("nav li").live('click', function(e) {
                });
            }

            /**
             * Gets server parameters from the application's configuration file.
             *
             */
            function getFormValues() {
                // get the server URL from external XML file
                $.ajax({
                    type : "GET",
                    url : "assets/config/formValues.xml",
                    cache : false,
                    async : false,
                    timeout : 5000,
                    dataType : "xml",
                    success : function(xml) {
                        $(xml).each(function() {
                            value1 = $(this).find('value1').text();
                            value2 = $(this).find('value2').text();
                        });
                    }
                });
            }

            // Listen for any attempts to call changePage()
            $(document).bind("pagebeforechange", function(e, data) {
                // We only want to handle changePage() calls where the caller is
                // asking us to load a page by URL.
                if( typeof data.toPage === "string") {
                    // We are being asked to load a page by URL, but we only
                    // want to handle URLs that request the data for a specific
                    // category.
                    var u = $.mobile.path.parseUrl(data.toPage);
                    if(u.hash.search(/^#formSection/) !== -1) {
                        currentContentSection = "formSection";
                        // We're being asked to display the items for a specific category.
                        // Call our internal method that builds the content for the category
                        // on the fly based on our in-memory category data structure.
                        displayValueFilters();

                        // Make sure to tell changePage() we've handled this call so it doesn't
                        // have to do anything.
                        e.preventDefault();
                    }
                }
            });
            /**
             * Sets up and displays values.
             *
             */
            function displayValueFilters() {
                var pageSelector = "#formSection";

                // Get the page we are going to dump our content into
                var $page = $(pageSelector);

                // get the div that's expected to have the search fields
                var $searchFields = $page.children(":jqmData(role=sclRole)")
                // Get the content area element for the page.
                var $content = $page.children(":jqmData(role=content)");

                // The markup we are going to inject into the content area of the page.
                var markup = "";
                markup += "<label for='value1'>" + value1 + "</label>";
                markup += "<input type='checkbox' name='value1' id='value1' />";
                markup += "<label for='value2'>" + value2 + "</label>";
                markup += "<input type='checkbox' name='value2' id='value2' />";

                $content.empty();
                $(markup).appendTo($content).trigger("create");

                // Pages are lazily enhanced. We call page() on the page
                // element to make sure it is always enhanced before we
                // attempt to enhance the listview markup we just injected.
                // Subsequent calls to page() are ignored since a page/widget
                // can only be enhanced once.
                $page.page();

                // Now call changePage() and tell it to switch to the page we just modified.
                $.mobile.changePage($page, options);
            }
        </script>
    </head>
    <body>
        <!-- home page section -->
        <section id="homePageSection" data-role="page" data-title="Form Test - Home">
            <div data-role="header">
                <h1>Form Test</h1>
                <nav data-role="navbar">
                    <ul>
                        <li>
                            <a href="#" class="ui-btn-active ui-state-persist" >Home</a>
                        </li>
                        <li class="formLineItem">
                            <a href="#formSection">Form</a>
                        </li>
                    </ul>
                </nav>
            </div><!-- /header -->
            <div data-role="content" class="container">
                <h1>Form - Home Page</h1>
            </div><!-- /content -->
            <div data-role="footer"></div><!-- /footer -->
        </section><!-- /homePageSection -->
        <!-- form section -->
        <section id="formSection" data-role="page" data-title="Form Test - Form">
            <div data-role="header">
                <h1>Form Test</h1>
                <nav data-role="navbar">
                    <ul>
                        <li>
                            <a href="#homePageSection">Home</a>
                        </li>
                        <li class="formLineItem">
                            <a href="#" class="ui-btn-active ui-state-persist" >Form</a>
                        </li>
                    </ul>
                </nav>
            </div><!-- /header -->
            <div data-role="content" class="container">
            </div><!-- /content -->
            <div data-role="footer"></div><!-- /footer -->
        </section><!-- /formSection -->
    </body>
</html> 
```

资产/配置/formValues.xml：

```
<formValues>
    <value1>Videos</value1>
    <value2>Images</value2>
</formValues> 
```

更新的有效代码：

```
<!doctype html>
<html>
    <head>
        <title>Form Test</title>
        <link rel="stylesheet" href="http://code.jquery.com/mobile/1.0.1/jquery.mobile-1.0.1.min.css" />
        <script src="http://code.jquery.com/jquery-1.6.4.min.js"></script>
        <script src="http://code.jquery.com/mobile/1.0.1/jquery.mobile-1.0.1.min.js"></script>
        <script>
            // data used to generate checkboxes
            var value1;
            var value2;

            // flag that determines the page has already been initialized
            var pageInitialized = false;
            // flag that determines if the dynamic form has already been created from the loaded data
            var formCreated = false;

            // remap jQuery to $
            (function($) {
            })(window.jQuery);

            // trigger when page is ready
            $(document).ready(function() {
                initialize();
            });
            /**
             * Initialize the page.
             *
             */
            function initialize() {
                // get server parameters befor making ajax call
                getFormValues();

                // set the flag indicating that the page has already been initialized
                pageInitialized = true;
            }

            /**
             * Gets server parameters from the application's configuration file.
             *
             */
            function getFormValues() {
                // get the server URL from external XML file
                $.ajax({
                    type : "GET",
                    url : "assets/config/formValues.xml",
                    cache : false,
                    async : false,
                    timeout : 5000,
                    dataType : "xml",
                    success : function(xml) {
                        $(xml).each(function() {
                            value1 = $(this).find('value1').text();
                            value2 = $(this).find('value2').text();
                        });
                    }
                });
            }

            // Listen for any attempts to call changePage()
            $(document).bind("pagebeforechange", function(e, data) {
                // We only want to handle changePage() calls where the caller is
                // asking us to load a page by URL.
                if( typeof data.toPage === "string") {
                    // We are being asked to load a page by URL, but we only
                    // want to handle URLs that request the data for a specific
                    // category.
                    var u = $.mobile.path.parseUrl(data.toPage);
                    if(u.hash.search(/^#formSection/) !== -1) {
                        currentContentSection = "formSection";
                        // if the form has not yet been created, proceed to creat it
                        if(!formCreated) {
                            // if the page hasn't been initialized (data not loaded), proceed to initialize
                            // this happens when the user refreshes the page when on 'Form' tab
                            if(!pageInitialized) {
                                initialize();
                            }

                            // generate the form controls from the loaded data and add them to the page 
                            displayValueFilters();
                            formCreated = true;

                            // Make sure to tell changePage() we've handled this call so it doesn't
                            // have to do anything.
                            e.preventDefault();
                        }
                    }
                }
            });
            /**
             * Sets up and displays values.
             *
             */
            function displayValueFilters() {
                var pageSelector = "#formSection";

                // Get the page we are going to dump our content into
                var $page = $(pageSelector);

                // The markup we are going to inject into the content area of the page.
                var markup = "";
                markup += "<label for='value1'>" + value1 + "</label>";
                markup += "<input type='checkbox' name='value1' id='value1' />";
                markup += "<label for='value2'>" + value2 + "</label>";
                markup += "<input type='checkbox' name='value2' id='value2' />";

                $("#valueCheckboxes").empty();

                $(markup).appendTo("#valueCheckboxes").trigger("create");

                // Pages are lazily enhanced. We call page() on the page
                // element to make sure it is always enhanced before we
                // attempt to enhance the listview markup we just injected.
                // Subsequent calls to page() are ignored since a page/widget
                // can only be enhanced once.
                $page.page();

                // Now call changePage() and tell it to switch to the page we just modified.
                $.mobile.changePage($page, options);
            }
        </script>
    </head>
    <body>
        <!-- home page section -->
        <section id="homePageSection" data-role="page" data-title="Form Test - Home">
            <div data-role="header">
                <h1>Form Test</h1>
                <nav data-role="navbar">
                    <ul>
                        <li>
                            <a href="#" class="ui-btn-active ui-state-persist" >Home</a>
                        </li>
                        <li class="formLineItem">
                            <a href="#formSection">Form</a>
                        </li>
                    </ul>
                </nav>
            </div><!-- /header -->
            <div data-role="content" class="container">
                <h1>Form - Home Page</h1>
            </div><!-- /content -->
            <div data-role="footer"></div><!-- /footer -->
        </section><!-- /homePageSection -->
        <!-- form section -->
        <section id="formSection" data-role="page" data-title="Form Test - Form">
            <div data-role="header">
                <h1>Form Test</h1>
                <nav data-role="navbar">
                    <ul>
                        <li>
                            <a href="#homePageSection">Home</a>
                        </li>
                        <li class="formLineItem">
                            <a href="#" class="ui-btn-active ui-state-persist" >Form</a>
                        </li>
                    </ul>
                </nav>
            </div><!-- /header -->
            <div data-role="content" class="container">
                <form method="get" action="">
                    <div data-role="fieldcontain">
                        <!-- input field for toc search -->
                        <label id="searchLabel" for="searchInput"><strong>Search terms:</strong></label>
                        <input type="search" name="searchInput" id="searchInput" value="" />
                    </div>
                    <div style="text-align: left">
                        <fieldset id="valueCheckboxes" data-role="controlgroup" data-type="horizontal"></fieldset>
                    </div>
                    <div data-role="fieldcontain">
                        <a href="#" id="searchButton" data-role="button" data-inline="true">Search</a>
                    </div>
                </form>
            </div><!-- /content -->
            <div data-role="footer"></div><!-- /footer -->
        </section><!-- /formSection -->
    </body>
</html> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-17T21:48:55.850

你包括一堆资产。您需要在 jQuery Mobile 1.0.1 和 1.1.0 之间做出决定（目前您包括 1.1.0 CSS 和 1.0.1 JS）。

对于 jQuery Mobile 1.1.0，您的包含应该如下所示：

```
<link rel="stylesheet" href="http://code.jquery.com/mobile/1.1.0/jquery.mobile-1.1.0.min.css" />
<script src="http://code.jquery.com/jquery-1.6.4.min.js"></script>
<script src="http://code.jquery.com/mobile/1.1.0/jquery.mobile-1.1.0.min.js"></script> 
```

对于 jQuery Mobile 1.0.1，您的包含应该如下所示：

```
<link rel="stylesheet" href="http://code.jquery.com/mobile/1.0.1/jquery.mobile-1.0.1.min.css" />
<script src="http://code.jquery.com/jquery-1.6.4.min.js"></script>
<script src="http://code.jquery.com/mobile/1.0.1/jquery.mobile-1.0.1.min.js"></script> 
```

由于您的代码包含 jQuery Mobile 1.0.1，它应该包含 jQuery Core 1.6.4。

我不相信这会解决你的问题。因此，请务必检查您的 JS 控制台是否出现任何错误。如果您在初始化 jQuery Mobile 小部件后尝试对其进行初始化，您将收到错误消息。

# android - 包括 Google Play 下载器库 | APK文件扩展库

> ID：10199590
> 
> 赞同：4
> 
> 时间：2012-04-17T21:39:38.983
> 
> 标签：android, eclipse, apk, expansion

我正在关注[http://developer.android.com/guide/market/expansion-files.html](http://developer.android.com/guide/market/expansion-files.html)上的开发指南，以便将其他资产下载到我的 apk。

我已经完成了关于库的导入等的所有部分。我还在我的主程序中实现了示例代码（为了检测扩展文件是否已经下载，如果我们需要下载它们并启动下载， ETC ..）

我在 eclipse 中没有错误，但是当我启动应用程序并开始从库中调用方法和类时，我遇到了各种崩溃：

**1 - 首先，在安装时，adb 说找不到库..：**

```
[2012-04-17 22:50:13 - MyApp] adb is running normally.
[2012-04-17 22:50:13 - MyApp] Performing com.gmla.MyApp activity launch
[2012-04-17 22:50:16 - MyApp] Uploading MyApp.apk onto device 'SH16PV801048'
[2012-04-17 22:50:16 - MyApp] Installing MyApp.apk...
[2012-04-17 22:50:22 - MyApp] Success!
[2012-04-17 22:50:22 - Google Play Downloader Library] Could not find Google Play Downloader Library.apk!
[2012-04-17 22:50:22 - Google Play License Library] Could not find Google Play License Library.apk! 
```

这是我如何尝试导入我的库的屏幕截图：http: [//floy.fr/perso/floy/expfiles/4.PNG](http://floy.fr/perso/floy/expfiles/4.PNG)

我已经在我的主要项目属性中的 Java 构建路径中导入了带有项目导入的库，如**a)**部分：（也以这种方式在下载库中导入了许可证库）

我还尝试只导入**b)**部分中的 jars （安装时没有错误）

**并使用c**部分中的 Android 库导入） （这似乎是开发指南中推荐的一种，但我对此有编译错误，eclipse 找不到一些参考资料，我无法构建项目）：

因此，jar 导入似乎是最好的，编译和安装时没有错误，但是当我从库中调用方法和类时，我遇到了其他错误：

**2 - 在应用程序中：**

当我尝试使用帮助程序以使用此方法检查 XAPKFiles 的存在时：

```
boolean expansionFilesDelivered() {

        XAPKFile[] xAPKS = {new XAPKFile(true, 3, 687801613L)
        // main file only
        };

        for (XAPKFile xf : xAPKS) {
            String fileName = Helpers.getExpansionAPKFileName(this, xf.mIsMain, xf.mFileVersion);
            if (!Helpers.doesFileExist(this, fileName, xf.mFileSize, false))
                return false;
        }
        return true;
    } 
```

我在 DDMS 中有这个崩溃：

```
04-17 23:14:24.614: I/dalvikvm(23201): Could not find method com.google.android.vending.expansion.downloader.Helpers.getExpansionAPKFileName, referenced from method com.gmla.guideaudio.apkexp.GmlaCheckExpFiles.expansionFilesDelivered
04-17 23:14:24.614: W/dalvikvm(23201): VFY: unable to resolve static method 1295: Lcom/google/android/vending/expansion/downloader/Helpers;.getExpansionAPKFileName (Landroid/content/Context;ZI)Ljava/lang/String;
04-17 23:14:24.614: D/dalvikvm(23201): VFY: replacing opcode 0x71 at 0x001b
04-17 23:14:24.614: W/dalvikvm(23201): Unable to resolve superclass of Lcom/gmla/guideaudio/apkexp/GmlaDownloaderService; (250)
04-17 23:14:24.614: W/dalvikvm(23201): Link of class 'Lcom/gmla/guideaudio/apkexp/GmlaDownloaderService;' failed
04-17 23:14:24.614: E/dalvikvm(23201): Could not find class 'com.gmla.guideaudio.apkexp.GmlaDownloaderService', referenced from method com.gmla.guideaudio.apkexp.GmlaCheckExpFiles.onCreate
04-17 23:14:24.614: W/dalvikvm(23201): VFY: unable to resolve const-class 135 (Lcom/gmla/guideaudio/apkexp/GmlaDownloaderService;) in Lcom/gmla/guideaudio/apkexp/GmlaCheckExpFiles;
04-17 23:14:24.614: D/dalvikvm(23201): VFY: replacing opcode 0x1c at 0x001c
04-17 23:14:24.624: V/Performance(23201): >>com.gmla.guideaudio.apkexp.GmlaCheckExpFiles@40db32b0 onCreate
04-17 23:14:24.624: D/AndroidRuntime(23201): Shutting down VM
04-17 23:14:24.624: W/dalvikvm(23201): threadid=1: thread exiting with uncaught exception (group=0x40abf228)
04-17 23:14:24.624: E/AndroidRuntime(23201): FATAL EXCEPTION: main
04-17 23:14:24.624: E/AndroidRuntime(23201): java.lang.NoClassDefFoundError: com.google.android.vending.expansion.downloader.Helpers
04-17 23:14:24.624: E/AndroidRuntime(23201):    at com.gmla.guideaudio.apkexp.GmlaCheckExpFiles.expansionFilesDelivered(GmlaCheckExpFiles.java:64)
04-17 23:14:24.624: E/AndroidRuntime(23201):    at com.gmla.guideaudio.apkexp.GmlaCheckExpFiles.onCreate(GmlaCheckExpFiles.java:22)
04-17 23:14:24.624: E/AndroidRuntime(23201):    at android.app.Activity.performCreate(Activity.java:4524)
04-17 23:14:24.624: E/AndroidRuntime(23201):    at android.app.Instrumentation.callActivityOnCreate(Instrumentation.java:1071)
04-17 23:14:24.624: E/AndroidRuntime(23201):    at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:2115)
04-17 23:14:24.624: E/AndroidRuntime(23201):    at android.app.ActivityThread.handleLaunchActivity(ActivityThread.java:2189)
04-17 23:14:24.624: E/AndroidRuntime(23201):    at android.app.ActivityThread.access$600(ActivityThread.java:139)
04-17 23:14:24.624: E/AndroidRuntime(23201):    at android.app.ActivityThread$H.handleMessage(ActivityThread.java:1261)
04-17 23:14:24.624: E/AndroidRuntime(23201):    at android.os.Handler.dispatchMessage(Handler.java:99)
04-17 23:14:24.624: E/AndroidRuntime(23201):    at android.os.Looper.loop(Looper.java:154)
04-17 23:14:24.624: E/AndroidRuntime(23201):    at android.app.ActivityThread.main(ActivityThread.java:4894)
04-17 23:14:24.624: E/AndroidRuntime(23201):    at java.lang.reflect.Method.invokeNative(Native Method)
04-17 23:14:24.624: E/AndroidRuntime(23201):    at java.lang.reflect.Method.invoke(Method.java:511)
04-17 23:14:24.624: E/AndroidRuntime(23201):    at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:784)
04-17 23:14:24.624: E/AndroidRuntime(23201):    at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:551)
04-17 23:14:24.624: E/AndroidRuntime(23201):    at dalvik.system.NativeStart.main(Native Method) 
```

当我在导入库时使用方法 1 或 2 时会发生此崩溃。

我试图将 ant 更新到最新的 1.8.3，因为我读到 1.7.1 可能在库导入方面存在一些问题.. 解决我的问题没有成功。

我的主要应用程序在 Google API 8 (Android 2.2) 上

为了使它起作用，我搜索了很多东西，但是..现在我完全没有主意了！

如果有人知道如何让这个工作，那将是非常友好的：p

对不起这篇长篇文章，对不起我的英语，如果我拼写错误，那是因为我是法国人：p

**编辑：**我已经尝试了下载器示例代码，使用库导入方法**c)**，这次我没有编译错误，但是在安装过程中：

```
[2012-04-18 01:56:16 - GuideAudio] Android Launch!
[2012-04-18 01:56:16 - GuideAudio] adb is running normally.
[2012-04-18 01:56:16 - GuideAudio] Performing com.gmla.guideaudio.GuideAudio activity launch
[2012-04-18 01:56:19 - GuideAudio] Uploading GuideAudio.apk onto device 'SH16PV801048'
[2012-04-18 01:56:19 - GuideAudio] Installing GuideAudio.apk...
[2012-04-18 01:56:21 - GuideAudio] Installation error: INSTALL_FAILED_MISSING_SHARED_LIBRARY
[2012-04-18 01:56:21 - GuideAudio] Please check logcat output for more details.
[2012-04-18 01:56:21 - GuideAudio] Launch canceled! 
```

我不明白，因为该库似乎导入良好......我可以在 Eclipse 的“引用库”下看到它们。

我也在清单上写了：

```
<uses-library android:name="com.google.android.vending.expansion.downloader" />
         <uses-library android:name="com.google.android.vending.licensing" /> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-18T00:09:05.447

答案可能在这个类似问题的答案中： [https ://stackoverflow.com/a/10109546/180538](https://stackoverflow.com/a/10109546/180538)

前两天我也遇到了这个问题，答案解决了。特别是阅读最后一段。

这些`<uses-library>`标签不适用于第三方内容，仅适用于设备上安装的现有库。就像地图一样，它安装在每个官方的安卓设备上（亚马逊 Kindle 不是官方的安卓设备，仅作为示例）。

我也不确定您是否已将库项目添加到项目中*并同时*链接 jar。这也可能造成麻烦。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-18T11:20:46.607

对于正在阅读本文的人，用于导入扩展库的正确方法是我在第一篇文章中称为**c)的方法。**

在主项目中导入项目库时，请注意路径长度。由于我的 Android SDK 安装文件夹与我的工作区不在同一个驱动器上，我的路径太长了。因此，库导入可能会失败。（花了我一天时间才意识到.. - *_* - ）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-05-02T11:14:26.583

我认为这里真正的问题是[这个答案](https://stackoverflow.com/questions/5167273/in-eclipse-unable-to-reference-an-android-library-project-in-another-android-pr)中描述的问题：如果包含的库项目和引用项目位于不同的驱动器中，则 Eclipse 无法解析路径名。例如 C 中的库：和 D 中的引用项目：

# sql - 面向最终用户的 SQL：优点和缺点

> ID：10199594
> 
> 赞同：4
> 
> 时间：2012-04-17T21:39:51.470
> 
> 标签：sql, sql-server, security, reporting

曾几何时，在遥远的星系中，我见证了几个开发人员之间的讨论。主题是让最终用户访问生产 SQL 服务器 (MS SQL 2008) 是否是个好主意，以便让他们能够根据自己的数据制作自己的报告。

这是商界人士的要求——“我们的客户想要制作自定义报告”。

一个提出这个建议的人声称：

1.  他能够通过一组权限为用户提供“只读访问权限”，并使系统绝对安全。
2.  SQL 最初是一种“最终用户”语言，现在可能也是。
3.  拥有运行 SQL 查询的权限，用户将能够做他们想做的事，而不会打扰开发人员和支持。

其他反对这一点的人声称：

1.  甚至 max 也很容易使 MS SQL 崩溃。禁止进入。
2.  无论如何，向最终用户公开 SQL 和数据库结构并不是一个好主意。这是一个糟糕的设计。
3.  SQL 对于非程序员来说太复杂了，因此，它不会让他们的生活更轻松。

您如何看待授予最终用户访问 SQL 的权限？

先感谢您！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-17T21:46:35.447

您不仅可以通过将用户限制为只读访问，还可以通过打开[查询调控器成本限制](http://msdn.microsoft.com/en-us/library/ms191219%28v=sql.110%29.aspx)来使某些事情更安全。这将尝试在运行查询之前对查询进行一些成本分析，如果它们超过预定义的阈值，它将拒绝运行它们。

比这更好的是有一个可用于查询的克隆数据库。这可能很简单，就像运行生产系统备份的单独服务器一样简单。根据您的数据需要的“实时”程度，您可以相应地调整备份/恢复间隔。

至于将数据库公开给非程序员直接查询是否是一个好主意，这仍然取决于用户的精明程度。可以教他们 SQL 吗？对于简单的事情真的没有那么难。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-17T21:48:21.893

这完全取决于您的用户。如果用户有技术能力或有兴趣开发此技能集，他们可以减轻程序员的大部分工作量。

另一方面，我知道那些永远不会理解规范化数据结构的傻瓜，他们失控的查询一再导致服务器崩溃。

如果您决定这样做，请尽可能创建一个单独的数据库镜像用于报告。每晚更新一次，以便他们拥有相当最新的数据。当然，如果他们有实时报告需求，这并不理想。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-17T21:48:07.213

反对的论据非常微弱。如果用户，不能写sql，你为什么在乎？有报告编写工具（Crystal Reports）可以处理很多事情。

一些使用其他软件的公司的员工确实知道如何查询数据库，或者他们可以聘请顾问。

锁定数据库访问权限，您将永远无法进入企业市场。

编辑：可以将一组视图内置到数据库中，以满足大多数用户的需求。这样他们就不必担心复杂的连接。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-04-17T21:54:06.410

授予最终用户访问权限以针对生产数据库编写自己的查询（即使具有只读访问权限）的主要问题是，您的性能将下降到底层并进入地下室。如果最终用户可以编写 SQL，他们通常不会写得很好。在某些时候，他们会发现游标（如果在 MS SQL 中）和/或他们会过度思考他们的连接。他们会找到他们能找到的每张桌子。如果您想让他们开心，请每晚将数据转储到另一台机器（或受限虚拟机）上的非生产数据库中，并告诉他们不要自暴自弃。专业提示：还告诉他们您将没有时间支持它。

我不是反最终用户，我只是不认为他们可以被信任以任何类似有效的方式编写查询。如果您有少数几个您认为可以信任的人，请与他们一起尝试，如果他们共享密码，则将其锁定。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-04-17T21:56:07.567

这取决于部署后谁负责产品。如果情况很清楚（您在没有支持的情况下出售所有代码）那为什么不呢？那不是你的问题。

在您必须照顾所有事情并负责正常运行时间的情况下，即使是只读的，我也不建议这样做。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-04-17T21:59:50.150

您可以使数据库帐户免受不必要的更改，但不能使其免受性能问题的影响。最终用户可以轻松创建一个锁定所有表并长时间运行的查询。它实际上不会使数据库崩溃，但用户会将其视为崩溃。

如果您对可能挂起系统的报告功能没问题，您可以继续。

但是，我必须说我怀疑这个的用处。与统计数据一样，您必须知道您所要求的正是您想要要求的，否则结果将毫无用处。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-04-18T06:01:09.610

最终，最终用户对数据进行分析具有商业价值。通过 SQL 直接访问是一种方法。

一个缺点还没有提到。默认情况下，SQL Server 中的读取器会阻止写入器。这意味着您可能需要启用快照隔离（或者可能使用数据库快照或数据库的只读副本），否则即使是最简单、最无辜的用户查询也可能会削弱您的生产系统。

也许令人惊讶的是，尽管微软在 7 年前引入了快照隔离模式，但在关闭它的情况下投入生产似乎仍然很常见（默认为 READ COMMITTED without SI）。因此，在允许用户访问您的生产系统之前，您可能需要进行更改并进行一些重新测试和重构。

# opencv - 如何将凸包点转换为图像中的真实坐标

> ID：10199595
> 
> 赞同：1
> 
> 时间：2012-04-17T21:39:51.757
> 
> 标签：opencv

我一定完全误解了一些东西。我正在使用以下代码来查找四边形的角点

```
 maxCtr = cvApproxPoly( maxCtr, sizeof(CvContour), mem2, CV_POLY_APPROX_DP, 5, 1 );
    CvSeq* hull = cvConvexHull2( maxCtr, 0, CV_CLOCKWISE, 0 );
    int numOfHull =hull->total;
    CvPoint*  hullPoints;
    hullPoints = ( CvPoint *)malloc((hull->total)*sizeof(CvSeq));
    cvCvtSeqToArray(hull,hullPoints); 
```

正如我使用 cvDrawContours 验证的那样，正确找到形状效果很好。但是当我看到`hullPoints`期望它们是四个角的坐标时，它们的 x 和 y 值看起来很疯狂，例如 83603736、83603744。这正常吗？如果是这样，我怎样才能得到他们的图像坐标？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-22T14:26:53.250

问题出在`convexHull`函数调用中：

```
cvConvexHull2( maxCtr, 0, CV_CLOCKWISE, 0 ) 
```

当最后一个参数*return_points*设置**为零**时，该函数将为您提供点的索引，而不是点本身

为了使这项工作，我认为您应该将最后一个参数替换为**一个**以获得积分。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-18T00:48:44.490

我可以在第五行看到一个问题：

```
hullPoints = ( CvPoint *)malloc((hull->total)*sizeof(CvSeq)); 
```

应该：

```
hullPoints = ( CvPoint *)malloc((hull->total)*sizeof(CvPoint)); 
```

# c# - 将字符串从 Form2 发送到 Form3

> ID：10199596
> 
> 赞同：0
> 
> 时间：2012-04-17T21:39:51.850
> 
> 标签：c#, .net, winforms, visual-studio-2010

我正在使用 Form2 更新默认打印机并将字符串发送到 Form3。我通常从 Form1 操作并将数据传递到 Form2 或 Form3 没有问题。但是使用Form2更新Form3有问题！

实名是：Form1 = Form1, Form2 = formUserSettings, Form3 = formViewDwg

这是Form1中的代码，调用Form2（formUserSettings）：

```
private void configureStartupSettingsToolStripMenuItem_Click(object sender, EventArgs e)
    {
        formUserSettings frmUsr = new formUserSettings(prnNameString, prnDriverString, prnPortString,
            Settings.Default.DefaultPrinter.ToString(), Settings.Default.ViewStyle, Settings.Default.ReCenterEVafterDwgClose, 
            Settings.Default.SyncListDwgNum, listMain);
        frmUsr.ValueUpdated += new ValueUpdatedEventHandler(frmUsr_ValueUpdated); //---added 3-22-12
        //frmUsr.ValueUpdated2 += new ValueUpdatedEventHandler(newPrn_ValueUpdated); //---added 4-12-12

        frmUsr.ShowDialog();
        frmUsr.Close();
    } 
```

这是 Form2 (formUserSettings) 中的代码，它尝试将打印机名称发送到 Form3 (formViewDwg)。

```
if (Application.OpenForms.OfType<formViewDwg>().Count() > 0)
            {
                newEntry = comboPrinters.Items[index].ToString();
                formViewDwg frmVd = this.Owner as formViewDwg;
                delPassData del = new delPassData(frmVD.passedNewVal);
                del(newEntry);
            }
            else
            {
                frmVD = new formViewDwg(EViewMethods.currentPartPath, EViewMethods.currentPartNum, EViewMethods.currentDwgNum,
                    Settings.Default.DefaultPrinter, Settings.Default.DefaultPrinterDriver, Settings.Default.DefaultPrinterPort,
                    EViewMethods.defaultPrn[0], EViewMethods.defaultPrn[1], EViewMethods.defaultPrn[2], lBox, false, false);

                newEntry = comboPrinters.Items[index].ToString();
                delPassData del = new delPassData(frmVD.passedNewVal);
                del(newEntry);
            } 
```

Form3（formViewDwg）内部是：

```
public void passedNewVal(string newPrn) // using the delegate "delPassData" declared in formUserSettings
    {
        try
        {
            comboPrinter.Text = newPrn;
        }
        catch
        {

        }
    } 
```

错误是“委托给实例方法不能有 null 'this'”。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-18T13:02:24.783

试试这个：

```
In Form1

Form2 vForm2=new Form2();
vForm2.vForm1=this;      //initialize the vForm1 variable of Form2 to this form
vForm2.Show(); 
```

并在 Form2 中定义一个 Form1 类型的全局公共变量。

```
public Form1 vForm1; 
```

您现在可以使用 Form1 的任何属性。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-07T21:27:28.500

好吧，我从来没有发现如何将字符串从 Form2 发送到 Form3，但我找到了一个很好的解决方案：当 Form2 关闭并将其字符串从“frmUsr_ValueUpdated”发送到 Form1 时，它会检查 Form3 是否打开。如果是，则使用 Form3 中的公共方法来更新其 comboBox.text，如下所示。（Form1 = Form1，Form2 = formUserSettings，Form3 = formViewDwg {instance = frmVD}）

```
private void frmUsr_ValueUpdated(object sender, ValueUpdatedEventArgs e) //---added 3-22-12
    {
        // Update the printer name on Form1 with the new value from formUserSettings
        string prnStr = e.NewValue;
        string[] parts = prnStr.Split('^'); //the printer name, driver and port were passed by e.NewValue, being separated by a "^"

        //---added 5-7-12
        EViewMethods.defaultPrn[0] = parts[0]; //printer name
        EViewMethods.defaultPrn[1] = parts[1]; //printer driver
        EViewMethods.defaultPrn[2] = parts[2]; //printer port

        toolStripStatusLabel3.Text = parts[0];

        //---added 5-7-12
        if (frmVD != null && !frmVD.IsDisposed) //want to send the new printer name now if formViewDwg is already open. If it is not open, then when it is called to open, the formViewDwg constructor will pass the new printer to it.
        {
            frmVD.ProcessPrinterName(parts[0]); //ProcessPrinterName is a public method inside formViewDwg.  Can call here because formViewDwg is already open!
        }
    } 
```

formViewDwg (Form3) 内部是公共的 ProcessPrinterName 方法：

```
public void ProcessPrinterName(string message)
    {
        comboPrinter.Text = message;
    } 
```

如果 Form3 (formViewDwg) 未打开，则每当通过其构造函数参数列表调用实例时，将更新的打印机名称传递给它。打印机名称将在构造函数中作为“字符串 prnName”传递：

```
public formViewDwg(string currentPath, string currentPartNum, string currentDwgNum,
            string prnNameList, string prnDriverList, string prnPortList,
            string prnName, string prnDriver, string prnPort, ListBox lstBox, bool usingEngCode, bool engCodeIsEnabled) //---added 3-12-12
    {
        InitializeComponent(); 
```

# java - 如何在Java中使用正则表达式检测和排除字符串中的前导单引号

> ID：10199598
> 
> 赞同：0
> 
> 时间：2012-04-17T21:39:58.130
> 
> 标签：java, regex

我正在使用正则表达式来处理一些 VB 代码，我想找到以下形式的语句 -

```
 ABC.Transaction = GlobalCommArea 
```

不幸的是，一些语句在代码中被注释掉了。VB 单行注释以单引号开头，所以我的搜索结果如下 -

```
 ' ABCD.Transaction = GlobalCommArea    <-- incorrect
  ' PQR.Transaction = GlobalCommArea           <-- incorrect
  WXY.Transaction = GlobalCommArea             <-- correct
      WXY.Transaction = GlobalCommArea ' 2012      <-- correct 
```

我尝试使用以下代码检测是否存在单引号并将其排除 -

```
 public static void test2()
     {
    String[] lines = new String[20];

  lines[0] = "' ABCD.Transaction = GlobalCommArea";
  lines[1] = "   ' PQR.Transaction = GlobalCommArea";
  lines[2] = " WXY.Transaction = GlobalCommArea";
  lines[3] = "WXY.Transaction = GlobalCommArea ' 2012";

  String regex;
  regex = "^\\s*[^']*\\s*.*.Transaction\\s*=\\s*GlobalCommArea"; // the regex that I am using

      Pattern p = Pattern.compile(regex);

  for(int i=0; i<=3; i++)
  {
     Matcher m = p.matcher(lines[i]);

     if(m.find())
     {
        System.out.print("Yes\t");
     }
     else
     {
        System.out.print("No\t");
     }

      System.out.println(lines[i]);
     }
    } 
```

但是，正则表达式不起作用。我得到以下输出 -

```
 Yes ' ABCD.Transaction = GlobalCommArea
    Yes    ' PQR.Transaction = GlobalCommArea
    Yes  WXY.Transaction = GlobalCommArea
    Yes WXY.Transaction = GlobalCommArea ' 2012 
```

如何编写一个正则表达式来检测行首的单引号（即不包括空格）并避免这些行？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-17T21:44:38.630

由于`.*`之前的原因，您正在匹配所有这些`Transaction`，请尝试将其更改为以下内容：

```
regex = "^[^']*\\.Transaction\\s*=\\s*GlobalCommArea"; 
```

# cocoa - 在 OS X (lion) 中，我如何才能找到组合键是否用作键盘快捷键？

> ID：10199609
> 
> 赞同：2
> 
> 时间：2012-04-17T21:41:20.137
> 
> 标签：cocoa, osx-lion, keyboard-shortcuts

我想在我的应用程序（OS X lion）中放一堆键盘快捷键，这样我就可以用键盘做大部分事情。当然，已经有一堆热键组合列表在使用，包括 HIG 中的组合键。

是否有一些实用程序可用于键入组合键并确定它是否已经意味着某些东西（全局或 mac 标准——我不太担心重用另一个应用程序使用的某些特殊组合——或者我应该是？）？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-18T00:55:28.880

您可以使用 Carbon 来执行此操作。不要害怕在这里使用 Carbon，没有 Cocoa 方法来获取这些信息，并且仍然支持 Carbon 方法。

该`CopySymbolicHotKeys()`函数返回一个字典数组，其中包含有关在键盘首选项窗格中定义的系统范围的符号热键的信息。每个字典都包含有关单个热键的信息。

具体来说，每个字典都有三个键：

*   `kHISymbolicHotKeyCode`：热键的虚拟键码，表示为`CFNumber`。
*   `kHISymbolicHotKeyModifiers`：热键的键盘修饰符，表示为`CFNumber`.
*   `kHISymbolicHotKeyEnabled`：热键的启用状态，表示为`CFBoolean`。

显然，这些是原始键码，因此如果您想查看键码实际指的是什么，则需要做一些工作。

请注意，该数组不包含自定义的、特定于应用程序的热键，但这是一个小问题。

这是一个简单的例子：

```
#import <Carbon/Carbon.h>
CFArrayRef registeredHotKeys;

if(CopySymbolicHotKeys(&registeredHotKeys) == noErr)
{
    CFIndex count = CFArrayGetCount(registeredHotKeys);
    for(CFIndex i = 0; i < count; i++)
    {
        CFDictionaryRef hotKeyInfo = CFArrayGetValueAtIndex(registeredHotKeys, i);

        CFNumberRef hotKeyCode = CFDictionaryGetValue(hotKeyInfo, kHISymbolicHotKeyCode);
        CFNumberRef hotKeyModifiers = CFDictionaryGetValue(hotKeyInfo, kHISymbolicHotKeyModifiers);
        CFBooleanRef hotKeyEnabled = CFDictionaryGetValue(hotKeyInfo, kHISymbolicHotKeyEnabled);

        NSLog(@"key code: %@ modifiers: %@ enabled: %@", hotKeyCode, hotKeyModifiers, hotKeyEnabled);

    }

    //you MUST release the dictionary when finished with it
    CFRelease(registeredHotKeys);
} 
```

请记住，您需要在项目设置中将 Carbon 框架添加到**Link Binary with Libraries**构建阶段。

有关更多信息，您应该查看[Carbon Event Manager 文档](http://developer.apple.com/legacy/mac/library/documentation/Carbon/reference/Carbon_Event_Manager_Ref/Carbon_Event_Manager_Ref.pdf)(11Mb PDF)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-18T00:53:28.047

Thear 曾经是 Carbon 中的一个 API，用于获取全局键盘快捷键，但是，我不相信 Cocoa API 可以做到这一点。我不认为你应该担心其他第三方应用程序，但你可以参考[http://support.apple.com/kb/HT1343](http://support.apple.com/kb/HT1343)并且只是硬代码来避免这些。他有帮助。

# c# - RestSharp/Json.NET 将数组序列化为 JSON 对象

> ID：10199610
> 
> 赞同：4
> 
> 时间：2012-04-17T21:41:23.653
> 
> 标签：c#, .net, serialization, json.net, restsharp

我有一点小情况。我正在使用 RestSharp 与 Web 服务交互，该服务要求我在请求中发送以下内容：

```
{
    "a":"a value",
    "b":"b value"
} 
```

这一切都很好，花花公子，因为你可以简单地使用`class`这样的：

```
public class MyClass
{
    public string A { get; set; }
    public string B { get; set; }
} 
```

但是，***我不知道运行时的属性名称***。因此，我尝试使用`ExpandoObject`，但当然，这只是简单地序列化为 JSON 数组：

```
[
    "a":"a value",
    "b":"b value"
] 
```

因此，似乎我需要能够将a (or ) 序列化（***和反***序列化）作为 JSON 对象（换句话说，使用花括号而不是括号）。`Dictionary``IEnumerable<KeyValuePair<string, string>>`

有谁知道我可以如何做到这一点，最好使用 Json.NET 属性，以便可以在其他地方重用该功能？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-17T22:29:33.120

使用 JObject 怎么样？

```
var obj = new JObject();

obj["One"] = "Value One";
obj["Two"] = "Value Two";
obj["Three"] = "Value Three";

var serialized = obj.ToString(Formatting.None); 
```

给你

```
{"One":"Value One","Two":"Value Two","Three":"Value Three"} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-17T22:35:14.170

使用 .net 类库中的 JavascripSerializer 对象。它支持对正在序列化的对象的反射

见[msdn 文档](http://www.google.com/url?sa=t&rct=j&q=&esrc=s&source=web&cd=1&ved=0CC8QFjAA&url=http://msdn.microsoft.com/en-us/library/system.web.script.serialization.javascriptserializer.aspx&ei=EvCNT9PGLca-8APGtYWfCw&usg=AFQjCNGMTMT3jhFYETV1ayJ_ym7Xqz5gBw&sig2=KMjm0638Pz3KZC7_Ju81-g)

# qt - 项目上的 QTableWidget 标签

> ID：10199614
> 
> 赞同：1
> 
> 时间：2012-04-17T21:41:43.983
> 
> 标签：qt, tags, qtablewidget

我想知道如何在 QTableWidgetItem 上的项目/行/列上设置“标签”。例如，在 C# 中，它被称为 Listview 上的标签。我需要这个，因为我需要将一个项目链接到每一行。

```
ListViewItem.Tag = myObject; 
```

谢谢你的帮助。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-17T23:27:28.440

这将使用[QTableWidgetItem::setData()](http://qt-project.org/doc/qt-4.8/qtablewidgetitem.html#setData)和一点`QVariant`魔法来完成。例如：

```
// Allow your object type to be converted to a QVariant:
Q_DECLARE_METATYPE( ObjectType* );

// Define a role to store your object under:
const int ObjectRole = Qt::UserRole + 1;

QTableWidgetItem *item = new QTableWidgetItem();
item->setData( ObjectRole, QVariant::fromValue(myObject) ); 
```

然后检索您的对象：

```
ObjectType *myObject = item->data( ObjectRole ).value<ObjectType*>(); 
```

容易吧？;)

另请参阅：[Q_DECLARE_METATYPE](http://qt-project.org/doc/qt-4.8/qmetatype.html#Q_DECLARE_METATYPE)、[QVariant::fromValue()](http://qt-project.org/doc/qt-4.8/qvariant.html#fromValue)、[QVariant::value()](http://qt-project.org/doc/qt-4.8/qvariant.html#value)

# python - 用子目录中的应用程序替换 Django 管理模板

> ID：10199615
> 
> 赞同：0
> 
> 时间：2012-04-17T21:41:44.573
> 
> 标签：python, django

我将我的项目组织如下：

```
myproject/
    urls.py
    settings.py
    views.py
    templates/
    apps/
        __init__.py    <-- needed in order to be identified as a package
        exampleapp/
             __init__.py
             admin.py
             models.py
             urls.py
             views.py
        exampleapp2/
        ... 
```

在我的 settings.py INSTALLED_APPS 中，应用程序的名称为“apps.exampleapp1”、“apps.exampleapp2”，其中带有点 (.) 符号表示模块位于子目录中。根据[文档](https://docs.djangoproject.com/en/dev/ref/contrib/admin/#overriding-admin-templates)，如果我希望覆盖或扩展应用程序的管理模板，我需要在名为“admin/appname/modelname/”的模板中创建一个目录，但我已经尝试了“admin/apps/exampleapp/”和'admin/apps.exampleapp' 但都不起作用。在 django.contrib.admin 代码的什么地方我可以找到模板是如何被替换的，或者更简单地说，我需要什么目录路径才能扩展或替换管理模板？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-17T21:51:36.927

你如何组织你的应用程序是无关紧要的。该应用程序的名称仍然只是其直接文件夹名称：“exampleapp”或“exampleapp2”。

所以你的管理模板覆盖应该进入“/templates/admin/exampleapp/modelname/”和“/templates/admin/exampleapp2/modelname/”。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-05-18T05:50:59.057

这可能很旧，但我希望这个解决方案可以帮助某人

(Django 1.8.1)

首先在 settings.py 的顶部：

```
BASE_DIR = os.path.dirname(os.path.dirname(os.path.abspath(__file__))) 
```

然后：

将要扩展的管理模板复制到您在 myproject/template 中创建的文件夹

之后，在 setting.py TEMPLATE 中指定目录：

```
TEMPLATES = [
    {
        'BACKEND': 'django.template.backends.django.DjangoTemplates',
        'DIRS': [os.path.join(BASE_DIR, 'templates'),],
        'APP_DIRS': True,
        'OPTIONS': {
            'context_processors': [
                'django.template.context_processors.debug',
                'django.template.context_processors.request',
                'django.contrib.auth.context_processors.auth',
                'django.contrib.messages.context_processors.messages',],},},] 
```

毕竟我意识到我在我想使用的文件中有这个：

```
{% extends "admin/base.html" %}

{% block title %}
     {{ title }} | {{ site_title|default:_('My Site') }}
{% endblock %}

{% block branding %}
    <h1 id="site-name"><a href="{% url 'admin:index' %}">{{ site_header|default:_('Admin Page') }}</a></h1>
{% endblock %}

{% block nav-global %}{% endblock %} 
```

但它一直显示默认的 Django 标题和标题。这些行是我找到解决方案的地方：

**{{ 标题 }} | {{ site_title|default:_('我的网站') }}**

**{{ site_header|default:_('管理页面') }}**

一旦我删除*了 site_title|default:_* 和 *site_header|default:_*，它就显示了我想要的。

再次，我希望这可以帮助那里的人。

# mysql - 用户之间的人际关系

> ID：10199621
> 
> 赞同：1
> 
> 时间：2012-04-17T21:42:20.707
> 
> 标签：mysql, database, database-design

我参与了一个小型社交网络的开发，用户必须能够在其中建立他们之间的关系并且还拥有对内容的权限。例如：我将一个用户添加为我的朋友，但该用户不允许我查看他/他的所有内容，因此我只能访问用户允许我的那些内容（权限）。所以我有一个问题，需要帮助设计这部分的 DER。我认为有这个表：

```
- users (id, name)
- relations_type (id, name, active)
- users_relations (id, id_user_1, id_user_2)
- users_permissions (id, id_relation, id_module, id_user, view, edit, delete) 
```

这会导致以下情况：

*   每个关系有两行：用户 1 > 用户 2 和用户 2 > 用户 1，因为当我搜索 (SELECT) 时，我需要知道哪些是用户 1 的朋友，哪些是用户 2 的朋友。如果我只留下单向关系，那么我需要一个 UNION，这可能会减慢我的数据库

那是对的吗？当 CRUD 对此进行处理时，您的处理方式如何？顺便说一句，我正在使用 MySQL 和 MyISAM 表。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-17T21:46:12.470

不要使用 user1 和 user2 作为表名，当范围扩大时你会忘记哪个是哪个。您可以对 users 表的权限进行非规范化，您不需要将表划分为几个布尔位。永远不要指望工会，它会在最意想不到的情况下背叛你。

# javascript - requireJS中的全局变量

> ID：10199622
> 
> 赞同：12
> 
> 时间：2012-04-17T21:42:37.337
> 
> 标签：javascript, jquery, requirejs

> **可能重复：**
> [如何在使用 AMD (require.js) 时在 Backbone.js 中加载引导模型](https://stackoverflow.com/questions/9916073/how-to-load-bootstrapped-models-in-backbone-js-while-using-amd-require-js)

这是一个关于我的问题的简单演示。

我需要访问`id_user`in`main.js`文件。我的问题是，在这种情况下如何避免全局变量？为此目的使用全局变量是不好的做法吗？

**main.js**

```
require({
    paths : {
        jQuery : 'http://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min'
    }
});

require([ 'jQuery' ], function() {
       alert(id_user);
    }); 
```

**索引.php**

```
<script data-main="js/main" src="js/require.js"></script>

<script type="text/javascript">
function users() {
    id_user = <?php echo $id; ?>
}

users();
</script> 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-04-17T22:05:00.990

在使用 requirejs 的项目中这种用法不应该有任何全局变量，因为它是用来处理模块的，并且所有模块（及其属性/方法）永远不会全局声明以保持环境整洁。如果您需要一个模块使用另一个模块中设置的变量，那么它们应该通过某些 API 相互通信，或者将该变量设置为属性，需要模块并以这种方式获取属性。

但也许你应该问问自己是否真的需要 requirejs。如果您想构建一个适当的基于模块的应用程序（如果您想知道如何传递变量，我不确定您是否会这样做），那么可以，如果您只想从 JS 加载几个文件，那么 LazyLoad (http://www. appelsiini.net/projects/lazyload）可能是答案。只是说值得考虑根据您的情况特别考虑requirejs的足迹。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-25T18:30:12.090

您正在寻找的是能够将配置变量引导到您的项目中。这回答了你的问题

[使用 AMD (require.js) 时如何在 Backbone.js 中加载引导模型](https://stackoverflow.com/questions/9916073/how-to-load-bootstrapped-models-in-backbone-js-while-using-amd-require-js/10288587#10288587)

# coldfusion - 尝试使用 ColdFusion 中的 java.lang.string 格式方法时出现“未找到格式方法”

> ID：10199626
> 
> 赞同：3
> 
> 时间：2012-04-17T21:43:18.780
> 
> 标签：coldfusion, coldfusion-9

我想在 ColdFusion 中做一些类似于 C 或 Perl 中的 sprintf 的事情。我找到了这个 [答案](https://stackoverflow.com/a/5120633)，这似乎是我正在寻找的。但是，我无法让它工作。

这是我正在尝试的：

```
<cftry>
    <cfset firstName="John">
    <cfset output=createObject("java","java.lang.String").format("Hello, %s!", firstName)>
    <cfcatch type="any">
        <cfdump var="#cfcatch#" expand="false">
    </cfcatch>
<cftry> 
```

这就是我得到的：

> cfcatch.Message：未找到格式化方法。
> 
> cfcatch.Detail：要么没有具有指定方法名称和参数类型的方法，要么格式方法被 ColdFusion 无法可靠破译的参数类型重载。ColdFusion 找到 0 个与提供的参数匹配的方法。如果这是一个 Java 对象并且您验证了该方法存在，请使用 javacast 函数来减少歧义。

这是一个重载的方法，所以我按照建议做了，并在参数上使用了 JavaCast：

```
<cfset output=createObject("java","java.lang.String").format(JavaCast('string', "Hello, %s!"), firstName)>
<cfset output=createObject("java","java.lang.String").format("Hello, %s!", JavaCast('string', firstName))>
<cfset output=createObject("java","java.lang.String").format(JavaCast('string', "Hello, %s!"), JavaCast('string', firstName))> 
```

并且每次都得到同样的错误。

我在 String 类上尝试了另一种静态方法 valueOf，它运行良好。

**编辑：** 我已经看到了评论，我不知道如何回应，但也许我应该在这里解释一下。我上面展示的是我正在尝试做的一个非常简化的例子。目标是使用格式字符串在一个地方提供大量格式，然后简单地传入一个变量列表，而不是格式化一堆变量并输出它们，或者在我输出它们时格式化它们。使用 format 方法，我计划构建一组与我需要的输出匹配的格式字符串，然后我将在查询上执行 cfloop 或 cfoutput，在其中运行这个方法，并获得我想要的输出。没有 DateFormat、NumberFormat、Left、Right 等。如果我不能让这个工作，那就是 B 计划。

我正在运行 ColdFusion 9.01、Windows 7、Java 1.6.0_22。

非常感谢任何和所有帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-19T19:19:48.070

*根据我上面的评论回答：*

它可能与您正在寻找的格式方法不匹配，因为它的签名是 format(String, Object[]) 并且您的第二个 String 参数无法自动转换为 Object 数组。

您可以更改参数以将名称封装在数组中，如下所示`format("Hello, %s!", [firstName])`：

*感谢 Leigh 如此有礼貌，我赞成你的评论 :)*

# jquery - 从 Jquery 加载 Gist 原始文件

> ID：10199630
> 
> 赞同：0
> 
> 时间：2012-04-17T21:43:41.587
> 
> 标签：jquery, ajax, git, gist

我已经绑定了我能想到的所有内容，但是由于某种原因，如果我尝试通过 ajax 或在带有fancybox 的 iframe 中从 gist 加载原始文件，则它将无法正常工作。虽然它在浏览器中运行良好。有任何想法吗？

```
<a class="raw-file" href="https://gist.github.com/raw/2408789/2da6f8b2377cdb86ac0b7a005eec1c1b90459569/Jquery-click-prevent-redirect.txt">Jquery-click-prevent-redirect.txt</a>
<div>results here...</div>

$(document).ready(function() {
    $("a").click(function(event){
            jQuery.ajax({
               url: $(this).attr('href'),
               dataType: "json",
               beforeSend: function(){
                   $(this).closest('div').html('getting file...');
               },
               success: function(data) {
                    $(this).closest('div').html(data);
               },
               complete: function(){
                   //stuff here
               }
          });
    });
}); 
```

**完整的演示在这里：**

[http://jsfiddle.net/aseabridge/5jfBm/2/](http://jsfiddle.net/aseabridge/5jfBm/2/)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-17T22:03:15.717

如果您尝试从浏览器执行此操作，您可能会被同源策略阻止。[在这里阅读更多](https://developer.mozilla.org/En/HTTP_Access_Control)

基本上，除非您使用 JSONP 之类的东西，否则您无法发出跨站点 ajax 请求。

# knockout.js - knockoutjs 无法解析绑定

> ID：10199633
> 
> 赞同：1
> 
> 时间：2012-04-17T21:43:55.823
> 
> 标签：knockout.js

我从 knockoutjs 收到以下错误。它大部分时间都清楚地知道 AreaNames 是什么，因为 UI 显示 AreaNames 正在显示，但在某些时候，javascript 会因错误而冻结。

```
Uncaught Error: Unable to parse bindings. 
Message: TypeError: Object #<Object> has no method 'AreaNames'; 
Bindings value: foreach: ActiveDay().AreaNames() 
```

相关代码：

```
<ul data-bind="foreach: ActiveDay().AreaNames()">
    <li data-bind="text: $data"></li>
</ul>

var scheduleModel = function (shiftCellToggle) {
    var vm = this;
    vm.ActiveDay = ko.observable({ AvailableShiftCategories: [] });
    vm.CustomMapping = {
        'Weeks': {
            create: function (options) {
                var week = new scheduleWeekModel(vm, shiftCellToggle);
                ko.mapping.fromJS(options.data, week.CustomMapping, week);
                return week;
            }
        }
    };
}

    var scheduleWeekModel = function (scheduleModel, shiftCellToggle) {
        var vm = this;
        vm.CustomMapping = {
            'Days': {
                create: function (options) {
                    var day = new scheduleDayModel(scheduleModel, shiftCellToggle);
                    ko.mapping.fromJS(options.data, day.CustomMapping, day);
                    return day;
                }
            }
        };
    var scheduleDayModel = function (scheduleModel, shiftCellToggle) {
        var vm = this;
        vm.CustomMapping = {
            'AvailableShiftCategories': {
                create: function (options) {
                    var availableShiftCategory = new availableShiftCategoryModel(scheduleModel, vm, shiftCellToggle);
                    ko.mapping.fromJS(options.data, availableShiftCategory.CustomMapping, availableShiftCategory);
                    return availableShiftCategory;
                }
            }
        };

        vm.AreaNames = ko.observableArray([]);

var viewModel = new scheduleModel(createShiftToggle());
ko.applyBindings(viewModel); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-28T06:31:57.337

我发现这个一般问题的最佳解决方案是在 GC 上：[https ://groups.google.com/d/msg/knockoutjs/oTVkPnNxF84/mK1FIrAaOqoJ](https://groups.google.com/d/msg/knockoutjs/oTVkPnNxF84/mK1FIrAaOqoJ)

将 ko 对象输出为 HTML 中的 JSON 字符串。这是了解正在发生的事情的粗略但有效的工具。就我而言，我发现在启用特定 dom 元素后，后期绑定是消除我遇到此类错误的特定问题的关键。请尝试 GC group 上描述的解决方案。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-17T21:51:40.380

您的代码显示`AreaNames`位于名为 vm 的对象上。但是您的绑定意味着它`AreaNames`是 object 的一部分`ActiveDay`。从您提供的代码来看，这没有意义。我们可能需要查看更多代码。

什么是 vm，它是如何绑定的？这是传递给的对象`applyBindings`吗？

我的第一个想法是，假设`ActiveDay`是您的根虚拟机上的一个属性，它在某些时候未被分配，这会以您描述的方式破坏绑定。

希望这可以帮助。

# jquery - jQuery一键循环显示/隐藏兄弟元素

> ID：10199637
> 
> 赞同：0
> 
> 时间：2012-04-17T21:44:18.153
> 
> 标签：jquery, loops

我正在尝试使用一个按钮以循环方式显示/隐藏元素的无序列表。页面加载，显示第一个元素，单击按钮，显示的元素被隐藏并显示下一个......有点像在幻灯片中单击下一个。问题是我不知道如何在第一个 if 语句之后停止或重置点击功能。触发该功能现在将它们全部撕开。有人可以看看我的代码并帮帮我吗？

```
var daily = '.daily_goal_activity li';   

$(daily).addClass(function (index) {
        return "item-" + index;
    });
    $('.item-0').show();
});

$('#activity_toggle').click(function () {
    $(daily).hide();

    if ($(daily).hasClass('item-0')) {
        $('.item-1').show();
    }
    if ($(daily).hasClass('item-1')) {
        $('.item-2').show();
    }
}); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-17T21:54:29.490

如果它们是列表元素，那么它们是兄弟姐妹，对吗？

您可以获取对当前可见元素的引用，将其隐藏并显示下一个兄弟元素。

假设所有列表元素最初都是隐藏的，并且只有具有该类的元素`current`是可见的，那么它将类似于：

```
var $daily = $('.daily_goal_activity li');
$daily.first().addClass('current');

$('#activity_toggle').click(function () {
    $daily.filter('.current')
      .removeClass('current')
      .next('li').addClass('current');
}); 
```

如果你想循环遍历元素，你可以检查是否真的有下一个兄弟，如果没有，回到第一个：

```
var $next = $daily.filter('.current')
    .removeClass('current')
    .next('li');

if($next.length === 0) {
    $next = $daily.first();
}

$next.addClass('current'); 
```

[**演示**](http://jsfiddle.net/Hbqbu/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-17T21:57:13.673

几点。

1.  存储`'.daily_goal_activity li'`和重复使用它并不能真正为您节省任何东西。您真的想存储选择器并重用它： `var daily = $('.daily_goal_activity li');`
2.  `.hasClass('item-0')`将永远是正确的，因为其中一个`li`s 将具有 class `item-0`，因为您在`.addClass()`.
3.  为了使您的代码以其当前形式工作，您需要隐藏`x`和显示`x+1`. 您可以使用全局 var 来跟踪`x`.
4.  您最好使用 html 的结构为您跟踪下一个/上一个：

```
var daily = $('.daily_goal_activity li');

daily.hide().first().show();

$('#activity_toggle').click(function () {
    var nextdaily = daily.filter(':visible').hide().next();
    if(nextdaily.length > 0) {
        nextdaily.show();
    } else {
        daily.first().show();
    }
}); 
```

演示：http: [//jsfiddle.net/jtbowden/yRFba/](http://jsfiddle.net/jtbowden/yRFba/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-17T22:03:33.660

好吧，也许你看起来像这样：

[在这里提琴](http://jsfiddle.net/3pkum/)

```
 var changeClass=function(){

   if($('ul li.active').length==0){
    $('ul li:first').addClass('active');
    }
else if($('.active').index()==4){
    $('.active').removeClass('active')
    $('ul li:first').addClass('active');
}
else{
     $('.active').removeClass('active').next('li').addClass('active')
     }

  }

     $(document).ready(function() {
     $('.button').click(function(){

     changeClass();

     });
 }); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-17T22:09:44.287

```
var daily = $('.daily_goal_activity li');   
daily.addClass(function (index) { return "item-" + index; }).hide();
$('.item-0').show();

$('#activity_toggle').click(function () {
    daily_num = daily.filter(':visible').index();
    daily.hide().eq(daily_num+1).show();
});​ 
```

[小提琴](http://jsfiddle.net/7Q6be/)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-06-18T13:15:15.493

单键切换隐藏/显示

```
 <!DOCTYPE html>
    <html>
    <head>
    <script type="text/javascript" src="jquery.js"></script>
    <script type="text/javascript">
    $(document).ready(function(){
    $("button").click(function(){
        var id=$("button").attr("id");
        if(id=="hide")
        {
                $("#example").hide();
                $(this).html("Show");
                $(this).attr({"id":"show"});

        }
        else
        {
             $("#example").show();
             $(this).html("Hide");
             $(this).attr({"id":"hide"});
        }

      });
    });
    </script>
    </head>

    <body>
    <button id="hide">Hide</button>
    <p id="example">Hide me out</p>
    </body>
    </html> 
```

# visual-studio - 如何修复损坏的 Visual Studio 项目依赖项？

> ID：10199642
> 
> 赞同：4
> 
> 时间：2012-04-17T21:44:27.763
> 
> 标签：visual-studio, svn, projects-and-solutions

我正在为一个客户从事一个项目，其中一个解决方案有 3 个项目。项目 A 是基础，项目 B 依赖于 A，项目 C 依赖于 B。顺便说一下，项目 C 是应用程序，A 和 B 是类库。

通常，我可以在项目 A 中进行更改，而无需手动重新编译 B 和 C，因为 Visual Studio 会自动为我完成。

但是，在这种环境下（通过 Ankh SVN 下载解决方案后），执行时有些依赖项无法识别。我被迫手动重新编译依赖层次结构的主要项目。

为什么会这样？以及如何解决？谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-17T21:55:24.510

确保将项目 B 和项目 C 的引用添加为*项目*，并且没有将项目输出添加为*程序集*引用。

# java - JPA/Glassfish：persistence.xml 被忽略了吗？

> ID：10199643
> 
> 赞同：0
> 
> 时间：2012-04-17T21:44:28.917
> 
> 标签：java, hibernate, jpa, glassfish

我目前有一个问题。

我有一个定义 Bean 并实现它的小项目，此外该项目包含一些用于休眠的模型方案。

Bean 实现看起来像这样：

```
 public class TestBean implements TBean {

    @PersistenceContext
    protected EntityManager em;

    public TestBean() {
    }

    public void createEntries(User user) {
           em.persist(user);
       }
 } 
```

我认为这应该可以正常工作。

我现在的问题是，我在persistence.xml 中做了一些更改，但所有这些更改似乎都被忽略了。我什至删除了 persistence.xml 的全部内容并将其中的文本更改为完全废话 - 没有任何变化。我现在的问题是，如果 glassfish 以某种方式缓存 persistence.xml，如果是，我该如何避免这种缓存，如果现在 - 我做错了什么？

非常感谢 ：）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-18T19:05:06.670

检查您正在部署的工件：在归档程序中打开实际的 jar 文件并验证该文件是否存在于`META-INF/`文件夹中（如果您正在部署 EJB 模块）或`WEB-INF/classes/META-INF/`（如果是 .war）中。

# javascript - Sencha vs Wavemaker

> ID：10199645
> 
> 赞同：-3
> 
> 时间：2012-04-17T21:44:31.097
> 
> 标签：javascript, extjs, vmware, sencha-architect

我正在尝试在 Sencha Architect 2 和 Wavemaker 之间做出决定。它们看起来都非常相似。当然 Wavemaker 是完全开源的，而 Sencha 只是部分开源。出于这个原因，我倾向于 Wavemaker，但考虑到两者的学习曲线，我不想以后发现自己的选择更少，只是因为我试图节省一些钱。以下是我的主要担忧。

1- 我希望能够在不泄露源代码的情况下出售我的应用程序。

2- 生产力当然是最重要的。他们都差不多吗？

3- 数据库开发工具。

4-易于部署和托管选项。

无论哪种方式的意见都非常感谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-17T22:02:20.197

Wavemaker 对我来说是目前最好的工具..

1.on javascript 可以使用一些工具来混淆代码 2.WYSIWYG..visual 工具，带有很酷的 ajax 小部件拖放和离线所有免费 3.have 是可以创建您的数据库的模型部件 4.cloudfoundry

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-18T18:35:27.253

完全披露：我在 WaveMaker 上为 VMware 工作。

I felt compelled to correct a few things from Rene’s post. WaveMaker is not strictly a backend framework. WaveMaker is a visual, drag-and-drop development tool. Applications created with WaveMaker contain a backend framework (Java, Spring) and a frontend framework (JavaScript, Dojo). Developers enhance their UI by writing JavaScript code.

The comparison to GWT implies that UI development in WaveMaker is done using Java. Although Java is part of the WaveMaker framework, developers do not use Java code to enhance UI functionality. The back-end code is Java, which is used to access databases and other backend services. In most cases WaveMaker developers do not need to modify the Java code. Since WaveMaker produces standard Java/Spring applications it’s easy for a Java developer to extend the backend functionality.

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-18T00:06:24.527

这个问题对我来说没有多大意义。您是在比较 IDE-s 吗？

无论如何，您的选择看起来非常不同。一个主要是前端框架，另一个是后端框架。一个生产 Java 应用程序，另一个生产 JavaScript。也许您应该将 Wavemaker 与基于 Java 的 Ext GWT 进行比较。

鉴于您的第 3 点，您的选择应该是直截了当的，因为您似乎所指的任何 Sencha 前端开发工具中都没有数据库开发工具。Ext GWT 中可能有一些东西，但我一点也不熟悉。

# sql-server - 为什么触发器在使用“插入”表中的字段时尝试插入 NULL 值？

> ID：10199646
> 
> 赞同：3
> 
> 时间：2012-04-17T21:44:38.213
> 
> 标签：sql-server, triggers

我必须将 MSSQL 中所做的更改与远程 MySQL 数据库同步。要同步的更改是向系统添加发票和用户。远程服务器预计不会始终可访问，因此我正在尝试设置一种日志表来存储在 MSSQL 中所做的更改。

这是一个完全有效的触发器：

```
CREATE TRIGGER [dbo].[dokument_insert]
   ON [dbo].[dokument]
   AFTER INSERT
AS 
BEGIN
    SET NOCOUNT ON;
    INSERT INTO [bcg_ekodu].[dbo].[sync_stack] (event,sql, table_name, import_priority)
        SELECT 
            'INSERT',
            'INSERT INTO bills SET
                date = "'+CONVERT(VARCHAR(19),dok_kuup,120)+'", 
                total = "'+CAST(kokkusum AS nvarchar)+'",
                number = "'+RTRIM(dok_nr)+'", 
                created = "'+CONVERT(VARCHAR(19),savetime,120)+'", 
                rounded = "'+CAST(ymardus AS nvarchar)+'",
                currency = "'+CAST(valuuta AS nvarchar)+'", 
                due_date = "'+CONVERT(VARCHAR(19),tasupaev,120)+'", 
                pk_joosep = "'+CAST(dok_kood AS nvarchar)+'",
                joosep_hankija = "'+CAST(hankija AS nvarchar)+'";
             UPDATE
                bills, users, companies 
             SET 
                bills.user_id = users.id,
                bills.imported = NOW()
             WHERE
                bills.imported IS NULL
                AND companies.id = users.company_id
                AND companies.pk_joosep = 10
                AND bills.user_id = users.pk_joosep',
            'bills',
            '200'
        FROM inserted
END 
```

每次将一行插入“dokument”表时，它都会在“sync_stack”表中插入一行。'sql' 列将包含一个 SQL，用于在另一个 (MySQL) 数据库中创建相同类型的行。

但是这个触发器不起作用：

```
CREATE TRIGGER [dbo].[klient_insert]
   ON [dbo].[klient]
   AFTER INSERT
AS 
BEGIN
    SET NOCOUNT ON;
    INSERT INTO [bcg_ekodu].[dbo].[sync_stack] (event,sql, table_name, import_priority)
        SELECT 
            'INSERT',
            'INSERT INTO users SET
                username =10'+CAST(kl_kood as nvarchar)+',
                password = NULL,
                name ="'+LTRIM(RTRIM(kl_nimi))+'",  
                email ="'+CAST(LTRIM(RTRIM(kl_email)) as nvarchar)+'",  
                reference_no ="'+CAST(LTRIM(RTRIM(kl_viide)) as nvarchar)+'",   
                phone ="'+CAST(LTRIM(RTRIM(kl_tel1)) as nvarchar)+'",   
                logins ="'+CAST(0 as nvarchar)+'",  
                last_login = NULL,  
                created ="'+CONVERT(VARCHAR(19),savetime,120)+'",   
                updated = NULL, 
                deleted ="0",   
                address ="'+CAST(LTRIM(RTRIM(kl_aadr1)) as nvarchar)+'",    
                pk_joosep ="'+CAST(kl_kood as nvarchar)+'"',
            'users',
            '210'
        FROM inserted
END 
```

虽然执行上述 SQL 以创建该触发器可以正常完成，但当我尝试将一些行插入“触发”表时，我收到以下错误：

```
No row was updated.

The data in row 175 was not committed.
Error Source: .Net SqlClient Data Provider.
Error Message: Cannot insert the value NULL into column 'sql', table 'mydb.dbo.sync_stack'; column does not allow nulls. INSERT fails.

The statement has been terminated.

Correct the errors and retry or press ESC to cancel the change(s). 
```

*   如果我删除此触发器，则不会发生此错误。
*   如果我只为“sql”列插入纯文本，它会按预期工作。
*   如果我使用插入行中的任何字段，即使只是一个文本字段，它也会再次失败。
*   如果我在 'sql' 列中允许 NULL 值，插入行会成功，但我在 'sql' 列中得到一个 NULL 值。

如何使第二个触发器也按预期工作？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-04-17T21:52:26.107

我怀疑您要连接到 SQL 语句中的插入值中至少有一个是`NULL`. 您可以通过使用来规避这种情况`COALESCE`，例如

```
username =10'+COALESCE(CAST(kl_kood as nvarchar), '')+', 
```

当然，你不应该在`nvarchar`没有指定长度的情况下声明，对吧？

*   [要踢的坏习惯：在没有（长度）的情况下声明 VARCHAR](https://sqlblog.org/2009/10/09/bad-habits-to-kick-declaring-varchar-without-length)

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-04-17T21:50:24.980

将任何值连接到 NULL 是 NULL：

```
select 'test' + NULL 
```

结果为空，您应该对列使用类似的内容：

```
select isnull(column, '') 
```

这将导致一个空字符串。

# css - Css 悬停工具提示在 JqGrid 中不起作用

> ID：10199659
> 
> 赞同：0
> 
> 时间：2012-04-17T21:46:08.057
> 
> 标签：css, jqgrid

我有一个用于提供指导的 css 工具提示，我正在尝试将它包含在 jqgrid 中。

但是，该列的标题出现在悬停时。`<span>`没有。我尝试添加`title:false`，但没有任何反应。

这是我正在使用的CSS：

```
.tooltip { border-bottom:1px dotted #000000; outline:none; text-decoration:none; cursor:help; }
.tooltip:hover em { padding: .2em 0 .6em 0; font-weight:bold; display:block; }
.tooltip { position:relative; }
.tooltip:hover span { position:absolute; left:1em; top:-4.5em; z-index:99; margin-left:0; width:150px; }
.tooltip:hover em { border:0; margin: -10px 0 0 -55px; float:left; position:absolute; }
.tooltip span { margin-left:-999em; position:absolute; } 
```

以下是它的应用方式：

```
 <a class='tooltip' href='#'>
<img alt='Help' src='/Images/question_mark_sm.png' />
<span class='tooltip_classic info'>Guidance Tag</span>
</a> 
```

不知道为什么它会在 jqGrid 之外的任何地方工作。我已经尝试并尝试过，但它似乎不起作用。（好吧，图像出现了，光标发生了变化，但没有弹出窗口。）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-18T17:06:42.087

尝试从 jqGrid 单元格中删除工具提示属性。

对我来说，它适用于所有浏览器，除了 IE7。我使用了 jqGrig gridComplete 事件。

**这是一个例子：**

```
// _YourColID is you column name from colModel
$("td[aria-describedby*=_YourColID]", "#yourGridID tr").removeAttr("title");
$("td[aria-describedby*=_YourColID]", "#yourGridID tr").tooltip({

  // each trashcan image works as a trigger
  tip: '.tooltip',

  // custom positioning
  position: 'center right',                 

  // move tooltip a little bit to the right
  offset: [0, -10],                 

  // there is no delay when the mouse is moved away from the trigger
  delay: 0,                 
  predelay: 2000,                   
  onShow: function(e){
    if ($(e.target).parent("tr").attr('id') != -1) {
      yourTooltipFunction($(e.target).parent("tr").attr("id"));
    }
  }
}).dynamic({
  bottom: {
    direction: 'down',
    bounce: true
  }
}); 
```

# android - Android 应用发布密钥库密码

> ID：10199674
> 
> 赞同：1
> 
> 时间：2012-04-17T21:47:35.657
> 
> 标签：android, eclipse, rsa, keystore, keytool

我正在尝试在 Eclipse 中导出已签名的 android 应用程序。我进入密钥库对话框并被提示输入密钥库密码。我的密钥库没有密码。无论如何都可以在没有密码的情况下导出应用程序？如果不是我如何更改我的密码？

谢谢

编辑：我遗漏了一些重要信息。我的密钥库不需要密码即可访问它。它是 eclipse 使用的默认调试密钥库。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-17T22:57:12.413

我想你回答了你自己的问题：

> 它是 eclipse 使用的默认调试密钥库。

查看与签署发布相关的开发者文档。您需要创建一个发布密钥库：http: [//developer.android.com/guide/publishing/app-signing.html#releasemode](http://developer.android.com/guide/publishing/app-signing.html#releasemode)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-17T21:51:08.867

在创建密钥库时，您应该被提示输入密码，或者作为命令行参数输入密码。如果您只是在提示输入密码时按 Enter 键，那么您可以在签名时将其留空，但这通常是个坏主意。

# objective-c - 将 objectAtIndex 与多个视图一起使用

> ID：10199678
> 
> 赞同：0
> 
> 时间：2012-04-17T21:47:56.590
> 
> 标签：objective-c, xcode, cocoa, nsview

我的 NSViews 都是我的主视图的子视图。在子视图的子类中，我希望能够访问不同子视图的属性及其方法，所以我得到这样的子视图属性

```
MoveFilter *controller = [[[[[NSApp delegate] window] contentView] subviews] objectAtIndex:0]; 
```

其中 move filter 是我的子类的名称。当我有多个子视图时，我需要将 objectAtIndex: 更改为不同的子视图。我会在数组中设置子视图吗？如果是这样，我该怎么做？谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-17T21:51:26.427

您的子视图已经在一个数组中。您在内容视图上调用的 subviews 方法返回其所有子视图的数组（这就是为什么您可以像在发布的代码中那样在其上调用 objectAtIndex 的原因）。

# php - php cURL 超时和失败

> ID：10199679
> 
> 赞同：0
> 
> 时间：2012-04-17T21:47:56.583
> 
> 标签：php, curl

我如何知道使用 cURL 建立的连接是否超时（使用相对选项）或通常失败？我只能输出响应正文/标题，对吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-17T21:50:54.337

您可以在 curl_exec 之后调用 curl_error 或 curl_errno。

[http://www.php.net/manual/en/function.curl-error.php](http://www.php.net/manual/en/function.curl-error.php)

# linq - LINQ 运算符“==”不能应用于“方法组”和“int”类型的操作数

> ID：10199680
> 
> 赞同：24
> 
> 时间：2012-04-17T21:48:00.467
> 
> 标签：linq

我有以下内容：

```
 var lst = db.usp_GetLst(ID,Name, Type);

    if (lst.Count == 0)
    {

    } 
```

我在 lst.Count == 0 下得到了一个大谎言，它说：

运算符“==”不能应用于“方法组”和“int”类型的操作数

* * *

## 回答 #1

> 赞同：81
> 
> 时间：2012-04-17T21:49:58.523

[`Enumerable.Count`](http://msdn.microsoft.com/en-us/library/system.linq.enumerable.count.aspx)是扩展方法，而不是属性。这意味着`usp_GetLst`可能返回（或某些等价物），而不是您期望的或`IEnumerable<T>`的衍生物。`IList<T>``ICollection<T>`

```
// Notice we use lst.Count() instead of lst.Count
if (lst.Count() == 0)
{

}

// However lst.Count() may walk the entire enumeration, depending on its
// implementation. Instead favor Any() when testing for the presence
// or absence of members in some enumeration.
if (!lst.Any())
{

} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2021-10-07T05:15:24.323

有时在视图顶部添加模型会丢失，那时你会得到同样的错误，例如。- @model 列表<Test.Admin.Models>

# .net - 从 .NET 应用程序调用时，为什么 SQL 参数会为空？

> ID：10199684
> 
> 赞同：1
> 
> 时间：2012-04-17T21:48:22.997
> 
> 标签：.net, sql-server-2008

使用[这种](http://msdn.microsoft.com/en-us/library/ms186918.aspx)技术，我正在汇集大量记录，这些记录要作为 XML 从 .NET 4.0 应用程序传递到 SQL Server (2008R2) proc。proc 准备 XML 并使用 OPENXML 加入它（或者至少当我让它工作时）。

当代码执行时，.NET 似乎正确地构建了参数并将其添加到 SQL 命令中，但是当它调用 SQL Server 时，SQL Profiler 将参数显示为空。

```
exec jcsdmp_UpdateMultiDocumentSendStatus @pUpdateStatusesXML=NULL 
```

调用代码：

```
SqlParameter[] UpdateParams = new SqlParameter[1];
UpdateParams[0] = new SqlParameter("@pUpdateStatusesXML", SqlDbType.NText, sb.ToString().Length, sb.ToString());

SqlAccess.ExecuteNonQuery("docmgmt", "jcsdmp_UpdateMultiDocumentSendStatus", CommandType.StoredProcedure, UpdateParams); 
```

是的，我一直在研究自定义 SqlAccess 类（主要检查参数、打开连接等——没有真正的魔法），但到目前为止，.NET 认为它正在发送参数......

是否有我可能缺少的尺寸限制或类似的东西？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-17T21:56:07.577

对于您使用的`SqlParameter`构造函数[重载，第四个参数不是值而是](http://msdn.microsoft.com/en-us/library/f38c3x2s.aspx)[源列](http://msdn.microsoft.com/en-us/library/system.data.sqlclient.sqlparameter.sourcecolumn.aspx)。

您是否尝试过使用[接受 value 的构造函数重载，](http://msdn.microsoft.com/en-us/library/0881fz2y.aspx)它会推断类型和大小？

```
UpdateParams[0] = new SqlParameter("@pUpdateStatusesXML", sb.ToString()); 
```

如果需要，您可以在此之后显式设置 SqlDbType（它可能会推断 NVarChar）：

```
UpdateParams[0].SqlDbType = SqlDbType.NText; 
```

# biztalk - 在 EDI 入站和出站流程中使用 BAM

> ID：10199686
> 
> 赞同：0
> 
> 时间：2012-04-17T21:48:36.793
> 
> 标签：biztalk, biztalk-2010, edi, biztalk-bam

我们可以在 EDI 中使用 BAM 的哪些功能？

我知道 BAM 基础知识，但我不知道如何在 EDI 入站和出站流程中使用 BAM。

所以我的问题是我们如何在 EDI 入站和出站流程中使用 BAM 功能？

谁能告诉我我们可以跟踪什么以及如何在 EDI 入站和出站流程中使用 BAM？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-24T02:10:55.127

无论是 EDI 还是您所针对的任何场景，都有多种实现 BAM 的方法，您可以使用内置拦截器 (TPE) 或使用 API 调用编写自己的方式。我通常不喜欢 TPE，因为它很僵化，我会使用 BAM API 调用。这是一份不错的白皮书，您可以阅读。

[面向开发人员的业务活动深度监控](http://msdn.microsoft.com/en-us/library/dd320628.aspx)

# git - 删除过去大量提交中添加的文件

> ID：10199693
> 
> 赞同：1
> 
> 时间：2012-04-17T21:49:16.763
> 
> 标签：git, github

在过去的 30-40 次提交中，我包含了一个文件夹，我才意识到我不应该这样做。

我主要担心的是，当我将这些更改推送到 Github 时，由于这些文件的大小，这将需要一段时间......

**有没有办法从过去的提交中完全删除该文件夹（或某些文件）？**

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-17T21:54:38.463

您很可能想要使用`git filter-branch`. Github 有一个相当不错的教程如何在[这里](http://help.github.com/remove-sensitive-data/)使用它。

以下行应该可以解决问题：

```
git filter-branch --index-filter 'git rm --cached --ignore-unmatch -r <path>' --prune-empty -- --all 
```

`-r <path>`如果要删除文件夹，请确保您正在使用。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-17T21:52:16.837

您可以通过执行交互式变基来编辑 Git 中的历史记录。在引入文件夹和`git rebase -i <that commit id>`.

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-17T21:59:45.610

您可以使用 git filter branch`git filter-branch --index-filter 'git rm --cached --ignore-unmatch YOURFOLDER' --prune-empty -- --all`此命令将运行所有提交，删除您可以正常推送的 YOURFOLDER，因为您尚未推送它。我经常使用这个命令。

# seo - SEO - META 标签和谷歌

> ID：10199696
> 
> 赞同：-1
> 
> 时间：2012-04-17T21:49:38.787
> 
> 标签：seo

我刚刚发现 Google 最近决定在显示搜索结果时开始使用自己的“标题”。此外，在检查了雅虎和必应之后，我发现他们显示结果的方式与谷歌相同，但完全不同。

我想我的问题是，如果有一种实际的“正确”方式向我的页面添加标题，以便 Google 显示我想要的内容，并且这种方式与当前正在使用该页面的 Yahoo/Bing 获得相同的结果标题作为搜索结果（有时他们会选择第一个标签并将其用作标题）。

任何建议或链接以进行更多研究将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-17T22:55:17.477

你真的无能为力。谷歌将根据他们尚未公开的标准选择要显示的标题。这通常是在`<title>`标签中找到的页面标题，但如果 Google 认为不同的标题可以更好地总结页面的内容，他们可能会选择显示其他内容。

您可以尝试更改页面标题以更好地反映页面内容，看看是否有帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-02-10T10:34:59.197

根据指南在元标记中使用最佳关键字显着性……Google 会选择您的元标记。查看我们新闻门户的来源和元数据（关键字：hírek、választás 2014 等）： http: [//valasztas2014.hir24.hu/](http://valasztas2014.hir24.hu/)

# python - WebFaction 中 Python 程序的 RESTful Web 服务或 API

> ID：10199697
> 
> 赞同：1
> 
> 时间：2012-04-17T21:49:42.480
> 
> 标签：python, web-services, api

我已经开发了一些我想在线提供的 python 程序。我是 Web 服务的新手，我不确定我需要做什么才能创建一个有人向 URL 发出请求的服务（例如），并且该 URL 会触发一个 Python 程序，该程序会在用户的浏览器中显示某些内容，或者通过浏览器向程序提供一组输入，然后 python 做它应该做的任何事情。我正在使用谷歌应用引擎，它在教程中运行良好，并计划使用它，因为它看起来很简单，但 GAE 的问题是它不能很好地工作（或根本不能工作）与一些库我打算使用的。我想我想做的是使用我的 WebFaction 帐户的某种 API。谁能指出我正确的方向？我在 WebFaction 中有哪些选择？最简单的工具有哪些？非常感谢您提前提供的帮助。干杯

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-26T11:32:15.723

好吧，你的问题有点笼统，但这里有一些指针/提示：

*   Webfaction 允许你安装几乎任何你想要的东西（你需要编译它/或要求管理员为你安装一些 CentOS 软件包）。

*   它们提供了一些带有 mod_wsgi 的默认 Apache 服务器，因此您可以运行 web2py、Django 或任何其他 wsgi 框架。

*   大多数流行的 Python Web 框架在 Webfaction 中都有可用的安装程序（web2py、django...），所以我建议您使用其中之一。

*   我还将安装 supervisord 以在某些重新启动/崩溃/问题后保持您的服务运行。

如果您有任何具体问题，我很乐意为您提供帮助...

# asp.net - 从后面的代码中设置标签的可见性

> ID：10199698
> 
> 赞同：0
> 
> 时间：2012-04-17T21:49:47.853
> 
> 标签：asp.net

在 asp.net 我有这个标签：

```
<asp:Label ID="Label3" runat="server" Text="0" visible='<%# visibleCredits() %>'></asp:Label> 
```

在后面的代码中我有：

```
protected bool visibleCredits()
{
    return false;

} 
```

但是标签总是显示出来，我认为它应该是不可见的。请不要问我为什么不设置：

> Label3.Visible = visibleCredits();

从后面的代码。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-17T22:06:10.477

将此添加到您的页面：

```
protected void Page_Load(object sender, EventArgs e)
{
    DataBind();
} 
```

它将您的页面绑定到服务器控件，并允许您使用这样的数据绑定。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-17T22:10:40.527

正如 Vache 所建议的，您需要调用 DataBind()，因为您使用的是数据绑定语法`<%# visibleCredits() %>`。或者，您也可以使用`<%= visibleCredits() %>`而不需要调用 DataBind()。

# jquery - ie8 中嵌套元素的 jQuery/css 淡入淡出问题（仅限）

> ID：10199702
> 
> 赞同：1
> 
> 时间：2012-04-17T21:49:59.710
> 
> 标签：jquery, png, jquery-animate, fade, alpha-transparency

> **可能重复：**
> [在 IE8 jQuery 循环中消失的图像](https://stackoverflow.com/questions/10196819/disappearing-images-in-ie8-jquery-cycle)

我正在淡入和淡出一组嵌套元素，以显示页面的背景图像。嵌套的 div/article 元素已被赋予 alpha 通道不透明度，并且在 IE 中被半透明 png 覆盖。

FF、Chrome、ie6（是的，ie6 ！！！）、ie7 和 ie9 中的淡入和淡出工作正常，但遗憾的是在 ie8 中不行。

HTML：

```
<div id="wrapper">
   <div id="limiter">
      <div id="mainContent" class="cornerRadius10 alpha40Black">
         <header class="cornerRadius6 alpha50Black">
            <h1>Title Here</h1>
         </header>
         <article class="contentArticle cornerRadius6 alpha50Black">
            Content here.
         </article>
         <article class="contentArticle cornerRadius6 alpha50Black">
            More content here.
         </article>
      </div>
   </div>
</div> 
```

CSS：

```
.alpha40Black {
    /* Fallback for web browsers that doesn't support RGBa */ 
    background: rgb(0, 0, 0);
    background: url("../images/blk-40.png");
    /* RGBa with 0.4 opacity */ 
    background: rgba(0, 0, 0, 0.4)
}
.alpha50Black {
    /* Fallback for web browsers that doesn't support RGBa */ 
    background: rgb(0, 0, 0);
    background: url("../images/blk-50.png");
    /* RGBa with 0.5 opacity */ 
    background: rgba(0, 0, 0, 0.5)
} 
```

jQuery：

```
 $('#wrapper').children().animate({
    opacity: 0
 }, 2000 );

 setTimeout(function() {
    $('#wrapper').css('visibility' , 'hidden');
 }, 2000); 
```

我也试过这个jQuery：

```
 $('#limiter').children().fadeOut( 2000 ); 
```

上述的任何组合都将适用于除 ie8 之外的所有浏览器。当您尝试将淡出或淡入功能应用于包装父元素时，所发生的只是有一个暂停（淡出动画设置的时间长度），然后您想要淡出的元素立即消失，没有淡化效果。

我已经为此工作了几天，并用尽谷歌的解决方案和可能的修复/解决方法，甚至没有什么能接近。

有人有想法么？

问候，马特。

编辑：

我在调试这个问题方面取得了一些进展。

我删除了对半透明背景的所有引用，并尝试应用 jQuery 淡入淡出动画来检查背景是否没有掩盖真正的问题。

有趣的是，即使没有应用半透明背景（也测试了完全不透明的背景），淡入淡出动画仍然不起作用。完全一样的症状。所以我快速搜索并在 jQuery Bug Tracker 上找到了这个：[fade not working on inner divs in ie8](http://bugs.jquery.com/ticket/5033)

根据此页面上的评论，我申请`filter: inherit;`了子容器，这有所作为。现在内容（文本和图像）淡入淡出，但背景（不透明或（半）透明）不是。它在延迟期间仍然保持不变，然后突然变为不可见。

有人对如何进一步解决此问题有任何想法吗？

编辑：

在ie9中测试，它工作得很好。此错误仅与 ie8 相关。

谢谢，马特。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-18T13:32:35.570

我不确定这是否是您的问题，但我认为您设置的背景错误：

```
.alpha40Black {
    /* Fallback for web browsers that doesn't support RGBa */ 
    background: rgb(0, 0, 0);
    background: url("../images/blk-40.png");
    /* RGBa with 0.4 opacity */ 
    background: rgba(0, 0, 0, 0.4)
} 
```

[`background`](http://www.w3.org/TR/CSS21/colors.html#propdef-background)是一个快捷方式属性，用于同时设置多个值。如果你在做的时候遗漏了子值，那么它会重置其他值。您应该改用单独的背景属性：

```
.alpha40Black {
    /* Fallback for web browsers that doesn't support RGBa */ 
    background-color: rgb(0, 0, 0);
    background-image: url("../images/blk-40.png");
    /* RGBa with 0.4 opacity */ 
    background-color: rgba(0, 0, 0, 0.4)
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-17T22:04:13.053

在你的 CSS 上试试这个：

```
.alpha40Black {
    /* Fallback for web browsers that doesn't support RGBa */ 
    background: rgb(0, 0, 0);
    background: url("../images/blk-40.png");
    /* RGBa with 0.5 opacity */ 
    background: rgba(0, 0, 0, 0.4);
    /* This works in IE 8 & 9 too */
    /* ... but also 5, 6, 7 */
    filter: alpha(opacity=40);
}
.alpha50Black {
    /* Fallback for web browsers that doesn't support RGBa */ 
    background: rgb(0, 0, 0);
    background: url("../images/blk-50.png");
    /* RGBa with 0.5 opacity */ 
    background: rgba(0, 0, 0, 0.5);
    /* This works in IE 8 & 9 too */
    /* ... but also 5, 6, 7 */
    filter: alpha(opacity=50);
} 
```

如果您对其他浏览器没有其他问题，这应该可以工作...诅咒您必须相应地更新 jquery

编辑：

```
jQuery:
$('#wrapper').children().animate({
    opacity: 0.4,
    filter: 'alpha(opacity=40)'
 }, 2000 ); 
```

这是一个示例 jquery，它从不透明度到 0.4 进行动画处理。如果您希望在页面加载后具有标准不透明度，则不需要诅咒 jquery，但如果您需要在一个触发事件上更改元素不透明度，则必须使用这样的 jquery。

编辑：

如果我的问题正确，我在[jsFiddle](http://jsfiddle.net/J67Dr/16/)中提出了解决方案。我无法在旧版 ie 中测试它。我希望这有效:)

# php - PHP联系表单处理程序不起作用？

> ID：10199703
> 
> 赞同：1
> 
> 时间：2012-04-17T21:50:04.967
> 
> 标签：php, forms, email, redirect, handler

我需要一个非常简单但有效的 PHP 表单处理程序来处理这个表单：

```
<form id="contact" method="post" action="contact_handle.php">
<label for="name">Name:</label>
<input type="text" class="text_style" placeholder="John Doe" name="name" /><br />
<label for="email">Email:</label> 
<input type="email" class="text_style" placeholder="email@example.com" name="email" /><br />   
<label for="message">Subject:</label>
<textarea class="areawidth" rows="4" name="message" /></textarea><br />
<button id="contactbutton" type="submit">Submit</button>
</form> 
```

这是我目前拥有的，但它不会发送电子邮件，也不会像我预期的那样重定向。而且我似乎无法弄清楚发生了什么。

```
<?php  
$invalid = '';
$my_email = 'my@email.com'; 

// Validate input:
if(empty($_POST['name'])  ||
   empty($_POST['email']) ||
   empty($_POST['message']))
{
    $invalid.= "\n All fields are required";
}
$name = $_POST['name'];
$email = $_POST['email'];
$message = $_POST['message'];   

// Validate email:
if (!preg_match(
"/^[_a-z0-9-]+(\.[_a-z0-9-]+)*@[a-z0-9-]+(\.[a-z0-9-]+)*(\.[a-z]{2,3})$/i",
$email))
{
    $invalid .= "\n Invalid email address";
}

// Send email if no errors detected:
if( empty($invalid))
{
$to = $my_email;
$subject = "Contact form submission: $name";
$body = "You have received a new message. ".
" Here are the details:\n Name: $name \n ".
"Email: $email\n Message:\n $message";
$headers = "From: $email\n";
$headers .= "Reply-To: $email";
mail($to,$subject,$body,$headers);  

//redirect to the thank you page:    
header('Location: contact_thanks.php');
}
?> 
```

提交后，它会将我带到显示空白且无法重定向的contact_handle.php。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-17T21:53:32.687

如果您提供所有代码，问题是您的表单抛出错误（通过向 中添加文本`$invalid`，但没有代码可以处理`$invalid` *不*为空的情况。要解决此问题，请在最后关闭后添加`}`：

```
echo $invalid; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-17T21:57:00.990

我认为重定向必须是浏览器的第一个输出，所以如果输出其他任何内容，它将不起作用。

你为什么不只包括感谢页面而不是重定向到它，即。

```
include 'contact_thanks.php'; 
```

# r - 大数上的 ggplot2 Dollar_format 产生科学记数法

> ID：10199708
> 
> 赞同：2
> 
> 时间：2012-04-17T21:50:26.527
> 
> 标签：r, ggplot2

在 ggplot 中使用新的 Dollar_format() 语法，我得到了意想不到的行为。是否（还有）另一个论点可以让 sci-not 消失？

```
x <- seq(0,100000,10000)
[1] 0e+00 1e+04 2e+04 3e+04 4e+04 5e+04 6e+04 7e+04 8e+04 9e+04 1e+05
dollar(x)
[1] "$0e+00" "$1e+04" "$2e+04" "$3e+04" "$4e+04" "$5e+04" "$6e+04" "$7e+04" "$8e+04" "$9e+04" "$1e+05" 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-17T22:28:22.670

请注意，该`dollar`功能现在在`scales`包中。`scipen`您可以使用该选项阻止它切换到科学记数法。请注意，这将影响您的所有输出，而不仅仅是这种格式。

```
> options(scipen=5)
> dollar(x)
 [1] "$0"       "$10,000"  "$20,000"  "$30,000"  "$40,000"  "$50,000"  "$60,000" 
 [8] "$70,000"  "$80,000"  "$90,000"  "$100,000" 
```

不过，正如@joran 所说，`dollar`可能根本不应该允许科学记数法。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-17T22:28:43.670

根据我的评论，这样的事情应该有效：

```
dollar1 <- function (x) 
{
  x <- round_any(x, 0.01)
  nsmall <- if (max(x, na.rm = TRUE) < 100) 
    2
  else 0
  stringr::str_c("$", format(x, nsmall = nsmall, trim = TRUE, big.mark = ",",scientific = FALSE))
} 
```

如果您不想`str_c`直接使用调用`::`，则需要确保`stringr`已加载库。

# browser - 如何从 CFC 文件跟踪或记录

> ID：10199718
> 
> 赞同：2
> 
> 时间：2012-04-17T21:51:37.897
> 
> 标签：browser, coldfusion, cfc

有没有办法通过像 firebug 或其他浏览器插件这样的胸罩来从 cfc 文件中进行跟踪或记录控制台。

如果这似乎是一个愚蠢的问题，我对 CF 完全陌生，很抱歉。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-17T23:04:32.320

如果您希望日志在浏览器中可见，ColdFire 是您的最佳选择。有了它，您甚至可以在生产站点上查看 ColdFusion 的所有扩展调试信息。除非您通过 ColdFire 进行了正确的身份验证，否则服务器不会吐出扩展信息。

正如@gillesc 推荐的那样，您可以使用从 ColdBox 框架中提取的 LogBox。ColdBox 框架有一个调试模式，允许您将消息跟踪到页面底部，或者跟踪到单独的窗口。这即使在生产站点上也很有用，因为您可以观察其他用户的跟踪方法。

最后，您可以简单地使用打印到控制台`writeDump(var="my log message",output="console")`进行快速调试 - 或者 - 使用`<cflog>`标签将日志消息保存到可以使用 tail 监控的命名日志文件。对于一个非常简单的解决方案，您可以将日志文件保存到站点的根目录，然后只需按 F5 即可查看新的日志条目；但是，我不推荐这种做法（除非您要保存信用卡信息并与我共享该文件 :)。

希望这个回复有帮助。

亚伦

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-17T23:05:26.773

有一个[cftrace](http://help.adobe.com/en_US/ColdFusion/9.0/CFMLRef/WSc3ff6d0ea77859461172e0811cbec22c24-7c00.html)标记可让您将输出记录到控制台，以及应用程序和开发环境中的其他位置。

```
<cftrace category="init data" type="Information" var="myvartooutput" /> 
```

调用这个标签会在几个地方输出相关内容：

1.  ColdFusion Builder 中的控制台，如果您使用的是该 IDE
2.  在 Dreamweaver 中，Adobe 文档提到了服务器调试选项卡/视图（我不使用 DW，所以不确定）
3.  在调试输出中的请求结束时
4.  在您的日志目录 (/COLDFUSION/INSTALL/DIR/logs/cftrace.log) 中的 cftrace.log 中

您还可以使用标记[cflog](http://help.adobe.com/en_US/ColdFusion/9.0/CFMLRef/WSc3ff6d0ea77859461172e0811cbec22c24-7d0d.html)将数据写入标准日志文件之一，或者您可以选择让它将所需数据写入自定义日志文件。

```
<cflog file="customlog" application="no" text="Output #somevar#!" /> 
```

如果“customlog”不存在，CF 将为您创建它（在上面提到的相同位置）。

希望有帮助！

编辑：我提供了更多使用 Firebug 的替代方法……如果您想要日志/跟踪但不一定与浏览器/插件结合。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-17T21:56:06.050

如果你有 CF Builder，你实际上可以设置一个调试器，但它非常慢。以下是相关文档：http: [//help.adobe.com/en_US/ColdFusionBuilder/Using/WS0ef8c004658c1089-31c11ef1121cdfd6aa0-7fff.html](http://help.adobe.com/en_US/ColdFusionBuilder/Using/WS0ef8c004658c1089-31c11ef1121cdfd6aa0-7fff.html)

还有 ColdFire，它是一个 Firebug 插件。以前从未使用过，但我听到了好消息：[https ://github.com/nmische/ColdFire/](https://github.com/nmische/ColdFire/)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-18T10:40:43.710

尝试使用 ColdFire 进行萤火虫扩展

[http://coldfire.riaforge.org/](http://coldfire.riaforge.org/)

# asp.net-mvc - 在 MVC Razor 中保留数据而不在请求之间使用 TempData

> ID：10199721
> 
> 赞同：4
> 
> 时间：2012-04-17T21:51:44.880
> 
> 标签：asp.net-mvc, asp.net-mvc-3, razor, persistence, tempdata

如何在 MVC Razor 中保留数据而不在请求之间使用 TempData？

我看到我们什么时候可以使用 TempData ，[但](http://rachelappel.com/when-to-use-viewbag-viewdata-or-tempdata-in-asp.net-mvc-3-applications)不想使用 TempData ，因为它会在机器上创建一个状态。

谢谢， 阿尼什

编辑：我想在允许用户对名称、年龄等字段进行排序的视图页面中保留以前的排序方向。

修复：我使用 ViewBag 修复了它。以前的排序字段/方向使用 ViewBag 从控制器发送到视图，然后在下次单击时将其作为查询字符串传递回。

好的修复：我处理了 .js 文件中的所有内容，例如检查，然后在 Controller 中设置上一个排序字段和上一个排序目录。

这就是我最终所做的。我使用 ViewBag 将先前的详细信息发送到 ViewPage，并根据当前用户操作在 .js 中进行验证，并将其以表单数据的形式传递回控制器。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-17T21:56:57.563

在客户端页面中维护状态是打破 HTTP 无状态概念的东西。为什么要保持状态？如果您正在寻找将某些数据从控制器操作传递到相应视图的解决方案，我建议您使用 ViewModel，在其中填充下拉数据并将该 ViewModel 对象发送到强类型视图。您将在那里获得您的数据。此外，如果您需要一些数据，您还应该在每个请求中从 DataLayer（从表/或缓存等）中获取数据。您可以在查询字符串中传递相关的 id 以获取相应的数据。

正如 RTigger 所提到的，您可以在会话中存储一些数据。这将在所有页面上可用，直到该会话的生命周期。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-17T21:57:14.837

我最近没有做很多 ASP.NET MVC 3，但我认为可以跨请求保存数据的唯一真正方法是使用会话状态、cookie 或通过将数据发布到每个请求的服务器。

ViewData、ViewBag 和 TempData 在每个请求结束时都被有效地杀死，而会话状态、cookie 和发布数据在每个请求开始时基于来自客户端浏览器的信息可用。

您要为什么特定场景保留数据？

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-18T06:14:03.013

如果您发布表单，您可以将参数设置为隐藏的输入字段。但是，如果您要通过 HTTPGET 调用操作，那么您可以使用 QueryString 参数传递值。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-04-18T06:07:40.923

您可以在重定向时将这些值作为查询字符串参数传递。

# eclipse - 如何使用 GWT 和（常规 servlet）Jetty 后端设置 Eclipse

> ID：10199722
> 
> 赞同：3
> 
> 时间：2012-04-17T21:51:53.243
> 
> 标签：eclipse, gwt, jetty

有人知道如何在 Eclipse 中使用 GWT 和码头后端（常规 Web 应用程序，而不是应用程序引擎）设置项目吗？或者知道一个好的链接（尝试谷歌搜索，但没有骰子）

我整个晚上都在尝试设置它，但遇到了一些奇怪的问题，有些似乎是 WST/Jetty 中的错误，另一个是主机页面不起作用:-(

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-19T10:10:37.667

与 GWT 一起运行您自己的码头服务器有三种方法。

如果您运行自己的码头服务器，则必须使用`-noserver`参数在 GWT 中调用 dev-mode，或者您可以使用解决方案一`-server JettyLauncher`

1.  使用您自己的`JettyLauncher.class`或使用[gwt-jetty](http://code.google.com/p/gwt-jetty/)。
2.  使用[Jetty maven 插件](http://docs.codehaus.org/display/JETTY/Maven+Jetty+Plugin)启动码头服务器（有关信息，请参见[此处](http://techeyes.blogspot.com/2007/06/up-and-running-with-gwt-and-maven-2.html)和[此处](http://missinglinkblog.com/2011/03/02/gwt-and-maven-jetty-plugin/)）
3.  使用[Jetty WTP plugin](http://wiki.eclipse.org/Jetty_WTP_Plugin) for eclipse 来启动一个 jetty 服务器。

我个人使用解决方案 3（Jetty WTP 插件）为我的 GWT 项目启动了一个自定义的 Jetty 7 服务器，它工作正常。

# c++ - 生成 (void *) 数据的哈希键

> ID：10199724
> 
> 赞同：1
> 
> 时间：2012-04-17T21:51:57.283
> 
> 标签：c++, hashtable, hash, ns-3

我想知道如何生成无效数据的哈希键。

我正在开展一个网络和处理数据包的项目。我必须生成哈希表。在哪个数据包头上进行散列。但我不知道数据包头的结构或类别。所以，关于这个的任何想法。我只是想将其转换为无效。并对无效数据进行散列以生成散列键。

任何其他想法。GOOD Logic 将受到欢迎。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-18T07:11:30.677

查看[CityHash](http://code.google.com/p/cityhash/source/browse/trunk/README)，它具有我认为适合您输入的功能：

```
// Hash function for a byte array.
uint64 CityHash64(const char *buf, size_t len); 
```

据我所知，将 char 用作输入类型只是为了方便 - 例如，它并不意味着如果函数找到零字节，它将停止散列。

还有一个 128 位版本和其他东西。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-21T01:15:31.813

您可以使用任何接受任何类型指针的散列函数，只要它也接受缓冲区的长度即可。只需投射指针并使用它。大多数散列函数将使用`char *`输入和`size_t`长度。

不过，从您的问题来看，您可能没有标题的长度。如果你没有这个长度，它是行不通的。

# ios - 阴影可见时 iOS 屏幕旋转降级

> ID：10199725
> 
> 赞同：0
> 
> 时间：2012-04-17T21:51:57.400
> 
> 标签：ios, core-animation, uiinterfaceorientation

这不是参考任何特定的代码，但我注意到当我有一个 UIView 有一个阴影添加到它的图层时，在界面方向之间旋转时的动画变得更加滞后/断断续续。

有没有人注意到这个问题或找到了解决方法？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-30T18:56:16.570

使用阴影时， 的`shadowPath`属性会在性能上`CALayer`产生非常（！）显着的差异，尤其是在新 iPad 上。虽然我同意在更改显示方向时禁用阴影是一个好主意，但可能值得一试`shadowPath`（如果您还没有使用它）。尽管路径可以是任何有效`CGPathRef`的，但在大多数情况下，这是您想要的：

```
self.layer.shadowPath = [UIBezierPath bezierPathWithRect:self.layer.bounds].CGPath; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-17T22:07:39.430

就 CPU 时间而言，有些东西非常昂贵。一段时间在 Instruments 中检查一下。

*   阴影
*   贝塞尔路径
*   带有破折号的贝塞尔路径（非常昂贵）

那不是一个完整的列表。我怀疑渐变也会在那里。

如果您发现这些事情正在降低您的动画或重绘，您将需要在`UIViewController`方法中切换它们。

```
-(void)willRotateToInterfaceOrientation:(UIInterfaceOrientation)toInterfaceOrientation duration:(NSTimeInterval)duration
{
//disable shadows + expensive drawing
}

- (void)didRotateFromInterfaceOrientation:(UIInterfaceOrientation)fromInterfaceOrientation
{
//enable shadows + expensive drawing
} 
```

# jquery - Jquery 和 Tumblr 的问题

> ID：10199727
> 
> 赞同：1
> 
> 时间：2012-04-17T21:52:01.847
> 
> 标签：jquery, tumblr, paragraph

我在基于 tumblr 的主页上使用了一个愚蠢的 Javascript 组合，以在悬停时显示随机定位的缩略图，并在点击时获得更大的图片。我有几个问题：

1.  tumblr 会自动将文本放入段落中，这会在链接 1 后面创建一个空格（与“，”一起使用不太好）。

2.  当我制作更大并播放的视频时，它会在显示崩溃时继续播放。

3.  我还没有找到在链接之前的文本后面创建自动换行的解决方案。我希望它看起来像这样：

    Lorem Ipsum 只是印刷和排版行业的虚拟文本。
    链接 1，链接 2

我还必须写两次图像链接，但我可以忍受。

如果有人帮助我，非常感谢。

附言。在此处查看实际操作：[http ://roingbaer.com](http://roingbaer.com)

```
$(".front").each(function() {
 var right = Math.floor(Math.random()*800);
 var top = Math.floor(Math.random()*500);

 $(this).css({'margin-right': right});
 $(this).css({'margin-top': top});
});

hoverdiv = $("div.hover")

hoverdiv.on("hover", function() {
$(this).children(".front").show()
});
hoverdiv.on("mouseleave", function() {
$(this).children(".front").hide()
})
hoverdiv.on("click", function() {
$(this).children(".back").toggle()
$(this).children(".front").hide()
});​ 
```

CSS

```
p { margin:0;
padding:0;
display:inline;
}

.back { 
display:none;
width:100%;
height:100%;
position:fixed;
top:0;
text-align:right;
}

.front
{ 
display:none;
max-height:200px;
max-width:auto;
position:fixed;
z-index:-50;
top:0;
right:100px;
}

img{ 
max-width:inherit;
max-height:inherit;
right:0;
top:0;
}

.hover { 
cursor:pointer;
margin:0;
padding:0;
font-style:italic;
display:inline;
} 
```

HTML

```
 <div class="text">
      <p>Lorem Ipsum is simply dummy</p>
<div class="hover"><a href="http://example.com">text</a>
<div class="front"><img src="http://images.roingbaer.com/ludvig.png"/></div>
</div>
<p>, of the printing and typesetting industry.</p>

<div class="hover">Link 1
<div class="front"><img src="http://24.media.tumblr.com/tumblr_lyz7fjMdnN1rp3eymo1_r2_500.jpg"/></div>
<div class="back"><img src="http://24.media.tumblr.com/tumblr_lyz7fjMdnN1rp3eymo1_r2_500.jpg"/></div>
</div>
<p>,</p>
<div class="hover">Link 2
<div class="front"><iframe frameborder="0" height="233" src="http://www.youtube.com/embed/VMeXGE_a8Gg" width="400"></iframe></div>
<div class="back"><iframe frameborder="0" height="480" src="http://www.youtube.com/embed/VMeXGE_a8Gg" width="853"></iframe></div>
</div>
    </div>

    ​ 
```

# android - ICS CalendarContract RDATE 格式？

> ID：10199734
> 
> 赞同：1
> 
> 时间：2012-04-17T21:52:28.023
> 
> 标签：android

我正在尝试将重复事件添加到 ICS 中的谷歌日历。该代码适用于添加单个事件，但我似乎无法获得结束日期的正确格式。

这是我的代码

```
 values.put(CalendarContract.Events.RRULE, "FREQ=DAILY");
  values.put(CalendarContract.Events.RDATE, "20120325"); 
```

假设结束日期为 2012 年 4 月 25 日，RDATE 字符串的正确格式是什么。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-17T22:08:28.607

它遵循 RDATE 规范 - [http://www.kanzaki.com/docs/ical/rdate.html](http://www.kanzaki.com/docs/ical/rdate.html)

# eclipse - 将 Qt 库链接到 Cmake 项目（在 Eclipse 中）

> ID：10199746
> 
> 赞同：0
> 
> 时间：2012-04-17T21:53:26.877
> 
> 标签：eclipse, qt, libraries

所以我想要做的是在 eclipse 中使用一个简单的 Qt 应用程序，而不使用 eclipse QT 插件，方法是通过 GCC C++ 链接器链接所需的库。但是，我一直无法找到要使用的库的确切名称，或者需要哪些库。我已经找到了我的应用程序似乎正在访问的 Qt 库的路径，但是在构建时仍然出现错误，只是说“-lqt”不存在/找不到等。

我这样做的原因是因为我正在用 OGRE 为 uni 的一个项目构建一个简单的游戏，并且想为 GUI 使用 Qt 应用程序。好吧，我也不一定*想要*，但是我们的教授希望我们这样做。请不要建议我简单地将 Ogre widgit 嵌入到我的 Qt 应用程序中，因为这不是一个 opti

有任何想法吗？

谢谢 <3

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-17T22:02:23.980

好吧，如果您正在使用，`CMake`那么它应该照顾您[指示它](http://www.qtcentre.org/wiki/index.php?title=Compiling_Qt4_apps_with_CMake)这样做的一切。[phb](https://stackoverflow.com/questions/10199746/linking-qt-libraries-to-a-cmake-project-in-eclipse/10199852#comment13096963_10199746)提供了更好的说明[的链接。](http://qt-project.org/quarterly/view/using_cmake_to_build_qt_projects)

第一步是指示`CMake`我们的项目需要 Qt。这是通过以下方式完成的（您也可以指定所需的各个部分）：

```
find_package(Qt4 REQUIRED) 
```

如果`Qt`未在典型位置找到（例如`QTDIR`未设置）-`cmake`将失败。

您还必须指示`CMake`使用 Qt 包含路径并设置某些编译器定义：

```
include(${QT_USE_FILE})
add_definitions(${QT_DEFINITIONS}) 
```

最后，对于每个目标，您需要告诉您要与 Qt 库链接：

```
target_link_libraries(foo ${QT_LIBRARIES}) 
```

您可能还想处理您的标头，并且必须使用`moc`. 有关详细信息，请参阅提供的链接。

`FindQt4.cmake`除了提供的链接之外，您还可以查看文件顶部的评论 。

# autotools - 添加 AC_CHECK_LIB 的路径

> ID：10199754
> 
> 赞同：8
> 
> 时间：2012-04-17T21:53:59.257
> 
> 标签：autotools

我对 configure.ac 有以下问题：

我想添加一个库搜索路径，因为我必须使用的库位于一些疯狂的文件夹中。我的想法是通过一个选项来做到这一点：

```
AC_ARG_WITH([cplex-lib-path],
  [AS_HELP_STRING([--with-cplex-libs], [location of the CPLEX library])],
  [CPLEX_LIBS="-L$withval --lcplex"],
  []) 
```

如果有人指定库路径，我当然想看看是否可以找到该库：

```
AC_CHECK_LIB([cplex], [CPXcreateprob], [],
[
  AC_MSG_ERROR([Could  not find CPLEX library])
]) 
```

但是，我想将 CPLEX_LIBS 添加到 AC_CHECK_LIB 的库搜索路径中。这有可能吗？

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2012-04-18T13:27:37.283

告诉配置脚本库在哪里是用户的责任。有许多可供用户使用的选项，最常见的是：

```
configure LDFLAGS=-L/p/a/t/h 
```

在这一点上，维护者完全没有理由修改构建脚本以适应用户，并且有很多很好的理由不尝试做任何事情。如果您（作为用户）发现您的库位于多个位置，您可以在您的环境或 config.site 中设置 LDFLAGS。您的工具链可能有其他机制（例如，如果您使用 gcc，您可以简单地设置 LIBRARY_PATH）。autoconf 提供的基础设施已经提供了很多机制来处理这个问题，包维护者最好不要重新发明轮子并提供非标准接口。

既然我已经争辩说你不应该做你想做的事，我会告诉你怎么做。AC_CHECK_LIB 将使用 LDFLAGS 中的值进行搜索，因此您可以执行以下操作：

```
LDFLAGS="$LDFLAGS $CPLEX_LIBS"     # this is a bug 
```

这是错误的，因为您现在`-l`在 LDFLAGS 中有一个标志，但`-l`参数属于`LIBS`. 此外，如果您要让另一个库 libfoo 和 $FOO_LIBS 指向不同的位置，则根本无法消除歧义：LDFLAGS 将获得 -L/cplex 和 -L/foo 并且用户将不知道哪个首先出现，并且无法保证与一个库的链接优于另一个。简而言之，不要使用 CPLEX_LIBS：教育您的用户使用 LDFLAGS。此外，键入更方便：

```
configure LDFLAGS='-Lpath1 -Lpath2' 
```

而不是打字

```
configure --with-cplex=path1 --with-foo=path2 
```

后者混淆了事物并导致未受过教育的民众。我一直不明白为什么人们喜欢在他们的构建中加入这些 --with-lib=/p/a/t/h 选项：它们没有提供任何有用的东西。

# function - MATLAB如何将数组从我的基础工作区传递给函数

> ID：10199756
> 
> 赞同：0
> 
> 时间：2012-04-17T21:54:06.440
> 
> 标签：function, matlab

我一直在阅读一些论坛帖子，试图弄清楚这一点，但我似乎无法破解它。总结我的功能，我有 2 个数组`searchDates`和`searchIds`. 现在我要做的就是比较一个元素与另一个数组的大小，这是我到目前为止的代码，但我不知道如何继承`searchDates`和`searchIds`

```
function a = compare(userNum)
if size(searchDates{1,userNum},2) == size(searchIds{1,userNum},2)
    x = true
else x = false
end 
```

TL; DR 我只需要知道如何将上面的两个数组从我的 BASE WORKSPACE 传递到我的 FUNCTION WORKSPACE。

干杯!

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-17T22:55:13.610

您可以重写您的函数，以便您可以直接传递数组：

```
function a = compare(userNum,searchDates,searchIds)
if size(searchDates{1,userNum},2) == size(searchIds{1,userNum},2)
    x = true
else x = false
end 
```

然后在第二个和第三个参数中调用与您的工作区变量进行比较。如果由于某种原因您需要比较只有一个参数，您可以通过使用上述函数比较并编写在您的工作区中创建一个匿名函数：

```
anon_compare = @(userNum) compare(userNum,searchDates,searchIds) 
```

如果您的工作区中有 searchDAtes 和 searchIds，您现在将拥有函数 anon_compare，您可以直接将其用作`anon_compare(foo)`.

有关匿名函数（几种 MATLAB 编程技术的一个重要方面）的更多信息，[您可以阅读这篇文章](http://www.mathworks.com/help/techdoc/matlab_prog/f4-70115.html)。

# c++ - C ++中的二维步长数组

> ID：10199758
> 
> 赞同：1
> 
> 时间：2012-04-17T21:54:21.600
> 
> 标签：c++, arrays, 2d

我是 C++ 新手，我花了一晚上的时间思考这个问题。我想创建一个二维数组，给出第一维的长度。第二维的长度，从 1 开始增加。例如，对于二维数组 a[][]，a[0][] 有 1 个元素，a[1][] 有 2 个元素，a[2][] 有 3 个元素，等等

这听起来不像是一个硬结构，但我找不到两个来创建它——我所能做的就是创建 ax * x 数组，这意味着一半的空间对我来说是浪费的。

有人有什么想法吗？提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-17T22:00:34.923

尝试为您的阵列考虑动态分配。

[动态数组分配](http://www.daniweb.com/software-development/cpp/threads/154468/2d-dynamic-array)

> 制作多维数组的另一种方法是使用称为指针的概念。就像 Ron 在星期四所说的那样，大多数人认为 2D 数组就像具有行和列的电子表格（这很好），但是“在引擎盖下”，C++ 使用 ptr 到 ptrs。首先，您从创建基指针开始。接下来，分配一个行指针数组并将第一个的地址分配给基指针。接下来，分配内存来保存每行列数据并分配行指针数组中的地址

但是，如果您是 CPP 的新手，我认为您不会处理大量数据，所以不必担心内存！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-17T22:00:53.053

`std::vector`解决方案：

```
vector< vector<int> > stairs;

for(int i = 0; i < n; i++) // n is size of your array
  stairs[i].resize(i+1); 
```

您也可以使用普通指针执行此操作：

```
int * stairs[n];
for(int i = 0; i < n ; i++)
  stairs[i] = new int[i+1]; 
```

但是这一次您将不得不担心在不再需要时删除此结构。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-17T22:03:08.137

一种解决方案是定义一个类，该类包含大小为 x*(x+1)/2 的一维数据数组，并重载`type & operator()(int r, int c)`以执行正确类型的索引。

```
template<class datatype, int size>
class strange2dArray {
   datatype data[size*(size+1)/2];

   datatype & operator()(int r, int c) {
      // assert if the indexes are correct
      return data[r*(r+1)/2+c];
   }
}; 
```

顺便说一句，除非您这样做是为了学习 C++，否则您可能应该使用某种数学库（或其他）来为您提供此类基本数据结构。他们将更有效、更安全地实施它。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-18T04:34:32.843

首先让我们看一个 Python 的测试：

```
>>> a=[]
>>> a[0]=3
Traceback (most recent call last):
  File "<stdin>", line 1, in <module>
IndexError: list assignment index out of range
>>> a={}
>>> a[0]=3 
```

哎呀，看起来像数组，并不意味着它是数组。如果你想要“数组”的动态大小，你可以使用映射。是的，这是第一个解决方案：

```
#include <map>
#include <iostream> 
using namespace std;

typedef std::map<int, int> array_d2; //length of second dimensional is increased
array_d2   myArray[10] ; //length of first dimensional is given

int main()
{
myArray[0][1] = 3;
myArray[0][2] = 311;

//following are tests
cout << myArray[0][1] << endl;
cout << myArray[0][2] << endl;

return 0;
} 
```

（输出是：）

```
$ ./test
3
311 
```

我的第二个解决方案是使用类似数组的东西，但具有调整大小的功能，您应该覆盖操作 [] 以使其自动为用户使用。

```
#include <vector>
#include <iostream> 
using namespace std;

 //length of second dimensional is increased
class array_d2 {
    int m_size;
    vector<int> m_vector; 
  public:
    array_d2 (int size=10) {
        m_size = size;
        m_vector.resize(m_size);
    };
    int& operator[] ( int index ) {
        if (index >= m_size) {
        m_size = index + 1;
        m_vector.resize(m_size);
    }
    return m_vector[index];
    };
};

array_d2   myArray[10] ; //length of first dimensional is given

int main()
{
myArray[0][1] = 3;
myArray[0][20] = 311;
myArray[1][11] = 4;
myArray[1][12] = 411;

//following are tests
cout << myArray[0][1] << endl;
cout << myArray[0][20] << endl;
cout << myArray[1][11] << endl;
cout << myArray[1][12] << endl;

return 0;
} 
```

（输出是）

```
$ ./test1
3
311
4
411 
```

# objective-c - NSDateFormatter "w"

> ID：10199762
> 
> 赞同：1
> 
> 时间：2012-04-17T21:54:30.737
> 
> 标签：objective-c

在我的应用程序中，我使用“w”来格式化日期：

1.  使用“w”，新的一周是否从星期日开始？
2.  日期是当地的吧？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-17T22:00:37.533

NSDateFormatter 将使用您的位置设置（参见[NSLocal](http://developer.apple.com/library/mac/#documentation/Cocoa/Reference/Foundation/Classes/NSLocale_Class/Reference/Reference.html)）。因此，如果加拿大是您当地的日历并且加拿大日历从星期六开始，那么这就是您的一周。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-17T22:09:02.337

关于周元素的问题，

以下来自[HERE](http://www.iso.org/iso/date_and_time_format)，您的 NSDateFormatter 使用 ISO 标准。

> 周日期是在许多商业和工业应用中使用的替代日期表示。它是：YYYY-Www-D
> 
> 其中 YYYY 是公历中的年份，ww 是一年中的第几周，介于 01（第一周）和 52 或 53（最后一周）之间，D 是一周中的第 1 天（星期一）和 7 之间（星期日）。
> 
> 示例：2003-W14-2 表示 2003 年第十四周的第二天。

这意味着对于公历，周从星期一开始。

除了 PascalTurbo 的帖子之外，如果需要，您可以显式设置为您的日期格式化程序设置时区，如下例所示：

```
NSDateFormatter *dateFormatter.timeZone = [NSTimeZone timeZoneWithAbbreviation:@"GMT"]; 
```

# android - Android HTTP 客户端冻结

> ID：10199767
> 
> 赞同：2
> 
> 时间：2012-04-17T21:55:16.647
> 
> 标签：android, http, httpclient, httprequest

我在我的 HTTP 请求中遇到了一些奇怪的行为。我有一些用户说这个调用永远不会回来（标记它是异步调用的微调器永远不会消失）。我以前见过这种情况，但我将其归因于通过 Charles Proxy 的模拟器。直到现在我还没有在实际手机上看到它。

我不确定什么会导致这种情况发生，这就是我在这里发布它的原因。这是调用，使用 Jackson 将结果反序列化为值对象。我看到模拟器冻结的两个地方是 httpclient.execute(httpGet); 和 getObjectMapper().readValue(jp, SyncVO.class);。

在调试时，单步执行有问题的语句会导致调试器永远无法控制单步执行。同时，我看到请求通过 Charles 从服务器发出并返回。只是该应用程序似乎没有得到响应，只是坐在那里。

所以，这里是代码。谢谢你的帮助！

```
public SyncVO sync(String userId, long lastUpdate, boolean includeFetch) throws IOException {
    SyncVO result = null;

    String url = BASE_URL + "users/" + userId + "/sync" + "?" + "fetch=" + includeFetch;

    if (lastUpdate > 0) {
        url += "&updatedSince=" + lastUpdate;
    }

    DefaultHttpClient httpclient = new DefaultHttpClient();
    HttpGet httpGet = new HttpGet(url);

    httpGet.setHeader("Accept", "application/json");
    httpGet.setHeader("Accept-Encoding", "gzip");
    httpGet.setHeader(AUTHORIZATION, BEARER + " " + mOAuthToken);
    httpclient.getParams().setParameter(CoreProtocolPNames.USER_AGENT, USER_AGENT_STRING);
    httpclient.getParams().setBooleanParameter(CoreProtocolPNames.USE_EXPECT_CONTINUE, false);

    HttpResponse response = httpclient.execute(httpGet);

    if (isUnauthorized(response)) {
        APPLICATION.needReauthentication();
        return null;
    }

    if (response != null) {
        InputStream stream = response.getEntity().getContent();
        Header contentEncoding = response.getFirstHeader("Content-Encoding");
        if (contentEncoding != null && contentEncoding.getValue().equalsIgnoreCase("gzip")) {
            stream = new GZIPInputStream(stream);
        }

        InputStreamReader inReader = new InputStreamReader(stream, "UTF-8");
        JsonParser jp = mJsonFactory.createJsonParser(inReader);
        result = getObjectMapper().readValue(jp, SyncVO.class);
    }   

    return result;
}

private ObjectMapper getObjectMapper() {
    return (new ObjectMapper()
        .configure(Feature.AUTO_DETECT_FIELDS, true)
        .configure(Feature.FAIL_ON_UNKNOWN_PROPERTIES, false)
        .configure(JsonParser.Feature.ALLOW_UNQUOTED_CONTROL_CHARS, true));
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-06-05T14:04:13.197

不要忘记在每次请求后使用实体内容。

```
HttpEntity entity = response.getEntity();
  try {
   if (entity != null)
    entity.consumeContent();
  } catch (IOException e) {
   e.printStackTrace();
  } 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-04-28T15:14:35.643

原因是你已经`stream`打开了。因此，`response`它处于不确定状态。这意味着您的全局变量`httpClient`也处于不确定状态，并且在重新使用客户端时无法获取新实体。

您应该`close()`在完成流后调用。

```
stream.close(); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-17T22:21:01.170

您绝对应该使用连接超时和套接字读取，并为服务器最坏的情况做好准备。网络操作永远不会 100% 可预测，您的客户也无能为力，因此请确保您以最佳方式编码。

```
httpParameters = httpclient.getParams();
HttpConnectionParams.setConnectionTimeout(httpParameters, 5000);
HttpConnectionParams.setSoTimeout(httpParameters, 10000); 
```

您还可以使用 asyncTask.cancel(true); 取消任务；

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2012-04-17T22:01:57.640

网络调用需要一段时间并且会阻塞 UI 线程。与您的杰克逊反序列化代码相同。这些东西需要放在一个单独的线程上。请参阅[AsyncTask](http://developer.android.com/reference/android/os/AsyncTask.html)以获得一种简单的方法。

# objective-c - Objective-C宏在接受带有可变数量参数的字符串时返回带有函数和行号的字符串？

> ID：10199768
> 
> 赞同：2
> 
> 时间：2012-04-17T21:55:17.363
> 
> 标签：objective-c, macros, logging

我发现了一堆关于如何使用 NSLog 作为基础并添加**PRETTY_FUNC**和**LINE**的宏变体，但这些宏的所有变体只是将结果输出到控制台。

我想要一个宏，它可以采用具有可变数量参数的格式，添加方法的名称和调用它的行号，然后返回一个 NSString 但到目前为止，编译器总是抱怨我调用它的地方. 我的最新版本如下：

```
#define FileLog(format, ...) {\
return [NSString stringWithFormat:@"\n  %s [Line %d] \n       %@",
__PRETTY_FUNCTION__,
__LINE__,
[NSString stringWithFormat:(format), ##__VA_ARGS__]];\
} 
```

每次我从代码中调用它时，编译器都会生成以下错误之一：

```
error: expected expression before '{' token 
```

我不想为此编写日志类或使用框架。必须有办法用宏来做到这一点？任何人？

提前致谢！

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-04-17T22:03:06.500

这完全可以通过宏来实现，我认为您只需要更多关于它们的背景知识。

首先，宏不是函数，所以大括号是不必要的（事实上，是你的错误的原因）。宏实际上是一个相当愚蠢的“复制/粘贴”，由预处理器自动执行，使用它可以理解的语法。

为了定义一个跨越多行的宏并“就地”创建一个 NSString，您必须使用反斜杠转义换行符，如下所示：

```
#define FileLog(format, ...) \
    [NSString stringWithFormat:@"\n %s [Line %d] \n %@", \
    __PRETTY_FUNCTION__, \
    __LINE__, \
    [NSString stringWithFormat:format, ##__VA_ARGS__]] 
```

宏不会像函数那样“返回”，因为正如我所提到的，它们只是“复制/粘贴”文本的一种方式。

你可以像这样使用它：

```
int num = 42;
NSLog(@"%@", FileLog(@"some number: %d", num)); 
```

如果您要查看预处理器输出（预处理器在编译之前创建的文件），上面的示例将扩展为：

```
NSLog(@"%@", [NSString stringWithFormat:@"\n %s [Line %d] \n %@", __PRETTY_FUNCTION__, __LINE__, [NSString stringWithFormat:@"some number: %d", num]]); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-17T22:11:42.017

试试这个....

创建包含文件

```
#define LOG_NOLOG_LEVEL 0
#define LOG_ERROR_LEVEL 1
#define LOG_WARN_LEVEL 2
#define LOG_INFO_LEVEL 3
#define LOG_DEBUG_LEVEL 4

#if LOG_HELPER_LEVEL >= LOG_DEBUG_LEVEL
    #define LOGDEBUG(...) {[LogHelper log:[NSString stringWithFormat:__VA_ARGS__]];}
#else
    #define LOGDEBUG(...)
#endif

#if LOG_HELPER_LEVEL >= LOG_INFO_LEVEL
    #define LOGINFO(...) {[LogHelper log:[NSString stringWithFormat:__VA_ARGS__]];}
#else
    #define LOGINFO(...)
#endif

#if LOG_HELPER_LEVEL >= LOG_WARN_LEVEL
    #define LOGWARN(...) {[LogHelper log:[NSString stringWithFormat:__VA_ARGS__]];}
#else
    #define LOGWARN(...)
#endif

#if LOG_HELPER_LEVEL >= LOG_ERROR_LEVEL
    #define LOGERROR(...) {[LogHelper log:[NSString stringWithFormat:__VA_ARGS__]];}
#else
    #define LOGERROR(...)
#endif 
```

然后用单个类方法创建一个简单的类 LogHelper 如下....

```
+ (void) log:(NSString *)message
{
    fputs([message cStringUsingEncoding:NSUTF8StringEncoding], stderr);
} 
```

然后在您的代码中，您可以调用...

```
LOGDEBUG(@"%s - %d Redirect response received\n%@",__FILE__,
                                __LINE__,[redirectRequest dumpInfo]); 
```

您可以将 LOG_HELPER_LEVEL 设置为您想要生成的日志记录级别。如果您将级别设置为 LOG_WARN_LEVEL，那么您的应用程序中将不会包含用于 INFO 或 DEBUG 级别的代码，因此很容易打包您的应用程序以供发布。

希望这可以帮助...

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-03-28T18:58:54.013

来自[Viraj Thenuwara](http://viraj.me/)，他是我培训我的 iOS 高级开发人员 :-)

这个宏的定义和用法比上面提到的要简单得多。

```
#define debug                   1

#if debug
    #define AppLog(fmt, ...)        NSLog((@"%s [Line %d] " fmt), __PRETTY_FUNCTION__, __LINE__, ##__VA_ARGS__);
#else
    #define AppLog(...)
#endif 
```

它的用法如下：

```
 NSString *url = @"http://google.com";    
 AppLog(@"url %@ and id %d", url, 5); 
```

This **AppLog** line will print out it's given content only if the **debug** constant is equal to 1\. **At the Production time or in anytime you don't want to print the log lines you can disable it by turning that 1 into 0.**

And it's console out put will be seen as follows:

![enter image description here](../Images/d7ea102a0d4cd92a252e68274dc3940e.png)

Hope this will be helpful to someone else! Cheers!

# java - 有没有现有的软件可以实现我的Java数据传输加密？

> ID：10199769
> 
> 赞同：0
> 
> 时间：2012-04-17T21:55:17.563
> 
> 标签：java, security

我最近构建了一个J2SE聊天应用程序，但我认为我应该考虑数据传输加密。但我无法从头开始编写代码。

不知道有没有现成的加密应用可以帮我实现目标？关键是：它应该支持Java应用程序。

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-17T22:04:36.547

您应该为此使用 SSL。Java 通过 SSLSocketFactory 内置了对 SSL 的支持：

```
import javax.net.ssl.SSLSocketFactory;

...

SocketFactory factory = SSLSocketFactory.getDefault();
Socket s = factory.createSocket( host, port ); 
```

从那时起，像往常一样使用套接字。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-17T22:06:35.677

是的，它被称为 Java API ;-)

[http://www.oracle.com/technetwork/java/javase/tech/index-jsp-136007.html](http://www.oracle.com/technetwork/java/javase/tech/index-jsp-136007.html)

您可以使用传输层安全性（https 和朋友）或通过 JCA（Java 密码体系结构）加密您的数据。

# java - 在 play 2.0 中将输出发送到 websocket

> ID：10199771
> 
> 赞同：3
> 
> 时间：2012-04-17T21:55:19.923
> 
> 标签：java, websocket, playframework-2.0

我试图找出一种方法让 WebSocket.Out 在调用 WebSocket.In 的 onMessage 时触发一些数据。

例如：

```
public class Application extends Controller {

public static Result index() {
    return ok(index.render("Your new application is ready."));
}

public static WebSocket<String> sockHandler() {
    return new WebSocket<String>() {
        public void onReady(WebSocket.In<String> in, WebSocket.Out<String> out) {
            in.onMessage(new F.Callback<String>() {
                // FIRE SOME DATA BACK OUT TO BROWSER HERE!!!
                public void invoke(String event) {
                    Logger.info(event);
                }
            });

            out.write("I'm contacting you regarding your recent websocket.");
        }
    };
}

private static void send(WebSocket.Out<String> out, String data){
    out.write(data);
} 
```

}

任何帮助深表感谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-18T07:46:40.870

请检查[websocket-chat 示例应用程序](https://github.com/playframework/playframework/tree/2.3.x/samples/java/websocket-chat)的代码。它会给你一个模型来复制 websocket 管理。

例如，这段代码：

```
 // Send a Json event to all members
    public void notifyAll(String kind, String user, String text) {
        for(WebSocket.Out<JsonNode> channel: members.values()) {

            ObjectNode event = Json.newObject();
            event.put("kind", kind);
            event.put("user", user);
            event.put("message", text);

            ArrayNode m = event.putArray("members");
            for(String u: members.keySet()) {
                m.add(u);
            }

            channel.write(event);
        }
    } 
```

将一些数据写入`channel`，即 a `WebSocket.Out<JsonNode>`。

# java - Java 中 ContainsAll 的成本是多少？

> ID：10199772
> 
> 赞同：2
> 
> 时间：2012-04-17T21:55:21.500
> 
> 标签：java, arrays, list, interface

我今天在一些编码过程中发现了`containsAll()`（一种`List`接口方法），它看起来很漂亮。有谁知道这在性能/迭代方面的成本是多少？

[文档](http://docs.oracle.com/javase/1.4.2/docs/api/java/util/List.html#containsAll%28java.util.Collection%29)在这方面没有提供太多信息。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-17T21:59:46.123

*   首先，它迭代所提供集合的每个元素
*   然后它迭代列表的所有元素并使用它们将当前元素与它们进行比较`.equals(..)`（注意：这是关于列表，正如您在问题中指定的那样。其他集合的行为不同）

所以它是 O(n*m)，其中 n 和 m 是两个集合的大小。

```
public boolean containsAll(Collection<?> c) {
    Iterator<?> e = c.iterator();
    while (e.hasNext())
        if (!contains(e.next()))
        return false;
    return true;
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-17T22:00:01.883

使用来源，卢克:)

编辑：正如 Bozho 指出的那样，您在询问`List.containsAll()`哪些 overrides `Collection.containsAll()`。下面的漫谈主要是与后者有关：

大多数`Collection`类将使用[from的](http://grepcode.com/file/repository.grepcode.com/java/root/jdk/openjdk/7-b147/java/util/AbstractCollection.java#AbstractCollection.containsAll%28java.util.Collection%29)[实现`containsAll``AbstractCollection`](http://grepcode.com/file/repository.grepcode.com/java/root/jdk/openjdk/7-b147/java/util/AbstractCollection.java#AbstractCollection.containsAll%28java.util.Collection%29)，它是这样的：

```
public boolean containsAll(Collection<?> c) {
    for (Object e : c)
        if (!contains(e))
            return false;
    return true;
} 
```

但是，不能保证某些实现会完全不同——这可能会导致更好或更差的运行时行为。

上面的实现`containsAll`将至少为 O(n)，其中 n 是您传入的*`Collection`参数中的项目数，***加上**所需的时间`contains`：

*   对于 a `HashSet`/`HashMap`这可能是 O(1) （最好的情况，没有冲突），所以总运行时间`containsAll`仍然是 O(n)
*   对于 an `ArrayList`，`contains`将采用 O(m) 其中 m 是列表中的项目数（不是参数），因此总时间为`containsAll`O(n*m)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-17T22:04:08.717

如果您正在调用 A.containsAll(B)

openjdk 迭代 B 调用 A.contains(b) 的所有元素。

A.contains(b) 迭代 A 调用 a.equals(b) 的所有元素

这取自[open jdk 7的源代码](http://hg.openjdk.java.net/jdk7/jdk7-gate/jdk/file/e947a98ea3c1/src/share/classes/java/util/AbstractCollection.java)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-17T22:01:03.457

考虑

n.ContainsAll(m)

最好的情况是 O(m)，如果 n 是一个完美的哈希集。

考虑到未排序的列表，我可以提出一个 O(n*log(n) + m*log(m)) 算法

# ruby-on-rails - rails 3.1升级后jQuery插件/函数未加载

> ID：10199781
> 
> 赞同：1
> 
> 时间：2012-04-17T21:56:11.770
> 
> 标签：ruby-on-rails, jquery-plugins, ruby-on-rails-3.1

所以我最近刚刚将一个大型项目升级到 Rails 3.1。我已经建立了资产管道并开始工作。然而，我们使用的许多插件和我们编写的自定义 jQuery 函数似乎都没有得到评估，尽管源代码在 application.js 中。例如：

```
 (function($) {
     $.fn.searchable = function() {
        ....
     }
   })( jQuery ); 
```

我在 application.js 中看到了这段代码，但是任何试图使用它的东西都会得到一个 javascript 错误，未定义的函数。但是，如果我将整个内容包装在一个函数定义中，并在准备好文档时调用该函数，那么它就可以工作。

这是一个非常丑陋的解决方法。有什么想法为什么不包装在函数中就不能工作？

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-17T22:24:55.387

也许你应该看看'coffeescript's namescope'。例如

```
//define your js function as: 
this.some_function_name()  => 
  alert('hello~')

//call it as:
this.some_function_name() 
```

# python - 将 Int 映射到列表 - Python

> ID：10199782
> 
> 赞同：1
> 
> 时间：2012-04-17T21:56:14.957
> 
> 标签：python, string, list

> **可能重复：**
> [Python：如何将字符串数组转换为数字数组？](https://stackoverflow.com/questions/5306079/python-how-do-i-convert-an-array-of-strings-to-an-array-of-numbers)

我正在尝试将字符串列表映射到 Int，当我映射 Int 函数时，它将 2 位数字拆分为 2 个项目列表：

我有以下代码：

```
>>> MyList
['10', '5', '6', '7', '8', '9']
>>> MyList = [map(int,x) for x in MyList]
>>> MyList
[[1, 0], [5], [6], [7], [8], [9]] 
```

获取如下列表的正确方法是什么：

```
[10, 5, 6, 7, 8, 9] 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-04-17T21:59:38.247

直接使用`map(int, ...`就行了：

```
map(int, MyList) 
```

或者，在大多数情况下，使用列表推导：

```
[int(x) for x in MyList] 
```

但不是两者兼而有之。

`map`将函数单独应用于迭代中的每个项目——这就是它的目的。

类似地，列表推导在可迭代的每个项目上运行表达式，因此您不需要`map`，只需每次要运行的表达式。

# sql - SSIS 数据流如何真正工作？

> ID：10199784
> 
> 赞同：6
> 
> 时间：2012-04-17T21:56:33.880
> 
> 标签：sql, sql-server-2008, ssis

我有一个 SSIS 包，可以将数据从一个数据库传输到另一个数据库。SSIS 包在应用服务器上运行。

我正在考虑将两个数据库之一移动到另一个数据服务器。会不会对性能有影响？SSIS 中的数据如何流动，即所有数据是否进入运行 SSIS 的应用程序服务器，然后进入目标数据库？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-17T22:25:34.403

SSIS 是一个客户端进程，因此如果它在运行 DBMS 的机器之外的服务器上运行，则流量将通过网络传输。你的问题措辞不是很清楚，但我想你想知道移动数据库是否会影响性能，因为 SSIS 包已经在单独的机器上运行。

如果 SSIS 作业已经在与 DB 服务器在物理上独立的应用程序服务器上运行，那么移动其中一个数据库可能不会影响性能，除非它的网络连接比另一个慢得多。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-17T22:32:16.973

我最近遇到了同样的情况，我们将源系统升级到了更好的配置框。我不需要做任何事情，但是从源到 SQL 框的数据加载时间从大约 40 分钟减少到平均不到 12 分钟。要回答您的问题，您只会看到任何性能差异，具体取决于 1) 您的新系统资源和 2) 如果您对托管 SQL Server 的盒子进行了更改。

# c# - 通过 WCF 传输大量数据

> ID：10199786
> 
> 赞同：1
> 
> 时间：2012-04-17T21:56:52.983
> 
> 标签：c#, wcf, service, data-transfer

我在我的项目中使用 WCF 从服务器（访问数据库）和客户端传输数据，客户端在屏幕上绘制数据。

传输的数据量相当大，所以我想知道哪种方法最好。

现在，我可以查询少量数据，大约 3600 个对象（时间戳和双精度值）。但是，当这个数字增加到大约 86400 个对象时，服务函数调用中就会发生错误。

我的服务和客户声明如下：

服务器：

```
<system.serviceModel>
    <behaviors>
      <serviceBehaviors>
        <behavior name="">
          <serviceMetadata/>
          <dataContractSerializer maxItemsInObjectGraph="6553600"/>
          <serviceDebug includeExceptionDetailInFaults="false"/>
        </behavior>
      </serviceBehaviors>
    </behaviors>
    <services>
      <service name="serviceName">
        <endpoint binding="netTcpBinding" contract="interfaceName">
          <identity>
            <dns value="localhost"/>
          </identity>
        </endpoint>
        <endpoint address="mex" binding="mexTcpBinding" contract="IMetadataExchange"/>
        <host>
          <baseAddresses>
            <add baseAddress="net.tcp://localhost:5050/msservice"/>
          </baseAddresses>
        </host>
      </service>
    </services>
  </system.serviceModel> 
```

客户：

```
<system.serviceModel>
    <bindings>
      <netTcpBinding>
        <binding name="NetTcpBinding_IService" closeTimeout="00:02:00" openTimeout="00:02:00" receiveTimeout="00:10:00" sendTimeout="00:02:00" transactionFlow="false" transferMode="Buffered" transactionProtocol="OleTransactions" hostNameComparisonMode="StrongWildcard" listenBacklog="10" maxConnections="10"  maxBufferSize="2147483647" maxBufferPoolSize="2147483647">
          <readerQuotas maxDepth="2147483647" maxStringContentLength="2147483647" maxArrayLength="2147483647" maxBytesPerRead="2147483647" maxNameTableCharCount="2147483647" />
          <reliableSession ordered="true" inactivityTimeout="00:10:00" enabled="false"/>
          <security mode="Transport">
            <transport clientCredentialType="Windows" protectionLevel="EncryptAndSign"/>
            <message clientCredentialType="Windows"/>
          </security>
        </binding>
      </netTcpBinding>
    </bindings>
    <client>
      <endpoint address="net.tcp://localhost:5050/msservice" binding="netTcpBinding" bindingConfiguration="NetTcpBinding_IService" contract="IService" name="NetTcpBinding_IService">
        <identity>
          <dns value="localhost"/>
        </identity>
      </endpoint>
    </client>
  </system.serviceModel> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-17T22:18:46.527

你在.net 4上吗？如果不是，我相信您需要为服务行为提供一个名称并将其与服务相关联。

编辑：否则，可以使用默认的 maxItemsInObjectGraph 值 65536。

```
<system.serviceModel>
<services>
    <service name="YOURPROJECT.Web.YOURSERVICE"
            behaviorConfiguration="YOURPROJECT-Web-YOURSERVICE">
    </service>
</services>
<behaviors>
    <serviceBehaviors>
        <behavior name="YOURPROJECT-Web-YOURSERVICE">
            <serviceMetadata httpGetEnabled="true" />
            <serviceDebug includeExceptionDetailInFaults="true" />
            <dataContractSerializer maxItemsInObjectGraph="6553600"/>
        </behavior>
    </serviceBehaviors>
</behaviors> 
```

# c# - 将主机名转换为 IP 地址，然后 ping

> ID：10199790
> 
> 赞同：0
> 
> 时间：2012-04-17T21:57:00.887
> 
> 标签：c#, properties, ip-address

旁注：我真的想不出一个好的标题。

好的，我正在更新一个由不相信代码重用的开发人员编写的程序。所以我的任务是更新并使其对未来的变化“友好”。

*编辑*我应该说：最终用户想要一个命令提示符来查看每个 ping。我知道使用内置 ping 会是一个更好的选择，但这正是他们想要的……你们知道那是怎么回事 /End *Edit*

我正在使用一个在整个程序中实现了几次的类。（以前有两个类基本上做同样的事情）

我决定制作一个接口并在类上实现它。

（我还没有失去你吗）

该方法实际上只是将主机名（方法参数之一）转换为 IP 地址，并生成一个命令提示符来 ping 它。我还有一个单独的类，它实现了接口并调用了方法，但是没有传递一个字符串（主机名），它传递了一个 ipaddress 对象。

我的问题在这里：处理可以更改类型的参数时的最佳做法是什么？有人会看看我做了什么吗？它符合要求，我只是想确保它是最佳实践。

```
// Interface that is implement twice in the program 
interface Icmd_Ping
    {
    void initilize_Proc(object target, string last_Octet);

    }

 class process_spawn : Icmd_Ping
{     
    writeLog_Delegate writeLog = new writeLog_Delegate(error_Log.write_log);

    private string ipaddress;
    public object Ipaddress
        {
        get { return ipaddress; }
        set
            {                
            IPAddress ip = value as IPAddress;
            if (ip != null)
                ipaddress = ip.ToString();
            else
                {

                try
                    {
                    formatIP format = new formatIP();
                    ipaddress = format.convert_Ip(((string)value));
                    }
                catch (Exception ex)
                    {
                    writeLog(ex);
                    }
                }   
            }
        }

    public void initilize_Proc(object target, string last_Octet = null)
        {
        if (target == null)
            throw new ArgumentNullException();

        formatIP format_IP = new formatIP();
        this.Ipaddress = target;

        Process cmd = new Process();
        ProcessStartInfo psi = new ProcessStartInfo {FileName = "cmd", UseShellExecute = false, RedirectStandardOutput = false };
        cmd.StartInfo = psi;

        if (last_Octet != string.Empty)
            psi.Arguments = string.Format("/c ping {0} -t", format_IP.format_Ip(((string)Ipaddress), last_Octet));
        if (last_Octet == string.Empty)
            psi.Arguments = string.Format("/c ping {0} -t", ((string)Ipaddress));

        cmd.Start();
        }

} 
```

我应该在 ipaddress 属性中转换 IPaddress 吗？或者只是制作一个新方法并调用它？

抱歉，我知道它在这一点上不是很优雅，我只是想在我真正深入研究之前确保我处于写作方向。

感谢大家的帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-17T22:02:23.697

首先，我建议使用`System.Net.IPAddress`而不是自己滚动。 [http://msdn.microsoft.com/en-us/library/system.net.ipaddress.aspx](http://msdn.microsoft.com/en-us/library/system.net.ipaddress.aspx)

其次，您可以使用`System.Net.NetworkInformation.Ping`ICMP-Echo [http://msdn.microsoft.com/en-us/library/system.net.networkinformation.ping.aspx](http://msdn.microsoft.com/en-us/library/system.net.networkinformation.ping.aspx)

例如

```
 IPAddress ip = IPAddress.Parse("192.168.0.1");
        Ping ping = new Ping();

        for (int i = 0; i < 4; ++i)
        {
            var reply = ping.Send(ip);
            Console.WriteLine("Reply from {0} Status: {1} time:{2}ms", 
                              reply.Address, 
                              reply.Status, 
                              reply.RoundtripTime);
        } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-17T22:26:58.157

您可以使用 .NET 函数 Dns.GetHostAddresses() 将 DNS 条目解析为单个主机地址（我认为这也是您的要求之一）。

```
foreach (IPAddress address in Dns.GetHostAddresses(hostName))
{
   PingReply reply = Ping.Send(address);
   ...
} 
```

从那里，将回复格式化回类似于 ping 工具的格式。对于 TTL 和字节发送参数，也可以通过 .NET 中的 Ping.Send() API 进行控制。

# list - 如何将 dojox.mobile.EdgeToEdgeList 滚动到特定项目 dojo 1.7.2？

> ID：10199792
> 
> 赞同：0
> 
> 时间：2012-04-17T21:57:02.763
> 
> 标签：list, mobile, scroll, dojo

我正在使用 dojox.mobile.Opener 从 ActionSheet 中选择一个动作。操作表应该在该开瓶器下方的 EdgeToEdgeList 内的项目上操作。

用户选择一个项目并单击打开 ActionSheet 按钮后，我想滚动 EdgeToEdgeList 以使所选项目位于屏幕顶部（而不是开瓶器下方）。

有谁知道我如何以编程方式要求 EdgeToEdgeList 向上滚动到特定项目。

谢了，兄弟们

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-06T18:20:04.777

您可以使用 DOM 节点的 scrollIntoView() 方法。

通用浏览器版本：

```
document.getElementById('NodeIdToScrollTo').scrollIntoView(); 
```

道场版：

```
dojo.byId('NodeIdToScrollTo').scrollIntoView(); 
```

或者，如果您更愿意通过小部件 id：

```
dijit.byId('NameOfListItem').domNode.scrollIntoView(); 
```

# ios - plist 文件会不会太大？

> ID：10199793
> 
> 赞同：1
> 
> 时间：2012-04-17T21:57:06.280
> 
> 标签：ios, xcode, plist

我正在开发一个加载可以搜索的 plist 文件的参考应用程序。

plist 文件大约 6kb，有大约 600 个条目。

我一直在使用模拟器，一切正常，但是当我将它加载到设备上时，没有任何数据存在。只是一张空桌子。

我认为该文件可能太大了，因为我可以加载一个包含 20 个条目的 plist，并且它可以在设备上正常加载。

如果文件太大，整个应用程序不会崩溃吗？

有没有人有什么建议？

这就是我加载 plist 文件的方式

```
NSString* myFile = [[NSBundle mainBundle] pathForResource:@"myPlistFile" ofType:@"plist"];
array = [[NSMutableArray alloc] initWithContentsOfFile:myFile]; 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-17T22:02:24.973

在我看来，您的 plist 甚至根本没有被复制到设备上，或者您正在使用区分大小写的文件命名。

首先查看文件是否存在：

```
NSString *myFilePath = [[NSBundle mainBundle] pathForResource:@"myPlistFile" ofType:@"plist"];
BOOL exists = [[NSFileManager defaultManager] fileExistsAtPath:myFilePath]; 
```

检查该布尔值（使用调试器或通过日志记录，无论哪种方式）。如果文件存在，那么我怀疑您在尝试访问文件名时使用了错误的大小写。与模拟器不同，iOS 设备上的文件名区分大小写。例如，假设您的 plist 名为`myAwesomeStuff.plist`. 如果您尝试`myawesomestuff.plist`在模拟器上访问，它会工作得很好。在设备上不是这样。确保您在文件名上使用了正确的大小写。

# javascript - 一页上浮动导航栏和浮动div对象之间的冲突？

> ID：10199797
> 
> 赞同：0
> 
> 时间：2012-04-17T21:57:35.570
> 
> 标签：javascript, jquery, html, css, css-float

整个设置在这里的 jsfiddle 页面中

[http://jsfiddle.net/DyJzg/10/](http://jsfiddle.net/DyJzg/10/)

问题是，div 块似乎与浮动导航栏冲突，因此 JavaScript 下拉菜单不再起作用。

这是这个旧问题的后续问题：

[滚动时如何使此导航栏浮动在顶部？](https://stackoverflow.com/questions/10197298/how-to-make-this-navigation-bar-floating-on-top-while-scrolling)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-17T22:01:39.813

你只需要添加`z-index`到你的`nav`，像这样：

```
nav {position:fixed;top:0;width:100%;z-index:10} 
```

或者，作为一个选项，您可以`<nav>`在下面`<div id="content">`的 html 代码中找到。

# ruby - Ruby：字符串分支器

> ID：10199800
> 
> 赞同：0
> 
> 时间：2012-04-17T21:58:09.307
> 
> 标签：ruby, string

是否有一个 ruby​​ 库（作为其功能之一）扫描字符串以查找一些“填补空白”，例如“我是一个 [机器人、猴子、程序员]，我闻起来很有趣。” 并生成一系列完整的句子，例如“我是机器人，我闻起来很有趣”。“我是一只猴子，我闻起来很奇怪。” “我是一名程序员，我闻起来很有趣。”

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-17T22:19:12.293

```
s = "I'm a [robot,monkey,programmer] and I smell funny." 

M = /\[.*\]/
def f x
  x[M][1..-2].split(',').map { |e| x.sub(M, e) }
end
puts f s 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-17T22:19:54.143

我认为这个要求太简单了，不能自己实现。自己编写肯定比搜索现有的 ruby​​gems 快得多。

# jquery - jQuery 保持与 div 显示/隐藏内联的显示

> ID：10199804
> 
> 赞同：0
> 
> 时间：2012-04-17T21:58:19.187
> 
> 标签：jquery

我有一个要显示的 CSS 的 div：inline;

但是，当我使用 jQuery 显示/隐藏时，它会将其更改为阻止/无。

当 jQuery 显示它时，我如何防止这种情况并保持显示内联？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-17T22:02:04.737

你不能afaik。

但是你可以做的就是使用

```
$('.your-element).css({'display':'inline'}); 
```

代替 .show()。

.hide() 仍然可以照常使用。现在想不出什么聪明的办法。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-17T22:06:41.177

根据 jQuery[文档](http://api.jquery.com/show/)：

> 如果一个元素的显示值为 inline，然后被隐藏并显示，它将再次被显示为 inline。

有其他事情发生吗？

演示：http: [//jsfiddle.net/jtbowden/JdJFJ/](http://jsfiddle.net/jtbowden/JdJFJ/)

以下是来自源代码的代码片段：

```
if ( display !== "none" && !jQuery._data( elem, "olddisplay" ) ) {
    jQuery._data( elem, "olddisplay", display );
} 
```

基本上，它将原始数据存储`display`在内部数据中，这些数据在`show()`. 类似但不同的代码在 jQuery 1.0 中一直存在。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-17T22:07:31.663

@benhowdle89 jQuery 似乎已经可以做到这一点。你用的是什么版本？

# php - 将 mysql 日期时间转换为简单文本

> ID：10199806
> 
> 赞同：0
> 
> 时间：2012-04-17T21:58:31.913
> 
> 标签：php, javascript, datetime

我有一个 MySql 日期时间值，例如“2012-04-17 20:48:29”。我想将其转换为简单的文本，例如“10 天前”。我想在 php 或 javascript 中执行此操作！我试图创建自己的算法来做到这一点。但是是否有一个已经可用的解决方案来做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-17T22:08:53.937

你可以使用这个模式

```
$date = "2012-04-17 20:48:29";

$seconds = time() - strtotime($date);
$days = floor($seconds / 86400);
$seconds -= $days * 86400;
$hours = floor($seconds / 3600);
$seconds -= $hours * 3600;
$minutes = floor($seconds / 60);
$seconds -= $minutes * 60;

echo "$days days, $hours hours, $minutes minutes, $seconds seconds ago"; 
```

您当然应该在回显结果之前添加一些条件。仅显示 1 分钟前、3 小时前或 10 天前...

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-17T22:54:08.033

使用此功能，您将获得如下输出：

*   1分钟
*   5分钟
*   15小时
*   4天
*   2个月
*   1.5年

* * *

```
function time_ago_in_words($time) {
  $from_time = strtotime($time);

  $to_time = strtotime(gmd());
  $distance_in_minutes = round((($to_time - $from_time))/60);

  if ($distance_in_minutes < 0)
    return (string)$distance_in_minutes.'E';

  if (between($distance_in_minutes, 0, 1))
    return '1 minute';

  elseif (between($distance_in_minutes, 2, 44))
    return $distance_in_minutes.' minutes';

  elseif (between($distance_in_minutes, 45, 89))
    return '1 hour';

  elseif (between($distance_in_minutes, 90, 1439))
    return round($distance_in_minutes/60).' hours';

  elseif (between($distance_in_minutes, 1440, 2879))
    return '1 day';

  elseif (between($distance_in_minutes, 2880, 43199))
    return round($distance_in_minutes/1440).' days';

  elseif (between($distance_in_minutes, 43200, 86399))
    return '1 month';

  elseif (between($distance_in_minutes, 86400, 525959))
    return round($distance_in_minutes/43200).' months';

  elseif ($distance_in_minutes > 525959)
    return number_format(round(($distance_in_minutes/525960), 1), 1).' years';
} 
```

所以你可以这样做：

```
// Last time you logged in: 15 days ago.
Last time you logged in: <?php echo time_ago_in_words($user['last_logged_in']) ?> ago.
// We haven't seen you for 15 days!
We haven't seen you for <?php echo time_ago_in_words($user['last_logged_in']) ?>! 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-17T22:08:10.770

使用 PHP，您可以调用`strftime`以获得不同的输出。[在这里](http://www.php.net/manual/en/function.strftime.php)查看更多详细信息。

您还可以查看一个 jQuery 插件：[jQuery-dateFormat](http://archive.plugins.jquery.com/project/jquery-dateFormat)

玩得开心！

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-17T22:13:40.697

我使用这个功能：

```
function duration($integer)
 { 

     $seconds=$integer; 
     $minutes = 0;
     $hours = 0;
     $days = 0;
     $weeks = 0;
     $return = "";
     if ($seconds/60 >=1) 

     { 

     $minutes=floor($seconds/60); 

     if ($minutes/60 >= 1) 

     { # Hours 

     $hours=floor($minutes/60); 

     if ($hours/24 >= 1) 

     { #days 

     $days=floor($hours/24); 

     if ($days/7 >=1) 

     { #weeks 

     $weeks=floor($days/7); 

     if ($weeks>=2) $return="$weeks Weeks"; 

     else $return="$weeks Week"; 

     } #end of weeks 

     $days=$days-(floor($days/7))*7; 

     if ($weeks>=1 && $days >=1) $return="$return, "; 

     if ($days >=2) $return="$return $days days";

     if ($days ==1) $return="$return $days day";

     } #end of days

     $hours=$hours-(floor($hours/24))*24; 

     if ($days>=1 && $hours >=1) $return="$return, "; 

     if ($hours >=2) $return="$return $hours hours";

     if ($hours ==1) $return="$return $hours hour";

     } #end of Hours

     $minutes=$minutes-(floor($minutes/60))*60; 

     if ($hours>=1 && $minutes >=1) $return="$return, "; 

     if ($minutes >=2) $return="$return $minutes minutes";

     if ($minutes ==1) $return="$return $minutes minute";

     } #end of minutes 

     $seconds=$integer-(floor($integer/60))*60; 

     if ($minutes>=1 && $seconds >=1) $return="$return, "; 

     if ($seconds >=2) $return="$return $seconds seconds";

     if ($seconds ==1) $return="$return $seconds second";

     $return="$return."; 

     return $return; 

 }

echo duration(time() - strtotime($date)); 
```

# javascript - window.location 使用按钮 onclick 截断 URL

> ID：10199808
> 
> 赞同：2
> 
> 时间：2012-04-17T21:58:42.640
> 
> 标签：javascript, html, button, onclick, window.location

使用按钮 onclick 事件设置 window.location 时，结果在第二个参数名称之后被截断。

这段代码：

```
<button onclick="window.location='index.php?p=reports_manage&id=new'">create new report - button</button> 
```

正在将用户发送到此页面：

```
https://foo.com/index.php?p=reports_manage&id= 
```

即使我在最后添加了额外的参数，它仍然会在同一个地方被切断。

但是，所有这些都可以正常工作：

```
<a href="index.php?p=reports_manage&id=new">create new report - link</a>
<a href="javascript:window.location='index.php?p=reports_manage&id=new'">create new report - JS1</a>
<a href="javascript:void(0);" onclick="window.location='index.php?p=reports_manage&id=new'">create new report - JS2</a> 
```

知道是什么原因造成的吗？据我所知，该按钮早些时候工作正常，并且在没有对此代码进行任何更改的情况下就坏了。还有什么可能会影响这一点？页面上没有 javascript 错误，无论使用什么浏览器都会发生这种错误。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-17T22:37:42.780

长镜头，但也许指定按钮类型会有所帮助。在这种情况下，类型 =“按钮”。

@William：不同的浏览器有不同的先决条件，但是作为一种保障，明确的总是好的。;)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-17T22:36:09.523

使用`<input type="button" />`而不是`<button></button>`因为它有意外行为（如果用于提交表单，它甚至会提交其内容！）

# c# - 如何将基于“使用”的 GC 生命周期打开为基于“创建-处置”的生命周期？

> ID：10199809
> 
> 赞同：2
> 
> 时间：2012-04-17T21:58:54.573
> 
> 标签：c#, .net, asp.net-mvc-3

我专门参考[Impersonating user with Entity Framework](https://stackoverflow.com/questions/1954944/impersonating-user-with-entity-framework)的公认答案，其中包含以下代码：

```
using (((WindowsIdentity)HttpContext.Current.User.Identity).Impersonate())
using (var dbContext = new MyEntityFrameworkContainer())
{
    ...
} 
```

我宁愿`dbContext`只在我的存储库中的一个地方实例化，实现`IDisposable`，然后在实体被处置时处置上下文。我不确定`using`上面的两个范围是如何相互影响的，那么如何在避免使用块的同时实现这段代码在模拟方面的作用？

**补充：** 正如下面的答案所建议的，我可以简单地使用局部变量并“手动”确保资源被释放，但我在这里关心的是内部的实例化是否`using`会受到外部的影响`using`。如果这只是一生的问题，并且外部`using`没有建立任何上下文或影响内部的任何内容，那么以下答案已经回答了我的问题。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-17T22:07:53.203

您可以将它们声明为 2 个私有字段并在构造函数中实例化它们。

然后实现 Dispose() 并以相反的顺序处理它们。

然后当然调用代码（业务层）应该将该`using(){}`模式应用于存储库实例。

### 额外的：

嵌套使用不应该很重要。`Impersonate()`是影响当前线程的状态更改。使用隐含的 Dispose() 将调用 Undo()。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-17T22:00:44.863

```
var id = ((WindowsIdentity)HttpContext.Current.User.Identity).Impersonate();
//store id
//do whatever you want, for example store this variable in a field
id.Dispose(); //remove impersonation 
```

# silverlight - 通过 RelativeSource 绑定到父属性

> ID：10199810
> 
> 赞同：0
> 
> 时间：2012-04-17T21:58:54.817
> 
> 标签：silverlight, binding

我不知道出了什么问题。我希望将 DropShadowEffect 的颜色绑定到 TextBox 的前景色。当我使用 ElementName 绑定属性进行绑定时，它可以正常工作，但我需要使用 RelativeSource（在 VisualThree 中查找第一个 TextBox 对象）。

下面是我的代码（它是 Silverlight 5）：

```
<Grid x:Name="LayoutRoot" Background="White">

<TextBox x:Name="TextBox1" Foreground="Blue" MinWidth="100" HorizontalAlignment="Center" VerticalAlignment="Center">
    <TextBox.Effect>
        <DropShadowEffect x:Name="ShadowEffect" BlurRadius="60" Direction="345" ShadowDepth="50" Color="{Binding Path=Foreground.Color, RelativeSource={RelativeSource AncestorType=TextBox}}"></DropShadowEffect>
    </TextBox.Effect>
</TextBox> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-18T06:22:25.877

U 应该使用 {RelativeSource self}，因为您的效果属性依赖于 TextBox("TextBox1")，而不是 TextBox 父级。

```
<TextBox x:Name="TextBox1" Foreground="Blue" MinWidth="100" HorizontalAlignment="Center" VerticalAlignment="Center"> 
<TextBox.Effect> 
    <DropShadowEffect x:Name="ShadowEffect" BlurRadius="60" Direction="345" ShadowDepth="50" Color="{Binding RelativeSource={RelativeSource self}, Path=Foreground.Color}"></DropShadowEffect> 
</TextBox.Effect> 
```

# video - DShow 源过滤器：我是哪个过滤器实例？

> ID：10199815
> 
> 赞同：1
> 
> 时间：2012-04-17T21:59:19.470
> 
> 标签：video, camera, directshow, capture, source-filter

我有一个自定义源过滤器，通过实现`CSource`和`CSourceStream`来自 dshow 基类。`IFilterMapper2::RegisterFilter`它使用该方法以不同的名称多次导出。现在，在我的过滤器中，我想（尽快）知道正在打开的过滤器的哪个注册实例。例如，假设我有一个模拟虚拟网络摄像头的 dll。相同的 dll 导出过滤器的两个实例，因此在（比如说）Skype 中，我可以选择*virtual cam #1*和*virtual cam #2*。在 my`CSource`或`CSourceStream`I 的构造函数中，我想知道正在构造的是*虚拟凸轮 #1*还是*虚拟凸轮 #2 。*这可以做到吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-18T06:00:15.653

没有记录的方法，但有一种解决方法。由于 DirectShow 是稳定的，它应该可以很好地工作。

在您的过滤器类覆盖`IPersistPropertyBag::Load`和您使用提供的`IPropertyBag::Read`映射执行的读取中，从`HKEY_LOCAL_MACHINE\SOFTWARE\Classes...\CLSID_VideoInputDeviceCategory\Instance\<your-instance>`. 因此，您可以将所需的所有身份证明都放在那里并可以访问。

请注意，这是从应用程序的`BindToObject`调用中调用的。

![调用堆栈](../Images/767692d7c4501b95604a2dd3de554d6e.png)

我在由 IP 摄像机支持的虚拟视频输入中执行此操作[http://alax.info/blog/1233](http://alax.info/blog/1233)

# entity-framework - 在 Entity Framework 4 Code First 中映射自定义关系

> ID：10199816
> 
> 赞同：0
> 
> 时间：2012-04-17T21:59:20.667
> 
> 标签：entity-framework, entity-framework-4

我有一个模型 Vehicle 和另一个模型，因此车辆与模型之间存在一对多的关系。车辆类定义如下：

```
public class Vehicle
{
    public int VehicleId { get; set; }
    ...
    public virtual Model Model { get; set; }
} 
```

问题是我将这些类映射到现有数据库，所以我这样做：

```
modelBuilder.Entity<Vehicle>().ToTable("TB_Vehicles");
        modelBuilder.Entity<Vehicle>().Property(x => x.Color).HasColumnName("DR_Color");

        modelBuilder.Entity<Model>().ToTable("TB_Models");
        modelBuilder.Entity<Model>().Property(x => x.ModelId).HasColumnName("CD_Model");
        modelBuilder.Entity<Model>().Property(x => x.Description).HasColumnName("DS_Description"); 
```

所以我的表 TB_Models 有一列 CD_Model 是主键，我的表 TB_Vehicles 也有一列 CD_Model 是外键。我怎样才能映射它？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-17T23:03:01.920

您可以按如下方式对其进行映射。

```
 modelBuilder.Entity<Vehicle>()
            .HasOptional(v => v.Model)
            .WithMany()
            .Map(m => m.MapKey("CD_Model")); 
```

如果外键不可为空，请`HasRequired`使用`HasOptional`.

# sql - PostgreSQL - 如何获取自日期以来高于年份的行

> ID：10199825
> 
> 赞同：1
> 
> 时间：2012-04-17T21:59:59.503
> 
> 标签：sql, ruby-on-rails, ruby, postgresql, date-difference

我在`DATE`列中保存了一个日期。我尝试获取那些自该日期以来更高的行，大约一年，两年等。

,是我的应用程序中的一个参数`year`。`two years`是否可以通过查询获取这些行，或者我应该在应用层上这样做？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-17T22:02:22.367

```
SELECT *
FROM your_table
WHERE the_date_column > current_date - interval '2' year 
```

只需将 2 替换为应用程序中的参数值即可。

# android - 在哪里保存从 Web 服务获取并在活动中使用的临时数据更好？

> ID：10199827
> 
> 赞同：0
> 
> 时间：2012-04-17T22:00:18.113
> 
> 标签：android

我正在使用 asynchtasks 从 rest-ws 获取数据，并且我在某些活动中使用这些数据。我看到 2 种主要方式： - 将这些临时数据保存在活动中 - 将这些临时数据保存在我的单调应用程序控制器类（不是 mvc 控制器）中-（我不能在使用这些数据后）

但我觉得这两种方式都不是很好的主意。我怎样才能更好地解决这个问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-18T04:56:37.570

保存网络数据的最好方法是创建内容提供者，在线程/服务/异步任务中获取数据并将其插入内容提供者。通知你的活动，活动应该从内容提供者那里获取数据。查看以下 google 指南[开发 Android REST 客户端应用程序](http://www.google.com/events/io/2010/sessions/developing-RESTful-android-apps.html)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-17T22:46:24.293

将您的数据保存在您的应用程序中与许多原因有关，例如我们在谈论多少数据，以及数据的类型......等等

看看[这里](http://developer.android.com/guide/topics/data/data-storage.html)，它很好地解释了所有类型的数据存储。

# php - 简单的 php 脚本的奇怪返回

> ID：10199828
> 
> 赞同：1
> 
> 时间：2012-04-17T22:00:33.160
> 
> 标签：php, wordpress, if-statement

我有一个带有颜色的文本文件。如果选择了橙色，脚本仅返回 true。我到底想念什么？

```
$filename="colors.txt";
$words=file($filename);
shuffle($words);
$word=$words[0];

if ( $word == "yellow" ){$pid = '558';}
else if ( $word == "red" ){$pid = '557';} 
else if ( $word == "purple" ){$pid = '556';}
else if ( $word == "orange" ){$pid = '555';} 
else if ( $word == "green" ){$pid = '554';}
else if ( $word == "brown" ){$pid = '553';}
else if ( $word == "blue" ){$pid = '552';}
else {$pid = 'poop';}

echo $word;
echo $pid; 
```

colors.txt 的文本文件

```
red
green
blue
yellow
brown
purple
orange 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-17T22:04:01.710

“橙色”行是文件中的最后一行，没有以“\r\n”结尾的行。

形成[file()](http://www.php.net/manual/en/function.file.php)的文档：

> 结果数组中的每一行都将包含行尾，除非使用 FILE_IGNORE_NEW_LINES，因此如果您不希望出现行尾，您仍然需要使用 rtrim()。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-17T22:04:39.423

文本文件中的每一行还包含一个回车符和可能的换行符。改变：

```
$word=$words[0]; 
```

成为：

```
$word=trim($words[0]); 
```

应该删除任何尾随或前导空格/CR，然后您的 IF 语句应该可以正常工作。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-17T22:04:47.877

改用这个：

```
$words = file($filename, FILE_IGNORE_NEW_LINES); 
```

默认情况下，`file()`将新行添加到每个数组项的末尾。国旗`FILE_IGNORE_NEW_LINES`防止这种情况发生。实现此目的的另一种方法是`rtrim()`在每个数组项上使用。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-17T22:08:13.663

改善您的生产线：

`$words=file($filename);`

到以下：

`$words=file($filename,FILE_IGNORE_NEW_LINES);`

函数不会为每个数组元素添加新行。

[PHP函数文件（）](http://hu.php.net/manual/en/function.file.php)

PS：每次您没有得到您期望的结果时，只需检查您的过程中涉及的每个 PHP 函数的文档。也许您必须为此阅读半页，但仍然可以节省时间。

# android - 让拆分的 ActionBar 显示两倍的图标

> ID：10199845
> 
> 赞同：7
> 
> 时间：2012-04-17T22:01:59.043
> 
> 标签：android, android-actionbar, actionbarsherlock

我想要一个应用布局，就像他们用于 Gmail 的布局一样。他们有带有图标的操作栏（在我的设备上，它有用于向上导航的应用程序徽标，以及用于选择优先收件箱/收件箱/等的自定义视图），但也有某种拆分`ActionBar`，因为在底部我有几个图标（撰写、搜索、标签等）。

我怎么能这样做？我`ActionBar`通过这个 XML 实现了以下内容：

```
<?xml version="1.0" encoding="utf-8"?>
<menu xmlns:android="http://schemas.android.com/apk/res/android" >

    <item
        android:id="@+id/menu_gps"
        android:icon="@drawable/icone_gps_continu"
        android:showAsAction="always"
        android:title="@string/menu_gps"/>
    <item
        android:id="@+id/menu_sort"
        android:icon="@drawable/icone_liste_chron"
        android:showAsAction="always"
        android:title="@string/menu_liste"/>
    <item
        android:id="@+id/menu_stats"
        android:icon="@drawable/icone_statistiques"
        android:showAsAction="always"
        android:title="@string/menu_stats"/>
    <item
        android:id="@+id/menu_save"
        android:icon="@drawable/icone_terminersortie"
        android:showAsAction="always"
        android:title="@string/menu_save"/>
    <item
        android:id="@+id/menu_search"
        android:icon="@drawable/ic_launcher"
        android:showAsAction="always"
        android:title="@string/menu_search"/>
    <item
        android:id="@+id/menu_photo"
        android:icon="@drawable/icone_enregistrerphoto"
        android:showAsAction="always"
        android:title="@string/menu_photo">
    </item>
    <item
        android:id="@+id/menu_sound"
        android:icon="@drawable/icone_enregistrerson"
        android:showAsAction="always"
        android:title="@string/menu_sound">
    </item>
    <item
        android:id="@+id/menu_settings"
        android:icon="@drawable/icone_parametres"
        android:showAsAction="always"
        android:title="@string/menu_settings">
    </item>

</menu> 
```

我当然通过在清单中`ActionBar`添加`android:uiOptions="splitActionBarWhenNarrow"`我的标签来启用拆分。`<application>`

我得到的是一个空的“顶部” `ActionBar`；底部的仅显示三个图标。我想我可以在纵向模式下在顶部显示 3-4 个图标，在底部显示 5 个图标，在横向模式下所有这些图标都在顶部。

注意：即使我使用 Galaxy Nexus 在 ICS 上进行测试，我也在使用 ActionBarSherlock 以提供向后兼容性。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-04-17T22:15:37.237

看来我发的太快了，似乎不可能。

重复：

*   [如何在主操作栏和底栏中放置操作栏项目](https://stackoverflow.com/questions/9327720/how-to-place-actionbar-items-in-main-actionbar-and-bottom-bar)
*   [Android拆分操作栏，顶部和底部都有操作项？](https://stackoverflow.com/questions/8571754/android-split-action-bar-with-action-items-items-on-top-and-bottom)

显然这是不可能的。然而，他们在 gmail/gplus 中做到了，也许在底部使用自定义视图......仍然期待更好的答案！

[Reto Meier](https://plus.google.com/111169963967137030210/posts/Z3unhccSDvy)对此表示：

> 我认为在顶部和底部之间拆分操作的问题在于它会使执行操作变得更加困难。动作应该是在 Activity 上要做的最重要的事情——将它们分开在屏幕的顶部和底部意味着用户需要查看两个位置而不是一个位置。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-07-30T13:59:59.253

我也想知道这些应用程序是如何在两个栏中都有图标的，所以我反编译了其中两个。

我发现这两个应用程序**根本****没有实现`ActionBar`**并为两个栏使用自定义布局。我不确定我是否可以在这里命名这些应用，但它们是下载量超过 1000 万的知名应用。

如果您不喜欢默认设置`ActionBar`（自定义空间非常小），我强烈建议您采用相同的方式并创建自定义布局（两个栏都不需要，这取决于您的需要）。

重现拆分操作栏布局非常容易。它的高度始终`48dp`与设备无关，因此简单`LinearLayout`或`RelativeLayout`具有固定高度和一些透明图像按钮的效果非常好。只需 15 分钟，您就可以获得完全可定制的拆分操作栏。

# android - 如何使用命令在android中执行dex文件？

> ID：10199863
> 
> 赞同：19
> 
> 时间：2012-04-17T22:03:25.007
> 
> 标签：android, dex

任何人都可以分享使用命令在android中执行dex文件的方法吗？

这只是为了理解。

* * *

## 回答 #1

> 赞同：39
> 
> 时间：2012-04-17T23:51:04.737

假设您在文件 HelloWorld.java 中有以下代码：

```
public class HelloWorld {
    public static void main(String[] args) {
         System.out.println("Hello World!");
    }
} 
```

在安卓设备上运行它：

```
javac HelloWorld.java
dx --dex --output=classes.dex HelloWorld.class
zip HelloWorld.zip classes.dex
adb push HelloWorld.zip /sdcard/ 
```

对于 GB 或更早版本，您应该能够简单地执行以下操作：

```
adb shell dalvikvm -cp /sdcard/HelloWorld.zip HelloWorld 
```

对于 ICS+：

```
adb shell mkdir /sdcard/dalvik-cache
adb shell ANDROID_DATA=/sdcard dalvikvm -cp /sdcard/HelloWorld.zip HelloWorld 
```

# jquery - jQuery Mobile 复选框取消选中自身

> ID：10199873
> 
> 赞同：0
> 
> 时间：2012-04-17T22:04:25.803
> 
> 标签：jquery, asp.net-mvc-3, jquery-mobile

我为 jQuery mobile 1.0.1 中的复选框列表设置了以下代码，这在 android 设备上产生了奇怪的行为。

```
 <fieldset data-role="controlgroup">
       <div id="container">
          <div id="List1">
             <input type="checkbox" name="1" id="Team-1-Player-1"  data-theme="a"/>
             <label for="1" data-theme="a">
                <span class="ui-grid-b grid">
                   <span class="ui-block-a col1">1</span>
                   <span class="ui-block-b col2">Name <span class="pos">Position</span></span>
                   <span class="ui-block-c col3">Avg</span>
                </span>   
             </label>
             <input type="checkbox" name="2" id="Team-1-Player-2"  data-theme="a"/>
             <label for="2" data-theme="a">
                <span class="ui-grid-b grid">
                   <span class="ui-block-a col1">2</span>
                   <span class="ui-block-b col2">Name <span class="pos">Position</span></span>
                   <span class="ui-block-c col3">Avg</span>
                </span>   
             </label>
          </div>
       </div>
    </fieldset> 
```

根据页面的不同，可能有多个“列表”div，但行为是相同的。如果用户按下标签标签内的任何位置，一切正常，但如果他们按下 jquery mobile 生成的复选框图标，它将显示为选中，然后立即取消选中。这只发生在安卓设备上。

编辑：

我最终通过删除复选框图标 jquery mobile 通过 css 添加并将我自己的图标放入复选框标签的背景图像中解决了这个问题。我在复选框的更改事件中处理了选中和未选中之间的切换。感谢所有的建议。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-18T07:22:21.770

您是否尝试过 1.1.0 版本？我认为这个版本在 android 上效果更好。也许问题会自行解决

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-18T23:13:51.773

请参阅我所做的编辑。这是代码。

在 CSS 中删除 JQMs 复选框图标：

```
#container label .ui-icon
{
    display:none!important;
} 
```

然后是我的自定义检查和未选中图标的类：

```
.checkon{background-image:url("images/check.png"); background-repeat:no-repeat;}
.checkoff{background-image:url("images/uncheck.png"); background-repeat:no-repeat;} 
```

然后我编辑了我的标签标签以包含这些类：

```
<label class="checkoff" for="1" data-theme="a"> 
```

并将切换开/关绑定到输入更改事件：

```
$("#container input").live("change", function (event) {
            $(this).next().toggleClass("checkoff");
            $(this).next().toggleClass("checkon");
        }); 
```

这是一个丑陋的解决方法，我知道，但我无法弄清楚源问题，它至少现在有效。

# php - 如何在 PHP 中生成密码，就像 Devise Gem 在 Ruby on Rails 中所做的那样

> ID：10199877
> 
> 赞同：6
> 
> 时间：2012-04-17T22:04:49.370
> 
> 标签：php, ruby-on-rails, encryption, devise

我正在将一个网站从 Ruby on Rails 更新为 PHP。我需要在 Ruby on Rails 中生成 Devise Gem 生成的密码。我必须知道密码的散列方法是什么，才能使用 PHP 创建相同的方法。但是对于初学者来说，在 Ruby on Rails 中找到这些代码并不容易。如果有人知道我应该在哪里找到它，请帮助我。

这两个都是我发现的：

```
1) The configuration of encryptor is disabled in devise.rb like below:
  # config.encryptor = :sha1
2) I read the comments very carefully then I found that they using sha512 and bcrypt as default encryptor.
  # (default), :sha512 and :bcrypt. Devise also supports encryptors from others 
```

我尝试使用 PHP 以不同的方式制作相同的加密密码：

```
1) sha1('--'.$password_salt.'--'.$encrypted_password);
2) sha1($password_salt.'-----'.$encrypted_password);
3) sha1('--'.$password_salt.'--'.$encrypted_password.'--');
4) sha1($password_salt.$encrypted_password);
5) sha1($encrypted_password.$password_salt);
6) substr(hash('sha512', $password_salt.$encrypted_password, false), 20);
7) substr(hash('sha512', $encrypted_password.$password_salt, false), 0, 40);
8) hash('sha512', $encrypted_password.$password_salt, false);
9) hash('sha512', $password_salt.$encrypted_password, false);
10) substr(hash('sha512', '--'.$password_salt.'--'.$encrypted_password.'--', false), 0, 40); 
```

我无法从上述任何一个中得到相同的结果。有谁能告诉我Devise Gem的加密方法吗？？

帮我！！！

附言。我英语说的不好。即使我的英语不正确，也请不要生气。

* * *

我自己回答：

1.  加密器是 Sha1

    我只在文件夹“\config\initializers”中查看“devise.rb” 加密器被命名为“# config.encryptor = :sha1” 但是在 Ruby lib 文件夹中还有一个“devise.rb”，“\ Ruby191\lib\ruby\gems\1.9.1\gems\devise-1.0.8\lib\devise.rb" 还有一个配置为 "@@encryptor = :sha1"

2.  使用 Sha1 的加密方法 当您转到下面的文件时，您将看到算法代码：\Ruby191\lib\ruby\gems\1.9.1\gems\devise-1.0.8\lib\devise\encryptors\sha1.rb

    需要“摘要/sha1”

    module Devise module Encryptors # = Sha1 # 使用 Sha1 哈希算法加密密码。类 Sha1 < 基础

    ```
     # Gererates a default password digest based on stretches, salt, pepper and the
            # incoming password.
            def self.digest(password, stretches, salt, pepper)
                digest = pepper
                stretches.times { digest = self.secure_digest(salt, digest, password, pepper) }
                digest
            end

            private

            # Generate a SHA1 digest joining args. Generated token is something like
            #     --arg1--arg2--arg3--argN--
            def self.secure_digest(*tokens)
                ::Digest::SHA1.hexdigest('--' << tokens.flatten.join('--') << '--')
            end

        end
    end 
    ```

    结尾

所以我翻译成PHP

```
function encrypt_password($salt, $password) {
    $pepper = '';
    $digest = $pepper;
    $stretches = 10;

    for ($i=0; $i<$stretches; $i++) {
        $join = '--'.$salt.'--'.$digest.'--'.$password.'--'.$pepper.'--';
        $digest = Sha1($join);
    }
    $result = substr($digest, 0, 40);
    return $result;
} 
```

它工作得很好:-)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-20T12:16:50.573

设计代码如下所示：

```
 def self.digest(password, stretches, salt, pepper)
   ::BCrypt::Engine.hash_secret("#{password}#{pepper}",salt, stretches)
 end 
```

您可以在[How do you use bcrypt for hashing passwords in PHP? 中查看如何在 PHP 中执行 bcrypt？](https://stackoverflow.com/questions/4795385/how-do-you-use-bcrypt-for-hashing-passwords-in-php)

默认情况下，Devise 使用 10 次拉伸。

salt 看起来是加密密码的前 29 个字符。你可以做（​​在导轨中）`User.first.authenticable_salt`

辣椒应该列在其中，`config/initializers/devise.rb`但它可能会使用您的应用程序秘密令牌。

请参阅[https://github.com/plataformatec/devise/blob/master/lib/devise/models/encryptable.rb](https://github.com/plataformatec/devise/blob/master/lib/devise/models/encryptable.rb)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-17T22:34:08.810

根据 Devise Gem 的消息来源，该方法有点复杂。SHA512 部分看起来像这样：

```
function sha512_digest($password, $stretches, $salt, $pepper)
{
    $digest = $pepper;
    for ($i = 0; $i < $stretches; $i++)
    {
        $digest = hash('sha512', '--' . $salt . '--' . $digest . '--' . $password . '--' . $pepper . '--');
    }
} 
```

BCrypt 部分对我来说有点不清楚，到目前为止我唯一想到的是它是 Blowfish 加密。

# ruby-on-rails - 带有 html 的自定义验证错误消息

> ID：10199882
> 
> 赞同：4
> 
> 时间：2012-04-17T22:05:41.383
> 
> 标签：ruby-on-rails, forms, validation, messages

有没有办法在 validates 函数中将 html 添加到自定义验证错误消息中？

例如：

```
class Product < ActiveRecord::Base
  validates :legacy_code, :format => { :with => /\A[a-zA-Z]+\z/,
    :message => "Only letters allowed <a href=\"www.example.com\"> Check here </a> " }
end 
```

执行上述操作只是给出了一个字符串文字，而浏览器没有将其解释为带有标签的 html。

我尝试使用语言环境，但这似乎是一种更复杂的方法。我搜索了一堆网站，还尝试覆盖 field_error_proc 方法。

例如：

```
ActionView::Base.field_error_proc = Proc.new do |html_tag, instance|
  errors = Array(instance.error_message).join(',')
  %(#{html_tag}<span class="validation-error">&nbsp;#{errors}</span>).html_safe

end 
```

以上方法有效，但给出的错误消息数量是预期的两倍。

这里的任何帮助将不胜感激。

**通过在错误消息部分中使用 .html_safe**解决：****

 **```
<% if @user.errors.any? %>
  <div id="error_explanation">
    <div class="alert alert-error">
      The form contains <%= pluralize(@user.errors.count, "error") %>.
    </div>
    <ul>
    <% @user.errors.full_messages.each do |msg| %>
      <li>* <%= msg.html_safe %></li>
    <% end %>
    </ul>
  </div>
<% end %> 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-17T22:34:29.250

当您输出错误时，请使用`raw`

```
<%= raw f.errors %> 
```**

# ruby-on-rails - Ruby on Rails：帮助类中的模拟会话变量

> ID：10199884
> 
> 赞同：1
> 
> 时间：2012-04-17T22:06:00.210
> 
> 标签：ruby-on-rails, session, rspec, mocking

我正在尝试在控制器的帮助文件中模拟会话哈希：

**Helper_Spec:**

```
session.stub!(:[]).with("fb_token")
  RotaHelper.getListOfFriends.should == expected_friends 
```

**帮手：**

```
FbGraph::User.me(session["fb_token"]).friends 
```

**错误：**

```
NameError:
   undefined local variable or method `session' for RotaHelper:Module 
```

我不正确地存根吗？或者助手没有访问会话哈希的权限？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-18T00:33:08.220

那很奇怪。在我的助手测试中，会自动创建一个会话哈希。也许您不需要spec_helper？

顺便说一句，如果会话不是由规范助手自动创建的，您也可以通过说这是助手的方法来初始化它。像下面的代码：

```
session_hash = {}
helper.stub!(:session) { session_hash } 
```

# html - IE中的文本显示在错误的行上

> ID：10199895
> 
> 赞同：0
> 
> 时间：2012-04-17T22:07:19.513
> 
> 标签：html, css, internet-explorer

我有一些代码可以在页面底部显示徽标：

![在 Chrome 中看起来像这样](../Images/c7edbf7950b6f44643e243e8020ab9c8.png)

不幸的是，在 IE（9，打开或关闭兼容模式）中，它看起来像这样：

![在 IE 中看起来像这样](../Images/c7dbbaeb4e1ce344c1ba0b9f03e7398e.png)

我真正担心的唯一部分是文本在错误的位置。

这是代码：

```
<img src="img/logo.png" id="kwiiusIMG" height="50"/><br /><br />
<p class="kText">A Kwiius.com service by Jamie McClymont</p> 
```

CSS：

```
#kwiiusIMG {
  float: left;
  margin-left: 305px;
}

.kText {
  margin-left: 0px;
  text-align: center;
  color: #666666;
} 
```

对不起，当谈到这些东西时，我有点白痴。知道如何让 IE 正常工作吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-17T22:11:13.707

你没有清除浮动。我曾经做过这样的事情（代码未经测试）：

```
<img src="img/logo.png" id="kwiiusIMG" height="50"/>
<br />
<div style="clear: both;"></div>
<br />
<p class="kText">A Kwiius.com service by Jamie McClymont</p> 
```

我不知道整个设计，但我猜 float: left in #kwiiusIMG 根本不需要。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-17T22:20:07.953

您可以将其添加到 .kText 的现有 CSS 中，而不是添加更多 HTML 标记

```
.KText {
clear: both;
} 
```

这也避免了添加任何内联 CSS。

编辑：我还应该提到，正如 sparky672 在下面指出的那样，这使得中断标签变得不必要。他们应该被删除。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-17T22:54:59.547

您也可以在图像上制作显示块并删除左侧浮动：

```
#kwiiusIMG {
    /*float: left;*/
    margin-left: 305px;
    display: block;
}

.kText {
  margin-left: 0px;
  text-align: center;
  color: #666666;
}​​ 
```

# iphone - 如何在编辑时更改 returnKeyType？

> ID：10199896
> 
> 赞同：30
> 
> 时间：2012-04-17T22:07:23.970
> 
> 标签：iphone, objective-c, uitextfield

如何在编辑时更改 iPhone 上的返回键。我知道

```
myTextField.returnKeyType = UIReturnKeySearch; 
```

但是，这仅在我调用`[myTextField resignFirstResponder];`then`[myTextField becomeFirstResponder];`隐藏键盘然后将其带回时才有效。否则，它就和我之前的一样，在这种情况下它是“Go”。我需要根据用户输入的字符不断切换它们。

* * *

一句话：如何在键盘仍在编辑时更改键盘的返回键类型？

* * *

## 回答 #1

> 赞同：58
> 
> 时间：2012-06-01T07:04:01.447

`[textField reloadInputViews]`似乎可以解决问题...

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-05-01T03:26:44.387

前段时间找到了，忘记在这里发了。我在用：

```
- (BOOL)textField:(UITextField *)textField shouldChangeCharactersInRange: 
(NSRange)range replacementString:(NSString *)string {
    [self performSelector:@selector(addressBarTextDidChange:) withObject:nil afterDelay:0.1];
    return YES;
}

-(void)addressBarTextDidChange:(NSString *)text {
    NSString *addressText = @"..."; //Wherever you get your text from... 
    if ([addressText isEqualToString:@""]==NO) {
        if ([addressText rangeOfString:@" "].location != NSNotFound) {
            //[addressBarTextField setReturnKeyType:UIReturnKeySearch];
            if (addressBarTextField.returnKeyType!=UIReturnKeySearch) {
                [UIView beginAnimations:nil context:NULL]; //Setup the animation.
                [UIView setAnimationDuration:0.0]; //The duration for the animation.
                [addressBarTextField resignFirstResponder];
                addressBarTextField.returnKeyType = UIReturnKeySearch;
                [addressBarTextField becomeFirstResponder];
                [UIView commitAnimations];
            }
        } else {
            //[addressBarTextField setReturnKeyType:UIReturnKeyGo];
            if (addressBarTextField.returnKeyType!=UIReturnKeyGo) {
                [UIView beginAnimations:nil context:NULL]; //Setup the animation.
                [UIView setAnimationDuration:0.0]; //The duration for the animation.
                [addressBarTextField resignFirstResponder];
                addressBarTextField.returnKeyType = UIReturnKeyGo;
                [addressBarTextField becomeFirstResponder];
                [UIView commitAnimations];
            }
        }

    } else {
        if (addressBarTextField.returnKeyType!=UIReturnKeyDone) {
            [UIView beginAnimations:nil context:NULL]; //Setup the animation.
            [UIView setAnimationDuration:0.0]; //The duration for the animation.
            [addressBarTextField resignFirstResponder];
            addressBarTextField.returnKeyType = UIReturnKeyDone;
            [addressBarTextField becomeFirstResponder];
            [UIView commitAnimations];
        }
    }
} 
```

基本上，我在 0.0 秒的时间内为键盘输入和输出动画（所以用户不会看到它）。我还在检查键盘在切换之前是否已经不是我想要的键盘，因为不断切换会导致延迟。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2015-04-27T13:27:51.287

就我而言，它的工作原理如下：

```
sender.returnKeyType=UIReturnKeyNext;
[sender reloadInputViews];
[sender resignFirstResponder];
[sender becomeFirstResponder]; 
```

我不得不强制 risignFirstResponder 后跟一个 becomeFirstResponder。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2013-10-16T14:21:13.660

我制作了一个自定义类别来公开 returnKeyType。只需导入并执行`self.addField.returnKeyType = UIReturnKeySearch;`或您喜欢设置为 returnKeyType 的任何内容。您也可以在键盘已经打开时动态使用它。它会自动刷新。

这里是：

界面：

```
/*

 Simple hack for exposing returnKeyType for UISearchBar without private APIs
 For you from CodeBuffet ;)

 Enjoy!

 ~PW

*/

#import <UIKit/UIKit.h>

@interface UISearchBar (ReturnType)

@property (nonatomic, readwrite) UIReturnKeyType returnKeyType;

@end 
```

执行：

```
#import "UISearchBar+ReturnType.h"

@implementation UISearchBar (ReturnType)

UITextField *textField;

- (UITextField *) traverseForTextViewInViews: (NSArray*) views
{
    // Traverse over all views recursively until we find the tresure TextField hidden deep the UISearchBar ocean!
    for(UIView *subView in views) {
        if([subView conformsToProtocol:@protocol(UITextInputTraits)]) {
            return (UITextField *) subView;
        }
        UITextField *tv = [self traverseForTextViewInViews:subView.subviews];
        if (tv) {
            return tv;
        }
    }
    return nil;
}

#pragma mark Custom Setters & Getters

- (void)setReturnKeyType:(UIReturnKeyType)returnKeyType
{
    if (!textField) {
        textField = [self traverseForTextViewInViews:self.subviews];
    }
    textField.returnKeyType = returnKeyType;
    [self reloadInputViews];
    [textField reloadInputViews];
}

- (UIReturnKeyType)returnKeyType
{
    if (!textField) {
        textField = [self traverseForTextViewInViews:self.subviews];
    }
    return textField.returnKeyType;
}

@end 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2015-07-29T09:16:44.210

我用这 3 行代码做到了：

```
[sender setReturnKeyType:UIReturnKeyDone];
[sender resignFirstResponder];
[sender becomeFirstResponder]; 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2016-09-15T16:55:19.410

我需要根据文本字段的当前内容更新 returnKeyType (Next <--> Go)。单独设置 returnKeyType 后，文本字段上的 reloadInputViews 方法不起作用。正如其他海报所提到的，resignFirstResponder 后跟 becomeFirstResponder 是必要的。在我的情况下，当文本字段成为 firstResponder 并显示键盘时，它将动画键盘的解雇和重新出现。在较小的设备或横向模式下，它还会导致包含文本字段的视图瞬间跳转。我发现隐藏这种不需要的行为的解决方案是将 resignFirstResponder 和 becomeFirstResponder 放置在 0 秒持续时间的动画块中。

```
 [UIView animateWithDuration:0.0
                                  delay:0.0
                                options:0
                             animations:^{
                                 [textField reloadInputViews];
                                 [textField resignFirstResponder];
                                 [textField becomeFirstResponder];
                             }
                             completion:nil]; 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-04-18T04:26:01.707

您是否尝试使用 TextField 的委托：

-(BOOL)textFieldShouldBeginEditing:(UITextField *)textField { textField.returnKeyType = UIReturnKeySearch; 返回是；}

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2017-08-25T13:51:44.497

**斯威夫特 3**

更改`returnKeyType`您的`UITextField`或`UITextView`致电后：

```
textFieldOrView.resignFirstResponder()
textFieldOrView.becomeFirstResponder() 
```

尽管在某些情况下调用`textFieldOrView.reloadInputViews()`有效，但它不如上述解决方案安全。

# c++ - cin.getline() 正在跳过 C++ 中的输入

> ID：10199897
> 
> 赞同：6
> 
> 时间：2012-04-17T22:07:27.967
> 
> 标签：c++, string, getline, cin

如果我使用以下代码，getline 不会接受最后一个输入（对于“for”循环的最后一次迭代，它只是跳过它） -

```
int main()
{
    int n;
    map<string, set<string> > lst;
    string c,s,c2;

    cin>>n;

    for(int i=0;i<n;i++)
    {
            getline(cin,c); // here it skips the input for last iteration
            stringstream ss;
            ss<<c;

            bool f=1;
            while(ss>>s)
            {
                        if(f)
                        {
                             c2=s;
                             f=0;
                        }
                        else
                             lst[c2].insert(s);           
            }
    }

    for (map<string, set<string> >::const_iterator ci = lst.begin(); ci != lst.end(); ++ci)
    {
                cout<< (*ci).first <<" "<< (*ci).second.size() <<endl;
    }
} 
```

为了摆脱它，我将 cin.ignore() 放在 getline 之后。现在它接受所有输入，但我面临一个新问题 -

```
#include<iostream>
#include<string>
#include<map>
#include<set>
#include<sstream>
#include<algorithm>

using namespace std;

int main()
{
    int n;
    map<string, set<string> > lst;
    string c,s,c2;

    cin>>n;

    for(int i=0;i<n;i++)
    {
            getline(cin,c);
            cin.ignore();
            stringstream ss;
            ss<<c;

            bool f=1;
            while(ss>>s)
            {
                        if(f)
                        {
                             c2=s;
                             f=0;
                        }
                        else
                             lst[c2].insert(s);           
            }
    }

    for (map<string, set<string> >::const_iterator ci = lst.begin(); ci != lst.end(); ++ci)
    {
                cout<< (*ci).first <<" "<< (*ci).second.size() <<endl;
    }
} 
```

新问题是，在使用 c2 时，字符串的第一个字符会被删除。例如，如果我将“England Jane Doe”作为 getline 的输入，在 c2 中我将得到“ngland”。

现在如何摆脱这个问题？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2012-04-17T22:17:09.827

这：

```
cin>>n; 
```

只是读取数字。
它在流中留下尾随`'\n'`。

所以你的第一个电话`getline()`是读取一个空行，其中只包含一个`'\n'`

最好不要混用`operator>>`和`std::getline()`。您必须非常小心是否在流中留下换行符。我发现从用户那里一次读取一行是最容易的。然后分别解析该行。

```
 std::string  numnber;
 std::getline(std::cin, number);

 int n;
 std::stringstream numberline(number);
 numberline >> n; 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-17T22:21:00.803

你`cin.ignore()`在错误的地方。getline 不会留下尾随的`\n`换行符，它是执行此操作的`>>`符号。

你可能想要的是

```
cin>>n;
cin.ignore(); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-11-02T11:32:13.797

实际上 cin 缓冲区从最后一个 cin 中剩下了 \n，所以 getline 取这个 \n 字符并被终止；在getline之前忽略缓冲区的内容...

cin.ignore();

getling(cin, string_name);

//它会顺利运行

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-06-22T06:23:32.843

写吧

```
cin.ignore(); 
```

在您最后一个“>>”运算符之后。“>>”运算符在输入比特流中留下一个换行符“\n”，在输入之前需要清除它。

# objective-c - 如何将朝向屏幕边缘的 b2Body 逐渐减慢到到达边缘时速度为 0 的位置？

> ID：10199901
> 
> 赞同：1
> 
> 时间：2012-04-17T22:08:04.503
> 
> 标签：objective-c, xcode, cocos2d-iphone, box2d-iphone

我有一个 b2Body，它以未知的“linearVelocity.y”朝向屏幕顶部。当线性速度刚好低于顶部并让重力接管时，如何让线性速度减慢并为 0？

*   我尝试过 LinearDamping，但在离开屏幕顶部之前，对象并不总是足够慢。
*   我也尝试将 ApplyImpulse 与`-linearVelocity.y`when一起使用`object.position >= screen.Height - object.contentSize.height`，但这似乎并没有以足够平滑的方式减慢它的速度。

任何帮助都会很棒！

编辑：这方面的一个例子可能是游戏“小翅膀”中的高度限制

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-17T22:20:12.357

而不是在单帧中应用整个负脉冲...检测您的身体何时超过某个高度，并在多帧的过程中开始慢慢减少线速度，直到`linearVelocity`达到 0...那时，您可以简单地让重力接管。

# sql - 如何计算任何不是“string1”、“string2”、“string3”等的字符串的出现次数？

> ID：10199902
> 
> 赞同：1
> 
> 时间：2012-04-17T22:08:07.417
> 
> 标签：sql, sql-server-2008

这是针对 SQL-Server 2008 的。这是一个示例列：

```
-----------------
|    strings    |
-----------------
|    string1    |
-----------------
|    string2    |
-----------------
|    string3    |
-----------------
|    string4    |
-----------------
|      ...      |
----------------- 
```

计算任何不是“string1”、“string2”或“string3”的字符串出现次数的查询是什么？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-17T22:11:33.380

```
SELECT strings, COUNT(*) As Appearances 
FROM tbl
WHERE strings NOT IN('string1', 'string2', 'string3')
GROUP BY strings 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-17T22:18:18.083

它不清楚你想要什么

> 计算不是“string1”、“string2”或“string3”的任何字符串的出现次数？

如果你想要不是'string1'，'string2'，'string3'的字符串数量，那么你只想要

```
SELECT COUNT(*) 
FROM Table1
WHERE strings NOT IN('string1', 'string2', 'string3') 
```

[看到它在这里工作](http://sqlfiddle.com/#!3/add78/1)

如果您想要*每个字符串*的实例数不是“string1”、“string2”、“string3”，那么您需要添加一个`group by strings`类似[Magnus 的答案](https://stackoverflow.com/a/10199944/119477)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-17T22:09:38.360

这将产生一个包含两列的结果，第一列将包含字符串，第二列将包含该字符串的计数。使用 where 子句过滤掉不需要的字符串。

```
SELECT strings, COUNT(strings)
FROM table_name
WHERE strings <> 'string1'
GROUP BY strings 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-18T07:52:54.120

使用关系差分运算符，`EXCEPT`例如

```
WITH strings
     AS
     (
      SELECT * 
        FROM (
              VALUES ( 'string1' ), 
                     ( 'string2' ), 
                     ( 'string3' ), 
                     ( 'string4' )
             ) AS T ( string )
     )
SELECT text_value 
  FROM YourTable
EXCEPT
SELECT string
  FROM strings; 
```

# c++ - 如何使用 CMake 在特定构建配置中为特定目标设置特定编译器标志？

> ID：10199904
> 
> 赞同：21
> 
> 时间：2012-04-17T22:08:13.290
> 
> 标签：c++, visual-c++, cmake

我有一个 CMakeLists，我想在其中使用 C 运行时的动态版本构建一些目标，并使用静态版本构建一些其他目标。

因为这个需要针对每个目标进行设置，所以默认的设置方法是`CMAKE_CXX_FLAGS_<Config>`行不通的；这会覆盖所有目标。

为此，我尝试了以下方法：

```
# @fn       set_target_dynamic_crt
# @brief    Sets the given target to use the dynamic version of the CRT (/MD or
#           /MDd)
# @param    ...  A list of targets to which this setting should be applied.
function( set_target_dynamic_crt )
    if ( MSVC )
        message (WARNING ${CMAKE_BUILD_TYPE})
        if (CMAKE_BUILD_TYPE STREQUAL "Debug")
            set_target_properties ( ${ARGN} PROPERTIES COMPILE_FLAGS "/MDd" )
        else()
            set_target_properties ( ${ARGN} PROPERTIES COMPILE_FLAGS "/MD" )
        endif()
    endif()
endfunction() 
```

但是，这总是选择发布版本 ( `/MD`)，当我查询构建类型（`message`上面的调用）时，我得到空字符串。（我怀疑这是因为我使用的是 Visual Studio 生成器；我见过不止一个参考资料说`CMAKE_BUILD_TYPE`仅适用于 makefile...）

如何为每个目标设置这样的编译选项？

* * *

## 回答 #1

> 赞同：39
> 
> 时间：2014-01-05T03:28:17.410

在 CMake 2.8.12 中，我添加了一个 target_compile_options 命令来解决这个需求：

[http://public.kitware.com/Bug/view.php?id=6493](http://public.kitware.com/Bug/view.php?id=6493)

[http://www.cmake.org/cmake/help/git-master/manual/cmake-generator-expressions.7.html](http://www.cmake.org/cmake/help/git-master/manual/cmake-generator-expressions.7.html)

```
target_compile_options(tgt PRIVATE "/MD$<$<CONFIG:Debug>:d>") 
```

看

[http://www.cmake.org/cmake/help/git-next/manual/cmake-buildsystem.7.html#build-specification-with-generator-expressions](http://www.cmake.org/cmake/help/git-next/manual/cmake-buildsystem.7.html#build-specification-with-generator-expressions)

有关 CMAKE_BUILD_TYPE 的更多信息以及生成器表达式更好的几个原因（例如 IMPORTED 目标配置映射）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-17T23:43:59.260

对于这种情况，我知道的唯一选择是基于每个目标将您的项目拆分为子目录并使用`add_subdirectory`.

根据您的项目当前的设置方式，我猜这可能是一个痛苦的过程。

结果将是一个顶级 CMakeLists.txt，看起来像

```
cmake_minimum_required(VERSION 2.8 FATAL_ERROR)
project(Test)
add_subdirectory(libB)
add_subdirectory(libA)
add_executable(main_exe "main.cpp")
set(CMAKE_CXX_FLAGS_RELEASE "${CMAKE_CXX_FLAGS_RELEASE} /MD")
set(CMAKE_CXX_FLAGS_DEBUG "${CMAKE_CXX_FLAGS_DEBUG} /MDd")
target_link_libraries(main_exe lib_a lib_b) 
```

然后`libA/CMakeLists.txt`可以指定`MD`和`MDd`标志：

```
project(LibA)
add_library(lib_a a.cpp a.hpp)
set(CMAKE_CXX_FLAGS_RELEASE "${CMAKE_CXX_FLAGS_RELEASE} /MD")
set(CMAKE_CXX_FLAGS_DEBUG "${CMAKE_CXX_FLAGS_DEBUG} /MDd") 
```

和`libB/CMakeLists.txt`for`MT`和`MTd`标志：

```
project(LibB)
add_library(lib_b b.cpp b.hpp)
set(CMAKE_CXX_FLAGS_RELEASE "${CMAKE_CXX_FLAGS_RELEASE} /MT")
set(CMAKE_CXX_FLAGS_DEBUG "${CMAKE_CXX_FLAGS_DEBUG} /MTd") 
```

您当然可以在一个子目录和 CMakeLists.txt 中添加所有需要链接到静态 CRT 的目标，如果您有很多目标，则在另一个中添加所有动态 CRT 目标。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-17T22:17:35.817

`CMAKE_BUILD_TYPE`仅对单配置生成器有效。多配置生成器（MSVC 和 Xcode）可以在一个构建目录中构建多个配置，因此该`CMAKE_BUILD_TYPE`标志没有意义。

COMPILE_FLAGS 目标属性不区分不同的配置（有关更多信息，请参阅[kitware bugtracker](http://public.kitware.com/Bug/view.php?id=6493)）。

一种解决方法是拥有两个构建目录，类似于人们使用 Makefile 生成器的方式，并在构建用于分发的二进制文件时定义一个附加标志。（即发布配置）

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2019-11-12T12:06:10.997

假设我想向`-On`vmovq_n_u8.c 添加选项并生成 vmovq_O3.out 和 vmovq_O0.out。我`target_compile_options`通过以下方式完成了它：

```
add_executable(vmovq_O3.out vmovq_n_u8.c)
add_executable(vmovq_O0.out vmovq_n_u8.c)

target_compile_options(vmovq_O3.out PRIVATE -O3)
target_compile_options(vmovq_O0.out PRIVATE -O0) 
```

# c# - 是否有与 Delphi 的 TDBNavigator 等效的 Winforms .Net？

> ID：10199909
> 
> 赞同：4
> 
> 时间：2012-04-17T22:08:37.703
> 
> 标签：c#, winforms, delphi, data-binding

winforms.net (C#) 中是否有类似于 Delphi 的 TDBNavigator 控件的类似物，它允许用户转到第一条记录、最后一条记录、下一条记录、上一条记录（甚至可能进入编辑、插入和删除模式） ?

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-17T22:12:03.843

我相信您正在寻找的东西称为[BindingNavigator](http://msdn.microsoft.com/en-us/library/system.windows.forms.bindingnavigator.aspx)

# ruby-on-rails-3 - RoR audio_tag helper 多个源文件

> ID：10199910
> 
> 赞同：1
> 
> 时间：2012-04-17T22:08:38.343
> 
> 标签：ruby-on-rails-3, audio

我已经看到很多关于如何实现跨浏览器音频播放的 javascript 答案，但我更愿意使用 HTML5 的多个 src 标签

```
<audio>
    <source src="demo.mp3" type="audio/mp3"> 
    <source src="demo.ogg" type="audio/ogg"> 
    <!-- If no support at all. -->
    HTML5 audio not supported 
</audio> 
```

我正在使用 rails 助手标签，但看不到如何定义多个来源

audio_tag("demo.ogg", :id => "soundDemo")

我试过 audio_tag("demo.ogg", :src => "demo.mp3", :id => "soundDemo") 但这不起作用。

有谁知道可行的语法吗？谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-09T18:34:53.090

这是一个迟到的回复，但我今天遇到了这个问题，这个链接应该回答你的问题！

[https://github.com/rails/rails/pull/4661#issuecomment-8407652](https://github.com/rails/rails/pull/4661#issuecomment-8407652)

基本上这是不可能的，但将在未来的稳定版本中包含第一个参数作为源数组。

# vim - 如何在 Vim 中一次将文件中的所有指定单词从大写更改为小写？

> ID：10199911
> 
> 赞同：2
> 
> 时间：2012-04-17T22:08:39.263
> 
> 标签：vim

我有一个文件，我在其中多次用大写写了同一个单词。我想一次从大写到小写修改所有单词，除了点之后的单词。那可能吗？我在这里和那里找到了一些技巧，但在所有这些技巧中，都需要将光标放在单词的乞求处。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-17T22:13:37.857

```
:%s/\.\@<!\<THEWORD\>/theword/g 
```

将 " `THEWORD`" 和 " `theword`" 替换为所讨论的实际单词的正确大小写等效项。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-17T22:14:16.280

```
:%s/.*/\L&/g 
```

当然它必须是正确的正则表达式。这个需要所有（。*），其余的由你决定。

详情在这里：http: [//vim.wikia.com/wiki/Changing_case_with_regular_expressions](http://vim.wikia.com/wiki/Changing_case_with_regular_expressions)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-17T22:31:50.610

```
:1,$s/\([^\.]\s\s*\)MYWORD/\1myword/g 
```

这将用 myword 替换所有 MYWORD ，除非它跟在 . 和一个或多个空格。这不会改变行首的 MYWORD。对于那些，您可以再次运行以下命令：

```
:1,$s/^MYWORD/myword/ 
```

# python - 这个 ZPT 模板有什么问题？

> ID：10199914
> 
> 赞同：2
> 
> 时间：2012-04-17T22:08:47.717
> 
> 标签：python, chameleon, template-tal

我正在开发的 Python 网站中使用 Chameleon。这是一段代码：

```
<option tal:repeat="option options"
        value="${option.isoformat()}"
        selected="${if request.get_param('%s%d%s' %(day, row, type))==option.isoformat(): 'selected'}">
    ${int(option.strftime('%I'))}${option.strftime(':%M%p')}
</option> 
```

但由于某种原因，我总是收到语法错误：

```
ExpressionError: invalid syntax

- String:   "if request.get_param('%s%d%s' %(day, row, type))==option.isoformat(): 'selected'"
- Filename: /Users/theron/Sites/python/restaurateur/views/settings/hours.pt 
```

我看不出我做错了什么。有什么帮助吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-17T23:17:07.483

好吧，我想我明白了：它是无效的，因为没有 else 语句，所以当 if 语句评估为 false 时没有输出。我用以下方法修复了它：

```
<option tal:repeat="option options"
        value="${option.isoformat()}"
        tal:attributes="selected 'selected' if request.get_param('%s%d%s' %(day, row,
        type))==option.isoformat() else None">
    ${int(option.strftime('%I'))}${option.strftime(':%M%p')}
</option> 
```

# camera - 等值面纹理问题

> ID：10199915
> 
> 赞同：2
> 
> 时间：2012-04-17T22:08:47.963
> 
> 标签：camera, directx, pixel, hlsl, shader

我目前在对使用行进四面体算法生成的网格进行纹理处理时遇到问题。该代码位于 .fx HLSL 文件中。问题的描述可能是纹理似乎根据相机的位置移动。例如，如果相机被左右扫射，纹理也会随之左右移动。左右平移相机时也会出现此问题。

这是一种奇怪的效果，而且很难描述，所以我附上了一些图像，纹理 AddressU 和 AddressV 设置为 Clamp，这样更容易演示问题。

[http://i.imgur.com/JbyVZ.png](http://i.imgur.com/JbyVZ.png)

[http://i.imgur.com/nDkB1.png](http://i.imgur.com/nDkB1.png)

如您所见，将相机向右移动也会将纹理向右移动。

我可能错过了一些完全明显的东西，比如乘以某个矩阵（我试过）。任何帮助将不胜感激。

这是我的像素着色器代码。

```
float4 DiffusePS( SurfaceVertex IN ) : SV_Target 
```

{

```
float4 AmbientColor = float4(0.2, 0.2, 0.2, 1);
float AmbientIntensity = 0.2;

float4 Kd = 0.5;
float4 diffuseLight = 0.5;

float4 Pos = GetWorldSpacePos( IN.Pos );
float3 N = normalize(IN.N);
float3 L1 = normalize(LightPos1 - Pos.xyz);
float3 L2 = normalize(LightPos2 - Pos.xyz);
float3 L3 = normalize(LightPos3 - Pos.xyz);

float NdotL1 = max(0, dot(N, L1));
float NdotL2 = max(0, dot(N, L2));
float NdotL3 = max(0, dot(N, L3));

float3 I = normalize(Pos.xyz);
float3 V = normalize(-Pos.xyz);

float4 vDiff = diffuseLight * Kd * NdotL1;
float4 vDiff2 = diffuseLight * Kd * NdotL2;
float4 vDiff3 = diffuseLight * Kd * NdotL3;

float3 Color = vDiff + vDiff2 + vDiff3;
float4 derp = rockTexture.Sample(RockSampler, IN.tex.xy);

return lerp(derp ,float4(Color, 1), 0.5); 
```

谢谢你的帮助

编辑： .fx 文件的其余部分

```
#define MAX_METABALLS   400
#define IOR             2.5

#define PI 3.1415

Buffer<float4> SampleDataBuffer;

struct SampleData
{
    float4 Pos : SV_Position;
    float4 Field : TEXCOORD0;   // Gradient in .xyz, value in .w
};

struct SurfaceVertex
{
    float4 Pos : SV_Position;
    float3 N : NORMAL;
    float2 tex : TEXCOORD;
};

cbuffer constants
{
    float R0Constant = ((1.0 - (1.0/IOR)) * (1.0 - (1.0/IOR))) / ((1.0 + (1.0/IOR)) * (1.0 + (1.0/IOR)));
    float R0Inv = 1.0 - ((1.0 - (1.0/IOR)) * (1.0 - (1.0/IOR)))/((1.0 + (1.0/IOR)) * (1.0 + (1.0/IOR)));
};

cbuffer cb0 : register(b0)
{
    row_major float4x4 ProjInv;
    row_major float3x3 ViewIT;
    row_major float4x4 WorldViewProj;
    row_major float4x4 World;

    uint NumMetaballs;
    float4 Metaballs[MAX_METABALLS];    // .xyz -> metaball center, .w -> metaball squared radius

    float3 ViewportOrg;
    float3 ViewportSizeInv;

    float3 LightPos1;        // view-space light position 1
    float3 LightPos2;        // view-space light position 2
    float3 LightPos3;        // view-space light position 3

};

Texture2D rockTexture;

SamplerState RockSampler
{
    Filter = MIN_MAG_MIP_LINEAR;
    AddressU = Wrap;
    AddressV = Wrap;
};

float4 GetWorldSpacePos( float4 WindowPos )
{
    float4 ClipPos;
    ClipPos.x = (2 * ((WindowPos.x - ViewportOrg.x) * ViewportSizeInv.x) - 1);
    ClipPos.y = (-2 * ((WindowPos.y - ViewportOrg.y) * ViewportSizeInv.y) + 1);
    ClipPos.z = ((WindowPos.z - ViewportOrg.z) * ViewportSizeInv.z);
    ClipPos.w = 1;

    float4 Pos;
    Pos = mul(ClipPos, ProjInv);    // backtransform clipspace position to get viewspace position
    Pos.xyz /= Pos.w;               // re-normalize

    return Pos;
}

// Metaball function
// Returns metaball function value in .w and its gradient in .xyz
float4 Metaball(float3 Pos, float3 Center, float RadiusSq)
{
    float4 o;

    float3 d = Pos - Center;
    float DistSq = dot(d, d);
    float InvDistSq = 1 / DistSq;

    o.xyz = -2 * RadiusSq * InvDistSq * InvDistSq * d;
    o.w = RadiusSq * InvDistSq;

    return o;
}

SamplerState TriLinearSampler
{
    Filter = MIN_MAG_MIP_LINEAR;
    AddressU = WRAP;
    AddressV = WRAP;
};

// Vertex shader calculates field contributions at each grid vertex
SampleData SampleFieldVS(float3 Pos : POSITION)
{
    SampleData o;

    float3 WorldPos = mul(float4(Pos, 1), World).xyz;

    // Sum up contributions from all metaballs

    o.Field = 0;

    for (uint i = 0; i<NumMetaballs; i++)
    {
        //o.Field += WorldPos.y;
        o.Field += Metaball(WorldPos, Metaballs[i].xyz, Metaballs[i].w);

    }
    // Transform position and normals

    o.Pos = mul(float4(Pos.xyz, 1), WorldViewProj);
    o.Field.xyz = -normalize(mul(o.Field.xyz, ViewIT));  // we want normals in view space

    // Generate in-out flags

    return o;
}

SampleData PassThroughVS(SampleData IN)
{
    SampleData OUT;
    OUT = IN;
    return OUT;
}

// Estimate where isosurface intersects grid edge with endpoints v0, v1
SurfaceVertex CalcIntersection(SampleData v0, SampleData v1)
{
    SurfaceVertex o;

    // We're taking special care to generate bit-exact results regardless of traversal (v0,v1) or (v1, v0)

    float t = (2.0 - (v0.Field.w + v1.Field.w)) / (v1.Field.w - v0.Field.w);

    o.Pos = 0.5 * (t * (v1.Pos - v0.Pos) + (v1.Pos + v0.Pos));
    o.N = 0.5 * (t * (v1.Field.xyz - v0.Field.xyz) + (v1.Field.xyz + v0.Field.xyz));    

    float4 worldPos = mul(World, o.Pos);
    o.tex = worldPos.xy;

    return o;
}

// This struct stores vertex indices of up to 4 edges from the input tetrahedron. The GS code below 
// uses these indices to index into the input vertex set for interpolation along those edges. 
// It basically encodes topology for the output triangle strip (of up to 2 triangles).
struct TetrahedronIndices 
{ 
    uint4 e0; 
    uint4 e1; 
};

[MaxVertexCount(4)]
void TessellateTetrahedraGS(lineadj SampleData In[4], inout TriangleStream<SurfaceVertex> Stream)
{
    // construct index for this tetrahedron
    uint index = (uint(In[0].Field.w > 1) << 3) | (uint(In[1].Field.w > 1) << 2) | (uint(In[2].Field.w > 1) << 1) | uint(In[3].Field.w > 1);

    // don't bother if all vertices out or all vertices in
    if (index > 0 && index < 15)
    {
        uint4 e0 = EdgeTableGS[index].e0;
        uint4 e1 = EdgeTableGS[index].e1;

        // Emit a triangle
        Stream.Append( CalcIntersection(In[e0.x], In[e0.y]) );
        Stream.Append( CalcIntersection(In[e0.z], In[e0.w]) );
        Stream.Append( CalcIntersection(In[e1.x], In[e1.y]) );

        // Emit additional triangle, if necessary
        if (e1.z != 0) {
            Stream.Append( CalcIntersection(In[e1.z], In[e1.w]) );
        }

    }
}

TextureCube EnvMap;

float FresnelApprox(float3 I, float3 N)
{
    return R0Constant + R0Inv * pow(1.0 - dot(I, N), 5.0);
}

float4 ShadeSurfacePS( SurfaceVertex IN ) : SV_Target
{
    float4 Pos = GetWorldSpacePos( IN.Pos );

    float3 N = normalize(IN.N);
    float3 L1 = normalize(LightPos1 - Pos.xyz);
    float3 L2 = normalize(LightPos2 - Pos.xyz);
    float3 L3 = normalize(LightPos3 - Pos.xyz);
    float3 I = normalize(Pos.xyz);

    float3 R = reflect(I, N);

    float4 Reflected = EnvMap.Sample( TriLinearSampler, mul(ViewIT, R ) );

    float NdotL1 = max(0, dot(N, L1));
    float NdotL2 = max(0, dot(N, L2));
    float NdotL3 = max(0, dot(N, L3));

    float3 Color = NdotL1 * float3(1, 1, 1) + pow(max(dot(R, L1), 0), 32)
                    + NdotL2 * float3(0.65, 0.6, 0.45) + pow(max(dot(R, L2), 0), 32)
                    + NdotL3 * float3(0.7, 0.7, 0.8) + pow(max(dot(R, L3), 0), 32);

    return lerp(EnvMap.Sample( TriLinearSampler, mul(ViewIT, R) ), float4(Color, 1), FresnelApprox(I, N) * 0.05 );

}

float4 SimplePS( SurfaceVertex IN, uniform float4 color ) : SV_Target
{
    return color;
}

float4 DiffusePS( SurfaceVertex IN ) : SV_Target
{

    float4 AmbientColor = float4(0.2, 0.2, 0.2, 1);
    float AmbientIntensity = 0.2;

    float4 Kd = 0.5;
    float4 diffuseLight = 0.5;

    float4 Pos = GetWorldSpacePos( IN.Pos );
    float3 N = normalize(IN.N);
    float3 L1 = normalize(LightPos1 - Pos.xyz);
    float3 L2 = normalize(LightPos2 - Pos.xyz);
    float3 L3 = normalize(LightPos3 - Pos.xyz);

    float NdotL1 = max(0, dot(N, L1));
    float NdotL2 = max(0, dot(N, L2));
    float NdotL3 = max(0, dot(N, L3));

    float3 I = normalize(Pos.xyz);
    float3 V = normalize(-Pos.xyz);

    float4 vDiff = diffuseLight * Kd * NdotL1;
    float4 vDiff2 = diffuseLight * Kd * NdotL2;
    float4 vDiff3 = diffuseLight * Kd * NdotL3;

    float3 Color = vDiff + vDiff2 + vDiff3;
    float4 derp = rockTexture.Sample(RockSampler, IN.tex.xy);

    return lerp(derp ,float4(Color, 1), 0.5);
    //return lerp(NoiseTexture.Sample( NoiseSampler, IN.tex ), float4(Color, 1), FresnelApprox(V, N) * 0.05 );

    //return saturate(vDiff+vDiff2+vDiff3 + AmbientColor * AmbientIntensity);

}

DepthStencilState EnableDepthDSS
{
    DepthEnable = true;
    DepthWriteMask = 1;
};

RasterizerState WireFrameRS
{
    MultiSampleEnable = True;
    CullMode = None;
    FillMode = WireFrame;
};

RasterizerState SolidRS
{
    MultiSampleEnable = True;
    CullMode = None;
    FillMode = Solid;
};

technique10 MarchingTetrahedraWireFrame
{
    pass P0
    {
        SetRasterizerState( WireFrameRS );
        SetDepthStencilState( EnableDepthDSS, 0 );

        SetVertexShader( CompileShader( vs_4_0, SampleFieldVS() ) );
        SetGeometryShader( CompileShader( gs_4_0, TessellateTetrahedraGS() ) );
        SetPixelShader( CompileShader( ps_4_0, SimplePS( float4( 0.7, 0.7, 0.7, 1 ) ) ) );
    }
}

// Tessellate isosurface in a single pass
technique10 MarchingTetrahedraSinglePassGS
{
    pass P0
    {
        SetRasterizerState( SolidRS );
        SetDepthStencilState( EnableDepthDSS, 0 );

        SetVertexShader( CompileShader( vs_4_0, SampleFieldVS() ) );
        SetGeometryShader( CompileShader( gs_4_0, TessellateTetrahedraGS() ) );
        SetPixelShader( CompileShader( ps_4_0, DiffusePS() ) );
    }
}

// Tessellate isosurface in two passes, streaming out VS results in-between
GeometryShader StreamOutGS = ConstructGSWithSO( CompileShader( vs_4_0, PassThroughVS() ), "SV_Position.xyzw; TEXCOORD0.xyzw" );

technique10 MarchingTetrahedraMultiPassGS
{
    pass P0
    {
        SetVertexShader( CompileShader( vs_4_0, SampleFieldVS() ) );
        SetGeometryShader( StreamOutGS );
        SetPixelShader( NULL );
    }

    pass P1
    {

        SetRasterizerState( SolidRS );
        SetDepthStencilState( EnableDepthDSS, 0 );

        SetVertexShader( CompileShader ( vs_4_0, PassThroughVS() ) );
        SetGeometryShader( CompileShader( gs_4_0, TessellateTetrahedraGS() ) );
        SetPixelShader( CompileShader( ps_4_0, DiffusePS() ) );
    }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-18T21:03:23.447

纹理坐标当前是通过将顶点位置乘以世界矩阵来生成的：

```
CalcIntersection()
....
    float4 worldPos = mul(World, o.Pos);
    o.tex = worldPos.xy;
.... 
```

因此，摄像机平移必须改变这些输入之一。猜测它可能是世界矩阵（即相机平移实际上是被移动的对象），尝试切换到不依赖于世界矩阵的纹理坐标生成方法。例如：

```
CalcIntersection()
...
    o.tex = o.Pos.xy;
... 
```

**编辑**：因为那不起作用，它必须是被相机平移修改的位置，并且看着 SampleFieldVS() 有一条线似乎正在这样做：

```
o.Pos = mul(float4(Pos.xyz, 1), WorldViewProj); 
```

因此，您需要做的是在修改之前将位置保存在那里。您必须将其保存在 SampleData 中，因此将其添加到 SampleData 结构的末尾：

```
float2 tex1 : TEXCOORD1; 
```

然后在 SampleFieldVS() 末尾添加保存行

```
o.tex1 = mul(float4(Pos.xyz, 0), World).xy; 
```

最后删除 ' *float4 worldPos = mul(World, o.Pos); o.tex = worldPos.xy;* ' 在 CalcIntersection() 的末尾并替换为：

```
o.tex = 0.5 * (t * (v1.tex1 - v0.tex1) + (v1.tex1 + v0.tex1)); 
```

# java - AChartEngine 不显示 Y 和 X 轴值和标签计数

> ID：10199917
> 
> 赞同：1
> 
> 时间：2012-04-17T22:08:52.847
> 
> 标签：java, android, date, achartengine

我正在尝试使用此引擎构建折线图。它像我预期的那样绘制，只是没有显示我的价值观。我看不到我的错误在哪里，请帮助我。这是代码：

```
private View getLineChart(Context context)
{
    List<Double> weights = App.helper.getWeights();
    List<String> weightsDate = App.helper.getWeightsDate();

    for(int x = 0; x < weights.size(); x++)
    {
        for(int y = x + 1; x < weights.size(); x++)
        {
            if(weights.get(x) > weights.get(y))
            {
                double temp = weights.get(x);
                weights.set(x, weights.get(y));
                weights.set(y, temp);
            }
        }
    }

    List<Date> dateList = new ArrayList<Date>();

    for(int x = 0; x < weightsDate.size(); x++)
    {
        Date date = new Date(weightsDate.get(x));
        dateList.add(date);
    }

    Collections.sort(dateList);

    XYMultipleSeriesRenderer renderer = new XYMultipleSeriesRenderer();
    XYSeriesRenderer xyRenderer = new XYSeriesRenderer();
    XYMultipleSeriesDataset dataset = new XYMultipleSeriesDataset();

    renderer.addSeriesRenderer(xyRenderer);
    renderer.setChartTitle("Histórico de Peso");

    renderer.setYTitle("Peso");
    renderer.setYLabels(weights.size());
    renderer.setYAxisMin(weights.get(0));
    renderer.setYAxisMax(weights.get(weights.size() - 1));
    renderer.setYAxisAlign(Align.LEFT, 0);
    renderer.setYLabelsAlign(Align.LEFT, 0);

    renderer.setXTitle("Data");
    renderer.setXLabels(weights.size());
    renderer.setXAxisMin(dateList.get(0).getTime(), 0);
    renderer.setXAxisMax(dateList.get(dateList.size() - 1).getTime(), 0);       
    renderer.setXLabelsAlign(Align.CENTER);

    renderer.setAxisTitleTextSize(12);
    renderer.setChartTitleTextSize(12);
    renderer.setLabelsTextSize(10);
    renderer.setLegendTextSize(12);
    renderer.setPointSize(5f);  
    renderer.setApplyBackgroundColor(true);
    renderer.setBackgroundColor(Color.parseColor("#F5F5F5"));
    renderer.setMarginsColor(Color.parseColor("#F5F5F5"));
    renderer.setAxesColor(Color.LTGRAY);
    renderer.setLabelsColor(Color.parseColor("#5f5f5f"));          
    renderer.setShowGrid(true);
    renderer.setGridColor(Color.GRAY);

    XYSeries series = new XYSeries("Peso");

    for(int x = 0; x < weights.size(); x++)
    {
        series.add(weights.get(x), dateList.get(x).getTime());
    }

    dataset.addSeries(series);

    View view = ChartFactory.getLineChartView(context, dataset, renderer);

    Log.d("WEIGHT_TEST", String.valueOf(weights.get(0)));

    return view;
} 
```

我在我的 onResume 方法上调用它。图表已绘制，但不考虑最小值和最大值，也不考虑标签计数。另外，有没有办法可以在 X 轴上显示 dd/MM/yyyy 日期？

# javascript - 仅获取在 javascript 中构造成字符串的文本节点

> ID：10199921
> 
> 赞同：1
> 
> 时间：2012-04-17T22:09:19.633
> 
> 标签：javascript, jquery, html

```
<div>
some text I want
<span><sup>text I don't want</sup></span>
</div> 
```

以上是一些示例html。我希望能够只选择 div 的文本，而不选择位于跨度中的子 html 文本。有什么简单的方法可以做到这一点，还是我必须想出一些方法来破解标记？

我试过使用 jquery 选择器来选择 div，但是当我最终调用 .text() 方法时，你最终会再次得到所有文本......我是否遗漏了一些非常明显的东西？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-17T22:16:45.297

可能是像下面这样的东西应该给你文字，

[**演示**](http://jsfiddle.net/skram/Pga2M/1/)

```
var justText = $('div').contents().filter(function () {
    if (this.nodeType == 3) return true;
}).text(); 
```

请注意，这也会返回换行符和空格。

你可以`$.trim`用来摆脱那些，

```
justText = $.trim(justText); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-18T01:40:47.303

只需收集直接子节点的文本：

```
function getImmediateText(el) {
  var node, nodes = el.childNodes;
  var text = '';

  for (var i=0, iLen=nodes.length; i<iLen; i++) {
    node = nodes[i];

    if (node.nodeType == 3) {
      text += node.data;
    }
  }
  // You may want to trim excess white space here
  return text;
} 
```

这将适用于每个浏览器，并且不需要库支持。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-17T22:17:46.490

尝试：

```
var text = $('div').contents().get(0); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-17T22:18:24.423

尝试这个：

```
$('div').clone().children().remove().end().text() 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-04-17T22:45:36.370

jQuery 是完全没有必要的。剥离所有 HTML：

```
var text = node.innerHTML.replace(/<.+>/, ''); 
```

[使用 jQuery演示](http://jsfiddle.net/rudiedirkx/Pga2M/3/)选择 div。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-04-17T22:39:47.013

可以在此处找到示例的完整解释答案：http: [//jsfiddle.net/xHcPU/](http://jsfiddle.net/xHcPU/)

```
//elem.childNodes is a NodeList containing all child nodes of the array
//This includes every node - text and elements
// https://developer.mozilla.org/En/DOM/Node.childNodes
var childNodes = document.getElementById( 'special' ).childNodes;

//arr.reduce receives an array-like object and a callback
// https://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/Array/Reduce

//We use func.call to call arr.reduce with the childNodes as the this variable
// https://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/Function/call
var out = [].reduce.call( childNodes, function ( ret, child ) {

    //if a node's nodeType is 3, you can safely say it's a text node
    // https://developer.mozilla.org/en/nodeType
    if ( child.nodeType === 3 ) {
        ret += child.nodeValue.trim();
    }
    //if it's any other node, we just ignore it
    return ret;

}, '' );

//out will now contain the string you seek 
```

请注意，这里使用的两个 ES5 函数`Array.prototype.reduce`和`String.prototype.trim`可以很容易地替换为 shim、您自己的实现，或者，如果存在，则可以使用 jQuery 等价物。我不记得有一个`reduce`等价物，但我确实相信存在`trim`一个。

# sql - 在 Sql Server 中以任意顺序查找字符

> ID：10199927
> 
> 赞同：0
> 
> 时间：2012-04-17T22:09:49.343
> 
> 标签：sql, sql-server, sql-server-2005

我在 sql server 2005 中有一个包含西班牙语单词的数据表。我已经将每个单词存储在一行中。给定一个 char 数组，我想找到所有包含这些字符的单词，而不是它们出现的顺序。例如，“avi”应该匹配“avion”和“iva”。可能吗？感谢您的关注。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-17T23:25:11.750

最简单的做法是拆分和旋转，然后加入。

所以 avi 在一个字母表中变成了三行：

```
a
v
i 
```

然后加入单词列表`INNER JOIN ON CHARINDEX(letter, word) > 0`

利用`GROUP BY word`

和`HAVING COUNT(*) = (SELECT COUNT(*) FROM letters)`

在这个例子中，我刚刚从这里挑选并修改了一个 cte[在 Sql Server 2005 中将一个字符串拆分为单个字符，](https://stackoverflow.com/questions/6367283/split-a-string-into-individual-characters-in-sql-server-2005)以避免不得不用数字表来愚弄（但我通常可能会使用数字表来做我的数据透视）。

[https://data.stackexchange.com/stackoverflow/query/67103/http-stackoverflow-com-questions-10199927-find-chars-in-any-order-in-sql-server](https://data.stackexchange.com/stackoverflow/query/67103/http-stackoverflow-com-questions-10199927-find-chars-in-any-order-in-sql-server)

```
DECLARE @t AS TABLE (search varchar(100));
INSERT INTO @t VALUES ('avi');

DECLARE @words AS TABLE (word varchar(100));
INSERT INTO @words VALUES ('avion'), ('iva'), ('name');
with cte as
(
  select substring(search, 1, 1) as letter,
         stuff(search, 1, 1, '') as search,
         1 as RowID
  from @t
  union all
  select substring(search, 1, 1) as letter,
         stuff(search, 1, 1, '') as search,
         RowID + 1 as RowID
  from cte
  where len(search) > 0
)
,letters AS (
  SELECT DISTINCT letter FROM cte
)
SELECT words.word
FROM letters
INNER JOIN @words AS words
    ON CHARINDEX(letter, word) > 0
GROUP BY words.word
HAVING COUNT(*) = (SELECT COUNT(*) FROM letters) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-19T10:28:38.727

感谢大家的回答。最后，我通过在 Sql Server 中创建一个能够评估正则表达式的程序集来解决这个问题。这是用作基础的文章：http: [//www.codeproject.com/Articles/42764/Regular-Expressions-in-MS-SQL-Server-2005-2008](http://www.codeproject.com/Articles/42764/Regular-Expressions-in-MS-SQL-Server-2005-2008)

此致。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-17T23:39:43.993

为什么不：

```
SELECT * FROM words WHERE word LIKE '%a%' AND word LIKE '%v%'AND word LIKE '%i%' 
```

这会消耗“大量”资源，因此您不应在 >1M 行上使用它（取决于您的服务器）。

# jquery - MVC3 显示来自 .blur 上的 DataAnnotations 属性的描述

> ID：10199933
> 
> 赞同：-1
> 
> 时间：2012-04-17T22:10:40.043
> 
> 标签：jquery, asp.net-mvc-3, data-annotations

mvc3 DataAnnotations 有一个 Description 属性：

例如

```
[Display (Name="Title", Description="description about the title")]
public string Title { set; get}; 
```

在我看来，我想在 .blur 上使用 jquery 显示输入的描述文本。

```
<script type="text/javascript">
   $(function () {
     $("#title").blur(function () {
        ???
    });
}); 
```

```
@Html.LabelFor(model => model.Title)
//description here, not sure how to map it.
@Html.LabelFor()//description would go here
@Html.TextBoxFor(model => model.Title)
@Html.ValidationMessageFor(model => model.Title) 
```

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-17T22:18:19.813

我以前从未使用过描述，但假设它可能添加了一个标题标签，那么你可以使用它：

```
var desc = $(this).attr("title");
alert(desc); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-17T22:29:13.523

我不认为添加描述会为您的输入元素添加标题标签。您可能想提一下，当您创建这样的文本框时

```
@Html.TextBoxFor(model => model.Title, new {@title="Your description"}) 
```

这将为您的输入元素生成一个标题标签，正如 minus4 所提到的，您可以使用 jQuery 来访问它。

```
$(function () {
  $("#Title").blur(function () {
       alert($(this).attr("title"));
  });        
}); 
```

您可能想要使用通用选择器而不是特定选择器 (ID)，类似于所有这些输入元素的类名

**编辑：** 基于关于通用选择器和特定选择器的评论

每个元素的 ID 应该是唯一的，所以如果你有 8 个元素，那么元素将（并且应该）有 8 个唯一的 ID。在这种情况下，您需要通过 ID 将您的函数绑定到 8 个不同的项目，如下所示

```
 $("#Title,#Name,#City,#JobTitle,#SomeOther,#LastName,#Hi,#Ho").blur(function () {
           alert($(this).attr("title"));
    }); 
```

但是如果你有一个应用于所有这些元素的公共类，你可以像这样使用它（下面将函数绑定到所有具有 css 类值的元素`mySimpleClass`

```
 $(".mySimpleClass").blur(function () {
           alert($(this).attr("title"));
    }); 
```

您可以使用其他选择器，例如子选择器。（下面的代码会将您的功能绑定到`divContainer`div中存在的所有文本类型的输入元素

```
 $("#divcontainer input type[text]").blur(function () {
           alert($(this).attr("title"));
    }); 
```

要在使用 Html.TextBox 作为 HTML 助手时将 Css 类添加到您的输入元素，您可以像这样使用它

```
@Html.TextBoxFor(model => model.Title, new {@title="Your description", @class="mySimpleClass"}) 
```

# linq-to-sql - 在 SQL Azure 上重试 LINQ-TO-SQL 逻辑 - 高效实现？

> ID：10199935
> 
> 赞同：6
> 
> 时间：2012-04-17T22:10:40.833
> 
> 标签：linq-to-sql, azure-sql-database

我有一个在 Azure 中运行的使用 LINQ-TO-SQL 的相当大的 Web 应用程序，我遇到了来自 SQL-Azure 的瞬态错误，因此需要实现重试。我知道[瞬态故障处理框架](http://windowsazurecat.com/2011/02/transient-fault-handling-framework/)和几个提供如何使用它的示例的站点，但看起来您必须将每个 LINQ 查询包装在类似于以下内容的内容中：

```
RetryPolicy retry = new RetryPolicy<MyRetryStrategy>(5, TimeSpan.FromSeconds(5));
Result = retry.ExecuteAction(() =>
{
   … LINQ query here...
}); 
```

在我的数据层中有数百个 LINQ 查询，这看起来真的很混乱，而且很多时候查询在结果被枚举之前并没有真正执行。例如，我的数据层中的大多数函数都将 IQueryable<> 返回到业务层（这使得它们比返回列表更灵活）。所以这意味着你必须用数据库重试逻辑乱扔你的业务逻辑层——丑陋。

所以我想为了将重试逻辑保留在数据层中，我必须将 .ToList()'s 放在我的所有查询中，以便它们在那里执行，而不是在上面的层中。

我真的希望有一种方法可以在某些基类中实现重试逻辑，而不必更改我的所有查询。好像EF也会有这个问题。

**尝试与 SQL-Azure 团队进行自动重试是否是真正的答案，所以我们不必在代码中担心这一点？**

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-12-22T22:49:29.420

在需要实现类似这样的东西之后，我继续将它变成了一个库：[https](https://github.com/daveaglick/LinqToSqlRetry) ://github.com/daveaglick/LinqToSqlRetry （MIT 许可并在 NuGet 上可用）。

您可以`SubmitChanges()`改写来重试调用`SubmitChangesRetry()`：

```
using(var context = new MyDbContext())
{
  context.Items.InsertOnSubmit(new Item { Name = "ABC" });
  context.SubmitChangesRetry();
} 
```

您还可以使用`Retry()`扩展方法重试查询：

```
using(var context = new MyDbContext())
{
  int count = context.Items.Where(x => x.Name == "ABC").Retry().Count();
} 
```

具体的重试逻辑由策略控制。在后台，重试机制如下所示：

```
int retryCount = 0;
while (true)
{
    try
    {
        return func();
    }
    catch (Exception ex)
    {
        TimeSpan? interval = retryPolicy.ShouldRetry(retryCount, ex);
        if (!interval.HasValue)
        {
            throw;
        }
        Thread.Sleep(interval.Value);
    }
    retryCount++;
} 
```

了解调用中的函数`func()`和`retryPolicy`对象是根据使用情况提供的。这只是让您了解重试循环期间发生了什么。只需在存储库中查看更多信息。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-18T08:12:02.753

我不知道一个好的解决方案，因为 LINQ to SQL 不允许我们拦截查询。但是一点代码重构可能会有所帮助。类似的东西（伪代码）：

```
public Result QueryWithRetry(IQueryable query)
{
      RetryPolicy retry = new RetryPolicy<MyRetryStrategy>(5, TimeSpan.FromSeconds(5)); 
     (() => 
     { 
       return retry.ExecuteAction(query);
     }
} 
```

现在调用这个方法稍微容易一些：

结果 = QueryWithRetry(... LINQ 查询在这里...);

但是，仍然需要修改您的代码并更改每个查询。

此致，

明旭。

# c# - 将自动增量添加到已填充的 DT--更新值

> ID：10199936
> 
> 赞同：0
> 
> 时间：2012-04-17T22:11:05.137
> 
> 标签：c#, datatable, datacolumn

我有一个从 csv 文件中读取的 DataTable。我需要在从文件中读取 DT 之后向 DT 添加一个 ID AUTOINCREMENT 列（我使用的是 CSV 解析器，所以我不必 readLine，即为我将数据加载到 DT）

我正在添加具有 autoincrementseed 和 autoincrementstep 值的 DataColumn 确定。

我的问题是：如何让 DT 使用 DT 中已经存在的行的值分配 ID（填充 DataColumn）？我不关心将行的内容与特定数字匹配，我只想拥有一个可预测且明确的行 ID。

请注意，我没有使用数据库来支持此 DataTable。我只是利用我的 CSV 解析器从磁盘读取文件、解析它并返回一个新的 DataTable 的能力。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-17T22:14:22.493

添加列，遍历数据并设置 id，然后添加 autoinc 并将种子设置为 dataset.rows.count。

这几乎就是你在 sql 表中做同样事情的方式。

# grails - 文件上传和数据验证即服务

> ID：10199937
> 
> 赞同：0
> 
> 时间：2012-04-17T22:11:10.597
> 
> 标签：grails, saas

我们需要处理客户提供的数据文件以上传到我们的基于网络的服务中。由于许多供应商有同样的需求——文件上传和数据文件验证——我认为可能有提供这种服务的供应商，或者至少有一些好的插件来最小化自定义编码。我还没有找到任何作为服务。有人知道吗？如果没有，Grails 有什么用吗？谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-07T20:53:57.197

试试这个服务：[Filepicker.io](https://www.filepicker.io/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-18T11:36:41.720

作为对设计问题的快速回答。我会看看[RESTFul](http://grails.org/doc/1.3.7/guide/13.%20Web%20Services.html) Web 服务来解决这样的问题。允许您的服务接收 InputStream 并在服务中进行验证。

如果您不熟悉 Web 服务，我相信您会经历一些学习痛苦，但我希望这对您来说是一个很好的起点。享受 ：）

# c# - 是否有用于 C++ 的编译器作为服务？

> ID：10199940
> 
> 赞同：11
> 
> 时间：2012-04-17T22:11:27.010
> 
> 标签：c#, c++, compiler-construction, modeling

**简而言之：我正在寻找像[Roslyn](http://blogs.msdn.com/b/visualstudio/archive/2011/10/19/introducing-the-microsoft-roslyn-ctp.aspx)这样的东西，但对于 C++。**

详细地：

我正在处理 ac# 项目，我必须使用 c++ 文件。我有一堆 .h（大约 250 个文件）和 .cpp，我想映射这些文件中定义的类和函数以及其他什么。

它用于建模任务。我不想使用实际的 c++ 库。

我没有编写 c++ 代码，所以我无法确定是否有任何地方有嵌套类。所以这不是一个“简单”的正则表达式任务。

该项目是c#，我想使用的库是c++。我无法改变这一点。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-04-17T23:10:47.940

我相信[libclang](http://clang.llvm.org/doxygen/group__CINDEX.html)有你想要的功能。它基本上是一个 C 接口，用于访问存储在 clang 的 C/C++ AST 中的大部分信息。文档有点简洁，所以[这里](http://devimages.apple.com/llvm/videos/Libclang.mov)有一个很好的视频，介绍了它可以用一些例子做什么。

# jquery - 在 JQuery 中停止父函数或方法

> ID：10199942
> 
> 赞同：2
> 
> 时间：2012-04-17T22:11:28.897
> 
> 标签：jquery, function, methods

我有以下代码：

```
$("#add-button").click( function(add_color) {

    $.each( $("input[name='color[]']"), function () {

        if( color_selected == $(this).val() )
        {
            alert( "Color already choosen" );
            return false;
        }

    });

    alert("Here is the end of add-button");

}); 
```

如果调用 return false，我需要停止代码，但 JQuery 仅停止 $.each 方法。

我使用“Event.stop(add_color)”而不是“return false”并且它有效，但我不知道这是否正确。

任何人都可以帮助我吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-17T22:13:52.413

你总是可以这样做：

```
$("#add-button").click( function(add_color) {
    var doIStop = false;
    $.each( $("input[name='color[]']"), function () {

        if( color_selected == $(this).val() )
        {
            alert( "Color already choosen" );
            doIStop = true;
        }

    });
    if(doIStop) {
        return false;
    }
    alert("Here is the end of add-button");
}); 
```

不过，Event.stop 通常没问题。

# objective-c - 临时 NSStrings 何时发布？

> ID：10199943
> 
> 赞同：0
> 
> 时间：2012-04-17T22:11:31.757
> 
> 标签：objective-c, memory-management, nsstring

我正在尝试查找我的一个 iOS 程序中的内存泄漏。我想我已经把它钉在了与这些类似的几行上：

```
NSString *s1Upper = [s1 uppercaseString];
s1Upper = [s1Upper stringByTrimmingCharactersInSet: 
    [NSCharacterSet whitespaceCharacterSet]]; 
```

（我知道从逻辑的角度来看这两行没有意义，只是说明了我的记忆问题。）

假设 s1 是 @"abc "（以空格结尾）。我理解 NSStrings 的方式，s1Upper 在第一行代码之后指向一个 NSString（@"ABC" 以空格结尾）。在第二行之后，它指向不同的 NSString（@"ABC" 没有空格）。

我的问题：第一个 NSString 什么时候发布？

我的猜测是当当前的 NSAutoreleasePool 耗尽时它会被释放。在这种情况下，我有一个后续问题：我如何影响这一点并控制排水？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-17T22:15:02.517

它是自动释放的，即在自动释放池耗尽时释放。通常在当前运行循环结束时。

在这种情况下，您无法真正更改它。你能做的就是`retain`它，然后`release`当你知道它是安全的时候。这将防止它被自动释放池排水管释放。

您无法阻止这些对象自动进入自动释放池，因为该方法的内部实现会这样做。您只能通过保留对象来确保自动释放不会将保留计数降至零。

# c# - websocket 库，可轻松升级到 .net4.5 websockets

> ID：10199948
> 
> 赞同：4
> 
> 时间：2012-04-17T22:11:43.187
> 
> 标签：c#, .net, .net-4.0, websocket, .net-4.5

我希望将 WebSocket 支持添加到现有的彗星服务器实现中，我想知道是否有任何可靠/稳定的 .Net4 WebSocket 库，当我们升级到 .Net4.5（并利用包含的 WebSocket API）。

立即使用 .Net4.5 会更明智吗？就我的目的而言，它似乎很稳定。我可以使用 4.5beta 版吗？

# mysql - 计数值出现在 MySQL 中特定列中的次数

> ID：10199950
> 
> 赞同：58
> 
> 时间：2012-04-17T22:11:44.583
> 
> 标签：mysql, aggregate-functions

以前可能有人问过这个问题，但是我无法通过无数的搜索结果。

给定一个非规范化的 MySQL 表，计算使用 x 列的每个不同值的次数的最优化查询是什么？

例如，给定一个包含

```
mike
mary
mike 
```

返回结果如：

```
mike 2
mary 1 
```

从 MySQL 文档来看，这似乎`count`是一个可以与 一起使用的聚合函数`GROUP BY`，但它没有做我想要的（它返回 中的总行数`GROUP BY`，而不是每行的出现次数。即这不是工作`SELECT count(email) as c FROM orders GROUP BY email`

* * *

## 回答 #1

> 赞同：100
> 
> 时间：2012-04-17T22:13:49.970

```
select email, count(*) as c FROM orders GROUP BY email 
```

* * *

## 回答 #2

> 赞同：25
> 
> 时间：2012-04-17T22:15:04.627

```
SELECT column_name, COUNT(column_name)
FROM table_name
GROUP BY column_name 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-04-17T22:18:11.607

看一下按功能分组。

group by 函数所做的几乎是对给定字段的相似值进行分组。然后，您可以使用 COUNT 函数显示该值被分组的次数。

[MySQL 文档](http://dev.mysql.com/doc/refman/5.0/fr/group-by-functions.html)

您还可以将 group by 函数与 MySQL 定义的大量其他函数一起使用（参见上面的链接）。

```
mysql> SELECT student_name, AVG(test_score)
    ->        FROM student
    ->        GROUP BY student_name; 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-17T22:14:30.143

```
select name, count(*) from table group by name; 
```

我认为应该这样做

# java - 为什么列表的 remove() 方法采用 Object 而不是 T？

> ID：10199951
> 
> 赞同：2
> 
> 时间：2012-04-17T22:11:47.977
> 
> 标签：java, api, list

> **可能重复：**
> [为什么 Java 集合删除方法不是通用的？](https://stackoverflow.com/questions/104799/why-arent-java-collections-remove-methods-generic)

有谁知道为什么`MyDamnedUnclearList.remove()`方法采取`Object element`而不是`T element`（或`V extends T element`）？

我花了两个小时才找到一个混合了Java 类型`int`和`Integer`Java 类型的错误（在`List<Thread>`列表中......

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-17T22:17:36.200

该问题与现有代码和规范的向后兼容性有关。

[Map.get(Object key) 不是（完全）通用的原因是什么](https://stackoverflow.com/questions/857420/what-are-the-reasons-why-map-getobject-key-is-not-fully-generic)

它全部在 Javadoc 的详细信息中：

> 布尔删除（对象 o）
> 
> 从此集合中移除指定元素的单个实例（如果存在）（可选操作）。更正式地说，如果这个集合包含一个或多个这样的元素，则删除一个元素 e 使得 (o==null ? e==null : o.equals(e))。如果此集合包含指定元素（或等效地，如果此集合因调用而更改），则返回 true。

因此，您会看到对象是否具有相同类型只是它们相等并不重要。

# visual-studio - 解码windows phone内存性能分析报告

> ID：10199953
> 
> 赞同：1
> 
> 时间：2012-04-17T22:11:55.700
> 
> 标签：visual-studio, performance, windows-phone-7

我对内存进行了性能分析，它生成的分析报告对我来说并不完全清楚。警告是“System.Int32[] 的实例占分配的 80.90%。分析堆摘要以获取新的分配或视觉效果。”

该报告显示 14890 个 Int32 实例占用了 73541684 字节的内存。我不明白 15000 个整数值如何占用 70MB 的内存。它是一个 32 位整数。我错过了什么？

应用程序的内存使用量在内存分析会话中比在 CPU 分析会话中更多，但我认为这是由于分析本身消耗了一些内存。

[http://i.imgur.com/FI5My.png](http://i.imgur.com/FI5My.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-17T22:24:05.140

这并不是说您有约 15,000 个实例，`Int32`而是您有约 15,000 个**数组**实例`Int32`（即`System.Int32[]`），其中最大的是 1,536,012 字节，平均大小为 4,909 字节，这些占所有内存分配的 80.90%分析。

# python - 限制每个 App Engine 实例的任务请求数

> ID：10199963
> 
> 赞同：1
> 
> 时间：2012-04-17T22:12:49.090
> 
> 标签：python, google-app-engine, memory-management, python-2.7, task-queue

我有一个 Google App Engine 应用程序，它会定期处理大量内存密集型长时间运行的任务。我在 Python2.7 运行时以线程安全模式使用任务队列 API，因此我的每个实例都同时处理多个任务。结果，我经常收到以下错误：

> 总共服务 8 个请求后，超过了 137.496 MB 的软私有内存限制
> 
> 处理完这个请求后，发现处理这个请求的进程占用了太多内存，被终止了。这可能会导致一个新进程被用于对您的应用程序的下一个请求。如果您经常看到此消息，则您的应用程序中可能存在内存泄漏。

据我所知，每个实例都承担 8 个任务，最终达到软内存限制。这些任务开始使用非常少量的内存，但最终增长到大约 15-20MB。

有什么方法可以限制告诉 App Engine 为一个实例分配不超过 5 个请求？或者告诉 App Engine 任务预计在 10 分钟内使用 20MB 内存并进行相应调整？

我不想使用后端 API，因为我希望处理任务的实例数量能够自动扩展，但如果这是唯一的方法，我想知道如何构建它。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-04-17T23:25:30.787

目前没有任何方法可以就此向 App Engine 基础架构提供建议。如果您的任务现在不应该运行，您可以让它们返回非 200 状态代码，在这种情况下，它们将被自动重试（可能在另一个实例上），但这可能会导致大量流失。后端可能是您最好的选择。

如果您设置动态后端，它们只会根据任务队列流量的需要启动。您可以通过将后端的 URL 指定为“目标”参数来将任务发送到后端。

您可以通过使用拉取队列获得对任务执行的更多控制。然后，您可以根据自己的选择启动后端（或使用推送队列任务），并让实例以任何适合的方式将任务从拉取队列中拉出。

# ruby-on-rails - 如何删除/卸载旧版本的 gem

> ID：10199965
> 
> 赞同：19
> 
> 时间：2012-04-17T22:13:15.807
> 
> 标签：ruby-on-rails, twitter-bootstrap, rubygems, bundler

我在运行 Rails 服务器时更新了一个 gem，现在我的 gemset 中安装了两个版本的 gem。

我更新了使用`bundle update bootstrap-sass`，现在同时拥有`2.0.1`和`2.0.2`。

服务器似乎提供了 2.0.2 版本，所以我认为它应该在更新时删除了 2.0.1 版本，而不是因为当时正在使用 gem。

如何正确更新它以便服务器将使用 2.0.2 而不是 2.0.1，或者如何删除 2.0.1 版本的 gem？

* * *

## 回答 #1

> 赞同：31
> 
> 时间：2012-04-17T23:02:06.813

您可以使用以下方法删除特定版本的 gem：

```
gem uninstall gem_name --version version 
```

要删除`bootstrap-sass 2.0.1`使用：

```
gem uninstall bootstrap-sass --version 2.0.1 
```

或者，您可以告诉 bundler 使用特定版本，正如其他人所建议的那样。在您的 Gemfile 中仅使用 2.0.2 版：

```
gem 'bootstrap-sass', '2.0.2' 
```

或者

```
gem 'bootstrap-sass', '~> 2.0.2' 
```

将使用高于 2.0.2 但低于 2.1 的最大版本。

有关详细信息，请参阅“[在 Gemfile 中指定版本](http://docs.rubygems.org/read/chapter/16)”。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2015-10-09T16:47:54.207

这将删除版本 2.0.1 和 2.0.2：

```
gem uninstall bootstrap-sass --version 2.0.1
gem uninstall bootstrap-sass --version 2.0.2 
```

这将删除所有旧版本的 gem：

```
gem cleanup bootstrap-sass 
```

这使您可以选择要删除的那些：

```
gem uninstall bootstrap-sass 
```

# php - PHP中的file_get_contents不起作用

> ID：10199976
> 
> 赞同：1
> 
> 时间：2012-04-17T22:14:09.793
> 
> 标签：php, screen, file-get-contents, scrape

对于一个类项目，我们应该从另一个网站提取数据。我从 GiantBomb.com 选择了类似于给定游戏的拉动游戏（在我的脚本中为它们提供了学分）

```
// $gameLink = "/call-of-duty-black-ops/61-26423/";
$html = file_get_contents("http://www.giantbomb.com" . urlencode($gameLink) . "games_similar/");
echo $html; 
```

这不返回任何内容。

但是，如果手动输入 $gameLink：

```
$html = file_get_contents("http://www.giantbomb.com/call-of-duty-black-ops/61-26423/games_similar/");
echo $html; 
```

现在，它将正确返回结果。我的代码有什么问题？我尝试`urlencode()`在整个链接上执行，而不仅仅是 $gameLink 变量，但它仍然失败。有没有人有什么建议？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-17T22:16:02.307

您只需要对嵌入在 html 中的链接进行 urlencode。不要对传递给 file_get_contents() 的链接进行 urlencode。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-17T22:21:46.507

我认为这是因为 urlencode() 对除 -_ 之外的所有非字母数字字符进行编码。

这意味着您的正斜杠被编码为 %2F，这不是您想要的；) 但是，正如 hegemon 上面提到的，不要对传递给 file_get_contents() 的链接进行 urlencode。

# ssrs-2008 - SSRS：在报表生成器中计算组内的百分比变化

> ID：10199981
> 
> 赞同：1
> 
> 时间：2012-04-17T22:14:54.810
> 
> 标签：ssrs-2008, reporting-services, ssrs-tablix, ssrs-grouping

看起来应该很简单的事情让我很头疼。我有一个基于 MDX 查询（从多维数据集进行简单拖放）的表，并且想计算组内值的百分比增加。

[因为我是新人所以不会让我发布图片，所以请参阅：

![在此处输入图像描述](../Images/0dd39ea994d3a8930c3fc724fa8908db.png)

在列组中，我有“Metric”和“Year”。我试图在每年的右侧添加一列，例如，2011 年是 2010 年的 X%。每次我尝试使用 Previous() 或 Last() 函数作为表达式时，它不起作用。如果有人可以让我知道如何在不做一些疯狂的自定义 MDX 查询的情况下处理这个问题，我将不胜感激！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-19T17:48:49.940

我很确定您不能：您需要将该计算作为计算列包含在您的 MDX 查询中。我不是多维数据集专家，但您能获得通过拖放操作创建的查询吗？如果是这样，请将其添加到您的帖子中，MDX 专家可能会帮助您更改它以满足您的需求。

# nhibernate - 具有左外连接的复杂 NHibernate 标准？

> ID：10199989
> 
> 赞同：0
> 
> 时间：2012-04-17T22:15:14.877
> 
> 标签：nhibernate, subquery, left-join

我对 NHibernate 很陌生。我使用 CreateSQLQuery 编写了这个，但如果可能的话，我想把它移到 NHibernate Criteria 格式。我的查询如下所示：

```
select parent.ID as Id, ValueA.Total as ValueACount, ValueB.Total as ValueBCount
from ParentTable parent 
left outer join
(
  select count(*) as Total, ID 
  from ChildTable
  where state = 'ValueA' 
  group by ID
) ValueA on ValueA.ID = parent.ID
left outer join
(
  select count(*) as Total, ID
  from ChildTable
  where state = 'ValueB' 
  group by ID
) ValueB on ValueB.ID = parent.ID 
```

我更改了表名称/值以将其抽象一下。代码按原样工作，但这是我们在整个解决方案中唯一的查询。我想看看我们能不能摆脱它。

提前感谢所有可以提供帮助的人。如果你想给我一个可以帮助我的非常好的网页的链接，那也很好。我至少会为你竖起大拇指:)

我也看到了一些类似的问题。如果您觉得其他一些问题/答案会对我有很大帮助，请随时指出我。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-18T05:52:40.410

你可以试试 linq fu

```
var results = from p in session.Query<Parent>()
              select new
              {
                  p.Id,
                  ValueACount = (from c1 in session.Query<Child>() where c1.State == "ValueA" && c1.Parent == p select c1).Count(),
                  ValueBCount = (from c2 in session.Query<Child>() where c2.State == "ValueB" && c2.Parent == p select c2).Count(),
              }; 
```

或使用标准

```
var results = session.CreateCriteria<Parent>("p")
    .SetProjection(Projections.ProjectionList()
        .Add(Projections.Property("Id"))
        .Add(Projections.SubQuery(DetachedCriteria.For<Child>()
            .Add(Restrictions.Eq("State", "ValueA") && Restrictions.EqProperty("Parent", "p"))
            .SetProjection(Projections.RowCount())))
        .Add(Projections.SubQuery(DetachedCriteria.For<Child>()
            .Add(Restrictions.Eq("State", "ValueB") && Restrictions.EqProperty("Parent", "p"))
            .SetProjection(Projections.RowCount()))))
    .List(); 
```

# oracle - 尝试执行循环通过仅包含 ROWID 的游标的 pl/sql 时出错

> ID：10199992
> 
> 赞同：1
> 
> 时间：2012-04-17T22:15:26.163
> 
> 标签：oracle, plsql, oracle11g, rowid

我正在尝试更新给定表中的所有列。该表中有大约 200,000,000 条记录。

试图运行一个简单的更新语句是行不通的。

这是我的代码：

```
DECLARE
    TYPE ROW_ID_TBL IS TABLE OF ROWID;
    CURSOR c_rowIdCursor RETURN ROWID IS
        SELECT ROWID FROM SOME_TABLE;

    v_RowIDs ROW_ID_TBL;
BEGIN
    OPEN c_rowIdCursor;
    LOOP
        FETCH c_rowIdCursor BULK COLLECT INTO v_RowIDs LIMIT 50000;
        EXIT WHEN v_RowIDs.COUNT = 0;

        FORALL i IN v_RowIDs.FIRST..v_RowIDs.LAST
            UPDATE SOME_TABLE
               SET SOME_KEY = MOD(NVL(REGEXP_REPLACE(ALPHA_NUMERIC_VAL, '[^0-9]+', ''), 0), 300)+1
             WHERE ROWID = v_RowIDs(i);
        COMMIT;
    END LOOP;
END;
/ 
```

当我尝试运行它时，我得到以下信息：

```
ORA-06550: line 3, column 33:
PLS-00320: the declaration of the type of this expression is incomplete or malformed
ORA-06550: line 3, column 5:
PL/SQL: Item ignored 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-17T22:22:53.290

你的`CURSOR`定义不正确。你想要类似的东西

```
CURSOR c_rowIdCursor
    IS SELECT ROWID 
         FROM SOME_TABLE; 
```

当然，我不确定为什么简单的更新不起作用。它会更高效，使用更少的资源，并且需要更少的代码。

# git - git-pull：无法为 Unicode 文件名分离 HEAD

> ID：10199993
> 
> 赞同：3
> 
> 时间：2012-04-17T22:15:35.223
> 
> 标签：git, unicode, osx-leopard

我运行这个 git pull 命令，它阻塞了 Unicode 文件名

```
& git pull
From . 
  * branch            master     -> FETCH_HEAD
First, rewinding head to replay your work on top of it...
error: The following untracked working tree files would be overwritten by checkout:
    test-sample-files/MByte/CJK-UTF8-MultiByte/樣品套裝/サンプル.java
    test-sample-files/MByte/CJK-UTF8-MultiByte/樣品套裝/의 견본을 뽑다.java
    test-sample-files/MByte/japanese/これはサンプルのテストであり、できるだけ早く修正する必要があります.java
    test-sample-files/MByte/japanese/サンプル.java
    test-sample-files/MByte/korean/의 견본을 뽑다.java
Please move or remove them before you can switch branches.
Aborting
could not detach HEAD 
```

但是 git status 报告工作目录干净

```
$ git status
# On branch dev/experimental
# Your branch and 'master' have diverged,
# and have 3 and 96 different commit(s) each, respectively.
#
nothing to commit (working directory clean) 
```

没有“git add”、“git reset”或“rm ...*”可以解决这种情况。任何帮助深表感谢。

PS：我在 Mac OS X Leopard (10.5) 上运行“git version 1.7.5.4”，这是我能找到的最新的 leopard 预构建版本。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-17T22:23:56.270

在工作树的当前状态下，您的文件未跟踪。这就是为什么`git add`或`git rm`不做任何事情。

用 存储它们`git stash save --untracked`，它们将被保存在一个存储区中。拉取后，您可以恢复，`git stash pop`但您可能会遇到冲突，因为拉取将在可能的不同内容上签出主题。

由于您坚持使用 Git 1.7.5`stash`不知道该`--untracked`选项，因此您可以

*   将未跟踪的文件移动到临时目录，并恢复它们：

    ```
     git ls-files --other --exclude-standard | xargs -t -I file  mv file untracked 
    ```

*   或添加它们`git add -u`，并提交

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-18T16:29:42.877

造成这种情况的原因已经在堆栈溢出中进行了描述，并且是[使用 git 处理 Mac OS X UTF-8 编码文件名的解决方法](https://stackoverflow.com/a/7322034/1309300)！也有描述。

# c# - 线路端点检测

> ID：10199998
> 
> 赞同：6
> 
> 时间：2012-04-17T22:16:05.860
> 
> 标签：c#, line, ocr, detection, endpoint

我计划检测从 C# 中的字符 (OCR) 生成的行的端点。我想要这样的东西：

![在此处输入图像描述](../Images/a5f36b7eab0ded23f8f8439777093f13.png)

我所说的“端点”的意思是我想得到字符中任何行的结尾......例如，“C”有两个端点（一个在顶部，一个在底部），如上图所示作为一个红色像素。我可以从“较胖”的现有扫描字符中提取单行，我可以进行边缘检测和 Flood-fill 分析，但我似乎无法复制上述内容！任何指向文章或现有代码的指针将不胜感激！任何代码示例都可以，因为我可以轻松地将 C++ 或任何 .NET 语言转换为 C#。

谢谢，乔什

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-18T00:01:30.077

由于您还没有“端点”的定义，我建议：

*   如果所有邻居（即曼哈顿距离 <= 3 的黑点）位于小于 45 度的扇区中，则黑点是端点。

找到每个相邻黑点的角度应该不会太难。对这些角度进行排序并找到范围也并不困难，尽管您需要注意不连续性（角度突然变化 360 度）。在不实际计算角度的情况下按斜率排序可能会稍微快一些。使用提前退出逻辑可以获得额外的加速。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2018-05-16T12:28:58.517

我就是这样做的。对于每个不为 0 的像素，计算该像素周围 3 x 3 网格中不为 0 的像素数。如果数字为 2，则您有一条线的端点。

```
// count the number of points in the neighborhood of our pixel
inline int countNeighborhood(cv::Mat &img, int xc, int yc)
{
    if (img.empty()) return 0;
    if (img.type() != CV_8UC1) return 0;
    xc++;
    yc++;
    int iCnt = 0;
    for (int y = yc - 2; y <= yc; y++)
    {
        if ((y < 0) || (y >= img.rows)) continue;
        uint8_t *buf = img.ptr(y);
        for (int x = xc - 2; x <= xc; x++)
            if ((x > 0) && (x < img.cols) && (buf[x])) iCnt++;
    }
    return iCnt;
}

/*  get endpoints of a image with lines in it
*/
std::vector<cv::Point> getEndPoints(cv::Mat &img)
{
    std::vector<cv::Point> res;
    for (int y = 0; y < img.rows; y++)
    {
        uint8_t *buf = img.ptr(y);
        for (int x = 0; x < img.cols; x++)
        {
            if (buf[x] == 0) continue;
            int iCnt = countNeighborhood(img, x, y);
            if (iCnt == 2) res.push_back(cv::Point(x, y));
        }
    }
    return res;
} 
```

如果您愿意，可以使用内核来完成 countNeighborhood。函数 getEndPoints 返回所有找到的端点的数组。

PS此功能适用于黑色（0）背景和白色（1-255）als线条。

# types - avro中的地图和记录有什么区别？

> ID：10199999
> 
> 赞同：3
> 
> 时间：2012-04-17T22:16:17.413
> 
> 标签：types, map, avro

我正在将[Apache Avro](http://avro.apache.org/docs/current/spec.html)用于一个项目，但我似乎无法理解它所说的*maps*。我找不到任何正在使用的地图示例，并且规范上的示例非常简单：

> # 地图
> 
> 地图使用类型名称`"map"`并支持一个属性：
> 
> *   `values:`地图值的架构。
> 
> 映射键被假定为字符串。
> 
> 例如，从 string 到 long 的映射声明为：
> 
> `{"type": "map", "values": "long"}`

适合该模式的数据可能看起来像 JSON 吗？地图有什么用处，而记录并没有做得更好？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-24T05:30:55.870

我的理解是，这种差异与 Java 处理具有命名属性的 POJO 的方式非常相似，而`java.util.Map`. 也就是说，Map 中的条目名称是任意的、动态的；但是数据类型都是相同的类型（但是可以`java.lang.Object`指示任何类型）。

也就是说，Maps 在条目方面更通用，但比 POJO 占用更多的存储空间并且处理速度更慢（因为按名称查找，与字段的直接索引相比）。

Avro 本身是相当强类型的，因为需要 Schemas，这可能使 Maps 的使用不如 JSON 等更动态的格式吸引人。