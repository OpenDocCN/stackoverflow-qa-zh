# StackOverflow 问答 000894000-000894999

# sql - MySQL 5 BEFORE 无法识别？

> ID：894008
> 
> 赞同：1
> 
> 时间：2009-05-21T17:08:45.523
> 
> 标签：sql, mysql, macos

在我的 Mac 上的 MySQL 5.0.51b 中，FIRST 之后的序数会失败，就像 BEFORE 一样。

所以，

```
ALTER TABLE my_contacts
ADD COLUMN phone VARCHAR(10) FOURTH; 
```

完全失败，就像

```
ALTER TABLE my_contacts
ADD COLUMN phone VARCHAR(10) BEFORE email; 
```

这些是否适用于任何其他风格或版本的 MySQL？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-21T17:12:16.093

我怀疑它们在其他操作系统安装上的工作方式有什么不同，因为5.0[中 alter table 的 mysql 文档](http://dev.mysql.com/doc/refman/5.0/en/alter-table.html)不提供 BEFORE 修饰符。我建议使用 AFTER 代替（如果您将其作为表中的第一列插入，则使用 FIRST）。

```
ALTER TABLE my_contacts
ADD COLUMN phone VARCHAR(10) AFTER some_column_name; 
```

# struct - 结构体的使用

> ID：894021
> 
> 赞同：0
> 
> 时间：2009-05-21T17:11:29.700
> 
> 标签：struct

谁能提供一个何时可以使用结构的真实示例？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-21T17:14:34.780

当您的方法具有复杂的返回类型时，可以使用结构。即你必须返回几个值，它们并不能保证一个完整的类的开销。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-21T17:15:26.087

结构是记录的概念，一种将一组固定的标记对象（可能具有不同类型）聚合为单个对象的数据类型。结构通常用于以某种方式对对象进行分组和关联。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-21T17:18:07.127

如果您的意思是 C 结构，一个很好的例子是编译器中的固定标量类型。例如：

```
struct myScalar {
    void *payload;
    size_t psz;
    unsigned int refs;
    enum {
        S_STR,
        S_INT,
        S_FLOAT,
        S_OBJECT_INSTANCE
    }type;
}; 
```

或者可以使用联合。不是一个强有力的例子，但你明白了。然后你可以做

```
switch(aVar.type){ ... } 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-21T17:16:26.803

结构非常适合帮助您解析已压缩为位以通过“网络”发送的数据。您可能有一堆位域来填充一个字节，而结构是一种在这堆乱七八糟的变量上放置一个模板的方法，并且无需任何实际努力，就可以将其更改为一组可用的、易于引用的变量。

# asp.net - 什么更好：静态变量 VS Asp.NET 应用程序会话？

> ID：894036
> 
> 赞同：9
> 
> 时间：2009-05-21T17:14:54.217
> 
> 标签：asp.net, global-variables, static-members

假设您想在 ASP.NET Web 应用程序中的所有线程/会话之间共享一些资源，例如类或变量。什么是更好的？

1) 具有对该静态变量的线程安全访问器的静态变量？

2) 还是 ASP.NET 应用程序会话变量？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-05-21T17:29:29.133

如果您只有其中一个，则几乎没有区别。

如果你有多个，你应该使用静态变量而不是`Application`变量。该`Application.Lock`方法将锁定*所有* `Application`变量，而您可以为静态变量使用单独的同步标识符，以便每个锁定只影响访问该特定变量的代码。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2011-09-08T18:52:52.223

静态成员将提供更好的性能，但缺点是它们不是线程安全的：

*建议您将数据存储在应用程序类的静态成员中，而不是应用程序对象中。这提高了性能，因为您可以比访问应用程序字典中的项目更快地访问静态变量。*

来自： http: [//support.microsoft.com/default.aspx ?scid=kb;en-us;Q312607](http://support.microsoft.com/default.aspx?scid=kb;en-us;Q312607)

和：

[http://weblogs.asp.net/plip/archive/2003/12/01/40526.aspx](http://weblogs.asp.net/plip/archive/2003/12/01/40526.aspx)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-21T17:47:39.597

这是您浏览多个页面并收集数据的常见场景。对于这种情况，我会使用 Session 对象。当整个应用程序需要同一个对象时，应该使用静态变量。

如果您要保留的值取决于用户，则使用 Session。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-07-14T11:58:18.847

这是真的会话变量应该只用于如果你想存储整个会话的值，但在你希望变量被初始化并在表单之间使用的情况下，如果在 betwwen 中更改应该可以通过同一对象的整个应用程序必须使用静态变量。

# c# - 使用 lock(this) 说明死锁的示例代码

> ID：894037
> 
> 赞同：31
> 
> 时间：2009-05-21T17:14:57.383
> 
> 标签：c#, .net, multithreading, deadlock

我读过几篇文章和帖子说`lock(this)`,都是不好的做法，因为另一个线程可能会锁定同一个键并导致死锁`lock(typeof(MyType))`。`lock("a string")`为了理解这个问题，我试图创建一些示例代码来说明死锁，但一直无法解决这个问题。

有人可以写一段简明的代码来说明这个经典问题吗？请保持简短，我只能以较小的块消化代码。

**编辑：** 我认为 lassevk 总结得很好；真正的问题是你失去了对锁的控制。一旦发生这种情况，您将无法控制调用锁的顺序，并且您正在允许潜在的死锁情况。

`lock(this)`, `lock(typeof(MyType))`, 等等都是您选择了无法控制的锁的情况。

* * *

## 回答 #1

> 赞同：34
> 
> 时间：2009-05-21T17:22:10.333

只有当您拥有多个锁时才会发生死锁。您需要这样一种情况，即两个线程都拥有另一个需要的资源（这意味着必须至少有两个资源，并且两个线程必须尝试以不同的顺序获取它们）

一个简单的例子：

```
// thread 1
lock(typeof(int)) {
  Thread.Sleep(1000);
  lock(typeof(float)) {
    Console.WriteLine("Thread 1 got both locks");
  }

}

// thread 2
lock(typeof(float)) {
  Thread.Sleep(1000);
  lock(typeof(int)) {
    Console.WriteLine("Thread 2 got both locks");
  }
} 
```

假设两个线程都在一秒钟内启动，那么它们都有时间在任何人到达内部锁之前抢到第一个锁。如果没有 Sleep() 调用，其中一个线程很可能在另一个线程启动之前就有时间获取和释放两个锁。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-05-21T17:36:59.790

这个想法是，你永远不应该锁定你无法控制谁可以访问的东西。

类型对象是对每个 .net 代码段可见的单例，您无法从外部控制谁锁定您的“this”对象。

字符串也是如此：由于字符串是不可变的，因此框架只保留一个“硬编码”字符串的实例并将它们放入一个池中（该字符串被称为被实习），如果您在代码中写入两次字符串“你好”，你总是会得到同样的下贱。

考虑以下示例：您在超级私有调用中只编写了 Thread1，而 Thread2 被您在后台线程中使用的某个库调用...

```
void Thread1()
{
  lock (typeof(int))
  {
    Thread.Sleep(1000);
    lock (typeof(long))
      // do something
  }
}

void Thread2()
{
  lock (typeof(long))
  {
    Thread.Sleep(1000);
    lock (typeof(int))
      // do something
  }
} 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-05-21T17:21:21.723

喏，给你。

请注意，死锁的常见示例是当您获得多个锁时，两个或多个线程最终相互等待。

例如，两个像这样锁定的线程：

```
Thread 1               Thread 2
 Lock "A"               Lock "B"
 Lock "B"               Lock "A" <-- both threads will stop dead here
                                     waiting for the lock to be come
                                     available. 
```

然而，在这个例子中我并没有为此烦恼，我只是让一个线程无限期地锁定。你真的不想放松对你的锁的控制，所以虽然这是一个人为的例子，但后台线程可以像这样完全阻塞主线程的事实是很糟糕的。

```
using System;
using System.Threading;

namespace ConsoleApplication7
{
    public class Program
    {
        public static void Main(string[] args)
        {
            LockableClass lockable = new LockableClass();
            new Thread(new ParameterizedThreadStart(BackgroundMethod)).Start(lockable);
            Thread.Sleep(500);
            Console.Out.WriteLine("calling Reset");
            lockable.Reset();
        }

        private static void BackgroundMethod(Object lockable)
        {
            lock (lockable)
            {
                Console.Out.WriteLine("background thread got lock now");
                Thread.Sleep(Timeout.Infinite);
            }
        }
    }

    public class LockableClass
    {
        public Int32 Value1 { get; set; }
        public Int32 Value2 { get; set; }

        public void Reset()
        {
            Console.Out.WriteLine("attempting to lock on object");
            lock (this)
            {
                Console.Out.WriteLine("main thread got lock now");
                Value1 = 0;
                Value2 = 0;
            }
        }
    }

} 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-05-21T17:30:24.030

这是相当标准的坏事。不按顺序抓住锁，然后用锁睡觉。做两件坏事。:)

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Threading;

namespace DeadLock
{
    public class Program
    {
        static void Main(string[] args)
        {
            var ddt = new DontDoThat();

            ddt.Go();
        }
    }

    public class DontDoThat
    {
        private int _badSharedState = 0;
        private readonly object _lock1 = new object();
        private readonly object _lock2 = new object();

        public void Go()
        {
            new Thread(BadGuy1).Start();
            new Thread(BadGuy2).Start();

            Console.WriteLine("Leaving Go!");
        }

        public void BadGuy1()
        {
            lock (_lock1)
            {
                Thread.Sleep(100); // yeild with the lock is bad
                lock (_lock2)
                {
                    _badSharedState++;
                    Console.Write("From Bad Guy #1: {0})", _badSharedState );
                }
            }
        }
        public void BadGuy2()
        {
            lock (_lock2)
            {
                lock (_lock1)
                {
                    _badSharedState++;
                    Console.Write("From Bad Guy #2: {0})", _badSharedState);
                }
            }
        }
    }
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-21T17:22:51.767

问题是 lock("a string") 正在锁定一个单例。这意味着使用相同锁的其他对象可能会无限等待。

例如：

```
using System;
using System.Threading;

namespace ThreadLock
{
    class Program
    {
        static void Main(string[] args)
        {
            lock ("my lock")
            {
                ManualResetEvent evt = new ManualResetEvent(false);
                WorkerObject worker = new WorkerObject(evt);
                Thread t = new Thread(new ThreadStart(worker.Work));
                t.Start();
                evt.WaitOne();
            }
        }
    }

    class WorkerObject
    {
        private ManualResetEvent _evt;
        public WorkerObject(ManualResetEvent evt)
        {
            _evt = evt;
        }
        public void Work()
        {
            lock ("my lock")
            {
                Console.WriteLine("worked.");
                _evt.Set();
            }
        }
    }
} 
```

在这种情况下，调用代码在字符串上创建一个锁，然后创建一个工作对象。Work() 中的工作对象锁定在同一个字符串上，该字符串在 C# 中是一个单例。它最终陷入死锁，因为调用者拥有锁并且正在等待永远不会到来的信号。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2011-04-06T08:43:50.673

```
class Character
{
    public Character Other;
    public string Name;
    private object locker = new object();

    public Character(string name)
    {
        Name = name;
    }

    public void Go()
    {
        lock (locker)
        {
            Thread.Sleep(1000);
            Console.WriteLine("go in {0}", Name);
            Other.Go();
        }
    }
}

class Program
{
    static void Main(string[] args)
    {
        Character a = new Character("A");
        Character b = new Character("B");
        a.Other = b;
        b.Other = a;

        new Thread(a.Go).Start();
        b.Go();

        Console.ReadLine();
    }
} 
```

# windows - 没有域的 WCF Windows 凭据？

> ID：894047
> 
> 赞同：0
> 
> 时间：2009-05-21T17:16:18.410
> 
> 标签：windows, wcf, security

如果两台机器不在同一个域中，是否可以使用 Windows 客户端凭据在基于 Windows 窗体的客户端和自托管 WCF 服务之间进行传输安全？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-21T19:05:36.850

我不是 Windows 身份验证方案方面的专家，但我认为实现给定服务的服务器必须有一种方法来验证传递给它的 Windows 凭据——要么在同一个域上并可以访问同一个域Active Directory 作为调用者，或者至少通过与调用者的域建立信任关系（但不确定这是否可行）。

如果调用者和服务器位于两个完全独立的 Windows 域上，甚至没有信任关系，恕我直言，您当然不能使用 Windows 凭据。

马克

# jquery - 如何打印 JQuery ThickBox 插件的内容？

> ID：894049
> 
> 赞同：3
> 
> 时间：2009-05-21T17:16:41.297
> 
> 标签：jquery, thickbox

我已经实现了ThickBox 插件，并且正在使用AJAX 请求检索内容。打印链接正在打印Thickbox 后面的页面。有没有办法打印实际内容？

我正在使用以下锚标记和 JavaScript 链接：

```
<a onclick="PrintPage()">Print</a> 
```

### JavaScript：

```
 function PrintPage() {
        window.print();
    }

</script> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-21T17:32:03.700

您必须指定一个 CSS 打印样式表，它隐藏除 ajax 检索的内容之外的所有内容。

# outlook - 有什么方法可以使用 VSTO 扩展或修改 Outlook 中的拖放功能？

> ID：894050
> 
> 赞同：1
> 
> 时间：2009-05-21T17:16:45.413
> 
> 标签：outlook, drag-and-drop, vsto, outlook-2007, outlook-addin

我在 Outlook 中使用了一个加载项，该加载项依靠拖放将 Outlook 文件自动保存到文件中。问题是默认行为是使用电子邮件的主题行作为文件名，而具有极长主题行的电子邮件会发送错误，因为 250 个字符中没有足够的空间来存储所有内容以及路径的其余部分。

我想将 Outlook 的拖放更改为资源管理器，以便将默认文件名保留到主题行剪切为 100 个字符。关于我在哪里做这件事的任何指示？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-21T23:01:49.587

Ok I think you have a couple of ways to do this.

1.  run you own pane in outlook and on the drop and look at the selection and do a saveAs on each item.

2.  use some winapi to intercept the save ans change the name(i am not sure if this is possible)

# c# - 使用 Visual Studio .NET 的 Web 应用程序项目类型而不是网站时，我应该在哪里放置类？(ASP.NET)

> ID：894052
> 
> 赞同：12
> 
> 时间：2009-05-21T17:16:56.117
> 
> 标签：c#, .net, asp.net, visual-studio-2008, web-applications

我有丰富的在 Visual Studio 中创建 ASP.NET 网站的经验。但是还有另一种方法可以通过 Web 应用程序来做同样的事情，它的文件结构略有不同。

因为我创建了我的第一个 Web 应用程序，所以我不能再使用 App_Code 文件夹中的类（.cs 文件），除非将它们移到同一个文件中，否则 ASPX 和 ASHX 类不会看到它们。

碰巧我在许多文件中使用相同的类，我不想拥有它们的多个副本。我把这些课程放在哪里？有没有不创建另一个项目的解决方案？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-05-21T17:21:19.197

我们一直在 VS 2008 中为我们的所有项目使用 Web 应用程序项目类型，并将我们的公共类放在 AppCode 文件夹而不是 App_Code 文件夹中。它工作得非常好，我们在应用程序的所有页面上访问我们的类完全没有任何问题。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-05-21T17:24:12.327

使用 Web 应用程序项目，您拥有更多的自由。只需在您的项目下创建子文件夹来保存您的课程。例如，您可以有一个名为“DAL”的文件夹来保存数据访问层项目。

或者，您可以创建一个组装项目并将您的类放在那里，然后从您的 WAP 中引用它。

最终，结构将归结为您将拥有多少个课程。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-21T17:20:14.533

为什么不想创建另一个项目？这将是最简单的方法，因为您的所有类都将位于该程序集中，您可以在 Web 应用程序中进行项目引用，然后可以访问整个项目中的所有内容。

我强烈建议您考虑这种方法。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-21T17:49:30.183

我通常在一个解决方案中有三个项目。Web 应用程序、Web 库（基本页面等）和 DAL。这样可以保持一切清洁。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-22T13:13:18.890

把它们放在你想要的任何地方。我倾向于将特定于项目的小帮助程序类和基本页面保留在 Web 项目下的 /Helpers 文件夹中，但将 DataLayer 内容和通用可重用帮助程序拆分到他们自己的单独项目中。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2014-01-23T21:26:02.907

我`/Shared/Classes`用于整个站点中使用的通用类。我喜欢将其余的类放在使用它们的**Classes**文件夹中，例如`/blog/Classes/`.

- 编辑 -

上面的答案是我如何在 Web 窗体应用程序项目中存储类。现在我正在使用 MVC，我将通用类`/Classes`和非通用类存储在子文件夹中，`/Classes`例如`/Classes/Blog`. 简而言之，`Old_App_Code`已重命名为`Classes`. 这似乎是我看到微软在 MVC 中使用的命名约定的自然扩展，而且它也适用于我的旧 Web 表单页面。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-05-21T17:44:58.463

我强烈建议您将所有类（域对象）放在一个单独的项目中。这样，您将能够轻松地针对您的业务层（域对象）编写测试，并且您的类将是可移植的。可移植意味着您可以将您的 DLL 发送给另一个开发人员，他/她可以轻松地重用您开发的类。

# ruby-on-rails - Rails 中多个模型的最佳实践——嵌套/非嵌套和验证

> ID：894059
> 
> 赞同：5
> 
> 时间：2009-05-21T17:19:07.610
> 
> 标签：ruby-on-rails, validation, forms

注意：根据布赖恩的评论将其作为一个单独的问题发布（来自[如何以导轨形式处理多个模型](https://stackoverflow.com/questions/892624/how-to-handle-multiple-models-in-a-rails-form)）

当模型既嵌套又非嵌套时，我正在尝试学习以单个导轨形式处理多个模型的最佳方法。对于嵌套的，我发现这两个教程很有帮助

[http://weblog.rubyonrails.org/2009/1/26/nested-model-forms](http://weblog.rubyonrails.org/2009/1/26/nested-model-forms) [http://railsforum.com/viewtopic.php?id=717](http://railsforum.com/viewtopic.php?id=717)

我的问题是：

1.  在非嵌套模型的情况下，如何处理第二个模型的多个条目？只需运行一个循环，然后使用 fields_for？
2.  在嵌套/非嵌套情况下，当第二个模型有多个条目时，如何验证重复值？例如，如果项目是主要模型，任务是次要（子）模型，并且用户为该项目添加了多个任务，那么如何确保该特定模型没有添加重复的任务？一种方法是遍历文本值，并检查重复项。在对象级别而不是字符串级别有更好的方法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-21T19:46:00.200

你可能想看看这个来处理多个实例：

[http://railscasts.com/episodes/73-complex-forms-part-1](http://railscasts.com/episodes/73-complex-forms-part-1)

另外，我想我已经在这里回答了你的第二个问题：

[以 rails 形式验证多个模型](https://stackoverflow.com/questions/889608/validating-multiple-models-in-a-rails-form/894645#894645)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-31T13:15:20.093

你应该看看 Presenter Pattern，它对我帮助很大！

你可以从这里开始：

[http://blog.jayfields.com/2007/03/rails-presenter-pattern.html](http://blog.jayfields.com/2007/03/rails-presenter-pattern.html)

# c# - 在没有数据库的情况下存储联系人/地址类型信息的最佳格式是什么？

> ID：894061
> 
> 赞同：1
> 
> 时间：2009-05-21T17:19:08.140
> 
> 标签：c#, serialization, data-structures

我的应用程序正在存储联系信息。用户可以通过 DataGridView 等方式对其进行编辑。我正在通过可序列化的类保存这些联系信息，如下所示：

```
 [Serializable]
public class Contact : INotifyPropertyChanged
{
    private string _fName;
    private string _lName;
    private string _pNumber;

    public event PropertyChangedEventHandler PropertyChanged;

    public Contact(string firstName, string lastName, string phoneNumber, bool fromOutlook){...}

    public Contact(){...}

    public string FirstName{...}
    public string LastName{...}
    public string PhoneNumber{...}

    private void NotifyPropertyChanged(string name){...}
} 
```

但我担心这不是最有效/最整洁的格式（如果我只是序列化课程）。有没有人有类似的任务并以更好的方式解决它？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-21T17:29:01.740

我强烈推荐 VCard，原因如下。

1.) 联系人通用协议。让您的数据立即与其他 VCard 兼容的应用程序一起使用。像 MS Outlook。

2.) 可以在手机上传输。

3.) 可用于同步。[查看 SyncML 联系人同步。]

4.) 您不需要自己编写 VCard 解析器。只需在[此处查看](http://www.codeproject.com/KB/dotnet/vCardReader.aspx) 链接 Txt： http: [//www.codeproject.com/KB/dotnet/vCardReader.aspx](http://www.codeproject.com/KB/dotnet/vCardReader.aspx)

5.) 可序列化。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-21T17:21:29.260

地址簿条目有许多相对标准的格式（想到 vCard）；如果您坚决反对使用数据库，那么序列化到其中一个可能是您最好的选择。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-21T17:25:56.660

如果您确定您的应用程序是唯一需要使用这些序列化类的应用程序，BinaryFormatter 序列化程序将非常紧凑地存储它们。如果您可能有其他可以从读/写这些东西中受益的软件实用程序，我建议您使用 SoapFormatter 或 XML Serializer 将它们转储为 XML。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-21T17:28:02.663

使用没有任何问题`Serializable`；这是从磁盘获取对象的好方法。如果您担心使格式易于阅读，请改用[`XmlSerialize`r](http://msdn.microsoft.com/en-us/library/system.xml.serialization.xmlserializer.aspx)。

# php - 从内容中删除给定的网站 url

> ID：894065
> 
> 赞同：0
> 
> 时间：2009-05-21T17:20:33.083
> 
> 标签：php, wordpress, url

我有一个 WordPress 博客和几位作者。我想从我的博客内容中自动删除一些网站网址。例如，我不希望在帖子内容中有任何 myspace url，不仅`myspace.com`是`myspace.com/whatever`or `myspace.com/faq.html`。

是否可以使用一些 php 代码或在文件中添加一些代码来做到这一点`.htaccess`？

谢谢你。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-21T17:31:40.987

.htaccess 在这里帮不了你。

您应该能够将一个非常基本的插件组合在一起，如下所示：

```
add_filter('the_content', 'myspace_url_filter', 999);

function myspace_url_filter($content) {
  return preg_replace('/(<a[^>]href=["'])[^"']+myspace.com[^"']+["']/', '\1#"', $content);
} 
```

请注意，这绝不是一个完美的正则表达式；它可以通过用 myspace IP 替换 myspace 域名轻松规避（祝你好运追踪他们使用的每个公共 IP...），常见的 XSS 技术，使用任何 URL 重定向服务，如 tinyURL（要抓住这个，你d 必须跟踪每个链接和任何重定向），或者只是链接到包含相关链接的页面（例如 tinyURL 预览页面）。

长话短说，您可以设计的任何技术对策都很容易被击败，即使是最简单的解决方法也可能需要您进行极其复杂的工作。

与您的作者交谈，明确您的愿望并惩罚任何拒绝遵守您的“禁止 myspace 链接”规则的作者可能会更简单。

# asp.net-mvc - .Net MVC 将嵌套数据从控制器传递到视图

> ID：894072
> 
> 赞同：3
> 
> 时间：2009-05-21T17:21:28.213
> 
> 标签：asp.net-mvc, nested, hierarchical

我正在创建一个 .NET MVC 应用程序，并且我有一个要在其中显示以下内容的视图：

**类别**

后跟当前类别的**项目列表**

[可能] 后跟当前项目的**子项目列表**

我可以创建一个自定义 ViewModel 类，它发送 3 个单独的 IEnumerable 列表（类别、项目和子项目）。这种方法的问题是没有简单的方法可以在视图中以正确的顺序（层次结构）呈现数据。使用这种方法，我将拥有三个列表，然后需要在渲染期间添加条件逻辑。这意味着当我尝试将项目插入页面上的适当位置时，每个项目列表将被迭代多次。

我宁愿以正确的顺序传回数据，也许是一个 XML 文件。这里的正确方法是什么？

我还考虑过连接控制器中的数据并将格式化的文本传递给视图，但这似乎违反了让视图处理渲染的概念。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-21T17:29:31.800

我会在这里远离 XML。通过适当的层次结构；这似乎是合理的：

```
public class ViewModel
{
    Category[] Categories { get; set; }
}

public class Category
{
    Item[] Items { get; set; }
}

public class Item
{
    Item[] SubItems { get; set; }
} 
```

那么你可以`foreach`在你的视图中嵌套循环。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-21T17:26:59.170

您可能应该做的是在您的类别列表中使用**自定义类型**，并且每个项目都有一个包含子项目的属性。

这可以在实体框架中使用[Navigation Properites](http://msdn.microsoft.com/en-us/library/bb896321.aspx)轻松实现。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-21T17:27:00.153

我将使用类型为 items 的属性设置 Category Model 类`IEnumerable<item>`。

然后在类中包含一个`IEnumerable<subItem> subItems`属性。`item`

该视图将非常容易地遍历这些项目和子项目。

**编辑：**实际上，如果子项目与项目完全相同，那么可能只有一个`item`具有`IEnumerable<item> subItems`属性的类。这也将允许无限级别的子项目。

# sql - SQL查询，以避免在用户折叠部分嵌套集时获取整个嵌套集

> ID：894077
> 
> 赞同：0
> 
> 时间：2009-05-21T17:22:12.347
> 
> 标签：sql, django, nested-sets, django-mptt

我试图通过提供比管理员中的平面列表更友好的东西来将 django-mptt 和 contrib.admin 联系在一起。因为树应该很大（否则我不会使用嵌套集），用户应该能够展开和折叠它的一部分。

当用户展开或折叠或展开一个分支（使用 ajax）时，还会设置一个 cookie，其中包含一个逗号分隔的折叠分支列表。这样，下次这个用户访问我的 django-mptt 驱动模型的管理员时，我可以向他展示他离开它的确切状态的树。现在我想使用这个折叠分支列表来通过只获取树的需要部分来减轻我的数据库的负担。

有没有办法有效地做到这一点？我用谷歌搜索的解决方案是对每个分支进行查询，这样他们就可以避免在分支折叠时进行查询，但这对我来说看起来不是很有效。也许有固定数量的查询是可能的？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-21T19:20:35.273

你并没有真正解释你在做什么，所以有点难以帮助。（你对树做了什么？你如何显示它？你希望用户能够做什么？）

Django-MPTT 树中的每个元素都有一个`get_children()`方法 - 使用可选`include_self=True`参数，您可以获得元素及其所有子元素的列表。您可以使用它来预过滤子树，以便仅显示其中的一部分，如果这是您想要的。

如果您希望用户能够在不重新加载页面的情况下动态展开和折叠部分树，则需要使用 AJAX。周围有各种启用 AJAX 的树形视图控件——我自己使用 jQuery 编写了一个——毫无疑问，其中一个会按照你想要的方式做一些事情。

# .net - CommandBehavior.SingleRow 导致数据库连接保持打开状态？

> ID：894086
> 
> 赞同：3
> 
> 时间：2009-05-21T17:23:49.830
> 
> 标签：.net, database, vb.net

最近我在 VB.NET 中进行一个项目，我遇到了一些数据库连接的神秘问题。这是我从别人那里继承的一个项目，他们使用了这样的东西：

```
Dim reader As SqlDataReader = myCommand.ExecuteReader(CommandBehavior.CloseConnection And CommandBehavior.SingleRow)
//after reading data
reader.Close() 
```

似乎这导致连接始终无法正确关闭。我已经删除了 CommandBehavior.SingleRow，现在它似乎工作正常，但我想知道是否有其他人遇到过这个问题？有谁知道为什么那行不通？我以前见过以这种方式组合 CommandBehaviors，但以前从未引起过这个问题。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-10-11T16:54:06.000

组合标志时，使用**OR**运算符而不是**AND**：

```
Dim reader As SqlDataReader = myCommand.ExecuteReader(CommandBehavior.CloseConnection Or CommandBehavior.SingleRow) 
```

# python - 如何使用 Python 获取当前文件、当前类和当前方法？

> ID：894088
> 
> 赞同：34
> 
> 时间：2009-05-21T17:23:59.863
> 
> 标签：python, filenames

*   运行代码的文件名
*   运行代码的类的名称
*   运行代码的方法的名称（类的属性）

* * *

## 回答 #1

> 赞同：33
> 
> 时间：2009-05-21T17:34:00.637

以下是每个示例：

```
from inspect import stack

class Foo:
    def __init__(self):
        print __file__
        print self.__class__.__name__
        print stack()[0][3]

f = Foo() 
```

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2009-05-21T17:34:10.277

```
import sys

class A:
    def __init__(self):
        print __file__
        print self.__class__.__name__
        print sys._getframe().f_code.co_name

a = A() 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-05-21T17:28:33.487

```
self.__class__.__name__  # name of class i'm in 
```

其余的 sys 和 trace 模块

[http://docs.python.org/library/sys.html](http://docs.python.org/library/sys.html) [http://docs.python.org/library/trace.html](http://docs.python.org/library/trace.html)

更多信息： [https](https://mail.python.org/pipermail/python-list/2001-August/096499.html) ://mail.python.org/pipermail/python-list/2001-August/096499.html 和 [http://www.dalkescientific.com/writings/diary/archive/2005/04/20/ tracking_python_code.html](http://www.dalkescientific.com/writings/diary/archive/2005/04/20/tracing_python_code.html)

您是否希望它用于错误报告，因为回溯模块可以处理：

[http://docs.python.org/library/traceback.html](http://docs.python.org/library/traceback.html)

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-05-21T21:39:35.370

要*非常*小心。考虑：

```
class A:
    pass

B = A
b = B() 
```

这里的“类名”是`b`什么？是A还是B？为什么？

关键是，您不需要知道或关心。一个对象就是它：它的名字很少有用。

# php - 深入了解查询优化

> ID：894092
> 
> 赞同：0
> 
> 时间：2009-05-21T17:25:36.927
> 
> 标签：php, sql, mysql, optimization

我在这里尝试基本上找到具有活动目标的运动和地区的用户。在访问 [users] 表中，大约有 17K 用户。每个人都可以有一定数量的运动兴趣和一个地区。

此处的查询会查找至少拥有一项运动和一个地区的每个用户，这些用户至少是这些活动的目标。当我们选择每个 em 时，Sports 最多可以达到 75 个 [对 IN 查询不太好]。

```
SELECT a.user, pp.courriel
FROM acces a
LEFT JOIN acces_profil_sport ap ON ap.id = a.id
LEFT JOIN profil_perso pp ON pp.id = a.id
WHERE ap.sport_id IN
  (
    SELECT ac.sport_id
    FROM activite_sport ac
    RIGHT JOIN activite a ON a.activite_id = ac.activite_id AND a.is_cron = 1 AND a.cron_processed = 0
   )
  AND pp.region_id IN
  (
    SELECT ar.region_id
    FROM activite_region ar
    RIGHT JOIN activite a ON a.activite_id = ar.activite_id AND a.is_cron = 1 AND a.cron_processed = 0
  )
GROUP BY a.id 
```

如果我删除运动查找，查询需要大约 30 秒才能运行。否则它需要很长时间并且使用mysql的大约99％的proc。

有什么帮助吗？

[编辑：表结构]
访问权限：id（主键）、用户、个人`_`id（配置文件个人的键/外键`_`[个人`_`id]）[一些其他字段]
个人`_`信息：个人`_`id（主键）库里尔、地区`_`id，id（访问 [id] 的外键）[其他一些字段]
访问 profil运动：id/sport id（双主键），niveau id（带运动id 的`_`双键）`_``_``_``_`

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-21T17:51:21.587

我怀疑你的索引是错误的。如果您打印出一个*解释选择...*，我可以更好地对此发表评论。此外，我很好奇您为什么要进行左/右连接和子选择。

在我看来，这些都应该是正常的连接，因为两个左连接只有在它们存在时才有效。如果它们为空，则由于所需的子选择匹配，您将不会得到一行。

至于正确的连接，您需要那里的 ar 位，它不是右侧的一部分。我要么删除它们，要么也将它们直接连接起来。我假设由于您正在检查看起来像是未处理的 cron 工作的内容，因此您希望保留它们。

```
SELECT a.user, pp.courriel
FROM acces 
JOIN acces_profil_sport ap ON ap.id = a.id
JOIN profil_perso pp ON pp.id = a.id
JOIN activite_sport ac ON ac.sport_id = ap.sport_id
JOIN activite a1 ON a.activite_id = ac.activite_id AND a.is_cron = 1 AND a.cron_processed = 0
JOIN activite_region ar ON ar.region_id = pp.region_id
JOIN activite a2 ON a.activite_id = ar.activite_id AND a.is_cron = 1 AND a.cron_processed = 0 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-21T18:57:09.457

```
SELECT acces.user, courriel
FROM acces
JOIN profil_perso ON acces.id = profil_perso.id
WHERE EXISTS (SELECT 1 FROM acces_profil_sport JOIN activite_sport on acces_profil_sport.sport_id = activite_sport.sport_id JOIN activite ON activite.activite_id = activite_sport.activite_id WHERE is_cron = 1 AND cron_processed = 0 AND acces_profil_sport.id = profil_perso.id)
AND EXISTS (SELECT 1 FROM activite_region JOIN activite ON activite_region.activite_id = activite.activite_id WHERE is_cron = 1 AND cron_processed = 0 AND activite_region.region_id = profil_perso.region_id); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-21T18:06:18.730

你在`is_cron`和上有索引`cron_processed`吗？它可以帮助加快速度。

# objective-c - Cocoa 接口的惯用、经典、开源示例？

> ID：894093
> 
> 赞同：11
> 
> 时间：2009-05-21T17:25:39.453
> 
> 标签：objective-c, cocoa

您好，我目前正在学习 Cocoa 和 Objective-C。我已经阅读了“所有”教程，并且对 ObjC 语言相当熟悉。我现在正在寻找的是学习 Cocoa 习语并查看漂亮的 Cocoa 应用程序中使用的真实代码。

看起来严肃的应用程序（iTunes 等）不仅仅包含 IB 元素。他们用代码做更多的事情来调整它们看起来不错。（例如：iTunes 播放列表抽屉。如何获得这种样式？）

以下是我发现的一些开源的漂亮 UI 示例：

*   Smultron（[当前主页](http://www.peterborgapps.com/smultron)，[开源分支](https://github.com/jfmoy/Fraise)）
*   [传送](http://www.transmissionbt.com/)
*   [维也纳](http://www.vienna-rss.org/)
*   [Gitnub](https://github.com/Caged/gitnub/wiki)

关于具有出色 Cocoa 用户界面的开源应用程序的任何其他建议？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-05-21T17:51:15.347

您可能想查看 Brandon Walkin 的[BWToolkit](http://www.brandonwalkin.com/bwtoolkit/)。它非常棒，包含一组优雅的 UI 元素和其他对象。提供了源代码，因此您可以了解如何创建自定义控件和视图。

Brandon 甚至还提供了一些演练影片，例如“3 分钟创建 iCal 界面”。

其他一些需要深入研究的开源应用程序是[Camino](http://caminobrowser.org)、适用于 Mac 和 iPhone 的[Colloquy 、](http://colloquy.info/) [Ad​​ium](http://adium.im/)和[Quicksilver](http://code.google.com/p/blacktree-alchemy/)（大量 UI 定制）。

# bytearray - 创建缩略图，然后转换为字节数组

> ID：894098
> 
> 赞同：7
> 
> 时间：2009-05-21T17:26:50.497
> 
> 标签：bytearray, thumbnails, system.drawing

我在创建缩略图然后将它们转换为字节数组方面花了很多时间。我已经尝试了三种方法，并且所有 3 次都出现错误。

第一个是使用Bitmap.GetThumbnailImage，我以前用过，然后直接保存到Response.OutputStream

第二个是使用带有 DrawImage() 的 System.Drawing.Graphics。还是不行。

第三个只是创建一个新的位图，传入旧的位图，并设置新的大小。同样的错误。

> 值不能为空。
> 参数名称：encoder
> 
> 描述：当前web请求执行过程中出现未处理的异常。请查看堆栈跟踪以获取有关错误及其源自代码的位置的更多信息。
> 
> 异常详细信息：System.ArgumentNullException：值不能为空。
> 参数名称：编码器
> 
> 源错误：
> 在执行当前网络请求的过程中产生了一个未处理的异常。可以使用下面的异常堆栈跟踪来识别有关异常起源和位置的信息。
> 
> 堆栈跟踪：
> [ArgumentNullException：值不能为空。
> 参数名称：编码器]
> System.Drawing.Image.Save(Stream 流，ImageCodecInfo 编码器，EncoderParameters encoderParams) +615244

这是我的方法的代码。也许有人会看到我做错了什么。如果您不确定 GetThumbSize，它只是一种获取图像大小和最大拇指大小然后计算实际大小以保持纵横比的方法。

```
public static System.Drawing.Image.GetThumbnailImageAbort thumbnailCallback = new System.Drawing.Image.GetThumbnailImageAbort(ThumbnailCallback);

    public static bool ThumbnailCallback()
    {
        return false;
    }

    /// <summary>
    /// 
    /// </summary>
    /// <param name="image"></param>
    /// <param name="size"></param>
    /// <remarks>
    /// This method will throw a AccessViolationException when the machine OS running the server code is windows 7.
    /// </remarks>
    /// <returns></returns>
    public static byte[] CreateThumbnail(byte[] imageData, Size size)
    {
        using (MemoryStream inStream = new MemoryStream())
        {
            inStream.Write(imageData, 0, imageData.Length);

            using (System.Drawing.Image image = Bitmap.FromStream(inStream))
            {
                Size thumbSize = GetThumbSize(new Size(image.Width, image.Height), size);

                //do not make image bigger
                if (thumbSize.Equals(image.Size) || (image.Width < size.Width || image.Height < size.Height))
                {
                    //if no shrinking is ocurring, return the original bytes
                    return imageData;
                }
                else
                {
                    using (System.Drawing.Image thumb = image.GetThumbnailImage(thumbSize.Width, thumbSize.Height, thumbnailCallback, IntPtr.Zero))
                    {

                        using (MemoryStream outStream = new MemoryStream())
                        {
                            thumb.Save(outStream, thumb.RawFormat);

                            return outStream.ToArray();
                        }
                    }
                }
            }
        }

    } 
```

此行抛出错误：

```
thumb.Save(outStream, thumb.RawFormat); 
```

有任何想法吗？谢谢您的帮助！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-21T17:52:26.777

我认为问题可能是原始图像的编码。IIRC, Save(stream, format) 导致对 Save(stream, encoder, params) 的调用，编码器取自格式；在您的情况下，这是图像的原始格式。

根据[Save method](http://msdn.microsoft.com/en-us/library/ms142147.aspx)的社区内容，某些格式无法很好地转换为适当的编码器。

我建议您自己指定编码器，使用一些标准格式，如 PNG。

尝试：

```
thumb.Save(outStream, ImageFormat.Png, null); // optionally add encoder parameters here, like quality or luminescence 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-01-05T21:57:40.950

如果您尝试将其保存为 Raw 格式，您可以尝试以下操作，在我的情况下，当原始图像格式受支持时它可以工作：

```
try
{
   thumb.Save(outStream, img.RawFormat);
}
catch (System.ArgumentNullException)
{
   thumb.Save(outStream, ImageFormat.Png);
} 
```

# asp.net - 如何让 ASP.NET 开发服务器在 80 端口上运行？

> ID：894103
> 
> 赞同：4
> 
> 时间：2009-05-21T17:27:12.257
> 
> 标签：asp.net

我正在处理这个 ASP.NET 网站项目，当我构建 (Ctrl-F5) Visual Studio 2008 使用 ASP.NET 开发服务器在端口 4730 上运行网站时。有没有办法让它在端口 80 上运行？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-05-21T17:31:15.167

项目属性>Web>选择Specific Port并填写`80`

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-21T17:30:02.440

我相信这是在项目设置中完成的，您可以将参数定义为 Cassini 或让它在 IIS 上运行。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-21T17:32:43.637

您还可以使用命令行选项在您想要的任何端口上启动网络服务器。当然，条件是端口可用。

[http://azamsharp.com/Posts/22_Programmatically_Starting_Web_Server_to_Execute_WatiN_Tests.aspx](http://azamsharp.com/Posts/22_Programmatically_Starting_Web_Server_to_Execute_WatiN_Tests.aspx)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-21T17:33:29.080

右键单击解决方案资源管理器中的项目并选择属性，然后指定端口“80”和虚拟路径，例如：“/mayApp”

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-21T17:47:31.733

以下是步骤。

1.) 如果您的工作站上已经有 IIS，那么很有可能它必须在端口 80 上运行。如果是这种情况，那么您必须首先通过停止 IIS 网站服务来释放端口 80。请参阅下面的屏幕截图。

[替代文字 http://ruchitsurati.net/files/iis_stop.png](http://ruchitsurati.net/files/iis_stop.png)

2.) 现在您需要在 Visual Studio 中转到网站项目的“属性”窗口。并按照下面的屏幕截图进行设置。你完成了！按 F5 并查看它在端口 80 上运行。

[替代文字 http://ruchitsurati.net/files/port80_prop.png](http://ruchitsurati.net/files/port80_prop.png)

谢谢。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-21T17:32:03.887

在解决方案资源管理器中选择网站并打开属性窗口。将 Use dynamic ports 更改为 false 并将端口号更改为 80。您可能必须在将 bool 更改为 false 后单击离开站点，然后单击返回以使端口字段可用。

# php - SQL 查询可在测试服务器上运行，但不能在现场运行......可能有什么区别？

> ID：894104
> 
> 赞同：1
> 
> 时间：2009-05-21T17:27:30.823
> 
> 标签：php, sql, mysql, mysqli

已解决：我在本地服务器上编写并测试了一个 PHP 脚本。（没什么花哨的，只是在同一个数据库中连续插入 2 个 SQL，但表不同）。

两台服务器都运行 PHP5 和 MYSQL 5。

在本地服务器上，两个查询都得到了正确处理。

在实时服务器上，只有第一个查询有效，而第二个查询无效，我不知道为什么。

这是代码：

```
 $sql_login = "INSERT INTO logintbl 
              (...) 
           VALUES (...)";
   $result_login = mysqli_query($this->connect, $sql_login);

   # Fill contact details
   $sql_contactD = "INSERT INTO contactDetails
                    (...)
         VALUES (...)";
   $result_contactD = mysqli_query($this->connect, $sql_contactD); 
```

在我的本地服务器上，两个查询都返回 true，并且数据被添加到数据库中。

在我的实时服务器上，第一个查询按预期工作，但第二个查询失败，没有任何错误消息。

当然，两台服务器上的表结构是相同的。两个表都在同一个数据库中，并且用户对数据库具有足够的权限。

关于什么可能是错的任何线索？

* * *

编辑 1：权限：是的，用户对两个表都有足够的权限。

* * *

编辑 2：我感觉很傻，但是按照 James 关于检查 mysqli_error() 的建议，我发现生产服务器在表名方面是区分大小写的，这与我的测试服务器不同，并且它转换了我的原始名称表 (contactDetails) 转换为小写 (contactdetails)。

感谢大家的帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-21T17:32:18.473

您是否检查过生产环境中的权限？意思是您是否已确认您具有对contactDetails 的插入访问权限？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-21T18:59:54.940

您是否尝试将 $sql_contactD 打印到屏幕（或网页），然后在 MySQL 查询浏览器中运行完全相同的查询？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2010-06-10T08:54:55.480

回答我自己的问题，因为它看起来是正确关闭它的唯一方法：

> 我感觉很傻，但是按照 James 关于检查 mysqli_error() 的建议，我发现生产服务器在表名方面是区分大小写的，这与我的测试服务器不同，并且它转换了我表的原始名称（contactDetails ) 转为小写（contactdetails）。

# .net - 您如何判断您的迁移是否与 migratordotnet 保持同步？

> ID：894120
> 
> 赞同：1
> 
> 时间：2009-05-21T17:31:36.897
> 
> 标签：.net, sql-server, migration, migratordotnet

我正在使用[migratordotnet](http://code.google.com/p/migratordotnet/)来管理我的数据库迁移。我在[这样的应用程序设置上运行它们](https://stackoverflow.com/questions/868223/migratordotnet-run-migrations-from-within-application-w-o-nant-or-build)，但我还想在应用程序启动时检查迁移是否是最新的，并提供迁移到最新的选项。如何判断是否有可用的迁移需要应用？我看到我可以得到像这样应用的迁移

```
var asm = Assembly.GetAssembly(typeof(Migration_0001));
var migrator = new Migrator.Migrator("SqlServer", setupInfo.DatabaseConnectionString, asm);
var applied = migrator.AppliedMigrations; 
```

我喜欢做这样的事情：

```
var available = migrator.AvailableMigrations; //this property does not exist. 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-21T17:50:20.277

我找到了方法。查看 migratordotnet 源代码会有所帮助。

```
var provider = ProviderFactory.Create("SqlServer", myConnectionString);
var loader = new MigrationLoader(provider, asm, false);
var availableMigrations = loader.GetAvailableMigrations(); 
```

# c# - 如何在 Web 服务中获取客户端发送的 X509Certificate？

> ID：894121
> 
> 赞同：11
> 
> 时间：2009-05-21T17:31:38.833
> 
> 标签：c#, web-services, x509certificate2

显然我在之前的帖子中问了错误的问题。我有一个使用 X.509 证书保护的 Web 服务，作为安全网站 ( [https://...](https://..) ) 运行。我想使用公司根 CA 颁发的客户端机器证书（也是 X.509）向服务器验证客户端机器是否有权使用该服务。为此，我需要检查证书并寻找一些识别特征并将其与存储在数据库中的值（可能是指纹？）相匹配。

这是我用来从本地证书存储区获取证书的代码（直接来自[http://msdn.microsoft.com/en-us/magazine/cc163454.aspx](http://msdn.microsoft.com/en-us/magazine/cc163454.aspx)）：

```
 public static class SecurityCertificate
{
    private static X509Certificate2 _certificate = null;

    public static X509Certificate2 Certificate
    {
        get { return _certificate; }
    }

    public static bool LoadCertificate()
    {
        // get thumbprint from app.config
        string thumbPrint = Properties.Settings.Default.Thumbprint;
        if ( string.IsNullOrEmpty( thumbPrint ) )
        {
            // if no thumbprint on file, user must select certificate to use
            _certificate = PickCertificate( StoreLocation.LocalMachine, StoreName.My );
            if ( null != _certificate )
            {
                // show certificate details dialog
                X509Certificate2UI.DisplayCertificate( _certificate );
                Properties.Settings.Default.Thumbprint = _certificate.Thumbprint;
                Properties.Settings.Default.Save();
            }
        }
        else
        {
            _certificate = FindCertificate( StoreLocation.LocalMachine, StoreName.My, X509FindType.FindByThumbprint, thumbPrint );
        }

        if ( null == _certificate )
        {
            MessageBox.Show( "You must have a valid machine certificate to use STS." );
            return false;
        }

        return true;
    }

    private static X509Certificate2 PickCertificate( StoreLocation location, StoreName name )
    {
        X509Store store = new X509Store( name, location );
        try
        {
            // create and open store for read-only access
            store.Open( OpenFlags.ReadOnly );

            X509Certificate2Collection coll = store.Certificates.Find( X509FindType.FindByIssuerName, STSClientConstants.NBCCA, true );
            if ( 0 == coll.Count )
            {
                MessageBox.Show( "No valid machine certificate found - please contact tech support." );
                return null;
            }

            // pick a certificate from the store
            coll = null;
            while ( null == coll || 0 == coll.Count )
            {
                coll = X509Certificate2UI.SelectFromCollection(
                        store.Certificates, "Local Machine Certificates",
                        "Select one", X509SelectionFlag.SingleSelection );
            }

            // return first certificate found
            return coll[ 0 ];
        }
        // always close the store
        finally { store.Close(); }
    }

    private static X509Certificate2 FindCertificate( StoreLocation location, StoreName name, X509FindType findType, string findValue )
    {
        X509Store store = new X509Store( name, location );
        try
        {
            // create and open store for read-only access
            store.Open( OpenFlags.ReadOnly );

            // search store
            X509Certificate2Collection col = store.Certificates.Find( findType, findValue, true );

            // return first certificate found
            return col[ 0 ];
        }
        // always close the store
        finally { store.Close(); }
    } 
```

然后，我将证书附加到出站流中：

```
public static class ServiceDataAccess
{    
    private static STSWebService _stsWebService = new STSWebService();

    public static DataSet GetData(Dictionary<string,string> DictParam, string action)
    {
        // add the machine certificate here, the first web service call made by the program (only called once)
        _stsWebService.ClientCertificates.Add( SecurityCertificate.Certificate );
        // rest of web service call here...
    }
} 
```

我的问题是——我如何“获取”网络服务代码中的证书？我遇到的大多数示例代码片段都涵盖了如何进行自定义验证，其中有一个 GetCertificate() 调用，显然假设这部分很容易每个人都应该知道怎么做？

我的主类继承自 WebService，所以我可以使用 Context.Request.ClientCertificate 来获取证书，但那是 HttpClientCertificate，而不是 X509Certificate2。HttpContext 给了我同样的结果。其他方式都是使用web配置代码调用预定义的验证码，不知道如何调用自定义的C#方法进行验证。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-05-21T17:49:29.263

我记得做过类似的事情，已经有一段时间了，但是你有没有在你的网络服务中尝试过这个：

```
X509Certificate2 cert = new X509Certificate2(Context.Request.ClientCertificate.Certificate); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-10-01T01:29:32.357

关于如何将证书绑定回用户的主题，因此假设与密钥关联的用户的身份是好的（因为证书已被验证回受信任的根并且尚未被撤销），那么您需要绑定证书向用户声明的身份。您可以只使用主题 DN 的 LDAP 字符串形式并查找 (cn=Username,ou=Department...) 以确定本地 ID。这在用户重新生成他们的密钥/证书的情况下是有弹性的，比如由于卡丢失或证书自然到期。这取决于这样一个事实，即两个 CA 不会向两个不同的人颁发两个具有相同主题名称的证书。

如果证书是由 MS CA 颁发的，则它可能有一个 UPN，它实际上是一个域登录名。

或者，如果您想将用户的身份与实际证书相关联，通常的方法是存储颁发者名称和证书序列号。CA 必须为每个证书颁发唯一的序列号。注意序列号可能很大，具体取决于 CA。然而，使用此方法并不意味着每次重新颁发用户证书时都必须更新数据库中的证书详细信息。

# c++ - C++ 中用于计划任务的 Win32 函数

> ID：894124
> 
> 赞同：2
> 
> 时间：2009-05-21T17:31:52.483
> 
> 标签：c++, multithreading, winapi

我在 C++ 中有一个函数，需要在一段时间后调用，并且重复此任务。您知道 Win32 或 pthread 中的任何内置函数或示例代码吗？

谢谢，

朱利安

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-21T17:38:03.763

[SetTimer](http://msdn.microsoft.com/en-us/library/ms644906.aspx)怎么样。

1.  创建一个包装函数以用作设置计时器的回调。
2.  包装函数调用您的函数。
3.  函数完成后，包装函数再次调用 SetTimer 以重新设置计时器。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-21T18:18:34.823

顺便说一句，我希望您不要在代码中做一些可以通过操作系统完成的事情。（我对您的要求知之甚少，但我想我会指出来）。

诸如任务调度器（windows）之类的东西是为调度重复任务而设计的，它们通常比手动解决方案做得更好。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-07-10T12:49:49.113

设置定时器！

一个例子：

```
 #include <windows.h>
  #include <stdio.h>

  void CALLBACK scheduled_task_1 (HWND hwnd, UINT msg, UINT id, DWORD time) 
  {
      puts("Executing  scheduled_task_1 every half-second event");
  }

  void CALLBACK scheduled_task_2 (HWND hwnd, UINT msg, UINT id, DWORD time) 
  {
      puts("Executing  scheduled_task_2 every two seconds event");
  }

  void CALLBACK scheduled_task_3 (HWND hwnd, UINT msg, UINT id, DWORD time) 
  {
      puts("Executing  scheduled_task_3 24 hours event");

  }

  void messageLoop(void) {
    MSG msg;
    while (GetMessage(&msg, NULL, 0, 0) > 0)
      DispatchMessage( &msg );
  }

  int main(void) 
  {
    while(true)
    {
        SetTimer (NULL, 0,   500, scheduled_task_1);  /* every half-second */
        SetTimer (NULL, 0,  2000, scheduled_task_2);  /* every two seconds */
        SetTimer (NULL, 0, 60*60*24*1000, scheduled_task_3); /* after 24 hours or 86400000 milliseconds */
        messageLoop();
    }
    return 0;
  } 
```

# asp.net-mvc - 添加默认的 SelectListItem

> ID：894130
> 
> 赞同：16
> 
> 时间：2009-05-21T17:32:53.900
> 
> 标签：asp.net-mvc, linq

```
 public IEnumerable<SelectListItem> GetList(int? ID)
 {
      return from s in db.List
             orderby s.Descript
             select new SelectListItem
             {
                 Text = s.Descript,
                 Value = s.ID.ToString(),
                 Selected = (s.ID == ID)
             };
 } 
```

我将上述内容返回到视图并填充`DropDownList`. 我想`SelectListItem (0, "Please Select..")`在上面的 linq 结果返回到视图之前添加一个默认值。这可能吗？

* * *

## 回答 #1

> 赞同：31
> 
> 时间：2009-05-21T17:37:43.797

```
return new[] { new SelectListItem { Text = ... } }.Concat(
       from s in db.List
       orderby s.Descript
       select new SelectListItem
       {
           Text = s.Descript,
           Value = s.ID.ToString(),
           Selected = (s.ID == ID)
       }); 
```

* * *

## 回答 #2

> 赞同：21
> 
> 时间：2009-05-21T17:45:24.483

当您使用 ASP.NET MVC 时，您可以在视图中通过为 HtmlHelper 的 DropDownField 方法的 optionLabel 参数指定一个值来执行此操作 - 例如：

```
htmlHelper.DropDownList("customerId", selectList, "Select One"); 
```

将这种类型的代码放在 UI 层中可能比将其放在数据层中更合适。这样做的一个缺点是您的选择框将有一个空字符串值，而不是“选择一个”选项的“0”，但这并不是真正的问题，因为如果您的控制器操作，您可以将其视为空值方法可以接受相关参数的可为空的 int - 例如

```
public ActionResult DoSomething(int? customerId)
{
  if(customerId != null)
  {
    // do something with the value
  }
} 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-05-21T17:35:17.250

```
var list = from s in db.List
           orderby s.Descript
           select new SelectListItem
           {
               Text = s.Descript,
               Value = s.ID.ToString(),
               Selected = (s.ID == ID)
           };

list.Insert(0, new SelectListItem { Text = "Please Select...", Value = string.Empty });
return list; 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-21T20:02:51.367

这就是我所做的，我将我的值从 XML 文件读入 IList。然后我将一条新记录插入到位置 0 的 IList 中。然后从 IList 中创建一个选择列表。

> IList< MY_DATA > mydata = (来自 tmp in myXML.Descendants("R").ToList()
> 
> ```
>  select new MY_DATA
>                       {
>                          NR = tmp.Attribute("NR").Value,
>                          NA = tmp.Attribute("NA").Value 
>                       }).ToList<MY_DATA>(); 
> ```
> 
> mydata.Insert(0, new My_DATA() { NR = "", NA = "--点击选择--" });
> 
> SelectList mylist = new SelectList(mydata, "NR", "NA");

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-22T13:44:32.773

首先将您的默认值放入列表中

list.add（您的默认列表项）

然后做 list.addrange(linq select query)

干杯

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-03-06T12:19:47.510

在我查看了很多问题之后，我没有找到我要找的东西。我不需要很多代码行来做一个简单的下拉菜单。所以我想和你分享我使用的东西，它简单易用..（特别是如果你不想使用实体框架..

使用 System.Web.Mvc；

```
SelectList(IEnumerable items, string dataValueField, string dataTextField); 
```

例如：

在**控制器**中添加：

```
SelectList slTitle = new SelectList(Query.SelectAllTitle(), "TitleID", "TitleName");
ViewBag.TitleSelectList = slTitle; 
```

在**视图**中添加：

```
@Html.DropDownList("TitleSelectList", "--please select--") 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2016-07-28T20:16:57.780

这仅适用于使用 Razor V2 和 C# 的网页框架（不是 MVC 和 webform）的人，您需要这样做

```
 @Html.DropDownList("category", "Please select", listData) 
```

注意：OptionalLabel 需要作为中间参数。

等效的是将 SelectListitem 添加到您的列表数据中：

```
 var list=db.Query("select id, name from dbtable");
    List<SelectListItem> listData = new List<SelectListItem>();
    listData.Add(new SelectListItem
    {
        Text = "Please select",
        Value = "",
    }); 

    foreach(var item in list)   {
        listData.Add(new SelectListItem  {
            Text = item.Name,
            Value = item.id,
            Selected = isSelected 
        });
    }

    @Html.DropDownList("play" , listData) 
```

# performance - Silverlight 2.0 应用程序中的性能监控

> ID：894135
> 
> 赞同：0
> 
> 时间：2009-05-21T17:33:42.900
> 
> 标签：performance, monitoring, silverlight-2.0

有没有办法监控 Silverlight 2.0 应用程序的 CPU 和内存使用情况？有没有可用的工具来做到这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-21T17:49:32.167

尽管没有完美的答案，但对于完整的功率分析，请将您的 Silverlight 应用程序转换为 WPF 桌面应用程序。WPF 桌面应用程序有很多分析器。

或者，我发现了一个非常酷的工具，可以满足您的需求： [Silverlight Spy 是一个免费的基本分析器，适用于 2.0 和 3.0](http://firstfloorsoftware.com/silverlightspy/)

[本文解释了用户采用的其他一些方法](http://silverlight.net/forums/p/12623/40875.aspx)

这个[堆栈溢出问题](https://stackoverflow.com/questions/55943/how-to-profile-a-silverlight-application)使用 Windows Server 工具提供了另一个答案，但它没有提到这些其他技术，我不确定你是否问同样的问题。[无论如何，它建议使用 XPerf，所以这里是使用 XPerf 分析 Silverlight](http://blogs.msdn.com/tims/archive/2009/03/24/building-an-optimized-graphics-intensive-silverlight-application.aspx)的一个很好的解释

# apache-flex - Flex 中的导航问题 - ViewStack、状态或其他？

> ID：894141
> 
> 赞同：0
> 
> 时间：2009-05-21T17:34:38.203
> 
> 标签：apache-flex, mate, viewstack

我对使用 Mate 框架创建的应用程序有点怀疑。用户要做的第一件事就是登录，所以我创建了 Login.mxml 视图。成功登录后，我需要在顶部显示带有 applicationControlBar 的主视图，在下方显示一个工作区。目前我有两个独立的视图，所以如果我理解正确的话，使用 ViewStack 是有意义的。

问题是，我还想在登录后在工作区顶部显示某种带有按钮的面板 -[这](http://img207.imageshack.us/img207/3808/screentoi.png)是屏幕截图。单击按钮后，面板应该消失。更复杂的是，这个面板有可能改变状态。单击特定按钮可能会导致在面板底部显示进度条。

我觉得我应该创建单独的视图 MenuDialog.mxml 并在那里放置按钮、进度条和状态，但是如何将它显示在工作区的顶部？我希望我的问题足够清楚:)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-21T19:12:34.137

我会让面板成为一个弹出窗口，主应用程序（或 ViewStack 的父容器）作为弹出窗口的父项。您可以使用 PopUpManager 类根据面板中的用户操作将其关闭。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-26T00:25:09.160

假设您可能*不*想要模态登录样式面板（如今许多应用程序都避开），那么您绝对应该使用状态而不是 ViewStacks。

状态是一种更清晰的方式来区分你的 UI 可以在 -LOGGED_IN、LOGGED_OUT 等中的各种状态。

习惯使用状态可能需要一点时间，但一旦你这样做了，你就再也回不去了。:-)

# iphone - 实现 handleOpenURL 消息时如何调试？

> ID：894153
> 
> 赞同：5
> 
> 时间：2009-05-21T17:39:11.703
> 
> 标签：iphone, ios-simulator

我正在编写一个可以通过自定义 URL 启动的 iPhone 应用程序。所以，我覆盖 -`(BOOL)application:(UIApplication *)application handleOpenURL:(NSURL *)url`

要测试我的更改，我必须在模拟器中运行应用程序，然后退出并启动 Safari。然后我在地址栏中输入我的自定义 URL 以启动应用程序。

但是每次我启动时，应用程序都会崩溃。我试图找出原因，但是当我设置断点并从主屏幕（而不是在 XCode 中）启动应用程序时，它似乎没有附加。

我什至尝试将 NSLog 语句放在 handleOpenURL 消息中，但它们不会打印到控制台。

我想我可以创建 UIAlertViews 但是......是的，哎呀。在模拟器中连接到调试会话的任何其他方式？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2011-04-19T14:25:50.473

在 Xcode 4 中，您可以编辑目标的方案，在“运行”部分的“信息”选项卡中，您可以选择“等待 MyApp.app 启动”选项：

![在此处输入图像描述](https://i.stack.imgur.com/in3JT.png)

这将导致调试器等到您的应用程序下次启动时，然后附加到该进程而不是为您创建新进程。这将允许您从 Safari 手动启动您的应用程序并使用调试器。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-05-21T18:30:33.567

打开 Console.app（在 Utilities 文件夹中）。您的日志消息应该出现在那里。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-21T18:36:00.420

你能写一个单元测试来锻炼你的 AppDelegate 的功能吗？

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-21T21:01:02.873

我还没有尝试过，但是如何在代码中内联添加断点指令：

```
#if TARGET_CPU_ARM == 1
#define breakpoint() __asm__ volatile ("bkpt 0")
#else   // !ARM - assume INTEL. Everything else will break
#define breakpoint() __asm__ volatile ("int3");
#endif 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2011-09-16T16:40:01.817

在 hadleOpenURL 中添加以下内容作为第一行：

[NSThread sleepForTimeInterval:30.0] 并将断点放在之后的下一行。

调用应用程序后，您将有 30 秒的时间转到 XCode 并从菜单中选择：运行/“附加到进程”并从列表中选择您的应用程序名称。您的调试器应该在您的断点处停止。

完成后不要忘记删除 sleepForTimeInterval ！

# asp.net - 如何在 NavigateURL 中正确包含两个动态项？

> ID：894154
> 
> 赞同：0
> 
> 时间：2009-05-21T17:39:12.407
> 
> 标签：asp.net, gridview

我有一个使用绑定、超链接和模板字段的网格视图。

我试图弄清楚如何在`Lo-Fi:HyperLink`控件和`Hi-Fi:HyperLink`控件的 NavigateURL 中正确地包含两个动态项模板列。

我需要将`<%# Eval("Locker_LO_Filename")%>`我用于 text 属性的项目连接到 {1} 当前所在的 URL 的末尾。

```
<asp:GridView ID="gvLocker" runat="server" HeaderStyle-BackColor="Goldenrod" 
        HeaderStyle-ForeColor="DarkBlue" AlternatingRowStyle-BackColor="Cornsilk" 
            Font-Names="Verdana,arial,helvetica" AutoGenerateColumns="False" Font-   Size="13px" Width="640px" BorderColor="#404040">
            <Columns>   
                <asp:BoundField DataField="memid" HeaderText="MemID" ReadOnly="True" SortExpression="memid"
                    Visible="False" HeaderStyle-Font-Size="13px" />                         
                <asp:HyperLinkField  DataNavigateUrlFormatString="myLockerEditSong.aspx?ID={0}&amp;li={1}"
                    DataTextField="EditIt" DataNavigateUrlFields="memid,lockid" HeaderStyle-Font-Size="13px">
                    <ItemStyle Width="65px" Font-Size="13px" />
                    </asp:HyperLinkField>
                <asp:HyperLinkField  DataNavigateUrlFormatString="myLockerDeleteSong.aspx?ID={0}&amp;li={1}"
                    DataTextField="Delete" DataNavigateUrlFields="memid,lockid" HeaderStyle-Font-Size="13px">
                    <ItemStyle Width="65px" Font-Size="13px" />
                </asp:HyperLinkField>
                <asp:TemplateField HeaderText="Song Information" HeaderStyle-Font-Size="13px">
              <ItemTemplate>
                        <strong><asp:Label ID="Label1" runat="server" Text='<%# Eval("Locker_Title") %>'></asp:Label></strong><br />
                        Lo-Fi:<asp:HyperLink ID="HyperLink1" runat="server" NavigateUrl='<%# Eval("memid", "/uploads/{0}/Locker/LoFi/{1}") %>'
                            Text='<%# Eval("Locker_LO_Filename") %>' Font-Size="13px"></asp:HyperLink><br />
                        Hi-Fi:<asp:HyperLink ID="HyperLink2" runat="server" NavigateUrl='<%# Eval("memid", "/uploads/{0}/Locker/HiFi/{1}") %>'
                            Text='<%# Eval("Locker_HI_Filename") %>' Font-Size="13px"></asp:HyperLink>                                
                    </ItemTemplate>
                    <ItemStyle Width="350px" Font-Size="13px" />
                </asp:TemplateField>
                <asp:TemplateField HeaderText="File Information" SortExpression="Locker_UploadDate" HeaderStyle-Font-Size="13px">
                    <ItemTemplate>
                       <strong>Uploaded:</strong> <asp:Label ID="Label2" runat="server" Text='<%# Eval("Locker_UploadDate") %>'></asp:Label><br />
                       <strong>Modified:</strong> <asp:Label ID="Label3" runat="server" Text='<%# Eval("Locker_DateLastModified") %>'></asp:Label>
                       <ItemStyle Font-Size="13px" />
                    </ItemTemplate>                        
                </asp:TemplateField>                    
            </Columns>        
        <HeaderStyle BackColor="#FFDF59" ForeColor="Maroon" HorizontalAlign="Left" />
        <AlternatingRowStyle BackColor="PaleGoldenrod" />
    </asp:GridView> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-21T18:22:10.977

看看这个`GridView` [`RowDataBound`](http://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.gridview.rowdatabound.aspx)事件。你需要这样的东西（未经测试）：

```
void gvLocker_RowDataBound(object sender, GridViewRowEventArgs e)
{
    if (e.Row.RowType == DataControlRowType.DataRow)
    {
        // I'm not sure what kind of data object you use as your datasource,
        // but dataItem should have some type.
        MyObject dataItem = e.Row.DataItem;

        // Find the right control inside the row and set its Text property.
        HyperLink link = (HyperLink) e.Row.FindControl("HyperLink1");
        link.Text = dataItem.Locker_LO_Filename;
    }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-21T18:22:27.390

而不是使用 <%# Eval(..) %>，使用以下..

```
<%# FormatHiFi(DataBinder.Eval(Container.DataItem, "Locker_Title"), DataBinder.Eval(Container.DataItem, "OtherStringName"))%> 
```

这将调用代码隐藏页面（见下文）中的一些代码，这些代码将根据需要格式化字符串。

```
protected string FormatHiFi(object str1, object str2) 
{
   return string.Format("/uploads/{0}/Locker/HiFi/{1}", str1.ToString(), str2.ToString())
} 
```

Lo-Fi 也可以使用同样的方法。我希望这会有所帮助，如果没有，至少可以指出正确的方向。

# mdx - 如何在 MDX 查询中返回级别属性值？

> ID：894156
> 
> 赞同：1
> 
> 时间：2009-05-21T17:39:30.737
> 
> 标签：mdx, pentaho, mondrian

我在包含多个级别的架构文件中定义了一个维度。我的关卡之一包含多个属性，例如：

```
<Level name="MyLevel" column="MyLevelColumn" nameColumn="MyLevelName">
    <Property name="Property1" column="PropertyColumn1"/>
    <Property name="Property2" column="PropertyColumn2"/>
    <Property name="Property3" column="PropertyColumn3"/>
    <Property name="Property4" column="PropertyColumn4"/>
</Level> 
```

如何返回这些属性的值，以及我在架构文件中定义的度量值？

注意：我不想使用这些过滤器来过滤我在 MDX 查询中的结果，所以如果有更好的方法来获取我想要的数据，请告诉我！谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-31T15:52:36.787

我不了解 Pentaho（在他们网站的简短搜索中找不到任何 MDX 文档），但在 SSAS 中，您可以执行以下操作：

```
WITH
MEMBER [Measures].[Property1] AS 
    ([MyDim].[MyLevel].CurrentMember.Properties("Property1"))
SELECT
    {[Measures].[Property1], [Measures].[Amount]}
ON COLUMNS,
    {[MyDim].[MyLevel].MEMBERS}
ON ROWS
FROM [Cube] 
```

# python - 更多 Pythonic 转换为二进制？

> ID：894157
> 
> 赞同：6
> 
> 时间：2009-05-21T17:39:34.790
> 
> 标签：python

这是一个人为的示例，说明我们的许多类如何返回自身的二进制表示（由 C++ 读取）。

```
def to_binary(self):
    'Return the binary representation as a string.'
    data = []

    # Binary version number.
    data.append(struct.pack('<I', [2]))

    # Image size.
    data.append(struct.pack('<II', *self.image.size))

    # Attribute count.
    data.append(struct.pack('<I', len(self.attributes)))

    # Attributes.
    for attribute in self.attributes:

        # Id.
        data.append(struct.pack('<I', attribute.id))

        # Type.
        data.append(struct.pack('<H', attribute.type))

        # Extra Type.        
        if attribute.type == 0:
            data.append(struct.pack('<I', attribute.typeEx))

    return ''.join(data) 
```

我不喜欢的：

*   每行都以 开头`data.append(struct.pack(`，分散了行的独特部分的注意力。
*   字节顺序 ( `'<'`) 一遍又一遍地重复。
*   您必须记住返回样板`''.join(data)`。

我喜欢什么：

*   格式说明符出现在属性名称附近。例如，很容易看出它`self.image.size`被写成两个无符号整数。
*   这些线（大部分）是独立的。例如，要从“属性”中删除 Id 字段，您不必接触超过一行代码。

有没有更易读/pythonic的方式来做到这一点？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-21T17:52:09.883

您可以尝试为您的数据实现某种[声明性语法](http://www.oreillynet.com/pub/a/python/2003/07/31/declarative_python.html)。

这可能会导致类似：

```
class Image(SomeClassWithMetamagic):
    type = PackedValue(2)
    attribute = PackedValue('attributes') # accessed via self.__dict__

#or using decorators
    @pack("<II")
    def get_size():
        pass

#and a generic function in the Superclass
    def get_packed():
        stuff 
```

ETC...

其他示例是 SQLAlchemy 的 declarative_base、ToscaWidgets 和 sprox

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-21T18:48:11.267

```
from StringIO import StringIO
import struct

class BinaryIO(StringIO):
    def writepack(self, fmt, *values):
        self.write(struct.pack('<' + fmt, *values))

def to_binary_example():
    data = BinaryIO()
    data.writepack('I', 42)
    data.writepack('II', 1, 2)
    return data.getvalue() 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-21T20:12:34.390

如果你只是想要更好的语法，你可以滥用生成器/装饰器：

```
from functools import wraps    

def packed(g):
  '''a decorator that packs the list data items
     that is generated by the decorated function
  '''
  @wraps(g)
  def wrapper(*p, **kw):
    data = []
    for params in g(*p, **kw):
      fmt = params[0]
      fields = params[1:]
      data.append(struct.pack('<'+fmt, *fields))
    return ''.join(data)    
  return wrapper

@packed
def as_binary(self):
  '''just |yield|s the data items that should be packed
     by the decorator
  '''
  yield 'I', [2]
  yield 'II', self.image.size[0], self.image.size[1]
  yield 'I', len(self.attributes)

  for attribute in self.attributes:
    yield 'I', attribute.id
    yield 'H', attribute.type
    if attribute.type == 0:
      yield 'I', attribute.typeEx 
```

基本上，这使用生成器来实现“monad”，这是一种通常在 Haskell 等函数式语言中找到的抽象。它将某些值的生成与决定如何将这些值组合在一起的代码分开。它更像是一种函数式编程方法，然后是“pythonic”，但我认为它提高了可读性。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-05-21T20:15:31.437

[协议缓冲区](http://code.google.com/p/protobuf/)谷歌广泛的跨语言格式和共享数据协议怎么样。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-21T18:24:41.410

```
def to_binary(self):
    struct_i_pack = struct.Struct('<I').pack
    struct_ii_pack = struct.Struct('<II').pack
    struct_h_pack = struct.Struct('<H').pack
    struct_ih_pack = struct.Struct('<IH').pack
    struct_ihi_pack = struct.Struct('<IHI').pack

    return ''.join([
        struct_i_pack(2),
        struct_ii_pack(*self.image.size),
        struct_i_pack(len(self.attributes)),
        ''.join([
            struct_ih_pack(a.id, a.type) if a.type else struct_ihi_pack(a.id, a.type, a.typeEx)
            for a in attributes
        ])
    ]) 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-21T17:58:25.813

您可以重构代码以将样板文件包装在一个类中。就像是：

```
def to_binary(self):
    'Return the binary representation as a string.'
    binary = BinaryWrapper()

    # Binary version number.
    binary.pack('<I', [2])

    # alternatively, you can pass an array
    stuff = [
        ('<II', *self.image.size),          # Image size.
        ('<I', len(self.attributes)),       # Attribute count
    ]
    binary.pack_all(stuff)

    return binary.get_packed() 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-05-21T19:12:22.687

最糟糕的问题是您需要 C++ 中的相应代码来读取输出。你能合理地安排让读写代码机械地衍生自或使用一个通用规范吗？如何做到这一点取决于您对 C++ 和 Python 的需求。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-05-21T20:05:05.137

你可以摆脱重复，同时仍然像这样容易阅读：

```
def to_binary(self):     
    output = struct.pack(
        '<IIII', 2, self.image.size[0], self.image.size[1], len(self.attributes)
    )
    return output + ''.join(
        struct.pack('<IHI', attribute.id, attribute.type, attribute.typeEx)
        for attribute in self.attributes
    ) 
```

# c++ - 将文件保存到网络

> ID：894163
> 
> 赞同：1
> 
> 时间：2009-05-21T17:42:41.383
> 
> 标签：c++, windows, file-io, createfile, writefile

我有一个大约 7 MB 的文件，可以在几秒钟内保存到我的本地共享中。但是，将该文件保存到网络位置需要*几分钟*。我想知道我能做些什么来加快这个速度。这是我目前的选择：

1.  **将数据保存到本地计算机上的临时文件中，然后将临时文件复制到网络路径**。我可能会这样做，因为这是最简单且最划算的。
2.  **使用`SetFilePointerEx()`和`SetEndOfFile()`**。根据这个问题的答案，我认为这可能很有用：[在 Windows 上创建大文件](https://stackoverflow.com/questions/455297/creating-big-file-on-windows)
3.  **缓冲区写入**。我可以自己缓存写入数据并在缓冲区已满时刷新，但这与操作系统已经完成的缓存不是多余的吗？

#1 似乎是最好的选择，但我想知道是否有人对加快保存到网络路径的更好方法有任何建议？

**编辑：**网络在千兆局域网上，所以速度应该不是问题。将文件复制到网络路径大约需要 1 秒。我只是注意到我们在较小的数据块上调用 WriteFile() ，然后我们可能应该这样做，因此优化更高级别的代码以编写更大的块可能会有所帮助，但速度差异仍然如此显着，这仍然是一个值得提出的问题.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-22T09:21:08.717

您将需要 aovid 读取-修改-写入操作。您通常希望写入至少 4KB 的块，可能是 2 的更高次方。原因是要附加一个字节，您通常需要读取文件的最后一个块，附加一个字节，然后写回新块. 通过（仅）写入 4KB 块，每次写入通常都会在文件末尾作为一个新块结束。

缓存在这里应该对您有所帮助，但缓存并不完美。以独占方式打开文件可能会有所帮助。如果您拒绝读取访问权限，操作系统可能会注意到刷新缓存对其他应用程序来说并不重要。

CopyFile 可以很快，因为它可以做的完全一样。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-21T17:49:41.650

> 我想知道是否有人对加快保存到网络路径的更好方法有任何建议？

也许你需要一个更好的网络。ISP 通常提供快速下载但缓慢上传。使用 FTP 等协议传输 7 MB 需要多长时间？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-21T17:47:52.043

您是否在慢速网络上运行？

Id 使用选项号 1 并将文件保存到后台的网络共享

# c# - 如何在 DataReader 上实现 Peek() 函数？

> ID：894165
> 
> 赞同：7
> 
> 时间：2009-05-21T17:42:51.040
> 
> 标签：c#, .net, ado.net

`Peek`ado.net 中的 DataReader 上似乎没有方法。我希望能够在遍历阅读器之前执行一些一次性处理，并且能够查看第一行中的数据而不会导致后续迭代跳过它会很好。实现这一目标的最佳方法是什么？

我正在使用 a `SqlDataReader`，但最好是实现尽可能通用（即适用于`IDataReader`or `DbDataReader`）。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-26T04:59:16.177

我会建议类似于 Jason 的解决方案，但使用实现 IDataReader 的包装器，所以：

```
sealed public class PeekDataReader : IDataReader
{
    private IDataReader wrappedReader;
    private bool wasPeeked;
    private bool lastResult;

    public PeekDataReader(IDataReader wrappedReader)
    {
        this.wrappedReader = wrappedReader;
    }

    public bool Peek()
    {
        // If the previous operation was a peek, do not move...
        if (this.wasPeeked)
            return this.lastResult;

        // This is the first peek for the current position, so read and tag
        bool result = Read();
        this.wasPeeked = true;
        return result;
    }

    public bool Read()
    {
        // If last operation was a peek, do not actually read
        if (this.wasPeeked)
        {
            this.wasPeeked = false;
            return this.lastResult;
        }

        // Remember the result for any subsequent peeks
        this.lastResult = this.wrappedReader.Read();
        return this.lastResult;
    }

    public bool NextResult()
    {
        this.wasPeeked = false;
        return this.wrappedReader.NextResult();
    }

    // Add pass-through operations for all other IDataReader methods
    // that simply call on 'this.wrappedReader'
} 
```

请注意，对于所有未受影响的属性，这确实需要相当多的直通代码，但好处是它是一个通用抽象，可以“窥视”结果集中的任何位置，而无需继续进行后续的“读取”手术。

要使用：

```
using (IDataReader reader = new PeekDataReader(/* actual reader */))
{
    if (reader.Peek())
    {
        // perform some operations on the first row if it exists...
    }

    while (reader.Read())
    {
        // re-use the first row, and then read the remainder...
    }
} 
```

请注意，如果前一个操作不是“Peek()”，则每个“Peek()”调用实际上都会移动到下一条记录。使用“Read()”操作保持这种对称性提供了更简单的实现和更优雅的 API。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-21T18:12:39.233

您可以创建一个状态机来跟踪窥视模式与常规模式。也许是这样的（可以将它们全部扔到一个名为 Peeker.cs 或类似的文件中）：

```
public sealed class Peeker
{
    internal readonly PeekMode PEEKING;
    internal readonly NormalMode NORMAL;

    private ReadState _state;

    public Peeker()
    {
        PEEKING = new PeekMode(this);
        NORMAL = new NormalMode(this);

        // Start with a normal mode
        _state = NORMAL;
    }

    public object[] OnRead(IDataReader dr, bool peek)
    {
        return _state.OnRead(dr, peek);
    }

    internal void SetState(ReadState state)
    {
        _state = state;
    }
}

internal abstract class ReadState
{
    protected Peeker _peeker;

    protected ReadState(Peeker p)
    {
        _peeker = p;
    }

    public abstract object[] OnRead(IDataReader dr, bool peek);        
}

internal class PeekMode : ReadState
{
    public PeekMode(Peeker p)
        : base(p)
    {
    }

    public override object[] OnRead(IDataReader dr, bool peek)
    {
        object[] datarow = new object[dr.FieldCount];

        if (peek)
        {                
            dr.GetValues(datarow);                
        }
        else
        {
            if (dr.Read())
            {
                dr.GetValues(datarow);
                _peeker.SetState(_peeker.NORMAL);
            }
        }

        return datarow;
    }
}

internal class NormalMode : ReadState
{
    public NormalMode(Peeker p)
        : base(p)
    {
    }

    public override object[] OnRead(IDataReader dr, bool peek)
    {
        object[] datarow = new object[dr.FieldCount];

        if (peek)
        {
            if (dr.Read())
            {
                dr.GetValues(datarow);
                _peeker.SetState(_peeker.PEEKING);
            }
        }
        else
        {
            if (dr.Read())
            {
                dr.GetValues(datarow);
            }
        }

        return datarow;
    }
} 
```

有点矫枉过正，但哦，好吧。

要使用它，您只需执行以下操作：

```
Peeker p = new Peeker();
.
.
.
SomeDataReaderType dr = SomeCommandType.ExecuteReader();
.
.
.
// To peek
object[] myDataRow = p.OnRead(dr, true);

// or not to peek
object[] myDataRow = p.OnRead(dr, false); 
```

然后对你的行做你需要做的事情。可能有比使用对象数组更好的方法，但你明白了。

祝你好运！

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-05-21T17:49:20.153

您不需要 Peek() 方法。您可以使用 Do While 循环完成您需要的工作。

所以而不是

```
while(dr.read())
{
  ... do stuff
} 
```

你会

```
dr.read();
... do stuff

do
{
  ... do stuff
}while(dr.read()) 
```

# c - 使用宏“高阶函数”生成器在 C 中进行函数式编程

> ID：894167
> 
> 赞同：33
> 
> 时间：2009-05-21T17:43:07.467
> 
> 标签：c, functional-programming, c-preprocessor

仔细注意，因为这是一个地狱般的问题;-)

我想在 C 中为通用集合操作（​​如搜索、foreach 等）使用模板函数，同时维护编译器静态类型检查。当您使用本例中的简单回调时，这相当简单：

```
#define MAKE_FOREACH(TYPE)\
void foreach_##TYPE (TYPE[n] array, int n, void(*f)(TYPE)) {\
  for(int i = 0; i < n; i++) {\
    f(array[i]);\
  }\
} 
```

因此您可以执行以下操作：

```
MAKE_FOREACH(int)
MAKE_FOREACH(float)

void intcallback(int x){
  printf("got %d\n", x);
}

void floatcallback(float x){
  printf("got %f\n", x);
}

int main(){
  int[5] iarray = {1,2,3,4,5};
  float[5] farray = {1.0,2.0,3.0,4.0,5.0};
  foreach_int(iarray, 5, intcallback);
  foreach_float(farray, 5, floatcallback);
} 
```

如果我想用返回类型实现回调，例如制作一个“map”函数，我可以这样做：

```
#define MAKE_MAP(TYPE, RTYPE)\
RTYPE* map_##TYPE (TYPE[n] array, int n, RTYPE(*f)(TYPE)) {\
  RTYPE* result = (RTYPE*)malloc(sizeof(RTYPE)*n);\
  for(int i = 0; i < n; i++) {\
    result[i]=f(array[i]);\
  }\
} 
```

到现在为止还挺好。现在问题来了，当我希望我的回调函数接受任意数量的类型化参数时。

这个想法是这样的：

```
#define MAKE_MAP(TYPE, RTYPE, ...)\
RTYPE* map_##TYPE (TYPE[n] array, int n, RTYPE(*f)(TYPE, __VA_ARGS__), __VA_ARGS__)
/*this would work for the declaration (because just the types would be enough)
but the  parameter names are missing :-s*/ \
{\
  RTYPE* result = (RTYPE*)malloc(sizeof(RTYPE)*n);\
  for(int i = 0; i < n; i++) {\
    result[i]=f(array[i], /*here the names of the parameters, in order*/);\
  }\
} 
```

因此，如您所见，我可以将 map 函数*声明*为：

```
MAKE_MAP(int, float, char) 
```

给予：

```
float* map_int(int[n] array, int n, float(*f)(int, char), char); 
```

但我不知道如何使用预处理器*实现*参数传递。我在这里寻求您的帮助、想法和建议。

（顺便说一句，不要告诉我使用可变参数函数作为模板并将 va_list 参数传递给回调，因为所有这些都是因为类型检查:-p）

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-05-21T18:04:21.090

如果您使用的是 Linux/BSD Unix，请查看[queue(3)](http://www.freebsd.org/cgi/man.cgi?query=queue)并检查`/usr/include/sys/queue.h`- 之前已经完成 :)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-22T04:13:26.290

*[最近的一个问题](https://stackoverflow.com/questions/890065/need-a-general-purpose-library-pure-c)*提出了很多无耻的预处理器滥用库。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2011-10-27T14:28:55.990

有关信息，GCC 4.6 的源代码为向量实现了类似的技巧。查看它的文件`gcc/vec.h`

# python - 使用 Python 通过代理以编程方式发出 HTTP 请求

> ID：894168
> 
> 赞同：4
> 
> 时间：2009-05-21T17:43:26.297
> 
> 标签：python, http, proxy

如何使用 Python 通过代理发出 HTTP 请求？

我需要对以下代码做什么？

```
urllib.urlopen('http://www.google.com') 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-21T17:44:42.877

该`urlopen`函数支持代理。尝试这样的事情：

```
urllib.urlopen(your_url, proxies = {"http" : "http://192.168.0.1:80"}) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-21T17:45:03.470

你可以看看[PycURL](http://pycurl.sourceforge.net/)。我在 PHP 中经常使用 cURL，我喜欢它。尽管目前在 Python 中可能有一种巧妙的方法可以做到这一点。

# vb.net - 为什么这会导致内存泄漏？

> ID：894175
> 
> 赞同：0
> 
> 时间：2009-05-21T17:45:28.697
> 
> 标签：vb.net, visual-studio, memory-leaks, visual-studio-2003

这是有趣的。我们花了最后一天尝试使用以下（遗留）代码修补问题，该代码继续增加其进程大小。这是在 Visual Studio 2003 中完成的。

我们有一个显示图像（来自 MemoryStream）、一些文本和一个按钮的表单。没有什么花哨。看起来像这样：

```
 Protected Overrides Sub OnLoad(ByVal e As System.EventArgs)
    MyBase.OnLoad(e)
    Try
      m_lblWarning.Visible = False

      m_grpTitle.Text = m_StationInterface.ProcessToolTitle
      m_lblMessage.Text = m_StationInterface.ProcessToolMessage

      Dim objImage As MemoryStream
      Dim objwebClient As WebClient
      Dim sURL As String = Trim(m_StationInterface.ProcessToolPicLocation)

      objwebClient = New WebClient

      objImage = New MemoryStream(objwebClient.DownloadData(sURL))
      m_imgLiftingEye.Image = Image.FromStream(objImage)

      m_txtAcknowledge.Focus()
    Catch ex As Exception
      '*** This handles a picture that cannot be found without erroring'
      m_lblWarning.Visible = True
    End Try
  End Sub 
```

此表单经常关闭和打开。每次重新打开时，进程内存使用量大约增加 5mb。当表单关闭时，它不会回退到以前的用法。资源仍然分配给未引用的表单。表单呈现如下：

```
 m_CJ5Form_PTOperatorAcknowlegement = New CJ5Form_PTOperatorAcknowlegement
      m_CJ5Form_PTOperatorAcknowlegement.stationInterface = m_StationInterface
      m_CJ5Form_PTOperatorAcknowlegement.Dock = DockStyle.Fill
      Me.Text = " Acknowledge Quality Alert"

      '*** Set the size of the form'
      Me.Location = New Point(30, 30)
      Me.Size = New Size(800, 700)

      Me.Controls.Add(m_CJ5Form_PTOperatorAcknowlegement) 
```

该控件稍后在关闭后从表单中删除：

```
Me.Controls.Clear() 
```

现在。我们已经尝试了很多东西。我们发现 Disposing 什么都不做，事实上，[IDisposable](http://msdn.microsoft.com/en-us/library/system.idisposable.aspx)接口实际上并没有触及内存。如果我们不每次都创建一个新的 CJ5Form_PTOperatorAcknowledgement 表单，则进程大小不会增长。但是将新图像加载到该表单中仍然会导致进程大小不断增长。

任何建议，将不胜感激。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-21T17:57:31.493

您必须处置您的 WebClient 对象和任何其他可能不再需要的托管非托管资源。

```
 objImage = New MemoryStream(objwebClient.DownloadData(sURL))
objwebClient.Dispose() ' add call to dispose 
```

一种更好的编码方法是使用“使用”语句：

```
 using objwebClient as WebClient = New WebClient      
objImage = New MemoryStream(objwebClient.DownloadData(sURL))      
end using 
```

有关更多信息，请在 google 和 stackoverflow 上搜索“Dispose”和“IDisposable”模式实现。

最后一个提示：尽可能不要使用内存流。除非您需要将其保存在 RAM 中，否则直接从文件加载图像。

**编辑**

如果我正确理解您的代码，也许这样的事情会起作用：

```
 Dim objImage As MemoryStream      
Dim objwebClient As WebClient      
Dim sURL As String = Trim(m_StationInterface.ProcessToolPicLocation)      
using objwebClient as WebClient = New WebClient      
  using objImage as MemoryStream = New MemoryStream(objwebClient.DownloadData(sURL))      
    m_imgLiftingEye.Image = Image.FromStream(objImage)
  end using
end using 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-21T17:52:06.077

我不知道具体为什么会泄漏，但我可以建议您查看使用[.NET Memory Profiler](http://memprofiler.com/)。如果你使用它来运行你的应用程序，它会让你很好地了解哪些对象没有被释放，并帮助你解决原因。它有免费试用版，但值得购买。

# .net - 在gridview的单元格内添加一个空间

> ID：894176
> 
> 赞同：2
> 
> 时间：2009-05-21T17:45:52.157
> 
> 标签：.net, asp.net, vb.net, gridview

我有一个gridview，我以编程方式向这个网格添加了一些按钮。我在彼此旁边有一个编辑和删除按钮，我只是想以编程方式在它们之间放置一个空格。知道怎么做吗？这是添加按钮的代码。

```
For i As Integer = 0 To GridView1.Rows.Count - 1
            btnedit.ImageUrl = "\images\bttnEditMini.gif"
            btndelete.ToolTip = "Deletes the Current Record"
            btnedit.ToolTip = "Edits the Current Record"
            btndelete.ImageUrl = "\images\bttnDeleteMini.gif"
            GridView1.Rows(i).Cells(2).Controls.Add(btnview)
            GridView1.Rows(i).Cells(4).Controls.Add(btnedit)
            GridView1.Rows(i).Cells(4).Controls.Add(btndelete)
        Next 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-05-21T17:48:33.650

尝试这个：

```
For i As Integer = 0 To GridView1.Rows.Count - 1
    btnedit.ImageUrl = "\images\bttnEditMini.gif"
    btndelete.ToolTip = "Deletes the Current Record"
    btnedit.ToolTip = "Edits the Current Record"
    btndelete.ImageUrl = "\images\bttnDeleteMini.gif"
    GridView1.Rows(i).Cells(2).Controls.Add(btnview)
    GridView1.Rows(i).Cells(4).Controls.Add(btnedit)
    GridView1.Rows(i).Cells(4).Controls.Add(new LiteralControl("&nbsp;"))
    GridView1.Rows(i).Cells(4).Controls.Add(btndelete)
Next 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-21T17:49:32.477

在编辑和删除按钮之间添加一个文字控件（控件的文本应该是

```
" " [Empty Space] 
```

或者

```
"&nbsp;" 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-21T17:50:45.970

我建议为您的按钮创建一个简单的 CssClass，将右边距和/或左边距设置为所需的间隙。这样，您可以即时添加多个按钮，而不必担心插入带有空格或透明 gif 文件的“垫片”。如果您需要更改，它还可以让您轻松修改沿途的差距。

# c++ - 为什么我会随机收到段错误？

> ID：894177
> 
> 赞同：3
> 
> 时间：2009-05-21T17:46:32.763
> 
> 标签：c++, stl, segmentation-fault

这对我来说很奇怪，但是当我启动我的程序时，我遇到了一个意想不到的随机分段错误。有时它有效，有时它崩溃.. Dev-C++ 的调试器将我指向文件的一行：stl_construct.h

```
/**
   * @if maint
   * Constructs an object in existing memory by invoking an allocated
   * object's constructor with an initializer.
   * @endif
   */
  template<typename _T1, typename _T2>
    inline void
    _Construct(_T1* __p, const _T2& __value)
    {
      // _GLIBCXX_RESOLVE_LIB_DEFECTS
      // 402\. wrong new expression in [some_]allocator::construct
     -> ::new(static_cast<void*>(__p)) _T1(__value);
    } 
```

顺便说一句，我正在广泛使用 STL。我应该怎么做才能检测到段错误的起源？有什么工具可以提供帮助吗？可能导致这样的随机崩溃的原因是什么。

### 编辑：

我的程序大约有 5000 行代码。我不知道我必须显示什么代码才能获得帮助，因为我不知道问题的根源，我从调试器得到的只是它与 STL 有关。

### 编辑：

我搬到了`Code::Blocks`现在，这里是调用堆栈：

```
#0 00464635 std::_Construct<std::pair<double const, int>, std::pair<double const, int> >(__p=0xb543e8, __value=@0x10) (C:/Program Files/CodeBlocks/MinGW/bin/../lib/gcc/mingw32/3.4.5/../../../../include/c++/3.4.5/bits/stl_construct.h:81)
#1 00462306 std::_Rb_tree<double, std::pair<double const, int>, std::_Select1st<std::pair<double const, int> >, std::less<double>, std::allocator<std::pair<double const, int> > >::_M_create_node(this=0x406fe50, __x=@0x10) (C:/Program Files/CodeBlocks/MinGW/bin/../lib/gcc/mingw32/3.4.5/../../../../include/c++/3.4.5/bits/stl_tree.h:367)
#2 00461DA7 std::_Rb_tree<double, std::pair<double const, int>, std::_Select1st<std::pair<double const, int> >, std::less<double>, std::allocator<std::pair<double const, int> > >::_M_clone_node(this=0x406fe50, __x=0x0) (C:/Program Files/CodeBlocks/MinGW/bin/../lib/gcc/mingw32/3.4.5/../../../../include/c++/3.4.5/bits/stl_tree.h:379)
#3 004625C6 std::_Rb_tree<double, std::pair<double const, int>, std::_Select1st<std::pair<double const, int> >, std::less<double>, std::allocator<std::pair<double const, int> > >::_M_copy(this=0x406fe50, __x=0x0, __p=0x406fe54) (C:/Program Files/CodeBlocks/MinGW/bin/../lib/gcc/mingw32/3.4.5/../../../../include/c++/3.4.5/bits/stl_tree.h:1029)
#4 00462A9D std::_Rb_tree<double, std::pair<double const, int>, std::_Select1st<std::pair<double const, int> >, std::less<double>, std::allocator<std::pair<double const, int> > >::_Rb_tree(this=0x406fe50, __x=@0xb59a7c) (C:/Program Files/CodeBlocks/MinGW/bin/../lib/gcc/mingw32/3.4.5/../../../../include/c++/3.4.5/bits/stl_tree.h:559)
#5 0045A928 std::map<double, int, std::less<double>, std::allocator<std::pair<double const, int> > >::map(this=0x406fe50, __x=@0xb59a7c) (C:/Program Files/CodeBlocks/MinGW/bin/../lib/gcc/mingw32/3.4.5/../../../../include/c++/3.4.5/bits/stl_map.h:166)
#6 0040B7E2 VehicleManager::get_vehicles_distances(this=0xb59a50) (C:/Program Files/CodeBlocks/MinGW/projects/AHS/VehicleManager.cpp:232)
#7 00407BDA Supervisor::IsMergeInstruction(id_vehicle=1) (C:/Program Files/CodeBlocks/MinGW/projects/AHS/Supervisor.cpp:77)
#8 00408430 CheckingInstructionsThread(arg=0x476100) (C:/Program Files/CodeBlocks/MinGW/projects/AHS/Supervisor.cpp:264)
#9 00413950 _glfwNewThread@4() (??:??)
#10 75A24911    KERNEL32!AcquireSRWLockExclusive() (C:\Windows\system32\kernel32.dll:??)
#11 00476100    std::__ioinit() (??:??)
#12 0406FFD4    ??() (??:??)
#13 76E5E4B6    ntdll!RtlInitializeNtUserPfn() (C:\Windows\system32\ntdll.dll:??)
#14 00476100    std::__ioinit() (??:??)
#15 70266582    ??() (??:??)
#16 00000000    ??() (??:??) 
```

更多精度：

1/ 这是一个多线程应用程序。2/ 方法：get_vehicles_distances(); 返回地图。3/ 地图可能在 IsMergeInstruction() 调用时尚未初始化；

### 编辑：

显然导致段错误的行是：

```
vehicles_distances_.erase(vehicles_distances_.begin(), vehicles_distances_.end()); 
```

Vehicles_distances_ 是地图。此行是方法的一部分： VehicleManager::MoveAllVehicles();

```
void VehicleManager::MoveAllVehicles() {

     vehicles_distances_.erase(vehicles_distances_.begin(), vehicles_distances_.end());

     vector<Vehicle>::iterator iter_end = VehicleManager::vehicles_.end();
     for(vector<Vehicle>::iterator iter = VehicleManager::vehicles_.begin();
     iter != iter_end; ++iter) {

          (*iter).MoveVehicle();

          vehicles_distances_[(*iter).get_vec_vehicle_position().y] = (*iter).get_id_vehicle();

     }

} 
```

那有什么问题？

### 编辑：

我尝试使用 map::clear(); 作为 map::erase() 的替代品；但同样的问题发生了！

### 编辑：

我想我明白了...一个线程正试图在清除车辆时使用车辆距离..（？）

### 编辑：

问题解决了！所以它来自 map::erase(); 正如预期的那样。我通过创建另一个映射变量来绕过该问题，其中该对`<key, value>`被反转，因此我可以更新地图。（因为我需要的关键是距离，并且距离不是唯一的，因为它每次都在变化，但 id_vehicle 是唯一的！）。最后我只是拿了那张地图，`<key, value>`再次反转并将其转移到可以在每个循环中重新声明的原始地图......

感谢大家 ！

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-05-21T17:56:42.340

首先，为了所有可爱的事物，**不要使用 Dev-C++**。我希望我知道人们是如何不断撞上那块垃圾的。*它已经很多年*没有维护了，即使它被维护了，它仍然是一个缺乏基本功能的有缺陷的垃圾。放弃它，选择无数更好的免费替代品之一。

现在，关于您的问题：您的程序会随机出现段错误，因为您之前做了一些非法的事情。不要那样做。;)

如果您的程序在某处写入越界，则任何事情都可能发生。它可能会碰到一个未分配的页面，在这种情况下你会得到一个段错误。或者它可能会在分配给您的进程的页面上遇到未使用的数据，在这种情况下它不会产生任何实际效果（除非它在之后正确初始化，覆盖您的第一个非法写入，然后您尝试从中读取, 期望原始（无效）值仍然存在。或者它可能会命中实际正在使用的数据，在这种情况下，当程序尝试读取该数据时，您稍后会遇到错误。

读取数据时存在几乎相同的场景。您可能很幸运并立即得到一个段错误，或者您可以访问未使用和未初始化的内存，并读取垃圾数据（这很可能会在以后使用该数据时导致错误），或者您可以从内存地址读取已经在使用（这也会给你垃圾）。

所以是的，这些错误很难找到。我能给出的最好建议是 1）在你的代码中撒上断言，以确保维护基本的不变量，以及 2）逐步执行程序，并且在每一步，验证你没有读取或写入不'的地址' t 属于你。

MSVC 默认启用了一个安全 SCL 选项，它将对 STL 代码执行边界检查，这有助于发现此类错误。

我相信 GCC 可以选择执行类似的操作（但默认情况下未启用）。

段错误是讨厌的。一旦人们多次被这样的错误所困扰，他们往往会变得更加自律，避免越界访问内存。:)

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-05-21T17:50:39.073

您可以尝试使用[Valgrind](http://valgrind.org/)来帮助找到问题。鉴于您在问题中提出的行，我不得不猜测您已经损坏了堆，或者您有堆栈问题。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-05-21T17:51:35.970

显而易见的问题是“_p 是什么”。在调试器中，您应该能够查看调用堆栈。跟随 _p 回到它的原点。确认它的大小正确，它没有被删除，并且它确实存在。

如果这并不容易，总是有一些蛮力的方法来注释掉随机（可疑的）代码，直到它工作或返回并与已知的工作副本进行比较。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-05-21T17:51:11.430

这是非常模糊的，所以几乎不可能回答。一个明显的建议是检查您是否正在初始化所有变量。一些编译器会在调试中清零你未初始化的东西，而不是在发布时这样做，这会导致随机和意外的结果。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-05-21T17:58:28.513

您可以[`_CrtSetDbgFlag()`](http://msdn.microsoft.com/en-us/library/5at7yxcs(VS.71).aspx)在程序的开头使用来启用一些堆调试选项。另请参见[CRT 调试堆](http://msdn.microsoft.com/en-us/library/974tc9t1(VS.80).aspx)。这可以帮助您追踪您在哪里做坏事的记忆。它在 Microsoft 的 C 运行时中可用，MinGW 编译器默认链接到它。如果您改用 GNU 的 C 运行时，那么您将无法走这条路。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-05-21T17:59:22.707

与 stl_construct.h 相比，问题更可能出在您的代码中。我假设该文件是 Dev-C++ 的 STL 发行版的一部分。分段错误可能发生在使用 stl_construct.h 中的模板实例化的代码中，但问题的根本原因将在其他地方。我会尝试通过在崩溃时获取堆栈跟踪来解决这个问题。对于堆栈跟踪中的每个函数（尤其是新编写的函数），尝试检查代码并查找以下类型的可能错误：

*   未初始化的变量（尤其是用于数组访问的索引）
*   释放或删除后使用的内存。
*   数组边界外的数组访问
*   未检查 NULL 就使用的内存分配（如果使用 new 则不是问题，因为它不返回 NULL，它会引发异常）

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-05-22T04:12:22.640

您的描述和调用堆栈表明程序在静态变量初始化期间崩溃。这是 C++ 的一个常见缺陷：没有简单的方法来控制静态变量的初始化顺序。

例如，您的程序可能有`foo`依赖于 object 的对象`bar`；但可能是程序在构造`foo`之前调用了构造函数`bar`。那会很糟糕，并且可能会导致您描述的那种问题。（是`CheckingInstructionsThread`产生线程的静态变量吗？这可能就是问题所在。）

要解决此问题，您可能需要查看程序的 .cpp 文件中的静态变量（包括类静态变量和全局变量），尤其是某些类类型的变量。修改构造函数以将一些跟踪写入 stderr 可能有帮助，也可能没有帮助；使用`fprintf`而不是`cerr`如果你这样做。

**编辑**：如果您不确定它是否与静态有关，请尝试在开头添加这样的一行`main()`：

```
 fprintf(stderr, "main() entered\n"); 
```

这并不排除静态初始化是问题的原因；即使它之前没有**崩溃**`main()`，您仍然可能会错误地设置数据结构。但是，如果您从未使用过 fprintf，那么您就会**知道**静态初始化是原因所在。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-05-22T00:01:29.840

当您最终获得经过彻底测试的代码而不是您的代码时，您必须做的第一件事就是向上调用堆栈，直到您最终获得自己的代码，在那里您将找到导致此问题发生的信息。

在调用堆栈中，最重要的位置是查看您的代码（调用者）和传递给您调用的函数（被调用者）的参数。

如果没有这些信息，我们将无法为您提供更多帮助。;-)

有关分段错误的更多信息：[http](http://en.wikipedia.org/wiki/Segmentation_fault)
://en.wikipedia.org/wiki/Segmentation_fault （必读，另请参阅“另见”和“外部链接”中的链接）

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-05-21T17:53:32.813

使用核心文件运行调试器后，堆栈跟踪会告诉您什么？以正常方式运行 gdb gdb a.out

然后检查核心文件

> 核心 a.out.core

看看堆栈

> BT

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2009-05-21T17:57:07.783

这很可能与无效的迭代器有关 - 搜索您迭代容器的位置和/或将迭代器保留在容器中并同时删除/插入元素。
正如其他人所指出的 - 使用调用堆栈来找到确切的位置。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2009-05-21T23:39:32.210

它看起来像一个危险的功能:)

不过有一件事让我印象深刻。分配的内存去哪儿了？直观地说，我希望有一个指向指针的指针作为第一个参数，然后取消引用它。像这样：

```
template<typename _T1, typename _T2>
    inline void
    _Construct(_T1** __p, const _T2& __value)
    {

       ::new(static_cast<void*>(*__p)) _T1(__value);
    } 
```

或者，对指针的引用：

```
template<typename _T1, typename _T2>
    inline void
    _Construct(_T1*& __p, const _T2& __value)
    {

       ::new(static_cast<void*>(__p)) _T1(__value);
    } 
```

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2009-05-22T03:51:13.240

地图不是很友好的线程。如果您在线程代码中执行映射操作，您确实需要锁定对该映射的所有访问，并意识到您可能持有的任何迭代器都可能无效。

* * *

## 回答 #13

> 赞同：-1
> 
> 时间：2009-05-21T17:51:32.427

调试器应该让您向上调用堆栈。这样，您应该能够在自己的代码中看到导致段错误的位置。

# sql - 匹配行而不过滤 (SQL)

> ID：894182
> 
> 赞同：2
> 
> 时间：2009-05-21T17:48:27.723
> 
> 标签：sql, mysql

我有一些产品属性的表格：

```
table properties(
  prop_id int,
  product_id int
) 
```

我的问题是：是否可以选择匹配的属性而不从结果中过滤它们？例如：

```
select property_id from properties WHERE property_id IN(1,3,5); 
```

您只会得到匹配 1,3,5 的行。我需要所有行，但需要哪些行符合我的条件的信息。我不想使用'UNION'。

感谢帮助。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-21T17:51:47.420

我没有使用 mySQL 的经验，但假设它支持一个`case`语句（或类似的东西），你可以这样做：

```
select
    prop_id,
    product_id,
    (case when prop_id in (1, 3, 5) then 1 else 0 end) as matches_criteria

from properties 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-21T17:52:45.203

您可以使用 case 语句：

```
SELECT 
  prop_id, 
  product_id, 
  (CASE 
    WHEN property_id IN(1,3,5) THEN 1 
    ELSE 0 
  END)
FROM  properties; 
```

[http://dev.mysql.com/doc/refman/5.0/en/case-statement.html](http://dev.mysql.com/doc/refman/5.0/en/case-statement.html)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-21T17:51:38.167

左外连接

```
select
    parent.name
        ,child.name
    from parent
        left outer join child on parent.familyid=child.familyid 
```

将列出所有父母，无论他们是否有孩子

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-21T17:52:17.620

```
SELECT
    IF (property_id IN (1, 3, 5), 1, 0) AS matched
FROM
    properties; 
```

# internet-explorer - 在 IE 中导致输入闪烁的动画 gif

> ID：894192
> 
> 赞同：0
> 
> 时间：2009-05-21T17:49:38.813
> 
> 标签：internet-explorer, gif, animated

当页面上有动画 gif 时，输入中的光标会随着 IE7 闪烁。

拿走 gif，问题就消失了。

编辑（再次）：我真正需要的是知道一个奇怪错误的答案的人。

我是一名 10 年经验丰富的网络应用程序开发人员。相信我，我知道如何调试——例如，知道动画 gif 是屏幕绘制的原因是成功调试的结果。解决这个问题是另一回事。

编辑（再次，再次），使用我的 gif 和下面答案三中的代码。

```
<html>
    <head>
        <style type="text/css">
            #img {
                position: absolute;
            }
            #dv {
                background-color: transparent;
                border: 1px solid Black;
                height: 450px;
                position: absolute;
                width: 600px;
            }
            #frm {
                left: 170px;
                position: absolute;
                top: 100px;
            }
        </style>
    </head>
    <body>
        <img src="http://www.johnherr.net/skeleton.gif" id="img">
        <div id="dv">
        </div>
        <form id="frm">
            <input type="text">
        </form>
    </body>
</html> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-21T19:56:14.703

> 可以说我们有一个绝对定位的动画 gif。它约为 600 x 400。它位于另一个腹肌下方。提供透明层的定位 div。最后，表格本身是绝对的。定位在那之上。

```
<style type="text/css">
#img {
    position: absolute;
}
#dv {
    background-color: transparent;
    border: 1px solid Black;
    height: 450px;
    position: absolute;
    width: 600px;
}
#frm {
    left: 170px;
    position: absolute;
    top: 100px;
}
</style>
<img src="http://vulcan.wr.usgs.gov/Imgs/Video/MSH/MSH06/MSH06_MOVIE_before_after_from_brutus_10-21_and_10-22-06_animated.gif" id="img">
<div id="dv">
</div>
<form id="frm">
<input type="text">
</form> 
```

我试图尽可能地复制你所描述的内容。我将上述内容加载到 IE 6、7 和 8 中，但看不到任何闪烁的光标问题。

鉴于我可以提出一个不存在该问题的实现，IE 7 中似乎没有任何一般*的动画GIF 原因输入光标闪烁*错误，并且您的特定标记和 CSS 中的某些内容正在暴露那个浏览器的问题。

> 拿走 gif，问题就消失了。
> 
> 知道动画 gif 是屏幕绘制的原因是成功调试的结果。

当然，添加动画 gif 是导致您所看到的拼图的最后一块。但正如我所展示的，您可以在绝对定位的动画 gif 上使用绝对定位的表单，它们之间有一个透明的 div，并且光标不会闪烁。

我认为你将不得不一次一层地剥离你正在做的事情，直到你可以明确地确定你的标记或 CSS 中暴露问题的地方。

还有另一种可能性，您看到的闪烁可能是您的视频卡和/或视频驱动程序的产物。您可能想尝试在具有完全不同硬件的机器上查看 IE 7 下的页面以排除这种可能性。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-21T18:02:05.697

也许是您的 CPU 无法处理负载？这尤其可能是在运行密集 javascript 的网站上的旧机器上引起的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-28T09:45:30.697

我遇到过同样的问题。删除动画 gif 和闪烁停止。

查看 CSS，我注意到图像正在调整大小以进行显示。

我使用在线编辑器创建了所需大小的图像副本。

将动画 gif 切换到不需要调整大小的版本解决了这个问题。

# .net - Windows 窗体：如何在文本框上显示粗闪烁光标？

> ID：894196
> 
> 赞同：0
> 
> 时间：2009-05-21T17:50:44.550
> 
> 标签：.net, winforms, textbox

我正在重写一个 Windows 窗体应用程序（更新框架、重写逻辑等），但有一件事我只是无法弄清楚它们是如何做到的。原始应用程序中的文本框有一个粗大的闪烁光标，如下所示：[http ://screencast.com/t/8QYUcjuh3n](http://screencast.com/t/8QYUcjuh3n)

对于我的生活，我无法弄清楚如何做到这一点。请帮忙？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-21T18:18:54.820

您可以使用 pinvoke [CreateCaret来完成](http://www.pinvoke.net/default.aspx/user32/CreateCaret.html)

该示例使用带有按钮 (button1) 和文本框 (textBox1) 的 Winform。

添加这个 using 指令：

```
using System.Runtime.InteropServices; 
```

添加这些声明：

```
[DllImport("user32.dll")]
static extern bool CreateCaret(IntPtr hWnd, IntPtr hBitmap, int nWidth, int nHeight);
[DllImport("user32.dll")]
static extern bool ShowCaret(IntPtr hWnd); 
```

将此代码添加到按钮单击事件：

```
 // Thickness is set where I have 10.
  CreateCaret(textBox1.Handle, IntPtr.Zero, 10, textBox1.Height);
  ShowCaret(textBox1.Handle); 
```

当你点击按钮时，你会得到一个更粗的光标。

[这里](https://stackoverflow.com/questions/609927/custom-caret-for-winforms-textbox)也有关于这个的讨论。

# javascript - 使用 jQuery 对 XML 节点进行排序，然后加入它们

> ID：894198
> 
> 赞同：1
> 
> 时间：2009-05-21T17:51:02.897
> 
> 标签：javascript, jquery, sorting

这是架构的基础知识......还有更多，但这很好地了解了我需要完成的工作：

```
<item>
    <name>This is some product name to sort with dictionary sort.</name>
    <price value="29.99">$29.99</price>
</item>
<item>
    <name>This is some product name to sort with dictionary sort.</name>
    <price value="29.99">$29.99</price>
</item> 
```

这是一个肮脏的方法：

```
var node = null;
var path = null;
var items = jQuery( "item", xml );
var itemsTmp = new Array();
var itemsSorted = [];

for ( i = 0; i < items.length; i++ ) {

    // price
    itemsTmp[i] = jQuery( "price", items[i] ).attr( "value" );

}

itemsTmp.sort(function(a,b){return a-b});

for ( i=0;i<itemsTmp.length;i++ ) {

    itemsSorted[ i ] = jQuery( "price[value=" + itemsTmp[ i ] + "]", items ).parent();

} 
```

问题是 itemsSorted 现在是一个 jQuery 对象数组。我需要将所有项目节点重新组合在一起，但已排序，以便稍后我可以执行以下操作：

```
jQuery( "item", xml ).each(function() {
    alert( jQuery( "price", this ).text() );
}); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-22T10:07:15.333

添加到 itemsSorted 数组时，您可以使用 ...parent().get(0); 将节点添加到数组而不是 jQuery 对象。

然后在最后一次迭代之后：

```
jQuery("item", xml).remove();
jQuery.each(itemsSorted, function() {
    jQuery(xml).append(this);
}); 
```

此外，您应该知道您尚未在 for 循环中定义变量“i”。这使它成为一个全局变量，并可能导致许多奇怪的行为。我更喜欢使用 jQuery.each，因为这也为您提供了 for 循环内的本地范围 :)

# web-services - 编写脚本/程序以持续登录和检查更新的正确工具/技能是什么？

> ID：894201
> 
> 赞同：1
> 
> 时间：2009-05-21T17:51:20.540
> 
> 标签：web-services, scripting

如果这是可能的...

您必须使用/学习什么才能编写一些东西来持续检查（每 20 分钟）页面是否已更新？这将涉及登录系统和浏览网站。举个例子，我希望我过去有一个脚本，可以登录我学校的网站并检查更新的成绩。

感谢所有建议:)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-06-05T08:09:42.647

This is basically a shell script based solution for a Unix or Windows with Cygwin system.

To fetch the page of interest,

```
wget -N <URI> 
```

Do this once from the command line and get the file. Open the file in some editor and check for your pattern of interest. You can then use grep, sed, awk, or even perl to filter out things of interest.

You could then write this all into a shell script and either loop it with a sleep or plug it into a cron job.

You would basically need to learn some sed, [awk](http://www.vectorsite.net/tsawk.html), [grep](http://www.panix.com/~elflord/unix/grep.html) for this. But, that should be quick for the purpose at hand and what you learn would be usable in future for other such needs. You could also dive into perl or python -- but i will not suggest a start from scratch on that for what you need here.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-21T23:12:43.340

考虑[Selenium](http://seleniumhq.org/)，特别是 Firefox 的[Selenium IDE](http://seleniumhq.org/projects/ide/)；它通常用于测试，但它允许您在浏览器中记录和回放脚本——然后将它们编辑为 HTML 和 JavaScript。一旦成绩与其“预期”值不同，您就可以插入一个停止脚本的测试。

所需技能组合：

*   HTML
*   火狐插件
*   JavaScript（和 DOM）
*   硒

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-21T17:53:52.220

它会涉及诸如更改窗口焦点、鼠标移动等的事情吗？

如果是这样，看看[autoit](http://www.autoitscript.com/autoit3/)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-21T17:54:07.897

我个人会使用 Perl。但是，我想有许多脚本语言可以做到这一点。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-21T17:54:55.073

这听起来像是你想把一些快速而肮脏的东西拼凑在一起，使用你所知道的，大多数语言都有一个库。你不需要学习新东西！

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-21T17:59:41.287

或者，如果您只是想在页面更改时收到通知，您可以使用一些现有的服务，例如：

[观看该页面](http://www.watchthatpage.com)

# permissions - 不确定运行 Ruby 脚本的正确权限

> ID：894206
> 
> 赞同：0
> 
> 时间：2009-05-21T17:51:38.263
> 
> 标签：permissions, chmod

运行 Ruby 脚本时收到以下警报

```
warning: Insecure world writable dir /Users/cs/Documents in PATH, mode 040777 
```

解决方案是更改权限。但是，我不确定哪一个是合适的。

我将许多用户帐户用于不同的目的。我有一个主帐户，我通过它在我的 cs -account 上运行命令。

**您将为 cs 帐户授予哪些权限？**

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-21T17:58:01.760

只是运行`chmod og-w /Users/cs/Documents`，一切都应该很好。

这将删除“其他”和“组”写访问权限。

# .net - WebReference 甚至在库程序集项目中创建 App.config

> ID：894215
> 
> 赞同：2
> 
> 时间：2009-05-21T17:53:35.200
> 
> 标签：.net, web-services, configuration

为什么向库程序集项目添加 Web 引用会为项目创建 app.config 文件？它不会在运行时使用，对吧？- 因为每个主机进程只能有一个根配置文件（可执行文件）， - 这就是为什么只有可执行文件才能将其 app.configs 重命名为“projectName.exe.config”并在编译过程中部署到输出文件夹。

无论如何，其中唯一的东西是一个 applicationSettings 部分，其中有一个配置设置，其中包含指向 Web 服务的 url，通常无论如何都会由 ops 使用单独的配置设置动态设置...

另外，如果一个宿主进程有几个带有 Web 引用的依赖库程序集，那有什么意义呢？将使用许多设置中的哪一个（每个依赖库程序集一个）？

无论如何，我想摆脱这些app.configs，以避免配置系统在运行时找不到设置时出现异常，但是因为我不清楚它为什么首先存在......我错过了什么?

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-21T18:34:42.963

将 Web 引用标记为**静态**（右键单击引用 -> 属性 -> URL 行为）。然后 url 将存储在 reference.cs 文件而不是 .config 文件中。

当具有自己的 app.config 的程序集加载到具有单独 .config 文件的应用程序中时，我相信它合并 .config 文件的方式与 machine.config 与 web.config 合并的方式非常相似（我虽然在这一点上可能是错误的）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-21T18:34:02.497

您已经回答了您的问题 - 添加了 app.config 是因为 Web 引用需要将服务的 URL 存储在某处。最好将其存储在配置文件中，而不是硬编码到您的 *.cs 文件中，不是吗？

如果您有所有从主应用程序使用的依赖程序集，则仅使用主应用程序的 app.config（重命名为 mainapp.exe.config） - 依赖程序集将使用主应用程序的配置文件。通过添加 Web 引用创建的 app.config 仅作为您可以检查需要进入主 app.config 的设置的地方存在。

如果您有一个单独的位置来配置所有 Web 服务 URL（例如数据库表或其他东西），您可以扔掉生成的 app.config 的 - 那里没问题。

马克

# c++ - C++ 析构函数问题

> ID：894222
> 
> 赞同：4
> 
> 时间：2009-05-21T17:55:25.540
> 
> 标签：c++, destructor

关于下面的示例代码，为什么基类的析构函数被调用了两次？

```
class Base {
public:
    Base() {
        std::cout << "Base::Base()" << std::endl;
    }

    ~Base() {
        std::cout << "Base::~Base()" << std::endl;
    }
};

class Derived : public Base {
public:
    Derived() {
        std::cout << "Derived::Derived()" << std::endl;
    }

    ~Derived() {
        std::cout << "Derived::~Derived()" << std::endl;
    }
};

int main() {
    Base a = Derived();
    return EXIT_SUCCESS;
} 
```

以下是程序运行时的输出示例：

```
Base::Base()
Derived::Derived()
Derived::~Derived()
Base::~Base()
Base::~Base() 
```

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2009-05-21T18:04:33.790

发生的事情称为切片。你用 type 的对象初始化一个 type`Base`的对象`Derived`。由于任何类型`Derived`的对象也`Base`包含一个类型的对象（称为“基类子对象”），因此在整个程序中将存在两个`Base`对象和一个对象。`Derived`Derived 对象（及其类型的基类子对象`Base`）仅在初始化时存在，而其余`Base`对象存在到 结束`main`。

由于有两个 Base 对象和一个 Derived 对象，您还将看到另外一个 Base 析构函数运行。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-05-21T18:04:21.870

正在使用复制构造函数。如果你想看看发生了什么，也可以检测复制构造函数：

```
 Base( const Base & ) {
        std::cout << "Base::Base( const Base &)" << std::endl;
    } 
```

Derived 也是如此。

请注意，这与析构函数不是虚拟的无关。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-05-21T18:00:22.753

当您在其中说`Derived()`时，`main()`它会创建一个临时对象，然后将其复制到对象 a 中。因此有两个对象，因为析构函数被调用了两次。此外，正如其他人指出的那样，您的基类析构函数应该是虚拟的。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-05-21T18:06:17.017

`Derived`因为您在使用它进行复制构造之前创建了一个临时类型`a`。所以这基本上是发生了什么：

```
Derived d(); // Your temporary of type Derived is created
Base a(d); // The temporary is used to call a's copy constructor 
d.Derived::~Derived(); // The temporary is destroyed, calling both ~Derived and ~Base
a.Base::~Base(); // The nonvirtual destructor on a is called, so ~Base is called, but not ~Derived 
```

因此，除了开始时不必要的复制（编译器可能会优化掉）之外，实际的*错误*是 ~Base 不是虚拟的。

**编辑** 糟糕，完全错过了 litb 指出的切片。改为阅读他的答案:)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-21T18:14:46.607

添加以下内容将使程序更清晰：

```
 Base(const Base& base){
        std::cout << "Base::Base(const Base& base)" << std::endl;
 } 
```

编译器会自动为你创建一个拷贝构造函数。通过自己定义（并在打印中添加），您可以看到构造函数和析构函数的数量匹配

```
Base::Base()
Derived::Derived()
Base::Base(const Base& base)
Derived::~Derived()
Base::~Base()
Base::~Base() 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-21T17:59:23.660

你需要一个[虚拟析构函数](http://en.wikipedia.org/wiki/Virtual_function#C.2B.2B)。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-05-21T18:07:36.590

你有一个堆栈变量和一个临时变量——总共构造了两个对象——所以析构函数被调用两次是合乎逻辑的。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-05-21T23:06:33.633

1) 构建一个 Derived 类型的临时对象（调用 Derived::Derived() 和 Base::Base()）

2）临时对象被复制到“a”中

3) 临时对象被销毁（调用 Derived::~Derived() 和 Base::~Base()）

4）返回EXIT_SUCCESS；

5) "a" 被销毁，所以 Base::~Base() 被调用

# java - 如何在 Java 中覆盖货币符号？

> ID：894223
> 
> 赞同：10
> 
> 时间：2009-05-21T17:55:27.693
> 
> 标签：java, internationalization, currency, turkish

我正在尝试使用 Java 以土耳其里拉（ISO 4217 货币代码 TRY）打印价格。

当我做

```
Currency curr = Currency.getInstance("TRY");
Locale trLocale = new Locale("tr", "TR");
System.out.println(curr.getSymbol(trLocale)); 
```

输出为：“YTL”。

但是，土耳其里拉的货币符号最近已从“YTL”更改为“TL”（可以在土耳其里拉的维基百科页面上看到）。格式化`NumberFormat`给出了类似的结果。

我真的不想再编写另一个 Currency 类，尤其是当 Java 内置了一个时。

有没有办法将Java的TRY默认货币符号覆盖为“TL”？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2010-05-21T05:02:59.420

复活进一步参考：

您可以使用 DecimalFormatSymbols 更改货币以进行格式化

```
Locale trLocale = new Locale("tr", "TR");
DecimalFormat decimalFormat = (DecimalFormat) DecimalFormat.getCurrencyInstance(trLocale);
DecimalFormatSymbols dfs = DecimalFormatSymbols.getInstance(trLocale);
dfs.setCurrencySymbol("TL");
decimalFormat.setDecimalFormatSymbols(dfs); 
```

或者您可以诉诸 SPI 并插入您的货币符号（也许通过创建您自己的国家/地区变体，例如`new Locale("tr","TR","try")`）。为此，您应该提供一个实现`java.util.spi.CurrencyNameProvider`并将其注册到 Java 扩展机制中。查看[http://java.sun.com/javase/6/docs/api/java/util/spi/LocaleServiceProvider.html](http://java.sun.com/javase/6/docs/api/java/util/spi/LocaleServiceProvider.html "LocaleServiceProvider (Java 平台 SE 6)")

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-21T18:45:48.887

有趣的是，根据维基百科，货币代码“TRL”已经过时（土耳其里拉的旧代码）。我还没有升级到最新的 jdk，（在 1.5.0_10 上），但是

`Currency curr = Currency.getInstance("TRL");
Locale trLocale = new Locale("tr", "TR");
System.out.println(curr.getSymbol(trLocale));`

印刷：

TL

因此，也许自己编写一些东西来将现有代码映射到过时的代码，并根据需要进行调整和测试。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-21T18:30:59.803

在 Java 7 中，您可以[覆盖](http://docs.oracle.com/javase/7/docs/api/java/util/Currency.html)属性文件中的货币。如果您依赖 ISO-4217 符号，则可以在此处指定/覆盖它。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-21T18:35:54.630

在您等待 Java 的同时：

```
System.out.println(curr.getSymbol(trLocale).substring(1)); 
```

# iphone - 什么叫 viewDidLoad 或 loadview

> ID：894226
> 
> 赞同：0
> 
> 时间：2009-05-21T17:56:16.553
> 
> 标签：iphone

我有一个从 .nib 文件加载的视图控制器类。但是，我还想以编程方式向该视图添加控件（如 UISwitch）（UISwitch 未添加到 nib 文件中）。我应该在代码的哪一部分分配 UISwitch 控件、viewDidLoad 或 loadView 方法？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-21T18:00:31.240

我会在 viewDidLoad 上做。确实。

来自 Apple 的文档：

> 讨论 该方法仅在视图属性为 nil 且显示需要时调用。您不应直接调用此方法。
> 
> 如果您创建此视图控制器以编程方式管理的视图，那么您应该重写此方法来创建您的视图。默认实现创建一个没有子视图的 UIView 对象。
> 
> 但是，如果您使用 nib 文件初始化视图（即设置 thenibName 和 nibBundle 属性），则不应覆盖此方法，因为默认实现已经重新加载了 nib 文件。而是覆盖 viewDidLoad 方法以在加载 nib 文件后设置任何属性。

在您的情况下， UIView 是从**NIB**文件创建的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-21T20:59:34.980

使用`viewDidLoad`. 此外，您应该删除您在`viewDidUnload`方法中添加的所有内容。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-21T20:57:44.783

如果您从 NIB 加载，实施`loadView`将导致错误。使用`viewDidLoad`. 正如 Pablo 所说，Apple 对此有很好的记录。

# iphone - iPhone 上的 CFAttributedString

> ID：894246
> 
> 赞同：1
> 
> 时间：2009-05-21T18:00:31.597
> 
> 标签：iphone, objective-c, cocoa-touch

是否可以使用该`CFAttributedString`类型在 iPhone 上绘制格式化文本？我在文档中看到了它，但我不知道如何将它实际绘制到上下文中。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-21T18:26:39.767

解决方法是使用 WebKitView。将您的文本格式化为 HTML 并以您需要的任何大小显示在迷你 Web 视图中。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-21T21:28:16.217

[Three20](http://github.com/joehewitt/three20/tree/master)有一个格式化的文本字段。基本上，Joe Hewitt 实现了一个轻量级的 HTML 解释器来呈现文本，因此它比 webview 快得多。足够快，可以在 tableview 中使用。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-21T18:12:53.663

实际上，事实证明这是在 iPhone 文档中回答的，我只是没有仔细阅读它：

> **iPhone OS 注意：**虽然 iPhone OS 上的 Core Foundation 包含 CFAttributedString，但 UIKit 中没有添加用于添加特定属性（如字体、样式或颜色）的 API，也没有用于绘制属性字符串的 API。

你去吧，没有自由格式的文本。真可惜。

凯尔

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-21T21:21:07.870

TextView 上有一个未记录的方法来传递 HTML 格式的文本（它实际上是一种下面的 web 视图）。商店中的许多应用程序都使用它，只需确保您的应用程序在没有它的情况下也能正常工作。

# asp.net - .net，SQLDataTableAdapters

> ID：894252
> 
> 赞同：0
> 
> 时间：2009-05-21T18:03:32.573
> 
> 标签：asp.net, linq, .net-3.5

我有一个使用 .xsd 文件中的 SQL 数据表适配器的 sql 查询方法，并且需要能够在后面的代码中动态地将连接字符串更改为该方法。我不知道如何从后面的代码中访问方法属性。

方法是 IsValidDock()，只需检查数据库中的特定码头编号并返回 bool。

基本上我在后面的代码中实例化查询

将 SQLCommands 调暗为新的 SQLDataTableAdapters.SQLCommands()

我想我可以通过

SQLCommands.IsValidDock()。一些属性。这不起作用，有什么想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-21T18:37:05.597

不过，更好的问题可能是，为什么您需要即时更改此连接？你能改变定义然后收工吗？您是否有多个正在使用的数据库服务器？连接字符串存储在项目的配置中，因此如果您在测试和生产环境中需要不同的连接，那么您可以只拥有两个配置文件。

假设这不是解决方案，请继续阅读...

如果我没记错的话，Visual Studio 中 XSD 解析器吐出的 SqlDataTableAdapter 对象是 SqlDataAdapter 的子类，不是吗（您可以在 Visual Studio 中右键单击一个引用并选择“转到定义” )? 如果是这样，您可以新建一个生成类的实例（在您的项目中应该有一个生成的 .cs 或 .vb 文件）并将其传递给自定义的 SqlConnection 对象。

数据适配器创建后没有用于更改其连接的接口。当您执行任何需要它的操作（调用 Fill()、Insert() 等）时，适配器会打开连接，并且仅在释放 SqlDataAdapter 时关闭。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-09T19:36:32.243

TableAdapter 是作为部分类生成的，因此您可以扩展该 TableAdapter 并在其中为适配器的连接属性添加正确的初始化。

希望这可以帮助詹姆

# java - Tomcat 6：从 WEB-INF/classes 导入实用程序类

> ID：894257
> 
> 赞同：0
> 
> 时间：2009-05-21T18:05:22.367
> 
> 标签：java, jsp, class, tomcat, import

（由于保密协议，我删除了客户名称）

Java/JSP 新手在这里。我有一个 JSP 站点，并且在 WEB-INF/src/client/project/Functions.java 中有一个“函数”类

在 Functions.java 中，包是 com.client.util

这被编译并最终为

```
WEB-INF/classes/client/project/Functions.class
WEB-INF/classes/client/project/Functions$1.class
WEB-INF/classes/client/project/Functions$RequestData.class 
```

现在，在我的 index.jsp 中，我尝试像这样使用这个类：

```
<%@ page import="com.client.util.Functions"%><%
Functions.init(request,response,config,out);
%> 
```

我收到错误“无法解决功能”

如何让我的应用程序知道这个 Functions.class？

我尝试向 web.xml 添加各种内容，但无法使其正常工作。

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-21T18:09:41.923

您的类所在的目录与您尝试导入的包不匹配。

如果包`com.client.util`是正确的，那么`Functions.class`应该在目录中`WEB-INF/classes/com/client/util/`。

# c++ - 发送更多数据的unix域流套接字应该是

> ID：894258
> 
> 赞同：1
> 
> 时间：2009-05-21T18:05:27.953
> 
> 标签：c++, unix, sockets, iostream

我设置了两个通过 unix 域套接字共享数据的简单程序。一个程序从队列中读取数据并将其发送到另一个应用程序。在发送之前，每条数据都在前面附加四个字节的长度，如果小于四个字节，则剩余的字节是'^'符号。

客户端应用程序然后读取前四个字节，将缓冲区设置为适当的大小，然后读取其余部分。我遇到的问题是第一次通过消息将被完美发送。此后每隔一段时间都会发送额外的数据，因此会出现“多么美好的一天”之类的消息，例如“多么美好的一天？？X？？”。所以我觉得缓冲区没有被正确清除，但我似乎找不到它。

客户端代码：

```
listen(sock, 5);
for (;;) 
{
    msgsock = accept(sock, 0, 0);
    if (msgsock == -1)
        perror("accept");
    else do 
    {
        char buf[4];
        bzero(buf, sizeof(buf));
        if ((rval = read(msgsock, buf, 4)) < 0)
        perror("reading stream message");

        printf("--!%s\n", buf);

        string temp = buf;
        int pos = temp.find("^");
        if(pos != string::npos)
        {
            temp = temp.substr(0, pos);
        }

        int sizeOfString = atoi(temp.c_str());
        cout << "TEMP STRING: " << temp << endl;
        cout << "LENGTH " << sizeOfString << endl;
        char feedWord[sizeOfString];
        bzero(feedWord, sizeof(feedWord));

        if ((rval = read(msgsock, feedWord, sizeOfString)) < 0)
              perror("reading stream message");

          else if (rval == 0)
              printf("Ending connection\n");
          else
              printf("-->%s\n", feedWord);
              bzero(feedWord, sizeof(feedWord));
              sizeOfString = 0;
              temp.clear();
      } 
        while (rval > 0);
      close(msgsock);
  }
  close(sock);
  unlink(NAME); 
```

服务器代码

```
 pthread_mutex_lock(&mylock);
                string s;
                s.clear();
                s = dataQueue.front();
                dataQueue.pop();
                pthread_mutex_unlock(&mylock);

                int sizeOfString = strlen(s.c_str());
                char sizeofStringBuffer[10];

                sprintf(sizeofStringBuffer, "%i", sizeOfString);
                string actualString = sizeofStringBuffer;
                int tempSize = strlen(sizeofStringBuffer);

                int remainder = 4 - tempSize;
                int x;
                for(x =0; x < remainder; x++)
                {
                    actualString = actualString + "^";
                }

                cout << "LENGTH OF ACTUAL STRING: " << sizeOfString << endl;

                actualString = actualString + s;

                cout << "************************" << actualString << endl;
                int length = strlen(actualString.c_str());

                char finalString[length];
                bzero(finalString, sizeof(finalString));
                strcpy(finalString, actualString.c_str());

                           if (write(sock, finalString, length) < 0)
                           perror("writing on stream socket"); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-21T18:11:31.013

而不是用' `^`'填充你的数据包长度，你最好这样做：

```
snprintf(sizeofStringBuffer, 5, "%04d", sizeOfString); 
```

使值填充为 0 - 那么您不需要解析接收器代码中的 '^' 字符。

还请编辑您的调试代码 - 当前代码中只有一个`write()`，它与您对协议的描述不匹配。

理想情况下 - 将您的发送例程拆分为自己的功能。您还可以利用`writev()`处理将保存“长度”字段的字符串与保存实际数据的缓冲区合并，然后将它们作为单个 atomic 发送`write()`。

未经测试的代码如下：

```
int write_message(int s, std::string msg)
{
     struct iovec iov[2];
     char hdr[5];

     char *cmsg = msg.c_str();
     int len = msg.length();

     snprintf(hdr, 5, "%04d", len);  // nb: assumes len <= 9999;

     iov[0].iov_base = hdr;
     iov[0].iov_len = 4;

     iov[1].iov_base = cmsg;
     iov[1].iov_len = len;

     return writev(s, iov, 2);
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-21T18:12:21.700

您必须检查两者的返回值，`write`不仅`read`是`-1`对于简短的（少于请求的）写入/读取。您似乎也只是在打印错误后继续`perror`- do an `exit(2)`or something there。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-22T20:17:05.157

两件事情：

首先 - 在服务器端，您正在注销阵列的末尾。

```
char finalString[length];
bzero(finalString, sizeof(finalString));
strcpy(finalString, actualString.c_str()); 
```

将字符`strcpy()`复制`length+1`到`finalString`（字符拉空终止符）。

其次（并且最有可能是问题所在）-在客户端，您不是 null 终止您读入的字符串，因此`printf()`将打印您的字符串，然后在堆栈上的任何内容直到它达到 null 为止。

将两个缓冲区都增加一，您应该会处于更好的状态。

# c# - 识别字符串是否为数字

> ID：894263
> 
> 赞同：854
> 
> 时间：2009-05-21T18:06:27.297
> 
> 标签：c#, string, parsing, isnumeric

如果我有这些字符串：

1.  `"abc"` = `false`

2.  `"123"` =`true`

3.  `"ab2"` =`false`

是否有类似`IsNumeric()`或其他命令可以识别字符串是否为有效数字？

* * *

## 回答 #1

> 赞同：1367
> 
> 时间：2009-05-21T18:08:47.260

```
int n;
bool isNumeric = int.TryParse("123", out n); 
```

**从 C# 7 开始**更新：****

 **```
var isNumeric = int.TryParse("123", out int n); 
```

或者如果您不需要数字，您可以[丢弃](https://docs.microsoft.com/en-us/dotnet/csharp/discards)out 参数

```
var isNumeric = int.TryParse("123", out _); 
```

*var*可以被它们各自的类型替换！

* * *

## 回答 #2

> 赞同：378
> 
> 时间：2009-05-21T19:08:07.890

如果`input`是所有数字，这将返回 true。不知道它是否比 更好`TryParse`，但它会起作用。

```
Regex.IsMatch(input, @"^\d+$") 
```

如果您只想知道它是否有一个或多个数字与字符混合，请不要使用`^` `+`and `$`。

```
Regex.IsMatch(input, @"\d") 
```

**编辑：** 实际上我认为它比 TryParse 更好，因为很长的字符串可能会溢出 TryParse。

* * *

## 回答 #3

> 赞同：247
> 
> 时间：2014-10-20T12:06:25.910

您还可以使用：

```
using System.Linq;

stringTest.All(char.IsDigit); 
```

如果输入字符串是任何类型的字母数字，它将返回`true`所有数字（不是`float`） 。`false`

| 测试用例 | 返回值 | 测试结果 |
| --- | --- | --- |
| `"1234"` | 真的 | ✅通过 |
| `"1"` | 真的 | ✅通过 |
| `"0"` | 真的 | ✅通过 |
| `""` | 真的 | ⚠️失败*（已知的边缘情况）* |
| `"12.34"` | 错误的 | ✅通过 |
| `"+1234"` | 错误的 | ✅通过 |
| `"-13"` | 错误的 | ✅通过 |
| `"3E14"` | 错误的 | ✅通过 |
| `"0x10"` | 错误的 | ✅通过 |

**请注意**：`stringTest`不应为空字符串，因为这将通过数字测试。

* * *

## 回答 #4

> 赞同：138
> 
> 时间：2009-05-21T18:20:05.613

我已经多次使用此功能：

```
public static bool IsNumeric(object Expression)
{
    double retNum;

    bool isNum = Double.TryParse(Convert.ToString(Expression), System.Globalization.NumberStyles.Any, System.Globalization.NumberFormatInfo.InvariantInfo, out retNum);
    return isNum;
} 
```

但你也可以使用；

```
bool b1 = Microsoft.VisualBasic.Information.IsNumeric("1"); //true
bool b2 = Microsoft.VisualBasic.Information.IsNumeric("1aa"); // false 
```

从[基准测试 IsNumeric 选项](http://aspalliance.com/80_Benchmarking_IsNumeric_Options.3)

[![替代文字](https://i.stack.imgur.com/IyZM0.gif)](https://i.stack.imgur.com/IyZM0.gif)
[（来源：[aspalliance.com](http://aspalliance.com/images/articleimages/80/Figure1.gif)）]

[![替代文字](https://i.stack.imgur.com/YNYoS.gif)](https://i.stack.imgur.com/YNYoS.gif)
[（来源：[aspalliance.com](http://aspalliance.com/images/articleimages/80/Figure2.gif)）]

* * *

## 回答 #5

> 赞同：33
> 
> 时间：2009-05-21T18:16:03.813

这可能是 C# 中的最佳选择。

如果您想知道字符串是否包含整数（整数）：

```
string someString;
// ...
int myInt;
bool isNumerical = int.TryParse(someString, out myInt); 
```

TryParse 方法将尝试将字符串转换为数字（整数），如果成功，它将返回 true 并将相应的数字放入 myInt。如果不能，则返回 false。

使用`int.Parse(someString)`其他响应中显示的替代方案的解决方案有效，但速度要慢得多，因为抛出异常非常昂贵。`TryParse(...)`在版本 2 中被添加到 C# 语言中，在此之前您别无选择。现在你做了：因此你应该避免`Parse()`替代方案。

如果要接受十进制数，decimal 类也有一个`.TryParse(...)`方法。在上面的讨论中用十进制替换 int，同样的原则也适用。

* * *

## 回答 #6

> 赞同：26
> 
> 时间：2009-05-21T18:09:51.690

您始终可以对许多数据类型使用内置的 TryParse 方法，以查看相关字符串是否会通过。

例子。

```
decimal myDec;
var Result = decimal.TryParse("123", out myDec); 
```

结果将 = True

```
decimal myDec;
var Result = decimal.TryParse("abc", out myDec); 
```

结果将 = False

* * *

## 回答 #7

> 赞同：26
> 
> 时间：2009-05-21T18:13:20.747

如果您不想使用 int.Parse 或 double.Parse，您可以使用类似这样的方式自行开发：

```
public static class Extensions
{
    public static bool IsNumeric(this string s)
    {
        foreach (char c in s)
        {
            if (!char.IsDigit(c) && c != '.')
            {
                return false;
            }
        }

        return true;
    }
} 
```

* * *

## 回答 #8

> 赞同：15
> 
> 时间：2013-04-30T15:04:55.240

如果您想捕获更广泛的数字，例如 PHP 的[is_numeric](http://php.net/manual/en/function.is-numeric.php)，您可以使用以下命令：

```
// From PHP documentation for is_numeric
// (http://php.net/manual/en/function.is-numeric.php)

// Finds whether the given variable is numeric.

// Numeric strings consist of optional sign, any number of digits, optional decimal part and optional
// exponential part. Thus +0123.45e6 is a valid numeric value.

// Hexadecimal (e.g. 0xf4c3b00c), Binary (e.g. 0b10100111001), Octal (e.g. 0777) notation is allowed too but
// only without sign, decimal and exponential part.
static readonly Regex _isNumericRegex =
    new Regex(  "^(" +
                /*Hex*/ @"0x[0-9a-f]+"  + "|" +
                /*Bin*/ @"0b[01]+"      + "|" + 
                /*Oct*/ @"0[0-7]*"      + "|" +
                /*Dec*/ @"((?!0)|[-+]|(?=0+\.))(\d*\.)?\d+(e\d+)?" + 
                ")$" );
static bool IsNumeric( string value )
{
    return _isNumericRegex.IsMatch( value );
} 
```

单元测试：

```
static void IsNumericTest()
{
    string[] l_unitTests = new string[] { 
        "123",      /* TRUE */
        "abc",      /* FALSE */
        "12.3",     /* TRUE */
        "+12.3",    /* TRUE */
        "-12.3",    /* TRUE */
        "1.23e2",   /* TRUE */
        "-1e23",    /* TRUE */
        "1.2ef",    /* FALSE */
        "0x0",      /* TRUE */
        "0xfff",    /* TRUE */
        "0xf1f",    /* TRUE */
        "0xf1g",    /* FALSE */
        "0123",     /* TRUE */
        "0999",     /* FALSE (not octal) */
        "+0999",    /* TRUE (forced decimal) */
        "0b0101",   /* TRUE */
        "0b0102"    /* FALSE */
    };

    foreach ( string l_unitTest in l_unitTests )
        Console.WriteLine( l_unitTest + " => " + IsNumeric( l_unitTest ).ToString() );

    Console.ReadKey( true );
} 
```

请记住，仅仅因为值是数字并不意味着它可以转换为数字类型。例如，`"999999999999999999999999999999.9999999999"`是一个完全有效的数值，但它不适合 .NET 数值类型（不是标准库中定义的类型）。

* * *

## 回答 #9

> 赞同：14
> 
> 时间：2015-09-29T09:44:35.250

我知道这是一个旧线程，但没有一个答案真的对我有用——要么效率低下，要么没有封装以便于重用。如果字符串为空或 null，我还想确保它返回 false。TryParse 在这种情况下返回 true（空字符串在解析为数字时不会导致错误）。所以，这是我的字符串扩展方法：

```
public static class Extensions
{
    /// <summary>
    /// Returns true if string is numeric and not empty or null or whitespace.
    /// Determines if string is numeric by parsing as Double
    /// </summary>
    /// <param name="str"></param>
    /// <param name="style">Optional style - defaults to NumberStyles.Number (leading and trailing whitespace, leading and trailing sign, decimal point and thousands separator) </param>
    /// <param name="culture">Optional CultureInfo - defaults to InvariantCulture</param>
    /// <returns></returns>
    public static bool IsNumeric(this string str, NumberStyles style = NumberStyles.Number,
        CultureInfo culture = null)
    {
        double num;
        if (culture == null) culture = CultureInfo.InvariantCulture;
        return Double.TryParse(str, style, culture, out num) && !String.IsNullOrWhiteSpace(str);
    }
} 
```

使用简单：

```
var mystring = "1234.56789";
var test = mystring.IsNumeric(); 
```

或者，如果您想测试其他类型的数字，您可以指定“样式”。因此，要使用指数转换数字，您可以使用：

```
var mystring = "5.2453232E6";
var test = mystring.IsNumeric(style: NumberStyles.AllowExponent); 
```

或者要测试潜在的十六进制字符串，您可以使用：

```
var mystring = "0xF67AB2";
var test = mystring.IsNumeric(style: NumberStyles.HexNumber) 
```

可以以几乎相同的方式使用可选的“culture”参数。

它受限于无法转换太大而无法包含在双精度中的字符串，但这是一个有限的要求，我认为如果您使用大于此的数字，那么您可能需要额外的专门数字处理无论如何都起作用。

* * *

## 回答 #10

> 赞同：13
> 
> 时间：2018-10-18T17:55:44.150

**更新 Kunal Noel 答案**

```
stringTest.All(char.IsDigit);
// This returns true if all characters of the string are digits. 
```

但是，对于这种情况，我们有空字符串将通过该测试，因此，您可以：

```
if (!string.IsNullOrEmpty(stringTest) && stringTest.All(char.IsDigit)){
   // Do your logic here
} 
```

* * *

## 回答 #11

> 赞同：11
> 
> 时间：2009-05-21T18:10:24.213

您可以使用 TryParse 来确定字符串是否可以解析为整数。

```
int i;
bool bNum = int.TryParse(str, out i); 
```

布尔值会告诉你它是否有效。

* * *

## 回答 #12

> 赞同：11
> 
> 时间：2009-05-21T18:11:02.823

如果你想知道一个字符串是否是一个数字，你总是可以尝试解析它：

```
var numberString = "123";
int number;

int.TryParse(numberString , out number); 
```

请注意，`TryParse`返回 a `bool`，您可以使用它来检查您的解析是否成功。

* * *

## 回答 #13

> 赞同：10
> 
> 时间：2014-03-07T13:07:26.143

我想这个答案会在所有其他答案之间丢失，但无论如何，这里有。

我最终通过谷歌解决了这个问题，因为我想检查 a 是否`string`是`numeric`这样，以便我可以使用`double.Parse("123")`而不是`TryParse()`方法。

为什么？因为在你知道解析是否失败之前必须声明一个`out`变量并检查结果是很烦人的。`TryParse()`我想使用`ternary operator`来检查是否`string`是`numerical`，然后在第一个三元表达式中解析它或在第二个三元表达式中提供一个默认值。

像这样：

```
var doubleValue = IsNumeric(numberAsString) ? double.Parse(numberAsString) : 0; 
```

它比：

```
var doubleValue = 0;
if (double.TryParse(numberAsString, out doubleValue)) {
    //whatever you want to do with doubleValue
} 
```

**我`extension methods`为这些案例做了几个：**

* * *

## 扩展方法一

```
public static bool IsParseableAs<TInput>(this string value) {
    var type = typeof(TInput);

    var tryParseMethod = type.GetMethod("TryParse", BindingFlags.Static | BindingFlags.Public, Type.DefaultBinder,
        new[] { typeof(string), type.MakeByRefType() }, null);
    if (tryParseMethod == null) return false;

    var arguments = new[] { value, Activator.CreateInstance(type) };
    return (bool) tryParseMethod.Invoke(null, arguments);
} 
```

**例子：**

```
"123".IsParseableAs<double>() ? double.Parse(sNumber) : 0; 
```

因为`IsParseableAs()`尝试将字符串解析为适当的类型，而不是仅仅检查字符串是否为“数字”，所以它应该是非常安全的。您甚至可以将它用于具有`TryParse()`方法的非数字类型，例如`DateTime`.

该方法使用反射，您最终会调用该`TryParse()`方法两次，这当然效率不高，但并非所有内容都必须完全优化，有时方便更重要。

此方法还可用于轻松地将数字字符串列表解析为`double`具有默认值的列表或其他类型，而无需捕获任何异常：

```
var sNumbers = new[] {"10", "20", "30"};
var dValues = sNumbers.Select(s => s.IsParseableAs<double>() ? double.Parse(s) : 0); 
```

* * *

## 扩展方法二

```
public static TOutput ParseAs<TOutput>(this string value, TOutput defaultValue) {
    var type = typeof(TOutput);

    var tryParseMethod = type.GetMethod("TryParse", BindingFlags.Static | BindingFlags.Public, Type.DefaultBinder,
        new[] { typeof(string), type.MakeByRefType() }, null);
    if (tryParseMethod == null) return defaultValue;

    var arguments = new object[] { value, null };
    return ((bool) tryParseMethod.Invoke(null, arguments)) ? (TOutput) arguments[1] : defaultValue;
} 
```

此扩展方法允许您将 a 解析为具有方法的`string`任何方法，并且还允许您指定在转换失败时返回的默认值。`type``TryParse()`

这比在上面的扩展方法中使用三元运算符要好，因为它只进行一次转换。虽然它仍然使用反射......

**例子：**

```
"123".ParseAs<int>(10);
"abc".ParseAs<int>(25);
"123,78".ParseAs<double>(10);
"abc".ParseAs<double>(107.4);
"2014-10-28".ParseAs<DateTime>(DateTime.MinValue);
"monday".ParseAs<DateTime>(DateTime.MinValue); 
```

**输出：**

```
123
25
123,78
107,4
28.10.2014 00:00:00
01.01.0001 00:00:00 
```

* * *

## 回答 #14

> 赞同：9
> 
> 时间：2014-05-15T23:24:16.513

如果你想检查一个字符串是否是一个数字（我假设它是一个字符串，因为如果它是一个数字，呃，你知道它是一个）。

*   没有正则表达式和
*   尽可能使用微软的代码

你也可以这样做：

```
public static bool IsNumber(this string aNumber)
{
     BigInteger temp_big_int;
     var is_number = BigInteger.TryParse(aNumber, out temp_big_int);
     return is_number;
} 
```

这将解决通常的问题：

*   开头的减号 (-) 或加号 (+)
*   ~~包含十进制字符~~BigIntegers 不会解析带小数点的数字。（所以：`BigInteger.Parse("3.3")`会抛出异常，`TryParse`同样会返回false）
*   没有有趣的非数字
*   涵盖数字大于通常使用的情况`Double.TryParse`

您必须添加对班级的引用`System.Numerics`并 `using System.Numerics;`在班级中名列前茅（好吧，我猜第二个是奖励:)

* * *

## 回答 #15

> 赞同：7
> 
> 时间：2009-05-21T18:11:13.730

[Double.TryParse](http://msdn.microsoft.com/en-us/library/994c0zb1(v=vs.110).aspx)

```
bool Double.TryParse(string s, out double result) 
```

* * *

## 回答 #16

> 赞同：6
> 
> 时间：2018-12-08T03:17:49.823

具有 .net 内置函数的最佳灵活解决方案 - `char.IsDigit`。它适用于无限长数字。如果每个字符都是数字，它只会返回 true。我多次使用它，没有任何问题，而且我找到了更容易清洁的解决方案。我做了一个示例方法。它可以使用了。此外，我添加了对 null 和空输入的验证。所以这个方法现在是完全防弹的

```
public static bool IsNumeric(string strNumber)
    {
        if (string.IsNullOrEmpty(strNumber))
        {
            return false;
        }
        else
        {
            int numberOfChar = strNumber.Count();
            if (numberOfChar > 0)
            {
                bool r = strNumber.All(char.IsDigit);
                return r;
            }
            else
            {
                return false;
            }
        }
    } 
```

* * *

## 回答 #17

> 赞同：6
> 
> 时间：2019-07-23T13:59:06.377

尝试下面的正则表达式定义

```
new Regex(@"^\d{4}").IsMatch("6")    // false
new Regex(@"^\d{4}").IsMatch("68ab") // false
new Regex(@"^\d{4}").IsMatch("1111abcdefg")
new Regex(@"^\d+").IsMatch("6") // true (any length but at least one digit) 
```

* * *

## 回答 #18

> 赞同：2
> 
> 时间：2017-11-09T23:39:38.057

使用 c# 7，您可以内联 out 变量：

```
if(int.TryParse(str, out int v))
{
} 
```

* * *

## 回答 #19

> 赞同：2
> 
> 时间：2018-07-03T09:59:20.923

使用这些扩展方法可以清楚地区分检查字符串是否为*数字*和字符串是否*仅*包含 0-9 位

```
public static class ExtensionMethods
{
    /// <summary>
    /// Returns true if string could represent a valid number, including decimals and local culture symbols
    /// </summary>
    public static bool IsNumeric(this string s)
    {
        decimal d;
        return decimal.TryParse(s, System.Globalization.NumberStyles.Any, System.Globalization.CultureInfo.CurrentCulture, out d);
    }

    /// <summary>
    /// Returns true only if string is wholy comprised of numerical digits
    /// </summary>
    public static bool IsNumbersOnly(this string s)
    {
        if (s == null || s == string.Empty)
            return false;

        foreach (char c in s)
        {
            if (c < '0' || c > '9') // Avoid using .IsDigit or .IsNumeric as they will return true for other characters
                return false;
        }

        return true;
    }
} 
```

* * *

## 回答 #20

> 赞同：2
> 
> 时间：2018-07-31T07:27:02.490

```
public static bool IsNumeric(this string input)
{
    int n;
    if (!string.IsNullOrEmpty(input)) //.Replace('.',null).Replace(',',null)
    {
        foreach (var i in input)
        {
            if (!int.TryParse(i.ToString(), out n))
            {
                return false;
            }

        }
        return true;
    }
    return false;
} 
```

* * *

## 回答 #21

> 赞同：1
> 
> 时间：2013-01-02T11:32:29.993

希望这可以帮助

```
string myString = "abc";
double num;
bool isNumber = double.TryParse(myString , out num);

if isNumber 
{
//string is number
}
else
{
//string is not a number
} 
```

* * *

## 回答 #22

> 赞同：1
> 
> 时间：2021-09-02T13:41:34.843

```
Regex rx = new Regex(@"^([1-9]\d*(\.)\d*|0?(\.)\d*[1-9]\d*|[1-9]\d*)$");
string text = "12.0";
var result = rx.IsMatch(text);
Console.WriteLine(result); 
```

检查字符串是 uint、ulong 还是仅包含数字 one .(dot) 和 digits Sample 输入

```
123 => True
123.1 => True
0.123 => True
.123 => True
0.2 => True
3452.434.43=> False
2342f43.34 => False
svasad.324 => False
3215.afa => False 
```

* * *

## 回答 #23

> 赞同：0
> 
> 时间：2013-07-17T21:14:06.067

在您的项目中引入对 Visual Basic 的引用并使用其 Information.IsNumeric 方法，如下所示，并且能够捕获浮点数和整数，这与上面仅捕获整数的答案不同。

```
 // Using Microsoft.VisualBasic;

    var txt = "ABCDEFG";

    if (Information.IsNumeric(txt))
        Console.WriteLine ("Numeric");

IsNumeric("12.3"); // true
IsNumeric("1"); // true
IsNumeric("abc"); // false 
```

* * *

## 回答 #24

> 赞同：0
> 
> 时间：2019-08-23T11:39:05.780

所有的答案都是有用的。但是在寻找数值为 12 位或更多的解决方案时（在我的情况下），然后在调试时，我发现以下解决方案很有用：

```
double tempInt = 0;
bool result = double.TryParse("Your_12_Digit_Or_more_StringValue", out tempInt); 
```

结果变量会给你真或假。

* * *

## 回答 #25

> 赞同：-1
> 
> 时间：2009-05-21T18:35:41.730

这是 C# 方法。 [**Int.TryParse 方法（字符串，Int32）**](http://msdn.microsoft.com/en-us/library/f02979c7.aspx)

* * *

## 回答 #26

> 赞同：-6
> 
> 时间：2013-04-07T03:15:38.483

```
//To my knowledge I did this in a simple way
static void Main(string[] args)
{
    string a, b;
    int f1, f2, x, y;
    Console.WriteLine("Enter two inputs");
    a = Convert.ToString(Console.ReadLine());
    b = Console.ReadLine();
    f1 = find(a);
    f2 = find(b);

    if (f1 == 0 && f2 == 0)
    {
        x = Convert.ToInt32(a);
        y = Convert.ToInt32(b);
        Console.WriteLine("Two inputs r number \n so that addition of these text box is= " + (x + y).ToString());
    }
    else
        Console.WriteLine("One or two inputs r string \n so that concatenation of these text box is = " + (a + b));
    Console.ReadKey();
}

static int find(string s)
{
    string s1 = "";
    int f;
    for (int i = 0; i < s.Length; i++)
       for (int j = 0; j <= 9; j++)
       {
           string c = j.ToString();
           if (c[0] == s[i])
           {
               s1 += c[0];
           }
       }

    if (s == s1)
        f = 0;
    else
        f = 1;

    return f;
} 
```

# c# - Fluent NHibernate 自动映射：将 DateTime 更改为时间戳

> ID：894264
> 
> 赞同：4
> 
> 时间：2009-05-21T18:06:49.650
> 
> 标签：c#, nhibernate, fluent-nhibernate, automapping

我正在（有点）深入使用 NHibernate 的流畅界面进行自动映射。非常好的事情，但我在使用 DateTimes 时遇到了一个小问题。我需要将数据格式更改为时间戳，否则 NHibernate 会截断毫秒。

我找到了几个信息来源，最好的一个是： [AutoMapping Info 1](http://blog.jagregory.com/2009/01/11/fluent-nhibernate-auto-mapping-type-conventions/)，他正在更改属性的列名和类型。[问题是，根据本文档](http://wiki.fluentnhibernate.org/show/diff/ConvertingToNewStyleConventions)，流畅的自动映射发生了变化。

现在我不知道如何让自动映射“更改类型”。我尝试了以下代码，但我被卡住了。同样，我想做的只是告诉自动映射器：

**使用 DateTime 的时间戳可防止在使用自动映射时截断毫秒。**

有人有想法吗？到目前为止的代码：

```
 public class DateTimeToTimestamp : IClassConvention  
{  
    public bool Accept(IClassMap target)
    {
        return target.GetType() == typeof(DateTime);
    }

    public void Apply(IClassMap target)
    {
        throw new NotImplementedException();
    }
} 
```

好的，非常感谢您的回答...那样对我来说已经足够舒适了。如果我真的有 3 个类需要这种精度，我可以写三遍。特别是因为所有其他属性的映射仍然完美，并且以下代码仅替换我想要的一个属性......非常好！

如果有人知道更通用的方法，请随时添加，但现在，我很高兴！

我的案例代码是：

```
 public class DateTimeToTimestamp : IAutoMappingOverride<CustomTime>
{
    public void Override(AutoMap<CustomTime> mapping)
    {
        mapping.Map(x => x.ScanDate).CustomTypeIs("timestamp");
    }
} 
```

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2010-09-11T03:37:19.300

为了扩展 Derek 的答案，为了在更一般的层面上进行，您将使用自动映射约定：

```
public class TimestampTypeConvention : IPropertyConvention, IPropertyConventionAcceptance
{
    public void Accept(IAcceptanceCriteria<IPropertyInspector> criteria)
    {
        criteria.Expect(x => x.Type == typeof (DateTime));
    }

    public void Apply(IPropertyInstance instance)
    {
        instance.CustomType<TimestampType>();
    }
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-21T18:58:42.777

您可以覆盖特定的类。不过，不确定如何在更一般的层面上做到这一点。

```
public class AlbumMappingOverride : IAutoMappingOverride<Album>
{
    public void Override(AutoMap<Album> mapping)
    {
        mapping.Map(x => x.Created).CustomSqlTypeIs("timestamp");
    }
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-04-10T08:42:58.467

Danie 的答案是可以使用的，尽管需要对 Apply() 方法进行一些小改动才能使其工作：CustomSqlType("timestamp") -> CustomType("Timestamp")。我验证了这一点，因为我刚刚在自己的项目中实施了该解决方案。

**注意：**我试图提交对丹尼尔上面答案的编辑，但因为更改太小所以无法提交，所以这里是更正的代码：

```
public class TimestampTypeConvention : IPropertyConvention, IPropertyConventionAcceptance
{
    public void Accept(IAcceptanceCriteria<IPropertyInspector> criteria)
    {
        criteria.Expect(x => x.Type == typeof (DateTime));
    }

    public void Apply(IPropertyInstance instance)
    {
        instance.CustomType("Timestamp");
    }
} 
```

此外，当我在写一篇新文章时，这里有一个简化的示例，说明如何使用 Fluent NHibernate 创建一个使用约定的会话工厂，以帮助可能不知道的其他人：

```
var factory = Fluently.Configure()
        .Mappings(m => m.FluentMappings.Conventions.Add(new TimestampConvention()))
        .BuildSessionFactory(); 
```

感谢[这篇](https://stackoverflow.com/a/7681388/317739)文章让我意识到这一点，因为我在网上看到很多其他帖子都有同样的问题。

# php - PHP REST 客户端

> ID：894268
> 
> 赞同：35
> 
> 时间：2009-05-21T18:07:53.987
> 
> 标签：php, rest, client

我正在尝试连接到 RESTful Web 服务，但遇到了一些麻烦，尤其是在通过 PUT 和 DELETE 发送数据时。使用 cURL，PUT 需要发送文件，而 DELETE 很奇怪。我完全有能力使用 PHP 的套接字支持编写客户端并自己编写 HTTP 标头，但我想知道你们是否曾经使用或见过 PHP 的 REST 客户端？

* * *

## 回答 #1

> 赞同：39
> 
> 时间：2011-01-20T17:26:03.657

事实证明，Zend_Rest_Client 根本不是 REST 客户端——例如，它不支持 PUT 和 DELETE 方法。在尝试将其与实际的 RESTful 服务一起工作后，我受够了并为 PHP 编写了一个合适的 REST 客户端：

[http://github.com/educoder/pest](http://github.com/educoder/pest)

它仍然缺少一些东西，但如果它被捡起，我会做更多的工作。

以下是 OpenStreetMap REST 服务的使用示例：

```
<?php

/**
 * This PestXML usage example pulls data from the OpenStreetMap API.
 * (see http://wiki.openstreetmap.org/wiki/API_v0.6)
 **/

require_once 'PestXML.php';

$pest = new PestXML('http://api.openstreetmap.org/api/0.6');

// Retrieve map data for the University of Toronto campus
$map = $pest->get('/map?bbox=-79.39997,43.65827,-79.39344,43.66903');

// Print all of the street names in the map
$streets = $map->xpath('//way/tag[@k="name"]');
foreach ($streets as $s) {
  echo $s['v'] . "\n";
}

?> 
```

目前它使用 curl 但我可以将其切换到 HTTP_Request 或 HTTP_Request2 。

**更新：**看起来有不少人对此表示赞同。由于 GitHub 上的贡献者，Pest 现在支持 HTTP 身份验证和许多其他功能。

* * *

## 回答 #2

> 赞同：38
> 
> 时间：2011-10-12T01:24:26.077

我编写了一个名为 Guzzle 的 PHP HTTP 客户端。Guzzle 是一个 HTTP 客户端和框架，用于构建 REST Web 服务客户端。[您可以在其网站](http://www.guzzlephp.org/)上找到有关 Guzzle 的更多信息，或直接访问 github 上的源代码：[https ://github.com/guzzle/guzzle](https://github.com/guzzle/guzzle)

Guzzle 提供了大多数 HTTP 客户端提供的好东西（更简单的界面、所有 HTTP 方法以及查看请求/响应），但还提供了其他高级功能：

*   流式实体主体
*   指数退避
*   内置缓存转发代理
*   饼干
*   日志记录
*   托管持久连接
*   并行请求
*   身份验证
*   允许您实现任意身份验证方案的插件架构
*   从 JSON 服务描述文件自动生成客户端 API

唯一的缺点：它需要 PHP 5.3.3

* * *

## 回答 #3

> 赞同：13
> 
> 时间：2009-05-21T18:17:41.970

我倾向于只使用 PHP 的内置[cURL 支持](http://php.net/curl)。该[`CURLOPT_CUSTOMREQUEST`](http://php.net/curl_setopt)选项允许您执行`PUT`/`DELETE`等。

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2011-12-15T07:37:56.067

## 其余客户端的 php 中的简单示例 - 更新如下：

```
<?php
$url ="http://example.com";
$data = "The updated text message";
$ch = curl_init();
curl_setopt($ch,CURLOPT_URL,$url);
curl_setopt($ch, CURLOPT_POST, true);
curl_setopt($ch, CURLOPT_CUSTOMREQUEST, "PUT");  //for updating we have to use PUT method.
curl_setopt($ch,CURLOPT_POSTFIELDS,$data);
$result = curl_exec($ch);
$httpCode = curl_getinfo($ch, CURLINFO_HTTP_CODE);
curl_close($ch);
?> 
```

## 其余客户端的 php 中的简单示例 - 删除 categoryid=xx 如下：

```
<?php
$url ="http://example.com/categoryid=xx";
$ch = curl_init();
curl_setopt($ch, CURLOPT_URL,$url);
curl_setopt($ch, CURLOPT_CUSTOMREQUEST, "DELETE");
$result = curl_exec($ch);
$httpCode = curl_getinfo($ch, CURLINFO_HTTP_CODE);
curl_close($ch);
?> 
```

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2011-09-20T20:41:01.250

我很长一段时间都找不到优雅的解决方案，不喜欢 cURL 实现，想出了我自己的。它支持 HTTP 身份验证、重定向、PUT 等，因为它依赖于 pecl http 模块。

实现很好，简单，易于扩展。

*   [https://github.com/shurikk/rest-client-php](https://github.com/shurikk/rest-client-php)

更多信息可以在这里找到：

*   [http://pecl.php.net/package/pecl_http](http://pecl.php.net/package/pecl_http)
*   [http://www.php.net/manual/en/http.request.options.php](http://www.php.net/manual/en/http.request.options.php)

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-05-21T19:34:23.250

我在[Zend Rest Client上取得了很好的成功](http://framework.zend.com/manual/en/zend.rest.html)

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2012-07-31T13:08:19.790

复活话题，发现这个库**[https://github.com/Respect/Rest/](https://github.com/Respect/Rest/)**很好用，但是网上的例子很少：

```
 require_once 'bootstrap.php';
require_once 'Respect/Rest/Router.php';
require_once 'Respect/Rest/Request.php';
use Respect\Rest\Router;

$router->post('/myApp/', function() {

  $data_back = json_decode(file_get_contents('php://input'));
            //  var_dump($data_back);
  return json_encode($data_back);
 });
$router->get('/myApp/*', function($id = null) {

$json = json_encode(MyService::getInstance()->list());

 return utf8_encode($json);
 });
$router->put('/myApp/*', function($id = null) {
  return 'Update: ' . $id;
 });
$router->delete('/myApp/*', function($id = null) {
  return 'Delete: ' . $id;
 }); 
```

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2012-11-28T16:09:38.777

最近出现的是[Zend\Http\Client](http://framework.zend.com/manual/2.0/en/modules/zend.http.client.html)，它是 Zend Framework 2 的一部分。

可通过 composer 安装（尽管在撰写本文时，不是通过 Packagist；仍然需要使用 Zend 的自定义包存储库[http://packages.zendframework.com/](http://packages.zendframework.com/)）。

# .net - ORM 对长时间运行的上下文有很好的支持

> ID：894269
> 
> 赞同：1
> 
> 时间：2009-05-21T18:07:59.273
> 
> 标签：.net, orm

相关问题[在这里](https://stackoverflow.com/questions/484691/enitity-framework-with-long-running-object-context)。

对于大多数 ORM，当您针对现有上下文运行查询时，它不会返回自对象首次从数据库返回以来已更改的数据。它向 DB 发出查询，但不会返回对 DB 所做的任何更改，因为上下文不想踩到您的对象（有关 Linq to SQL 中此行为的讨论，请参见[此处](http://blogs.msdn.com/dinesh.kulkarni/archive/2008/05/23/linq-to-sql-tips-6-how-to-refresh-given-datacontext-won-t-stomp-on-your-objects.aspx)）。这对于使用工作单元模式的短期上下文很好，但如果您使用长期上下文，则不是很好。

我已经尝试过 Linq to SQL 和实体框架，这两个框架都提供了一个刷新方法，可以让您指定一个枚举参数来覆盖上下文中的现有对象，但这不会获取新记录（至少在没有额外查询的情况下不会）等等重要的是不会删除已从数据库中删除的记录的对象。

我知道我可以丢弃上下文和现有对象，但我不想这样做，因为对象绑定到应用程序中的其他元素。

是否有任何 ORM 能够使用数据库的最新数据刷新对象，为新创建的对象添加对象并为已从数据库中删除的记录删除对象，理想情况下以一种有效的方式（即使用 MS SQL rowversion列）。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-25T12:06:18.633

我不确定，但您似乎需要类似于 DataObjects.Net 行为的东西。它们的实体是长期存在的会话绑定对象，以事务状态存储数据。当您打开新事务并读取现有对象的持久属性时，它们会自动从数据库中获取它（它也涉及 EntitySet 属性）。

当然，您应该为每个事务执行复杂的查询，以将查询结果保持在实际状态，但我认为它可以很容易地自动化。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-22T13:00:52.597

检查这个 ORM：“ [http://entityorm.uuuq.com](http://entityorm.uuuq.com) ”

您在网站上有：

*   基本示例如何工作；
*   pdf 手册中的完整文档和示例；
*   论坛;
*   支持的数据库（无限制，因为您可以制作自己的驱动程序）。

# nhibernate - NHibernate ICriteria 查询，带有用于高级搜索的组件和集合

> ID：894276
> 
> 赞同：2
> 
> 时间：2009-05-21T18:09:53.200
> 
> 标签：nhibernate, fluent-nhibernate, icriteria

我正在为我的 ASP.NET MVC 应用程序构建一个高级搜索表单。

我有一个 Customer 对象，带有一个地址组件：Fluent NHibernate 映射：

```
 public CustomerMap()
    {
        WithTable("Customers");

        Id(x => x.Id)
            .WithUnsavedValue(0)
            .GeneratedBy.Identity();

        Map(x => x.Name);
        Map(x => x.Industry);

        Component(x => x.Address, m =>
        {
            m.Map(x => x.AddressLine);
            m.Map(x => x.City);
            m.Map(x => x.State);
            m.Map(x => x.Zip);
        }); 
```

在我的 Customer 类 ctor 中，为了防止空对象，我有以下内容：

```
public Customer()
{
    Address = new Address();
} 
```

我的搜索表单有以下字段可供用户搜索：

*   顾客姓名
*   城市
*   状态
*   行业

所有的区域均为可选。

我的 NHibernate Criteria 看起来像这样（使用 ASP.NET MVC 模型绑定器从表单传入客户）：

```
 var p = Session.CreateCriteria(typeof(Customer))
            .Add(Example.Create(customer).ExcludeZeroes().IgnoreCase().EnableLike())
            .SetProjection(Projections.ProjectionList()
                               .Add(Projections.Property("Id"), "Id")
                               .Add(Projections.Property("Name"), "Name")
                               .Add(Projections.Property("Address.City"), "City")
                               .Add(Projections.Property("Address.State"), "State")
                               .Add(Projections.Property("PhoneNumber"), "PhoneNumber"))
            .AddOrder(Order.Asc("Name"))
            .SetResultTransformer(NHibernate.Transform.Transformers.AliasToBean(typeof(CustomerDTO)));

        return p.List<CustomerDTO>() as List<CustomerDTO>; 
```

*请注意，我使用 .ExcludeZeroes() 来排除空值和零默认值。这是必需的，因为我的 Customer 对象有一些 INT（为简洁起见在本文中排除），在查询中默认为零 (0)，从而导致不正确的查询。*

如果我在所有字段为空白的情况下运行此程序（好的，因为它们是可选的），则生成的 SQL 如下所示：

```
SELECT   this_.Id          as y0_,
         this_.Name        as y1_,
         this_.City        as y2_,
         this_.State       as y3_,
         this_.PhoneNumber as y4_
FROM     Customers this_
WHERE    (lower(this_.Industry) like '' /* @p0 */
          and lower(this_.State) like '' /* @p1 */)
ORDER BY y1_ asc 
```

Industry 和 State 是 Web 表单中的下拉菜单，但在上面的示例中，我将它们留空。但是 ExcludeZeroes() 声明似乎不适用于这些字段。

如果我在标准之前手动检查：

```
if (customer.Address.State == "")
{
    customer.Address.State = null;
} 
```

并为工业做同样的事情，然后标准将起作用。

**我假设这与我在 Customer ctor 中初始化 Address 对象有关。我讨厌改变这一点，但我不知道另一种使标准工作的方法，而无需手动检查表单中的空字符串值（从而消除了使用带有 ICriteria 的示例对象的优势）。**

为什么？我怎样才能让这个 Criteria 查询工作？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-08-19T23:47:37.457

使用属性选择器忽略 null 或空字符串。

```
using System;
using NHibernate.Criterion;
using NHibernate.Type;

namespace Sample
{

    /// <summary>
    /// Implementation of <see cref="Example.IPropertySelector"/> that includes the
    /// properties that are not <c>null</c> and do not have an <see cref="String.Empty"/>
    /// returned by <c>propertyValue.ToString()</c>.
    /// </summary>
    /// <remarks>
    /// This selector is not present in H2.1\. It may be useful if nullable types
    /// are used for some properties.
    /// </remarks>
    public class NoValuePropertySelector : Example.IPropertySelector
    {
        #region [ Methods (2) ]

        // [ Public Methods (1) ]

        /// <summary>
        /// Determine if the Property should be included.
        /// </summary>
        /// <param name="propertyValue">The value of the property that is being checked for inclusion.</param>
        /// <param name="propertyName">The name of the property that is being checked for inclusion.</param>
        /// <param name="type">The <see cref="T:NHibernate.Type.IType"/> of the property.</param>
        /// <returns>
        ///     <see langword="true"/> if the Property should be included in the Query,
        /// <see langword="false"/> otherwise.
        /// </returns>
        public bool Include(object propertyValue, String propertyName, IType type)
        {
            if (propertyValue == null)
            {
                return false;
            }

            if (propertyValue is string)
            {
                return ((string)propertyValue).Length != 0;
            }

            if (IsZero(propertyValue))
            {
                return false;
            }
            else
            {
                return true;
            }
        }

        // [ Private Methods (1) ]

        private static bool IsZero(object value)
        {
            // Only try to check IConvertibles, to be able to handle various flavors
            // of nullable numbers, etc. Skip strings.
            if (value is IConvertible && !(value is string))
            {
                try
                {
                    return Convert.ToInt64(value) == 0L;
                }
                catch (FormatException)
                {
                    // Ignore
                }
                catch (InvalidCastException)
                {
                    // Ignore
                }
            }

            return false;
        }

        #endregion [ Methods ]
    }

} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-07-14T21:18:43.243

我对 QBE 有同样的问题。我还认为 Query by Example 是对对象（和关联）进行通用搜索的一种非常好的方法。已经有 ExcludeNones/Nulls/Zeros。也应该有一个排除空字符串（“”）的选项。

# html - 包含大量 CSS 的 HTML 表格

> ID：894297
> 
> 赞同：0
> 
> 时间：2009-05-21T18:14:04.660
> 
> 标签：html, css

我正在构建包含大量 CSS 的高级 HTML 表格，什么是构建高级 HTML CSS 表格的最佳工具，这些表格可以包含动态元素，如 AJAX 驱动功能 (jQuery)。我使用 Dreamweaver 和 Eclipse，但它们只是接触了一个非常棒的工具集来构建的表面。如果您使用了一个很棒的工具，请告诉我：-)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-21T18:18:55.773

说真的，你越接近金属，你就会越好。在 Mac 上，我使用 TextMate 编写 HTML 和 Javascript，使用 CSSEdit 编辑 CSS。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-21T18:23:18.667

有史以来最好的工具，Textpad 或 Notepad++。两者都支持多种语言的语法高亮显示、选项卡式界面等。远离首页/dreamweaver。

另外，如果我可能会问，为什么在您制作 HTML 表格时，我不希望布局？

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-21T18:27:47.487

我将第二个记事本++。Visual Studio 200x 的快捷版怎么样？你会得到一些很棒的设计工具，很棒的语法高亮，而且它是免费的。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-21T18:29:32.210

如果你想要一个好的免费 Mac 编辑器，我会选择 WordWrangler。但是，如果您想要涵盖网页设计的所有内容，请选择 Coda。

对于 PC，我使用记事本++。不像 Mac 那样流畅，但它确实允许直接从服务器进行编辑。

但就表格的 CSS 而言，您将希望自己做尽可能多的事情，因为表格在可访问性和语义标记方面是最差的，而且只能手动处理。范围、colgroups 等东西永远不会是所见即所得的，你必须对其进行微调。

这是一个很好的起点：

[http://www.noupe.com/css/21-fresh-ajax-css-tables.html](http://www.noupe.com/css/21-fresh-ajax-css-tables.html)

# pdf - 下载文件名是如何选择的，有没有办法改变它？

> ID：894298
> 
> 赞同：2
> 
> 时间：2009-05-21T18:14:46.577
> 
> 标签：pdf

我有一个不在我的服务器上的文件的链接：

```
<a href="history.nasa.gov/monograph15b.pdf">NASA</a> 
```

我想这样当访问者点击下载链接时，会弹出 PDF 的名称是 NASA.pdf，而不是 monograph15b.pdf。

这可以用任何语言实现吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-21T18:22:44.860

如果您不打算自己托管文件，则可以读取文件内容，然后使用适当的标头将这些内容直接发送到浏览器。

请注意，这会很慢，因为每次运行 PHP 页面时，您都会从 NASA 重新下载文件。

```
<?php
$filename = "http://history.nasa.gov/monograph15b.pdf";
$outputfilename = "NASA.pdf";

header("Content-Type:  application/pdf");
header("Content-Disposition:  attachment; filename=\"" . basename($outputfilename) . "\";" );
header("Content-Transfer-Encoding:  binary");
readfile("$filename");
?> 
```

这种方法还需要配置 PHP，以便[fopen()](http://us2.php.net/manual/en/function.fopen.php)可以处理通过 HTTP 读取文件。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-21T18:18:01.250

真正做到这一点的唯一方法是首先将相关文件下载到您自己的服务器上，随意命名，然后将其提供给最终用户。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-21T18:18:03.107

查看 HTTP 标头[Content-Disposition](http://www.ietf.org/rfc/rfc2183.txt)标头，它将允许您指定文件名。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-21T18:23:37.417

您需要使用任何服务器端技术，例如 ASP.NET。在页面上的哪个位置放置一个按钮。单击按钮时，它将执行以下任务。

1.）响应。清除（）；

2.) Response.AddHeader("Content-Disposition", "attachment; filename=Nasa.pdf");

3.) Response.ContentType = "application/octet-stream";

4.) Response.WriteFile(context.Server.MapPath("history.nasa.gov/monograph15b.pdf")); // 您需要为您的应用程序设置真正正确的路径。

# c - 在使用前将诸如 sockaddr_in、sockaddr_in6 和 addrinfo 之类的结构清零时，正确的是：memset、初始化程序还是其中之一？

> ID：894300
> 
> 赞同：22
> 
> 时间：2009-05-21T18:15:27.853
> 
> 标签：c, sockets, memset

每当我查看书籍、手册页和网站中的真实代码或示例套接字代码时，我几乎总是会看到如下内容：

```
struct sockaddr_in foo;
memset(&foo, 0, sizeof foo); 
/* or bzero(), which POSIX marks as LEGACY, and is not in standard C */
foo.sin_port = htons(42); 
```

代替：

```
struct sockaddr_in foo = { 0 }; 
/* if at least one member is initialized, all others are set to
   zero (as though they had static storage duration) as per 
   ISO/IEC 9899:1999 6.7.8 Initialization */ 
foo.sin_port = htons(42); 
```

或者：

```
struct sockaddr_in foo = { .sin_port = htons(42) }; /* New in C99 */ 
```

或者：

```
static struct sockaddr_in foo; 
/* static storage duration will also behave as if 
   all members are explicitly assigned 0 */
foo.sin_port = htons(42); 
```

例如，在将 struct addrinfo 提示传递给 getaddrinfo 之前将其设置为零也是如此。

为什么是这样？据我了解，不使用 memset 的示例可能与使用 memset 的示例相同，如果不是更好的话。我意识到存在差异：

*   memset 会将所有位设置为零，这不一定是将每个成员设置为 0 的正确位表示。
*   memset 还将填充位设置为零。

将这些结构设置为零时，这些差异中的任何一个是否相关或必需的行为，因此使用初始化程序是错误的？如果是这样，为什么，哪个标准或其他来源验证了这一点？

如果两者都是正确的，为什么 memset/bzero 倾向于出现而不是初始值设定项？只是风格问题吗？如果是这样，那很好，我认为我们不需要主观回答哪种风格更好。

*通常*的做法是使用初始化程序而不是 memset 正是因为通常不需要所有位为零，而是我们希望类型的正确表示为零。这些与套接字相关的结构是否相反？

在我的研究中，我发现 POSIX 似乎只需要在[http://www.opengroup.org/onlinepubs/000095399/basedefs/netinet/in.h.html](http://www.opengroup.org/onlinepubs/000095399/basedefs/netinet/in.h.html)处将 sockaddr_in6（而不是 sockaddr_in）归零，但没有提及如何它应该归零（memset 或初始化程序？）。我意识到 BSD 套接字早于 POSIX 并且它不是唯一的标准，那么它们对遗留系统或现代非 POSIX 系统的兼容性考虑是什么？

就个人而言，我更喜欢从风格（也许是良好实践）的角度使用初始化程序并完全避免 memset，但我不愿意，因为：

*   其他源代码和半规范文本，如[UNIX 网络编程](http://www.kohala.com/start/unpv12e.html)使用 bzero（例如，第 2 版的第 101 页和第 3 版的第 124 页。（我拥有两者））。
*   由于上述原因，我很清楚它们并不相同。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-05-21T18:22:34.097

部分初始化方法（即 ' `{ 0 }`'）的一个问题是 GCC 会警告您初始化程序不完整（如果警告级别足够高；我通常使用 ' `-Wall`' 并且经常使用 ' `-Wextra`'）。使用指定的初始化方法，不应该给出警告，但 C99 仍然没有被广泛使用——尽管这些部分相当广泛可用，也许在 Microsoft 的世界中除外。

我~~倾向于~~使用一种方法：

```
static const struct sockaddr_in zero_sockaddr_in; 
```

其次是：

```
struct sockaddr_in foo = zero_sockaddr_in; 
```

静态常量中初始化器的省略意味着一切都为零 - 但编译器不会机智（不应该机智）。分配使用编译器的固有内存副本，除非编译器严重不足，否则它不会比函数调用慢。

* * *

### GCC 随着时间的推移发生了变化

GCC 版本 4.4.2 到 4.6.0 生成与 GCC 4.7.1 不同的警告。具体来说，GCC 4.7.1 将`= { 0 }`初始化程序识别为“特殊情况”并且不会抱怨，而 GCC 4.6.0 等确实会抱怨。

考虑文件`init.c`：

```
struct xyz
{
    int x;
    int y;
    int z;
};

struct xyz xyz0;                // No explicit initializer; no warning
struct xyz xyz1 = { 0 };        // Shorthand, recognized by 4.7.1 but not 4.6.0
struct xyz xyz2 = { 0, 0 };     // Missing an initializer; always a warning
struct xyz xyz3 = { 0, 0, 0 };  // Fully initialized; no warning 
```

使用 GCC 4.4.2（在 Mac OS X 上）编译时，警告如下：

```
$ /usr/gcc/v4.4.2/bin/gcc -O3 -g -std=c99 -Wall -Wextra -c init.c
init.c:9: warning: missing initializer
init.c:9: warning: (near initialization for ‘xyz1.y’)
init.c:10: warning: missing initializer
init.c:10: warning: (near initialization for ‘xyz2.z’)
$ 
```

使用 GCC 4.5.1 编译时，警告是：

```
$ /usr/gcc/v4.5.1/bin/gcc -O3 -g -std=c99 -Wall -Wextra -c init.c
init.c:9:8: warning: missing initializer
init.c:9:8: warning: (near initialization for ‘xyz1.y’)
init.c:10:8: warning: missing initializer
init.c:10:8: warning: (near initialization for ‘xyz2.z’)
$ 
```

使用 GCC 4.6.0 编译时，警告是：

```
$ /usr/gcc/v4.6.0/bin/gcc -O3 -g -std=c99 -Wall -Wextra -c init.c
init.c:9:8: warning: missing initializer [-Wmissing-field-initializers]
init.c:9:8: warning: (near initialization for ‘xyz1.y’) [-Wmissing-field-initializers]
init.c:10:8: warning: missing initializer [-Wmissing-field-initializers]
init.c:10:8: warning: (near initialization for ‘xyz2.z’) [-Wmissing-field-initializers]
$ 
```

使用 GCC 4.7.1 编译时，警告是：

```
$ /usr/gcc/v4.7.1/bin/gcc -O3 -g -std=c99 -Wall -Wextra  -c init.c
init.c:10:8: warning: missing initializer [-Wmissing-field-initializers]
init.c:10:8: warning: (near initialization for ‘xyz2.z’) [-Wmissing-field-initializers]
$ 
```

上面的编译器是我编译的。Apple 提供的编译器名义上是 GCC 4.2.1 和 Clang：

```
$ /usr/bin/clang -O3 -g -std=c99 -Wall -Wextra -c init.c
init.c:9:23: warning: missing field 'y' initializer [-Wmissing-field-initializers]
struct xyz xyz1 = { 0 };
                      ^
init.c:10:26: warning: missing field 'z' initializer [-Wmissing-field-initializers]
struct xyz xyz2 = { 0, 0 };
                         ^
2 warnings generated.
$ clang --version
Apple clang version 4.1 (tags/Apple/clang-421.11.65) (based on LLVM 3.1svn)
Target: x86_64-apple-darwin11.4.2
Thread model: posix
$ /usr/bin/gcc -O3 -g -std=c99 -Wall -Wextra -c init.c
init.c:9: warning: missing initializer
init.c:9: warning: (near initialization for ‘xyz1.y’)
init.c:10: warning: missing initializer
init.c:10: warning: (near initialization for ‘xyz2.z’)
$ /usr/bin/gcc --version
i686-apple-darwin11-llvm-gcc-4.2 (GCC) 4.2.1 (Based on Apple Inc. build 5658) (LLVM build 2336.11.00)
Copyright (C) 2007 Free Software Foundation, Inc.
This is free software; see the source for copying conditions.  There is NO
warranty; not even for MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.

$ 
```

正如[SecurityMatt](https://stackoverflow.com/users/1250976/securitymatt)在下面的评论中所指出的，`memset()`从内存中复制结构的优势在于从内存中复制的成本更高，需要访问两个内存位置（源和目标）而不仅仅是一个。相比之下，将值设置为零不必访问内存以获取源代码，并且在现代系统上，内存是一个瓶颈。因此，`memset()`对于简单的初始化程序，编码应该比复制更快（相同的值，通常都是零字节，被放置在目标内存中）。如果初始值设定项是值的复杂组合（并非全为零字节），那么平衡可能会更改为有利于初始值设定项，以保证符号的紧凑性和可靠性（如果没有别的）。

没有一个简单的答案......可能从来没有，现在也没有。我仍然倾向于使用初始化器，但`memset()`通常是一个有效的替代方案。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-21T18:22:59.853

“结构 sockaddr_in foo = { 0 };” 仅在第一次有效，而 "memset(&foo, 0, sizeof foo);" 每次运行函数时都会清除它。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2011-06-07T02:52:30.207

我会说这两者都不正确，因为您永远不应该自己创建`sockaddr_`*任何*类型的对象。相反，总是使用`getaddrinfo`（或有时`getsockname`或`getpeername`）来获取地址。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-21T18:22:32.833

正如许多人指出的那样，任何一个都是正确的。此外，您可以使用已经返回零内存块的[calloc](http://www.opengroup.org/onlinepubs/000095399/functions/calloc.html)分配这些结构。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-21T18:31:17.683

任何一种方法都不应该有问题——填充字节的值应该无关紧要。我怀疑 memset() 的使用源于伯克利主义 bzero() 的早期使用，它可能早于结构初始化程序的引入或更有效。

# authentication - Kerberos 的感知/实际优势是什么？该技术是否有任何可行的替代方案？

> ID：894301
> 
> 赞同：1
> 
> 时间：2009-05-21T18:15:39.837
> 
> 标签：authentication, protocols, network-protocols, kerberos

我们计划在我们的架构中使用 kerberos。我想知道这项技术有哪些感知或实际优势，以及是否有任何替代方案。

请注意，我们有一个 .net 客户端和 java 服务器端。通信将通过消息总线和 SOA

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-21T18:35:39.390

如果您在主要是 Windows 环境中工作（即 Windows Server 2k3、域控制器、Active Directory 等），特别是您可以通过 .NET 使用分离的 Web 服务器和数据库服务器进行[**模拟。**](http://www.dotnet-guide.com/impersonation.html)使用较旧的 NTLM 方法，您不能执行“双跳”。

* * *

让我们看一个例子：

*   您有一个 Web 服务器 (WEB1)
*   您在单独的机器 (DB1) 上有一个数据库服务器
*   您有一个用户访问您的网站 (USER1)

USER1 点击显示订单列表的页面。您的 WEB1 服务器必须向 DB1 查询此信息才能显示在页面上。您希望根据用户的凭据和访问权限来限制看到的订单。因此，您可以设置活动目录组并相应地分配用户。在您的数据库上，您为不同的组提供不同的安全性（例如，GROUP1 可能只有选择，而 GROUP2 可能会获得选择、插入和更新）。

NTLM 不支持执行此操作所需的双跳。WEB1 必须将 USER1 的凭据发送到 DB1（否则 WEB1 必须使用硬编码到 web.config 中的已知专用用户 ID 和密码登录 DB1，例如，通常必须具有完全访问权限才能支持所有可能的用户角色）。您可以想象，如果 WEB1 受到威胁，这可能是一个安全隐患，所以您不能这样做，否则任何获得 WEB1 控制权（可能通过 sql 注入）的人都可以做任何专用用户帐户可以做的事情，或者冒充他们想要的任何人。Kerberos 通过 Windows Server 上的委托，支持通过保持来自域服务器的加密凭据密钥完整并传递来执行第二个跃点，并验证这是允许的（在两端，

在开发具有数据库后端的 Intranet Web 应用程序（99% 的情况下，对吗？）并且您希望通过 Windows 集成安全性控制授权和身份验证时，这样做非常有用。除非您的 Web 服务器和数据库服务器在同一台机器上，否则 Kerberos 确实是您唯一的选择，这意味着无需传输凭据，也无需进行模拟。

也可以看看：

*   [MSDN - 如何：在 ASP.NET 2.0 中使用模拟和委派](http://msdn.microsoft.com/en-us/library/ms998351.aspx)
*   [Microsoft 帮助和支持 - 如何为委派方案配置 ASP.NET 应用程序](http://support.microsoft.com/default.aspx?scid=kb;en-us;810572)
*   [MSDN 杂志 - 安全简介：凭据和委派](http://msdn.microsoft.com/en-us/magazine/cc163740.aspx)

# specifications - 如何为网站编写规范

> ID：894306
> 
> 赞同：10
> 
> 时间：2009-05-21T18:17:33.297
> 
> 标签：specifications

当我开始为 web 开发时，我注意到在客户和我之间有一个清楚地列出他们想要什么的文档将对双方都非常有帮助。在阅读了 Joel 的一些建议之后，做任何没有规范的事情都是一件令人头疼的事情，当然除非您按小时计费；）

1.  在那些有经验的人中，什么是从客户那里提取关于他们希望他们的网站做什么以及它的外观的所有可能信息的好方法？避免功能蔓延的好方法？

2.  我应该注意哪些网络特定要求？（也许是平面设计）

3.  你用什么来写你的规范？

4.  还有什么其他人应该知道的吗？

谢谢！

Ps：对于“StackOverflow Purists”，如果我的问题很糟糕，我愿意反馈如何改进它，而不是投反对票和“你的问题很糟糕”的评论

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-05-21T18:21:55.610

取决于网站的目标。如果是推销客户发布的新产品的网站，则更容易缩小规格，如果是一般网站，则来回很多。

概述以下内容：

*   网站/重新设计的目标是什么。
*   客户群的预期增长是多少？
*   客户保留的目标是什么？
*   目标人群是什么？
*   从一开始就勾勒出所有的交互元素——flash/电影/游戏。
*   概述 IA，与客户坐下来，概述他们想要的所有部分。想想如何组织它并将其带回给他们。
*   以书面形式获取所有更改。
*   在开始开发之前做好所有规范准备，以避免最后一分钟的更改。

一些通用指针

*   要有礼貌，但不要太随和。如果客户要求一些不可能的事情，请以礼貌的方式让他们知道。不要说你做不到，说在规定的时间和预算内不可能做到。
*   避免将您的想法与知名公司网站进行比较。不要说你的搜索功能会像谷歌，因为你为你的程序设定了用户习惯的某种标准。
*   在您从事的任何工作领域都遵循标准。这将确保代码不仅易于后期维护，还可以避免出现错误的机会。
*   强调自己和客户的可及性，这是一件**大事**。

更多东西：

*   不要害怕表达你的意见。当然，客户有钱，也可以决定是否与你合作——所以要有礼貌。但不要推脱，你一直在这个行业，你知道它是如何运作的，所以让他们知道什么会奏效，什么不会。
*   如果客户偶然发现了你的技术解释，不要以为他们是愚蠢的，他们只是在另一个行业。
*   引导客户远离陈词滥调和流行语。除非您牢记确切的功能，否则请避免使用诸如“ajax”和“web 2.0”之类的词。
*   正如我上面所说，确保在开始工作之前计划好一切。如果该站点是交互式的，则必须确保所有内容都网格在一起。当该站点被逐个构思时，请相信我，这是显而易见的。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-21T18:29:43.193

我在许多软件设计情况（不仅仅是网站设计）中看到的一条建议与用户期望有关。有些人通过给用户一些可以看到的东西来很好地管理它们，同时确保用户不相信他们所看到的东西实际上可以工作。

纸质原型对这种情况有很大帮助：[http ://en.wikipedia.org/wiki/Paper_prototyping](http://en.wikipedia.org/wiki/Paper_prototyping)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-21T19:21:05.803

我正在使用纸质原型，但使用 iplotz.com 来制作它，这离我们还很远。它使您可以更详细地考虑应用程序应该如何工作，从而减少错过您需要构建的某些东西的可能性，并且可以更容易地向客户解释您的想法。您也可以要求客户使用 iplotz 向您说明需求，或配合。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-26T23:53:31.217

我还发现在谷歌上寻找客户问卷是一个好主意，可以帮助产生更多想法：

谷歌：[web客户端问卷](http://www.google.com/search?q=web+client+questionnaire&hl=en&client=firefox-a&rls=org.mozilla:en-US:official&hs=Dgl&start=10&sa=N)，有几十种pdf等形式可以借鉴

# php - 显示定义 PHP 类的 NetBeans

> ID：894309
> 
> 赞同：0
> 
> 时间：2009-05-21T18:17:44.840
> 
> 标签：php, netbeans

我正在使用 NetBeans 进行 PHP 编程。大多数情况下，查找类声明非常聪明，尤其是在同一个项目中找到它们时。但有时它只是拒绝找到类的定义，例如 PEAR 库的类。有没有办法让我手动向 NetBeans 展示某个类是在哪里定义的，并享受自动完成带来的乐趣？

我正在使用 NetBeans 6.7 Beta

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-21T19:34:30.567

在我的系统上，我已将我的 PHP 包含路径添加到 Netbeans 全局包含路径。

工具 -> 选项 -> PHP 选项卡

通常，如果一个类在同一个项目中，则当 Netbeans 扫描整个项目时，该引用将可用。

我正在使用 Netbeans 6.5，所以在这一点上我可能会建议它是 beta 中的一个错误。

您是否有不寻常的文件夹结构或奇怪的类名？

# objective-c - 单击时如何使按钮显示菜单？

> ID：894313
> 
> 赞同：1
> 
> 时间：2009-05-21T18:18:12.170
> 
> 标签：objective-c, cocoa

我正在寻找一些代码，以在单击按钮时使菜单出现在按钮旁边。我需要什么代码？

对不起，如果这听起来有点模糊。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-21T18:28:13.697

为什么不使用 NSPopUpButton？

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-21T22:25:28.177

NSPopupButton 也是我的第一个想法。这就是带有“动作齿轮”按钮的应用程序如何完成它们的菜单。

如果您确实有其他想法，请查看 NSMenu 的`+popUpContextMenu:withEvent:forView:`. `currentEvent`只需将一个操作方法连接到您的按钮，创建一个 NSMenu 并使用 NSMenuItems 填充它，然后将其从 NSApplication 的getter沿着当前事件发送到此方法。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-21T20:52:11.923

如果您真的需要自己滚动，而不是使用显示菜单的内置控件之一，您可以创建一个 NSPopupButtonCell 并使用它来显示 NSMenu：

```
NSPopUpButtonCell *popupCell = [[NSPopUpButtonCell alloc] initTextCell:@"" pullsDown:YES];
[popupCell setMenu:yourMenu];
[popupCell trackMouse:event inRect:[yourButton bounds] ofView:yourButton untilMouseUp:YES];
[popupCell release]; 
```

您需要根据需要调整 pullsDown:、inRect: 和 ofView: 参数，以按照您想要的方式定位菜单。

# c# - 匿名类型作为方法参数

> ID：894314
> 
> 赞同：1
> 
> 时间：2009-05-21T18:18:19.910
> 
> 标签：c#, .net, anonymous-types

我第一次尝试使用匿名类型（测试）：

```
 private void button4_Click(object sender, EventArgs e)
    {
        test(new { a = "asd" });
    }

    private void test(string a)
    {
    } 
```

我收到一个错误“无法从 'AnonymousType#1' 转换为 'string'”

如果参数是字符串[]，我也想知道如何传递匿名类型

```
 private void test(string[] a)
    {
    } 
```

提前致谢！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-21T18:20:52.040

你的设计有问题。如果您的测试函数只接受字符串，那么您永远不能将匿名类型传递给它，就像您不能传递 int、object 或任何其他非字符串类型一样。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-21T18:21:11.727

a 是匿名类型的字符串属性

```
private void button4_Click(object sender, EventArgs e)
{
    test((new { a = "asd" }).a);
}

private void test(string a)
{
} 
```

编辑：匿名类型不派生自对象以外的任何东西，因此您无法创建需要匿名类型参数的方法。

编辑 2：当您创建匿名类型时，编译器会根据您设置的属性和它们出现的顺序创建一个全新的类型。您不能创建匿名类型并使用它来代替任何其他类型（对象除外）。我使用它们的最常见场景是在您需要展平对象图时进行绑定。

警告，我很难想出很好的示例场景，这一切都来自记忆！例如，如果我有一个 Person 对象列表，该列表具有 name 属性和 address 属性，其中包含街道地址并需要绑定到列表框

```
var people = new List<Person>()
listbox.TextMember = "Text";
listbox.ValueMember = "Value"
listbox.DataSource = from p in people 
select new { Text = p.Name, Value = p.Address.StreetAddress }; 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-21T18:20:44.023

在方法之间传递匿名类型没有干净的方法；你不应该这样做。而是创建一个真实的类型。

如果您真的想这样做，您可以使用辅助方法来笨拙地伪造它，方法是创建另一个该类型的“模板”以便稍后转换；看到[这个](http://tomasp.net/blog/cannot-return-anonymous-type-from-method.aspx)和许多类似的文章。

**编辑：** 仔细检查后，您似乎并不了解匿名类型实际上是什么，所以我建议您采用其他答案。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-11-12T12:41:40.787

刚刚偶然发现这个过时的问题，并认为这里有人应该提到[`dynamic`](https://msdn.microsoft.com/en-us/library/dd264736.aspx)从 C# 4.0 开始使用的可能性，它非常适合使用匿名类型。即代码可能如下所示：

```
private void button4_Click(object sender, EventArgs e)
{
    test(new { a = "asd" });
}

private void test(dynamic obj)
{
    Console.WriteLine(obj.a);
} 
```

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2009-05-21T18:24:09.710

这很糟糕，但它有效......

```
namespace AnonType
{
    class Program
    {
        static void Main(string[] args)
        {
            var foo = new { a = "123", b = "abc" };

            Anon(foo);
            Console.ReadLine();
        }

        public static void Anon(object o)
        {
            Console.WriteLine(o);
        }
    }
} 
```

# python - setuptools 如何决定为 sdist/bdist 保留哪些文件？

> ID：894323
> 
> 赞同：6
> 
> 时间：2009-05-21T18:19:08.660
> 
> 标签：python, setuptools, distutils

我正在开发一个在 setup.py中使用`namespace_packages`和类似的 Python 包：`find_packages()`

```
from setuptools import setup, find_packages
setup(name="package",
    version="1.3.3.7",
    package=find_packages(),
    namespace_packages=['package'], ...) 
```

它不在源代码控制中，因为它是一组上游组件。没有清单。

当我运行时，`python setup.py sdist`我得到了`package/`目录下大多数文件的压缩包，但任何不包含`.py`文件的目录都被排除在外。

`setup.py`构建发行版中包含和排除的内容的默认规则是什么？我通过添加`MANIFEST.in`with解决了我的问题

```
recursive-include package * 
```

但我想了解 setuptools 和 distutils 默认在做什么。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-21T18:22:38.213

您需要添加一个 package_data 指令。例如，如果要包含扩展名为 .txt 或 .rst 的文件：

```
from setuptools import setup, find_packages
setup(name="package",
    version="1.3.3.7",
    package=find_packages(),
    include_package_data=True,
    namespace_packages=['package'], 
     package_data = {
        # If any package contains *.txt or *.rst files, include them:
        '': ['*.txt', '*.rst']...

) 
```

# performance - 使用 1.6 JVM 的 SPARC 硬件上的 64 位与 32 位性能

> ID：894326
> 
> 赞同：4
> 
> 时间：2009-05-21T18:20:06.940
> 
> 标签：performance, 64-bit, jvm, 32-bit, sparc

我正在为我们在 SPARC 硬件上运行的 Tomcat 集群进行性能调整。32 位 JVM 目前为我们提供了足够的内存，但我们将开始使用 Terracotta 进行服务器条带化，因此很快就会需要 64 位 JVM 提供的额外内存。

除了更大的内存占用之外，迁移到 SPARC 上的 64 位 JVM 还会导致性能下降。此常见问题解答显示 SPARC 上 64 位 JVM 的 1.4 版性能下降了 10% - 20%：

[http://java.sun.com/docs/hotspot/HotSpotFAQ.html#64bit_performance](http://java.sun.com/docs/hotspot/HotSpotFAQ.html#64bit_performance)

如果可以避免的话，我对性能降低 10% - 20% 不感兴趣。已经讨论过使用 32 位/64 位混合方法来避免此问题，因此 1.6 JVM 可能没有 1.4 JVM 所具有的性能影响：

[http://blog.juma.me.uk/2008/10/14/32-bit-or-64-bit-jvm-how-about-a-hybrid/](http://blog.juma.me.uk/2008/10/14/32-bit-or-64-bit-jvm-how-about-a-hybrid/)

是否有人在 SPARC 上使用 1.6 版从 32 位 JVM 迁移到 64 位 JVM 的当前性能指标？

谢谢。

院长

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-06-18T16:44:59.007

以下是一些基于测试客户端调用我们在 Solaris 上的 Tomcat 5.5 上使用 64 位和 32 位版本的 JDK 1.6.0_13 运行的 Web 服务的一些结果。

在 Tomcat 5.5 上使用默认设置时，64 位 JVM 导致性能下降约 7%。当我将 Tomcat 参数 acceptCount 和 maxThreads 加倍到 1000 时，64 位 JVM 的性能下降不到 1%。这可能是因为 1000 个线程对应于我在测试中使用的并发测试客户端的数量。

更改这些参数降低了 32 位和 64 位 JVM 的时间，但 64 位 JVM 显示出更大的性能改进。

不过，您的里程可能会有所不同。

# visual-studio - 在 Visual Studio C++ (Win32) 项目中同步版本资源

> ID：894329
> 
> 赞同：4
> 
> 时间：2009-05-21T18:20:36.643
> 
> 标签：visual-studio, version

我有一个包含大约 8 个独立项目的解决方案，每次我对整个解决方案进行发布构建时，我都需要确保每个项目的二进制输出的版本字符串是相同的。有没有一种简单的方法来同步项目资源文件的 VS_VERSION_INFO 部分？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-05-21T18:43:52.977

我不知道这是您想要的方式，但`.rc`文件允许包含，您可以使用`#define`版本块中的值

**在头文件中定义版本号**

```
 #define VER_MAJOR 8
#define VER_MINOR 00
#define VER_BUILD_HI    00
#define VER_BUILD_LO 021
#define VER_FLAGS   VS_FF_PRERELEASE

// The Binary form of the version numbers
#define VER_FILE    VER_MAJOR, VER_MINOR, VER_BUILD_HI, VER_BUILD_LO
#define VER_PRODUCT VER_MAJOR, VER_MINOR, 0, 0

#define VER_STR(arg) #arg

// The String form of the version numbers
#define VER_FILE_STRING VALUE "FileVersion", "8.0\0"
#define VER_PRODUCT_STRING VALUE "ProductVersion", "8.0\0" 
```

**在`VS_VERSION_INFO`块中使用它们**

```
 #include "bversion.h" //#define values in here

VS_VERSION_INFO VERSIONINFO
 FILEVERSION **VER_FILE**
 PRODUCTVERSION **VER_PRODUCT**
 FILEFLAGSMASK 0x2fL
#ifdef _DEBUG
 FILEFLAGS 0x1L
#else
 FILEFLAGS 0x0L
#endif
 FILEOS 0x4L
 FILETYPE 0x1L
 FILESUBTYPE 0x0L
BEGIN
    BLOCK "StringFileInfo"
    BEGIN
        BLOCK "040904b0"
        BEGIN
            VALUE "Comments", "\0"
            VALUE "CompanyName", "XXX\0"
            VALUE "FileDescription", "YYY\0"
            **VER_FILE_STRING**
            VALUE "InternalName", "ZZZ\0"
            VALUE "LegalCopyright", "© 2009 PDQ.\0"
            VALUE "LegalTrademarks", "AAA\0"
            VALUE "OriginalFilename", "BBB.EXE\0"
            VALUE "PrivateBuild", "\0"
            VALUE "ProductName", "CCC\0"
            **VER_PRODUCT_STRING**
            VALUE "SpecialBuild", "\0"
        END
    END
    BLOCK "VarFileInfo"
    BEGIN
        VALUE "Translation", 0x409, 1200
    END
END 
```

在所有项目中引用一个头文件并在每次构建之前更改它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-21T18:24:21.957

我们使用 FinalBuilder 进行构建，让它通过文件（作为文本文件）并使用正确的版本信息更新它们。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-21T18:29:35.703

实现这一点的最简单方法是使用预构建步骤，该步骤为所有资源文件调用某种类型的脚本（sed/awk、PowerShell 等），并在适当的位置放入正确的值。如果您使用 SVN，那么来自 TortoiseSVN 发行版的 SubWCRev 也可以用于此部分，并且可以自动使用您的存储库中的修订号作为版本字符串。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-09-12T03:38:15.100

[您可以使用ResourceLib](http://resourcelib.codeplex.com/)编写一些代码来执行此操作，或者采用[为您执行此操作的构建过程](http://code.dblock.org/ShowPost.aspx?id=19)。

# jquery - 请帮助：这个功能不能很好地与 jQuery 一起使用

> ID：894333
> 
> 赞同：1
> 
> 时间：2009-05-21T18:21:27.890
> 
> 标签：jquery, plugins

我的网站上有这个功能（netwaver.com/projects/featured-content-gallery-pligg-module/），但它不适用于 jQuery 插件。我在网上研究和阅读，它说要改变“$”。有人可以帮我解决这个问题吗？

但是“$”符号在里面是这样的：{$featurify}..这将如何工作？我看到的所有例子都是在外面显示 $ 符号

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-21T18:26:30.140

他们可能意味着启用 jQuery 的[无冲突模式](http://docs.jquery.com/Using_jQuery_with_Other_Libraries)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-21T18:29:05.957

命名冲突是因为`$`是`jQuery`. 您需要致电：

```
jQuery.noConflict(); 
```

然后，一旦你这样做了，你需要确保你在不使用“$”的情况下调用 jQuery

更多选项和讨论在这里：[http](http://docs.jquery.com/Using_jQuery_with_Other_Libraries) ://docs.jquery.com/Using_jQuery_with_Other_Libraries 。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-21T18:29:16.640

```
var j = $.noConflict(); 
```

在导致冲突的库之后添加要加载的 jQuery 库。然后运行这段代码。现在应该可以通过 j 访问 jQuery，例如：

```
j('.class').test(); 
```

# domain-driven-design - 如何向联合程序员介绍领域驱动设计？

> ID：894349
> 
> 赞同：2
> 
> 时间：2009-05-21T18:23:47.590
> 
> 标签：domain-driven-design

明天我需要展示关于 DDD 方法的小演示。

它应该包含两个要点：
“什么是领域驱动设计？”
“我们怎么用？”

如果我能看到一些想法如何“实现”我的“演示界面”的第一点，我会很高兴。

问是因为我不是每天都做演示，而且我有点困惑。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-21T18:57:14.010

有点难以理解您的问题是缺乏 DDD 知识，还是只是如何呈现它。

[“什么是领域驱动设计”- 从http://www.infoq.com/minibooks/domain-driven-design-quickly](http://www.infoq.com/minibooks/domain-driven-design-quickly)获取一个很好的概述

“我们如何使用它”。你不能真的只是“使用它”。您必须确定对您的业务有意义的部分。

*   您可以充分利用对理解和建模业务的高度关注，并在语音、代码和文档中创建通用语言。
*   您可以使用与软件架构相关的想法，例如使用存储库、实体和值对象。
*   您可以注意良好设计和代码质量的原则，如意图揭示接口、无副作用功能等。
*   您可以尝试传递重构知识以及与更大系统相关的策略。

有些在概念理解上是唾手可得的成果，有些则很难在没有个人兴趣的情况下强加。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-21T18:41:34.917

阿米斯，

是将当前幻灯片翻译成您的需要（它在葡萄牙语-巴西）->[幻灯片](http://www.slideshare.net/rponte/entendendo-domaindriven-design)

说明 DDD 不是一种技术或方法，而更像是一种收集各种概念、技术和原则的方法，重点是领域逻辑。

解释普遍存在的语言、分层架构、领域模式以及有关当前方法和 ddd 方法的差异，然后介绍使用 DDD 优于当前方法的好处，并在您的演示文稿中添加一个结论。

希望它对你有所帮助。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-21T22:46:12.020

**[这张](http://hinchcliffe.org/archive/2005/03/20/189.aspx)**思维导图整理了我的思路。

# actionscript - 在动作脚本中恢复透明

> ID：894356
> 
> 赞同：0
> 
> 时间：2009-05-21T18:24:24.700
> 
> 标签：actionscript

当我有一个影片剪辑时，它一开始是透明的。我可以在这个影片剪辑上绘图，基本上生成一个透明图像。也就是说，在我还没有画的地方，显示下面的图层，在我画的地方，它显示我刚刚画的。

问题是，如何“取消”这个电影剪辑中的东西，以便我可以看到它背后的东西。我知道我可以擦除影片剪辑，但是有没有办法取消绘制影片剪辑的某些部分以使其恢复透明？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-21T18:28:31.027

您可以使用另一个影片剪辑作为蒙版。我认为它是 MovieClip 中的 setMask() 将另一个电影剪辑设置为它的掩码。然后您可以在蒙版动画剪辑上绘制您想要显示的区域。不幸的是，在 AS2 中，您只能使用矢量形状作为蒙版。

# windows - 是否有类似 TortoiseSVN 的 git-svn windows 客户端？

> ID：894360
> 
> 赞同：39
> 
> 时间：2009-05-21T18:26:05.523
> 
> 标签：windows, svn, tortoisesvn, git-svn

我喜欢 TortoiseSVN 的 Windows 集成。处理 git-svn 有类似的东西吗？如果访问速度足够快，我什至会使用集成度较低的 GUI。我不想要的是 CLI，因为我很少会在正确的目录中看到命令提示符。

* * *

[这是一个相关的问题](https://stackoverflow.com/questions/371682/is-there-an-acceptable-gui-client-for-git-svn)，但对于 Linux

* * *

## 回答 #1

> 赞同：32
> 
> 时间：2009-07-07T07:01:42.597

TortoiseGit ( [https://tortoisegit.org/](https://tortoisegit.org/) ) 在 0.8.1.0 版本中添加了对 git-svn 的基本支持：

发布日志说：

*添加基本​​ Git-SVN 操作：*

*   添加 SVN DCommit 命令

*   在 shell 上下文菜单中添加“SVN Rebase”和“SVN DCommit”命令

*   在克隆对话框中支持 Git svn-clone。

* * *

## 回答 #2

> 赞同：28
> 
> 时间：2009-05-21T19:13:37.130

看看[TortoiseGit](https://tortoisegit.org/)，它是 Git 的 TortoiseSVN 克隆。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2009-05-21T18:34:19.737

我发现最简单的方法是使用`git gui`, 并在 Tools 菜单中添加`git svn dcommit`and`git svn rebase`命令。

如果您安装 msysGit，它甚至会在您的上下文菜单中放置一个“Git GUI here”命令。

这样做的好处是除了 git 本身不需要任何其他软件，并且可以在 git (gui) 运行的每个平台上运行。

**编辑：**我应该提到，这正是我几个月来一直有效地使用 git 对抗我们的 svn-repos 的方式。工作得很好。在 Windows、Linux 上也是如此。因此，根据操作系统的不同，无需为同一工作使用不同的工具。

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2011-02-12T14:30:49.557

试试 SmartGit ，它几乎拥有控制台的所有功能，而且它的图形用户界面很棒。[http://www.syntevo.com/index.html](http://www.syntevo.com/index.html)

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2010-02-22T01:01:47.923

一个侧面且非常晚的答案，但可能对后来的观众有用，说明您为什么不想要 CLI；假设您使用的是 XP，请在此处安装 Microsoft[命令提示符 Powertoy](http://www.microsoft.com/windowsxp/Downloads/powertoys/Xppowertoys.mspx)，它会为您提供文件夹上的资源管理器右键单击快捷方式。我用它所有的时间。Windows 7 具有开箱即用的功能，但您必须在右键单击时按住一些键，我认为.. shift 或 alt 之类的。

此外，Tortoisegit 现在显然具有 git-svn 功能，我将检查它们..

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2013-10-16T04:05:40.313

[您可以使用 TortoiseSVN 本身](https://github.com/blog/626-announcing-svn-support)。我就是做这个的。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2013-09-19T10:25:42.100

使用 git local 和 svn 作为服务器的最佳 GUI 工具是syntevo的[SmartGitHg （适用于 Windows、Lunux 和 OS X）。](http://www.syntevo.com/smartgithg/)对于 OS X，您还可以使用Atlassian 的[SourceTree](http://sourcetreeapp.com/)。Windows 版本的 SourceTree 不支持 SVN。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2012-10-11T15:13:54.643

在使用服务器端 Git-SVN 同步设置时，可以使用任何 Git 客户端。看看[SubGit](http://subgit.com)来实现这一点。

必须将 SubGit 安装到 Subversion 存储库中：

```
$ subgit configure $SVN_REPOS
# Adjust $SVN_REPOS/conf/subgit.conf to specify your branches and tags
# Adjust $SVN_REPOS/conf/authors.txt to specify git & svn authors mapping
$ subgit install $SVN_REPOS
...
$ INSTALLATION SUCCESSFUL 
```

SubGit 将 Subversion 存储库转换为 Git（它也以相反的方向工作）并安装 SVN 和 Git 挂钩。这些钩子是由触发的`svn commit`，`git push`因此所有传入的修改都会立即相应地复制到 Git 或 SVN。有关详细信息，请参阅[SubGit 文档](http://subgit.com/documentation)和[git-svn](http://subgit.com/documentation/gitsvn.html)比较。

从 2.0 版开始（发布时尚未发布）SubGit 允许同步位于不同主机上的 Subversion 和 Git 存储库。

SubGit 是一个商业工具。它对开源、学术和小型项目（最多 10 个提交者）是免费的。

全面披露：我是 SubGit 开发人员之一。

* * *

## 回答 #9

> 赞同：-2
> 
> 时间：2015-08-31T16:52:36.120

过去我没有见过最好的工具，比如 gui，但 Git 现在已经做了一些非常有用和简单的尝试 Git Desktop for windows： [https ://desktop.github.com/](https://desktop.github.com/)

# c# - .Net Windows Forms - 在等待异步工作时限制表单导航

> ID：894363
> 
> 赞同：1
> 
> 时间：2009-05-21T18:26:35.087
> 
> 标签：c#, .net, winforms, asynchronous

单击按钮时，会在后台工作人员中执行查询。它是异步的，因此我可以将按钮更改为“取消”，以便用户可以在进程运行时间超过预期时取消该进程。这一切都很好。

但是，我不希望用户能够离开此位置以在表单上执行其他操作。他们必须能够单击“取消”按钮或关闭表单，但仅此而已。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-21T18:29:16.097

然后我建议您在开始处理查询时禁用表单上的其他控件，并在后台工作人员完成后重新启用它们。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-21T18:33:11.157

最好的方法是创建一个像 DisableControls() 这样的方法，其中包含所有其他控件的禁用命令。

异步工作完成后，在回调中，调用 EnableControls() 之类的方法来反转该过程。

# activex - 此页面上的 activex 控件可能不安全

> ID：894369
> 
> 赞同：8
> 
> 时间：2009-05-21T18:28:31.010
> 
> 标签：activex

我在 C# 中创建了一个 com 组件，我使用 Regasm 注册了该组件。我现在可以通过使用 ActiveXObject(...) 在 IE 中使用它。但是，这仅在我更改 IE 安全设​​置并允许运行未签名的 activex 控件时才有效，在这种情况下，我会收到以下消息：

> 此页面上的 ActiveX 控件与页面的其他部分交互可能不安全。你想允许这种交互吗？

我一直希望 IE 在没有提示的情况下允许这种交互。有谁知道如何做到这一点？

谢谢

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-21T18:43:28.500

您的 ActiveX 控件必须实现 IObjectSafety 接口才能让 IE 停止显示“不安全？” 迅速的。几年前我为一个 VB6 ActiveX 控件做了这个。在[此页面](http://www.olavaukan.com/2010/08/creating-an-activex-control-in-net-using-c/)的第 5 步中，展示了如何在 .Net 中执行此操作。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-24T11:09:44.927

我已经遇到过这个问题。经过长途跋涉，我解决了这个问题。在你的 activeX 类中，只需继承 IObjectSafety 类。见下图： ![在此处输入图像描述](https://i.stack.imgur.com/cg07I.jpg)

IObjectSafety 类给出如下：

```
 [ComImport, GuidAttribute("CB5BDC81-93C1-11CF-8F20-00805F2CD064")]
[InterfaceTypeAttribute(ComInterfaceType.InterfaceIsIUnknown)]
public interface IObjectSafety
{
    [PreserveSig]
    int GetInterfaceSafetyOptions(ref Guid riid,[MarshalAs(UnmanagedType.U4)] ref int pdwSupportedOptions,[MarshalAs(UnmanagedType.U4)] ref int pdwEnabledOptions);

    [PreserveSig()]
    int SetInterfaceSafetyOptions(ref Guid riid,[MarshalAs(UnmanagedType.U4)] int dwOptionSetMask,[MarshalAs(UnmanagedType.U4)] int dwEnabledOptions);
}
public class IObjectSafetyImpl : IObjectSafety
 {
     private const string _IID_IDispatch = "{00020400-0000-0000-C000-000000000046}";
     private const string _IID_IDispatchEx = "{a6ef9860-c720-11d0-9337-00a0c90dcaa9}";
     private const string _IID_IPersistStorage = "{0000010A-0000-0000-C000-000000000046}";
     private const string _IID_IPersistStream = "{00000109-0000-0000-C000-000000000046}";
     private const string _IID_IPersistPropertyBag = "{37D84F60-42CB-11CE-8135-00AA004BB851}";

     private const int INTERFACESAFE_FOR_UNTRUSTED_CALLER = 0x00000001;
     private const int INTERFACESAFE_FOR_UNTRUSTED_DATA = 0x00000002;
     private const int _OK = 0;
     private const int _FAIL = unchecked((int)0x80004005);
     private const int _NOINTERFACE = unchecked((int)0x80004002);

     private bool _fSafeForScripting = true;
     private bool _fSafeForInitializing = true;

     public int GetInterfaceSafetyOptions(ref Guid riid, ref int pdwSupportedOptions, ref int pdwEnabledOptions)
     {
         int Result = _FAIL;

         string strGUID = riid.ToString("B");
         pdwSupportedOptions = INTERFACESAFE_FOR_UNTRUSTED_CALLER | INTERFACESAFE_FOR_UNTRUSTED_DATA;
         switch (strGUID)
         {
             case _IID_IDispatch:
             case _IID_IDispatchEx:
                 Result = _OK;
                 pdwEnabledOptions = 0;
                 if (_fSafeForScripting == true)
                     pdwEnabledOptions = INTERFACESAFE_FOR_UNTRUSTED_CALLER;
                 break;
             case _IID_IPersistStorage:
             case _IID_IPersistStream:
             case _IID_IPersistPropertyBag:
                 Result = _OK;
                 pdwEnabledOptions = 0;
                 if (_fSafeForInitializing == true)
                     pdwEnabledOptions = INTERFACESAFE_FOR_UNTRUSTED_DATA;
                 break;
             default:
                 Result = _NOINTERFACE;
                 break;
         }

         return Result;
     }

     public int SetInterfaceSafetyOptions(ref Guid riid, int dwOptionSetMask, int dwEnabledOptions)
     {
         int Result = _FAIL;

         string strGUID = riid.ToString("B");
         switch (strGUID)
         {
             case _IID_IDispatch:
             case _IID_IDispatchEx:
                 if (((dwEnabledOptions & dwOptionSetMask) == INTERFACESAFE_FOR_UNTRUSTED_CALLER) &&
                      (_fSafeForScripting == true))
                     Result = _OK;
                 break;
             case _IID_IPersistStorage:
             case _IID_IPersistStream:
             case _IID_IPersistPropertyBag:
                 if (((dwEnabledOptions & dwOptionSetMask) == INTERFACESAFE_FOR_UNTRUSTED_DATA) &&
                      (_fSafeForInitializing == true))
                     Result = _OK;
                 break;
             default:
                 Result = _NOINTERFACE;
                 break;
         }

         return Result;
     }
 } 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2014-05-15T19:32:07.087

您可以创建一个 .reg 文件来修改注册表项，如下所示：

Windows 注册表编辑器版本 5.00

[HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Internet Settings\Zones\0] "1201"=dword:00000000
[HKEY_CURRENT_USER\SOFTWARE\Microsoft\Windows\CurrentVersion\Internet Settings\Zones\0] "1201"=dword:00000000

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2013-03-08T06:17:46.197

> 1.  开始 -> 运行 -> 注册表编辑器
> 2.  转到 HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Internet Settings\Zones\0
> 3.  双击 1201 并将值更改为 0（可能是 1）
> 4.  关闭注册表编辑器

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-21T18:32:22.877

我认为您可以将站点信任级别设置为完整。

工具->Internet 选项->安全->受信任的站点->站点按钮

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-21T18:37:00.010

至于签署 ActiveX 见[这篇文章](http://msdn.microsoft.com/en-us/library/ms537364(VS.85).aspx)。但是，您仍然必须允许 ActiveX（它只会将您显示为作者）。有关如何允许此站点使用 ActiveX，请参阅 Ryan 的回答。

# google-app-engine - 如何获取存储在 Google appengine 的数据存储区中的给定类型的所有条目的计数？

> ID：894376
> 
> 赞同：5
> 
> 时间：2009-05-21T18:29:24.193
> 
> 标签：google-app-engine

我正在寻找的基本上是将这个 SQL 翻译成 Google AppEngine (for Java) 术语：

```
select count(*) from Customers 
```

看起来很简单，但是从阅读文档来看，我似乎必须运行一个匹配所有客户的查询，循环遍历它并计算结果，同时考虑到分页。我不想检索每个元素，我只想计算它们。

或者另一种方式，有一个 API 可以遍历给定类型的所有条目（目前无法找到确切的 API）。这似乎效率很低，更不用说数据存储调用也带有有限的配额。

任何提示将不胜感激。

谢谢，马克

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-05-22T01:33:52.977

正如 wooble 所说，bigtable 不支持将行计数作为一个基本概念——您可以编写一个包装函数，正如 mcotton 所说，但是，正如他从文档中引用的那样，最多仍然限制为 1000。

为了克服这些限制，您需要为每种要计数的实体保留一个计数器，每次放置该类型的新实体时该计数器都会增加，删除该类型的实体时该计数器会减少。

为了使您的应用程序具有高度可扩展性，您可能需要对此类计数器进行分片，请参阅[http://code.google.com/appengine/articles/sharding_counters.html](http://code.google.com/appengine/articles/sharding_counters.html)（不幸的是，我不知道该配方是否已翻译成 Java，但概念应该相同）。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2010-08-19T21:00:00.990

正如 mcotton 所说，“SELECT __ key __”查询上的 count() 没有限制似乎可以满足您的需求。

[http://code.google.com/appengine/docs/python/datastore/queryclass.html#Query_count](http://code.google.com/appengine/docs/python/datastore/queryclass.html#Query_count)

不过，这是 Google Datastore 中相对较新的功能。他们过去对此的要求限制为 1000。他们最近才取消了这个限制。现在唯一的限制是您的查询是否足够快地执行而不会超时。

如果这是一个真正大量的数据并且您确实遇到了超时，您还可以考虑使用新的 Google Mapper API。要了解更多信息，请在 Google 上搜索 [appengine mapreduce]。

我同意 GQL 不支持“SELECT COUNT(*)”真是太神奇了。这似乎有点疏忽。但是只对键进行选择，然后使用 count() 不将这些键一直发送回应用程序，其行为应该类似。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-21T19:38:07.687

不幸的是，BigTable 不可能在不运行查询以匹配所有实体的情况下对实体进行计数。请记住，当您拥有超过 1000 个实体时，Google Search 和 Google Reader 等应用程序甚至不会为您提供准确的结果计数，如果您绝对肯定地认为您需要计算所有实体，您可以执行一系列keys_only 查询每个限制为 1000 个实体，并将所有实体的计数相加。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-22T00:40:10.840

这只是猜测，但我认为他们会在 java 中实现一个 count() 方法，类似于他们的 python 实现。 [这里](http://code.google.com/appengine/docs/python/datastore/queryclass.html#Query_count)是 python 的 count() 方法。

计数（限制）

```
Returns the number of results this query fetches.

count() is somewhat faster than retrieving all of the data by a constant factor, but the running time still grows with the size of the result set. It's best to only use count() in cases where the count is expected to be small, or specify a limit.

Note: count() returns a maximum of 1000\. If the actual number of entities that match the query criteria exceeds the maximum, count() returns a count of 1000.

Arguments:

limit

    The maximum number of results to count. 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2015-03-08T16:10:40.630

这是一个非常古老的线程，但为了防止其他人看到它，有 3 种方法可以完成此操作：

1.  访问数据存储统计信息
2.  在数据存储中保留一个计数器
3.  共享计数器

[此链接中解释](http://www.shiftedup.com/2015/03/08/how-to-count-all-entries-of-a-given-type-in-the-app-engine-datastore)了这些方法中的每一种。

# ant - 带有“|”的执行任务 在论据中

> ID：894383
> 
> 赞同：1
> 
> 时间：2009-05-21T18:30:36.983
> 
> 标签：ant

我正在尝试在我的 ANT 脚本中使用 incredibuild 执行 VS 构建，但由于某种原因，执行任务失败并出现以下错误：

'Win32' 未被识别为内部或外部命令

当我使用以下代码时：

```
<arg line='buildconsole solution.sln /rebuild /cfg="Release|Win32"' /> 
```

我认为蚂蚁脚本可能正在处理“|” 作为分隔符什么的...

有什么想法可以让这个工作吗？

我也尝试了以下方法，但没有什么能让我更接近：

```
<arg line='buildconsole solution.sln /rebuild /cfg="Release&#124;Win32"' />

<arg value="buildconsole solution.sln /rebuild /cfg=&quot;Release|Win32&quot;" />

<arg value="buildconsole solution.sln /rebuild /cfg=&quot;Release&#124;Win32&quot;" /> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-21T18:39:26.137

您需要通过在它前面加上 ^ 来转义管道符号。所以：

```
<arg line='buildconsole solution.sln /rebuild /cfg="Release^|Win32"' /> 
```

* * *

编辑：

你确定插入符号不起作用？似乎在这个示例 ant 文件中：

```
<?xml version="1.0" encoding="UTF-8"?>

<project name="Test" default="build" basedir=".">

    <target name="build">
        <exec executable="cmd">
            <arg line="/k echo cfg=&quot;Release^|Win32&quot;"/>
        </exec>
    </target>

</project> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-21T18:53:40.523

嗯...我又试了一次，它起作用了，但只有在我改为

```
<arg value="buildconsole solution.sln /rebuild /cfg=Release^|Win32" /> 
```

所以我猜如果我使用 value 的话，Release^|Win32 周围的引号是不必要的。

非常感谢！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-21T18:36:56.610

我认为问题在于 Windows 命令提示符看到 | 并将其视为“管道”运算符。也许通过使用以下方法逃离管道：

<arg line='buildconsole solution.sln /rebuild /cfg="Release\|Win32"' />

# java - Eclipse 插件 - 获取外部方法？

> ID：894386
> 
> 赞同：-1
> 
> 时间：2009-05-21T18:31:09.213
> 
> 标签：java, eclipse, plugins

我一直在为 Eclipse 开发一个插件。当插入符号在活动编辑器中移动以反映外部方法时，插件有几个视图需要更新。

目前，我正在获取一个 ASTNode，它使用文件的整个源上的 ASTParser 类来表示外部方法，然后遍历它的层次结构，直到找到外部方法。这适用于中等大小的代码文件，但对于非常大的代码文件来说速度较慢是可以理解的。

我想知道是否有一个内置函数可以给我一个外部方法的表示，它可能比我目前的方法更有效？我看过高和低，但也许我看错了地方。

在此先感谢您的帮助，艾伦

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-29T10:07:27.443

我只是想提供有关此问题的更新，以防它对其他人有所帮助。

我放弃了寻找插入符号所在方法的代码的直接入口点。这导致我开发了一种算法来解析插入符号位置周围的代码。这足以满足我自己的需求，并且花了将近几天的时间在 Google 上搜索解决方案。

艾伦

# jquery - 基于 Radio PRE 的 jQuery 过滤器 SELECT 选项 - 在加载时选择

> ID：894387
> 
> 赞同：0
> 
> 时间：2009-05-21T18:31:13.657
> 
> 标签：jquery

所以我昨天发布了这个问题（[链接](https://stackoverflow.com/questions/877328/jquery-disable-select-options-based-on-radio-selected-need-support-for-all-brows)）并得到了我需要的答案，但是对于我的一生，如果在身体负荷上选择了这个值，我就无法做到这一点。它仅在用户单击收音机然后过滤选项时才有效。请帮忙！！！

功能

```
jQuery.fn.filterOn = function(radio, values) {
    return this.each(function() {
        var select = this;
        var options = [];
        $(select).find('option').each(function() {
            options.push({value: $(this).val(), text: $(this).text()});
        });
        $(select).data('options', options);
        $(radio).click(function() {
            var options = $(select).empty().data('options');
            var haystack = values[$(this).attr('id')];
            $.each(options, function(i) {
                var option = options[i];
                if($.inArray(option.value, haystack) !== -1) {
                    $(select).append(
                    $('<option>').text(option.text).val(option.value)
                    );
                }
            });
        });            
    });
}; 
```

如何打电话

```
$(function() {
    $('#theOptions').filterOn('input:radio[name=abc123]', {
        'abc': ['a','b','c'],
        '123': ['1','2','3']        
    });
}); 
```

提前致谢

顺便说一句，这是它的[演示](http://jsbin.com/anoci)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-21T19:38:15.893

```
$(document).ready(function(){
    $('input:radio:checked').click(); 
}); 
```

这将为您的示例完成。

# c# - C# 和 C++ 之间的同步值？

> ID：894389
> 
> 赞同：0
> 
> 时间：2009-05-21T18:31:27.993
> 
> 标签：c#, c++, datetime, system

C# 和（非托管）C++ 中是否存在返回同步数（例如浮点数或整数）的函数？

例如，有没有什么东西可以将确切的系统时间至少带到第二个，这会在完全相同的时间在 C++ 和 C# 上返回完全相同的结果？

只是想知道真的=）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-21T18:35:30.513

您在这里谈论托管 C++ (C++/CLI) 还是本机 C++？如果您始终使用托管代码，那么显而易见的解决方案是利用该[`Environment.TickCount`](http://msdn.microsoft.com/en-us/library/system.environment.tickcount.aspx)属性。在本机 C++ 中，等效的是 Win32 API[`GetTickCount`](http://msdn.microsoft.com/en-us/library/ms724408(VS.85).aspx)函数。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-21T18:33:54.853

获得完全控制感的最佳选择可能是使用 p/invoke 直接从 C# 调用 Win32 函数，如 GetSystemTime 或 GetTickCount。

但在这一切之下，DateTime 只是调用 Win32 函数，所以没有理由说它会给你带来与使用普通 C 风格 Win32 调用截然不同的实时性。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-21T18:36:16.707

很可能是托管的 C++ 和 C#。非托管 C++，可能不是，因为它不编译为 IL。

# php - 如何从 PHP 脚本（如批处理文件）中运行多个 PHP 脚本？

> ID：894390
> 
> 赞同：7
> 
> 时间：2009-05-21T18:32:21.643
> 
> 标签：php

如何从另一个 PHP 脚本（如批处理文件）中运行多个 PHP 脚本？如果我了解 include 在做什么，我认为 include 不会起作用；因为我正在运行的每个文件都会重新声明一些相同的函数等。我想要的是执行每个新的 PHP 脚本，就像它在一个干净、新鲜的堆栈中一样，不知道变量、函数等来到它面前。

**更新**：我应该提到该脚本在 Windows 上运行，但不在 Web 服务器上。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-05-21T18:35:30.763

您可以使用[exec()](http://ca.php.net/manual/en/function.exec.php)函数将每个脚本作为外部命令调用。

例如，您的脚本可以执行以下操作：

```
<?php

exec('php -q script1.php');
exec('php -q script2.php');

?> 
```

Exec 有一些围绕它的安全问题，但听起来它可能对你有用。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-05-21T18:37:43.723

// 使用执行[http://www.php.net/manual/en/function.exec.php](http://www.php.net/manual/en/function.exec.php)

```
<?php

exec('/usr/local/bin/php somefile1.php');
exec('/usr/local/bin/php somefile2.php');

?> 
```

在过去，我做过一些事情，比如创建一个包含指向每个文件的链接的框架集。调用框架集，您将调用所有脚本。这些天你可以用 iframe 或 ajax 做同样的事情。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-05-21T18:45:50.400

exec() 是一个很好的函数，但您必须等到进程终止才能继续使用父脚本。如果您正在执行一批流程，其中每个流程都需要一些时间，我建议您使用 popen()。

你得到的变量创建了一个指向管道的指针，它允许你一次通过几个进程，将它们存储在一个数组中，然后在它们全部完成后以串行速度访问它们（更多同时）使用steam_get_contents()。

如果您正在进行 API 调用或运行可能不是内存密集型或计算密集型但确实需要大量等待才能完成的脚本，这将特别有用。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-05-21T18:49:16.727

如果您需要这些脚本的任何返回结果，您可以使用该[`system`](http://us3.php.net/manual/en/function.system.php)函数。

```
$result = system('php myscript.php');
$otherresult = system('php myotherscript.php'); 
```

# c# - 如何在 Office 2010 等 WPF 应用程序中对 Aero 玻璃进行渐变渐变？

> ID：894397
> 
> 赞同：5
> 
> 时间：2009-05-21T18:33:54.293
> 
> 标签：c#, .net, wpf, aero, aero-glass

我正在 WPF 中编写一个应用程序，我希望应用程序的顶部从一种颜色淡化为 Aero 玻璃，如 Office 2010 应用程序。

实际上，它会将标题栏下方的区域从玻璃淡化为一种颜色。（我认为这可能是描述它的更好方式）。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-05-22T21:07:44.023

我想出了如何让它工作。我使用原生 API 将整个窗口设置为具有航空玻璃效果，然后为我的窗口背景创建一个 LinearGradientBrush。在画笔中，我使用了画笔的 Alpha 属性并设置了停止点，以使窗口顶部从白色/不透明变为白色/透明，所有这些都非常靠近窗口的顶部。

```
<Grid>
        <Grid.Background>
            <LinearGradientBrush StartPoint="1,0">
                <!-- This gradient stop is Fully transparent. -->
                <GradientStop Color="#00FFFFFF" Offset="0.0" />
                <!-- This gradient stop is fully opaque. -->
                <GradientStop Color="#FFFFFFFF" Offset="0.1" />
            </LinearGradientBrush>
        </Grid.Background>
</Grid> 
```

我对 Mikko Rantanen 的回答加了 1 分，因为我使用这篇文章添加了玻璃效果，我没有方便的代码，这是一篇很好的简单文章。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-21T22:37:40.743

这让我想起了 Windows Explorer/Internet Explorer 在地址字段后面延续 Aero 玻璃效果的方式。所以我猜如果有这种效果的API，它将是一个原生的Vista API，你需要通过P/Invoke调用它，类似于[扩展玻璃效果](http://www.wpftutorial.net/ExtendGlass.html)。我相信 WPF 并没有任何方法来控制 Vista 特定的 Aero 主题。

# jquery - jquery("foo bar") 与 jquery("foo").find("bar")

> ID：894418
> 
> 赞同：2
> 
> 时间：2009-05-21T18:37:24.283
> 
> 标签：jquery

我正在尝试遍历 xml 文档。这不起作用（零结果）：

```
jquery("foo bar") 
```

这确实有效：

```
jquery("foo").find("bar") 
```

知道为什么吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-21T18:46:41.863

```
jquery("foo bar") 
```

第一个寻找 bar 元素是 foo 元素的后代

所以它可以在这个例子中工作

```
 <foo>
  <div>Form is surrounded by the green outline</div>
  <label>Child:</label>
  <bar name="thisone" />
  <fieldset>
    <label>Grandchild:</label>
    <bar name="thisone2" />
  </fieldset>
 </foo> 
```

这个使用[jquery 表达式进行搜索](http://docs.jquery.com/Selectors)

```
jquery("foo").find("bar") 
```

从所有 foo 元素开始并搜索后代 bar 元素

所以它可以在这个例子中工作

```
<foo><bar>found</bar>, not here?</foo>
<foo>not here <bar>found</bar>.</foo> 
```

所以没有你的标记不能真正指定你的问题

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-25T17:19:06.997

需要注意的重要一点是您正在遍历 XML。虽然您的示例对于 HTML 是有效且相同的，但我发现，至少在 IE 上，后代表达式不适用于 XML。

事实上，如果有人能证实并解释这一点，我将不胜感激。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-25T15:43:44.157

我很好奇你是如何得到相互矛盾的结果的，所以我尝试了标记，但想不出一种方法来重现你描述的 jQuery 对象本身返回的行为。我确实发现了一些稍微不同的情况会产生这种行为，例如：

```
<div>
    <span id="span1">Hello World</span>
    <img src="foo" alt="bar" />
</div> 
```

如果您尝试这种语法（这里我拼写“jQuery”而不是使用“$”）

```
jQuery("#span1").parents("div img").css("max-width","25%");  // no good 
```

那么你不会得到任何结果，因为“span1”没有“div img”父级，只有“div”父级。但这会产生一个结果：

```
jQuery("#span1").parents("div").find("img").css("max-width","25%");  // will work 
```

因为它找到“span1”的父 div 并从那里找到作为该父 div 后代的图像。

但我的例子是一个人为的例子，因为在那种情况下你可能只会使用

```
jQuery("#span1").siblings("img").css("max-width","25%");  // will also work, and is clearer 
```

# sql-server - 子查询中的计数（*）

> ID：894419
> 
> 赞同：1
> 
> 时间：2009-05-21T18:37:33.350
> 
> 标签：sql-server, subquery

我需要每个订单的行项目数。

在此示例中，订单 10 有 0，订单 11 有 2 行。

```
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'dbo.OrderDetail') AND type in (N'U'))
DROP TABLE OrderDetail
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'dbo.OrderHeader') AND type in (N'U'))
DROP Table OrderHeader
GO
CREATE TABLE OrderHeader(
OrderHeaderID Int Primary Key Identity(10,1),
CustID Int)
GO
CREATE TABLE OrderDetail(
OrderDetailID Int Primary Key Identity(100,1),
OrderHeaderID Int REFERENCES OrderHeader,
ItemID Int)
GO
DECLARE @OrderHeaderID Int
INSERT INTO OrderHeader(CustID) VALUES(1000)
INSERT INTO OrderHeader(CustID) VALUES(1001)
SET @OrderHeaderID=SCOPE_IDENTITY()
INSERT INTO OrderDetail(OrderHeaderID,ItemID) VALUES(@OrderHeaderID,3)
INSERT INTO OrderDetail(OrderHeaderID,ItemID) VALUES(@OrderHeaderID,4)
GO
SELECT 
OrderDetailID,ItemID,OrderHeader.OrderHeaderID,CustID
FROM OrderDetail
JOIN OrderHeader
ON OrderDetail.OrderHeaderID=OrderHeader.OrderHeaderID
-- 
```

这是我需要帮助的地方 我需要 COUNT(*)

```
FROM OrderDetail WHERE OrderDetail.OrderHeaderID=OrderHeader.OrderHeaderID
SELECT OrderHeader.OrderHeaderID,CustID,CountOfOrderDetail
FROM OrderHeader
JOIN OrderDetail
ON OrderDetail.OrderHeaderID=OrderHeader.OrderHeaderID 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-21T18:44:13.147

```
select 
   ord.OrderHeaderID
   , count(det.ItemID)
from
   OrderHeader ord
left outer join
   OrderDetail det
on
   det.OrderHeaderID = ord.OrderHeaderID
group by
   ord.OrderHeaderID 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-21T18:41:34.557

```
SELECT OrderHeader.ID, count(OrderDetail.ID)
FROM OrderHeader
LEFT JOIN OrderDetail
ON OrderDetail.OrderHeaderID=OrderHeader.OrderHeaderID
GROUP BY OrderHeader.ID 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-21T18:41:44.557

像这样？

```
SELECT 
  h.OrderHeaderID,
  h.CustID,
  COUNT(d.OrderHeaderID) CountOfOrderDetail
FROM 
  OrderHeader h
  LEFT JOIN OrderDetail d ON d.OrderHeaderID = h.OrderHeaderID
GROUP BY
  h.OrderHeaderID,
  h.CustID 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-21T18:43:52.337

为了将来参考，您需要避免使用以下内容：

```
SELECT COUNT(*)
FROM OrderDetail
GROUP BY OrderHeaderID 
```

乍一看，它似乎足够简单和优雅，但请注意，您会错过 OrderHeader 表中没有订单的任何订单。如果他们的代表很重要（他们的计数为 0），请参阅[Tomalak](https://stackoverflow.com/users/18771/tomalak)或[Autocracy](https://stackoverflow.com/users/90322/autocracy)的答案[here](https://stackoverflow.com/questions/894419/count-in-a-subquery/894434#894434)和[here](https://stackoverflow.com/questions/894419/count-in-a-subquery/894432#894432)。

感谢[KM](https://stackoverflow.com/users/65223/km)指出这一点！（见下面的评论）

# iis - IIS问题？网站没有突然出现

> ID：894422
> 
> 赞同：0
> 
> 时间：2009-05-21T18:38:49.197
> 
> 标签：iis, virtual-directory

所以我在服务器上设置了一个站点。它一直在工作。它突然停止工作。我什至尝试通过 IP 访问它。它只是说，“正在建设中......

��正在施工

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-21T18:45:24.190

仔细检查您的绑定设置是否正确。也许创建了一个与您网站的绑定冲突的新网站？

**编辑**

确保 .net 设置为正确的版本。我已经看到在 2.0 网站上将 web 设置为 1.1 时没有提供页面的地方。

该网站也可以在盒子上本地工作吗？您是否排除了防火墙问题/更改或其他网络相关元素。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-21T18:46:48.697

听起来您的请求正在由另一个 IIS 站点处理。确保主机头设置正确。

* * *

根据您的评论，“错误请求”错误意味着默认网站正在处理该请求。您可以检查几件事：

1.  如果这不是您希望为您的应用程序提供服务的网站，那么您仍然存在网站身份问题。
2.  如果您的应用程序托管在默认网站上，请确保正确设置默认文档。
3.  还要确保您的应用的根目录中没有名为“app_offline.htm”的文件。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-29T13:48:11.227

好吧，我们重新启动了服务器，现在它又可以工作了。我想我应该首先尝试一下。奇怪的是所有其他网站都在工作。无论如何感谢大家的建议。

# algorithm - 奶油沼泽拼图中的小精灵

> ID：894423
> 
> 赞同：4
> 
> 时间：2009-05-21T18:38:57.777
> 
> 标签：algorithm, language-agnostic, logic, puzzle, lower-bound

（感谢 Rich Bradshaw）

我正在为以下难题寻找最佳策略。

作为新的仙王，你有责任绘制王国的奶油沼泽地图。
沼泽笼罩在飘渺的薄雾中，蛋奶沙司散落在各处。
您可以将您的小精灵送过沼泽，并附有在每个点低飞或高飞的指示。
如果小精灵从蛋奶冻上俯冲下来，它会分心，不会完成它的序列。由于雾气很浓，你只知道小精灵是否到达了另一边。

在编码方面..

```
bool flutter( bool[size] swoop_map ); 
```

这将返回小精灵是否退出给定的猛扑序列。

最简单的方法是一次性传递序列。这揭示了“大小”尝试中的所有蛋奶冻岛。
我更喜欢与蛋奶冻的数量成比例的东西 - 但在序列方面存在问题，例如：

```
 C......C     (that is, custards at beginning and end) 
```

也欢迎链接到这个谜题的其他形式。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-21T18:54:21.037

这让我想到了分而治之。也许是这样的（这是稍微损坏的伪代码。它可能有栅栏错误等）：

```
retval[size] check()
{
   bool[size] retval = ALLFALSE;
   bool[size] flut1 = ALLFALSE;
   bool[size] flut2 = ALLFALSE;
   for (int i = 0; i < size/2; ++i) flut1[i] = TRUE;
   for (int i = size/2; i < size; ++i) flut2[i] = TRUE;
   if (flutter(flut1)) retval[0..size/2] = <recurse>check
   if (flutter(flut2)) retval[size/2..size] = <recurse>check
} 
```

用简单的英语来说，它在 custard 地图的每一半上调用颤振。如果任何一半返回 false，则整个一半没有奶油冻。否则，一半的一半具有递归应用的算法。我不确定是否可以做得更好。然而，如果沼泽大部分是奶油冻，这个算法就有点蹩脚了。

想法二：

```
int itsize = 1
bool[size] retval = ALLFALSE;
for (int pos = 0; pos < size;)
{
    bool[size] nextval = ALLFALSE;
    for (int pos2 = pos; pos2 < pos + size && pos2 < size; ++pos2) nextval[pos2] = true;
    bool flut = flutter(nextval)
    if (!flut || itsize == 1)
    {
        for (int pos2 = pos; pos2 < pos + size && pos2 < size; ++pos2) retval[pos2] = flut;
        pos+=itsize;
    }
    if (flut) itsize = 1;
    if (!flut) itsize*=2;
} 
```

用简单的英语，它在 custard map 的每个元素上调用颤振，一次一个。如果它没有找到 custard，下一次调用的元素数量将是上一次调用的两倍。这有点像二分搜索，除了只在一个方向上，因为它不知道它正在搜索多少个项目。我不知道这有多有效。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-21T19:40:50.087

Brian 的第一个分治算法在以下意义上是最优的：存在一个常数 C，使得在所有具有 n 个正方形和最多 k 个蛋羹的沼泽中，没有算法的最坏情况比 Brian 的好 C 倍。Brian 的算法使用 O(k log(n/k)) 次飞行，它在 log2(n choose k) >= log2((n/k)^k) = k Omega( k 对数（n/k））。（你需要一个像 k <= n/2 这样的假设来使最后一步变得严格，但是在这一点上，我们已经达到了 O(n) 次飞行的最大值。）

为什么布赖恩的算法只使用 O(k log(n/k)) 航班？在递归深度 i，它最多进行 min(2^i, k) 次飞行。0 <= i <= log2(k) 的总和是 O(k)。log2(k) < i <= log2(n) 的总和是 k (log2(n) - log2(k)) = k (log2(n/k))。

# javascript - 使用 jQuery 从图像源的文件名中复制值以处理并粘贴到 html 中？

> ID：894426
> 
> 赞同：1
> 
> 时间：2009-05-21T18:39:51.410
> 
> 标签：javascript, jquery, html, automation, css-selectors

嗨，我正在尝试使用 jQuery/javascript 让我的生活更轻松。我正在尝试使用它来自动填充各种 html 元素，其中包含来自图像文件名的地点和国家/地区名称。以下是我必须使用的一些 html 示例：

```
<div class="boxgrid">
<a href="gallery/angkor - cambodia.jpg" title="[PLACE] - [COUNTRY]">
  <img src="gallery/thumbs/angkor - cambodia.jpg" alt="[PLACE] - [COUNTRY]" width="100" height="100"/>
</a>
  <div class="boxcaption">
    <span class="place">[PLACE]</span>
    <span class="country">[COUNTRY]</span>
  </div>
</div> 
```

想象一下这个 html 块对画廊中的每个图像重复多次，所以我假设需要使用 .each() 。

这个想法是 [NAME OF PLACE] 和 [NAME OF COUNTRY] 应该使用 - （破折号）作为两个值之间的分隔符填充图像的文件名。我怎样才能用 jQuery/javascript 做到这一点？（我意识到我应该使用服务器端语言或另一种方式，但这是我的限制）

作为奖励，每个值的第一个字母应大写，例如 Angkor - Cambodia 。

谢谢，任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-21T18:55:22.347

这是完整的代码，其中包含 Place 和 Country 的第一个字母的修剪和大写。

```
String.prototype.capitalize = function(){
    return this.replace(/\S+/g, function(a){
        return a.charAt(0).toUpperCase() + a.slice(1).toLowerCase();
    });
};

$(function(){
 $('.boxgrid').each(function(){
    var placeCountry = $(this).find('img').attr('src')
                            .replace('gallery/thumbs/','')
                            .replace('.jpg','').capitalize();

    var place = $.trim(placeCountry.split('-')[0]); 
    var country = $.trim(placeCountry.split('-')[1]);
    $(this).find('a').attr('title',placeCountry);
    $(this).find('img').attr('alt',placeCountry);
    $(this).find('.place').html(place);
    $(this).find('.country').html(country);
 });
}); 
```

# powershell - 使用 PowerShell 创建硬链接和软链接

> ID：894430
> 
> 赞同：277
> 
> 时间：2009-05-21T18:41:22.187
> 
> 标签：powershell, symlink

PowerShell 1.0 能否创建类似于 Unix 的硬链接和软链接？

如果这不是内置的，有人可以将我指向一个具有模仿此 ps1 脚本的站点吗？

这是任何好的外壳的必要功能，恕我直言。:)

* * *

## 回答 #1

> 赞同：346
> 
> 时间：2016-01-20T16:41:00.897

**Windows 10（以及一般的 Powershell 5.0）允许您[通过 New-Item cmdlet 创建符号链接](https://docs.microsoft.com/en-us/powershell/module/microsoft.powershell.management/new-item)。**

用法：

```
New-Item -Path C:\LinkDir -ItemType SymbolicLink -Value F:\RealDir 
```

或在您的个人资料中：

```
function make-link ($target, $link) {
    New-Item -Path $link -ItemType SymbolicLink -Value $target
} 
```

打开**开发者模式**，在创建链接时不需要管理员权限`New-Item`：

[![在此处输入图像描述](https://i.stack.imgur.com/1HYya.png)](https://i.stack.imgur.com/1HYya.png)

* * *

## 回答 #2

> 赞同：283
> 
> 时间：2011-04-05T09:07:51.260

您可以从 PowerShell调用`mklink`提供的, 来创建符号链接：`cmd`

```
cmd /c mklink c:\path\to\symlink c:\target\file 
```

如果目标是目录，则必须传递`/d`给。`mklink`

```
cmd /c mklink /d c:\path\to\symlink c:\target\directory 
```

对于硬链接，我建议使用[Sysinternals Junction 之](http://technet.microsoft.com/en-us/sysinternals/bb896768.aspx)类的东西。

* * *

## 回答 #3

> 赞同：45
> 
> 时间：2009-05-21T19:23:24.643

# 添加“pscx”模块

不，它没有内置在 PowerShell 中。并且该`mklink`实用程序不能在 Windows Vista/Windows 7 上单独调用，因为它是[作为“内部命令”](https://ss64.com/nt/mklink.html)[直接`cmd.exe`](https://ss64.com/nt/mklink.html)内置的。

您可以使用[PowerShell 社区扩展](https://github.com/Pscx/Pscx)（免费）。有几个 cmdlet 用于各种类型的重解析点：

*   `New-HardLink`,
*   `New-SymLink`,
*   `New-Junction`,
*   `Remove-ReparsePoint`
*   和别的。

* * *

## 回答 #4

> 赞同：24
> 
> 时间：2012-04-10T13:18:58.883

在 Windows 7 中，命令是

```
fsutil hardlink create new-file existing-file 
```

PowerShell 在没有完整路径 (c:\Windows\system32) 或扩展名 (.exe) 的情况下找到它。

* * *

## 回答 #5

> 赞同：15
> 
> 时间：2013-10-24T14:02:57.337

新符号链接：

```
Function New-SymLink ($link, $target)
{
    if (test-path -pathtype container $target)
    {
        $command = "cmd /c mklink /d"
    }
    else
    {
        $command = "cmd /c mklink"
    }

    invoke-expression "$command $link $target"
} 
```

删除符号链接：

```
Function Remove-SymLink ($link)
{
    if (test-path -pathtype container $link)
    {
        $command = "cmd /c rmdir"
    }
    else
    {
        $command = "cmd /c del"
    }

    invoke-expression "$command $link"
} 
```

用法：

```
New-Symlink "c:\foo\bar" "c:\foo\baz"
Remove-Symlink "c:\foo\bar" 
```

* * *

## 回答 #6

> 赞同：10
> 
> 时间：2009-05-21T20:59:40.737

# 试试 junction.exe

SysInternals的[Junction](http://technet.microsoft.com/en-us/sysinternals/bb896768.aspx)命令行实用程序使创建和删除联结变得容易。

# 进一步阅读

*   **MS 术语：soft != symbolic**
    Microsoft 使用*“软链接”*作为“连接”的另一个*名称*。
    但是：*“符号链接”*完全是另外一回事。
    请参阅 MSDN： Windows 中的[硬链接和连接](http://msdn.microsoft.com/en-us/library/aa365006(VS.85).aspx)。*（这与“软链接”*和*“符号链接”*（*“符号链接”*）[确实表示相同含义的](https://en.wikipedia.org/wiki/Symbolic_link)
    那些术语的一般用法直接矛盾。）

 **** * *

## 回答 #7

> 赞同：5
> 
> 时间：2009-05-21T20:41:09.793

您可以使用此实用程序：

```
c:\Windows\system32\fsutil.exe create hardlink 
```

* * *

## 回答 #8

> 赞同：5
> 
> 时间：2017-04-03T19:55:07.483

我结合了两个答案（@bviktor 和@jocassid）。它在 Windows 10 和 Windows Server 2012 上进行了测试。

```
function New-SymLink ($link, $target)
{
    if ($PSVersionTable.PSVersion.Major -ge 5)
    {
        New-Item -Path $link -ItemType SymbolicLink -Value $target
    }
    else
    {
        $command = "cmd /c mklink /d"
        invoke-expression "$command ""$link"" ""$target"""
    }
} 
```

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2012-06-07T20:31:01.743

我编写了一个 PowerShell 模块，该模块具有 MKLINK 的本机包装器。[https://gist.github.com/2891103](https://gist.github.com/2891103)

包括以下功能：

*   新符号链接
*   新硬链接
*   新结

捕获 MKLINK 输出并在必要时引发适当的 PowerShell 错误。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2011-04-29T15:36:18.807

实际上，[Sysinternals](http://en.wikipedia.org/wiki/Winternals) `junction`命令只适用于目录（不要问我为什么），所以它不能硬链接文件。我会选择`cmd /c mklink`软链接（我不明白为什么 PowerShell 不直接支持它），或者`fsutil`硬链接。

如果你需要它在 Windows XP 上工作，我不知道除了 Sysinternals 之外的任何东西`junction`，所以你可能仅限于目录。

* * *

## 回答 #11

> 赞同：-2
> 
> 时间：2013-04-10T15:31:21.203

我发现这是没有外部帮助的简单方法。是的，它使用了一个古老的 DOS 命令，但它可以工作，很简单，而且很清楚。

```
$target = cmd /c dir /a:l | ? { $_ -match "mySymLink \[.*\]$" } | % `
{
    $_.Split([char[]] @( '[', ']' ), [StringSplitOptions]::RemoveEmptyEntries)[1]
} 
```

这使用 DOS dir 命令查找具有符号链接属性的所有条目，过滤特定链接名称后跟目标“[]”括号，并且对于每个（可能是一个）仅提取目标字符串。

# opengl-es - 将任意大小的像素块复制到 OpenGL ES 纹理中……不知何故？

> ID：894431
> 
> 赞同：1
> 
> 时间：2009-05-21T18:41:31.033
> 
> 标签：opengl-es, copy, textures, gldrawpixels

我正在编写一个绘图应用程序，绘图画布是一个 OpenGL 纹理。当您在画布上绘图时，它会确定画布纹理的哪个区域已更改，并在应用您所做的更改之前复制该像素数据（使用 glReadPixels）。

要撤消，我想使用复制出来的像素数据简单地恢复到以前的纹理状态。但是，OpenGL ES 不提供 glDrawPixels 命令。最好的方法是什么？

我考虑了两种选择，但我不确定是否有那么好：

1.  使用我复制出来的像素创建一个临时纹理并将其绘制进去。（但是，复制的区域不是 2 的幂！）

2.  完全解绑大画布纹理，手动修改纹理字节，然后放回OpenGL。我没有使用任何形式的压缩，所以这可能不是那么糟糕。但这似乎是一个黑客？

有人有什么想法吗？我真的很感激！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-22T02:33:33.170

万一有人在尝试做类似的事情时偶然发现了这一点，我想出了一个似乎运作良好的解决方案。

1.  通过将其绑定到帧缓冲区然后将帧缓冲区写入 CGImageRef 来获取当前纹理的图像。
2.  创建一个新的 CGContext 并在现有的纹理 CGImageRef 中绘制。然后将旧纹理数据绘制到用户更改的部分，有效地“撤消”对图像的更改。
3.  销毁旧的 OpenGL 纹理并从 CGContext 创建一个纹理。

我认为这是一种相当缓慢的处理方式，但我不需要巨大的性能——我真正关心的是限制为表示“旧”纹理而保留的数据量。

如果您需要这方面的帮助（有相当多的代码），请随时给我发电子邮件。

# sql-server-2005 - 如何在不加载加载项的情况下运行 SQL Server Management Studio

> ID：894435
> 
> 赞同：1
> 
> 时间：2009-05-21T18:41:52.200
> 
> 标签：sql-server-2005

我最近为 SQL Management Studio 安装了一个插件，用于智能感知/重构。它导致我的 Management Studio 执行速度太慢以至于无法使用。我已卸载该产品，但它似乎仍然影响 Management Studio。是否可以在不启用任何加载项的情况下运行？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-21T20:42:35.530

不能保证，但由于 SSMS 是在 Visual Studio shell 上构建的，因此您可以尝试在启动 SSMS 时按住左移键 - 此按键会禁用 Visual Studio 中的加载项。

还可以在[这里](http://sqlblogcasts.com/blogs/jonsayce/archive/2008/01/25/uninstalling-an-ssms-add-in.aspx)查看注册表技巧。

从以下位置删除密钥：

```
HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Microsoft SQL Server\90\Tools\Shell\AddIns 
```

或者

```
HKEY_LOCAL_MACHINE\SOFTWARE\Wow6432Node\Microsoft\Microsoft SQL Server\90\Tools\Shell\AddIns 
```

# java - 打印彩色页眉和页脚？

> ID：894436
> 
> 赞同：3
> 
> 时间：2009-05-21T18:42:48.457
> 
> 标签：java, swing, printing, jtable, awt

我正在尝试在打印 JTable 时创建彩色页眉和页脚。具体来说，我正在查看 javax.swing.JTable 中的 getPrintable()，但 MessageFormat 没有给我指定页眉或页脚颜色的选项。

我该怎么做？

*澄清* 我有兴趣在打印时设置页眉/页脚。例如，记事本将文件名作为标题附加到您打印的内容中。

*更新* 似乎没有标准的方法可以做到这一点，有人可以给我一些解决方法吗？到目前为止发布的唯一答案与打印（如发送到打印机，不显示到屏幕）页眉/页脚无关。

从我的评论中复制：我对打印页眉/页脚感兴趣。例如，当您从记事本打印文档时，它会将文件名附加为页眉（或者可能是页脚，我记不清了）

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-29T09:44:25.883

我能想到的一种解决方案是使用您自己的可打印文件：

```
public class CustomTablePrintable implements Printable {

    Printable tablePrintable;

    public void setTablePrintable(Printable printable) {
        tablePrintable = printable;        
    }

    public int print(Graphics graphics, PageFormat pageFormat, 
            int pageIndex) throws PrinterException {
        if (pageIndex > 0) {
            return NO_SUCH_PAGE;
        }

        tablePrintable.print(graphics, pageFormat, pageIndex);

        Graphics2D g2d = (Graphics2D)graphics;
        g2d.translate(pageFormat.getImageableX(), pageFormat.getImageableY());

        // Draw header/footer here
        graphics.drawString(header, posx, posy);

        return PAGE_EXISTS;        
    }
} 
```

当您从 JTable 调用 getPrintable 时，将其注入到自定义可打印对象的新实例中，然后将其与 PrinterJob 一起使用。

您现在可以根据需要绘制页眉和页脚，但也会丢失一些内容：

*   您不能使用 MessageFormat 来格式化消息。我相信您可以轻松地将此功能添加到您的可打印文件中。
*   页眉和页脚不会自动定位。不过，您可以对这些进行粗略估计。

**编辑：**我查看了 Java Sources，并且有一个私有类 TablePrintable 可以完成所有工作。您可以查看源代码以查看页眉和页脚的打印方式。然后，您可以将此功能移动到您的 Printable 类。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-21T21:02:31.980

这段代码主要来自 www.java2s.com，其中包含更改以显示如何更改颜色。这不是最漂亮的解决方案，但希望对您有所帮助。

```
import java.awt.BorderLayout;
import java.awt.Color;
import java.awt.Component;

import javax.swing.JComponent;
import javax.swing.JFrame;
import javax.swing.JLabel;
import javax.swing.JScrollPane;
import javax.swing.JTable;
import javax.swing.UIManager;
import javax.swing.border.Border;
import javax.swing.table.TableCellRenderer;
import javax.swing.table.TableColumn;
import javax.swing.table.TableColumnModel;

public class MainClass {
  public static void main(String args[]) {
    String rows[][] = { { "A", "a" }, { "B", "b" }, { "E", "e" } };
    String headers[] = { "Upper", "Lower" };

    JFrame frame = new JFrame("Label Header");
    frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
    JTable table = new JTable(rows, headers);
    JScrollPane scrollPane = new JScrollPane(table);

    Border headerBorder = UIManager.getBorder("TableHeader.cellBorder");

    JLabel headerLabel1 = new JLabel(headers[0], JLabel.CENTER);
    headerLabel1.setBorder(headerBorder);

    // Here is where the color is changed.
    headerLabel1.setBackground(new Color(255, 0, 0));
    headerLabel1.setForeground(new Color(0, 0, 255));
    // End of color change.

    JLabel headerLabel2 = new JLabel(headers[1], JLabel.CENTER);
    headerLabel2.setBorder(headerBorder);

    TableCellRenderer renderer = new JComponentTableCellRenderer();

    TableColumnModel columnModel = table.getColumnModel();

    TableColumn column0 = columnModel.getColumn(0);
    TableColumn column1 = columnModel.getColumn(1);

    column0.setHeaderRenderer(renderer);
    column0.setHeaderValue(headerLabel1);

    column1.setHeaderRenderer(renderer);
    column1.setHeaderValue(headerLabel2);

    frame.add(scrollPane, BorderLayout.CENTER);
    frame.setSize(300, 150);
    frame.setVisible(true);
  }
}

class JComponentTableCellRenderer implements TableCellRenderer {
  public Component getTableCellRendererComponent(JTable table, Object value, 
      boolean isSelected, boolean hasFocus, int row, int column) {
    return (JComponent)value;
  }
} 
```

最重要的一点是：

```
 // Here is where the color is changed.
    headerLabel1.setBackground(new Color(255, 0, 0));
    headerLabel1.setForeground(new Color(0, 0, 255));
    // End of color change. 
```

HTH 让我知道你是怎么做的 :)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-29T13:52:56.753

这有点超出了左侧字段，但您可以使用[iText](http://www.lowagie.com/iText/)之类的库来创建 PDF 文档，然后将其发送到打印机。您将对文档的外观和呈现方式进行更高级别的控制，包括管理表格行如何跨越页面边界的能力，并且您将能够非常轻松地设置页眉和页脚.

您可以按照以下说明用 Java 打印 PDF：[http ://www.juixe.com/techknow/index.php/2008/01/17/print-a-pdf-document-in-java/](http://www.juixe.com/techknow/index.php/2008/01/17/print-a-pdf-document-in-java/)

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2011-04-09T08:04:16.430

这很简单：

```
JTable table = new JTable();
            ((DefaultTableCellRenderer)table.getTableHeader().getColumnModel().getColumn(4).getHeaderRenderer()).setForeground(Color.ORANGE); 
```

# svn - 从 SVN 切换到 GIT 以进行 C# 开发？

> ID：894437
> 
> 赞同：7
> 
> 时间：2009-05-21T18:42:48.563
> 
> 标签：svn, git

您会将 SVN 托管的 C# 项目（2-5 名开发人员）切换到 GIT 吗？它有什么优点值得付出额外的努力吗？

我对此表示怀疑，但为双方寻找论据。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-05-21T18:58:09.767

好吧，这实际上取决于您的开发人员的工作方式以及他们是否对 Subversion 设置感到满意。你是否在做大量的合并并且对 Subversion 的糟糕合并支持发誓，那么 Git 可能会让你的生活更轻松。

让我有点恼火的是，很多人似乎认为 Git 和其他 DVCS 的主要好处是可以进行离线开发。这只是在本地机器上拥有整个存储库的真正功能的一个小副作用，因此可以在不联系服务器的情况下完成分支、合并等。在 Git 的情况下，您可以在几秒钟内切换分支，而在 Subversion 中则需要几分钟。

如果您的开发人员习惯并喜欢学习新事物，那么转换到 Git 可能不会有太大问题。另一方面，如果您的开发人员喜欢事物的现状，但并不真正喜欢他们的工作环境发生变化，那么您最好留在 Subversion 世界中。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-05-21T18:52:06.080

我将我所有的工作从 SVN 转移到了 Git，用于 2 开发商店。*TortoiseGit*在 Windows 上运行良好，而*gitk*工具让我成为一个快乐的人。

对于某些任务，您仍然需要习惯 Windows 上 shell 模式下的 git，但对于您日常工作流程的大部分时间，Git GUI、gitk 和 TortoiseSVN 将帮助您完成任务。**分支/合并系统的质量和快速解决问题的本地私人历史对我来说非常非常值得。**我也有点喜欢跳过版本号，并能够从我比较混乱的个人分支将“干净”的东西推送到中央存储库。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-05-21T20:43:44.733

让我远离 SVN 的是它在互联网上的缓慢性。当存储库距离甚至 100 毫秒时，提交和查看日志历史记录等简单操作需要永远（数十秒）。使用 Git，它们只需要几分之一秒。

线下工作也很棒。有一天，当我的大学网络出现故障时，我仍然可以在笔记本电脑上不间断地投入工作。我可以稍后将更新推送到中央服务器，当我正在处理的功能完成并且我可以访问互联网时。

对于开源项目，DVCS 是必须的，因为它允许新开发人员立即开始 hack，而无需授予他们对中央存储库的写入权限。它降低了新开发人员加入项目的门槛。

我最近写[了一篇](http://blog.orfjackal.net/2009/05/converting-confused-svn-repositories-to.html)关于我将 SVN 存储库转换为 Git 的经验的博客文章。如果您决定离开 SVN，它可能会对您有所帮助。还要记住，使用[git-svn](http://git-scm.com/docs/git-svn)个人开发人员可以在他们的本地机器上使用 Git，而中央存储库是一个 SVN 存储库。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-05-21T18:47:04.577

我会说不，因为此时 GIT 的 GUI 工具真的很原始。

Svn 有 VisualSvn、TortoiseSvn，它们使 Visual Studio 和 Windows Explorer 的集成非常顺利。IMO SVN 工具的“易用性”远远超过了 GIT 提供的分布式源代码控制和更好的合并功能。

现在这是因为我不希望在没有连接到源代码控制存储库的情况下从事源代码控制项目。如果您在飞机或船上花费大量时间（shortay！），我会尝试 GIT，看看命令行工具是否足够。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-05-21T19:22:03.883

您可以查看[为什么 Git 比 SVN 更好](http://whygitisbetterthanx.com/#svn)。

# javascript - 滚动条问题

> ID：894438
> 
> 赞同：0
> 
> 时间：2009-05-21T18:43:06.160
> 
> 标签：javascript, scrollbar

如何通过javascript移动滚动条，

这样可见区域的顶部坐标是整个页面顶部坐标的 y px？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-21T19:02:19.273

请参阅[`window.scrollTo`](http://www.w3schools.com/htmldom/met_win_scrollto.asp)和[`window.scrollBy`](http://www.w3schools.com/htmldom/met_win_scrollby.asp)方法。

如果您需要更多的灵活性和功能，您可以尝试[Flipper](https://stackoverflow.com/users/110486/flipper)的[建议](https://stackoverflow.com/questions/894438/scroll-bar-problem/894467#894467)并试一试 jQuery 插件。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-21T18:47:57.320

如果您不介意开销，请使用带有 ScrollTo 插件的 jQuery 库。可以在这里找到一个快速演示：http: [//demos.flesler.com/jquery/scrollTo/](http://demos.flesler.com/jquery/scrollTo/)

# c# - .net 使用什么哈希算法？爪哇呢？

> ID：894444
> 
> 赞同：3
> 
> 时间：2009-05-21T18:43:53.943
> 
> 标签：c#, java, hashtable

关于 HashTable（以及此类的后续衍生物），有人知道 .net 和 Java 使用什么散列算法吗？

List 和 Dictionary 都是 Hashtable 的直接降级吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-21T18:46:04.393

哈希函数没有内置在哈希表中；哈希表调用键对象上的方法来计算哈希。因此，散列函数根据关键对象的类型而有所不同。

在 Java 中，a`List`不是哈希表（也就是说，它不扩展`Map`接口）。可以在`List`内部使用哈希表（稀疏列表，其中列表索引是哈希表的键）实现 a，但这样的实现不是标准 Java 库的一部分。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-21T20:06:29.580

我对.NET 一无所知，但我会尝试为Java 发言。

在 Java 中，哈希码最终是给定对象的 hashCode() 函数返回的代码和 HashMap/ConcurrentHashMap 类中的二级哈希函数的组合（有趣的是，两者使用不同的函数）。请注意，Hashtable 和 Dictionary（HashMap 和 AbstractMap 的前身）是过时的类。列表实际上只是“其他东西”。

例如，String 类通过重复将当前代码乘以 31 并添加下一个字符来构造哈希代码。有关更多信息，请参阅我关于[字符串散列函数如何工作的](http://www.javamex.com/tutorials/collections/hash_function_technical.shtml)文章。数字一般使用“自己”作为哈希码；其他具有字段组合的类（例如 Rectangle）通常使用字符串技术的组合，即乘以一个小的素数并添加，但添加各种字段值。（选择质数意味着您不太可能在某些值和哈希码宽度之间获得“意外交互”，因为它们不会除以任何东西。）

由于哈希表的大小——即它所拥有的“桶”的数量——是2的幂，所以桶号基本上是通过去掉高位直到哈希码在范围内而从哈希码导出的。二级散列函数通过“散布位”来防止所有或大部分随机性都在那些高位中的散列函数，这样一些随机性最终会出现在低位中并且不会被截断。如果没有这种混合，String 哈希码实际上可以很好地工作，但用户创建的哈希码可能不会很好地工作。请注意，如果两个不同的哈希码解析为相同的桶号，Java 的 HashMap 实现使用“链接”技术——即它们在每个桶中创建一个条目的链接列表。它' s 因此对于散列码具有良好的随机性很重要，这样项目就不会聚集到特定范围的桶中。（然而，即使有一个完美的散列函数，你仍然会根据平均定律预计会发生一些链接。）

哈希码的实现不应该是个谜。您可以查看您选择的任何类的 hashCode() 源代码。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-21T18:56:00.410

HASHING 算法是用于确定 HashTable 中项目的哈希码的算法。

HASHTABLE 算法（我认为这是这个人所要求的）是 HashTable 用于根据其哈希码组织其元素的算法。

Java 恰好使用[链式](http://en.wikipedia.org/wiki/Hash_table#Separate_chaining)哈希表算法。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2015-05-04T17:11:19.917

在自己寻找相同的答案时，我在 .net 的参考源 @ [http://referencesource.microsoft.com](http://referencesource.microsoft.com)中找到了这个。

```
 /*
      Implementation Notes:
      The generic Dictionary was copied from Hashtable's source - any bug 
      fixes here probably need to be made to the generic Dictionary as well.
      This Hashtable uses double hashing.  There are hashsize buckets in the 
      table, and each bucket can contain 0 or 1 element.  We a bit to mark
      whether there's been a collision when we inserted multiple elements
      (ie, an inserted item was hashed at least a second time and we probed 
      this bucket, but it was already in use).  Using the collision bit, we
      can terminate lookups & removes for elements that aren't in the hash
      table more quickly.  We steal the most significant bit from the hash code
      to store the collision bit.

      Our hash function is of the following form:

      h(key, n) = h1(key) + n*h2(key)

      where n is the number of times we've hit a collided bucket and rehashed
      (on this particular lookup).  Here are our hash functions:

      h1(key) = GetHash(key);  // default implementation calls key.GetHashCode();
      h2(key) = 1 + (((h1(key) >> 5) + 1) % (hashsize - 1));

      The h1 can return any number.  h2 must return a number between 1 and
      hashsize - 1 that is relatively prime to hashsize (not a problem if 
      hashsize is prime).  (Knuth's Art of Computer Programming, Vol. 3, p. 528-9)
      If this is true, then we are guaranteed to visit every bucket in exactly
      hashsize probes, since the least common multiple of hashsize and h2(key)
      will be hashsize * h2(key).  (This is the first number where adding h2 to
      h1 mod hashsize will be 0 and we will search the same bucket twice).

      We previously used a different h2(key, n) that was not constant.  That is a 
      horrifically bad idea, unless you can prove that series will never produce
      any identical numbers that overlap when you mod them by hashsize, for all
      subranges from i to i+hashsize, for all i.  It's not worth investigating,
      since there was no clear benefit from using that hash function, and it was
      broken.

      For efficiency reasons, we've implemented this by storing h1 and h2 in a 
      temporary, and setting a variable called seed equal to h1\.  We do a probe,
      and if we collided, we simply add h2 to seed each time through the loop.

      A good test for h2() is to subclass Hashtable, provide your own implementation
      of GetHash() that returns a constant, then add many items to the hash table.
      Make sure Count equals the number of items you inserted.

      Note that when we remove an item from the hash table, we set the key
      equal to buckets, if there was a collision in this bucket.  Otherwise
      we'd either wipe out the collision bit, or we'd still have an item in
      the hash table.

       -- 
    */ 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-21T18:54:35.140

任何声称是 HashTable 或 .NET 中类似的东西都不会实现自己的散列算法：它们总是调用对象被散列的`GetHashCode()`方法。

尽管关于这个方法做什么或应该做什么，有很多困惑，特别是在涉及覆盖[基本 Object 实现](http://msdn.microsoft.com/en-us/library/system.object.gethashcode.aspx)的用户定义或其他自定义类时。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-05-21T18:55:14.530

对于 .NET，您可以使用 Reflector 查看各种算法。通用和非通用哈希表有不同的，当然每个类都定义了自己的哈希码公式。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-05-21T20:40:13.943

.NET`Dictionary<T>`类使用`IEqualityComparer<T>`计算键的哈希码并在键之间进行比较以进行哈希查找。`IEqualityComparer<T>`如果您在构造实例时不提供 an `Dictionary<T>`（它是构造函数的可选参数），它将为您创建一个默认值，默认情况下使用`object.GetHashCode`and`object.Equals`方法。

至于标准`GetHashCode`实现是如何工作的，我不确定它是否已记录在案。对于特定类型，您可以阅读 Reflector 中方法的源代码或尝试检查 Rotor 源代码以查看它是否存在。

# ruby-on-rails - 在 rails、facebook connect、facebooker 插件中销毁 cookie

> ID：894446
> 
> 赞同：4
> 
> 时间：2009-05-21T18:44:18.967
> 
> 标签：ruby-on-rails, ruby, facebook, cookies, session

所以我有一种奇怪的情况正在发生。我正在为 Rails 使用 Facebooker 插件，我希望用户能够使用他们的 Facebook 个人资料登录和注销。但是，一旦用户注销，如果我刷新页面，它会将他们重新登录。这仅在用户使用 facebook connect 登录时。

我认为问题在于流氓 cookie 只是重新实例化会话，因此我最好的猜测是手动销毁 cookie，但老实说，我不完全确定如何做到这一点。在单击注销之前和之后，我都打印了我的 cookie 列表（来自 request.cookies）。单击注销后，我仍然有这个cookie挥之不去......但不知道如何删除它。

fbsetting_0b78c8f2c95ce671470bdcb1c19e5070 {"connectState":1,"oneLineStorySetting":1,"shortStorySetting":1,"inFacebook":false}

在玩了一会儿之后，那个cookie甚至都不存在了……但是在刷新页面后，我再次登录了。

我在本地主机上做这一切......不确定这是否会导致问题。

有任何想法吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-10-19T17:21:06.930

这就是我在用户控制器中所拥有的

```
 def logout_facebook
    clear_facebook_session_information
    redirect_to root_url
  end 
```

这就是它的触发方式

```
<%= fb_logout_link("Logout out", "#{root_url}users/logout_facebook")%> 
```

这就是我在本地删除cookie的方法。

注意：不要忘记在你的路由中添加一个到 logout_facebook 方法的路由。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-21T20:16:53.413

销毁本地 cookie 不足以终止 Facebook Connect 会话。只要您在 facebook.com 域上仍然有活动会话，connect JS 库就会重新创建已销毁的 cookie，而您无法访问这些 cookie。

所有注销都必须通过调用连接库中的注销函数来处理。

例如，

```
<script>$H.fbconnect.logout();</script> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-22T17:15:14.913

要删除 cookie，您需要再次设置 cookie，并设置过去的过期日期。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2010-07-24T10:15:20.767

一百万感谢为如此疲惫的功能提供干净且全面的解决方案。自从我发现几乎所有新的facebooker用户都相信“facebook连接完全退出”这一事实后，我在过去两周内一直处于空白状态。或者可能只是缺少文档或一些代码摘录，直到日期我无法在 facebooker 封面文档中找到。

无论如何，远离这一切，转向让我实现它的解决方案......按照上面的@James B方法。

* * *

显然，我假设你们都已经阅读了 facebooker 的安装、配置和使用说明[http://github.com/mmangino/facebooker](http://github.com/mmangino/facebooker)。我还使用了一个插件“authlogic_facebook_connect”，您可以在 kalasjocke/authlogic_facebook_connect 的 github.com 页面上找到它。

现在我假设您已经通过使用 fb_login_button 或 authlogic_facebook_login_button 将您的应用程序配置为使用 facebook connect。单击它，您会看到一个弹出窗口，让您自己登录您的 Facebook 帐户和应用程序的本地帐户。登录后，您将获得一个 facebook_session 来处理在数据库中保存新用户（仅当您愿意时）。

默认情况下，您不会在 facebook_session 中获得用户的生日和电子邮件地址作为来自 facebook 的响应。要获得它们，您需要在 rhtml 页面的正文标记中的初始化 javascript 中使用类似的内容...

```
<%= fb_connect_javascript_tag %>   <%=
init_fb_connect "XFBML",{
:app_settings=>" {
permsToRequestOnConnect :
'email,user_birthday' }"} %>
<%= authlogic_facebook_login_button %> 
```

现在，我终于为退出 Facebook 和我的网站做了什么。

1.  在您的应用程序的标题内或登录、注销、登录用户名等将显示的任何地方...

    :删除 %>

这两个注销按钮适用于不同类型的用户...... 谁直接在您的网站上注册，b。谁通过 facebook 注册到您的网站

2.  routes.rb 中 logout_both 的路由

> map.connect "/logout_both", :controller=>"users", :action=>"logout_both"

3.  users_controller.rb 中 logout_both 的操作

    def logout_both current_user_session.destroy #clear_facebook_session_information flash[:notice] = "注销成功！" redirect_to root_path end #方法结束 logout_both

4.  您需要确保控制器中没有定义过滤器，这些过滤器可能会限制 logout_both 操作在没有会话的情况下执行。

5.  哦，是的，如果您想知道为什么“clear_facebook_session_information”会在操作中被注释掉。那么不用担心，在进入这个动作之前你已经退出了facebook，这行就不再需要了。老大，我们正在使用“fb_logout_link”，它首先将您注销，然后将您重定向到这个新操作。

嗯，就是这样。如果这不这样做............像我一样弄脏你的手......挖进去......自己解决它。Facebooker很深，但有一个明确的结局！！！

再次非常感谢 mangino 和 kalasjocke 让 facebook 连接几乎没有任何痛苦。

* * *

一个澄清的人...在我上面的答案中..有一个小问题，即..注销后，如果您刷新页面..它会再次显示您已登录您的网站..但是您已成功注销脸书的。我错了，一个大的澄清......事实上，你的“logout_both”动作中确实需要这两行

```
def logout_both <br/>
      current_user_session.destroy<br/>
      clear_facebook_session_information  #MANDATORY TO COMPLETELY CLEAR COOKIES<br/>
      reset_session  # TO BE 100% sure you can use it optionally<br/>
      flash[:notice] = "Logout successful!"<br/>
      redirect_to root_path   <br/>
end 
```

# ruby - 使用输入中的数字访问数组位置

> ID：894447
> 
> 赞同：-1
> 
> 时间：2009-05-21T18:44:52.833
> 
> 标签：ruby

编辑：第一部分删除我找到了答案。

我有以下问题：我从输入中读取一个数字并尝试使用该数字来访问给定的数组位置。我得到以下结果

```
value #=> "0"
value.to_i #=> 0
myArray[0] #=> MyObject
myArray[value.to_i] #=> nil 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-21T18:51:27.673

这对我行得通。

```
irb(main):012:0> myArray = ['first']
=> ["first"]
irb(main):013:0> value = '0'
=> "0"
irb(main):014:0> myArray[value.to_i]
=> "first" 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-21T21:43:28.683

感谢您的所有回复，我试图在一个类变量中访问和数组：

```
@myclass.myarray[value] 
```

当我创建一个 getter 方法并访问对象内部的 myarray 时，错误消失了。如果有人可以解释这种行为，请告诉我

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-21T18:52:03.350

尝试`myArray[Integer(value)]`（虽然也`value.to_i`适用于我）：

```
>> value = "0"
=> "0"
>> myArray = ["a", "b"]
=> ["a", "b"]
>> myArray[0]
=> "a"
>> myArray[Integer(value)]
=> "a" 
```

# wordpress - 使用 apt-get 安装 Web 应用程序的实例

> ID：894449
> 
> 赞同：1
> 
> 时间：2009-05-21T18:45:02.053
> 
> 标签：wordpress, ubuntu, mediawiki, apt-get, multisite

是否可以在 Web 服务器上拥有许多 MediaWiki 或 Wordpress 实例，由 apt-get 安装和自动升级？如果是这样，Ubuntu LTS 是否会使用仅安全补丁进行升级？

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-21T18:59:49.433

不，至少不是你想的那样。无法使用 apt-get 将同一软件包的多个实例安装到不同的位置。

也就是说，有相当多的 Web 应用程序旨在安装一次并在许多不同的域中运行。一份源代码副本，但配置为在许多虚拟主机上运行，​​所有虚拟主机都使用不同的配置和数据库。因此，这取决于您要安装的软件包。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-21T19:15:12.803

您可以将自己的包放在您自己的包存储库中，并将其地址添加到每个服务器的`/etc/apt/sources.list`，然后`apt-get update && apt-get upgrade`在所有服务器上调用以进行升级。

正如**Sander Marechal**所说，您通常不需要为每个服务实例提供单独的源代码副本。

# xml - 将 XML 导入数据集 C#

> ID：894451
> 
> 赞同：6
> 
> 时间：2009-05-21T18:45:18.620
> 
> 标签：xml, dataset

我正在尝试将 xml 文件放入数据集并使用以下代码：

```
DataSet ds = new DataSet("TestDataSet");
ds.ReadXml(FileName); 
```

这个xml文件：

```
<Catalog>
 <Rec>
   <ITEM dt:dt="string"/>
   <QTY dt:dt="string">1</QTY>
   <SUB dt:dt="string">1</SUB>
   <CATALOG dt:dt="string">ABC123</CATALOG>
  </Rec>
  <Rec>
   <ITEM dt:dt="string"/>
   <QTY dt:dt="string">1</QTY>
   <SUB dt:dt="string">1</SUB>
   <CATALOG dt:dt="string">ABC124</CATALOG>
  </Rec>
  <Rec>
   <ITEM dt:dt="string"/>
   <QTY dt:dt="string">1</QTY>
   <SUB dt:dt="string">1</SUB>
   <CATALOG dt:dt="string">ABC125</CATALOG>
  </Rec>
 </Catalog> 
```

问题是在ds上设置watch后，它似乎只包含一个名为Rec的表和一个名为Rec_Id的列。如果我删除 "dt:dt="String"" 数据类型一切正常。

我正在使用 C#.net 2008 ...

有人可以建议在无需更改 xml 文件的情况下导入此数据的正确方法吗？

谢谢

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-21T19:21:11.077

一旦您定义了在 XML 元素中使用的 XML 命名空间，您就可以轻松地导入它——没问题。

你需要让你的 XML 看起来像这样：

```
<Catalog xmlns:dt="some-xml-namespace-here">
 <Rec>
   <ITEM dt:dt="string"/>
   <QTY dt:dt="string">1</QTY>
   <SUB dt:dt="string">1</SUB>
   <CATALOG dt:dt="string">ABC123</CATALOG>
  </Rec>
  .....
 </Catalog> 
```

在我这样做之后，你的两行代码就像一个魅力一样工作，数据被导入，没问题（进入数据集中的 5 个表）。

马克

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-21T18:55:09.320

为了让 ReadXml 在这种情况下正常运行，我认为您需要在 XML 文件中指定一个模式。否则，读者将不知道如何处理这些数据类型。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-23T21:20:19.680

```
DataSet ds = new DataSet("Whatev");
DataTable catalog = ds.Tables.Add("Catalog");
DataColumn recCol = catalog.Columns.Add("Rec");
DataTable rec = ds.Tables.Add("Rec");

rec.Columns.AddRange(new DataColumn[] { 
    new DataColumn("ITEM", typeof(string)), 
    new DataColumn("QTY", typeof(string)),
    new DataColumn("SUB", typeof(string)),
    new DataColumn("CATALOG", typeof(string))
});            

XmlDocument doc = new XmlDocument();
doc.LoadXml(xml);
foreach (XmlNode recNode in doc.GetElementsByTagName("Rec"))
{
    DataRow row = rec.Rows.Add(
        recNode["ITEM"].InnerText,
        recNode["QTY"].InnerText,
        recNode["SUB"].InnerText,
        recNode["CATALOG"].InnerText);
} 
```

你去吧。现在将有两个表，Catalog 和 Rec。我怀疑你只想要 Rec，因为 Catalog 没用。因此，如果是这种情况，只需删除目录数据表代码，或者为每个目录行添加一个 id 属性并将其链接到 rec：

```
DataSet ds = new DataSet("Whatev");
DataTable catalog = ds.Tables.Add("Catalog");
DataColumn idCol = catalog.Columns.Add("Id");
DataTable rec = ds.Tables.Add("Rec");

rec.Columns.AddRange(new DataColumn[] { 
    new DataColumn("ITEM", typeof(string)), 
    new DataColumn("QTY", typeof(string)),
    new DataColumn("SUB", typeof(string)),
    new DataColumn("CATALOG", typeof(string))
});

catalog.ChildRelations.Add("catToRecRelation", idCol, rec.Columns["CATALOG"]);

XmlDocument doc = new XmlDocument();
doc.LoadXml(xml);
foreach (XmlNode recNode in doc.GetElementsByTagName("Rec"))
{
    // Create id in parent Catalog node, based on CATALOG value
    catalog.Rows.Add(recNode["CATALOG"].InnerText);

    DataRow row = rec.Rows.Add(
    recNode["ITEM"].InnerText,
    recNode["QTY"].InnerText,
    recNode["SUB"].InnerText,
    recNode["CATALOG"].InnerText);
}

var childRows = catalog.Rows[0].GetChildRows("catToRecRelation"); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-21T19:39:21.260

这将使它可解析。dt 命名空间通常是指 xmlns:dt="urn:schemas-microsoft-com:datatypes"。某些东西或某人弄乱了您的 XML，但如果您必须能够导入它，您只需修改目录元素上的 xmlns 属性，如下所示：

```
 string xml = @"<Catalog xmlns=""dt"" xmlns:dt=""dt"">
                        <Rec>
                        <ITEM dt:dt=""string""/>   
                        <QTY dt:dt=""string"">1</QTY>   
                        <SUB dt:dt=""string"">1</SUB>   
                        <CATALOG dt:dt=""string"">ABC123</CATALOG>  
                        </Rec>  
                        <Rec>   
                        <ITEM dt:dt=""string""/>   
                        <QTY dt:dt=""string"">1</QTY>   
                        <SUB dt:dt=""string"">1</SUB>   
                        <CATALOG dt:dt=""string"">ABC124</CATALOG>  
                        </Rec>  
                        <Rec>   
                        <ITEM dt:dt=""string""/>   
                        <QTY dt:dt=""string"">1</QTY>   
                        <SUB dt:dt=""string"">1</SUB>   
                        <CATALOG dt:dt=""string"">ABC125</CATALOG>  
                        </Rec> 
                        </Catalog>";

        DataSet ds = new DataSet("Whatev");

        TextReader txtReader = new StringReader(xml);
        XmlReader reader = new XmlTextReader(txtReader);
        ds.ReadXml(reader);
        Debug.Assert(ds.Tables.Count ==5);
        Debug.Assert((string)ds.Tables[2].Rows[0][0] == "string");
        Debug.Assert((string)ds.Tables[3].Rows[0][1] == "1"); 
```

Marc 也是正确的，但是通过上面的定义，您可以生成匹配的模式：

```
<xs:schema xmlns:dt="dt" attributeFormDefault="unqualified" elementFormDefault="qualified" targetNamespace="dt" xmlns:xs="http://www.w3.org/2001/XMLSchema"><xs:element name="Catalog"><xs:complexType>    <xs:sequence><xs:element maxOccurs="unbounded" name="Rec"><xs:complexType><xs:sequence><xs:element name="ITEM"><xs:complexType><xs:attribute ref="dt:dt" use="required" /></xs:complexType></xs:element><xs:element name="QTY"><xs:complexType>
              <xs:simpleContent><xs:extension base="xs:unsignedByte"><xs:attribute ref="dt:dt" use="required" /></xs:extension></xs:simpleContent></xs:complexType>
          </xs:element><xs:element name="SUB"><xs:complexType><xs:simpleContent><xs:extension base="xs:unsignedByte"><xs:attribute ref="dt:dt" use="required" /></xs:extension></xs:simpleContent></xs:complexType></xs:element><xs:element name="CATALOG"><xs:complexType><xs:simpleContent><xs:extension base="xs:string"><xs:attribute ref="dt:dt" use="required" /></xs:extension></xs:simpleContent></xs:complexType></xs:element></xs:sequence></xs:complexType></xs:element></xs:sequence></xs:complexType></xs:element><xs:attribute name="dt" type="xs:string" /></xs:schema> 
```

属性“dt”是参考属性。因此，如果没有 xmlns="ds" 声明，xml 也不能对任何模式有效。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-08-07T16:43:01.463

我用这个代码...

要生成 XML：

```
// you need to create a datatable, from a sql query, linq, your choice...
DataTable _dt = new DataTable();
// write the datatable with schema
dt.WriteXml("datatable.xml", XmlWriteMode.WriteSchema); 
```

要读取 XML：

```
DataTable dt = new DataTable ();
dt.Clear();
dt.ReadXml("datatable.xml", XmlReadMode.ReadSchema); 
```

结果数据表可以用这些函数来补充，这样你就可以把它转换成`IList`，你需要创建一个具有相同列模式的对象，这样真的更实用：

```
public IList<T> toList<T>(DataTable table)
{
    List<T> list = new List<T>();
    T item;
    Type listItemType = typeof(T);

    for (int i = 0; i < table.Rows.Count; i++)
    {
        item = (T)Activator.CreateInstance(listItemType);
        mapRow(item, table.Rows[i], listItemType);
        list.Add(item);
    }
    return list;
}
private void mapRow(object vOb, System.Data.DataRow dr, Type type)
{
    try
    {
        for (int col = 0; col < dr.Table.Columns.Count; col++)
        {
            var columnName = dr.Table.Columns[col].ColumnName;
            var prop = type.GetProperty(columnName.ToUpper());
            object data = dr[col];
            prop.SetValue(vOb, data, null);
        }
    }
    catch (Exception ex)
    {
        throw ex;
    }
} 
```

实际上，我正在开发一个使用从 SQL 表生成的 XML 的应用程序。基本上，使用上面的功能，我创建了其他小应用程序（以支持第一个），它扫描 XML 包（每个表的 XML）并创建层业务、访问、对象和流控制，以便正确写入和读取XML。

# ant - 将 ant 与构建配置文件一起使用

> ID：894459
> 
> 赞同：1
> 
> 时间：2009-05-21T18:46:46.183
> 
> 标签：ant, build-automation

我正在尝试通过使用带有 ant 的配置文件来自定义我的构建。我打算做的是使用具有以下模式的配置文件：文件路径，要匹配的模式，要替换的模式

我希望这样我只需将内容添加到配置文件中，然后 ant 构建脚本就会读取这些值并进行所需的更改。

我已经知道如何在文件中进行正则表达式查找和替换。我正在寻找的是一种从这样的配置文件中读取值的方法。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-21T22:33:41.483

在 Ant 中有多种方法可以从文件中读取信息。

通用的是[LoadFile Ant Task](http://ant.apache.org/manual/Tasks/loadfile.html)。但是，我会推荐[loadProperties Task](http://ant.apache.org/manual/Tasks/loadproperties.html)。您可以使用此任务来读取属性，例如：toReplace=string_to_replace with=replacement_string，然后在您的正则表达式中使用属性“toReplace”和“with”。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-01T10:35:09.053

如果我对您的理解正确，您想为各种环境生成一组配置文件。

我目前使用的解决方案是由 Ant 任务调用的 Groovy 脚本。由于 Ant 不允许您重新定义已设置的属性，因此使用它来生成具有不同值的多个文件是相当棘手的。

如果您想探索这一点，只需看看[Groovy](http://groovy.org/)，尤其是[Template Engine](http://groovy.codehaus.org/Groovy+Templates)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-09-08T19:22:33.153

我会在 ant 中使用 filterset 功能。您可以使用模式@replace_me@ 创建带有要替换的字符串的配置文件的参数化版本。然后定义一个属性文件来定义替换值。你可以

```
<copy toDir="${dist.dir}/docs">
  <fileset file="config.xml"/>
  <filterset>
    <filtersfile file="path/to.properties"/>
  </filterset>
</copy> 
```

那么属性文件就是 name=value 行。

您可以灵活地指定文件集和过滤器集，请参阅 Ant 文档。

# datetime - 如何将 int 90 分钟转换为 DateTime 1:30？

> ID：894461
> 
> 赞同：19
> 
> 时间：2009-05-21T18:47:04.547
> 
> 标签：datetime, c#-3.0

例如，如何在 C# 3.0 中将 int 90 转换为 DateTime 1:30？

谢谢！！

* * *

## 回答 #1

> 赞同：44
> 
> 时间：2009-05-21T18:48:06.727

您不应该使用 DateTime 来表示时间跨度 - 为此使用 TimeSpan。在这种情况下，你会使用这个：

```
TimeSpan ts = TimeSpan.FromMinutes(90); 
```

如果您坚持需要 DateTime，您可以执行以下操作：

```
DateTime dt = DateTime.Now.Date; // To get Midnight Today
dt = dt.AddMinutes(90); // to get 90-minutes past midnight Today. 
```

但是，您可能不想使用 DateTime 的原因是它（恰当地命名）将日期的概念与时间的概念结合在一起。您的问题表明您打算忽略日期组件，因此为了使用正确的工具来完成工作，我建议使用 TimeSpan。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2010-12-11T19:43:00.183

如果你使用**C# 4** ( *VS 2010* ) 你需要这个片段：

```
TimeSpan ts = TimeSpan.FromSeconds(90);
txtDate = string.Format("Full time: {0}", new DateTime(ts.Ticks).ToString("HH:mm:ss")); 
```

它输出

```
Full time: 00:01:30 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-21T18:55:30.333

或者，如果您尝试仅使用日期将时间添加到 DateTime：

```
DateTime dt = dateTime.AddMinutes(90); 
```

# programming-languages - 我需要一个 DSL 来计算时间

> ID：894463
> 
> 赞同：4
> 
> 时间：2009-05-21T18:47:13.283
> 
> 标签：programming-languages, dsl

有谁知道用于时间计算的 DSL，能够理解诸如“本月最后一个工作日之后的第二个工作日”之类的概念？

我不介意编写解析器，但我需要语言本身的帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-21T23:08:43.363

所有这类东西的典型来源是Nachum Dershowitz 和 Ed Reingold 的[日历计算](http://emr.cs.uiuc.edu/home/reingold/calendar-book/index.shtml)。首先，它是有史以来最受欢迎的 SP&E 论文；那是一本书；现在它已经是第三版了。有一次您可以下载 Lisp 代码，但该功能似乎已从网页中消失。还有一个小程序，很容易重新实现；我已经在 Icon 和 Lua 中完成了实现。

所以我建议你真正想要的是他们的库，然后如果你想要一个解析器，你就知道该怎么做。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-23T23:21:03.337

看看 Jay Muntz 的“[动态假期日期计算器](http://www.codeproject.com/KB/dotnet/HolidayCalculator.aspx)”。

这是一个不同的用例，但除非您被所有 XML 关闭，否则可以在您的案例中使用相同类型的表示语言。我发现定义自定义日历很容易使用。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-10-20T15:51:54.357

对于 Java，[Joda 时间](http://joda-time.sourceforge.net/)真的很流畅！

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-22T19:28:24.117

这可能不是您想要的，但您可能想看看 Chronic，一个 Ruby 库，用于执行以下操作：

[http://chronic.rubyforge.org/](http://chronic.rubyforge.org/)

# sql-server - SSRS 2008 查询参数

> ID：894464
> 
> 赞同：2
> 
> 时间：2009-05-21T18:47:13.780
> 
> 标签：sql-server, reporting-services, ssrs-2008

我有一份报告需要显示来自不同位置或所有位置的会计数据。

表销售：

```
PartId    Rev     LocId
1         $10     1
2         $2      1
3         $5      2 
```

可以说查询是这样的基本的东西来获得所有收入：

```
SELECT SUM(rev) FROM Table_sales 
```

如果我希望能够将报告限制在特定位置，则必须将其更改为：

```
SELECT SUM(Rev) FROM Table_sales WHERE LocId = @param 
```

但是，如果我这样做了，我将如何在没有多个查询的情况下获得所有位置？

仅供参考，SQL 2008 Filter 选项似乎不适用于我正在使用的实际查询，因为实际查询使用分组功能。

SSRS 2008 DataSet 查询也可以是表达式，但我似乎无法让它工作。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-21T19:10:22.860

我不确定您在 SSRS 2008 中提到的过滤器选项或数据集查询，但在一些旧版本的 SSRS 中，我见过这样的东西：

```
SELECT SUM(Rev) FROM Table_sales WHERE LocId = @param or 'All' = @param 
```

我怀疑这是执行此操作的最有效方法，但它允许您有 1 个查询，您可以在其中选择所有结果（通过将术语“全部”作为参数传递）或只选择您想要的 LocId（通过传递适当的 LocId 作为参数）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-22T08:34:41.650

也许你可以使用它：

```
SELECT SUM(Rev) FROM Table_sales WHERE LocId IN (@param) 
```

# php - 将所有代码更改为面向对象会使内存使用量更大或更小吗？

> ID：894465
> 
> 赞同：2
> 
> 时间：2009-05-21T18:47:21.630
> 
> 标签：php, oop

有一个用 PHP 编写的项目，它只是简单的所有程序......逐步调用 DB 函数、处理和打印输出。然后改为完全面向对象——App对象有一个单例，通过App对象调用各种函数。

有人声称服务器上的内存使用或占用空间会更少。会是这样吗？我认为程序通常只使用最小限度，而具有各种设计模式的面向对象编程通常会实例化比需要更多的东西，或者只是在周围有对象，而程序通常只有最小限度。

那么将所有代码更改为面向对象实际上会使服务器上的内存使用量更小吗？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-05-21T18:51:33.943

它可能会变得更多，但真的没有办法说出来。如果您的代码实际上通过以 OOP 方式进行改进，那么它可能会更少。使用的内存与面向对象的存在之间没有直接的关联。也许一般来说，面向对象需要更多的内存，但前提是两组代码都写得一样好，而且几乎从来没有这种情况。

此应用程序升级为面向对象是否有原因？你知道这不是一个或另一个，你可以混合和匹配碎片...... OOP 不是灵丹妙药。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2011-07-22T21:39:02.617

不幸的是，我也做过测试。我测试了速度，结果差不多，但是在 PHP 中测试内存使用获取 memory_get_usage() 时，我看到 OOP 方面的数字要大得多。

OOP 为 116,576 字节，程序为 18,856 字节。我知道“硬件很便宜”，但是来吧！使用量增加 1,000%？抱歉，这不是最佳选择。有这么多用户同时访问您的网站，我敢肯定您的 RAM 会烧毁或耗尽。我错了吗？

基本上，我从所有 OOP 粉丝那里听到的是……您将使用更多资源，它与编写好的过程函数调用一样快，但对于大型项目和多开发人员环境会更好。需要找到一个平衡点。

**更多的开发者（草率的开发者）和更大的网站**

缺点：您的应用程序使用了更多 RAM。

优点：更容易在整个应用程序中维护许多代码。

**具有简单站点的开发人员**

缺点：如果您的网站增长，或开始包含许多开发人员，如果您的程序代码很糟糕，开发可能会慢一些。

优点：内存低，速度稍快。如果您的代码编写得当（而且只有优秀的开发人员才能做到这一点——哈哈），您的代码将同样易于维护。

在 RAM 战争中，程序获胜。在可维护性战争中，好的代码获胜。;)

OOP 粉丝说 OOP 更干净。我看到了一些非常混乱的 OOP 代码，然后我看到了一些非常干净的过程代码，这些代码是由可以用任何语言或风格编写出色代码的开发人员编写的。使工作愉快的代码。底线是，如果你有草率的开发人员，那么无论你使用哪种风格，你都会有草率的代码。

由于我自己的个人基准，我选择退出内存猪 OOP，主要是因为我确实编写了非常干净的程序，而且我通常是我所有项目中唯一的开发人员。

干杯!

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-05-21T19:18:57.867

你的问题对我来说是这样的：*我们有一个不可维护的代码库，用 Java 重写它会使其更快吗？*

首先，您需要确定问题：您的代码是否不可读和/或难以维护，或者您的程序的运行时占用空间是否太大？这是两个**完全**不同的问题。

如果您有一个难以维护的代码库（听起来像您这样做），您将无法通过使用另一种范例重写代码来解决这个问题。为什么代码不可读？开发人员是否编写了不可读的代码，然后用 Java 或 C# 重写它只会给您提供面向对象的不可读代码。在这种情况下，您需要提高开发人员的技能（雇用更好的开发人员、重新培训现有的开发人员等）。

如果您有内存占用问题，那么您应该像处理任何其他性能问题一样处理它。首先**测量**，然后做一些优化（重写一些代码以提高内存效率），然后**再次测量**。之前**和**之后的测量对于确保您不会让事情变得更糟很重要。相信我，即使是非常优秀的程序员也会犯这个错误。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-21T19:36:46.957

答案是肯定的和否定的。

通过切换到更面向对象的体系结构，您*可以*减少内存占用，但前提是且仅当代码更高效时。

没有任何函数调用或对象调用的直接 PHP 相当快。一旦您开始进行函数调用或对象调用，事情就会开始变得慢得多。

来自[Python Vs Ruby Vs。Python Benchmark](http://xodian.net/serendipity/index.php?/archives/27-Benchmark-PHP-vs.-Python-vs.-Perl-vs.-Ruby.html)执行增量循环的 OO 策略耗时 3.7079 秒，面向函数的策略耗时 4.3501 秒，两者都不使用耗时 0.6164 秒。用 OO vs. Procedural Vs. 做一个简单的“Hello World”应用程序。两者都没有产生 4.1248 秒、3.7656 和 0.9309 秒。

因此，根据您的代码在做什么以及它是如何做的，对象可能更快或更慢，内存密集型或内存密集型更少，或者两者都不是。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-21T19:38:17.470

> 然后改为完全面向对象——App对象有一个单例，通过App对象调用各种函数。

这实际上听起来几乎*与“完全面向对象”相反*。这表明对“面向对象”意味着什么的理解程度很可能不会导致内存占用减少。

一般来说，设计对内存占用的影响要比编程范式大得多，尽管*平均而言*，面向对象的应用程序往往占用更大的内存可能是真的。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-05-22T09:16:03.377

内存使用不是 OO 的优势。OO 的优点是代码将变得更易于维护。如果您没有性能问题，则无需寻找提高效率的方法。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-05-22T09:28:47.877

除了其他评论，我想说 OO 有助于减少冗余......这可能会使您的代码更高效，并减少内存占用。当然，OO 的开销更大，但在大型项目中应该会更有效。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2020-10-19T03:46:30.197

代码 1：面向对象

```
<?php
$a = microtime(true);

class Fruit {
    public $name;

    function set_name($name) {
      echo memory_get_usage()."<br>";
      $this->name = $name;
    }

    function get_name() {
      echo memory_get_usage()."<br>";
      return $this->name;
    }

}

$fruit = new Fruit();
$fruit -> set_name("A");
echo $fruit -> get_name()."<br>";

echo memory_get_usage()."<br>";
echo microtime(true)-$a;
?> 
```

代码 2：程序

```
<?php

$a = microtime(true);

function set_name($name) {
    echo memory_get_usage()."<br>";
    return $name;
  }

  function get_name($input) {
    echo memory_get_usage()."<br>";
    return $input;
  }

$fruit = set_name("A");
echo get_name($fruit)."<br>";

echo memory_get_usage()."<br>";
echo microtime(true)-$a;

?> 
```

```
输出 1 OOP：
395168
395168
一种
395168
1.8119812011719E-5

输出 2 程序：
394104
394104
一种
394104
1.0967254638672E-5

XAMPP，PHP 版本 7.3.1，Windows NT 10.0 build 19041 (Windows 10) i586

```

# database - 如何存储可缩放大小的可扩展事件日志？

> ID：894471
> 
> 赞同：0
> 
> 时间：2009-05-21T18:48:43.310
> 
> 标签：database, data-structures, file-io

我一直在考虑编写一个简单的“事件日志”，它需要一个参数列表并将事件消息存储在一个日志文件中，麻烦的是，我预见这个文件会变得相当大（假设 1M 条目或更多）问题是，如何我可以在不拔牙的情况下实施这个系统吗，我知道 SQL 是一种可能的方法。

如果我不发疯的话，XML 将是理想的，但对于可伸缩性来说并不实用。

示例日志条目

-----时间日期-------- ---------发件人-------------- --------标签---------- --消息---------

2008 年 12 月 24 日 24:00:00 $DOMAIN\SYSTEM\Application$ :Trivial: :Notification: It's Christmas in 1s

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-21T18:51:41.167

[我们已经成功地在Apache Lucene](http://lucene.apache.org/)中存储了大量事件

# asp.net-mvc - ASP.NET MVC 是否使用常规工具箱控件？

> ID：894473
> 
> 赞同：5
> 
> 时间：2009-05-21T18:50:49.873
> 
> 标签：asp.net-mvc, controls

在 ASP.NET MVC 中，我是否使用工具箱中的“常规”控件并将数据分配给它们，就像使用 web 表单一样？例如，我可以使用 gridview 吗？

谢谢你。

编辑：答案似乎是否定的。那你用什么？Visual Studio 中是否有任何拖放控件，例如 webform 控件？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-05-21T19:04:54.307

在大多数情况下，MVC 的使用显然不是拖放事件。也没有自动装配数据绑定控件的级别。MVC 结构中的目的是对标记进行更直接的控制。有一些辅助方法可用于呈现表单控件。MVC 是一种非常不同的服务器端开发模型。注意，您可以将 ASP.Net 与 MVC 组合成一个混合项目。

我建议您需要非常熟悉 HMTL 标记，以及 HTTP + HTML 通信的工作原理，才能在 MVC 项目中取得成功。javascript的使用也很明确。MVC 在将关注点与后端和基于 Web 的应用程序中的前端分离方面非常好。与前端渲染相比，这使得后端逻辑的设计和测试更加容易。它是 Web 开发人员的框架（基于 Web 的应用程序是第一个关注点），而不是 Web 前端的开发人员框架（基于 ASP.Net 控件）。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-21T18:59:11.557

ASP.Net MVC 专注于使用您的视图模板生成您自己的 HTML。您不能在视图中使用 Webform 控件并让应用程序以与 Webforms 相同的方式处理它们。它们可能会正确呈现，但没有回发功能或维护其状态的概念。

话虽如此，您也可以将 ASP.Net Webforms 与您的 MVC 样式页面集成。您可以随时查看具有“混合”asp.net 应用程序的经典 Hanselman 演练： [http ://www.hanselman.com/blog/PlugInHybridsASPNETWebFormsAndASPMVCAndASPNETDynamicDataSideBySide.aspx](http://www.hanselman.com/blog/PlugInHybridsASPNETWebFormsAndASPMVCAndASPNETDynamicDataSideBySide.aspx)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-21T18:53:19.743

我相信您可以使用任何不依赖回发功能的控件。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-26T02:40:25.893

答案是肯定的和否定的。最好是否定的。

这就是社区所担心的，将 asp.net 和 MVC 激进地混合成一个无法识别且不必要的复杂组合。

对于任何关注 MVC 的人，我建议：

*   欣赏干净简单的 HTML。清空你的工具箱:-)
*   浏览并学习如何编写控件以按照您需要的方式生成控件。强类型、强大的 html 生成器将会出现，但我希望它们干净且不包含在控件中，我想查看代码。
*   尽量不要混合 asp.net 和 mvc（诱人），但除非你被迫这样做，否则认为这是一个禁忌

所以要回答你的问题，MVC 仍然是新的，MVC Contrib、MVC Futures 和 Html 助手在框架和整个网络中都是可用的。继续浏览并保留您自己的调整库，然后发布它们，以便其他人可以找到并改进它们，反之亦然。MVC 可以成为 .net 社区一直在等待的改变，我们不要这么快回去拖放。

祝你好运！

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-21T18:53:21.867

不，任何使用`__doPostBack`JavaScript 函数触发回发的控件都不起作用。此外，在 ASP.NET MVC 中也没有 的概念，`ViewState`因此任何依赖于 ViewState 或 ControlState 的控件也将不起作用。

ASP.NET MVC 背后的想法是采用与较重的 WebForms 模型（及其大部分控件）不同的方法。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-21T18:53:51.617

您不能直接在 ASP.NET MVC 中使用 WebForms 控件。
但是您可以将任何控件包装在 HTML 帮助器中。

一个 GridView 示例：

```
public static class MvcGrid
    {
        public static string MyGrid(this HtmlHelper helper)
        {
            var grid = new GridView();
            var source = new[]
                             {
                                 "Foo",
                                 "Bar",
                             };
            grid.DataSource = source;
            grid.DataBind();
            var stringWriter = new StringWriter();
            var writer = new HtmlTextWriter(stringWriter);
            grid.RenderControl(writer);

            return stringWriter.ToString();
        }
    } 
```

但这不会起到 WebForm GridView 的作用。
它仅用于呈现 HTML。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-05-21T18:59:11.480

WebForms 工具箱中的一些控件在 ASP.NET MVC 中可以正常工作（尽管我相信`GridView`它们不是其中之一......）。关键是你不能使用依赖于任何一个的控件

*   回发（`__doPostback()`javascript 函数），或
*   视图状态

但是，我不确定您是否真的*想*使用这些控件。ASP.NET MVC 的主要思想之一是*重新获得对 html 标记的控制*权——这是`GridView`. 如果你想要一个可重用的网格布局来呈现数据，我建议使用 a`PartialView`或 an类，具体取决于数据的复杂性`Extension Method`。`HtmlHelper`

# python - python中的多服务器监视器/自动重启器

> ID：894474
> 
> 赞同：3
> 
> 时间：2009-05-21T18:51:07.767
> 
> 标签：python, linux, bash, restart

我有 2 个必须使用 GNU Screen 启动的服务器程序。我想通过一个基于 Python 的程序来加强这些服务器以防止崩溃，该程序启动每个屏幕会话，然后监视服务器进程。如果服务器进程崩溃，我需要 python 代码来终止无关的屏幕会话并再次使用屏幕重新启动服务器。

我对 python 很陌生，但我正在利用这个机会自学。我知道这可以在 bash 脚本中完成。但我想在此代码的基础上构建未来的功能，所以它需要只是 python。

伪代码如下：

```
thread-one {
     While 1:
     start server 1 using screen
     wait for server to end
     end while
}

thread-two {
     While 1:
     start server 2 using screen
     wait for server to end
     end while
} 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-21T19:37:16.130

“需要多线程来处理两个单独程序的重新启动”

不明白为什么。

```
import subprocess

commands = [ ["p1"], ["p2"] ]
programs = [ subprocess.Popen(c) for c in commands ]
while True:
    for i in range(len(programs)):
        if programs[i].returncode is None:
            continue # still running
        else:
            # restart this one
            programs[i]= subprocess.Popen(commands[i])
        time.sleep(1.0) 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-21T19:23:00.090

你真的不应该在屏幕上运行生产软件。如果服务器重新启动，您将如何启动它？手动？此外，我认为您正在尝试重新发明轮子。已经有很好的工具可以做你需要的事情。

> [launchtool](http://freshmeat.net/projects/launchtool/)允许您运行用户提供的命令，以多种方式监督其执行，例如控制其环境、阻塞信号、记录其输出、更改用户和组权限、限制资源使用、如果失败则重新启动、连续运行、转向它变成一个守护进程，等等。

.

> [Monit](http://mmonit.com/monit/)是一个免费的开源实用程序，用于管理和监视 UNIX 系统上的进程、文件、目录和文件系统。Monit 进行自动维护和修复，并且可以在错误情况下执行有意义的因果操作。

# architecture - 部分保存数据输入

> ID：894482
> 
> 赞同：0
> 
> 时间：2009-05-21T18:52:12.460
> 
> 标签：architecture, orm, persistence

场景：用户输入复杂数据（WPF 前端）并使用一些 OR-mapper 将数据持久化到 SQLServer 中。我使用 Telerik 的 OpenAccess。

但是现在想想以下情况：一个用例几乎完成了工作，但是现在缺少一些信息。因为他输入的数据不符合所有业务规则（必填字段可能仍为空），他无法保存他的工作。

但不幸的是，他也无法获得丢失的信息。那他能做什么。放弃整个工作，坏主意，什么都不做，而不是等待，没有好主意。

现在我的想法出现了。如果用户可以“停放”他未解决的问题并开始处理一些不同的用例，那将会很有帮助。而且，在他停止工作后，他可以关闭系统并尝试在另一天解决它。（顺便说一句，他可以在其他系统上继续）

但是，在哪里序列化？业务对象不可序列化，因为它包含来自 ORM 的一些身份信息。引入一些中间对象会爆炸赋值语句。用户界面？

也许，有人知道现有的解决方案，或者确实有一些好主意。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-21T18:57:31.920

使用状态字段来跟踪它是否符合所有规则。允许它保存而不考虑规则，但将其标记为这样。当它有效时更改标志。只让其他用户查看/使用有效项目。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-21T18:58:46.863

备忘录模式怎么样？获取所有可序列化的数据并将其放入另一个类中，然后对其进行序列化并将其保存到数据库中。再次需要时，反序列化到 memento 类中，然后填充原始对象。

# asp.net-mvc - ASP.NET MVC - 复选框文本属性

> ID：894488
> 
> 赞同：0
> 
> 时间：2009-05-21T18:53:44.330
> 
> 标签：asp.net-mvc, checkbox

我在一个循环中绘制了一些复选框，我想根据我正在循环迭代的对象设置文本属性。

我有这样的事情：

`<asp:CheckBox ID=`"CheckBox1 `" runat=`"服务器`" Text=`" `<%= Html.Encode(item.nome) %>`" Checked="true"/>

问题是 Html.Encode(item.nome) 显示为纯文本，如果我不使用引号，我会收到错误消息。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-05-21T19:14:18.627

或者，使用`Html.CheckBox`帮助程序。

```
<%= Html.CheckBox( "CheckBox1", true ) %> <%= Html.Encode(Item.none) %> 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-21T19:05:08.863

不要使用`<asp:CheckBox>`控件 - 创建一个标准的 html 复选框：

```
<input type="checkbox" name="cb" checked="checked"><%= Html.Encode(item.nome) %></input> 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-21T19:20:06.617

不能将 ASP.NET 控件标记与`<%= %>`语法混合。您在这里有两个选择：

为您的复选框使用原始 HTML，然后您就可以`<%= %>`正常使用。这种风格更适合 ASP.NET MVC。

```
<input type="checkbox" name="cb" checked="checked"><%= Html.Encode(item.nome) %></input> 
```

或者您可以使用 ASP.NET 控件友好的数据绑定语法：

```
<asp:CheckBox ID="CheckBox1" runat="server" Text='<%# Html.Encode(Container.DataItem, "nome") %>' Checked="true"/> 
```

但是要使用数据绑定语法，您需要一个数据源控件并位于一个Repeater 控件中。有关详细信息，请参阅[ASP.NET 数据绑定](http://support.microsoft.com/kb/307860)。

# sql - SQL 左连接与 FROM 行上的多个表？

> ID：894490
> 
> 赞同：284
> 
> 时间：2009-05-21T18:53:56.793
> 
> 标签：sql, syntax, join

大多数 SQL 方言接受以下两种查询：

```
SELECT a.foo, b.foo
FROM a, b
WHERE a.x = b.x

SELECT a.foo, b.foo
FROM a
LEFT JOIN b ON a.x = b.x 
```

现在很明显，当您需要外连接时，需要第二种语法。但是在进行内部连接时，为什么我应该更喜欢第二种语法而不是第一种（反之亦然）？

* * *

## 回答 #1

> 赞同：339
> 
> 时间：2009-05-21T19:25:07.683

`WHERE`在大多数现代数据库中，不推荐使用仅列出表并使用子句指定连接条件的旧语法。

这不仅仅是为了展示，当您在同一查询中同时使用 INNER 和 OUTER 联接时，旧语法可能会产生歧义。

让我给你举个例子。

假设您的系统中有 3 个表：

```
Company
Department
Employee 
```

每个表包含许多行，链接在一起。你有多个公司，每个公司可以有多个部门，每个部门可以有多个员工。

好的，所以现在您要执行以下操作：

> 列出所有公司，包括他们的所有部门和所有员工。请注意，有些公司还没有任何部门，但请确保您也将它们包括在内。确保只检索有员工的部门，但始终列出所有公司。

所以你这样做：

```
SELECT * -- for simplicity
FROM Company, Department, Employee
WHERE Company.ID *= Department.CompanyID
  AND Department.ID = Employee.DepartmentID 
```

请注意，最后一个是内部连接，以满足您只希望部门有人员的标准。

好的，那么现在会发生什么。好吧，问题是，它取决于数据库引擎、查询优化器、索引和表统计信息。让我解释。

如果查询优化器确定这样做的方法是先获取公司，然后找到部门，然后与员工进行内部联接，那么您将不会得到任何没有部门的公司。

这样做的原因是该`WHERE`子句确定最终结果中的哪些*行，而不是行的各个部分。*

在这种情况下，由于左连接，Department.ID 列将为 NULL，因此当涉及到 Employee 的 INNER JOIN 时，没有办法满足 Employee 行的约束，所以它不会出现。

另一方面，如果查询优化器决定先处理部门-员工联接，然后与公司进行左联接，您将看到它们。

所以旧的语法是模棱两可的。如果不处理查询提示，就无法指定您想要的内容，有些数据库根本没有办法。

输入新语法，您可以使用它进行选择。

例如，如果您想要所有公司，如问题描述所述，您将这样写：

```
SELECT *
FROM Company
     LEFT JOIN (
         Department INNER JOIN Employee ON Department.ID = Employee.DepartmentID
     ) ON Company.ID = Department.CompanyID 
```

在这里，您指定您希望将部门-员工联接作为一个联接完成，然后将结果与公司联接。

此外，假设您只想要名称中包含字母 X 的部门。同样，如果使用旧式联接，您也可能会失去公司，如果它没有任何名称中带有 X 的部门，但使用新语法，您可以这样做：

```
SELECT *
FROM Company
     LEFT JOIN (
         Department INNER JOIN Employee ON Department.ID = Employee.DepartmentID
     ) ON Company.ID = Department.CompanyID AND Department.Name LIKE '%X%' 
```

这个额外的子句用于连接，但不是整行的过滤器。因此，该行可能会显示公司信息，但可能在该行的所有部门和员工列中都有 NULL，因为该公司的名称中没有带有 X 的部门。旧语法很难做到这一点。

这就是为什么在其他供应商中，自 SQL Server 2005 及更高版本以来，Microsoft 已弃用旧的外连接语法，而不是旧的内连接语法。使用旧式外连接语法与运行在 Microsoft SQL Server 2005 或 2008 上的数据库通信的唯一方法是将该数据库设置为 8.0 兼容模式（又名 SQL Server 2000）。

此外，通过向查询优化器扔一堆表和一堆 WHERE 子句的旧方法类似于说“你在这里，尽你所能”。使用新的语法，查询优化器只需要做更少的工作来确定哪些部分组合在一起。

所以你有它。

LEFT 和 INNER JOIN 是未来的潮流。

* * *

## 回答 #2

> 赞同：18
> 
> 时间：2009-05-21T18:56:38.270

JOIN 语法使条件靠近它们所应用的表。这在您连接大量表时特别有用。

顺便说一句，您也可以使用第一种语法进行外连接：

```
WHERE a.x = b.x(+) 
```

或者

```
WHERE a.x *= b.x 
```

或者

```
WHERE a.x = b.x or a.x not in (select x from b) 
```

* * *

## 回答 #3

> 赞同：15
> 
> 时间：2009-05-21T19:13:12.433

基本上，当您的 FROM 子句列出如下表时：

```
SELECT * FROM
  tableA, tableB, tableC 
```

结果是表 A、B、C 中所有行的叉积。然后你应用限制`WHERE tableA.id = tableB.a_id`会丢弃大量行，然后进一步......`AND tableB.id = tableC.b_id`然后你应该只得到你真正感兴趣的那些行在。

DBMS 知道如何优化此 SQL，以便使用 JOIN 编写此 SQL 的性能差异可以忽略不计（如果有的话）。使用 JOIN 表示法使 SQL 语句*更具*可读性（恕我直言，不使用连接会使语句变得一团糟）。使用叉积，您需要在 WHERE 子句中提供连接条件，这就是符号的问题。你在 WHERE 子句中塞满了类似的东西

```
 tableA.id = tableB.a_id 
AND tableB.id = tableC.b_id 
```

仅用于限制叉积。WHERE 子句应该只包含对结果集的 RESTRICTIONS。如果您将表连接条件与结果集限制混合在一起，您（和其他人）会发现您的查询更难阅读。您绝对应该使用 JOIN 并将 FROM 子句保留为 FROM 子句，将 WHERE 子句保留为 WHERE 子句。

* * *

## 回答 #4

> 赞同：14
> 
> 时间：2009-05-21T20:06:19.097

第一种方法是旧标准。第二种方法是在 SQL-92 中引入的，[http](http://en.wikipedia.org/wiki/SQL) ://en.wikipedia.org/wiki/SQL 。完整的标准可以在[http://www.contrib.andrew.cmu.edu/~shadow/sql/sql1992.txt](http://www.contrib.andrew.cmu.edu/~shadow/sql/sql1992.txt)查看。

数据库公司采用 SQL-92 标准花了很多年。

所以首选第二种方法的原因是，它是根据 ANSI 和 ISO 标准委员会的 SQL 标准。

* * *

## 回答 #5

> 赞同：11
> 
> 时间：2009-05-21T19:02:38.227

第二种是首选，因为它不太可能因忘记放入 where 子句而导致意外交叉连接。没有 on 子句的连接将无法通过语法检查，没有 where 子句的旧式连接不会失败，它将执行交叉连接。

此外，当您以后必须进行左连接时，它们都位于同一结构中有助于维护。旧的语法自 1992 年以来就已经过时了，现在应该停止使用它了。

另外，我发现许多专门使用第一种语法的人并不真正理解联接，而了解联接对于在查询时获得正确结果至关重要。

* * *

## 回答 #6

> 赞同：6
> 
> 时间：2012-06-25T10:17:55.683

我认为此页面上有一些充分的理由采用第二种方法 - 使用显式 JOIN。关键在于，当从 WHERE 子句中删除 JOIN 标准时，在 WHERE 子句中查看剩余的选择标准变得更加容易。

在非常复杂的 SELECT 语句中，读者更容易理解发生了什么。

* * *

## 回答 #7

> 赞同：5
> 
> 时间：2009-05-21T19:15:53.897

对于`SELECT * FROM table1, table2, ...`几个表来说，语法是可以的，但是随着表数量的增加，它变得越来越难以阅读（*不一定是数学上准确的语句）。*

JOIN 语法更难编写（在开始时），但它明确了哪些条件会影响哪些表。这使得犯错变得更加困难。

此外，如果所有联接都是 INNER，则两个版本是等效的。但是，当您在语句中的任何位置使用 OUTER 连接时，事情就会变得更加复杂，并且几乎可以保证您编写的内容不会查询您认为自己编写的内容。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2009-05-21T18:58:18.453

当您需要外连接时，**并不**总是需要第二种语法：

甲骨文：

```
SELECT a.foo, b.foo
  FROM a, b
 WHERE a.x = b.x(+) 
```

MSSQLServer（尽管在 2000 版本中已[弃用](http://msdn.microsoft.com/en-us/library/dd172122.aspx)）/Sybase：

```
SELECT a.foo, b.foo
  FROM a, b
 WHERE a.x *= b.x 
```

但回到你的问题。我不知道答案，但这可能与**join比在****where**子句中添加表达式更自然（至少在语法上）这样做有关： **join**。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-05-21T18:55:50.097

我听到很多人抱怨第一个太难理解而且不清楚。我看不出它有什么问题，但是在进行了讨论之后，为了清楚起见，我什至在 INNER JOINS 上使用了第二个。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-05-21T18:56:19.677

对于数据库，它们最终是相同的。但是，对您而言，在某些情况下您将不得不使用第二种语法。为了编辑最终不得不使用它的查询（发现你需要一个左连接，而你有一个直接连接），并且为了保持一致性，我只在第二种方法上进行模式化。这将使阅读查询更容易。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-05-21T18:56:50.017

那么第一个和第二个查询可能会产生不同的结果，因为 LEFT JOIN 包括第一个表中的所有记录，即使右表中没有相应的记录。

# java - 为什么以及如何在 Java Web 应用程序中使用序列化？

> ID：894491
> 
> 赞同：15
> 
> 时间：2009-05-21T18:53:57.497
> 
> 标签：java, web-applications

我一直在开发一个 Java Web 应用程序，该框架坚持认为一切都是可序列化的。我认为这不是特定于框架，而是通常针对 Java 中的 Web 应用程序，我的问题是：框架/服务器/什么是序列化的东西？它必须这样做吗？

注意：我不太了解 Web 应用程序或序列化。

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2009-05-21T18:58:04.273

典型的问题是，在复制或服务器关闭期间，内部 HTTP 会话被“序列化”到持久存储，以便可以恢复或共享它们。

序列化是保存对象的状态，并能够在以后重建该状态。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2009-05-21T19:30:47.377

对于大多数应用程序来说，这并不是绝对必要的，但可以通过两种方式提高性能：

*   用户会话可以在请求之间序列化到磁盘。当来自同一用户的请求之间的时间比处理请求所需的时间长得多时，这可以大大减少服务器的内存使用量，并使您能够为更多的用户提供服务。
*   如果您使用负载均衡将请求分散到多个服务器上，您要么需要确保同一用户的所有请求始终由同一台机器提供服务（这会降低负载均衡器的灵活性），要么您需要能够移动会话服务器之间的数据通过序列化。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-05-21T19:21:20.500

根据 Web 框架，会话中的对象可能会通过使用序列化保存到磁盘。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-05-21T19:01:12.957

序列化在任何应用程序环境中都很有用，而不仅仅是 Web 应用程序。

序列化的一个主要用途是传输。您想将对象复制或移动到远程计算机，例如 UserProfile。您可以序列化 UserProfile，发送序列化数据（通常是 XML）并将其反序列化为接收端的新对象，此时可以将其作为原始对象进行操作。

另一个用途是保存状态。您可能有一个游戏，并且想要保存游戏板的确切状态。您可以序列化 Board 对象，随后可以告诉该对象序列化其每个 Tiles。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-05-22T02:47:52.220

如果您使用的是 Enterprise Java Bean (EJB)，并且拥有无状态会话 Bean API，那么每个 SSB 实例在一个 Java 虚拟机上的一个线程中运行，其客户端在不同的线程中运行，并且通常在不同的 JVM 中运行不同的电脑。因为不能将 Java 对象的引用从一个 JVM 传递到另一个，所以需要将对象序列化为字符串，发送到另一个 JVM，然后反序列化回对象。这种序列化/反序列化发生在传入的参数和传出的返回值上。

如果您使用的是 Java 消息服务，则您在每条消息中发送的对象会被序列化为字符串，持久保存到数据库中，然后由消息接收者在其他时间和地点进行反序列化。

而且，正如 Will Hartung 所指出的，HTTP Session 对象通常在 JVM 之间共享。如果您有一个运行电子商务应用程序的 Glassfish Java EE 应用程序服务器集群，则每个客户的请求都会负载平衡到任何可用的服务器，并且该服务器必须能够查找客户的会话状态（客户姓名、购物车等）。 ）。它只能通过序列化来获得。为了安全起见，会话状态也可以写入磁盘（例如，数据库）。

# c# - 在基页类中使用用户控件

> ID：894492
> 
> 赞同：8
> 
> 时间：2009-05-21T18:54:07.840
> 
> 标签：c#, .net, asp.net, vb.net

我有一个从 Page 继承的基页面类。我们称它为 SpiffyPage。

我还有一个名为 SpiffyControl 的用户控件。

然后，我有一个继承自 SpiffyPage 的 aspx 页面 ViewSpiffyStuff.aspx。

在页面加载时，SpiffyPage 类应该将 SpiffyControl 注入到 aspx 页面中。

问题是 SpiffyControl 是一个用户控件，要在后面的代码中实例化它，必须访问 ASP 命名空间，有点像：

```
ASP.controls_spiffycontrol_aspx MyControl; 
```

但是 SpiffyPage 不是 aspx 页面，它只是一个基本页面，因此我无法访问 ASP 命名空间，因此我无法实例化 SpiffyControl 以注入它。

我怎样才能实现我的目标？

编辑：

重要的一点是我必须引用实际的控件类型，这样我才能将值分配给某些自定义属性。这就是为什么像 LoadControl 这样返回类型 Control 的函数在这种情况下不起作用的原因。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-06-05T14:03:15.040

将基类添加到您的 SpiffyControl，例如：

```
public class SpiffyBase : UserControl
{
    public void DoIt()
    {
        Response.Write("DoIt");
    }
} 
```

然后你让你的 SpiffyControl 继承那个基类，比如：

```
public partial class SpiffyControl : SpiffyBase 
```

那么您应该可以从 Basepage 类中执行此操作：

```
public class BasePage : Page
{
    protected override void OnLoad(EventArgs e)
    {
        var c = Page.LoadControl("SpiffyControl.ascx") as SpiffyBase;

        Page.Controls.Add(c);

        c.DoIt();
    }
} 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-21T18:58:33.463

我将在一个单独的 ASP.NET 服务器控制项目中实现 SpiffyControl，并从 Web 应用程序中引用该项目。这样，控件将不会驻留在 ASP 命名空间中，而是驻留在您选择的命名空间中，并且其行为与任何其他服务器控件一样。

更新：将用户控件放入单独的项目的一个很好的副作用是它们与 Web 应用程序本身更加分离，这反过来又使它们更易于重用，并且根据它们的设计，也更易于测试。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-06-08T22:36:26.903

你们在开玩笑吗，我知道 ASP.NET webforms 是一个痛苦的经历，但没有人听说过 ClassName 属性，即

```
<%@ Control ClassName="SpiffyControl" Language="C#" AutoEventWireup="true" CodeFile="SpiffyControl.ascx.cs" Inherits="Controls_SpiffyControl"  %> 
```

因此，原始示例：

```
SpiffyControl spiffy = (SpiffyControl)LoadControl("~spiffy.ascx"); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-21T19:02:53.313

我不确定这是否会对您有所帮助，但有一个名为 LoadControl 的方法可以使用用户控件文件名或用户控件的类型动态加载用户控件。该方法位于 System.Web.UI.TemplateControl 类中。

```
Control userControl= LoadControl("usercontrol.ascx");
panelControl.Controls.Add(userControl); 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-06-05T16:43:39.493

您可以将 SpiffyControl 移动到库中 - 这将为其提供更精确的命名空间，并允许您在其他项目中使用它。不过，这有点复杂——您已经制作了一个 UserControl，但它不能在库中工作。UserControls 使用代码隐藏模型——它们由两个文件组成，一个标记和一个代码。库似乎不支持代码隐藏模型，因此您不能使用 UserControl。您需要将该用户控件转换为 Web 控件。

创建一个新的类库项目。打开项目的属性并将 AssemblyName 和 Default Namespace 设置为 SpiffyLibrary。

现在我们需要转换您的 UserControl。首先，在新库中创建一个类。将其称为 SpiffyControl，就像您现有的用户控件一样，但使其继承自 System.Web.UI.WebControls.CompositeControl。

其次，打开现有用户控件的代码并复制类中的所有内容。然后回到新的类，把它全部粘贴进去。如果您使用任何标准控件事件，您可能需要重命名这些函数以覆盖相应的事件。例如，

```
protected void Page_Load(object sender, EventArgs e)
{
    ...
} 
```

……应该变成……

```
protected override void OnLoad(EventArgs e)
{
    ...

    base.OnLoad(e);
} 
```

第三（这是复杂的部分）您需要重现您在 SpiffyControl 的标记文件中拥有的所有标记。您不能只是复制它 - 相反，您需要覆盖从 CompositeControl 继承的 CreateChildControls() 函数。标记中的每个标记都需要像变量一样被实例化并添加到类的 Controls 集合中。例如，如果您现有的标记文件如下所示：

```
<%@ Control Language="C#" AutoEventWireup="true" CodeFile="SpiffyControl.ascx.cs" Inherits="Controls_SpiffyControl" %>

<div id="Div1" runat="server">
    <asp:Label ID="TextOutput" runat="server" />
</div> 
```

...那么您的新 CreateChildControls 函数应如下所示：

```
HtmlGenericControl Div1;
Label TextLabel;

protected override void CreateChildControls()
{
    Div1 = new HtmlGenericControl("div");
    this.Controls.Add(Div1);

    TextLabel = new Label();
    Div1.Controls.Add(TextLabel);

    base.CreateChildControls();
} 
```

请注意，控件被声明为类字段；这样，它们对所有类方法都是可见的。

转换标记后，编译库项目并将其添加到网站项目的引用中。然后打开您网站的 web.config 文件并找到 system.web/pages/controls 部分。这部分应该已经有这样的标签：

```
<add tagPrefix="asp" namespace="System.Web.UI" assembly="System.Web.Extensions, Version=3.5.0.0, Culture=neutral, PublicKeyToken=31BF3856AD364E35"/> 
```

该标记使您可以使用来自 ASP 核心库的控件。因此，我们将为我们的库添加一个类似的内容：

```
<add tagPrefix="spiffy" namespace="SpiffyLibrary" assembly="SpiffyLibrary" /> 
```

现在，在您网站的任何地方，您都可以像这样添加标记：

```
<spiffy:SpiffyControl ID="SpiffyInstance" runat="server" /> 
```

...这将从您的自定义库中加载您的 Web 控件。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-21T19:21:30.670

即使您的基础不是 ASPX 页面，您也可以让它从同一个框架类继承，就好像它是：

```
public abstract class MyBasePage : System.Web.UI.Page
{

} 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-06-05T15:59:12.537

假设 SpiffyControl 和 SpiffyPage 在同一个命名空间中：

```
 Control spiffyControl = LoadControl("SpiffyControl.ascx");
 (control as SpiffyControl).SpiffyControlProp1 = true;
 (control as SpiffyControl).SpiffyControlProp2 = "Hello, World!"; 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-06-05T16:56:12.537

您也可以手动定义 SpiffyControl 的命名空间。为此，您需要同时更改代码隐藏和标记。

在代码隐藏中，将您的类包装在命名空间块中。所以如果你的课是

```
public partial class Controls_SpiffyControl : System.Web.UI.UserControl
{
    ...
} 
```

...然后将其更改为...

```
namespace Spiffy
{
    public partial class Controls_SpiffyControl : System.Web.UI.UserControl
    {
        ...
    }
} 
```

然后在标记中，调整您的 @Control 标头。因此，如果您的 @Control 标头是

```
<%@ Control
    Language="C#"
    AutoEventWireup="true"
    CodeFile="SpiffyControl.ascx.cs"
    Inherits="Controls_SpiffyControl" %> 
```

...然后将其更改为...

```
<%@ Control
    Language="C#"
    AutoEventWireup="true"
    CodeFile="SpiffyControl.ascx.cs"
    Inherits="Spiffy.SpiffyControl" %> 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-06-08T20:15:03.473

假设您将在支持反射的环境中运行，您可以使用这些方法。

```
private void SetValue(Control control, string propertyName, object value)
{
    Type type = control.GetType();
    PropertyInfo property = type.GetProperty(propertyName);
    property.SetValue(control, value, null);
}
private object GetValue(Control control, string propertyName)
{
    Type type = control.GetType();
    PropertyInfo property = type.GetProperty(propertyName);
    return property.GetValue(control, null);
} 
```

并这样称呼它：

```
 Control control = this.LoadControl("~/SpiffyControl.ascx");
    string propertyName = "Custom1";
    object value = "Value";

    SetValue(control, propertyName, value); 
```

如果它被调用很多，你可能想要缓存类型信息。

您还可以考虑在 SpiffyPage 所在的程序集中创建一个 ISpiffyControl 接口，然后让您的用户控件实现它。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-06-10T22:26:43.863

它已被触及，但界面应该可以工作。使用任何成员/方法制作 ISpiffyControl，在 SpiffyControl.ascx.vb 中实现它并在 SpiffyPage 中执行此操作：

```
Protected Overrides Sub OnLoad(ByVal e As System.EventArgs)
    MyBase.OnLoad(e)
    Dim page As New Page
    Dim path As String = request.ApplicationPath
    Dim control as UI.Control = page.LoadControl(String.Format _
        ("{0}/pathToUserControl/{1}.ascx", path, controlName))
    Dim sc As ISpiffyControl = CType(control, ISpiffyControl)
    sc.DoSomethingSpecial()
    Me.Controls.Add(sc)
End Sub 
```

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-09-29T20:21:28.153

如果我没看错的话，原始发帖人的问题是他**无法访问**从其 UserControl 中派生父页面的基类的类型，而不是相反。碰巧我遇到了同样的问题。

在我的例子中，我项目中的所有页面都继承自同一个基类，所以我不担心我的用户控件知道页面的基类这一事实。向建筑师道歉。

但是，我通过以下组合解决了这个问题：1) 为我的用户控件使用基类，以及 2) 使用公共命名空间。这启用了我需要的可见性，因为由于某种原因，用户控件的基类仍然看不到页面基类的基类类型。

无论如何，我只是想我会分享我的结果，以防他们将来帮助别人。

HTH。

# iis - 使用压缩动态内容时如何禁用分块传输编码？

> ID：894499
> 
> 赞同：5
> 
> 时间：2009-05-21T18:55:35.387
> 
> 标签：iis, internet-explorer-6, gzip, scriptmanager, transfer-encoding

我想在我的网络服务器上禁用分块传输编码，以避免这个错误： http: [//support.microsoft.com/kb/871205](http://support.microsoft.com/kb/871205)。不幸的是，我需要在 Win2k 上支持 IE6，所以他们无法安装补丁。

我找到了将 AspEnableChunkedEncoding 设置为 FALSE 的说明，但这似乎不能解决我的问题。我相信这是因为我们还使用 gzip 压缩，根据这篇文章 ( [http://www.eggheadcafe.com/conversation.aspx?messageid=31045986&threadid=31045970](http://www.eggheadcafe.com/conversation.aspx?messageid=31045986&threadid=31045970) ) 需要分块编码才能压缩动态内容。因此，所有动态压缩的内容都被“分块”传输，因为它是由 gzip 过滤器压缩的，而不是 ASP.NET。

我知道 IIS 可以不分块地提供此内容，因为我尝试在请求中使用 http 1.0（不支持传输编码：分块），并且响应正确到达并被压缩。

如何在使用 ScriptManager 时禁用分块编码，这需要动态压缩生成的“.axd”文件？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2010-12-03T19:09:44.200

由于您无法更改 IIS 中 GZip 压缩的行为或让您的客户端升级到新操作系统，为什么不针对特定用户代理字符串有条件地关闭 GZip 压缩。

在 Apache 上，您可以使用 mod rewrite 来执行此操作（[请参阅此处](http://sebduggan.com/posts/ie6-gzip-bug-solved-using-isapi-rewrite)），其中包含以下几行：

```
RewriteEngine on

RewriteCond %{HTTP:User-Agent} MSIE\ [56]
RewriteCond %{HTTP:User-Agent} !SV1
RewriteCond %{REQUEST_URI} \.(css|js)$
RewriteHeader Accept-Encoding: .* $1 
```

此[服务器故障线程](https://serverfault.com/questions/31664/how-can-i-disable-compression-for-specific-user-agents-in-iis6)表明您可以使用[ISAPI Rewrite](http://www.isapirewrite.com/)来使用相同的指令并获得相同的结果。看起来免费的“Lite”版本也支持这些指令，因此您不必购买任何许可证。

# python - Python 是否变得更加面向对象？

> ID：894502
> 
> 赞同：9
> 
> 时间：2009-05-21T18:56:03.810
> 
> 标签：python, ruby, oop

我记得有一次，[有人说 Python 不像 Ruby 那样面向对象](http://www.linuxdevcenter.com/pub/a/linux/2001/11/29/ruby.html)，因为在 Ruby 中，一切都是对象。这对于 Python 也有变化吗？最新的 Python 是否比以前的版本更面向对象？

* * *

## 回答 #1

> 赞同：40
> 
> 时间：2009-05-21T19:32:01.150

林健——答案是“是的”，与 Matz 决定创建 Ruby 时相比，Python 更加面向对象，而且这两种语言现在都具有“一切都是对象”的特点。在 Python 还年轻的时候，像字符串和数字这样的“类型”缺乏方法，而“对象”是使用“类”语句构建的（或者通过故意在 C 扩展模块中构建一个类）并且效率稍低但确实支持方法和继承。在 1990 年代初期，当一台快速的 386 是一台相当不错的机器时，这种妥协是有道理的。但是类型和类在 Python 2.2（2001 年发布）中是统一的，字符串有方法，在最近的 Python 版本中，用户甚至可以继承它们。

所以：Python 在某个时候肯定是不那么面向对象的。但是，据我所知，所有这些旧障碍现在都消失了。

这是发生的统一的指南：

[http://www.python.org/download/releases/2.2/descrintro/](http://www.python.org/download/releases/2.2/descrintro/)

**澄清：**也许我可以更简单地说：在 Python 中，一切*都是*对象；但是一些基本类型的对象（整数、字符串）曾经由“不同的规则”播放，这些规则阻止了 OO 编程方法（如继承）与它们一起使用。现在已经解决了。len() 方法，在此处的另一个响应中描述，可能是我希望 Guido 在升级到 Python 3.0 时唯一剩下的东西。但至少他给了我字典理解，所以我不会大声抱怨。:-)

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2009-05-21T19:03:43.843

我不确定我是否认同 Ruby 比 Python 更面向对象的论点。面向对象不仅仅是使用对象和点语法。我看到的一个常见论点是，在 Python 中要获取列表的长度，您可以执行以下操作：

```
len(some_list) 
```

我认为这是一个[自行车棚的论点](http://en.wikipedia.org/wiki/Color_of_the_bikeshed)。这真正转化为（几乎直接）是这样的：

```
some_list.__len__() 
```

这是完全面向对象的。我认为 Rubyists 可能会有些困惑，因为通常面向对象涉及使用点语法（例如`object.method()`）。但是，如果我误解了 Rubyists 的论点，请随时告诉我。

不管它的面向对象如何，以这种方式使用 len 有一个优点。一些语言总是让我烦恼的一件事是必须记住是否使用`some_list.size()`或`some_list.length()`或`some_list.len`用于特定对象。Python 的方式意味着只需要记住一个函数

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2009-05-21T19:36:28.237

虽然这不是一个正确的答案……你为什么关心 Python 或多或少是面向对象的？Python 最酷的地方在于它是*Pythonic*的，而不是面向对象的、函数式的或任何当下流行的范式！:-)

我学会了使用 Java 和面向对象进行编程，但现在我不关心它，因为我知道 OOP 并不是所有问题的解决方案（事实上，没有单一的范式是）。

看：

*   [Python之禅](http://www.python.org/dev/peps/pep-0020/)
*   [什么是 Pythonic](http://faassen.n--tree.net/blog/view/weblog/2005/08/06/0)
*   [像 Pythonic](http://cafepy.com/article/59/)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-05-21T19:18:40.957

等等，Ruby 和 Python 都是面向对象的。对象就是对象。没有更多的面向对象的“比较功能”可以引导您获得更好的功能。*语法*不仅是使某些语言看起来像面向对象的语言，而且还是*数据模型*。

> 对象是 Python 对数据的抽象。Python 程序中的所有数据都由对象或对象之间的关系表示。（在某种意义上，按照冯诺依曼的“存储程序计算机”模型，代码也由对象表示。）[http://docs.python.org/reference/datamodel.html](http://docs.python.org/reference/datamodel.html)

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-05-21T19:35:39.377

这是一个不正确的信念。

请参阅我之前的答案以获得更深入的解释：

[python中的一切都是像ruby一样的对象吗？](https://stackoverflow.com/questions/865911/is-everything-an-object-in-python-like-ruby/865963#865963)

> 那么为什么不直接将 .len() 暴露在列表之外呢？我认为您不能将 OO 设计与语法完全分开，因为语法在很大程度上定义了您的代码范例。some_list.len() 是面向对象的，因为您将列表视为一个能够告诉您其长度是多少的对象。len(some_list)

.len() 可直接从列表中删除。它以 __len__() 的形式提供。len() 是一个函数对象。您可以使用 dir(len) 查看它的所有方法。虽然我不知道 Guido 为何决定延长 __len__() 方法，但这并没有改变所有这些仍然是对象的事实。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-05-21T19:51:10.300

我也有同样的**“认知”**，或许源于此：

[为什么首先创建python：](http://www.python.org/doc/faq/general/#why-was-python-created-in-the-first-place)

> *我突然想到，具有像 ABC [...] 这样的语法的脚本语言可以满足需求*

[采访 Ruby 的创造者：](http://www.linuxdevcenter.com/pub/a/linux/2001/11/29/ruby.html)

> *“我想要一种比 Perl 更强大、比 Python 更面向对象的脚本语言*

我知道感知与现实不同。Python 和 Ruby 都是很棒的编程语言，而且都非常面向对象。

# c++ - 小型便携式网络浏览器库？

> ID：894510
> 
> 赞同：7
> 
> 时间：2009-05-21T18:57:27.880
> 
> 标签：c++, html, browser

我正在寻找一个小型便携式网络浏览器来嵌入到我的 3D 引擎中。基本上，我需要一些小而快的东西，它可以呈现到图形缓冲区中，并将我的输入用于链接和东西。如果它也能做JS就好了。

到目前为止，我已经研究了 Gecko 和 Webkit，而 Webkit 是迄今为止的赢家（Gecko 太大太乱，甚至无法考虑）。

我还缺少其他更晦涩的引擎吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-10-07T19:06:38.247

也许这是一个选择： http: [//princeofcode.com/awesomium.php](http://princeofcode.com/awesomium.php)

从网站：

Awesomium 是一个库，它使开发人员可以轻松地将 Web 嵌入到他们的应用程序中。例如，它可以用于：

*   使用游戏中的 GUI 供电
*   HTML/JS/CSS 将实时网页渲染为 3D 对象并与之交互
*   用于高级 3D 网络浏览器的框架
*   用于网页快照或记录的屏幕外渲染器
*   游戏内广告的实施。和更多！

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-21T19:05:14.790

是的，[HTML布局](http://www.terrainformatica.com/htmlayout/)。

# c++ - 确定类成员变量的访问类型

> ID：894521
> 
> 赞同：0
> 
> 时间：2009-05-21T18:59:27.640
> 
> 标签：c++

遵循下表是确定我正在创建的类的成员变量的访问类型的最佳方法（对不起，如果这个表很难看到；它与[http://www.cplusplus.com/显示的表相同文档/教程/继承/](http://www.cplusplus.com/doc/tutorial/inheritance/)）？

```
Access                        public    protected    private
members of the same class     yes       yes          yes
members of derived classes    yes       yes          no
not members                   yes       no           no 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-21T19:14:34.740

您应该在那里添加朋友类/方法，但友谊是明确的：在 C++ 中，*朋友可以触摸您的私人部分*。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-21T19:15:42.617

该表是正确的，如果这就是你要问的。

它的意思是您始终可以访问您的方法所在的类的成员变量。如果成员变量是在父类中定义的，那么您只能在成员变量受保护或公开的情况下访问它。如果您不在课堂上，那么您只能访问公共成员变量。

没有“最佳方式”——这些是以合理的方式呈现的规则。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-21T19:15:13.537

最好的办法是了解公共、受保护和私有关键字的含义。如果表格可以帮助您了解这一点，那么请务必使用它；它是正确的。如果你想成为一名高效的 C++ 程序员，这应该像呼吸一样容易。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-21T19:18:30.927

没错，除了朋友。

话虽如此，对于任何不只是或多或少相关数据的类 C 结构的类，所有成员变量都应该是私有的。几乎没有充分的理由使用受保护的变量。

# mysql - 有什么理由担心表格中的列顺序吗？

> ID：894522
> 
> 赞同：91
> 
> 时间：2009-05-21T18:59:36.067
> 
> 标签：mysql, sql, database-table

我知道您可以使用 FIRST 和 AFTER 更改 MySQL 中的列顺序，但是您为什么要打扰呢？既然好的查询在插入数据时会显式命名列，那么真的有任何理由关心您的列在表中的顺序吗？

* * *

## 回答 #1

> 赞同：105
> 
> 时间：2009-05-21T19:04:34.793

列顺序对我调整过的一些数据库有很大的性能影响，包括 Sql Server、Oracle 和 MySQL。这篇文章有[很好的经验法则](http://forums11.itrc.hp.com/service/forums/questionanswer.do?threadId=143188)：

*   主键列优先
*   接下来是外键列。
*   下一个经常搜索的列
*   以后经常更新的列
*   可空列最后。
*   在更频繁使用的可空列之后使用最少的可空列

性能差异的一个示例是索引查找。数据库引擎根据索引中的某些条件找到一行，并取回一个行地址。现在假设您正在寻找 SomeValue，它在此表中：

```
 SomeId int,
 SomeString varchar(100),
 SomeValue int 
```

引擎必须猜测 SomeValue 从哪里开始，因为 SomeString 的长度未知。但是，如果您将顺序更改为：

```
 SomeId int,
 SomeValue int,
 SomeString varchar(100) 
```

现在引擎知道可以在行开始后 4 个字节找到 SomeValue。所以列顺序会对性能产生相当大的影响。

编辑：Sql Server 2005 在行首存储固定长度字段。并且每一行都有一个对 varchar 开头的引用。这完全否定了我上面列出的效果。所以对于最近的数据库，列顺序不再有任何影响。

* * *

## 回答 #2

> 赞同：44
> 
> 时间：2009-05-21T19:05:06.163

**更新：**

在`MySQL`中，这样做可能是有原因的。

由于可变数据类型（如`VARCHAR`）以可变长度存储在 中`InnoDB`，因此数据库引擎应遍历每行中的所有先前列以找出给定列的偏移量。

对列的影响可能高达**17%**`20`。

有关更多详细信息，请参阅我的博客中的此条目：

*   [**选择列顺序**](http://explainextended.com/2009/05/21/choosing-column-order/)

在`Oracle`中，尾随`NULL`列不占用空间，这就是为什么您应该始终将它们放在表的末尾。

同样 in`Oracle`和 in `SQL Server`，在大行的情况下，`ROW CHAINING`可能会出现 a。

`ROW CHANING`正在拆分不适合一个块的行并将其跨越多个块，并通过链表连接。

读取不适合第一个块的尾随列将需要遍历链表，这将导致额外的`I/O`操作。

有关in的说明，请参阅[**此页面**](http://www.akadia.com/services/ora_chained_rows.html)：`ROW CHAINING``Oracle`

这就是为什么你应该把你经常使用的列放在表的开头，把你不经常使用的列或者往往是的列`NULL`放在表的末尾。

**重要的提示：**

如果您喜欢这个答案并想为它投票，也请为[`@Andomar`'s answer](https://stackoverflow.com/questions/894522/is-there-any-reason-to-worry-about-the-column-order-in-a-table/894545#894545)投票。

他回答了同样的事情，但似乎无缘无故地被否决了。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2009-05-21T19:04:36.383

在上一份工作的 Oracle 培训期间，我们的 DBA 建议将所有不可为空的列放在可空的列之前是有利的……虽然 TBH 我不记得为什么的细节。或者也许只是那些可能会更新的应该在最后？（如果行扩展，可能会推迟移动行）

一般来说，它不应该有任何区别。正如您所说，查询应始终指定列本身，而不是依赖于“select *”的排序。我不知道任何允许更改它们的数据库......好吧，直到你提到它，我才知道 MySQL 允许它。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2009-05-21T19:02:39.833

必须键入时输出的可读性：

```
select * from <table> 
```

在您的数据库管理软件中？

这是一个非常虚假的原因，但目前我想不出别的。

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2009-05-21T19:03:29.053

一些写得不好的应用程序可能依赖于列顺序/索引而不是列名。他们不应该，但它确实发生了。更改列的顺序会破坏此类应用程序。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2009-05-21T19:01:42.817

不，SQL 数据库表中列的顺序是完全不相关的——除了显示/打印目的。重新排序列没有意义——大多数系统甚至没有提供这样做的方法（除了删除旧表并使用新的列顺序重新创建它）。

马克

编辑：从关系数据库的维基百科条目中，这是相关部分，我清楚地表明，列顺序*永远不*应该受到关注：

*关系被定义为一组 n 元组。在数学和关系数据库模型中，集合是项目的**无序**集合，尽管一些 DBMS 对其数据施加了顺序。在数学中，元组具有顺序，并且允许重复。EF Codd 最初使用这个数学定义来定义元组。后来，EF Codd 的一大见解是，在基于关系的计算机语言中，使用属性名称而不是排序会更方便（通常）。这种见解今天仍在使用。*

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2016-12-08T17:56:29.227

除了明显的性能调整之外，我还遇到了一个极端情况，即重新排序列导致（以前的功能）sql 脚本失败。

从文档“TIMESTAMP 和 DATETIME 列没有自动属性，除非它们被明确指定，但有这个例外：默认情况下，第一个 TIMESTAMP 列同时具有 DEFAULT CURRENT_TIMESTAMP 和 ON UPDATE CURRENT_TIMESTAMP 如果两者都没有明确指定” [https://dev.mysql .com/doc/refman/5.6/en/timestamp-initialization.html](https://dev.mysql.com/doc/refman/5.6/en/timestamp-initialization.html)

因此，如果该字段是表中的第一个时间戳（或日期时间），则命令`ALTER TABLE table_name MODIFY field_name timestamp(6) NOT NULL;`将起作用，否则不会。

显然，您可以更正该 alter 命令以包含默认值，但是由于列重新排序而导致有效的查询停止工作的事实让我很头疼。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2009-05-21T19:05:00.517

通常情况下，最大的因素是下一个必须在系统上工作的人。我尝试首先拥有主键列，其次是外键列，然后按照对系统的重要性/重要性的降序排列其余列。

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2009-05-21T19:05:06.787

我能想到的唯一原因是调试和灭火。我们有一个表，其“名称”列在列表中的第 10 位左右出现。当您从表中的 id in (1,2,3) 中快速选择 * 然后您必须滚动查看名称时，这很痛苦。

但仅此而已。

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2020-10-16T13:35:17.433

2002 年，Bill Thorsteinson 在 Hewlett Packard 论坛上发布了他通过重新排序列来优化 MySQL 查询的建议。此后，他的帖子在互联网上至少被复制和粘贴了一百次，而且通常没有引用。准确地引用他的话...

> 一般经验法则：
> 
> *   首先是主键列。
> *   接下来是外键列。
> *   接下来是经常搜索的列。
> *   以后经常更新的专栏。
> *   可空列最后。
> *   在更频繁使用的可空列之后使用最少的可空列。
> *   自己的表中的 Blob，其他列很少。

资料来源：[惠普论坛。](https://community.hpe.com/t5/general/oracle-columns/td-p/2840825#)

但那篇文章是在 2002 年发表的！ *这个建议是针对 MySQL 3.23 版本的，比 MySQL 5.1 发布早了六年多。* 并且没有参考文献或引文。那么，比尔是对的吗？存储引擎在这个级别上究竟是如何工作的？

1.  是的，比尔是对的。
2.  这一切都归结为链式行和内存块的问题。

[引用Oracle 认证专家](https://www.akadia.com/html/contact.html)Martin Zahn在一篇关于[Oracle 行链接和迁移的秘密的](https://www.akadia.com/services/ora_chained_rows.html)文章...

> 链式行对我们的影响不同。在这里，这取决于我们需要的数据。如果我们有一行有两列，分布在两个块上，查询：
> 
> `SELECT column1 FROM table`
> 
> 其中 column1 在块 1 中，不会导致任何«table fetch continue row»。它实际上不必获取 column2，它不会一直跟随链接的行。另一方面，如果我们要求：
> 
> `SELECT column2 FROM table`
> 
> 由于行链接，column2 在第 2 块中，那么您实际上会看到一个«table fetch continue row»

这篇文章的其余部分是一个相当不错的阅读！但我在这里只引用与我们手头的问题直接相关的部分。

18 年后，我必须说：谢谢，比尔！

[![将 MySQL 行映射到数据块](https://i.stack.imgur.com/APatP.gif)](https://i.stack.imgur.com/APatP.gif)

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2009-05-21T19:05:03.560

如果您要经常使用 UNION，如果您对它们的排序有一个约定，它会使匹配列更容易。

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2009-05-21T22:37:32.663

如前所述，存在许多潜在的性能问题。我曾经在一个数据库上工作过，如果您没有在查询中引用这些列，那么将非常大的列放在最后会提高性能。显然，如果一条记录跨越多个磁盘块，数据库引擎在获得所需的所有列后可能会停止读取块。

当然，任何性能影响不仅高度依赖于您使用的制造商，还可能依赖于版本。几个月前，我注意到我们的 Postgres 无法使用索引进行“点赞”比较。也就是说，如果你写了“somecolumn like 'M%'”，那么在找到第一个 N 时跳到 M 并退出是不够聪明的。我打算将一堆查询更改为使用“between”。然后我们得到了一个新版本的 Postgres，它智能地处理了类似的事情。很高兴我从来没有改变查询。显然在这里没有直接关系，但我的观点是，你为效率考虑所做的任何事情都可能在下一个版本中过时。

列顺序几乎总是与我非常相关，因为我经常编写通用代码来读取数据库模式以创建屏幕。就像，我的“编辑记录”屏幕几乎总是通过读取架构以获取字段列表，然后按顺序显示它们来构建。如果我改变了列的顺序，我的程序仍然可以工作，但显示对用户来说可能很奇怪。就像，您希望看到姓名/地址/城市/州/邮编，而不是城市/地址/邮编/姓名/州。当然，我可以将列的显示顺序放在代码或控制文件或其他东西中，但是每次添加或删除列时，我们都必须记住去更新控制文件。我喜欢说一次。此外，当编辑屏幕完全由模式构建时，添加一个新表可能意味着编写零行代码来为其创建一个编辑屏幕，这非常酷。（好吧，好吧，实际上通常我必须在菜单中添加一个条目来调用通用编辑程序，而我通常已经放弃了通用的“选择要更新的记录”，因为有太多的例外使其实用.)

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2009-05-21T19:04:10.987

您唯一需要担心列顺序的情况是您的软件是否特别依赖该顺序。通常这是由于开发人员变得懒惰并做了 a`select *`然后在结果中通过索引而不是名称来引用列。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2009-05-21T19:08:35.063

一般来说，当您通过 Management Studio 更改列顺序时，SQL Server 中会发生什么，它会创建一个具有新结构的临时表，将数据从旧表移动到该结构，删除旧表并重命名新表。正如您可能想象的那样，如果您有一张大桌子，这对于性能来说是一个非常糟糕的选择。我不知道 My SQL 是否也这样做，但这是我们许多人避免重新排序列的原因之一。因为 select * 不应该在生产系统中使用，所以在最后添加列对于设计良好的系统来说不是问题。表中的列顺序一般不应该被弄乱。

# asp.net-mvc - 使用比较语句 (MVC) 设置选中的属性

> ID：894526
> 
> 赞同：0
> 
> 时间：2009-05-21T19:00:40.977
> 
> 标签：asp.net-mvc, checkbox

我正在寻找一种方法来基于 MVC 视图中的整数（在这种情况下不是布尔值）设置选中的属性。

是否可以仅在视图中表达这一点？（我们没有 html 助手就可以了）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-21T19:07:53.007

您可以直接在视图中使用标准`if`子句等：

```
<% if (myInt > 3) { %>
    <input name="checkbox1" type="checkbox" checked="checked">a checked box</input>
<% } else { %>
    <input name="checkbox1" type="checkbox">a non-checked box</input>
<% } %> 
```

当然，Craig 的版本在您的代码中看起来会更好...... ;)

```
<%= Html.CheckBox("checkbox1", myInt > 3) %>
<label for="checkbox1">a box that might be checked...</label> 
```

请注意，您需要 label 标签来为您的复选框获取标题 - html 帮助程序不会免费为您提供。当然，除非您使用其中一个采用 html 属性作为参数的[重载...](http://msdn.microsoft.com/en-us/library/system.web.mvc.html.inputextensions.checkbox.aspx)`IDictionary`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-21T20:07:43.963

```
<%= Html.Checkbox("CheckboxName", someInt != 0) %> 
```

# javascript - 如果我在代码中犯了一个错误并在 javascript 中导致了一个无限循环并且它一直在调用 alert()，有没有办法停止循环？

> ID：894530
> 
> 赞同：9
> 
> 时间：2009-05-21T19:01:58.370
> 
> 标签：javascript, firefox, alert

有时我使用调试代码来警告 javascript 中的某些内容（例如，匹配正则表达式中的某些内容），但忘记了修饰符并且警报处于无限循环中（或者如果循环匹配模式 300 次）。如果使用 Firefox，警报会不断出现，甚至无法关闭选项卡、窗口或应用程序。

如果我强制退出，它将关闭所有选项卡甚至 Firefox 的其他窗口......实际上有没有办法更优雅地停止循环？

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2009-05-21T19:03:16.480

最简洁的答案是不。

这是使用 Firebug 和 console.log 函数的一个很好的理由。具有讽刺意味的是，这会导致“停止脚本，因为它正在逃跑”对话框在某些情况下不显示，这意味着您就回到了现在的位置。

Chrome 和 Opera 都有这个功能。IE 没有，Apple Safari 也没有。

不是本机解决方案，但您可以尝试这个油脂猴脚本：[http ://www.tumuski.com/2008/05/javascript-alert-cancel-button/](http://www.tumuski.com/2008/05/javascript-alert-cancel-button/)

此外，您*可以*简单地覆盖警报功能以使用确认对话框，并在取消确认时停止显示警报：

```
var displayAlerts = true; 
```

进而：

```
function alert(msg) {
  if (displayAlerts) {
     if (!confirm(msg)) {
       displayAlerts = false;           
     }
  }
} 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2010-08-17T11:27:07.417

看起来你可以在 Firefox 中：

1.  按住 Ctrl
2.  按住回车
3.  按 F4 一次

根据博客文章，它并非在所有情况下都有效，更多信息在这里：[puremango.co.uk](http://www.puremango.co.uk/2010/02/break-out-of-infinite-alert-popups/)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-21T19:05:05.617

Google Chrome 允许您阻止显示其他警报。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-09-24T21:33:41.967

我编写了一个 Firefox 扩展来解决这个问题。

[https://addons.mozilla.org/en-US/firefox/addon/13176](https://addons.mozilla.org/en-US/firefox/addon/13176)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-21T19:12:56.960

没门。好消息是虽然大多数浏览器都有无限递归保护，但这是题外话。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-10-01T08:24:22.293

安装 Greasemonkey 并转到此页面： [http ://www.tumuski.com/2008/05/javascript-alert-cancel-button/](http://www.tumuski.com/2008/05/javascript-alert-cancel-button/)

为greasemonkey 安装此脚本后，任何警报对话框窗口都会有一个取消按钮，它将停止javascript。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2015-07-31T00:19:56.657

[在 IE 11 上测试] 如果您需要关闭 Web 浏览器并且出于任何原因不想使用 ctrl-alt-del（在我的情况下，我的错误 javascript 无限警报循环正在 citrix 上运行，它会自动重新加载我的最后一个会话我无法清除的缓存中的 ctrl-alt-del）

您可以通过**按住 alt-F4 并发送垃圾邮件 X**（关闭浏览器窗口）来解决问题。

这工作得非常快... alt-F4 非常快地关闭警报框，您会注意到浏览器顶部的 X 按钮闪烁。这为您提供了非常小的时间窗口，您可以在警报之间关闭它。

注意：如果您打开了多个选项卡，您需要先从屏幕底部控制栏上的图标关闭它们，因为“关闭所有选项卡消息”会干扰。

# javascript - JavaScript - 如何对 div 进行排序

> ID：894538
> 
> 赞同：2
> 
> 时间：2009-05-21T19:02:54.310
> 
> 标签：javascript, sorting, dhtml

我有以下格式的家庭信息列表。

```
<div id="content">
    <div class="listing">
        <div class="photo"><a href="#"><img src="img.jpg" width="200"></a></div>
        <div class="info">
            <p class="address"><a href="#">321 Main St<br>Beverly Hills, CA 90210</a></p>
            <div class="attr">Price</div>
            <div class="val price">$325,000</div>
            <div class="attr">Sq. Ft.</div>
            <div class="val">2,600</div>
            <div class="attr">Built</div>
            <div class="val">1988</div>
            <div class="attr">Bedrooms</div>
            <div class="val">3</div>
            <div class="attr">Bathrooms</div>
            <div class="val">2.5</div>
        </div>
    </div>
    <div class="listing">{ANOTHER HOME LISTING...}</div>
    <div class="listing">{ANOTHER HOME LISTING...}</div>
    <div class="listing">{ANOTHER HOME LISTING...}</div>
</div> 
```

使用 JavaScript，我如何（按价格）对上面的房屋列表进行排序。

举个例子，我基本上想做下面的演示（但不使用表）。

[http://sam-i-am.com/work/sandbox/dojo0.9/samiam/sortableList.html](http://sam-i-am.com/work/sandbox/dojo0.9/samiam/sortableList.html)

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-21T19:10:19.383

我假设您想在最初呈现数据后根据用户的请求对数据进行处理。我通常通过 AJAX 在服务器端执行此操作，即对具有不同排序的同一数据集执行 GET 请求。这在分页数据时是必要的，因为在排序后显示的记录可能与以前显示的记录完全不同。

如果您有一个未分页的小数据集并且您想在客户端进行排序，我会将数据呈现为 javascript 数组并通过 javascript 填充您的 DIV。然后，当用户想要排序时，您可以使用该数组并再次调用您的 javascript 渲染函数以按照新排序的顺序获取您的数据。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-21T19:13:59.827

我同意 OrbMan。将列表存储在数组中。然后，您可以简单地对数组进行排序，而不是使用花哨的 Javascript 在 DOM 中完成所有操作。

在不相关的说明中，您必须对所有内容都使用 div 吗？如果您使用（无）有序列表，它在语义上会更好，并且可能使您编写的任何 Javascript 更易于阅读和维护。您可以在（分类的）ul/ol 中引用 li，而不是引用一堆专门分类的 div。

# asp.net - ASP.Net 4.0 中将提供哪些新功能？

> ID：894543
> 
> 赞同：6
> 
> 时间：2009-05-21T19:04:12.657
> 
> 标签：asp.net, .net-4.0

ASP.Net 4.0 中将提供哪些新功能？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2009-05-21T19:07:19.717

Mircosoft Channel 9 上有几个视频：

*   [ASP.NET 4.0 路线图](http://channel9.msdn.com/pdc2008/PC20/)，[作者](http://geekswithblogs.net/evjen/archive/2008/10/27/126250.aspx)Scott
    Hunter
*   Steven Walther[的 ASP.NET 4.0 的新特性](http://channel9.msdn.com/shows/The+Knowledge+Chamber/Stephen-Walther-New-Features-of-ASPNET-40/)

* * *

从链接的博客文章中的这些会话笔记中引用（部分）：

**网络表格**

*   开发人员可以管理影响呈现客户端 ID 的控件 ID
*   消除 ID 膨胀和“混乱”
*   CSS：

*   理想情况下无需使用 CSS 适配器
*   遵循 CSS 样式并绕过现有的样式属性

*   非内联样式属性

*   支持非基于表格的 HTML 渲染

*   Web 表单的 URL 路由

*   Web 表单的友好 url 处理
*   url路由的配置模型

*   查看状态

*   在页面上禁用，在特定控件上启用——它们将提供对视图状态的精细控制——今天它是倒退的
*   禁用控件，启用子控件
*   GridView/ListView 在没有视图状态的情况下工作得更好

*   ASP.NET 动态数据

**阿贾克斯**

*   继续 ASP.NET Ajax 创新：RIA
*   吸引 JavaScript 开发人员
*   为页面开发者提供支持
*   jQuery 包括智能感知
*   模板和数据绑定

*   客户端处理、REST 或 Web 服务
*   涵盖页面开发者和组件开发者场景

*   DOM 操作，选择器...
*   Ajax 高级组件

*   Ajax Control Toolkit 是该策略的一部分——他们将使该工具包成为整个 ASP.NET 包的一部分
*   新控件

*   集中式脚本库和性能分解

**ASP.NET MVC**

*   吸引那些想要关注点分离、TDD、完全控制的人
*   Ruby on Rails、Django、PHP
*   基于 ASP.NET MVC 1.0 构建
*   ASP.NET MVC（模型视图控制器）
*   异步控制器
*   子控制器和视图
*   声明式控制

**ASP.NET 核心**

*   解决客户痛点
*   提高规模和性能
*   缓存可扩展性和性能：

*   启用像 Velocity 这样的缓存

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-05-21T19:07:39.043

有不少：

*   静态客户端 ID
*   更好的动态数据支持
*   更好地支持网络表单应用程序的路由功能（由 ASP.NET MVC 流行）
*   许多 Ajax 增强功能

[在此处](http://www.hanselman.com/blog/ASP4WhirlwindTourAroundNET4AndVisualStudio2010Beta1.aspx)阅读 Scott Hanselman 关于 .NET 4 的优秀博文（系列）。

[并在此处查看](http://www.asp.net/learn/whitepapers/aspnet40/)有关 ASP.NET 4.0 的精彩白皮书。

马克

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-05-21T19:08:06.453

[Microsoft ASP.NET 4.0 白皮书](http://www.asp.net/learn/whitepapers/aspnet40/)

这对期待的内容进行了非常彻底的细分和解释。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-08-23T22:26:49.557

此博客上有几篇 ASP.NET 4.0 文章 - [.NET 4.0](http://www.dotnetcube.com/?tag=/.net+4.0)

# c# - 需要检索包含与另一个列表匹配的子项的项目列表

> ID：894568
> 
> 赞同：3
> 
> 时间：2009-05-21T19:08:09.293
> 
> 标签：c#, linq-to-sql, collections, linq

情况：

我有一些具有某些技能的人，他们可以/可能属于多个领域。技能链接在单独的表格中，区域也是如此。

我通过选择每个技能匹配的所有人来获取人员列表，并将他们添加到我可以使用 Distinct() 的列表中以确保他们不会出现两次。

**结果人员名单：**

```
List<Person> peopleWithRightSkills 
```

在每个 [Person] 对象上，我至少链接了 1 个地址，但与 [Person] 相关的地址可以更多

**我还有另一个清单：**

```
List<PostalCode> acceptedPostalcodes 
```

现在我需要比较和过滤那些地址的邮政编码在接受的邮政编码范围内的**peopleWithRightSkills**

我一直在研究 Lambda 表达式、SelectMany 以及其他解决方案，但现在，我只有一个选择，我认为这是做事的“旧风格”，即遍历每个人，并为每个人匹配她/他的地址列表对照邮政编码列表。并且对于每场比赛，然后将其添加到：

```
List<Person> matchedPeople 
```

**表格概述（缩短所需的详细信息）**

```
[Table:Person]
int:ID (primary)
string:FirstName
string:LastName

[Table:Address]
int:Person_ID (foreign key to Person)
int:PostalCode_ID (foreing key to PostalCode)
string:StreetName

[Table:PostalCode]
int:ID
string:CityName 
```

正如我看到的问题，它只是一个“短名单公关人员”（最少 1 个，可能最多 10 个地址），我需要将此地址列表与每个人的“有效邮政编码列表”进行比较。

希望有一个很好的答案，因为我现在已经被困了几个小时，试图找出使用什么语法来解决这个更漂亮和更少性能的问题。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-21T19:23:01.527

```
List<int> peopleIDs = peopleWithRightSkills.Select(p => p.ID).ToList();
List<int> postalIDs = acceptedPostalCodes.Select(c => c.ID).ToList();

var query = db.Persons
  .Where(p => peopleIDs.Contains(p.ID)
  .Where(p => p.Addresses.Any(a => postalIDs.Contains(a.PostalCode_ID))
  ); 
```

LinqToSql 会将 中的每个元素转换`List<int>`为参数。然后它将`Contains`方法调用转换为 TSql`IN`子句。

请注意，LinqToSql 很乐意将任意数量的元素转换为参数（我自己见过 50k），**但是**SqlServer 只接受 ~2000 个参数。如果您的列表包含的元素多于您需要分解这些列表的元素。如果您有 1500 名具有正确技能的人员和 1000 个接受的邮政编码，则需要将 2500 个参数发送到 SQL Server，这 400 个太多了，它会给您一个 SqlException。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-21T19:14:27.987

假设有很多人，`acceptedPostalCodes`不应该是一个列表；它应该是排序列表/二叉树或哈希表，具体取决于有多少代码。这本身就足以让您获得数量级的性能提升。然后，是的，只要检查每个人，如果他们的地址在`acceptedPostalCodes`.

没有更好的方法可以做到这一点，除非您有奇怪的数据（即，如果相同的地址一遍又一遍地出现，您可以将这些地址的结果缓存在某种辅助结构中。）

恐怕我通过展示表格结构并不能真正理解您在问题的其余部分中的意思，所以我希望我不会错过您正在做的事情的一些微妙之处。

编辑：由于您似乎对使用 LINQ 做事感兴趣，因此您将如何从接受 PostalCodes 的 peopleWithRightSkills 中挑选出元素：

```
var matchedPeople =
peopleWithRightSkills.Where(p => acceptablePostalCodes.Contains(p.Address)); 
```

# visual-studio - TF10216: Team Foundation 服务当前不可用。（用户问题？）

> ID：894570
> 
> 赞同：2
> 
> 时间：2009-05-21T19:08:42.567
> 
> 标签：visual-studio, tfs

我在让我的团队基础服务器工作时遇到了一些麻烦。

如果我尝试使用“管理员”帐户访问 http://:8080/services/v1.0/serverstatus.asmx 一切似乎都很好。

但是，如果我尝试以其他用户的身份访问它，我会得到：

TF10216: Team Foundation 服务当前不可用。稍后再试。如果问题仍然存在，请联系您的 Team Foundation Server 管理员。

我在事件日志中找不到任何错误。有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-11-29T06:10:47.617

默认情况下，只有“Team Foundation Administrators”组有权访问 Web 服务，并且它只包含本地管理员组和 TFS 服务帐户（除非您已对其进行修改）。您可以在此处阅读有关该组的信息：

[http://msdn.microsoft.com/en-us/library/ms253077(VS.80).aspx](http://msdn.microsoft.com/en-us/library/ms253077(VS.80).aspx)

您可能需要将其他用户添加到此组，或填充 TFS 中的一些其他权限组（各种项目的项目管理员等）。

此外，您问题中的 URL 看起来很奇怪 - 它应该有一个 servername 部分：

http:// **SERVERNAME.DOMAIN.NET** :8080/services/v1.0/serverstatus.asmx

# testing - 代表的灵魂二传手在界面中吗？

> ID：894571
> 
> 赞同：0
> 
> 时间：2009-05-21T19:09:04.237
> 
> 标签：testing, setter

我们有很多具有这种设计的对象：接口和几个实现，以及通过组合使用多个对象。示例： Foo 实现了 IFoo 并有一个 Bar 对象，该对象实现了 IBar Foo 也有一个用于注入依赖项的 setBar(IBar bar) 方法。

我的问题是：setter 不在界面中？（为了测试，嘲笑......我被卡住了！）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-21T19:24:47.433

在界面中有一个设置器只是为了模拟和测试是不好的。因此，您允许该接口的用户任意设置组件，即使该对象的属性在构造后可能不应该被修改。接口不应该揭示如何构造对象。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-21T19:19:51.750

如果您使用多态性，即在接口类型上调用setter，那么显然您需要在接口中使用它。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-21T19:23:51.180

使用 setter Injection 将 Bar 注入 Foo。在没有 Bar 的情况下 Foo 不能存在的情况下，将 Bar 注入构造函数会更合适。

进一步阅读：[依赖注入的类型](http://www.martinfowler.com/articles/injection.html#FormsOfDependencyInjection)

# c# - Drag-Drop and two forms. How can I detect when the drop has happened in outside app

> ID：894582
> 
> 赞同：3
> 
> 时间：2009-05-21T19:11:46.493
> 
> 标签：c#, winforms, drag-and-drop

I've got a WinForm where the user has the ability to drag an item from it to a different application. In my case the second application is SolidWorks. I have no problem getting the drag part working. The user is able to drag the part from my application to the SolidWorks drawing, but I want to close my WinForm when the user has dropped the item in the drawing.

Is there an event I'm missing somewhere? QueryContinueDrag doesn't seem to be it. I can drop the part all day long, but QueryContinueDrag doesn't fire on the drop.

EDIT: Here's a sample of the code I use to start the drag operation. I just don't know when the drop occurs in the other app.

```
 string[] fList = new string[1];
fList[0] = @"C:\block.sldblk";
DataObject dataObj = new DataObject(DataFormats.FileDrop, fList);
DragDropEffects eff = DoDragDrop(dataObj, DragDropEffects.Link | DragDropEffects.Copy); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-21T19:27:30.737

Your best bet is probably to use an IDataObject as your data in the call to DoDragDrop().

Instead of putting the data you want in there directly, create a class that inherits from IDataObject to hold your data. When the user "drops" the part, then the IDataObject's "GetData" method will be called. You can use this to set a flag to close your form or give user feedback that the drop occurred.

Note that there is an implementation of IDataObject already provided - DataObject. It's normally much easier to extend or use that than try to create your own.

EDIT: I see you're using DataObject already - rather than use it, use a derived class and override GetData, this will be called when the drop occurs.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-21T21:03:26.847

DoDragDrop() has a return value. If it returns DragDropEffects.None, you'll want to keep your form alive.

# hibernate - 了解 JasperReports 和 JRBeanCollectionDataSource

> ID：894587
> 
> 赞同：1
> 
> 时间：2009-05-21T19:13:04.947
> 
> 标签：hibernate, jasper-reports, ireport, subquery

我现在在我的代码中有我的`JasperReports`工作*`JRBeancollectionDataSource`*！我只是对一些事情有点困惑......

当我在`iRepor`t 中设计报告时，我从查询中创建字段，我可以做得很好，因为当我实际运行查询时，我使用的是 aa 代码*`JRBeanCollectionDataSource`*，因此报告中的 hql 与此完全无关观点？

此外，我在为报告获取的对象中有其他持久对象的列表集合，我想要一个可以列出列表元素的子报告，但我不明白如何从内部引用这些对象`iReport`以使其生成当我在代码中时感觉。我可以只从一个领域引用到另一个领域吗？即，称为属性的字段和直接将该字段引用为properties.value 的子报表？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-11-12T13:01:45.360

使用 JRBeancollectionDataSource 时，我更喜欢执行以下操作：

1.  确保将项目类路径放在 iReport 的“报告导入指令”中
2.  创建报表查询或子数据集查询时。打开 Report Query 对话框，选择下一个选项卡“JavaBean 数据源”并记下 bean 的完整路径名。然后单击“读取属性”，它应该读取所​​有带有 getter 的字段。
3.  选择所需的字段，然后单击添加选定字段。

您将在报告中找到您选择为 $F(fieldName) 的所有内容。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-22T16:37:48.690

我已经有一段时间没有做过 jasper 报告了，但是对于带有 JRDataSources 的模板，您不会在报告中使用任何 sql hql，示例是

[http://jasperforge.org/uploads/publish/jasperreportswebsite/trunk/samples/DataSourceReport.jrxml](http://jasperforge.org/uploads/publish/jasperreportswebsite/trunk/samples/DataSourceReport.jrxml)

u 在执行的填充部分传入数据源

# sql-server - 有没有办法在 django 中使用 GUID？

> ID：894595
> 
> 赞同：16
> 
> 时间：2009-05-21T19:14:04.960
> 
> 标签：sql-server, django, django-pyodbc

我有几个通过 SQL Server 中的 GUID 连接的表。现在，我发现了一些自定义字段来添加对 django 中 GUID 的支持，但如果可能的话，我倾向于避免在博客文章中使用代码。除了加入它之外，我不会对 GUID 做任何事情，并且可能会为新条目分配一个 GUID（尽管这是可选的）。有没有办法使用 django 的内置类型来允许这样做？就像我可以使用某种 char 字段或二进制字段并“欺骗”django 加入使用它吗？

如果有任何帮助，我正在使用 django-pyodbc。

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2009-09-15T21:00:16.780

我会创建一个基本的 GUID 模型，以便在我的项目中为任何其他模型重用它的属性。模型继承在 Django 1.0 之前的几个版本中运行良好，并且在 Django 1.0 中非常稳定。

创建类似 project/common/models.py 的内容并将此类放置在那里：

```
import hashlib
import random
from django.db import models

class GUIDModel(models.Model):

    guid = models.CharField(primary_key=True, max_length=40)

    def save(self, *args, **kwargs):

      if not self.guid:
        self.guid = hashlib.sha1(str(random.random())).hexdigest()

      super(GUIDModel, self).save(*args, **kwargs) 
```

然后像往常一样创建其他模型：

```
from common.models import GUIDModel

class Customer(GUIDModel):
  name = models.CharField(max_length=64)

class Product(GUIDModel):
  name = models.CharField(max_length=64)

class Sale(GUIDModel):
  customer = models.ForeignKey(Customer)
  product = models.ForeignKey(Product)
  items = models.PositiveIntegerField() 
```

一切都应该很好地使用 GUID 作为主键而不是自动增量整数。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2010-04-05T06:46:19.717

看看 Django-extensions [UUID Field](https://github.com/django-extensions/django-extensions/blob/master/django_extensions/db/fields/__init__.py#L480)

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2015-12-14T00:57:20.170

老问题，但对于任何使用 Django 1.8+ 的人来说，内置的[UUIDField](https://docs.djangoproject.com/en/1.8/ref/models/fields/#uuidfield)可能会派上用场。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-22T13:49:32.047

如果我做一个`python manage.py inspectdb`输出是这样的：

```
class SomeModel(models.Model):
    uid = models.TextField(primary_key=True)

class SomeOtherModel(models.Model):
    uid = models.TextField() 
```

但这不起作用。无论出于何种原因，如果 uid 是主键，这将不起作用。所以我把它改成这样：

```
class SomeModel(models.Model):
    uid = models.TextField()

class SomeOtherModel(models.Model):
    somemodel = models.ForeignKey(SomeModel, db_column='uid', to_field='uid') 
```

这似乎有效，但速度*非常缓慢*。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2020-10-07T16:14:06.860

Django 现在在 1.8 及更高版本中包含了 UUID 字段。用于存储通用唯一标识符的字段。使用 Python 的 UUID 类。在 PostgreSQL 上使用时，它以 uuid 数据类型存储，否则以 char(32) 形式存储。该字段通常用作主键，以下是如何将其与模型一起使用 ->

your_app/models.py

```
import uuid
from django.db import models

class MyUUIDModel(models.Model):
    id = models.UUIDField(primary_key=True, default=uuid.uuid4, editable=False)
    # other fields 
```

* * *

## 回答 #6

> 赞同：-3
> 
> 时间：2009-08-28T19:42:44.777

对于那些真正需要生成 GUID 的人：

```
guid = hashlib.sha1(str(random.random())).hexdigest() 
```

# c - 在 C 中传递动态分配的整数数组

> ID：894604
> 
> 赞同：0
> 
> 时间：2009-05-21T19:15:34.083
> 
> 标签：c, arrays, argument-passing, dynamic

我在此站点上阅读了有关“[在 C 中传递多维数组”的示例。](https://stackoverflow.com/questions/423554/passing-multi-dimensional-arrays-in-c)

这是一个使用 char 数组的好例子，我从中学到了很多。我想通过创建一个处理动态分配的一维整数数组的函数来做同样的事情，然后创建另一个处理多维整数数组的函数。我知道如何将其作为函数的返回值。但在这个应用程序中，我需要在函数的参数列表中执行此操作。

就像我上面提到的示例一样，我想将指向整数数组的指针以及元素的数量“num”（或二维数组函数的“row”和“col”等）传递给函数。 ）。我在这里得到了另一个示例的重新设计版本，但我无法让它工作，尽我所能（标记来自该示例的新代码或修改的代码行）。有谁知道如何解决这个问题？

```
#include <stdio.h>
#include <stdlib.h>
#include <string.h>
#define ELEMENTS 5
void make(char **array, int **arrayInt, int *array_size) { 
    int i;
    char *t = "Hello, World!";
    int s = 10; // new
    array = malloc(ELEMENTS * sizeof(char *));
    *arrayInt = malloc(ELEMENTS * sizeof(int *));  // new
    for (i = 0; i < ELEMENTS; ++i) {
        array[i] = malloc(strlen(t) + 1 * sizeof(char));
        array[i] = StrDup(t);
        arrayInt[i] = malloc( sizeof(int)); // new
        *arrayInt[i] = i * s; // new
    }
}
int main(int argc, char **argv) {
    char **array;
    int  *arrayInt1D; // new
    int size;
    int i;
    make(array, &arrayInt1D, &size); // mod
    for (i = 0; i < size; ++i) {
        printf("%s and %d\n", array[i], arrayInt1D[i]); // mod
    }
    return 0;
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-21T19:25:20.443

您在这里缺少一行的大小：

```
 arrayInt[i] = malloc( sizeof(int)); // new 
```

应该是这样的：

```
 arrayInt[i] = malloc( row_len * sizeof(int)); // new 
```

在您使用给定字符串的长度作为行大小之前的位置（也`strlen(t)+1`应该在括号中，尽管效果相同，因为`sizeof(char)`是 1）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-21T19:29:53.603

该代码中有很多问题。看看以下内容：

```
#include <stdio.h>
#include <stdlib.h>
#include <string.h>

#define ELEMENTS 5

/*
 * A string is an array of characters, say char c[]. Since we will be creating
 * an array of those, that becomes char *(c[]). And since we want to store the
 * memory we allocate somewhere, we must be given a pointer. Hence char
 * **(c[]).
 *
 * An int doesn't require a complete array, just int i. An array of those is
 * int i[]. A pointer to those is then int *(i[]).
 */
void
make(char **(chars[]), int *(ints[]), size_t len)
{
    static char hw[] = "Hello, World!";
    size_t i = 0;

    /*
     * Allocate the memory required to store the addresses of len char arrays.
     * And allocate the memory required to store len ints.
     */
    *chars = malloc(len * sizeof(char *));
    *ints = malloc(len * sizeof(int));

    /* Fill each element in the array... */
    for (i = 0; i < ELEMENTS; i++) {
        /* ... with a *new copy* of "Hello world". strdup calls malloc under
         * the hood! */
        (*chars)[i] = strdup(hw);
        /* ...with a multiple of 10\. */
        (*ints)[i] = i * 10;
    }
}

int
main(void)
{
    /* A string c is a character array, hence char c[] or equivalently char *c.
     * We want an array of those, hence char **c. */
    char **chars = NULL;
    /* An array of ints. */
    int *ints = NULL;
    size_t i = 0;

    /* Pass *the addresses* of the chars and ints arrays, so that they can be
     * initialized. */
    make(&chars, &ints, ELEMENTS);
    for (i = 0; i < ELEMENTS; ++i) {
        printf("%s and %d\n", chars[i], ints[i]);
        /* Don't forget to free the memory allocated by strdup. */
        free(chars[i]);
    }

    /* Free the arrays themselves. */
    free(ints);
    free(chars);

    return EXIT_SUCCESS;
} 
```

# c# - （多层）嵌入式 TabControls 错误的自定义绘图

> ID：894607
> 
> 赞同：0
> 
> 时间：2009-05-21T19:15:53.117
> 
> 标签：c#, winforms, .net-3.5, tabcontrol, ownerdrawn

我有一个具有 3 层深的选项卡控件的 winform 应用程序。我正在使用下面的类动态地为选项卡着色。当它为嵌入的 tabcontrol 着色时，它会很合适。

```
A first chance exception of type 'System.ComponentModel.Win32Exception' occurred in System.Windows.Forms.dll 
```

我需要为那些做一些不同的事情吗？如果我注释掉对 tabRenderer 的嵌入式表单调用，那么我不会收到这些错误。我没有正确处理我的 TabRenderer 对象吗？

可能完全是另外一回事吗？我嵌入选项卡控件的方式？

我的程序目前看起来的一个例子在这里 -->

[![](https://i.stack.imgur.com/Uxerf.jpg)](http://picasaweb.google.com/lh/photo/MoJ9OhnRGsJSvIydBPjWiw?feat=embedwebsite)
[（来源：[ggpht.com](http://lh6.ggpht.com/_DqVwi_JXyS0/Sf8EI0ETYrI/AAAAAAAABhI/pmAhozErubo/s288/MATRIXUIExample.JPG)）]
来自[DevFiles](http://picasaweb.google.com/TheSchallers/DevFiles?feat=embedwebsite)

如您所见，有 3 层选项卡控件。这在程序中发生了两次，都导致了上述错误。因为有 5 个选项卡控件，所以总共有 6 次对 tabRenderer 的调用。1 个顶级，3 个二级和 2 个三级。

用于为选项卡控件着色的代码：

```
public class psTabRenderer
{
    private TabControl _tabControl;
    private Color _fillColor;
    private Color _selectedFillColor;
    private Color _textColor;
    private Color _selectedTextColor;

    public psTabRenderer(TabControl tabControl, Color fillColor, Color selectedFillColor, Color textColor, Color selectedTextColor)
    {
        _tabControl = tabControl;
        _fillColor = fillColor;
        _selectedFillColor = selectedFillColor;
        _textColor = textColor;
        _selectedTextColor = selectedTextColor;

        _tabControl.DrawMode = TabDrawMode.OwnerDrawFixed;
        _tabControl.DrawItem += TabControlDrawItem;
    }

    private void TabControlDrawItem(object sender, DrawItemEventArgs e)
    {
        TabPage currentTab = _tabControl.TabPages[e.Index];
        Rectangle itemRect = _tabControl.GetTabRect(e.Index);
        var fillBrush = new SolidBrush(_fillColor);
        var textBrush = new SolidBrush(_textColor);
        var sf = new StringFormat
        {
            Alignment = StringAlignment.Center,
            LineAlignment = StringAlignment.Center
        };

        //If we are currently painting the Selected TabItem we'll
        //change the brush colors and inflate the rectangle.
        if (Convert.ToBoolean(e.State & DrawItemState.Selected))
        {
            fillBrush.Color = _selectedFillColor;
            textBrush.Color = _selectedTextColor;
            itemRect.Inflate(2, 2);
        }

        //Set up rotation for left and right aligned tabs
        if (_tabControl.Alignment == TabAlignment.Left || _tabControl.Alignment == TabAlignment.Right)
        {
            float rotateAngle = 90;
            if (_tabControl.Alignment == TabAlignment.Left)
                rotateAngle = 270;
            var cp = new PointF(itemRect.Left + (itemRect.Width / 2), itemRect.Top + (itemRect.Height / 2));
            e.Graphics.TranslateTransform(cp.X, cp.Y);
            e.Graphics.RotateTransform(rotateAngle);
            itemRect = new Rectangle(-(itemRect.Height / 2), -(itemRect.Width / 2), itemRect.Height, itemRect.Width);
        }

        //Next we'll paint the TabItem with our Fill Brush
        e.Graphics.FillRectangle(fillBrush, itemRect);

        //Now draw the text.
        e.Graphics.DrawString(currentTab.Text, e.Font, textBrush, (RectangleF)itemRect, sf);

        //Reset any Graphics rotation
        e.Graphics.ResetTransform();

        //Finally, we should Dispose of our brushes.
        fillBrush.Dispose();
        textBrush.Dispose();
    }
} 
```

这就是我所说的：

```
 private void frmMCPEmployment_Load(object sender, EventArgs e)
    {
        FormPaint();
    }

    public void FormPaint()
    {
        // ToDo: This call to the Tab Renderer is throwing a Win32 "Error Creating Window Handle" 
        new psTabRenderer(tclEmployment, Color.LightSteelBlue, Color.Khaki, Color.Black, Color.Black);
    } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-21T20:22:22.810

好的，我回答了我自己的问题。（有点）

我相信正在发生的事情是，当我的应用程序加载时，它开始触发每个 Forms Load() 事件，这反过来又触发它嵌入的 Forms Load() 事件等等。我在加载事件中调用了 TabRenderer，但发生了一些我不明白的事情。我将该调用拉出到 PaintTabs() 函数，然后等待第一个完成，然后再调用下一个（我认为？）。

无论哪种方式，它都不再产生任何错误。我现在从 TOP LEVEL TabControl 中这样称呼它：

```
 public void PaintTabs()
    {
        new psTabRenderer(tclWWCModuleHost, Color.LightSteelBlue, Color.Khaki, Color.Black, Color.Black);
        FrmWwcMemberHost.PaintTabs();
        FrmWwcMcpHost.PaintTabs();
        FrmCaseNotes.PaintTabs();
    } 
```

# java - 如何在没有主键的情况下对表或视图进行休眠映射

> ID：894610
> 
> 赞同：10
> 
> 时间：2009-05-21T19:16:01.803
> 
> 标签：java, hibernate, jdbc

> **可能重复：**
> [休眠且无PK](https://stackoverflow.com/questions/767277/hibernate-and-no-pk)

任何人都知道如何在没有主键的情况下对表或视图进行休眠映射？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-05-21T19:26:59.847

不要认为 Hibernate 允许映射没有主键的表……想想 Hibernate 如何在没有可以唯一标识行的列的情况下执行更新。

我想一种解决方法是对所有列使用复合键，但添加主键会更好。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-10-04T13:25:57.437

我只会在您读取数据（而不是写入数据）时这样做。当你有一个像 oracle 这样的数据库时，你可以有像这样的语句

```
select DOKUMENT.*, ROWID from DOKUMENT 
```

→ 因此，您可以将此语句添加到 Hibernate 映射中：

```
<id column="ROWID" type="string" /> 
```

随后，您将所有其他列定义为

```
<property... 
```

使用逆向工程向导时，您可以

1.  删除复合键标签，
2.  搜索并替换 key-property 的属性和
3.  插入上面的行

# iphone - 继承 UITableViewCell 的问题

> ID：894612
> 
> 赞同：1
> 
> 时间：2009-05-21T19:16:23.270
> 
> 标签：iphone

我有一个继承 UITableViewCell 的 A 类（用于自定义表格单元格）。它有成员说 x 这是一个 UILabel。

现在，如果我想在 cellForRowAtIndexPath 方法中设置像 axtext ="some text" 这样的值，我会收到编译器错误“单元格中的成员 x 错误，它是非类类型 UITableViewCell”。

你能告诉我如何解决这个问题吗？

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-21T19:29:03.230

首先，确保您的属性定义正确：

```
@interface A : UITableViewCell {
  UILabel *x;
}

@property (nonatomic, retain) IBOutlet UILabel *x;

@end 
```

然后确保您已在表格视图数据源中包含 Ah，并确保将单元格转换为类型 A：

```
- (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath {
  static NSString *cellIdentifier = @"cell";
  A *a = (A *)[tableView dequeueReusableCellWithIdentifier:cellIdentifier];
  if (a == nil) {
    a = [[A alloc] initWithFrame:CGRectZero reuseIdentifier:cellIdentifier];
  }
  a.x.text = @"some text";
  return a;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-21T19:20:44.167

请务必将 x 作为属性添加到您的子类：

```
@interface ACell : UITableViewCell {
      UILabel *X;
}

@property (readonly, nonatomic) UILabel* X; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-21T19:23:42.133

尝试使用：

```
[[a x] setText:@"your text]; 
```

看看会发生什么。

# content-management-system - 如何在人们可以编辑自己的 html 的 CMS 中处理图像

> ID：894616
> 
> 赞同：1
> 
> 时间：2009-05-21T19:18:04.000
> 
> 标签：content-management-system

我们有一个 CMS，人们可以在其中上传图片。我们目前不提供删除功能，但最好提供一个。提供删除功能的问题是人们可能会删除他们不需要的图像，但同一图像可能会在其他人的文章中使用。因为人们使用 WYSIWYG 浏览器编辑器选择图像，所以我们不能很容易地跟踪我认为使用了哪个图像。

任何人都对如何在不破坏其他文章的情况下启用删除有一个很好的解决方案？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-22T06:08:54.043

对帖子数据进行一点分析可能会产生一些图像 URI，您可以使用这些 URI 来修改引用计数（这种方式也适用于直接编辑）？

除了引用计数之外，如果您还没有这样做，您可以根据每个用户对上传的媒体进行围栏 - 因此，如果他们删除了*他们*认为不需要的内容，它不会破坏其他用户的工作吗？

这些都不是特别优雅......但问题也不是：P。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-21T19:21:37.427

如果您将图像位置存储在数据库中，并且从数据库生成的列表中选择用户，您可以将引用计数添加到图像记录中。当图像添加到页面时增加它，当它被删除时减少它。

然后在您的图像管理页面上仅在引用计数为 0 时启用删除。

尽管如果用户可以编辑他们自己的 HTML，那么您无法阻止他们（除了教育）直接引用图像。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-21T19:23:00.900

尽管这实际上取决于您实施 CMS 解决方案的方式，但如果您跟踪哪些文章引用了您的图像，这可能是一个好主意。然后，每当有人从他们的文章中删除图像时，您知道只有在剩余零引用时才删除图像文件本身。

# java - 如何在 XStream 中禁用漂亮打印（空白/换行符）？

> ID：894625
> 
> 赞同：21
> 
> 时间：2009-05-21T19:19:03.360
> 
> 标签：java, xml, json, xstream

这就是我为 XML 创建 XStream 实例的方式：

```
XStream xstream = new XStream(); 
```

这适用于 JSON：

```
private final XStream xstream = new XStream(new JsonHierarchicalStreamDriver() {
        public HierarchicalStreamWriter createWriter(Writer writer) {
            return new JsonWriter(writer, JsonWriter.DROP_ROOT_MODE);
        }
    }); 
```

它们都很好地打印（缩进）输出。

如何让 XStream 禁用漂亮打印？

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2009-08-17T19:14:14.500

谢谢，你的帖子有帮助！！！这是我用来转换为字符串的方法。

```
String strXML = "";
XStream xs = new XStream();
StringWriter sw = new StringWriter();
xs.marshal(this,  new CompactWriter(sw));
strXML = sw.toString(); 
```

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2009-05-22T20:17:38.650

在社区的一些帮助下，我找到了答案。

**对于 XML**，您必须更改序列化方式：

该行：

```
xStream.toXML(o, new OutputStreamWriter(stream, encoding)); 
```

改为线

```
xStream.marshal(o, new CompactWriter(new OutputStreamWriter(stream, encoding))); 
```

**对于 JSON**，您只需更改创建 XStream 的方式。所以XStream的初始化改成：

```
private final XStream xstreamOut = new XStream(new JsonHierarchicalStreamDriver() {
    public HierarchicalStreamWriter createWriter(Writer writer) {
        return new JsonWriter(writer, new char[0], "", JsonWriter.DROP_ROOT_MODE);
    }
}); 
```

请注意，使用了 4 参数 JsonWriter 构造函数。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-05-21T19:23:45.563

使用紧凑型写入器在 xstream 上使用 marschal 方法

```
xstream.marshal(someObject, new CompactWriter(out)); 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2015-02-13T14:05:29.923

漂亮打印的默认行为来自 AbstractXmlDriver.createWriter() 方法（XStream 使用 XppDriver 作为其默认分层流驱动程序，这扩展了 AbstractXmlDriver）：

```
public HierarchicalStreamWriter createWriter(Writer out) {
    return new PrettyPrintWriter(out, getNameCoder());
} 
```

如果您想全局禁用漂亮打印（同时保留所有其他默认行为）并且只使用简单的 toXML(o) 方法而不是使用此处建议的其他每次使用选项，您可以按如下方式初始化您的 XStream 实例。这会用 CompactWriter 覆盖上述方法。

```
XStream xstream = new XStream(new XppDriver() {
    @Override
    public HierarchicalStreamWriter createWriter(Writer out) {
        return new CompactWriter(out, getNameCoder());
    }
}); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2019-02-06T23:08:09.703

以这种方式创建您的 XStream 实例：

```
XStream xstream = new XStream(new JsonHierarchicalStreamDriver() {
        public HierarchicalStreamWriter createWriter(Writer writer) {
            return new JsonWriter(writer, JsonWriter.DROP_ROOT_MODE, new JsonWriter.Format(new char[0], new char[0], 0));
        }
}); 
```

这是 Format 类的构造函数：

```
/**
 * Create a new Formatter.
 * 
 * @param lineIndenter the characters used for indenting the line
 * @param newLine the characters used to create a new line
 * @param mode the flags for the format modes
 * @since 1.4
 */
public Format(char[] lineIndenter, char[] newLine, int mode) {
    this(lineIndenter, newLine, mode, new NoNameCoder());
} 
```

查看源代码以`JsonWriter`获取更多信息

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2019-11-05T17:55:32.920

这对我有用：

```
XStream stream = new XStream(new StaxDriver());
stream.toXML(messages, out);
StringWriter out = new StringWriter();
String s = out.toString();
LOG.info(s); 
```

# java - 用于检查实时 Java 应用程序的实时代码覆盖率查看器工具？

> ID：894628
> 
> 赞同：3
> 
> 时间：2009-05-21T19:19:39.223
> 
> 标签：java, user-interface, visualization, code-coverage, real-time

我一直在寻找旨在检查实时 Java 应用程序的代码覆盖率查看器，主要是在 Tomcat 等应用程序容器内运行的 webapps。当然，有很多不错的工具可以获取单元测试覆盖率的自动报告，但我的目标更像是实时了解不熟悉的 Java 应用程序在特定用户交互中的作用。

Eclipse Java 调试器（使用 JPDA 进行远程调试）非常有用，但前提是您已经熟悉应用程序的体系结构。理论上，我可以使用一些覆盖工具并将其设置为每两秒自动刷新静态 HTML 覆盖报告，但这远非最佳。

对于 Adob​​e Flex，FlexCover 正是我想要的，它提供了一个几乎实时可视化覆盖范围的覆盖查看器工具，而且设置起来相对简单，至少对于了解这些内容的人来说是这样。那么有没有类似的易于设置的 GUI 工具，免费或非免费的，适用于 Java 吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-22T01:07:06.883

您可以在 Eclipse 中查看 Web 应用程序生成的 Clover 覆盖数据，而无需从 Eclipse 启动 Web 服务器。

诀窍是在 Eclipse Clover Config 屏幕中配置 initString 以指向您的 webapp 正在使用的同一个 clover.db：

![三叶草初始化字符串配置](https://i.stack.imgur.com/IJq0g.png)

而且 - 您需要确保您使用的是线程化的[flushpolicy](http://confluence.atlassian.com/display/CLOVER/Using+a+Flush+Policy)。clover-maven2-plugin 默认使用一个。如果您使用 Ant，则需要在 <clover-setup/> 上显式设置它。

您还必须确保在 Eclipse 和构建工具中使用相同版本的 Clover。

我已经在本地进行了测试-效果很好！

请让我知道你的情况。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-21T20:36:03.063

看看[三叶草](http://www.atlassian.com/software/clover/)。这可能是您正在寻找的东西。不是免费的，但很好。

# authentication - 覆盖浏览器身份验证对话框

> ID：894631
> 
> 赞同：0
> 
> 时间：2009-05-21T19:20:24.247
> 
> 标签：authentication, browser, dialog

当从 Web 服务器接收到 401 消息时，有没有办法使用 Java 覆盖浏览器身份验证对话框？我想知道何时显示此对话框，而不是将其提供给用户，而是填写他们的凭据。

应用概述：

我编写了 Web 服务器，所以基本上我想阻止某人打开外部浏览器并输入 localhost 和端口来访问正在显示的数据。我的应用程序有一个嵌入式网络浏览器，链接到我的书面服务器。浏览器显示解密的内容，因此如果我强制进行身份验证（即使对于我的嵌入式浏览器），外部浏览器也需要凭据。如果我的嵌入式浏览器试图访问文件，我会为用户提供凭据并显示内容

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-21T19:33:56.340

如果您不关心显示的密码，您可以构建 URL，以便它通过凭据 ex。[http://username:password@www.example.com](http://username:password@www.example.com) 这将绕过身份验证框，但会向用户显示凭据，因此也可能不是您要查找的内容。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-29T14:31:17.723

SWT 3.5M6 中有一个新的侦听器，称为 AuthenticationListener。它只是侦听从服务器传递的身份验证事件并被触发。下面的代码是执行我想要的行为的代码。它等待身份验证，如果主机是我的应用程序，它会传回凭据。当然，用适当的变量填写 USER_NAME、PASSWORD 和 HOST_NAME。否则，它会弹出浏览器身份验证对话框并让用户输入凭据。此代码也可以在 Eclipse SWT 片段页面中找到：

webBrowser.addAuthenticationListener(new AuthenticationListener()

{

```
 public void authenticate(AuthenticationEvent event) {
            try {
                URL url = new URL(event.location);

                if (url.getHost().equals(HOST_NAME)) 
                {
                    event.user = USER_NAME;
                    event.password = PASSWORD;
                } 
                else 
                {       
                    /* do nothing, let default prompter run */
                }
            } catch (MalformedURLException e) {
                /* should not happen, let default prompter run */
            }
        }
    }); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-21T19:32:19.040

如果您想控制显示给用户的身份验证内容，您可以将 web.xml 的 login-config 部分中的 auth-method 从 BASIC 更改为 FORM。

然后您可以指定在用户进行身份验证时应该显示哪个页面，并且，我想，为他们预先填写凭据......但这不会破坏安全的全部目的吗？

[为 Web 应用程序设置身份验证](http://e-docs.bea.com/wls/docs70/webapp/security.html#100585)

在进一步详细信息后编辑：

我唯一的建议是将 auth-method 更改为 CLIENT-CERT 并需要双向 SSL，其中客户端还需要向服务器提供证书。如果您将证书安装到嵌入式浏览器中（并确保外部浏览器无法获取证书），那么您应该没问题。实际上，这应该会阻止显示任何身份验证对话框。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-21T19:36:28.860

你的问题有点不清楚。整个基本身份验证基于 HTTP 标头。

如果浏览器获得授权标头，则显示对话框。然后将对话中的内容发送回服务器。它没有什么特别之处。它是 base64 编码的用户名：密码。看一下

[维基百科](http://en.wikipedia.org/wiki/Basic_access_authentication)

问题是你想如何干预。您必须捕获授权标头，然后对于下一个请求，您必须更改 HTTP 标头以包含凭据。

希望有帮助

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-21T19:37:26.583

我认为这主要是依赖于浏览器的行为以及服务器向浏览器报告的内容。

例如，作为 Microsoft 产品的 Internet Explorer 直接支持在匿名请求 401 失败后自动发送 Windows 凭据（您可以在 Internet 设置中修改此行为）。

例如，Firefox 不会也将始终提示用户，即使它被设置为通过密码管理器记住 id 和密码。如果自动登录失败，IE 也会提示（例如您的 Windows 凭据仍然会导致 401，因为您的 id 不被允许）。

我不认为，作为一名 Web 开发人员，除了将服务器和应用程序设置为以最预期和最和谐的方式工作之外，您对此没有太多控制权......如果可以的话，这可能会进入[黑帽领域](http://en.wikipedia.org/wiki/Black_hat#Black_Hat_Hacker)。

# asp.net - ASP.NET MVC 在某些方面是不是倒退了一步？

> ID：894637
> 
> 赞同：8
> 
> 时间：2009-05-21T19:21:22.497
> 
> 标签：asp.net, asp.net-mvc

我要求这不要开始任何负面的事情。相反，在查看 ASP.NET MVC 之后，我发现我没有使用 web 表单上的控件，而是手动编写 html 标记（喘气。）

这是倒退吗？我记得从经典的 asp 到 asp.net 并拖放控件，创建一个 bll 等。现在看来我是手工完成所有这些，就像经典一样，除了我有很好的 mvc 设计。

我想我正试图弄清楚为什么这是一个从快速开发环境向前发展到看起来更乏味的环境。

编辑：

我一直认为 Visual Studio .NET 是使用 ASP.NET 及其所有控件和自动化的一个重要原因。现在有了 MVC，它让我觉得它就像任何其他具有像样 IDE 的 MVC 一样，因为我现在是手工完成所有事情。

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2009-05-21T19:28:48.457

*   “经典” ASP.NET 并没有消失——如果你想要或需要它，你仍然可以使用它
*   尽管您可能会或可能不会获得“拖放”功能，但在 AutoComplete 和各种渲染助手之间，您可以在几分钟内轻松获得工作视图
*   创建视图只是整个项目的一小部分
*   即使在 ASP.NET 中，我也很少使用可视化编辑器。我总是觉得它妨碍了我并为我做出了错误的决定。

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2009-05-21T19:28:52.560

是向前迈进了一步：

1.  代码是完全可测试的
2.  您可以完全控制服务器生成的内容
3.  没有更多的视图状态！
4.  提高服务器响应速度
5.  没有 WebForm 的页面生命周期，服务器 CPU 负载更少
6.  一种更接近网络的编程模型（网络表单旨在将桌面编程模型引入网络）。
7.  ……

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2009-05-21T19:40:40.320

有趣的是你应该提到这一点——我刚刚读完“[专业 ASP.NET MVC 1.0](https://rads.stackoverflow.com/amzn/click/com/0470384611) ”中的一章，它回答了这个确切的问题。

他们将 Web Forms 和 MVC 之间的区别作为领导管弦乐队和创作歌曲之间的区别进行了比较。MVC 不能为您提供与 Web 表单相同级别的即时响应，但它确实为您提供了许多**Web 开发人员**所期望的粒度级别。众所周知，ASP.NET 控件，即使在其更高版本中，也注入了比预期更多的 HTML。

所以，在功能上是的，这是一个退步，但这只是因为你已经完全控制了页面上的内容。与往常一样，为工作选择正确的语言。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2009-05-21T19:43:15.587

这是横向的一步，而不是前进或后退；只是做同一件事的另一种方式，但重点不同。使用 ASP.NET 表单，很容易“绘制”页面，使其看起来大致与您想要的一样，但很难使其表现得像一个适当的 Web 应用程序。使用 ASP.NET MVC，将它的外观拼凑起来并不容易，但实际上更容易让它像网站一样工作，其中的 URL 描述了以可预测的方式返回的内容。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-05-21T19:28:51.390

告诉我怎么回事儿。我仍在努力弄清楚为什么我要让自己受制于此。最终，排名第一的卖点是单元测试。对于我们这些不同意这一点的人来说，恕我直言，优势很少，如果有的话。

也就是说，我愿意相信其他情况。我认为 MVC 是一个很好的基础，但就像你说的，它有时非常非常乏味。工具箱中的拖放控件的 RAD 系统曾经很糟糕，但自从 vs2008 以来，它已经相当令人愉快了。我预计 Telerik、Infragistics、ComponentOne 等主要工具包供应商将很快推出 MVC 友好的工具包（我希望！）。

我只是在学习它，因为我目前正在进行一个基于它的项目（不是我的设计）。不要忘记您不必使用它。经典的 ASP.NET 并没有消失。:)

-Oisin

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-05-21T19:44:42.760

对我来说，摆脱视图状态和页面生命周期是一种加减法。:) 更不用说因为我的手“脏”了而对我的网络编程知识有好处。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-05-21T19:49:51.470

有些人可能会说 ASP.Net 是一个倒退，因为它可以通过将您锁定为使用预构建控件来限制应用程序的灵活性。

经典的 ASP 还不成熟，但它确实让您对标记代码进行了非常细粒度的控制，许多人发现普通 ASP.Net 中缺乏这些。

正如我所看到的，ASP.Net MVC 范式使开发人员可以更密切地控制标记，同时仍然可以访问 .Net 框架的所有优点。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2009-05-21T20:44:58.287

我认为这是一个必要的倒退，或者更好的是回溯几步以继续前进。

Web 的发展方向与 ASP.NET 的核心设计前提大相径庭。

最后，将 ASP.NET 与其他敏捷 Web 框架进行比较，我相信这是一个“你不能从这里到达那里”的案例。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-05-21T19:33:02.677

我认为 ASP.Net MVC 框架的部分重点是让开发人员对 HTML 有更多的控制权。拖放控件弄得一团糟。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2009-05-21T20:14:19.520

ASP.net MVC 并不适合所有人或每个应用程序（有些人可能会争论不休！）。MVC 是一个框架，你可以使用它的基本形式，也可以扩展到你的内心深处。它允许您完全控制呈现给用户的内容。

MVC 有很多优点：

关注点分离带来更好的可测试性，可以说是更好的设计和更容易修改 UI

完全控制渲染的内容——这可以产生符合标准、更小、更快的页面

尽管 ASP.net 4 具有路由功能，但清除 SEO 友好的 URL

以最纯粹的形式很好地不使用会话负载平衡。

它也有一些缺点：

需要学习曲线和思维转变

尽管这会改变，但缺乏第三方支持

页面可能看起来很混乱

开发某些类型的控件可能会更加困难，例如可重新排序的数据网格或具有许多步骤的控件，例如向导

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-05-21T19:27:11.470

我认为这是朝着正确方向迈出的一步，但它远没有 WebForms 成熟。我希望很快就会看到商业“控制”库，尽管它不会是拖放的东西。

此外，我认为，如果您将 WebForms 用于您的视图引擎，那么您就没有抓住重点。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2009-05-26T07:34:49.227

最大的区别之一是页面生命周期。对我来说，这是主要的范式变化。遵循良好实践可以解决许多其他好处，尽管 ASP.NET 没有强制执行这些好处。

如果您习惯于 WebForms 和 ASP.NET，MVC 可能看起来很尴尬，但如果您来自经典的 ASP、PHP、Rails 或任何其他尊重 HTTP 流本质的环境，它是一个不错的选择。您可以从 Visual Studio 等出色的 IDE、.NET 等完整而强大的框架（无论您使用 C# 还是 VB.NET）中获益，并且一切都以或多或少熟悉的方式工作。

您可能会失去 ASP.NET 控件和可视化设计器，但对于许多人来说，这与其说是好处不如说是烦恼，这取决于您正在构建的应用程序的类型和您以前的经验。ASP.NET 是从 Winforms 的一个很好的过渡，但对于总是在 Web 环境中工作的人来说似乎有点“被迫”。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2009-05-30T14:41:24.780

Scott Hanselman 有没有说过“MVC 不是 Web Forms 4.0”？我从中得到，他的意思是 MVC 根本不会取代 ASP .Net，它只是 Win Forms 和 Web Forms 的另一种选择。

我确实同意，当我第一次开始研究 MVC 时，我更多地想起了经典的 ASP（而不是 .Net 版本），因为页面后面没有代码，并且在意见，这让我有一段时间，当我第一次使用 ASP .Net 时，好像 ASP .Net 不鼓励对这种标记的需要。

就个人而言，我喜欢 MVC；我认为这很棒，但是 ASP .Net 也有一点空间..！

# .net - 转换为 Nullable 从使用反射的字符串

> ID：894640
> 
> 赞同：3
> 
> 时间：2009-05-21T19:21:41.903
> 
> 标签：.net, reflection, nullable

如何使用反射从字符串转换为 Nullable？

我有以下代码可以在给定几乎任何值的情况下转换为几乎任何值类型。上面有相当多的代码来使用 IsAssignableFrom 等，所以这是最后的手段。

```
MethodInfo parse = t.GetMethod("Parse", new Type[] { typeof(string) });

if (parse != null)
{
    object parsed = parse.Invoke(null, new object[] { value.ToString() });
    return (T)parsed;
}
else
{
    throw new InvalidOperationException("The value you specified is not a valid " + typeof(T).ToString());
} 
```

当我想转换为像 long? 这样的可空类型时，问题就来了。

显然，长? 类没有解析方法。

如何从 nullable 的*模板*类型中提取解析方法？

编辑：

这是我试图通过的一小段测试：

```
[Test]
public void ConverterTNullable()
{
    Assert.That((int?)1, Is.EqualTo(Converter<int?>.Convert(1)));
    Assert.That((int?)2, Is.EqualTo(Converter<int?>.Convert(2.0d)));
    Assert.That(3, Is.EqualTo(Converter<long>.Convert(3)));

    Assert.That((object)null, Is.EqualTo(Converter<long?>.Convert("")));
    Assert.That((object)null, Is.EqualTo(Converter<long?>.Convert(null)));
    Assert.That((object)null, Is.EqualTo(Converter<long?>.Convert(DBNull.Value)));

    Assert.That((long)1, Is.EqualTo(Converter<long?>.Convert("1")));
    Assert.That((long)2, Is.EqualTo(Converter<long?>.Convert(2.0)));
    Assert.That((long?)3, Is.EqualTo(Converter<long>.Convert(3)));
} 
```

以及整个功能：

```
/// <summary>
/// Converts any compatible object to an instance of T.
/// </summary>
/// <param name="value">The value to convert.</param>
/// <returns>The converted value.</returns>
public static T Convert(object value)
{
    if (value is T)
    {
        return (T)value;
    }

    Type t = typeof(T);

    if (t == typeof(string))
    {
        if (value is DBNull || value == null)
        {
            return (T)(object)null;
        }
        else
        {
            return (T)(object)(value.ToString());
        }
    }
    else
    {
        if (value is DBNull || value == null)
        {
            return default(T);
        }

        if (value is string && string.IsNullOrEmpty((string)value))
        {
            return default(T);
        }

        try
        {
            return (T)value;
        }
        catch (InvalidCastException)
        {
        }

        if (Nullable.GetUnderlyingType(t) != null)
        {
            t = Nullable.GetUnderlyingType(t);
        }

        MethodInfo parse = t.GetMethod("Parse", new Type[] { typeof(string) });

        if (parse != null)
        {
            object parsed = parse.Invoke(null, new object[] { value.ToString() });
            return (T)parsed;
        }
        else
        {
            throw new InvalidOperationException("The value you specified is not a valid " + typeof(T).ToString());
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-05-21T19:24:23.707

`TypeConverter`在这种情况下，~~我`Nullable.GetUnderlyingType()`~~可能会使用; 路上的例子……

```
 static void Main()
    {
        long? val1 = Parse<long?>("123");
        long? val2 = Parse<long?>(null);
    }

    static T Parse<T>(string value)
    {
        return (T) TypeDescriptor.GetConverter(typeof(T))
            .ConvertFrom(value);
    } 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-21T19:31:13.817

这应该对工作。（为简单起见，代码嵌入在扩展方法中，尽管它可能不是您想要的。）

```
public static T? ParseToNullable<T>(this string value) where T : struct
{
    var parseMethod = typeof(T).GetMethod("Parse", new Type[] { typeof(string) });
    if (parseMethod == null)
        return new Nullable<T>();

    try
    {
        var value = parseMethod.Invoke(null, new object[] { value.ToString() });
        return new Nullable<T>((T)value);
    }
    catch
    {
        return new Nullable<T>();
    }
} 
```

现在，如果您希望泛型类型参数*本身*是可空类型而不是底层类型（我真的没有看到这方面的优势），您可以使用：

```
Nullable.GetUnderlyingType(typeof(T)) 
```

正如 Marc Gravell 所建议的那样，它只需要对代码进行一些小的修改。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-21T19:49:25.327

我加了一点：

```
if (Nullable.GetUnderlyingType(t) != null)
{
    t = Nullable.GetUnderlyingType(t);
}

MethodInfo parse = t.GetMethod("Parse", new Type[] { typeof(string) }); 
```

感谢大家！

# c# - 如何对数据是分层树（菜单）的 C# 数据列表进行排序？

> ID：894644
> 
> 赞同：2
> 
> 时间：2009-05-21T19:22:10.933
> 
> 标签：c#, sorting

我正在将数据集拉入 ac# 列表并对其进行排序。这是一个分层菜单：

样本对象：

```
public class NavigationInfo
{
    public Int32 Id { get; set; }
    public Int32 ParentId { get; set; } 
    public String Text { get; set; }
    public String Url { get; set; }
    public Int32 Sort { get; set; }
} 
```

ParentId 是对 Id 的递归，而 Sort 是 ParentId 中的一个升序整数。`NavigationInfo`如何使用in的集合来完成`List<NavigationInfo>`？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-21T19:28:06.913

您可以执行以下操作：

```
var navigationInfos = new List<NavigationInfo>(); //fill this collection

navigationInfos.sort((a,b) => a.Id.CompareTo(b.Id)); //sort by Id
navigationInfos.sort((a,b) => a.ParentId.CompareTo(b.ParentId)); //sort by ParentId 
```

**更新：**您还可以使用 LINQ 并在列表上执行 OrderBy。这将返回一个新集合，但更容易按多个条件（升序或降序）排序。

```
var navigationInfos = new List<NavigationInfo>(); //fill this collection
var listSortedById = navigationInfos
                             .OrderBy(n => n.Id).ToList();

var listSortedByParentId = navigationInfos
                               .OrderBy(n => n.ParentId).ToList();

var listSortedByIdThenByParentId = navigationInfos
                              .OrderBy(n => n.Id)
                              .ThenBy(p => p.ParentId)
                              .ToList();

var orderedByIdDescending = navigationInfos
                                      .OrderByDescending(n => n.Id)
                                      .ToList(); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-21T19:43:02.890

如果您的层次结构不仅仅是一个简单的两级排列，您将需要编写一个方法（可能是递归的），该方法可以沿着树向上移动，收集每个项目 id 的整个“路径”。一旦你有了这条路径，排序步骤就相当容易了。

向 NavigateInfo 添加属性

```
public string ItemPath { get; set; } 
```

然后使用这样的方法来设置该属性。

```
public string GetPath(List<NavigationInfo> list, int itemId)
{
    NavigationInfo item = list.SingleOrDefault(x => x.Id == itemId);
    if (item == null)
    {
        return "";
    }
    else
    {
        return GetPath(list, item.ParentId) + "\\" + itemId;
    }
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-21T19:29:07.520

如果数据来自 DB，您可以让 DB 以排序方式发送输出（先父，后子 Id）。

注意：我假设 DB 的 ID 的顺序是 parent 的 ID 比 child 的 ID 小。

# visual-studio - 如何设置 Visual Studio 2005 以使用#ifdef _MSC_VER？

> ID：894646
> 
> 赞同：0
> 
> 时间：2009-05-21T19:22:45.130
> 
> 标签：visual-studio, visual-c++, visual-studio-2005

我正在尝试在 Visual Studio 2005.NET C++ 项目中使用 _MSC_VER 宏，但无法使用 #ifdef _MSC_VER。有谁知道如何设置 Visual Studio 2005 项目才能使用此宏？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-21T20:20:57.617

它[在此处记录为预定义的宏](http://msdn.microsoft.com/en-us/library/b0084kay(VS.80).aspx)。我这样使用它：

```
#if _MSC_VER >= 1400 
```

# heroku - Heroku 上的辐射扩展？

> ID：894647
> 
> 赞同：3
> 
> 时间：2009-05-21T19:22:46.207
> 
> 标签：heroku, content-management-system

有没有人有任何经验让 Radiant CMS 扩展真正进入 heroku 实例？我曾尝试删除子模块并重新添加文件，但运气不佳。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-21T20:05:02.393

Heroku 目前不支持 git 子模块。但是，他们的（优秀的）文档表达了一种解决方法：[在此处查看](http://docs.heroku.com/constraints#git-submodules)

从文档：

```
$ cd myapp
$ rm -rf `find . -mindepth 2 -name .git`
$ git add .
$ git commit -m "brought submodules into the main repo" 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2010-11-23T16:39:05.860

目前不支持 Git 子模块。我们正在评估将来是否支持它们；同时，您需要跟踪主项目中的所有子模块。你可以这样做：

```
$ cd myapp
$ rm -rf `find . -mindepth 2 -name .git`
$ git rm --cache `git submodule | cut -f2 -d' '`
$ git rm .gitmodules
$ git add .
$ git config -l | grep '^submodule' | cut -d'=' -f1 | xargs -n1 git config --unset-all
$ git commit -m "brought submodules into the main repo" 
```

如果您不确定您的项目是否使用子模块，请运行此命令：

```
$ find . -mindepth 2 -name .git 
```

如果它打印任何输出，则说明您有子模块。

# c++ - A*X MOD (2^N)-1 的倒数

> ID：894652
> 
> 赞同：2
> 
> 时间：2009-05-21T19:23:29.357
> 
> 标签：c++, math, prng

给定一个函数 y = f(A,X)：

```
unsigned long F(unsigned long A, unsigned long x) {
    return  ((unsigned long long)A*X)%4294967295;
} 
```

对于'x'的所有值，我如何找到反函数 x = g(A,y) 使得 x = g(A, f(A,x))？

如果 f() 对于 'x' 的所有值都不可逆，那么最接近倒数的是什么？

（F 是一个过时的 PRNG，我试图了解如何反转这样的功能）。

*   更新
    如果 A 与 (2^N)-1 互质，则 g(A,Y) 就是 f(A-1, y)。
    如果 A 不是相对素数，则 y 的范围受到限制……如果限制在该范围内，g(·) 是否仍然存在？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-05-21T19:38:44.583

您需要[扩展欧几里得算法](http://en.wikipedia.org/wiki/Extended_Euclidean_algorithm)。这给了你 R 和 S 这样

```
gcd(A,2^N-1) = R * A + S * (2^N-1). 
```

如果 gcd 为 1，则 R 是 A 的乘法逆元。则逆函数为

```
g(A,y) = R*y mod (2^N-1). 
```

好的，这是G = Gcd(A, 2^N-1) 不是 1 的情况的**更新。在这种情况下**

```
R*y mod (2^N-1) = R*A*x mod (2^N-1) = G*x mod (2^N-1). 
```

如果 y 是由函数 f 计算的，那么 y 可以被 G 整除。因此我们可以将上面的方程除以 G，得到一个模 (2^N-1)/G 的方程。因此解的集合是

```
 x = R*y/G + k*(2^N-1)/G, where k is an arbitrary integer. 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-05-21T19:56:43.593

[此处](http://en.wikipedia.org/wiki/Linear%5C_congruence%5C_theorem)给出了解决方案( [http://en.wikipedia.org/wiki/Linear_congruence_theorem](http://en.wikipedia.org/wiki/Linear_congruence_theorem) )，其中包括如何使用扩展欧几里得算法来找到解决方案的演示。

模函数一般没有反*函数*，但有时您可以找到一组映射到给定 y 的 x。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-05-21T19:59:14.370

Accipitridae、Glenn 和 Jeff Moser 给出了他们之间的答案，但值得多解释一下，为什么不是每个数字在模 4294967295 下都有一个倒数。原因是 4294967295 不是质数；它是[五个因子](http://tinyurl.com/qa88dn)的乘积：3 x 5 x 17 x 257 x 65537。[当且仅当](http://en.wikipedia.org/wiki/Modular_multiplicative_inverse)*x*和**m**互[质时，数字](http://mathworld.wolfram.com/RelativelyPrime.html)*x在 mod* **m** 下具有乘法逆元，因此任何是这些因子的倍数的数字都不能具有你的函数中的一个倒数。

 ***这就是为什么为此类 PRNG 选择的模数通常是素数的原因。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-05-21T19:32:51.850

嗯...这是一个可行的方法：

```
unsigned long G(unsigned long A, unsigned long y)
{
    for(unsigned int i = 0; i < 4294967295; i++)
    {
        if(y == F(A, i)) return i);
    }
} 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-05-21T19:34:28.523

您需要计算 的倒数`A mod ((2^N) - 1)`，但在给定模数的情况下，您可能并不总是有倒数。[在 Wolfram Alpha 上](http://www58.wolframalpha.com/input/?i=inverse+of+12343+mod+4294967295)看到这个。

注意

A = 12343 有一个倒数 (A^-1 = 876879007 mod 4294967295)

但 12345 没有倒数。

因此，如果 A与 (2^n)-1 互[质，那么您可以使用](http://en.wikipedia.org/wiki/Coprime)[扩展欧几里得算法](http://en.wikipedia.org/wiki/Extended_Euclidean_algorithm)轻松创建反函数，其中

`g(A,y) = F(A^-1, y)`,

否则你就不走运了。

**更新**：针对您更新的问题，您仍然无法在受限范围内获得唯一的逆。即使您使用 CookieOfFortune 的蛮力解决方案，您也会遇到类似的问题

`G(12345, F(12345, 4294967294)) == 286331152 != 4294967294`.

# windows - 如何以编程方式确定（Windows）操作系统的最大用户模式空间？

> ID：894663
> 
> 赞同：1
> 
> 时间：2009-05-21T19:26:12.877
> 
> 标签：windows, memory-management, virtual-address-space

我正在编写一个诊断应用程序，它需要记录用户设置为他的用户模式空间，也就是用户模式虚拟地址空间，也就是 WinXP 中的 /3GB 开关或 Vista/Win7 上 bcdedit 中的 increaseuserva 开关。

C++ 或 C++/CLI 都可以。

有任何想法吗 ？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-21T20:14:44.870

[GlobalMemoryStatusEx](http://msdn.microsoft.com/en-us/library/aa366589(VS.85).aspx)会给你一个[MEMORYSTATUSEX](http://msdn.microsoft.com/en-us/library/aa366770(VS.85).aspx)结构`ullTotalVirtual`：

> 调用进程的虚拟地址空间的用户模式部分的大小，以字节为单位。该值取决于进程类型、处理器类型和操作系统的配置。例如，对于 x86 处理器上的大多数 32 位进程，该值约为 2 GB，对于在启用了 4 GB 调整的系统上运行的大地址感知的 32 位进程，该值约为 3 GB。

请注意，您必须将您的 EXE 标记为[LARGEADDRESSAWARE](http://msdn.microsoft.com/en-us/library/wz223b1z(VS.80).aspx)才能[在您的进程中看到 3GB](http://blogs.msdn.com/oldnewthing/archive/2004/08/12/213468.aspx)。

我认为还有另一个函数也返回此信息（不 - 不是已弃用的[GlobalMemoryStatus](http://msdn.microsoft.com/en-us/library/aa366586(VS.85).aspx)）以及处理器信息 - 但我不记得它是 ATM。

# c++ - DevC++ (Mingw) 堆栈限制

> ID：894666
> 
> 赞同：1
> 
> 时间：2009-05-21T19:27:02.920
> 
> 标签：c++, windows, dev-c++

是否可以在 DevC++ 中设置堆栈限制？基本上与 Linux 上的“ulimit -s”相同。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-21T19:30:49.747

尝试将此选项提供给`ld`（链接器）：

> `--stack` *reserve*
> `--stack` *reserve,commit*
> 指定要保留（并可选择提交）用作此程序堆栈的内存字节数。默认为 2Mb 保留，4K 承诺。[此选项特定于链接器的 i386 PE 目标端口]

[http://sourceware.org/binutils/docs/ld/Options.html#Options](http://sourceware.org/binutils/docs/ld/Options.html#Options)

# database - 存储库中的异常：您如何处理它们？

> ID：894668
> 
> 赞同：2
> 
> 时间：2009-05-21T19:27:05.200
> 
> 标签：database, repository-pattern

一个简单的，我有兴趣了解您的想法：

使用您的存储库实现，您喜欢让异常在存储库中引发并将异常处理留给调用者，还是您更喜欢在存储库中捕获异常、存储异常并返回 false/null？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-21T19:39:17.547

这取决于。

我会让异常冒泡吗？绝对地。但我想要这个用于连接失败、命令失败。无论你做什么，不要只是隐藏这些，你需要了解它们。我希望我的应用程序尽快失败，以减少副作用和进一步的损害。

我也记录异常。我使用 Log4net 来帮助解决这个问题。但我喜欢在源头记录异常。我会让他们从那里冒泡。

返回空？如果找不到某些东西（即通过 id 查找某些东西但它不存在），那么我返回 null，而不是异常。但是在某些情况下，当这种情况发生时，我会看到抛出一个新的异常。

要点：例外应该是“例外”，而不是规则。如果抛出异常，那应该是因为确实有问题，你需要修复它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-21T19:53:30.123

我通常会让异常泄漏，但如果我特别有企业精神，我会将它们包装在 RepositoryException 中，以防止客户关心底层存储引擎。

我永远不会返回 false/null 而不是异常，因为这些值背后已经有含义。

在极少数情况下，您可能有一个脑死亡的存储引擎，它会在非异常情况下生成异常——我会捕获那些特定的并在适当的时候返回 null（例如，如果一行不存在，但存储引擎抛出这种情况下的错误-我会抓住它并返回null）。

# perl - 我怎样才能阻止 WWW::Mechanize 跟随重定向？

> ID：894672
> 
> 赞同：11
> 
> 时间：2009-05-21T19:27:40.487
> 
> 标签：perl, redirect, mechanize

我有一个 Perl 脚本，它使用[WWW::Mechanize](http://search.cpan.org/dist/WWW-Mechanize)从文件中读取并在网站上执行一些自动化任务。但是，每次我请求某个页面后，该网站都会使用 302 重定向。我不想被重定向（它重定向到的页面需要很长时间才能响应）；我只想遍历文件并一遍又一遍地调用第一个链接。我不知道如何使 WWW::Mechanize 不遵循重定向。有什么建议么？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-05-21T19:49:38.633

[`WWW::Mechanize`](http://search.cpan.org/perldoc?WWW::Mechanize)是 的子类[`LWP::UserAgent`](http://search.cpan.org/perldoc?LWP::UserAgent)。所以你可以使用任何[`LWP::UserAgent`](http://search.cpan.org/perldoc?LWP::UserAgent)方法。

```
my $mech = WWW::Mechanize->new();
$mech->requests_redirectable([]); 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-05-21T19:52:30.217

WWW::Mechanize 是 LWP::UserAgent 的子类；您可以像使用 LWP::UserAgent 一样在构造函数中设置 max_redirect 或 requests_redirectable 选项。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-05-22T05:18:52.563

您可以使用 $agent->max_redirect( 0 );，就像在这个例子中一样：

```
#!/usr/bin/perl -w
use strict;

use WWW::Mechanize;

my $agent = WWW::Mechanize->new( 'autocheck' => 1, 'onerror' => undef, );
$agent->max_redirect( 0 );
$agent->get('http://www.depesz.com/test/redirect');
printf("Got HTTP/%s from %s.\n", $agent->response->code, $agent->uri);

$agent->max_redirect( 1 );
$agent->get('http://www.depesz.com/test/redirect');
printf("Got HTTP/%s from %s.\n", $agent->response->code, $agent->uri); 
```

运行时打印：

```
Got HTTP/302 from http://www.depesz.com/test/redirect.
Got HTTP/200 from http://www.depesz.com/. 
```

因此，使用 max_redirect(0) - 它显然不遵循重定向。

# wcf - 连接到 WCF 的匿名客户端

> ID：894674
> 
> 赞同：2
> 
> 时间：2009-05-21T19:27:58.787
> 
> 标签：wcf, nettcpbinding, transport

Microsoft 的这篇文章详细介绍了如何使用**匿名客户端**实现**传输安全性**。

 **[http://msdn.microsoft.com/en-us/library/ms729789.aspx](http://msdn.microsoft.com/en-us/library/ms729789.aspx)

我想知道是否可以使用*netTcpBinding*而不是*WsHttpBinding*并将服务托管为 Windows 服务来实现相同的目标。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-21T19:49:15.123

是的，我看不出有什么理由不能通过 netTcp Binding 工作。默认情况下，netTcp 已经在使用传输级安全性，而且还使用 Windows 凭据。只需将它们关闭，您就可以开始使用了。

```
 <bindings>
      <netTcpBinding>
        <binding name="SecureNetTcp">
          <security mode="Transport">
            <transport clientCredentialType="None" />
          </security>
        </binding>
      </netTcpBinding>
    </bindings> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-21T19:48:38.573

我从来没有做过，但你不能把客户端身份验证设置为无吗？

# vb.net - 复制文件后无法访问 mdb 数据库文件

> ID：894689
> 
> 赞同：1
> 
> 时间：2009-05-21T19:30:50.167
> 
> 标签：vb.net, ms-access

我有以下代码，我在其中制作了我使用的数据库的副本。代码执行 100%，但我遇到的问题是之后我无法访问我的数据库。我收到“无法启动您的应用程序。工作组信息文件丢失或被其他用户独占打开。” 因此，如果我重新启动应用程序，它就会再次正常工作。

我确定原因是因为我只能使用特定的帐户名和密码访问该数据库，这不是我登录的帐户。

我想尝试的是将该数据库 mdb 默认设置为没有用户访问它的点，或者将可以访问它的唯一帐户名重新分配给该数据库 mdb。

任何想法，将不胜感激？我试过玩文件安全，但没有运气。

```
 Private Sub cmdBackup_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles cmdBackup.Click
        BackupDialogDB.DefaultExt = ".mdb"
        BackupDialogDB.InitialDirectory = "c:\"
        'SaveFileDialog1.ShowDialog()

        If BackupDialogDB.ShowDialog() = Windows.Forms.DialogResult.OK Then

            Try

                Dim sDBFile As String = Application.StartupPath + "\VFMS_DB.mdb"

                Dim sBackUpFile As String = BackupDialogDB.FileName

                'First check the file u want to compact exists or not
                If File.Exists(sDBFile) Then
                    If Not File.Exists(sBackUpFile) Then
                        File.Copy(sDBFile, sBackUpFile)
                    Else
                        File.Delete(sBackUpFile)
                        File.Copy(sDBFile, sBackUpFile)
                    End If

                    MessageBox.Show("The database was successfully backedup to: " + sBackUpFile , "Database Backedup", MessageBoxButtons.OK, MessageBoxIcon.Information)

                    sDBFile = ""
                Else
                    MessageBox.Show("There is no database to backup. Please restore from a backup", "Database Backup Error", MessageBoxButtons.OK, MessageBoxIcon.Error)
                End If

            Catch ex As Exception
                MsgBox(ex.Message)
            End Try
        End If
    End Sub 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-21T19:58:37.757

您还应该复制和/或恢复[工作组信息文件](http://support.microsoft.com/kb/305542)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-21T19:57:53.623

你有目标目录的写权限吗？Access 需要在 .mdb 旁边创建一个 .ldb 文件。

否则，您可以在这里尝试一些东西： [http ://www.xlinesoft.com/asprunnerpro/docs/error_the_microsoft_jet_database_engine_cannot%20open%20the%20file%20(unknown).htm](http://www.xlinesoft.com/asprunnerpro/docs/error_the_microsoft_jet_database_engine_cannot%20open%20the%20file%20(unknown).htm)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-21T20:15:39.657

复制时数据库是否打开？Access 在数据库所在的同一目录中创建锁定文件 *.ldb，您可能希望在复制数据库之前检查该文件。

# xml - 如何通过股票代码获取有关公司财务、资产负债表、现金流等的数据

> ID：894695
> 
> 赞同：14
> 
> 时间：2009-05-21T19:32:40.460
> 
> 标签：xml, api, finance

是否有任何好的、免费（或便宜）的资源来获取有关公司财务信息的信息，我可以通过 API 或 XML 提要或除屏幕抓取之外的任何方式访问这些信息吗？具体来说，我正在寻找总资产、负债、收入等信息。

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2009-07-29T12:12:52.753

雅虎！Finance 有一个非常简单的 API，它以 CSV 格式返回结果。除了股票价格，它还可以返回股息收益率、EBITDA、年化收益等。这是一个例子：

```
http://finance.yahoo.com/d/quotes.csv?s=MSFT+AAPL+f=j4g3y 
```

[可以在这里](http://www.gummy-stuff.org/Yahoo-data.htm)找到关于它可以返回什么的非常好的解释

[编辑] 我只是尝试使用解释页面，但它已成为雅虎删除通知的主题。WayBack Machine 解决了这个问题：[http ://web.archive.org/web/20140503202125/http://www.gummy-stuff.org/Yahoo-data.htm](http://web.archive.org/web/20140503202125/http://www.gummy-stuff.org/Yahoo-data.htm)

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-07-24T20:21:52.157

你试过 wolframalpha.com 吗？例如，如果您输入 MSFT，它会提供有关 microsoft 的令人难以置信的信息。这是他们的 api 信息[http://www.wolframalpha.com/WolframAlphaAPI.pdf](http://www.wolframalpha.com/WolframAlphaAPI.pdf)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-29T18:58:59.910

[Xignite](http://www.xignite.com/product/XigniteEdgar/)有一个相当便宜的每月 50 美元左右的 api，它似乎真的很有用。

如果您要抓取网页，我建议您只需获取一个有用的库，例如 hpricot。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2009-05-21T20:03:25.377

我对此表示怀疑。对财务信息进行清理和清理是很困难的。每当我在 chartgame.com 上更新我的数据时，我通常需要一整天的时间来清理从网上刮下来的价格数据

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2009-05-21T20:34:25.360

可能不是免费的（至少对于完整的细节），但我可以接受纠正。 [路透社有某种形式的 API](http://thomsonreuters.com/products_services/financial/Reuters_Business_Intelligence)，可以提供有关企业的详细信息。如果库存详细信息足够，您可以从[Google Finance API](http://code.google.com/apis/finance/developers_guide_java.html#UsingData)免费获得这些信息，但据我所知，他们没有提供所有其他详细信息。

* * *

## 回答 #6

> 赞同：-2
> 
> 时间：2010-08-02T20:34:06.807

[在http://www.mergent.com/servius/](http://www.mergent.com/servius/)尝试 Mergent Company Fundamentals API - 许多非常详细的财务报表数据（资产负债表/损益表/现金流量表/比率），跨公司标准化，可追溯到 20 多年前

# javascript - 为什么 JavaScript RegExp.test() 方法表现为切换？

> ID：894696
> 
> 赞同：19
> 
> 时间：2009-05-21T19:32:41.053
> 
> 标签：javascript, regex

谁能解释为什么`alert()`下面的 JavaScript 代码会触发？它似乎是该方法中的一个错误，`RegExp.test()`每次运行该方法时都会反转其先前的决定。我正在使用 IE7。

我找到了一个看起来很可靠的替代品，`string.search(regex)`而是使用该方法。但是，我很好奇是否有人对此有所了解。

```
 var styleHasWidthRegex = /\bwidth\s*\:/ig;
  var styleText = "WIDTH: 350px";
  var result1 = styleHasWidthRegex.test(styleText);
  var result2 = !styleHasWidthRegex.test(styleText);
  if (result1 == result2) {
    alert("This should never happen!");
  } 
```

* * *

## 回答 #1

> 赞同：45
> 
> 时间：2009-05-21T19:36:17.457

您的正则表达式设置了全局 ( `g`) 标志。每次执行时，它都会更新一个内部索引（[lastIndex](https://developer.mozilla.org/En/Core_JavaScript_1.5_Reference/Global_Objects/RegExp/LastIndex)属性），指定它停止的位置，并在下一次从该点开始搜索。

当然，你并不是真的想要那样——你希望它每次都从头开始。所以放弃`g`国旗。

### 另请参阅：[不一致的 javascript 逻辑行为](https://stackoverflow.com/questions/209732/inconsistent-javascript-logic-behavior)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-21T19:37:40.980

在这种情况下，无论如何您都应该需要一个全局标签，因为在 css 声明中，一个属性应该只声明一次。

# ant - 在 Ant 脚本中展开相对路径，用于 Inkscape

> ID：894701
> 
> 赞同：3
> 
> 时间：2009-05-21T19:33:54.763
> 
> 标签：ant, build-automation, filenames, inkscape

我想编写一个调用需要完整路径的外部实用程序（实际上是 Inkscape）的 Ant 脚本。现在我有

```
<exec executable="${inkscape.path}">
    <arg value="--file=build_exe/splash.svg" />
    <arg value="--export-png=build_exe/splash.png" />
    <arg value="-C" />
</exec> 
```

在 Windows 上，[Inkscape 需要绝对路径](http://wiki.inkscape.org/wiki/index.php/FAQ#I.27m_on_Windows.2C_and_command_line_parameters_don.27t_seem_to_work.21)。那么如何才能哄Ant为`build_exe/filename`我打造一条绝对路径呢？或者，是否有 Inkscape 的解决方法（可能设置工作目录）？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-21T20:48:18.903

用这个：

```
<property name="x" location="folder/file.txt" /> 
```

该`${X}`值将是文件相对于该`${basedir}`值的绝对路径。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-21T19:54:52.817

我会宣布

```
<property file="my_config.properties"/> 
```

我会把这个路径写在文件 my_config.properties 中。您的用户只需要修改此配置文件。

# java - 安排在轮询情况下可能超时的 Callables 的最佳方法是什么？

> ID：894709
> 
> 赞同：0
> 
> 时间：2009-05-21T19:34:40.533
> 
> 标签：java, multithreading, polling

我有几个 Callables 查询一些 JMX Bean，所以每个都可能超时。我想轮询值让我们说每一秒。最天真的方法是在单独的线程中启动每个线程，但我想尽量减少线程数。我必须以更好的方式做哪些选择？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-23T06:48:53.467

我的解释是你有一堆 Callable 对象，需要在某个时间间隔进行轮询。如果你使用线程池，问题是池会被最慢的成员污染，而你更快的成员会被饿死。

听起来您可以控制调度，因此您可以考虑采用指数退避方法。也就是说，在 Callable X 运行（并且可能超时）之后，您在重新安排它之前等待 2 秒而不是 1 秒。如果仍然失败，请转到 4 秒，然后是 8 秒，等等。如果您使用[ScheduledThreadPoolExecutor](http://java.sun.com/j2se/1.5.0/docs/api/java/util/concurrent/ScheduledThreadPoolExecutor.html)，它有一个内置的方法来执行此操作，允许您在设定的延迟后安排执行。

如果您设置一个恒定的超时时间，此策略将降低您的池对慢速池垄断的敏感性。完全摆脱这个问题是非常困难的。每个查询对象使用一个单独的线程确实是确保您不会挨饿的唯一方法，正如您所说，这可能非常耗费资源。

另一种策略是将您的池分为快速池和慢池。如果一个对象超时（比如超过 N 次），你将它移到慢池中。这使您的快速池保持快速，虽然慢速池相互妨碍，但至少它们不会堵塞快速池。如果他们有一段时间的统计良好，您可以再次将他们提升到快速池。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-04T12:13:36.560

我同意 robbotic ... 实施“cachedThreadPool”将解决您的问题，因为它会将线程数限制在最佳水平，同时有超时，这将释放您未使用的资源

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-03T22:02:55.617

只要您收到一个`submit`-未来结果的句柄。您可以决定在给定的时间内等待其完成：`Callable``Future`

```
Future<String> future = executorService.submit(callable);
try {
  future.get(1, TimeUnit.SECONDS);
} catch ( TimeoutException e ) {
  future.cancel(true);
} catch ... 
```

使用超时调用 get 允许您在任务尚未完成时收到异常。这不区分未开始的任务和已开始但未完成的任务。另一方面，`cancel`将采用布尔参数`mayStopIfRunning`，因此您可以选择仅取消尚未安排的任务。

# java - 捕获更一般类型的异常是否很好？

> ID：894710
> 
> 赞同：5
> 
> 时间：2009-05-21T19:34:54.263
> 
> 标签：java, exception-handling

`IOException`事实上，如果我们要捕获 的特定形式或任何其他类型，我们只尝试捕获一对（并为它们定义明确的输出）说

`FileNotFoundException`
`ZipException`

我们是否应该始终跟踪它并覆盖所有基地

```
catch(IOException e){
    e.printStackTrace();
} 
```

然后可能走得更远，抓到`Exception e`，或者这完全是浪费时间？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-05-21T19:40:01.227

通常，您只想捕获和处理可以在低级别执行某些操作的异常。然后在更高的级别上，捕获系统范围内所有未处理的异常，以便记录发生的错误。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-21T19:41:32.813

通常，您应该只捕获要明确处理的异常。

您不应该捕获异常、IOException 等。al.，除非您是一个适当的高级别，您正在执行最后一次抓捕以向用户报告一般错误。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-05-21T19:50:11.860

如果有疑问，请**始终**捕获更具体的异常！

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-05-21T19:39:56.827

您捕获的异常层次结构越高，并且没有正确处理它们或重新抛出，您将越多的问题隐藏在地毯下。您可能会遇到难以跟踪的静默错误。

所以只捕获适当的异常，让其他异常通过。在顶层，如果你不想让你的程序崩溃，你可以有一个包罗万象，但至少记录它。这仍然是有问题的方法，因为您的应用程序可能处于不一致的状态，并且您可能会损坏您的数据。

但是要直接回答您的问题， IOException 可能处于适当的级别。让你知道无论是什么问题，它都与 IO 有关，你就可以根据它来行动。没有更多信息很难说。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-21T19:40:05.937

就像一个好的顾问一样，我说“这取决于”。

一般来说，在 Java 中，您清楚地了解代码中特定点的所有可能异常可能是什么。看到有人使用并不少见

```
} catch (Exception e){
   // log or stack trace
} 
```

...在或多或少的一次性代码中。不过，一般来说，您不应该捕获不知道如何有效处理的异常。（从不，从不*，*做`catch (Exception x) ;`，即，只是扔掉异常。从不。）

控制的事情是问“我能用这个做什么？” 通常，可以通过询问用户文件的去向来处理文件未发现异常。zip 文件异常更难处理。因此，您可能希望有单独的行为。

另一方面，如果它是一个命令行程序，在这两种情况下您可能只需要一条错误消息。

另一点建议；不要在“面向客户”的代码中输出堆栈跟踪——非程序员可能会看到的代码。非程序员倾向于查看堆栈跟踪和恐慌的完整性。最好将异常转换为“找不到文件'文件名'”这样的消息。并且，如果您真的想要堆栈跟踪，请使用日志记录将其发送到调试级别输出。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-05-21T19:45:01.887

盲目地捕捉任何类型的异常都不是一个好主意。是的，作为一个父异常，它似乎提供了一层“保护”，但这有几个原因是不好的：

检查 IOExceptions。如果代码中没有任何地方抛出它，那么添加不需要的捕获只会使事情变得模糊，并且可能会使以后查看代码的任何人感到困惑。

更重要的是，您不会为了让它们消失而捕获异常。如果他们这样做了，您可以将所有方法包装在 (catch(Exception e){..}) 中并完成它。您的异常捕获代码应该是您决定如果这些错误发生时该怎么做的地方，例如

```
catch(FileNotFoundException e)
{
 log.error("where's the file?");return null;
}
catch(ZipException e)
{
 log.error("corrupt");return null;
} 
```

关键是使该方法在所有可能的条件下都表现良好。调用者然后处理，例如，文件内容或没有内容，而不用担心内容是如何到达那里的。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-05-22T00:09:07.407

我认为这是个人喜好问题。就个人而言，这似乎不是一个好的选择。我更喜欢用 try-catch 的东西编写对我有意义的代码。这意味着尽可能具体。我会说：

```
try{
    //Code Here
}
catch(FileNotFoundException e){
    //Code Here
} 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-05-21T19:43:23.950

您不应该在可能发生 IOException 的每个可能位置捕获这些，而是​​在准备处理剩余 IOException 和一般异常的调用树中更进一步。

我们使用经验法则，您可以在可以处理错误的地方捕获特定异常并将剩余的异常传递给调用者。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-05-21T22:19:52.870

我会回显“捕获最具体的异常”。

我通常会捕获 IOException 并显示某种“读取文件错误”消息，然后允许用户选择另一个文件或任何合适的文件。如果文件真的很糟糕，用户可能对此无能为力，但至少你可以让他们知道文件很糟糕。

如果你得到一个 FileNotFoundException ，那么真正的问题几乎可以肯定是用户选择了错误的文件名或者硬编码的文件名不再有效。我经常为此显示消息。

我几乎从来没有捕捉到“异常”。你打算怎么办呢？您几乎无法从“出现问题但没有更多详细信息”中恢复过来。在某些情况下，我想您至少可以显示一条错误消息，而不仅仅是死亡，但仅此而已。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-05-21T23:57:26.010

这取决于更具体的异常是否有助于故障排除。有时，就像 JMX 一样，最好只捕获父异常以避免出现一长串可能的子异常。至少 Java 7 将允许我们在每次捕获时拥有一个以上的异常。这将清理代码相当多。

# php - PHP/MySQL：从数据库中选择靠近给定位置的位置

> ID：894713
> 
> 赞同：8
> 
> 时间：2009-05-21T19:36:03.760
> 
> 标签：php, mysql, geolocation, distance, geography

在 PHP 中，我有以下代码用于计算两个位置之间的距离：

```
<?php
function distance($lat1, $long1, $lat2, $long2) {
    // DEGREE TO RADIAN
    $latitude1 = $lat1/180*pi();
    $longitude1 = $long1/180*pi();
    $latitude2 = $lat2/180*pi();
    $longitude2 = $long2/180*pi();
    // FORMULA: e = ARCCOS ( SIN(Latitude1) * SIN(Latitude2) + COS(Latitude1) * COS(Latitude2) * COS(Longitude2-Longitude1) ) * EARTH_RADIUS
    $distance = acos(sin($latitude1)*sin($latitude2)+cos($latitude1)*cos($latitude2)*cos($longitude2-$longitude1))*6371;
    return $distance;
}
echo distance(9.9921962, 53.5534074, 9.1807688, 48.7771056); // Hamburg, DE - Stuttgart, DE
?> 
```

但是现在，我想通过 PHP 从我的 MySQL 数据库中选择靠近给定位置的位置：

*   用户进入家乡
*   我的脚本通过 Google API 获取纬度/经度值
*   在我的数据库中，我有大约 200 个位置，其中一个字段用于纬度值，一个字段用于经度值
*   我需要 PHP 和 MySQL 的代码来选择离用户家乡最近的 10 个位置

我希望你能帮助我。提前致谢！

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-05-24T00:53:34.413

[MySQL 大圆距离（Haversine 公式）](https://stackoverflow.com/questions/574691/mysql-great-circle-distance-haversine-formula)完全符合您的需要。

但是，只有 200 条记录，您不妨将它们全部加载并用代码检查它们。数据集真的太小了，不能过多地担心数据库与代码或任何其他此类优化。

[在 PHP 中计算邮政编码之间的距离](https://stackoverflow.com/questions/407989/calculating-distance-between-zip-codes-in-php)有几个该算法的 PHP 实现。

[地理邻近搜索](https://stackoverflow.com/questions/626024/geo-proximity-search)与您遇到的问题几乎完全相同。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-24T01:41:52.460

也许像

```
SELECT field1, field2, ...,
    ACOS(SIN(latitude / 180 * PI()) * SIN(:1) + COS(latitude / 180 * PI()) * COS(:2) * COS(:2 - longtidude)) * 6371 AS distance
    ORDER BY distance ASC; 
```

或者

```
SELECT field1, field2, ...,
    ACOS(SIN(RADIANS(latitude)) * SIN(:1) + COS(RADIANS(latitude)) * COS(:2) * COS(:2 - longtidude)) * 6371 AS distance
    ORDER BY distance ASC; 
```

（直接翻译自PHP代码）

`:1`和`:2`是`$lat2/180*pi()`和`$long2/180*pi()`分别。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-23T23:57:13.187

这就是哈弗辛公式。您可以将 PHP 直接转换为 SQL，以便在空间上查询数据库（另一种方法是将每条记录从数据库中拉出并通过 PHP 运行数据）。MySQL 提供了您需要的所有数学函数。

我是为一个提供基于邮政/邮政编码的距离查找的商业网站这样做的，因此如果没有特定的 GIS 功能，它肯定是可能的。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-21T19:41:12.987

有一些 MySQL 函数可用于执行此操作。

[http://dev.mysql.com/doc/refman/5.0/en/gis-introduction.html](http://dev.mysql.com/doc/refman/5.0/en/gis-introduction.html)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-21T19:41:47.573

MySQL 具有地理空间索引行的能力。你可能不需要自己做这个数学（你可以让 MySQL 计算两个地理对象之间的距离并按它排序......）。

见： http: [//forums.mysql.com/read.php?23,159205,159205](http://forums.mysql.com/read.php?23,159205,159205)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2018-06-14T13:08:15.373

刚刚跨过这个话题。也许有人会对这个功能感兴趣，在 MySql 5.7 中测试过：

```
 create function GetDistance(lat1 real, lng1 real, lat2 real, lng2 real) returns real no sql
    return ATAN2(SQRT(POW(COS(RADIANS(lat2)) * SIN(RADIANS(lng1 - lng2)), 2) + 
                POW(COS(RADIANS(lat1)) * SIN(RADIANS(lat2)) - SIN(RADIANS(lat1)) *
                COS(RADIANS(lat2)) *  COS(RADIANS(lng1 - lng2)), 2)), 
                (SIN(RADIANS(lat1)) * SIN(RADIANS(lat2)) + COS(RADIANS(lat1)) *
                COS(RADIANS(lat2)) * COS(RADIANS(lng1 - lng2)))) * 6372.795; 
```

来电：

```
select GetDistance(your_latitude, your_longitude, table_field_lat,
                   table_field_lng) as dist from [your_table] limit 5; 
```

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2009-05-23T23:48:23.500

为什么不使用 MySQL 的地理空间功能...？不只是在开玩笑。

如果 200 条记录是实际的地方，如城镇等，那么作为替代方案，您可以使用 GeoNames 的 API 吗？

以下 Web 服务将提供与所提供的 lat 和 lng 最接近的 10 个位置：

[http://ws.geonames.org/findNearby?lat=47.3&lng=9](http://ws.geonames.org/findNearby?lat=47.3&lng=9)

来源：[http ://www.geonames.org/export/web-services.html#findNearbyPlaceName](http://www.geonames.org/export/web-services.html#findNearbyPlaceName)

完整列表：[http ://www.geonames.org/export/ws-overview.html](http://www.geonames.org/export/ws-overview.html)

# visual-studio-2008 - Visual SourceSafe 2005 与 VS2008 集成 - 缺少签入提示以供评论

> ID：894719
> 
> 赞同：2
> 
> 时间：2009-05-21T19:36:49.237
> 
> 标签：visual-studio-2008, visual-sourcesafe, prompt, checkin

多年来，我一直在使用与 Source Safe 集成的 Visual Studio，当我从 VS2008 的解决方案资源管理器中签入文件时，当我之前被提示时，我没有被提示评论。现在要添加评论，我会转到待处理的签入视图并以这种方式添加评论。我的猜测在某些时候我一定是不小心改变了一些选项。但我似乎无法弄清楚在哪里。我查看了 SourceSafe Admin 选项、SourceSafe 用户工具选项和 VS2008 选项，但我错过了。这没什么大不了的，但我确实错过了提示。这种变化发生在大约一年前，我时不时地环顾四周，试图改变这种行为，但我从来没有找到合适的标志来改变。有任何想法吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-21T19:41:38.413

在 Visual Studio 中选择工具 -> 选项，从树中展开源代码管理，我认为该设置在其中。但是我只需要重建我的机器并且没有安装 VSS 客户端，所以我无法检查设置。

编辑：我现在已经重新安装了 VSS 客户端。在上面提到的选项下，如果您选择环境，则底部有一些文本...“如果对话框被隐藏使用不再显示，请单击重置以再次查看它们。”...按重置按钮。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-21T20:37:47.163

您必须首先设置 Visual SourceSafe 插件。

转到工具-> 选项。在树中选择 Source Control->Plug-in Selection。

选择 Visual SoruceSafe。现在你应该在树中有一个名为 Source Control->Environment 的新项目。

在该对话框中，您有几个复选框，它们告诉 VSS 应该如何提示或不提示。

# asp.net - 相当于服务器端的 ASP.NET 包括

> ID：894720
> 
> 赞同：35
> 
> 时间：2009-05-21T19:36:50.420
> 
> 标签：asp.net, include

虽然服务器端的经典 ASP 方法包括在 ASP.NET 中的工作，但我觉得它不是首选方法。我“应该”如何达到同样的效果？

这就是我目前的做法：
`<!-- #include file ="functionlib.aspx" -->`

* * *

## 回答 #1

> 赞同：40
> 
> 时间：2009-05-21T19:40:14.843

您现在有许多提供这种效果的选项，但方式不同。

*   用户控件 (.ascx)
*   母版页 (.master)
*   服务器端控件 (.dll)
*   类库 (.dll)
*   App_Code 类 (.cs/.vb)

每个都用于不同的目的以实现不同的目标。这取决于你真正想要做什么。鉴于您的包含文件的名称，我想您正在尝试包含将在您的页面上下文中使用的库函数。

因此，您将编写一个包含方法的类库并将它们导入您的应用程序/aspx。

如果您正在寻找一个页面模板，该页面将完成大部分布局工作以提供不同内容的主体，那么您将对母版页感兴趣。

如果您正在寻找可以在许多页面中使用的模板控件，那么您将关注用户控件。

如果您正在查看可供许多用户跨多个项目使用的模板控件，那么您将查看服务器端控件。

如果您正在查看类/方法库，那么您将开发一个类库或使用一个 app_code 类，该类可以在第一次调用时进行 JIT 编译。这*可能*被认为更像经典的 ASP，但实际上它的功能更像是作为一个单元的类库中的一个类。您可以在您的代码隐藏中或在您的 aspx/ascx 代码中的 <% %> 标记中调用它，而无需引用类库。

我们不再真正使用“包含”本身，但是您的工具包中的这些工具中的每一个都允许您为不同的场景提供类似的概念。作为开发人员，您将以不同的方式与网页的整个页面生命周期进行交互。ASP.NET 是与经典 ASP 截然不同的野兽。它确实需要不同的观点/方法，并且需要一些耐心来找出差异。

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2010-08-19T19:29:09.900

怎么样`<% Response.WriteFile("myFile.aspx"); %>`？

请参阅： https: [//support.microsoft.com/en-us/help/306575/how-to-dynamically-include-files-in-asp-net](https://support.microsoft.com/en-us/help/306575/how-to-dynamically-include-files-in-asp-net)

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2009-05-21T19:39:21.837

如果您使用的是 ASP.NET MVC，那么 Html.RenderPartial 就是您的朋友。

[http://msdn.microsoft.com/en-us/library/system.web.mvc.html.renderpartialextensions.renderpartial.aspx](http://msdn.microsoft.com/en-us/library/system.web.mvc.html.renderpartialextensions.renderpartial.aspx)

局部视图可以实现为 .ascx 或 .aspx 并将上述调用放在您的“主”页面中基本上表示“从该局部视图获取输出并在此处呈现”。

Parial 视图可以使用主视图从控制器接收到的 ViewData。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-21T19:39:26.080

听起来您需要查看的是[MasterPages](http://msdn.microsoft.com/en-us/library/wtxbf3hh.aspx)的整个概念。

除非您只关注导入函数和其他实用程序（而不是 html 内容）。如果是这种情况（并且您使用的是代码隐藏模型），您应该能够使用 .vb 页面顶部的导入命令包含适当的文件或命名空间（针对 C# 进行相应调整）。

# c++ - 是否可以以编程方式将项目添加到 Mac OS 的右键单击上下文菜单？

> ID：894723
> 
> 赞同：9
> 
> 时间：2009-05-21T19:37:23.523
> 
> 标签：c++, objective-c, macos, contextmenu

我有一个程序可以处理 Windows 和 Mac OS 上的各种文件。

我想为用户提供在其右键单击/控制单击上下文菜单中添加新选项的选项，以实现“使用 [应用程序名称] 压缩”的效果。

我知道这在 Windows 中通过修改注册表是很有可能的，但是有没有办法在 Mac 上实现这一点？也许使用 C++ 或目标 C？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-05-21T19:47:20.133

是的你可以。您需要制作一个上下文菜单插件。Apple在其开发者网站上有[上下文菜单插件示例代码。](http://developer.apple.com/samplecode/SampleCMPlugIn/index.html)

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-05-21T19:46:41.353

这是一个指南：[为 OS X 编写上下文菜单插件，第 1 部分](http://www.mactech.com/articles/mactech/Vol.18/18.08/MenuPlugins/index.html)

# php - 在 PHP 中清理表单数据

> ID：894724
> 
> 赞同：1
> 
> 时间：2009-05-21T19:37:24.443
> 
> 标签：php

是否可以通过简单地清理 PHP 中的一种方法发送的所有输入

```
$var = mysql_real_escape_string($_POST); 
```

然后像访问 $_POST 那样访问 $var 的元素？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-05-21T19:40:42.287

我认为您不能在数组上调用[mysql_real_escape_string 。](http://us3.php.net/mysql_real_escape_string)

但这会起作用

```
$cleanData = array_map('mysql_real_escape_string', $_POST); 
```

[array_map](http://us2.php.net/manual/en/function.array-map.php)通过在传递给它的数组的每个元素上调用引号中的函数来工作，并返回一个新数组作为结果。

像[superUntitled](https://stackoverflow.com/questions/894724/sanitizing-form-data-in-php/894746#894746)一样，我更喜欢使用适当的内置清理功能的自定义功能。但是您仍然可以使用带有 array_map 的自定义函数来实现相同的结果。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-21T19:40:43.893

作为旁注，我建议使用一个函数来清理您的结果：

```
function escape($txt) {
    if (get_magic_quotes_gpc())
        $txt = stripslashes($txt);

    if (!is_numeric($txt))
        $txt = "'" . mysql_real_escape_string($txt) . "'";

   return $txt;
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2011-10-10T16:18:42.890

此函数将从您传递给它的任何内容中删除 html 标签

```
function strip_html(&$a){
    if(is_array($a)){
        foreach($a as $k=>$v){
            $a[$k]=preg_replace('/<[^<]+?>/','',$v);
        }
    }else{
            $a=preg_replace('/<[^<]+?>/','',$a);
    }
    return;
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-21T19:51:08.007

我觉得很方便的是将请求数据（Post、Get、Cookie 等）封装到一个对象中，然后添加一个过滤方法，您可以将一组函数名称传递给该方法。这样你就可以像这样使用它：

```
$array = array('trim','mysql_real_escape_string');
$request->filter($array); 
```

该方法的主体使用循环一个 array_map ，就像 Mark 的示例中一样。我不会在我的整个 $_POST 上运行 mysql_real_escape_string，只在必要的字段（被查询或插入的字段）上运行

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2011-04-26T03:51:28.950

@阴影：

Array_Map 将适用于单维数组，但不适用于多维数组。所以，这会奏效。

`$cleanData = array_map('mysql_real_escape_string', $_POST);`

但如果 $_POST 数组有另一个数组，像这样： `$array = $_POST['myArray']['secondArray'];`

如果你有一个像上面这样的数组，当你尝试运行一个只接受一个字符串作为参数的函数时，数组映射会抛出一个错误，因为当它只需要一个字符串时它不会被处理到一个数组。

下页提供的解决方案更加方便，并且对数组中的每个元素递归执行。

[PHP - 清理数组的值](https://stackoverflow.com/questions/4861053/php-sanitize-values-of-a-array/4861080)

# wpf - WPF 上下文菜单

> ID：894727
> 
> 赞同：3
> 
> 时间：2009-05-21T19:37:52.197
> 
> 标签：wpf, mvvm, contextmenu

我在 wpf 应用程序中使用 mvvm。我在列表视图中有一个 ContextMenu，当我右键单击一个列表视图项时，我想要一个上下文菜单来显示联系人列表。

以下只是给我一个没有内容的上下文菜单。谁能告诉我我做错了什么？

```
<ListView Grid.Row="3"
            ItemsSource="{Binding Path=Phones}"
            SelectedItem="{Binding Phones.SelectedItem}"
            Height="100">
    <ListView.ItemContainerStyle>
        <Style TargetType="{x:Type ListViewItem}">
            <Setter Property="ContextMenu" Value="{StaticResource ContactMenu}"/>
        </Style>
    </ListView.ItemContainerStyle>
    <ListView.View>
        <GridView>
            <GridViewColumn Header="Phone" DisplayMemberBinding="{Binding Path=PhoneNumber, StringFormat=(000) 000-0000}"/>
            <GridViewColumn Header="Type" DisplayMemberBinding="{Binding Path=PhoneType.Type}"/>
            <GridViewColumn Header="Contacts" DisplayMemberBinding="{Binding Path=Contacts.Count}"/>
            <GridViewColumn Header="Notes" DisplayMemberBinding="{Binding Path= Notes.Count}"/>
            <GridViewColumn Header="Priority" DisplayMemberBinding="{Binding Path=Priority}"/>
        </GridView>
    </ListView.View>
</ListView>

<UserControl.Resources>
    <Style TargetType="{x:Type ListViewItem}">
        <Setter Property="Background" Value="{Binding SourceType, Converter={StaticResource SourceGroupConverter}}"/>
    </Style>
    <ContextMenu x:Key="ContactMenu" ItemsSource="{Binding Contacts}" >
        <ContextMenu.ItemTemplate>
            <DataTemplate>
                <MenuItem Header="{Binding Path=FirstName}"/>
            </DataTemplate>
    </ContextMenu>
</UserControl.Resources> 
```

更新：

我想通了，我有一个专门的集合导致绑定路径不正确。

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-21T20:14:24.870

上下文菜单不存在于页面的可视化树中，因此它不继承数据上下文。尝试直接在 ContextMenu 上设置 DataContext。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2010-03-15T16:59:31.320

我错过了何塞的答案，他也是如何规避这个问题的，但我自己能够弄清楚。

对我来说，将模型包装到带有访问器的视图模型类中很有帮助。

例如：

```
ObservableCollection<CtxItemViewModel> ctxItems = new ObservableCollection<CtxItemViewModel>();
CtxItem c = new CtxItem();
c.Name = "Hello World";
ctxItems.Add(new CtxItemViewModel(c)); 
```

在 ViewModel 内部：

```
public string Name {
   get { return _model.Name; }
   set { _model.Name = value; }
} 
```

添加访问器帮助我进行绑定。希望这对其他人也有帮助。

# c# - 如何限制文本框显示小数点后 2 位？

> ID：894732
> 
> 赞同：0
> 
> 时间：2009-05-21T19:39:14.037
> 
> 标签：c#

如何限制文本框显示小数点后 2 位？

123.22 - 真

1000000.123 - 假

0.002 - 假

3.32 - 真

12a.34 - 错误

提前致谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-21T19:44:43.527

您可以使用 NumericUpDown 控件并将 DecimalPlaces 属性设置为 2。这将允许用户输入两个以上的小数位，但是当他们退出时，它将向上或向下舍入他们的输入。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-21T19:44:24.947

你能解释一下吗。您想创建带有掩码的文本框或检查文本框中的现有值。如果要创建掩码，可以使用 MaskedTextBox 控件。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-21T19:46:29.107

假设您使用的是网络表单，您可以向 on Validate 事件添加正则表达式检查，以检查数据是否采用正确的格式，例如

```
^[0-9]*\.[0-9]{2}$ 
```

应该做的伎俩。

当然，您可以使用正则表达式验证器在 Web 表单上做类似的事情。

# maven-2 - 如何在 maven 的集成测试目标中运行单个测试

> ID：894737
> 
> 赞同：49
> 
> 时间：2009-05-21T19:39:27.437
> 
> 标签：maven-2, integration-testing, maven-surefire-plugin

我们在 Maven 中为我们的集成测试阶段生命周期定义了数百个测试，它们需要很长时间才能完成。

我想做的只是在`integration-test`. 我试着做：

```
mvn -Dtest=<my-test> integration-test 
```

但这不起作用。`-Dtest`仅运行单元测试目标中的测试，而不是集成测试阶段。我尝试了`-Dintegration-test=<my-test>`，但被忽略了。

有没有办法做到这一点 ？

* * *

我的配置是：

```
<plugin> 
    <groupId>org.apache.maven.plugins</groupId> 
    <artifactId>maven-surefire-plugin</artifactId> 
    <executions> 
        <execution> 
            <id>surefire-it</id> 
            <phase>integration-test</phase> 
            <goals> 
                <goal>test</goal> 
            </goals> 
            <configuration> 
                <excludes> 
                    <exclude>none</exclude> 
                </excludes> 
                <includes>
                    <include>**/api/**</include> 
                </includes> 
    ..... 
```

* * *

## 回答 #1

> 赞同：46
> 
> 时间：2011-04-20T07:54:07.590

如果您使用的是[Maven 故障安全插件](http://maven.apache.org/surefire/maven-failsafe-plugin/)`it.test`，您可以通过将属性设置为完全限定的测试类名称来运行单个集成测试：

```
mvn -D it.test=your.TestCase verify 
```

有关更多信息，请参阅[故障安全插件文档](http://maven.apache.org/surefire/maven-failsafe-plugin/examples/single-test.html)。

* * *

## 回答 #2

> 赞同：29
> 
> 时间：2011-07-26T20:21:54.803

[Failsafe 文档](http://maven.apache.org/plugins/maven-failsafe-plugin/examples/single-test.html)会让您像这样指定测试：

```
mvn -Dit.test=BrokenIT verify 
```

但是，*-Dit.test*似乎不再起作用。相反，用于指定 Surefire 测试的相同参数显然也适用于 Failsafe。例如：

```
mvn -Dtest=WorksIT verify 
```

我已经提交了一个[错误](http://jira.codehaus.org/browse/SUREFIRE-758)（**EDIT:**在 2.12 中被关闭为“无法复制”）以更正文档。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2014-09-04T10:37:27.577

只需`-DfailIfNoTests=false`使用 testNG 为我添加作品。像这样的东西：

```
mvn integration-test -Dtest=aITest -DfailIfNoTests=false 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2010-11-19T19:40:53.640

我为此苦苦挣扎，并创建了一个额外的配置文件，以便在我只想运行一个集成测试时使用。我希望我在这里成功提取了正确的部分：

```
 <profile>
        <id>integrationTestSingle</id>
        <build>
            <plugins>
                <plugin>
                    <artifactId>maven-surefire-plugin</artifactId>
                    <executions>
                        <execution>
                            <id>surefire-it</id>
                            <phase>integration-test</phase>
                            <goals>
                                <goal>test</goal>
                            </goals>
                            <configuration>
                                <includes>
                                    <include>**/integration/**/${test}.java</include>
                                </includes>
                                <skipTests>false</skipTests>
                            </configuration>
                        </execution>
                    </executions>
                    <configuration>
                        <argLine>-Xms256M -Xmx768M -XX:MaxPermSize=256M</argLine>
                    </configuration>
                </plugin>

                <plugin>
                    <artifactId>maven-surefire-plugin</artifactId>
                    <executions>
                        <execution>
                            <id>default-test</id>                                
                            <configuration>
                                <skipTests>true</skipTests>
                            </configuration>
                        </execution>
                    </executions>

                </plugin>
            </plugins>
        </build>
    </profile> 
```

现在，我使用 integrationTestSingle 配置文件和 with 调用 maven `-DfailIfNoTests=false -Dtest=NameOfTest`，它在常规“测试”阶段不运行任何常规测试，而`NameOfTest`在集成测试阶段只运行测试。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-05-24T05:47:41.120

我不确定 JUnit，但对于 TestNG，策略是定义一个只有一个测试的套件 XML 文件，然后在你的 POM 中配置 surefire 插件以仅运行它。在你的 POM 中，你会有这样的东西（免责声明，这是未经测试的）：

```
 <plugin>
    <artifactId>maven-surefire-plugin</artifactId>
    <executions>
      <execution>
        <phase>integration-test</phase>
        <configuration>
          <suiteXmlFiles>
            <suiteXmlFile>single-test.xml</suiteXmlFile>
          </suiteXmlFiles>
        </configuration>
        <goals>
          <goal>run</goal>
        </goals>
      </execution>
    </executions>
  </plugin> 
```

要配置套件文件，请参阅[http://testng.org/doc/documentation-main.html](http://testng.org/doc/documentation-main.html)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-03-30T00:48:33.957

我自己也遇到了这个。像这样的东西对我很有效：

```
mvn -Pintegration-test -Dtest=<my-test> 
```

诀窍是确保在 -Dtest 部分之前提到了测试组。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2021-09-27T11:02:15.143

我正在使用：Apache Maven 3.6.3

```
openjdk version "11.0.2" 2019-01-15

<groupId>org.codehaus.mojo</groupId>
<artifactId>failsafe-maven-plugin</artifactId>
<version>2.4.3-alpha-1</version> 
```

这个命令对我有用：

```
mvn failsafe:integration-test  -Dsurefire.skip=true -DskipIntegrationTests=false -DskipTests=false -Dtest=com.myxyz.func.ITestGate 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2021-11-01T14:27:42.357

这对我有用，当我在集成测试中只运行一种测试方法时

```
 mvn clean -Dit.test=some.package.SomeTestClass#testMethodName integration-test 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2021-10-16T07:06:16.727

通过回到实际文档的基础知识，实际上比上面的答案更简单。

运行 Junit 5 集成测试：

```
openjdk version "11.0.11" 2021-04-20
Apache Maven 3.6.3 
```

在主构建中，只需放入记录的故障安全配置：

```
 <build>
    <plugins>
      <plugin>
        <groupId>org.apache.maven.plugins</groupId>
        <artifactId>maven-failsafe-plugin</artifactId>
        <version>3.0.0-M5</version>
        <executions>
          <execution>
            <goals>
              <goal>integration-test</goal>
              <goal>verify</goal>
            </goals>
          </execution>
        </executions>
      </plugin>
    </plugins>
  </build> 
```

然后你可以只运行一个特定的集成测试：

```
mvn -Dtest=\*cs1_\* verify 
```

请注意，此版本将在`target`文件夹中运行您的测试，如果您需要加载任何类似的外部文件，`src\test\resources\x.y`则将它们复制到`target\test-classes\x.y`

# windows - 我可以使用 EmacsW32 为不同的框架显示不同的图标吗？

> ID：894770
> 
> 赞同：2
> 
> 时间：2009-05-21T19:48:48.230
> 
> 标签：windows, configuration, emacs

我创建了两个 EmacsW32 框架，一个用于我的每个显示器。当两个框架都被隐藏时，我希望能够在左框架或右框架上使用 alt-tab，但我无法将它们区分开来，因为 alt-tab 窗口中的图标顺序会发生变化。

有什么方法可以在 Windows XP 上更改 EmacsW32 中特定框架的图标吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-22T04:27:39.373

我从一个免费软件网页下载了几个 .ico 文件（只需[google](http://www.google.com/search?q=icon+ico+free)即可）并尝试使用它，这很有效。以前我尝试过 .bmp - 因为[框架参数](http://www.gnu.org/software/emacs/elisp/html_node/Management-Parameters.html)的文档没有指定文件类型。看起来对于 Windows，您必须使用[.ico 格式](http://en.wikipedia.org/wiki/ICO_(icon_image_file_format))。我的两个 emacs 框架现在看起来像[冲浪板](http://www.iconarchive.com/download/icon/iconshock/beach/surf.ico)和[沙滩椅](http://www.iconarchive.com/download/icon/iconshock/beach/beach-sit.ico)。

```
(set-frame-parameter (car (frame-list)) 'icon-type  "c:/path/to/bitmap/surf.ico") 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-21T20:25:51.257

到目前为止，我已经找到了“ [set-frame-name](http://www.gnu.org/software/emacs/manual/html_node/emacs/Non_002dWindow-Terminals.html) ”并发现 select-frame-by-name 确实有效。我将左框架命名为“左”，右框架命名为“右”。所以当我点击 alt-tab 时，我确实看到了框架的名称。

但这仍然不是我想要的。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-22T06:25:45.300

我正在使用 NTEmacs，因此这个技巧适用于所有 emacs。只需根据缓冲区名称设置帧标题以区分它们。这将反映在 Alt-Tab 中。如果打开的缓冲区同名，这可能不起作用。

将以下内容放入您的 .emacs

```
;; format the title-bar to always include the buffer name
(setq frame-title-format "emacs - %b")
(setq icon-title-format "emacs - %b") 
```

# asp.net-mvc - ASP.NET MVC 通过方法属性路由

> ID：894779
> 
> 赞同：80
> 
> 时间：2009-05-21T19:50:01.020
> 
> 标签：asp.net-mvc, routing, url-routing, decorator

在[StackOverflow 播客 #54](https://blog.stackoverflow.com/2009/05/podcast-54/)中，Jeff 提到他们通过处理路由的方法上方的属性在 StackOverflow 代码库中注册他们的 URL 路由。听起来是个不错的概念（Phil Haack 提出了关于路线优先级的警告）。

有人可以提供一些样本来实现这一点吗？

此外，使用这种路由风格的任何“最佳实践”？

* * *

## 回答 #1

> 赞同：62
> 
> 时间：2009-05-21T21:10:05.380

***更新***：这已发布在[codeplex](http://itcloud.codeplex.com)上。完整的源代码以及预编译的程序集可供下载。我还没有时间在网站上发布文档，所以这个 SO 帖子现在就足够了。

***更新****：我添加了一些新属性来处理 1) 路由排序、2) 路由参数约束和 3) 路由参数默认值。下面的文字反映了这一更新。*

我实际上已经为我的 MVC 项目做了类似的事情（我不知道 Jeff 是如何使用 stackoverflow 做的）。我定义了一组自定义属性：UrlRoute、UrlRouteParameterConstraint、UrlRouteParameterDefault。它们可以附加到 MVC 控制器操作方法以使路由、约束和默认值自动绑定到它们。

**示例用法：**

（请注意，此示例有些做作，但它演示了该功能）

```
public class UsersController : Controller
{
    // Simple path.
    // Note you can have multiple UrlRoute attributes affixed to same method.
    [UrlRoute(Path = "users")]
    public ActionResult Index()
    {
        return View();
    }

    // Path with parameter plus constraint on parameter.
    // You can have multiple constraints.
    [UrlRoute(Path = "users/{userId}")]
    [UrlRouteParameterConstraint(Name = "userId", Regex = @"\d+")]
    public ActionResult UserProfile(int userId)
    {
        // ...code omitted

        return View();
    }

    // Path with Order specified, to ensure it is added before the previous
    // route.  Without this, the "users/admin" URL may match the previous
    // route before this route is even evaluated.
    [UrlRoute(Path = "users/admin", Order = -10)]
    public ActionResult AdminProfile()
    {
        // ...code omitted

        return View();
    }

    // Path with multiple parameters and default value for the last
    // parameter if its not specified.
    [UrlRoute(Path = "users/{userId}/posts/{dateRange}")]
    [UrlRouteParameterConstraint(Name = "userId", Regex = @"\d+")]
    [UrlRouteParameterDefault(Name = "dateRange", Value = "all")]
    public ActionResult UserPostsByTag(int userId, string dateRange)
    {
        // ...code omitted

        return View();
    } 
```

**UrlRouteAttribute 的定义：**

```
/// <summary>
/// Assigns a URL route to an MVC Controller class method.
/// </summary>
[AttributeUsage(AttributeTargets.Method, Inherited = true, AllowMultiple = true)]
public class UrlRouteAttribute : Attribute
{
    /// <summary>
    /// Optional name of the route.  If not specified, the route name will
    /// be set to [controller name].[action name].
    /// </summary>
    public string Name { get; set; }

    /// <summary>
    /// Path of the URL route.  This is relative to the root of the web site.
    /// Do not append a "/" prefix.  Specify empty string for the root page.
    /// </summary>
    public string Path { get; set; }

    /// <summary>
    /// Optional order in which to add the route (default is 0).  Routes
    /// with lower order values will be added before those with higher.
    /// Routes that have the same order value will be added in undefined
    /// order with respect to each other.
    /// </summary>
    public int Order { get; set; }
} 
```

**UrlRouteParameterConstraintAttribute 的定义：**

```
/// <summary>
/// Assigns a constraint to a route parameter in a UrlRouteAttribute.
/// </summary>
[AttributeUsage(AttributeTargets.Method, Inherited = true, AllowMultiple = true)]
public class UrlRouteParameterConstraintAttribute : Attribute
{
    /// <summary>
    /// Name of the route parameter on which to apply the constraint.
    /// </summary>
    public string Name { get; set; }

    /// <summary>
    /// Regular expression constraint to test on the route parameter value
    /// in the URL.
    /// </summary>
    public string Regex { get; set; }
} 
```

**UrlRouteParameterDefaultAttribute 的定义：**

```
/// <summary>
/// Assigns a default value to a route parameter in a UrlRouteAttribute
/// if not specified in the URL.
/// </summary>
[AttributeUsage(AttributeTargets.Method, Inherited = true, AllowMultiple = true)]
public class UrlRouteParameterDefaultAttribute : Attribute
{
    /// <summary>
    /// Name of the route parameter for which to supply the default value.
    /// </summary>
    public string Name { get; set; }

    /// <summary>
    /// Default value to set on the route parameter if not specified in the URL.
    /// </summary>
    public object Value { get; set; }
} 
```

**对 Global.asax.cs 的更改：**

将 MapRoute 调用替换为对 RouteUtility.RegisterUrlRoutesFromAttributes 函数的一次调用：

```
 public static void RegisterRoutes(RouteCollection routes)
    {
        routes.IgnoreRoute("{resource}.axd/{*pathInfo}");

        RouteUtility.RegisterUrlRoutesFromAttributes(routes);
    } 
```

**RouteUtility.RegisterUrlRoutesFromAttributes 的定义：**

完整的源代码在[codeplex](http://itcloud.codeplex.com)上。如果您有任何反馈或错误报告，请访问该站点。

* * *

## 回答 #2

> 赞同：44
> 
> 时间：2011-01-17T19:12:28.360

您还可以尝试[AttributeRouting](https://github.com/mccalltd/AttributeRouting)，它可以从[github](https://github.com/mccalltd/AttributeRouting)或通过[nuget 获得](http://nuget.org/List/Packages/AttributeRouting)。

这是一个无耻的插件，因为我是项目作者。但是，如果我不是很高兴使用它的话。你可能也是。[github 存储库wiki](https://github.com/mccalltd/AttributeRouting/wiki)中有大量文档和示例代码。

有了这个库，你可以做很多事情：

*   使用 GET、POST、PUT 和 DELETE 属性装饰您的操作。
*   将多个路由映射到单个操作，并使用 Order 属性对它们进行排序。
*   使用属性指定路由默认值和约束。
*   使用简单的 ? 指定可选参数 参数名称前的标记。
*   指定路由名称以支持命名路由。
*   在控制器或基本控制器上定义 MVC 区域。
*   使用应用于控制器或基本控制器的路由前缀将您的路由分组或嵌套在一起。
*   支持旧版网址。
*   在为动作定义的路由、控制器内以及控制器和基本控制器之间设置路由的优先级。
*   自动生成小写的出站 URL。
*   定义您自己的自定义路由约定并将它们应用到控制器上，以便为控制器内的操作生成路由，而无需样板属性（想想 RESTful 风格）。
*   使用提供的 HttpHandler 调试您的路由。

我敢肯定还有一些我忘记的东西。看看这个。通过nuget安装很轻松。

**注意：截至 2012 年 4 月 16 日，AttributeRouting 还支持新的 Web API 基础架构。**以防万一您正在寻找可以处理的东西。[谢谢subkamran](https://stackoverflow.com/users/109458/subkamran)！

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2010-02-03T21:06:00.710

**1\. 下载[RiaLibrary.Web.dll](http://maproutes.codeplex.com/)并在你的 ASP.NET MVC 网站项目中引用它**

**2\. 使用 [Url] 属性装饰控制器方法：**

```
public SiteController : Controller
{
    [Url("")]
    public ActionResult Home()
    {
        return View();
    }

    [Url("about")]
    public ActionResult AboutUs()
    {
        return View();
    }

    [Url("store/{?category}")]
    public ActionResult Products(string category = null)
    {
        return View();
    }
} 
```

顺便提一句， '？' 登录 '{?category}' 参数意味着它是可选的。您不需要在路由默认值中明确指定它，这等于：

```
routes.MapRoute("Store", "store/{category}",
new { controller = "Store", action = "Home", category = UrlParameter.Optional }); 
```

**3\. 更新 Global.asax.cs 文件**

```
public class MvcApplication : System.Web.HttpApplication
{
    public static void RegisterRoutes(RouteCollection routes)
    {
        routes.IgnoreRoute("{resource}.axd/{*pathInfo}");

        routes.MapRoutes(); // This does the trick
    }

    protected void Application_Start()
    {
        RegisterRoutes(RouteTable.Routes);
    }
} 
```

**如何设置默认值和约束？例子：**

```
public SiteController : Controller
{
    [Url("admin/articles/edit/{id}", Constraints = @"id=\d+")]
    public ActionResult ArticlesEdit(int id)
    {
        return View();
    }

    [Url("articles/{category}/{date}_{title}", Constraints =
         "date=(19|20)\d\d-(0[1-9]|1[012])-(0[1-9]|[12][0-9]|3[01])")]
    public ActionResult Article(string category, DateTime date, string title)
    {
        return View();
    }
} 
```

**如何设置排序？例子：**

```
[Url("forums/{?category}", Order = 2)]
public ActionResult Threads(string category)
{
    return View();
}

[Url("forums/new", Order = 1)]
public ActionResult NewThread()
{
    return View();
} 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-05-25T15:50:59.613

这篇文章只是为了扩展 DSO 的答案。

在将路由转换为属性时，我需要处理 ActionName 属性。所以在 GetRouteParamsFromAttribute 中：

```
ActionNameAttribute anAttr = methodInfo.GetCustomAttributes(typeof(ActionNameAttribute), false)
    .Cast<ActionNameAttribute>()
    .SingleOrDefault();

// Add to list of routes.
routeParams.Add(new MapRouteParams()
{
    RouteName = routeAttrib.Name,
    Path = routeAttrib.Path,
    ControllerName = controllerName,
    ActionName = (anAttr != null ? anAttr.Name : methodInfo.Name),
    Order = routeAttrib.Order,
    Constraints = GetConstraints(methodInfo),
    Defaults = GetDefaults(methodInfo),
}); 
```

我还发现路线的命名不合适。该名称是使用 controllerName.RouteName 动态构建的。但是我的路由名称是控制器类中的 const 字符串，我使用这些 const 来调用 Url.RouteUrl。这就是为什么我真的需要属性中的路由名称作为路由的实际名称。

我要做的另一件事是将默认和约束属性转换为 AttributeTargets.Parameter 以便我可以将它们粘贴到 params。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2010-04-29T15:41:42.427

我已经将这两种方法组合成一个科学怪人版本，供任何想要它的人使用。（我喜欢可选的参数符号，但也认为它们应该是与默认/约束分开的属性，而不是全部混合在一起）。

[http://github.com/djMax/AlienForce/tree/master/Utilities/Web/](http://github.com/djMax/AlienForce/tree/master/Utilities/Web/)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2010-07-22T14:28:16.670

我需要使用 AsyncController 让 ITCloud 路由在 asp.net mvc 2 中工作——为此，只需在源代码中编辑 RouteUtility.cs 类并重新编译。您必须从第 98 行的操作名称中删除“已完成”

```
// Add to list of routes.
routeParams.Add(new MapRouteParams()
{
    RouteName = String.IsNullOrEmpty(routeAttrib.Name) ? null : routeAttrib.Name,
    Path = routeAttrib.Path,
    ControllerName = controllerName,
    ActionName = methodInfo.Name.Replace("Completed", ""),
    Order = routeAttrib.Order,
    Constraints = GetConstraints(methodInfo),
    Defaults = GetDefaults(methodInfo),
    ControllerNamespace = controllerClass.Namespace,
}); 
```

然后，在 AsyncController 中，用熟悉的`UrlRoute`和`UrlRouteParameterDefault`属性装饰 XXXXCompleted ActionResult：

```
[UrlRoute(Path = "ActionName/{title}")]
[UrlRouteParameterDefault(Name = "title", Value = "latest-post")]
public ActionResult ActionNameCompleted(string title)
{
    ...
} 
```

希望对遇到同样问题的人有所帮助。

# sql-server - OrderHeader.*,COUNT(OrderDetail) 来自子查询

> ID：894793
> 
> 赞同：0
> 
> 时间：2009-05-21T19:52:38.440
> 
> 标签：sql-server, subquery

关于获取 OrderID 和关联行项目的数量的较早问题已得到解答。现在我想获取 OrderHeader 行中的其余字段。

```
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'dbo.OrderDetail') AND type in (N'U'))
DROP TABLE OrderDetail
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'dbo.OrderHeader') AND type in (N'U'))
DROP Table OrderHeader
GO
    CREATE TABLE OrderHeader(
    OrderHeaderID Int Primary Key Identity(10,1),
    CustID Int,
    OrderDate DateTime default getdate(),
    OrderTypeID Int default 0, -- References OrderType
    OrderGroupID Int Default 0, -- References OrderGroup
    OrderCatID Int Default 0 -- References OrderCat
    )
    GO
    CREATE TABLE OrderDetail(
    OrderDetailID Int Primary Key Identity(100,1),
    OrderHeaderID Int REFERENCES OrderHeader,
    ItemID Int)
    GO
    DECLARE @OrderHeaderID Int
    INSERT INTO OrderHeader(CustID) VALUES(1000)
    INSERT INTO OrderHeader(CustID) VALUES(1001)
    SET @OrderHeaderID=SCOPE_IDENTITY()
    INSERT INTO OrderDetail(OrderHeaderID,ItemID) VALUES(@OrderHeaderID,3)
    INSERT INTO OrderDetail(OrderHeaderID,ItemID) VALUES(@OrderHeaderID,4)
    GO
    -- This query gives me the number of line items per order
    SELECT OH.OrderHeaderID,COUNT(OD.OrderHeaderID) AS CountOfOrderDetail
    FROM OrderHeader OH
    LEFT JOIN OrderDetail OD 
    ON OD.OrderHeaderID = OH.OrderHeaderID
    GROUP BY OH.OrderHeaderID
    /*
    This is where I need help
    I would like a query to show
    SELECT OrderHeader.*,CountOfOrderDetail
    */ 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-21T19:56:24.767

```
SELECT
    OrderHeader.*, 
    OrderDetailCount.CountOfOrderDetail
FROM OrderHeader
JOIN (
    SELECT 
       OH.OrderHeaderId,
       COUNT(OD.OrderHeaderID) AS CountOfOrderDetail    
    FROM OrderHeader OH    
    LEFT JOIN OrderDetail OD ON 
       OD.OrderHeaderID = OH.OrderHeaderID    
    GROUP BY OH.OrderHeaderID
) as OrderDetailCount ON
    OrderHeader.OrderHeaderId = OrderDetailCount.OrderHeaderId 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-21T19:57:11.627

怎么样：

```
select oh.*, (
    select count(*) 
    from OrderDetail 
    where OrderHeaderID = oh.OrderHeaderID) as CountOfOrderDetail
from OrderHeader oh 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-21T20:03:25.110

```
SELECT h.OrderHeaderID,
        h.CustID,
        h.OrderDate,
        h.OrderTypeID,
        h.OrderGroupID,
        h.OrderCatID,
        COUNT(*) 
FROM OrderHeader h 
JOIN OrderDetail d ON h.OrderHeaderId = d.OrderHeaderId 
GROUP BY h.OrderHeaderID,
        h.CustID,
        h.OrderDate,
        h.OrderTypeID,
        h.OrderGroupID,
        h.OrderCatID 
```

# licensing - 什么现成的许可系统可以满足我的需求？

> ID：894794
> 
> 赞同：1
> 
> 时间：2009-05-21T19:53:12.870
> 
> 标签：licensing

我正在编写一个易于嵌入的开源软件（静态/动态库和它们之上的可执行文件）。哪个软件许可证将：

1.  允许用户通过嵌入源代码来使用源代码，或者在任何许可下（包括封闭和开源）在他自己的程序中动态或静态地链接它？
2.  确保对**我创建的文件**所做的任何修改都在同一许可证下发布？
3.  无论他如何使用我的代码，我在他的软件中都获得了信任？
4.  他不会在他的程序中滥用我的软件名称吗？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-09-12T02:46:52.197

Wikipedia 有一篇出色的[比较文章](http://en.wikipedia.org/wiki/Comparison_of_free_software_licenses)，其中涵盖了各种软件许可证，您应该仔细查看它，以及将其缩小到几个许可证后的实际许可证文本。

The [LGPL](http://en.wikipedia.org/wiki/GNU_Lesser_General_Public_License) will fufil clauses 1, 2, and 3 of your request. Clause 4 isn't something that should ideally be covered by a license, but rather by a trademark with an accompanying trademark policy. (registered or un-) See for example [Mozilla's Trademark Policy](http://www.mozilla.org/foundation/trademarks/policy.html).

Of course, IANAL, IANYL, YMMV, and OIMACTTA.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-21T19:54:34.427

你不妨看看这个对比图：

*   [http://developer.kde.org/documentation/licensing/licenses_summary.html](http://developer.kde.org/documentation/licensing/licenses_summary.html)

更小但更简单：

*   [http://khason.net/blog/open-source-licenses-comparison-table/](http://khason.net/blog/open-source-licenses-comparison-table/)

*（我不是律师……）*

您想要的是可能与 GNU/GPL 许可证兼容的东西。特别是，Artistic 2.0 许可证看起来像是一个很好的候选者，因为它看起来好像符合作者身份要求。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-27T12:04:29.793

许可证兼容性将是最重要的标准。您可能不喜欢商业许可证（没有标准）或 GPL 或您拥有的所有条款，但由于它们都非常常见，您将需要选择与它们兼容的许可证。CDDL 是一个漂亮的许可证，它不像普通许可证那样兼容。

在 GPL 世界中，LGPL 比 GPL 更兼容其他代码。在商业世界中，各种“如果出错就不要起诉我”的许可证是最兼容的，例如 MIT 等。

多许可证是最好的，尽管有些混乱。如果有人正在编写商业代码库，有时出于法律或公司政策的原因，他们不能在没有获得您的商业许可的情况下使用您的代码。MySQL 是在 2 个许可证下提供的代码库示例。

有人应该将“我不是律师”的样板替换为“我不是律师，律师是混蛋”。

# excel - 如何使用 VBA 自动化多个 Office 应用程序？

> ID：894799
> 
> 赞同：3
> 
> 时间：2009-05-21T19:54:06.283
> 
> 标签：excel, ms-access, ms-access-2007, vba

虽然我已经在一个应用程序中为 MS Access 2007 和 Excel 2007 完成了 VBA 项目，但我没有同时自动化多个应用程序。通用项目是开放访问，运行一些更新查询，将数据附加到各种表中。然后 Excel 需要获取数据。Excel 中需要进行一些格式更改，例如不会自动更改日期范围的分组。最后，我计划构建它，以便自动通过电子邮件发送 excel 文件。

其中一些部分很清楚如何完成它，例如 Excel 将通过 ODBC 从 Access 获取数据。但是主 VBA 应该放在哪里呢？我可以在 Access 中有一个开始运行 Access VBA 的按钮，但是让 Access VBA 开始操作 Excel 是一种好习惯吗？这是否使调试变得困难？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-21T20:42:32.737

若要从 Access 开始，请添加对 Excel 对象库的引用。然后使用对象浏览器熟悉 Excel 对象层次结构在 Access 中的外观。这会有些不同，因为 Excel 代码中的顶级对象是隐式的（就像在 Access 中一样），并且在 Access 中编码时必须显式引用。

Access 开发人员手册中有关于从 Access 自动化 Office 其余部分的优秀章节。

最后，最好在使用对其他应用程序的自动化库的引用进行编码以帮助您编程后，您希望切换到后期绑定，以便您可以删除引用。这意味着不使用任何外部库的特定数据类型（您主要使用普通对象变量）并且不使用外部库中定义的任何常量。我的后期绑定生产代码通常包括注释掉的早期绑定版本，以及后期绑定版本。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-21T20:19:17.870

我认为您正在寻找的关键字是“微软办公自动化”。

使用您喜欢的支持 COM 接口的编程语言制作应用程序，然后使用自动化在不同的办公应用程序中进行操作。

看这里[c#如何访问excel单元格？](https://stackoverflow.com/questions/10412/creating-a-word-doc-in-c-net)在这里[如何使用 c# 读取 excel 文件的数据？](https://stackoverflow.com/questions/657131/how-to-read-data-of-an-excel-file-using-c)和谷歌。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-21T20:50:07.137

我最近做了一些与此非常相似的事情，并且发现我可以输出带有内置 CSS 的 HTML，以便很好地加载到 Excel 中。我使用 Access 允许用户构建他们需要的输出，只打开 Excel 来显示结果。您可能会发现 HTML 输出可以生成更好的电子邮件。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-22T02:41:36.383

在 Access VBA 中完成所有工作。有关一些示例代码，请参见以下 URL

[模块：示例 Excel 自动化](http://www.mvps.org/access/modules/mdl0006.htm)

[模块：使用自动化将记录传输到 Excel](http://www.mvps.org/access/modules/mdl0035.htm)

另请注意，如果您正在处理多个版本的 Excel，则后期绑定成为必要。后期绑定意味着您可以安全地删除引用，并且只有在应用程序执行有问题的代码行时才会出现错误。而不是在启动应用程序时出错并且根本不允许用户进入应用程序。或者在点击中间、左侧或修剪函数调用时。

当您不知道外部应用程序的版本将驻留在目标系统上时，这也非常有用。或者，如果您的组织正在从一个版本迁移到另一个版本。

有关更多信息，包括附加文本和一些详细链接，请参阅Microsoft Access页面[中的后期绑定。](http://www.granite.ab.ca/access/latebinding.htm)

[就电子邮件而言， Microsoft Access 电子邮件常见问题解答](http://www.granite.ab.ca/access/email.htm)中有许多选项

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-12-06T11:30:42.740

您可以将代码放在 Access 或 Excel 中。以我的经验，这比在两者之间拆分代码（这也有效）更容易使用。

如果您发现自动化代码运行速度太慢，您可以拆分代码，使 Access 由 Access 中的函数运行，Excel 由 Excel 中的函数运行，主代码仅在两者中运行例程。在这种情况下，您可以将主代码放在任何您获得用于启动事物的最佳用户界面的地方。我使用过 C、Access、Word 和 Excel，如果所有代码都在其他地方，那么将开始按钮放在哪里并不重要。

如果您的用户或维护人员更熟悉某个应用程序，您可能希望将您的主代码或主代码放在那里，但更多时候我发现将主代码或主代码与应用程序的胆量放在一起更好，这样我就可以在其他合作伙伴中根本没有代码。

从简短的描述来看，听起来更多的工作将在 Excel 中完成，所以我会将所有代码都放在那里。

从 Access 中提取数据甚至不需要 Access Application 对象——DAO、ADO 或 ODBC 对象都可以工作（甚至是 DDE），这将比同时拥有这两个应用程序更快、更健壮、更容易、更好开放和自动化一个从另一个。

如果您从 Access 开始，听起来这个项目需要一个 Excel 自动化对象。现在效果很好，但仅使用 Excel 和 DAO 对象仍然慢得多，而且更脆弱。

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2009-05-21T20:11:58.103

尽管 Access 是我进入编程世界的切入点，但我已经很久没有做过 VBA 了。从 Access 97 迁移到 Visual Basic 很容易，我记得我使用 Access 编写了很多东西，更像是 VB 表单来执行多种任务（不一定是数据库东西）。

这就是为什么我认为你应该坚持使用 Access 并从那里开始，在 VBA 的帮助下，在 Excel 等中做你的事情的原因。

祝你好运

# actionscript-3 - 交互式 ActionScript 解释器？

> ID：894801
> 
> 赞同：20
> 
> 时间：2009-05-21T19:54:42.117
> 
> 标签：actionscript-3

是否有某种交互式 ActionScript 解释器？类似于 Firebug 的 JavaScript 命令行或 Python 的交互式 shell？

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2009-05-22T08:26:08.643

试试[AS3Eval 库](http://eval.hurlant.com/)- 它是在 AS3 中实现的 AS3 编译器。它有[简单的交互式外壳](http://eval.hurlant.com/demo/)。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2010-04-30T17:17:56.917

还有正面：

[http://code.google.com/p/frontal/](http://code.google.com/p/frontal/)

它内置了一个 ActionScript 解释器。它基于 ECMA 2.62 (JavaScript) 标准，因此它不是完整的 AS3，也不支持包和类之类的东西，但它仍然非常方便。

正如我所提到的，解释器是实现 Frontal 语言的更大库的一部分，但如果你愿意的话，你可以很容易地把解释器去掉。

或者你可以在 Frontal 中使用它。如果你这样做了，那么你会得到一个控制台，它允许你在原始 shell 中运行 ActionScript。例如，访问 Frontal 网站。（我无法发布链接，因为我的声誉很低，但它是 frontalcode + com。）右键单击并选择“查看 Frontal Source...” 这将打开 Frontal 控制台。在控制台底部，单击“命令行”。这是你的“外壳”。

试试这样说：

5 + 4 * 10

或者

电影.alpha = 0.5

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-11-13T12:07:23.423

**[flash-console](https://code.google.com/p/flash-console/)**项目正是这样做的。他们有[演示](http://console.junkbyte.com/sample.html)和在线[帮助](https://code.google.com/p/flash-console/wiki/CommandLineHelp)。

*   特殊命令以斜杠开头，例如`/help`
*   变量可以通过以下方式存储和访问`$some_name`
*   `/`将当前范围更改为最后一个返回值。

该项目旨在集成到您的项目中。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-22T02:38:23.363

Actionscript 是一种编译语言，编译后的字节码由 Flash Player 虚拟机执行。有许多工具可以基于 Actionscript 源代码创建 Actionscript 字节码。我不知道除了 Adob​​e Flash Player 之外是否存在任何可以插入 AS 字节码并执行它的工具。

虽然我没有说不可能，但我还没有看到也没有听说过任何工具可以为您提供 Actionscript 的交互式 shell。

# python - 无法用 Sed/Python/Perl 替换给定文件夹内容中的单词

> ID：894802
> 
> 赞同：0
> 
> 时间：2009-05-21T19:54:47.390
> 
> 标签：python, perl, sed, replace

我有一个项目，其中有文件夹、子文件夹和文件。我需要在每个文件中用单词 Bond 替换单词 Masi。

我运行以下名为 replace 的 Sed 脚本失败

```
s/Masi/Bond/ 
```

在 Zsh 中

```
sed -f PATH/replace PATH2/project/** 
```

它给了我所有的文件，也包括那些没有 Masi 的文件，作为输出。

Sed 不一定是完成这项任务的最佳工具。我对 Python 和 Perl 很感兴趣。

**您将如何在 Sed/Perl/Python 中进行替换，**以便仅更改文件内容？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-05-21T20:03:13.363

**替换当前目录和子目录中找到的所有文件中的单词**

```
perl -p -i -e 's/Masi/Bond/g' $(grep -rl Masi *) 
```

如果文件名中有空格，上述方法将不起作用。更安全的做法：

```
find . -type f -exec perl -p -i -e 's/Masi/Bond/g' {} \; 
```

或在文件名中有空格的 Mac 中

```
find . -type f -print0 | xargs -0 perl -p -i -e 's/Masi/Bond/g' 
```

**解释**

*   -p 表示打印或死亡
*   -i 表示“不做任何备份文件”
*   -e 允许您在命令行中运行 perl 代码

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-21T20:02:50.603

为什么不直接将`-i`选项 ( `man sed`) 传递给 sed 并完成它呢？如果它没有在文件中找到 Masi，则文件将被重写而不进行任何修改。还是我错过了什么？

如果您不想内联替换文件的内容（这就是`-i`将要执行的操作），您可以完全按照现在的方式进行操作，但在它前面加上一个`grep`& ：`xargs`

```
grep -rl Masi PATH/project/* | xargs sed -f PATH/replace 
```

很多选项，但不要**为此**编写完整的 perl 脚本（我会给单行程序一个通过；））。 `find`, `grep`, `sed`,`xargs`等将永远更加灵活，恕我直言。

回应评论：

```
grep -rl Masi PATH/project/* | xargs sed -n -e '/Masi/ p' 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-05-21T20:30:43.010

重命名一个充满文件的文件夹：

```
use warnings;
use strict;
use File::Find::Rule;

my @list = File::Find::Rule->new()->name(qr/Masi/)->file->in('./');

for( @list ){
   my $old = $_;
   my $new = $_;
   $new =~ s/Masi/Bond/g;
   rename $old , $new ;
} 
```

替换文件中的字符串

```
use warnings;
use strict;
use File::Find::Rule;
use File::Slurp;
use File::Copy;

my @list = File::Find::Rule->new()->name("*.something")->file->grep(qr/Masi/)->in('./');

for( @list ){
   my $c = read_file( $_ );
   if ( $c =~ s/Masi/Bond/g; ){
    File::Copy::copy($_, "$_.bak"); # backup.
    write_file( $_ , $c );
   }
} 
```

*   [strict](http://p3rl.org/strict) (core) - Perl pragma 来限制不安全的结构
*   [warnings](http://p3rl.org/warnings) (core) - Perl pragma 控制可选警告
*   [File::Find::Rule](http://p3rl.org/File::Find::Rule) - File::Find 的替代接口
*   [File::Find](http://p3rl.org/File::Find) (core) - 遍历目录树。
*   [File::Slurp](http://p3rl.org/File::Slurp) - 完整文件的高效读/写
*   [File::Copy](http://p3rl.org/File::Copy) (core) - 复制文件或文件句柄

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-21T20:05:43.653

**在 Windows 上测试的解决方案**

需要 CPAN 模块 File::Slurp。将使用标准的 Unix shell 通配符。像 ./replace.pl PATH/replace.txt PATH2/replace*

```
#!/usr/bin/perl

use strict;
use warnings;
use File::Glob ':glob';
use File::Slurp;
foreach my $dir (@ARGV) {
  my @filelist = bsd_glob($dir);
  foreach my $file (@filelist) {
    next if -d $file;
    my $c=read_file($file);
    if ($c=~s/Masi/Bond/g) {
      print "replaced in $file\n";
      write_file($file,$c);
    } else {
      print "no match in $file\n";
    }
  }
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-06-02T18:52:01.547

```
import glob
import os

# Change the glob for different filename matching 
for filename in glob.glob("*"):
  dst=filename.replace("Masi","Bond")
  os.rename(filename, dst) 
```

# c++ - 如何区分（重载时）运算符++的前缀和后缀形式？(C++)

> ID：894804
> 
> 赞同：8
> 
> 时间：2009-05-21T19:55:12.660
> 
> 标签：c++, operator-overloading, postfix-operator, prefix-operator

因为我已经`operator++`为迭代器类重载了

```
template<typename T>
typename list<T>::iterator& list<T>::iterator::operator++()
{
    //stuff
} 
```

但是当我尝试做

```
list<int>::iterator IT;
IT++; 
```

我收到关于没有 postifx 的警告`++`，使用前缀形式。我怎样才能特别重载前缀/后缀形式？

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2009-05-21T19:56:32.190

[http://www.devx.com/tips/Tip/12515](http://www.devx.com/tips/Tip/12515)

```
class Date {
    //...
    public:
    Date& operator++(); //prefix
    Date& operator--(); //prefix
    Date operator++(int unused); //postfix
    Date operator--(int unused); //postfix
}; 
```

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2009-05-21T19:56:12.520

编写相同运算符重载的版本，但给它一个类型的参数`int`。您不必对该参数的值做任何事情。

如果你对这个语法是如何产生的历史感兴趣，[这里有一个片段](http://groups.google.com/group/comp.lang.c++.moderated/msg/6da0765460749c4f?dmode=source)。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2009-05-21T19:57:13.080

Postfix 在签名中有一个 int 参数。

```
Class& operator++();    //Prefix 
Class  operator++(int); //Postfix 
```

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2011-08-22T15:28:39.883

关于运算符重载的一切 [http://www.parashift.com/c++-faq-lite/operator-overloading.html](http://www.parashift.com/c++-faq-lite/operator-overloading.html)

# excel - Excel 数字格式：什么是“[$-409]”？

> ID：894805
> 
> 赞同：42
> 
> 时间：2009-05-21T19:55:31.443
> 
> 标签：excel, number-formatting

我正在自动化 excel，使用宏系统作为我应该通过自动化做什么的指南。当我将列格式化为日期时，宏`NumberFormat`会为该列生成一个：

```
[$-409]m/d/yy h:mm AM/PM;@ 
```

我试图破译这真正意味着什么。[我从谷歌搜索](http://www.bettersolutions.com/excel/EVD243/QM215412021.htm)中收集到，方括号中的值是*“条件”*，如果条件：

```
$-409 
```

满足，那么它将使用`NumberFormat`

```
m/d/yy h:mm AM/PM 
```

如果没有，它使用`NumberFormat`

```
@ 
```

我发现的参考资料说数字格式“@”是**文本占位符**

所以我的问题是：

1.  什么是有条件的**$-409**测试？它是否将某物与**-409**（即*负*409 ）进行比较，如果是，它所比较的*​​美元符号*是什么？

2.  如果条件失败，并且它使用**文本占位符**“at-sign”，它会显示什么？

* * *

## 回答 #1

> 赞同：48
> 
> 时间：2009-05-22T18:27:07.133

为了澄清其他人所说的话：

[$-409] 是一个**语言环境**代码，以十六进制形式给出。使用特定语言环境代码为日期添加前缀决定了在您使用各种日期时间格式代码时显示的内容。例如使用日期

> 1973 年 11 月 28 日 11:28:13

作为下表的示例：

```
Format Code  409 (English United States)  804 (Chinese PRC)
===========  ===========================  =================
m            11                           11
mm           11                           11
mmm          Nov                          十一月
mmmm         November                     十一月
d            27                           27
dd           27                           27
ddd          Mon                          二
dddd         Monday                       星期二
y            73                           73
yy           73                           73
yyy          1973                         1973
yyyy         1973                         1973
AM/PM        AM                           上午 
```

因此，最终具有两个不同区域设置标识符的相同格式代码会给出不同的结果：

```
[$-409]mmmm dd yyyy  h:mm AM/PM
November 27 1973  11:28 AM

[$-804]mmmm dd yyyy  h:mm AM/PM
十一月 27 1973  11:28 上午 
```

由于查找语言环境代码列表就像拔牙一样，这里有一些参考：

[语言标识符常量和字符串](http://msdn.microsoft.com/en-us/library/dd318693(VS.85).aspx)（主要来源，[archive.is](https://archive.fo/GTspb)）

[按区域设置排序的 Windows 区域设置代码](http://www.science.co.il/Language/Locale-Codes.asp) *( [archive.is](https://archive.fo/Y1mxi) )*

[按区域设置排序的 Windows 区域设置代码](http://blog.csdn.net/2066/archive/2004/07/20/45555.aspx) *（[archive.org](https://web.archive.org/web/20040725223808/http://blog.csdn.net/2066/archive/2004/07/20/45555.aspx)、[archive.is](https://archive.fo/wEwLB)）*

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2009-05-21T22:53:27.030

Naaf and Grant Wagner have neatly answered the question about your `$-409`, so I'll just fill in the missing part:

The '@' after the semicolon tells Excel how to treat the data if you enter a string instead of a valid date. The `@` simply means "place any text here, verbatim".

Some quick examples to illustrate the point:

```
=TEXT("abc","hh:mm;@")
abc 
```

```
=TEXT("abc","hh:mm;@@")
abcabc 
```

See [this article](http://www.brainbell.com/tutorials/ms-office/excel/Create_Custom_Number_Formats.htm) for a detailed description of the text formatting options.

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2009-05-21T20:27:28.790

[这篇文章](http://www.dailydoseofexcel.com/archives/2006/02/27/months-of-the-world/)解释了它。基本上 409 是“英语 - 美国”的[语言环境 ID 。](http://msdn.microsoft.com/en-us/goglobal/bb964664.aspx)例如，如果您使用`[$-414]`，则日期将被格式化为“挪威语（博克马尔）”。

我对问题 (2) 的猜测是原始数据将显示为字符串而不是格式化。快速测试将验证这一点。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2010-07-13T20:09:20.330

Excel 2007 中有一个错误，它将所有常规格式更改为 [$-409] 类型的日期格式。
通常，使用 [$-409] 是可以的格式。
微软尚未提供该错误的修复程序。此错误通常发生在大型和共享 Excel 工作簿中。

如果您曾经有过将所有常规格式更改为日期的经验，请尝试转到单元格样式，右键单击正常并将正常修改回常规。它会在框中告诉您 Normal 的格式类型。这是错误，因为它通常应该是“一般”而不是 [$-409] 的某些版本。

我最终不得不从工作簿中完全删除格式。必须取消共享工作簿才能执行此操作。要从工作簿的“普通”单元格类型下删除上面标识的格式 [$-409]，右键单击一个单元格，选择自定义，滚动直到找到上面标识的 [$-409] 格式类型，然后删除所有格式将回到所谓的一般。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-05-21T20:29:20.423

`[$-409]`似乎不是一个条件。它似乎是一个区域设置代码。

如果我使用**自定义**格式格式化单元格`[$-409]m/d/yy h:mm AM/PM;@`，输入日期：`1/1/9`，然后查看单元格的格式，我会看到**日期**格式为`m/d/yy h:mm AM/PM`，**区域设置（位置）**为`English (United States)`。

如果您将格式更改为类似的格式，`[$-439]m/d/yy h:mm AM/PM;@`您将看到另一种语言的单元格内容。

我不确定`@`。如果正确的字体或语言环境不可用，它可能会指示如何显示日期。

这是[Microsoft 分配的区域设置 ID](http://msdn.microsoft.com/en-us/goglobal/bb964664.aspx)列表。

# visual-studio - 在构建时运行 Visual Studio 自定义工具

> ID：894806
> 
> 赞同：25
> 
> 时间：2009-05-21T19:55:52.083
> 
> 标签：visual-studio, msbuild, build-automation, custom-build

我有一个将文本文件转换为资源文件的脚本，这样我就可以通过将不同语言的文本文件转换为不同的资源来支持多种语言。运行脚本以获取 resx 文件后，我必须运行自定义构建工具（如此处所述：[链接到代码项目](http://www.codeproject.com/KB/dotnet/customtoolsexp.aspx)）以创建`Designer.cs`文件以使用新文件。

按照我应该能够通过单击一个按钮来构建整个项目的理念，我怎样才能删除我必须显式调用自定义构建工具以制作代码隐藏文件的步骤？

我已经尝试自动删除`Designer.cs`文件作为预构建步骤，因为我认为如果没有 Designer.cs 文件但没有骰子，自定义构建工具会自动运行。

所以，我希望我在 Visual Studio/msbuild 中的构建脚本执行以下操作：1）将文本转换为 resx（完成）2）将 resx 文件移动到适当的目录（完成）3）使用自定义构建工具创建 Designer.cs 文件（未完成)

这是最后一步...

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-21T20:11:46.327

不幸的是，我认为没有一种简单的方法可以做到这一点。自定义构建工具仅在 VS.NET 中运行 - 当您从命令行使用 MSBuild 构建项目时，它们不会运行。

一般来说，如果您可以选择将构建工具编写为客户构建工具或 MSBuild 任务，那么每次都选择 MSBuild 任务，因为这些任务将在 VS.NET 和命令行中运行。

资源的 Designer.cs 文件可以支持您的编码。它们为您提供对资源文件的强类型访问。因此，只要您在 VS.NET 中创建文化不变资源（并让它创建 .designer.cs 文件），然后稍后添加额外的语言支持（额外的 .resx 文件）应该可以正常工作。

但是，如果您的文本文件是您的主要资源文件，并且您首先将新的资源字符串添加到这些文本文件中，那么您将需要找到另一种生成 .cs 文件的方法，以允许您针对这些资源进行编码。如果您必须这样做，自己生成 .designer.cs 文件（或类似的文件）不会那么困难。使用 CodeDom 或 T4，您可以使用现有的 .designer.cs 文件作为模板来创建帮助程序类。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2017-04-07T08:22:00.467

作为构建过程的一部分，有一种方法可以为 *.resx 生成 *.Designer.cs。有一个内置的 MSBuild 任务[GenerateResource](https://msdn.microsoft.com/en-us/library/ms164295.aspx)，它基本上是 SDK 工具 resgen.exe 的包装器。[在这里](https://social.msdn.microsoft.com/Forums/vstudio/en-US/f3fb8154-6e18-4077-a674-dd303826c9d3/forcing-regeneration-of-designercs-from-resx-with-msbuild?forum=msbuild)您可以找到如何使用它的示例。

您会发现另一件事很有用，如果生成的 *.Designer.cs 版本不正确，基本上，GenerateResource 任务不会调用所需版本的 resgen.exe，设置属性[SdkToolsPath](http://answers.flyppdevportal.com/MVC/Post/Thread/9435dce9-b114-4b1e-b8a0-3ca4709b4692?category=msbuild)可能会对您有所帮助。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-24T05:35:48.877

您是否尝试在您的 csproj 的 Before/AfterBuild 步骤中添加 Exec 步骤？您必须为此手动编辑文件，但这应该可以解决您的问题。

如果您希望在构建之前或之后完成此操作，我并不完全清楚。如果您需要在 Pass1/Pass2 之后的某个时间完成它，您可以直接挂接到目标。尝试查看 Microsoft.Build.Common.Targets 以了解如何执行此操作。

# bash - 在多个（新）选项卡中打开现有 Gvim 中的文件

> ID：894811
> 
> 赞同：45
> 
> 时间：2009-05-21T19:56:25.390
> 
> 标签：bash, ubuntu, vim, tabs, alias

我在我的 .bashrc 中放了一些别名，以便在 gvim 中打开一组项目文件，每个文件都在自己的选项卡中：

```
gvim -p <list of file names using absolute paths> 
```

这一切都很好，除了在任何给定时间我可能想要在几组文件之间移动（我当前的项目使用 Ruby on Rails，这就解释了这一点）。如果我可以将新选项卡附加到现有的 gvim 实例，那将是非常棒的。在我的最后一个职位上，我在 Vista 上工作；我通过在 gvim 中打开一堆空选项卡来解决这个问题，这使我可以右键单击文件名并选择“在现有的 No-Name gvim 中打开”。现在我使用 Ubuntu，上下文菜单上没有这样的东西。有没有办法从命令行做到这一点？

* * *

## 回答 #1

> 赞同：71
> 
> 时间：2009-05-21T20:06:37.303

如果 vim 是用[clientserver](http://www.vim.org/htmldoc/remote.html)选项编译的，你可以这样做。使用以下标志启动您的 vim 实例：

```
$ gvim --servername GVIM  # GVIM is the server name. It can be anything. 
```

要在此实例中打开更多选项卡，您可以运行以下命令：

```
$ gvim --servername GVIM --remote-tab file1 file2 file3 ... 
```

vim 中的客户端服务器功能非常方便。它不仅限于打开文件；它可用于使用命令行向 vim 发送任何命令。例如，要远程关闭 vim 实例，您可以使用：

```
$ gvim --servername GVIM --remote-send '<Esc>:wqa<CR>' 
```

* * *

## 回答 #2

> 赞同：21
> 
> 时间：2009-06-17T07:22:01.540

从 Gvim 内部，输入`:tabe {file_name}`. 这将在新选项卡中打开命名文件。如果你不喜欢输入长文件名，试试这个：

```
:tabnew
:e . 
```

这将打开一个新的空白标签页并打开文件浏览器。您可以通过鼠标单击或使用键盘。在要打开的文件上单击或按 Enter 键。尝试使用键盘将光标放在要打开的文件上，然后按“t”。这将在新选项卡中打开所选文件，同时在第一个选项卡中保持文件浏览器打开。这可能是打开一堆文件的快速方法。

您可以使用标签页做很多事情，这些事情可能会让生活更轻松。要访问 Vim 在线帮助手册中的相关部分，请输入`:h tabpage`.

* * *

## 回答 #3

> 赞同：13
> 
> 时间：2013-03-25T10:36:17.523

希望您的 Windows 上下文菜单允许您在当前打开的 gvim 窗口的新选项卡中打开文件？

将此保存为名为 temp.reg 的文件，然后双击它以将设置添加到注册表。如果您的路径不同，请务必修改 vim 的路径。

```
Windows Registry Editor Version 5.00
[HKEY_CLASSES_ROOT\*\Shell\Open with &Vim]
[HKEY_CLASSES_ROOT\*\Shell\Open with &Vim\command]
@="\"C:\\Program Files (x86)\\Vim\\vim73\\gvim.exe\" -p --remote-tab-silent \"%1\" \"%*\"" 
```

您现在将有一个这样的上下文菜单：

![vim 上下文菜单](https://i.stack.imgur.com/yhjhF.png)

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2013-03-11T09:27:04.347

Linux 用户可以使用这种脚本：

```
#!/bin/bash

ANS=`pgrep -fx "gvim --servername GVIM"`

echo $@

if [[ ! $ANS ]]; then
    gvim --servername GVIM
fi

if [[ $1 ]]; then
    gvim --servername GVIM --remote-tab "${@}"
fi 
```

然后编辑 gvim.desktop 文件以使用此脚本：

```
Exec=/home/user/bin/my_gvim_script.sh %F 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2011-11-12T09:06:30.993

有一种方法：

```
n*.cpp|tab ba 
```

或者如果您想拆分：

```
n*.cpp|sba 
```

如果您想了解更多：

```
:help ba 
```

我不知道是什么`n`，但没有它就行不通。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2014-10-09T23:12:59.267

这是我的 gvim 启动脚本。它是先前答案的扩展。它确保在所有情况下调用`gvim`时只有一个实例会运行：`gvim`

*   `gvim`当没有`gvim`实例正在运行时，在没有文件名的情况下调用；`gvim`已启动。
*   `gvim`在存在`gvim`实例的情况下调用不带文件名的方法；打开一个空的新选项卡。
*   `gvim`使用带有或不带有`gvim`实例的文件名调用；打开一个选项卡，显示该文件。

这将模仿其他编辑器的标准行为。

```
#!/bin/bash
exec=/usr/bin/gvim  #the path to gvim
if [ $# -eq 0 ]
  then  # no filename given
    if [ -z $($exec --serverlist) ]
      then  # no filename given and no gvim instance
        $exec -f --servername GVIM > /dev/null 2>&1
      else  # no filename given, but a gvim instance exists
        $exec -f --servername GVIM --remote-send ':tabnew<CR>' > /dev/null 2>&1
    fi
  else  # filenames given
    $exec -f --servername GVIM --remote-tab "$@" > /dev/null 2>&1
fi 
```

# php - PHP 引用数组的深拷贝

> ID：894814
> 
> 赞同：17
> 
> 时间：2009-05-21T19:56:53.110
> 
> 标签：php, deep-copy

所以 $array 是一个所有元素都是引用的数组。

我想将此数组附加到另​​一个名为 $results 的数组（在循环中），但由于它们是引用，PHP 复制引用并且 $results 充满了相同的元素。

到目前为止，最好的工作解决方案是：

```
$results[] = unserialize(serialize($array)); 
```

我担心这会非常低效。有一个更好的方法吗？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-05-21T20:16:08.283

您可以使用函数在返回时取消引用结果的事实，例如这里`$array_by_myclone`仍然会有对`$original`( `$array_by_myclone[0][0] == 'foo'`) 的引用，而`$array_by_assignment`将有一个克隆值 ( `$array_by_assignment[0][0] == 'bar'`)

```
$original = 'foo';
$array_of_reference = array(&$original);

function myclone($value)
{
  return $value;
}

$array_by_myclone = array();
$array_by_myclone[] = array_map('myclone', $array_of_reference);

$array_by_assignment = array();
$array_by_assignment[] = $array_of_reference;

$original = 'bar';

var_dump($array_by_myclone[0][0]); // foo, values were cloned                                                                                                                                   
var_dump($array_by_assignment[0][0]); // bar, still a reference 
```

编辑：我想检查说`unserialize(serialize())`更快的评论是否正确，所以我使用 php 5.5 进行了测试，结果证明这是错误的：即使使用小数据集，使用序列化方法也会更慢，并且你拥有的数据越多它变得更慢。

```
lepidosteus@server:~$ php -v
PHP 5.5.1-1~dotdeb.1 (cli) (built: Aug  3 2013 22:19:30) 
Copyright (c) 1997-2013 The PHP Group
Zend Engine v2.5.0, Copyright (c) 1998-2013 Zend Technologies
    with Zend OPcache v7.0.2-dev, Copyright (c) 1999-2013, by Zend Technologies
lepidosteus@server:~$ php reference.php 1
myclone:   0.000010 seconds
serialize: 0.000012 seconds
lepidosteus@server:~$ php reference.php 1000000
myclone:   0.398540 seconds
serialize: 0.706631 seconds 
```

使用的代码：

```
<?php
$iterations = 1000000;
if (isset($argv[1]) && is_numeric($argv[1])) {
  $iterations = max(1, (int)$argv[1]);
}

$items = array();
for ($i = 0; $i < $iterations; $i++) {
  $items[] = 'item number '.$i;
}

$array_of_refs = array();
foreach ($items as $k => $v) {
  $array_of_refs[] = &$items[$k];
}

function myclone($value)
{
  return $value;
}

$start = microtime(true);

$copy = array_map('myclone', $array_of_refs);

$time = microtime(true) - $start;

printf("%-10s %2.6f seconds\n", 'myclone:', $time);

$start = microtime(true);

$copy = unserialize(serialize($array_of_refs));

$time = microtime(true) - $start;

printf("%-10s %2.6f seconds\n", 'serialize:', $time); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-01-06T03:52:14.370

无需将 array_map 与 serialize 进行比较，因为 array_map 没有用。

```
$original = array('key'=>'foo');
$array_of_reference = array(&$original);
function myclone($value)
{
  return $value;
}
$array_by_myclone = array();
$array_by_myclone[] = array_map('myclone', $array_of_reference);

$array_by_assignment = array();
$array_by_assignment[] = $array_of_reference;

$original['key'] = 'bar';

var_dump($array_by_myclone[0][0]['key']); // bar, still a reference                                                                                                                                   
var_dump($array_by_assignment[0][0]['key']); // bar, still a reference 
```

array_map 将回调应用于给定数组的元素，就像 foreach 一样。如果要复制的数组有 1 个以上的嵌套，则 array_map 不起作用。

# sql - 我们如何迁移到使用 VS2005 的数据库项目？

> ID：894818
> 
> 赞同：1
> 
> 时间：2009-05-21T19:57:49.083
> 
> 标签：sql, database, visual-studio-2005, projects

在我公司，我们目前更新数据库的方法是使用 VS2005 中的服务器资源管理器进行连接，然后通过打开和编辑来修改存储过程。这里的开发人员似乎很享受“像代码一样编写和保存它”的心态。非常方便，当我们需要调整某些内容时，它如何自动将 Create 转换为 Alter 并针对现有数据库运行脚本。

最近，在服务器崩溃期间，当我们丢失了很多没有备份的更改时，这让我们非常难过。我正在推动将我们的 SQL 开发移到它所属的位置：在 DB 项目中，以便我们可以将它们与其他代码一起放入 SVN。另一种方法是每晚备份数据库。

不过，我不太了解数据库项目，也不了解它们的工作流程。恐怕如果我无法获得与他们当前模型类似的实用程序，他们就不会切换。关于维护我们当前的工作模型，但切换到 DB 项目的任何想法？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-21T20:04:53.967

如果开发人员制定了规则（并且您的帖子听起来像他们这样做），那么您只能在新的工作流程对*他们*“更好”的情况下继续。作为一名开发人员，我认为这就是应该的方式。我见过一些非开发人员想出一些非常荒谬的开发过程，并强迫他们去开发人员，从而损害每个人的利益。

如果您正在考虑 VS DB 项目，您首先要测试 VS DB 是否真的适用于您的数据库。如果是这样，您将不得不在过程中设置一个很大的机会：数据库的“真实”副本现在位于 VS DB 而不是数据库服务器中。

另一种方法是定期备份开发服务器。如果您每天备份它，并且每小时备份一次事务日志，则很难丢失大量工作。

或者创建一个将整个数据库定义写入文本文件的计划作业。（为数据库中的所有对象编写脚本。）这些文件通常非常小，因此您可以保留很长的积压。

许多受人尊敬的博主似乎认为在 SVN 中存储数据库定义是一个好主意。请参阅此[编码恐怖](https://blog.codinghorror.com/get-your-database-under-version-control/)帖子或相关的 Stack Overflow 相关问题[How do I version my MS SQL database in SVN](https://stackoverflow.com/questions/173/how-do-i-version-my-ms-sql-database-in-svn)。

与开发人员讨论，看看你能达成什么共识。

# c# - 在不调用 SelectedItemChanged 的 情况下选择 TreeView 项？

> ID：894821
> 
> 赞同：2
> 
> 时间：2009-05-21T19:58:04.077
> 
> 标签：c#, wpf

在我的应用程序中，我有一组 3d 对象，它们通过 TreeView 向用户公开。当用户在 TreeView 中选择一个项目时，会触发 SelectedItemChanged 事件，相应的 3d 对象被设置为选中并在 3d 渲染窗口中突出显示。这工作正常。

我遇到的麻烦是相反的。在我的一段代码中，我以编程方式在场景中设置选定的 3d 对象。我想在 TreeView 中反映当前选择的对象，所以我遍历项目，直到找到对应的项目。但是一旦我开始使用它，我就无法找到一种方法来使项目显示为选中而不调用 SelectedItemChanged，这不是我想要的。

有没有办法做到这一点？

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-21T20:02:58.467

我认为您想禁止事件处理程序中的代码？如果是这样，这样做的常见方法是使用布尔标志（或有时是 int 计数器）：

```
bool updatingSelected;

void SomeHandler(object sender, EventArgs args) { // or whatever
  if(updatingSelected) return;

  //...
}

void SomeCode() {
    bool oldFlag = updatingSelected;
    updatingSelected = true;
    try {
       // update the selected item
    } finally {
       updatingSelected = oldFlag;
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-21T23:50:05.013

暂时删除 TreeView 的 SelectedItemChanged 事件处理程序，并在执行了必要的操作后重新添加它是否合适？我自己没有尝试过，但这是我唯一能想到的其他事情（Marc Gravell 击败了我的原始答案——我以前做过 ;)）。

祝你好运！

# windows - Windows 7 SDK RC & Beta 版本

> ID：894823
> 
> 赞同：0
> 
> 时间：2009-05-21T19:59:05.073
> 
> 标签：windows, windows-7, winapi

我已经下载了在测试版发布时下载的 Windows 7 SDK。现在我升级到 RC 并尝试使用一些 Direct2D 示例。但我无法使用 D2D1CreateFactory API 创建工厂指针。它总是返回 NULL。即使是从 MSDN 下载的示例也不能正常工作。

[Beta - RC 有一些变化](http://msdn.microsoft.com/en-us/library/dd756650(VS.85).aspx)

这是因为SDK的版本不匹配吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-21T20:26:12.240

好吧，我不会使用旧的 Windows SDK Beta。我建议您卸载测试版并安装适用于您正在运行的操作系统的 SDK。在这种情况下，[Windows 7 SDK RC](http://www.microsoft.com/downloads/details.aspx?FamilyID=6db1f17f-5f1e-4e54-a331-c32285cdde0c&displaylang=en)。

# ruby-on-rails - 2 个按钮，1 个表格

> ID：894824
> 
> 赞同：0
> 
> 时间：2009-05-21T19:59:10.330
> 
> 标签：ruby-on-rails, forms

我有一个看起来像这样的简单表格

```
<% remote_form_for post, :url => post_path(post), :method => :put do |f| -%>
  <%= f.submit "Approve" %>
  <%= f.submit "Deny" %>
<% end -%> 
```

哪个呈现

```
<input type="submit" value="Approve" name="commit"/>
<input type="submit" value="Deny" name="commit"/> 
```

在我的控制器中，我有以下逻辑

```
@post.approved =  params[:commit] == 'Approve' ? true : false 
```

所以问题是，如果用户单击“批准”按钮或“拒绝”按钮，发送的参数就是`:commit => "Approve"`.

有人知道与执行相同功能的这种或其他（简单）方式相关的错误吗？

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-21T20:22:45.820

JS lib（我猜是原型）不知道按下了什么按钮。它只是序列化 Ajax 请求的表单字段值。使用普通形式的 POST 时，浏览器会将正确的值附加到提交参数。

您可以添加隐藏的表单域（例如操作）。然后添加 JS 代码以在按下相应按钮时（以及在发送 Ajax 请求之前）设置隐藏字段的所需值。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-21T20:46:14.213

另一种选择是覆盖第二个按钮的“名称”参数。

```
<%= f.submit "Deny", :name => "commit_deny" %> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-22T11:38:03.950

我认为 Submit 每个表单（HTML 事物）都是唯一的，所以 yopu 有两种选择：

1.  使用 2 个表单，每个表单提交 1 个，这会导致相同的操作（您喜欢的 CSS）
2.  使用 2 个按钮类型的控件（即不提交）并使用两个 onClick 事件提交（需要 JavaScript）

# c# - 在 ASP.NET 上创建 JSON 标头

> ID：894828
> 
> 赞同：17
> 
> 时间：2009-05-21T20:02:17.967
> 
> 标签：c#, php, asp.net, json, header

我正在将脚本从 PHP 转换为 ASP.net C#。在 PHP 中，我可以使用类似的东西：

header('内容类型：文本/json');

header('内容类型：应用程序/json');

如何告诉我的 aspx 页面在标题中声明它正在打印 JSON 文件？

* * *

## 回答 #1

> 赞同：42
> 
> 时间：2009-05-21T20:05:55.603

```
Response.ContentType = "application/json"; 
```

或更一般地说

```
Response.Headers.Add("Content-type", "text/json");
Response.Headers.Add("Content-type", "application/json"); 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-06-15T19:59:02.530

有关 JerSchneid 答案的附加信息

如果您收到这样的错误消息：

> 此操作需要 IIS 集成管道模式。

你可以这样使用：

```
Response.AddHeader("Content-type", "text/json"); 
```

# java - 在 Java 中防止异常与捕获异常

> ID：894829
> 
> 赞同：13
> 
> 时间：2009-05-21T20:02:33.677
> 
> 标签：java, exception, error-handling

我想知道其他 SOers 在实践中如何处理和/或防止异常。

在什么情况下你会防止异常，如何防止？在什么情况下你会捕获异常？

我通常通过基本上说来防止“NullPointerExceptions”（和其他类似的）`if(foo!=null) {...}`

我发现在大多数情况下，这比使用 try-catch 块所涉及的所有内容都小。

当潜在异常更复杂或更多时，我使用 try-catch 块。

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2009-05-21T20:11:49.587

在我看来，只有当引用为 null（再次例如）实际上表示**有效的程序状态**时，防止 NullPointerException（例如）才有意义。如果没有，您不应该**阻止**它发生，因为在这种情况下，您**希望**程序很难死掉。

特别是在 Java 中，源自 RuntimeException 的某些异常（例如 IllegalArgumentException）实际上是为了表示编程错误，如果您的程序是正确的，这些情况就不应该发生。我尝试遵循这一点。如果我正在编写一个对其参数进行限制的方法，我不会试图避免抛出异常。我会积极地扔一个。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2009-05-21T20:07:23.340

如果您可以防止异常，那么这样做是更好的编程习惯。例如，任何 NullPointerException 通常表示编程错误，IMO。（这是 RuntimeException 的原因之一。）

当您希望能够在一层代码中检测到故障条件时，异常更有用，但您不想在那里处理故障条件，而是在更高级别的代码中处理。也就是说，您打算将异常抛出超过一帧的堆栈 - 或一直向上堆栈。当您不希望程序能够有意义地处理问题时，异常也很有用。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-05-21T20:13:47.087

有[三种](https://stackoverflow.com/questions/462501/exception-other-than-runtimeexception/462745#462745)例外。

**运行时异常**总是可以预防的。你只需要正确编程。

**如果可能，应将检查的异常**转换为正确的抽象级别（如果用户不知道/不关心 SQL 异常，则不要向用户抛出 SQLException）或在更高级别处理（即让它们弹出）并显示/log 正确的消息。

**根本不应该处理**错误。****

 **[有关如何防止 RuntimeExceptions 的更多详细信息，请参阅链接]

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2009-05-21T21:39:09.067

在您知道如何处理异常的地方捕获异常。

您不应该到处检查 (foo!=null)，只检查 foo 首次使用的位置。之后只需使用 foo 而不检查。如果 foo 在您确定它不为 null 之后突然变为 null，那么您就有大问题了。一个例外是合适的。

```
try {
   foo();
}
catch (FooException e) {
} 
```

是一种不好的代码气味，应该避免

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-05-21T23:53:55.037

我将在方法的开头检查输入参数，如果它们超出了应该传递给方法的参数，则抛出 IllegalArgumentException。这个想法是它是一个编程错误，应该被修复。现在比在野外时更好。如果在一个方法的中间我遇到了一个意外情况（列表中的 null 等），我将记录一条致命消息并执行 System.exit(2)。这再次迫使您解决问题，而不是仅仅记录它并继续前进。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-05-21T20:08:49.997

尽量避免那些（NullPointerExceptions、NullReferenceExceptions 等）。

捕捉那些难以捕捉的东西（Sql 错误......它们可能超出你的控制范围，但你需要优雅地清理它们）。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-10-25T11:18:29.730

一般来说，异常应该是异常的，例如不可预见的或由于编程错误。问题是，Java 类库中存在一些可疑的设计决策，因此您最终会得到如下惯用语：

```
class Foo {
  static BufferedReader in=new BufferedReader(new InputStreamReader(System.in));
  int getInt() throws IOException {
    int r=0;
    for(;;) {
      String s=in.readLine();
      try {
        r=Integer.parseInt(s);
        break;
      }
      catch(NumberFormatException e) {
        System.out.println("Please enter a valid integer.");
      }
    }
    return r;
  }
} 
```

显然，该代码并不完美（将在 EOF 上引发 NullPointerException），但它演示了对实际上并非异常的事物使用异常的问题。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2009-05-21T21:04:52.833

我希望我的所有异常都向上传播，除非它们是次要的，然后我会吞下它们（例如：防止索赔条目死亡，因为电子邮件通知功能生成了 NPE ......我想吞下那个 NPE 并继续卡车运输因为程序的真正内容不会引发异常）。

我使用这种方法来强制 Java 的大多数**不可恢复**但已检查的异常：

[http://www.onjava.com/pub/a/onjava/2003/11/19/exceptions.html](http://www.onjava.com/pub/a/onjava/2003/11/19/exceptions.html)

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2012-05-22T10:19:36.780

我在整个代码中使用以下类来验证和中止处理：

 `````
@Getter
@Setter
public class Abort<T> {

    private boolean abortProcessing;

    private T response;
} 
````  `这样，您可以立即验证或捕获异常，记录它们并返回中止对象。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2009-05-21T20:08:51.697

一般来说，如果这样做是合理的，您应该首先尝试防止异常发生。很多时候，这是不合理的，或者可能完全不可能（尤其是在涉及 io 时），但这就是 try/catch 的用途。特别是，这意味着您应该始终检查指针和数组索引，以防止出现 NullPointerException 和 ArrayIndexOutOfBoundsException。当然，除非您对此无能为力，并且无论如何都必须重新抛出它。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2009-05-21T20:20:31.597

您应该捕获所有可以捕获的异常。`NullPointerException`s 总是可以用一个简单的`if`语句来防止。其他一些例外情况，如大多数`IOException`s，很难防止。除了使用 try/catch 块所需的样板文件之外，如果您的类抛出异常，则会创建该异常的对象并且它必须被垃圾收集......所以通过不抛出异常，您还可以使您的 VM 更健康。

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2009-05-22T00:13:10.130

我尽可能地阻止，但我会捕捉到用户影响的事情，例如当他们输入错误类型的数据时。在 Java 中，我编写了一个类，它扩展了 Scanner 并不断要求正确的输入，直到它有效为止。（来自 CLI）

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2009-05-21T22:13:18.000

通常，当异常应该导致进程中止时，我会使用异常。当我要对问题采取措施并以某种方式恢复时，我会尝试防止异常发生。

就像，如果一个参数被传递给一个子程序并且我有理由认为它可能是空的，我会检查它是否为空。例如，在现实生活中，空字符串通常等同于长度为零的字符串，我将在其中编写 < if (s==null) s=""; >。

但是，如果一个空字符串意味着出现了严重错误，我们应该退出整个过程并向用户显示“恐慌——中止——世界即将结束”类型的消息，那么异常是非常方便的。您可以将异常深入到子程序的许多层中，然后在顶部捕获它，显示消息，然后就完成了。

我经常为这种情况创建自己的例外。我的许多程序都散布着像 < throw new BadInputException("Customer number not found") > 这样的代码，只是让我出去，显示一条消息，然后退出。这确实节省了 IF 的深度嵌套和对子程序返回值的不断检查。

# visual-studio - 如何强制 MSBuild 不部分构建目标？

> ID：894837
> 
> 赞同：0
> 
> 时间：2009-05-21T20:03:27.467
> 
> 标签：visual-studio, msbuild, msbuild-task

我有一个构建过程，它执行以下操作：

1.  在一定数量（比如 10 个）COM DLL（一组命名的任务项）上运行 TLBIMP。这是我使用 Exec 任务的“导入”目标。
2.  在 10 个互操作程序集上运行 ILDASM。这是我使用 Exec 任务的“反汇编”目标。
3.  运行自定义任务以同时获取所有 10 个 IL 文件并对它们进行一些处理（细节并不重要，但此任务一起处理所有 10 个 IL 文件至关重要）。这是我的“工作”目标。
4.  使用 ILASM 将 10 个 IL 文件重新组合成 10 个 DLL。这是我的“组装”目标，使用 Exec 任务。
5.  运行 ILMerge 以将 10 个程序集合并为一个。这是我的“合并”目标，使用 Exec 任务。

当我进行干净的重建时，一切都很好。当我进行增量构建时，只有少数原始 COM DLL 发生了变化，MSBuild 非常正确地只对适当目标进行了部分构建，因为输出实际上相对于其输入已过时。

有没有一种方法可以让我“强制”MSBuild，只针对一个目标（上面的第 3 步）运行一个传递所有输入的任务，而不仅仅是过时的输入？我不想更改自定义任务的代码以对文件名进行硬编码，我希望将它们作为 MSBuild 脚本中的 TaskItems 提供，但必须为我的自定义任务提供从COM DLL 的原始 TaskItem 组，而不仅仅是使用此特定版本重建的那些。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-21T20:26:17.903

我想我找到了办法。我可以这样定义一个组：

```
 <ItemGroup>
    <PrelimIL Include="$(IntermediateOutputPath)intermediate\*.il"/>
  </ItemGroup> 
```

然后在我的“反汇编”目标中，有第二个任务：

```
<Touch Files="@(PrelimIL)" /> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-22T04:09:18.613

在执行目标之前，您似乎走在了正确的轨道上。由于输入文件最近已被修改（通过您的触摸），因此目标的所有输出都被完全重建。您可以做的另一种方法是创建一个目标，即**CleanIntFiles**，它将删除这些文件。然后，您可以将该目标放在**BeforeBuildDependsOn**属性上。

有关如何扩展该属性的更多信息，请查看我的文章[Inside MSBuild](http://msdn.microsoft.com/en-us/magazine/cc163589.aspx)。

赛义德·易卜拉欣·哈希米

我的书：[Microsoft Build Engine 内部：使用 MSBuild 和 Team Foundation Build](https://rads.stackoverflow.com/amzn/click/com/0735626286)

# c# - 如何在 C# 中将结构数组转换为 Point3D 对象数组？

> ID：894842
> 
> 赞同：0
> 
> 时间：2009-05-21T20:04:59.023
> 
> 标签：c#, struct

我打算形成 3D 网格对象。网格对象有一个大约 3D 点数组。50.000 件。由于 3D 点的数量，必须在堆上初始化数组。

很快，所需的代码如下：

```
class MyMesh
{
    public MeshGeometry3D Mesh3D  // Properties tanimlaniyor
    {
        get { return GetMesh3D(); }
    }

    public struct mystruct
    {
        public int m_i;
        public int m_j;
        public int m_k;

        public mystruct(int i, int j, int k)
        {
            m_i = i;
            m_j = j;
            m_i = k;
        }
    }

    private mystruct[] mypts = 
    {
        new mystruct(20 , 7 , 7),   
        .
        .
        new mystruct(23 , 5 , 7)     
    };
} 
```

你能解释一下如何`mystruct`将上面的 3D 坐标转换为`System.Windows.Media.Media3D.Point3D`结构的 3D 坐标吗？

提前致谢。

厄纳耶尔马兹

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-21T20:31:04.603

如果您有一个包含 50,000 个`mystruct`对象的实际列表，那么首先将它们创建为`Point3D`结构会更好吗？

只需执行以下“查找和替换”：

> 新的结构（

并将其替换为

> 新的 Point3D(

然后，改变：

```
private mystruct[] mypts = 
```

至：

```
private Point3D[] mypts = 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-21T20:36:37.290

你在找这样的东西吗...

```
List<Point3D> points = mypts.Select<mystruct, Point3D> (x => 
                                      new Point3D(x.m_i, x.m_j, x.m_k))
                            .ToList(); 
```

或者，您可以公开一个返回 IEnumerable 的迭代器，如下所示...

```
public IEnumerable<Point3D> Points()
{
    foreach(var point in mypts)
    {
        yield return new Point3D(point.m_i, point.m_j, point.m_k, );
    }
} 
```

[酌情添加验证/错误处理代码]

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2009-05-21T20:35:41.970

如果您需要保留您的 mystruct 对象以及启用 Point3D 功能，您可以使用类似的东西：

```
class MyMesh {
    ...

    public Point3D[] ToPoint3D()
    {
        Point3D[] p3D = null;   // or set it to an Empty Point3D array, if necessary

        if (mpts.Length > 0)
        {
            p3D = new Point3D[mpts.Length]

            for (int x = 0; x < mypts.Length; x++)
            {
                p3D[x].X = new Point3D(mypts[x].m_i;
                p3D[x].Y = new Point3D(mypts[x].m_j;
                p3D[x].Z = new Point3D(mypts[x].m_k;
            }
        }

        return p3D;
    }

    ...
} 
```

# python - 如何在 Windows 上启动 python 脚本？

> ID：894845
> 
> 赞同：1
> 
> 时间：2009-05-21T20:05:17.540
> 
> 标签：python

我已经使用批处理作业运行了一些，但是，我想知道什么是最合适的？也许使用 time.strftime？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-21T20:09:00.607

如果您希望执行重复的计划任务，那么任务计划程序（Vista）或计划任务（XP，我认为更早）是 Windows 上的合适方法。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-22T00:57:34.097

我会第二次使用任务计划程序。

我还阅读了有关基于“cron-like”的 Python 应用程序 PyCron - [http://www.bigbluehost.com/article4.html](http://www.bigbluehost.com/article4.html)的信息。如果您来自 Unix 小镇，您可能会发现它比 Windows 调度程序更熟悉。我自己从未使用过它，但它可能很有趣。

# visual-studio - 如何附加到 Visual Studio 中的进程？

> ID：894848
> 
> 赞同：3
> 
> 时间：2009-05-21T20:05:26.900
> 
> 标签：visual-studio, debugging

有没有一种快速的方法可以附加到 vs.net 2008 中的进程（附加到 IIS 进程）？

每次我停止调试器并想重新运行时，我都必须转到调试 -> 附加到进程 -> 选择 aspnet_web.exe

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-05-21T20:12:31.830

您可以录制一个宏来执行此操作。在 VS2005 中，我这样做了：

*   ctrl-shift-R（开始录制）
*   ctrl-alt-P（附加到进程）
*   选择流程
*   好的
*   ctrl-shift-R（停止录制）

要播放临时宏，请按 ctrl-shift-P。它在宏 IDE 中生成了以下代码：

```
Sub TemporaryMacro()
    Try
        Dim dbg2 As EnvDTE80.Debugger2 = DTE.Debugger
        Dim trans As EnvDTE80.Transport = dbg2.Transports.Item("Default")
        Dim dbgeng(1) As EnvDTE80.Engine
        dbgeng(0) = trans.Engines.Item("Native")
        Dim proc2 As EnvDTE80.Process2 = dbg2.GetProcesses(trans, "<machine-name>").Item("cmd.exe")
        proc2.Attach2(dbgeng)
    Catch ex As System.Exception
        MsgBox(ex.Message)
    End Try

End Sub 
```

您可以在宏 IDE 中将此转换为永久宏，然后将其绑定到工具-选项-键盘窗格中的击键。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-21T20:07:25.180

如果您使用的是 Win XP，请按 Ctrl+Alt+P 并从列表中选择 aspnet_web.exe。

# asp.net - 内部 ASP.NET Web 应用程序部署到 IIS

> ID：894852
> 
> 赞同：2
> 
> 时间：2009-05-21T20:05:54.997
> 
> 标签：asp.net, iis, intranet

我有一个 ASP.NET 2.0 应用程序，我正在部署到 IIS 6.0 Web 服务器。我的 ASP.NET 应用程序被部署为一个虚拟目录。目前，这个 ASP.NET 应用程序在 Internet 上是公开可见的。但是，我需要 ASP.NET 应用程序仅在我的公司防火墙内运行。

如何配置我的应用程序，使我公司以外的个人无法访问/使用 Web 应用程序？

谢谢，

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-21T21:18:37.377

我会执行以下操作之一：

如果您的应用程序是独立的 1：使用内部 DNS 主机名为您的应用程序创建单独的站点

如果不是 2：对您的虚拟目录应用安全性（Windows 身份验证可以是无缝的）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-23T12:02:15.460

我建议，

1.  使用公司防火墙来阻止对此 IIS 服务器的所有外部请求。请咨询您的 IT 人员，因为他们很容易为您做到这一点。
2.  或者使用 IIS 管理器中的 IP 策略来允许内部 IP 范围但阻止所有其他范围。这只是一种变通方法，其性能比 1 差。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-21T20:17:33.460

可能是最适合 ServerFault 的问题，但您需要有一个只能从公司防火墙内部查看的 IP 地址。您可能有一个 IT 部门，因此请他们提供一个仅限内部的 IP 地址，然后分配他们在 IIS 中给您的 IP 地址。

# javascript - 为 JavaScript 函数设置默认参数值

> ID：894860
> 
> 赞同：2547
> 
> 时间：2009-05-21T20:07:17.740
> 
> 标签：javascript, function, parameters, arguments, default-parameters

我希望 JavaScript 函数具有我设置默认值的可选参数，如果未定义该值（如果传递该值则忽略该值）。在 Ruby 中，你可以这样做：

```
def read_file(file, delete_after = false)
  # code
end 
```

这在 JavaScript 中有效吗？

```
function read_file(file, delete_after = false) {
  // Code
} 
```

* * *

## 回答 #1

> 赞同：3473
> 
> 时间：2009-05-21T20:10:52.287

从[ES6/ES2015 开始](https://www.ecma-international.org/ecma-262/6.0/)，默认参数在语言规范中。

```
function read_file(file, delete_after = false) {
  // Code
} 
```

只是工作。

参考：[默认参数 - MDN](https://developer.mozilla.org/en/docs/Web/JavaScript/Reference/Functions/default_parameters)

> 如果未传递**任何值**或**未定义**，则默认函数参数允许使用默认值初始化形式参数。

您还可以[通过解构](http://exploringjs.com/es6/ch_parameter-handling.html#sec_named-parameters)[模拟默认*命名*](http://exploringjs.com/es6/ch_parameter-handling.html#sec_named-parameters)参数：

```
// the `= {}` below lets you call the function without any parameters
function myFor({ start = 5, end = 1, step = -1 } = {}) { // (A)
    // Use the variables `start`, `end` and `step` here
    ···
} 
```

**ES2015 之前**，

有很多方法，但这是我的首选方法——它可以让你传入任何你想要的东西，包括 false 或 null。( `typeof null == "object"`)

```
function foo(a, b) {
  a = typeof a !== 'undefined' ? a : 42;
  b = typeof b !== 'undefined' ? b : 'default_b';
  ...
} 
```

* * *

## 回答 #2

> 赞同：618
> 
> 时间：2009-05-21T20:09:48.560

```
function read_file(file, delete_after) {
    delete_after = delete_after || "my default here";
    //rest of code
} 
```

如果它不是*假*值，则分配给`delete_after`的值，否则分配字符串。有关更多详细信息，请查看[Doug Crockford 对语言的调查并查看有关 Operators 的部分](http://crockford.com/javascript/survey.html)。`delete_after`*`"my default here"`*

 **如果您想传入虚假*值，即`false`、`null`、或`undefined`，则此方法不起作用。如果您需要*传入 falsey*值，则需要使用[Tom Ritter's answer](https://stackoverflow.com/questions/894860/how-do-i-make-a-default-value-for-a-parameter-to-a-javascript-function/894877#894877)中的方法。`0``""`

 *在处理函数的多个参数时，允许使用者在对象中传递参数参数然后*将*这些值与包含函数默认值的对象合并通常很有用

```
function read_file(values) {
    values = merge({ 
        delete_after : "my default here"
    }, values || {});

    // rest of code
}

// simple implementation based on $.extend() from jQuery
function merge() {
    var obj, name, copy,
        target = arguments[0] || {},
        i = 1,
        length = arguments.length;

    for (; i < length; i++) {
        if ((obj = arguments[i]) != null) {
            for (name in obj) {
                copy = obj[name];

                if (target === copy) {
                    continue;
                }
                else if (copy !== undefined) {
                    target[name] = copy;
                }
            }
        }
    }

    return target;
}; 
```

使用

```
// will use the default delete_after value
read_file({ file: "my file" }); 

// will override default delete_after value
read_file({ file: "my file", delete_after: "my value" }); 
```

* * *

## 回答 #3

> 赞同：153
> 
> 时间：2009-05-21T20:18:46.483

我发现像这样简单的东西更简洁易读。

```
function pick(arg, def) {
   return (typeof arg == 'undefined' ? def : arg);
}

function myFunc(x) {
  x = pick(x, 'my default');
} 
```

* * *

## 回答 #4

> 赞同：66
> 
> 时间：2015-05-29T15:25:27.897

在 ECMAScript 6 中，您实际上将能够准确地编写您所拥有的内容：

```
function read_file(file, delete_after = false) {
  // Code
} 
```

如果它不存在，这将设置`delete_after`为`false`或`undefined`。您现在可以将像这样的 ES6 功能与 Babel 等转译器一起[使用](http://babeljs.io/)。

[有关详细信息，请参阅 MDN 文章](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Functions/Default_parameters)。

* * *

## 回答 #5

> 赞同：30
> 
> 时间：2016-10-15T17:58:14.600

**默认参数值**

`JavaScript`使用 ES6，您可能会执行与为函数参数设置默认值相关的最常见的习惯用法之一。我们多年来这样做的方式应该看起来很熟悉：

```
function foo(x,y) {
 x = x || 11;
 y = y || 31;
 console.log( x + y );
}
foo(); // 42
foo( 5, 6 ); // 11
foo( 5 ); // 36
foo( null, 6 ); // 17 
```

这种模式是最常用的，但是当我们传递像这样的值时很危险

```
foo(0, 42)
foo( 0, 42 ); // 53 <-- Oops, not 42 
```

为什么？因为`0 is falsy`, 所以`x || 11 results in 11`, 不是直接传入的 0。为了解决这个问题，有些人会改写更详细的检查，如下所示：

```
function foo(x,y) {
 x = (x !== undefined) ? x : 11;
 y = (y !== undefined) ? y : 31;
 console.log( x + y );
}
foo( 0, 42 ); // 42
foo( undefined, 6 ); // 17 
```

我们现在可以检查添加的一个很好的有用语法，`ES6`以简化将默认值分配给缺失参数的过程：

```
function foo(x = 11, y = 31) {
 console.log( x + y );
}

foo(); // 42
foo( 5, 6 ); // 11
foo( 0, 42 ); // 42
foo( 5 ); // 36
foo( 5, undefined ); // 36 <-- `undefined` is missing
foo( 5, null ); // 5 <-- null coerces to `0`
foo( undefined, 6 ); // 17 <-- `undefined` is missing
foo( null, 6 ); // 6 <-- null coerces to `0` 
```

`x = 11`在函数声明中更像是`x !== undefined ? x : 11`比更常见的习语`x || 11`

**默认值表达式**

`Function`默认值可以不仅仅是简单的值，如 31；它们可以是任何有效的表达式，甚至是`function call`：

```
function bar(val) {
 console.log( "bar called!" );
 return y + val;
}
function foo(x = y + 3, z = bar( x )) {
 console.log( x, z );
}
var y = 5;
foo(); // "bar called"
 // 8 13
foo( 10 ); // "bar called"
 // 10 15
y = 6;
foo( undefined, 10 ); // 9 10 
```

如您所见，默认值表达式是惰性求值的，这意味着它们仅在需要时运行——即，当参数的参数被省略或未定义时。

默认值表达式甚至可以是内联函数表达式调用——通常称为立即调用函数表达式`(IIFE)`：

```
function foo( x =
 (function(v){ return v + 11; })( 31 )
) {
 console.log( x );
}
foo(); // 42 
```

* * *

## 回答 #6

> 赞同：16
> 
> 时间：2015-11-16T11:29:34.743

该解决方案在 js 中对我有用：

```
function read_file(file, delete_after) {
    delete_after = delete_after || false;
    // Code
} 
```

* * *

## 回答 #7

> 赞同：12
> 
> 时间：2017-10-15T22:36:22.160

我强烈建议在 javascript 中使用默认参数值时要格外小心。当与高阶函数（如`forEach`、`map`和`reduce`. 例如，考虑这行代码：

```
['1', '2', '3'].map(parseInt); // [1, NaN, NaN] 
```

parseInt 有一个可选的第二个参数`function parseInt(s, [`**radix**`=10])`，但是 map 调用`parseInt`带有三个参数：（*element*、*index*和*array*）。

我建议您将所需参数与可选/默认值参数分开。如果您的函数需要 1、2 或 3 个必需参数，而默认值对这些参数没有意义，请将它们设为函数的位置参数，任何可选参数都应作为单个对象的命名属性跟随。如果您的函数需要 4 个或更多，那么通过单个对象参数的属性提供所有参数可能更有意义。

在您的情况下，我建议您像这样编写您的deleteFile 函数：（*根据* *评论*进行编辑）...`instead`

 *```
// unsafe
function read_file(fileName, deleteAfter=false) {
    if (deleteAfter) {
        console.log(`Reading and then deleting ${fileName}`);
    } else {
        console.log(`Just reading ${fileName}`);
    }
}

// better
function readFile(fileName, options) {
  const deleteAfter = !!(options && options.deleteAfter === true);
  read_file(fileName, deleteAfter);
}

console.log('unsafe...');
['log1.txt', 'log2.txt', 'log3.txt'].map(read_file);

console.log('better...');
['log1.txt', 'log2.txt', 'log3.txt'].map(readFile);
```

运行上面的代码片段说明了潜伏在未使用参数的默认参数值背后的危险。

* * *

## 回答 #8

> 赞同：11
> 
> 时间：2015-11-16T07:34:34.947

只需使用未定义的显式比较。

```
function read_file(file, delete_after)
{
    if(delete_after === undefined) { delete_after = false; }
} 
```

* * *

## 回答 #9

> 赞同：10
> 
> 时间：2015-10-06T16:16:21.043

作为更新...使用 ECMAScript 6，您最终可以**在**函数参数声明中设置默认值，如下所示：

```
function f (x, y = 7, z = 42) {
  return x + y + z
}

f(1) === 50 
```

正如所引用的 - [http://es6-features.org/#DefaultParameterValues](http://es6-features.org/#DefaultParameterValues)

* * *

## 回答 #10

> 赞同：9
> 
> 时间：2016-05-19T06:40:08.083

作为一个长期的C ++开发人员（Rookie to web development :)），当我第一次遇到这种情况时，我在函数定义中进行了参数分配，就像问题中提到的那样，如下所示。

```
function myfunc(a,b=10) 
```

但请注意，它不能在浏览器中一致地工作。对我来说，它适用于我桌面上的 chrome，但不适用于 android 上的 chrome。正如上面许多人提到的那样，更安全的选择是 -

```
 function myfunc(a,b)
    {
    if (typeof(b)==='undefined') b = 10;
......
    } 
```

此答案的目的不是重复其他人已经提到的相同解决方案，而是告知函数定义中的参数分配可能适用于某些浏览器，但不要依赖它。

* * *

## 回答 #11

> 赞同：8
> 
> 时间：2016-08-03T14:49:14.950

对于有兴趣让代码在 Microsoft Edge 中工作的任何人，请不要在函数参数中使用默认值。

```
function read_file(file, delete_after = false) {
    #code
} 
```

在该示例中，Edge 将抛出错误“期望')'”

为了解决这个问题

```
function read_file(file, delete_after) {
  if(delete_after == undefined)
  {
    delete_after = false;
  }
  #code
} 
```

截至 2016 年 8 月 8 日，这仍然是一个问题

* * *

## 回答 #12

> 赞同：6
> 
> 时间：2018-08-08T15:48:37.390

如果您正在使用`ES6+`，您可以通过以下方式设置默认参数：

```
function test (foo = 1, bar = 2) {
  console.log(foo, bar);
}

test(5); // foo gets overwritten, bar remains default parameter
```

如果您需要`ES5`语法，可以通过以下方式进行：

```
function test(foo, bar) {
  foo = foo || 2;
  bar = bar || 0;

  console.log(foo, bar);
}

test(5); // foo gets overwritten, bar remains default parameter
```

在上述语法中，使用了`OR`运算符。`OR`如果可以将其转换为，则运算符始终返回第一个值，否则`true`返回右侧值。当函数在没有相应参数的情况下被调用时，参数变量（`bar`在我们的示例中）`undefined`由 JS 引擎设置为。`undefined`然后转换为 false，因此`OR`运算符返回值 0。

* * *

## 回答 #13

> 赞同：5
> 
> 时间：2017-10-15T20:40:50.587

根据语法

```
function [name]([param1[ = defaultValue1 ][, ..., paramN[ = defaultValueN ]]]) {
   statements
} 
```

您可以定义形式参数的默认值。并使用**typeof**函数检查未定义的值。

* * *

## 回答 #14

> 赞同：5
> 
> 时间：2018-06-08T08:55:11.290

```
function helloWorld(name, symbol = '!!!') {
    name = name || 'worlds';
    console.log('hello ' + name + symbol);
}

helloWorld(); // hello worlds!!!

helloWorld('john'); // hello john!!!

helloWorld('john', '(>.<)'); // hello john(>.<)

helloWorld('john', undefined); // hello john!!!

helloWorld(undefined, undefined); // hello worlds!!! 
```

* * *

## 回答 #15

> 赞同：5
> 
> 时间：2018-07-05T11:54:50.113

如果您想使用最新的**`ECMA6`**语法，请使用它：

```
function myFunction(someValue = "This is DEFAULT!") {
  console.log("someValue --> ", someValue);
}

myFunction("Not A default value") // calling the function without default value
myFunction()  // calling the function with default value
```

它被称为[`default function parameters`](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Functions/Default_parameters)。如果没有传递任何值或未定义，它允许使用默认值初始化形式参数。 **注意**：它不适用于 Internet Explorer 或更旧的浏览器。

为了最大可能的**兼容性**，请使用：

```
function myFunction(someValue) {
  someValue = (someValue === undefined) ? "This is DEFAULT!" : someValue;
  console.log("someValue --> ", someValue);
}

myFunction("Not A default value") // calling the function without default value
myFunction()  // calling the function with default value
```

这两个函数具有完全相同的行为，因为这些示例中的每一个都依赖于这样一个事实，即`undefined`如果在调用该函数时没有传递参数值，则参数变量将是。

* * *

## 回答 #16

> 赞同：5
> 
> 时间：2018-08-12T05:26:12.997

**ES6：**正如大多数答案中已经提到的，在 ES6 中，您可以简单地初始化一个参数和一个值。

* * *

**ES5：**大多数给定的答案对我来说都不够好，因为在某些情况下我可能不得不将虚假值传递给函数，例如`0`,`null`和`undefined`。要确定参数是否未定义，因为那是我传递的值而不是由于根本没有定义而未定义的值，我这样做：

```
function foo (param1, param2) {
   param1 = arguments.length >= 1 ? param1 : "default1";
   param2 = arguments.length >= 2 ? param2 : "default2";
} 
```

* * *

## 回答 #17

> 赞同：4
> 
> 时间：2018-07-01T08:50:53.460

```
function throwIfNoValue() {
throw new Error('Missing argument');
}
function foo(argValue = throwIfNoValue()) {
return argValue ;
}
```

这里 foo() 是一个函数，它有一个名为 argValue 的参数。如果我们在此处的函数调用中不传递任何内容，则将调用函数 throwIfNoValue()，并将返回的结果分配给唯一的参数 argValue。这就是函数调用可以用作默认参数的方式。这使代码更加简化和可读。

[这个例子取自这里](http://anjandutta.com/javascript-es6-default-parameter/)

* * *

## 回答 #18

> 赞同：3
> 
> 时间：2018-10-10T07:04:59.637

如果由于某种原因您**不在**ES6 上并且**在**这里使用[`lodash`](https://lodash.com/)的是通过方法默认函数参数的简洁[`_.defaultTo`](https://lodash.com/docs/4.17.10#defaultTo)方法：

```
var fn = function(a, b) {
  a = _.defaultTo(a, 'Hi')
  b = _.defaultTo(b, 'Mom!')

  console.log(a, b)
}

fn()                 // Hi Mom!
fn(undefined, null)  // Hi Mom!
fn(NaN, NaN)         // Hi Mom!
fn(1)                // 1 "Mom!"
fn(null, 2)          // Hi 2
fn(false, false)     // false false
fn(0, 2)             // 0 2
```

```
<script src="https://cdnjs.cloudflare.com/ajax/libs/lodash.js/4.17.11/lodash.min.js"></script>
```

如果当前值为**NaN**、**null**或**undefined ，它将设置默认值**

* * *

## 回答 #19

> 赞同：3
> 
> 时间：2019-01-18T07:29:01.423

是的，**ES6**完全支持使用默认参数：

```
function read_file(file, delete_after = false) {
  // Code
} 
```

或者

```
const read_file = (file, delete_after = false) => {
    // Code
} 
```

但是在**ES5**之前你可以很容易地做到这一点：

```
function read_file(file, delete_after) {
  var df = delete_after || false;
  // Code
} 
```

这意味着如果该值存在，则使用该值，否则，在`||`执行相同操作的操作后使用第二个值...

**注意：如果您将一个值传递给****ES6**一个值，即使该值是虚假的，这也有很大的不同，它将被替换为新值，类似于`null`or `""`... 但**ES5**仅在只有传递的值时才会被替换是真的，那是因为`||`工作方式......

* * *

## 回答 #20

> 赞同：3
> 
> 时间：2019-10-17T20:22:46.980

## 未来之声

将来，您将能够将一个对象“传播”到另一个对象（从 2019 年开始[，Edge 不支持](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Operators/Spread_syntax#Spread_in_object_literals)！） - 演示如何将其用于不错的默认选项，而不管顺序如何：

```
function test(options) {
    var options = {
       // defaults
       url: 'defaultURL',
       some: 'somethingDefault',
       // override with input options
       ...options
    };

    var body = document.getElementsByTagName('body')[0];
    body.innerHTML += '<br>' + options.url + ' : ' + options.some;
}
test();
test({});
test({url:'myURL'});
test({some:'somethingOfMine'});
test({url:'overrideURL', some:'andSomething'});
test({url:'overrideURL', some:'andSomething', extra:'noProblem'});
```

MDN 参考：[https ://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Operators/Spread_syntax](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Operators/Spread_syntax)

...与此同时，[Edge 支持的是 Object.assign()](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object/assign#Browser_compatibility)（IE 不支持，但我真的希望我们可以将 IE 抛在后面 :)）

同样你可以做

```
 function test(options) {
        var options = Object.assign({
           // defaults
           url: 'defaultURL',
           some: 'somethingDefault',
        }, options); // override with input options

        var body = document.getElementsByTagName('body')[0];
        body.innerHTML += '<br>' + options.url + ' : ' + options.some;
    }
    test();
    test({});
    test({url:'myURL'});
    test({some:'somethingOfMine'});
    test({url:'overrideURL', some:'andSomething'});
    test({url:'overrideURL', some:'andSomething', extra:'noProblem'});
```

**编辑：**由于关于`const`选项的评论 - 在函数的其余部分使用常量选项的问题实际上**不是**你不能这样做，只是你不能在自己的声明中使用常量变量 - 你会有将输入命名调整为类似

```
function test(input_options){
   const options = {
     // defaults
     someKey:    'someDefaultValue',
     anotherKey: 'anotherDefaultValue',

     // merge-in input options
     ...input_options
   };

   // from now on use options with no problem
} 
```

* * *

## 回答 #21

> 赞同：2
> 
> 时间：2019-12-19T08:39:04.180

只是为了展示我的技能（大声笑），即使没有命名参数也可以编写上述函数，如下所示：

**ES5 及以上**

```
function foo() {
    a = typeof arguments[0] !== 'undefined' ? a : 42;
    b = typeof arguments[1] !== 'undefined' ? b : 'default_b';
    ...
} 
```

**ES6 及以上**

```
function foo(...rest) {
    a = typeof rest[0] !== 'undefined' ? a : 42;
    b = typeof rest[1] !== 'undefined' ? b : 'default_b';
    ...
} 
```

* * *

## 回答 #22

> 赞同：1
> 
> 时间：2018-09-27T16:56:00.567

是的，这被称为默认参数

如果未传递任何值或未定义，则默认函数参数允许使用默认值初始化形式参数。

句法：

```
function [name]([param1[ = defaultValue1 ][, ..., paramN[ = defaultValueN ]]]) {
   statements
} 
```

**描述：**

函数的参数默认为 undefined 但是，在某些情况下，设置不同的默认值可能很有用。这是默认参数可以提供帮助的地方。

过去，设置默认值的一般策略是在函数体中测试参数值，如果它们未定义，则为其赋值。如果调用中未提供任何值，则其值将是未定义的。您必须设置条件检查以确保参数未定义

使用 ES2015 中的默认参数，不再需要在函数体中进行检查。现在您可以简单地在函数头中放置一个默认值。

差异示例：

```
// OLD METHOD
function multiply(a, b) {
  b = (typeof b !== 'undefined') ?  b : 1;
  return a * b;
}

multiply(5, 2); // 10
multiply(5, 1); // 5
multiply(5);    // 5

// NEW METHOD
function multiply(a, b = 1) {
  return a * b;
}

multiply(5, 2); // 10
multiply(5, 1); // 5
multiply(5);    // 5 
```

**不同的语法示例：**

填充未定义与其他虚假值：

即使在调用时显式设置了值，num 参数的值也是默认值。

```
function test(num = 1) {
  console.log(typeof num);
}

test();          // 'number' (num is set to 1)
test(undefined); // 'number' (num is set to 1 too)

// test with other falsy values:
test('');        // 'string' (num is set to '')
test(null);      // 'object' (num is set to null) 
```

在通话时评估：

默认参数在调用时进行评估，因此与其他一些语言不同，每次调用函数时都会创建一个新对象。

```
function append(value, array = []) {
  array.push(value);
  return array;
}

append(1); //[1]
append(2); //[2], not [1, 2]

// This even applies to functions and variables
function callSomething(thing = something()) {
 return thing;
}

function something() {
  return 'sth';
}

callSomething();  //sth 
```

默认参数可用于以后的默认参数：

已经遇到的参数可用于以后的默认参数

```
function singularAutoPlural(singular, plural = singular + 's',
                        rallyingCry = plural + ' ATTACK!!!') {
  return [singular, plural, rallyingCry];
}

//["Gecko","Geckos", "Geckos ATTACK!!!"]
singularAutoPlural('Gecko');

//["Fox","Foxes", "Foxes ATTACK!!!"]
singularAutoPlural('Fox', 'Foxes');

//["Deer", "Deer", "Deer ... change."]
singularAutoPlural('Deer', 'Deer', 'Deer peaceably and respectfully \ petition the government for positive change.') 
```

函数体内定义的函数：

在 Gecko 33 (Firefox 33 / Thunderbird 33 / SeaMonkey 2.30) 中引入。在函数体中声明的函数不能在默认参数中被引用并抛出一个 ReferenceError（当前是 SpiderMonkey 中的一个 TypeError，参见 bug 1022967）。默认参数总是首先执行，然后函数体内的函数声明求值。

```
// Doesn't work! Throws ReferenceError.
function f(a = go()) {
  function go() { return ':P'; }
} 
```

默认参数后无默认参数：

在 Gecko 26 (Firefox 26 / Thunderbird 26 / SeaMonkey 2.23 / Firefox OS 1.2) 之前，以下代码会导致 SyntaxError。这已在错误 777060 中修复，并在以后的版本中按预期工作。参数仍然从左到右设置，覆盖默认参数，即使后面有没有默认的参数。

```
function f(x = 1, y) {
  return [x, y];
}

f(); // [1, undefined]
f(2); // [2, undefined] 
```

具有默认值分配的解构参数：

您可以将默认值赋值与解构赋值表示法一起使用

```
function f([x, y] = [1, 2], {z: z} = {z: 3}) {
  return x + y + z;
}

f(); // 6 
```

* * *

## 回答 #23

> 赞同：1
> 
> 时间：2021-05-03T18:30:12.063

我注意到一些答案提到使用默认参数不能移植到其他浏览器，但公平地指出，您可以使用 Babel 之类的编译器将代码转换为 ES5 语法，用于对现代 JS 支持有限的浏览器特征。

所以这：

```
function read_file(file, delete_after = false) {
  // Code
} 
```

[将被编译成这样（在 Babel REPL -> https://babeljs.io/repl/](https://babeljs.io/repl/)中尝试一下）：

```
"use strict";

function read_file(file) {

  var delete_after =
    arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : false;

  //Code...

} 
```

当然，如果您不打算使用转译，那么像其他人演示的那样在函数体中设置默认参数也很好。

* * *

## 回答 #24

> 赞同：0
> 
> 时间：2018-09-24T23:02:55.887

```
def read_file(file, delete_after = false)
  # code
end 
```

以下代码可能适用于这种情况，包括 ECMAScript 6 (ES6) 以及早期版本。

```
function read_file(file, delete_after) {
    if(delete_after == undefined)
        delete_after = false;//default value

    console.log('delete_after =',delete_after);
}
read_file('text1.txt',true);
read_file('text2.txt');
```

当调用时跳过函数的参数值时，语言中的默认值起作用，在 JavaScript 中，它被分配给**undefined**。这种方法在编程上看起来并不吸引人，但具有**向后兼容性**。

* * *

## 回答 #25

> 赞同：0
> 
> 时间：2019-06-13T09:26:15.587

设置默认参数的另一种方法是使用参数的对象映射，而不是直接使用参数。例如，

```
const defaultConfig = {
 category: 'Animals',
 legs: 4
};

function checkOrganism(props) {
 const category = props.category || defaultConfig.category;
 const legs = props.legs || defaultConfig.legs;
} 
```

这样，很容易扩展参数，而不必担心参数长度不匹配。

* * *

## 回答 #26

> 赞同：0
> 
> 时间：2019-07-16T16:26:40.293

答案是肯定的。事实上，支持默认参数的语言有很多。Python就是其中之一：

```
def(a, enter="Hello"):
   print(a+enter) 
```

尽管由于括号这是 Python 3 代码，但函数中的默认参数也适用于 JS。

例如，在您的情况下：

```
function read_file(file, deleteAfter=false){
  console.log(deleteAfter);
}

read_file("test.txt");
```

但有时你并不真的需要默认参数。

您可以在函数开始后立即定义变量，如下所示：

```
function read_file(file){
  var deleteAfter = false;
  console.log(deleteAfter);
}

read_file("test.txt");
```

在我的两个示例中，它返回相同的内容。但有时它们实际上可能很有用，比如在非常高级的项目中。

所以，总而言之，在 JS 中可以使用默认参数值。但这与在函数开始后立即定义变量几乎相同。但是，有时它们仍然非常有用。您可能已经注意到，默认参数值比在函数开始后立即定义参数的标准方法少了 1 行代码。

***编辑：***这非常重要！这在 IE 中不起作用*。*请参阅[文档](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Functions/Default_parameters#Browser_compatibility)。因此，对于 IE，您必须使用“在函数顶部定义变量”方法。默认参数在 IE 中不起作用。

* * *

## 回答 #27

> 赞同：0
> 
> 时间：2020-06-30T14:30:04.083

# 是的 - 证明：

```
function read_file(file, delete_after = false) {
  // Code
  console.log({file,delete_after});
}

// TEST
read_file("A");
read_file("B",true);
read_file("C",false);
```

* * *

## 回答 #28

> 赞同：0
> 
> 时间：2021-07-26T12:12:59.173

```
export const getfilesize = (bytes, decimals = 2) => {
    if (bytes === 0){ 
        return '0 Bytes';
    }else{
        const k = 1024;
        const dm = decimals < 0 ? 0 : decimals;
        const sizes = ['Bytes', 'KB', 'MB', 'GB', 'TB', 'PB', 'EB', 'ZB', 'YB'];
        const i = Math.floor(Math.log(bytes) / Math.log(k));
        return parseFloat((bytes / Math.pow(k, i)).toFixed(dm)) + ' ' + sizes[i];

    }
} 
```

* * *

## 回答 #29

> 赞同：-3
> 
> 时间：2016-07-19T11:59:31.997

是的，这将在 Javascript 中工作。你也可以这样做：

```
function func(a=10,b=20)
{
    alert (a+' and '+b);
}

func(); // Result: 10 and 20

func(12); // Result: 12 and 20

func(22,25); // Result: 22 and 25 
```

# python - Python中的循环依赖

> ID：894864
> 
> 赞同：82
> 
> 时间：2009-05-21T20:08:08.110
> 
> 标签：python, circular-dependency

我有两个文件`node.py`和`path.py`，它们分别定义了两个类`Node`和`Path`。

到今天为止，`Path`引用`Node`对象的定义，因此我做了

```
from node.py import * 
```

在`path.py`文件中。

但是，截至今天，我为`Node`引用该`Path`对象创建了一个新方法。

尝试导入时遇到问题`path.py`：我试过了，当程序运行并调用`Path`使用的方法时，出现了一个关于未定义`Node`的异常。`Node`

我该怎么办？

* * *

## 回答 #1

> 赞同：121
> 
> 时间：2009-05-21T20:11:55.547

*[Importing Python Modules](https://web.archive.org/web/20150113060057/http://effbot.org/zone/import-confusion.htm)*是一篇很棒的文章，它解释了 Python 中的循环导入。

解决此问题的最简单方法是将路径导入移动到节点模块的末尾。

* * *

## 回答 #2

> 赞同：30
> 
> 时间：2016-06-14T13:05:35.567

另一种方法是仅在另一个需要它**的功能**中导入两个模块中的一个。当然，如果您只在一个或少数几个函数中需要它，这会最有效：

```
# in node.py 
from path import Path
class Node 
    ...

# in path.py
class Path
  def method_needs_node(): 
    from node import Node
    n = Node()
    ... 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2019-11-04T04:46:54.707

您可能不需要导入`Path`以`node.py`供`Path`彼此`Node`使用。

```
# in __init__.py  (The order of imports should not matter.)
from .node import Node
from .path import Path

# in path.py 
from . import Node
class Path
  ...

  def return_something_pathy(self): 
    ...

# in node.py
class Node
  def __init__(self, path): 
    self.path = path
    ...

  def a_node_method():
    print(self.path.return_something_pathy()) 
```

为了清楚地表明`Node`正在使用`Path`，添加类型提示。从 Python 3.7 开始有一个功能可以支持类型注释中的前向引用，如[PEP 563](https://www.python.org/dev/peps/pep-0563/)中所述。

```
# in node.py  (Now with type hinting.)
from __future__ import annotations

class Node
  def __init__(self, path: Path): 
    self.path = path
    ...

  def a_node_method():
    print(self.path.return_something_pathy()) 
```

*[我遇到了另一个解决方案，可以让您摆脱 Python 中的循环导入漏洞，](https://www.stefaanlippens.net/circular-imports-type-hints-python.html)*这是一篇很棒的博客文章，它教会了我这一点。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2019-02-27T15:42:07.803

我更喜欢通过在另一个依赖类的构造函数中声明一个依赖项来打破循环依赖项。在我看来，这使代码更整洁，并且可以轻松访问所有需要依赖项的方法。

所以就我而言，我有一个相互依赖的 CustomerService 和一个 UserService。我打破循环依赖如下：

```
class UserService:

    def __init__(self):
        # Declared in constructor to avoid circular dependency
        from server.portal.services.admin.customer_service import CustomerService
        self.customer_service = CustomerService()

    def create_user(self, customer_id: int) -> User:
        # Now easy to access the dependency from any method
        customer = self.customer_service.get_by_id(customer_id) 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2021-10-27T09:15:32.183

另一种方法是在同一个模块中定义它们，并延迟定义类型。有点像这样：

```
class Node:
   _path_type: type = None

   def method_needs_path(self):
       p = self._path_type()
       ...

class Path:
    def method_needs_node(self):
       n = Node()

Node._path_type = Path 
```

对此保持对称可能会更好：

```
class Node:
   _path_type: type = None

   def method_needs_path(self):
       p = self._path_type()
       ...

class Path:
    _node_type: type = None

    def method_needs_node(self):
       n = Node()

Node._path_type = Path
Path._node_type = Node 
```

这也可以在多个模块中完成：

```
# in node.py
class Node:
   _path_type: type = None

   def method_needs_path(self):
       p = self._path_type()
       ...

# in path.py
from .node import Node

class Path:
    _node_type: type = None

    def method_needs_node(self):
       n = self._node_type()

Node._path_type = Path
Path._node_type = Node

# in __init__.py (note that order is important now)
from .node import Node
from .path import Path 
```

# asp.net - ASP.NET MVC 是否注定要取代 Webforms？

> ID：894865
> 
> 赞同：7
> 
> 时间：2009-05-21T20:08:28.330
> 
> 标签：asp.net, asp.net-mvc, webforms

我发现了这些问题，但其中有几个有点老：

[https://stackoverflow.com/questions/191556/should-i-pursue-asp-net-webforms-or-asp-net-mvc](https://stackoverflow.com/questions/191556/should-i-pursue-asp-net-webforms-or-asp-net-mvc) [你认为 ASP.NET MVC 会与 ASP.NET Webforms 竞争吗？](https://stackoverflow.com/questions/88787/do-you-think-asp-net-mvc-will-compete-with-asp-net-webforms) [ASP.NET MVC > ASP.NET WebForms，为什么？](https://stackoverflow.com/questions/722637/asp-net-mvc-asp-net-webforms-why)

我不相信这些是重复的，并且可能已经足够老了，可以散发出新的光芒。如果没有，请关闭它。

我知道没有一种框架或语言一定是每项工作的唯一工具。但是，您是否看到 MVC 超越了 Web 表单，或者 Web 表单在 Microsoft 的优先级列表中变得更低？他们将不得不长期保留网络表单，因为有很多人投资于它，但他们不必继续为其添加新功能。

我不知道这是否是一个很好的例子，但它让我想起了 Web 部件。我从来没有看到微软对它有太大的改进。它有效，我认为它很棒，直到我开始真正尝试并从中获得很多。然后从我所见，微软并没有那么追求它，尽管它留在了 Visual Studio 中。也许这是一个不好的例子；正是我记得的。

编辑：另外，如果有人对此主题有任何来自 Microsoft 的声明，我们将不胜感激。没有冒犯任何人。我只希望官方的东西。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-05-21T20:16:11.090

这个微软回答：

> ASP.NET MVC 提供了一个框架，使您能够轻松地为 Web 应用程序实现模型-视图-控制器 (MVC) 模式。此模式允许您将应用程序分离为松散耦合的可插拔组件，用于应用程序设计、处理逻辑和显示。
> 
> ASP.NET MVC 不是 Webforms 的替代品。它在设计 Web 应用程序时提供了另一种选择。使用 ASP.NET MVC 具有以下优点：
> 
> • 它使您能够实现并保持清晰的关注点分离
> 
> • 它有利于测试驱动开发 (TDD)
> 
> • 它提供了对您在应用程序中发布的 URL 和应用程序发出的 HTML 的更多控制

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2009-05-21T20:17:19.950

他们都有不同的优势。

MVC 非常适合对 html 和页面生命周期进行精确控制很重要的公共 Internet 站点。

Webforms 非常适合企业局域网内联网站点，在这些站点中，开发速度至关重要，Web 服务器的上游带宽充足，但服务器上的内存更受限制。

老实说，可能有更多的 asp.net 程序员在做后者而不是前者。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-05-21T20:13:55.353

WebForms 不会消失。Microsoft 为其开发人员提供了一种在传统的 asp.net 编程和流行的 MVC 编程方式之间进行选择的方法。它不与网络表单竞争，它只是开发人员使用的另一种选择。微软采取了非常聪明的举措，以保持其开发人员基础。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-05-21T21:52:38.853

我认为 ASP.NET MVC 允许构建更多可维护的应用程序。它还允许对很大一部分代码进行自动化测试。

如果一个网站的大小合理和/或将有一个合理的生命周期，那么 MVC 就可以发挥很好的作用。

我理解公共网站的 SEO 论点，但我认为 MVC 的好处使其成为甚至 Intranet 应用程序的绝佳候选者。也许通过一些好的集合用户控件，即帮助方法，MVC 可以开始主导该领域。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-05-21T20:17:17.033

我相信开发人员的兴趣重点将转向 MVC。

至于实际使用场景，WebForms 可能会继续用于应用程序，而不是“封闭”的站点，而 MVC 将是那些面向公众（和搜索引擎，是的）站点的首选。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-21T20:15:52.043

就像其他一切一样，我认为进一步的发展将取决于它的受欢迎程度。使用它的人越多，微软可能就会越多地投资于它的未来。

它似乎已经很流行了，从其他语言（例如 struts 或 rails）中类似框架的流行度来看，我认为它会继续流行。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-05-22T19:22:51.693

看我上次的回复：

> [ASP.NET MVC 是否被扫地出门为 MVC 腾出空间？](https://stackoverflow.com/questions/200256/is-asp-net-webforms-swept-under-the-rug-to-make-room-for-mvc/516836#516836)

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2010-04-05T05:58:02.177

我相信 ASP.NET MVC 并不是要取代 WebForms。

相反，它将为希望在开发时考虑到逻辑和视图分离以及性能和易用性的 ASP.NET 开发人员提供替代方案。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2011-02-02T20:46:11.320

.Net 的引入对于掌握了 VbScript、ASP Classic 并且成为少数可以在 Visual InterDev 中实际调试的精英的开发人员来说是不利的。

MVC 对那些只继续使用 WebForms 的人来说是不利的。

差不多到这个时候，你应该能够认出写在墙上的手，关于从长矛上下来的东西。

# javascript - HTML 自定义属性在 Chrome 中不起作用

> ID：894866
> 
> 赞同：2
> 
> 时间：2009-05-21T20:08:37.283
> 
> 标签：javascript, html, google-chrome

**使用 HTML 自定义属性时，它在 Chrome 中不起作用。**

我的意思是，假设我有这个 HTML：

```
<div id="my_div" my_attr="1"></div> 
```

如果我尝试在 Chrome 中使用 JavaScript 获取此属性，我会得到*未定义*

```
alert( document.getElementById( "my_div" ).my_attr ); 
```

在 IE 中它工作得很好。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-05-21T20:28:51.453

通过 getAttribute() 检索它：

```
alert(document.getElementById( "my_div" ).getAttribute("my_attr")); 
```

在 IE、FF 和 Chrome 上对我来说都很好。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-21T20:13:35.497

IE 是我见过的唯一一个尊重不符合 HTML DTD 模式的属性的浏览器。

[http://www.webdeveloper.com/forum/showthread.php?t=79429](http://www.webdeveloper.com/forum/showthread.php?t=79429)

但是，如果您愿意编写自定义 DTD，则可以使用它。

这是一篇很好的文章，可以开始朝这个方向发展：

*   [http://www.alistapart.com/articles/scripttriggers/](http://www.alistapart.com/articles/scripttriggers/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2011-03-25T05:09:32.420

Safari 遇到了同样的问题，使用 getAttribute(..) 创造了魔力。它看起来像跨浏览器兼容。这是一篇不错的文章[http://www.javascriptkit.com/dhtmltutors/customattributes.shtml](http://www.javascriptkit.com/dhtmltutors/customattributes.shtml)

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2009-05-21T20:14:51.343

您是否声明您的页面符合 XHTML 标准？如果你这样做，你就不能随意向元素添加新属性。我的理解是有办法（毕竟，ASP.NET 成功了），但你必须发出各种垃圾（自定义模式？）。我不熟悉细节。

# actionscript-3 - ActionScript 中的 TimeDelta 类？

> ID：894872
> 
> 赞同：0
> 
> 时间：2009-05-21T20:09:50.637
> 
> 标签：actionscript-3

是否有任何代表“持续时间”的 ActionScript 类，类似于 Python 中的 TimeDelta 类？

**编辑**：感谢您的回复。不过，我应该澄清一下：我希望能够提出诸如“date0 和 date1 之间有多少周”或“让`x`代表“一天”之类的问题。什么是`date2 + x`？”

我知道我可以通过将日期表示为时间戳来完成所有这些操作......但我希望能找到更好的东西。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-21T20:14:00.813

您可以在 Date 类中使用 time() 来获取 unix 时代的毫秒数并将其用于时间增量。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-21T20:14:41.220

如果减去两个日期：

```
var dateDiff = date1 - date2; 
```

dateDiff 将保存两个日期之间的毫秒数。然后，您可以将毫秒转换为您喜欢的任何有用的数字。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-21T20:16:40.480

我认为 Actionscript 3 中没有测量时间变化的类。根据关于[Actionscript Adventures 的](http://www.adventuresinactionscript.com/blog/27-07-2008/accurate-timing-with-actionscript-3)这篇博客文章，网络上的 Flash 播放器的计时非常不准确。那篇文章信息量很大，并且有一个名为 SuperTimer 的类可能会对您有所帮助。如果使用 Justin Niessner 和 toastie 提出的解决方案，您可能需要牢记这种不准确性。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-22T07:31:04.867

[我在这个问题](https://stackoverflow.com/questions/169201/actionscript-3-0-calculate-timespan-between-two-dates/457213#457213)上发布了 .NET TimeSpan 类的完整 AS3 端口，听起来完全符合您的需要。

```
// 5 days from new
var ts : TimeSpan = TimeSpan.fromDays(5);
var now : Date = new Date();
var fiveDaysTime : Date = ts.add(now);

// Diff between dates
var d1 : Date = new Date(2009, 1, 1);
var d2 : Date = new Date(2009, 1, 6);
var ts : TimeSpan = TimeSpan.fromDates(d1, d2); 
```

# oop - Zend_Form 和 Liskov 替换原则

> ID：894873
> 
> 赞同：2
> 
> 时间：2009-05-21T20:09:57.593
> 
> 标签：oop, zend-framework, liskov-substitution-principle

我看到的一个非常常见的模式（我选择 Zend Framework，只是因为我在这个问题的那一刻正在处理它），是这样的：

```
class My_Form extends Zend_Form {
     public function init() {
          $this->addElement();
     }
} 
```

Zend_Form 不是一个抽象类，但完全可以单独使用。这似乎被“推荐”为将您的表单“封装”成一个不错的类的地方。

这是否违反了 Liskov 替换原则？Zend_Form 的每个子类都将具有与基类截然不同的行为。为此使用组合会更好，还是我完全误解了这个原则？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-06-09T22:03:02.477

Zend_Form 是为继承而设计的。在使用 Zend_Form 时，每个人都应该牢记这一点——实际上它不是必需的 Zend_Form，但可能是它的子类。因此，如果任何程序依赖 Zend_Form 来完全按照它的方式运行，而不是按照它的子类可以运行的方式 - 该程序是错误的。正如 Liskov 原则所说，它不是“使用基类”，而是在滥用它。

Zend_Form 主要由 Zend 框架使用，我确信它正确使用它。

我认为对于此类为继承而设计并用作基于某些框架的应用程序构建块的类，“行为”的定义应该更加抽象——将一些细节留给子类，即使类本身不是抽象的。我会说 Zend_Form 的行为是“呈现**一些**html 并使用**一些**验证规则”。在这个意义上， Zend_Form 的所有子类都以相同的方式表现。Zend_Form 非抽象只是定义了默认行为，使其更易于使用。

另外为了让它更学术一点，我可以从中做两节课。一个应该是抽象的——所有形式的基类。另一个空表单，它的行为与 Zend_Form 现在的行为完全相同，并且可以单独使用。所以它会像

```
// sorry, I don't like PHP so here goes java 
public abstract class ZendForm{/*implementation here and NO abstract methods*/} 
public final class DefaultZendForm extends ZendForm{/*nothing here*/} 
```

这将消除对 Liskov 原则的任何混淆，但可能不会为程序增加任何实际价值。

子类应该与超类有所不同，否则创建子类没有意义。而且您总是可以滥用这种差异并编写一个适用于超类而对子类失败的程序。但这不合理。完全呈现默认（空）表单不是 Zend_Form 合同的一部分。只有属于类契约的行为才是 LSP 的主题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-21T20:38:05.960

> Liskov 的替换原则指出，如果程序模块正在使用 Base 类，那么对 Base 类的引用可以替换为 Derived 类，而不会影响程序模块的功能。

那么 MyForm 与 ZendForm 有什么不同呢？它会改变程序的功能吗？

另外，检查这 2 个项目符号（来自[Wikipedia 文章](http://en.wikipedia.org/wiki/Liskov_substitution_principle)）：

> *   不能在子类中加强先决条件。
> *   后置条件不能在子类中被削弱。

也许您会发现 MyForm 与 ZendForm 并没有太大的不同，您可以安全地使用继承。

# iphone - 如何设置 UITableView 的背景（tableview 样式为“Grouped”）以使用图像？

> ID：894875
> 
> 赞同：56
> 
> 时间：2009-05-21T20:10:06.500
> 
> 标签：iphone

如何设置 UITableView 的背景（tableview 样式为“Grouped”）以使用图像？

* * *

## 回答 #1

> 赞同：155
> 
> 时间：2010-05-01T00:44:39.830

在较新版本的 SDK 中，您需要设置`tableView.backgroundView`是否希望它是透明的，请尝试以下操作：

```
tableView.backgroundColor = [UIColor clearColor];
tableView.opaque = NO;
tableView.backgroundView = nil; 
```

* * *

## 回答 #2

> 赞同：18
> 
> 时间：2010-02-09T13:19:45.010

我们需要对这个简单的背景做点什么。我们将使用 PNG 图像并将其显示在 UITableView 后面。

1.  准备一个PNG图像。它应该是 320x460（如果您的应用中有状态栏可见）或 320x480（如果您隐藏它）。
2.  将其拖入 XCode 中的 Resources 文件夹并添加到您的项目中
3.  将包含 UITableView 的 NIB 文件加载到 Interface Builder 中
4.  打开库（Tools>Library），切换到Media选项卡，将图片拖到View中，新建一个UIImageView。
5.  使用检查器移动和调整图像大小，使其位于 X=0, Y=0, Width=320, Height=480
6.  将 UIImageView 放在 UITableView 后面（Layout > Send to Back）
7.  保存，构建并开始！

令人失望的是，您将无法看到您的背景。UITableView 的背景阻止我们看到 UIImageView。您需要进行三项更改：

1.  在 Attributes Inspector 中，确保 UITableView 的“不透明”复选框未选中！
2.  将 UITableView 的背景颜色设置为透明：

    tableView.backgroundColor = [UIColor clearColor];

我希望这有助于并解决您的问题。它对我有用，我还没有找到一种更优雅的方式来显示 UITableView 的背景图像。

与直接在 UITableView 上设置背景图像相比，我的解决方案的优点是您可以缩进表格的内容。我经常想这样做只是在屏幕底部显示两个或三个表格单元格。

* * *

## 回答 #3

> 赞同：12
> 
> 时间：2009-05-21T20:56:45.097

```
[tableView setBackgroundColor:[UIColor colorWithPatternImage:[UIImage imageNamed:@"whatever.png"]]]; 
```

* * *

## 回答 #4

> 赞同：9
> 
> 时间：2011-11-22T12:27:10.753

tableView.backgroundView = nil; 足够的。无需将背景颜色设置为清除颜色。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2010-08-01T06:00:38.253

在 UI Builder 中，背景颜色有一个“其他”选项。这带来了一个颜色选择器。颜色选择器具有不透明度设置。如果将 COLOR 的不透明度设置为 0，它可以工作，不能说明性能。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-05-21T20:16:53.930

一种方法是使表格视图透明（将视图的背景设置为 0% 不透明度）并在 UITableView 后面放置一个 UIImageView。请记住，透明表格和表格单元格的性能不如不透明的表格。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-11-09T19:28:45.940

我发现您必须使用具有透明背景的“普通”样式表，然后通过将每个单元格的 backgroundView 设置为 UIImageView 并使用模拟圆形外观的图像来重新创建圆角单元格的外观。这意味着顶部、底部和中间单元格需要不同的背景图像。

但是，这并没有解决当用户点击单元格并“突出显示”时会发生什么 - 它会看起来是方形的。您可以通过为伪造的表格单元格背景图像设置突出显示的图像来解决此问题。您还需要创建自己的带有白色突出显示版本的披露附件视图 (ImageView)。然后你可以创建一个像我正在使用的单元格（下图）。在分配这些单元之一之后，我将 backgroundView 和 accessoryView 设置为我的 UIImageViews。

```
#import "ClearBackRoundedTableCell.h"

@implementation ClearBackRoundedTableCell

- (id)initWithReuseIdentifier:(NSString *)reuseIdentifier 
{
    if (self = [super initWithStyle:UITableViewCellStyleDefault reuseIdentifier:reuseIdentifier]) {
    }
    return self;
}

-  (void)setHighlighted:(BOOL)highlighted animated:(BOOL)animated
{
    if( [[self.accessoryView class] isSubclassOfClass:[UIImageView class]] )
        ((UIImageView *)self.accessoryView).highlighted = highlighted;

    if( [[self.backgroundView class] isSubclassOfClass:[UIImageView class]] )
        ((UIImageView *)self.backgroundView).highlighted = highlighted;

    self.textLabel.highlighted = highlighted;
}

@end 
```

如果您走这条路线，请注意：分组表格中的单元格通常为 300 像素宽（纵向模式），但您的普通表格需要为 302 宽，以允许表格每一侧的灰线，即通常在表格单元格的“内容”之外。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2011-08-16T16:35:57.250

在使用颜色选择器一段时间后，我发现您不需要为表格视图单元格xib***指定不透明背景，而是******为***单元格所在的表格视图指定不透明背景，这是另一个 xib。据我所知，表格视图单元格背景属性没有视觉效果。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2013-07-12T05:14:33.530

将 UITableview 背景设置为清晰的颜色。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2012-12-07T14:30:23.737

try this one

```
UIView *backView = [[[UIView alloc] initWithFrame:CGRectZero] autorelease];
backView.backgroundColor = [UIColor clearColor];
cell.backgroundView = backView; 
```

It worked for me in grouped tableview.

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2013-08-07T07:23:51.687

如果您的图像被添加到您的资源中，您可以通过编程方式执行此操作：

```
self.tableView.backgroundColor = [UIColor clearColor];
self.tableView.opaque = NO;
UIImage *backroundImage = [UIImage imageNamed:@"my_backround"];
UIImageView *backroundImageView = [[UIImageView alloc] initWithImage:backroundImage]; 
```

否则，您可以使用以下样式在 Interface Builder 中执行此操作：

![IB tableview，后面有图像](https://i.stack.imgur.com/jCvQO.png)

您可能需要配置从 UITableViewController 到 UIViewController 的头文件接口并添加`<UITableViewDataSource,UITableViewDelegate>`，也不要忘记将 tableview 的属性设置为不透明并将 tableviews 数据源和委托出口重新连接到 viewcontroller。

# gtk - 为什么我的 gtk 应用程序加载时会自动选择第一个工具栏按钮？

> ID：894876
> 
> 赞同：1
> 
> 时间：2009-05-21T20:10:40.243
> 
> 标签：gtk, pygtk, glade

当我的 gtk 应用程序加载时，工具栏上的第一个项目被自动选择（它被突出显示，当它按 enter 时被按下）。这只是一个小问题，但我希望默认情况下不选择任何内容。

这是一些基本的示例代码：

```
import gtk
import gtk.glade

window_tree = gtk.glade.XML('testtoolbar.glade')

gtk.main() 
```

测试工具栏.glade

```
<?xml version="1.0"?>
<glade-interface>
  <!-- interface-requires gtk+ 2.16 -->
  <!-- interface-naming-policy project-wide -->
  <widget class="GtkWindow" id="window1">
    <property name="width_request">200</property>
    <property name="visible">True</property>
    <child>
      <widget class="GtkToolbar" id="toolbar1">
        <property name="visible">True</property>
        <child>
          <widget class="GtkToolButton" id="toolbutton1">
            <property name="visible">True</property>
            <property name="label" translatable="yes">toolbutton1</property>
            <property name="use_underline">True</property>
            <property name="stock_id">gtk-new</property>
          </widget>
          <packing>
            <property name="expand">False</property>
            <property name="homogeneous">True</property>
          </packing>
        </child>
        <child>
          <widget class="GtkToolButton" id="toolbutton2">
            <property name="visible">True</property>
            <property name="label" translatable="yes">toolbutton2</property>
            <property name="use_underline">True</property>
            <property name="stock_id">gtk-open</property>
          </widget>
          <packing>
            <property name="expand">False</property>
            <property name="homogeneous">True</property>
          </packing>
        </child>
      </widget>
    </child>
  </widget>
</glade-interface> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-22T08:21:50.350

这可能只是 GTK+ 将焦点交给了某个小部件，如果可能的话，它喜欢让一个小部件获得焦点。

您可以使用`[grab_focus()](http://library.gnome.org/devel/gtk/stable/GtkWidget.html#gtk-widget-grab-focus)`将焦点移至其他位置，以获得所需的行为。但是，如果工具栏是您拥有的所有小部件，则可能很难找到合适的焦点“目标”。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-05-17T09:08:17.930

gtk.ToolButton 继承 gtk.Bin。

> gtk.Bin 是一个抽象基类，它定义了一个小部件，它是一个**只有一个子容器**的容器。

所以按钮是一个容器

```
btn.set_can_focus(False) 
```

不管用。你需要

```
btn.set_focus_chain([]) 
```

或工具栏中的每个按钮

```
toolbar.foreach(lambda x: x.set_focus_chain([])) 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-13T02:19:27.257

您始终可以添加一个小部件并使其不可见，并将焦点转移到它。尽管我真的不认为这是一个问题，也不知道其他人这样做过。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2011-12-08T13:27:25.600

它具有焦点，因为它是您应用程序中的第一个小部件。如果您使用 glade，您可以将“有焦点”设置为任何其他小部件的“是”，工具栏将在启动时自动失去焦点。

# sql - MySQL获取一个月中每一天的日期的行数

> ID：894878
> 
> 赞同：4
> 
> 时间：2009-05-21T20:10:54.020
> 
> 标签：sql, mysql

我有一个表格，其中包含社区活动列表，其中包含活动开始和结束日期的列。如果结束日期为 0，则事件仅在开始日期发生。我有一个查询返回在任何给定日期发生的事件数：

```
SELECT COUNT(*) FROM p_community e WHERE 
    (TO_DAYS(e.date_ends)=0 AND DATE(e.date_starts)=DATE('2009-05-13')) OR
    (DATE('2009-05-13')>=DATE(e.date_starts) AND DATE('2009-05-13')<=DATE(e.date_ends)) 
```

我只是在我想测试“2009-05-13”的任何日期进行替换。

我需要能够在整个月中的每一天获取这些数据。我可以一次只针对每一天运行一个查询，但我宁愿运行一个查询，它可以一次给我整个月的时间。有人对我如何做到这一点有任何建议吗？

不，我不能使用存储过程。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-05-21T20:16:10.560

尝试：

```
SELECT COUNT(*), DATE(date) FROM table WHERE DATE(dtCreatedAt) >= DATE('2009-03-01') AND DATE(dtCreatedAt) <= DATE('2009-03-10') GROUP BY DATE(date); 
```

这将获得 2009 年 5 月每天的金额。

更新：现在适用于跨越月/年的一系列日期。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-05-21T21:11:29.217

Unfortunately, `MySQL` lacks a way to generate a rowset of given number of rows.

You can create a helper table:

```
CREATE TABLE t_day (day INT NOT NULL PRIMARY KEY)

INSERT
INTO    t_day (day)
VALUES  (1),
        (2),
        …,
        (31) 
```

and use it in a `JOIN`:

```
SELECT  day, COUNT(*)
FROM    t_day
JOIN    p_community e
ON      day BETWEEN DATE(e.start) AND IF(DATE(e.end), DATE(e.end), DATE(e.start))
GROUP BY
        day 
```

Or you may use an ugly subquery:

```
SELECT  day, COUNT(*)
FROM    (
        SELECT  1 AS day
        UNION ALL
        SELECT  2 AS day
        …
        UNION ALL
        SELECT  31 AS day
        ) t_day
JOIN    p_community e
ON      day BETWEEN DATE(e.start) AND IF(DATE(e.end), DATE(e.end), DATE(e.start))
GROUP BY
        day 
```

# python - CreateDatabase 在谷歌数据 api 上经常失败

> ID：894881
> 
> 赞同：0
> 
> 时间：2009-05-21T20:11:43.783
> 
> 标签：python, gdata-api

下面的测试程序应该创建一个新的电子表格：

```
#!/usr/bin/python

import gdata.spreadsheet.text_db
import getpass
import atom
import gdata.contacts
import gdata.contacts.service
import smtplib
import time

password = getpass.getpass()
client = gdata.spreadsheet.text_db.DatabaseClient(username='jmv@gmail.com',password=password)
database = client.CreateDatabase('My Test Database')
table = database.CreateTable('addresses', ['name','email',
    'phonenumber', 'mailingaddress'])
record = table.AddRecord({'name':'Bob', 'email':'bob@example.com', 
    'phonenumber':'555-555-1234', 'mailingaddress':'900 Imaginary St.'})

# Edit a record
record.content['email'] = 'bob2@example.com'
record.Push() 
```

它确实如此，但仅在大约每 5 次运行中的 1 次上。在另外 5 次运行中的 4 次中，我得到：

```
Password: 
Traceback (most recent call last):
  File "./test.py", line 13, in <module>
    database = client.CreateDatabase('My Test Database')
  File "/home/jmvidal/share/progs/googleapps/google_appengine/glassboard/gdata/spreadsheet/text_db.py", line 146, in CreateDatabase
    db_entry = self.__docs_client.UploadSpreadsheet(virtual_media_source, name)
  File "/home/jmvidal/share/progs/googleapps/google_appengine/glassboard/gdata/docs/service.py", line 304, in UploadSpreadsheet
    return self._UploadFile(media_source, title, category, folder_or_uri)
  File "/home/jmvidal/share/progs/googleapps/google_appengine/glassboard/gdata/docs/service.py", line 144, in _UploadFile
    converter=gdata.docs.DocumentListEntryFromString)
  File "/home/jmvidal/share/progs/googleapps/google_appengine/glassboard/gdata/service.py", line 1151, in Post
    media_source=media_source, converter=converter)
  File "/home/jmvidal/share/progs/googleapps/google_appengine/glassboard/gdata/service.py", line 1271, in PostOrPut
    'reason': server_response.reason, 'body': result_body}
gdata.service.RequestError: {'status': 404, 'body': '<HTML>\n<HEAD>\n<TITLE>Not Found</TITLE>\n</HEAD>\n<BODY BGCOLOR="#FFFFFF" TEXT="#000000">\n<H1>Not Found</H1>\n<H2>Error 404</H2>\n</BODY>\n</HTML>\n', 'reason': 'Not Found'} 
```

当我在 appengine 上运行类似的代码时也会发生同样的事情，所以我不认为这个问题是由于连接速度慢（另外，我有一个电缆调制解调器，它的工作速度约为 1Mbps）。

那么，为什么是404？而且，更重要的是，有没有办法提高我的 CreateDatabase 调用成功的机会？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-22T12:48:36.647

有人告诉我这是 gdata 中的一个[已知错误](http://code.google.com/p/gdata-issues/issues/detail?id=1147)。

# c# - 如何在 ASP.NET Web 应用程序中获取 Handle.ToInt32()

> ID：894883
> 
> 赞同：1
> 
> 时间：2009-05-21T20:11:48.137
> 
> 标签：c#, asp.net, windows, handle

我正在尝试为供应商的产品学习和使用 SDK。不幸的是，文档很粗略，我对 .Net 框架的了解也遇到了空白。

我有一些适用于 Windows 窗体应用程序的工作代码，我正试图让它在 ASP.NET Web 窗体应用程序中工作。供应商文档暗示您可以这样做，但也许您不能..

来自工作 Windows 应用程序的片段：

```
using System;
using System.Drawing;
using System.Collections;
using System.ComponentModel;
using System.Windows.Forms;
using TRIMSDK;

private void ConnectUserBtn_Click(object sender, System.EventArgs e)
{
Database db = new Database();
Databases dbChooser = new Databases();
IDatabase dbI = dbChooser.ChooseOneUI(Handle.ToInt32());
if (dbI == null)
{
    return;
}
db.Id = dbI.Id; 
```

现在这是我在 .ASPX 页面的点击事件处理程序中的尝试：

```
using System;
using System.Collections.Generic;
using System.Web;
using System.Web.UI;
using System.Web.UI.WebControls;
using TRIMSDK;

protected void ConnectUserBtn_Click(object sender, EventArgs e)
{
    Database db = new Database();
    Databases dbChooser = new Databases();
    IDatabase dbI = dbChooser.ChooseOneUI(Handle.ToInt32());
    if (dbI == null)
    {
        return;
    } 
```

我在上面的行中收到一个编译投诉，上面写着“当前上下文中不存在名称‘Handle’。

我尝试使用的 SDK 的这一部分显示了反映产品属性的各种模式对话框，以促进“客户端”开发。我担心它可能只是“Windows 客户端”，而 ASP.NET Web 应用程序无法做到这一点。

有什么我可以添加来解决这个问题吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-21T20:15:29.970

对于 Web 应用程序，模式对话框将在客户端完成，通常通过 javascript 和 dhtml - 而不是在服务器（执行 ASP.NET 代码的地方）。所以我担心这个产品确实只是winforms。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-07-23T18:18:44.867

只是通过它：

```
int hwnd = 0;

IDatabase dbI = dbChooser.ChooseOneUI(hwnd); 
```

# jquery - 在 MVC 中使用 jQuery 进行选项卡选择

> ID：894887
> 
> 赞同：0
> 
> 时间：2009-05-21T20:11:59.600
> 
> 标签：jquery

我在视图中设置了四个选项卡，如下所示

```
<ul>
    <li><a id="#tabs-1">Case Summary</a></li>
    <li><a id="#tabs-2">Patient</a></li>
    <li><a id="#tabs-3">Physician</a></li>
    <li><a id="#tabs-4">Site</a></li>
    <li><a id="#tabs-5">Journal</a></li>
</ul> 
```

我需要做的是，能够通过发送 viewdata("TabSelected") = "tabs-3" 获取医师信息来关注我的控制器操作所需的标签

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-21T20:24:32.913

如果您使用 jQuery UI 选项卡，这会简单得多。jQuery UI 是一组完全受支持的小部件，用于在客户端创建 UI。提供的小部件之一是选项卡小部件。

假设您正在使用它，您可以执行以下简单操作：

在控制器动作上：

```
ViewData("SelectedTabIndex") = 1; 
```

在客户端，在 $(document).ready 中：

```
$('#myTabs').tabs({ selected: <%= ViewData["SelectedTabIndex"] %> }); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-21T20:49:41.943

将 tabselected 放入 viewdata 后，如下所示：

```
ViewData("TabSelected") = "tabs-3" 
```

只需将以下内容放入您的 $(document).ready() 函数中：

```
$('#<%=ViewData("TabSelected")%>').focus() 
```

那应该这样做。

# linux - 如何验证脚本中的视频文件？

> ID：894903
> 
> 赞同：8
> 
> 时间：2009-05-21T20:14:51.203
> 
> 标签：linux, validation, video

我有一个包含大量视频文件的服务器。还原后，我注意到几个文件的校验和发生了变化。由于我没有所有文件的校验和，我想编写一个脚本来验证文件的完整性。对于档案（`tar t`、`unzip -t`、`rar t`等）或图像（`convert image.jpg /tmp/test.png`）来说很简单。

我需要将哪些选项传递给Linux 上的`mplayer`或`vlc`任何其他视频工具以达到相同的效果（即验证文件内容而无需观看整个视频）？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-21T20:46:10.360

听起来你想做的是：

```
mplayer -vo null -ao null input.file 
```

然后解析输出并返回值，看看它是否可以真正播放和解码流。这将需要一些时间（但比实时更快）。如果您想要更快的速度，这里有更多建议：

一件容易的事是做一个

```
mplayer -identify -vo null -ao null 
```

在文件上，然后解析输出并查看看起来合理的返回值。

关于校验和不正确，很难知道这是否是您的媒体播放器（mplayer、vlc、totem 等）的问题。一个好的媒体播放器可以容忍许多位或字节级别的错误，而对最终播放的影响很小。当一个非常严格的媒体播放器看到格式错误或不正确的编解码器和包装器字节时，它将退出。

要验证包装器（容器）字节，您可以执行类似的操作

```
mencoder -ovc copy -oac copy input.file -o output.file 
```

问题是 mencoder 会想要创建一个 .avi 文件用于输出。如果您的输入是 .avi，那么这将非常有用。

您可以运行类似的 ffmpeg 命令行，如下所示：

```
ffmpeg -acodec copy -vcodec copy input.file output.file 
```

如果文件是 .mp4 文件，您可能需要查看 mp4box ( [http://www.videohelp.com/tools/mp4box](http://www.videohelp.com/tools/mp4box) ) 以执行类似任务。matroska 工具也适用于这类事情。( [http://www.matroska.org/](http://www.matroska.org/) )

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-02T13:27:36.180

如果您正在处理 MP4 文件，您可能需要查看**[mpeg4ip](http://mpeg4ip.sourceforge.net/)**项目，特别是**mp4videoinfo**或**mp4info**等工具。这可能足以满足您的需求，而且速度非常快。

从首页：

*   **mp4dump** 实用程序以文本形式转储 MP4 文件元信息
*   **mp4trackdump** 实用程序以文本形式转储 MP4 文件轨道信息
*   **mp4info** 显示 MP4 文件摘要的实用程序
*   **mp4videoinfo** 实用程序转储有关 MP4 文件视频轨道的信息
*   **avidump** 实用程序显示 AVI 文件摘要
*   **yuvdump** 实用程序在屏幕上显示原始视频文件
*   **mpeg_ps_info** 用于在 mpeg 程序流或 vob 文件中显示流的实用程序
*   **mpeg_ps_extract** 实用程序，用于在 mpeg 程序流或 vob 文件中提取基本流

以下是在我的诺基亚 N95 上拍摄的 MP4 的一些示例输出：

```
manoa:Movies stu$ mp4info 20081017001.mp4 
mp4info version 1.5.0.1
20081017001.mp4:
Track   Type    Info
1   video   MPEG-4 Unknown Profile(4), 3.620 secs, 2700 kbps, 640x480 @ 23.480663 fps
2   audio   MPEG-4 AAC LC, 3.797 secs, 97 kbps, 48000 Hz
manoa:Movies stu$ 
manoa:Movies stu$ 
manoa:Movies stu$ mp4videoinfo 20081017001.mp4
mp4videoinfo version 1.5.0.1
tracks 1
mp4file 20081017001.mp4, track 1, samples 85, timescale 30000
sampleId      1, size 24110 time 0(0) VOP-I
sampleId      2, size  9306 time 4076(135) VOP-P
sampleId      3, size 13071 time 5104(170) VOP-P
... (a bunch more frames and a bit of info)  ...
sampleId     59, size  8702 time 64975(2165) VOP-P
sampleId     60, size  8826 time 65980(2199) VOP-P
sampleId     61, size  9819 time 66966(2232) GOV VOP-I
sampleId     62, size  5591 time 67986(2266) VOP-P
... (a bunch more frames and a bit of info)  ...
sampleId     83, size 10188 time 105546(3518) VOP-P
sampleId     84, size  6533 time 106585(3552) VOP-P
sampleId     85, size  6032 time 107601(3586) VOP-P
manoa:Movies stu$ 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-06-02T14:25:26.987

没有观看所有视频，没有“完美”的方法可以做到这一点。

视频文件非常强大 - 作为一个实验，我随机选取了一个 MPEG-4 视频文件，在十六进制编辑器中打开它并开始更改字节...... `mplayer`Quicktime 仍然可以毫无错误地播放它。

在从 mplayer 收到任何错误之前，我必须删除数千个字节：

```
...
[mpeg4 @ 0x6762b0]marker does not match f_code
[mpeg4 @ 0x6762b0]marker does not match f_code
[mpeg4 @ 0x6762b0]concealing 852 DC, 852 AC, 852 MV errors
[mpeg4 @ 0x6762b0]header damaged:  0.055  16/ 16 15%  1%  3.5% 0 0 
Error while decoding frame! 
```

编写在每个视频上运行的脚本并检查输出是否有错误消息/警告并不难`mplayer`，但除非更改的字节位于文件头中，或者更改了大量数据，否则您永远找不到商场

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-21T20:18:56.873

由于 mplayer 具有[从一种视频格式转换为另一种视频格式的](http://en.linuxreviews.org/HOWTO_Convert_video_files)选项，这对于这样的测试来说可能已经足够好了，假设 mencoder 如果它无法解码输入文件会返回错误（我还没有测试过）。这将类似于您提到的*图像测试**（转换 image.jpg /tmp/test.png）*

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2009-05-21T20:27:17.260

我建议你使用 sha1sum，一个你可能已经拥有的命令行工具（如果没有，你可能也有 md5sum，这对这份工作来说很好）......你需要做的就是比较之前的 sha1sum 的标准输出和恢复后...

# c# - 如何用空字符串替换出现的“-”？

> ID：894905
> 
> 赞同：39
> 
> 时间：2009-05-21T20:15:07.240
> 
> 标签：c#, string

我有这个字符串：“123-456-7”

我需要得到这个字符串：“1234567”

如何用空字符串替换出现的“-”？

* * *

## 回答 #1

> 赞同：101
> 
> 时间：2009-05-21T20:15:52.353

```
string r = "123-456-7";
r = r.Replace("-", ""); 
```

* * *

## 回答 #2

> 赞同：25
> 
> 时间：2009-05-21T20:16:28.437

这应该可以解决问题：

```
String st = "123-456-7".Replace("-",""); 
```

* * *

## 回答 #3

> 赞同：22
> 
> 时间：2009-05-22T05:06:13.787

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-05-21T20:21:21.500

为了清楚起见，您希望将每个连字符 (-) 替换为空白/无。如果你用退格替换它，它会删除它之前的字符！

这将导致： **123-456-7 ==> 12457**

肖恩·布莱特有正确的答案。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-05-21T20:23:12.217

[**String.Replace 方法（字符串，字符串）**](http://msdn.microsoft.com/en-us/library/fk49wtc1.aspx)

在你的情况下，它会是

```
string str = "123-456-7";
string tempstr = str.Replace("-",""); 
```

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2012-12-13T23:30:51.003

使用 String.Empty 或 null 而不是 "" 因为 "" 将为每次出现在内存中创建一个对象，而其他人将重用相同的对象。

# silverlight - 我可以为所有支持 Silverlight 2.0 的浏览器覆盖 Silverlight 中的上下文菜单吗？

> ID：894909
> 
> 赞同：5
> 
> 时间：2009-05-21T20:15:36.630
> 
> 标签：silverlight, silverlight-2.0, right-click

这似乎是谷歌上的一个常见问题，但我找不到满意的答案（除非答案是“否”）

当用户右键单击我的 Silverlight 应用程序时，我想添加菜单项或显示自定义菜单。

我发现最接近的东西是在 IE 中捕获上下文菜单，但在 Firefox 中没有，Chrome 显示上下文菜单，然后显示自定义事件。

（我提到的教程在这里 [http://silverlight.net/blogs/msnow/archive/2008/07/01/tip-of-the-day-14-how-to-right-click-on-a-silverlight -应用程序.aspx](http://silverlight.net/blogs/msnow/archive/2008/07/01/tip-of-the-day-14-how-to-right-click-on-a-silverlight-application.aspx)）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-22T15:58:32.660

在 Silverlight 中本机无法执行此操作。

我相信其他地方提到的 Telerik 控件使用 HtmlBridge 拦截上下文单击，然后绘制自己的菜单，但是它现在似乎不适用于 Silverlight 2.0.40115，所以也许微软已经缩小了这个差距。

没有右键单击是基于安全考虑的设计决策，而不是技术决策。但是我相信微软团队正在考虑在未来的版本中允许上下文菜单（甚至可能是 v3）

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-23T17:34:58.063

在这里你有一个实现，但它是 CTRL+左键单击，然后你会得到一个上下文菜单（关于文本，抱歉它是西班牙语）：

[http://www.albloguera.es/?p=29](http://www.albloguera.es/?p=29)

另一种选择，是指出通过 javascript 来做的，相当笨重的解决方案，并且不确定它现在是否在当前的 2.0 版本中工作:-(。

祝你好运布劳略

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-22T08:18:57.237

我得出的结论是，基于我对 Telerik 的上下文菜单的使用，它似乎可以在 IE、Chrome 和 Firefox 上正常运行。

看看吧，[http://demos.telerik.com/silverlight/#ContextMenu/FirstLook](http://demos.telerik.com/silverlight/#ContextMenu/FirstLook)

# java - Java 迭代器

> ID：894922
> 
> 赞同：1
> 
> 时间：2009-05-21T20:16:56.940
> 
> 标签：java, map, iterator

我是新手，我有一个问题。

我有一张地图。我必须遍历地图并构建迭代器。

例子：

```
public Iterable<Test> getTests(Map<String, Test> testMap,
    Set<String> strings)
{
    //loop tru the set of strings and build iterator.
    for(final String test1 : strings)
    {

       Test test = testMap.get(test1);

       //build a iterator. not a list.
    }

    return iterator
} 
```

我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-21T20:23:57.940

首先，您的方法返回的是[`Iterable`](http://java.sun.com/javase/6/docs/api/java/lang/Iterable.html)，而不是[`Iterator`](http://java.sun.com/javase/6/docs/api/java/util/Iterator.html)。`Map`, `Set`, 和`List`所有实现`Iterable`，所以它可能比你想象的要容易。

其次， an`Iterable`只是一个具有[`iterator()`](http://java.sun.com/javase/6/docs/api/java/lang/Iterable.html#iterator())返回 an 的方法的类`Iterator`。

所以我会简单地构建一个`List`结果然后返回它。如果你真的想返回一个`Iterator`，我会改为调用`iterator()`列表并返回*那个*。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-21T20:36:04.233

跳过您的 Iterator/Iterable 混淆（并且 Iterable 基本上是一个 Iterator 工厂......所以您需要以任何方式编写一个 Iterator），我认为您的意思是这样的：

```
Iterator<Test> getTests(final Map<String,Test> testMap, final Set<String> strings) {
    return new Iterator<Test>() {
      private final Iterator<String> keyIter = strings.iterator();
      private String lastKey;
      public boolean hasNext() { return keyIter.hasNext(); }
      public Test next() { lastKey = keyIter.next(); return testMap.get(lastKey); }
      public void remove() { testMap.remove(lastKey); }
    };
  } 
```

如果你想返回一个 Iterable，那么它必须是一个工厂：

```
Iterable<Test> getTests(final Map<String,Test> testMap, final Set<String> strings) {
    return new Iterable<Test>() {
        public Iterator<Test> iterator() {
            return new Iterator<Test>() {
                private final Iterator<String> keyIter = strings.iterator();
                private String lastKey;
                public boolean hasNext() { return keyIter.hasNext(); }
                public Test next() { lastKey = keyIter.next(); return testMap.get(lastKey); }
                public void remove() { testMap.remove(lastKey); }
              };
        }
    };
} 
```

为了获得额外的荣誉，您可以参数化此方法本身，并使用一种通用的方法来迭代地图中的选择：

```
Map<String, Action> map;
Set<String> keys;
for (Action x : filterMap(map, keys)) {
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-21T20:22:02.263

由于`Collection`extends `Iterable`，正确的解决方案是将测试添加到某种集合中，例如`ArrayList`.

```
Collection<Test> tests = new ArrayList<Test>();
for (String key : strings) {
  Test t = testMap.get(key);
  if (t != null)
    tests.add(t);
}
return tests; 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-21T20:45:17.443

如果你想真正返回 Iterable 最简单的方法是这样

```
public Iterable<Test> getTests(Map<String, Test> testMap, Set<String> strings)
{
   testMap = new HashMap<String, Test>(testMap);
   testMap.keySet().retainAll(strings);
   return testMap.values();
} 
```

如果要返回迭代器，请将最后一行替换为

```
return testMap.values().iterator(); 
```

如果您不关心对传入映射的修改，请跳过初始临时映射构建。

编辑：在没有它的地图界面上删除了克隆的使用。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-22T07:17:04.127

作为在黑暗中的刺，您可能正在寻找的是`Map.entrySet.iterator()`. 它允许您遍历地图的条目。

*注意：我知道这不是对 OP 问题的回答，但这是我在回答他们实际寻找的问题时的猜​​测。如果这个猜测结果是错误的，我会再次删除这个答案，以免人们感到困惑。*

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-21T20:29:59.877

**Iterable**与**Iterator**不同。Iterable 是您可以迭代的东西，例如 List。您为此使用迭代器。您的问题不清楚您想从 getTests() 返回什么。

您最好的方法是创建一个 Iterable（如 List 或 Vector）并返回它，或者返回它的 Iterator。

# wpf - WPF Combobox 整数的图形表示

> ID：894926
> 
> 赞同：1
> 
> 时间：2009-05-21T20:17:41.603
> 
> 标签：wpf, combobox

我想以与 Outlook 上的标志列类似的方式使用 WPF 组合框，在该列中，您可以选择不同的标志来选择。

我的标志将作为整数存储在数据库中，每个数字由不同的颜色标志表示。

有没有人已经这样做或类似的。没有任何指向实现这一目标的最佳方法的指针？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-21T21:43:33.893

假设您正在为 ComboBox 使用 DataTemplate，那么您正在寻找的是一个值转换器。您需要做的就是创建一个类并从 IValueConverter 继承。然后通过 int 值切换并返回你想要的那个数字的画笔/颜色。然后在您的模板中，您可以在数据绑定表达式中使用此值转换器。

# asp.net-mvc - 为网站设置私人测试版

> ID：894931
> 
> 赞同：4
> 
> 时间：2009-05-21T20:19:17.403
> 
> 标签：asp.net-mvc

我正在尝试为我正在开发的网站设置“私人测试版”。该站点使用开放ID。如果他们不是测试版的一部分，我什至不希望任何人浏览这些页面。实现这一点的最佳方法是什么？有什么建议么？

例如：

网站上线后，用户将访问[http://www.mydomain.com](http://www.mydomain.com)，无需登录。

对于测试版，我想限制访问。[访问http://www.mydomain.com](http://www.mydomain.com)的用户将被重定向到登录页面。任何试图访问网站任何部分但未经身份验证的人将被重定向回登录页面。

我可以在我的控制器操作中粘贴 [Authorize] 属性，但这似乎很愚蠢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-21T20:21:23.047

如果您使用的是 ASP.NET MVC，它带有开箱即用的身份验证/授权。您应该能够使用它在您的站点上设置身份验证。

或者，您可以设置应用服务器设置 - IIS 允许您在它所服务的特定站点上设置用户名/密码，而不管实际应用程序可能会做什么。如果您有权访问应用服务器，这可能是最好的解决方案。

如果您使用的是 IIS6，则可以轻松设置授权。右键单击您的站点 > 属性 > 目录安全选项卡 > 身份验证和访问控制 > 编辑，然后输入您选择的用户名/密码。完毕。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-21T20:21:43.497

真正的问题是他们是如何被邀请到私人测试版的？

您可以像 serverfault.com 一样设置一个删除 cookie 的密码。

或者

如果您知道要邀请谁：您可以使用您已经知道的电子邮件/登录信息将他们添加到系统中（假设您通过电子邮件邀请他们）

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-21T20:35:05.250

不久前，我在 Web 应用程序中实现了一个功能，我们可以阻止对整个网站的访问，除非用户是管理员（在我们的例子中，这意味着用户帐户是 Active Directory 中特定组的成员）。

它基于两件事。首先，Web 应用程序中的所有页面都不是直接继承自 Page 类，而是继承自我们 Web 应用程序中的自定义页面类。其次，我们在 web.config 文件的 appSettings 部分有这样的值：

```
<add key="adminaccessonly" value="0" /> 
```

自定义页面类将在加载时检查该值。如果它不是 0，它会重定向到一个页面（尽管它没有继承相同的自定义页面类），通知用户“该站点现在不可用”。如果值为 0，则页面将照常加载。

在那个应用程序中，当我们部署一个新版本时，我们使用它来使站点“离线”，给我们一些时间来验证一切是否正常，然后再让用户进入。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-21T20:21:53.217

最好的方法是邀请系统（基于邀请码）或在您的系统中创建个人资料后手动确认访问。恕我直言

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-21T20:27:50.223

或者，您可以将站点托管在私人服务器上，并设置 VPN 以使用它。根据您的资源和需求，这可能是在不修改代码库的情况下做您想做的最简单和最安全的方法。

或者，您也可以使用 Apache 或 IIS 强制对网站目录的访问进行身份验证。将身份验证信息保存在 .htaccess 中一段时间​​。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-21T20:51:53.157

即使您使用开放身份验证，您仍可能需要某种形式的授权机制。最简单的形式是数据库中的用户角色系统，它为用户分配不同的角色

在您的情况下，只需将 private_beta 角色分配给您的私人测试版受邀者，并确保您的授权机制是所有用户都具有 private_beta 权限，然后才能继续。

If you don't want to provide authorization for the public site (where everyone can do everything, once authenticated), then, you may only need to do a quick-and-dirty post-processing (for private beta only) on your open_id authenticated users to check them off a short list (which you can store on a text file.

# objective-c - Ball to Ball Collision - 在碰撞时获得显着的速度

> ID：894935
> 
> 赞同：4
> 
> 时间：2009-05-21T20:19:40.100
> 
> 标签：objective-c, graphics, collision-detection, physics

我在 Objective-C 中实现了问题“ [Ball to Ball Collision - Detection and Handling ”中的代码。](https://stackoverflow.com/questions/345838/ball-to-ball-collision-detection-and-handling)然而，每当球以一定角度碰撞时，它们的速度就会急剧增加。所有的向量数学都是使用[cocos2d-iphone](http://code.google.com/p/cocos2d-iphone/source/browse/trunk/cocos2d/Support/CGPointExtension.h?spec=svn806&r=806)完成的，头文件为 CGPointExtension.h。这种不希望的加速的原因是什么？

下面是一个提高速度的例子：

**输入：**
质量 == 12.56637
速度.x == 1.73199439 速度.y
== -10.5695238

ball.mass == 12.56637
ball.velocity.x == 6.04341078
ball.velocity.y == 14.2686739

**输出：**
质量 == 12.56637
速度.x == 110.004326 速度.y
== -10.5695238

ball.mass == 12.56637
ball.velocity.x == -102.22892
ball.velocity.y == -72.4030228

```
#import "CGPointExtension.h"
#define RESTITUTION_CONSTANT (0.75) //elasticity of the system

- (void) resolveCollision:(Ball*) ball
{
    // get the mtd (minimum translation distance)
    CGPoint delta = ccpSub(position, ball.position);
    float d = ccpLength(delta);
    // minimum translation distance to push balls apart after intersecting
    CGPoint mtd = ccpMult(delta, (((radius + ball.radius)-d)/d)); 

    // resolve intersection --
    // inverse mass quantities
    float im1 = 1 / [self mass]; 
    float im2 = 1 / [ball mass];

    // push-pull them apart based off their mass
    position = ccpAdd(position, ccpMult(mtd, (im1 / (im1 + im2))));
    ball.position = ccpSub(ball.position, ccpMult(mtd, (im2 / (im1 + im2))));

    // impact speed
    CGPoint v = ccpSub(velocity, ball.velocity);
    float vn = ccpDot(v,ccpNormalize(mtd));

    // sphere intersecting but moving away from each other already
    if (vn > 0.0f) return;

    // collision impulse
    float i = (-(1.0f + RESTITUTION_CONSTANT) * vn) / ([self mass] + [ball mass]);
    CGPoint impulse = ccpMult(mtd, i);

    // change in momentum
    velocity = ccpAdd(velocity, ccpMult(impulse, im1));
    ball.velocity = ccpSub(ball.velocity, ccpMult(impulse, im2));

} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-21T20:28:54.107

在查看了原始代码和原始发布者的评论后，代码似乎相同，所以如果原始代码是正确的实现，我会怀疑向量库或某种未初始化的变量。

为什么要在恢复系数上加 1.0？

来自：[http ://en.wikipedia.org/wiki/Coefficient_of_restitution](http://en.wikipedia.org/wiki/Coefficient_of_restitution)

COR 通常是 [0,1] 范围内的数字。定性地，1代表完全弹性碰撞，而0代表完全非弹性碰撞。理论上，大于 1 的 COR 是可能的，代表产生动能的碰撞，例如地雷被扔在一起并爆炸。

另一个问题是这样的：

```
/ (im1 + im2) 
```

你除以质量倒数的总和以获得沿接触矢量的冲动 - 你可能应该除以质量本身的总和。这会放大你的冲动（“这就是她所说的”）。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-22T01:31:12.623

我是编写您引用的原始球反弹代码的人。如果您[下载](http://code.google.com/p/simucal-projects/source/browse/ballbounce/trunk/Ball.java)并试用该代码，您会发现它运行良好。

以下代码是正确的（您最初拥有它的方式）：

```
// collision impulse
float i = (-(1.0f + RESTITUTION_CONSTANT) * vn) / (im1 + im2);
CGPoint impulse = ccpMult(mtd, i); 
```

这是非常常见的物理代码，您可以在以下示例中看到它几乎完全像这样实现：

*   [查找两个对象的碰撞响应 - GameDev](http://www.gamedev.net/community/forums/topic.asp?topic_id=531478)
*   [3D Pong 碰撞响应](http://www.flipcode.com/archives/3D_Pong_Collision_Response.shtml)
*   [另一个用 Java 编写的球对球碰撞](http://www.gamedev.net/community/forums/topic.asp?topic_id=497363)

这是正确的，它~不是~像其他人建议的那样创建超过 1.0 的 CoR。这是根据质量和恢复系数计算相对脉冲矢量。

忽略摩擦，一个简单的一维示例如下：

```
J = -Vr(1+e) / {1/m1 + 1/m2} 
```

其中 e 是您的 CoR，Vr 是您的归一化速度，J 是脉冲速度的标量值。

如果您打算做比这更高级的事情，我建议您使用已经存在的众多物理库之一。当我使用上面的代码时，几个球没问题，但是当我将它增加到几百个时，它开始窒息。我使用了 Box2D 物理引擎，它的求解器可以处理更多的球，而且更加准确。

无论如何，我查看了您的代码，乍一看它看起来不错（这是一个非常忠实的翻译）。这可能是传入错误值或向量数学问题的小而微妙的错误。

我对 iPhone 开发一无所知，但我建议在该方法的顶部设置一个断点，并监控每个步骤的结果值并找到爆炸的位置。确保正确计算 MTD、冲击速度等，直到您看到大幅增加的位置。

报告该方法中每个步骤的值，我们将看到我们拥有什么。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-13T14:47:52.563

在这一行：

```
CGPoint impulse = ccpMult(mtd, i); 
```

mtd 需要标准化。发生错误是因为在原始代码中 mtd 在前一行中进行了规范化，但在您的代码中没有。您可以通过执行以下操作来修复它：

```
CGPoint impulse = ccpMult(ccpNormalize(mtd), i); 
```

# asp.net - window.showModalDialog dialogWidth 属性在 IE 中不起作用

> ID：894954
> 
> 赞同：1
> 
> 时间：2009-05-21T20:23:09.767
> 
> 标签：asp.net, javascript

我有一个在我们的受控环境（IE 7）中运行的 2.0 框架 ASP.Net 页面。该`dialogWidth`物业似乎无法正常工作。脚本如下：

```
var win = window.showModalDialog ('Page.aspx', 'PopupPage', 'dialogHeight:600px,dialogWidth:800px,resizable:0'); 
```

工作正常，`dialogHeight`但无论我改变什么`dialogWidth`- 它似乎被限制在大约 250px 的宽度。在上面的配置中，模态弹出窗口高于它的宽度——即使宽度为 800，高度为 600。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-05-21T20:29:11.533

选项必须用分号而不是逗号分隔。

```
var win = window.showModalDialog ('Page.aspx', 'PopupPage', 'dialogHeight:600px; dialogWidth:800px; resizable:0'); 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-05-21T20:36:33.327

试试这个：

```
var returnValue = window.showModalDialog(sUrl,'','unadorned:yes;resizable:1;
dialogHeight:550px;dialogwidth:985px;scroll:no;status=no'); 
```

和我一起工作的人有同样的问题，这解决了他的问题......

# wcf - Web服务安全：WSE3.0和WCF的优缺点是什么？

> ID：894962
> 
> 赞同：0
> 
> 时间：2009-05-21T20:25:56.377
> 
> 标签：wcf, definition, wse3.0

我正在我的公司开发一套新的网络服务。

我的经理要求我为此提供更高级别的安全性，因为 Web 服务将处理敏感信息。

我在网上搜索了有关如何保护 Web 服务的资源，两个亚军是 WSE3.0 和 WCF。

但我不知道哪一个是最好的选择。

我的要求规定了一些web服务必须被非.NET环境调用，那么如何进行呢？

在这种情况下，哪一个是最好的？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-21T20:27:33.877

如果您有幸进行新的开发，那么一定**要**使用 WCF！

如果您需要调整系统，它提供了更多功能、更多安全选项、绑定以及更多扩展点。

WCF 还支持比以前更多的行业标准互操作性方案，因此您也应该在这个领域得到更多的关注。

以下是一些专门关于 WCF 安全性的文章：

*   [WCF 安全基础知识](http://www.devx.com/codemag/Article/33342)
*   [编程 WCF 安全性](http://msdn.microsoft.com/en-us/library/ms731925.aspx)
*   [WCF 安全指南](http://www.codeplex.com/WCFSecurity)

毫无疑问 - 这是一个灌篮 - 与 WCF 一起去！

马克

# jquery - 从 jQuery iframe 重新绑定列表视图

> ID：894974
> 
> 赞同：0
> 
> 时间：2009-05-21T20:28:30.973
> 
> 标签：jquery, firefox, caching, thickbox

我有一个列表视图，其中包含使用 jQuery 和thickbox 打开 iframe 的链接。这个新窗口允许用户使用 iframe 编辑字段信息。更新按钮 -

```
<input type="submit" name="bUpdateDate" value="Update" 
onclick="self.parent.location.reload(true);self.parent.tb_remove();"
id="bUpdateDate" /> 
```

此刷新在 IE 中运行良好，但 Firefox 和 Chrome 都不会重新绑定列表视图。我已经尝试过没有缓存的元标记，以及 HttpCacheability.NoCache 和 IIS 标头内容过期，但似乎没有什么能够强制刷新 Firefox。如何让我的列表视图从子 iframe 重新绑定？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-21T20:40:19.403

jQuery 1.3.3 发布后将对 iFrame 绑定提供更好的支持[http://brandonaaron.net/blog/2009/05/14/jquery-edge-better-support-for-other-windows-and-documents](http://brandonaaron.net/blog/2009/05/14/jquery-edge-better-support-for-other-windows-and-documents)

您也许可以获得最新的信息并取得更大的成功。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-21T21:10:55.223

作为另一种选择，是否

```
top.location.reload(true) 
```

工作？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-19T16:10:10.527

在这里找到适合我的解决方案：[http ://www.zdima.net/blog/archives/398](http://www.zdima.net/blog/archives/398)

# ruby-on-rails - 我可以使用什么来在 Windows 上托管 Rails 站点？

> ID：894977
> 
> 赞同：0
> 
> 时间：2009-05-21T20:28:56.493
> 
> 标签：ruby-on-rails

好的，在你们发疯之前——这只是一个小站点，临时设置。现在我有一些内部人员远程进入服务器并通过 webrick 通过 dev 命令使用该站点：ruby script/server。不完全理想。

我刚刚开始 Rails 开发，我想知道在 Windows Pro 机器上处理托管的更好方法。再次，只是暂时的，所以请温柔:)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-21T20:58:30.210

据我所知， mod_rails 不是替代品。

不过，Mongrel 在 Windows 上的表现非常好，因此您可以设置一些 mongrel 并为它们设置 IIS 或 Apache 代理。或者直接使用 Mongrel。在 mod_rails 之前，mongrel 是在任何平台上部署的事实上的方式，因此它是一个非常可行的选择。

然而，有一次我被迫在 Windows 上部署，我通过 virtualbox 安装了 Ubuntu（当然也可以使用 VMWare 或其他什么）并部署在上面。像梦一样工作，我必须使用一个明智的操作系统。呸。SSH 之类的。没有它就活不下去。远程桌面不完全是我喜欢的东西。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-21T20:59:14.030

最好的办法是设置一个 Mongrel 集群。Mongrel 是一个应用服务器，可以在 HTTP 上为 Rails 应用提供服务。但是单个 Mongrel 实例只能同时处理 1 个请求，所以通常人们运行一个Mongrel*集群*，即多个 Mongrel 实例。这些 Mongrel 实例不直接与 Internet 通信。相反，它们被放置在负载均衡器或 Web 服务器之后，这些服务器将请求代理到这个 Mongrels 集群。如果您在 Windows 上使用 Apache，那么您可以： 1\. 设置并启动一个 Mongrel 集群，每个都侦听自己的端口。2\. 使用一些 mod_proxy_balancer 指令设置一个虚拟主机，您可以使用它告诉 mod_proxy_balancer 将所有请求代理到 Mongrel 集群。mod_proxy_balancer 将自动在 Mongrel 之间分配负载。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-22T09:39:28.337

如果使用率非常低，即一次可能主要是 1 人，或者您的响应时间*非常*低，那么您可以使用一个杂种并让您的用户将浏览器指向相关的 IP 地址和端口。

在我最终将我的应用程序迁移到我们的公司 Linux/apache“云”之前的一段时间（这并不简单，主要是内部 IT 相关的原因）我在工作站上运行了两个应用程序，使用单独的 mongrel（不同的端口）对于每个。它运行良好，可以使用近一年。

这些天（嗯，现在大约三周）我已经用本地（在我的办公桌下）访问的即时性、控制性和脆弱性代替了五台服务器的稳定性，每台服务器都有多个杂种、暂存区和部署烦恼。秋千和环形交叉路口。

# iphone - 更改 UINavigationBar 高度

> ID：894985
> 
> 赞同：22
> 
> 时间：2009-05-21T20:32:22.557
> 
> 标签：iphone, ios, cocoa-touch, height, uinavigationbar

有人可以告诉我如何更改导航栏的高度吗？

这是我到目前为止所拥有的：

```
CGFloat navBarHeight = 10;
self.navigationController.navigationBar.frame.size.width = navBarHeight; 
```

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2012-01-17T12:35:11.717

您可以创建一个基于`UINavigationBar`这样的类别类

.h 文件

```
#import UIKit/UIKit.h    
@interface UINavigationBar (myNave)
- (CGSize)changeHeight:(CGSize)size;
@end 
```

和 .m 文件

```
#import "UINavigationBar+customNav.h"
@implementation UINavigationBar (customNav)
- (CGSize)sizeThatFits:(CGSize)size {
    CGSize newSize = CGSizeMake(320,100);
    return newSize;
}
@end 
```

它工作得很好。

* * *

## 回答 #2

> 赞同：21
> 
> 时间：2011-09-23T18:07:44.617

您不应更改导航栏的高度。来自 Apple Programming Guide on View Controller：

**自定义导航栏外观**

在导航界面中，导航控制器拥有它的 UINavigationBar 对象并负责管理它。不允许更改导航栏对象或直接修改其边界、框架或 alpha 值。但是，允许修改一些属性，包括：

● barStyle 属性

● 透光性

● tintColor 属性

（取自苹果： [https](https://developer.apple.com/library/ios/documentation/WindowsViews/Conceptual/ViewControllerCatalog/Chapters/NavigationControllers.html) ://developer.apple.com/library/ios/documentation/WindowsViews/Conceptual/ViewControllerCatalog/Chapters/NavigationControllers.html ）

-- 更新 -- IOS 7 --- 仍然只能更改可用的属性，但下面是关于如何在导航栏中实现灵活性的一个很好的教程[http://www.appcoda.com/customize-navigation-status-bar -IOS 7/](http://www.appcoda.com/customize-navigation-status-bar-ios-7/)

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2014-09-26T08:05:46.710

我已经解决了这个问题，我创建了 UINavigationController 的子类。在这个 MainNavigationViewController.m 文件中，我重写了 viewDidLayoutSubviews() 方法，在这里我为 self.navigationBar 设置了框架

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2017-06-30T23:56:45.070

sizeThatFits：不再适用于 iOS11 UINavigationBar 子类。Apple Engineering 已确认该技术从未受到支持，并且随着 iOS11 的更改 sizeThatFits: 不再被咨询。

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2012-12-04T07:30:00.783

覆盖 viewController 中的 -(void)viewWillAppear 方法并尝试下面的代码，

```
- (void)viewWillAppear {

UINavigationBar *navigationBar = [[self navigationController] navigationBar];
CGRect frame = [navigationBar frame];
frame.size.height = 82.0f;
[navigationBar setFrame:frame];
} 
```

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2009-07-24T04:49:48.547

尝试使用 -

```
CGFloat navBarHeight = 10.0f;    
CGRect frame = CGRectMake(0.0f, 0.0f, 320.0f, navBarHeight);
[self.navigationController.navigationBar setFrame:frame]; 
```

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2015-06-25T15:45:25.077

最简单有效的解决方案是在导航栏中添加一个类别。（但也许不是最好的解决方案）

```
@interface UINavigationBar (CustomHeight)

@end

@implementation UINavigationBar (CustomHeight)

- (CGSize)sizeThatFits:(CGSize)size {
    CGRect screenRect = [[UIScreen mainScreen] bounds];
    return CGSizeMake(screenRect.size.width, kNavBarHeightNoStatus);
}
@end 
```

knavBarHeightNoStatus 是导航栏的高度。我们使用 UIScreen 边界是因为 UINavigationBar 的框架是错误的

PS：小心，使用 SideMenu 可能会遇到一些问题

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2011-08-11T01:53:46.420

`self.navigationController.navigationBar.frame`是`readonly`iOS 版本 4.x 上的属性

它会被改变，即使你会看到异常行为。

例如，当应用程序状态更改为后台并返回前台时，导航栏将显示原始大小的高度

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2015-08-31T21:21:20.437

根据选择的方法，我遇到了很多问题。在我的具体情况下，导航栏隐藏在整个应用程序中，但设置视图控制器中除外。由于我需要指定导航栏的自定义高度并同时显示导航栏，源视图控制器和设置视图控制器之间的segue 有一个非常草率的动画。

绝对最好的解决方案可以在这里找到：[https](https://gist.github.com/maciekish/c2c903d9b7e7b583b4b2) ://gist.github.com/maciekish/c2c903d9b7e7b583b4b2 。我刚刚将类别导入到设置视图控制器中，并`viewDidLoad`调用了`setHeight:`“self.navigationController.navigationBar”上的方法。看起来很棒！

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2015-11-07T07:44:14.163

以下代码不会影响框架中除高度以外的其他参数

```
 [self.navigationController.navigationBar setFrame:CGRectMake(self.navigationController.navigationBar.frame.origin.x, self.navigationController.navigationBar.frame.origin.y, self.navigationController.navigationBar.frame.size.width, 150)]; 
```

如果您想更改其他参数意味着，只需编辑任何一个参数....

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2017-03-03T14:55:37.183

创建类别并覆盖**sizeThatFits(_ size: CGSize) -> CGSize**方法会更改整个应用程序的 UINavigationBar 大小。假设您只想在一个特定的 ViewController 中更改 UINavigationBar 高度/大小（在我的情况下）

我就是这样做的。

```
extension UINavigationBar {
    open override func sizeThatFits(_ size: CGSize) -> CGSize {
        let v = self.value(forKey: "frame") as? CGRect
        return v?.size ?? CGSize(width: UIScreen.main.bounds.width, height: 44)
    }
} 
```

在调用者 ViewController 中看起来像

```
override func viewDidLoad() {
    super.viewDidLoad()
    configureNavigationBar()
}

private func configureNavigationBar() {
    var naviBarFrame = self.navigationController?.navigationBar.frame
    naviBarFrame?.size.height = 74
    let rect = naviBarFrame ?? CGRect(x: 0, y: 20, width: UIScreen.main.bounds.width, height: 74)
    self.navigationController?.navigationBar.setValue(rect, forKey: "frame")
} 
```

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2016-05-10T10:57:23.467

**`- (void)viewDidLayoutSubviews`**在方法里面试试这个代码 ，

```
CGFloat navBarHeight = 10.0f;    
CGRect frame = CGRectMake(0.0f, 0.0f, 320.0f, navBarHeight);
[self.navigationController.navigationBar setFrame:frame]; 
```

# php - 无法访问 usort 函数中的全局变量？

> ID：894990
> 
> 赞同：2
> 
> 时间：2009-05-21T20:34:40.960
> 
> 标签：php

我正在尝试在 PHP 中进行 usort，但我无法访问 usort 函数中的全局变量。

我已将我的代码简化为简明扼要的内容，以说明我的意思：

```
$testglobal = 1;
function cmp($a, $b) {
    global $testglobal;
    echo 'hi' . $testglobal;
}
usort($topics, "cmp"); 
```

假设 usort 运行两次，我的期望是这将是输出：

```
hi1hi1 
```

相反，我的输出是：

```
hihi 
```

我已经阅读了手册（[http://us.php.net/usort](http://us.php.net/usort)）并且我没有看到访问全局变量的任何限制。如果我将 usort 分配给我回显的变量，它会输出 1，因此 usort 肯定运行成功（另外，所有这些“hi”）。

我在这里做了一些非常愚蠢的事情吗？如果没有，是否有解决方法？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-21T20:41:20.087

无法重现“错误”，键盘也无法重现：http: [//codepad.org/5kwctnDP](http://codepad.org/5kwctnDP)

您还可以使用对象属性而不是全局变量

```
<?php
class Foo {
    protected $test = 1;
    public function bar($a, $b) {
        echo 'hi' . $this->test;
        return strcmp($a, $b);
    }
}

$topics = array(1,2,3);
$foo = new Foo;
usort($topics, array($foo, 'bar')); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-21T21:47:22.497

我在问题中输入的代码被放入 bbPress 上的模板中，这是 Wordpress 的论坛表亲。一位朋友告诉我，“如果在定义变量之前没有全局变量，有时 PHP 会表现得很奇怪，这取决于代码在执行时的嵌套程度 - bbPress 在模板输出时会执行一些复杂的包含”。

所以我尝试了它并且它有效：

```
global $hi123;
$hi123 = ' working '; 
```

我正在回答我自己的问题，以防像我这样的另一个白痴在 Google 搜索中找到这个问题。:-)

不过，我将接受 VolkerK 的回答，因为对象解决方法非常聪明。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-21T20:39:48.670

如果您使用超全局[`$GLOBALS`](http://us.php.net/manual/en/reserved.variables.globals.php)数组访问变量，它是否有效？

```
$testglobal = 1;
function cmp($a, $b) {
    echo 'hi' . $GLOBALS['testglobal'];
}
usort($topics, "cmp"); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-21T20:42:40.867

它从 php 5.2.4 开始工作

```
$testglobal = ' WORKING ';
$topics = array('a','b','c');      
function cmp($a, $b) {
    global $testglobal;
    echo 'hi' . $testglobal;
}
usort($topics, "cmp");
// hi WORKING hi WORKING 
```

# c# - 增加 Silverlight DataGrid 中的列宽以填充整个 DG 宽度

> ID：894991
> 
> 赞同：16
> 
> 时间：2009-05-21T20:34:59.523
> 
> 标签：c#, silverlight, datagrid, width

我有一个绑定到 SQL 表的 DataGrid 控件。

XAML 代码是：

```
<data:DataGrid x:Name="dg_sql_data" 
                       Grid.Row="1" 
                       Visibility="Collapsed" 
                       Height="auto" 
                       Margin="0,5,5,5"
                       AutoGenerateColumns="false"
                       AlternatingRowBackground="Aqua"
                       Opacity="80"
                       >
    <data:DataGrid.Columns>
        <data:DataGridTextColumn Header="Latitude" Binding="{Binding lat}" />
        <data:DataGridTextColumn Header="Longitude" Binding="{Binding long}" />
        <data:DataGridTextColumn Header="Time" Binding="{Binding time}" />
    </data:DataGrid.Columns>
</data:DataGrid> 
```

是否可以增加单列大小以填充数据网格的完整宽度？

谢谢，
亨里克

**编辑：Silverlight SDK 4 附带以“*”为宽度的列。**

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-05-22T13:40:41.207

解决方案：

```
 void dg_sql_data_SizeChanged(object sender, SizeChangedEventArgs e)
    {
        DataGrid myDataGrid = (DataGrid)sender;
        // Do not change column size if Visibility State Changed
        if (myDataGrid.RenderSize.Width != 0)
        {
            double all_columns_sizes = 0.0;
            foreach (DataGridColumn dg_c in myDataGrid.Columns)
            {
                all_columns_sizes += dg_c.ActualWidth;
            }
            // Space available to fill ( -18 Standard vScrollbar)
            double space_available = (myDataGrid.RenderSize.Width - 18) - all_columns_sizes;
            foreach (DataGridColumn dg_c in myDataGrid.Columns)
            {
                dg_c.Width = new DataGridLength(dg_c.ActualWidth + (space_available / myDataGrid.Columns.Count));
            }
        }
    } 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-11-15T03:24:32.163

## **仅在 WPF 中测试，未在 Silverlight 中测试：**

我在 WPF 3.5 SP1 中进行了设置，它运行良好，对 Silverlight 没有任何保证，但如果它运行，它确实很迷人。

```
<data:DataGridTextColumn Header="Time" Binding="{Binding}" Width="*" /> 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-11-15T04:14:17.457

我为 DataGrid 创建了一个[附加属性](http://code.msdn.microsoft.com/SLDataGridProperties)，可让您在 XAML 中执行此操作：

```
<UserControl 
    xmlns:data="clr-namespace:System.Windows.Controls;assembly=System.Windows.Controls.Data"  
    x:Class="GridProperties.Page"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation" 
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml" 
    xmlns:gp="clr-namespace:GridProperties">
<Grid x:Name="LayoutRoot" Background="White">
    <data:DataGrid gp:GridEx.StarColumn="2">
        <data:DataGrid.Columns>
            <data:DataGridTextColumn Header="Column 1"/>
            <data:DataGridTextColumn Header="Column 2"/>
            <data:DataGridTextColumn Header="Column 3"/>
        </data:DataGrid.Columns>
    </data:DataGrid>
</Grid>
</UserControl> 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2011-08-17T18:55:14.927

在 silverlight 4 中：只需在 DataGrid 上设置 ColumnWidth="*"

```
<data:DataGrid ColumnWidth="*" /> 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2011-08-10T20:36:00.753

基于 Henrik P 的回答，这个解决方案只是简单地解决了这个错误，`Width='*'`这样您就可以像在网格上一样将任何列设置为成比例：

```
 private void DgSQLDataSizeChanged(object sender, SizeChangedEventArgs e)
    {
        var myDataGrid = (DataGrid)sender;

        // Do not change column size if Visibility State Changed
        if (myDataGrid.RenderSize.Width == 0) return;

        double totalActualWidthOfNonStarColumns = myDataGrid.Columns.Sum(
            c => c.Width.IsStar ? 0 : c.ActualWidth);

        double totalDesiredWidthOfStarColumns = 
            myDataGrid.Columns.Sum(c => c.Width.IsStar ? c.Width.Value : 0);

        if ( totalDesiredWidthOfStarColumns == 0 ) 
            return;  // No star columns

        // Space available to fill ( -18 Standard vScrollbar)
        double spaceAvailable = (myDataGrid.RenderSize.Width - 18) - totalActualWidthOfNonStarColumns;

        double inIncrementsOf = spaceAvailable/totalDesiredWidthOfStarColumns;

        foreach (var column in myDataGrid.Columns)
        {
            if ( !column.Width.IsStar ) continue;

            var width = inIncrementsOf * column.Width.Value;
            column.Width = new DataGridLength(width, DataGridLengthUnitType.Star);
        }
    } 
```

我喜欢 Henrik 的回答，但需要两列来填充额外的空间，比如网格。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-06-01T13:36:15.947

您可以以编程方式设置它：

```
var col = new DataGridTextColumn();
col.Width = new DataGridLength(100, DataGridLengthUnitType.Star);                        
Grid1.Columns.Add(col); 
```

# c# - C# ListView 添加项目的问题

> ID：894992
> 
> 赞同：0
> 
> 时间：2009-05-21T20:35:02.363
> 
> 标签：c#, listview, listviewitem

所以，这是我的问题：为什么当第二个代码段正常工作时，第一个代码段中的代码不能工作。另外，我已将视图属性设置为详细信息。我已经阅读了如何将 lvi 添加到列表视图中的所有内容，并且每次都失败...除了我手动执行此操作。

所以，这行不通...

```
// Iterating through the rows...
for (int x = 0; x < numRows; x++) {
    row = new List<string>();
    // Iterating through the cols...
    for (int y = 0; y < numCols; y++) {
        row.Add(data[y][x]);
    }
    lv.Items.Add(new ListViewItem(row.ToArray()));
} 
```

但这会起作用：

```
lv.Items.Add(new ListViewItem("foo")); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-21T20:45:21.517

`row.Add(data[y][x])`似乎很可疑。为什么要以列优先顺序访问数据，但以行优先顺序进行迭代？另外，请确保`row`（您没有告诉我们）的类型实际上是`List<string>`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-21T20:44:48.973

ListViewItem 正在寻找 String[] 尝试将 row.ToArray() 转换为 String[]。***``************