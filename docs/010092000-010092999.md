# StackOverflow 问答 10092000-10092999

# c++ - 为什么编译器没有在堆栈上保留足够的空间？

> ID：10092000
> 
> 赞同：0
> 
> 时间：2012-04-10T15:46:59.097
> 
> 标签：c++, multidimensional-array, linker, stack, segmentation-fault

我有一个`Matrix22`带有数组和默认构造函数的 C++ 类：

```
class Matrix22{
  /* something more */
  double mat[2][2];
  Matrix22(){
    for(int i=0; i<2; i++)
      for(int j=0; j<2; j++)
        mat[i][j] = i==j ? 1.0 : 0.0;
  }
}; 
```

我在我的程序中使用它并遇到了分段错误。由于其余部分非常困难和复杂，我编写了一个简单的测试例程，它只调用`Matrix22()`. 没有更多的段错误。

然后我跑去`gdb`调试问题。如果我从单独的测试例程中调用构造函数，`gcc`则为成员保留一些内存`mat`。我可以在堆栈中导航并在数组后面的一些字节中查看返回地址。

在主程序中，编译器没有保留足够的空间。第一个元素 ( `mat[0][0]`) 被写入，但任何进一步的写入只会覆盖下一个堆栈帧。我还可以验证，与构造函数之前一样，该命令`bt`返回正确的回溯，在关键分配之后回溯已损坏。

所以我的问题是：为什么在一种情况下编译器（或链接器？）没有为数组保留足够的空间，而在另一种情况下却没有发生？

PS：两个“测试用例”都使用相同的编译器和标志编译，并且还链接到相同的目标文件。

编辑：

这是没有段错误的“简单”测试用例：

```
void test_Matrix22()
{
  Framework::Math::Matrix22 matrix;
} 
```

创建 seg 错误的代码在类中`ModuleShaddower`（混合的标头和实现）：

```
class ModuleShaddower{
    public:
        ModuleShaddower(PVModule& module, const EnvironmentalSetup& setup, const Position& position);
    private:
        Matrix22 rotMatrix90;
};

ModuleShaddower::ModuleShaddower(PVModule& module, const EnvironmentalSetup& setup, const Position& position)
  : module (module), position(position), setup(setup), logger(LoggerFactory::getLoggerInstance())
{
    double mat[][2] = {{0, -1},{1, 0}}; // This line will never be reached
    rotMatrix90 = Matrix22(mat);
} 
```

如您所见，它完全来自其他地方。我可能会尝试提取有问题的代码，但我认为这不会有太大帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-19T06:52:51.867

问题是由于不同位置的两个目标文件具有相同的名称。在从该目标代码创建的生成的静态库中，有时会替换错误的文件（两者都被调用`Shaddower.o`）。当我重命名其中一个文件时，一切顺利，没有更多错误。

我不知道这个问题的确切起源，但它是可以解决的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-10T16:16:58.463

如果未达到您的 ModuleShaddower 构造函数代码（根据您的代码注释），那么构造函数初始化列表中的某些内容（与模块的构造、位置等有关）会导致问题。

# .net - Silverlight 应用程序的 Web.Config 与 Silverlight 托管应用程序的 Web.Config

> ID：10092001
> 
> 赞同：1
> 
> 时间：2012-04-10T15:47:00.217
> 
> 标签：.net, wcf, silverlight, web-config

我创建了一个新的 silverlight 业务应用程序。因此，我在解决方案中有两个项目，一个是 silverlight 应用程序和 silverlight 托管 Web 应用程序。每个项目都有自己的 web.config 文件。请告诉我这两个配置文件有什么区别。

由于缺乏意识，我对以下地方感到震惊。

我想使用 WCF 服务，它使用 MySQL 数据库。因此，哪个 web.config 是定义连接字符串和角色提供者的理想位置。任何拇指规则将不胜感激

编辑 1:: 如何确定这两个文件中其他配置的理想位置。哪个配置转到哪个 web.config 文件。（请保留不清楚的编辑）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-10T17:39:39.740

你应该把你的连接字符串放在你的解决方案的服务器端。客户端应用程序不应该知道与服务器相关的数据库和其他进程的任何信息。客户端（silverlight 应用程序）应该使用 WCF 请求所需的数据。

PS 在客户端的 app.config 中，您可以放置​​例如记录器配置（因为每个客户端都应该编写自己的日志）等。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-10T17:43:51.883

我有类似的设置。在 WCF 服务所在的项目的 ASP.Net 端，将连接字符串放在该 web.config 文件中。该项目的 Silverlight 部分不受信任，因为它存在于野外，任何人都可以将其拆开。Silverlight 端的配置文件是您指定将与 ASP.Net 端对话的服务引用的地方。

# ruby-on-rails - ruby 获取 url 中当前目录的参数

> ID：10092010
> 
> 赞同：0
> 
> 时间：2012-04-10T15:47:31.390
> 
> 标签：ruby-on-rails, ruby

我习惯于`params[:type]'`在尝试抓取时使用红宝石，`?type=this`但有没有办法从中`page`获得`http://localhost:3000/admin/test/page`？也许有一个`params[0]`或类似的东西？测试后只需要目录的名称..

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-10T16:07:21.787

`request.url`并使用 ruby​​ 来剥离除页面之外的所有内容。或者您可以`admin/test/:id`在您的 routes.rb 中定义并管理控制器中的 id。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-10T16:06:31.880

/page 将路由到您的方法。所以你应该知道它已经是什么了。

# spring - 为什么我的应用程序会出现与 spring-form.tld 相关的错误

> ID：10092013
> 
> 赞同：0
> 
> 时间：2012-04-10T15:47:36.170
> 
> 标签：spring, jboss

我目前正在为 JBoss 4.2.3 构建的 Spring 2.5.5 应用程序迁移到 Jboss 5.1.0。

当我尝试部署完全相同的战争文件时，我收到此错误

```
 15:59:30,248 INFO  [TomcatDeployment] deploy, ctxPath=/webApp
15:59:31,023 ERROR [TldConfig] Error processing TLD files for context path /webApp
javax.servlet.ServletException: Exception processing TLD at resource path /WEB-INF/tld/spring-form.tld in context /webApp
        at org.apache.catalina.startup.TldConfig.tldScanTld(TldConfig.java:543)
        at org.apache.catalina.startup.TldConfig.execute(TldConfig.java:299)
        at org.apache.catalina.startup.TldConfig.lifecycleEvent(TldConfig.java:734)
        at org.apache.catalina.util.LifecycleSupport.fireLifecycleEvent(LifecycleSupport.java:117)
        at org.apache.catalina.core.StandardContext.start(StandardContext.java:4308)
        at org.jboss.web.tomcat.service.deployers.TomcatDeployment.performDeployInternal(TomcatDeployment.java:310)
        at org.jboss.web.tomcat.service.deployers.TomcatDeployment.performDeploy(TomcatDeployment.java:142)
        at org.jboss.web.deployers.AbstractWarDeployment.start(AbstractWarDeployment.java:461)
        at org.jboss.web.deployers.WebModule.startModule(WebModule.java:118)
        at org.jboss.web.deployers.WebModule.start(WebModule.java:97)
        at sun.reflect.GeneratedMethodAccessor367.invoke(Unknown Source)
        at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)
        at java.lang.reflect.Method.invoke(Method.java:597)
        at org.jboss.mx.interceptor.ReflectedDispatcher.invoke(ReflectedDispatcher.java:157)
        at org.jboss.mx.server.Invocation.dispatch(Invocation.java:96)
        at org.jboss.mx.server.Invocation.invoke(Invocation.java:88)
        at org.jboss.mx.server.AbstractMBeanInvoker.invoke(AbstractMBeanInvoker.java:264)
        at org.jboss.mx.server.MBeanServerImpl.invoke(MBeanServerImpl.java:668)
        at org.jboss.system.microcontainer.ServiceProxy.invoke(ServiceProxy.java:206)
        at $Proxy38.start(Unknown Source)
        at org.jboss.system.microcontainer.StartStopLifecycleAction.installAction(StartStopLifecycleAction.java:42)
        at org.jboss.system.microcontainer.StartStopLifecycleAction.installAction(StartStopLifecycleAction.java:37)
        at org.jboss.dependency.plugins.action.SimpleControllerContextAction.simpleInstallAction(SimpleControllerContextAction.java:62)
        at org.jboss.dependency.plugins.action.AccessControllerContextAction.install(AccessControllerContextAction.java:71)
        at org.jboss.dependency.plugins.AbstractControllerContextActions.install(AbstractControllerContextActions.java:51)
        at org.jboss.dependency.plugins.AbstractControllerContext.install(AbstractControllerContext.java:348)
        at org.jboss.system.microcontainer.ServiceControllerContext.install(ServiceControllerContext.java:286)
        at org.jboss.dependency.plugins.AbstractController.install(AbstractController.java:1631)
        at org.jboss.dependency.plugins.AbstractController.incrementState(AbstractController.java:934)
        at org.jboss.dependency.plugins.AbstractController.resolveContexts(AbstractController.java:1082)
        at org.jboss.dependency.plugins.AbstractController.resolveContexts(AbstractController.java:984)
        at org.jboss.dependency.plugins.AbstractController.change(AbstractController.java:822)
        at org.jboss.dependency.plugins.AbstractController.change(AbstractController.java:553)
        at org.jboss.system.ServiceController.doChange(ServiceController.java:688)
        at org.jboss.system.ServiceController.start(ServiceController.java:460)
        at org.jboss.system.deployers.ServiceDeployer.start(ServiceDeployer.java:163)
        at org.jboss.system.deployers.ServiceDeployer.deploy(ServiceDeployer.java:99)
        at org.jboss.system.deployers.ServiceDeployer.deploy(ServiceDeployer.java:46)
        at org.jboss.deployers.spi.deployer.helpers.AbstractSimpleRealDeployer.internalDeploy(AbstractSimpleRealDeployer.java:62)
        at org.jboss.deployers.spi.deployer.helpers.AbstractRealDeployer.deploy(AbstractRealDeployer.java:50)
        at org.jboss.deployers.plugins.deployers.DeployerWrapper.deploy(DeployerWrapper.java:171)
        at org.jboss.deployers.plugins.deployers.DeployersImpl.doDeploy(DeployersImpl.java:1439)
        at org.jboss.deployers.plugins.deployers.DeployersImpl.doInstallParentFirst(DeployersImpl.java:1157)
        at org.jboss.deployers.plugins.deployers.DeployersImpl.doInstallParentFirst(DeployersImpl.java:1178)
        at org.jboss.deployers.plugins.deployers.DeployersImpl.install(DeployersImpl.java:1098)
        at org.jboss.dependency.plugins.AbstractControllerContext.install(AbstractControllerContext.java:348)
        at org.jboss.dependency.plugins.AbstractController.install(AbstractController.java:1631)
        at org.jboss.dependency.plugins.AbstractController.incrementState(AbstractController.java:934)
        at org.jboss.dependency.plugins.AbstractController.resolveContexts(AbstractController.java:1082)
        at org.jboss.dependency.plugins.AbstractController.resolveContexts(AbstractController.java:984)
        at org.jboss.dependency.plugins.AbstractController.change(AbstractController.java:822)
        at org.jboss.dependency.plugins.AbstractController.change(AbstractController.java:553)
        at org.jboss.deployers.plugins.deployers.DeployersImpl.process(DeployersImpl.java:781)
        at org.jboss.deployers.plugins.main.MainDeployerImpl.process(MainDeployerImpl.java:702)
        at org.jboss.system.server.profileservice.repository.MainDeployerAdapter.process(MainDeployerAdapter.java:117)
        at org.jboss.system.server.profileservice.hotdeploy.HDScanner.scan(HDScanner.java:362)
        at org.jboss.system.server.profileservice.hotdeploy.HDScanner.run(HDScanner.java:255)
        at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:441)
        at java.util.concurrent.FutureTask$Sync.innerRunAndReset(FutureTask.java:317)
        at java.util.concurrent.FutureTask.runAndReset(FutureTask.java:150)
        at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.access$101(ScheduledThreadPoolExecutor.java:98)
        at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.runPeriodic(ScheduledThreadPoolExecutor.java:180)
        at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:204)
        at java.util.concurrent.ThreadPoolExecutor$Worker.runTask(ThreadPoolExecutor.java:886)
        at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:908)
        at java.lang.Thread.run(Thread.java:662)
Caused by: java.lang.IllegalArgumentException: Invalid TLD resource path /WEB-INF/tld/spring-form.tld
        at org.apache.catalina.startup.TldConfig.tldScanTld(TldConfig.java:531) 
```

我的应用程序中根本没有使用 Spring 表单。这是 JBoss 5.1.0 特有的吗？我应该将 jar 升级到 Spring 3.1.1 还是其他版本？

为所有问题道歉，但我不是世界上最伟大的程序员。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-11T13:13:59.120

作为对我们的评论的回应（并将这个问题标记为有答案），如果您没有在任何 JSP 中使用 taglib，那么您可以从 web.xml 中删除对它的引用。

为什么这在其他人可以添加的早期版本的 JBoss 中有效，可能会有一个答案

# ruby-on-rails-3 - Rails Devise 2.0 自己的注销操作

> ID：10092017
> 
> 赞同：0
> 
> 时间：2012-04-10T15:47:41.937
> 
> 标签：ruby-on-rails-3, ruby-on-rails-3.1, devise

我使用设计，我想做我的注销操作。

我想做的是，当我注销时，我想创建一个自己的 JSON 对象来返回。这时候，在我登出后，我得到了我所有的根文章。

我如何编写自己的破坏动作，就像我找到了创建动作一样？

```
class SessionsController < Devise::SessionsController

  def create
    resource = warden.authenticate!(:scope => resource_name, :recall => :failure)
    return sign_in_and_redirect(resource_name, resource)
  end

  def sign_in_and_redirect(resource_or_scope, resource=nil)
    scope = Devise::Mapping.find_scope!(resource_or_scope)
    resource ||= resource_or_scope
    sign_in(scope, resource) unless warden.user(scope) == resource
    return render :json => {:success => true, :redirect => stored_location_for(scope) || after_sign_in_path_for(resource)}
  end

  def failure
    return render:json => {:success => false, :errors => ["Login failed."]}
  end

end 
```

还有我在 routes.rb 中的路线

```
 devise_for :users, :controllers => {:session => "sessions"} do
    get "/users/sing_out" => "devise/sessions#destroy"
  end 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-10T20:34:17.550

这是会话控制器的销毁方法。

您应该能够根据您的需要对其进行自定义。我认为添加另一个操作并在那里实现您的自定义行为会更明智，因为这不太可能在未来升级设计时导致意外错误。

```
 # DELETE /resource/sign_out
  def destroy
    redirect_path = after_sign_out_path_for(resource_name)
    signed_out = (Devise.sign_out_all_scopes ? sign_out : sign_out(resource_name))
    set_flash_message :notice, :signed_out if signed_out

    # We actually need to hardcode this as Rails default responder doesn't
    # support returning empty response on GET request
    respond_to do |format|
      format.any(*navigational_formats) { redirect_to redirect_path }
      format.all do
        method = "to_#{request_format}"
        text = {}.respond_to?(method) ? {}.send(method) : ""
        render :text => text, :status => :ok
      end
    end
  end 
```

# codeigniter - codeigniter 输出缓存不起作用？

> ID：10092023
> 
> 赞同：1
> 
> 时间：2012-04-10T15:47:54.887
> 
> 标签：codeigniter, caching, web

我`$this->output->cache(n)`用来缓存网页，但我不知道它是如何工作的。我没有在`system/cache`文件夹下找到任何缓存文件……而且在我编辑页面并再次显示后，内容发生了变化，所以它似乎该页面并未真正缓存。有人可以帮忙吗？（我正在使用 phil 的模板库）我的代码：

```
function show(){

    $this->output->cache(5);

    $this->load->model('page_model');
    $var = $this->uri->segment(3, 0); //get About page
    $row = $this->page_model->getPage($var);
    $this->template->title('about')
                   ->set_layout('default')
                   ->set_partial('styles', 'css')
                   ->set('data', $row->body)
                   ->build('about');

} 
```

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-10T15:54:07.653

[如文档中所述，有](http://codeigniter.com/user_guide/general/caching.html)两件事：

> 警告：由于 CodeIgniter 存储输出内容的方式，缓存仅在您使用[view](http://codeigniter.com/user_guide/general/views.html)为控制器生成显示时才有效。

也许不使用“本机”视图是一个问题？

此外：

> 注意：在写入缓存文件之前，您必须设置应用程序/缓存文件夹的文件权限，使其可写。

您确定您的`application/cache`目录具有正确的权限吗？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2015-08-30T17:33:04.037

调试这个文件并检查它实际上是在写缓存：system/core/Output.php

```
// Do we need to write a cache file?  Only if the controller does not have its
// own _output() method and we are not dealing with a cache file, which we
// can determine by the existence of the $CI object above
if ($this->cache_expiration > 0 && isset($CI) && ! method_exists($CI, '_output'))
{
    $this->_write_cache($output);
} 
```

这对我很有效：

```
function _output($content) {
        // Load the base template with output content available as $content
        $data['content'] = &$content;

        $this->output->cache(600);

        $output = $this->load->view('base', $data, true);

        $this->output->_write_cache($output);

        echo $output;
    } 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2016-06-15T14:04:16.873

您确定您的应用程序/缓存目录具有正确的权限吗？

你你到 cpanel 中的目录 application/cache ，权限变成 777 就可以了

# iphone - AVAssetWriter 元数据需要什么数据？

> ID：10092029
> 
> 赞同：7
> 
> 时间：2012-04-10T15:48:18.553
> 
> 标签：iphone, ios, metadata, avassetwriter, transcoding

我正在尝试将元数据添加到通过 AVAssetWriter 进行转码的视频中。我尝试创建 AVMutableMetadataItem 对象，将其插入数组并设置 AVAssetWriter 对象的元数据属性。结果文件不包括提供的元数据。

媒体信息：

```
 AVMutableMetadataItem *mutableItem = [AVMutableMetadataItem metadataItem];
 mutableItem.keySpace = AVMetadataKeySpaceQuickTimeUserData;
 mutableItem.key = AVMetadataQuickTimeUserDataKeyCredits;
 mutableItem.value = @"credit to me";

 assetWriter.metadata = [NSArray arrayWithObject:mutableItem]; 
```

请帮忙谢谢

# php - php在数组赋值中将字符串连接到classconstant

> ID：10092031
> 
> 赞同：0
> 
> 时间：2012-04-10T15:48:22.763
> 
> 标签：php, arrays, class-constants

以下不起作用：

```
<?php
class test{
    const t = 10;
    public static $y = array('t' => self::t . 'hello');
}
var_dump(test::$y);
?> 
```

有人能告诉我这是为什么吗？:)

它在 ... => self::t 中失败。'hello')... 部分，作为接缝，它不能在 array() 中连接一个类常量。

这意味着以下两项工作都很完美：

```
public static $y = array('t' => self::t); 
```

和

```
public static $y = array('t' => 'hello'); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-10T15:54:55.617

> 有人能告诉我这是为什么吗？

串联是运行时的产物。类成员初始值必须在解析时已知。

# sql - 从间隔数据类型中提取总秒数

> ID：10092032
> 
> 赞同：38
> 
> 时间：2012-04-10T15:48:26.633
> 
> 标签：sql, oracle, plsql

当减去`timestamps`返回值是一个`interval`数据类型。有没有一种优雅的方法可以将此值转换为间隔中的（毫秒/微）秒总数，即整数。

以下将起作用，但它不是很漂亮：

```
select abs( extract( second from interval_difference ) 
          + extract( minute from interval_difference ) * 60 
          + extract( hour from interval_difference ) * 60 * 60 
          + extract( day from interval_difference ) * 60 * 60 * 24
            )
  from ( select systimestamp - (systimestamp - 1) as interval_difference
           from dual ) 
```

SQL 或 PL/SQL 中是否有更优雅的方法？

* * *

## 回答 #1

> 赞同：29
> 
> 时间：2016-08-12T03:32:16.900

一个简单的方法：

```
select extract(day from (ts1-ts2)*86400) from dual; 
```

想法是将间隔值按 86400 (= 24*60*60) 的倍数转换为天数。然后提取“day”值，这实际上是我们想要的第二个值。

* * *

## 回答 #2

> 赞同：26
> 
> 时间：2012-04-11T06:40:53.853

我希望这会有所帮助：

```
zep@dev> select interval_difference
      2        ,sysdate + (interval_difference * 86400) - sysdate as fract_sec_difference
      3  from   (select systimestamp - (systimestamp - 1) as interval_difference
      4          from   dual)
      5 ;

INTERVAL_DIFFERENCE                                                             FRACT_SEC_DIFFERENCE
------------------------------------------------------------------------------- --------------------
+000000001 00:00:00.375000                                                                 86400,375 
```

通过您的测试：

```
zep@dev> select interval_difference
      2        ,abs(extract(second from interval_difference) +
      3        extract(minute from interval_difference) * 60 +
      4        extract(hour from interval_difference) * 60 * 60 +
      5        extract(day from interval_difference) * 60 * 60 * 24) as your_sec_difference
      6        ,sysdate + (interval_difference * 86400) - sysdate as fract_sec_difference
      7        ,round(sysdate + (interval_difference * 86400) - sysdate) as sec_difference
      8        ,round((sysdate + (interval_difference * 86400) - sysdate) * 1000) as millisec_difference
      9  from   (select systimestamp - (systimestamp - 1) as interval_difference
     10          from   dual)
     11  /

INTERVAL_DIFFERENCE                                                             YOUR_SEC_DIFFERENCE FRACT_SEC_DIFFERENCE SEC_DIFFERENCE MILLISEC_DIFFERENCE
------------------------------------------------------------------------------- ------------------- -------------------- -------------- -------------------
+000000001 00:00:00.515000                                                                86400,515            86400,515          86401            86400515

zep@dev> 
```

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2015-01-02T08:06:47.883

我发现这行得通。显然，如果您使用时间戳进行算术运算，它们将转换为某种内部数据类型，当彼此相减时，将间隔作为数字返回。

简单的？是的。优雅的？不。完成工作了吗？哦耶。

```
SELECT ( (A + 0) - (B + 0) ) * 24 * 60 * 60 
FROM
(
   SELECT SYSTIMESTAMP A,
          SYSTIMESTAMP - INTERVAL '1' MINUTE B
   FROM DUAL
); 
```

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2012-04-10T15:58:28.810

不幸的是，我认为没有另一种（或更优雅的）方法可以从 pl/sql 中的间隔类型计算总秒数。正如[这篇文章](https://web.archive.org/web/20130624094947/http://www.timvasil.com/blog14/post/2008/12/22/Converting-an-Oracle-interval-to-total-seconds.aspx)提到的：

```
... unlike .NET, Oracle provides no simple equivalent to TimeSpan.TotalSeconds. 
```

因此，从间隔中提取日期、小时等并将它们与相应的值相乘似乎是唯一的方法。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2013-07-03T17:00:57.590

基于[zep 的回答](https://stackoverflow.com/a/10101114/458741)，为了您的方便，我将其包装成一个函数：

```
CREATE OR REPLACE FUNCTION intervalToSeconds( 
     pMinuend TIMESTAMP , pSubtrahend TIMESTAMP ) RETURN NUMBER IS

vDifference INTERVAL DAY TO SECOND ; 

vSeconds NUMBER ;

BEGIN 

vDifference := pMinuend - pSubtrahend ;

SELECT EXTRACT( DAY    FROM vDifference ) * 86400
     + EXTRACT( HOUR   FROM vDifference ) *  3600
     + EXTRACT( MINUTE FROM vDifference ) *    60
     + EXTRACT( SECOND FROM vDifference )
  INTO
    vSeconds 
  FROM DUAL ;

  RETURN vSeconds ;

END intervalToSeconds ; 
```

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2017-09-05T09:15:28.863

使用以下查询：

```
select (cast(timestamp1 as date)-cast(timestamp2 as date))*24*60*60) 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2019-09-23T12:06:38.813

类似于@Zhaoping Lu 的回答，但直接提取秒数而不是从天数中获取秒数。

```
SELECT extract(second from (end_date - start_date)) as "Seconds number"
FROM my_table 
```

（在 PostgresSQL 9.6.1 上工作）

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2020-08-26T11:44:14.963

将时间戳转换为纳秒的更短方法。

```
SELECT (EXTRACT(DAY FROM (
    SYSTIMESTAMP --Replace line with desired timestamp --Maximum value: TIMESTAMP '3871-04-29 10:39:59.999999999 UTC'
- TIMESTAMP '1970-01-01 00:00:00 UTC') * 24 * 60) * 60 + EXTRACT(SECOND FROM
    SYSTIMESTAMP --Replace line with desired timestamp
)) *  1000000000 AS NANOS FROM DUAL;

NANOS
1598434427263027000 
```

一种将纳秒转换为时间戳的方法。

```
SELECT TIMESTAMP '1970-01-01 00:00:00 UTC' + numtodsinterval(
    1598434427263027000 --Replace line with desired nanoseconds
/ 1000000000, 'SECOND') AS TIMESTAMP FROM dual;

TIMESTAMP
26/08/20 09:33:47,263027000 UTC 
```

正如预期的那样，上述方法的结果不受时区的影响。

将间隔转换为纳秒的更短方法。

```
SELECT (EXTRACT(DAY FROM (
    INTERVAL '+18500 09:33:47.263027' DAY(5) TO SECOND --Replace line with desired interval --Maximum value: INTERVAL '+694444 10:39:59.999999999' DAY(6) TO SECOND(9) or up to 3871 year
) * 24 * 60) * 60 + EXTRACT(SECOND FROM (
    INTERVAL '+18500 09:33:47.263027' DAY(5) TO SECOND --Replace line with desired interval
))) * 1000000000 AS NANOS FROM DUAL;

NANOS
1598434427263027000 
```

一种将纳秒转换为间隔的方法。

```
SELECT numtodsinterval(
    1598434427263027000 --Replace line with desired nanoseconds
/ 1000000000, 'SECOND') AS INTERVAL FROM dual;

INTERVAL
+18500 09:33:47.263027 
```

例如，如果您想使用毫秒而不是纳秒，则将 1000000000 替换为 1000。

我尝试了一些发布的方法，但是当将间隔乘以 86400 时出现异常“ORA-01873：间隔的前导精度太小”，所以我决定发布适合我的方法。

* * *

## 回答 #9

> 赞同：-2
> 
> 时间：2018-06-21T07:59:28.287

SELECT to_char(ENDTIME,'yyyymmddhh24missff')-to_char(STARTTIME,'yyyymmddhh24missff') 作为 DUR FROM DUAL; yyyymmddhh24miss- 将以秒为单位给出持续时间 yyyymmddhh24mi 以最小为单位的持续时间 yyyymmddhh24 - 持续时间 - 以天为单位的持续时间

# mysql - 从 bash 批量插入 MySQL 相关表

> ID：10092036
> 
> 赞同：1
> 
> 时间：2012-04-10T15:48:30.397
> 
> 标签：mysql, bash

我需要定期将大量数据从 CSV 文件上传到 MySQL 数据库。我通过简单地从 bash 脚本执行 LOAD DATA INFILE 来做到这一点。然而，现在数据将分布在多个表中，并且要保留关系。在这种情况下，一般策略是什么？

让我们假设一个最初的简单任务：关系一对多，两个表。

我认为是这样的：

1.  获得表 1 的最大标识符
2.  手动将标识符应用到 CSV 文件
3.  考虑到两个目标表来拆分文件
4.  插入两个表

是最优解吗？（例如，在实际情况下，我将通过这种方式更新许多多对多关系。）

我可以在整个过程中从 bash 级别锁定表 1 吗？还是我必须使用 perl 或 Python 之类的中介工具来将所有内容保存在一个会话中？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-24T21:08:08.353

您的问题中表达了各种相互矛盾的要求。这个答案集中在它的“保持锁定”方面。

为了维护整个操作的表锁，您必须维护到 sql server 的单个连接。一种方法是将所有内容作为多行多命令输入传递给 mysql 命令行客户端的单个调用。基本上是这样的：

```
{ echo "LOCK TABLES Table1 WRITE"
  for i in "${infiles[@]}"; do
    echo "LOAD DATA LOCAL INFILE '${i}'"
  done
} | mysql 
```

只要您可以在保留锁的同时生成所有必需的语句而不向数据库询问问题（如最大标识符），那么这将起作用。

为了混合读取操作（例如请求最大值）和写入操作（例如加载某些文件的内容），您需要与服务器进行双向通信。通过 bash 实现这一点非常棘手，所以我建议不要这样做。即使您不需要提问，bash 管道提供的单向连接也是一个危险源：如果 mysql 端出现任何问题，bash 不会注意到并会发出下一个命令。您最终可能会提交不一致的数据。

由于这些原因，我宁愿建议一些可以使用 mysql 绑定的脚本语言，例如您提到的 Perl 或 Pyhon 选项。阅读这些语言的 CVS 文件很容易，因此您可以在一个脚本中执行以下所有操作：

1.  锁定表
2.  开始交易
3.  读取输入的 csv 文件
4.  问最大ID之类的问题
5.  调整输入数据以匹配表格布局
6.  向表中插入数据
7.  如果没有发生错误，则提交事务

# javascript - 使用 JavaScript 在父节点上的委托事件冒泡问题

> ID：10092041
> 
> 赞同：3
> 
> 时间：2012-04-10T15:48:43.653
> 
> 标签：javascript, events, delegation

我在让我的事件正确冒泡时遇到问题我相信委托事件。

我有一些标记，例如：

```
<div id="wrapper">
<!-- more HTML -->
  <div class="clear">
    <a href="#">
      Clear completed <span>items</span>
    </a>
  </div>
</div> 
```

我想将一个事件添加到`.clear`，因此我将处理代码放在附加到`#wrapper`. 我的问题是我的活动似乎没有冒泡。换句话说：

```
getElementById('wrapper').addEventListener('click', app.controller.update, true);

app.controller.update = function(e){
  console.log(e.target.nodeName) //returns either A or SPAN
  while(e.target.nodeName !== 'DIV'){
    //Infinite loop because no bubbling is happening
  }
} 
```

想法？是的，我可以将它直接附加到元素上，但我想将所有事件保存在一个容器中。不，没有 jQuery。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-10T16:09:36.013

事件冒泡意味着在子节点上引发的事件可以由父节点处理（如果该子节点没有取消它）。

`e.target`包含事件的发起者。因此，如果您单击`span`或`a`标记，它将包含对这些标记的引用。要检查是否启动了点击，`div#clear`您可以尝试这样的循环：

```
var el = e.target || e.srcElement;
while(el.nodeName !== 'DIV' && (el.id !== 'clear' || el.id !== 'wrapper')) 
// climb up to parent nodes until clear or wrapper is found
{
    el = el.parentNode;
}
if (el.id == 'clear')
{
    // Do smth
} 
```

# java - 从基本的 HTML/Javascript 生成 Java GUI 代码

> ID：10092043
> 
> 赞同：1
> 
> 时间：2012-04-10T15:48:51.257
> 
> 标签：java, javascript

我想知道从嵌入了 Javascript 代码的 HTML 页面生成 Java GUI 代码的最佳方式以及需要什么（语言/库）。它将模拟 HTML 对象（如 div/表格）及其交互。我不需要模拟任何复杂的 Javascript 库，而只需获得 Java 可以轻松支持的基本功能，例如处理鼠标点击/移动和按键。

我正在考虑使用 Java 中的绝对定位来表示所有 HTML 对象，而不必为布局管理器生成代码。

编辑：关于 sead 的评论：我的意思是我不需要将用 JQuery 或其他 Javascript 库编写的代码转换为 Java GUI 代码。我只想处理简单的 Javascript。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-10T15:09:47.397

我也在搜索，似乎没有什么真的打算这样做。

但是，一种选择是将浏览器嵌入到您的应用程序中，使用以下方法：

[http://djproject.sourceforge.net/ns/](http://djproject.sourceforge.net/ns/)
[http://www.eclipse.org/articles/Article-SWT-browser-widget/browser.html](http://www.eclipse.org/articles/Article-SWT-browser-widget/browser.html)

然后用它来加载你的 HTML 页面。

# opengl-es - 打开GL ES纹理：设置透明色|| 颜色的 alpha 为零

> ID：10092044
> 
> 赞同：0
> 
> 时间：2012-04-10T15:48:53.597
> 
> 标签：opengl-es, transparency, textures, alpha

我有一个纹理，我想将单色（例如（255,255,255））的 alpha 设置为 0。

我现在使用这个调用（self.texture 是来自 cocos2d 的 CCTexture2D）

```
glBindTexture(GL_TEXTURE_2D, self.texture.name);
glTexImage2D(GL_TEXTURE_2D, 0, GL_RGBA, width, height, 0, GL_BGRA, GL_UNSIGNED_BYTE, baseAddress); 
```

纹理完美显示。我希望你能帮助我。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-13T09:26:39.263

我不确定我是否理解这一点，而且我对 opengl 还很陌生，但我认为你只想要一种颜色是透明的，你不能覆盖两个纹理，使用

gl.glblendfunc()

```
boolean SEE_THRU = true;
if (SEE_THRU) {
gl.glDisable(GL10.GL_DEPTH_TEST);
gl.glEnable(GL10.GL_BLEND);
gl.glBlendFunc(GL10.GL_SRC_ALPHA, GL10.GL_ONE);
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-10T18:41:43.270

OpenGL 命令无法做到这一点。您必须使用着色器过滤特定颜色的像素，或者在将像素数据`baseAddress`上传到 glTexImage2D 之前逐像素循环修改像素数据。

# php - PHP后台进程逻辑解释

> ID：10092045
> 
> 赞同：0
> 
> 时间：2012-04-10T15:48:56.463
> 
> 标签：php, sockets, shell, terminal, background-process

我是一名中等到优秀的 PHP 程序员，并且有终端/shell 脚本的经验，但我试图理解的是后台进程背后的逻辑，而且肯定不是 Cron 或 Cron Jobs，而是持续的数据流。

我最近与一个开发了一个小网络应用程序的人交谈，该应用程序与 twitter 流 API 和[Phirehose](https://github.com/fennb/phirehose)一起使用来收集推文并将它们保存到数据库中。现在听起来很简单，但所有这些都作为一个过程在后台发生。我不习惯的是：

调用进程 -> 进程完成 -> 处理来自进程的数据。

与此不同的是，它一直在不停地发生。我记得也有关于套接字连接的讨论。

所以我的问题是：

1.  执行后台进程时，是否是特定功能的连续循环？这就是我能从逻辑上得出的结论，或者它是如何“保持开放”并发生的？
2.  套接字连接在这个等式中做了什么？
3.  运行这种类型的进程是否会继承任何形式的延迟？

我知道这不是“特定于代码”类型的问题，但我找不到有关此类问题的太多信息。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-10T15:58:47.533

使用 PHP，很可能安排一个 cronjob 每隔一小时左右执行一次脚本。该脚本不会连续运行。

PHP 有多种连接资源的方式，其中大部分使用套接字。如果您确实`file_get_contents()`要连接到网络服务器，那么您也在使用套接字，您可能只是没有注意到它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-10T15:57:50.827

> 1、执行后台进程时，是否是特定功能的连续循环？这就是我能从逻辑上得出的结论，或者它是如何“保持开放”并发生的？

不，不需要这样的连续循环。后台进程也可以被调用、运行和完成。它也不再像任何其他进程一样运行。也许对后台进程没有用，但可能。

> 2\. 这个等式中的套接字连接有什么作用？

套接字有时用于允许不同进程之间的通信，也称为 IPC - 进程间通信。

> 3\. 运行此类进程是否会继承任何形式的延迟？

是的，每种形式的间接都是有代价的。此外，如果您并行运行多个进程，则计算机系统管理这些多个进程也会产生一些开销（现在无论如何它都会这样做，但只是说，如果只有一个进程，就没有什么可管理的了）。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-09-12T08:11:24.617

如果您想学习有关后台进程的教程：http: [//thedjbway.b0llix.net/daemontools/blabbyd.html](http://thedjbway.b0llix.net/daemontools/blabbyd.html) - 非常有用。Daemontools 使得维护后台进程（守护进程）变得非常容易。

# c - OpenMP：并行程序并不比串行程序快（或不是非常快）。我究竟做错了什么？

> ID：10092047
> 
> 赞同：1
> 
> 时间：2012-04-10T15:49:11.640
> 
> 标签：c, performance, gcc, openmp

看看这段代码：

```
#include <stdio.h>
#include <omp.h>

int main()
{
    long i, j;

    #pragma omp for
    for(i=0;i<=100000;i++)
    {
        for(j=0;j<=100000;j++)
        {
            if((i ^ j) == 5687)
            {
                //printf("%ld ^ %ld\n", i, j);
                break;
            }
        }
    }
} 
```

所以，结果：

```
robotex@robotex-work:~/Projects$ gcc test.c -fopenmp -o test_openmp
robotex@robotex-work:~/Projects$ gcc test.c -o test_noopenmp
robotex@robotex-work:~/Projects$ time ./test_openmp
real    0m11.785s
user    0m11.613s
sys 0m0.008s
robotex@robotex-work:~/Projects$ time ./test_noopenmp

real    0m13.364s
user    0m13.253s
sys 0m0.008s
robotex@robotex-work:~/Projects$ time ./test_noopenmp

real    0m11.955s
user    0m11.853s
sys 0m0.004s
robotex@robotex-work:~/Projects$ time ./test_openmp

real    0m15.048s
user    0m14.949s
sys 0m0.004s 
```

怎么了？为什么 OpenMP 程序较慢？我该如何纠正？

我用操作系统 Ubuntu 在几台计算机（工作中的 Intel Core i5，家庭中的 Intel Core2Duo T7500）上对其进行了测试，并且始终得到相同的结果：OpenMP 并没有显着提高性能。

我还测试了来自 Wikipedia 的示例并得到了相同的结果。

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2012-04-10T16:21:04.450

您的代码中有两个问题：

1.  你`parallel`在你的杂注中错过了。所以它只使用1个线程。
2.  您有一个竞争条件，`j`因为它是在并行区域之外声明的。

* * *

首先，您需要`parallel`真正让 OpenMP 并行运行：

```
#pragma omp parallel for 
```

其次，您`j`在并行区域之外声明。这将使它在所有线程之间共享。所以所有线程都在并行区域内读取和修改它。

因此，您不仅有竞争条件，而且由所有失效引起的缓存一致性流量正在扼杀您的性能。

您需要做的是使`j`每个线程本地化。这可以通过以下任一方式完成：

1.  `j`在并行区域内声明。
2.  或添加`private(j)`到编译指示：（`#pragma omp parallel for private(j)`
    正如@ArjunShankar 在评论中指出的那样）

* * *

试试这个：

```
int main()
{
    double start = omp_get_wtime();

    long i;

#pragma omp parallel for
    for(i=0;i<=100000;i++)
    {
        long j;
        for(j=0;j<=100000;j++)
        {
            if((i ^ j) == 5687)
            {
                //printf("%ld ^ %ld\n", i, j);
                break;
            }
        }
    }

    double end = omp_get_wtime();

    printf("%f\n",end - start);
    return 0;
} 
```

* * *

```
No OpenMP:            6.433378
OpenMP with global j: 9.634591
OpenMP with local j:  2.266667 
```

# php - XAMPP 邮件在 Mac 上发送

> ID：10092048
> 
> 赞同：0
> 
> 时间：2012-04-10T15:49:14.557
> 
> 标签：php, macos, xampp, sendmail

所以我在我的网站上工作时遇到了一些有趣的事情。我在 mac OXS Lion 上使用 Xampp 来运行我的网站。在我`mail()`连接到家庭互联网连接 (Verizon Fios) 之前，我的代码中有一些从未工作过的功能（发送外发邮件）。

然而，我最近在当地一家医院，通过似乎不安全的互联网连接登录了互联网。当我在我的网站上工作时，突然这些`mail()`功能开始工作并发送邮件......但是，当我回到家时，它不再工作了！

我怎样才能弄清楚有什么不同，以便我可以更改 php.ini 或我的计算机配置中的一些设置，以便我可以让它发送邮件，就像在医院做的那样。我想弄清楚...有什么想法吗？

# node.js - Node.js 数据库的抽象层

> ID：10092050
> 
> 赞同：17
> 
> 时间：2012-04-10T15:49:17.833
> 
> 标签：node.js, mongodb

我一直在寻找简单的数据库抽象实现，然后我发现了很棒的文章[http://howtonode.org/express-mongodb](http://howtonode.org/express-mongodb)，虽然很旧，但我仍然喜欢这个想法。

好吧，也许构造可以采用某种带有数据库设置的对象文字。所以主要思想是 UserService-s 可能有不同的实现，但位于不同的目录中，并且只需要需要的那个。

```
/data-layer/mongodb/user-service.js
                   /post-service.js
                   /comment-service.js

/data-layer/couchdb/user-service.js
                   /post-service.js
                   /comment-service.js 
```

当需要数据库时，我会在`var UserService = require(__dirname + '/data-layer/mongodb/user-service).UserService(db);`哪里得到它`var db = "open db object"`

这是正确的方法还是有更好的解决方案？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-07-22T16:14:52.147

有一些解决方案，可通过 NPM 获得：

*   [Node-DBI](https://github.com/DrBenton/Node-DBI)：“Node-DBI 是一个 SQL 数据库抽象层库，受到 PHP Zend Framework Zend_Db API 的强烈启发。它通过 Adapters 类提供了与多个数据库引擎一起工作的统一功能。目前支持的引擎是 mysql， mysql-libmysqlclient 和 sqlite3"。看起来开发已经暂停。
*   [Accessor](https://github.com/bu/Accessor)：“数据库包装器，提供对数据库的轻松访问。” 目前仅支持 MySQL 和 MongoDB。
*   [Activerecord](https://github.com/meltingice/node-activerecord)：“用 Coffeescript 编写的 ORM，支持多种数据库系统（SQL、NoSQL 甚至 REST），以及 ID 生成中间件。它完全可扩展以添加新的数据库系统和插件。”

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2015-06-26T08:43:59.507

**更新**：

自从我发布了这个答案以来，我已经放弃了[官方 MongoDB NodeJS 驱动程序](https://mongodb.github.io/node-mongodb-native/)的 mongoose，因为它非常直观并且更忠于 NoSQL 数据库的概念。

**原答案**：

我虽然可能是时候更新一个老问题的答案了：

如果你想使用 MongoDB 作为你[的面向文档的数据库](https://en.wikipedia.org/wiki/Document-oriented_database)，[mongoose](http://mongoosejs.com/)是一个不错的选择并且易于使用（来自官方网站的示例）：

```
var mongoose = require('mongoose');
mongoose.connect('mongodb://localhost/test');

var Cat = mongoose.model('Cat', { name: String });

var kitty = new Cat({ name: 'Zildjian' });
kitty.save(function (err) {
  if (err) // ...
  console.log('meow');
}); 
```

对于一种相当现代的方法，[Mongorito](http://mongorito.com/)是一个很好的 ODM，它使用[ES6](http://davidwalsh.name/es6-generators)生成器而不是回调。

截至 2015 年 6 月，我认为使用 Node.js/io.js的*SQL 数据库的最佳*[ORM](https://en.wikipedia.org/wiki/Object-relational_mapping)是支持以下数据库的[Sequelize ：](http://docs.sequelizejs.com/en/latest/)

 **   PostgreSQL
*   MySQL
*   玛丽亚数据库
*   SQLite
*   微软SQL

设置[相当简单](http://docs.sequelizejs.com/en/latest/docs/getting-started/)：

```
var sequelize = new Sequelize('database', 'username', 'password', {
  host: 'localhost',
  dialect: 'mysql'
});

// Or you can simply use a connection uri
var sequelize = new Sequelize('postgres://user:pass@example.com:5432/dbname'); 
```

它还提供[事务](http://docs.sequelizejs.com/en/latest/docs/transactions/)、[迁移](http://docs.sequelizejs.com/en/latest/docs/migrations/)和许多其他好东西。*

# c++ - 编译 Audacity 时出错 MSB4023 项目元数据不能与 MSVC 2010 一起应用

> ID：10092052
> 
> 赞同：0
> 
> 时间：2012-04-10T15:49:22.483
> 
> 标签：c++, c, xml, compilation, audacity

我正在尝试编译 Audacity 2.0.0 并收到以下错误。我是 C/C++ 新手，所以不确定如何解决它。我正在使用 VS 2010 Professional SP1。

> 错误 449 错误 MSB4023：无法评估项目元数据“%(Extension)”。项目元数据“%(Extension)”无法应用于路径“C:\audacity-src-2.0.0\win\Debug\Audacity.vcxproj\analyze.ny”。路径中的非法字符。C:\audacity-src-2.0.0\win\ny.targets 65 6 大胆

这是我的 ny.targets 文件。我已经做了一些谷歌搜索，但到目前为止它一直没有结果。

```
<?xml version="1.0" encoding="utf-8"?>
<Project xmlns="http://schemas.microsoft.com/developer/msbuild/2003">
  <ItemGroup>
    <PropertyPageSchema
      Include="$(MSBuildThisFileDirectory)$(MSBuildThisFileName).xml" />
    <AvailableItemName
      Include="copy">
      <Targets>_copy</Targets>
    </AvailableItemName>
  </ItemGroup>
  <UsingTask
    TaskName="copy"
    TaskFactory="XamlTaskFactory"
    AssemblyName="Microsoft.Build.Tasks.v4.0">
    <Task>$(MSBuildThisFileDirectory)$(MSBuildThisFileName).xml</Task>
  </UsingTask>
  <Target
    Name="_copy"
    BeforeTargets="$(copyBeforeTargets)"
    AfterTargets="$(copyAfterTargets)"
    Condition="'@(copy)' != ''"
    DependsOnTargets="$(copyDependsOn);ComputecopyOutput"
    Outputs="@(copy-&gt;'%(Outputs)')"
    Inputs="@(copy);%(copy.AdditionalDependencies);$(MSBuildProjectFile)">
    <ItemGroup
      Condition="'@(SelectedFiles)' != ''">
      <copy
        Remove="@(copy)"
        Condition="'%(Identity)' != '@(SelectedFiles)'" />
    </ItemGroup>
    <ItemGroup>
      <copy_tlog
        Include="%(copy.Outputs)"
        Condition="'%(copy.Outputs)' != '' and '%(copy.ExcludedFromBuild)' != 'true'">
        <Source>@(copy, '|')</Source>
      </copy_tlog>
    </ItemGroup>
    <Message
      Importance="High"
      Text="%(copy.ExecutionDescription)" />
    <WriteLinesToFile
      Condition="'@(copy_tlog)' != '' and '%(copy_tlog.ExcludedFromBuild)' != 'true'"
      File="$(IntDir)$(ProjectName).write.1.tlog"
      Lines="^%(copy_tlog.Source);@(copy_tlog-&gt;'%(Fullpath)')" />
    <copy
      Condition="'@(copy)' != '' and '%(copy.ExcludedFromBuild)' != 'true'"
      CommandLineTemplate="%(copy.CommandLineTemplate)"
      OutputName="%(copy.OutputName)"
      AdditionalOptions="%(copy.AdditionalOptions)"
      Inputs="@(copy)" />
  </Target>
  <PropertyGroup>
    <ComputeLinkInputsTargets>
      $(ComputeLinkInputsTargets);
      ComputecopyOutput;
    </ComputeLinkInputsTargets>
    <ComputeLibInputsTargets>
      $(ComputeLibInputsTargets);
      ComputecopyOutput;
    </ComputeLibInputsTargets>
  </PropertyGroup>
  <Target
    Name="ComputecopyOutput"
    Condition="'@(copy)' != ''">
    <ItemGroup>
      <copyDirsToMake
        Condition="'@(copy)' != '' and '%(copy.ExcludedFromBuild)' != 'true'"
        Include="%(copy.Outputs)" />
      <Link
        Include="%(copyDirsToMake.Identity)"
        Condition="'%(Extension)'=='.obj' or '%(Extension)'=='.res' or '%(Extension)'=='.rsc' or '%(Extension)'=='.lib'" />
      <Lib
        Include="%(copyDirsToMake.Identity)"
        Condition="'%(Extension)'=='.obj' or '%(Extension)'=='.res' or '%(Extension)'=='.rsc' or '%(Extension)'=='.lib'" />
      <ImpLib
        Include="%(copyDirsToMake.Identity)"
        Condition="'%(Extension)'=='.obj' or '%(Extension)'=='.res' or '%(Extension)'=='.rsc' or '%(Extension)'=='.lib'" />
    </ItemGroup>
    <MakeDir
      Directories="@(copyDirsToMake-&gt;'%(RootDir)%(Directory)')" />
  </Target>
</Project> 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-06-25T14:57:49.563

作为记录，您的问题是由引号引起的。

转动：

```
""C:\audacity-src-2.0.0\win\Debug\Audacity.vcxproj\analyze.ny"" 
```

进入

```
"C:\audacity-src-2.0.0\win\Debug\Audacity.vcxproj\analyze.ny" 
```

你如何做到这一点取决于你如何传递输入。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-10T23:32:16.513

虽然我没有弄清楚错误的根源，但我确实找到了解决方法。

解决方法是不要使用 VS2010 编译 Audacity。

使用 VS2008——它在 2008 中立即运行。

此链接[http://wiki.audacityteam.org/wiki/Developing_On_Windows#What_about_Visual_Studio_2010.3F__Or_64-bit.3F](http://wiki.audacityteam.org/wiki/Developing_On_Windows#What_about_Visual_Studio_2010.3F__Or_64-bit.3F)提供了详细说明。

VC++ 2008 Express 与 2010 并排安装，没有问题。

这是他们试图让它与 2010 年一起工作的线程， http: [//forum.audacityteam.org/viewtopic.php?f=19&t=61946](http://forum.audacityteam.org/viewtopic.php?f=19&t=61946)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-08-01T02:52:06.107

在 VS2010 中从 Sourceforge 编译最新代码的技巧是在 1 处修改 ny.props 文件，并在 portaudio-v19 和 portmixer 的 Pre-Build 和 Post-Build 步骤中扩展变量。在当前的解决方案中，我似乎无法让 VS2010 中的环境变量如下所示。扩展它们似乎可以解决这个问题。但是，像 SDK 目录环境变量这样的预先声明的变量可以正常工作。

此外，对 ny.props 文件中引号的单一修复会在以后修复所有级联。这似乎是让它正确编译的最小修复。

修复如下：

ny.props 原文：

```
<?xml version="1.0" encoding="utf-8"?>
<Project xmlns="http://schemas.microsoft.com/developer/msbuild/2003">
  <PropertyGroup
    Condition="'$(copyBeforeTargets)' == '' and '$(copyAfterTargets)' == '' and '$(ConfigurationType)' != 'Makefile'">
    <copyBeforeTargets>Midl</copyBeforeTargets>
    <copyAfterTargets>CustomBuild</copyAfterTargets>
  </PropertyGroup>
  <PropertyGroup>
    <copyDependsOn
      Condition="'$(ConfigurationType)' != 'Makefile'">_SelectedFiles;$(copyDependsOn)</copyDependsOn>
  </PropertyGroup>
  <ItemDefinitionGroup>
    <copy>
      <OutputName>"$(OutDir)$(ProjectFileName)\%(Filename)%(Extension)"</OutputName>
      <CommandLineTemplate>copy /Y [inputs] %(OutputName)</CommandLineTemplate>
      <Outputs>%(OutputName)</Outputs>
      <ExecutionDescription>Copying %(Filename)</ExecutionDescription>
    </copy>
  </ItemDefinitionGroup>
</Project> 
```

ny.props 修复：

```
<?xml version="1.0" encoding="utf-8"?>
<Project xmlns="http://schemas.microsoft.com/developer/msbuild/2003">
  <PropertyGroup
    Condition="'$(copyBeforeTargets)' == '' and '$(copyAfterTargets)' == '' and '$(ConfigurationType)' != 'Makefile'">
    <copyBeforeTargets>Midl</copyBeforeTargets>
    <copyAfterTargets>CustomBuild</copyAfterTargets>
  </PropertyGroup>
  <PropertyGroup>
    <copyDependsOn
      Condition="'$(ConfigurationType)' != 'Makefile'">_SelectedFiles;$(copyDependsOn)</copyDependsOn>
  </PropertyGroup>
  <ItemDefinitionGroup>
    <copy>
      <OutputName>$(OutDir)$(ProjectFileName)\%(Filename)%(Extension)</OutputName>
      <CommandLineTemplate>copy /Y [inputs] "%(OutputName)"</CommandLineTemplate>
      <Outputs>%(OutputName)</Outputs>
      <ExecutionDescription>Copying %(Filename)</ExecutionDescription>
    </copy>
  </ItemDefinitionGroup>
</Project> 
```

portaudio-v19 Pre-Build 原版：

```
echo on
set CFG="$(ProjectDir)/$(Configuration)/config.h"

echo // Automatically generated file >%CFG%
IF NOT "%DXSDK_DIR%" == "" echo #define PA_USE_DS 1 >>%CFG%
IF NOT "%ASIOSDK_DIR%" == "" echo #define PA_USE_ASIO 1 >>%CFG%
IF NOT "%JACKSDK_DIR%" == "" echo #define PA_USE_JACK 1 >>%CFG%
IF NOT "%JACKSDK_DIR%" == "" echo #define PA_DYNAMIC_JACK 1 >>%CFG%
rem echo #define PA_USE_WDMKS 1 >>%CFG%
echo #define PA_USE_WASAPI 1 >>%CFG%
echo #define PA_USE_WMME 1 >>%CFG% 
```

portaudio-v19 预构建修复：

```
echo // Automatically generated file >"$(ProjectDir)/$(Configuration)/config.h"
IF NOT "%DXSDK_DIR%" == "" echo #define PA_USE_DS 1 >>"$(ProjectDir)/$(Configuration)/config.h"
IF NOT "%ASIOSDK_DIR%" == "" echo #define PA_USE_ASIO 1 >>"$(ProjectDir)/$(Configuration)/config.h"
IF NOT "%JACKSDK_DIR%" == "" echo #define PA_USE_JACK 1 >>"$(ProjectDir)/$(Configuration)/config.h"
IF NOT "%JACKSDK_DIR%" == "" echo #define PA_DYNAMIC_JACK 1 >>"$(ProjectDir)/$(Configuration)/config.h"
rem echo #define PA_USE_WDMKS 1 >>"$(ProjectDir)/$(Configuration)/config.h"
echo #define PA_USE_WASAPI 1 >>"$(ProjectDir)/$(Configuration)/config.h"
echo #define PA_USE_WMME 1 >>"$(ProjectDir)/$(Configuration)/config.h" 
```

portaudio-v19 后期构建原版：

```
echo on
set BASE="../../../lib-src/portaudio-v19"
set CFG=$(ProjectDir)$(Configuration)\config.h
set INTDIR=$(Configuration)
set CFLAGS=/O2 /GL /I "%BASE%/include" /I "%BASE%/src/common" /I "%BASE%/src/os/win" /D "WIN32" /D "NDEBUG" /D "_LIB" /D "_MBCS" /GF /FD /EHsc /MD /Gy /Fo"%INTDIR%/" /Fd"%INTDIR%" /W3 /nologo /c /wd4996 /FI "%CFG%" /errorReport:prompt
set LIBS=

find "PA_USE_DS 1" "%CFG%"
IF ERRORLEVEL 1 goto NoDS

cl %CFLAGS% /I "%DXSDK_DIR%/include" "%BASE%/src/hostapi/dsound/pa_win_ds.c"
cl %CFLAGS% /I "%DXSDK_DIR%/include" "%BASE%/src/hostapi/dsound/pa_win_ds_dynlink.c"

set LIBS="%DXSDK_DIR%/lib/x86\dxguid.lib"

:NoDS

find "PA_USE_WASAPI 1" "%CFG%"
IF ERRORLEVEL 1 goto NoWASAPI

cl %CFLAGS% "%BASE%/src/hostapi/wasapi/pa_win_wasapi.c"

:NoWASAPI

find "PA_USE_WDMKS 1" "%CFG%"
IF ERRORLEVEL 1 goto NoWDMKS

cl %CFLAGS% "%BASE%/src/hostapi/wdmks/pa_win_wdmks.c"

:NoWDMKS

find "PA_USE_ASIO 1" "%CFG%"
IF ERRORLEVEL 1 goto NoASIO

cl %CFLAGS% /I "%ASIOSDK_DIR%/common" /I "%ASIOSDK_DIR%/host" /I "%ASIOSDK_DIR%/host/pc" "%BASE%/src/hostapi/asio/pa_asio.cpp"
cl %CFLAGS% /I "%ASIOSDK_DIR%/common" /I "%ASIOSDK_DIR%/host" /I "%ASIOSDK_DIR%/host/pc" "%BASE%/src/hostapi/asio/iasiothiscallresolver.cpp"
cl %CFLAGS% /I "%ASIOSDK_DIR%/common" /I "%ASIOSDK_DIR%/host" /I "%ASIOSDK_DIR%/host/pc" "%ASIOSDK_DIR%/common/asio.cpp"
cl %CFLAGS% /I "%ASIOSDK_DIR%/common" /I "%ASIOSDK_DIR%/host" /I "%ASIOSDK_DIR%/host/pc" "%ASIOSDK_DIR%/host/asiodrivers.cpp"
cl %CFLAGS% /I "%ASIOSDK_DIR%/common" /I "%ASIOSDK_DIR%/host" /I "%ASIOSDK_DIR%/host/pc" "%ASIOSDK_DIR%/host/pc/asiolist.cpp"

:NoASIO

find "PA_USE_JACK 1" "%CFG%" >NUL
IF ERRORLEVEL 1 goto NoJACK

cl %CFLAGS% /I "%JACKSDK_DIR%/includes" "%BASE%/src/hostapi/jack/pa_jack.c"
cl %CFLAGS% /I "%JACKSDK_DIR%/includes" "%BASE%/src/hostapi/jack/pa_jack_dynload.c"

:NoJACK

lib /OUT:"$(TargetPath)" "%INTDIR%/*.obj" %LIBS% 
```

portaudio-v19 构建后修复：

```
find "PA_USE_DS 1" "$(ProjectDir)$(Configuration)/config.h"
IF ERRORLEVEL 1 goto NoDS

cl /O2 /GL /I "../../../lib-src/portaudio-v19/include" /I "../../../lib-src/portaudio-v19/src/common" /I "../../../lib-src/portaudio-v19/src/os/win" /D "WIN32" /D "NDEBUG" /D "_LIB" /D "_MBCS" /GF /FD /EHsc /MD /Gy /Fo"$(IntDir)/" /Fd"$(IntDir)/" /W3 /nologo /c /wd4996 /FI "$(ProjectDir)$(Configuration)/config.h" /errorReport:prompt /I "%DXSDK_DIR%/include" "../../../lib-src/portaudio-v19/src/hostapi/dsound/pa_win_ds.c"
cl /O2 /GL /I "../../../lib-src/portaudio-v19/include" /I "../../../lib-src/portaudio-v19/src/common" /I "../../../lib-src/portaudio-v19/src/os/win" /D "WIN32" /D "NDEBUG" /D "_LIB" /D "_MBCS" /GF /FD /EHsc /MD /Gy /Fo"$(IntDir)/" /Fd"$(IntDir)/" /W3 /nologo /c /wd4996 /FI "$(ProjectDir)$(Configuration)/config.h" /errorReport:prompt /I "%DXSDK_DIR%/include" "../../../lib-src/portaudio-v19/src/hostapi/dsound/pa_win_ds_dynlink.c"

:NoDS

find "PA_USE_WASAPI 1" "$(ProjectDir)$(Configuration)/config.h"
IF ERRORLEVEL 1 goto NoWASAPI

cl /O2 /GL /I "../../../lib-src/portaudio-v19/include" /I "../../../lib-src/portaudio-v19/src/common" /I "../../../lib-src/portaudio-v19/src/os/win" /D "WIN32" /D "NDEBUG" /D "_LIB" /D "_MBCS" /GF /FD /EHsc /MD /Gy /Fo"$(IntDir)/" /Fd"$(IntDir)/" /W3 /nologo /c /wd4996 /FI "$(ProjectDir)$(Configuration)/config.h" /errorReport:prompt "../../../lib-src/portaudio-v19/src/hostapi/wasapi/pa_win_wasapi.c"

:NoWASAPI

find "PA_USE_WDMKS 1" "$(ProjectDir)$(Configuration)/config.h"
IF ERRORLEVEL 1 goto NoWDMKS

cl %CFLAGS% "%BASE%/src/hostapi/wdmks/pa_win_wdmks.c"

:NoWDMKS

find "PA_USE_ASIO 1" "$(ProjectDir)$(Configuration)/config.h"
IF ERRORLEVEL 1 goto NoASIO

cl %CFLAGS% /I "%ASIOSDK_DIR%/common" /I "%ASIOSDK_DIR%/host" /I "%ASIOSDK_DIR%/host/pc" "%BASE%/src/hostapi/asio/pa_asio.cpp"
cl %CFLAGS% /I "%ASIOSDK_DIR%/common" /I "%ASIOSDK_DIR%/host" /I "%ASIOSDK_DIR%/host/pc" "%BASE%/src/hostapi/asio/iasiothiscallresolver.cpp"
cl %CFLAGS% /I "%ASIOSDK_DIR%/common" /I "%ASIOSDK_DIR%/host" /I "%ASIOSDK_DIR%/host/pc" "%ASIOSDK_DIR%/common/asio.cpp"
cl %CFLAGS% /I "%ASIOSDK_DIR%/common" /I "%ASIOSDK_DIR%/host" /I "%ASIOSDK_DIR%/host/pc" "%ASIOSDK_DIR%/host/asiodrivers.cpp"
cl %CFLAGS% /I "%ASIOSDK_DIR%/common" /I "%ASIOSDK_DIR%/host" /I "%ASIOSDK_DIR%/host/pc" "%ASIOSDK_DIR%/host/pc/asiolist.cpp"

:NoASIO

find "PA_USE_JACK 1" "$(ProjectDir)$(Configuration)/config.h"
IF ERRORLEVEL 1 goto NoJACK

cl %CFLAGS% /I "%JACKSDK_DIR%/includes" "%BASE%/src/hostapi/jack/pa_jack.c"
cl %CFLAGS% /I "%JACKSDK_DIR%/includes" "%BASE%/src/hostapi/jack/pa_jack_dynload.c"

:NoJACK

lib /OUT:"$(TargetPath)" "$(IntDir)/*.obj" "%DXSDK_DIR%/lib/x86/dxguid.lib"

portmixer Post-Build original:

set BASE="../../../lib-src/portmixer"
set CFLAGS=/O2 /GL /I "%BASE%/../portaudio-v19/include" /I "%BASE%/include" /D "WIN32" /D "NDEBUG" /D "_LIB" /D "PX_USE_WIN_MME" /D "_MBCS" /GF /FD /EHsc /MD /Gy /Fo"$(IntDir)" /Fd"$(IntDir)" /W3 /nologo /c /wd4996 /FI "$(ProjectDir)/$(Configuration)/config.h" /errorReport:prompt

if "%DXSDK_DIR%"=="" goto NoDX

cl %CFLAGS% /I "%DXSDK_DIR%/include" "%BASE%/src/px_win_ds.c"

set LIBS="%DXSDK_DIR%/lib/x86/dxguid.lib"

:NoDX

lib /OUT:"$(TargetPath)" "$(IntDir)*.obj" %LIBS%

portmixer Post-Build fix:

if "%DXSDK_DIR%"=="" goto NoDX

cl /O2 /GL /I "../../../lib-src/portmixer/../portaudio-v19/include" /I "../../../lib-src/portmixer/include" /D "WIN32" /D "NDEBUG" /D "_LIB" /D "PX_USE_WIN_MME" /D "_MBCS" /GF /FD /EHsc /MD /Gy /Fo"$(IntDir)/" /Fd"$(IntDir)/" /W3 /nologo /c /wd4996 /FI "$(ProjectDir)/$(Configuration)/config.h" /errorReport:prompt /I "%DXSDK_DIR%/include" "../../../lib-src/portmixer/src/px_win_ds.c"

:NoDX

lib /OUT:"$(TargetPath)" "$(IntDir)/*.obj" "%DXSDK_DIR%/lib/x86/dxguid.lib" 
```

portmixer Post-Build 原版：

```
set BASE="../../../lib-src/portmixer"
set CFLAGS=/O2 /GL /I "%BASE%/../portaudio-v19/include" /I "%BASE%/include" /D "WIN32" /D "NDEBUG" /D "_LIB" /D "PX_USE_WIN_MME" /D "_MBCS" /GF /FD /EHsc /MD /Gy /Fo"$(IntDir)" /Fd"$(IntDir)" /W3 /nologo /c /wd4996 /FI "$(ProjectDir)/$(Configuration)/config.h" /errorReport:prompt

if "%DXSDK_DIR%"=="" goto NoDX

cl %CFLAGS% /I "%DXSDK_DIR%/include" "%BASE%/src/px_win_ds.c"

set LIBS="%DXSDK_DIR%/lib/x86/dxguid.lib"

:NoDX

lib /OUT:"$(TargetPath)" "$(IntDir)*.obj" %LIBS% 
```

portmixer 构建后修复：

```
if "%DXSDK_DIR%"=="" goto NoDX

cl /O2 /GL /I "../../../lib-src/portmixer/../portaudio-v19/include" /I "../../../lib-src/portmixer/include" /D "WIN32" /D "NDEBUG" /D "_LIB" /D "PX_USE_WIN_MME" /D "_MBCS" /GF /FD /EHsc /MD /Gy /Fo"$(IntDir)/" /Fd"$(IntDir)/" /W3 /nologo /c /wd4996 /FI "$(ProjectDir)/$(Configuration)/config.h" /errorReport:prompt /I "%DXSDK_DIR%/include" "../../../lib-src/portmixer/src/px_win_ds.c"

:NoDX

lib /OUT:"$(TargetPath)" "$(IntDir)/*.obj" "%DXSDK_DIR%/lib/x86/dxguid.lib" 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-12-23T02:04:58.973

我没有足够的声誉来评论 Tom Bonner 的回答，但是使用该信息，我发现我的相同问题（使用不同的代码库）的解决方案是在与 .targets 文件相同的目录中找到 .props 文件，并具有相同的名称（即 QtUIBuild.props 和 QtUIBuild.targets），并查找有问题的路径。就我而言，这是一个改变的问题

```
<Outputs>".\..\..\source\qt\GeneratedFiles\ui_%(Filename).h"</Outputs> 
```

至

```
<Outputs>.\..\..\source\qt\GeneratedFiles\ui_%(Filename).h</Outputs> 
```

# jsf - JSF 2.0 encodeAll() 在 sessionCreated() 之前调用

> ID：10092053
> 
> 赞同：0
> 
> 时间：2012-04-10T15:49:26.593
> 
> 标签：jsf, jsf-2, custom-component

我在 JSF 2.0 中创建了一个自定义组件。其目的是在输入文本框中显示会话属性值。我希望在`HttpSessionListener sessionCreated`方法中创建会话属性。问题是`encodeAll`方法在方法之前被调用`sessionCreated`。我应该怎么做才能`sessionCreated`调用之前`encodeAll`？

web.xml

```
<context-param>
    <param-name>javax.faces.FACELETS_LIBRARIES</param-name>
    <param-value>/WEB-INF/components.taglib.xml</param-value>
</context-param>
<listener>
    <listener-class>mycomp.jsf.listener.MyListener</listener-class>
</listener> 
```

components.taglib.xml

```
<facelet-taglib xmlns="http://java.sun.com/xml/ns/javaee"
            xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
            xsi:schemaLocation="http://java.sun.com/xml/ns/javaee
http://java.sun.com/xml/ns/javaee/web-facelettaglibrary_2_0.xsd"
            version="2.0">
<namespace>http://mycomp/jsf/components</namespace>
<tag>
    <tag-name>mycomp</tag-name>
    <component>
        <component-type>MyComp</component-type>
    </component>
</tag>
</facelet-taglib> 
```

MyListener.java

```
public class MyListener implements HttpSessionListener {
@Override
public void sessionCreated(HttpSessionEvent event) {
    HttpSession session = event.getSession();
    session.setAttribute("sessionid", session.getId());
}
@Override
public void sessionDestroyed(HttpSessionEvent se) {
} 
} 
```

MyComp.java

```
@FacesComponent(value = "MyComp")
public class MyComp extends UIComponentBase {
public MyComp() {
    setRendererType(null);
}
protected Class getComponentClass() {
    return this.getClass();
}
@Override
public void decode(FacesContext context) {
//some logic
}
@Override
public void encodeAll(FacesContext context) throws IOException {
    String clientId = getClientId(context) + ":token";
    HttpSession session = (HttpSession) context.getExternalContext().getSession(false);
    String sessionId = (String) session.getAttribute("sessionid");
    if (sessionId == null || "".equals(sessionId)) {
        throw new RuntimeException("sessionid is missing!");
    }
    ResponseWriter writer = context.getResponseWriter();
    writer.startElement("input", this);
    writer.writeAttribute("type", "text", "type");
    writer.writeAttribute("name", clientId, "name");
    writer.writeAttribute("value", sessionId, "value");
    writer.endElement("input");
}
@Override
public String getFamily() {
    return null;
}
} 
```

索引.xhtml

```
<html xmlns="http://www.w3.org/1999/xhtml"
  xmlns:h="http://java.sun.com/jsf/html"
  xmlns:t="http://mycomp/jsf/components">
<h:head>
</h:head>
<h:body>
    <h:form>
        <t:mycomp />
    </h:form>
</h:body>
</html> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-13T13:56:29.597

替换`getSession(false)`为`getSession(true)`。

```
HttpSession session = (HttpSession) context.getExternalContext().getSession(true); 
```

布尔值告诉在会话尚未创建时是否应该创建会话。因此，您有可能在那时还没有创建它，因此每当您在其上调用任何方法时都会`getSession(false)`冒着风险。另请参阅[javadoc](http://docs.oracle.com/javaee/6/api/javax/faces/context/ExternalContext.html#getSession%28boolean%29)。`null``NullPointerException`

* * *

**与具体问题无关**，改用清洁剂`ExternalContext#getSessionMap()`。在您的 JSF 代码中有“原始”`javax.servlet`导入通常表示 JSF 代码中有异味。即做某事不必要地过于复杂。然后，您应该使用纯 JSF API 寻找更简单的方法。

代替

```
HttpSession session = (HttpSession) context.getExternalContext().getSession(true);
String sessionId = (String) session.getAttribute("sessionid");
if (sessionId == null || "".equals(sessionId)) {
    throw new RuntimeException("sessionid is missing!");
} 
```

经过

```
String sessionId = (String) context.getExternalContext().getSessionMap().get("sessionid");
if (sessionId == null || "".equals(sessionId)) {
    throw new RuntimeException("sessionid is missing!");
} 
```

# jakarta-ee - 来自 EJBException 的 DB 约束违规详细信息

> ID：10092058
> 
> 赞同：0
> 
> 时间：2012-04-10T15:50:05.850
> 
> 标签：jakarta-ee, jpa, glassfish, eclipselink

我有一个预订控制器类（生成，NetBeans），具有“更新”方法，从 JSF 调用：

```
@ManagedBean(name = "bookingController")
@SessionScoped
public class BookingController implements Serializable {
...
    public String update() {
        try {
            getFacade().edit(current);
            recreateModel();
            JsfUtil.addSuccessMessage("Booking Update successful");
            return "booking";
        } catch (Exception e) {
            JsfUtil.addErrorMessage("[" + e.getClass().getCanonicalName() +
                "] " + e.getLocalizedMessage());
            serviceLogger.error("Booking not modified; reason: ",e);
            return null;
        }
    }
...
} 
```

应用程序部署在 Glassfish 3.1.1 上。在表单中编辑数据时，我在其中一个字段中输入了重复值，这违反了表中的唯一约束。提交表单时，我得到：

```
[javax.ejb.EJBException] Transaction aborted 
```

作为 JSF 消息（这对最终用户没有任何意义），并且

```
ERROR 2012-04-10 17:33:54,199 - Booking not modified; reason: 
javax.ejb.EJBException: Transaction aborted
    at com.sun.ejb.containers.BaseContainer.completeNewTx(BaseContainer.java:5120)
    at com.sun.ejb.containers.BaseContainer.postInvokeTx(BaseContainer.java:4879)
    at com.sun.ejb.containers.BaseContainer.postInvoke(BaseContainer.java:2039)
    at com.sun.ejb.containers.BaseContainer.postInvoke(BaseContainer.java:1990)
    at com.sun.ejb.containers.EJBLocalObjectInvocationHandler.invoke(EJBLocalObjectInvocationHandler.java:222)
    at com.sun.ejb.containers.EJBLocalObjectInvocationHandlerDelegate.invoke(EJBLocalObjectInvocationHandlerDelegate.java:88)
    at $Proxy963.edit(Unknown Source)
    at tp.coma.cint.data.beans.__EJB31_Generated__BookingsFacade__Intf____Bean__.edit(Unknown Source)
    at tp.coma.cint.jsf.BookingController.update(BookingController.java:166)
    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
    at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)
    at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)
    at java.lang.reflect.Method.invoke(Method.java:597)
    at javax.el.BeanELResolver.invokeMethod(BeanELResolver.java:737)
    at javax.el.BeanELResolver.invoke(BeanELResolver.java:467)
    at javax.el.CompositeELResolver.invoke(CompositeELResolver.java:254)
    at com.sun.el.parser.AstValue.invoke(AstValue.java:228)
    at com.sun.el.MethodExpressionImpl.invoke(MethodExpressionImpl.java:297)
    at org.jboss.weld.util.el.ForwardingMethodExpression.invoke(ForwardingMethodExpression.java:43)
    at org.jboss.weld.el.WeldMethodExpression.invoke(WeldMethodExpression.java:56)
    at com.sun.faces.facelets.el.TagMethodExpression.invoke(TagMethodExpression.java:105)
    at javax.faces.component.MethodBindingMethodExpressionAdapter.invoke(MethodBindingMethodExpressionAdapter.java:88)
    at com.sun.faces.application.ActionListenerImpl.processAction(ActionListenerImpl.java:102)
    at javax.faces.component.UICommand.broadcast(UICommand.java:315)
    at javax.faces.component.UIViewRoot.broadcastEvents(UIViewRoot.java:794)
    at javax.faces.component.UIViewRoot.processApplication(UIViewRoot.java:1259)
    at com.sun.faces.lifecycle.InvokeApplicationPhase.execute(InvokeApplicationPhase.java:81)
    at com.sun.faces.lifecycle.Phase.doPhase(Phase.java:101)
    at com.sun.faces.lifecycle.LifecycleImpl.execute(LifecycleImpl.java:118)
    at javax.faces.webapp.FacesServlet.service(FacesServlet.java:593)
    at org.apache.catalina.core.StandardWrapper.service(StandardWrapper.java:1539)
    at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:281)
    at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:175)
    at org.apache.catalina.core.StandardPipeline.doInvoke(StandardPipeline.java:655)
    at org.apache.catalina.core.StandardPipeline.invoke(StandardPipeline.java:595)
    at com.sun.enterprise.web.WebPipeline.invoke(WebPipeline.java:98)
    at com.sun.enterprise.web.PESessionLockingStandardPipeline.invoke(PESessionLockingStandardPipeline.java:91)
    at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:162)
    at org.apache.catalina.connector.CoyoteAdapter.doService(CoyoteAdapter.java:330)
    at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:231)
    at com.sun.enterprise.v3.services.impl.ContainerMapper.service(ContainerMapper.java:174)
    at com.sun.grizzly.http.ProcessorTask.invokeAdapter(ProcessorTask.java:828)
    at com.sun.grizzly.http.ProcessorTask.doProcess(ProcessorTask.java:725)
    at com.sun.grizzly.http.ProcessorTask.process(ProcessorTask.java:1019)
    at com.sun.grizzly.http.DefaultProtocolFilter.execute(DefaultProtocolFilter.java:225)
    at com.sun.grizzly.DefaultProtocolChain.executeProtocolFilter(DefaultProtocolChain.java:137)
    at com.sun.grizzly.DefaultProtocolChain.execute(DefaultProtocolChain.java:104)
    at com.sun.grizzly.DefaultProtocolChain.execute(DefaultProtocolChain.java:90)
    at com.sun.grizzly.http.HttpProtocolChain.execute(HttpProtocolChain.java:79)
    at com.sun.grizzly.ProtocolChainContextTask.doCall(ProtocolChainContextTask.java:54)
    at com.sun.grizzly.SelectionKeyContextTask.call(SelectionKeyContextTask.java:59)
    at com.sun.grizzly.ContextTask.run(ContextTask.java:71)
    at com.sun.grizzly.util.AbstractThreadPool$Worker.doWork(AbstractThreadPool.java:532)
    at com.sun.grizzly.util.AbstractThreadPool$Worker.run(AbstractThreadPool.java:513)
    at java.lang.Thread.run(Thread.java:662)
Caused by: javax.transaction.RollbackException: Transaction marked for rollback.
    at com.sun.enterprise.transaction.JavaEETransactionImpl.commit(JavaEETransactionImpl.java:473)
    at com.sun.enterprise.transaction.JavaEETransactionManagerSimplified.commit(JavaEETransactionManagerSimplified.java:852)
    at com.sun.ejb.containers.BaseContainer.completeNewTx(BaseContainer.java:5114)
    ... 54 more
Caused by: Exception [EclipseLink-4002] (Eclipse Persistence Services - 2.3.0.v20110604-r9504): org.eclipse.persistence.exceptions.DatabaseException
Internal Exception: com.mysql.jdbc.exceptions.jdbc4.MySQLIntegrityConstraintViolationException: Duplicate entry '111222-0' for key 2
Error Code: 1062
Call: UPDATE Booking SET bk_cnum_user = ?, bk_title = ? WHERE (bk_id = ?)
    bind => [3 parameters bound]
Query: UpdateObjectQuery(tp.coma.cint.data.entities.Bookings[ bkId=22 ])
    at org.eclipse.persistence.exceptions.DatabaseException.sqlException(DatabaseException.java:324)
    at org.eclipse.persistence.internal.databaseaccess.DatabaseAccessor.executeDirectNoSelect(DatabaseAccessor.java:840)
    at org.eclipse.persistence.internal.databaseaccess.DatabaseAccessor.executeNoSelect(DatabaseAccessor.java:906)
    at org.eclipse.persistence.internal.databaseaccess.DatabaseAccessor.basicExecuteCall(DatabaseAccessor.java:592)
    at org.eclipse.persistence.internal.databaseaccess.DatabaseAccessor.executeCall(DatabaseAccessor.java:535)
    at org.eclipse.persistence.internal.sessions.AbstractSession.basicExecuteCall(AbstractSession.java:1702)
    at org.eclipse.persistence.sessions.server.ClientSession.executeCall(ClientSession.java:253)
    at org.eclipse.persistence.internal.queries.DatasourceCallQueryMechanism.executeCall(DatasourceCallQueryMechanism.java:207)
    at org.eclipse.persistence.internal.queries.DatasourceCallQueryMechanism.executeCall(DatasourceCallQueryMechanism.java:193)
    at org.eclipse.persistence.internal.queries.DatasourceCallQueryMechanism.updateObject(DatasourceCallQueryMechanism.java:749)
    at org.eclipse.persistence.internal.queries.StatementQueryMechanism.updateObject(StatementQueryMechanism.java:432)
    at org.eclipse.persistence.internal.queries.DatabaseQueryMechanism.updateObjectForWriteWithChangeSet(DatabaseQueryMechanism.java:1042)
    at org.eclipse.persistence.queries.UpdateObjectQuery.executeCommitWithChangeSet(UpdateObjectQuery.java:84)
    at org.eclipse.persistence.internal.queries.DatabaseQueryMechanism.executeWriteWithChangeSet(DatabaseQueryMechanism.java:287)
    at org.eclipse.persistence.queries.WriteObjectQuery.executeDatabaseQuery(WriteObjectQuery.java:58)
    at org.eclipse.persistence.queries.DatabaseQuery.execute(DatabaseQuery.java:829)
    at org.eclipse.persistence.queries.DatabaseQuery.executeInUnitOfWork(DatabaseQuery.java:728)
    at org.eclipse.persistence.queries.ObjectLevelModifyQuery.executeInUnitOfWorkObjectLevelModifyQuery(ObjectLevelModifyQuery.java:108)
    at org.eclipse.persistence.queries.ObjectLevelModifyQuery.executeInUnitOfWork(ObjectLevelModifyQuery.java:85)
    at org.eclipse.persistence.internal.sessions.UnitOfWorkImpl.internalExecuteQuery(UnitOfWorkImpl.java:2863)
    at org.eclipse.persistence.internal.sessions.AbstractSession.executeQuery(AbstractSession.java:1501)
    at org.eclipse.persistence.internal.sessions.AbstractSession.executeQuery(AbstractSession.java:1483)
    at org.eclipse.persistence.internal.sessions.AbstractSession.executeQuery(AbstractSession.java:1443)
    at org.eclipse.persistence.internal.sessions.CommitManager.commitChangedObjectsForClassWithChangeSet(CommitManager.java:265)
    at org.eclipse.persistence.internal.sessions.CommitManager.commitAllObjectsWithChangeSet(CommitManager.java:128)
    at org.eclipse.persistence.internal.sessions.AbstractSession.writeAllObjectsWithChangeSet(AbstractSession.java:3784)
    at org.eclipse.persistence.internal.sessions.UnitOfWorkImpl.commitToDatabase(UnitOfWorkImpl.java:1407)
    at org.eclipse.persistence.internal.sessions.RepeatableWriteUnitOfWork.commitToDatabase(RepeatableWriteUnitOfWork.java:634)
    at org.eclipse.persistence.internal.sessions.UnitOfWorkImpl.commitToDatabaseWithChangeSet(UnitOfWorkImpl.java:1497)
    at org.eclipse.persistence.internal.sessions.UnitOfWorkImpl.issueSQLbeforeCompletion(UnitOfWorkImpl.java:3135)
    at org.eclipse.persistence.internal.sessions.RepeatableWriteUnitOfWork.issueSQLbeforeCompletion(RepeatableWriteUnitOfWork.java:344)
    at org.eclipse.persistence.transaction.AbstractSynchronizationListener.beforeCompletion(AbstractSynchronizationListener.java:157)
    at org.eclipse.persistence.transaction.JTASynchronizationListener.beforeCompletion(JTASynchronizationListener.java:68)
    at com.sun.enterprise.transaction.JavaEETransactionImpl.commit(JavaEETransactionImpl.java:435)
    ... 56 more
Caused by: com.mysql.jdbc.exceptions.jdbc4.MySQLIntegrityConstraintViolationException: Duplicate entry '111222-0' for key 2
    at sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)
    at sun.reflect.NativeConstructorAccessorImpl.newInstance(NativeConstructorAccessorImpl.java:39)
    at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:27)
    at java.lang.reflect.Constructor.newInstance(Constructor.java:513)
    at com.mysql.jdbc.Util.handleNewInstance(Util.java:409)
    at com.mysql.jdbc.Util.getInstance(Util.java:384)
    at com.mysql.jdbc.SQLError.createSQLException(SQLError.java:1041)
    at com.mysql.jdbc.MysqlIO.checkErrorPacket(MysqlIO.java:3566)
    at com.mysql.jdbc.MysqlIO.checkErrorPacket(MysqlIO.java:3498)
    at com.mysql.jdbc.MysqlIO.sendCommand(MysqlIO.java:1959)
    at com.mysql.jdbc.MysqlIO.sqlQueryDirect(MysqlIO.java:2113)
    at com.mysql.jdbc.ConnectionImpl.execSQL(ConnectionImpl.java:2568)
    at com.mysql.jdbc.PreparedStatement.executeInternal(PreparedStatement.java:2113)
    at com.mysql.jdbc.PreparedStatement.executeUpdate(PreparedStatement.java:2409)
    at com.mysql.jdbc.PreparedStatement.executeUpdate(PreparedStatement.java:2327)
    at com.mysql.jdbc.PreparedStatement.executeUpdate(PreparedStatement.java:2312)
    at com.mysql.jdbc.jdbc2.optional.PreparedStatementWrapper.executeUpdate(PreparedStatementWrapper.java:877)
    at com.sun.gjc.spi.base.PreparedStatementWrapper.executeUpdate(PreparedStatementWrapper.java:125)
    at org.eclipse.persistence.internal.databaseaccess.DatabaseAccessor.executeDirectNoSelect(DatabaseAccessor.java:831)
    ... 88 more 
```

在日志中。

我的问题是：如何发现哪个表、列和值导致了异常，从而使用户更清楚地了解消息？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-10T16:24:16.460

我使用休眠并启用参数日志记录来调试这样的事情。我发现你可以对 eclipselink 日志做同样的事情，然后你可以看到问题是什么值。在您的 persistence.xml 中进行设置：

```
<property name="eclipselink.logging.parameters" value="true"/> 
```

来自[http://wiki.eclipse.org/EclipseLink/Examples/JPA/Logging](http://wiki.eclipse.org/EclipseLink/Examples/JPA/Logging)

# grep - 在 unix shell 脚本中的两个表达式之间提取数据

> ID：10092065
> 
> 赞同：0
> 
> 时间：2012-04-10T15:50:25.603
> 
> 标签：grep

我有一组标签，我需要从中提取一些数据。我知道这可能很简单。我无法准确了解该部分。标签如下所示。

```
<Response><Result>Success</Result></Response> 
```

我想提取标签之间的任何内容。在这种情况下，“成功”。
我尝试使用 grep 命令，但无法完成。任何帮助，将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-10T15:59:06.347

```
echo "<Response><Result>Success</Result></Response>" | perl -npe 's/.*>([^<]+)<.*/$1/' 
```

如果数据保存在文件中：

```
perl -npe 's/.*>([^<]+)<.*/$1/' infile 
```

# .net - 找不到入口点 mv3 和锐利的架构

> ID：10092066
> 
> 赞同：5
> 
> 时间：2012-04-10T15:50:28.417
> 
> 标签：.net, asp.net-mvc-3, fluent-nhibernate, s#arp-architecture

嗨，我收到此错误

Sharp architecture 2.0 适用于 mvc 3 错误是

> 未找到入口点

我在我的电脑上安装了 mvc 3 和 mvc 4，因为我卸载了 mvc 4 项目工作正常，但是有没有其他方法可以工作我也尝试在 web.config 中更改程序集设置

这是堆栈跟踪

> [EntryPointNotFoundException：找不到入口点。]
> System.Web.Mvc.MvcRouteHandler.GetSessionStateBehavior（RequestContext requestContext）+159
> System.Web.Mvc.MvcRouteHandler.GetHttpHandler（RequestContext requestContext）+41
> System.Web.Mvc.MvcRouteHandler.System。 Web.Routing.IRouteHandler.GetHttpHandler(RequestContext requestContext) +10
> System.Web.Routing.UrlRoutingModule.PostResolveRequestCache(HttpContextBase context) +9024264
> System.Web.Routing.UrlRoutingModule.OnApplicationPostResolveRequestCache(Object sender, EventArgs e) +86
> System.Web. SyncEventExecutionStep.System.Web.HttpApplication.IExecutionStep.Execute() +148 System.Web.HttpApplication.ExecuteStep(IExecutionStep step, Boolean& completedSynchronously) +75

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-11T09:35:21.817

谢谢，已解决必须删除所有以前的 mvc3 引用并从 /ProgramFiles/ASP.NET MVC 3/System.Web.Mvc.dll 再次重新引用它，因为默认情况下它只显示 mvc4 的程序集

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-08-30T09:50:14.970

还有另一种解决“找不到入口点异常”的方法，您可以在您的

```
<runtime>
        <assemblyBinding xmlns="urn:schemas-microsoft-com:asm.v1">
            <dependentAssembly>
                <assemblyIdentity name="System.Web.Mvc" publicKeyToken="31bf3856ad364e35" />
                <bindingRedirect oldVersion="1.0.0.0-4.0.0.0" newVersion="4.0.0.0" />
            </dependentAssembly>
        </assemblyBinding>
    </runtime> 
```

这将指示运行时使用 MVC4 二进制文件。我们在我们的项目中使用它，没有任何例外。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-10-28T19:39:56.593

我收到了类似的错误消息，这是由于我使用 nuget`5.0.0.0`获取`System.Web.Mvc`. 我像这样通过包管理器控制台回滚到早期版本：`Install-Package Microsoft.AspNet.Mvc -Version 4.0.30506`这解决了这个问题。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-11-10T18:20:27.577

我遇到了同样的问题，在 Visual Studio 中，您可以使用包管理器控制台和命令修复此错误：

```
update-package 
```

# java - Java JVM 热交换行为

> ID：10092069
> 
> 赞同：1
> 
> 时间：2012-04-10T15:50:44.383
> 
> 标签：java, hotswap

我今天尝试了 Javas Hotswap，它工作得很好。在我的测试中，我偶然发现了一个相当奇怪的行为。这是我的代码：

```
public class Test extends JFrame implements ActionListener{

private JButton c;
private int f =1;
/**
 * @param args
 */
public static void main(String[] args) {
    Test t = new Test();
}

public Test(){
    this.setPreferredSize(new Dimension(800, 600));
    this.setDefaultCloseOperation(EXIT_ON_CLOSE);
    c = new JButton("Click");
    c.addActionListener(this);
    this.add(c);
    this.pack();
    this.setVisible(true);
}

@Override
public void actionPerformed(ActionEvent e) {
    c.setText(String.valueOf(f++));

}

} 
```

注意`c.setText(String.valueOf(f++));`靠近结尾的那条线。如果我在程序运行时将其切换到`f--`，我注意到在更改后第一次单击按钮时，该值仍在计数。然而，之后的点击计数正确。将其改回时也会发生同样的情况。

我注意到的下一件事是：如果我将代码更改为：`c.setText(String.valueOf(f+=1));`，运行 JVM 并将其热交换以`c.setText(String.valueOf(f-=1));`直接应用更改，没有点击延迟。

我现在的问题是：究竟是什么导致了这种行为？JVM代码级别之间`f++`和之间有什么区别？`f+=1`

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-10T15:59:09.827

在此代码上使用 javap：

```
public static void main(String[] args) throws Exception {
    int i = 0;
    i++;
    System.out.println(i);
    i+=1;
    System.out.println(i);
} 
```

返回

```
 0: iconst_0
  1: istore_1
  2: iinc          1, 1
  5: getstatic     #2                  // Field java/lang/System.out:Ljava/io/PrintStream;
  8: iload_1
  9: invokevirtual #3                  // Method java/io/PrintStream.println:(I)V
 12: iinc          1, 1
 15: getstatic     #2                  // Field java/lang/System.out:Ljava/io/PrintStream;
 18: iload_1
 19: invokevirtual #3                  // Method java/io/PrintStream.println:(I)V
 22: return 
```

==> 没有区别

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-10T15:59:42.523

您是否关闭了所有优化？[JIT 编译器](https://stackoverflow.com/questions/5775396/jit-hotspot-technique-book)可以在幕后动态执行许多不同的技巧，因此生成的底层[代码](https://stackoverflow.com/questions/1144624/smart-jvm-and-jit-micro-optimizations)在[执行](https://stackoverflow.com/questions/5593215/hotspot-jit-optimization-and-de-optimization-how-to-force-fastest)期间[会](https://stackoverflow.com/questions/1503479/how-to-see-jit-compiled-code-in-jvm)多次[更改](https://stackoverflow.com/questions/1992486/why-doesnt-the-jvm-cache-jit-compiled-code)。

使用 actionPerformed() 您正在处理异步事件，即使没有热交换问题，也可能使执行路径变得更加困难。

做同样的测试代码

```
c.setText(String.valueOf(f++)); 
```

但是在一个带有断点集的大循环中执行它，这样你就可以用更少的移动部件来测试变化。

# android - 启动画面，播放 mp4

> ID：10092070
> 
> 赞同：-1
> 
> 时间：2012-04-10T15:50:59.953
> 
> 标签：android, video

我必须在我的应用程序启动时播放视频。我希望它是本地的，但它太大而无法转换为原始（11 秒），我必须让我的应用程序尽可能轻巧。因为它是一个启动画面，所以我不需要媒体控制器。

我想知道这样做的最佳方法是什么，如果我是对的，VideoView 无法理解直接 mp4。有人这样做过吗？

```
 public class SplashScreenActivity extends Activity{
    private VideoView myVideoView;
    private MediaPlayer mediaPlayer;
    private MediaController mediaController;

    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.video_player_layout);

        myVideoView = (VideoView) findViewById(R.id.video_player_video_view);
//      mediaController = new MediaController(this);

        myVideoView.setVideoURI(Uri.parse("android.resource://" + getPackageName() +"/"+R.raw.splash));
//      myVideoView.setMediaController(mediaController);
        myVideoView.requestFocus();
        myVideoView.start();

    }
} 
```

编辑：使用媒体播放器，它保持错误状态

```
MediaPlayer mp = MediaPlayer.create(this, R.raw.splash);
        mp.setOnCompletionListener(this);
        mp.start(); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-10T16:34:50.870

```
myVideoView.setVideoURI(Uri.parse("android.resource://" + getPackageName()+"/"+R.raw.splash)); 
```

用下面替换上面的行并尝试..

```
String path = "android.resource://" + getPackageName()+"/raw/splash";
myVideoView.setVideoURI(Uri.parse(path));
myVideoView.setVideoPath(getDataSource(path)); 
```

# epub - 如何保护 epub 文件不被复制和打印？

> ID：10092072
> 
> 赞同：2
> 
> 时间：2012-04-10T15:51:13.197
> 
> 标签：epub, drm

我想保护我的 epub 文件免受无效访问。有谁知道如何保护 epub 文件不被复制和打印？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-10T16:48:44.367

ePub 文件没有执行数字版权管理 (DRM) 的内置方法，这正是您要问的。该规范确实允许在 ePub 文件上实施各种 DRM 方案（参见此处 -> [http://en.wikipedia.org/wiki/EPUB#Digital_rights_management](http://en.wikipedia.org/wiki/EPUB#Digital_rights_management)），但没有标准化的、特定于 ePub 的方法来执行此操作。因此，如果您想这样做，请查看可用于 ePub 的各种类型的 DRM。

一种可能的选择可能是[DocProtect 4](http://www.excelsoftware.com/news_docprotect_400.html)。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-03T23:02:19.297

如果您在 Amazon 或 Apple 上发布您的电子书，您可以选择让他们将其包装在他们的 DRM 中，这实质上是强制执行有关可以在哪些设备上阅读它的规则（例如，购买者最多注册 N 台设备）。这不是你真正想做的事情。但是，您应该考虑是否真的要这样做。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-26T12:40:58.763

是的，您需要 DRM（数字版权管理）解决方案。这也很昂贵，实施起来非常困难。[您必须以需要www.editionguard.com](http://www.editionguard.com)等服务的方式选择您的解决方案

# c++ - C++11 std::function 是否限制函数指针可以具有的参数数量？

> ID：10092074
> 
> 赞同：14
> 
> 时间：2012-04-10T15:51:18.110
> 
> 标签：c++, c++11, function-pointers, std

我正在使用 Visual Studio 11 beta，我很好奇在我的类中存储 std::function 对象时出现的编译错误。

```
typedef std::function<void (int, const char*, int, int, const char*)> MyCallback; 
```

在我的课堂上，

```
MyCallback m_callback; 
```

这编译得很好。如果我在列表中再添加一个参数，它就会失败。

```
typedef std::function<void (int, const char*, int, int, const char*, int)> MyCallback; 
```

失败是：

```
>c:\program files (x86)\microsoft visual studio 11.0\vc\include\functional(535): error C2027: use of undefined type 'std::_Get_function_impl<_Tx>'
1>          with
1>          [
1>              _Tx=void (int,const char *,int,int,const char *,int)
1>          ]
1>          f:\development\projects\applications\my.h(72) : see reference to class template instantiation 'std::function<_Fty>' being compiled
1>          with
1>          [
1>              _Fty=void (int,const char *,int,int,const char *,int)
1>          ]
1>c:\program files (x86)\microsoft visual studio 11.0\vc\include\functional(536): error C2504: 'type' : base class undefined
1>c:\program files (x86)\microsoft visual studio 11.0\vc\include\functional(539): error C2027: use of undefined type 'std::_Get_function_impl<_Tx>'
1>          with
1>          [
1>              _Tx=void (int,const char *,int,int,const char *,int)
1>          ]
1>c:\program files (x86)\microsoft visual studio 11.0\vc\include\functional(539): error C2146: syntax error : missing ';' before identifier '_Mybase'
1>c:\program files (x86)\microsoft visual studio 11.0\vc\include\functional(539): error C4430: missing type specifier - int assumed. Note: C++ does not support default-int 
```

这是一个动态链接库，它正在准备数据以传递给另一个应用程序。我当然可以重新设计数据的格式，以便可以用更少的参数传递它，但我想知道为什么我看到了这个限制？

切换回 c 风格的函数指针，

```
 typedef void (*MyCallback)(int, const char*, int, int, const char*, int); 
```

似乎工作正常。

* * *

## 回答 #1

> 赞同：37
> 
> 时间：2012-04-10T15:55:06.397

此限制由 Visual Studio 中的实现设置。

C++ 规范`std::function`没有设置任何限制。`std::function`使用可变参数模板来处理任意数量的参数。实现可能有一个限制，例如，模板实例化嵌套限制，但它应该很大。例如，该规范建议 1024 作为支持的最小嵌套深度，256 作为一个函数调用中允许的参数的一个很好的最小值。

Visual Studio（从 VS11 开始）没有可变参数模板。他们在 VS11 中最多模拟 5 个参数，但您可以将其更改为最多 10 个。通过`_VARIADIC_MAX`在项目中定义来做到这一点。这会大大增加编译时间。

更新：VS 2012 Nov CTP 添加了对可变参数模板的支持，但标准库尚未更新以使用它们。更新后，您应该能够使用任意数量的参数`std::function`。

# database - 使用 CakePHP 2.0 进行数据库测试

> ID：10092079
> 
> 赞同：0
> 
> 时间：2012-04-10T15:51:45.197
> 
> 标签：database, cakephp, testing, phpunit, cakephp-2.0

我想测试我的模型类之一，所以我必须从我的数据库中插入、更新和删除数据，以测试我的方法是否正常工作。

我正在使用一个已定义的测试数据库，其中我已经有一些数据。为了测试所有方法，我使用两个角色，一个是管理员，一个是用户。所以我使用 setUp 方法获取他们的数据，如下所示：

```
public function setUp() {
    parent::setUp();
    $this->User = ClassRegistry::init('User');

    $admin = $this->User->query("select * from users where admin = 1");
    $this->testUser['admin']['id'] = $admin[0]['users']['id'];
    $this->testUser['admin']['username'] = $admin[0]['users']['username'];
    $this->testUser['admin']['password'] = $admin[0]['users']['password'];
    $this->testUser['admin']['verified'] = $admin[0]['users']['verified'];
    $this->testUser['admin']['created'] = $admin[0]['users']['created'];
    $this->testUser['admin']['nick'] = $admin[0]['users']['nick'];
    $this->testUser['admin']['admin'] = $admin[0]['users']['admin'];

    $user = $this->User->query("select * from users where admin = 0 and verified = 0");

    $this->testUser['user']['id'] = $user[0]['users']['id'];
    $this->testUser['user']['username'] = $user[0]['users']['username'];
    $this->testUser['user']['password'] = $user[0]['users']['password'];
    $this->testUser['user']['verified'] = $user[0]['users']['verified'];
    $this->testUser['user']['created'] = $user[0]['users']['created'];
    $this->testUser['user']['nick'] = $user[0]['users']['nick'];
    $this->testUser['user']['admin'] = $user[0]['users']['admin'];

} 
```

当我想测试像“banAccess”这样将数据从用户表移动到被禁止用户表的方法时，我遇到了一个问题，因为下次我为测试选择的用户将无法正常运行' t 在同一张桌子上。似乎 setUP() 和 tearDown() 方法只在调用所有测试方法后执行一次。这样，如果 bannAccess 测试方法在 testGetUserName 方法之前执行，例如，最后一个将失败，因为用户不在 Users 表上。

目前我正在测试该方法并在它之后删除用户以解决此问题，但我确信它必须是一种更好的方法：

```
public function testBanAccess() {
    $result = $this->User->banAccess($this->testUser['user']['id'], 'spam', '42');
    $expected = true;

    $this->assertEquals($expected, $result);

    $this->User->query("delete from banUsers where id = ".$this->testUser['user']['id']);
} 
```

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-10T16:00:56.567

你的整个测试设置不好。您应该为此使用固定装置，并在固定装置中显示记录。见[http://book.cakephp.org/2.0/en/development/testing.html#fixtures](http://book.cakephp.org/2.0/en/development/testing.html#fixtures)

setUp() 和 tearDown() 只执行一次，而 startTest() 和 endTest() 用于每个 test*() 方法。

此外，您不应***使用***query() ，因为由于 SQL 注入，它可能不安全。如果您愿意使用 CakePHP ORM 会处理它...看到测试中出现的 query() 让我觉得您已经在应用程序中使用它并构建了一个非常不安全的应用程序。

另外，为什么您必须将用户复制到另一个表，而不是简单地用一个简单的 tinyint 字段将它们标记为禁止？

# c# - C# WinForms 从引用文本中获取价值

> ID：10092083
> 
> 赞同：0
> 
> 时间：2012-04-10T15:52:11.630
> 
> 标签：c#, regex

我如何得到`George Bush`：

```
"<LABEL>დასახელება ან სახელი, გვარი&lt;/LABEL> <INPUT id=ctl00_ContentPlaceHolder1_txtBuyerName class=inactive_input title=\"მაქსიმალური სიმბოლოების რაოდენობა 90\" name=ctl00$ContentPlaceHolder1$txtBuyerName readOnly value=\"George Bush\"> " 
```

我尝试了几乎所有返回谷歌的模式。

请帮助我，我已经尝试了 3 个小时。

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-10T15:54:43.277

尝试以下

```
string input = ...;
var match = Regex.Match(input, @"value=""([^""]*)""");
if (match.Success) {
  var name = match.Groups[1].Value;
  ...
} 
```

# python - 用python读取pcap头长度字段

> ID：10092084
> 
> 赞同：1
> 
> 时间：2012-04-10T15:52:13.003
> 
> 标签：python, pcap

我已经使用 c 中的 pcap 库捕获了一些数据包。现在我正在使用 python 程序来读取保存的数据包文件。但我这里有个问题。我有一个文件，它首先有 pkthdr（由 lybrary 提供），然后是实际数据包。pkthdr 的格式是-

```
struct pcap_pkthdr {
    struct timeval ts; /* time stamp 32bit */ 32bit
    bpf_u_int32 caplen; /* length of portion present */
    bpf_u_int32 len; /* length this packet (off wire) */
}; 
```

现在我想读取 len 字段，所以我跳过了 timeval 和 cap len，并使用 python 以二进制形式打印了 len 字段。我得到的二进制代码是 - 01001010 00000000 00000000 00000000 现在如何在 u_int32 中读取它，我不知道认为它是正确的值（太大），实际的 len 字段值应该是 74 字节（在 wireshark 中检查）.. 所以请告诉我我做错了什么.. 提前谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-10T16:39:58.157

或者查看[pylibpcap](http://sourceforge.net/projects/pylibpcap/)模块、[pypcap](http://code.google.com/p/pypcap/)模块或[pcapy](http://www.darknet.org.uk/2007/12/pcapy-python-interface-to-libpcap/)模块，它们让您可以相对轻松地调用 pcap API。这样您就不必*关心*pcap 文件的详细信息，并且您的代码将使用 libpcap 1.1 或更高版本，还能够读取至少一些 Wireshark 可以生成并且它将生成的 pcap-ng 文件*默认情况下*在 1.8 版本中。

编写自己的代码来读取 pcap 文件，而不是依赖 libpcap/WinPcap 这样做，很少值得这样做。（Wireshark 这样做，作为其库的一部分，该库读取多种捕获文件格式并以当前 pcap API 无法支持的方式支持 pcap-ng 格式，但相关库也支持 pcap-ng ....）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-10T16:00:05.330

查看[`struct`模块](http://docs.python.org/library/struct.html)，它可以让您相对轻松地解压缩此类二进制数据，例如：

```
struct.unpack('LLL', yourbuffer) 
```

这将为您提供三个（L = unsigned long）值的元组。如果 len 值看起来不正确，则文件的[字节顺序](http://docs.python.org/library/struct.html#byte-order-size-and-alignment)与您的原生字节顺序不同。在这种情况下，使用`>`(big-endian) 或`<`(little-endian) 为格式字符串添加前缀：

```
struct.unpack('>LLL', yourbuffer) 
```

# windows - 是否可以在没有管理员权限的情况下在 Windows XP 上运行 Oracle？

> ID：10092086
> 
> 赞同：1
> 
> 时间：2012-04-10T15:52:28.760
> 
> 标签：windows, oracle, windows-xp, admin

我有共享计算机，管理员安装 Oracle XE。但是我不能创建新用户，因为我在操作系统中没有权限，afaik。在 Oracle 文档中，DBA 应该是管理员组的成员。是否存在我可以在没有管理员权限的情况下管理本地实例 XE 的方式？我需要启动/停止数据库、连接/断开连接、终止会话等。它需要测试我的 Java 应用程序。

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-10T16:36:41.320

您不需要具有管理员权限的操作系统用户（一旦安装并运行 Oracle）。

只需以 SYSDBA 身份连接，您就可以创建新的 Oracle 用户并管理整个数据库。

（我也在 XP 上这样做 - 与普通用户一起工作，但如果我需要在 Oracle 中配置某些东西，则以 SYSTEM 或 SYS 身份连接 SYSDBA 角色）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-06-26T06:05:10.860

From XE manual [here](http://docs.oracle.com/cd/B25329_01/doc/admin.102/b25107/users_secure.htm#CHDGFBAJ) :

*" On each platform, if the OS authentication user group does not already exist, it is automatically created when you install Oracle Database XE. In addition, upon installation on the Linux platform, the user account oracle is automatically created and placed in the dba group. Upon installation on the Windows platform, the user performing the installation is automatically added to the ORA_DBA group. On both platforms, you can add other host users to the OS authentication user group to enable them to connect to the database with the SYSDBA privilege. "*

Since installation on windows needs admin user which I assume you are not, so it renders the automatic addition of that admin user to ORA_DBA group useless for you.

So what your admin can do immediately after XE installation on this shared machine is just **add** your **non-admin OS user** (local or domain level, whatever) **to** the newly created OS local group **"ORA_DBA"**. Once this is done, you can simply open the sqlplus prompt and connect with SYSDBA privilege using your own non-admin user in future:

```
connect / as sysdba 
```

However, you will still not be able to restart the Oracle service or the TNS listener, even if you are in the ORA_DBA group.

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-10T16:20:54.390

> 是否存在我可以在没有管理员权限的情况下管理本地实例 XE 的方式？

可能不是……如果这就是 Oracle 文档所说的。

一个明智的策略是与管理员讨论您的问题。指出如果您没有访问权限，您将难以完成工作。如果他们不授予您系统管理员权限，请让他们建议可以让您完成工作的替代方案。

可能只是他们需要在 Oracle 中授予您额外的权限。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-04-10T16:32:02.747

如何在虚拟机中*获得管理员权限？*请参阅 virtualbox.org。

# javascript - 如何执行具有可操作反馈的跨站点脚本攻击测试？

> ID：10092088
> 
> 赞同：1
> 
> 时间：2012-04-10T15:52:56.063
> 
> 标签：javascript, ruby-on-rails, ruby-on-rails-3, security, xss

我有一个站点安全监视器，它最近刚刚开始引发有关跨站点脚本攻击的错误。我发现测试结果缺乏解决问题的实际细节。

**是否有事实上的测试套件或方法可以用于查找和解决 XSS 问题？** 这个特定的平台是基于 Rails 3.1.x 构建的，我的印象是 Rails 采取了一些措施来确保现在默认情况下仔细处理 XSS 问题。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-10T17:42:10.177

在大多数情况下，XSS 非常明显，但并非总是如此。有很多方法可以在 html 文档中执行 JavaScript。[XSS 预防规则](https://www.owasp.org/index.php/XSS_%28Cross_Site_Scripting%29_Prevention_Cheat_Sheet#XSS_Prevention_Rules)很好地描述了 XSS 发生的不同方式。

作为一名 Ruby 程序员，您应该阅读[Ruby on Rails 安全指南](http://guides.rubyonrails.org/security.html)。

# javascript - 无法使表单在使用 javascript 的页面上工作

> ID：10092089
> 
> 赞同：0
> 
> 时间：2012-04-10T15:52:56.163
> 
> 标签：javascript, html, forms

我创建了一个页面，允许用户输入开始位置和结束位置并输出距离（这使用谷歌 API）。我有几个这样的实例，一旦用户完成，就会有几个开始位​​置、结束位置和位置之间的距离。我现在需要将每个“旅程”链接到一个使用 PHP 链接到数据库的提交表单，但是当我将这一切都放在一个表单中时，它会停止工作，因为每次用户输入旅程时，页面都会自行刷新。我能看到的唯一方法是将每一行放在自己的表单中，并以某种方式将所有表单链接到一个提交按钮？我怎样才能解决这个问题或者将它连接到数据库的最佳方式是什么？抱歉，如果我解释得不够好。我的其中一行的代码如下所示。

```
<form>

<tr height="60">
<td>Date</td>
<td>Job</td>
<td>Start Location</td>
<td>End Location</td>
<td>Confirm Route</td>
<td>Distance</td>
</tr>

<body onload="initialize(); initialize1(); initialize2(); initialize3(); initialize4(); initialize5(); initialize6(); initialize7(); initialize8(); initialize9(); initialize10(); ">

<script type="text/javascript">
    var directionDisplay;
    var directionsService = new google.maps.DirectionsService();
    var map;

    function initialize() {
        directionsDisplay = new google.maps.DirectionsRenderer();
        var belfast = new google.maps.LatLng(55, -5)
        var myOptions = {
            zoom:5,
            mapTypeId: google.maps.MapTypeId.ROADMAP,
            center: belfast,
        }

        map = new google.maps.Map(document.getElementById("map_canvas"), myOptions);
        directionsDisplay.setMap(map);
    }

    function calcRoute() {
        var start = document.getElementById("pc1").value;
        var end = document.getElementById("pc2").value;

        var distanceInput = document.getElementById("distance");
        var request = {
            origin:start, 
            destination:end,
            travelMode: google.maps.DirectionsTravelMode.DRIVING
        };

        directionsService.route(request, function(response, status) {
            if (status == google.maps.DirectionsStatus.OK) {
                directionsDisplay.setDirections(response);
                distanceInput.value = Math.round(response.routes[0].legs[0].distance.value / 1000);
                updateTotalDistance();                  
            }
        });
    }
</script>

<tr height="38">
<td><input valign="top" type="text" name="date" id="datepicker" style="width:75px"/></td>
<td><textarea valign="top" name="job" cols="10" rows="1"></textarea></td>
<td><select id="pc1">
<option>Antrim Area Hospital</option>
<option>Causeway hospital</option>
<option>Braid Valley Hospital</option>

</select>
</td>
<td><select id="pc2">
<option>Antrim Area Hospital</option>
<option>Causeway hospital</option>
<option>Braid Valley Hospital</option>

</select></td>
<td><input type="submit" value="OK" name="submit" id="submit1" onclick="calcRoute()"></td>
<td><input type="text" class="distance" id="distance" readonly="true" onkeyup="return   autocalc(this,t2,t3)" tabindex="1" style="width:45px"></td>

</form> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-10T15:59:59.343

解决此问题的最佳方法是在 PHP 中使用[AJAX 技术](http://www.ajaxf1.com/tutorial/ajax-php.html)。

# android - 如何删除 ExpandableListView 的按钮？

> ID：10092090
> 
> 赞同：8
> 
> 时间：2012-04-10T15:52:59.650
> 
> 标签：android, button, expandablelistview, expand

我`ExpandableListAdapter`在我的项目中使用了自定义。如何删除此按钮？ ![在此处输入图像描述](../Images/327c68149658e50938fe2e941429c2ba.png)

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2012-04-10T15:59:57.983

在 XML 中

```
android:groupIndicator="@null" 
```

或在代码中

```
expListView.setGroupIndicator(null) 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-10T16:00:39.730

您是否尝试过使用这个： android:groupIndicator="@android:color/transparent" ？

我不知道您为什么要删除此按钮，但在某些情况下，我的建议可能很有用。

# c# - 将字符串内容上传到 google doc

> ID：10092093
> 
> 赞同：1
> 
> 时间：2012-04-10T15:53:04.693
> 
> 标签：c#, .net, google-docs, google-docs-api

我想知道我是否可以在不上传文档的情况下在 google docs 上创建一个文档。我只想从我的 c# windows 应用程序传递一个文本框的值并将其存储到 google docs 服务器上。我不想创建任何要在谷歌文档上上传的中间文件..我将文本框数据存储在 ms 访问数据库中，我希望它也保存在谷歌文档中..

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-10T16:48:38.997

尝试使用以下代码：

```
DocumentsService service = new DocumentsService("MyApp");

// TODO: Authorize the service object

Stream stream = new MemoryStream(ASCIIEncoding.Default.GetBytes("This is the document content"));

DocumentEntry entry = service.Insert(new Uri(DocumentsListQuery.documentsBaseUri), stream, "text/plain", "Document title") as DocumentEntry; 
```

# jquery - 实时发送表单时如何使用jQuery表单插件

> ID：10092094
> 
> 赞同：0
> 
> 时间：2012-04-10T15:53:07.253
> 
> 标签：jquery, ajax

插件： http: [//www.malsup.com/jquery/form/#ajaxSubmit](http://www.malsup.com/jquery/form/#ajaxSubmit)

编码：

```
$( 'form#form' ).live('submit', function( event ){
     if( this.arquivo )
     {
          var options = { 
               success:    showResponse
          }; 

          // pass options to ajaxForm 
          $( '#form' ).ajaxForm( options );         
          $( '#form' ).ajaxSubmit();

          return false;
     }
});

function showResponse(responseText, statusText, xhr, $form)  {
     alert( responseText );
} 
```

通过提交表单，函数 showResponse 不会被调用。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-10T15:59:17.610

尝试使用：

```
function showResponse(responseText, statusText, xhr, $form)  {
    alert( responseText );
}
var options = {
    success: showResponse
};
//   you dont need to say form#form although i would suggest changing ID name
    // if you're using newer jquery, .live is deprecated to .on and .off
$("#form").on("submit", function(e) {
    $(this).ajaxSubmit(options);
    return false; 
}); 
```

虽然，如果表单不是动态创建的，你最好使用：

```
$("#form").ajaxForm(options); 
```

# ajax - Zend 框架 $this->_request->isXmlHttpRequest() IE7/8

> ID：10092105
> 
> 赞同：1
> 
> 时间：2012-04-10T15:53:28.860
> 
> 标签：ajax, zend-framework, internet-explorer-8, internet-explorer-7, xmlhttprequest

在使用 IE7/8 时，我似乎在检查控制器中的 AJAX 请求时遇到了问题。

```
if($this->_request->isXmlHttpRequest()) {
    $do = 'the dance';
} 
```

但`$do`永远不会被 Zends 填满`isXmlHttpRequest()`......

任何人都可以帮忙吗？

编辑：在客户端我使用 jQuery 发送请求

```
$.ajax({
        url: url,
        data: data,
        type: "POST",
        success: fx.planer.callback
    });

ajax($form.attr("action"), $form.serialize()); 
```

任何线索为什么 jQuery 缺少标题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-18T13:30:50.457

这听起来很愚蠢，但......

1/`if($this->getRequest()->isXmlHttpRequest())`行为是否相同？

2/你如何检查 $do 没有被填满？您是否尝试在 if 中使用 echo ？

# java - 在简单的服务器/套接字程序中未完成连接

> ID：10092108
> 
> 赞同：0
> 
> 时间：2012-04-10T15:53:41.563
> 
> 标签：java, multithreading, sockets

我有 2 个课程，它们是`GameServer`和`NetworkThread`。该程序从其他地方创建一个套接字，然后将它传递给`NetworkThread`'s 的构造函数
我只想有 2 个客户端并且这 2 个相互交互。构造函数中第一个客户端的 id`NetworkThread`是 1，另一个是 2。但是当我启动第二个客户端的连接时，它永远不会进入`NetworkThread`该类。这是我的代码：

网络线程类：

```
public class NetworkThread implements Runnable, ActionListener {

    Socket newClient;
    String userName;
    int id;

    Scanner sc = null;
    PrintWriter pw = null;

    public NetworkThread(Socket newClient, String userName, int id) {
        this.userName = userName;
        this.newClient = newClient;
        this.id = id;

        try {
            pw = new PrintWriter(newClient.getOutputStream());
            sc = new Scanner(newClient.getInputStream());
        } catch (IOException e) {
        }

        ConstructFrame();
        if (id == 1)
            changeTurnAsAGuesser();
        else
            startConnectionForSecondPlayer();
    }

    @Override
    public void run() {
    }

    private void changeTurnAsAGuesser() {   
        String word;
        String passing;

        word = JOptionPane.showInputDialog(null, "Enter Word",
                "input" + userName, JOptionPane.QUESTION_MESSAGE).toUpperCase();
        passing = "~:";
            do {
                char x = sc.nextLine().charAt(0);
                // after some works with ~> passing
                pw.println(passing);
                pw.flush();
            } while (checkWord(word, passing) == false);

                 //checkWord method returns a boolean
        } catch (Exception e) {
        }
    }
    private void startConnectionForSecondPlayer() {
        new Thread() {
            public void run() {
                while (true) {
                    String taken = sc.nextLine();
                    jf.setTitle(taken);
                }
            }
        }.start();
    }
} 
```

游戏服务器类：

```
public class GameServer {

    static int i = 0;
    ServerSocket gameServer = null;
    String userName;

    public GameServer(String username) {
        this.userName = username;
        new Thread() {
            public void run() {
                try {
                    gameServer = new ServerSocket(4444);
                } catch (IOException e) {
                }
                while (true) {
                    try {
                        i++;
                        Socket newClient = gameServer.accept();
                        System.out.println(i);
                        Thread th = new Thread(new NetworkThread(newClient,
                                userName, i));
                        th.start();
                    } catch (UnknownHostException e) {
                    } catch (IOException e) {
                    }
                }
            }
        }.start();
    }
} 
```

编辑：我想实现一个刽子手游戏，其中第一个客户说出一个词，另一个尝试猜测那个词，但我的主要问题是我无法开始成功的连接！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-10T16:00:52.383

啊，我明白了。您正在您的构造函数中完成所有工作，`NetworkThread`而不是`run()`方法。在构造函数中，when`id == 1`调用`changeTurnAsAGuesser`执行`accept`. 在它返回之前不会进行其他`accept`调用。

您需要做的是`if (id == 1)`从构造函数中删除代码并将其移动到`run()`后台线程调用的方法中：

```
public NetworkThread(Socket newClient, String userName, int id) {
    ...
    ConstructFrame();
    // don't do the interactive work in the constructor
}

@Override
public void run() {
    // do it in the background thread
    if (id == 1)
        changeTurnAsAGuesser();
    else
        startConnectionForSecondPlayer();
} 
```

# c# - 更改矩形背景以反映 WPF 中 DataContext 中的布尔值状态

> ID：10092110
> 
> 赞同：0
> 
> 时间：2012-04-10T15:53:51.263
> 
> 标签：c#, wpf, xaml

我有一个简单的 UI，它在它的应用程序模型中调用几个解析和处理例程，这些例程通过 BackgroundWorkers 异步完成工作。当模型代码正常工作时，它会设置几个属性，解析和处理。我的 UI 中有两个矩形，我想根据是否设置了这些布尔值来更改颜色。窗口 DataContext 设置为模型，消息列表和 UI 的其他部分工作正常，我似乎无法弄清楚如何在 XAML 中表达我想要做的事情。

这是我的矩形代码的示例：

```
<Rectangle Height="20" Name="ParsingLamp" Stroke="Black" Width="20" RadiusX="4" RadiusY="4" Fill="Gray">
    <Rectangle.Triggers>
        <Trigger Property="{Binding Path=Parsing}" Value="true">
            <Setter TargetName="ParsingLamp" Property="Fill" Value="LightGreen" />
        </Trigger>
        <Trigger Property="{Binding Path=Parsing}" Value="false">
            <Setter TargetName="ParsingLamp" Property="Fill" Value="Brown" />
        </Trigger>
    </Rectangle.Triggers>
</Rectangle> 
```

我收到一条错误消息，提示“填充成员无效，因为它没有质量类型名称。”

也许触发器不是做我想要完成的事情的正确方法？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-10T16:19:08.380

几个问题：

*   您需要使用 DataTrigger，因为您要绑定到 ViewModel。

*   DataTriggers 需要在 Style 中。

*   如果您设置一个本地值，例如，`<Rectangle Fill=''/>`这会覆盖触发器设置的值，因此您需要将其删除。

这应该有效：

```
<Page.Resources>
    <Style x:Key="LampStyle" TargetType="{x:Type Rectangle}">
        <Style.Triggers>
            <DataTrigger Binding="{Binding Path=Parsing}" Value="true">
                <Setter Property="Fill" Value="LightGreen" />
            </DataTrigger>
            <DataTrigger Binding="{Binding Path=Parsing}" Value="false">
                <Setter Property="Fill" Value="Brown" />
            </DataTrigger>
        </Style.Triggers>
    </Style>
</Page.Resources>

<Grid>
    <Rectangle Height="20" Style="{StaticResource LampStyle}" Stroke="Black" Width="20" RadiusX="4" RadiusY="4" />
</Grid> 
```

# javascript - 浏览页面后 JQuery Mobile 丢失所有样式

> ID：10092111
> 
> 赞同：9
> 
> 时间：2012-04-10T15:54:02.417
> 
> 标签：javascript, css, ajax, jquery-mobile

我正在经历一个严重的头痛，在过去的几个小时里，我无法弄清楚为什么当我在页面之间轻弹（由 ajax 动态加载）时，样式都会消失。

我已经在网上阅读了数十篇关于此的帖子，并尝试了 .page() trigger("Refresh") trigger create 等等。

第 1 页有一个列表，单击该项目时，它会获取另一个列表的完整内容并将它们放入 DOM。

JQuery 版本（移动版 1.1rc2 - 但与 1.0.1 稳定版相同的问题）：

```
<script src="scripts/ajax.js"></script>
<script src="http://code.jquery.com/jquery-1.7.1.min.js"></script>
<script src="http://code.jquery.com/mobile/latest/jquery.mobile.js"></script>
<link rel="stylesheet" href="http://code.jquery.com/mobile/latest/jquery.mobile.css"> 
```

在初始列表上单击此链接：

```
javascript:GetGarageList("G9236") 
```

触发：

```
// show garages for factor
function GetGarageList(accNo) {
    $.mobile.showPageLoadingMsg("b", "Loading", false);
    $.ajax({
        type: "POST",
        url: "Default.aspx/GetGarageList",
        data: "{'accNo':'" + accNo + "'}",
        contentType: "application/json; charset=utf-8",
        dataType: "json",
        success: function (msg) {
            $("#garageList").html(msg.d);
            $.mobile.changePage("#garageList");
        },
        error: function () {
            ShowError("Error :(");
        },
        complete: function () {
            $.mobile.hidePageLoadingMsg();
        }
    });
}; 
```

第一次加载时，第二页看起来很完美：

![在此处输入图像描述](../Images/432d6255ba71cacb7db4673cc38f8190.png)

但是当我按下返回按钮时。然后点击另一个链接：

```
javascript:GetGarageList("G9336") 
```

我搞砸了视图：

![在此处输入图像描述](../Images/210ecd085ca8cf2f181382f4d504b701.png)

请帮忙！

编辑 ：

其他人使用过 .trigger("create"); 并说他们解决了这个问题......但每次我将它添加到我的代码中时：

```
$("#garageList").html(msg.d).trigger("create"); 
```

或者

```
$("#garageList").html(msg.d);
$("#garageList").trigger("create"); 
```

它只是给了我一个永远的加载微调器。

编辑2：

根据下面的 Barnes 建议，我已将 html 更改为：

```
 <%--Garage List--%>
    <div data-role="page" id="garageList" data-add-back-btn="true" data-theme="a">
        <div data-role='header' data-position='fixed'>
            <h1>Garages</h1>
            <a href='index.html' data-icon='plus' data-iconpos='notext' class='ui-btn-right' data-theme='b'></a>
        </div>
        <div data-role='content' id="abc">
            <ul data-role='listview' id='xyz' data-filter='true' data-filter-theme='a' data-filter-placeholder='search name or account no...' data-split-icon='info' data-split-theme='a'>

/// --> new content goes here... as simply many <li> items.

</ul>
        </div> <!-- /content -->
    </div> <!-- /page --> 
```

然后我尝试了（在ajax成功中）：

```
 $("#xyz").empty();
            $("#xyz").html(msg.d);
            $("#abc").listview("refresh");
            $.mobile.changePage("#garageList"); 
```

和

```
 $("#xyz").html(msg.d);
            $("#xyz").listview("refresh");
            $.mobile.changePage("#garageList"); 
```

这是 msg.d 的一些示例输出：

```
"<li><a href='javascript:GetGarageDetails(16267)'><h3>A KETCHEN MOTOR ENGINEERS</h3><p><strong>MID LOTHIAN</strong></p></a><a href="javascript:GetFactorDetails('16267')"></a></li>

<li><a href='javascript:GetGarageDetails(16328)'><h3>G.A.AUTOS</h3><p><strong></strong></p></a><a href="javascript:GetFactorDetails('16328')"></a></li>

<li><a href='javascript:GetGarageDetails(16262)'><h3>GARRY HENDERSON MOTOR ENGINEERS</h3><p><strong>WEST LIMTON</strong></p></a><a href="javascript:GetFactorDetails('16262')"></a></li>

<li><a href='javascript:GetGarageDetails(16264)'><h3>LEADBURN GARAGE LTD</h3><p><strong>PEELBLESHIRE</strong></p></a><a href="javascript:GetFactorDetails('16264')"></a></li>

<li><a href='javascript:GetGarageDetails(16315)'><h3>LOTHIAN MOTORS</h3><p><strong></strong></p></a><a href="javascript:GetFactorDetails('16315')"></a></li>

" 
```

和其他变体，但它仍然不想玩（微调器在刷新时永远持续）......虽然它改进了一点（当我拿出刷新时）：

![在此处输入图像描述](../Images/25414846cd6ed5b3e8a09877c9932814.png)

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-04-14T19:57:09.207

这一直在解决我所有的问题。

```
$('...').trigger('create'); 
```

你只需要找到合适的元素放入选择器。

对我来说，这些行起到了作用：

```
$(document).bind('pagechange', function() {
  $('.ui-page-active .ui-listview').listview('refresh');
  $('.ui-page-active :jqmData(role=content)').trigger('create');
}); 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-05-21T15:28:18.357

更改页面后放置`listview('refresh')`解决了我的问题。

```
$.mobile.changePage("#catalog");

$('#list_included_in_catalog_page').listview('refresh'); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-11T10:15:21.787

代替

```
success: function (msg) {
    $("#garageList").html(msg.d);
    $.mobile.changePage("#garageList");
} 
```

做

```
success: function (msg) {
    $("#abc").html("&lt;ul data-role='listview' id='xyz' data-filter='true' data-filter-theme='a' data-filter-placeholder='search name or account no...' data-split-icon='info' data-split-theme='a'&gt; " + msg.d + "&lt;ul&gt;");
    $.mobile.changePage("#garageList");
    $("#abc").find(":jqmData(role=listview)").listview();
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-12T09:28:00.023

在尝试了一切之后，我选择了一个不太理想的使用单独的 .aspx 页面的解决方案。

但是现在这有一个问题，我现在必须在页面之间的 URL 中传递参数（安全风险）。

所以不要使用：

```
javascript:GetGarageList("G9236") 
```

我现在使用 guid 代替：

```
http://localhost:54419/GarageList.aspx?id=319d8819-11ae-446f-b373-50d08e06159a 
```

我在 c# 页面加载事件中生成新页面：

```
 protected void Page_Load(object sender, EventArgs e)
    {
        Response.Write("<div data-role='page' id='garageList' data-add-back-btn='true' data-theme='a'>");
        Response.Write("<div data-role='header' data-position='fixed'>");
        Response.Write("<h1>Garages</h1>");
        Response.Write("<a href='index.html' data-icon='plus' data-iconpos='notext' class='ui-btn-right' data-theme='b'></a>");
        Response.Write("</div>");

        Response.Write("<div data-role='content'>");
        Response.Write("<ul data-role='listview' data-filter='true' data-filter-theme='a' data-filter-placeholder='search name or account no...' data-split-icon='info' data-split-theme='a'>");

        if (!string.IsNullOrEmpty(Request.QueryString["id"]))
        {
            Guid guid = Guid.Parse(Request.QueryString["id"]);
            using (DbContext db = new DbContext())
            {
                var f = db.Factors.Where(x => x.Guid == guid).SingleOrDefault();
                if (f != null)
                {
                    foreach (var g in f.Garages.OrderBy(x => x.Name))
                    {
                        Response.Write(String.Format("<li><a href='javascript:GetGarageDetails({0})'><h3>{1}</h3><p><strong>{2}</strong></p></a><a href='#' /></li>", g.Guid, g.Name, g.Town));
                    }
                }
            }
        }

        Response.Write("</ul>");
        Response.Write("</div>");
        Response.Write("</div>");
    } 
```

这工作得很好，但我注意到即使在页面转换之后，屏幕上也会留下一些以前页面的残余，这是通过删除页面中的所有默认 html 并只留下这一行来解决的：

```
<%@ Page Language="C#" AutoEventWireup="true" CodeBehind="GarageList.aspx.cs" Inherits="CP.GarageList" %> 
```

现在我面临的问题是我的移动设备上的页面超级慢。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-04-26T14:49:53.353

您需要刷新您的列表。例如）

```
$('Some DiV').listview('refresh'); 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2016-12-22T21:57:00.990

jquery mobile 对其他页面的调用是使用ajax 的，有时在加载样式和库时会导致失败。

当我使用重定向外部页面时，我使用`window.location.href`.

一种可能的解决方案是在文件头中正确排序链接和 javascript，例如：

```
<head>
<meta charset="utf-8" />
<meta name="format-detection" content="telephone=no" />
<meta name="msapplication-tap-highlight" content="no" />
<meta name="viewport" content="user-scalable=no, initial-scale=1, maximum-scale=1, minimum-scale=1, width=device-width" />
<link rel="stylesheet" href="jquery_mobile/jquery.mobile-1.4.5.min.css" />
<link rel="stylesheet" href="jquery_mobile/jquery.mobile.structure-1.4.5.min.css" />
<link rel="stylesheet" type="text/css" href="css/index.css" />
<script type="text/javascript" src="jquery_mobile/jquery-1.12.4.js"></script>
<script type="text/javascript" src="jquery_mobile/jquery.mobile-1.4.5.min.js"></script>
<title>my page</title></head> 
```

# c# - 使用 stringbuilder 将时间放入字符串（类）C#

> ID：10092113
> 
> 赞同：2
> 
> 时间：2012-04-10T15:54:05.397
> 
> 标签：c#, time, stringbuilder

```
 public string getTime()
   {
       StringBuilder RetString = new StringBuilder();
       RetString.Append(Hours.ToString().PadLeft(2, '0') + "-" + Min.ToString().PadLeft(2, '0') + "-" + AMPM.PadLeft(2, '0'));
       return RetString.ToString();
   } 
```

我正在尝试使用它将时间（以字符串格式）返回给表单字符串变量。我让用户设置输入时间并且时间存储在这个类中，我现在所做的就是将这些数据带到我正在工作的表单中。我已经验证数据正在进入类并存储在变量。

我得到的错误是：

![CSharp_Null](../Images/3c5ebc22902b0aa58cd9b5a131cfc470.png)

不太确定问题是什么。我当然声明了变量

```
 private int Hours;
    private int Min;
    private string AMPM; 
```

我有设置：

```
public int _hours
    {
        get
        {
            return Hours;
        }
        set
        {
            if (value <= 12 && value >= 1)
            {
                Hours = value;
            }
            else
                Hours = 0;
        }
    }

    public int _min
    {
        get
        {
            return Min;
        }
        set
        {
            if (value <= 59 && value >= 1)
            {
                Min = value;
            }
            else
                Min = 0;
        }
    }

    public string ampm
    {
        get
        {
            return AMPM;
        }
        set
        {
            if (AMPM == "AM" || AMPM == "PM")
            {
                AMPM = value;
            }
            else
                AMPM = "";
        }
    } 
```

和我对班级的呼吁：

```
string timefromclass;
timefromclass = timec.getTime(); 
```

我认为唯一可能是我打电话给我存储时间的班级是

```
C_Time time = new C_Time(); 
```

但在另一种形式中，我也设置了另一种形式。

```
C_Time timec = new C_Time(); 
```

可能我正在尝试从空实例中检索时间？

编辑：

```
public void setTime(int hours, int min, string aMPM)
    {
        Hours = hours;
        Min = min;
        AMPM = aMPM; 
```

那真的是我为该变量分配任何东西的唯一地方。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-10T15:56:32.577

您是否`AMPM`在代码中的某处进行了初始化。如果不是，它将为 null（引用类型变量的默认值）并且调用`PadLeft`它会给你一个 NRE。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-10T15:57:02.367

根据您的代码，我假设您的`AMPM`字段是`null`.

**除了您没有**在代码中调用的设置器之外，您似乎没有在任何地方实例化它。

初始化它应该可以解决问题：

```
private string AMPM = string.Empty; 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-10T16:15:32.920

您收到的错误意味着您正在尝试读取尚未初始化的“引用类型”，因此为**null**。

**int**是“值类型”，值类型不能表示空值。

**string**是一个“引用类型”，并且是您的类中唯一的引用类型 ( `AMPM`)。这一定是问题所在。

您将需要初始化`AMPM`以停止错误。如果您还没有，向您的类添加**构造函数**是处理初始化的好方法。例如：

```
public C_Time()
{
    AMPM = "";
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-04-10T16:20:05.373

正如其他人指出的那样`AMPM`是问题所在。你应该像这样定义它

```
private string _ampm;

public string AMPM
{
    get
    {
        return _ampm ?? ""; // Returns "" if _ampm == null
    }
    set
    {
        _ampm = value;
    }
} 
```

然后与物业合作

```
AMPM.PadLeft( ... 
```

* * *

但为什么不直接使用

```
String.Format("{0:00}-{1:00}-{2}", Hours, Min, AMPM.PadLeft(2, '0')); 
```

* * *

使用枚举会更安全

```
public enum AmPm
{
    Undefined,
    AM,
    PM
} 
```

这清楚地列举了有效的条目。否则，您可以输入诸如“下午”或“上午”之类的内容，而不是“上午”。

# python - Python 在循环列表中显示相同的值。

> ID：10092117
> 
> 赞同：-1
> 
> 时间：2012-04-10T15:54:10.750
> 
> 标签：python, django, django-templates, django-views

我确定我的问题措辞不正确，但是这里有……我在 Conference_list.html 中显示了一个会议列表以及参加者的数量。. 他们的标题显示得很好......但是，每次会议的参加者数量都是相同的。

```
Conference 1        Attendees 2
Conference 2        Attendees 2
Conference 3        Attendees 2 
Conference 4        Attendees 2 
```

会议 4 是唯一有 2 名与会者的会议。其他的金额不同。

视图.py：

```
@login_required
def conference_list(request):
    try:
        session_notification = request.session['notification']
        del(request.session['notification'])
    except:
        session_notification = None

    PAGE_SIZE = 20#number of conferences per page
    page = int(request.GET.get('page', 1))
    upper_bound = page * PAGE_SIZE - 1
    lower_bound = (page - 1) * PAGE_SIZE

    context = base_context(request)
    network = context['network']

    conferences = Conference.objects.all()
    second = []
    result = []
    counter = 0

    for conference in conferences:
        is_attending = False
        if counter < lower_bound or counter > upper_bound:
            counter += 1
            result.append(None)
            continue
        result_item = {}
        result_item['conference'] = conference
        result.append(result_item)
        counter += 1

        attendees = conference.investors.all()
        count = attendees.count()
        if request.user in attendees:
            is_attending = True

        context['attendees'] = attendees
        context['is_attending'] = is_attending
        context['count'] = count

    context['current'] = 'conferences'
    context['conferences'] = result

    return render_to_response('conference_list.html', context, context_instance=RequestContext(request)) 
```

模板：

```
{% for conference in conferences %}
     <p>{{ conference.conference.name }}</p><span>{{ count }}</span>
{% endfor %} 
```

为什么会这样？为什么我不能显示正确的金额？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-10T16:04:02.670

您的 count 变量仅保存最后一个值，因为您只需在视图中的循环的每次迭代中覆盖它。尝试`result_item['conferences']['count'] = count`移动`result.append(result_item)`它后面的线。相应地调整您的模板。

# hibernate - 尝试访问 Hibernate 实体时检票口“没有附加应用程序”

> ID：10092122
> 
> 赞同：1
> 
> 时间：2012-04-10T15:54:17.907
> 
> 标签：hibernate, wicket, jax-rs

我刚刚开始研究使用 Hibernate 的现有 Wicket 应用程序。我正在使用 JAX-RS 向 Hibernate 数据（在同一个 Web 应用程序中）添加一个 RESTful 接口。JAX-RS servlet 根本不与 Wicket 对话——它们独立地创建 Hibernate 会话。

我有一个类，`User`它使用以下类定义为 Hibernate 实体（也是 JAXB 可编组的）`net.databinder.auth.data`：

```
@Entity
@Table(name = "user")
@XmlAccessorType(XmlAccessType.PROPERTY)
@XmlRootElement
public class User extends AbstractEntity implements DataUser { 
```

一切正常，直到我尝试将密码设置（`BasicPassword`是一种可嵌入`net.databinder.auth.data`类型）添加到我的 RESTful 界面（直到现在，我一直忽略密码属性）：

```
@XmlTransient
public void setPassword(BasicPassword password) {
  this.password = password;
}

@XmlElement
public void setPassword(String password) {
  setPassword(new BasicPassword(password));
} 
```

突然，当 Apache CXF-JAXRS + Jackson + JAXB 尝试在 HTTP PUT 中对我传入的 JSON 用户对象进行 ummarshall 时，它调用`user.setPassword("...")`并且我收到以下错误：

```
WARN  - ApplicationExceptionMapper - WebApplicationException has been caught : There is no application attached to current thread "http-bio-8080"-exec-5 (through reference chain: com.example.entity.User["password"]) 
```

哇——Wicket 是从哪里来的？Apache CXF-JAXRS 应该调用 Jackson 提供程序，它使用 JAXB 注释来解组我传入的用户规范，创建一个未绑定的 Hibernate`User`对象，对吗？它尝试使用字符串设置密码，便捷方法将字符串转换为`BasicPassword`实例。据我所知，这一切都与 Wicket 无关。

为什么 Wicket 甚至会参与其中？此时我不需要或不需要 Wicket --- 我只需要创建一个新的分离的 Hibernate 对象。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-10T16:07:46.630

[`BasicPassword`](https://github.com/n8han/Databinder-for-Wicket/blob/master/databinder-auth-components-hib/src/main/java/net/databinder/auth/data/hib/BasicPassword.java)需要访问 Wicket 应用程序的授权设置才能计算密码哈希。我想你也需要传递这些请求`WicketFilter`。

# android - Android 链式动画

> ID：10092124
> 
> 赞同：11
> 
> 时间：2012-04-10T15:54:21.387
> 
> 标签：android

我试图将两个动画“链接”在一起，所以当一个完成时，另一个开始。除了一个问题外，这是可行的。第一个动画完成后，它会回到原来的位置。我将fill after设置为true。我还缺少什么？

这是我正在使用的代码。请注意，这是在扩展 LinearLayout 的类中。

```
// FIRST ANIMATION
mAnimation = new TranslateAnimation(0, PANEL_END_X, 0, 0);
mAnimation.setDuration(PANEL_TRANSITION_TIME);
mAnimation.setFillAfter(true);

mAnimation.setAnimationListener(new Animation.AnimationListener() {
    public void onAnimationEnd(Animation animation) {

        // FIRST ANIMATION COMPLETE, CALL THE SECOND ANIMATION
        startAnimation(mAlphaAnimation);
    }
});

// SECOND ANIMATION     
mAlphaAnimation = new AlphaAnimation(1.0f, 0.0f);
mAlphaAnimation.setDuration(PANEL_ALPHA_TRANSITION_TIME);
mAlphaAnimation.setFillAfter(true); 
```

解决方案：

让我满意的唯一方法是使用`AnimationSet`，但将第二个动画的起始偏移设置为开始偏移 + 第一个动画的持续时间，再加上一点填充。在我的情况下，它们不必完全准确。

我尝试按照 CommonsWare 的建议使用各种值，但我总是会得到某种类型的“捕捉”效果，在采用新值之前，这些值会恢复到其原始值。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-04-11T23:40:41.947

[我使用AnimationSet.Builder](http://developer.android.com/reference/android/animation/AnimatorSet.Builder.html)类找到了我认为是 API 级别 11 及更高级别的理想解决方案。

> Builder 对象是一个实用程序类，用于方便将动画以及各种动画之间的关系添加到 AnimatorSet。Builder 方法以及 AnimatorSet 的 play() 方法的目的是使以自然的方式表达动画的依赖关系成为可能。如果需要，开发人员还可以使用 playTogether() 和 playSequentially() 方法，但在某些情况下，成对表示动画的 AnimatorSet 可能更容易
> 
> 例如，这设置了一个 AnimatorSet 来同时播放 anim1 和 anim2，anim3 在 anim2 结束时播放，anim4 在 anim3 结束时播放：

```
AnimatorSet s = new AnimatorSet();
s.play(anim1).with(anim2);
s.play(anim2).before(anim3);
s.play(anim4).after(anim3); 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-04-10T16:04:35.970

> 第一个动画完成后，它会回到原来的位置。我将fill after设置为true。我还缺少什么？

动画是瞬态效果。如果您希望效果是永久性的，您必须自己在`onAnimationEnd()`. 在 a 的情况下`TranslateAnimation`，您需要更改`LayoutParams`受影响的小部件的 or 东西以将其永久保持在其结束位置。或者，如果您要将其翻译到屏幕外，请将可见性设置为`View.GONE`。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-04-10T15:58:41.290

尝试将它们组合成一个`AnimationSet`.

# iphone - 自定义字体不起作用

> ID：10092126
> 
> 赞同：1
> 
> 时间：2012-04-10T15:54:35.817
> 
> 标签：iphone, objective-c, xcode, ipad, ios5

我花了很长时间寻找许多解决方案，但无济于事。我使用了以下方法，但仍然卡住：[自定义字体在我的应用程序中不起作用？](https://stackoverflow.com/questions/9534766/custom-font-is-not-working-in-my-app)

我目前正在尝试使用名为“DFPGyoSho-Lt”的字体系列在我的字体书中，该系列下只有一种字体名为“Regular”

这是我采取的步骤：

*   成功将字体“DFPGyoSho-Lt.ttf”添加到我的项目中，并在plist中处理。
*   使用 [UIFont familynames] 成功获取了姓氏。
*   使用 [UIFont fontNamesForFamilyName] 方法找到字体的实际名称，即：“DFGyoSho-Lt-MP-RKSJ-H”
*   使用 [UIFont fontWithName...] 在 UILabel 中显示字体。但是，字体显示不正确。

当我单击 ttf 文件时，字体本身在 XCode 中正确显示，因此 XCode 似乎能够读取它。不幸的是，我似乎无法正确访问文件或其他东西。

此外，我确实有其他已在同一项目中成功使用的自定义字体（otf 格式）。只有这种特殊的字体我才有困难。

感谢你的帮助！谢谢！

* * *

**更新：** 其他人向我传递了一组类似（如果不相同）的字体，这些字体效果很好。

所以我认为我最初使用的字体一定已经损坏了。奇怪的是，当我将它与 Open Office 等其他程序一起使用时，该字体仍在字体册中成功显示。

故事的寓意：如果自定义字体的一组代码正在工作，而特定字体不起作用，那么故障很可能在于该特定字体。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-09T11:24:20.793

我认为您的字体名称是正确的。

特定字体不起作用，但字体名称可能与字体文件名不同，您可以打开字体文件进行检查或查看此[链接](http://codefriends.blogspot.in/2012/04/adding-custom-font-in-xcode.html)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-11T08:47:12.523

更新：其他人向我传递了一组类似（如果不相同）的字体，这些字体效果很好。

所以我认为我最初使用的字体一定已经损坏了。奇怪的是，当我将它与 Open Office 等其他程序一起使用时，该字体仍在字体册中成功显示。

故事的寓意：如果自定义字体的一组代码正在工作，而特定字体不起作用，那么故障很可能在于该特定字体。

# c++ - 多态，为什么我不能这样做？

> ID：10092130
> 
> 赞同：4
> 
> 时间：2012-04-10T15:54:50.580
> 
> 标签：c++, oop, templates, polymorphism

```
class BaseA
{
}

class B : public BaseA
{
}

template <class T>
class C : public vector<T>
{
}

void someFunction (void)
{
    C<B> myClass;

    // I can't seem to do this...is it not possible?
    vector<BaseA> converted = ((vector<BaseA>) myClass);
} 
```

请参阅代码中的注释以了解我正在尝试做的事情。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-04-10T15:58:11.637

即使 B 是 A，B 的向量也不是 A 的向量（我假设 A 和 BaseA 之间存在混淆）

尝试

```
vector<A> converted(myClass.begin(), myClass.end()); 
```

这可能是你想要表达的。

（顺便说一句，从 vector 继承[通常是个坏主意](https://stackoverflow.com/q/6806173/136208)，它不是为此而设计的。）

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-10T15:58:39.280

`C<B>`并且`vector<A>`是完全不相关的类型，您必须明确定义这样的转换（例如`template <typename TargetValueType> explicit operator vector<TargetValueType> () { ... }`）。

如果这种转换是一项不常见的任务，这对于您的类的性质来说并不是很自然，那么最好使用范围构造函数（参见 AProgrammer 的答案）。

另外：如果`vector`是`std::vector`，从它派生不是一个好主意。它没有被定义为基类，通常你应该更喜欢包含而不是派生（因为它对你的客户端施加了更松散的耦合）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-10T15:57:56.520

没办法没办法。想象一下，如果你有另一个类，`X`，派生自`BaseA`。如果你能得到你的`converted`对象，你可以在其中插入实例`X`，即使原始对象不允许它。您将破坏变量的语义。

顺便说一句，您*可以*在没有真正意义上的泛型的 Java 中执行此操作，但在 C# 或 C++ 等强类型泛型语言中您将无法执行此操作（C# 中的一个例外，但您不应该使用无论如何，在这种情况下）。

# android - BroadcastReceiver、IntentService 和 GPS 回调

> ID：10092131
> 
> 赞同：1
> 
> 时间：2012-04-10T15:54:53.260
> 
> 标签：android, callback, gps, broadcastreceiver, intentservice

我正在使用 BroadcastReceiver，需要根据传入的 SMS 消息找到手机的 GPS 位置。

我正在使用一个非常标准的类，它在回调中返回 LocationResult 但如果我在 BroadcastReceiver 类中使用它，那么它可能需要很长时间并被操作系统杀死。

我试过使用服务，但如果两个事件同时发生，它会导致 ANR 问题。

我听说在 BroadcastReceiver 中使用线程是灾难的根源，所以甚至没有尝试过。

我现在使用 IntentService 对传入请求进行排队并处理 GPS 位置查找器。我的问题是如何使用带有回调的代码，以便在 onHandleIntent 完成时它不会死？我考虑过使用睡眠，但它似乎不是一个完美的解决方案。

有一个更好的方法吗？我必须使用广播接收器，但需要一种聪明的方法让 GPS 在 15-20 秒内找到位置。

任何想法将不胜感激！（这里是安卓菜鸟）。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-10T16:02:44.193

> 我试过使用服务，但如果两个事件同时发生，它会导致 ANR 问题。

这意味着您正在主应用程序线程上工作，这是您一直想要避免的事情，包括在服务中。请记住，`onStartCommand()`在主应用程序线程上调用类似的方法。

> 我的问题是如何使用带有回调的代码，以便在 onHandleIntent 完成时它不会死？

这就是为什么`IntentService`不是您的问题的好答案。您需要一个常规的`Service`，但您在自己的后台线程中工作的一个，完成后停止服务等。

我有一个以[`LocationPoller`](https://github.com/commonsguy/cwac-locpoll).

# ember.js - emberjs 车把模板中 bindAttr 的未绑定版本

> ID：10092136
> 
> 赞同：17
> 
> 时间：2012-04-10T15:55:01.493
> 
> 标签：ember.js, handlebars.js

在不需要绑定的情况下，我们可以使用`{{unbound someProperty}}`，但是有没有办法通过标签属性达到相同的效果？据我了解，我们唯一的选择是`bindAttr`：

```
<img {{bindAttr src="thumbpath"}} /> 
```

假设屏幕上有 100 多幅图像，并且（整个布局——不仅仅是图像）有点频繁地重新渲染，那么在未绑定的版本中会有任何性能优势吗？

* * *

## 回答 #1

> 赞同：39
> 
> 时间：2012-04-10T16:10:15.163

因为 Ember 不需要跟踪未绑定的值，您实际上可以这样做：

```
<img src="{{unbound thumbpath}}" /> 
```

是的，使用未绑定的值有性能优势。

# jquery - 最后显示 div 顶部的 slideUp

> ID：10092141
> 
> 赞同：3
> 
> 时间：2012-04-10T15:55:20.593
> 
> 标签：jquery, html, css, slide

jQuery`slideDown`和`slideUp`函数非常方便，但我需要稍微改变它们的行为。

**它能做什么**

当您调用`slideDown`a时，通常会发生`div`div 向下滑动，并且随着它进一步向下滑动，显示较低的内容`div`。

**我需要它做什么**

我希望`div`向下滑动，但不应显示 的下部内容，而`div`应显示上部内容。所以最底部的内容应该首先可见，然后上面的内容应该滑入视图。这样做的目的是让它`div`看起来像是从屏幕外滑到屏幕上的。这是一个图表：

```
How it works now:
----------
| Line 1 | |  Reveals from top to bottom; top is anchored in place
| Line 2 | |  As the div expands vertically, Line 1 is shown first and
| Line 3 | |  none of the lines move as they become visible.
********** V
| Line 4 | 
| Line 5 |
----------

How I would like it to work:
----------
| Line 1 |    
| Line 2 |    
| Line 3 |    
********** ^  Reveals from bottom to top; bottom is anchored in place
| Line 4 | |  As the div expands vertically, the Line 5 is shown first and
| Line 5 | |  moves downward as more is revealed.
---------- 
```

我意识到我可能无法有效地沟通，如果您需要更多说明，请告诉我。

**更新：**

这是与我正在使用的 HTML 等效的 HTML：

```
<div id="anchored">
    <table>
        <tr>
            <td>
                <!-- this is the div that is initially invisible and should slide from the bottom -->
                <div id="slider">
                    hello
                </div>
            </td>
        </tr>
        <tr>
            <td>
            <!-- this is always visible and should be pushed down by "slider" as it moves downward -->
            hello 
            </td>
        </tr>
    </table>
</div> 
```

CSS：

```
#anchored {
    position: fixed;
    top: 0px;
}

#slider {
    display: none;
}

table {
    width: 100%;
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-10T16:22:12.857

我建议类似于以下内容，但鉴于您没有显示您的 HTML，这只能是一个建议（而不是一个具体的答案，但如果您发布您的实际 HTML，那么我可以尝试提供一些可以服务的东西更好的）：

```
var container = $('#slide'),
    p = container.find('p');

container.height(p.height());
$(p).css({
    'position' : 'absolute',
    'top' : -p.height()
}).animate({
    'top' : 0
},2500); 
```

[JS 小提琴演示](http://jsfiddle.net/davidThomas/x7SH8/1/)。

HTML：

```
<div id="slide">
<p><!-- contents... --></p>
</div>​ 
```

CSS：

```
#slide {
    border: 1px solid #000;
    position: relative;
    overflow: hidden;
}​ 
```

参考：

1.  jQuery：

    *   [`animate()`](http://api.jquery.com/animate/).
    *   [`css()`](http://api.jquery.com/css/).
2.  CSS：

    *   [`overflow`](https://developer.mozilla.org/en/CSS/overflow).
    *   [`position`](https://developer.mozilla.org/en/CSS/position).

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-10T16:08:31.630

jQuery 可以做你想做的事，我认为有一个 slideDown 方法的选项来处理这个会很棒。无论如何，你可以这样做：

```
$('div').show("slide", { direction: "up" }, 1000); 
```

[在jsfiddle](http://jsfiddle.net/x7SH8/)上查看它的实际效果（使用 jQuery UI）。受[JQuery 启发：如何执行“推”幻灯片，而不是向上滑动？](https://stackoverflow.com/questions/2701770/jquery-how-to-perform-a-push-slide-not-a-slide-up)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-10T16:10:38.713

当然，您也可以这样做并使用 .slideDown() 。您只需要将要使用 .slideDown 的项目包装在相对定位的元素（例如 div）中，然后将元素上的定位设置为绝对，然后通过设置将其绑定到父元素的底部CSS底部属性为零。

这是一个**[jsFiddle 示例](http://jsfiddle.net/j08691/2Xzb2/)**。

HTML：

```
<div id="container">
    <div id="foo">
    <ul>
        <li>1</li>
        <li>2</li>
        <li>3</li>
        <li>4</li>
        <li>5</li>
    </ul>
    </div>
</div>​ 
```

CSS：

```
#foo{
    border:1px solid #999;
    float:left;
    position:absolute;
    bottom:0;
}
#container {
    position:relative;
    height:200px;
} 
```

​ jQuery：

```
$('#foo').hide().slideDown(3000);​ 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-10T16:04:19.727

一个快速的想法（我不知道这是否有效；我稍后会测试）：也许您可以将文本放入一个高度恒定的 div 中。用另一个 div 包裹它，这是您向下和向上滑动的那个。使用位置：相对（或绝对）和底部：0 将恒定高度 div 附加到包装器的底部。使用溢出：隐藏在包装器中，整个事情可能会起作用。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-04-10T22:03:37.890

我最终结合使用 Armatus 和 tea_totaler 的答案让它工作，你可以在这里看到它：http: [//jsfiddle.net/Cg4yN/](http://jsfiddle.net/Cg4yN/)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-04-10T16:02:36.937

slideDown 和 slideUp 无济于事。您将无法解决问题。将可扩展块包装在一些虚拟父 div 中并将其溢出设置为隐藏。然后将您的可扩展块放置在该虚拟父级内，以便仅可见 5h 项。

当您希望更改 div 的状态时，首先将父虚拟 div 的高度设置为等于其子级，然后使用 animate() 将 div 的顶部位置属性设置为 0。

如果你能给我 jsFiddle 上的 HTML 标记和 CSS 代码，我可以帮你。

# jquery - 使用模态打开轮播

> ID：10092145
> 
> 赞同：0
> 
> 时间：2012-04-10T15:55:39.717
> 
> 标签：jquery, modal-dialog, carousel

我正在寻找创建一个模态轮播，并且真的很喜欢这个网站上使用的那个

[http://activatedrinks.com/#/products](http://activatedrinks.com/#/products)

但无法弄清楚如何打开模态并使下一个内联内容略微可见。

谢谢

# varnish - 清漆不处理 ESI 包括

> ID：10092146
> 
> 赞同：1
> 
> 时间：2012-04-10T15:56:02.553
> 
> 标签：varnish, varnish-vcl, esi

我正在尝试设置 Varnish 以处理本地环境中的 ESI 包含。

我在虚拟机中运行清漆，内容在主机上运行。

我有两个文件“index.html”和“test.html”。它们都存储在 apache 服务器的 docroot 中名为“esi”的文件夹中。

**索引.html**

```
<h1>It Works!</h1>
<esi:include src="test.html" /> 
```

**测试.html**

```
<p>ESI HAS BEEN INCLUDED</p> 
```

Varnish 在虚拟机的 8000 端口上运行。所以我在这里访问它：http: [//192.168.56.101 :8000/esi/](http://192.168.56.101:8000/esi/)

在虚拟机上的 /etc/varnish/default.vcl 中，我已将以下配置添加到文件底部：

```
sub vcl_fetch {
   set beresp.do_esi = true; /* Do ESI processing               */
   set beresp.ttl = 24 h;    /* Sets the TTL on the HTML above  */
} 
```

考虑到它应该处理所有请求的 ESI（不要关心它是否只是试图让这个东西工作的不好的做法:)）

我加载[http://192.168.56.101:8000/esi/](http://192.168.56.101:8000/esi/)时的结果是：

```
<h1>It Works!</h1>
<esi:include src="test.html" /> 
```

IE。ESI 显示在标记中，它没有被处理。

我检查了 Varnish 日志，但是那里没有错误，也没有与 ESI 相关的内容。

谁能看到我在这里做错了什么？让我知道是否需要更多信息..谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2014-08-21T08:49:28.977

对于 ESI 作品（varnish 3.x），第一个字符必须是“<”，因此只需添加 HTML 结构

这是我的测试：

**索引.php**

```
<html>
<head>
    <title></title>
</head>
<body>
<?php

    $now = new \DateTime('now');
    echo "hello world from index.php ".$now->format('Y-m-d H:i:s');
?>

<br/>

<esi:include src="/date.php"/>

<br/>

<esi:remove>
    ESI NOT AVAILABLE
</esi:remove>

<br/>

<!--esi
ESI AVAILABLE !!

-->
</body>
</html> 
```

**日期.php**

```
<?php
$now = new \DateTime('now');
echo "hello world from date.php ".$now->format('Y-m-d H:i:s'); 
```

**输出 ：**

```
hello world from index.php 2014-08-21 10:45:29
hello world from date.php 2014-08-21 10:46:35 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-04-25T19:26:18.630

Varnish 只实现了 ESI 的一小部分。从 2.1 开始，三个 ESI 声明：

```
 esi:include
    esi:remove
    <!--esi ...--> 
```

基于变量和 cookie 的内容替换尚未实现，但已在路线图上。Varnish 不会处理 HTML 注释中的 ESI 指令。要使 ESI 工作，您需要在 VCL 中激活 ESI 处理，如下所示：

```
sub vcl_fetch {
if (req.url == "/index.html") {
   set beresp.do_esi = true; /* Do ESI processing               */
   set beresp.ttl = 24 h;    /* Sets the TTL on the HTML above  */
} elseif (req.url == "/test.html") {
   set beresp.ttl = 1m;      /* Sets a one minute TTL on        */
                             /*  the included object            */
} 
```

}

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-21T19:54:56.983

如果您的 esi include src 是“test.html”，那么 varnish 会将该请求发送到您的默认后端，即 127.0.0.1。我相信您需要为远程服务器配置第二个后端。像这样的东西：

```
backend default {
    .host = "127.0.0.1";
    .port = "8000";
}

backend hostmachine {
    .host = "50.18.104.129"; # Enter your IP address here
    .port = "80";
} 
```

然后在您的 sub vcl_recv 中，您需要将 URL 中包含 /esi/ 的流量重定向到远程服务器。

```
sub vcl_recv {
      if (req.url ~ "^/esi/") {
            set req.backend = hostmachine;
            set req.http.host = "www.correctdomainname.com";
      } else {
            set req.backend = default;
      }
} 
```

我现在正在做同样的事情，所以试一试，让我知道它是否适合你。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2019-01-04T10:20:45.797

确保您的配置被清漆读取。如果您在 docker 容器中运行 varnish，则可能需要重新构建它。

您可以将您的配置更改为一些荒谬的东西，看看它是否能捕捉到它。例如将后端更改为 w3.org。

如果这仍然给你相同的结果，你的配置没有被使用。

# android - 添加到手机主屏幕

> ID：10092152
> 
> 赞同：3
> 
> 时间：2012-04-10T15:56:17.160
> 
> 标签：android, iphone, ios, mobile, iphone-standalone-web-app

我如何编写一个按钮来制作手机的快捷方式，尤其是在 iPhone 和 Android 上。

我使用样板作为框架，因此它会自动将其添加到 head section`<link rel="shortcut icon" href="img/l/apple-touch-icon.png">`中。我认为这将是我要使用的默认图标。

现在我的 html 中有一个按钮，设置如下

```
<a href="#"><img src="img/button-shortcut.jpg" /></a> 
```

我不知道该放什么，`href`或者我应该使用 javascript 来实现它。我也不确定什么是正确的术语，我只是猜测它被称为“快捷方式”

我想要实现的是，我有一个简单的网络应用程序（纯 html），我有一个按钮可以在他们的主屏幕上添加快捷方式/图标。这样他们就可以更轻松地访问我的网站/网络应用程序。我的目标设备主要是 iphone 和 android。

有人可以启发我吗？

谢谢！

![在此处输入图像描述](../Images/2ca34c5ae6c06009c21bc61bc52b4a1b.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-10T15:59:55.113

您无法在 iOS 上为此功能创建快捷链接，我也不知道在 Android 上的方法。iOS 用户必须使用 Safari 工具栏向主屏幕添加内容。

一些网站使用 JavaScript 向用户显示一个小弹出窗口，如下所示：

![](../Images/50c9cc12e7503f8bd1138a575b5dca2f.png)

# tridion - 如何使用 SDL Tridion TOM.NET API 获取页面或组件的发布时间戳

> ID：10092156
> 
> 赞同：5
> 
> 时间：2012-04-10T15:56:26.227
> 
> 标签：tridion

我正在尝试使用 TOM.NET API 将给定页面或组件的已发布时间戳保存到给定目标。`Page`在or对象下不是很明显`Component`，有人可以指出我正确的方向吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-04-10T16:12:25.263

您可以为此使用该`PublishEngine.GetPublishInfo(IdentifiableObject)`方法，它返回一个`PublishInfo`对象集合，其中包含可用于给定项目的日期和其他（发布）信息。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-10T16:47:59.120

感谢 Bart 在上面的回答，我敲出了以下粗略的代码。这与性能无关，因为这是向客户演示某些东西的概念证明：

```
// if we are in publishing mode, figure out the target we are publishing to, and get the timestamp that the page is published to this target
if (engine.PublishingContext.PublicationTarget != null)
{
  ICollection<PublishInfo> publishCollections = PublishEngine.GetPublishInfo(childPage);
  foreach (PublishInfo publishInfo in publishCollections)
  {
     if (publishInfo.PublicationTarget == engine.PublishingContext.PublicationTarget)
     {
        pageElem.SetAttribute("timestamp", publishInfo.PublishedAt.ToString());
     }
   }
} 
```

在这里您可以看到我已经有了我的`childPage`对象，并且我正在将结果添加到现有页面 XML 对象 ( `pageElem.SetAttribute("timestamp", publishInfo.PublishedAt.ToString())`) - 因此，如果使用此代码段，请注意这些项目 :)

# c# - 如果输入的地址不可用，是否可以将浏览器自动重定向到指定的网站？

> ID：10092161
> 
> 赞同：-1
> 
> 时间：2012-04-10T15:56:45.007
> 
> 标签：c#, .net

我要做的是更改默认的 google chrome / firefox / iexplore 页面，该页面显示当输入了一些不正确的网址时该站点不可用：

![在此处输入图像描述](../Images/a2e1c53de8363a7a8bab53f37b2b8e67.png)

因此，它不会显示上面的页面，而是显示一些网站，例如[http://www.google.com](http://www.google.com)

如何为 Google Chrome、Mozilla Firefox 和 Internet Explorer 执行此操作？这些默认网页存储在哪里以及如何更改它们.. 提前谢谢你

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-10T16:24:29.677

回答你提出的问题：不。

由于`DNS`服务器通常会重定向无法解析的请求，因此您需要`winforms`在 DNS 服务器本身上运行您的应用程序才能更改重定向。

现在提供一些其他选择：

*   尝试制作一个重定向到 404 的浏览器扩展
*   尝试制作一个以编程方式将其更改为不同的 winforms 应用程序`DNS`（例如带有自定义 404 页面的 opendns）

或者，如果您需要做的只是更改为具有自定义 404 的 DNS，也许只需查看 Open DNS。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-10T16:15:05.467

如果您编写自己的浏览器，您可以在返回 404 错误时显示您想要的任何内容。据我所知，chrome/ie/firefox 不允许您自定义此错误页面，正如其他人所说，您需要访问 DNS 服务器才能在使用任何浏览器时更改此设置。

# c# - PropertyGrid 没有注意到代码中的属性发生了变化？

> ID：10092162
> 
> 赞同：12
> 
> 时间：2012-04-10T15:56:47.113
> 
> 标签：c#, winforms, data-binding, inotifypropertychanged, propertygrid

我有一个 Winform 应用程序，它使用颜色来突出显示某些内容。我想允许用户更改“他们的”颜色。作为一个练习，我想我会创建一个具有颜色属性的类的实例，并将其分配给一个属性网格*（以获得一个不错的编辑器）*。

这似乎工作正常，但我想我想让用户重置颜色*（在他们摆弄并将它们设置为 20 种米色之后）*。因此，我在表单中添加了一个“重置”按钮，它将对象的颜色属性设置回默认值。

但是，似乎虽然它设置了我的对象的属性，但属性网格并没有改变。如果在重置后，我做了一个属性网格“刷新”，它具有重置颜色。

我假设属性网格不知道基础对象已更改？

在这种情况下是否缺少某些东西，或者我应该接受它并在重置对象时调用 Refresh 方法？

谢谢

*[（这里](https://stackoverflow.com/questions/3120496/updating-a-propertygrid)非常相似的问题）*

```
public partial class Form1 : Form
{
  public Form1()
  {
     InitializeComponent();

     this.propertyGrid1.SelectedObject = new Colours();
  }

  private void button1_Click(object sender, EventArgs e)
  {
     Colours colours = this.propertyGrid1.SelectedObject as Colours;
     colours.Reset();
  }
}

public partial class Colours : INotifyPropertyChanged 
{
  public event PropertyChangedEventHandler PropertyChanged;

  public Color ColourP1 { get; set; }

  public void Reset()
  {
     this.ColourP1 = Color.Red;
     var handler = this.PropertyChanged;
     if (handler != null) handler(this, new PropertyChangedEventArgs("ColourP1"));
  }
} 
```

* * *

继我对*“没有订阅 INotifyPropertyChanged.PropertyChanged”*的评论之后，继承 PropertyGrid 控件的缺点是什么？

```
public partial class MyPropertyGrid : System.Windows.Forms.PropertyGrid
{
  private INotifyPropertyChanged _selectedObject;

  protected override void OnSelectedObjectsChanged(EventArgs e)
  {
     base.OnSelectedObjectsChanged(e);

     if (_selectedObject != null) _selectedObject.PropertyChanged -= selectedObject_PropertyChanged;
     _selectedObject = this.SelectedObject as INotifyPropertyChanged;
     if (_selectedObject != null) _selectedObject.PropertyChanged += selectedObject_PropertyChanged;
  }

  private void selectedObject_PropertyChanged(object sender, PropertyChangedEventArgs e)
  {
     this.Refresh();
  }
} 
```

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-04-12T19:08:42.203

为了回答您关于 PropertyGrid 为何不改变的问题，PropertyGrid 的 MSDN 文档[这样](http://msdn.microsoft.com/en-us/library/x495ht92.aspx)说：

> 网格中显示的信息是分配对象时属性的快照。如果 SelectedObject 指定的对象的属性值在运行时在代码中发生更改，则在网格中执行导致网格刷新的操作之前，不会显示新值。

因此，PropertyGrid 似乎不是可自动更新的控件。我认为这方面的线索是 PropertyGrid 使用`SelectedObject`方法而不是`DataSource`方法，而后者意味着它可能会监听 INotifyPropertyChanged。

您将得到 LarsTech 的建议并手动刷新网格。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2012-04-10T16:27:49.640

只需尝试刷新它：

```
private void button1_Click(object sender, EventArgs e)
{
  Colours colours = this.propertyGrid1.SelectedObject as Colours;
  colours.Reset();
  this.propertyGrid1.Refresh();
} 
```

假设您将拥有更多属性，则可以使用您的`PropertyChanged`事件。我会像这样修改你的 Color 类：

```
public class Colours : INotifyPropertyChanged {
  public event PropertyChangedEventHandler PropertyChanged;

  private Color _ColourP1;

  public void Reset() {
    this.ColourP1 = Color.Red;
  }

  private void OnChanged(string propName) {
    if (PropertyChanged != null)
      PropertyChanged(this, new PropertyChangedEventArgs(propName));
  }

  public Color ColourP1 {
    get { return _ColourP1; }
    set {
      _ColourP1 = value;
      OnChanged("ColourP1");
    }
  }
} 
```

然后你的表格看起来像这样：

```
public Form1() {
  InitializeComponent();

  Colours colours = new Colours();
  colours.PropertyChanged += colours_PropertyChanged;
  this.propertyGrid1.SelectedObject = colours;
}

private void colours_PropertyChanged(object sender, PropertyChangedEventArgs e) {
  this.propertyGrid1.Refresh();
}

private void button1_Click(object sender, EventArgs e) {
  ((Colours)this.propertyGrid1.SelectedObject).Reset();
} 
```

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2016-10-26T15:06:40.950

在试图记住我曾经使用过的东西并认为它可能对其他人有用的过程中发生了这个问题。

您可以使用 [RefreshProperties] 属性触发对属性网格的更新。

例如：

```
 [RefreshProperties(RefreshProperties.All)]
    public int MyProperty{ get; set; } 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2019-08-24T15:07:03.777

使用**DotNetBar AdvPropertyGrid 控件**。你不需要任何`iNotify`调用来更新它。
每当任何对象属性更改时，它都会自动更新网格。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2021-08-30T21:59:45.663

在 .Net 4.7.2 项目中，我发现调用`yourPropGridInstanceHere.ExpandAllGridItems()`会导致属性网格根据当前的“SelectedObject”刷新其值。

请注意，无需调用 collapse 方法即可发生这种情况。

当然，如果您折叠了某些类别，这可能对您不起作用，但至少在更简单的情况下，它可以避免必须实施`INotifyPropertChanged`或必须不断更新`SelectedObject`属性。

我还没有用任何其他 .Net 版本对此进行测试，但我怀疑它适用于所有版本。

# c# - 如何按单词而不是字符选择文本？

> ID：10092164
> 
> 赞同：-4
> 
> 时间：2012-04-10T15:56:58.950
> 
> 标签：c#, wpf

我想将文本选择粒度更改为单词。

例如，如果我们有文本**“我是你的父亲卢克”**

无法选择**“你的胖子”**，而是选择**“你的父亲”**。

我尝试更改 TextSelection 行为但没有成功。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-10T16:03:36.297

你总是可以通过空格分割你的字符串：

```
string[] words = s.Split(' '); 
```

并在您从中获得的数组上执行您想要的操作（例如搜索）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-10T16:04:40.137

我认为您想将[AutoWordSelection](http://msdn.microsoft.com/en-us/library/system.windows.controls.primitives.textboxbase.autowordselection.aspx)属性设置为 true。你试过这个吗？

# java - java - 如何检测Java中FileCopying中的读取错误？

> ID：10092167
> 
> 赞同：1
> 
> 时间：2012-04-10T15:57:03.087
> 
> 标签：java, fileinputstream, fileoutputstream, file-copying

我是 Java 新手。`FileInputStream`我尝试使用基本的and`FileOutputStream`和`bufferedInputStream`and来做一个文件复印机应用程序`bufferedOutputStream`。我使用进度条来显示进度并且它有效。一切都很好。我添加了catch子句`FileNotFoundException`来报告错误。同样，当我尝试从损坏的磁盘复制文件时，它复制到一定程度并静止不动。如何检测`read errors`. 有catch条款吗？请帮我。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-10T16:09:39.453

对此没有真正的解决方案。Java 依赖操作系统来进行低级文件 I/O。如果操作系统在重试读取损坏的文件时决定冻结很长时间，那么 Java 应用程序对此无能为力。

> 如何检测读取错误。有catch条款吗？

如果 / 当`read`操作最终失败时，您将获得某种 IOException。但是为异常添加一个 catch 不会做任何事情来解除停滞的读取请求。

从损坏的磁盘中恢复数据不是您应该在 Java 中尝试做的事情。您需要编写一个可以在磁盘块级别访问磁盘设备的本机应用程序。或者更好的是，使用现有的数据恢复工具。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-10T16:15:14.237

当你对你的和对象（resp.）做你的`read()`和`write()`声明时，如果从文件系统读取或写入文件系统时出现问题，则可能会从本机部分出现。您可以像捕获 一样的方式捕获它，并查看其消息以获取有关特定错误的更多信息。`FileInputStream``FileOutputStream``IOException``FileNotFoundException`

# .net - 如何获取相关表的父级和唯一的第一个子级

> ID：10092173
> 
> 赞同：0
> 
> 时间：2012-04-10T15:57:33.477
> 
> 标签：.net, sql, linq, c#-4.0, entity-framework-4

我有这 3 张桌子：

Process、Action 和 Process_Actions（多对多，它注册了一个**Process可以执行的所有****Action**。基本上，这个表有 Process_Id、Action_Id 和一个唯一的 ID（用于排序）。

 **我想要的是一个 LINQ 查询来获取所有**进程**的列表并只获取最后一个**操作**（按日期排序）

这是我的工作 SQL 查询：

```
SELECT P.Id, P.Name, PA.Action_Id FROM Process P
    JOIN Process_Actions PA ON P.Id = PA.Process_Id 
    WHERE PA.Id IN (SELECT MAX (PA.Id) FROM Process_Actions INNER JOIN Process_Actions PA ON P.Id = PA.Process_Id) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-10T17:25:12.337

试试这个：

```
context.Processes.Select(p => new { Process = p,
    LastAction = p.Actions.OrderbyDescending(a => a.Date).FirstOrDefault() } ) 
```

假设`Action`有一个属性`Date`（正如你所说*的按 date 排序*）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-10T16:19:28.630

我会尝试这样的事情

```
var maxId = (from pa in context.Process_Actions 
join pa on pa.Id = pa.Process_Id)
select (int?)pa.Id).Max();

var query = from p in context.Process
join pa in context.Process_Actions on p.Id equals pa.Process_Id
where maxId.Contains(pa.Id)
select new
{
    p.Id, 
    p.Name, 
    pa.Action_Id
} 
```**

# django - Django: TypeError: 'str' object is not callable, referer: http://xxx

> ID：10092174
> 
> 赞同：0
> 
> 时间：2012-04-10T15:57:38.170
> 
> 标签：django, apache, mod-wsgi, internal-server-error

我一直想知道为什么当我设置我的 django 项目 'arvindemo' debug = False 的 settings.py 并使用 mod_wsgi 在 Apache 上部署它时，我得到了 500 Internal Server Error。

环境：Django 1.4.0 Python 2.7.2 mod_wsgi 2.8 OS centOS

回顾一下： 访问首页，进入子页面A/B/C/D，填写一些表格，然后提交给Apache服务器。单击“提交”按钮后，我将收到“500 内部服务器错误”，以及下面列出的 error_log（Traceback）：

“对不起，我放错了Trackback，这里应该列出真正的Traceback”：PS：“STACKOVERFLOW DON'T LET ME PUT MORE THAN 2 hyperlinks”=“http://58.215.177.34/Presentation”

```
[Tue Apr 10 11:03:15 2012] [error] [client 122.198.133.250] mod_wsgi (pid=2973): Exception occurred processing WSGI script '/opt/web/django/wsgi/django.wsgi'., referer: STACKOVERFLOW DON'T LET ME PUT MORE THAN 2 hyperlinks
[Tue Apr 10 11:03:15 2012] [error] [client 122.198.133.250] Traceback (most recent call last):, referer: STACKOVERFLOW DON'T LET ME PUT MORE THAN 2 hyperlinks
[Tue Apr 10 11:03:15 2012] [error] [client 122.198.133.250]   File "/opt/python2.7/lib/python2.7/site-packages/django/core/handlers/wsgi.py", line 241, in __call__, referer: STACKOVERFLOW DON'T LET ME PUT MORE THAN 2 hyperlinks
[Tue Apr 10 11:03:15 2012] [error] [client 122.198.133.250]     response = self.get_response(request), referer: STACKOVERFLOW DON'T LET ME PUT MORE THAN 2 URLs
[Tue Apr 10 11:03:15 2012] [error] [client 122.198.133.250]   File "/opt/python2.7/lib/python2.7/site-packages/django/core/handlers/base.py", line 179, in get_response, referer: STACKOVERFLOW DON'T LET ME PUT MORE THAN 2 hyperlinks
[Tue Apr 10 11:03:15 2012] [error] [client 122.198.133.250]     response = self.handle_uncaught_exception(request, resolver, sys.exc_info()), referer: STACKOVERFLOW DON'T LET ME PUT MORE THAN 2 hyperlinks
[Tue Apr 10 11:03:15 2012] [error] [client 122.198.133.250]   File "/opt/python2.7/lib/python2.7/site-packages/django/core/handlers/base.py", line 228, in handle_uncaught_exception, referer: STACKOVERFLOW DON'T LET ME PUT MORE THAN 2 hyperlinks
[Tue Apr 10 11:03:15 2012] [error] [client 122.198.133.250]     return callback(request, **param_dict), referer: STACKOVERFLOW DON'T LET ME PUT MORE THAN 2 URLs
[Tue Apr 10 11:03:15 2012] [error] [client 122.198.133.250] TypeError: 'str' object is not callable, referer: STACKOVERFLOW DON'T LET ME PUT MORE THAN 2 hyperlinks 
```

[请将 'STACKOVERFLOW DON'T LET ME PUT MORE THAN 2 hyperlinks' 替换为 'http://58.215.177.34/Presentation'] :)

使用 django runserver 时，我设置了 arvindemo.settings debug = True，一切正常。但是一旦我设置 debug = False，情况就发生了变化。

这是我的意见.py

```
from django.http import HttpResponseRedirect
from django.http import HttpResponse, HttpResponseServerError
from django.shortcuts import render_to_response
import datetime, string
from user_info.models import *
from django.template import Context, loader, RequestContext
import settings
def hello(request):
    return HttpResponse("hello girl")

def helpPage(request):
    return render_to_response('kktHelp.html')

def server_error(request, template_name='500.html'):
    return render_to_response(template_name,
            context_instance = RequestContext(request)
    )

def page404(request):
    return render_to_response('404.html')

def submitPage(request):
    post = request.POST
    Mall = 'goodsName'
    Contest = 'ojs'
    Presentation = 'addr'
    WeatherReport = 'city'
    Habit = 'task'
    if Mall in post:
            return submitMall(request)
    elif Contest in post:
            return submitContest(request)
    elif Presentation in post:
            return submitPresentation(request)
    elif Habit in post:
            return submitHabit(request)
    elif WeatherReport in post:
            return submitWeather(request)
    else:
            return HttpResponse(request.POST)
            return HttpResponseRedirect('404')
def submitXXX():
  .....
def xxxx():
.... 
```

这里是 urls.py

```
from django.conf.urls import patterns, include, url
from views import *
from django.conf import settings

handler500 = 'server_error'
urlpatterns = patterns('',
    url(r'^hello/$', hello),  # hello world
    url(r'^$', homePage),
    url(r'^time/$', getTime),
    url(r'^time/plus/(\d{1,2})/$', hoursAhead),
    url(r'^Ttime/$', templateGetTime),
    url(r'^Mall$', templateMall),
    url(r'^Contest$', templateContest),
    url(r'^Presentation$', templatePresentation),
url(r'^Habit$', templateHabit),
url(r'^Weather$', templateWeather),
url(r'^Help$', helpPage),
url(r'^404$', page404),
url(r'^500$', server_error),
url(r'^submitPage$', submitPage),
url(r'^submitMall$', submitMall),
url(r'^submitContest$', submitContest),
url(r'^submitPresentation$', submitPresentation),
url(r'^submitHabit$', submitHabit),
url(r'^submitWeather$', submitWeather),
url(r'^terms$', terms),
url(r'^privacy$', privacy),
url(r'^thanks$', thanks),
url(r'^about$', about),
url(r'^static/(?P<path>.*)$','django.views.static.serve',{'document_root':settings.STATICFILES_DIRS}),
) 
```

我确定我的 django 项目没有语法错误，因为当我使用 django runserver 时，一切正常。

任何人都可以帮忙吗？

此致

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-12T16:51:08.473

在您的帖子中，您始终将 False 拼错为 Flase。你在设置文件中拼写正确吗？

# java - 如何使用 powermock 和 easymock 模拟本地对象

> ID：10092178
> 
> 赞同：2
> 
> 时间：2012-04-10T15:57:41.620
> 
> 标签：java, testing, mocking

我需要一些帮助：

例子：

```
void method1{
       MyObject obj1=new MyObject();
       obj1.method1();
    } 
```

我想在我的测试中模拟 obj1.method1() 但我无法从外部访问 obj1。有没有办法用 powermock 和 easymock 做到这一点。现在我知道它可以与 powermock 和 mockito 一起使用。

# sql - 如何在两次之间找到以毫秒为单位的时间跨度？

> ID：10092183
> 
> 赞同：3
> 
> 时间：2012-04-10T15:57:59.073
> 
> 标签：sql, sql-server, tsql, datetime, timespan

使用 TSQL 你如何找到两次之间的差异，以毫秒为单位？

```
declare @start datetime = '2012-04-10 14:59:12.863',
    @end datetime = '2012-04-10 14:59:13.800'

select  @start, @end, 'TODO: get timespan in milliseconds between @start and @end' 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-04-10T16:00:49.807

使用[此处记录的 datediff 函数。](http://msdn.microsoft.com/en-us/library/ms189794%28v=sql.105%29.aspx)

```
declare @start datetime = '2012-04-10 14:59:12.863',     
    @end datetime = '2012-04-10 14:59:13.800'     

select datediff(ms, @start, @end) 
```

ms 是毫秒的日期部分缩写。

# ruby - 如何使用 Ruby gpgme 解密 PGP 加密文件

> ID：10092184
> 
> 赞同：7
> 
> 时间：2012-04-10T15:58:02.037
> 
> 标签：ruby, encryption, gnupg, pgp, gpgme

我找不到一个如何做到这一点的例子。我有一个 PGP 加密的 XLS 文件和一个 PGP 密钥。这是我返回空字符串的代码：

```
require 'rubygems'
require 'gpgme'

def passfunc(obj, uid_hint, passphrase_info, prev_was_bad, fd)
  io = IO.for_fd(fd, 'w')
  io.puts "PASSPHRASE"
  io.flush
end

encrypted_data = GPGME::Data.new(File.open("file.xls.pgp"))
key = GPGME::Data.new(File.open("key.txt"))

ctx = GPGME::Ctx.new :passphrase_callback => method(:passfunc)
ctx.import_keys key

decrypted = ctx.decrypt encrypted_data

puts decrypted.read 
```

我可以使用相同的密钥在 Windows 上名为 GNU Privacy Assistant 的程序中解密此文件。任何帮助表示赞赏。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-11T02:24:00.443

Ruby gpgme 的开发者 Daiki Ueno 在 GitHub 上联系了我：

> `decrypted.seek(0)`在行后添加`decrypted = ctx.decrypt encrypted_data`似乎可以解决问题

# mysql - Rails BLOB/TEXT 列在没有密钥长度的密钥规范中使用

> ID：10092188
> 
> 赞同：6
> 
> 时间：2012-04-10T15:58:20.963
> 
> 标签：mysql, ruby-on-rails, rails-migrations

我正在尝试运行 rails 迁移，我看到错误“BLOB/TEXT column used in key specification without a key length”...但是，我在迁移类中指定了长度。从迁移生成 SQL 语句时，Rails 似乎忽略了这一点。有什么线索吗？

这是我的迁移课程：

```
class AddIndexToAccounts < ActiveRecord::Migration
def self.up
  add_index :TACCOUNT, :NAMEX, :length => 5
end
def self.down
  remove_index :TACCOUNT, :NAMEX
end
end 
```

这是错误输出。它似乎已经看到了长度规范，但它不存在于它生成的 SQL 语句中：

```
** [out :: 192.168.10.7] -- add_index(:TACCOUNT, :NAMEX, {:length=>5})
** [out :: 192.168.10.7] rake aborted!
** [out :: 192.168.10.7] An error has occurred, all later migrations canceled:
** [out :: 192.168.10.7] 
** [out :: 192.168.10.7] Mysql::Error: BLOB/TEXT column 'NAMEX' used in key specification without a key length: CREATE  INDEX `index_TACCOUNT_on_NAMEX` ON `TACCOUNT` (`NAMEX`) 
```

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-04-10T22:21:12.590

您可以尝试更具体地查看这是否会使其正常工作：

```
add_index :TACCOUNT, :NAMEX, :length => { :NAMEX => 5 } 
```

作为最后的手段，您可以通过调整不正确的`ADD INDEX`语句并使用正确的语句直接使用 SQL 以“硬方式”创建索引`execute`。

# selenium - Selenium WebDriver executeScript 不起作用

> ID：10092190
> 
> 赞同：1
> 
> 时间：2012-04-10T15:58:25.210
> 
> 标签：selenium, webdriver

我正在使用脚本将隐藏表单字段变量`formContent`的值设置为值“Hello”。Selenium Webdriver 不设置隐藏表单字段的值，因为它不可见。

这是我的代码：

```
JavascriptExecutor js = (JavascriptExecutor) driver;
js.executeScript("return jQuery('input:hidden[id$=\"formContent\"]').val('Hello');"); 
```

我得到的脚本没有响应。你能告诉我我在这里做错了什么吗？在我的`formContent`xhtml 中定义如下：

```
<input type="hidden" id="formContent" name="formContent" value="" /> 
```

如果使用以下代码行，那么它没有设置隐藏表单字段“formContent”的值：

```
 JavascriptExecutor js = (JavascriptExecutor) driver;
 js.executeScript("jQuery('input:hidden[id$=\"formContent\"]').val('Hello');"); 
```

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-20T04:24:24.483

我相信这是 Firefox 网络驱动程序的错误。我在尝试返回 jQuery 对象时遇到了类似的情况，并在此处描述了该行为：[http ://code.google.com/p/selenium/issues/detail?id=3756](http://code.google.com/p/selenium/issues/detail?id=3756)

尝试返回 jQuery obj 以外的其他内容，它应该会再次响应。例如，您可以返回执行代码的布尔值，只需在其前面加上 !! 像这样：

```
js.executeScript("return !!jQuery('input:hidden[id$=\"formContent\"]').val('Hello');"); 
```

# git - 如何使用 Git 进行多任务处理

> ID：10092191
> 
> 赞同：3
> 
> 时间：2012-04-10T15:58:26.643
> 
> 标签：git, coldfusion

我从事许多位于单个 Web 服务器上的 ColdFusion 项目。我最近在 SO 上被其他人“[展示](https://stackoverflow.com/questions/9847933/how-do-you-use-coldfusion-builder-2-in-a-team-environment-using-a-common-develop)”并希望转向开发机器/测试机器/生产机器开发方法。

我现在正试图调和如何最好地处理我（和我们机构中的其他人）被“强迫”工作的方式......

假设我们的网络服务器是这样设置的

```
-Root
--Project 1
--Project 2
--Project 3
--Framework Files 
```

还假设我们设置了一个中央 git 存储库，并且我有一个正在使用的根的克隆。该组中的所有其他开发人员也拥有自己的存储库克隆。

所以——现在是星期一早上，我开始着手项目 1。我正在处理大约 4 小时的功能请求，我的八个不同老板中的一个进来告诉我有一个关键问题需要解决在项目 2 中得到修复。星期一是一个很好的开始。

我需要修复 Project 2 STAT，但我还没有完成 Project 1 的功能请求。如果我在项目 2 中修复，然后提交到我的本地存储库以推送测试......它将在 P1 中包含未完成的功能......这很糟糕。

如果我从[Joel Spolsky 的 Mercurial Init Architecture 页面](http://hginit.com/05.html)推断，是否为每个子项目创建存储库的“开发”克隆的解决方案？要提交这些，然后提交到主本地存储库，然后提交到主共享存储库？

Git 中是否还有我遗漏的另一个概念？

谢谢大家，克里斯

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-04-10T16:04:57.053

我建议看一下[分支](http://book.git-scm.com/3_basic_branching_and_merging.html)。

通过分支，您可以一次维护多个不同的开发流，并在它们之间轻松交换。此外，您可以在远程存储库中创建远程分支，并且多个团队成员可以同时处理这些分支。它们的寿命可以长到你想要的那样短，Git 擅长创建和维护很多很多分支。

它与 stash 不同，因为 stash 是一种基于堆栈的机制，用于存储稍后返回的工作。至少可以说，它不是分布式的，并且通过堆栈管理多个工作流会很困难。

这是一个讨论分支工作流程[的有用页面。](http://nvie.com/posts/a-successful-git-branching-model/)

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-04-10T16:00:51.620

您缺少该[`stash`](http://book.git-scm.com/4_stashing.html)功能，它可以让您“收起”未完成的工作并稍后再回来。此功能允许您获取一个“脏”目录 - 自上次提交以来您已经修改了文件，但还没有完全准备好提交 - 并保存更改而不进行提交。该目录将返回到它查看上次提交的方式，您的更改由 git 保存。用法非常简单...从上面的链接中，您可以使用以下方法保存您的工作`save`：

```
$ git stash save "work in progress for foo feature" 
```

您可以使用以下命令再次恢复您的工作`apply`：

```
$ git stash apply 
```

* * *

另一个问题是您将所有项目都放在一个仓库中。虽然这不是最佳实践，但可以使用[submodules](http://book.git-scm.com/5_submodules.html)来解决，这实质上允许您在单个总体存储库中拥有多个存储库。上面的链接是关于如何使用子模块的一个很好的资源，这里有[很多有用的帖子讨论如何使用它们](https://stackoverflow.com/search?q=git+submodules)。

# objective-c - 带有静态库的 Objective C 依赖管理

> ID：10092206
> 
> 赞同：2
> 
> 时间：2012-04-10T15:59:21.947
> 
> 标签：objective-c, xcode, dependencies, static-libraries

我正在为大型 Objective C (iOS) 项目寻找依赖管理的解决方案。现在我们已经构建了多个静态库，每个开发人员都必须从 git 中提取这些库，将代码添加为子模块并与项目一起编译。我浏览了很多帖子，但没有找到我想要的。

理想情况下，我正在寻找类似于 Maven 2 for Java 的东西。一个工具：

a) 管理项目或静态库的依赖项 b) 可以处理多个版本（proj A -> lib 1.0、proj B -> lib 1.1 等） c) 如果可能，仅拉下静态库的最终状态 (.a)。

我意识到项目 c 可能是不可能的，因为定义 API 需要 .h 文件，但我想把它放在那里，以防我不知道静态库有什么魔力。

我看过[CocoaPods](https://github.com/CocoaPods/CocoaPods)和[VendorKit](http://vendorkit.com/)，但两者都在做类似于我们现在所做的事情。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-23T09:44:04.533

（这里是 CocoaPods 的作者。）

我想我错过了使 CocoaPods 不适合解决您的问题的部分，您能详细说明一下吗？

如果您不想要 CocoaPods 的依赖解析等，您可以只使用[修改/创建 Xcode 项目的部分](https://github.com/CocoaPods/Xcodeproj)来满足您的需要。

# ios - App Store 测试人员使用实际的测试环境？

> ID：10092207
> 
> 赞同：0
> 
> 时间：2012-04-10T15:59:25.223
> 
> 标签：ios, app-store, app-store-connect

我有一个新应用程序，我们不能让 App Store 测试人员违反生产 Web 服务。相反，我们为 Web 服务设置了一个具有不同 URL 的测试环境。

我试图让他们更改应用程序的 plist 文件以切换特殊命名条目的值。那没有成功 - 他们要么无法更改文件，要么不知道我在说什么。

让 App Store 测试人员将应用程序切换到测试模式的最佳方法是什么？我们显然不希望从商店下载的人能够做到这一点。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-10T19:01:07.683

审核团队不会更改应用程序。要更改 plist，您必须重新提交应用程序，然后按批准发布它。

在提交应用程序之前，让您的生产服务器（或它前面的负载均衡器等）将所有网络流量从提交的应用程序重定向到您的测试服务器。然后，在应用程序获得批准后，但在您发布应用程序以供下载之前，（重新）配置您的网络以供常规生产使用。

如果需要，请修改现有生产测试用户使用的任何测试应用程序，以使用一些替代临时路径来绕过此重定向。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-10T16:40:51.177

App Store 审阅者确实从 iPad 运行您的应用程序。如果您的应用需要在线访问，您必须提供用户名和密码以进行评估。审核将需要更长的时间，但他们确实使用您的帐户登录并查看应用程序中可用的内容。

考虑到用户将使用的环境，他们需要生产环境。我认为审查团队不会接受切换到测试环境。

如果您不这样做，您的应用将被拒绝。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-10T16:48:53.207

然后给他们一个测试帐户。如果您通过 testaccount 登录，请将所有请求重定向到您的测试环境。

# jquery - SlickUpload 替代方案

> ID：10092208
> 
> 赞同：0
> 
> 时间：2012-04-10T15:59:35.753
> 
> 标签：jquery, asp.net, slickupload

我在许多项目中使用了 SlickUpload [http://slickupload.com/](http://slickupload.com/)，几个月前我购买了 6.x 版的常规许可证。我很害怕知道收购后不再得到很好的支持……新公司不清楚产品的未来。

对我的用户来说是个大问题，他们喜欢 Slick 界面：

> [http://slickupload.com/demos](http://slickupload.com/demos)

而且我找不到这个简单而实用的界面的好选择。有没有人使用像 SlickUpload 这样的多上传 asp.net/jQuery 组件，具有：

*   拖放
*   多上传
*   如果支持 html5 动作
*   简单的使用...

如果不是问这个问题的正确地方，我会提出我的问题。

编辑：asp .net ajax 许可组件（如 SlickUpload）也很好

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-10T16:16:34.773

自 1 年以来，我一直在使用 plupload 和 asp.net，它真的很棒。它支持各种后备，你可以在这里查看。[http://www.plupload.com/](http://www.plupload.com/)它也支持通过拖放进行多项选择。

# c# - Pex 在探索时引发 NullReferenceException

> ID：10092209
> 
> 赞同：1
> 
> 时间：2012-04-10T15:59:40.840
> 
> 标签：c#, .net, moles, pex, pex-and-moles

我正在用 C# 编写服务器组件并使用 Pex 进行单元测试。

我对特定方法进行了复杂的参数化单元测试。现在事实证明，只要我添加了某个断言块，一些 pex 探索运行就会失败，并在我的方法的最后一行（就在括号中）出现 NullReferenceException。当我调试失败的运行时，它运行得非常好。

我犯了错误还是这是pex中的错误？

谢谢！

```
[PexMethod]
public Task Start(CancellationToken cancellationToken,
    int workingEndpoints, // endpoints that run succesfully
    int failingEndpoints, // endpoints that fail immidiatly
    int brokenEndpoints) // endpoints that return null for their task
{
    PexAssume.IsTrue(workingEndpoints >= 0);
    PexAssume.IsTrue(failingEndpoints >= 0);
    PexAssume.IsTrue(brokenEndpoints >= 0);
    PexAssume.IsTrue(workingEndpoints + failingEndpoints + brokenEndpoints >= 1);

    // create fake endpoints based on the count
    List<IHostEndpoint> fakeEndpoints = new List<IHostEndpoint>();
    Exception failedTaskException = new Exception();
    // Create a few endpoint stubs for testing purposes and add them to the  list (commented away for relevance)

    // create and start the host
    Host host = new Host(fakeEndpoints.ToArray());
    Task result = host.Start(cancellationToken);

    PexAssert.IsNotNull(result);
    if (failingEndpoints > 0 || brokenEndpoints > 0)
    {
        PexAssert.IsNotNull(result.Exception);

        int failedEndpointExceptionCount = 0;
        int brokenEndpointExceptionCount = 0;

        result.Exception.Flatten().Handle(innerException =>
        {
            if (innerException == failedTaskException)
                failedEndpointExceptionCount++;
            else
                brokenEndpointExceptionCount++;

            return true;
        });

        // after one broken endpoint, the run method should stop starting more endpoints
        int brokenEndpointExpectedCount = Math.Min(1, brokenEndpoints);
        PexAssert.AreEqual(failedEndpointExceptionCount, failingEndpoints);
        PexAssert.AreEqual(brokenEndpointExceptionCount, brokenEndpointExpectedCount); 
    }

    return result;            
} 
```

**编辑**

一种假设可能是由于异步代码，Pex 遇到了一些问题。我检查了每一次运行，甚至伪造了主机的启动方法。没有异步方法。在某些情况下，我确实创建了 1 个任务，但我同步运行它（下面的证明）

```
Task endpointTask = endpoint.Start(innerCancellationToken);                

if (endpointTask == null)
{
    // This endpoint is broken, for simplicity we raise an exception in the normal pipe
    Task faultedTask = new Task(() =>
    {
        throw new InvalidOperationException("Endpoint returned a null valued task which is not allowed");
    });

    faultedTask.RunSynchronously();
    innerTasks.Add(faultedTask);

    break;
}
else
{
    innerTasks.Add(endpointTask);
} 
```

IHostEndpoint 存根是使用直接设置了值/状态的 TaskCompletionSource 创建的。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-20T23:27:10.773

Pex 是一个很棒的工具，但它有错误。从您的陈述中，我可以看出这是 Pex 中的一个错误：添加断言不应导致不相关的 NullRef。我建议您在 Pex 论坛中报告此问题。

# c# - 在 C 库调用中保留 .NET 对象的 C++/CLI 句柄

> ID：10092212
> 
> 赞同：1
> 
> 时间：2012-04-10T15:59:46.283
> 
> 标签：c#, c, c++-cli, clr

我有一个 C# 库，需要用作直接 C Win32 应用程序的一部分。我正在尝试在[C++ / CLI](http://www.codeproject.com/Articles/19354/Quick-C-CLI-Learn-C-CLI-in-less-than-10-minutes#A4)中编写一个可以处理 C# .NET 对象的包装器。唯一的问题是整个项目不能用 C++ 编译，它必须留在 C 中。

为了解决这个问题，我想将我的 C# 对象的实例不透明地传递回 C 代码，以便它们可以传入并在包装库调用中使用，但我不知道该怎么做。例如，我想做这样的事情：

C++ / CLI 包装器：

```
void * ReturnObject(char *name){
  return (void *)gcnew MyObject(gcnew String(name));
}

void UseObject (void *object){
  MyObject ^handle = (MyObject ^)object;
  object -> use();
} 
```

使用 C++ 静态库的本机 C 代码：

```
int main (char **argv){
  void *obj = ReturnObject("foobar");
  UseObject(obj);
} 
```

所以 C 代码从不关心内容`obj`是什么，甚至不知道 CLR 类型`MyObject`，它只是传递数据以保持对象持久性。我认为这应该用`void`指针来完成，但是 C++ 编译器不想进行强制转换。我不知道这是否是因为托管内存和非托管内存之间的差异，或者我只是没有正确地做到这一点，但我当然会感谢任何帮助。

所以，回顾一下：我正在尝试在 C++/CLI 包装库中实例化 .net 对象，并将这些对象保存在直接 C 代码中，以便它们可以在我尚未编写的其他 C++/CLI 库调用中再次使用。

有什么建议么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-10T16:13:32.223

您不能将句柄存储在 void* 中，因为垃圾收集器可以移动对象，使指针比无用更糟糕（它现在将指向其他一些随机对象）。

您需要使用`gcroot`C++/CLI 提供的模板。然后，您可以存储`gcroot<MyObject>*`到 a`void*`并将其传递给您的 C 代码。完成后不要忘记正确释放`gcroot`它，以运行析构函数。

您还可以查看`GCHandle`该类，它是 .NET 类库的一部分。但`gcroot`建议在 C++/CLI 代码中使用（它在`GCHandle`内部使用）。

# c# - 如何从子控件中使用 Command.CanExecute

> ID：10092216
> 
> 赞同：0
> 
> 时间：2012-04-10T15:59:56.767
> 
> 标签：c#, .net, wpf, command

这是设置（删除了无关的布局代码）：

窗口.xaml

```
<Button Name="btn_Next" Command="NextPage">Next</Button>
<ContentControl Name="contentControl1" >
        <Binding ElementName="MainWindow" Path="CurrentPage"/>
</ContentControl> 
```

Window.xaml.cs 构造函数

```
 var nextCommand = new CommandBinding(NavigationCommands.NextPage);
  nextCommand.CanExecute += nextCommand_CanExecute;
  nextCommand.Executed += nextCommand_Executed;
  CommandBindings.Add(nextCommand); 
```

这在基本示例中效果很好，其中`nextCommand_CanExecute`检查 CurrentPage 是否是最后一页。但是，该逻辑目前只是检查一个数组，并且只适用于线性导航。但是，导航将是树状的，这将不起作用，其中的项目`contentControl1`有时会向不同的方向分支。所以，我希望用户控件`CurrentPage`有机会覆盖`CanExecute`. 我的问题是我无法弄清楚如何`UserControl`启动`CanExecute`. 我尝试使用多种`CommandTarget`设置均无济于事……我的子控件从未`CanExecute`触发过它的方法。我什至尝试`e.ContinueRouting = true`在父窗口的 CanExecute 中使用。这是用户控制代码，以防万一。

用户控制构造器：

```
 var nextCommand = new CommandBinding(NavigationCommands.NextPage);
  nextCommand.CanExecute += nextCommand_CanExecute;
  CommandBindings.Add(nextCommand); 
```

用户控件 CanExecute 方法：

```
private void nextCommand_CanExecute(object sender, CanExecuteRoutedEventArgs e)
{
  e.CanExecute = false;
  e.Handled = true;
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-10T17:06:31.510

路由命令事件从可视化树的根部向下传送到启动它们的控件，然后再向上冒泡。Josh Smith 关于路由命令的文章很好地描述了它的工作原理（特别是参见“路由”部分）[http://joshsmithonwpf.wordpress.com/2008/03/18/understanding-routed-commands/](http://joshsmithonwpf.wordpress.com/2008/03/18/understanding-routed-commands/)。

这里的问题是您的用户控件（在内容控件内部）不是发出命令的按钮的“祖先”，因此路由事件永远不会到达它（即使在传递中）。鉴于您的视觉树的结构方式，我认为路由命令对您来说还不够。

想到的第一个解决方案是建立您自己的机制，将 CanExecute/Executed 逻辑委托给您的用户控件。也许您可以定义一个由所有此类控件实现的基类或接口，这些控件定义了所需的各种命令 CanExecute/Executed 方法。然后，您可以拥有一个顶级实现，将当前加载的控件转换为您的接口/基类类型并调用适当的方法。

# jquery - 引导程序中的确认删除模式

> ID：10092226
> 
> 赞同：1
> 
> 时间：2012-04-10T16:00:51.573
> 
> 标签：jquery, json, modal-dialog, twitter-bootstrap

我正在尝试实现删除行确认模式。我不知道该怎么做

这是我的模态代码

```
<div class="modal hide fade" id="myModal">
<div class="modal-header">
 <a class="close" data-dismiss="modal">×</a>
 <h3>Modal header</h3>
</div>
<div class="modal-body">
<p>One fine body…&lt;/p>
</div>
<div class="modal-footer">
 <a href="#" data-dismiss="modal" class="btn">Cancel</a>
 <a href="#" class="btn btn-danger">Delete</a>
</div>
</div> 
```

//这里是我调用模态的链接

```
<a data-toggle=\"modal\" class=\"btn btn-danger\" rel=\"tooltip\"  href=\"#myModal\"    title=\"Delete Survey\" >Delete</a> 
```

在这里，我想将调查 id 传递给模态，以便当我在模态中单击按钮删除时，它应该删除受尊重的行。我不知道应该如何发送值

在删除选择按钮上，它应该通过 webservice 传递值并在警报框中记录 json 的响应

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2019-07-30T14:47:43.447

使用引导程序的常见确认模式

```
 $(function () {
            (function ($) {
                $.fn.confirm = function (options) {
                    var settings = $.extend({}, $.fn.confirm.defaults, options);

                    return this.each(function () {
                        var element = this;
                        $('.modal-title', this).html(settings.title);
                        $('.message', this).html(settings.message);
                        $('.confirm', this).html(settings.confirm);
                        $('.dismiss', this).html(settings.dismiss);

                        $(this).on('click', '.confirm', function (event) {
                            $(element).data('confirm', true);
                        });

                        $(this).on('hide.bs.modal', function (event) {
                            if ($(this).data('confirm')) {
                                $(this).trigger('confirm', event);
                                $(this).removeData('confirm');
                            } else {
                                $(this).trigger('dismiss', event);
                            }

                            $(this).off('confirm dismiss');
                        });

                        $(this).modal('show');
                    });
                };

                $.fn.confirm.defaults = {
                    title: 'Modal title',
                    message: 'One fine body&hellip;',
                    confirm: 'OK',
                    dismiss: 'Cancel'
                };
            })(jQuery);
        });

$( "#Delete" ).click(function() {

 $('#confirm').confirm({
            title: 'confirmation',
            message: 'Do you want to delete ?',
            confirm: 'Delete',
            dismiss: 'dismiss'
        }).on({
            confirm: function () {
              alert( "ok" );
            },
            dismiss: function () {
                alert('dismiss');
            }
        });

});
```

```
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
<!-- Latest compiled and minified CSS -->
<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">

<!-- Optional theme -->
<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap-theme.min.css" integrity="sha384-rHyoN1iRsVXV4nD0JutlnGaslCJuC7uwjduW9SVrLvRYooPp2bWYgmgJQIXwl/Sp" crossorigin="anonymous">

<!-- Latest compiled and minified JavaScript -->
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>

<div class="modal fade" id="confirm" tabindex="-1" role="dialog" aria-labelledby="confirm-label" aria-hidden="true">
            <div class="modal-dialog ">
                <div class="modal-content">
                    <div class="modal-header">
                        <h4 class="modal-title" id="confirm-label"></h4>
                        <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>

                    </div>
                    <div class="modal-body">
                        <div class="text-center wirningColor">
                            <i class="fas fa-exclamation-triangle fa-4x"></i>
                        </div>
                        <br />
                        <center>
                            <p class="message"></p>
                        </center>
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-danger dismiss" data-dismiss="modal"></button>

                        <button type="button" class="btn btn-primary confirm" data-dismiss="modal"></button>

                    </div>
                </div>
            </div>
        </div>

  <button type="button" id="Delete"  class="btn btn-danger ">Delete</button>
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-14T18:58:16.963

使用 jQuery。这是一个*非常*基本的示例，假设您的 Web 服务是位于 www.example.com 的服务器上名为“delete_survey.php”的脚本：

```
<a href="#" class="btn btn-danger"
onclick="$.ajax('http://www.example.com/delete_survey.php?survey_id='+survey_id, {})">Delete</a> 
```

我强烈建议您阅读 jquery ajax 文档，[http://api.jquery.com/jQuery.ajax/](http://api.jquery.com/jQuery.ajax/)

# zend-framework - Zend - 从 Modulel/Controller/View Logic 生成口语 URL

> ID：10092232
> 
> 赞同：0
> 
> 时间：2012-04-10T16:01:01.620
> 
> 标签：zend-framework, seo, routes

使用 Zend，您可以为更好的 URL 添加路由，例如：

```
$oRouter->addRoute( 'imprintRoute', new Zend_Controller_Router_Route_Static( 'imprint/', array( 'module' => 'default', 'controller' => 'imprint', 'action' => 'index') ); 
```

是否有可能以相反的方式获得正确的 URL，例如当我在模板中使用模块/控制器/操作逻辑时？

```
<a href="{$this->url(['module' => 'default', 'controller' => 'imprint', 'action' => 'index'])}">Imprint</a> 
```

应打印为 example.com/imprint/

你有什么想法或例子吗？

亲切的问候，netzaffin

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-10T17:36:00.887

该`url()`方法接受四个参数：

*   **array $urlOptions**传递给 Route 对象的 assemble 方法的选项。
*   **混合 $name**要使用的路由的名称。如果为 null，它将使用当前 Route
*   **bool $reset**是否重置路由默认值
*   **bool $encode**是否编码

因此，您可以将路由名称添加为第二个参数，如下所示：

```
<a href="{$this->url(['module' => 'default', 'controller' => 'imprint', 'action' => 'index'], 'imprintRoute', true)}">Imprint</a> 
```

# javascript - 客户端 JavaScript / jQuery 表单验证没用吗？

> ID：10092233
> 
> 赞同：2
> 
> 时间：2012-04-10T16:01:27.673
> 
> 标签：javascript, jquery, validation

> **可能重复：**
> [JavaScript：客户端与服务器端验证](https://stackoverflow.com/questions/162159/javascript-client-side-vs-server-side-validation)

有很多 JavaScript/jQuery 客户端表单验证脚本。但考虑到它是客户端，绕过验证并提交带有忽略验证规则的值的表单相当容易。唯一的解决方案是同时实施服务器端验证以保护自己。

客户端 jQuery 验证很有趣，而且看起来很漂亮，但是如果您已经必须实现服务器端验证，那么客户端验证的意义何在？这似乎是不必要的冗余和开发时间的浪费。没用吗？

另外，有没有什么好方法可以实现不需要服务器端验证的客户端验证？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-10T16:03:40.960

始终可以绕过客户端验证。没有办法解决这个问题。在处理敏感信息、写入/读取数据库或任何可能被黑客入侵的事情时，应始终使用后端验证。

客户端验证就在那里，因为它更快。与其在我提交表单后立即知道我的电子邮件地址格式不正确，服务器检查它，然后发回一些东西，不如立即知道我的电子邮件地址格式不正确。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-10T16:04:35.423

一个词：**可用性**。您不应该只编写 Web 应用程序来防御黑客。有更多的普通用户只想要易于使用、直观的软件。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-04-10T16:03:27.750

它提供了更好的用户体验。这才是重点。用户可以在更改表单值后立即看到验证结果，而不是每次都提交表单并等待服务器响应。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-10T16:05:34.487

您总是需要服务器端验证。永远不要相信来自客户端的任何数据。客户端验证是为了更好的用户体验而完成的。如果您希望人们使用您的网站，用户体验非常重要。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-04-10T16:10:34.967

客户端验证背后的想法是系统是“快速失败的”。如果一个诚实的用户犯了错误，她会立即被告知，这对用户（更少的等待）和服务器（更轻的流量负载）都有好处。

服务器端验证始终是安全存在所必需的；任何安全的客户端验证系统都必须假设用户无法控制自己的机器。

# php - pecl/oauth vs pecl/oauthprovider 签名不匹配

> ID：10092234
> 
> 赞同：0
> 
> 时间：2012-04-10T16:01:27.813
> 
> 标签：php, oauth, pecl, oauth-provider

我使用 pecl oauth 包编写了一个简单的 oauth 提供者和消费者。一切顺利，直到我尝试获取访问令牌，此时我收到签名不匹配错误。oauth 消费者尝试通过以下方式使用 oauth->getauthorizedtoken 联系提供者：

```
$res = mysql_query("SELECT * FROM request_tokens WHERE oauth_token = '".mysql_real_escape_string($token)."'");
$requestToken = mysql_fetch_assoc($res);

$oauth->setToken($token, $requestToken['oauth_token_secret']);
$authToken = $oauth->getAccessToken("http://dev.myserver.com/~testbranch/?m=oauthMod&act=authorize", NULL, $verifier); 
```

当这失败时，它会吐出带有如下签名的调试信息：

```
3qBMmue4Q+j8Dm4/9VSTl6y0TR8= 
```

在提供者方面，消费者和令牌经过验证，然后它因签名不匹配而失败，即使它计算的签名是：

```
3qBMmue4Q%2Bj8Dm4%2F9VSTl6y0TR8%3D 
```

这显然是完全相同签名的 url 转义版本。这是一个错误还是我公然遗漏了什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-08-21T15:44:40.500

正如我在问题中所指出的，这两个签名是相同的，除了一个是 url 编码的。这不是规范的一部分，也没有记录在案，但它确实存在。我的最终解决方案同时检查签名匹配和 url 编码的签名匹配。这并不理想，因为有可能出现错误匹配，但如果不从头开始重写整个算法，我几乎无能为力。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-11-21T21:37:26.507

OAuthProvider::$signature 是来自消费者请求的 oauth_signature 的解码值，而*不是*OAuthProvider 计算的签名。因此，打印 OAuthProvider 收到的 Authorization 标头将包括`oauth_signature="3qBMmue4Q%2Bj8Dm4%2F9VSTl6y0TR8%3D"`而 OAuthProvider::$signature 将显示`3qBMmue4Q+j8Dm4/9VSTl6y0TR8=`。

如果您的解决方法是从 Authorization 标头（或等效项）中获取 oauth_signature 并将其与编码的 OAuthProvider::$signature 进行比较......那些将始终匹配！

我遇到的 OAuthProvider 引发签名不匹配异常的问题是未向 OAuthProvider::checkOAuthRequest() 提供端点 URI 的结果。文档表明这是可选的，但需要包含它，因为它是签名基本字符串的一部分。

# c# - 使用 XAML 收缩和扩展其他扩展器时移动扩展器

> ID：10092236
> 
> 赞同：1
> 
> 时间：2012-04-10T16:01:48.033
> 
> 标签：c#, wpf, xaml

我有一个带有 2 个扩展器的 stackPanel：

```
<Grid x:Name="LayoutRoot" Margin="0">
    <StackPanel Height="Auto" Margin="0" Width="Auto">
        <Expander Header="my expander"  Height="200" Margin="0,0,0,0" Width="Auto" Background="#00F19494" VerticalAlignment="Top">
            <Grid Background="#FFB86E6E"/>
        </Expander>
        <Expander Header="next expander"  Height="200" Margin="0,0,0,0" Width="Auto" Background="#00F19494" VerticalAlignment="Top">
            <Grid Background="#FF6E5C5C"/>
        </Expander>
    </StackPanel>
</Grid> 
```

我希望第二个扩展器在第一个扩展器收缩时向上移动，并在第一个扩展器展开时将其向下移动，因此它始终出现在第二个扩展器区域的底部。

有没有使用 XAML 的简单方法？

# javascript - 使用 JavaScript，如何执行将返回多个值的二进制搜索？

> ID：10092242
> 
> 赞同：3
> 
> 时间：2012-04-10T16:02:07.737
> 
> 标签：javascript, algorithm, search, nosql

## 背景

我目前有一个这样的数组：

`[1,1,2,3,4,5,5,5,6,7,8,8,8,8,9,10]`

我一直在使用[这个网站上](http://www.javascriptkit.com/javatutors/arraysort.shtml)的一个很棒的 JS Binary Search 公式：

```
searchArray = function(needle, haystack, case_insensitive) {
    if (typeof(haystack) === 'undefined' || !haystack.length) return -1;

    var high = haystack.length - 1;
    var low = 0;
    case_insensitive = (typeof(case_insensitive) === 'undefined' || case_insensitive) ? true:false;
    needle = (case_insensitive) ? needle.toLowerCase():needle;

    while (low <= high) {
        mid = parseInt((low + high) / 2)
        element = (case_insensitive) ? haystack[mid].toLowerCase():haystack[mid];
        if (element > needle) {
            high = mid - 1;
        } else if (element < needle) {
            low = mid + 1;
        } else {
            return mid;
        }
    }

    return -1;
}; 
```

这适用于返回单个值。

## 问题

如何返回一个范围而不是单个值？例如，我将如何返回`8`数组中的所有值，但仍然使用二进制搜索（我不想遍历所有内容！！）。

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-10T17:01:30.077

像这样的东西？[http://jsfiddle.net/DCLey/3/](http://jsfiddle.net/DCLey/3/)

```
var arr = ['1','1','2','3','4','5','5','5','6','7','8','8','8','8','9','10'];
        //  0   1   2   3   4   5   6   7   8   9   10  11  12  13  14  15            
var searchArray = function(needle, haystack, case_insensitive) {
    if (typeof(haystack) === 'undefined' || !haystack.length) return -1;

    var high = haystack.length - 1;
    var low = 0;
    var vals = []; 
    var bUp = true; 
    var bDown = true;
    var i = 1; 
    case_insensitive = (typeof(case_insensitive) === 'undefined' || case_insensitive) ? true:false;
    needle = (case_insensitive) ? needle.toLowerCase():needle;

    while (low <= high) {
        mid = parseInt((low + high) / 2)
        element = (case_insensitive) ? haystack[mid].toLowerCase():haystack[mid];
        if (element > needle) {
            high = mid - 1;
        } else if (element < needle) {
            low = mid + 1;
        } else {
            vals.push(mid); 
            while(bUp || bDown){
                if(bUp && haystack[mid] === haystack[mid + i]){
                    vals.push(mid + i); 
                }else{
                    bUp = false;   
                }
                if(bDown && haystack[mid] === haystack[mid - i]){
                    vals.push(mid - i); 
                }else{
                    bDown = false;   
                }
                i++;
            }
            return vals; 
        }
    }

    return -1;
};

alert(searchArray('8', arr, true)); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-10T18:45:17.310

除非您只想计算给定数字的实例数，否则您需要返回数组中数字的上下索引。我们可以从 2 种方法中进行选择：

1.  编写一个二进制搜索，将上下界的索引作为数组返回
2.  坚持使用返回下限的标准二分搜索，然后简单地向上迭代，直到我们到达运行结束。

采用方法 2 的性能稍差，但保留了通用算法。

# java - 如何在 Spring 3 中将参数从视图传递到控制器

> ID：10092243
> 
> 赞同：3
> 
> 时间：2012-04-10T16:02:11.323
> 
> 标签：java, model-view-controller, view, jstl, spring-3

这是我的视图片段，当点击超链接时，我需要将两个名为 solicitudId 和 detailId 的参数发送到控制器中的一个方法

```
<tr>
    <td>${user.loginName}</td>
    <td>${user.phone}</td>
    <td>${user.address}</td>
    <td><a href="/enable?solicitudId=${user.solicitudId}&detailId=${user.detail}">Enable</a></td>
tr> 
```

//控制器

```
@RequestMapping(value="/enable", method=RequestMethod.GET)
    public String enableUser(Model model){
        try{
            //How should I get the values from the parameters solicitudId and detailId?
        }catch(Exception e){
            e.printStackTrace();
        }
        return  null;
} 
```

提前致谢！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-10T16:09:37.527

```
@RequestMapping(value="/enable", method=RequestMethod.GET)
    public String enableUser( @RequestParam("solicitudId") int solicitudId ,   
                              @RequestParam("detailId") int detailId, Model model){
        try{
            //do whatever you want with detailId and solicitudId
        }catch(Exception e){
            e.printStackTrace();
        }
        return  null;
} 
```

参考： [http ://static.springsource.org/spring/docs/3.0.0.M3/spring-framework-reference/html/ch16s11.html](http://static.springsource.org/spring/docs/3.0.0.M3/spring-framework-reference/html/ch16s11.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-10T16:06:05.360

您需要一个接受 HTTP 请求对象的控制器方法。参数将作为名称/值对作为 GET 请求的一部分。像这样：

[Spring MVC 控制器 HTTP GET 查询参数](https://stackoverflow.com/questions/787291/spring-mvc-controller-http-get-query-parameters)

# c# - 在另一个安装程序中启动安装程序 (setup.exe)，程序不会出现在已安装程序列表中

> ID：10092245
> 
> 赞同：0
> 
> 时间：2012-04-10T16:02:18.580
> 
> 标签：c#, .net, windows-installer, registration

我已经构建了一个安装程序来启动另一个安装程序（在它的提交阶段）（setup.exe 和 .msi 文件放在“BoardsControllerSetup”目录中）

靠我自己，开发系统（运行 w7 专业版），一切都很花哨

在另一台 w7 机器上测试，以具有基本权限的用户身份登录（我很确定权限是罪魁祸首），第二个应用程序不会出现在已安装的程序列表中（也不会在桌面上创建它的图标） .

（稍后我需要从第一个应用程序中启动第二个应用程序，所以我希望能够从注册表中获取它的安装路径我总是可以尝试使用安装路径创建一个注册表字符串.. 但是现在我实际上很好奇如何直接解决这个问题）。

任何和所有的帮助表示赞赏。

肖恩

```
 System.Diagnostics.Process cBoardsControllerSetupProcess = new System.Diagnostics.Process();
        startInfo = new System.Diagnostics.ProcessStartInfo();
        startInfo.WindowStyle = System.Diagnostics.ProcessWindowStyle.Hidden;
        startInfo.WorkingDirectory = Path.Combine(sInstallDir, "BoardsControllerSetup");
        startInfo.FileName = "setup.exe";
        cBoardsControllerSetupProcess.StartInfo = startInfo;
        cBoardsControllerSetupProcess.Start(); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-11T06:54:49.497

Windows Installer 不支持同时运行两个基于 MSI 的安装。所以很可能第二个安装程序失败，因为主安装当前正在运行。它在一台机器上工作的事实只是一个时间巧合。

从 InstallExecuteSequence 运行另一个基于 MSI 的安装的唯一（非弃用）方法是在[InstallFinalize](http://msdn.microsoft.com/en-us/library/windows/desktop/aa369505%28v=vs.85%29.aspx)之后使用[msidbCustomActionTypeAsync 和 msidbCustomActionTypeContinue](http://msdn.microsoft.com/en-us/library/windows/desktop/aa368071%28v=vs.85%29.aspx)标志来安排它。这样它将在主安装完成后运行。

请注意，安装现有软件包的推荐方法是将它们添加为先决条件。一些商业安装工具支持由 MSI 控制的基于功能的先决条件，但大多数安装工具只允许 EXE 引导程序处理的先决条件。

# java - 使用正则表达式不能只找到一个单词

> ID：10092246
> 
> 赞同：0
> 
> 时间：2012-04-10T16:02:23.490
> 
> 标签：java, regex

我试图在 java 中“找到”一系列非常具体的字符，但我的正则表达式无法正常工作。

我想找到一个单词（任何单词），然后是一个空格，然后是一个正斜杠，然后是另一个空格，然后是一个“M”（小写或大写），然后是一系列数字。我正在使用以下行：

```
Elements rating = doc.getElementsMatchingText(Pattern.compile("\\b\\s/\\s[mM][0-9]+")); 
```

但这是找到整行（预期模式之前和之后的单词）。这也无济于事：

```
Elements rating = doc.getElementsMatchingText(Pattern.compile("^\\b\\s/\\s[mM][0-9]+")); 
```

我究竟做错了什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-10T16:13:30.933

您的案例的正确模式是`\\b\\w+\\s/\\s[mM][0-9]+`.

但是，您描述的问题与您使用的 API 有关，而不是与模式有关。请注意，`getElementsMatchingText`这不允许您访问匹配详细信息，因此您无法提取与模式匹配的部分文本。

`doc`您需要手动迭代所有元素并应用于`Matcher.find()`每个元素的文本，或者只需使用`Matcher.find()`相同的模式再次应用于由`getElementsMatchingText`. 然后您就可以将匹配的部分提取为`Matcher.group()`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-10T16:15:05.653

你的正则表达式有缺陷。我会提议

```
\w+ / [Mm]\d+ 
```

（记得在输入 java 字符串时适当转义）

关于你的正则表达式的一些事情：

1）您目前没有任何东西可以匹配“单词（任何单词）”（！！！）我选择 \w+ 来匹配至少包含一个单词字符的单词。例如，如果您想进一步自定义，您可以执行 \w{2,10} 之类的操作来处理 2 到 10 个字符之间的单词。

2）你根本不需要 \b 因为 \w* 匹配只匹配有效的单词字符

3) 请记住 \s 可能不仅仅匹配一个空格.. 我只使用一个空格，但如果你对它匹配选项卡、新行（如果以这种方式配置）等没问题，你可以输入 \s。

4）我认为 \d 比 [0-9] 更惯用和可读

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-04-10T16:12:39.350

关于正则表达式，请尝试：

> .* \ [毫米][1-9]*

我用[http://rubular.com/](http://rubular.com/)来测试我的正则表达式，所以你可以做你的实验。

再见

# jquery - 在可拖动的 DIV 中添加图像按钮并在单击时切换图像源

> ID：10092249
> 
> 赞同：0
> 
> 时间：2012-04-10T16:02:41.827
> 
> 标签：jquery, html, css, position, draggable

我有可拖动的 DIV。在这些 DIV 中附加了一个图像。当鼠标悬停在 DIV's 上`opacity`时，图像的 将更改为`1`。当鼠标离开时，图像变得 opacity `0`。

1.  单击时，我想将图像从图像更改`close_1.jpg`为图像`close_2.jpg`- 并停止拖动该 DIV。

2.  我想将图像的位置更改为左侧 + 顶部。5px 上 DIV。

[例子](http://jsfiddle.net/ynternet/mevbF/14/)

CSS

```
div {
      width:200px;
      padding:10px;
      border: 2px solid #fff;
      cursor: pointer;
      background: #ccc;
} 
```

HTML

```
<img class="close" src="http://ynternet.sk/test2/close_1.jpg" />
   <div>Demo 1 Div </div>
   <div>Demo 2 Div </div>
   <div>Demo 3 Div </div> 
```

JavaScript

```
$(document).ready(function() {
  $('div').append( $("img.close").css("opacity", "0" ));
  $('div').find('img.close').css("paddingLeft", "20px");
  $('div').mouseover(function() {
      $(this).stop().animate({borderColor: "#aaa" }, "slow");
      $(this).find('img.close').css("opacity", "1");
  }).mouseout(function() {
      $(this).stop().animate({borderColor: "#fff" }, "slow");
      $(this).find('img.close').css("opacity", "0");
  })
  $('div').draggable({ grid: [ 10,10 ] });
}); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-10T16:30:16.097

添加这将停止拖动并更改图像：

```
$('div img').click(function() {
    $(this).attr('src', 'http://ynternet.sk/test2/close_2.jpg').parent().draggable("destroy");
});​ 
```

**[jsFiddle 示例](http://jsfiddle.net/j08691/mevbF/19/)**。

我只是不清楚你在#2 中所说的“5px 上 DIV”是什么意思。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-10T16:44:14.377

我想这可能会解决 -5px

```
div img.close {
 position: absolute;
 float: left;
 top: -15px; 
 right: 5px;
} 
```

[http://jsfiddle.net/mevbF/23/](http://jsfiddle.net/mevbF/23/)

# java - 同时创建动态线程数

> ID：10092251
> 
> 赞同：15
> 
> 时间：2012-04-10T16:02:53.473
> 
> 标签：java, multithreading, parallel-processing

每次我必须创建可变数量的线程。我通过创建一个线程数组并创建多个线程来做到这一点。

但是，我不明白如何启动这 n 个线程，其行为类似于多线程概念。我希望它们并行运行。

请指导如果在这个场景中做什么。

* * *

## 回答 #1

> 赞同：38
> 
> 时间：2012-04-10T16:06:57.437

> 但是，我不明白如何启动这 n 个线程，其行为类似于多线程概念。我希望它们并行运行。

您当然可以使用循环创建线程数组：

```
 Thread[] threads = new Thread[NUM_JOBS_TO_CREATE];
 for (int i = 0; i < threads.length; i++) {
     threads[i] = new Thread(new Runnable() {
         public void run() {
             // some code to run in parallel
             // this could also be another class that implements Runnable
         }
     });
     threads[i].start();
 } 
```

这将导致线程在后台并行运行。然后，您可以稍后加入他们，等待他们全部完成后再继续。

```
// wait for the threads running in the background to finish
for (Thread thread : threads) {
    thread.join();
} 
```

但我建议不要自己管理线程，而是使用内置的[Java`Executors`](http://docs.oracle.com/javase/1.5.0/docs/api/java/util/concurrent/Executors.html)。他们做这一切是因为你更容易管理。这种方法的好处之一是它将*任务*与运行它们的*线程分开。*例如，您可以启动 10 个线程来并行运行 1000 个和 1000 个任务。

这是一些示例`ExecutorService`代码：

```
 // create a pool of threads, 10 max jobs will execute in parallel
 ExecutorService threadPool = Executors.newFixedThreadPool(10);
 // submit jobs to be executing by the pool
 for (int i = 0; i < NUM_JOBS_TO_CREATE; i++) {
    threadPool.submit(new Runnable() {
         public void run() {
             // some code to run in parallel
             // this could also be another class that implements Runnable
         }
     });
 }
 // once you've submitted your last job to the service it should be shut down
 threadPool.shutdown();
 // wait for the threads to finish if necessary
 threadPool.awaitTermination(Long.MAX_VALUE, TimeUnit.MILLISECONDS); 
```

有关详细信息，请参阅[有关线程执行器的 Java 教程](https://docs.oracle.com/javase/tutorial/essential/concurrency/exinter.html)。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-10T16:33:21.163

尽量不要创建线程数组并尝试管理它们——它很快就会变成一个令人震惊的混乱。如果你需要一个线程池来运行任务，你需要一个生产者-消费者队列。创建一个并在创建线程时将其（或包含它作为成员的线程池对象实例）传递给线程。线程循环，获取任务并执行它们。

执行此操作的简单方法是使用@Gray (+1) 详述的 ExecutorService。

为了强调，我再说一遍，不要试图对数组、列表或向量中的线程进行微观管理、启动它们、在“老板/管理”循环中检查它们的状态、终止/中止它们、销毁它们等等。它是就像保时捷 911 - 在花费大量金钱/时间来获得一辆之后，你会得到一些似乎可以正常工作的东西，然后它会突然破碎并将你旋转成一棵树。

为长时间阻塞的作业使用专用线程，为那些可以集中快速完成的作业使用线程池。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-04-10T16:05:54.223

基本伪代码：

```
create x threads, store them in an array or list;
for each thread in the list/array
   call start() on the thread object; 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2018-01-08T11:05:48.163

在一个需要多线程的类中，我在类的顶部设置：

`private static final ExecutorService executor = Executors.newCachedThreadPool();`

& 在 Java 8+ 中，只要我需要在新线程中运行一些东西，就使用 lamda 表达式：

```
executor.submit(() -> {
        myOtherClass.myFunction(doSomething);
}); 
```

使用`newCachedThreadPool`Java 将根据系统上的 cpu 核心数管理线程总数，并在一段时间不活动后自动停止它们（`60`默认为秒）。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2019-03-09T14:56:20.590

```
Scanner reader = new Scanner(System.in);
    System.out.println("Enter a positive number: ");
    int n = reader.nextInt();
    if(n>0){
        Thread[] ob = new Thread[n];
        for (int i = 0; i < ob.length; i++) {
            int num = i+1;
            ob[i] = new Thread(new Runnable() {
         public void run() {
             System.out.println("Hello, I am Thread #"+num);
         }
            });
            ob[i].start();
        }
    }else{
        System.out.println("Please Enter A Positive Integer");
    } 
```

# http - HTTP 资源的父路径本身是否应该始终拥有资源？

> ID：10092252
> 
> 赞同：1
> 
> 时间：2012-04-10T16:02:57.437
> 
> 标签：http, rest, architecture

如果站点在路径中有资源：

```
/things/27 
```

是否有任何已发布的标准表明路径：

```
/things 
```

因此，还应该有资源吗？

我已经与一位同事讨论过这个问题，并且来自 Unix 背景（并记得基于文件结构的 HTTP 服务器的旧dys）我倾向于回答是的，父资源是隐含的，并且父目录不应该是 404。

然而，我的同事认为，除非网站上某处有指向“/things”的特定链接，否则这条路径上不需要任何资源。

RFC2616 或其他 HTTP 标准文档中是否讨论过这个问题？是否有关于该主题的其他相关文档？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-10T17:01:40.840

If you're considering implementing hypermedia in your application to provide the client of a set of possible actions at a given point (links with URI's to other appropriate resources) then the `/things` URI is the ideal place to send a GET for these links.

Below is a sample result of a GET on the `/things` resource. The advantage of this approach is that the client can be coded to look for the `Rel` values in the `Links` instead having to "know" how to construct the URI's. Even when client does need to build to a URI, it can still coded for search for items like `{searchTerm}` in the Search link href to replace with an appropriate value.

```
 "Things": [
      {
         "Description": "Resource level properties that make sense to put here",
         "Count": 33,
         "Links": [
            {
               "Rel": "self",
               "Method": "GET",
               "Href": "http://yourDomain/things",
               "Title": "Things resource"
            }
         ]
      }
   ],
   "Navigation": [
      {
         "Links": [
            {
               "Rel": "GetItem",
               "Method": "GET",
               "Href": "http://yourDomain/things/{id}",
               "Title": "Get a single item"
            },
            {
               "Rel": "Search",
               "Method": "GET",
               "Href": "http://yourDomain/things/?searchTerm={searchTerm}&itemsPerCall={itemsPerCall}",
               "Title": "Search items per term"
            }
         ]
      }
   ] 
```

# ruby - 如何生成 PayPal 请求付款并发送发票？

> ID：10092256
> 
> 赞同：1
> 
> 时间：2012-04-10T16:03:20.853
> 
> 标签：ruby, paypal

我正在编写一个独立的 Ruby 脚本来将发票生成为 PDF 文件。到目前为止，一切都运行良好。

我想知道如何在此脚本中连接到我的 PayPal 帐户并向购买者发送“请求付款”？

目前，在我使用我的Ruby脚本离线生成PDF发票后，我需要手动登录PayPal，然后点击PayPal中的“Request Money”选项卡，输入收件人的电子邮件地址，输入金额等，然后点击“要求”。

我想看看是否有办法自动化 PayPal 请求资金部分。

这是一个独立的 Ruby 脚本，而不是 Ruby on Rails 或 Web 应用程序。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-10T16:18:13.230

Mechanize 是在网站上模仿用户操作的好方法。您可以使用它来编写您作为用户执行的任何操作的脚本，并在脚本中获得您需要的结果。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-12T02:13:32.493

是的，您可以为此使用 PayPal Invoicing API。
这些将使您可以即时创建、发送、创建和发送发票。
为了使用 Invoicing API，您需要通过 www.x.com 注册一个应用程序并获得一个“应用程序 ID”。[您可以在https://www.x.com/developers/paypal/products/invoicing](https://www.x.com/developers/paypal/products/invoicing)
找到有关 Invoicing API 的更多信息——开发人员指南可在[https://cms.paypal.com/cms_content/US/en_US获得](https://cms.paypal.com/cms_content/US/en_US/files/developer/PP_InvoicingAPIGuide.pdf)[/files/developer/PP_InvoicingAPIGuide.pdf](https://cms.paypal.com/cms_content/US/en_US/files/developer/PP_InvoicingAPIGuide.pdf)

# python - 在 Python 中使用 select.select() 进行 GUI 输入

> ID：10092257
> 
> 赞同：0
> 
> 时间：2012-04-10T16:03:22.303
> 
> 标签：python, sockets, tkinter

在 Python 中使用该`select.select()`方法时，有没有办法使用来自 GUI（Tkinter 条目）的输入从套接字发送数据？

select() 的输入列表接受 sys.stdin 或从服务器接收的数据，但无论如何要从 GUI 获取数据并将其发送出去？或者选择不能与 GUI 一起使用？

我已经进行了广泛的搜索，但是如果您有指向另一个线程的链接，我也将不胜感激。

```
import socket, select, threading, Queue, cPickle
from Tkinter import *
from Message import *

class GUI(Frame):

    def __init__(self, host="localhost",port=5678, root="Tk()"):
        Frame.__init__(self,root)
        self.nickname = raw_input("What is your screen name? ")
        self.inqueue = Queue.Queue()
        self.outqueue = Queue.Queue()
        self.root = root
        self.text = Text(self,height=10,width=40)
        self.scroll=Scrollbar(self)
        self.text.configure(yscrollcommand=self.scroll.set)
        self.scroll.grid(row=0, column=1, sticky=N+S)
        self.scroll.config(command=self.text.yview)
        self.text.grid(row=0,column=0)
        self.entry = Entry(self)
        self.entry.grid(row=1,column=0)
        self.pack()
        self.sock = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
        self.sock.connect((host, port))
        self.sock.send(self.nickname)
        self.thread1=threading.Thread(target=self.cmdloop)
        self.thread1.start()
        self.entry.bind("<Return>",self.enter)
        self.call()

    def enter(self,event):
        msg = Message(self.nickname,0,self.entry.get())
        self.entry.delete(0, END)
        msg = cPickle.dumps(msg)
        self.inqueue.put(msg)
        self.sock.send(msg)

    def call(self):
        self.processData()
        self.after(100,self.call)

    def cmdloop(self):
        while 1:
            sys.stdout.flush()
            # Wait for input from stdin & socket
            inputs, outputs, excepts = select.select([0,self.sock],[],[])

            for i in inputs:
                if i == 0:
                    data = sys.stdin.readline()
                    msg = Message(self.nickname,0,data)
                    msg = cPickle.dumps(msg)
                    self.inqueue.put(msg)
                    self.sock.send(msg)

                elif i == self.sock:
                    data = self.sock.recv(1024)
                    self.inqueue.put(data)

    def processData(self):
        while self.inqueue.qsize():
            try:
                msg = self.inqueue.get(0)
                msg = cPickle.loads(msg) 
                self.text.insert(END, msg.getusr()+": "+msg.getmsg())
                self.text.yview(END)
            except Queue.Empty:
                pass

if __name__ == "__main__":
    root = Tk()
    root.title("textarea")
    client = GUI(sys.argv[1],int(sys.argv[2]),root)
    root.mainloop() 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-10T23:28:47.830

Select() 和 GUI 完全不相关。您可以从 GUI 小部件获取文本，并且可以通过套接字发送文本，因此您可以从 GUI 获取文本并像任何其他字符串一样通过套接字发送。

您是否知道入口小部件和文本小部件都有`get`获取文本的方法？您是否尝试过获取文本然后发送它，就像您调用`readline`而不是调用时一样`self.text.get`？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-12T16:02:24.313

如果要将操作绑定到条目修改、标准输入或套接字，则有一种更简单的方法，即不使用线程。这个想法是通过 Tkinter 将操作绑定到文件处理程序，而不是尝试为您自己的主循环提供选择和检索 Tkinter 事件。

例如，您可以依靠 Tkinter 主循环将函数绑定到文件描述符`createfilehandler(fd,mask,callback)`事件`root.createfilehandler(sys.stdin,READABLE,callback)`。

这是一个演示应用程序

```
from Tkinter import *
import socket

master = Tk()

entry = Entry(master)
entry.pack()

def process(data):
    print "processing: {0}".format(data)

def stdin_callback(fd, mask):
    print "stdin"
    data = sys.stdin.readline()
    process(data[:-1])

def socket_callback(fd, mask):
    print "socket"
    try:
        data= sock.recv(1024)
        if data:
            process (data)
        else:
            close_socket ()
    except socket.error as ex:
        close_socket ()

def close_socket():
    #closing socket without removing filehandler may hurt
    sock.close()
    master.deletefilehandler(fileno)

def entry_callback(event):
    print "entry"
    process(event.widget.get())

entry.bind("<Return>", entry_callback)
master.createfilehandler(sys.stdin,READABLE, stdin_callback)

sock = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
sock.connect(("localhost", 5678))
fileno = sock.fileno()
master.createfilehandler(fileno, READABLE, socket_callback)

master.mainloop() 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-15T06:44:55.597

我想我问的问题很糟糕，感谢那些尽管我措辞不佳但仍试图回答的人。我刚刚开始使用 Python。*无论哪种方式，这是我的小组成员对我试图*提出的问题找到的答案。我不知道是他自己写的还是在网站上找到的，但基本上只是对TKinter`after()`调用的使用。

我们的主循环如下所示：

```
def cmdloop():
    (sread, swrite, sexc) = select.select( [sock], [], [], 0)
    for s in sread:
        ...
        ...
        ...
    app.after(500,cmdloop) 
```

那半秒的休息让文本框调用`inputBox.bind('<Return>', sendMsg)`（以及等待在套接字中发送的消息）正常工作。`sendMsg()`然后简单地打了个`sock.send()`电话。

```
def sendMsg(event=''):
    message = inputBox.get()
    message += "\n"
    msg = Message(nickname,0,message,None) #Custom Class
    sock.send(pickle.dumps(msg))
    inputBox.delete(0,END)
    return 
```

# wcf - 在经典 ASP 中使用证书身份验证连接到 WCF

> ID：10092266
> 
> 赞同：1
> 
> 时间：2012-04-10T16:03:49.530
> 
> 标签：wcf, authentication, asp-classic, certificate

*我了解 Classic ASP 不是首选语言，应该放弃它。这些当然是我的想法。无论如何，让我们假设这是我唯一的选择。*

# 问题

我有一个用 C# 编写的 WCF Web 服务，托管在一些 uri [https://blah/blah.svc 上](https://blah/blah.svc)。我一直在通过手动形成 SOAP 调用并使用**Server.CreateObject("Msxml2.XMLHTTP.3.0")**发出请求并获得响应来与经典 ASP 客户端交谈。

现在 WCF 服务已更新为使用证书身份验证。我见过客户在 PHP 和 .Net 中使用 cert auth，但我不知道如何使用 Classic ASP 进行连接。

有任何想法吗？

# 我当前的经典 ASP 客户端示例

```
Dim objXMLHTTP : set objXMLHTTP = Server.CreateObject("Msxml2.XMLHTTP.3.0")
Dim strRequest, strResult, strFunction, strURL, strNamespace

strNamespace = "http://tempuri.org/IBlah/test"
strURL = "https://blah/Blah.svc"

strFunction = "test"

strRequest = "<soapenv:Envelope xmlns:soapenv=""http://schemas.xmlsoap.org/soap/envelope/"" xmlns:tem=""http://tempuri.org/"">" _
& "   <soapenv:Header/>" _
& "   <soapenv:Body>" _
& "      <tem:test>" _
& "         <tem:testdata>" & testdata & "</tem:testdata>" _
& "      </tem:test>" _
& "   </soapenv:Body>" _
& "</soapenv:Envelope>"

objXMLHTTP.open "post", strURL, False

objXMLHTTP.setRequestHeader "Content-Type", "text/xml; charset=utf-8"

objXMLHTTP.setRequestHeader "SOAPAction", strNamespace

'send the request and capture the result
Call objXMLHTTP.send(strRequest)
response = objXMLHTTP.responseText 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-10T16:15:38.987

如果有可能 - 而不是在 ASPX 页面中构建它，请使用“代理”，这是一种您可以通过 Ajax 发布您的请求的方法，该方法反过来将与下游服务通信并向您发送回响应。

在这种情况下，您的代理（应用程序）可能是使用 WCF 客户端的 MVC 应用程序。

手工制作加密的 SOAP 消息很困难，特别是在 Ajax 中。

# jquery - IE7 中的 jQuery 动画和调整图像大小

> ID：10092267
> 
> 赞同：0
> 
> 时间：2012-04-10T16:03:49.543
> 
> 标签：jquery, animation, internet-explorer-7, jquery-animate

我会尽量保持它尽可能简单，因为我认为它有几个部分。

我正在创建一些 Javascript，它将获取许多图像，在它们之间进行动画处理，并在图像成为焦点时显示一些补充信息，例如价格、卧室、浴室。

我遇到的主要问题是这段代码一切正常，但是当图像本身实际调整大小时，它在 IE7 中不稳定。

你可以在这里看到演示：http: [//proofs.issl.co.uk/rrv4/](http://proofs.issl.co.uk/rrv4/)

（我现在已经删除了背景和前景演示图像，因此图像损坏，但这与这部分无关。）

我开始认为对于 IE7 动画缓慢我无能为力。以前的情况是滑动移动和图像调整大小都很不稳定，但我改变了幻灯片的工作方式（设置位置：相对和动画左：而不是动画左边距:)​​，这似乎有助于很多（出于某种原因）。

但是我想不出任何类似的方法来帮助图像上的动画。

我什至尝试将动画时间加倍，但似乎没有任何区别 - 它们仍然不稳定，只是更慢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-10T16:08:11.503

你可能不走运。IE7 的 javascript 引擎和渲染引擎不会让这看起来很流畅。

如果它困扰您（并且困扰我），您可以删除 IE7 的动画，因为突然调整大小可能仍然具有相同的抖动。

无论哪种方式，这正是您使用 IE7 所获得的。

# python - shutil 不存储随机选择/复制文件的路径？

> ID：10092268
> 
> 赞同：1
> 
> 时间：2012-04-10T16:03:54.850
> 
> 标签：python, shutil

[编辑：见下面的最终代码] 我正在使用下面的代码从源目录中随机选择 5 个文件，然后将它们复制到新目录。它给了我一个 IO 错误，其中显示“没有这样的文件或目录 'x' 存在”，其中“x”是没有目录路径的文件名。不知何故，它没有将路径存储在“文件”中。我查看了这个论坛以及一个shutil教程，但我无法弄清楚。（顺便说一句，这类似于我之前提出的问题，但代码和错误发生了变化。当我得到它的工作时，我会将最终代码发布到该问题）。提前致谢！

```
import os
import shutil
import random
import os.path

src_dir = 'C:\\'
target_dir = 'C:\\Test'
src_files = (os.listdir(src_dir))
def valid_path(dir_path, filename):
    full_path = os.path.join(dir_path, filename)
    return os.path.isfile(full_path)  
files = [f for f in src_files if valid_path(src_dir, f)]
choices = random.sample(files, 5)
for files in choices:
    shutil.copyfile(files, target_dir)
    print ('Finished!') 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-10T16:07:48.773

`os.listdir()`仅返回文件名。您将需要使用`os.path.join()`来加入他们的路径。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-10T16:07:58.650

当你时`src_files = os.listdir(src_dir)`，你得到的只是一个文件名列表。然后你 enumerate `[f for f in src_files if valid_path()]`，只保留一个文件名列表。

当你 finally 时`shutil.copyfiles(files, target_dir)`，你仍然只传递文件名列表，而不是整个路径。

```
files = [os.path.join(src_dir, f) for f in src_files if valid_path(src_dir, f)] 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-10T16:08:31.023

尝试改变

`shutil.copyfile(files, target_dir)`

到

`shutil.copyfile(os.path.join(src_dir, files), target_dir)`

您仅使用`src_dir`来测试完整路径是否有效，然后您不再使用它。

**编辑**：考虑以下

```
src_dir = 'C:\\'
target_dir = 'C:\\Test'
# Create a list of filenames
src_files = (os.listdir(src_dir)) 
# Create a list of full paths (valid)
src_paths = [f for f in [os.path.join(src_dir, f) for f in src_files] if os.path.isfile(f)]
# Do selection
choices = random.sample(src_paths, 5)
for path in choices:
    print path
    shutil.copy(path, target_dir)
    print ('Finished!') 
```

请注意，由于您指定的是目标*目录*而不是目标文件，因此我更改`copyfile`为。`copy`

 *您还可以在字符串之前添加前导`r`以使它们成为[原始字符串](http://docs.python.org/reference/lexical_analysis.html)，以避免必须转义反斜杠：

```
dir = 'C:\\Temp\\' # Is the same as
dir = r'C:\Temp\' 
```

但是 SO 语法荧光笔不喜欢它所以我把它拿出来了*

# android - 为什么添加的视图没有出现在屏幕上？

> ID：10092271
> 
> 赞同：0
> 
> 时间：2012-04-10T16:04:08.390
> 
> 标签：android

查看下面的代码片段，它适用于 android

```
TableLayout tbL = (TableLayout) findViewById(R.id.moreInfo_table);

`tbL.addView(getRow(key, value), new TableLayout.LayoutParams
                      (TableLayout.LayoutParams.FILL_PARENT,TableLayout.LayoutParams.WRAP_CONTENT));
private TableRow getRow(String key, String value) {
    TableRow tbR = new TableRow(this);
    try {
        TextView keyTV = new TextView(this);
        keyTV.setText("Key " );
        keyTV.setTextColor(Color.WHITE);
        keyTV.setGravity(Gravity.CENTER_VERTICAL | Gravity.LEFT);
        keyTV.setTextSize(18.0F);
        TextView valueTV = new TextView(this);
        valueTV.setText("Value " );
        valueTV.setTextColor(Color.WHITE);
        valueTV.setGravity(Gravity.CENTER_VERTICAL | Gravity.LEFT);
        valueTV.setTextSize(18.0F);     
        tbR.addView(keyTV,new TableLayout.LayoutParams
                  (TableLayout.LayoutParams.WRAP_CONTENT,TableLayout.LayoutParams.WRAP_CONTENT));
        tbR.addView(valueTV,new TableLayout.LayoutParams
                  (TableLayout.LayoutParams.WRAP_CONTENT,TableLayout.LayoutParams.WRAP_CONTENT));
        } catch (Exception e) {
        e.printStackTrace();            
    }       
    return tbR;
}` 

问题出在哪里？？？？？？！！！

            回答 #1

赞同：0

时间：2012-04-10T16:26:50.297

一旦尝试更改文本颜色；；

```
keyTV.setTextColor(Color.WHITE); 
```

至

```
 keyTV.setTextColor(Color.BLUE); 
```

可能是您的视图正在出现，但由于白色不可见。

            回答 #2

赞同：0

时间：2012-04-11T07:36:28.117

这是完整的xml文件

```
<?xml version="1.0" encoding="utf-8"?>
<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="fill_parent"
    android:layout_height="fill_parent" >

    <TextView
        android:id="@+id/recipeName_view"
        android:layout_width="fill_parent"
        android:layout_height="wrap_content"
        android:layout_alignParentLeft="true"
        android:layout_alignParentTop="true"
        android:gravity="center"
        android:text="Recipe Name..."
        android:textSize="24sp" />
    <TabHost
        android:id="@+id/tabhost"
        android:layout_width="fill_parent"
        android:layout_height="wrap_content"
        android:layout_above="@+id/vidThums"
        android:layout_below="@+id/recipeName_view" >

        <LinearLayout
            android:id="@+id/linearLayout1"
            android:layout_width="match_parent"
            android:layout_height="match_parent"
            android:orientation="vertical" >

            <TabWidget
                android:id="@android:id/tabs"
                android:layout_width="match_parent"
                android:layout_height="wrap_content" >
            </TabWidget>

            <FrameLayout
                android:id="@android:id/tabcontent"
                android:layout_width="match_parent"
                android:layout_height="match_parent" >

                <ScrollView
                    android:id="@+id/descr"
                    android:layout_width="fill_parent"
                    android:layout_height="wrap_content"
                    android:layout_above="@+id/vidThums"
                    android:layout_below="@+id/ingVu" >

                    <LinearLayout
                        android:layout_width="fill_parent"
                        android:layout_height="wrap_content"
                        android:orientation="vertical" >

                        <TextView
                            android:id="@+id/descriptionView"
                            android:layout_width="fill_parent"
                            android:layout_height="wrap_content"
                            android:text="The name came from ..., and so forth"
                            android:textSize="24sp" />
                    </LinearLayout>
                </ScrollView>

                <LinearLayout
                    android:id="@+id/ingDet"
                    android:layout_width="fill_parent"
                    android:layout_height="wrap_content"
                    android:layout_above="@+id/vidThums"
                    android:layout_below="@+id/ingVu"
                    android:orientation="vertical" >

                    <ListView
                        android:id="@+id/ingridientsList"
                        android:layout_width="fill_parent"
                        android:layout_height="wrap_content"
                        android:layout_marginLeft="10dp"
                        android:layout_marginRight="5dp"
                        android:layout_weight=".50"
                        android:cacheColorHint="#00000000"
                        android:clickable="true"
                        android:divider="@drawable/list_divider1"
                        android:dividerHeight="20dp"
                        android:drawSelectorOnTop="false"
                        android:listSelector="@drawable/list_sel1"
                        android:scrollbars="vertical"
                        android:soundEffectsEnabled="true" />
                </LinearLayout>

                <LinearLayout
                    android:id="@+id/prepMethod"
                    android:layout_width="fill_parent"
                    android:layout_height="wrap_content"
                    android:layout_above="@+id/vidThums"
                    android:layout_below="@+id/ingVu"
                    android:orientation="vertical" >

                    <ListView
                        android:id="@+id/prepMethodList"
                        android:layout_width="fill_parent"
                        android:layout_height="wrap_content"
                        android:layout_marginLeft="10dp"
                        android:layout_marginRight="5dp"
                        android:cacheColorHint="#00000000"
                        android:clickable="true"
                        android:divider="@drawable/list_divider1"
                        android:dividerHeight="20dp"
                        android:drawSelectorOnTop="false"
                        android:listSelector="@drawable/list_sel1"
                        android:scrollbars="vertical"
                        android:soundEffectsEnabled="true" />
                </LinearLayout>

                <TableLayout
                    android:id="@+id/moreInfo_table"
                    android:layout_width="fill_parent"
                    android:layout_height="fill_parent"
                    android:background="@drawable/list_selector2"
                    android:scrollbars="vertical"
                    android:stretchColumns="0,1" >

                    <TableRow>

                        <TextView
                            android:layout_width="wrap_content"
                            android:layout_height="wrap_content"
                            android:text="@string/noOfPersons" />

                        <TextView
                            android:id="@+id/noPers_view"
                            android:layout_width="wrap_content"
                            android:layout_height="wrap_content"
                            android:text="@string/noOfPersons" />
                    </TableRow>

                    <TableRow>

                        <TextView
                            android:layout_width="wrap_content"
                            android:layout_height="wrap_content"
                            android:text="@string/rating" />

                        <RatingBar
                            android:id="@+id/recipRatingBar_details"
                            style="?android:attr/ratingBarStyleSmall"
                            android:layout_width="wrap_content"
                            android:layout_height="wrap_content"
                            android:layout_gravity="center"
                            android:layout_marginBottom="2dp"
                            android:layout_marginTop="5dp"
                            android:numStars="5"
                            android:rating="3"
                            android:stepSize="0.5" />
                    </TableRow>

                    <TableRow>

                        <TextView
                            android:layout_width="wrap_content"
                            android:layout_height="wrap_content"
                            android:text="@string/prepTime" />

                        <TextView
                            android:id="@+id/prepTime_view"
                            android:layout_width="wrap_content"
                            android:layout_height="wrap_content"
                            android:text="20" />

                        <TextView
                            android:layout_width="wrap_content"
                            android:layout_height="wrap_content"
                            android:text="@string/minutes" />
                    </TableRow>

                    <TableRow>

                        <TextView
                            android:layout_width="wrap_content"
                            android:layout_height="wrap_content"
                            android:text="@string/noOfRater" />

                        <TextView
                            android:id="@+id/noOfRater_view"
                            android:layout_width="wrap_content"
                            android:layout_height="wrap_content"
                            android:text="20" />
                    </TableRow>
                </TableLayout>

                <LinearLayout
                    android:id="@+id/rating_tab"
                    android:layout_width="fill_parent"
                    android:layout_height="wrap_content"
                    android:layout_above="@+id/vidThums"
                    android:layout_below="@+id/ingVu"
                    android:orientation="vertical" >

                    <TextView
                        android:layout_width="fill_parent"
                        android:layout_height="wrap_content"
                        android:gravity="center_horizontal|left"
                        android:text="@string/raterGuid"
                        android:textSize="18sp" />

                    <RatingBar
                        android:id="@+id/recipRatingBar_rate"                        
                        android:layout_width="wrap_content"
                        android:layout_height="wrap_content"
                        android:layout_gravity="left"
                        android:layout_marginBottom="2dp"
                        android:layout_marginTop="5dp"
                        android:numStars="5"
                        android:rating="0"
                        android:stepSize="0.5" />

                    <Button
                        android:layout_width="wrap_content"
                        android:layout_height="wrap_content"
                        android:gravity="center"
                        android:text="@string/submit"
                        android:textSize="18sp" />
                </LinearLayout>
            </FrameLayout>
        </LinearLayout>
    </TabHost>

    <HorizontalScrollView
        android:id="@+id/vidThums"
        android:layout_width="fill_parent"
        android:layout_height="wrap_content"
        android:layout_alignParentBottom="true"
        android:layout_alignParentLeft="true" >

        <LinearLayout
            android:id="@+id/videoThumsHolder"
            android:layout_width="fill_parent"
            android:layout_height="wrap_content" >
        </LinearLayout>
    </HorizontalScrollView>

</RelativeLayout> 
```

```

# c# - 视频文件转换引擎的OOP设计

> ID：10092272
> 
> 赞同：0
> 
> 时间：2012-04-10T16:04:13.427
> 
> 标签：c#, oop, video

我正在设计一个视频文件转换引擎。

有不同的来源（带有开始/结束时间码的文件、播放列表文件、描述输入文件的各种文本/XML 文件以及应用于这些文件的视频/音频效果，...）。

有不同的输出（文件或命令文本文件）。

可以运行不同的工具（主要是 dos 命令）来进行转换。

我想设计一个遵循开放/封闭原则的引擎，以轻松添加/修改新源或新输出。

我想避免有太多的类，所以我认为继承不是一个选择。

我想过创建一个中心类转换器。

引擎将从源创建此 Converter 类并将源转换为输出。

我不知道这是否是一个好方法。

我查看了策略模式，但同样，我不确定这是使用合适的模式。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-10T16:23:18.333

我看到了两种主要的方法来解决这个问题，都基于策略模式：

1.  为输入和输出的每个排列创建一个类，该类将在所述输入和输出之间进行转换，然后将它们放入具有中央转换器类的策略模式中，该类可以从它找到或给出的实现集合中选择正确的实现。

    *   好处是简单，每个现有的实现一旦工作，都应该“关闭”以根据添加额外的输入或输出类型进行更改。
    *   缺点是对于 5 个输入和 2 个输出，您需要 10 个实现。添加第三个输出需要再开发 5 个类，每个输入一个。你也可能会经常重复自己；考虑让所有这些类都派生自一个抽象基础，您可以使用它来将公共代码“拉起”到一个地方。
2.  为每个输入创建一个类，该类可以将该特定输入转换为某种中间的内存格式，其中包含生成任何输出所需的所有信息。然后，为每个输出创建一个类，该类将在给定任何给定输入转换产生的中间值的情况下产生所述输出。将所有这些放入一个中央转换器中，该转换器将根据特定情况的需要“混合和匹配”输入和输出转换。

    *   好处是添加新的输出类型不需要您创建与输入类型一样多的实现，反之亦然。您的重复代码也更少；有一种方法可以将任何给定的输入转换为中间体，还有一种方法可以将中间体转换为给定的输出，因此您不应该发现自己在两个不同的实现中进行相同的方法调用（尽管实现仍然可以从抽象派生基础以允许共享代码）。
    *   缺点是内部复杂性增加，对变化更敏感。中介类型是必需的，尽管您的代码之外的任何东西都不会使用它，并且如果需要存储在中介中的信息量发生变化（比如支持需要比您当前从输入中提供的更多信息的新输出） )，您将需要返回并更改现有的工作代码以添加另一端所需的新数据。

哪一个更适合你，取决于你预测这个系统必须经历什么样的变化。如果您预见到要添加新类型的输入或输出，中介将是更好的模式，因为它减少了类数（5 个输入，3 个输出是 8 个转换器而不是 15 个）；但是，您需要确保中介也遵循开放/封闭原则，因此可以添加必须提供或使用新数据的输入或输出的新实现，并扩展中介，而不会彻底破坏现有实现或确保输入和输出的组合不兼容。如果您预见到数据的类型或数量，您需要改变的不仅仅是获取或输出它的方式，或者如果您预见到每个输入和输出之间的转换过程会有如此巨大的不同，那么

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-10T16:34:20.447

根据皮埃尔的评论更新：

定义一个通用转换器如下：

```
public interface IVideoConverter
{
     IInputReader  Reader {get;set;}
     IOutputWriter Writer {get;set;}
     void Convert();
} 
```

定义接口：

```
public interface IInputReader
{
    bool IsSUpported(string inputId);

    void AppendToBuffer(Buffer buffer);
}

public interface IOutputWriter
{
    bool IsSUpported(string outputId);

    void WriteFromBuffer(Buffer buffer);
} 
```

编写实现转换器的类：

```
public class VideoConverter : IVideoConverter
{
   ...       
} 
```

写3个工厂：

```
public class InputReaderFactory
{
   public IInputReader GetReader(string inputId)
   {
       ...
   }
}

public class OutputWriterFactory
{
   public IOutputWriter GetWriter(string outputId)
   {
      ...
   }
}

public class VideoConverterFactory
{
   public IVideoConverter GetConverter(string inputId, string outputId)
   {
      ...
   } 
} 
```

在每个工厂中，使用您想要构建工厂负责的实例的任何方法。VideoConverterFactory 应该使用读取器和写入器工厂

有几种方法可以实现具体的类型初始化。我将描述2：

a) 创建一个静态只读数组或所有受支持类型的列表，并在此列表中搜索支持给定输入参数的第一个转换器。

```
 public class InputReaderFactory
 {
   private static readonly IEnumerable<IInputReader> SupportedReaders = new IInputReader[] {new Reader1(), new Reader2(),....}
   public IInputReader GetReader(string inputId)
   {
      for(int i=0; i<SupportedReaders .length; i++)
      {
        if(SupportedReaders [i].IsSupported(inputId)
          return SupportedReaders [i];
      }

      return null;
   }
} 
```

b）在配置文件中定义支持的类型（实现配置元素，配置集合和部分），并在工厂类中从配置中搜索支持的转换器，当找到一个时，使用反射创建一个实例

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-10T16:19:04.357

您可能需要模式组合以及非模式代码的一些实际应用。策略模式非常适合填写“我如何加载/编写这个？”。复合图案适用于“将这些元素缝合在一起”或“做这种过渡效果”。装饰器模式非常适合在视频之上应用效果。

症结在于提供一个通用接口，您可以以有意义的方式实现和装饰。如果不知道更多关于您希望实施的行为，很难说。

# c++ - 真的对 C++ 多线程感到困惑

> ID：10092277
> 
> 赞同：1
> 
> 时间：2012-04-10T16:04:23.493
> 
> 标签：c++, linux, multithreading, gtk

我正在尝试用 C++ 编写一些多线程代码，但我似乎无处可去。我做了一些研究，但我很难找到一些基本的例子来告诉我如何实现我所需要的。我正在Linux中的Gtk应用程序上工作，每次有一个耗时的操作，比如加载文件，GUI锁定（如果我尝试移动它，所有控件等都会消失，只留下空白窗口）。这显然可以通过线程解决，但我不知道从哪里开始寻找。我应该使用 pthread、C++ 线程、boost::Thread、Glib::Thread 吗？使用上述任何一种方法的区别和原因是什么？

我的目标是有一个消息对话框，甚至是一个进度条对话框，它会在后台运行操作时显示。基本上任何东西都会在完成工作时让 GUI 做出响应。我真的很感激一些例子或一些源代码的链接来学习。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-10T16:17:08.397

现在有一个标准线程库，所以如果你的编译器支持它，你应该使用它。

如果您坚持使用旧的编译器，那么 Boost.Thread 是最佳选择，因为它与标准库非常相似，因此当您更新编译器时转换会很简单。

但是，最好还是坚持一个线程，并使用异步 I/O 来避免阻塞。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-10T16:24:42.997

当您使用 GTK 时，您需要考虑一些事项。GTK 是线程感知的，但不是线程安全的。它提供了一个由 gdk_threads_enter() 和 gdk_threads_leave() 控制的全局锁，可以保护 GTK+ 的所有使用。也就是说，在任何给定时间，只有一个线程可以使用 GTK+。回调需要一些注意。来自 GTK+（信号）的回调是在 GTK+ 锁内进行的。然而，来自 GLib 的回调（超时、IO 回调和空闲函数）是在 GTK+ 锁之外进行的。因此，在信号处理程序中您不需要调用 gdk_threads_enter()，但在其他类型的回调中，您可以这样做。

阅读本文了解更多信息：

[http://blogs.operationaldynamics.com/andrew/software/gnome-desktop/gtk-thread-awareness](http://blogs.operationaldynamics.com/andrew/software/gnome-desktop/gtk-thread-awareness)

[http://www.yolinux.com/TUTORIALS/GTK+ProgrammingTips.html](http://www.yolinux.com/TUTORIALS/GTK+ProgrammingTips.html)

[http://developer.gnome.org/gtk-faq/stable/x481.html](http://developer.gnome.org/gtk-faq/stable/x481.html)

您可能需要的线程类型是普通的工作线程。当工作在后台完成时，它会让 gui 做出响应。然后，gui 可以控制工作线程，还可以通过基于计时器的检查工作线程的进度来检查工作线程的工作并更新到进度条或显示消息对话框。

在这里查看一些关于 linux 上 c++ 中的通用多线程的教程：

[http://www.tidytutorials.com/2010/06/linux-c-socket-example-with-client.html](http://www.tidytutorials.com/2010/06/linux-c-socket-example-with-client.html)

[http://www.yolinux.com/TUTORIALS/LinuxTutorialPosixThreads.html](http://www.yolinux.com/TUTORIALS/LinuxTutorialPosixThreads.html)

[http://programming-in-linux.blogspot.jp/2008/03/multithreading-example-in-cc-using.html](http://programming-in-linux.blogspot.jp/2008/03/multithreading-example-in-cc-using.html)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-04-10T16:16:59.890

这真的取决于你工作的环境。

如果可能，请使用标准库线程功能。它需要一个最近的编译器（实际上我不确定 GCC 是否已经实现了它） *，*但*如果*它可用，请使用它。

这是一个非常好的 API，而且它是标准的和可移植的。

我认为 POSIX 是一种最后的手段。它是 *nix 系统上最低级别的公分母，但它不是一个很好的 API。您提到的所有其他人基本上都是对此的包装。另一方面，您避免了第三方依赖项。

我没有使用过 Glib::Thread，但我对 Glib 的体验是它......有点恶心。

如果标准库线程不可用，我首选的库是 Boost 的。它是一个非常相似的 API `std::thread`（后者是在 Boost.Thread 之后建模的），而且效果非常好。

当然，缺点是它意味着依赖于第三方库。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-04-10T16:20:57.770

c++ 中的线程在 C++11 之前是依赖于平台的（例如 pthreads 与 windows 线程），因为通常需要与内核交互。boost:Thread 是独立于平台的方式（它在引擎盖下执行与平台相关的东西）或 C++11 ，如果您可以访问它，也支持线程（基于 boost::thread）。

如果您不关心您正在使用的平台以外的任何平台，那么我在 linux 上使用了 pthreads，在 Windows 上使用了常规的 win32 线程，这两种线程都非常容易启动和运行。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-04-10T16:19:43.793

我从未使用过 Gtk，但是查看[GTK+ 编程技巧](http://www.yolinux.com/TUTORIALS/GTK+ProgrammingTips.html)，似乎[GDK 线程](http://www.yolinux.com/TUTORIALS/GDK_Threads.html)是最合适的选择。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-04-15T04:30:47.210

win32 API 和 UNIX 的最佳学习方式（需要运行大量示例代码）。

[WIN32 和 UNIX 线程和信号量](http://msdn.microsoft.com/en-us/library/ie/ms811896.aspx)

# model-view-controller - 我可以使用路由器在backbone.js 中加载模型和视图吗？

> ID：10092281
> 
> 赞同：0
> 
> 时间：2012-04-10T16:04:45.380
> 
> 标签：model-view-controller, backbone.js, router

我可以使用路由器浏览视图并根据路由加载模型吗？如果可能的话，有人可以为这种情况编写路由器代码吗？

在此先感谢您的帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-11T03:19:24.073

当然可以。路由器应该设置您的 Backbone 应用程序的当前状态，即它们应该设置视图和模型。

我给你写了一个[粗略的例子](http://jsfiddle.net/joshleitzel/7cBh6/)，但你可以得到要点。与 Backbone 中的大多数事情一样，有不止一种方法可以做到这一点。我个人不会采用我演示的方法，因为它需要视图知道路由器的存在。更合适的是创建一个事件驱动模型，其中视图触发事件，路由器监听它们。当路由器从视图中拾取新事件时，它可以`navigate`适当地，导航功能可以调用适当的视图机制。

# node.js - 使用 Node.JS 将文件保存到 MongoDB GridFS

> ID：10092282
> 
> 赞同：1
> 
> 时间：2012-04-10T16:04:46.203
> 
> 标签：node.js, mongodb, gridfs

你如何把 close() 放在 writeBuffer 回调中？

这个问题涉及： [MongoDB GridFS 使用 Node.JS 保存文件的问题](https://stackoverflow.com/questions/6936396/problem-with-mongodb-gridfs-saving-files-with-node-js)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-18T19:26:55.677

一个简单的例子是

[https://github.com/mongodb/node-mongodb-native/blob/master/test/gridstore/grid_store_test.js#L97](https://github.com/mongodb/node-mongodb-native/blob/master/test/gridstore/grid_store_test.js#L97)

还要检查文档以了解行为的变化，writeBuffer 已被删除，因此只需使用 write。

[http://mongodb.github.com/node-mongodb-native/](http://mongodb.github.com/node-mongodb-native/)

# zend-framework - Zend Framework ACL 用于站点的管理部分

> ID：10092284
> 
> 赞同：0
> 
> 时间：2012-04-10T16:04:53.457
> 
> 标签：zend-framework, zend-acl

好的，所以我的 zf 应用程序带有一个用户登录系统，如果凭据在数据库中，该系统会将人引导到受限区域。但是，我希望使用相同的登录表单来检查用户角色是否为管理员（在数据库中）以及是否将他们引导到管理员部分......我正在努力了解如何使用 Zend_Acl 执行此操作。此外，ACL 的唯一用途是允许具有 admin 角色的用户进入 admin 部分，我对 ZF 还很陌生，所以我不确定最好的方法是什么。这是我当前的 AuthController 代码

[http://codepaste.net/6hzydv](http://codepaste.net/6hzydv)

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-10T16:28:52.353

您可以创建一个控制器插件，该插件将根据用户的角色决定用户是否有权访问控制器/视图。就像是：

```
class My_Controller_Plugin_Auth extends Zend_Controller_Plugin_Abstract
{
    public function preDispatch(Zend_Controller_Request_Abstract $request)
    {
        $auth = Zend_Registry::getInstance()->get('auth');
        $acl = new Zend_Acl();

        // for default module
        if ($request->getModuleName() == 'default') {

            // access resources (controllers)
            // usually there will be more access resources
            $acl->add(new Zend_Acl_Resource('index'));
            $acl->add(new Zend_Acl_Resource('error'));

            // access roles
            $acl->addRole(new Zend_Acl_Role('guest'));
            $acl->addRole(new Zend_Acl_Role('user'));
            $acl->addRole(new Zend_Acl_Role('administrator'));

            // access rules
            $acl->allow('guest'); // allow guests everywhere
            $acl->allow('user'); // allow users everywhere
            $acl->allow('administrator'); // allow administrators everywhere

            $role = ($auth->getIdentity() && $auth->getIdentity()->status = 'approved')
            ? $auth->getIdentity()->role : 'guest';
            $controller = $request->getControllerName();
            $action = $request->getActionName();

            if (!$acl->isAllowed($role, $controller, $action)) {
                $redirector = Zend_Controller_Action_HelperBroker::getStaticHelper('Redirector');
                $redirector->gotoUrlAndExit('error/denied');
            }

        }
        // for member module
        else if ($request->getModuleName() == 'member') {

            // access resources (controllers)
            // usually there will be more access resources
            $acl->add(new Zend_Acl_Resource('index'));
            $acl->add(new Zend_Acl_Resource('error'));

            // access roles
            $acl->addRole(new Zend_Acl_Role('guest'));
            $acl->addRole(new Zend_Acl_Role('user'));
            $acl->addRole(new Zend_Acl_Role('administrator'));

            // access rules
            $acl->allow('user'); // allow users everywhere
            $acl->allow('administrator'); // allow administrators everywhere

            $role = ($auth->getIdentity() && $auth->getIdentity()->status = 'approved')
            ? $auth->getIdentity()->role : 'guest';
            $controller = $request->getControllerName();
            $action = $request->getActionName();

            if (!$acl->isAllowed($role, $controller, $action)) {
                $redirector = Zend_Controller_Action_HelperBroker::getStaticHelper('Redirector');
                $redirector->gotoUrlAndExit('error/denied');
            }

        }
        // for admin module
        else if ($request->getModuleName() == 'admin') {

            // access resources (controllers)
            // usually there will be more access resources
            $acl->add(new Zend_Acl_Resource('index'));
            $acl->add(new Zend_Acl_Resource('error'));

            // access roles
            $acl->addRole(new Zend_Acl_Role('guest'));
            $acl->addRole(new Zend_Acl_Role('user'));
            $acl->addRole(new Zend_Acl_Role('administrator'));

            // access rules
            $acl->allow('administrator'); // allow administrators everywhere

            $role = ($auth->getIdentity() && $auth->getIdentity()->status = 'approved')
            ? $auth->getIdentity()->role : 'guest';
            $controller = $request->getControllerName();
            $action = $request->getActionName();

            if (!$acl->isAllowed($role, $controller, $action)) {
                $redirector = Zend_Controller_Action_HelperBroker::getStaticHelper('Redirector');
                $redirector->gotoUrlAndExit('error/denied');
            }

        }
    }
} 
```

您可以在此处查看分步教程：http: [//blog.richardknop.com/2009/06/user-login-and-authentication-with-zend_auth-and-zend_acl/](http://blog.richardknop.com/2009/06/user-login-and-authentication-with-zend_auth-and-zend_acl/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-11T04:15:14.643

阅读[Zend Acl](http://framework.zend.com/manual/1.11/en/zend.acl.html)上的文档并了解如何授予权限并按用户类型继承它们。然后查看这个[关于 Zend Acl 和 MVC 的相当简单的 Zend 教程](http://devzone.zend.com/1258/zend_acl-and-mvc-integration-part-i-basic-use/)。

基本上你只需要执行以下操作：

1.  在引导程序中的某处设置 ACL 规则
2.  板条箱`error/denied.phtml`（或您正在使用的任何分机）
3.  让`Zend_Controller_Plugin_Acl`为你干脏活

# python - 使用 Windows SDK 构建 Python 包的批处理脚本

> ID：10092287
> 
> 赞同：3
> 
> 时间：2012-04-10T16:04:58.030
> 
> 标签：python, windows, build, winapi

我目前正在按照*[Compiling 64-bit extension modules on Windows](http://wiki.cython.org/64BitCythonExtensionsOnWindows)*中的说明在 Windows 上构建 64 位扩展。

我想编写这个脚本，所以我不必每次都打开 Windows SDK 命令外壳，所以我有一个批处理文件：

```
setlocal EnabledDelayedExpansion
CALL "C:\Program Files\Microsoft SDKs\Windows\v7.0\Bin\SetEnv.cmd" /x64 /release
set DISTUTILS_USE_SDK=1
\path\to\python.exe \path\to\setup.py bdist --format=msi 
```

但是，我得到了这些错误。我如何`cl.exe`重回正轨？

```
Could not locate executable cl.exe
Executable cl.exe does not exist 
```

公平的警告，我对在 Windows 上构建扩展知之甚少，从这篇文章中可以明显看出，所以如果有的话，请提出更好的方法。

**编辑：**对 SetEnv.cmd 的原始调用确实会引发错误。

```
The x64 compilers are not currently installed.
Please go to Add/Remove Programs to update your installation.
.
Setting SDK environment relative to C:\Program Files\Microsoft SDKs\Windows\v7.0
.
The system cannot find the batch label specified - Set_x64 
```

然后，我根据系统路径使用的各种命令会出现一些错误（例如，对 git 的子进程调用它找不到 git）。

CL.exe 安装在此处`C:\Program Files (x86)\Microsoft Visual Studio 9.0\VC\Bin\amd64\cl.exe`。如果我只是通过快捷方式打开 Windows SDK Cmd Shell 并从这里按通常的方式安装，就可以找到它。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-11T03:35:57.310

为了子孙后代。这按预期工作。但是，我的批处理文件中有一个错字。如果将第一行替换为

```
setlocal EnableDelayedExpansion 
```

一切都按预期工作。问题是！PATH！在 SetEnv.cmd 中没有正确展开。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-10T16:32:45.300

我对这个问题的解决方案是使用 Python 脚本——这对我来说比 Windows 批处理脚本容易得多。您可以使用[subprocess](http://docs.python.org/library/subprocess.html)模块来调用其他程序，它将使您的环境变量保持不变，除非您明确更改它们。

顺便说一句，[Cython](http://en.wikipedia.org/wiki/Cython)并不是将 Python 编译为 EXE 文件的唯一方法。您也可以使用像[cz_freeze](http://readthedocs.org/docs/cx_freeze/en/latest/)这样的工具，如果您不需要 Cython 的其他功能，我认为它会稍微容易一些。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-10T16:57:04.820

如果您的系统中安装了 Visual Studio，请在批处理脚本中添加一个步骤以运行`vcvarsall.bat`. 例如，如果安装了 Visual Studio 2010，则此批处理文件应存在于

```
"C:\Program Files (x86)\Microsoft Visual Studio 10.0\VC\vcvarsall.bat", 
```

或者您安装了 Visual Studio 的哪个驱动器，前提是您没有覆盖默认安装位置。

# sql - SQL/sqlite 通配符如何工作？LIKE 运算符

> ID：10092289
> 
> 赞同：0
> 
> 时间：2012-04-10T16:05:08.893
> 
> 标签：sql, sqlite, wildcard, sql-like

通配符如何`sqlite`工作。或者`LIKE`运营商如何匹配。例如，让我们说：

1：`LIKE('s%s%', 's12s12')`
2：`LIKE('asdaska', '%sk%')`

在第一个示例中， % 在 1st **s**之后匹配什么，以及它如何决定在 %之后继续匹配 %**或****s**。 在第二个示例中，如果 s 首先匹配，则返回**FALSE**。 两个示例都返回**TRUE**。根据我的编程知识，我想出 LIKE 函数有点像递归函数，当出现 2 种可能性时，函数使用 2 个不同的参数调用自身并在它们之间使用**OR**，那么显然如果一个调用返回 true，则上层函数直接返回 true。如果是这样，那么 LIKE 运算符在大型数据库上使用起来很慢。PS 还有一个**'_'**通配符正好匹配一个字符 **********我找不到 LIKE 运算符的任何详细文档。**********

 ******* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-10T17:36:45.093

`%`匹配零个或多个字符，`_`恰好匹配一个。

您的第一个模式`'s%s%'`将匹配, `'ss'`, `'s1s'`, `'s1111s'`, `'ss1111'`, 等等。等等。

但是，如果你写`'s_s_'`它会匹配`'s1s1'`，但以上都不匹配。******

# php - 寻找从 facebook graph api 中提取数据的有效方法

> ID：10092290
> 
> 赞同：0
> 
> 时间：2012-04-10T16:05:14.037
> 
> 标签：php, facebook

我最近一直在使用 facebook graph api ，当我使用[https://graph.facebook.com/me/statuses?access_token=](https://graph.facebook.com/me/statuses?access_token=)提取用户的最近状态消息时......我得到的只是一个包含详细信息的长列表关于状态内容，我想拉点喜欢状态的人的名字。

我一直在考虑的当前解决方案是使用 preg match，我想知道你们是否有任何其他建议，

提前致谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-10T16:15:43.390

我不确定您使用的是什么路径，但您可以通过请求更新`likes`连接来获取喜欢特定状态更新的用户列表。

例如，请求[https://graph.facebook.com/10150710880081168/likes](https://graph.facebook.com/10150710880081168/likes)对我来说会产生如下内容：

```
{
  "data": [
    {
      "id": "276700623", 
      "name": "Vikki Carter"
    }, 
    {
      "id": "1514365200", 
      "name": "Darren Bean"
    }, 
    {
      "id": "539760281", 
      "name": "Ian Sidaway"
    }
  ], 
  "paging": {
    "next": "https://graph.facebook.com/10150710880081168/likes?format=json&limit=25&offset=25&__after_id=539760281"
  }
} 
```

您需要状态更新的 ID，还需要`user_status`登录用户的权限。

**编辑：**迭代返回的数据并将用户分配到一个数组中：

```
<?php

$result = $facebook->api('[status_id]/likes');

$names = array();
foreach ($result['data'] as $user) {
    $names[] = $user['name'];
} 
```

您现在应该有一组喜欢相关状态的用户名。

# c - 缺少函数定义的 C 编译

> ID：10092292
> 
> 赞同：1
> 
> 时间：2012-04-10T16:05:23.210
> 
> 标签：c

我一直在关注几个 C 教程，但有一点我不确定我是否理解。一些示例显示了函数原型，但没有函数定义。教程说代码应该可以编译，即使它们不会运行。

它是否正确？缺少函数定义的 C 程序应该可以编译吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-10T16:08:00.857

源代码将仅使用声明进行编译，但如果调用任何函数，则如果函数未在某处定义，则会发生链接器错误。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-10T16:07:19.860

是的，这是正确的。该功能可以将大程序拆分为多个源文件。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-10T16:08:19.687

*函数声明*和函数*定义*有很大区别。要使用一个函数，你必须先声明这个函数，但只有在你使用的函数已经被定义的情况下，你才能编译程序。

C 编译过程是一系列步骤，将一个步骤传递给另一个步骤。在典型的编译过程中，首先运行预处理器，然后编译器为每个源文件生成汇编语言，然后汇编器将该汇编语言转换为机器代码，然后链接器将所有必要的部分放在一起。除非您声明函数，否则编译器步骤通常不会完成，但编译器并不关心函数的实际实现位置 - 它只是生成带有漏洞的汇编语言代码，其中可以放置对实际函数的调用。链接器通过调用实际函数来填补这些漏洞。

因此，您可以声明一个函数，但在另一个文件中定义它，这可能是本教程所做的。但是，您仍然必须在*某处*定义函数，否则您将无法获得完整的可执行二进制文件。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-10T16:16:48.477

是的，有一种叫做*链接*的东西。这是一个解析对不同符号（如变量、函数等）的引用的过程。即使编译器对函数的定义一无所知，它也很高兴。但是，如果编译器知道函数的原型，它可以检查函数是否正确使用，以便及早标记错误。

请参阅[Wikipedia](http://en.wikipedia.org/wiki/Linker_%28computing%29)或 google 以了解有关链接的更多信息。

# iphone - UITableView 懒加载单元格数据

> ID：10092293
> 
> 赞同：5
> 
> 时间：2012-04-10T16:05:22.740
> 
> 标签：iphone, objective-c, uitableview

我需要在我的 UITableView 中实现某种延迟加载。

```
- (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath
{
    //... some initializations here

    //this is a function that pulls my cell data using helper class
    NSData *cellData=[MyDataClass dataForCellAtIndexPath:indexpath.row];

    //... here I populate pulled data to cell

    return cell;
} 
```

一切都很好，**但**表格视图滚动不顺畅，因为`dataForCellAtIndexPath`方法很慢。所以我需要通过调用这个方法来实现将数据延迟填充到单元格中。我期望的结果是表格视图将平滑滚动，但单元格的内容将在绘制单元格后填充一点。请帮帮我，怎么办？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-10T16:20:32.327

是的，您可以考虑将数据收集推送到后台线程。首先要尝试的是最简单的选项，看看它是否能改进任何东西：

```
[MyDataClass performSelectorInBackground:@selector(dataForCellAtIndexPath:) withObject:indexpath.row]; 
```

这篇[文章](https://stackoverflow.com/questions/7055424/ios-start-background-thread)提到了其他一些更复杂的可定制选项，例如[Grand Central Dispatch](https://developer.apple.com/library/ios/#documentation/Performance/Reference/GCD_libdispatch_Ref/Reference/reference.html)和[NSThread](https://developer.apple.com/library/ios/#documentation/Cocoa/Reference/Foundation/Classes/NSThread_Class/Reference/Reference.html)。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-10T16:14:45.227

如果您使用大量数据，我建议将它们保存到`Core-data`和/或用于`NSFetchedResultsController`填充您的 tableView。

它已创建并与您的 tableView 绑定，主要是为了更快地填充您的 tableView 并具有高性能。

这是[NSFetchedResultsController](http://developer.apple.com/library/ios/#documentation/CoreData/Reference/NSFetchedResultsController_Class/Reference/Reference.html)文档的链接！

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-04-10T17:22:05.647

为此，您可以根据表格单元格的索引值加载新数据

您可以设置要加载多少新数据的条件，因为它取决于用户当前检查的单元格。

# ios - 核心数据模型设计 - 反向关系

> ID：10092297
> 
> 赞同：1
> 
> 时间：2012-04-10T16:05:33.223
> 
> 标签：ios, core-data

在为我的应用程序建模实体之间的关系时，我有一个基本的设计问题。Apple doc 指出反向关系对数据库完整性非常重要。我有三个实体，Team，Player，Match，具有以下关系

```
Team <--->> Player
Player <--->> Team 
```

上面的关系很简单，一个 Team 可以有很多玩家，一个 Player 可以属于多个团队。

```
Match:
homeTeam <---> Team
awayTeam <---> Team 
```

在我的 Match 实体中，我有两个属性 homeTeam 和 awayTeam。目前，他们的目的地设置为没有反向关系的团队。尽管应用程序有效，但我不喜欢与团队比赛没有反向关系的事实。因此，我试图弄清楚为 Team 实体设置反向关系的最佳方法是什么。此外，我无法在球队之间建立一对一的反向关系，因为一个球队可以打很多场比赛。所以，我最初的想法是我可以在 Team 中有一个属性匹配，并使它们与 Match 成反比关系。这种情况会奏效吗？或者我是否需要在 Team 中创建两个反向关系属性，例如 homeMatches、awayMatches？

感谢您的任何想法。

贾维德

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-10T16:26:39.673

> 我是否需要在 Team 中创建两个反向关系属性，例如 homeMatches、awayMatches？

是的。反向关系需要反映原始关系。

要了解原因，请考虑如果您的`matches`关系`Team`设置为两者`homeTeam`和`awayTeam`on的倒数，会发生什么情况`Match`：对于关系的一个方向来说，看起来没问题——调用`allStarGame.awayTeam = redTeam`应该添加`aMatch`到`redTeam`' 的`matches`关系中。但是当你反过来做时会发生什么？也就是说，如果您调用`[redTeam addMatchesObject:allStarGame]`，将使用 allStarGame 的哪个关系？它是未定义的......这就是为什么每个关系都需要一个不同的逆。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-10T16:23:28.147

我认为你的 homeMatches, awayMatches 想法应该很好用。

让我感到震惊的另一件事是你的关系，其中一名球员属于不止一支球队。我认为这不应该同时适用于多支球队，这表明您可能需要在中间放置一张桌子（可能称为 RosterEntry）来描述一名球员在一支球队的时间。然后 Team 和 Player 将与 RosterEntry 是一对多的。

# iphone - UIView的方向变化基于两点

> ID：10092303
> 
> 赞同：0
> 
> 时间：2012-04-10T16:06:14.867
> 
> 标签：iphone, math, geometry, rotation

第一次在这里发帖，很棒的网站！

基本上，我试图基于两点旋转 UIImageView。想象这两个点形成一条穿过屏幕的线。我需要 UIImageView 的角度来匹配那条线的角度......

下面是我试图用文字表达的内容的图表：

[http://i40.tinypic.com/t5k2yr.png](http://i40.tinypic.com/t5k2yr.png)

谢谢你的时间！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-12T04:01:51.473

这行得通吗？

```
imageView.transform = CGAffineTransformMakeRotation(atan2(y2-y1,x2-x1)); 
```

# java - GWT 开发和设计模式

> ID：10092308
> 
> 赞同：5
> 
> 时间：2012-04-10T16:06:29.527
> 
> 标签：java, gwt, design-patterns

有经验的程序员在 GWT 上开发时最常用的模式是什么？我听说在这个框架上进行有效的开发往往需要使用不同的设计模式。我想了解更多关于这方面的信息。如果可能，请提供简要说明、示例或链接。提前致谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-10T16:56:07.730

我们使用 MVP：[https](https://developers.google.com/web-toolkit/articles/mvp-architecture) ://developers.google.com/web-toolkit/articles/mvp-architecture 。它非常适合组织大型项目。MVP主要关注客户端组织。

您可以将其与活动和地点结合使用来管理查看历史记录：[https ://developers.google.com/web-toolkit/doc/latest/DevGuideMvpActivitiesAndPlaces](https://developers.google.com/web-toolkit/doc/latest/DevGuideMvpActivitiesAndPlaces)

您的服务器端模式通常会遵循标准的 Java servlet 模型。如果您使用 Hibernate/Objectify 或一些类似的 ORM 解决方案，请查看 GWT RequestFactory。

# asp.net - 通过 ASP.NET MVP3 中的实体框架处理 Advantage 数据库服务器

> ID：10092311
> 
> 赞同：2
> 
> 时间：2012-04-10T16:06:38.137
> 
> 标签：asp.net, asp.net-mvc-3, entity-framework, advantage-database-server

我需要在 ASP.net MVC3 环境中通过实体框架处理 Advantage Database Server(ADS Ver.9.1)。

我已经为此花了将近 2 周的时间 :( 但我仍然找不到答案。

为了获得正确的建议，我将尝试一步一步地展示我是如何以及我做了什么。所以如果你发现我犯了一些错误，或者你知道我可以尝试什么，请给我建议。请..

首先，我在 ADS 中创建了一个 TEST 表。

```
CREATE TABLE TEST ( 
      ID AutoInc,
      Name CIChar( 50 )) IN DATABASE; 
```

并将 ID 定义为主键。

![在此处输入图像描述](../Images/61cbcc62a3459d3f3ef80b9b1efde4f3.png)

我尝试使用控制台应用程序访问此表。

使用 Visual Studio 2010，创建新的控制台应用程序 (C#)

我这样打字

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using Advantage.Data.Provider;

namespace Ads_Console_Test
{
    class Program
    {
        static void Main(string[] args)
        {
            AdsConnection conn = new AdsConnection("Data Source=\\\\10.0.111.4:6262\\20090622\\SHK\\SHK.ADD;ServerType=REMOTE;User ID=AdsSys;Password=XXXXX;");
            AdsCommand cmd;
            AdsDataReader reader;
            int iField;

            try
            {
                // make the connection to the server
                conn.Open();

                // create a command object
                cmd = conn.CreateCommand();

                // specify a simple SELECT statement
                cmd.CommandText = "select * from TEST";

                // execute the statement and create a reader
                reader = cmd.ExecuteReader();

                // dump the results of the query to the console
                while (reader.Read())
                {
                    for (iField = 0; iField < reader.FieldCount; iField++)
                        Console.Write(reader.GetValue(iField) + " ");
                    Console.WriteLine();
                }

                // close the reader (can’t execute other statements
                // on this command or connection) until it is closed
                reader.Close();
                conn.Close();
            }
            catch (AdsException e)
            {
                // print the exception message
                Console.WriteLine(e.Message);
            }

            Console.ReadKey();    
        }
    }
} 
```

并运行，然后它成功连接到 ADS 并获取数据。

![在此处输入图像描述](../Images/cfa6388bd156f9df6ec6661d54b107cd.png)

如您所见，该表有 3 行。

现在，

我将尝试使用实体框架访问 ADS。(MVC3)

我使用 MVC3 框架创建新项目。并选择空模板。

![我使用 MVC3 框架创建新项目。 并选择空模板。](../Images/4d81a8ecd4a6524c8450f5555ea24fb6.png)

并将 Advantage.Data.Provider 添加到 Reference。

![在此处输入图像描述](../Images/a2f30900f0d870b93c0b3437e53119f8.png)

接下来，我修改了 Web.Config(root) 文件，添加了 connectionStrings。

```
<connectionStrings>
    <add name="EFAdsContext" connectionString="Data Source=\\10.0.111.4:6262\20090622\SHK\SHK.ADD;ServerType=REMOTE;User ID=adsSys;Password=XXXXX;
         TrimTrailingSpaces=True;" providerName="Advantage.Data.Provider" />
  </connectionStrings> 
```

而且，我在 Models 文件夹中创建了 3 个类。

1.  EFAdsContext.cs
2.  测试存储库.cs
3.  测试.cs

这是代码，

**1\. EFAdsContext.cs**

```
 using System;
    using System.Collections.Generic;
    using System.Linq;
    using System.Web;
    using System.Data.Entity;

    namespace Ads_test_mvc3.Models
    {
        public class EFAdsContext : DbContext
        {
            public DbSet<TEST> TEST { get; set; }
        }
    } 
```

**2.TestRepository.cs**

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Web;

namespace Ads_test_mvc3.Models
{
    public class TestRepository
    {
        private EFAdsContext context = new EFAdsContext();

        public IQueryable<TEST> test
        {
            get { return context.TEST; }
        }
    }
} 
```

**3\. 测试.cs**

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Web;
using System.ComponentModel.DataAnnotations;

namespace Ads_test_mvc3.Models
{
    public class TEST
    {
        [Key]
        public int ID { get; set; }
        public string Name { get; set; }
    }
} 
```

并将 HomeControllers.cs 创建到 Controllers 文件夹中。

**HomeControllers.cs**

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Web;
using System.Web.Mvc;
using Ads_test_mvc3.Models;

namespace Ads_test_mvc3.Controllers
{
    public class HomeController : Controller
    {
        public ViewResult Index()
        {

            TestRepository tests = new TestRepository();
            int cnt = tests.test.Count();

            ViewBag.cnt = cnt;
            return View();
        }

    }
} 
```

最后为 HomeController 添加视图

/Views/Home/Index.cshtml

```
@{
    ViewBag.Title = "Index";
}

<h2>Index</h2>

Cnt : @ViewBag.cnt 
```

并运行这个应用程序，

![在此处输入图像描述](../Images/92b14c673775fcbdbb78f992f0bfd42c.png)

然后，我收到此错误消息。=3

我知道这是一篇很长的文章，但我尽量写得尽可能详细。

如果有人知道如何解决这个问题，请告诉我。

谢谢！

[堆栈跟踪]

```
[KeyNotFoundException: The given key was not present in the dictionary.]
   System.Collections.Generic.Dictionary`2.get_Item(TKey key) +9619597
   Advantage.Data.Provider.AdsProviderManifest.GetStoreType(TypeUsage edmType) +1150
   System.Data.Entity.ModelConfiguration.Edm.Services.StructuralTypeMappingGenerator.MapTableColumn(EdmProperty property, DbTableColumnMetadata tableColumnMetadata, Boolean isInstancePropertyOnDerivedType, Boolean isKeyProperty) +60
   System.Data.Entity.ModelConfiguration.Edm.Services.PropertyMappingGenerator.Generate(EdmEntityType entityType, IEnumerable`1 properties, DbEntitySetMapping entitySetMapping, DbEntityTypeMappingFragment entityTypeMappingFragment, IList`1 propertyPath, Boolean createNewColumn) +1293
   System.Data.Entity.ModelConfiguration.Edm.Services.EntityTypeMappingGenerator.Generate(EdmEntityType entityType, DbDatabaseMapping databaseMapping) +496
   System.Data.Entity.ModelConfiguration.Edm.Services.DatabaseMappingGenerator.GenerateEntityTypes(EdmModel model, DbDatabaseMapping databaseMapping) +122
   System.Data.Entity.ModelConfiguration.Edm.Services.DatabaseMappingGenerator.Generate(EdmModel model) +30
   System.Data.Entity.DbModelBuilder.Build(DbProviderManifest providerManifest, DbProviderInfo providerInfo) +189
   System.Data.Entity.DbModelBuilder.Build(DbConnection providerConnection) +58
   System.Data.Entity.Internal.LazyInternalContext.CreateModel(LazyInternalContext internalContext) +62
   System.Data.Entity.Internal.RetryLazy`2.GetValue(TInput input) +117
   System.Data.Entity.Internal.LazyInternalContext.InitializeContext() +453
   System.Data.Entity.Internal.InternalContext.GetEntitySetAndBaseTypeForType(Type entityType) +18
   System.Data.Entity.Internal.Linq.InternalSet`1.Initialize() +57
   System.Data.Entity.Internal.Linq.InternalSet`1.get_InternalContext() +15
   System.Data.Entity.Infrastructure.DbQuery`1.System.Linq.IQueryable.get_Provider() +37
   System.Linq.Queryable.Count(IQueryable`1 source) +50
   Ads_test_mvc3.Controllers.HomeController.Index() in C:\Users\mark\Documents\Visual Studio 2010\Projects\Ads_test_mvc3\Ads_test_mvc3\Controllers\HomeController.cs:20
   lambda_method(Closure , ControllerBase , Object[] ) +62
   System.Web.Mvc.ActionMethodDispatcher.Execute(ControllerBase controller, Object[] parameters) +17
   System.Web.Mvc.ReflectedActionDescriptor.Execute(ControllerContext controllerContext, IDictionary`2 parameters) +208
   System.Web.Mvc.ControllerActionInvoker.InvokeActionMethod(ControllerContext controllerContext, ActionDescriptor actionDescriptor, IDictionary`2 parameters) +27
   System.Web.Mvc.<>c__DisplayClass15.<InvokeActionMethodWithFilters>b__12() +55
   System.Web.Mvc.ControllerActionInvoker.InvokeActionMethodFilter(IActionFilter filter, ActionExecutingContext preContext, Func`1 continuation) +263
   System.Web.Mvc.<>c__DisplayClass17.<InvokeActionMethodWithFilters>b__14() +19
   System.Web.Mvc.ControllerActionInvoker.InvokeActionMethodWithFilters(ControllerContext controllerContext, IList`1 filters, ActionDescriptor actionDescriptor, IDictionary`2 parameters) +191
   System.Web.Mvc.ControllerActionInvoker.InvokeAction(ControllerContext controllerContext, String actionName) +343
   System.Web.Mvc.Controller.ExecuteCore() +116
   System.Web.Mvc.ControllerBase.Execute(RequestContext requestContext) +97
   System.Web.Mvc.ControllerBase.System.Web.Mvc.IController.Execute(RequestContext requestContext) +10
   System.Web.Mvc.<>c__DisplayClassb.<BeginProcessRequest>b__5() +37
   System.Web.Mvc.Async.<>c__DisplayClass1.<MakeVoidDelegate>b__0() +21
   System.Web.Mvc.Async.<>c__DisplayClass8`1.<BeginSynchronous>b__7(IAsyncResult _) +12
   System.Web.Mvc.Async.WrappedAsyncResult`1.End() +62
   System.Web.Mvc.<>c__DisplayClasse.<EndProcessRequest>b__d() +50
   System.Web.Mvc.SecurityUtil.<GetCallInAppTrustThunk>b__0(Action f) +7
   System.Web.Mvc.SecurityUtil.ProcessInApplicationTrust(Action action) +22
   System.Web.Mvc.MvcHandler.EndProcessRequest(IAsyncResult asyncResult) +60
   System.Web.Mvc.MvcHandler.System.Web.IHttpAsyncHandler.EndProcessRequest(IAsyncResult result) +9
   System.Web.CallHandlerExecutionStep.System.Web.HttpApplication.IExecutionStep.Execute() +8969117
   System.Web.HttpApplication.ExecuteStep(IExecutionStep step, Boolean& completedSynchronously) +184 
```

# ruby-on-rails - Ruby on Rails 解密 mcrypt_decrypt

> ID：10092318
> 
> 赞同：1
> 
> 时间：2012-04-10T16:06:58.073
> 
> 标签：ruby-on-rails, ruby, encryption

以下函数在 PHP 中完美运行。如何在 Ruby on Rails 中翻译它。

请注意，privateKey 和 iv 都是 32 个字符长。

mcrypt_decrypt（MCRYPT_RIJNDAEL_256，$privateKey，base64_decode（$enc），MCRYPT_MODE_CBC，$iv）

非常感谢你的期待

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-06-02T09:08:23.120

试试[ruby​​-mcrypt](https://github.com/kingpong/ruby-mcrypt) gem。

```
require 'rubygems'
require 'mcrypt'

crypto = Mcrypt.new(:twofish, :cbc, MY_KEY, MY_IV, :pkcs)

# encryption and decryption in one step
ciphertext = crypto.encrypt(plaintext)
plaintext  = crypto.decrypt(ciphertext) 
```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-04-10T16:12:21.113

仅使用具有这些功能的特定类。

# oracle - 在子查询（Oracle）中引用父查询列

> ID：10092320
> 
> 赞同：8
> 
> 时间：2012-04-10T16:07:09.570
> 
> 标签：oracle, oracle11g, subquery

如何使用 Oracle 引用子查询之外的列？我特别需要在子查询的 WHERE 语句中使用它。

基本上我有这个：

```
SELECT Item.ItemNo, Item.Group
FROM Item
  LEFT OUTER JOIN (SELECT Attribute.Group, COUNT(1) CT 
                   FROM Attribute 
                   WHERE Attribute.ItemNo=12345) A ON A.Group = Item.Group
WHERE Item.ItemNo=12345 
```

我想在子查询中更改`WHERE Attribute.ItemNo=12345`为`WHERE Attribute.ItemNo=Item.ItemNo`，但我不知道这是否可能。我不断收到“ORA-00904: 'Item'.'ItemNo': Invalid Identifier”

**编辑：**

好的，这就是为什么我需要这种结构：

我希望能够获得“错误”记录（项目缺少值）和“OK”记录（项目有值）的计数。

我在小提琴中设置的方式返回正确的数据。我想我最终可能只是填写每个子查询中的值，因为这可能是最简单的方法。对不起，如果我的数据结构有点复杂。如果需要，我可以解释。

我的桌子是：

```
create table itemcountry(
  itemno number,
  country nchar(3),
  imgroup varchar2(10),
  imtariff varchar2(20),
  exgroup varchar2(10),
  extariff varchar2(20) );

create table itemattribute(
  attributeid varchar2(10),
  tariffgroup varchar2(10),
  tariffno varchar2(10) );

create table icav(
  itemno number,
  attributeid varchar2(10),
  value varchar2(10) ); 
```

到目前为止我的查询是：

```
select itemno, country, imgroup, imtariff, im.error "imerror", im.ok "imok", exgroup, extariff, ex.error "exerror", ex.ok "exok"
from itemcountry
  left outer join (select sum(case when icav.itemno is null then 1 else 0 end) error, sum(case when icav.itemno is not null then 1 else 0 end) ok, tariffgroup, tariffno
                   from itemattribute ia 
                     left outer join icav on ia.attributeid=icav.attributeid 
                   where (icav.itemno=12345 or icav.itemno is null) 
                   group by tariffgroup, tariffno) im on im.tariffgroup=imgroup and imtariff=im.tariffno
  left outer join (select sum(case when icav.itemno is null then 1 else 0 end) error, sum(case when icav.itemno is not null then 1 else 0 end) ok, tariffgroup, tariffno
                   from itemattribute ia 
                     left outer join icav on ia.attributeid=icav.attributeid 
                   where (icav.itemno=12345 or icav.itemno is null) 
                   group by tariffgroup, tariffno) ex on ex.tariffgroup=exgroup and extariff=ex.tariffno
where itemno=12345; 
```

它也在[SQL Fiddle](http://sqlfiddle.com/#!4/424e7/7)中设置。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-10T18:15:56.087

您可以在子查询中执行此操作，但不能在联接中执行此操作。在你的情况下，我认为没有必要。您可以将其置于连接条件中。

```
select i.itemno, i.group
  from item i
  left outer join ( select group, itemno
                      from attribute b
                     group by group itemno ) a
    on a.group = i.group 
   and i.itemno = a.itemno
 where i.itemno = 12345 
```

优化器是为处理这种情况而构建的，所以利用它！

我已将`count(1)`a更改`group by`为您需要的`group by`所有未聚合的列。

我假设您的实际查询比这更复杂，因为您选择的列可能相当于

```
select itemno, group
  from item
 where itemno = 12345 
```

您也可以用 an 来编写您的子查询[`analytic function`](http://psoug.org/reference/analytic_functions.html)。类似的东西`count(*) over ( partition by group)`。

顺便说一句，使用关键字作为列名，在这种情况下`group`是 A Bad Idea ^(TM)。它会引起很多混乱。正如您从上面的代码中看到的那样，您有很多内容`groups`。

* * *

因此，根据您的 SQL-Fiddle，我已将其添加到我认为您正在寻找类似以下内容的问题中，这看起来并没有好多少。我怀疑，如果有时间，我可以让它变得更简单。另一方面，明确的小写查询永远不值得它引起的麻烦。不过，我遵循了您的命名约定。

```
with sub_query as (
 select count(*) - count(icav.itemno) as error
      , count(icav.itemno) as ok
      , min(itemno) over () as itemno
      , tariffgroup
      , tariffno
   from itemattribute ia 
   left outer join icav 
     on ia.attributeid = icav.attributeid 
  group by icav.itemno
         , tariffgroup
         , tariffno
  ) 
    select ic.itemno, ic.country, ic.imgroup, ic.imtariff
         , sum(im.error) as "imerror", sum(im.ok) as "imok"
         , ic.exgroup, ic.extariff
         , sum(ex.error) as "exerror", sum(ex.ok) as "exok"
      from itemcountry ic
      left outer join sub_query im 
        on ic.imgroup = im.tariffgroup
       and ic.imtariff = im.tariffno
       and ic.itemno = im.itemno
      left outer join sub_query ex 
        on ic.exgroup = ex.tariffgroup
       and ic.extariff = ex.tariffno
       and ic.itemno = ex.itemno
     where ic.itemno = 12345
     group by ic.itemno, ic.country
            , ic.imgroup, ic.imtariff
            , ic.exgroup, ic.extariff
           ; 
```

* * *

## 回答 #2

> 赞同：-4
> 
> 时间：2012-04-10T16:40:34.877

您可以将 WHERE attribute.itemno=item.itemno 放在子查询中。无论如何，您都要过滤数据，过滤子查询中的数据通常也更快。

# emacs - 如何通过指定包名列表来自动安装 Emacs 包？

> ID：10092322
> 
> 赞同：131
> 
> 时间：2012-04-10T16:07:15.420
> 
> 标签：emacs, installation, package

我`package`用来管理我的 Emacs 扩展。为了在不同的计算机上同步我的 Emacs 设置，我想要一种方法来指定`.emacs`文件中的包名称列表，然后`package`可以自动搜索和安装包，这样我就不需要通过调用手动安装它们`M-x package-list-packages`。怎么做？

* * *

## 回答 #1

> 赞同：111
> 
> 时间：2012-04-10T17:16:20.790

```
; list the packages you want
(setq package-list '(package1 package2))

; list the repositories containing them
(setq package-archives '(("elpa" . "http://tromey.com/elpa/")
                         ("gnu" . "http://elpa.gnu.org/packages/")
                         ("marmalade" . "http://marmalade-repo.org/packages/")))

; activate all the packages (in particular autoloads)
(package-initialize)

; fetch the list of packages available 
(unless package-archive-contents
  (package-refresh-contents))

; install the missing packages
(dolist (package package-list)
  (unless (package-installed-p package)
    (package-install package))) 
```

* * *

## 回答 #2

> 赞同：45
> 
> 时间：2012-04-10T20:18:33.113

根据 Profpatsch 的评论和以下答案：

```
(defun ensure-package-installed (&rest packages)
  "Assure every package is installed, ask for installation if it’s not.

Return a list of installed packages or nil for every skipped package."
  (mapcar
   (lambda (package)
     ;; (package-installed-p 'evil)
     (if (package-installed-p package)
         nil
       (if (y-or-n-p (format "Package %s is missing. Install it? " package))
           (package-install package)
         package)))
   packages))

;; make sure to have downloaded archive description.
;; Or use package-archive-contents as suggested by Nicolas Dudebout
(or (file-exists-p package-user-dir)
    (package-refresh-contents))

(ensure-package-installed 'iedit 'magit) ;  --> (nil nil) if iedit and magit are already installed

;; activate installed packages
(package-initialize) 
```

* * *

## 回答 #3

> 赞同：44
> 
> 时间：2016-10-06T08:29:02.047

Emacs 25.1+ 将自动跟踪自定义`package-selected-packages`变量中用户安装的包。`package-install`将更新自定义变量，您可以使用该`package-install-selected-packages`功能安装所有选定的包。

这种方法的另一个方便的优点是您可以使用它`package-autoremove`来自动删除未包含的包`package-selected-packages`（尽管它会保留依赖项）。

```
(package-initialize)
(unless package-archive-contents
  (package-refresh-contents))
(package-install-selected-packages) 
```

来源：[http ://endlessparentheses.com/new-in-package-el-in-emacs-25-1-user-selected-packages.html](http://endlessparentheses.com/new-in-package-el-in-emacs-25-1-user-selected-packages.html)

* * *

## 回答 #4

> 赞同：19
> 
> 时间：2012-04-11T08:06:50.583

这是我用于[Emacs Prelude](https://github.com/bbatsov/prelude)的代码：

```
(require 'package)
(require 'melpa)
(add-to-list 'package-archives
             '("melpa" . "http://melpa.milkbox.net/packages/") t)
(package-initialize)

(setq url-http-attempt-keepalives nil)

(defvar prelude-packages
  '(ack-and-a-half auctex clojure-mode coffee-mode deft expand-region
                   gist haml-mode haskell-mode helm helm-projectile inf-ruby
                   magit magithub markdown-mode paredit projectile
                   python sass-mode rainbow-mode scss-mode solarized-theme
                   volatile-highlights yaml-mode yari yasnippet zenburn-theme)
  "A list of packages to ensure are installed at launch.")

(defun prelude-packages-installed-p ()
  (loop for p in prelude-packages
        when (not (package-installed-p p)) do (return nil)
        finally (return t)))

(unless (prelude-packages-installed-p)
  ;; check for new packages (package versions)
  (message "%s" "Emacs Prelude is now refreshing its package database...")
  (package-refresh-contents)
  (message "%s" " done.")
  ;; install the missing packages
  (dolist (p prelude-packages)
    (when (not (package-installed-p p))
      (package-install p))))

(provide 'prelude-packages) 
```

如果你不使用 MELPA，你不需要它（如果你`melpa.el`必须在你的`load-path`（或通过 MELPA 安装）上）。包 db 不会每次都刷新（因为这会显着减慢启动速度) - 仅在存在已卸载软件包的情况下。

* * *

## 回答 #5

> 赞同：7
> 
> 时间：2014-03-02T21:19:07.700

目前还没有人提到[Cask](http://cask.readthedocs.org/)，但它非常适合这项任务。

基本上，您创建`~/.emacs.d/Cask`列出要安装的软件包。例如：

```
(source melpa)
(depends-on "expand-region")
(depends-on "goto-last-change")
; ... etc 
```

`cask`从命令行运行将为您安装这些包以及它们需要的任何依赖项。

此外，您可以使用`cask update`.

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2012-04-10T16:23:48.863

`package-install`以包名作为符号调用。`package-install`您可以通过交互调用并完成名称来查找包的包名称。该功能`package-installed-p`将让您知道它是否已经安装。

例如：

```
(mapc
 (lambda (package)
   (or (package-installed-p package)
       (package-install package)))
 '(package1 package2 package3)) 
```

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2015-09-10T06:25:19.533

```
(require 'cl)
(require 'package)

(setq cfg-var:packages '(
       emmet-mode
       ergoemacs-mode
       flycheck
       flycheck-pyflakes
       monokai-theme
       py-autopep8
       py-isort
       rainbow-mode
       yafolding
       yasnippet))

(defun cfg:install-packages ()
    (let ((pkgs (remove-if #'package-installed-p cfg-var:packages)))
        (when pkgs
            (message "%s" "Emacs refresh packages database...")
            (package-refresh-contents)
            (message "%s" " done.")
            (dolist (p cfg-var:packages)
                (package-install p)))))

(add-to-list 'package-archives '("gnu" . "http://elpa.gnu.org/packages/") t)
(add-to-list 'package-archives '("melpa" . "http://melpa.org/packages/") t)
(add-to-list 'package-archives '("melpa-stable" . "http://stable.melpa.org/packages/") t)
(add-to-list 'package-archives '("org" . "http://orgmode.org/elpa/") t)
(package-initialize)

(cfg:install-packages) 
```

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2015-06-18T21:20:38.260

我喜欢检查用户是否想按照[这个答案](https://stackoverflow.com/a/10095853/59439)首先安装软件包。此外，在安装任何东西之前，我都会刷新一次我的包内容。我不确定这是否是最好的方法，但我认为最佳答案并不是为我做的。

```
(setq required-pkgs '(jedi flycheck cider clojure-mode paredit markdown-mode jsx-mode company))

(require 'cl)

(setq pkgs-to-install
      (let ((uninstalled-pkgs (remove-if 'package-installed-p required-pkgs)))
        (remove-if-not '(lambda (pkg) (y-or-n-p (format "Package %s is missing. Install it? " pkg))) uninstalled-pkgs)))

(when (> (length pkgs-to-install) 0)
  (package-refresh-contents)
  (dolist (pkg pkgs-to-install)
    (package-install pkg))) 
```

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2017-07-20T18:23:07.560

这是我的，它更短:)

```
(mapc
 (lambda (package)
   (unless (package-installed-p package)
     (progn (message "installing %s" package)
            (package-refresh-contents)
            (package-install package))))
 '(browse-kill-ring flycheck less-css-mode tabbar org auto-complete undo-tree clojure-mode markdown-mode yasnippet paredit paredit-menu php-mode haml-mode rainbow-mode fontawesome)) 
```

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2017-12-17T02:57:51.800

我遇到了一个问题，添加`(package-install 'org)`到`.emacs`. 我想安装的最新版本`org-mode`和内置`org-mode`是相当旧的。

`package-install`我从 Emacs 25.3.1中挖出了源代码。函数 self 已经检查是否安装了包，如果包已经安装，则拒绝安装它。因此，实际上不需要`(unless (package-installed-p package) ...)`从答案[10093312进行检查。](https://stackoverflow.com/a/10093312/2117531)

```
(defun package-install (pkg &optional dont-select)
  "Install the package PKG.
PKG can be a package-desc or a symbol naming one of the available packages
in an archive in `package-archives'.  Interactively, prompt for its name.

If called interactively or if DONT-SELECT nil, add PKG to
`package-selected-packages'.

If PKG is a package-desc and it is already installed, don't try
to install it but still mark it as selected."
  (interactive
   (progn
     ;; Initialize the package system to get the list of package
     ;; symbols for completion.
     (unless package--initialized
       (package-initialize t))
     (unless package-archive-contents
       (package-refresh-contents))
     (list (intern (completing-read
                    "Install package: "
                    (delq nil
                          (mapcar (lambda (elt)
                                    (unless (package-installed-p (car elt))
                                      (symbol-name (car elt))))
                                  package-archive-contents))
                    nil t))
           nil)))
  (add-hook 'post-command-hook #'package-menu--post-refresh)
  (let ((name (if (package-desc-p pkg)
                  (package-desc-name pkg)
                pkg)))
    (unless (or dont-select (package--user-selected-p name))
      (package--save-selected-packages
       (cons name package-selected-packages)))
    (if-let ((transaction
              (if (package-desc-p pkg)
                  (unless (package-installed-p pkg)
                    (package-compute-transaction (list pkg)
                                                 (package-desc-reqs pkg)))
                (package-compute-transaction () (list (list pkg))))))
        (package-download-transaction transaction)
      (message "`%s' is already installed" name)))) 
```

内置`org-mode`也算作已安装，并`package-install`拒绝安装来自 ELPA 的较新版本。在花了一些时间阅读 package.el 之后，我想出了以下解决方案。

```
(dolist (package (package-compute-transaction
                  () (list (list 'python '(0 25 1))
                           (list 'org '(20171211)))))
  ;; package-download-transaction may be more suitable here and
  ;; I don't have time to check it
  (package-install package)) 
```

它起作用的原因是`package-*`族函数根据它是符号还是`package-desc`对象来不同地处理参数。您只能`package-install`通过`package-desc`对象指定版本信息。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2020-05-11T05:16:48.640

这是另一种方式。

```
;; assure every package is installed
(defun ensure-package-installed (&rest packages)
  (let ((user-required-packages
         (seq-remove
          (lambda (package) (package-installed-p package))
          packages)))
    (when user-required-packages
      (package-refresh-contents)
      (dolist (package user-required-packages)
        (package-install package)))))

;; list of packages to install
(ensure-package-installed
 'try
 'which-key) 
```

# bash - Bash：如何在文件的块中检查和插入字符串

> ID：10092328
> 
> 赞同：4
> 
> 时间：2012-04-10T16:07:29.697
> 
> 标签：bash, awk

在 http.conf 文件中有一个块，例如：

```
<IfModule mime_module>
    ...
</IfModule> 
```

假设使用 bash，我如何检查以下行

```
AddHandler application/x-httpd-php .php 
```

已经在前一个块中添加了
，如果没有，我如何将它添加到它的底部导致

```
<IfModule mime_module>
    ...
    AddHandler application/x-httpd-php .php
</IfModule> 
```

这个块就在文件的中间：
文件内容不以此块开始或结束。

**编辑：**
为了让这更难，我意识到我也需要进一步检查：很抱歉在我的问题中错过了它。如果上述行已作为注释行存在于上述块中，则为

```
# AddHandler application/x-httpd-php .php 
```

（char # 可能是该行的第一个字符，或者它之前可能有一些空格，因为它可能在 AddHandler 的 char A 之前有或没有一些空格），我只需要取消注释它，否则我继续添加如所描述的那样。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-04-10T16:24:34.370

```
awk '
/mime_module/{
    flag=1
}

flag && /x-httpd-php/{
    has=1
}

flag && /<\/IfModule>/{
    flag = 0
    if(!has)
        print "AddHandler application/x-httpd-php .php"
}
1' input.conf 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-10T18:47:12.697

这可能对您有用：

```
sed -i ':a;$!N;/^<IfModule mime_module>.*<\/IfModule>/{s/# *\(AddHandler application\/x-httpd-php \.php\)/\1/;/AddHandler application\/x-httpd-php \.php/!s/.*\n/&\n    AddHandler application\/x-httpd-php .php\n/;p;d};/^<IfModule mime_module>/ba;P;D' input.conf 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-16T22:49:13.177

以下内容将用您的文本“AddHandler application/x-httpd-php .php”替换块“IfModule - /IfModule”中的任何内容。因此，无论是否找到注释 (#) 或未找到任何内容，该块都将具有正确的信息。

同样重要的是要注意这是一个内联编辑。您要更改的文件将在运行此脚本后立即更改，无需备份。在测试任何东西之前，请备份您的文件。

```
sed -i '/<\/IfModule>/,/<IfModule>/!s/    \.\.\..*/    \.\.\.\n    AddHandler application\/x-httpd-php .php/g' /yourfile 
```

如果您在 OS X 上工作，您可能想尝试以下脚本

```
#!/bin/bash

CR="$(printf '\r')"

sed -i '' "/<\/IfModule>/,/<IfModule>/!s/    \.\.\..*/    \.\.\.${CR}    AddHandler application\/x-httpd-php .php/g" /yourfile 
```

起始文件示例：

```
<IfModule>
    ...
</IfModule>
<NOTHING TO CHANGE>
    ...
</NOTHING TO CHANGE>
<IfModule>
    ...
#   AddHandler application/x-httpd-php .php
</IfModule>
<NO CHANGE>
    ...
    NO CHANGE
</NO CHANGE> 
```

结果：

```
<IfModule>
    ...
    AddHandler application/x-httpd-php .php
</IfModule>
<NOTHING TO CHANGE>
    ...
</NOTHING TO CHANGE>
<IfModule>
    ...
    AddHandler application/x-httpd-php .php
</IfModule>
<NO CHANGE>
    ...
    NO CHANGE
</NO CHANGE> 
```

# java - Java scrollToReference 在 JEditorPane 中导致异常

> ID：10092333
> 
> 赞同：2
> 
> 时间：2012-04-10T16:07:39.330
> 
> 标签：java, swing, jeditorpane

我在 JScrollPane 和 JTextField 中有一个带有自定义 html 文档（不是来自 URL）的 JEditorPane，以便用户可以输入文本，然后在编辑器窗格中突出显示该文本。在文本字段的 keyPressed 事件中，我在文档中搜索文本，将其包围：

```
<a name='spot'><span style='background-color: silver'>my text</span></a> 
```

突出显示背景，然后将新文本设置为 JEditorPane。这一切都很好，但我也想将窗格滚动到新突出显示的文本。因此，在编辑器窗格的 documentListener 的 changedUpdate 方法中，我添加：

```
pane.scrollToReference("spot"); 
```

此调用在 BoxView.modelToView 内引发 ArrayIndexOutOfBoundsException。该方法在文本中找到我的“点”引用，但我在想也许视图还没有用新文本更新，所以当它试图滚动到那里时，它会失败。

我无法获得对视图的引用，而且我似乎找不到要监听的事件，这表明 JEditorPane 的视图已完全更新。有任何想法吗？

谢谢，

贾里德

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-10T17:29:35.737

[JScrollPane#scrollToReference(java.lang.String reference)](http://java.sun.com/javame/reference/apis/jsr209/javax/swing/JEditorPane.html)谈论对 URL 的字符串引用，

```
Scrolls the view to the given reference location (that is, the value 
returned by the UL.getRef method for the URL being displayed). 
```

然后所有示例都显示以下解决方法

```
import java.io.IOException;
import java.net.URL;
import javax.swing.JDialog;
import javax.swing.JEditorPane;
import javax.swing.JFrame;
import javax.swing.JScrollPane;
import javax.swing.event.HyperlinkEvent;
import javax.swing.event.HyperlinkListener;

public class MyScrollToReference extends JDialog {
    private static final long serialVersionUID = 1L;

    public MyScrollToReference(JFrame frame, String title, boolean modal, String urlString) {
        super(frame, title, modal);

        try {
            final URL url = MyScrollToReference.class.getResource(urlString);
            final JEditorPane htmlPane = new JEditorPane(url);
            htmlPane.setEditable(false);
            JScrollPane scrollPane = new JScrollPane(htmlPane);
            getContentPane().add(scrollPane);
            htmlPane.addHyperlinkListener(new HyperlinkListener() {

                public void hyperlinkUpdate(HyperlinkEvent e) {
                    if (e.getEventType() == HyperlinkEvent.EventType.ACTIVATED) {
                        if (e.getURL().sameFile(url)) {
                            try {
                                htmlPane.scrollToReference(e.getURL().getRef());
                            } catch (Throwable t) {
                                t.printStackTrace();
                            }
                        }
                    }
                }
            });
        } catch (IOException e) {
        }
    }
} 
```

# django - Django：复制文件字段

> ID：10092334
> 
> 赞同：5
> 
> 时间：2012-04-10T16:07:39.760
> 
> 标签：django, file, path, copy, hardlink

我正在尝试使用硬链接复制文件，其中文件存储为 Django FileField。我想使用硬链接来节省空间和复制时间（预计不会对原始文​​件或副本进行任何更改）。但是，当我尝试从下面的代码段中调用 new_file.save() 时，我遇到了一些奇怪的错误。

```
AttributeError: 'file' object has no attribute '_committed' 
```

我的想法是，在进行硬链接之后，我可以打开链接文件并将其存储到 Django 新文件实例的 FileFile 中。我在这里错过了一步还是什么？

**模型.py**

```
class File(models.Model):
    stored_file = models.FileField() 
```

**别处.py**

```
import os 

original_file = File.objects.get(id=1)
original_file_path = original_file.file.path

new_file = File()
new_file_path = '/path/to/new/file'

os.makedirs(os.path.realpath(os.path.dirname(new_file_path)))
os.link(original_file_path, new_file_path)
new_file.stored_file = file(new_file_path)
new_file.save() 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-04-10T16:58:26.783

无需创建硬链接，只需复制文件持有者：

```
new_file = File(stored_file=original_file.stored_file)
new_file.save() 
```

*更新*

如果您想将文件指定为 FileField 或 ImageField，您可以简单地

```
new_file = File(stored_file=new_file_path)
# or
new_file = File()
new_file.stored_file = new_file_path
# or
from django.core.files.base import File
# from django.core.files.images import ImageFile # for ImageField
new_file.stored_file = File(new_file_path) 
```

该字段接受 basestring 或 File() 实例中的路径，您问题中的代码使用 file()，因此不被接受。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-10T23:43:37.953

我想我解决了这个问题，但不确定它为什么会起作用。我将文件对象包装在“DjangoFile”类中（我作为 DjangoFile 导入以避免与我之前定义的文件模型发生冲突）。

```
from django.core.files.base import File as DjangoFile

...
new_file.stored_file = DjangoFile(file(new_file_path))
new_file.save() 
```

这种方法似乎可以保存文件。

# asp.net-mvc-3 - 两种形式（一种在布局中，一种在Page中）在asp.net mvc3中如何处理

> ID：10092335
> 
> 赞同：0
> 
> 时间：2012-04-10T16:07:40.197
> 
> 标签：asp.net-mvc-3, forms, mobile, viewmodel

我正在使用 ASP.NET MVC3 开发移动网站。我有一个页面，我的标题中有搜索栏。这个标题来自我的布局页面，这是所有其他视图共有的。在我的特定页面内，我有页面特定的内容（表单）。

![在此处输入图像描述](../Images/04351ae7d41c11a89953de67fa39bfd9.png)

对于我的操作，我将强类型`Customer/Add`的添加视图返回到我的. 我将在我的添加视图中有表单标签，当表单被提交时，它将被发布到Action 方法。那也行。我的问题是我将如何处理搜索框内容？我相信页面中只允许使用一个表单。因此，如果我有一个绑定到我的搜索视图（部分）的表单，它将是我页面中的 2 个表单。所以我不能那样做。`Customer``CustomerViewModel``HttpPost` `Add``SearchViewModel`

我可以通过阅读 java 脚本中的内容并调用另一个操作来获取搜索结果来处理搜索部分。这是唯一的方法吗？我担心那些禁用 java 脚本的设备。我应该怎么办 ？请指教

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-10T16:32:51.650

不可以。您可以在页面上拥有超过 1 个表单。事实上，你应该在这里。您的添加客户页面应该提交给 1 个操作方法，但您的搜索表单应该提交给不同的操作方法。

如果您熟悉 webforms，那么该框架只允许您在页面上拥有 1 个表单，但不是因为 HTML 需要它。Webforms 需要它，因为它是框架可以跨 POST 请求（使用 ViewState）携带来自各种服务器控件的所有数据的唯一方式。Webforms 历来对 HTML 或 HTTP 不是很友好。

您只是不能将表单嵌套在 HTML 中的其他表单中，但在一个页面上拥有多个表单是完全合法的（并且在 MVC 中推荐）。

至于 AJAX，我不会担心没有启用 javascript 的设备。地球上只有大约 6 或 7 个人的网络设备上没有 javascript，如果有人禁用 javascript，他们将无法体验 99% 的网络其余部分。

# c# - 为 UpdateModel 设置日期时间格式

> ID：10092336
> 
> 赞同：0
> 
> 时间：2012-04-10T16:07:40.637
> 
> 标签：c#, jquery, asp.net-mvc

考虑以下模型：

```
public class ExportRequestsFilter {
    [DisplayFormat(ApplyFormatInEditMode = true, DataFormatString = "{0:dd/MM/yyyy}")]
    public DateTime? StartDate { get; set; }

    [DisplayFormat(ApplyFormatInEditMode = true, DataFormatString = "{0:dd/MM/yyyy}")]
    public DateTime? EndDate { get; set; }

    ... 
```

使用各自的视图：

```
<script type="text/javascript">
    $(document).ready(function () {
        $(".datepicker").datepicker({ dateFormat: 'dd/mm/yy' }); // this is the datepicker equivalent to dd/MM/yyyy
    });
</script>

...

<% using (Html.BeginForm(FormMethod.Post)) {%>
    ...
    <%: Html.TextBox("StartDate", Model.StartDate, new { @class = "datepicker" })%><br />
    <%: Html.TextBox("EndDate", Model.EndDate, new { @class = "datepicker" })%>

    <input type="submit" class="buttonLink" name="submitButton" value="<%: Html.Resource("Preview") %>" /> 
```

当 StartDate TextBox 上的数据为 2/4/2012 时，是否有充分的理由将`UpdateModel()`StartDate 设置为 2012 年 2 月 4 日而不是 2012 年 4 月 2 日？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-10T16:27:06.787

2/4/2012 是美国英语文化的标准日期时间格式。它表示 2012 年 2 月 4 日。英国英语文化的相同日期时间格式表示 2012 年 4 月 2 日。

听起来您当前的 UI 文化设置为 en-US，而不是 en-UK。您可以通过检查来检查它`System.Globalization.CultureInfo.CurrentUICulture`。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-10T16:28:46.883

这取决于解析输入的计算机的文化设置。因此，如果网络服务器设置为解析`DateTime`基于 en-US 文化的内容，`MM/dd/yyyy`即使网页设置为将其呈现为`dd/MM/yyyy`. 如果您想强制解析始终采用一种格式，那么当您在自定义活页夹中调用 DateTime.Parse 时，您必须传入文化信息。

编辑：实际上我认为这可以在 web.config 中设置为应用程序使用默认文化。虽然我不确定如何做到这一点，但没有使用不同的文化环境。

[MSDN](http://msdn.microsoft.com/en-us/library/bz9tc508.aspx)有一篇很好的文章，介绍了可与 MVC 一起使用的 ASP.NET 应用程序全球化。另外[这篇](https://stackoverflow.com/questions/7216057/setting-culture-for-asp-net-mvc-application-on-vs-dev-server-and-iis)关于 StackOverflow 的文章将解释如何在 web.config 中使用 MVC 来完成。如果您按照那里的答案，它应该会自动以您正在寻找的格式解析 DateTime。

# python - 使用 Python 的 replace() 方法实现停用词功能

> ID：10092337
> 
> 赞同：1
> 
> 时间：2012-04-10T16:07:43.783
> 
> 标签：python

我试图从字符串列表中的每个元素中去除子字符串。我无法弄清楚如何处理具有多个要删除的子字符串（停用词）的字符串的情况。

```
wines = ("2008 Chardonnay", "Cabernet Sauvignon 2009", "Bordeaux 2005 Cotes du Rhone")
stop_words = ("2005", "2008", "2009", "Cotes du Rhone")
result = []

for wine in wines:
    for stop in stop_words:
        if stop in wine:
            x = wine.replace(stop, "")
            result.append(x)

print result 
```

将 if 语句更改为 for 或 while 会返回垃圾或挂起。有什么建议吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-10T16:15:34.217

一点缩进和改变变量可以解决你的问题

```
for wine in wines:
    glass=wine #Lets pour your wine in a glass
    for stop in stop_words:
        if stop in glass: #Is stop in your glass? 
            #Replace stop in glass and pour it in the glass again
            glass = glass.replace(stop, "") 
    result.append(glass) #Finally pour the content from your glass to result

result
[' Chardonnay', 'Cabernet Sauvignon ', 'Bordeaux  '] 
```

如果你想冒险，你可以使用正则表达式。我相信在这种情况下，正则表达式可能比简单循环更快

```
>>> for wine in wines:
    result.append(re.sub('('+'|'.join(stop_words)+')','',wine))    

>>> result
[' Chardonnay', 'Cabernet Sauvignon ', 'Bordeaux  ']
>>> 
```

或将其作为列表理解

```
>>> [re.sub('('+'|'.join(stop_words)+')','',wine) for wine in wines]
[' Chardonnay', 'Cabernet Sauvignon ', 'Bordeaux  ']
>>> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-10T16:16:16.103

```
wines = ("2008 Chardonnay", "Cabernet Sauvignon 2009", "Bordeaux 2005 Cotes du Rhone")
stop_words = ("2005", "2008", "2009", "Cotes du Rhone")
result = []

for wine in wines:
    x = wine
    for stop in stop_words:        
        x = x.replace(stop, "")
    result.append(x)

print result 
```

使用`regex`IMO 会好很多

```
>>> wines = ("2008 Chardonnay", "Cabernet Sauvignon 2009", "Bordeaux 2005 Cotes du Rhone")
>>> stop_words = ("2005", "2008", "2009", "Cotes du Rhone")
>>> import re
>>> [re.sub('|'.join(stop_words),'',wine) for wine in wines]
[' Chardonnay', 'Cabernet Sauvignon ', 'Bordeaux  '] 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-10T16:30:32.573

作为单线，考虑到 jamylaks 的使用建议`strip()`：

```
[reduce(lambda x,y: x.replace(y, "").strip(), stop_words, wine) for wine in wines] 
```

请注意，这在 Python 2.x 中可以正常工作，但在 Python 3 中却不行，因为它`reduce()`已移至单独的库中。如果您使用的是 Python 3，请执行以下操作：

```
import functools as ft
[ft.reduce(lambda x,y: x.replace(y, "").strip(), stop_words, wine) for wine in wines] 
```

# iphone - 根据下载的图像高度调整表格单元格高度

> ID：10092340
> 
> 赞同：7
> 
> 时间：2012-04-10T16:07:56.813
> 
> 标签：iphone, ios, uitableview, uiimage

我在运行时获取图像的 URL，我想下载并在表格中显示这些图像。图像将被异步下载。更重要的是，我想以实际尺寸显示所有这些图像。

请帮助我。提前致谢：）

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-07T11:06:36.440

首先，如果您还没有这样做，我强烈建议您使用[SDWebImage进行异步下载。](https://github.com/rs/SDWebImage)根据您的需要，您可以让它在内存或磁盘上缓存图像 - 后者以正确的方式完成，将它们保存在特殊的缓存文件夹中，因此 iOS 可以在空间不足时删除它们。它还在 UIImageView 上提供了一个方便的类别，类似于 AFNetworking 为您提供的，但具有更多选项和一个可选的完成块。这样你就可以做这样的事情：

```
#import <SDWebImage/UIImageView+WebCache.h>

...

- (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath {

    // Create the cell...

    [cell.myImageView setImageWithURL:[NSURL URLWithString:@"http://example.com/image.jpg"]
              placeholderImage:[UIImage imageNamed:@"placeholder"]
                     completed:^(UIImage *image, NSError *error, SDImageCacheType cacheType) {
        if (image != nil) {
            [self.images insertObject:image atIndex:indexPath.row];
            [tableView reloadRowsAtIndexPaths:[NSArray arrayWithObjects:indexPath, nil] withRowAnimation:YES];
        }
    }];
    return cell;
} 
```

这样你就可以异步下载图像，正确设置 UIImageView，但你也可以使用块将图像保存在 NSMutableArray 中，这样你就可以告诉 tableview 正确的高度。它还告诉表格视图更新已加载图像的单元格的高度。然后当表格视图需要知道给定单元格的高度时，如果图像已加载，我们将从中获取大小：

```
- (CGFloat)tableView:(UITableView *)tableView heightForRowAtIndexPath:(NSIndexPath *)indexPath {
    id image = [self.images objectAtIndex:indexPath.row];
    if ([image isKindOfClass:[NSNull class]]) {
        return defaultHeight;
    } else {
        return [image size].height + topPadding + bottomPadding;
    }
} 
```

这样，我们甚至可以知道屏幕外图像的高度（例如，当您滚动到底部时）。此解决方案假定您首先使用 NSNull 值填充 NSMutableArray，然后在加载时将其替换为图像。最后，如果您愿意，甚至可以在显示单元格之前使用 SDWebImageManager 手动开始下载。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-03-01T23:32:04.847

在委托方法上，您必须在完成下载后更新图像，您可以使用

```
[tableView reloadRowsAtIndexPaths:[NSArray arrayWithObjects:indexPath, nil] 
                 withRowAnimation:UITableViewRowAnimationAutomatic]; 
```

这将再次调用

```
 -(CGFloat)tableView:(UITableView *)tableView
heightForRowAtIndexPath:(NSIndexPath *)indexPath 
```

因此，您应该使用图像的高度（如果存在）、默认高度或占位符图像（如果有）。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-03-07T15:35:53.503

您可以`UIImageView`根据下载的图像制作您的尺寸，但**它会看起来很糟糕**。

所以我建议你把你所有的图像都做成一样大小，这样看起来会很好看。

您可以使用它来制作相同大小的所有图像。

```
+ (UIImage *)imageScaledToSizeWithImage:(UIImage *)imagewww andsizeee:(CGSize)size
{
    //avoid redundant drawing
    if (CGSizeEqualToSize(imagewww.size, size))
    {
        return imagewww;
    }

    //create drawing context
    UIGraphicsBeginImageContextWithOptions(size, NO, 0.0f);

    //draw
    [imagewww drawInRect:CGRectMake(0.0f, 0.0f, size.width, size.height)];

    //capture resultant image
    UIImage *image = UIGraphicsGetImageFromCurrentImageContext();
    UIGraphicsEndImageContext();

    //return image
    return image;
} 
```

但是，如果您真的想显示具有不同行大小的表，请在运行时更改行大小

当您将获得图像时，然后将图像保存在字典中，键值为行的 indexPath。

```
[tableImageDict setObject:image forKey:[NSString stringWithFormat:@"%i,%i",indexPath.row,indexPath.section]]; 
```

然后重新加载您的表格行。

```
[table reloadRowsAtIndexPaths:[NSArray arrayWithObject:indexPath]
                     withRowAnimation:UITableViewRowAnimationNone]; 
```

它会改变你的行高

```
-(CGFloat)tableView:(UITableView *)tableView heightForRowAtIndexPath:(NSIndexPath *)indexPath
{
    UIImage *image = (UIImage *)[tableImageDict objectForKey:
                                 [NSString stringWithFormat:@"%i,%i",
                                  indexPath.row,indexPath.section]];

    if (image != nil)
    {
        return image.size.height;
    }
    else{
        return 44.0;
    }
} 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-04-10T17:08:40.730

退房`heightForRowAtIndexPath:`。这是关于它的另一篇[文章](https://stackoverflow.com/questions/3542260/how-can-i-increase-the-height-of-uitableviewcell-dynamiclly)。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-04-10T17:11:02.327

为此，您必须创建自定义 UITableviewCell 并且您可以使用此代码设置表格视图单元格的大小

```
-(CGFloat)tableView:(UITableView *)tableView heightForRowAtIndexPath:(NSIndexPath *)indexPath
{
   int rowHeight =0.0f;

   // here u can get particular Url by indexPath.row, now create UIImage object using that Url 

   CGRect bioHeadingFrame = image.frame;
   rowHeight = size.height; //get the height of that image 

   return rowHeight;
} 
```

现在您的表格单元格的高度根据图像高度增加

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-03-01T19:09:32.770

如果异步下载是您真正的问题，请参阅[AFNetworking](https://github.com/AFNetworking/AFNetworking/blob/master/AFNetworking/UIImageView+AFNetworking.m)库的 UIImageView 类别。特别是这个功能：

```
- (void)setImageWithURL:(NSURL *)url placeholderImage:(UIImage *)placeholderImage 
```

您可以将此 UIimageview 类别包含到您的项目中，并设置从该类派生的单元格图像。

# git - GIT 命名我的存储库

> ID：10092343
> 
> 赞同：3
> 
> 时间：2012-04-10T16:08:03.380
> 
> 标签：git

我正在遵循[本指南](http://progit.org/book/ch4-2.html)，它说要运行`$ git clone --bare stef_project stef_project.git`。我明白了`fatal: repository 'stef_project' does not exist.`

看来我的仓库没有名字。在 .git 文件夹中有一个`DESCRIPTION`包含我替换为默认消息的文件`stef_project`，现在当我`clone`再次运行该命令时，我仍然收到相同的错误消息。

如何命名或重命名我的仓库？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-10T16:11:25.527

您当前的工作目录是什么？假设它被称为“mydir”，你可以将一个目录移到上面并像这样克隆：

```
cd ..
git clone --bare mydir stef_project.git 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2020-03-18T19:22:33.773

就我而言，我发现这很有效：

```
D:\AEMS\AEMS Website>git clone --bare "AEMS Website" AEMS_Website.git
fatal: repository 'AEMS Website' does not exist

D:\AEMS\AEMS Website>git clone --bare . AEMS_Website.git
Cloning into bare repository 'AEMS_Website.git'...
done. 
```

看起来文件夹名称中的嵌入空间会导致使用“。”的问题。避免。

# ajax - 根目录上的 ASP.NET MVC 3 身份验证，无重定向 (Ajax)

> ID：10092345
> 
> 赞同：0
> 
> 时间：2012-04-10T16:08:10.573
> 
> 标签：ajax, asp.net-mvc, login, path, authentication

我正在编写一个 ajax 应用程序，我正在使用属性 allowanonymous 进行身份验证（[http://blogs.msdn.com/b/rickandy/archive/2011/05/02/securing-your-asp-net-mvc- 3-应用程序.aspx](http://blogs.msdn.com/b/rickandy/archive/2011/05/02/securing-your-asp-net-mvc-3-application.aspx) )

今天，只要有人访问该 Web 应用程序，它将重定向到 ~/Account/LogOn，当登录成功时，它将返回 RedirectToAction("Index", "Home"); 并且浏览器 URL 将显示：http:// website/ 从那里我只使用 ajax 调用，所以 URL 保持不变。（内容使用 json 调用，返回的数据包含在主 div 中）

**我也愿意将 URL 设为登录页面上的根目录 (http://website/)。**我怎样才能实现它？我希望整个 webapp 都在 ajax 中，没有重定向。如果我以现在的方式应用 Ajax，即使已经登录，URL 仍将保持为 http:// website/Account/LogOn。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-11T00:37:49.580

我找到了一种方法，我将默认路由编辑为：

```
routes.MapRoute(
            "Default", // Route name
            "{controller}/{action}/{id}", // URL with parameters
            new { controller = "Account", action = "LogOn", id = UrlParameter.Optional } // Parameter defaults
        ); 
```

网络配置：

```
<authentication mode="Forms">
  <forms loginUrl="~/" timeout="120" />
</authentication> 
```

登录方法：

```
[AllowAnonymous]
public ActionResult LogOn()
{
    if (User.Identity.IsAuthenticated)
    {
        return View("Home"); //Show welcome message
    }
    return View(); //Show logon form
} 
```

这成功了:)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-10T17:15:36.683

我建议安装 MVC 4，它有一个完全符合您要求的默认模板，称为单页应用程序。您不必为您的应用程序使用 MVC4，但您可以将您的应用程序基于相同的技术。这样，您可以在 MVC4 发布时更新到几乎没有问题。

MVC4 目前处于 Beta 阶段，但预计将于今年夏天发布。MVC4 也可通过 Go-Live 许可证获得，因此您可以使用它发布生产站点。

如果您使用正确的术语也会有所帮助。MVC 有操作方法和路由，而不是“目录”。路由是任意的，与服务器上的物理目录不匹配。

# c# - 有没有一种巧妙的方式来部署我的 silverlight 应用程序并以编程方式更改设置？

> ID：10092348
> 
> 赞同：5
> 
> 时间：2012-04-10T16:08:22.120
> 
> 标签：c#, asp.net, silverlight, visual-studio-2010, deployment

我对网络开发相当陌生。我正处于部署点（用于测试）。我有几个地方（可能是 4 个地方）我必须添加一个与应用程序无关的 URI。所以现在，在部署时，那些需要改变。

有没有一种巧妙的方法来处理这个问题？光滑我的意思是不要**手动**浏览应用程序并更改 URI 或一揽子查找和替换（太冒险了）。我现在只有 4 个地方要更改，但这很容易更改并导致部署问题。

我正在使用 Microsoft 技术堆栈。Silverlight、ASP.NET、RIA 等。开发在 Visual Studio 2010 中完成。

我注意到 web 项目对 web.config 有一个漂亮的转换......这很好。Silverlight资源是否有等效机制？还有其他方法吗？

有什么想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-10T16:18:20.177

一种方法是将参数从托管网页传递给 Silverlight 应用程序。

```
<object ....>
... 
<param name="initParams" value="prm1=http://google.com,prm2=http://bing.com" />
...
</object> 
```

并从您的 Silverlight 应用程序（`App.xaml.cs`,`Application_Startup`方法）访问：

```
foreach (var item in e.Initparams)
{
  this.Resources.Add(item.Key, item.Value);
} 
```

访问参数：

```
var prm1 = App.Current.Resources["prm1"].ToString(); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-11T03:31:06.280

我刚刚发现这篇关于使用 MS 的内置转换机制进行服务引用的[堆栈溢出的帖子。](https://stackoverflow.com/questions/7360533/dynamic-endpoints-in-servicereferences-clientconfig)但实际上……它对于任何 XML 文件都是通用的。这意味着我能够将相同的概念应用到包含一些设置的自定义 XML 文件中……而且效果非常好。

**请参阅随机解决方案。** 它不是选定的解决方案，但它比我见过的任何其他解决方案都要好得多。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-10T17:26:25.840

它不太漂亮，但您可以检查 DEBUG 定义（默认在调试模式构建中定义）：

```
#if (DEBUG)
    myUrl = "http://www.google.com";
#else
    myUrl = "http://www.bing.com";
#endif 
```

# iphone - AdMob 在我所有的视图控制器中？

> ID：10092349
> 
> 赞同：5
> 
> 时间：2012-04-10T16:08:30.607
> 
> 标签：iphone, xcode, admob, ads, banner

我已经实现了 AdMob，一切似乎都可以正常工作，
但我想知道，我怎样才能将横幅放在我所有的视图控制器中？
现在，我只在 RootViewController 上有横幅。
我总共有 4 个视图控制器。
谢谢。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-10T20:59:07.867

What you want here is a `GADBannerView` singleton of sorts. You can probably create a wrapping class to act as a singleton for your adView, so something like:

```
@interface GADMasterViewController : UIViewController {
  GADBannerView *adBanner_;
  BOOL didCloseWebsiteView_;
  BOOL isLoaded_;
  id currentDelegate_;
} 
```

And just make sure that `GADMasterViewController` always returns a singleton:

```
+(GADMasterViewController *)singleton {
  static dispatch_once_t pred;
  static GADMasterViewController *shared;
  // Will only be run once, the first time this is called
  dispatch_once(&pred, ^{
    shared = [[GADMasterViewController alloc] init];
  });
  return shared;
} 
```

Have a method which resets the current view controller that's holding on to the adView:

```
-(void)resetAdView:(UIViewController *)rootViewController {
  // Always keep track of currentDelegate for notification forwarding
  currentDelegate_ = rootViewController;

  // Ad already requested, simply add it into the view
  if (isLoaded_) {
    [rootViewController.view addSubview:adBanner_];
  } else {

    adBanner_.delegate = self;
    adBanner_.rootViewController = rootViewController;
    adBanner_.adUnitID = kSampleAdUnitID;

    GADRequest *request = [GADRequest request];
    [adBanner_ loadRequest:request];
    [rootViewController.view addSubview:adBanner_];
    isLoaded_ = YES;
  }
} 
```

Then displaying your ad is just a matter of:

```
- (void)viewWillAppear:(BOOL)animated {
    [super viewWillAppear:animated];
    shared = [GADMasterViewController singleton];
    [shared resetAdView:self];
} 
```

You probably need to set up a delegate to forward notifications as well since the AdMob SDK doesn't act well to delegates changing on it in the middle of a request.

You can find a blog post about this [here](http://googleadsdeveloper.blogspot.com/2012/04/creating-gadbannerview-singleton-in.html).

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-10T16:20:48.540

我不知道 adMob 是如何工作的，但是就像其他所有东西一样，你可以创建一个`BaseViewController`你可以添加你的 adMob（在`viewDidLoad`方法中）然后所有其他 viewControllers 可以子类 this 的东西`BaseViewController`。只需调用您的 viewControllers`[super viewDidLoad];`的`viewDidLoad`方法，您就会拥有它...

希望这可以解决您的问题... :)

# c# - WCF 查询对象数组

> ID：10092351
> 
> 赞同：6
> 
> 时间：2012-04-10T16:08:31.913
> 
> 标签：c#, wcf, serialization

我仍在研究应该能够查询程序后端并返回结果的 WCF 解决方案。

后端存储了一个调用对象的字典，`Groups`可以使用以下函数查询它们：

*   `GetGroup`通过 ID 获取单个组
*   `GetGroups`按标签获取组列表。

`GetGroup`WCF 测试客户端和我构建的应用程序可以正常工作。它适用于应用程序的以下代码：

```
 List<string> values = new List<string>();
        GroupServiceClient client = new GroupServiceClient("WSHttpBinding_IGroupService");
        www.test.co.uk.programme.programme Group = new www.test.co.uk.programme.programme();
        DateTime time = DateTime.Now;
        values.Clear();
        client.Open();

        Group.number = textBox1.Text;
        client.GetGroup(ref time, ref Group);

        GroupStorageMessage toReturn = new GroupStorageMessage();
        toReturn.group = Group;

        selectedGroupId = Convert.ToString(toReturn.group.number);

        values.Add(Convert.ToString(toReturn.group.number));
        values.Add(Convert.ToString(toReturn.group.name));

        listBox1.ItemsSource=values;

        client.Close(); 
```

`GetGroups`与 WCF 测试客户端完美配合，但不适用于我的应用程序。

它按应有的方式发送查询，但确实返回`Null`（请注意，此代码来自另一个应用程序，我使用的是引用而不是代理文件）

```
 ServiceReference1.programme Group = new ServiceReference1.programme();
        ServiceReference1.GroupServiceClient Client = new ServiceReference1.GroupServiceClient();
        DateTime Time = DateTime.Now;

        Client.Open();

        string[] aa = new string[1];

        aa[0] = textBox1.Text;
        Group.tags = aa;
        Client.GetGroups(ref Time, Group);

        ServiceReference1.GroupArrayMessage toReturn = new ServiceReference1.GroupArrayMessage();

        ServiceReference1.programme[] Groups = new ServiceReference1.programme[1];

        toReturn.groups = Groups;   = returns null 
```

在新的 ServiceReference1.programme[1] 中；我实际上在猜测要放什么。

界面：

```
[ServiceContract(Namespace = "http://www.Test.co.uk/groupstorage")]
public interface IGroupStorageService
{
    /**
     * Get a group from the collection of groups
     */
    [OperationContract]
    GroupStorageMessage GetGroup(GroupStorageMessage message);
    /**
     * Add a group to the collection of groups
     */
    [OperationContract]
    void AddGroup(GroupStorageMessage message);
    /**
     * Remove a group from the collection of groups
     */
    [OperationContract]
    void RemoveGroup(GroupStorageMessage message);
    /**
     * Update a group in the collection of groups
     */
    [OperationContract]
    void UpdateGroup(GroupStorageMessage message);

    [OperationContract]
    GroupArrayMessage GetGroups(GroupStorageMessage message);
} 
```

消息合约：

```
[MessageContract]
public class GroupArrayMessage
{
    /**
     * Message header is the timestamp when the message was created
     */
    [MessageHeader(Name = "time")]
    public DateTime Time;
    /**
     * Message body is a collection of Users
     */
    [MessageBodyMember(Name = "groups")]
    public Group[] Groups;
} 
```

团体联系（有时称为计划）

```
[DataContract(Namespace = "http://www.test.co.uk/programme", Name = "programme")]
public class Group
{
    /**
     * The number representing the Programme (Programme ID)
     */
    [DataMember(Name = "number")]
    public string Number;
    /**
     * The name of the Programme
     */
    [DataMember(Name = "name")]
    public string Name;
    /// <summary>
    /// Add Tags
    /// </summary>
    [DataMember(Name = "tags")]
    public string[] Tags; 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-19T15:00:01.397

我终于找到了解决方案：

```
 GroupService.GroupArrayMessage toReturn = new GroupService.GroupArrayMessage();

        GroupService.programme[] Groups = Client.GetGroups(ref Time, Group);

        toReturn.groups = Groups;

        listBox1.ItemsSource = toReturn.groups; 
```

# java - Java：提交后禁用所有 JToggleButtons — setEnabled(false);

> ID：10092353
> 
> 赞同：2
> 
> 时间：2012-04-10T16:08:32.167
> 
> 标签：java, swing, jtogglebutton

我目前正在开发一个预订系统作为我学位的任务。按下按钮后禁用选定的 JToggleButtons 的最佳方法是什么？所以购买后就没有座位了。我曾尝试使用 for 循环和数组，但在检索已按下哪个按钮时遇到了一些麻烦。这是我的代码，如果可以，请运行它，您会更好地理解它。

PS：我没有使用数据库。

谢谢你。

```
// CM1203 Fundamentals of Computing with Java; Second Assignement.
// Walter Carvalho - C1001984; 2012.
// Cardiff University

// Load Libraries
import java.awt.*;
import java.awt.event.*;
import javax.swing.*;
import java.util.*;
import java.text.*;

public class cinemaSystem extends JFrame implements ActionListener {
    // Global Variables
    boolean lselected, rselected, mselected;
    double chargeDue;
    int a, b, c;
    static Ticket oapticket, childticket, adultticket;
    JFrame frame = new JFrame(); // Creates JFrame
    JLabel title, lchild, ladult, loap, ltotalprice, time;
    JTextField child, adult, oap, totalprice;
    JButton submit;
    JRadioButton time1, time2, time3, time4, time5; // Radio Butons
    JToggleButton l[][], m[][], r[][]; // Names grid of JButtons
    JPanel panel1, panel2, panel3, panel4, panel5, panel6;
    ArrayList<String> seatsAvailable = new ArrayList<String>();
    ArrayList<String> coupon = new ArrayList<String>();

    // Constructor
    public cinemaSystem(){

            title = new JLabel("Cinema Booking System");
            title.setFont(new Font("Helvetica", Font.BOLD, 30));
            title.setLocation(12,5);
            title.setSize(600, 60);

            frame.setLayout(null); // Setting Grid Layout
            // panel1.setLayout(new GridLayout(seat,row));
            l = new JToggleButton[4][4]; // Allocating Size of Grid
            panel1 = new JPanel(new GridLayout(4,4));
            panel1.setBounds(20, 95, 220, 140);
            for(int y = 0; y <4 ; y++){
                    for(int x = 0; x < 4; x++){
                        l[x][y] = new JToggleButton("L" + y + x); // Creates New JButton
                        l[x][y].addActionListener(this);
                        seatsAvailable.add("L" + y + x);
                        panel1.add(l[x][y]); //adds button to grid
                    }
            }

            m = new JToggleButton[4][2]; // Allocating Size of Grid
            panel2 = new JPanel(new GridLayout(2,4));
            panel2.setBounds(240, 165, 220, 70);
            for(int y = 0; y <2 ; y++){
                    for(int x = 0; x < 4; x++){
                        m[x][y] = new JToggleButton("M" + y + x); // Creates New JButton
                        m[x][y].addActionListener(this);
                        seatsAvailable.add("M" + y + x);
                        panel2.add(m[x][y]); //adds button to grid
                    }
            }

            r = new JToggleButton[4][4]; // Allocating Size of Grid
            panel3 = new JPanel(new GridLayout(4,4));
            panel3.setBounds(460, 95, 220, 140);
            for(int y = 0; y <4 ; y++){
                    for(int x = 0; x < 4; x++){
                        r[x][y] = new JToggleButton("R" + y + x); // Creates New JButton
                        r[x][y].addActionListener(this);
                        seatsAvailable.add("R" + y + x);
                        panel3.add(r[x][y]); //adds button to grid
                    }
            }

            panel4 = new JPanel(new FlowLayout());
            panel4.setBounds(0, 250, 300, 70);

            lchild = new JLabel("Child");
            child = new JTextField("0", 2);
            child.addActionListener(this);

            ladult = new JLabel("Adult");
            adult = new JTextField("0", 2);
            adult.addActionListener(this);

            loap = new JLabel("OAP");
            oap = new JTextField("0", 2);
            oap.addActionListener(this);

            submit = new JButton("Submit");
            submit.addActionListener(this);

            oapticket = new Ticket(4.70);
            childticket = new Ticket(3.50);
            adultticket = new Ticket(6.10);     

            child.addKeyListener(new MyKeyAdapter());
            oap.addKeyListener(new MyKeyAdapter());
            adult.addKeyListener(new MyKeyAdapter());

            panel4.add(lchild);
            panel4.add(child);
            panel4.add(ladult);
            panel4.add(adult);
            panel4.add(loap);
            panel4.add(oap);
            panel4.add(submit);

            panel5 = new JPanel(new FlowLayout());
            panel5.setBounds(240, 250, 300, 70);

            ltotalprice = new JLabel("Charge Due (£): ");
            totalprice = new JTextField("£0.00", 5);
            totalprice.setEnabled(false);
            panel5.add(ltotalprice);
            panel5.add(totalprice);

            panel6 = new JPanel(new FlowLayout());
            panel6.setBounds(0, 55, 560, 30);

            time = new JLabel("Please select a film time: ");
            time1 = new JRadioButton("13:00", true);
            time2 = new JRadioButton("15:00", false);
            time3 = new JRadioButton("17:00", false);
            time4 = new JRadioButton("19:00", false);
            time5 = new JRadioButton("21:00", false);

            ButtonGroup group = new ButtonGroup();
            group.add(time1);
            group.add(time2);
            group.add(time3);
            group.add(time4);
            group.add(time5);
            panel6.add(time);
            panel6.add(time1);
            panel6.add(time2);
            panel6.add(time3);
            panel6.add(time4);
            panel6.add(time5);
            time1.addActionListener(this);
            time2.addActionListener(this);
            time3.addActionListener(this);
            time4.addActionListener(this);
            time5.addActionListener(this);
            frame.add(title);
            frame.add(panel1);
            frame.add(panel2);
            frame.add(panel3);
            frame.add(panel4);
            frame.add(panel5);
            frame.add(panel6);
            frame.setPreferredSize(new Dimension(700, 350));
            frame.setTitle("Cinema Booking");
            frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
            frame.pack(); //sets appropriate size for frame
            frame.setVisible(true); //makes frame visible

    }

    // Calculates Charge Due for current transaction.
    public double calcChargeDue(){
        DecimalFormat df = new DecimalFormat("#.##");
        double chargeDue = 0.0;
        chargeDue = (a*childticket.price) + (b*oapticket.price) + (c*adultticket.price);
        totalprice.setText("£"+df.format(chargeDue));
        return chargeDue;
    }

    // Method to check if the number of people matches the number of seats selected.
    public void check(){
        int check = coupon.size();
        int noTickets = a + b + c;
        if (check != noTickets){
            submit.setEnabled(false);
        }
        else {
            submit.setEnabled(true);
        }

    }

    // Ticket Object
    public class Ticket {

        double price;

        // Constructor
        public Ticket(double cost) {
            price = cost;
        }

        public double getTicketPrice() {
            return price;
        }

    }

    public void actionPerformed(ActionEvent e)
    {

        a = Integer.parseInt(child.getText());
        b = Integer.parseInt(oap.getText());
        c = Integer.parseInt(adult.getText());

        for(int y = 0; y < 4; y++){
            for(int x = 0; x < 4; x++){

                lselected = l[x][y].isSelected();
                rselected = r[x][y].isSelected();

                if (e.getSource() == l[x][y]) {
                    if(lselected == true){
                        coupon.add(e.getActionCommand());
                        calcChargeDue();
                        check();
                    }
                    else {
                        coupon.remove(e.getActionCommand());
                        check();
                    }
                }

                if (e.getSource() == r[x][y]) {
                    if(rselected == true){
                        coupon.add(e.getActionCommand());
                        calcChargeDue();
                        check();
                    }
                    else {
                        coupon.remove(e.getActionCommand());
                        check();
                    }
                }

                if (e.getSource() == oap){
                    calcChargeDue();
                    check();
                }

                if (e.getSource() == adult){
                    calcChargeDue();
                    check();
                }

                if (e.getSource() == child){
                    calcChargeDue();
                    check();
                }

            }
        }

        for(int y = 0; y < 2; y++){
            for(int x = 0; x < 4; x++){

                mselected = m[x][y].isSelected();

                if (e.getSource() == m[x][y]) {
                    if(mselected == true){
                        coupon.add(e.getActionCommand());
                        calcChargeDue();
                        check();
                    }
                    else {
                        coupon.remove(e.getActionCommand());
                        check();
                    }
                }
            }
        }

        if(time1 == e.getSource()){

        }

        if(time2 == e.getSource()){

        }

        if(time3 == e.getSource()){

        }

        if(time4 == e.getSource()){

        }

        if(time5 == e.getSource()){

        }

        if(submit == e.getSource()) {

            for(int y = 0; y < 4; y++){
                for(int x = 0; x < 4; x++){

                    lselected = l[x][y].isSelected();
                    rselected = r[x][y].isSelected();

                    if (lselected == true) {
                            l[x][y].setEnabled(false);
                    }

                    if (rselected == true) {
                            r[x][y].setEnabled(false);
                    }

                }
            }

            for(int y = 0; y < 2; y++){
                for(int x = 0; x < 4; x++){

                    mselected = m[x][y].isSelected();

                    if (mselected == true) {
                            m[x][y].setEnabled(false);
                    }
                }
            }

            Collections.sort(coupon);
            System.out.println("Here's your ticket:");
            System.out.println(coupon);
            System.out.println("Child: " + child.getText());
            System.out.println("Adult: " + adult.getText());
            System.out.println("OAP: " + oap.getText());
            System.out.println("Total Price: " + totalprice.getText());
            System.out.println("Thank you. Enjoy your film.");
            System.out.println(" ");
            coupon.clear();
            child.setText("0");
            adult.setText("0");
            oap.setText("0");
        }

    }

    // Main Class
    public static void main(String[] args) {
            new cinemaSystem(); //makes new ButtonGrid with 2 parameters
    }
} 
```

相关：[多预订系统](https://stackoverflow.com/questions/10094558/java-multiple-bookings-system)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-10T16:43:39.953

解决方案是使用一个`List<AbstractButton>`或一个数组，然后循环通过列表或数组检查以查看哪些按钮`isSelected()`返回 true。

但是，为了获得更好的帮助，请发布您的代码。

# python - Python中模除的奇数输出

> ID：10092356
> 
> 赞同：1
> 
> 时间：2012-04-10T16:08:43.943
> 
> 标签：python

给定以下示例：

```
seconds = totalTime % 60
minutes = (totalTime - seconds) % (60 ** 2)
hours = (totalTime - (minutes * 60)) / (60 ** 2)

finalTime = '{0:.0f}h {1:.0f}m {2:.0f}s'.format(hours, minutes, seconds) 
```

例如，当我将 totalTime 设置为 7000 时（不到两个小时），我得到以下回报：

```
-55h 3360m 39s 
```

咦！？我给它的任何数字都会发生这种情况......如果有帮助，这里还有一个例子：

```
totalTime = 10000

-44h 2760m 39s 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-04-10T16:12:54.070

您正在以秒为单位测量分钟。要修复您的代码，您应该除以`minutes`60：

```
minutes = (totalTime - seconds) % (60 ** 2) / 60 
```

但是，有更简单的方法可以做到这一点，例如

```
hours, seconds = divmod(totalTime, 60 ** 2)
minutes, seconds = divmod(seconds, 60) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-10T16:13:56.350

你`minutes`实际上是以秒为单位测量的。在某处除以 60。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-10T16:16:40.867

嗯，我认为正确的表达方式是：

```
seconds = totalTime % 60
minutes = (totalTime / 60) % 60
hours = totalTime / (60 ** 2) 
```

# ruby-on-rails - 如何在ruby中使用两个参数异步运行exe？

> ID：10092357
> 
> 赞同：5
> 
> 时间：2012-04-10T16:08:49.837
> 
> 标签：ruby-on-rails, ruby, ruby-on-rails-3, shell, rubygems

当我打开页面时，exe 应该运行。异步进程需要运行。

有没有办法在ruby中使用两个参数异步运行exe？

我已经尝试过 ruby​​ 命令 - system() ， exec() 但它正在等待过程完成。我需要使用参数启动 exe 无需等待过程完成

是否有任何 ruby​​gems 将支持我的问题？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-04-10T17:36:22.467

您可以使用[`Process.spawn`](http://www.ruby-doc.org/core-1.9.3/Process.html#method-c-spawn)和[`Process.wait2`](http://www.ruby-doc.org/core-1.9.3/Process.html#method-c-wait2)：

```
pid = Process.spawn 'your.exe', '--option'

# Later...
pid, status = Process.wait2 pid 
```

您的程序将作为解释器的子进程执行。除此之外，它的行为就像是从命令行调用的一样。

您还可以使用[`Open3.popen3`](http://www.ruby-doc.org/stdlib-1.9.3/libdoc/open3/rdoc/Open3.html#method-c-popen3)：

```
require 'open3'
*streams, thread = Open3.popen3 'your.exe', '--option'

# Later...
streams.each &:close
status = thread.value 
```

这里的主要区别是您可以访问三个[`IO`](http://www.ruby-doc.org/core-1.9.3/IO.html)对象。进程的标准输入、输出和错误流按顺序重定向到它们。

如果您打算使用程序的输出，或者通过其标准输入流与它通信，这非常有用。通常会在终端上打印的文本将改为可用于您的脚本。

您还将获得一个等待程序完成执行的线程，这既方便又直观。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-10T16:17:24.343

`exec`将控制权切换到新进程并且永不返回。`system`创建一个子进程并等待它完成。

您可能想要做的是`fork`然后`exec`创建一个新进程而不等待它返回。您还可以使用`win32ole`可能[会给您更多控制](http://rubyonwindows.blogspot.ca/2007/05/launching-apps-and-printing-docs-with.html)的库。

# c# - 从文件夹中删除文件时触发 Cassette.AssetReferenceException

> ID：10092360
> 
> 赞同：1
> 
> 时间：2012-04-10T16:08:58.463
> 
> 标签：c#, asp.net-mvc-3, cassette

我曾经在 .js 中有一个 .js 文件`/Public/javascripts/jquery1.1js`。

一切正常，但后来我需要从我的项目中删除这个文件，所以我只是从 Visual Studio 的解决方案中删除了它。

现在，当我访问我的应用程序时，我得到：

> “~/Public/javascripts/jquery.unobtrusive-ajax.js”中的参考错误，第 1 行。找不到“~/Public/javascripts/jquery-1.5.1.js”。“~/Public/javascripts/jquery.validate.unobtrusive.js”中的参考错误，第 1 行。找不到“~/Public/javascripts/jquery-1.5.1.js”。
> 
> 说明：执行当前 Web 请求期间发生未处理的异常。请查看堆栈跟踪以获取有关错误及其源自代码的位置的更多信息。
> 
> 异常详细信息：Cassette.AssetReferenceException：“~/Public/javascripts/jquery.unobtrusive-ajax.js”中的引用错误，第 1 行。找不到“~/Public/javascripts/jquery-1.5.1.js”。“~/Public/javascripts/jquery.validate.unobtrusive.js”中的参考错误，第 1 行。找不到“~/Public/javascripts/jquery-1.5.1.js”。

这是一个堆栈跟踪：

```
[AssetReferenceException: Reference error in "~/Public/javascripts/jquery.unobtrusive-ajax.js", line 1\. Cannot find "~/Public/javascripts/jquery-1.5.1.js".
Reference error in "~/Public/javascripts/jquery.validate.unobtrusive.js", line 1\. Cannot find "~/Public/javascripts/jquery-1.5.1.js".]
   Cassette.BundleContainer.ValidateAssetReferences() +387
   Cassette.BundleContainer..ctor(IEnumerable`1 bundles) +41 
```

当然，我*知道*为什么会这样，Cassette 仍在尝试查找已删除的文件，但我不知道如何告诉 Cassette：“ `Hey, this file is no longer relevant. Scan the folder again and rebuild a list of files you need to work with.`”

但我只是不知道如何做到这一点。

该[文档](http://getcassette.net/documentation/)没有提及这一点，只是暗示它应该为我自动执行此操作。

这是我的配置类：

```
using Cassette.Configuration;
using Cassette.Scripts;
using Cassette.Stylesheets;

namespace XXX.WebUI
{
    /// <summary>
    /// Configures the Cassette asset modules for the web application.
    /// </summary>
    public class CassetteConfiguration : ICassetteConfiguration
    {
        public void Configure(BundleCollection bundles, CassetteSettings settings)
        {
            bundles.AddPerIndividualFile<ScriptBundle>("Public/javascripts/");
            bundles.AddPerIndividualFile<StylesheetBundle>("Public/stylesheets/");
        }
    }
} 
```

在我的 _Layout.cshtml 文件中：

```
@{
    Bundles.Reference("Public/javascripts/site.js");
    Bundles.Reference("Public/javascripts/jquery.validate.unobtrusive.js");
    Bundles.Reference("Public/stylesheets/site.less");
}
<!DOCTYPE html>
    ...

    <head>
        <title>@ViewBag.Title</title>
        @Bundles.RenderStylesheets()

            ...
        @Bundles.RenderScripts()
    </body> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-11T22:18:19.857

`jquery.validate.unobtrusive.js`该文件的顶部是否包含 JavaScript 引用`jquery-1.5.1.js`？

该行看起来像：

```
 /// <reference path="jquery-1.5.1.js" /> 
```

如果是这样，请删除该行。Cassette 使用这些参考来确定构建顺序。

参考： http: [//getcassette.net/documentation/scripts](http://getcassette.net/documentation/scripts)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-07-10T16:58:47.433

如果您引用具有相同根目录的文件，也会发生这种情况

例如 easyXDM.js 和 easyXDM.debug.js

当您引用 easyXMD.js 时，它会给出异常，并且解决方案似乎是使用不同的命名约定来确保根不同，例如 easyXMDdebug.js。

# hibernate - 使用hibernate通过注解生成一对多关系

> ID：10092363
> 
> 赞同：0
> 
> 时间：2012-04-10T16:09:26.013
> 
> 标签：hibernate, hibernate-mapping, hibernate-annotations

我只是学习 Spring MVC 和 Hibernate 技术的初学者。我正在尝试使用休眠来访问我的数据库，并且我正在使用注释方法将我的 bean 配置到数据库。我正在尝试建立一对多的关系，这让我犯了错误。

基本上我是一个“一次使用可以发布多个测验”的关系

配置休眠时的错误是：
**org.hibernate.AnnotationException：使用@OneToMany 或@ManyToMany 以未映射类为目标：bean.User.quizPosted[bean.Quiz] 使用@OneToMany 或@ManyToMany 以未映射类为目标：bean.User .quizPosted[bean.Quiz]**

我的两个豆子的代码是：

用户.java

```
 package bean;

    import java.util.HashSet;
    import java.util.Set;

    import javax.persistence.Column;
    import javax.persistence.Entity;
    import javax.persistence.GeneratedValue;
    import javax.persistence.GenerationType;
    import javax.persistence.Id;
    import javax.persistence.JoinColumn;
    import javax.persistence.ManyToOne;
    import javax.persistence.OneToMany;
    import javax.persistence.Table;
    import javax.persistence.UniqueConstraint;

    @Entity
    @Table(name="User", uniqueConstraints ={@UniqueConstraint(columnNames="userName"})})
    public class User {
        @Id
        @GeneratedValue(strategy = GenerationType.AUTO)
        private Integer id;

        @ManyToOne(targetEntity=Person.class)
        @JoinColumn(name="PersonId")
        private Person person;

        @Column(name="userName")
        private String userName;

        @Column(name="password")
        private String password;

        @Column(name="role")
        private String role;

        @OneToMany(mappedBy = "postedBy")
        private Set<Quiz> quizPosted = new HashSet<Quiz>();

        @OneToMany(mappedBy = "userId")
        private Set<User_Quiz> user_Quizs = new HashSet<User_Quiz>();
    } 
```

和 quiz.java

```
 package bean;

    import java.sql.Date;
    import java.util.HashSet;
    import java.util.Set;

    import javax.persistence.Column;
    import javax.persistence.Entity;
    import javax.persistence.GeneratedValue;
    import javax.persistence.GenerationType;
    import javax.persistence.Id;
    import javax.persistence.JoinColumn;
    import javax.persistence.ManyToOne;
    import javax.persistence.OneToMany;
    import javax.persistence.Table;
    import javax.persistence.UniqueConstraint;

    @Entity
    @Table(name = "Quiz")
    public class Quiz {

        @Id
        @GeneratedValue(strategy = GenerationType.AUTO)
        private Integer quizId;

        @Column(name = "duration")
        private Integer duration;

        @Column(name = "date")
        private Date date;

        @ManyToOne(targetEntity = User.class)
        @JoinColumn(name = "postedBy")
        private User postedBy;

        @OneToMany(mappedBy="quizId")
        private Set<User_Quiz> user_Quizs = new HashSet<User_Quiz>();        

    } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-10T17:51:41.177

您的已定义注释类中有未映射的类，这意味着您在 OnetoMany 和 ManyToOne 关系中使用的所有类必须在应用程序上下文中定义，因为您已定义您正在使用 spring。在您的会话工厂中，在 annotatedClasses 属性中添加您的类。

```
 <bean id="sessionFactory" class="org.springframework.orm.hibernate3.annotation.AnnotationSessionFactoryBean">
   <property name="dataSource" ref="dataSource"/>
   <property name="annotatedClasses">
     <list>
       <value>test.package.Foo</value>
       <value>test.package.Bar</value>
     </list>
   </property>
 </bean> 
```

请参阅[带注释的会话工厂](http://static.springsource.org/spring/docs/2.5.x/api/org/springframework/orm/hibernate3/annotation/AnnotationSessionFactoryBean.html)

# r - R arules - 匹配规则的事务子集

> ID：10092365
> 
> 赞同：4
> 
> 时间：2012-04-10T16:09:30.087
> 
> 标签：r, subset, arules

我正在使用 R 包[arules](http://cran.r-project.org/web/packages/arules/index.html)。我有一些交易和规则（见下文）。*我想要违反*规则的交易子集。我怎样才能做到这一点？

这是设置：

```
library(arules)
data(Adult)
summary(Adult)
rules = apriori(Adult,parameter=list(support=0.2,confidence=0.8))
summary(rules)
r=rules[1] 
```

`r`我想要包含规则左侧但不包含右侧的事务子集。arules 文档没有这样的示例。我已经尝试过`%in%`，`match`但`subset`我无法正确使用语法。

该`subset`函数的文档有子集规则的示例，但没有子集事务的示例。

[http://rss.acs.unt.edu/Rdoc/library/arules/html/subset.html](http://rss.acs.unt.edu/Rdoc/library/arules/html/subset.html)

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-14T10:44:39.607

实际上，arules 上下文中的子集语法与任何其他上下文非常相似：您可能想尝试以下操作：

```
subset(transactions, items %in% lhs(r) & !items %in% rhs(r) ) 
```

我希望这有帮助！

# java - 将字符串解析为“yyyy”形式的日期

> ID：10092373
> 
> 赞同：1
> 
> 时间：2012-04-10T16:09:44.617
> 
> 标签：java, date, simpledateformat

我需要以“yyyy”格式将字符串解析为年份。我使用的代码片段是

```
try{
        String strDate = "200323";
        SimpleDateFormat formatter = new SimpleDateFormat("yyyy");
        Date dateStr = formatter.parse(strDate);

        System.out.println("The year is " + dateStr);

    }
    catch(Exception e){
        System.out.println("Date parse exception");
    } 
```

问题是，如果我使用一个 4 位数字的字符串，比如“2003”，它会解析为年份，并且输出如预期的那样“年份是 Wed Jan 01 00:00:00 GMT 2003”。但是当我们在上面的代码片段中给出一个超过 4 位的无效字符串时，比如“200323”，它不会抛出解析异常，而是接受字符串值，输出显示为“年份是 Mon Jan 01格林威治标准时间 200323 00:00:00”。任何人都可以提出一个解决方案来解决这个问题或至少让它抛出解析异常吗？我什至在解析之前尝试`formatter.setLenient(false)`过，但它没有显示任何效果。任何帮助表示赞赏。提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-10T16:24:44.870

你的意思是日期范围最多 9999 比你错了朋友

java日期范围是

**开始：** `Sat Jan 01 00:00:00 PST 1`

**结尾：** `Wed Apr 17 21:34:08 PST 292269054`

所以你无法处理。

# oracle - HAVING 子句中的 2x COUNT

> ID：10092375
> 
> 赞同：1
> 
> 时间：2012-04-10T16:10:08.883
> 
> 标签：oracle, count

我有以下问题：我想计算一个表中的数据，计算第二个表中的数据并比较具有子句中的计数，并且只显示具有相同计数的行类似这样的东西：

```
SELECT bla
FROM T1 t1 JOIN T2 t2
ON t1.id = t2.id
HAVING COUNT(counted data from table1) = COUNT(counted data from table2) 
```

你有什么主意吗？干杯

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-10T16:19:08.690

标准 SQL：

```
SELECT t1.bla, t1.id, t1.counter, t2.counter
  FROM (SELECT t1.bla, t1.id, COUNT(counted_data_from_t1) AS counter
          FROM t1
         GROUP BY t1.bla, t1.id
       ) AS t1
  JOIN (SELECT t2.id, COUNT(counted_data_from_t2) AS counter
          FROM t2
         GROUP BY t2.id
       ) AS t2
    ON t1.id = t2.id AND t1.counter = t2.counter 
```

Oracle SQL（因为 Oracle 在表别名之前不喜欢 AS）：

```
SELECT t1.bla, t1.id, t1.counter, t2.counter
  FROM (SELECT t1.bla, t1.id, COUNT(counted_data_from_t1) AS counter
          FROM t1
         GROUP BY t1.bla, t1.id
       ) t1
  JOIN (SELECT t2.id, COUNT(counted_data_from_t2) AS counter
          FROM t2
         GROUP BY t2.id
       ) t2
    ON t1.id = t2.id AND t1.counter = t2.counter 
```

你只需要决定`bla`从哪里来；我提名了`t1`。我假设对于任何给定的 值`t1.id`，都有一个 的值`t1.bla`。如果没有，那么您需要更清楚地解释您在数什么，各个列在哪里，以及表的键是什么。

*更新：*很抱歉没有注意到 Oracle 标签并给出了无效的 Oracle 语法。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-10T17:41:13.927

```
WITH jezyki as 
          (SELECT pseudo_wampira, COUNT(*) AS counter
            FROM Jezyki_obce_w
            GROUP BY pseudo_wampira
          )
    ,sprawnosc as 
         (SELECT pseudo_wampira, sprawnosc, COUNT(*) AS counter
          FROM Sprawnosci_w
         GROUP BY pseudo_wampira, sprawnosc 
         )
      SELECT jezyki.pseudo_wampira, sprawnosc.counter
        FROM jezyki,sprawnosc
       WHERE  jezyki.pseudo_wampira = sprawnosc.pseudo_wampira 
         AND  jezyki.counter = sprawnosc.counter 
```

# groovy - 断言失败的原因

> ID：10092376
> 
> 赞同：0
> 
> 时间：2012-04-10T16:10:11.863
> 
> 标签：groovy

知道什么会导致 Groovy 脚本中的断言失败吗？

```
Exception in thread "Thread-2" groovy.lang.GroovyRuntimeException: exception while dumping process stream
    at org.codehaus.groovy.runtime.ProcessGroovyMethods$ByteDumper.run(ProcessGroovyMethods.java:488)
    at java.lang.Thread.run(Thread.java:619)
Caused by: java.io.IOException: Bad file descriptor
    at java.io.FileInputStream.available(Native Method)
    at java.io.BufferedInputStream.read(BufferedInputStream.java:325)
    at java.io.FilterInputStream.read(FilterInputStream.java:90)
    at org.codehaus.groovy.runtime.ProcessGroovyMethods$ByteDumper.run(ProcessGroovyMethods.java:484)
    ... 1 more 
```

我正在运行带有 JVM 1.6.0_14 的 Groovy 1.8.3。我注意到一个类似的旧错误报告，但我在每个进程启动后执行了一个 waitFor() 调用，据报道它已在 1.6.x 中修复。

我显然无法捕获异常，所以我不知道它到底发生在哪里。但是，我猜它发生在这个代码段中：

```
 def pipedOutputStream = new PipedOutputStream()
  process.consumeProcessOutput(
    new TeeOutputStream(System.out, pipedOutputStream),
    new TeeOutputStream(System.err, pipedOutputStream))
  new PipedInputStream(pipedOutputStream).eachLine {
    (it =~ /condition/).find { process.destroy() }
  }

  System.exit(0) 
```

# c# - 什么属性可以打开控制器的操作以不需要身份验证？

> ID：10092378
> 
> 赞同：1
> 
> 时间：2012-04-10T16:10:16.280
> 
> 标签：c#, asp.net-mvc

我有一个 asp.net mvc 控制器

该页面在 FormsAuthentication 下被阻止

如何进行一项特定操作以不需要 FormsAuthentication？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-10T16:12:42.167

如果您正在运行 MVC 4，则可以使用[`[AllowAnonymousAttribute]`](http://msdn.microsoft.com/en-us/library/system.web.mvc.allowanonymousattribute(v=vs.108).aspx).

如果运行早期版本，还有其他替代方案，例如此处讨论：[https ://stackoverflow.com/a/9363573/358970](https://stackoverflow.com/a/9363573/358970)

# coffeescript - 将参数传递给coffeescript中的嵌套函数

> ID：10092380
> 
> 赞同：0
> 
> 时间：2012-04-10T16:10:23.677
> 
> 标签：coffeescript, casperjs

函数'start'将用户名和密码传递给函数logIn。问题是我得到：

'ReferenceError：找不到变量：用户名'

问题出现在代码段的末尾。在片段的第二个和第三个“@echo”中，变量“用户名”正确显示。

问题是：如何将参数用户名和密码进一步传递给嵌套函数？

片段：

```
logIn = (username, password) ->
        @echo '--- LogIn ---'
        @echo '--- KNOWN HERE = ' + username + " ---"
        @then ->
            @echo '--- username KNOWN HERE = ' +  username + ' ---'
            @evaluate ->
                  @echo '--- @evaluate username NOT KNOWN HERE = ' + username + ' ---' 
```

完整代码：

```
 casper = require('casper').create({
        clientScripts: ["includes/jquery.min.js"],
        verbose: true,
        logLevel: 'debug'
})

    logIn = (username, password) ->
        @echo '--- LogIn ---'
        @echo '--- '+username+' // '+password+" ---"
        @then ->
            @echo '--- username in do = ' +  username + ' ---'
            @evaluate ->
                @echo '--- @evaluate username = ' + username + ' ---'
                $('#id_email').val(username)
                $('#id_password').val(password)
                $('.AuthForm').submit()

    start = -> 
        @start loginURL
        @echo '--- accounts.length = ' + accounts.length + ' ---'
        logIn.call @, accounts[currentAccount][0], accounts[currentAccount][1] 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-11T12:05:42.230

您的问题是[Casper#evaluate](http://casperjs.org/#phantom_Casper_evaluate)*在您正在测试的页面中*运行给定函数。除非您将它们传入，否则该页面无法访问测试脚本中的`username`and`password`变量。解决方案是更改

```
@evaluate ->
  ... 
```

到

```
@evaluate ((username, password) ->
  ...
), {username, password} 
```

# foursquare - 在 Foursquare 上声明业务的问题

> ID：10092383
> 
> 赞同：0
> 
> 时间：2012-04-10T16:10:47.390
> 
> 标签：foursquare

我正在尝试在 Foursquare 上声明我的业务，​​但是当我尝试通过电话进行时，我的主要本地号码和主要 800# 都无法正常工作......它告诉我它无法验证该电话号码？这些是主要电话号码？？如果我尝试邮寄验证，我需要以某种方式将其邮寄到我的邮政信箱（布雷肯里奇没有实体邮件递送 - 只有邮政信箱），但是当我尝试将地址完全更改为邮政信箱或只是添加邮政信箱并点击验证按钮，没有任何反应。我已经点击了验证按钮不少于十几次......什么都没有。请帮忙！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-10T17:03:59.423

It sounds like you should file a ticket with Foursquare's support team: [http://support.foursquare.com/home](http://support.foursquare.com/home)

They should be able to help you!

# excel - Excel MATCH + COUNTIF 函数：检索数组中的第 n 个值

> ID：10092384
> 
> 赞同：3
> 
> 时间：2012-04-10T16:10:50.807
> 
> 标签：excel, function, countif, excel-match

我有一个公式，我在 Excel 中使用它来返回与指定值匹配的第一个项目的行号。

公式：`=MATCH(0,COUNTIF($B$1,List),0)`+ `CTRL`+ `SHIFT`+`ENTER`在 Mac 中：`CMD`+`RETURN`

变成：

```
MATCH(0,{**0**;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0},0) 
```

输出：1

我想更新函数，以便找到与指定值匹配的第二个、第三个等实例。

像这样：

```
MATCH(0,{0;**0**;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0},0) 
```

这输出：2

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-10T17:10:41.960

您当前的公式是否找不到列表中与 B1**不匹配的第一个值的位置？**

第二次尝试这个数组公式

`=SMALL(IF(List<>$B$1,ROW(List)-MIN(ROW(List))+1),2)`

`2`用任何值 n替换第n 个匹配项。假设列表是单列

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-06-12T07:17:14.707

您可以在每次找到事件时动态移动列表，以便下次出现时，列表将从找到的最后一个位置开始。

用这个`MATCH(<Match value>,INDIRECT(" <column of data> " & <Last position found> +1 & ":<Column of Data><Last Row Of Data>"),0)+<Last position found>`

请看这个：[过滤器动态](http://www.ferdinet.blogspot.com/2013/07/filtre-dynamique-avec-formule-excel.html)

# spring - 测试 RabbitMQ 和 Spring 集成

> ID：10092385
> 
> 赞同：3
> 
> 时间：2012-04-10T16:10:51.043
> 
> 标签：spring, testing, integration, rabbitmq

我正在使用 Spring Integration 和 RabbitMq 开发一个应用程序，我想知道如何测试它（集成测试）。

我认为 SoapUI 可能是一个很好的解决方案，但它不支持 RAbbitMq，hermesjms.com 支持 Qpid，所以我认为做一个新插件来支持 Rabbitmq 可能很容易，但由于该项目，它比我想象的要困难有点旧，并且有很多依赖项。所以我开始考虑自己做一些事情，比如python中的DSL，像这样：

```
tests = [{ 'name': 'start',
    'routing_key': 'returned',
    'payload' : "xxxxx",
    'timeOut' : '10000',
    'expected': '',
    'threads': '1'
},
{ 'name': 'second',.....
] 
```

然后使用 Pika 执行操作并检查结果。

我知道这很愚蠢，sopaui 又大又棒，但至少它可以让我做一些小测试。

你会推荐什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-15T21:26:27.137

RabbitMQ 为您提供了一个 Webfrontend（所谓的管理视图[1](http://www.rabbitmq.com/management.html)）。

所以：你到底想测试什么？比方说，您想验证*requestChannel*上的传入消息是否向下传递到服务并返回，您可以直接自动连接通道（即*@Autowired* *private Channel requestChannel;*）并将消息放入其中。

但是，只有当您正确设计架构时：流程的每个步骤都可以使用模拟或特殊修改的注入依赖项进行测试。

除了您自己的组件之外，这些可测试性还适用于弹簧组件（接口）。假设您已经实现了自己的路由器：测试并验证输入和输出。变压器也是如此。

如果您尝试验证“bic picture”，您将不得不重建完整的场景。但是对于非持久和非持久的队列和消息，这不应该那么复杂。

你还有什么要测试的吗？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-09-17T13:11:17.687

对于 rabbitMq，我的建议是使用真正的 RabbiMQ：这可以通过使用 Vagrant with chef 来配置 RabbitMq 和 Vagrant maven 插件来在集成测试之前启动 Box 并在集成测试的后期停止它：

Vagrant Maven 插件： http: [//nicoulaj.github.io/vagrant-maven-plugin/](http://nicoulaj.github.io/vagrant-maven-plugin/)

流浪者网站：[http ://www.vagrantup.com/](http://www.vagrantup.com/)

RabbitMQ 食谱厨师：[https ://github.com/opscode-cookbooks/rabbitmq](https://github.com/opscode-cookbooks/rabbitmq)

总结一下，您必须：

1.  安装 Vagrant 并创建一个空 Box（Centos 或 Ubunutu）。
2.  使用 rabbitMQ cookbook 配置 VM。
3.  将 .box 放入您的主文件夹（rabbitMQ.box）。
4.  配置您的 maven 项目以在集成测试的前期使用 vagrant up (~/rabbitMQ.box) 启动 VM。
5.  配置您的 maven 项目以在集成测试的前期使用 vagrant halt (~/rabbitMQ.box) 停止 VM。

希望这有帮助

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-08-11T08:04:49.620

RabbitMQ 现在有一个 HTTP API，所以你可以使用它而不是它的 JMS

[http://hg.rabbitmq.com/rabbitmq-management/raw-file/rabbitmq_v2_8_4/priv/www/api/index.html](http://hg.rabbitmq.com/rabbitmq-management/raw-file/rabbitmq_v2_8_4/priv/www/api/index.html)

# javascript - 已知类时获取 attr

> ID：10092390
> 
> 赞同：-1
> 
> 时间：2012-04-10T16:11:15.333
> 
> 标签：javascript, jquery

这是一些代码： http: [//jsfiddle.net/T65E3/3/](http://jsfiddle.net/T65E3/3/) 我想得到一个`attr`当我知道的时候`class`

```
$("#find").click(function() {
    $("#test").append($("#file").find("a.higlight").attr("rel"));
}); 
```

和 html

```
 <div id="file">
<ul>
<li>
        <a class="higlight" rel="a">value_my</a>
        <a class="sth" rel="b">val</a>
        <a class="sth" rel="c">val2</a>
        <a class="sth" rel="d">val3</a>

</li>
</ul>
</div>

<button type="submit" id="find">find</button>
<div id="test"></div> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-10T16:19:18.260

您的代码原样（如果您包含 jQuery，则您的示例有 MooTools），工作正常。我只想指出一件事。

```
$("#file").find("a.higlight").attr("rel") // 'a' 
```

这只会返回`rel`第一个匹配元素的属性。要获取所有`rel`属性（如果有多个元素），您可以使用`.map`.

```
$("#file").find("a.sth").attr("rel") // 'b'

$("#file").find("a.sth").map(function(){
    return this.rel;
}).get(); // ['b','c','d'] 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-10T16:15:25.527

我建议您使用 text() 方法而不是 append 将文本添加到元素中；但您的主要问题是您调用 MooTools onload 而不是 jQuery。如果你改变它，你的脚本运行得很好。

# iphone - 应用审核流程 - 添加视频

> ID：10092395
> 
> 赞同：-1
> 
> 时间：2012-04-10T16:11:31.290
> 
> 标签：iphone, objective-c, youtube-api

我已将 youtube 视频集成到我的应用程序中。我已经包含了一个电影预告片作为示例视频。现在我要提交应用程序供苹果审查。我需要知道他们是否会因为该应用包含电影预告片而拒绝该应用？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-10T17:25:26.807

如果您不拥有该视频，Apple 很可能会拒绝该应用程序。如果您使用该视频，您将侵犯他人的版权。如果（如果）这个应用程序确实获得了批准，那么您可能需要为在您的应用程序上放置这些内容负责。提交应用即表示您同意对您的应用承担 100% 的责任，因此他们会追随您而不是苹果。您需要获得视频所有者的书面许可，或删除视频。

安全地玩，要么自己制作一个小视频，要么找一个没有版权的视频。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-10T18:11:49.427

正如其他人所提到的，您*应该*对正在播放的视频（以及其他任何内容）拥有合法权利。

我只是想补充一点，在尝试播放视频时，如果应用程序没有互联网连接（即它不应该使应用程序崩溃），它应该会正常失败......因为这可能是拒绝的原因。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-16T11:56:11.923

众所周知，Apple 在其规则、法规和版权方面有多么严格。您不应侵犯他人的版权。Apple 可能会因此拒绝您的申请。您应该拥有关于您的应用程序的所有内容（如图像、声音、电影文件等）。

**解决方案**：- 创建一个短片并使用它，或者您可以使用任何已获得许可的开源电影，因为任何人都可以使用它（这不是其他人的版权）。

# java - sd卡中保存的chaging目录

> ID：10092396
> 
> 赞同：1
> 
> 时间：2012-04-10T16:11:39.120
> 
> 标签：java, android, sd-card

我创建了此代码以将 pdf 文件保存在 sd 卡中，但我想将保存文件的目录从 /sdcard/ 更改为 /sdcard/MYDIR/

```
 try {
            URL url = new URL(f_url[0]);
            URLConnection conection = url.openConnection();
            conection.connect();
            // getting file length
            int lenghtOfFile = conection.getContentLength();

            // input stream to read file - with 8k buffer
            InputStream input = new BufferedInputStream(url.openStream(), 8192);

            // Output stream to write file
            OutputStream output = new FileOutputStream("/sdcard/yes.pdf"); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-10T16:20:00.020

要在 Java中创建目录，请使用`mkdir()`或`mkdirs()`。`File`

要在 Android 的外部存储上**正确**创建目录或文件，请**不要**硬编码`/sdcard`，主要是因为它在大多数 Android 设备上是错误的值。用于`Environment.getExternalStorageDirectory()`访问外部存储的根目录。

```
File dir=new File(Environment.getExternalStorageDirectory(), "MYDIR");

dir.mkdir();

OutputStream output=new FileOutputStream(new File(dir, "yes.pdf")); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-10T16:20:07.463

您需要的课程是[File](http://developer.android.com/reference/java/io/File.html)。那里有类似的方法`mkdirs()`可以创建必要的目录。

您应该确保不在应用程序中使用硬编码路径。在某些设备上，您`"/sdcard/"`将失败。检查类[Environment](http://developer.android.com/reference/android/os/Environment.html)并使用`getExternalStorageDirectory()`获取 sd 卡的路径。

# javascript - 用一个正则表达式解析复杂字符串

> ID：10092397
> 
> 赞同：0
> 
> 时间：2012-04-10T16:11:40.863
> 
> 标签：javascript, regex

我怎样才能从这个字符串中得到

```
genre:+Drama,Comedy+cast:+Leonardo+DiCaprio,Cmelo+Hotentot+year:+1986-1990 
```

这个

```
genre: [Drama, Comedy],
cast: [Leonardo DiCaprio, Cmelo Hotentot],
year: [1986-1990] 
```

用一个正则表达式？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-10T16:27:47.863

您不会从一开始就将它们放入数组中，但是如果顺序始终保持不变，则可以对其进行解析。

```
var str = "genre:+Drama,Comedy+cast:+Leonardo+DiCaprio,Cmelo+Hotentot+year:+1986-1990";
str = str.replace(/\+/g," ");

//Get first groupings
var re = /genre:\s?(.+)\scast:\s?(.+)\syear:\s(.+)/
var parts = str.match(re)

//split to get them into an array
var genre = parts[1].split(",");
var cast = parts[2].split(",");
var years = parts[3];

console.log(genre); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-10T19:34:35.770

这可以使用一个正则表达式和`replace`带有替换器的函数重载作为第二个参数来完成。但老实说，我必须再使用一个`replace`来摆脱加号 ( `+`) - 我用空格 ( `) 字符替换它们：`

 ````
var str = 'genre:+Drama,Comedy+cast:+Leonardo+DiCaprio,Cmelo+Hotentot+year:+1986-1990';
str = str.replace(/\+/g, ' ');
var result = str.replace(/(\w+:)(\s?)([\w,\s-]+?)(\s?)(?=\w+:|$)/g, function (m, m1, m2, m3, m4, o) {
    return m1 + ' [' + m3.split(',').join(', ') + ']' + (o + m.length != str.length ? ',' : '') + '\n';
}); 
```

您可以在[jsfiddle](http://jsfiddle.net/rHcVB/)上找到完整的示例。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-10T16:28:12.683

您不能仅使用正则表达式来执行此操作，因为您正在尝试解析（微小的）语法。`

# windows - 使用 SEH 保护我的代码免受第三方 COM 对象抛出的异常是否合理

> ID：10092399
> 
> 赞同：1
> 
> 时间：2012-04-10T16:11:41.740
> 
> 标签：windows, exception, com, seh

我正在保护我自己的 C++ 代码（Windows x86）免受第三方 COM 对象中的异常影响，并使用以下 SEH 伪代码记录这些异常。

```
__try {
    hr = m_ComObj->SomeFunc();
} __except ( LogExceptionInfo(GetExceptionCode(), GetExceptionInformation()) ) {
    hr = E_UNEXPECTED;
    m_ComObjCrashed = true;
} 
```

如果 SEH 代码不存在，这种方法是否可能捕获将要处理的异常？

下面的一篇 MSDN 文章提到，默认的未处理异常过滤器将捕获并修复代码在加载的资源中写入内存的情况。在其他情况下，使用 SEH 会干扰理想的默认操作系统行为吗？

[Win32™ 结构化异常处理深度速成课程](http://www.microsoft.com/msj/0197/exception/exception.aspx)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-11T04:01:16.340

是的，这很合理。

它将捕获 COM 函数中未处理的所有异常

我没有看到任何与默认操作系统行为有关的干扰问题

# ajax - 使用 JS 应用程序 (spine.js) 放置、删除

> ID：10092404
> 
> 赞同：0
> 
> 时间：2012-04-10T16:12:04.220
> 
> 标签：ajax, node.js, express, spine.js

我正在为我的 spin.js 应用程序在 node.js (express) 中编写一个小 api。在数据库中获取和创建新对象运行良好。但是在删除/编辑时，我现在遇到了问题。每个对象都有一个由 JS 应用程序创建的单独的 id。在数据库中，每个条目也都有一个唯一的键。

当我调用 object.destroy() 时，我可以看到发送到我的服务器的 ajax 请求。但作为 id 的参数，我总是拥有应用程序提供的 id。但是为了删除/更新数据库中的东西，我需要存储在数据库中的密钥（在我的例子中是 mongoDB）那么我怎样才能将正确的 id 发送到服务器或识别服务器端的正确条目！？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-10T18:26:01.070

为什么不在创建模型时返回正确的 id，如 Spine[文档](http://spinejs.com/docs/ajax)中所示。

> 创建新的 Page 记录后，Spine 会向 /pages 发送一个 POST 请求，其中包含以下内容：

```
 POST /pages HTTP/1.1 Host: spine-rails3.herokuapp.com Accept:
  application/json, text/javascript, */*; q=0.01 Content-Type:
  application/json; charset=UTF-8 X-Requested-With: XMLHttpRequest
  Content-Length: 65

  {"name":"Dummy page","id":"EEAF4B17-5F1D-4C06-B535-D9B58D84142F"} 
```

> 然后服务器应该以这样的方式响应：

```
 HTTP/1.1 201 Created Content-Type: application/json; charset=utf-8
 Location: http://spine-rails3.herokuapp.com/pages/196 Content-Length:
 28 Connection: keep-alive

 {"name":"Dummy page","id":1} 
```

# oracle - 从 Oracle 中删除指定行的最佳方法

> ID：10092407
> 
> 赞同：15
> 
> 时间：2012-04-10T16:12:10.213
> 
> 标签：oracle

我有一个项目需要偶尔从六个不同大小的表之一中删除数万行，但它们之间有大约 3000 万行。由于我获得的数据结构，我不知道六个表中的哪个表中有需要删除的行，因此我必须对所有表运行所有删除操作。我已经针对 ID 列构建了一个 INDEX 来尝试加快速度，但如果这样可以加快速度，可以将其删除。

我的问题是，我似乎无法找到一种有效的方法来实际执行删除。出于测试的目的，我正在针对大约 9400 行的单个测试表运行 7384 个删除行。我在 Oracle SQL Developer 中测试了许多可能的查询解决方案：

7384 个单独的`DELETE`语句耗时**203**秒：

```
delete from TABLE1 where ID=1000001356443294;
delete from TABLE1 where ID=1000001356443296;
etc... 
```

7384 个单独的`SELECT`语句耗时**57**秒：

```
select ID from TABLE1 where ID=1000001356443294
select ID from TABLE1 where ID=1000001356443296
etc... 
```

7384 条单独的`DELETE from (SELECT)`语句耗时**214**秒：

```
delete from (select ID from TABLE1 where ID=1000001356443294);
delete from (select ID from TABLE1 where ID=1000001356443296);
etc... 
```

1条`SELECT`语句在 where 中包含 7384个`OR`子句**127.4s**：

```
select ID from TABLE1 where ID=1000001356443294 or ID = 1000001356443296 or ... 
```

1条`DELETE from (SELECT)`语句在 where 中包含 7384个`OR`子句，时间为**74.4s**：

```
delete from (select ID from TABLE1 where ID=1000001356443294 or ID = 1000001356443296 or ...) 
```

虽然最后一个可能是最快的，但经过进一步测试，当从 9000 行表扩展到甚至只有 200,000 行表（仍然小于最终表集大小的 1%）时，它仍然非常慢，其中相同的语句需要**14 分钟**才能完成跑。虽然每行速度快了 50% 以上，但在针对完整数据集运行时，这仍然可以推断出大约一天。我有很好的权威，我们用来完成这项任务的软件可以在大约*20 分钟*内完成。

所以我的问题是：

> *   有没有更好的删除方法？
> *   我是否应该使用一轮`SELECT`语句（即，像第二个测试）来发现任何给定行在哪个表中，然后执行删除查询？即使这样看起来很慢，但是......
> *   我还能做些什么来加快删除速度吗？我没有 DBA 级别的访问权限或知识。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-04-10T18:52:28.853

在回答我的问题之前，我会这样做：

尽量减少相关声明的数量和它们所做的工作。

所有方案都假设您有一个 ID 表 ( `PURGE_IDS`) 可从中删除`TABLE_1`、`TABLE_2`等。

**考虑使用 CREATE TABLE AS SELECT 进行非常大的删除**

如果没有并发活动，并且您要删除一个或多个表中 30+ % 的行，请不要删除；对您希望保留的行执行 a `create table as select`，并将新表换成旧表。 `INSERT /*+ APPEND */ ... NOLOGGING`如果你能负担得起，它会非常便宜。即使您确实有一些并发活动，您也可以使用在线表重新定义来就地重建表。

**不要运行你知道不会删除任何行的 DELETE 语句**

如果一个 ID 值最多存在于六个表中的一个中，则跟踪您删除了哪些 ID - 不要尝试从任何其他表中删除这些 ID。

```
CREATE TABLE TABLE1_PURGE NOLOGGING
AS 
SELECT ID FROM PURGE_IDS INNER JOIN TABLE_1 ON PURGE_IDS.ID = TABLE_1.ID;

DELETE FROM TABLE1 WHERE ID IN (SELECT ID FROM TABLE1_PURGE);

DELETE FROM PURGE_IDS WHERE ID IN (SELECT ID FROM TABLE1_PURGE);

DROP TABLE TABLE1_PURGE; 
```

并重复。

**必要时管理并发**

另一种方法是在表上使用 PL/SQL 循环，发出行数限制的删除语句。如果针对您正在对其运行删除的表有大量的插入/更新/删除并发负载，这很可能是合适的。

```
declare
  l_sql varchar2(4000);
begin
  for i in (select table_name from all_tables 
             where table_name in ('TABLE_1', 'TABLE_2', ...)
             order by table_name);
  loop
    l_sql := 'delete from ' || i.table_name || 
             ' where id in (select id from purge_ids) ' || 
             '   and rownum <= 1000000';
    loop
      commit;
      execute immediate l_sql;
      exit when sql%rowcount <> 1000000;  -- if we delete less than 1,000,000
    end loop;                             -- no more rows need to be deleted!
  end loop;
  commit;
end; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-10T16:28:57.923

将所有要删除的 ID 存储到一个表中。然后有3种方式。1) 遍历表中的所有 ID，然后在 X 提交间隔内一次删除一行。X 可以是 100 或 1000。它适用于 OLTP 环境，您可以控制锁。

2）使用Oracle批量删除

3）使用关联删除查询。

单个查询通常比多个查询更快，因为上下文切换更少，并且可能解析更少。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-10T17:57:49.147

首先，在删除期间禁用索引会很有帮助。

尝试使用 MERGE INTO 语句：
1）创建一个带有 ID 的临时表和 TABLE1 中的附加列，并使用以下内容进行测试

```
MERGE INTO table1 src
USING (SELECT id,col1
         FROM test_merge_delete) tgt
ON (src.id = tgt.id)
WHEN MATCHED THEN
  UPDATE
     SET src.col1 = tgt.col1
  DELETE
   WHERE src.id = tgt.id 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2017-03-22T18:25:49.320

我已经尝试过这段代码，在我的情况下它工作正常。

```
DELETE FROM NG_USR_0_CLIENT_GRID_NEW WHERE rowid IN
( SELECT rowid FROM
  (
      SELECT wi_name, relationship, ROW_NUMBER() OVER (ORDER BY rowid DESC) RN
      FROM NG_USR_0_CLIENT_GRID_NEW
      WHERE wi_name = 'NB-0000001385-Process'
  )
  WHERE RN=2
); 
```

# ruby - 无法安装 Rubygem“链接解析器”

> ID：10092419
> 
> 赞同：0
> 
> 时间：2012-04-10T16:12:48.693
> 
> 标签：ruby, gem, linkparser

我想创建一个聊天机器人，为此我想使用[Link Parser](http://www.link.cs.cmu.edu/link/)，它基本上是一个引擎，可以在查看句子时找出单词之间的关系。

我尝试使用以下方法安装一个[Ruby 包装器：](http://deveiate.org/projects/Ruby-LinkParser)

```
gem install linkparser 
```

并且：

```
gem install linkparser -- --with-link-grammar="C:\Users\Gebruiker\Downloads\Linkparsergrammar\linkgrammar4r-0.0.3" 
```

但是，我不断收到以下错误：

```
Temporarily enhancing PATH to include DevKit...
Building native extensions.  This could take a while...
ERROR:  Error installing linkparser:
        ERROR: Failed to build gem native extension.

C:/Ruby193/bin/ruby.exe extconf.rb --with-link-grammar=C:\Users\Gebruiker\Downloads\Linkparsergrammar\linkgrammar4r-0.0.3
checking for pkg-config... no
Couldn't find your pkg-config binary
*** extconf.rb failed ***
Could not create Makefile due to some reason, probably lack of
necessary libraries and/or headers.  Check the mkmf.log file for more
details.  You may need configuration options.

Provided configuration options:
        --with-opt-dir
        --without-opt-dir
        --with-opt-include
        --without-opt-include=${opt-dir}/include
        --with-opt-lib
        --without-opt-lib=${opt-dir}/lib
        --with-make-prog
        --without-make-prog
        --srcdir=.
        --curdir
        --ruby=C:/Ruby193/bin/ruby
        --with-link-grammar
        --with-pkg-config
        --without-pkg-config

Gem files will remain installed in C:/Ruby193/lib/ruby/gems/1.9.1/gems/linkparser-1.1.3 for inspection.
Results logged to C:/Ruby193/lib/ruby/gems/1.9.1/gems/linkparser-1.1.3/ext/gem_make.out 
```

我在 Windows Vista 32bit 上，并使用最新的 Ruby (1.9.3-p125)

有人可以解释发生了什么吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-10T16:23:16.087

这对您的问题有帮助吗？[在雪豹上安装链接解析器 gem 的问题](https://stackoverflow.com/questions/5113900/problems-on-installing-link-parser-gem-on-snow-leopard)

我知道它适用于 mac，但听起来很相似

# php - 根据列值对子数组进行分组

> ID：10092420
> 
> 赞同：4
> 
> 时间：2012-04-10T16:12:49.840
> 
> 标签：php, arrays, foreach, grouping, array-merge

我有一个数组：

```
[['a', 1], ['b', 1], ['c',2], ['d',2]] 
```

如何根据第二列值对子数组进行分组，如下所示：

```
[[['a', 1], ['b', 1]], [['c',2], ['d',2]]] 
```

我有一个想法用 foreach 解决这个问题，但它可能有内置函数的方法？

用 foreach 素描：

```
$in = [['a', 1], ['b', 1], ['c',2], ['d',2]];
$out = [];

foreach($in as $i) {
    $out[$i[1]][] = $i;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-10T16:28:52.423

你或多或少有我想要的解决方案。

只要您希望用作索引的数据始终位于数组中的相同位置，您就可以像在收集器数组中那样对索引进行硬编码。

如果没有，我会考虑移动到关联数组并为创建数组时要用作索引的值分配一个名称。

```
[['a', 'index'=>1] [etc...]]

$out[$i[index]][] = $i; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2021-04-04T00:52:08.447

没有原生 php 函数可以对索引数组的索引数组的列值进行分组。如果您在谈论关联数组，`array_merge_recursive()`可能会感兴趣。

（[演示](https://3v4l.org/WCqgS)）

基本循环语法：（更简洁，通常更快）

```
$result = [];
foreach ($array as $row) {
    $result[$row[1]][] = $row;
}
var_export($result); 
```

函数式语法：（更具声明性，没有声明新的全局变量）

```
var_export(
    array_reduce(
        $array,
        function ($carry, $row) {
            $carry[$row[1]][] = $row;
            return $carry;
        }
    )
); 
```

如果您希望重新索引结果（删除组键），请调用`array_values()`结果。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-04-10T16:30:46.783

唯一特定于多维数组的 PHP 内置函数似乎是[`array_multisort`](http://php.net/manual/en/function.array-multisort.php)，除非我们可以对输入数组中包含的数据做出假设，否则它不会有太大帮助。

对于小型数据集，您的蛮力示例对我来说似乎很好。

# java - 打印列表数组

> ID：10092424
> 
> 赞同：-3
> 
> 时间：2012-04-10T16:13:19.647
> 
> 标签：java, for-loop, arraylist

我想打印其中每个都有数组元素的列表。

例如，输出应如下所示：

> list[0]={0,1,2,3}
> list[2]={4,5,6,7}
> list[3]={12,17,20,25}
> 等等....

这是我到目前为止得到的：

```
for (int i = 0; i <array.length; i++) {
    for (int j = 0; j < list[i].size(); j++) {
        SegY[i].get(j); SegX[i].get(j);
    }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-10T16:18:28.973

如果您的问题是“我如何打印数组的内容”，您可以使用[`Arrays.deepToString()`方法](http://docs.oracle.com/javase/7/docs/api/java/util/Arrays.html#deepToString%28java.lang.Object%5b%5d%29). 因此，在您的情况下，您可以遍历列表并使用该方法打印每个数组。例如：

```
public static void main(String[] args) throws Exception {
    List<Integer[]> list = new ArrayList<Integer[]>();
    list.add(new Integer[]{1, 2, 3});
    list.add(new Integer[]{4, 5, 6});
    for (Integer[] array: list) {
        System.out.println(Arrays.deepToString(array));
    }
} 
```

# ruby - Little Perl XOR 解码脚本移植到 Ruby

> ID：10092426
> 
> 赞同：1
> 
> 时间：2012-04-10T16:13:29.633
> 
> 标签：ruby, perl

我有一点 Perl 代码（简单的 XOR 解密），我想将它移植到 Ruby 以将其添加到另一个脚本，但我真的迷失了 Ruby 中的 XOR 编码/解码：

```
#!/usr/bin/perl
# XOR password decoder
# Greets: Joni Salonen @ stackoverflow.com

$key = pack("H*","3cb37efae7f4f376ebbd76cd");

print "Enter string to decode: ";
$str=<STDIN>;chomp $str; $str =~ s/\\//g;
$dec = decode($str);
print "Decoded string value: $dec\n";

sub decode{ #Sub to decode
    @subvar=@_;
    my $sqlstr = $subvar[0];
    $cipher = unpack("u", $sqlstr);
    $plain = $cipher^$key;
    return substr($plain, 0, length($cipher));
} 
```

与 perl 一起使用的示例：

```
$ perl cf6deca.pl
Enter string to decode: )4-H5GX\:&G\!6
Decoded string value: likearock 
```

感谢您的帮助和时间。

我想要在 Ruby 中这样的东西：

```
key = ['3cb37efae7f4f376ebbd76cd'].pack('H*')

print "Enter string to decode: "
STDOUT.flush
a_string = gets
a_string.chomp!
a_string = a_string.gsub(/\//, "")
dec = decode(a_string)
puts "Decoded string value: "+dec

def decode(in)
        cipher = in.unpack('u')
        plain = cipher^key;
        plain.slice(len(cipher))
        return plain
end 
```

我知道是一团糟，请帮忙:)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-10T17:14:06.897

只是看看stackoverflow上的一些问题，看来ruby可能没有按位字符串运算符。 [一篇文章](https://stackoverflow.com/questions/7267548/simple-xor-ruby-1-9-2)表明这​​可能有助于提供这样的运营商：

```
class String
  def xor(key)
    text = dup
    text.length.times {|n| text[n] = (text[n].ord ^ key[n.modulo key.size].ord).chr }
    text
  end
end 
```

# wpf - 将 EMF 文件发送到 WPF 应用程序中的特定打印机/托盘

> ID：10092431
> 
> 赞同：1
> 
> 时间：2012-04-10T16:13:43.877
> 
> 标签：wpf, printing, .emf

我有一个 WPF 应用程序，它需要将预先生成的 EMF 文件发送到指定的打印机/托盘。

我不想显示 PrintDialog；实际的打印机/托盘是事先配置好的。我也不需要实际查看 EMF 文件。而是将其发送到打印机。

到目前为止，我在这方面的所有研发都导致了一堆 5 年前的帖子，这些帖子涉及 EMF 和 WPF 以及它是如何不受支持的。

有没有人有过这方面的运气？有人可以指出我正确的方向吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-29T19:41:31.447

事实证明这比我想象的要容易。您可以通过`Image`控制和使用转换器来做到这一点。此示例获取 emf 文件的文件位置，并将其放入 WPF 用户控件中，然后我将其发送到打印机。

在 XAML 中：

```
<Grid Margin="12">
    <Image Source="{Binding Path=FileName, Converter={StaticResource emfImageConverter}, Mode=OneWay}"></Image>
</Grid> 
```

和你的转换器类：

```
[ValueConversion(typeof(string), typeof(BitmapImage))]
public class EmfImageConverter : IValueConverter
{
    public object Convert(object value, Type targetType, object parameter, CultureInfo culture)
    {
        var fileName = (string)value;
        if (fileName == null || !File.Exists(fileName))
            return new BitmapImage();
        using (var stream = File.Open(fileName, FileMode.Open))
        {
            return GetImage(stream);
        }
    }

    internal BitmapImage GetImage(Stream fileStream)
    {
        var img = Image.FromStream(fileStream);
        var imgBrush = new BitmapImage { CacheOption = BitmapCacheOption.OnLoad, CreateOptions = BitmapCreateOptions.PreservePixelFormat };
        imgBrush.BeginInit();
        imgBrush.StreamSource = ConvertImageToMemoryStream(img);
        imgBrush.EndInit();
        return imgBrush;
    }

    public MemoryStream ConvertImageToMemoryStream(Image img)
    {
        var ms = new MemoryStream();
        img.Save(ms, System.Drawing.Imaging.ImageFormat.Png);
        return ms;
    }

    public object ConvertBack(object value, Type targetType, object parameter, CultureInfo culture)
    {
        throw new NotImplementedException();
    }
} 
```

# asp.net-ajax - 更新面板中未触发按钮事件

> ID：10092432
> 
> 赞同：0
> 
> 时间：2012-04-10T16:13:47.120
> 
> 标签：asp.net-ajax

我正在处理上传功能，我的更新面板中有我的文件上传控件。当用户点击上传按钮时，点击事件应该触发插入。在我的代码中，我已经将所有文件上传控件，按钮放在 updatepanel2 中。在 button3_click 上没有事件射击。

```
 <div>
        <asp:UpdatePanel ID="UpdatePanel2" runat="server">
    <ContentTemplate>
        <asp:Panel ID="Panel1" runat="server" CssClass="cpHeader">
            <asp:Label ID="Label1" runat="server" />
        </asp:Panel>

        <asp:Panel ID="Panel2" runat="server" CssClass="cpBody">
       <asp:Label ID="Label6" runat="server" Text="You have not specified a file" 
             Visible="False" ForeColor="#FF3300"></asp:Label>

   <br />

     <asp:FileUpload ID="FileUpload1" runat="server" Width="412px" />
         <br />
         <br />

    <asp:Button ID="Button3" runat="server" Text="Upload" OnClick="Button3_Click" />
     <asp:Button ID="Button4" runat="server" Text="Cancel" />
      <asp:Label ID="Label8" runat="server" ></asp:Label>
         <asp:Label ID="Label9" runat="server"></asp:Label>

        </asp:Panel>

   <cc1:CollapsiblePanelExtender ID="CollapsiblePanelExtender2" runat="server"  
                       TargetControlID="Panel2" ExpandControlID="panel1"
   Collapsed="true" TextLabelID="label1" CollapsedText="Click to UPload a File"                    
    ExpandedText=" Please Select file to Upload " CollapseControlID="Button4"

      CollapsedSize="0">

        </cc1:CollapsiblePanelExtender>

    </ContentTemplate>
    <Triggers>
    <asp:AsyncPostBackTrigger ControlID ="Button3" EventName ="Click" />
    </Triggers>
    </asp:UpdatePanel>
</div>

      My Code behind for Button3_Click.
      Protected Void Button3_click(object sender,eventargs e)
 {
      if (!IsPostBack)
    {
      Button3.Attributes.Add("OnClick", "MyOnButtonClick()");
     string filepath = "~/"+"Uploads/" +   
   Path.GetFileName(FileUpload1.PostedFile.FileName);
            string filename = Path.GetFileName(filepath);
       string strcon =   
    ConfigurationManager.ConnectionStrings["ConnectionString"].ConnectionString;
     if (FileUpload1.HasFile)
  {
  string Viewname = string.Empty;
      using (SqlConnection scn = new SqlConnection(strcon))
       {

    foreach (GridViewRow gvrow in GridView1.Rows)
    {
        CheckBox check_box = (CheckBox)gvrow.FindControl("checkbox1");
        if (check_box != null)
        {
            if (check_box.Checked)
            {
               // perspective = GridView1.DataKeys[gvrow.RowIndex].Value.ToString();
                //Convert.ToString(gvrow.Cells[1].Text);
                perspective = Convert.ToString(gvrow.Cells[1].Text);
            }

            else
                using (SqlCommand csm = scn.CreateCommand())
                {
                    scn.Open();
                    SqlCommand cmd = new SqlCommand("Insert", scn);
                    cmd.CommandType = CommandType.StoredProcedure;
                    cmd.Parameters.Add("@Name", SqlDbType.NVarChar).Value = TextBox1.Text;

                    cmd.Parameters.Add("@View", SqlDbType.NVarChar).Value = Viewname;
                    //conn.Open();
                    cmd.ExecuteNonQuery();
                    scn.Close();
                    FileUpload1.SaveAs(Server.MapPath(filepath));
                    Label8.Text = "FileSuccessfully Uploaded !";

                }

        }
    }
} 
```

} }

# apacheds - Apache 目录工作室

> ID：10092436
> 
> 赞同：3
> 
> 时间：2012-04-10T16:13:57.213
> 
> 标签：apacheds

我已经安装了 Apache Directory Studio，并按照本教程创建了一个简单的服务器。 [http://krams915.blogspot.com/2011/01/ldap-apache-directory-studio-basic.html](http://krams915.blogspot.com/2011/01/ldap-apache-directory-studio-basic.html)

它工作正常。现在我想查看包含服务器接收到的所有查询的日志文件。为此，我启用 Apache Directory Studio -> Preferences -> apache directory Studio -> apache DS -> Server logs -> Level: Debug

还是有更好的方法（查看来自客户端的 LDAP 查询）？

但是，用这个重新启动服务器时，我从 Apache DS 工作室收到一个 Java 堆空间错误。

如本网页所示，我已创建文件 /Applications/Apache\ Directory\ Studio.app/Contents/MacOS/ApacheDirectoryStudio.ini，并将其值加倍： http://directory.apache.org/studio/faqs [。 html](http://directory.apache.org/studio/faqs.html)

但我仍然得到同样的错误。这是为什么？apache ds studio 是否试图加载内存中的所有日志？（甚至是这样，日志文件小于 10Mb...）

如何解决这个问题呢？如果没有简单的解决方案，我会自行安装 Apache DS（不带 Apache DS Studio）；这应该有效。

问候，大卫

# c# - 如何在 XNA 游戏工作室中旋转 Texture2D？

> ID：10092437
> 
> 赞同：4
> 
> 时间：2012-04-10T16:14:00.003
> 
> 标签：c#, xna

嗨，我必须旋转 Texture2D，但我不知道为什么。它就像一张照片，我需要将它旋转 180°，因为它在头上并且应该是正确的。

问题是，我需要在使用之前做`spriteBatch.Draw`，这可能吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-12T20:50:37.577

纹理将旋转 180 度。

```
 protected override void Draw(GameTime gameTime)
    {
        spriteBatch.Begin(SpriteSortMode.Deferred, BlendState.AlphaBlend, SamplerState.LinearWrap, DepthStencilState.None, RasterizerState.CullCounterClockwise, null);
        spriteBatch.Draw(texture, Position, null, Color.White, (float)Math.PI, new Vector2(texture.Width, texture.Height), 1, SpriteEffects.None, 0);
        spriteBatch.End();
        base.Draw(gameTime);
    } 
```

你也可以使用 SpriteEffects 垂直翻转纹理：

```
 protected override void Draw(GameTime gameTime)
    {
        GraphicsDevice.Clear(Color.CornflowerBlue);
        spriteBatch.Begin(SpriteSortMode.Deferred, BlendState.AlphaBlend, SamplerState.LinearWrap, DepthStencilState.None, RasterizerState.CullCounterClockwise, null);
        spriteBatch.Draw(texture, Position, null, Color.White, 0, Vector2.Zero, 1, SpriteEffects.FlipVertically, 0);
        spriteBatch.End();
        base.Draw(gameTime);
    } 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-10T16:16:01.117

该`Draw`方法有一个[重载](http://msdn.microsoft.com/en-us/library/ff433992.aspx)，可以让您旋转纹理。我不确定我是否理解为什么在绘制纹理之前需要旋转纹理。缩放和旋转通常在绘图期间完成。正如 Joel 指出的那样，旋转是使用弧度完成的，您还需要注意原点，即您旋转的点。

# ruby-on-rails - Omniauth : 在 /auth/failure 回调中检索失败的策略名称

> ID：10092438
> 
> 赞同：0
> 
> 时间：2012-04-10T16:14:02.050
> 
> 标签：ruby-on-rails, ruby, ruby-on-rails-3, omniauth

在我的失败回调操作中检索刚刚失败的策略名称的最佳方法是什么？

我是否需要设置一个自定义失败端点只是为了检索策略的名称（我希望不是:)）？

谢谢 ：）。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-10T19:58:51.937

耶 ！

[https://github.com/intridea/omniauth/commit/13c36914c290dae8426359e494262ddab29d49a5](https://github.com/intridea/omniauth/commit/13c36914c290dae8426359e494262ddab29d49a5)

# c# - AutoFixture：配置一个开放的泛型样本生成器

> ID：10092446
> 
> 赞同：10
> 
> 时间：2012-04-10T16:14:29.713
> 
> 标签：c#, generics, autofixture, open-generics

我有一个使用开放泛型的对象模型（是的，是的，现在我有两个问题；这就是我在这里的原因:) :-

```
public interface IOGF<T>
{
}

class C
{
}

class D
{
    readonly IOGF<C> _ogf;

    public D( IOGF<C> ogf )
    {
        _ogf = ogf;
    }
} 
```

我正在尝试让 AutoFixture 生成`D`上述匿名实例。然而，就其本身而言，AutoFixture 没有内置的构建策略`IOGF<>`，因此我们观察到：

```
public class OpenGenericsBinderDemo
{
    [Fact]
    public void X()
    {
        var fixture = new Fixture();

        Assert.Throws<Ploeh.AutoFixture.ObjectCreationException>( () =>
            fixture.CreateAnonymous<D>() );
    } 
```

基本信息是：

> Ploeh.AutoFixture.ObjectCreationException : AutoFixture 无法从 IOGF`1[C] 创建实例，很可能是因为它没有公共构造函数，是抽象或非公共类型。

我很高兴为它提供一个具体的实现：

```
public class OGF<T> : IOGF<T>
{
    public OGF( IX x )
    {
    }
}

public interface IX
{
}

public class X : IX
{
} 
```

以及相关的绑定：

```
fixture.Register<IX,X>(); 
```

我如何（或者我什至应该以这种方式看待问题？？）使以下测试通过？

```
public class OpenGenericsLearning
{
    [Fact]
    public void OpenGenericsDontGetResolved()
    {
        var fixture = new Fixture();
        fixture.Inject<IX>( fixture.Freeze<X>() );

        // TODO register or do something that will provide 
        //      OGF<C> to fulfill D's IOGF<C> requirement

        Assert.NotNull( fixture.CreateAnonymous<D>());
    }
} 
```

（在 codeplex 网站上有关于此的讨论和问题 - 我只需要快速了解一下，如果这只是一个坏主意和/或我错过了一些东西，我愿意删除它）

编辑 2：（另请参阅对 Mark 的回答的评论）这里的（诚然人为的）上下文是对大型“几乎完整的系统”系统被测对象图的验收测试，而不是小型（受控/易于 grok :) 对或三元组单元或集成测试场景中的类。正如自我问题的括号陈述中提到的那样，我并不完全相信这种类型的测试甚至有意义。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-04-10T16:17:01.473

您可以创建一个自定义，其工作方式如下：

```
public class AnOpenGenericsBinderDemo
{
    [Fact]
    public void RegisteringAGenericBinderShouldEnableResolution()
    {
        var fixture = new Fixture();
        fixture.Inject<IX>( fixture.Freeze<X>() );
        fixture.RegisterOpenGenericImplementation( typeof( IOGF<> ), typeof( OGF<> ) );

        Assert.IsType<OGF<C>>( fixture.CreateAnonymous<D>().Ogf );
    }
} 
```

并像这样实现：

```
public static class AutoFixtureOpenGenericsExtensions
{
    public static void RegisterOpenGenericImplementation( this IFixture that, Type serviceType, Type componentType )
    {
        if ( !serviceType.ContainsGenericParameters )
            throw new ArgumentException( "must be open generic", "serviceType" );
        if ( !componentType.ContainsGenericParameters )
            throw new ArgumentException( "must be open generic", "componentType" );
        // TODO verify number of type parameters is 1 in each case
        that.Customize( new OpenGenericsBinderCustomization( serviceType, componentType ) );
    }

    public class OpenGenericsBinderCustomization : ICustomization
    {
        readonly Type _serviceType;
        readonly Type _componentType;

        public OpenGenericsBinderCustomization( Type serviceType, Type componentType )
        {
            _serviceType = serviceType;
            _componentType = componentType;
        }

        void ICustomization.Customize( IFixture fixture )
        {
            fixture.Customizations.Add( new OpenGenericsSpecimenBuilder( _serviceType, _componentType ) );
        }

        class OpenGenericsSpecimenBuilder : ISpecimenBuilder
        {
            readonly Type _serviceType;
            readonly Type _componentType;

            public OpenGenericsSpecimenBuilder( Type serviceType, Type componentType )
            {
                _serviceType = serviceType;
                _componentType = componentType;
            }

            object ISpecimenBuilder.Create( object request, ISpecimenContext context )
            {
                var typedRequest = request as Type;
                if ( typedRequest != null && typedRequest.IsGenericType && typedRequest.GetGenericTypeDefinition() == _serviceType )
                    return context.Resolve( _componentType.MakeGenericType( typedRequest.GetGenericArguments().Single() ) );
                return new NoSpecimen( request );
            }
        }
    }
} 
```

我认为有人有比这更好的实现和/或有一个内置的实现。

编辑：以下是具有感测属性的更新 D：

```
class D
{
    readonly IOGF<C> _ogf;

    public D( IOGF<C> ogf )
    {
        _ogf = ogf;
    }

    public IOGF<C> Ogf
    {
        get { return _ogf; }
    }
} 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-04-10T18:45:22.590

AFICT 看不到开放的泛型。`D`依赖于`IOGF<C>`哪个是构造类型。

错误消息不是因为开放泛型，而是因为`IOGF<C>`是一个接口。

您可以像这样提供从到[的映射](http://blog.ploeh.dk/2010/04/06/MappingTypesWithAutoFixture.aspx)：`IOGF<C>``OGF<C>`

```
fixture.Register<IOGF<C>>(() => fixture.CreateAnonymous<OGF<C>>()); 
```

由于`OGF<C>`依赖于`IX`您还需要提供一个映射到`X`：

```
fixture.Register<IX>(() => fixture.CreateAnonymous<X>()); 
```

这应该够了吧。

但是，正如 Nikos Baxevanis 在他的评论中指出的那样，如果您使用三个提供的自动模拟扩展之一，这基本上可以开箱即用 - 例如

```
var fixture = new Fixture().Customize(new AutoMoqCustomization());
var d = fixture.CreateAnonymous<D>(); 
```

# java - 在子类的构造函数中使用 Builder 模式

> ID：10092458
> 
> 赞同：5
> 
> 时间：2012-04-10T16:15:13.000
> 
> 标签：java, builder

我目前正在使用 Builder 模式，密切关注 Wikipedia 文章*Builder 模式* [http://en.wikipedia.org/wiki/Builder_pattern中建议的 Java 实现](http://en.wikipedia.org/wiki/Builder_pattern)

这是一个示例代码，说明了我的实现

```
public class MyPrimitiveObject {
  private String identifier="unknown";
  public static class Builder {
    private final MyPrimitiveObject obj = new MyPrimitiveObject();
    public MyPrimitiveObject build() { return obj; }
    public Builder setidentifier (String val) {
     obj.identifier = val;
     return this;
    }
  }
  public static Builder createBuilder() { return new Builder(); }
  @Override public String toString() { return "ID: "+identifier; }
} 
```

在我的一些使用这个类的应用程序中，我碰巧发现了非常相似的构建代码，所以我想子类`MyPrimitiveObject`化`MySophisticatedObject`并将我所有重复的代码移动到它的构造函数中......这就是问题所在。

如何调用超类 Builder 并将其返回的对象分配为我的实例？

```
public class MySophisticatedObject extends MyPrimitiveObject {
  private String description;
  public MySophisticatedObject (String someDescription) {
    // this should be the returned object from build() !!
    Builder().setidentifier(generateUUID()).build()
    description = someDescription;
  }     
} 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-10T16:18:50.237

您可能需要考虑使用嵌套`MySophisticatedObject.Builder`的 extends`MyPrimitiveObject.Builder`并覆盖其`build()`方法。在构建器中有一个受保护的构造函数来*接受*要设置值的实例：

```
public class MyPrimitiveObject {
  private String identifier="unknown";
  public static class Builder {
    private final MyPrimitiveObject obj;
    public MyPrimitiveObject build() { return obj; }
    public Builder setidentifier (String val) {
     obj.identifier = val;
     return this;
    }

    public Builder() {
        this(new MyPrimitiveObject());
    }

    public Builder(MyPrimitiveObject obj) {
        this.obj = obj;
    }
  }
  ...
}

public class MySophisticatedObject extends MyPrimitiveObject {
  private String description;

  public static class Builder extends MyPrimitiveObject.Builder {
    private final MySophisticatedObject obj;
    public Builder() {
      this(new MySophisticatedObject());
      super.setIdentifier(generateUUID());
    }     
    public Builder(MySophisticatedObject obj) {
      super(obj);
      this.obj = obj;
    }

    public MySophisticatedObject build() {
      return obj;
    }

    // Add code to set the description etc.
  }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-10T16:21:19.160

你需要：

```
public class MySophisticatedObject extends MyPrimitiveObject {
  private String description;

  public static class SofisitcatedBuilder extends Builder {
    private final MySophisticatedObject obj = new MySophisticatedObject();
    public MyPrimitiveObject build() { return obj; }
    public Builder setDescription(String val) {
     obj.description = val;
     return this;
    }
  }

  public MySophisticatedObject (String someDescription) {
    // this should be the returned object from build() !!
    return new SofisitcatedBuilderBuilder()
         .setDescription(someDescription)
         .setidentifier(generateUUID()).build()
  }     
} 
```

# python - 生产和开发项目环境

> ID：10092459
> 
> 赞同：-1
> 
> 时间：2012-04-10T16:15:14.227
> 
> 标签：python, django

我们有一个使用 Django 在 Python 中开发的遗留工具，并在 Apache mod_python 模块上实时运行。

现在我们在工具中有一个问题，要调试我们没有开发设置。我可以访问 TAR 球中的代码，但我无法启动数据库连接/工具。我想使用与在生产中运行的设置相同的设置，但是使用相同的配置启动应用程序会给我以下错误：

```
python manage.py runserver xx.xxx.xx.xx:xxxx
django.core.exceptions.ImproperlyConfigured: Error loading MySQLdb module: No module named MySQLdb 
```

在 localhost 上运行 MySQL 数据库实例确实解决了这个问题，但它对我没有帮助，因为我无权访问数据集。

请让我知道如何通过仅读取数据集权限访问托管在另一个盒子（能够从开发盒子 ping）中的 LIVE DB 来进行开发设置。但是，如果不可能的话，对于启动它也可以使用其他数据库权限。

提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-10T16:16:36.837

安装 MySQLdb 模块和 MySQL 客户端库。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-10T16:29:43.837

使用 manage.py dumpdata 从生产系统转储数据，然后填充您的开发数据库。

一旦你有了它，在你的开发箱上安装 MySQLdb，调整 settings.py 以指向你的开发数据库服务器，然后运行应用程序。

值得一提的是，您应该在具有确切版本的 django（和其他依赖项）的虚拟环境中运行所有这些。

# sql - 在 SQL Server Reporting Services 中绘制外推曲线

> ID：10092464
> 
> 赞同：2
> 
> 时间：2012-04-10T16:15:34.480
> 
> 标签：sql, sql-server, reporting-services

我有一个数据集显示我们网站上的用户随着时间的推移而增长，如下所示：

```
Date        New_Users  Cumulative_Total
2012-03-01  10         10
2012-03-02  4          14
2012-03-03  9          23
2012-03-04  21         44 
```

然后将其绘制在 SSRS 报告中的折线图上。我需要推断数据，以便根据当前趋势估计累计总数达到给定数量的日期。我之前在 SSRS 中使用过计算序列，但是我发现没有添加外推曲线的选项。

有谁知道在 SSRS 图表上显示外推曲线的方法，无论是通过 SSRS 本身、SSRS 上的自定义代码还是在 T-SQL 中计算（上帝保佑）？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-10T21:55:29.297

SSRS 图表中没有内置功能。我认为最简单的方法是将趋势计算为数据集、T-SQL 或 Analysis Services 中的系列。另一种可能性是为 SSRS 创建数据处理扩展并在 .NET 中创建趋势，但我认为实现的开销将超过将其作为查询编写。

快速搜索`SQL Trend`显示了一些有希望的结果，例如[http://www.sqlteam.com/forums/topic.asp?TOPIC_ID=77311](http://www.sqlteam.com/forums/topic.asp?TOPIC_ID=77311)

# ios - 你如何在objective-c中生成一个随机日期？

> ID：10092468
> 
> 赞同：11
> 
> 时间：2012-04-10T16:15:45.347
> 
> 标签：ios, objective-c, cocoa, cocoa-touch

我想在两个日期之间生成一个随机日期——例如从今天到 60 天之间的随机日期。我怎么做？

**更新**

使用答案中的信息，我想出了这个我经常使用的方法：

```
// Generate a random date sometime between now and n days before day.
// Also, generate a random time to go with the day while we are at it.
- (NSDate *) generateRandomDateWithinDaysBeforeToday:(NSInteger)days
{
    int r1 = arc4random_uniform(days);
    int r2 = arc4random_uniform(23);
    int r3 = arc4random_uniform(59);

    NSDate *today = [NSDate new];
    NSCalendar *gregorian = 
             [[NSCalendar alloc] initWithCalendarIdentifier:NSGregorianCalendar];

    NSDateComponents *offsetComponents = [NSDateComponents new];
    [offsetComponents setDay:(r1*-1)];
    [offsetComponents setHour:r2];
    [offsetComponents setMinute:r3];

    NSDate *rndDate1 = [gregorian dateByAddingComponents:offsetComponents 
                                                  toDate:today options:0];

    return rndDate1;
} 
```

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2012-04-10T16:22:30.457

获取一个随机数并将其用作时间间隔，然后将其添加到开始日期。例如

```
NSTimeInterval timeBetweenDates = [endDate timeIntervalSinceDate:startDate];
NSTimeInterval randomInterval = ((NSTimeInterval)arc4random() / ARC4RANDOM_MAX) * timeBetweenDates;

NSDate *randomDate = [startDate dateByAddingTimeInterval:randomInterval]; 
```

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2012-04-10T16:21:23.420

1.  生成 1 到 60 之间的随机数

    ```
    int r = arc4random_uniform(60) + 1;

    // Usage : arc4random_uniform(hi - lo + 1) + lo 
    ```

2.  获取当前日期

    ```
    [NSDate date]; 
    ```

3.  用于`NSDateComponents`从`days`组件中减去随机数并生成新日期。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2015-10-12T09:02:23.237

这里框架在生成随机日期方面做得很好。但在 Swift 中： [https ://github.com/thellimist/SwiftRandom/blob/master/SwiftRandom/Randoms.swift](https://github.com/thellimist/SwiftRandom/blob/master/SwiftRandom/Randoms.swift)

```
public extension NSDate {
    /// SwiftRandom extension
    public static func randomWithinDaysBeforeToday(days: Int) -> NSDate {
        let today = NSDate()

        guard let gregorian = NSCalendar(calendarIdentifier: NSCalendarIdentifierGregorian) else {
            print("no calendar \"NSCalendarIdentifierGregorian\" found")
            return today
        }

        let r1 = arc4random_uniform(UInt32(days))
        let r2 = arc4random_uniform(UInt32(23))
        let r3 = arc4random_uniform(UInt32(23))
        let r4 = arc4random_uniform(UInt32(23))

        let offsetComponents = NSDateComponents()
        offsetComponents.day = Int(r1) * -1
        offsetComponents.hour = Int(r2)
        offsetComponents.minute = Int(r3)
        offsetComponents.second = Int(r4)

        guard let rndDate1 = gregorian.dateByAddingComponents(offsetComponents, toDate: today, options: []) else {
            print("randoming failed")
            return today
        }
        return rndDate1
    }

    /// SwiftRandom extension
    public static func random() -> NSDate {
        let randomTime = NSTimeInterval(arc4random_uniform(UInt32.max))
        return NSDate(timeIntervalSince1970: randomTime)
    }

} 
```

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2018-08-26T04:20:31.940

这是一个**Swift 4.x**扩展，允许您指定天数，然后它将用于`Date`在当前日期之前或之后查找随机数。

```
extension Date {
    static func randomDate(range: Int) -> Date {
        // Get the interval for the current date
        let interval =  Date().timeIntervalSince1970
        // There are 86,400 milliseconds in a day (ignoring leap dates)
        // Multiply the 86,400 milliseconds against the valid range of days
        let intervalRange = Double(86_400 * range)
        // Select a random point within the interval range
        let random = Double(arc4random_uniform(UInt32(intervalRange)) + 1)
        // Since this can either be in the past or future, we shift the range
        // so that the halfway point is the present
        let newInterval = interval + (random - (intervalRange / 2.0))
        // Initialize a date value with our newly created interval
        return Date(timeIntervalSince1970: newInterval)
    }
} 
```

你这样称呼它：

```
Date.randomDate(range: 500) // Any date that is +/- 500 days from the current date 
```

运行 10 次会产生：

```
2019-03-15 01:45:52 +0000
2018-12-20 02:09:51 +0000
2018-06-28 10:28:31 +0000
2018-08-02 08:13:01 +0000
2019-01-25 07:04:18 +0000
2018-08-30 22:37:52 +0000
2018-10-05 19:38:22 +0000
2018-11-30 04:51:18 +0000
2019-03-24 07:27:39 +0000 
```

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2012-04-10T16:23:04.887

使用秒。伪代码：

```
1 Generate a random integer between 0 and (60 * 60 * 24 * 60)
2 Get the unixtime in seconds for the current time
3 Add your random integer
4 Convert this integer back to a date 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2017-06-07T11:26:48.843

**斯威夫特 3.x +**

```
public extension Date {
    /// SwiftRandom extension
    public static func randomWithinDaysBeforeToday(days: Int) -> Date {
        let today = Date()
        let gregorian = Calendar(identifier: .gregorian)

        let r1 = arc4random_uniform(UInt32(days))
        let r2 = arc4random_uniform(UInt32(23))
        let r3 = arc4random_uniform(UInt32(23))
        let r4 = arc4random_uniform(UInt32(23))

        let offsetComponents = NSDateComponents()
        offsetComponents.day = Int(r1) * -1
        offsetComponents.hour = Int(r2)
        offsetComponents.minute = Int(r3)
        offsetComponents.second = Int(r4)

        let rndDate1 = gregorian.date(byAdding: offsetComponents as DateComponents, to: today)
        return rndDate1!
    }

    /// SwiftRandom extension
    public static func random() -> Date {
        let randomTime = TimeInterval(arc4random_uniform(UInt32.max))
        return Date(timeIntervalSince1970: randomTime)
    }
} 
```

[PS [Esqarrouth](https://stackoverflow.com/users/2589276/esqarrouth)的[回答](https://stackoverflow.com/a/33077138/1603234)更正了最新的 Swift。]

# sql - 使用没有连接的一个结果流的过滤器查询 1 个表两次？

> ID：10092470
> 
> 赞同：0
> 
> 时间：2012-04-10T16:15:49.057
> 
> 标签：sql, sql-server

我想查询一个表一次，因为查询这个表的时间大约是 8-12 分钟，查询两次实在是太长了。表中有一个标志用于识别内部与外部结果。我想要这个标志是内部的 A 列和 B 的总和，以及这个标志是外部的列 B 和 C 和 D 的总和......现在它的两个单独的查询连接在一起......

这是第一个查询的示例

```
Select
CONVERT(varchar(10), right([week_name],10), 111) as DatePeriod --weekly
,[Group] as [Group]
,SUM([columnA]) as [columnA_int]
,SUM([columnB]) as [columnB_int]    
from  myTbl
where internal_external = 'internal' 
group by 
CONVERT(varchar(10), right([week_name],10), 111),[Group] 
```

第二次查询

```
Select
CONVERT(varchar(10), right([week_name],10), 111) as DatePeriod --weekly
,[Group] as [Group]
,SUM([columnB]) as [columnB_ext]
,SUM([columnC]) as [columnC_ext]
,SUM([columnC]) as [columnC_ext]        
from  myTbl
where internal_external = 'external' 
group by 
CONVERT(varchar(10), right([week_name],10), 111),[Group] 
```

所以理想情况下，一次查询所有 5 列并且只访问数据库一次。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-10T16:26:00.153

试试这样：

```
SELECT
    internal_external
    ,CONVERT(varchar(10), right([week_name],10), 111) as DatePeriod --weekly
    ,[Group] as [Group]
    ,SUM(CASE 
            WHEN internal_external='internal' THEN [columnA]
            ELSE 0 
          END) as [columnA_int]
    ,SUM([columnB]) as [columnB_intext] 
    ,SUM(CASE 
            WHEN internal_external='external' THEN [columnC]
            ELSE 0 
          END) as [columnC_ext]
    ,SUM(CASE 
            WHEN internal_external='external' THEN [columnC]
            ELSE 0 
          END) as [columnC_ext2]
FROM  myTbl
GROUP BY
    internal_external
    ,CONVERT(varchar(10), right([week_name],10), 111)
    ,[Group]
-- use the next lines if there are other values for internal_external
HAVING 
    internal_external IN('internal', 'external') 
```

或者，如果您想放弃 internal_external 列：

```
SELECT
    CONVERT(varchar(10), right([week_name],10), 111) as DatePeriod --weekly
    ,[Group] as [Group]
    ,SUM(CASE 
            WHEN internal_external='internal' THEN [columnA]
            ELSE 0 
          END) as [columnA_int]
    ,SUM(CASE 
            WHEN internal_external='internal' THEN [columnB]
            ELSE 0 
          END) as [columnB_int]
    ,SUM(CASE 
            WHEN internal_external='external' THEN [columnB]
            ELSE 0 
          END) as [columnB_ext]
    ,SUM(CASE 
            WHEN internal_external='external' THEN [columnC]
            ELSE 0 
          END) as [columnC_ext]
FROM  myTbl
GROUP BY
    internal_external
    ,CONVERT(varchar(10), right([week_name],10), 111)
    ,[Group]
-- use the next lines if there are other values for internal_external
HAVING 
    internal_external IN('internal', 'external') 
```

# jquery - .ajax() JSONP 未终止的正则表达式文字

> ID：10092474
> 
> 赞同：1
> 
> 时间：2012-04-10T16:16:13.690
> 
> 标签：jquery, jsonp

我有一个简单的脚本，它有一个 jQuery `.ajax()`，它需要一个 HTML 片段作为返回的数据。由于是跨域调用，我不得不设置`dataType: 'jsonp'`.

预期的返回数据如下所示：

```
<li><a href="https://sugarsync.custhelp.com/app/answers/detail/a_id/293/">Link 1</a></li>
<li><a href="https://sugarsync.custhelp.com/app/answers/detail/a_id/307">Link 2</a></li>
... 
```

不幸的是，当我运行脚本时，出现以下错误（在 Firebug 控制台选项卡中）。我尝试了不同`dataType`的方法`jsonp html`，`jsonp text html`但无济于事。

```
unterminated regular expression literal
... 
```

这是[**jsFiddle 演示**](http://jsfiddle.net/sikusikucom/hSefD/)。请帮忙？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-10T16:55:01.267

您是否设置了服务器来处理 jsonp 请求？如果没有，那么它将不起作用（据我了解）。

作为替代方案，有一个简洁的小 jQuery 插件，可让您发出跨域 GET 请求：[https ://github.com/padolsey/jQuery-Plugins/tree/master/cross-domain-ajax/](https://github.com/padolsey/jQuery-Plugins/tree/master/cross-domain-ajax/)

然后，您可以`$.ajax`像往常一样使用：

```
 $.ajax({
      url: 'http://blog.sugarsync.com/blog/rn-android/',
      type: 'GET',
      success: function(data) {
        $('#list').html(data.responseText);
      }
    }); 
```

希望这可以帮助

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-10T16:32:12.070

您可以尝试将从 ajax Web 服务返回的 html 包装在 json 对象中。例如`{"html":"<li>the rest of your html</li>"}`

然后你必须通过使用解压成功函数中的 json`$('#list').html(data.html)`

我认为您的数据在使用 jsonp 时必须采用有效的 json 格式。

# ruby-on-rails - 意外调用：运行包含 mock_model 的 rspec 规范时的 __mock_proxy()

> ID：10092498
> 
> 赞同：0
> 
> 时间：2012-04-10T16:17:42.343
> 
> 标签：ruby-on-rails, rspec, rspec-rails

我的很多规范都失败了，并给了我关于 __mock_proxy() 的错误消息：

```
$ rspec spec/helpers/liaisons_helper_spec.rb
WARNING: Cucumber-rails required outside of env.rb.  The rest of loading is being defered until env.rb is called.
  To avoid this warning, move 'gem cucumber-rails' under only group :test in your Gemfile
FF

Failures:

  1) LiaisonsHelper hrefs_of_email_addresses_for_liaison to enumerate email_addresses as RESTful links
     Failure/Error: email_address = mock_model(EmailAddress)
     Mocha::ExpectationError:
       unexpected invocation: #<Mock:EmailAddress_1001>.__mock_proxy()
       unsatisfied expectations:
       - expected exactly once, not yet invoked: #<Mock:EmailAddress_1001>.id(any_parameters)
       - expected exactly once, not yet invoked: #<Mock:EmailAddress_1001>.blank?(any_parameters)
       - expected exactly once, not yet invoked: #<Mock:EmailAddress_1001>.valid?(any_parameters)
       - expected exactly once, not yet invoked: #<Mock:EmailAddress_1001>.marked_for_destruction?(any_parameters)
       - expected exactly once, not yet invoked: #<Mock:EmailAddress_1001>.destroyed?(any_parameters)
       - expected exactly once, not yet invoked: #<Mock:EmailAddress_1001>.persisted?(any_parameters)
     # ./spec/helpers/liaisons_helper_spec.rb:6:in `block (3 levels) in <top (required)>'

  2) LiaisonsHelper hrefs_of_phone_numbers_for_liaison to enumerate phone_numbers as RESTful links
     Failure/Error: phone_number = mock_model(PhoneNumber)
     Mocha::ExpectationError:
       unexpected invocation: #<Mock:PhoneNumber_1002>.__mock_proxy()
       unsatisfied expectations:
       - expected exactly once, not yet invoked: #<Mock:PhoneNumber_1002>.id(any_parameters)
       - expected exactly once, not yet invoked: #<Mock:PhoneNumber_1002>.blank?(any_parameters)
       - expected exactly once, not yet invoked: #<Mock:PhoneNumber_1002>.valid?(any_parameters)
       - expected exactly once, not yet invoked: #<Mock:PhoneNumber_1002>.marked_for_destruction?(any_parameters)
       - expected exactly once, not yet invoked: #<Mock:PhoneNumber_1002>.destroyed?(any_parameters)
       - expected exactly once, not yet invoked: #<Mock:PhoneNumber_1002>.persisted?(any_parameters)
     # ./spec/helpers/liaisons_helper_spec.rb:19:in `block (3 levels) in <top (required)>' 
```

我正在运行 Rails 3.1.4 和 Ruby 1.9.2，并且正在使用这些 gem：

```
$ bundle list | grep mocha
  * mocha (0.10.5)
  * rspec-rails-mocha (0.3.1)
$ bundle list | grep rspec
  * rspec (2.8.0)
  * rspec-apotomo (0.9.6)
  * rspec-cells (0.1.2)
  * rspec-core (2.8.0)
  * rspec-expectations (2.8.0)
  * rspec-mocks (2.8.0)
  * rspec-rails (2.8.1)
  * rspec-rails-mocha (0.3.1) 
```

我发现了一些关于人们遇到相同错误的报告，包括[github 上的这个](https://github.com/mislav/rspec-rails-mocha/issues/2)，但它们似乎都已过时或不包含解决方案。

* * *

**编辑：**这些规格适用于我同事的电脑，但不适用于我的电脑。看起来差异与包含的顺序`RSpec::Rails::Mocha`有关`RSpec::Rails::Mocks`-`RSpec::Rails::Mocha`必须最后包含。

我制作了一个测试规范，其输出显示如下：

```
describe 'test' do
  it 'test' do
    m = self.method(:mock_model)
    p m
    p m.source_location
    p self.class.included_modules.map(&:to_s).grep(/Moc/)
  end
end 
```

在我同事的计算机（规范工作的地方）上，它产生了以下输出：

```
#<Method: RSpec::Core::ExampleGroup::Nested_1::Nested_1(RSpec::Rails::Mocha)#mock_model>
["/Users/username/.rvm/gems/ruby-1.9.2-p290-patched@development3/gems/rspec-rails-mocha-0.3.1/lib/rspec/rails/mocha.rb", 59]
["RSpec::Rails::Mocha", "RSpec::Rails::Mocks", "RSpec::Core::MockFrameworkAdapter", "Mocha::API", "Mocha::ParameterMatchers", "Mocha::ObjectMethods"] 
```

在我的电脑上（规范不起作用），它产生了这个输出：

```
#<Method: RSpec::Core::ExampleGroup::Nested_1::Nested_1(RSpec::Rails::Mocks)#mock_model>
["/Users/username/.rvm/gems/ruby-1.9.2-p290-patched@development3/gems/rspec-rails-2.9.0/lib/rspec/rails/mocks.rb", 67]
["RSpec::Rails::Mocks", "RSpec::Rails::Mocha", "RSpec::Core::MockFrameworkAdapter", "Mocha::API", "Mocha::ParameterMatchers", "Mocha::ObjectMethods"] 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-12T13:53:16.537

这可以通过添加`:require => false`到`rspec-rails-mocha`Gemfile 中的行来解决。

# php - PHP 获取元标记，数组中的 URL = 不工作

> ID：10092500
> 
> 赞同：0
> 
> 时间：2012-04-10T16:17:51.593
> 
> 标签：php

我正在尝试获取在文本区域中输入的 url 的元标记，这有什么问题？

另外，我如何将元描述来自的 URL 与描述放在一起？

```
<form method="get">
<textarea name="TAData">
</textarea>
<input type="submit" value="submit"/>
</form>

<div id="checkboxes">
<input type="checkbox" name="vehicle" value="PR" /> Show me the PR<br />
<input type="checkbox" name="vehicle" value="KW Tag" /> Show me the KW tag<br />
<input type="checkbox" name="vehicle" value="Title Tag" /> Show me the Title tag<br />
</div>
<div id="checkboxes">
<input type="checkbox" name="vehicle" value="1stH1" /> Show me the 1st H1<br />
<input type="checkbox" name="vehicle" value="2ndH1" /> Show me the 2nd H1 tag<br />
<input type="checkbox" name="vehicle" value="SeedKW" /> Show me Seed KW's<br />
</div>

<div id="nofloat"></div>

<?php

//make the array 
$TAarray = explode("\n", strip_tags($_POST['TAData'])); 

var_dump($TAarray);

//loop through the array 
foreach ($TAarray as $line) { 

   $line = htmlspecialchars(trim($line)); 
}      

    foreach ($TAarray as $url) {

            // get the meta data for each url
            $tags = get_meta_tags($url);

unset($tags["content-type"]);
unset($tags["page-type"]);
unset($tags["page-topic"]);
unset($tags["audience"]);

                echo '<tr>';
                foreach ($tags['description'] as $meta)         
            {
                        echo '<td>' . $meta . '</td>';
                }
                echo '</tr>';
        }
?> 
```

另外，有没有办法只包含元描述？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-10T16:24:13.527

1）您的表单被声明为 GET，但您正在从 $_POST 字段中读取值。

2）如果你只想提取“描述”元值，你不需要对标签进行迭代，你可以使用：

```
$description = $tags["description"] 
```

# javascript - JavaScript 模块模式：默认值

> ID：10092502
> 
> 赞同：3
> 
> 时间：2012-04-10T16:17:55.603
> 
> 标签：javascript, module, design-patterns

我正在做一个项目，我们使用一种模式来定义“模块”（即有效的公共静态类），其中每个模块都有一个`init()`应该在定义模块后调用的。看起来像：

```
MyNamespace.MyModule = (function () {
    var my = {};
    my.init = function(config) {
        // setup initial state using config
    };
    return my;
})(); 
```

我在这个代码库中看到了两种用于定义`config`默认值的模式，并想知道哪一种可能更好——如果有任何我没有立即看到的优点或缺点。建议？

这是第一个：

```
MyNamespace.MyModule = (function () {
    var my = {}, 
        username,
        policyId,
        displayRows;

    my.init = function(config) {
        config = config || {};
        username = config.username || 'Anonymous';
        policyId = config.policyId || null;
        displayRows = config.displayRows || 50;
    };

    return my;
})(); 
```

这是第二个：

```
MyNamespace.MyModule = (function () {
    var my = {}, 
        username = 'Anonymous',
        policyId = null,
        displayRows = 50;

    my.init = function(config) {
        config = config || {};
        username = config.username || username;
        policyId = config.policyId || policyId;
        displayRows = config.displayRows || displayRows;
    };

    return my;
})(); 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-10T16:24:14.807

没有太大区别，这实际上与您可读的内容有关。我个人喜欢第二种方法，因为它将默认值与逻辑分开。

# java - Android中的接近功能

> ID：10092505
> 
> 赞同：0
> 
> 时间：2012-04-10T16:18:14.883
> 
> 标签：java, android, proximity

我想知道 Color（失败的公司）如何利用他们启用的邻近功能。据我所知，它与地理定位本身不同，并且就我而言使用不同的方法。我对 Android 和 Java 编码很陌生，希望有人能指出我的方向。提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-10T17:31:42.433

> 因此，例如，为了增强来自 GPS 的位置信号，Color 将使用照明和环境噪声等线索来了解两张照片是在同一个地方拍摄的。它还将尝试了解用户对哪些人感兴趣，以及随着时间的推移如何变化——因此，如果用户暂时没有与某人的图片进行交互，则该人的图标将在用户的相关列表中显示得更远更暗人（Color 称之为“弹性网络”）。

[http://webcache.googleusercontent.com/search?q=cache:rVOQkyvBEBMJ:allthingsd.com/20110323/with-41m-in-hand-color-deploys-new-proximity-based-social-network/+&cd=1&hl =en&ct=clnk&gl=us](http://webcache.googleusercontent.com/search?q=cache:rVOQkyvBEBMJ:allthingsd.com/20110323/with-41m-in-hand-color-deploys-new-proximity-based-social-network/+&cd=1&hl=en&ct=clnk&gl=us)

在我看来，这是基于位置的照片共享，他们使用图像的上下文来提高照片组的准确性和相关性。

# c# - 列表框水平滚动条未正确更新

> ID：10092507
> 
> 赞同：3
> 
> 时间：2012-04-10T16:18:19.443
> 
> 标签：c#, winforms, listbox, scrollbar

我有一个表单，其中包含一个列表框控件以及许多其他确定列表框内容的控件。将项目添加到列表框可以正确设置滚动条的范围，但是更新列表框上的项目（通过 this.lstResources.Items[index] = myUri）会导致滚动条的范围缩小到超过最大项目的宽度，从而切断最后几个字符。滚动条仍然有效，但以这种方式更新列表框会导致列表中项目出现意外且不可接受的滚动范围。这是我实现列表框的方式：

```
public System.Windows.Forms.ListBox lstResources;
this.lstResources = new System.Windows.Forms.ListBox();

this.lstResources.FormattingEnabled = true;
this.lstResources.HorizontalScrollbar = true;
this.lstResources.Location = new System.Drawing.Point(331, 122);
this.lstResources.Name = "lstResources";
this.lstResources.Size = new System.Drawing.Size(307, 316);
this.lstResources.TabIndex = 8;
this.lstResources.Click += new System.EventHandler(this.ResourcesPage.LstResources_Click); 
```

我在此列表框上执行的更改操作如下：

```
this.parentClassReference.lstResources.Items.Add(myUri);
this.parentClassReference.lstResources.Items[index] = myUri;
this.parentClassReference.lstResources.Items.RemoveAt(index); 
```

我在表单和列表框控件上都尝试了 Refresh() 和 Update()，但都没有任何效果。我到处寻找列表框滚动条问题，但似乎没有一个有这个特殊的重绘问题。

这应该是这样的：
![在此处输入图像描述](../Images/0eba25319b97a0e2df8376b8ceb8ecfc.png)

这就是实际发生的事情：
![在此处输入图像描述](../Images/ab443bde68daebc943d8069cb80ee3c0.png)

我有一种感觉，我遗漏了一些明显的东西，或者可能不正确地更改了项目，但我对这个没有想法。我对 C# 和 UI 设计并不完全陌生，但我也不能说我知道所有的细节控制操作。任何帮助将不胜感激。

编辑 1：这是一个应该重现问题的示例表单。我开始怀疑 StringBuilder 可能与更新部分有关，但它也用于 btnAdd_Click 代码......

```
public partial class SampleListBoxForm : Form
{
    public Dictionary<string, string> CurrentUriQuery { get; set; }

    public SampleListBoxForm()
    {
        this.CurrentUriQuery = new Dictionary<string, string>();
        this.InitializeComponent();
    }

    private void btnAdd_Click(object sender, EventArgs e)
    {
        this.UpdateParams("sampleApp");
        this.listBox1.Items.Add(this.GenerateURI());
        this.listBox1.Refresh();
    }

    private void btnUpdate_Click(object sender, EventArgs e)
    {
        int index = 0;
        this.UpdateParams("sampleApp2");
        for (; index < this.listBox1.Items.Count; index++)
        {
            this.listBox1.Items[index] = this.GenerateURI();
        }
    }

    private void UpdateParams(string filename)
    {
        this.CurrentUriQuery = new Dictionary<string, string>();
        this.CurrentUriQuery["filename"] = filename;
        this.CurrentUriQuery["url"] = @"C:\Users\me\Desktop\" + filename;
        this.CurrentUriQuery["type"] = "dynamicType";
        this.CurrentUriQuery["p1"] = "foo";
        this.CurrentUriQuery["p2"] = "bar";
        this.CurrentUriQuery["p3"] = "stuff";
        this.CurrentUriQuery["p4"] = "test";
    }

    private string GenerateURI()
    {
        StringBuilder currentUri = new StringBuilder();
        bool firstParam = true;
        currentUri.Append(this.CurrentUriQuery["filename"]);
        foreach (KeyValuePair<string, string> pair in this.CurrentUriQuery)
        {
            if (pair.Key != "url" && pair.Key != "filename" && pair.Value != string.Empty && pair.Value != "0")
            {
                if (firstParam)
                {
                    currentUri.Append("?");
                    firstParam = false;
                }
                else
                {
                    currentUri.Append("&");
                }

                currentUri.Append(pair.Key);
                currentUri.Append("=");
                currentUri.Append(pair.Value.Replace(" ", ""));
            }
        }

        return currentUri.ToString();
    }

    public string[] ExtractPathAndQueryFromUriString(string uriString)
    {
        string[] pathAndQuery = new string[2];
        if (uriString.Contains('?'))
        {
            pathAndQuery[0] = uriString.Split('?')[0];
            pathAndQuery[1] = uriString.Split('?')[1];
        }
        else if (uriString.Contains("%3F"))
        {
            string[] stringSeparator = new string[] { "%3F" };
            pathAndQuery[0] = uriString.Split(stringSeparator, StringSplitOptions.None)[0];
            pathAndQuery[1] = uriString.Split(stringSeparator, StringSplitOptions.None)[1];
        }
        else
        {
            pathAndQuery[0] = uriString;
            pathAndQuery[1] = string.Empty;
        }

        return pathAndQuery;
    }
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-10T19:45:30.780

问题似乎出在与号字符上。当您添加该项目时，它似乎可以正确测量。当您更新项目时，它不会。

这个丑陋的黑客似乎是：记录索引，删除项目，将项目重新插入到记录的索引中。

或者切换到`DrawMode = OwnerDrawFixed`并计算`HorizontalExtent`您添加或更改的每个项目的值。

```
private void ResizeListBox() {
  int maxWidth = 0;

  for (int i = 0; i < listBox1.Items.Count; i++) {
    int testWidth = TextRenderer.MeasureText(listBox1.Items[i].ToString(), 
                                             listBox1.Font, listBox1.ClientSize,
                                             TextFormatFlags.NoPrefix).Width;
    if (testWidth > maxWidth)
      maxWidth = testWidth;
  }

  listBox1.HorizontalExtent = maxWidth;
} 
```

不幸的是，每次更改都必须调用它：

```
private void btnAdd_Click(object sender, EventArgs e) {
  this.UpdateParams("sampleApp");
  this.listBox1.Items.Add(this.GenerateURI());
  ResizeListBox();
}

private void btnUpdate_Click(object sender, EventArgs e) {
  this.UpdateParams("sampleApp");
  for (int index = 0; index < this.listBox1.Items.Count; index++) {
    this.listBox1.Items[index] = this.GenerateURI();
  }
  ResizeListBox();
} 
```

这是一个快速而肮脏的 DrawItem 版本：

```
private void listBox1_DrawItem(object sender, DrawItemEventArgs e) {
  e.DrawBackground();
  if (e.Index > -1) {
    Color textColor = SystemColors.WindowText;
    if ((e.State & DrawItemState.Selected) == DrawItemState.Selected) {
      textColor = SystemColors.HighlightText;
    }
    TextRenderer.DrawText(e.Graphics, listBox1.Items[e.Index].ToString(), 
                          listBox1.Font, e.Bounds, 
                          textColor, Color.Empty, TextFormatFlags.NoPrefix);
  }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2021-05-26T07:21:18.670

```
public static void ResizeListBox()
{
    YourListView.HorizontalExtent = TextRenderer.MeasureText(YourListView.Items.ToString(),
                                                    YourListView.Font, YourListView.ClientSize,
                                                    TextFormatFlags.NoPrefix).Width;           
} 
```

在表单加载时调用此函数...这可能会解决您的问题。在这里，只检查第一个列表框元素的宽度，或者您可以使用循环找到最大宽度。

# xml - 通过后退按钮返回页面时，为什么 Internet Explorer 不显示正确的 XML 转换？

> ID：10092509
> 
> 赞同：3
> 
> 时间：2012-04-10T16:18:23.123
> 
> 标签：xml, delphi, internet-explorer

我在 Delphi 应用程序中生成一些 XML 数据，以响应 HTTP GET 请求，使用 a`TIdHTTPServer`来检测它并发送响应。XML 链接到 XSLT 样式表以呈现 HTML 页面。这工作正常，页面显示正常。

然后我单击页面中的链接以导航到另一个级别的数据，再次一切正常。问题是，如果我再点击*back*，前一页会重新显示，但有些数据（不是全部）不同，但我的服务器没有收到另一个 HTTP GET 请求来生成 XML。如果我在 IE 中单击*刷新*，那么我的服务器会获得一个 HTTP GET 并正确地重新生成页面。

如果我使用其他浏览器，它一直都可以正常工作。我已经尝试添加 META 标记来停止 XSLT 中的页面缓存，但这没有任何区别。IE 不会重新请求页面。

我宁愿不发布特定的 XML 数据作为其敏感的客户数据。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-10T16:37:58.930

我会尝试为您的 XML 源文件设置正确的缓存控制 HTTP 标头。请参阅维基百科中的标题描述：[http ://en.wikipedia.org/wiki/List_of_HTTP_header_fields#Avoiding_caching](http://en.wikipedia.org/wiki/List_of_HTTP_header_fields#Avoiding_caching)

# logging - 如何将 npgsql 日志输出重定向到 log4net 记录器？

> ID：10092512
> 
> 赞同：0
> 
> 时间：2012-04-10T16:18:24.573
> 
> 标签：logging, log4net, npgsql

是否可以将 npgsql 日志输出重定向到 log4net 记录器？从 npgsql 源代码来看，它看起来像是直接记录到 stdout/stderr 或指定文件（使用 上的静态属性`NpgsqlEventLog`）。有没有办法将该登录路由到 log4net？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2017-03-30T01:49:52.770

这就是我所做的，它似乎工作得相当好。请注意，我将注销命令拆分到单独的附加程序，因为它变得非常冗长......

首先，在对 Npgsql 进行任何其他调用之前添加它：

```
NpgsqlLogManager.Provider = new Log4NetNpgsqlLoggingProvider("NpgsqlDefaultLogger")
{
    CommandLoggerName = "NpgsqlCommandLogger"
}; 
```

现在您需要添加日志记录提供程序类：

```
using System;
using Npgsql.Logging;

namespace Util.Npgsql
{
    public class Log4NetNpgsqlLoggingProvider : INpgsqlLoggingProvider
    {
        public string DefaultLoggerName { get; }
        public string CommandLoggerName { get; set; }

        public Log4NetNpgsqlLoggingProvider(string defaultLoggerName)
        {
            if (defaultLoggerName == null) throw new ArgumentNullException(nameof(defaultLoggerName));
            DefaultLoggerName = defaultLoggerName;
        }

        public NpgsqlLogger CreateLogger(string name)
        {
            switch (name)
            {
                case "Npgsql.NpgsqlCommand":
                    return new Log4NetNpgsqlLogger(CommandLoggerName ?? DefaultLoggerName);
                default:
                    return new Log4NetNpgsqlLogger(DefaultLoggerName);
            }
        }
    }
} 
```

而且您还需要实际的记录器类：

```
using System;
using log4net;
using log4net.Core;
using Npgsql.Logging;

namespace Util.Npgsql
{
    public class Log4NetNpgsqlLogger : NpgsqlLogger
    {
        private readonly ILog _log;

        public Log4NetNpgsqlLogger(string name)
        {
            _log = LogManager.GetLogger(name);
        }

        public override bool IsEnabled(NpgsqlLogLevel level)
        {
            return _log.Logger.IsEnabledFor(GetLog4NetLevelFromNpgsqlLogLevel(level));
        }

        public override void Log(NpgsqlLogLevel level, int connectorId, string msg, Exception exception = null)
        {
            _log.Logger.Log(typeof(NpgsqlLogger), GetLog4NetLevelFromNpgsqlLogLevel(level), connectorId + ": " + msg, exception);
        }

        protected Level GetLog4NetLevelFromNpgsqlLogLevel(NpgsqlLogLevel level)
        {
            switch (level)
            {
                case NpgsqlLogLevel.Trace:
                case NpgsqlLogLevel.Debug:
                    return Level.Debug;
                case NpgsqlLogLevel.Info:
                    return Level.Info;
                case NpgsqlLogLevel.Warn:
                    return Level.Warn;
                case NpgsqlLogLevel.Error:
                    return Level.Error;
                case NpgsqlLogLevel.Fatal:
                    return Level.Fatal;
                default:
                    throw new Exception("Unknown Npgsql Log Level: " + level);
            }
        }
    }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2015-03-12T19:13:41.883

首先将 log4net 添加到您的解决方案中，简单的方法是使用 nuget: 所以你这样做： install-Package log4net 然后你必须安装 npgsql： install-Package npgsql

在您的 web.config 文件中添加以下元素：（您必须使用 app.config 而非 Web 解决方案）

在 configSection printf("%d\n", 42); /*

```
//the most important thing is to ensure that the type on your parameter         //section is correct. otherwise, no error will be returned, and no data will be         inserted.

//now, at your code you can use this function:

        protected void LogInfo(string message, params object[] args)
        {
            log4net.ILog log =     log4net.LogManager.GetLogger("postgreSqlLogAppender");
            log4net.ThreadContext.Properties["UserId"] = args.[0];
            log4net.ThreadContext.Properties["EntityId"] = args.[1];
            log.Info(string.Format("{0}: {1}",     this.GetType().Name.Replace("Controller", ""), string.Format(message, args)));
            log4net.ThreadContext.Properties.Remove("UserId");
            log4net.ThreadContext.Properties.Remove("EntityId");
        }

//to call your function
    void test()
{
   LogInfo("My message",15,326)
}

//in my case 15 is my current user_id and 326 is the my class_object.
     */ 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-11T18:20:43.597

我对npgsql一无所知，但如果你有源并且允许更改它，那么更改它以支持log4net**应该更容易。**

如果您没有源，那么这将是不容易的，甚至可能是不可能的。由于 log4net 不会拦截来自其他来源的输出，因此我能看到的唯一方法是拥有一个后台线程来监视 npgsql 正在输出到的文件，并且当文件更改时，您需要读取该文件并解析信息，然后使用该信息调用 log4net。

您仍然有 log4net 会认为每个调用都来自您的例程而不是 npgsql 和堆栈跟踪的问题。也只有在每次创建日志条目时 npgsql 都在锁定、打开、写入和关闭文件时才有效。

# mysql - mysql：检查数据的顺序

> ID：10092516
> 
> 赞同：2
> 
> 时间：2012-04-10T16:18:38.040
> 
> 标签：mysql

我遇到了许多表中有“坏”数据的情况。数据已从各种来源交叉污染，我需要清理它。

具体来说，有数百个具有相同定义的表。它们保存带有自动增量列、时间/日期戳和其他数据的定时传感器数据。“坏”数据可以通过时间/日期向后跳跃而不是按预期增长来识别。

例子：

```
10 2010/01/05 
11 2010/01/06
12 2010/01/07
13 2008/05/09
14 2008/05/10
15 2008/05/11
16 2010/01/08
17 2010/01/09 
```

我正在寻找找到这些区域的最佳方法。

需要注意的一些事项：
- 有问题的表有数以亿计的记录
- 在我的示例中，日期是连续的 - 实际上，给定日期可能有 10 或 1000 个条目（每个条目都有时间戳），然后一周内什么都没有.

我可以想象一个 perl 脚本遍历每个并寻找这些跳转。我想知道是否有更快、更 sql-esque 的方法。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-10T16:37:01.510

```
select t.* from t, (select @maxDate := '') init
where not if(date > @maxDate, @maxDate := date, 0)
order by id 
```

这是我能想到的最快的方法。

注意：我假设您希望`13, 14, 15`在示例中获得带有 ID 的记录。

# c# - 使用图片框或类似控件制作 2d 平铺编辑器

> ID：10092521
> 
> 赞同：2
> 
> 时间：2012-04-10T16:19:07.930
> 
> 标签：c#, bitmap, picturebox

我正在制作一个带有方形图块的 2d 游戏，是时候制作一个好的地图编辑器了。

早些时候我尝试使用 DataGridView，但结果是超级慢。

我想应该有另一种方法来绘制瓷砖（实际图像或彩色背景）及其参数（在文本中）。图片框！

有没有一种简单的方法可以访问二维像素数组、在所需坐标处插入平铺图像、获取指针坐标和所有这些东西，还是我应该尝试使用完全不同的方法？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-10T16:45:29.080

使用任何控件网格都将非常慢。绘制瓷砖网格的“正确”方法是……绘制瓷砖网格。

您可以创建自己的控件，将一组图像或索引/键放入图像容器并绘制它们。

从 Control 派生您的自定义控件，而不是 UserControl（UserControl 是一个控件容器，您不需要它，或者如果您想要滚动条，也可以从 ScrollableControl 派生）。重写 OnPaint 方法以执行绘图。使用传递给 OnPaint 的 Graphics 对象，它具有绘制文本、图元和位图的方法。

您可以通过覆盖 MouseDown/Up 来处理用户输入，或者让消费者处理它，但提供一个 HitTest 方法，以便可以将给定的 X、Y 转换为网格索引。

我在这里有一些代码[C# Drawing circles in a panel](https://stackoverflow.com/questions/5730828/c-sharp-drawing-circles-in-a-panel/5732819#5732819)用于绘制椭圆以响应用户输入。从该代码中，您可以看到在控件上绘制某些状态的示例（在这种情况下，控件是表单，但您可以外推到自定义控件）。请注意构造函数中的 SetStyle 调用以消除闪烁。另请注意，当您更改状态时，您不会尝试重绘，您只需 Invalidate 告诉操作系统您需要重绘。

**更新**

这是一个非常粗略的示例，可以帮助您入门： http: [//pastebin.com/DseuN56y](http://pastebin.com/DseuN56y)

# java - 查找严格和丢失正则表达式模式

> ID：10092522
> 
> 赞同：0
> 
> 时间：2012-04-10T16:19:08.087
> 
> 标签：java, regex, string, string-parsing

我有

```
^\s*(\w+(\,\w+)*\s*(:|,|\()(\(|\[)?\s*) 
```

从这样的两组字符串中提取“命令”效果很好

```
**Strict pattern**
command:some text
command: some text
command,command2: some text

**Loose pattern**
command :some text
command( some text )
command, some txt 
```

这是我的问题更清晰的链接。 [http://rubular.com/r/epTIiU32Dj](http://rubular.com/r/epTIiU32Dj)

**您能否为严格模式和丢失模式编写两个单独的正则表达式？**

因此，使用一个 RegExp，我只会得到严格模式命令，而使用其他 RegExp，我只会得到失去模式命令。

每当我尝试某事时，我最终都会超越彼此的模式。我无法为每种模式获得有效的正则表达式。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-10T16:57:59.203

首先，您可以通过使用字符类而不是组和交替（[http://www.rubular.com/r/pI7dk7qzxS](http://www.rubular.com/r/pI7dk7qzxS)）来缩短您的正则表达式：

```
^\s*(\w+(,\w+)*\s*[:,(\[]\s*) 
```

这是严格的模式（[http://www.rubular.com/r/xRIQuAR6TM](http://www.rubular.com/r/xRIQuAR6TM)）：

```
^\s*(\w+(,\w+)*:\s*) 
```

这是松散的模式（[http://www.rubular.com/r/9ztWBYsj1a](http://www.rubular.com/r/9ztWBYsj1a)）：

```
^\s*(\w+(,\w+)*(\s+:|\s*[,(\[]\s+)\s*) 
```

请注意，这些适用于您提供的示例数据（如您在 Rubular 链接中所见），但如果您遇到问题，仅从示例数据和您的正则表达式中很难判断这是否涵盖所有潜在情况将需要更彻底地解释语法。

# mysql - 自定义 mysql MembershipProvider

> ID：10092528
> 
> 赞同：0
> 
> 时间：2012-04-10T16:19:27.400
> 
> 标签：mysql, asp.net-membership

我已经建立了一个自定义会员提供程序，一切似乎都很顺利。它自动构建了我的表格，我认为我的方式很好。然而，在我剔除 MembershipProvider 之后，我预计会有更多的在线文档。我有表格和存根，但没有逻辑。我本来希望 autoschema 设置也为我创建了存储过程，看看大多数逻辑的位置。

我错过了什么？

MembershipProvider 自动建立的表是：
my_asp_applications
my_asp_membership
my_asp_profiles
my_asp_roles
my_asp_schemaversion
my_asp_sessioncleanup
my_asp_sessions
my_asp_users
my_asp_usersinroles

# comparison - 如何忽略换行符？

> ID：10092538
> 
> 赞同：8
> 
> 时间：2012-04-10T16:20:11.673
> 
> 标签：comparison, beyondcompare, beyondcompare3

我忽略了不重要的差异，但我希望下面的内容不会显示为差异..

```
3\.  TITLE

blah blah blah blah blah blah blah blah blah blah

3\.  TITLE
blah blah blah
blah blah blah
blah blah blah blah 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-04-10T16:44:05.593

那可能是不可能的。我只是用语法规则搞砸了大约 30 分钟，即使您忽略换行符，它也不会将单独行上的未忽略文本视为连续换行符。

实际上，您要求比较器做的是从文档中删除所有换行符并比较两个文档，就好像每个文档都只是一行（长）文本一样。您可以手动执行此操作以检测更改，但您无法以这种方式合并更改。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-09-02T14:37:29.823

我也希望超越比较会内置这样的东西。看起来它没有。

我发现这样做的最佳解决方案是在双方都使用某种代码格式化程序。这使您可以比较代码中的实际更改。对于 javascript，我使用 JSBeautify。

对于 Java，您可能可以使用编辑器的内置美化器或类似的东西：http: [//prettyprinter.de/](http://prettyprinter.de/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-07-29T00:18:31.267

我发现 Compare++ 可以比较代码，忽略换行符、空格和注释差异。 [http://cmpp.coodesoft.com/main/downloads](http://cmpp.coodesoft.com/main/downloads)

# svn - 在不更改文件的情况下向颠覆添加评论？

> ID：10092542
> 
> 赞同：7
> 
> 时间：2012-04-10T16:20:33.670
> 
> 标签：svn, version-control, tortoisesvn

我想在给定文件的颠覆日志或历史记录中添加注释，但没有与该文件关联的更改。

有没有办法在不实际更改文件的情况下向 svn 日志添加或注入评论。

我正在寻找一种在某些事件发生后仅在日志中标记文件的方法，例如代码审查。

我不想做一个 svn 副本来创建一个全新的分支。我只想要在某个时间点与单个文件关联的评论。

这里有什么建议吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-10T18:41:48.000

在 Subversion 中，有两种类型的属性：

*   **文件属性**：这些是与文件关联的属性。它们被修订，就好像它们是文件本身的一部分。
*   **修订属性**：这些是与各个修订相关的属性。每个修订版只能有一种类型的属性。它们没有版本化，因此更改修订属性将丢失有关旧信息的历史信息。作为安全预防措施，如果不先创建允许您执行此操作的 pre-revprop-change 挂钩，您将无法更改修订属性。

最重要的是，与每个修订相关的三个特殊修订属性非常重要：

*   **`svn:log`**: 这是提交信息
*   **`svn:date`**：这是提交完成的日期和时间。
*   **`svn:author`**：这是执行提交的用户。

所以，问题是你想做什么。如果要向文件添加注释，可以向该文件添加文件属性。但是，这被认为是文件更改，因此您必须进行签出，`svn pset`然后提交在该文件上创建新修订版。

如果您想为存储库中的特定修订添加新评论，则无需创建新修订即可。但是，您必须创建一个`pre-revprop-commit`允许您进行这些修改的挂钩文件。你有两种方法可以做到这一点：

*   **修改`svn:log`您的评论**这可能是最简单的方法。但是，不会记录提交消息中的更改，因此您会在此过程中丢失原始提交消息。好处是这个注释会随`svn:log`命令自动显示。

例如：

```
$ old_comment=$(svn pget -r 100 -revprop svn:log http://myhost/svn/repos)
$ new_comment="$old_comment
> ================ COMMENT ON REVISION ================
> This was a change needed for a particular customer"
$ svn pset -r 100 --revprop svn:log "$new_comment" 
```

*   您还可以创建一个包含您的评论的新修订属性。例如`corp:comment`（我`corp`用来表示与我公司相关的特殊属性）。您可以在消息中显示这些注释`svn log`，但只能以 xml 格式显示。

例如：

```
$ svn pset --revprop -r 100 foo:comment "This was a change needed for a particular customer" http://host/svn/repos 
```

现在，当您记录日志时，您可以看到该评论：

```
$ svn log --with-revprop foo:comment --xml -r 100 http://host/svn/repos
<?xml version="1.0"?>
<log>
<logentry
   revision="100">
<revprops>
<property
   name="foo:comment">This was a change needed for a particular customer</property>
</revprops>
</logentry>
</log> 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-04-10T17:46:03.200

您可以在应该提交的文件上设置/更改用户定义的属性 - 即仅更改一些元数据而不会产生副作用。

```
svn propset my:log reason filename
svn commit filename 
```

# java - MediaStore.Images.Thumbnails 似乎为空

> ID：10092549
> 
> 赞同：3
> 
> 时间：2012-04-10T16:21:01.063
> 
> 标签：java, android, mediastore

我有一个我写的应用程序将图像上传到我的服务器，它在运行 android 2.3.4 的 droidx 和运行 android 4.0.3 的两个不同模拟器上运行良好。但是，当我尝试在 Asus ee Pad Transformer（运行 4.0.3）上运行它时，它总是告诉我 MediaStore.Images.Thumbnails 中有 0 个项目。

```
String[] projection = {MediaStore.Images.Thumbnails._ID};
cursor = managedQuery( MediaStore.Images.Thumbnails.EXTERNAL_CONTENT_URI,
    projection,
    null,
    null,
    MediaStore.Images.Thumbnails.IMAGE_ID);
Log.d("Info","There are " + cursor.getCount() + " items"); 
```

应该有 6 个出现，5 个来自相机，1 个是我从互联网上下载的。早期只获取图像而不是缩略图的代码告诉我有 5 张来自相机的图像，所以我知道该代码正在工作。

```
String[] projection = {MediaStore.Images.Media._ID};
    cursor = managedQuery(MediaStore.Images.Media.EXTERNAL_CONTENT_URI,
    projection,
    "Camera",
    null,null);
Log.d("Info","There are " + cursor.getCount() + " images"); 
```

当我打开图库应用程序时，这些图像都会显示出来。我还尝试清除媒体存储应用程序并重新启动设备以查看是否有帮助，但没有。在这一点上，我很困惑，特别是因为这个完全相同的代码可以在手机和模拟器上运行。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-12T15:39:49.140

好的，找到了。
当您拥有图像 ID 时，您会使用以下方法获得它的缩略图：

```
MediaStore.Images.Thumbnails.getThumbnail(getContentResolver(), imageID, MediaStore.Images.Thumbnails.MINI_KIND, null); 
```

这将返回位图**而不**加载完整图像。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-18T19:25:54.583

我创建了一个实用程序类，如果您将要获取的图像/视频的 uri 传递给它，它将创建并返回图像和视频的缩略图。

```
package Utilities;

import android.graphics.Bitmap;
import android.graphics.BitmapFactory;
import android.media.ThumbnailUtils;
import android.provider.MediaStore;

public class AndroidUtils 
{
    public static final int THUMBNAIL_SIZE = 128;
    public static Bitmap GetImagePreview(String uri)
    {
        return ThumbnailUtils.extractThumbnail(BitmapFactory.decodeFile(uri), THUMBNAIL_SIZE, THUMBNAIL_SIZE);
    }

    public static Bitmap GetVideoPreview(String uri)
    {
        return ThumbnailUtils.createVideoThumbnail(uri, MediaStore.Images.Thumbnails.MICRO_KIND);
    }
} 
```

# javascript - Javascript 和复选框与移动设备的兼容性

> ID：10092553
> 
> 赞同：0
> 
> 时间：2012-04-10T16:21:11.593
> 
> 标签：javascript, jquery, android, iphone, mobile

如果我的代码是移动设备的标准，任何人都可以检查和建议吗？我似乎无法让它在 iPhone 和我的 android 上运行。这适用于我的桌面，但不适用于移动设备。我正在尝试创建一个切换复选框，当用户选中复选框时它将显示按钮，如果取消选中它将显示禁用版本（'#disableBtn'）

**Javascript + Jquery**

```
$(function()
{   
    $('#agreed').change(function()
    {
        if ($(this).attr("checked"))
        {
            $('#disableBtn').hide();
            $('#button').css('display', 'block');
            return;
        }
        $('#disableBtn').show();
        $('#button').css('display', 'none')
    });
}) 
```

**HTML**

```
<input id="agreed" type="checkbox" name="check" value="1">

<a id="button" href="#>">Button</a>
<span id="disableBtn">Disabled</span> 
```

**CSS**

```
#button { display: none } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-10T17:11:17.897

`if ($(this).attr("checked"))`完全错误，我不敢相信它可以在您的桌面浏览器上运行。您的代码检查输入是否有属性`checked`- 不，永远不会有。请参阅[http://api.jquery.com/prop/](http://api.jquery.com/prop/) - 它甚至在解释中使用“已检查”。相反，它应该是

```
if (this.checked) {
... 
```

除此之外，按钮和输入（如果您使用真正的按钮，而不是锚点 - 另请参阅[更改禁用链接的外观](https://stackoverflow.com/q/1160376/1048572)）具有原生属性`disabled`。用它。

# java - 程序运行时删除类文件？

> ID：10092559
> 
> 赞同：0
> 
> 时间：2012-04-10T16:21:40.973
> 
> 标签：java, classpath, delete-file

一个java程序正在运行，它有无限循环。现在，当程序运行时，我删除了该程序的类文件，那会发生什么？程序会按原样继续还是会停止..？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-10T16:26:04.977

别担心，什么都不会发生。它在运行时存储在 JVM 中。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-10T16:25:36.817

加载 Java 类后，它不会再次加载，并且可以删除而不会产生影响。

如果您在加载类之前删除它，您只会遇到问题。

# html - 后退按钮打破Chrome中的页面css

> ID：10092563
> 
> 赞同：5
> 
> 时间：2012-04-10T16:21:46.210
> 
> 标签：html, google-chrome

Google Chrome 中的后退按钮是否遇到过问题？从某种意义上说，当您从下拉菜单（ajax 加载）中选择一个项目时，单击页面上的某些内容，然后单击后退按钮，浏览器会忘记它曾经有过 CSS，并且一直到 1995 年。

看起来它只是加载 AJAX DOM，而不是整个页面。页面刷新后一切正常。应该是类似这样的 [问题](https://stackoverflow.com/questions/9788562/back-button-breaks-page-in-chrome)。

# wpf - 强制 MessageBox 位于 .net/WPF 中的应用程序窗口顶部

> ID：10092564
> 
> 赞同：21
> 
> 时间：2012-04-10T16:21:49.470
> 
> 标签：wpf, .net-4.0, modal-dialog, messagebox

在我的 WPF 应用程序中，我有时会启动`System.Windows.MessageBox`. 当它最初显示时，它会显示在我的主应用程序窗口的顶部，就像我想要的那样。有没有办法可以强制它始终保持在主窗口的顶部？我遇到的问题是，当`MessageBox`显示 a 时，用户可以单击主应用程序窗口并将其带到前面，这意味着它`MessageBox`会从视图中隐藏。在这种情况下，用户可能没有意识到它的存在，或者忘记了它，对他们来说，主应用程序似乎已经冻结了。

我已经阅读了许多关于此的主题，但没有一个为我解决了这个问题。

我应该补充一点，提出的线程`MessageBox`可能不是 UI 线程。谢谢汤姆

* * *

## 回答 #1

> 赞同：55
> 
> 时间：2012-04-10T16:27:59.563

使用`MessageBox.Show`带有窗口“所有者”的版本并传递您的窗口。

```
MessageBox.Show(Application.Current.MainWindow, "Im always on top - of the main window"); 
```

如果您可能不在 UI 线程上，请尝试：

```
string msg="Hello!";
if (Application.Current.Dispatcher.CheckAccess()) {
    MessageBox.Show(Application.Current.MainWindow, msg);
}
else {
    Application.Current.Dispatcher.Invoke(DispatcherPriority.Normal, new Action(()=>{
        MessageBox.Show(Application.Current.MainWindow, msg);
    }));
} 
```

您可以：
1.`Invoke`阻止您的线程直到`MessageBox`被解散或
2.`BeginInvoke`在这种情况下，您的线程代码将继续执行，但 UI 线程将一直阻塞`MessageBox`直到其解散）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2015-12-10T13:20:18.400

这是将消息框放在应用程序窗口顶部的一种快速方法。

`MessageBox.Show(this ,"Output text"));`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-02-27T17:02:03.543

在您的“ `public partial class MainWindow : Window`”中放置以下代码。因此 Invoke 将在 UI 线程中运行您的代码。

```
void ShowErrorMessage(ERROR err)
{
    this.Dispatcher.Invoke((Action)(() =>
    {
        MessageBox.Show(err.description, err.code.ToString(), MessageBoxButton.OK, MessageBoxImage.Error);
    }));
} 
```

# javascript - jquery滑块ui在悬停时更改值？

> ID：10092565
> 
> 赞同：0
> 
> 时间：2012-04-10T16:21:50.910
> 
> 标签：javascript, jquery, ruby-on-rails, hover, slider

我在 Rails 开发中使用 jquery ui 滑块值，默认行为是

*   当用户单击滑块时，值会更新
*   为了将值发送到 HTTP POST，我将它包裹在一个表单上并添加了一个提交按钮。

我在下面编写的代码就是这样工作的，而且效果很好。

我想让它工作，以便

*   当用户将鼠标悬停在滑块上时，该值会更新
*   单击滑块设置值并发送表单
*   不需要提交按钮

我的功能

```
<script type='text/javascript'>     
 $(function() {
    $( "#slider-horizontal-1" ).slider({
        orientation: "horizontal",
        range: "min",
        min: 0,
        max: 100,
        value: 1,
        slide: function( event, ui ) {
            $( "#amount-1" ).val( ui.value );
        }
    });
    $( "#amount-1" ).val( $( "#slider-horizontal-1" ).slider( "value" ) );
});
</script>

<%= form_tag('/relationships/update/', :remote => true, :id => "relationships_form_1") do %>
<li id='box_li'>
<%= submit_tag 'Ready', :id => 'box_button' %>
<div id="slider-horizontal-1" class="sliders"></div>
<%= text_field_tag 'knows_me', value = :knows_me, :size => 2, :id => "amount-1" %>%
</li>
<% end %> 
```

我环顾四周，没有发现任何相关的东西。但是话又说回来，我已经编码了大约一个月，所以也许我没有适当地搜索。

有任何想法吗？这甚至可以在不重新发明轮子的情况下实现吗？

谢谢

# iframe - 不同子域上的会话 cookie 是否算作第 3 方？

> ID：10092567
> 
> 赞同：30
> 
> 时间：2012-04-10T16:21:57.447
> 
> 标签：iframe, cookies, subdomain, privacy

假设我有一个位于**www.example.com**的站点，它有一个指向 ASP.NET 站点**myapp.othersite.com**的 IFRAME - 这会导致会话和第 3 方 cookie 出现问题，据我所知。

如果我将嵌入式应用程序移至**myapp.example.com**，会话 cookie 是否仍算作第 3 方 cookie，因为它是不同的子域？

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2015-04-21T12:18:40.207

`example.com`如果 Cookie 来自不同的基域（基域为或），它们似乎被视为第 3 方`example.co.uk`，但如果它们来自同一基域的不同子域，则不是。

`myapp.example.com`如果它嵌入**在**.`myapp.example.com``www.example.com`

除非需要从不同的子域**读取**这些 cookie，否则不需要`myapp.example.com`使用域设置 cookie 。`.example.com`

 **[在 Firefox、Chrome（阻止 3rd 方 cookie）和 Safari 中测试] [ [ThirdPartyUtil.IsThirdPartyInternal](https://dxr.mozilla.org/comm-central/source/mozilla/dom/base/ThirdPartyUtil.cpp#46)似乎是在 Firefox 中检查的地方]

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2012-04-10T16:49:50.287

如果您在域上设置 Cookie`.example.com`

那么来自**www.example.com**和**www.myapp.example.com**的 cookie将被视为相同。

没有 cookie 被视为第 3 方 cookie。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2019-03-21T23:03:53.630

假设没有在相关 cookie 上设置域属性，在这种情况下，由于主机名不同，它确实是第三方 cookie。但是，通常会阻止第三方 cookie 的浏览器不会阻止它，因为基本域相同。因此，在这方面，它不被视为第三方 cookie。

我知道这一点是因为当基域相同而子域不同时，我能够成功设置和读取第三方 cookie，而第三方 cookie 在最新版本的 Firefox、Chrome 和 Microsoft Edge 浏览器设置中被阻止。即使没有在 cookie 上设置域属性也是如此。这意味着 Firefox、Chrome 和 Microsoft Edge 不会将来自同一基本域的 cookie 视为第三方 cookie。

我的方法如下。我有两个不同的主机名，它们具有相同的基本域但不同的子域。其中之一包含两个 PHP 文件。第一个设置一个带有随机 cookie 名称且没有域属性的 cookie，并将 cookie 的名称作为 JSONP 返回。第二次尝试读取 cookie，然后返回 true 或 false 作为 JSONP。另一个主机名包含一个 HTML 文件，该文件使用 AJAX 查询设置 cookie 的第一个 PHP 文件，然后在完成后立即再次使用 AJAX 查询第二个 PHP 文件，该文件测试是否存在 cookie。在继续之前，我首先确保浏览器阻止了第三方 cookie。我测试了三种浏览器：Firefox、Chrome 和 Microsoft Edge。

结论：如果一个资源设置了cookie，并且该资源上的基域与网站上的基域相同，但子域不同，则流行的浏览器不会将其视为第三方cookie。**

# php - 强制 fwrite 在 PHP 中使用 \n 而不是 \r\n

> ID：10092568
> 
> 赞同：1
> 
> 时间：2012-04-10T16:22:00.187
> 
> 标签：php, linux, fopen, fwrite

我在 Linux 服务器上运行 PHP，并且正在使用 PHP 的 fopen/fwrite 生成 bash 脚本以在 Mac 计算机上使用。它工作正常，除了行尾被写为 \r\n 而不是 \n，当我尝试在 Mac 上运行脚本时会导致错误。

如何强制 fwrite 使用 \n 而不是 \r\n 作为行尾？我试过 utf8_encoding 我的文本并强制二进制模式，但我似乎无法弄清楚！

```
 $scriptFile = "/path/to/my/script.sh";
   $fh = fopen($scriptFile, 'w');
   fwrite($fh, "$script");
   fclose($fh); 
```

$script 是 mysql 中文本字段的内容，看起来有点像这样，通常：

```
 # comment
   echo "numphotos 1"

   # comment
   /opt/local/bin/gphoto2 --capture-image-and-download -F 1 

   # comment
   echo "696969" 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-04-10T16:28:03.757

在您的代码中的某处，您正在自己编写行尾，因为 fwrite() 不会为您输入它们。不要写“\r”或“\n”或“\r\n”，而是将代码更改为使用 PHP_EOL...这将为运行 PHP 脚本的操作系统编写适当的行尾。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-10T16:33:04.850

`fwrite()`不会在您的文本中添加换行符。存在 Windows 换行符是因为您自己编写它们，或者直接：

```
fwrite($fp, "Foo\r\nBar"); 
```

...或间接：

```
// Source code saved on Windows
fwrite($fp, 'Foo
Bar'); 
```

因此，您唯一的选择基本上是将换行符更改为所需的样式。

即使您将文件作为文本打开（我假设您的意思是二进制文件），换行翻译也仅在 PHP 在 Windows 上运行时才有效（请参阅[http://es2.php.net/manual/en/function 上的注释。 fopen.php](http://es2.php.net/manual/en/function.fopen.php)）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-10T16:44:46.857

这将是要走的路：

```
fwrite($fh, str_replace("\r\n", "\n", $script)); 
```

# security - 来自 localhost 上受信任机构的 Opera 证书

> ID：10092577
> 
> 赞同：0
> 
> 时间：2012-04-10T16:22:19.970
> 
> 标签：security, iis, certificate, opera

我正在使用 IIS 基本身份验证，而我的最后一个障碍似乎是 Opera。证书未显示为来自“受信任的证书颁发机构”。我在本地主机上这样做。我已经将证书从 Personal 复制到 Trusted Root Certification。

其他所有浏览器似乎都可以正常使用 Basic Auth，而 Opera 似乎正在阻止我的进步。问题是我如何让 Opera 在我的本地机器上看到受信任的证书？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-10T16:47:02.607

Opera 使用自己的证书/信任库，而不是系统之一。您需要在 Opera 商店中安装您的证书才能信任它。看看如何 -> [http://help.opera.com/Windows/11.60/en/security.html](http://help.opera.com/Windows/11.60/en/security.html)

# jquery - 停止表单提交，使用 Jquery

> ID：10092580
> 
> 赞同：54
> 
> 时间：2012-04-10T16:22:38.443
> 
> 标签：jquery, asp.net-mvc-3, validation, preventdefault

如果验证失败，我正试图阻止我的表单提交。我尝试按照[上一篇文章](https://stackoverflow.com/a/895231/297641)进行操作，但不适用于我。我错过了什么？

```
<input id="saveButton" type="submit" value="Save" />
<input id="cancelButton" type="button" value="Cancel" />
<script src="../../Scripts/jquery-1.4.1-vsdoc.js" type="text/javascript"></script>
<script type="text/javascript">

    $(document).ready(function () {
        $("form").submit(function (e) {
            $.ajax({
                url: '@Url.Action("HasJobInProgress", "ClientChoices")/',
                data: { id: '@Model.ClientId' },
                success: function (data) {
                    showMsg(data, e);
                },
                cache: false
            });
        });
    });
    $("#cancelButton").click(function () {
        window.location = '@Url.Action("list", "default", new { clientId = Model.ClientId })';
    });
    $("[type=text]").focus(function () {
        $(this).select();
    });
    function showMsg(hasCurrentJob, sender) {
        if (hasCurrentJob == "True") {
            alert("The current clients has a job in progress. No changes can be saved until current job completes");
            if (sender != null) {
                sender.preventDefault();
            }
            return false;
        }
    }

</script> 
```

* * *

## 回答 #1

> 赞同：105
> 
> 时间：2012-04-10T16:26:06.830

同样，AJAX 是异步的。所以 showMsg 函数只有在服务器响应成功后才会被调用。表单提交事件不会等到 AJAX 成功。

`e.preventDefault();`在单击处理程序中移动as 第一行。

```
$("form").submit(function (e) {
      e.preventDefault(); // this will prevent from submitting the form.
      ... 
```

见下面的代码，

> 我希望它被允许 HasJobInProgress == False

```
$(document).ready(function () {
    $("form").submit(function (e) {
        e.preventDefault(); //prevent default form submit
        $.ajax({
            url: '@Url.Action("HasJobInProgress", "ClientChoices")/',
            data: { id: '@Model.ClientId' },
            success: function (data) {
                showMsg(data);
            },
            cache: false
        });
    });
});
$("#cancelButton").click(function () {
    window.location = '@Url.Action("list", "default", new { clientId = Model.ClientId })';
});
$("[type=text]").focus(function () {
    $(this).select();
});
function showMsg(hasCurrentJob) {
    if (hasCurrentJob == "True") {
        alert("The current clients has a job in progress. No changes can be saved until current job completes");
        return false;
    } else {
       $("form").unbind('submit').submit();
    }
} 
```

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2012-11-15T17:18:08.903

也使用这个：

```
if(e.preventDefault) 
   e.preventDefault(); 
else 
   e.returnValue = false; 
```

> 因为IE（某些版本）不支持e.preventDefault **( )。**在 IE 中是**e.returnValue = false**

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-04-10T16:29:11.823

试试下面的代码。 **添加了 e.preventDefault()**。这将删除表单的默认事件操作。

```
 $(document).ready(function () {
    $("form").submit(function (e) {
       $.ajax({
            url: '@Url.Action("HasJobInProgress", "ClientChoices")/',
            data: { id: '@Model.ClientId' },
            success: function (data) {
                showMsg(data, e);
            },
            cache: false
        });
        e.preventDefault();
    });
}); 
```

另外，您提到您希望表单在验证的前提下不提交，但我在这里没有看到代码验证？

**这是一些添加验证的示例**

```
 $(document).ready(function () {
    $("form").submit(function (e) {
      /* put your form field(s) you want to validate here, this checks if your input field of choice is blank */
    if(!$('#inputID').val()){ 
       e.preventDefault(); // This will prevent the form submission
     } else{
        // In the event all validations pass. THEN process AJAX request.
       $.ajax({
            url: '@Url.Action("HasJobInProgress", "ClientChoices")/',
            data: { id: '@Model.ClientId' },
            success: function (data) {
                showMsg(data, e);
            },
            cache: false
       });
     }

    });
 }); 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2014-08-15T18:07:36.393

一种不同的方法可能是

```
 <script type="text/javascript">
    function CheckData() {
    //you may want to check something here and based on that wanna return true and false from the         function.
    if(MyStuffIsokay)
     return true;//will cause form to postback to server.
    else
      return false;//will cause form Not to postback to server
    }
    </script>
    @using (Html.BeginForm("SaveEmployee", "Employees", FormMethod.Post, new { id = "EmployeeDetailsForm" }))
    {
    .........
    .........
    .........
    .........
    <input type="submit" value= "Save Employee" onclick="return CheckData();"/>
    } 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2018-07-05T10:29:51.550

这是用于防止提交的 JQuery 代码

```
$('form').submit(function (e) {
            if (radioButtonValue !== "0") {
                e.preventDefault();
            }
        }); 
```

# arrays - 使用 LINQ 获取数组维度的长度

> ID：10092581
> 
> 赞同：1
> 
> 时间：2012-04-10T16:22:39.673
> 
> 标签：arrays, linq, multidimensional-array, dimensions

我有一个数组，我想获取存储在数组中的每个维度的长度。即我想要如下内容：

```
Array myArray = //...Blah blah myArray is defined somewhere in code

int[] dimLengths = myArray.SomeLinqStatement... 
```

我可以用一些 for 循环来做到这一点，但我希望会有一个简单的 linq 语句。例如，如果 myArray 是 2x3x4 的 3D 数组，我希望 dimLengths 为 {2, 3, 4}。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-10T16:28:39.987

为什么需要 LINQ 来获取 `Array's 维度的长度？

```
myArray.GetLength(0); //returns the length of the first dimension
myArray.GetLength(1); //returns the length of the second dimension
myArray.GetLength(2); //returns the length of the third dimension 
```

[Array.GetLength 方法](http://msdn.microsoft.com/en-us/library/system.array.getlength%28v=vs.100%29.aspx)

这是您的“性感” LINQ 方法：

```
int[, ,] array3D = new int[,,] { { { 1, 2, 3 }, { 4, 5, 6 } }, 
                             { { 7, 8, 9 }, { 10, 11, 12 } } };
var result = Enumerable.Range(0, array3D.Rank)
      .Select(i => array3D.GetLength(i))
      .ToArray(); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-10T16:35:49.717

你不需要 LINQ。这是一个简单的解决方案：

```
int[] GetDimensions(Array array)
{
    int[] dimensions = new int[array.Rank];
    for (int i = 0; i < array.Rank; i++)
    {
        dimensions[i] = array.GetLength(i);
    }
    return dimensions;
} 
```

如果你必须使用 LINQ，你可以试试这个，虽然我相信另一种方式更好：

```
int[] dimensions = Enumerable.Range(0, array.Rank)
                             .Select(i => array.GetLength(i))
                             .ToArray(); 
```

# xcode - 如何在 xCode 中将块方法存储在变量中？

> ID：10092583
> 
> 赞同：2
> 
> 时间：2012-04-10T16:22:42.967
> 
> 标签：xcode, block, private, var

我有这样的方法：

```
- (void)showPermissionRequestsWithCompletionHandler:(void (^)())completionHandler
{
    completionHandler();
} 
```

我喜欢将 completionHandler 存储在一个私有变量中，这样我就可以在适当的时候调度它。有谁知道如何做到这一点？

* * *

我现在有：

```
typedef void (^VoidBlockType)();

@interface CMPermissionCenter : NSObject <UIAlertViewDelegate>
{
    @private
    VoidBlockType   _didShowPermissionRequestsBlock; 
}

- (void)showPermissionRequestsWithCompletionHandler:(void (^)())completionHandler
{
        _didShowPermissionRequestsBlock = [completionHandler retain];
        [self doSomeWork];
}

- (void)doSomeWork
{
        _didShowPermissionRequestsBlock();
        [_didShowPermissionRequestsBlock release];
        _didShowPermissionRequestsBlock = nil;
} 
```

但是有些事情告诉我这不是正确的方法。

# ruby-on-rails - 根据路线不同的登录视图

> ID：10092586
> 
> 赞同：0
> 
> 时间：2012-04-10T16:23:03.780
> 
> 标签：ruby-on-rails, devise

我正在使用 Devise2 和 Rails3。我想根据路线（users/foo vs users/bar）显示不同格式的登录视图。我不确定在哪里挂钩这种行为。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-10T18:05:51.787

似乎您必须使用 2 个动作 foo 和 bar 创建自己的设计控制器。在这里寻找一些灵感[覆盖设计注册控制器](https://stackoverflow.com/questions/3546289/override-devise-registrations-controller)

# ios - iOS - 以编程方式获取当前正在播放的项目队列

> ID：10092589
> 
> 赞同：10
> 
> 时间：2012-04-10T16:23:07.347
> 
> 标签：ios, avfoundation, mpmusicplayercontroller, mpmediaquery

我想以编程方式获取当前在本机音乐应用程序中播放的队列。我可以使用**MPMusicPlayerController**来获取当前正在播放的项目，但我不仅想获取项目，还想获取整个播放队列。是否可以使用**AVFoundation**或任何其他库来做到这一点？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2014-05-02T01:20:49.190

我很确定这是不可能通过任何公共 API 实现的。@sooper 提到的 Ecoute 应用程序必须使用私有 API。我在自己的音乐应用程序的代码库中做了一个小实验。首先，我使用这段代码列出了 iPod 音乐播放器中的所有方法（放在`#import <objc/runtime.h>`顶部）：

```
int i=0;
unsigned int mc = 0;
Method * mlist = class_copyMethodList([MPMusicPlayerController iPodMusicPlayer].class, &mc);
NSLog(@"%d methods for class", mc);
for(i=0;i<mc;i++) {
    NSLog(@"\tMethod no #%d: %s", i, sel_getName(method_getName(mlist[i])));
}
free(mlist); 
```

这出现了一些有趣的方法名称，例如`numberOfItems`and `nowPlayingItemAtIndex:`。所以我在文件顶部添加了这个类别：

```
@interface MPMusicPlayerController (Private)

- (NSInteger)numberOfItems;
- (MPMediaItem*)nowPlayingItemAtIndex:(NSInteger)index;

@end 
```

我运行了这段代码：

```
NSInteger numberOfItems = [[MPMusicPlayerController iPodMusicPlayer] numberOfItems];
for (NSInteger i = 0; i < numberOfItems; i++) {
    MPMediaItem* mi = [[MPMusicPlayerController iPodMusicPlayer] nowPlayingItemAtIndex:i];
    NSLog(@"%@", [mi valueForProperty:MPMediaItemPropertyTitle]);
} 
```

果然，它打印出了我在音乐应用程序中排队的播放列表！

当然，如果你以这种方式调用这些方法，Apple 会拒绝你的应用程序，但是有一种方法可以[隐藏来自 Apple 的私有 API 调用](https://stackoverflow.com/a/22385035/214070)。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2018-03-28T09:19:39.677

如果可以使用 Apple 私有 api。这应该是最好的。

```
let player = MPMusicPlayerController.systemMusicPlayer
let items = (player.value(forKey: "queueAsQuery") as! MPMediaQuery).items
//[MPMediaItem]? 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-04-11T08:59:06.263

恐怕这是不可能的。Apple 不允许我们从任何图书馆访问这些信息。

* * *

## 回答 #4

> 赞同：-2
> 
> 时间：2012-09-13T16:16:12.163

I've been looking into this and suddenly realized how simple it is!

```
- (void)mediaPicker:(MPMediaPickerController *)mediaPicker didPickMediaItems:(MPMediaItemCollection *)mediaItemCollection 
```

mediaItemCollection is the current playlist!

hope this helps.

# php - 如何下载和解析网页的一部分？

> ID：10092596
> 
> 赞同：1
> 
> 时间：2012-04-10T16:23:32.890
> 
> 标签：php, parsing, curl, wget

我不想下载整个网页。这将需要时间，并且需要大量内存。

我如何下载该网页的部分内容？然后我会解析它。

假设我只需要下载`<div id="entryPageContent" class="cssBaseOne">...</div>`. 我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-10T16:27:27.447

您不能通过“仅这一段 HTML”下载 URL 的一部分。HTTP 仅支持部分下载的字节范围，并且没有 HTML/XML 文档树的概念。

因此，您必须下载整个页面，将其加载到[DOM 解析器](http://php.net/dom)中，然后仅提取您需要的部分。

例如

```
$html = file_get_contents('http://example.com/somepage.html');
$dom = new DOM();
$dom->loadHTML($html);
$div = $dom->getElementById('entryPageContent');

$content = $div->saveHTML(); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-10T16:27:19.687

使用这个：

```
curl_setopt($ch, CURLOPT_RANGE, "0-10000"); 
```

将使 cURL 仅下载网页的前 10k 字节。此外，它仅在服务器端支持此功能时才有效。许多解释脚本（CGI、PHP、...）会忽略它。

# gnuplot - gnuplot：在右上角的框中包含模拟参数

> ID：10092601
> 
> 赞同：0
> 
> 时间：2012-04-10T16:23:59.610
> 
> 标签：gnuplot

我是 gnuplot 的新手。谁能告诉我如何将我的模拟参数包含在绘图右上角的框中？我希望参数框在用于显示实际曲线的图例下方可见。

我只想包含表单的三个参数：

```
"GraphConnectivity: 0.2"
"Query: 0.2"
"Content: 0.2" 
```

这应该在图例下方的框中可见。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-11T03:14:10.733

[这个页面](http://gnuplot.sourceforge.net/demo_4.2/rectangle.html)有一个很好的方式在一个盒子里放置一个标签（在 gnuplot 4.2+ 中）。

要查看标签中的多行如何使用，请尝试将以下行复制并替换到链接中的示例中：

```
#
# Illustrate using character widths to put a box around a label
#

# each line of the label gets a separate variable here
label1 = "Label in"
label2 = "a box"
label3 = "rocks"
LABEL = label1."\n".label2."\n".label3
# this bit finds the longest part of the multi-line string
# to determine the box width
longlabel = (strlen(label1) > strlen(label2)) ? label1 : label2
longlabel = (strlen(longlabel) > strlen(label3)) ? longlabel : label3

# change 'char 2' below to reflect the number of lines in the label.
# you will also have to adjust the y-position of the rectangle manually
set obj 10 rect at -3,(-4-0.4) size char strlen(longlabel), char 3
set obj 10 fillstyle empty border -1 front
set label 10 at -3,-4 LABEL front center 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-11T01:31:50.307

要添加标签，您需要`set label`...

例如

```
XVAL=???
YVAL=???
set label "GraphConnectivity: 0.2\nQuery: 0.2\nContent: 0.2" at screen XVAL,screen YVAL 
```

您需要稍微使用 XVAL 和 YVAL 才能让标签显示在您想要的位置。

或者，您可以使用 3 个设置标签命令：

```
set label "GraphConnectivity: 0.2" at screen XVAL, screen YVAL
set label "Query: 0.2" at screen XVAL, screen YVAL offset character 0,-1
set label "Content: 0.2" at screen XVAL, screen YVAL offset character 0,-2 
```

要在标签周围放置一个框，您可以使用不带头的箭头，也可以使用`set object rectangle`命令

# java - Java compareTo（对象 obj）

> ID：10092602
> 
> 赞同：0
> 
> 时间：2012-04-10T16:24:09.940
> 
> 标签：java, compareto

我给了一个任务，它本身的最后一天。我做了大部分，但在最后一个问题上，我在创建 compareTo() 函数时遇到了问题。

这就是它对我们的要求；

相比于

public int compareTo(java.lang.Object other)

```
Specified by:
    compareTo in interface java.lang.Comparable 
```

这是我所做的

```
public int compareTo(Object obj)
{
Document tmp = (Document)obj;
if(this.text < tmp.text)
{
/* instance lt received */
return -1;
}
else if(this.text > tmp.text)
{
/* instance gt received */
return 1;
}
/* instance == received */
return 0;
} 
```

这是我的整个 Document.java 文件

类文档 { 私有字符串文本；

```
/**
* Default constructor;  Initialize amount to zero.
*/
public Document()
{
    text = "";
}

/**
* Default constructor;  Initialize text to input value
* @param text New text value
*/
public Document(String text)
{
    this.text = text;
}

/**
* Returns as a string the contents of the Document.
*/
public String toString()
{
    return text;
} 
```

这是它自己的测试文件。

导入 java.util.Arrays；

公共类 Homework2 扩展文档 {

```
/** ======================
* ContainsKeyword
* Returns true if the Document
* object passed in contains keyword as a substring
* of its text property.
* ======================
*/
public static boolean ContainsKeyword(Document docObject, String keyword)
{
    if (docObject.toString().indexOf(keyword,0) >= 0)
        return true;
    return false;
}

public static void main(String[] args){

    Email email1= new Email("Programming in Java",
            "Larry", "Curly", "Programming");
    Email email2 = new Email("Running marathons",
            "Speedy", "Gonzales", "races");

    System.out.println(email1);

    File file1 = new File("Some Java file", "file.txt");
    File file2 = new File(
            "Boluspor wins against Besiktas. Muahahahaha", 
    "bolutas.txt");

    Document doc = new Document (
    "ok?,ok?,ok?,ok?,ok?,ok?,ok?,ok?,ok?,ok?,ok?,ok?");

    System.out.println("\n"+file1);

    System.out.println("\nWhich contains Java?");
    if (ContainsKeyword(email1,"Java")) System.out.println(" Email1");
    if (ContainsKeyword(email2,"Java")) System.out.println(" Email2");
    if (ContainsKeyword(file1,"Java")) System.out.println(" File1");
    if (ContainsKeyword(file2,"Java")) System.out.println(" File2");

    Document [] da = new Document [5];
    da[0] = email1;
    da[1] = email2;
    da[2] = file1;
    da[3] = file2;
    da[4] = doc;
    Arrays.sort(da);
    System.out.println("\nAfter sort:");
    for(Document d : da){
        System.out.println(d);
    }
}
} 
```

我想问的是，我无法比较我的 Email.java 和 File.java 中的对象，除了以 Document [] da 开头的最后一部分之外，我可以做任何其他事情......那部分给出了错误。我在这里做错了什么？

错误是；

```
Exception in thread "main" java.lang.ClassCastException: Email cannot be cast to java.lang.Comparable
at java.util.Arrays.mergeSort(Arrays.java:1144)
at java.util.Arrays.sort(Arrays.java:1079)
at Homework2.main(Homework2.java:53) 
```

****上传 ****这是我的电子邮件和文件类..**

 **```
/**
* First define class for Email, derive from Document
*/
class Email extends Document
{
    private String sender;
    private String recipient;
    private String title;
    private String body;

    /**
    * Constructors
    */
    public Email()
    {
        super();
        sender = "";
        recipient = "";
        title = "";
        body = "";
    }

    public Email(String body, String sender, String recipient, String title)
    {

        this.sender = sender;
        this.recipient = recipient;
        this.title = title;
        this.body = body;
    }

   // ======================
   // Various accessor and mutator methods
   // ======================
    public String getSender()
    {
        return sender;
    }

    public void setSender(String sender)
    {
        this.sender = sender;
    }

    public String getRecipient()
    {
        return recipient;
    }

    public void setRecipient(String recipient)
    {
        this.recipient = recipient;
    }

    public String getTitle()
    {
        return title;
    }

    public void setTitle(String title)
    {
        this.title = title;
    }
    public String getBody(){
        return body;
    }  
    public void getBody(String body){
        this.body = body;
    }

   /**
  * Returns as a string the contents of the text fields concatenated
  * together.  Uses super.toString to get the parent's text.
  */
   public String toString()
  { 
return "Sender:" + sender + ",Recipient:" + recipient + ",Title:" + title + ",Body:" + body + " " +
 super.toString();
  }
} // Email 
```

和文件；

```
/**
* Next define class for File, derive from Document
* For brevity, short one-line methods are defined here in the
* header.
*/
class File extends Document
{
private String pathname;

/**
* Constructors.
*/
public File()
{
    super();
    pathname = "";
}

public File(String body, String pathname)
{
    super(body);
    this.pathname = pathname;
}

// ======================
// Various accessor and mutator methods
// ======================
public void setPathname(String s)
{
    pathname = s;
}

public String getPathname()
{
    return pathname;
}

/**
* Returns as a string the contents of the text fields concatenated
* together.  Uses super.toString to get the parent's text.
*/
public String toString()
{
    return "Pathname " + pathname + " Body " + super.toString();
} 
```

} // 文件

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-10T16:29:09.547

你把`compareTo`方法放在哪里了？如果您尝试对 s 数组进行排序`Document`，则需要让 Document 实现 Comparable（或传入 Comparator）：

```
public class Document implements Comparable<Document> { 
```

或者，如果出于某种奇怪的原因，您不允许使用泛型：

```
public class Document implements Comparable { 
```

然后`compareTo`放入`Document`.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-10T16:29:53.290

它失败的确切原因是因为您试图调用`Arrays.sort`一个没有实现可比较的类

> 实施 Comparable 允许
> 
> ```
>  calling Collections.sort and Collections.binarySearch
>   calling Arrays.sort and Arrays.binarySearch
>   using objects as keys in a TreeMap
>   using objects as elements in a TreeSet 
> ```

电子邮件没有实现 Comparable 接口

利用

```
public class Email implements Comparable<Email> 
```

阅读这篇文章是为了帮自己一个忙[http://www.javapractices.com/topic/TopicAction.do?Id=10](http://www.javapractices.com/topic/TopicAction.do?Id=10)

另一个说明是你说你想比较

> Email.java 和 File.java

您将需要一个基于逻辑的自定义函数。

compareTo 用于比较相同类型的两个实例。这也意味着该函数存在于 Email 类中

```
Email myEmail = new Email();
Email hisEmail = new Email();

myEmail.compareTo(hisEmail); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-10T16:28:44.273

您做错了什么在错误消息中。

您只能对实现 Comparable 的类的对象进行排序。你的课没有。

当您对许多不同的类型进行排序时，您可能希望提供自定义 Comparator，或者使 Document 实现 Comparable。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-10T16:31:24.833

尝试这个：

这是我的整个 Document.java 文件

```
class Document implements Comparable { //this line is your solution.
 private String text;

/**
* Default constructor;  Initialize amount to zero.
*/
public Document()
{
    text = "";
}

/**
* Default constructor;  Initialize text to input value
* @param text New text value
*/
....} 
```**

# javascript - 链接到动态CRM集成

> ID：10092606
> 
> 赞同：0
> 
> 时间：2012-04-10T16:24:14.980
> 
> 标签：javascript, dynamics-crm-2011, linkedin

我正在尝试在 Dynamics CRM (2011) 中弹出一个包含有关 LinkedIn 帐户信息的弹出窗口，如此处所示[http://www.altiadvisors.com/Portals/0/Adding%20LinkedIn%20to%20Dynamics%20CRM%20 -%20Aug2010%20CRM%20Tip.pdf](http://www.alticoadvisors.com/Portals/0/Adding%20LinkedIn%20to%20Dynamics%20CRM%20-%20Aug2010%20CRM%20Tip.pdf)

我已将一个字段附加到表单，该字段应更改为具有表单的 onLoad 功能的按钮。这在`FunctionName`例如警报中使用了一段简单的 javascript，但是当我尝试使用 Linked In 集成添加更复杂的脚本时，我在 Internet Explorer 中打开了一个空白窗口，并且按钮没有改变。

恐怕我对 javacript 很陌生，我看不出错误在哪里。我的另一个担心是 Linked In 部分是为 CRM 4.0 编写的，我使用的是 2011，但我不知道实体之间的差异以发现和纠正任何错误。

下面是我在网络资源中的 javascript。任何想法或指示将不胜感激。

克里斯

```
function open()
{
ConvertToButton('new_buttonfield', 'LinkedIn','100px',FunctionName,'Button Label'); 
}

function ConvertToButton(fieldname, buttontext, buttonwidth,clickevent, title)
{

 //check if object exists; else return
 if (document.getElementById(fieldname) == null)
{
    alert("no field by that name");
    return;
 }

 functiontocall=clickevent;
 crmForm.all[fieldname].DataValue = buttontext;
 crmForm.all[fieldname].readOnly = true;
 crmForm.all[fieldname].style.borderRight="#3366cc 1px solid";
 crmForm.all[fieldname].style.paddingRight="5px";
 crmForm.all[fieldname].style.borderTop="#3366cc 1px solid";
 crmForm.all[fieldname].style.paddingLeft="5px";
 crmForm.all[fieldname].style.fontSize="11px";
 crmForm.all[fieldname].style.backgroundImage="url(/_imgs/btn_rest.gif)";
 crmForm.all[fieldname].style.borderLeft="#3366cc 1px solid";
 crmForm.all[fieldname].style.width=buttonwidth;
 crmForm.all[fieldname].style.cursor="hand";
 crmForm.all[fieldname].style.lineHeight="18px";
 crmForm.all[fieldname].style.borderBottom="#3366cc 1px solid";
 crmForm.all[fieldname].style.backgroundRepeat="repeat-x";
 crmForm.all[fieldname].style.fontFamily="Tahoma";
 crmForm.all[fieldname].style.height="20px";
 crmForm.all[fieldname].style.backgroundColor="#cee7ff";
 crmForm.all[fieldname].style.textAlign="center";
 crmForm.all[fieldname].style.overflow="hidden";
 crmForm.all[fieldname].attachEvent("onmousedown",push_button);
 crmForm.all[fieldname].attachEvent("onmouseup",release_button);
 crmForm.all[fieldname].attachEvent("onclick",functiontocall);
 crmForm.all[fieldname].style.lineHeight="14px";
 crmForm.all[fieldname+'_c'].style.visibility = 'hidden';
 crmForm.all[fieldname].title=title;
 window.focus();

}

 function push_button(){
 window.event.srcElement.style.borderWidth="2px";
 window.event.srcElement.style.borderStyle="groove ridge ridge groove";
     window.event.srcElement.style.borderColor="#3366cc #4080f0 #4080f0 #3366cc";
 }

 function release_button(){
 window.event.srcElement.style.border="1px solid #3366cc";
 }

 function LinkedInLoader(crmFormField) {

     var ll = this;
     ll.scriptSource = 'http://www.linkedin.com/companyInsider?script&useBorder=yes'
     ll.field = crmFormField;
     ll.container = crmFormField.parentNode;
     ll.nameToSearch = crmFormField.DataValue;
     ll.spanId = ll.field.id + '_linkedin';
     if (ll.container != null) {
         var span = document.createElement('span');
         span.id = ll.field.id + '_linkedin';
         var td1 = document.createElement('td');
         td1.innerHTML = ll.container.innerHTML;
         var td2 = document.createElement('td');
         td2.appendChild(span);
         td2.style.width = '15px';
         var tr = document.createElement('tr');
             tr.appendChild(td1);
         tr.appendChild(td2);
         var table = document.createElement('table');
         table.width = '100%';
         table.style.tableLayout = 'fixed';
         table.cellSpacing = 0;
             table.cellPading = 0;
         table.appendChild(tr);
         ll.container.innerHTML = table.outerHTML;
     }

     ll.ApplyCorrections = function () {
         var div = document.getElementById('company-insider-info-window');
         if (div != null) div.style.height = '275px';
         else window.setTimeout(ll.ApplyCorrections, 500);
     }

     ll.Enable = function () {
         new LinkedIn.CompanyInsiderPopup(ll.spanId, ll.nameToSearch);
         new LinkedIn.CompanyInsiderStylesheet();
         var span = document.getElementById(ll.spanId);
         if (span != null) span.attachEvent('onclick', ll.ApplyCorrections);
     }

     ll.OnScriptReadyState = function () {
         if ((event.srcElement.readyState == 'complete') ||
    (event.srcElement.readyState == 'loaded')) {
             ll.Enable();
         }
     }

     ll.Load = function () {
         var script = document.createElement('script');
         script.type = 'text/javascript';
             script.src = ll.scriptSource;
         script.onreadystatechange = ll.OnScriptReadyState;
         document.getElementsByTagName('head')[0].appendChild(script);
         }
 }

// now the definition of the function to call on button click
function FunctionName()
{
//if (account.FormType != 1) {
    // Set the field that contains the company name
    var linkedInLoader = new LinkedInLoader(crmForm.all.name);
    linkedInLoader.Load();
    //}
 } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-10T19:25:23.573

好吧，看看这个，有几件事......

首先，您动态注入的 LinkedIn URL 是 HTTP 而不是 HTTPS。在将其切换到 HTTPS 时，该 URL 似乎也会生成语法错误。

最好的办法是使用 LinkedIn 提供的 API：[https ://developer.linkedin.com/documents/getting-started-javascript-api](https://developer.linkedin.com/documents/getting-started-javascript-api)

最后，您引用的公司简介已被弃用。这是您尝试执行的最新版本：http: [//developer.linkedinlabs.com/jsapi-console/#examples/company_profile/hover.html&](http://developer.linkedinlabs.com/jsapi-console/#examples/company_profile/hover.html&) {"framework":"platform.linkedin.com/in. js","frameworkurl":"","apikey":"","apioptions":"","sessionbuttons":true,"async":false}

# video-encoding - 有没有一种好方法可以判断 HandBrakeCLI 是否真的编码了任何东西？

> ID：10092609
> 
> 赞同：3
> 
> 时间：2012-04-10T16:24:32.187
> 
> 标签：video-encoding

我正在开发一个系统，在创建 .mov 文件时将一堆 .mov 文件转换为 H.264（使用 HandBrakeCLI）和 webm（使用 ffmpeg）。总的来说，事情进展顺利。我挂断了一些错误检测。我想知道其中一种编码是否失败，以便我们进行调查、重试等。

为了测试编码失败，我将一个文本文件复制到一个扩展名为 .mov 的文件中，并设置程序尝试对其进行编码。自然，它们都无法对文件进行编码（我不确定在这种情况下“成功”意味着什么......）但是，虽然 ffmpeg 通过将其退出代码设置为 1 来报告此失败，但 HandBrakeCLI 将退出代码设置为 0 ，因为它干净地退出了。[这与HandBrakeCLI 文档](https://trac.handbrake.fr/wiki/CLIGuide)是一致的， 但它让我想知道如何判断 HandBrakeCLI 是否知道它是否无法编码任何内容。同一个文档页面建议“如果你想监控 HandBrake 的过程，你应该监控标准管道”，所以我现在通过执行以下操作来获得我想要的效果：

```
HandBrakeCLI --preset 'Normal' --input bad.mov --output out.mv4 2>&1 | grep 'Encode done' 
```

如果找到匹配项，则 grep 将其退出代码设置为 0，如果没有，则设置为 1。但是，这似乎很野蛮：例如，文本“编码完成！” 在 HandBrake 的未来版本中可能会发生变化。

那么，任何人都有更好的方法来判断 HandBrake 是否编码了某些东西？

下面包含一些已编辑的 shell 输出以供参考...

```
$ ffmpeg -i 'develqueuedir/B_BH_120409.mov' 'develqueuedir/B_BH_120409.webm'
FFmpeg version 0.6.4-4:0.6.4-0ubuntu0.11.04.1, Copyright (c) 2000-2010 the Libav Developers
[snip]
develqueuedir/B_BH_120409.mov: Invalid data found when processing input

$ echo $?
1

$ HandBrakeCLI --preset 'Normal' --maxWidth 720 --optimize --input 'develqueuedir/B_BH_120409.mov' --output 'develqueuedir/B_BH_120409.mv4'

Output format couldn't be guessed from file name, using default.
[11:45:45] hb_init: starting libhb thread
HandBrake 0.9.6 (2012022900) - Linux x86_64 - http://handbrake.fr
Opening develqueuedir/B_BH_120409.mov...
[snip]
[11:45:45] libhb: scan thread found 0 valid title(s)
No title found.

HandBrake has exited.

$ echo $?
0 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-22T19:00:09.313

简短的回答是否定的，您可以在 HandBrake 论坛上找到详细说明[https://forum.handbrake.fr/viewtopic.php?f=12&t=18559&p=85529&hilit=return+code#p85529](https://forum.handbrake.fr/viewtopic.php?f=12&t=18559&p=85529&hilit=return+code#p85529)

**补充：** 我认为有一个来自用户 fonkprop 的补丁被开发者拒绝，如果你真的需要它联系那个人

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-09-27T14:37:53.660

好消息！看来此功能即将在 HandBrake-CLI 0.10 中实现。正如您在 0.10 里程碑的[路线图上看到的：](https://trac.handbrake.fr/milestone/HandBrake%200.10)

> 对来自 CLI 的返回码的基本支持。（0 = 无错误，1 = 已取消，2 = 输入无效，3 = 初始化错误，4 = 未知错误”）

# c++ - C++ 组合程序错误（xcor 未声明）

> ID：10092615
> 
> 赞同：0
> 
> 时间：2012-04-10T16:24:51.547
> 
> 标签：c++

错误！xcor 在 setAll() 函数中未声明

我已经在 Circle 类中创建了 PointType 的对象来进行某种组合，但是在 Circle 的构造函数的初始化中，它表明

“ [错误] 'ycor' 未在此范围内声明”

“ [错误] 'xcor' 未在此范围内声明”

我想在我的 Circle 类中使用 xcor 和 ycor 以便使用 setAll() 函数获取半径

请帮忙！我在搞砸什么。

```
#include<iostream>
#include<cstdlib>
#include<cmath>
using namespace std;

class PointType{

    private:

    int xcor;//x coordinate
    int ycor;//y coordinate
    public:

    PointType();//constructor
    PointType(int x,int y);
    void setPoint(int x,int y);
    int getx() const;
    int gety() const;

};  
PointType::PointType():xcor(0),ycor(0)
{

}   

PointType::PointType(int x,int y):xcor(x),ycor(y){
}

void PointType::setPoint(int x,int y){
    xcor=x;
    ycor=y;

}

int PointType::getx() const{
    return xcor;
    }

int PointType::gety() const{
    return ycor;
    }

class Circle{

    protected:
        float Radius;
        float Area;
        int Circumference;
        float pi;
        PointType obj1;

    public:

    Circle();
    void setAll();
    float getRadius();

    float getArea();

    float getCircumference();
    void callFunction();
    void printAll();
    void pt(int x,int y);

};  

Circle::Circle():Radius(0),Area(0),Circumference(0),pi(3.1415),obj1(xcor,ycor){
}

void Circle::setAll(){

        Radius=sqrt(  (xcor*xcor)  + (ycor*ycor)  );
        Area=pi*Radius*Radius;
        Circumference=2*pi*Radius;
}

float Circle::getRadius(){
    return Radius;
}

float Circle::getArea(){
    return Area;
}

float Circle::getCircumference(){
    return Circumference;
}

void Circle::printAll(){

        cout<<"The Area is :"<<Area<<endl;
        cout<<"The Circumference is :"<<Circumference<<endl;    
    }
void Circle::pt(int x,int y){
    obj1.setPoint(x,y);

} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-10T16:27:25.053

您的类`Circle`没有任何名为`xcor`or的成员变量`ycor`。如果您想获取`PointType`对象的值，您的`setAll`函数应如下所示：

```
Radius=sqrt(  (obj1.getx()*obj1.getx())  + (obj1.gety()*obj1.gety())  ); 
```

您还必须更改构造函数：

```
Circle::Circle():Radius(0),Area(0),Circumference(0),pi(3.1415),obj1(0,0) 
```

因为它无权访问任何`xcor`一个`ycor`。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-10T16:33:11.260

1.  您必须更改您的 Circle 构造函数，因为它对 xcor 和 ycor 一无所知：

    `Circle::Circle():Radius(0),Area(0),Circumference(0),pi(3.1415),obj1(42,56)`

2.  Circle 类仍然不知道 xcor 和 ycor，因此您必须更改 setAll 方法：

    `Radius=sqrt( static_cast<double>((obj1.getx()*obj1.getx()) + (obj1.gety()*obj1.gety())) );`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-10T16:30:50.107

将 xcor,ycor 声明为 Circle 的构造函数参数，以及

在计算半径之前添加这一行：

```
int xcor = obj1.getx(), ycor = obj1.gety();
Radius=sqrt(  (xcor*xcor)  + (ycor*ycor)  ); 
```

您还可以考虑为 Circle 继承 PointType，而不是嵌入 obj1：

```
class Circle : public PointType
{
public: Circle(int x, int y):PointType(x, y) {}
...
/* remove obj1 */
} 
```

# javascript - JavaScript <-> DOM循环引用问题的精确解释

> ID：10092619
> 
> 赞同：10
> 
> 时间：2012-04-10T16:25:09.940
> 
> 标签：javascript, internet-explorer, memory-management

[jQuery.data](http://api.jquery.com/jQuery.data/)与原始 expando 属性（可以分配给 DOM 节点的任意属性）相比，被吹捧的优势之一是[jQuery.data](http://api.jquery.com/jQuery.data/) “不受循环引用的影响，因此不会出现内存泄漏”。Google 的一篇题为[“优化 JavaScript 代码”](https://developers.google.com/speed/articles/optimizing-javascript)的文章更详细地介绍了：

> Web 应用程序最常见的内存泄漏涉及 JavaScript 脚本引擎和实现 DOM 的浏览器的 C++ 对象之间的循环引用（例如，在 JavaScript 脚本引擎和 Internet Explorer 的 COM 基础结构之间，或 JavaScript 引擎和 Firefox XPCOM 基础结构之间）。

它列出了循环引用模式的两个示例：

*   DOM 元素 → 事件处理程序 → 闭包范围 → DOM

*   DOM 元素 → 通过 expando → 中间对象 → DOM 元素

但是，如果 DOM 节点和 JavaScript 对象之间的引用循环产生了内存泄漏，这是否意味着任何重要的事件处理程序（例如`onclick`）都会产生这种泄漏？我看不出事件处理程序如何避免引用循环，因为我看到它的方式是：

*   DOM 元素引用事件处理程序。

*   事件处理程序引用 DOM（直接或间接）。无论如何，要避免`window`在任何有趣的事件处理程序中引用几乎是不可能的，除非编写一个`setInterval`从全局队列中读取动作的循环。

有人可以提供 JavaScript ↔ DOM 循环引用问题的准确解释吗？我想澄清的事情：

*   哪些浏览器受到影响？jQuery 源代码中的一条评论特别提到了 IE6-7，但 Google 文章暗示 Firefox 也受到了影响。

*   expando 属性和事件处理程序在内存泄漏方面是否有所不同？或者这两个代码片段都容易受到同一种内存泄漏的影响？

    ```
    // Create an expando that references to its own element.
    var elem = document.getElementById('foo');
    elem.myself = elem;

    // Create an event handler that references its own element.
    var elem = document.getElementById('foo');
    elem.onclick = function() {
        elem.style.display = 'none';
    }; 
    ```

*   如果页面由于循环引用而泄漏内存，泄漏是否会持续到整个浏览器应用程序关闭，或者当窗口/选项卡关闭时内存是否被释放？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-10T17:25:52.470

复制这些链接中的所有内容可能不值得，所以我建议您阅读并查看[其他 Google 搜索](https://www.google.com/search?rlz=1C1TSNP_enUS471US471&sourceid=chrome&ie=UTF-8&q=circular%20reference%20memory%20leak%20browsers)结果：

[javascript、循环引用和内存泄漏](https://stackoverflow.com/questions/1999840/javascript-circular-references-and-memory-leaks)

[你知道什么可能导致 JavaScript 中的内存泄漏吗？](https://stackoverflow.com/questions/170415/do-you-know-what-may-cause-memory-leaks-in-javascript)

[http://www.ibm.com/developerworks/web/library/wa-memleak/](http://www.ibm.com/developerworks/web/library/wa-memleak/)

[http://www.ibm.com/developerworks/web/library/wa-sieve/index.html?ca=drs-](http://www.ibm.com/developerworks/web/library/wa-sieve/index.html?ca=drs-)

[http://code.google.com/p/google-web-toolkit/wiki/UnderstandingMemoryLeaks](http://code.google.com/p/google-web-toolkit/wiki/UnderstandingMemoryLeaks)

最严重的内存泄漏在 IE6 中，泄漏是永久性的（即使在您离开受影响的网页之后）。其他泄漏通常仅在您在该特定页面上时发生，并在您离开页面时被清理。

事实是浏览器应该能够处理循环引用。它应该能够看到，即使 DOM 元素仍然被 JavaScript 元素引用，JavaScript 元素本身只是因为 DOM 元素仍然存在而存在，因此没有真正的外部引用离开 DOM 元素. 正是这种认识是旧版本的 IE 不擅长的。因此，在涉及事件处理程序的代码引用中，垃圾收集器需要足够聪明，以知道 JavaScript 中对 DOM 元素的唯一引用是当 DOM 元素及其事件处理程序被删除时它们本身会消失的引用 - 因此没有真正的外部引用，因此删除 DOM 元素和事件处理程序是安全的。

jQuery`.data()`让事情变得更可靠，因为旧版本的 IE 在添加到 DOM 元素的属性方面存在特殊问题，并且没有正确处理涉及这些属性中的数据的循环引用，因此在应该有的时候不会释放东西（泄漏）。 `.data()`通过仅在 DOM 元素上使用一个添加的属性来解决此问题，该属性是安全的、不泄漏的字符串。然后，该字符串成为 JavaScript 对象的键，该对象可以包含您希望与 DOM 元素关联的所有属性。因为这些属性都存储在纯 JavaScript 中，浏览器没有循环引用错误，这样做不会导致泄漏。

It's important to realize that there may still be some circular references and that's OK. The work-around is to move the circular references to a place that the browsers handle them appropriately rather than putting them in the place that the browsers have bugs.

# c# - GridView 如何用新的值更新当前编辑行的值？

> ID：10092620
> 
> 赞同：-1
> 
> 时间：2012-04-10T16:25:16.697
> 
> 标签：c#, asp.net, sql

-简单的gridview和sql数据源将数据信息绑定到gridview。

在行更新时，如何使用我设置的新值更新当前编辑行的某个单元格？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-10T16:29:56.737

如果您在 Visual Studio 中执行此操作，则可以使用图形界面将属性更改为 gridview 和 sql 数据源，并在不编写代码的情况下进行配置。

如果你想看看它是如何在 asp 中完成的，可以看看这个：http: [//msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.sqldatasource.updatecommand.aspx](http://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.sqldatasource.updatecommand.aspx)

真正发生的是它更新数据库中的整行，并显示新值。这意味着您不需要只更改一个单元格中的值，而是需要更改整行

# insert - Sql Server 精简版。插入表时 OleDb 崩溃

> ID：10092622
> 
> 赞同：0
> 
> 时间：2012-04-10T16:25:18.740
> 
> 标签：insert, sql-server-ce, oledb

我创建了带有列的**表 Sellers**

```
Id - int, primary key, identity
FullName - nvarchar(100)
Password - nvarchar(100) 
```

当我尝试在表控制台中插入一行时，应用程序崩溃而没有机会捕获异常。

```
var command = new OleDbCommand("INSERT INTO Sellers (FullName, Password) VALUES(?, ?)", DbConnection);

command.Parameters.AddWithValue("@FullName", fullName);
command.Parameters.AddWithValue("@Password", password);

command.ExecuteNonQuery(); 
```

请告诉我我做错了什么？

为表选择工作正常。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-10T17:13:10.977

不支持针对 SQL Server Compact 使用托管 OledDB 提供程序，请使用专用 ADO.NET 提供程序 (System.Data.SqlServerCe) 或使用 DbProvider 对象。

# ruby-on-rails - 使用 with_exclusive_scope 进行分页

> ID：10092624
> 
> 赞同：0
> 
> 时间：2012-04-10T16:25:22.967
> 
> 标签：ruby-on-rails, pagination, will-paginate

有没有一种方法可以在 Rails 2.3 中使用 with_exclusive_scope 进行分页？

```
@albums = Album.paginate(:page => 1, :per_page => 12, :conditions => cond) 
```

工作正常。

```
Album.with_exclusive_scope {find(:all, :conditions => cond)} 
```

工作正常。

我们可以结合 with_exclusive_scope 和分页吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-15T15:40:15.603

@albums = Album.find_allx(opts).paginate(:page => 1, :per_page => 12)

with_exclusive_scope 是受保护的方法，因此必须从类消息中调用它。在这种情况下，类方法是 find_allx()

# asp.net - 如何使用 EF4.1 过滤可为空的 DateTime 字段？

> ID：10092626
> 
> 赞同：0
> 
> 时间：2012-04-10T16:25:23.713
> 
> 标签：asp.net, entity-framework-4.1, nullable

我有一个可以为空的 DateTime 字段的表：

```
CREATE TABLE [dbo].[myTable](
  [ID] [int] IDENTITY(1,1) NOT FOR REPLICATION NOT NULL,
  ...
  [FinishedDate] [datetime] NULL,
  etc... 
```

当我尝试这个时：

```
var activeThings = from foo in _context.myTable
                   where foo.FinishedDate == null
                   select foo;

foreach ( var thing in activeThings ) {
   ... do some stuff ...
} 
```

我没有得到任何价值。我怎样才能过滤这个空值？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-10T16:35:53.397

```
var activeThings = from foo in _context.myTable
                   where !foo.FinishedDate.HasValue //foo.FinishedDate.HasValue==false
                   select foo; 
```

[资源](http://msdn.microsoft.com/en-us/library/sksw8094.aspx)

HasValue 返回布尔值，

是真的 => 不为空

是假的 => 空

# facebook - Facebook Javascript SDK的异步加载？放置channel.php？

> ID：10092628
> 
> 赞同：1
> 
> 时间：2012-04-10T16:25:31.343
> 
> 标签：facebook, facebook-javascript-sdk, xfbml

> “channelUrl 必须是与包含 SDK 的页面匹配的完全限定 URL。”

来自[Facebook Developers Javascript SDK 文档](http://developers.facebook.com/docs/reference/javascript/)

好的，所以我添加了我的代码，如下所示：

```
 window.fbAsyncInit = function() {
       FB.init({
          appId: '*****', 
          channelUrl: '//www.somehost.com/channel.php', // Channel File
          status: true, 
          cookie: true, 
          xfbml: true 
       });

       // Additional Init code here.
   }; 
```

将加载 FB JS SDK 的站点部分不在索引页或我的频道文件所在站点的根目录上。

那么我应该把我的频道文件放进去`//www.somehost.com/channel.php`吗？

或者我应该把它放在其他地方，比如`//www.somehost.com/directory/folder/`要加载 SDK 的页面所在的位置？

对我来说，这听起来像是后者，但我并不完全确定这一点，因为我见过的大多数示例都将它放在根目录中。

将频道文件放在根目录中是否使其适用于所有子目录，其中包含将在域内加载 SDK 的页面？

对我来说，为每个子目录添加一个通道文件似乎有点多余，每个子目录中都有一个可以访问 sdk 的页面（除非这与安全有关）。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-10T17:35:12.643

所有文档都提到它是根目录，所以我认为它在那里很好。[如果它未能解决需要它的三个问题之一，](https://developers.facebook.com/docs/reference/javascript/)你就会知道它是否不起作用。

唯一的要求是域（不是完整的 url）和协议必须匹配。

# symfony - Symfony2 将数组值呈现为翻译文本

> ID：10092632
> 
> 赞同：2
> 
> 时间：2012-04-10T16:25:50.717
> 
> 标签：symfony, twig

似乎不可能使用我从数组中获得的值作为翻译文本......所以当我有

```
{% for key,value in ratings %}

<th scope="row">
   {% trans %}
    {{ value.type }}
    {% endtrans %}</th>
<td ><div  class="rating" id= "{{ value.type }}"   data-rating="{{ value.ratingaverage }}"
           thread="{{thread_id}}" rating_readonly= "{{ value.readOnly }}" route="{{ path('addrating') }}"  ></div> </td>
{% endfor %} 
```

我得到了错误

```
A message must be a simple text in TrackerMembersBundle::rating.html.twig at line 92 
```

这里的意思是与

```
 {% trans %}
    {{ value.type }}
    {% endtrans %} 
```

我似乎无法在直接来自数组的值上使用 trans ？例如，该值是`"file.quality"`

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-10T16:29:49.130

以前在这里搜索时可能会更好。

[Symfony2+Twig，翻译中的变量返回“A message must be a simple text”](https://stackoverflow.com/questions/7811162/symfony2twig-variable-in-translation-return-a-message-must-be-a-simple-text)

错误是翻译块中的变量。您必须设置一个占位符并将其替换为一个值。

```
{% trans with {'%type%':value.type} %}
    This is my %type%!
{% endtrans %} 
```

# javascript - 如何在 Javascript 警报/确认框后将用户重定向到新网页

> ID：10092640
> 
> 赞同：1
> 
> 时间：2012-04-10T16:26:24.980
> 
> 标签：javascript, redirect

我有一个客户希望在用户离开网站时弹出一个警报/确认框，然后根据他们的选择，他们将留在页面上或转到新页面（如果它可以工作，我会很高兴所有浏览器）。

我整天都在玩弄，得到了这段代码，但效果不太好。

```
<script>
window.onbeforeonload = function exitLeave(){var answer = confirm("You have not filled out your questionnaire yet")
if (answer){
    window.location = "http://www.google.com/";
}
else{
    alert("Cancel it !")
}    
} 
</script> 
```

任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-10T16:33:12.287

正确的事件处理程序名称是`onbeforeunload`(not `onbeforeOnload`)。请参阅[这个 SO 问题](https://stackoverflow.com/questions/9378802/detect-page-refresh-or-new-load-using-php-or-javascrpt)和我的答案（它指向 MDN，其中有一个关于如何实现您正在寻找的东西的小例子。）

# haskell - Babel 可以与 haskell 一起使用吗？我该怎么做？

> ID：10092644
> 
> 赞同：1
> 
> 时间：2012-04-10T16:27:06.427
> 
> 标签：haskell, integration, hpc

我想知道是否有人设法通过使用[Babel](http://www.llnl.gov/CASC/components)将 Haskell 与其他语言集成。

*   注意：我提出了三个与我关心的其他语言类似的不同问题。
*   注意2：我在把这个问题放在这里之前做了搜索。问题是，许多项目和页面都使用 Babel。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-11T20:45:51.907

LANL 的 Haskell 人员可能有一些工作，但除此之外，我没有看到整合的证据。

# ios5 - 试图在视图控制器之间传递数据

> ID：10092647
> 
> 赞同：2
> 
> 时间：2012-04-10T16:27:14.973
> 
> 标签：ios5, xcode4, uiviewcontroller, delegates, uinavigationcontroller

我在 NavigationController 中有一系列 4 个视图控制器，每个视图控制器都从用户那里获取一些文本字段，这些文本字段存储在 NSMutableDictionary 中。

每个 VC 的集合在 segue 之前都将自己作为 nextVC 的代表，它还传递 NSMutDict。

这工作正常。

我不明白的是：

假设我在 VC1 中填写了 5 个文本字段。然后我将自己设置为 VC2 的代表，将带有输入数据的字典传递给 VC2，然后转到 VC2。在 VC2 中，我填写了另外 4 个文本字段并将它们添加到字典中。如果我决定需要更改 VC1 中的某些内容，我会点击后退按钮并修改数据。但是当我再次前进时，我丢失了我在 VC2 上输入的内容。

如何使用添加的信息将字典传递回 VC1，以便当它再次传递到 VC2 时，它包含所有内容？

委托 (VC1) 有一个方法可以用 VC2 中的字典更新其字典。

我还通过在 VC1 的 prepareForSegue: 方法中设置它来自定义 VC2 中的 backBarButtonItem。

我想我已经接近了，但...

我只能通过在 VC2 中设置 leftBarButtonItem 并使用它而不是默认的后退按钮来使目标操作起作用。

在 VC1 (prepareForSegue:) 中设置后退按钮似乎不允许设置任何目标或操作。

我知道我无法在 VC2 中设置后退按钮，我该怎么办？我可以使用委托从 VC2 设置后退按钮的目标和操作吗？

我认为这可能与 UINavigationBarDelegate 有关，但我不知道该放在哪里。我尝试在 VC2 中设置它，但它没有做任何事情。

TIA。

以下是相关代码：

协议：

```
#import <Foundation/Foundation.h>

@protocol IAXAddNewUserDelegate <NSObject>
@required
- (void)updateNewUserDataWithData: (NSMutableDictionary *)newData;

@end 
```

从 VC1.h:

```
#import "IAXAddNewUserDelegate.h"

@interface IAXAddNewUser1 : UITableViewController <UITextFieldDelegate, UIAlertViewDelegate, IAXAddNewUserDelegate>

@property (strong, nonatomic) NSManagedObjectContext *managedObjectContext;
@property (strong, nonatomic) User *selectedUser;
@property (strong, nonatomic) User *aNewUser;
@property BOOL isFirstUser;

- (void)updateNewUserDataWithData: (NSMutableDictionary *)newData;

@end 
```

从 VC1.m:

```
#pragma mark - Segues
- (void)prepareForSegue:(UIStoryboardSegue *)segue sender:(id)sender
{
    if ([segue.identifier isEqualToString:@"AddUser2"]) {
        IAXAddNewUser2 *addUser2VC = segue.destinationViewController;
        addUser2VC.managedObjectContext = self.managedObjectContext;
        addUser2VC.progressTotal = self.progressTotal;
        addUser2VC.isFirstUser = self.isFirstUser;
        addUser2VC.userData = self.userData;
        addUser2VC.delegate = self;
        if (self.selectedUser) {
            addUser2VC.selectedUser = self.selectedUser;
        }
        self.title = @"Step 1";
        UIBarButtonItem *backButton = [[UIBarButtonItem alloc] initWithTitle:@"Back" 
                                                                       style:UIBarButtonItemStyleBordered 
                                                                      target:self 
                                                                      action:@selector(passDataBack:)];
        self.navigationItem.backBarButtonItem = backButton;
    }
}

#pragma mark - IAXAddNewUserDelegate Methods
- (void)updateNewUserDataWithData: (NSMutableDictionary *)newData
{
    self.userData = newData;
    NSLog(@"Updated AddUserVC1");
} 
```

来自VC2.m

```
-(void)passDataBack:(id)sender
{
    NSLog(@"Sending Data Back to VC1");
    [self.delegate updateNewUserDataWithData:self.userData];
    [self.navigationController popViewControllerAnimated:YES];
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-10T17:24:14.890

如果您要更新所有其他词典中的所有词典，请尝试使用单例。你可以在这里看到一个例子：[https ://stackoverflow.com/a/9690731/542400](https://stackoverflow.com/a/9690731/542400)

另外，这里有一些代码：

主字典.h

```
@interface MainDictionary : NSObject{
    NSMutableDictionary *dictionary;
}

+(MainDictionary *)sharedDictionary;
-(NSString *)getStringForKey:(NSString *)string;
-(void)setString:(NSString *)string forKey:(NSString *)key;
@end 
```

主字典.m

```
#import "MainDictionary.h"

static MainDictionary *sharedDictionary;

@implementation MainDictionary

-(id)init{
    self = [super init];
    dictionary = [[NSMutableDictionary alloc] init];
    // if you want to add anything preliminary to the dictionary, do it here
    return self;
}

+(MainDictionary *)sharedDictionary{
    static dispatch_once_t onceToken;
    dispatch_once(&onceToken, ^{
    sharedDictionary = [[self alloc] init];
    });
return sharedDictionary;
}
-(NSString *)getStringForKey:(NSString *)string{
    return [dictionary objectForKey:string];
}
-(void)setString:(NSString *)string forKey:(NSString *)key{
    [dictionary setValue:string forKey:key];
}
@end 
```

现在#import MainDictionary.h，任何时候您想访问或设置该字典中的值（在本例中，当您的 textFields 结束编辑时），只需执行以下操作：

```
-(void)textFieldDidEndEditing:(UITextField *)textField{
    if(textField == textField1){
        [[MainDictionary sharedDictionary] setString: textField.text forKey:@"textField1"];
    }
} 
```

或者：

```
-(void)viewWillAppear{
    textField1.text = [[MainDictionary sharedDictionary] getStringForKey:@"textField1"];
    [super viewWillAppear:YES];
} 
```

在每个 VC 中实现这一点，你就可以开始了。

# java - 如何通过 https 启动 java servlet？

> ID：10092649
> 
> 赞同：4
> 
> 时间：2012-04-10T16:27:22.870
> 
> 标签：java, tomcat, servlets, ssl

我正在尝试在 eclipse 中的 tomcat 上运行一个 servlet。当我在服务器上运行时，servlet 运行并为我提供如下链接：

“http://localhost:8443/AuthServer/Server”

我已经为 SSL 配置了我的 Tomcat 服务器，如下所示：

```
<Connector port="8443" protocol="HTTP/1.1" SSLEnabled="true"
               maxThreads="150" scheme="https" secure="true"
               clientAuth="false" sslProtocol="TLS" keystoreFile="C:\Users\owner\.keystore" keystorePass="sheetalkshirsagar"> 
```

当我在服务器上运行 servlet 时，它仍然使用 http。我希望我的 servlet 链接是“https://...”而不是“http://..”。你是怎样做的？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-04-10T16:49:10.417

如果您想确保在向该 servlet 发送请求时使用 https 协议，则需要更改`WEB-INF/web.xml`Web 应用程序中的文件。在您的情况下添加此配置参数：

```
<security-constraint>
    <web-resource-collection>
        <web-resource-name>AuthServer</web-resource-name>
        <url-pattern>/Server</url-pattern>
    </web-resource-collection>
    <user-data-constraint>
        <transport-guarantee>CONFIDENTIAL</transport-guarantee>
    </user-data-constraint>
</security-constraint> 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-04-10T16:38:22.880

在`TOMCAT_HOME/conf`文件夹中，有一个名为`web.xml`. 在那里，您必须添加一个`security-constraint`元素。

```
<security-constraint>
    <web-resource-collection>
        <web-resource-name>secured page</web-resource-name>
        <url-pattern>/...</url-pattern>
    </web-resource-collection>
    <user-data-constraint>
        <transport-guarantee>CONFIDENTIAL</transport-guarantee>
    </user-data-constraint>
</security-constraint> 
```

确保它`<url-pattern>`与您想要保护的路径相匹配。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-10T16:57:57.477

如果我正确理解您的问题，那么您正在`http`从您的 servlet 提供的网页发布 URL。
如果您需要将请求更改为，`https`您应该`redirect`将普通`http`连接器（在端口中`80`或`8080`拥有它的地方）连接到端口的连接器`443`。
如果你用谷歌搜索`tomcat redirect http to https`，你会发现很多链接，例如[将 tomcat 重定向到 https](http://krangsquared.blogspot.com/2007/09/set-up-tomcat-to-redirect-http-requests.html)

但是如果您对真正的安全性感兴趣，我建议您不要重定向

# events - ExtJS 在提交之前检查单元格的值

> ID：10092652
> 
> 赞同：1
> 
> 时间：2012-04-10T16:27:33.277
> 
> 标签：events, extjs

我有一个名为 event_date 的列。如果用户尝试在未填写 event_date 列的情况下提交信息并阻止进一步执行，我想警告用户。这是我定义我的专栏的方式：

```
header: 'Event_date',
            width: 115,
            dataIndex: 'event_time',
            renderer: this._renderExactDate,
            field: {
                type: 'textfield'
            } 
```

我的渲染功能是：

```
_renderExactDate: function(date) {
        if (date == '0000-00-00 00:00:00' || date == undefined) {
            Ext.MessageBox.show({
            title: 'New event',
            msg: 'You must set a date',
            icon: Ext.MessageBox.ERROR,
            buttons: Ext.Msg.OK
        });
      } 
      else
          {
              return date;
          }
    } 
```

但是观察。渲染器不是做到这一点的方法，但我还没有找到一种方法来做到这一点。

谢谢

勒隆

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-10T17:06:23.023

如果这是使用 ExtJS4，那么您应该使用[模型字段验证](http://docs.sencha.com/ext-js/4-0/#!/api/Ext.data.Model-cfg-validations)字段来设置接受的格式。如果任何标准不符合要求，请编写自定义标准。然后，您可以在尝试同步之前检查模型是否有效，并相应地标记警告。

您要参与的活动就是这个。然后您可以获取记录/模型并在生成警告之前检查其“isValid”方法。

链接：[Ext.grid.plugin.CellEditing validateedit](http://docs.sencha.com/ext-js/4-0/#!/api/Ext.grid.plugin.CellEditing-event-validateedit)事件

# sql - microsoft sql server management studio express 将数据库存储在内存中？

> ID：10092654
> 
> 赞同：2
> 
> 时间：2012-04-10T16:27:37.143
> 
> 标签：sql, database, memory

我正在运行一个数据库密集型测试，它使用一个~100MB 的小型数据库。

有没有办法让 microsoft sql server management studio express 将数据库存储在内存而不是硬盘中？我可以选择一些选项来执行此操作吗？

我也在考虑一个 ram 驱动器，但如果 mssmse 中有一个选项，我宁愿这样做。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-10T16:37:06.563

Management Studio 与数据库的存储方式无关。如果有足够的内存，SQL 数据库引擎将适当地缓存以加快查询速度。你真的不需要做任何特别的事情。您会看到初始查询比填充缓存后运行的查询要慢一些，这是正常的。

不要乱用 RAM 驱动器，这样做会占用 SQL 的内存，并且最终可能会降低效率。如果您迫切需要快速磁盘，则需要查看正确配置的阵列或固态驱动器。

有多种方法可以针对特定应用程序调整 SQL 的性能，但它非常复杂，需要对特定 SQL 服务器产品有深入的了解。你最好先看看数据库设计和查询优化。

实际上，大约 100MB 的数据库很小，如果设计得当，不需要特殊处理。

# haskell - Haskell：TVar 是如何工作的？

> ID：10092655
> 
> 赞同：9
> 
> 时间：2012-04-10T16:27:38.567
> 
> 标签：haskell, concurrency, tvar

TVar 是如何工作的？从我读过的内容来看，它会在收到它们后立即尝试运行所有事务，但是，完成的事务会使其他当前正在运行的事务无效，然后必须重新启动。TVar 是这样工作的吗？

如果是这种情况，如果每 100 毫秒发生 1 毫秒长的事务，这是否意味着需要 200 毫秒来处理的事务永远不会完成？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-04-10T16:57:29.810

只要两个事务访问 distinct `TVars`，它们就可以同时提交而不会相互失效。

为了明确交易何时*失效*，让我们考虑以下场景：

1.  假设它在事务开始时`t :: TVar Int`被初始化`0`并被读取。`readTVar t``A`
2.  `B`同时，在另一个线程中，开始执行a的事务`writeTVar t 1`。假设`B`之前提交`A`。STM系统会检查是否有不一致的地方，`B`判断此时commit是安全的，所以现在`writeTVar t 1`生效。
3.  但是，这会导致事务`A`无效，因为 的旧值`0`是`t`在 的开头读取的`A`。（如果`A`允许提交，我们将违反原子性。）

关于 Haskell 的 STM 系统（参见第 6.5 节）的原始论文 [1] 回答了您的问题：

> “饥饿是可能的。例如，运行很长时间的事务可能会反复与较短的事务发生冲突。我们认为在实践中不太可能发生饥饿，但如果没有进一步的经验，我们无法判断。”

[1] 蒂姆·哈里斯、西蒙·马洛、西蒙·佩顿·琼斯和莫里斯·赫利希。ACM 并行编程原理与实践会议 2005 (PPoPP'05)。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-04-10T16:59:53.623

> 如果每 100 毫秒发生 1 毫秒长的事务，这是否意味着需要 200 毫秒处理的事务永远不会完成？

事务只有在接触相同`TVar`的 s 时才会发生冲突，所以如果 1ms 事务中的一些避免了 200ms 事务影响的所有变量，那么 200ms 事务将能够完成。此外，由于`STM`monad 对内部允许的内容非常严格（*仅限*内存访问和纯计算！），因此在事务长度之间存在这种差异是非常不寻常的。通常，它们只有几次内存读/写，而且所有的`IO`其他计算将在事务之外完成。此外，一个特定的事务是否永远被其他事务阻塞是一个调度问题。我不能 100% 确定 GHC 当前的调度程序是什么样子，但它优先考虑旧的（或更高的失败率）事务似乎是合理的。

也就是说，活锁是一个非常现实的问题`STM`，并且与更传统的锁定并发实现中的死锁一样阴险且难以推理。

> TVar 是如何工作的？

你可能会喜欢这篇论文：

*   Tim Harris、Simon Marlow、Simon Peyton-Jones 和 Maurice Herlihy，“可组合内存事务”，[https ://doi.org/10.1145/1065944.1065952（](https://doi.org/10.1145/1065944.1065952)[此处](https://timharris.uk/papers/2005-ppopp-composable.pdf)为 预印本 PDF ）

# jquery - 如何在文本区域中聚焦和选择部分内容

> ID：10092656
> 
> 赞同：1
> 
> 时间：2012-04-10T16:27:38.283
> 
> 标签：jquery, textbox, backbone.js, haml, highlight

我有一个已经包含一些内容的文本区域（下面的 haml 代码）

```
//haml code for textarea
%section.input
  .muse_text
    %textarea{placeholder: "Type your muse here..."}

//Content in textarea
"Share why you are re-musing this
------------------
I am remusing this because I like it!!!!
------------------
xxxx" 
```

如何使用 jquery 自动聚焦 textarea 并仅突出显示内容的第一行，即“分享为什么要重新使用它（当页面加载时）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-10T16:47:57.213

当页面加载时，在 textarea 加载到 DOM`.focus`之后或之后将焦点放在 textarea（使用） 。`document.ready`您可以使用`createTextRange`或`setSelectionRange`（取决于浏览器）创建一系列文本以选择.. 这可以在您聚焦文本区域时完成。您知道“分享原因..”文本的长度，因此应该很容易计算。

# java - LWUIT 标签：创建自定义标签

> ID：10092657
> 
> 赞同：0
> 
> 时间：2012-04-10T16:27:40.983
> 
> 标签：java, java-me, label, paint, lwuit

我正在尝试创建一个自定义`Label`. 我想`Image` 根据用户输入的内容做一些类似标记的事情。我真的不知道该怎么做，但我希望你能知道我在这里想要达到的目标。派生`Label`类的正确方法是什么？这是我的代码。

```
class CustomLabel extends Label
{
   List paths;
   Image image;
   public CustomLabel(Image img,List paths)
   {
     this.image = img;
     this.paths = paths;
   }

   public void paint(Graphics g)
   {
     g.setColor(0x000000);
     for (int i = 0; i < paths.size(); i++) 
     {
        Path path = (Path)paths.getModel().getItemAt(i);
        int firstLocX = path.discoveredNode.getX();
        int firstLocY = path.discoveredNode.getY();
        int secondLocX = path.nodeDiscovered.getX();
        int secondLocY = path.nodeDiscovered.getY();
        g.drawLine(firstLocX, firstLocY, secondLocX, secondLocY);
     }
     g.drawImage(image, 0, 0);
     UIManager.getInstance().getLookAndFeel().drawLabel(g, this);
   }
} 
```

我希望你能帮我解决这个问题。

谢谢，

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-12T04:36:18.243

你不应该使用`UIManager.getInstance().getLookAndFeel().drawLabel(g, this);`

由于您希望您的绘图出现在顶部，因此您希望先绘制标签，然后再使用您的代码，因此`paint`方法中的第一行应该是`super.paint(g)`负责处理的。

您对 drawImage 的调用将其绘制在 0,0 处，这总是错误的。您应该根据`getX()`和定位绘图`getY()`。

话虽如此，我没有看到任何需要子类化的东西。如果您只是想绘制一个标志，为什么不创建一个在其背景中具有与给定标志对齐的图像的样式。然后只需有条件地将正确的 UIID 分配给标签。

# jquery - 动态定位悬停弹出窗口

> ID：10092658
> 
> 赞同：0
> 
> 时间：2012-04-10T16:27:44.210
> 
> 标签：jquery, popup, hover

如何创建动态定位悬停弹出窗口，它可以根据父缩进从左到右改变方向，而无需工具提示插件

HTML

```
<div class="main">
    <div class="visible">visible content</div>
    <div class="hidden">hidden content</div>
</div> 
```

JS

```
$('.main > .visible').hover(function () {
    $('.hidden').show();
}, 
function () {
    $('.hidden').hide();
}); 
```

示例（将鼠标悬停在海报弹出窗口上时改变方向） [http://www.ivi.ru/videos/all/all/all/by_new/?year_from=2010&year_to=2012](http://www.ivi.ru/videos/all/all/all/by_new/?year_from=2010&year_to=2012)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-10T19:39:05.683

您不需要 jQuery 来执行此操作，您可以在 CSS 中执行此操作。

将 .main 设置为`relative`并将 .visible/ .hidden 设置为，`absolute`以便您可以将 .hidden 定位在“外部”.main 上，然后在将鼠标悬停在 .main 上时显示它。

jsfiddle 示例：http: [//jsfiddle.net/ZjZSk/1/](http://jsfiddle.net/ZjZSk/1/)

```
.main {
width:100px;
height:100px;
position:relative;
background:#ff0000;   
}
.main:hover .hidden {
display:block;   
}
.visible {
position:absolute;
top:0;
left:0;
width:100px;
height:100px;   
}
.hidden {
position:absolute;
top:0;
left:100px;
width:100px;
height:100px;
display:none;
background:#aaaaff;   
} 
```

# c - C中的位计数类似于位旋转黑客

> ID：10092659
> 
> 赞同：2
> 
> 时间：2012-04-10T16:27:44.933
> 
> 标签：c, bit-manipulation, counter, bit

我需要创建一个例程来计算不涉及循环（仅位操作）并且不使用大常量的字中的位。

```
int x = 0xFFFFFFFF;
x += (~((x >> 1) & 0x55555555)+1);
x = (((x >> 2) & 0x33333333) + (x & 0x33333333));
x = (((x >> 4) + x) & 0x0F0F0F0F);
x += (x >> 8);
x += (x >> 16);
return(x & 0x0000003F); 
```

这是我在一些小技巧上发现的，但我可以使用的最大常数是 0xFF ... 不知道该怎么做。

谢谢各位。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-10T16:36:18.057

例如，您可以使用一个常量数组`COUNTS[16]`，它是从 0 到 15 的数字的二进制表示中设置的位数。然后：

```
static inline int byte_count (int x) {
  static const int COUNTS[16] = { 0, 1, 1, 2, 1, /* fill in the rest manually */ };
  return COUNTS[x & 15] + COUNTS[x >> 4];
}

int count(int x) {
  return byte_count(x >> 24) + byte_count((x >> 16) & 255) + byte_count((x >> 8) & 255) + byte_count(x & 255);
} 
```

没有循环，也没有大于 255 的常数。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-10T16:34:12.117

### 使用您的算法：

```
int x = 0xFF;
x |= (x << 8);  // x = 0xFFFF
x |= (x << 16); // x = 0xFFFFFFFF 
```

然后是其余的代码 - 只要它有效。

### 递归解决方案：

```
int foo ( int x )
{
    if ( x == 0 )
        return 0;
    return (x & 1) + foo ( x/2 );
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-07-28T05:17:10.967

你的问题已经[在这里回答了](https://stackoverflow.com/q/109023/995714)

```
int NumberOfSetBits(int i)
{
    i = i - ((i >> 1) & 0x55555555);
    i = (i & 0x33333333) + ((i >> 2) & 0x33333333);
    return (((i + (i >> 4)) & 0x0F0F0F0F) * 0x01010101) >> 24;
} 
```

# php - 如何使用 sf2 自定义叠瓦形式

> ID：10092664
> 
> 赞同：0
> 
> 时间：2012-04-10T16:27:57.337
> 
> 标签：php, symfony

我有一个包含对象集合的表单。我的问题是我需要自定义收集对象的显示。目前，我只有带有 的基础模板，依此类推。但是我想添加一些标签，例如`<h3>`，`<tr><td>`...我在哪里可以配置叠瓦形式的显示？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-10T16:34:56.433

这是如何自定义表单的完整章节。

[Symfony2 自定义表单](http://symfony.com/doc/current/cookbook/form/form_customization.html)

# ios - Mac vs. iOS safari src 播放 html5 视频的路径要求？

> ID：10092669
> 
> 赞同：1
> 
> 时间：2012-04-10T16:28:07.737
> 
> 标签：ios, html, google-chrome, html5-video

我无法理解为什么我存储在服务器上的视频无法在 iOS Safari 上播放，但可以在 Mac Safari 上播放。我从[这个页面](http://wordpress.org/extend/plugins/videojs-html5-video-player-for-wordpress/installation/)获取了这些视频。

为了向您展示我的意思，以下适用于 Mac 和 iOS Safari：

```
<video src="http://video-js.zencoder.com/oceans-clip.mp4"></video> 
```

而这仅适用于 Mac 而**不是**iOS Safari：

```
<video src="http://mysite.com/oceans-clip.mp4" ></video> 
```

我很困惑，因为它们是完全相同的视频。任何想法将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-17T17:14:39.540

这很可能是因为您有 SSL 的自签名证书。我遇到了同样的问题。iOS 不会播放来自自签名证书的视频 html。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-11T14:13:38.360

只是一个建议，但您的服务器上是否正确配置了 mime 类型？有些浏览器比其他浏览器更挑剔 MIME 类型...

如果您在 Firefox 中访问视频文件的 URL 并使用诸如 livehttpheaders 之类的扩展名，您应该能够看到文件以哪种 mime 类型发送，可能需要在您的配置中进行更正 - 谷歌应该告诉您如何做这个。:-)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-10T16:48:08.607

根据官方[Safari 开发者库](http://developer.apple.com/library/safari/#documentation/AudioVideo/Conceptual/Using_HTML5_Audio_Video/Device-SpecificConsiderations/Device-SpecificConsiderations.html#//apple_ref/doc/uid/TP40009523-CH5-SW1)，您应该添加“控件”

```
<video src="http://mysite.com/oceans-clip.mp4" controls ></video> 
```

# java - 从 Collection 更改为 SortedSet

> ID：10092672
> 
> 赞同：4
> 
> 时间：2012-04-10T16:28:13.743
> 
> 标签：java, spring, jpa

我正在将 Collection 更改为 SortedSet，因为我需要它始终保持与它们创建时相同的一致顺序。我已将模型属性从

```
@OneToMany(cascade = CascadeType.ALL, mappedBy = "contentId")
private Collection<Footnote> footnoteCollection; 
```

到

```
@OneToMany(cascade = CascadeType.ALL, mappedBy = "contentId")
private SortedSet<Footnote> footnoteSortedSet; 
```

以及所有相关功能，因此 Netbeans 不再显示任何错误。当我运行应用程序时，我收到错误：`Exception Description: Could not load the field named [footnoteSortedSet] on the class [class com.mysite.cmt.model.Content_]. Ensure there is a corresponding field with that name defined on the class.`

由于我刚刚正确更改并重新启动了我的应用程序，我正在努力弄清楚为什么它说它没有设置......

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-11T13:55:47.367

您得到的错误似乎来自 JPA 元模型。我假设你正在以某种方式生成它，如果你不使用 Criteria 中的元模型，那么你就不需要这个，错误就会消失。

问题是 JPA 只允许集合接口 Map、List、Set、Collection。因此，虽然您可以在新实例中使用 SortedSet，但从数据库读取的对象将使用特殊的惰性 List 实现。

在 EclipseLink 中，如果将映射标记为 EAGER，则可以使用 SortedSet。我认为元模型错误已修复，请尝试最新版本。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-10T16:56:09.877

[`SortedSet`](http://docs.oracle.com/javase/6/docs/api/java/util/SortedSet.html)javadoc来救援：

> 插入有序集合的所有元素都必须实现 Comparable 接口（或被指定的比较器接受）。

几乎可以肯定，`Footnote`不执行[`Comparable`](http://docs.oracle.com/javase/6/docs/api/java/lang/Comparable.html)

# objective-c - 当用户单击导航视图中的“保存”按钮时，我希望重新加载表格视图

> ID：10092676
> 
> 赞同：0
> 
> 时间：2012-04-10T16:28:30.983
> 
> 标签：objective-c, ios, uitableview, uinavigationcontroller

基本上，我在新视图中将项目添加到表中，如果用户点击保存，我希望视图弹出，并且之前的表视图更新显示新添加。关于如何完成这项任务的任何想法？

```
- (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath
{
    UITableViewCell *cell = [tableView dequeueReusableCellWithIdentifier:@"PersonTableViewCell"];

    if(!cell){
        cell = [[[UITableViewCell alloc] initWithStyle:UITableViewCellStyleDefault reuseIdentifier:@"PersonTableViewCell"]autorelease]; 
    }
    p = [friendsArray objectAtIndex:[indexPath row]];

    [[cell textLabel] setText:[p description]];
    return cell;
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-10T16:32:48.447

您可以尝试首先通过以下方式弹出当前视图控制器：

```
[self.navigationController popViewControllerAnimated:YES]; 
```

然后在您的表视图控制器的`viewDidAppear`or`viewWillAppear`中，调用

```
[self reloadData]; 
```

更新。

# c++ - 从 PE 导入表中获取 DLL 的完整路径

> ID：10092678
> 
> 赞同：1
> 
> 时间：2012-04-10T16:28:33.133
> 
> 标签：c++, import, portable-executable

我正在读取 PE 文件的导入表，并且能够从 IMAGE_IMPORT_DESCRIPTOR 结构中获取它导入的 DLL 的名称，但我找不到 DLL 路径的位置。我怎样才能阅读它们？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-10T17:15:51.873

您必须等到运行时才能获得导入的 DLL 的路径。这是因为答案取决于加载库时的运行时环境。

例如，两个不同的程序可能有两个不同的 DLL 搜索路径。因此，这两个程序的导入 DLL 的路径可能不同。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-10T17:13:31.157

你不能这样做，系统会在运行时从适当的位置加载相应的dll。在此之前不可能弄清楚路径。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-11T06:25:02.147

PE 图像仅包含依赖项的名称（和扩展名），而不包含它们的路径。

# c - Xcode C读取用户文本文件

> ID：10092682
> 
> 赞同：1
> 
> 时间：2012-04-10T16:28:43.103
> 
> 标签：c, xcode

我试图让用户输入一个文本文件的名称，然后打开该文本文件并读取它的第一行，它告诉将读取多少行并为其分配空间。然后我想将其余的行存储在分配的空间中。我正在使用 MacBook 并使用 Xcode 程序。我正在用 C 语言编写程序。

```
#include <stdio.h>      
#include <math.h>       
#include <stdlib.h> 

int main()
{
int MMSize, CacheSize, CBLineSize, SetAsso, NumOfLines, *Num;
char    RepPol, FileNam[75];
FILE    *ptr_file;

printf("Enter the name of the input file containing the list of memory references generated by the CPU: "); 

scanf( "%s", FileNam );
fpurge( stdin );

ptr_file = fopen(FileNam, "r");

 while (ptr_file==NULL){
    printf("failed to open file.\nPlease enter a valid file name: ");

    scanf( "%s", FileNam );
    fpurge( stdin );

    ptr_file = fopen( FileNam , "r" );
}   

fscanf(ptr_file, "%d", &NumOfLines);

Num = malloc(sizeof(int) * NumOfLines); 

for (int i=0; i<NumOfLines; i++) {
    fscanf(ptr_file, "%*[^0123456789]%d", &Num[i]);
            printf("%d\n", Num[i]);
}

    free(Num);
fclose(ptr_file);

return 0;
} 
```

我的代码运行良好，但它总是说输入文件为 NULL。我已将输入文件作为 file1.txt 保存在项目的源文件夹中。我尝试输入名称 file1.txt 以及文件的整个位置，并且循环连续运行，因为它说我的文件为 NULL。但是，当我转到查找器中的文件时，它里面有文本。任何人都可以帮我解决这个问题。

这工作的家伙。感谢所有的帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-10T17:58:27.093

这可能更接近您想要的。

```
#include <stdio.h>      
#include <math.h>       
#include <stdlib.h> 

int main(void)
{
  int  NumOfLines, *Num;
  char FileNam[75];
  FILE *ptr_file = NULL;

  printf("Enter the name of the input file containing the list of memory references generated by the CPU: "); 

  scanf( "%s", FileNam );
  fpurge( stdin );

  ptr_file = fopen(FileNam, "r");

  while(ptr_file == NULL) {
    printf("failed to open file.\nPlease enter a valid file name: ");

    scanf( "%s", FileNam );
    fpurge( stdin );

    ptr_file = fopen( FileNam, "r" );
  }   

  fscanf(ptr_file, "%d", &NumOfLines);

  Num = malloc(sizeof(int) * NumOfLines); 

  for (int i=0; i<NumOfLines; i++) {
    fscanf(ptr_file, "%d", &Num[i]);
    printf("%d\n", Num[i]);
  }

  free(Num);
  fclose(ptr_file);
  return 0;
} 
```

这将采用以下格式的输入文件：

```
2
123
456 
```

我从您的代码中猜测该格式应该是什么。现在发生的是第一个数字表示还有多少行（因此不包括它自己）。然后程序会尝试读取那么多行。

你犯的一些错误：

*   `fopen`使用字符串文字而不是同名变量调用
*   `do/while`当你打算使用 a时使用 a`while`
*   `Num`分配数组时未正确处理指针

# wpf - 根据WPF中的索引在UniformGrid中查找子行和列

> ID：10092688
> 
> 赞同：2
> 
> 时间：2012-04-10T16:29:02.513
> 
> 标签：wpf, vb.net

在 WPF 中，我有一个统一网格，并且希望能够根据子元素的索引找到行和列。

我知道有一种数学方法可以做到这一点，并且宁愿不使用普通的网格。

如果有帮助，我可以使用以下方法获取总行数和列数：

```
Math.Sqrt([*uniformgrid*].Children.Count) 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-04-10T16:57:14.070

抱歉，这是在 C# 中，但原则上你需要这样做

```
int rows = theGrid.Rows;
int columns = theGrid.Columns;

int index = theGrid.Children.IndexOf(childElement);

int row = index/columns;  // divide
int column = index%columns;  // modulus 
```

在 VB.NET 中

```
dim rows as Integer = theGrid.Rows
dim columns as Integer = theGrid.Columns
dim index as Integer = theGrid.Children.IndexOf(childElement)

dim row as integer = index \ columns
dim column as integer = index mod columns 
```

# c - 如何使 wait_event_timeout 函数的 timeout = 1 秒？

> ID：10092691
> 
> 赞同：2
> 
> 时间：2012-04-10T16:29:12.167
> 
> 标签：c, timeout, linux-kernel, time-wait

如何使 wait_event_timeout 函数的 timeout = 1 秒？功能 ：`wait_event_timeout (wq,condition,timeout);`

我怎样才能使超时= 1秒。

如果这样调用函数： `wait_event_timeout(queue,flag!='n',30*HZ);`

超时=？？？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-10T16:42:14.203

函数 wait_event_timeout 以 jiffies 为单位获取其超时值。使用常数`HZ`（每秒计时器滴答数）以 jiffies 为单位指定时间。表达式`HZ`相当于一秒钟。该表达式`30 * HZ`相当于 30 秒。

```
wait_event_timeout (wq,condition,HZ); 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-04-10T16:50:57.813

[wait_event_timeout](https://www.kernel.org/doc/htmldocs/device-drivers/API-wait-event-timeout.html)在 jiffies 中超时。并且`HZ`是 linux 中定义的标识符，表示 1 秒。所以`n * HZ`意味着`n`秒。希望现在您可以将 jiffies 时间转换为真实世界时间，例如`n millisecond = n*HZ/1000`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-11-10T09:13:47.700

只是备注：考虑到 HZ 因系统而异。在我知道的大多数系统/内核上，Hz 设置为 100。因此，将其除以 1000 以获得毫秒数将始终以值 0 结束。

# selenium - 解决 Selenium IDE 中的 _blank 缺陷时出现“结果为空”错误

> ID：10092693
> 
> 赞同：0
> 
> 时间：2012-04-10T16:29:27.987
> 
> 标签：selenium, selenium-ide

使用一种[解决方法](https://stackoverflow.com/a/4865433/96588)来检查新选项卡的内容，我得到了意想不到的结果。如果我播放测试用例，以下行将失败：

```
storeEval | javascript{"selenium.browserbot.getCurrentWindow().open('', 'my_window')"} | my_window 
```

带有以下错误消息：

```
[error] Threw an exception: result is null 
```

以下替代语句显示完全相同的症状：

```
getEval | window.open("", "my_window")
getEval | selenium.browserbot.openWindow("", "my_window") 
```

现在，如果我双击它，它*不会*失败，但它会打开一个新窗口，我认为原始解决方案并不打算这样做（下一步是单击*父*窗口中的链接，毕竟）。此时我可以点击父窗口，手动运行下一步启动链接，手动改回子窗口（`selectWindow | my_window`说找不到那个窗口），然后手动运行以下每个步骤来检查新窗口的内容。

我如何从这里开始使测试正确*自动化*？

更新：有一个用于打开窗口的内置操作，但它也失败了。也许这个逐字记录输出可以揭示正在发生的事情：

```
[info] Executing: |store | license_window | windowName |
...
[info] Executing: |openWindow | | ${windowName} |
[error] Unexpected Exception: fileName -> chrome://selenium-ide/content/recorder.js, lineNumber -> 74 
```

recorder.js 中的相关行：

```
66: window.open = function(url, windowName, windowFeatures, replaceFlag) {
...
74:            if (result.wrappedJSObject) {
75:                result = result.wrappedJSObject;
76:            } 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-10T21:42:24.403

您的浏览器似乎不允许您的网站弹出窗口。转到选项 > 内容 > 阻止弹出窗口的例外并添加您的网站地址。

# clojure - 具有多个命名空间的 Clojure CLR

> ID：10092694
> 
> 赞同：1
> 
> 时间：2012-04-10T16:29:33.933
> 
> 标签：clojure, clojureclr

我写了一个小的命名空间来做一些数据库操作，我想在另一个命名空间中使用它。通常将文件放在同一目录中，然后执行

```
(ns program (:require [other-ns :as other]) (:gen-class)) 
```

将是所有必要的。然而，这在 Clojure CLR 中不起作用，编译器抱怨不知道 other-ns。那么这样做的正确方法是什么？每个命名空间都有一个单独的程序集？

[编辑] 另一个例子

另一个.clj

```
 (ns another)

  (defn hello [name] (str "Hello " name)) 
```

程序.clj

```
 (ns program
    (:require [another :as a])
    (:gen-class)) 
```

我在 repl 中加载 program.clj 并收到以下消息：

FileNotFoundException 无法在加载路径上找到 another.clj.dll 或 another.clj。clojure.lang.RT.load (d:\work\clojure-clr\Clojure\Clojure\Lib\RT.cs:3068)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-11T11:11:56.590

我在同一个目录 filea.clj 和 fileb.clj 中创建了两个文件。这是filea.clj：

```
(ns filea)

(defn hi []
  (println "hi from filea")) 
```

这是fileb.clj：

```
(ns fileb
  (require [filea :as a])
  (:gen-class))

(defn -main []
  (println "hi from fileb")
  (a/hi)) 
```

然后我切换到这些文件所在的目录并运行：

C:\temp\multi-ns>clojure.compile fileb 将 fileb 编译为 . -- 59 毫秒。

当我运行它时，我看到：

C:\temp\multi-ns>c:\Tools\clojure-clr-1.3.0-Debug-4.0\fileb.exe hi from fileb hi from filea

您是在使用 vsClojure 还是在 VS 之外编写代码？

# ruby-on-rails - 获取 activerecord 模型的 ID

> ID：10092696
> 
> 赞同：1
> 
> 时间：2012-04-10T16:29:45.830
> 
> 标签：ruby-on-rails, ruby-on-rails-3, activerecord

当前代码

```
@current_site_name = 'SITENAME'
@current_site = Site.where(:name => @current_site_name)
@current_site_id = @current_site.id 
```

基本上，`name`我们`Site`模型中的列是唯一的。我们正在使用站点名称作为参数选择一行。

我回来了：`<ActiveRecord::Relation:0x59426bc1>`

我知道我不能简单地要求，`@current_site.id`但有没有办法将单个活动记录的 ID 放入变量中`@current_site_id`

同样，总会有一个活动记录。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-10T16:33:22.430

如您所见，即使只有一行符合您的条件，`where`也会返回一个（一组行）。`ActiveRecord::Relation`您可以通过`@current_site`将行更改为以下内容来分配给您想要的行：

```
@current_site = Site.where(:name => @current_site_name).first 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-10T16:50:35.183

嗯……这很奇怪。

```
Site.where(:name => @current_site_name).methods.include? :id #=> false 
```

但

```
Site.where(:name => @current_site_name).instance_methods.include? :id #=> true 
```

然而，

```
Site.where(:name => @current_site_name).instance_eval "id" #=> NameError 
```

和

```
Site.where(:name => @current_site_name).methods.include? "self.id" #=> NoMethodError 
```

也就是说，假设在您的情况下，只应返回一条记录的解决方法是

```
Site.where(:name => @current_site_name).instance_eval('find_first').id 
```

该`find_first`方法是`protected`因此我们必须在其执行中跳转范围以避免另一个`NoMethodError`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-10T17:03:57.207

只是为了抛出另一个解决方案，您可以使用为您的模型创建的 Rails 的[动态查找器。](http://guides.rubyonrails.org/active_record_querying.html#dynamic-finders)

```
@current_site = Site.find_by_name(@current_site_name) 
```

这将返回一条记录（因此不需要使用`first`），并且在某些人看来可能被视为更简洁的代码。

# ios - 在 iOS 中接收推送时调用应用程序播放音乐

> ID：10092698
> 
> 赞同：0
> 
> 时间：2012-04-10T16:29:48.390
> 
> 标签：ios, push, apple-push-notifications

我在 iOS 中实现了推送通知。我希望我的应用程序在发送推送消息时播放音乐（大约 15 秒）。我目前正在收到推送消息，并且只有当应用程序处于前台时才会播放音乐。如果应用程序在后台，它会显示一个通知，当我点击它时，它会播放音乐。

但是如何获得自动播放音乐的功能呢？我认为这是可以做到的，因为在 iOS 中，音频应用程序可以在后台运行。所以我只想在应用程序进入后台时播放音乐，并收到推送。

任何人都可以帮我解决这个问题吗？

谢谢， 尼廷

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2015-04-08T13:57:55.633

是的，有两种方法可以做到这一点。

**iOS 7之前的传统方式**是注册音频播放后台模式并永远播放静音，这将使您的应用程序在后台运行很长时间，直到用户将其杀死，或者由于内存不足而被杀死。

这种方式有很多缺点，用户必须启动你的应用程序一次才能开始播放声音，并且每次关闭 iPhone 时，用户需要在打开 iPhone 时重新启动你的应用程序。

这也会消耗大量电池。iPhone 5 每天 20%-30%。

**iOS 7.0 之后的新方法**是利用后台获取和远程通知，您可以在执行后台获取的同时播放声音，运行时间为 30 秒。您还可以通过推送通知触发后台获取。

这是一篇关于后台获取和推送通知的文章[http://www.objc.io/issue-5/multitasking.html](http://www.objc.io/issue-5/multitasking.html)

# javascript - 链接到 Facebook iframe 中的页面

> ID：10092702
> 
> 赞同：0
> 
> 时间：2012-04-10T16:29:58.190
> 
> 标签：javascript, html, facebook, iframe, hyperlink

我正在寻找一种方法来链接到 facebook iframe 页面中的网页

所以

```
http://www.facebook.com/designmystyle/app_244351832329915 
```

会是这样的

```
http://www.facebook.com/designmystyle/app_244351832329915?http://www.lickmystyle.com/contact/ 
```

我已经尝试过这里的方法[http://www.codingforums.com/archive/index.php/t-85547.html](http://www.codingforums.com/archive/index.php/t-85547.html)使用

```
 <script type="text/javascript">
    <!--

    function loadIframe(){
    if (location.search.length > 0){
    url = unescape(location.search.substring(1))

    window.frames["app_runner4f84331f0576e6f73380702"].location=url
    }
    }

    onload=loadI

frame
//--> 
```

我不确定 app_runner4f84331f0576e6f73380702 是 iframe 的名称还是 ID，但它是我能找到的唯一一个宽度为 810 像素 x 800 像素的框架

关于是否可以做到的任何想法都会很棒

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-10T21:18:23.957

如果它是一个 facebook 画布应用程序，那么它的 url 应该是*apps.facebook.com*而不是*www.facebook.com*。

任何将添加到您的画布应用程序 url 的查询字符串参数都将由 facebook 传递到您的应用程序，方法是在画布 iframe 中加载时将其添加到您的应用程序的 url，因此，如果您将用户定向到：

> apps.facebook.com/app-name?param=value

facebook 会将应用画布 iframe 发布到：

> www.yourdomain.com/canvas-path?param=value

然后，您可以像获取任何其他 GET 参数一样获取该参数以及您想要的参数。不过有一件事，如果该参数是一个 url，那么它应该是 url 编码的，否则会出错。

我不明白的是你想用你想作为参数传递的url做什么，这个“app_runner4f84331f0576e6f73380702”是什么？

* * *

# 编辑

哦，这是一个页面选项卡，对不起，我错过了那部分。

我以前从未使用过它，但它在[页面选项卡教程的最后一部分（](http://developers.facebook.com/docs/appsonfacebook/pagetabs/)*与 Facebook API 集成*）中说：

> 如果在加载选项卡的 URL 中的原始查询字符串中设置了 app_data 参数，您的应用程序还将收到一个名为 app_data 的字符串参数作为 signed_request 的一部分。对于上面的 Shop Now 链接，可能如下所示：“http://www.facebook.com/YourPage?v=app_1234567890&app_data=any_string_here”。如果您控制链接的生成，则可以使用它来自定义呈现的内容。

据我了解，这正是您获取数据所需要的。

但是，您将无法以您发布的方式更改 iframe 的 url，因为您无权访问父窗口（您的页面与 facebook 位于不同的域中，并且浏览器会因为交叉而阻止它-域策略）。

你能做的只是：

```
document.location.href = URL; 
```

You are in your own page, doesn't matter that it resides in an iframe.

The thing is that you don't need all of that, just be aware in the server side of the parameter that is passed to you from facebook (from the query string) if such exists, and render the page according to that. There's no reason to render a page that then redirects the page to another url, when you already know what the user wants, you're just making the user make a redundant round trip to your server for nothing.

# php - PHP ldap_error 不报告任何内容

> ID：10092718
> 
> 赞同：0
> 
> 时间：2012-04-10T16:30:53.273
> 
> 标签：php

我正在运行以下命令，但我的命令失败了。它在 die() 处正确停止，但不打印 ldap_error()。

```
// Now for LDAP
          require_once('ldapconnect.php');

          $entry["mysqldbname"] = $value;
          $result = ldap_mod_del($ldapconn, $binddn, $entry)or die(ldap_error()); 
```

我已经知道连接很好，因为我之前在这里测试过它，它在另一个页面上也可以正常工作。知道为什么我的错误没有打印吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-10T17:00:47.027

您必须指定连接，以便它知道在哪里查找。

更改自：

```
$result = ldap_mod_del($ldapconn, $binddn, $entry)or die(ldap_error()); 
```

到：

```
$result = ldap_mod_del($ldapconn, $binddn, $entry)or die(ldap_error($ldapconn)); 
```

现在我得到了故障排除所需的错误。

# javascript - Reg Ex JS 匹配样式标签内的内容

> ID：10092720
> 
> 赞同：0
> 
> 时间：2012-04-10T16:31:03.680
> 
> 标签：javascript, regex

我正在寻找可以匹配标签内内容的正则表达式。例子：

```
<style>
.foo1{display:block;}
.foo2{display:none;}
</style> 
```

JS Reg Ex 应该返回：

.foo1{display:block;} .foo2{display:none;}

请注意，可以具有 type="text/css" 中的属性

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-10T16:38:38.697

这应该有效：

```
str.match( /<style[^>]*>([^<>]+)<\/style>/ )[1]; 
```

# haskell - Haskell 中的数据初始化和数据成员变化

> ID：10092722
> 
> 赞同：-1
> 
> 时间：2012-04-10T16:31:20.363
> 
> 标签：haskell

我是 Haskell 的新手，我无法弄清楚如何声明“数据”类型以及如何使用该类型初始化变量。我还想知道如何更改该变量的某些成员的值。例如：

```
data Memory a = A 
  { cameFrom :: Maybe Direction
  , lastVal :: val
  , visited :: [Direction]
  } 
```

Direction 是一个包含 N,S,E,W 的数据类型 val 是一个 int 类型

```
init :: Int -> a
init n = ((Nothing) n []) gives me the following error:

The function `Nothing' is applied to two arguments,
but its type `Maybe a0' has none
In the expression: ((Nothing) n [])
In an equation for `init': init n = ((Nothing) n []) 
```

我怎样才能解决这个问题 ？

更新：做到了，非常感谢，但现在我有另一个问题

```
move :: val -> [Direction] -> Memory -> Direction
move s cs m | s < m.lastVal = m.cameFrom
            | ... 
```

这给了我以下错误：

```
 Couldn't match expected type `Int' with actual type `a0 -> c0'
    Expected type: val
      Actual type: a0 -> c0
    In the second argument of `(<)', namely `m . lastVal'
    In the expression: s < m . lastVal 
```

更新2：再次，这对我有很大帮助，非常感谢

另外，我还有一个问题（抱歉打扰了）

我如何只处理一个类型的元素例如，如果我有

```
Type Cell = (Int, Int)
Type Direction = (Cell, Int) 
```

如果我想将 Cell 变量与 Direction 变量的 Cell 元素进行比较，我该如何进行？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-10T17:22:22.033

至于更新。语法

```
m.lastVal 
```

和

```
m.cameFrom 
```

不是你想要的。反而

```
move s cs m | s < lastVal m = cameFrom m 
```

访问器只是函数，因此以前缀形式使用。Haskell 中的`.`用于命名空间解析（不依赖于路径）和函数组合

```
(.) :: (b -> c) -> (a -> b) -> a -> c
(.) f g x = f (g x) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-10T16:39:16.937

初始化：

```
init :: Int -> Memory Int
init n = A {cameFrom = Nothing, lastVal = n, visited = []} 
```

更改值：严格来说，您不会更改值，而是返回另一个不同的值，如下所示：

```
toGetBackTo :: Direction -> Memory a -> Memory a
toGetBackTo dir memory = memory {cameFrom = Just dir, visited = dir : visited memory} 
```

# c++ - 通过 UPnP 提高 QoS 以提高无线局域网上的 VoIP 质量

> ID：10092725
> 
> 赞同：0
> 
> 时间：2012-04-10T16:31:31.127
> 
> 标签：c++, voip, upnp, qos

我正在开发一个同时进行 VoIP、Cam-streaming 和文件传输的应用程序。目前它在 Windows、OS X、Android 和 iPhone/iPad 下运行。正如您可能理解的那样，这会产生相当多的网络流量，特别是如果同一 LAN 上的几个人同时进行此操作。结果，VoIP 质量受到影响。

我认为最好的理论解决方案是礼貌地询问本地 wi-fi 路由器是否可以优先处理 VoIP 流量。不幸的是，大多数流量流，包括用于 VoIP 和视频的 SIP，都经过加密并通过 TCP 发送。所以路由器无法弄清楚 TCP/UDP 流做什么。

我已经简要介绍了 UPnP QoS。从规格来看，这正是我所需要的。但我不知道它是否广泛适用于当今的家用路由器。我也不知道它是否真的按我想要的方式工作。简单地说：对于 VoIP，我想通过它的端点指定一个流，并告诉 wi-fi 路由器/家庭网络给它最小的延迟。

所以我的问题真的是：

*   是否值得进一步深入研究 UPnP QoS？
*   这是否被现代家庭 LAN 硬件（wi-fi 路由器）广泛采用？
*   有没有更好的方法可以考虑？

我还注意到三星为此申请了一项专利，我对此表示担忧。

我还没有为 UPnP 和 QoS 找到任何非常好的 API，但我想可以用 curl 或 boost::asio 来做一些事情。如果我这样做了，是否有兴趣为此目的使用 C++ 开源库？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-10T16:46:07.230

加密在 QoS 中不起作用，因为加密（通常）是在应用程序级别而不是 TCP/IP 级别。

您的问题更可能与[http://www.bufferbloat.net/有关](http://www.bufferbloat.net/)

# iphone - 屏幕解锁时重新启动应用程序

> ID：10092728
> 
> 赞同：0
> 
> 时间：2012-04-10T16:31:51.933
> 
> 标签：iphone, objective-c

当应用程序打开并且我们让它空闲时，屏幕会被锁定。当用户解锁它（幻灯片）时，我需要重新启动应用程序。

为此，我在`applicationDidFinishLaunching`方法中使用了以下代码。

```
[[UIApplication sharedApplication] setIdleTimerDisabled: YES]; 
```

屏幕解锁后，应用程序仍然不会重新启动。帮助，我应该怎么做才能使这项工作？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-10T16:52:57.157

您不必为此做任何事情。如果一个应用程序在锁定 iphone 之前打开，如果您再次解锁它，它将打开。

`setIdleTimerDisabled`只是确保在您的应用程序运行时设备不会自行进入睡眠状态。在大多数情况下，您不应该在整个应用程序范围内使用此功能。

# database - 嵌入式德比多连接问题

> ID：10092729
> 
> 赞同：3
> 
> 时间：2012-04-10T16:31:55.957
> 
> 标签：database, derby

我的 Web 应用程序（将部署在 tomcat 上）需要一个嵌入式数据库来存储临时用户数据以便更快地检索。我选择了 Apache Embedded Derby，因为它很容易嵌入到 Web 应用程序中，并且是一个纯 Java DB。

我还实现了连接池来检索连接。我在这里面临两个关键问题（显示停止）。首先，我的应用程序一次不能有两个以上的活动连接。所以，我的应用程序就挂了。

其次，我不断得到另一个应用程序已经启动了数据库。我怀疑当一个连接已经处于活动状态并且我尝试从池中获取另一个连接时会发生这种情况。

我读过嵌入式 derby db 一次只能有一个连接，那么它如何支持通过[EmbeddedConnectionPoolDataSource](http://db.apache.org/derby/javadoc/publishedapi/jdbc3/org/apache/derby/jdbc/EmbeddedConnectionPoolDataSource.html)进行连接池。

我现在应该在网络 derby 还是嵌入式服务器 derby 模式下运行 db？我不喜欢网络模式的想法，因为我需要更快的检索。那我宁愿用MySQL。如果我在嵌入式服务器 db 模式下运行 db，它是否支持连接池和至少 50 个并发连接 **，或者** 我是否应该将 derby 替换为其他嵌入式数据库，如 H2 或 HSQL 数据库，因为我已经读过 derby 仅用于培训目的，不应该在生产环境中使用？请协助

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-13T09:09:03.490

我使用 Apache commons dbcp 实现了连接池，它工作得非常好，而且在嵌入式模式下也是如此。

# java - 在 Windows 7 上从 Java 启动 CYGWIN 构建的可执行文件失败，并显示“加载共享库时出错：？：没有这样的文件或目录”

> ID：10092730
> 
> 赞同：2
> 
> 时间：2012-04-10T16:32:00.573
> 
> 标签：java, c, windows, cygwin, shared-libraries

有问题的代码在早期版本的 Windows 上或多或少地以完全相同的配置工作，但是，尚不清楚它是否已在 Windows 7 上运行！这就是我现在需要解决的问题。

简而言之，一些 C 代码在启动 java 程序之前执行一些配置和安全检查，传递一些在 Java 中几乎不可能轻易完成的数据。反过来，Java 在适当的时候启动相同的 C 代码，然后它自己启动不同的 Java 程序。第二个程序启动需要完全独立，（想想 nohup）因此是第二次启动。

现在发生的情况是 C 程序以普通方式启动 Java 程序，但是当 Java 尝试启动 C 程序时，它会出现如下错误：

> /cygdrive/c/opt/ST/v3.3/bin/ST.exe：加载共享库时出错：？：无法打开共享对象文件：没有这样的文件或目录

因为多年来 Windows 一直是个熊，所以 C 代码是在 Cygwin 的 posix 环境中编写的，但它真正做的只是普通的 C 类型的东西（它没有什么是 Cygwin 独有的，事实上，在过去它已使用微软的开发工具构建，但该环境目前不可用）。Cygwin 环境增加了许多其他巨大的好处，例如服务的命令行管理 (cygrunsrv) 和完整的类 nix 环境（bash 等）。事实上，由于 Windows 已经多次改变了从 Java 启动程序的方式，Cygwin 有助于标准化 Java 启动代码。这是一段摘录：

```
 if (ClientOS.indexOf("Windows") != -1)
  {
     if (ClientOS.equals("Windows 95"))
     {
        cmd = "command.com /C ";
     } else if (ClientOS.equals("Windows 98"))
     {
        cmd = "command.com /C ";
        //cmd = "cmd.exe /C ";
     } else if (ClientOS.equals("Windows NT"))
     {
        cmd = "cmd.exe /C ";
     } else if (ClientOS.equals("Windows 2000"))
     {
        cmd = "cmd.exe /C ";
     } else if (ClientOS.equals("Windows XP"))
     {
        cmd = "cmd.exe /C ";
     } else {
        cmd = "cmd.exe /C ";
     }
     if (cygwin)
     {
        cmd += Shell+" '"+Command+"'";
     } else {
        cmd += Command;
     }
  } else {
     cmd = Command;
  } 
```

（是的，if 结构可以更好地优化。）

在这种情况下，“外壳”等于：

```
Shell=C:/cygwin/bin/bash -c 
```

而且，有一个测试程序可以确保上述代码和支持代码正常工作 - 它运行一些 shell 程序并确保它得到它认为应该的东西。它说：

> 检查使用 shell 运行程序的能力...是的，shell 程序可以正常工作。

cmd 的最终内容如下所示：

> cmd.exe /CC:/cygwin/bin/bash -c '/cygdrive/c/opt/ST/v3.3/bin/ST.exe'

**我怀疑：**

我怀疑发生了什么是 Cygwin1.DLL 文件没有被正确找到。它位于 C:/cygwin/bin/cygwin1.dll

**注意**系统级 PATH 和 Cygwin PATH 都包含 cygwin .dll 文件的路径。将 cygwin1.dll 的副本移动到目标可执行文件所在的 bin 目录也不起作用。

LD_LIBRARY_PATH 会在这里提供帮助吗？如果是这样，知道如何设置吗？

其他想法？

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-10T17:12:43.523

几种方式。

cygwin1.dll 需要位于 %WINDIR%\system32 或同等位置。

或者

您修改 PATH 变量以在调用者的环境中添加 cygwin1.dll 的路径。

或者

在调用 cygwin 构建的 exe 之前调用设置环境的 .bat 文件。

或者

您构建一个独立版本的 .exe（即没有 cygwin 依赖项）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-10T16:52:08.730

```
C:/cygwin/bin/bash -c '/cygdrive/c/opt/ST/v3.3/bin/ST.exe' 
```

这不起作用，因为您的工作目录是您执行此命令时所在的位置。您必须将依赖 cygwin 的 dll 复制到执行此操作的目录中。否则，您必须将 cygwin bin 目录放在系统 PATH 变量中，不确定您是否要这样做，这可能会导致 dll 地狱。

此外，如果您在配置文件中使用任何内容，则需要将 --login 参数添加到 bash：

```
bash --login -c 
```

此外，在生成进程之前，在最后打印出最终命令：

```
printf('%s\n',cmd) 
```

只是为了确保它正是你想要的。

如果您不确定引用的 dll，您也可以使用 strace 运行该程序。

# c - 将命令转换为 Makefile

> ID：10092734
> 
> 赞同：3
> 
> 时间：2012-04-10T16:32:05.830
> 
> 标签：c, gcc, makefile

我一直在阅读 Makefiles，但我仍然不知道如何将以下命令写入 Makefile。

```
gcc -std=c89 A.c -c
gcc -std=c89 B.c -c
gcc -std=c89 C.c -c
gcc -std=c89 A.o B.o -o A
gcc -std=c89 C.o B.o -o C 
```

A 和 C 依赖于 B，但它们是独立的程序。

这就是我想出的不起作用的方法：

```
CC = gcc -std=c89
FILES = A.c B.c C.c
OUT = out
build: $(FILES)
    $(CC) -o $(OUT) $(Files)
clean:
    rm -f *.o core 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-10T16:50:11.333

这是一个没有噱头的 makefile，在 gcc 和 rm 之前的必须是 'tab' 字符，它们不是空格。

```
all: A C

A.o: A.c
    gcc -std=c89 -c A.c

B.o: B.c
    gcc -std=c89 -c B.c

C.o: C.c
    gcc -std=c89 -c C.c

A: A.o B.o
    gcc -std=c89 -o A A.o B.o

C: C.o B.o
    gcc -std=c89 -o C C.o B.o

clean:
    rm A C a.o b.o c.o core 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-10T16:37:47.157

尝试这个：

```
X1 = A
O1 = A.o B.o

X2 = B
O2 = C.o B.o

DBGFLAGS = -g -O0
CFLAGS = -W -Wall $(DBGFLAGS)

all: $(X1) $(X2) 

$(X1): $(O1)
        $(CC) $(LDFLAGS) -o $@ $(O1) $(LIBS)

$(X2): $(O2)
        $(CC) $(LDFLAGS) -o $@ $(O2) $(LIBS)

.PHONY: clean

clean:
        rm -f $(X1) $(O1) $(X2) $(O2) *~ 
```

如果复制粘贴不这样做，请将 8 个空格更改为一个选项卡。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-04-10T16:54:07.367

当你编写一个 makefile 时，你通常从头开始，然后朝着开始的方向努力。您从最终产品开始，并给出有关如何从起点开始生产的规则。

在这种情况下，您似乎有两个最终产品：`A`和`C`.

```
all: A C 
```

如果您没有在命令行上指定目标，make 将构建它在 makefile 中看到的第一个目标。因此，您希望它作为文件中的第一个目标，其他目标在其下方。如果你把它想象成一棵树，这就是树的根，下面的每一项都是那棵树的一个分支。

也可以定义*不*包含在此根之下的次要目标。例如，许多（大多数？）makefile 包含一个名为的目标，该目标`clean`删除将在构建过程中创建的所有中间文件。这*只会*在/如果用户调用时使用`make clean`，而不是作为`make`命令发出的一部分。

无论如何，然后你告诉它每个依赖什么，以及如何从它依赖的内容创建它：

```
A: A.o B.o
    $(CC) -o A A.o B.o

C: B.o C.o
    $(CC) -o B B.o C.o 
```

然后（如果有必要——它不在这里）你会告诉它每个`.o`文件如何依赖于一个`.c`文件。然而， Gmake（就像几乎`make`所有存在的工具一样）具有内置规则来告诉它如何编译 C 或 C++ 文件以生成匹配的目标文件。这些就像你的makefile在顶部包含这样的东西：

```
CC = gcc

.c.o:
    $(CC) $(CFLAGS) -c $*.c 
```

这会将 CFLAGS 的当前值作为标志传递给编译器，因此您希望将其设置为您需要的标志 - 在您的情况下：

```
CFLAGS = -std=c89 
```

您通常希望将其放在 makefile 的顶部，通常位于任何目标之前。

我应该补充一点，这甚至无法涵盖您可以在 makefile 中执行的所有操作。当您处理大量文件时，有*很多*快捷方式非常方便，但当您只有三个源文件时，它们就不是很有用了。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-04-10T16:37:16.093

假设您使用[GNU make](http://www.gnu.org/software/make/)，您可以主要依赖内置规则：

```
CFLAGS = -std=c89
LDFLAGS = -std=c89
A: A.o B.o
C: C.o B.o 
```

这将执行您列出的命令。但是，它不关心清洁或类似的东西。不过，您不一定需要 -`make`程序会注意到何时需要重新编译/重新链接并自动执行此操作。

# linux - 来自glibc的这段代码的目的是什么

> ID：10092738
> 
> 赞同：0
> 
> 时间：2012-04-10T16:32:25.927
> 
> 标签：linux, glibc, nptl

我试图了解[glibc 中 tls.h](http://sourceware.org/git/?p=glibc.git;a=blob;f=nptl/sysdeps/x86_64/tls.h;h=f644f0daf039d3481b78987dab3135bbecdde20f;hb=HEAD#l138)的以下代码段在做什么以及为什么：

```
/* Macros to load from and store into segment registers.  */
# define TLS_GET_FS() \
  ({ int __seg; __asm ("movl %%fs, %0" : "=q" (__seg)); __seg; }) 
```

`fs`我想我理解将寄存器中存储的值移动到`__seg`. 但是，我有一些问题：

1.  我的理解是`fs`只有16位。这个对吗？当值被移动到四字内存位置时会发生什么？这是否意味着高位被设置为 0？

2.  更重要的是，我认为`__seg`在段开始时声明的变量的范围仅限于该段。那么怎么`__seg`用呢？我确信作者`glibc`有充分的理由这样做，但我无法通过查看源代码来弄清楚它是什么。

我尝试为这段代码生成程序集，我得到了以下信息？

```
 #APP
 # 13 "fs-test.cpp" 1
 movl %fs, %eax
 # 0 "" 2
 #NO_APP 
```

所以在我的情况下，它看起来像是`eax`用于`__seg`. 但我不知道这是否总是会发生，或者是否只是我编译的小测试文件中发生的事情。如果它总是要使用`eax`，为什么不这样编写程序集呢？`__seg`如果编译器可能会选择其他寄存器，那么由于在宏末尾超出范围，程序员如何知道要访问哪个寄存器？最后，当我在 glibc 源代码中对它进行 grep 时，我没有在任何地方看到这个宏，所以这进一步增加了我对其用途的困惑。任何关于代码在做什么以及为什么的解释都值得赞赏。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-12T05:56:43.127

> 我的理解是fs只有16位。这个对吗？当值被移动到四字内存位置时会发生什么？这是否意味着高位被设置为 0？

是的。

> 在段开始处声明的变量 __seg 仅限于此段。那么 __seg 有什么用呢？

您必须阅读 GCC [statement-expression extension](http://gcc.gnu.org/onlinedocs/gcc-3.3.6/gcc/Statement-Exprs.html)。语句表达式的值是其中最后一个表达式的值。最后`__seg;`的 the 将是无用的，除非将其分配给其他东西，例如：

```
int foo = TLS_GET_FS(); 
```

> 最后，当我在 glibc 源代码中对它进行 grep 时，我没有看到在任何地方使用这个宏

`TLS_{GET,SET}_FS`实际上似乎没有使用。它们可能在某个版本中使用过，然后在引用它们的代码被删除时意外遗留下来。

# caching - GORM (grails) - 缓存 blob 图像或其他东西

> ID：10092756
> 
> 赞同：1
> 
> 时间：2012-04-10T16:33:30.103
> 
> 标签：caching, grails, blob, grails-orm

假设我有一个域类

```
class Profile{
    String name
    byte[] logo
} 
```

和一个控制器：

```
class ImageController {
    def renderImage ={
       def image = Profile.get(params.id).logo
       if (image) {
            response.setContentLength(image.length)
            response.getOutputStream().write(image)
        } else {
             response.sendError(404)
        }    
    }
} 
```

和普惠制：

```
 <img width="48" 
      height="48"
      src="${createLink(controller: 'image', action: 'renderImage', id: 1)}"> 
```

好的，到目前为止一切都很好。图像渲染得很好，我很高兴。但是，由于 gsp 片段是我的主要布局的一部分，因此每次重新加载页面时都会呈现图像。

我的问题：有没有办法缓存这个图像（blob mysql）？我打开了二级缓存等。但我不确定图像是否被缓存。你会怎么做？

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-10T17:00:52.687

添加`static mapping = { cache true }`到您的配置文件域类以打开缓存。只要您使用 获取 Profile 对象`get(id)`，它就会使用缓存版本。如果您使用更复杂的查询，则需要让 grails 知道该查询也是可缓存的。

请参阅 Grails 手册中的[缓存部分](http://grails.org/doc/latest/guide/GORM.html#caching)。此外，打开[休眠 SQL 日志记录](http://grails.org/FAQ#Q%3a%20How%20can%20I%20turn%20on%20logging%20for%20hibernate%20in%20order%20to%20see%20SQL%20statements,%20input%20parameters%20and%20output%20results?)以确认对象已缓存可能会有所帮助。

# matlab - Babel 可以与 Matlab 一起使用吗？我该怎么做？

> ID：10092757
> 
> 赞同：0
> 
> 时间：2012-04-10T16:33:38.170
> 
> 标签：matlab, integration, hpc

我想知道是否有人通过使用[Babel](https://computation.llnl.gov/casc/components/#page=home)设法将 Matlab 与其他平台集成。

*   注意：我提出了三个与我关心的其他语言类似的不同问题。
*   注意2：我在把这个问题放在这里之前做了搜索。问题是，太多的项目和页面使用了 Babel。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-10T17:01:40.950

I've no experience using Babel and not heard of it being used with Matlab before. However, Matlab tends to handle interoperability with other languages by means of its own toolboxes. In particular, if you're interested in interop between Matlab and any one of C, C++, C#, or Java, there exist mature and well-tested toolboxes for the job:

[Matlab Compiler for working with C/C++ interop](http://www.mathworks.co.uk/products/compiler/)

[Matlab Builder NE for working with .NET interop](http://www.mathworks.co.uk/products/netbuilder/)

[Matlab Builder JA for working with Java interop](http://www.mathworks.co.uk/products/javabuilder/)

[Matlab Builder EX for working with Excel interop](http://www.mathworks.co.uk/products/matlabxl/)

If you need to handle more languages, a message-passing library like RabbitMQ might be a better bet.

# java - 对快速排序算法感到困惑

> ID：10092758
> 
> 赞同：0
> 
> 时间：2012-04-10T16:33:38.187
> 
> 标签：java

我正在实现一个快速排序算法，并成功地将输入数组围绕一个枢轴进行了分区。问题是，我很困惑如何使用相同的输入数组对数组的第一部分和第二部分（即指定范围）进行递归排序。下面是我的实现

```
class QuickSort {

    int i; 
    int l = 0;

    public void quicksort(int A[], int n) {

        if (n == 1) {
            return;
        } else {
            partition(A, 0, n);
//----Confused as from this point
            quicksort(A, A[i]);

            //Recursively sort both parts of the array
        }
    }

    public int partition(int A[], int l, int r) {
        int p = A[l];//Choose pivot
        i = l + 1;
        //Partition around A through P
        for (int j = i; j < r; j++) {
            if (A[j] < p) {
                swap(A, i, j);
                ++i;
            }
        }
        swap(A, l, i - 1 );
        return i;
    }

    public void swap(int A[], int i, int j) {
        int temp = A[i];
        A[i] = A[j];
        A[j] = temp;
    }
    public void display(int A[]){
        for (int i = 0; i < A.length; i ++){
            System.out.print(A[i] + " ");
        }
    }
}
class QuickSortApp{
    public static void main(String args[]){
        QuickSort quick = new QuickSort();
        int A[] = {6,2,7,8,4,3,5};
        quick.quicksort(A,  A.length);
        quick.display(A);
    }
} 
```

拜托，我也希望能纠正我算法中的任何其他低效率问题。谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-10T17:11:18.997

`quicksort()`将您的签名更改为`quicksort(int[] A, int begin, int end)`

因为，你实际上在里面进行了排序`partition()`。我要做的是：

```
if (end-begin <= 1) {
    return;
} else {
    int pivot = partition(A, begin, end);
    quicksort(A, begin, pivot);
    quicksort(A, pivot, end);
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-10T16:37:21.867

使用您拥有的签名为快速排序调用创建一个包装器，该签名调用另一个类似的签名，`quicksort(A, i, j)`并且您来自包装器的调用将是`quicksort(A, 0, n)`.

# javascript - 为什么要将 $.click() 包含在 $(document).ready() 中？

> ID：10092762
> 
> 赞同：18
> 
> 时间：2012-04-10T16:34:19.043
> 
> 标签：javascript, jquery

我正在浏览[http://docs.jquery.com/How_jQuery_Works](http://docs.jquery.com/How_jQuery_Works)并发现包含`$.click()`事件的要求`$(document).ready()`甚至有点奇怪。我的困难如下：

*   当文档加载时，控件将进入`$(document).ready()`功能，但它会继续执行`$.click()`吗？（基于它不会的行为。但是当控件进入正常功能时，为什么它不进入`$.click()`功能？）
*   由于用户只有在文档准备好后才能看到 url，所以真的需要嵌入其中`$.click()`吗`$(document).ready()`？

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2012-04-10T16:38:06.703

[How jQuery Works 文档](http://docs.jquery.com/How_jQuery_Works)使用绑定`.click()`内部的示例来确定在函数执行时已经创建`$(document).ready()`了事件绑定到的元素。`.click()`

以`.click()`函数作为参数调用的函数不会在与其前一个选择器匹配的节点上*执行*`.click()`，而是将函数绑定到匹配的节点' `onclick`。

如果你试图做这样的事情：

```
$('a').click(function(){
  alert('clicked me');
}); 
```

...在文档中`<head>`或在呈现任何`<a>`元素之前，事件不会绑定到任何节点，因为`$('a')`在函数执行时不存在与选择器匹配的节点。

此外，如果您在创建某些`<a>`标签时执行此操作，则只有已创建的标签才会获得绑定事件。`<a>`绑定函数后创建的标签将没有`.click()`绑定。

所以在 jQuery（和其他 JavaScript 框架）中，你会经常看到在一个`$(document).ready(function(){});`

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-04-10T16:40:45.230

这里关注的不是实际调用`.click()`，而是调用它的元素的选择器。

例如，如果有一个元素，`id="myButton"`那么您将引用它：

```
$('#myButton') 
```

但是，如果该元素尚未加载（即，如果文档尚未准备好并且您不*知道**当前*加载了哪些元素），则该选择器将找不到任何内容。所以它不会调用`.click()`任何东西（绑定事件或触发它，取决于参数`.click()`）。

您可以使用其他方法，[例如 jQuery`.on()`函数](http://api.jquery.com/on/)，它可以将事件绑定到公共父元素，并从文档生命后期添加的事件中过滤“冒泡”事件。但是如果你只是使用一个普通的选择器并调用一个函数，那么选择器需要在 DOM 中找到一些东西才能让函数做任何事情。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-10T16:38:26.047

是的，您需要确保要向其中添加点击处理程序的 DOM 元素存在，您可以通过准备好的文档知道这一点。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-04-10T16:43:22.973

该`$(document).ready(..)`方法试图解决的问题是页面的 javascript 代码执行与页面中的控件被绑定的时间之间的紧张关系。`ready`一旦文档准备好并且 DOM 元素可用，该函数将触发，因此 javascript 代码可以对 DOM 做出合理的假设

最常见的例子是 javascript 代码相对于它试图操作的 DOM 元素的位置。考虑

```
<script>
$('#target').click(function() {
  alert('It was clicked');
});
</script>
<div id="target">Click Me</div> 
```

In this particular example the javascript will not function as intended. When the script block is entered the `click` line is run and there currently is no DOM element with the id `target` hence the handler binds to nothing. There is nothing really wrong with the code, it just had the unfortunate timing to run before the DOM element was created.

In this example the problem is obvious because the code and DOM element are visually paired together. In more complex web pages though the javascript is often in a completely separate file and has no visual guarantees about load ordering (nor should it). Using the `$(document).ready(..)` abstraction removes the question of ordering as a potential source of problems and facilitates proper separation of concerns

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-04-10T16:41:03.350

Javascript 通常在读取标签后立即开始执行。这意味着在将脚本放在头部的标准实践中，还没有创建任何元素供您绑定点击处理程序。甚至身体元素还不存在。使用 jQuery.ready 会延迟执行代码，直到所有 DOM 元素都已加载。

# javascript - 使用 JavaScript 动态过滤 HTML 表格的行

> ID：10092765
> 
> 赞同：2
> 
> 时间：2012-04-10T16:34:27.760
> 
> 标签：javascript, html, dom

所以我有这张桌子：

```
<table border="1" align="center">
    <tr>
        <td>Broj_pu</td>
        <td>Naziv_pu</td>
        <td>ID</td>
        <td>Naselje</td>
        <td>zupanija</td>
    </tr>
    <tr>
        <td><input type="text" ID="broj_pu" onkeydown="Filter(document.getElementById('broj_pu').value,     'broj_pu')" /></td>
        <td><input type="text" ID="naziv_pu" onkeydown="Filter(document.getElementById('naziv_pu').value,   'naziv_pu')" /></td>
        <td><input type="text" ID="ID" onkeydown="Filter(document.getElementById('ID').value,           'ID')" /></td>  
        <td><input type="text" ID="naselje" onkeydown="Filter(document.getElementById('naselje').value,     'naselje')" /></td>
        <td><input type="text" ID="zupanija" onkeydown="Filter(document.getElementById('zupanija').value,   'zupanija')" /></td>    
    </tr>

    <tr class="row" ID="row_filter">
        <td>10000</td>
        <td>Zagreb</td>
        <td>1</td>
        <td>Sljeme</td>
        <td>ZAGREBACKA</td>
    </tr>

    <tr class="row" ID="row_filter">
        <td>10000</td>
        <td>Zagreb</td>
        <td>2</td>
        <td>Zagreb-dio</td>
        <td>ZAGREBACKA</td>
    </tr>
<!-- A lot of rows -->
...
</table> 
```

而且我还启动了这个 JavaScript：

```
<script type="text/javascript">
    function Filter(text, column_name){
        var x = document.getElementByClassName("row");
        var i = 0;
        var y;

        if (text != ""){
            switch (column_name){
                case "broj_pu":
                for (i = 0; i < x.length; i++){
                    y = x[i].getElementByTagName("td");
                    if((y[0].value).match(text) == null){
                        x[i].attributes(style) = "{display:none;}";
                    }
                }
                break;

                case "naziv_pu":
                    y = x[i].getElementByTagName("td");
                    if((y[1].value).match(text) == null){
                        x[i].attributes(style) = "{display:none;}";
                    }
                }
                break;

                case "ID":
                    y = x[i].getElementByTagName("td");
                    if((y[2].value).match(text) == null){
                        x[i].attributes(style) = "{display:none;}";
                    }
                }
                break;

                case "naselje":
                    y = x[i].getElementByTagName("td");
                    if((y[3].value).match(text) == null){
                        x[i].attributes(style) = "{display:none;}";
                    }
                }
                break;

                case "zupanija":
                    y = x[i].getElementByTagName("td");
                    if((y[4].value).match(text) == null){
                        x[i].attributes(style) = "{display:none;}";
                    }
                }
                break;
            }
        }
    }
</script> 
```

现在，当用户在文本字段中输入字母时，我需要过滤表格，但我不知道如何在输入数据时编辑显示文档。

有人有想法吗？

编辑1：

所以我编辑了脚本，但它似乎不起作用。我做错什么了？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-10T20:41:38.803

这个问题让我想起了没有任何框架支持的java脚本是多么讨厌:)

但是我已经为您解决了这个问题（在 firefox 10.0.2 上测试过）。

检查[jsfiddle上的完整工作解决方案](http://jsfiddle.net/Q7RKk/)

请记住这只是一个工作示例，您可能需要编写所有浏览器兼容的脚本。

**脚本：**

```
var filters=['hide_broj_pu','hide_naziv_pu','hide_ID','hide_naselje','hide_zupanija'];

function ExcludeRows(cls){

  var skipRows=[];

  for(i=0;i<filters.length;i++)
      if(filters[i]!=cls) skipRows.push(filters[i]);

  var pattern=skipRows.join('|')

  return pattern;
}

function Filter(srcField){

   var node=srcField.parentNode;

   var index=srcField.parentNode.cellIndex;
    //all the DATA rows

   var dataRows= document.getElementsByClassName("row");

   //ensure that dataRows do not have any filter class added already
   var kids= dataRows.length;

   var filter ='hide_'+srcField.id;

   var pattern = ExcludeRows(filter);

   var skipRow = new RegExp(pattern,"gi");

   var searchReg =new RegExp('^'+srcField.value,'gi');

   var replaceCls= new RegExp(filter,'gi');

   for(i=0; i< kids ; i++){
       //skip if already filter applied  

       if(dataRows[i].className.match(skipRow)) continue;

       //now we know which column to search
       //remove current filter
       dataRows[i].className=dataRows[i].className.replace(replaceCls,'');

       if(!dataRows[i].cells[index].innerHTML.trim().match(searchReg))
          dataRows[i].className=dataRows[i].className +' '+ filter;

    }

} 
```

**HTML**

```
<table border="1" align="center">
<tr><td>Broj_pu</td><td>Naziv_pu</td><td>ID</td><td>Naselje</td><td>zupanija</td></tr>
<tr>
<td><input type="text" ID="broj_pu"    onkeydown="Filter(this)" /></td>
<td><input type="text" ID="naziv_pu"   onkeydown="Filter(this)" /></td>
<td><input type="text" ID="ID"         onkeydown="Filter(this)" /></td>  
<td><input type="text" ID="naselje"    onkeydown="Filter(this)" /></td>
<td><input type="text" ID="zupanija"   onkeydown="Filter(this)" /></td>   
</tr>

<tr class="row" ><td>10000</td><td>Zagreb</td><td>1</td><td>Sljeme</td><td>ZAGREBACKA</td></tr>
<tr class="row" ><td>10000</td><td>Zagreb</td><td>2</td><td>Zagreb-dio</td><td>ZAGREBACKA</td></tr>
</table> 
```

**CSS**

```
.hide_broj_pu,
.hide_naziv_pu,
.hide_ID,
.hide_naselje,
.hide_zupanija
{display:none} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2018-08-21T18:53:34.703

对于 Javascript 表搜索，请尝试：

```
<p>Search: <input type="text" id="searchTerm" onkeyup="doSearch()" /></p>

<table id="dataTable">

<script>
function doSearch() {
            var input, filter, found, table, tr, td, i, j;
            input = document.getElementById("searchTerm");
            filter = input.value.toUpperCase();
            table = document.getElementById("dataTable");
            tr = table.getElementsByTagName("tr");
            for (i = 0; i < tr.length; i++) {
                td = tr[i].getElementsByTagName("td");
                for (j = 0; j < td.length; j++) {
                    if (td[j].innerHTML.toUpperCase().indexOf(filter) > -1) {
                        found = true;
                    }
                }
                if (found) {
                    tr[i].style.display = "";
                    found = false;
                } else {
                    tr[i].style.display = "none";
                }
            }
        }
    </script> 
```

# php - MySQL：LIKE 和第一个字符

> ID：10092768
> 
> 赞同：6
> 
> 时间：2012-04-10T16:34:40.310
> 
> 标签：php, mysql, select, sql-like

我有两个 MySQL 问题。

```
$query = "  SELECT
                stationname
            FROM
                stations
            WHERE
                stationname >= '". mysql_real_escape_string($_GET['letter']) ."' 
            ORDER BY
                stationname

"; 
```

这是第一个查询。URL 中有一个`$_GET['letter']`包含字母字符的参数集。我正在尝试选择所有`stationname`以`$_GET['letter']`. 所以我在另一个 Stackoverflow 主题中找到了这个解决方案，但它似乎不起作用，我得到了所有行，而不仅仅是那一行。**编辑**：似乎它检查所有字符`stationname`，而不仅仅是起始字母，我怎么能得到它？

```
$query = "  SELECT
                stationname
            FROM
                stations
            WHERE
                stationname 
            LIKE
                    '". mysql_real_escape_string($_POST['search']) ."'
"; 
```

第二个也是最后一个问题。我想为我的网站制作一个搜索引擎，选择`stationname`包含的所有行`$_POST['search']`。但是，当我有 2 行时，例如，一个被称为，`cheese`另一行被称为`cheese2`，并且我搜索`cheese`，只`cheese`被选中，当我搜索时`cheese2`，只会`cheese2`被选中。有没有办法同时选择`cheese`和`cheese2`？

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2012-04-10T16:38:18.103

[`LIKE`](http://dev.mysql.com/doc/refman/5.0/en/string-comparison-functions.html#operator_like)支持通配符。 `%`表示任意数量的字符（包括零），并且`_`表示任意一个字符`

```
stationname LIKE 'cheese%' 
```

这将匹配`cheese`和`cheese2`。

您也可以将`%`用于第一个问题。

```
stationname LIKE 'a%' 
```

这将找到所有以 开头的单词`'a'`。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-04-10T16:51:23.343

> 我正在尝试选择所有 stationname 以 $_GET['letter'] 开头的行

MySQL 有一个[`LEFT`](http://dev.mysql.com/doc/refman/5.6/en/string-functions.html#function_left)似乎是您正在寻找的功能。所以基本上我们提取 the 的第一个字母`stationname`并将其与您的字母进行比较：

```
 where left(stationname, 1) = '" . mysql_real_escape_string($_GET['letter']) . "'"; 
```

> 有没有办法同时选择奶酪和奶酪2？

好吧，这里的解决方案有点臭，因为您应该检查是否`cheese`包含在`cheese2`以及是否`cheese2`包含在`cheese`. 试试这个：

```
where stationname like '%" . mysql_real_escape_string($_POST['search']) .
  "%' OR '" . mysql_real_escape_string($_POST['search']) .
  "' like concat('%', stationname, '%')"; 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-04-10T16:36:43.210

第二。

```
 $query = "   SELECT
                        stationname
                    FROM
                        stations
                    WHERE
                        stationname 
                    LIKE
                        '". mysql_real_escape_string($_POST['search']) ."%'
        "; 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-04-10T16:42:59.460

MySQL 中的文本通配符是 %，因此对于您的第一个查询，您可能需要：

```
$query = "    SELECT
                    stationname
                FROM
                    stations
                WHERE
                    stationname LIKE '". mysql_real_escape_string($_GET['letter']) ."%' 
                ORDER BY
                    stationname
    "; 
```

对于您的第二个查询：

```
$query = "   SELECT
                    stationname
                FROM
                    stations
                WHERE
                    stationname 
                LIKE
                    '%". mysql_real_escape_string($_POST['search']) ."%'
    "; 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2014-07-23T11:13:13.317

电话号码

5 发现第一个字符

```
$Sql="SELECT * FROM customers WHERE TEL REGEXP '^[5]' LIMIT 0,500"; 
```

# haskell - Haskell：使用递归进行数值积分

> ID：10092770
> 
> 赞同：1
> 
> 时间：2012-04-10T16:34:43.820
> 
> 标签：haskell, recursion, numerical-methods

我现在正在尝试 Haskell，并努力在递归方面重写循环。

我正在尝试编写一个基本的积分器，它采用一些函数 f(x) 并通过中点方法在 [a, b] 范围内对其进行积分。积分函数采用三个参数 N、a 和 b，其中 N 是用于近似积分的矩形数。

[Wolfram Alpha 链接](http://www.wolframalpha.com/input/?i=Sum+f(a+%2B+(i%2B1/2)delta+x)+%2a+delta+x+from+i+%3D+0+to+i+%3D+N-1)

当我尝试用 GHCI 编译它时，我收到很多抽象的错误消息，我真的不知道从哪里开始。很多“超出范围”和几个“Main.a [或 b] 的多重声明”。

谢谢

```
MPInt 1 a b = DELTA 1 -- Base case
MPInt N a b = (MPInt (N-1) a b) + DELTA
     where 
     dX = (b - a) / N
     DELTA = dX * f (a + dX * (N+0.5))

f :: (Num a) => a -> a
f x = x^2 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-04-10T16:44:11.770

*   你已经命名了你的函数`MPInt`。只有模块、类、类型和构造函数的名称可以以大写字母开头；值（包括函数）必须以小写字母（或下划线或某些标点符号）开头。同样的问题也适用于`N`和`DELTA`。

*   您`DELTA`在第一种情况的定义中使用`MPInt`，但它被定义为第二种情况的一部分。`where`子句仅适用于紧接在它之前的表达式（在本例中为定义`MPInt N a b = ...`）。（此外，第一次使用`DELTA`将其视为函数，但第二次使用及其定义将其视为数值）。

# php - MVC 基础知识：将工作传递给视图？

> ID：10092771
> 
> 赞同：1
> 
> 时间：2012-04-10T16:34:48.533
> 
> 标签：php, arrays, model-view-controller, codeigniter, doctrine

我正在使用 Doctrine2 和 CodeIgniter2，并且对两者以及 OOP/MVC 都很陌生，所以请使用简单的解释 :)

出于测试目的，我有一个控制器、模型和视图。我想显示包含用户信息的表中的数据。名字、姓氏、身份证号码等。

我的控制器调用模型——它从理论实体中检索数据，然后控制器将该数据传递给视图。

（控制器）

```
class Test_v_to_m extends CI_Controller {

    public function index() {

        $this->load->model('testing/test_v_to_m_model');
        $data = $this->test_v_to_m_model->display_user_info();

        $this->load->view('testing/test_v_to_m_view', $data );
    }
} 
```

（模型）

```
class Test_v_to_m_model extends CI_Model{

public function display_user_name() {

    $query = $this->doctrine->em->createQuery("select u from ORM\Dynasties2\Users u");
    return $query->getResult(); 
```

（看法）

```
//print_r($data); 
```

第一个问题是：如何以有用的方式将对象或数组传递给视图？如果我只处理一个变量，这很有效：

（控制器）

```
$user = $this->doctrine->em->find('Entities\User', $user_id);
$data['firstname'] = $user->getFirstName();
$this->load->view('testing/test_v_to_c_view_2',$data); 
```

（看法）

```
echo $firstname; 
```

但是当它是一个数组或多维数组时，我不知道如何做类似的事情。

第二个问题是是否让视图做任何实际工作（php 逻辑、循环、foreach 等），还是在控制器中完成所有这些工作，让视图只进行格式化和显示。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-10T16:48:17.747

是的，您可以将多维数组传递给视图，然后根据需要访问它。例如

```
$template_date['result_arr'] = array(
array('firstname' => 'abc', 'lastname' => 'xyz')
, array('firstname' => 'abc', 'lastname' => 'xyz')
); 
```

在您的视图文件中 -

```
foreach($result_arr as $key => $row) {
echo $row['firstname'].' <br />';
} 
```

关于您的第二个问题-根据我的理解-在视图中使用一些 foreach、for 循环很好，但最好将业务逻辑保留在控制器和模型中。希望它对你有意义。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-10T16:48:22.300

至于你的第一个问题，我不知道我脑海中的答案（对不起！）。但是，我想一个数组可以作为数据的一部分（作为单个项目）传递，但是您需要在视图中迭代它（见下文）。不过只是猜测...

至于你的第二个问题，MVC 的原则是视图中只有显示逻辑 - 所以所有“实际工作”都应该在控制器中完成。

现在，如果你想有一个循环来显示表格中的数据，那是在视图中完成的“真正的工作”，但因为它是格式化和显示的一部分，这是可以接受的。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-10T16:54:41.313

关于你的第一个问题，其实很简单：

```
$data = array(
    'firstname' => 'string',
    'array' => array(1, 2, 3),
    'multidimensional_array' => array('ocean' => 'deep')
); 
```

在视图中，您可以通过以下方式访问它们：

```
$firstname;
$array;
$multidimensional_array; 
```

它们只是导出到视图中，因此您可以将 $data 数组中的每个键视为变量，并将 $data 数组中的值视为变量的值。

关于第二个问题，通常最好让视图只进行格式化和显示。在某些情况下，使用 ifs 或循环可能很有用，例如，如果您想根据某个变量显示不同的消息，或者如果您想用一堆行填充表格。但是，我强烈建议您尽可能多地避开逻辑。该视图旨在接收它需要的所有数据并以适合它的方式显示它。

这有很多原因，即可维护性（如果您的逻辑发生更改，则无需更新视图），可重用性（如果您使视图尽可能通用，则可以非常轻松地重用它们）甚至能够创建新视图或用不同的视图替换该视图，而无需担心逻辑。

我希望这有帮助。:)

# maven - 从 Maven 2.2.1 升级到 Maven 3.0.4 时出现 DependencyResolutionException

> ID：10092772
> 
> 赞同：2
> 
> 时间：2012-04-10T16:34:49.823
> 
> 标签：maven, maven-2, maven-3, dependency-resolution

我正在尝试将我的项目从 Maven 2.2.1 升级到 Maven 3.0.4，但是遇到了依赖解析的问题。我花了一整天的时间试图通过查看 Maven 文档和类似的帖子来研究这个问题，但我仍然卡住了。这是我关于 stackoverflow 的第一个问题，所以希望我已经很好地遵循了这里的礼仪。谢谢你的帮助！

我的项目结构如下：

```
pom.xml (acme-parent)
child-alpha
+-----> pom.xml 
```

此外，我自己的存储库中有以下文件：

```
http://maven.my-own-repo.com/acme/child-dep-jdk15/maven-metadata-local.xml
http://maven.my-own-repo.com/acme/child-dep-jdk15/1.0/child-dep-jdk15-1.0.jar
http://maven.my-own-repo.com/acme/child-dep-jdk15/1.0/child-dep-jdk15-1.0.pom 
```

child-alpha/pom.xml 又对我自己的 acme:child-dep-jdk15 有一个配置文件依赖，它已单独构建到一个 jar 文件中，并且有自己的 .pom 文件指定一个父级是相同的 acme-parent父母作为孩子阿尔法。

以下是相关文件的摘录：

极致父 pom.xml：

```
<?xml version="1.0" encoding="UTF-8"?>
<project>
    <modelVersion>4.0.0</modelVersion>
    <groupId>acme</groupId>
    <artifactId>acme-parent</artifactId>
    <name>Acme Parent Project</name>
    <version>1</version>
    <packaging>pom</packaging>

    <properties>...</properties>

    <modules>
        <module>child-alpha</module>
    </modules>

    <repositories>
        <repository>
            <id>acme-repo</id>
            <url>http://maven.my-own-repo.com</url>
        </repository>
        <repository>
            <id>central</id>
            <url>http://repo1.maven.org/maven2</url>
        </repository>
    </repositories>

    <pluginRepositories>...</pluginRepositories>

    <build>
      <plugins>...</plugins>
    </build>

    <dependencies>...</dependencies>
</project> 
```

子阿尔法 pom.xml：

```
<project>
    <modelVersion>4.0.0</modelVersion>
    <parent>
        <groupId>acme</groupId>
        <artifactId>acme-parent</artifactId>
        <version>1</version>
    </parent>
    <artifactId>child-alpha</artifactId>
    <name>Child Alpha Project</name>
    <version>1.0</version>
    <packaging>jar</packaging>

    <scm>...</scm>

    <properties>...</properties>

    <build>
      <resources>...</resources>
      <plugins>...</plugins>
    </build>

    <profiles>
        <profile>
            <id>jdk15</id>
            <activation>
                <activeByDefault>true</activeByDefault>
                <jdk>1.5</jdk>
            </activation>
            <dependencies>
                <dependency>
                    <groupId>acme</groupId>
                    <artifactId>child-dep-jdk15</artifactId>
                    <version>1.0</version>
                </dependency>
            </dependencies>
        </profile>
    </profiles>

    <dependencies>...</dependencies>
</project> 
```

儿童-dep-jdk15-1.0.pom：

```
<project>
    <modelVersion>4.0.0</modelVersion>
    <parent>
        <groupId>acme</groupId>
        <artifactId>acme-parent</artifactId>
        <version>1</version>
    </parent>
    <groupId>acme</groupId>
    <artifactId>child-dep-jdk15</artifactId>
    <name>Acme Child Dependency</name>
    <version>1.0</version>
    <packaging>jar</packaging>

    <build>...</build>

    <dependencies>...</dependencies>
</project> 
```

当我尝试构建 child-alpha 时（在 child-alpha 目录中），我运行了以下命令：

```
mvn -U -e clean install 
```

我得到了以下日志消息和堆栈跟踪（删除了无关消息）：

```
Downloading: http://maven2.my-own-repo.com/acme/acme-parent/1/acme-parent-1.pom
Downloading: http://repo1.maven.org/maven2/acme/acme-parent/1/acme-parent-1.pom

[...]

[ERROR] Failed to execute goal on project child-alpha: Could not resolve dependencies for project acme:child-alpha:jar:1.0: [...]

Caused by: org.apache.maven.project.DependencyResolutionException: Could not resolve dependencies for project acme:child-alpha:jar:1.0: [...]

Caused by: org.sonatype.aether.collection.DependencyCollectionException: Failed to collect dependencies for [...]
    at org.sonatype.aether.impl.internal.DefaultDependencyCollector.collectDependencies(DefaultDependencyCollector.java:258)
    at org.sonatype.aether.impl.internal.DefaultRepositorySystem.collectDependencies(DefaultRepositorySystem.java:308)
    at org.apache.maven.project.DefaultProjectDependenciesResolver.resolve(DefaultProjectDependenciesResolver.java:150)
    ... 23 more
Caused by: org.sonatype.aether.resolution.ArtifactDescriptorException: Failed to read artifact descriptor for acme:child-dep-jdk15:jar:1.0
    at org.apache.maven.repository.internal.DefaultArtifactDescriptorReader.loadPom(DefaultArtifactDescriptorReader.java:331)
    at org.apache.maven.repository.internal.DefaultArtifactDescriptorReader.readArtifactDescriptor(DefaultArtifactDescriptorReader.java:186)
    at org.sonatype.aether.impl.internal.DefaultDependencyCollector.process(DefaultDependencyCollector.java:412)
    at org.sonatype.aether.impl.internal.DefaultDependencyCollector.collectDependencies(DefaultDependencyCollector.java:240)
    ... 25 more
Caused by: org.apache.maven.model.resolution.UnresolvableModelException: Could not find artifact acme:acme-parent:pom:1 in acme-repo (http://maven.my-own-repo.com)
    at org.apache.maven.repository.internal.DefaultModelResolver.resolveModel(DefaultModelResolver.java:126)
    at org.apache.maven.model.building.DefaultModelBuilder.readParentExternally(DefaultModelBuilder.java:813)
    at org.apache.maven.model.building.DefaultModelBuilder.readParent(DefaultModelBuilder.java:664)
    at org.apache.maven.model.building.DefaultModelBuilder.build(DefaultModelBuilder.java:310)
    at org.apache.maven.model.building.DefaultModelBuilder.build(DefaultModelBuilder.java:232)
    at org.apache.maven.repository.internal.DefaultArtifactDescriptorReader.loadPom(DefaultArtifactDescriptorReader.java:322)
    ... 28 more
Caused by: org.sonatype.aether.resolution.ArtifactResolutionException: Could not find artifact acme:acme-parent:pom:1 in acme-repo (http://maven.my-own-repo.com)
    at org.sonatype.aether.impl.internal.DefaultArtifactResolver.resolve(DefaultArtifactResolver.java:538)
    at org.sonatype.aether.impl.internal.DefaultArtifactResolver.resolveArtifacts(DefaultArtifactResolver.java:216)
    at org.sonatype.aether.impl.internal.DefaultArtifactResolver.resolveArtifact(DefaultArtifactResolver.java:193)
    at org.apache.maven.repository.internal.DefaultModelResolver.resolveModel(DefaultModelResolver.java:122)
    ... 33 more
Caused by: org.sonatype.aether.transfer.ArtifactNotFoundException: Could not find artifact acme:acme-parent:pom:1 in acme-repo (http://maven.my-own-repo.com)
    at org.sonatype.aether.connector.wagon.WagonRepositoryConnector$4.wrap(WagonRepositoryConnector.java:947)
    at org.sonatype.aether.connector.wagon.WagonRepositoryConnector$4.wrap(WagonRepositoryConnector.java:941)
    at org.sonatype.aether.connector.wagon.WagonRepositoryConnector$GetTask.run(WagonRepositoryConnector.java:669)
    at org.sonatype.aether.util.concurrency.RunnableErrorForwarder$1.run(RunnableErrorForwarder.java:60)
    at java.util.concurrent.ThreadPoolExecutor$Worker.runTask(ThreadPoolExecutor.java:886)
    at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:908)
    at java.lang.Thread.run(Thread.java:680) 
```

在使用 Maven 2 时，我从不需要位于以下位置的 acme-parent pom.xml：http: [//maven2.my-own-repo.com/acme/acme-parent/1/acme-parent-1。绒球](http://maven2.my-own-repo.com/acme/acme-parent/1/acme-parent-1.pom)

我们在自己的仓库中没有父 pom.xml 的原因是我们在创建版本控制分支时使用了一个脚本，该脚本会根据我们所在的分支更改 acme-parent pom.xml 中的某些值，所以将 pom.xml 放在 repo 中并为我们尝试与我们的持续集成服务器同时构建的所有不同分支正确更新它会很复杂。

在 Maven 2 中，当构建 child-alpha 时，Maven 可以轻松找到 acme-parent pom.xml 一个目录，即相对路径为 ../pom.xml，因此它永远不会尝试访问我的存储库找到它。仅在我的本地结帐中拥有父 pom.xml 而在 repo 中没有它在 Maven 2 中运行良好。

但是，当我尝试在 Maven 3.0.4 下构建 child-alpha 时，出现了上述异常。起初，我以为我需要在 child-alpha 的 pom.xml 顶部的标签中显式设置 relativePath，但这并没有解决它——而且 acme-parent 的 pom.xml 确实已经在默认的 relativePath 中../pom.xml，因此无需显式设置。

然后，我尝试在 child-alpha 的 pom.xml 部分中注释掉 child-dep-jdk15 依赖项。child-alpha maven 构建成功完成，此依赖项已注释掉。

我不明白当 child-dep-jdk15 依赖项到位时，为什么 child-alpha 不会在 Maven 3 中构建。如果 Maven 最初能够正确找到 acme-parent pom.xml（根据顶部的块），为什么现在在处理 child-dep-jdk15 依赖项时尝试从 repos 下载它？我是否配置错误，如果是，我应该如何修复它？

另一件事：如果我首先`mvn -N install`在与 acme-parent 的 pom.xml 相同的目录中运行，然后尝试构建 child-alpha，那么 child-alpha 构建成功，即使在代码中保留依赖项 child-dep-jdk15 也是如此。运行该命令后，我可以验证 acme-parent-1.pom 是否在我的本地 .m2 目录中。虽然这种解决方法对于个人开发人员来说可能没问题，但对于我们的持续集成服务器来说却是一个问题，它需要能够为不同的分支运行并发构建。

由于我上面提到的版本控制分支更改，我强烈希望不必重新配置我的存储库来托管 acme-parent pom.xml。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2015-05-07T20:53:05.463

在 Maven 3 中，如果您刚刚下载失败并已修复它（例如，通过将 jar 上传到存储库），它将缓存失败。要强制刷新添加`-U`到命令行。

有关其他可能的原因，`DependencyResolutionException`请参阅[Maven Confluence](https://cwiki.apache.org/confluence/display/MAVEN/DependencyResolutionException)。

# javascript - YUI - 删除选择选项

> ID：10092777
> 
> 赞同：2
> 
> 时间：2012-04-10T16:35:06.027
> 
> 标签：javascript, yui

我有一个 HTML 选择元素，其中包含一些国家/地区作为选项。

```
<select id="countryLocation" class="selectCountryPrefix enablePartialForm" onchange="document.locationchangeform.submit()" name="country">
    <option selected="selected" disabled="disabled" value="">Select country</option>
    <option class="showTos-AU" title="+61" value="AU">Australia</option>
    <option class="showTos-CA" title="+1" value="CA">Canada</option>
    <option class="showTos-CL" title="+56" value="CL">Chile</option>
    <option class="showTos-DK" title="+45" value="DK">Denmark</option>
    <option class="showTos-EE" title="+372" value="EE">Estonia</option>
    <option class="showTos-FI" title="+358" value="FI">Finland</option>
    <option class="showTos-GR" title="+30" value="GR">Greece</option>
    <option class="showTos-HU" title="+36" value="HU">Hungary</option>
    <option class="showTos-IE" title="+353" value="IE">Ireland</option>
    <option class="default showTos-LV" selected="selected" title="+371" value="LV">Latvia</option>
    <option class="showTos-TW" title="+886" value="TW">Taiwan</option>
</select> 
```

我想删除所有国家代码不等于“TW”的选项。到目前为止，这是我的代码：

```
YAHOO.util.Event.addListener(window, "load", function() {

    var E = YAHOO.util.Event;
    var D = YAHOO.util.Dom;

    var opts,
        select,
        i;

    select = D.get('countryLocation');
    opts = select.options;
    for (i=0; i< opts.length-1; i++){
        if (opts[i].value !== ""){
            if (opts[i].value !== "TW"){
                select.remove(i);
            }
        } 
    }

}) 
```

它仅适用于某些选项-我猜是因为它是按索引删除它们，所以在删除每个选项后索引都会发生变化。我真正想要的是 jQuery .each() 函数。

我怎样才能在 YUI 或纯 JS 中做到这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-10T16:57:34.623

另一种方法（关于 Brant Olsen 的回答）是向后迭代：

```
for (i=opts.length-1; i >= 0; i--){
    if (opts[i].value !== ""){
        if (opts[i].value !== "TW"){
            select.remove(i);
        }
    } 
} 
```

从数组中删除对象时（在迭代中），我通常采用这种方法。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-10T16:42:30.333

删除选项后，您希望减少您的`i`价值。否则，您将跳过删除后的每个选项。

```
for (i=0; i< opts.length-1; i++){
    if (opts[i].value !== ""){
        if (opts[i].value !== "TW"){
            select.remove(i);
            --i;
        }
    } 
} 
```

# sql-server-2008 - 从经典asp连接到sql server

> ID：10092779
> 
> 赞同：0
> 
> 时间：2012-04-10T16:35:20.573
> 
> 标签：sql-server-2008, asp-classic

我有一个在 Windows 身份验证模式下运行的 sql server 2008R2 express。我基于 Windows 帐户在 sql server 中为数据库创建了登录名和用户。我可以通过（以用户身份运行）SSMS 连接到 sql server 数据库并浏览我的数据库就好了。

现在我正在尝试通过第 3 方 asp 应用程序进行连接

```
set loginDB = Server.CreateObject("ADODB.Connection")

'For Windows Server 2008 / SQL 2008 users, please use the following line for the DB connection

loginDB.Open "Provider=SQLNCLI10; Server=(local)\SQLServerName; Database=dbname;Uid="myuser" Pwd="pwd"" 
```

我收到一条错误消息，提示用户 myuser 登录失败

此外，该站点正在一个应用程序池上运行，我已将其设置为以 Windows 用户 myuser 身份运行。

我哪里错了？？？

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-10T16:49:49.013

如果您传递的是 SQL Server 身份验证而不是 windows 的用户名和密码，那么如果它的身份验证模式仅是 Windows，它将没有它。

将它们取出并替换为集成安全 = SSPI

# windows-phone-7 - WP7 - 关于提交政策 - 机密用户详细信息

> ID：10092788
> 
> 赞同：0
> 
> 时间：2012-04-10T16:36:00.743
> 
> 标签：windows-phone-7, login, registration, marketplace, certify

我希望发布一个应用程序，让用户能够使用我的托管数据库进行注册和登录。用户将提供他们的姓名、电子邮件和密码。

我想知道我需要做什么才能让应用程序获得市场认证 - 在应用程序可认证之前，我必须确保用户同意哪些免责声明/通知？[我假设如果我不处理这个，它将被政策2.8](http://msdn.microsoft.com/en-us/library/hh184841%28v=vs.92%29.aspx)拾取。

您还有更多关于将应用发布到市场的技巧吗？第一次使用，真的很想在下个月启动并运行我的应用程序！

谢谢，

杰拉德。

# jquery-mobile - jQuery Mobile 检测主屏幕书签

> ID：10092789
> 
> 赞同：3
> 
> 时间：2012-04-10T16:36:03.913
> 
> 标签：jquery-mobile

我知道无法在移动网络应用程序中自动添加主屏幕书签，但是，是否有办法检测是否已创建？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-01T16:02:33.423

您可以提示用户为您的应用添加书签，然后保存他们的回复（[参见此处的 Mobile Boilerplate](https://github.com/h5bp/mobile-boilerplate/blob/master/doc/misc.md)）。这将允许您“检测”他们是否已经添加了它。

> 移动书签气泡是一个 JavaScript 库，可在您的移动 Web 应用程序底部添加一个促销气泡，邀请用户将应用程序添加到他们设备的主屏幕上。该库使用 HTML5 本地存储来跟踪促销是否已经显示，以避免不断唠叨用户。

# php - 在 PHP 文档中使用 SQL 查询数据库中的两个表时遇到困难

> ID：10092791
> 
> 赞同：0
> 
> 时间：2012-04-10T16:36:11.133
> 
> 标签：php, mysql, sql, pear

我真的很难让我的代码工作，我不知道为什么。

我的 PHPMyAdmin 中有一个数据库，它包含 2 个表：

1.  **网球场**
    *球场* *ID* *球场名称预订费用* 

2.  ***网球场_* 可用球场ID **court_dateBooked****

 **我正在使用 PEAR 存储库编写一个 PHP 程序，并且我正在努力创建允许我执行以下操作的代码：

仅当法院名称尚未被其他用户预订时，才根据用户搜索日期显示所有法院名称及其相应的预订费。

这是我当前的代码：-

```
 $CHOSEN_BOOKING_DATE =  $_GET['user_dateField']; //GET's input data from user form in my other html document.

    $database->setFetchMode(MDB2_FETCHMODE_ASSOC);

    $myQuery = "SELECT * FROM tennisCourts, tenniscourts_Availability WHERE court_dateBooked != $CHOSEN_BOOKING_DATE";

$queryResult =& $db->query($myQuery);

    if (PEAR::isError($queryResult)) {
        die($queryResult->getMessage());
    }

    echo '<table>';
    while ($Col =& $queryResult->fetchRow()) {  
        echo '<td>'.$queryResult['courtName'].'</td>';
        echo '<td>'.$queryResult['bookingFee'].'</td>'; 
        echo '<td>'.$queryResult['court_dateBooked'].'</td>';
    }

?> 
```

上面的代码显示了我数据库中所有 court_dateBooked 字段的所有 courtNames 和 BookingFee。只有当它没有被预订时，我才能让它显示 CourtNames 和 bookingFee。如果已预订，则应返回“抱歉在此日期未找到法院”。

我还是 PHP 和 SQL 的新手，所以如果我没有说清楚，请原谅我。我一直在网上研究，各种消息来源说要使用 SQL UNION OR JOIN？有人可以告诉我如何在我的场景中使用它们吗？我真的很感激任何帮助。感谢您查看我的问题。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-10T16:39:51.587

尝试这个：

```
$myQuery = "
    SELECT c.courtName
         , c.bookingFee
         , a.court_dateBooked
      FROM tennisCourts AS c
 LEFT JOIN tenniscourts_Availability AS a ON c.id = a.courtID
     WHERE a.court_dateBooked != '" . $CHOSEN_BOOKING_DATE ."'"; 
```

确保`$CHOSEN_BOOKING_DATE`在执行查询之前正确清理和转义。由于看起来您正在使用 PDO，因此您应该为此使用准备好的语句。**

# jquery - 访问 bootstrap-wysihtml5 编辑器对象

> ID：10092792
> 
> 赞同：4
> 
> 时间：2012-04-10T16:36:16.707
> 
> 标签：jquery, wysiwyg

我正在尝试访问 bootstrap-wysihtml5 编辑器对象。我这样做是这样的：

```
$(document).ready(function () {
     $('.someLink').live('click', function () {
          var wysihtml5Editor = $('#textarea').wysihtml5().editor;
          console.log('wysihtml5Editor: '+wysihtml5Editor);
          wysihtml5Editor.composer.commands.exec("bold");
     });
}); 
```

Chrome 控制台返回：

```
> wysihtml5Editor: undefined
> Uncaught TypeError: Cannot read property 'composer' of undefined 
```

所以，重点是。

访问 wysihtml5 对象的方法是什么？

一切的重点是在我的 textarea 中插入一些 html 代码。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-04-10T20:45:47.243

试试这个：

```
$(document).ready(function () {
   $('.someLink').live('click', function () {
     $('#textarea').wysihtml5();
     var wysihtml5Editor = $("#textarea").data("wysihtml5").editor;
     console.log('wysihtml5Editor: '+wysihtml5Editor);
     // The following is important since wysihtml5 is initialized asynchronously
     wysihtml5Editor.observe("load", function() {
       wysihtml5Editor.composer.commands.exec("bold");
     });
   });
}); 
```

# jquery - jQuery UI 滑动简化同级推送

> ID：10092794
> 
> 赞同：2
> 
> 时间：2012-04-10T16:36:39.743
> 
> 标签：jquery, jquery-ui, slide

我正在使用 jQuery UI 的`slide`切换效果来切换 div：

```
$("#link").click(function(){
    $("#targetDiv").toggle("slide", {direction: "up"}, 1000);
}); 
```

幻灯片是唯一具有我想要的动画的效果，本质上是从顶部向下的 div。我不想要`toggleSlide`，因为那样只会改变元素的高度。

唯一的问题`slide`是它立即将兄弟姐妹推到末端位置：http: [//jsfiddle.net/XYDyy/2/](http://jsfiddle.net/XYDyy/2/)

那么有没有办法让兄弟元素在动画 div 调整时调整它们的位置？

任何意见，将不胜感激。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-10T18:19:44.067

您可以通过在jQuery 在元素周围添加的`slideUp()`/`slideDown()`上执行 / 来欺骗它：`.ui-effects-wrapper`

```
$("#link").click(function() {
    if ($("#div1").is(':visible')) {
        $("#div1").toggle("slide", {direction: "up"}, 1000);
        $("#div1").parent(".ui-effects-wrapper").slideUp(1000);
    } else {
        $("#div1").toggle("slide", {direction: "up"}, 1000);
        $("#div1").parent(".ui-effects-wrapper").hide().slideDown(1000);
    }
}); 
```

演示：http: [//jsfiddle.net/jtbowden/LARkS/](http://jsfiddle.net/jtbowden/LARkS/)

否则，您可以添加自己的包装器，并`slideUp`对其进行操作，并将位置`#div1`设置为`bottom: 0px`.

演示：http: [//jsfiddle.net/jtbowden/RDWt8/](http://jsfiddle.net/jtbowden/RDWt8/)

# php - 使用 PHP 转换 SQL 时间？

> ID：10092797
> 
> 赞同：0
> 
> 时间：2012-04-10T16:36:44.627
> 
> 标签：php, javascript, sql

我想使用 PHP 和 Javascript 转换 MySQL Time 数据类型。我知道可以使用 MySql 的 FORMAT_TIME 来完成，但我想对 php 做同样的事情。时间格式默认为 hh:mm:ss，我想将其转换为 hh:mm。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-10T16:38:42.143

只需将日期输入以下函数：

```
<?php echo date("h:i", strtotime($date)); ?> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-10T16:39:49.307

```
//any date is ok, we care only about the hours and minutes
// $your_date is what comes from db in format hh:mm:ss
$date = new DateTime('2000-01-01 '.$your_date);
echo $date->format('H:i'); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-10T16:38:55.737

我认为您可以创建一个 DateTime 对象，然后使用 format("h:i") 来获得所需的输出

# c# - 在 c# asp.net 中执行 javascript 后抓取网页

> ID：10092804
> 
> 赞同：1
> 
> 时间：2012-04-10T16:37:20.743
> 
> 标签：c#, javascript, asp.net, .net, html

我需要为所有链接抓取一个网页，以便稍后访问它们以查找并记录设置 cookie 的位置。这是针对要求用户使用设置的 cookie 形成的新英国立法，我决定尝试自动化其中的一些过程以节省一些时间。

我的问题是我的公司网站使用大量 javascript 来呈现页面和内容，这意味着当我检索页面时（此时使用 html 敏捷包），它们主要包含大量 javascript 并且缺少很多完全呈现时显示的链接。我将它作为一个域上的 asp 应用程序托管，并传入 url 以抓取和访问网站页面上的所有链接。

有没有办法我可以执行 javascript 以便呈现页面并且我可以获得所有链接？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-10T17:14:20.220

您可以使用 Web 浏览器控件制作 Windows 窗体。您可以设置 URL 并在页面加载时设置回调事件。它将呈现页面，包括 javascript，然后您可以访问 DOM（我认为是通过 WebBrowser.Document）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-10T17:02:56.893

我不明白你的问题。当它是您的公司网站时，您不需要抓取页面。你已经有了代码。只需查看您的代码库，看看是否创建了 cookie 以及其中存储了什么。

# java - 模拟 bean 的依赖项的 NoSuchBeanDefinitionException

> ID：10092808
> 
> 赞同：3
> 
> 时间：2012-04-10T16:37:47.120
> 
> 标签：java, spring, mocking, integration-testing, mockito

我试图在我的集成测试中使用模拟并且运气不佳。我使用的是Spring 3.1.1和Mockito 1.9.0，情况如下：

```
@Component
public class ClassToTest {

    @Resource
    private Dependency dependency;

} 
```

和

```
@Component
public class Dependency {

    @Resource
    private NestedDependency nestedDependency;

} 
```

现在，我想使用 Spring 的 JavaConfig 对 ClassToTest 进行集成测试。这是我尝试过的，但它不起作用：

```
@Test
@ContextConfiguration
public class ClassToTestIntegrationTest {

    @Resource
    private ClassToTest classToTest;

    @Resource
    private Dependency mockDependency;

    @Test
    public void someTest() {
        verify(mockDependency).doStuff();

        // other Mockito magic...

    }

    @Configuration
    static class Config {

        @Bean
        public ClassToTest classToTest() {
            return new ClassToTest();
        }

        @Bean
        public Dependency dependency() {
            return Mockito.mock(Dependency.class);
        }

    }
} 
```

我已经简化了我的设置，使问题更容易理解。实际上，我有更多依赖项，只想模拟其中的一些依赖项——其他依赖项是真实的，基于从我的产品 @Configuration 类导入的配置。

最终发生的事情是我得到一个 NoSuchBeanDefinitionException ，说应用程序上下文中没有 NestedDependency 类型的 bean。我不明白这一点 - 我认为 Spring 会收到 Mockito 的 Dependency 模拟实例，甚至不考虑自动装配它。由于这不起作用，我最终不得不模拟我的整个对象图——这完全违背了模拟的意义！

提前感谢您的帮助！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-08T10:18:49.667

我有同样的问题，我找到了另一个解决方案。当 Spring 实例化所有 bean 时，它会检查它是否是 Mockito Mock，在这种情况下，我为注入属性返回 false。要使用它，只需在 Spring 上下文中注入它

下面的代码：

```
public class MockBeanFactory extends InstantiationAwareBeanPostProcessorAdapter {

    private static final MockUtil mockUtil = new MockUtil();

    public MockBeanFactory() {
        super();
    }

    @Override
    public boolean postProcessAfterInstantiation(Object bean, String beanName) throws BeansException {
        return !mockUtil.isMock(bean);
    }

} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-10T20:23:57.640

Mockito 在模拟类时所做的是它使用[cglib](/questions/tagged/cglib "显示标记为“cglib”的问题")创建一个子类，该子类具有一些花哨的名称，例如：`Dependency$EnhancerByMockito`(IIRC)。您可能知道，子类从其父类继承字段：

```
@Component
public class Dependency {

    @Resource
    private NestedDependency nestedDependency;

}

public class Dependency$EnhancerByMockito extends Dependency{
    //...
} 
```

这意味着 Spring 在使用 mock 时仍然可以看到基类中的字段。你可以做什么：

1.  使用接口，这将导致 Mockito 使用动态代理而不是 CGLIB 生成的类

2.  模拟`NestedDependency`- 我知道它只会将问题进一步级联

3.  为测试禁用`@Resource`注释扫描

# c# - 为什么在使用带有列表的 string.Join 时使用 ToArray() ?

> ID：10092815
> 
> 赞同：8
> 
> 时间：2012-04-10T16:38:07.450
> 
> 标签：c#

我正在尝试结合`List<string> strings`使用`string.Join(",", strings)`，但我正在阅读的所有内容都说我应该做：

`string.Join(",", strings.ToArray())`

我必须/应该使用某些原因`.ToArray()`吗？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-04-10T16:40:29.620

`string.Join`从 .NET 4开始才开始接受`IEnumerable<string>`（实际上是通用重载）。大概您正在查看使用 .NET 3.5 或更早版本编写的代码（或指令）。比较重载：

*   [`string.Join`在 .NET 3.5 中](http://msdn.microsoft.com/en-us/library/0h8wc12c%28v=vs.90%29.aspx)
*   [`string.Join`在 .NET 4 中](http://msdn.microsoft.com/en-us/library/0h8wc12c%28v=vs.100%29.aspx)

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-04-10T16:40:25.697

可能是因为您正在阅读的所有内容都是为该框架的早期版本编写的。该`string.Join(string, IEnumerable<string>)`方法是在版本 4 中添加的。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-10T16:40:41.370

> 我必须/应该使用 .ToArray() 是否有某种原因？

你不必；相反，您可能正在查看在不需要您调用的当前重载之前存在的旧代码`ToArray`。接受的新重载`IEnumerable<string>`直到 .NET 4.0 才出现。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-10T16:49:28.307

您不必在 .Net v4 及更高版本中使用 .ToArray()。在 v4 中，IEnumerable 发挥了重要作用，并添加了许多扩展。

因此，如果需要使用 v3.5 或更低版本进行编译，则需要使用 .ToArray()，但对于 4.0 及更高版本，您的代码是正确的。

# caching - infinispan 如何知道它必须从 delta 感知对象中获取更改

> ID：10092822
> 
> 赞同：0
> 
> 时间：2012-04-10T16:38:36.420
> 
> 标签：caching, replication, infinispan

我们正在使用 infinispan，在我们的系统中，我们有一个大对象，我们必须在其中推送每个事务的小更改。我已经为这个对象和 Delta 实现了 DeltaAware 接口。我面临的问题是更改没有传播到其他节点，只有初始对象状态被传播到其他节点。此外，不会在实现 DeltaAware 的大对象上调用 delta 和 commit 方法。除了简单地将它放在缓存中之外，我是否需要在其他地方注册这个对象？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-11T13:23:31.643

如果您简单地使用[AtomicHashMap](http://docs.jboss.org/infinispan/5.1/apidocs/org/infinispan/atomic/AtomicHashMap.html)可能会更好，它是 Infinispan 中的一个构造。这允许您将一系列键/值对分组为单个值。Infinispan 可以检测到这个 AtomicHashMap 的变化，因为它实现了 DeltaAware 接口。AHM 是比 DeltaAware 更高级别的构造，并且可能更适合您。

举一个使用 AtomicHashMap 的例子，它们被 JBoss AS7 HTTP 会话复制大量使用，其中每个会话 id 都映射到一个 AtomicHashMap。这意味着我们可以检测到单个会话数据何时发生变化，并且只复制它。

干杯，高尔德

# php - Magento 中的购物车页面标题更改

> ID：10092831
> 
> 赞同：0
> 
> 时间：2012-04-10T16:39:23.287
> 
> 标签：php, magento, magento-1.5

我需要更改购物车页面标题。但我找不到它。我应该在哪里改变它。所以任何帮助表示赞赏。

![在此处输入图像描述](../Images/554cd8319d174f2e8198e00ff47c1bdb.png)

谢谢

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-13T13:47:50.873

更改 XML 将无效，因为标题由控制器在 app/code/core/Mage/Checkout/controllers/CartController.php 设置。

```
$this
->loadLayout()
->_initLayoutMessages('checkout/session')
->_initLayoutMessages('catalog/session')
->getLayout()->getBlock('head')->setTitle($this->__('Shopping Cart')); 
```

修改核心文件从来都不是一个好主意，重写控制器可能很乏味。因此，更改此设置的正确和最快的位置是在位于 app/locale/YOUR_LANGUAGE/Mage_Checkout.csv 的翻译文件中。如果您的相关目录中没有此文件，您可以创建它并添加以下行：

```
"Shopping Cart","NEW TITLE HERE" 
```

如果您确实有该文件，则只需编辑该行，确保您的新标题遵循原始标题和逗号并用双引号引起来。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2014-03-26T02:22:56.380

正确的方法是覆盖结帐控制器，非常简单。首先：添加一个带有两个子目录的新模块：controllers 等 Mynamespace/Checkout/controllers Mynamespace/Checkout/etc

然后，在 etc 目录中添加文件： CartController.php 并包含以下内容：

```
require_once 'Mage/Checkout/controllers/CartController.php';

class Mynamespace_Checkout_CartController extends Mage_Checkout_CartController
{

public function indexAction()
{
    $cart = $this->_getCart();
    if ($cart->getQuote()->getItemsCount()) {
        $cart->init();
        $cart->save();

        if (!$this->_getQuote()->validateMinimumAmount()) {
            $minimumAmount = Mage::app()->getLocale()->currency(Mage::app()->getStore()->getCurrentCurrencyCode())
                ->toCurrency(Mage::getStoreConfig('sales/minimum_order/amount'));

            $warning = Mage::getStoreConfig('sales/minimum_order/description')
                ? Mage::getStoreConfig('sales/minimum_order/description')
                : Mage::helper('checkout')->__('Minimum order amount is %s', $minimumAmount);

            $cart->getCheckoutSession()->addNotice($warning);
        }
    }

    // Compose array of messages to add
    $messages = array();
    foreach ($cart->getQuote()->getMessages() as $message) {
        if ($message) {
            // Escape HTML entities in quote message to prevent XSS
            $message->setCode(Mage::helper('core')->escapeHtml($message->getCode()));
            $messages[] = $message;
        }
    }
    $cart->getCheckoutSession()->addUniqueMessages($messages);

    /**
     * if customer enteres shopping cart we should mark quote
     * as modified bc he can has checkout page in another window.
     */
    $this->_getSession()->setCartWasUpdated(true);

    Varien_Profiler::start(__METHOD__ . 'cart_display');
    $this
        ->loadLayout()
        ->_initLayoutMessages('checkout/session')
        ->_initLayoutMessages('catalog/session')
        ->getLayout()->getBlock('head')->setTitle($this->__('Here it go the new title!!!!'));
    $this->renderLayout();
    Varien_Profiler::stop(__METHOD__ . 'cart_display');
    }
} 
```

然后是 config.xml 文件：

```
<config>
    <modules>
    <Mynamespace_Checkout>
        <version>0.1.0</version>
    </Mynamespace_Checkout>
</modules>
<frontend>
    <routers>
        <checkout>
            <args>
                <modules>
                    <mynamespace_sales before="Mage_Checkout">Mynamespace_Checkout</mynamespace_sales>
                </modules>
            </args>
        </checkout>
    </routers>
</frontend> 
```

最后，模块激活器：app/etc/modules/Mynamespace_Checkout.xml

```
<config>
    <modules>
        <Mynamespace_Checkout>
            <active>true</active>
            <codePool>local</codePool>
        </Mynamespace_Checkout>
    </modules>
</config> 
```

这是在 Magento Enterprise 1.13 中测试的。

问候

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-10T16:50:58.140

这是一个如何覆盖标题的简短示例。

[强制标题](http://inchoo.net/ecommerce/magento/change-any-page-title-in-magento/)

您可以更改变量并覆盖指定**layout.xml**文件中的标题。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-04-10T17:05:22.247

标题实际上是在该页面的 XML 中设置的。您应该打开`app/design/frontend/packagename/themename/layout/`目录中的 checkout.xml 文件并将此代码放在 XML 中的节点内：

```
<reference name="head">
    <action method="setTitle"><title>My New Checkout Title</title></action>
</reference> 
```

默认情况下，如果没有明确分配页面标题，我相信它会抓取与句柄关联的标签（现在标签是“购物车”，这就是您获得该标题的原因）。

这是我的代码的样子：

```
 <checkout_cart_index translate="label">
       <label>Shopping Cart</label>
       <remove name="right"/>
       <remove name="left"/>
       <!-- Mage_Checkout -->
       <reference name="head">
           <action method="setTitle"><title>My New Checkout Title</title></action>
       </reference>
       <reference name="root">
           <action method="setTemplate"><template>page/1column.phtml</template></action>
       </reference>
       <!-- More Below -->
   </checkout_cart_index> 
```

另一件事要提的是，您还可以在 a 中进行这些更改`local.xml`（这是我推荐的）。该`local.xml`文件将加载所有其他 XML 文件，并且您对该文件的更改将覆盖布局目录中的任何其他 XML 文件。一个很好的教程可以在[这里](http://www.magentocommerce.com/wiki/4_-_themes_and_template_customization/0_-_theming_in_magento/designing-for-magento)找到。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-11-21T06:19:24.270

试试这个 ：

```
<reference name="head">
     <action method="setTitle"><title>My New Checkout Title</title></action>
</reference> 
```

# android - 安卓射击游戏。复杂群体行为的强大敌人模式

> ID：10092834
> 
> 赞同：6
> 
> 时间：2012-04-10T16:39:46.230
> 
> 标签：android, artificial-intelligence

我正在开发一款类似于 Ikaruga 的 Android 街机射击游戏。我面临的问题是，为敌人创建移动和射击模式非常困难。目前，我创建了两个抽象类 EnemyShip 和 FlightPath，每个不同的敌人和移动模式分别从它们派生而来。创建 World 时，它会实例化一个 LevelManager，它以以下形式存储关卡信息：

```
waveInfos.add(new WaveInfo(3, 3f)); // new WaveInfo(NumberOfGroups, spawn interval)
enemyGroups.add(new EnemyGroup(8, EnemyGroup.TYPE_SCOUT_SHIP, EnemyGroup.F_PATH_INVADERS));
enemyGroups.add(new EnemyGroup(1, EnemyGroup.TYPE_QUAD_SPHERE, EnemyGroup.F_PATH_QUAD_SPHERE_L, World.BLACK));
enemyGroups.add(new EnemyGroup(8, EnemyGroup.TYPE_SCOUT_SHIP, EnemyGroup.F_PATH_INVADERS));
// new EnemyGroup(NumberOfEnemies, EnemyType, FlightPathType)
// new EnemyGroup(NumberOfEnemies, EnemyType, FlightPathType, ShipColour)

waveInfos.add(new WaveInfo(2, 0.33f));
enemyGroups.add(new EnemyGroup(1, EnemyGroup.TYPE_QUAD_SPHERE, EnemyGroup.F_PATH_QUAD_SPHERE_L, World.WHITE));
enemyGroups.add(new EnemyGroup(1, EnemyGroup.TYPE_QUAD_SPHERE, EnemyGroup.F_PATH_QUAD_SPHERE_R, World.WHITE));

totalWaves = waveInfos.size(); 
```

关卡被分成几波敌人，现在 EnemyGroup 类负责实例化，将指定的 FlightPath 添加到新创建的敌人，并将该敌人传递给 LevelManager 中的 ArrayList 进行存储，直到在需要的时候生成到世界中。

一旦生成 FlightPath 组件，它就会接管并开始根据它自己的 stateTime 发出指令，并且由于每个 FlightPath 都有一个指向其 EnemyShip 所有者的引用字段，它可以访问它所控制的船的功能和成员。

EnemyShip 类具有一些易于指令的函数，例如 moveTo(float x, float y, float duration) 和 shoot() 但即使使用这些函数，FlightPath 导数也很难制作，尤其是当我希望同一组中的不同敌人拥有路径略有不同，到达时间也略有不同。

我在 FlightPath 中创建了一些字段来跟踪关键帧：

```
public int currentKeyFrame = 0;
public int totalKeyFrames;
public KeyFrame[] keyFrames; // Stores duration of instruction to be done, the spreadTime, totalFrameTime and enemyIntervalTime
public int shipNumber; // Stores which ship out of group this FlightPath is attached to
public int totalShips; // Stores total number of ships in this EnemyShip's group
public float stateTime = 0; 
```

KeyFrame.spreadTime 是我尝试控制组中第一个敌人开始移动/射击和最后一个敌人之间的时间。

KeyFrame.totalFrameTime = KeyFrame.duration + KeyFrame.spreadTime

KeyFrame.enemyIntervalTime = KeyFrame.spreadTime / 本组敌人数量

虽然这种设置非常适合非常简单的线性运动，但感觉很麻烦。

感谢您阅读本文。我的问题是如何实现更简化的模式控制，这将允许复杂的移动，而无需大量的 if() 语句来检查组中的其他敌人在做什么等。

我希望我已经提供了足够的信息让您了解如何处理敌人。我会向任何有兴趣的人提供任何源代码。提前感谢您对这个主题的任何启发。

马里奥斯·卡洛格鲁

编辑：我找到了一个页面，它非常描述了适合我想要的系统的类型，但我不确定如何在整个组关键帧方面正确实现它

[http://www.yaldex.com/games-programming/0672323699_ch12lev1sec3.html](http://www.yaldex.com/games-programming/0672323699_ch12lev1sec3.html)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-10T17:27:52.720

有不同的方法：

1.  您可以在拍摄前添加随机间隔，并设置稍微随机的到达时间。喜欢`currentEnemyArrivalTime += (X - rand(2*X))`。

2.  您可以控制一群敌人的移动。小组中的每个敌人都试图保持其相对于小组中心的位置。

3.  对于真正复杂的模式，开发一些简单的脚本引擎可能会更好。它可以非常简单（例如[spline](http://en.wikipedia.org/wiki/Spline_%28mathematics%29)的系数数组），或者更复杂的东西。我相信，在这样的游戏中，行为是由脚本完成的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-10T17:41:09.403

FlightPath 不应控制任何对象。这是一条路径，而不是经理。但是，它应该能够在给定任何关键帧或时间的情况下给出坐标。例如：`flightPath.getX(1200)`-> 我应该在 1200 毫秒的 X 坐标中的什么位置？

每个 EnemyShip 都应该拥有一个 FlightPath 实例。EnemyShip 每帧检查它应该在路径中的位置。

EnemyGroup 然后控制每个 EnemyShip 的生成。如果您在一个 EnemyGroup 中有 8 艘 EnemyShip，它们都具有相同的 FlightPath 类型，那么您可以想象 EnemyGroup 会以大约 500 毫秒的间隔生成每艘船来创建波浪。

最后，将所有 EnemyShip 坐标相对于世界/屏幕坐标平移，传统上它在垂直方向上缓慢移动。

# c#-to-vb.net - Dim dataTable As DataTable = CType(sender, GridView).DataSource 的等效 C# 编码

> ID：10092839
> 
> 赞同：0
> 
> 时间：2012-04-10T16:39:58.467
> 
> 标签：c#-to-vb.net

我正在尝试将 Vb.net 转换为 C#.net。谁能帮我找到 Dim dataTable As DataTable = CType(sender, GridView).DataSource 的等效 C# 编码。还有，在数据网格视图中排序数据的任何提示。谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-10T16:48:22.167

你的意思是这样吗？：

```
DataTable dataTable = ((GridView)sender).DataSource; 
```

要在 C# 中强制转换类型，请将类型放在值之前的括号中：

```
(GridView)sender 
```

然后，要访问它的属性，您需要将整个内容括在括号中：

```
((GridView)sender).DataSource 
```

（这是因为否则你会试图调用`.DataSource`un-cast`sender`会失败。）

然后声明一个值（您要分配的变量），标准语法是指定类型，然后是变量名：

```
DataTable dataTable 
```

（顺便说一句，我强烈建议使用更好的变量名。C# 区分大小写，所以这是有效的。但它充其量是不直观的。）

在 C# 中，您还可以使用`var`关键字来推断类型，这通常会产生更清晰的代码：

```
var dataTable = new DataTable(); 
```

这仅在分配右侧存在可推断类型时才有效。由于该`DataSource`属性不是*特定*类型的`DataTable`，因此您不想`var`在这种特殊情况下使用，因为它会导致`Object`（这不是您要查找的内容）。但它可以用于本段上方的最后一个示例，您不想在同一行代码中重复两次类型名称。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-10T16:48:13.423

```
DataTable dataTable = ((GridView)sender).DataSource 
```

关于在 GridView 中进行排序，请参阅[在 GridView Web 服务器控件中对数据进行排序](http://msdn.microsoft.com/en-us/library/hwf94875.aspx)，然后在遇到问题时发布有关您尝试过的问题的问题。

# javascript - 更新 .Net Codebehind 中的 javascript 变量

> ID：10092840
> 
> 赞同：2
> 
> 时间：2012-04-10T16:40:02.020
> 
> 标签：javascript, asp.net, .net

我正在尝试在回发时更新 JavaScript 变量。我正在考虑使用 ClientScript.RegisterStartupScript 函数。它适用于初始页面加载，但不适用于回发。我在 page_load 函数中添加了以下行。我假设正在发生的事情是，如果密钥被添加一次，它不能再次添加它第二次。我有一个母版页和内容页。我从内容页面调用它。

```
ClientScript.RegisterStartupScript(typeof(Page), "SymbolError", "<script type='text/javascript'>alert('Error !!!');</script>"); 
```

有没有办法从后端调用 JavaScript 函数？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-10T16:46:12.860

您可以在您的 aspx 页面上的脚本块中放置一个 asp:Literal。

然后在你后面的代码中，只需将变量赋值作为文本放入文字中。它将作为您的 javascript 代码的一部分呈现。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-10T16:47:31.007

试试这个方法：

句法

```
 public void RegisterOnSubmitStatement (
        Type type,
        string key,
        string script

) 
```

用法

**将此代码放在页面加载上会使脚本在网络表单的每次提交点击时触发。**

```
if (!script.IsClientScriptBlockRegistered(this.GetType(), "SubmitScript"))
        {
            script.RegisterOnSubmitStatement(this.GetType(), "SubmitScript", "alert('Submit Clicked')");
        } 
```

考虑下面的代码

```
protected void Page_Load(object sender, EventArgs e)
    {    
ClientScriptManager script = Page.ClientScript;
if (!script.IsClientScriptBlockRegistered(this.GetType(), "SubmitScript"))
     {
          script.RegisterOnSubmitStatement(this.GetType(), "SubmitScript", "return confirm('Are you sure to continue')");
     }
    }
    protected void btnSubmit_Click(object sender, EventArgs e)
    {
        Response.Write("Form is Submitted.");
    } 
```

# python - 对元组列表进行排序，其中每个元组由一个字符串和一个集合组成

> ID：10092843
> 
> 赞同：-2
> 
> 时间：2012-04-10T16:40:16.513
> 
> 标签：python, sorting, set, tuples

我想获取我的元组列表，其中每个元组由一个字符串和一个集合组成，然后重新排列它，以便它按与其关联集合中的大多数条目的字符串排序。

关于如何解决这个问题的指针？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-10T16:41:40.490

将一个键函数传递给`list.sort()`：

```
my_list = [("a", set([1, 2, 3])), 
           ("b", set([1, 2, 3, 4])),
           ("c", set([1, 2]))]
my_list.sort(key=lambda x: len(x[1]), reverse=True) 
```

这导致`my_list`被

```
[('b', set([1, 2, 3, 4])), ('a', set([1, 2, 3])), ('c', set([1, 2]))] 
```

# c# - 向页面添加动态通用 html 控件会破坏绑定的下拉列表

> ID：10092846
> 
> 赞同：1
> 
> 时间：2012-04-10T16:40:30.200
> 
> 标签：c#, asp.net, .net

我今天遇到了一些奇怪的行为，我希望有人能为我解释一下，因为我很困惑。

我有几种方法用于与 ui 交互，其唯一目的是向用户显示错误/成功/警告消息。

这是其中之一

```
 public static void Confirm(string text)
    {
        var page = (Page)HttpContext.Current.Handler;
        var uiConfirm = new HtmlGenericControl("div")
        {
            ID = "uiNotify",
            InnerHtml = text
        };
        uiConfirm.Attributes.Add("class", "ui-confirm");
        page.Master.FindControl("form1").Controls.AddAt(2, uiConfirm);
    } 
```

这工作得很好，除了我今天早上遇到的一个细微差别，我希望有人可以为我解释一下。

我正在处理您运行的轧机配置文件编辑页面。在此页面中，我在页面加载时绑定了几个下拉列表（国家、省/州）。我在底部有一个提交和一个触发更新信息的点击事件，然后调用上面的方法通知用户他们的信息已成功更新。这在您第一次单击提交按钮时有效；页面回传，数据库中的信息得到更新，动态添加的 div 被弹出，显示确认消息，一切都很好。但是，如果您随后再次单击提交按钮，它将无法在我在页面加载中绑定的下拉列表中说明 SelectedItem 为空（对象引用未设置为对象的实例）。由于某种原因，下拉菜单实际上在*第二个被擦除*回发，但不是第一次。

在尝试了其他所有方法后，我绝望地决定取消对确认方法的调用……奇怪的是，错误消失了，我可以根据需要多次更新页面上的信息。

如果我将一个通用控件静态添加到我正在处理的页面中，并稍微更改我的方法，以便它不会动态地将通用控件添加到表单中，而是在页面上找到通用控件，这不会产生相同的错误.

如果我从页面中删除两个下拉菜单或停止与它们交互，问题也会消失。

为什么要在表单中添加动态控件以在回发时擦除我的下拉列表？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-10T16:48:10.667

我认为你应该考虑[`PlaceHolder`](http://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.placeholder.aspx)在你的 中使用这个类`MasterPage`，这`AddAt(2, uiConfirm)`会咬你，可能是：

**标记：**

```
.......
<asp:PlaceHolder id="PlaceHolder1" 
           runat="server"/>
...... 
```

**代码隐藏：**

```
public static void Confirm(string text)
{
    var page = (Page)HttpContext.Current.Handler;
    var uiConfirm = new HtmlGenericControl("div")
    {
        ID = "uiNotify",
        InnerHtml = text
    };
    uiConfirm.Attributes.Add("class", "ui-confirm");

    //may need to change depending on where you put your placeholder
    Control placeHolder = page.Master.FindControl("PlaceHolder1"); 
    placeHolder.Controls.Clear();
    placeHolder.Controls.Add(uiConfirm);
} 
```

# random - 使用 rand 的二叉搜索树

> ID：10092848
> 
> 赞同：0
> 
> 时间：2012-04-10T16:40:32.193
> 
> 标签：random, binary-tree

我正在尝试创建一个包含 50 个随机变量的二叉搜索树，我写了一个代码，但没有声明随机变量。请帮帮我

```
#include <iostream>
#include <cstdlib>
using namespace std; 
```

//创建一个包含value的类节点，rvalue存储rlink指向的值，lvalue存储llink指向的值

```
class node

{
private:
int value;
int rvalue;
int lvalue;
node *rlink;
node *llink;

public:

void insertnode(node*,int);
node *create(node*,int); 

};

void node::insertnode(node *h,int k)

{

h=new node;
h->value=k;
h->rlink=NULL;
h->llink=NULL;
h->rvalue=0;
h->lvalue=0;

}

node *node::create(node*root, int i)

{

int A[i];
for(int j=0; j<i; j++) {
    A[j]=rand()%1000;  //stores random values in array
    cout<<A[j];

}
node *k;
node *h;
insertnode(root, A[0]);

cout<<h->value;

for (int j=1; j<i; j++) {
    if(A[j]<h->value){
        if(h->llink==NULL) {
            insertnode(k, A[j]);
            h->lvalue=k->value;

        }
        h->llink=k;
    }
    else if(A[j]>h->value)
    {
        if(h->rlink==NULL) {
            insertnode(k, A[j]);
            h->rvalue=k->value;

        }
        h->rlink=k;

    }

} 

return root;

}

int main()

{

int i;
cout<<"enter the number of elements in a matix";
cin>>i;
node s;
node *h;
h=s.create(h,i);

} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-10T17:06:28.017

你的代码有很多问题。

*   要创建节点，只需为给定值创建一个新节点（这应该使用构造函数完成。节点类中的其他值将在节点插入树时初始化）
*   要插入一个节点，您应该始终传递树的根（或对树本身的引用）和要插入的节点，然后在 insert 方法中找到插入节点的位置（这也可以是您进行 aeny 平衡的地方如有必要）
*   如果您使用树方法（我会推荐），树应该有一个对它的根的引用，并且可能是其中的节点数
*   要生成随机节点，使用数组没有用，您只需获取一个新的随机值，为其创建一个节点，然后将其插入到列表中

要执行此操作的最后一部分，请执行以下操作（假设 C++）

```
int main() { 
  Tree *tree = new Tree(); //This creates a tree (you will need to create a tree class with a constructor
  int total = 50; //This the number of nodes you want store this however is necessary
  ....
  srand(time(NULL));
  for(int i = 0; i < total; i++) {
     int val = rand() % 1000 + 1; //This gets a number between 1-1000
     Node *node = new Node(val); //This constructs the node (write this constructor)
     tree.insertNode(node); //This will insert the node into the tree (write this method)
  }
  ....
} 
```

假设 Node 和 Tree 的构造函数和 insertNode 方法单词，这将创建一个具有 50 个值的树

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-10T16:58:07.217

在函数 create() 中，您使用变量 k 和 h，它们是指向节点的指针。但是您还没有初始化这个变量，也没有为这些指针分配空间。首先分配内存给这个变量。

# php - Drupal 完成钩子 (og)

> ID：10092859
> 
> 赞同：1
> 
> 时间：2012-04-10T16:41:35.220
> 
> 标签：php, drupal

Drupal 7.12/有机组 7.x-1.3

有谁知道当用户成功创建组时，我如何使用一些 POST 变量（如组 ID、组名等）对站点进行快速 cURL 命中？

我不知道钩子系统在这种情况下是如何工作的。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-13T14:48:30.730

有机组在 Drupal 7 中定义为实体，因此您可以[`hook_entity_insert`](http://api.drupal.org/api/drupal/modules!system!system.api.php/function/hook_entity_insert/7)在自定义模块中实现以对成功的组创建做出反应：

```
function MYMODULE_entity_insert($entity, $type) {
  if ($type == 'group') {
    $group_id = $entity->gid;

    // Install the Devel module and run the following code to get a full
    // breakdown of what's available in the $entity object
    dpm($entity);

    // Perform your cURL here
  }
} 
```

希望有帮助

# css - 如何在绝对元素之后放置相对元素并导致父 div 扩展以适合子元素？

> ID：10092861
> 
> 赞同：4
> 
> 时间：2012-04-10T16:41:38.917
> 
> 标签：css, html, positioning

我正在尝试理解 css，所以我尽力使下面的实验代码尽可能通用。

我有一个简单的页面，有两个框，我希望其中一个框以某种方式定位，根据[Why does setting the `right` CSS attribute push an element to left?](https://stackoverflow.com/questions/10082567/why-does-setting-the-right-css-attribute-push-an-element-to-the-left) 需要我像这样设置它的位置`position:absolute`但是，我现在想添加一些低于我的绝对 div 的 div，此外我希望父 div 扩展以适应子 div 的大小。

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html>
    <head>
        <style type="text/css">
            #outer {
                position : relative;
                background-color : green;
                width : 500px;
                height : 500px;
/*                 overflow : hidden; */
/* I know from working with floating elements inside divs that this works
 *   to cause parent divs to exand out around floating children, but this
 *   does not do the same thing here, it lops off the bottom of the child divs
 *   if I un-comment the preceding line!
 */
            }

            #inner {
                position : absolute;
                background-color : blue;
                height : 400px;
                width : 400px;
                top : 10px;
                right : 20px;
            }

            #top_object {
                position : absolute;
                top : 450px;
            }

             .object {
                position : relative;
                width : 450px;
                height : 200px;
                background-color : yellow;
                margin-bottom : 25px;
            }
/*   The followsing was suggested by: 
        https://stackoverflow.com/questions/1709442/make-divs-height-expand-with-its-content 
        But has no effect!
*/
           .clear {
                clear : both;
            }
        </style>
    </head>
    <body>
        <div id="outer">
            <div id="inner">

            </div>
            <div id="top_object" class="object">
                Top Object
            </div>
            <div class="object">
                Second Object
            </div>
            <div class="clear"></div>
        </div>
    </body>
</html> 
```

我想让我的第一个 div 与类对象和 id top_object 定位在与顶部绝对距离的位置，就像它出现的那样。但是，我希望更多的对象 div 在顶部对象下方流动。换句话说，我想使用 top_object 为具有类对象的 div 的第一个实例定义一个绝对位置，然后让具有类对象的以下 div 自然地沿着页面向下流动，在`margin:25px;`of中设置了 25px 的边距，在`.object`top_object 之后没有需要分别设置每个对象的`top:XXXpx;`属性。

我的第一个问题是为什么我的第二个对象出现在我的第一个对象上方，我怎样才能使`relative`定位的对象在定位的对象下方流动`absolute`？

其次，当不使用浮动 div 时，如何让背景 div 展开并围绕子 div 展开？

此外，我正在努力了解正在发生的事情，尽管对我的问题的直接回答将不胜感激，我想听听关于我所做的事情为什么是错误的以及为什么任何解决方案都可以解决它的解释。我想了解 css 背后的逻辑，而不是看到解决问题的特定代码片段，尽管那也很好！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-10T17:38:25.270

`position: absolute;`将该对象完全从文档流中取出。所以它会准确地出现在你用`top: 450px`and`right`或`left`选择器告诉它的位置。该定位不会影响页面的任何其他元素（除非您掩盖了另一个肯定会在没有 的情况下发生的对象`z-index`）如果您希望将所有内容放在下方，`#top_object`那么您需要提供它`display: block;`以及您​​需要的任何边距。

此外，`overflow: hidden`将切断定义宽度或高度之外的任何内容，因此您需要定义 min-width 和 min-height 然后使用溢出：自动而不是隐藏。

# bazaar - 拉/推/合并使用 Bazaar 更改分支

> ID：10092864
> 
> 赞同：0
> 
> 时间：2012-04-10T16:41:51.900
> 
> 标签：bazaar

我目前正在尝试使用 Bazaar，试图找到一种适合我目前正在与开发团队合作的项目的配置。我们的模型目前是中心化的，但如果我能看到显着的好处，我愿意说服改变这一点。尽管提倡它，但我将无法更改版本控制系统......有些人不知道什么对他们有好处。

目前，该项目分为几层。它是一个 Web 项目，由数据访问层、业务/域逻辑层和 Web 层（以及一堆其他应用程序级项目，例如位于域上的服务）组成。

目前，我找到了一个带有许多工作树的集市存储库，其中一个用于我提到的每一层。

**问题第 1 部分**

是否有更好的替代方法可以在每一层的存储库中使用工作树？

**我考虑过的**：

*   将所有内容放入一个粗大的分支/工作树中（有人告诉我这是故意避免的，因为有必要检查所有内容）。开发人员通过检查多个存储库的子集来创建自己的本地设置。例如，如果我正在处理其中一项服务，我会将服务、业务层和数据访问层签出到本地目录。不过，在当前设置中，我可以签出一个不影响其他任何内容的顶级应用程序，对其进行更改并将其提交回来，而无需签出大小接近 1GB 的整个存储库。

**我想补救的**：

*   问题实际上是我的 Web 层依赖于业务层的一个版本，而业务层又依赖于数据访问层。对于这样组织的项目，我不知道哪个版本的业务和数据访问层对于 Web 层上的给定提交是最新的。这对我来说感觉非常糟糕。我希望能够检查我们的应用程序的版本，这些版本与对其中一个工作树的某些提交有关。目前，我们正试图通过标记在所有工作树中跟踪这一点，但这对我来说感觉很不对劲。

**问题第 2 部分**

如果我为发布分支分支其中一个层，并发现分支根目录中的更改需要在该版本中，我如何仅将那些需要的更改推送到分支中？

所以假设每个项目都存在一个工作树的结构（或者可能是一个真正的分支），我们希望每个项目都有一个分支，其中包含特定版本的版本。所以网站树有一个 website_rls1 分支，它封装了该特定版本的开发状态。后续版本的一般开发将同时进行。因此，如果多个文件中的一个恰好与此版本相关，我想将该单个文件合并到我的发布分支中。这样做的首选方法是什么。据我了解，Bazaar 不支持合并/拉取单个文件。

**我所考虑的：**

*   只需将我想要的文件放入发布分支的本地结帐并提交

**我想补救的：**

*   遵循此考虑将取消此文件的版本信息。我想保持版本信息完整，但只合并更改的子集。我本质上想将单个文件推送到子分支，或者类似的东西。

任何想法表示赞赏。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-11T01:26:00.867

*#1*有两个插件用于管理多个依赖的 bzr 存储库：

1.  [https://launchpad.net/bzr-externals](https://launchpad.net/bzr-externals)
2.  [https://launchpad.net/bzr-scmproj](https://launchpad.net/bzr-scmproj)

它们有不同的方法，适用于不同的情况。

您可能还想考虑在构建级别解决此问题。使用像 Jenkins 这样的持续集成系统和像 Ivy 或 Maven 这样的依赖解决系统。QA 应该使用来自该系统的自动构建来完成，以便提交的错误可以引用特定的构建号，该构建号应该在其日志中包含用于生成该构建的各种依赖项的版本。

* * *

*#2*没有真正的方法来进行合并。Bazaar （还）不跟踪cherry-pick 合并。更好的方法是在发布分支中进行原始修复，然后将其合并回其父级。

# sql - 我可以在 SQL 存储过程中将列名作为输入参数传递吗

> ID：10092869
> 
> 赞同：54
> 
> 时间：2012-04-10T16:42:43.573
> 
> 标签：sql, stored-procedures

```
create procedure sp_First
@columnname varchar
AS
begin
select @columnname from Table_1
end 
exec sp_First 'sname' 
```

我的要求是将列名作为输入参数传递。我试过这样，但它给出了错误的输出。

所以帮助我

* * *

## 回答 #1

> 赞同：75
> 
> 时间：2012-04-10T16:50:24.707

你可以通过几种方式做到这一点。

一是自己构建查询并执行它。

```
SET @sql = 'SELECT ' + @columnName + ' FROM yourTable'
sp_executesql @sql 
```

如果您选择该方法，请务必确认您的输入。即使您知道您的应用程序只会给出“真实”的列名，但如果有人发现您的安全漏洞并能够直接执行 SP 怎么办？然后他们可以执行他们喜欢的任何事情。使用动态 SQL，always、*always*验证参数。

或者，您可以编写 CASE 语句...

```
SELECT
  CASE @columnName
    WHEN 'Col1' THEN Col1
    WHEN 'Col2' THEN Col2
                ELSE NULL
  END as selectedColumn
FROM
  yourTable 
```

这有点冗长，但更安全。

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2012-04-10T16:47:48.523

不，那只会选择参数值。您将需要使用动态 sql。

在您的程序中，您将拥有以下内容：

```
DECLARE @sql nvarchar(max) = 'SELECT ' + @columnname + ' FROM Table_1';
exec sp_executesql @sql, N'' 
```

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2012-04-10T16:50:01.337

尝试使用动态 SQL：

```
create procedure sp_First @columnname varchar 
AS 
begin 
    declare @sql nvarchar(4000);
    set @sql='select ['+@columnname+'] from Table_1';
    exec sp_executesql @sql
end 
go

exec sp_First 'sname'
go 
```

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2012-04-10T16:46:55.480

这是不可能的。要么使用动态 SQL（危险），要么使用巨大的 case 表达式（慢）。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2013-03-05T06:09:58.983

```
 Create PROCEDURE USP_S_NameAvilability
     (@Value VARCHAR(50)=null,
      @TableName VARCHAR(50)=null,
      @ColumnName VARCHAR(50)=null)
        AS
        BEGIN
        DECLARE @cmd AS NVARCHAR(max)
        SET @Value = ''''+@Value+ ''''
        SET @cmd = N'SELECT * FROM ' + @TableName + ' WHERE ' +  @ColumnName + ' = ' + @Value
        EXEC(@cmd)
      END 
```

正如我尝试了一个答案，它正在成功执行，但是在运行它时没有给出正确的输出，上面的效果很好

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-04-10T16:48:13.423

您可以传递列名，但不能在 sql statemnt 中使用它

```
Select @Columnname From Table 
```

可以构建一个动态 sql 字符串并像执行它一样`EXEC (@SQL)`

有关更多信息，请参阅有关动态 sql 的答案。

[动态 SQL 的优缺点](https://stackoverflow.com/questions/548090/dynamic-sql-execsql-versus-exec-sp-executesqlsql)

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2020-06-08T07:25:04.447

第一次运行;

```
CREATE PROCEDURE sp_First @columnname NVARCHAR(128)--128 = SQL Server Maximum Column Name Length
AS
BEGIN

    DECLARE @query NVARCHAR(MAX)

    SET @query = 'SELECT ' + @columnname + ' FROM Table_1'

    EXEC(@query)

END 
```

第二轮；

```
EXEC sp_First 'COLUMN_Name' 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2017-05-30T10:11:42.673

正如 MatBailie 所提到的，这更加安全，因为它不是动态查询，并且 sql 注入的可能性较小。我添加了一种情况，您甚至希望 where 子句是动态的。XX YY 是列名

```
 CREATE PROCEDURE [dbo].[DASH_getTP_under_TP]
    (
    @fromColumnName varchar(10) ,
    @toColumnName varchar(10) , 
    @ID varchar(10)
    )
    as
    begin

    -- this is the column required for where clause 
    declare @colname varchar(50)
    set @colname=case @fromUserType
        when 'XX' then 'XX'
        when 'YY' then 'YY'
        end
        select SelectedColumnId  from (
       select 
            case @toColumnName 
            when 'XX' then tablename.XX
            when 'YY' then tablename.YY
            end as SelectedColumnId,
        From tablename
        where 
        (case @fromUserType 
            when 'XX' then XX
            when 'YY' then YY
        end)= ISNULL(@ID , @colname) 
    ) as tbl1 group by SelectedColumnId 

    end 
```

* * *

## 回答 #9

> 赞同：-3
> 
> 时间：2013-01-17T10:06:16.513

请试试这个。我希望它对你有用。

```
Create Procedure Test
(
    @Table VARCHAR(500),
    @Column VARCHAR(100),
    @Value  VARCHAR(300)
)
AS
BEGIN

DECLARE @sql nvarchar(1000)

SET @sql = 'SELECT * FROM ' + @Table + ' WHERE ' + @Column + ' = ' + @Value

--SELECT @sql
exec (@sql)

END

-----execution----

/** Exec Test Products,IsDeposit,1 **/ 
```

# ruby-on-rails-3 - Rails 3.1 的 gmaps4rails gem 是否允许使用 Google Maps API 密钥？

> ID：10092881
> 
> 赞同：0
> 
> 时间：2012-04-10T16:43:52.080
> 
> 标签：ruby-on-rails-3, ruby-on-rails-3.1, gmaps4rails

文档说使用谷歌地图时不需要提供者密钥。但是，我*想*使用我的 Google API 密钥来跟踪我的使用情况。

从 gem 中的 _scripts.html.erb 文件来看，似乎没有内置支持将 provider_key 与 Google 地图一起使用。是对的吗？

```
 <% if enable_js == true && scripts.try(:to_sym) != :none %>
      <% case map_options.try(:[], :provider) %>
      <% when "openlayers" %>
        <script src="http://www.openlayers.org/api/OpenLayers.js"></script>
      <% when "mapquest" %>
        <script src="http://mapquestapi.com/sdk/js/v6.0.0/mqa.toolkit.js?key=<%= map_options.try(:[], :provider_key) %>"></script>
      <% when "bing" %>
        <script type="text/javascript" src="http://ecn.dev.virtualearth.net/mapcontrol/mapcontrol.ashx?v=7.0"></script>
      <% else %>
        <script type="text/javascript" src="//maps.google.com/maps/api/js?v=3.5&sensor=false&amp;libraries=geometry<%= gmaps4rails_js_libraries(map_options.try(:[], :libraries)) %>"></script>
        <script type="text/javascript" src="//google-maps-utility-library-v3.googlecode.com/svn/tags/infobox/1.1.9/src/infobox_packed.js"></script>
        <script type="text/javascript" src="//google-maps-utility-library-v3.googlecode.com/svn/tags/markerclustererplus/2.0.5/src/markerclusterer_packed.js"></script>
        <script type="text/javascript" src="//google-maps-utility-library-v3.googlecode.com/svn/trunk/richmarker/src/richmarker-compiled.js"></script>  
      <% end %>

      <% if Rails::VERSION::MAJOR >= 3 && Rails::VERSION::MINOR < 1 %>
        <% unless scripts.try(:to_sym) == :api %>
          <%= javascript_include_tag 'gmaps4rails/gmaps4rails.base.js' %>
        <% end %>
        <% case map_options.try(:[], :provider) %>
        <% when "openlayers" %>
          <%= javascript_include_tag 'gmaps4rails/gmaps4rails.openlayers.js' %>
        <% when "mapquest" %>
          <%= javascript_include_tag 'gmaps4rails/gmaps4rails.mapquest.js' %>
        <% when "bing" %>
          <%= javascript_include_tag 'gmaps4rails/gmaps4rails.bing.js' %>
        <% else %>
          <%= javascript_include_tag 'gmaps4rails/gmaps4rails.googlemaps.js' %>
        <% end %>
      <% end %>
    <% end  %> 
```

如果是，是否有计划添加对 Google 地图提供商密钥的支持？还是我最好自己破解它？:-P

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-11T13:46:29.767

```
 <script type="text/javascript" src="https://maps.google.com/maps/api/js?v=3.5&sensor=false&amp;libraries=geometry<%= gmaps4rails_js_libraries(map_options.try(:[], :libraries)) %>"></script>
    <script type="text/javascript" src="https://google-maps-utility-library-v3.googlecode.com/svn/tags/infobox/1.1.9/src/infobox_packed.js"></script>
    <script type="text/javascript" src="https://google-maps-utility-library-v3.googlecode.com/svn/tags/markerclustererplus/2.0.5/src/markerclusterer_packed.js"></script>
    <script type="text/javascript" src="https://google-maps-utility-library-v3.googlecode.com/svn/trunk/richmarker/src/richmarker-compiled.js"></script> 
```

需要修改src。

# spring - 如何从 Spring security 3.1 获取当前用户角色

> ID：10092882
> 
> 赞同：29
> 
> 时间：2012-04-10T16:43:52.457
> 
> 标签：spring, spring-security

我已经从数据库中为当前用户加载了角色。而且我可以在JSP中使用spring security表达式访问用户角色，并且可以隐藏没有使用hasRole授权的选项和URL。现在我想将它放在 servlet 中并将其显示在日志中（或存储在用户对象会话中）。我们怎样才能实现它？

* * *

## 回答 #1

> 赞同：75
> 
> 时间：2012-04-10T17:15:09.697

你可以尝试这样的事情：

```
Collection<SimpleGrantedAuthority> authorities = (Collection<SimpleGrantedAuthority>)    SecurityContextHolder.getContext().getAuthentication().getAuthorities(); 
```

您在权限变量中拥有角色集合。

* * *

## 回答 #2

> 赞同：35
> 
> 时间：2017-03-21T21:17:58.550

如果您在 Java 8 上开发，它会变得更容易。

获取所有用户角色：

```
Authentication authentication = SecurityContextHolder.getContext().getAuthentication();

Set<String> roles = authentication.getAuthorities().stream()
     .map(r -> r.getAuthority()).collect(Collectors.toSet()); 
```

要检查用户是否具有特定角色，例如*ROLE_USER*：

```
Authentication authentication = SecurityContextHolder.getContext().getAuthentication();

boolean hasUserRole = authentication.getAuthorities().stream()
          .anyMatch(r -> r.getAuthority().equals("ROLE_USER")); 
```

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2012-04-10T17:11:07.717

尝试从 HttpServletRequest调用[getUserPrincipal() 。](http://docs.oracle.com/javaee/6/api/javax/servlet/http/HttpServletRequest.html#getUserPrincipal%28%29)

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2018-06-23T09:38:23.110

我`hasRole`为我的项目创建了一个自定义函数。

```
public static boolean hasRole (String roleName)
{
    return SecurityContextHolder.getContext().getAuthentication().getAuthorities().stream()
            .anyMatch(grantedAuthority -> grantedAuthority.getAuthority().equals(roleName));
} 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2016-11-19T14:02:11.443

要完成这两个答案...

这是 Spring 的安全实现`getUserPrincipal`，因此您可以看到`getUserPrincipal`实际上是 `SecurityContextHolder`

```
public Principal getUserPrincipal() {
    Authentication auth = getAuthentication();

    if ((auth == null) || (auth.getPrincipal() == null)) {
        return null;
    }
    return auth;
}

// And the getAuthentication
private Authentication getAuthentication() {
    Authentication auth = SecurityContextHolder.getContext().getAuthentication();

    if (!trustResolver.isAnonymous(auth)) {
        return auth;
    }
    return null;
} 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2021-11-18T18:57:01.827

这可能会帮助某人。

```
import org.springframework.security.core.Authentication;
import org.springframework.web.bind.annotation.GetMapping;
import org.springframework.ui.Model;
import org.springframework.security.core.userdetails.User;

    @GetMapping("/home")
    public String getHomePage(Authentication authentication, Model model) {
        User u = (User) authentication.getPrincipal();
        model.addAttribute("cu", u);
        return "sb/homePage";
    } 
```

在模板 Thymeleaf 中：

```
Current user:</br>
    <div th:if="${cu}">
        Username: [[${cu.username}]]</br>
        Password: [[${cu.password}]]</br>
        Role: [[${cu.authorities[0]}]]</br>
        Enabled: [[${cu.enabled}]]</br>
        Full: [[${cu}]]</br>
    </div>
    <div th:unless="${cu}">
        Not logged-in!
    </div> 
```

# c# - c#中相同值的多个访问器

> ID：10092883
> 
> 赞同：1
> 
> 时间：2012-04-10T16:43:54.237
> 
> 标签：c#, .net-4.0, accessor

我有一个简单的场景，我有`AnotherTest`基于价值的`Test`价值。这在大多数情况下都可以正常工作，因此每当我提供时，`Test`我一定会`AnotherTest`轻松获得。

```
public sealed class Transaction {
    public string Test { get;set; }
    public string AnotherTest{
        get {
            int indexLiteryS = Test.IndexOf("S");
            return Test.Substring(indexLiteryS, 4);
        }
    }
} 
```

但是，我希望能够`set` `AnotherTest`评估并能够阅读它而无需提供`Test`价值。这可能吗？所以有点 2 种`get`基于它的设置方式。我知道我可以创建`3rdTest`，但我有一些使用的方法`AnotherTest`和其他字段，我必须编写这些方法的重载。

编辑：

我读了一些银行提供的文件。我把它切成小块，把一些东西放在`Test`价值中，交易的每个其他字段（AnotherTest 和类似的）都会自动填充。但是稍后我想从 SQL 中读取格式已经很好的事务，因此我不需要提供`Test`其他字段。我想设置这些字段，`set`然后能够在`get`不设置`Test`值的情况下使用。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-10T16:50:39.027

是的，就像这样：

```
public string Test { get; set; }

public string AnotherTest
{
   get
   {
      if(_anotherTest != null || Test == null)
         return _anotherTest;

      int indexLiteryS = Test.IndexOf("S")
      return Test.Substring(indexLiteryS, 4);
   }
   set { _anotherTest = value; }
}
private string _anotherTest; 
```

该吸气剂也可以表示为

```
return (_anotherTest != null || Test == null)
    ? _anotherTest
    : Test.Substring(Test.IndexOf("S"), 4); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-10T16:52:28.247

我认为这会做你想做的事：

```
public sealed class Transaction {
    public string Test { get;set; }
    public string AnotherTest{
        get {
            if (_anotherTest != null)
            {
                return _anotherTest;
            }
            else
            {
                int indexLiteryS = Test.IndexOf("S");
                return Test.Substring(indexLiteryS, 4);
            }
        }
        set {
            _anotherTest = value;
        }
    }
    private string _anotherTest = null;
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-10T16:55:02.767

我建议把问题转过来。

听起来您正在处理一个大字段和其中的子字段。相反，如何将这些子字段提升为字段并在访问大字段时构造/解构它。

# php - 将字符串编码为字符代码

> ID：10092885
> 
> 赞同：3
> 
> 时间：2012-04-10T16:44:04.767
> 
> 标签：php, string, character

我想将电子邮件地址编码为其相应的字符代码，因此当打印它时，字符代码由浏览器解释，但机器人得到编码字符串而不是解释字符串。

例如（1）：

```
abc@abc.com 
```

应作为 (2) 发送到浏览器（添加空格以便浏览器显示）：

```
&#97 ;&#98 ;&#99 ;&#64 ;&#97 ;&#98 ;&#99 ;&#46 ;&#99 ;&#111 ;&#109 ; 
```

所以人类阅读（1）和网络机器人阅读（2）

应该有一个简单的功能或方法来做到这一点，但找不到。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-10T16:53:04.967

你可以试试这个：

```
<?php
$s = "abc@abc.com";
$obj = array_map(function($x){return "&#". strval(ord($x)) . ";";},str_split($s));
echo implode($obj);
?> 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-10T16:49:24.543

```
function encode_everything($string){ 
    $encoded = ""; 
    for ($n=0;$n<strlen($string);$n++){ 
        $check = htmlentities($string[$n],ENT_QUOTES); 
       $string[$n] == $check ? $encoded .= "&#".ord($string[$n]).";" : $encoded .= $check; 
    } 
    return $encoded; 
} 
```

发现于：

[http://php.net/manual/en/function.htmlentities.php](http://php.net/manual/en/function.htmlentities.php)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2015-12-17T19:15:26.213

这是我写的一个简洁的函数来做类似的事情 - 不确定它是否正是你正在寻找的，但它使用 php 的`ord`函数来获取字符串中的每个字符并输出其 ascii 等价物：

```
$testString = "I hate – Character – 150" ;

function printAscii($string){      
    for ($n=0;$n<strlen($string);$n++){ 

       echo "<pre>";
       echo ord($string[$n]);
       echo " ---->";
       echo $string[$n];
       echo "</pre>"; 
    }          
} 

$test = printAscii($testString); 
```

# php - 包含文本格式标签的 HTML 的 jQuery 高亮显示

> ID：10092886
> 
> 赞同：0
> 
> 时间：2012-04-10T16:44:05.617
> 
> 标签：php, jquery, regex, dom, highlighting

有许多可用的 jQuery 文本突出显示例程（插件），例如 Johann Burkard 和 Bartek Szopka 提供的那些，但到目前为止我发现的所有这些例程都无法突出显示任何包含 HTML 文本格式标记的文本。

例如，如果我希望突出显示短语*“Lorem ipsum dolor sit amet”*并且 HTML 页面包含短语`Lorem ipsum <strong>dolor</strong> sit amet`，则不会突出显示该短语的出现。

同样，如果我希望突出显示单词*“Lorem”*并且 HTML 页面包含`Lo<i>rem</i>`，那么该事件也不会突出显示。

我开始在 PHP 中使用正则表达式来突出显示，但几乎每个人都说不去 DOM 就不可能可靠地突出显示，所以现在我去了 DOM，显然使用 DOM 也有很大的困难！

任何人都可以建议更好的 jQuery 突出显示例程或修改现有例程来解决这个困难吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-10T17:01:38.277

If you're not very concerned about the existing formatting, you can use:

```
 $('selector').html($('selector').text()); 
```

then apply your highlighter.

# excel - Excel if 语句/列总和

> ID：10092890
> 
> 赞同：3
> 
> 时间：2012-04-10T16:44:22.247
> 
> 标签：excel

我想创建一个公式来说明 A 列中的任何内容是否具有“录取”，然后将相邻的 B 列相加。我知道我可以逐个单元格地完成这个单元格并总结单元格，但是是否有可能有一个文本框可以自己完成此操作？

我正在为我们的蜜月创建一个费用页面，以查看资金的去向。我应该可以看到我们在入场费、酒店等上花了多少钱。但为了简单起见，如果可以避免的话，我不想制作一堆随机价值的盒子。所以我创建了一个摘要页面，其中包含特定日期的文本框。所以对于九月 XX，我可以选择这些框，如果它在一个字段中有“录取”（简单原因 A 列），那么我想在它旁边添加 B 单元格以获得总和。

我已经查找了所有内容，但似乎无法使其正常工作。所以现在，我正在寻求帮助。

谢谢！

A1 早餐 - B1 5 美元

A2 午餐 - B1 5 美元

A3 晚餐 - B1 $5

A4 入场 - B1 $5

A5 活动 - B1 $5

A6 入场 - B1 $5

A7 小吃 - B1 5 美元

A8 活动 - B1 5 美元

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-04-10T16:46:24.143

使用以下公式：

```
=SUMIF(A:A, "Admission", B:B) 
```

如果您输入表格，而不是在论坛中输入费用类型，而是引用表格列标题，您甚至可以复制粘贴公式以快速汇总所有类型！

![在此处输入图像描述](../Images/c4bcab897bc187986787fbae6e2b780c.png)

顺便说一句，我使用电子表格以完全相同的方式记录自己的开支：p ![在此处输入图像描述](../Images/b748866f07763d562c73018330be0a39.png)

（你可以用`CountIf`, 做同样的事情来获得计数并计算平均费用。Min 和 Max 稍微复杂一些。）

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-10T16:46:31.253

这应该

```
=SUMIF(A:A,"Breakfast",B:B) 
```

享受你的蜜月吧！

# c# - ASP.NET MVC 可选树/网格/搜索数据视图

> ID：10092891
> 
> 赞同：0
> 
> 时间：2012-04-10T16:44:26.483
> 
> 标签：c#, jquery, asp.net, asp.net-mvc, asp.net-mvc-3

我正在使用 Razor HTML 5 引擎和 C# 在 ASP.NET MVC 3 中开发一个 Web 应用程序。客户想要一些非常复杂的东西，我想知道网络上是否有任何示例可以向我展示如何开始设置它。这就是他们正在寻找的东西：

我有一个非常大的 SQL 数据库（25,000 行）。他们希望能够在同一页面上使用三个不同的视图来选择数据。

第一个将是一棵树，在表格的某些列中使用相似性将是如何将树分成多个部分。

第二个将是一个网格。这将只是您可以滚动浏览的数据库中所有内容的完整列表。当然，必须有某种虚拟滚动，因为不会很快加载 25,000 行。

第三个将是一个搜索框，您可以在其中输入代码并以这种方式选择它。

所有这三个都需要链接，以便当您在搜索框中键入代码时，它将在网格和树中选择它。如果您在树中选择它，那么它将在网格中选择，如果您在网格中选择它，那么它将在树中选择。

他们还希望我在您离开时记住最后一次选择，并能够在不同的页面上输入代码 n 并直接转到该页面并选择您输入的项目。因此，我需要能够使用 MVC 的功能为列表中的每个项目建立一个超链接（我认为这将是这样做的方法）

老实说，这是我第一次使用 ASP.net MVC，我觉得我在这个项目中可能已经咬得比我能咀嚼的更多，所以任何帮助都将不胜感激！

如果我不需要包含任何额外的 dll，他们更愿意这样做，所以如果有一种方法可以在没有第三方工具的情况下做到这一点，那就更好了，但此时我只是在寻找任何东西。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-10T22:52:58.477

关于这个的一些随机想法/想法：

作为您的第一个 MVC 应用程序，这是一个大项目——希望您对 HTML/Javascript/jQuery 有一些经验，因为它需要大量的胶水代码才能使所有内容协同工作。没有“在这里，做这个”的解决方案。

树视图和网格有很多不同的免费/开源项目。我已经将[jqGrid](http://www.trirand.com/blog/?page_id=5)用于许多项目 - 它运行良好。它有一个不错的 API 并且是相当可配置的（尽管可能需要一些挖掘才能找到您需要的示例代码）。

对于树视图，您可以尝试[jsTree](http://www.jstree.com/)。不过，我还没有使用它。

我建议从树视图开始，或者从网格开始，然后让它首先工作。然后添加另一个控件并使其工作。然后添加搜索。最后，我会努力让所有东西一起工作。

要处理导航到特定选择，您可以从 Javascript 的查询字符串中提取信息。

意识到这大部分将发生在客户端的 Javascript 中，而不是服务器端。

# jquery-ui - 添加一个额外的 标记到 rails3-jquery-autocomplete 插件的末尾

> ID：10092893
> 
> 赞同：1
> 
> 时间：2012-04-10T16:44:40.633
> 
> 标签：jquery-ui, autocomplete

我正在尝试在自动完成列表的末尾添加一个附加标签。

```
$('#address ul.ui-autocomplete').append("<li>Add Venue</li>"); 
```

我试图弄清楚我可以在哪里放置上面的代码以将额外的 li 添加到自动完成列表中。

任何帮助将不胜感激。

这是 rails3-jquery-autocomplete 文件。

```
 source: function( request, response ) {
  $.getJSON( $(e).attr('data-autocomplete'), {
    term: extractLast( request.term )
  }, function() {
    $(arguments[0]).each(function(i, el) {
      var obj = {};
      obj[el.id] = el;
      $(e).data(obj);
    });
    response.apply(null, arguments);
  });
},

open: function() {
  // when appending the result list to another element, we need to cancel the "position: relative;" css.
 if (append_to){
   $(append_to + ' ul.ui-autocomplete').css('position', 'static');

  } 
},
search: function() {
  // custom minLength

  var minLength = $(e).attr('min_length') || 2;
  var term = extractLast( this.value );
  if ( term.length < minLength ) {
    return false;
  }
},
focus: function() {
  // prevent value inserted on focus
  return false;
},
select: function( event, ui ) {
  var terms = split( this.value );
  // remove the current input
  terms.pop();
  // add the selected item
  terms.push( ui.item.value );

  // add placeholder to get the comma-and-space at the end
  if (e.delimiter != null) {
    terms.push( "" );
    this.value = terms.join( e.delimiter );
  } else {
    this.value = terms.join("");
    if ($(this).attr('data-id-element')) {
      $($(this).attr('data-id-element')).val(ui.item.id);

    }
    if ($(this).attr('data-update-elements')) {
      var data = $(this).data(ui.item.id.toString());
      var update_elements = $.parseJSON($(this).attr("data-update-elements"));
      for (var key in update_elements) {
        $(update_elements[key]).val(data[key]);
      }
    }
  }
  var remember_string = this.value;
  $(this).bind('keyup.clearId', function(){
    if($(this).val().trim() != remember_string.trim()){
      $($(this).attr('data-id-element')).val("");
      $(this).unbind('keyup.clearId');
    }
  });
  $(this).trigger('railsAutocomplete.select');
  return false;

} 
```

}); }

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-13T22:15:58.833

用这个解决了。

```
$('#address').bind('autocompleteopen', function(event,data){

$('<li id="ac-add-venue"><a href="....">Add venue</a></li>').appendTo('ul.ui-autocomplete'); 
```

});

# pdf - Applescript：用于 Appleworks 递归打印到 PDF 的 GUI 编程

> ID：10092896
> 
> 赞同：2
> 
> 时间：2012-04-10T16:44:57.690
> 
> 标签：pdf, printing, io, applescript

**目标：**成千上万的旧 Clarisworks 和 Appleworks 文档需要变成 PDF。

**问题：**脚本页面不是一种选择；它不能可靠地保留格式。*一定是 Appleworks*。该脚本在起作用时起作用；但由于我无法识别的原因，它会跳过文件。

```
set appleworksFolder to choose folder
tell application "Finder"
    set folderItems to (files of entire contents of appleworksFolder)
    repeat with I from 1 to number of items in folderItems

        set the_doc to item I of folderItems
        set doc_name to name of the_doc as text

            (* Some files are missing metatags and try to save as "Untitled Document",
              this block ensures a file name is unique, later *)

            tell application "Finder"
            set the clipboard to doc_name & ".pdf"
        end tell

            (* Each file exists in a folder with a path.txt file that will later
               be used to put the file back where it was originally stored prior
               to this conversion process *)

        if name of the_doc is not "path.txt" then
            try
                tell application "Finder"

            (* Many files no longer have name extensions and appear as UNIX
               executables if not repaired *)

                    try
                        set nmex to name extension of the_doc as text
                    on error
                        set nmex to "ok"
                    end try

                    if nmex is not "cwk" or "CWK" then
                        set the_doc_str to the_doc as text
                        set doc_path to POSIX path of the_doc_str
                        do shell script "mv '" & doc_path & "' " & "'" & doc_path & ".cwk'"
                    end if
                    delay 1

            (* In case Appleworks hangs or otherwise bungs up, I force-quit
               it at the end of the script; this ensures its closed before 
               it tries to open the next file *)

                    if (application process "Appleworks 6" of application "System Events" exists) then
                        do shell script "killall 'LaunchCFMApp'"
                        delay 1
                    end if

                    tell application "AppleWorks 6"
                        open the_doc
                    end tell

            (* Some of the documents are huge, this delay gives the app time to load
                since this is all GUI-scripted *)

                    delay 5
                    tell application process "Appleworks 6" of application "System Events"

            (* This is where I think I am encountering problems; there are two 
               possible warnings that may or may not appear on opening the doc;
               that Appleworks needs to append a version number to the file (if
               its old) or that the file may be damaged and thus would need to be
               skipped. I get system beeps sometimes in this part, but I don't know
               why! *)

                        if (button "OK" of window 1 of application process "AppleWorks 6" of application "System Events" exists) then
                            delay 0.5
                            keystroke return
                            delay 0.5
                        end if
                        delay 2
                        if (button "OK" of window 1 of application process "AppleWorks 6" of application "System Events" exists) then
                            delay 0.5
                            keystroke return
                            delay 0.5
                        end if
                        delay 2
            (* If the document loads, the Appleworks welcome pane won't be there;
               this part of the script works flawlessly, when it happens. Sometimes
               documents are outside of print margins, hence the press-ok-button 
               conditional *)

                        if not (window "Starting Points" of application process "AppleWorks 6" of application "System Events" exists) then
                            tell application process "Appleworks 6" of application "System Events"
                                keystroke "p" using command down
                                delay 1
                                click menu button "PDF" of window "Print" of application process "AppleWorks 6" of application "System Events"
                                delay 1
                                click menu item "Save as PDF…" of menu "PDF" of menu button "PDF" of window "Print" of application process "AppleWorks 6" of application "System Events"
                                delay 1
                                keystroke "v" using command down
                                click button "Save" of window "Save" of application process "AppleWorks 6" of application "System Events"
                                delay 8
                                keystroke "w" using command down
                                delay 0.5
                                if (button 1 of window 1 of application process "AppleWorks 6" of application "System Events" exists) then
                                    delay 0.5
                                    keystroke "d" using command down
                                    delay 0.5
                                end if
                                delay 0.5
                            end tell
                        end if
                        do shell script "killall 'LaunchCFMApp'"
                        delay 3
                    end tell
                end tell
            end try
        end if
    end repeat
end tell 
```

我想让这个孩子在一个周末只浏览几千个文件并创建 PDF，但每次我通宵运行它时，我都会发现几百个正确处理的文档，成百上千个跳过的文档，并且通常是一个打印对话*脚本本身*，这显然来自在 Appleworks 上下文之外使用 Command+P。我是一个 Applescript 菜鸟，可以肯定的是，这已经让我发疯了好几个星期！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-11T12:25:28.417

# php - 强制索尼 PRS-T1 的浏览器下载 .epub 文件

> ID：10092898
> 
> 赞同：2
> 
> 时间：2012-04-10T16:45:01.820
> 
> 标签：php, apache, http, http-headers, download

我的电子书阅读器（Sony PRS-T1）的内置浏览器不喜欢下载 .epub 文件。

通常它会像打开文本文件一样打开 .epub 文件。

使用这个 php-download-script 我设法强制浏览器下载我存储在服务器上的文件：

```
<?php

$path = $_GET['path'];
$mimeType = $_GET['mimeType'];

if(!file_exists($path)) {
    // File doesn't exist, output error
    die('file not found');
} else {
    $size = filesize($path);
    $file = basename($path);

    // Set headers
    header("Pragma: public"); // required
    header("Expires: 0");
    header("Cache-Control: must-revalidate, post-check=0, pre-check=0");
    header("Cache-Control: private",false); // required for certain browsers 
    header("Content-Description: File Transfer");
    header("Content-Disposition: attachment; filename=\"$file\"");
    header("Content-Type: $mimeType");
    header("Content-Transfer-Encoding: binary");
    header("Content-Length: $size");
    // Read the file from disk
    readfile($path);
}
exit();
?> 
```

现在，PRS-T1 会下载文件，但由于某种原因，我不明白它会将文件扩展名从 .epub 更改为 .htm - 这很奇怪。

但似乎有一种方法可以做到这一点：当我从[readbeam.com](http://www.readbeam.com)下载一个 .epub 文件时，它就像预期的那样工作（我在[http://www.mobileread.com/forums/showthread.php找到了这个提示?t=163466](http://www.mobileread.com/forums/showthread.php?t=163466) )。

是什么，使他们的配置和我的配置有所不同？

这是我使用萤火虫发现的：

[http://tinypic.com/r/vzzkzp/5](http://tinypic.com/r/vzzkzp/5) ![阅读光束](../Images/bf0fd828a1d793d7a1eb45a3295e583c.png)

[http://tinypic.com/r/2h7pbth/5](http://tinypic.com/r/2h7pbth/5) ![矿](../Images/f9043acd6a72ba31f7196fb736b72871.png)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-10T16:59:44.947

您的`Content-Type`标题与 readbeam 中的标题不匹配。

`application/epub zip`!=`application/epub+zip`

PHP 可能将`+`其视为一个空格，因为您似乎是通过 $_GET 传递它的。

# asp.net - ASP.NET MVC2：“System.MissingMethodException：没有为此对象定义无参数构造函数。”

> ID：10092899
> 
> 赞同：1
> 
> 时间：2012-04-10T16:45:03.427
> 
> 标签：asp.net, asp.net-mvc, asp.net-mvc-3, asp.net-mvc-2

我目前正在尝试修改默认 MVC 项目的注册组件以适应我的项目。为此，我修改了 RegisterModel、Register.aspx 和 AccountController。我可以很好地查看注册视图，但是当我提交时，我在标题中收到错误，并且它几乎没有给我带来问题的根源。有人可以引导我朝着正确的方向解决这个问题吗？

**更新：** *我也添加了内部异常*

**更新 2：** *我修改了代码以更好地适应神秘人的建议。我为表单创建了一个 ViewModel 以将模型与逻辑分开。我仍然收到同样的错误。*

这是模型、视图和控制器代码：

注册型号：

```
[PropertiesMustMatch("Password", "ConfirmPassword", ErrorMessage = "The password and confirmation password do not match.")]
public class RegisterModel
{

    [Required]
    [DisplayName("First Name")]
    public string FirstName { get; set; }

    [Required]
    [DisplayName("Last Name")]
    public string LastName { get; set; }

    [DisplayName("Phone")]
    [DataType(DataType.PhoneNumber)]
    public string Phone { get; set; }

    [DisplayName("Fax")]
    [DataType(DataType.PhoneNumber)]
    public string Fax { get; set; }

    [Required]
    [DisplayName("User name")]
    public string UserName { get; set; }

    [Required]
    [DataType(DataType.EmailAddress)]
    [DisplayName("Email address")]
    public string Email { get; set; }

    [Required]
    [ValidatePasswordLength]
    [DataType(DataType.Password)]
    [DisplayName("Password")]
    public string Password { get; set; }

    [Required]
    [DataType(DataType.Password)]
    [DisplayName("Confirm password")]
    public string ConfirmPassword { get; set; }

 } 
```

帐户控制器：

```
public ActionResult Register()
{
    ViewData["PasswordLength"] = MembershipService.MinPasswordLength;
    return View(new UserFormModel());
}

[HttpPost]
public ActionResult Register(UserFormModel model)
{

    ClaritySharetrackEntities db = new ClaritySharetrackEntities();

    if (ModelState.IsValid)
    {
        // Attempt to register the user
        MembershipCreateStatus createStatus = MembershipService.CreateUser(model.RegisterModel.UserName, model.RegisterModel.Password, model.RegisterModel.Email);

        if (createStatus == MembershipCreateStatus.Success)
        {
            MembershipUser user = Membership.GetUser(model.RegisterModel.UserName);
            int userid = Convert.ToInt32(user.ProviderUserKey);
            Profile profile = new Profile()
            {
                UserID = userid,
                FirstName = model.RegisterModel.FirstName,
                LastName = model.RegisterModel.LastName,
                Phone = model.RegisterModel.Phone,
                Fax = model.RegisterModel.Fax
            };

            db.Profiles.AddObject(profile);
            db.SaveChanges();

            //FormsService.SignIn(model.UserName, false /* createPersistentCookie */);
            return RedirectToAction("Welcome", "Home");
        }
        else
        {
            ModelState.AddModelError("", AccountValidation.ErrorCodeToString(createStatus));
        }
    }

    // If we got this far, something failed, redisplay form
    ViewData["PasswordLength"] = MembershipService.MinPasswordLength;
    return View(model);
} 
```

注册.aspx：

```
<asp:Content ID="registerContent" ContentPlaceHolderID="MainContent" runat="server">
    <h2>Create a New Account</h2>
    <p>
        Use the form below to create a new account. 
    </p>
    <p>
        Passwords are required to be a minimum of <%: ViewData["PasswordLength"] %> characters in length.
    </p>

    <% using (Html.BeginForm()) { %>
        <%: Html.ValidationSummary(true, "Account creation was unsuccessful. Please correct the errors and try again.") %>
        <div>
            <fieldset>
                <legend>Account Information</legend>

                <div class="editor-label">
                    <%: Html.LabelFor(m =>m.RegisterModel.FirstName) %>
                </div>
                <div class="editor-field">
                    <%: Html.TextBoxFor(m =>m.RegisterModel.FirstName)%>
                    <%: Html.ValidationMessageFor(m =>m.RegisterModel.FirstName)%>
                </div>

                <div class="editor-label">
                    <%: Html.LabelFor(m =>m.RegisterModel.LastName) %>
                </div>
                <div class="editor-field">
                    <%: Html.TextBoxFor(m =>m.RegisterModel.LastName)%>
                    <%: Html.ValidationMessageFor(m =>m.RegisterModel.LastName)%>
                </div>

                <div class="editor-label">
                    <%: Html.LabelFor(m =>m.RegisterModel.Phone) %>
                </div>
                <div class="editor-field">
                    <%: Html.TextBoxFor(m =>m.RegisterModel.Phone)%>
                    <%: Html.ValidationMessageFor(m =>m.RegisterModel.Phone)%>
                </div>

                <div class="editor-label">
                    <%: Html.LabelFor(m =>m.RegisterModel.Fax) %>
                </div>
                <div class="editor-field">
                    <%: Html.TextBoxFor(m =>m.RegisterModel.Fax)%>
                    <%: Html.ValidationMessageFor(m =>m.RegisterModel.Fax)%>
                </div>

                <div class="editor-label">
                    <%: Html.LabelFor(m =>m.RegisterModel.UserName) %>
                </div>
                <div class="editor-field">
                    <%: Html.TextBoxFor(m =>m.RegisterModel.UserName)%>
                    <%: Html.ValidationMessageFor(m =>m.RegisterModel.UserName)%>
                </div>

                <div class="editor-label">
                    <%: Html.LabelFor(m =>m.RegisterModel.Email)%>
                </div>
                <div class="editor-field">
                    <%: Html.TextBoxFor(m =>m.RegisterModel.Email)%>
                    <%: Html.ValidationMessageFor(m =>m.RegisterModel.Email)%>
                </div>

                <div class="editor-label">
                    <%: Html.LabelFor(m =>m.RegisterModel.Password)%>
                </div>
                <div class="editor-field">
                    <%: Html.PasswordFor(m =>m.RegisterModel.Password) %>
                    <%: Html.ValidationMessageFor(m =>m.RegisterModel.Password)%>
                </div>

                <div class="editor-label">
                    <%: Html.LabelFor(m =>m.RegisterModel.ConfirmPassword)%>
                </div>
                <div class="editor-field">
                    <%: Html.PasswordFor(m =>m.RegisterModel.ConfirmPassword)%>
                    <%: Html.ValidationMessageFor(m =>m.RegisterModel.ConfirmPassword)%>
                </div>

                <div class="editor-label">
                    <%: Html.LabelFor(m => m.RoleList) %>
                </div>
                <div class="editor-field">
                    <%: Html.DropDownListFor(m => m.RoleList, Model.RoleList) %>
                    <%: Html.ValidationMessageFor(m => m.RoleList)%>
                </div>

                <div class="editor-label">
                    <%: Html.LabelFor(m => m.ActiveList) %>
                </div>
                <div class="editor-field">
                    <%: Html.DropDownListFor(m => m.RoleList, Model.ActiveList)%>
                    <%: Html.ValidationMessageFor(m => m.ActiveList)%>
                </div>

                <div class="editor-label">
                    <%: Html.LabelFor(m => m.CompanyList) %>
                </div>
                <div class="editor-field">
                    <%: Html.DropDownListFor(m => m.RoleList, Model.CompanyList)%>
                    <%: Html.ValidationMessageFor(m => m.CompanyList)%>
                </div>

                <p>
                    <input type="submit" value="Register" />
                </p>
            </fieldset>
        </div>
    <% } %>
</asp:Content> 
```

用户窗体模型：

```
public class UserFormModel
{
    private ClaritySharetrackEntities entities = new ClaritySharetrackEntities();

    public RegisterModel RegisterModel { get; private set; }
    public SelectList ActiveList { get; private set; }
    public SelectList CompanyList { get; private set; }
    public SelectList RoleList { get; private set; }

    public UserFormModel()
    {
        SetActiveList();
        SetCompanyList();
        SetRoleList();
    }

    private void SetActiveList()
    {
        var activeList = new List<SelectListItem>{  new SelectListItem{Text = "Yes", Value = "True"},
                                                    new SelectListItem{Text = "No", Value = "False"},
                                                    };

        ActiveList = new SelectList(activeList, "Value", "Text");
    }

    private void SetCompanyList()
    {
        CompanyRepository companyRepository = new CompanyRepository();
        var companies = companyRepository.GetAllCompanies().Select(c => new { Text = c.CompanyName, Value = c.CompanyID });

        this.CompanyList = new SelectList(companies, "Value", "Text");
    }

    private void SetRoleList()
    {
        string[] roles = Roles.GetAllRoles();

        List<SelectListItem> roleList = new List<SelectListItem>();

        foreach (string str in roles)
        {
            SelectListItem listItem = new SelectListItem() { Text = str, Value = str };

            roleList.Add(listItem);
        }

        RoleList = new SelectList(roleList, "Value", "Text");
    }
} 
```

内部异常：

```
[MissingMethodException: No parameterless constructor defined for this object.]
   System.RuntimeTypeHandle.CreateInstance(RuntimeType type, Boolean publicOnly, Boolean noCheck, Boolean& canBeCached, RuntimeMethodHandleInternal& ctor, Boolean& bNeedSecurityCheck) +0
   System.RuntimeType.CreateInstanceSlow(Boolean publicOnly, Boolean skipCheckThis, Boolean fillCache) +98
   System.RuntimeType.CreateInstanceDefaultCtor(Boolean publicOnly, Boolean skipVisibilityChecks, Boolean skipCheckThis, Boolean fillCache) +241
   System.Activator.CreateInstance(Type type, Boolean nonPublic) +69
   System.Activator.CreateInstance(Type type) +6
   System.Web.Mvc.DefaultModelBinder.CreateModel(ControllerContext controllerContext, ModelBindingContext bindingContext, Type modelType) +403
   System.Web.Mvc.DefaultModelBinder.BindSimpleModel(ControllerContext controllerContext, ModelBindingContext bindingContext, ValueProviderResult valueProviderResult) +544
   System.Web.Mvc.DefaultModelBinder.BindModel(ControllerContext controllerContext, ModelBindingContext bindingContext) +479
   System.Web.Mvc.DefaultModelBinder.GetPropertyValue(ControllerContext controllerContext, ModelBindingContext bindingContext, PropertyDescriptor propertyDescriptor, IModelBinder propertyBinder) +45
   System.Web.Mvc.DefaultModelBinder.BindProperty(ControllerContext controllerContext, ModelBindingContext bindingContext, PropertyDescriptor propertyDescriptor) +658
   System.Web.Mvc.DefaultModelBinder.BindProperties(ControllerContext controllerContext, ModelBindingContext bindingContext) +147
   System.Web.Mvc.DefaultModelBinder.BindComplexElementalModel(ControllerContext controllerContext, ModelBindingContext bindingContext, Object model) +98
   System.Web.Mvc.DefaultModelBinder.BindComplexModel(ControllerContext controllerContext, ModelBindingContext bindingContext) +2504
   System.Web.Mvc.DefaultModelBinder.BindModel(ControllerContext controllerContext, ModelBindingContext bindingContext) +548
   System.Web.Mvc.ControllerActionInvoker.GetParameterValue(ControllerContext controllerContext, ParameterDescriptor parameterDescriptor) +473
   System.Web.Mvc.ControllerActionInvoker.GetParameterValues(ControllerContext controllerContext, ActionDescriptor actionDescriptor) +181
   System.Web.Mvc.ControllerActionInvoker.InvokeAction(ControllerContext controllerContext, String actionName) +830
   System.Web.Mvc.Controller.ExecuteCore() +136
   System.Web.Mvc.ControllerBase.Execute(RequestContext requestContext) +111
   System.Web.Mvc.ControllerBase.System.Web.Mvc.IController.Execute(RequestContext requestContext) +39
   System.Web.Mvc.<>c__DisplayClass8.<BeginProcessRequest>b__4() +65
   System.Web.Mvc.Async.<>c__DisplayClass1.<MakeVoidDelegate>b__0() +44
   System.Web.Mvc.Async.<>c__DisplayClass8`1.<BeginSynchronous>b__7(IAsyncResult _) +42
   System.Web.Mvc.Async.WrappedAsyncResult`1.End() +141
   System.Web.Mvc.Async.AsyncResultWrapper.End(IAsyncResult asyncResult, Object tag) +54
   System.Web.Mvc.Async.AsyncResultWrapper.End(IAsyncResult asyncResult, Object tag) +40
   System.Web.Mvc.MvcHandler.EndProcessRequest(IAsyncResult asyncResult) +52
   System.Web.Mvc.MvcHandler.System.Web.IHttpAsyncHandler.EndProcessRequest(IAsyncResult result) +38
   System.Web.CallHandlerExecutionStep.System.Web.HttpApplication.IExecutionStep.Execute() +690
   System.Web.HttpApplication.ExecuteStep(IExecutionStep step, Boolean& completedSynchronously) +194 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-11T17:07:38.927

我知道你现在有这个工作 - 这很棒。

只是想在这里发布一个注释：在模型中使用 SelectList 时要小心。您的模型将需要一个 SelectList 但您的操作可能会返回所选对象的 id - 这将抛出

> System.MissingMethodException：没有为此对象定义无参数构造函数。

您可以通过以下方式处理它：

> ```
> [Bind(Exclude = "List")]
> public class UserFormModel
> {
>     public SelectList List { get; set; }
>     public int SelectedItem { get; set; }
> } 
> ```

很容易错过并且可能会令人沮丧地追踪参数构造函数错误 - 所以我想在这里指出。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-10T16:59:38.240

首先，在模型中进行数据访问是个坏主意。模型应该是愚蠢的，它们不应该填充自己。在构造函数中创建空列表等是可以的，但不要进行数据访问。

其次，在您进行数据访问的地方，您并没有处理上下文。你应该有一个 using 语句来自动调用上下文中的 Dispose。

第三，不要使用“PropertiesMustMatch”属性，而是使用 ConfirmPassword 属性上的 Compare 属性。

这些都不会导致您看到的错误，尽管我不确定属性。尝试删除它并查看它是否有效。

# c - 何时释放 PHP 扩展中的内存？

> ID：10092901
> 
> 赞同：6
> 
> 时间：2012-04-10T16:45:23.020
> 
> 标签：c, php-extension

我想在 PHP 扩展中创建并返回一个数组数组。据我了解，我应该使用 为数组元素分配空间[`emalloc()`](http://php.net/manual/en/internals2.memory.management.php#internals2.memory.management.apis)，但我不明白何时适合释放它。我有一个与此类似的 PHP 函数：

```
PHP_FUNCTION(test)
{
    int i;
    zval **pt = emalloc(sizeof(zval*) * 10);

    array_init(return_value);

    for (i = 0; i < 10; ++i) {
        MAKE_STD_ZVAL(pt[i]);
        array_init(pt[i]);
        add_index_double(pt[i], 0, 1);
        add_index_zval(return_value, i, pt[i]);
    }
} 
```

我应该在哪里释放分配给的内存`pt`？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-10T17:46:36.283

在这种情况下，您不必这样做。当您返回的变量被销毁时，它的内存被释放。由于您要返回一个数组，因此该数组的所有元素也将在那个时候被销毁（更准确地说，当数组被删除时，它们的引用计数会减少，只有到那时它们没有其他引用才会他们被释放）。

您可以通过调用手动减少 zval 的引用计数`zval_ptr_dtor`。当它的引用计数达到 0 时，这也会释放它的内存。

从技术上讲，数组变量由`HashTable`. 当变量被销毁时，哈希表也被销毁。这样，与 as 关联的“析构函数回调”`HashTable`也被调用，一次将每个哈希表元素作为参数。当您调用 时`array_init`，它还会创建一个带有`zval_ptr_dtor`析构函数的哈希表。

另请注意，您在此处的两个地方拨打电话`emalloc`。第一个是显式的，另一个是 via `MAKE_STD_ZVAL`。第一个是不必要的，但如果你使用它，你应该`efree`在你的函数返回之前调用它，否则它的内存泄漏，因为它与 PHP 变量等任何自动内存管理机制无关。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-10T17:45:51.087

在这种情况下不需要分配内存`emalloc`，只需使用`zval *pt[10]`或减少它到单个可重用`zval`，`MAKE_STD_ZVAL`将处理所有内存（取消）分配和引用计数的东西。

# node.js - 如何处理 Node/MongoDB 连接管理？

> ID：10092903
> 
> 赞同：2
> 
> 时间：2012-04-10T16:45:26.453
> 
> 标签：node.js, mongodb

我正在使用`node-mongodb-native`连接到本地 MongoDB 实例。我在思考如何处理连接时遇到了一些麻烦。我试图将 MongoDB 的东西抽象成一个自定义`Database`模块：

**数据库.js**

```
var mongo = require('mongodb'); 
var Database = function() { return this; };

Database.prototype.doStuff = function doStuff(callback) {
    mongo.connect('mongodb://127.0.0.1:27017/testdb', function(err, conn) {
        conn.collection('test', function(err, coll) {
            coll.find({}, function(err, cursor) {
                cursor.toArray(function(err, items) {
                    conn.close();
                    return callback(err, items);
                });
            });
        });
    });
};

// Testing
new Database().doStuff(function(err, items) {
    console.log(err, items);
}); 
```

每种方法都需要新的连接吗？看起来它会很快变得昂贵。我想也许连接会在构造函数中建立，随后的调用将利用现有的连接。

下一个问题可能更像是一个设计问题，但考虑到连接设置和拆除可能是昂贵的操作，我正在考虑添加一个对我的应用程序是全局的数据库对象，可以用来调用数据库。这看起来合理吗？

请注意，上面的代码大致取自[这里](http://blog.mongodb.org/post/6587009156/cloudfoundry-mongodb-and-nodejs)。谢谢你的帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-10T19:18:02.360

您不需要为每个方法建立一个新的连接——您可以打开它一次并将其用于后续调用。这同样适用于单个集合变量 - 您可以缓存对 collection() 的单个调用的结果，这将使您只需要这些回调一次，而将它们留在其他任何地方。

# flash - Flexpaper 重叠 html 元素

> ID：10092905
> 
> 赞同：1
> 
> 时间：2012-04-10T16:45:30.070
> 
> 标签：flash, flexpaper

我知道我必须设置`wmode`属性，但是我在哪里设置 flex 纸中的属性。

以下是将 Flexpaper 嵌入 HTML 文档的代码。

```
<script type="text/javascript"> 
                    var doc                 = '<?php print $doc; ?>';
                    var numPages            = <?php echo getTotalPages($pdfFilePath . $doc) ?>;
                    var swfFileUrl          = escape('{services/view.php?doc='+doc+'&page=[*,0],'+numPages+'}');
                    var searchServiceUrl    = escape('services/containstext.php?doc='+doc+'&page=[page]&searchterm=[searchterm]');

                    var fp = new FlexPaperViewer(   
                             'FlexPaperViewer',
                             'viewerPlaceHolder', { config : {
                             SwfFile : swfFileUrl, 
                             Scale : 1, 
                             ZoomTransition : 'easeOut',
                             ZoomTime : 0.5,
                             ZoomInterval : 0.2,
                             FitPageOnLoad : false,
                             FitWidthOnLoad : false,
                             FullScreenAsMaxWindow : false,
                             ProgressiveLoading : false,
                             MinZoomSize : 0.2,
                             MaxZoomSize : 5,
                             SearchMatchAll : true,
                             SearchServiceUrl : searchServiceUrl,
                             InitViewMode : 'Portrait',
                             BitmapBasedRendering : false,

                             ViewModeToolsVisible : true,
                             ZoomToolsVisible : true,
                             NavToolsVisible : true,
                             CursorToolsVisible : true,
                             SearchToolsVisible : true,

                             localeChain: 'en_US'
                             }});           
                </script> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-18T21:11:43.623

我看不到通过将参数传递给 FlexPaperViewer 构造函数来做到这一点的方法，但您可以在 flexpaper_flash.js 中解决它。在第 19 行附近并尝试在`wmode`那里添加参数：

```
window.FlexPaperViewer = window.$f = function() {
    var config = arguments[2].config;

    window.FlexPaperViewer_Instance = flashembed(arguments[1], {
        //add wmode here
        wmode: "transparent",
        src: arguments[0]+".swf",
        version: [10, 0],
        expressInstall: "js/expressinstall.swf"
    },{
        ...
    });
}; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-22T14:12:47.207

一个更好的主意是将以下内容添加到您的 flexpaper 配置中：

像这样：

```
var fp = new FlexPaperViewer(
                            '<%:FlexPaperViewer %>',
                            'documentViewer', { config: {

                                    SwfFile: '<%:SwfFile%>.swf',
                                    IMGFiles: '<%:SwfFile%>_{page}.png',
                                    JSONFile: '/GetJson.ashx?q=<%=SwfFile%>.json',

                                    ...lots of other irrelevant params...
                                    WMode : 'transparent',

                                    localeChain: 'en_US'
                                }
                            }); 
```

Flexpaper 将获取 WMode 并将其设置在 Flash 对象上（我使用的是 flexpaper 1.5（2012 年 5 月））

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-17T04:35:02.207

wmode 实际上是您在 HTML 中的 SWF 嵌入代码中设置的配置参数。要更具体地回答，您需要展示您是如何嵌入代码的，以及 FlexPaper 所需的 wmode 值。但是，这里有一些基于流行嵌入方法的设置方法。

如果您使用嵌入 SWF 影片的 HTML 样式，请将其添加到现有参数标记旁边。

```
<param name="wmode" value="transparent"> 
```

或者，如果您使用 SWFObject 嵌入您的 SWF，您可以像这样设置 wmode：

```
var flashvars = {},
params = {wmode:"transparent"},
attributes = {};

swfobject.embedSWF("/swf/yourSWF.swf", "anim", "300", "200", "9.0.0", "/swf/expressInstall.swf", flashvars, params, attributes); 
```

有关详细信息，请参阅有关[wmode 参数](http://helpx.adobe.com/flash/kb/flash-object-embed-tag-attributes.html#main_Using_Window_Mode__wmode__values_)的 Adob​​e 文档。

# xml - Powershell：获取本地IP、MAC和网卡名称

> ID：10092906
> 
> 赞同：0
> 
> 时间：2012-04-10T16:45:32.943
> 
> 标签：xml, powershell, ip, mac-address

我一直在编写一些 powershell 代码，它应该以 XML 格式收集和存储有关计算机的信息。但我似乎无法获得网卡的 IP、MAC 和名称。

这是我编写的一些代码的示例（工作代码）：

```
#OSInfo
$newosinfo = (@($xml.computer.software.osinfo)[0])
Get-WmiObject -computer $compname Win32_OperatingSystem | 
ForEach-Object {
        $newosinfo = $newosinfo.clone() 
        $newosinfo.caption = $_.caption
        $newosinfo.serialnumber = [string]$_.serialnumber
        $newosinfo.OSArchitecture = $_.OSArchitecture
        $newosinfo.manufacturer = $_.manufacturer
        #Time $newosinfo.installdate;
        $xml.computer.software.AppendChild($newosinfo) > $null
}
$xml.computer.software.osinfo | where-object {$_.caption -eq ""} | foreach-object {$xml.computer.software.RemoveChild($_)} 
```

这是我尝试编写的代码（不工作的代码）：

```
$newnetwork = (@($xml.computer.software.network)[0])
Get-WmiObject -computer $compname Win32_NetworkAdapter -Filter 'NetConnectionStatus=2' | 
ForEach-Object {
        $newnetwork = $newnetwork.clone()
        $newnetwork = 1 | Select-Object Name, MAC, IP 
        $newnetwork.Name = $_.Name
        $newnetwork.MAC = $_.MacAddress
        $IP = $_.GetRelated('Win32_NetworkAdapterConfiguration')
        $newnetwork.IP = $IP | Select-Object -expand IPAddress
        $xml.computer.software.AppendChild($newnetwork) > $null
}
$xml.computer.software.network | where-object {$_.Name -eq ""} | foreach-object {$xml.computer.software.RemoveChild($_)} 
```

这段代码给出了这个错误：

```
Cannot convert argument "0", with value: "@{Name=Intel(R) 82579V Gigabit Network Connect
ion; MAC=F4:6D:04:40:DB:6F; IP=10.0.0.12}", for "AppendChild" to type "System.Xml.XmlNod
e": "Cannot convert the "@{Name=Intel(R) 82579V Gigabit Network Connection; MAC=F4:6D:04
:40:DB:6F; IP=10.0.0.12}" value of type "Selected.System.Int32" to type "System.Xml.XmlN
ode"."
At A:\Dropbox\Bachelorprosjekt\Kode\Fungerende Script+kode\infoGatherer.ps1:177 char:43
+         $xml.computer.software.AppendChild <<<< ($newnetwork) > $null
    + CategoryInfo          : NotSpecified: (:) [], MethodException
    + FullyQualifiedErrorId : MethodArgumentConversionInvalidCastArgument 
```

所以我的问题是，有没有人知道或可以编写像上面这样的代码，行得通？顺便说一句：仅收集有关“激活”卡的信息是否更聪明？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-10T23:33:39.333

首先，我不确定您为什么要将 XmlNode 包装在一个数组中，然后再展开它 - 据我所知，以下两行是等效的：

```
$a = (@($xml.computer.software.network)[0])
$b = $xml.computer.software.network 
```

我发现的第二件事，你有这个奇怪的东西`1 | Select Name, MAC, IP`，我猜你正在用它来尝试在你的 XmlNode 上填充这些属性？您实际上正在做的是将先前从 XmlNode 克隆的 $newnetwork 对象更改为 PSCustomObject 类 - 当您尝试将其作为参数传递给 appendChild() 方法时，该类稍后会中断。

下面是一些工作的 PowerShell 代码，它们可能会满足您的需求。我正在对您的 XML 结构做出一些假设，因此您可能需要对其进行调整以满足您的确切需求：

```
# setup sample XML
$xml = [xml]"
  <computer><software><network>
    <Name />
    <MAC />
    <IP />
  </network></software></computer>"

# duplicate network XmlNode and grab necessary info through WMI
# note: there may be more than one IP Address bound
#       on a given adapter. Use just the first one.
$info = $xml.computer.software.network.clone()
$nic = Get-WmiObject Win32_NetworkAdapter | select -first 1
$ip = $nic.GetRelated("Win32_NetworkAdapterConfiguration") | 
    select -expand IPAddress -first 1

# populate children with correct values
$info.Name = $nic.Name
$info.MAC = $nic.MACAddress
$info.IP = [string]($ip)

# finally append new XmlNode to software node
$xml.computer.software.appendChild($info) 
```

# php - PayPal自适应支付IPN函数调用

> ID：10092910
> 
> 赞同：1
> 
> 时间：2012-04-10T16:46:07.987
> 
> 标签：php, paypal, paypal-sandbox

我第一次尝试贝宝自适应付款。一切正常，我在沙盒上测试过，效果很好。现在我需要跟踪付款是否成功？我正在研究IPN。我看到了，我认为打出成功的电话是完美的。

目前我正在使用paypal生成的自适应代码，我只是很困惑在哪里调用IPN函数（我正在使用这个[IPN脚本](https://cms.paypal.com/cms_content/US/en_US/files/developer/IPN_PHP_41.txt)）

有人能帮忙吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-10T16:50:47.293

您不调用 IPN 函数，当 PayPal 想要通知您付款时，它会在预先指定的 URL 处调用您的 IPN 脚本。

（在苏联 PayPal 中，功能调用您！）

# c++ - DirectX 10/11 常量缓冲区内容未通过

> ID：10092922
> 
> 赞同：1
> 
> 时间：2012-04-10T16:47:07.173
> 
> 标签：c++, directx-11, directx-10

我做了一个常量缓冲区定义为

```
cbuffer MatrixBuffer : register(b1) {
float4x4 aMatrixTransforms[24];
float aMatrixWeights[24];
uint UsedMatrices;
float3 Unused;  
} 
```

在 HLSL 和

```
struct stMBuffer {
D3DXMATRIX aMatrixTransforms[24];
float aMatrixWeights[24];
unsigned int UsedMatrices;
D3DXVECTOR3 Unused;
}; 
```

在 C++ 中

现在所有矩阵以及aMatrixWeights 数组的前5 个元素都成功交付，但之后就什么都没有了，它只是0。有人知道发生了什么吗？谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-10T18:39:26.443

检查您正在创建的缓冲区的大小。您也可以使用调试层 - 它会向您显示这种情况下的警告。

# java - 在单元测试中验证私有方法调用的顺序

> ID：10092926
> 
> 赞同：1
> 
> 时间：2012-04-10T16:47:30.857
> 
> 标签：java, junit, mocking, mockito

我有以下课程：

```
class MyClass {

  public void doIt() {
     methodOne();
     methodTwo();
     methodThree();
  }

  private void methodOne() {
     // ...
  }

  // rest of methods similar...

} 
```

我的目的是验证当我调用 doIt() 时，方法 metodOne()、methodTwo() 和 methodThree() 将按顺序被调用。

我正在使用[mockito](http://docs.mockito.googlecode.com/hg/latest/org/mockito/Mockito.html)进行模拟。有谁知道我如何测试这种情况？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-04-10T17:01:11.073

讨厌成为那个人，但是：根本不测试这个。测试输出、副作用、结果——而不是执行。

如果您真的想确保正确的顺序，请将这些方法提取到单独的类中并模拟它们。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-10T17:03:19.733

只要您的私有方法是……好吧……私有的，就不要测试它们。它们是实现细节。它们可以在不更改类合同的情况下进行重构。测试公共方法的正确结果。

# php - php/mysql 更新非常大的表的更好选择

> ID：10092929
> 
> 赞同：4
> 
> 时间：2012-04-10T16:47:33.813
> 
> 标签：php, mysql

我有两张大桌子。如果 productid 和 userid 匹配，我想用第一个表更新第二个表中的所有字段，如果不存在则插入新字段。JOIN 会比简单的 UPDATE 更好吗？替换成怎么样？有人可以帮助我做出最佳决策吗？因为桌子很大。

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-15T14:44:38.080

1000 亿是非常罕见的，所以我假设你在 stackoverflow 上找不到可靠的答案。

你应该做自己的基准测试，查看[mysql.com 上的 EXPLAIN 关键字](http://dev.mysql.com/doc/refman/5.5/en/explain.html)并编写一个简短的脚本[（此处为 php ）](http://css-tricks.com/snippets/php/count-script-excecution-time/)来分析所花费的时间。

另一方面，我不确定 MySQL 是否是 1000 亿数据库的最佳选择。

# jquery - XPath 在 JQuery 选择器中不起作用（JQuery 版本 1.7.1）

> ID：10092930
> 
> 赞同：1
> 
> 时间：2012-04-10T16:47:36.670
> 
> 标签：jquery, xpath, jquery-selectors, jquery-1.7

下面是一个有效的 jQuery 选择器，并且该值已正确设置到文本框中。为什么 jQuery 选择器中的 XPath 代码不起作用？我认为 jQuery 支持 XPath。

**jQuery代码工作：**

```
$('html > body > form > div:nth-child(4) > label > input').val('hello world'); 
```

**jQuery代码不起作用：**

```
$('/html/body/form/div[4]/label/input[1]').val('hello world'); 
```

**此处的文档：**

[http://docs.jquery.com/DOM/Traversing/Selectors](http://docs.jquery.com/DOM/Traversing/Selectors)

...在上面的文档中搜索此代码 ....`$("/html/body//p")`

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-04-10T16:49:59.383

jQuery 不再支持开箱即用的选择器的 XPath 语法。

如果您查看链接到的文档，您会发现它是**1.1.2 版本**的，这是 5 年前的东西。它还说，在一个**带有居中文本的大红色框中**：

> 这是 Selectors API 的旧版本：
> 
> ### [查看当前 API](http://docs.jquery.com/Selectors)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-10T16:54:13.670

当 Xpath 选择器被移除（[在 JQuery 1.2 中](http://docs.jquery.com/Release%3ajQuery_1.2#XPath_Compatibility_Plugin)）时，功能被移动到一个插件，[http://archive.plugins.jquery.com/project/xpath](http://archive.plugins.jquery.com/project/xpath)

# dependencies - SCons 对编译时生成的文件的依赖

> ID：10092931
> 
> 赞同：13
> 
> 时间：2012-04-10T16:47:42.153
> 
> 标签：dependencies, code-generation, scons

我正在尝试设置 SCons 以遵循在构建期间自动生成的文件的依赖关系，并在多线程构建中正常工作。

我正在构建的项目是一个 CIM 提供程序，由定义数据结构的 MOF 文件、来自 MOF 文件的自动生成的源文件和头文件以及引用自动生成的文件的手写源文件和头文件组成。为了使构建成功，自动生成步骤必须在编译任何手写文件之前运行完成，否则手写文件所依赖的头文件将不存在并且它将失败。由自动生成步骤创建的 .cpp 文件也必须添加到源列表并在最终构建中编译。

运行单线程构建时，一切正常，因为自动生成步骤总是在编译步骤之前完成，所以生成的头文件就位。但是，在多线程运行构建时，它会在自动生成步骤完成之前尝试编译手写文件，并且构建失败。我已经指定了一个明确的依赖关系，但 SCons 没有遵循它。

这是我的 SConscript 文件的相关部分，我从 cim_targets[] 中删除了单个文件名，因为列表非常长，但总而言之，cim_targets[] 是自动生成步骤的目标输出文件列表，provider_sources[] 是返回的autogen 步骤完成后的源列表，sources[] 是手写源文件的列表，GenProvider() 是外部定义的执行自动生成步骤的命令构建器，SharedLibrary() 是外部定义的构建器, 使用带有一些扩展的 SCons 库构建器

```
# Define directory paths for the CIM schema
cim_dir = 'cim-schema-2.26.0'

var_smis_dir   = Dir('.').abspath # src/lib/XXX in variant

cim_sources = [
    Glob(os.path.join(cim_dir, '*qualifiers*.mof')),
    Glob(os.path.join(cim_dir, 'Core')     + '/CIM_*.mof'),
    Glob(os.path.join(cim_dir, 'Device')   + '/CIM_*.mof'),
    Glob(os.path.join(cim_dir, 'Event')    + '/CIM_*.mof'),
    Glob(os.path.join(cim_dir, 'XXXXXX')   + '/XXX_*.mof'),
    Glob(os.path.join(cim_dir, 'Interop')  + '/CIM_*.mof'),
    Glob(os.path.join(cim_dir, 'Physical') + '/CIM_*.mof'),
    Glob(os.path.join(cim_dir, 'System')   + '/CIM_*.mof'),
]

cim_sources_flat = []
for cim in cim_sources:
    for src in cim:
        cim_sources_flat.append(src)

cim_targets = [
    ......
]

sources = [
    'driver.cpp',
    'device.cpp',
    'cim_static_data.cpp',
    'module.cpp',
    'diag_log.cpp',
    'profile_element.cpp',
]

staticlibs = [
    ......
    ]

dynamiclibs = [
    .....
    ]

var_cim_sources = this_env.Install(var_smis_dir, cim_sources_flat)

cim_mof = 'cimv226.mof'

cim_linux_mof = os.path.join(cim_dir, 'cimv226-gen-flat.mof')

var_cim_sources.extend(this_env.Command(cim_mof, cim_linux_mof, Copy('$TARGET', '$SOURCE')))

# first generate the provider infrastructure using cimple
provider_sources = this_env.GenProvider(cim_targets, var_cim_sources, name, var_smis_dir)

# make sure these files don't build until AFTER the provider files have been created
this_env.Depends(sources, provider_sources)

sources_full = provider_sources + sources

# now we can compile the provider
this_env.SharedLibrary(libname, source=sources_full, staticlibs=staticlibs, dynamiclibs=dynamiclibs, installpath=install_dir) 
```

我尝试设置显式依赖项，以便在创建所有生成的源之前不会编译手写源（this_env.Depends(sources, provider_sources)），但是在运行多线程时，SCons 会忽略此依赖项并尝试在自动生成步骤已完成。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-10T18:49:22.333

您是否尝试过使用此处定义的 SideEffect() 函数：

[SCons Wiki：副作用](http://scons.org/wiki/SConsMethods/SideEffect)

我不确定它是否完全符合您的需要，但可能会有所帮助。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2019-12-10T20:45:00.687

我能够通过将生成的文件作为`Command`. 例如，假设您有一个文件`foo.c`：

```
#include <stdio.h>
#include "foo.h"
int main() {} 
```

并说`foo.h`需要先生成才能`foo.c`构建。你可以这样做：

```
import time

def build_foo(target, source, env):
    print("Generating foo source files")
    time.sleep(5)
    with open("foo.h", "w") as f:
        f.write("")
    # Generate bar.so, which we need later for X, blah blah blah
    print("Done generating")

env = Environment()
env.Command(['foo.h', 'bar.so'], 'foo.in', build_foo)
env.Program('foo', 'foo.c') 
```

构建输出如下所示：

```
$ scons -Q -j4
build_foo(["foo.h", "foo.so"], ["foo.in"])
Generating foo source files
Done generating
gcc -o foo.o -c foo.c
gcc -o foo foo.o 
```

如果您省略`foo.h`作为目标（即`env.Command(['bar.so'], 'foo.in', build_foo)`，构建输出如下所示：

```
$ scons -Q -j4
gcc -o foo.o -c foo.c
build_foo(["foo.so"], ["foo.in"])
Generating foo source files
foo.c:2:10: fatal error: foo.h: No such file or directory
 #include "foo.h"
          ^~~~~~~
compilation terminated.
scons: *** [foo.o] Error 1
Done generating 
```

# php - 如何在php中将图像从相对目录包含到根目录

> ID：10092932
> 
> 赞同：0
> 
> 时间：2012-04-10T16:47:45.883
> 
> 标签：php

```
|root 
| subdir 1 
|   subdir 2
|     subdir 3
|       subdir 4
|         subdir 5 
|              myphp.php 

|relativeroot2(images directory)
   img1.jpg 
```

在上面的 myphp.php 脚本中，我试图包含来自 relativeroot2 目录的 (img1.jpg)。我无法做到这一点，我该如何包含它。当我说`$_SERVER['DOCUMENT_ROOT']`iam 从那里返回值作为“根”时，如何包含它 `<img src ="<?php echo $_SERVER['DOCUMENT_ROOT']?>"/relativeroot2/img1.jpg">`

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-10T17:25:07.647

假设这是您的网络文件夹的外观

```
 root
  /includes
  /relativeroot1
  /relativeroot2 
```

在上面的文件夹中创建一个名为`path.php`的`includes`文件并插入以下内容

```
<?php

if (session_id() == '') {
    session_start(); /* if not already done */
}

/* replace value below with appropriate header to root distance of this include file */

$header_to_root_distance = 1;
$header_dir = dirname(__FILE__);

$root_distance = substr_count($header_dir, DIRECTORY_SEPARATOR) - $header_to_root_distance;

  if($_SERVER['SERVER_ADDR']){
     $include_distance = substr_count(dirname($_SERVER['SCRIPT_FILENAME']), "/");
  }else{
     $include_distance = substr_count(dirname($_SERVER['SCRIPT_FILENAME']), "\\");
  }

$r_path = str_repeat('../', $include_distance - $root_distance);
$_SESSION['r_path'] = $r_path;

 /* Note - $r_path holds your relative url starting from the root folder */

?> 
```

在上面的文件夹中创建一个`.htaccess`文件`root`并插入以下内容

```
<IfModule php5_module>
    php_value include_path "includes/"
</IfModule> 
```

现在打开你想要一个相对路径的文件，例如你的`myphp.php`脚本并在顶部插入以下内容

```
<?php require 'path.php' ?> 
```

因此，在您的情况下从任何文件请求任何相对路径。只需执行以下操作

```
 <img src="<?php echo $r_path.'relativeroot2/img.jpg' ?>" title="My Image" /> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-10T16:52:35.090

如果您的图表显示 relativeroot2 不在根目录中，但在同一个父目录中，您可以`../`在指定之前使用上一级。您的图像标签中还有一个杂散的双引号。

```
<img src ="<?php echo $_SERVER['DOCUMENT_ROOT']?>/../relativeroot2/img1.jpg"> 
```

# java - 如何以编程方式清除日志文件？

> ID：10092937
> 
> 赞同：0
> 
> 时间：2012-04-10T16:48:04.363
> 
> 标签：java, slf4j, logback

我在 logback 文件中设置了两个日志文件。

```
<appender name="file" class="ch.qos.logback.core.rolling.RollingFileAppender">
        <rollingPolicy class="ch.qos.logback.core.rolling.TimeBasedRollingPolicy">
              <fileNamePattern>/opt/loghome/${instance}/recon.%d{MM-dd-yyyy}.log.zip
              </fileNamePattern>
              <maxHistory>30</maxHistory>
        </rollingPolicy>
        <append>false</append>
        <encoder>
              <pattern>%d{MM/dd/yyyy HH:mm:ss.SSS} [%thread] %-5level %logger{36} -%X{User} %msg%n</pattern>
        </encoder>
  </appender>

  <appender name="datafile1" class="ch.qos.logback.core.FileAppender">
        <file>/opt/loghome/datafiles/file1.log</file>
        <append>false</append>
        <encoder>
              <pattern>%msg%n</pattern>
        </encoder>
  </appender> 
```

在java中，这些设置如下：

```
private static final Logger logger = LoggerFactory
              .getLogger(Main.class); 
```

和

```
private static final Logger logger = LoggerFactory
              .getLogger("datafile1"); 
```

第一个是标准应用程序日志文件。第二个存储程序从数据库中检索的数据。

然后程序比较日志文件中的数据并发送一些结果。完成后，我想清除此日志（datafile1），使其为空并为下一次运行做好准备。我怎样才能做到这一点？

注意，该程序是一个 24 小时进程，它使用调度程序来运行此作业。它不会在每次运行作业时重新启动。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-10T16:56:39.673

似乎您将日志文件用作数据存储？日志文件不是为此而设计的，因此实际上没有办法清除它们。如果要将数据存储在临时位置，请打开一个文件进行写入，不要记录它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-11T16:11:03.730

最终使用了这个：

```
 public void resetLogs() {

    LoggerContext lc = (LoggerContext) LoggerFactory.getILoggerFactory(); 
    ContextInitializer ci = new ContextInitializer(lc); 
    lc.reset();
    try {   
        ci.autoConfig();  
    } catch (JoranException e) {  
        e.printStackTrace(); 
    }
} 
```

刷新 LoggerContext 上下文

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-10T17:20:01.903

您可以尝试关闭 appender 并将另一个 appender 添加到您的`Logger`. 这里有一个例子：

```
Logger logger = Logger.getLogger("datafile1");
logger.setLevel(Level.ALL);

FileAppender appender = new FileAppender(new PatternLayout("%msg%n"), "/logs/datafile", false);
Logger.getRootLogger().addAppender(appender);

// log data
logger.info("info1");

// here you remove and close the old appender
Logger.getRootLogger().removeAppender(appender);
appender.close();

// replace with a new one appender
appender = new FileAppender(new PatternLayout("%msg%n"), "/logs/datafile", false);
Logger.getRootLogger().addAppender(appender);

// log new data
logger.info("info2"); 
```

# android - 在android中使用自定义建议列表自动完成文本视图？

> ID：10092942
> 
> 赞同：1
> 
> 时间：2012-04-10T16:48:16.610
> 
> 标签：android, autocompletetextview

如何自定义自动完成文本视图的建议列表？我需要在其中显示图像和文本，我正在使用无法自定义它的 baseadapter 类下面是我的代码。请看一下并给我解决这个问题的建议谢谢....

```
public class AutocompleteTextActivity extends Activity {
        /** Called when the activity is first created. */

        static final String[] COUNTRIES = new String[] { "Afghanistan", "Albania",
                "Algeria", "American Samoa", "Andorra", "India", "Indonesia" };
        static final Integer[] Images = { R.drawable.one, R.drawable.two,
                R.drawable.three, R.drawable.four, R.drawable.five, R.drawable.six,
                R.drawable.seven };

        private AutoCompleteTextView searchText;

        @Override
        public void onCreate(Bundle savedInstanceState) {
            super.onCreate(savedInstanceState);
            setContentView(R.layout.main);
            searchText = (AutoCompleteTextView) findViewById(R.id.autocomplete_country);
            searchText.setAdapter(new EfficientAdapter(this));

        }

        private static class EfficientAdapter extends BaseAdapter {
            private LayoutInflater li;

            public EfficientAdapter(Context context) {
                li = LayoutInflater.from(context);
            }

            public int getCount() {
                return COUNTRIES.length;
            }

            public Object getItem(int position) {
                return position;
            }

            public long getItemId(int position) {
                return position;
            }

            public View getView(int position, View convertView, ViewGroup parent) {
                ViewHolder holder;
                if (convertView == null) {
                    convertView = li.inflate(R.layout.listitem, null);
                    holder = new ViewHolder();
                    holder.name = (TextView) convertView.findViewById(R.id.text);
                    holder.image = (ImageView) convertView.findViewById(R.id.image);
                    convertView.setTag(holder);
                } else {
                    holder = (ViewHolder) convertView.getTag();
                }
                holder.name.setText(COUNTRIES[position]);
                holder.image.setBackgroundResource(Images[position]);
                return convertView;
            }

            static class ViewHolder {
                TextView name;
                ImageView image;
            }
        }
    } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-23T18:58:20.647

试试[这个](http://jnastase.alner.net/archive/2010/12/19/custom-adapter-for-autocomplete.aspx "尝试这个")作为参考。希望这会对某人有所帮助！

# maven - 克隆 repo 后 Maven 缺少项目所需的库

> ID：10092948
> 
> 赞同：0
> 
> 时间：2012-04-10T16:48:24.123
> 
> 标签：maven, mercurial, jar, project, m2e

一位团队成员在 bitbucket 上与我分享了他的项目，他使用 maven 来管理他的依赖项。将 repo（使用 mercurial）克隆到我的工作区（Eclipse）并下载 maven、m2e 和所有其他必需的设置文件后，我能够获得除 4 之外的所有项目库。

下载项目后，我运行了几个`mvn`命令来清理、安装并希望下载这些丢失的 jar。当我运行`mvn -e`命令时，我得到了这个无济于事的长错误。我是否必须找到并下载这 4 个 jar 并将它们放入我的 maven repo 中？

命令输出：`mvn -e`

```
[INFO] ------------------------------------------------------------------------
[INFO] BUILD FAILURE
[INFO] ------------------------------------------------------------------------
[INFO] Total time: 23.769s
[INFO] Finished at: Mon Apr 09 17:42:17 CDT 2012
[INFO] Final Memory: 4M/15M
[INFO] ------------------------------------------------------------------------
[ERROR] Failed to execute goal on project Dugsi_Manager: Could not resolve depen
dencies for project org.bixin.dugsi:Dugsi_Manager:war:0.1.0.BUILD-SNAPSHOT: The
following artifacts could not be resolved: org.eclipse.persistence:eclipselink:j
ar:2.2.0, org.eclipse.persistence:javax.persistence:jar:2.0.3, org.vaadin:icepus
h-gwt:jar:0.1.2, org.jqurantree:jquran:jar:1.0.0: Could not find artifact org.ec
lipse.persistence:eclipselink:jar:2.2.0 in spring-maven-release (http://maven.sp
ringframework.org/release) -> [Help 1]
[ERROR]
[ERROR] To see the full stack trace of the errors, re-run Maven with the -e swit
ch.

[ERROR] Re-run Maven using the -X switch to enable full debug logging.
[ERROR] 
```

编辑：

我只需要与克隆我的项目的所有其他团队成员共享我的本地存储库。不使用 maven 的外部 jar 必须手动安装到我的本地 repo 中，这会产生问题，因为我无法共享我的本地 repo？有任何想法吗

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-18T16:20:17.117

您可以将这些 JAR 安装在本地存储库中，或者设置一个自己的（可能是私有的）maven 存储库以与您的团队共享。Sonatype 为[Nexus OSS](http://www.sonatype.org/nexus/)提供了一个基于开源的软件，可以轻松设置存储库（如果您愿意，它也可以代理远程存储库）。

# android - 我可以在 MyLayout 的 onDraw 中做 addView 吗？

> ID：10092949
> 
> 赞同：0
> 
> 时间：2012-04-10T16:48:33.203
> 
> 标签：android

我是安卓新手。我想在 onDraw 中添加图像按钮。我想知道我是否可以这样做。我没有编译错误。但模拟器说：“不幸的是，MyApp 已停止。” 我的第二个问题是如何在屏幕中的 x、y 位置添加按钮？addView 中没有位置参数。

```
protected class MyLayout extends LinearLayout {
    ImageButton button;
    public MyLayout(Context context) {
        super(context);
        setWillNotDraw(false);
        button = new ImageButton(context);
        button.setImageBitmap(buttonBitmap); // buttonBitmap is loaded in onCreate
    }
    public void onDraw(Canvas canvas) {
        addView(button);
    }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-10T17:17:40.943

我不会在 onDraw() 覆盖函数中向自定义线性布局添加按钮。onDraw 会定期调用（例如在调整元素大小时）。因此，每次调用 onDraw() 时，您都将添加相同的按钮。如果您多次添加相同的项目，您将收到错误消息。

你到底想做什么？如果您只想在线性布局中添加一个按钮，您可以在不扩展布局的情况下这样做。

# glassfish - GlassFish 重新部署应该工作吗？

> ID：10092958
> 
> 赞同：3
> 
> 时间：2012-04-10T16:49:08.983
> 
> 标签：glassfish, eclipselink, glassfish-3

这是 GF 3.1.1 build 12。

我有一个使用 EclipseLink 2.3.0 作为后端 JPA 提供程序的 JSF 2 Web 应用程序。[您可以在此处](http://www.myqwip.com)查看部署。

当我使用管理控制台重新部署时，它会很好地上传 WAR 文件，然后一切都崩溃了。一旦有人访问页面，日志就会充满异常，这些异常通常与尝试对已关闭的 EntityManager 执行操作有关。如果我让它继续下去，GlassFish 会退化并且几乎会崩溃——我无法在管理端口上得到任何响应。

如果我重新加载，那么它似乎工作正常。所以我的问题是，什么样的应用程序可以在不重新加载的情况下进行重新部署？我可以对我的应用程序做些什么来让我从一个版本顺利过渡到下一个版本？

# eclipse - 如何查看 git eclipse 中的分段更改的“git diff”

> ID：10092977
> 
> 赞同：1
> 
> 时间：2012-04-10T16:50:34.817
> 
> 标签：eclipse, git, gitx

我在 Eclipse 中使用 git 插件。如何在 git 中查看暂存区域中每个文件的差异？

在 Mac OS X Gitx 中，我也可以看到每个暂存/取消暂存文件的差异。

我怎样才能在 eclipse git 中做同样的事情？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-08-05T21:32:18.757

Eclipse中有一个`git staging view`。在那里你可以看到分阶段和非分阶段的变化。通过双击，您可以看到索引或工作树的差异。

您也可以在包资源管理器上执行 Rightclick > Compare with ... 并选择您想要比较文件的版本。

# javascript - 单击链接时显示一些文本

> ID：10092985
> 
> 赞同：1
> 
> 时间：2012-04-10T16:50:58.093
> 
> 标签：javascript, jquery, text, html-table, show

这里我有一段代码，我只想在点击链接时显示长文本。

```
<script src="files/jquery.js"></script>

<center>

<table border="1" bordercolor="#999999" style="background-color:#00000" cellpadding="0" cellspacing="0" width="750">
<tr style="background-color:#00000 height: 50px; width : 250px; font-size: 25px">
<td> <center> Product </center> </td> <td> <center> Description </center> </td> <td>     <center> Price </center> </td>
</tr>
<tr>
<td>&nbsp;<a href="#" class="readmore">My product name</a> </td> <td>&nbsp;This is just an introducary description <p class="more">This is a more complex description which should open only when the product name is clicked and here will be also a button to add to cart and some media .</p> <td> <center> <font size="3"> <b> $3 </b> </font> </center> </td> </tr>
</table>

</center> 
```

所以我不完全知道我应该输入什么代码来隐藏长文本并且仅在单击我的产品名称链接时显示，任何人都可以帮我这样做。

编辑：我希望它很好地打开，现在显示出来，我不知道如何解释，但我认为我应该使用 jQuery 在打开时让它动画^就像在[http://docs.jquery.com/Tutorials :Live_Examples_of_jQuery](http://docs.jquery.com/Tutorials:Live_Examples_of_jQuery)在 Example B 中单击 Slide In 时，文本以一种漂亮的方式显示，这是我想要长文本执行的操作。

* * *

经过大量的更改和测试，我已经使链接打开一些文本，单击时地址栏中没有任何变化，再次单击可以反转，所以这里是帮助其他成员的最终代码。

```
<script type='text/javascript'>
function toggle(id)
{
var el = document.getElementById(id);
if(el.style.display == 'block')
el.style.display = 'none';
else
el.style.display = 'block';
}
</script>

<center>

<table border="1" bordercolor="#999999" style="background-color:#00000" cellpadding="0" cellspacing="0" width="750">
<tr style="background-color:#00000 height: 50px; width : 250px; font-size: 25px">
<td> <center> Product </center> </td> <td> <center> Description </center> </td> <td> <center> Price </center> </td>
</tr>
<tr>
<td>&nbsp;<a href="javascript:void(0)" onclick="toggle('hiddentext');">My product name</a> </td> <td>&nbsp;This is just an introducary description <p class="more" id="hiddentext" style="display: none;">This is a more complex description which should open only when the product name is clicked and here will be also a button to add to cart and some media .</p> <td> <center> <font size="3"> <b> $3 </b> </font> </center> </td> </tr>
</table>

</center> 
```

现在我的最后一件事是按照我的编辑中的描述很好地滑动文本，以便它以更好的方式出现，所以如果有人可以帮助我这样做，将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-10T17:02:30.453

```
<script>
function toggle(id) {
   var el = document.getElementById(id);
   if(el.style.display == 'block')
      el.style.display = 'none';
   else
  el.style.display = 'block';
}
</script>

<script src="files/jquery.js"></script>

<center>
  <table border="1" bordercolor="#999999" style="background-color:#00000" cellpadding="0"        cellspacing="0" width="750">
    <tr style="background-color:#00000 height: 50px; width : 250px; font-size: 25px">
      <td> <center> Product </center> </td> <td> <center> Description </center> </td> 
      <td> <center> Price </center> </td>
    </tr>
    <tr>
      <td>&nbsp;<a href="#" class="readmore">My product name</a> </td> 
      <td> <a id="test" style="display:none">     &nbsp;This is just an introducary description <p class="more">This     is a more complex description which should open only when the product name is clicked and here     will be also a  button to add to cart and some media .</p> </a><td> <center> <font size="3">     <b> $3 </b> </font>         </center> </td> 
    </tr>
  </table>
  </center>

<a href="#" onclick="toggle('test');">Click to toggle</a>
```

类似的东西^^？虽然我没有测试过。

编辑：测试它..它的工作原理。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-10T17:03:18.440

这应该有效：

```
$(document).ready(function() {
    $(".more").hide();
    $(".readmore").click(function(e) {
        e.preventDefault(); //Prevent default link action
        $(this).parent().parent().find(".more").toggle();
    });
}); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-10T16:55:47.883

```
Try this:

$(function(){ 
     $(".more").hide();
     $(".readmore").click(function(){
        $(".more").show();
    });

}); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-10T16:56:02.873

[http://jsfiddle.net/fdtdX/](http://jsfiddle.net/fdtdX/)

```
$('.more').hide()
$('.readmore').on('click', function()
{
    $(this).closest('tr').find('.more').show();
}) 
```

# azure - 将消息重新发送回 Azure 队列是否有任何问题

> ID：10092995
> 
> 赞同：0
> 
> 时间：2012-04-10T16:52:12.270
> 
> 标签：azure, message, azure-worker-roles, azure-queues

我在 Azure 中有一个调度程序和一些工作人员。调度程序将消息放入队列中，工作人员提取这些消息并对其进行处理。我现在刚刚遇到一个场景，一旦达到某个阈值，我需要将一些数据从表存储移动到我们的数据库。这些项目需要按顺序处理，最早的在前。一旦达到该阈值，所有其他项目都会按顺序处理。触发传输的当前消息需要填充在行尾并重新处理。

所以，对于我的问题的实质......

可以简单地将消息按原样重新发送到队列，还是有可能导致问题？

```
queueProvider.SendMessage(message); 
```

一位同事提到他“*虽然他可能已经读过一些关于需要做一些特别的事情的文章。* ”但我还没有看到任何可以证实他的怀疑的东西，所以我想我会在这里提出这个问题，只是为了安全起见。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-10T17:24:45.130

简短的回答是这很好。如果你有一个 CloudQueueMessage，你可以将它发送到任何队列（这只是一天结束时的 REST 请求）。每次您 AddMessage() 时，它都会创建一个新 ID（可能是相同的弹出收据，但没关系）。话虽如此，您可能需要注意和/或调查一些事情：

1.  如果您将一条消息推送到一个队列，弹出它，然后推送到另一个队列或同一个队列，您可能应该从队列中删除第一条消息。仅仅弹出它意味着您已经设置了隐身超时，但它很快就会重新出现（并且您现在在每个队列上都有相同的消息内容）。因此，如果我弹出一条消息并立即再次推送它，我现在在队列中有 2 条内容相同的消息。
2.  您现在可以更新消息。如果您需要订购，这可能适合您。您可以在元数据或内容中指示消息本身处于哪个处理阶段，并且您可以在这里通过周到的实施获得一些排序。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-12-06T10:20:32.293

建议队列消费者内部的所有逻辑都是幂等的，因为实际上可以多次提取消息。我们必须记住，队列服务保证消息将被传递，至少一次 - 因此您最终可能会使用这种方法复制消息。